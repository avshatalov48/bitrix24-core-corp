{"version":3,"file":"script.js","sources":["src/contents/content.js","src/contents/invitation.js","src/contents/structure.js","src/contents/employees.js","src/contents/extranet.js","src/contents/user-online.js","src/popup.js","src/widget.js"],"sourcesContent":["import { BaseEvent, EventEmitter } from 'main.core.events';\nimport { ajax, Cache, Text } from 'main.core';\nimport { ConfigContent } from '../types/content';\nimport { Popup } from 'main.popup';\n\nexport class Content extends EventEmitter\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: Object)\n\t{\n\t\tsuper();\n\t\tthis.setOptions(options);\n\t}\n\n\tsetOptions(options: Object): void\n\t{\n\t\tthis.cache.set('options', { ...options });\n\t}\n\n\tgetOptions(): Object\n\t{\n\t\treturn this.cache.get('options', {});\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\tthrow new Error('Must be implemented in a child class');\n\t}\n\n\tshowInfoHelper(articleCode: string): void\n\t{\n\t\tBX.UI.InfoHelper.show(articleCode);\n\t\tthis.sendAnalytics(articleCode);\n\t}\n\n\tsendAnalytics(code: string): void\n\t{\n\t\tajax.runAction('intranet.invitationwidget.analyticsLabel', {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: {\n\t\t\t\thelperCode: code,\n\t\t\t\theaderPopup: 'Y'\n\t\t\t}\n\t\t});\n\t}\n\n\tgetHintPopup(text: string, element: HTMLElement, type: string): Popup\n\t{\n\t\treturn this.cache.remember(type, () => {\n\t\t\treturn new Popup(`bx-hint-${Text.getRandom()}`, element, {\n\t\t\t\tcontent: text,\n\t\t\t\tclassName: 'bx-invitation-warning',\n\t\t\t\tzIndex: 15000,\n\t\t\t\tangle: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 40,\n\t\t\t\tcloseIcon: false,\n\t\t\t\tautoHide: true,\n\t\t\t\tdarkMode: true,\n\t\t\t\toverlay: false,\n\t\t\t\tmaxWidth: 300,\n\t\t\t\tevents: {\n\t\t\t\t\tonShow: (event) => {\n\t\t\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.InvitationWidget.HintPopup:show', new BaseEvent({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tpopup: event.target,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\t\t\t\t\t\tconst timeout = setTimeout(() => {\n\t\t\t\t\t\t\tevent.target.close();\n\t\t\t\t\t\t}, 4000)\n\t\t\t\t\t\tEventEmitter.subscribeOnce(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.InvitationWidget.HintPopup:close', () => {\n\t\t\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.InvitationWidget.HintPopup:close');\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tshowHintPopup(text: string, element: HTMLElement, type: string): void\n\t{\n\t\tthis.getHintPopup(text, element, type).toggle();\n\t}\n\n\tshowInvitationPlace(text: string, element: HTMLElement, type: string): void\n\t{\n\t\tif (this.getOptions().isAdmin)\n\t\t{\n\t\t\tthis.showInvitationSlider(type);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getOptions().isInvitationAvailable)\n\t\t\t{\n\t\t\t\tthis.showInvitationSlider(type);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showHintPopup(text, element, 'hint-' + type);\n\t\t\t}\n\t\t}\n\t}\n\n\tshowInvitationSlider(type: string): void\n\t{\n\t\tlet link = this.getOptions().invitationLink;\n\n\t\tif (type === 'extranet')\n\t\t{\n\t\t\tlink = `${link}&firstInvitationBlock=extranet`;\n\t\t}\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\tlink,\n\t\t\t{ cacheable: false, allowChangeHistory: false, width: 1100 }\n\t\t);\n\t}\n\n\tgetConfig(): ConfigContent\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t}\n\t}\n}","import { Content } from \"./content\";\nimport { Tag, Loc } from \"main.core\";\nimport type { InvitationContentOptions } from \"../types/options\";\nimport type { ConfigContent } from \"../types/content\";\n\nexport class InvitationContent extends Content\n{\n\tconstructor(options: InvitationContentOptions) {\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget.InvitationContent');\n\t\tthis.setOptions(options);\n\t}\n\n\tgetConfig(): ConfigContent\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tbackgroundColor: '#14bfd5',\n\t\t};\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst showInvitationSlider = (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.showInvitationPlace(\n\t\t\t\t\tLoc.getMessage('INTRANET_INVITATION_WIDGET_DISABLED_TEXT'),\n\t\t\t\t\te.target,\n\t\t\t\t\t'default-invitation'\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tconst showInvitationHelper = () => {\n\t\t\t\tthis.showInfoHelper('limit_why_team_invites');\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-invitation-widget-invite\">\n\t\t\t\t\t<div class=\"intranet-invitation-widget-invite-main\">\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-inner\">\n\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-content\">\n\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-icon intranet-invitation-widget-item-icon--invite\"></div>\n\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-content\">\n\t\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-name\">\n\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_INVITE_EMPLOYEE')}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-link\">\n\t\t\t\t\t\t\t\t\t\t<span onclick=\"${showInvitationHelper}\" class=\"intranet-invitation-widget-item-link-text\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_DESC')}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a onclick=\"${showInvitationSlider}\" class=\"intranet-invitation-widget-item-btn intranet-invitation-widget-item-btn--invite\"> \n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_INVITE')}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import { Content } from \"./content\";\nimport { Tag, Loc } from \"main.core\";\nimport type { StructureContentOptions } from \"../types/options\";\nimport type { ConfigContent } from \"../types/content\";\n\nexport class StructureContent extends Content\n{\n\tconstructor(options: StructureContentOptions) {\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget.StructureContent');\n\t}\n\n\tgetConfig(): ConfigContent\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tflex: 3,\n\t\t};\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-invitation-widget-item intranet-invitation-widget-item--company intranet-invitation-widget-item--active\">\n\t\t\t\t\t<div class=\"intranet-invitation-widget-item-logo\"></div>\n\t\t\t\t\t<div class=\"intranet-invitation-widget-item-content\">\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-name\">\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_STRUCTURE')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a href=\"${this.getOptions().link}\" class=\"intranet-invitation-widget-item-btn\"> \n\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_EDIT')}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import { Content } from \"./content\";\nimport { Tag, Loc, ajax, Text } from \"main.core\";\nimport type { EmployeesContentOptions } from \"../types/options\";\nimport type { ConfigContent } from \"../types/content\";\nimport { Menu } from \"main.popup\";\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\nexport class EmployeesContent extends Content\n{\n\t#rightType: string;\n\n\tconstructor(options: EmployeesContentOptions) {\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget.EmployeesContent');\n\t}\n\n\tgetConfig(): ConfigContent\n\t{\n\t\treturn {\n\t\t\thtml: this.getOptions().awaitData.then((response) => {\n\t\t\t\tthis.setOptions({\n\t\t\t\t\t...response.data.users,\n\t\t\t\t\t...this.getOptions(),\n\t\t\t\t});\n\t\t\t\treturn this.getLayout();\n\t\t\t}),\n\t\t\tflex: 5,\n\t\t\tsizeLoader: 55,\n\t\t};\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-invitation-widget-item intranet-invitation-widget-item--emp ${this.getOptions().isLimit ? 'intranet-invitation-widget-item--emp-alert' : null}\">\n\t\t\t\t\t<div class=\"intranet-invitation-widget-inner\">\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-content\">\n\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-content\">\n\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-progress ${this.getOptions().isLimit ? 'intranet-invitation-widget-item-progress--crit' : 'intranet-invitation-widget-item-progress--full'}\"/>\n\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-employees\">\n\t\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-name\">\n\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_EMPLOYEES')}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-num\">\n\t\t\t\t\t\t\t\t\t\t${this.getOptions().currentUserCountMessage}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${this.getDetail()}\n\t\t\t\t\t\t\t${this.getOptions().isAdmin ? this.getSelectorRights() : null}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetDetail(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('detail', () => {\n\t\t\tlet content = '';\n\n\t\t\tif (Number(this.getOptions().maxUserCount) === 0)\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage('INTRANET_INVITATION_WIDGET_EMPLOYEES_NO_LIMIT');\n\t\t\t}\n\t\t\telse if (this.getOptions().isLimit)\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage('INTRANET_INVITATION_WIDGET_EMPLOYEES_LIMIT');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcontent = this.getOptions().leftCountMessage;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-invitation-widget-item-detail\">\n\t\t\t\t\t<span class=\"intranet-invitation-widget-item-link-text\">\n\t\t\t\t\t\t${content}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSelectorRights(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('selector-rights', () => {\n\t\t\tconst showMenu = (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.getRightsMenu(e.target).toggle();\n\t\t\t}\n\n\t\t\tconst button = Tag.render`\n\t\t\t\t<div onclick=\"${showMenu}\" class=\"intranet-invitation-widget-item-menu\"></div>\n\t\t\t`;\n\n\t\t\tthis.subscribe('right-selected', (event) => {\n\t\t\t\tconst menu = this.getRightsMenu(button);\n\t\t\t\tmenu.close();\n\t\t\t\tmenu.destroy();\n\t\t\t\tif (event.data.type)\n\t\t\t\t{\n\t\t\t\t\tthis.cache.delete('menu-rights');\n\t\t\t\t\tthis.#rightType = event.data.type;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn button;\n\t\t});\n\t}\n\n\tgetRightsMenu(element: HTMLElement): Menu\n\t{\n\t\treturn this.cache.remember('menu-rights', () => {\n\t\t\treturn new Menu(`menu-rights-${Text.getRandom()}`, element, this.getMenuRightsItems(), {\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: 10,\n\t\t\t\toffsetTop: 0,\n\t\t\t\tangle: true,\n\t\t\t\tclassName: 'license-right-popup-men',\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupShow: (popup) => {\n\t\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t\tEventEmitter.GLOBAL_TARGET,\n\t\t\t\t\t\t\tthis.getEventNamespace() + ':showRightMenu',\n\t\t\t\t\t\t\tnew BaseEvent({\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tpopup: popup,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\tonPopupClose: (popup) => {\n\t\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t\tEventEmitter.GLOBAL_TARGET,\n\t\t\t\t\t\t\tthis.getEventNamespace() + ':closeRightMenu',\n\t\t\t\t\t\t\tnew BaseEvent({\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tpopup: popup,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\tonPopupFirstShow: (popup) => {\n\t\t\t\t\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'SidePanel.Slider:onOpenStart', () => {\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tgetMenuRightsItems(): Array\n\t{\n\t\tif (!this.#rightType)\n\t\t{\n\t\t\tthis.#rightType = this.getOptions().rightType;\n\t\t}\n\n\t\treturn [\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('INTRANET_INVITATION_WIDGET_SETTING_ALL_INVITE'),\n\t\t\t\tclassName: this.#rightType === 'all' ? 'menu-popup-item-accept' : '',\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.saveInvitationRightSetting('all').then(() => {\n\t\t\t\t\t\tthis.emit('right-selected', new BaseEvent({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\ttype: 'all'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('INTRANET_INVITATION_WIDGET_SETTING_ADMIN_INVITE'),\n\t\t\t\tclassName: this.#rightType === 'admin' ? 'menu-popup-item-accept' : '',\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.saveInvitationRightSetting('admin').then(() => {\n\t\t\t\t\t\tthis.emit('right-selected', new BaseEvent({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\ttype: 'admin'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\tsaveInvitationRightSetting(type): Promise\n\t{\n\t\treturn ajax.runAction(\"intranet.invitationwidget.saveInvitationRight\", {\n\t\t\tdata: {\n\t\t\t\ttype: type\n\t\t\t}\n\t\t});\n\t}\n\n}\n","import { Content } from \"./content\";\nimport { Tag, Loc } from \"main.core\";\nimport type { ConfigContent } from \"../types/content\";\nimport type { ExtranetContentOptions } from \"../types/options\";\n\nexport class ExtranetContent extends Content\n{\n\tarticleCode: string = \"6770709\";\n\n\tconstructor(options: ExtranetContentOptions) {\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget.ExtranetContent');\n\t}\n\n\tgetConfig(): ConfigContent\n\t{\n\t\treturn {\n\t\t\thtml: this.getOptions().awaitData.then((response) => {\n\t\t\t\tthis.setOptions({\n\t\t\t\t\t...response.data.users,\n\t\t\t\t\t...this.getOptions(),\n\t\t\t\t});\n\t\t\t\treturn this.getLayout();\n\t\t\t}),\n\t\t\tminHeight: '55px',\n\t\t\tsizeLoader: 37,\n\t\t\tmarginBottom: 24,\n\t\t\tsecondary: true,\n\t\t};\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst showInvitationSlider = (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.showInvitationPlace(\n\t\t\t\t\tLoc.getMessage('INTRANET_INVITATION_WIDGET_DISABLED_TEXT'),\n\t\t\t\t\te.target,\n\t\t\t\t\t'extranet'\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tconst showExtranetHelper = () => {\n\t\t\t\tBX.Helper.show(`redirect=detail&code=${this.articleCode}`);\n\t\t\t\tthis.sendAnalytics(this.articleCode);\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"${this.getWrapperClass()}\">\n\t\t\t\t\t<div class=\"intranet-invitation-widget-content\">\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-icon intranet-invitation-widget-item-icon--ext\"></div>\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-content\">\n\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-name\">\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_EXTRANET')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-link\">\n\t\t\t\t\t\t\t\t<span onclick=\"${showExtranetHelper}\" class=\"intranet-invitation-widget-item-link-text\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_EXTRANET_DESC')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${this.getCountUserMessage()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button onclick=\"${showInvitationSlider}\" class=\"intranet-invitation-widget-item-btn\">\n\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_INVITE')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetWrapperClass(): string\n\t{\n\t\treturn this.cache.remember('wrapper-class', () => {\n\t\t\tconst baseClass = 'intranet-invitation-widget-item intranet-invitation-widget-item--wide';\n\n\t\t\tif (this.getOptions().currentExtranetUserCount > 0)\n\t\t\t{\n\t\t\t\treturn baseClass + ' intranet-invitation-widget-item--active';\n\t\t\t}\n\n\t\t\treturn baseClass;\n\t\t});\n\t}\n\n\tgetCountUserMessage(): ?HTMLDivElement\n\t{\n\t\treturn this.cache.remember('count-user-message', () => {\n\t\t\tif (this.getOptions().currentExtranetUserCount > 0)\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"intranet-invitation-widget-item-ext-users\">\n\t\t\t\t\t\t${this.getOptions().currentExtranetUserCountMessage}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t});\n\t}\n}\n","import { Content } from \"./content\";\nimport { Tag, ajax, Runtime, Dom } from \"main.core\";\nimport { Loader } from \"main.loader\";\n\nexport class UserOnlineContent extends Content\n{\n\tgetLoader(): Loader\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn new Loader({\n\t\t\t\tsize: 45,\n\t\t\t});\n\t\t})\n\t}\n\n\tgetComponentContent(): HTMLElement {\n\t\treturn this.cache.remember('component-content', () => {\n\t\t\tconst contentContainer = Tag.render`\n\t\t\t\t<div data-role=\"invitation-widget-ustat-online\" class=\"invitation-widget-ustat-online\"/>\n\t\t\t`;\n\t\t\tDom.style(contentContainer, 'min-height', '70px');\n\n\t\t\tthis.getLoader().show(contentContainer);\n\n\t\t\tajax.runAction(\"intranet.invitationwidget.getUserOnlineComponent\").then((response) => {\n\t\t\t\tthis.getLoader().hide();\n\t\t\t\tconst assets = response.data.assets;\n\t\t\t\tBX.load([...assets['css'], ...assets['js']], () => {\n\t\t\t\t\tRuntime.html(null, [...assets['string']].join('\\n'), {useAdjacentHTML: true})\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tRuntime.html(contentContainer, response.data.html).then(() => {\n\t\t\t\t\t\t\t\tthis.getLoader().destroy();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn contentContainer;\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-invitation-widget-item intranet-invitation-widget-item--wide intranet-invitation-widget-item--no-padding\">\n\t\t\t\t\t${this.getComponentContent()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import { EventEmitter } from 'main.core.events';\nimport { Cache, ajax, Event } from 'main.core';\nimport { PopupComponentsMaker } from 'ui.popupcomponentsmaker';\nimport type { ConfigContent } from './types/content';\nimport type { InvitationPopupOptions } from \"./types/options\";\nimport { InvitationContent } from \"./contents/invitation\";\nimport { StructureContent } from \"./contents/structure\";\nimport { EmployeesContent } from \"./contents/employees\";\nimport { ExtranetContent } from \"./contents/extranet\";\nimport { UserOnlineContent } from \"./contents/user-online\";\n\nexport class InvitationPopup extends EventEmitter\n{\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(options: InvitationPopupOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget.Popup');\n\t\tthis.setOptions(options)\n\t\tthis.#setEventHandler();\n\t}\n\n\tsetOptions(options: InvitationPopupOptions): void\n\t{\n\t\tthis.#cache.set('options', options);\n\t}\n\n\tgetOptions(): InvitationPopupOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\t#getAwaitData(): Promise\n\t{\n\t\treturn this.#cache.remember('await-data', () => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tajax.runAction(\"intranet.invitationwidget.getData\", {\n\t\t\t\t\tdata: {},\n\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\theaderPopup: \"Y\"\n\t\t\t\t\t}\n\t\t\t\t}).then(resolve).catch(reject);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetPopup(): PopupComponentsMaker\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\treturn new PopupComponentsMaker({\n\t\t\t\tid: 'invitation-popup',\n\t\t\t\ttarget: this.getOptions().target,\n\t\t\t\twidth: 350,\n\t\t\t\tcontent: this.#getContent(),\n\t\t\t});\n\t\t});\n\t}\n\n\t//This is the method for popup content configuration\n\t#getContent(): Array<ConfigContent>\n\t{\n\t\treturn this.#cache.remember('content', () => {\n\t\t\treturn [\n\t\t\t\tthis.#getInvitationContent().getConfig(),\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\tthis.#getStructureContent().getConfig(),\n\t\t\t\t\t\tthis.#getEmployeesContent().getConfig(),\n\t\t\t\t\t],\n\t\t\t\t\tmarginBottom: 24,\n\t\t\t\t},\n\t\t\t\tthis.getOptions().isExtranetAvailable ? this.#getExtranetContent().getConfig() : null,\n\t\t\t\tthis.#getUserOnlineContent().getConfig(),\n\t\t\t];\n\t\t});\n\t}\n\n\t//region Get Content\n\t#getInvitationContent(): InvitationContent\n\t{\n\t\treturn this.#cache.remember('invitation-content', () => {\n\t\t\treturn new InvitationContent({\n\t\t\t\tisAdmin: this.getOptions().isAdmin,\n\t\t\t\tinvitationLink: this.getOptions().params.invitationLink,\n\t\t\t\tisInvitationAvailable: this.getOptions().isInvitationAvailable,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getStructureContent(): StructureContent\n\t{\n\t\treturn this.#cache.remember('structure-content', () => {\n\t\t\treturn new StructureContent({\n\t\t\t\tlink: this.getOptions().params.structureLink,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getEmployeesContent(): EmployeesContent\n\t{\n\t\treturn this.#cache.remember('employees-content', () => {\n\t\t\treturn new EmployeesContent({\n\t\t\t\tisAdmin: this.getOptions().isAdmin,\n\t\t\t\tawaitData: this.#getAwaitData(),\n\t\t\t});\n\t\t});\n\t}\n\n\t#getExtranetContent(): ExtranetContent\n\t{\n\t\treturn this.#cache.remember('extranet-content', () => {\n\t\t\treturn new ExtranetContent({\n\t\t\t\tisAdmin: this.getOptions().isAdmin,\n\t\t\t\tawaitData: this.#getAwaitData(),\n\t\t\t\tinvitationLink: this.getOptions().params.invitationLink,\n\t\t\t\tisInvitationAvailable: this.getOptions().isInvitationAvailable,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getUserOnlineContent(): UserOnlineContent\n\t{\n\t\treturn this.#cache.remember('user-online-content', () => {\n\t\t\treturn new UserOnlineContent;\n\t\t});\n\t}\n\t//endregion\n\n\t#getPopupContainer(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('popup-container', () => {\n\t\t\treturn this.getPopup().getPopup().getPopupContainer();\n\t\t});\n\t}\n\n\t#setEventHandler()\n\t{\n\t\tconst autoHideHandler = (event) => {\n\t\t\tif (event.data.popup)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tEvent.bind(this.#getPopupContainer(), 'click', () => {\n\t\t\t\t\t\tevent.data.popup.close();\n\t\t\t\t\t});\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t}\n\n\t\tconst close = () => {\n\t\t\tthis.close();\n\t\t}\n\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.InvitationWidget.EmployeesContent:showRightMenu', autoHideHandler);\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.InvitationWidget.HintPopup:show', autoHideHandler);\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.UstatOnline:showPopup', autoHideHandler);\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'SidePanel.Slider:onOpenStart', close);\n\t}\n}","import { EventEmitter } from 'main.core.events';\nimport { Cache, Event } from 'main.core';\nimport type { InvitationWidgetOptions } from './types/options';\nimport { InvitationPopup } from \"./popup\";\n\nexport class InvitationWidget extends EventEmitter\n{\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(options: InvitationWidgetOptions) {\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget');\n\t\tthis.setOptions(options);\n\t\tEvent.bind(this.getOptions().button, 'click', () => {\n\t\t\tthis.#getPopup().show();\n\t\t});\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'BX.Bitrix24.NotifyPanel:showInvitationWidget', () => {\n\t\t\tthis.#getPopup().show();\n\t\t});\n\t}\n\n\tsetOptions(options: InvitationWidgetOptions): void\n\t{\n\t\tthis.#cache.set('options', options);\n\t}\n\n\tgetOptions(): InvitationWidgetOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\t#getPopup(): InvitationPopup\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\treturn new InvitationPopup({\n\t\t\t\tisAdmin: this.getOptions().isCurrentUserAdmin,\n\t\t\t\ttarget: this.getOptions().button,\n\t\t\t\tisExtranetAvailable: this.getOptions().isExtranetAvailable,\n\t\t\t\tisInvitationAvailable: this.getOptions().isInvitationAvailable,\n\t\t\t\tparams: {\n\t\t\t\t\tstructureLink: this.getOptions().structureLink,\n\t\t\t\t\tinvitationLink: this.getOptions().invitationLink,\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n}"],"names":["Content","options","Cache","MemoryCache","setOptions","cache","set","get","Error","articleCode","BX","UI","InfoHelper","show","sendAnalytics","code","ajax","runAction","data","analyticsLabel","helperCode","headerPopup","text","element","type","remember","Popup","Text","getRandom","content","className","zIndex","angle","offsetTop","offsetLeft","closeIcon","autoHide","darkMode","overlay","maxWidth","events","onShow","event","EventEmitter","emit","GLOBAL_TARGET","BaseEvent","popup","target","timeout","setTimeout","close","subscribeOnce","clearTimeout","onClose","getHintPopup","toggle","getOptions","isAdmin","showInvitationSlider","isInvitationAvailable","showHintPopup","link","invitationLink","SidePanel","Instance","open","cacheable","allowChangeHistory","width","html","getLayout","InvitationContent","setEventNamespace","backgroundColor","e","stopPropagation","showInvitationPlace","Loc","getMessage","showInvitationHelper","showInfoHelper","Tag","render","StructureContent","flex","EmployeesContent","awaitData","then","response","users","sizeLoader","isLimit","currentUserCountMessage","getDetail","getSelectorRights","Number","maxUserCount","leftCountMessage","showMenu","getRightsMenu","button","subscribe","menu","destroy","Menu","getMenuRightsItems","onPopupShow","getEventNamespace","onPopupClose","onPopupFirstShow","rightType","onclick","saveInvitationRightSetting","ExtranetContent","minHeight","marginBottom","secondary","showExtranetHelper","Helper","getWrapperClass","getCountUserMessage","baseClass","currentExtranetUserCount","currentExtranetUserCountMessage","UserOnlineContent","Loader","size","contentContainer","Dom","style","getLoader","hide","assets","load","Runtime","join","useAdjacentHTML","getComponentContent","InvitationPopup","_classPrivateFieldInitSpec","getPopup","PopupComponentsMaker","id","Promise","resolve","reject","getConfig","isExtranetAvailable","params","structureLink","getPopupContainer","autoHideHandler","Event","bind","InvitationWidget","_classPrivateMethodInitSpec","_classPrivateMethodGet","isCurrentUserAdmin"],"mappings":"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"}