BX.namespace("BX.Crm");if(typeof BX.Crm.OrderShipment==="undefined"){BX.Crm.OrderShipment=function(){this._id="";this._settings={};this._editorCreateHandler=BX.delegate(this.onEditorCreate,this);this._editorUpdateHandler=BX.delegate(this.onEntityUpdate,this);this._editorDeleteHandler=BX.delegate(this.onSliderDelete,this)};BX.Crm.OrderShipment.prototype={initialize:function(t,e){this._id=BX.type.isNotEmptyString(t)?t:BX.util.getRandomString(4);this._settings=e?e:{};this.bindEvents()},bindEvents:function(){BX.addCustomEvent(window,BX.Crm.EntityEvent.names.create,this._editorCreateHandler);BX.addCustomEvent(window,BX.Crm.EntityEvent.names.update,this._editorUpdateHandler);BX.addCustomEvent(window,BX.Crm.EntityEvent.names.delete,this._editorDeleteHandler)},onEditorCreate:function(t){if(BX.type.isPlainObject(t["entityData"])){var e={entityTypeId:BX.CrmEntityType.enumeration.ordershipment,field:t["entityData"]};window.top.BX.SidePanel.Instance.postMessage(window,"CrmOrderShipment::Create",e)}},onEntityUpdate:function(t){if(BX.type.isPlainObject(t["entityData"])){var e={entityTypeId:BX.CrmEntityType.enumeration.ordershipment,field:t["entityData"]};window.top.BX.SidePanel.Instance.postMessage(window,"CrmOrderShipment::Update",e)}},onSliderDelete:function(t){if(parseInt(t["id"])>0){var e={entityTypeId:BX.CrmEntityType.enumeration.ordershipment,ID:t["id"]};window.top.BX.SidePanel.Instance.postMessage(window,"CrmOrderShipment::Delete",e)}},trackingStatusUpdate:function(t,e){var i=this;BX.ajax.runAction("sale.tracking.getStatusByShipmentId",{data:{shipmentId:t,trackingNumber:e}}).then(function(t){if(t.data){var e=t.data,n=BX.Crm.EntityEditor.items[i._settings.editorId];if(n){var a=i._settings.statusViewTemplate.replace("#STATUS_NAME#",e.statusName);n.getModel().setField("TRACKING_STATUS_VIEW",a);n.getModel().setField("TRACKING_DESCRIPTION",e.description);if(e.lastChange){n.getModel().setField("TRACKING_LAST_CHANGE",e.lastChange)}n.refreshLayout()}}},function(t){BX.debug(t)})}};BX.Crm.OrderShipment.create=function(t,e){var i=new BX.Crm.OrderShipment;i.initialize(t,e);return i}}
//# sourceMappingURL=script.map.js