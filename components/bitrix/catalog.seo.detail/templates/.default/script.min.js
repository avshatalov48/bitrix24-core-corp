this.BX=this.BX||{};(function(e,t,i,n,a){"use strict";var l,s;var r=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var i=arguments.length>1?arguments[1]:undefined;babelHelpers.classCallCheck(this,e);this.form=i;this.fields=t.FIELDS;this.title=t.TITLE;this.id=t.ID;this.type=null}babelHelpers.createClass(e,[{key:"layout",value:function e(){return a.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div class='ui-slider-section'>\n\t\t\t\t<div class='ui-slider-heading-4'>","</div>\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),a.Text.encode(this.title),this.getInfoWrapper(),this.getWrapper())}},{key:"getWrapper",value:function e(){return a.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(["<div class='ui-form ui-form-section'></div>"])))}},{key:"getInfoWrapper",value:function e(){return null}},{key:"getForm",value:function e(){return this.form}},{key:"getType",value:function e(){return this.type}},{key:"getInheritedLabel",value:function e(){return""}}]);return e}();var o=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(o,"ELEMENT","E");babelHelpers.defineProperty(o,"SECTION","S");babelHelpers.defineProperty(o,"MANAGEMENT","M");var u,c;var h=function(e){babelHelpers.inherits(n,e);function n(){var e;var l=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var s=arguments.length>1?arguments[1]:undefined;babelHelpers.classCallCheck(this,n);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(n).call(this,l,s));e.inputFields=[];Object.keys(l.FIELDS).forEach((function(t){var i=l.FIELDS[t];e.inputFields.push(new X(i,babelHelpers.assertThisInitialized(e)))}));if(l.MESSAGE){e.message=new t.MessageCard({id:l.MESSAGE.ID,header:a.Text.encode(l.MESSAGE.HEADER),description:e.getInfoMessageDescription(l.MESSAGE.DESCRIPTION),angle:false,hidden:l.MESSAGE.HIDDEN==="Y"});i.EventEmitter.subscribe(e.message,"onClose",(function(){e.form.hideInfoMessage(e.message.id)}))}e.type=o.ELEMENT;return e}babelHelpers.createClass(n,[{key:"getWrapper",value:function e(){var t=babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"getWrapper",this).call(this);this.inputFields.forEach((function(e){a.Dom.append(e.layout(),t)}));return t}},{key:"getInfoWrapper",value:function e(){return this.message?this.message.getLayout():null}},{key:"getInfoMessageDescription",value:function e(t){var i=a.Tag.render(u||(u=babelHelpers.taggedTemplateLiteral(['<a href="#" class="ui-form-link">',"</a>"])),a.Loc.getMessage("CSD_ELEMENT_INFO_MESSAGE_HELP_LINK_TITLE"));a.Event.bind(i,"click",Ee.openSeoHelpPage);var n=a.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div>","</div>\n\t\t"])),a.Text.encode(t).replace("#HELP_LINK#","<help-link></help-link>"));a.Dom.replace(n.querySelector("help-link"),i);return n}},{key:"toggleInputMenu",value:function e(t){this.getForm().toggleInputMenu(this,t)}},{key:"getInheritedLabel",value:function e(){if(!this.form.isElementMode()){return a.Loc.getMessage("CSD_INHERIT_SECTION_ELEMENT_OVERWRITE_CHECKBOX_INPUT_TITLE")}return a.Loc.getMessage("CSD_INHERIT_ELEMENT_OVERWRITE_CHECKBOX_INPUT_TITLE")}}]);return n}(r);var p,d,v,g,f,b,m,T,E,y,C,k,H;function I(e,t){S(e,t);t.add(e)}function S(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function L(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var P=new WeakSet;var w=new WeakSet;var M=new WeakSet;var F=new WeakSet;var N=new WeakSet;var _=new WeakSet;var W=new WeakSet;var O=new WeakSet;var D=new WeakSet;var A=new WeakSet;var x=new WeakSet;var R=new WeakSet;var V=new WeakSet;var B=new WeakSet;var X=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var i=arguments.length>1?arguments[1]:undefined;babelHelpers.classCallCheck(this,e);I(this,B);I(this,V);I(this,R);I(this,x);I(this,A);I(this,D);I(this,O);I(this,W);I(this,_);I(this,N);I(this,F);I(this,M);I(this,w);I(this,P);this.id=a.Text.encode(t.ID);this.title=a.Text.encode(t.TITLE);this.section=i;this.handleInput=a.Runtime.debounce(this.onInput,500,this)}babelHelpers.createClass(e,[{key:"layout",value:function e(){var t=this;this.input=a.Tag.render(p||(p=babelHelpers.taggedTemplateLiteral(["\n\t\t\t<input class='ui-ctl-element' name=\"",'" value="','">\n\t\t'])),this.id,a.Text.encode(L(this,P,G).call(this)));if(!L(this,B,ie).call(this)){a.Event.bind(this.input,"keydown",(function(e){t.section.getForm().hideInputMenu()}));a.Event.bind(this.input,"input",this.handleInput);a.Event.bind(this.input,"click",this.toggleTemplatesMenu.bind(this))}if(!this.hintWrapper){this.hintWrapper=a.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(["<div class='ui-ctl-label-text catalog-seo-detail-input-hint'>","</div>"])),L(this,w,Y).call(this))}var i=null;if(!L(this,B,ie).call(this)){i=a.Tag.render(v||(v=babelHelpers.taggedTemplateLiteral(['<div class="ui-ctl-after ui-ctl-icon-angle" data-id=""></div>'])))}this.inputWrapper=a.Tag.render(g||(g=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-after-icon ui-ctl-w100">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),i,this.input);var n=null;var l=null;if(L(this,x,$).call(this)){n=a.Tag.render(f||(f=babelHelpers.taggedTemplateLiteral(['<input type="checkbox" class="ui-ctl-element">'])));a.Event.bind(n,"change",L(this,V,te).bind(this));l=a.Tag.render(b||(b=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<label class="ui-ctl ui-ctl-checkbox ui-ctl-w100">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="ui-ctl-label-text">',"</div>\n\t\t\t\t</label>\n\t\t\t"])),n,this.section.getInheritedLabel())}if(n&&!L(this,M,j).call(this)){n.checked=true}else if(!this.section.getForm().isCatalogMode()||L(this,B,ie).call(this)){a.Dom.addClass(this.inputWrapper,"ui-ctl-disabled");this.input.disabled=true}var s=null;var r=null;this.transliterateWrapper=null;if(L(this,A,Z).call(this)){var o=a.Tag.render(m||(m=babelHelpers.taggedTemplateLiteral(['<input type="checkbox" class="ui-ctl-element">'])));a.Event.bind(o,"change",L(this,W,q).bind(this));s=a.Tag.render(T||(T=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<label class="ui-ctl ui-ctl-checkbox ui-ctl-w100">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="ui-ctl-label-text">',"</div>\n\t\t\t\t</label>\n\t\t\t"])),o,a.Loc.getMessage("CSD_LOWERCASE_CHECKBOX_INPUT_TITLE"));if(L(this,N,K).call(this)){o.checked=true}var u=a.Tag.render(E||(E=babelHelpers.taggedTemplateLiteral(['<input type="checkbox" class="ui-ctl-element">'])));a.Event.bind(u,"change",L(this,O,J).bind(this));r=a.Tag.render(y||(y=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<label class="ui-ctl ui-ctl-checkbox ui-ctl-w100">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="ui-ctl-label-text">',"</div>\n\t\t\t\t</label>\n\t\t\t"])),u,a.Loc.getMessage("CSD_TRANSLITERATE_CHECKBOX_INPUT_TITLE"));if(L(this,F,U).call(this)){u.checked=true}var c=a.Tag.render(C||(C=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<input \n\t\t\t\t\tclass="ui-ctl-element ui-text-center" \n\t\t\t\t\tsize="1" maxlength="1" \n\t\t\t\t\tvalue="','"\n\t\t\t\t>\n\t\t\t'])),L(this,_,z).call(this));a.Event.bind(c,"input",L(this,D,Q).bind(this));this.transliterateWrapper=a.Tag.render(k||(k=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="ui-ctl ui-ctl-checkbox ui-ctl-w100">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="ui-ctl-label-text">',"</div>\n\t\t\t\t</div>\n\t\t\t"])),c,a.Loc.getMessage("CSD_WHITESPACE_CHARACTER_INPUT_TITLE"));if(!L(this,F,U).call(this)){a.Dom.addClass(this.transliterateWrapper,"ui-form-row-hidden")}}return a.Tag.render(H||(H=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ui-form-row">\n\t\t\t\t<div class=\'ui-form-label\'>\n\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t',"\n\t\t\t\t\t","\t\t\t\t\t\n\t\t\t\t\t","\n\t\t\t\t\t","\n\t\t\t\t\t","\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),this.title,this.inputWrapper,l,s,r,this.transliterateWrapper,this.hintWrapper)}},{key:"onInput",value:function e(t){L(this,R,ee).call(this,t.target.value)}},{key:"refreshHint",value:function e(t){var i=this;if(L(this,B,ie).call(this)){return this}this.section.getForm().getHint(this.id,t).then((function(e){var t=i.section.getForm().getValue(i.id);t.hint=e.data;i.hintWrapper.innerHTML=e.data}));return this}},{key:"toggleTemplatesMenu",value:function e(){this.section.toggleInputMenu(this)}},{key:"getInput",value:function e(){return this.input}},{key:"addTemplateValue",value:function e(t){this.getInput().value+=t;L(this,R,ee).call(this,this.getInput().value)}}]);return e}();function G(){var e=this.section.getForm().getValue(this.id);return a.Type.isStringFilled(e===null||e===void 0?void 0:e.template)?e.template:""}function Y(){var e=this.section.getForm().getValue(this.id);return a.Type.isStringFilled(e===null||e===void 0?void 0:e.hint)?e.hint:""}function j(){var e=this.section.getForm().getValue(this.id);return(e===null||e===void 0?void 0:e.inherited)!=="N"}function U(){var e=this.section.getForm().getValue(this.id);return(e===null||e===void 0?void 0:e.transliterate)==="Y"}function K(){var e=this.section.getForm().getValue(this.id);return(e===null||e===void 0?void 0:e.lowercase)==="Y"}function z(){var e=this.section.getForm().getValue(this.id);return a.Type.isStringFilled(e===null||e===void 0?void 0:e.whitespaceCharacter)?e.whitespaceCharacter:""}function q(e){var t=this.section.getForm().getValue(this.id);t.lowercase=e.target.checked?"Y":"N";if(a.Type.isStringFilled(t.template)){this.refreshHint(t)}return this}function J(e){var t=e.target.checked;if(t){a.Dom.removeClass(this.transliterateWrapper,"ui-form-row-hidden")}else{a.Dom.addClass(this.transliterateWrapper,"ui-form-row-hidden")}var i=this.section.getForm().getValue(this.id);i.transliterate=t?"Y":"N";if(a.Type.isStringFilled(i.template)){this.refreshHint(i)}return this}function Q(e){var t=this.section.getForm().getValue(this.id);t.whitespaceCharacter=e.target.value.slice(0,1);if(a.Type.isStringFilled(t.template)&&L(this,F,U).call(this)){this.refreshHint(t)}return(t===null||t===void 0?void 0:t.transliterate)==="Y"}function Z(){var e=this.section.getForm().getValue(this.id);return!L(this,B,ie).call(this)&&(e===null||e===void 0?void 0:e.isExistedAttributes)}function $(){return!L(this,B,ie).call(this)&&!this.section.getForm().isCatalogMode()}function ee(e){if(L(this,B,ie).call(this)){return this}var t=this.section.getForm().getValue(this.id);t.template=e;if(a.Type.isStringFilled(e)){this.refreshHint(t)}else{t.hint="";this.hintWrapper.innerHTML=""}return this}function te(e){if(L(this,B,ie).call(this)||this.section.getForm().isCatalogMode()){return this}var t=e.target.checked;var i=this.section.getForm().getValue(this.id);i.inherited=t?"N":"Y";this.input.disabled=!t;if(t){a.Dom.removeClass(this.inputWrapper,"ui-ctl-disabled")}else{a.Dom.addClass(this.inputWrapper,"ui-ctl-disabled")}return this}function ie(){return this.section.getForm().isReadOnly()}var ne=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(ne,"CATALOG","MODE_CATALOG");babelHelpers.defineProperty(ne,"SECTION","MODE_SECTION");babelHelpers.defineProperty(ne,"ELEMENT","MODE_ELEMENT");var ae=function(e){babelHelpers.inherits(t,e);function t(){var e;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=arguments.length>1?arguments[1]:undefined;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,i,n));e.type=o.SECTION;return e}babelHelpers.createClass(t,[{key:"getInheritedLabel",value:function e(){return a.Loc.getMessage("CSD_INHERIT_SECTION_OVERWRITE_CHECKBOX_INPUT_TITLE")}}]);return t}(h);var le,se;function re(e,t){oe(e,t);t.add(e)}function oe(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function ue(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var ce=new WeakSet;var he=new WeakSet;var pe=function(){function e(t,i){babelHelpers.classCallCheck(this,e);re(this,he);re(this,ce);this.id=a.Text.encode(t.ID);this.title=a.Text.encode(t.TITLE);this.section=i}babelHelpers.createClass(e,[{key:"layout",value:function e(){var t=a.Tag.render(le||(le=babelHelpers.taggedTemplateLiteral(['<input type="checkbox" class="ui-ctl-element">'])));t.checked=ue(this,ce,de).call(this);a.Event.bind(t,"change",ue(this,he,ve).bind(this));return a.Tag.render(se||(se=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ui-form-row">\n\t\t\t\t<div class=\'ui-form-label\'>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t<label class="ui-ctl ui-ctl-checkbox ui-ctl-w100">\n\t\t\t\t\t\t','\n\t\t\t\t\t\t<div class="ui-ctl-label-text">',"</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),t,this.title)}}]);return e}();function de(){var e=this.section.getForm().getValue(this.id);return e.clearCache==="Y"}function ve(e){var t=this.section.getForm().getValue(this.id);t.clearCache=e.target.checked?"Y":"N";return this}var ge=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getWrapper",value:function e(){var i=babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getWrapper",this).call(this);var n=new pe(this.fields["SEO_CLEAR_VALUES"],this);a.Dom.append(n.layout(),i);return i}}]);return t}(r);var fe;function be(e,t,i){me(e,t);t.set(e,i)}function me(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var Te=new WeakMap;var Ee=function(){function e(t){babelHelpers.classCallCheck(this,e);be(this,Te,{writable:true,value:false});babelHelpers.defineProperty(this,"templatePopup",null);babelHelpers.defineProperty(this,"templatePopupField",null);this.container=BX(t.containerId);this.form=this.container.querySelector("#"+t.formId);this.values=t.values||{};this.defaultValues=t.values||{};this.componentName=t.componentName||"";this.signedParameters=t.signedParameters||"";this.menuItems=t.menuItems||[];this.sections=[];this.templatePopupField=null;this.readOnly=t.readOnly||false;this.mode=t.mode||"";this.createSections(t.schemeFields)}babelHelpers.createClass(e,[{key:"createSections",value:function e(t){var i=this;Object.keys(t).forEach((function(e){var n=t[e];var a=null;if(n.TYPE===o.SECTION){a=new ae(n,i)}else if(n.TYPE===o.ELEMENT){a=new h(n,i)}else if(n.TYPE===o.MANAGEMENT&&!i.isReadOnly()){a=new ge(n,i)}if(a){i.sections.push(a)}}));return this}},{key:"layout",value:function e(){var t=this;this.sections.forEach((function(e){a.Dom.append(e.layout(),t.form)}))}},{key:"getValue",value:function e(t){this.values[t]=this.values[t]||{};return this.values[t]}},{key:"getHint",value:function e(t,i){return a.ajax.runComponentAction(this.componentName,"getHint",{mode:"class",signedParameters:this.signedParameters,data:{templateId:t,template:i}})}},{key:"getSaveButton",value:function e(){return this.container.querySelector("#ui-button-panel-save")}},{key:"save",value:function e(){var t=this;if(babelHelpers.classPrivateFieldGet(this,Te)){return}babelHelpers.classPrivateFieldSet(this,Te,true);a.Dom.addClass(this.getSaveButton(),"ui-btn-wait");a.ajax.runComponentAction(this.componentName,"save",{mode:"class",signedParameters:this.signedParameters,data:{values:this.values}}).then((function(){babelHelpers.classPrivateFieldSet(t,Te,false);var e={closeButton:true,autoHideDelay:3e3,content:a.Tag.render(fe||(fe=babelHelpers.taggedTemplateLiteral(["<div>","</div>"])),a.Loc.getMessage("CSD_SAVE_MESSAGE_NOTIFICATION"))};var i=top.BX.UI.Notification.Center.notify(e);i.show();t.onFormCancel()}))["catch"](this.onError.bind(this))}},{key:"hideInfoMessage",value:function e(t){a.ajax.runComponentAction(this.componentName,"hideInfoMessage",{mode:"class",signedParameters:this.signedParameters,data:{messageId:t}})}},{key:"onError",value:function e(){a.Dom.removeClass(this.getSaveButton(),"ui-btn-wait");babelHelpers.classPrivateFieldSet(this,Te,false)}},{key:"isReadOnly",value:function e(){return this.readOnly}},{key:"getFormFieldName",value:function e(t){return"fields["+t+"]"}},{key:"toggleInputMenu",value:function e(t,i){if(this.templatePopupField&&this.templatePopup&&i.id!==this.templatePopupField){this.templatePopup.close();this.templatePopup.destroy();this.templatePopup=null}if(!this.templatePopup){this.templatePopupField=i;var a=this.getMenuItems(t.getType());this.templatePopup=new n.Menu({bindElement:i.getInput(),items:a})}this.templatePopup.toggle()}},{key:"hideInputMenu",value:function e(){if(this.templatePopup){this.templatePopup.close()}}},{key:"addInputTemplate",value:function e(t){if(this.templatePopupField){this.templatePopupField.addTemplateValue(t)}if(this.templatePopup){this.templatePopup.close()}}},{key:"getMenuItems",value:function e(t){var i;return(i=Object.assign(this.menuItems[t]))!==null&&i!==void 0?i:[]}},{key:"onFormCancel",value:function e(){BX.SidePanel.Instance.close()}},{key:"isCatalogMode",value:function e(){return this.mode===ne.CATALOG}},{key:"isElementMode",value:function e(){return this.mode===ne.ELEMENT}},{key:"isSectionMode",value:function e(){return this.mode===ne.SECTION}}],[{key:"create",value:function t(i){e.instance=new e(i);return e.instance}},{key:"onClickSave",value:function t(){e.instance.save()}},{key:"onSelectTemplate",value:function t(i){e.instance.addInputTemplate(i)}},{key:"openSeoHelpPage",value:function t(i){if(top.BX.Helper){top.BX.Helper.show("redirect=detail&code="+e.HElP_ARTICLE_CODE)}}}]);return e}();babelHelpers.defineProperty(Ee,"instance",null);babelHelpers.defineProperty(Ee,"HElP_ARTICLE_CODE",17013874);e.SeoDetail=Ee})(this.BX.Catalog=this.BX.Catalog||{},BX.UI,BX.Event,BX.Main,BX);
//# sourceMappingURL=script.map.js