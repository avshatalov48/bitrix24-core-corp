BX.namespace("BX.Mobile.Grid.Sort");BX.Mobile.Grid.Sort={gridId:"",eventName:"",init:function(e){if(typeof e==="object"){this.gridId=e.gridId||"";this.eventName=e.eventName||""}var t=BX("bx-mobile-interface-sort-block").querySelectorAll("[data-role='mobile-sort-item']");if(t){for(var i=0;i<t.length;i++){if(BX.hasClass(t[i],"mobile-grid-field-selected"))this.selectedField=t[i].getAttribute("data-sort-id");new window.FastButton(t[i],BX.proxy(function(){BX.Mobile.Grid.Sort.selectField(this.item)},{item:t[i]}))}}},selectedField:"",apply:function(){window.BXMobileApp.UI.Page.LoadingScreen.show();var e=BX.findChild(BX("bx-mobile-interface-sort-block"),{className:"mobile-grid-field-selected"},true,false);var t=e?e.getAttribute("data-sort-id"):"";var i=BX.findChild(BX("bx-mobile-interface-sort-block"),{className:"mobile-grid-button-sort-selected"},true,false);var o=i?i.getAttribute("data-role"):"asc";BX.ajax.post("/mobile/?mobile_action=mobile_grid_sort",{sessid:BX.bitrix_sessid(),sortBy:t,sortOrder:o,action:"sort",gridId:this.gridId},BX.proxy(function(){window.BXMobileApp.UI.Page.LoadingScreen.hide();try{if(this.selectedField!=t){fabric.Answers.sendCustomEvent("TASK/SORT_FIELD_SET/"+t,{})}}catch(e){}window.BXMobileApp.onCustomEvent(this.eventName,{sortBy:t,sortOrder:o,action:"sort",gridId:this.gridId},true);app.closeModalDialog()},this))},selectField:function(e){var t=BX.findChildren(BX("bx-mobile-interface-sort-block"),{className:"mobile-grid-field-selected"},true);if(t){for(var i=0;i<t.length;i++){BX.removeClass(t[i],"mobile-grid-field-selected")}}BX.addClass(e,"mobile-grid-field-selected")},selectOrder:function(e){var t=BX("bx-mobile-interface-sort-block").querySelector("[data-role='asc']");var i=BX("bx-mobile-interface-sort-block").querySelector("[data-role='desc']");if(e=="asc"){BX.removeClass(i,"mobile-grid-button-sort-selected");BX.addClass(t,"mobile-grid-button-sort-selected")}else if(e=="desc"){BX.removeClass(t,"mobile-grid-button-sort-selected");BX.addClass(i,"mobile-grid-button-sort-selected")}}};