{"version":3,"file":"mobile.js","sources":["src/mobile.js"],"sourcesContent":["import {Loc} from 'main.core';\n\nlet\n\tBX = window.BX,\n\tBXMobileApp = window.BXMobileApp;\n\nlet nodeText = (function ()\n{\n\tlet nodeText = function (node, container)\n\t{\n\t\tthis.node = node;\n\t\tthis.container = container;\n\t\tthis.click = BX.delegate(this.click, this);\n\t\tthis.callback = BX.delegate(this.callback, this);\n\t\tBX.bind(this.container, \"click\", this.click);\n\t};\n\tnodeText.prototype = {\n\t\tclick: function (e)\n\t\t{\n\t\t\tthis.show();\n\t\t\treturn BX.PreventDefault(e);\n\t\t},\n\t\tshow: function ()\n\t\t{\n\t\t\tthis.node.value = this.node.value.replace(/<br\\s*[\\/]?>/gi, '');\n\t\t\twindow.app.exec('showPostForm', {\n\t\t\t\tattachButton: {items: []},\n\t\t\t\tattachFileSettings: {},\n\t\t\t\tattachedFiles: [],\n\t\t\t\textraData: {},\n\t\t\t\tmentionButton: {},\n\t\t\t\tsmileButton: {},\n\t\t\t\tmessage: {text: BX.util.htmlspecialcharsback(this.node.value)},\n\t\t\t\tokButton: {\n\t\t\t\t\tcallback: this.callback,\n\t\t\t\t\tname: Loc.getMessage('interface_form_save')\n\t\t\t\t},\n\t\t\t\tcancelButton: {\n\t\t\t\t\tcallback: function ()\n\t\t\t\t\t{\n\t\t\t\t\t},\n\t\t\t\t\tname: Loc.getMessage('interface_form_cancel')\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tcallback: function (data)\n\t\t{\n\t\t\tconsole.log(data.text);\n\t\t\tdata.text = (data.text || '');\n\t\t\tthis.node.value = data.text;\n\t\t\tif (data.text === '')\n\t\t\t{\n\t\t\t\tthis.container.innerHTML = `<span class=\"placeholder\">${this.node.getAttribute('placeholder')}</span>`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.container.textContent = data.text;\n\t\t\t}\n\t\t\tBX.onCustomEvent(this, 'onChange', [this, this.node]);\n\t\t}\n\t};\n\treturn nodeText;\n})();\n\nwindow.app.exec('enableCaptureKeyboard', true);\n\nBX.Mobile.Field.String = function (params)\n{\n\tthis.init(params);\n};\n\nBX.Mobile.Field.String.prototype = {\n\t__proto__: BX.Mobile.Field.prototype,\n\tbindElement: function (node)\n\t{\n\t\tlet result = null;\n\t\tif (BX(node))\n\t\t{\n\t\t\tresult = new nodeText(node, BX(`${node.id}_target`));\n\t\t}\n\t\treturn result;\n\t}\n};"],"names":["BX","window","BXMobileApp","nodeText","node","container","click","delegate","callback","bind","prototype","e","show","PreventDefault","value","replace","app","exec","attachButton","items","attachFileSettings","attachedFiles","extraData","mentionButton","smileButton","message","text","util","htmlspecialcharsback","okButton","name","Loc","getMessage","cancelButton","data","console","log","innerHTML","getAttribute","textContent","onCustomEvent","Mobile","Field","String","params","init","__proto__","bindElement","result","id"],"mappings":"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"}