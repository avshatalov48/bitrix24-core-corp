{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Reflection} from \"main.core\";\nimport {BaseButton, ButtonManager} from \"ui.buttons\";\n\nconst namespace = Reflection.namespace('BX.Crm.Component');\nconst Viewer = Reflection.namespace('BX.UI.Viewer');\n\ndeclare type SignDocumentViewParameters = {\n\tpdfNode: ?Element,\n\tpdfSource: ?string,\n\tprintButtonId: ?string,\n\tdownloadButtonId: ?string,\n};\n\nlet defaultComponent = null;\n\n/**\n * @memberOf BX.Crm.Component\n */\nclass SignDocumentView\n{\n\tpdfNode: ?Element;\n\tpdfSource: ?string;\n\tprintButton: ?BaseButton;\n\tdownloadButton: ?BaseButton;\n\tviewer: ?Viewer.SingleDocumentController;\n\n\tconstructor(parameters: SignDocumentViewParameters)\n\t{\n\t\tthis.pdfNode = parameters.pdfNode;\n\t\tthis.pdfSource = parameters.pdfSource;\n\t\tif (parameters.printButtonId)\n\t\t{\n\t\t\tthis.printButton = ButtonManager.createByUniqId(parameters.printButtonId);\n\t\t}\n\t\tif (parameters.downloadButtonId)\n\t\t{\n\t\t\tthis.downloadButton = ButtonManager.createByUniqId(parameters.downloadButtonId);\n\t\t}\n\n\t\tthis.#initViewer();\n\t\tthis.#bindEvents();\n\n\t\tdefaultComponent = this;\n\t}\n\n\t#initViewer(): void\n\t{\n\t\tconst viewer = this.getViewer();\n\t\tif (!viewer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tviewer.setItems([Viewer.buildItemByNode(this.pdfNode)]);\n\t\tviewer.setPdfSource(this.pdfSource);\n\t\tviewer.setScale(0.92);\n\t\tviewer.open();\n\t}\n\n\tgetViewer(): ?Viewer.SingleDocumentController\n\t{\n\t\tif (!this.viewer && this.pdfNode)\n\t\t{\n\t\t\tthis.viewer = new Viewer.SingleDocumentController({baseContainer: this.pdfNode});\n\t\t}\n\n\t\treturn this.viewer ?? null;\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tif (this.printButton && this.getViewer())\n\t\t{\n\t\t\tthis.printButton.bindEvent('click', () => {\n\t\t\t\tthis.getViewer().print();\n\t\t\t})\n\t\t}\n\t\tif (this.downloadButton)\n\t\t{\n\t\t\tthis.downloadButton.bindEvent('click', () => {\n\t\t\t\twindow.open(this.pdfSource, '_blank');\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic getDefaultComponent(): ?SignDocumentView\n\t{\n\t\treturn defaultComponent;\n\t}\n}\n\nnamespace.SignDocumentView = SignDocumentView;\n"],"names":["namespace","Reflection","Viewer","defaultComponent","SignDocumentView","parameters","pdfNode","pdfSource","printButtonId","printButton","ButtonManager","createByUniqId","downloadButtonId","downloadButton","viewer","SingleDocumentController","baseContainer","getViewer","setItems","buildItemByNode","setPdfSource","setScale","open","bindEvent","print","window"],"mappings":";;;;;;;;CAGA,IAAMA,SAAS,GAAGC,oBAAU,CAACD,SAAX,CAAqB,kBAArB,CAAlB;CACA,IAAME,MAAM,GAAGD,oBAAU,CAACD,SAAX,CAAqB,cAArB,CAAf;CASA,IAAIG,gBAAgB,GAAG,IAAvB;CAEA;CACA;CACA;;;;;;KACMC;CAQL,4BAAYC,UAAZ,EACA;CAAA;;CAAA;;CAAA;;CACC,SAAKC,OAAL,GAAeD,UAAU,CAACC,OAA1B;CACA,SAAKC,SAAL,GAAiBF,UAAU,CAACE,SAA5B;;CACA,QAAIF,UAAU,CAACG,aAAf,EACA;CACC,WAAKC,WAAL,GAAmBC,wBAAa,CAACC,cAAd,CAA6BN,UAAU,CAACG,aAAxC,CAAnB;CACA;;CACD,QAAIH,UAAU,CAACO,gBAAf,EACA;CACC,WAAKC,cAAL,GAAsBH,wBAAa,CAACC,cAAd,CAA6BN,UAAU,CAACO,gBAAxC,CAAtB;CACA;;CAED;;CACA;;CAEAT,IAAAA,gBAAgB,GAAG,IAAnB;CACA;;;;iCAgBD;CAAA;;CACC,UAAI,CAAC,KAAKW,MAAN,IAAgB,KAAKR,OAAzB,EACA;CACC,aAAKQ,MAAL,GAAc,IAAIZ,MAAM,CAACa,wBAAX,CAAoC;CAACC,UAAAA,aAAa,EAAE,KAAKV;CAArB,SAApC,CAAd;CACA;;CAED,6BAAO,KAAKQ,MAAZ,uDAAsB,IAAtB;CACA;;;2CAmBD;CACC,aAAOX,gBAAP;CACA;;;;;yBAzCD;CACC,MAAMW,MAAM,GAAG,KAAKG,SAAL,EAAf;;CACA,MAAI,CAACH,MAAL,EACA;CACC;CACA;;CACDA,EAAAA,MAAM,CAACI,QAAP,CAAgB,CAAChB,MAAM,CAACiB,eAAP,CAAuB,KAAKb,OAA5B,CAAD,CAAhB;CACAQ,EAAAA,MAAM,CAACM,YAAP,CAAoB,KAAKb,SAAzB;CACAO,EAAAA,MAAM,CAACO,QAAP,CAAgB,IAAhB;CACAP,EAAAA,MAAM,CAACQ,IAAP;CACA;;yBAaD;CAAA;;CACC,MAAI,KAAKb,WAAL,IAAoB,KAAKQ,SAAL,EAAxB,EACA;CACC,SAAKR,WAAL,CAAiBc,SAAjB,CAA2B,OAA3B,EAAoC,YAAM;CACzC,MAAA,KAAI,CAACN,SAAL,GAAiBO,KAAjB;CACA,KAFD;CAGA;;CACD,MAAI,KAAKX,cAAT,EACA;CACC,SAAKA,cAAL,CAAoBU,SAApB,CAA8B,OAA9B,EAAuC,YAAM;CAC5CE,MAAAA,MAAM,CAACH,IAAP,CAAY,KAAI,CAACf,SAAjB,EAA4B,QAA5B;CACA,KAFD;CAGA;CACD;;CAQFP,SAAS,CAACI,gBAAV,GAA6BA,gBAA7B;;;;"}