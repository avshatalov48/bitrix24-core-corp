this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,t,a){"use strict";var r=function(){function e(t){babelHelpers.classCallCheck(this,e);this.filterId=t.filterId;this.signedParameters=t.signedParameters;this.sidePanelManager=BX.SidePanel.Instance;this.chart=null;this.chartData=null;this.loader=null}babelHelpers.createClass(e,[{key:"initUiFilterManager",value:function e(){this.filterManager=BX.Main.filterManager.getById(this.filterId)}},{key:"bindEvents",value:function e(){a.EventEmitter.subscribe("BX.Main.Filter:apply",this.onFilterApply.bind(this))}},{key:"render",value:function e(t,a){var r=this;setTimeout(function(){return r.create(t,a)},300)}},{key:"create",value:function e(a,r){am4core.useTheme(am4themes_animated);this.chart=am4core.create(a,am4charts.XYChart);this.chart.data=r;this.chart.paddingRight=40;this.chart.responsive.enabled=true;this.createAxises();this.createColumn("plan",t.Loc.getMessage("TASKS_SCRUM_TEAM_SPEED_CHART_PLAN_COLUMN"),"#2882b3");this.createColumn("done",t.Loc.getMessage("TASKS_SCRUM_TEAM_SPEED_CHART_DONE_COLUMN"),"#9c1f1f");this.createLegend();if(r.length===0){this.showLoader(t.Loc.getMessage("TASKS_SCRUM_TEAM_SPEED_CHART_NOT_DATA_LABEL"))}}},{key:"createAxises",value:function e(){var t=this.chart.xAxes.push(new am4charts.CategoryAxis);t.dataFields.category="sprintName";t.renderer.grid.template.location=0;var a=t.renderer.labels.template;a.wrap=true;a.maxWidth=120;var r=this.chart.yAxes.push(new am4charts.ValueAxis);r.min=0}},{key:"createColumn",value:function e(t,a,r){var i=this.chart.series.push(new am4charts.ColumnSeries);i.dataFields.valueY=t;i.dataFields.categoryX="sprintName";i.name=a;i.stroke=am4core.color(r);i.fill=am4core.color(r);return i}},{key:"createLegend",value:function e(){this.chart.legend=new am4charts.Legend;this.chart.legend.position="bottom";this.chart.legend.paddingBottom=20;this.chart.legend.itemContainers.template.clickable=false}},{key:"showLoader",value:function e(a){this.removeLoader();this.loader=this.chart.tooltipContainer.createChild(am4core.Container);this.loader.background.fill=am4core.color("#fff");this.loader.background.fillOpacity=.8;this.loader.width=am4core.percent(100);this.loader.height=am4core.percent(100);if(!t.Type.isUndefined(a)){var r=this.loader.createChild(am4core.Label);r.text=a;r.align="center";r.valign="middle";r.fontSize=20}}},{key:"removeLoader",value:function e(){if(this.loader!==null){this.loader.dispose()}}},{key:"onFilterApply",value:function e(a){var r=this;var i=a.getCompatData(),s=babelHelpers.slicedToArray(i,5),n=s[0],l=s[1],h=s[2],o=s[3],c=s[4];if(this.filterId!==n){return}if(this.chart){this.showLoader()}t.ajax.runComponentAction("bitrix:tasks.scrum.team.speed","applyFilter",{mode:"class",signedParameters:this.signedParameters,data:{}}).then(function(e){if(r.chart){var a=e.data;r.chart.data=a;if(a.length>0){r.removeLoader()}else{r.showLoader(t.Loc.getMessage("TASKS_SCRUM_TEAM_SPEED_CHART_NOT_DATA_LABEL"))}}})}}]);return e}();e.TeamSpeedChart=r})(this.BX.Tasks.Scrum=this.BX.Tasks.Scrum||{},BX,BX.Event);
//# sourceMappingURL=script.map.js