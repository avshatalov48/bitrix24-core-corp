{"version":3,"file":"script.js","sources":["src/ajaxprocessor.js","src/form.js","src/tabs.js","src/dateend.js","src/grat.js","src/editor.js","src/autosave.js"],"sourcesContent":["import { Type } from 'main.core';\n\nexport default class AjaxProcessor\n{\n\thtmlWasInserted: boolean = false;\n\tscriptsLoaded:boolean = false;\n\n\tconstructor()\n\t{\n\n\t}\n\n\tprocessCSS(block, callback: Function): void\n\t{\n\t\tif (\n\t\t\tType.isArray(block.CSS)\n\t\t\t&& block.CSS.length > 0\n\t\t)\n\t\t{\n\t\t\tBX.load(block.CSS, callback);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t};\n\n\tprocessExternalJS(block, callback: Function): void\n\t{\n\t\tif (\n\t\t\tType.isArray(block.JS)\n\t\t\t&& block.JS.length > 0\n\t\t)\n\t\t{\n\t\t\tBX.load(block.JS, callback);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t}\n\n\tprocessAjaxBlockInsertHTML(block, container: HTMLElement, callbackExternal: Function): void\n\t{\n\t\tcontainer.appendChild(BX.create('DIV', {\n\t\t\thtml: block.CONTENT\n\t\t}));\n\n\t\tthis.htmlWasInserted = true;\n\t\tif (this.scriptsLoaded)\n\t\t{\n\t\t\tthis.processInlineJS(block, callbackExternal);\n\t\t}\n\t}\n\n\tprocessInlineJS(block, callbackExternal: Function): void\n\t{\n\t\tthis.scriptsLoaded = true;\n\t\tif (this.htmlWasInserted)\n\t\t{\n\t\t\tBX.ajax.processRequestData(block.CONTENT, {\n\t\t\t\tscriptsRunFirst: false,\n\t\t\t\tdataType: 'HTML'\n\t\t\t});\n\t\t\tcallbackExternal();\n\t\t}\n\t}\n}","import {Type, ajax as Ajax, Loc, Dom, Reflection } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport AjaxProcessor from './ajaxprocessor';\n\nexport default class PostForm\n{\n\tstatic instance = null;\n\n\tlazyLoad: boolean = null;\n\tajaxUrl: string = '';\n\tinited: boolean = false;\n\tloaded: boolean = false;\n\tcontainer: HTMLElement = null;\n\tcontainerMicro: HTMLElement = null;\n\tcontainerMicroInner: HTMLElement = null;\n\tclickDisabled: boolean = false;\n\tlastWait: HTMLElement[] = [];\n\tanimationStartHeight: number = 0;\n\tinitedEditorsList: string[] = [];\n\toptions: { [key: string]: any } = {};\n\n\tstatic setInstance(instance)\n\t{\n\t\tPostForm.instance = instance;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\treturn PostForm.instance;\n\t}\n\n\tconstructor(params)\n\t{\n\t\tthis.init(params);\n\t\tPostForm.setInstance(this);\n\t}\n\n\tsetOption(key: string, value: any): void\n\t{\n\t\tif (!Type.isStringFilled(key))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.options[key] = value;\n\t}\n\n\tonShow(): void\n\t{\n\t\tif(\n\t\t\t!Type.isStringFilled(this.options.startVideoRecorder)\n\t\t\t|| this.options.startVideoRecorder !== 'Y'\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tconst editorForm = document.getElementById('divoPostFormLHE_blogPostForm');\n\t\t\tif (!editorForm)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(editorForm, 'OnShowLHE', new BaseEvent({\n\t\t\t\tcompatData: [ 'justShow' ]\n\t\t\t}));\n\n\t\t\tBX.VideoRecorder.start('blogPostForm', 'post');\n\t\t}, 500);\n\t};\n\n\tonSliderClose(): void\n\t{\n\t\tconst sliderInstance = BX.SidePanel.Instance.getTopSlider();\n\t\tif (!sliderInstance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.SidePanel.Instance.postMessageAll(window, 'SidePanel.Wrapper:onClose', {\n\t\t\tsliderData: sliderInstance.getData(),\n\t\t});\n\t};\n\n\tinit(params: { [key: string]: any }): void\n\t{\n\t\tif (this.inited !== true)\n\t\t{\n\t\t\tthis.inited = true;\n\t\t\tthis.lazyLoad = !Type.isUndefined(params.lazyLoad) ? !!params.lazyLoad : false;\n\t\t\tthis.ajaxUrl = Type.isStringFilled(params.ajaxUrl) ? params.ajaxUrl : '';\n\t\t\tthis.container = Type.isDomNode(params.container) ? params.container : null;\n\t\t\tthis.containerMicro = Type.isDomNode(params.containerMicro) ? params.containerMicro : null;\n\t\t\tthis.containerMicroInner = Type.isDomNode(params.containerMicroInner) ? params.containerMicroInner : null;\n\t\t\tthis.successPostId = !Type.isUndefined(params.successPostId) && parseInt(params.successPostId) > 0 ? parseInt(params.successPostId) : 0;\n\n\t\t\t//region dnd\n\t\t\tif (this.containerMicro)\n\t\t\t{\n\t\t\t\tthis.containerMicro.setAttribute('dropzone', 'copy f:*\\/*');\n\n\t\t\t\tlet timerListenEnter = 0;\n\t\t\t\tconst stopListenEnter = (event) => {\n\t\t\t\t\tif (timerListenEnter > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tclearTimeout(timerListenEnter);\n\t\t\t\t\t\ttimerListenEnter = 0;\n\t\t\t\t\t}\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t};\n\t\t\t\tconst fireDragEnter = (event) => {\n\t\t\t\t\tstopListenEnter(event);\n\t\t\t\t\tthis.containerMicro.click();\n\t\t\t\t};\n\t\t\t\tconst startListenEnter = (event) => {\n\t\t\t\t\tif (timerListenEnter <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ttimerListenEnter = setTimeout(() => { fireDragEnter(event); }, 3000);\n\t\t\t\t\t}\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t};\n\n\t\t\t\tthis.containerMicro.addEventListener('dragover', startListenEnter);\n\t\t\t\tthis.containerMicro.addEventListener('dragenter', startListenEnter);\n\t\t\t\tthis.containerMicro.addEventListener('dragleave', stopListenEnter);\n\t\t\t\tthis.containerMicro.addEventListener('dragexit', stopListenEnter);\n\t\t\t\tthis.containerMicro.addEventListener('drop', stopListenEnter);\n\t\t\t}\n\t\t\t//region\n\t\t}\n\n\t\tconst sliderInstance = BX.SidePanel.Instance.getTopSlider();\n\t\tif (sliderInstance)\n\t\t{\n\t\t\tif (this.successPostId > 0)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.postMessage(window, 'Socialnetwork.PostForm:onAdd', {\n\t\t\t\t\toriginatorSliderId: sliderInstance.getData().get('sliderId'),\n\t\t\t\t\tsuccessPostId: this.successPostId,\n\t\t\t\t});\n\n\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t}\n\t\t\telse if (!sliderInstance.getData().get('initialized'))\n\t\t\t{\n\t\t\t\tEventEmitter.subscribe(sliderInstance, 'BX.Socialnetwork.SidePanel.Slider:onClose', this.onSliderClose);\n\t\t\t\tsliderInstance.getData().set('initialized', true);\n\t\t\t}\n\t\t}\n\t};\n\n\tget(params: { [key: string]: any }): void\n\t{\n\t\tif (this.clickDisabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tthis.lazyLoad\n\t\t\t&& !this.loaded\n\t\t)\n\t\t{\n\t\t\tthis.clickDisabled = true;\n\t\t\tthis.animationStartHeight = this.containerMicro.offsetHeight;\n\n\t\t\tif (\n\t\t\t\tType.isStringFilled(params.loaderType)\n\t\t\t\t&& params.loaderType === 'tab'\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.showWaitTab();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.containerMicroInner.style.display = 'none';\n\t\t\t\tthis.showWait(this.containerMicro);\n\t\t\t}\n\n\t\t\tAjax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: this.ajaxUrl,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'SBPE_get_full_form',\n\t\t\t\t\tsessid: Loc.getMessage('bitrix_sessid')\n\t\t\t\t},\n\t\t\t\tonsuccess: (result) => {\n\t\t\t\t\tthis.loaded = true;\n\t\t\t\t\tthis.clickDisabled = false;\n\t\t\t\t\tthis.closeWait();\n\n\t\t\t\t\tif(result.success)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.processAjaxBlock(result.PROPS, params.callback);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonfailure: () => {\n\t\t\t\t\tthis.clickDisabled = false;\n\t\t\t\t\tthis.closeWait();\n\t\t\t\t\tthis.containerMicroInner.style.display = 'block';\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (Type.isFunction(params.callback))\n\t\t{\n\t\t\tparams.callback();\n\t\t}\n\t};\n\n\tprocessAjaxBlock(block, callbackExternal: Function): void\n\t{\n\t\tif (!block)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst processor = new AjaxProcessor();\n\n\t\tprocessor.processCSS(block, () => {\n\t\t\tprocessor.processAjaxBlockInsertHTML(block, this.container, callbackExternal);\n\t\t});\n\t\tprocessor.processExternalJS(block, () => {\n\t\t\tprocessor.processInlineJS(block, callbackExternal);\n\t\t});\n\t};\n\n\tshowWait(node: HTMLElement): HTMLElement\n\t{\n\t\tconst waiterNode = node.bxmsg = document.body.appendChild(Dom.create('DIV', {\n\t\t\tprops: {\n\t\t\t\tid: `wait_${node.id}`,\n\t\t\t\tclassName: 'feed-add-post-loader-cont'\n\t\t\t},\n\t\t\thtml: '<svg class=\"feed-add-post-loader\" viewBox=\"25 25 50 50\"><circle class=\"feed-add-post-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"></circle><circle class=\"feed-add-post-loader-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"></circle></svg>'\n\t\t}));\n\n\t\tsetTimeout(() => {\n\t\t\tthis.adjustWait(node);\n\t\t}, 10);\n\t\tthis.lastWait.push(waiterNode);\n\n\t\treturn waiterNode;\n\t};\n\n\tshowWaitTab(): void\n\t{\n\t\tif (\n\t\t\t!BX('feed-add-post-more-icon')\n\t\t\t|| !BX('feed-add-post-more-icon-waiter')\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX('feed-add-post-more-icon').style.display = 'none';\n\t\tBX('feed-add-post-more-icon-waiter').style.display = 'block';\n\t};\n\n\tcloseWait(): void\n\t{\n\t\tconst waiterNode = this.containerMicro.bxmsg;\n\n\t\tif (waiterNode && waiterNode.parentNode)\n\t\t{\n\t\t\tfor (let i=0, len=this.lastWait.length; i<len; i++)\n\t\t\t{\n\t\t\t\tif (waiterNode === this.lastWait[i])\n\t\t\t\t{\n\t\t\t\t\tthis.lastWait = BX.util.deleteFromArray(this.lastWait, i);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twaiterNode.parentNode.removeChild(waiterNode);\n\t\t\tif (this.containerMicro)\n\t\t\t{\n\t\t\t\tthis.containerMicro.bxmsg = null;\n\t\t\t}\n\n\t\t\tDom.clean(waiterNode);\n\t\t\tDom.remove(waiterNode);\n\t\t}\n\n\t\tif (\n\t\t\tBX('feed-add-post-more-icon')\n\t\t\t&& BX('feed-add-post-more-icon-waiter')\n\t\t\t&& BX('feed-add-post-more-icon').style.display === 'none'\n\t\t)\n\t\t{\n\t\t\tBX('feed-add-post-more-icon').style.display = 'block';\n\t\t\tBX('feed-add-post-more-icon-waiter').style.display = 'none';\n\t\t}\n\t};\n\n\tadjustWait(node: HTMLElement): void\n\t{\n\t\tif (!node.bxmsg)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst nodePosition = BX.pos(node);\n\t\tlet topDelta = nodePosition.top + 15;\n\n\t\tif (topDelta < BX.GetDocElement().scrollTop)\n\t\t{\n\t\t\ttopDelta = BX.GetDocElement().scrollTop + 5;\n\t\t}\n\n\t\tnode.bxmsg.style.top = `${(topDelta + 5)}px`;\n\n\t\tif (node === BX.GetDocElement())\n\t\t{\n\t\t\tnode.bxmsg.style.right = '5px';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.bxmsg.style.left = `${(nodePosition.left + parseInt((nodePosition.width - node.bxmsg.offsetWidth) / 2))}px`;\n\t\t}\n\t};\n\n\ttasksTaskEvent(taskId: number): void\n\t{\n\t\tif (!Reflection.getClass('BX.UI.Notification.Center'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst taskLink = Loc.getMessage('PATH_TO_USER_TASKS_TASK').replace('#user_id#', Loc.getMessage('USER_ID')).replace('#task_id#', taskId).replace('#action#', 'view');\n\n\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('BLOG_POST_EDIT_T_CREATE_TASK_SUCCESS_TITLE'),\n\t\t\tactions: [{\n\t\t\t\ttitle: Loc.getMessage('BLOG_POST_EDIT_T_CREATE_TASK_BUTTON_TITLE'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (event, balloon, action) => {\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\twindow.top.BX.SidePanel.Instance.open(taskLink);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}]\n\t\t});\n\t};\n}","import {Type, Loc, Dom, Event, Runtime, ajax as Ajax } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport PostForm from './form';\nimport { MenuManager } from \"main.popup\";\n\nexport default class PostFormTabs extends EventEmitter\n{\n\tstatic instance = null;\n\n\tinited: boolean = false;\n\n\ttabs: { [key: string]: any } = {};\n\tbodies: { [key: string]: any } = {};\n\tactive = null;\n\tanimation = null;\n\tanimationStartHeight:number = 0;\n\tpreviousTab = null;\n\tmenu = null;\n\tlistsMenu = null;\n\tmenuItems = [];\n\tlastWait: HTMLElement[] = [];\n\tclickDisabled: boolean = false;\n\n\ttabContainer: HTMLElement = null;\n\tarrow: HTMLElement = null;\n\n\tconfig = {\n\t\tid: {\n\t\t\tmessage: 'message',\n\t\t\ttask: 'tasks',\n\t\t\tcalendar: 'calendar',\n\t\t\tfile: 'file',\n\t\t\tgratitude: 'grat',\n\t\t\timportant: 'important',\n\t\t\tvote: 'vote',\n\t\t\tmore: 'more',\n\t\t\tlistItem: 'lists',\n\t\t},\n\t};\n\n\tstatic setInstance(instance)\n\t{\n\t\tPostFormTabs.instance = instance;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\tif (PostFormTabs.instance === null)\n\t\t{\n\t\t\tnew PostFormTabs();\n\t\t}\n\n\t\treturn PostFormTabs.instance;\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Socialnetwork.Livefeed.Post.Form.Tabs');\n\t\tthis.init();\n\t\tthis.emit('onInitialized', { tabsInstance: this });\n\n\t\tPostFormTabs.setInstance(this);\n\t\twindow.SBPETabs = this;\n\t}\n\n\tinit(): void\n\t{\n\t\tthis.tabContainer = document.getElementById('feed-add-post-form-tab');\n\t\tthis.arrow = document.getElementById('feed-add-post-form-tab-arrow');\n\t\tthis.tabs = {};\n\t\tthis.bodies = {};\n\n\t\tconst tabsList = this.tabContainer && this.tabContainer.querySelectorAll('span.feed-add-post-form-link');\n\t\tif (tabsList)\n\t\t{\n\t\t\tfor (let i = 0; i < tabsList.length; i++)\n\t\t\t{\n\t\t\t\tconst id = tabsList[i].getAttribute('id').replace('feed-add-post-form-tab-', '');\n\t\t\t\tconst limited = tabsList[i].getAttribute('limited');\n\n\t\t\t\tthis.tabs[id] = tabsList[i];\n\n\t\t\t\tif (this.tabs[id].style.display === 'none')\n\t\t\t\t{\n\t\t\t\t\tthis.menuItems.push({\n\t\t\t\t\t\ttabId : id,\n\t\t\t\t\t\ttext : tabsList[i].getAttribute('data-name'),\n\t\t\t\t\t\tclassName : `menu-popup-no-icon feed-add-post-form-${id} feed-add-post-form-${id}-more`,\n\t\t\t\t\t\tonclick : this.createOnClick(id, tabsList[i].getAttribute('data-name'), tabsList[i].getAttribute('data-onclick'), (tabsList[i].getAttribute('data-limited') === 'Y'))\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.tabs[id] = this.tabs[id].parentNode;\n\t\t\t\t}\n\n\t\t\t\tthis.bodies[id] = document.getElementById(`feed-add-post-content-${id}`);\n\t\t\t}\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.file])\n\t\t{\n\t\t\tthis.bodies[this.config.id.file] = [ this.bodies[this.config.id.message] ];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.calendar])\n\t\t{\n\t\t\tthis.bodies[this.config.id.calendar] = [ this.bodies[this.config.id.calendar] ];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.vote])\n\t\t{\n\t\t\tthis.bodies[this.config.id.vote] = [\n\t\t\t\tthis.bodies[this.config.id.message],\n\t\t\t\tthis.bodies[this.config.id.vote],\n\t\t\t];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.more])\n\t\t{\n\t\t\tthis.bodies[this.config.id.more] = null;\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.important])\n\t\t{\n\t\t\tthis.bodies[this.config.id.important] = [\n\t\t\t\tthis.bodies[this.config.id.message],\n\t\t\t\tthis.bodies[this.config.id.important],\n\t\t\t];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.gratitude])\n\t\t{\n\t\t\tthis.bodies[this.config.id.gratitude] = [\n\t\t\t\tthis.bodies[this.config.id.message],\n\t\t\t\tthis.bodies[this.config.id.gratitude],\n\t\t\t];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.listItem])\n\t\t{\n\t\t\tthis.bodies[this.config.id.listItem] = [ this.bodies[this.config.id.listItem] ];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.task])\n\t\t{\n\t\t\tthis.bodies[this.config.id.task] = [ this.bodies[this.config.id.task] ];\n\t\t}\n\n\t\tfor (let ii in this.bodies)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.bodies.hasOwnProperty(ii)\n\t\t\t\t&& Type.isDomNode(this.bodies[ii])\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.bodies[ii] = [ this.bodies[ii] ];\n\t\t\t}\n\n\t\t}\n\n\t\tthis.inited = true;\n\t\tthis.previousTab = false;\n\n\t\tconst uploadFileNode = document.getElementById('bx-b-uploadfile-blogPostForm');\n\t\tif (uploadFileNode)\n\t\t{\n\t\t\tuploadFileNode.setAttribute('bx-press', 'pressOut');\n\t\t\tEvent.bind(uploadFileNode, 'mousedown', () => {\n\t\t\t\tuploadFileNode.setAttribute(\"bx-press\", (uploadFileNode.getAttribute(\"bx-press\") == \"pressOut\" ? \"pressOn\" : \"pressOut\"));\n\t\t\t});\n\t\t}\n\n\t\tconst form = document.getElementById('blogPostForm');\n\t\tif (!form)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tif (!form.changePostFormTab)\n\t\t{\n\t\t\tform.appendChild(Dom.create('INPUT', {\n\t\t\t\tprops : {\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tname: 'changePostFormTab',\n\t\t\t\t\tvalue: ''\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tthis.subscribe('changePostFormTab', (event) => {\n\t\t\tconst { type } = event.getData();\n\n\t\t\tif (type === this.config.id.more)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tform.changePostFormTab.value = type;\n\n\t\t\tif (form['UF_BLOG_POST_IMPRTNT'])\n\t\t\t{\n\t\t\t\tform['UF_BLOG_POST_IMPRTNT'].value = (type === this.config.id.important ? '1' : '0');\n\t\t\t}\n\t\t});\n\t};\n\n\tcreateOnClick(id, name:string, onclick: string, limited: boolean)\n\t{\n\t\treturn () => {\n\t\t\tconst btn = document.getElementById('feed-add-post-form-link-more');\n\t\t\tconst btnText = document.getElementById('feed-add-post-form-link-text');\n\n\t\t\tif (!limited)\n\t\t\t{\n\t\t\t\tbtnText.innerHTML = name;\n\t\t\t\tif (id !== this.config.id.listItem)\n\t\t\t\t{\n\t\t\t\t\tbtn.className = `feed-add-post-form-link feed-add-post-form-link-more feed-add-post-form-link-active feed-add-post-form-${id}-link`;\n\t\t\t\t\tthis.changePostFormTab(id, false);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbtn.className = `feed-add-post-form-link feed-add-post-form-link-more feed-add-post-form-${id}-link`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(onclick))\n\t\t\t{\n\t\t\t\tBX.evalGlobal(onclick);\n\t\t\t}\n\n\t\t\tthis.menu.popupWindow.close();\n\t\t}\n\t};\n\n\tchangePostFormTab(type, iblock)\n\t{\n\t\tif (this.clickDisabled)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.setActive(type, iblock);\n\t};\n\n\tsetActive(type?:string, iblock)\n\t{\n\t\tif (\n\t\t\tType.isNull(type)\n\t\t\t|| (\n\t\t\t\tthis.active === type\n\t\t\t\t&& type !== this.config.id.listItem\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn this.active;\n\t\t}\n\t\telse if (!this.tabs[type])\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst needAnimation = (type !== this.config.id.task || this.isTaskTabLoaded());\n\t\tif (needAnimation)\n\t\t{\n\t\t\tthis.startAnimation();\n\t\t}\n\n\t\tfor (let ii in this.tabs)\n\t\t{\n\t\t\tif (this.tabs.hasOwnProperty(ii) && ii !== type)\n\t\t\t{\n\t\t\t\tthis.tabs[ii].classList.remove('feed-add-post-form-link-active');\n\t\t\t\tif (\n\t\t\t\t\tthis.bodies[ii] == null\n\t\t\t\t\t|| this.bodies[type] == null\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfor (let jj = 0; jj < this.bodies[ii].length; jj++)\n\t\t\t\t{\n\t\t\t\t\tif (this.bodies[type][jj] != this.bodies[ii][jj])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.adjust(this.bodies[ii][jj], {\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!!this.tabs[type])\n\t\t{\n\t\t\tthis.active = type;\n\n\t\t\tconst tabPosTab = BX.pos(this.tabs[type], true);\n\n\t\t\tthis.arrow.style.display = 'block';\n\t\t\tthis.arrow.style.top = `${tabPosTab.bottom}px`;\n\n\t\t\tconst leftStart = parseInt(this.arrow.style.left) || 0;\n\t\t\tconst widthStart = parseInt(this.arrow.style.width) || 0;\n\n\t\t\t(new BX.easing({\n\t\t\t\tduration : 200,\n\t\t\t\tstart: { left: leftStart, width:  widthStart },\n\t\t\t\tfinish: { left: tabPosTab.left, width: tabPosTab.width },\n\t\t\t\ttransition: BX.easing.makeEaseInOut(BX.easing.transitions.quart),\n\t\t\t\tstep : (state) => {\n\t\t\t\t\tthis.arrow.style.left = `${state.left}px`;\n\t\t\t\t\tthis.arrow.style.width = `${state.width}px`;\n\t\t\t\t},\n\n\t\t\t\tcomplete : () => {\n\t\t\t\t\tthis.arrow.style.display = 'none';\n\t\t\t\t\tthis.tabs[type].classList.add('feed-add-post-form-link-active');\n\t\t\t\t}\n\t\t\t})).animate();\n\n\t\t\tif (\n\t\t\t\tthis.previousTab === this.config.id.file\n\t\t\t\t|| type === this.config.id.file\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet hasValuesFile = false;\n\t\t\t\tlet hasValuesDocs = false;\n\n\t\t\t\tconst messageBody = document.getElementById('divoPostFormLHE_blogPostForm');\n\n\t\t\t\tif (\n\t\t\t\t\t!!messageBody\n\t\t\t\t\t&& !!messageBody.childNodes\n\t\t\t\t\t&& messageBody.childNodes.length > 0\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tfor (let ii in messageBody.childNodes)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!messageBody.childNodes.hasOwnProperty(ii))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (messageBody.childNodes[ii].className === 'file-selectdialog')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst nodeFile = messageBody.childNodes[ii];\n\t\t\t\t\t\t\tconst values1 = nodeFile.querySelector('.file-placeholder-tbody');\n\t\t\t\t\t\t\tconst values2 = nodeFile.querySelector('.feed-add-photo-block');\n\t\t\t\t\t\t\tif (values1.rows > 0 || !!values2 && values2.length > 1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thasValuesFile = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (\n\t\t\t\t\t\t\tType.isStringFilled(messageBody.childNodes[ii].className)\n\t\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\t\tmessageBody.childNodes[ii].className.indexOf('wduf-selectdialog') >= 0\n\t\t\t\t\t\t\t\t|| messageBody.childNodes[ii].className.indexOf('diskuf-selectdialog') >= 0\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst nodeDocs = messageBody.childNodes[ii];\n\t\t\t\t\t\t\tconst webdavValues = nodeDocs.querySelectorAll('.wd-inline-file');\n\n\t\t\t\t\t\t\thasValuesDocs = (!!webdavValues && webdavValues.length > 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(\n\t\t\t\t\t\t\tType.isDomNode(messageBody.childNodes[ii])\n\t\t\t\t\t\t\t&& messageBody.childNodes[ii].classList\n\t\t\t\t\t\t\t&& !messageBody.childNodes[ii].classList.contains('urlpreview')\n\t\t\t\t\t\t\t&& !messageBody.childNodes[ii].classList.contains('feed-add-post-strings-blocks')\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.adjust(messageBody.childNodes[ii], {\n\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\tdisplay: (type === this.config.id.file ? 'none' : '')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (type === this.config.id.file)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!!window['PlEditorblogPostForm']\n\t\t\t\t\t\t\t&& !window['PlEditorblogPostForm'].SBPEBinded\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twindow['PlEditorblogPostForm'].SBPEBinded = true;\n\n\t\t\t\t\t\t\tEventEmitter.subscribe(window[\"PlEditorblogPostForm\"].eventNode, 'onUploadsHasBeenChanged', (event: BaseEvent) => {\n\n\t\t\t\t\t\t\t\tconst wdObj = event.getData()[1];\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\twdObj.dialogName === 'AttachFileDialog'\n\t\t\t\t\t\t\t\t\t&& wdObj.urlUpload.indexOf('&dropped=Y') < 0\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\twdObj.urlUpload = wdObj.agent.uploadFileUrl = wdObj.urlUpload.replace('&random_folder=Y', '&dropped=Y');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tdocument.getElementById('bx-b-uploadfile-blogPostForm').setAttribute('bx-press', 'pressOn');\n\t\t\t\t\t\t\t\tif (this.active !== this.config.id.file)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.changePostFormTab(this.config.id.message);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\twindow['PlEditorblogPostForm'].controllerInit('show');\n\t\t\t\t\t\tmessageBody.classList.add('feed-add-post-form', 'feed-add-post-edit-form', 'feed-add-post-edit-form-file');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tmessageBody.classList.remove('feed-add-post-form', 'feed-add-post-edit-form', 'feed-add-post-edit-form-file');\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!hasValuesFile\n\t\t\t\t\t\t\t&& !hasValuesDocs\n\t\t\t\t\t\t\t&& document.getElementById('bx-b-uploadfile-blogPostForm').getAttribute('bx-press') === 'pressOut'\n\t\t\t\t\t\t\t&& !!window['PlEditorblogPostForm']\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twindow['PlEditorblogPostForm'].controllerInit('hide');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst editorForm = document.getElementById('divoPostFormLHE_blogPostForm');\n\t\t\tif (\n\t\t\t\teditorForm\n\t\t\t\t&& editorForm.style.display === 'none'\n\t\t\t)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(editorForm, 'OnShowLHE', new BaseEvent({\n\t\t\t\t\tcompatData: [ 'justShow' ]\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tif (type === this.config.id.listItem)\n\t\t\t{\n\t\t\t\tEventEmitter.emit('onDisplayClaimLiveFeed', new BaseEvent({\n\t\t\t\t\tcompatData: [ iblock ]\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tthis.previousTab = type;\n\n\t\t\tif (!!this.bodies[type])\n\t\t\t{\n\t\t\t\tfor (let jj = 0; jj < this.bodies[type].length; jj++)\n\t\t\t\t{\n\t\t\t\t\tif (!!this.bodies[type][jj])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.adjust(this.bodies[type][jj], {\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (needAnimation)\n\t\t{\n\t\t\tthis.endAnimation();\n\t\t}\n\n\t\tif(type !== this.config.id.listItem)\n\t\t{\n\t\t\tthis.restoreMoreMenu();\n\t\t}\n\n\t\tthis.emit('changePostFormTab', { type });\n\n\t\treturn this.active;\n\t};\n\n\tisTaskTabLoaded()\n\t{\n\t\tconst contentContainer = document.getElementById('feed-add-post-content-tasks-container');\n\t\treturn (contentContainer && contentContainer.children.length);\n\t};\n\n\tcollapse()\n\t{\n\t\tthis.active = null;\n\t\tlet postEditSlider = false;\n\n\t\tconst currentSlider = (window !== top.window ? BX.SidePanel.Instance.getSliderByWindow(window) : null);\n\n\t\tif (window !== top.window) // slider\n\t\t{\n\t\t\tif (\n\t\t\t\tcurrentSlider\n\t\t\t\t&& currentSlider.url.match(/\\/user\\/(\\d+)\\/blog\\/edit\\//)\n\t\t\t)\n\t\t\t{\n\t\t\t\tpostEditSlider = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!postEditSlider)\n\t\t{\n\t\t\tthis.changePostFormTab(\"message\");\n\t\t\tconst formInstance = PostForm.getInstance();\n\t\t\tif (\n\t\t\t\tformInstance\n\t\t\t\t&& Type.isDomNode(formInstance.containerMicroInner)\n\t\t\t)\n\t\t\t{\n\t\t\t\tformInstance.containerMicroInner.style.display = 'block';\n\t\t\t}\n\t\t\tthis.startAnimation();\n\t\t}\n\n\t\tconst editorForm = document.getElementById('divoPostFormLHE_blogPostForm')\n\t\tif (editorForm)\n\t\t{\n\t\t\tEventEmitter.emit(editorForm, 'OnShowLHE', new BaseEvent({\n\t\t\t\tcompatData: [ false ]\n\t\t\t}));\n\t\t}\n\n\t\tEventEmitter.emit('onExtAutoSaveReset_blogPostForm', new BaseEvent({\n\t\t\tcompatData: [ ]\n\t\t}));\n\n\t\tif (!postEditSlider)\n\t\t{\n\t\t\tthis.endAnimation();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (currentSlider)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(window.top, 'SidePanel.Slider:onClose', new BaseEvent({\n\t\t\t\t\tcompatData: [ currentSlider.getEvent('onClose') ]\n\t\t\t\t}));\n\t\t\t}\n\t\t\tBX.SidePanel.Instance.close();\n\t\t}\n\t};\n\n\tstartAnimation():void\n\t{\n\t\tif (this.animation)\n\t\t{\n\t\t\tthis.animation.stop();\n\t\t}\n\n\t\tconst container = document.getElementById('microblog-form');\n\t\tif (!container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (PostForm.getInstance().animationStartHeight > 0)\n\t\t{\n\t\t\tthis.animationStartHeight = PostForm.getInstance().animationStartHeight;\n\t\t\tPostForm.getInstance().animationStartHeight = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.animationStartHeight = container.parentNode.offsetHeight;\n\t\t}\n\n\t\tcontainer.parentNode.style.height = `${this.animationStartHeight}px`;\n\t\tcontainer.parentNode.style.overflowY = 'hidden';\n\t\tcontainer.parentNode.style.position = 'relative';\n\t\tcontainer.style.opacity = 0;\n\t};\n\n\tendAnimation():void\n\t{\n\t\tconst container = document.getElementById('microblog-form');\n\t\tif (!container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.animation = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {\n\t\t\t\theight: this.animationStartHeight,\n\t\t\t\topacity: 0\n\t\t\t},\n\t\t\tfinish: {\n\t\t\t\theight: container.offsetHeight + container.offsetTop,\n\t\t\t\topacity: 100\n\t\t\t},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: (state) => {\n\t\t\t\tcontainer.parentNode.style.height = `${state.height}px`;\n\t\t\t\tcontainer.style.opacity = state.opacity / 100;\n\t\t\t},\n\n\t\t\tcomplete : () => {\n\t\t\t\tcontainer.style.cssText = '';\n\t\t\t\tcontainer.parentNode.style.cssText = '';\n\t\t\t\tthis.animation = null;\n\t\t\t}\n\t\t});\n\n\t\tthis.animation.animate();\n\t};\n\n\tshowMoreMenu()\n\t{\n\t\tif (!this.menu)\n\t\t{\n\t\t\tthis.menu = MenuManager.create(\n\t\t\t\t'feed-add-post-form-popup',\n\t\t\t\tdocument.getElementById('feed-add-post-form-link-text'),\n\t\t\t\tthis.menuItems,\n\t\t\t\t{\n\t\t\t\t\tclassName: 'feed-add-post-form-popup',\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\toffsetTop: 5,\n\t\t\t\t\toffsetLeft: 3,\n\t\t\t\t\tangle: true\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis.menu.popupWindow.show();\n\t};\n\n\trestoreMoreMenu(): void\n\t{\n\t\tconst itemCnt = this.menuItems.length;\n\t\tif (itemCnt < 1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < itemCnt; i++)\n\t\t{\n\t\t\tif (this.active === this.menuItems[i]['tabId'])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst btn = document.getElementById('feed-add-post-form-link-more');\n\t\tconst btnText = document.getElementById('feed-add-post-form-link-text');\n\n\t\tbtn.className = 'feed-add-post-form-link feed-add-post-form-link-more';\n\t\tbtnText.innerHTML = Loc.getMessage('SBPE_MORE');\n\t};\n\n\tgetTaskForm()\n\t{\n\t\tconst tabContainer = (\n\t\t\tdocument.getElementById('feed-add-post-form-tab-tasks')\n\t\t\t&& document.getElementById('feed-add-post-form-tab-tasks').style.display !== 'none'\n\t\t\t\t? document.getElementById('feed-add-post-form-tab-tasks')\n\t\t\t\t: document.getElementById('feed-add-post-form-link-more')\n\t\t);\n\t\tconst content = document.getElementById('feed-add-post-content-tasks');\n\t\tconst contentContainer = document.getElementById('feed-add-post-content-tasks-container');\n\n\t\tif (\n\t\t\tcontentContainer\n\t\t\t&& contentContainer.innerHTML.length <= 0\n\t\t\t&& !this.clickDisabled\n\t\t)\n\t\t{\n\t\t\tthis.clickDisabled = true;\n\t\t\tPostForm.getInstance().showWait(contentContainer);\n\t\t\tthis.startAnimation();\n\n\t\t\tconst componentParameters = {\n\t\t\t\tGROUP_ID: Loc.getMessage('TASK_SOCNET_GROUP_ID'),\n\t\t\t\tPATH_TO_USER_TASKS: Loc.getMessage('PATH_TO_USER_TASKS'),\n\t\t\t\tPATH_TO_USER_TASKS_TASK: Loc.getMessage('PATH_TO_USER_TASKS_TASK'),\n\t\t\t\tPATH_TO_GROUP_TASKS: Loc.getMessage('PATH_TO_GROUP_TASKS'),\n\t\t\t\tPATH_TO_GROUP_TASKS_TASK: Loc.getMessage('PATH_TO_GROUP_TASKS_TASK'),\n\t\t\t\tPATH_TO_USER_PROFILE: Loc.getMessage('PATH_TO_USER_PROFILE'),\n\t\t\t\tPATH_TO_GROUP: Loc.getMessage('PATH_TO_GROUP'),\n\t\t\t\tPATH_TO_USER_TASKS_PROJECTS_OVERVIEW: Loc.getMessage('PATH_TO_USER_TASKS_PROJECTS_OVERVIEW'),\n\t\t\t\tPATH_TO_USER_TASKS_TEMPLATES: Loc.getMessage('PATH_TO_USER_TASKS_TEMPLATES'),\n\t\t\t\tPATH_TO_USER_TEMPLATES_TEMPLATE: Loc.getMessage('PATH_TO_USER_TEMPLATES_TEMPLATE'),\n\t\t\t\tENABLE_FOOTER: 'N',\n\t\t\t\tTEMPLATE_CONTROLLER_ID: 'livefeed_task_form',\n\t\t\t\tENABLE_FORM: 'N',\n\t\t\t\tBACKURL: Loc.getMessage('TASK_SUBMIT_BACKURL')\n\t\t\t};\n\n\t\t\tAjax.runComponentAction('bitrix:tasks.task', 'uiEdit', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tparameters: {\n\t\t\t\t\t\tCOMPONENT_PARAMETERS: componentParameters,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\n\t\t\t\tRuntime.html(null, response.data.asset.join(' ')).then(() => {\n\n\t\t\t\t\tRuntime.html(contentContainer, response.data.html).then(() => {\n\t\t\t\t\t\tthis.clickDisabled = false;\n\t\t\t\t\t\tthis.closeWait(contentContainer);\n\t\t\t\t\t\tthis.endAnimation();\n\n\t\t\t\t\t\tEventEmitter.emit(document.getElementById('divlivefeed_task_form'), 'OnShowLHE', new BaseEvent({\n\t\t\t\t\t\t\tcompatData: [ 'justShow' ]\n\t\t\t\t\t\t}));\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tDom.adjust(content, {\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tdisplay : 'block',\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}, (response) => {\n\n\t\t\t\tthis.clickDisabled = false;\n\t\t\t\tthis.closeWait(contentContainer);\n\t\t\t\tthis.endAnimation();\n\n\t\t\t\tif (response.errors && response.errors.length)\n\t\t\t\t{\n\t\t\t\t\tconst errors = [];\n\n\t\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\t\terrors.push(error.message);\n\t\t\t\t\t});\n\t\t\t\t\tthrow new Error(errors.join(' '));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.startAnimation();\n\t\t\tthis.endAnimation();\n\t\t}\n\t};\n\n\tcloseWait(node)\n\t{\n\t\tconst waiterNode = node.bxmsg;\n\n\t\tif (\n\t\t\twaiterNode\n\t\t\t&& waiterNode.parentNode\n\t\t)\n\t\t{\n\t\t\tfor (let i=0,len=this.lastWait.length; i<len; i++)\n\t\t\t{\n\t\t\t\tif (waiterNode === this.lastWait[i])\n\t\t\t\t{\n\t\t\t\t\tthis.lastWait = BX.util.deleteFromArray(this.lastWait, i);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twaiterNode.parentNode.removeChild(waiterNode);\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tnode.bxmsg = null;\n\t\t\t}\n\n\t\t\tDom.clean(waiterNode);\n\t\t\tDom.remove(waiterNode);\n\t\t}\n\t};\n\n\tgetLists()\n\t{\n\t\tconst tabContainer = (\n\t\t\tdocument.getElementById('feed-add-post-form-tab-lists')\n\t\t\t&& document.getElementById('feed-add-post-form-tab-lists').style.display !== 'none'\n\t\t\t\t? document.getElementById('feed-add-post-form-tab-lists')\n\t\t\t\t: document.getElementById('feed-add-post-form-link-more')\n\t\t);\n\t\tlet tabs = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists');\n\t\tlet tabsDefault = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\tlet menuItemsListsDefault = [];\n\t\tlet menuItemsLists = [];\n\n\t\tif(tabs.length)\n\t\t{\n\t\t\tmenuItemsLists = this.getMenuItems(tabs, this.createOnclickLists);\n\t\t\tmenuItemsListsDefault = this.getMenuItemsDefault(tabsDefault);\n\t\t\tmenuItemsLists = menuItemsLists.concat(menuItemsListsDefault);\n\t\t\tthis.showMoreMenuLists(menuItemsLists);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet siteId = null;\n\n\t\t\tif(document.getElementById('bx-lists-select-site-id'))\n\t\t\t{\n\t\t\t\tsiteId = document.getElementById('bx-lists-select-site-id').value;\n\t\t\t}\n\n\t\t\tAjax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: '/bitrix/components/bitrix/socialnetwork.blog.post.edit/post.ajax.php',\n\t\t\t\tdata: {\n\t\t\t\t\tbitrix_processes: 1,\n\t\t\t\t\tsiteId: siteId,\n\t\t\t\t\tsessid: Loc.getMessage('bitrix_sessid')\n\t\t\t\t},\n\t\t\t\tonsuccess: (result) => {\n\t\t\t\t\tif(result.success)\n\t\t\t\t\t{\n\t\t\t\t\t\tfor(let k in result.lists)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!result.lists.hasOwnProperty(k))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\ttabContainer.appendChild(Dom.create('span', {\n\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t'data-name': result.lists[k].NAME,\n\t\t\t\t\t\t\t\t\t'data-picture': result.lists[k].PICTURE,\n\t\t\t\t\t\t\t\t\t'data-description': result.lists[k].DESCRIPTION,\n\t\t\t\t\t\t\t\t\t'data-picture-small': result.lists[k].PICTURE_SMALL,\n\t\t\t\t\t\t\t\t\t'data-code': result.lists[k].CODE,\n\t\t\t\t\t\t\t\t\t'iblockId': result.lists[k].ID\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tclassName: 'feed-add-post-form-link-lists',\n\t\t\t\t\t\t\t\t\tid: 'feed-add-post-form-tab-lists'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttabs = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists');\n\t\t\t\t\t\tmenuItemsLists = this.getMenuItems(tabs, this.createOnclickLists);\n\n\t\t\t\t\t\tif(!tabsDefault.length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor(let k in result.permissions)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (!result.permissions.hasOwnProperty(k))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tlet onclick;\n\t\t\t\t\t\t\t\tif(k === 'new')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tonclick = `document.location.href = \"${document.getElementById('bx-lists-lists-page').value}0/edit/\"`;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if(k === 'market')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tif(\n\t\t\t\t\t\t\t\t\t\tresult.admin\n\t\t\t\t\t\t\t\t\t\t&& document.getElementById('bx-lists-lists-page')\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tonclick = `document.location.href = \"${document.getElementById('bx-lists-lists-page').value}?bp_catalog=y\"`;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tif(document.getElementById('bx-lists-random-string'))\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tonclick = `BX.Lists[\"LiveFeedClass_${BX('bx-lists-random-string').value}\"].errorPopup(\"${Loc.getMessage('LISTS_CATALOG_PROCESSES_ACCESS_DENIED')}\");`;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if(k === 'settings')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tonclick = `document.location.href = \"${BX('bx-lists-lists-page').value}\"`;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ttabContainer.appendChild(Dom.create('span', {\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\t'data-name': result.permissions[k],\n\t\t\t\t\t\t\t\t\t\t'data-picture-small': '',\n\t\t\t\t\t\t\t\t\t\t'data-key': k,\n\t\t\t\t\t\t\t\t\t\t'data-onclick': onclick\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\tclassName: 'feed-add-post-form-link-lists-default',\n\t\t\t\t\t\t\t\t\t\tid: 'feed-add-post-form-tab-lists'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\ttabsDefault = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmenuItemsListsDefault = this.getMenuItemsDefault(tabsDefault);\n\t\t\t\t\t\tmenuItemsLists = menuItemsLists.concat(menuItemsListsDefault);\n\t\t\t\t\t\tthis.showMoreMenuLists(menuItemsLists);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttabContainer.appendChild(Dom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t'data-name': result.error,\n\t\t\t\t\t\t\t\t'data-picture-small': ''\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'feed-add-post-form-link-lists-default',\n\t\t\t\t\t\t\t\tid: 'feed-add-post-form-tab-lists'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\n\t\t\t\t\t\ttabs = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\t\t\t\t\tmenuItemsLists = this.getMenuItems(tabs, false);\n\t\t\t\t\t\tthis.showMoreMenuLists(menuItemsLists);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tgetMenuItems(tabs, createOnclickLists)\n\t{\n\t\tconst menuItemsLists = [];\n\n\t\tfor (let i = 0; i < tabs.length; i++)\n\t\t{\n\t\t\tconst id = tabs[i].getAttribute('id').replace('feed-add-post-form-tab-', '');\n\n\t\t\tif(createOnclickLists)\n\t\t\t{\n\t\t\t\tmenuItemsLists.push({\n\t\t\t\t\ttabId: id,\n\t\t\t\t\ttext: BX.util.htmlspecialchars(tabs[i].getAttribute(\"data-name\")),\n\t\t\t\t\tclassName: `feed-add-post-form-${id} feed-add-post-form-${id}-item`,\n\t\t\t\t\tonclick: createOnclickLists(\n\t\t\t\t\t\tid,\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\ttabs[i].getAttribute('iblockId'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-name'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-description'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-picture'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-code')\n\t\t\t\t\t\t]\n\t\t\t\t\t)\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItemsLists.push({\n\t\t\t\t\ttabId: id,\n\t\t\t\t\ttext: tabs[i].getAttribute('data-name'),\n\t\t\t\t\tclassName: `feed-add-post-form-${id}`,\n\t\t\t\t\tonclick: ''\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn menuItemsLists;\n\t};\n\n\tgetMenuItemsDefault(tabs)\n\t{\n\t\tconst menuItemsLists = [];\n\n\t\tfor (let i = 0; i < tabs.length; i++)\n\t\t{\n\t\t\tmenuItemsLists.push({\n\t\t\t\ttext: BX.util.htmlspecialchars(tabs[i].getAttribute('data-name')),\n\t\t\t\tclassName: `feed-add-post-form-lists-default-${tabs[i].getAttribute('data-key')}`,\n\t\t\t\tonclick: tabs[i].getAttribute('data-onclick')\n\t\t\t});\n\t\t}\n\n\t\treturn menuItemsLists;\n\t};\n\n\tshowMoreMenuLists(menuItemsLists)\n\t{\n\t\tconst menuBindElement = (\n\t\t\tdocument.getElementById('feed-add-post-form-tab-lists').style.display !== 'none'\n\t\t\t\t? document.getElementById('feed-add-post-form-tab-lists')\n\t\t\t\t: document.getElementById('feed-add-post-form-link-more')\n\t\t);\n\n\t\tthis.listsMenu = MenuManager.create(\n\t\t\t'lists',\n\t\t\tmenuBindElement,\n\t\t\tmenuItemsLists,\n\t\t\t{\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 5,\n\t\t\t\toffsetLeft: 12,\n\t\t\t\tangle: true\n\t\t\t}\n\t\t);\n\n\t\tconst spanIcon = document.getElementById('popup-window-content-menu-popup-lists').querySelectorAll('span.menu-popup-item-icon');\n\t\tlet spanDataPicture = menuBindElement.querySelectorAll('span.feed-add-post-form-link-lists');\n\t\tconst spanDataPictureDefault = menuBindElement.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\tspanDataPicture = Array.from(spanDataPicture).concat(Array.from(spanDataPictureDefault));\n\n\t\tfor(let i = 0; i < spanIcon.length; i++)\n\t\t{\n\t\t\tif(!spanDataPicture[i].getAttribute('data-picture-small'))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tspanIcon[i].innerHTML = spanDataPicture[i].getAttribute('data-picture-small');\n\t\t}\n\n\t\tthis.listsMenu.popupWindow.show();\n\t};\n\n\tcreateOnclickLists(id, iblock)\n\t{\n\t\treturn () =>\n\t\t{\n\t\t\tPostFormTabs.getInstance().changePostFormTab(id, iblock);\n\t\t\tPostFormTabs.getInstance().listsMenu.popupWindow.close();\n\t\t\tPostFormTabs.getInstance().menu.popupWindow.close();\n\t\t}\n\t};\n}\n","import { Loc } from 'main.core';\nimport { MenuManager } from 'main.popup';\n\nimport 'main.date';\n\nexport default class PostFormDateEnd\n{\n\tisInitialized: boolean = false;\n\tpopupShowingPeriods = null;\n\tmenuItems = [];\n\tcustomDateStyleModifier: string = 'feed-add-post-expire-date-customize';\n\n\tcustomDatePopupOptionClass: string = 'js-custom-date-end';\n\n\tpostExpireDateBlock: HTMLElement = null;\n\tformUfInputDateCustom: HTMLElement = null;\n\tformDateDuration: HTMLElement = null;\n\tformDateTimeEditing: HTMLElement = null;\n\tpopupTrigger: HTMLElement = null;\n\tcustomDateSelectedTitle: HTMLElement = null;\n\n\tselectors = {\n\t\tpostExpireDateBlock: '.js-post-expire-date-block',\n\t\tpostEndTime: '.js-form-post-end-time',\n\t\tpostEditingEndTime: '.js-form-editing-post-end-time',\n\t\tpostEndPeriod: '.js-form-post-end-period',\n\t\tpopupTrigger: '.js-important-till-popup-trigger',\n\t\tcustomDateFinal: '.js-date-post-showing-custom',\n\t\tdurationOptionsContainer: '.js-post-showing-duration-options-container',\n\t\tdurationOption: '.js-post-showing-duration-option'\n\t};\n\n\tconstructor()\n\t{\n\t\tthis.init();\n\t}\n\n\tinit(): void\n\t{\n\t\tif (this.isInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addEventHandlers();\n\n\t\tif (!this.formDateTimeEditing.value)\n\t\t{\n\t\t\tthis.customDateSelectedTitle.innerText = this.getCurrentDate();\n\t\t}\n\n\t\tthis.isInitialized = true;\n\t};\n\n\taddEventHandlers()\n\t{\n\t\tthis.postExpireDateBlock = document.querySelector(this.selectors.postExpireDateBlock);\n\t\tthis.formUfInputDateCustom = document.querySelector(this.selectors.postEndTime);\n\t\tthis.formDateDuration = document.querySelector(this.selectors.postEndPeriod);\n\t\tthis.formDateTimeEditing = document.querySelector(this.selectors.postEditingEndTime);\n\t\tthis.popupTrigger = document.querySelector(this.selectors.popupTrigger);\n\n\t\tif (this.popupTrigger)\n\t\t{\n\t\t\tthis.popupTrigger.addEventListener('click', () => {\n\t\t\t\tthis.showPostEndPeriodsPopup();\n\t\t\t});\n\t\t}\n\n\t\tthis.customDateSelectedTitle = document.querySelector(this.selectors.customDateFinal);\n\t\tif (this.customDateSelectedTitle)\n\t\t{\n\t\t\tthis.customDateSelectedTitle.addEventListener('click', () => {\n\t\t\t\tlet curDate = new Date();\n\t\t\t\tlet curTimestamp = Math.round(curDate / 1000) - curDate.getTimezoneOffset() * 60;\n\n\t\t\t\tif (this.formDateTimeEditing.value)\n\t\t\t\t{\n\t\t\t\t\tcurDate = BX.parseDate(this.formDateTimeEditing.value);\n\t\t\t\t\tcurTimestamp = BX.date.convertToUTC(curDate);\n\t\t\t\t}\n\n\t\t\t\tBX.calendar({\n\t\t\t\t\tnode: this.customDateSelectedTitle,\n\t\t\t\t\tform: 'blogPostForm',\n\t\t\t\t\tvalue: curTimestamp,\n\t\t\t\t\tbTime: false,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t},\n\t\t\t\t\tcallback_after: this.onEndDateSet.bind(this)\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t};\n\n\tshowPostEndPeriodsPopup(): void\n\t{\n\t\tif (!this.popupShowingPeriods)\n\t\t{\n\t\t\tthis.createPopupShowingPeriods();\n\t\t}\n\t\tthis.popupShowingPeriods.popupWindow.show();\n\t};\n\n\tcreatePopupShowingPeriods(): void\n\t{\n\t\tif (this.menuItems.length <= 0)\n\t\t{\n\t\t\tthis.menuItems = this.createPopupItems();\n\t\t}\n\n\t\tthis.popupShowingPeriods = MenuManager.create(\n\t\t\t'feed-add-post-form-popup42',\n\t\t\tdocument.getElementById('js-post-expire-date-wrapper'),\n\t\t\tthis.menuItems,\n\t\t\t{\n\t\t\t\tclassName: \"feed-add-post-expire-date-options\",\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: true\n\t\t\t}\n\t\t);\n\t};\n\n\tcreatePopupItems()\n\t{\n\t\tconst menuPostDurationItems = [];\n\t\tconst selectOptions = document.querySelector(this.selectors.durationOptionsContainer).querySelectorAll(this.selectors.durationOption);\n\n\t\tif (!selectOptions)\n\t\t{\n\t\t\treturn menuPostDurationItems;\n\t\t}\n\n\t\tselectOptions.forEach((element) => {\n\t\t\tmenuPostDurationItems.push({\n\t\t\t\tonclick: this.onPopupItemClick.bind(this),\n\t\t\t\tdataset: {\n\t\t\t\t\tvalue: element.getAttribute('data-value'),\n\t\t\t\t\tclass: element.getAttribute('data-class')\n\t\t\t\t},\n\t\t\t\ttext: element.getAttribute('data-text'),\n\t\t\t\tclassName: `menu-popup-item menu-popup-no-icon ${element.getAttribute('data-class')}`\n\t\t\t});\n\t\t});\n\n\t\treturn menuPostDurationItems;\n\t};\n\n\tonPopupItemClick(event)\n\t{\n\t\tconst element = event.currentTarget;\n\t\tif (element.getAttribute('data-class') === this.customDatePopupOptionClass)\n\t\t{\n\t\t\tthis.postExpireDateBlock.classList.add(this.customDateStyleModifier);\n\t\t\tif (this.formDateTimeEditing.value)\n\t\t\t{\n\t\t\t\tthis.formUfInputDateCustom.value = this.formDateTimeEditing.value;\n\t\t\t\tthis.customDateSelectedTitle.innerText = this.formDateTimeEditing.value;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.formUfInputDateCustom.value = this.getCurrentDate();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.postExpireDateBlock.classList.remove(this.customDateStyleModifier);\n\t\t\tthis.formUfInputDateCustom.value = null;\n\t\t}\n\n\t\tthis.popupTrigger.innerText = element.innerText.toLowerCase();\n\t\tthis.formDateDuration.value = element.getAttribute('data-value').toUpperCase();\n\t\tthis.popupShowingPeriods.popupWindow.close();\n\t};\n\n\tonEndDateSet(value)\n\t{\n\t\tif (!value)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.formDateTimeEditing.value = this.getFormattedDate(value);\n\t\tthis.formUfInputDateCustom.value = this.getFormattedDate(value);\n\t\tthis.customDateSelectedTitle.innerText = this.getFormattedDate(value);\n\t};\n\n\tgetFormattedDate(value)\n\t{\n\t\treturn BX.date.format(BX.date.convertBitrixFormat(Loc.getMessage('FORMAT_DATE')), value);\n\t};\n\n\tgetCurrentDate()\n\t{\n\t\treturn this.getFormattedDate(new Date());\n\t};\n\n}","import { Type, Loc, Dom } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { TagSelector } from 'ui.entity-selector';\nimport { EventEmitter } from \"main.core.events\";\nimport 'main.date';\n\nexport default class PostFormGratSelector extends EventEmitter\n{\n\tstatic instance = null;\n\n\tpopupWindow = null;\n\tsendEvent = true;\n\tgratsContentElement = null;\n\titemSelectedImageItem = {};\n\titemSelectedInput = {};\n\tgratsList = {};\n\n\tselector = null;\n\n\tconfig = {\n\t\tfields: {\n\t\t\temployeesValue: {\n\t\t\t\tname: 'GRAT_DEST_DATA',\n\t\t\t},\n\t\t},\n\t};\n\n\tstatic setInstance(instance)\n\t{\n\t\tPostFormGratSelector.instance = instance;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\treturn PostFormGratSelector.instance;\n\t}\n\n\tconstructor(params)\n\t{\n\t\tsuper();\n\t\tthis.init(params);\n\t\tPostFormGratSelector.setInstance(this);\n\t}\n\n\tinit(params)\n\t{\n\t\tif(!params.name)\n\t\t{\n\t\t\tparams.name = 'lm';\n\t\t}\n\n\t\tthis.itemSelectedImageItem[params.name] = params.itemSelectedImageItem;\n\t\tthis.itemSelectedInput[params.name] = params.itemSelectedInput;\n\t\tthis.gratsList[params.name] = params.gratsList;\n\n\t\tthis.itemSelectedImageItem[params.name].addEventListener('click', (e) => {\n\t\t\tthis.openDialog(params.name);\n\t\t\te.preventDefault();\n\t\t});\n\n\t\tthis.createEntitySelector(params.entitySelectorParams);\n\t};\n\n\topenDialog(name): boolean\n\t{\n\t\tif(!name)\n\t\t{\n\t\t\tname = 'lm';\n\t\t}\n\n\t\tif (this.popupWindow != null)\n\t\t{\n\t\t\tthis.popupWindow.close();\n\t\t\treturn false;\n\t\t}\n\n\t\tconst gratItems = [];\n\t\tfor (let i = 0; i < this.gratsList[name].length; i++)\n\t\t{\n\t\t\tgratItems[gratItems.length] = Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: `feed-add-grat-box ${this.gratsList[name][i].style}`\n\t\t\t\t},\n\t\t\t\tattrs: {\n\t\t\t\t\t'data-title': this.gratsList[name][i].title,\n\t\t\t\t\t'data-code': this.gratsList[name][i].code,\n\t\t\t\t\t'data-style': this.gratsList[name][i].style\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (e) => {\n\t\t\t\t\t\tconst node = e.currentTarget;\n\t\t\t\t\t\tthis.selectItem(name, node.getAttribute('data-code'), node.getAttribute('data-style'), node.getAttribute('data-title'));\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst gratRows = [];\n\t\tlet rownum = 1;\n\n\t\tfor (let i = 0; i < gratItems.length; i++)\n\t\t{\n\t\t\tif (i >= gratItems.length/2)\n\t\t\t{\n\t\t\t\trownum = 2;\n\t\t\t}\n\n\t\t\tif (Type.isNil(gratRows[rownum]))\n\t\t\t{\n\t\t\t\tgratRows[rownum] = Dom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'feed-add-grat-list-row'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tgratRows[rownum].appendChild(gratItems[i]);\n\t\t}\n\n\t\tthis.gratsContentElement = Dom.create('div', {\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'feed-add-grat-list-title'\n\t\t\t\t\t},\n\t\t\t\t\thtml: Loc.getMessage('BLOG_GRAT_POPUP_TITLE')\n\t\t\t\t}),\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'feed-add-grat-list'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: gratRows\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tthis.popupWindow = new Popup('BXSocNetGratSelector', document.getElementById('feed-add-post-grat-type-selected'), {\n\t\t\tautoHide: true,\n\t\t\toffsetLeft: 25,\n\t\t\tbindOptions: { forceBindPosition: true },\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: {\n\t\t\t\ttop: '5px',\n\t\t\t\tright: '10px'\n\t\t\t},\n\t\t\tevents : {\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.popupWindow.destroy();\n\t\t\t\t},\n\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\tthis.popupWindow = null;\n\t\t\t\t}\n\t\t\t},\n\t\t\tcontent: this.gratsContentElement,\n\t\t\tangle: {\n\t\t\t\tposition: 'bottom',\n\t\t\t\toffset: 20\n\t\t\t},\n\t\t\tlightShadow: true\n\t\t});\n\t\tthis.popupWindow.setAngle({});\n\t\tthis.popupWindow.show();\n\n\t\treturn true;\n\t};\n\n\tselectItem(name, code, style, title)\n\t{\n\t\tconst gratSpan = this.itemSelectedImageItem[name].querySelector('span');\n\t\tif (gratSpan)\n\t\t{\n\t\t\tgratSpan.className = `feed-add-grat-box ${style}`;\n\t\t}\n\n\t\tthis.itemSelectedImageItem[name].title = title;\n\t\tthis.itemSelectedInput[name].value = code;\n\t\tthis.popupWindow.close();\n\t};\n\n\tcreateEntitySelector(params)\n\t{\n\t\tthis.selector = new TagSelector({\n\n\t\t\tid: params.id,\n\t\t\tdialogOptions: {\n\t\t\t\tid: params.id,\n\t\t\t\tcontext: 'GRATITUDE',\n\t\t\t\tpreselectedItems: (Type.isArray(params.preselectedItems) ? params.preselectedItems : []),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tthis.recalcValue(event.getTarget().getSelectedItems(), params.inputNodeId);\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\t\tthis.recalcValue(event.getTarget().getSelectedItems(), params.inputNodeId);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'usersOnly'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\taddButtonCaption: Loc.getMessage('BLOG_GRATMEDAL_1'),\n\t\t\taddButtonCaptionMore: Loc.getMessage('BLOG_GRATMEDAL_1')\n\t\t});\n\n\t\tthis.selector.renderTo(document.getElementById(params.tagNodeId));\n\t\tthis.selector.subscribe('onContainerClick', () => {\n\t\t\tthis.emit('Selector::onContainerClick');\n\t\t});\n\t};\n\n\trecalcValue(selectedItems, inputNodeId): void\n\t{\n\t\tif (\n\t\t\t!Type.isArray(selectedItems)\n\t\t\t|| !document.getElementById(inputNodeId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst result = [];\n\n\t\tselectedItems.forEach((item) => {\n\t\t\tresult.push([ item.entityId, item.id ]);\n\t\t});\n\n\t\tdocument.getElementById(inputNodeId).value = JSON.stringify(result);\n\t};\n}","import { Dom, Type, Uri, ajax as Ajax, Event, Browser, Loc } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport PostForm from './form';\nimport PostFormTabs from './tabs';\nimport PostFormGratSelector from './grat';\nimport PostFormAutoSave from './autosave';\n\nexport default class PostFormEditor extends EventEmitter\n{\n\tstatic instance: { [key: string]: any } = {};\n\n\tdisabled: boolean = false;\n\tformParams: {};\n\tformId: string = '';\n\n\tstatic setInstance(id, instance)\n\t{\n\t\tPostFormEditor.instance[id] = instance;\n\t}\n\n\tstatic getInstance(id)\n\t{\n\t\treturn PostFormEditor.instance[id];\n\t}\n\n\tconstructor(formID, params)\n\t{\n\t\tsuper();\n\t\tthis.init(formID, params);\n\t\tPostFormEditor.setInstance(formID, this);\n\n\t\twindow['setBlogPostFormSubmitted'] = this.setBlogPostFormSubmitted.bind(this);\n\t\twindow['submitBlogPostForm'] = this.submitBlogPostForm.bind(this);\n\t}\n\n\tinit(formID, params)\n\t{\n\t\tthis.disabled = false;\n\t\tthis.formId = formID;\n\n\t\tthis.formParams = {\n\t\t\teditorID: params.editorID,\n\t\t\tshowTitle: !!params.showTitle,\n\t\t\tsubmitted: false,\n\t\t\ttext: params.text,\n\t\t\tautoSave: params.autoSave,\n\t\t\thandler: (LHEPostForm && LHEPostForm.getHandler(params.editorID)),\n\t\t\teditor: (LHEPostForm && LHEPostForm.getEditor(params.editorID)),\n\t\t\trestoreAutosave: !!params.restoreAutosave,\n\t\t\tcreatedFromEmail: !!params.createdFromEmail,\n\t\t};\n\n\t\tEventEmitter.subscribe('onInitialized', (event: BaseEvent) => {\n\t\t\tconst [ obj, form ] = event.getData();\n\t\t\tthis.onHandlerInited(obj, form);\n\t\t});\n\t\tif (this.formParams.handler)\n\t\t{\n\t\t\tthis.onHandlerInited(this.formParams.handler, formID);\n\t\t}\n\n\t\tEventEmitter.subscribe('OnEditorInitedAfter', (event: BaseEvent) => {\n\t\t\tconst [ editor ] = event.getData();\n\t\t\tthis.onEditorInited(editor);\n\t\t});\n\n\t\tif (this.formParams.editor)\n\t\t{\n\t\t\tthis.onEditorInited(this.formParams.editor);\n\t\t}\n\n\t\tEventEmitter.subscribe('onSocNetLogMoveBody', (event: BaseEvent) => {\n\t\t\tconst [ p ] = event.getData();\n\t\t\tif (p === 'sonet_log_microblog_container')\n\t\t\t{\n\t\t\t\tthis.reinit();\n\t\t\t}\n\t\t});\n\n\t\tEvent.ready(() => {\n\t\t\tif (\n\t\t\t\tBrowser.isIE()\n\t\t\t\t&& document.getElementById('POST_TITLE')\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst showTitlePlaceholderBlur = () => {\n\t\t\t\t\tconst node = document.getElementById('POST_TITLE');\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!node\n\t\t\t\t\t\t|| node.value === node.getAttribute('placeholder')\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.value = node.getAttribute('placeholder');\n\t\t\t\t\t\tnode.classList.remove('feed-add-post-inp-active');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE'), 'blur', showTitlePlaceholderBlur);\n\t\t\t\tshowTitlePlaceholderBlur();\n\n\t\t\t\tdocument.getElementById('POST_TITLE').__onchange = (e) => {\n\t\t\t\t\tconst node = document.getElementById('POST_TITLE');\n\n\t\t\t\t\tif (node.value === node.getAttribute('placeholder'))\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.value = '';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (node.className.indexOf('feed-add-post-inp-active') < 0 )\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.classList.add('feed-add-post-inp-active');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE'), 'click', document.getElementById('POST_TITLE').__onchange);\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE'), 'keydown', document.getElementById('POST_TITLE').__onchange);\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE').form, 'submit', () => {\n\t\t\t\t\tconst node = document.getElementById('POST_TITLE');\n\n\t\t\t\t\tif(node.value === node.getAttribute('placeholder'))\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.value = '';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (params.activeTab !== '')\n\t\t\t{\n\t\t\t\tPostFormTabs.getInstance().changePostFormTab(params.activeTab);\n\t\t\t}\n\n\t\t\tPostFormTabs.getInstance().subscribe('changePostFormTab', this.checkHideAlert.bind(this));\n\t\t\tif (PostFormGratSelector.getInstance())\n\t\t\t{\n\t\t\t\tPostFormGratSelector.getInstance().subscribe('Selector::onContainerClick', this.hideAlert.bind(this));\n\t\t\t}\n\t\t});\n\t}\n\n\tshowPanelTitle(show, saveChanges)\n\t{\n\t\tshow = (\n\t\t\tshow === true\n\t\t\t|| show === false\n\t\t\t\t? show\n\t\t\t\t: (\n\t\t\t\t\tdocument.getElementById('blog-title').style.display\n\t\t\t\t\t&& document.getElementById('blog-title').style.display === 'none'\n\t\t\t\t)\n\t\t);\n\n\t\tsaveChanges = (saveChanges !== false);\n\n\t\tconst showTitleValue = this.formParams.showTitle;\n\t\tconst node = document.getElementById(`lhe_button_title_${this.formId}`);\n\t\tconst nodeBlock = document.getElementById(`feed-add-post-block${this.formId}`);\n\t\tconst stv = (document.getElementById('show_title') || {});\n\n\t\tif(show)\n\t\t{\n\t\t\tBX.show(document.getElementById('blog-title'));\n\t\t\tif (document.getElementById('POST_TITLE'))\n\t\t\t{\n\t\t\t\tdocument.getElementById('POST_TITLE').focus();\n\t\t\t}\n\n\t\t\tthis.formParams.showTitle = true;\n\t\t\tstv.value = 'Y';\n\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tnode.classList.add('feed-add-post-form-btn-active');\n\t\t\t}\n\n\t\t\tif (nodeBlock)\n\t\t\t{\n\t\t\t\tnodeBlock.classList.add('blog-post-edit-open');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.hide(document.getElementById('blog-title'));\n\t\t\tthis.formParams.showTitle = false;\n\t\t\tstv.value = \"N\";\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tnode.classList.remove('feed-add-post-form-btn-active');\n\t\t\t}\n\t\t}\n\n\t\tif (saveChanges)\n\t\t{\n\t\t\tBX.userOptions.save('socialnetwork', 'postEdit', 'showTitle', (this.formParams.showTitle ? 'Y' : 'N'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.formParams.showTitle = showTitleValue;\n\t\t}\n\t}\n\n\tsetBlogPostFormSubmitted(value)\n\t{\n\t\tif (document.getElementById('blog-submit-button-save'))\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tdocument.getElementById('blog-submit-button-save').classList.add('ui-btn-clock');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdocument.getElementById('blog-submit-button-save').classList.remove('ui-btn-clock');\n\t\t\t}\n\t\t}\n\n\t\tthis.formParams.submitted = value;\n\t\tthis.disabled = value;\n\t};\n\n\tsubmitBlogPostForm(editor, value)\n\t{\n\t\tif (this.disabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isObject(editor))\n\t\t{\n\t\t\tvalue = editor;\n\t\t\teditor = LHEPostForm.getEditor(this.formParams.editorID);\n\t\t}\n\n\t\tif (\n\t\t\teditor\n\t\t\t&& editor.id === this.formParams.editorID\n\t\t)\n\t\t{\n\t\t\tif(this.formParams.submitted)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\teditor.SaveContent();\n\n\t\t\tif(!value)\n\t\t\t{\n\t\t\t\tvalue = 'save';\n\t\t\t}\n\n\t\t\tif(document.getElementById('blog-title').style.display === 'none')\n\t\t\t{\n\t\t\t\tdocument.getElementById('POST_TITLE').value = '';\n\t\t\t}\n\n\t\t\tconst submitButton = this.getSubmitButton({\n\t\t\t\tbuttonType: value,\n\t\t\t});\n\n\t\t\tif (submitButton)\n\t\t\t{\n\t\t\t\tsubmitButton.classList.add('ui-btn-clock');\n\t\t\t\tthis.disabled = true;\n\n\t\t\t\twindow.addEventListener('beforeunload', (event) => { // is called on every sumbit, with or without dialog\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tBX.removeClass(submitButton, 'ui-btn-clock');\n\t\t\t\t\t\tthis.disabled = false;\n\t\t\t\t\t\tthis.formParams.submitted = false;\n\t\t\t\t\t}, 3000); // timeout needed to process a form on a back-end\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet actionUrl = '';\n\t\t\tconst activeTab = PostFormTabs.getInstance().active;\n\n\t\t\tif (Type.isStringFilled(activeTab))\n\t\t\t{\n\t\t\t\tactionUrl = document.getElementById(this.formId).action;\n\t\t\t\tUri.removeParam(actionUrl, [ 'b24statTab' ]);\n\t\t\t\tUri.addParam(actionUrl, {\n\t\t\t\t\tb24statTab: activeTab\n\t\t\t\t});\n\t\t\t\tdocument.getElementById(this.formId).action = actionUrl;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t[\n\t\t\t\t\tPostFormTabs.getInstance().config.id.message,\n\t\t\t\t\tPostFormTabs.getInstance().config.id.file,\n\t\t\t\t\tPostFormTabs.getInstance().config.id.gratitude,\n\t\t\t\t\tPostFormTabs.getInstance().config.id.important,\n\t\t\t\t\tPostFormTabs.getInstance().config.id.vote,\n\t\t\t\t].includes(activeTab)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (!this.checkDestinationValue({\n\t\t\t\t\tbuttonType: value,\n\t\t\t\t}))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tactiveTab === PostFormTabs.getInstance().config.id.gratitude\n\t\t\t\t&& PostFormGratSelector.getInstance()\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (!this.checkEmployeesValue({\n\t\t\t\t\tbuttonType: value,\n\t\t\t\t}))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tBX.submit(document.getElementById(this.formId), value);\n\n\t\t\tthis.formParams.submitted = true;\n\t\t}\n\t};\n\n\tcheckDestinationValue({ buttonType }): boolean\n\t{\n\t\tif (Type.isUndefined(MPFEntitySelector))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst tagSelector = new MPFEntitySelector({\n\t\t\tid: `oPostFormLHE_${this.formId}`,\n\t\t});\n\t\tif (\n\t\t\t!tagSelector\n\t\t\t|| !Type.isArray(tagSelector.tags)\n\t\t\t|| tagSelector.tags.length > 0\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.enableSubmitButton({\n\t\t\tbuttonType,\n\t\t});\n\n\t\tthis.showBottomAlert({\n\t\t\ttext: Loc.getMessage('BLOG_POST_EDIT_T_GRAT_ERROR_NO_DESTINATION'),\n\t\t});\n\n\t\ttagSelector.subscribeOnce('onContainerClick', this.hideAlert);\n\n\t\treturn false;\n\t}\n\n\tcheckEmployeesValue({ buttonType }): boolean\n\t{\n\t\tconst employeesValueNode = document.getElementById(this.formId).elements[PostFormGratSelector.getInstance().config.fields.employeesValue.name];\n\t\tif (\n\t\t\temployeesValueNode\n\t\t\t&& Type.isStringFilled(employeesValueNode.value)\n\t\t\t&& employeesValueNode.value !== '[]'\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.enableSubmitButton({\n\t\t\tbuttonType,\n\t\t});\n\n\t\tthis.showBottomAlert({\n\t\t\ttext: Loc.getMessage('BLOG_POST_EDIT_T_GRAT_ERROR_NO_EMPLOYEES'),\n\t\t});\n\n\t\treturn false;\n\t}\n\n\tcheckHideAlert(event) {\n\t\tconst { type } = event.getData();\n\t\tif (type === PostFormTabs.getInstance().config.id.gratitude)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hideAlert();\n\t}\n\n\thideAlert()\n\t{\n\t\tconst alertNode = document.getElementById('feed-add-post-bottom-alertblogPostForm');\n\t\tif (!alertNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(alertNode);\n\t}\n\n\tenableSubmitButton({ buttonType })\n\t{\n\t\tconst submitButton = this.getSubmitButton({\n\t\t\tbuttonType,\n\t\t});\n\n\t\tif (submitButton)\n\t\t{\n\t\t\tsubmitButton.classList.remove('ui-btn-clock');\n\t\t\tthis.disabled = false;\n\t\t}\n\t}\n\n\tgetSubmitButton({ buttonType })\n\t{\n\t\tlet result = null;\n\n\t\tif (\n\t\t\tbuttonType === 'save'\n\t\t\t&& document.getElementById('blog-submit-button-save')\n\t\t)\n\t\t{\n\t\t\tresult = document.getElementById('blog-submit-button-save');\n\t\t}\n\t\telse if (\n\t\t\tbuttonType === 'draft'\n\t\t\t&& document.getElementById('blog-submit-button-draft')\n\t\t)\n\t\t{\n\t\t\tresult = document.getElementById('blog-submit-button-draft');\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tshowBottomAlert(params)\n\t{\n\t\tif (\n\t\t\t!Type.isPlainObject(params)\n\t\t\t|| !Type.isStringFilled(params.text)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst alertNode = document.getElementById('feed-add-post-bottom-alertblogPostForm');\n\t\tif (alertNode)\n\t\t{\n\t\t\tDom.clean(alertNode);\n\t\t\talertNode.appendChild(Dom.create('div', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'ui-alert ui-alert-danger',\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'ui-alert-message',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: params.text,\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t}));\n\t\t}\n\t}\n\n\tonHandlerInited(obj, form)\n\t{\n\t\tif (form !== this.formId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.formParams.handler = obj;\n\n\t\tEventEmitter.subscribe(obj.eventNode, 'OnControlClick', () => {\n\t\t\tPostFormTabs.getInstance().changePostFormTab(PostFormTabs.getInstance().config.id.message);\n\t\t});\n\n\t\tEventEmitter.subscribe(obj.eventNode, 'OnAfterShowLHE', this.OnAfterShowLHE.bind(this));\n\t\tEventEmitter.subscribe(obj.eventNode, 'OnAfterHideLHE', this.OnAfterHideLHE.bind(this));\n\n\t\tif (obj.eventNode.style.display == 'none')\n\t\t{\n\t\t\tthis.OnAfterHideLHE();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.OnAfterShowLHE();\n\t\t}\n\t}\n\n\tOnAfterShowLHE()\n\t{\n\t\tconst div = [\n\t\t\tdocument.getElementById('feed-add-post-form-notice-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-buttons-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-bottom-alertblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-content-message-add-ins')\n\t\t];\n\n\t\tfor (let ii = 0; ii < div.length; ii++)\n\t\t{\n\t\t\tif (!div[ii])\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tdiv[ii].classList.remove('feed-post-form-block-hidden');\n\t\t}\n\n\t\tif(this.formParams.showTitle)\n\t\t{\n\t\t\tthis.showPanelTitle(true, false);\n\t\t}\n\n\t};\n\n\tOnAfterHideLHE()\n\t{\n\t\tconst div = [\n\t\t\tdocument.getElementById('feed-add-post-form-notice-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-buttons-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-bottom-alertblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-content-message-add-ins')\n\t\t];\n\n\t\tfor (let ii = 0; ii < div.length; ii++)\n\t\t{\n\t\t\tif (!div[ii])\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tdiv[ii].classList.add('feed-post-form-block-hidden');\n\t\t}\n\n\t\tif(this.formParams.showTitle)\n\t\t{\n\t\t\tthis.showPanelTitle(false, false);\n\t\t}\n\t};\n\n\tonEditorInited(editor)\n\t{\n\t\tif (PostForm.getInstance().initedEditorsList.includes(editor.id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (editor.id !== this.formParams.editorID)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.formParams.editor = editor;\n\t\tif (this.formParams.autoSave !== 'N')\n\t\t{\n\t\t\tnew PostFormAutoSave(this.formParams.autoSave, this.formParams.restoreAutosave);\n\t\t}\n\n\t\tconst f = window[editor.id + 'Files'];\n\t\tconst handler = LHEPostForm.getHandler(editor.id);\n\t\tconst needToReparse = [];\n\n\t\tlet node = null;\n\t\tlet controller = null;\n\n\t\tfor (let id in handler.controllers)\n\t\t{\n\t\t\tif (!handler.controllers.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\thandler.controllers[id].parser\n\t\t\t\t&& handler.controllers[id].parser.bxTag === 'postimage'\n\t\t\t)\n\t\t\t{\n\t\t\t\tcontroller = handler.controllers[id];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tconst closure = (a, b) => { return () => { a.insertFile(b); } };\n\t\tconst closure2 = (a, b, c) => { return () => {\n\t\t\tif (controller)\n\t\t\t{\n\t\t\t\tcontroller.deleteFile(b, {});\n\t\t\t\tDom.remove(document.getElementById(`wd-doc'${b}`));\n\t\t\t\tAjax({ method: 'GET', url: c});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ta.deleteFile(b, c, a, { controlID : 'common' });\n\t\t\t}\n\t\t} };\n\n\t\tfor (let intId in f)\n\t\t{\n\t\t\tif (!f.hasOwnProperty(intId))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (controller)\n\t\t\t{\n\t\t\t\tcontroller.addFile(f[intId]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet id = handler.checkFile(intId, \"common\", f[intId]);\n\t\t\t\tneedToReparse.push(intId);\n\n\t\t\t\tif (\n\t\t\t\t\t!!id\n\t\t\t\t\t&& document.getElementById(`wd-doc${intId}`)\n\t\t\t\t\t&& !document.getElementById(`wd-doc${intId}`).hasOwnProperty('bx-bound'))\n\t\t\t\t{\n\t\t\t\t\tBX(`wd-doc${intId}`).setAttribute('bx-bound', 'Y');\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t(node = document.getElementById(`wd-doc${intId}`).querySelector('.feed-add-img-wrap'))\n\t\t\t\t\t\t&& node\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tEvent.bind(node, 'click', closure(handler, id));\n\t\t\t\t\t\tnode.style.cursor = 'pointer';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t(node = document.getElementById(`wd-doc${intId}`).querySelector('.feed-add-img-title'))\n\t\t\t\t\t\t&& node\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tEvent.bind(node, 'click', closure(handler, id));\n\t\t\t\t\t\tnode.style.cursor = 'pointer';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t(node = document.getElementById(`wd-doc${intId}`).querySelector('.feed-add-post-del-but'))\n\t\t\t\t&& node\n\t\t\t)\n\t\t\t{\n\t\t\t\tEvent.bind(node, 'click', closure2(handler, intId, f[intId].del_url));\n\t\t\t\tnode.style.cursor = \"pointer\";\n\t\t\t}\n\t\t}\n\n\t\tif (needToReparse.length > 0)\n\t\t{\n\t\t\teditor.SaveContent();\n\t\t\tlet content = editor.GetContent();\n\t\t\tcontent = content.replace(new RegExp('\\\\&\\\\#91\\\\;IMG ID=(' + needToReparse.join('|') + ')([WIDTHHEIGHT=0-9 ]*)\\\\&\\\\#93\\\\;','gim'), '[IMG ID=$1$2]');\n\t\t\teditor.SetContent(content);\n\t\t\teditor.Focus();\n\t\t}\n\t\tPostForm.getInstance().initedEditorsList.push(editor.id);\n\n\t\tEventEmitter.subscribe(editor, 'OnSetViewAfter', () => {\n\t\t\tif (this.formParams.createdFromEmail)\n\t\t\t{\n\t\t\t\teditor.SetContent(`${editor.GetContent()}${Loc.getMessage('CREATED_ON_THE_BASIC_OF_THE_MESSAGE')}`);\n\t\t\t\teditor.Focus(true);\n\t\t\t}\n\t\t});\n\t}\n\n\treinit()\n\t{\n\t\tif (!this.formParams.editorID)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isFunction(this.formParams.editor))\n\t\t{\n\t\t\tthis.formParams.editor(this.formParams.text);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(this.reinit, 50);\n\t\t}\n\t};\n}\n","import { Event, Type, Dom, Loc } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport PostFormEditor from './editor';\n\nexport default class PostFormAutoSave\n{\n\tconstructor(autoSaveRestoreMethod, initRestore)\n\t{\n\t\tthis.init(autoSaveRestoreMethod, initRestore);\n\t}\n\n\tinit(autoSaveRestoreMethod, initRestore)\n\t{\n\t\tconst formId = 'blogPostForm';\n\t\tconst form = document.getElementById(formId);\n\t\tconst titleID = 'POST_TITLE';\n\t\tconst title = document.getElementById(titleID);\n\t\tconst tags = form.TAGS;\n\n\t\tif (!form)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tinitRestore = (!Type.isUndefined(initRestore) ? !!initRestore : true);\n\n\t\tEventEmitter.subscribe(form, 'onAutoSavePrepare', (event: BaseEvent) => {\n\t\t\tconst [ ob, handler ] = event.getData();\n\n\t\t\tob.DISABLE_STANDARD_NOTIFY = true;\n\t\t\tconst _ob = ob;\n\t\t\tsetTimeout(() => { this.bindLHEEvents(_ob) }, 100);\n\t\t});\n\n\t\tEventEmitter.subscribe(form, 'onAutoSave', (event: BaseEvent) => {\n\t\t\tconst [ ob, formData ] = event.getData();\n\n\t\t\tformData.TAGS = tags.value;\n\t\t\tdelete formData.POST_MESSAGE;\n\t\t});\n\n\t\tif (autoSaveRestoreMethod == 'Y')\n\t\t{\n\t\t\tEventEmitter.subscribe(form, 'onAutoSaveRestoreFound', (event: BaseEvent) => {\n\t\t\t\tconst [ ob, data ] = event.getData();\n\n\t\t\t\tlet text = data[`text${formId}`];\n\t\t\t\ttext = (Type.isStringFilled(text) ? text.trim() : '');\n\n\t\t\t\tlet title = data[titleID];\n\t\t\t\ttitle = (Type.isStringFilled(title) ? title.trim() : '');\n\n\t\t\t\tif (\n\t\t\t\t\t!Type.isStringFilled(text)\n\t\t\t\t\t&& !Type.isStringFilled(title)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tob.Restore();\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEventEmitter.subscribe(form, 'onAutoSaveRestoreFound', (event: BaseEvent) => {\n\t\t\t\tconst [ ob, data ] = event.getData();\n\n\t\t\t\tlet text = data[`text${formId}`];\n\t\t\t\ttext = (Type.isStringFilled(text) ? text.trim() : '');\n\n\t\t\t\tlet title = data[titleID];\n\t\t\t\ttitle = (Type.isStringFilled(title) ? title.trim() : '');\n\n\t\t\t\tif (\n\t\t\t\t\t!Type.isStringFilled(text)\n\t\t\t\t\t&& !Type.isStringFilled(title)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst messageBody = document.getElementById('microoPostFormLHE_blogPostForm');\n\t\t\t\tconst textNode = Dom.create('DIV', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'feed-add-successfully'\n\t\t\t\t\t},\n\t\t\t\t\tchildren : [\n\t\t\t\t\t\tDom.create('SPAN', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName : 'feed-add-info-icon'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create('A', {\n\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\tclassName: 'feed-add-info-text',\n\t\t\t\t\t\t\t\thref : '#'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick : () => {\n\t\t\t\t\t\t\t\t\tob.Restore();\n\t\t\t\t\t\t\t\t\ttextNode.parentNode.removeChild(textNode);\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BLOG_POST_AUTOSAVE2')\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t});\n\n\t\t\t\tif (messageBody)\n\t\t\t\t{\n\t\t\t\t\tmessageBody.parentNode.insertBefore(textNode, messageBody);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (initRestore)\n\t\t{\n\t\t\tEventEmitter.subscribe(form, 'onAutoSaveRestore', (event: BaseEvent) => {\n\t\t\t\tconst [ ob, data ] = event.getData();\n\n\t\t\t\ttitle.value = data[titleID];\n\t\t\t\tif(\n\t\t\t\t\tType.isStringFilled(data[titleID])\n\t\t\t\t\t&& data[titleID] !== title.getAttribute('placeholder')\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tif(document.getElementById('divoPostFormLHE_blogPostForm').style.display !== 'none')\n\t\t\t\t\t{\n\t\t\t\t\t\tPostFormEditor.getInstance(formId).showPanelTitle(true);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.bShowTitle = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isFunction(title.__onchange))\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle.__onchange();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst formTags = window[`BXPostFormTags_${formId}`];\n\n\t\t\t\tif(\n\t\t\t\t\tdata.TAGS.length > 0\n\t\t\t\t\t&& formTags\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tconst tags = formTags.addTag(data.TAGS);\n\t\t\t\t\tif (tags.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.show(formTags.tagsArea);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tEventEmitter.emit('onAutoSaveRestoreDestination', new BaseEvent({\n\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\tformId: formId,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}]\n\t\t\t\t}));\n\n\t\t\t\tthis.bindLHEEvents(ob);\n\t\t\t});\n\t\t}\n\t};\n\n\tbindLHEEvents(_ob)\n\t{\n\t\tconst form = document.getElementById('blogPostForm');\n\t\tconst title = document.getElementById('POST_TITLE');\n\t\tconst tags = form.TAGS;\n\n\t\tEvent.bind(title, 'keydown', _ob.Init.bind(_ob));\n\t\tEvent.bind(tags, 'keydown', _ob.Init.bind(_ob));\n\t};\n}"],"names":["AjaxProcessor","block","callback","Type","isArray","CSS","length","BX","load","JS","container","callbackExternal","appendChild","create","html","CONTENT","htmlWasInserted","scriptsLoaded","processInlineJS","ajax","processRequestData","scriptsRunFirst","dataType","PostForm","instance","params","init","setInstance","key","value","isStringFilled","options","startVideoRecorder","setTimeout","editorForm","document","getElementById","EventEmitter","emit","BaseEvent","compatData","VideoRecorder","start","sliderInstance","SidePanel","Instance","getTopSlider","postMessageAll","window","sliderData","getData","inited","lazyLoad","isUndefined","ajaxUrl","isDomNode","containerMicro","containerMicroInner","successPostId","parseInt","setAttribute","timerListenEnter","stopListenEnter","event","clearTimeout","stopPropagation","preventDefault","fireDragEnter","click","startListenEnter","addEventListener","postMessage","originatorSliderId","get","close","subscribe","onSliderClose","set","clickDisabled","loaded","animationStartHeight","offsetHeight","loaderType","showWaitTab","style","display","showWait","Ajax","method","url","data","action","sessid","Loc","getMessage","onsuccess","result","closeWait","success","processAjaxBlock","PROPS","onfailure","isFunction","processor","processCSS","processAjaxBlockInsertHTML","processExternalJS","node","waiterNode","bxmsg","body","Dom","props","id","className","adjustWait","lastWait","push","parentNode","i","len","util","deleteFromArray","removeChild","clean","remove","nodePosition","pos","topDelta","top","GetDocElement","scrollTop","right","left","width","offsetWidth","taskId","Reflection","getClass","taskLink","replace","UI","Notification","Center","notify","content","actions","title","events","balloon","open","PostFormTabs","message","task","calendar","file","gratitude","important","vote","more","listItem","setEventNamespace","tabsInstance","SBPETabs","tabContainer","arrow","tabs","bodies","tabsList","querySelectorAll","getAttribute","limited","menuItems","tabId","text","onclick","createOnClick","config","ii","hasOwnProperty","previousTab","uploadFileNode","Event","bind","form","changePostFormTab","type","name","btn","btnText","innerHTML","evalGlobal","menu","popupWindow","iblock","setActive","isNull","active","needAnimation","isTaskTabLoaded","startAnimation","classList","jj","adjust","tabPosTab","bottom","leftStart","widthStart","easing","duration","finish","transition","makeEaseInOut","transitions","quart","step","state","complete","add","animate","hasValuesFile","hasValuesDocs","messageBody","childNodes","nodeFile","values1","querySelector","values2","rows","indexOf","nodeDocs","webdavValues","contains","SBPEBinded","eventNode","wdObj","dialogName","urlUpload","agent","uploadFileUrl","controllerInit","endAnimation","restoreMoreMenu","contentContainer","children","postEditSlider","currentSlider","getSliderByWindow","match","formInstance","getInstance","getEvent","animation","stop","height","overflowY","position","opacity","offsetTop","makeEaseOut","cssText","MenuManager","closeByEsc","offsetLeft","angle","show","itemCnt","componentParameters","GROUP_ID","PATH_TO_USER_TASKS","PATH_TO_USER_TASKS_TASK","PATH_TO_GROUP_TASKS","PATH_TO_GROUP_TASKS_TASK","PATH_TO_USER_PROFILE","PATH_TO_GROUP","PATH_TO_USER_TASKS_PROJECTS_OVERVIEW","PATH_TO_USER_TASKS_TEMPLATES","PATH_TO_USER_TEMPLATES_TEMPLATE","ENABLE_FOOTER","TEMPLATE_CONTROLLER_ID","ENABLE_FORM","BACKURL","runComponentAction","mode","parameters","COMPONENT_PARAMETERS","then","response","Runtime","asset","join","errors","forEach","error","Error","tabsDefault","menuItemsListsDefault","menuItemsLists","getMenuItems","createOnclickLists","getMenuItemsDefault","concat","showMoreMenuLists","siteId","bitrix_processes","k","lists","attrs","NAME","PICTURE","DESCRIPTION","PICTURE_SMALL","CODE","ID","permissions","admin","htmlspecialchars","menuBindElement","listsMenu","spanIcon","spanDataPicture","spanDataPictureDefault","Array","from","PostFormDateEnd","postExpireDateBlock","postEndTime","postEditingEndTime","postEndPeriod","popupTrigger","customDateFinal","durationOptionsContainer","durationOption","isInitialized","addEventHandlers","formDateTimeEditing","customDateSelectedTitle","innerText","getCurrentDate","selectors","formUfInputDateCustom","formDateDuration","showPostEndPeriodsPopup","curDate","Date","curTimestamp","Math","round","getTimezoneOffset","parseDate","date","convertToUTC","bTime","callback_after","onEndDateSet","popupShowingPeriods","createPopupShowingPeriods","createPopupItems","menuPostDurationItems","selectOptions","element","onPopupItemClick","dataset","currentTarget","customDatePopupOptionClass","customDateStyleModifier","toLowerCase","toUpperCase","getFormattedDate","format","convertBitrixFormat","PostFormGratSelector","fields","employeesValue","itemSelectedImageItem","itemSelectedInput","gratsList","e","openDialog","createEntitySelector","entitySelectorParams","gratItems","code","selectItem","gratRows","rownum","isNil","gratsContentElement","Popup","autoHide","bindOptions","forceBindPosition","closeIcon","onPopupClose","destroy","onPopupDestroy","offset","lightShadow","setAngle","gratSpan","selector","TagSelector","dialogOptions","context","preselectedItems","recalcValue","getTarget","getSelectedItems","inputNodeId","entities","emailUsers","inviteEmployeeLink","intranetUsersOnly","selectMode","addButtonCaption","addButtonCaptionMore","renderTo","tagNodeId","selectedItems","item","entityId","JSON","stringify","PostFormEditor","formID","setBlogPostFormSubmitted","submitBlogPostForm","disabled","formId","formParams","editorID","showTitle","submitted","autoSave","handler","LHEPostForm","getHandler","editor","getEditor","restoreAutosave","createdFromEmail","obj","onHandlerInited","onEditorInited","p","reinit","ready","Browser","isIE","showTitlePlaceholderBlur","__onchange","activeTab","checkHideAlert","hideAlert","saveChanges","showTitleValue","nodeBlock","stv","focus","hide","userOptions","save","isObject","SaveContent","submitButton","getSubmitButton","buttonType","removeClass","actionUrl","Uri","removeParam","addParam","b24statTab","includes","checkDestinationValue","checkEmployeesValue","submit","MPFEntitySelector","tagSelector","tags","enableSubmitButton","showBottomAlert","subscribeOnce","employeesValueNode","elements","alertNode","isPlainObject","OnAfterShowLHE","OnAfterHideLHE","div","showPanelTitle","initedEditorsList","PostFormAutoSave","f","needToReparse","controller","controllers","parser","bxTag","closure","a","b","insertFile","closure2","c","deleteFile","controlID","intId","addFile","checkFile","cursor","del_url","GetContent","RegExp","SetContent","Focus","autoSaveRestoreMethod","initRestore","titleID","TAGS","ob","DISABLE_STANDARD_NOTIFY","_ob","bindLHEEvents","formData","POST_MESSAGE","trim","Restore","textNode","href","insertBefore","bShowTitle","formTags","addTag","tagsArea","Init"],"mappings":"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"}