{"version":3,"file":"script.js","sources":["src/options.js","src/stress-level.js","src/theme-picker.js","src/ustat.js","src/widget.js"],"sourcesContent":["export default class Options {\n\tstatic eventNameSpace = 'BX.Intranet.Userprofile:';\n}","import {Type, Tag, Loc, ajax, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Options from \"./options\";\n\ntype StressLevelResponse = {\n\tid: number,\n\tdate: string,\n\tvalue: number,\n\ttype: string,\n\ttypeDescription: string,\n\tcomment: string,\n\thash: string,\n\turl: {\n\t\tcheck: string,\n\t\tresult: string\n\t}\n};\nexport class StressLevel {\n\tconstructor() {\n\t}\n\n\tstatic getOpenSliderFunction(url)\n\t{\n\t\tif (Type.isStringFilled(url))\n\t\t{\n\t\t\treturn () => {\n\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, Options.eventNameSpace + 'onNeedToHide');\n\t\t\t\tBX.SidePanel.Instance.open(url, {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tdata: {},\n\t\t\t\t\twidth: 500\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn () => {};\n\t}\n\n\tstatic showData(data: StressLevelResponse): Element\n\t{\n\t\tdata.value = parseInt(data.value || 0);\n\n\t\tconst result = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --vertical\" id=\"user-indicator-pulse\">\n\t\t\t\t<div class=\"system-auth-form__item-block --margin-bottom\">\n\t\t\t\t\t<div class=\"system-auth-form__stress-widget\">\n\t\t\t\t\t\t<div data-role=\"value-degree\" class=\"system-auth-form__stress-widget--arrow\" style=\"transform: rotate(90deg);\"></div>\n\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content-title\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_INDICATOR_TEXT')}</div>\n\t\t\t\t\t\t\t<div data-role=\"value\" class=\"system-auth-form__stress-widget--content-progress ${data.value > 0 ? '' : '--empty'}\">0</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --stress-widget-sp\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-block --center --width-100\">\n\t\t\t\t\t\t\t<span class=\"system-auth-form__stress-widget--status  --flex --${Text.encode(data.type)}\">${Text.encode(data.typeDescription)}</span>\n\t\t\t\t\t\t\t<span class=\"system-auth-form__icon-help\" onclick=\"${this.getOpenSliderFunction(data.url.result)}\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\" onclick=\"${this.getOpenSliderFunction(data.url.check)}\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_BUTTON')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-block --flex --center\">\n\t\t\t\t\t<div class=\"system-auth-form__stress-widget--message\">${Text.encode(data.comment)}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tsetTimeout(() => {\n\t\t\tconst intervalId = setInterval((value) => {\n\t\t\t\tvalue.current++;\n\t\t\t\tvalue.node.innerHTML = value.current;\n\t\t\t\tif (value.current >= value.end)\n\t\t\t\t{\n\t\t\t\t\tclearInterval(intervalId);\n\t\t\t\t}\n\t\t\t}, 600 / data.value, {\n\t\t\t\tcurrent: 0,\n\t\t\t\tend: data.value,\n\t\t\t\tnode: result.querySelector('[data-role=\"value\"]')\n\t\t\t});\n\t\t\tresult.querySelector('[data-role=\"value-degree\"]').style.transform = 'rotate(' + (1.8 * data.value) + 'deg)'\n\t\t}, 1000);\n\t\treturn result;\n\t}\n\n\tstatic showEmpty({url: {check}}): Element\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --vertical --empty-stress --clickable\" onclick=\"${this.getOpenSliderFunction(check)}\">\n\t\t\t\t<div class=\"system-auth-form__item-block --margin-bottom\">\n\t\t\t\t\t<div class=\"system-auth-form__stress-widget\">\n\t\t\t\t\t\t<div data-role=\"value-degree\" class=\"system-auth-form__stress-widget--arrow\" style=\"transform: rotate(90deg);\"></div>\n\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content-title\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_INDICATOR_TEXT')}</div>\n\t\t\t\t\t\t\t<div data-role=\"value\" class=\"system-auth-form__stress-widget--content-progress --empty\">?</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --stress-widget-sp\">\n\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--message\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_TITLE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-block --flex --center\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_BUTTON')}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-new\">\n\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_RESULT_COME_ON')}</div>\n\t\t\t\t</div>\n\t\t\t</div>`;\n\t}\n\n\tstatic getPromise({signedParameters, componentName, userId, data}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst promise = data ? Promise.resolve({data}) :\n\t\t\t\tajax.runAction('socialnetwork.api.user.stresslevel.get', {\n\t\t\t\t\tsignedParameters: signedParameters,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tc: componentName,\n\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\tuserId: userId\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tpromise.then(({data}) => {\n\t\t\t\t\tif (data && data.id !== undefined && data.value !== undefined)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn resolve(this.showData(data));\n\t\t\t\t\t}\n\n\t\t\t\t\tconst node = Loc.getMessage('USER_ID') === userId ?\n\t\t\t\t\t\tthis.showEmpty(data) : document.createElement('DIV');\n\n\t\t\t\t\treturn resolve(node);\n\t\t\t\t})\n\t\t\t\t.catch((error: Error) => {\n\t\t\t\t\tresolve(this.showData({\n\t\t\t\t\t\tid: undefined,\n\t\t\t\t\t\tvalue: undefined,\n\t\t\t\t\t\turls: {\n\t\t\t\t\t\t\tcheck: undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t})\n\t\t\t})\n\t\t;\n\t}\n}","import {Tag, Loc, Type, Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Options from './options';\n\ntype ThemePickerData = {\n\tid: string,\n\tlightning: ?string,\n\ttitle: string,\n\tpreviewImage: string,\n\tpreviewColor: string\n};\n\nexport default class ThemePicker extends EventEmitter {\n\t#params: ThemePickerData;\n\n\t#container;\n\n\tconstructor(data: ThemePickerData)\n\t{\n\t\tsuper();\n\t\tthis.#params = Object.assign({}, data);\n\t\tthis.#params.lightning = String(data.id).indexOf('light:') === 0 ? 'light' : (\n\t\t\tString(data.id).indexOf('dark:') === 0 ? 'dark' : null\n\t\t);\n\t\tthis.applyTheme = this.applyTheme.bind(this);\n\t\tthis.setEventNamespace(Options.eventNameSpace);\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Intranet.Bitrix24:ThemePicker:onThemeApply',\n\t\t\t({data: {id, theme}}) =>\n\t\t\t{\n\t\t\t\tthis.#params.id =  id;\n\t\t\t\tthis.#params.lightning = String(id).indexOf('light:') === 0 ? 'light' : (\n\t\t\t\t\tString(id).indexOf('dark:') === 0 ? 'dark' : null\n\t\t\t\t);\n\t\t\t\tthis.#params.title = theme.title;\n\t\t\t\tthis.#params.previewImage = theme.previewImage;\n\t\t\t\tthis.#params.previewColor = theme.previewColor;\n\t\t\t\tthis.applyTheme();\n\t\t\t}\n\t\t)\n\t}\n\n\tapplyTheme()\n\t{\n\t\tconst container = this.getContainer();\n\n\t\tcontainer.querySelector('[data-role=\"title\"]').innerHTML = this.#params.title ?? Loc.getMessage('AUTH_THEME_DIALOG');\n\n\t\tif (Type.isStringFilled(this.#params.previewImage) && this.#params.lightning)\n\t\t{\n\t\t\tcontainer.style.removeProperty('backgroundImage');\n\t\t\tcontainer.style.removeProperty('backgroundSize');\n\t\t\tcontainer.style.backgroundImage = 'url(\"' + this.#params.previewImage + '\")';\n\t\t\tcontainer.style.backgroundSize = 'cover';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontainer.style.background = 'none';\n\t\t}\n\n\t\tif (Type.isStringFilled(this.#params.previewColor))\n\t\t{\n\t\t\tthis.getContainer().style.backgroundColor = this.#params.previewColor;\n\t\t}\n\n\t\tif (!this.#params.lightning)\n\t\t{\n\t\t\tcontainer.style.backgroundColor = 'rgba(255,255,255,1)';\n\t\t}\n\n\t\tDom.removeClass(container, '--light --dark');\n\t\tDom.addClass(container, '--' + this.#params.lightning);\n\t}\n\n\tgetContainer()\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tconst onclick = () => {\n\t\t\tthis.emit('onOpen');\n\t\t\tBX.Intranet.Bitrix24.ThemePicker.Singleton.showDialog(false);\n\t\t};\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --border ${this.#params.lightning ? '--' + this.#params.lightning : ''} --padding-sm\" title=\"${Loc.getMessage('AUTH_THEME_DIALOG')}\">\n\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t<div data-role=\"preview-color\" class=\"system-auth-form__item-logo--image --theme\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-container --flex --column\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --white-space --block\">\n\t\t\t\t\t\t<span data-role=\"title\">Theme</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-content --margin-top-auto --center --center-force\">\n\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_CHANGE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`;\n\t\tsetTimeout(this.applyTheme, 0);\n\t\treturn this.#container;\n\t}\n\n\tgetPromise()\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tresolve(this.getContainer());\n\t\t});\n\t}\n}","import {Text, Type, Tag, Loc, ajax} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Options from \"./options\";\ntype userPulseUserData = {\n\tFULL_NAME: string,\n\tAVATAR_SRC: string,\n\tID: string\n};\ntype userPulseData = {\n\tUSERS_RATING: {\n\t\tposition: number,\n\t\trange: number,\n\t\ttop: [\n\t\t\t{\n\t\t\t\tUSER_ID: string,\n\t\t\t\tACTIVITY: number\n\t\t\t}\n\t\t]\n\t},\n\tUSERS_INFO: userPulseUserData[]\n};\n\nexport default class Ustat {\n\tdata: userPulseData;\n\tconstructor(data) {\n\t\tthis.data = data;\n\t\tthis.onclickHandle = this.onclickHandle.bind(this);\n\t}\n\n\t#renderUsers()\n\t{\n\t\tconst userList = document.createDocumentFragment();\n\t\tlet myPosition = parseInt(this.data['USERS_RATING']['position']);\n\n\t\tlet myActivity = 0;\n\t\tconst usersData = Type.isPlainObject(this.data['USERS_RATING']['top'])\n\t\t\t? Object.values(this.data['USERS_RATING']['top']) : (\n\t\t\t\tType.isArray(this.data['USERS_RATING']['top']) && this.data['USERS_RATING']['top'].length > 0\n\t\t\t\t\t? [...this.data['USERS_RATING']['top']] : [{'USER_ID': Loc.getMessage('USER_ID'), ACTIVITY: 0}]);\n\t\tconst dataResult = myPosition > 5 ?\n\t\t\t[...usersData.slice(0, 3), ...usersData.slice(-1), null]\n\t\t\t: usersData\n\t\t;\n\t\tdataResult\n\t\t\t.forEach((userRating, index) => {\n\t\t\t\tif (userRating === null)\n\t\t\t\t{\n\t\t\t\t\tuserList.appendChild(Tag.render`<div class=\"system-auth-form__userlist-item --list\"></div>`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet fullName = userRating['ACTIVITY'];\n\t\t\t\tlet avatarSrc = '';\n\t\t\t\tif (this.data['USERS_INFO'][userRating['USER_ID']])\n\t\t\t\t{\n\t\t\t\t\tfullName = [this.data['USERS_INFO'][userRating['USER_ID']]['FULL_NAME'], ': ', userRating['ACTIVITY']].join('');\n\t\t\t\t\tavatarSrc = String(this.data['USERS_INFO'][userRating['USER_ID']]['AVATAR_SRC']).length > 0\n\t\t\t\t\t\t? this.data['USERS_INFO'][userRating['USER_ID']]['AVATAR_SRC'] : null;\n\t\t\t\t}\n\t\t\t\tconst isCurrentUser = String(userRating['USER_ID']) === String(Loc.getMessage('USER_ID'));\n\t\t\t\tif (isCurrentUser)\n\t\t\t\t{\n\t\t\t\t\tmyActivity = userRating['ACTIVITY'];\n\t\t\t\t}\n\t\t\t\tuserList.appendChild(\n\t\t\t\t\tTag.render`\n\t\t\t\t\t\t<div title=\"${Text.encode(fullName)}\" class=\"system-auth-form__userlist-item ui-icon ui-icon ui-icon-common-user\">\n\t\t\t\t\t\t\t<i ${avatarSrc ? `style=\"background-image: url('${avatarSrc}');background-size: cover;\"` : ''}></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\t\treturn {\n\t\t\tuserList,\n\t\t\tmyPosition,\n\t\t\trange: parseInt(this.data['USERS_RATING']['range']),\n\t\t\tmyActivity\n\t\t};\n\t}\n\n\tshowData(): Element\n\t{\n\t\tconst {myPosition, userList, range} = this.#renderUsers();\n\t\tlet div;\n\t\tif (range > 0 && myPosition > 0)\n\t\t{\n\t\t\tdiv = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --clickable\" onclick=\"${this.onclickHandle}\">\n\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --without-margin\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_TITLE')}</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light --margin-s\">\n\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_RATING')}</span>\n\t\t\t\t\t\t<span class=\"system-auth-form__icon-help\" data-hint=\"${Loc.getMessage('INTRANET_USTAT_COMPANY_HELP_RATING')}\" data-hint-no-icon></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light\" data-role=\"empty-info\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_IS_EMPTY')}</div>\n\n\t\t\t\t\t<div class=\"system-auth-form__item-title --white-space --margin-xl\">\n\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_POSITION',\n\t\t\t\t{'#POSITION#': myPosition, '#AMONG#': range})}</span>\n\t\t\t\t\t\t<span class=\"system-auth-form__ustat-icon --up\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__userlist\">\n\t\t\t\t\t\t${userList}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst onclick = range > 0 ? this.onclickHandle : () => {};\n\t\t\tdiv = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --without-stat ${range > 0 ? '--clickable' : ''}\" onclick=\"${onclick}\">\n\t\t\t\t<div class=\"system-auth-form__item-container --flex --column\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_TITLE')}</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --lighter\" data-role=\"empty-info\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_IS_EMPTY_BRIEF')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\t}\n\n\t\tBX.UI.Hint.init(div);\n\t\treturn div;\n\t}\n\n\tonclickHandle(event)\n\t{\n\t\tEventEmitter.emit(Options.eventNameSpace + 'onNeedToHide');\n\t\tif (window['openIntranetUStat'])\n\t\t{\n\t\t\topenIntranetUStat(event);\n\t\t}\n\t}\n\n\tshowWideData()\n\t{\n\t\tconst {myPosition, userList, range} = this.#renderUsers();\n\t\tconst div =  Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --center --padding-ustat ${range > 0 ? '--clickable' : '--without-stat'}\">\n\t\t\t\t<div class=\"system-auth-form__item-image\">\n\t\t\t\t\t<div class=\"system-auth-form__item-image--src --ustat\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-container --overflow\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --xl --without-margin\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_TITLE')}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-container --block\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light\" data-role=\"empty-info\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_IS_EMPTY')}</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container--inline\" data-role=\"my-position\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light --without-margin --margin-right\">\n\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_RATING')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --white-space --margin-xl\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_POSITION',\n\t\t\t{'#POSITION#': myPosition, '#AMONG#': range})}</span>\n\t\t\t\t\t\t\t<span class=\"system-auth-form__ustat-icon --up\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__userlist\" data-role=\"user-list\">\n\t\t\t\t\t\t${userList}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__icon-help --absolute-right-bottom\" data-hint=\"${Loc.getMessage('INTRANET_USTAT_COMPANY_HELP_RATING')}\" data-hint-no-icon></div>\n\t\t\t</div>\n\t\t`;\n\t\tif (range > 0)\n\t\t{\n\t\t\tdiv.addEventListener('click', this.onclickHandle);\n\t\t}\n\t\treturn div;\n\t}\n\n\tstatic getPromise({userId, isNarrow, data}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t(data ?\n\t\t\t\tPromise.resolve({data}) :\n\t\t\t\tajax.runComponentAction(\n\t\t\t\t\t'bitrix:intranet.ustat.department',\n\t\t\t\t\t'getJson',\n\t\t\t\t\t{mode: 'class', data: {}}\n\t\t\t\t))\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tconst ustat = new this(data);\n\t\t\t\t\tresolve(isNarrow ? ustat.showData() : ustat.showWideData());\n\t\t\t\t})\n\t\t\t\t.catch((errors) => {\n\t\t\t\t\terrors = Type.isArray(errors) ? errors : [errors];\n\t\t\t\t\tconst node = document.createElement('ul');\n\t\t\t\t\terrors.forEach(({message}) => {\n\t\t\t\t\t\tconst errorNode = document.createElement('li');\n\t\t\t\t\t\terrorNode.innerHTML = message;\n\t\t\t\t\t\terrorNode.className = 'ui-alert-message';\n\t\t\t\t\t\tnode.appendChild(errorNode);\n\t\t\t\t\t});\n\t\t\t\t\tresolve(Tag.render`\n\t\t\t\t\t\t<div class=\"ui-alert ui-alert-danger\">\n\t\t\t\t\t\t\t${node}\n\t\t\t\t\t\t</div>`)\n\t\t\t\t});\n\n\t\t});\n\t}\n}","import {Uri, Type, Tag, Cache, Loc, Browser, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupComponentsMaker} from 'ui.popupcomponentsmaker';\nimport {StressLevel} from './stress-level';\nimport ThemePicker from './theme-picker';\nimport {Menu} from 'main.popup';\nimport 'main.qrcode';\nimport Options from \"./options\";\nimport Ustat from \"./ustat\";\nimport {QrAuthorization} from \"ui.qrauthorization\";\n\nconst widgetMarker = Symbol('user.widget');\nexport default class Widget extends EventEmitter\n{\n\t#container: Element;\n\t#popup: ?PopupComponentsMaker;\n\t#profile = null;\n\t#features = {};\n\t#cache = new Cache.MemoryCache();\n\n\n\tconstructor(container, {\n\t\tprofile: {ID, FULL_NAME, PHOTO, STATUS, URL, WORK_POSITION},\n\t\tcomponent: {componentName, signedParameters},\n\t\tfeatures\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace(Options.eventNameSpace);\n\t\tthis.#container = container;\n\t\tthis.#profile = {ID, FULL_NAME, PHOTO, STATUS, URL, WORK_POSITION};\n\t\tthis.#features = features;\n\t\tif (!Type.isStringFilled(this.#features.browser))\n\t\t{\n\t\t\tthis.#features.browser =\n\t\t\t\t(Browser.isLinux() ? 'Linux'\n\t\t\t\t: (Browser.isWin() ? 'Windows' : 'MacOs')\n\t\t\t\t)\n\t\t\t;\n\t\t}\n\n\t\tthis.#cache.set('componentParams', {componentName, signedParameters});\n\t\tthis.hide = this.hide.bind(this);\n\t}\n\n\ttoggle()\n\t{\n\t\tif (this.getPopup().isShown())\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tshow()\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\tgetPopup(): PopupComponentsMaker\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\treturn this.#popup;\n\t\t}\n\t\tlet content = [\n\t\t\tthis.#getProfileContainer(),\n\t\t\t(this.#getb24NetPanelContainer() ? {\n\t\t\t\thtml: this.#getb24NetPanelContainer(),\n\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t} : null),\n\t\t\t(this.#getAdminPanelContainer() ? {\n\t\t\t\thtml: this.#getAdminPanelContainer(),\n\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t} : null),\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getThemeContainer(),\n\t\t\t\t\tmarginBottom: 24,\n\t\t\t\t\toverflow: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getMaskContainer(),\n\t\t\t\t\tdisabled: true,\n\t\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t\t}\n\t\t\t],\n\t\t\tthis.#getCompanyPulse(!!this.#getStressLevel()) ?\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getCompanyPulse(!!this.#getStressLevel()),\n\t\t\t\t\toverflow: true,\n\t\t\t\t\tmarginBottom: 24,\n\t\t\t\t\tflex: this.#getStressLevel() ? 0.5 : 1\n\t\t\t\t},\n\t\t\t\tthis.#getStressLevel(),\n\t\t\t] : null,\n\t\t\tthis.#getOTPContainer(this.#getDeskTopContainer() === null) && this.#getDeskTopContainer() ?\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tflex: 0.5,\n\t\t\t\t\thtml: this.#getQrContainer(0.7)\n\t\t\t\t},\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\thtml: this.#getDeskTopContainer(),\n\t\t\t\t\t\tdisplayBlock: true\n\t\t\t\t\t},\n\t\t\t\t\tthis.#getOTPContainer()\n\t\t\t\t]\n\t\t\t] : this.#getDeskTopContainer() || this.#getOTPContainer() ? [\n\t\t\t\t\t{\n\t\t\t\t\t\thtml: this.#getQrContainer(2),\n\t\t\t\t\t\tflex: 2\n\t\t\t\t\t},\n\t\t\t\t\tthis.#getDeskTopContainer() ?? this.#getOTPContainer()\n\t\t\t] : this.#getQrContainer(0),\n\t\t\tthis.#getLoginHistoryContainer(),\n\t\t\t{\n\t\t\t\thtml: this.#getBindings(),\n\t\t\t\tmarginBottom: 24,\n\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t},\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getNotificationContainer() ?? null,\n\t\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getLogoutContainer(),\n\t\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t\t}\n\t\t\t]\n\t\t];\n\n\t\tconst filterFunc = (data): ?Array => {\n\t\t\tconst result = [];\n\t\t\tif (Type.isArray(data))\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < data.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isArray(data[i]))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst buff = filterFunc(data[i]);\n\t\t\t\t\t\tif (buff !== null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (Type.isArray(buff) && buff.length === 1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresult.push(buff[0]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresult.push(buff);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (data[i] !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(data[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result.length <= 0 ? null : (\n\t\t\t\tresult.length === 1 ? result[0] : result\n\t\t\t)\n\t\t};\n\t\tcontent = filterFunc(content);\n\n\t\tconst prepareFunc = (item, index, array) => {\n\t\t\tif (Type.isArray(item))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\thtml:  item.map(prepareFunc)\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tflex: item['flex'] || 0,\n\t\t\t\thtml: item['html'] || item,\n\t\t\t\tbackgroundColor: item['backgroundColor'] || null,\n\t\t\t\tdisabled: item['disabled'] || null,\n\t\t\t\toverflow: item['overflow'] || null,\n\t\t\t\tmarginBottom: item['marginBottom'] || null,\n\t\t\t\tdisplayBlock: item['displayBlock'] || null\n\t\t\t};\n\t\t}\n\t\tthis.#popup = new PopupComponentsMaker({\n\t\t\ttarget: this.#container,\n\t\t\tcontent: content.map(prepareFunc),\n\t\t\twidth: 400\n\t\t});\n\t\tEventEmitter.subscribe('BX.Main.InterfaceButtons:onMenuShow', this.hide);\n\t\tEventEmitter.subscribe(Options.eventNameSpace + 'onNeedToHide', this.hide);\n\t\treturn this.#popup;\n\t}\n\n\t#getProfileContainer(): Element\n\t{\n\t\treturn this.#cache.remember('profile', () => {\n\t\t\tconst onclick = (event) => {\n\t\t\t\tthis.hide();\n\t\t\t\treturn BX.SidePanel.Instance.open(this.#profile.URL);\n\t\t\t};\n\t\t\tconst avatarNode = Tag.render`\n\t\t\t\t<span class=\"system-auth-form__profile-avatar--image\"\n\t\t\t\t\t${this.#profile.PHOTO ? `\n\t\t\t\t\t\tstyle=\"background-size: cover; background-image: url('${this.#profile.PHOTO}')\"` : ''}>\n\t\t\t\t</span>\n\t\t\t\t`;\n\t\t\tconst nameNode = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__profile-name\">${this.#profile.FULL_NAME}</div>\n\t\t\t`;\n\t\t\tEventEmitter.subscribe(\n\t\t\t\tEventEmitter.GLOBAL_TARGET,\n\t\t\t\t'BX.Intranet.UserProfile:Avatar:changed',\n\t\t\t\t({data: [{url}]}) => {\n\t\t\t\t\tthis.#profile.PHOTO = url;\n\t\t\t\t\tavatarNode.style = Type.isStringFilled(url) ?\n\t\t\t\t\t\t`background-size: cover; background-image: url('${this.#profile.PHOTO}')` : '';\n\t\t\t\t})\n\t\t\t;\n\t\t\tEventEmitter.subscribe(\n\t\t\t\tEventEmitter.GLOBAL_TARGET,\n\t\t\t\t'BX.Intranet.UserProfile:Name:changed',\n\t\t\t\t({data: [{fullName}]}) => {\n\t\t\t\t\tthis.#profile.FULL_NAME = fullName;\n\t\t\t\t\tnameNode.innerHTML = fullName;\n\t\t\t\t\tthis.#container.querySelector('#user-name').innerHTML = fullName;\n\t\t\t\t})\n\t\t\t;\n\t\t\tlet workPosition = (Type.isStringFilled(this.#profile.WORK_POSITION) ? Text.encode(this.#profile.WORK_POSITION) : '');\n\t\t\tif (this.#profile.STATUS && Loc.hasMessage('INTRANET_USER_PROFILE_' + this.#profile.STATUS))\n\t\t\t{\n\t\t\t\tworkPosition = Loc.getMessage('INTRANET_USER_PROFILE_' + this.#profile.STATUS)\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --clickable\" onclick=\"${onclick}\">\n\t\t\t\t\t<div class=\"system-auth-form__profile\">\n\t\t\t\t\t\t<div class=\"system-auth-form__profile-avatar\">\n\t\t\t\t\t\t\t${avatarNode}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__profile-content --margin--right\">\n\t\t\t\t\t\t\t${nameNode}\n\t\t\t\t\t\t\t<div class=\"system-auth-form__profile-position\">${workPosition}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__profile-controls\">\n\t\t\t\t\t\t\t<span class=\"ui-qr-popupcomponentmaker__btn --large --border\" >\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_PROFILE')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t \t\t<!-- <span class=\"ui-qr-popupcomponentmaker__btn --large --success\">any text</span> -->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getb24NetPanelContainer()\n\t{\n\t\treturn this.#cache.remember('b24netPanel', () => {\n\t\t\tif (this.#features['b24netPanel'] !== 'Y')\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<a class=\"system-auth-form__item system-auth-form__scope --center --padding-sm --clickable\" href=\"https://www.bitrix24.net/\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --network\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('AUTH_PROFILE_B24NET')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --block\">\n\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\">${Loc.getMessage('INTRANET_USER_PROFILE_GOTO')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getAdminPanelContainer()\n\t{\n\t\treturn this.#cache.remember('adminPanel', () => {\n\t\t\tif (this.#features['adminPanel'] !== 'Y')\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<a class=\"system-auth-form__item system-auth-form__scope --center --padding-sm --clickable\" href=\"/bitrix/admin/\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --admin-panel\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('INTRANET_USER_PROFILE_ADMIN_PANEL')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --block\">\n\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\">${Loc.getMessage('INTRANET_USER_PROFILE_GOTO')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getThemeContainer(): Element\n\t{\n\t\treturn this.#cache.remember('themePicker', () => {\n\t\t\tif (this.#features['themePicker'] === null)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst themePicker = new ThemePicker(this.#features['themePicker']);\n\t\t\tthemePicker.subscribe('onOpen', this.hide);\n\t\t\treturn themePicker.getPromise();\n\t\t});\n\t}\n\n\t#getMaskContainer(): Element\n\t{\n\t\treturn this.#cache.remember('Mask', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --mask\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_MASKS')}</span>\n\t\t\t\t\t\t\t<span class=\"system-auth-form__icon-help\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --center --center-force\">\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\">${Loc.getMessage('INTRANET_USER_PROFILE_INSTALL')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-new --soon\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_SOON')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getCompanyPulse(isNarrow): Element\n\t{\n\t\treturn this.#cache.remember('getCompanyPulse', () => {\n\t\t\tif (this.#features.pulse === 'Y'\n\t\t\t\t&& this.#profile.ID > 0\n\t\t\t\t&& this.#profile.ID === Loc.getMessage('USER_ID')\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn Ustat.getPromise({\n\t\t\t\t\tuserId: this.#profile.ID,\n\t\t\t\t\tisNarrow,\n\t\t\t\t\tdata: this.#features['pulseData'] ?? null\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\t}\n\n\t#getStressLevel(): Promise\n\t{\n\t\tif (this.#features['stressLevel'] !== 'Y')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst result = this.#cache.remember('getStressLevel', () => {\n\t\t\treturn StressLevel.getPromise({\n\t\t\t\tsignedParameters: this.#cache.get('componentParams').signedParameters,\n\t\t\t\tcomponentName: this.#cache.get('componentParams').componentName,\n\t\t\t\tuserId: this.#profile.ID,\n\t\t\t\tdata: this.#features['stressLevelData'] ?? null\n\t\t\t});\n\t\t});\n\t\tthis.#cache.delete('componentParams');\n\t\treturn result;\n\t}\n\n\t#getQrContainer(flex): Element\n\t{\n\t\treturn this.#cache.remember('getQrContainer', () => {\n\t\t\tconst isInstalled = this.#features['appInstalled']['APP_ANDROID_INSTALLED'] === 'Y'\n\t\t\t\t|| this.#features['appInstalled']['APP_IOS_INSTALLED'] === 'Y';\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.hide();\n\t\t\t\t(new QrAuthorization({\n\t\t\t\t\ttitle: Loc.getMessage('INTRANET_USER_PROFILE_QRCODE_TITLE2'),\n\t\t\t\t\tcontent: Loc.getMessage('INTRANET_USER_PROFILE_QRCODE_BODY2'),\n\t\t\t\t\thelpLink: ''\n\t\t\t\t})).show();\n\t\t\t}\n\t\t\tconst onclickHelp = (event: MouseEvent) => {\n\t\t\t\ttop.BX.Helper.show('redirect=detail&code=14999860');\n\t\t\t\tthis.hide();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tlet node;\n\t\t\tif (flex !== 2 && flex !== 0)\n\t\t\t{\n\t\t\t\t// for a small size\n\t\t\t\tnode = Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope ${isInstalled ? '--active' : ''}  --clickable\" onclick=\"${onclick}\" style=\"padding: 10px 14px\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --center --column --center\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --center --margin-xl\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_TITLE2_SMALL')}</div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__qr\" style=\"margin-bottom: 12px\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn --border\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_SHOW_QR_SMALL')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__icon-help --absolute\" onclick=\"${onclickHelp}\" title=\"${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_HOW_DOES_IT_WORK')}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse if (flex === 0)\n\t\t\t{\n\t\t\t\t//full size\n\t\t\t\tnode = Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope ${isInstalled ? '--active' : ''} --padding-qr-xl\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --column --flex --flex-start\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --l\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_TITLE2')}</div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\" onclick=\"${onclickHelp}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_HOW_DOES_IT_WORK')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn --large --border\" style=\"margin-top: auto\" onclick=\"${onclick}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_SHOW_QR')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --qr\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__qr --full-size\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// for flex 2. It is kind of middle\n\t\t\t\tnode = Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope ${isInstalled ? '--active' : ''} --padding-mid-qr  --clickable\" onclick=\"${onclick}\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --column --flex --flex-start\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --block\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_TITLE2_SMALL')}\n\t\t\t\t\t\t\t\t<span class=\"system-auth-form__icon-help --inline\" onclick=\"${onclickHelp}\" title=\"${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_HOW_DOES_IT_WORK')}\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn --border\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_SHOW_QR')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --qr\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__qr --size-2\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\treturn node;\n\t\t});\n\t}\n\n\t#getDeskTopContainer(): ?Element\n\t{\n\t\tif (this.#features.browser === 'Linux')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn this.#cache.remember('getDeskTopContainer', () => {\n\t\t\tlet isInstalled = this.#features['appInstalled']['APP_MAC_INSTALLED'] === 'Y';\n\t\t\tlet cssPostfix = '--apple';\n\t\t\tlet title = Loc.getMessage('INTRANET_USER_PROFILE_DESKTOP_APPLE');\n\t\t\tlet linkToDistributive = 'https://dl.bitrix24.com/b24/bitrix24_desktop.dmg'\n\n\t\t\tif (this.#features.browser === 'Windows')\n\t\t\t{\n\t\t\t\tisInstalled = this.#features['appInstalled']['APP_WINDOWS_INSTALLED'] === 'Y';\n\t\t\t\tcssPostfix = '--windows';\n\t\t\t\ttitle = Loc.getMessage('INTRANET_USER_PROFILE_DESKTOP_WINDOWS');\n\t\t\t\tlinkToDistributive = 'https://dl.bitrix24.com/b24/bitrix24_desktop.exe'\n\t\t\t}\n\t\t\tconst onclick = isInstalled ? (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t} : () => {\n\t\t\t\tthis.hide();\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\tif (Type.isPlainObject(this.#features['otp']) === false)\n\t\t\t{\n\t\t\t\tlet menuPopup = null;\n\t\t\t\tconst popupClick = (event: MouseEvent) => {\n\t\t\t\t\tmenuPopup = (menuPopup || (new Menu({\n\t\t\t\t\t\tclassName: 'system-auth-form__popup',\n\t\t\t\t\t\tbindElement: event.target,\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\t\ttext: Loc.getMessage('INTRANET_USER_PROFILE_DOWNLOAD'),\n\t\t\t\t\t\t\t\thref: linkToDistributive,\n\t\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\t\tmenuPopup.close();\n\t\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}],\n\t\t\t\t\t\tangle: true,\n\t\t\t\t\t\toffsetLeft: 10,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(false);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})));\n\t\t\t\t\tmenuPopup.toggle();\n\t\t\t\t};\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div data-role=\"desktop-item\" class=\"system-auth-form__item system-auth-form__scope --padding-sm-all ${isInstalled ? ' --active' : ''} --vertical --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo --margin-bottom --center system-auth-form__item-container --flex\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image ${cssPostfix}\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${isInstalled ? Tag.render`<div class=\"system-auth-form__config --absolute\" onclick=\"${popupClick}\"></div>` : ''}\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --flex --center --display-flex\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light --center --s\">${title}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --flex --center --display-flex\">\n\t\t\t\t\t\t\t<a class=\"ui-qr-popupcomponentmaker__btn\" style=\"margin-top: auto\" href=\"${linkToDistributive}\" target=\"_blank\" onclick=\"${onclick}\">\n\t\t\t\t\t\t\t\t${isInstalled ? Loc.getMessage('INTRANET_USER_PROFILE_INSTALLED') : Loc.getMessage('INTRANET_USER_PROFILE_INSTALL')}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-bottom-10 ${isInstalled ? ' --active' : ''}\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image ${cssPostfix}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title ${isInstalled ? ' --without-margin' : '--min-height'}\"\">${title}</div>\n\t\t\t\t\t\t${isInstalled ?\n\t\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t<a href=\"${linkToDistributive}\" class=\"system-auth-form__item-title --link-dotted\">${Loc.getMessage('INTRANET_USER_PROFILE_DOWNLOAD')}</a>\n\t\t\t\t\t\t\t` : ''\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --center --center-force\">\n\t\t\t\t\t\t\t<a class=\"ui-qr-popupcomponentmaker__btn\" href=\"${linkToDistributive}\" target=\"_blank\" onclick=\"${onclick}\">\n\t\t\t\t\t\t\t\t${isInstalled ? Loc.getMessage('INTRANET_USER_PROFILE_INSTALLED') : Loc.getMessage('INTRANET_USER_PROFILE_INSTALL')}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getOTPContainer(single): Element\n\t{\n\t\tif (Type.isPlainObject(this.#features['otp']) === false)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#cache.remember('getOTPContainer', () => {\n\t\t\tconst isInstalled = this.#features['otp']['IS_ACTIVE'] === 'Y' || this.#features['otp']['IS_ACTIVE'] === true;\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.hide();\n\t\t\t\tif (String(this.#features['otp']['URL']).length > 0)\n\t\t\t\t{\n\t\t\t\t\tUri.addParam(this.#features['otp']['URL'], {page: 'otpConnected'});\n\t\t\t\t\tBX.SidePanel.Instance.open(Uri.addParam(this.#features['otp']['URL'], {page: 'otpConnected'}), {width: 1100});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.error('Otp page is not defined. Check the component params');\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst button = isInstalled ?\n\t\t\t\tTag.render`<div class=\"ui-qr-popupcomponentmaker__btn\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_TURNED_ON')}</div>`\n\t\t\t\t:\n\t\t\t\tTag.render`<div class=\"ui-qr-popupcomponentmaker__btn\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_TURN_ON')}</div>`;\n\t\t\tconst onclickHelp = () => {\n\t\t\t\ttop.BX.Helper.show('redirect=detail&code=6641271');\n\t\t\t\tthis.hide();\n\t\t\t};\n\t\t\tif (single !== true)\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-bottom-10 ${isInstalled ? ' --active' : ''}\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --authentication\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --flex --column --flex-start\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --without-margin --block\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_OTP_MESSAGE')}&nbsp;<span class=\"system-auth-form__icon-help --inline\" onclick=\"${onclickHelp}\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${isInstalled ?\n\t\t\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_CONFIGURE')}</div>\n\t\t\t\t\t\t\t\t` : ''\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-content --margin-top-auto --center --center-force\">\n\t\t\t\t\t\t\t\t${button}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${isInstalled ? '' : `\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-new\">\n\t\t\t\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_OTP_TITLE')}</div>\n\t\t\t\t\t\t\t</div>`\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\tlet menuPopup = null;\n\t\t\tconst popupClick = (event: MouseEvent) => {\n\t\t\t\tmenuPopup = (menuPopup || (new Menu({\n\t\t\t\t\tclassName: 'system-auth-form__popup',\n\t\t\t\t\tbindElement: event.target,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: Loc.getMessage('INTRANET_USER_PROFILE_CONFIGURE'),\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tmenuPopup.close();\n\t\t\t\t\t\t\t\tonclick();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tangle: true,\n\t\t\t\t\toffsetLeft: 10,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(false);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})));\n\t\t\t\tmenuPopup.toggle();\n\t\t\t};\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-sm-all ${isInstalled ? ' --active' : ''} --vertical --center\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo --margin-bottom --center system-auth-form__item-container --flex\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --authentication\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --flex\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light --center --s\">\n\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_OTP_MESSAGE')}\n\t\t\t\t\t\t\t<!-- <span class=\"system-auth-form__icon-help\" onclick=\"${onclickHelp}\"></span> -->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${isInstalled ? Tag.render`<div class=\"system-auth-form__config --absolute\" onclick=\"${popupClick}\"></div>` : ''}\n\t\t\t\t\t<div class=\"system-auth-form__item-container --flex --column --space-around\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --flex --display-flex\">\n\t\t\t\t\t\t\t${button}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${isInstalled ? '' : `\n\t\t\t\t\t\t<div class=\"system-auth-form__item-new system-auth-form__item-new-icon --ssl\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_OTP_TITLE')}</div>\n\t\t\t\t\t\t</div>`\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getLoginHistoryContainer(): Element\n\t{\n\t\treturn this.#cache.remember('getLoginHistoryContainer', () => {\n\t\t\tif (this.#features['history'])// for the future\n\t\t\t{\n\t\t\t\tTag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --vertical\">\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center --border\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --history\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --sm\">${Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_TITLE')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content\">\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn --border\">Logout</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__visited\">\n\t\t\t\t\t\t<div class=\"system-auth-form__visited-item\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-icon --apple\"></div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-text\">Device 2</div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-action\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__visited-item\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-icon --android\"></div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-text\">Device 1</div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-action\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t\t<div class=\"system-auth-form__show-history\">Logout</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\t}\n\n\t\t\tlet resultEmpty = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item --hover system-auth-form__scope --center --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --history-gray\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title\">${Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_TITLE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-new --soon\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_SOON')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\treturn {\n\t\t\t\thtml: resultEmpty,\n\t\t\t\tdisabled: true,\n\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t}\n\t\t});\n\t}\n\n\t#getBindings(): ?Element\n\t{\n\t\tif (!(Type.isPlainObject(this.#features['bindings'])\n\t\t\t&& Type.isStringFilled(this.#features['bindings']['text'])\n\t\t\t&& Type.isArray(this.#features['bindings']['items'])\n\t\t\t&& this.#features['bindings']['items'].length > 0\n\t\t))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#cache.remember('getBindingsContainer', () => {\n\t\t\tconst div = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item --hover system-auth-form__scope --center --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --binding\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Text.encode(this.#features['bindings']['text'])}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div data-role=\"arrow\" class=\"system-auth-form__item-icon --arrow-right\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tdiv.addEventListener('click', () => {\n\t\t\t\tthis.__bindingsMenu = (this.__bindingsMenu || (new Menu({\n\t\t\t\t\tclassName: 'system-auth-form__popup',\n\t\t\t\t\tbindElement: div.querySelector('[data-role=\"arrow\"]'),\n\t\t\t\t\titems: this.#features['bindings']['items'],\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcachable: false,\n\t\t\t\t\toffsetLeft: 10,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(false);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(true);\n\t\t\t\t\t\t\tif (this.__bindingsMenu.isNeedToHide !== false)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})));\n\t\t\t\tthis.__bindingsMenu.isNeedToHide = false;\n\t\t\t\tthis.__bindingsMenu.toggle();\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.__bindingsMenu.isNeedToHide = true;\n\t\t\t\t}, 0);\n\t\t\t});\n\t\t\treturn div;\n\t\t});\n\t}\n\n\t#getNotificationContainer(): Element\n\t{\n\t\tif (this.#features['im'] !== 'Y')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn this.#cache.remember('getNotificationContainer', () => {\n\t\t\tconst div = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item --hover system-auth-form__scope --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --notification\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('AUTH_NOTIFICATION')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tdiv.addEventListener('click', () => {\n\t\t\t\tthis.hide();\n\t\t\t\tBXIM.openSettings({'onlyPanel':'notify'});\n\t\t\t});\n\t\t\treturn div;\n\t\t});\n\t}\n\n\t#getLogoutContainer(): Element\n\t{\n\t\treturn this.#cache.remember('getLogoutContainer', () => {\n\t\t\tconst backUrl = new Uri(window.location.pathname);\n\t\t\tbackUrl.removeQueryParam(['logout', 'login', 'back_url_pub', 'user_lang']);\n\t\t\tconst newUrl =  new Uri('/auth/?logout=yes');\n\t\t\tnewUrl.setQueryParam('sessid', BX.bitrix_sessid());\n\t\t\tnewUrl.setQueryParam('backurl', encodeURIComponent(backUrl.toString()));\n\t\t\t//TODO   \n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --logout\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('AUTH_LOGOUT')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<a href=\"${newUrl.toString()}\" class=\"system-auth-form__item-link-all\"></a>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tstatic init(node, options)\n\t{\n\t\tif (node[widgetMarker])\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst onclick = () => {\n\t\t\tif (!node['popupSymbol'])\n\t\t\t{\n\t\t\t\tnode['popupSymbol'] = new this(node, options);\n\t\t\t}\n\t\t\tnode['popupSymbol'].toggle();\n\t\t\tthis.instance = node['popupSymbol'];\n\t\t};\n\t\tnode[widgetMarker] = true;\n\t\tnode.addEventListener('click', onclick);\n\t\tsetTimeout(onclick, 100);\n\t}\n\n\tstatic instance = null;\n\n\tstatic getInstance():? this\n\t{\n\t\treturn this.instance;\n\t}\n}"],"names":["Options","StressLevel","url","Type","isStringFilled","EventEmitter","emit","GLOBAL_TARGET","eventNameSpace","BX","SidePanel","Instance","open","cacheable","data","width","value","parseInt","result","Tag","render","Loc","getMessage","Text","encode","type","typeDescription","getOpenSliderFunction","check","comment","setTimeout","intervalId","setInterval","current","node","innerHTML","end","clearInterval","querySelector","style","transform","signedParameters","componentName","userId","Promise","resolve","reject","promise","ajax","runAction","c","fields","then","id","undefined","showData","showEmpty","document","createElement","catch","error","urls","ThemePicker","Object","assign","lightning","String","indexOf","applyTheme","bind","setEventNamespace","subscribe","theme","title","previewImage","previewColor","container","getContainer","removeProperty","backgroundImage","backgroundSize","background","backgroundColor","Dom","removeClass","addClass","onclick","Intranet","Bitrix24","Singleton","showDialog","Ustat","onclickHandle","myPosition","userList","range","div","UI","Hint","init","event","window","openIntranetUStat","addEventListener","isNarrow","runComponentAction","mode","ustat","showWideData","errors","isArray","forEach","message","errorNode","className","appendChild","createDocumentFragment","myActivity","usersData","isPlainObject","values","length","ACTIVITY","dataResult","slice","userRating","index","fullName","avatarSrc","join","isCurrentUser","widgetMarker","Symbol","Widget","profile","ID","FULL_NAME","PHOTO","STATUS","URL","WORK_POSITION","component","features","Cache","MemoryCache","browser","Browser","isLinux","isWin","set","hide","getPopup","isShown","show","close","content","_classPrivateMethodGet","html","marginBottom","overflow","disabled","flex","displayBlock","filterFunc","i","buff","push","prepareFunc","item","array","map","PopupComponentsMaker","target","options","toggle","instance","remember","avatarNode","nameNode","workPosition","hasMessage","themePicker","getPromise","pulse","get","delete","isInstalled","QrAuthorization","helpLink","onclickHelp","top","Helper","preventDefault","stopPropagation","cssPostfix","linkToDistributive","menuPopup","popupClick","Menu","bindElement","items","text","href","angle","offsetLeft","events","onShow","setAutoHide","onClose","single","Uri","addParam","page","console","button","resultEmpty","__bindingsMenu","cachable","isNeedToHide","BXIM","openSettings","backUrl","location","pathname","removeQueryParam","newUrl","setQueryParam","bitrix_sessid","encodeURIComponent","toString"],"mappings":"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"}