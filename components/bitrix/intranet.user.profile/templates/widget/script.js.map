{"version":3,"file":"script.js","sources":["src/options.js","src/stress-level.js","src/theme-picker.js","src/mask-editor.js","src/ustat.js","src/user-login-history.js","src/widget.js"],"sourcesContent":["export default class Options {\n\tstatic eventNameSpace = 'BX.Intranet.Userprofile:';\n}","import {Type, Tag, Loc, ajax, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Options from \"./options\";\n\ntype StressLevelResponse = {\n\tid: number,\n\tdate: string,\n\tvalue: number,\n\ttype: string,\n\ttypeDescription: string,\n\tcomment: string,\n\thash: string,\n\turl: {\n\t\tcheck: string,\n\t\tresult: string\n\t}\n};\nexport class StressLevel {\n\tconstructor() {\n\t}\n\n\tstatic getOpenSliderFunction(url)\n\t{\n\t\tif (Type.isStringFilled(url))\n\t\t{\n\t\t\treturn () => {\n\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, Options.eventNameSpace + 'onNeedToHide');\n\t\t\t\tBX.SidePanel.Instance.open(url, {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tdata: {},\n\t\t\t\t\twidth: 500\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn () => {};\n\t}\n\n\tstatic showData(data: StressLevelResponse): Element\n\t{\n\t\tdata.value = parseInt(data.value || 0);\n\n\t\tconst result = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --vertical\" id=\"user-indicator-pulse\">\n\t\t\t\t<div class=\"system-auth-form__item-block --margin-bottom\">\n\t\t\t\t\t<div class=\"system-auth-form__stress-widget\">\n\t\t\t\t\t\t<div data-role=\"value-degree\" class=\"system-auth-form__stress-widget--arrow\" style=\"transform: rotate(90deg);\"></div>\n\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content-title\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_INDICATOR_TEXT')}</div>\n\t\t\t\t\t\t\t<div data-role=\"value\" class=\"system-auth-form__stress-widget--content-progress ${data.value > 0 ? '' : '--empty'}\">0</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --stress-widget-sp\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-block --center --width-100\">\n\t\t\t\t\t\t\t<span class=\"system-auth-form__stress-widget--status  --flex --${Text.encode(data.type)}\">${Text.encode(data.typeDescription)}</span>\n\t\t\t\t\t\t\t<span class=\"system-auth-form__icon-help\" onclick=\"${this.getOpenSliderFunction(data.url.result)}\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\" onclick=\"${this.getOpenSliderFunction(data.url.check)}\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_BUTTON')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-block --flex --center\">\n\t\t\t\t\t<div class=\"system-auth-form__stress-widget--message\">${Text.encode(data.comment)}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tsetTimeout(() => {\n\t\t\tconst intervalId = setInterval((value) => {\n\t\t\t\tvalue.current++;\n\t\t\t\tvalue.node.innerHTML = value.current;\n\t\t\t\tif (value.current >= value.end)\n\t\t\t\t{\n\t\t\t\t\tclearInterval(intervalId);\n\t\t\t\t}\n\t\t\t}, 600 / data.value, {\n\t\t\t\tcurrent: 0,\n\t\t\t\tend: data.value,\n\t\t\t\tnode: result.querySelector('[data-role=\"value\"]')\n\t\t\t});\n\t\t\tresult.querySelector('[data-role=\"value-degree\"]').style.transform = 'rotate(' + (1.8 * data.value) + 'deg)'\n\t\t}, 1000);\n\t\treturn result;\n\t}\n\n\tstatic showEmpty({url: {check}}): Element\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --vertical --empty-stress --clickable\" onclick=\"${this.getOpenSliderFunction(check)}\">\n\t\t\t\t<div class=\"system-auth-form__item-block --margin-bottom\">\n\t\t\t\t\t<div class=\"system-auth-form__stress-widget\">\n\t\t\t\t\t\t<div data-role=\"value-degree\" class=\"system-auth-form__stress-widget--arrow\" style=\"transform: rotate(90deg);\"></div>\n\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content-title\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_INDICATOR_TEXT')}</div>\n\t\t\t\t\t\t\t<div data-role=\"value\" class=\"system-auth-form__stress-widget--content-progress --empty\">?</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --stress-widget-sp\">\n\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--message\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_TITLE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-block --flex --center\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_BUTTON')}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-new\">\n\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_RESULT_COME_ON')}</div>\n\t\t\t\t</div>\n\t\t\t</div>`;\n\t}\n\n\tstatic getPromise({signedParameters, componentName, userId, data}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst promise = data ? Promise.resolve({data}) :\n\t\t\t\tajax.runAction('socialnetwork.api.user.stresslevel.get', {\n\t\t\t\t\tsignedParameters: signedParameters,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tc: componentName,\n\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\tuserId: userId\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tpromise.then(({data}) => {\n\t\t\t\t\tif (data && data.id !== undefined && data.value !== undefined)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn resolve(this.showData(data));\n\t\t\t\t\t}\n\n\t\t\t\t\tconst node = Loc.getMessage('USER_ID') === userId ?\n\t\t\t\t\t\tthis.showEmpty(data) : document.createElement('DIV');\n\n\t\t\t\t\treturn resolve(node);\n\t\t\t\t})\n\t\t\t\t.catch((error: Error) => {\n\t\t\t\t\tresolve(this.showData({\n\t\t\t\t\t\tid: undefined,\n\t\t\t\t\t\tvalue: undefined,\n\t\t\t\t\t\turls: {\n\t\t\t\t\t\t\tcheck: undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t})\n\t\t\t})\n\t\t;\n\t}\n}","import {Tag, Loc, Type, Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Options from './options';\n\ntype ThemePickerData = {\n\tid: string,\n\tlightning: ?string,\n\ttitle: string,\n\tpreviewImage: string,\n\tpreviewColor: string\n};\n\nexport default class ThemePicker extends EventEmitter {\n\t#params: ThemePickerData;\n\n\t#container;\n\n\tconstructor(data: ThemePickerData)\n\t{\n\t\tsuper();\n\t\tthis.#params = Object.assign({}, data);\n\t\tthis.#params.lightning = String(data.id).indexOf('light:') === 0 ? 'light' : (\n\t\t\tString(data.id).indexOf('dark:') === 0 ? 'dark' : null\n\t\t);\n\t\tthis.applyTheme = this.applyTheme.bind(this);\n\t\tthis.setEventNamespace(Options.eventNameSpace);\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Intranet.Bitrix24:ThemePicker:onThemeApply',\n\t\t\t({data: {id, theme}}) =>\n\t\t\t{\n\t\t\t\tthis.#params.id =  id;\n\t\t\t\tthis.#params.lightning = String(id).indexOf('light:') === 0 ? 'light' : (\n\t\t\t\t\tString(id).indexOf('dark:') === 0 ? 'dark' : null\n\t\t\t\t);\n\t\t\t\tthis.#params.title = theme.title;\n\t\t\t\tthis.#params.previewImage = theme.previewImage;\n\t\t\t\tthis.#params.previewColor = theme.previewColor;\n\t\t\t\tthis.applyTheme();\n\t\t\t}\n\t\t)\n\t}\n\n\tapplyTheme()\n\t{\n\t\tconst container = this.getContainer();\n\n\t\tcontainer.querySelector('[data-role=\"title\"]').innerHTML = this.#params.title ?? Loc.getMessage('AUTH_THEME_DIALOG');\n\n\t\tif (Type.isStringFilled(this.#params.previewImage) && this.#params.lightning)\n\t\t{\n\t\t\tcontainer.style.removeProperty('backgroundImage');\n\t\t\tcontainer.style.removeProperty('backgroundSize');\n\t\t\tcontainer.style.backgroundImage = 'url(\"' + this.#params.previewImage + '\")';\n\t\t\tcontainer.style.backgroundSize = 'cover';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontainer.style.background = 'none';\n\t\t}\n\n\t\tif (Type.isStringFilled(this.#params.previewColor))\n\t\t{\n\t\t\tthis.getContainer().style.backgroundColor = this.#params.previewColor;\n\t\t}\n\n\t\tif (!this.#params.lightning)\n\t\t{\n\t\t\tcontainer.style.backgroundColor = 'rgba(255,255,255,1)';\n\t\t}\n\n\t\tDom.removeClass(container, '--light --dark');\n\t\tDom.addClass(container, '--' + this.#params.lightning);\n\t}\n\n\tgetContainer()\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tconst onclick = () => {\n\t\t\tthis.emit('onOpen');\n\t\t\tBX.Intranet.Bitrix24.ThemePicker.Singleton.showDialog(false);\n\t\t};\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --border ${this.#params.lightning ? '--' + this.#params.lightning : ''} --padding-sm\" title=\"${Loc.getMessage('AUTH_THEME_DIALOG')}\">\n\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t<div data-role=\"preview-color\" class=\"system-auth-form__item-logo--image --theme\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-container --flex --column\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --white-space --block\">\n\t\t\t\t\t\t<span data-role=\"title\">Theme</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-content --margin-top-auto --center --center-force\">\n\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_CHANGE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`;\n\t\tsetTimeout(this.applyTheme, 0);\n\t\treturn this.#container;\n\t}\n\n\tgetPromise()\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tresolve(this.getContainer());\n\t\t});\n\t}\n}","import {Tag, Loc, Type, Dom} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport Options from './options';\nimport {Editor as AvatarEditor, FileType as AvatarFileType} from 'ui.avatar-editor';\n\nexport default class MaskEditor extends EventEmitter\n{\n\t#container: HTMLElement;\n\t#isAvailable: boolean = false;\n\t#isInstalled: boolean = false;\n\t#avatarInfo: AvatarFileType = {scr: null, maskId: null};\n\t#avatarEditor: ?AvatarEditor;\n\n\tconstructor(data: ?AvatarFileType)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace(Options.eventNameSpace);\n\t\tthis.#isAvailable = data !== undefined;\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#avatarInfo.src = data.src;\n\t\t}\n\t\tthis.getContainer();\n\t\tif (Type.isPlainObject(data) && data.maskId)\n\t\t{\n\t\t\tthis.installMask(data.maskId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.uninstallMask();\n\t\t}\n\t}\n\n\tgetEditor(): ?AvatarEditor\n\t{\n\t\tif (this.#avatarEditor)\n\t\t{\n\t\t\treturn this.#avatarEditor;\n\t\t}\n\t\tif (!this.#isAvailable)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.#avatarEditor = AvatarEditor.getOrCreateInstanceById('intranet-user-profile-photo-file', {\n\t\t\tenableCamera: true,\n\t\t\tenableMask: true\n\t\t});\n\t\tthis.#avatarEditor.subscribe('onApply', ({data: {maskedBlob}}: BaseEvent) => {\n\t\t\tif (maskedBlob)\n\t\t\t{\n\t\t\t\treturn this.installMask(maskedBlob['maskId']);\n\t\t\t}\n\t\t\tthis.uninstallMask();\n\t\t});\n\n\t\tthis.#avatarEditor.subscribeOnFormIsReady('newPhoto', ({data: {form}}: BaseEvent) => {\n\t\t\tthis.emit('onChangePhoto', form);\n\t\t});\n\t\tthis.#avatarEditor.loadData(this.#avatarInfo);\n\t\treturn this.#avatarEditor;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\tif (this.#container instanceof HTMLElement)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tif (!this.#isAvailable)\n\t\t{\n\t\t\tthis.#container = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --mask\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_MASKS')}</span>\n\t\t\t\t\t\t\t<span class=\"system-auth-form__icon-help\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --center --center-force\">\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\">${Loc.getMessage('INTRANET_USER_PROFILE_INSTALL')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-new --soon\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_SOON')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.emit('onOpen');\n\t\t\t\tthis.getEditor().show('mask');\n\t\t\t};\n\t\t\tconst button = Tag.render`<div class=\"ui-qr-popupcomponentmaker__btn\" onclick=\"${onclick}\"></div>`;\n\n\t\t\tthis.#container = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --changeable --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --mask\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_MASKS')}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --center --center-force\">\n\t\t\t\t\t\t\t${button}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tthis.subscribe('onInstall', () => {\n\t\t\t\tbutton.innerHTML = Loc.getMessage('INTRANET_USER_PROFILE_CHANGE');\n\t\t\t\tDom.addClass(this.#container, '--active');\n\t\t\t});\n\t\t\tthis.subscribe('onUninstall', () => {\n\t\t\t\tbutton.innerHTML = Loc.getMessage('INTRANET_USER_PROFILE_INSTALL');\n\t\t\t\tDom.removeClass(this.#container, '--active');\n\t\t\t});\n\t\t}\n\n\t\treturn this.#container;\n\t}\n\n\tgetPromise()\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tresolve(this.getContainer());\n\t\t});\n\t}\n\n\tinstallMask(maskId: String)\n\t{\n\t\tthis.#isInstalled = true;\n\t\tthis.#avatarInfo.maskId = maskId;\n\t\tthis.emit('onInstall');\n\t}\n\n\tuninstallMask()\n\t{\n\t\tthis.#isInstalled = false;\n\t\tthis.#avatarInfo.maskId = null;\n\t\tthis.emit('onUninstall');\n\t}\n}","import {Text, Type, Tag, Loc, ajax} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Options from \"./options\";\ntype userPulseUserData = {\n\tFULL_NAME: string,\n\tAVATAR_SRC: string,\n\tID: string\n};\ntype userPulseData = {\n\tUSERS_RATING: {\n\t\tposition: number,\n\t\trange: number,\n\t\ttop: [\n\t\t\t{\n\t\t\t\tUSER_ID: string,\n\t\t\t\tACTIVITY: number\n\t\t\t}\n\t\t]\n\t},\n\tUSERS_INFO: userPulseUserData[]\n};\n\nexport default class Ustat {\n\tdata: userPulseData;\n\tconstructor(data) {\n\t\tthis.data = data;\n\t\tthis.onclickHandle = this.onclickHandle.bind(this);\n\t}\n\n\t#renderUsers()\n\t{\n\t\tconst userList = document.createDocumentFragment();\n\t\tlet myPosition = parseInt(this.data['USERS_RATING']['position']);\n\n\t\tlet myActivity = 0;\n\t\tconst usersData = Type.isPlainObject(this.data['USERS_RATING']['top'])\n\t\t\t? Object.values(this.data['USERS_RATING']['top']) : (\n\t\t\t\tType.isArray(this.data['USERS_RATING']['top']) && this.data['USERS_RATING']['top'].length > 0\n\t\t\t\t\t? [...this.data['USERS_RATING']['top']] : [{'USER_ID': Loc.getMessage('USER_ID'), ACTIVITY: 0}]);\n\t\tconst dataResult = myPosition > 5 ?\n\t\t\t[...usersData.slice(0, 3), ...usersData.slice(-1), null]\n\t\t\t: usersData\n\t\t;\n\t\tdataResult\n\t\t\t.forEach((userRating, index) => {\n\t\t\t\tif (userRating === null)\n\t\t\t\t{\n\t\t\t\t\tuserList.appendChild(Tag.render`<div class=\"system-auth-form__userlist-item --list\"></div>`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet fullName = userRating['ACTIVITY'];\n\t\t\t\tlet avatarSrc = '';\n\t\t\t\tif (this.data['USERS_INFO'][userRating['USER_ID']])\n\t\t\t\t{\n\t\t\t\t\tfullName = [this.data['USERS_INFO'][userRating['USER_ID']]['FULL_NAME'], ': ', userRating['ACTIVITY']].join('');\n\t\t\t\t\tavatarSrc = String(this.data['USERS_INFO'][userRating['USER_ID']]['AVATAR_SRC']).length > 0\n\t\t\t\t\t\t? this.data['USERS_INFO'][userRating['USER_ID']]['AVATAR_SRC'] : null;\n\t\t\t\t}\n\t\t\t\tconst isCurrentUser = String(userRating['USER_ID']) === String(Loc.getMessage('USER_ID'));\n\t\t\t\tif (isCurrentUser)\n\t\t\t\t{\n\t\t\t\t\tmyActivity = userRating['ACTIVITY'];\n\t\t\t\t}\n\t\t\t\tuserList.appendChild(\n\t\t\t\t\tTag.render`\n\t\t\t\t\t\t<div title=\"${Text.encode(fullName)}\" class=\"system-auth-form__userlist-item ui-icon ui-icon ui-icon-common-user\">\n\t\t\t\t\t\t\t<i ${avatarSrc ? `style=\"background-image: url('${encodeURI(avatarSrc)}');background-size: cover;\"` : ''}></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\t\treturn {\n\t\t\tuserList,\n\t\t\tmyPosition,\n\t\t\trange: parseInt(this.data['USERS_RATING']['range']),\n\t\t\tmyActivity\n\t\t};\n\t}\n\n\tshowData(): Element\n\t{\n\t\tconst {myPosition, userList, range} = this.#renderUsers();\n\t\tlet div;\n\t\tif (range > 0 && myPosition > 0)\n\t\t{\n\t\t\tdiv = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --clickable\" onclick=\"${this.onclickHandle}\">\n\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --without-margin\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_TITLE')}</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light --margin-s\">\n\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_RATING')}</span>\n\t\t\t\t\t\t<span class=\"system-auth-form__icon-help\" data-hint=\"${Loc.getMessage('INTRANET_USTAT_COMPANY_HELP_RATING')}\" data-hint-no-icon></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light\" data-role=\"empty-info\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_IS_EMPTY')}</div>\n\n\t\t\t\t\t<div class=\"system-auth-form__item-title --white-space --margin-xl\">\n\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_POSITION',\n\t\t\t\t{'#POSITION#': myPosition, '#AMONG#': range})}</span>\n\t\t\t\t\t\t<span class=\"system-auth-form__ustat-icon --up\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__userlist\">\n\t\t\t\t\t\t${userList}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst onclick = range > 0 ? this.onclickHandle : () => {};\n\t\t\tdiv = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --without-stat ${range > 0 ? '--clickable' : ''}\" onclick=\"${onclick}\">\n\t\t\t\t<div class=\"system-auth-form__item-container --flex --column\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_TITLE')}</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --lighter\" data-role=\"empty-info\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_IS_EMPTY_BRIEF')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\t}\n\n\t\tBX.UI.Hint.init(div);\n\t\treturn div;\n\t}\n\n\tonclickHandle(event)\n\t{\n\t\tEventEmitter.emit(Options.eventNameSpace + 'onNeedToHide');\n\t\tif (window['openIntranetUStat'])\n\t\t{\n\t\t\topenIntranetUStat(event);\n\t\t}\n\t}\n\n\tshowWideData()\n\t{\n\t\tconst {myPosition, userList, range} = this.#renderUsers();\n\t\tconst div =  Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --center --padding-ustat ${range > 0 ? '--clickable' : '--without-stat'}\">\n\t\t\t\t<div class=\"system-auth-form__item-image\">\n\t\t\t\t\t<div class=\"system-auth-form__item-image--src --ustat\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-container --overflow\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --xl --without-margin\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_TITLE')}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-container --block\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light\" data-role=\"empty-info\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_IS_EMPTY')}</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container--inline\" data-role=\"my-position\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light --without-margin --margin-right\">\n\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_RATING')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --white-space --margin-xl\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_POSITION',\n\t\t\t{'#POSITION#': myPosition, '#AMONG#': range})}</span>\n\t\t\t\t\t\t\t<span class=\"system-auth-form__ustat-icon --up\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__userlist\" data-role=\"user-list\">\n\t\t\t\t\t\t${userList}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__icon-help --absolute-right-bottom\" data-hint=\"${Loc.getMessage('INTRANET_USTAT_COMPANY_HELP_RATING')}\" data-hint-no-icon></div>\n\t\t\t</div>\n\t\t`;\n\t\tif (range > 0)\n\t\t{\n\t\t\tdiv.addEventListener('click', this.onclickHandle);\n\t\t}\n\t\treturn div;\n\t}\n\n\tstatic getPromise({userId, isNarrow, data}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t(data ?\n\t\t\t\tPromise.resolve({data}) :\n\t\t\t\tajax.runComponentAction(\n\t\t\t\t\t'bitrix:intranet.ustat.department',\n\t\t\t\t\t'getJson',\n\t\t\t\t\t{mode: 'class', data: {}}\n\t\t\t\t))\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tconst ustat = new this(data);\n\t\t\t\t\tresolve(isNarrow ? ustat.showData() : ustat.showWideData());\n\t\t\t\t})\n\t\t\t\t.catch((errors) => {\n\t\t\t\t\terrors = Type.isArray(errors) ? errors : [errors];\n\t\t\t\t\tconst node = document.createElement('ul');\n\t\t\t\t\terrors.forEach(({message}) => {\n\t\t\t\t\t\tconst errorNode = document.createElement('li');\n\t\t\t\t\t\terrorNode.innerHTML = message;\n\t\t\t\t\t\terrorNode.className = 'ui-alert-message';\n\t\t\t\t\t\tnode.appendChild(errorNode);\n\t\t\t\t\t});\n\t\t\t\t\tresolve(Tag.render`\n\t\t\t\t\t\t<div class=\"ui-alert ui-alert-danger\">\n\t\t\t\t\t\t\t${node}\n\t\t\t\t\t\t</div>`)\n\t\t\t\t});\n\n\t\t});\n\t}\n}","import { ajax, Dom, Loc, Tag } from 'main.core';\nimport { Loader } from 'main.loader';\nimport Widget from './widget';\n\nexport default class UserLoginHistory\n{\n\t#config: Object;\n\t#widget: Widget;\n\n\tconstructor(config: Object, widget: Widget)\n\t{\n\t\tthis.#config = config;\n\t\tthis.#widget = widget;\n\t}\n\n\t#isActive(): boolean\n\t{\n\t\treturn this.#config.isAvailableUserLoginHistory && this.#config.isConfiguredUserLoginHistory;\n\t}\n\n\t#isAvailable(): boolean\n\t{\n\t\treturn this.#config.isAvailableUserLoginHistory;\n\t}\n\n\t#isConfigured(): boolean\n\t{\n\t\treturn this.#config.isConfiguredUserLoginHistory;\n\t}\n\n\thandlerLogoutButton()\n\t{\n\t\tif (this.#isActive())\n\t\t{\n\t\t\tthis.#showLogoutPopup();\n\t\t}\n\t}\n\n\t#getMainButton(): ?HTMLElement\n\t{\n\t\tconst handlerLogoutButton = () => {\n\t\t\tthis.#showLogoutPopup();\n\t\t};\n\n\t\tconst showConfigureSlider = () => {\n\t\t\tthis.#widget.getPopup().close();\n\t\t\tBX.Helper.show('redirect=detail&code=16615982');\n\t\t};\n\n\t\tif (this.#isActive())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\" onclick=\\\"${handlerLogoutButton}\\\">${Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_BUTTON_LOGOUT_ALL_DEVICE')}</div>\n\t\t\t`;\n\t\t}\n\t\telse if(!this.#isConfigured())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class='system-auth-form__settings' onclick=\"${showConfigureSlider}\">${Loc.getMessage('INTRANET_USER_PROFILE_CONFIGURE')}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#getBottomButton(handler: function): ?HTMLElement\n\t{\n\t\tif (this.#isActive())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t<div class=\"system-auth-form__show-history\" onclick=\"${handler}\">\n\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_BUTTON_SHOW_FULL_LIST')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#getLockIcon(): ?HTMLElement\n\t{\n\t\tconst showInfoSlider = () => {\n\t\t\tthis.#widget.getPopup().close();\n\t\t\tBX.UI.InfoHelper.show(\"limit_office_login_history\");\n\t\t};\n\n\t\tif (!this.#isAvailable())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item-title-logo --lock\" onclick=\"${showInfoSlider}\">\n\t\t\t\t\t<i></i>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetContainer(): Element\n\t{\n\t\tconst showSliderLoginHistory = () => {\n\t\t\tif (this.#isActive())\n\t\t\t{\n\t\t\t\tthis.#widget.getPopup().close();\n\t\t\t\tBX.SidePanel.Instance.open(this.#config.url, {\n\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (!this.#isAvailable())\n\t\t\t{\n\t\t\t\tthis.#widget.getPopup().close();\n\t\t\t\tBX.UI.InfoHelper.show(\"limit_office_login_history\");\n\t\t\t}\n\t\t};\n\n\t\tlet loginHistoryWidget = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --vertical\">\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center ${this.#isActive() ? '--border' : ''}\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image ${this.#isActive() ? '--history' : '--history-gray'}\" onclick=\"${showSliderLoginHistory}\">\n\t\t\t\t\t\t\t\t<i></i>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --sm --link\" onclick=\"${showSliderLoginHistory}\">${Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_TITLE')}</div>\n\t\t\t\t\t\t\t${this.#getLockIcon()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content\">\n\t\t\t\t\t\t\t${this.#getMainButton()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__visited\">\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getBottomButton(showSliderLoginHistory)}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\tconst container = loginHistoryWidget.querySelector('.system-auth-form__visited');\n\n\t\tif (this.#isActive())\n\t\t{\n\t\t\tconst loader = UserLoginHistory.#getLoader();\n\t\t\tloader.show(container);\n\n\t\t\tajax.runComponentAction('bitrix:intranet.user.login.history', 'getListLastLogin', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tlimit: 1,\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\tconst devices = response.data;\n\t\t\t\tconst keys = Object.keys(devices);\n\t\t\t\tkeys.forEach((key) => {\n\t\t\t\t\tconst description = UserLoginHistory.#prepareDescriptionLoginHistory(devices[key]['DEVICE_PLATFORM'],\n\t\t\t\t\t\tdevices[key]['GEOLOCATION'], devices[key]['BROWSER']);\n\t\t\t\t\tconst time = UserLoginHistory.#prepareDateTimeForLoginHistory(devices[key]['LOGIN_DATE']);\n\t\t\t\t\tconst device = Tag.render`\n\t\t\t\t\t\t<div class=\"system-auth-form__visited-item\">\n\t\t\t\t\t\t\t<div data-hint='${Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_BUTTON_LOGOUT_THIS_DEVICE_DESCRIPTION')}' class=\"system-auth-form__visited-icon --${devices[key]['DEVICE_TYPE']}\" onclick=\"${showSliderLoginHistory}\" data-hint-no-icon></div>\n\t\t\t\t\t\t\t<script>\n\t\t\t\t\t\t\t\tBX.ready(() => {\n\t\t\t\t\t\t\t\t\tBX.UI.Hint.init(document.querySelector(\".system-auth-form__visited-icon --${devices[key]['DEVICE_TYPE']}\"));\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t</script>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-text\" onclick=\"${showSliderLoginHistory}\">${description}</div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-time\" onclick=\"${showSliderLoginHistory}\">${time}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\t\t\t\t\tDom.append(device, container);\n\t\t\t\t});\n\t\t\t}).catch(() => {\n\t\t\t\tloader.hide();\n\t\t\t});\n\t\t}\n\n\t\treturn loginHistoryWidget;\n\t}\n\n\t#showLogoutPopup(): void\n\t{\n\t\tBX.UI.Dialogs.MessageBox.show({\n\t\t\tmessage: Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_BUTTON_LOGOUT_ALL_DEVICE_WITHOUT_THIS_MESSAGE'),\n\t\t\ttitle: Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_BUTTON_LOGOUT_ALL_DEVICE_TITLE'),\n\t\t\tbuttons: BX.UI.Dialogs.MessageBoxButtons.YES_CANCEL,\n\t\t\tminWidth: 400,\n\t\t\tpopupOptions: {\n\t\t\t\tcontentBackground: 'transparent',\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tpadding: 0,\n\t\t\t\tbackground: '',\n\t\t\t\tevents: {\n\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\tthis.#widget.getPopup().getPopup().setAutoHide(false);\n\t\t\t\t\t},\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.#widget.getPopup().getPopup().setAutoHide(true);\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tonYes: (messageBox) => {\n\t\t\t\tajax.runComponentAction('bitrix:intranet.user.profile.password', 'logout', {\n\t\t\t\t\tmode: 'ajax',\n\t\t\t\t}).then(() => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_BUTTON_LOGOUT_ALL_DEVICE_WITHOUT_THIS_RESULT'),\n\t\t\t\t\t\tautoHideDelay: 1800,\n\t\t\t\t\t});\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_BUTTON_LOGOUT_ALL_DEVICE_ERROR'),\n\t\t\t\t\t\tautoHideDelay: 3600,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\tstatic #prepareDescriptionLoginHistory(deviceType: string, geolocation: string, browser: string): string\n\t{\n\t\tconst arrayDescription = [];\n\n\t\tif(browser)\n\t\t{\n\t\t\tarrayDescription.push(browser);\n\t\t}\n\n\t\tif(geolocation)\n\t\t{\n\t\t\tarrayDescription.push(geolocation);\n\t\t}\n\n\t\tif(deviceType)\n\t\t{\n\t\t\tarrayDescription.push(deviceType);\n\t\t}\n\n\t\treturn arrayDescription.join(', ');\n\t}\n\n\tstatic #getLoader(): Loader\n\t{\n\t\treturn new Loader({\n\t\t\tsize: 20,\n\t\t\tmode: 'inline',\n\t\t});\n\t}\n\n\tstatic #prepareDateTimeForLoginHistory(dateTime: string): string\n\t{\n\t\tconst format = [\n\t\t\t['-', 'd.m.Y H:i:s'],\n\t\t\t['s', 'sago'],\n\t\t\t['i', 'iago'],\n\t\t\t['H', 'Hago'],\n\t\t\t['d', 'dago'],\n\t\t\t['m', 'mago'],\n\t\t];\n\t\treturn ' - ' + BX.date.format(format, new Date(dateTime), new Date());\n\t}\n}","import { Uri, Type, Tag, Cache, Loc, Browser, Text, Dom, ajax } from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupComponentsMaker} from 'ui.popupcomponentsmaker';\nimport {StressLevel} from './stress-level';\nimport ThemePicker from './theme-picker';\nimport {Menu} from 'main.popup';\nimport 'main.qrcode';\nimport Options from \"./options\";\nimport MaskEditor from \"./mask-editor\";\nimport Ustat from \"./ustat\";\nimport UserLoginHistory from './user-login-history';\nimport {QrAuthorization} from \"ui.qrauthorization\";\nimport { Loader } from 'main.loader';\n\nconst widgetMarker = Symbol('user.widget');\nexport default class Widget extends EventEmitter\n{\n\t#container: Element;\n\t#popup: ?PopupComponentsMaker;\n\t#profile = null;\n\t#features = {};\n\t#cache = new Cache.MemoryCache();\n\n\n\tconstructor(container, {\n\t\tprofile: {ID, FULL_NAME, PHOTO, MASK, STATUS, URL, WORK_POSITION},\n\t\tcomponent: {componentName, signedParameters},\n\t\tfeatures\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace(Options.eventNameSpace);\n\t\tthis.#container = container;\n\t\tthis.#profile = {ID, FULL_NAME, PHOTO, MASK, STATUS, URL, WORK_POSITION};\n\t\tthis.#features = features;\n\t\tif (!Type.isStringFilled(this.#features.browser))\n\t\t{\n\t\t\tthis.#features.browser =\n\t\t\t\t(Browser.isLinux() ? 'Linux'\n\t\t\t\t: (Browser.isWin() ? 'Windows' : 'MacOs')\n\t\t\t\t)\n\t\t\t;\n\t\t}\n\n\t\tthis.#cache.set('componentParams', {componentName, signedParameters});\n\t\tthis.hide = this.hide.bind(this);\n\t}\n\n\ttoggle()\n\t{\n\t\tif (this.getPopup().isShown())\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tshow()\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\tgetPopup(): PopupComponentsMaker\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\treturn this.#popup;\n\t\t}\n\t\tlet content = [\n\t\t\tthis.#getProfileContainer(),\n\t\t\t(this.#getb24NetPanelContainer() ? {\n\t\t\t\thtml: this.#getb24NetPanelContainer(),\n\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t} : null),\n\t\t\t(this.#getAdminPanelContainer() ? {\n\t\t\t\thtml: this.#getAdminPanelContainer(),\n\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t} : null),\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getThemeContainer(),\n\t\t\t\t\tmarginBottom: 24,\n\t\t\t\t\toverflow: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getMaskContainer(),\n\t\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t\t}\n\t\t\t],\n\t\t\tthis.#getCompanyPulse(!!this.#getStressLevel()) ?\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getCompanyPulse(!!this.#getStressLevel()),\n\t\t\t\t\toverflow: true,\n\t\t\t\t\tmarginBottom: 24,\n\t\t\t\t\tflex: this.#getStressLevel() ? 0.5 : 1\n\t\t\t\t},\n\t\t\t\tthis.#getStressLevel(),\n\t\t\t] : null,\n\t\t\tthis.#getOTPContainer(this.#getDeskTopContainer() === null) && this.#getDeskTopContainer() ?\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tflex: 0.5,\n\t\t\t\t\thtml: this.#getQrContainer(0.7)\n\t\t\t\t},\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\thtml: this.#getDeskTopContainer(),\n\t\t\t\t\t\tdisplayBlock: true\n\t\t\t\t\t},\n\t\t\t\t\tthis.#getOTPContainer()\n\t\t\t\t]\n\t\t\t] : this.#getDeskTopContainer() || this.#getOTPContainer() ? [\n\t\t\t\t\t{\n\t\t\t\t\t\thtml: this.#getQrContainer(2),\n\t\t\t\t\t\tflex: 2\n\t\t\t\t\t},\n\t\t\t\t\tthis.#getDeskTopContainer() ?? this.#getOTPContainer()\n\t\t\t] : this.#getQrContainer(0),\n\t\t\tthis.#getLoginHistoryContainer(),\n\t\t\t{\n\t\t\t\thtml: this.#getBindings(),\n\t\t\t\tmarginBottom: 24,\n\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t},\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getNotificationContainer() ?? null,\n\t\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getLogoutContainer(),\n\t\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t\t}\n\t\t\t]\n\t\t];\n\n\t\tconst filterFunc = (data): ?Array => {\n\t\t\tconst result = [];\n\t\t\tif (Type.isArray(data))\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < data.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isArray(data[i]))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst buff = filterFunc(data[i]);\n\t\t\t\t\t\tif (buff !== null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (Type.isArray(buff) && buff.length === 1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresult.push(buff[0]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresult.push(buff);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (data[i] !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(data[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result.length <= 0 ? null : (\n\t\t\t\tresult.length === 1 ? result[0] : result\n\t\t\t)\n\t\t};\n\t\tcontent = filterFunc(content);\n\n\t\tconst prepareFunc = (item, index, array) => {\n\t\t\tif (Type.isArray(item))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\thtml:  item.map(prepareFunc)\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tflex: item['flex'] || 0,\n\t\t\t\thtml: item['html'] || item,\n\t\t\t\tbackgroundColor: item['backgroundColor'] || null,\n\t\t\t\tdisabled: item['disabled'] || null,\n\t\t\t\toverflow: item['overflow'] || null,\n\t\t\t\tmarginBottom: item['marginBottom'] || null,\n\t\t\t\tdisplayBlock: item['displayBlock'] || null\n\t\t\t};\n\t\t}\n\t\tthis.#popup = new PopupComponentsMaker({\n\t\t\ttarget: this.#container,\n\t\t\tcontent: content.map(prepareFunc),\n\t\t\twidth: 400,\n\t\t});\n\t\tEventEmitter.subscribe('BX.Main.InterfaceButtons:onMenuShow', this.hide);\n\t\tEventEmitter.subscribe(Options.eventNameSpace + 'onNeedToHide', this.hide);\n\t\treturn this.#popup;\n\t}\n\n\t#getProfileContainer(): Element\n\t{\n\t\treturn this.#cache.remember('profile', () => {\n\t\t\tconst onclick = (event) => {\n\t\t\t\tthis.hide();\n\t\t\t\treturn BX.SidePanel.Instance.open(this.#profile.URL);\n\t\t\t};\n\t\t\tconst avatarNode = Tag.render`\n\t\t\t\t<span class=\"system-auth-form__profile-avatar--image\"\n\t\t\t\t\t${this.#profile.PHOTO ? `\n\t\t\t\t\t\tstyle=\"background-size: cover; background-image: url('${encodeURI(this.#profile.PHOTO)}')\"` : ''}>\n\t\t\t\t</span>\n\t\t\t\t`;\n\t\t\tconst nameNode = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__profile-name\">${Text.encode(this.#profile.FULL_NAME)}</div>\n\t\t\t`;\n\t\t\tEventEmitter.subscribe(\n\t\t\t\tEventEmitter.GLOBAL_TARGET,\n\t\t\t\t'BX.Intranet.UserProfile:Avatar:changed',\n\t\t\t\t({data: [{url, userId}]}) => {\n\t\t\t\t\tif (this.#profile.ID > 0 && userId && this.#profile.ID.toString() === userId.toString())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#profile.PHOTO = url;\n\t\t\t\t\t\tavatarNode.style = Type.isStringFilled(url)\n\t\t\t\t\t\t\t? `background-size: cover; background-image: url('${encodeURI(this.#profile.PHOTO)}')`\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t\tEventEmitter.subscribe(\n\t\t\t\tEventEmitter.GLOBAL_TARGET,\n\t\t\t\t'BX.Intranet.UserProfile:Name:changed',\n\t\t\t\t({data: [{fullName}]}) => {\n\t\t\t\t\tthis.#profile.FULL_NAME = fullName;\n\t\t\t\t\tnameNode.innerHTML = fullName;\n\t\t\t\t\tthis.#container.querySelector('#user-name').innerHTML = fullName;\n\t\t\t\t})\n\t\t\t;\n\t\t\tlet workPosition = (Type.isStringFilled(this.#profile.WORK_POSITION) ? Text.encode(this.#profile.WORK_POSITION) : '');\n\t\t\tif (this.#profile.STATUS && Loc.hasMessage('INTRANET_USER_PROFILE_' + this.#profile.STATUS))\n\t\t\t{\n\t\t\t\tworkPosition = Loc.getMessage('INTRANET_USER_PROFILE_' + this.#profile.STATUS)\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --clickable\" onclick=\"${onclick}\">\n\t\t\t\t\t<div class=\"system-auth-form__profile\">\n\t\t\t\t\t\t<div class=\"system-auth-form__profile-avatar\">\n\t\t\t\t\t\t\t${avatarNode}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__profile-content --margin--right\">\n\t\t\t\t\t\t\t${nameNode}\n\t\t\t\t\t\t\t<div class=\"system-auth-form__profile-position\">${workPosition}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__profile-controls\">\n\t\t\t\t\t\t\t<span class=\"ui-qr-popupcomponentmaker__btn --large --border\" >\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_PROFILE')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t \t\t<!-- <span class=\"ui-qr-popupcomponentmaker__btn --large --success\">any text</span> -->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getb24NetPanelContainer()\n\t{\n\t\treturn this.#cache.remember('b24netPanel', () => {\n\t\t\tif (this.#features['b24netPanel'] !== 'Y')\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<a class=\"system-auth-form__item system-auth-form__scope --center --padding-sm --clickable\" href=\"https://www.bitrix24.net/\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --network\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('AUTH_PROFILE_B24NET')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --block\">\n\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\">${Loc.getMessage('INTRANET_USER_PROFILE_GOTO')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getAdminPanelContainer()\n\t{\n\t\treturn this.#cache.remember('adminPanel', () => {\n\t\t\tif (this.#features['adminPanel'] !== 'Y')\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<a class=\"system-auth-form__item system-auth-form__scope --center --padding-sm --clickable\" href=\"/bitrix/admin/\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --admin-panel\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('INTRANET_USER_PROFILE_ADMIN_PANEL')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --block\">\n\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\">${Loc.getMessage('INTRANET_USER_PROFILE_GOTO')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getThemeContainer(): Element\n\t{\n\t\treturn this.#cache.remember('themePicker', () => {\n\t\t\tif (this.#features['themePicker'] === null)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst themePicker = new ThemePicker(this.#features['themePicker']);\n\t\t\tthemePicker.subscribe('onOpen', this.hide);\n\t\t\treturn themePicker.getPromise();\n\t\t});\n\t}\n\n\t#getMaskContainer(): Element\n\t{\n\t\treturn this.#cache.remember('Mask', () => {\n\t\t\tconst maskEditor = new MaskEditor(this.#profile.MASK);\n\t\t\tmaskEditor.subscribe('onOpen', this.hide);\n\t\t\tmaskEditor.subscribe('onChangePhoto', ({data}) => {\n\t\t\t\tthis.#savePhoto(data)\n\t\t\t});\n\t\t\tthis.emit('onChangePhoto')\n\t\t\treturn maskEditor.getPromise();\n\t\t});\n\t}\n\n\t#getCompanyPulse(isNarrow): Element\n\t{\n\t\treturn this.#cache.remember('getCompanyPulse', () => {\n\t\t\tif (this.#features.pulse === 'Y'\n\t\t\t\t&& this.#profile.ID > 0\n\t\t\t\t&& this.#profile.ID === Loc.getMessage('USER_ID')\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn Ustat.getPromise({\n\t\t\t\t\tuserId: this.#profile.ID,\n\t\t\t\t\tisNarrow,\n\t\t\t\t\tdata: this.#features['pulseData'] ?? null\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\t}\n\n\t#savePhoto(dataObj)\n\t{\n\t\tajax.runComponentAction(\n\t\t\tthis.#cache.get('componentParams').componentName,\n\t\t\t'loadPhoto',\n\t\t\t{\n\t\t\t\tsignedParameters: this.#cache.get('componentParams').signedParameters,\n\t\t\t\tmode: 'ajax',\n\t\t\t\tdata: dataObj\n\t\t\t}\n\t\t).then(function (response) {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\t(top || window).BX.onCustomEvent('BX.Intranet.UserProfile:Avatar:changed', [{\n\t\t\t\t\turl: response.data,\n\t\t\t\t\tuserId: this.#profile.ID,\n\t\t\t\t}]);\n\t\t\t}\n\t\t}.bind(this), function (response) {\n\t\t\tconsole.log('response: ', response);\n\t\t}.bind(this));\n\t}\n\n\t#getStressLevel(): Promise\n\t{\n\t\tif (this.#features['stressLevel'] !== 'Y')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn this.#cache.remember('getStressLevel', () => {\n\t\t\treturn StressLevel.getPromise({\n\t\t\t\tsignedParameters: this.#cache.get('componentParams').signedParameters,\n\t\t\t\tcomponentName: this.#cache.get('componentParams').componentName,\n\t\t\t\tuserId: this.#profile.ID,\n\t\t\t\tdata: this.#features['stressLevelData'] ?? null\n\t\t\t});\n\t\t});\n\t}\n\n\t#getQrContainer(flex): Element\n\t{\n\t\treturn this.#cache.remember('getQrContainer', () => {\n\t\t\tconst isInstalled = this.#features['appInstalled']['APP_ANDROID_INSTALLED'] === 'Y'\n\t\t\t\t|| this.#features['appInstalled']['APP_IOS_INSTALLED'] === 'Y';\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.hide();\n\t\t\t\t(new QrAuthorization({\n\t\t\t\t\ttitle: Loc.getMessage('INTRANET_USER_PROFILE_QRCODE_TITLE2'),\n\t\t\t\t\tcontent: Loc.getMessage('INTRANET_USER_PROFILE_QRCODE_BODY2'),\n\t\t\t\t\thelpLink: ''\n\t\t\t\t})).show();\n\t\t\t}\n\t\t\tconst onclickHelp = (event: MouseEvent) => {\n\t\t\t\ttop.BX.Helper.show('redirect=detail&code=14999860');\n\t\t\t\tthis.hide();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tlet node;\n\t\t\tif (flex !== 2 && flex !== 0)\n\t\t\t{\n\t\t\t\t// for a small size\n\t\t\t\tnode = Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope ${isInstalled ? '--active' : ''}  --clickable\" onclick=\"${onclick}\" style=\"padding: 10px 14px\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --center --column --center\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --center --margin-xl\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_TITLE2_SMALL')}</div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__qr\" style=\"margin-bottom: 12px\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn --border\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_SHOW_QR_SMALL')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__icon-help --absolute\" onclick=\"${onclickHelp}\" title=\"${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_HOW_DOES_IT_WORK')}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse if (flex === 0)\n\t\t\t{\n\t\t\t\t//full size\n\t\t\t\tnode = Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope ${isInstalled ? '--active' : ''} --padding-qr-xl\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --column --flex --flex-start\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --l\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_TITLE2')}</div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\" onclick=\"${onclickHelp}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_HOW_DOES_IT_WORK')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn --large --border\" style=\"margin-top: auto\" onclick=\"${onclick}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_SHOW_QR')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --qr\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__qr --full-size\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// for flex 2. It is kind of middle\n\t\t\t\tnode = Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope ${isInstalled ? '--active' : ''} --padding-mid-qr  --clickable\" onclick=\"${onclick}\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --column --flex --flex-start\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --block\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_TITLE2_SMALL')}\n\t\t\t\t\t\t\t\t<span class=\"system-auth-form__icon-help --inline\" onclick=\"${onclickHelp}\" title=\"${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_HOW_DOES_IT_WORK')}\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn --border\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_SHOW_QR')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --qr\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__qr --size-2\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\treturn node;\n\t\t});\n\t}\n\n\t#getDeskTopContainer(): ?Element\n\t{\n\t\treturn this.#cache.remember('getDeskTopContainer', () => {\n\t\t\tlet isInstalled = this.#features['appInstalled']['APP_MAC_INSTALLED'] === 'Y';\n\t\t\tlet cssPostfix = '--apple';\n\t\t\tlet title = Loc.getMessage('INTRANET_USER_PROFILE_DESKTOP_APPLE');\n\t\t\tlet linkToDistributive = 'https://dl.bitrix24.com/b24/bitrix24_desktop.dmg';\n\t\t\tconst typesInstallersForLinux = {\n\t\t\t\t'DEB': {\n\t\t\t\t\ttext: Loc.getMessage('INTRANET_USER_PROFILE_DOWNLOAD_LINUX_DEB'),\n\t\t\t\t\thref: 'https://dl.bitrix24.com/b24/bitrix24_desktop.deb',\n\t\t\t\t},\n\t\t\t\t'RPM': {\n\t\t\t\t\ttext: Loc.getMessage('INTRANET_USER_PROFILE_DOWNLOAD_LINUX_RPM'),\n\t\t\t\t\thref: 'https://dl.bitrix24.com/b24/bitrix24_desktop.rpm',\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tif (this.#features.browser === 'Windows')\n\t\t\t{\n\t\t\t\tisInstalled = this.#features['appInstalled']['APP_WINDOWS_INSTALLED'] === 'Y';\n\t\t\t\tcssPostfix = '--windows';\n\t\t\t\ttitle = Loc.getMessage('INTRANET_USER_PROFILE_DESKTOP_WINDOWS');\n\t\t\t\tlinkToDistributive = 'https://dl.bitrix24.com/b24/bitrix24_desktop.exe'\n\t\t\t}\n\n\t\t\tlet onclick = isInstalled ? (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t} : () => {\n\t\t\t\tthis.hide();\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\tlet menuLinux = null;\n\t\t\tconst showMenuLinux = (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tmenuLinux = (menuLinux || new Menu({\n\t\t\t\t\tclassName: 'system-auth-form__popup',\n\t\t\t\t\tbindElement: event.target,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: typesInstallersForLinux.DEB.text,\n\t\t\t\t\t\t\thref: typesInstallersForLinux.DEB.href,\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tmenuLinux.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: typesInstallersForLinux.RPM.text,\n\t\t\t\t\t\t\thref: typesInstallersForLinux.RPM.href,\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tmenuLinux.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\n\t\t\t\t\t],\n\t\t\t\t\tangle: true,\n\t\t\t\t\toffsetLeft: 10,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(false);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t\tmenuLinux.toggle();\n\t\t\t}\n\n\t\t\tif (this.#features.browser === 'Linux')\n\t\t\t{\n\t\t\t\tisInstalled = this.#features['appInstalled']['APP_LINUX_INSTALLED'] === 'Y';\n\t\t\t\tcssPostfix = '--linux';\n\t\t\t\ttitle = Loc.getMessage('INTRANET_USER_PROFILE_DESKTOP_LINUX');\n\t\t\t\tlinkToDistributive = '';\n\n\t\t\t\tonclick = isInstalled ? (event) => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t} : showMenuLinux;\n\t\t\t}\n\n\t\t\tif (Type.isPlainObject(this.#features['otp']) === false)\n\t\t\t{\n\t\t\t\tlet menuPopup = null;\n\t\t\t\tlet menuItems = [{\n\t\t\t\t\ttext: Loc.getMessage('INTRANET_USER_PROFILE_DOWNLOAD'),\n\t\t\t\t\thref: linkToDistributive,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tmenuPopup.close();\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t}\n\t\t\t\t}];\n\n\t\t\t\tif (this.#features.browser === 'Linux')\n\t\t\t\t{\n\t\t\t\t\tmenuItems = [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: typesInstallersForLinux.DEB.text,\n\t\t\t\t\t\t\thref: typesInstallersForLinux.DEB.href,\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tmenuPopup.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: typesInstallersForLinux.RPM.text,\n\t\t\t\t\t\t\thref: typesInstallersForLinux.RPM.href,\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tmenuPopup.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\tconst popupClick = (event: MouseEvent) => {\n\t\t\t\t\tmenuPopup = (menuPopup || (new Menu({\n\t\t\t\t\t\tclassName: 'system-auth-form__popup',\n\t\t\t\t\t\tbindElement: event.target,\n\t\t\t\t\t\titems: menuItems,\n\t\t\t\t\t\tangle: true,\n\t\t\t\t\t\toffsetLeft: 10,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(false);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})));\n\t\t\t\t\tmenuPopup.toggle();\n\t\t\t\t};\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div data-role=\"desktop-item\" class=\"system-auth-form__item system-auth-form__scope --padding-sm-all ${isInstalled ? ' --active' : ''} --vertical --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo --margin-bottom --center system-auth-form__item-container --flex\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image ${cssPostfix}\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${isInstalled ? Tag.render`<div class=\"system-auth-form__config --absolute\" onclick=\"${popupClick}\"></div>` : ''}\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --flex --center --display-flex\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light --center --s\">${title}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --flex --center --display-flex\">\n\t\t\t\t\t\t\t<a class=\"ui-qr-popupcomponentmaker__btn\" style=\"margin-top: auto\" href=\"${linkToDistributive}\" target=\"_blank\" onclick=\"${onclick}\">\n\t\t\t\t\t\t\t\t${isInstalled ? Loc.getMessage('INTRANET_USER_PROFILE_INSTALLED') : Loc.getMessage('INTRANET_USER_PROFILE_INSTALL')}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\tconst getLinkForHiddenState = () => {\n\t\t\t\tconst link = Tag.render`\n\t\t\t\t\t<a href=\"${linkToDistributive}\" class=\"system-auth-form__item-title --link-dotted\">${Loc.getMessage('INTRANET_USER_PROFILE_DOWNLOAD')}</a>\n\t\t\t\t`;\n\n\t\t\t\tif (this.#features.browser === 'Linux')\n\t\t\t\t{\n\t\t\t\t\tlink.addEventListener('click', showMenuLinux);\n\t\t\t\t}\n\n\t\t\t\treturn link;\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-bottom-10 ${isInstalled ? ' --active' : ''}\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image ${cssPostfix}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title ${isInstalled ? ' --without-margin' : '--min-height'}\">${title}</div>\n\t\t\t\t\t\t${isInstalled ? getLinkForHiddenState() : ''}\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --center --center-force\">\n\t\t\t\t\t\t\t<a class=\"ui-qr-popupcomponentmaker__btn\" href=\"${linkToDistributive}\" target=\"_blank\" onclick=\"${onclick}\">\n\t\t\t\t\t\t\t\t${isInstalled ? Loc.getMessage('INTRANET_USER_PROFILE_INSTALLED') : Loc.getMessage('INTRANET_USER_PROFILE_INSTALL')}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getOTPContainer(single): Element\n\t{\n\t\tif (Type.isPlainObject(this.#features['otp']) === false)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#cache.remember('getOTPContainer', () => {\n\t\t\tconst isInstalled = this.#features['otp']['IS_ACTIVE'] === 'Y' || this.#features['otp']['IS_ACTIVE'] === true;\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.hide();\n\t\t\t\tif (String(this.#features['otp']['URL']).length > 0)\n\t\t\t\t{\n\t\t\t\t\tUri.addParam(this.#features['otp']['URL'], {page: 'otpConnected'});\n\t\t\t\t\tBX.SidePanel.Instance.open(Uri.addParam(this.#features['otp']['URL'], {page: 'otpConnected'}), {width: 1100});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.error('Otp page is not defined. Check the component params');\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst button = isInstalled ?\n\t\t\t\tTag.render`<div class=\"ui-qr-popupcomponentmaker__btn\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_TURNED_ON')}</div>`\n\t\t\t\t:\n\t\t\t\tTag.render`<div class=\"ui-qr-popupcomponentmaker__btn\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_TURN_ON')}</div>`;\n\t\t\tconst onclickHelp = () => {\n\t\t\t\ttop.BX.Helper.show('redirect=detail&code=6641271');\n\t\t\t\tthis.hide();\n\t\t\t};\n\t\t\tif (single !== true)\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-bottom-10 ${isInstalled ? ' --active' : ''}\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --authentication\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --flex --column --flex-start\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --without-margin --block\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_OTP_MESSAGE')}&nbsp;<span class=\"system-auth-form__icon-help --inline\" onclick=\"${onclickHelp}\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${isInstalled ?\n\t\t\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_CONFIGURE')}</div>\n\t\t\t\t\t\t\t\t` : ''\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-content --margin-top-auto --center --center-force\">\n\t\t\t\t\t\t\t\t${button}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${isInstalled ? '' : `\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-new\">\n\t\t\t\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_OTP_TITLE')}</div>\n\t\t\t\t\t\t\t</div>`\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\tlet menuPopup = null;\n\t\t\tconst popupClick = (event: MouseEvent) => {\n\t\t\t\tmenuPopup = (menuPopup || (new Menu({\n\t\t\t\t\tclassName: 'system-auth-form__popup',\n\t\t\t\t\tbindElement: event.target,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: Loc.getMessage('INTRANET_USER_PROFILE_CONFIGURE'),\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tmenuPopup.close();\n\t\t\t\t\t\t\t\tonclick();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tangle: true,\n\t\t\t\t\toffsetLeft: 10,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(false);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})));\n\t\t\t\tmenuPopup.toggle();\n\t\t\t};\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-sm-all ${isInstalled ? ' --active' : ''} --vertical --center\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo --margin-bottom --center system-auth-form__item-container --flex\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --authentication\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --flex\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light --center --s\">\n\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_OTP_MESSAGE')}\n\t\t\t\t\t\t\t<!-- <span class=\"system-auth-form__icon-help\" onclick=\"${onclickHelp}\"></span> -->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${isInstalled ? Tag.render`<div class=\"system-auth-form__config --absolute\" onclick=\"${popupClick}\"></div>` : ''}\n\t\t\t\t\t<div class=\"system-auth-form__item-container --flex --column --space-around\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --flex --display-flex\">\n\t\t\t\t\t\t\t${button}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${isInstalled ? '' : `\n\t\t\t\t\t\t<div class=\"system-auth-form__item-new system-auth-form__item-new-icon --ssl\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_OTP_TITLE')}</div>\n\t\t\t\t\t\t</div>`\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getLoginHistoryContainer(): ?Element\n\t{\n\t\tif (this.#features.loginHistory.isHide)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#cache.remember('getLoginHistoryContainer', () => {\n\t\t\tconst history = new UserLoginHistory(this.#features.loginHistory, this);\n\t\t\treturn {\n\t\t\t\thtml: history.getContainer(),\n\t\t\t\tbackgroundColor: '#fafafa',\n\t\t\t};\n\t\t});\n\t}\n\n\t#getBindings(): ?Element\n\t{\n\t\tif (!(Type.isPlainObject(this.#features['bindings'])\n\t\t\t&& Type.isStringFilled(this.#features['bindings']['text'])\n\t\t\t&& Type.isArray(this.#features['bindings']['items'])\n\t\t\t&& this.#features['bindings']['items'].length > 0\n\t\t))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#cache.remember('getBindingsContainer', () => {\n\t\t\tconst div = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item --hover system-auth-form__scope --center --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --binding\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Text.encode(this.#features['bindings']['text'])}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div data-role=\"arrow\" class=\"system-auth-form__item-icon --arrow-right\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tdiv.addEventListener('click', () => {\n\t\t\t\tthis.__bindingsMenu = (this.__bindingsMenu || (new Menu({\n\t\t\t\t\tclassName: 'system-auth-form__popup',\n\t\t\t\t\tbindElement: div.querySelector('[data-role=\"arrow\"]'),\n\t\t\t\t\titems: this.#features['bindings']['items'],\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcachable: false,\n\t\t\t\t\toffsetLeft: 10,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(false);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(true);\n\t\t\t\t\t\t\tif (this.__bindingsMenu.isNeedToHide !== false)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})));\n\t\t\t\tthis.__bindingsMenu.isNeedToHide = false;\n\t\t\t\tthis.__bindingsMenu.toggle();\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.__bindingsMenu.isNeedToHide = true;\n\t\t\t\t}, 0);\n\t\t\t});\n\t\t\treturn div;\n\t\t});\n\t}\n\n\t#getNotificationContainer(): Element\n\t{\n\t\tif (this.#features['im'] !== 'Y')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn this.#cache.remember('getNotificationContainer', () => {\n\t\t\tconst div = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item --hover system-auth-form__scope --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --notification\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('AUTH_NOTIFICATION')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tdiv.addEventListener('click', () => {\n\t\t\t\tthis.hide();\n\t\t\t\tBXIM.openSettings({'onlyPanel':'notify'});\n\t\t\t});\n\t\t\treturn div;\n\t\t});\n\t}\n\n\t#getLogoutContainer(): Element\n\t{\n\t\treturn this.#cache.remember('getLogoutContainer', () => {\n\t\t\tconst backUrl = new Uri(window.location.pathname);\n\t\t\tbackUrl.removeQueryParam(['logout', 'login', 'back_url_pub', 'user_lang']);\n\t\t\tconst newUrl =  new Uri('/auth/?logout=yes');\n\t\t\tnewUrl.setQueryParam('sessid', BX.bitrix_sessid());\n\t\t\tnewUrl.setQueryParam('backurl', encodeURIComponent(backUrl.toString()));\n\t\t\t//TODO\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --logout\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('AUTH_LOGOUT')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<a href=\"${newUrl.toString()}\" class=\"system-auth-form__item-link-all\"></a>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tstatic init(node, options)\n\t{\n\t\tif (node[widgetMarker])\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst onclick = () => {\n\t\t\tif (!node['popupSymbol'])\n\t\t\t{\n\t\t\t\tnode['popupSymbol'] = new this(node, options);\n\t\t\t}\n\t\t\tnode['popupSymbol'].toggle();\n\t\t\tthis.instance = node['popupSymbol'];\n\t\t};\n\t\tnode[widgetMarker] = true;\n\t\tnode.addEventListener('click', onclick);\n\t\tsetTimeout(onclick, 100);\n\t}\n\n\tstatic instance = null;\n\n\tstatic getInstance():? this\n\t{\n\t\treturn this.instance;\n\t}\n}"],"names":["Options","StressLevel","url","Type","isStringFilled","EventEmitter","emit","GLOBAL_TARGET","eventNameSpace","BX","SidePanel","Instance","open","cacheable","data","width","value","parseInt","result","Tag","render","Loc","getMessage","Text","encode","type","typeDescription","getOpenSliderFunction","check","comment","setTimeout","intervalId","setInterval","current","node","innerHTML","end","clearInterval","querySelector","style","transform","signedParameters","componentName","userId","Promise","resolve","reject","promise","ajax","runAction","c","fields","then","id","undefined","showData","showEmpty","document","createElement","error","urls","ThemePicker","Object","assign","lightning","String","indexOf","applyTheme","bind","setEventNamespace","subscribe","theme","title","previewImage","previewColor","container","getContainer","removeProperty","backgroundImage","backgroundSize","background","backgroundColor","Dom","removeClass","addClass","onclick","Intranet","Bitrix24","Singleton","showDialog","MaskEditor","_classPrivateFieldInitSpec","scr","maskId","isPlainObject","src","installMask","uninstallMask","AvatarEditor","getOrCreateInstanceById","enableCamera","enableMask","maskedBlob","subscribeOnFormIsReady","form","loadData","HTMLElement","getEditor","show","button","Ustat","onclickHandle","myPosition","userList","range","div","UI","Hint","init","event","window","openIntranetUStat","addEventListener","isNarrow","runComponentAction","mode","ustat","showWideData","errors","isArray","forEach","message","errorNode","className","appendChild","createDocumentFragment","myActivity","usersData","values","length","ACTIVITY","dataResult","slice","userRating","index","fullName","avatarSrc","join","isCurrentUser","encodeURI","UserLoginHistory","config","widget","_classPrivateMethodInitSpec","_classPrivateMethodGet","showSliderLoginHistory","getPopup","close","allowChangeHistory","InfoHelper","loginHistoryWidget","loader","limit","response","hide","devices","keys","key","description","time","device","append","isAvailableUserLoginHistory","isConfiguredUserLoginHistory","handlerLogoutButton","showConfigureSlider","Helper","handler","showInfoSlider","Dialogs","MessageBox","buttons","MessageBoxButtons","YES_CANCEL","minWidth","popupOptions","contentBackground","autoHide","closeByEsc","padding","events","onShow","setAutoHide","onPopupClose","onYes","messageBox","Notification","Center","notify","content","autoHideDelay","deviceType","geolocation","browser","arrayDescription","push","Loader","size","dateTime","format","date","Date","widgetMarker","Symbol","Widget","profile","ID","FULL_NAME","PHOTO","MASK","STATUS","URL","WORK_POSITION","component","features","Cache","MemoryCache","Browser","isLinux","isWin","set","isShown","html","marginBottom","overflow","flex","displayBlock","filterFunc","i","buff","prepareFunc","item","array","map","disabled","PopupComponentsMaker","target","options","toggle","instance","remember","avatarNode","nameNode","toString","workPosition","hasMessage","themePicker","getPromise","maskEditor","pulse","dataObj","get","top","onCustomEvent","console","log","isInstalled","QrAuthorization","helpLink","onclickHelp","preventDefault","stopPropagation","cssPostfix","linkToDistributive","typesInstallersForLinux","text","href","menuLinux","showMenuLinux","Menu","bindElement","items","DEB","RPM","angle","offsetLeft","onClose","menuPopup","menuItems","popupClick","getLinkForHiddenState","link","single","Uri","addParam","page","loginHistory","isHide","history","__bindingsMenu","cachable","isNeedToHide","BXIM","openSettings","backUrl","location","pathname","removeQueryParam","newUrl","setQueryParam","bitrix_sessid","encodeURIComponent"],"mappings":"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"}