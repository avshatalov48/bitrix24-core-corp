{"version":3,"file":"script.js","sources":["src/tasks-ai-promo.js"],"sourcesContent":["import { AnglePosition, PromoVideoPopup, PromoVideoPopupEvents } from 'ui.promo-video-popup';\nimport { CopilotPromoPopup } from 'ai.copilot-promo-popup';\nimport { ajax } from 'main.core';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\n\ntype Params = {\n\tpromotionType: string,\n};\n\nexport class TasksAiPromo\n{\n\t#params: Params;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\t}\n\n\tshow()\n\t{\n\t\tBannerDispatcher.normal.toQueue((onDone) => {\n\t\t\tconst promoPopup = this.#getPopup();\n\n\t\t\tif (!promoPopup)\n\t\t\t{\n\t\t\t\tonDone();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpromoPopup.subscribe(PromoVideoPopupEvents.HIDE, this.onCopilotPromoHide.bind(this, onDone));\n\t\t\tpromoPopup.show();\n\t\t});\n\t}\n\n\t#getPopup(): ?PromoVideoPopup\n\t{\n\t\tconst copilotButton = document.querySelector('#mpf-copilot-task-form');\n\n\t\tif (!copilotButton)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn CopilotPromoPopup.createByPresetId({\n\t\t\tpresetId: CopilotPromoPopup.Preset.TASK,\n\t\t\ttargetOptions: copilotButton,\n\t\t\toffset: {\n\t\t\t\tleft: 85,\n\t\t\t\ttop: -150,\n\t\t\t},\n\t\t\tangleOptions: {\n\t\t\t\tposition: AnglePosition.LEFT,\n\t\t\t\toffset: 122,\n\t\t\t},\n\t\t});\n\t}\n\n\tonCopilotPromoHide(onDone: Function)\n\t{\n\t\tajax.runAction('tasks.promotion.setViewed', { data: { promotion: this.#params.promotionType } })\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.error(err);\n\t\t\t})\n\t\t;\n\n\t\tonDone();\n\t}\n}\n"],"names":["TasksAiPromo","constructor","params","show","BannerDispatcher","normal","toQueue","onDone","promoPopup","subscribe","PromoVideoPopupEvents","HIDE","onCopilotPromoHide","bind","ajax","runAction","data","promotion","promotionType","catch","err","console","error","copilotButton","document","querySelector","CopilotPromoPopup","createByPresetId","presetId","Preset","TASK","targetOptions","offset","left","top","angleOptions","position","AnglePosition","LEFT"],"mappings":";;;;;;CAGwD;CAAA;AAMxD,CAAO,MAAMA,YAAY,CACzB;GAGCC,WAAW,CAACC,MAAc,EAC1B;KAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,4CAAI,sBAAWA,MAAM;;GAGtBC,IAAI,GACJ;KACCC,oCAAgB,CAACC,MAAM,CAACC,OAAO,CAAEC,MAAM,IAAK;OAC3C,MAAMC,UAAU,2CAAG,IAAI,yBAAY;OAEnC,IAAI,CAACA,UAAU,EACf;SACCD,MAAM,EAAE;SAER;;OAGDC,UAAU,CAACC,SAAS,CAACC,wCAAqB,CAACC,IAAI,EAAE,IAAI,CAACC,kBAAkB,CAACC,IAAI,CAAC,IAAI,EAAEN,MAAM,CAAC,CAAC;OAC5FC,UAAU,CAACL,IAAI,EAAE;MACjB,CAAC;;GA0BHS,kBAAkB,CAACL,MAAgB,EACnC;KACCO,cAAI,CAACC,SAAS,CAAC,2BAA2B,EAAE;OAAEC,IAAI,EAAE;SAAEC,SAAS,EAAE,4CAAI,oBAASC;;MAAiB,CAAC,CAC9FC,KAAK,CAAEC,GAAG,IAAK;OACfC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;MAClB,CAAC;KAGHb,MAAM,EAAE;;CAEV;CAAC,sBAhCA;GACC,MAAMgB,aAAa,GAAGC,QAAQ,CAACC,aAAa,CAAC,wBAAwB,CAAC;GAEtE,IAAI,CAACF,aAAa,EAClB;KACC,OAAO,IAAI;;GAGZ,OAAOG,sCAAiB,CAACC,gBAAgB,CAAC;KACzCC,QAAQ,EAAEF,sCAAiB,CAACG,MAAM,CAACC,IAAI;KACvCC,aAAa,EAAER,aAAa;KAC5BS,MAAM,EAAE;OACPC,IAAI,EAAE,EAAE;OACRC,GAAG,EAAE,CAAC;MACN;KACDC,YAAY,EAAE;OACbC,QAAQ,EAAEC,gCAAa,CAACC,IAAI;OAC5BN,MAAM,EAAE;;IAET,CAAC;CACH;;;;;;;;"}