{"version":3,"file":"script.js","sources":["src/form.js","src/entity.js"],"sourcesContent":["import Entity from './entity';\nimport {Loc, Text, Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport default class Form\n{\n\tstatic maxMessageLength = 64000;\n\tstatic instances = {};\n\n\tstatic makeQuote(formId, {entity, messageId, text})\n\t{\n\t\tif (Form.instances[formId])\n\t\t{\n\t\t\tForm.instances[formId].quote({entity, messageId, text});\n\t\t}\n\t}\n\n\tstatic makeReply(formId, {entity, messageId, text})\n\t{\n\t\tif (Form.instances[formId])\n\t\t{\n\t\t\tForm.instances[formId].reply({entity, messageId, text});\n\t\t}\n\t}\n\n\tstatic create({formId, editorId, formNode, useAjax})\n\t{\n\t\tif (!Form.instances[formId])\n\t\t{\n\t\t\tForm.instances[formId] = new Form({formId, editorId, formNode, useAjax});\n\t\t}\n\t\treturn Form.instances[formId];\n\t}\n\n\tconstructor({formId, editorId, formNode, useAjax})\n\t{\n\t\tthis.formId = formId;\n\t\tthis.editorId = editorId;\n\n\t\tthis.currentEntity = {\n\t\t\tentity: null,\n\t\t\tmessageId: null,\n\t\t};\n\n\t\tthis.init = this.init.bind(this);\n\t\tEventEmitter.subscribe('OnEditorInitedAfter', this.init);\n\n\t\tthis.useAjax = (useAjax === true);\n\n\t\tthis.formNode = formNode;\n\t\tthis.formNode.addEventListener('submit', this.submit.bind(this));\n\t\tthis.container = this.formNode.parentNode;\n\n\t\tthis.onSuccess = this.onSuccess.bind(this);\n\t\tthis.onFailure = this.onFailure.bind(this);\n\t}\n\n\tinit({target})\n\t{\n\t\tif (target.id !== this.editorId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.editor = target;\n\t\ttarget.insertImageAfterUpload = true;\n\t\tEventEmitter.unsubscribe('OnEditorInitedAfter', this.init);\n\t\tBX.bind(BX('post_message_hidden'), \"focus\", function(){ target.Focus();} );\n\t}\n\n\tsubmit(event)\n\t{\n\t\tlet text = '';\n\t\tif (this.getLHE().editorIsLoaded)\n\t\t{\n\t\t\tthis.getLHE().oEditor.SaveContent();\n\t\t\ttext = this.getLHE().oEditor.GetContent();\n\t\t}\n\t\tconst error = [];\n\t\tif (text.length <= 0)\n\t\t{\n\t\t\terror.push(Loc.getMessage('JERROR_NO_MESSAGE'))\n\t\t}\n\t\telse if (text.length > Form.maxMessageLength)\n\t\t{\n\t\t\terror.push(Loc.getMessage('JERROR_MAX_LEN')\n\t\t\t\t.replace(/#MAX_LENGTH#/gi, Form.maxMessageLength)\n\t\t\t\t.replace(/#LENGTH#/gi, text.length))\n\t\t}\n\t\telse if (this.isOccupied())\n\t\t{\n\t\t\terror.push('Occupied');\n\t\t}\n\n\t\tif (error.length <= 0)\n\t\t{\n\t\t\tthis.occupy();\n\t\t\tif (!this.useAjax)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tthis.send();\n\t\t}\n\t\telse\n\t\t{\n\t\t\talert(error.join(''));\n\t\t}\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t\treturn false;\n\t}\n\n\tisOccupied()\n\t{\n\t\treturn this.busy === true;\n\t}\n\n\toccupy()\n\t{\n\t\tthis.busy = true;\n\t\tthis.formNode\n\t\t\t.querySelectorAll(\"input[type=submit]\")\n\t\t\t.forEach((input) => {\n\t\t\t\tinput.disabled = true;\n\t\t\t});\n\t}\n\n\trelease()\n\t{\n\t\tthis.busy = false;\n\t\tthis.formNode\n\t\t\t.querySelectorAll(\"input[type=submit]\")\n\t\t\t.forEach((input) => {\n\t\t\t\tinput.disabled = false;\n\t\t\t});\n\t}\n\n\tsend()\n\t{\n\t\tconst secretNode = document.createElement('input');\n\t\tsecretNode.type = 'hidden';\n\t\tsecretNode.name = 'dataType';\n\t\tsecretNode.value = 'json';\n\n\t\tthis.formNode.appendChild(secretNode);\n\t\tBX.ajax.submitAjax(this.formNode, {\n\t\t\tmethod: 'POST',\n\t\t\turl: this.formNode.action,\n\t\t\tdataType: 'json',\n\t\t\tonsuccess: this.onSuccess,\n\t\t\tonfailure: this.onFailure\n\t\t});\n\t\tthis.formNode.removeChild(secretNode);\n\t}\n\n\tonSuccess({status, action, data, errors})\n\t{\n\t\tthis.release();\n\t\tif (status !== 'success')\n\t\t{\n\t\t\treturn this.showError(data.errorHtml, errors);\n\t\t}\n\t\telse if (action === 'preview')\n\t\t{\n\t\t\treturn this.showPreview(data.previewHtml);\n\t\t}\n\t\telse if (action === 'add')\n\t\t{\n\t\t\t// Legacy sake for\n\t\t\tEventEmitter.emit(\n\t\t\t\t'onForumCommentAJAXPost',\n\t\t\t\t[data, this.formNode]\n\t\t\t);\n\t\t\tEventEmitter.emit(\n\t\t\t\tthis.currentEntity.entity,\n\t\t\t\t'onForumCommentAdded',\n\t\t\t\tdata\n\t\t\t);\n\t\t\treturn this.clear();\n\t\t}\n\n\t\tthis.showError('There is nothing')\n\t}\n\n\tonFailure()\n\t{\n\t\tthis.release();\n\t\tthis.showError('<b class=\"error\">Some error with response</b>');\n\t}\n\n\tshowError(errorHTML)\n\t{\n\t\tconst errorNode = this.container.querySelector('div[data-bx-role=error]');\n\t\terrorNode.innerHTML = errorHTML;\n\t\tthis.container.setAttribute('data-bx-status', 'errored');\n\t\terrorNode.style.display = 'block';\n\t}\n\n\thideError()\n\t{\n\t\tconst errorNode = this.container.querySelector('div[data-bx-role=error]');\n\t\terrorNode.innerHTML = '';\n\t\tthis.container.removeAttribute('data-bx-status', 'errored');\n\t\terrorNode.style.display = 'none';\n\t}\n\n\tshowPreview(previewHTML)\n\t{\n\t\tconst previewNode = this.container.querySelector('div[data-bx-role=preview]');\n\t\tpreviewNode.innerHTML = previewHTML;\n\t\tthis.container.setAttribute('data-bx-status', 'preview');\n\t\tpreviewNode.style.display = 'block';\n\t}\n\n\thidePreview()\n\t{\n\t\tconst previewNode = this.container.querySelector('div[data-bx-role=preview]');\n\t\tpreviewNode.innerHTML = '';\n\t\tthis.container.setAttribute('data-bx-status', 'preview');\n\t\tpreviewNode.style.display = 'none';\n\t}\n\n\tisFormReady({entity, messageId}) {\n\t\tif (\n\t\t\tthis.currentEntity.entity === null ||\n\t\t\tthis.currentEntity.entity === entity\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\t\treturn window.confirm(\"Do you want to miss all changes?\");\n\t}\n\n\tparseText(text)\n\t{\n\t\tconst editor = this.getLHE().oEditor;\n\t\tlet tmpTxt = text;\n\t\tif (tmpTxt.length > 0 && editor.GetViewMode() === \"wysiwyg\")\n\t\t{\n\t\t\tconst reg = /^\\[USER\\=(\\d+)\\](.+?)\\[\\/USER\\]/i;\n\t\t\tif (reg.test(tmpTxt))\n\t\t\t{\n\t\t\t\ttmpTxt = tmpTxt.replace(reg, function() {\n\t\t\t\t\tconst userId = parseInt(arguments[1]);\n\t\t\t\t\tconst userName = Text.encode(arguments[2]);\n\t\t\t\t\tlet result = `<span>${userName}</span>`;\n\t\t\t\t\tif (userId > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst tagId = editor.SetBxTag(false, {tag: \"postuser\", params: {value : userId}});\n\t\t\t\t\t\tresult = `<span id=\"${tagId}\" class=\"bxhtmled-metion\">${userName}</span>`;\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t}.bind(this));\n\t\t\t}\n\t\t}\n\t\treturn tmpTxt;\n\t}\n\n\treply({entity, messageId, text})\n\t{\n\t\tthis.show({entity, messageId})\n\t\t\t.then(() => {\n\t\t\t\tif (text !== '')\n\t\t\t\t{\n\t\t\t\t\tconst editor = this.getLHE().oEditor;\n\t\t\t\t\tconst tmpText = this.parseText(text);\n\t\t\t\t\teditor.action.Exec(\"insertHTML\", tmpText);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tquote({entity, messageId, text})\n\t{\n\t\tthis.show({entity, messageId})\n\t\t\t.then(() => {\n\t\t\t\tconst editor = this.getLHE().oEditor;\n\t\t\t\tif (!editor.toolbar.controls.Quote)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst tmpText = this.parseText(text);\n\n\t\t\t\tif (editor.action.actions.quote.setExternalSelectionFromRange)\n\t\t\t\t{\n\t\t\t\t\teditor.action.actions.quote.setExternalSelection(tmpText);\n\t\t\t\t}\n\t\t\t\teditor.action.Exec(\"quote\");\n\t\t\t});\n\t}\n\n\tclear()\n\t{\n\t\tthis.hideError();\n\t\tthis.hidePreview();\n\t\tthis.editor.CheckAndReInit('');\n\t\tif (this.editor.fAutosave && this.editor.pEditorDocument)\n\t\t{\n\t\t\tthis.editor.pEditorDocument.addEventListener(\n\t\t\t\t'keydown',\n\t\t\t\tthis.editor.fAutosave.Init.bind(this.editor.fAutosave)\n\t\t\t);\n\t\t}\n\n\t\tthis.formNode.querySelectorAll('.reviews-preview').forEach((node) => {\n\t\t\tnode.parentNode.removeChild(node);\n\t\t});\n\n\t\tthis.formNode.querySelectorAll('input[type=\"file\"]').forEach((node) => {\n\t\t\tconst newNode = node.cloneNode();\n\t\t\tnewNode.value = '';\n\t\t\tnode.parentNode.replaceChild(newNode, node);\n\t\t});\n\t\tconst visibilityCheckbox = this.formNode.querySelector('[data-bx-role=\"attach-visibility\"]');\n\t\tif (visibilityCheckbox)\n\t\t{\n\t\t\tvisibilityCheckbox.checked = false;\n\t\t}\n\n\t\tconst captchaWord = this.formNode.querySelector('input[name=\"captcha_word\"]');\n\t\tif (captchaWord)\n\t\t{\n\t\t\tcaptchaWord.value = '';\n\t\t\tconst captchaCode = this.formNode.querySelector('input[name=\"captcha_code\"]');\n\t\t\tconst captchaImage = this.formNode.querySelector('img[name=\"captcha_image\"]');\n\t\t\tBX.ajax.getCaptcha(function(result) {\n\t\t\t\tcaptchaCode.value = result['captcha_sid'];\n\t\t\t\tcaptchaImage.src = '/bitrix/tools/captcha.php?captcha_code=' + result['captcha_sid'];\n\t\t\t});\n\t\t}\n\t\tconst subscribeCheckbox = this.formNode.querySelector('input[name=\"TOPIC_SUBSCRIBE\"]');\n\t\tif (subscribeCheckbox && subscribeCheckbox.checked)\n\t\t{\n\t\t\tsubscribeCheckbox.disabled = true;\n\t\t}\n\t}\n\n\tshow({entity, messageId})\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (!this.isFormReady({entity, messageId}))\n\t\t\t{\n\t\t\t\treturn reject();\n\t\t\t}\n\n\t\t\tconst loaded = (!!this.getLHE() && !!this.getLHE().editorIsLoaded);\n\t\t\tif (loaded\n\t\t\t\t&& this.currentEntity.entity === entity\n\t\t\t\t&& this.currentEntity.messageId === messageId)\n\t\t\t{\n\t\t\t\tthis.getLHE().oEditor.Focus();\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tthis.currentEntity.entity = entity;\n\t\t\tthis.currentEntity.messageId = messageId;\n\t\t\tthis.container.style.display = 'block';\n\n\t\t\tEventEmitter.emit(this.currentEntity.entity,'onForumCommentFormShow', []);\n\t\t\tEventEmitter.emit(this.getLHEEventNode(), 'OnShowLHE', ['show']);\n\n\t\t\tif (loaded !== true)\n\t\t\t{\n\t\t\t\tthis.getLHE().exec(() => {\n\t\t\t\t\tthis.show({entity, messageId}).then(resolve, reject);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\n\t}\n\n\tgetLHE()\n\t{\n\t\treturn LHEPostForm.getHandlerByFormId(this.formId);\n\t}\n\n\tgetLHEEventNode()\n\t{\n\t\tif (!this.handlerEventNode && this.getLHE())\n\t\t{\n\t\t\tthis.handlerEventNode = this.getLHE().eventNode;\n\t\t}\n\t\treturn this.handlerEventNode\n\t}\n}","import Form from './form';\nimport {Event, Runtime, Tag, ajax, Uri} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport default class Entity\n{\n\tconstructor({formId, container, preorder, ajaxPost})\n\t{\n\t\tthis.formId = formId;\n\t\tthis.container = container;\n\t\tthis.preorder = preorder === true;\n\t\tthis.ajaxPost = ajaxPost === true;\n\t\tthis.reply = this.reply.bind(this);\n\t\tthis.quote = this.quote.bind(this);\n\t\tthis.parseResponse = this.parseResponse.bind(this);\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tthis.container.querySelectorAll(\"[data-bx-role=add-new-message]\").forEach((node) => {\n\t\t\tnode.addEventListener('click', () => {\n\t\t\t\tthis.reply({node: null});\n\t\t\t});\n\t\t});\n\t\tthis.bindMessages();\n\t\tthis.bindNavigation();\n\n\t\tEventEmitter.subscribe(this, 'onForumCommentAdded', this.parseResponse);\n\t\tEventEmitter.subscribeOnce(this, 'onForumCommentFormShow', function() {\n\t\t\tthis.container.querySelectorAll(\"[data-bx-role=add-new-message]\").forEach((node) => {\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t});\n\t\t}.bind(this));\n\t}\n\n\tbindMessages()\n\t{\n\t\tthis.container.querySelectorAll('table').forEach((node) => {\n\t\t\tnode.querySelectorAll('a[data-bx-act]').forEach((actNode) => {\n\t\t\t\tconst action = actNode.dataset.bxAct;\n\t\t\t\tif (action === 'reply')\n\t\t\t\t{\n\t\t\t\t\tEvent.bind(actNode, 'click', (event) => {\n\t\t\t\t\t\tthis.reply({node: node});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse if (action === 'quote')\n\t\t\t\t{\n\t\t\t\t\tEvent.bind(actNode, 'click', (event) => {\n\t\t\t\t\t\tthis.quote({node: node});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse if (action === 'hide' || action === 'show')\n\t\t\t\t{\n\t\t\t\t\tEvent.bind(actNode, 'click', (event) => {\n\t\t\t\t\t\tthis.moderate({node: node, action: action, actNode: actNode});\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\telse if (action === 'del')\n\t\t\t\t{\n\t\t\t\t\tEvent.bind(actNode, 'click', (event) => {\n\t\t\t\t\t\tthis.delete({node: node});\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tbindNavigation()\n\t{\n\t\tif (!this.ajaxPost)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.container\n\t\t\t.querySelector('div[data-bx-role=navigation-container-top]')\n\t\t\t.querySelectorAll('a')\n\t\t\t.forEach((node) => {\n\t\t\t\tEvent.bindOnce(node, 'click', (event) => {\n\t\t\t\t\tthis.navigate({node: node});\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t});\n\t\t\t});\n\t\tthis.container\n\t\t\t.querySelector('div[data-bx-role=navigation-container-bottom]')\n\t\t\t.querySelectorAll('a')\n\t\t\t.forEach((node) => {\n\t\t\t\tEvent.bind(node, 'click', (event) => {\n\t\t\t\t\tthis.navigate({node: node});\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tparseResponse({data})\n\t{\n\t\tRuntime.html(\n\t\t\tthis.container.querySelector('div[data-bx-role=messages-container]'),\n\t\t\tdata.messages\n\t\t);\n\n\t\tRuntime.html(\n\t\t\tthis.container.querySelector('div[data-bx-role=navigation-container-top]'),\n\t\t\tdata.navigationTop\n\t\t);\n\t\tRuntime.html(\n\t\t\tthis.container.querySelector('div[data-bx-role=navigation-container-bottom]'),\n\t\t\tdata.navigationBottom\n\t\t);\n\t\tsetTimeout(function(messageId) {\n\t\t\tthis.bindMessages();\n\t\t\tthis.bindNavigation();\n\t\t\tif (messageId > 0)\n\t\t\t{\n\t\t\t\tBX.scrollToNode(this.container.querySelector('table[id=message' + messageId + ']'));\n\t\t\t}\n\t\t}.bind(this), 0, data.messageId)\n\t}\n\n\tgetPlaceholder(/*messageId*/)\n\t{\n\t\treturn this.container.querySelector(\"[data-bx-role=placeholder]\");\n\t}\n\n\tnavigate({node})\n\t{\n\t\treturn BX.ajax({\n\t\t\t'method': 'GET',\n\t\t\t'dataType': 'json',\n\t\t\t'url': Uri.addParam(node.href, {ajax: 'y'}),\n\t\t\t'onsuccess': this.parseResponse\n\t\t});\n\t}\n\n\treply({node})\n\t{\n\t\tconst text = node !== null ? `[USER=${node.dataset.bxAuthorId}]${node.dataset.bxAuthorName}[/USER],&nbsp;` : '';\n\t\tForm.makeReply(this.formId, {\n\t\t\tentity: this,\n\t\t\tmessageId: 0,\n\t\t\ttext: text\n\t\t});\n\t}\n\n\tquote({node})\n\t{\n\t\tconst text = [\n\t\t\t`[USER=${node.dataset.bxAuthorId}]${node.dataset.bxAuthorName}[/USER]<br>`,\n\t\t\tnode.querySelector('div[data-bx-role=text]').innerHTML,\n\t\t].join('');\n\n\t\tForm.makeQuote(this.formId, {entity: this, messageId: 0, text: text});\n\t}\n\n\tmoderate({node, actNode})\n\t{\n\t\tajax.runComponentAction(\n\t\t\t'bitrix:forum.topic.reviews',\n\t\t\tactNode.dataset.bxAct + 'Message',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tid: node.dataset.bxMessageId\n\t\t\t\t}\n\t\t\t}\n\t\t).then(({data}) => {\n\t\t\tactNode.dataset.bxAct = (data.APPROVED === 'Y' ? 'hide' : 'show');\n\t\t\tif (data.APPROVED === 'Y')\n\t\t\t{\n\t\t\t\tnode.classList.remove('reviews-post-hidden');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnode.classList.add('reviews-post-hidden');\n\t\t\t}\n\t\t});\n\t}\n\n\tdelete({node})\n\t{\n\t\tajax.runComponentAction(\n\t\t\t'bitrix:forum.topic.reviews',\n\t\t\t'deleteMessage',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tid: node.dataset.bxMessageId\n\t\t\t\t}\n\t\t\t}\n\t\t).then(() => {\n\t\t\tnode.parentNode.removeChild(node);\n\t\t});\n\t}\n}"],"names":["Form","formId","entity","messageId","text","instances","quote","reply","editorId","formNode","useAjax","currentEntity","init","bind","EventEmitter","subscribe","addEventListener","submit","container","parentNode","onSuccess","onFailure","target","id","editor","insertImageAfterUpload","unsubscribe","BX","Focus","event","getLHE","editorIsLoaded","oEditor","SaveContent","GetContent","error","length","push","Loc","getMessage","maxMessageLength","replace","isOccupied","occupy","send","alert","join","stopPropagation","preventDefault","busy","querySelectorAll","forEach","input","disabled","secretNode","document","createElement","type","name","value","appendChild","ajax","submitAjax","method","url","action","dataType","onsuccess","onfailure","removeChild","status","data","errors","release","showError","errorHtml","showPreview","previewHtml","emit","clear","errorHTML","errorNode","querySelector","innerHTML","setAttribute","style","display","removeAttribute","previewHTML","previewNode","window","confirm","tmpTxt","GetViewMode","reg","test","userId","parseInt","arguments","userName","Text","encode","result","tagId","SetBxTag","tag","params","show","then","tmpText","parseText","Exec","toolbar","controls","Quote","actions","setExternalSelectionFromRange","setExternalSelection","hideError","hidePreview","CheckAndReInit","fAutosave","pEditorDocument","Init","node","newNode","cloneNode","replaceChild","visibilityCheckbox","checked","captchaWord","captchaCode","captchaImage","getCaptcha","src","subscribeCheckbox","Promise","resolve","reject","isFormReady","loaded","getLHEEventNode","exec","LHEPostForm","getHandlerByFormId","handlerEventNode","eventNode","Entity","preorder","ajaxPost","parseResponse","bindMessages","bindNavigation","subscribeOnce","actNode","dataset","bxAct","Event","moderate","delete","bindOnce","navigate","Runtime","html","messages","navigationTop","navigationBottom","setTimeout","scrollToNode","Uri","addParam","href","bxAuthorId","bxAuthorName","makeReply","makeQuote","runComponentAction","mode","bxMessageId","APPROVED","classList","remove","add"],"mappings":"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"}