{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Reflection, Tag, Type } from 'main.core';\nimport { PopupManager } from 'main.popup';\nimport { Popup } from \"main.popup\";\n\nconst namespaceCrmWhatsNew = Reflection.namespace('BX.Crm.WhatsNew');\n\ntype ContentConfig = {\n\tinnerTitle: string,\n\tinnerSubTitle: string,\n\tinnerDescription: string,\n\tinnerInfo: string,\n\tinnerImage: string,\n};\n\nclass RichPopup\n{\n\t#popup: Popup;\n\t#data: ContentConfig;\n\t#options: Object;\n\t#userOptionCategory: string;\n\t#userOptionName: string;\n\n\tconstructor({ data, options,  userOptionCategory, userOptionName })\n\t{\n\t\tthis.#popup = null;\n\t\tthis.#data = data;\n\t\tthis.#options = Type.isObject(options) ? options : {};\n\t\tthis.#userOptionCategory = Type.isString(userOptionCategory) ? userOptionCategory : 'crm';\n\t\tthis.#userOptionName = Type.isString(userOptionName) ? userOptionName : '';\n\t\tif (Type.isNumber(options.entityTypeId) && Type.isStringFilled(this.#userOptionName))\n\t\t{\n\t\t\tthis.#userOptionName = this.#userOptionName + options.entityTypeId\n\t\t}\n\t}\n\n\tshow(): void\n\t{\n\t\tconst isAnyPopupShown = PopupManager && PopupManager.isAnyPopupShown();\n\t\tconst isAnySliderShown = BX.SidePanel.Instance.getOpenSlidersCount() > 0;\n\n\t\tif (isAnyPopupShown || isAnySliderShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tconst htmlStyles = getComputedStyle(document.documentElement);\n\t\t\tconst popupPadding = htmlStyles.getPropertyValue('--ui-space-inset-sm');\n\t\t\tconst popupPaddingNumberValue = parseFloat(popupPadding) || 12;\n\t\t\tconst popupOverlayColor = htmlStyles.getPropertyValue('--ui-color-base-solid') || '#000000';\n\n\t\t\tthis.#popup = new Popup({\n\t\t\t\tclassName: 'crm-rich-popup-wrapper',\n\t\t\t\tcloseIcon: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tcacheable: false,\n\t\t\t\tpadding: popupPaddingNumberValue,\n\t\t\t\toverlay: {\n\t\t\t\t\topacity: 40,\n\t\t\t\t\tbackgroundColor: popupOverlayColor,\n\t\t\t\t},\n\t\t\t\tcontent: this.#getPopupContent(),\n\t\t\t\twidth: 640,\n\t\t\t\theight: 400,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => this.save()\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.#popup.show();\n\t\t}\n\t}\n\n\t#getPopupContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-rich-popup-slide\">\n\t\t\t\t<img src=\"${this.#data.innerImage}\" alt=\"\">\n\t\t\t\t<div class=\"crm-rich-popup-slide-inner-title\"> ${this.#data.innerTitle} </div>\n\t\t\t\t<div class=\"crm-rich-popup-slide-inner-subtitle\"> ${this.#data.innerSubTitle} </div>\n\t\t\t\t<div class=\"crm-rich-popup-slide-inner-description\">${this.#data.innerDescription}</div>\n\t\t\t\t<div class=\"crm-rich-popup-slide-inner-info\">${this.#data.innerInfo}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tsave(): void\n\t{\n\t\tBX.userOptions.save(\n\t\t\tthis.#userOptionCategory,\n\t\t\tthis.#userOptionName,\n\t\t\t'count',\n\t\t\tthis.#options.checkpoint\n\t\t);\n\t}\n}\n\nnamespaceCrmWhatsNew.RichPopup = RichPopup;\n"],"names":["namespaceCrmWhatsNew","Reflection","namespace","RichPopup","data","options","userOptionCategory","userOptionName","Type","isObject","isString","isNumber","entityTypeId","isStringFilled","isAnyPopupShown","PopupManager","isAnySliderShown","BX","SidePanel","Instance","getOpenSlidersCount","htmlStyles","getComputedStyle","document","documentElement","popupPadding","getPropertyValue","popupPaddingNumberValue","parseFloat","popupOverlayColor","Popup","className","closeIcon","closeByEsc","cacheable","padding","overlay","opacity","backgroundColor","content","width","height","events","onPopupClose","save","show","userOptions","checkpoint","Tag","render","innerImage","innerTitle","innerSubTitle","innerDescription","innerInfo"],"mappings":";;;;;;;;AAAA,CAIA,IAAMA,oBAAoB,GAAGC,oBAAU,CAACC,SAAS,CAAC,iBAAiB,CAAC;CAAC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA,IAU/DC,SAAS;GAQd,yBACA;KAAA,IADcC,IAAI,QAAJA,IAAI;OAAEC,OAAO,QAAPA,OAAO;OAAGC,kBAAkB,QAAlBA,kBAAkB;OAAEC,cAAc,QAAdA,cAAc;KAAA;KAAA;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAE/D,sCAAI,UAAU,IAAI;KAClB,sCAAI,SAASH,IAAI;KACjB,sCAAI,YAAYI,cAAI,CAACC,QAAQ,CAACJ,OAAO,CAAC,GAAGA,OAAO,GAAG,EAAE;KACrD,sCAAI,uBAAuBG,cAAI,CAACE,QAAQ,CAACJ,kBAAkB,CAAC,GAAGA,kBAAkB,GAAG,KAAK;KACzF,sCAAI,mBAAmBE,cAAI,CAACE,QAAQ,CAACH,cAAc,CAAC,GAAGA,cAAc,GAAG,EAAE;KAC1E,IAAIC,cAAI,CAACG,QAAQ,CAACN,OAAO,CAACO,YAAY,CAAC,IAAIJ,cAAI,CAACK,cAAc,mCAAC,IAAI,mBAAiB,EACpF;OACC,sCAAI,mBAAmB,sCAAI,qBAAmBR,OAAO,CAACO,YAAY;;;GAEnE;KAAA;KAAA,uBAGD;OAAA;OACC,IAAME,eAAe,GAAGC,uBAAY,IAAIA,uBAAY,CAACD,eAAe,EAAE;OACtE,IAAME,gBAAgB,GAAGC,EAAE,CAACC,SAAS,CAACC,QAAQ,CAACC,mBAAmB,EAAE,GAAG,CAAC;OAExE,IAAIN,eAAe,IAAIE,gBAAgB,EACvC;SACC;;OAGD,IAAI,mCAAC,IAAI,SAAO,EAChB;SACC,IAAMK,UAAU,GAAGC,gBAAgB,CAACC,QAAQ,CAACC,eAAe,CAAC;SAC7D,IAAMC,YAAY,GAAGJ,UAAU,CAACK,gBAAgB,CAAC,qBAAqB,CAAC;SACvE,IAAMC,uBAAuB,GAAGC,UAAU,CAACH,YAAY,CAAC,IAAI,EAAE;SAC9D,IAAMI,iBAAiB,GAAGR,UAAU,CAACK,gBAAgB,CAAC,uBAAuB,CAAC,IAAI,SAAS;SAE3F,sCAAI,UAAU,IAAII,gBAAK,CAAC;WACvBC,SAAS,EAAE,wBAAwB;WACnCC,SAAS,EAAE,IAAI;WACfC,UAAU,EAAE,IAAI;WAChBC,SAAS,EAAE,KAAK;WAChBC,OAAO,EAAER,uBAAuB;WAChCS,OAAO,EAAE;aACRC,OAAO,EAAE,EAAE;aACXC,eAAe,EAAET;YACjB;WACDU,OAAO,yBAAE,IAAI,4CAAJ,IAAI,CAAmB;WAChCC,KAAK,EAAE,GAAG;WACVC,MAAM,EAAE,GAAG;WACXC,MAAM,EAAE;aACPC,YAAY,EAAE;eAAA,OAAM,KAAI,CAACC,IAAI,EAAE;;;UAEhC,CAAC;SAEF,sCAAI,UAAQC,IAAI,EAAE;;;;KAEnB;KAAA,uBAgBD;OACC5B,EAAE,CAAC6B,WAAW,CAACF,IAAI,mCAClB,IAAI,0DACJ,IAAI,oBACJ,OAAO,EACP,sCAAI,YAAUG,UAAU,CACxB;;;GACD;CAAA;CAAA,6BApBD;GACC,OAAOC,aAAG,CAACC,MAAM,mdAEH,sCAAI,SAAOC,UAAU,EACgB,sCAAI,SAAOC,UAAU,EAClB,sCAAI,SAAOC,aAAa,EACtB,sCAAI,SAAOC,gBAAgB,EAClC,sCAAI,SAAOC,SAAS;CAGtE;CAaDtD,oBAAoB,CAACG,SAAS,GAAGA,SAAS;;;;"}