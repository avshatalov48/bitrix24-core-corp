{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { clone, Dom, Reflection, Runtime, Tag, Type } from 'main.core';\nimport { Popup, PopupManager } from 'main.popup';\nimport { Button } from 'ui.buttons';\nimport { EventEmitter } from \"main.core.events\";\n\nconst namespaceCrmWhatsNew = Reflection.namespace('BX.Crm.WhatsNew');\n\ntype SlideConfig = {\n\ttitle: string,\n\tinnerImage: string,\n\tinnerTitle: string,\n\tinnerDescription: string,\n\tbuttons: Array<ButtonConfig>,\n};\n\ntype ButtonConfig = {\n\ttext: string,\n\tclassName: string,\n\tonClickClose: ?boolean,\n\thelpDeskCode: ?string,\n}\n\ntype Slide = {\n\ttitle: string,\n\tclassName: ?string,\n\thtml: string,\n}\n\ntype StepPosition = 'left' | 'right'; //it's bottom by default\n\ntype StepConfig = {\n\tid: string,\n\ttitle: string,\n\ttext: string,\n\tposition: ?StepPosition,\n\ttarget: ?string,\n\tuseDynamicTarget: ?boolean,\n\teventName: ?string,\n}\n\ntype Step = {\n\tid: string,\n\ttitle: string,\n\ttext: string,\n\tposition: ?StepPosition,\n\ttarget: ?string,\n}\n\nclass ActionViewMode\n{\n\tslides: Array<Slide>;\n\tsteps: Array<Step>;\n\tcloseOptionName: string;\n\tcloseOptionCategory: string;\n\tpopup;\n\n\tconstructor({ slides, steps, options, closeOptionCategory, closeOptionName })\n\t{\n\t\tthis.popup = null;\n\t\tthis.slides = [];\n\t\tthis.steps = [];\n\t\tthis.options = options;\n\t\tthis.slideClassName = 'crm-whats-new-slides-wrapper';\n\t\tthis.closeOptionCategory = Type.isString(closeOptionCategory) ? closeOptionCategory : '';\n\t\tthis.closeOptionName = Type.isString(closeOptionName) ? closeOptionName : '';\n\t\tthis.onClickClose = this.onClickCloseHandler.bind(this);\n\n\t\tthis.whatNewPromise = null;\n\t\tthis.tourPromise = null;\n\n\t\tthis.prepareSlides(slides);\n\t\tthis.prepareSteps(steps);\n\t}\n\n\tprepareSlides(slideConfigs: Array<SlideConfig>): void\n\t{\n\t\tif (slideConfigs.length)\n\t\t{\n\t\t\tthis.whatNewPromise = Runtime.loadExtension('ui.dialogs.whats-new');\n\t\t}\n\n\t\tthis.slides = slideConfigs.map((slideConfig: SlideConfig) => {\n\t\t\treturn {\n\t\t\t\tclassName: this.slideClassName,\n\t\t\t\ttitle: slideConfig.title,\n\t\t\t\thtml: this.getPreparedSlideHtml(slideConfig),\n\t\t\t};\n\t\t}, this);\n\t}\n\n\tgetPreparedSlideHtml(slideConfig: SlideConfig): HTMLElement\n\t{\n\t\tconst slide = Tag.render`\n\t\t\t<div class=\"crm-whats-new-slide\">\n\t\t\t\t<img src=\"${slideConfig.innerImage}\" alt=\"\">\n\t\t\t\t<div class=\"crm-whats-new-slide-inner-title\"> ${slideConfig.innerTitle} </div>\n\t\t\t\t<p>${slideConfig.innerDescription}</p>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst buttons = this.getPrepareSlideButtons(slideConfig);\n\t\tif (buttons.length)\n\t\t{\n\t\t\tconst buttonsContainer =  Tag.render`<div class=\"crm-whats-new-slide-buttons\"></div>`;\n\t\t\tDom.append(buttonsContainer, slide);\n\n\t\t\tbuttons.forEach(button => {\n\t\t\t\tDom.append(button.getContainer(), buttonsContainer);\n\t\t\t});\n\t\t}\n\n\t\treturn slide;\n\t}\n\n\tgetPrepareSlideButtons(slideConfig: SlideConfig): Button[]\n\t{\n\t\tlet buttons = [];\n\t\tif (slideConfig.buttons)\n\t\t{\n\t\t\tconst className = 'ui-btn ui-btn-primary ui-btn-hover ui-btn-round ';\n\n\t\t\tbuttons = slideConfig.buttons.map((buttonConfig) => {\n\t\t\t\tconst config = {\n\t\t\t\t\tclassName: className + (buttonConfig.className ?? ''),\n\t\t\t\t\ttext: buttonConfig.text,\n\t\t\t\t};\n\n\t\t\t\tif (buttonConfig.onClickClose)\n\t\t\t\t{\n\t\t\t\t\tconfig.onclick = () => this.onClickClose();\n\t\t\t\t}\n\t\t\t\telse if (buttonConfig.helpDeskCode)\n\t\t\t\t{\n\t\t\t\t\tconfig.onclick = () => this.showHelpDesk(buttonConfig.helpDeskCode);\n\t\t\t\t}\n\n\t\t\t\treturn new Button(config);\n\t\t\t}, this);\n\t\t}\n\n\t\treturn buttons;\n\t}\n\n\tprepareSteps(stepsConfig)\n\t{\n\t\tif (stepsConfig.length)\n\t\t{\n\t\t\tthis.tourPromise = Runtime.loadExtension('ui.tour');\n\t\t}\n\n\t\tthis.steps = stepsConfig.map((stepConfig: StepConfig) => {\n\t\t\tconst step = {\n\t\t\t\tid: stepConfig.id,\n\t\t\t\ttitle: stepConfig.title,\n\t\t\t\ttext: stepConfig.text,\n\t\t\t\tposition: stepConfig.position,\n\t\t\t};\n\n\t\t\tif (stepConfig.useDynamicTarget)\n\t\t\t{\n\t\t\t\tconst eventName = (stepConfig.eventName ?? this.getDefaultStepEventName(step.id));\n\t\t\t\tEventEmitter.subscribeOnce(eventName, this.showStepByEvent.bind(this));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tstep.target = stepConfig.target;\n\t\t\t}\n\n\t\t\treturn step;\n\n\t\t}, this);\n\t}\n\n\tshowStepByEvent(event): void\n\t{\n\t\tthis.tourPromise.then((exports) => {\n\t\t\tconst { stepId, target, delay }  = event.data;\n\t\t\tconst step = this.steps.find(step => step.id === stepId);\n\t\t\tif (!step)\n\t\t\t{\n\t\t\t\tconsole.error('step not found');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tstep.target = target;\n\t\t\t\tconst { Guide } = exports;\n\t\t\t\tconst guide = this.createGuideInstance(Guide, [step], true);\n\n\t\t\t\tthis.setStepPopupOptions(guide.getPopup());\n\t\t\t\tguide.showNextStep();\n\t\t\t\tthis.save();\n\n\t\t\t}, delay || 0);\n\t\t});\n\t}\n\n\tgetDefaultStepEventName(stepId: string): string\n\t{\n\t\treturn `Crm.WhatsNew::onTargetSetted::${stepId}`;\n\t}\n\n\tonClickCloseHandler(): void\n\t{\n\t\tconst lastPosition = this.popup.getLastPosition();\n\t\tconst currentPosition = this.popup.getPositionBySlide(this.popup.getCurrentSlide());\n\t\tif (currentPosition >= lastPosition)\n\t\t{\n\t\t\tthis.popup.destroy();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.popup.selectNextSlide();\n\t\t}\n\t}\n\n\tshowHelpDesk(code: string): void\n\t{\n\t\tif(top.BX.Helper)\n\t\t{\n\t\t\ttop.BX.Helper.show(`redirect=detail&code=${code}`);\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\n\tshow(): void\n\t{\n\t\tif (this.slides.length)\n\t\t{\n\t\t\tthis.executeWhatsNew();\n\t\t}\n\t\telse if (this.steps.length)\n\t\t{\n\t\t\tthis.executeGuide();\n\t\t}\n\t}\n\n\texecuteWhatsNew(): void\n\t{\n\t\tif (PopupManager && PopupManager.isAnyPopupShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.whatNewPromise.then(exports => {\n\t\t\tconst { WhatsNew } = exports;\n\t\t\tthis.popup = new WhatsNew({\n\t\t\t\tslides: this.slides,\n\t\t\t\tpopupOptions: {\n\t\t\t\t\theight: 440,\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonDestroy: () => {\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t\tthis.executeGuide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.popup.show();\n\t\t}, this);\n\t}\n\n\texecuteGuide(): void\n\t{\n\t\tlet steps = clone(this.steps);\n\t\tsteps = steps.filter(step => Boolean(step.target));\n\t\tif (!steps.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tourPromise.then((exports) => {\n\t\t\tconst { Guide } = exports;\n\t\t\tconst guide = this.createGuideInstance(Guide, steps, (this.steps.length <= 1));\n\n\t\t\tthis.setStepPopupOptions(guide.getPopup());\n\n\t\t\tif (guide.steps.length > 1)\n\t\t\t{\n\t\t\t\tguide.start();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tguide.showNextStep();\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateGuideInstance(guide, steps: Array<Step>, onEvents: boolean)\n\t{\n\t\treturn new guide({\n\t\t\tonEvents,\n\t\t\tsteps: steps,\n\t\t\tevents: {\n\t\t\t\tonFinish: () => {\n\t\t\t\t\tif (!this.slides.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\tsetStepPopupOptions(popup: Popup)\n\t{\n\t\tpopup.setAutoHide(false);\n\n\t\tconst { steps } = this.options;\n\t\tif (steps && steps.popup)\n\t\t{\n\t\t\tif (steps.popup.width)\n\t\t\t{\n\t\t\t\tpopup.setWidth(steps.popup.width)\n\t\t\t}\n\t\t}\n\t}\n\n\tsave(): void\n\t{\n\t\tBX.userOptions.save(this.closeOptionCategory, this.closeOptionName, 'closed', 'Y');\n\t}\n}\n\nnamespaceCrmWhatsNew.ActionViewMode = ActionViewMode;\n"],"names":["namespaceCrmWhatsNew","Reflection","namespace","ActionViewMode","slides","steps","options","closeOptionCategory","closeOptionName","popup","slideClassName","Type","isString","onClickClose","onClickCloseHandler","bind","whatNewPromise","tourPromise","prepareSlides","prepareSteps","slideConfigs","length","Runtime","loadExtension","map","slideConfig","className","title","html","getPreparedSlideHtml","slide","Tag","render","innerImage","innerTitle","innerDescription","buttons","getPrepareSlideButtons","buttonsContainer","Dom","append","forEach","button","getContainer","buttonConfig","config","text","onclick","helpDeskCode","showHelpDesk","Button","stepsConfig","stepConfig","step","id","position","useDynamicTarget","eventName","getDefaultStepEventName","EventEmitter","subscribeOnce","showStepByEvent","target","event","then","exports","data","stepId","delay","find","console","error","setTimeout","Guide","guide","createGuideInstance","setStepPopupOptions","getPopup","showNextStep","save","lastPosition","getLastPosition","currentPosition","getPositionBySlide","getCurrentSlide","destroy","selectNextSlide","code","top","BX","Helper","show","preventDefault","executeWhatsNew","executeGuide","PopupManager","isAnyPopupShown","WhatsNew","popupOptions","height","events","onDestroy","clone","filter","Boolean","start","onEvents","onFinish","setAutoHide","width","setWidth","userOptions"],"mappings":"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"}