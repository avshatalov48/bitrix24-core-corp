{"version":3,"file":"script.js","sources":["src/counters-helper.js","src/counters-item.js","src/entry.js"],"sourcesContent":["import {Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nclass Filter\n{\n\tconstructor(options)\n\t{\n\t\tthis.filterId = options.filterId;\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\n\t\tthis.bindEvents();\n\t\tthis.updateFields();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t}\n\n\tonFilterApply()\n\t{\n\t\tthis.updateFields();\n\t}\n\n\tupdateFields()\n\t{\n\t\tthis.fields = this.filterManager.getFilterFieldsValues();\n\t}\n\n\tisFilteredByField(field)\n\t{\n\t\tif (!Object.keys(this.fields).includes(field))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Type.isArray(this.fields[field]))\n\t\t{\n\t\t\treturn this.fields[field].length > 0;\n\t\t}\n\n\t\treturn this.fields[field] !== '';\n\t}\n\n\tisFilteredByFieldValue(field, value)\n\t{\n\t\treturn this.isFilteredByField(field) && this.fields[field] === value;\n\t}\n\n\ttoggleByField(field)\n\t{\n\t\tconst name = Object.keys(field)[0];\n\t\tconst value = field[name];\n\n\t\tif (!this.isFilteredByFieldValue(name, value))\n\t\t{\n\t\t\tthis.filterManager.getApi().extendFilter(\n\t\t\t\t{[name]: value},\n\t\t\t\tfalse,\n\t\t\t\t{COUNTER_TYPE: 'TASKS_COUNTER_TYPE_' + value}\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.filterManager.getFilterFields().forEach((field) => {\n\t\t\tif (field.getAttribute('data-name') === name)\n\t\t\t{\n\t\t\t\tthis.filterManager.getFields().deleteField(field);\n\t\t\t}\n\t\t});\n\n\t\tthis.filterManager.getSearch().apply();\n\t}\n\n\tgetFilter()\n\t{\n\t\treturn this.filterManager;\n\t}\n}\n\nexport {\n\tFilter\n}","import { Tag, Event, Type, Loc, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport default class CountersItem\n{\n\tconstructor(options)\n\t{\n\t\tthis.count = options.count;\n\t\tthis.name = options.name;\n\t\tthis.type = options.type;\n\t\tthis.color = options.color;\n\t\tthis.filterField = options.filterField;\n\t\tthis.filterValue = options.filterValue;\n\t\tthis.filter = options.filter;\n\n\t\tthis.$container = null;\n\t\tthis.$innerContainer = null;\n\t\tthis.$remove = null;\n\t\tthis.$counter = null;\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Tasks.Counters:active', (param)=> {\n\t\t\tthis !== param.data ? this.unActive() : null;\n\t\t});\n\t}\n\n\tgetCounter()\n\t{\n\t\tif (!this.$counter)\n\t\t{\n\t\t\tconst count = this.count > 99 ? '99+' : this.count;\n\t\t\tthis.$counter = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-num ${this.getCounterColor()}\">\n\t\t\t\t\t${this.getInnerCounter(count)}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$counter;\n\t}\n\n\tgetInnerCounter(counter: number)\n\t{\n\t\tif (!this.$innerContainer)\n\t\t{\n\t\t\tthis.$innerContainer = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-num-text --stop --without-animate\">${counter}</div>\t\t\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$innerContainer;\n\t}\n\n\tanimateCounter(start, value)\n\t{\n\t\tif (start > 99 && value > 99)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (value > 99)\n\t\t{\n\t\t\tvalue = '99+';\n\t\t}\n\n\t\tif (start > 99)\n\t\t{\n\t\t\tstart = 99;\n\t\t}\n\n\t\tif (value === 0)\n\t\t{\n\t\t\tthis.getContainer().classList.add('--fade');\n\t\t}\n\n\t\tif (value > 0)\n\t\t{\n\t\t\tthis.getContainer().classList.remove('--fade');\n\t\t}\n\n\t\tDom.clean(this.getCounter());\n\t\tthis.getInnerCounter().innerHTML = value;\n\t\tthis.getCounter().appendChild(this.getInnerCounter());\n\t\tthis.getCounter().classList.remove('--update');\n\t\tthis.getCounter().classList.remove('--update-multi');\n\t}\n\n\tgetCounterColor()\n\t{\n\t\tif (!this.color)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn `--${this.color}`;\n\t}\n\n\tupdateCount(param: number)\n\t{\n\t\tif(this.count === param)\n\t\t\treturn;\n\n\t\tthis.animateCounter(this.count, param);\n\n\t\tthis.count = param;\n\t}\n\n\tgetRemove()\n\t{\n\t\tif(!this.$remove)\n\t\t{\n\t\t\tthis.$remove = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-remove\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$remove;\n\t}\n\n\tfade()\n\t{\n\t\tthis.getContainer().classList.add('--fade');\n\t}\n\n\tunFade()\n\t{\n\t\tthis.getContainer().classList.remove('--fade');\n\t}\n\n\tactive(node: HTMLElement)\n\t{\n\t\tconst targetNode = Type.isDomNode(node) ? node : this.getContainer();\n\t\ttargetNode.classList.add('--hover');\n\t\tEventEmitter.emit('BX.Tasks.Counters:active', this);\n\t}\n\n\tunActive(node: HTMLElement)\n\t{\n\t\tconst targetNode = Type.isDomNode(node) ? node : this.getContainer();\n\t\ttargetNode.classList.remove('--hover');\n\t\tEventEmitter.emit('BX.Tasks.Counters:unActive', this);\n\t}\n\n\tadjustClick()\n\t{\n\t\tEventEmitter.emit('Tasks.Toolbar:onItem', {counter: this});\n\n\t\tthis.$container.classList.contains('--hover')\n\t\t\t? this.unActive()\n\t\t\t: this.active()\n\t\t;\n\t}\n\n\tgetPopupMenuItemContainer()\n\t{\n\t\tconst title = Loc.getMessage('TASKS_COUNTER_OTHER_TASKS').replace('#TITLE#', this.name.toLowerCase());\n\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"task-counters--popup-item\">\n\t\t\t\t\t<span class=\"tasks-counters--item-counter-num ${this.getCounterColor()}\">${this.count}</span>\n\t\t\t\t\t<span class=\"task-counters--popup-item-text\">${title}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetContainer(param): HTMLElement\n\t{\n\t\tif(!this.$container)\n\t\t{\n\t\t\tthis.$container = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter ${Number(this.count) === 0 ? ' --fade' : ''}\">\n\t\t\t\t\t<div class=\"tasks-counters--item-counter-wrapper\">\n\t\t\t\t\t\t${this.getCounter()}\n\t\t\t\t\t\t<div class=\"tasks-counters--item-counter-title\">${this.name}</div>\n\t\t\t\t\t\t${this.getRemove()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (this.filter.isFilteredByFieldValue(this.filterField, this.filterValue))\n\t\t\t{\n\t\t\t\tthis.active(this.$container);\n\t\t\t}\n\n\t\t\tEvent.bind(this.$container, 'click', this.adjustClick.bind(this));\n\t\t}\n\n\t\treturn this.$container;\n\t}\n}","import {Tag, Event, Loc, ajax as Ajax, Dom} from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Menu, MenuItem } from 'main.popup';\nimport { Filter } from './counters-helper';\nimport CountersItem from './counters-item';\nimport { Controller as Viewed } from 'tasks.viewed';\n\nimport 'ui.fonts.opensans';\nimport './style.css';\n\nexport class Counters\n{\n\tstatic get counterTypes()\n\t{\n\t\treturn {\n\t\t\tmy: [\n\t\t\t\t'expired',\n\t\t\t\t'my_expired',\n\t\t\t\t'originator_expired',\n\t\t\t\t'accomplices_expired',\n\t\t\t\t'auditor_expired',\n\t\t\t\t'new_comments',\n\t\t\t\t'my_new_comments',\n\t\t\t\t'originator_new_comments',\n\t\t\t\t'accomplices_new_comments',\n\t\t\t\t'auditor_new_comments',\n\t\t\t\t'projects_total_expired',\n\t\t\t\t'projects_total_comments',\n\t\t\t\t'sonet_total_expired',\n\t\t\t\t'sonet_total_comments',\n\t\t\t\t'groups_total_expired',\n\t\t\t\t'groups_total_comments',\n\t\t\t\t'scrum_total_comments'\n\t\t\t],\n\t\t\tother: [\n\t\t\t\t'project_expired',\n\t\t\t\t'project_comments',\n\t\t\t\t'projects_foreign_expired',\n\t\t\t\t'projects_foreign_comments',\n\t\t\t\t'groups_foreign_expired',\n\t\t\t\t'groups_foreign_comments',\n\t\t\t\t'sonet_foreign_expired',\n\t\t\t\t'sonet_foreign_comments',\n\t\t\t\t'scrum_foreign_comments'\n\t\t\t],\n\t\t\tadditional: [\n\t\t\t\t'muted_new_comments',\n\t\t\t],\n\t\t\texpired: [\n\t\t\t\t'expired',\n\t\t\t\t'my_expired',\n\t\t\t\t'originator_expired',\n\t\t\t\t'accomplices_expired',\n\t\t\t\t'auditor_expired',\n\t\t\t\t'project_expired',\n\t\t\t\t'projects_total_expired',\n\t\t\t\t'projects_foreign_expired',\n\t\t\t\t'groups_total_expired',\n\t\t\t\t'groups_foreign_expired',\n\t\t\t\t'sonet_total_expired',\n\t\t\t\t'sonet_foreign_expired',\n\t\t\t],\n\t\t\tcomment: [\n\t\t\t\t'new_comments',\n\t\t\t\t'my_new_comments',\n\t\t\t\t'originator_new_comments',\n\t\t\t\t'accomplices_new_comments',\n\t\t\t\t'auditor_new_comments',\n\t\t\t\t'muted_new_comments',\n\t\t\t\t'project_comments',\n\t\t\t\t'projects_total_comments',\n\t\t\t\t'projects_foreign_comments',\n\t\t\t\t'groups_total_comments',\n\t\t\t\t'groups_foreign_comments',\n\t\t\t\t'sonet_total_comments',\n\t\t\t\t'sonet_foreign_comments',\n\t\t\t\t'scrum_total_comments',\n\t\t\t\t'scrum_foreign_comments'\n\t\t\t],\n\t\t};\n\t}\n\n\tstatic updateTimeout = false;\n\tstatic needUpdate = false;\n\n\tstatic timeoutTTL = 5000;\n\n\tconstructor(options)\n\t{\n\t\tthis.userId = options.userId;\n\t\tthis.targetUserId = options.targetUserId;\n\t\tthis.groupId = options.groupId;\n\t\tthis.counters = options.counters;\n\t\tthis.initialCounterTypes = options.counterTypes;\n\t\tthis.renderTo = options.renderTo;\n\t\tthis.role = options.role;\n\t\tthis.signedParameters = options.signedParameters;\n\n\t\tthis.popupMenu = null;\n\n\t\tthis.$readAll = {\n\t\t\tcropped: null,\n\t\t\tlayout: null\n\t\t};\n\t\tthis.$more = null;\n\t\tthis.$moreArrow = null;\n\t\tthis.$other = {\n\t\t\tcropped: null,\n\t\t\tlayout: null\n\t\t};\n\t\tthis.$myTaskHead = null;\n\n\t\tthis.filter = new Filter({filterId: options.filterId});\n\n\t\tthis.bindEvents();\n\t\tthis.setData(this.counters);\n\n\t\tthis.initPull();\n\t}\n\n\tisMyTaskList()\n\t{\n\t\treturn this.userId === this.targetUserId;\n\t}\n\n\tisUserTaskList()\n\t{\n\t\treturn (Object.keys(this.otherCounters).length === 0);\n\t}\n\n\tisProjectsTaskList()\n\t{\n\t\treturn this.groupId > 0;\n\t}\n\n\tisProjectList()\n\t{\n\t\treturn !this.isUserTaskList() && !this.isProjectsTaskList();\n\t}\n\n\tinitPull()\n\t{\n\t\tBX.PULL.subscribe({\n\t\t\tmoduleId: 'tasks',\n\t\t\tcallback: data => this.processPullEvent(data),\n\t\t});\n\n\t\tthis.extendWatch();\n\t}\n\n\textendWatch()\n\t{\n\t\tif (this.isProjectsTaskList() || this.isProjectList())\n\t\t{\n\t\t\tlet tagId = 'TASKS_PROJECTS';\n\n\t\t\tif (this.isProjectsTaskList())\n\t\t\t{\n\t\t\t\ttagId = `TASKS_PROJECTS_${this.groupId}`;\n\t\t\t}\n\n\t\t\tBX.PULL.extendWatch(tagId, true);\n\t\t\tsetTimeout(() => this.extendWatch(), 29 * 60 * 1000);\n\t\t}\n\t}\n\n\tprocessPullEvent(data)\n\t{\n\t\tconst eventHandlers = {\n\t\t\tuser_counter: this.onUserCounter.bind(this),\n\t\t\tproject_counter: this.onProjectCounter.bind(this),\n\t\t};\n\t\tconst has = Object.prototype.hasOwnProperty;\n\t\tconst {command, params} = data;\n\t\tif (has.call(eventHandlers, command))\n\t\t{\n\t\t\tconst method = eventHandlers[command];\n\t\t\tif (method)\n\t\t\t{\n\t\t\t\tmethod.apply(this, [params]);\n\t\t\t}\n\t\t}\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t}\n\n\tonFilterApply()\n\t{\n\t\tthis.filter.updateFields();\n\n\t\tif (this.isRoleChanged())\n\t\t{\n\t\t\tthis.updateRole();\n\t\t\tthis.updateCountersData();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst counters = {...this.myCounters, ...this.otherCounters};\n\t\t\tObject.values(counters).forEach((counter) => {\n\t\t\t\tif (counter)\n\t\t\t\t{\n\t\t\t\t\tthis.filter.isFilteredByFieldValue(counter.filterField, counter.filterValue)\n\t\t\t\t\t\t? counter.active()\n\t\t\t\t\t\t: counter.unActive()\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tupdateCountersData()\n\t{\n\t\tif (Counters.updateTimeout)\n\t\t{\n\t\t\tCounters.needUpdate = true;\n\t\t\treturn;\n\t\t}\n\n\t\tCounters.updateTimeout = true;\n\t\tCounters.needUpdate = false;\n\n\t\tAjax.runComponentAction('bitrix:tasks.interface.counters', 'getCounters', {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\trole: this.role,\n\t\t\t\tcounters: this.initialCounterTypes,\n\t\t\t},\n\t\t\tsignedParameters: this.signedParameters,\n\t\t}).then(\n\t\t\tresponse => this.rerender(response.data),\n\t\t\tresponse => console.log(response)\n\t\t);\n\n\t\tsetTimeout(function() {\n\t\t\tCounters.updateTimeout = false;\n\t\t\tif (Counters.needUpdate)\n\t\t\t{\n\t\t\t\tthis.updateCountersData();\n\t\t\t}\n\t\t}.bind(this), Counters.timeoutTTL);\n\t}\n\n\tisRoleChanged()\n\t{\n\t\treturn this.role !== (this.filter.isFilteredByField('ROLEID') ? this.filter.fields.ROLEID : 'view_all');\n\t}\n\n\tupdateRole()\n\t{\n\t\tthis.role = (this.filter.isFilteredByField('ROLEID') ? this.filter.fields.ROLEID : 'view_all');\n\t}\n\n\tonUserCounter(data)\n\t{\n\t\tconst has = Object.prototype.hasOwnProperty;\n\t\tif (\n\t\t\t!this.isUserTaskList()\n\t\t\t|| !this.isMyTaskList()\n\t\t\t|| !has.call(data, this.groupId)\n\t\t\t|| this.userId !== Number(data.userId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet newCommentsCount = 0;\n\n\t\tObject.entries(data[this.groupId][this.role]).forEach(([type, value]) => {\n\t\t\tif (this.myCounters[type])\n\t\t\t{\n\t\t\t\tthis.myCounters[type].updateCount(value);\n\n\t\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t\t{\n\t\t\t\t\tnewCommentsCount += value;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.additionalCounters[type] && Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tnewCommentsCount += value;\n\t\t\t}\n\t\t});\n\n\t\tif (newCommentsCount > 0)\n\t\t{\n\t\t\tthis.$readAllInner.classList.remove('--fade');\n\t\t}\n\t}\n\n\tonProjectCounter(data)\n\t{\n\t\tif (this.isUserTaskList())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateCountersData();\n\t}\n\n\tgetCounterItem(param: Object): Object\n\t{\n\t\treturn new CountersItem({\n\t\t\tcount: param.count,\n\t\t\tname: param.name,\n\t\t\ttype: param.type,\n\t\t\tcolor: param.color,\n\t\t\tfilterField: param.filterField,\n\t\t\tfilterValue: param.filterValue,\n\t\t\tfilter: this.filter,\n\t\t});\n\t}\n\n\tgetCounterNameByType(type: String)\n\t{\n\t\tif (Counters.counterTypes.expired.includes(type))\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_COUNTER_EXPIRED');\n\t\t}\n\t\telse if (Counters.counterTypes.comment.includes(type))\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_COUNTER_NEW_COMMENTS');\n\t\t}\n\t}\n\n\tsetData(counters)\n\t{\n\t\tthis.myCounters = {};\n\t\tthis.otherCounters = {};\n\t\tthis.additionalCounters = {};\n\n\t\tconst availableTypes = [\n\t\t\t...Counters.counterTypes.additional,\n\t\t\t...Counters.counterTypes.my,\n\t\t\t...Counters.counterTypes.other\n\t\t];\n\n\t\tObject.entries(counters).forEach(([type, data]) => {\n\t\t\tif (!availableTypes.includes(type))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst counterItem = this.getCounterItem({\n\t\t\t\ttype,\n\t\t\t\tname: this.getCounterNameByType(type),\n\t\t\t\tcount: Number(data.VALUE),\n\t\t\t\tcolor: data.STYLE,\n\t\t\t\tfilterField: data.FILTER_FIELD,\n\t\t\t\tfilterValue: data.FILTER_VALUE,\n\t\t\t});\n\n\t\t\tif (Counters.counterTypes.additional.includes(type))\n\t\t\t{\n\t\t\t\tthis.additionalCounters[type] = counterItem;\n\t\t\t}\n\t\t\telse if (Counters.counterTypes.my.includes(type))\n\t\t\t{\n\t\t\t\tthis.myCounters[type] = counterItem;\n\t\t\t}\n\t\t\telse if (Counters.counterTypes.other.includes(type))\n\t\t\t{\n\t\t\t\tthis.otherCounters[type] = counterItem;\n\t\t\t}\n\t\t});\n\t}\n\n\tisCroppedBlock(node: HTMLElement)\n\t{\n\t\tif(node)\n\t\t\treturn node.classList.contains('--cropp');\n\t}\n\n\tgetReadAllBlock(): HTMLElement\n\t{\n\t\tconst counters = {...this.myCounters, ...this.otherCounters, ...this.additionalCounters};\n\t\tlet newCommentsCount = 0;\n\n\t\tObject.entries(counters).forEach(([type, counter]) => {\n\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tnewCommentsCount += counter.count;\n\t\t\t}\n\t\t});\n\n\t\tthis.$readAllInner = Tag.render`\n\t\t\t<div data-role=\"tasks-counters--item-head-read-all\" class=\"tasks-counters--item-head\n\t\t\t\t\t\t${newCommentsCount === 0 ? '--fade' : ''} \n\t\t\t\t\t\t--action \n\t\t\t\t\t\t--read-all\">\n\t\t\t\t<div class=\"tasks-counters--item-head-read-all--icon\"></div>\n\t\t\t\t<div class=\"tasks-counters--item-head-read-all--text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_COUNTER_READ_ALL')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tlet readAllClick = this.readAllForProjects.bind(this);\n\t\tif (\n\t\t\tthis.isUserTaskList()\n\t\t\t|| (this.isProjectsTaskList() && this.role !== 'view_all')\n\t\t)\n\t\t{\n\t\t\treadAllClick = this.readAllByRole.bind(this);\n\t\t}\n\t\telse if (\n\t\t\tthis.myCounters['scrum_total_comments']\n\t\t\t|| this.otherCounters['scrum_foreign_comments']\n\t\t)\n\t\t{\n\t\t\treadAllClick = this.readAllForScrum.bind(this);\n\t\t}\n\n\t\tEvent.bind(this.$readAllInner, 'click', readAllClick);\n\t\tEvent.bind(this.$readAllInner, 'click', () => this.$readAllInner.classList.add('--fade'));\n\n\t\tthis.$readAll.layout = Tag.render`\n\t\t\t<div class=\"tasks-counters--item\">${this.$readAllInner}</div>\n\t\t`;\n\n\t\treturn this.$readAll.layout;\n\t}\n\n\treadAllByRole()\n\t{\n\t\t(new Viewed()).userComments({\n\t\t\tgroupId: this.groupId,\n\t\t\tuserId: this.userId,\n\t\t\trole: this.role,\n\t\t});\n\t}\n\n\treadAllForProjects()\n\t{\n\t\tconst allCounters = {...this.myCounters, ...this.otherCounters};\n\t\tObject.entries(allCounters).forEach(([type, counter]) => {\n\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tcounter.updateCount(0);\n\t\t\t}\n\t\t});\n\n\t\t(new Viewed()).projectComments({\n\t\t\tgroupId: this.groupId,\n\t\t});\n\t}\n\n\treadAllForScrum()\n\t{\n\t\tconst allCounters = {...this.myCounters, ...this.otherCounters};\n\t\tObject.entries(allCounters).forEach(([type, counter]) => {\n\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tcounter.updateCount(0);\n\t\t\t}\n\t\t});\n\n\t\t(new Viewed()).scrumComments({\n\t\t\tgroupId: this.groupId,\n\t\t});\n\t}\n\n\tgetPopup()\n\t{\n\t\tconst itemsNode = [];\n\n\t\tObject.values(this.otherCounters).forEach((counter) => {\n\t\t\tconst menuItem = new MenuItem({\n\t\t\t\thtml: counter.getPopupMenuItemContainer().innerHTML,\n\t\t\t});\n\t\t\tmenuItem.onclick = this.onPopupItemClick.bind(this, menuItem, counter);\n\n\t\t\titemsNode.push(menuItem);\n\t\t});\n\n\t\tthis.popupMenu = new Menu({\n\t\t\tbindElement: this.$moreArrow,\n\t\t\tclassName: 'tasks-counters--scope',\n\t\t\tangle: {\n\t\t\t\toffset: 96,\n\t\t\t},\n\t\t\tautoHide: true,\n\t\t\tcloseEsc: true,\n\t\t\toffsetTop: 5,\n\t\t\toffsetLeft: -67,\n\t\t\tanimation: 'fading-slide',\n\t\t\titems: itemsNode,\n\t\t\tevents: {\n\t\t\t\tonPopupShow: () => this.$more.classList.add('--hover'),\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.$more.classList.remove('--hover');\n\t\t\t\t\tthis.popupMenu.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn this.popupMenu;\n\t}\n\n\tonPopupItemClick(item, counter)\n\t{\n\t\tcounter.adjustClick();\n\t\tthis.popupMenu.close();\n\t}\n\n\tgetMoreArrow()\n\t{\n\t\tif(!this.$moreArrow)\n\t\t{\n\t\t\tthis.$moreArrow = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-arrow\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$moreArrow;\n\t}\n\n\tgetMore()\n\t{\n\t\tlet value = 0;\n\n\t\tObject.values(this.otherCounters).forEach((counter) => {\n\t\t\tvalue += Number(counter.count);\n\t\t});\n\n\t\tconst count = value > 99\n\t\t\t? '99+'\n\t\t\t: value;\n\n\t\tthis.$moreArrow = Tag.render`\n\t\t\t<div class=\"tasks-counters--item-counter-arrow\"></div>\n\t\t`;\n\n\t\tthis.$more = Tag.render`\n\t\t\t<div class=\"tasks-counters--item-counter--more\">\n\t\t\t\t<div class=\"tasks-counters--item-counter-wrapper\">\n\t\t\t\t\t<div class=\"tasks-counters--item-counter-title\">${Loc.getMessage('TASKS_COUNTER_MORE')}:</div>\n\t\t\t\t\t<div class=\"tasks-counters--item-counter-num\">\n\t\t\t\t\t\t${this.getInnerCounter(count)}\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.$moreArrow}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.$more, 'click', ()=> this.getPopup().show());\n\n\t\treturn this.$more;\n\t}\n\n\tgetInnerCounter(counter: number)\n\t{\n\t\tif (!this.$innerContainer)\n\t\t{\n\t\t\tthis.$innerContainer = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-num-text --stop --without-animate\">${counter}</div>\t\t\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$innerContainer;\n\t}\n\n\tgetOther()\n\t{\n\t\tif (Object.keys(this.otherCounters).length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst content = [];\n\t\tObject.values(this.otherCounters).forEach(counter => content.push(counter.getContainer()));\n\n\t\tthis.$other.cropped = this.isCroppedBlock(this.$other.layout);\n\n\t\tthis.$other.layout = Tag.render`\n\t\t\t<div class=\"tasks-counters--item --other ${this.$other.cropped ? '--cropp' : ''}\">\n\t\t\t\t<div data-role=\"tasks-counters--item-head-other\" class=\"tasks-counters--item-head\">${Loc.getMessage('TASKS_COUNTER_OTHER')}</div>\n\t\t\t\t<div class=\"tasks-counters--item-content\">\n\t\t\t\t\t${content}\n\t\t\t\t\t${this.getMore()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.$other.layout;\n\t}\n\n\tgetContainer()\n\t{\n\t\tconst content = [];\n\t\tObject.values(this.myCounters).forEach(counter => content.push(counter.getContainer()));\n\n\t\tthis.$myTaskHead = Tag.render`\n\t\t\t<div class=\"tasks-counters--item-head\">\n\t\t\t\t${Loc.getMessage('TASKS_COUNTER_MY')}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.$element = Tag.render`\n\t\t\t<div class=\"tasks-counters tasks-counters--scope\">\n\t\t\t\t<div class=\"tasks-counters--item\">\n\t\t\t\t\t${this.$myTaskHead}\n\t\t\t\t\t<div class=\"tasks-counters--item-content\">${content}</div>\n\t\t\t\t</div>\n\t\t\t\t${this.getOther()}\n\t\t\t\t${this.isUserTaskList() && !this.isMyTaskList() ? '' : this.getReadAllBlock()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.$element;\n\t}\n\n\trerender(counters)\n\t{\n\t\tthis.setData(counters);\n\t\tthis.render();\n\t}\n\n\trender()\n\t{\n\t\tlet node = this.getContainer();\n\t\tlet fakeNode = node.cloneNode(true);\n\t\tfakeNode.classList.add('task-interface-toolbar');\n\t\tfakeNode.style.position = 'fixed';\n\t\tfakeNode.style.opacity = '0';\n\t\tfakeNode.style.width = 'auto';\n\t\tfakeNode.style.pointerEvents = 'none';\n\t\tdocument.body.appendChild(fakeNode);\n\t\tthis.nodeWidth = fakeNode.offsetWidth;\n\t\tdocument.body.removeChild(fakeNode);\n\n\t\tDom.replace(this.renderTo.firstChild, node);\n\t}\n}\n"],"names":["Filter","options","filterId","filterManager","BX","Main","getById","bindEvents","updateFields","EventEmitter","subscribe","onFilterApply","bind","fields","getFilterFieldsValues","field","Object","keys","includes","Type","isArray","length","value","isFilteredByField","name","isFilteredByFieldValue","getApi","extendFilter","COUNTER_TYPE","getFilterFields","forEach","getAttribute","getFields","deleteField","getSearch","apply","CountersItem","count","type","color","filterField","filterValue","filter","$container","$innerContainer","$remove","$counter","param","data","unActive","Tag","render","getCounterColor","getInnerCounter","counter","start","getContainer","classList","add","remove","Dom","clean","getCounter","innerHTML","appendChild","animateCounter","node","targetNode","isDomNode","emit","contains","active","title","Loc","getMessage","replace","toLowerCase","Number","getRemove","Event","adjustClick","Counters","my","other","additional","expired","comment","userId","targetUserId","groupId","counters","initialCounterTypes","counterTypes","renderTo","role","signedParameters","popupMenu","$readAll","cropped","layout","$more","$moreArrow","$other","$myTaskHead","setData","initPull","otherCounters","isUserTaskList","isProjectsTaskList","PULL","moduleId","callback","processPullEvent","extendWatch","isProjectList","tagId","setTimeout","eventHandlers","user_counter","onUserCounter","project_counter","onProjectCounter","has","prototype","hasOwnProperty","command","params","call","method","isRoleChanged","updateRole","updateCountersData","myCounters","values","updateTimeout","needUpdate","Ajax","runComponentAction","mode","then","response","rerender","console","log","timeoutTTL","ROLEID","isMyTaskList","newCommentsCount","entries","updateCount","additionalCounters","$readAllInner","availableTypes","counterItem","getCounterItem","getCounterNameByType","VALUE","STYLE","FILTER_FIELD","FILTER_VALUE","readAllClick","readAllForProjects","readAllByRole","readAllForScrum","Viewed","userComments","allCounters","projectComments","scrumComments","itemsNode","menuItem","MenuItem","html","getPopupMenuItemContainer","onclick","onPopupItemClick","push","Menu","bindElement","className","angle","offset","autoHide","closeEsc","offsetTop","offsetLeft","animation","items","events","onPopupShow","onPopupClose","destroy","item","close","getPopup","show","content","isCroppedBlock","getMore","$element","getOther","getReadAllBlock","fakeNode","cloneNode","style","position","opacity","width","pointerEvents","document","body","nodeWidth","offsetWidth","removeChild","firstChild"],"mappings":"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"}