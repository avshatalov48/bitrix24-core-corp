{"version":3,"file":"script.js","sources":["src/counters-helper.js","src/counters-item.js","src/entry.js"],"sourcesContent":["import {Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nclass Filter\n{\n\tconstructor(options)\n\t{\n\t\tthis.filterId = options.filterId;\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\n\t\tthis.bindEvents();\n\t\tthis.updateFields();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t}\n\n\tonFilterApply()\n\t{\n\t\tthis.updateFields();\n\t}\n\n\tupdateFields()\n\t{\n\t\tthis.fields = this.filterManager.getFilterFieldsValues();\n\t}\n\n\tisFilteredByField(field)\n\t{\n\t\tif (!Object.keys(this.fields).includes(field))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Type.isArray(this.fields[field]))\n\t\t{\n\t\t\treturn this.fields[field].length > 0;\n\t\t}\n\n\t\treturn this.fields[field] !== '';\n\t}\n\n\tisFilteredByFieldValue(field, value)\n\t{\n\t\treturn this.isFilteredByField(field) && this.fields[field] === value;\n\t}\n\n\ttoggleByField(field)\n\t{\n\t\tconst name = Object.keys(field)[0];\n\t\tconst value = field[name];\n\n\t\tif (!this.isFilteredByFieldValue(name, value))\n\t\t{\n\t\t\tthis.filterManager.getApi().extendFilter(\n\t\t\t\t{[name]: value},\n\t\t\t\tfalse,\n\t\t\t\t{COUNTER_TYPE: 'TASKS_COUNTER_TYPE_' + value}\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.filterManager.getFilterFields().forEach((field) => {\n\t\t\tif (field.getAttribute('data-name') === name)\n\t\t\t{\n\t\t\t\tthis.filterManager.getFields().deleteField(field);\n\t\t\t}\n\t\t});\n\n\t\tthis.filterManager.getSearch().apply();\n\t}\n\n\tgetFilter()\n\t{\n\t\treturn this.filterManager;\n\t}\n}\n\nexport {\n\tFilter\n}","import { Tag, Event, Type, Loc, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport default class CountersItem\n{\n\tconstructor(options)\n\t{\n\t\tthis.count = options.count;\n\t\tthis.name = options.name;\n\t\tthis.type = options.type;\n\t\tthis.color = options.color;\n\t\tthis.filterField = options.filterField;\n\t\tthis.filterValue = options.filterValue;\n\t\tthis.filter = options.filter;\n\n\t\tthis.$container = null;\n\t\tthis.$innerContainer = null;\n\t\tthis.$remove = null;\n\t\tthis.$counter = null;\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Tasks.Counters:active', (param)=> {\n\t\t\tthis !== param.data ? this.unActive() : null;\n\t\t});\n\t}\n\n\tgetCounter()\n\t{\n\t\tif (!this.$counter)\n\t\t{\n\t\t\tconst count = this.count > 99 ? '99+' : this.count;\n\t\t\tthis.$counter = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-num ${this.getCounterColor()}\">\n\t\t\t\t\t${this.getInnerCounter(count)}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$counter;\n\t}\n\n\tgetInnerCounter(counter: number)\n\t{\n\t\tif (!this.$innerContainer)\n\t\t{\n\t\t\tthis.$innerContainer = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-num-text --stop --without-animate\">${counter}</div>\t\t\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$innerContainer;\n\t}\n\n\tanimateCounter(start, value)\n\t{\n\t\tif (start > 99 && value > 99)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (value > 99)\n\t\t{\n\t\t\tvalue = '99+';\n\t\t}\n\n\t\tif (start > 99)\n\t\t{\n\t\t\tstart = 99;\n\t\t}\n\n\t\tif (value === 0)\n\t\t{\n\t\t\tthis.getContainer().classList.add('--fade');\n\t\t}\n\n\t\tif (value > 0)\n\t\t{\n\t\t\tthis.getContainer().classList.remove('--fade');\n\t\t}\n\n\t\tDom.clean(this.getCounter());\n\t\tthis.getInnerCounter().innerHTML = value;\n\t\tthis.getCounter().appendChild(this.getInnerCounter());\n\t\tthis.getCounter().classList.remove('--update');\n\t\tthis.getCounter().classList.remove('--update-multi');\n\t}\n\n\tgetCounterColor()\n\t{\n\t\tif (!this.color)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn `--${this.color}`;\n\t}\n\n\tupdateCount(param: number)\n\t{\n\t\tif(this.count === param)\n\t\t\treturn;\n\n\t\tthis.animateCounter(this.count, param);\n\n\t\tthis.count = param;\n\t}\n\n\tgetRemove()\n\t{\n\t\tif(!this.$remove)\n\t\t{\n\t\t\tthis.$remove = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-remove\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$remove;\n\t}\n\n\tfade()\n\t{\n\t\tthis.getContainer().classList.add('--fade');\n\t}\n\n\tunFade()\n\t{\n\t\tthis.getContainer().classList.remove('--fade');\n\t}\n\n\tactive(node: HTMLElement)\n\t{\n\t\tconst targetNode = Type.isDomNode(node) ? node : this.getContainer();\n\t\ttargetNode.classList.add('--hover');\n\t\tEventEmitter.emit('BX.Tasks.Counters:active', this);\n\t}\n\n\tunActive(node: HTMLElement)\n\t{\n\t\tconst targetNode = Type.isDomNode(node) ? node : this.getContainer();\n\t\ttargetNode.classList.remove('--hover');\n\t\tEventEmitter.emit('BX.Tasks.Counters:unActive', this);\n\t}\n\n\tadjustClick()\n\t{\n\t\tEventEmitter.emit('Tasks.Toolbar:onItem', {counter: this});\n\n\t\tthis.$container.classList.contains('--hover')\n\t\t\t? this.unActive()\n\t\t\t: this.active()\n\t\t;\n\t}\n\n\tgetPopupMenuItemContainer()\n\t{\n\t\tconst title = Loc.getMessage('TASKS_COUNTER_OTHER_TASKS').replace('#TITLE#', this.name.toLowerCase());\n\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"task-counters--popup-item\">\n\t\t\t\t\t<span class=\"tasks-counters--item-counter-num ${this.getCounterColor()}\">${this.count}</span>\n\t\t\t\t\t<span class=\"task-counters--popup-item-text\">${title}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetContainer(param): HTMLElement\n\t{\n\t\tif(!this.$container)\n\t\t{\n\t\t\tthis.$container = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter ${Number(this.count) === 0 ? ' --fade' : ''}\">\n\t\t\t\t\t<div class=\"tasks-counters--item-counter-wrapper\">\n\t\t\t\t\t\t${this.getCounter()}\n\t\t\t\t\t\t<div class=\"tasks-counters--item-counter-title\">${this.name}</div>\n\t\t\t\t\t\t${this.getRemove()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (this.filter.isFilteredByFieldValue(this.filterField, this.filterValue))\n\t\t\t{\n\t\t\t\tthis.active(this.$container);\n\t\t\t}\n\n\t\t\tEvent.bind(this.$container, 'click', this.adjustClick.bind(this));\n\t\t}\n\n\t\treturn this.$container;\n\t}\n}","import {Tag, Event, Loc, ajax as Ajax, Dom} from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Menu, MenuItem } from 'main.popup';\nimport { Filter } from './counters-helper';\nimport CountersItem from './counters-item';\nimport { Controller as Viewed } from 'tasks.viewed';\n\nimport 'ui.fonts.opensans';\nimport './style.css';\n\nexport class Counters\n{\n\tstatic get counterTypes()\n\t{\n\t\treturn {\n\t\t\tmy: [\n\t\t\t\t'expired',\n\t\t\t\t'my_expired',\n\t\t\t\t'originator_expired',\n\t\t\t\t'accomplices_expired',\n\t\t\t\t'auditor_expired',\n\t\t\t\t'new_comments',\n\t\t\t\t'my_new_comments',\n\t\t\t\t'originator_new_comments',\n\t\t\t\t'accomplices_new_comments',\n\t\t\t\t'auditor_new_comments',\n\t\t\t\t'projects_total_expired',\n\t\t\t\t'projects_total_comments',\n\t\t\t\t'sonet_total_expired',\n\t\t\t\t'sonet_total_comments',\n\t\t\t\t'groups_total_expired',\n\t\t\t\t'groups_total_comments',\n\t\t\t\t'scrum_total_comments'\n\t\t\t],\n\t\t\tother: [\n\t\t\t\t'project_expired',\n\t\t\t\t'project_comments',\n\t\t\t\t'projects_foreign_expired',\n\t\t\t\t'projects_foreign_comments',\n\t\t\t\t'groups_foreign_expired',\n\t\t\t\t'groups_foreign_comments',\n\t\t\t\t'sonet_foreign_expired',\n\t\t\t\t'sonet_foreign_comments',\n\t\t\t\t'scrum_foreign_comments'\n\t\t\t],\n\t\t\tadditional: [\n\t\t\t\t'muted_new_comments',\n\t\t\t],\n\t\t\texpired: [\n\t\t\t\t'expired',\n\t\t\t\t'my_expired',\n\t\t\t\t'originator_expired',\n\t\t\t\t'accomplices_expired',\n\t\t\t\t'auditor_expired',\n\t\t\t\t'project_expired',\n\t\t\t\t'projects_total_expired',\n\t\t\t\t'projects_foreign_expired',\n\t\t\t\t'groups_total_expired',\n\t\t\t\t'groups_foreign_expired',\n\t\t\t\t'sonet_total_expired',\n\t\t\t\t'sonet_foreign_expired',\n\t\t\t],\n\t\t\tcomment: [\n\t\t\t\t'new_comments',\n\t\t\t\t'my_new_comments',\n\t\t\t\t'originator_new_comments',\n\t\t\t\t'accomplices_new_comments',\n\t\t\t\t'auditor_new_comments',\n\t\t\t\t'muted_new_comments',\n\t\t\t\t'project_comments',\n\t\t\t\t'projects_total_comments',\n\t\t\t\t'projects_foreign_comments',\n\t\t\t\t'groups_total_comments',\n\t\t\t\t'groups_foreign_comments',\n\t\t\t\t'sonet_total_comments',\n\t\t\t\t'sonet_foreign_comments',\n\t\t\t\t'scrum_total_comments',\n\t\t\t\t'scrum_foreign_comments'\n\t\t\t],\n\t\t};\n\t}\n\n\tstatic updateTimeout = false;\n\tstatic needUpdate = false;\n\n\tstatic timeoutTTL = 5000;\n\n\tconstructor(options)\n\t{\n\t\tthis.userId = options.userId;\n\t\tthis.targetUserId = options.targetUserId;\n\t\tthis.groupId = options.groupId;\n\t\tthis.counters = options.counters;\n\t\tthis.initialCounterTypes = options.counterTypes;\n\t\tthis.renderTo = options.renderTo;\n\t\tthis.role = options.role;\n\t\tthis.signedParameters = options.signedParameters;\n\n\t\tthis.popupMenu = null;\n\n\t\tthis.$readAll = {\n\t\t\tcropped: null,\n\t\t\tlayout: null\n\t\t};\n\t\tthis.$more = null;\n\t\tthis.$moreArrow = null;\n\t\tthis.$other = {\n\t\t\tcropped: null,\n\t\t\tlayout: null\n\t\t};\n\t\tthis.$myTaskHead = null;\n\n\t\tthis.filter = new Filter({filterId: options.filterId});\n\n\t\tthis.bindEvents();\n\t\tthis.setData(this.counters);\n\n\t\tthis.initPull();\n\t}\n\n\tisMyTaskList()\n\t{\n\t\treturn this.userId === this.targetUserId;\n\t}\n\n\tisUserTaskList()\n\t{\n\t\treturn (Object.keys(this.otherCounters).length === 0);\n\t}\n\n\tisProjectsTaskList()\n\t{\n\t\treturn this.groupId > 0;\n\t}\n\n\tisProjectList()\n\t{\n\t\treturn !this.isUserTaskList() && !this.isProjectsTaskList();\n\t}\n\n\tinitPull()\n\t{\n\t\tBX.PULL.subscribe({\n\t\t\tmoduleId: 'tasks',\n\t\t\tcallback: data => this.processPullEvent(data),\n\t\t});\n\n\t\tthis.extendWatch();\n\t}\n\n\textendWatch()\n\t{\n\t\tif (this.isProjectsTaskList() || this.isProjectList())\n\t\t{\n\t\t\tlet tagId = 'TASKS_PROJECTS';\n\n\t\t\tif (this.isProjectsTaskList())\n\t\t\t{\n\t\t\t\ttagId = `TASKS_PROJECTS_${this.groupId}`;\n\t\t\t}\n\n\t\t\tBX.PULL.extendWatch(tagId, true);\n\t\t\tsetTimeout(() => this.extendWatch(), 29 * 60 * 1000);\n\t\t}\n\t}\n\n\tprocessPullEvent(data)\n\t{\n\t\tconst eventHandlers = {\n\t\t\tuser_counter: this.onUserCounter.bind(this),\n\t\t\tproject_counter: this.onProjectCounter.bind(this),\n\t\t};\n\t\tconst has = Object.prototype.hasOwnProperty;\n\t\tconst {command, params} = data;\n\t\tif (has.call(eventHandlers, command))\n\t\t{\n\t\t\tconst method = eventHandlers[command];\n\t\t\tif (method)\n\t\t\t{\n\t\t\t\tmethod.apply(this, [params]);\n\t\t\t}\n\t\t}\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t}\n\n\tonFilterApply()\n\t{\n\t\tthis.filter.updateFields();\n\n\t\tif (this.isRoleChanged())\n\t\t{\n\t\t\tthis.updateRole();\n\t\t\tthis.updateCountersData();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst counters = {...this.myCounters, ...this.otherCounters};\n\t\t\tObject.values(counters).forEach((counter) => {\n\t\t\t\tif (counter)\n\t\t\t\t{\n\t\t\t\t\tthis.filter.isFilteredByFieldValue(counter.filterField, counter.filterValue)\n\t\t\t\t\t\t? counter.active()\n\t\t\t\t\t\t: counter.unActive()\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tupdateCountersData()\n\t{\n\t\tif (Counters.updateTimeout)\n\t\t{\n\t\t\tCounters.needUpdate = true;\n\t\t\treturn;\n\t\t}\n\n\t\tCounters.updateTimeout = true;\n\t\tCounters.needUpdate = false;\n\n\t\tAjax.runComponentAction('bitrix:tasks.interface.counters', 'getCounters', {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\trole: this.role,\n\t\t\t\tcounters: this.initialCounterTypes,\n\t\t\t},\n\t\t\tsignedParameters: this.signedParameters,\n\t\t}).then(\n\t\t\tresponse => this.rerender(response.data),\n\t\t\tresponse => console.log(response)\n\t\t);\n\n\t\tsetTimeout(function() {\n\t\t\tCounters.updateTimeout = false;\n\t\t\tif (Counters.needUpdate)\n\t\t\t{\n\t\t\t\tthis.updateCountersData();\n\t\t\t}\n\t\t}.bind(this), Counters.timeoutTTL);\n\t}\n\n\tisRoleChanged()\n\t{\n\t\treturn this.role !== (this.filter.isFilteredByField('ROLEID') ? this.filter.fields.ROLEID : 'view_all');\n\t}\n\n\tupdateRole()\n\t{\n\t\tthis.role = (this.filter.isFilteredByField('ROLEID') ? this.filter.fields.ROLEID : 'view_all');\n\t}\n\n\tonUserCounter(data)\n\t{\n\t\tconst has = Object.prototype.hasOwnProperty;\n\t\tif (\n\t\t\t!this.isUserTaskList()\n\t\t\t|| !this.isMyTaskList()\n\t\t\t|| !has.call(data, this.groupId)\n\t\t\t|| this.userId !== Number(data.userId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet newCommentsCount = 0;\n\n\t\tObject.entries(data[this.groupId][this.role]).forEach(([type, value]) => {\n\t\t\tif (this.myCounters[type])\n\t\t\t{\n\t\t\t\tthis.myCounters[type].updateCount(value);\n\n\t\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t\t{\n\t\t\t\t\tnewCommentsCount += value;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.additionalCounters[type] && Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tnewCommentsCount += value;\n\t\t\t}\n\t\t});\n\n\t\tif (newCommentsCount > 0)\n\t\t{\n\t\t\tthis.$readAllInner.classList.remove('--fade');\n\t\t}\n\t}\n\n\tonProjectCounter(data)\n\t{\n\t\tif (this.isUserTaskList())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateCountersData();\n\t}\n\n\tgetCounterItem(param: Object): Object\n\t{\n\t\treturn new CountersItem({\n\t\t\tcount: param.count,\n\t\t\tname: param.name,\n\t\t\ttype: param.type,\n\t\t\tcolor: param.color,\n\t\t\tfilterField: param.filterField,\n\t\t\tfilterValue: param.filterValue,\n\t\t\tfilter: this.filter,\n\t\t});\n\t}\n\n\tgetCounterNameByType(type: String)\n\t{\n\t\tif (Counters.counterTypes.expired.includes(type))\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_COUNTER_EXPIRED');\n\t\t}\n\t\telse if (Counters.counterTypes.comment.includes(type))\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_COUNTER_NEW_COMMENTS');\n\t\t}\n\t}\n\n\tsetData(counters)\n\t{\n\t\tthis.myCounters = {};\n\t\tthis.otherCounters = {};\n\t\tthis.additionalCounters = {};\n\n\t\tconst availableTypes = [\n\t\t\t...Counters.counterTypes.additional,\n\t\t\t...Counters.counterTypes.my,\n\t\t\t...Counters.counterTypes.other\n\t\t];\n\n\t\tObject.entries(counters).forEach(([type, data]) => {\n\t\t\tif (!availableTypes.includes(type))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst counterItem = this.getCounterItem({\n\t\t\t\ttype,\n\t\t\t\tname: this.getCounterNameByType(type),\n\t\t\t\tcount: Number(data.VALUE),\n\t\t\t\tcolor: data.STYLE,\n\t\t\t\tfilterField: data.FILTER_FIELD,\n\t\t\t\tfilterValue: data.FILTER_VALUE,\n\t\t\t});\n\n\t\t\tif (Counters.counterTypes.additional.includes(type))\n\t\t\t{\n\t\t\t\tthis.additionalCounters[type] = counterItem;\n\t\t\t}\n\t\t\telse if (Counters.counterTypes.my.includes(type))\n\t\t\t{\n\t\t\t\tthis.myCounters[type] = counterItem;\n\t\t\t}\n\t\t\telse if (Counters.counterTypes.other.includes(type))\n\t\t\t{\n\t\t\t\tthis.otherCounters[type] = counterItem;\n\t\t\t}\n\t\t});\n\t}\n\n\tisCroppedBlock(node: HTMLElement)\n\t{\n\t\tif(node)\n\t\t\treturn node.classList.contains('--cropp');\n\t}\n\n\tgetReadAllBlock(): HTMLElement\n\t{\n\t\tconst counters = {...this.myCounters, ...this.otherCounters, ...this.additionalCounters};\n\t\tlet newCommentsCount = 0;\n\n\t\tObject.entries(counters).forEach(([type, counter]) => {\n\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tnewCommentsCount += counter.count;\n\t\t\t}\n\t\t});\n\n\t\tthis.$readAllInner = Tag.render`\n\t\t\t<div data-role=\"tasks-counters--item-head-read-all\" class=\"tasks-counters--item-head\n\t\t\t\t\t\t${newCommentsCount === 0 ? '--fade' : ''} \n\t\t\t\t\t\t--action \n\t\t\t\t\t\t--read-all\">\n\t\t\t\t<div class=\"tasks-counters--item-head-read-all--icon\"></div>\n\t\t\t\t<div class=\"tasks-counters--item-head-read-all--text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_COUNTER_READ_ALL')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tlet readAllClick = this.readAllForProjects.bind(this);\n\t\tif (\n\t\t\tthis.isUserTaskList()\n\t\t\t|| (this.isProjectsTaskList() && this.role !== 'view_all')\n\t\t)\n\t\t{\n\t\t\treadAllClick = this.readAllByRole.bind(this);\n\t\t}\n\t\telse if (\n\t\t\tthis.myCounters['scrum_total_comments']\n\t\t\t|| this.otherCounters['scrum_foreign_comments']\n\t\t)\n\t\t{\n\t\t\treadAllClick = this.readAllForScrum.bind(this);\n\t\t}\n\n\t\tEvent.bind(this.$readAllInner, 'click', readAllClick);\n\t\tEvent.bind(this.$readAllInner, 'click', () => this.$readAllInner.classList.add('--fade'));\n\n\t\tthis.$readAll.layout = Tag.render`\n\t\t\t<div class=\"tasks-counters--item\">${this.$readAllInner}</div>\n\t\t`;\n\n\t\treturn this.$readAll.layout;\n\t}\n\n\treadAllByRole()\n\t{\n\t\t(new Viewed()).userComments({\n\t\t\tgroupId: this.groupId,\n\t\t\tuserId: this.userId,\n\t\t\trole: this.role,\n\t\t});\n\t}\n\n\treadAllForProjects()\n\t{\n\t\tconst allCounters = {...this.myCounters, ...this.otherCounters};\n\t\tObject.entries(allCounters).forEach(([type, counter]) => {\n\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tcounter.updateCount(0);\n\t\t\t}\n\t\t});\n\n\t\t(new Viewed()).projectComments({\n\t\t\tgroupId: this.groupId,\n\t\t});\n\t}\n\n\treadAllForScrum()\n\t{\n\t\tconst allCounters = {...this.myCounters, ...this.otherCounters};\n\t\tObject.entries(allCounters).forEach(([type, counter]) => {\n\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tcounter.updateCount(0);\n\t\t\t}\n\t\t});\n\n\t\t(new Viewed()).scrumComments({\n\t\t\tgroupId: this.groupId,\n\t\t});\n\t}\n\n\tgetPopup()\n\t{\n\t\tconst itemsNode = [];\n\n\t\tObject.values(this.otherCounters).forEach((counter) => {\n\t\t\tconst menuItem = new MenuItem({\n\t\t\t\thtml: counter.getPopupMenuItemContainer().innerHTML,\n\t\t\t});\n\t\t\tmenuItem.onclick = this.onPopupItemClick.bind(this, menuItem, counter);\n\n\t\t\titemsNode.push(menuItem);\n\t\t});\n\n\t\tthis.popupMenu = new Menu({\n\t\t\tbindElement: this.$moreArrow,\n\t\t\tclassName: 'tasks-counters--scope',\n\t\t\tangle: {\n\t\t\t\toffset: 96,\n\t\t\t},\n\t\t\tautoHide: true,\n\t\t\tcloseEsc: true,\n\t\t\toffsetTop: 5,\n\t\t\toffsetLeft: -67,\n\t\t\tanimation: 'fading-slide',\n\t\t\titems: itemsNode,\n\t\t\tevents: {\n\t\t\t\tonPopupShow: () => this.$more.classList.add('--hover'),\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.$more.classList.remove('--hover');\n\t\t\t\t\tthis.popupMenu.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn this.popupMenu;\n\t}\n\n\tonPopupItemClick(item, counter)\n\t{\n\t\tcounter.adjustClick();\n\t\tthis.popupMenu.close();\n\t}\n\n\tgetMoreArrow()\n\t{\n\t\tif(!this.$moreArrow)\n\t\t{\n\t\t\tthis.$moreArrow = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-arrow\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$moreArrow;\n\t}\n\n\tgetMore()\n\t{\n\t\tlet value = 0;\n\n\t\tObject.values(this.otherCounters).forEach((counter) => {\n\t\t\tvalue += Number(counter.count);\n\t\t});\n\n\t\tconst count = value > 99\n\t\t\t? '99+'\n\t\t\t: value;\n\n\t\tthis.$moreArrow = Tag.render`\n\t\t\t<div class=\"tasks-counters--item-counter-arrow\"></div>\n\t\t`;\n\n\t\tthis.$more = Tag.render`\n\t\t\t<div class=\"tasks-counters--item-counter--more\">\n\t\t\t\t<div class=\"tasks-counters--item-counter-wrapper\">\n\t\t\t\t\t<div class=\"tasks-counters--item-counter-title\">${Loc.getMessage('TASKS_COUNTER_MORE')}:</div>\n\t\t\t\t\t<div class=\"tasks-counters--item-counter-num\">\n\t\t\t\t\t\t${this.getInnerCounter(count)}\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.$moreArrow}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.$more, 'click', ()=> this.getPopup().show());\n\n\t\treturn this.$more;\n\t}\n\n\tgetInnerCounter(counter: number)\n\t{\n\t\tif (!this.$innerContainer)\n\t\t{\n\t\t\tthis.$innerContainer = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-num-text --stop --without-animate\">${counter}</div>\t\t\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$innerContainer;\n\t}\n\n\tgetOther()\n\t{\n\t\tif (Object.keys(this.otherCounters).length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst content = [];\n\t\tObject.values(this.otherCounters).forEach(counter => content.push(counter.getContainer()));\n\n\t\tthis.$other.cropped = this.isCroppedBlock(this.$other.layout);\n\n\t\tthis.$other.layout = Tag.render`\n\t\t\t<div class=\"tasks-counters--item --other ${this.$other.cropped ? '--cropp' : ''}\">\n\t\t\t\t<div data-role=\"tasks-counters--item-head-other\" class=\"tasks-counters--item-head\">${Loc.getMessage('TASKS_COUNTER_OTHER')}</div>\n\t\t\t\t<div class=\"tasks-counters--item-content\">\n\t\t\t\t\t${content}\n\t\t\t\t\t${this.getMore()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.$other.layout;\n\t}\n\n\tgetContainer()\n\t{\n\t\tconst content = [];\n\t\tObject.values(this.myCounters).forEach(counter => content.push(counter.getContainer()));\n\n\t\tthis.$myTaskHead = Tag.render`\n\t\t\t<div class=\"tasks-counters--item-head\">\n\t\t\t\t${Loc.getMessage('TASKS_COUNTER_MY')}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.$element = Tag.render`\n\t\t\t<div class=\"tasks-counters tasks-counters--scope\">\n\t\t\t\t<div class=\"tasks-counters--item\">\n\t\t\t\t\t${this.$myTaskHead}\n\t\t\t\t\t<div class=\"tasks-counters--item-content\">${content}</div>\n\t\t\t\t</div>\n\t\t\t\t${this.getOther()}\n\t\t\t\t${this.isUserTaskList() && !this.isMyTaskList() ? '' : this.getReadAllBlock()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.$element;\n\t}\n\n\trerender(counters)\n\t{\n\t\tthis.setData(counters);\n\t\tthis.render();\n\t}\n\n\trender()\n\t{\n\t\tlet node = this.getContainer();\n\t\tlet fakeNode = node.cloneNode(true);\n\t\tfakeNode.classList.add('task-interface-toolbar');\n\t\tfakeNode.style.position = 'fixed';\n\t\tfakeNode.style.opacity = '0';\n\t\tfakeNode.style.width = 'auto';\n\t\tfakeNode.style.pointerEvents = 'none';\n\t\tdocument.body.appendChild(fakeNode);\n\t\tthis.nodeWidth = fakeNode.offsetWidth;\n\t\tdocument.body.removeChild(fakeNode);\n\n\t\tDom.replace(this.renderTo.firstChild, node);\n\t}\n}\n"],"names":["Filter","options","filterId","filterManager","BX","Main","getById","bindEvents","updateFields","EventEmitter","subscribe","onFilterApply","bind","fields","getFilterFieldsValues","field","Object","keys","includes","Type","isArray","length","value","isFilteredByField","name","isFilteredByFieldValue","getApi","extendFilter","COUNTER_TYPE","getFilterFields","forEach","getAttribute","getFields","deleteField","getSearch","apply","CountersItem","count","type","color","filterField","filterValue","filter","$container","$innerContainer","$remove","$counter","param","data","unActive","Tag","render","getCounterColor","getInnerCounter","counter","start","getContainer","classList","add","remove","Dom","clean","getCounter","innerHTML","appendChild","animateCounter","node","targetNode","isDomNode","emit","contains","active","title","Loc","getMessage","replace","toLowerCase","Number","getRemove","Event","adjustClick","Counters","my","other","additional","expired","comment","userId","targetUserId","groupId","counters","initialCounterTypes","counterTypes","renderTo","role","signedParameters","popupMenu","$readAll","cropped","layout","$more","$moreArrow","$other","$myTaskHead","setData","initPull","otherCounters","isUserTaskList","isProjectsTaskList","PULL","moduleId","callback","processPullEvent","extendWatch","isProjectList","tagId","setTimeout","eventHandlers","user_counter","onUserCounter","project_counter","onProjectCounter","has","prototype","hasOwnProperty","command","params","call","method","isRoleChanged","updateRole","updateCountersData","myCounters","values","updateTimeout","needUpdate","Ajax","runComponentAction","mode","then","response","rerender","console","log","timeoutTTL","ROLEID","isMyTaskList","newCommentsCount","entries","updateCount","additionalCounters","$readAllInner","availableTypes","counterItem","getCounterItem","getCounterNameByType","VALUE","STYLE","FILTER_FIELD","FILTER_VALUE","readAllClick","readAllForProjects","readAllByRole","readAllForScrum","Viewed","userComments","allCounters","projectComments","scrumComments","itemsNode","menuItem","MenuItem","html","getPopupMenuItemContainer","onclick","onPopupItemClick","push","Menu","bindElement","className","angle","offset","autoHide","closeEsc","offsetTop","offsetLeft","animation","items","events","onPopupShow","onPopupClose","destroy","item","close","getPopup","show","content","isCroppedBlock","getMore","$element","getOther","getReadAllBlock","fakeNode","cloneNode","style","position","opacity","width","pointerEvents","document","body","nodeWidth","offsetWidth","removeChild","firstChild"],"mappings":";;;;;;CAC8C,IAExCA,MAAM;GAEX,gBAAYC,OAAO,EACnB;KAAA;KACC,IAAI,CAACC,QAAQ,GAAGD,OAAO,CAACC,QAAQ;KAChC,IAAI,CAACC,aAAa,GAAGC,EAAE,CAACC,IAAI,CAACF,aAAa,CAACG,OAAO,CAAC,IAAI,CAACJ,QAAQ,CAAC;KAEjE,IAAI,CAACK,UAAU,EAAE;KACjB,IAAI,CAACC,YAAY,EAAE;;GACnB;KAAA;KAAA,6BAGD;OACCC,6BAAY,CAACC,SAAS,CAAC,sBAAsB,EAAE,IAAI,CAACC,aAAa,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;;;KAC7E;KAAA,gCAGD;OACC,IAAI,CAACJ,YAAY,EAAE;;;KACnB;KAAA,+BAGD;OACC,IAAI,CAACK,MAAM,GAAG,IAAI,CAACV,aAAa,CAACW,qBAAqB,EAAE;;;KACxD;KAAA,kCAEiBC,KAAK,EACvB;OACC,IAAI,CAACC,MAAM,CAACC,IAAI,CAAC,IAAI,CAACJ,MAAM,CAAC,CAACK,QAAQ,CAACH,KAAK,CAAC,EAC7C;SACC,OAAO,KAAK;;OAGb,IAAII,cAAI,CAACC,OAAO,CAAC,IAAI,CAACP,MAAM,CAACE,KAAK,CAAC,CAAC,EACpC;SACC,OAAO,IAAI,CAACF,MAAM,CAACE,KAAK,CAAC,CAACM,MAAM,GAAG,CAAC;;OAGrC,OAAO,IAAI,CAACR,MAAM,CAACE,KAAK,CAAC,KAAK,EAAE;;;KAChC;KAAA,uCAEsBA,KAAK,EAAEO,KAAK,EACnC;OACC,OAAO,IAAI,CAACC,iBAAiB,CAACR,KAAK,CAAC,IAAI,IAAI,CAACF,MAAM,CAACE,KAAK,CAAC,KAAKO,KAAK;;;KACpE;KAAA,8BAEaP,KAAK,EACnB;OAAA;OACC,IAAMS,IAAI,GAAGR,MAAM,CAACC,IAAI,CAACF,KAAK,CAAC,CAAC,CAAC,CAAC;OAClC,IAAMO,KAAK,GAAGP,KAAK,CAACS,IAAI,CAAC;OAEzB,IAAI,CAAC,IAAI,CAACC,sBAAsB,CAACD,IAAI,EAAEF,KAAK,CAAC,EAC7C;SACC,IAAI,CAACnB,aAAa,CAACuB,MAAM,EAAE,CAACC,YAAY,iCACrCH,IAAI,EAAGF,KAAK,GACd,KAAK,EACL;WAACM,YAAY,EAAE,qBAAqB,GAAGN;UAAM,CAC7C;SACD;;OAGD,IAAI,CAACnB,aAAa,CAAC0B,eAAe,EAAE,CAACC,OAAO,CAAC,UAACf,KAAK,EAAK;SACvD,IAAIA,KAAK,CAACgB,YAAY,CAAC,WAAW,CAAC,KAAKP,IAAI,EAC5C;WACC,KAAI,CAACrB,aAAa,CAAC6B,SAAS,EAAE,CAACC,WAAW,CAAClB,KAAK,CAAC;;QAElD,CAAC;OAEF,IAAI,CAACZ,aAAa,CAAC+B,SAAS,EAAE,CAACC,KAAK,EAAE;;;KACtC;KAAA,4BAGD;OACC,OAAO,IAAI,CAAChC,aAAa;;;GACzB;CAAA;;;AC7EF,CACgD,IAE3BiC,YAAY;GAEhC,sBAAYnC,OAAO,EACnB;KAAA;KACC,IAAI,CAACoC,KAAK,GAAGpC,OAAO,CAACoC,KAAK;KAC1B,IAAI,CAACb,IAAI,GAAGvB,OAAO,CAACuB,IAAI;KACxB,IAAI,CAACc,IAAI,GAAGrC,OAAO,CAACqC,IAAI;KACxB,IAAI,CAACC,KAAK,GAAGtC,OAAO,CAACsC,KAAK;KAC1B,IAAI,CAACC,WAAW,GAAGvC,OAAO,CAACuC,WAAW;KACtC,IAAI,CAACC,WAAW,GAAGxC,OAAO,CAACwC,WAAW;KACtC,IAAI,CAACC,MAAM,GAAGzC,OAAO,CAACyC,MAAM;KAE5B,IAAI,CAACC,UAAU,GAAG,IAAI;KACtB,IAAI,CAACC,eAAe,GAAG,IAAI;KAC3B,IAAI,CAACC,OAAO,GAAG,IAAI;KACnB,IAAI,CAACC,QAAQ,GAAG,IAAI;KAEpB,IAAI,CAACvC,UAAU,EAAE;;GACjB;KAAA;KAAA,6BAGD;OAAA;OACCE,6BAAY,CAACC,SAAS,CAAC,0BAA0B,EAAE,UAACqC,KAAK,EAAI;SAC5D,KAAI,KAAKA,KAAK,CAACC,IAAI,GAAG,KAAI,CAACC,QAAQ,EAAE,GAAG,IAAI;QAC5C,CAAC;;;KACF;KAAA,6BAGD;OACC,IAAI,CAAC,IAAI,CAACH,QAAQ,EAClB;SACC,IAAMT,KAAK,GAAG,IAAI,CAACA,KAAK,GAAG,EAAE,GAAG,KAAK,GAAG,IAAI,CAACA,KAAK;SAClD,IAAI,CAACS,QAAQ,GAAGI,aAAG,CAACC,MAAM,yLACsB,IAAI,CAACC,eAAe,EAAE,EAClE,IAAI,CAACC,eAAe,CAAChB,KAAK,CAAC,CAE9B;;OAGF,OAAO,IAAI,CAACS,QAAQ;;;KACpB;KAAA,gCAEeQ,OAAe,EAC/B;OACC,IAAI,CAAC,IAAI,CAACV,eAAe,EACzB;SACC,IAAI,CAACA,eAAe,GAAGM,aAAG,CAACC,MAAM,kMAC8CG,OAAO,CACrF;;OAGF,OAAO,IAAI,CAACV,eAAe;;;KAC3B;KAAA,+BAEcW,KAAK,EAAEjC,KAAK,EAC3B;OACC,IAAIiC,KAAK,GAAG,EAAE,IAAIjC,KAAK,GAAG,EAAE,EAC5B;SACC;;OAGD,IAAIA,KAAK,GAAG,EAAE,EACd;SACCA,KAAK,GAAG,KAAK;;OAGd,IAAIiC,KAAK,GAAG,EAAE,EACd;SACCA,KAAK,GAAG,EAAE;;OAGX,IAAIjC,KAAK,KAAK,CAAC,EACf;SACC,IAAI,CAACkC,YAAY,EAAE,CAACC,SAAS,CAACC,GAAG,CAAC,QAAQ,CAAC;;OAG5C,IAAIpC,KAAK,GAAG,CAAC,EACb;SACC,IAAI,CAACkC,YAAY,EAAE,CAACC,SAAS,CAACE,MAAM,CAAC,QAAQ,CAAC;;OAG/CC,aAAG,CAACC,KAAK,CAAC,IAAI,CAACC,UAAU,EAAE,CAAC;OAC5B,IAAI,CAACT,eAAe,EAAE,CAACU,SAAS,GAAGzC,KAAK;OACxC,IAAI,CAACwC,UAAU,EAAE,CAACE,WAAW,CAAC,IAAI,CAACX,eAAe,EAAE,CAAC;OACrD,IAAI,CAACS,UAAU,EAAE,CAACL,SAAS,CAACE,MAAM,CAAC,UAAU,CAAC;OAC9C,IAAI,CAACG,UAAU,EAAE,CAACL,SAAS,CAACE,MAAM,CAAC,gBAAgB,CAAC;;;KACpD;KAAA,kCAGD;OACC,IAAI,CAAC,IAAI,CAACpB,KAAK,EACf;SACC,OAAO,IAAI;;OAGZ,mBAAY,IAAI,CAACA,KAAK;;;KACtB;KAAA,4BAEWQ,KAAa,EACzB;OACC,IAAG,IAAI,CAACV,KAAK,KAAKU,KAAK,EACtB;OAED,IAAI,CAACkB,cAAc,CAAC,IAAI,CAAC5B,KAAK,EAAEU,KAAK,CAAC;OAEtC,IAAI,CAACV,KAAK,GAAGU,KAAK;;;KAClB;KAAA,4BAGD;OACC,IAAG,CAAC,IAAI,CAACF,OAAO,EAChB;SACC,IAAI,CAACA,OAAO,GAAGK,aAAG,CAACC,MAAM,8JAExB;;OAGF,OAAO,IAAI,CAACN,OAAO;;;KACnB;KAAA,uBAGD;OACC,IAAI,CAACW,YAAY,EAAE,CAACC,SAAS,CAACC,GAAG,CAAC,QAAQ,CAAC;;;KAC3C;KAAA,yBAGD;OACC,IAAI,CAACF,YAAY,EAAE,CAACC,SAAS,CAACE,MAAM,CAAC,QAAQ,CAAC;;;KAC9C;KAAA,uBAEMO,IAAiB,EACxB;OACC,IAAMC,UAAU,GAAGhD,cAAI,CAACiD,SAAS,CAACF,IAAI,CAAC,GAAGA,IAAI,GAAG,IAAI,CAACV,YAAY,EAAE;OACpEW,UAAU,CAACV,SAAS,CAACC,GAAG,CAAC,SAAS,CAAC;OACnCjD,6BAAY,CAAC4D,IAAI,CAAC,0BAA0B,EAAE,IAAI,CAAC;;;KACnD;KAAA,yBAEQH,IAAiB,EAC1B;OACC,IAAMC,UAAU,GAAGhD,cAAI,CAACiD,SAAS,CAACF,IAAI,CAAC,GAAGA,IAAI,GAAG,IAAI,CAACV,YAAY,EAAE;OACpEW,UAAU,CAACV,SAAS,CAACE,MAAM,CAAC,SAAS,CAAC;OACtClD,6BAAY,CAAC4D,IAAI,CAAC,4BAA4B,EAAE,IAAI,CAAC;;;KACrD;KAAA,8BAGD;OACC5D,6BAAY,CAAC4D,IAAI,CAAC,sBAAsB,EAAE;SAACf,OAAO,EAAE;QAAK,CAAC;OAE1D,IAAI,CAACX,UAAU,CAACc,SAAS,CAACa,QAAQ,CAAC,SAAS,CAAC,GAC1C,IAAI,CAACrB,QAAQ,EAAE,GACf,IAAI,CAACsB,MAAM,EAAE;;;KAEhB;KAAA,4CAGD;OACC,IAAMC,KAAK,GAAGC,aAAG,CAACC,UAAU,CAAC,2BAA2B,CAAC,CAACC,OAAO,CAAC,SAAS,EAAE,IAAI,CAACnD,IAAI,CAACoD,WAAW,EAAE,CAAC;OAErG,OAAO1B,aAAG,CAACC,MAAM,2UAGkC,IAAI,CAACC,eAAe,EAAE,EAAK,IAAI,CAACf,KAAK,EACtCmC,KAAK;;;KAIvD;KAAA,6BAEYzB,KAAK,EAClB;OACC,IAAG,CAAC,IAAI,CAACJ,UAAU,EACnB;SACC,IAAI,CAACA,UAAU,GAAGO,aAAG,CAACC,MAAM,uWACgB0B,MAAM,CAAC,IAAI,CAACxC,KAAK,CAAC,KAAK,CAAC,GAAG,SAAS,GAAG,EAAE,EAEhF,IAAI,CAACyB,UAAU,EAAE,EAC+B,IAAI,CAACtC,IAAI,EACzD,IAAI,CAACsD,SAAS,EAAE,CAGpB;SAED,IAAI,IAAI,CAACpC,MAAM,CAACjB,sBAAsB,CAAC,IAAI,CAACe,WAAW,EAAE,IAAI,CAACC,WAAW,CAAC,EAC1E;WACC,IAAI,CAAC8B,MAAM,CAAC,IAAI,CAAC5B,UAAU,CAAC;;SAG7BoC,eAAK,CAACnE,IAAI,CAAC,IAAI,CAAC+B,UAAU,EAAE,OAAO,EAAE,IAAI,CAACqC,WAAW,CAACpE,IAAI,CAAC,IAAI,CAAC,CAAC;;OAGlE,OAAO,IAAI,CAAC+B,UAAU;;;GACtB;CAAA;;;;;AClMF,KAUasC,QAAQ;GAAA;KAAA;KAAA,oBAGpB;OACC,OAAO;SACNC,EAAE,EAAE,CACH,SAAS,EACT,YAAY,EACZ,oBAAoB,EACpB,qBAAqB,EACrB,iBAAiB,EACjB,cAAc,EACd,iBAAiB,EACjB,yBAAyB,EACzB,0BAA0B,EAC1B,sBAAsB,EACtB,wBAAwB,EACxB,yBAAyB,EACzB,qBAAqB,EACrB,sBAAsB,EACtB,sBAAsB,EACtB,uBAAuB,EACvB,sBAAsB,CACtB;SACDC,KAAK,EAAE,CACN,iBAAiB,EACjB,kBAAkB,EAClB,0BAA0B,EAC1B,2BAA2B,EAC3B,wBAAwB,EACxB,yBAAyB,EACzB,uBAAuB,EACvB,wBAAwB,EACxB,wBAAwB,CACxB;SACDC,UAAU,EAAE,CACX,oBAAoB,CACpB;SACDC,OAAO,EAAE,CACR,SAAS,EACT,YAAY,EACZ,oBAAoB,EACpB,qBAAqB,EACrB,iBAAiB,EACjB,iBAAiB,EACjB,wBAAwB,EACxB,0BAA0B,EAC1B,sBAAsB,EACtB,wBAAwB,EACxB,qBAAqB,EACrB,uBAAuB,CACvB;SACDC,OAAO,EAAE,CACR,cAAc,EACd,iBAAiB,EACjB,yBAAyB,EACzB,0BAA0B,EAC1B,sBAAsB,EACtB,oBAAoB,EACpB,kBAAkB,EAClB,yBAAyB,EACzB,2BAA2B,EAC3B,uBAAuB,EACvB,yBAAyB,EACzB,sBAAsB,EACtB,wBAAwB,EACxB,sBAAsB,EACtB,wBAAwB;QAEzB;;;GAQF,kBAAYrF,OAAO,EACnB;KAAA;KACC,IAAI,CAACsF,MAAM,GAAGtF,OAAO,CAACsF,MAAM;KAC5B,IAAI,CAACC,YAAY,GAAGvF,OAAO,CAACuF,YAAY;KACxC,IAAI,CAACC,OAAO,GAAGxF,OAAO,CAACwF,OAAO;KAC9B,IAAI,CAACC,QAAQ,GAAGzF,OAAO,CAACyF,QAAQ;KAChC,IAAI,CAACC,mBAAmB,GAAG1F,OAAO,CAAC2F,YAAY;KAC/C,IAAI,CAACC,QAAQ,GAAG5F,OAAO,CAAC4F,QAAQ;KAChC,IAAI,CAACC,IAAI,GAAG7F,OAAO,CAAC6F,IAAI;KACxB,IAAI,CAACC,gBAAgB,GAAG9F,OAAO,CAAC8F,gBAAgB;KAEhD,IAAI,CAACC,SAAS,GAAG,IAAI;KAErB,IAAI,CAACC,QAAQ,GAAG;OACfC,OAAO,EAAE,IAAI;OACbC,MAAM,EAAE;MACR;KACD,IAAI,CAACC,KAAK,GAAG,IAAI;KACjB,IAAI,CAACC,UAAU,GAAG,IAAI;KACtB,IAAI,CAACC,MAAM,GAAG;OACbJ,OAAO,EAAE,IAAI;OACbC,MAAM,EAAE;MACR;KACD,IAAI,CAACI,WAAW,GAAG,IAAI;KAEvB,IAAI,CAAC7D,MAAM,GAAG,IAAI1C,MAAM,CAAC;OAACE,QAAQ,EAAED,OAAO,CAACC;MAAS,CAAC;KAEtD,IAAI,CAACK,UAAU,EAAE;KACjB,IAAI,CAACiG,OAAO,CAAC,IAAI,CAACd,QAAQ,CAAC;KAE3B,IAAI,CAACe,QAAQ,EAAE;;GACf;KAAA;KAAA,+BAGD;OACC,OAAO,IAAI,CAAClB,MAAM,KAAK,IAAI,CAACC,YAAY;;;KACxC;KAAA,iCAGD;OACC,OAAQxE,MAAM,CAACC,IAAI,CAAC,IAAI,CAACyF,aAAa,CAAC,CAACrF,MAAM,KAAK,CAAC;;;KACpD;KAAA,qCAGD;OACC,OAAO,IAAI,CAACoE,OAAO,GAAG,CAAC;;;KACvB;KAAA,gCAGD;OACC,OAAO,CAAC,IAAI,CAACkB,cAAc,EAAE,IAAI,CAAC,IAAI,CAACC,kBAAkB,EAAE;;;KAC3D;KAAA,2BAGD;OAAA;OACCxG,EAAE,CAACyG,IAAI,CAACnG,SAAS,CAAC;SACjBoG,QAAQ,EAAE,OAAO;SACjBC,QAAQ,EAAE,kBAAA/D,IAAI;WAAA,OAAI,KAAI,CAACgE,gBAAgB,CAAChE,IAAI,CAAC;;QAC7C,CAAC;OAEF,IAAI,CAACiE,WAAW,EAAE;;;KAClB;KAAA,8BAGD;OAAA;OACC,IAAI,IAAI,CAACL,kBAAkB,EAAE,IAAI,IAAI,CAACM,aAAa,EAAE,EACrD;SACC,IAAIC,KAAK,GAAG,gBAAgB;SAE5B,IAAI,IAAI,CAACP,kBAAkB,EAAE,EAC7B;WACCO,KAAK,4BAAqB,IAAI,CAAC1B,OAAO,CAAE;;SAGzCrF,EAAE,CAACyG,IAAI,CAACI,WAAW,CAACE,KAAK,EAAE,IAAI,CAAC;SAChCC,UAAU,CAAC;WAAA,OAAM,MAAI,CAACH,WAAW,EAAE;YAAE,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC;;;;KAErD;KAAA,iCAEgBjE,IAAI,EACrB;OACC,IAAMqE,aAAa,GAAG;SACrBC,YAAY,EAAE,IAAI,CAACC,aAAa,CAAC3G,IAAI,CAAC,IAAI,CAAC;SAC3C4G,eAAe,EAAE,IAAI,CAACC,gBAAgB,CAAC7G,IAAI,CAAC,IAAI;QAChD;OACD,IAAM8G,GAAG,GAAG1G,MAAM,CAAC2G,SAAS,CAACC,cAAc;OAC3C,IAAOC,OAAO,GAAY7E,IAAI,CAAvB6E,OAAO;SAAEC,MAAM,GAAI9E,IAAI,CAAd8E,MAAM;OACtB,IAAIJ,GAAG,CAACK,IAAI,CAACV,aAAa,EAAEQ,OAAO,CAAC,EACpC;SACC,IAAMG,MAAM,GAAGX,aAAa,CAACQ,OAAO,CAAC;SACrC,IAAIG,MAAM,EACV;WACCA,MAAM,CAAC7F,KAAK,CAAC,IAAI,EAAE,CAAC2F,MAAM,CAAC,CAAC;;;;;KAG9B;KAAA,6BAGD;OACCrH,6BAAY,CAACC,SAAS,CAAC,sBAAsB,EAAE,IAAI,CAACC,aAAa,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;;;KAC7E;KAAA,gCAGD;OAAA;OACC,IAAI,CAAC8B,MAAM,CAAClC,YAAY,EAAE;OAE1B,IAAI,IAAI,CAACyH,aAAa,EAAE,EACxB;SACC,IAAI,CAACC,UAAU,EAAE;SACjB,IAAI,CAACC,kBAAkB,EAAE;QACzB,MAED;SACC,IAAMzC,QAAQ,mCAAO,IAAI,CAAC0C,UAAU,GAAK,IAAI,CAAC1B,aAAa,CAAC;SAC5D1F,MAAM,CAACqH,MAAM,CAAC3C,QAAQ,CAAC,CAAC5D,OAAO,CAAC,UAACwB,OAAO,EAAK;WAC5C,IAAIA,OAAO,EACX;aACC,MAAI,CAACZ,MAAM,CAACjB,sBAAsB,CAAC6B,OAAO,CAACd,WAAW,EAAEc,OAAO,CAACb,WAAW,CAAC,GACzEa,OAAO,CAACiB,MAAM,EAAE,GAChBjB,OAAO,CAACL,QAAQ,EAAE;;UAGtB,CAAC;;;;KAEH;KAAA,qCAGD;OAAA;OACC,IAAIgC,QAAQ,CAACqD,aAAa,EAC1B;SACCrD,QAAQ,CAACsD,UAAU,GAAG,IAAI;SAC1B;;OAGDtD,QAAQ,CAACqD,aAAa,GAAG,IAAI;OAC7BrD,QAAQ,CAACsD,UAAU,GAAG,KAAK;OAE3BC,cAAI,CAACC,kBAAkB,CAAC,iCAAiC,EAAE,aAAa,EAAE;SACzEC,IAAI,EAAE,OAAO;SACb1F,IAAI,EAAE;WACLyC,OAAO,EAAE,IAAI,CAACA,OAAO;WACrBK,IAAI,EAAE,IAAI,CAACA,IAAI;WACfJ,QAAQ,EAAE,IAAI,CAACC;UACf;SACDI,gBAAgB,EAAE,IAAI,CAACA;QACvB,CAAC,CAAC4C,IAAI,CACN,UAAAC,QAAQ;SAAA,OAAI,MAAI,CAACC,QAAQ,CAACD,QAAQ,CAAC5F,IAAI,CAAC;UACxC,UAAA4F,QAAQ;SAAA,OAAIE,OAAO,CAACC,GAAG,CAACH,QAAQ,CAAC;SACjC;OAEDxB,UAAU,CAAC,YAAW;SACrBnC,QAAQ,CAACqD,aAAa,GAAG,KAAK;SAC9B,IAAIrD,QAAQ,CAACsD,UAAU,EACvB;WACC,IAAI,CAACJ,kBAAkB,EAAE;;QAE1B,CAACvH,IAAI,CAAC,IAAI,CAAC,EAAEqE,QAAQ,CAAC+D,UAAU,CAAC;;;KAClC;KAAA,gCAGD;OACC,OAAO,IAAI,CAAClD,IAAI,MAAM,IAAI,CAACpD,MAAM,CAACnB,iBAAiB,CAAC,QAAQ,CAAC,GAAG,IAAI,CAACmB,MAAM,CAAC7B,MAAM,CAACoI,MAAM,GAAG,UAAU,CAAC;;;KACvG;KAAA,6BAGD;OACC,IAAI,CAACnD,IAAI,GAAI,IAAI,CAACpD,MAAM,CAACnB,iBAAiB,CAAC,QAAQ,CAAC,GAAG,IAAI,CAACmB,MAAM,CAAC7B,MAAM,CAACoI,MAAM,GAAG,UAAW;;;KAC9F;KAAA,8BAEajG,IAAI,EAClB;OAAA;OACC,IAAM0E,GAAG,GAAG1G,MAAM,CAAC2G,SAAS,CAACC,cAAc;OAC3C,IACC,CAAC,IAAI,CAACjB,cAAc,EAAE,IACnB,CAAC,IAAI,CAACuC,YAAY,EAAE,IACpB,CAACxB,GAAG,CAACK,IAAI,CAAC/E,IAAI,EAAE,IAAI,CAACyC,OAAO,CAAC,IAC7B,IAAI,CAACF,MAAM,KAAKV,MAAM,CAAC7B,IAAI,CAACuC,MAAM,CAAC,EAEvC;SACC;;OAGD,IAAI4D,gBAAgB,GAAG,CAAC;OAExBnI,MAAM,CAACoI,OAAO,CAACpG,IAAI,CAAC,IAAI,CAACyC,OAAO,CAAC,CAAC,IAAI,CAACK,IAAI,CAAC,CAAC,CAAChE,OAAO,CAAC,gBAAmB;SAAA;WAAjBQ,IAAI;WAAEhB,KAAK;SAClE,IAAI,MAAI,CAAC8G,UAAU,CAAC9F,IAAI,CAAC,EACzB;WACC,MAAI,CAAC8F,UAAU,CAAC9F,IAAI,CAAC,CAAC+G,WAAW,CAAC/H,KAAK,CAAC;WAExC,IAAI2D,QAAQ,CAACW,YAAY,CAACN,OAAO,CAACpE,QAAQ,CAACoB,IAAI,CAAC,EAChD;aACC6G,gBAAgB,IAAI7H,KAAK;;UAE1B,MACI,IAAI,MAAI,CAACgI,kBAAkB,CAAChH,IAAI,CAAC,IAAI2C,QAAQ,CAACW,YAAY,CAACN,OAAO,CAACpE,QAAQ,CAACoB,IAAI,CAAC,EACtF;WACC6G,gBAAgB,IAAI7H,KAAK;;QAE1B,CAAC;OAEF,IAAI6H,gBAAgB,GAAG,CAAC,EACxB;SACC,IAAI,CAACI,aAAa,CAAC9F,SAAS,CAACE,MAAM,CAAC,QAAQ,CAAC;;;;KAE9C;KAAA,iCAEgBX,IAAI,EACrB;OACC,IAAI,IAAI,CAAC2D,cAAc,EAAE,EACzB;SACC;;OAGD,IAAI,CAACwB,kBAAkB,EAAE;;;KACzB;KAAA,+BAEcpF,KAAa,EAC5B;OACC,OAAO,IAAIX,YAAY,CAAC;SACvBC,KAAK,EAAEU,KAAK,CAACV,KAAK;SAClBb,IAAI,EAAEuB,KAAK,CAACvB,IAAI;SAChBc,IAAI,EAAES,KAAK,CAACT,IAAI;SAChBC,KAAK,EAAEQ,KAAK,CAACR,KAAK;SAClBC,WAAW,EAAEO,KAAK,CAACP,WAAW;SAC9BC,WAAW,EAAEM,KAAK,CAACN,WAAW;SAC9BC,MAAM,EAAE,IAAI,CAACA;QACb,CAAC;;;KACF;KAAA,qCAEoBJ,IAAY,EACjC;OACC,IAAI2C,QAAQ,CAACW,YAAY,CAACP,OAAO,CAACnE,QAAQ,CAACoB,IAAI,CAAC,EAChD;SACC,OAAOmC,aAAG,CAACC,UAAU,CAAC,uBAAuB,CAAC;QAC9C,MACI,IAAIO,QAAQ,CAACW,YAAY,CAACN,OAAO,CAACpE,QAAQ,CAACoB,IAAI,CAAC,EACrD;SACC,OAAOmC,aAAG,CAACC,UAAU,CAAC,4BAA4B,CAAC;;;;KAEpD;KAAA,wBAEOgB,QAAQ,EAChB;OAAA;OACC,IAAI,CAAC0C,UAAU,GAAG,EAAE;OACpB,IAAI,CAAC1B,aAAa,GAAG,EAAE;OACvB,IAAI,CAAC4C,kBAAkB,GAAG,EAAE;OAE5B,IAAME,cAAc,4CAChBvE,QAAQ,CAACW,YAAY,CAACR,UAAU,kCAChCH,QAAQ,CAACW,YAAY,CAACV,EAAE,kCACxBD,QAAQ,CAACW,YAAY,CAACT,KAAK,EAC9B;OAEDnE,MAAM,CAACoI,OAAO,CAAC1D,QAAQ,CAAC,CAAC5D,OAAO,CAAC,iBAAkB;SAAA;WAAhBQ,IAAI;WAAEU,IAAI;SAC5C,IAAI,CAACwG,cAAc,CAACtI,QAAQ,CAACoB,IAAI,CAAC,EAClC;WACC;;SAGD,IAAMmH,WAAW,GAAG,MAAI,CAACC,cAAc,CAAC;WACvCpH,IAAI,EAAJA,IAAI;WACJd,IAAI,EAAE,MAAI,CAACmI,oBAAoB,CAACrH,IAAI,CAAC;WACrCD,KAAK,EAAEwC,MAAM,CAAC7B,IAAI,CAAC4G,KAAK,CAAC;WACzBrH,KAAK,EAAES,IAAI,CAAC6G,KAAK;WACjBrH,WAAW,EAAEQ,IAAI,CAAC8G,YAAY;WAC9BrH,WAAW,EAAEO,IAAI,CAAC+G;UAClB,CAAC;SAEF,IAAI9E,QAAQ,CAACW,YAAY,CAACR,UAAU,CAAClE,QAAQ,CAACoB,IAAI,CAAC,EACnD;WACC,MAAI,CAACgH,kBAAkB,CAAChH,IAAI,CAAC,GAAGmH,WAAW;UAC3C,MACI,IAAIxE,QAAQ,CAACW,YAAY,CAACV,EAAE,CAAChE,QAAQ,CAACoB,IAAI,CAAC,EAChD;WACC,MAAI,CAAC8F,UAAU,CAAC9F,IAAI,CAAC,GAAGmH,WAAW;UACnC,MACI,IAAIxE,QAAQ,CAACW,YAAY,CAACT,KAAK,CAACjE,QAAQ,CAACoB,IAAI,CAAC,EACnD;WACC,MAAI,CAACoE,aAAa,CAACpE,IAAI,CAAC,GAAGmH,WAAW;;QAEvC,CAAC;;;KACF;KAAA,+BAEcvF,IAAiB,EAChC;OACC,IAAGA,IAAI,EACN,OAAOA,IAAI,CAACT,SAAS,CAACa,QAAQ,CAAC,SAAS,CAAC;;;KAC1C;KAAA,kCAGD;OAAA;OACC,IAAMoB,QAAQ,iDAAO,IAAI,CAAC0C,UAAU,GAAK,IAAI,CAAC1B,aAAa,GAAK,IAAI,CAAC4C,kBAAkB,CAAC;OACxF,IAAIH,gBAAgB,GAAG,CAAC;OAExBnI,MAAM,CAACoI,OAAO,CAAC1D,QAAQ,CAAC,CAAC5D,OAAO,CAAC,iBAAqB;SAAA;WAAnBQ,IAAI;WAAEgB,OAAO;SAC/C,IAAI2B,QAAQ,CAACW,YAAY,CAACN,OAAO,CAACpE,QAAQ,CAACoB,IAAI,CAAC,EAChD;WACC6G,gBAAgB,IAAI7F,OAAO,CAACjB,KAAK;;QAElC,CAAC;OAEF,IAAI,CAACkH,aAAa,GAAGrG,aAAG,CAACC,MAAM,wbAEzBgG,gBAAgB,KAAK,CAAC,GAAG,QAAQ,GAAG,EAAE,EAKvC1E,aAAG,CAACC,UAAU,CAAC,wBAAwB,CAAC,CAG5C;OAED,IAAIsF,YAAY,GAAG,IAAI,CAACC,kBAAkB,CAACrJ,IAAI,CAAC,IAAI,CAAC;OACrD,IACC,IAAI,CAAC+F,cAAc,EAAE,IACjB,IAAI,CAACC,kBAAkB,EAAE,IAAI,IAAI,CAACd,IAAI,KAAK,UAAW,EAE3D;SACCkE,YAAY,GAAG,IAAI,CAACE,aAAa,CAACtJ,IAAI,CAAC,IAAI,CAAC;QAC5C,MACI,IACJ,IAAI,CAACwH,UAAU,CAAC,sBAAsB,CAAC,IACpC,IAAI,CAAC1B,aAAa,CAAC,wBAAwB,CAAC,EAEhD;SACCsD,YAAY,GAAG,IAAI,CAACG,eAAe,CAACvJ,IAAI,CAAC,IAAI,CAAC;;OAG/CmE,eAAK,CAACnE,IAAI,CAAC,IAAI,CAAC2I,aAAa,EAAE,OAAO,EAAES,YAAY,CAAC;OACrDjF,eAAK,CAACnE,IAAI,CAAC,IAAI,CAAC2I,aAAa,EAAE,OAAO,EAAE;SAAA,OAAM,MAAI,CAACA,aAAa,CAAC9F,SAAS,CAACC,GAAG,CAAC,QAAQ,CAAC;SAAC;OAEzF,IAAI,CAACuC,QAAQ,CAACE,MAAM,GAAGjD,aAAG,CAACC,MAAM,oJACI,IAAI,CAACoG,aAAa,CACtD;OAED,OAAO,IAAI,CAACtD,QAAQ,CAACE,MAAM;;;KAC3B;KAAA,gCAGD;OACE,IAAIiE,uBAAM,EAAE,CAAEC,YAAY,CAAC;SAC3B5E,OAAO,EAAE,IAAI,CAACA,OAAO;SACrBF,MAAM,EAAE,IAAI,CAACA,MAAM;SACnBO,IAAI,EAAE,IAAI,CAACA;QACX,CAAC;;;KACF;KAAA,qCAGD;OACC,IAAMwE,WAAW,mCAAO,IAAI,CAAClC,UAAU,GAAK,IAAI,CAAC1B,aAAa,CAAC;OAC/D1F,MAAM,CAACoI,OAAO,CAACkB,WAAW,CAAC,CAACxI,OAAO,CAAC,iBAAqB;SAAA;WAAnBQ,IAAI;WAAEgB,OAAO;SAClD,IAAI2B,QAAQ,CAACW,YAAY,CAACN,OAAO,CAACpE,QAAQ,CAACoB,IAAI,CAAC,EAChD;WACCgB,OAAO,CAAC+F,WAAW,CAAC,CAAC,CAAC;;QAEvB,CAAC;OAED,IAAIe,uBAAM,EAAE,CAAEG,eAAe,CAAC;SAC9B9E,OAAO,EAAE,IAAI,CAACA;QACd,CAAC;;;KACF;KAAA,kCAGD;OACC,IAAM6E,WAAW,mCAAO,IAAI,CAAClC,UAAU,GAAK,IAAI,CAAC1B,aAAa,CAAC;OAC/D1F,MAAM,CAACoI,OAAO,CAACkB,WAAW,CAAC,CAACxI,OAAO,CAAC,iBAAqB;SAAA;WAAnBQ,IAAI;WAAEgB,OAAO;SAClD,IAAI2B,QAAQ,CAACW,YAAY,CAACN,OAAO,CAACpE,QAAQ,CAACoB,IAAI,CAAC,EAChD;WACCgB,OAAO,CAAC+F,WAAW,CAAC,CAAC,CAAC;;QAEvB,CAAC;OAED,IAAIe,uBAAM,EAAE,CAAEI,aAAa,CAAC;SAC5B/E,OAAO,EAAE,IAAI,CAACA;QACd,CAAC;;;KACF;KAAA,2BAGD;OAAA;OACC,IAAMgF,SAAS,GAAG,EAAE;OAEpBzJ,MAAM,CAACqH,MAAM,CAAC,IAAI,CAAC3B,aAAa,CAAC,CAAC5E,OAAO,CAAC,UAACwB,OAAO,EAAK;SACtD,IAAMoH,QAAQ,GAAG,IAAIC,mBAAQ,CAAC;WAC7BC,IAAI,EAAEtH,OAAO,CAACuH,yBAAyB,EAAE,CAAC9G;UAC1C,CAAC;SACF2G,QAAQ,CAACI,OAAO,GAAG,MAAI,CAACC,gBAAgB,CAACnK,IAAI,CAAC,MAAI,EAAE8J,QAAQ,EAAEpH,OAAO,CAAC;SAEtEmH,SAAS,CAACO,IAAI,CAACN,QAAQ,CAAC;QACxB,CAAC;OAEF,IAAI,CAAC1E,SAAS,GAAG,IAAIiF,eAAI,CAAC;SACzBC,WAAW,EAAE,IAAI,CAAC7E,UAAU;SAC5B8E,SAAS,EAAE,uBAAuB;SAClCC,KAAK,EAAE;WACNC,MAAM,EAAE;UACR;SACDC,QAAQ,EAAE,IAAI;SACdC,QAAQ,EAAE,IAAI;SACdC,SAAS,EAAE,CAAC;SACZC,UAAU,EAAE,CAAC,EAAE;SACfC,SAAS,EAAE,cAAc;SACzBC,KAAK,EAAElB,SAAS;SAChBmB,MAAM,EAAE;WACPC,WAAW,EAAE;aAAA,OAAM,MAAI,CAACzF,KAAK,CAAC3C,SAAS,CAACC,GAAG,CAAC,SAAS,CAAC;;WACtDoI,YAAY,EAAE,wBAAM;aACnB,MAAI,CAAC1F,KAAK,CAAC3C,SAAS,CAACE,MAAM,CAAC,SAAS,CAAC;aACtC,MAAI,CAACqC,SAAS,CAAC+F,OAAO,EAAE;;;QAG1B,CAAC;OAEF,OAAO,IAAI,CAAC/F,SAAS;;;KACrB;KAAA,iCAEgBgG,IAAI,EAAE1I,OAAO,EAC9B;OACCA,OAAO,CAAC0B,WAAW,EAAE;OACrB,IAAI,CAACgB,SAAS,CAACiG,KAAK,EAAE;;;KACtB;KAAA,+BAGD;OACC,IAAG,CAAC,IAAI,CAAC5F,UAAU,EACnB;SACC,IAAI,CAACA,UAAU,GAAGnD,aAAG,CAACC,MAAM,iKAE3B;;OAGF,OAAO,IAAI,CAACkD,UAAU;;;KACtB;KAAA,0BAGD;OAAA;OACC,IAAI/E,KAAK,GAAG,CAAC;OAEbN,MAAM,CAACqH,MAAM,CAAC,IAAI,CAAC3B,aAAa,CAAC,CAAC5E,OAAO,CAAC,UAACwB,OAAO,EAAK;SACtDhC,KAAK,IAAIuD,MAAM,CAACvB,OAAO,CAACjB,KAAK,CAAC;QAC9B,CAAC;OAEF,IAAMA,KAAK,GAAGf,KAAK,GAAG,EAAE,GACrB,KAAK,GACLA,KAAK;OAER,IAAI,CAAC+E,UAAU,GAAGnD,aAAG,CAACC,MAAM,6JAE3B;OAED,IAAI,CAACiD,KAAK,GAAGlD,aAAG,CAACC,MAAM,ybAG8BsB,aAAG,CAACC,UAAU,CAAC,oBAAoB,CAAC,EAEnF,IAAI,CAACrB,eAAe,CAAChB,KAAK,CAAC,EAE5B,IAAI,CAACgE,UAAU,CAGnB;OAEDtB,eAAK,CAACnE,IAAI,CAAC,IAAI,CAACwF,KAAK,EAAE,OAAO,EAAE;SAAA,OAAK,MAAI,CAAC8F,QAAQ,EAAE,CAACC,IAAI,EAAE;SAAC;OAE5D,OAAO,IAAI,CAAC/F,KAAK;;;KACjB;KAAA,gCAEe9C,OAAe,EAC/B;OACC,IAAI,CAAC,IAAI,CAACV,eAAe,EACzB;SACC,IAAI,CAACA,eAAe,GAAGM,aAAG,CAACC,MAAM,kMAC8CG,OAAO,CACrF;;OAGF,OAAO,IAAI,CAACV,eAAe;;;KAC3B;KAAA,2BAGD;OACC,IAAI5B,MAAM,CAACC,IAAI,CAAC,IAAI,CAACyF,aAAa,CAAC,CAACrF,MAAM,KAAK,CAAC,EAChD;SACC,OAAO,EAAE;;OAGV,IAAM+K,OAAO,GAAG,EAAE;OAClBpL,MAAM,CAACqH,MAAM,CAAC,IAAI,CAAC3B,aAAa,CAAC,CAAC5E,OAAO,CAAC,UAAAwB,OAAO;SAAA,OAAI8I,OAAO,CAACpB,IAAI,CAAC1H,OAAO,CAACE,YAAY,EAAE,CAAC;SAAC;OAE1F,IAAI,CAAC8C,MAAM,CAACJ,OAAO,GAAG,IAAI,CAACmG,cAAc,CAAC,IAAI,CAAC/F,MAAM,CAACH,MAAM,CAAC;OAE7D,IAAI,CAACG,MAAM,CAACH,MAAM,GAAGjD,aAAG,CAACC,MAAM,kXACa,IAAI,CAACmD,MAAM,CAACJ,OAAO,GAAG,SAAS,GAAG,EAAE,EACOzB,aAAG,CAACC,UAAU,CAAC,qBAAqB,CAAC,EAEvH0H,OAAO,EACP,IAAI,CAACE,OAAO,EAAE,CAGlB;OAED,OAAO,IAAI,CAAChG,MAAM,CAACH,MAAM;;;KACzB;KAAA,+BAGD;OACC,IAAMiG,OAAO,GAAG,EAAE;OAClBpL,MAAM,CAACqH,MAAM,CAAC,IAAI,CAACD,UAAU,CAAC,CAACtG,OAAO,CAAC,UAAAwB,OAAO;SAAA,OAAI8I,OAAO,CAACpB,IAAI,CAAC1H,OAAO,CAACE,YAAY,EAAE,CAAC;SAAC;OAEvF,IAAI,CAAC+C,WAAW,GAAGrD,aAAG,CAACC,MAAM,uKAEzBsB,aAAG,CAACC,UAAU,CAAC,kBAAkB,CAAC,CAErC;OAED,IAAI,CAAC6H,QAAQ,GAAGrJ,aAAG,CAACC,MAAM,gVAGrB,IAAI,CAACoD,WAAW,EAC0B6F,OAAO,EAElD,IAAI,CAACI,QAAQ,EAAE,EACf,IAAI,CAAC7F,cAAc,EAAE,IAAI,CAAC,IAAI,CAACuC,YAAY,EAAE,GAAG,EAAE,GAAG,IAAI,CAACuD,eAAe,EAAE,CAE9E;OAED,OAAO,IAAI,CAACF,QAAQ;;;KACpB;KAAA,yBAEQ7G,QAAQ,EACjB;OACC,IAAI,CAACc,OAAO,CAACd,QAAQ,CAAC;OACtB,IAAI,CAACvC,MAAM,EAAE;;;KACb;KAAA,yBAGD;OACC,IAAIe,IAAI,GAAG,IAAI,CAACV,YAAY,EAAE;OAC9B,IAAIkJ,QAAQ,GAAGxI,IAAI,CAACyI,SAAS,CAAC,IAAI,CAAC;OACnCD,QAAQ,CAACjJ,SAAS,CAACC,GAAG,CAAC,wBAAwB,CAAC;OAChDgJ,QAAQ,CAACE,KAAK,CAACC,QAAQ,GAAG,OAAO;OACjCH,QAAQ,CAACE,KAAK,CAACE,OAAO,GAAG,GAAG;OAC5BJ,QAAQ,CAACE,KAAK,CAACG,KAAK,GAAG,MAAM;OAC7BL,QAAQ,CAACE,KAAK,CAACI,aAAa,GAAG,MAAM;OACrCC,QAAQ,CAACC,IAAI,CAAClJ,WAAW,CAAC0I,QAAQ,CAAC;OACnC,IAAI,CAACS,SAAS,GAAGT,QAAQ,CAACU,WAAW;OACrCH,QAAQ,CAACC,IAAI,CAACG,WAAW,CAACX,QAAQ,CAAC;OAEnC9I,aAAG,CAACe,OAAO,CAAC,IAAI,CAACkB,QAAQ,CAACyH,UAAU,EAAEpJ,IAAI,CAAC;;;GAC3C;CAAA;CACD,4BAlnBYe,QAAQ,mBAwEG,KAAK;CAAA,4BAxEhBA,QAAQ,gBAyEA,KAAK;CAAA,4BAzEbA,QAAQ,gBA2EA,IAAI;;;;;;;;"}