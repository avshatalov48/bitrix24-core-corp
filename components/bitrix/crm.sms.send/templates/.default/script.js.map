{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Loc, Reflection } from 'main.core';\n\nconst namespace = Reflection.namespace('BX.Crm.Component');\n\ndeclare type ProviderData = {\n\tid: string,\n\tname: string,\n\tcanUse: boolean,\n\tfromList: SenderData[],\n}\n\ndeclare type ReceiverData = {\n\tvalueFormatted: ?string,\n\tvalue: string,\n}\n\ndeclare type SenderData = {\n\tid: string,\n\tname: string,\n}\n\n/**\n * @memberof BX.Crm.Component.CrmSmsSend\n */\nclass CrmSmsSend\n{\n\t_senders: ProviderData[];\n\t_fromList: SenderData[];\n\t_toList: ReceiverData[];\n\n\tconstructor(container)\n\t{\n\t\tthis._senderId = null;\n\t\tthis._from = null;\n\t\tthis._commEntityTypeId = null;\n\t\tthis._commEntityId = null;\n\t\tthis._to = null;\n\t\tthis._templateCode = null;\n\t\tthis._templatePlaceholders = null;\n\n\t\tthis._fromList = [];\n\t\tthis._toList = [];\n\n\t\tthis._input = null;\n\t\tthis._menu = null;\n\t\tthis._isMenuShown = false;\n\t\tthis._shownMenuId = null;\n\n\t\tthis._canUse = null;\n\t\tthis._canSendMessage = null;\n\t\tthis._manageUrl = null;\n\t\tthis._senders = null;\n\t\tthis._defaults = null;\n\t\tthis._communications = null;\n\t\tthis._container = container;\n\t\tthis._isRequestRunning = false;\n\t\tthis._isSenderFixed = false;\n\n\t\tthis.saveButton = null;\n\t\tthis.cancelButton = null;\n\t\tthis._serviceUrl = '';\n\n\t\tthis._ownerTypeId = '';\n\t\tthis._ownerId = '';\n\t}\n\n\tinit(settings)\n\t{\n\t\tthis._canUse = BX.prop.getBoolean(settings, \"canUse\", false);\n\t\tthis._canSendMessage = BX.prop.getBoolean(settings, \"canSendMessage\", false);\n\t\tthis._manageUrl = BX.prop.getString(settings, \"manageUrl\", '');\n\t\tthis._senders = BX.prop.getArray(settings, \"senders\", []);\n\t\tthis._defaults = BX.prop.getObject(settings, \"defaults\", {\n\t\t\tsenderId: null,\n\t\t\tfrom:null\n\t\t});\n\t\tthis._communications = BX.prop.getArray(settings, \"communications\", []);\n\t\tthis._serviceUrl = BX.prop.getString(settings, 'serviceUrl', '');\n\t\tthis._ownerTypeId = BX.prop.getInteger(settings, 'ownerTypeId', 0);\n\t\tthis._ownerId = BX.prop.getInteger(settings, 'ownerId', 0);\n\t\tthis._senderId = BX.prop.getString(settings, 'providerId');\n\t\tthis._isSenderFixed = BX.prop.getBoolean(settings, 'isProviderFixed', false);\n\t\tthis._templateCode = BX.prop.getString(settings, 'templateCode');\n\t\tthis._templatePlaceholders = BX.prop.getObject(settings, 'templatePlaceholders');\n\t\tthis._linkToMarket = BX.prop.getString(settings, 'linkToMarket');\n\n\t\tthis._title = this._container.querySelector('[data-role=\"sender-title\"]');\n\t\tthis._senderContainerNode = this._container.querySelector('[data-role=\"sender-container\"]');\n\t\tthis._senderSelectorNode = this._container.querySelector('[data-role=\"sender-selector\"]');\n\t\tthis._senderSelectorBlockNode = this._container.querySelector('[data-role=\"sender-selector-block\"]');\n\t\tthis._fromContainerNode = this._container.querySelector('[data-role=\"from-container\"]');\n\t\tthis._fromSelectorNode = this._container.querySelector('[data-role=\"from-selector\"]');\n\t\tthis._clientContainerNode = this._container.querySelector('[data-role=\"client-container\"]');\n\t\tthis._clientSelectorNode = this._container.querySelector('[data-role=\"client-selector\"]');\n\t\tthis._toSelectorNode = this._container.querySelector('[data-role=\"to-selector\"]');\n\t\tthis._messageLengthCounterNode = this._container.querySelector('[data-role=\"message-length-counter\"]');\n\t\tthis._input = this._container.querySelector('[data-role=\"input\"]');\n\t\tthis.saveButton = this._container.querySelector('[data-role=\"button-save\"]');\n\t\tthis.cancelButton = this._container.querySelector('[data-role=\"button-cancel\"]');\n\n\t\tif(this._canUse && this._canSendMessage)\n\t\t{\n\t\t\tthis.initSenderSelector();\n\t\t\tthis.initFromSelector();\n\t\t\tthis.initClientContainer();\n\t\t\tthis.initClientSelector();\n\t\t\tthis.initToSelector();\n\t\t\tthis.initMessageLengthCounter();\n\t\t\tthis.initButtons();\n\t\t\tthis.setMessageLengthCounter();\n\t\t}\n\t}\n\n\tswitchToFixedSenderAppearance(sender): void\n\t{\n\t\tthis.setSender(sender);\n\t\tconst subtitleNode = document.querySelector('.ui-side-panel-wrap-below');\n\t\tif (subtitleNode)\n\t\t{\n\t\t\tsubtitleNode.classList.add('crm-sms-send-subtitle');\n\t\t\tsubtitleNode.innerHTML = Loc.getMessage('CRM_SMS_SEND_SENDER_SUBTITLE', {\n\t\t\t\t'#SENDER#': '<span class=\"crm-sms-send-subtitle-sender\">' + sender.name + '</span>',\n\t\t\t});\n\t\t}\n\t\tthis._senderSelectorBlockNode.style.display = 'none';\n\t\tthis._senderContainerNode.style.display = 'inline';\n\t\tthis._clientContainerNode.style.display = 'inline';\n\t}\n\n\tinitSenderSelector()\n\t{\n\t\tconst defaultSenderId = this._senderId ?? this._defaults.senderId;\n\t\tlet defaultSender = this._senders[0].canUse ? this._senders[0] : null;\n\t\tlet restSender = null;\n\t\tconst menuItems = [];\n\t\tconst handler = this.onSenderSelectorClick.bind(this);\n\n\t\tfor (let i = 0; i < this._senders.length; ++i)\n\t\t{\n\t\t\tif (this._senders[i].canUse && this._senders[i].fromList.length && (this._senders[i].id === defaultSenderId || !defaultSender))\n\t\t\t{\n\t\t\t\tdefaultSender = this._senders[i];\n\t\t\t}\n\n\t\t\tif (this._senders[i].id === 'rest')\n\t\t\t{\n\t\t\t\trestSender = this._senders[i];\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._senders[i].name,\n\t\t\t\tsender: this._senders[i],\n\t\t\t\tonclick: handler,\n\t\t\t\tclassName: (!this._senders[i].canUse || !this._senders[i].fromList.length)\n\t\t\t\t\t? 'crm-sms-send-popup-menu-item-disabled menu-popup-no-icon' : ''\n\t\t\t});\n\t\t}\n\n\t\tif (defaultSender && this._isSenderFixed)\n\t\t{\n\t\t\tthis.switchToFixedSenderAppearance(defaultSender);\n\t\t\treturn;\n\t\t}\n\n\t\tif (restSender)\n\t\t{\n\t\t\tif (restSender.fromList.length > 0)\n\t\t\t{\n\t\t\t\tmenuItems.push({delimiter: true});\n\t\t\t\tfor (let i = 0; i < restSender.fromList.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tmenuItems.push({\n\t\t\t\t\t\ttext: restSender.fromList[i].name,\n\t\t\t\t\t\tsender: restSender,\n\t\t\t\t\t\tfrom: restSender.fromList[i],\n\t\t\t\t\t\tonclick: handler\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tmenuItems.push({delimiter: true}, {\n\t\t\t\ttext: Loc.getMessage('CRM_SMS_REST_MARKETPLACE'),\n\t\t\t\thref: this._linkToMarket,\n\t\t\t\ttarget: '_blank'\n\t\t\t});\n\t\t}\n\n\t\tif (defaultSender)\n\t\t{\n\t\t\tthis.setSender(defaultSender);\n\t\t}\n\n\t\tBX.bind(this._senderSelectorNode, 'click', this.openMenu.bind(this, 'sender', this._senderSelectorNode, menuItems));\n\t}\n\n\tonSenderSelectorClick(e, item)\n\t{\n\t\tif (item.sender)\n\t\t{\n\t\t\tif (!item.sender.canUse || !item.sender.fromList.length)\n\t\t\t{\n\t\t\t\twindow.open(item.sender.manageUrl);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setSender(item.sender, true);\n\t\t\tconst from = item.from ? item.from : item.sender.fromList[0];\n\t\t\tthis.setFrom(from, true);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetSender(sender, setAsDefault)\n\t{\n\t\tthis._senderId = sender.id;\n\t\tthis._fromList = sender.fromList;\n\t\tthis._senderSelectorNode.textContent = sender.shortName ? sender.shortName : sender.name;\n\n\t\tconst visualFn = sender.id === 'rest' ? 'hide' : 'show';\n\t\tBX[visualFn](this._fromContainerNode);\n\n\t\tif (setAsDefault)\n\t\t{\n\t\t\tBX.userOptions.save(\"crm\", \"sms_manager_editor\", \"senderId\", this._senderId);\n\t\t}\n\t}\n\n\tinitFromSelector()\n\t{\n\t\tif (this._fromList.length > 0)\n\t\t{\n\t\t\tconst defaultFromId = this._defaults.from || this._fromList[0].id;\n\t\t\tlet defaultFrom = null;\n\t\t\tfor (let i = 0; i < this._fromList.length; ++i)\n\t\t\t{\n\t\t\t\tif (this._fromList[i].id === defaultFromId || !defaultFrom)\n\t\t\t\t{\n\t\t\t\t\tdefaultFrom = this._fromList[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (defaultFrom)\n\t\t\t{\n\t\t\t\tthis.setFrom(defaultFrom);\n\t\t\t}\n\t\t}\n\n\t\tBX.bind(this._fromSelectorNode, 'click', this.onFromSelectorClick.bind(this));\n\t}\n\n\tonFromSelectorClick(e)\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onFromSelectorItemClick.bind(this);\n\n\t\tfor (let i = 0; i < this._fromList.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._fromList[i].name,\n\t\t\t\tfrom: this._fromList[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t}\n\n\t\tthis.openMenu('from_'+this._senderId, this._fromSelectorNode, menuItems, e);\n\t}\n\n\tonFromSelectorItemClick(e, item)\n\t{\n\t\tif (item.from)\n\t\t{\n\t\t\tthis.setFrom(item.from, true);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetFrom(from: SenderData, setAsDefault: ?boolean): void\n\t{\n\t\tthis._from = from.id;\n\n\t\tif (this._senderId === 'rest')\n\t\t{\n\t\t\tthis._senderSelectorNode.textContent = from.name;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._fromSelectorNode.textContent = from.name;\n\t\t}\n\n\t\tif (setAsDefault)\n\t\t{\n\t\t\tBX.userOptions.save(\"crm\", \"sms_manager_editor\", \"from\", this._from);\n\t\t}\n\t}\n\n\tinitClientContainer()\n\t{\n\t\tif (this._communications.length === 0)\n\t\t{\n\t\t\tBX.hide(this._clientContainerNode);\n\t\t}\n\t}\n\n\tinitClientSelector()\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onClientSelectorClick.bind(this);\n\n\t\tfor (let i = 0; i < this._communications.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._communications[i].caption,\n\t\t\t\tclient: this._communications[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t\tif (i === 0)\n\t\t\t{\n\t\t\t\tthis.setClient(this._communications[i]);\n\t\t\t}\n\t\t}\n\n\t\tBX.bind(this._clientSelectorNode, 'click', this.openMenu.bind(this, 'comm', this._clientSelectorNode, menuItems));\n\t}\n\n\tonClientSelectorClick(e, item)\n\t{\n\t\tif (item.client)\n\t\t{\n\t\t\tthis.setClient(item.client);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetClient(client)\n\t{\n\t\tthis._commEntityTypeId = client.entityTypeId;\n\t\tthis._commEntityId = client.entityId;\n\t\tthis._clientSelectorNode.textContent = client.caption;\n\t\tthis._toList = client.phones;\n\t\tthis.setTo(client.phones[0]);\n\t}\n\n\tinitToSelector()\n\t{\n\t\tBX.bind(this._toSelectorNode, 'click', this.onToSelectorClick.bind(this));\n\t}\n\n\tonToSelectorClick(e)\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onToSelectorItemClick.bind(this);\n\n\t\tfor (let i = 0; i < this._toList.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._toList[i].valueFormatted || this._toList[i].value,\n\t\t\t\tto: this._toList[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t}\n\n\t\tthis.openMenu('to_'+this._commEntityTypeId+'_'+this._commEntityId, this._toSelectorNode, menuItems, e);\n\t}\n\n\tonToSelectorItemClick(e, item)\n\t{\n\t\tif (item.to)\n\t\t{\n\t\t\tthis.setTo(item.to);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetTo(to)\n\t{\n\t\tthis._to = to.value;\n\t\tthis._toSelectorNode.textContent = to.valueFormatted || to.value;\n\t}\n\n\topenMenu(menuId, bindElement, menuItems, e)\n\t{\n\t\tif (this._shownMenuId === menuId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._shownMenuId !== null && this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t\tthis._shownMenuId = null;\n\t\t}\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id + menuId,\n\t\t\tbindElement,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 36,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupClose: this.onMenuClose.bind(this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t\te.preventDefault();\n\t}\n\n\tonMenuClose()\n\t{\n\t\tthis._shownMenuId = null;\n\t\tthis._menu = null;\n\t}\n\n\tinitMessageLengthCounter()\n\t{\n\t\tthis._messageLengthMax = parseInt(this._messageLengthCounterNode.getAttribute('data-length-max'));\n\t\tBX.bind(this._input, 'keyup', this.setMessageLengthCounter.bind(this));\n\t}\n\n\tsetMessageLengthCounter()\n\t{\n\t\tconst length = this._input.value.length;\n\t\tthis._messageLengthCounterNode.textContent = length;\n\n\t\tconst classFn = length >= this._messageLengthMax ? 'addClass' : 'removeClass';\n\t\tBX[classFn](this._messageLengthCounterNode, 'sms-symbol-counter-number-overhead');\n\t}\n\n\tinitButtons()\n\t{\n\t\tBX.bind(this.saveButton, 'click', this.save.bind(this));\n\t\tBX.bind(this.cancelButton, 'click', this.cancel.bind(this));\n\t}\n\n\tsave()\n\t{\n\t\tconst text = this._input.value;\n\t\tif(text === \"\")\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._communications.length)\n\t\t{\n\t\t\talert(Loc.getMessage('CRM_SMS_ERROR_NO_COMMUNICATIONS'));\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = true;\n\n\t\tBX.ajax({\n\t\t\turl: BX.util.add_url_param(this._serviceUrl, {\n\t\t\t\taction: 'save_sms_message',\n\t\t\t\tsender: this._senderId,\n\t\t\t}),\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tsite: Loc.getMessage('SITE_ID'),\n\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t\tACTION: 'SAVE_SMS_MESSAGE',\n\t\t\t\tSENDER_ID: this._senderId,\n\t\t\t\tMESSAGE_FROM: this._from,\n\t\t\t\tMESSAGE_TO: this._to,\n\t\t\t\tMESSAGE_BODY: text,\n\t\t\t\tMESSAGE_TEMPLATE: this._templateCode,\n\t\t\t\tMESSAGE_PLACEHOLDERS: this._templatePlaceholders,\n\t\t\t\tOWNER_TYPE_ID: this._ownerTypeId,\n\t\t\t\tOWNER_ID: this._ownerId,\n\t\t\t\tTO_ENTITY_TYPE_ID: this._commEntityTypeId,\n\t\t\t\tTO_ENTITY_ID: this._commEntityId,\n\t\t\t},\n\t\t\tonsuccess: this.onSaveSuccess.bind(this),\n\t\t\tonfailure: this.onSaveFailure.bind(this),\n\t\t});\n\t}\n\n\tcancel()\n\t{\n\t\tif(BX.SidePanel)\n\t\t{\n\t\t\tconst curSlider = BX.SidePanel.Instance.getSliderByWindow(window);\n\t\t\tif(curSlider)\n\t\t\t{\n\t\t\t\tcurSlider.close();\n\t\t\t}\n\t\t}\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = false;\n\n\t\tconst error = BX.prop.getString(data, \"ERROR\", \"\");\n\t\tif(error !== \"\")\n\t\t{\n\t\t\talert(error);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.cancel();\n\t}\n\n\tonSaveFailure(data)\n\t{\n\t\tthis._isRequestRunning = false;\n\t}\n}\n\nnamespace.CrmSmsSend = CrmSmsSend;"],"names":["namespace","Reflection","CrmSmsSend","container","_senderId","_from","_commEntityTypeId","_commEntityId","_to","_templateCode","_templatePlaceholders","_fromList","_toList","_input","_menu","_isMenuShown","_shownMenuId","_canUse","_canSendMessage","_manageUrl","_senders","_defaults","_communications","_container","_isRequestRunning","_isSenderFixed","saveButton","cancelButton","_serviceUrl","_ownerTypeId","_ownerId","settings","BX","prop","getBoolean","getString","getArray","getObject","senderId","from","getInteger","_linkToMarket","_title","querySelector","_senderContainerNode","_senderSelectorNode","_senderSelectorBlockNode","_fromContainerNode","_fromSelectorNode","_clientContainerNode","_clientSelectorNode","_toSelectorNode","_messageLengthCounterNode","initSenderSelector","initFromSelector","initClientContainer","initClientSelector","initToSelector","initMessageLengthCounter","initButtons","setMessageLengthCounter","sender","setSender","subtitleNode","document","classList","add","innerHTML","Loc","getMessage","name","style","display","defaultSenderId","defaultSender","canUse","restSender","menuItems","handler","onSenderSelectorClick","bind","i","length","fromList","id","push","text","onclick","className","switchToFixedSenderAppearance","delimiter","href","target","openMenu","e","item","window","open","manageUrl","setFrom","close","setAsDefault","textContent","shortName","visualFn","userOptions","save","defaultFromId","defaultFrom","onFromSelectorClick","onFromSelectorItemClick","hide","onClientSelectorClick","caption","client","setClient","entityTypeId","entityId","phones","setTo","onToSelectorClick","onToSelectorItemClick","valueFormatted","value","to","menuId","bindElement","PopupMenu","show","_id","offsetTop","offsetLeft","angle","position","offset","events","onPopupClose","onMenuClose","currentItem","preventDefault","_messageLengthMax","parseInt","getAttribute","classFn","cancel","alert","ajax","url","util","add_url_param","action","method","dataType","data","site","sessid","bitrix_sessid","ACTION","SENDER_ID","MESSAGE_FROM","MESSAGE_TO","MESSAGE_BODY","MESSAGE_TEMPLATE","MESSAGE_PLACEHOLDERS","OWNER_TYPE_ID","OWNER_ID","TO_ENTITY_TYPE_ID","TO_ENTITY_ID","onsuccess","onSaveSuccess","onfailure","onSaveFailure","SidePanel","curSlider","Instance","getSliderByWindow","error"],"mappings":"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"}