{"version":3,"file":"script.js","sources":["src/js/progressbar.es6.js","src/js/counters.es6.js","src/js/leftmenu.es6.js","src/js/list.es6.js","script.es6.js"],"sourcesContent":["export class ProgressBar\n{\n\t#node;\n\t#errorTitleNode;\n\t#errorTextNode;\n\t#errorBoxNode;\n\t#syncButton;\n\t#errorHintNode;\n\n\tconstructor(node)\n\t{\n\t\tthis.#node = node;\n\t}\n\n\tsetSyncButton(button)\n\t{\n\t\tthis.#syncButton = button;\n\t}\n\n\tgetSyncButton()\n\t{\n\t\treturn this.#syncButton;\n\t}\n\n\tgetErrorBoxNode()\n\t{\n\t\treturn this.#errorBoxNode;\n\t}\n\n\tsetErrorBoxNode(errorBoxNode)\n\t{\n\t\tthis.#errorBoxNode = errorBoxNode;\n\t}\n\n\tsetErrorTitleNode(errorTitleNode)\n\t{\n\t\tthis.#errorTitleNode = errorTitleNode;\n\t}\n\n\tsetErrorTextNode(errorTextNode)\n\t{\n\t\tthis.#errorTextNode = errorTextNode;\n\t}\n\n\tsetErrorHintNode(errorHintNode)\n\t{\n\t\tthis.#errorHintNode = errorHintNode;\n\t}\n\n\tgetErrorTextNode()\n\t{\n\t\treturn this.#errorTextNode;\n\t}\n\n\tgetErrorHintNode()\n\t{\n\t\treturn this.#errorHintNode;\n\t}\n\n\tgetErrorTitleNode()\n\t{\n\t\treturn this.#errorTitleNode;\n\t}\n\n\tshow()\n\t{\n\t\tif(this.getSyncButton() !== undefined) this.getSyncButton().setWaiting(true);\n\t\tthis.#node.classList.add(\"mail-progress-show\");\n\t\tthis.#node.classList.remove(\"mail-progress-hide\");\n\t}\n\n\thide()\n\t{\n\t\tif(this.getSyncButton() !== undefined) this.getSyncButton().setWaiting(false);\n\t\tthis.#node.classList.add(\"mail-progress-hide\");\n\t\tthis.#node.classList.remove(\"mail-progress-show\");\n\t}\n\n\thideErrorBox()\n\t{\n\t\tthis.#errorBoxNode.classList.add(\"mail-hidden-element\");\n\t\tthis.#errorBoxNode.classList.remove(\"mail-visible-element\");\n\t}\n\n\tshowErrorBox()\n\t{\n\t\tthis.#errorBoxNode.classList.add(\"mail-visible-element\");\n\t\tthis.#errorBoxNode.classList.remove(\"mail-hidden-element\");\n\t}\n}","import { BaseEvent, EventEmitter } from \"main.core.events\";\n\nexport class Counters\n{\n\tcounters = [];\n\thiddenCountersForTotalCounter = [];\n\tshortcuts = [];\n\t#name;\n\tselectedDirectory;\n\n\tconstructor(name,selectedDirectory)\n\t{\n\t\tthis.#name = name;\n\t\tthis.setDirectory(selectedDirectory);\n\t}\n\n\tgetDirPath(shortcut)\n\t{\n\t\tif(shortcut === undefined)\n\t\t{\n\t\t\tshortcut = '';\n\t\t}\n\n\t\tif(this.shortcuts[shortcut] !== undefined)\n\t\t{\n\t\t\treturn this.shortcuts[shortcut];\n\t\t}\n\n\t\treturn shortcut;\n\t}\n\n\tgetShortcut(path)\n\t{\n\t\t//because they have a closure\n\t\treturn this.getDirPath(path);\n\t}\n\n\tsetDirectory(name)\n\t{\n\t\tif(name === undefined)\n\t\t{\n\t\t\tname = '';\n\t\t}\n\n\t\tif(this.shortcuts[name])\n\t\t{\n\t\t\tthis.selectedDirectory = this.shortcuts[name];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selectedDirectory = name;\n\t\t}\n\n\t\tlet resultCounters = {};\n\t\tresultCounters[this.selectedDirectory] = this.getCounter(this.selectedDirectory);\n\t\tthis.senCounterUpdateEvent(resultCounters);\n\t}\n\n\tsetShortcut(shortcutName,name)\n\t{\n\t\t//backlink\n\t\tthis.shortcuts[shortcutName] = name;\n\t\tthis.shortcuts[name] = shortcutName;\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.#name;\n\t}\n\n\tsetHiddenCountersForTotalCounter(counterNames)\n\t{\n\t\tfor (let counter of counterNames)\n\t\t{\n\t\t\tthis.hiddenCountersForTotalCounter[counter] = 'disabled';\n\t\t}\n\t}\n\n\tisHidden(name):boolean\n\t{\n\t\tif(this.hiddenCountersForTotalCounter[name] === 'disabled')\n\t\t{\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetTotalCounter()\n\t{\n\t\tlet counters = 0;\n\t\tfor (let name in this.counters)\n\t\t{\n\t\t\tif(name in this.hiddenCountersForTotalCounter)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tcounters += this.counters[name];\n\t\t}\n\n\t\treturn counters;\n\t}\n\n\tgetCounterObjects()\n\t{\n\t\treturn this.counters;\n\t}\n\n\tgetCounter(name)\n\t{\n\t\treturn this.counters[name];\n\t}\n\n\taddCounter(name,count)\n\t{\n\t\tthis.counters[name] = Number(count);\n\t\treturn this.counters[name];\n\t}\n\n\taddCounters(counters)\n\t{\n\t\tlet resultCounters = {};\n\n\t\tfor (let i = 0; i < counters.length; i++)\n\t\t{\n\t\t\tconst counter = counters[i]\n\t\t\tconst path = counter['path'];\n\t\t\tthis.addCounter(path,counter['count']);\n\n\t\t\tif(this.shortcuts[path])\n\t\t\t{\n\t\t\t\tresultCounters[this.shortcuts[path]] = counter['count'];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresultCounters[path] = counter['count'];\n\t\t\t}\n\n\t\t}\n\n\t\tthis.senCounterUpdateEvent(resultCounters);\n\t}\n\n\t/*Set counters as when adding. Old counters with different names are retained*/\n\tsetCounters(counters)\n\t{\n\t\tthis.addCounters(counters);\n\t}\n\n\tisExists(name)\n\t{\n\t\treturn this.counters[name] !== undefined;\n\t}\n\n\tincreaseCounter(name,count = 1 )\n\t{\n\t\tif(name in this.hiddenCountersForTotalCounter)\n\t\t{\n\t\t\treturn \"hidden counters for total counter\";\n\t\t}\n\n\t\tif(!this.isExists(name))\n\t\t{\n\t\t\treturn \"no counter\";\n\t\t}\n\t\tthis.counters[name] += Number(count);\n\t}\n\n\tlowerCounter(name,count = 1 )\n\t{\n\t\tif(name in this.hiddenCountersForTotalCounter)\n\t\t{\n\t\t\treturn \"hidden counters for total counter\";\n\t\t}\n\n\t\tif(!this.isExists(name))\n\t\t{\n\t\t\treturn \"no counter\";\n\t\t}\n\n\t\tconst newValue = this.counters[name] - Number(count);\n\t\tif(newValue < 0)\n\t\t{\n\t\t\treturn \"negative value\";\n\t\t}\n\n\t\tthis.counters[name] = newValue;\n\t}\n\n\t/*Change counters by rule*/\n\tupdateCounters(counters = [\n\t\t{\n\t\t\tname: 'counter1',\n\t\t\tcount: 2,\n\t\t\tincrease: false,\n\t\t\tlower: true,\n\t\t},\n\t\t{\n\t\t\tname: 'counter2',\n\t\t\tcount: 2,\n\t\t\tincrease: true,\n\t\t\tlower: false,\n\t\t},\n\t])\n\t{\n\t\tlet resultCounters = {};\n\t\tlet countersAreNotLoadedFromTheServer = false;\n\n\t\tfor (let i = 0; i < counters.length; i++)\n\t\t{\n\t\t\tconst counter = counters[i];\n\t\t\tconst name = counter['name'];\n\n\t\t\tif(counter['lower'])\n\t\t\t{\n\t\t\t\tif(this.lowerCounter(name,counter['count']) === \"negative value\")\n\t\t\t\t{\n\t\t\t\t\tcountersAreNotLoadedFromTheServer = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(counter['increase'] && countersAreNotLoadedFromTheServer === false)\n\t\t\t{\n\t\t\t\tthis.increaseCounter(name,counter['count'])\n\t\t\t}\n\n\t\t\tif(this.shortcuts[name])\n\t\t\t{\n\t\t\t\tresultCounters[this.shortcuts[name]] = this.getCounter(name);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresultCounters[name] = this.getCounter(name);\n\t\t\t}\n\t\t}\n\n\t\tthis.senCounterUpdateEvent(resultCounters);\n\t}\n\n\tsenCounterUpdateEvent(counters)\n\t{\n\t\tconst event = new BaseEvent({\n\t\t\tdata: {\n\t\t\t\tcounters: counters,\n\t\t\t\thidden: this.hiddenCountersForTotalCounter,\n\t\t\t\tselectedDirectory: this.selectedDirectory,\n\t\t\t\tname: this.getName(),\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.emit('BX.Mail.Home:updatingCounters', event);\n\t}\n\n}","import { EventEmitter } from \"main.core.events\";\nimport { DirectoryMenu } from 'mail.directorymenu';\n\nexport class LeftMenu\n{\n\tconstructor(config={\n\t\tdirsWithUnseenMailCounters: {},\n\t\tmailboxId:'',\n\t\tfilterId: '',\n\t\tsystemDirs :\n\t\t{\n\t\t\tspam: 'Spam',\n\t\t\ttrash: 'Trash',\n\t\t\toutcome: 'Outcome',\n\t\t\tdrafts: 'Drafts',\n\t\t\tinbox: 'Inbox',\n\t\t}\n\t})\n\t{\n\t\tconst leftDirectoryMenuWrapper = document.querySelector('.mail-left-menu-wrapper');\n\n\t\tthis.directoryMenu = new DirectoryMenu({\n\t\t\tdirsWithUnseenMailCounters: config['dirsWithUnseenMailCounters'],\n\t\t\tfilterId: config['filterId'],\n\t\t\tsystemDirs: config['systemDirs'],\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Mail.Sync:newLettersArrived', () => {\n\n\t\t\tBX.ajax.runComponentAction('bitrix:mail.client.message.list', 'getDirsWithUnseenMailCounters', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tmailboxId: config['mailboxId'],\n\t\t\t\t},\n\t\t\t}).then(response => {\n\t\t\t\tconst data = response.data || {};\n\t\t\t\tBX.Mail.Home.Counters.setCounters(data);\n\t\t\t});\n\t\t});\n\n\t\tleftDirectoryMenuWrapper.append(this.directoryMenu.getNode());\n\t}\n}","import { EventEmitter } from \"main.core.events\";\nimport { Loc } from 'main.core';\n\nexport class List\n{\n\tconstructor(options)\n\t{\n\t\tthis.mailReadAllButton = options.mailReadAllButton;\n\t\tthis.gridId = options.gridId;\n\t\tthis.mailboxId = options.mailboxId;\n\t\tthis.canMarkSpam = options.canMarkSpam;\n\t\tthis.canDelete = options.canDelete;\n\t\tthis.ERROR_CODE_CAN_NOT_DELETE = options.ERROR_CODE_CAN_NOT_DELETE;\n\t\tthis.ERROR_CODE_CAN_NOT_MARK_SPAM = options.ERROR_CODE_CAN_NOT_MARK_SPAM;\n\t\tthis.disabledClassName = 'js-disabled';\n\t\tthis.userInterfaceManager = new BX.Mail.Client.Message.List.UserInterfaceManager(options);\n\t\tthis.userInterfaceManager.resetGridSelection = this.resetGridSelection.bind(this);\n\t\tthis.userInterfaceManager.isSelectedRowsHaveClass = this.isSelectedRowsHaveClass.bind(this);\n\t\tthis.userInterfaceManager.getGridInstance = this.getGridInstance.bind(this);\n\t\tthis.cache = {};\n\t\tthis.addEventHandlers();\n\n\t\tBX.Mail.Client.Message.List[options.id] = this;\n\t};\n\n\taddEventHandlers()\n\t{\n\t\t// todo delete this hack\n\t\t// it is here to prevent grid's title changing after filter apply\n\t\tBX.ajax.UpdatePageData = (function() {\n\t\t});\n\n\t\tEventEmitter.subscribe(\n\t\t\t'onSubMenuShow',\n\t\t\tfunction(event){\n\t\t\t\tconst menuItem = event.target;\n\t\t\t\tconst container = menuItem.getMenuWindow().getPopupWindow().getPopupContainer();\n\t\t\t\tlet id = null;\n\n\t\t\t\tif (container)\n\t\t\t\t{\n\t\t\t\t\tid = BX.data(container, 'grid-row-id');\n\t\t\t\t}\n\n\t\t\t\tBX.data(\n\t\t\t\t\tmenuItem.getSubMenu().getPopupWindow().getPopupContainer(),\n\t\t\t\t\t'grid-row-id',\n\t\t\t\t\tmenuItem.gridRowId || id,\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\n\t\tEventEmitter.subscribe('Mail::directoryChanged', () =>\n\t\t{\n\t\t\tthis.resetGridSelection();\n\t\t})\n\n\t\tEventEmitter.subscribe('BX.Mail.Home:updatingCounters', (event) => {\n\t\t\tif(event['data']['name']!== 'mailboxCounters')\n\t\t\t{\n\t\t\t\tconst counters = event['data']['counters'];\n\t\t\t\tBX.Mail.Home.LeftMenuNode.directoryMenu.setCounters(counters);\n\t\t\t\tconst currentFolderCount = counters[this.getCurrentFolder()];\n\n\t\t\t\tBX.Mail.Home.mailboxCounters.setCounters([\n\t\t\t\t\t{\n\t\t\t\t\t\tpath: 'unseenCountInCurrentMailbox',\n\t\t\t\t\t\tcount: BX.Mail.Home.Counters.getTotalCounter(),\n\t\t\t\t\t},\n\t\t\t\t]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.userInterfaceManager.updateLeftMenuCounter();\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Main.Menu.Item:onmouseenter', function(event) {\n\t\t\tconst menuItem = event.target;\n\n\t\t\tif (!menuItem.dataset || !menuItem.getMenuWindow())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuWindow = menuItem.getMenuWindow();\n\t\t\tconst subMenuItems = menuWindow.getMenuItems();\n\n\t\t\tconst path = menuItem.dataset.path;\n\t\t\tconst hash = menuItem.dataset.dirMd5;\n\t\t\tconst hasChild = menuItem.dataset.hasChild;\n\n\t\t\tif (!hasChild)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < subMenuItems.length; i++)\n\t\t\t{\n\t\t\t\tconst item = subMenuItems[i];\n\n\t\t\t\tif (item.getId() === path)\n\t\t\t\t{\n\t\t\t\t\tconst hasSubMenu = item.hasSubMenu();\n\n\t\t\t\t\tif (hasSubMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.showSubMenu();\n\t\t\t\t\t\tconst subMenu = item.getSubMenu();\n\n\t\t\t\t\t\tlet hasLoadingItem = false;\n\n\t\t\t\t\t\tif (subMenu)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst items = subMenu.getMenuItems();\n\n\t\t\t\t\t\t\tfor (let k = 0; k < items.length; k++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst subItem = items[k];\n\n\t\t\t\t\t\t\t\tif (subItem.getId() === 'loading')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\thasLoadingItem = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!hasLoadingItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.loadLevelMenu(item, hash);\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(this));\n\n\t\tconst itemsMenu = document.querySelectorAll('.ical-event-control-menu');\n\n\t\tfor (let i = 0; i < itemsMenu.length; i++)\n\t\t{\n\t\t\titemsMenu[i].addEventListener('click', this.showICalMenuDropdown.bind(this));\n\t\t}\n\n\t\tBX.bindDelegate(document.body, 'click', { className: 'ical-event-control-button' }, this.onClickICalButton.bind(this));\n\t}\n\n\tloadLevelMenu(menuItem, hash)\n\t{\n\t\tconst menu = this.getCache(menuItem.getId());\n\t\tconst popup = BX.Main.PopupManager.getPopupById('menu-popup-popup-submenu-' + menuItem.getId());\n\n\t\tif (popup)\n\t\t{\n\t\t\tpopup.destroy();\n\t\t}\n\n\t\tif (menu)\n\t\t{\n\t\t\tmenuItem.destroySubMenu();\n\t\t\tmenuItem.addSubMenu(menu);\n\t\t\tmenuItem.showSubMenu();\n\t\t\treturn;\n\t\t}\n\n\t\tconst subItem = {\n\t\t\t'id': 'loading',\n\t\t\t'text': Loc.getMessage('MAIL_CLIENT_BUTTON_LOADING'),\n\t\t\t'disabled': true,\n\t\t};\n\n\t\tmenuItem.destroySubMenu();\n\t\tmenuItem.addSubMenu([subItem]);\n\t\tmenuItem.showSubMenu();\n\n\t\tBX.ajax.runComponentAction('bitrix:mail.client.config.dirs', 'level', {\n\t\t\tmode: 'class',\n\t\t\tdata: { mailboxId: this.mailboxId, dir: { path: menuItem.getId(), dirMd5: hash } },\n\t\t}).then(\n\t\t\tfunction(response) {\n\t\t\t\tconst dirs = response.data.dirs;\n\t\t\t\tconst items = [];\n\n\t\t\t\tfor (let i = 0; i < dirs.length; i++)\n\t\t\t\t{\n\t\t\t\t\tconst hasChild = /(HasChildren)/i.test(dirs[i].FLAGS);\n\t\t\t\t\tconst item = {\n\t\t\t\t\t\t'id': dirs[i].PATH,\n\t\t\t\t\t\t'text': dirs[i].NAME,\n\t\t\t\t\t\t'dataset': {\n\t\t\t\t\t\t\t'path': dirs[i].PATH,\n\t\t\t\t\t\t\t'dirMd5': dirs[i].DIR_MD5,\n\t\t\t\t\t\t\t'isDisabled': dirs[i].IS_DISABLED,\n\t\t\t\t\t\t\t'hasChild': hasChild,\n\t\t\t\t\t\t},\n\t\t\t\t\t\titems: hasChild ? [{\n\t\t\t\t\t\t\tid: 'loading',\n\t\t\t\t\t\t\t'text': Loc.getMessage('MAIL_CLIENT_BUTTON_LOADING'),\n\t\t\t\t\t\t\t'disabled': true,\n\t\t\t\t\t\t}] : [],\n\t\t\t\t\t};\n\n\t\t\t\t\titems.push(item);\n\t\t\t\t}\n\n\t\t\t\tthis.setCache(menuItem.getId(), items);\n\n\t\t\t\tconst popup = BX.Main.PopupManager.getPopupById('menu-popup-popup-submenu-' + menuItem.getId());\n\t\t\t\tconst isShown = menuItem.getMenuWindow().getPopupWindow().isShown();\n\n\t\t\t\tif (popup)\n\t\t\t\t{\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t}\n\n\t\t\t\tif (isShown)\n\t\t\t\t{\n\t\t\t\t\tmenuItem.destroySubMenu();\n\t\t\t\t\tmenuItem.addSubMenu(items);\n\t\t\t\t\tmenuItem.showSubMenu();\n\t\t\t\t}\n\t\t\t}.bind(this),\n\t\t\tfunction(response) {\n\t\t\t}.bind(this),\n\t\t);\n\t}\n\n\tonCrmClick(id)\n\t{\n\t\tconst selected = this.getGridInstance().getRows().getSelected();\n\t\tconst row = id ? this.getGridInstance().getRows().getById(id) : selected[0];\n\t\tif (!(row && row.node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst addToCrm = this.userInterfaceManager.isAddToCrmActionAvailable(row.node);\n\t\tconst messageIdNode = row.node.querySelector('[data-message-id]');\n\t\tif (!(messageIdNode.dataset && messageIdNode.dataset.messageId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(id === undefined)\n\t\t{\n\t\t\tthis.resetGridSelection();\n\t\t}\n\n\t\tif (addToCrm)\n\t\t{\n\t\t\tconst crmBtnInRow = row.node.querySelector('.mail-binding-crm.mail-ui-not-active');\n\n\t\t\tif(crmBtnInRow)\n\t\t\t{\n\t\t\t\tcrmBtnInRow.startWait();\n\t\t\t}\n\n\t\t\tif (typeof this.isAddingToCrmInProgress !== \"object\")\n\t\t\t{\n\t\t\t\tthis.isAddingToCrmInProgress = {};\n\t\t\t}\n\t\t\tif (this.isAddingToCrmInProgress[id] === true)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.isAddingToCrmInProgress[id] = true;\n\n\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t'bitrix:mail.client',\n\t\t\t\t'createCrmActivity',\n\t\t\t\t{\n\t\t\t\t\tmode: 'ajax',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmessageId: messageIdNode.dataset.messageId,\n\t\t\t\t\t},\n\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\t'groupCount': selected.length,\n\t\t\t\t\t\t'bindings': this.getRowsBindings([row]),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t).then(\n\t\t\t\tfunction(id) {\n\t\t\t\t\tthis.isAddingToCrmInProgress[id] = false;\n\t\t\t\t\tthis.notify(Loc.getMessage('MAIL_MESSAGE_LIST_NOTIFY_ADDED_TO_CRM'));\n\t\t\t\t}.bind(this, id),\n\t\t\t\tfunction(json) {\n\n\t\t\t\t\tif(crmBtnInRow)\n\t\t\t\t\t{\n\t\t\t\t\t\tcrmBtnInRow.stopWait();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.isAddingToCrmInProgress[id] = false;\n\t\t\t\t\tif (json.errors && json.errors.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.notify(json.errors.map(\n\t\t\t\t\t\t\tfunction(item) {\n\t\t\t\t\t\t\t\treturn item.message;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t).join('<br>'), 5000);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.notify(Loc.getMessage('MAIL_MESSAGE_LIST_NOTIFY_ADD_TO_CRM_ERROR'));\n\t\t\t\t\t}\n\t\t\t\t}.bind(this),\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.userInterfaceManager.onCrmBindingDeleted(messageIdNode.dataset.messageId);\n\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t'bitrix:mail.client',\n\t\t\t\t'removeCrmActivity',\n\t\t\t\t{\n\t\t\t\t\tmode: 'ajax',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmessageId: messageIdNode.dataset.messageId,\n\t\t\t\t\t},\n\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\t'groupCount': selected.length,\n\t\t\t\t\t\t'bindings': this.getRowsBindings([row]),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t).then(function(messageIdNode) {\n\t\t\t\tthis.notify(Loc.getMessage('MAIL_MESSAGE_LIST_NOTIFY_EXCLUDED_FROM_CRM'));\n\t\t\t}.bind(this, messageIdNode));\n\t\t}\n\n\t\tlet selectedIds = this.getGridInstance().getRows().getSelectedIds();\n\t\tif(selectedIds.length === 1 && selectedIds[0]===id)\n\t\t{\n\t\t\tthis.resetGridSelection();\n\t\t}\n\t}\n\n\tonViewClick(id)\n\t{\n\t\tif (id === undefined && this.getGridInstance().getRows().getSelectedIds().length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\t// @TODO: path\n\t\tBX.SidePanel.Instance.open(\"/mail/message/\" + id, {\n\t\t\twidth: 1080,\n\t\t\tloader: 'view-mail-loader',\n\t\t});\n\t}\n\n\tonDeleteImmediately(id)\n\t{\n\t\tlet additionalOptions =\n\t\t{\n\t\t\t'deleteImmediately' : true,\n\t\t};\n\t\tthis.onDeleteClick(id,additionalOptions);\n\t}\n\n\tonDeleteClick(id,additionalOptions)\n\t{\n\t\tconst selected = this.getGridInstance().getRows().getSelected();\n\t\tif (id === undefined && selected.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (!this.canDelete)\n\t\t{\n\t\t\tthis.showDirsSlider();\n\t\t\treturn;\n\t\t}\n\t\tlet options = {\n\t\t\tparams: (additionalOptions !== undefined) ? additionalOptions : {},\n\t\t\tkeepRows: true,\n\t\t\tanalyticsLabel: {\n\t\t\t\t'groupCount': selected.length,\n\t\t\t\t'bindings': this.getRowsBindings(id ? [this.getGridInstance().getRows().getById(id)] : selected),\n\t\t\t},\n\t\t};\n\t\tlet selectedIds;\n\n\t\tif(id === undefined)\n\t\t{\n\t\t\tselectedIds = BX.Mail.Home.Grid.getSelectedIds();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselectedIds = [id];\n\t\t}\n\n\t\tselectedIds = this.filterRowsByClassName(this.disabledClassName, selectedIds, true);\n\t\toptions.ids = selectedIds;\n\n\t\tif (this.userInterfaceManager.isCurrentFolderTrash || (additionalOptions !== undefined && additionalOptions['deleteImmediately']) )\n\t\t{\n\t\t\tconst confirmPopup = this.getConfirmDeletePopup(options);\n\t\t\tconfirmPopup.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.Mail.Home.Grid.hideRowByIds(selectedIds);\n\n\t\t\tconst unseenRowsIdsCount = this.filterRowsByClassName('mail-msg-list-cell-unseen', selectedIds).length;\n\n\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t{\n\t\t\t\t\tname: this.getCurrentFolder(),\n\t\t\t\t\tlower: true,\n\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t},\n\t\t\t]);\n\n\t\t\tthis.runAction('delete', options,() =>\n\t\t\t\tBX.Mail.Home.Grid.reloadTable()\n\t\t\t);\n\t\t\tif(id === undefined)\n\t\t\t{\n\t\t\t\tthis.resetGridSelection();\n\t\t\t}\n\t\t}\n\t}\n\n\tonMoveToFolderClick(event)\n\t{\n\t\tconst folderOptions = event.currentTarget.dataset;\n\t\tconst toFolderByPath = folderOptions.path;\n\t\tconst toFolderByName = toFolderByPath;\n\n\t\tif(toFolderByPath === this.getCurrentFolder())\n\t\t{\n\t\t\tthis.notify(Loc.getMessage('MESSAGES_ALREADY_EXIST_IN_FOLDER'));\n\t\t\treturn;\n\t\t}\n\n\t\tlet id = undefined;\n\t\tconst popupSubmenu = BX.findParent(event.currentTarget, { className: 'popup-window' });\n\t\tif (popupSubmenu)\n\t\t{\n\t\t\tid = BX.data(popupSubmenu, 'grid-row-id');\n\t\t}\n\t\tconst isDisabled = JSON.parse(folderOptions.isDisabled);\n\n\t\tif ((id === undefined && this.getGridInstance().getRows().getSelectedIds().length === 0) || isDisabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet selected = this.getGridInstance().getRows().getSelected();\n\t\tlet idsForMoving = (id ? [id] : this.getGridInstance().getRows().getSelectedIds());\n\t\tidsForMoving = this.filterRowsByClassName(this.disabledClassName, idsForMoving, true);\n\t\tif (!idsForMoving.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// to hide the context menu\n\t\tBX.onCustomEvent('Grid::updated');\n\n\t\tlet selectedIds;\n\n\t\tif(id === undefined)\n\t\t{\n\t\t\tselectedIds = BX.Mail.Home.Grid.getSelectedIds();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselectedIds = [id];\n\t\t}\n\n\t\tBX.Mail.Home.Grid.hideRowByIds(selectedIds);\n\n\t\tconst unseenRowsIdsCount = this.filterRowsByClassName('mail-msg-list-cell-unseen', selectedIds).length;\n\n\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t{\n\t\t\t\tname:toFolderByName,\n\t\t\t\tincrease: true,\n\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: this.getCurrentFolder(),\n\t\t\t\tlower: true,\n\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t},\n\t\t]);\n\n\t\tthis.runAction(\n\t\t\t'moveToFolder',\n\t\t\t{\n\t\t\t\tkeepRows: true,\n\t\t\t\tids: idsForMoving,\n\t\t\t\tparams: {\n\t\t\t\t\tfolder: toFolderByPath,\n\t\t\t\t},\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t'groupCount': selected.length,\n\t\t\t\t\t'bindings': this.getRowsBindings(id ? [this.getGridInstance().getRows().getById(id)] : selected),\n\t\t\t\t},\n\t\t\t},\n\t\t\t()=> {\n\t\t\t\tBX.Mail.Home.Grid.reloadTable();\n\t\t\t}\n\t\t);\n\t\tif(id === undefined)\n\t\t{\n\t\t\tthis.resetGridSelection();\n\t\t}\n\t}\n\n\tonReadClick(id)\n\t{\n\t\tlet selected = [];\n\t\tlet resultIds = [];\n\n\t\tif(id === undefined)\n\t\t{\n\t\t\tselected = this.getGridInstance().getRows().getSelected();\n\t\t\tresultIds = this.getGridInstance().getRows().getSelectedIds();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet selectedIds = this.getGridInstance().getRows().getSelectedIds();\n\t\t\tif(selectedIds.length === 1 && selectedIds[0]===id)\n\t\t\t{\n\t\t\t\t/*if the action is non-group, but one cell is selected,\n\t\t\t\tthen the action was performed through the \"Action panel\"\n\t\t\t\tand the selection should be reset*/\n\t\t\t\tselected = this.getGridInstance().getRows().getSelected();\n\t\t\t\tresultIds = selectedIds;\n\t\t\t\tid = undefined;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresultIds = [id];\n\t\t\t}\n\n\t\t}\n\t\tif (id === undefined && selected.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst actionName = 'all' == id || this.isSelectedRowsHaveClass('mail-msg-list-cell-unseen', id) ? 'markAsSeen' : 'markAsUnseen';\n\n\t\tresultIds = this.filterRowsByClassName('mail-msg-list-cell-unseen', resultIds, actionName !== 'markAsSeen');\n\t\tresultIds = this.filterRowsByClassName(this.disabledClassName, resultIds, true);\n\n\t\tif (!resultIds.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = function() {\n\t\t\tthis.userInterfaceManager.onMessagesRead(resultIds, { action: actionName });\n\t\t\tconst currentFolder = this.getCurrentFolder();\n\n\t\t\tconst oldMessagesCount = actionName !== 'markAsSeen'? this.isSelectedRowsHaveClass('mail-msg-list-cell-old') : 0;\n\t\t\tlet countMessages = resultIds.length - oldMessagesCount;\n\n\t\t\tif (actionName === 'markAsSeen')\n\t\t\t{\n\t\t\t\tif ('all' === id)\n\t\t\t\t{\n\t\t\t\t\tcountMessages = BX.Mail.Home.Counters.getCounter(currentFolder) - oldMessagesCount;\n\t\t\t\t}\n\t\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t\t{\n\t\t\t\t\t\tname: currentFolder,\n\t\t\t\t\t\tlower: true,\n\t\t\t\t\t\tcount: countMessages,\n\t\t\t\t\t},\n\t\t\t\t]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t\t{\n\t\t\t\t\t\tname: currentFolder,\n\t\t\t\t\t\tincrease: true,\n\t\t\t\t\t\tcount: countMessages,\n\t\t\t\t\t},\n\t\t\t\t]);\n\t\t\t}\n\n\t\t\tif(id === undefined) {\n\t\t\t\tthis.resetGridSelection();\n\t\t\t}\n\n\t\t\tif ('all' == id)\n\t\t\t{\n\t\t\t\tresultIds['for_all'] = this.mailboxId + '-' + this.userInterfaceManager.getCurrentFolder();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\n\t\t\t}\n\n\t\t\tthis.userInterfaceManager.updateUnreadCounters();\n\n\t\t\tthis.runAction(actionName, {\n\t\t\t\tids: resultIds,\n\t\t\t\tkeepRows: true,\n\t\t\t\tsuccessParams: actionName,\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t'groupCount': selected.length,\n\t\t\t\t\t'bindings': this.getRowsBindings(id ? [this.getGridInstance().getRows().getById(id)] : selected),\n\t\t\t\t},\n\t\t\t\tonSuccess: false,\n\t\t\t});\n\n\t\t\treturn true;\n\t\t};\n\t\thandler.apply(this);\n\t}\n\n\tonSpamClick(id)\n\t{\n\t\tconst selected = this.getGridInstance().getRows().getSelected();\n\t\tif (id === undefined && selected.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (!this.canMarkSpam)\n\t\t{\n\t\t\tthis.showDirsSlider();\n\t\t\treturn;\n\t\t}\n\t\tconst actionName = this.isSelectedRowsHaveClass('js-spam', id) ? 'restoreFromSpam' : 'markAsSpam';\n\t\tlet resultIds = this.filterRowsByClassName('js-spam', id, actionName !== 'restoreFromSpam');\n\t\tresultIds = this.filterRowsByClassName(this.disabledClassName, resultIds, true);\n\t\tif (!resultIds.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst options = {\n\t\t\tkeepRows: true,\n\t\t\tanalyticsLabel: {\n\t\t\t\t'groupCount': selected.length,\n\t\t\t\t'bindings': this.getRowsBindings(id ? [this.getGridInstance().getRows().getById(id)] : selected),\n\t\t\t},\n\t\t};\n\n\t\tlet selectedIds;\n\n\t\tif(id === undefined)\n\t\t{\n\t\t\tselectedIds = BX.Mail.Home.Grid.getSelectedIds();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselectedIds = [id];\n\t\t}\n\n\t\toptions.ids = selectedIds;\n\n\t\tBX.Mail.Home.Grid.hideRowByIds(selectedIds);\n\n\t\tconst unseenRowsIdsCount = this.filterRowsByClassName('mail-msg-list-cell-unseen', selectedIds).length;\n\n\t\tif(actionName === 'markAsSpam')\n\t\t{\n\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t{\n\t\t\t\t\tname: this.userInterfaceManager.spamDir,\n\t\t\t\t\tincrease: true,\n\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: this.getCurrentFolder(),\n\t\t\t\t\tlower: true,\n\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t},\n\t\t\t]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t{\n\t\t\t\t\tname: this.userInterfaceManager.spamDir,\n\t\t\t\t\tlower: true,\n\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: this.userInterfaceManager.inboxDir,\n\t\t\t\t\tincrease: true,\n\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t},\n\t\t\t]);\n\t\t}\n\n\t\tthis.runAction(actionName, options,() =>\n\t\t\tBX.Mail.Home.Grid.reloadTable()\n\t\t);\n\t\tif(id === undefined)\n\t\t{\n\t\t\tthis.resetGridSelection();\n\t\t}\n\t}\n\n\tgetConfirmDeletePopup(options)\n\t{\n\t\treturn new BX.UI.Dialogs.MessageBox({\n\t\t\ttitle: Loc.getMessage('MAIL_MESSAGE_LIST_CONFIRM_TITLE'),\n\t\t\tmessage: Loc.getMessage('MAIL_MESSAGE_LIST_CONFIRM_DELETE'),\n\t\t\tbuttons: [\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\tcolor: BX.UI.Button.Color.DANGER,\n\t\t\t\t\ttext: Loc.getMessage('MAIL_MESSAGE_LIST_CONFIRM_DELETE_BTN'),\n\t\t\t\t\tonclick: (function(button) {\n\n\t\t\t\t\t\tconst unseenRowsIdsCount = this.filterRowsByClassName('mail-msg-list-cell-unseen', options.ids).length;\n\n\t\t\t\t\t\tBX.Mail.Home.Counters.updateCounters([\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: this.getCurrentFolder(),\n\t\t\t\t\t\t\t\tlower: true,\n\t\t\t\t\t\t\t\tcount: unseenRowsIdsCount,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]);\n\n\t\t\t\t\t\tthis.runAction('delete', options,() =>\n\t\t\t\t\t\t\tBX.Mail.Home.Grid.reloadTable()\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbutton.getContext().close();\n\t\t\t\t\t\tBX.Mail.Home.Grid.hideRowByIds(options.ids);\n\t\t\t\t\t}).bind(this),\n\t\t\t\t}),\n\t\t\t\tnew BX.UI.CancelButton({\n\t\t\t\t\tonclick: function(button) {\n\t\t\t\t\t\tbutton.getContext().close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\t}\n\n\tresetGridSelection()\n\t{\n\t\tBX.onCustomEvent('Mail::resetGridSelection');\n\t\tthis.getGridInstance().getRows().unselectAll();\n\t\tthis.getGridInstance().adjustCheckAllCheckboxes();\n\t\tBX.Mail.Home.Grid.hidePanel();\n\t}\n\n\tisSelectedRowsHaveClass(className, id)\n\t{\n\t\tlet selectedIds;\n\t\tif(id === undefined)\n\t\t{\n\t\t\tselectedIds = this.getGridInstance().getRows().getSelectedIds();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselectedIds = [id];\n\t\t}\n\t\tconst ids = selectedIds.length ? selectedIds : (id ? [id] : []);\n\n\t\tlet selectedLinesWithClassNumber = 0;\n\n\t\tfor (let i = 0; i < ids.length; i++)\n\t\t{\n\t\t\tconst row = this.getGridInstance().getRows().getById(ids[i]);\n\t\t\tif (row && row.node)\n\t\t\t{\n\t\t\t\tconst columns = row.node.getElementsByClassName(className);\n\t\t\t\tif (columns && columns.length)\n\t\t\t\t{\n\t\t\t\t\tselectedLinesWithClassNumber++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn selectedLinesWithClassNumber;\n\t}\n\n\tfilterRowsByClassName(className, ids, isReversed)\n\t{\n\t\tlet resIds = [];\n\t\tif ('all' == ids)\n\t\t{\n\t\t\tresIds = this.getGridInstance().getRows().getBodyChild().map(\n\t\t\t\tfunction(current) {\n\t\t\t\t\treturn current.getId();\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t\telse if (Array.isArray(ids))\n\t\t{\n\t\t\tresIds = ids;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst selectedIds = this.getGridInstance().getRows().getSelectedIds();\n\t\t\tresIds = selectedIds.length ? selectedIds : (ids ? [ids] : []);\n\t\t}\n\t\tconst resultIds = [];\n\t\tfor (let i = resIds.length - 1; i >= 0; i--)\n\t\t{\n\t\t\tconst row = this.getGridInstance().getRows().getById(resIds[i]);\n\t\t\tif (row && row.node)\n\t\t\t{\n\t\t\t\tconst columns = row.node.getElementsByClassName(className);\n\t\t\t\tif (!isReversed && (columns && columns.length))\n\t\t\t\t{\n\t\t\t\t\tresultIds.push(resIds[i]);\n\t\t\t\t}\n\t\t\t\telse if (isReversed && !(columns && columns.length))\n\t\t\t\t{\n\t\t\t\t\tresultIds.push(resIds[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn resultIds;\n\t}\n\n\tnotify(text, delay)\n\t{\n\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\tautoHideDelay: delay > 0 ? delay : 2000,\n\t\t\tcontent: text ? text : Loc.getMessage('MAIL_MESSAGE_LIST_NOTIFY_SUCCESS'),\n\t\t});\n\t}\n\n\trunAction(actionName, options, actionOnSuccess)\n\t{\n\t\toptions = options ? options : {};\n\n\t\tlet selectedIds = [];\n\n\t\tif (options.ids)\n\t\t{\n\t\t\tselectedIds = options.ids;\n\t\t}\n\t\tif (!selectedIds.length && !selectedIds.for_all)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (!options.keepRows)\n\t\t{\n\t\t\tthis.getGridInstance().tableFade();\n\t\t}\n\t\tconst data = { ids: selectedIds };\n\t\tif (options.params)\n\t\t{\n\t\t\tconst optionsKeys = Object.keys(Object(options.params));\n\t\t\tfor (let nextIndex = 0, len = optionsKeys.length; nextIndex < len; nextIndex++)\n\t\t\t{\n\t\t\t\tconst nextKey = optionsKeys[nextIndex];\n\t\t\t\tconst desc = Object.getOwnPropertyDescriptor(options.params, nextKey);\n\t\t\t\tif (desc !== undefined && desc.enumerable)\n\t\t\t\t{\n\t\t\t\t\tdata[nextKey] = options.params[nextKey];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tBX.ajax.runComponentAction('bitrix:mail.client', actionName, {\n\t\t\tmode: 'ajax',\n\t\t\tdata: data,\n\t\t\tanalyticsLabel: options.analyticsLabel,\n\t\t}).then(\n\t\t\tfunction() {\n\t\t\t\tif (options.onSuccess === false)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (options.onSuccess && typeof (options.onSuccess) === \"function\")\n\t\t\t\t{\n\t\t\t\t\toptions.onSuccess.bind(this, selectedIds, options.successParams)();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(actionOnSuccess === undefined)\n\t\t\t\t{\n\t\t\t\t\tthis.notify();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tactionOnSuccess();\n\t\t\t\t}\n\t\t\t}.bind(this),\n\t\t\tfunction(response) {\n\t\t\t\toptions.onError && typeof (options.onError) === \"function\" ?\n\t\t\t\t\toptions.onError().bind(this, response) :\n\t\t\t\t\tthis.onErrorRequest(response);\n\t\t\t}.bind(this),\n\t\t);\n\t}\n\n\tonErrorRequest(response)\n\t{\n\t\tlet options = {};\n\t\tthis.checkErrorRights(response.errors);\n\t\toptions.errorMessage = response.errors[0].message;\n\t}\n\n\tcheckErrorRights(errors)\n\t{\n\t\tfor (let i = 0; i < errors.length; i++)\n\t\t{\n\t\t\tif (errors[i].code === this.ERROR_CODE_CAN_NOT_DELETE)\n\t\t\t{\n\t\t\t\tthis.canDelete = false;\n\t\t\t}\n\t\t\tif (errors[i].code === this.ERROR_CODE_CAN_NOT_MARK_SPAM)\n\t\t\t{\n\t\t\t\tthis.canMarkSpam = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tshowDirsSlider()\n\t{\n\t\tconst url = BX.util.add_url_param(\"/mail/config/dirs\", {\n\t\t\tmailboxId: this.mailboxId,\n\t\t});\n\t\tBX.SidePanel.Instance.open(url, {\n\t\t\twidth: 640,\n\t\t\tcacheable: false,\n\t\t\tallowChangeHistory: false,\n\t\t});\n\t\tthis.canDelete = true;\n\t\tthis.canMarkSpam = true;\n\t}\n\n\tonDisabledGroupActionClick()\n\t{\n\t}\n\n\tgetCurrentFolder()\n\t{\n\t\treturn this.userInterfaceManager.getCurrentFolder();\n\t}\n\n\tgetGridInstance()\n\t{\n\t\treturn BX.Main.gridManager.getById(this.gridId).instance;\n\t}\n\n\tgetRowsBindings(rows)\n\t{\n\t\treturn BX.util.array_unique(Array.prototype.concat.apply(\n\t\t\t[],\n\t\t\trows.map(\n\t\t\t\tfunction(row) {\n\t\t\t\t\tif (!row || !row.node)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Array.prototype.map.call(\n\t\t\t\t\t\trow.node.querySelectorAll('[class^=\"js-bind-\"] [data-type]'),\n\t\t\t\t\t\tfunction(node) {\n\t\t\t\t\t\t\treturn node.dataset.type;\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t),\n\t\t));\n\t}\n\n\tgetCache(key)\n\t{\n\t\tif (!key)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn this.cache[key] ? this.cache[key] : null;\n\t}\n\n\tsetCache(key, value)\n\t{\n\t\treturn this.cache[key] = value;\n\t}\n\n\tshowICalMenuDropdown(event)\n\t{\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tconst menu = event.currentTarget.dataset.menu;\n\n\t\tif (!menu)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.iCalMenuDropdown = BX.Main.MenuManager.create({\n\t\t\tid: 'mail-client-message-list-ical-dropdown-menu',\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\titems: JSON.parse(menu),\n\t\t\tzIndex: 7001,\n\t\t\tmaxHeight: 400,\n\t\t\tmaxWidth: 200,\n\t\t\tangle: {\n\t\t\t\tposition: \"top\",\n\t\t\t\toffset: 40,\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonPopupClose: function() {\n\t\t\t\t\tthis.removeICalMenuDropdown();\n\t\t\t\t}.bind(this),\n\t\t\t},\n\t\t});\n\t\tthis.iCalMenuDropdown.popupWindow.setBindElement(event.currentTarget);\n\t\tthis.iCalMenuDropdown.show();\n\t}\n\n\tremoveICalMenuDropdown()\n\t{\n\t\tif (this.iCalMenuDropdown)\n\t\t{\n\t\t\tBX.Main.MenuManager.destroy(this.iCalMenuDropdown.id);\n\t\t}\n\t}\n\n\tonClickICalButton(event)\n\t{\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tconst messageId = event.target.dataset.messageid || event.target.parentNode.dataset.messageid;\n\t\tconst action = event.target.dataset.action || event.target.parentNode.dataset.action;\n\t\tconst button = event.target;\n\n\t\tbutton.classList.add('ui-btn-wait');\n\t\tthis.removeICalMenuDropdown();\n\n\t\tthis.sendICal(messageId, action)\n\t\t\t.then(function() {\n\t\t\t\tbutton.classList.remove('ui-btn-wait');\n\t\t\t\tthis.notify(Loc.getMessage(action === 'cancelled' ? 'MAIL_MESSAGE_ICAL_NOTIFY_REJECT' : 'MAIL_MESSAGE_ICAL_NOTIFY_ACCEPT'));\n\t\t\t}.bind(this))\n\t\t\t.catch(function() {\n\t\t\t\tbutton.classList.remove('ui-btn-wait');\n\t\t\t\tthis.notify(Loc.getMessage('MAIL_MESSAGE_ICAL_NOTIFY_ERROR'));\n\t\t\t}.bind(this));\n\t}\n\n\tsendICal(messageId, action)\n\t{\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tBX.ajax.runComponentAction('bitrix:mail.client', 'ical', {\n\t\t\t\tmode: 'ajax',\n\t\t\t\tdata: { messageId, action },\n\t\t\t}).then(\n\t\t\t\tfunction() {\n\t\t\t\t\tresolve();\n\t\t\t\t}.bind(this),\n\t\t\t\tfunction() {\n\t\t\t\t\treject();\n\t\t\t\t}.bind(this),\n\t\t\t);\n\t\t});\n\t}\n}\n","import { Type, Reflection, Event, Loc } from 'main.core';\nimport { Avatar } from 'mail.avatar';\nimport { EventEmitter } from 'main.core.events';\nimport { MessageGrid } from 'mail.messagegrid';\nimport { ProgressBar } from './src/js/progressbar.es6';\nimport { Counters } from './src/js/counters.es6';\nimport { LeftMenu } from './src/js/leftmenu.es6';\nimport { List } from './src/js/list.es6';\nimport { Button } from 'ui.buttons';\n\nconst namespaceMailHome = Reflection.namespace('BX.Mail.Home');\n\nEventEmitter.subscribe('SidePanel.Slider:onMessage', (event) => {\n\tconst [messageEvent] = event.getCompatData();\n\tif(messageEvent.getEventId() === 'mail-mailbox-config-success')\n\t{\n\t\tBXMailMailbox.sync(namespaceMailHome.ProgressBar, namespaceMailHome.Grid.getId(), false,true);\n\t}\n});\n\nlet sliderPage;\nlet progressBar;\nlet errorBox;\nlet syncButtonWrapper;\n\nlet selectedIdsForRecovery = {};\n\nEvent.ready(() => {\n\n\tsyncButtonWrapper = document.querySelector('[data-role=\"mail-msg-sync-button-wrapper\"]');\n\n\tconst syncButton = new Button({\n\t\tclassName:\"ui-btn ui-btn-themes ui-btn-light-border mail-msg-sync-button\",\n\t\ticon: Button.Icon.BUSINESS,\n\t\tprops: {\n\t\t\ttitle: Loc.getMessage(\"MAIL_MESSAGE_SYNC_BTN_HINT\")\n\t\t},\n\t\tonclick: function() {\n\t\t\tBXMailMailbox.sync(namespaceMailHome.ProgressBar, Loc.getMessage(\"MAIL_MESSAGE_GRID_ID\"),false,true);\n\t\t},\n\t});\n\n\tsyncButtonWrapper.append(\n\t\tsyncButton.getContainer()\n\t)\n\n\tEventEmitter.subscribe('BX.Main.Grid:onBeforeReload', (event) => {\n\t\tconst [grid] = event.getCompatData();\n\t\tif(grid !== {} && grid !== undefined && Loc.getMessage(\"MAIL_MESSAGE_GRID_ID\") === grid.getId())\n\t\t{\n\t\t\tselectedIdsForRecovery = grid.getRows().getSelectedIds();\n\t\t}\n\t});\n\n\tEventEmitter.subscribe('Grid::updated', (event) => {\n\t\tconst [grid] = event.getCompatData();\n\n\t\tif(grid !== {} && grid !== undefined && Loc.getMessage(\"MAIL_MESSAGE_GRID_ID\") === grid.getId())\n\t\t{\n\t\t\tlet rowsWereSelected = false;\n\t\t\tnamespaceMailHome.Grid.getRows().map(function (row)\n\t\t\t{\n\t\t\t\tif(Type.isFunction(selectedIdsForRecovery.indexOf) && selectedIdsForRecovery.indexOf(row.getId()) !== -1)\n\t\t\t\t{\n\t\t\t\t\tif(row.isShown())\n\t\t\t\t\t{\n\t\t\t\t\t\trow.select();\n\t\t\t\t\t\trowsWereSelected = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\tselectedIdsForRecovery = {}\n\n\t\t\tif(rowsWereSelected)\n\t\t\t{\n\t\t\t\tsetTimeout(\n\t\t\t\t\tfunction ()\n\t\t\t\t\t{\n\t\t\t\t\t\tEventEmitter.emit(window,'Grid::thereSelectedRows');\n\t\t\t\t\t},\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\tAvatar.replaceTagsWithAvatars({\n\t\tclassName: 'mail-ui-avatar',\n\t});\n\n\tsliderPage = document.getElementsByClassName(\"ui-slider-page\")[0];\n\tprogressBar = document.querySelector('[data-role=\"mail-progress-bar\"]');\n\tsliderPage.insertBefore(progressBar,sliderPage.firstChild);\n\terrorBox = document.querySelector('[data-role=\"error-box\"]');\n\n\tnamespaceMailHome.ProgressBar = new ProgressBar(progressBar);\n\tnamespaceMailHome.unreadMessageMailboxesMarker = document.querySelector('[data-role=\"unreadMessageMailboxesMarker\"]');;\n\n\tnamespaceMailHome.ProgressBar.setSyncButton(syncButton);\n\tnamespaceMailHome.ProgressBar.setErrorBoxNode(document.querySelector('[data-role=\"error-box\"]'))\n\tnamespaceMailHome.ProgressBar.setErrorTextNode(document.querySelector('[data-role=\"error-box-text\"]'));\n\tnamespaceMailHome.ProgressBar.setErrorHintNode(document.querySelector('[data-role=\"error-box-hint\"]'));\n\tnamespaceMailHome.ProgressBar.setErrorTitleNode(document.querySelector('[data-role=\"error-box-title\"]'));\n});\n\nBX.ready(function() {\n\tnamespaceMailHome.Counters = new Counters('dirs', Loc.getMessage(\"DEFAULT_DIR\"));\n\tnamespaceMailHome.mailboxCounters = new Counters('mailboxCounters');\n\tnamespaceMailHome.Grid = new MessageGrid();\n});\nnamespaceMailHome.LeftMenu = LeftMenu;\n\nconst namespaceClientMessage = Reflection.namespace('BX.Mail.Client.Message');\nnamespaceClientMessage.List = List;\n"],"names":["ProgressBar","node","button","errorBoxNode","errorTitleNode","errorTextNode","errorHintNode","getSyncButton","undefined","setWaiting","classList","add","remove","Counters","name","selectedDirectory","setDirectory","shortcut","shortcuts","path","getDirPath","resultCounters","getCounter","senCounterUpdateEvent","shortcutName","counterNames","counter","hiddenCountersForTotalCounter","counters","count","Number","i","length","addCounter","addCounters","isExists","newValue","increase","lower","countersAreNotLoadedFromTheServer","lowerCounter","increaseCounter","event","BaseEvent","data","hidden","getName","EventEmitter","emit","LeftMenu","config","dirsWithUnseenMailCounters","mailboxId","filterId","systemDirs","spam","trash","outcome","drafts","inbox","leftDirectoryMenuWrapper","document","querySelector","directoryMenu","DirectoryMenu","subscribe","BX","ajax","runComponentAction","mode","then","response","Mail","Home","setCounters","append","getNode","List","options","mailReadAllButton","gridId","canMarkSpam","canDelete","ERROR_CODE_CAN_NOT_DELETE","ERROR_CODE_CAN_NOT_MARK_SPAM","disabledClassName","userInterfaceManager","Client","Message","UserInterfaceManager","resetGridSelection","bind","isSelectedRowsHaveClass","getGridInstance","cache","addEventHandlers","id","UpdatePageData","menuItem","target","container","getMenuWindow","getPopupWindow","getPopupContainer","getSubMenu","gridRowId","LeftMenuNode","currentFolderCount","getCurrentFolder","mailboxCounters","getTotalCounter","updateLeftMenuCounter","dataset","menuWindow","subMenuItems","getMenuItems","hash","dirMd5","hasChild","item","getId","hasSubMenu","showSubMenu","subMenu","hasLoadingItem","items","k","subItem","loadLevelMenu","itemsMenu","querySelectorAll","addEventListener","showICalMenuDropdown","bindDelegate","body","className","onClickICalButton","menu","getCache","popup","Main","PopupManager","getPopupById","destroy","destroySubMenu","addSubMenu","Loc","getMessage","dir","dirs","test","FLAGS","PATH","NAME","DIR_MD5","IS_DISABLED","push","setCache","isShown","selected","getRows","getSelected","row","getById","addToCrm","isAddToCrmActionAvailable","messageIdNode","messageId","crmBtnInRow","startWait","isAddingToCrmInProgress","analyticsLabel","getRowsBindings","notify","json","stopWait","errors","map","message","join","onCrmBindingDeleted","selectedIds","getSelectedIds","SidePanel","Instance","open","width","loader","additionalOptions","onDeleteClick","showDirsSlider","params","keepRows","Grid","filterRowsByClassName","ids","isCurrentFolderTrash","confirmPopup","getConfirmDeletePopup","show","hideRowByIds","unseenRowsIdsCount","updateCounters","runAction","reloadTable","folderOptions","currentTarget","toFolderByPath","toFolderByName","popupSubmenu","findParent","isDisabled","JSON","parse","idsForMoving","onCustomEvent","folder","resultIds","actionName","handler","onMessagesRead","action","currentFolder","oldMessagesCount","countMessages","updateUnreadCounters","successParams","onSuccess","apply","spamDir","inboxDir","UI","Dialogs","MessageBox","title","buttons","Button","color","Color","DANGER","text","onclick","getContext","close","CancelButton","unselectAll","adjustCheckAllCheckboxes","hidePanel","selectedLinesWithClassNumber","columns","getElementsByClassName","isReversed","resIds","getBodyChild","current","Array","isArray","delay","top","Notification","Center","autoHideDelay","content","actionOnSuccess","for_all","tableFade","optionsKeys","Object","keys","nextIndex","len","nextKey","desc","getOwnPropertyDescriptor","enumerable","onError","onErrorRequest","checkErrorRights","errorMessage","code","url","util","add_url_param","cacheable","allowChangeHistory","gridManager","instance","rows","array_unique","prototype","concat","call","type","key","value","stopPropagation","preventDefault","iCalMenuDropdown","MenuManager","create","autoHide","closeByEsc","zIndex","maxHeight","maxWidth","angle","position","offset","events","onPopupClose","removeICalMenuDropdown","popupWindow","setBindElement","messageid","parentNode","sendICal","catch","Promise","resolve","reject","namespaceMailHome","Reflection","namespace","getCompatData","messageEvent","getEventId","BXMailMailbox","sync","sliderPage","progressBar","errorBox","syncButtonWrapper","selectedIdsForRecovery","Event","ready","syncButton","icon","Icon","BUSINESS","props","getContainer","grid","rowsWereSelected","Type","isFunction","indexOf","select","setTimeout","window","Avatar","replaceTagsWithAvatars","insertBefore","firstChild","unreadMessageMailboxesMarker","setSyncButton","setErrorBoxNode","setErrorTextNode","setErrorHintNode","setErrorTitleNode","MessageGrid","namespaceClientMessage"],"mappings":"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"}