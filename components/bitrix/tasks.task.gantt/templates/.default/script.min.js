BX.namespace("BX.Tasks.Grid");BX.Tasks.GanttActions={defaultPresetId:""};var tasksListNS={approveTask:function(t){ganttChart.updateTask(t,{status:"completed",dateCompleted:new Date});SetServerStatus(t,"approve",{bGannt:true})},disapproveTask:function(t){ganttChart.updateTask(t,{status:"new",dateCompleted:null});SetServerStatus(t,"disapprove",{bGannt:true})}};function CloseTask(t){ganttChart.updateTask(t,{status:"completed",dateCompleted:new Date});SetServerStatus(t,"close",{bGannt:true})}function StartTask(t){ganttChart.updateTask(t,{status:"in-progress",dateCompleted:null});SetServerStatus(t,"start",{bGannt:true})}function AcceptTask(t){ganttChart.updateTask(t,{status:"accepted",dateCompleted:null});SetServerStatus(t,"accept",{bGannt:true})}function PauseTask(t){ganttChart.updateTask(t,{status:"accepted",dateCompleted:null});SetServerStatus(t,"pause",{bGannt:true})}function RenewTask(t){ganttChart.updateTask(t,{status:"new",dateCompleted:null});SetServerStatus(t,"renew",{bGannt:true})}function DeferTask(t){ganttChart.updateTask(t,{status:"delayed"});SetServerStatus(t,"defer",{bGannt:true})}function AddToFavorite(t,e){var a={mode:"favorite",add:1,sessid:BX.message("bitrix_sessid"),id:t,bGannt:true};BX.ajax({method:"POST",dataType:"html",url:tasksListAjaxUrl,data:a,processData:false,onsuccess:function(t){return function(t){}}(t)})}function DeleteFavorite(t,e){var a={mode:"favorite",sessid:BX.message("bitrix_sessid"),id:t,bGannt:true};BX.ajax({method:"POST",dataType:"html",url:tasksListAjaxUrl,data:a,processData:false,onsuccess:function(t){if(e.rowDelete){return function(a){TASKS_table_view_onDeleteClick_onSuccess(t,a,e)}}}(t)})}function DeleteTask(t){var e={mode:"delete",sessid:BX.message("bitrix_sessid"),id:t,bGannt:true};BX.ajax({method:"POST",dataType:"html",url:tasksListAjaxUrl,data:e,processData:false,onsuccess:function(t){return function(e){TASKS_table_view_onDeleteClick_onSuccess(t,e)}}(t)})}function TASKS_table_view_onDeleteClick_onSuccess(t,e){e=e.toString().trim();if(e&&e.length>0){}else{ganttChart.removeTask(t);BX.onCustomEvent("onTaskListTaskDelete",[t])}}function onPopupTaskChanged(t){__RenewMenuItems(t);__InvalidateMenus([t.id,"c"+t.id]);if(t.parentTaskId){var e=ganttChart.getTaskById(t.parentTaskId);if(e){if(e.hasChildren){e.expand();ganttChart.updateTask(t.id,t)}else{ganttChart.updateTask(t.id,t);e.expand()}}else{ganttChart.updateTask(t.id,t)}}else if(t.projectId&&!ganttChart.getProjectById(t.projectId)){var a=ganttChart.addProjectFromJSON({id:t.projectId,name:t.projectName,opened:true,canCreateTasks:t.projectCanCreateTasks,canEditTasks:t.projectCanEditTasks});ganttChart.updateTask(t.id,t)}else{ganttChart.updateTask(t.id,t)}}function onPopupTaskAdded(t){BX.onCustomEvent("onTaskListTaskAdd",[t]);__RenewMenuItems(t);if(t.projectId&&!ganttChart.getProjectById(t.projectId)){ganttChart.addProjectFromJSON({id:t.projectId,name:t.projectName,opened:true,canCreateTasks:t.projectCanCreateTasks,canEditTasks:t.projectCanEditTasks})}ganttChart.addTaskFromJSON(t);if(t.parentTaskId){var e=ganttChart.getTaskById(t.parentTaskId);if(e){e.expand()}}}function onPopupTaskDeleted(t){ganttChart.removeTask(t)}var lastScroll;function onBeforeShow(){if(BX.browser.IsOpera()){lastScroll=ganttChart.layout.timeline.scrollLeft}}function onAfterShow(){if(typeof lastScroll!="undefined"&&BX.browser.IsOpera()){ganttChart.layout.timeline.scrollLeft=lastScroll}}function onBeforeHide(){if(BX.browser.IsOpera()){lastScroll=ganttChart.layout.timeline.scrollLeft}}function onAfterHide(){if(typeof lastScroll!="undefined"&&BX.browser.IsOpera()){ganttChart.layout.timeline.scrollLeft=lastScroll}}function __RenewMenuItems(t){if(!t){return}quickInfoData[t.id]=BX.clone(t,true);t.menuItems=__FilterMenuByStatus(t)}BX.addCustomEvent("SidePanel.Slider:onCloseByEsc",function(t){var e=/tasks\/task\/edit/;var a=t.getSlider().getUrl();if(e.test(a)&&!confirm(BX.message("TASKS_CLOSE_PAGE_CONFIRM"))){t.denyAction()}});BX.addCustomEvent("BX.Main.Filter:apply",function(t,e,a,n,s){window.location.href=BX.util.remove_url_param(window.location.href,"F_STATE")});BX.addCustomEvent("Tasks.TopMenu:onItem",function(t,e){var a=BX.Main.filterManager.getById(ganttFilterId);if(!a){alert("BX.Main.filterManager not initialised");return}var n={preset_id:BX.Tasks.GanttActions.defaultPresetId,additional:{ROLEID:t==="view_all"?0:t}};var s=a.getApi();s.setFilter(n,{ROLE_TYPE:"TASKS_ROLE_TYPE_"+(t===""?"view_all":t)});window.history.pushState(null,null,e)});BX.addCustomEvent("Tasks.Toolbar:onItem",function(t){var e=t.getData();if(e.counter&&e.counter.filter){e.counter.filter.toggleByField({PROBLEM:e.counter.filterValue})}});
//# sourceMappingURL=script.map.js