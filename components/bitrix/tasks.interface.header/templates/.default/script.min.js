BX.namespace("BX.Tasks");BX.Tasks.InterfaceToolbar=function(t){this.gridId=t.gridId||"";this.grid={};this.containerId=t.containerId;this.container={};this.itemSelector="a.tasks-counter-container";this.params=t||{};this.filterManager=null;this.filterApi=null;this.itemClickHandler=null;return this.init()};BX.Tasks.InterfaceToolbar.prototype={init:function(){this.itemClickHandler=BX.delegate(this.onItemClick,this);this.container=BX(this.containerId);if(!BX.type.isElementNode(this.container)){throw"BX.Tasks.InterfaceToolbar: Could not find container: "+this.containerId}var t=this.container.querySelectorAll(this.itemSelector);for(var e=0,i=t.length;e<i;e++){BX.bind(t[e],"click",this.itemClickHandler)}this.filterManager=BX.Main.filterManager.getById(this.gridId);if(!this.filterManager){alert("BX.Main.filterManager not initialised");return}this.filterApi=this.filterManager.getApi()},onItemClick:function(t){var e=BX.findParent(BX.getEventTarget(t),{tagName:"A",className:"tasks-counter-container"});if(e){var i=e.getAttribute("data-type-id");if(BX.type.isNotEmptyString(i)){var r={counterTypeId:i,cancel:false};this.applyFilter(r);if(r.cancel){return BX.PreventDefault(t)}}}return true},applyFilter:function(t){var e={};switch(t.counterTypeId){case"tasks_my_expired":var i=BX.date.format("d.m.Y",new Date,null,true);e={DEADLINE_datesel:"RANGE",DEADLINE_to:i};break;case"tasks_my_expired_cand":var r=new Date;var a=new Date;r.setUTCHours(r.getUTCHours()-24);var n=BX.date.format("d.m.Y H:i:s",r,null,true);a.setUTCHours(a.getUTCHours()+24);var s=BX.date.format("d.m.Y H:i:s",a,null,true);e={DEADLINE_datesel:"RANGE",DEADLINE_from:n,DEADLINE_to:s};break}this.filterApi.setFields(e);this.filterApi.apply()}};