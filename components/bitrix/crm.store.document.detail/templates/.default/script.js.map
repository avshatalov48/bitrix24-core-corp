{"version":3,"file":"script.js","sources":["src/js/document.onboarding.manager.js","src/js/document.js"],"sourcesContent":["//@flow\nimport {userOptions, Loc, Event} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport 'spotlight';\n\n\nexport type OnboardingData = {\n\tchain: number;\n\tchainStep: number;\n};\n\ntype Params = {\n\tonboardingData: OnboardingData;\n\tdocumentGuid: string;\n};\n\nexport class DocumentOnboardingManager\n{\n\t#onboardingData: OnboardingData;\n\t#documentGuid: string;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#onboardingData = params.onboardingData;\n\t\tthis.#documentGuid = params.documentGuid;\n\t}\n\n\tprocessOnboarding(): void\n\t{\n\t\tconst chain = this.#onboardingData.chain;\n\t\tconst step = this.#onboardingData.chainStep;\n\n\t\tif (chain === 1 && step === 1)\n\t\t{\n\t\t\tthis.#hintProductListField();\n\t\t}\n\t}\n\n\t#hintProductListField(): void\n\t{\n\t\tconst buttonsContainer = document.querySelector(`#${this.#documentGuid}_TABS_MENU`);\n\t\tconst spotlight = new BX.SpotLight(\n\t\t\t{\n\t\t\t\tid: 'arrow_spotlight',\n\t\t\t\ttargetElement: document.querySelector('[data-tab-id=tab_products]'),\n\t\t\t\tautoSave: true,\n\t\t\t\ttargetVertex: \"middle-center\",\n\t\t\t\tzIndex: 200,\n\t\t\t}\n\t\t);\n\t\tspotlight.show();\n\t\tspotlight.container.style.pointerEvents = \"none\";\n\n\t\tconst productListTabListener = (event) => {\n\t\t\tspotlight.close();\n\t\t\tconst [productListEditor] = event.data;\n\n\t\t\tconst buttonsPanelListener = () => {\n\t\t\t\tconst activeHint = productListEditor.getActiveHint();\n\t\t\t\tif (activeHint !== null)\n\t\t\t\t{\n\t\t\t\t\tactiveHint.close();\n\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', buttonsPanelListener);\n\t\t\t\t}\n\t\t\t}\n\t\t\tEvent.bind(buttonsContainer, 'click', buttonsPanelListener);\n\n\t\t\tproductListEditor.showFieldTourHint(\n\t\t\t\t'AMOUNT',\n\t\t\t\t{\n\t\t\t\t\ttitle: Loc.getMessage('CRM_STORE_DOCUMENT_WAREHOUSE_PRODUCT_AMOUNT_GUIDE_TITLE'),\n\t\t\t\t\ttext: Loc.getMessage('CRM_STORE_DOCUMENT_WAREHOUSE_PRODUCT_AMOUNT_GUIDE_TEXT'),\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'secondChainStage', 2);\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'chainStage', 2);\n\n\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', buttonsPanelListener);\n\n\t\t\t\t\tEventEmitter.unsubscribe(\n\t\t\t\t\t\t'onDemandRecalculateWrapper',\n\t\t\t\t\t\tproductListTabListener\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t)\n\t\t};\n\n\t\tEventEmitter.subscribe(\n\t\t\t'onDemandRecalculateWrapper',\n\t\t\tproductListTabListener\n\t\t);\n\t}\n}","import {Loc, Reflection, Tag} from \"main.core\";\nimport {BaseCard} from \"catalog.entity-card\";\nimport {EventEmitter} from \"main.core.events\";\nimport {Button, ButtonColor, ButtonState} from \"ui.buttons\";\nimport {DocumentOnboardingManager, OnboardingData} from \"./document.onboarding.manager\";\n\nexport class Document extends BaseCard\n{\n\tstatic #instance;\n\n\tstatic saveAndDeductAction = 'saveAndDeduct';\n\tstatic deductAction = 'deduct';\n\tstatic cancelDeductAction = 'cancelDeduct';\n\n\t#documentOnboardingManager: DocumentOnboardingManager|null = null;\n\n\tconstructor(id, settings)\n\t{\n\t\tsuper(id, settings);\n\t\tthis.isDocumentDeducted = settings.documentStatus === 'Y';\n\t\tthis.isDeductLocked = settings.isDeductLocked;\n\t\tthis.masterSliderUrl = settings.masterSliderUrl;\n\n\t\tthis.addCopyLinkPopup();\n\n\t\tEventEmitter.subscribe('BX.Crm.EntityEditor:onFailedValidation', (event) => {\n\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'main'});\n\t\t});\n\t\tEventEmitter.subscribe('onProductsCheckFailed', (event) => {\n\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'tab_products'});\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Crm.EntityEditor:onSave', (event) => {\n\t\t\tconst eventEditor = event.data[0];\n\t\t\tif (eventEditor && eventEditor._ajaxForm)\n\t\t\t{\n\t\t\t\tlet action = eventEditor._ajaxForm?._actionName === 'SAVE' ? 'save' : eventEditor._ajaxForm?._config.data.ACTION;\n\t\t\t\tif (action === Document.saveAndDeductAction)\n\t\t\t\t{\n\t\t\t\t\tconst controllersErrorCollection = this.getControllersIssues(eventEditor.getControllers());\n\t\t\t\t\tif (controllersErrorCollection.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\t\teventEditor._toolPanel?.setLocked(false);\n\t\t\t\t\t\teventEditor._toolPanel?.addError(controllersErrorCollection[0]);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (action === 'SAVE')\n\t\t\t\t{\n\t\t\t\t\t// for consistency in analytics tags\n\t\t\t\t\taction = 'save';\n\t\t\t\t}\n\n\t\t\t\tlet urlParams = {\n\t\t\t\t\tisNewDocument: this.entityId <= 0 ? 'Y' : 'N',\n\t\t\t\t};\n\n\t\t\t\tif (action)\n\t\t\t\t{\n\t\t\t\t\turlParams.action = action;\n\t\t\t\t}\n\n\t\t\t\teventEditor._ajaxForm.addUrlParams(urlParams);\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Catalog.EntityCard.TabManager:onSelectItem', (event) => {\n\t\t\tconst tabId = event.data.tabId;\n\t\t\tif (tabId === 'tab_products' && !this.isTabAnalyticsSent)\n\t\t\t{\n\t\t\t\tthis.sendAnalyticsData({\n\t\t\t\t\ttab: 'products',\n\t\t\t\t\tisNewDocument: this.entityId <= 0 ? 'Y' : 'N',\n\t\t\t\t\tdocumentType: 'W',\n\t\t\t\t});\n\t\t\t\tthis.isTabAnalyticsSent = true;\n\t\t\t}\n\t\t});\n\n\t\tDocument.#instance = this;\n\n\t\tBX.UI.SidePanel.Wrapper.setParam(\"closeAfterSave\", true);\n\t\tthis.showNotificationOnClose = false;\n\t}\n\n\tgetControllersIssues(controllers)\n\t{\n\t\tlet validateErrorCollection = [];\n\t\tif (controllers instanceof Array)\n\t\t{\n\t\t\tcontrollers.forEach((controller) => {\n\t\t\t\tif (controller instanceof BX.Crm.EntityStoreDocumentProductListController)\n\t\t\t\t{\n\t\t\t\t\tvalidateErrorCollection.push(...controller.getErrorCollection());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn validateErrorCollection;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\treturn Document.#instance;\n\t}\n\n\topenMasterSlider()\n\t{\n\t\tlet card = this;\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\tthis.masterSliderUrl,\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\tdata: {\n\t\t\t\t\topenGridOnDone: false,\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonCloseComplete: function(event) {\n\t\t\t\t\t\tlet slider = event.getSlider();\n\t\t\t\t\t\tif (!slider)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (slider.getData().get('isInventoryManagementEnabled'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcard.isDeductLocked = false;\n\n\t\t\t\t\t\t\tlet sliders = BX.SidePanel.Instance.getOpenSliders();\n\t\t\t\t\t\t\tsliders.forEach((slider) => {\n\t\t\t\t\t\t\t\tif (slider.getWindow()?.BX.Catalog?.DocumentGridManager)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tslider.allowChangeHistory = false;\n\t\t\t\t\t\t\t\t\tslider.getWindow().location.reload();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\t/**\n\t * adds the \"deduct\" and \"save and deduct\" buttons to the tool panel\n\t * using entity-editor's api to preserve the logic\n\t */\n\tadjustToolPanel()\n\t{\n\t\tlet editor = this.getEditorInstance();\n\t\tif (!editor)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet savePanel = editor._toolPanel;\n\t\tlet saveButton = editor._toolPanel._editButton;\n\n\t\tthis.defaultSaveActionName = editor._ajaxForm._config.data.ACTION;\n\t\tthis.defaultOnSuccessCallback = editor._ajaxForm._config.onsuccess;\n\n\t\tsaveButton.onclick = (event) => {\n\t\t\tthis.showNotificationOnClose = false;\n\t\t\teditor._ajaxForm._config.data.ACTION = this.defaultSaveActionName;\n\t\t\teditor._ajaxForm._config.onsuccess = this.defaultOnSuccessCallback;\n\t\t\tsavePanel.onSaveButtonClick(event);\n\t\t};\n\n\t\tlet deductAndSaveButton = Tag.render`<button class=\"ui-btn ui-btn-light-border\">${Loc.getMessage('CRM_STORE_DOCUMENT_DETAIL_SAVE_AND_DEDUCT_BUTTON')}</button>`;\n\t\tdeductAndSaveButton.onclick = (event) => {\n\t\t\tif (this.isDeductLocked)\n\t\t\t{\n\t\t\t\tthis.openMasterSlider();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditor._ajaxForm._config.data.ACTION = Document.saveAndDeductAction;\n\t\t\teditor._ajaxForm._config.onsuccess = (result) => {\n\t\t\t\tthis.showNotificationOnClose = true;\n\t\t\t\tlet error = BX.prop.getString(result, 'ERROR', '');\n\t\t\t\tif (!error)\n\t\t\t\t{\n\t\t\t\t\tthis.setViewModeButtons(editor);\n\t\t\t\t}\n\n\t\t\t\teditor.onSaveSuccess(result);\n\t\t\t};\n\n\t\t\tsavePanel.onSaveButtonClick(event);\n\t\t};\n\t\tsaveButton.after(deductAndSaveButton);\n\t\tthis.deductAndSaveButton = deductAndSaveButton;\n\n\t\tlet deductButton = new Button({\n\t\t\ttext: this.isDocumentDeducted ? Loc.getMessage('CRM_STORE_DOCUMENT_DETAIL_CANCEL_DEDUCT_BUTTON') : Loc.getMessage('CRM_STORE_DOCUMENT_DETAIL_DEDUCT_BUTTON'),\n\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\tonclick: (button, event) => {\n\t\t\t\tif (savePanel.isLocked())\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this.isDeductLocked)\n\t\t\t\t{\n\t\t\t\t\tthis.openMasterSlider();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbutton.setState(ButtonState.CLOCKING);\n\t\t\t\tsavePanel.setLocked(true);\n\n\t\t\t\tconst actionName = this.isDocumentDeducted ? Document.cancelDeductAction : Document.deductAction;\n\t\t\t\tif (actionName === Document.deductAction)\n\t\t\t\t{\n\t\t\t\t\tconst controllers = editor.getControllers();\n\t\t\t\t\tlet errorCollection = [];\n\t\t\t\t\tcontrollers.forEach((controller) => {\n\t\t\t\t\t\tif (controller instanceof BX.Crm.EntityStoreDocumentProductListController)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!controller.validateProductList())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\terrorCollection.push(...controller.getErrorCollection());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tif (errorCollection.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tsavePanel.clearErrors();\n\t\t\t\t\t\tsavePanel.addError(errorCollection[0]);\n\t\t\t\t\t\tsavePanel.setLocked(false);\n\t\t\t\t\t\tbutton.setActive(true);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet formData = {};\n\t\t\t\tif (window.EntityEditorDocumentOrderShipmentController)\n\t\t\t\t{\n\t\t\t\t\tformData = window.EntityEditorDocumentOrderShipmentController.demandFormData();\n\t\t\t\t}\n\n\t\t\t\tlet deductDocumentAjaxForm = editor.createAjaxForm(\n\t\t\t\t\t{\n\t\t\t\t\t\tactionName: actionName,\n\t\t\t\t\t\tenableRequiredUserFieldCheck: false,\n\t\t\t\t\t\tformData: formData,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess: (result) => {\n\t\t\t\t\t\t\tif (!this.isDocumentDeducted)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.showNotificationOnClose = true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbutton.setState(ButtonState.ACTIVE);\n\t\t\t\t\t\t\teditor.onSaveSuccess(result);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonFailure: (result) => {\n\t\t\t\t\t\t\tbutton.setState(ButtonState.ACTIVE);\n\t\t\t\t\t\t\teditor.onSaveFailure(result);\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tdeductDocumentAjaxForm.addUrlParams({\n\t\t\t\t\taction: actionName,\n\t\t\t\t\tdocumentType: 'W',\n\t\t\t\t});\n\n\t\t\t\tdeductDocumentAjaxForm.submit();\n\t\t\t},\n\t\t}).render();\n\t\tsaveButton.after(deductButton);\n\t\tthis.deductButton = deductButton;\n\n\t\tEventEmitter.subscribe('BX.Crm.EntityEditor:onControlModeChange', (event) => {\n\t\t\tlet eventEditor = event.data[0];\n\t\t\tlet control = event.data[1].control;\n\t\t\tif(control.getMode() === BX.Crm.EntityEditorMode.edit)\n\t\t\t{\n\t\t\t\tthis.setEditModeButtons(eventEditor);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setViewModeButtons(eventEditor);\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Crm.EntityEditor:onControlChange', (event) => {\n\t\t\tlet eventEditor = event.data[0];\n\t\t\tthis.setEditModeButtons(eventEditor);\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Crm.EntityEditor:onControllerChange', (event) => {\n\t\t\tlet eventEditor = event.data[0];\n\t\t\tthis.setEditModeButtons(eventEditor);\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Crm.EntityEditor:onSwitchToViewMode', (event) => {\n\t\t\tlet eventEditor = event.data[0];\n\t\t\tthis.setViewModeButtons(eventEditor);\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Crm.EntityEditor:onNothingChanged', (event) => {\n\t\t\tlet eventEditor = event.data[0];\n\t\t\tthis.setViewModeButtons(eventEditor);\n\t\t});\n\n\t\tEventEmitter.subscribe('onEntityCreate', (event) => {\n\t\t\tlet editor = event?.data[0]?.sender;\n\t\t\tif (editor)\n\t\t\t{\n\t\t\t\teditor._toolPanel.disableSaveButton();\n\t\t\t\teditor.hideToolPanel();\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('beforeCrmEntityRedirect', (event) => {\n\t\t\tlet editor = event?.data[0]?.sender;\n\t\t\tif (editor)\n\t\t\t{\n\t\t\t\teditor._toolPanel.disableSaveButton();\n\t\t\t\teditor.hideToolPanel();\n\n\t\t\t\tif (this.showNotificationOnClose)\n\t\t\t\t{\n\t\t\t\t\tlet url = event.data[0].redirectUrl;\n\t\t\t\t\tif (!url)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\turl = BX.Uri.removeParam(url, 'closeOnSave');\n\n\t\t\t\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('CRM_STORE_DOCUMENT_SAVE_AND_CONDUCT_NOTIFICATION'),\n\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('CRM_STORE_DOCUMENT_OPEN_DOCUMENT'),\n\t\t\t\t\t\t\t\thref: url,\n\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\tclick: function(event, balloon, action) {\n\t\t\t\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (editor.isNew())\n\t\t{\n\t\t\tthis.setEditModeButtons(editor);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.setViewModeButtons(editor);\n\t\t}\n\t}\n\n\tsetViewModeButtons(editor)\n\t{\n\t\tif (editor._toolPanel && editor._toolPanel.hasOwnProperty('_cancelButton'))\n\t\t{\n\t\t\tBX.hide(editor._toolPanel._cancelButton);\n\t\t}\n\n\t\tif (editor._toolPanel && editor._toolPanel.hasOwnProperty('_editButton'))\n\t\t{\n\t\t\tBX.hide(editor._toolPanel._editButton);\n\t\t}\n\n\t\tif (this.deductAndSaveButton)\n\t\t{\n\t\t\tBX.hide(this.deductAndSaveButton);\n\t\t}\n\t\tif (this.deductButton)\n\t\t{\n\t\t\tBX.show(this.deductButton);\n\t\t}\n\t}\n\n\tsetEditModeButtons(editor)\n\t{\n\t\tif (editor._toolPanel && editor._toolPanel.hasOwnProperty('_cancelButton'))\n\t\t{\n\t\t\tBX.show(editor._toolPanel._cancelButton);\n\t\t}\n\n\t\tif (editor._toolPanel && editor._toolPanel.hasOwnProperty('_editButton'))\n\t\t{\n\t\t\tBX.show(editor._toolPanel._editButton);\n\t\t}\n\n\t\tif (this.deductAndSaveButton && !this.isDocumentDeducted)\n\t\t{\n\t\t\tBX.show(this.deductAndSaveButton);\n\t\t}\n\t\tif (this.deductButton && !this.isDocumentDeducted)\n\t\t{\n\t\t\tBX.hide(this.deductButton);\n\t\t}\n\t}\n\n\tgetEditorInstance()\n\t{\n\t\tif (Reflection.getClass('BX.Crm.EntityEditor'))\n\t\t{\n\t\t\treturn BX.Crm.EntityEditor.getDefault();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddCopyLinkPopup()\n\t{\n\t\tlet copyLinkButton = document.getElementById(this.settings.copyLinkButtonId);\n\t\tif (!copyLinkButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcopyLinkButton.onclick = () => {\n\t\t\tthis.copyDocumentLinkToClipboard();\n\t\t}\n\t}\n\n\tcopyDocumentLinkToClipboard()\n\t{\n\t\tlet url = BX.util.remove_url_param(window.location.href, [\"IFRAME\", \"IFRAME_TYPE\"]);\n\t\tif(!BX.clipboard.copy(url))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvar popup = new BX.PopupWindow(\n\t\t\t'catalog_copy_document_url_to_clipboard',\n\t\t\tdocument.getElementById(this.settings.copyLinkButtonId),\n\t\t\t{\n\t\t\t\tcontent: Loc.getMessage('CRM_STORE_DOCUMENT_DETAIL_LINK_COPIED'),\n\t\t\t\tdarkMode: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tzIndex: 1000,\n\t\t\t\tangle: true,\n\t\t\t\tbindOptions: { position: \"top\" }\n\t\t\t}\n\t\t);\n\t\tpopup.show();\n\n\t\tsetTimeout(function(){ popup.close(); }, 1500);\n\t}\n\n\tsendAnalyticsData(data)\n\t{\n\t\tBX.ajax.runComponentAction(\n\t\t\t'bitrix:crm.store.document.detail',\n\t\t\t'sendAnalytics',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tanalyticsLabel: data,\n\t\t\t}\n\t\t);\n\t}\n\n\tenableOnboardingChain(onboardingData: OnboardingData)\n\t{\n\t\tif (this.#documentOnboardingManager === null)\n\t\t{\n\t\t\tthis.#documentOnboardingManager  = new DocumentOnboardingManager({\n\t\t\t\tonboardingData: onboardingData,\n\t\t\t\tdocumentGuid: this.id\n\t\t\t});\n\t\t\tthis.#documentOnboardingManager.processOnboarding();\n\t\t}\n\t}\n}\n"],"names":["DocumentOnboardingManager","params","onboardingData","documentGuid","chain","step","chainStep","buttonsContainer","document","querySelector","spotlight","BX","SpotLight","id","targetElement","autoSave","targetVertex","zIndex","show","container","style","pointerEvents","productListTabListener","event","close","data","productListEditor","buttonsPanelListener","activeHint","getActiveHint","Event","unbind","bind","showFieldTourHint","title","Loc","getMessage","text","userOptions","save","EventEmitter","unsubscribe","subscribe","Document","settings","isDocumentDeducted","documentStatus","isDeductLocked","masterSliderUrl","addCopyLinkPopup","emit","tabId","eventEditor","_ajaxForm","action","_actionName","_config","ACTION","saveAndDeductAction","controllersErrorCollection","getControllersIssues","getControllers","length","cancel","_toolPanel","setLocked","addError","urlParams","isNewDocument","entityId","addUrlParams","isTabAnalyticsSent","sendAnalyticsData","tab","documentType","UI","SidePanel","Wrapper","setParam","showNotificationOnClose","controllers","validateErrorCollection","Array","forEach","controller","Crm","EntityStoreDocumentProductListController","push","getErrorCollection","card","Instance","open","cacheable","openGridOnDone","events","onCloseComplete","slider","getSlider","getData","get","sliders","getOpenSliders","getWindow","Catalog","DocumentGridManager","allowChangeHistory","location","reload","editor","getEditorInstance","savePanel","saveButton","_editButton","defaultSaveActionName","defaultOnSuccessCallback","onsuccess","onclick","onSaveButtonClick","deductAndSaveButton","Tag","render","openMasterSlider","result","error","prop","getString","setViewModeButtons","onSaveSuccess","after","deductButton","Button","color","ButtonColor","LIGHT_BORDER","button","isLocked","setState","ButtonState","CLOCKING","actionName","cancelDeductAction","deductAction","errorCollection","validateProductList","clearErrors","setActive","formData","window","EntityEditorDocumentOrderShipmentController","demandFormData","deductDocumentAjaxForm","createAjaxForm","enableRequiredUserFieldCheck","onSuccess","ACTIVE","onFailure","onSaveFailure","submit","control","getMode","EntityEditorMode","edit","setEditModeButtons","sender","disableSaveButton","hideToolPanel","url","redirectUrl","Uri","removeParam","top","Notification","Center","notify","content","actions","href","click","balloon","isNew","hasOwnProperty","hide","_cancelButton","Reflection","getClass","EntityEditor","getDefault","copyLinkButton","getElementById","copyLinkButtonId","copyDocumentLinkToClipboard","util","remove_url_param","clipboard","copy","popup","PopupWindow","darkMode","autoHide","angle","bindOptions","position","setTimeout","ajax","runComponentAction","mode","analyticsLabel","processOnboarding","BaseCard"],"mappings":"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"}