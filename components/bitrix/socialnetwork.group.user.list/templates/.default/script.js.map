{"version":3,"file":"script.js","sources":["src/actionmanager.js","src/manager.js"],"sourcesContent":["import {ajax, Type, Loc, Tag} from 'main.core';\nimport {PopupManager} from 'main.popup';\nimport {SendButton, CancelButton} from 'ui.buttons';\n\nimport Manager from './manager'\n\nexport default class ActionManager\n{\n\tconstructor(\n\t\tparams: {\n\t\t\tparent: Manager,\n\t\t}\n\t)\n\t{\n\t\tthis.parent = params.parent;\n\t\tthis.componentName = (Type.isStringFilled(this.parent.componentName) ? this.parent.componentName : '');\n\t\tthis.signedParameters = (Type.isStringFilled(this.parent.signedParameters) ? this.parent.signedParameters : '');\n\t\tthis.gridId = (Type.isStringFilled(this.parent.gridId) ? this.parent.gridId : '');\n\t\tthis.useSlider = (Type.isBoolean(this.parent.useSlider) ? this.parent.useSlider : false);\n\t}\n\n\tviewProfile(params)\n\t{\n\t\tconst userId = parseInt(!Type.isUndefined(params.userId) ? params.userId : 0);\n\t\tlet pathToUser = (Type.isStringFilled(params.pathToUser) ? params.pathToUser : '');\n\n\t\tif (\n\t\t\tuserId <= 0\n\t\t\t|| !Type.isStringFilled(pathToUser)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpathToUser = pathToUser.replace('#ID#', userId)\n\t\t\t.replace('#USER_ID#', userId)\n\t\t\t.replace('#user_id#', userId);\n\n\t\tif (this.useSlider)\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\tpathToUser,\n\t\t\t\t{\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tallowChangeHistory: true,\n\t\t\t\t\tcontentClassName: 'bitrix24-profile-slider-content',\n\t\t\t\t\tloader: 'intranet:profile',\n\t\t\t\t\twidth: 1100,\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twindow.location.href = pathToUser;\n\t\t}\n\t}\n\n\tact(\n\t\tparams: {\n\t\t\taction: string,\n\t\t\tuserId: number,\n\t\t}\n\t)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\treturn ajax.runComponentAction(this.componentName, 'act', {\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: {\n\t\t\t\t\taction: params.action,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tuserId: params.userId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tif (response.data.success)\n\t\t\t\t{\n\t\t\t\t\tthis.processActionSuccess(params);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.processActionFailure(params);\n\t\t\t\t}\n\t\t\t\tresolve(response);\n\t\t\t}, (response) => {\n\n\t\t\t\tif (response.errors)\n\t\t\t\t{\n\t\t\t\t\tthis.processActionFailure(params, response.errors[0].message);\n\t\t\t\t}\n\t\t\t\treject(response);\n\t\t\t});\n\t\t});\n\t}\n\n\tprocessActionSuccess(\n\t\tparams: {\n\t\t\taction: string,\n\t\t\tuserId: number,\n\t\t}\n\t)\n\t{\n\t\tlet eventCode = null;\n\n\t\tswitch (params.action)\n\t\t{\n\t\t\tcase 'exclude':\n\t\t\t\teventCode = 'afterUserExclude';\n\t\t\t\tbreak;\n\t\t\tcase 'setOwner':\n\t\t\t\teventCode = 'afterOwnerSet';\n\t\t\t\tbreak;\n\t\t\tcase 'setScrumMaster':\n\t\t\t\teventCode = 'afterSetScrumMaster';\n\t\t\t\tbreak;\n\t\t\tcase 'setModerator':\n\t\t\t\teventCode = 'afterModeratorAdd';\n\t\t\t\tbreak;\n\t\t\tcase 'removeModerator':\n\t\t\t\teventCode = 'afterModeratorRemove';\n\t\t\t\tbreak;\n\t\t\tcase 'acceptIncomingRequest':\n\t\t\tcase 'rejectIncomingRequest':\n\t\t\t\teventCode = 'afterRequestDelete';\n\t\t\t\tbreak;\n\t\t\tcase 'deleteOutgoingRequest':\n\t\t\t\teventCode = 'afterRequestOutDelete';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\n\t\tif (\n\t\t\teventCode\n\t\t\t&& top.BX.SidePanel\n\t\t\t&& window !== top.window\n\t\t)\n\t\t{\n\t\t\ttop.BX.SidePanel.Instance.postMessageAll(window, 'sonetGroupEvent', {\n\t\t\t\tcode: eventCode,\n\t\t\t});\n\t\t}\n\n\t\tif (params.action === 'reinvite')\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('SOCIALNETWORK_GROUP_USER_LIST_ACTION_REINVITE_SUCCESS'),\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.parent.reload();\n\t\t}\n\t}\n\n\tprocessActionFailure(\n\t\tparams: {\n\t\t\taction: string,\n\t\t\tuserId: number,\n\t\t\tevent: PointerEvent,\n\t\t},\n\t\terrorMessage: ?string\n\t)\n\t{\n\t\tif (!Type.isStringFilled(errorMessage))\n\t\t{\n\t\t\terrorMessage = Loc.getMessage('SOCIALNETWORK_GROUP_USER_LIST_ACTION_FAILURE');\n\t\t}\n\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: errorMessage,\n\t\t});\n\t}\n\n\tdisconnectDepartment(params)\n\t{\n\t\tconst id = parseInt(!Type.isUndefined(params.id) ? params.id : 0);\n\n\t\tif (id <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runComponentAction(this.componentName, 'disconnectDepartment', {\n\t\t\tmode: 'class',\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tdata: {\n\t\t\t\tfields: {\n\t\t\t\t\tid: id,\n\t\t\t\t},\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.data.success)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttop.BX.SidePanel\n\t\t\t\t\t&& window !== top.window\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\ttop.BX.SidePanel.Instance.postMessageAll(window, 'sonetGroupEvent', {\n\t\t\t\t\t\tcode: 'afterDeptUnconnect',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.parent.reload();\n\t\t\t}\n\t\t});\n\t}\n\n\tgroupDelete()\n\t{\n\t\tconst buttons = [\n\t\t\tnew SendButton({\n\t\t\t\ttext: Loc.getMessage('SOCIALNETWORK_GROUP_USER_LIST_GROUP_ACTION_BUTTON_DELETE'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tPopupManager.getCurrentPopup().destroy();\n\n\t\t\t\t\t\tconst gridInstance = BX.Main.gridManager.getInstanceById(this.gridId);\n\t\t\t\t\t\tif (!gridInstance)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst data = {\n\t\t\t\t\t\t\tID: gridInstance.getRows().getSelectedIds(),\n\t\t\t\t\t\t\tapply_filter: 'Y',\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tdata[gridInstance.getActionKey()] = 'delete';\n\t\t\t\t\t\tdata[gridInstance.getForAllKey()] = 'N';\n\n\t\t\t\t\t\tgridInstance.reloadTable('POST', data);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t\tnew CancelButton({\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tPopupManager.getCurrentPopup().destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t})\n\t\t];\n\n\t\tconst confirmPopup = PopupManager.create({\n\t\t\tid: 'bx-sgul-group-delete-confirm',\n\t\t\tautoHide: false,\n\t\t\tcloseByEsc: true,\n\t\t\tbuttons: buttons,\n\t\t\tevents: {\n\t\t\t\tonPopupClose: (popup) => {\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t\tcontent: Tag.render`<div>${Loc.getMessage('SOCIALNETWORK_GROUP_USER_LIST_GROUP_ACTION_CONFIRM_TEXT')}</div>`,\n\t\t\tpadding: 20,\n\t\t});\n\n\t\tconfirmPopup.show();\n\t}\n}\n","import {Type} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport ActionManager from './actionmanager';\n\nexport default class Manager\n{\n\tstatic repo = new Map();\n\n\tstatic getById(id)\n\t{\n\t\treturn Manager.repo.get(id);\n\t}\n\n\tconstructor(\n\t\tparams: {\n\t\t\tid: string,\n\t\t\tgridId: string,\n\t\t\tfilterId: string,\n\t\t\tdefaultFilterPresetId: string,\n\t\t\tdefaultCounter: string,\n\t\t\tgridContainerId: string,\n\t\t\tcomponentName: string,\n\t\t\tsignedParameters: string,\n\t\t\tuseSlider: boolean,\n\t\t\turls: {\n\t\t\t\tusers: string,\n\t\t\t\trequests: string,\n\t\t\t\trequestsOut: string,\n\t\t\t},\n\t\t}\n\t)\n\t{\n\t\tthis.id = params.id;\n\t\tthis.componentName = params.componentName;\n\t\tthis.signedParameters = params.signedParameters;\n\t\tthis.useSlider = params.useSlider;\n\t\tthis.gridId = params.gridId;\n\t\tthis.filterId = (Type.isStringFilled(params.filterId) ? params.filterId : null);\n\t\tthis.defaultFilterPresetId = (\n\t\t\tType.isStringFilled(params.defaultFilterPresetId)\n\t\t\t&& ![ 'requests_in', 'requests_out' ].includes(params.defaultFilterPresetId)\n\t\t\t\t? params.defaultFilterPresetId\n\t\t\t\t: 'tmp_filter'\n\t\t);\n\t\tthis.defaultCounter = (Type.isStringFilled(params.defaultCounter) ? params.defaultCounter : '');\n\t\tthis.gridContainer = (Type.isStringFilled(params.gridContainerId) ? document.getElementById(params.gridContainerId) : null);\n\t\tthis.urls = params.urls;\n\n\t\tthis.actionManagerInstance = new ActionManager({\n\t\t\tparent: this,\n\t\t});\n\n\t\tManager.repo.set(this.id, this);\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tthis.initEvents();\n\t}\n\n\tinitEvents()\n\t{\n\t\tif (this.gridContainer)\n\t\t{\n\t\t\tthis.gridContainer.addEventListener('click', this.processClickEvent.bind(this));\n\t\t}\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', (event: BaseEvent) => {\n\n\t\t\tconst [ sliderEvent ] = event.getCompatData();\n\n\t\t\tif (\n\t\t\t\tsliderEvent.getEventId() === 'sonetGroupEvent'\n\t\t\t\t&& !Type.isUndefined(sliderEvent.data)\n\t\t\t\t&& Type.isStringFilled(sliderEvent.data.code)\n\t\t\t\t&& [ 'afterInvite', 'afterIncomingRequestCancel' ].includes(sliderEvent.data.code)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.reload();\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('Socialnetwork.Toolbar:onItem', (event: BaseEvent) => {\n\t\t\tconst data = event.getData();\n\n\t\t\tif (data.counter)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tdata.counter.filter\n\t\t\t\t\t&& data.counter.filterPresetId\n\t\t\t\t\t&& data.counter.filter.filterManager\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tconst filterApi = data.counter.filter.getFilter().getApi();\n\t\t\t\t\tconst filterManager = data.counter.filter.filterManager;\n\n\t\t\t\t\tfilterApi.setFilter({\n\t\t\t\t\t\tpreset_id: (\n\t\t\t\t\t\t\tfilterManager.getPreset().getCurrentPresetId() === data.counter.filterPresetId\n\t\t\t\t\t\t\t\t? this.defaultFilterPresetId\n\t\t\t\t\t\t\t\t: data.counter.filterPresetId\n\t\t\t\t\t\t),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse if (Type.isStringFilled(data.counter.type))\n\t\t\t\t{\n\t\t\t\t\tlet url = '';\n\n\t\t\t\t\tif (data.counter.type === this.defaultCounter)\n\t\t\t\t\t{\n\t\t\t\t\t\turl = this.urls.users;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tswitch (data.counter.type)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcase 'workgroup_requests_in':\n\t\t\t\t\t\t\t\turl = this.urls.requests;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'workgroup_requests_out':\n\t\t\t\t\t\t\t\turl = this.urls.requestsOut;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isStringFilled(url))\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.location = url.replace('#group_id#', this.g);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst filterInstance = BX.Main.filterManager.getById(this.filterId);\n\t\tif (filterInstance)\n\t\t{\n\t\t\tconst filterEmitter = filterInstance.getEmitter();\n\t\t\tconst filterApi = filterInstance.getApi();\n\n\t\t\tfilterEmitter.subscribe('init', (event) => {\n\t\t\t\tconst { field } = event.getData();\n\t\t\t\tif (field.id === 'INITIATED_BY_TYPE')\n\t\t\t\t{\n\t\t\t\t\tfield.subscribe('change', () => {\n\n\t\t\t\t\t\tif (Type.isStringFilled(field.getValue()))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst filterFieldsValues = filterInstance.getFilterFieldsValues();\n\n\t\t\t\t\t\t\tif (Type.isStringFilled(filterFieldsValues.INITIATED_BY_TYPE))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (JSON.stringify(Object.values(filterFieldsValues.ROLE)) === JSON.stringify([ 'Z' ]))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tfilterFieldsValues.ROLE = { 0: 'Z' };\n\t\t\t\t\t\t\t\tfilterApi.setFields(filterFieldsValues);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe('BX.Grid.SettingsWindow:save', (event: BaseEvent) => {\n\t\t\t\tconst [ settingsWindow ] = event.getData();\n\t\t\t\tif (!settingsWindow || !settingsWindow.parent || settingsWindow.parent.getId() !== this.gridId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfilterApi.setFilter({\n\t\t\t\t\tpreset_id: this.defaultFilterPresetId,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\treload()\n\t{\n\t\tconst gridInstance = BX.Main.gridManager.getInstanceById(this.gridId);\n\t\tif (!gridInstance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tgridInstance.reloadTable('POST', {\n\t\t\tapply_filter: 'Y',\n\t\t});\n\t}\n\n\tprocessClickEvent(e)\n\t{\n\t\tconst targetNode = e.target;\n\n\t\tif (!targetNode.hasAttribute('data-bx-action'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = targetNode.getAttribute('data-bx-action');\n\n\t\tif (action === 'disconnectDepartment')\n\t\t{\n\t\t\tconst departmentId = Number(targetNode.getAttribute('data-bx-department'));\n\t\t\tif (departmentId > 0)\n\t\t\t{\n\t\t\t\tthis.getActionManager().disconnectDepartment({\n\t\t\t\t\tid: departmentId,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet userId = targetNode.getAttribute('data-bx-user-id');\n\n\t\tif (\n\t\t\t!Type.isStringFilled(action)\n\t\t\t|| !Type.isStringFilled(userId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tuserId = parseInt(userId);\n\t\tif (userId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttargetNode.classList.add('--inactive');\n\n\t\tthis.actionManagerInstance.act({\n\t\t\taction: action,\n\t\t\tuserId: userId,\n\t\t}).then(() => {\n\t\t\ttargetNode.classList.remove('--inactive');\n\t\t}, () => {\n\t\t\ttargetNode.classList.remove('--inactive');\n\t\t});\n\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t}\n\n\tgetActionManager()\n\t{\n\t\treturn this.actionManagerInstance;\n\t}\n\n}\n"],"names":["ActionManager","params","parent","componentName","Type","isStringFilled","signedParameters","gridId","useSlider","isBoolean","userId","parseInt","isUndefined","pathToUser","replace","BX","SidePanel","Instance","open","cacheable","allowChangeHistory","contentClassName","loader","width","window","location","href","Promise","resolve","reject","ajax","runComponentAction","mode","data","action","fields","then","response","success","processActionSuccess","processActionFailure","errors","message","eventCode","top","postMessageAll","code","UI","Notification","Center","notify","content","Loc","getMessage","reload","errorMessage","id","buttons","SendButton","text","events","click","PopupManager","getCurrentPopup","destroy","gridInstance","Main","gridManager","getInstanceById","ID","getRows","getSelectedIds","apply_filter","getActionKey","getForAllKey","reloadTable","CancelButton","confirmPopup","create","autoHide","closeByEsc","onPopupClose","popup","Tag","render","padding","show","Manager","repo","get","filterId","defaultFilterPresetId","includes","defaultCounter","gridContainer","gridContainerId","document","getElementById","urls","actionManagerInstance","set","init","initEvents","addEventListener","processClickEvent","bind","EventEmitter","subscribe","event","getCompatData","sliderEvent","getEventId","getData","counter","filter","filterPresetId","filterManager","filterApi","getFilter","getApi","setFilter","preset_id","getPreset","getCurrentPresetId","type","url","users","requests","requestsOut","g","filterInstance","getById","filterEmitter","getEmitter","field","getValue","filterFieldsValues","getFilterFieldsValues","INITIATED_BY_TYPE","JSON","stringify","Object","values","ROLE","setFields","settingsWindow","getId","e","targetNode","target","hasAttribute","getAttribute","departmentId","Number","getActionManager","disconnectDepartment","classList","add","act","remove","preventDefault","stopPropagation","Map"],"mappings":"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"}