if(typeof oObject!="object")window.oObject={};var Errors={result_unval:"Error in result",result_empty:"Empty result"};function SonetJsTc(e,t,o,n,r){var i=this,s=0;i.oObj=typeof e=="object"?e:document.getElementById("TAGS");i.sParams=t;i.oBtn=n;i.bHint=r;i.sExp=new RegExp("[ ]*[\0-\x1f!-,/:-?[-^`{-\x7f\x98\x9e\xa6-\xff\xa0]+[ ]*","i");i.oLast={str:false,arr:false};i.oThis={str:false,arr:false};i.oEl={start:false,end:false};i.oUnfinedWords={};i.bReady=true,i.eFocus=true;i.aDiv=null,i.oDiv=null;i.oActive=null,i.oPointer=Array(),i.oPointer_default=Array(),i.oPointer_this="input_field";i.oObj.onblur=function(){i.eFocus=false};i.oObj.onfocus=function(){if(i.bHint){i.oObj.value="";i.bHint=false}if(!i.eFocus){i.eFocus=true;setTimeout(function(){i.CheckModif("focus")},500)}};if(o){i.sExp=new RegExp("["+o+"]+","i")}i.oLast["arr"]=i.oObj.value.split(i.sExp);i.oLast["str"]=i.oLast["arr"].join(":");setTimeout(function(){i.CheckModif("this")},500);this.CheckModif=function(e){var t=false,o=0,n=false,r="",s={};if(!i.eFocus)return;if(i.oObj.value.length<=0&&i.oBtn){i.oBtn.disabled=true}if(!i.bHint&&i.bReady&&i.oObj.value.length>0){i.oThis["arr"]=i.oObj.value.split(i.sExp);i.oThis["str"]=i.oThis["arr"].join(":");if(i.oThis["str"]&&i.oThis["str"]!=i.oLast["str"]){s["position"]=SonetTCJsUtils.getCursorPosition(i.oObj);if(s["position"]["end"]>0&&!i.sExp.test(i.oObj.value.substr(s["position"]["end"]-1,1))){s["arr"]=i.oObj.value.substr(0,s["position"]["end"]).split(i.sExp);t=i.oThis["arr"][s["arr"].length-1];i.oEl["start"]=s["position"]["end"]-s["arr"][s["arr"].length-1].length;i.oEl["end"]=i.oEl["start"]+t.length;i.oEl["content"]=t;i.oLast["arr"]=i.oThis["arr"];i.oLast["str"]=i.oThis["str"]}}if(t){for(o=2;o<=t.length;o++){r=t.substr(0,o);if(i.oUnfinedWords[r]=="!fined"){n=true;break}}if(!n){if(i.oBtn)i.oBtn.disabled=false;i.Send(t)}}if(i.oBtn)i.oBtn.disabled=false}setTimeout(function(){i.CheckModif("this")},500)},i.Send=function(e){i.bReady=false;var t=Array();var o={search:e,params:i.sParams};var n="";for(var r in o){if(n.length>0)n+="&";var s=escape(r).replace(/\+/g,"%2B");n+=s+"="+escape(o[r]).replace(/\+/g,"%2B")}BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.user_search_input/search.php"+"?"+n,method:"GET",dataType:"json",data:{},onsuccess:function(e){i.bReady=true;if(typeof e=="object"&&e.length!=0&&!(e.length==1&&e[0]["NAME"]==i.oEl["content"])){i.Show(e);t["result_empty"]=Errors["result_empty"]}},onfailure:function(e){i.bReady=true;i.oUnfinedWords[i.oEl["content"]]="!fined"}})},i.Show=function(e){i.Destroy();i.oDiv=document.body.appendChild(document.createElement("DIV"));i.oDiv.id=i.oObj.id+"_div";BX.ZIndexManager.register(i.oDiv);i.oDiv.className="search-popup";i.oDiv.style.position="absolute";i.aDiv=i.Print(e);var t=SonetTCJsUtils.GetRealPos(i.oObj);if(t["width"]<400)t["width"]=400;v=document.compatMode=="CSS1Compat"&&!window.opera?document.documentElement.clientWidth:document.body.clientWidth;if(v<t["width"]+t["left"]){t["left"]=v-t["width"];if(t["left"]<0)t["left"]=0}i.oDiv.style.width=parseInt(t["width"])+"px";SonetTCJsUtils.show(i.oDiv,t["left"],t["bottom"]);SonetTCJsUtils.addEvent(document,"click",i.CheckMouse);SonetTCJsUtils.addEvent(document,"keydown",i.CheckKeyword)},i.Print=function(e){var t=null,o="",n="",r=Array(),s=Array(),a=0,l=0,u=0,f=true,c=null,d=null;o=i.oDiv.id;for(u in e){t=e[u];s=Array();s["ID"]=t["ID"]&&t["ID"].length>0?t["ID"]:a++;s["GID"]=o+"_"+s["ID"];s["NAME"]=t["NAME"];s["ADD"]=t["ADD"];r[s["GID"]]=s;i.oPointer.push(s["GID"]);c=i.oDiv.appendChild(document.createElement("DIV"));c.id=s["GID"];c.name=o+"_div";c.className="search-popup-row";c.onmouseover=function(){i.Init();this.className="search-popup-row-active"};c.onmouseout=function(){i.Init();this.className="search-popup-row"};c.onclick=function(){i.oActive=this.id;BX.fireEvent(BX(BX.message("sonetUSIInputID")),"change")};d=c.appendChild(document.createElement("DIV"));d.id=c.id+"_NAME";d.className="search-popup-el search-popup-el-name";d.innerHTML=s["NAME"]}i.oPointer.push("input_field");i.oPointer_default=i.oPointer;return r},i.Destroy=function(){if(i.oDiv&&i.oDiv.parentNode){SonetTCJsUtils.hide(i.oDiv);BX.ZIndexManager.unregister(i.oDiv);i.oDiv.parentNode.removeChild(i.oDiv)}i.aDiv=Array();i.oPointer=Array(),i.oPointer_default=Array(),i.oPointer_this="input_field";i.bReady=true,i.eFocus=true,oError={},i.oActive=null;SonetTCJsUtils.removeEvent(document,"click",i.CheckMouse);SonetTCJsUtils.removeEvent(document,"keydown",i.CheckKeyword)},i.Replace=function(){if(typeof i.oActive=="string"){var e=i.aDiv[i.oActive];var t="";if(typeof e=="object"){t=e["NAME"].replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&quot;/g,'"').replace(/\&amp;/g,"&")}e=i.oObj.value.substring(0,i.oEl["start"])+t;i.oObj.value=i.oObj.value.substring(0,i.oEl["start"])+t+i.oObj.value.substr(i.oEl["end"]);SonetTCJsUtils.setCursorPosition(i.oObj,e.length);if(i.oBtn)i.oBtn.disabled=false}return},i.Init=function(){i.oActive=false;i.oPointer=i.oPointer_default;i.Clear();i.oPointer_this="input_pointer"},i.Clear=function(){var e={},t="";e=i.oDiv.getElementsByTagName("div");if(e.length>0&&typeof e=="object"){for(t in e){var o=e[t];if(o&&typeof o=="object"&&o.name==i.oDiv.id+"_div"){o.className="search-popup-row"}}}return},i.CheckMouse=function(){i.Replace();i.Destroy()},i.CheckKeyword=function(e){if(!e)e=window.event;var t=null,o=null,n=null;if(37<e.keyCode&&e.keyCode<41||e.keyCode==13){i.Clear();switch(e.keyCode){case 38:t=i.oPointer.pop();if(i.oPointer_this==t){i.oPointer.unshift(t);t=i.oPointer.pop()}if(t!="input_field"){i.oActive=t;o=document.getElementById(t);if(typeof o=="object"){o.className="search-popup-row-active"}}i.oPointer.unshift(t);break;case 40:t=i.oPointer.shift();if(i.oPointer_this==t){i.oPointer.push(t);t=i.oPointer.shift()}if(t!="input_field"){i.oActive=t;o=document.getElementById(t);if(typeof o=="object"){o.className="search-popup-row-active"}}i.oPointer.push(t);break;case 39:i.Replace();i.Destroy();break;case 13:i.Replace();i.Destroy();if(SonetTCJsUtils.IsIE()){e.returnValue=false;e.cancelBubble=true}else{e.preventDefault();e.stopPropagation()}break}i.oPointer_this=t}else{i.Destroy()}}}var SonetTCJsUtils={arEvents:Array(),addEvent:function(e,t,o){if(e.attachEvent)e.attachEvent("on"+t,o);else if(e.addEventListener)e.addEventListener(t,o,false);else e["on"+t]=o;this.arEvents[this.arEvents.length]={element:e,event:t,fn:o}},removeEvent:function(e,t,o){if(e.detachEvent)e.detachEvent("on"+t,o);else if(e.removeEventListener)e.removeEventListener(t,o,false);else e["on"+t]=null},getCursorPosition:function(e){var t={start:0,end:0};if(!e||typeof e!="object")return t;try{if(document.selection!=null&&e.selectionStart==null){e.focus();var o=document.selection.createRange(),n=o.parentElement(),r=o.getBookmark(),i=sContents_=e.value,s="__"+Math.random()+"__";while(i.indexOf(s)!=-1){s="__"+Math.random()+"__"}if(!n||n==null||n.type!="textarea"&&n.type!="text"){return t}o.text=s+o.text+s;i=e.value;t["start"]=i.indexOf(s);i=i.replace(s,"");t["end"]=i.indexOf(s);e.value=sContents_;o.moveToBookmark(r);o.select();return t}else{return{start:e.selectionStart,end:e.selectionEnd}}}catch(e){}return t},setCursorPosition:function(e,t){var o=false;if(typeof e!="object")return false;e.focus();try{if(document.selection!=null&&e.selectionStart==null){var n=document.selection.createRange();n.select()}else{e.selectionStart=t;e.selectionEnd=t}return true}catch(e){return false}},printArray:function(e,t,o){try{var n="",r="",i=null,s=0;if(o==undefined)o=0;if(!t)t="\n";for(s=0;s<=o;s++)r+="  ";for(i in e){if(typeof e[i]=="object")n+=r+i+" = {"+t+SonetTCJsUtils.printArray(e[i],t,o+1)+", "+t+"}"+t;else n+=r+i+" = "+e[i]+"; "+t}return n}catch(e){return}},empty:function(e){var t=true;if(e){for(i in e){t=false;break}}return t},show:function(e,t,o){if(typeof e!="object")return;var n=BX.ZIndexManager.getComponent(e);if(!n){BX.ZIndexManager.register(e)}BX.ZIndexManager.bringToFront(e);e.style.left=t+"px";e.style.top=o+"px";return e},hide:function(e){if(!e)return;e.style.display="none"},GetRealPos:function(e){if(!e||!e.offsetParent)return false;var t=Array();var o=e.offsetParent;t["left"]=e.offsetLeft;t["top"]=e.offsetTop;while(o&&o.tagName!="BODY"){t["left"]+=o.offsetLeft;t["top"]+=o.offsetTop;o=o.offsetParent}t["right"]=t["left"]+e.offsetWidth;t["bottom"]=t["top"]+e.offsetHeight;t["width"]=e.offsetWidth;t["height"]=e.offsetHeight;return t},IsIE:function(){return document.attachEvent&&!SonetTCJsUtils.IsOpera()},IsOpera:function(){return navigator.userAgent.toLowerCase().indexOf("opera")!=-1}};SonetTcLoadTI=true;
//# sourceMappingURL=script.map.js