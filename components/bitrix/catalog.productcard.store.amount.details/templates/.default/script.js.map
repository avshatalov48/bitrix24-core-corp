{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Dom, Reflection, Tag, Text, Type} from \"main.core\";\nimport {typeof BaseEvent, EventEmitter} from \"main.core.events\";\n\nclass StoreAmountDetails\n{\n\tconstructor(settings)\n\t{\n\t\tthis.gridId = settings.gridId;\n\t\tthis.productId = settings.productId;\n\t\tthis.onFilterApplyHandler = this.onFilterApply.bind(this);\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApplyHandler);\n\t}\n\n\tgetGridId()\n\t{\n\t\treturn this.gridId;\n\t}\n\n\tgetProductId()\n\t{\n\t\treturn this.productId;\n\t}\n\n\tonFilterApply(event: BaseEvent)\n\t{\n\t\tconst [gridId] = event.getCompatData();\n\n\t\tif (gridId !== this.getGridId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runComponentAction(\n\t\t\t'bitrix:catalog.productcard.store.amount.details',\n\t\t\t'updateTotalData',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tproductId: this.getProductId(),\n\t\t\t\t}\n\t\t\t}\n\t\t).then(response => {\n\t\t\tconst totalData = response?.data?.TOTAL_DATA;\n\t\t\tif (!totalData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst quantityAvailableNode = document.getElementById(this.getGridId() + '_total_quantity_available');\n\t\t\tif (quantityAvailableNode)\n\t\t\t{\n\t\t\t\tquantityAvailableNode.innerHTML = totalData.QUANTITY_AVAILABLE;\n\t\t\t}\n\n\t\t\tconst quantityReservedNode = document.getElementById(this.getGridId() + '_total_quantity_reserved');\n\t\t\tif (quantityReservedNode)\n\t\t\t{\n\t\t\t\tquantityReservedNode.innerHTML = totalData.QUANTITY_RESERVED;\n\t\t\t}\n\n\t\t\tconst quantityCommonNode = document.getElementById(this.getGridId() + '_total_quantity_common');\n\t\t\tif (quantityCommonNode)\n\t\t\t{\n\t\t\t\tquantityCommonNode.innerHTML = totalData.QUANTITY_COMMON;\n\t\t\t}\n\n\t\t\tconst totalPriceNode = document.getElementById(this.getGridId() + '_total_price');\n\t\t\tif (totalPriceNode)\n\t\t\t{\n\t\t\t\ttotalPriceNode.innerHTML = totalData.PRICE;\n\t\t\t}\n\t\t});\n\t}\n}\n\nReflection.namespace('BX.Catalog').StoreAmountDetails = StoreAmountDetails;\n"],"names":["StoreAmountDetails","settings","gridId","productId","onFilterApplyHandler","onFilterApply","bind","EventEmitter","subscribe","event","getCompatData","getGridId","BX","ajax","runComponentAction","mode","data","getProductId","then","response","totalData","TOTAL_DATA","quantityAvailableNode","document","getElementById","innerHTML","QUANTITY_AVAILABLE","quantityReservedNode","QUANTITY_RESERVED","quantityCommonNode","QUANTITY_COMMON","totalPriceNode","PRICE","Reflection","namespace"],"mappings":";;;KAGMA;CAEL,8BAAYC,QAAZ,EACA;CAAA;CACC,SAAKC,MAAL,GAAcD,QAAQ,CAACC,MAAvB;CACA,SAAKC,SAAL,GAAiBF,QAAQ,CAACE,SAA1B;CACA,SAAKC,oBAAL,GAA4B,KAAKC,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAA5B;CACAC,IAAAA,6BAAY,CAACC,SAAb,CAAuB,sBAAvB,EAA+C,KAAKJ,oBAApD;CACA;;;;iCAGD;CACC,aAAO,KAAKF,MAAZ;CACA;;;oCAGD;CACC,aAAO,KAAKC,SAAZ;CACA;;;mCAEaM,OACd;CAAA;;CACC,iCAAiBA,KAAK,CAACC,aAAN,EAAjB;CAAA;CAAA,UAAOR,MAAP;;CAEA,UAAIA,MAAM,KAAK,KAAKS,SAAL,EAAf,EACA;CACC;CACA;;CAEDC,MAAAA,EAAE,CAACC,IAAH,CAAQC,kBAAR,CACC,iDADD,EAEC,iBAFD,EAGC;CACCC,QAAAA,IAAI,EAAE,OADP;CAECC,QAAAA,IAAI,EAAE;CACLb,UAAAA,SAAS,EAAE,KAAKc,YAAL;CADN;CAFP,OAHD,EASEC,IATF,CASO,UAAAC,QAAQ,EAAI;CAAA;;CAClB,YAAMC,SAAS,GAAGD,QAAH,aAAGA,QAAH,yCAAGA,QAAQ,CAAEH,IAAb,mDAAG,eAAgBK,UAAlC;;CACA,YAAI,CAACD,SAAL,EACA;CACC;CACA;;CAED,YAAME,qBAAqB,GAAGC,QAAQ,CAACC,cAAT,CAAwB,KAAI,CAACb,SAAL,KAAmB,2BAA3C,CAA9B;;CACA,YAAIW,qBAAJ,EACA;CACCA,UAAAA,qBAAqB,CAACG,SAAtB,GAAkCL,SAAS,CAACM,kBAA5C;CACA;;CAED,YAAMC,oBAAoB,GAAGJ,QAAQ,CAACC,cAAT,CAAwB,KAAI,CAACb,SAAL,KAAmB,0BAA3C,CAA7B;;CACA,YAAIgB,oBAAJ,EACA;CACCA,UAAAA,oBAAoB,CAACF,SAArB,GAAiCL,SAAS,CAACQ,iBAA3C;CACA;;CAED,YAAMC,kBAAkB,GAAGN,QAAQ,CAACC,cAAT,CAAwB,KAAI,CAACb,SAAL,KAAmB,wBAA3C,CAA3B;;CACA,YAAIkB,kBAAJ,EACA;CACCA,UAAAA,kBAAkB,CAACJ,SAAnB,GAA+BL,SAAS,CAACU,eAAzC;CACA;;CAED,YAAMC,cAAc,GAAGR,QAAQ,CAACC,cAAT,CAAwB,KAAI,CAACb,SAAL,KAAmB,cAA3C,CAAvB;;CACA,YAAIoB,cAAJ,EACA;CACCA,UAAAA,cAAc,CAACN,SAAf,GAA2BL,SAAS,CAACY,KAArC;CACA;CACD,OAvCD;CAwCA;;;;;AAGFC,qBAAU,CAACC,SAAX,CAAqB,YAArB,EAAmClC,kBAAnC,GAAwDA,kBAAxD;;;;"}