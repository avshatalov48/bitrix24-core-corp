(function(){BX.namespace("BX.Sender");if(BX.Sender.LetterList){return}var t=BX.Sender.Page;function e(){}e.prototype.init=function(t){this.gridId=t.gridId;this.actionUri=t.actionUri;this.pathToEdit=t.pathToEdit;this.mess=t.mess;this.buttonAdd=BX("SENDER_LETTER_BUTTON_ADD");if(this.buttonAdd){var e=(t.messages||[]).filter(function(t){return!t.IS_HIDDEN}).map(function(t){return{id:t.CODE,text:t.NAME,onclick:this.onMenuItemClick.bind(this,t),className:t.IS_AVAILABLE?"":"b24-tariff-lock"}},this);this.initMenuAdd(e)}this.ajaxAction=new BX.AjaxAction(this.actionUri);this.userErrorHandler=new BX.Sender.ErrorHandler};e.prototype.remove=function(t){this.sendChangeStateAction("remove",t)};e.prototype.copy=function(e){var n=this;this.sendChangeStateAction("copy",e,function(e){if(!e.copiedId){return}t.open(n.pathToEdit.replace("#id#",e.copiedId))})};e.prototype.send=function(t){this.sendChangeStateAction("send",t)};e.prototype.wait=function(t){this.sendChangeStateAction("wait",t)};e.prototype.halt=function(t){this.sendChangeStateAction("halt",t)};e.prototype.pause=function(t){this.sendChangeStateAction("pause",t)};e.prototype.stop=function(t){this.sendChangeStateAction("stop",t)};e.prototype.resume=function(t){this.sendChangeStateAction("resume",t)};e.prototype.sendChangeStateAction=function(e,n,i){var o=this.gridId;var s=null;if(BX.Main&&BX.Main.gridManager){var r=BX.Main.gridManager.getById(o);if(r){s=r.instance.getRows().getById(n).getDataset().messageCode}}t.changeGridLoaderShowing(o,true);var a=this;this.ajaxAction.request({action:e,onsuccess:function(e){t.reloadGrid(o);if(i){i.apply(a,[e])}},onusererror:this.userErrorHandler.getHandlers(function(){this.sendChangeStateAction(e,n,i)}.bind(this),function(){t.changeGridLoaderShowing(o,false)}.bind(this),{editUrl:this.pathToEdit.replace("#id#",n)}),onfailure:function(){t.changeGridLoaderShowing(o,false)},data:{id:n},urlParams:{messageCode:s}})};e.prototype.onMenuItemClick=function(e){if(!e.IS_AVAILABLE&&BX.Sender.B24License){BX.Sender.B24License.showPopup("Rc");this.popupMenu.close();return}t.open(e.URL);this.popupMenu.close()};e.prototype.initMenuAdd=function(t){if(this.popupMenu){this.popupMenu.show();return}this.popupMenu=BX.PopupMenu.create("sender-letter-list",this.buttonAdd,t,{autoHide:true,autoClose:true});BX.bind(this.buttonAdd,"click",this.popupMenu.show.bind(this.popupMenu))};BX.Sender.LetterList=new e})(window);
//# sourceMappingURL=script.map.js