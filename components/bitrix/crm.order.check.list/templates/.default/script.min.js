BX.namespace("BX.Crm");if(typeof BX.Crm.OrderPaymentCheckList==="undefined"){BX.Crm.OrderPaymentCheckList=function(){this._id="";this._settings=""};BX.Crm.OrderPaymentCheckList.prototype={initialize:function(e,t){this._id=BX.type.isNotEmptyString(e)?e:BX.util.getRandomString(4);this._settings=t?t:{};this.unbindEvents();this.bindEvents()},bindEvents:function(){BX.bind(document.querySelector(".order-payment-check-add"),"click",BX.delegate(function(e){this.onShowCheck(e,this._settings.ADD_CHECK_URL)},this))},unbindEvents:function(){BX.unbind(document.querySelector(".order-payment-check-add"),"click",BX.delegate(function(e){this.onShowCheck(e,this._settings.ADD_CHECK_URL)},this))},onShowCheck:function(e,t){BX.addCustomEvent("SidePanel.Slider:onMessage",BX.delegate(this.onPaymentCheckUpdate,this));BX.Crm.Page.openSlider(t,{width:500})},onPaymentCheckUpdate:function(e){if(e.getEventId()==="CrmOrderPaymentCheck::Update"){this.unbindEvents();BX.Main.gridManager.reload(this._id)}}};BX.Crm.OrderPaymentCheckList.create=function(e,t){var n=new BX.Crm.OrderPaymentCheckList;n.initialize(e,t);return n};BX.Crm.OrderPaymentCheckList.refreshCheck=function(e,t){var n=t?t:{};var i=BX.type.isNotEmptyString(n.AJAX_URL)?n.AJAX_URL:"";var r=BX.type.isNotEmptyString(n.GRID_ID)?n.GRID_ID:"";if(!BX.type.isNotEmptyString(i)){return}var a={ACTION:"REFRESH_CHECK",ID:e};BX.ajax({url:i,method:"POST",dataType:"json",data:a,onsuccess:BX.delegate(function(e){if(BX.type.isNotEmptyString(e.ERROR)){alert(e.ERROR)}else{BX.Main.gridManager.reload(r)}},this),onfailure:function(e){}})}}