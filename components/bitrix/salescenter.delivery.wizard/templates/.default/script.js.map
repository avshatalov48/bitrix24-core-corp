{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":[";(function ()\n{\n\t'use strict';\n\n\tvar namespace = BX.namespace('BX.Salescenter.DeliveryInstallation');\n\tif (namespace.Wizard)\n\t{\n\t\treturn;\n\t}\n\n\t/**\n\t * Wizard.\n\t *\n\t */\n\tfunction Wizard()\n\t{\n\t}\n\n\tWizard.prototype.init = function (params)\n\t{\n\t\tthis.id = params.id;\n\t\tthis.code = params.code;\n\t\tthis.form = BX(params.formId);\n\t\tthis.saveButton = BX(params.saveButtonId);\n\t\tthis.confirmDeleteMessage = params.confirmDeleteMessage;\n\t\tthis.errorMessageNode = BX(params.errorMessageId);\n\n\t\tthis.buttonWaitClass = 'ui-btn-wait';\n\n\t\tBX.bind(this.saveButton, 'click', this.onSave.bind(this));\n\t\tBX.bind(this.form, 'submit', this.onSubmit.bind(this));\n\t};\n\tWizard.prototype.onSave = function ()\n\t{\n\t\tif (BX.hasClass(this.saveButton, this.buttonWaitClass))\n\t\t{\n\t\t\tBX.removeClass(this.saveButton, this.buttonWaitClass);\n\t\t}\n\t};\n\tWizard.prototype.delete = function (event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tlet deleteButton = event.target;\n\n\t\tif(this.id > 0 && confirm(this.confirmDeleteMessage))\n\t\t{\n\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t'bitrix:salescenter.delivery.wizard',\n\t\t\t\t'delete',\n\t\t\t\t{\n\t\t\t\t\tdata: {id: this.id, code: this.code},\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\tfunction() {\n\t\t\t\t\tdeleteButton.classList.remove('ui-btn-wait');\n\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t}.bind(this),\n\t\t\t\tfunction (result) {\n\t\t\t\t\tdeleteButton.classList.remove('ui-btn-wait');\n\n\t\t\t\t\tthis.showError(result.errors);\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(() => BX.removeClass(deleteButton, 'ui-btn-wait'), 100);\n\t\t}\n\t};\n\tWizard.prototype.onSubmit = function (event)\n\t{\n\t\tlet settings = {};\n\t\tlet formData = new FormData(this.form);\n\t\tfor(let pair of formData.entries())\n\t\t{\n\t\t\tsettings[pair[0]] = pair[1];\n\t\t}\n\n\t\tthis.saveButton.classList.add('ui-btn-wait');\n\n\t\tlet finallyCallback = () => {this.saveButton.classList.remove('ui-btn-wait');};\n\n\t\tlet action = formData.has('id') ? 'update' : 'install';\n\n\t\tBX.ajax.runComponentAction(\n\t\t\t'bitrix:salescenter.delivery.wizard',\n\t\t\taction,\n\t\t\t{\n\t\t\t\tjson: settings\n\t\t\t}\n\t\t).then((response) =>\n\t\t{\n\t\t\tfinallyCallback();\n\t\t\tBX.SidePanel.Instance.close();\n\t\t}).catch((result) => {\n\t\t\tfinallyCallback();\n\t\t\tthis.showError(result.errors);\n\t\t});\n\n\t\tevent.preventDefault();\n\t};\n\tWizard.prototype.showError = function (errors)\n\t{\n\t\tlet text = '';\n\n\t\terrors.forEach(function (error) {\n\t\t\ttext += error.message + '<br>';\n\t\t});\n\n\t\tif(this.errorMessageNode && text)\n\t\t{\n\t\t\tthis.errorMessageNode.parentNode.style.display = 'block';\n\t\t\tthis.errorMessageNode.innerHTML = text;\n\t\t}\n\t}\n\n\tnamespace.Wizard = new Wizard();\n})();"],"names":["namespace","BX","Wizard","prototype","init","params","id","code","form","formId","saveButton","saveButtonId","confirmDeleteMessage","errorMessageNode","errorMessageId","buttonWaitClass","bind","onSave","onSubmit","hasClass","removeClass","delete","event","preventDefault","deleteButton","target","confirm","ajax","runComponentAction","data","then","classList","remove","SidePanel","Instance","close","result","showError","errors","setTimeout","settings","formData","FormData","entries","pair","add","finallyCallback","action","has","json","response","catch","text","forEach","error","message","parentNode","style","display","innerHTML"],"mappings":";;;;;;;;;CAAC,CAAC,YACF;AACC;CAEA,MAAIA,SAAS,GAAGC,EAAE,CAACD,SAAH,CAAa,qCAAb,CAAhB;;CACA,MAAIA,SAAS,CAACE,MAAd,EACA;CACC;CACA;CAED;;;;;;CAIA,WAASA,MAAT,GACA;;CAGAA,EAAAA,MAAM,CAACC,SAAP,CAAiBC,IAAjB,GAAwB,UAAUC,MAAV,EACxB;CACC,SAAKC,EAAL,GAAUD,MAAM,CAACC,EAAjB;CACA,SAAKC,IAAL,GAAYF,MAAM,CAACE,IAAnB;CACA,SAAKC,IAAL,GAAYP,EAAE,CAACI,MAAM,CAACI,MAAR,CAAd;CACA,SAAKC,UAAL,GAAkBT,EAAE,CAACI,MAAM,CAACM,YAAR,CAApB;CACA,SAAKC,oBAAL,GAA4BP,MAAM,CAACO,oBAAnC;CACA,SAAKC,gBAAL,GAAwBZ,EAAE,CAACI,MAAM,CAACS,cAAR,CAA1B;CAEA,SAAKC,eAAL,GAAuB,aAAvB;CAEAd,IAAAA,EAAE,CAACe,IAAH,CAAQ,KAAKN,UAAb,EAAyB,OAAzB,EAAkC,KAAKO,MAAL,CAAYD,IAAZ,CAAiB,IAAjB,CAAlC;CACAf,IAAAA,EAAE,CAACe,IAAH,CAAQ,KAAKR,IAAb,EAAmB,QAAnB,EAA6B,KAAKU,QAAL,CAAcF,IAAd,CAAmB,IAAnB,CAA7B;CACA,GAbD;;CAcAd,EAAAA,MAAM,CAACC,SAAP,CAAiBc,MAAjB,GAA0B,YAC1B;CACC,QAAIhB,EAAE,CAACkB,QAAH,CAAY,KAAKT,UAAjB,EAA6B,KAAKK,eAAlC,CAAJ,EACA;CACCd,MAAAA,EAAE,CAACmB,WAAH,CAAe,KAAKV,UAApB,EAAgC,KAAKK,eAArC;CACA;CACD,GAND;;CAOAb,EAAAA,MAAM,CAACC,SAAP,CAAiBkB,MAAjB,GAA0B,UAAUC,KAAV,EAC1B;CACCA,IAAAA,KAAK,CAACC,cAAN;CAEA,QAAIC,YAAY,GAAGF,KAAK,CAACG,MAAzB;;CAEA,QAAG,KAAKnB,EAAL,GAAU,CAAV,IAAeoB,OAAO,CAAC,KAAKd,oBAAN,CAAzB,EACA;CACCX,MAAAA,EAAE,CAAC0B,IAAH,CAAQC,kBAAR,CACC,oCADD,EAEC,QAFD,EAGC;CACCC,QAAAA,IAAI,EAAE;CAACvB,UAAAA,EAAE,EAAE,KAAKA,EAAV;CAAcC,UAAAA,IAAI,EAAE,KAAKA;CAAzB;CADP,OAHD,EAMEuB,IANF,CAOC,YAAW;CACVN,QAAAA,YAAY,CAACO,SAAb,CAAuBC,MAAvB,CAA8B,aAA9B;CACA/B,QAAAA,EAAE,CAACgC,SAAH,CAAaC,QAAb,CAAsBC,KAAtB;CACA,OAHD,CAGEnB,IAHF,CAGO,IAHP,CAPD,EAWC,UAAUoB,MAAV,EAAkB;CACjBZ,QAAAA,YAAY,CAACO,SAAb,CAAuBC,MAAvB,CAA8B,aAA9B;CAEA,aAAKK,SAAL,CAAeD,MAAM,CAACE,MAAtB;CACA,OAJD,CAIEtB,IAJF,CAIO,IAJP,CAXD;CAiBA,KAnBD,MAqBA;CACCuB,MAAAA,UAAU,CAAC;CAAA,eAAMtC,EAAE,CAACmB,WAAH,CAAeI,YAAf,EAA6B,aAA7B,CAAN;CAAA,OAAD,EAAoD,GAApD,CAAV;CACA;CACD,GA9BD;;CA+BAtB,EAAAA,MAAM,CAACC,SAAP,CAAiBe,QAAjB,GAA4B,UAAUI,KAAV,EAC5B;CAAA;;CACC,QAAIkB,QAAQ,GAAG,EAAf;CACA,QAAIC,QAAQ,GAAG,IAAIC,QAAJ,CAAa,KAAKlC,IAAlB,CAAf;;CAFD,+CAGiBiC,QAAQ,CAACE,OAAT,EAHjB;CAAA;;CAAA;CAGC,0DACA;CAAA,YADQC,IACR;CACCJ,QAAAA,QAAQ,CAACI,IAAI,CAAC,CAAD,CAAL,CAAR,GAAoBA,IAAI,CAAC,CAAD,CAAxB;CACA;CANF;CAAA;CAAA;CAAA;CAAA;;CAQC,SAAKlC,UAAL,CAAgBqB,SAAhB,CAA0Bc,GAA1B,CAA8B,aAA9B;;CAEA,QAAIC,eAAe,GAAG,SAAlBA,eAAkB,GAAM;CAAC,MAAA,KAAI,CAACpC,UAAL,CAAgBqB,SAAhB,CAA0BC,MAA1B,CAAiC,aAAjC;CAAiD,KAA9E;;CAEA,QAAIe,MAAM,GAAGN,QAAQ,CAACO,GAAT,CAAa,IAAb,IAAqB,QAArB,GAAgC,SAA7C;CAEA/C,IAAAA,EAAE,CAAC0B,IAAH,CAAQC,kBAAR,CACC,oCADD,EAECmB,MAFD,EAGC;CACCE,MAAAA,IAAI,EAAET;CADP,KAHD,EAMEV,IANF,CAMO,UAACoB,QAAD,EACP;CACCJ,MAAAA,eAAe;CACf7C,MAAAA,EAAE,CAACgC,SAAH,CAAaC,QAAb,CAAsBC,KAAtB;CACA,KAVD,EAUGgB,KAVH,CAUS,UAACf,MAAD,EAAY;CACpBU,MAAAA,eAAe;;CACf,MAAA,KAAI,CAACT,SAAL,CAAeD,MAAM,CAACE,MAAtB;CACA,KAbD;CAeAhB,IAAAA,KAAK,CAACC,cAAN;CACA,GA/BD;;CAgCArB,EAAAA,MAAM,CAACC,SAAP,CAAiBkC,SAAjB,GAA6B,UAAUC,MAAV,EAC7B;CACC,QAAIc,IAAI,GAAG,EAAX;CAEAd,IAAAA,MAAM,CAACe,OAAP,CAAe,UAAUC,KAAV,EAAiB;CAC/BF,MAAAA,IAAI,IAAIE,KAAK,CAACC,OAAN,GAAgB,MAAxB;CACA,KAFD;;CAIA,QAAG,KAAK1C,gBAAL,IAAyBuC,IAA5B,EACA;CACC,WAAKvC,gBAAL,CAAsB2C,UAAtB,CAAiCC,KAAjC,CAAuCC,OAAvC,GAAiD,OAAjD;CACA,WAAK7C,gBAAL,CAAsB8C,SAAtB,GAAkCP,IAAlC;CACA;CACD,GAbD;;CAeApD,EAAAA,SAAS,CAACE,MAAV,GAAmB,IAAIA,MAAJ,EAAnB;CACA,CAtHA;;;;"}