{"version":3,"file":"script.js","sources":["src/popup.js","src/timeman.js","src/index.js"],"sourcesContent":["import {Type, Event, Loc} from 'main.core';\n\nexport class Popup\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.signedParameters = this.parent.signedParameters;\n\t\tthis.componentName = this.parent.componentName;\n\t\tthis.userInnerBlockNode = this.parent.userInnerBlockNode || \"\";\n\t\tthis.circleNode = this.parent.circleNode || \"\";\n\t\tthis.isPopupShown = false;\n\t\tthis.popupCurrentPage = {};\n\t\tthis.renderedUsers = [];\n\n\t\tEvent.bind(this.userInnerBlockNode, 'click', () => {\n\t\t\tthis.showPopup('getAllOnlineUser', this.userInnerBlockNode);\n\t\t});\n\n\t\tEvent.bind(this.circleNode, 'click', () => {\n\t\t\tthis.showPopup('getAllOnlineUser', this.circleNode, -5);\n\t\t});\n\n\t\tif (this.parent.isTimemanAvailable && Type.isDomNode(this.parent.timemanNode))\n\t\t{\n\t\t\tlet openedNode = this.parent.timemanNode.querySelector('.js-ustat-online-timeman-opened-block');\n\t\t\tlet closedNode = this.parent.timemanNode.querySelector('.js-ustat-online-timeman-closed-block');\n\n\t\t\tEvent.bind(openedNode, 'click', () => {\n\t\t\t\tthis.showPopup('getOpenedTimemanUser', openedNode);\n\t\t\t});\n\n\t\t\tEvent.bind(closedNode, 'click', () => {\n\t\t\t\tthis.showPopup('getClosedTimemanUser', closedNode);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetPopupTitle(action)\n\t{\n\t\tlet title = \"\";\n\t\tif (action === \"getAllOnlineUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_USERS\");\n\t\t}\n\t\telse if (action === \"getOpenedTimemanUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_STARTED_DAY\");\n\t\t}\n\t\telse if (action === \"getClosedTimemanUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_FINISHED_DAY\");\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tshowPopup(action, bindNode, topOffset)\n\t{\n\t\tif (this.isPopupShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isUndefined(topOffset))\n\t\t{\n\t\t\ttopOffset = 7;\n\t\t}\n\n\t\tthis.popupCurrentPage[action] = 1;\n\t\tthis.popupInnerContainer = \"\";\n\t\tthis.renderedUsers = [];\n\n\t\tthis.allOnlineUserPopup = new BX.PopupWindow('intranet-ustat-online-popup', bindNode, {\n\t\t\tlightShadow : true,\n\t\t\toffsetLeft: action === 'getClosedTimemanUser' ? -60 : -22,\n\t\t\toffsetTop: topOffset,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tbindOptions: {\n\t\t\t\tposition: 'bottom'\n\t\t\t},\n\t\t\tanimationOptions: {\n\t\t\t\tshow: {\n\t\t\t\t\ttype: 'opacity-transform'\n\t\t\t\t},\n\t\t\t\tclose: {\n\t\t\t\t\ttype: 'opacity'\n\t\t\t\t}\n\t\t\t},\n\t\t\tevents : {\n\t\t\t\tonPopupDestroy : function() {\n\t\t\t\t\tthis.isPopupShown = false;\n\t\t\t\t}.bind(this),\n\t\t\t\tonPopupClose: function() {\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t\tonAfterPopupShow: function(popup)\n\t\t\t\t{\n\t\t\t\t\tlet popupContent = popup.contentContainer;\n\n\t\t\t\t\tlet popupContainer = BX.create('div', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'intranet-ustat-online-popup-container'\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tlet popupTitle = BX.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'intranet-ustat-online-popup-name-title'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: this.getPopupTitle(action)\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.popupInnerContainer = BX.create('div', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'intranet-ustat-online-popup-inner'\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tlet popupInnerContent = BX.create('div', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'intranet-ustat-online-popup-content'\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tlet popupInnerContentBox = BX.create('div', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'intranet-ustat-online-popup-content-box'\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tpopupContent.appendChild(popupTitle);\n\t\t\t\t\tpopupContent.appendChild(popupContainer);\n\t\t\t\t\tpopupContainer.appendChild(popupInnerContent);\n\t\t\t\t\tpopupInnerContent.appendChild(popupInnerContentBox);\n\t\t\t\t\tpopupInnerContentBox.appendChild(this.popupInnerContainer);\n\n\t\t\t\t\tthis.loader = this.showLoader({node: popupInnerContent, loader: null, size: 40});\n\t\t\t\t\tthis.showUsersInPopup(action);\n\n\t\t\t\t\tthis.isPopupShown = true;\n\n\t\t\t\t}.bind(this)\n\t\t\t},\n\t\t\tclassName: 'intranet-ustat-online-popup'\n\t\t});\n\n\t\t/*BX.bind(BX('intranet-ustat-online-popup'), 'mouseout' , BX.delegate(function() {\n\t\t\tclearTimeout(this.popupTimeout);\n\t\t\tthis.popupTimeout = setTimeout(BX.delegate(function() {\n\t\t\t\tthis.allOnlineUserPopup.close();\n\t\t\t}, this), 1000);\n\t\t}, this));\n\n\t\tBX.bind(BX('intranet-ustat-online-popup'), 'mouseover' , BX.delegate(function() {\n\t\t\tclearTimeout(this.popupTimeout);\n\t\t\tclearTimeout(this.mouseLeaveTimeoutId);\n\t\t}, this));\n\n\t\tBX.bind(this.userInnerBlockNode, 'mouseleave' , BX.delegate(function() {\n\t\t\tthis.mouseLeaveTimeoutId = setTimeout(BX.delegate(function() {\n\t\t\t\tthis.allOnlineUserPopup.close();\n\t\t\t}, this), 1000);\n\t\t}, this));*/\n\n\t\tthis.popupScroll(action);\n\n\t\tthis.allOnlineUserPopup.show();\n\t}\n\n\tpopupScroll(action)\n\t{\n\t\tif (!BX.type.isDomNode(this.popupInnerContainer))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.bind(this.popupInnerContainer, 'scroll', BX.delegate(function() {\n\t\t\tvar _this = BX.proxy_context;\n\t\t\tif (_this.scrollTop > (_this.scrollHeight - _this.offsetHeight) / 1.5)\n\t\t\t{\n\t\t\t\tthis.showUsersInPopup(action);\n\t\t\t\tBX.unbindAll(_this);\n\t\t\t}\n\t\t}, this));\n\t};\n\n\tshowUsersInPopup(action)\n\t{\n\t\tif (\n\t\t\taction !== 'getAllOnlineUser'\n\t\t\t&& action !== 'getOpenedTimemanUser'\n\t\t\t&& action !== 'getClosedTimemanUser'\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runComponentAction(this.componentName, action, {\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tpageNum: this.popupCurrentPage[action]\n\t\t\t}\n\t\t}).then(function (response) {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tthis.renderPopupUsers(response.data);\n\t\t\t\tthis.popupCurrentPage[action]++;\n\t\t\t\tthis.popupScroll(action);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!this.popupInnerContainer.hasChildNodes())\n\t\t\t\t{\n\t\t\t\t\tthis.popupInnerContainer.innerText = Loc.getMessage('INTRANET_USTAT_ONLINE_EMPTY');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.hideLoader({loader: this.loader});\n\t\t}.bind(this), function (response) {\n\t\t\tthis.hideLoader({loader: this.loader});\n\t\t}.bind(this));\n\t}\n\n\trenderPopupUsers(users)\n\t{\n\t\tif (!this.allOnlineUserPopup || !BX.type.isDomNode(this.popupInnerContainer))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!users || typeof users !== \"object\")\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (var i in users)\n\t\t{\n\t\t\tif (!users.hasOwnProperty(i))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (this.renderedUsers.indexOf(users[i]['ID']) >= 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tthis.renderedUsers.push(users[i]['ID']);\n\n\t\t\tlet avatarNode;\n\n\t\t\tif (BX.type.isNotEmptyString(users[i]['AVATAR']))\n\t\t\t{\n\t\t\t\tavatarNode = BX.create(\"div\", {\n\t\t\t\t\tprops: {className: \"ui-icon ui-icon-common-user intranet-ustat-online-popup-avatar-img\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create('i', {\n\t\t\t\t\t\t\tstyle : { backgroundImage : \"url('\" + users[i]['AVATAR'] + \"')\"}\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tavatarNode = BX.create(\"div\", {\n\t\t\t\t\tprops: {className: \"ui-icon ui-icon-common-user intranet-ustat-online-popup-avatar-img\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create('i', {})\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.popupInnerContainer.appendChild(\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: users[i]['PATH_TO_USER_PROFILE'],\n\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: \"intranet-ustat-online-popup-item\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: \"intranet-ustat-online-popup-avatar-new\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tavatarNode,\n\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\tprops: {className: \"intranet-ustat-online-popup-avatar-status-icon\"}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: \"intranet-ustat-online-popup-name\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: users[i]['NAME']\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t}\n\n\tshowLoader(params)\n\t{\n\t\tvar loader = null;\n\n\t\tif (params.node)\n\t\t{\n\t\t\tif (params.loader === null)\n\t\t\t{\n\t\t\t\tloader = new BX.Loader({\n\t\t\t\t\ttarget: params.node,\n\t\t\t\t\tsize: params.hasOwnProperty(\"size\") ? params.size : 40\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tloader = params.loader;\n\t\t\t}\n\n\t\t\tloader.show();\n\t\t}\n\n\t\treturn loader;\n\t}\n\n\thideLoader(params)\n\t{\n\t\tif (params.loader !== null)\n\t\t{\n\t\t\tparams.loader.hide();\n\t\t}\n\n\t\tif (params.node)\n\t\t{\n\t\t\tBX.cleanNode(params.node);\n\t\t}\n\n\t\tif (params.loader !== null)\n\t\t{\n\t\t\tparams.loader = null;\n\t\t}\n\t}\n}","import {Type, Dom} from 'main.core';\nimport {PULL} from \"pull.client\";\n\nexport class Timeman\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.signedParameters = this.parent.signedParameters;\n\t\tthis.componentName = this.parent.componentName;\n\t\tthis.isTimemanAvailable = this.parent.isTimemanAvailable;\n\t\tthis.timemanNode = this.parent.timemanNode;\n\n\t\tif (this.isTimemanAvailable && Type.isDomNode(this.timemanNode))\n\t\t{\n\t\t\tthis.timemanValueNodes = this.timemanNode.querySelectorAll('.intranet-ustat-online-value');\n\t\t\tthis.timemanTextNodes =  this.timemanNode.querySelectorAll('.js-ustat-online-timeman-text');\n\n\t\t\tthis.resizeTimemanText();\n\t\t\tthis.subscribePullEvent();\n\t\t}\n\t}\n\n\tresizeTimemanText()\n\t{\n\t\tif (!Type.isDomNode(this.timemanNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet textSum = 0;\n\t\tlet valueSum = 0;\n\n\t\tif (Type.isArrayLike(this.timemanTextNodes))\n\t\t{\n\t\t\tfor (let text of this.timemanTextNodes)\n\t\t\t{\n\t\t\t\tlet textItems = text.textContent.length;\n\t\t\t\ttextSum += textItems;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isArrayLike(this.timemanValueNodes))\n\t\t{\n\t\t\tfor (let value of this.timemanValueNodes)\n\t\t\t{\n\t\t\t\tlet valueItems = value.textContent.length;\n\t\t\t\tvalueSum += valueItems;\n\t\t\t}\n\t\t}\n\n\t\tif (textSum >= 17 && valueSum >= 6 || textSum >= 19 && valueSum >= 4)\n\t\t{\n\t\t\tDom.addClass(this.timemanNode, 'intranet-ustat-online-info-text-resize');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.timemanNode, 'intranet-ustat-online-info-text-resize');\n\t\t}\n\t}\n\n\tredrawTimeman(data)\n\t{\n\t\tif (data.hasOwnProperty(\"OPENED\"))\n\t\t{\n\t\t\tlet openedNode = document.querySelector('.js-ustat-online-timeman-opened');\n\t\t\tif (BX.type.isDomNode(openedNode))\n\t\t\t{\n\t\t\t\topenedNode.innerHTML = data[\"OPENED\"];\n\t\t\t}\n\t\t}\n\n\t\tif (data.hasOwnProperty(\"CLOSED\"))\n\t\t{\n\t\t\tlet closedNode = document.querySelector('.js-ustat-online-timeman-closed');\n\t\t\tif (BX.type.isDomNode(closedNode))\n\t\t\t{\n\t\t\t\tclosedNode.innerHTML = data[\"CLOSED\"];\n\t\t\t}\n\t\t}\n\n\t\tthis.resizeTimemanText();\n\t}\n\n\tcheckTimeman()\n\t{\n\t\tBX.ajax.runComponentAction(this.componentName, \"checkTimeman\", {\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tmode: 'class'\n\t\t}).then(function (response) {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tthis.redrawTimeman(response.data);\n\t\t\t}\n\t\t}.bind(this), function (response) {\n\n\t\t}.bind(this));\n\t}\n\n\tsubscribePullEvent()\n\t{\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'intranet',\n\t\t\tcommand: 'timemanDayInfo',\n\t\t\tcallback: (data) =>\n\t\t\t{\n\t\t\t\tthis.redrawTimeman(data);\n\t\t\t}\n\t\t});\n\t}\n}","import {Type, Dom, Reflection, Event} from 'main.core';\nimport {rest} from \"rest.client\";\nimport \"pull.client\";\nimport {Popup} from './popup';\nimport {Timeman} from './timeman';\nimport {Circle} from 'ui.graph.circle';\n\nconst namespace = Reflection.namespace('BX.Intranet');\n\nclass UstatOnline\n{\n\tconstructor(params)\n\t{\n\t\tthis.signedParameters = params.signedParameters;\n\t\tthis.componentName = params.componentName;\n\t\tthis.userBlockNode = params.userBlockNode || \"\";\n\t\tthis.userInnerBlockNode = params.userInnerBlockNode || \"\";\n\t\tthis.circleNode = params.circleNode || \"\";\n\t\tthis.timemanNode = params.timemanNode || \"\";\n\t\tthis.ustatOnlineContainerNode = params.ustatOnlineContainerNode || \"\";\n\t\tthis.maxUserToShow = 7;\n\t\tthis.maxOnlineUserCountToday = params.maxOnlineUserCountToday;\n\t\tthis.currentUserId = parseInt(params.currentUserId);\n\t\tthis.isTimemanAvailable = params.isTimemanAvailable === \"Y\";\n\t\tthis.isFullAnimationMode = params.isFullAnimationMode === \"Y\";\n\t\tthis.limitOnlineSeconds = params.limitOnlineSeconds;\n\t\tthis.renderingFinished = true;\n\n\t\tlet users = params.users;\n\t\tlet allOnlineUserIdToday = params.allOnlineUserIdToday;\n\n\t\tthis.users = users.map(user => {\n\t\t\tuser.id = parseInt(user.id);\n\t\t\tuser.offline_date = this.getOfflineDate(user.last_activity_date);\n\t\t\treturn user;\n\t\t});\n\n\t\tthis.allOnlineUserIdToday = allOnlineUserIdToday.map(id => {\n\t\t\treturn parseInt(id);\n\t\t});\n\n\t\tthis.online = [].concat(this.users);\n\n\t\tthis.counter = 0;\n\n\t\t//-------------- for IndexedDb\n\t\tthis.ITEMS = {\n\t\t\tobClientDb: null,\n\t\t\tobClientDbData: {},\n\t\t\tobClientDbDataSearchIndex: {},\n\t\t\tbMenuInitialized: false,\n\t\t\tinitialized: {\n\t\t\t\tsonetgroups: false,\n\t\t\t\tmenuitems: false\n\t\t\t},\n\t\t\toDbSearchResult: {}\n\t\t};\n\n\t\tBX.Finder(false, 'searchTitle', [], {}, this);\n\t\tBX.onCustomEvent(this, 'initFinderDb', [ this.ITEMS, 'searchTitle', null, ['users'], this ]);\n\t\t//---------------\n\n\t\tif (Type.isDomNode(this.ustatOnlineContainerNode))\n\t\t{\n\t\t\tBX.UI.Hint.init(this.ustatOnlineContainerNode);\n\t\t}\n\n\t\tnew Popup(this);\n\t\tthis.timemanObj = new Timeman(this);\n\n\t\tlet now = new Date();\n\t\tthis.currentDate = new Date(now.getFullYear(), now.getMonth(), now.getDate()).valueOf();\n\n\t\tthis.checkOnline();\n\n\t\tif (this.isFullAnimationMode)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.subscribePullEvent();\n\t\t\t}, 3000);\n\n\t\t\tsetInterval(() => this.checkOnline(), 60000);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addCustomEvent(window, \"onImUpdateUstatOnline\", BX.proxy(this.updateOnlineRestrictedMode, this));\n\t\t}\n\t}\n\n\tupdateOnlineRestrictedMode(data)\n\t{\n\t\tthis.counter = data.count;\n\t\tthis.maxOnlineUserCountToday = data.count;\n\t\tthis.online = data.users;\n\t\tthis.redrawOnline();\n\t}\n\n\tgetOfflineDate(date)\n\t{\n\t\treturn date? new Date(date).getTime() + parseInt(this.limitOnlineSeconds)*1000: null;\n\t}\n\n\tcheckOnline()\n\t{\n\t\tthis.online = this.online.filter(user => {\n\t\t\treturn (user && (user.offline_date > +new Date() || user.id === this.currentUserId));\n\t\t});\n\n\t\tlet prevCounter = this.counter;\n\n\t\tif (this.online.length > 0)\n\t\t{\n\t\t\tthis.counter = this.online.map(el => 1).reduce(count => count + 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.counter = 0;\n\t\t}\n\n\t\tif (this.checkNewDay() || prevCounter !== this.counter)\n\t\t{\n\t\t\tthis.redrawOnline();\n\t\t}\n\t}\n\n\tcheckNewDay()\n\t{\n\t\tlet now = new Date();\n\t\tlet today = new Date(now.getFullYear(), now.getMonth(), now.getDate()).valueOf();\n\n\t\tif (this.currentDate < today) //new day\n\t\t{\n\t\t\tthis.maxOnlineUserCountToday = this.online.length;\n\n\t\t\tif (this.isTimemanAvailable)\n\t\t\t{\n\t\t\t\tthis.timemanObj.checkTimeman();\n\t\t\t}\n\n\t\t\tthis.currentDate = today;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetUserOnline(params)\n\t{\n\t\tlet userId = this.getNumberUserId(params.id);\n\n\t\tthis.findUser(userId).then(user => {\n\t\t\tuser.id = this.getNumberUserId(user.id);\n\n\t\t\tif (typeof params.last_activity_date !== \"undefined\")\n\t\t\t{\n\t\t\t\tuser.last_activity_date = params.last_activity_date;\n\t\t\t}\n\n\t\t\tif (user.isExtranet !== \"Y\")\n\t\t\t{\n\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\tthis.checkOnline();\n\t\t\t}\n\t\t}).catch(error => {});\n\t}\n\n\tsetUserToLocal(user)\n\t{\n\t\tuser.offline_date = this.getOfflineDate(user.last_activity_date);\n\n\t\tthis.users = this.users.filter(element => element.id !== user.id);\n\t\tthis.users.push(user);\n\n\t\tlet isUserOnline = false;\n\t\tthis.online.forEach((element) => {\n\t\t\tif (element.id === user.id)\n\t\t\t{\n\t\t\t\tisUserOnline = true;\n\t\t\t}\n\t\t});\n\t\tif (!isUserOnline)\n\t\t{\n\t\t\tthis.online.unshift(user);\n\t\t}\n\n\t\tif (this.allOnlineUserIdToday.indexOf(user.id) === -1)\n\t\t{\n\t\t\tthis.allOnlineUserIdToday.push(user.id);\n\t\t\tthis.maxOnlineUserCountToday++;\n\t\t}\n\t}\n\n\tsetUserOnlineMultiply(list)\n\t{\n\t\tlet requestUserList = [];\n\t\tlet counterFindUser = 0;\n\t\tlet promises = [];\n\n\t\tlist.forEach(user => {\n\n\t\t\tlet userId = parseInt(user.id);\n\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\tthis.findUser(userId, true).then(user => {\n\t\t\t\t\tcounterFindUser++;\n\t\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch(error => {\n\t\t\t\t\trequestUserList.push(userId);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t}));\n\t\t});\n\n\t\tPromise.all(promises).then(() => {\n\t\t\tif (requestUserList.length <= 0)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet requestCount = this.maxUserToShow-counterFindUser;\n\t\t\tif (requestCount <= 0)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\trequestUserList = requestUserList.slice(0, requestCount);\n\n\t\t\tBX.rest.callMethod('im.user.list.get', {ID: requestUserList}).then(result => {\n\t\t\t\tlet collection = result.data();\n\t\t\t\tif (!collection)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tfor (let userId in collection)\n\t\t\t\t{\n\t\t\t\t\tif (!collection.hasOwnProperty(userId))\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet userData = collection[userId];\n\t\t\t\t\tif (!userData)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet user = {};\n\t\t\t\t\tuser.id = parseInt(userData.id);\n\t\t\t\t\tuser.name = userData.name;\n\t\t\t\t\tuser.avatar = BX.MessengerCommon.isBlankAvatar(userData.avatar)? '': userData.avatar;\n\t\t\t\t\tuser.last_activity_date = userData.last_activity_date;\n\n\t\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\t}\n\t\t\t}).catch(error => {});\n\t\t});\n\t}\n\n\tfindUser(userId, skipRest = false)\n\t{\n\t\tuserId = parseInt(userId);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tlet user = null;\n\n\t\t\tuser = this.users.find(element => element.id === userId);\n\t\t\tif (user)\n\t\t\t{\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tuser = this.getUserFromMessenger(userId);\n\t\t\tif (user)\n\t\t\t{\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.getUserFromDb(userId).then(user => {\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}).catch(error => {\n\n\t\t\t\tif (skipRest)\n\t\t\t\t{\n\t\t\t\t\treject(null);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tthis.getUserFromServer(userId).then(user => {\n\t\t\t\t\tthis.addUserToDb(user);\n\t\t\t\t\tresolve(user);\n\t\t\t\t}).catch(error => {\n\t\t\t\t\treject(null);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tgetUserFromMessenger(userId)\n\t{\n\t\tif (typeof window.BX.MessengerCommon === 'undefined')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet result = BX.MessengerCommon.getUser(userId);\n\t\tif (!result)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet user = {\n\t\t\tid: parseInt(result.id),\n\t\t\tname: result.name,\n\t\t\tavatar: BX.MessengerCommon.isBlankAvatar(result.avatar)? '': result.avatar,\n\t\t\tlast_activity_date: null,\n\t\t};\n\n\t\tif (result.last_activity_date instanceof Date)\n\t\t{\n\t\t\tuser.last_activity_date = result.last_activity_date.toISOString()\n\t\t}\n\t\tif (typeof result.last_activity_date === 'string')\n\t\t{\n\t\t\tuser.last_activity_date = result.last_activity_date\n\t\t}\n\n\t\treturn user;\n\t}\n\n\tgetUserFromDb(userId)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tBX.indexedDB.getValue(this.ITEMS.obClientDb, \"users\", \"U\" + userId).then((user) => {\n\t\t\t\tif (user && typeof user === 'object')\n\t\t\t\t{\n\t\t\t\t\tif (user.hasOwnProperty(\"entityId\"))\n\t\t\t\t\t{\n\t\t\t\t\t\tuser.id = this.getNumberUserId(user.entityId);\n\t\t\t\t\t}\n\t\t\t\t\tresolve(user);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresolve(null);\n\t\t\t\t}\n\t\t\t}).catch(error => {\n\t\t\t\treject(null);\n\t\t\t});\n\t\t});\n\t}\n\n\taddUserToDb(user)\n\t{\n\t\tuser.id = \"U\" + user.id;\n\t\tBX.indexedDB.addValue(this.ITEMS.obClientDb, 'users', user);\n\t}\n\n\tgetUserFromServer(userId)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (typeof window.BX.MessengerCommon === 'undefined')\n\t\t\t{\n\t\t\t\tresolve(null);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\trest.callMethod('im.user.get', {id: userId}).then(result => {\n\t\t\t\tif (result.data() && result.data().external_auth_id !== \"__controller\")\n\t\t\t\t{\n\t\t\t\t\tlet user = {};\n\t\t\t\t\tuser.id = parseInt(result.data().id);\n\t\t\t\t\tuser.name = result.data().name;\n\t\t\t\t\tuser.avatar = BX.MessengerCommon.isBlankAvatar(result.data().avatar)? '': result.data().avatar;\n\t\t\t\t\tuser.last_activity_date = result.data().last_activity_date;\n\t\t\t\t\tuser.isExtranet = result.data().extranet ? \"Y\" : \"N\";\n\t\t\t\t\tuser.active = \"Y\";\n\t\t\t\t\tuser.entityId = parseInt(result.data().id);\n\n\t\t\t\t\tresolve(user);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresolve(null);\n\t\t\t\t}\n\t\t\t}).catch(error => {\n\t\t\t\tresolve(null);\n\t\t\t});\n\t\t});\n\t}\n\n\tsubscribePullEvent()\n\t{\n\t\tBX.PULL.subscribe({\n\t\t\ttype: 'online',\n\t\t\tcallback: (data) =>\n\t\t\t{\n\t\t\t\tif (data.command === 'userStatus')\n\t\t\t\t{\n\t\t\t\t\tfor (let userId in data.params.users)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!data.params.users.hasOwnProperty(userId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.setUserOnline(data.params.users[userId]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/*else if (data.command === 'list')\n\t\t\t\t{\n\t\t\t\t\tlet list = [];\n\n\t\t\t\t\tfor (let userId in data.params.users)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (data.params.users.hasOwnProperty(userId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlist.push({\n\t\t\t\t\t\t\t\tid: data.params.users[userId].id,\n\t\t\t\t\t\t\t\tlast_activity_date: data.params.users[userId].last_activity_date\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setUserOnlineMultiply(list);\n\t\t\t\t}*/\n\t\t\t}\n\t\t});\n\t}\n\n\tgetNumberUserId(id)\n\t{\n\t\tif (!id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet userId = String(id);\n\t\tuserId = userId.replace('U', '');\n\t\treturn parseInt(userId);\n\t}\n\n\tisDocumentVisible()\n\t{\n\t\treturn document.visibilityState === 'visible';\n\t}\n\n\tredrawOnline()\n\t{\n\t\tthis.showCircleAnimation(this.circleNode, this.counter, this.maxOnlineUserCountToday);\n\t\tif (this.renderingFinished)\n\t\t{\n\t\t\tthis.renderingFinished = false;\n\t\t\tthis.renderAllUser();\n\t\t}\n\t}\n\n\trenderAllUser()\n\t{\n\t\tlet renderedUserIds = [];\n\t\tlet newUserIds = [];\n\n\t\tthis.online.forEach((item) => {\n\t\t\tnewUserIds.push(parseInt(item.id));\n\t\t});\n\n\t\tconst onlineToShow = newUserIds.slice(0, this.maxUserToShow);\n\n\t\tlet renderedUserNodes = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\n\t\tif (this.online.length > 100 && renderedUserNodes >= this.maxUserToShow)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (renderedUserNodes)\n\t\t{\n\t\t\tfor (let item in renderedUserNodes)\n\t\t\t{\n\t\t\t\tif (!renderedUserNodes.hasOwnProperty(item))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet renderedItemId = parseInt(renderedUserNodes[item].getAttribute(\"data-user-id\"));\n\n\t\t\t\tif (newUserIds.indexOf(renderedItemId) === -1)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isDomNode(renderedUserNodes[item]))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.remove(renderedUserNodes[item]); //remove offline avatars\n\t\t\t\t\t\t/*renderedUserNodes[item].classList.add('intranet-ustat-online-icon-hide');\n\t\t\t\t\t\tsetTimeout( () => {\n\n\t\t\t\t\t\t}, 800);*/\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\trenderedUserIds.push(parseInt(renderedItemId));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\trenderedUserNodes = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\n\t\tlet renderedUserCount = renderedUserNodes.length;\n\t\tconst showAnimation = renderedUserCount !== 0;\n\t\tthis.userIndex = this.online.length;\n\n\t\tlet stepRender = (i) => {\n\t\t\tif (i >= this.maxUserToShow || i >= this.online.length)\n\t\t\t{\n\t\t\t\tthis.renderingFinished = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnew Promise((resolve) => {\n\t\t\t\tlet item = this.online[i];\n\n\t\t\t\tif (renderedUserIds.indexOf(item.id) >= 0)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (renderedUserCount < this.maxUserToShow)\n\t\t\t\t{\n\t\t\t\t\tif (showAnimation)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userIndex++;\n\t\t\t\t\t}\n\t\t\t\t\tthis.renderUser(item, showAnimation);\n\t\t\t\t\trenderedUserIds.push(item.id);\n\t\t\t\t\trenderedUserCount++;\n\t\t\t\t\tif (!showAnimation)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userIndex = this.userIndex - 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst elements = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\t\t\t\t\tconst firstElement = elements[0];\n\t\t\t\t\tlet lastElement = \"\";\n\n\t\t\t\t\tfor (let i = elements.length - 1; i >= 0; i--)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Type.isDomNode(elements[i]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst elementUserId = parseInt(elements[i].getAttribute(\"data-user-id\"));\n\t\t\t\t\t\t\tif (onlineToShow.indexOf(elementUserId) === -1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlastElement = elements[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isDomNode(lastElement))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst removedUserId = parseInt(lastElement.getAttribute(\"data-user-id\"));\n\n\t\t\t\t\t\tDom.removeClass(lastElement, 'intranet-ustat-online-icon-show');\n\t\t\t\t\t\tif (this.isDocumentVisible())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.addClass(lastElement, 'intranet-ustat-online-icon-hide');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.userIndex = parseInt(firstElement.style.zIndex);\n\t\t\t\t\t\tthis.userIndex++;\n\n\t\t\t\t\t\tthis.renderUser(item, showAnimation);\n\t\t\t\t\t\trenderedUserIds = renderedUserIds.filter(id => id !== removedUserId);\n\t\t\t\t\t\trenderedUserIds.push(item.id);\n\n\t\t\t\t\t\tif (this.isDocumentVisible())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tEvent.bind(lastElement, 'animationend', (event) => {\n\t\t\t\t\t\t\t\tDom.remove(lastElement);\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.remove(lastElement);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).then(() => {\n\t\t\t\tstepRender(++i);\n\t\t\t});\n\t\t};\n\n\t\tstepRender(0);\n\t}\n\n\trenderUser(user, showAnimation)\n\t{\n\t\tif (!user || typeof user !== 'object')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet userStyle = \"\";\n\t\tif (user.avatar)\n\t\t{\n\t\t\tuserStyle = 'background-image: url(\"' + user.avatar + '\");';\n\t\t}\n\n\t\tconst userId = this.getNumberUserId(user.id);\n\n\t\tlet itemsClasses = `ui-icon ui-icon-common-user intranet-ustat-online-icon js-ustat-online-user\n\t\t\t${showAnimation && this.isDocumentVisible() ? ' intranet-ustat-online-icon-show' : ''}`;\n\n\t\tthis.userItem = BX.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: itemsClasses,\n\t\t\t\t\"data-user-id\" : userId\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\tzIndex: this.userIndex\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tBX.create('i', {\n\t\t\t\t\tattrs: { style: userStyle}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (showAnimation)\n\t\t{\n\t\t\tDom.prepend(this.userItem, this.userInnerBlockNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.userInnerBlockNode.appendChild(this.userItem);\n\t\t}\n\t}\n\n\tshowCircleAnimation(circleNode, currentUserOnlineCount, maxUserOnlineCount)\n\t{\n\t\tmaxUserOnlineCount = parseInt(maxUserOnlineCount);\n\t\tcurrentUserOnlineCount = parseInt(currentUserOnlineCount);\n\n\t\tif (currentUserOnlineCount <= 0)\n\t\t{\n\t\t\tcurrentUserOnlineCount = 1;\n\t\t}\n\n\t\tif (currentUserOnlineCount > maxUserOnlineCount)\n\t\t{\n\t\t\tmaxUserOnlineCount = currentUserOnlineCount;\n\t\t}\n\n\t\tlet progressPercent = (currentUserOnlineCount*100)/maxUserOnlineCount;\n\n\t\tif (!this.circle)\n\t\t{\n\t\t\tthis.circle = new Circle(\n\t\t\t\tcircleNode,\n\t\t\t\t42,\n\t\t\t\tprogressPercent,\n\t\t\t\t{\n\t\t\t\t\tfixCounter: currentUserOnlineCount,\n\t\t\t\t\tcolor1:'rgba(49,205,255,.41)',\n\t\t\t\t\tcolor2: 'rgba(85, 208, 224,.32)'\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis.circle.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.circle.updateCounter(progressPercent, currentUserOnlineCount);\n\t\t}\n\t}\n}\n\nnamespace.UstatOnline = UstatOnline;\n"],"names":["Popup","parent","signedParameters","componentName","userInnerBlockNode","circleNode","isPopupShown","popupCurrentPage","renderedUsers","Event","bind","showPopup","isTimemanAvailable","Type","isDomNode","timemanNode","openedNode","querySelector","closedNode","action","title","Loc","getMessage","bindNode","topOffset","isUndefined","popupInnerContainer","allOnlineUserPopup","BX","PopupWindow","lightShadow","offsetLeft","offsetTop","autoHide","closeByEsc","bindOptions","position","animationOptions","show","type","close","events","onPopupDestroy","onPopupClose","destroy","onAfterPopupShow","popup","popupContent","contentContainer","popupContainer","create","props","className","popupTitle","text","getPopupTitle","popupInnerContent","popupInnerContentBox","appendChild","loader","showLoader","node","size","showUsersInPopup","popupScroll","delegate","_this","proxy_context","scrollTop","scrollHeight","offsetHeight","unbindAll","ajax","runComponentAction","mode","data","pageNum","then","response","renderPopupUsers","hasChildNodes","innerText","hideLoader","users","i","hasOwnProperty","indexOf","push","avatarNode","isNotEmptyString","children","style","backgroundImage","attrs","href","target","html","params","Loader","hide","cleanNode","Timeman","timemanValueNodes","querySelectorAll","timemanTextNodes","resizeTimemanText","subscribePullEvent","textSum","valueSum","isArrayLike","textItems","textContent","length","value","valueItems","Dom","addClass","removeClass","document","innerHTML","redrawTimeman","PULL","subscribe","moduleId","command","callback","namespace","Reflection","UstatOnline","userBlockNode","ustatOnlineContainerNode","maxUserToShow","maxOnlineUserCountToday","currentUserId","parseInt","isFullAnimationMode","limitOnlineSeconds","renderingFinished","allOnlineUserIdToday","map","user","id","offline_date","getOfflineDate","last_activity_date","online","concat","counter","ITEMS","obClientDb","obClientDbData","obClientDbDataSearchIndex","bMenuInitialized","initialized","sonetgroups","menuitems","oDbSearchResult","Finder","onCustomEvent","UI","Hint","init","timemanObj","now","Date","currentDate","getFullYear","getMonth","getDate","valueOf","checkOnline","setTimeout","setInterval","addCustomEvent","window","proxy","updateOnlineRestrictedMode","count","redrawOnline","date","getTime","filter","prevCounter","el","reduce","checkNewDay","today","checkTimeman","userId","getNumberUserId","findUser","isExtranet","setUserToLocal","catch","error","element","isUserOnline","forEach","unshift","list","requestUserList","counterFindUser","promises","Promise","resolve","reject","all","requestCount","slice","rest","callMethod","ID","result","collection","userData","name","avatar","MessengerCommon","isBlankAvatar","skipRest","find","getUserFromMessenger","getUserFromDb","getUserFromServer","addUserToDb","getUser","toISOString","indexedDB","getValue","entityId","addValue","external_auth_id","extranet","active","setUserOnline","String","replace","visibilityState","showCircleAnimation","renderAllUser","renderedUserIds","newUserIds","item","onlineToShow","renderedUserNodes","renderedItemId","getAttribute","remove","renderedUserCount","showAnimation","userIndex","stepRender","renderUser","elements","firstElement","lastElement","elementUserId","removedUserId","isDocumentVisible","zIndex","event","userStyle","itemsClasses","userItem","prepend","currentUserOnlineCount","maxUserOnlineCount","progressPercent","circle","Circle","fixCounter","color1","color2","updateCounter"],"mappings":"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"}