(function(){"use strict";BX.namespace("BX.Report.VisualConstructor.Widget.Config.Fields");BX.Report.VisualConstructor.Widget.Config.Fields.SelectWithPopup=function(t){this.fieldScope=t.fieldScope;this.selectControl=this.fieldScope.querySelector('[data-role="visualconstructor-field-custom-select"]');this.selectControlValue=this.fieldScope.querySelector('[data-role="visualconstructor-field-custom-select-value"]');this.optionList=t.optionList;this.value=t.value;this.id=this.fieldScope.id;this.init();BX.Report.VisualConstructor.Field.Base.apply(this,arguments)};BX.Report.VisualConstructor.Widget.Config.Fields.SelectWithPopup.prototype={__proto__:BX.Report.VisualConstructor.Field.Base.prototype,constructor:BX.Report.VisualConstructor.Widget.Config.Fields.SelectWithPopup,init:function(){BX.bind(this.selectControl,"click",BX.delegate(this.openSelectPopup,this))},openSelectPopup:function(){this.getSelectPopup().show()},getSelectPopup:function(){if(this.selectPopup){this.selectPopup.destroy()}var t=this.id+"_select_popup";this.popupContent=this.getSelectableOptionListContainer(this.optionList,this.handlerOptionChange);this.selectPopup=this.createPopup(t,this.selectControl,this.popupContent);return this.selectPopup},createPopup:function(t,e,i){return new BX.PopupWindow(t,e,{noAllPaddings:true,closeByEsc:true,angle:true,autoHide:true,zIndex:9999,offsetTop:0,content:i})},getSelectableOptionListContainer:function(t,e){var i=BX.create("div",{attrs:{className:"visualconstructor-select-popup-wrapper"}});for(var o in t){if(t.hasOwnProperty(o)){i.appendChild(BX.create("div",{attrs:{className:"visualconstructor-select-item-wrapper"},dataset:{selectionValue:o,selectionLabel:t[o]},text:t[o],events:{click:function(t){e.call(this,t.currentTarget.dataset.selectionValue,t.currentTarget.dataset.selectionLabel)}.bind(this)}}))}}return i},handlerOptionChange:function(t,e){if(this.selectPopup){this.selectPopup.close()}this.selectControl.innerHTML=e;this.selectControlValue.value=t;this.value=t;BX.onCustomEvent(this.fieldScope,this.id+"_onChange",[this])},getValue:function(){return this.value},setOptions:function(t){this.optionList=t;var e=Object.keys(this.optionList)[0];if(e){this.handlerOptionChange(e,this.optionList[e])}else{this.selectControl.innerHTML="";this.selectControlValue.value="";this.value=null}}}})();