(function(){"use strict";BX.namespace("BX.Report.VisualConstructor.Widget.Config.Fields");BX.Report.VisualConstructor.Widget.Config.Fields.TimePeriod=function(t){this.fieldScope=t.fieldScope;this.typeControl=this.fieldScope.querySelector('[data-role="visualconstructor-field-time-period-type"]');this.typeControlValue=this.fieldScope.querySelector('[data-role="visualconstructor-field-time-period-type-value"]');this.yearControl=this.fieldScope.querySelector('[data-role="visualconstructor-field-time-period-year"]');this.yearControlValue=this.fieldScope.querySelector('[data-role="visualconstructor-field-time-period-year-value"]');this.monthControl=this.fieldScope.querySelector('[data-role="visualconstructor-field-time-period-month"]');this.monthControlValue=this.fieldScope.querySelector('[data-role="visualconstructor-field-time-period-month-value"]');this.quarterControl=this.fieldScope.querySelector('[data-role="visualconstructor-field-time-period-quarter"]');this.quarterControlValue=this.fieldScope.querySelector('[data-role="visualconstructor-field-time-period-quarter-value"]');this.typeList=t.typeList;this.yearList=t.yearList;this.monthList=t.monthList;this.quarterList=t.quarterList;this.id=this.fieldScope.id;this.init();BX.Report.VisualConstructor.Field.Base.apply(this,arguments)};BX.Report.VisualConstructor.Widget.Config.Fields.TimePeriod.prototype={__proto__:BX.Report.VisualConstructor.Field.Base.prototype,constructor:BX.Report.VisualConstructor.Widget.Config.Fields.TimePeriod,init:function(){BX.bind(this.typeControl,"click",BX.delegate(this.openTypeSelectPopup,this));BX.bind(this.yearControl,"click",BX.delegate(this.openYearSelectPopup,this));BX.bind(this.monthControl,"click",BX.delegate(this.openMonthSelectPopup,this));BX.bind(this.quarterControl,"click",BX.delegate(this.openQuarterSelectPopup,this))},openTypeSelectPopup:function(){this.getTypeSelectPopup().show()},openYearSelectPopup:function(){this.getYearSelectPopup().show()},openMonthSelectPopup:function(){this.getMonthSelectPopup().show()},openQuarterSelectPopup:function(){this.getQuarterSelectPopup().show()},getTypeSelectPopup:function(){if(!this.typeSelectPopup){var t=this.id+"type_select_popup";var e=this.getSelectableTypeListContainer(this.typeList,this.handlerTypeChange);this.typeSelectPopup=this.createPopup(t,this.typeControl,e,{offsetLeft:10})}return this.typeSelectPopup},getYearSelectPopup:function(){if(!this.yearSelectPopup){var t=this.id+"year_select_popup";var e=this.getSelectableTypeListContainer(this.yearList,this.handlerYearChange);this.yearSelectPopup=this.createPopup(t,this.yearControl,e,{offsetLeft:10})}return this.yearSelectPopup},getMonthSelectPopup:function(){if(!this.monthSelectPopup){var t=this.id+"month_select_popup";var e=this.getSelectableTypeListContainer(this.monthList,this.handlerMonthChange);this.monthSelectPopup=this.createPopup(t,this.monthControl,e,{offsetLeft:10})}return this.monthSelectPopup},getQuarterSelectPopup:function(){if(!this.quarterSelectPopup){var t=this.id+"quarter_select_popup";var e=this.getSelectableTypeListContainer(this.quarterList,this.handlerQuarterChange);this.quarterSelectPopup=this.createPopup(t,this.quarterControl,e,{offsetLeft:3})}return this.quarterSelectPopup},createPopup:function(t,e,o,i){i=i||{};return new BX.PopupWindow(t,e,{noAllPaddings:true,closeByEsc:true,angle:true,autoHide:true,zIndex:9999,offsetTop:0,offsetLeft:i.offsetLeft||0,content:o})},getSelectableTypeListContainer:function(t,e){var o=BX.create("div",{attrs:{className:"visualconstructor-select-popup-wrapper"}});for(var i in t){if(t.hasOwnProperty(i)){o.appendChild(BX.create("div",{attrs:{className:"visualconstructor-select-item-wrapper"},dataset:{selectionValue:i,selectionLabel:t[i]},text:t[i],events:{click:function(t){e.call(this,t.srcElement.dataset.selectionValue,t.srcElement.dataset.selectionLabel)}.bind(this)}}))}}return o},handlerTypeChange:function(t,e){var o="report-field-time-period-sub-field-visible";switch(t){case"YEAR":this.monthControl.classList.remove(o);this.quarterControl.classList.remove(o);this.yearControl.classList.add(o);break;case"MONTH":this.quarterControl.classList.remove(o);this.monthControl.classList.add(o);this.yearControl.classList.add(o);break;case"QUARTER":this.monthControl.classList.remove(o);this.quarterControl.classList.add(o);this.yearControl.classList.add(o);break;default:this.yearControl.classList.remove(o);this.monthControl.classList.remove(o);this.quarterControl.classList.remove(o);break}this.typeSelectPopup.close();this.typeControl.innerHTML=e;this.typeControlValue.value=t;BX.onCustomEvent(this.fieldScope,this.id+"_onSelect",[this])},handlerYearChange:function(t,e){this.yearSelectPopup.close();this.yearControl.innerHTML=e;this.yearControlValue.value=t;BX.onCustomEvent(this.fieldScope,this.id+"_onSelect",[this])},handlerMonthChange:function(t,e){this.monthSelectPopup.close();this.monthControl.innerHTML=e;this.monthControlValue.value=t;BX.onCustomEvent(this.fieldScope,this.id+"_onSelect",[this])},handlerQuarterChange:function(t,e){this.quarterSelectPopup.close();this.quarterControl.innerHTML=e;this.quarterControlValue.value=t;BX.onCustomEvent(this.fieldScope,this.id+"_onSelect",[this])}}})();