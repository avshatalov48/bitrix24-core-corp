(function(t,e,a){"use strict";var n,o,s,i,c,l,r,d,h,v,u,b,p,g,f;var C=function(){function t(e,a){babelHelpers.classCallCheck(this,t);this.wrapper=document.getElementById(e);this.eventName=a.eventName;this.facebookBusinessParams=a.facebookBusinessParams;this.shops=a.shops;this.conversionDataLabelsText=a.conversionDataLabelsText;this.title=a.title;if(this.facebookBusinessParams.available){this.layout()}else{this.layoutError()}}babelHelpers.createClass(t,[{key:"layout",value:function t(){this.wrapper.innerHTML="";this.wrapper.appendChild(this.getTitleLayout());this.wrapper.appendChild(this.getInformationLayout());if(this.facebookBusinessParams.auth&&this.facebookBusinessParams.profile){this.wrapper.appendChild(this.getFacebookAuthConnectedLayout());if(this.shops){var a=e.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['<div class="facebook-conversion-shops-container"></div>'])));for(var o in this.shops){var s=this.getParamsContainerLayout(o);var i=this.getSwitcherContainerLayout(o,s);var c=this.getShopContainerLayout(o,i,s);a.appendChild(c)}this.wrapper.appendChild(a)}}else{this.wrapper.appendChild(this.getFacebookAuthDisconnectedLayout())}}},{key:"getShopContainerLayout",value:function t(a,n,i){var c=this.shops[a].name;return e.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div>\n\t\t\t\t<div class="facebook-conversion-shop-container">\n\t\t\t\t\t<div class="facebook-conversion-shop-name">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),e.Tag.safe(s||(s=babelHelpers.taggedTemplateLiteral(["",""])),c),n,i)}},{key:"notify",value:function t(e){BX.UI.Notification.Center.notify({content:e,autoHideDelay:5e3})}},{key:"getSwitcherContainerLayout",value:function t(a,n){var o=e.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(["<span></span>"])));var s=new BX.UI.Switcher({node:o,checked:this.shops[a].enabled==="Y"});s.handlers={checked:this.changeShopEnabledState.bind(this,a,"N",n),unchecked:this.changeShopEnabledState.bind(this,a,"Y",n)};return o}},{key:"changeShopEnabledState",value:function t(a,n,o){var s=this;this.shops[a].enabled=n;BX.ajax.runComponentAction("bitrix:sale.facebook.conversion","changeShopEnabledState",{mode:"class",data:{eventName:this.eventName,shopId:a,enabled:n}}).then(function(){s.notify(e.Loc.getMessage("FACEBOOK_CONVERSION_SAVE_SUCCESS"));o.style.display=n==="Y"?"block":"none"}).catch(function(){s.notify(e.Loc.getMessage("FACEBOOK_CONVERSION_SAVE_ERROR"))})}},{key:"getParamsContainerLayout",value:function t(a){var n=this.shops[a].params;var o=this.shops[a].enabled;var s=e.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(['<div class="facebook-conversion-params-container"></div>'])));s.style.display=o==="Y"?"block":"none";for(var i in n){var d=n[i];var h=i==="id"||i==="ids";var v=e.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<input\n\t\t\t\t\tid="','"\n\t\t\t\t\ttype="checkbox"\n\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t',"\n\t\t\t\t>\n\t\t\t"])),a+"_"+i,d==="Y"?"checked":"");v.disabled=h;e.Event.bind(v,"change",this.onParamCheckboxChange.bind(this,a,i));s.appendChild(e.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div>\n\t\t\t\t\t<label class="ui-ctl ui-ctl-checkbox">\n\t\t\t\t\t\t','\n\t\t\t\t\t\t<span class="ui-ctl-label-text ','">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t"])),v,h?"facebook-conversion-text-disabled":"",this.conversionDataLabelsText[i]))}return s}},{key:"onParamCheckboxChange",value:function t(a,n,o){var s=this;var i=o.currentTarget.checked;var c=o.currentTarget.dataset.dependedParamId;if(c){this.changeDependedParamCheckboxState(c,i)}this.shops[a].params[n]=i?"Y":"N";BX.ajax.runComponentAction("bitrix:sale.facebook.conversion","changeParamState",{mode:"class",data:{eventName:this.eventName,shopId:a,paramName:n,state:i?"Y":"N"}}).then(function(){s.notify(e.Loc.getMessage("FACEBOOK_CONVERSION_SAVE_SUCCESS"))}).catch(function(){s.notify(e.Loc.getMessage("FACEBOOK_CONVERSION_SAVE_ERROR"))})}},{key:"changeDependedParamCheckboxState",value:function t(e,a){var n=document.getElementById(e);if(n){n.disabled=!a;var o=n.parentNode;var s=o.querySelector(".ui-ctl-label-text");s.className=n.disabled?"ui-ctl-label-text facebook-conversion-text-disabled":"ui-ctl-label-text"}}},{key:"getTitleLayout",value:function t(){return e.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<p class="facebook-conversion-event-title">\n\t\t\t\t',"\n\t\t\t</p>\n\t\t"])),this.title)}},{key:"getInformationLayout",value:function t(){return e.Tag.render(h||(h=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="facebook-conversion-information-container">\n\t\t\t\t<div class="facebook-conversion-logo-container">\n\t\t\t\t\t<div class="facebook-conversion-logo">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<div class="facebook-conversion-description">\n\t\t\t\t\t\t','\n\t\t\t\t\t</div>\n\t\t\t\t\t<ol class="facebook-conversion-description-list">\n\t\t\t\t\t\t<li>',"</li>\n\t\t\t\t\t\t<li>","</li>\n\t\t\t\t\t\t<li>","</li>\n\t\t\t\t\t\t<li>",'</li>\n\t\t\t\t\t</ol>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<a \n\t\t\t\t\t\t\thref="https://www.facebook.com/business/help/1292598407460746?id=1205376682832142" \n\t\t\t\t\t\t\tclass="facebook-conversion-info" \n\t\t\t\t\t\t\ttarget="_blank"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION"),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION_GIVE_EVENTS"),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION_GIVE_CLIENT_ACTIONS"),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION_MAKE_AD_AUDIENCES"),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION_SHOW_AD"),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION_INFO"))}},{key:"getFacebookAuthDisconnectedLayout",value:function t(){return e.Tag.render(v||(v=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="facebook-conversion-auth-container-disconnected">\n\t\t\t\t<div class="facebook-conversion-auth-container-connect-title">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="facebook-conversion-auth-connect-container">\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass="ui-btn ui-btn-light-border"\n\t\t\t\t\t\tonclick="','"\n\t\t\t\t\t>\n\t\t\t\t\t\t','\n\t\t\t\t\t</a>\n\t\t\t\t\t<span class="facebook-conversion-auth-connect-info">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),e.Loc.getMessage("FACEBOOK_CONVERSION_CONNECT_TITLE"),this.login.bind(this),e.Loc.getMessage("FACEBOOK_CONVERSION_CONNECT"),e.Loc.getMessage("FACEBOOK_CONVERSION_CONNECT_INFO"))}},{key:"login",value:function t(){a.LoginFactory.getLoginObject({TYPE:"facebook",ENGINE_CODE:"business.facebook"}).login()}},{key:"getFacebookAuthConnectedLayout",value:function t(){return e.Tag.render(u||(u=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="facebook-conversion-auth-container-connected">\n\t\t\t\t<div class="facebook-conversion-auth-social-avatar">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass="facebook-conversion-auth-social-avatar-icon"\n\t\t\t\t\t\tstyle="background-image: url(',')"\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="facebook-conversion-auth-social-user">\n\t\t\t\t\t<a\n\t\t\t\t\t\t','\n\t\t\t\t\t\ttarget="_top"\n\t\t\t\t\t\tclass="facebook-conversion-auth-social-user-link"\n\t\t\t\t\t>\n\t\t\t\t\t\t','\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t\t<div class="facebook-conversion-auth-social-disconnect">\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass="facebook-conversion-auth-social-disconnect-link"\n\t\t\t\t\t\tonclick="','"\n\t\t\t\t\t>\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),e.Tag.safe(b||(b=babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t\t\t\t","\n\t\t\t\t\t\t"])),this.facebookBusinessParams.profile.picture),this.facebookBusinessParams.profile.url?'href="'+e.Tag.safe(p||(p=babelHelpers.taggedTemplateLiteral(["",""])),this.facebookBusinessParams.profile.url)+'"':"",e.Tag.safe(g||(g=babelHelpers.taggedTemplateLiteral(["",""])),this.facebookBusinessParams.profile.name),this.logout.bind(this),e.Loc.getMessage("FACEBOOK_CONVERSION_DISCONNECT"))}},{key:"logout",value:function t(){BX.ajax.runComponentAction("bitrix:sale.facebook.conversion","logout",{mode:"class",analyticsLabel:{connect:"FBE",action:"disconnect",type:"disconnect"}}).then(function(){document.location.reload()}).catch(function(){document.location.reload()})}},{key:"layoutError",value:function t(){var a=e.Tag.render(f||(f=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ui-slider-no-access">\n\t\t\t\t<div class="ui-slider-no-access-inner">\n\t\t\t\t\t<div class="ui-slider-no-access-title">\n\t\t\t\t\t\t','\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-slider-no-access-img">\n\t\t\t\t\t\t<div class="ui-slider-no-access-img-inner"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'])),e.Loc.getMessage("FACEBOOK_CONVERSION_NOT_AVAILABLE"));this.wrapper.appendChild(a)}}]);return t}();e.Reflection.namespace("BX").SaleFacebookConversion=C})(this.window=this.window||{},BX,BX.Seo.Ads);
//# sourceMappingURL=script.map.js