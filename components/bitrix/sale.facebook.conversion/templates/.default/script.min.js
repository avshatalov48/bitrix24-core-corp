(function(t,e,n,a){"use strict";function o(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ui-slider-no-access">\n\t\t\t\t<div class="ui-slider-no-access-inner">\n\t\t\t\t\t<div class="ui-slider-no-access-title">\n\t\t\t\t\t\t','\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-slider-no-access-img">\n\t\t\t\t\t\t<div class="ui-slider-no-access-img-inner"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t']);o=function e(){return t};return t}function i(){var t=babelHelpers.taggedTemplateLiteral(["",""]);i=function e(){return t};return t}function s(){var t=babelHelpers.taggedTemplateLiteral(["",""]);s=function e(){return t};return t}function r(){var t=babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t\t\t\t","\n\t\t\t\t\t\t"]);r=function e(){return t};return t}function c(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="facebook-conversion-auth-container-connected">\n\t\t\t\t<div class="facebook-conversion-auth-social-avatar">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass="facebook-conversion-auth-social-avatar-icon"\n\t\t\t\t\t\tstyle="background-image: url(',')"\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="facebook-conversion-auth-social-user">\n\t\t\t\t\t<a\n\t\t\t\t\t\t','\n\t\t\t\t\t\ttarget="_top"\n\t\t\t\t\t\tclass="facebook-conversion-auth-social-user-link"\n\t\t\t\t\t>\n\t\t\t\t\t\t','\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t\t<div class="facebook-conversion-auth-social-disconnect">\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass="facebook-conversion-auth-social-disconnect-link"\n\t\t\t\t\t\tonclick="','"\n\t\t\t\t\t>\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);c=function e(){return t};return t}function l(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="facebook-conversion-auth-container-disconnected">\n\t\t\t\t<div class="facebook-conversion-auth-container-connect-title">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="facebook-conversion-auth-connect-container">\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass="ui-btn ui-btn-light-border"\n\t\t\t\t\t\tonclick="','"\n\t\t\t\t\t>\n\t\t\t\t\t\t','\n\t\t\t\t\t</a>\n\t\t\t\t\t<span class="facebook-conversion-auth-connect-info">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);l=function e(){return t};return t}function u(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="facebook-conversion-information-container">\n\t\t\t\t<div class="facebook-conversion-logo-container">\n\t\t\t\t\t<div class="facebook-conversion-logo">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<div class="facebook-conversion-description">\n\t\t\t\t\t\t','\n\t\t\t\t\t</div>\n\t\t\t\t\t<ol class="facebook-conversion-description-list">\n\t\t\t\t\t\t<li>',"</li>\n\t\t\t\t\t\t<li>","</li>\n\t\t\t\t\t\t<li>","</li>\n\t\t\t\t\t\t<li>",'</li>\n\t\t\t\t\t</ol>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<a \n\t\t\t\t\t\t\thref="https://www.facebook.com/business/help/1292598407460746?id=1205376682832142" \n\t\t\t\t\t\t\tclass="facebook-conversion-info" \n\t\t\t\t\t\t\ttarget="_blank"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);u=function e(){return t};return t}function d(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<p class="facebook-conversion-event-title">\n\t\t\t\t',"\n\t\t\t</p>\n\t\t"]);d=function e(){return t};return t}function v(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div>\n\t\t\t\t\t<label class="ui-ctl ui-ctl-checkbox">\n\t\t\t\t\t\t','\n\t\t\t\t\t\t<span class="ui-ctl-label-text ','">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t"]);v=function e(){return t};return t}function h(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<input\n\t\t\t\t\tid="','"\n\t\t\t\t\ttype="checkbox"\n\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t',"\n\t\t\t\t>\n\t\t\t"]);h=function e(){return t};return t}function b(){var t=babelHelpers.taggedTemplateLiteral(['<div class="facebook-conversion-params-container"></div>']);b=function e(){return t};return t}function f(){var t=babelHelpers.taggedTemplateLiteral(["<span></span>"]);f=function e(){return t};return t}function p(){var t=babelHelpers.taggedTemplateLiteral(["",""]);p=function e(){return t};return t}function g(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div>\n\t\t\t\t<div class="facebook-conversion-shop-container">\n\t\t\t\t\t<div class="facebook-conversion-shop-name">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t","\n\t\t\t</div>\n\t\t"]);g=function e(){return t};return t}function C(){var t=babelHelpers.taggedTemplateLiteral(['<div class="facebook-conversion-shops-container"></div>']);C=function e(){return t};return t}var k=function(){function t(e,n){babelHelpers.classCallCheck(this,t);this.wrapper=document.getElementById(e);this.eventName=n.eventName;this.facebookBusinessParams=n.facebookBusinessParams;this.shops=n.shops;this.conversionDataLabelsText=n.conversionDataLabelsText;this.title=n.title;if(this.facebookBusinessParams.available){this.layout()}else{this.layoutError()}}babelHelpers.createClass(t,[{key:"layout",value:function t(){this.wrapper.innerHTML="";this.wrapper.appendChild(this.getTitleLayout());this.wrapper.appendChild(this.getInformationLayout());if(this.facebookBusinessParams.auth&&this.facebookBusinessParams.profile){this.wrapper.appendChild(this.getFacebookAuthConnectedLayout());if(this.shops){var n=e.Tag.render(C());for(var a in this.shops){var o=this.getParamsContainerLayout(a);var i=this.getSwitcherContainerLayout(a,o);var s=this.getShopContainerLayout(a,i,o);n.appendChild(s)}this.wrapper.appendChild(n)}}else{this.wrapper.appendChild(this.getFacebookAuthDisconnectedLayout())}}},{key:"getShopContainerLayout",value:function t(n,a,o){var i=this.shops[n].name;return e.Tag.render(g(),e.Tag.safe(p(),i),a,o)}},{key:"notify",value:function t(e){BX.UI.Notification.Center.notify({content:e,autoHideDelay:5e3})}},{key:"getSwitcherContainerLayout",value:function t(n,a){var o=e.Tag.render(f());var i=new BX.UI.Switcher({node:o,checked:this.shops[n].enabled==="Y"});i.handlers={checked:this.changeShopEnabledState.bind(this,n,"N",a),unchecked:this.changeShopEnabledState.bind(this,n,"Y",a)};return o}},{key:"changeShopEnabledState",value:function t(n,a,o){var i=this;this.shops[n].enabled=a;BX.ajax.runComponentAction("bitrix:sale.facebook.conversion","changeShopEnabledState",{mode:"class",data:{eventName:this.eventName,shopId:n,enabled:a}}).then(function(){i.notify(e.Loc.getMessage("FACEBOOK_CONVERSION_SAVE_SUCCESS"));o.style.display=a==="Y"?"block":"none"}).catch(function(){i.notify(e.Loc.getMessage("FACEBOOK_CONVERSION_SAVE_ERROR"))})}},{key:"getParamsContainerLayout",value:function t(n){var a=this.shops[n].params;var o=this.shops[n].enabled;var i=e.Tag.render(b());i.style.display=o==="Y"?"block":"none";for(var s in a){var r=a[s];var c=s==="id"||s==="ids";var l=e.Tag.render(h(),n+"_"+s,r==="Y"?"checked":"");l.disabled=c;e.Event.bind(l,"change",this.onParamCheckboxChange.bind(this,n,s));i.appendChild(e.Tag.render(v(),l,c?"facebook-conversion-text-disabled":"",this.conversionDataLabelsText[s]))}return i}},{key:"onParamCheckboxChange",value:function t(n,a,o){var i=this;var s=o.currentTarget.checked;var r=o.currentTarget.dataset.dependedParamId;if(r){this.changeDependedParamCheckboxState(r,s)}this.shops[n].params[a]=s?"Y":"N";BX.ajax.runComponentAction("bitrix:sale.facebook.conversion","changeParamState",{mode:"class",data:{eventName:this.eventName,shopId:n,paramName:a,state:s?"Y":"N"}}).then(function(){i.notify(e.Loc.getMessage("FACEBOOK_CONVERSION_SAVE_SUCCESS"))}).catch(function(){i.notify(e.Loc.getMessage("FACEBOOK_CONVERSION_SAVE_ERROR"))})}},{key:"changeDependedParamCheckboxState",value:function t(e,n){var a=document.getElementById(e);if(a){a.disabled=!n;var o=a.parentNode;var i=o.querySelector(".ui-ctl-label-text");i.className=a.disabled?"ui-ctl-label-text facebook-conversion-text-disabled":"ui-ctl-label-text"}}},{key:"getTitleLayout",value:function t(){return e.Tag.render(d(),this.title)}},{key:"getInformationLayout",value:function t(){return e.Tag.render(u(),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION"),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION_GIVE_EVENTS"),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION_GIVE_CLIENT_ACTIONS"),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION_MAKE_AD_AUDIENCES"),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION_SHOW_AD"),e.Loc.getMessage("FACEBOOK_CONVERSION_DESCRIPTION_INFO"))}},{key:"getFacebookAuthDisconnectedLayout",value:function t(){return e.Tag.render(l(),e.Loc.getMessage("FACEBOOK_CONVERSION_CONNECT_TITLE"),this.login.bind(this),e.Loc.getMessage("FACEBOOK_CONVERSION_CONNECT"),e.Loc.getMessage("FACEBOOK_CONVERSION_CONNECT_INFO"))}},{key:"login",value:function t(){n.LoginFactory.getLoginObject({TYPE:"facebook",ENGINE_CODE:"business.facebook"}).login()}},{key:"getFacebookAuthConnectedLayout",value:function t(){return e.Tag.render(c(),e.Tag.safe(r(),this.facebookBusinessParams.profile.picture),this.facebookBusinessParams.profile.url?'href="'+e.Tag.safe(s(),this.facebookBusinessParams.profile.url)+'"':"",e.Tag.safe(i(),this.facebookBusinessParams.profile.name),this.logout.bind(this),e.Loc.getMessage("FACEBOOK_CONVERSION_DISCONNECT"))}},{key:"logout",value:function t(){BX.ajax.runComponentAction("bitrix:sale.facebook.conversion","logout",{mode:"class",analyticsLabel:{connect:"FBE",action:"disconnect",type:"disconnect"}}).then(function(){document.location.reload()}).catch(function(){document.location.reload()})}},{key:"layoutError",value:function t(){var n=e.Tag.render(o(),e.Loc.getMessage("FACEBOOK_CONVERSION_NOT_AVAILABLE"));this.wrapper.appendChild(n)}}]);return t}();e.Reflection.namespace("BX").SaleFacebookConversion=k})(this.window=this.window||{},BX,BX.Seo.Ads,BX.UI.SidePanel);
//# sourceMappingURL=script.map.js