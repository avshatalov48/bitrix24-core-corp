{"version":3,"file":"script.js","sources":["src/release-slider.js","src/release-ear.js","src/release.js"],"sourcesContent":["import { Cache, Type, Tag, Event, Text } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport default class ReleaseSlider extends EventEmitter\n{\n\t#id: string;\n\t#windowMessageHandler: Function = null;\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Intranet.Bitrix24.ReleaseSlider');\n\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\t\tthis.subscribeFromOptions(options.events);\n\n\t\tthis.url = Type.isStringFilled(options.url) ? options.url : 'about:blank';\n\t\tthis.#id = `release-slider-${Text.getRandom()}`;\n\t\tthis.sliderOptions = Type.isPlainObject(options.sliderOptions) ? options.sliderOptions : {};\n\n\t\tthis.#windowMessageHandler = this.#handleWindowMessage.bind(this);\n\t\tthis.html = new Cache.MemoryCache();\n\t}\n\n\tshow(): void\n\t{\n\t\tif (this.isOpen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst defaultOptions = {\n\t\t\twidth: 1100,\n\t\t\tcustomLeftBoundary: 0,\n\t\t};\n\t\tconst options = Object.assign({}, defaultOptions, this.sliderOptions);\n\t\tconst userEvents = Type.isPlainObject(options.events) ? options.events : {};\n\n\t\toptions.events = {\n\t\t\tonCloseComplete: () => {\n\t\t\t\tEvent.unbind(window, 'message', this.#windowMessageHandler);\n\t\t\t\tthis.emit('onCloseComplete');\n\t\t\t},\n\t\t\tonOpenComplete: () => {\n\t\t\t\tEvent.bind(window, 'message', this.#windowMessageHandler);\n\t\t\t}\n\t\t};\n\n\t\toptions.contentCallback = (slider) => {\n\t\t\tfor (const eventName in userEvents)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(userEvents[eventName]))\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.subscribe(\n\t\t\t\t\t\tslider,\n\t\t\t\t\t\tBX.SidePanel.Slider.getEventFullName(eventName),\n\t\t\t\t\t\tuserEvents[eventName]\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tif (this.getFrame().src !== this.url)\n\t\t\t\t{\n\t\t\t\t\tthis.getFrame().src = this.url;\n\t\t\t\t}\n\n\t\t\t\tEvent.bind(this.getFrame(), 'load', this.#handleFrameLoad.bind(this));\n\n\t\t\t\tresolve(this.#getContent());\n\t\t\t});\n\t\t};\n\n\t\tBX.SidePanel.Instance.open(this.getId(), options);\n\t}\n\n\thide(): void\n\t{\n\t\tconst slider = this.getSlider();\n\t\tif (slider)\n\t\t{\n\t\t\tslider.close();\n\t\t}\n\t}\n\n\tisOpen(): boolean\n\t{\n\t\treturn this.getSlider() && this.getSlider().isOpen();\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.#id;\n\t}\n\n\tgetSlider(): Object\n\t{\n\t\treturn BX.SidePanel.Instance.getSlider(this.getId());\n\t}\n\n\tgetFrame(): HTMLIFrameElement\n\t{\n\t\treturn this.html.remember('frame', () => {\n\t\t\treturn Tag.render`<iframe src=\"about:blank\" class=\"intranet-release-iframe\"></iframe>`;\n\t\t});\n\t}\n\n\t#getContent(): HTMLElement\n\t{\n\t\treturn this.html.remember('content', () => {\n\t\t\treturn Tag.render`<div class=\"intranet-release-iframe-container\">${this.getFrame()}</div>`;\n\t\t});\n\t}\n\n\t#handleFrameLoad()\n\t{\n\t\tthis.emit('onLoad');\n\t}\n\n\t#handleWindowMessage(event)\n\t{\n\t\tconst frameOrigin = new URL(this.url);\n\t\tif (event.origin !== frameOrigin.origin)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('onMessage', { message: event.data, event });\n\t}\n}","import { Tag, Type, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport default class ReleaseEar extends EventEmitter\n{\n\tcontainer: HTMLElement = null;\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Intranet.Bitrix24.ReleaseEar');\n\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\t\tthis.zone = Type.isStringFilled(options.zone) ? options.zone : 'en';\n\t\tthis.subscribeFromOptions(options.events);\n\t}\n\n\tshow(animate = false)\n\t{\n\t\tif (animate)\n\t\t{\n\t\t\tDom.removeClass(this.getContainer(), '--hidden');\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tDom.removeClass(this.getContainer(), '--hidden');\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.getContainer(), '--hidden');\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tDom.addClass(this.getContainer(), '--hidden');\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\tif (this.container === null)\n\t\t{\n\t\t\tthis.container = Tag.render`\n\t\t\t\t<div class=\"intranet-release-ear\" onclick=\"${this.handleClick.bind(this)}\">\n\t\t\t\t\t<div class=\"intranet-release-button\"><i></i></div>\n\t\t\t\t\t<div class=\"intranet-release-logo --${this.zone}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.append(this.container, document.body);\n\t\t}\n\n\t\treturn this.container;\n\t}\n\n\thandleClick()\n\t{\n\t\tthis.emit('onClick');\n\t}\n}\n","import { Type, ajax as Ajax, type JsonObject, Reflection } from 'main.core';\nimport { type BaseEvent, EventEmitter } from 'main.core.events';\n\nimport ReleaseSlider from './release-slider';\nimport ReleaseEar from './release-ear';\n\nexport default class Release\n{\n\t#deactivated = false;\n\t#id: string = '';\n\n\tconstructor(releaseOptions: JsonObject)\n\t{\n\t\tconst options = Type.isPlainObject(releaseOptions) ? releaseOptions : {};\n\n\t\tif (!Type.isStringFilled(options.url))\n\t\t{\n\t\t\tthrow new Error('Release: the \"url\" parameter is required.');\n\t\t}\n\n\t\tthis.#id = Type.isStringFilled(options.id) ? options.id : '';\n\n\t\tthis.slider = new ReleaseSlider({\n\t\t\turl: options.url,\n\t\t\tsliderOptions: options.sliderOptions,\n\t\t\tevents: {\n\t\t\t\tonCloseComplete: this.#handleSliderClose.bind(this),\n\t\t\t\tonMessage: this.#handleFrameMessage.bind(this),\n\t\t\t},\n\t\t});\n\n\t\tthis.ear = new ReleaseEar({\n\t\t\tzone: options.zone,\n\t\t\tevents: {\n\t\t\t\tonClick: this.#handleEarClick.bind(this),\n\t\t\t},\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onOpen', () => {\n\t\t\tthis.getEar().hide();\n\t\t});\n\n\t\tconst onClose = () => {\n\t\t\tif (BX.SidePanel.Instance.getOpenSlidersCount() === 0)\n\t\t\t{\n\t\t\t\tthis.getEar().show(true);\n\t\t\t}\n\t\t};\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseComplete', onClose);\n\t\tEventEmitter.subscribe('SidePanel.Slider:onDestroy', onClose);\n\t}\n\n\tshow(mode = 'ear'): void\n\t{\n\t\tif (mode === 'slider')\n\t\t{\n\t\t\tconst BannerDispatcher = Reflection.getClass('BX.UI.BannerDispatcher');\n\t\t\tif (BannerDispatcher)\n\t\t\t{\n\t\t\t\tBannerDispatcher.critical.toQueue(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tthis.getSlider().show();\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: this.#id,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getSlider().show();\n\t\t\t}\n\n\t\t\tvoid this.#runAction('show', { context: 'auto' });\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (BX.SidePanel.Instance.getOpenSlidersCount() === 0)\n\t\t\t{\n\t\t\t\tthis.getEar().show();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSlider(): ReleaseSlider\n\t{\n\t\treturn this.slider;\n\t}\n\n\tgetEar(): ReleaseEar\n\t{\n\t\treturn this.ear;\n\t}\n\n\t#runAction(action, labels = {}, data = {}): Promise\n\t{\n\t\treturn Ajax.runComponentAction('bitrix:intranet.bitrix24.release', action, {\n\t\t\tmode: 'class',\n\t\t\tdata,\n\t\t\tanalyticsLabel: {\n\t\t\t\tmodule: 'intranet',\n\t\t\t\tservice: this.#id,\n\t\t\t\taction,\n\t\t\t\t...labels,\n\t\t\t},\n\t\t});\n\t}\n\n\t#handleSliderClose(): void\n\t{\n\t\tif (BX.SidePanel.Instance.getOpenSlidersCount() === 0)\n\t\t{\n\t\t\tthis.getEar().show(true);\n\t\t}\n\n\t\tconst AutoLauncher = Reflection.getClass('BX.UI.AutoLaunch.AutoLauncher');\n\t\tif (AutoLauncher)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tAutoLauncher.unregister(this.#id);\n\t\t\t}, 1000);\n\t\t}\n\n\t\tvoid this.#runAction('close');\n\t}\n\n\t#handleEarClick(): void\n\t{\n\t\tthis.getEar().hide();\n\t\tthis.getSlider().show();\n\t\tvoid this.#runAction('show', { context: 'ear-click' });\n\t}\n\n\t#handleFrameMessage(event: BaseEvent): void\n\t{\n\t\tconst { message } = event.getData();\n\t\tif (!Type.isPlainObject(message))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (message.command === 'endOfScroll' && this.#deactivated === false)\n\t\t{\n\t\t\tthis.#deactivated = true;\n\t\t\tthis.#runAction('deactivate').catch(() => {\n\t\t\t\tthis.#deactivated = false;\n\t\t\t});\n\t\t}\n\n\t\tif (message.command === 'openHelper' && BX.Helper)\n\t\t{\n\t\t\tBX.Helper.show(message.options);\n\t\t}\n\t}\n}\n"],"names":["ReleaseSlider","EventEmitter","constructor","options","setEventNamespace","Type","isPlainObject","subscribeFromOptions","events","url","isStringFilled","Text","getRandom","sliderOptions","bind","html","Cache","MemoryCache","show","isOpen","defaultOptions","width","customLeftBoundary","Object","assign","userEvents","onCloseComplete","Event","unbind","window","emit","onOpenComplete","contentCallback","slider","eventName","isFunction","subscribe","BX","SidePanel","Slider","getEventFullName","Promise","resolve","reject","getFrame","src","Instance","open","getId","hide","getSlider","close","remember","Tag","render","event","frameOrigin","URL","origin","message","data","ReleaseEar","container","zone","animate","Dom","removeClass","getContainer","requestAnimationFrame","addClass","handleClick","append","document","body","Release","releaseOptions","Error","id","onMessage","ear","onClick","getEar","onClose","getOpenSlidersCount","mode","BannerDispatcher","Reflection","getClass","critical","toQueue","context","action","labels","Ajax","runComponentAction","analyticsLabel","module","service","AutoLauncher","setTimeout","unregister","getData","command","catch","Helper"],"mappings":"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"}