{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Dom, Event, Loc, Reflection, Tag, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Loader } from 'main.loader';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { CustomSection, TypeModel, TypeModelData } from 'crm.type-model';\nimport { Router } from 'crm.router';\nimport { TagSelector } from 'ui.entity-selector';\n\ndeclare type Preset = {\n\tfields: {\n\t\tid: string,\n\t\ttitle: string,\n\t\tcategory: string,\n\t\tdescription: string,\n\t\ticon: string,\n\t},\n\tdata: TypeModelData\n}\n\ndeclare type Relation = {\n\ttitle: string,\n\tisChecked: boolean,\n\tentityTypeId: number,\n\tisChildrenListEnabled: boolean,\n}\n\ndeclare type CustomSectionElement = CustomSection & {\n\tisSelected: boolean,\n}\n\nconst namespace = Reflection.namespace('BX.Crm.Component');\n\nlet instance: TypeDetail = null;\n\n/**\n * @memberOf BX.Crm.Component\n */\nclass TypeDetail\n{\n    form;\n    type: TypeModel;\n    isProgress: boolean = false;\n\tcontainer: Element;\n\terrorsContainer: Element;\n    isNew: boolean;\n\ttabs: Map<string, Element> = new Map();\n\tpresets: Array;\n\trelations: {\n\t\tparent: Relation[],\n\t\tchild: Relation[],\n\t};\n\tcustomSections: ?CustomSectionElement[];\n\tparentRelationsController: RelationsController;\n\tchildRelationsController: RelationsController;\n\tcustomSectionController: ?CustomSectionsController;\n\tisRestricted: boolean = false;\n\n    constructor(params: {\n        form: Element,\n        type: TypeModel,\n        container: Element,\n        errorsContainer: Element,\n\t\tpresets?: Array,\n\t\trelations: {\n        \tparent: Relation[],\n\t\t\tchild: Relation[],\n\t\t},\n\t\tcustomSections: ?CustomSectionElement[],\n    })\n    {\n        if(Type.isPlainObject(params))\n        {\n            this.type = params.type;\n            this.isNew = !this.type.isSaved();\n            this.form = params.form;\n            this.container = params.container;\n            this.errorsContainer = params.errorsContainer;\n            this.presets = params.presets;\n            this.relations = params.relations;\n            if (Type.isArray(params.customSections))\n\t\t\t{\n\t\t\t\tthis.customSections = params.customSections;\n\t\t\t}\n            this.isRestricted = Boolean(params.isRestricted);\n        }\n\n        this.saveButton = document.getElementById('ui-button-panel-save');\n        this.cancelButton = document.getElementById('ui-button-panel-cancel');\n        this.deleteButton = document.getElementById('ui-button-panel-remove');\n\n        instance = this;\n    }\n\n    init()\n    {\n        this.bindEvents();\n\n        this.fillTabs();\n\n        if (!this.type.getId())\n\t\t{\n\t\t\tthis.enablePresetsView()\n\t\t}\n        else\n\t\t{\n\t\t\t// const customPreset = this.getPresetById('bitrix:empty');\n\t\t\t// const presetSelector = document.querySelector('[data-role=\"crm-type-preset-selector\"]');\n\t\t\t// if (customPreset && presetSelector)\n\t\t\t// {\n\t\t\t// \tpresetSelector.textContent = customPreset.fields.title;\n\t\t\t// }\n\t\t\tthis.disablePresetsView();\n\t\t\tconst presetSelectorContainer = document.querySelector('[data-role=\"preset-selector-container\"]');\n\t\t\tif (presetSelectorContainer)\n\t\t\t{\n\t\t\t\tDom.addClass(presetSelectorContainer, 'crm-type-hidden');\n\t\t\t}\n\t\t}\n\n\t\tDom.removeClass(document.querySelector('body'), 'crm-type-hidden');\n\n        this.initRelations();\n\n        this.initCustomSections();\n    }\n\n    bindEvents()\n    {\n        Event.bind(this.saveButton, 'click', (event) => {\n                this.save(event);\n            }, {\n                passive: false\n            }\n        );\n\n        if(this.deleteButton)\n        {\n            Event.bind(this.deleteButton, 'click', (event) => {\n                this.delete(event);\n            });\n        }\n\n\t\tconst userFieldOption = this.getBooleanFieldNodeByName('isUseInUserfieldEnabled');\n\t\tif (userFieldOption)\n\t\t{\n\t\t\tEvent.bind(userFieldOption, 'click', this.disableLinkedUserFieldsIfNotAvailable.bind(this));\n\t\t}\n\n\t\tthis.form.querySelectorAll('[data-name*=\"linkedUserFields\"]').forEach((linkedUserFieldNode) => {\n\t\t\tEvent.bind(linkedUserFieldNode, 'click', this.enableUserFieldIfAnyLinkedChecked.bind(this));\n\t\t});\n    }\n\n\tenablePresetsView()\n\t{\n\t\tDom.addClass(document.querySelector('body'), 'crm-type-settings-presets');\n\t\tconst activeTab = this.container.querySelector('.crm-type-tab-current');\n\t\tif (activeTab)\n\t\t{\n\t\t\tDom.removeClass(activeTab, 'crm-type-tab-current');\n\t\t}\n\t\tconst presetsTab = this.container.querySelector('[data-tab=\"presets\"]');\n\t\tif (presetsTab)\n\t\t{\n\t\t\tDom.addClass(presetsTab, 'crm-type-tab-current');\n\t\t}\n\t\tconst presetSelectorContainer = document.querySelector('[data-role=\"preset-selector-container\"]');\n\t\tif (presetSelectorContainer)\n\t\t{\n\t\t\tDom.addClass(presetSelectorContainer, 'crm-type-hidden');\n\t\t}\n\t\tDom.removeClass(document.getElementById('pagetitle'), 'crm-type-hidden');\n\t}\n\n\tdisablePresetsView()\n\t{\n\t\tDom.removeClass(document.querySelector('body'), 'crm-type-settings-presets');\n\t\tconst commonTab = document.querySelector('[data-role=\"tab-common\"]');\n\t\tif (commonTab)\n\t\t{\n\t\t\tcommonTab.click();\n\t\t}\n\t\tconst presetSelectorContainer = document.querySelector('[data-role=\"preset-selector-container\"]');\n\t\tif (presetSelectorContainer)\n\t\t{\n\t\t\tDom.removeClass(presetSelectorContainer, 'crm-type-hidden');\n\t\t}\n\t\tDom.addClass(document.getElementById('pagetitle'), 'crm-type-hidden');\n\t}\n\n    disableLinkedUserFieldsIfNotAvailable()\n\t{\n\t\tconst userFieldOption = this.getBooleanFieldNodeByName('isUseInUserfieldEnabled');\n\t\tif (!this.isBooleanFieldChecked(userFieldOption))\n\t\t{\n\t\t\tthis.form.querySelectorAll('[data-name*=\"linkedUserFields\"]').forEach((linkedUserFieldNode) => {\n\t\t\t\tthis.setBooleanFieldCheckedState(linkedUserFieldNode, false);\n\t\t\t});\n\t\t}\n\t}\n\n\tenableUserFieldIfAnyLinkedChecked()\n\t{\n\t\tconst userFieldOption = this.getBooleanFieldNodeByName('isUseInUserfieldEnabled');\n\t\tif (!this.isBooleanFieldChecked(userFieldOption))\n\t\t{\n\t\t\tthis.form.querySelectorAll('[data-name*=\"linkedUserFields\"]').forEach((linkedUserFieldNode) => {\n\t\t\t\tif (this.isBooleanFieldChecked(linkedUserFieldNode))\n\t\t\t\t{\n\t\t\t\t\tthis.setBooleanFieldCheckedState(userFieldOption, true);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n    getLoader()\n    {\n        if(!this.loader)\n        {\n            this.loader = new Loader({size: 150});\n        }\n\n        return this.loader;\n    }\n\n    startProgress()\n    {\n        this.isProgress = true;\n        if(!this.getLoader().isShown())\n        {\n            this.getLoader().show(this.form);\n        }\n        this.hideErrors();\n    }\n\n    stopProgress()\n    {\n        this.isProgress = false;\n        this.getLoader().hide();\n        setTimeout(() =>\n        {\n            Dom.removeClass(this.saveButton, 'ui-btn-wait');\n            Dom.removeClass(this.cancelButton, 'ui-btn-wait');\n            if(this.deleteButton)\n            {\n                Dom.removeClass(this.deleteButton, 'ui-btn-wait');\n            }\n        }, 200);\n    }\n\n    save(event)\n    {\n    \tif (this.isRestricted)\n\t\t{\n\t\t\tRouter.Instance.showFeatureSlider();\n\t\t\tthis.stopProgress();\n\t\t\treturn;\n\t\t}\n        event.preventDefault();\n        if(!this.form)\n        {\n            return;\n        }\n        if(this.isProgress)\n        {\n            return;\n        }\n        if(!this.type)\n        {\n            return;\n        }\n        this.startProgress();\n\n        this.type.setTitle(this.form.querySelector('[name=\"title\"]').value);\n        TypeModel.getBooleanFieldNames().forEach((fieldName) => {\n        \tconst fieldNode = this.getBooleanFieldNodeByName(fieldName);\n        \tif (fieldNode)\n\t\t\t{\n\t\t\t\tthis.type.data[fieldName] = this.isBooleanFieldChecked(fieldNode);\n\t\t\t}\n\t\t});\n\t\t// this.type.setConversionMap({\n\t\t// \tsourceTypes: this.collectEntityTypeIds('conversion-source'),\n\t\t// \tdestinationTypes: this.collectEntityTypeIds('conversion-destination'),\n\t\t// });\n\t\tconst linkedUserFields = {};\n\t\tthis.form.querySelectorAll('[data-name*=\"linkedUserFields\"]').forEach((linkedUserFieldNode) => {\n\t\t\tconst name = linkedUserFieldNode.dataset.name.substr('linkedUserFields['.length).replace(']', '')\n\t\t\tlinkedUserFields[name] = this.isBooleanFieldChecked(linkedUserFieldNode);\n\t\t});\n\t\tthis.type.setLinkedUserFields(linkedUserFields);\n\t\tthis.type.setRelations({\n\t\t\tparent: this.parentRelationsController.getData(),\n\t\t\tchild: this.childRelationsController.getData(),\n\t\t});\n\t\tif (this.customSectionController)\n\t\t{\n\t\t\tconst customSectionData = this.customSectionController.getData();\n\t\t\tthis.type.setCustomSectionId(customSectionData.customSectionId);\n\t\t\tthis.type.setCustomSections(customSectionData.customSecions);\n\t\t}\n\n\t\tthis.type.save().then((response) => {\n\t\t\tthis.stopProgress();\n\t\t\tthis.afterSave(response);\n\t\t\tthis.isNew = false;\n\t\t}).catch( (errors) => {\n\t\t\tthis.showErrors(errors);\n\t\t\tthis.stopProgress();\n\t\t});\n    }\n\n\tcollectEntityTypeIds(role: string): []\n\t{\n\t\tconst entityTypeIds = [];\n\n\t\tconst checkboxes = this.container.querySelectorAll(`[data-role=\"${role}\"]`);\n\t\tArray.from(checkboxes).forEach( (checkbox: HTMLInputElement) =>\n\t\t{\n\t\t\tif (checkbox.checked)\n\t\t\t{\n\t\t\t\tentityTypeIds.push(checkbox.dataset.entityTypeId);\n\t\t\t}\n\t\t});\n\n\t\treturn entityTypeIds;\n\t}\n\n    afterSave(response: {data: {}})\n    {\n        this.addDataToSlider('response', response);\n\n\t\tif (response.data.hasOwnProperty('urlTemplates'))\n\t\t{\n\t\t\tRouter.Instance.setUrlTemplates(response.data.urlTemplates);\n\t\t}\n\n        const slider = this.getSlider();\n        if(slider)\n        {\n            slider.close();\n        }\n        else if(this.isNew)\n        {\n            location.href = Router.Instance.getTypeDetailUrl(this.type.getEntityTypeId());\n        }\n        this.emitTypeUpdatedEvent();\n    }\n\n    getSlider()\n    {\n        if(Reflection.getClass('BX.SidePanel'))\n        {\n            return BX.SidePanel.Instance.getSliderByWindow(window);\n        }\n\n        return null;\n    }\n\n    getToolbarComponent(): ?BX.Crm.ToolbarComponent\n\t{\n\t\tif(Reflection.getClass('BX.Crm.ToolbarComponent'))\n\t\t{\n\t\t\treturn BX.Crm.ToolbarComponent.Instance;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\temitTypeUpdatedEvent(): void\n\t{\n\t\tconst toolbar = this.getToolbarComponent();\n\t\tif (toolbar)\n\t\t{\n\t\t\ttoolbar.emitTypeUpdatedEvent();\n\t\t}\n\t}\n\n    addDataToSlider(key, data)\n    {\n        if(Type.isString(key) && Type.isPlainObject(data))\n        {\n            let slider = this.getSlider();\n            if(slider)\n            {\n                slider.data.set(key, data);\n            }\n        }\n    }\n\n\tshowErrors(errors: string[])\n\t{\n\t\tlet text = '';\n\t\terrors.forEach((message) =>\n\t\t{\n\t\t\ttext += message;\n\t\t});\n\t\tif(Type.isDomNode(this.errorsContainer))\n\t\t{\n\t\t\tthis.errorsContainer.innerText = text;\n\t\t\tthis.errorsContainer.parentNode.style.display = 'block';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(text);\n\t\t}\n\t}\n\n    hideErrors()\n    {\n        if(Type.isDomNode(this.errorsContainer))\n        {\n            this.errorsContainer.parentNode.style.display = 'none';\n            this.errorsContainer.innerText = '';\n        }\n    }\n\n    delete(event)\n    {\n        event.preventDefault();\n        if(!this.form)\n        {\n            return;\n        }\n        if(this.isProgress)\n        {\n            return;\n        }\n        if(!this.type)\n        {\n            return;\n        }\n        MessageBox.confirm(\n            Loc.getMessage('CRM_TYPE_DETAIL_DELETE_CONFIRM'),\n            () => {\n                return new Promise((resolve) => {\n                    this.startProgress();\n                    this.type.delete().then(() => {\n                        this.stopProgress();\n\t\t\t\t\t\tthis.emitTypeUpdatedEvent();\n                        const slider = this.getSlider();\n                        if(slider)\n                        {\n                            slider.close();\n                        }\n                        else\n                        {\n                            const listUrl = Router.Instance.getTypeListUrl();\n                            if(listUrl)\n                            {\n                                location.href = listUrl.toString();\n                            }\n                        }\n                    }).catch((errors: string[]) => {\n                        this.showErrors(errors);\n                        this.stopProgress();\n                        resolve();\n                    });\n                });\n            },\n            null,\n            (box) => {\n                this.stopProgress();\n                box.close();\n            }\n        );\n    }\n\n\tfillTabs()\n\t{\n\t\tif(this.container)\n\t\t{\n\t\t\tthis.container.querySelectorAll('.crm-type-tab').forEach((tabNode: HTMLDivElement) => {\n\t\t\t\tif(tabNode.dataset.tab)\n\t\t\t\t{\n\t\t\t\t\tthis.tabs.set(tabNode.dataset.tab, tabNode);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tshowTab(tabNameToShow: string)\n\t{\n\t\tArray.from(this.tabs.keys()).forEach((tabName: string) => {\n\t\t\tif(tabName === tabNameToShow)\n\t\t\t{\n\t\t\t\tthis.tabs.get(tabName).classList.add('crm-type-tab-current');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.tabs.get(tabName).classList.remove('crm-type-tab-current');\n\t\t\t}\n\t\t});\n\t}\n\n\tapplyPreset(presetId: string)\n\t{\n\t\tthis.disablePresetsView();\n\t\tconst presetSelector = document.querySelector('[data-role=\"crm-type-preset-selector\"]');\n\t\tconst currentPresetNode = this.container.querySelector('[data-role=\"preset\"].crm-type-preset-active');\n\t\tif (currentPresetNode)\n\t\t{\n\t\t\tconst currentPreset = this.getPresetById(currentPresetNode.dataset.presetId);\n\t\t\tif (\n\t\t\t\tcurrentPreset\n\t\t\t\t&& currentPreset.data.title\n\t\t\t\t&& this.form.querySelector('[name=\"title\"]').value === currentPreset.data.title)\n\t\t\t{\n\t\t\t\tthis.form.querySelector('[name=\"title\"]').value = '';\n\t\t\t}\n\t\t}\n\t\tconst presets = this.container.querySelectorAll('[data-role=\"preset\"]');\n\t\tpresets.forEach((presetNode: HTMLDivElement) => {\n\t\t\tDom.removeClass(presetNode, 'crm-type-preset-active');\n\t\t\tif (presetNode.dataset.presetId === presetId)\n\t\t\t{\n\t\t\t\tDom.addClass(presetNode, 'crm-type-preset-active');\n\t\t\t\tconst preset = this.getPresetById(presetId);\n\t\t\t\tif (preset)\n\t\t\t\t{\n\t\t\t\t\tthis.updateInputs(preset.data);\n\t\t\t\t\tif (presetSelector)\n\t\t\t\t\t{\n\t\t\t\t\t\tpresetSelector.textContent = Text.encode(preset.fields.title);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetPresetById(presetId: string)\n\t{\n\t\tfor (const preset: Preset of this.presets)\n\t\t{\n\t\t\tif (preset.fields.id === presetId)\n\t\t\t{\n\t\t\t\treturn preset;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateInputs(data: TypeModelData)\n\t{\n\t\tif (this.form.querySelector('[name=\"title\"]').value.length <= 0)\n\t\t{\n\t\t\tthis.form.querySelector('[name=\"title\"]').value = data.title || '';\n\t\t}\n\t\tTypeModel.getBooleanFieldNames().forEach((fieldName) => {\n\t\t\tconst node = this.getBooleanFieldNodeByName(fieldName);\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tthis.setBooleanFieldCheckedState(node, data[fieldName]);\n\t\t\t}\n\t\t});\n\t\tthis.disableLinkedUserFieldsIfNotAvailable();\n\t}\n\n\ttoggleBooleanField(fieldName: string): void\n\t{\n\t\tconst node = this.getBooleanFieldNodeByName(fieldName);\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (node.nodeName === 'INPUT')\n\t\t{\n\t\t\tnode.checked = !node.checked;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.toggleClass(node, 'crm-type-field-button-item-active');\n\t\t}\n\t}\n\n\tgetBooleanFieldNodeByName(fieldName: string): ?HTMLDivElement|HTMLInputElement\n\t{\n\t\treturn this.container.querySelector('[data-name=\"' + fieldName + '\"]');\n\t}\n\n\tisBooleanFieldChecked(node: HTMLDivElement|HTMLInputElement): boolean\n\t{\n\t\tif (node.nodeName === 'INPUT')\n\t\t{\n\t\t\treturn node.checked;\n\t\t}\n\n\t\treturn Dom.hasClass(node, 'crm-type-field-button-item-active');\n\t}\n\n\tsetBooleanFieldCheckedState(node: HTMLDivElement|HTMLInputElement, isChecked: boolean): void\n\t{\n\t\tif (node.nodeName === 'INPUT')\n\t\t{\n\t\t\tnode.checked = isChecked;\n\t\t\treturn;\n\t\t}\n\t\tif (isChecked)\n\t\t{\n\t\t\tDom.addClass(node, 'crm-type-field-button-item-active');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(node, 'crm-type-field-button-item-active');\n\t\t}\n\t}\n\n\tinitRelations(): void\n\t{\n\t\tthis.parentRelationsController = new RelationsController({\n\t\t\tswitcher: BX.UI.Switcher.getById('crm-type-relation-parent-switcher'),\n\t\t\tcontainer: this.container.querySelector('[data-role=\"crm-type-relation-parent-items\"]'),\n\t\t\ttypeSelectorContainer: this.container.querySelector('[data-role=\"crm-type-relation-parent-items-selector\"]'),\n\t\t\ttabsContainer: this.container.querySelector('[data-role=\"crm-type-relation-parent-items-tabs\"]'),\n\t\t\ttabsCheckbox: this.container.querySelector('[data-name=\"isRelationParentShowChildrenEnabled\"]'),\n\t\t\ttabsSelectorContainer: this.container.querySelector('[data-role=\"crm-type-relation-parent-items-tabs-selector\"]'),\n\t\t\trelations: this.relations.parent,\n\t\t});\n\n\t\tthis.childRelationsController = new RelationsController({\n\t\t\tswitcher: BX.UI.Switcher.getById('crm-type-relation-child-switcher'),\n\t\t\tcontainer: this.container.querySelector('[data-role=\"crm-type-relation-child-items\"]'),\n\t\t\ttypeSelectorContainer: this.container.querySelector('[data-role=\"crm-type-relation-child-items-selector\"]'),\n\t\t\ttabsContainer: this.container.querySelector('[data-role=\"crm-type-relation-child-items-tabs\"]'),\n\t\t\ttabsCheckbox: this.container.querySelector('[data-name=\"isRelationChildShowChildrenEnabled\"]'),\n\t\t\ttabsSelectorContainer: this.container.querySelector('[data-role=\"crm-type-relation-child-items-tabs-selector\"]'),\n\t\t\trelations: this.relations.child,\n\t\t});\n\t}\n\n\tinitCustomSections()\n\t{\n\t\tif (Type.isArray(this.customSections))\n\t\t{\n\t\t\tthis.customSectionController = new CustomSectionsController({\n\t\t\t\tswitcher: BX.UI.Switcher.getById('crm-type-custom-section-switcher'),\n\t\t\t\tcontainer: this.container.querySelector('[data-role=\"crm-type-custom-section-container\"]'),\n\t\t\t\tselectorContainer: this.container.querySelector('[data-role=\"crm-type-custom-section-selector\"]'),\n\t\t\t\tcustomSections: this.customSections\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic handleLeftMenuClick(tabName: string)\n\t{\n\t\tif (instance)\n\t\t{\n\t\t\tinstance.showTab(tabName);\n\t\t}\n\t}\n\n\tstatic handlePresetClick(presetId: string)\n\t{\n\t\tif (instance)\n\t\t{\n\t\t\tinstance.applyPreset(presetId);\n\t\t}\n\t}\n\n\tstatic handleHideDescriptionClick(target: HTMLDivElement)\n\t{\n\t\ttarget.parentNode.style.display = 'none';\n\t}\n\n\tstatic handleBooleanFieldClick(fieldName: string)\n\t{\n\t\tif (instance)\n\t\t{\n\t\t\tinstance.toggleBooleanField(fieldName);\n\t\t}\n\t}\n\n\tstatic handlePresetSelectorClick()\n\t{\n\t\tif (instance)\n\t\t{\n\t\t\tinstance.enablePresetsView();\n\t\t}\n\t}\n}\n\nnamespace.TypeDetail = TypeDetail;\n\nclass RelationsController\n{\n\tswitcher: BX.UI.Switcher;\n\tcontainer: HTMLDivElement;\n\ttypeSelectorContainer: HTMLDivElement;\n\ttabsContainer: HTMLDivElement;\n\ttabsCheckbox: HTMLInputElement;\n\ttabsSelectorContainer: HTMLDivElement;\n\trelations: Relation[];\n\ttypeSelector: TagSelector;\n\ttabsSelector: TagSelector;\n\n\tconstructor(options)\n\t{\n\t\tthis.switcher = options.switcher;\n\t\tthis.container = options.container;\n\t\tthis.typeSelectorContainer = options.typeSelectorContainer;\n\t\tthis.tabsContainer = options.tabsContainer;\n\t\tthis.tabsCheckbox = options.tabsCheckbox;\n\t\tthis.tabsSelectorContainer = options.tabsSelectorContainer;\n\t\tthis.relations = options.relations;\n\n\t\tthis.initSelectors();\n\n\t\tthis.adjustInitialState();\n\n\t\tthis.bindEvents();\n\n\t\tthis.adjust();\n\t}\n\n\tinitSelectors()\n\t{\n\t\tconst unselectedTypes = [];\n\t\tconst selectedTypes = [];\n\t\tconst unselectedTabs = [];\n\t\tconst selectedTabs = [];\n\t\tthis.relations.forEach((relation: Relation) => {\n\t\t\tconst item = {\n\t\t\t\tid: relation.entityTypeId,\n\t\t\t\tentityId: 'crmType',\n\t\t\t\ttitle: relation.title,\n\t\t\t\ttabs: 'recents',\n\t\t\t};\n\t\t\tif (relation.isChecked)\n\t\t\t{\n\t\t\t\tselectedTypes.push(item);\n\n\t\t\t\tif (relation.isChildrenListEnabled)\n\t\t\t\t{\n\t\t\t\t\tselectedTabs.push(item);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tunselectedTabs.push(item)\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tunselectedTypes.push(item);\n\t\t\t}\n\t\t});\n\n\t\tthis.typeSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\tenableSearch: false,\n\t\t\t\tmultiple: false,\n\t\t\t\titems: unselectedTypes,\n\t\t\t\tselectedItems: selectedTypes,\n\t\t\t\tdropdownMode: true,\n\t\t\t\theight: 200,\n\t\t\t\tshowAvatars: false,\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonAfterTagAdd: this.adjust.bind(this),\n\t\t\t\tonAfterTagRemove: this.adjust.bind(this),\n\t\t\t}\n\t\t});\n\t\tthis.typeSelector.renderTo(this.typeSelectorContainer);\n\n\t\tthis.tabsSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\tenableSearch: false,\n\t\t\t\tmultiple: false,\n\t\t\t\titems: unselectedTabs,\n\t\t\t\tselectedItems: selectedTabs,\n\t\t\t\tdropdownMode: true,\n\t\t\t\theight: 200,\n\t\t\t\tshowAvatars: false,\n\t\t\t},\n\t\t});\n\t\tthis.tabsSelector.renderTo(this.tabsSelectorContainer);\n\t}\n\n\tadjustInitialState()\n\t{\n\t\tconst selectedTypes = this.typeSelector.getDialog().getSelectedItems();\n\t\tif (selectedTypes.length > 0)\n\t\t{\n\t\t\tthis.switcher.check(true);\n\t\t}\n\t\tthis.tabsCheckbox.checked = this.tabsSelector.getDialog().getSelectedItems().length > 0;\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe(this.switcher, 'toggled', this.adjust.bind(this));\n\t\tEvent.bind(this.tabsCheckbox, 'click', this.adjust.bind(this));\n\t}\n\n\tadjust()\n\t{\n\t\tif (!this.switcher.isChecked())\n\t\t{\n\t\t\tDom.addClass(this.container, 'crm-type-hidden');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.container, 'crm-type-hidden');\n\t\t}\n\t\tconst selectedTypes = this.typeSelector.getDialog().getSelectedItems();\n\t\tif (selectedTypes.length > 0)\n\t\t{\n\t\t\tDom.removeClass(this.tabsContainer, 'crm-type-hidden');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.tabsContainer, 'crm-type-hidden');\n\t\t}\n\t\tif (this.tabsCheckbox.checked)\n\t\t{\n\t\t\tDom.removeClass(this.tabsSelectorContainer, 'crm-type-hidden');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.tabsSelectorContainer, 'crm-type-hidden');\n\t\t}\n\n\t\tthis.tabsSelector.getDialog().getItems().forEach((item) => {\n\t\t\tif (!this.isItemSelected(item, selectedTypes))\n\t\t\t{\n\t\t\t\titem.deselect();\n\t\t\t\tthis.tabsSelector.getDialog().removeItem(item);\n\t\t\t\tthis.tabsSelector.removeTag({\n\t\t\t\t\tid: item.getId(),\n\t\t\t\t\tentityId: item.getEntityId()\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tselectedTypes.forEach((item) => {\n\t\t\tconst itemData = {\n\t\t\t\tid: item.getId(),\n\t\t\t\tentityId: item.getEntityId(),\n\t\t\t\ttitle: item.getTitle(),\n\t\t\t\ttabs: 'recents',\n\t\t\t};\n\t\t\tconst tabItem = this.tabsSelector.getDialog().getItem(itemData);\n\t\t\tif (!tabItem)\n\t\t\t{\n\t\t\t\tconst newItem = this.tabsSelector.getDialog().addItem(itemData);\n\t\t\t\tnewItem.select();\n\t\t\t}\n\t\t});\n\t}\n\n\tisItemSelected(item, selectedItems: Array): boolean\n\t{\n\t\treturn selectedItems.filter((selectedItem) => {\n\t\t\treturn item.id === selectedItem.id;\n\t\t}).length > 0;\n\t}\n\n\tgetData()\n\t{\n\t\tconst data = [];\n\t\tif (!this.switcher.isChecked())\n\t\t{\n\t\t\treturn [];\n\t\t}\n\t\tconst isTabsCheckboxChecked = this.tabsCheckbox.checked;\n\t\tconst selectedTypes = this.typeSelector.getDialog().getSelectedItems();\n\t\tselectedTypes.forEach((selectedType) => {\n\t\t\tconst type = {\n\t\t\t\tentityTypeId: selectedType.getId(),\n\t\t\t\tisChildrenListEnabled: false,\n\t\t\t};\n\t\t\tif (\n\t\t\t\tisTabsCheckboxChecked\n\t\t\t\t&& this.isItemSelected(selectedType, this.tabsSelector.getDialog().getSelectedItems())\n\t\t\t)\n\t\t\t{\n\t\t\t\ttype.isChildrenListEnabled = true;\n\t\t\t}\n\t\t\tdata.push(type);\n\t\t});\n\n\t\treturn data;\n\t}\n}\n\nclass CustomSectionsController\n{\n\tswitcher: BX.UI.Switcher;\n\tcontainer: HTMLDivElement;\n\tselectorContainer: HTMLDivElement;\n\tcustomSections: CustomSectionElement[];\n\tselector: TagSelector;\n\tsettingsContainer: HTMLDivElement;\n\tsectionsListContainer: HTMLDivElement;\n\tsaveButton: Element;\n\tcancelButton: Element;\n\taddSectionItemButton: Element;\n\n\tconstructor(options)\n\t{\n\t\tthis.switcher = options.switcher;\n\t\tthis.container = options.container;\n\t\tthis.selectorContainer = options.selectorContainer;\n\t\tthis.customSections = options.customSections;\n\n\t\tthis.initSelector();\n\n\t\tthis.settingsContainer = Tag.render`<div class=\"crm-type-hidden crm-type-custom-sections-settings-container\">\n\t\t\t<div class=\"crm-type-relation-subtitle\">${Loc.getMessage('CRM_TYPE_DETAIL_CUSTOM_SECTION_LIST')}</div>\n\t\t</div>`;\n\t\tthis.container.append(this.settingsContainer);\n\n\t\tthis.adjustInitialState();\n\n\t\tthis.bindEvents();\n\n\t\tthis.adjust();\n\t}\n\n\tinitSelector()\n\t{\n\t\tconst items = [];\n\t\tconst selectedItems = [];\n\n\t\tthis.customSections.forEach((section) => {\n\t\t\tconst item = {\n\t\t\t\tid: section.id,\n\t\t\t\tentityId: 'custom-section',\n\t\t\t\ttitle: section.title,\n\t\t\t\ttabs: 'recents',\n\t\t\t};\n\n\t\t\titems.push(item);\n\n\t\t\tif (section.isSelected)\n\t\t\t{\n\t\t\t\tselectedItems.push(item);\n\t\t\t}\n\t\t});\n\n\t\tthis.selector = new TagSelector({\n\t\t\tshowCreateButton: true,\n\t\t\tcreateButtonCaption: Loc.getMessage('CRM_COMMON_ACTION_CONFIG'),\n\t\t\tmultiple: false,\n\t\t\tdialogOptions: {\n\t\t\t\tenableSearch: false,\n\t\t\t\tmultiple: false,\n\t\t\t\titems,\n\t\t\t\tselectedItems,\n\t\t\t\tdropdownMode: true,\n\t\t\t\theight: 200,\n\t\t\t\tshowAvatars: false,\n\t\t\t\trecentTabOptions: {\n\t\t\t\t\tstub: false,\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\n\t\tthis.selector.subscribe('onCreateButtonClick', this.onCreateButtonClick.bind(this));\n\n\t\tthis.selector.renderTo(this.selectorContainer);\n\t}\n\n\tshowSelector()\n\t{\n\t\tDom.removeClass(this.selectorContainer, 'crm-type-hidden');\n\t}\n\n\thideSelector()\n\t{\n\t\tDom.addClass(this.selectorContainer, 'crm-type-hidden');\n\t}\n\n\tadjustInitialState()\n\t{\n\t\tconst selectedSection = this.selector.getDialog().getSelectedItems();\n\t\tif (selectedSection.length > 0)\n\t\t{\n\t\t\tthis.switcher.check(true);\n\t\t}\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe(this.switcher, 'toggled', this.adjust.bind(this));\n\t}\n\n\tonCreateButtonClick()\n\t{\n\t\tthis.hideSelector();\n\t\tthis.showSectionsList();\n\t}\n\n\trenderSectionsConfig(): HTMLDivElement\n\t{\n\t\tif (!this.sectionsListContainer)\n\t\t{\n\t\t\tthis.sectionsListContainer = Tag.render`<div class=\"crm-type-custom-sections-list-container\"></div>\"`;\n\t\t\tthis.settingsContainer.append(this.sectionsListContainer);\n\t\t}\n\n\t\tthis.renderSectionsList(this.sectionsListContainer);\n\n\t\tif (!this.addSectionItemButton)\n\t\t{\n\t\t\tthis.addSectionItemButton = Tag.render`<div class=\"crm-type-custom-section-add-item-container\">\n\t\t\t\t<span class=\"crm-type-custom-section-add-item-button\" onclick=\"${() => {\n\t\t\t\tthis.sectionsListContainer.append(this.renderSectionItem());\n\t\t\t}}\">${Loc.getMessage('CRM_COMMON_ACTION_ADD')}</span>\n\t\t\t</div>`;\n\t\t\tthis.settingsContainer.append(this.addSectionItemButton);\n\t\t}\n\n\t\tif (!this.buttonsContainer)\n\t\t{\n\t\t\tthis.settingsContainer.append(Tag.render`<hr class=\"crm-type-custom-sections-line\">`);\n\t\t\tthis.buttonsContainer = Tag.render`<div class=\"crm-type-custom-sections-buttons-container\"></div>`;\n\t\t\tthis.settingsContainer.append(this.buttonsContainer);\n\t\t}\n\t\tif (!this.saveButton)\n\t\t{\n\t\t\tthis.saveButton = Tag.render`<span class=\"ui-btn ui-btn-primary\" onclick=\"${this.onSaveConfigHandler.bind(this)}\">${Loc.getMessage('CRM_COMMON_ACTION_SAVE')}</span>`\n\t\t\tthis.buttonsContainer.append(this.saveButton);\n\t\t}\n\t\tif (!this.cancelButton)\n\t\t{\n\t\t\tthis.cancelButton = Tag.render`<span class=\"ui-btn ui-btn-light-border\" onclick=\"${this.onCancelConfigHandler.bind(this)}\">${Loc.getMessage('CRM_COMMON_ACTION_CANCEL')}</span>`\n\t\t\tthis.buttonsContainer.append(this.cancelButton);\n\t\t}\n\t}\n\n\tonSaveConfigHandler(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst selectedSection = this.getSelectedSection();\n\t\tconst newCustomSections = [];\n\t\tArray.from(this.sectionsListContainer.children).forEach((node) => {\n\t\t\tconst idInput = node.querySelector('[name=\"id\"]');\n\t\t\tconst valueInput = node.querySelector('[name=\"value\"]');\n\t\t\tif (!idInput || !valueInput)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst id = idInput.value;\n\t\t\tconst title = valueInput.value;\n\t\t\tlet isSelected = false;\n\t\t\tif (selectedSection && selectedSection.id === id)\n\t\t\t{\n\t\t\t\tisSelected = true;\n\t\t\t}\n\t\t\tif (title)\n\t\t\t{\n\t\t\t\tnewCustomSections.push({\n\t\t\t\t\tid,\n\t\t\t\t\ttitle,\n\t\t\t\t\tisSelected\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.customSections = newCustomSections;\n\n\t\tDom.clean(this.selectorContainer);\n\t\tthis.initSelector();\n\t\tthis.showSelector();\n\n\t\tthis.hideSectionsList();\n\t}\n\n\tonCancelConfigHandler(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tthis.showSelector();\n\t\tthis.hideSectionsList();\n\t}\n\n\trenderSectionsList(listContainer: HTMLDivElement)\n\t{\n\t\tDom.clean(listContainer);\n\t\tthis.customSections.forEach((section) => {\n\t\t\tlistContainer.append(this.renderSectionItem(section));\n\t\t});\n\n\t\tlistContainer.append(this.renderSectionItem());\n\t}\n\n\trenderSectionItem(section: ?CustomSectionElement): HTMLDivElement\n\t{\n\t\tconst item = new CustomSectionItem(section);\n\t\tconst node = Tag.render`<div style=\"margin-bottom: 10px;\" class=\"ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-row\">\n\t\t\t<input type=\"hidden\" name=\"id\" value=\"${item.getId()}\" />\n\t\t\t<input class=\"ui-ctl-element\" name=\"value\" type=\"text\" value=\"${Text.encode(item.getValue())}\">\n\t\t\t<div class=\"crm-type-custom-section-remove-item\" onclick=\"${(event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.sectionsListContainer.removeChild(item.getNode());\n\t\t\t}}\"></div>\n\t\t</div>`;\n\n\t\titem.setNode(node);\n\n\t\treturn node;\n\t}\n\n\tshowSectionsList()\n\t{\n\t\tthis.renderSectionsConfig();\n\t\tDom.removeClass(this.settingsContainer, 'crm-type-hidden');\n\t}\n\n\thideSectionsList()\n\t{\n\t\tDom.clean(this.sectionsListContainer);\n\t\tDom.addClass(this.settingsContainer, 'crm-type-hidden');\n\t}\n\n\tadjust()\n\t{\n\t\tif (!this.switcher.isChecked())\n\t\t{\n\t\t\tDom.addClass(this.container, 'crm-type-hidden');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.container, 'crm-type-hidden');\n\t\t}\n\t}\n\n\tgetSelectedSection(): ?CustomSectionElement\n\t{\n\t\tconst selectedItems = this.selector.getDialog().getSelectedItems();\n\t\tif (selectedItems.length > 0)\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: selectedItems[0].getId(),\n\t\t\t\ttitle: selectedItems[0].getTitle(),\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetData()\n\t{\n\t\tlet data = {};\n\t\tdata.customSectionId = 0;\n\t\tif (this.switcher.isChecked())\n\t\t{\n\t\t\tconst selectedSection = this.getSelectedSection();\n\t\t\tif (selectedSection)\n\t\t\t{\n\t\t\t\tdata.customSectionId = selectedSection.id;\n\t\t\t}\n\t\t}\n\n\t\tdata.customSecions = this.customSections;\n\n\t\treturn data;\n\t}\n}\n\nclass CustomSectionItem\n{\n\tconstructor(customSection: CustomSectionElement = null)\n\t{\n\t\tthis.id = customSection ? customSection.id : 'new_' + Text.getRandom();\n\t\tthis.value = customSection ? customSection.title : '';\n\t}\n\n\tsetNode(node: Element)\n\t{\n\t\tthis.node = node;\n\t}\n\n\tgetId(): ?number\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetNode(): ?Element\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetInput(): ?Element\n\t{\n\t\tconst node = this.getNode();\n\t\tif(!node)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tif(node instanceof HTMLInputElement)\n\t\t{\n\t\t\treturn node;\n\t\t}\n\t\treturn node.querySelector('input');\n\t}\n\n\tgetValue(): string\n\t{\n\t\tconst input = this.getInput();\n\t\tif(input && input.value)\n\t\t{\n\t\t\treturn input.value;\n\t\t}\n\n\t\treturn this.value || '';\n\t}\n}\n"],"names":["namespace","Reflection","instance","TypeDetail","params","Map","Type","isPlainObject","type","isNew","isSaved","form","container","errorsContainer","presets","relations","isArray","customSections","isRestricted","Boolean","saveButton","document","getElementById","cancelButton","deleteButton","bindEvents","fillTabs","getId","enablePresetsView","disablePresetsView","presetSelectorContainer","querySelector","Dom","addClass","removeClass","initRelations","initCustomSections","Event","bind","event","save","passive","delete","userFieldOption","getBooleanFieldNodeByName","disableLinkedUserFieldsIfNotAvailable","querySelectorAll","forEach","linkedUserFieldNode","enableUserFieldIfAnyLinkedChecked","activeTab","presetsTab","commonTab","click","isBooleanFieldChecked","setBooleanFieldCheckedState","loader","Loader","size","isProgress","getLoader","isShown","show","hideErrors","hide","setTimeout","Router","Instance","showFeatureSlider","stopProgress","preventDefault","startProgress","setTitle","value","TypeModel","getBooleanFieldNames","fieldName","fieldNode","data","linkedUserFields","name","dataset","substr","length","replace","setLinkedUserFields","setRelations","parent","parentRelationsController","getData","child","childRelationsController","customSectionController","customSectionData","setCustomSectionId","customSectionId","setCustomSections","customSecions","then","response","afterSave","catch","errors","showErrors","role","entityTypeIds","checkboxes","Array","from","checkbox","checked","push","entityTypeId","addDataToSlider","hasOwnProperty","setUrlTemplates","urlTemplates","slider","getSlider","close","location","href","getTypeDetailUrl","getEntityTypeId","emitTypeUpdatedEvent","getClass","BX","SidePanel","getSliderByWindow","window","Crm","ToolbarComponent","toolbar","getToolbarComponent","key","isString","set","text","message","isDomNode","innerText","parentNode","style","display","console","error","MessageBox","confirm","Loc","getMessage","Promise","resolve","listUrl","getTypeListUrl","toString","box","tabNode","tab","tabs","tabNameToShow","keys","tabName","get","classList","add","remove","presetId","presetSelector","currentPresetNode","currentPreset","getPresetById","title","presetNode","preset","updateInputs","textContent","Text","encode","fields","id","node","nodeName","toggleClass","hasClass","isChecked","RelationsController","switcher","UI","Switcher","getById","typeSelectorContainer","tabsContainer","tabsCheckbox","tabsSelectorContainer","CustomSectionsController","selectorContainer","showTab","applyPreset","target","toggleBooleanField","options","initSelectors","adjustInitialState","adjust","unselectedTypes","selectedTypes","unselectedTabs","selectedTabs","relation","item","entityId","isChildrenListEnabled","typeSelector","TagSelector","dialogOptions","enableSearch","multiple","items","selectedItems","dropdownMode","height","showAvatars","events","onAfterTagAdd","onAfterTagRemove","renderTo","tabsSelector","getDialog","getSelectedItems","check","EventEmitter","subscribe","getItems","isItemSelected","deselect","removeItem","removeTag","getEntityId","itemData","getTitle","tabItem","getItem","newItem","addItem","select","filter","selectedItem","isTabsCheckboxChecked","selectedType","initSelector","settingsContainer","Tag","render","append","section","isSelected","selector","showCreateButton","createButtonCaption","recentTabOptions","stub","onCreateButtonClick","selectedSection","hideSelector","showSectionsList","sectionsListContainer","renderSectionsList","addSectionItemButton","renderSectionItem","buttonsContainer","onSaveConfigHandler","onCancelConfigHandler","getSelectedSection","newCustomSections","children","idInput","valueInput","clean","showSelector","hideSectionsList","listContainer","CustomSectionItem","getValue","removeChild","getNode","setNode","renderSectionsConfig","customSection","getRandom","HTMLInputElement","input","getInput"],"mappings":"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"}