{"version":3,"file":"script.js","sources":["src/submit.js","src/self-register.js","src/phone.js","src/row.js","src/selector.js","src/active-directory.js","src/analytics.js","src/form.js"],"sourcesContent":["import {Type, Validation, Loc, Dom, Event} from \"main.core\";\nimport {EventEmitter} from \"main.core.events\";\n\nexport class Submit extends EventEmitter\n{\n\tconstructor(parent)\n\t{\n\t\tsuper();\n\t\tthis.parent = parent;\n\t\tthis.setEventNamespace(\"BX.Intranet.Invitation.Submit\");\n\t\tthis.parent.subscribe(\"onButtonClick\", (event) => {});\n\t}\n\n\tparseEmailAndPhone(form)\n\t{\n\t\tif (!Type.isDomNode(form))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet errorInputData = [];\n\t\tlet items = [];\n\t\tconst phoneExp = /^[\\d+][\\d\\(\\)\\ -]{4,22}\\d$/;\n\t\tconst rows = Array.prototype.slice.call(form.querySelectorAll(\".js-form-row\"));\n\n\t\t(rows || []).forEach((row) => {\n\t\t\tconst emailInput = row.querySelector(\"input[name='EMAIL[]']\");\n\t\t\tconst phoneInput = row.querySelector(\"input[name='PHONE[]']\");\n\t\t\tconst nameInput = row.querySelector(\"input[name='NAME[]']\");\n\t\t\tconst lastNameInput = row.querySelector(\"input[name='LAST_NAME[]']\");\n\t\t\tconst emailValue = emailInput.value.trim();\n\n\t\t\tif (this.parent.isInvitationBySmsAvailable && Type.isDomNode(phoneInput))\n\t\t\t{\n\t\t\t\tconst phoneValue = phoneInput.value.trim();\n\t\t\t\tif (phoneValue)\n\t\t\t\t{\n\t\t\t\t\tif (!phoneExp.test(String(phoneValue).toLowerCase()))\n\t\t\t\t\t{\n\t\t\t\t\t\terrorInputData.push(phoneValue);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst phoneCountryInput = row.querySelector(\"input[name='PHONE_COUNTRY[]']\");\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t\"PHONE\": phoneValue,\n\t\t\t\t\t\t\t\"PHONE_COUNTRY\": phoneCountryInput.value.trim(),\n\t\t\t\t\t\t\t\"NAME\": nameInput.value,\n\t\t\t\t\t\t\t\"LAST_NAME\": lastNameInput.value\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (emailValue)\n\t\t\t{\n\t\t\t\tif (Validation.isEmail(emailValue))\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\t\"EMAIL\": emailValue,\n\t\t\t\t\t\t\"NAME\": nameInput.value,\n\t\t\t\t\t\t\"LAST_NAME\": lastNameInput.value\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\terrorInputData.push(emailValue);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn [items, errorInputData];\n\t}\n\n\tgetGroupAndDepartmentData(requestData)\n\t{\n\t\tconst selector = this.parent.selector;\n\t\tconst selectorItems = selector.getItems();\n\n\t\tif (selectorItems[\"departments\"].length > 0)\n\t\t{\n\t\t\trequestData[\"UF_DEPARTMENT\"] = selectorItems[\"departments\"];\n\t\t}\n\n\t\tif (selectorItems[\"projects\"].length > 0)\n\t\t{\n\t\t\trequestData[\"SONET_GROUPS_CODE\"] = selectorItems[\"projects\"];\n\t\t}\n\t}\n\n\tsubmitInvite()\n\t{\n\t\tconst inviteForm = this.parent.contentBlocks[\"invite\"].querySelector(\"form\");\n\t\tlet [items, errorInputData] = [...this.parseEmailAndPhone(inviteForm)];\n\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {error: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR\") + \": \" + errorInputData.join(', ')}});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {error: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR\")}});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tconst requestData = {\n\t\t\t\"ITEMS\": items\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"invite\",\n\t\t\t\"INVITATION_COUNT\": items.length\n\t\t};\n\n\t\tthis.sendAction(\"invite\", requestData, analyticsLabel);\n\t}\n\n\tsubmitInviteWithGroupDp()\n\t{\n\t\tconst inviteWithGroupDpForm = this.parent.contentBlocks[\"invite-with-group-dp\"].querySelector(\"form\");\n\t\tlet [items, errorInputData] = [...this.parseEmailAndPhone(inviteWithGroupDpForm)];\n\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\tthis.parent.showErrorMessage(Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR\") + \": \" + errorInputData.join(', '));\n\t\t\treturn;\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {\n\t\t\t\terror: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR\")}\n\t\t\t});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tlet requestData = {\n\t\t\t\"ITEMS\": items\n\t\t};\n\t\tthis.getGroupAndDepartmentData(requestData);\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"withGroupOrDepartment\",\n\t\t\t\"INVITATION_COUNT\": items.length\n\t\t};\n\n\t\tthis.sendAction(\"inviteWithGroupDp\", requestData, analyticsLabel);\n\t}\n\n\tsubmitSelf()\n\t{\n\t\tconst selfForm = this.parent.contentBlocks[\"self\"].querySelector(\"form\");\n\t\tlet obRequestData = {\n\t\t\t\"allow_register\": selfForm[\"allow_register\"].value,\n\t\t\t\"allow_register_confirm\": selfForm[\"allow_register_confirm\"].checked ? \"Y\" : \"N\",\n\t\t\t\"allow_register_secret\": selfForm[\"allow_register_secret\"].value,\n\t\t\t\"allow_register_whitelist\": selfForm[\"allow_register_whitelist\"].value,\n\t\t};\n\n\t\tthis.sendAction(\"self\", obRequestData);\n\t}\n\n\tsubmitExtranet()\n\t{\n\t\tconst extranetForm = this.parent.contentBlocks[\"extranet\"].querySelector(\"form\");\n\t\tlet [items, errorInputData] = [...this.parseEmailAndPhone(extranetForm)];\n\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\tthis.parent.showErrorMessage(Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR\") + \": \" + errorInputData.join(', '));\n\t\t\treturn;\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {\n\t\t\t\terror: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR\")}\n\t\t\t});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tlet requestData = {\n\t\t\t\"ITEMS\": items\n\t\t};\n\t\tthis.getGroupAndDepartmentData(requestData);\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"extranet\",\n\t\t\t\"INVITATION_COUNT\": items.length\n\t\t};\n\n\t\tthis.sendAction(\"extranet\", requestData, analyticsLabel);\n\t}\n\n\tsubmitIntegrator()\n\t{\n\t\tconst integratorForm = this.parent.contentBlocks[\"integrator\"].querySelector(\"form\");\n\n\t\tconst obRequestData = {\n\t\t\t\"integrator_email\": integratorForm[\"integrator_email\"].value,\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"integrator\"\n\t\t};\n\n\t\tthis.sendAction(\"inviteIntegrator\", obRequestData, analyticsLabel);\n\t}\n\n\tsubmitMassInvite()\n\t{\n\t\tconst massInviteForm = this.parent.contentBlocks[\"mass-invite\"].querySelector(\"form\");\n\n\t\tconst obRequestData = {\n\t\t\t\"ITEMS\": massInviteForm[\"mass_invite_emails\"].value\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"mass\"\n\t\t};\n\t\tthis.sendAction(\"massInvite\", obRequestData, analyticsLabel);\n\t}\n\n\tsubmitAdd()\n\t{\n\t\tconst addForm = this.parent.contentBlocks[\"add\"].querySelector(\"form\");\n\n\t\tlet requestData = {\n\t\t\t\"ADD_EMAIL\": addForm[\"ADD_EMAIL\"].value,\n\t\t\t\"ADD_NAME\": addForm[\"ADD_NAME\"].value,\n\t\t\t\"ADD_LAST_NAME\": addForm[\"ADD_LAST_NAME\"].value,\n\t\t\t\"ADD_POSITION\": addForm[\"ADD_POSITION\"].value,\n\t\t\t\"ADD_SEND_PASSWORD\": (\n\t\t\t\taddForm[\"ADD_SEND_PASSWORD\"]\n\t\t\t\t&& !!addForm[\"ADD_SEND_PASSWORD\"].checked\n\t\t\t\t\t? addForm[\"ADD_SEND_PASSWORD\"].value\n\t\t\t\t\t: \"N\"\n\t\t\t),\n\t\t};\n\t\tthis.getGroupAndDepartmentData(requestData);\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"add\"\n\t\t};\n\t\tthis.sendAction(\"add\", requestData, analyticsLabel);\n\t}\n\n\tsendAction(action, requestData, analyticsLabel)\n\t{\n\t\tthis.disableSubmitButton(true);\n\t\trequestData[\"userOptions\"] = this.parent.userOptions;\n\t\trequestData[\"analyticsData\"] = this.parent.analyticsLabel;\n\n\t\tBX.ajax.runComponentAction(this.parent.componentName, action, {\n\t\t\tsignedParameters: this.parent.signedParameters,\n\t\t\tmode: \"ajax\",\n\t\t\tdata: requestData,\n\t\t\tanalyticsLabel: analyticsLabel,\n\t\t}).then((response) => {\n\n\t\t\tthis.disableSubmitButton(false);\n\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tif (action === \"self\")\n\t\t\t\t{\n\t\t\t\t\tthis.parent.showSuccessMessage(response.data);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.parent.changeContent(\"success\");\n\t\t\t\t\tthis.sendSuccessEvent(response.data);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}, (response) => {\n\n\t\t\tthis.disableSubmitButton(false);\n\n\t\t\tif (response.data == \"user_limit\")\n\t\t\t{\n\t\t\t\tB24.licenseInfoPopup.show(\n\t\t\t\t\t\"featureID\",\n\t\t\t\t\tBX.message(\"BX24_INVITE_DIALOG_USERS_LIMIT_TITLE\"),\n\t\t\t\t\tBX.message(\"BX24_INVITE_DIALOG_USERS_LIMIT_TEXT\")\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.parent.showErrorMessage(response.errors[0].message);\n\t\t\t}\n\t\t});\n\t}\n\n\tdisableSubmitButton(isDisable)\n\t{\n\t\tconst button = this.parent.button;\n\n\t\tif (!Type.isDomNode(button) || !Type.isBoolean(isDisable))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (isDisable)\n\t\t{\n\t\t\tDom.addClass(button, [\"ui-btn-wait\", \"invite-cursor-auto\"]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(button, [\"ui-btn-wait\", \"invite-cursor-auto\"]);\n\t\t}\n\t}\n\n\tsendSuccessEvent(users)\n\t{\n\t\tBX.SidePanel.Instance.postMessageAll(window, \"BX.Intranet.Invitation:onAdd\", { users: users });\n\t}\n}","import {Event, Type, Dom, Text, Loc} from \"main.core\";\nimport {Switcher} from 'ui.switcher';\n\nexport class SelfRegister\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\n\t\tif (Type.isDomNode(this.parent.contentBlocks[\"self\"]))\n\t\t{\n\t\t\tthis.selfBlock = this.parent.contentBlocks[\"self\"];\n\t\t\tthis.bindActions();\n\n\t\t\tconst switcherNode = this.selfBlock.querySelector('.invite-dialog-fast-reg-control-switcher');\n\t\t\tthis.switcher = new Switcher({\n\t\t\t\tinputName: 'allow_register',\n\t\t\t\tid: 'allow_register',\n\t\t\t\tchecked: parent.isSelfRegisterEnabled,\n\t\t\t\tnode: switcherNode,\n\t\t\t\thandlers: {\n\t\t\t\t\ttoggled: this.toggleSettings.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\n\tbindActions()\n\t{\n\t\tconst regenerateButton = this.selfBlock.querySelector(\"[data-role='selfRegenerateSecretButton']\");\n\t\tif (Type.isDomNode(regenerateButton))\n\t\t{\n\t\t\tEvent.bind(regenerateButton, 'click',() => {\n\t\t\t\tthis.parent.activateButton();\n\t\t\t\tthis.regenerateSecret(this.parent.regenerateUrlBase);\n\t\t\t});\n\t\t}\n\n\t\tconst copyRegisterUrlButton = this.selfBlock.querySelector(\"[data-role='copyRegisterUrlButton']\");\n\t\tif (Type.isDomNode(copyRegisterUrlButton))\n\t\t{\n\t\t\tEvent.bind(copyRegisterUrlButton, 'click', () => {\n\t\t\t\tthis.copyRegisterUrl();\n\t\t\t});\n\t\t}\n\n\t\tconst allowRegisterConfirm = this.selfBlock.querySelector(\"[data-role='allowRegisterConfirm']\");\n\t\tif (Type.isDomNode(allowRegisterConfirm))\n\t\t{\n\t\t\tEvent.bind(allowRegisterConfirm, 'change', () => {\n\t\t\t\tthis.parent.activateButton();\n\t\t\t\tthis.toggleWhiteList(allowRegisterConfirm);\n\t\t\t});\n\t\t}\n\n\t\tconst selfWhiteList = this.selfBlock.querySelector(\"[data-role='selfWhiteList']\");\n\t\tif (Type.isDomNode(selfWhiteList))\n\t\t{\n\t\t\tEvent.bind(selfWhiteList, 'input', () => {\n\t\t\t\tthis.parent.activateButton();\n\t\t\t});\n\t\t}\n\t}\n\n\tregenerateSecret(registerUrl)\n\t{\n\t\tconst value = Text.getRandom(8);\n\n\t\tconst allowRegisterSecretNode = this.selfBlock.querySelector(\"[data-role='allowRegisterSecret']\");\n\t\tif (Type.isDomNode(allowRegisterSecretNode))\n\t\t{\n\t\t\tallowRegisterSecretNode.value = value || '';\n\t\t}\n\n\t\tconst allowRegisterUrlNode = this.selfBlock.querySelector(\"[data-role='allowRegisterUrl']\");\n\t\tif (Type.isDomNode(allowRegisterUrlNode) && registerUrl)\n\t\t{\n\t\t\tallowRegisterUrlNode.value = registerUrl + (value || 'yes');\n\t\t}\n\t}\n\n\tcopyRegisterUrl()\n\t{\n\t\tconst allowRegisterUrlNode = this.selfBlock.querySelector(\"[data-role='allowRegisterUrl']\");\n\t\tif (Type.isDomNode(allowRegisterUrlNode))\n\t\t{\n\t\t\tBX.clipboard.copy(allowRegisterUrlNode.value);\n\t\t\tthis.showHintPopup(Loc.getMessage(\"BX24_INVITE_DIALOG_COPY_URL\"), allowRegisterUrlNode);\n\n\t\t\tBX.ajax.runAction('intranet.controller.invite.copyregisterurl', {\n\t\t\t\tdata: {}\n\t\t\t}).then(function (response) {}, function (response) {});\n\n\t\t\tthis.parent.analytics.send();\n\t\t}\n\t}\n\n\tshowHintPopup(message, bindNode)\n\t{\n\t\tif (!Type.isDomNode(bindNode) || !message)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnew BX.PopupWindow('inviteHint' + Text.getRandom(8), bindNode, {\n\t\t\tcontent: message,\n\t\t\tzIndex: 15000,\n\t\t\tangle: true,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: 50,\n\t\t\tcloseIcon: false,\n\t\t\tautoHide: true,\n\t\t\tdarkMode: true,\n\t\t\toverlay: false,\n\t\t\tmaxWidth: 400,\n\t\t\tevents: {\n\t\t\t\tonAfterPopupShow: function () {\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t}.bind(this), 4000);\n\t\t\t\t}\n\t\t\t}\n\t\t}).show();\n\t}\n\n\ttoggleSettings()\n\t{\n\t\tthis.parent.activateButton();\n\t\tconst controlBlock = this.selfBlock.querySelector(\".js-invite-dialog-fast-reg-control-container\");\n\t\tif (Type.isDomNode(controlBlock))\n\t\t{\n\t\t\tif (!Dom.hasClass(controlBlock, 'disallow-registration'))\n\t\t\t{\n\t\t\t\tconst switcher = controlBlock.querySelector(\"[data-role='self-switcher']\");\n\t\t\t\tthis.showHintPopup(Loc.getMessage(\"INTRANET_INVITE_DIALOG_SELF_OFF_HINT\"), switcher);\n\t\t\t}\n\t\t\tDom.toggleClass(controlBlock, 'disallow-registration');\n\t\t}\n\n\t\tconst settingsBlock = this.selfBlock.querySelector(\"[data-role='selfSettingsBlock']\");\n\t\tif (Type.isDomNode(settingsBlock))\n\t\t{\n\t\t\tDom.style(settingsBlock, 'display', this.switcher.checked ? 'block' : 'none');\n\t\t}\n\t}\n\n\ttoggleWhiteList(inputElement)\n\t{\n\t\tconst selfWhiteList = this.selfBlock.querySelector(\"[data-role='selfWhiteList']\");\n\t\tif (Type.isDomNode(selfWhiteList))\n\t\t{\n\t\t\tDom.style(selfWhiteList, 'display', inputElement.checked ? 'block' : 'none');\n\t\t}\n\t}\n}","import {Dom, Type, Tag, Event} from \"main.core\";\n\nexport class Phone\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\n\t\tthis.count = 0;\n\t\tthis.index = 0;\n\t\tthis.maxCount = 5;\n\t\tthis.inputStack = [];\n\t}\n\n\trenderPhoneRow(inputNode)\n\t{\n\t\tif(this.count >= this.maxCount)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isDomNode(inputNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst num = inputNode.getAttribute(\"data-num\");\n\n\t\tif (inputNode.parentNode.querySelector(\"#phone_number_\" + num))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = Tag.render`\n\t\t\t<span style=\"z-index: 3;\" class=\"ui-ctl-before\" data-role=\"phone-block\">\n\t\t\t\t<input type=\"hidden\" name=\"PHONE_COUNTRY[]\" id=\"phone_country_${num}\" value=\"\">\n\t\t\t\t<input type=\"hidden\" name=\"PHONE[]\" id=\"phone_number_${num}\" value=\"\">\n\t\t\t\t<div class=\"invite-dialog-phone-flag-block\" data-role=\"flag\">\n\t\t\t\t\t<span data-role=\"phone_flag_${num}\" style=\"pointer-events: none;\"></span>\n\t\t\t\t</div>\n\t\t\t\t<input class=\"invite-dialog-phone-input\" type=\"hidden\" id=\"phone_input_${num}\" value=\"\">&nbsp;\n\t\t\t</span>\n\t\t`;\n\n\t\tinputNode.style.paddingLeft = \"57px\";\n\t\tDom.append(element, inputNode.parentNode);\n\n\t\tconst flagNode = inputNode.parentNode.querySelector(\"[data-role='flag']\");\n\t\tif (Type.isDomNode(flagNode))\n\t\t{\n\t\t\tEvent.bind(inputNode.parentNode.querySelector(\"[data-role='flag']\"), 'click', () => {\n\t\t\t\tthis.showCountrySelector(num);\n\t\t\t});\n\t\t}\n\n\t\tlet changeCallback = function(i, inputNode)\n\t\t{\n\t\t\treturn function(e)\n\t\t\t{\n\t\t\t\tinputNode.parentNode.querySelector('#phone_number_' + i).value = e.value;\n\t\t\t\tinputNode.parentNode.querySelector('#phone_country_' + i).value = e.country;\n\t\t\t}\n\t\t};\n\n\t\tthis.inputStack[num] = new BX.PhoneNumber.Input({\n\t\t\tnode: inputNode,\n\t\t\tflagNode: inputNode.parentNode.querySelector(\"[data-role='phone_flag_\"+ num +\"']\"),\n\t\t\tflagSize: 16,\n\t\t\tonChange: changeCallback(num, inputNode)\n\t\t});\n\n\t\t//for ctrl+v paste\n\t\tconst id = setInterval(() => {\n\t\t\tif (\n\t\t\t\t!inputNode.parentNode?.querySelector('#phone_number_' + num).value\n\t\t\t\t|| !inputNode.parentNode?.querySelector('#phone_country_' + num).value\n\t\t\t)\n\t\t\t{\n\t\t\t\tchangeCallback(num, inputNode)({\n\t\t\t\t\tvalue: this.inputStack[num].getValue(),\n\t\t\t\t\tcountry: this.inputStack[num].formatter ? this.inputStack[num].getCountry() : null,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclearInterval(id);\n\t\t\t}\n\t\t}, 1000);\n\t}\n\n\tshowCountrySelector(i)\n\t{\n\t\tthis.inputStack[i]._onFlagClick();\n\t}\n}","import {Event, Type, Dom, Tag, Loc} from \"main.core\";\nimport {Phone} from \"./phone\";\n\nexport class Row\n{\n\tconstructor(parent, params)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.contentBlock = params.contentBlock;\n\t\tthis.inputNum = 0;\n\n\t\tif (Type.isDomNode(this.contentBlock))\n\t\t{\n\t\t\tthis.rowsContainer = this.contentBlock.querySelector(\"[data-role='rows-container']\");\n\t\t\tthis.bindActions();\n\t\t}\n\n\t\tif (this.parent.isInvitationBySmsAvailable)\n\t\t{\n\t\t\tthis.phoneObj = new Phone(this);\n\t\t}\n\t}\n\n\tbindActions()\n\t{\n\t\tconst moreButton = this.contentBlock.querySelector(\"[data-role='invite-more']\");\n\t\tif (Type.isDomNode(moreButton))\n\t\t{\n\t\t\tEvent.unbindAll(moreButton);\n\t\t\tEvent.bind(moreButton, 'click', () => {\n\t\t\t\tthis.renderInputRow();\n\t\t\t});\n\t\t}\n\n\t\tconst massInviteButton = this.contentBlock.querySelector(\"[data-role='invite-mass']\");\n\t\tif (Type.isDomNode(massInviteButton))\n\t\t{\n\t\t\tEvent.unbindAll(massInviteButton);\n\t\t\tEvent.bind(massInviteButton, 'click', () => {\n\t\t\t\tconst massMenuNode = document.querySelector(\"[data-role='menu-mass-invite']\");\n\t\t\t\tif (Type.isDomNode(massMenuNode))\n\t\t\t\t{\n\t\t\t\t\tBX.fireEvent(massMenuNode, 'click');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckPhoneInput(element)\n\t{\n\t\tconst phoneExp = /^[\\d+][\\d\\(\\)\\ -]{2,14}\\d$/;\n\n\t\tif (element.value && phoneExp.test(String(element.value).toLowerCase()))\n\t\t{\n\t\t\tthis.phoneObj.renderPhoneRow(element);\n\t\t}\n\t}\n\n\tbindPhoneChecker(element)\n\t{\n\t\tif (this.parent.isInvitationBySmsAvailable && Type.isDomNode(element))\n\t\t{\n\t\t\tconst inputNodes = Array.prototype.slice.call(element.querySelectorAll(\".js-email-phone-input\"));\n\t\t\tif (inputNodes)\n\t\t\t{\n\t\t\t\tinputNodes.forEach(element => {\n\t\t\t\t\tEvent.bind(element, 'input', () => {\n\t\t\t\t\t\tthis.checkPhoneInput(element);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tbindCloseIcons(container)\n\t{\n\t\tconst inputNodes = Array.prototype.slice.call(container.querySelectorAll(\"input\"));\n\n\t\t(inputNodes || []).forEach((node) => {\n\t\t\tlet closeIcon = node.nextElementSibling;\n\n\t\t\tEvent.bind(node, 'input', () => {\n\t\t\t\tDom.style(closeIcon, 'display', node.value !== \"\" ? \"block\" : \"none\");\n\t\t\t});\n\n\t\t\tEvent.bind(closeIcon, 'click', (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tnode.value = \"\";\n\n\t\t\t\tif (Type.isDomNode(node.parentNode))\n\t\t\t\t{\n\t\t\t\t\tconst phoneBlock = node.parentNode.querySelector(\"[data-role='phone-block']\");\n\t\t\t\t\tif (Type.isDomNode(phoneBlock))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst newInput = Tag.render`\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tname=\"EMAIL[]\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\t\t\t\tdata-num=\"${node.getAttribute('data-num')}\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element js-email-phone-input\"\n\t\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT')}\"\n\t\t\t\t\t\t\t/>`;\n\n\t\t\t\t\t\tDom.replace(node, newInput);\n\t\t\t\t\t\tthis.bindCloseIcons(newInput.parentNode);\n\t\t\t\t\t\tthis.bindPhoneChecker(newInput.parentNode);\n\t\t\t\t\t\tDom.remove(phoneBlock);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tDom.style(closeIcon, 'display', \"none\");\n\t\t\t});\n\t\t});\n\t}\n\n\trenderInviteInputs(numRows = 3)\n\t{\n\t\tDom.clean(this.rowsContainer);\n\t\tfor (let i = 0; i < numRows; i++)\n\t\t{\n\t\t\tthis.renderInputRow(i === 0);\n\t\t}\n\t}\n\n\trenderInputRow(showTitles = false)\n\t{\n\t\tlet emailTitle, nameTitle, lastNameTitle;\n\n\t\tif (showTitles)\n\t\t{\n\t\t\temailTitle = `\n\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t${Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT\")}\n\t\t\t\t</div>`;\n\n\t\t\tnameTitle = `\n\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_NAME_TITLE\")}\n\t\t\t\t</div>`;\n\n\t\t\tlastNameTitle = `\n\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE\")}\n\t\t\t\t</div>`;\n\n\t\t}\n\n\t\tconst element = Tag.render`\n\t\t\t<div class=\"invite-form-row js-form-row\">\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? emailTitle: ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\tname=\"EMAIL[]\" \n\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\t\t\tdata-num=\"${this.inputNum++}\" \n\t\t\t\t\t\t\tclass=\"ui-ctl-element js-email-phone-input\" \n\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT')}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? nameTitle: ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input name=\"NAME[]\" type=\"text\" class=\"ui-ctl-element\" placeholder=\"${Loc.getMessage('BX24_INVITE_DIALOG_ADD_NAME_TITLE')}\">\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? lastNameTitle: ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input name=\"LAST_NAME[]\" type=\"text\" class=\"ui-ctl-element\" placeholder=\"${Loc.getMessage('BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE')}\">\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(element, this.rowsContainer);\n\t\tthis.bindCloseIcons(element);\n\t\tthis.bindPhoneChecker(element);\n\t}\n\n\trenderRegisterInputs()\n\t{\n\t\tDom.clean(this.rowsContainer);\n\t\tconst element = Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_NAME_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_NAME\" id=\"ADD_NAME\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_LAST_NAME\" id=\"ADD_LAST_NAME\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_EMAIL_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_EMAIL\" id=\"ADD_EMAIL\" class=\"ui-ctl-element\" maxlength=\"50\">\n\t\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_POSITION_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_POSITION\" id=\"ADD_POSITION\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(element, this.rowsContainer);\n\t\tthis.bindCloseIcons(element);\n\t}\n\n\trenderIntegratorInput()\n\t{\n\t\tDom.clean(this.rowsContainer);\n\t\tconst element = Tag.render`\n\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"INTRANET_INVITE_DIALOG_INTEGRATOR_EMAIL\")}</div>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\tclass=\"ui-ctl-element\" \n\t\t\t\t\t\t\tvalue=\"\" \n\t\t\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\t\t\tname=\"integrator_email\" \n\t\t\t\t\t\t\tid=\"integrator_email\" \n\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage(\"INTRANET_INVITE_DIALOG_INTEGRATOR_EMAIL\")}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(element, this.rowsContainer);\n\t\tthis.bindCloseIcons(element);\n\t}\n}","import {Type, Dom} from \"main.core\";\nimport {TagSelector} from 'ui.entity-selector';\n\nexport class Selector\n{\n\tconstructor(parent, params)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.contentBlock = params.contentBlock;\n\t\tthis.options = params.options;\n\t\tthis.entities = [];\n\n\t\tthis.prepareOptions();\n\t}\n\n\tprepareOptions()\n\t{\n\t\tfor (let type in this.options)\n\t\t{\n\t\t\tif (!this.options.hasOwnProperty(type))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (type === \"department\" && !!this.options[type])\n\t\t\t{\n\t\t\t\tthis.entities.push({\n\t\t\t\t\tid: \"department\",\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselectMode: \"departmentsOnly\",\n\t\t\t\t\t\tallowOnlyUserDepartments: !(!!this.options[\"isAdmin\"] && this.options[\"isAdmin\"] === true),\n\t\t\t\t\t\tallowSelectRootDepartment: true,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (type === \"project\" && !!this.options[type])\n\t\t\t{\n\t\t\t\tlet optionValue = {\n\t\t\t\t\tid: \"project\",\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tfillRecentTab: true\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif (this.options[type] === \"extranet\")\n\t\t\t\t{\n\t\t\t\t\toptionValue[\"options\"][\"extranet\"] = true;\n\t\t\t\t}\n\t\t\t\tthis.entities.push(optionValue);\n\t\t\t}\n\t\t}\n\t}\n\n\trender()\n\t{\n\t\tconst preselectedItems = [];\n\n\t\tif (\n\t\t\tthis.options.hasOwnProperty('projectId')\n\t\t\t&& this.options.projectId > 0\n\t\t)\n\t\t{\n\t\t\tpreselectedItems.push(['project', this.options.projectId])\n\t\t}\n\n\t\tthis.tagSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\tpreselectedItems: preselectedItems,\n\t\t\t\tentities: this.entities,\n\t\t\t\tcontext: 'INTRANET_INVITATION'\n\t\t\t}\n\t\t});\n\n\t\tif (Type.isDomNode(this.contentBlock))\n\t\t{\n\t\t\tDom.clean(this.contentBlock);\n\t\t\tthis.tagSelector.renderTo(this.contentBlock);\n\t\t}\n\t}\n\n\tgetItems()\n\t{\n\t\tlet departments = [];\n\t\tlet projects = [];\n\t\tconst tagSelectorItems = this.tagSelector.getDialog().getSelectedItems();\n\n\t\ttagSelectorItems.forEach(item => {\n\t\t\tconst id = parseInt(item.getId());\n\t\t\tconst type = item.getEntityId();\n\n\t\t\tif (type === \"department\")\n\t\t\t{\n\t\t\t\tdepartments.push(id);\n\t\t\t}\n\t\t\telse if (type === \"project\")\n\t\t\t{\n\t\t\t\tprojects.push(id);\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\tdepartments: departments,\n\t\t\tprojects: projects\n\t\t};\n\t}\n}","export class ActiveDirectory\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\t}\n\n\tshowForm()\n\t{\n\t\tBX.UI.Feedback.Form.open(\n\t\t\t{\n\t\t\t\tid: 'intranet-active-directory',\n\t\t\t\tdefaultForm: {id: 309, sec: 'fbc0n3'}\n\t\t\t}\n\t\t);\n\t}\n}","import { Event, Type } from 'main.core';\nimport { sendData } from 'ui.analytics';\n\nexport class Analytics\n{\n\tstatic TOOLS = 'Invitation';\n\tstatic CATEGORY_INVITATION = 'invitation';\n\tstatic EVENT_COPY = 'copy_invitation_link';\n\tstatic ADMIN_ALLOW_MODE_Y = 'askAdminToAllow_Y';\n\tstatic ADMIN_ALLOW_MODE_N = 'askAdminToAllow_N';\n\tstatic IS_ADMIN_Y = 'isAdmin_Y';\n\tstatic IS_ADMIN_N = 'isAdmin_N';\n\n\t#cSection: Object;\n\t#isAdmin: boolean;\n\n\tconstructor(cSection: Object, isAdmin: boolean)\n\t{\n\t\tthis.#cSection = cSection;\n\t\tthis.#isAdmin = isAdmin;\n\t}\n\n\t#getAdminAllowMode(): string\n\t{\n\t\treturn document.querySelector('#allow_register_confirm').checked\n\t\t\t? Analytics.ADMIN_ALLOW_MODE_Y\n\t\t\t: Analytics.ADMIN_ALLOW_MODE_N;\n\t}\n\n\t#getIsAdmin(): string\n\t{\n\t\treturn this.#isAdmin ? Analytics.IS_ADMIN_Y : Analytics.IS_ADMIN_N;\n\t}\n\n\t#getCSection(): string\n\t{\n\t\treturn this.#cSection.source;\n\t}\n\n\tsend(): void\n\t{\n\t\tsendData({\n\t\t\ttool: Analytics.TOOLS,\n\t\t\tcategory: Analytics.CATEGORY_INVITATION,\n\t\t\tevent: Analytics.EVENT_COPY,\n\t\t\tc_section: this.#getCSection(),\n\t\t\tp1: this.#getIsAdmin(),\n\t\t\tp2: this.#getAdminAllowMode(),\n\t\t});\n\t}\n}","import {Type, Dom, Event, Loc} from 'main.core';\nimport {Submit} from './submit';\nimport {SelfRegister} from './self-register';\nimport {Row} from \"./row\";\nimport {Selector} from \"./selector\";\nimport {EventEmitter} from \"main.core.events\";\nimport {ActiveDirectory} from \"./active-directory\";\nimport { Analytics } from './analytics';\n\nexport default class Form extends EventEmitter\n{\n\tconstructor(formParams)\n\t{\n\t\tsuper();\n\t\tconst params = Type.isPlainObject(formParams) ? formParams : {};\n\n\t\tthis.signedParameters = params.signedParameters;\n\t\tthis.componentName = params.componentName;\n\n\t\tthis.menuContainer = params.menuContainerNode;\n\t\tthis.contentContainer = params.contentContainerNode;\n\t\tthis.contentBlocks = {};\n\t\tthis.userOptions = params.userOptions;\n\n\t\tthis.isExtranetInstalled = params.isExtranetInstalled === \"Y\";\n\t\tthis.isCloud = params.isCloud === \"Y\";\n\t\tthis.isAdmin = params.isAdmin === \"Y\";\n\t\tthis.isInvitationBySmsAvailable = params.isInvitationBySmsAvailable === \"Y\";\n\t\tthis.isCreatorEmailConfirmed = params.isCreatorEmailConfirmed === \"Y\";\n\t\tthis.regenerateUrlBase = params.regenerateUrlBase;\n\t\tthis.firstInvitationBlock = params.firstInvitationBlock;\n\t\tthis.isSelfRegisterEnabled = params.isSelfRegisterEnabled;\n\t\tthis.analyticsLabel = params.analyticsLabel;\n\n\t\tif (Type.isDomNode(this.contentContainer))\n\t\t{\n\t\t\tconst blocks = Array.prototype.slice.call(\n\t\t\t\tthis.contentContainer.querySelectorAll(\".js-intranet-invitation-block\")\n\t\t\t);\n\t\t\t(blocks || []).forEach((block) => {\n\t\t\t\tlet blockType = block.getAttribute(\"data-role\");\n\t\t\t\tblockType = blockType.replace(\"-block\", \"\");\n\t\t\t\tthis.contentBlocks[blockType] = block;\n\t\t\t});\n\n\t\t\tthis.errorMessageBlock = this.contentContainer.querySelector(\"[data-role='error-message']\");\n\t\t\tthis.successMessageBlock = this.contentContainer.querySelector(\"[data-role='success-message']\");\n\n\t\t\tBX.UI.Hint.init(this.contentContainer);\n\t\t}\n\n\t\tthis.button = document.querySelector(\"#intranet-invitation-btn\");\n\n\t\tif (Type.isDomNode(this.menuContainer))\n\t\t{\n\t\t\tthis.menuItems = Array.prototype.slice.call(this.menuContainer.querySelectorAll(\"a\"));\n\n\t\t\t(this.menuItems || []).forEach((item) => {\n\t\t\t\tEvent.bind(item, 'click', () => {\n\t\t\t\t\tthis.changeContent(item.getAttribute('data-action'));\n\t\t\t\t});\n\n\t\t\t\tif (item.getAttribute('data-action') === this.firstInvitationBlock)\n\t\t\t\t{\n\t\t\t\t\tBX.fireEvent(item, 'click');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.submit = new Submit(this);\n\t\tthis.submit.subscribe('onInputError', (event) => {\n\t\t\tthis.showErrorMessage(event.data.error);\n\t\t});\n\n\t\tthis.analytics = new Analytics(this.analyticsLabel, this.isAdmin);\n\n\t\tif (this.isCloud)\n\t\t{\n\t\t\tthis.selfRegister = new SelfRegister(this);\n\t\t}\n\n\t\tthis.arrowBox = document.querySelector('.invite-wrap-decal-arrow');\n\t\tif (Type.isDomNode(this.arrowBox))\n\t\t{\n\t\t\tthis.arrowRect = this.arrowBox.getBoundingClientRect();\n\t\t\tthis.arrowHeight = this.arrowRect.height;\n\t\t\tthis.setSetupArrow();\n\t\t}\n\t}\n\n\trenderSelector(params)\n\t{\n\t\tthis.selector = new Selector(this, params);\n\t\tthis.selector.render();\n\t}\n\n\tchangeContent(action)\n\t{\n\t\tthis.hideErrorMessage();\n\t\tthis.hideSuccessMessage();\n\n\t\tif (action.length > 0)\n\t\t{\n\t\t\tif (action === 'active-directory')\n\t\t\t{\n\t\t\t\tif (!this.activeDirectory)\n\t\t\t\t{\n\t\t\t\t\tthis.activeDirectory = new ActiveDirectory(this);\n\t\t\t\t}\n\n\t\t\t\tthis.activeDirectory.showForm();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst projectId = (\n\t\t\t\tthis.userOptions.hasOwnProperty('groupId')\n\t\t\t\t\t? parseInt(this.userOptions.groupId, 10)\n\t\t\t\t\t: 0\n\t\t\t);\n\n\t\t\tfor (let type in this.contentBlocks)\n\t\t\t{\n\t\t\t\tlet block = this.contentBlocks[type];\n\n\t\t\t\tif (type === action)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(block, 'invite-block-hidden');\n\t\t\t\t\tDom.addClass(block, 'invite-block-shown');\n\n\t\t\t\t\tconst params = {\n\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t};\n\t\t\t\t\tconst row = new Row(this, params);\n\n\t\t\t\t\tif (action === 'invite')\n\t\t\t\t\t{\n\t\t\t\t\t\trow.renderInviteInputs(5);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === 'invite-with-group-dp')\n\t\t\t\t\t{\n\t\t\t\t\t\trow.renderInviteInputs(3);\n\n\t\t\t\t\t\tconst selectorParams = {\n\t\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t\t\t\t.querySelector(\"[data-role='entity-selector-container']\"),\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tdepartment: true,\n\t\t\t\t\t\t\t\tproject: true,\n\t\t\t\t\t\t\t\tprojectId: projectId,\n\t\t\t\t\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.renderSelector(selectorParams);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === 'extranet')\n\t\t\t\t\t{\n\t\t\t\t\t\trow.renderInviteInputs(3);\n\n\t\t\t\t\t\tconst selectorParams = {\n\t\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t\t\t\t.querySelector(\"[data-role='entity-selector-container']\"),\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tdepartment: false,\n\t\t\t\t\t\t\t\tproject: \"extranet\",\n\t\t\t\t\t\t\t\tprojectId: projectId,\n\t\t\t\t\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.renderSelector(selectorParams);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === \"add\")\n\t\t\t\t\t{\n\t\t\t\t\t\trow.renderRegisterInputs();\n\n\t\t\t\t\t\tconst selectorParams = {\n\t\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t\t\t\t.querySelector(\"[data-role='entity-selector-container']\"),\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tdepartment: true,\n\t\t\t\t\t\t\t\tproject: true,\n\t\t\t\t\t\t\t\tprojectId: projectId,\n\t\t\t\t\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.renderSelector(selectorParams);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === \"integrator\")\n\t\t\t\t\t{\n\t\t\t\t\t\trow.renderIntegratorInput();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(block, 'invite-block-shown');\n\t\t\t\t\tDom.addClass(block, 'invite-block-hidden');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.changeButton(action);\n\t\t}\n\t}\n\n\tchangeButton(action)\n\t{\n\t\tEvent.unbindAll(this.button, 'click');\n\n\t\tif (!this.isCreatorEmailConfirmed)\n\t\t{\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tthis.showErrorMessage(Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_CREATOR_EMAIL_ERROR'));\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tthis.activateButton();\n\n\t\tif (action === \"invite\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click',() => {\n\t\t\t\tthis.submit.submitInvite();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"mass-invite\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click',() => {\n\t\t\t\tthis.submit.submitMassInvite();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"invite-with-group-dp\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click',() => {\n\t\t\t\tthis.submit.submitInviteWithGroupDp();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"add\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_ADD');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tthis.submit.submitAdd();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"self\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_SAVE');\n\t\t\tthis.disableButton();\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tif (this.isButtonActive())\n\t\t\t\t{\n\t\t\t\t\tthis.submit.submitSelf();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (action === \"integrator\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tthis.submit.submitIntegrator();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"extranet\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tthis.submit.submitExtranet();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"success\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE_MORE');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tBX.fireEvent(this.menuItems[0], 'click');\n\t\t\t});\n\t\t}\n\t}\n\n\tdisableButton()\n\t{\n\t\tDom.addClass(this.button, \"ui-btn-disabled\");\n\t}\n\n\tactivateButton()\n\t{\n\t\tDom.removeClass(this.button, \"ui-btn-disabled\");\n\t}\n\n\tisButtonActive()\n\t{\n\t\treturn !Dom.hasClass(this.button, \"ui-btn-disabled\");\n\t}\n\n\tshowSuccessMessage(successText)\n\t{\n\t\tthis.hideErrorMessage();\n\n\t\tif (Type.isDomNode(this.successMessageBlock))\n\t\t{\n\t\t\tthis.successMessageBlock.style.display = \"block\";\n\t\t\tconst alert = this.successMessageBlock.querySelector(\".ui-alert-message\");\n\t\t\tif (Type.isDomNode(alert))\n\t\t\t{\n\t\t\t\talert.innerHTML = BX.util.htmlspecialchars(successText);\n\t\t\t}\n\t\t}\n\t}\n\n\thideSuccessMessage()\n\t{\n\t\tif (Type.isDomNode(this.successMessageBlock))\n\t\t{\n\t\t\tthis.successMessageBlock.style.display = \"none\";\n\t\t}\n\t}\n\n\tshowErrorMessage(errorText)\n\t{\n\t\tthis.hideSuccessMessage();\n\n\t\tif (Type.isDomNode(this.errorMessageBlock) && errorText)\n\t\t{\n\t\t\tthis.errorMessageBlock.style.display = \"block\";\n\t\t\tconst alert = this.errorMessageBlock.querySelector(\".ui-alert-message\");\n\t\t\tif (Type.isDomNode(alert))\n\t\t\t{\n\t\t\t\talert.innerHTML = BX.util.htmlspecialchars(errorText);\n\t\t\t}\n\t\t}\n\t}\n\n\thideErrorMessage()\n\t{\n\t\tif (Type.isDomNode(this.errorMessageBlock))\n\t\t{\n\t\t\tthis.errorMessageBlock.style.display = \"none\";\n\t\t}\n\t}\n\n\tgetSetupArrow()\n\t{\n\t\tthis.body = document.querySelector('.invite-body');\n\t\tthis.panelConfirmBtn = document.getElementById('intranet-invitation-btn');\n\t\tthis.sliderContent = document.querySelector('.ui-page-slider-workarea');\n\t\tthis.sliderHeader = document.querySelector('.ui-side-panel-wrap-title-wrap');\n\t\tthis.buttonPanel = document.querySelector('.ui-button-panel');\n\t\tthis.inviteButton = document.querySelector('.invite-form-buttons');\n\n\t\tthis.sliderHeaderHeight = this.sliderHeader.getBoundingClientRect().height;\n\t\tthis.buttonPanelRect = this.buttonPanel.getBoundingClientRect();\n\t\tthis.panelRect = this.panelConfirmBtn.getBoundingClientRect();\n\t\tthis.btnWidth = Math.ceil(this.panelRect.width);\n\t\tthis.arrowWidth = Math.ceil(this.arrowRect.width);\n\t\tthis.sliderContentRect = this.sliderContent.getBoundingClientRect();\n\n\t\tthis.bodyHeight = this.body.getBoundingClientRect().height - this.buttonPanelRect.height + this.sliderHeaderHeight;\n\t\tthis.contentHeight = this.arrowHeight + this.sliderContentRect.height + this.buttonPanelRect.height + this.sliderHeaderHeight - 65;\n\t}\n\n\tupdateArrow()\n\t{\n\t\tthis.bodyHeight = this.body.getBoundingClientRect().height - this.buttonPanelRect.height + this.sliderHeaderHeight;\n\t\tthis.contentHeight = this.arrowHeight + this.sliderContentRect.height + this.buttonPanelRect.height + this.sliderHeaderHeight - 65;\n\t\tthis.contentHeight > this.bodyHeight ? this.body.classList.add('js-intranet-invitation-arrow-hide') : this.body.classList.remove('js-intranet-invitation-arrow-hide');\n\t}\n\n\tsetSetupArrow()\n\t{\n\t\tthis.getSetupArrow();\n\t\tconst btnPadding = 40;\n\t\tthis.arrowBox.style.left = (this.panelRect.left + (this.btnWidth / 2) - (this.arrowWidth / 2) - btnPadding) + 'px';\n\t\tthis.contentHeight > this.bodyHeight ? this.body.classList.add('js-intranet-invitation-arrow-hide') : this.body.classList.remove('js-intranet-invitation-arrow-hide');\n\n\t\twindow.addEventListener('resize', function() {\n\t\t\tif (window.innerWidth <= 1100)\n\t\t\t{\n\t\t\t\tthis.arrowBox.style.left = (this.panelRect.left + (this.btnWidth / 2) - (this.arrowWidth / 2) - btnPadding) + 'px';\n\t\t\t}\n\t\t\tthis.getSetupArrow();\n\t\t\tthis.updateArrow();\n\t\t}.bind(this))\n\n\t\tthis.inviteButton.addEventListener('click', function() {\n\t\t\tthis.getSetupArrow();\n\t\t\tthis.updateArrow();\n\t\t}.bind(this))\n\t}\n}\n"],"names":["Submit","parent","setEventNamespace","subscribe","event","form","Type","isDomNode","errorInputData","items","phoneExp","rows","Array","prototype","slice","call","querySelectorAll","forEach","row","emailInput","querySelector","phoneInput","nameInput","lastNameInput","emailValue","value","trim","isInvitationBySmsAvailable","phoneValue","test","String","toLowerCase","push","phoneCountryInput","Validation","isEmail","requestData","selector","selectorItems","getItems","length","inviteForm","contentBlocks","parseEmailAndPhone","Event","BaseEvent","data","error","Loc","getMessage","join","emit","analyticsLabel","sendAction","inviteWithGroupDpForm","showErrorMessage","getGroupAndDepartmentData","selfForm","obRequestData","checked","extranetForm","integratorForm","massInviteForm","addForm","action","disableSubmitButton","userOptions","BX","ajax","runComponentAction","componentName","signedParameters","mode","then","response","showSuccessMessage","changeContent","sendSuccessEvent","B24","licenseInfoPopup","show","message","errors","isDisable","button","isBoolean","Dom","addClass","removeClass","users","SidePanel","Instance","postMessageAll","window","EventEmitter","SelfRegister","selfBlock","bindActions","switcherNode","switcher","Switcher","inputName","id","isSelfRegisterEnabled","node","handlers","toggled","toggleSettings","bind","regenerateButton","activateButton","regenerateSecret","regenerateUrlBase","copyRegisterUrlButton","copyRegisterUrl","allowRegisterConfirm","toggleWhiteList","selfWhiteList","registerUrl","Text","getRandom","allowRegisterSecretNode","allowRegisterUrlNode","clipboard","copy","showHintPopup","runAction","analytics","send","bindNode","PopupWindow","content","zIndex","angle","offsetTop","offsetLeft","closeIcon","autoHide","darkMode","overlay","maxWidth","events","onAfterPopupShow","setTimeout","close","controlBlock","hasClass","toggleClass","settingsBlock","style","inputElement","Phone","count","index","maxCount","inputStack","inputNode","num","getAttribute","parentNode","element","Tag","render","paddingLeft","append","flagNode","showCountrySelector","changeCallback","i","e","country","PhoneNumber","Input","flagSize","onChange","setInterval","getValue","formatter","getCountry","clearInterval","_onFlagClick","Row","params","contentBlock","inputNum","rowsContainer","phoneObj","moreButton","unbindAll","renderInputRow","massInviteButton","massMenuNode","document","fireEvent","renderPhoneRow","inputNodes","checkPhoneInput","container","nextElementSibling","preventDefault","phoneBlock","newInput","replace","bindCloseIcons","bindPhoneChecker","remove","numRows","clean","showTitles","emailTitle","nameTitle","lastNameTitle","Selector","options","entities","prepareOptions","type","hasOwnProperty","selectMode","allowOnlyUserDepartments","allowSelectRootDepartment","optionValue","fillRecentTab","preselectedItems","projectId","tagSelector","TagSelector","dialogOptions","context","renderTo","departments","projects","tagSelectorItems","getDialog","getSelectedItems","item","parseInt","getId","getEntityId","ActiveDirectory","UI","Feedback","Form","open","defaultForm","sec","Analytics","cSection","isAdmin","sendData","tool","TOOLS","category","CATEGORY_INVITATION","EVENT_COPY","c_section","p1","p2","ADMIN_ALLOW_MODE_Y","ADMIN_ALLOW_MODE_N","IS_ADMIN_Y","IS_ADMIN_N","source","formParams","isPlainObject","menuContainer","menuContainerNode","contentContainer","contentContainerNode","isExtranetInstalled","isCloud","isCreatorEmailConfirmed","firstInvitationBlock","blocks","block","blockType","errorMessageBlock","successMessageBlock","Hint","init","menuItems","submit","selfRegister","arrowBox","arrowRect","getBoundingClientRect","arrowHeight","height","setSetupArrow","hideErrorMessage","hideSuccessMessage","activeDirectory","showForm","groupId","renderInviteInputs","selectorParams","department","project","renderSelector","renderRegisterInputs","renderIntegratorInput","changeButton","innerText","submitInvite","submitMassInvite","submitInviteWithGroupDp","submitAdd","disableButton","isButtonActive","submitSelf","submitIntegrator","submitExtranet","successText","display","alert","innerHTML","util","htmlspecialchars","errorText","body","panelConfirmBtn","getElementById","sliderContent","sliderHeader","buttonPanel","inviteButton","sliderHeaderHeight","buttonPanelRect","panelRect","btnWidth","Math","ceil","width","arrowWidth","sliderContentRect","bodyHeight","contentHeight","classList","add","getSetupArrow","btnPadding","left","addEventListener","innerWidth","updateArrow"],"mappings":"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"}