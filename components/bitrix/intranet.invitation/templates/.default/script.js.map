{"version":3,"file":"script.js","sources":["src/submit.js","src/self-register.js","src/phone.js","src/row.js","src/selector.js","src/active-directory.js","src/form.js"],"sourcesContent":["import {Type, Validation, Loc, Dom, Event} from \"main.core\";\nimport {EventEmitter} from \"main.core.events\";\n\nexport class Submit extends EventEmitter\n{\n\tconstructor(parent)\n\t{\n\t\tsuper();\n\t\tthis.parent = parent;\n\t\tthis.setEventNamespace(\"BX.Intranet.Invitation.Submit\");\n\t\tthis.parent.subscribe(\"onButtonClick\", (event) => {});\n\t}\n\n\tparseEmailAndPhone(form)\n\t{\n\t\tif (!Type.isDomNode(form))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet errorInputData = [];\n\t\tlet items = [];\n\t\tconst phoneExp = /^[\\d+][\\d\\(\\)\\ -]{4,22}\\d$/;\n\t\tconst rows = Array.prototype.slice.call(form.querySelectorAll(\".js-form-row\"));\n\n\t\t(rows || []).forEach((row) => {\n\t\t\tconst emailInput = row.querySelector(\"input[name='EMAIL[]']\");\n\t\t\tconst phoneInput = row.querySelector(\"input[name='PHONE[]']\");\n\t\t\tconst nameInput = row.querySelector(\"input[name='NAME[]']\");\n\t\t\tconst lastNameInput = row.querySelector(\"input[name='LAST_NAME[]']\");\n\t\t\tconst emailValue = emailInput.value.trim();\n\n\t\t\tif (this.parent.isInvitationBySmsAvailable && Type.isDomNode(phoneInput))\n\t\t\t{\n\t\t\t\tconst phoneValue = phoneInput.value.trim();\n\t\t\t\tif (phoneValue)\n\t\t\t\t{\n\t\t\t\t\tif (!phoneExp.test(String(phoneValue).toLowerCase()))\n\t\t\t\t\t{\n\t\t\t\t\t\terrorInputData.push(phoneValue);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst phoneCountryInput = row.querySelector(\"input[name='PHONE_COUNTRY[]']\");\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t\"PHONE\": phoneValue,\n\t\t\t\t\t\t\t\"PHONE_COUNTRY\": phoneCountryInput.value.trim(),\n\t\t\t\t\t\t\t\"NAME\": nameInput.value,\n\t\t\t\t\t\t\t\"LAST_NAME\": lastNameInput.value\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (emailValue)\n\t\t\t{\n\t\t\t\tif (Validation.isEmail(emailValue))\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\t\"EMAIL\": emailValue,\n\t\t\t\t\t\t\"NAME\": nameInput.value,\n\t\t\t\t\t\t\"LAST_NAME\": lastNameInput.value\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\terrorInputData.push(emailValue);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn [items, errorInputData];\n\t}\n\n\tgetGroupAndDepartmentData(requestData)\n\t{\n\t\tconst selector = this.parent.selector;\n\t\tconst selectorItems = selector.getItems();\n\n\t\tif (selectorItems[\"departments\"].length > 0)\n\t\t{\n\t\t\trequestData[\"UF_DEPARTMENT\"] = selectorItems[\"departments\"];\n\t\t}\n\n\t\tif (selectorItems[\"projects\"].length > 0)\n\t\t{\n\t\t\trequestData[\"SONET_GROUPS_CODE\"] = selectorItems[\"projects\"];\n\t\t}\n\t}\n\n\tsubmitInvite()\n\t{\n\t\tconst inviteForm = this.parent.contentBlocks[\"invite\"].querySelector(\"form\");\n\t\tlet [items, errorInputData] = [...this.parseEmailAndPhone(inviteForm)];\n\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {error: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR\") + \": \" + errorInputData.join(', ')}});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {error: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR\")}});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tconst requestData = {\n\t\t\t\"ITEMS\": items\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"invite\",\n\t\t\t\"INVITATION_COUNT\": items.length\n\t\t};\n\n\t\tthis.sendAction(\"invite\", requestData, analyticsLabel);\n\t}\n\n\tsubmitInviteWithGroupDp()\n\t{\n\t\tconst inviteWithGroupDpForm = this.parent.contentBlocks[\"invite-with-group-dp\"].querySelector(\"form\");\n\t\tlet [items, errorInputData] = [...this.parseEmailAndPhone(inviteWithGroupDpForm)];\n\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\tthis.parent.showErrorMessage(Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR\") + \": \" + errorInputData.join(', '));\n\t\t\treturn;\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {\n\t\t\t\terror: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR\")}\n\t\t\t});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tlet requestData = {\n\t\t\t\"ITEMS\": items\n\t\t};\n\t\tthis.getGroupAndDepartmentData(requestData);\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"withGroupOrDepartment\",\n\t\t\t\"INVITATION_COUNT\": items.length\n\t\t};\n\n\t\tthis.sendAction(\"inviteWithGroupDp\", requestData, analyticsLabel);\n\t}\n\n\tsubmitSelf()\n\t{\n\t\tconst selfForm = this.parent.contentBlocks[\"self\"].querySelector(\"form\");\n\t\tlet obRequestData = {\n\t\t\t\"allow_register\": selfForm[\"allow_register\"].checked ? \"Y\" : \"N\",\n\t\t\t\"allow_register_confirm\": selfForm[\"allow_register_confirm\"].checked ? \"Y\" : \"N\",\n\t\t\t\"allow_register_secret\": selfForm[\"allow_register_secret\"].value,\n\t\t\t\"allow_register_whitelist\": selfForm[\"allow_register_whitelist\"].value,\n\t\t};\n\n\t\tthis.sendAction(\"self\", obRequestData);\n\t}\n\n\tsubmitExtranet()\n\t{\n\t\tconst extranetForm = this.parent.contentBlocks[\"extranet\"].querySelector(\"form\");\n\t\tlet [items, errorInputData] = [...this.parseEmailAndPhone(extranetForm)];\n\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\tthis.parent.showErrorMessage(Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR\") + \": \" + errorInputData.join(', '));\n\t\t\treturn;\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {\n\t\t\t\terror: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR\")}\n\t\t\t});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tlet requestData = {\n\t\t\t\"ITEMS\": items\n\t\t};\n\t\tthis.getGroupAndDepartmentData(requestData);\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"extranet\",\n\t\t\t\"INVITATION_COUNT\": items.length\n\t\t};\n\n\t\tthis.sendAction(\"extranet\", requestData, analyticsLabel);\n\t}\n\n\tsubmitIntegrator()\n\t{\n\t\tconst integratorForm = this.parent.contentBlocks[\"integrator\"].querySelector(\"form\");\n\n\t\tconst obRequestData = {\n\t\t\t\"integrator_email\": integratorForm[\"integrator_email\"].value,\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"integrator\"\n\t\t};\n\n\t\tthis.sendAction(\"inviteIntegrator\", obRequestData, analyticsLabel);\n\t}\n\n\tsubmitMassInvite()\n\t{\n\t\tconst massInviteForm = this.parent.contentBlocks[\"mass-invite\"].querySelector(\"form\");\n\n\t\tconst obRequestData = {\n\t\t\t\"ITEMS\": massInviteForm[\"mass_invite_emails\"].value\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"mass\"\n\t\t};\n\t\tthis.sendAction(\"massInvite\", obRequestData, analyticsLabel);\n\t}\n\n\tsubmitAdd()\n\t{\n\t\tconst addForm = this.parent.contentBlocks[\"add\"].querySelector(\"form\");\n\n\t\tlet requestData = {\n\t\t\t\"ADD_EMAIL\": addForm[\"ADD_EMAIL\"].value,\n\t\t\t\"ADD_NAME\": addForm[\"ADD_NAME\"].value,\n\t\t\t\"ADD_LAST_NAME\": addForm[\"ADD_LAST_NAME\"].value,\n\t\t\t\"ADD_POSITION\": addForm[\"ADD_POSITION\"].value,\n\t\t\t\"ADD_SEND_PASSWORD\": (\n\t\t\t\taddForm[\"ADD_SEND_PASSWORD\"]\n\t\t\t\t&& !!addForm[\"ADD_SEND_PASSWORD\"].checked\n\t\t\t\t\t? addForm[\"ADD_SEND_PASSWORD\"].value\n\t\t\t\t\t: \"N\"\n\t\t\t),\n\t\t};\n\t\tthis.getGroupAndDepartmentData(requestData);\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"add\"\n\t\t};\n\t\tthis.sendAction(\"add\", requestData, analyticsLabel);\n\t}\n\n\tsendAction(action, requestData, analyticsLabel)\n\t{\n\t\tthis.disableSubmitButton(true);\n\t\trequestData[\"userOptions\"] = this.parent.userOptions;\n\n\t\tBX.ajax.runComponentAction(this.parent.componentName, action, {\n\t\t\tsignedParameters: this.parent.signedParameters,\n\t\t\tmode: \"ajax\",\n\t\t\tdata: requestData,\n\t\t\tanalyticsLabel: analyticsLabel\n\t\t}).then((response) => {\n\n\t\t\tthis.disableSubmitButton(false);\n\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tif (action === \"self\")\n\t\t\t\t{\n\t\t\t\t\tthis.parent.showSuccessMessage(response.data);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.parent.changeContent(\"success\");\n\t\t\t\t\tthis.sendSuccessEvent(response.data);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}, (response) => {\n\n\t\t\tthis.disableSubmitButton(false);\n\n\t\t\tif (response.data == \"user_limit\")\n\t\t\t{\n\t\t\t\tB24.licenseInfoPopup.show(\n\t\t\t\t\t\"featureID\",\n\t\t\t\t\tBX.message(\"BX24_INVITE_DIALOG_USERS_LIMIT_TITLE\"),\n\t\t\t\t\tBX.message(\"BX24_INVITE_DIALOG_USERS_LIMIT_TEXT\")\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.parent.showErrorMessage(response.errors[0].message);\n\t\t\t}\n\t\t});\n\t}\n\n\tdisableSubmitButton(isDisable)\n\t{\n\t\tconst button = this.parent.button;\n\n\t\tif (!Type.isDomNode(button) || !Type.isBoolean(isDisable))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (isDisable)\n\t\t{\n\t\t\tDom.addClass(button, [\"ui-btn-wait\", \"invite-cursor-auto\"]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(button, [\"ui-btn-wait\", \"invite-cursor-auto\"]);\n\t\t}\n\t}\n\n\tsendSuccessEvent(users)\n\t{\n\t\tBX.SidePanel.Instance.postMessageAll(window, \"BX.Intranet.Invitation:onAdd\", { users: users });\n\t}\n}","import {Event, Type, Dom, Text, Loc} from \"main.core\";\n\nexport class SelfRegister\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\n\t\tif (Type.isDomNode(this.parent.contentBlocks[\"self\"]))\n\t\t{\n\t\t\tthis.selfBlock = this.parent.contentBlocks[\"self\"];\n\t\t\tthis.bindActions();\n\t\t}\n\t}\n\n\tbindActions()\n\t{\n\t\tconst regenerateButton = this.selfBlock.querySelector(\"[data-role='selfRegenerateSecretButton']\");\n\t\tif (Type.isDomNode(regenerateButton))\n\t\t{\n\t\t\tEvent.bind(regenerateButton, 'click',() => {\n\t\t\t\tthis.parent.activateButton();\n\t\t\t\tthis.regenerateSecret(this.parent.regenerateUrlBase);\n\t\t\t});\n\t\t}\n\n\t\tconst copyRegisterUrlButton = this.selfBlock.querySelector(\"[data-role='copyRegisterUrlButton']\");\n\t\tif (Type.isDomNode(copyRegisterUrlButton))\n\t\t{\n\t\t\tEvent.bind(copyRegisterUrlButton, 'click', () => {\n\t\t\t\tthis.copyRegisterUrl();\n\t\t\t});\n\t\t}\n\n\t\tconst selfToggleSettingsButton = this.selfBlock.querySelector(\"[data-role='selfToggleSettingsButton']\");\n\t\tif (Type.isDomNode(selfToggleSettingsButton))\n\t\t{\n\t\t\tEvent.bind(selfToggleSettingsButton, 'change', () => {\n\t\t\t\tthis.parent.activateButton();\n\t\t\t\tthis.toggleSettings(selfToggleSettingsButton);\n\t\t\t});\n\t\t}\n\n\t\tconst allowRegisterConfirm = this.selfBlock.querySelector(\"[data-role='allowRegisterConfirm']\");\n\t\tif (Type.isDomNode(allowRegisterConfirm))\n\t\t{\n\t\t\tEvent.bind(allowRegisterConfirm, 'change', () => {\n\t\t\t\tthis.parent.activateButton();\n\t\t\t\tthis.toggleWhiteList(allowRegisterConfirm);\n\t\t\t});\n\t\t}\n\n\t\tconst selfWhiteList = this.selfBlock.querySelector(\"[data-role='selfWhiteList']\");\n\t\tif (Type.isDomNode(selfWhiteList))\n\t\t{\n\t\t\tEvent.bind(selfWhiteList, 'input', () => {\n\t\t\t\tthis.parent.activateButton();\n\t\t\t});\n\t\t}\n\t}\n\n\tregenerateSecret(registerUrl)\n\t{\n\t\tconst value = Text.getRandom(8);\n\n\t\tconst allowRegisterSecretNode = this.selfBlock.querySelector(\"[data-role='allowRegisterSecret']\");\n\t\tif (Type.isDomNode(allowRegisterSecretNode))\n\t\t{\n\t\t\tallowRegisterSecretNode.value = value || '';\n\t\t}\n\n\t\tconst allowRegisterUrlNode = this.selfBlock.querySelector(\"[data-role='allowRegisterUrl']\");\n\t\tif (Type.isDomNode(allowRegisterUrlNode) && registerUrl)\n\t\t{\n\t\t\tallowRegisterUrlNode.value = registerUrl + (value || 'yes');\n\t\t}\n\t}\n\n\tcopyRegisterUrl()\n\t{\n\t\tconst allowRegisterUrlNode = this.selfBlock.querySelector(\"[data-role='allowRegisterUrl']\");\n\t\tif (Type.isDomNode(allowRegisterUrlNode))\n\t\t{\n\t\t\tBX.clipboard.copy(allowRegisterUrlNode.value);\n\t\t\tthis.showHintPopup(Loc.getMessage(\"BX24_INVITE_DIALOG_COPY_URL\"), allowRegisterUrlNode);\n\n\t\t\tBX.ajax.runAction('intranet.controller.invite.copyregisterurl', {\n\t\t\t\tdata: {}\n\t\t\t}).then(function (response) {}, function (response) {});\n\t\t}\n\t}\n\n\tshowHintPopup(message, bindNode)\n\t{\n\t\tif (!Type.isDomNode(bindNode) || !message)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnew BX.PopupWindow('inviteHint' + Text.getRandom(8), bindNode, {\n\t\t\tcontent: message,\n\t\t\tzIndex: 15000,\n\t\t\tangle: true,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: 50,\n\t\t\tcloseIcon: false,\n\t\t\tautoHide: true,\n\t\t\tdarkMode: true,\n\t\t\toverlay: false,\n\t\t\tmaxWidth: 400,\n\t\t\tevents: {\n\t\t\t\tonAfterPopupShow: function () {\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t}.bind(this), 4000);\n\t\t\t\t}\n\t\t\t}\n\t\t}).show();\n\t}\n\n\ttoggleSettings(inputElement)\n\t{\n\t\tconst controlBlock = this.selfBlock.querySelector(\".js-invite-dialog-fast-reg-control-container\");\n\t\tif (Type.isDomNode(controlBlock))\n\t\t{\n\t\t\tif (!Dom.hasClass(controlBlock, 'disallow-registration'))\n\t\t\t{\n\t\t\t\tconst switcher = controlBlock.querySelector(\"[data-role='self-switcher']\");\n\t\t\t\tthis.showHintPopup(Loc.getMessage(\"INTRANET_INVITE_DIALOG_SELF_OFF_HINT\"), switcher);\n\t\t\t}\n\t\t\tDom.toggleClass(controlBlock, 'disallow-registration');\n\t\t}\n\n\t\tconst settingsBlock = this.selfBlock.querySelector(\"[data-role='selfSettingsBlock']\");\n\t\tif (Type.isDomNode(settingsBlock))\n\t\t{\n\t\t\tDom.style(settingsBlock, 'display', inputElement.checked ? 'block' : 'none');\n\t\t}\n\t}\n\n\ttoggleWhiteList(inputElement)\n\t{\n\t\tconst selfWhiteList = this.selfBlock.querySelector(\"[data-role='selfWhiteList']\");\n\t\tif (Type.isDomNode(selfWhiteList))\n\t\t{\n\t\t\tDom.style(selfWhiteList, 'display', inputElement.checked ? 'block' : 'none');\n\t\t}\n\t}\n}","import {Dom, Type, Tag, Event} from \"main.core\";\n\nexport class Phone\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\n\t\tthis.count = 0;\n\t\tthis.index = 0;\n\t\tthis.maxCount = 5;\n\t\tthis.inputStack = [];\n\t}\n\n\trenderPhoneRow(inputNode)\n\t{\n\t\tif(this.count >= this.maxCount)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isDomNode(inputNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst num = inputNode.getAttribute(\"data-num\");\n\n\t\tif (inputNode.parentNode.querySelector(\"#phone_number_\" + num))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = Tag.render`\n\t\t\t<span style=\"z-index: 3;\" class=\"ui-ctl-before\" data-role=\"phone-block\">\n\t\t\t\t<input type=\"hidden\" name=\"PHONE_COUNTRY[]\" id=\"phone_country_${num}\" value=\"\">\n\t\t\t\t<input type=\"hidden\" name=\"PHONE[]\" id=\"phone_number_${num}\" value=\"\">\n\t\t\t\t<div class=\"invite-dialog-phone-flag-block\" data-role=\"flag\">\n\t\t\t\t\t<span data-role=\"phone_flag_${num}\" style=\"pointer-events: none;\"></span>\n\t\t\t\t</div>\n\t\t\t\t<input class=\"invite-dialog-phone-input\" type=\"hidden\" id=\"phone_input_${num}\" value=\"\">&nbsp;\n\t\t\t</span>\n\t\t`;\n\n\t\tinputNode.style.paddingLeft = \"57px\";\n\t\tDom.append(element, inputNode.parentNode);\n\n\t\tconst flagNode = inputNode.parentNode.querySelector(\"[data-role='flag']\");\n\t\tif (Type.isDomNode(flagNode))\n\t\t{\n\t\t\tEvent.bind(inputNode.parentNode.querySelector(\"[data-role='flag']\"), 'click', () => {\n\t\t\t\tthis.showCountrySelector(num);\n\t\t\t});\n\t\t}\n\n\t\tlet changeCallback = function(i, inputNode)\n\t\t{\n\t\t\treturn function(e)\n\t\t\t{\n\t\t\t\tinputNode.parentNode.querySelector('#phone_number_' + i).value = e.value;\n\t\t\t\tinputNode.parentNode.querySelector('#phone_country_' + i).value = e.country;\n\t\t\t}\n\t\t};\n\n\t\tthis.inputStack[num] = new BX.PhoneNumber.Input({\n\t\t\tnode: inputNode,\n\t\t\tflagNode: inputNode.parentNode.querySelector(\"[data-role='phone_flag_\"+ num +\"']\"),\n\t\t\tflagSize: 16,\n\t\t\tonChange: changeCallback(num, inputNode)\n\t\t});\n\n\t\t//for ctrl+v paste\n\t\tconst id = setInterval(() => {\n\t\t\tif (\n\t\t\t\t!inputNode.parentNode?.querySelector('#phone_number_' + num).value\n\t\t\t\t|| !inputNode.parentNode?.querySelector('#phone_country_' + num).value\n\t\t\t)\n\t\t\t{\n\t\t\t\tchangeCallback(num, inputNode)({\n\t\t\t\t\tvalue: this.inputStack[num].getValue(),\n\t\t\t\t\tcountry: this.inputStack[num].formatter ? this.inputStack[num].getCountry() : null,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclearInterval(id);\n\t\t\t}\n\t\t}, 1000);\n\t}\n\n\tshowCountrySelector(i)\n\t{\n\t\tthis.inputStack[i]._onFlagClick();\n\t}\n}","import {Event, Type, Dom, Tag, Loc} from \"main.core\";\nimport {Phone} from \"./phone\";\n\nexport class Row\n{\n\tconstructor(parent, params)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.contentBlock = params.contentBlock;\n\t\tthis.inputNum = 0;\n\n\t\tif (Type.isDomNode(this.contentBlock))\n\t\t{\n\t\t\tthis.rowsContainer = this.contentBlock.querySelector(\"[data-role='rows-container']\");\n\t\t\tthis.bindActions();\n\t\t}\n\n\t\tif (this.parent.isInvitationBySmsAvailable)\n\t\t{\n\t\t\tthis.phoneObj = new Phone(this);\n\t\t}\n\t}\n\n\tbindActions()\n\t{\n\t\tconst moreButton = this.contentBlock.querySelector(\"[data-role='invite-more']\");\n\t\tif (Type.isDomNode(moreButton))\n\t\t{\n\t\t\tEvent.unbindAll(moreButton);\n\t\t\tEvent.bind(moreButton, 'click', () => {\n\t\t\t\tthis.renderInputRow();\n\t\t\t});\n\t\t}\n\n\t\tconst massInviteButton = this.contentBlock.querySelector(\"[data-role='invite-mass']\");\n\t\tif (Type.isDomNode(massInviteButton))\n\t\t{\n\t\t\tEvent.unbindAll(massInviteButton);\n\t\t\tEvent.bind(massInviteButton, 'click', () => {\n\t\t\t\tconst massMenuNode = document.querySelector(\"[data-role='menu-mass-invite']\");\n\t\t\t\tif (Type.isDomNode(massMenuNode))\n\t\t\t\t{\n\t\t\t\t\tBX.fireEvent(massMenuNode, 'click');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckPhoneInput(element)\n\t{\n\t\tconst phoneExp = /^[\\d+][\\d\\(\\)\\ -]{2,14}\\d$/;\n\n\t\tif (element.value && phoneExp.test(String(element.value).toLowerCase()))\n\t\t{\n\t\t\tthis.phoneObj.renderPhoneRow(element);\n\t\t}\n\t}\n\n\tbindPhoneChecker(element)\n\t{\n\t\tif (this.parent.isInvitationBySmsAvailable && Type.isDomNode(element))\n\t\t{\n\t\t\tconst inputNodes = Array.prototype.slice.call(element.querySelectorAll(\".js-email-phone-input\"));\n\t\t\tif (inputNodes)\n\t\t\t{\n\t\t\t\tinputNodes.forEach(element => {\n\t\t\t\t\tEvent.bind(element, 'input', () => {\n\t\t\t\t\t\tthis.checkPhoneInput(element);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tbindCloseIcons(container)\n\t{\n\t\tconst inputNodes = Array.prototype.slice.call(container.querySelectorAll(\"input\"));\n\n\t\t(inputNodes || []).forEach((node) => {\n\t\t\tlet closeIcon = node.nextElementSibling;\n\n\t\t\tEvent.bind(node, 'input', () => {\n\t\t\t\tDom.style(closeIcon, 'display', node.value !== \"\" ? \"block\" : \"none\");\n\t\t\t});\n\n\t\t\tEvent.bind(closeIcon, 'click', (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tnode.value = \"\";\n\n\t\t\t\tif (Type.isDomNode(node.parentNode))\n\t\t\t\t{\n\t\t\t\t\tconst phoneBlock = node.parentNode.querySelector(\"[data-role='phone-block']\");\n\t\t\t\t\tif (Type.isDomNode(phoneBlock))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst newInput = Tag.render`\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tname=\"EMAIL[]\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\t\t\t\tdata-num=\"${node.getAttribute('data-num')}\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element js-email-phone-input\"\n\t\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT')}\"\n\t\t\t\t\t\t\t/>`;\n\n\t\t\t\t\t\tDom.replace(node, newInput);\n\t\t\t\t\t\tthis.bindCloseIcons(newInput.parentNode);\n\t\t\t\t\t\tthis.bindPhoneChecker(newInput.parentNode);\n\t\t\t\t\t\tDom.remove(phoneBlock);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tDom.style(closeIcon, 'display', \"none\");\n\t\t\t});\n\t\t});\n\t}\n\n\trenderInviteInputs(numRows = 3)\n\t{\n\t\tDom.clean(this.rowsContainer);\n\t\tfor (let i = 0; i < numRows; i++)\n\t\t{\n\t\t\tthis.renderInputRow(i === 0);\n\t\t}\n\t}\n\n\trenderInputRow(showTitles = false)\n\t{\n\t\tlet emailTitle, nameTitle, lastNameTitle;\n\n\t\tif (showTitles)\n\t\t{\n\t\t\temailTitle = `\n\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t${Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT\")}\n\t\t\t\t</div>`;\n\n\t\t\tnameTitle = `\n\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_NAME_TITLE\")}\n\t\t\t\t</div>`;\n\n\t\t\tlastNameTitle = `\n\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE\")}\n\t\t\t\t</div>`;\n\n\t\t}\n\n\t\tconst element = Tag.render`\n\t\t\t<div class=\"invite-form-row js-form-row\">\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? emailTitle: ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\tname=\"EMAIL[]\" \n\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\t\t\tdata-num=\"${this.inputNum++}\" \n\t\t\t\t\t\t\tclass=\"ui-ctl-element js-email-phone-input\" \n\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT')}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? nameTitle: ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input name=\"NAME[]\" type=\"text\" class=\"ui-ctl-element\" placeholder=\"${Loc.getMessage('BX24_INVITE_DIALOG_ADD_NAME_TITLE')}\">\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? lastNameTitle: ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input name=\"LAST_NAME[]\" type=\"text\" class=\"ui-ctl-element\" placeholder=\"${Loc.getMessage('BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE')}\">\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(element, this.rowsContainer);\n\t\tthis.bindCloseIcons(element);\n\t\tthis.bindPhoneChecker(element);\n\t}\n\n\trenderRegisterInputs()\n\t{\n\t\tDom.clean(this.rowsContainer);\n\t\tconst element = Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_NAME_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_NAME\" id=\"ADD_NAME\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_LAST_NAME\" id=\"ADD_LAST_NAME\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_EMAIL_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_EMAIL\" id=\"ADD_EMAIL\" class=\"ui-ctl-element\" maxlength=\"50\">\n\t\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_POSITION_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_POSITION\" id=\"ADD_POSITION\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(element, this.rowsContainer);\n\t\tthis.bindCloseIcons(element);\n\t}\n\n\trenderIntegratorInput()\n\t{\n\t\tDom.clean(this.rowsContainer);\n\t\tconst element = Tag.render`\n\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"INTRANET_INVITE_DIALOG_INTEGRATOR_EMAIL\")}</div>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\tclass=\"ui-ctl-element\" \n\t\t\t\t\t\t\tvalue=\"\" \n\t\t\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\t\t\tname=\"integrator_email\" \n\t\t\t\t\t\t\tid=\"integrator_email\" \n\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage(\"INTRANET_INVITE_DIALOG_INTEGRATOR_EMAIL\")}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(element, this.rowsContainer);\n\t\tthis.bindCloseIcons(element);\n\t}\n}","import {Type, Dom} from \"main.core\";\nimport {TagSelector} from 'ui.entity-selector';\n\nexport class Selector\n{\n\tconstructor(parent, params)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.contentBlock = params.contentBlock;\n\t\tthis.options = params.options;\n\t\tthis.entities = [];\n\n\t\tthis.prepareOptions();\n\t}\n\n\tprepareOptions()\n\t{\n\t\tfor (let type in this.options)\n\t\t{\n\t\t\tif (!this.options.hasOwnProperty(type))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (type === \"department\" && !!this.options[type])\n\t\t\t{\n\t\t\t\tthis.entities.push({\n\t\t\t\t\tid: \"department\",\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselectMode: \"departmentsOnly\",\n\t\t\t\t\t\tallowOnlyUserDepartments: !(!!this.options[\"isAdmin\"] && this.options[\"isAdmin\"] === true),\n\t\t\t\t\t\tallowSelectRootDepartment: true,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (type === \"project\" && !!this.options[type])\n\t\t\t{\n\t\t\t\tlet optionValue = {\n\t\t\t\t\tid: \"project\",\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tfillRecentTab: true\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif (this.options[type] === \"extranet\")\n\t\t\t\t{\n\t\t\t\t\toptionValue[\"options\"][\"extranet\"] = true;\n\t\t\t\t}\n\t\t\t\tthis.entities.push(optionValue);\n\t\t\t}\n\t\t}\n\t}\n\n\trender()\n\t{\n\t\tconst preselectedItems = [];\n\n\t\tif (\n\t\t\tthis.options.hasOwnProperty('projectId')\n\t\t\t&& this.options.projectId > 0\n\t\t)\n\t\t{\n\t\t\tpreselectedItems.push(['project', this.options.projectId])\n\t\t}\n\n\t\tthis.tagSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\tpreselectedItems: preselectedItems,\n\t\t\t\tentities: this.entities,\n\t\t\t\tcontext: 'INTRANET_INVITATION'\n\t\t\t}\n\t\t});\n\n\t\tif (Type.isDomNode(this.contentBlock))\n\t\t{\n\t\t\tDom.clean(this.contentBlock);\n\t\t\tthis.tagSelector.renderTo(this.contentBlock);\n\t\t}\n\t}\n\n\tgetItems()\n\t{\n\t\tlet departments = [];\n\t\tlet projects = [];\n\t\tconst tagSelectorItems = this.tagSelector.getDialog().getSelectedItems();\n\n\t\ttagSelectorItems.forEach(item => {\n\t\t\tconst id = parseInt(item.getId());\n\t\t\tconst type = item.getEntityId();\n\n\t\t\tif (type === \"department\")\n\t\t\t{\n\t\t\t\tdepartments.push(id);\n\t\t\t}\n\t\t\telse if (type === \"project\")\n\t\t\t{\n\t\t\t\tprojects.push(id);\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\tdepartments: departments,\n\t\t\tprojects: projects\n\t\t};\n\t}\n}","export class ActiveDirectory\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\t}\n\n\tshowForm()\n\t{\n\t\tBX.UI.Feedback.Form.open(\n\t\t\t{\n\t\t\t\tid: 'intranet-active-directory',\n\t\t\t\tdefaultForm: {id: 309, sec: 'fbc0n3'}\n\t\t\t}\n\t\t);\n\t}\n}","import {Type, Dom, Event, Loc} from 'main.core';\nimport {Submit} from './submit';\nimport {SelfRegister} from './self-register';\nimport {Row} from \"./row\";\nimport {Selector} from \"./selector\";\nimport {EventEmitter} from \"main.core.events\";\nimport {ActiveDirectory} from \"./active-directory\";\n\nexport default class Form extends EventEmitter\n{\n\tconstructor(formParams)\n\t{\n\t\tsuper();\n\n\t\tconst params = Type.isPlainObject(formParams) ? formParams : {};\n\n\t\tthis.signedParameters = params.signedParameters;\n\t\tthis.componentName = params.componentName;\n\n\t\tthis.menuContainer = params.menuContainerNode;\n\t\tthis.contentContainer = params.contentContainerNode;\n\t\tthis.contentBlocks = {};\n\t\tthis.userOptions = params.userOptions;\n\n\t\tthis.isExtranetInstalled = params.isExtranetInstalled === \"Y\";\n\t\tthis.isCloud = params.isCloud === \"Y\";\n\t\tthis.isAdmin = params.isAdmin === \"Y\";\n\t\tthis.isInvitationBySmsAvailable = params.isInvitationBySmsAvailable === \"Y\";\n\t\tthis.isCreatorEmailConfirmed = params.isCreatorEmailConfirmed === \"Y\";\n\t\tthis.regenerateUrlBase = params.regenerateUrlBase;\n\t\tthis.firstInvitationBlock = params.firstInvitationBlock;\n\n\t\tif (Type.isDomNode(this.contentContainer))\n\t\t{\n\t\t\tconst blocks = Array.prototype.slice.call(\n\t\t\t\tthis.contentContainer.querySelectorAll(\".js-intranet-invitation-block\")\n\t\t\t);\n\t\t\t(blocks || []).forEach((block) => {\n\t\t\t\tlet blockType = block.getAttribute(\"data-role\");\n\t\t\t\tblockType = blockType.replace(\"-block\", \"\");\n\t\t\t\tthis.contentBlocks[blockType] = block;\n\t\t\t});\n\n\t\t\tthis.errorMessageBlock = this.contentContainer.querySelector(\"[data-role='error-message']\");\n\t\t\tthis.successMessageBlock = this.contentContainer.querySelector(\"[data-role='success-message']\");\n\n\t\t\tBX.UI.Hint.init(this.contentContainer);\n\t\t}\n\n\t\tthis.button = document.querySelector(\"#intranet-invitation-btn\");\n\n\t\tif (Type.isDomNode(this.menuContainer))\n\t\t{\n\t\t\tthis.menuItems = Array.prototype.slice.call(this.menuContainer.querySelectorAll(\"a\"));\n\n\t\t\t(this.menuItems || []).forEach((item) => {\n\t\t\t\tEvent.bind(item, 'click', () => {\n\t\t\t\t\tthis.changeContent(item.getAttribute('data-action'));\n\t\t\t\t});\n\n\t\t\t\tif (item.getAttribute('data-action') === this.firstInvitationBlock)\n\t\t\t\t{\n\t\t\t\t\tBX.fireEvent(item, 'click');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.submit = new Submit(this);\n\t\tthis.submit.subscribe('onInputError', (event) => {\n\t\t\tthis.showErrorMessage(event.data.error);\n\t\t});\n\n\t\tif (this.isCloud)\n\t\t{\n\t\t\tthis.selfRegister = new SelfRegister(this);\n\t\t}\n\n\t\tthis.arrowBox = document.querySelector('.invite-wrap-decal-arrow');\n\t\tif (Type.isDomNode(this.arrowBox))\n\t\t{\n\t\t\tthis.arrowRect = this.arrowBox.getBoundingClientRect();\n\t\t\tthis.arrowHeight = this.arrowRect.height;\n\t\t\tthis.setSetupArrow();\n\t\t}\n\t}\n\n\trenderSelector(params)\n\t{\n\t\tthis.selector = new Selector(this, params);\n\t\tthis.selector.render();\n\t}\n\n\tchangeContent(action)\n\t{\n\t\tthis.hideErrorMessage();\n\t\tthis.hideSuccessMessage();\n\n\t\tif (action.length > 0)\n\t\t{\n\t\t\tif (action === 'active-directory')\n\t\t\t{\n\t\t\t\tif (!this.activeDirectory)\n\t\t\t\t{\n\t\t\t\t\tthis.activeDirectory = new ActiveDirectory(this);\n\t\t\t\t}\n\n\t\t\t\tthis.activeDirectory.showForm();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst projectId = (\n\t\t\t\tthis.userOptions.hasOwnProperty('groupId')\n\t\t\t\t\t? parseInt(this.userOptions.groupId, 10)\n\t\t\t\t\t: 0\n\t\t\t);\n\n\t\t\tfor (let type in this.contentBlocks)\n\t\t\t{\n\t\t\t\tlet block = this.contentBlocks[type];\n\n\t\t\t\tif (type === action)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(block, 'invite-block-hidden');\n\t\t\t\t\tDom.addClass(block, 'invite-block-shown');\n\n\t\t\t\t\tconst params = {\n\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t};\n\t\t\t\t\tconst row = new Row(this, params);\n\n\t\t\t\t\tif (action === 'invite')\n\t\t\t\t\t{\n\t\t\t\t\t\trow.renderInviteInputs(5);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === 'invite-with-group-dp')\n\t\t\t\t\t{\n\t\t\t\t\t\trow.renderInviteInputs(3);\n\n\t\t\t\t\t\tconst selectorParams = {\n\t\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t\t\t\t.querySelector(\"[data-role='entity-selector-container']\"),\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tdepartment: true,\n\t\t\t\t\t\t\t\tproject: true,\n\t\t\t\t\t\t\t\tprojectId: projectId,\n\t\t\t\t\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.renderSelector(selectorParams);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === 'extranet')\n\t\t\t\t\t{\n\t\t\t\t\t\trow.renderInviteInputs(3);\n\n\t\t\t\t\t\tconst selectorParams = {\n\t\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t\t\t\t.querySelector(\"[data-role='entity-selector-container']\"),\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tdepartment: false,\n\t\t\t\t\t\t\t\tproject: \"extranet\",\n\t\t\t\t\t\t\t\tprojectId: projectId,\n\t\t\t\t\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.renderSelector(selectorParams);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === \"add\")\n\t\t\t\t\t{\n\t\t\t\t\t\trow.renderRegisterInputs();\n\n\t\t\t\t\t\tconst selectorParams = {\n\t\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t\t\t\t.querySelector(\"[data-role='entity-selector-container']\"),\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tdepartment: true,\n\t\t\t\t\t\t\t\tproject: true,\n\t\t\t\t\t\t\t\tprojectId: projectId,\n\t\t\t\t\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.renderSelector(selectorParams);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === \"integrator\")\n\t\t\t\t\t{\n\t\t\t\t\t\trow.renderIntegratorInput();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(block, 'invite-block-shown');\n\t\t\t\t\tDom.addClass(block, 'invite-block-hidden');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.changeButton(action);\n\t\t}\n\t}\n\n\tchangeButton(action)\n\t{\n\t\tEvent.unbindAll(this.button, 'click');\n\n\t\tif (!this.isCreatorEmailConfirmed)\n\t\t{\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tthis.showErrorMessage(Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_CREATOR_EMAIL_ERROR'));\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tthis.activateButton();\n\n\t\tif (action === \"invite\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click',() => {\n\t\t\t\tthis.submit.submitInvite();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"mass-invite\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click',() => {\n\t\t\t\tthis.submit.submitMassInvite();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"invite-with-group-dp\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click',() => {\n\t\t\t\tthis.submit.submitInviteWithGroupDp();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"add\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_ADD');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tthis.submit.submitAdd();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"self\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_SAVE');\n\t\t\tthis.disableButton();\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tif (this.isButtonActive())\n\t\t\t\t{\n\t\t\t\t\tthis.submit.submitSelf();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (action === \"integrator\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tthis.submit.submitIntegrator();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"extranet\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tthis.submit.submitExtranet();\n\t\t\t});\n\t\t}\n\t\telse if (action === \"success\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE_MORE');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tBX.fireEvent(this.menuItems[0], 'click');\n\t\t\t});\n\t\t}\n\t}\n\n\tdisableButton()\n\t{\n\t\tDom.addClass(this.button, \"ui-btn-disabled\");\n\t}\n\n\tactivateButton()\n\t{\n\t\tDom.removeClass(this.button, \"ui-btn-disabled\");\n\t}\n\n\tisButtonActive()\n\t{\n\t\treturn !Dom.hasClass(this.button, \"ui-btn-disabled\");\n\t}\n\n\tshowSuccessMessage(successText)\n\t{\n\t\tthis.hideErrorMessage();\n\n\t\tif (Type.isDomNode(this.successMessageBlock))\n\t\t{\n\t\t\tthis.successMessageBlock.style.display = \"block\";\n\t\t\tconst alert = this.successMessageBlock.querySelector(\".ui-alert-message\");\n\t\t\tif (Type.isDomNode(alert))\n\t\t\t{\n\t\t\t\talert.innerHTML = BX.util.htmlspecialchars(successText);\n\t\t\t}\n\t\t}\n\t}\n\n\thideSuccessMessage()\n\t{\n\t\tif (Type.isDomNode(this.successMessageBlock))\n\t\t{\n\t\t\tthis.successMessageBlock.style.display = \"none\";\n\t\t}\n\t}\n\n\tshowErrorMessage(errorText)\n\t{\n\t\tthis.hideSuccessMessage();\n\n\t\tif (Type.isDomNode(this.errorMessageBlock) && errorText)\n\t\t{\n\t\t\tthis.errorMessageBlock.style.display = \"block\";\n\t\t\tconst alert = this.errorMessageBlock.querySelector(\".ui-alert-message\");\n\t\t\tif (Type.isDomNode(alert))\n\t\t\t{\n\t\t\t\talert.innerHTML = BX.util.htmlspecialchars(errorText);\n\t\t\t}\n\t\t}\n\t}\n\n\thideErrorMessage()\n\t{\n\t\tif (Type.isDomNode(this.errorMessageBlock))\n\t\t{\n\t\t\tthis.errorMessageBlock.style.display = \"none\";\n\t\t}\n\t}\n\n\tgetSetupArrow()\n\t{\n\t\tthis.body = document.querySelector('.invite-body');\n\t\tthis.panelConfirmBtn = document.getElementById('intranet-invitation-btn');\n\t\tthis.sliderContent = document.querySelector('.ui-page-slider-workarea');\n\t\tthis.sliderHeader = document.querySelector('.ui-side-panel-wrap-title-wrap');\n\t\tthis.buttonPanel = document.querySelector('.ui-button-panel');\n\t\tthis.inviteButton = document.querySelector('.invite-form-buttons');\n\n\t\tthis.sliderHeaderHeight = this.sliderHeader.getBoundingClientRect().height;\n\t\tthis.buttonPanelRect = this.buttonPanel.getBoundingClientRect();\n\t\tthis.panelRect = this.panelConfirmBtn.getBoundingClientRect();\n\t\tthis.btnWidth = Math.ceil(this.panelRect.width);\n\t\tthis.arrowWidth = Math.ceil(this.arrowRect.width);\n\t\tthis.delta = (this.btnWidth - this.arrowWidth) / 2;\n\t\tthis.sliderContentRect = this.sliderContent.getBoundingClientRect();\n\n\t\tthis.bodyHeight = this.body.getBoundingClientRect().height - this.buttonPanelRect.height + this.sliderHeaderHeight;\n\t\tthis.contentHeight = this.arrowHeight + this.sliderContentRect.height + this.buttonPanelRect.height + this.sliderHeaderHeight - 65;\n\t}\n\n\tupdateArrow()\n\t{\n\t\tthis.bodyHeight = this.body.getBoundingClientRect().height - this.buttonPanelRect.height + this.sliderHeaderHeight;\n\t\tthis.contentHeight = this.arrowHeight + this.sliderContentRect.height + this.buttonPanelRect.height + this.sliderHeaderHeight - 65;\n\t\tthis.contentHeight > this.bodyHeight ? this.body.classList.add('js-intranet-invitation-arrow-hide') : this.body.classList.remove('js-intranet-invitation-arrow-hide');\n\t}\n\n\tsetSetupArrow()\n\t{\n\t\tthis.getSetupArrow();\n\t\tthis.arrowBox.style.left = (this.panelRect.left - this.delta) + 'px';\n\t\tthis.contentHeight > this.bodyHeight ? this.body.classList.add('js-intranet-invitation-arrow-hide') : this.body.classList.remove('js-intranet-invitation-arrow-hide');\n\n\t\twindow.addEventListener('resize', function() {\n\t\t\tthis.arrowBox.style.left = (this.panelRect.left - this.delta) + 'px';\n\t\t\tthis.getSetupArrow();\n\t\t\tthis.updateArrow();\n\t\t}.bind(this))\n\n\t\tthis.inviteButton.addEventListener('click', function() {\n\t\t\tthis.getSetupArrow();\n\t\t\tthis.updateArrow();\n\t\t}.bind(this))\n\t}\n}\n"],"names":["Submit","parent","setEventNamespace","subscribe","event","form","Type","isDomNode","errorInputData","items","phoneExp","rows","Array","prototype","slice","call","querySelectorAll","forEach","row","emailInput","querySelector","phoneInput","nameInput","lastNameInput","emailValue","value","trim","isInvitationBySmsAvailable","phoneValue","test","String","toLowerCase","push","phoneCountryInput","Validation","isEmail","requestData","selector","selectorItems","getItems","length","inviteForm","contentBlocks","parseEmailAndPhone","Event","BaseEvent","data","error","Loc","getMessage","join","emit","analyticsLabel","sendAction","inviteWithGroupDpForm","showErrorMessage","getGroupAndDepartmentData","selfForm","obRequestData","checked","extranetForm","integratorForm","massInviteForm","addForm","action","disableSubmitButton","userOptions","BX","ajax","runComponentAction","componentName","signedParameters","mode","then","response","showSuccessMessage","changeContent","sendSuccessEvent","B24","licenseInfoPopup","show","message","errors","isDisable","button","isBoolean","Dom","addClass","removeClass","users","SidePanel","Instance","postMessageAll","window","EventEmitter","SelfRegister","selfBlock","bindActions","regenerateButton","bind","activateButton","regenerateSecret","regenerateUrlBase","copyRegisterUrlButton","copyRegisterUrl","selfToggleSettingsButton","toggleSettings","allowRegisterConfirm","toggleWhiteList","selfWhiteList","registerUrl","Text","getRandom","allowRegisterSecretNode","allowRegisterUrlNode","clipboard","copy","showHintPopup","runAction","bindNode","PopupWindow","content","zIndex","angle","offsetTop","offsetLeft","closeIcon","autoHide","darkMode","overlay","maxWidth","events","onAfterPopupShow","setTimeout","close","inputElement","controlBlock","hasClass","switcher","toggleClass","settingsBlock","style","Phone","count","index","maxCount","inputStack","inputNode","num","getAttribute","parentNode","element","Tag","render","paddingLeft","append","flagNode","showCountrySelector","changeCallback","i","e","country","PhoneNumber","Input","node","flagSize","onChange","id","setInterval","getValue","formatter","getCountry","clearInterval","_onFlagClick","Row","params","contentBlock","inputNum","rowsContainer","phoneObj","moreButton","unbindAll","renderInputRow","massInviteButton","massMenuNode","document","fireEvent","renderPhoneRow","inputNodes","checkPhoneInput","container","nextElementSibling","preventDefault","phoneBlock","newInput","replace","bindCloseIcons","bindPhoneChecker","remove","numRows","clean","showTitles","emailTitle","nameTitle","lastNameTitle","Selector","options","entities","prepareOptions","type","hasOwnProperty","selectMode","allowOnlyUserDepartments","allowSelectRootDepartment","optionValue","fillRecentTab","preselectedItems","projectId","tagSelector","TagSelector","dialogOptions","context","renderTo","departments","projects","tagSelectorItems","getDialog","getSelectedItems","item","parseInt","getId","getEntityId","ActiveDirectory","UI","Feedback","Form","open","defaultForm","sec","formParams","isPlainObject","menuContainer","menuContainerNode","contentContainer","contentContainerNode","isExtranetInstalled","isCloud","isAdmin","isCreatorEmailConfirmed","firstInvitationBlock","blocks","block","blockType","errorMessageBlock","successMessageBlock","Hint","init","menuItems","submit","selfRegister","arrowBox","arrowRect","getBoundingClientRect","arrowHeight","height","setSetupArrow","hideErrorMessage","hideSuccessMessage","activeDirectory","showForm","groupId","renderInviteInputs","selectorParams","department","project","renderSelector","renderRegisterInputs","renderIntegratorInput","changeButton","innerText","submitInvite","submitMassInvite","submitInviteWithGroupDp","submitAdd","disableButton","isButtonActive","submitSelf","submitIntegrator","submitExtranet","successText","display","alert","innerHTML","util","htmlspecialchars","errorText","body","panelConfirmBtn","getElementById","sliderContent","sliderHeader","buttonPanel","inviteButton","sliderHeaderHeight","buttonPanelRect","panelRect","btnWidth","Math","ceil","width","arrowWidth","delta","sliderContentRect","bodyHeight","contentHeight","classList","add","getSetupArrow","left","addEventListener","updateArrow"],"mappings":"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"}