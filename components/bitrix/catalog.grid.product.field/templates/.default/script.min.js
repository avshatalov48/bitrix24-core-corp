(function(e,t,r,n){"use strict";function i(e,t){var r;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(r=o(e))||t&&e&&typeof e.length==="number"){if(r)e=r;var n=0;var i=function e(){};return{s:i,n:function t(){if(n>=e.length)return{done:true};return{done:false,value:e[n++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a=true,l=false,s;return{s:function t(){r=e[Symbol.iterator]()},n:function e(){var t=r.next();a=t.done;return t},e:function e(t){l=true;s=t},f:function e(){try{if(!a&&r.return!=null)r.return()}finally{if(l)throw s}}}}function o(e,t){if(!e)return;if(typeof e==="string")return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}function a(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++){n[r]=e[r]}return n}var l=function(){function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};babelHelpers.classCallCheck(this,e);this.selector=new n.ProductSelector(t,i);this.componentName=i.componentName||"";this.signedParameters=i.signedParameters||"";this.rowIdMask=i.rowIdMask||"#ID#";r.EventEmitter.subscribe("Grid::thereEditedRows",this.onSelectEdit.bind(this));r.EventEmitter.subscribe("Grid::noEditedRows",this.onCancelEdit.bind(this));r.EventEmitter.subscribe("Grid::beforeRequest",this.onBeforeGridRequest.bind(this))}babelHelpers.createClass(e,[{key:"getSelector",value:function e(){return this.selector}},{key:"onBeforeGridRequest",value:function e(t){var r=this.getSelector().getWrapper();if(!r){return}var n=t.getData(),o=babelHelpers.slicedToArray(n,2),a=o[1];var l=BX.prop.get(a,"data",{});if(!l.FIELDS){return}var s=this.getSelector().getModel().getProductId();s=this.rowIdMask.replace("#ID#",s);l.FIELDS[s]=l.FIELDS[s]||{};var u=r.querySelector(".ui-image-input-container");if(u){var c=u.querySelectorAll("input");var f={};var d=new RegExp(/([0-9A-Za-z_]+?(_n\d+)*)\[([A-Za-z_]+)\]/);var g=i(c),h;try{for(g.s();!(h=g.n()).done;){var v=h.value;if(d.test(v.name)){var y=v.name.match(d),S=babelHelpers.slicedToArray(y,4),I=S[1],b=S[2],E=S[3];if(I&&E){f[I]=f[I]||{};f[I][E]=v.value}}else{f[v.name]=v.value}}}catch(e){g.e(e)}finally{g.f()}l.FIELDS[s]=l.FIELDS[s]||{};if(Object.keys(f).length>0){l.FIELDS[s]["MORE_PHOTO"]=f}}var p=r.querySelector('input[name="NAME"]');if(p){l.FIELDS[s]["NAME"]=p.value}}},{key:"onCancelEdit",value:function r(){this.getSelector().setMode(BX.Catalog.ProductSelector.MODE_VIEW);this.getSelector().clearLayout();this.getSelector().layout();var n=BX.Main.gridManager.getInstanceById(this.getSelector().getConfig("GRID_ID"));if(!n){return}var i=n.getRows().getById(this.selector.getConfig("ROW_ID"));if(!i){return}var o=i.getCellById("CATALOG_PRODUCT");if(o){t.Dom.removeClass(i.getContentContainer(o),e.EDIT_CLASS)}}},{key:"onSelectEdit",value:function r(){if(!this.getSelector().getConfig("GRID_ID",null)){return}var n=BX.Main.gridManager.getInstanceById(this.getSelector().getConfig("GRID_ID"));if(!n){return}var i=n.getRows().getById(this.selector.getConfig("ROW_ID"));if(i&&i.isEdit()){this.getSelector().setMode(BX.Catalog.ProductSelector.MODE_EDIT);this.getSelector().clearLayout();this.getSelector().layout();var o=i.getCellById("CATALOG_PRODUCT");if(o){t.Dom.addClass(i.getContentContainer(o),e.EDIT_CLASS)}}}}]);return e}();babelHelpers.defineProperty(l,"EDIT_CLASS","catalog-grid-product-field-edit");babelHelpers.defineProperty(l,"PRODUCT_MODE","product");babelHelpers.defineProperty(l,"SKU_MODE","sku");t.Reflection.namespace("BX.Catalog.Grid").ProductField=l})(this.window=this.window||{},BX,BX.Event,BX.Catalog);
//# sourceMappingURL=script.map.js