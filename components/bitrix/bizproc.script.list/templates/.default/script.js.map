{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Reflection, Type, Event, Tag, Dom, Loc} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {Script} from 'bizproc.script';\n\nconst namespace = Reflection.namespace('BX.Bizproc');\n\nclass ScriptListComponent\n{\n\tgridId;\n\tcreateScriptButton;\n\tdocumentType;\n\n\tconstructor(options)\n\t{\n\t\tif(Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.gridId = options.gridId;\n\t\t\tthis.createScriptButton = options.createScriptButton\n\t\t\tthis.documentType = options.documentType\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tif (this.createScriptButton)\n\t\t{\n\t\t\tEvent.bind(this.createScriptButton, 'click', () => {\n\t\t\t\tScript.Manager.Instance.createScript(this.documentType).then(() => this.reloadGrid())\n\t\t\t});\n\t\t}\n\t}\n\n\tdeleteScript(scriptId: number)\n\t{\n\t\tMessageBox.confirm(\n\t\t\tLoc.getMessage('BIZPROC_SCRIPT_LIST_CONFIRM_DELETE'),\n\t\t\t() => {\n\t\t\t\tScript.Manager.Instance.deleteScript(scriptId).then((response) =>\n\t\t\t\t{\n\t\t\t\t\tif (response.data && response.data.error)\n\t\t\t\t\t{\n\t\t\t\t\t\tMessageBox.alert(response.data.error);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.reloadGrid()\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tLoc.getMessage('BIZPROC_SCRIPT_LIST_BTN_DELETE')\n\t\t);\n\t}\n\n\tactivateScript(scriptId: number)\n\t{\n\t\tScript.Manager.Instance.activateScript(scriptId).then(() => this.reloadGrid());\n\t}\n\n\tdeactivateScript(scriptId: number)\n\t{\n\t\tScript.Manager.Instance.deactivateScript(scriptId).then(() => this.reloadGrid());\n\t}\n\n\teditScript(scriptId: number)\n\t{\n\t\tScript.Manager.Instance.editScript(scriptId).then(() => this.reloadGrid());\n\t}\n\n\treloadGrid()\n\t{\n\t\tif (this.gridId)\n\t\t{\n\t\t\tconst grid = BX.Main.gridManager && BX.Main.gridManager.getInstanceById(this.gridId);\n\t\t\tif (grid)\n\t\t\t{\n\t\t\t\tgrid.reload();\n\t\t\t}\n\t\t}\n\t}\n}\n\nnamespace.ScriptListComponent = ScriptListComponent;"],"names":["namespace","Reflection","ScriptListComponent","options","Type","isPlainObject","gridId","createScriptButton","documentType","Event","bind","Script","Manager","Instance","createScript","then","reloadGrid","scriptId","MessageBox","confirm","Loc","getMessage","deleteScript","response","data","error","alert","activateScript","deactivateScript","editScript","grid","BX","Main","gridManager","getInstanceById","reload"],"mappings":";;;CAIA,IAAMA,SAAS,GAAGC,oBAAU,CAACD,SAAX,CAAqB,YAArB,CAAlB;;KAEME;CAML,+BAAYC,OAAZ,EACA;CAAA;;CACC,QAAGC,cAAI,CAACC,aAAL,CAAmBF,OAAnB,CAAH,EACA;CACC,WAAKG,MAAL,GAAcH,OAAO,CAACG,MAAtB;CACA,WAAKC,kBAAL,GAA0BJ,OAAO,CAACI,kBAAlC;CACA,WAAKC,YAAL,GAAoBL,OAAO,CAACK,YAA5B;CACA;CACD;;;;4BAGD;CAAA;;CACC,UAAI,KAAKD,kBAAT,EACA;CACCE,QAAAA,eAAK,CAACC,IAAN,CAAW,KAAKH,kBAAhB,EAAoC,OAApC,EAA6C,YAAM;CAClDI,UAAAA,qBAAM,CAACC,OAAP,CAAeC,QAAf,CAAwBC,YAAxB,CAAqC,KAAI,CAACN,YAA1C,EAAwDO,IAAxD,CAA6D;CAAA,mBAAM,KAAI,CAACC,UAAL,EAAN;CAAA,WAA7D;CACA,SAFD;CAGA;CACD;;;kCAEYC,UACb;CAAA;;CACCC,MAAAA,gCAAU,CAACC,OAAX,CACCC,aAAG,CAACC,UAAJ,CAAe,oCAAf,CADD,EAEC,YAAM;CACLV,QAAAA,qBAAM,CAACC,OAAP,CAAeC,QAAf,CAAwBS,YAAxB,CAAqCL,QAArC,EAA+CF,IAA/C,CAAoD,UAACQ,QAAD,EACpD;CACC,cAAIA,QAAQ,CAACC,IAAT,IAAiBD,QAAQ,CAACC,IAAT,CAAcC,KAAnC,EACA;CACCP,YAAAA,gCAAU,CAACQ,KAAX,CAAiBH,QAAQ,CAACC,IAAT,CAAcC,KAA/B;CACA,WAHD,MAKA;CACC,YAAA,MAAI,CAACT,UAAL;CACA;CACD,SAVD;CAWA,eAAO,IAAP;CACA,OAfF,EAgBCI,aAAG,CAACC,UAAJ,CAAe,gCAAf,CAhBD;CAkBA;;;oCAEcJ,UACf;CAAA;;CACCN,MAAAA,qBAAM,CAACC,OAAP,CAAeC,QAAf,CAAwBc,cAAxB,CAAuCV,QAAvC,EAAiDF,IAAjD,CAAsD;CAAA,eAAM,MAAI,CAACC,UAAL,EAAN;CAAA,OAAtD;CACA;;;sCAEgBC,UACjB;CAAA;;CACCN,MAAAA,qBAAM,CAACC,OAAP,CAAeC,QAAf,CAAwBe,gBAAxB,CAAyCX,QAAzC,EAAmDF,IAAnD,CAAwD;CAAA,eAAM,MAAI,CAACC,UAAL,EAAN;CAAA,OAAxD;CACA;;;gCAEUC,UACX;CAAA;;CACCN,MAAAA,qBAAM,CAACC,OAAP,CAAeC,QAAf,CAAwBgB,UAAxB,CAAmCZ,QAAnC,EAA6CF,IAA7C,CAAkD;CAAA,eAAM,MAAI,CAACC,UAAL,EAAN;CAAA,OAAlD;CACA;;;kCAGD;CACC,UAAI,KAAKV,MAAT,EACA;CACC,YAAMwB,IAAI,GAAGC,EAAE,CAACC,IAAH,CAAQC,WAAR,IAAuBF,EAAE,CAACC,IAAH,CAAQC,WAAR,CAAoBC,eAApB,CAAoC,KAAK5B,MAAzC,CAApC;;CACA,YAAIwB,IAAJ,EACA;CACCA,UAAAA,IAAI,CAACK,MAAL;CACA;CACD;CACD;;;;;CAGFnC,SAAS,CAACE,mBAAV,GAAgCA,mBAAhC;;;;"}