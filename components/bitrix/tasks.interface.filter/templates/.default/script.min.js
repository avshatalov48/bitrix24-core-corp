if(typeof BX.FilterEntitySelector==="undefined"){BX.FilterEntitySelector=function(){this._id="";this._settings={};this._fieldId="";this._control=null;this._selector=null;this._inputKeyPressHandler=BX.delegate(this.keypress,this)};BX.FilterEntitySelector.prototype={initialize:function(t,e){this._id=t;this._settings=e?e:{};this._fieldId=this.getSetting("fieldId","");BX.addCustomEvent(window,"BX.Main.Filter:customEntityFocus",BX.delegate(this.onCustomEntitySelectorOpen,this));BX.addCustomEvent(window,"BX.Main.Filter:customEntityBlur",BX.delegate(this.onCustomEntitySelectorClose,this))},getId:function(){return this._id},getSetting:function(t,e){return this._settings.hasOwnProperty(t)?this._settings[t]:e},keypress:function(t){},open:function(t,e){this._selector=new BX.Tasks.Integration.Socialnetwork.NetworkSelector({scope:t,id:this.getId()+"-selector",mode:this.getSetting("mode"),query:false,useSearch:true,useAdd:false,parent:this,popupOffsetTop:5,popupOffsetLeft:40});this._selector.bindEvent("item-selected",BX.delegate((function(t){this._control.setData(BX.util.htmlspecialcharsback(t.nameFormatted),t.id);if(!this.getSetting("multi")){this._selector.close()}}),this));this._selector.open()},close:function(){if(this._selector){this._selector.close()}},onCustomEntitySelectorOpen:function(t){this._control=t;if(this._fieldId!==t.getId()){this._selector=null;this.close()}else{this._selector=t;this.open(t.field)}},onCustomEntitySelectorClose:function(t){if(this._fieldId!==t.getId()){this.close()}}};BX.FilterEntitySelector.closeAll=function(){for(var t in this.items){if(this.items.hasOwnProperty(t)){this.items[t].close()}}};BX.FilterEntitySelector.items={};BX.FilterEntitySelector.create=function(t,e){var i=new BX.FilterEntitySelector(t,e);i.initialize(t,e);this.items[i.getId()]=i;return i}}if(typeof BX.TasksGroupsSelectorInit==="undefined"){BX.TasksGroupsSelectorInit=function(t){var e=null,i=t.selectorId,n=t.buttonAddId,o=t.pathTaskAdd.indexOf("?")===-1?t.pathTaskAdd+"?GROUP_ID=":t.pathTaskAdd+"&GROUP_ID=",s=t.messages,r=t.groups,l=t.currentGroup,a=t.groupLimit,d=t.offsetLeft;var c=function(t){if(BX(n)){BX(n).setAttribute("href",o+t)}};l.id=parseInt(l.id);l.text=BX.util.htmlspecialchars(l.text);c(l.id);BX.bind(BX(i),"click",(function(){if(e===null){var t=[];var n=function(t,o){BX.onCustomEvent(window,"BX.Kanban.ChangeGroup",[o.id,l.id]);BX.onCustomEvent(window,"BX.Tasks.ChangeGroup",[o.id,l.id]);if(o.id!==l.id){var s=e.getMenuItems();e.addMenuItem({id:l.id,text:l.text,onclick:BX.delegate(n,this)},s.length>0?s[0]["id"]:null);if(o.id!=="wo"){if(e.getMenuItem(o.id)){e.removeMenuItem(o.id)}else if(s.length>=a){e.removeMenuItem(s[s.length-3].id)}}}e.close();l={id:o.id,text:o.text};c(o.id);if(BX(i+"_text")){BX(i+"_text").innerHTML=o.text}BX.onCustomEvent(this,"onTasksGroupSelectorChange",[l])};for(var o=0,u=r.length;o<u;o++){t.push({id:parseInt(r[o]["id"]),text:BX.util.htmlspecialchars(r[o]["text"]),class:"menu-popup-item-none",onclick:BX.delegate(n,this)})}if(r.length>0){t.push({delimiter:true});t.push({id:"new",text:s.TASKS_BTN_GROUP_SELECT,onclick:function(t,i){e.getPopupWindow().setAutoHide(false);var o=new BX.Tasks.Integration.Socialnetwork.NetworkSelector({scope:i.getContainer(),id:"group-selector",mode:"group",query:false,useSearch:true,useAdd:false,parent:this,popupOffsetTop:5,popupOffsetLeft:40});o.bindEvent("item-selected",(function(t){n(null,{id:t.id,text:t.nameFormatted.length>50?t.nameFormatted.substring(0,50)+"...":t.nameFormatted});o.close()}));o.bindEvent("close",(function(t){e.getPopupWindow().setAutoHide(true)}));o.open()}})}if(!d){d=0}e=BX.PopupMenu.create(i,BX(i),t,{autoHide:true,closeByEsc:true,offsetLeft:d})}e.popupWindow.show()}))}}if(typeof BX.Tasks.SortManager==="undefined"){BX.Tasks.SortManager={setSort:function(t,e,i){e=e||"asc";if(BX.Main.gridManager!=undefined){var n=BX.Main.gridManager.getById(i).instance;n.sortByColumn({sort_by:t,sort_order:e});if(t==="SORTING"){n.getRows().enableDragAndDrop()}else{n.getRows().disableDragAndDrop()}}else{BX.ajax.post(BX.util.add_url_param("/bitrix/components/bitrix/main.ui.grid/settings.ajax.php",{GRID_ID:i,action:"setSort"}),{by:t,order:e},(function(t){try{t=JSON.parse(t);if(!t.error){window.location.reload()}}catch(t){}}))}}}}if(typeof BX.Tasks.SprintSelector==="undefined"){BX.Tasks.SprintSelector=function(t,e){if(!BX(t)){return}BX.bind(BX(t).querySelector(".webform-small-button"),"click",(function(){var i=new BX.UI.EntitySelector.Dialog({targetNode:BX(t),width:400,height:300,multiple:false,dropdownMode:true,enableSearch:true,compactView:true,showAvatars:false,cacheable:false,preselectedItems:[["sprint-selector",e.sprintId]],entities:[{id:"sprint-selector",options:{groupId:e.groupId,onlyCompleted:true},dynamicLoad:true,dynamicSearch:true}],events:{"Item:onSelect":function(i){var n=i.getData().item;e.sprintId=n.id;BX.onCustomEvent(BX(t),"onTasksGroupSelectorChange",[{id:e.groupId,sprintId:n.id,name:n.customData.get("name")}]);var o=BX(t).querySelector(".webform-small-button-text");o.textContent=n.customData.get("label")}}});i.show()}))}}if(typeof BX.Tasks.ProjectSelector==="undefined"){BX.Tasks.ProjectSelector={reloadProject:function(t){var e=document.location.href;e=BX.util.add_url_param(e,{group_id:t});document.location.href=e}}}
//# sourceMappingURL=script.map.js