{"version":3,"file":"index.js","sources":["src/facebook.catalog.connector.js"],"sourcesContent":["import {Event, Loc, Reflection, Tag, Uri} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\nimport 'ui.design-tokens';\nimport './facebook.catalog.connector.css';\n\nclass FacebookCatalogConnector\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('seo-client-auth-result', (event) => {\n\t\t\tif (event.reload) {\n\t\t\t\tBX.Dom.addClass(document.getElementById('catalog-login-button'), 'ui-btn-wait');\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(\n\t\t\tdocument.getElementById('catalog-logout-button'),\n\t\t\t'click',\n\t\t\tthis.confirmLogout.bind(this)\n\t\t);\n\t}\n\n\tconfirmLogout()\n\t{\n\t\tconst confirmPopup = new Popup({\n\t\t\tcontent: this.getConfirmPopupHtml(),\n\t\t\tautoHide: true,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tcloseByEsc: true,\n\t\t\toverlay: {opacity: 20},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext: Loc.getMessage('IMCONNECTOR_COMPONENT_FACEBOOK_OPENLINES_CATALOG_DISCONNECT'),\n\t\t\t\t\tcolor: BX.UI.Button.Color.DANGER,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tconfirmPopup.close();\n\t\t\t\t\t\tthis.logout();\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext: Loc.getMessage('IMCONNECTOR_COMPONENT_FACEBOOK_OPENLINES_CATALOG_CANCEL'),\n\t\t\t\t\tcolor: BX.UI.Button.Color.LINK,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tconfirmPopup.close();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tconfirmPopup.show();\n\t}\n\n\tgetConfirmPopupHtml()\n\t{\n\t\treturn Tag.render`<div class=\"imconnector-facebook-catalog-popup\">\n\t\t\t<div class=\"imconnector-facebook-catalog-popup-text\">\n\t\t\t\t${Loc.getMessage('IMCONNECTOR_COMPONENT_FACEBOOK_OPENLINES_CATALOG_REMOVE')}\n\t\t\t</div>\n\t\t</div>`;\n\t}\n\n\tlogout()\n\t{\n\t\tBX.ajax.runComponentAction('bitrix:imconnector.facebook', 'logout', {'mode': 'ajax'})\n\t\t\t.then(() => {\n\t\t\t\tdocument.location.href = new Uri(document.location.href)\n\t\t\t\t\t.setQueryParams({MENU_TAB: 'catalog'})\n\t\t\t\t;\n\t\t\t});\n\t}\n}\n\nReflection.namespace('BX.ImConnector').FacebookCatalogConnector = FacebookCatalogConnector;"],"names":["FacebookCatalogConnector","EventEmitter","subscribe","event","reload","BX","Dom","addClass","document","getElementById","Event","bind","confirmLogout","confirmPopup","Popup","content","getConfirmPopupHtml","autoHide","cacheable","closeIcon","closeByEsc","overlay","opacity","buttons","UI","Button","text","Loc","getMessage","color","Color","DANGER","onclick","close","logout","LINK","show","Tag","render","ajax","runComponentAction","then","location","href","Uri","setQueryParams","MENU_TAB","Reflection","namespace"],"mappings":";;;;;;KAMMA;CAEL,sCACA;CAAA;CACCC,IAAAA,6BAAY,CAACC,SAAb,CAAuB,wBAAvB,EAAiD,UAACC,KAAD,EAAW;CAC3D,UAAIA,KAAK,CAACC,MAAV,EAAkB;CACjBC,QAAAA,EAAE,CAACC,GAAH,CAAOC,QAAP,CAAgBC,QAAQ,CAACC,cAAT,CAAwB,sBAAxB,CAAhB,EAAiE,aAAjE;CACA;CACD,KAJD;CAMAC,IAAAA,eAAK,CAACC,IAAN,CACCH,QAAQ,CAACC,cAAT,CAAwB,uBAAxB,CADD,EAEC,OAFD,EAGC,KAAKG,aAAL,CAAmBD,IAAnB,CAAwB,IAAxB,CAHD;CAKA;;;;qCAGD;CAAA;;CACC,UAAME,YAAY,GAAG,IAAIC,gBAAJ,CAAU;CAC9BC,QAAAA,OAAO,EAAE,KAAKC,mBAAL,EADqB;CAE9BC,QAAAA,QAAQ,EAAE,IAFoB;CAG9BC,QAAAA,SAAS,EAAE,KAHmB;CAI9BC,QAAAA,SAAS,EAAE,IAJmB;CAK9BC,QAAAA,UAAU,EAAE,IALkB;CAM9BC,QAAAA,OAAO,EAAE;CAACC,UAAAA,OAAO,EAAE;CAAV,SANqB;CAO9BC,QAAAA,OAAO,EAAE,CACR,IAAIlB,EAAE,CAACmB,EAAH,CAAMC,MAAV,CAAiB;CAChBC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,6DAAf,CADU;CAEhBC,UAAAA,KAAK,EAAExB,EAAE,CAACmB,EAAH,CAAMC,MAAN,CAAaK,KAAb,CAAmBC,MAFV;CAGhBC,UAAAA,OAAO,EAAE,mBAAM;CACdnB,YAAAA,YAAY,CAACoB,KAAb;;CACA,YAAA,KAAI,CAACC,MAAL;CACA;CANe,SAAjB,CADQ,EASR,IAAI7B,EAAE,CAACmB,EAAH,CAAMC,MAAV,CAAiB;CAChBC,UAAAA,IAAI,EAAEC,aAAG,CAACC,UAAJ,CAAe,yDAAf,CADU;CAEhBC,UAAAA,KAAK,EAAExB,EAAE,CAACmB,EAAH,CAAMC,MAAN,CAAaK,KAAb,CAAmBK,IAFV;CAGhBH,UAAAA,OAAO,EAAE,mBAAM;CACdnB,YAAAA,YAAY,CAACoB,KAAb;CACA;CALe,SAAjB,CATQ;CAPqB,OAAV,CAArB;CA0BApB,MAAAA,YAAY,CAACuB,IAAb;CACA;;;2CAGD;CACC,aAAOC,aAAG,CAACC,MAAX,2OAEIX,aAAG,CAACC,UAAJ,CAAe,yDAAf,CAFJ;CAKA;;;8BAGD;CACCvB,MAAAA,EAAE,CAACkC,IAAH,CAAQC,kBAAR,CAA2B,6BAA3B,EAA0D,QAA1D,EAAoE;CAAC,gBAAQ;CAAT,OAApE,EACEC,IADF,CACO,YAAM;CACXjC,QAAAA,QAAQ,CAACkC,QAAT,CAAkBC,IAAlB,GAAyB,IAAIC,aAAJ,CAAQpC,QAAQ,CAACkC,QAAT,CAAkBC,IAA1B,EACvBE,cADuB,CACR;CAACC,UAAAA,QAAQ,EAAE;CAAX,SADQ,CAAzB;CAGA,OALF;CAMA;;;;;AAGFC,qBAAU,CAACC,SAAX,CAAqB,gBAArB,EAAuChD,wBAAvC,GAAkEA,wBAAlE;;;;"}