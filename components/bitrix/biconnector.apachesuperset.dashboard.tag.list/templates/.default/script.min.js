(function(t,e,n,a,i){"use strict";var r,l,o,s,c;function d(t,e){g(t,e);e.add(t)}function u(t,e,n){g(t,e);e.set(t,n)}function g(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function v(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var T=new WeakMap;var f=new WeakSet;var E=new WeakSet;var p=new WeakSet;var _=new WeakSet;var S=new WeakSet;var I=new WeakSet;var h=new WeakSet;var y=new WeakSet;var C=function(){function t(e){var n;babelHelpers.classCallCheck(this,t);d(this,y);d(this,h);d(this,I);d(this,S);d(this,_);d(this,p);d(this,E);d(this,f);u(this,T,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,T,(n=BX.Main.gridManager.getById(e.gridId))===null||n===void 0?void 0:n.instance)}babelHelpers.createClass(t,[{key:"getGrid",value:function t(){return babelHelpers.classPrivateFieldGet(this,T)}},{key:"renameTag",value:function t(a){var i,r=this,l;var o=this.getGrid();var s=o.getRows().getById(a);if(!s){return}var c=s.getNode();e.Dom.removeClass(c,"tag-title-edited");var d=(i=s.getCellById("TITLE"))===null||i===void 0?void 0:i.querySelector(".tag-title-wrapper");if(!d){return}var u=v(this,E,D).call(this,a,s.getEditData().TITLE,(function(){v(r,h,L).call(r,a)}),(function(t){var i=v(r,p,b).call(r,a).querySelector("span").innerText;v(r,p,b).call(r,a).querySelector("span").innerText=t;var l=s.getEditData();l.TITLE=t;var d=o.getParam("EDITABLE_DATA");if(e.Type.isPlainObject(d)){d[s.getId()]=l}return new Promise((function(o,s){v(r,y,R).call(r,a,t).then((function(){e.Dom.addClass(c,"tag-title-edited");var i=e.Loc.getMessage("BICONNECTOR_APACHE_SUPERSET_DASHBOARD_TAG_LIST_RENAME_TITLE_SUCCESS",{"#NEW_TITLE#":e.Text.encode(t)});n.UI.Notification.Center.notify({content:i});v(r,h,L).call(r,a);v(r,S,A).call(r,a,t);o()}))["catch"]((function(t){if(t.errors){v(r,f,w).call(r,t.errors)}v(r,p,b).call(r,a).querySelector("span").innerText=i;l.TITLE=i;s()}))}))}));var g=d.querySelector(".tag-title-preview");if(g){e.Dom.style(g,"display","none")}e.Dom.append(u,d);var T=(l=s.getCellById("EDIT_URL"))===null||l===void 0?void 0:l.querySelector("a");var _=function t(){e.Event.unbind(s.getActionsButton(),"click",t);if(T){e.Event.unbind(T,"click",t)}v(r,h,L).call(r,a)};e.Event.bind(s.getActionsButton(),"click",_);if(T){e.Event.bind(T,"click",_)}}},{key:"deleteTag",value:function t(n){var i=this;var r=this.getGrid();var l=r.getRows().getById(n);var o=l.getEditData().DASHBOARD_COUNT;if(!o){v(this,_,m).call(this,n);return}var s=a.MessageBox.confirm(e.Loc.getMessage("BICONNECTOR_APACHE_SUPERSET_DASHBOARD_TAG_LIST_DELETE_POPUP"),(function(){v(i,_,m).call(i,n);s.close()}),e.Loc.getMessage("BICONNECTOR_APACHE_SUPERSET_DASHBOARD_TAG_LIST_DELETE_POPUP_YES"))}}]);return t}();function w(t){if(t[0]&&t[0].message){BX.UI.Notification.Center.notify({content:e.Text.encode(t[0].message)})}}function D(t,a,i,d){var u=e.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<input class="main-grid-editor main-grid-editor-text" type="text">\n\t\t'])));u.value=a;var g=function t(){var a=u.value;e.Dom.removeClass(u,"tag-title-input-danger");if(a.trim()===""){n.UI.Notification.Center.notify({content:e.Loc.getMessage("BICONNECTOR_APACHE_SUPERSET_DASHBOARD_TAG_LIST_TITLE_ERROR_EMPTY")});e.Dom.addClass(u,"tag-title-input-danger");return}d(u.value).then((function(){e.Dom.style(f,"display","none");e.Dom.attr(u,"disabled",true)}))["catch"]((function(){e.Dom.addClass(u,"tag-title-input-danger")}))};e.Event.bind(u,"keydown",(function(t){if(t.keyCode===13){g();t.preventDefault()}else if(t.keyCode===27){i();t.preventDefault()}}));var v=e.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<a>\n\t\t\t\t<i\n\t\t\t\t\tclass="ui-icon-set --check"\n\t\t\t\t\tstyle="--ui-icon-set__icon-size: 21px; --ui-icon-set__icon-color: var(--ui-color-palette-gray-40);"\n\t\t\t\t></i>\n\t\t\t</a>\n\t\t'])));var T=e.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<a>\n\t\t\t\t<i\n\t\t\t\t\tclass="ui-icon-set --cross-60"\n\t\t\t\t\tstyle="--ui-icon-set__icon-size: 21px; --ui-icon-set__icon-color: var(--ui-color-palette-gray-40);"\n\t\t\t\t></i>\n\t\t\t</a>\n\t\t'])));var f=e.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="tag-title-wrapper__buttons">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),v,T);e.Event.bind(T,"click",(function(){i()}));e.Event.bind(v,"click",g);return e.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="tag-title-wrapper__item tag-title-edit">\n\t\t\t\t','\n\t\t\t\t<div class="tag-title-wrapper__buttons-wrapper">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),u,f)}function b(t){var e;var n=this.getGrid();var a=n.getRows().getById(t);if(!a){return null}var i=(e=a.getCellById("TITLE"))===null||e===void 0?void 0:e.querySelector(".tag-title-wrapper");if(!i){return null}var r=i.querySelector(".tag-title-preview");if(r){return r}return null}function m(t){var a=this;return e.ajax.runAction("biconnector.dashboardTag.delete",{data:{id:t}}).then((function(){a.getGrid().removeRow(t,null,null,(function(){v(a,I,B).call(a,t)}));var i=e.Loc.getMessage("BICONNECTOR_APACHE_SUPERSET_DASHBOARD_TAG_LIST_DELETE_SUCCESS");n.UI.Notification.Center.notify({content:i})}))["catch"]((function(t){if(t.errors){v(a,f,w).call(a,t.errors)}}))}function A(t,e){if(i.SidePanel.Instance){i.SidePanel.Instance.postMessage(window,"BIConnector.Superset.DashboardTagGrid:onTagChange",{tagId:t,title:e})}}function B(t){if(i.SidePanel.Instance){i.SidePanel.Instance.postMessage(window,"BIConnector.Superset.DashboardTagGrid:onTagDelete",{tagId:t})}}function L(t){var n,a;var i=this.getGrid().getRows().getById(t);if(!i){return}var r=(n=i.getCellById("TITLE"))===null||n===void 0?void 0:n.querySelector(".tag-title-edit");var l=(a=i.getCellById("TITLE"))===null||a===void 0?void 0:a.querySelector(".tag-title-preview");if(r){e.Dom.remove(r)}if(l){e.Dom.style(l,"display","flex")}}function R(t,n){return e.ajax.runAction("biconnector.dashboardTag.rename",{data:{id:t,title:n}})}e.Reflection.namespace("BX.BIConnector").SupersetDashboardTagGridManager=C})(this.window=this.window||{},BX,BX,BX.UI.Dialogs,BX);
//# sourceMappingURL=script.map.js