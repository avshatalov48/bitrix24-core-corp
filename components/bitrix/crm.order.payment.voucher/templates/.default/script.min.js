BX.namespace("BX.Crm");if(typeof BX.Crm.OrderPaymentVoucher==="undefined"){BX.Crm.OrderPaymentVoucher=function(){this._id="";this._settings={}};BX.Crm.OrderPaymentVoucher.prototype={initialize:function(e,t){this._id=BX.type.isNotEmptyString(e)?e:BX.util.getRandomString(4);this._settings=t?t:{};if(BX.Crm.EntityEditor!=="undefined"){this._editor=BX.Crm.EntityEditor.getDefault();this.setEditorSaveSuccess();this.setEditorInnerCancel();this.setEditorHasChangedControl()}window.top.BX.SidePanel.Instance.postMessage(window,"CrmOrderPaymentVoucher::Initialized",{entityTypeId:BX.CrmEntityType.enumeration.orderpayment,entityId:BX.prop.getString(t,"entityId",0),voucherObject:this})},setField:function(e,t){this._editor._model.setField(e,t);var i;if(i=this._editor.getControlByIdRecursive("name")){i.onModelChange()}},setEditorHasChangedControl:function(){this._editor.hasChangedControls=function(){return true}},setEditorSaveSuccess:function(){var e=this._settings,t=this;var i="save";if("performSaveAction"in this._editor){i="performSaveAction"}this._editor[i]=function(i){this._toolPanel.setLocked(false);this._toolPanel.clearErrors();var n=t._editor.getAllControls();var r=t._editor._model.getIntegerField("ENTITY_ID",0);if(r===0){r=BX.prop.getInteger(e,"entityId",0)}var o={entityTypeId:BX.CrmEntityType.enumeration.orderpayment,entityId:r};for(var d in n){if(n.hasOwnProperty(d)){o[n[d].getId()]=n[d].getRuntimeValue()}}o["PAID"]=t._editor._model.getField("PAID");o["source"]=t._editor._model.getField("source");window.top.BX.SidePanel.Instance.postMessage(window,"CrmOrderPaymentVoucher::Update",o);if(typeof top.BX.SidePanel!=="undefined"){this._enableCloseConfirmation=false;t.closeSlider()}}},closeSlider:function(){window.setTimeout((function(){var e=top.BX.SidePanel.Instance.getSliderByWindow(window);if(e&&e.isOpen()){e.close(false);setTimeout((function(){e.destroy()}),500)}}),250)},setEditorInnerCancel:function(){var e=this;this._editor.innerCancel=function(){if(typeof top.BX.SidePanel!=="undefined"){this._enableCloseConfirmation=false;e.closeSlider()}}}};BX.Crm.OrderPaymentVoucher.create=function(e,t){var i=new BX.Crm.OrderPaymentVoucher;i.initialize(e,t);return i}}
//# sourceMappingURL=script.map.js