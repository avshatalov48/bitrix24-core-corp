{"version":3,"file":"script.js","sources":["src/js/deal.onboarding.manager.js","src/js/deal.manager.js"],"sourcesContent":["//@flow\nimport {userOptions, Loc, Dom, Event} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Guide} from 'ui.tour';\nimport 'spotlight';\n\nexport type OnboardingData = {\n\tchain: number;\n\tchainStep: number;\n\tsuccessDealGuideIsOver: boolean;\n};\n\ntype Params = {\n\tonboardingData: OnboardingData;\n\tcontentContainer: HTMLElement;\n\tserviceUrl: string;\n\tdealDetailManager: BX.Crm.DealDetailManager;\n};\n\nexport class DealOnboardingManager\n{\n\t#onboardingData: OnboardingData;\n\t#contentContainer: HTMLElement;\n\t#serviceUrl: string;\n\t#dealDetailManager: BX.Crm.DealDetailManager;\n\n\t#activeDocumentGuide: Guide|null = null;\n\n\tstatic get productsTabId(): string\n\t{\n\t\treturn 'tab_products';\n\t}\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#onboardingData = params.onboardingData;\n\t\tthis.#contentContainer = params.contentContainer;\n\t\tthis.#serviceUrl = params.serviceUrl;\n\t\tthis.#dealDetailManager = params.dealDetailManager;\n\t}\n\n\t#getContentContainer(): HTMLElement\n\t{\n\t\treturn this.#contentContainer;\n\t}\n\n\t#getButtonsContainer(): HTMLElement\n\t{\n\t\treturn this.#getContentContainer().querySelector('.main-buttons');\n\t}\n\n\tprocessOnboarding(): void\n\t{\n\t\tconst chain = this.#onboardingData.chain;\n\t\tconst step = this.#onboardingData.chainStep;\n\t\tconst successDealGuideIsOver = this.#onboardingData.successDealGuideIsOver;\n\n\t\tif (chain === 0)\n\t\t{\n\t\t\tif (step < 1)\n\t\t\t{\n\t\t\t\tthis.#processProductTabHint();\n\t\t\t}\n\t\t\tif (step < 2)\n\t\t\t{\n\t\t\t\tthis.#hintProductListField();\n\t\t\t}\n\t\t}\n\t\telse if (chain === 1 && step === 0)\n\t\t{\n\t\t\tthis.#hintAddDocumentLink();\n\t\t}\n\n\t\tif (!successDealGuideIsOver)\n\t\t{\n\t\t\tthis.#hintSuccessDealDocumentInTimeline();\n\t\t}\n\t}\n\n\t#processProductTabHint(): void\n\t{\n\t\tconst guideText = {\n\t\t\ttitle: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_AUTOMATIC_RESERVATION_GUIDE_TITLE'),\n\t\t\ttext: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_AUTOMATIC_RESERVATION_GUIDE_TEXT'),\n\t\t};\n\n\t\tif (this.#dealDetailManager.isTabButtonVisible(DealOnboardingManager.productsTabId))\n\t\t{\n\t\t\tthis.#hintToVisibleProductTab();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#hintToHiddenProductTab();\n\t\t}\n\t}\n\n\t#createHintToProductTab(target: HTMLElement, guideEvents: Object = {}): Guide\n\t{\n\t\tconst guideText = {\n\t\t\ttitle: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_AUTOMATIC_RESERVATION_GUIDE_TITLE'),\n\t\t\ttext: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_AUTOMATIC_RESERVATION_GUIDE_TEXT'),\n\t\t};\n\n\t\treturn new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: target,\n\t\t\t\t\ttitle: guideText.title,\n\t\t\t\t\ttext: guideText.text,\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\tevents: guideEvents\n\t\t\t\t}\n\t\t\t],\n\t\t\tonEvents: true\n\t\t});\n\t}\n\n\t#hintToVisibleProductTab(): void\n\t{\n\t\tconst productsTabButton = this.#dealDetailManager.getTabMenuItemContainer(DealOnboardingManager.productsTabId);\n\n\t\tconst productsTabGuide = this.#createHintToProductTab(\n\t\t\tproductsTabButton,\n\t\t\t{\n\t\t\t\tonClose: () => {\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'firstChainStage', 1);\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t\tproductsTabGuide.showNextStep();\n\t\tconst tabsContainer = this.#dealDetailManager.getTabManager().getTabMenuContainer();\n\n\t\tconst windowResizeHandler = () => {\n\t\t\tif (!this.#dealDetailManager.isTabButtonVisible(DealOnboardingManager.productsTabId))\n\t\t\t{\n\t\t\t\tproductsTabGuide.close();\n\t\t\t\tEvent.unbind(window, 'resize', windowResizeHandler);\n\t\t\t}\n\t\t};\n\n\t\tEvent.bind(window, 'resize', windowResizeHandler);\n\t\tEvent.bindOnce(tabsContainer, 'mousedown', () => {\n\t\t\tproductsTabGuide.close();\n\t\t\tEvent.unbind(window, 'resize', windowResizeHandler);\n\t\t});\n\t}\n\n\t#hintToHiddenProductTab(): void\n\t{\n\t\tconst moreButton = this.#dealDetailManager.getTabManager().getMoreButton();\n\t\tconst spotlight = new BX.SpotLight(\n\t\t\t{\n\t\t\t\tid: `${DealOnboardingManager.productsTabId}_spotlight`,\n\t\t\t\ttargetElement: moreButton,\n\t\t\t\tautoSave: true,\n\t\t\t\ttargetVertex: \"middle-center\",\n\t\t\t\tzIndex: 200,\n\t\t\t}\n\t\t);\n\t\tspotlight.show();\n\t\tspotlight.container.style.pointerEvents = \"none\";\n\n\t\tconst onOpenMoreMenuHandler = (event) => {\n\t\t\tconst eventMoreMenu = event.target.getMoreMenu();\n\t\t\tconst dealMoreMenu = this.#dealDetailManager.getTabManager().getMoreMenu();\n\n\t\t\tif (eventMoreMenu === dealMoreMenu)\n\t\t\t{\n\t\t\t\tspotlight.close();\n\t\t\t\tconst productsTabGuide = this.#createHintToProductTab(\n\t\t\t\t\tthis.#dealDetailManager.getTabFromMoreMenu(DealOnboardingManager.productsTabId)\n\t\t\t\t);\n\n\t\t\t\tconst moreMenuContainer = eventMoreMenu.getMenuContainer();\n\n\t\t\t\tconst tabHintTimeout = setTimeout(() => {\n\t\t\t\t\tproductsTabGuide.showNextStep();\n\n\t\t\t\t\tBX.bindOnce(moreMenuContainer, 'click', moreMenuClickHandler);\n\n\t\t\t\t\tconst productsTabPopup = productsTabGuide.getPopup();\n\t\t\t\t\tEventEmitter.subscribeOnce(productsTabPopup, 'onClose', onPopupCloseHandler);\n\n\t\t\t\t\tconst popupContainer = productsTabGuide.getPopup().getContentContainer().parentNode;\n\t\t\t\t\tBX.bind(popupContainer, 'mouseenter', () => {\n\t\t\t\t\t\tevent.target.showMoreMenu();\n\t\t\t\t\t});\n\t\t\t\t\tBX.bind(popupContainer, 'mouseleave', () => {\n\t\t\t\t\t\tconst outOfPopupTimeout = setTimeout(() => {\n\t\t\t\t\t\t\tevent.target.closeMoreMenu();\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t\tEvent.bindOnce(dealMoreMenu.getMenuContainer(), 'mouseenter', () => {\n\t\t\t\t\t\t\tclearTimeout(outOfPopupTimeout);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}, 50);\n\n\n\t\t\t\tconst onPopupCloseHandler = (event) => {\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'firstChainStage', 1);\n\n\t\t\t\t\tEvent.unbind(window, 'resize', windowResizeHandler);\n\t\t\t\t\tEvent.unbind(moreMenuContainer, 'click', moreMenuClickHandler);\n\t\t\t\t\tEventEmitter.unsubscribe('BX.Main.InterfaceButtons:onMoreMenuShow', onOpenMoreMenuHandler);\n\t\t\t\t};\n\n\n\t\t\t\tconst moreMenuClickHandler = () => {\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'firstChainStage', 1);\n\t\t\t\t\tproductsTabGuide.close();\n\t\t\t\t};\n\t\t\t\tEvent.bind(dealMoreMenu.getMenuContainer(), 'click', onPopupCloseHandler);\n\n\t\t\t\tEventEmitter.subscribeOnce('BX.Main.InterfaceButtons:onMoreMenuClose', (event) => {\n\t\t\t\t\tconst eventMoreMenu = event.target.getMoreMenu();\n\t\t\t\t\tconst dealMoreMenu = this.#dealDetailManager.getTabManager().getMoreMenu();\n\n\t\t\t\t\tif (eventMoreMenu === dealMoreMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tclearTimeout(tabHintTimeout);\n\t\t\t\t\t\tEvent.unbind(moreMenuContainer, 'click', moreMenuClickHandler);\n\t\t\t\t\t\tproductsTabGuide.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tEventEmitter.subscribe('BX.Main.InterfaceButtons:onMoreMenuShow', onOpenMoreMenuHandler);\n\n\t\tconst windowResizeHandler = () => {\n\t\t\tif (this.#dealDetailManager.isTabButtonVisible(DealOnboardingManager.productsTabId))\n\t\t\t{\n\t\t\t\tspotlight.close();\n\t\t\t\tthis.#hintToVisibleProductTab();\n\t\t\t\tEvent.unbind(window, 'resize', windowResizeHandler);\n\t\t\t\tEventEmitter.unsubscribe('BX.Main.InterfaceButtons:onMoreMenuShow', onOpenMoreMenuHandler);\n\t\t\t}\n\t\t}\n\t\tEvent.bind(window, 'resize', windowResizeHandler);\n\t}\n\n\t#hintProductListField(): void\n\t{\n\t\tconst buttonsContainer = this.#getContentContainer().querySelector('.main-buttons');\n\t\tconst productListTabListener = (event) => {\n\t\t\tconst [productListEditor] = event.data;\n\n\t\t\tconst buttonsPanelListener = () => {\n\t\t\t\tconst activeHint = productListEditor.getActiveHint();\n\t\t\t\tif (activeHint !== null)\n\t\t\t\t{\n\t\t\t\t\tactiveHint.close();\n\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', buttonsPanelListener);\n\t\t\t\t}\n\t\t\t}\n\t\t\tEvent.bind(buttonsContainer, 'click', buttonsPanelListener);\n\n\t\t\tconst productList = productListEditor.products;\n\t\t\tlet rowId = '';\n\t\t\tif (productList instanceof Array)\n\t\t\t{\n\t\t\t\tconst firstProductRow = productList.find((row) => !row.getModel().isService());\n\t\t\t\tif (firstProductRow)\n\t\t\t\t{\n\t\t\t\t\trowId = firstProductRow.getId();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!rowId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tproductListEditor.showFieldTourHint(\n\t\t\t\t'STORE_INFO',\n\t\t\t\t{\n\t\t\t\t\ttitle: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_PRODUCT_STORE_GUIDE_TITLE'),\n\t\t\t\t\ttext: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_PRODUCT_STORE_GUIDE_TEXT'),\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'firstChainStage', 2);\n\t\t\t\t\tBX.ajax.post(\n\t\t\t\t\t\tthis.#serviceUrl,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tACTION: 'FIX_FIRST_ONBOARD_CHAIN_VIEW',\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', buttonsPanelListener);\n\n\t\t\t\t\tEventEmitter.unsubscribe(\n\t\t\t\t\t\t'onDemandRecalculateWrapper',\n\t\t\t\t\t\tproductListTabListener\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t['RESERVE_INFO'],\n\t\t\t\trowId\n\t\t\t);\n\t\t}\n\n\t\tEventEmitter.subscribe(\n\t\t\t'onDemandRecalculateWrapper',\n\t\t\tproductListTabListener\n\t\t);\n\t}\n\n\t#hintAddDocumentLink()\n\t{\n\t\tconst documentsListTourListener = (event) => {\n\t\t\tif (this.#activeDocumentGuide !== null)\n\t\t\t{\n\t\t\t\tthis.#activeDocumentGuide.close();\n\t\t\t}\n\n\t\t\tconst buttonsContainer = this.#getButtonsContainer();\n\t\t\tconst sumControlContainer = document.querySelector('[data-cid=\"OPPORTUNITY_WITH_CURRENCY\"]');\n\t\t\tconst addDocumentButton = sumControlContainer && sumControlContainer.querySelector('.crm-entity-widget-payment-add-box');\n\t\t\tif (addDocumentButton !== null) {\n\t\t\t\tconst settingsButton = sumControlContainer.querySelector('.ui-entity-editor-block-context-menu');\n\t\t\t\tconst dragButton = sumControlContainer.querySelector('.ui-entity-editor-draggable-btn');\n\t\t\t\tconst guideText = {\n\t\t\t\t\ttitle: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_ADD_DOCUMENT_GUIDE_TITLE'),\n\t\t\t\t\ttext: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_ADD_DOCUMENT_GUIDE_TEXT'),\n\t\t\t\t};\n\n\t\t\t\tconst addDocumentGuide = new Guide({\n\t\t\t\t\tsteps: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttarget: addDocumentButton,\n\t\t\t\t\t\t\ttitle: guideText.title,\n\t\t\t\t\t\t\ttext: guideText.text,\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', userCloseHintHandler);\n\t\t\t\t\t\t\t\t\tEvent.unbind(settingsButton, 'click', userCloseHintHandler);\n\t\t\t\t\t\t\t\t\tEvent.unbind(dragButton, 'mousedown', userCloseHintHandler);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tonEvents: true\n\t\t\t\t});\n\t\t\t\tthis.#activeDocumentGuide = addDocumentGuide;\n\n\t\t\t\tconst userCloseHintHandler = () => {\n\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', userCloseHintHandler);\n\t\t\t\t\tEventEmitter.unsubscribe(\n\t\t\t\t\t\t'PaymentDocuments.EntityEditor:changeDocuments',\n\t\t\t\t\t\tdocumentsListTourListener\n\t\t\t\t\t);\n\n\t\t\t\t\taddDocumentGuide.close();\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'secondChainStage', 1);\n\n\t\t\t\t}\n\n\t\t\t\taddDocumentGuide.showNextStep();\n\t\t\t\tEvent.bind(addDocumentGuide.getPopup().closeIcon, 'click', userCloseHintHandler);\n\t\t\t\tEvent.bind(buttonsContainer, 'click', userCloseHintHandler);\n\t\t\t\tEvent.bind(addDocumentButton, 'click', userCloseHintHandler);\n\t\t\t\tEvent.bind(settingsButton, 'click', userCloseHintHandler);\n\t\t\t\tEvent.bind(dragButton, 'mousedown', userCloseHintHandler);\n\t\t\t}\n\t\t};\n\n\t\tEventEmitter.subscribe(\n\t\t\t'PaymentDocuments.EntityEditor:changeDocuments',\n\t\t\tdocumentsListTourListener\n\t\t);\n\t}\n\n\t#hintSuccessDealDocumentInTimeline(): void\n\t{\n\t\tconst timelineGuideListener = (event) => {\n\t\t\tif (event.data[1].currentStepId === 'WON' && event.data[1].currentSemantics === 'success')\n\t\t\t{\n\t\t\t\tEventEmitter.unsubscribe(\n\t\t\t\t\t'Crm.EntityProgress.Saved',\n\t\t\t\t\ttimelineGuideListener\n\t\t\t\t);\n\n\t\t\t\tconst onHistoryNodeAddedHandler = (event) => {\n\t\t\t\t\tEventEmitter.unsubscribe(\n\t\t\t\t\t\t'BX.Crm.Timeline.Items.FinalSummaryDocuments:onHistoryNodeAdded',\n\t\t\t\t\t\tonHistoryNodeAddedHandler\n\t\t\t\t\t);\n\n\t\t\t\t\tBX.onCustomEvent(window, 'OpenEntityDetailTab', ['main']);\n\t\t\t\t\tconst [timelineDocsNode] = event.data;\n\t\t\t\t\tconst previousNodePos = {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0,\n\t\t\t\t\t};\n\t\t\t\t\tconst documentLinkNodeWatcherId = setInterval(() => {\n\t\t\t\t\t\tconst documentLinkNode = timelineDocsNode.querySelector('.crm-entity-stream-content-document-description');\n\t\t\t\t\t\tif (documentLinkNode === null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst nodePos = Dom.getPosition(documentLinkNode);\n\t\t\t\t\t\tif (nodePos.x === 0 && nodePos.y === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tnodePos.x !== previousNodePos.x\n\t\t\t\t\t\t\t|| nodePos.y !== previousNodePos.y\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpreviousNodePos.x = nodePos.x;\n\t\t\t\t\t\t\tpreviousNodePos.y = nodePos.y;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tclearInterval(documentLinkNodeWatcherId);\n\n\t\t\t\t\t\tconst successDealGuide = this.#createHintToSuccessDocument(documentLinkNode, {\n\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'successDealGuideIsOver', true);\n\t\t\t\t\t\t\t\tunsubscribeFromHintClicks();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tconst dealContainer = this.#getContentContainer();\n\t\t\t\t\t\tconst buttonsContainer = this.#getButtonsContainer();\n\n\t\t\t\t\t\tconst unsubscribeFromHintClicks = () => {\n\t\t\t\t\t\t\tEvent.unbind(dealContainer, 'click', successDealGuide.close.bind(successDealGuide));\n\t\t\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', successDealGuide.close.bind(successDealGuide));\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\twindow.scrollTo(0, nodePos.y - 250);\n\t\t\t\t\t\tsuccessDealGuide.showNextStep();\n\n\t\t\t\t\t\tEvent.bind(buttonsContainer, 'click', successDealGuide.close.bind(successDealGuide));\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tEvent.bind(dealContainer, 'click', successDealGuide.close.bind(successDealGuide));\n\t\t\t\t\t\t}, 3000);\n\t\t\t\t\t}, 100);\n\t\t\t\t}\n\n\t\t\t\tEventEmitter.subscribe(\n\t\t\t\t\t'BX.Crm.Timeline.Items.FinalSummaryDocuments:onHistoryNodeAdded',\n\t\t\t\t\tonHistoryNodeAddedHandler\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tEventEmitter.subscribe(\n\t\t\t'Crm.EntityProgress.Saved',\n\t\t\ttimelineGuideListener\n\t\t);\n\t}\n\n\t#createHintToSuccessDocument(target: HTMLElement, guideEvents: Object = {}): Guide\n\t{\n\t\tconst guideText = {\n\t\t\ttitle: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_SUCCESS_DEAL_GUIDE_TITLE'),\n\t\t\ttext: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_SUCCESS_DEAL_GUIDE_TEXT'),\n\t\t};\n\n\t\treturn new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: target,\n\t\t\t\t\ttitle: guideText.title,\n\t\t\t\t\ttext: guideText.text,\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\tevents: guideEvents,\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true\n\t\t});\n\t}\n}","//@flow\nimport {Cache, Loc} from 'main.core';\nimport {DealOnboardingManager, OnboardingData} from \"./deal.onboarding.manager\";\n\n\ntype Params = {\n\tguid: string;\n};\n\n\n\nexport class DealManager\n{\n\t#dealGuid: string;\n\t#dealDetailManager: BX.Crm.DealDetailManager|null;\n\t#dealOnboardingManager: DealOnboardingManager|null = null;\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#dealGuid = params.guid;\n\t\tthis.#dealDetailManager = BX.Crm.EntityDetailManager.get(this.#dealGuid);\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('container', () => {\n\t\t\treturn document.getElementById(this.#dealGuid + '_container');\n\t\t});\n\t}\n\n\tgetDealDetailManager(): BX.Crm.DealDetailManager|null\n\t{\n\t\treturn this.#dealDetailManager;\n\t}\n\n\tenableOnboardingChain(onboardingData: OnboardingData, serviceUrl: string)\n\t{\n\t\tif (this.#dealOnboardingManager === null && this.getDealDetailManager() !== null)\n\t\t{\n\t\t\tthis.#dealOnboardingManager  = new DealOnboardingManager({\n\t\t\t\tonboardingData: onboardingData,\n\t\t\t\tcontentContainer: this.getContainer(),\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tdealDetailManager: this.getDealDetailManager()\n\t\t\t});\n\t\t\tthis.#dealOnboardingManager.processOnboarding();\n\t\t}\n\t}\n}"],"names":["DealOnboardingManager","params","onboardingData","contentContainer","serviceUrl","dealDetailManager","chain","step","chainStep","successDealGuideIsOver","querySelector","guideText","title","Loc","getMessage","text","isTabButtonVisible","productsTabId","target","guideEvents","Guide","steps","position","events","onEvents","productsTabButton","getTabMenuItemContainer","productsTabGuide","onClose","userOptions","save","showNextStep","tabsContainer","getTabManager","getTabMenuContainer","windowResizeHandler","close","Event","unbind","window","bind","bindOnce","moreButton","getMoreButton","spotlight","BX","SpotLight","id","targetElement","autoSave","targetVertex","zIndex","show","container","style","pointerEvents","onOpenMoreMenuHandler","event","eventMoreMenu","getMoreMenu","dealMoreMenu","getTabFromMoreMenu","moreMenuContainer","getMenuContainer","tabHintTimeout","setTimeout","moreMenuClickHandler","productsTabPopup","getPopup","EventEmitter","subscribeOnce","onPopupCloseHandler","popupContainer","getContentContainer","parentNode","showMoreMenu","outOfPopupTimeout","closeMoreMenu","clearTimeout","unsubscribe","subscribe","buttonsContainer","productListTabListener","data","productListEditor","buttonsPanelListener","activeHint","getActiveHint","productList","products","rowId","Array","firstProductRow","find","row","getModel","isService","getId","showFieldTourHint","ajax","post","ACTION","documentsListTourListener","sumControlContainer","document","addDocumentButton","settingsButton","dragButton","addDocumentGuide","userCloseHintHandler","closeIcon","timelineGuideListener","currentStepId","currentSemantics","onHistoryNodeAddedHandler","onCustomEvent","timelineDocsNode","previousNodePos","x","y","documentLinkNodeWatcherId","setInterval","documentLinkNode","nodePos","Dom","getPosition","clearInterval","successDealGuide","unsubscribeFromHintClicks","dealContainer","scrollTo","DealManager","_classPrivateFieldInitSpec","Cache","MemoryCache","guid","Crm","EntityDetailManager","get","remember","getElementById","getDealDetailManager","getContainer","processOnboarding"],"mappings":"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"}