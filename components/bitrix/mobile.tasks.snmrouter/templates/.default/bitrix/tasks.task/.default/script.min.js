(function(){var t=window.BX;if(t&&t.Mobile&&t.Mobile.Tasks&&t.Mobile.Tasks.edit){return}t.namespace("BX.Mobile.Tasks.edit");var e=0,i=function(){return"TaskEdit"+ ++e+t.util.getRandomString()},s=function(){var e=function(e,i){this.canAdd=false;this.counter=0;this.sort=0;this.clickAdd=t.delegate(this.clickAdd,this);this.clickSeparator=t.delegate(this.clickSeparator,this);this.clickMenu=t.delegate(this.clickMenu,this);this.callback=t.delegate(this.callback,this);var s;this.taskId=e;this.ids={};i=i||[];for(s=0;s<i.length;s++){this.ids[i[s]]=i[s];this.bindItem(i[s])}this.container=t("checkList"+e+"Container");if(this.container&&t("checkList"+e+"Add")){this.canAdd=true;t.bind(t("checkList"+e+"Add"),"click",this.clickAdd);if(t("checkList"+e+"Separator")){t.bind(t("checkList"+e+"Separator"),"click",this.clickSeparator)}}};e.prototype={bindItem:function(e){if(t("checkListItem"+e+"Menu"))t.bind(t("checkListItem"+e+"Menu"),"click",t.proxy((function(t){this.clickMenu(t,e)}),this));var i=t("checkListItem"+e),s=t("checkListItem"+e+"Label");if(t.hasClass(s,"task-view-checklist-toggle")){s.setAttribute("bx-toggle","Y");i.setAttribute("bx-toggle","Y")}if(t.hasClass(s,"task-view-checklist-modify")){s.setAttribute("bx-modify","Y");i.setAttribute("bx-modify","Y")}if(t.hasClass(s,"task-view-checklist-remove")){s.setAttribute("bx-remove","Y");i.setAttribute("bx-remove","Y")}if(t.findParent(i,{tagName:"span",className:"mobile-grid-field-divider"},s)){s.setAttribute("bx-separator","Y");i.setAttribute("bx-separator","Y")}if(s.hasAttribute("bx-toggle"))t.bind(i,"click",t.proxy((function(){this.fireEvent(e,"toggle",{})}),this));else t.bind(i,"click",t.proxy((function(e){return t.eventCancelBubble(e)}),this));this.sort=i.form.elements["data[SE_CHECKLIST]["+e+"][SORT_INDEX]"].value},clickMenu:function(e,i){var s=t("checkListItem"+i),a=t("checkListItem"+i+"Label"),n=[];if(!a.hasAttribute("bx-separator")){if(a.hasAttribute("bx-toggle"))n.push({title:s.checked?t.message("MB_TASKS_TASK_UNCHECK"):t.message("MB_TASKS_TASK_CHECK"),callback:t.delegate((function(){s.checked=!s.checked;this.fireEvent(i,"toggle",{})}),this)});if(a.hasAttribute("bx-modify"))n.push({title:t.message("MB_TASKS_TASK_EDIT"),callback:t.delegate((function(){var e=t.findChild(a,{tagName:"INPUT",attribute:{type:"hidden",name:"data[SE_CHECKLIST]["+i+"][TITLE]"}},true);if(e)this.show(e.value,i)}),this)})}if(a.hasAttribute("bx-remove"))n.push({title:t.message("MB_TASKS_TASK_DELETE"),callback:t.delegate((function(){this.fireEvent(i,"remove",{});t.remove(a)}),this)});if(n.length>0)new window.BXMobileApp.UI.ActionSheet({buttons:n},"textPanelSheet").show();return t.PreventDefault(e)},clickSeparator:function(e){if(this.canAdd)this.callback({text:"===",extraData:{id:"n"+this.counter++}},{separator:true});return e?t.PreventDefault(e):false},clickAdd:function(e){if(this.canAdd)this.showAdd("n"+this.counter++);return e?t.PreventDefault(e):false},showAdd:function(e){var i=t.create("LABEL",{attrs:{id:"checkListItem"+e+"Label",className:"edit"},html:['<span class="mobile-grid-field-tasks-checklist-item">','<span class="mobile-grid-field-tasks-checklist-item-text">&nbsp;</span>','<input type="text" id="checkListItem',e,'Text" value="" placeholder="',t.message("MB_TASKS_TASK_CHECKLIST_PLACEHOLDER"),'"/>',"</span>"].join("")});this.container.appendChild(i);var s=0,a=t.proxy((function(e){if(s>100)return;s++;if(t("checkListItem"+e+"Text")){t.bind(t("checkListItem"+e+"Text"),"blur",t.proxy((function(){if(t("checkListItem"+e+"Text")){var i=t("checkListItem"+e+"Text").value,s=t("checkListItem"+e+"Label");if(t.type.isNotEmptyString(i.trim()))this.callback({text:i,extraData:{id:e}},{replaceNode:t("checkListItem"+e+"Label")});else if(s&&s.parentNode)s.parentNode.removeChild(s)}}),this));t.bind(t("checkListItem"+e+"Text"),"keyup",t.proxy((function(i){if(i.keyCode==13){var s=t("checkListItem"+e+"Text").value,a=t("checkListItem"+e+"Label");if(t.type.isNotEmptyString(s))setTimeout(t.proxy(this.clickAdd,this),100);else if(a&&a.parentNode)a.parentNode.removeChild(a)}}),this));setTimeout((function(){t.focus(t("checkListItem"+e+"Text"))}),100)}else{setTimeout((function(){a(e)}),100)}}),this);a(e)},show:function(e,i){window.app.exec("showPostForm",{attachButton:null,attachedFiles:null,extraData:{id:i},mentionButton:null,smileButton:null,message:{text:t.util.htmlspecialcharsback(e)},okButton:{callback:this.callback,name:t.message("interface_form_save")},cancelButton:{callback:function(){},name:t.message("interface_form_cancel")}})},callback:function(e,i){e.text=t.util.htmlspecialchars(e.text)||"";i=i||{};var s=e.extraData.id,a,n=false,r=i.replaceNode,o=i.separator;if(t("checkListItem"+s)){a=t("checkListItem"+s+"Label");t.removeClass(a,"edit");n=t("checkListItem"+s).checked}else{a=t.create("LABEL",{attrs:{for:"checkListItem"+s,id:"checkListItem"+s+"Label",className:"task-view-checklist task-view-checklist-toggle task-view-checklist-modify task-view-checklist-remove"}});if(t(r)){r.parentNode.replaceChild(a,r)}else{this.container.appendChild(a)}}a.innerHTML=['<span class="',o?"mobile-grid-field-divider":"mobile-grid-field-tasks-checklist-item",'">','<input type="hidden" name="data[SE_CHECKLIST][',s,'][ID]" value="',s,'" />','<input type="checkbox" name="data[SE_CHECKLIST][',s,'][IS_COMPLETE]" id="checkListItem',s,'"',n?" checked ":"",' value="Y" />',o?"":'<span class="mobile-grid-field-tasks-checklist-item-text">'+e.text+"</span>",'<i class="mobile-grid-menu" id="checkListItem',s,'Menu"></i>','<input type="hidden" name="data[SE_CHECKLIST][',s,'][TITLE]" value="',e.text,'" />','<input type="hidden" name="data[SE_CHECKLIST][',s,'][SORT_INDEX]" value="',e.sort||++this.sort,'" />',"</span>"].join("");var c=0,h=t.proxy((function(e){if(c>100)return;c++;if(t("checkListItem"+e+"Menu")){this.bindItem(e);this.fireEvent(e,"modify",i)}else{setTimeout((function(){h(e)}),100)}}),this);h(s)},fireEvent:function(e,i,s){t.onCustomEvent(this,"onChange",[this,t("checkListItem"+e),i,s])},getId:function(t){return this.ids[t]||t}};return e}(),a=function(){var e=function(e){this.click=t.delegate(this.click,this);this.callback=t.delegate(this.callback,this);this.node=t("title"+e);this.container=t("title"+e+"Container");if(this.node&&this.container){t.bind(this.container.parentNode,"click",this.click)}};e.prototype={multiple:false,select:null,eventNode:null,container:null,showDrop:true,showMenu:false,click:function(e){this.show();return t.PreventDefault(e)},show:function(){window.app.exec("showPostForm",{attachButton:null,attachedFiles:null,extraData:{},mentionButton:null,smileButton:null,message:{text:t.util.htmlspecialcharsback(this.node.value)},okButton:{callback:this.callback,name:t.message("interface_form_save")},cancelButton:{callback:function(){},name:t.message("interface_form_cancel")}})},callback:function(e){e.text=e.text||"";if(e.text.length>0){this.container.innerHTML=t.util.htmlspecialchars(e.text);this.node.value=e.text}t.onCustomEvent(this,"onChange",[this,this.node])}};return e}(),n=function(){var e=function(e){this.click=t.delegate(this.click,this);this.callback=t.delegate(this.callback,this);this.drop=t.delegate(this.drop,this);this.id=e;this.node=t("parentId"+e);this.container=t("parentId"+e+"Container");if(this.node&&this.container){t.bind(t("parentId"+e+"Select"),"click",this.click);var i=t.findChild(this.container.parentNode,{tagName:"DEL"},true);if(i)t.bind(i,"click",this.drop)}};e.prototype={multiple:false,select:null,eventNode:null,container:null,showDrop:true,showMenu:false,click:function(e){this.show();return t.PreventDefault(e)},show:function(){BXMobileApp.addCustomEvent(window,"onTaskWasChosenInTasksSelector",this.callback);window.BXMobileApp.PageManager.loadPageModal({url:t.message("TASK_PATH_TO_SELECTOR")+"&multiple=false&id="+this.id,bx24ModernStyle:true})},drop:function(){this.node.value=0;t.onCustomEvent(this,"onChange",[this,this.node])},callback:function(e,i){if(!i&&t.type.isArray(e)){i=e[1];e=e[0]}if(e==this.id&&i){t.removeCustomEvent(window,"onTaskWasChosenInTasksSelector",this.callback);BXMobileApp.Events.unsubscribe("onTaskWasChosenInTasksSelector");this.node.value=i["ID"];this.container.innerHTML=t.util.htmlspecialchars(i["TITLE"]);t.onCustomEvent(this,"onChange",[this,this.node])}window.app.closeModalDialog({})}};return e}(),r=function(){var e=function(e){this.click=t.delegate(this.click,this);this.callback=t.delegate(this.callback,this);this.durationType=t("durationType"+e);this.durationTypeLabel=t("durationType"+e+"Label");t.bind(this.durationTypeLabel,"click",this.click)};e.prototype={click:function(e){this.show();return t.PreventDefault(e)},show:function(){BXMobileApp.UI.SelectPicker.show({callback:this.callback,values:[t.message("MB_TASKS_TASK_SETTINGS_DURATION_PLAN_HOURS"),t.message("MB_TASKS_TASK_SETTINGS_DURATION_PLAN_DAYS")],multiselect:false,default_value:this.durationType.value=="hours"?t.message("MB_TASKS_TASK_SETTINGS_DURATION_PLAN_HOURS"):t.message("MB_TASKS_TASK_SETTINGS_DURATION_PLAN_DAYS")})},callback:function(e){if(e&&e.values&&e.values.length>0){var i=e.values.pop();if(i==t.message("MB_TASKS_TASK_SETTINGS_DURATION_PLAN_DAYS")){this.durationType.value="days";this.durationTypeLabel.innerHTML=t.message("MB_TASKS_TASK_SETTINGS_DURATION_PLAN_DAYS")}else{this.durationType.value="hours";this.durationTypeLabel.innerHTML=t.message("MB_TASKS_TASK_SETTINGS_DURATION_PLAN_HOURS")}}}};return e}(),o=function(){var e=function(e,i){this.objectId=t.util.getRandomString();this.id=e;this.data=i;this.node=t("bx-task-timetracking-"+e);this.tasks={};this.timer=null;this.check=t.delegate(this.check,this);this.click=t.delegate(this.click,this);this.time={trueTime:i&&i["TIME_ELAPSED"]?parseInt(i["TIME_ELAPSED"]):0,currentTime:0};if(this.node){if(this.node.checked)this.start();t.bind(this.node,"click",this.click);if(this.time.trueTime<=0)this.time.trueTime=parseInt(this.node.value);BXMobileApp.addCustomEvent("onTaskWasPerformed",t.proxy((function(t,e,i){if(!i){i=t[2];e=t[1];t=t[0]}if(this.id==t&&this.objectId!=e){if(i["OPERATION"]=="task.dayplan.timer.start"){this.start()}else if(i["OPERATION"]=="task.dayplan.timer.stop"||i["OPERATION"]=="task.defer"){this.stop()}else if(i["OPERATION"]=="task.complete"){this.stop();this.node.disabled=true}else if(i["OPERATION"]=="task.renew"||i["OPERATION"]=="task.start"){this.node.disabled=false}}}),this))}};e.prototype={click:function(e){t.eventCancelBubble(e);if(this.node.checked)this.startTimer();else this.stopTimer();return t.PreventDefault(e)},startTimer:function(e,i){if(i){window.app.BasicAuth({success:t.proxy((function(){t.ajax.runComponentAction("bitrix:tasks.task","startTimer",{mode:"class",data:{taskId:this.id,stopPrevious:e||false}}).then(function(t){window.app.hidePopupLoader();this.start();window.BXMobileApp.onCustomEvent("onTaskWasPerformed",[this.id,this.objectId],true,true)}.bind(this),function(e){window.app.hidePopupLoader();window.app.alert({text:t.message("MB_TASKS_TASK_ERROR3"),title:t.message("MB_TASKS_TASK_ERROR_TITLE")})}.bind(this))}),this),failure:function(){window.app.alert({text:t.message("MB_TASKS_TASK_ERROR3"),title:t.message("MB_TASKS_TASK_ERROR_TITLE")})}});return}t.ajax.runComponentAction("bitrix:tasks.task","startTimer",{mode:"class",data:{taskId:this.id,stopPrevious:e||false},onrequeststart:function(t){this.xhr=t}.bind(this)}).then(function(t){window.app.hidePopupLoader();this.start();window.BXMobileApp.onCustomEvent("onTaskWasPerformed",[this.id,this.objectId],true,true)}.bind(this),function(i){window.app.hidePopupLoader();if(this.xhr&&this.xhr.status&&this.xhr.status===401){this.startTimer(e,true)}else if(i.errors&&i.errors.length){var s=i.errors.getByCode("OTHER_TASK_ON_TIMER");if(s){var a=s.data();window.app.confirm({title:t.message("TASKS_TT_ERROR1_TITLE"),text:t.message("TASKS_TT_ERROR1_DESC").replace("#TITLE#",a["TASK"]["TITLE"]),callback:t.proxy((function(e){return t.proxy((function(t){if(t<=1)this.startTimer(e)}),this)}),this)(a["TASK"]["ID"]),buttons:[t.message("TASKS_TT_CONTINUE"),t.message("TASKS_TT_CANCEL")]})}}else{}}.bind(this))},stopTimer:function(e){if(e){window.app.BasicAuth({success:t.proxy((function(){t.ajax.runComponentAction("bitrix:tasks.task","stopTimer",{mode:"class",data:{taskId:this.id}}).then(function(t){window.app.hidePopupLoader();this.stop();window.BXMobileApp.onCustomEvent("onTaskWasPerformed",[this.id,this.objectId],true,true)}.bind(this),function(t){window.app.hidePopupLoader()}.bind(this))}),this),failure:function(){}});return}t.ajax.runComponentAction("bitrix:tasks.task","stopTimer",{mode:"class",data:{taskId:this.id},onrequeststart:function(t){this.xhr=t}.bind(this)}).then(function(t){window.app.hidePopupLoader();this.stop();window.BXMobileApp.onCustomEvent("onTaskWasPerformed",[this.id,this.objectId],true,true)}.bind(this),function(e){window.app.hidePopupLoader();if(this.xhr&&this.xhr.status&&this.xhr.status===401){this.stopTimer(true)}else if(e.errors&&e.errors.length){for(var i=0;i<e.errors.length;i++)e.errors[i]=e.errors[i]["message"];window.app.alert({text:e.errors.join(". "),title:t.message("MB_TASKS_TASK_ERROR_TITLE")})}else{}}.bind(this))},start:function(){this.node.checked=true;if(this.timer===null)this.timer=setInterval(this.check,1e3)},stop:function(){this.node.checked=false;this.node.value=this.time.trueTime+this.time.currentTime;clearInterval(this.timer);this.timer=null},check:function(){this.refresh(++this.time.currentTime+this.time.trueTime)},refresh:function(e){var i=t("bx-task-timetracking-"+this.id+"-value"),s=[Math.floor(e/3600),Math.floor(e/60)%60,e%60],a;for(a=0;a<s.length;a++){s[a]+="";s[a]="00".substring(0,2-s[a].length)+s[a]}i.innerHTML=s.join(":")}};return e}(),c=function(){var e=function(e){this.start=t.delegate(this.start,this);this.end=t.delegate(this.end,this);this.keypress=t.delegate(this.keypress,this);this.timer=null;this.node=t("timeEstimate"+e+"Seconds");this.minsNode=t("timeEstimate"+e+"Minutes");this.hoursNode=t("timeEstimate"+e+"Hours");if(this.node&&this.minsNode&&this.hoursNode)this.init();t.bind(this.hoursNode,"focus",this.start);t.bind(this.hoursNode,"blur",this.end);t.bind(this.minsNode,"focus",this.start);t.bind(this.minsNode,"blur",this.end);t.bind(this.hoursNode,"keypress",this.keypress);t.bind(this.minsNode,"keypress",this.keypress)};e.prototype={init:function(){var t=parseInt(this.node.value);t=t>0?t:0;this.hoursNode.value=Math.floor(t/3600);this.hoursNode.className="time-estimate-length-"+this.hoursNode.value.length;this.minsNode.value=Math.floor(t/60)%60;this.minsNode.className="time-estimate-length-"+this.minsNode.value.length},start:function(e){if(this.timer!==null)clearInterval(this.timer);this.timer=setInterval(t.proxy((function(){this.onchange(e.target)}),this),500)},end:function(){clearInterval(this.timer);this.timer=null},onchange:function(e){e.value=(e.value+"").replace(/\D+/gi,"");if(t(e)){e.className="time-estimate-length-"+e.value.length}var i=parseInt(this.hoursNode.value),s=parseInt(this.minsNode.value);this.node.value=(i>0?i*3600:0)+(s>0?s*60:0)},keypress:function(e){var i=false;if(!e){}else if(e.key){i=/\d/.test(e.key)}else{var s=e.keyCode||e.keyIdentifier||e.which;i=47<s&&s<58}if(i)return true;return t.PreventDefault(e)}};return e}();t.Mobile.Tasks.edit=function(e,s){this.parentConstruct(t.Mobile.Tasks.edit,e);this.guid=e.guid;t.merge(this,{sys:{classCode:"edit"},vars:{id:i()},task:e.taskData});t.merge(e,{usePull:false,setTitle:true,setPullDown:false});this.handleInitStack(s,t.Mobile.Tasks.edit,e)};t.extend(t.Mobile.Tasks.edit,t.Mobile.Tasks.page);t.merge(t.Mobile.Tasks.edit.prototype,{init:function(){var e=t.delegate((function(t,e,i){if(t==this.option("formId")&&i){if(i["restrictedMode"]===true||i["restrictedMode"]=="Y"){this.initRestricted(i)}else{this.initFull(i)}this.bindEvents(i)}}),this);this.formInterface=t.Mobile.Grid.Form.getByFormId(this.option("formId"));t.addCustomEvent("onInitialized",e);e(this.option("formId"),"doesNotMatter",this.formInterface)},initRestricted:function(e){this.restricted=true;new o(this.task["ID"],this.task);var i=e.elements.length;e.elements.push(new a(this.task["ID"]));e.elements.push(new r(this.task["ID"]));var s=function(){e.apply.apply(arguments)};for(var n=i;n<e.elements.length;n++){t.addCustomEvent(e.elements[n],"onChange",s)}},initFull:function(t){t.elements.push(new s(this.task["ID"],this.task["CHECKLIST"]));t.elements.push(new n(this.task["ID"]));t.elements.push(new r(this.task["ID"]));t.elements.push(new c(this.task["ID"]))},bindEvents:function(e){t.addCustomEvent(e,"onChange",t.proxy(this.onChange,this));t.addCustomEvent(e,"onCancel",(function(){window.app.closeModalDialog({})}));BXMobileApp.addCustomEvent(e,"onSubmitForm",t.proxy(this.onSubmitForm,this));BXMobileApp.addCustomEvent("tasks.view.native::onItemAction",t.delegate((function(t){if(Number(t.taskId)!==Number(this.task["ID"])||t.taskGuid!==this.guid){return}var e={};switch(t.name){default:break;case"auditor":case"accomplice":e=t.values.user;e={ID:e.id,NAME:e.name||e.title,IMAGE:e.icon||e.imageUrl||false};this.getFormElement(t.name).callback({a_users:[e]});break}}),this))},onChange:function(e,i){if(i.name){if(!this.changes){this.changes={}}var s=/^data\[([a-z|_]*)\]/i;var a=i.name;var n=s.exec(a);if(n&&n.length==2){this.changes[n[1]]=true}else{var s=/.*\[\]/i;var n=s.exec(i.name);if(n&&n.length==1){this.changes[i.value]=true}}}var r=t(this.option("formId")),o=r.elements["data[MARK]"];if(t(i)&&i==o){var c=t.findParent(i,{className:"bx-tasks-task-mark"},r);if(i.value=="P"){t.removeClass(c,"bx-tasks-task-mark-N");if(!t.hasClass(c,"bx-tasks-task-mark-P"))t.addClass(c,"bx-tasks-task-mark-P")}else if(i.value=="N"){t.removeClass(c,"bx-tasks-task-mark-P");if(!t.hasClass(c,"bx-tasks-task-mark-N"))t.addClass(c,"bx-tasks-task-mark-N")}else{t.removeClass(c,"bx-tasks-task-mark-P");t.removeClass(c,"bx-tasks-task-mark-N")}}if(i.name=="data[PRIORITY]"){var h=this.task["ID"];var l=i.checked?"2":"0";i.nextSibling.innerHTML=t.message("TASKS_PRIORITY_"+l);if(h>0){this.savePriority(h,l)}}else if(i.name=="data[ADD_TO_FAVORITE]"){i.nextSibling.innerHTML=i.checked?t.message("TASKS_FAVORITES_1"):t.message("TASKS_FAVORITES_0")}},onSubmitForm:function(e,i,s,a){a.submit=false;if(!this.restricted){BXMobileApp.UI.Page.LoadingScreen.show()}if(t.Mobile.Tasks.CheckListInstance){t.Mobile.Tasks.CheckListInstance.getTreeStructure().appendRequestLayout()}var n=t.ajax.prepareForm(i).data;var r=this.prepareFromData(i,n.data);var o=this.task["ID"];var c=o>0?"legacyUpdate":"legacyAdd";this.sendQuery(c,r)},sendQuery:function(e,i,s){if(s){window.app.BasicAuth({success:t.proxy((function(){t.ajax.runComponentAction("bitrix:tasks.task",e,{mode:"class",data:{taskId:this.task["ID"],data:i,parameters:{RETURN_ENTITY:true,PLATFORM:"mobile"}}}).then(function(t){this.actExecute(t)}.bind(this),function(e){window.app.alert({text:t.message("MB_TASKS_TASK_ERROR3"),title:t.message("MB_TASKS_TASK_ERROR_TITLE")})}.bind(this))}),this),failure:function(){window.app.alert({text:t.message("MB_TASKS_TASK_ERROR3"),title:t.message("MB_TASKS_TASK_ERROR_TITLE")})}});return}t.ajax.runComponentAction("bitrix:tasks.task",e,{mode:"class",data:{taskId:this.task["ID"],data:i,parameters:{RETURN_ENTITY:true,PLATFORM:"mobile"}},onrequeststart:function(t){this.xhr=t}.bind(this)}).then(function(t){try{var e=this.option("formId");if(this.task["ID"]=="0"){e="MOBILE_TASK_CREATE"}fabric.Answers.sendCustomEvent("TASK/"+e,{});if(this.changes){Object.keys(this.changes).forEach(function(t){fabric.Answers.sendCustomEvent("TASK/"+this.option("formId")+"/"+t,{})}.bind(this))}}catch(t){}setTimeout(function(){this.actExecute(t)}.bind(this),500)}.bind(this),function(s){if(this.xhr&&this.xhr.status&&this.xhr.status===401){this.sendQuery(e,i,true)}else if(s.errors&&s.errors.length){if(s.errors[0].message){window.app.alert({text:s.errors[0].message,title:t.message("MB_TASKS_TASK_ERROR_TITLE")})}}else{}}.bind(this))},prepareFromData:function(t,e){var i=e;var s={MARK:"NULL",DEADLINE:"0"};Object.keys(s).forEach((function(t){if(i[t]===s[t]){i[t]=""}}));["SE_AUDITOR","SE_ACCOMPLICE"].forEach((function(t){if(i[t]){var e;var s=[];while((e=i[t].pop())&&e){s.push({ID:e})}i[t]=s}}));if(t.elements["ADDITIONAL[]"]){for(var a=0;a<t.elements["ADDITIONAL[]"].length;a++){var n=t.elements["ADDITIONAL[]"][a];i[n.value]=n.checked?"Y":"N"}}if(this.restricted){delete i["SE_CHECKLIST"]}return i},getFormElement:function(t){switch(t){default:break;case"auditor":case"accomplice":var e={auditor:"data[SE_AUDITOR][]",accomplice:"data[SE_ACCOMPLICE][]"};for(var i=0;i<this.formInterface.elements.length;i++){if(this.formInterface.elements[i].select&&this.formInterface.elements[i].select.name===e[t]){return this.formInterface.elements[i]}}break}return null},savePriority:function(e,i){t.ajax.runAction("tasks.task.update",{data:{taskId:e,fields:{PRIORITY:i}}}).then((function(t){}),(function(t){}))},actExecute:function(e){BXMobileApp.UI.Page.LoadingScreen.hide();if(e.errors&&e.errors.length){for(var i=0;i<e.errors.length;i++){errors.push(e.errors[i]["message"])}window.app.alert({text:errors.join(". "),title:t.message("MB_TASKS_TASK_ERROR_TITLE")})}else if(e.data){window.BXMobileApp.onCustomEvent(this.task["ID"]>0?"onTaskWasUpdated":"onTaskWasCreated",[this.task["ID"],this.variable("id"),e.data.DATA,e.data,this.restricted],true,true);if(!this.restricted){window.app.closeModalDialog({})}}},elements:[],getMenu:function(){return[]}})})();
//# sourceMappingURL=script.map.js