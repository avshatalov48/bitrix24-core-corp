{"version":3,"file":"script.js","sources":["src/step.js","src/steptelephony.js","src/stepcrmform.js","src/stepimconnector.js","src/stepmessageservice.js","src/steppaysystem.js","src/iterator.js"],"sourcesContent":["import { Tag, Type } from \"main.core\";\nimport { EventEmitter } from 'main.core.events';\n\nexport default class Step {\n\n\tid: string;\n\n\tactual : boolean|null = null; // does not use yet\n\tcorrect : boolean|null = null;\n\tstarted : boolean = false;\n\tfinished : boolean = false;\n\n\tstatusAttributeName : String = \"data-bx-status\";\n\turl : String = \"\";\n\n\terrors : Map = new Map();\n\tnotes : Map = new Map();\n\n\tconstructor (options, iterator)\n\t{\n\t\tthis.id = String(options[\"ID\"]);\n\n\t\tthis.iterator = iterator;\n\t\tthis.nodeMain = document.querySelector(\"#\" + options[\"NODE_ID\"]);\n\t\tthis.node = this.nodeMain.querySelector(\"[data-bx-block=\\\"info-block\\\"]\");\n\n\t\tthis.actual = options[\"IS_ACTUAL\"];\n\t\tthis.correct = options[\"IS_CORRECT\"];\n\t\tthis.started = options[\"IS_STARTED\"];\n\t\tthis.finished = options[\"IS_FINISHED\"];\n\n\t\tEventEmitter.subscribe(this.iterator, \"Iterator:reset\", this.reset.bind(this));\n\t\tEventEmitter.subscribe(this.iterator, \"Iterator:response\", this.checkResponse.bind(this));\n\t\tEventEmitter.subscribe(this.iterator, \"Iterator:error\", this.setError.bind(this));\n\n\t\tthis.adjustNode();\n\t\tthis.adjustInfoBlock(options[\"ERRORS\"], options[\"NOTES\"]);\n\n\t\tconst button = this.nodeMain.querySelector(\"[data-bx-url]\");\n\t\tif (button)\n\t\t{\n\t\t\tthis.url = button.getAttribute(\"data-bx-url\");\n\t\t\tbutton.addEventListener(\"click\", this.onClickUrl.bind(this))\n\t\t}\n\t}\n\treset()\n\t{\n\t\tthis.started = true;\n\t\tthis.finished = false;\n\t\tthis.actual = null;\n\t\tthis.correct = null;\n\t\tthis.adjustNode();\n\t}\n\tcheckResponse({data:steps})\n\t{\n\t\tfor (const stepId in steps)\n\t\t{\n\t\t\tif (steps.hasOwnProperty(stepId) && this.id === stepId)\n\t\t\t{\n\t\t\t\tthis.actual = steps[stepId].actual;\n\t\t\t\tthis.correct = steps[stepId].correct;\n\t\t\t\tthis.started = steps[stepId].started;\n\t\t\t\tthis.finished = steps[stepId].finished;\n\t\t\t\tthis.adjustNode();\n\t\t\t\tthis.adjustInfoBlock(steps[stepId][\"errors\"], steps[stepId][\"notes\"]);\n\t\t\t}\n\t\t}\n\t}\n\tadjustNode()\n\t{\n\t\tlet status = \"ok\";\n\t\tif (!this.started)\n\t\t{\n\t\t\tstatus = \"not-checked\";\n\t\t}\n\t\telse if (!this.finished)\n\t\t{\n\t\t\tstatus = \"in-progress\";\n\t\t}\n\t\telse if (!this.actual)\n\t\t{\n\t\t\tstatus = \"not-actual\";\n\t\t}\n\t\telse if (!this.correct)\n\t\t{\n\t\t\tstatus = \"not-correct\";\n\t\t}\n\t\tthis.nodeMain.setAttribute(this.statusAttributeName, status);\n\t}\n\tsetError()\n\t{\n\t\tthis.node.innerHTML = \"Some error was occurred.\";\n\t}\n\tadjustInfoBlock(errors:Object, notes:Object)\n\t{\n\t\tlet child = this.node.lastChild;\n\t\twhile (child)\n\t\t{\n\t\t\tthis.node.removeChild(child);\n\t\t\tchild = this.node.lastChild;\n\t\t}\n\n\t\tthis.parseErrors(errors, notes);\n\n\t\tif (this.node.hasChildNodes())\n\t\t{\n\t\t\tTag.style(this.node.parentNode)`\n\t\t\t\theight: ${this.node.offsetHeight}px;\n\t\t\t\topacity: 1;\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tTag.style(this.node.parentNode)`\n\t\t\t\theight: 0;\n\t\t\t\topacity: 0;\n\t\t\t`;\n\t\t}\n\t}\n\n\tonClickUrl()\n\t{\n\t\tif (Type.isStringFilled(this.url))\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(this.url);\n\t\t}\n\t}\n\n\tparseErrors(errors:Object, notes:Object)\n\t{\n\t}\n}","import Step from './step';\nimport {Tag} from \"main.core\";\n\nexport default class StepTelephony extends Step {\n\n\tconstructor(options, iterator)\n\t{\n\t\tsuper(options, iterator);\n\t}\n\n\tparseErrors(errors:Object, notes:Object)\n\t{\n\t\tfor (let [key, error] of Object.entries(errors))\n\t\t{\n\t\t\tif (key !== \"VOXIMPLANT_IS_NOT_CONFIGURED\")\n\t\t\t{\n\t\t\t\tthis.node.append(\n\t\t\t\t\tTag.render`<span class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${error[\"message\"]}</span>`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}","import Step from './step';\nimport {Dom, Loc, Tag, Type} from \"main.core\";\nimport {EventEmitter} from \"main.core.events\";\n\nexport default class StepCrmForm extends Step {\n\n\tconstructor(options, iterator)\n\t{\n\t\tsuper(options, iterator);\n\t}\n\n\tonChange({target})\n\t{\n\t\tconst select = this.node.querySelector(\"#crm_numbers\");\n\t\tif (select.value !== null)\n\t\t{\n\t\t\tEventEmitter.emit(this, \"Step:action\", {action: \"setNumber\", data : {numberId : select.value}});\n\t\t}\n\t\tconst butt = this.node.querySelector(\"#crm_button\");\n\t\tif (butt)\n\t\t{\n\t\t\tDom.addClass(butt, \"ui-btn-wait\");\n\t\t\tsetTimeout(() => { Dom.removeClass(butt, \"ui-btn-wait\"); }, 2000);\n\t\t}\n\t}\n\n\tparseErrors(errors, notes)\n\t{\n\t\tfor (let [key, error] of Object.entries(errors))\n\t\t{\n\t\t\tthis.node.append(\n\t\t\t\tTag.render`<span class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${error[\"message\"]}</span>`\n\t\t\t);\n\t\t}\n\t\tif (notes && Type.isArray(notes[\"items\"]))\n\t\t{\n\t\t\tlet numberIsInUse = [];\n\t\t\tnotes[\"items\"].forEach((number) => {\n\t\t\t\tif (number['IS_IN_USE'] === true)\n\t\t\t\t{\n\t\t\t\t\tnumberIsInUse.push(number['LINE_NUMBER']);\n\t\t\t\t}\n\t\t\t});\n\t\t\tlet numbers = '';\n\t\t\tif (numberIsInUse.length > 1)\n\t\t\t{\n\t\t\t\tnumbers = `<option value=\"null\" selected>${Loc.getMessage(\"CRM_SEVERAL_NUMBERS_IS_IN_USE\")}</option>`\n\t\t\t}\n\t\t\telse if (numberIsInUse.length <= 0)\n\t\t\t{\n\t\t\t\tnumbers = `<option value=\"null\" selected>${Loc.getMessage(\"CRM_PICK_UP_THE_NUMBER_FOR_CRMFORM\")}</option>`;\n\t\t\t}\n\n\t\t\tnotes[\"items\"].forEach((number) => {\n\t\t\t\tnumbers += `\n\t\t\t\t\t<option value=\"${number['LINE_NUMBER']}\" ${numberIsInUse.length === 1 && number['IS_IN_USE'] ? \"selected\" : \"\"}>\n\t\t\t\t\t\t[${number['LINE_NUMBER']}] ${number['SHORT_NAME']}\n\t\t\t\t\t</option>\n\t\t\t`});\n\t\t\tDom.append(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"crm-wizard-settings-block-hidden-input\">\n\t\t\t\t\t\t<div class=\"crm-wizard-settings-block-hidden-input-inner\">\n\t\t\t\t\t\t\t<div class=\"crm-wizard-settings-block-hidden-input-label\">${Loc.getMessage(\"CRM_CHANGE_CRM_FORM_NUMBER\")}</div>\n\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-after-icon ui-ctl-dropdown\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t\t<select class=\"ui-ctl-element\" id=\"crm_numbers\">\n\t\t\t\t\t\t\t\t\t${numbers}\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border\" id=\"crm_button\" onclick=\"${this.onChange.bind(this)}\">${Loc.getMessage(\"CRM_BUTTON_APPLY\")}</button>\n\t\t\t\t\t</div>\n`,\n\t\t\t\tthis.node\n\t\t\t);\n\t\t}\n\t}\n}","import Step from './step';\nimport {Tag, Type} from \"main.core\";\n\nexport default class StepImconnector extends Step {\n\n\tconstructor(options, iterator)\n\t{\n\t\tsuper(options, iterator);\n\t}\n\n\tparseErrors(errors, notes)\n\t{\n\t\tlet node = null;\n\t\tfor (let [key, error] of Object.entries(errors))\n\t\t{\n\t\t\tif (error[\"code\"] === \"IMCONNECTOR_IS_NOT_CORRECT\" && Type.isArray(error[\"customData\"]))\n\t\t\t{\n\t\t\t\tnode = Tag.render`<ul class=\"crm-wizard-settings-block-list\"></ul>`;\n\t\t\t\terror[\"customData\"].forEach((item) => {\n\t\t\t\t\tnode.append(\n\t\t\t\t\t\tTag.render`\n\t<li class=\"${item[\"icon_class\"]}\">\n\t\t<a href=\"${item[\"link\"]}\" onclick=\"BX.SidePanel.Instance.open(this.href); return false;\">${item[\"name\"]}</a>\n\t</li>\n\t\t\t\t\t\t`);\n\t\t\t\t});\n\t\t\t\tnode = Tag.render`<div class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${error[\"message\"]}${node}</div>`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnode = Tag.render`<div class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${error[\"message\"]}</div>`;\n\t\t\t}\n\t\t\tthis.node.append(\n\t\t\t\tnode\n\t\t\t);\n\t\t}\n\t}\n}","import Step from './step';\nimport {Tag, Type} from \"main.core\";\n\nexport default class StepMessageService extends Step {\n\n\tconstructor(options, iterator)\n\t{\n\t\tsuper(options, iterator);\n\t}\n\n\tonClickUrl()\n\t{\n\t\tif (Type.isStringFilled(this.url))\n\t\t{\n\t\t\twindow.open(this.url);\n\t\t}\n\t}\n\n\tparseErrors(errors)\n\t{\n\t\tlet node = null, node2 = null;\n\t\tconst errorNode = Tag.render`<div class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\"></div>`;\n\n\t\tfor (let [key, error] of Object.entries(errors))\n\t\t{\n\t\t\tif (error[\"code\"] === \"NONEXISTENT_PROVIDER\")\n\t\t\t{\n\t\t\t\tif (node2 === null)\n\t\t\t\t{\n\t\t\t\t\tnode2 = Tag.render`<ul class=\"crm-wizard-settings-block-provider-list\"></ul>`;\n\t\t\t\t\terrorNode.append(\n\t\t\t\t\t\tTag.render`<div class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${node2}</div>`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tnode2.append(Tag.render`<li>${error[\"message\"]}</li>`);\n\t\t\t}\n\t\t\telse if (error[\"code\"] === \"NONWORKING_PROVIDER\")\n\t\t\t{\n\t\t\t\tif (node === null)\n\t\t\t\t{\n\t\t\t\t\tnode = Tag.render`<ul class=\"crm-wizard-settings-block-provider-list\"></ul>`;\n\t\t\t\t\terrorNode.append(\n\t\t\t\t\t\tTag.render`<div class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${node}</div>`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tnode.append(\n\t\t\t\t\tTag.render`\n\t<li>\n\t\t${error[\"message\"]}\n\t\t<a href=\"${error[\"customData\"][\"manageUrl\"]}\" onclick=\"BX.SidePanel.Instance.open(this.href); return false;\">${error[\"customData\"][\"shortName\"]}</a>\n\t</li>\n\t\t\t\t\t\t`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\terrorNode.append(\n\t\t\t\t\tTag.render`<div>${error[\"message\"]}</div>`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tif (errorNode.hasChildNodes())\n\t\t{\n\t\t\tthis.node.append(\n\t\t\t\terrorNode\n\t\t\t);\n\t\t}\n\t}\n}","import Step from './step';\nimport {Tag, Type} from \"main.core\";\n\nexport default class StepPaySystem extends Step {\n\n\tconstructor(options, iterator)\n\t{\n\t\tsuper(options, iterator);\n\t}\n\n\tonClickUrl()\n\t{\n\t\tif (Type.isStringFilled(this.url))\n\t\t{\n\t\t\twindow.open(this.url);\n\t\t}\n\t}\n\n\tparseErrors(errors:Object, notes:Object)\n\t{\n\t\tfor (let [key, error] of Object.entries(errors))\n\t\t{\n\t\t\tif (key !== \"PAY_SYSTEM_IS_NOT_CONFIGURED\")\n\t\t\t{\n\t\t\t\tthis.node.append(\n\t\t\t\t\tTag.render`<span class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${error[\"message\"]}</span>`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}","import {Event, Type, ajax} from 'main.core';\nimport {ButtonManager, Button} from 'ui.buttons';\nimport Step from './step';\nimport StepTelephony from './steptelephony';\nimport StepCrmForm from './stepcrmform';\nimport StepImconnector from './stepimconnector';\nimport StepMessageService from './stepmessageservice';\nimport StepPaySystem from './steppaysystem';\nimport {EventEmitter} from 'main.core.events';\n\nconst stepMappings = {\n\t'Step' : Step,\n\t'StepTelephony' : StepTelephony,\n\t'StepCrmForm' : StepCrmForm,\n\t'StepImconnector' : StepImconnector,\n\t'StepMessageService' : StepMessageService,\n\t'StepPaySystem' : StepPaySystem\n};\n\nexport default class Iterator {\n\tid: string;\n\n\tstarted: boolean = false;\n\tfinished: boolean = false;\n\n\tsteps: Map = new Map();\n\n\tresetButton: ?Button = null;\n\tcloseButton: ?Button = null;\n\n\tcomponentName: string;\n\tsignedParameters: Object;\n\n\tconstructor(id, data)\n\t{\n\t\tthis.id = id;\n\n\t\tthis.started = data.started;\n\t\tthis.finished = data.finished;\n\n\t\tthis.steps = new Map();\n\n\t\tdata.steps.map((stepOption) => {\n\t\t\tthis.addStep(stepOption);\n\t\t});\n\n\t\tif (data[\"buttons\"][\"start\"])\n\t\t{\n\t\t\tthis.resetButton = ButtonManager.createFromNode(data[\"buttons\"][\"start\"]);\n\t\t\tEvent.bind(\n\t\t\t\tthis.resetButton.getContainer(),\n\t\t\t\t\"click\",\n\t\t\t\t(event) => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.start();\n\t\t\t\t}\n\t\t\t);\n\t\t\tEventEmitter.subscribe(this, \"Iterator:reset\", () => { this.resetButton.setWaiting(true); });\n\t\t\tEventEmitter.subscribe(this, \"Iterator:finish\", () => { this.resetButton.setWaiting(false); })\n\t\t\tEventEmitter.subscribe(this, \"Iterator:error\", () => { this.resetButton.setWaiting(false); });\n\t\t}\n\n\t\tthis.componentName = data[\"componentName\"];\n\t\tthis.signedParameters = data[\"signedParameters\"];\n\t}\n\taddStep(stepOption)\n\t{\n\t\tconst id = String(stepOption[\"ID\"]);\n\t\tconst stepClassName = id.substring(id.lastIndexOf(\"\\\\\") + 1);\n\t\tlet step;\n\t\tif (stepMappings[stepClassName])\n\t\t{\n\t\t\tstep = new stepMappings[stepClassName](stepOption, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstep = new Step(stepOption, this);\n\t\t}\n\t\tEventEmitter.subscribe(step, \"Step:action\", ({target, data}) => {\n\t\t\tthis.execute(target.id, data.action, data.data);\n\t\t});\n\t\tthis.steps.set(id, step);\n\t}\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\tstart()\n\t{\n\t\tEventEmitter.emit(this, \"Iterator:reset\", []);\n\t\tthis.send(\"reset\");\n\t}\n\tcontinue()\n\t{\n\t\tEventEmitter.emit(this, \"Iterator:continue\", []);\n\t\tthis.send(\"continue\");\n\t}\n\tfinish()\n\t{\n\t\tEventEmitter.emit(this, \"Iterator:finish\", []);\n\t\tthis.resetButton.setDisabled(true);\n\t}\n\terror({errors})\n\t{\n\t\tEventEmitter.emit(this, \"Iterator:error\", data);\n\t}\n\texecute(stepId, stepAction, stepData)\n\t{\n\t\tthis.send(\"executeStep\", {\n\t\t\tstepId : stepId,\n\t\t\tstepAction: stepAction,\n\t\t\tstepData : stepData\n\t\t});\n\t}\n\tsend(action, data)\n\t{\n\t\tdata = Type.isPlainObject(data) ? data : {};\n\t\tajax\n\t\t\t.runComponentAction(\n\t\t\t\tthis.componentName,\n\t\t\t\taction,\n\t\t\t\t{\n\t\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\t\tmode: \"class\",\n\t\t\t\t\tdata: data\n\t\t\t\t},\n\t\t\t)\n\t\t\t.then(this.response.bind(this), this.error.bind(this));\n\t}\n\tresponse({data})\n\t{\n\t\tthis.started = data.started;\n\t\tthis.finished = data.finished;\n\n\t\tEventEmitter.emit(this, \"Iterator:response\", data[\"stepSteps\"]);\n\n\t\tif (this.finished !== true)\n\t\t{\n\t\t\tthis.continue();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.finish();\n\t\t}\n\t}\n}"],"names":["Step","options","iterator","Map","id","String","nodeMain","document","querySelector","node","actual","correct","started","finished","EventEmitter","subscribe","reset","bind","checkResponse","setError","adjustNode","adjustInfoBlock","button","url","getAttribute","addEventListener","onClickUrl","steps","data","stepId","hasOwnProperty","status","setAttribute","statusAttributeName","innerHTML","errors","notes","child","lastChild","removeChild","parseErrors","hasChildNodes","Tag","style","parentNode","offsetHeight","Type","isStringFilled","BX","SidePanel","Instance","open","StepTelephony","Object","entries","key","error","append","render","StepCrmForm","target","select","value","emit","action","numberId","butt","Dom","addClass","setTimeout","removeClass","isArray","numberIsInUse","forEach","number","push","numbers","length","Loc","getMessage","onChange","StepImconnector","item","StepMessageService","window","node2","errorNode","StepPaySystem","stepMappings","Iterator","map","stepOption","addStep","resetButton","ButtonManager","createFromNode","Event","getContainer","event","preventDefault","start","setWaiting","componentName","signedParameters","stepClassName","substring","lastIndexOf","step","execute","set","send","setDisabled","stepAction","stepData","isPlainObject","ajax","runComponentAction","mode","then","response","finish"],"mappings":"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"}