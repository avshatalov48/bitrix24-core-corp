{"version":3,"file":"script.js","sources":["src/queue-animation/queue-animation-helper.js","src/queue-animation/state/queue-state.js","src/queue-animation/state/empty-state.js","src/queue-animation/state/single-state.js","src/queue-animation/state/double-state.js","src/queue-animation/state/triple-state.js","src/queue-animation/state/counter-state.js","src/queue-animation/queue-animation-manager.js","src/queue-animation/queue-animation.js","src/grid.js","src/filter.js","src/bi/bi-analytics.js","src/copilot/not-enough-tasks-popup.js"],"sourcesContent":["import { Dom, Event, Loc, Tag, Text } from 'main.core';\n\nimport { State } from './queue-animation';\nimport { User } from './queue-animation-manager';\n\nexport class QueueAnimationHelper\n{\n\t#rowId: number;\n\n\tconstructor(rowId: number)\n\t{\n\t\tthis.#rowId = rowId;\n\t}\n\n\tchangeAvatarsToEmpty(nodes: Array<HTMLElement>): Promise\n\t{\n\t\tconst promises = nodes.map((node) => {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tDom.addClass(node, '--icon');\n\n\t\t\t\tEvent.bindOnce(node, 'transitionend', () => {\n\t\t\t\t\tDom.style(node, null);\n\t\t\t\t\tDom.append(this.#renderPersonNode(), node);\n\t\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\treturn Promise.all(promises);\n\t}\n\n\tasync showAvatars(nodes: Array<HTMLElement>): Promise\n\t{\n\t\tconst promises = nodes.map((node) => {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tDom.removeClass(node, '--hidden');\n\n\t\t\t\tEvent.bindOnce(node, 'transitionend', () => {\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\treturn Promise.all(promises);\n\t}\n\n\tasync hideAvatars(nodes: Array<HTMLElement>): Promise\n\t{\n\t\tconst promises = nodes.map((node) => {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tDom.addClass(node, '--hidden');\n\n\t\t\t\tEvent.bindOnce(node, 'transitionend', () => {\n\t\t\t\t\tresolve(node);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\treturn Promise.all(promises);\n\t}\n\n\trenderHiddenEmptyAvatar(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__list-members-icon_element --icon --hidden --center\">\n\t\t\t\t${this.#renderPersonNode()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderHiddenAvatar(user: User, extraClass: string = ''): HTMLElement\n\t{\n\t\tif ('src' in user.photo)\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"tasks-flow__list-members-icon_element --hidden ${extraClass}\"\n\t\t\t\t\tstyle=\"background-image: url('${encodeURI(user.photo.src)}')\"\n\t\t\t\t></div>\n\t\t\t`;\n\t\t}\n\n\t\tconst uiClasses = 'ui-icon ui-icon-common-user ui-icon-xs';\n\n\t\treturn Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-flow__list-members-icon_element ${uiClasses} --hidden ${extraClass}\"\n\t\t\t>\n\t\t\t\t<i></i>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tasync changeAvatarsToUser(nodes: Array<HTMLElement>, users: Array<User>): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tnodes.forEach((node: HTMLElement, index) => {\n\t\t\t\tconst user = users[index];\n\n\t\t\t\tDom.removeClass(node, ['--icon', '--count', '--at-work']);\n\t\t\t\tDom.clean(node);\n\n\t\t\t\tif ('src' in user.photo)\n\t\t\t\t{\n\t\t\t\t\tDom.style(node, 'background-image', `url('${encodeURI(user.photo.src)}')`);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(node, ['ui-icon', 'ui-icon-common-user', 'ui-icon-xs']);\n\t\t\t\t\tDom.append(Tag.render`<i></i>`, node);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tchangeAvatarToCounter(node: HTMLElement, count: number, memberClass: string = ''): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tDom.removeClass(node, ['ui-icon', 'ui-icon-common-user', 'ui-icon-xs']);\n\t\t\tDom.addClass(node, ['--count', memberClass]);\n\n\t\t\tDom.clean(node);\n\n\t\t\tDom.style(node, null);\n\n\t\t\tDom.append(Tag.render`\n\t\t\t\t<span class=\"tasks-flow__warning-icon_element-plus\">+</span>\n\t\t\t`, node);\n\t\t\tDom.append(Tag.render`\n\t\t\t\t<span class=\"tasks-flow__warning-icon_element-number\">${parseInt(count, 10)}</span>\n\t\t\t`, node);\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tchangeNodeAttributes(statusId: string, node: HTMLElement, state: State, isEmpty: boolean): void\n\t{\n\t\tconst wrapper = node.querySelector('.tasks-flow__list-members_wrapper');\n\t\tconst label = node.querySelector('.tasks-flow__list-members_info');\n\t\tconst list = node.querySelector('.tasks-flow__list-members');\n\n\t\tDom.attr(list, 'data-total', state.total);\n\t\tDom.attr(list, 'data-subsequence', state.subsequence.join(','));\n\n\t\tif (isEmpty)\n\t\t{\n\t\t\tDom.removeClass(wrapper, '--link');\n\t\t\tDom.attr(wrapper, 'onclick', null);\n\n\t\t\tthis.#changeLabel(label, Loc.getMessage('TASKS_FLOW_LIST_NO_TASKS'), true);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(wrapper, '--link');\n\t\t\twrapper.setAttribute(\n\t\t\t\t'onclick',\n\t\t\t\t`BX.Tasks.Flow.Grid.showTaskQueue('${this.#rowId}', '${statusId}', this)`,\n\t\t\t);\n\n\t\t\tthis.#changeLabel(label, state.label);\n\t\t}\n\t}\n\n\tblinkAvatar(node: HTMLElement): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tEvent.bindOnce(node, 'animationend', () => {\n\t\t\t\tDom.removeClass(node, ['--blink']);\n\n\t\t\t\tresolve();\n\t\t\t});\n\n\t\t\tDom.addClass(node, ['--blink']);\n\t\t});\n\t}\n\n\tremoveClassesWithoutAnimation(node: HTMLElement, classes: Array<string>): void\n\t{\n\t\tDom.style(node, 'transition', 'none');\n\t\tDom.removeClass(node, classes);\n\t\t// eslint-disable-next-line no-unused-expressions\n\t\tnode.offsetHeight;\n\t\tDom.style(node, 'transition', '');\n\t}\n\n\tdefineSubsequenceIndices(\n\t\tcurrentSubsequence: Array<number>,\n\t\tnewSubsequence: Array<number>,\n\t): { presentIndices: [], absentIndices: [] }\n\t{\n\t\tconst iteratedSequence = (\n\t\t\tcurrentSubsequence.length >= newSubsequence.length\n\t\t\t\t? currentSubsequence\n\t\t\t\t: newSubsequence\n\t\t);\n\t\tconst comparedSequence = (\n\t\t\tcurrentSubsequence.length >= newSubsequence.length\n\t\t\t\t? newSubsequence\n\t\t\t\t: currentSubsequence\n\t\t);\n\n\t\treturn iteratedSequence.reduce((result, value, index) => {\n\t\t\tif (comparedSequence.includes(value))\n\t\t\t{\n\t\t\t\tresult.presentIndices.push(index);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.absentIndices.push(index);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}, { presentIndices: [], absentIndices: [] });\n\t}\n\n\t#changeLabel(node: HTMLElement, text: string, isEmpty: boolean = false): void\n\t{\n\t\t// eslint-disable-next-line no-param-reassign\n\t\tnode.textContent = Text.encode(text);\n\n\t\tif (isEmpty)\n\t\t{\n\t\t\tDom.removeClass(node, '--link');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(node, '--link');\n\t\t}\n\t}\n\n\t#renderPersonNode(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"ui-icon-set --person\"\n\t\t\t\tstyle=\"--ui-icon-set__icon-color: var(--ui-color-base-50);\"\n\t\t\t></div>\n\t\t`;\n\t}\n}\n","import { State } from '../queue-animation';\nimport { User } from '../queue-animation-manager';\n\nexport class QueueState\n{\n\tanimate(\n\t\tnode: HTMLElement,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t\tstatusId: string,\n\t): Promise\n\t{\n\t\tconst list = node.querySelector('.tasks-flow__list-members');\n\t\tconst children = list.children;\n\t\tconst number = list.childElementCount;\n\n\t\tconst variantHandlers = {\n\t\t\t1: this.animateFromStateWithOneElement.bind(this, list, children, users, state),\n\t\t\t2: this.animateFromStateWithTwoElement.bind(this, list, children, users, state),\n\t\t\t3: this.animateFromStateWithThreeElement.bind(this, list, children, users, state),\n\t\t\t4: this.animateFromStateWithCounter.bind(this, list, children, users, state),\n\t\t\tdefault: this.skipAnimation.bind(this),\n\t\t};\n\t\tconst animateFrom = (variantHandlers[number] || variantHandlers.default);\n\n\t\treturn animateFrom();\n\t}\n\n\tasync animateFromStateWithOneElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n\n\tasync animateFromStateWithTwoElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n\n\tasync animateFromStateWithThreeElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n\n\tasync animateFromStateWithCounter(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n\n\tskipAnimation(): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n}\n","import { Dom } from 'main.core';\n\nimport { State } from '../queue-animation';\nimport { QueueAnimationHelper } from '../queue-animation-helper';\nimport { User } from '../queue-animation-manager';\nimport { QueueState } from './queue-state';\n\nexport class EmptyState extends QueueState\n{\n\t#animationHelper: QueueAnimationHelper;\n\n\tconstructor(animationHelper: QueueAnimationHelper)\n\t{\n\t\tsuper(animationHelper);\n\n\t\tthis.#animationHelper = animationHelper;\n\t}\n\n\tasync animateFromStateWithOneElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\tconsole.log('EmptyState');\n\n\t\tconst currentAvatar = list.lastElementChild;\n\n\t\tDom.prepend(this.#animationHelper.renderHiddenEmptyAvatar(), list);\n\t\tDom.append(this.#animationHelper.renderHiddenEmptyAvatar(), list);\n\n\t\treturn new Promise((resolve) => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.#moveAvatarsToCenter([...children]);\n\n\t\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\t\tthis.#animationHelper.changeAvatarsToEmpty([currentAvatar]).then(() => {\n\t\t\t\t\tthis.#moveAvatarsToDefaultPosition([...children]);\n\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tasync animateFromStateWithTwoElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\tconst firstAvatar = children[0];\n\t\tconst lastAvatar = children[2];\n\n\t\tconst newEmptyAvatar = this.#animationHelper.renderHiddenEmptyAvatar();\n\t\tDom.prepend(newEmptyAvatar, list);\n\n\t\treturn requestAnimationFrame(() => {\n\t\t\tthis.#moveAvatarsToCenter([...children]);\n\n\t\t\treturn this.#animationHelper.changeAvatarsToEmpty([firstAvatar, lastAvatar]).then(() => {\n\t\t\t\tthis.#moveAvatarsToDefaultPosition([...children]);\n\t\t\t});\n\t\t});\n\t}\n\n\tasync animateFromStateWithThreeElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\tthis.#moveAvatarsToCenter([...children]);\n\n\t\treturn this.#animationHelper.changeAvatarsToEmpty([...children]).then(() => {\n\t\t\tthis.#moveAvatarsToDefaultPosition([...children]);\n\t\t});\n\t}\n\n\t#moveAvatarsToCenter(avatars: Array<HTMLElement>)\n\t{\n\t\tavatars.forEach((avatar: HTMLElement) => {\n\t\t\tDom.addClass(avatar, '--center');\n\t\t});\n\t}\n\n\t#moveAvatarsToDefaultPosition(avatars: Array<HTMLElement>)\n\t{\n\t\tavatars.forEach((avatar: HTMLElement) => {\n\t\t\tDom.removeClass(avatar, ['--center', '--hidden']);\n\t\t});\n\t}\n}\n","import { Dom, Event } from 'main.core';\n\nimport { State } from '../queue-animation';\nimport { QueueAnimationHelper } from '../queue-animation-helper';\nimport { User } from '../queue-animation-manager';\nimport { QueueState } from './queue-state';\n\nexport class SingleState extends QueueState\n{\n\t#animationHelper: QueueAnimationHelper;\n\n\tconstructor(animationHelper: QueueAnimationHelper)\n\t{\n\t\tsuper(animationHelper);\n\n\t\tthis.#animationHelper = animationHelper;\n\t}\n\n\tasync animateFromStateWithOneElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\tconst firstAvatar = children[0];\n\n\t\treturn this.#animationHelper.changeAvatarsToUser([firstAvatar], users).then(() => {\n\t\t\tthis.#animationHelper.blinkAvatar(firstAvatar);\n\t\t});\n\t}\n\n\tasync animateFromStateWithTwoElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\tconst firstAvatar = children[0];\n\t\tconst lastAvatar = children[1];\n\n\t\tconst newFirstAvatar = this.#animationHelper.renderHiddenAvatar(users[0], '--invisible');\n\n\t\tDom.prepend(newFirstAvatar, list);\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tEvent.bindOnce(lastAvatar, 'transitionend', () => {\n\t\t\t\tDom.remove(firstAvatar);\n\t\t\t\tDom.remove(lastAvatar);\n\n\t\t\t\tEvent.bindOnce(newFirstAvatar, 'transitionend', () => {\n\t\t\t\t\tthis.#animationHelper.blinkAvatar(newFirstAvatar);\n\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t\tDom.removeClass(newFirstAvatar, ['--hidden', '--invisible']);\n\t\t\t});\n\t\t\tDom.addClass(firstAvatar, '--tiny-right');\n\t\t\tDom.addClass(firstAvatar, '--hidden');\n\t\t\tDom.addClass(lastAvatar, '--tiny-left');\n\t\t\tDom.addClass(lastAvatar, '--hidden');\n\t\t});\n\t}\n\n\tasync animateFromStateWithThreeElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\tconst firstAvatar = children[0];\n\t\tconst middleAvatar = children[1];\n\t\tconst lastAvatar = children[2];\n\n\t\tDom.addClass(firstAvatar, ['--center']);\n\t\tDom.addClass(lastAvatar, ['--center']);\n\n\t\treturn this.#animationHelper.changeAvatarsToUser([middleAvatar], users).then(() => {\n\t\t\tEvent.bindOnce(lastAvatar, 'transitionend', () => {\n\t\t\t\tthis.#animationHelper.blinkAvatar(middleAvatar);\n\t\t\t\tDom.remove(firstAvatar);\n\t\t\t\tDom.remove(lastAvatar);\n\t\t\t});\n\t\t\tDom.addClass(lastAvatar, '--hidden');\n\t\t});\n\t}\n}\n","import { Dom, Event } from 'main.core';\n\nimport { State } from '../queue-animation';\nimport type { QueueAnimationHelper } from '../queue-animation-helper';\nimport { User } from '../queue-animation-manager';\nimport { QueueState } from './queue-state';\n\nexport class DoubleState extends QueueState\n{\n\t#animationHelper: QueueAnimationHelper;\n\n\tconstructor(animationHelper: QueueAnimationHelper)\n\t{\n\t\tsuper(animationHelper);\n\n\t\tthis.#animationHelper = animationHelper;\n\t}\n\n\tanimateFromStateWithOneElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst firstAvatar = children[0];\n\n\t\t\tconst newFirstAvatar = this.#animationHelper.renderHiddenAvatar(users[0], '--start-invisible');\n\n\t\t\tDom.prepend(newFirstAvatar, list);\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tEvent.bindOnce(firstAvatar, 'transitionend', () => {\n\t\t\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\t\t\tthis.#animationHelper.blinkAvatar(newFirstAvatar)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.#animationHelper.removeClassesWithoutAnimation(\n\t\t\t\t\t\t\t\tnewFirstAvatar,\n\t\t\t\t\t\t\t\t['--start-invisible', '--tiny-left'],\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.#animationHelper.removeClassesWithoutAnimation(\n\t\t\t\t\t\t\t\tfirstAvatar,\n\t\t\t\t\t\t\t\t['--tiny-right'],\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t});\n\n\t\t\t\tDom.removeClass(newFirstAvatar, ['--hidden']);\n\n\t\t\t\tDom.addClass(newFirstAvatar, ['--tiny-left']);\n\t\t\t\tDom.addClass(firstAvatar, ['--tiny-right']);\n\t\t\t});\n\t\t});\n\t}\n\n\tasync animateFromStateWithTwoElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\treturn this.#animationHelper.changeAvatarsToUser([...children], users);\n\t}\n\n\tasync animateFromStateWithThreeElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\tconst currentSubsequence = list.dataset.subsequence.split(',').map(Number);\n\t\tconst newSubsequence = state.subsequence;\n\n\t\tconst { presentIndices, absentIndices } = this.#animationHelper.defineSubsequenceIndices(\n\t\t\tcurrentSubsequence,\n\t\t\tnewSubsequence,\n\t\t);\n\n\t\tconst removeAbsentAvatars = (absentAvatars, resolve) => {\n\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\treturn this.#animationHelper.hideAvatars(absentAvatars).then(() => {\n\t\t\t\tabsentAvatars.forEach((absentAvatar) => {\n\t\t\t\t\tDom.remove(absentAvatar);\n\t\t\t\t});\n\n\t\t\t\tresolve();\n\t\t\t});\n\t\t};\n\n\t\tconst variantMovements = {\n\t\t\t'1,2': (absentAvatars: Array<HTMLElement>) => {\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tconst middleAvatar = children[1];\n\t\t\t\t\tconst lastAvatar = children[2];\n\t\t\t\t\tEvent.bindOnce(lastAvatar, 'transitionend', () => {\n\t\t\t\t\t\tthis.#animationHelper.removeClassesWithoutAnimation(middleAvatar, ['--tiny-left']);\n\t\t\t\t\t\tthis.#animationHelper.removeClassesWithoutAnimation(lastAvatar, ['--tiny-left']);\n\t\t\t\t\t});\n\t\t\t\t\tDom.addClass(middleAvatar, '--tiny-left');\n\t\t\t\t\tDom.addClass(lastAvatar, '--tiny-left');\n\n\t\t\t\t\tremoveAbsentAvatars(absentAvatars, resolve);\n\t\t\t\t});\n\t\t\t},\n\t\t\t'0,1': (absentAvatars: Array<HTMLElement>) => {\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tconst firstAvatar = children[0];\n\t\t\t\t\tconst middleAvatar = children[1];\n\t\t\t\t\tEvent.bindOnce(firstAvatar, 'transitionend', () => {\n\t\t\t\t\t\tthis.#animationHelper.removeClassesWithoutAnimation(middleAvatar, ['--tiny-right']);\n\t\t\t\t\t\tthis.#animationHelper.removeClassesWithoutAnimation(firstAvatar, ['--tiny-right']);\n\t\t\t\t\t});\n\t\t\t\t\tDom.addClass(middleAvatar, '--tiny-right');\n\t\t\t\t\tDom.addClass(firstAvatar, '--tiny-right');\n\n\t\t\t\t\tremoveAbsentAvatars(absentAvatars, resolve);\n\t\t\t\t});\n\t\t\t},\n\t\t\t'0,2': (absentAvatars: Array<HTMLElement>) => {\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tconst firstAvatar = children[0];\n\t\t\t\t\tconst lastAvatar = children[2];\n\t\t\t\t\tEvent.bindOnce(lastAvatar, 'transitionend', () => {\n\t\t\t\t\t\tthis.#animationHelper.removeClassesWithoutAnimation(firstAvatar, ['--tiny-right']);\n\t\t\t\t\t\tthis.#animationHelper.removeClassesWithoutAnimation(lastAvatar, ['--tiny-left']);\n\t\t\t\t\t});\n\t\t\t\t\tDom.addClass(firstAvatar, '--tiny-right');\n\t\t\t\t\tDom.addClass(lastAvatar, '--tiny-left');\n\n\t\t\t\t\tremoveAbsentAvatars(absentAvatars, resolve);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdefault: () => {\n\t\t\t\treturn Promise.resolve();\n\t\t\t},\n\t\t};\n\n\t\tconst presentSubsequence = presentIndices.join(',');\n\t\tconst variantMovement = (\n\t\t\tvariantMovements[presentSubsequence]\n\t\t\t|| variantMovements.default\n\t\t);\n\n\t\tconst absentAvatars = [];\n\t\tabsentIndices.forEach((absentIndex) => {\n\t\t\tabsentAvatars.push(children[absentIndex]);\n\t\t});\n\n\t\treturn variantMovement(absentAvatars);\n\t}\n}\n","import { Dom, Event } from 'main.core';\n\nimport { State } from '../queue-animation';\nimport { QueueAnimationHelper } from '../queue-animation-helper';\nimport { User } from '../queue-animation-manager';\nimport { QueueState } from './queue-state';\n\nexport class TripleState extends QueueState\n{\n\t#animationHelper: QueueAnimationHelper;\n\n\tconstructor(animationHelper: QueueAnimationHelper)\n\t{\n\t\tsuper(animationHelper);\n\n\t\tthis.#animationHelper = animationHelper;\n\t}\n\n\tasync animateFromStateWithTwoElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst firstAvatar = children[0];\n\t\t\tconst lastAvatar = children[1];\n\n\t\t\tconst newFirstAvatar = this.#animationHelper.renderHiddenAvatar(users[0], '--start-invisible');\n\n\t\t\tDom.prepend(newFirstAvatar, list);\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tEvent.bindOnce(firstAvatar, 'transitionend', () => {\n\t\t\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\t\t\tthis.#animationHelper.blinkAvatar(newFirstAvatar)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.#animationHelper.removeClassesWithoutAnimation(\n\t\t\t\t\t\t\t\tnewFirstAvatar,\n\t\t\t\t\t\t\t\t['--start-invisible', '--tiny-left'],\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.#animationHelper.removeClassesWithoutAnimation(\n\t\t\t\t\t\t\t\tfirstAvatar,\n\t\t\t\t\t\t\t\t['--tiny-right'],\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.#animationHelper.removeClassesWithoutAnimation(\n\t\t\t\t\t\t\t\tlastAvatar,\n\t\t\t\t\t\t\t\t['--tiny-right'],\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t});\n\n\t\t\t\tDom.removeClass(newFirstAvatar, ['--hidden']);\n\n\t\t\t\tDom.addClass(newFirstAvatar, ['--tiny-left']);\n\t\t\t\tDom.addClass(firstAvatar, ['--tiny-right']);\n\t\t\t\tDom.addClass(lastAvatar, ['--tiny-right']);\n\t\t\t});\n\t\t});\n\t}\n\n\tasync animateFromStateWithThreeElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\treturn this.#animationHelper.changeAvatarsToUser([...children], users);\n\t}\n\n\tasync animateFromStateWithCounter(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\tawait this.#animationHelper.hideAvatars([...children]);\n\n\t\tawait this.#animationHelper.changeAvatarsToUser([...children], users)\n\t\t\t.then(() => {\n\t\t\t\treturn this.#animationHelper.showAvatars([...children]);\n\t\t\t})\n\t\t;\n\n\t\treturn Promise.resolve();\n\t}\n}\n","import { Dom, Event } from 'main.core';\n\nimport { State } from '../queue-animation';\nimport { QueueAnimationHelper } from '../queue-animation-helper';\nimport { User } from '../queue-animation-manager';\nimport { QueueState } from './queue-state';\n\nexport class CounterState extends QueueState\n{\n\t#animationHelper: QueueAnimationHelper;\n\n\t#counter: number;\n\t#statusId: string;\n\n\tconstructor(animationHelper: QueueAnimationHelper)\n\t{\n\t\tsuper(animationHelper);\n\n\t\tthis.#animationHelper = animationHelper;\n\t}\n\n\tanimate(node: HTMLElement, users: Array<User>, state: State, statusId: string): Promise\n\t{\n\t\tconst maxVisibleNumberAvatars = 99;\n\t\tconst visibleAmount = 2;\n\t\tconst invisibleAmount = state.total - visibleAmount;\n\n\t\tthis.#counter = Math.min(invisibleAmount, maxVisibleNumberAvatars);\n\t\tthis.#statusId = statusId;\n\n\t\treturn super.animate(node, users, state, statusId);\n\t}\n\n\tasync animateFromStateWithThreeElement(\n\t\tlist: HTMLElement,\n\t\tchildren: HTMLCollection,\n\t\tusers: Array<User>,\n\t\tstate: State,\n\t): Promise\n\t{\n\t\tconst firstAvatar = children[0];\n\t\tconst middleAvatar = children[1];\n\t\tconst lastAvatar = children[2];\n\n\t\tconst newFirstAvatar = this.#animationHelper.renderHiddenAvatar(users[0], '--invisible');\n\t\tconst newMiddleAvatar = this.#animationHelper.renderHiddenAvatar(users[1], '--invisible');\n\n\t\tDom.prepend(newMiddleAvatar, list);\n\t\tDom.prepend(newFirstAvatar, list);\n\n\t\tEvent.bindOnce(firstAvatar, 'transitionend', () => {\n\t\t\tDom.remove(firstAvatar);\n\t\t\tDom.removeClass(newFirstAvatar, ['--invisible']);\n\t\t});\n\t\tEvent.bindOnce(middleAvatar, 'transitionend', () => {\n\t\t\tDom.remove(middleAvatar);\n\t\t\tDom.removeClass(newMiddleAvatar, ['--invisible']);\n\t\t});\n\n\t\tDom.removeClass(newFirstAvatar, ['--hidden']);\n\t\tDom.removeClass(newMiddleAvatar, ['--hidden']);\n\n\t\tDom.addClass(firstAvatar, ['--right']);\n\t\tDom.addClass(middleAvatar, ['--right']);\n\n\t\tconst memberClass = this.#statusId === 'AT_WORK' ? '--at-work' : '';\n\n\t\treturn this.#animationHelper.changeAvatarToCounter(lastAvatar, this.#counter, memberClass)\n\t\t\t.then(() => {\n\t\t\t\tthis.#animationHelper.blinkAvatar(lastAvatar);\n\t\t\t})\n\t\t;\n\t}\n}\n","import { AnimationInfo, State } from './queue-animation';\nimport { QueueAnimationHelper } from './queue-animation-helper';\n\nimport { EmptyState } from './state/empty-state';\nimport type { QueueState } from './state/queue-state';\nimport { SingleState } from './state/single-state';\nimport { DoubleState } from './state/double-state';\nimport { TripleState } from './state/triple-state';\nimport { CounterState } from './state/counter-state';\n\nexport type User = {\n\tid: number,\n\tname: string,\n\tpathToProfile: string,\n\tphoto: Photo,\n}\n\ntype Photo = {\n\tsrc: string,\n}\n\nexport class QueueAnimationManager\n{\n\t#animationHelper: QueueAnimationHelper;\n\n\tconstructor(rowId: number)\n\t{\n\t\tthis.#animationHelper = new QueueAnimationHelper(rowId);\n\t}\n\n\tasync animate(animationInfo: AnimationInfo): Promise\n\t{\n\t\tconst animationStates = {\n\t\t\t0: (new EmptyState(this.#animationHelper)),\n\t\t\t1: (new SingleState(this.#animationHelper)),\n\t\t\t2: (new DoubleState(this.#animationHelper)),\n\t\t\t3: (new TripleState(this.#animationHelper)),\n\t\t\tdefault: (new CounterState(this.#animationHelper)),\n\t\t};\n\n\t\tconst processStatusAnimation = async (newStateOfStatuses) => {\n\t\t\tfor (const [statusId: string, state: State] of newStateOfStatuses)\n\t\t\t{\n\t\t\t\tconst animationState: QueueState = (\n\t\t\t\t\tanimationStates[state.total]\n\t\t\t\t\t|| animationStates.default\n\t\t\t\t);\n\t\t\t\tconst node = animationInfo.linkToNodes.get(statusId);\n\t\t\t\tconst users = animationInfo.linkToQueueData.get(statusId);\n\n\t\t\t\t// eslint-disable-next-line no-await-in-loop\n\t\t\t\tawait animationState.animate(node, users, state, statusId).then(() => {\n\t\t\t\t\tthis.#animationHelper.changeNodeAttributes(statusId, node, state, state.total === 0);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tawait processStatusAnimation(animationInfo.newStateOfStatuses);\n\n\t\t// eslint-disable-next-line no-promise-executor-return\n\t\treturn new Promise((resolve) => setTimeout(resolve, 500));\n\t}\n}\n","import { QueueAnimationManager } from './queue-animation-manager';\nimport { User } from './queue-animation-manager';\n\ntype Data = {\n\tFLOW_ID: number,\n\tnewStatus: Status,\n\toldStatus?: Status,\n}\n\ntype Status = {\n\tid: string,\n\tqueue: Array<User>,\n\tqueueSubsequence: Array<number>,\n\ttotal: number,\n\tdate: string,\n}\n\nexport type State = {\n\ttotal: number,\n\tsubsequence: Array<number>,\n\tlabel: string,\n}\n\nexport type AnimationInfo = {\n\tlinkToNodes: Map<string, HTMLElement>,\n\tlinkToQueueData: Map<string, Array<User>>,\n\tcurrentStateOfStatuses: Map<string, State>,\n\tnewStateOfStatuses: Map<string, State>,\n}\n\nexport class QueueAnimation\n{\n\t#grid: BX.Main.grid;\n\t#data: Data;\n\t#rowId: number;\n\t#animationManager: QueueAnimationManager;\n\n\tconstructor(grid, data: Data)\n\t{\n\t\tthis.#grid = grid;\n\t\tthis.#data = data;\n\t\tthis.#rowId = parseInt(data.FLOW_ID, 10);\n\n\t\tthis.#animationManager = new QueueAnimationManager(this.#rowId);\n\t}\n\n\tstart(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst animationInfo: AnimationInfo = this.#prepareData();\n\n\t\t\tthis.#animationManager.animate(animationInfo)\n\t\t\t\t.then(() => {\n\t\t\t\t\tresolve();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\treject();\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\t#prepareData(): AnimationInfo\n\t{\n\t\tconst linkToNodes: Map<string, HTMLElement> = new Map();\n\t\tconst linkToQueueData: Map<string, Array<User>> = new Map();\n\n\t\tconst currentStateOfStatuses: Map<string, State> = new Map();\n\t\tconst newStateOfStatuses: Map<string, State> = new Map();\n\n\t\tthis.#getNodes().forEach((node: HTMLElement, statusId: string) => {\n\t\t\tlinkToNodes.set(statusId, node);\n\t\t\tcurrentStateOfStatuses.set(statusId, this.#getCurrentState(node));\n\t\t});\n\n\t\tthis.#getNewStatuses().forEach((status: Status, statusId: string) => {\n\t\t\tlinkToQueueData.set(statusId, status.queue);\n\t\t\tnewStateOfStatuses.set(statusId, this.#getNewState(status));\n\t\t});\n\n\t\tthis.#compareAndFilterStates(currentStateOfStatuses, newStateOfStatuses);\n\t\tthis.#removeDeletedKeys(newStateOfStatuses, linkToNodes, linkToQueueData);\n\n\t\treturn {\n\t\t\tlinkToNodes,\n\t\t\tlinkToQueueData,\n\t\t\tcurrentStateOfStatuses,\n\t\t\tnewStateOfStatuses,\n\t\t};\n\t}\n\n\t#getNodes(): Map<string, HTMLElement>\n\t{\n\t\tconst list = new Map();\n\n\t\tconst addToList = (statusId: string) => {\n\t\t\tlist.set(\n\t\t\t\tstatusId,\n\t\t\t\tthis.#getCell(statusId),\n\t\t\t);\n\t\t};\n\n\t\tif ('newStatus' in this.#data)\n\t\t{\n\t\t\taddToList(this.#data.newStatus.id);\n\t\t}\n\n\t\tif ('oldStatus' in this.#data)\n\t\t{\n\t\t\taddToList(this.#data.oldStatus.id);\n\t\t}\n\n\t\treturn list;\n\t}\n\n\t#getNewStatuses(): Map<string, State>\n\t{\n\t\tconst list = new Map();\n\n\t\tconst addToList = (status: Status) => {\n\t\t\tlist.set(status.id, status);\n\t\t};\n\n\t\tif ('newStatus' in this.#data)\n\t\t{\n\t\t\taddToList(this.#data.newStatus);\n\t\t}\n\n\t\tif ('oldStatus' in this.#data)\n\t\t{\n\t\t\taddToList(this.#data.oldStatus);\n\t\t}\n\n\t\treturn list;\n\t}\n\n\t#getCurrentState(node: HTMLElement): State\n\t{\n\t\tconst listNode = node.querySelector('.tasks-flow__list-members');\n\t\tconst labelNode = node.querySelector('.tasks-flow__list-members_info');\n\n\t\tconst subsequence: string = (\n\t\t\tthis.#isValidSequence(listNode.dataset.subsequence)\n\t\t\t\t? listNode.dataset.subsequence.split(',').map(Number)\n\t\t\t\t: []\n\t\t);\n\n\t\treturn {\n\t\t\ttotal: parseInt(listNode.dataset.total, 10),\n\t\t\tsubsequence,\n\t\t\tlabel: labelNode.textContent.trim(),\n\t\t};\n\t}\n\n\t#getNewState(status: Status): State\n\t{\n\t\treturn {\n\t\t\ttotal: parseInt(status.total, 10),\n\t\t\tsubsequence: status.queueSubsequence,\n\t\t\tlabel: status.date,\n\t\t};\n\t}\n\n\t#getRow(): BX.Grid.Row\n\t{\n\t\treturn this.#grid.getRows().getById(this.#rowId);\n\t}\n\n\t#getCell(columnId: string): ?HTMLElement\n\t{\n\t\treturn this.#getRow(this.#rowId).getCellById(columnId);\n\t}\n\n\t#isValidSequence(sequence: string): boolean\n\t{\n\t\tconst regex = /^\\d+(,\\d+)*$/;\n\n\t\treturn regex.test(sequence);\n\t}\n\n\t#statesAreEqual(first: State, second: State): boolean\n\t{\n\t\tif (first.total !== second.total)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (first.subsequence.length !== second.subsequence.length)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let i = 0; i < first.subsequence.length; i++)\n\t\t{\n\t\t\tif (first.subsequence[i] !== second.subsequence[i])\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t#compareAndFilterStates(first: Map<string, State>, second: Map<string, State>)\n\t{\n\t\tfor (const [key, value] of first)\n\t\t{\n\t\t\tif (second.has(key) && this.#statesAreEqual(value, second.get(key)))\n\t\t\t{\n\t\t\t\tfirst.delete(key);\n\t\t\t\tsecond.delete(key);\n\t\t\t}\n\t\t}\n\t}\n\n\t#removeDeletedKeys(\n\t\tnewStateOfStatuses: Map<string, State>,\n\t\tlinkToNodes: Map<string, HTMLElement>,\n\t\tlinkToQueueData: Map<string, Array<User>>,\n\t) {\n\t\tfor (const key of linkToNodes.keys())\n\t\t{\n\t\t\tif (!newStateOfStatuses.has(key))\n\t\t\t{\n\t\t\t\tlinkToNodes.delete(key);\n\t\t\t}\n\t\t}\n\n\t\tfor (const key of linkToQueueData.keys())\n\t\t{\n\t\t\tif (!newStateOfStatuses.has(key))\n\t\t\t{\n\t\t\t\tlinkToQueueData.delete(key);\n\t\t\t}\n\t\t}\n\t}\n}\n","import { ajax, AjaxError, AjaxResponse, Dom, Event, Loc, Type, Uri } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { EditForm } from 'tasks.flow.edit-form';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { QueueManager } from 'pull.queuemanager';\nimport { TeamPopup } from 'tasks.flow.team-popup';\nimport { TaskQueue } from 'tasks.flow.task-queue';\nimport { Clue } from 'tasks.clue';\nimport { Manual } from 'ui.manual';\nimport { UI } from 'ui.notification';\n\nimport { QueueAnimation } from './queue-animation/queue-animation';\n\ntype Params = {\n\tgridId: number,\n\tcurrentUserId: number,\n\tcurrentUrl: string,\n\tisAhaShownOnMyTasksColumn: boolean,\n\tisAhaShownCopilotAdvice: boolean,\n\tflowLimitCode: string,\n};\n\ntype PullItem = {\n\tid: string,\n\tdata: {\n\t\tid: number,\n\t\taction: string,\n\t\tactionParams: {\n\t\t\tTASK_ID: number,\n\t\t\tFLOW_ID?: number,\n\t\t},\n\t}\n}\n\nexport class Grid\n{\n\t#params: Params;\n\n\t#grid: BX.Main.grid;\n\n\t#instantPullHandlers: Object;\n\t#delayedPullFlowHandlers: Object;\n\t#delayedPullTasksHandlers: Object;\n\n\t#clueMyTasks: ?Clue = null;\n\t#clueCopilotAdvice: ?Clue = null;\n\t#rowIdForMyTasksAhaMoment = null;\n\t#notificationList: Set = new Set();\n\n\t#addedFlowId: ?number = null;\n\n\t#loadItemsDelay: number = 500;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\n\t\tthis.#grid = BX.Main.gridManager.getById(this.#params.gridId).instance;\n\n\t\tthis.#instantPullHandlers = {\n\t\t\tcomment_read_all: this.#commentReadAll,\n\t\t\tflow_add: this.#onFlowAdd,\n\t\t\tflow_delete: this.#onFlowDelete,\n\t\t};\n\n\t\tthis.#delayedPullFlowHandlers = {\n\t\t\tflow_update: this.#onFlowUpdate,\n\t\t};\n\n\t\tthis.#delayedPullTasksHandlers = {\n\t\t\tcomment_add: this.#onFlowUpdate,\n\t\t\ttask_add: this.#onFlowUpdate,\n\t\t\ttask_update: this.#onFlowUpdate,\n\t\t\ttask_view: this.#onFlowUpdate,\n\t\t\ttask_remove: this.#onFlowUpdate,\n\t\t};\n\n\t\tthis.#subscribeToPull();\n\t\tthis.#subscribeToGridEvents();\n\n\t\tthis.#clearAnalyticsParams();\n\t\tthis.#activateHint();\n\t\tthis.#colorPinnedRows();\n\t\tthis.#showFlowCreationWizard();\n\n\t\tthis.#showAhaCopilotAdvice();\n\t}\n\n\tactivateFlow(flowId: number): void\n\t{\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tajax.runAction(\n\t\t\t'tasks.flow.Flow.activate',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tflowId,\n\t\t\t\t},\n\t\t\t},\n\t\t).then(() => {});\n\t}\n\n\tpinFlow(flowId: number, skipNotify: boolean = false): void\n\t{\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tajax.runAction(\n\t\t\t'tasks.flow.Flow.pin',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tflowId,\n\t\t\t\t},\n\t\t\t},\n\t\t).then((response) => {\n\t\t\tif (!skipNotify)\n\t\t\t{\n\t\t\t\tconst code = response.data ? 'TASKS_FLOW_LIST_FLOW_PINNED' : 'TASKS_FLOW_LIST_FLOW_UNPINNED';\n\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: BX.Loc.getMessage(code),\n\t\t\t\t\tactions: [{\n\t\t\t\t\t\ttitle: BX.Loc.getMessage('TASKS_FLOW_LIST_FLOW_PIN_CANCEL'),\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: (event, baloon) => {\n\t\t\t\t\t\t\t\tthis.pinFlow(flowId, true);\n\n\t\t\t\t\t\t\t\tbaloon.close();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t}],\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.#updateRow(flowId);\n\t\t});\n\t}\n\n\tremoveFlow(flowId: number)\n\t{\n\t\tconst message = new MessageBox({\n\t\t\tmessage: Loc.getMessage('TASKS_FLOW_LIST_CONFIRM_REMOVE_MESSAGE'),\n\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\tokCaption: Loc.getMessage('TASKS_FLOW_LIST_CONFIRM_REMOVE_BUTTON'),\n\t\t\tpopupOptions: {\n\t\t\t\tid: `tasks-flow-remove-confirm-${flowId}`,\n\t\t\t},\n\t\t\tonOk: () => {\n\t\t\t\tmessage.close();\n\n\t\t\t\tthis.#updateRow(flowId, 'remove');\n\t\t\t},\n\t\t\tonCancel: () => {\n\t\t\t\tmessage.close();\n\t\t\t},\n\t\t});\n\n\t\tmessage.show();\n\t}\n\n\tshowTeam(flowId: number, bindElement?: HTMLElement): void\n\t{\n\t\tTeamPopup.showInstance({ flowId, bindElement });\n\t}\n\n\tshowTaskQueue(flowId: number, type: string, bindElement?: HTMLElement): void\n\t{\n\t\tTaskQueue.showInstance({ flowId, type, bindElement });\n\t}\n\n\tshowFlowLimit(): void\n\t{\n\t\tFeaturePromotersRegistry.getPromoter({ code: this.#params.flowLimitCode }).show();\n\t}\n\n\tshowNotificationHint(notificationId: string, textHint: string): void\n\t{\n\t\tif (!this.#notificationList.has(notificationId))\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tid: notificationId,\n\t\t\t\tcontent: textHint,\n\t\t\t\twidth: 'auto',\n\t\t\t});\n\n\t\t\tthis.#notificationList.add(notificationId);\n\n\t\t\tEventEmitter.subscribeOnce(\n\t\t\t\t'UI.Notification.Balloon:onClose',\n\t\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\t\tconst closingBalloon = baseEvent.getTarget();\n\t\t\t\t\tif (closingBalloon.getId() === notificationId)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#notificationList.delete(notificationId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t}\n\n\tshowGuide(demoSuffix: 'Y' | 'N'): void\n\t{\n\t\tManual.show({\n\t\t\tmanualCode: 'flows',\n\t\t\turlParams: {\n\t\t\t\tutm_source: 'portal',\n\t\t\t\tutm_medium: 'referral',\n\t\t\t},\n\t\t\tanalytics: {\n\t\t\t\ttool: 'tasks',\n\t\t\t\tcategory: 'flows',\n\t\t\t\tevent: 'flow_guide_view',\n\t\t\t\tc_section: 'tasks',\n\t\t\t\tc_sub_section: 'flows_grid',\n\t\t\t\tc_element: 'guide_button',\n\t\t\t\tp1: `isDemo_${demoSuffix}`,\n\t\t\t},\n\t\t});\n\t}\n\n\t#reload(): void\n\t{\n\t\tthis.#grid.reload(this.#params.currentUrl);\n\t}\n\n\t#updateRow(flowId: number, action: string): void\n\t{\n\t\tthis.#grid.updateRow(\n\t\t\tflowId,\n\t\t\t{\n\t\t\t\taction,\n\t\t\t\tcurrentPage: this.#grid.getCurrentPage(),\n\t\t\t},\n\t\t\tthis.#params.currentUrl,\n\t\t\tthis.#afterRowUpdated.bind(this),\n\t\t);\n\t}\n\n\t#removeRow(rowId: number): void\n\t{\n\t\tthis.#grid.removeRow(rowId);\n\t}\n\n\t#moveRowToFirstPosition(rowId: number): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst inputRow = this.#getRowById(rowId);\n\n\t\t\tconst firstRow = (\n\t\t\t\tthis.#isPinned(inputRow.getNode())\n\t\t\t\t\t? this.#getFirstPinnedRow()\n\t\t\t\t\t: this.#getFirstUnpinnedRow()\n\t\t\t);\n\n\t\t\t// eslint-disable-next-line @bitrix24/bitrix24-rules/no-native-dom-methods\n\t\t\tthis.#grid.getRows().insertBefore(rowId, firstRow.getId());\n\n\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\tthis.#highlightRow(rowId).then(() => {\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\t#highlightRow(rowId: number): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst rowNode: HTMLElement = this.#getRowById(rowId).getNode();\n\n\t\t\tEvent.bindOnce(rowNode, 'animationend', () => {\n\t\t\t\tresolve();\n\n\t\t\t\tDom.removeClass(rowNode, 'tasks-flow__list-flow-highlighted');\n\t\t\t});\n\t\t\tDom.addClass(rowNode, 'tasks-flow__list-flow-highlighted');\n\t\t});\n\t}\n\n\t#isFirstRow(rowId: number): boolean\n\t{\n\t\tconst inputRow = this.#getRowById(rowId);\n\n\t\tif (this.#isPinned(inputRow.getNode()))\n\t\t{\n\t\t\tconst row = this.#getFirstPinnedRow();\n\n\t\t\treturn parseInt(row?.getId(), 10) === rowId;\n\t\t}\n\n\t\tconst row = this.#getFirstUnpinnedRow();\n\n\t\treturn parseInt(row?.getId(), 10) === rowId;\n\t}\n\n\t#isRowExist(rowId: number): boolean\n\t{\n\t\treturn this.#getRowById(rowId) !== null;\n\t}\n\n\t#isFirstPage(): boolean\n\t{\n\t\treturn this.#grid.getCurrentPage() === 1;\n\t}\n\n\t#getRowById(rowId: number): BX.Grid.Row\n\t{\n\t\treturn this.#grid.getRows().getById(rowId);\n\t}\n\n\t#getFirstPinnedRow(): BX.Grid.Row\n\t{\n\t\tconst rows = this.#grid.getRows().getBodyChild();\n\n\t\treturn rows.find((row) => {\n\t\t\treturn this.#isPinned(row.getNode());\n\t\t});\n\t}\n\n\t#getFirstUnpinnedRow(): BX.Grid.Row\n\t{\n\t\tconst rows = this.#grid.getRows().getBodyChild();\n\n\t\treturn rows.find((row) => {\n\t\t\treturn !this.#isPinned(row.getNode());\n\t\t});\n\t}\n\n\t#getCell(rowId: number, columnId: string): ?HTMLElement\n\t{\n\t\treturn this.#getRowById(rowId).getCellById(columnId);\n\t}\n\n\t#subscribeToPull(): void\n\t{\n\t\tnew QueueManager({\n\t\t\tmoduleId: 'tasks',\n\t\t\tuserId: this.#params.currentUserId,\n\t\t\tconfig: {\n\t\t\t\tloadItemsDelay: this.#loadItemsDelay,\n\t\t\t},\n\t\t\tadditionalData: {},\n\t\t\tevents: {\n\t\t\t\tonBeforePull: (event) => {\n\t\t\t\t\tthis.#onBeforePull(event);\n\t\t\t\t},\n\t\t\t\tonPull: (event) => {\n\t\t\t\t\tthis.#onPull(event);\n\t\t\t\t},\n\t\t\t},\n\t\t\tcallbacks: {\n\t\t\t\tonBeforeQueueExecute: (items) => {\n\t\t\t\t\treturn this.#onBeforeQueueExecute(items);\n\t\t\t\t},\n\t\t\t\tonQueueExecute: (items) => {\n\t\t\t\t\treturn this.#onQueueExecute(items);\n\t\t\t\t},\n\t\t\t\tonReload: () => {\n\t\t\t\t\tthis.#onReload();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#subscribeToGridEvents(): void\n\t{\n\t\tEventEmitter.subscribe('Grid::updated', () => {\n\t\t\tthis.#activateHint();\n\t\t\tthis.#highlightAddedFlow();\n\t\t\tthis.#colorPinnedRows();\n\t\t});\n\t}\n\n\t#onBeforePull(event): void\n\t{\n\t\tconst { pullData: { command, params } } = event.data;\n\n\t\tif (this.#instantPullHandlers[command])\n\t\t{\n\t\t\tconst flowId = this.#recognizeFlowId(params);\n\n\t\t\tthis.#instantPullHandlers[command].apply(this, [params, flowId]);\n\t\t}\n\t}\n\n\t#onPull(event): void\n\t{\n\t\tconst { pullData: { command, params }, promises } = event.data;\n\n\t\tif (Object.keys(this.#delayedPullFlowHandlers).includes(command))\n\t\t{\n\t\t\tconst flowId = this.#recognizeFlowId(params);\n\n\t\t\tif (flowId)\n\t\t\t{\n\t\t\t\tpromises.push(\n\t\t\t\t\tPromise.resolve({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: flowId,\n\t\t\t\t\t\t\taction: command,\n\t\t\t\t\t\t\tactionParams: params,\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (Object.keys(this.#delayedPullTasksHandlers).includes(command))\n\t\t{\n\t\t\tconst taskId = this.#recognizeTaskId(params);\n\n\t\t\tif (taskId)\n\t\t\t{\n\t\t\t\tpromises.push(\n\t\t\t\t\tPromise.resolve({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: taskId,\n\t\t\t\t\t\t\taction: command,\n\t\t\t\t\t\t\tactionParams: params,\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\t#onBeforeQueueExecute(items: Array<PullItem>): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n\n\tasync #onQueueExecute(items: Array<PullItem>): Promise\n\t{\n\t\tconst flowItems = this.#identifyFlowItems(items);\n\t\tconst taskItems = this.#identifyTaskItems(items);\n\n\t\tif (taskItems.length === 0)\n\t\t{\n\t\t\tawait this.#executeQueueAnimation(flowItems);\n\n\t\t\treturn this.#executeQueue(flowItems, this.#delayedPullFlowHandlers);\n\t\t}\n\n\t\tlet mapIds: {} = await this.#getMapIds(this.#getEntityIds(taskItems));\n\t\tconst taskRemoveItem = this.#findTaskRemoveAction(taskItems);\n\t\tif (taskRemoveItem)\n\t\t{\n\t\t\tmapIds = this.#addTaskRemoveItemToMap(taskRemoveItem, mapIds);\n\t\t}\n\n\t\tconst convertedTaskItems = this.#convertTaskItems(taskItems, mapIds);\n\n\t\tconst taskAddItem = this.#findTaskAddAction(convertedTaskItems);\n\t\tif (taskAddItem && this.#isCurrentUserCreatorOfTheTask(taskAddItem))\n\t\t{\n\t\t\tconst { data: { id } } = taskAddItem;\n\n\t\t\tthis.#rowIdForMyTasksAhaMoment = id;\n\t\t}\n\n\t\tconst allItems = [...flowItems, ...convertedTaskItems];\n\n\t\tawait this.#executeQueueAnimation(allItems);\n\n\t\treturn this.#executeQueue(\n\t\t\tthis.#uniqueItems(allItems),\n\t\t\t{ ...this.#delayedPullFlowHandlers, ...this.#delayedPullTasksHandlers },\n\t\t);\n\t}\n\n\tasync #executeQueueAnimation(items: Array<PullItem>): Promise\n\t{\n\t\tconst processItemAnimation = async () => {\n\t\t\tfor (const item of items)\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-await-in-loop\n\t\t\t\tawait this.#processItemAnimation(item);\n\t\t\t}\n\t\t};\n\n\t\tawait processItemAnimation();\n\n\t\treturn Promise.resolve();\n\t}\n\n\t#processItemAnimation(item: PullItem)\n\t{\n\t\tconst { data: { action, actionParams, id } } = item;\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (\n\t\t\t\taction === 'flow_update'\n\t\t\t\t&& ('activity' in actionParams)\n\t\t\t\t&& this.#isRowExist(id)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (this.#isFirstPage() && !this.#isFirstRow(id))\n\t\t\t\t{\n\t\t\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\t\t\tthis.#moveRowToFirstPosition(id).then(() => {\n\t\t\t\t\t\t(new QueueAnimation(this.#grid, actionParams))\n\t\t\t\t\t\t\t.start()\n\t\t\t\t\t\t\t.then(() => resolve())\n\t\t\t\t\t\t\t.catch(() => resolve())\n\t\t\t\t\t\t;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t(new QueueAnimation(this.#grid, actionParams))\n\t\t\t\t\t\t.start()\n\t\t\t\t\t\t.then(() => resolve())\n\t\t\t\t\t\t.catch(() => resolve())\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n\n\t#getMapIds(taskIds: Array): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\tajax.runComponentAction(\n\t\t\t\t'bitrix:tasks.flow.list',\n\t\t\t\t'getMapIds',\n\t\t\t\t{\n\t\t\t\t\tmode: 'class',\n\t\t\t\t\tdata: { taskIds },\n\t\t\t\t},\n\t\t\t)\n\t\t\t\t.then((response: AjaxResponse) => {\n\t\t\t\t\tresolve(Type.isArray(response.data) ? {} : response.data);\n\t\t\t\t})\n\t\t\t\t.catch((error: AjaxError) => {\n\t\t\t\t\tthis.#consoleError('getMapIds', error);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\t#onReload(event) {}\n\n\t#executeQueue(items: Array<PullItem>, handlers: {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\titems.forEach((item: PullItem) => {\n\t\t\t\tconst { data: { action, actionParams, id } } = item;\n\n\t\t\t\tif (handlers[action])\n\t\t\t\t{\n\t\t\t\t\thandlers[action].apply(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t[actionParams, id],\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tresolve();\n\t\t});\n\t}\n\n\t#commentReadAll(): void\n\t{\n\t\tthis.#reload();\n\t}\n\n\t#onFlowAdd(data, flowId: number): void\n\t{\n\t\tif (this.#isRowExist(flowId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#isFirstPage())\n\t\t{\n\t\t\tthis.#addedFlowId = flowId;\n\n\t\t\tthis.#reload();\n\t\t}\n\t}\n\n\t#onFlowUpdate(data, flowId: number): void\n\t{\n\t\tif (!this.#isRowExist(flowId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#updateRow(flowId, 'update');\n\t}\n\n\t#onFlowDelete(data, flowId: number): void\n\t{\n\t\tif (!this.#isRowExist(flowId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#removeRow(flowId);\n\t}\n\n\t#afterRowUpdated(id, data, grid, response)\n\t{\n\t\tif (this.#rowIdForMyTasksAhaMoment)\n\t\t{\n\t\t\tif (this.#clueMyTasks && this.#clueMyTasks.isShown())\n\t\t\t{\n\t\t\t\tconst bindElement = this.#getBindElementForAhaOnCell(\n\t\t\t\t\tthis.#rowIdForMyTasksAhaMoment,\n\t\t\t\t\t'MY_TASKS',\n\t\t\t\t\t'.tasks-flow__list-my-tasks span',\n\t\t\t\t);\n\n\t\t\t\tif (bindElement)\n\t\t\t\t{\n\t\t\t\t\tthis.#clueMyTasks.adjustPosition(bindElement);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.#clueMyTasks.close();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.#params.isAhaShownOnMyTasksColumn === false\n\t\t\t\t&& this.#clueMyTasks === null\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.#showAhaOnMyTasksColumn(this.#rowIdForMyTasksAhaMoment);\n\t\t\t}\n\t\t}\n\t}\n\n\t#recognizeFlowId(pullData): number\n\t{\n\t\tif ('FLOW_ID' in pullData)\n\t\t{\n\t\t\treturn parseInt(pullData.FLOW_ID, 10);\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t#recognizeTaskId(pullData): number\n\t{\n\t\tif ('TASK_ID' in pullData)\n\t\t{\n\t\t\treturn parseInt(pullData.TASK_ID, 10);\n\t\t}\n\n\t\tif ('taskId' in pullData)\n\t\t{\n\t\t\treturn parseInt(pullData.taskId, 10);\n\t\t}\n\n\t\tif (\n\t\t\t'entityXmlId' in pullData\n\t\t\t&& pullData.entityXmlId.indexOf('TASK_') === 0\n\t\t)\n\t\t{\n\t\t\treturn parseInt(pullData.entityXmlId.slice(5), 10);\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t#getEntityIds(pullItems: Array<PullItem>): Array\n\t{\n\t\tconst entityIds = [];\n\n\t\tpullItems.forEach((item: PullItem) => {\n\t\t\tconst { data: { id } } = item;\n\t\t\tentityIds.push(id);\n\t\t});\n\n\t\treturn entityIds;\n\t}\n\n\t#identifyFlowItems(pullItems: Array<PullItem>): Array<PullItem>\n\t{\n\t\treturn pullItems.filter((item: PullItem) => {\n\t\t\tconst { data: { action } } = item;\n\n\t\t\treturn Object.keys(this.#delayedPullFlowHandlers).includes(action);\n\t\t});\n\t}\n\n\t#identifyTaskItems(pullItems: Array<PullItem>): Array<PullItem>\n\t{\n\t\treturn pullItems.filter((item: PullItem) => {\n\t\t\tconst { data: { action } } = item;\n\n\t\t\treturn Object.keys(this.#delayedPullTasksHandlers).includes(action);\n\t\t});\n\t}\n\n\t#convertTaskItems(pullItems: Array<PullItem>, mapIds: {}): Array<PullItem>\n\t{\n\t\tconst tasksItems = [];\n\n\t\t// Replace the task id with the flow id.\n\t\tpullItems.forEach((item: PullItem) => {\n\t\t\tconst { data: { id } } = item;\n\t\t\tif (id in mapIds)\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-param-reassign,unicorn/consistent-destructuring\n\t\t\t\titem.data.id = mapIds[id];\n\t\t\t\ttasksItems.push(item);\n\t\t\t}\n\t\t});\n\n\t\treturn tasksItems;\n\t}\n\n\t#uniqueItems(items: Array<PullItem>): Array<PullItem>\n\t{\n\t\tconst uniqueItems = items.reduce((accumulator, currentItem) => {\n\t\t\tif (!accumulator[currentItem.data.id])\n\t\t\t{\n\t\t\t\taccumulator[currentItem.data.id] = currentItem;\n\t\t\t}\n\n\t\t\treturn accumulator;\n\t\t}, {});\n\n\t\treturn Object.values(uniqueItems);\n\t}\n\n\t#findTaskAddAction(pullItems: Array<PullItem>): ?PullItem\n\t{\n\t\treturn pullItems.find((item: PullItem) => item.data.action === 'task_add');\n\t}\n\n\t#findTaskRemoveAction(pullItems: Array<PullItem>): ?PullItem\n\t{\n\t\treturn pullItems.find((item: PullItem) => item.data.action === 'task_remove');\n\t}\n\n\t#addTaskRemoveItemToMap(pullItem: PullItem, mapIds: {}): {}\n\t{\n\t\t// eslint-disable-next-line no-param-reassign\n\t\tmapIds[pullItem.data.id] = pullItem.data.actionParams?.FLOW_ID;\n\n\t\treturn mapIds;\n\t}\n\n\t#isCurrentUserCreatorOfTheTask(pullItem: PullItem): boolean\n\t{\n\t\tconst createdBy = pullItem.data.actionParams?.AFTER?.CREATED_BY;\n\n\t\treturn parseInt(createdBy, 10) === parseInt(this.#params.currentUserId, 10);\n\t}\n\n\t#showAhaOnMyTasksColumn(rowId: number)\n\t{\n\t\tconst bindElement = this.#getBindElementForAhaOnCell(\n\t\t\trowId,\n\t\t\t'MY_TASKS',\n\t\t\t'.tasks-flow__list-my-tasks span',\n\t\t);\n\n\t\tif (bindElement)\n\t\t{\n\t\t\tthis.#clueMyTasks = new Clue({\n\t\t\t\tid: `my_tasks_${this.#params.currentUserId}`,\n\t\t\t\tautoSave: true,\n\t\t\t});\n\n\t\t\tthis.#clueMyTasks.show(Clue.SPOT.MY_TASKS, bindElement);\n\n\t\t\tthis.#params.isAhaShownOnMyTasksColumn = true;\n\t\t}\n\t}\n\n\t#showAhaCopilotAdvice(): void\n\t{\n\t\tif (this.#params.isAhaShownCopilotAdvice)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst firstRow: ?BX.Grid.Row = this.#grid.getRows().getBodyChild()[0];\n\n\t\tif (!firstRow)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst bindElement = this.#getBindElementForAhaOnCell(\n\t\t\tfirstRow.getId(),\n\t\t\t'EFFICIENCY',\n\t\t\t'.tasks-flow__efficiency-copilot-icon-wrapper',\n\t\t);\n\n\t\tif (bindElement)\n\t\t{\n\t\t\tthis.#clueCopilotAdvice = new Clue({\n\t\t\t\tid: 'flow_copilot_advice',\n\t\t\t\tautoSave: true,\n\t\t\t});\n\n\t\t\tthis.#clueCopilotAdvice.show(Clue.SPOT.FLOW_COPILOT_ADVICE, bindElement);\n\n\t\t\tthis.#params.isAhaShownCopilotAdvice = true;\n\t\t}\n\t}\n\n\t#getBindElementForAhaOnCell(rowId: number, columnId: string, selector: string): ?HTMLElement\n\t{\n\t\treturn this.#getCell(rowId, columnId)?.querySelector(selector);\n\t}\n\n\t#consoleError(action: string, error: AjaxError)\n\t{\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error(`BX.Tasks.Flow.Grid: ${action} error`, error);\n\t}\n\n\t#clearAnalyticsParams(): void\n\t{\n\t\tconst uri = new Uri(window.location.href);\n\n\t\tconst section = uri.getQueryParam('ta_sec');\n\t\tif (section)\n\t\t{\n\t\t\turi.removeQueryParam('ta_cat', 'ta_sec', 'ta_sub', 'ta_el', 'p1', 'p2', 'p3', 'p4', 'p5');\n\n\t\t\twindow.history.replaceState(null, null, uri.toString());\n\t\t}\n\t}\n\n\t#activateHint(): void\n\t{\n\t\tBX.UI.Hint.init(this.#grid.getContainer());\n\t}\n\n\t#highlightAddedFlow(): void\n\t{\n\t\tif (this.#addedFlowId !== null && this.#isRowExist(this.#addedFlowId))\n\t\t{\n\t\t\tthis.#highlightRow(this.#addedFlowId);\n\n\t\t\tthis.#addedFlowId = null;\n\t\t}\n\t}\n\n\t#showFlowCreationWizard(): void\n\t{\n\t\tconst uri = new Uri(window.location.href);\n\n\t\tconst demoFlowId = uri.getQueryParam('demo_flow');\n\t\tif (demoFlowId)\n\t\t{\n\t\t\turi.removeQueryParam('demo_flow');\n\n\t\t\twindow.history.replaceState(null, null, uri.toString());\n\n\t\t\tEditForm.createInstance({ flowId: demoFlowId, demoFlow: 'Y' });\n\t\t}\n\n\t\tconst createFlow = uri.getQueryParam('create_flow');\n\t\tif (createFlow)\n\t\t{\n\t\t\turi.removeQueryParam('create_flow');\n\n\t\t\twindow.history.replaceState(null, null, uri.toString());\n\n\t\t\tEditForm.createInstance({ guideFlow: 'Y' });\n\t\t}\n\t}\n\n\t#colorPinnedRows()\n\t{\n\t\tconst rows = this.#grid.getRows().getRows();\n\t\trows.forEach((row) => {\n\t\t\tconst node = row.getNode();\n\n\t\t\tif (this.#isPinned(node))\n\t\t\t{\n\t\t\t\tDom.addClass(node, 'tasks-flow_list_row_pinned');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(node, 'tasks-flow_list_row_pinned');\n\t\t\t}\n\t\t});\n\t}\n\n\t#isPinned(node): boolean\n\t{\n\t\treturn Type.isDomNode(\n\t\t\tnode.querySelector('.main-grid-cell-content-action-pin.main-grid-cell-content-action-active'),\n\t\t);\n\t}\n}\n","import { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Type, Dom } from 'main.core';\n\ntype Props = {\n\tfilterId: string,\n};\n\nexport class Filter\n{\n\t#props: Props;\n\t#filter: BX.Main.Filter;\n\t#MIN_QUERY_LENGTH = 3;\n\t#fields: any;\n\n\tconstructor(props: Props)\n\t{\n\t\tthis.#props = props;\n\t\tthis.#init();\n\t}\n\n\t#init()\n\t{\n\t\tthis.#filter = BX.Main.filterManager.getById(this.#props.filterId);\n\t\tthis.#updateFields();\n\t\tthis.#subscribeToEvents();\n\t}\n\n\t#updateFields()\n\t{\n\t\tthis.#fields = this.#filter.getFilterFieldsValues();\n\t}\n\n\t#unSubscribeToEvents()\n\t{\n\t\tEventEmitter.unsubscribe('BX.Filter.Search:input', this.#inputFilterHandler.bind(this));\n\t\tEventEmitter.unsubscribe('BX.Main.Filter:apply', this.#applyFilterHandler.bind(this));\n\t\tEventEmitter.unsubscribe('Tasks.Toolbar:onItem', this.#counterClickHandler.bind(this));\n\t}\n\n\t#subscribeToEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Filter.Search:input', this.#inputFilterHandler.bind(this));\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.#applyFilterHandler.bind(this));\n\t\tEventEmitter.subscribe('Tasks.Toolbar:onItem', this.#counterClickHandler.bind(this));\n\t}\n\n\t#inputFilterHandler()\n\t{\n\t\tthis.#setActive(this.isFilterActive());\n\t}\n\n\t#applyFilterHandler()\n\t{\n\t\tthis.#updateFields();\n\t}\n\n\t#counterClickHandler(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\n\t\tif (data.counter && data.counter.filter)\n\t\t{\n\t\t\tthis.#toggleByField({ [data.counter.filterField]: data.counter.filterValue });\n\t\t}\n\t}\n\n\thasFilteredFields()\n\t{\n\t\tconst filteredFields = this.#filter.getFilterFieldsValues();\n\t\tconst fields = Object.values(filteredFields);\n\t\tfor (const field of fields)\n\t\t{\n\t\t\tif (this.isArrayFieldFiller(field) || this.isStringFieldFilled(field))\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tisFilterActive()\n\t{\n\t\tconst isPresetApplied = !['default_filter', 'tmp_filter'].includes(this.#filter.getPreset().getCurrentPresetId());\n\t\tconst isSearchFilled = !this.isSearchEmpty();\n\t\tconst hasFilledFields = this.hasFilteredFields();\n\n\t\treturn isPresetApplied || isSearchFilled || hasFilledFields;\n\t}\n\n\tisArrayFieldFiller(field)\n\t{\n\t\treturn Type.isArrayFilled(field);\n\t}\n\n\tisStringFieldFilled(field)\n\t{\n\t\treturn field !== 'NONE' && Type.isStringFilled(field);\n\t}\n\n\tisSearchEmpty()\n\t{\n\t\tconst query = this.#filter.getSearch().getSearchString();\n\n\t\treturn !query || query.length < this.#MIN_QUERY_LENGTH;\n\t}\n\n\t#toggleByField(field)\n\t{\n\t\tconst name = Object.keys(field)[0];\n\t\tconst value = field[name];\n\n\t\tif (!this.#isFilteredByFieldValue(name, value))\n\t\t{\n\t\t\tthis.#filter.getApi().extendFilter({ [name]: value });\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#filter.getFilterFields().forEach((field) => {\n\t\t\tif (field.getAttribute('data-name') === name)\n\t\t\t{\n\t\t\t\tthis.#filter.getFields().deleteField(field);\n\t\t\t}\n\t\t});\n\n\t\tthis.#filter.getSearch().apply();\n\t}\n\n\t#isFilteredByFieldValue(field, value)\n\t{\n\t\treturn this.#isFilteredByField(field) && this.#fields[field] === value;\n\t}\n\n\t#isFilteredByField(field)\n\t{\n\t\tif (!Object.keys(this.#fields).includes(field))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Type.isArray(this.#fields[field]))\n\t\t{\n\t\t\treturn this.#fields[field].length > 0;\n\t\t}\n\n\t\treturn this.#fields[field] !== '';\n\t}\n\n\t#setActive(isActive)\n\t{\n\t\tconst wrap = this.#filter.popupBindElement;\n\n\t\tif (isActive)\n\t\t{\n\t\t\tDom.removeClass(wrap, 'main-ui-filter-default-applied');\n\t\t\tDom.addClass(wrap, 'main-ui-filter-search--showed');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(wrap, 'main-ui-filter-default-applied');\n\t\t\tDom.removeClass(wrap, 'main-ui-filter-search--showed');\n\t\t}\n\t}\n}","import { MenuManager } from 'main.popup';\nimport { SidePanel } from 'main.sidepanel';\nimport type { MenuItemOptions } from 'main.popup';\n\nexport type Data = {\n\tdashboards: JSON,\n\ttarget: HTMLElement,\n\tflowId: number,\n}\n\nexport type Dashboard = {\n\tid: string,\n\ttitle: string,\n\turl: string,\n}\n\nexport class BIAnalytics\n{\n\t#id: string;\n\t#flowId: number;\n\t#dashboards: Dashboard[];\n\t#target: HTMLElement;\n\n\tconstructor(data: Data)\n\t{\n\t\tthis.#dashboards = Object.values(data.dashboards);\n\t\tthis.#target = data.target;\n\t\tthis.#flowId = Number(data.flowId);\n\n\t\tthis.#id = `tasks-flow-bi-analytics-menu_${this.#flowId}`;\n\t}\n\n\tstatic create(data: Data): BIAnalytics\n\t{\n\t\treturn new BIAnalytics(data);\n\t}\n\n\topenMenu(): void\n\t{\n\t\tconst popupMenu = MenuManager.create({\n\t\t\tid: this.#id,\n\t\t\tbindElement: this.#target,\n\t\t\titems: this.#getMenuItems(),\n\t\t\tcacheable: false,\n\t\t});\n\n\t\tpopupMenu.show();\n\t}\n\n\topenFirstDashboard(): void\n\t{\n\t\tconst dashboard = this.#dashboards[0];\n\n\t\tif (dashboard)\n\t\t{\n\t\t\tSidePanel.Instance.open(dashboard.url);\n\t\t}\n\t}\n\n\t#getMenuItems(): MenuItemOptions[]\n\t{\n\t\tconst menuItems = [];\n\n\t\tthis.#dashboards.forEach((dashboard: Dashboard) => {\n\t\t\tmenuItems.push({\n\t\t\t\ttabId: dashboard.id,\n\t\t\t\ttext: dashboard.title,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tSidePanel.Instance.open(dashboard.url);\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\treturn menuItems;\n\t}\n}\n","import { Event, Loc, Tag } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { CopilotAdvice } from 'tasks.flow.copilot-advice';\n\nexport class NotEnoughTasksPopup\n{\n\tstatic show(bindElement: HTMLElement): void\n\t{\n\t\tconst { root: popupContent, exampleLink } = Tag.render`\n\t\t\t<div class=\"tasks-flow__not-enough-tasks-popup\">\n\t\t\t\t<div class=\"tasks-flow__not-enough-tasks-popup-title\">\n\t\t\t\t\t<span class=\"tasks-flow__not-enough-tasks-popup-icon ui-icon-set --copilot-ai\"/>\n\t\t\t\t\t<span class=\"tasks-flow__not-enough-tasks-popup-title-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_LIST_COPILOT_NOT_ENOUGH_TASKS_POPUP_TITLE')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-flow__not-enough-tasks-popup-description\">\n\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_LIST_COPILOT_NOT_ENOUGH_TASKS_POPUP_DESCRIPTION')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-flow__not-enough-tasks-popup-example\">\n\t\t\t\t\t<span class=\"tasks-flow__not-enough-tasks-popup-example-text\" ref=\"exampleLink\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_LIST_COPILOT_NOT_ENOUGH_TASKS_POPUP_SHOW_EXAMPLE')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst popup = new Popup({\n\t\t\tbindElement,\n\t\t\tcontent: popupContent,\n\t\t\tcacheable: false,\n\t\t\tautoHide: true,\n\t\t\tminWidth: 270,\n\t\t\twidth: 270,\n\t\t\tpadding: 12,\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t\toffset: 30,\n\t\t\t},\n\t\t});\n\n\t\tEvent.bind(exampleLink, 'click', () => {\n\t\t\tCopilotAdvice.showExample();\n\t\t\tpopup?.close();\n\t\t});\n\n\t\tpopup.show();\n\t}\n}\n"],"names":["QueueAnimationHelper","constructor","rowId","changeAvatarsToEmpty","nodes","promises","map","node","Promise","resolve","Dom","addClass","Event","bindOnce","style","append","requestAnimationFrame","all","showAvatars","removeClass","hideAvatars","renderHiddenEmptyAvatar","Tag","render","renderHiddenAvatar","user","extraClass","photo","encodeURI","src","uiClasses","changeAvatarsToUser","users","reject","forEach","index","clean","changeAvatarToCounter","count","memberClass","parseInt","changeNodeAttributes","statusId","state","isEmpty","wrapper","querySelector","label","list","attr","total","subsequence","join","Loc","getMessage","setAttribute","blinkAvatar","removeClassesWithoutAnimation","classes","offsetHeight","defineSubsequenceIndices","currentSubsequence","newSubsequence","iteratedSequence","length","comparedSequence","reduce","result","value","includes","presentIndices","push","absentIndices","text","textContent","Text","encode","QueueState","animate","children","number","childElementCount","variantHandlers","animateFromStateWithOneElement","bind","animateFromStateWithTwoElement","animateFromStateWithThreeElement","animateFromStateWithCounter","default","skipAnimation","animateFrom","EmptyState","animationHelper","console","log","currentAvatar","lastElementChild","prepend","then","firstAvatar","lastAvatar","newEmptyAvatar","avatars","avatar","SingleState","newFirstAvatar","remove","middleAvatar","DoubleState","dataset","split","Number","removeAbsentAvatars","absentAvatars","absentAvatar","variantMovements","presentSubsequence","variantMovement","absentIndex","TripleState","CounterState","maxVisibleNumberAvatars","visibleAmount","invisibleAmount","Math","min","newMiddleAvatar","QueueAnimationManager","animationInfo","animationStates","processStatusAnimation","newStateOfStatuses","animationState","linkToNodes","get","linkToQueueData","setTimeout","QueueAnimation","grid","data","FLOW_ID","start","catch","Map","currentStateOfStatuses","set","status","queue","addToList","newStatus","id","oldStatus","listNode","labelNode","trim","queueSubsequence","date","getRows","getById","columnId","getCellById","sequence","regex","test","first","second","i","key","has","delete","keys","Grid","params","Set","BX","Main","gridManager","gridId","instance","comment_read_all","flow_add","flow_delete","flow_update","comment_add","task_add","task_update","task_view","task_remove","activateFlow","flowId","ajax","runAction","pinFlow","skipNotify","response","code","UI","Notification","Center","notify","content","actions","title","events","click","event","baloon","close","removeFlow","message","MessageBox","buttons","MessageBoxButtons","OK_CANCEL","okCaption","popupOptions","onOk","onCancel","show","showTeam","bindElement","TeamPopup","showInstance","showTaskQueue","type","TaskQueue","showFlowLimit","FeaturePromotersRegistry","getPromoter","flowLimitCode","showNotificationHint","notificationId","textHint","width","add","EventEmitter","subscribeOnce","baseEvent","closingBalloon","getTarget","getId","showGuide","demoSuffix","Manual","manualCode","urlParams","utm_source","utm_medium","analytics","tool","category","c_section","c_sub_section","c_element","p1","reload","currentUrl","action","updateRow","currentPage","getCurrentPage","removeRow","inputRow","firstRow","getNode","insertBefore","rowNode","row","rows","getBodyChild","find","QueueManager","moduleId","userId","currentUserId","config","loadItemsDelay","additionalData","onBeforePull","onPull","callbacks","onBeforeQueueExecute","items","onQueueExecute","onReload","subscribe","pullData","command","apply","Object","actionParams","taskId","flowItems","taskItems","mapIds","taskRemoveItem","convertedTaskItems","taskAddItem","allItems","processItemAnimation","item","taskIds","runComponentAction","mode","Type","isArray","error","handlers","isShown","adjustPosition","isAhaShownOnMyTasksColumn","TASK_ID","entityXmlId","indexOf","slice","pullItems","entityIds","filter","tasksItems","uniqueItems","accumulator","currentItem","values","pullItem","createdBy","AFTER","CREATED_BY","Clue","autoSave","SPOT","MY_TASKS","isAhaShownCopilotAdvice","FLOW_COPILOT_ADVICE","selector","uri","Uri","window","location","href","section","getQueryParam","removeQueryParam","history","replaceState","toString","Hint","init","getContainer","demoFlowId","EditForm","createInstance","demoFlow","createFlow","guideFlow","isDomNode","Filter","props","hasFilteredFields","filteredFields","getFilterFieldsValues","fields","field","isArrayFieldFiller","isStringFieldFilled","isFilterActive","isPresetApplied","getPreset","getCurrentPresetId","isSearchFilled","isSearchEmpty","hasFilledFields","isArrayFilled","isStringFilled","query","getSearch","getSearchString","filterManager","filterId","unsubscribe","getData","counter","filterField","filterValue","name","getApi","extendFilter","getFilterFields","getAttribute","getFields","deleteField","isActive","wrap","popupBindElement","BIAnalytics","dashboards","target","create","openMenu","popupMenu","MenuManager","cacheable","openFirstDashboard","dashboard","SidePanel","Instance","open","url","menuItems","tabId","onclick","NotEnoughTasksPopup","root","popupContent","exampleLink","popup","Popup","autoHide","minWidth","padding","angle","position","offset","CopilotAdvice","showExample"],"mappings":"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"}