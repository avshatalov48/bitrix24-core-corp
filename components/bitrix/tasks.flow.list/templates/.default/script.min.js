this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,s,a,t,l,i,r,o,n,c,d,b,v,p,u){"use strict";let h=e=>e,P,F,L,m,H,f,y;var B=babelHelpers.classPrivateFieldLooseKey("rowId");var w=babelHelpers.classPrivateFieldLooseKey("changeLabel");var g=babelHelpers.classPrivateFieldLooseKey("renderPersonNode");class O{constructor(e){Object.defineProperty(this,g,{value:T});Object.defineProperty(this,w,{value:_});Object.defineProperty(this,B,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,B)[B]=e}changeAvatarsToEmpty(e){const s=e.map((e=>new Promise((s=>{v.Dom.addClass(e,"--icon");v.Event.bindOnce(e,"transitionend",(()=>{v.Dom.style(e,null);v.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,g)[g](),e);requestAnimationFrame((()=>{s()}))}))}))));return Promise.all(s)}async showAvatars(e){const s=e.map((e=>new Promise((s=>{v.Dom.removeClass(e,"--hidden");v.Event.bindOnce(e,"transitionend",(()=>{s()}))}))));return Promise.all(s)}async hideAvatars(e){const s=e.map((e=>new Promise((s=>{v.Dom.addClass(e,"--hidden");v.Event.bindOnce(e,"transitionend",(()=>{s(e)}))}))));return Promise.all(s)}renderHiddenEmptyAvatar(){return v.Tag.render(P||(P=h`
			<div class="tasks-flow__list-members-icon_element --icon --hidden --center">
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,g)[g]())}renderHiddenAvatar(e,s=""){if("src"in e.photo){return v.Tag.render(F||(F=h`
				<div
					class="tasks-flow__list-members-icon_element --hidden ${0}"
					style="background-image: url('${0}')"
				></div>
			`),s,encodeURI(e.photo.src))}const a="ui-icon ui-icon-common-user ui-icon-xs";return v.Tag.render(L||(L=h`
			<div
				class="tasks-flow__list-members-icon_element ${0} --hidden ${0}"
			>
				<i></i>
			</div>
		`),a,s)}async changeAvatarsToUser(e,s){return new Promise(((a,t)=>{e.forEach(((e,a)=>{const t=s[a];v.Dom.removeClass(e,["--icon","--count","--at-work"]);v.Dom.clean(e);if("src"in t.photo){v.Dom.style(e,"background-image",`url('${encodeURI(t.photo.src)}')`)}else{v.Dom.addClass(e,["ui-icon","ui-icon-common-user","ui-icon-xs"]);v.Dom.append(v.Tag.render(m||(m=h`<i></i>`)),e)}}));requestAnimationFrame((()=>{a()}))}))}changeAvatarToCounter(e,s,a=""){return new Promise(((t,l)=>{v.Dom.removeClass(e,["ui-icon","ui-icon-common-user","ui-icon-xs"]);v.Dom.addClass(e,["--count",a]);v.Dom.clean(e);v.Dom.style(e,null);v.Dom.append(v.Tag.render(H||(H=h`
				<span class="tasks-flow__warning-icon_element-plus">+</span>
			`)),e);v.Dom.append(v.Tag.render(f||(f=h`
				<span class="tasks-flow__warning-icon_element-number">${0}</span>
			`),parseInt(s,10)),e);requestAnimationFrame((()=>{t()}))}))}changeNodeAttributes(e,s,a,t){const l=s.querySelector(".tasks-flow__list-members_wrapper");const i=s.querySelector(".tasks-flow__list-members_info");const r=s.querySelector(".tasks-flow__list-members");v.Dom.attr(r,"data-total",a.total);v.Dom.attr(r,"data-subsequence",a.subsequence.join(","));if(t){v.Dom.removeClass(l,"--link");v.Dom.attr(l,"onclick",null);babelHelpers.classPrivateFieldLooseBase(this,w)[w](i,v.Loc.getMessage("TASKS_FLOW_LIST_NO_TASKS"),true)}else{v.Dom.addClass(l,"--link");l.setAttribute("onclick",`BX.Tasks.Flow.Grid.showTaskQueue('${babelHelpers.classPrivateFieldLooseBase(this,B)[B]}', '${e}', this)`);babelHelpers.classPrivateFieldLooseBase(this,w)[w](i,a.label)}}blinkAvatar(e){return new Promise((s=>{v.Event.bindOnce(e,"animationend",(()=>{v.Dom.removeClass(e,["--blink"]);s()}));v.Dom.addClass(e,["--blink"])}))}removeClassesWithoutAnimation(e,s){v.Dom.style(e,"transition","none");v.Dom.removeClass(e,s);e.offsetHeight;v.Dom.style(e,"transition","")}defineSubsequenceIndices(e,s){const a=e.length>=s.length?e:s;const t=e.length>=s.length?s:e;return a.reduce(((e,s,a)=>{if(t.includes(s)){e.presentIndices.push(a)}else{e.absentIndices.push(a)}return e}),{presentIndices:[],absentIndices:[]})}}function _(e,s,a=false){e.textContent=v.Text.encode(s);if(a){v.Dom.removeClass(e,"--link")}else{v.Dom.addClass(e,"--link")}}function T(){return v.Tag.render(y||(y=h`
			<div
				class="ui-icon-set --person"
				style="--ui-icon-set__icon-color: var(--ui-color-base-50);"
			></div>
		`))}class K{animate(e,s,a,t){const l=e.querySelector(".tasks-flow__list-members");const i=l.children;const r=l.childElementCount;const o={1:this.animateFromStateWithOneElement.bind(this,l,i,s,a),2:this.animateFromStateWithTwoElement.bind(this,l,i,s,a),3:this.animateFromStateWithThreeElement.bind(this,l,i,s,a),4:this.animateFromStateWithCounter.bind(this,l,i,s,a),default:this.skipAnimation.bind(this)};const n=o[r]||o.default;return n()}async animateFromStateWithOneElement(e,s,a,t){return Promise.resolve()}async animateFromStateWithTwoElement(e,s,a,t){return Promise.resolve()}async animateFromStateWithThreeElement(e,s,a,t){return Promise.resolve()}async animateFromStateWithCounter(e,s,a,t){return Promise.resolve()}skipAnimation(){return Promise.resolve()}}var S=babelHelpers.classPrivateFieldLooseKey("animationHelper");var A=babelHelpers.classPrivateFieldLooseKey("moveAvatarsToCenter");var C=babelHelpers.classPrivateFieldLooseKey("moveAvatarsToDefaultPosition");class k extends K{constructor(e){super(e);Object.defineProperty(this,C,{value:j});Object.defineProperty(this,A,{value:E});Object.defineProperty(this,S,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,S)[S]=e}async animateFromStateWithOneElement(e,s,a,t){console.log("EmptyState");const l=e.lastElementChild;v.Dom.prepend(babelHelpers.classPrivateFieldLooseBase(this,S)[S].renderHiddenEmptyAvatar(),e);v.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,S)[S].renderHiddenEmptyAvatar(),e);return new Promise((e=>{requestAnimationFrame((()=>{babelHelpers.classPrivateFieldLooseBase(this,A)[A]([...s]);babelHelpers.classPrivateFieldLooseBase(this,S)[S].changeAvatarsToEmpty([l]).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,C)[C]([...s]);e()}))}))}))}async animateFromStateWithTwoElement(e,s,a,t){const l=s[0];const i=s[2];const r=babelHelpers.classPrivateFieldLooseBase(this,S)[S].renderHiddenEmptyAvatar();v.Dom.prepend(r,e);return requestAnimationFrame((()=>{babelHelpers.classPrivateFieldLooseBase(this,A)[A]([...s]);return babelHelpers.classPrivateFieldLooseBase(this,S)[S].changeAvatarsToEmpty([l,i]).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,C)[C]([...s])}))}))}async animateFromStateWithThreeElement(e,s,a,t){babelHelpers.classPrivateFieldLooseBase(this,A)[A]([...s]);return babelHelpers.classPrivateFieldLooseBase(this,S)[S].changeAvatarsToEmpty([...s]).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,C)[C]([...s])}))}}function E(e){e.forEach((e=>{v.Dom.addClass(e,"--center")}))}function j(e){e.forEach((e=>{v.Dom.removeClass(e,["--center","--hidden"])}))}var I=babelHelpers.classPrivateFieldLooseKey("animationHelper");class D extends K{constructor(e){super(e);Object.defineProperty(this,I,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,I)[I]=e}async animateFromStateWithOneElement(e,s,a,t){const l=s[0];return babelHelpers.classPrivateFieldLooseBase(this,I)[I].changeAvatarsToUser([l],a).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,I)[I].blinkAvatar(l)}))}async animateFromStateWithTwoElement(e,s,a,t){const l=s[0];const i=s[1];const r=babelHelpers.classPrivateFieldLooseBase(this,I)[I].renderHiddenAvatar(a[0],"--invisible");v.Dom.prepend(r,e);return new Promise(((e,s)=>{v.Event.bindOnce(i,"transitionend",(()=>{v.Dom.remove(l);v.Dom.remove(i);v.Event.bindOnce(r,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,I)[I].blinkAvatar(r);e()}));v.Dom.removeClass(r,["--hidden","--invisible"])}));v.Dom.addClass(l,"--tiny-right");v.Dom.addClass(l,"--hidden");v.Dom.addClass(i,"--tiny-left");v.Dom.addClass(i,"--hidden")}))}async animateFromStateWithThreeElement(e,s,a,t){const l=s[0];const i=s[1];const r=s[2];v.Dom.addClass(l,["--center"]);v.Dom.addClass(r,["--center"]);return babelHelpers.classPrivateFieldLooseBase(this,I)[I].changeAvatarsToUser([i],a).then((()=>{v.Event.bindOnce(r,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,I)[I].blinkAvatar(i);v.Dom.remove(l);v.Dom.remove(r)}));v.Dom.addClass(r,"--hidden")}))}}var W=babelHelpers.classPrivateFieldLooseKey("animationHelper");class M extends K{constructor(e){super(e);Object.defineProperty(this,W,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,W)[W]=e}animateFromStateWithOneElement(e,s,a,t){return new Promise((t=>{const l=s[0];const i=babelHelpers.classPrivateFieldLooseBase(this,W)[W].renderHiddenAvatar(a[0],"--start-invisible");v.Dom.prepend(i,e);requestAnimationFrame((()=>{v.Event.bindOnce(l,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W].blinkAvatar(i).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(i,["--start-invisible","--tiny-left"]);babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(l,["--tiny-right"]);t()}))}));v.Dom.removeClass(i,["--hidden"]);v.Dom.addClass(i,["--tiny-left"]);v.Dom.addClass(l,["--tiny-right"])}))}))}async animateFromStateWithTwoElement(e,s,a,t){return babelHelpers.classPrivateFieldLooseBase(this,W)[W].changeAvatarsToUser([...s],a)}async animateFromStateWithThreeElement(e,s,a,t){const l=e.dataset.subsequence.split(",").map(Number);const i=t.subsequence;const{presentIndices:r,absentIndices:o}=babelHelpers.classPrivateFieldLooseBase(this,W)[W].defineSubsequenceIndices(l,i);const n=(e,s)=>babelHelpers.classPrivateFieldLooseBase(this,W)[W].hideAvatars(e).then((()=>{e.forEach((e=>{v.Dom.remove(e)}));s()}));const c={"1,2":e=>new Promise((a=>{const t=s[1];const l=s[2];v.Event.bindOnce(l,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(t,["--tiny-left"]);babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(l,["--tiny-left"])}));v.Dom.addClass(t,"--tiny-left");v.Dom.addClass(l,"--tiny-left");n(e,a)})),"0,1":e=>new Promise((a=>{const t=s[0];const l=s[1];v.Event.bindOnce(t,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(l,["--tiny-right"]);babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(t,["--tiny-right"])}));v.Dom.addClass(l,"--tiny-right");v.Dom.addClass(t,"--tiny-right");n(e,a)})),"0,2":e=>new Promise((a=>{const t=s[0];const l=s[2];v.Event.bindOnce(l,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(t,["--tiny-right"]);babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(l,["--tiny-left"])}));v.Dom.addClass(t,"--tiny-right");v.Dom.addClass(l,"--tiny-left");n(e,a)})),default:()=>Promise.resolve()};const d=r.join(",");const b=c[d]||c.default;const p=[];o.forEach((e=>{p.push(s[e])}));return b(p)}}var N=babelHelpers.classPrivateFieldLooseKey("animationHelper");class R extends K{constructor(e){super(e);Object.defineProperty(this,N,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,N)[N]=e}async animateFromStateWithTwoElement(e,s,a,t){return new Promise((t=>{const l=s[0];const i=s[1];const r=babelHelpers.classPrivateFieldLooseBase(this,N)[N].renderHiddenAvatar(a[0],"--start-invisible");v.Dom.prepend(r,e);requestAnimationFrame((()=>{v.Event.bindOnce(l,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,N)[N].blinkAvatar(r).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,N)[N].removeClassesWithoutAnimation(r,["--start-invisible","--tiny-left"]);babelHelpers.classPrivateFieldLooseBase(this,N)[N].removeClassesWithoutAnimation(l,["--tiny-right"]);babelHelpers.classPrivateFieldLooseBase(this,N)[N].removeClassesWithoutAnimation(i,["--tiny-right"]);t()}))}));v.Dom.removeClass(r,["--hidden"]);v.Dom.addClass(r,["--tiny-left"]);v.Dom.addClass(l,["--tiny-right"]);v.Dom.addClass(i,["--tiny-right"])}))}))}async animateFromStateWithThreeElement(e,s,a,t){return babelHelpers.classPrivateFieldLooseBase(this,N)[N].changeAvatarsToUser([...s],a)}async animateFromStateWithCounter(e,s,a,t){await babelHelpers.classPrivateFieldLooseBase(this,N)[N].hideAvatars([...s]);await babelHelpers.classPrivateFieldLooseBase(this,N)[N].changeAvatarsToUser([...s],a).then((()=>babelHelpers.classPrivateFieldLooseBase(this,N)[N].showAvatars([...s])));return Promise.resolve()}}var q=babelHelpers.classPrivateFieldLooseKey("animationHelper");var X=babelHelpers.classPrivateFieldLooseKey("counter");var U=babelHelpers.classPrivateFieldLooseKey("statusId");class x extends K{constructor(e){super(e);Object.defineProperty(this,q,{writable:true,value:void 0});Object.defineProperty(this,X,{writable:true,value:void 0});Object.defineProperty(this,U,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,q)[q]=e}animate(e,s,a,t){const l=99;const i=2;const r=a.total-i;babelHelpers.classPrivateFieldLooseBase(this,X)[X]=Math.min(r,l);babelHelpers.classPrivateFieldLooseBase(this,U)[U]=t;return super.animate(e,s,a,t)}async animateFromStateWithThreeElement(e,s,a,t){const l=s[0];const i=s[1];const r=s[2];const o=babelHelpers.classPrivateFieldLooseBase(this,q)[q].renderHiddenAvatar(a[0],"--invisible");const n=babelHelpers.classPrivateFieldLooseBase(this,q)[q].renderHiddenAvatar(a[1],"--invisible");v.Dom.prepend(n,e);v.Dom.prepend(o,e);v.Event.bindOnce(l,"transitionend",(()=>{v.Dom.remove(l);v.Dom.removeClass(o,["--invisible"])}));v.Event.bindOnce(i,"transitionend",(()=>{v.Dom.remove(i);v.Dom.removeClass(n,["--invisible"])}));v.Dom.removeClass(o,["--hidden"]);v.Dom.removeClass(n,["--hidden"]);v.Dom.addClass(l,["--right"]);v.Dom.addClass(i,["--right"]);const c=babelHelpers.classPrivateFieldLooseBase(this,U)[U]==="AT_WORK"?"--at-work":"";return babelHelpers.classPrivateFieldLooseBase(this,q)[q].changeAvatarToCounter(r,babelHelpers.classPrivateFieldLooseBase(this,X)[X],c).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,q)[q].blinkAvatar(r)}))}}var Q=babelHelpers.classPrivateFieldLooseKey("animationHelper");class ${constructor(e){Object.defineProperty(this,Q,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]=new O(e)}async animate(e){const s={0:new k(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]),1:new D(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]),2:new M(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]),3:new R(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]),default:new x(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q])};const a=async a=>{for(const[t,l]of a){const a=s[l.total]||s.default;const i=e.linkToNodes.get(t);const r=e.linkToQueueData.get(t);await a.animate(i,r,l,t).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,Q)[Q].changeNodeAttributes(t,i,l,l.total===0)}))}};await a(e.newStateOfStatuses);return new Promise((e=>setTimeout(e,500)))}}var G=babelHelpers.classPrivateFieldLooseKey("grid");var V=babelHelpers.classPrivateFieldLooseKey("data");var Y=babelHelpers.classPrivateFieldLooseKey("rowId");var z=babelHelpers.classPrivateFieldLooseKey("animationManager");var J=babelHelpers.classPrivateFieldLooseKey("prepareData");var Z=babelHelpers.classPrivateFieldLooseKey("getNodes");var ee=babelHelpers.classPrivateFieldLooseKey("getNewStatuses");var se=babelHelpers.classPrivateFieldLooseKey("getCurrentState");var ae=babelHelpers.classPrivateFieldLooseKey("getNewState");var te=babelHelpers.classPrivateFieldLooseKey("getRow");var le=babelHelpers.classPrivateFieldLooseKey("getCell");var ie=babelHelpers.classPrivateFieldLooseKey("isValidSequence");var re=babelHelpers.classPrivateFieldLooseKey("statesAreEqual");var oe=babelHelpers.classPrivateFieldLooseKey("compareAndFilterStates");var ne=babelHelpers.classPrivateFieldLooseKey("removeDeletedKeys");class ce{constructor(e,s){Object.defineProperty(this,ne,{value:He});Object.defineProperty(this,oe,{value:me});Object.defineProperty(this,re,{value:Le});Object.defineProperty(this,ie,{value:Fe});Object.defineProperty(this,le,{value:Pe});Object.defineProperty(this,te,{value:he});Object.defineProperty(this,ae,{value:ue});Object.defineProperty(this,se,{value:pe});Object.defineProperty(this,ee,{value:ve});Object.defineProperty(this,Z,{value:be});Object.defineProperty(this,J,{value:de});Object.defineProperty(this,G,{writable:true,value:void 0});Object.defineProperty(this,V,{writable:true,value:void 0});Object.defineProperty(this,Y,{writable:true,value:void 0});Object.defineProperty(this,z,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,G)[G]=e;babelHelpers.classPrivateFieldLooseBase(this,V)[V]=s;babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]=parseInt(s.FLOW_ID,10);babelHelpers.classPrivateFieldLooseBase(this,z)[z]=new $(babelHelpers.classPrivateFieldLooseBase(this,Y)[Y])}start(){return new Promise(((e,s)=>{const a=babelHelpers.classPrivateFieldLooseBase(this,J)[J]();babelHelpers.classPrivateFieldLooseBase(this,z)[z].animate(a).then((()=>{e()})).catch((()=>{s()}))}))}}function de(){const e=new Map;const s=new Map;const a=new Map;const t=new Map;babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().forEach(((s,t)=>{e.set(t,s);a.set(t,babelHelpers.classPrivateFieldLooseBase(this,se)[se](s))}));babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]().forEach(((e,a)=>{s.set(a,e.queue);t.set(a,babelHelpers.classPrivateFieldLooseBase(this,ae)[ae](e))}));babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](a,t);babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](t,e,s);return{linkToNodes:e,linkToQueueData:s,currentStateOfStatuses:a,newStateOfStatuses:t}}function be(){const e=new Map;const s=s=>{e.set(s,babelHelpers.classPrivateFieldLooseBase(this,le)[le](s))};if("newStatus"in babelHelpers.classPrivateFieldLooseBase(this,V)[V]){s(babelHelpers.classPrivateFieldLooseBase(this,V)[V].newStatus.id)}if("oldStatus"in babelHelpers.classPrivateFieldLooseBase(this,V)[V]){s(babelHelpers.classPrivateFieldLooseBase(this,V)[V].oldStatus.id)}return e}function ve(){const e=new Map;const s=s=>{e.set(s.id,s)};if("newStatus"in babelHelpers.classPrivateFieldLooseBase(this,V)[V]){s(babelHelpers.classPrivateFieldLooseBase(this,V)[V].newStatus)}if("oldStatus"in babelHelpers.classPrivateFieldLooseBase(this,V)[V]){s(babelHelpers.classPrivateFieldLooseBase(this,V)[V].oldStatus)}return e}function pe(e){const s=e.querySelector(".tasks-flow__list-members");const a=e.querySelector(".tasks-flow__list-members_info");const t=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie](s.dataset.subsequence)?s.dataset.subsequence.split(",").map(Number):[];return{total:parseInt(s.dataset.total,10),subsequence:t,label:a.textContent.trim()}}function ue(e){return{total:parseInt(e.total,10),subsequence:e.queueSubsequence,label:e.date}}function he(){return babelHelpers.classPrivateFieldLooseBase(this,G)[G].getRows().getById(babelHelpers.classPrivateFieldLooseBase(this,Y)[Y])}function Pe(e){return babelHelpers.classPrivateFieldLooseBase(this,te)[te](babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]).getCellById(e)}function Fe(e){const s=/^\d+(,\d+)*$/;return s.test(e)}function Le(e,s){if(e.total!==s.total){return false}if(e.subsequence.length!==s.subsequence.length){return false}for(let a=0;a<e.subsequence.length;a++){if(e.subsequence[a]!==s.subsequence[a]){return false}}return true}function me(e,s){for(const[a,t]of e){if(s.has(a)&&babelHelpers.classPrivateFieldLooseBase(this,re)[re](t,s.get(a))){e.delete(a);s.delete(a)}}}function He(e,s,a){for(const a of s.keys()){if(!e.has(a)){s.delete(a)}}for(const s of a.keys()){if(!e.has(s)){a.delete(s)}}}var fe=babelHelpers.classPrivateFieldLooseKey("params");var ye=babelHelpers.classPrivateFieldLooseKey("grid");var Be=babelHelpers.classPrivateFieldLooseKey("instantPullHandlers");var we=babelHelpers.classPrivateFieldLooseKey("delayedPullFlowHandlers");var ge=babelHelpers.classPrivateFieldLooseKey("delayedPullTasksHandlers");var Oe=babelHelpers.classPrivateFieldLooseKey("clueMyTasks");var _e=babelHelpers.classPrivateFieldLooseKey("clueCopilotAdvice");var Te=babelHelpers.classPrivateFieldLooseKey("rowIdForMyTasksAhaMoment");var Ke=babelHelpers.classPrivateFieldLooseKey("notificationList");var Se=babelHelpers.classPrivateFieldLooseKey("addedFlowId");var Ae=babelHelpers.classPrivateFieldLooseKey("loadItemsDelay");var Ce=babelHelpers.classPrivateFieldLooseKey("reload");var ke=babelHelpers.classPrivateFieldLooseKey("updateRow");var Ee=babelHelpers.classPrivateFieldLooseKey("removeRow");var je=babelHelpers.classPrivateFieldLooseKey("moveRowToFirstPosition");var Ie=babelHelpers.classPrivateFieldLooseKey("highlightRow");var De=babelHelpers.classPrivateFieldLooseKey("isFirstRow");var We=babelHelpers.classPrivateFieldLooseKey("isRowExist");var Me=babelHelpers.classPrivateFieldLooseKey("isFirstPage");var Ne=babelHelpers.classPrivateFieldLooseKey("getRowById");var Re=babelHelpers.classPrivateFieldLooseKey("getFirstPinnedRow");var qe=babelHelpers.classPrivateFieldLooseKey("getFirstUnpinnedRow");var Xe=babelHelpers.classPrivateFieldLooseKey("getCell");var Ue=babelHelpers.classPrivateFieldLooseKey("subscribeToPull");var xe=babelHelpers.classPrivateFieldLooseKey("subscribeToGridEvents");var Qe=babelHelpers.classPrivateFieldLooseKey("onBeforePull");var $e=babelHelpers.classPrivateFieldLooseKey("onPull");var Ge=babelHelpers.classPrivateFieldLooseKey("onBeforeQueueExecute");var Ve=babelHelpers.classPrivateFieldLooseKey("onQueueExecute");var Ye=babelHelpers.classPrivateFieldLooseKey("executeQueueAnimation");var ze=babelHelpers.classPrivateFieldLooseKey("processItemAnimation");var Je=babelHelpers.classPrivateFieldLooseKey("getMapIds");var Ze=babelHelpers.classPrivateFieldLooseKey("onReload");var es=babelHelpers.classPrivateFieldLooseKey("executeQueue");var ss=babelHelpers.classPrivateFieldLooseKey("commentReadAll");var as=babelHelpers.classPrivateFieldLooseKey("onFlowAdd");var ts=babelHelpers.classPrivateFieldLooseKey("onFlowUpdate");var ls=babelHelpers.classPrivateFieldLooseKey("onFlowDelete");var is=babelHelpers.classPrivateFieldLooseKey("afterRowUpdated");var rs=babelHelpers.classPrivateFieldLooseKey("recognizeFlowId");var os=babelHelpers.classPrivateFieldLooseKey("recognizeTaskId");var ns=babelHelpers.classPrivateFieldLooseKey("getEntityIds");var cs=babelHelpers.classPrivateFieldLooseKey("identifyFlowItems");var ds=babelHelpers.classPrivateFieldLooseKey("identifyTaskItems");var bs=babelHelpers.classPrivateFieldLooseKey("convertTaskItems");var vs=babelHelpers.classPrivateFieldLooseKey("uniqueItems");var ps=babelHelpers.classPrivateFieldLooseKey("findTaskAddAction");var us=babelHelpers.classPrivateFieldLooseKey("findTaskRemoveAction");var hs=babelHelpers.classPrivateFieldLooseKey("addTaskRemoveItemToMap");var Ps=babelHelpers.classPrivateFieldLooseKey("isCurrentUserCreatorOfTheTask");var Fs=babelHelpers.classPrivateFieldLooseKey("showAhaOnMyTasksColumn");var Ls=babelHelpers.classPrivateFieldLooseKey("showAhaCopilotAdvice");var ms=babelHelpers.classPrivateFieldLooseKey("getBindElementForAhaOnCell");var Hs=babelHelpers.classPrivateFieldLooseKey("consoleError");var fs=babelHelpers.classPrivateFieldLooseKey("clearAnalyticsParams");var ys=babelHelpers.classPrivateFieldLooseKey("activateHint");var Bs=babelHelpers.classPrivateFieldLooseKey("highlightAddedFlow");var ws=babelHelpers.classPrivateFieldLooseKey("showFlowCreationWizard");var gs=babelHelpers.classPrivateFieldLooseKey("colorPinnedRows");var Os=babelHelpers.classPrivateFieldLooseKey("isPinned");class _s{constructor(e){Object.defineProperty(this,Os,{value:ya});Object.defineProperty(this,gs,{value:fa});Object.defineProperty(this,ws,{value:Ha});Object.defineProperty(this,Bs,{value:ma});Object.defineProperty(this,ys,{value:La});Object.defineProperty(this,fs,{value:Fa});Object.defineProperty(this,Hs,{value:Pa});Object.defineProperty(this,ms,{value:ha});Object.defineProperty(this,Ls,{value:ua});Object.defineProperty(this,Fs,{value:pa});Object.defineProperty(this,Ps,{value:va});Object.defineProperty(this,hs,{value:ba});Object.defineProperty(this,us,{value:da});Object.defineProperty(this,ps,{value:ca});Object.defineProperty(this,vs,{value:na});Object.defineProperty(this,bs,{value:oa});Object.defineProperty(this,ds,{value:ra});Object.defineProperty(this,cs,{value:ia});Object.defineProperty(this,ns,{value:la});Object.defineProperty(this,os,{value:ta});Object.defineProperty(this,rs,{value:aa});Object.defineProperty(this,is,{value:sa});Object.defineProperty(this,ls,{value:ea});Object.defineProperty(this,ts,{value:Zs});Object.defineProperty(this,as,{value:Js});Object.defineProperty(this,ss,{value:zs});Object.defineProperty(this,es,{value:Ys});Object.defineProperty(this,Ze,{value:Vs});Object.defineProperty(this,Je,{value:Gs});Object.defineProperty(this,ze,{value:$s});Object.defineProperty(this,Ye,{value:Qs});Object.defineProperty(this,Ve,{value:xs});Object.defineProperty(this,Ge,{value:Us});Object.defineProperty(this,$e,{value:Xs});Object.defineProperty(this,Qe,{value:qs});Object.defineProperty(this,xe,{value:Rs});Object.defineProperty(this,Ue,{value:Ns});Object.defineProperty(this,Xe,{value:Ms});Object.defineProperty(this,qe,{value:Ws});Object.defineProperty(this,Re,{value:Ds});Object.defineProperty(this,Ne,{value:Is});Object.defineProperty(this,Me,{value:js});Object.defineProperty(this,We,{value:Es});Object.defineProperty(this,De,{value:ks});Object.defineProperty(this,Ie,{value:Cs});Object.defineProperty(this,je,{value:As});Object.defineProperty(this,Ee,{value:Ss});Object.defineProperty(this,ke,{value:Ks});Object.defineProperty(this,Ce,{value:Ts});Object.defineProperty(this,fe,{writable:true,value:void 0});Object.defineProperty(this,ye,{writable:true,value:void 0});Object.defineProperty(this,Be,{writable:true,value:void 0});Object.defineProperty(this,we,{writable:true,value:void 0});Object.defineProperty(this,ge,{writable:true,value:void 0});Object.defineProperty(this,Oe,{writable:true,value:null});Object.defineProperty(this,_e,{writable:true,value:null});Object.defineProperty(this,Te,{writable:true,value:null});Object.defineProperty(this,Ke,{writable:true,value:new Set});Object.defineProperty(this,Se,{writable:true,value:null});Object.defineProperty(this,Ae,{writable:true,value:500});babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]=e;babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]=BX.Main.gridManager.getById(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].gridId).instance;babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]={comment_read_all:babelHelpers.classPrivateFieldLooseBase(this,ss)[ss],flow_add:babelHelpers.classPrivateFieldLooseBase(this,as)[as],flow_delete:babelHelpers.classPrivateFieldLooseBase(this,ls)[ls]};babelHelpers.classPrivateFieldLooseBase(this,we)[we]={flow_update:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts]};babelHelpers.classPrivateFieldLooseBase(this,ge)[ge]={comment_add:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts],task_add:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts],task_update:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts],task_view:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts],task_remove:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts]};babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue]();babelHelpers.classPrivateFieldLooseBase(this,xe)[xe]();babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]();babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]();babelHelpers.classPrivateFieldLooseBase(this,gs)[gs]();babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]();babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls]()}activateFlow(e){v.ajax.runAction("tasks.flow.Flow.activate",{data:{flowId:e}}).then((()=>{}))}pinFlow(e,s=false){v.ajax.runAction("tasks.flow.Flow.pin",{data:{flowId:e}}).then((a=>{if(!s){const s=a.data?"TASKS_FLOW_LIST_FLOW_PINNED":"TASKS_FLOW_LIST_FLOW_UNPINNED";c.UI.Notification.Center.notify({content:BX.Loc.getMessage(s),actions:[{title:BX.Loc.getMessage("TASKS_FLOW_LIST_FLOW_PIN_CANCEL"),events:{click:(s,a)=>{this.pinFlow(e,true);a.close()}}}]})}babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](e)}))}removeFlow(e){const s=new a.MessageBox({message:v.Loc.getMessage("TASKS_FLOW_LIST_CONFIRM_REMOVE_MESSAGE"),buttons:a.MessageBoxButtons.OK_CANCEL,okCaption:v.Loc.getMessage("TASKS_FLOW_LIST_CONFIRM_REMOVE_BUTTON"),popupOptions:{id:`tasks-flow-remove-confirm-${e}`},onOk:()=>{s.close();babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](e,"remove")},onCancel:()=>{s.close()}});s.show()}showTeam(e,s){i.TeamPopup.showInstance({flowId:e,bindElement:s})}showTaskQueue(e,s,a){r.TaskQueue.showInstance({flowId:e,type:s,bindElement:a})}showFlowLimit(){t.FeaturePromotersRegistry.getPromoter({code:babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].flowLimitCode}).show()}showNotificationHint(e,s){if(!babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].has(e)){BX.UI.Notification.Center.notify({id:e,content:s,width:"auto"});babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].add(e);d.EventEmitter.subscribeOnce("UI.Notification.Balloon:onClose",(s=>{const a=s.getTarget();if(a.getId()===e){babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].delete(e)}}))}}showGuide(e){n.Manual.show({manualCode:"flows",urlParams:{utm_source:"portal",utm_medium:"referral"},analytics:{tool:"tasks",category:"flows",event:"flow_guide_view",c_section:"tasks",c_sub_section:"flows_grid",c_element:"guide_button",p1:`isDemo_${e}`}})}}function Ts(){babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].reload(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].currentUrl)}function Ks(e,s){babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].updateRow(e,{action:s,currentPage:babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getCurrentPage()},babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].currentUrl,babelHelpers.classPrivateFieldLooseBase(this,is)[is].bind(this))}function Ss(e){babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].removeRow(e)}function As(e){return new Promise((s=>{const a=babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e);const t=babelHelpers.classPrivateFieldLooseBase(this,Os)[Os](a.getNode())?babelHelpers.classPrivateFieldLooseBase(this,Re)[Re]():babelHelpers.classPrivateFieldLooseBase(this,qe)[qe]();babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().insertBefore(e,t.getId());babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie](e).then((()=>{s()}))}))}function Cs(e){return new Promise((s=>{const a=babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e).getNode();v.Event.bindOnce(a,"animationend",(()=>{s();v.Dom.removeClass(a,"tasks-flow__list-flow-highlighted")}));v.Dom.addClass(a,"tasks-flow__list-flow-highlighted")}))}function ks(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e);if(babelHelpers.classPrivateFieldLooseBase(this,Os)[Os](s.getNode())){const s=babelHelpers.classPrivateFieldLooseBase(this,Re)[Re]();return parseInt(s==null?void 0:s.getId(),10)===e}const a=babelHelpers.classPrivateFieldLooseBase(this,qe)[qe]();return parseInt(a==null?void 0:a.getId(),10)===e}function Es(e){return babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e)!==null}function js(){return babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getCurrentPage()===1}function Is(e){return babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().getById(e)}function Ds(){const e=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().getBodyChild();return e.find((e=>babelHelpers.classPrivateFieldLooseBase(this,Os)[Os](e.getNode())))}function Ws(){const e=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().getBodyChild();return e.find((e=>!babelHelpers.classPrivateFieldLooseBase(this,Os)[Os](e.getNode())))}function Ms(e,s){return babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e).getCellById(s)}function Ns(){new l.QueueManager({moduleId:"tasks",userId:babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].currentUserId,config:{loadItemsDelay:babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]},additionalData:{},events:{onBeforePull:e=>{babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe](e)},onPull:e=>{babelHelpers.classPrivateFieldLooseBase(this,$e)[$e](e)}},callbacks:{onBeforeQueueExecute:e=>babelHelpers.classPrivateFieldLooseBase(this,Ge)[Ge](e),onQueueExecute:e=>babelHelpers.classPrivateFieldLooseBase(this,Ve)[Ve](e),onReload:()=>{babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze]()}}})}function Rs(){d.EventEmitter.subscribe("Grid::updated",(()=>{babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]();babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]();babelHelpers.classPrivateFieldLooseBase(this,gs)[gs]()}))}function qs(e){const{pullData:{command:s,params:a}}=e.data;if(babelHelpers.classPrivateFieldLooseBase(this,Be)[Be][s]){const e=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs](a);babelHelpers.classPrivateFieldLooseBase(this,Be)[Be][s].apply(this,[a,e])}}function Xs(e){const{pullData:{command:s,params:a},promises:t}=e.data;if(Object.keys(babelHelpers.classPrivateFieldLooseBase(this,we)[we]).includes(s)){const e=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs](a);if(e){t.push(Promise.resolve({data:{id:e,action:s,actionParams:a}}))}}if(Object.keys(babelHelpers.classPrivateFieldLooseBase(this,ge)[ge]).includes(s)){const e=babelHelpers.classPrivateFieldLooseBase(this,os)[os](a);if(e){t.push(Promise.resolve({data:{id:e,action:s,actionParams:a}}))}}}function Us(e){return Promise.resolve()}async function xs(e){const s=babelHelpers.classPrivateFieldLooseBase(this,cs)[cs](e);const a=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds](e);if(a.length===0){await babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye](s);return babelHelpers.classPrivateFieldLooseBase(this,es)[es](s,babelHelpers.classPrivateFieldLooseBase(this,we)[we])}let t=await babelHelpers.classPrivateFieldLooseBase(this,Je)[Je](babelHelpers.classPrivateFieldLooseBase(this,ns)[ns](a));const l=babelHelpers.classPrivateFieldLooseBase(this,us)[us](a);if(l){t=babelHelpers.classPrivateFieldLooseBase(this,hs)[hs](l,t)}const i=babelHelpers.classPrivateFieldLooseBase(this,bs)[bs](a,t);const r=babelHelpers.classPrivateFieldLooseBase(this,ps)[ps](i);if(r&&babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps](r)){const{data:{id:e}}=r;babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]=e}const o=[...s,...i];await babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye](o);return babelHelpers.classPrivateFieldLooseBase(this,es)[es](babelHelpers.classPrivateFieldLooseBase(this,vs)[vs](o),{...babelHelpers.classPrivateFieldLooseBase(this,we)[we],...babelHelpers.classPrivateFieldLooseBase(this,ge)[ge]})}async function Qs(e){const s=async()=>{for(const s of e){await babelHelpers.classPrivateFieldLooseBase(this,ze)[ze](s)}};await s();return Promise.resolve()}function $s(e){const{data:{action:s,actionParams:a,id:t}}=e;return new Promise(((e,l)=>{if(s==="flow_update"&&"activity"in a&&babelHelpers.classPrivateFieldLooseBase(this,We)[We](t)){if(babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]()&&!babelHelpers.classPrivateFieldLooseBase(this,De)[De](t)){babelHelpers.classPrivateFieldLooseBase(this,je)[je](t).then((()=>{new ce(babelHelpers.classPrivateFieldLooseBase(this,ye)[ye],a).start().then((()=>e())).catch((()=>e()))}))}else{new ce(babelHelpers.classPrivateFieldLooseBase(this,ye)[ye],a).start().then((()=>e())).catch((()=>e()))}}else{e()}}))}function Gs(e){return new Promise((s=>{v.ajax.runComponentAction("bitrix:tasks.flow.list","getMapIds",{mode:"class",data:{taskIds:e}}).then((e=>{s(v.Type.isArray(e.data)?{}:e.data)})).catch((e=>{babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs]("getMapIds",e)}))}))}function Vs(e){}function Ys(e,s){return new Promise(((a,t)=>{e.forEach((e=>{const{data:{action:a,actionParams:t,id:l}}=e;if(s[a]){s[a].apply(this,[t,l])}}));a()}))}function zs(){babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]()}function Js(e,s){if(babelHelpers.classPrivateFieldLooseBase(this,We)[We](s)){return}if(babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]()){babelHelpers.classPrivateFieldLooseBase(this,Se)[Se]=s;babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]()}}function Zs(e,s){if(!babelHelpers.classPrivateFieldLooseBase(this,We)[We](s)){return}babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](s,"update")}function ea(e,s){if(!babelHelpers.classPrivateFieldLooseBase(this,We)[We](s)){return}babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee](s)}function sa(e,s,a,t){if(babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]){if(babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]&&babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].isShown()){const e=babelHelpers.classPrivateFieldLooseBase(this,ms)[ms](babelHelpers.classPrivateFieldLooseBase(this,Te)[Te],"MY_TASKS",".tasks-flow__list-my-tasks span");if(e){babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].adjustPosition(e)}else{babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].close()}}if(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].isAhaShownOnMyTasksColumn===false&&babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]===null){babelHelpers.classPrivateFieldLooseBase(this,Fs)[Fs](babelHelpers.classPrivateFieldLooseBase(this,Te)[Te])}}}function aa(e){if("FLOW_ID"in e){return parseInt(e.FLOW_ID,10)}return 0}function ta(e){if("TASK_ID"in e){return parseInt(e.TASK_ID,10)}if("taskId"in e){return parseInt(e.taskId,10)}if("entityXmlId"in e&&e.entityXmlId.indexOf("TASK_")===0){return parseInt(e.entityXmlId.slice(5),10)}return 0}function la(e){const s=[];e.forEach((e=>{const{data:{id:a}}=e;s.push(a)}));return s}function ia(e){return e.filter((e=>{const{data:{action:s}}=e;return Object.keys(babelHelpers.classPrivateFieldLooseBase(this,we)[we]).includes(s)}))}function ra(e){return e.filter((e=>{const{data:{action:s}}=e;return Object.keys(babelHelpers.classPrivateFieldLooseBase(this,ge)[ge]).includes(s)}))}function oa(e,s){const a=[];e.forEach((e=>{const{data:{id:t}}=e;if(t in s){e.data.id=s[t];a.push(e)}}));return a}function na(e){const s=e.reduce(((e,s)=>{if(!e[s.data.id]){e[s.data.id]=s}return e}),{});return Object.values(s)}function ca(e){return e.find((e=>e.data.action==="task_add"))}function da(e){return e.find((e=>e.data.action==="task_remove"))}function ba(e,s){var a;s[e.data.id]=(a=e.data.actionParams)==null?void 0:a.FLOW_ID;return s}function va(e){var s,a;const t=(s=e.data.actionParams)==null?void 0:(a=s.AFTER)==null?void 0:a.CREATED_BY;return parseInt(t,10)===parseInt(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].currentUserId,10)}function pa(e){const s=babelHelpers.classPrivateFieldLooseBase(this,ms)[ms](e,"MY_TASKS",".tasks-flow__list-my-tasks span");if(s){babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]=new o.Clue({id:`my_tasks_${babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].currentUserId}`,autoSave:true});babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].show(o.Clue.SPOT.MY_TASKS,s);babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].isAhaShownOnMyTasksColumn=true}}function ua(){if(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].isAhaShownCopilotAdvice){return}const e=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().getBodyChild()[0];if(!e){return}const s=babelHelpers.classPrivateFieldLooseBase(this,ms)[ms](e.getId(),"EFFICIENCY",".tasks-flow__efficiency-copilot-icon-wrapper");if(s){babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]=new o.Clue({id:"flow_copilot_advice",autoSave:true});babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].show(o.Clue.SPOT.FLOW_COPILOT_ADVICE,s);babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].isAhaShownCopilotAdvice=true}}function ha(e,s,a){var t;return(t=babelHelpers.classPrivateFieldLooseBase(this,Xe)[Xe](e,s))==null?void 0:t.querySelector(a)}function Pa(e,s){console.error(`BX.Tasks.Flow.Grid: ${e} error`,s)}function Fa(){const e=new v.Uri(window.location.href);const s=e.getQueryParam("ta_sec");if(s){e.removeQueryParam("ta_cat","ta_sec","ta_sub","ta_el","p1","p2","p3","p4","p5");window.history.replaceState(null,null,e.toString())}}function La(){BX.UI.Hint.init(babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getContainer())}function ma(){if(babelHelpers.classPrivateFieldLooseBase(this,Se)[Se]!==null&&babelHelpers.classPrivateFieldLooseBase(this,We)[We](babelHelpers.classPrivateFieldLooseBase(this,Se)[Se])){babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie](babelHelpers.classPrivateFieldLooseBase(this,Se)[Se]);babelHelpers.classPrivateFieldLooseBase(this,Se)[Se]=null}}function Ha(){const e=new v.Uri(window.location.href);const a=e.getQueryParam("demo_flow");if(a){e.removeQueryParam("demo_flow");window.history.replaceState(null,null,e.toString());s.EditForm.createInstance({flowId:a,demoFlow:"Y"})}const t=e.getQueryParam("create_flow");if(t){e.removeQueryParam("create_flow");window.history.replaceState(null,null,e.toString());s.EditForm.createInstance({guideFlow:"Y"})}}function fa(){const e=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().getRows();e.forEach((e=>{const s=e.getNode();if(babelHelpers.classPrivateFieldLooseBase(this,Os)[Os](s)){v.Dom.addClass(s,"tasks-flow_list_row_pinned")}else{v.Dom.removeClass(s,"tasks-flow_list_row_pinned")}}))}function ya(e){return v.Type.isDomNode(e.querySelector(".main-grid-cell-content-action-pin.main-grid-cell-content-action-active"))}var Ba=babelHelpers.classPrivateFieldLooseKey("props");var wa=babelHelpers.classPrivateFieldLooseKey("filter");var ga=babelHelpers.classPrivateFieldLooseKey("MIN_QUERY_LENGTH");var Oa=babelHelpers.classPrivateFieldLooseKey("fields");var _a=babelHelpers.classPrivateFieldLooseKey("init");var Ta=babelHelpers.classPrivateFieldLooseKey("updateFields");var Ka=babelHelpers.classPrivateFieldLooseKey("unSubscribeToEvents");var Sa=babelHelpers.classPrivateFieldLooseKey("subscribeToEvents");var Aa=babelHelpers.classPrivateFieldLooseKey("inputFilterHandler");var Ca=babelHelpers.classPrivateFieldLooseKey("applyFilterHandler");var ka=babelHelpers.classPrivateFieldLooseKey("counterClickHandler");var Ea=babelHelpers.classPrivateFieldLooseKey("toggleByField");var ja=babelHelpers.classPrivateFieldLooseKey("isFilteredByFieldValue");var Ia=babelHelpers.classPrivateFieldLooseKey("isFilteredByField");var Da=babelHelpers.classPrivateFieldLooseKey("setActive");class Wa{constructor(e){Object.defineProperty(this,Da,{value:Va});Object.defineProperty(this,Ia,{value:Ga});Object.defineProperty(this,ja,{value:$a});Object.defineProperty(this,Ea,{value:Qa});Object.defineProperty(this,ka,{value:xa});Object.defineProperty(this,Ca,{value:Ua});Object.defineProperty(this,Aa,{value:Xa});Object.defineProperty(this,Sa,{value:qa});Object.defineProperty(this,Ka,{value:Ra});Object.defineProperty(this,Ta,{value:Na});Object.defineProperty(this,_a,{value:Ma});Object.defineProperty(this,Ba,{writable:true,value:void 0});Object.defineProperty(this,wa,{writable:true,value:void 0});Object.defineProperty(this,ga,{writable:true,value:3});Object.defineProperty(this,Oa,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba]=e;babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]()}hasFilteredFields(){const e=babelHelpers.classPrivateFieldLooseBase(this,wa)[wa].getFilterFieldsValues();const s=Object.values(e);for(const e of s){if(this.isArrayFieldFiller(e)||this.isStringFieldFilled(e)){return true}}return false}isFilterActive(){const e=!["default_filter","tmp_filter"].includes(babelHelpers.classPrivateFieldLooseBase(this,wa)[wa].getPreset().getCurrentPresetId());const s=!this.isSearchEmpty();const a=this.hasFilteredFields();return e||s||a}isArrayFieldFiller(e){return v.Type.isArrayFilled(e)}isStringFieldFilled(e){return e!=="NONE"&&v.Type.isStringFilled(e)}isSearchEmpty(){const e=babelHelpers.classPrivateFieldLooseBase(this,wa)[wa].getSearch().getSearchString();return!e||e.length<babelHelpers.classPrivateFieldLooseBase(this,ga)[ga]}}function Ma(){babelHelpers.classPrivateFieldLooseBase(this,wa)[wa]=BX.Main.filterManager.getById(babelHelpers.classPrivateFieldLooseBase(this,Ba)[Ba].filterId);babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]();babelHelpers.classPrivateFieldLooseBase(this,Sa)[Sa]()}function Na(){babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]=babelHelpers.classPrivateFieldLooseBase(this,wa)[wa].getFilterFieldsValues()}function Ra(){d.EventEmitter.unsubscribe("BX.Filter.Search:input",babelHelpers.classPrivateFieldLooseBase(this,Aa)[Aa].bind(this));d.EventEmitter.unsubscribe("BX.Main.Filter:apply",babelHelpers.classPrivateFieldLooseBase(this,Ca)[Ca].bind(this));d.EventEmitter.unsubscribe("Tasks.Toolbar:onItem",babelHelpers.classPrivateFieldLooseBase(this,ka)[ka].bind(this))}function qa(){d.EventEmitter.subscribe("BX.Filter.Search:input",babelHelpers.classPrivateFieldLooseBase(this,Aa)[Aa].bind(this));d.EventEmitter.subscribe("BX.Main.Filter:apply",babelHelpers.classPrivateFieldLooseBase(this,Ca)[Ca].bind(this));d.EventEmitter.subscribe("Tasks.Toolbar:onItem",babelHelpers.classPrivateFieldLooseBase(this,ka)[ka].bind(this))}function Xa(){babelHelpers.classPrivateFieldLooseBase(this,Da)[Da](this.isFilterActive())}function Ua(){babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]()}function xa(e){const s=e.getData();if(s.counter&&s.counter.filter){babelHelpers.classPrivateFieldLooseBase(this,Ea)[Ea]({[s.counter.filterField]:s.counter.filterValue})}}function Qa(e){const s=Object.keys(e)[0];const a=e[s];if(!babelHelpers.classPrivateFieldLooseBase(this,ja)[ja](s,a)){babelHelpers.classPrivateFieldLooseBase(this,wa)[wa].getApi().extendFilter({[s]:a});return}babelHelpers.classPrivateFieldLooseBase(this,wa)[wa].getFilterFields().forEach((e=>{if(e.getAttribute("data-name")===s){babelHelpers.classPrivateFieldLooseBase(this,wa)[wa].getFields().deleteField(e)}}));babelHelpers.classPrivateFieldLooseBase(this,wa)[wa].getSearch().apply()}function $a(e,s){return babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia](e)&&babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa][e]===s}function Ga(e){if(!Object.keys(babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]).includes(e)){return false}if(v.Type.isArray(babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa][e])){return babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa][e].length>0}return babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa][e]!==""}function Va(e){const s=babelHelpers.classPrivateFieldLooseBase(this,wa)[wa].popupBindElement;if(e){v.Dom.removeClass(s,"main-ui-filter-default-applied");v.Dom.addClass(s,"main-ui-filter-search--showed")}else{v.Dom.addClass(s,"main-ui-filter-default-applied");v.Dom.removeClass(s,"main-ui-filter-search--showed")}}var Ya=babelHelpers.classPrivateFieldLooseKey("id");var za=babelHelpers.classPrivateFieldLooseKey("flowId");var Ja=babelHelpers.classPrivateFieldLooseKey("dashboards");var Za=babelHelpers.classPrivateFieldLooseKey("target");var et=babelHelpers.classPrivateFieldLooseKey("getMenuItems");class st{constructor(e){Object.defineProperty(this,et,{value:at});Object.defineProperty(this,Ya,{writable:true,value:void 0});Object.defineProperty(this,za,{writable:true,value:void 0});Object.defineProperty(this,Ja,{writable:true,value:void 0});Object.defineProperty(this,Za,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja]=Object.values(e.dashboards);babelHelpers.classPrivateFieldLooseBase(this,Za)[Za]=e.target;babelHelpers.classPrivateFieldLooseBase(this,za)[za]=Number(e.flowId);babelHelpers.classPrivateFieldLooseBase(this,Ya)[Ya]=`tasks-flow-bi-analytics-menu_${babelHelpers.classPrivateFieldLooseBase(this,za)[za]}`}static create(e){return new st(e)}openMenu(){const e=p.MenuManager.create({id:babelHelpers.classPrivateFieldLooseBase(this,Ya)[Ya],bindElement:babelHelpers.classPrivateFieldLooseBase(this,Za)[Za],items:babelHelpers.classPrivateFieldLooseBase(this,et)[et](),cacheable:false});e.show()}openFirstDashboard(){const e=babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja][0];if(e){b.SidePanel.Instance.open(e.url)}}}function at(){const e=[];babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja].forEach((s=>{e.push({tabId:s.id,text:s.title,onclick:()=>{b.SidePanel.Instance.open(s.url)}})}));return e}let tt=e=>e,lt;class it{static show(e){const{root:s,exampleLink:a}=v.Tag.render(lt||(lt=tt`
			<div class="tasks-flow__not-enough-tasks-popup">
				<div class="tasks-flow__not-enough-tasks-popup-title">
					<span class="tasks-flow__not-enough-tasks-popup-icon ui-icon-set --copilot-ai"/>
					<span class="tasks-flow__not-enough-tasks-popup-title-text">
						${0}
					</span>
				</div>
				<div class="tasks-flow__not-enough-tasks-popup-description">
					${0}
				</div>
				<div class="tasks-flow__not-enough-tasks-popup-example">
					<span class="tasks-flow__not-enough-tasks-popup-example-text" ref="exampleLink">
						${0}
					</span>
				</div>
			</div>
		`),v.Loc.getMessage("TASKS_FLOW_LIST_COPILOT_NOT_ENOUGH_TASKS_POPUP_TITLE"),v.Loc.getMessage("TASKS_FLOW_LIST_COPILOT_NOT_ENOUGH_TASKS_POPUP_DESCRIPTION"),v.Loc.getMessage("TASKS_FLOW_LIST_COPILOT_NOT_ENOUGH_TASKS_POPUP_SHOW_EXAMPLE"));const t=new p.Popup({bindElement:e,content:s,cacheable:false,autoHide:true,minWidth:270,width:270,padding:12,angle:{position:"top",offset:30}});v.Event.bind(a,"click",(()=>{u.CopilotAdvice.showExample();t==null?void 0:t.close()}));t.show()}}e.Grid=_s;e.Filter=Wa;e.BIAnalytics=st;e.NotEnoughTasksPopup=it})(this.BX.Tasks.Flow=this.BX.Tasks.Flow||{},BX.Tasks.Flow,BX.UI.Dialogs,BX.UI,BX.Pull,BX.Tasks.Flow,BX.Tasks.Flow,BX.Tasks,BX.UI.Manual,BX,BX.Event,BX,BX,BX.Main,BX.Tasks.Flow);
//# sourceMappingURL=script.map.js