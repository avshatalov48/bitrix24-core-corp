{"version":3,"file":"script.js","sources":["src/flip-board-sdk/src/lib/types/SDK.js","src/jwt-decode/build/esm/index.js","src/flip-board-sdk/src/lib/flip-board-sdk.js","src/board.js","src/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DashboardFlow = exports.AccessLevel = void 0;\nvar AccessLevel;\n(function (AccessLevel) {\n    AccessLevel[\"private\"] = \"private\";\n    AccessLevel[\"readonly\"] = \"readonly\";\n    AccessLevel[\"editable\"] = \"editable\";\n})(AccessLevel || (exports.AccessLevel = AccessLevel = {}));\nvar DashboardFlow;\n(function (DashboardFlow) {\n    DashboardFlow[\"short\"] = \"short\";\n})(DashboardFlow || (exports.DashboardFlow = DashboardFlow = {}));\n\nexport default exports;","export class InvalidTokenError extends Error {\n}\nInvalidTokenError.prototype.name = \"InvalidTokenError\";\nfunction b64DecodeUnicode(str) {\n    return decodeURIComponent(atob(str).replace(/(.)/g, (m, p) => {\n        let code = p.charCodeAt(0).toString(16).toUpperCase();\n        if (code.length < 2) {\n            code = \"0\" + code;\n        }\n        return \"%\" + code;\n    }));\n}\nfunction base64UrlDecode(str) {\n    let output = str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    switch (output.length % 4) {\n        case 0:\n            break;\n        case 2:\n            output += \"==\";\n            break;\n        case 3:\n            output += \"=\";\n            break;\n        default:\n            throw new Error(\"base64 string is not of the correct length\");\n    }\n    try {\n        return b64DecodeUnicode(output);\n    }\n    catch (err) {\n        return atob(output);\n    }\n}\nexport function jwtDecode(token, options) {\n    if (typeof token !== \"string\") {\n        throw new InvalidTokenError(\"Invalid token specified: must be a string\");\n    }\n    options || (options = {});\n    const pos = options.header === true ? 0 : 1;\n    const part = token.split(\".\")[pos];\n    if (typeof part !== \"string\") {\n        throw new InvalidTokenError(`Invalid token specified: missing part #${pos + 1}`);\n    }\n    let decoded;\n    try {\n        decoded = base64UrlDecode(part);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid base64 for part #${pos + 1} (${e.message})`);\n    }\n    try {\n        return JSON.parse(decoded);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid json for part #${pos + 1} (${e.message})`);\n    }\n}\n","\"use strict\";\nimport SDK from \"./types/SDK\"\nimport { jwtDecode } from \"../../../jwt-decode/build/esm/index\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebSDK = void 0;\nvar WebSDK = /** @class */ (function () {\n    function WebSDK(params) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        this.params = params;\n        var accessLevel;\n        var canEditBoard;\n        var boardData = {};\n        var jwtParams = {\n            user_id: '',\n            username: '',\n            avatar_url: '',\n            access_level: 'read',\n            can_edit_board: false,\n            webhook_url: '',\n            document_id: '',\n            download_link: '',\n            session_id: '',\n            file_name: '',\n        };\n        if (params.token) {\n            try {\n                jwtParams = jwtDecode(params.token);\n                accessLevel = jwtParams.access_level === 'read' ? SDK.AccessLevel.readonly : SDK.AccessLevel.editable;\n                canEditBoard = jwtParams.can_edit_board;\n                boardData.documentId = jwtParams.document_id;\n                boardData.fileUrl = jwtParams.download_link;\n                boardData.sessionId = jwtParams.session_id;\n                boardData.fileName = jwtParams.file_name;\n            }\n            catch (e) {\n                console.error('invalid token');\n            }\n        }\n        this.boardParams = {\n            appUrl: encodeURIComponent(params.appUrl),\n            accessLevel: accessLevel,\n            canEditBoard: canEditBoard,\n            token: params.token,\n            lang: params.lang || 'ru',\n            // bitrix partnerId by default\n            partnerId: params.partnerId || '0',\n            ui: {\n                colorTheme: ((_a = params.ui) === null || _a === void 0 ? void 0 : _a.colorTheme) || 'flipOriginLight',\n                openTemplatesModal: !!((_b = params.ui) === null || _b === void 0 ? void 0 : _b.openTemplatesModal),\n                compactHeader: !!((_c = params.ui) === null || _c === void 0 ? void 0 : _c.compactHeader),\n                showCloseButton: !!((_d = params.ui) === null || _d === void 0 ? void 0 : _d.showCloseButton),\n                dashboardFlow: ((_e = params.ui) === null || _e === void 0 ? void 0 : _e.dashboardFlow) || undefined,\n                exportAsFile: ((_f = params.ui) === null || _f === void 0 ? void 0 : _f.exportAsFile) !== false,\n                spinner: (_g = params.ui) === null || _g === void 0 ? void 0 : _g.spinner,\n            },\n            appContainerDomain: window.location.origin,\n            boardData: boardData,\n        };\n        this.iframeEl = document.createElement('iframe');\n        this.iframeEl.allow = 'clipboard-read; clipboard-write';\n        window.addEventListener('beforeunload', this.destroy.bind(this));\n    }\n    WebSDK.prototype.init = function () {\n        var container = document.getElementById(this.params.containerId);\n        if (!container) {\n            console.error(\"\\u042D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442 \\u0441 id \\\"\".concat(this.params.containerId, \"\\\" \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D.\"));\n            return;\n        }\n        this.iframeEl.src = this.createUrl();\n        this.iframeEl.style.width = '100%';\n        this.iframeEl.style.height = '100%';\n        this.iframeEl.style.border = 'none';\n        container.appendChild(this.iframeEl);\n        this.addEventListener();\n        window.FlipBoard = this.getBoardMethods();\n    };\n    WebSDK.prototype.getBoardMethods = function () {\n        var _this = this;\n        return {\n            tryToCloseBoard: function () {\n                return new Promise(function (resolve, reject) {\n                    var _a;\n                    window.addEventListener('message', function (event) {\n                        var _a, _b;\n                        if (((_a = event.data) === null || _a === void 0 ? void 0 : _a.event) === WebSDK.SUCCESS_CLOSE_BOARD_EVENT_NAME) {\n                            resolve();\n                        }\n                        if (((_b = event.data) === null || _b === void 0 ? void 0 : _b.event) === WebSDK.ERROR_CLOSE_BOARD_EVENT_NAME) {\n                            reject();\n                        }\n                    });\n                    (_a = _this.iframeEl.contentWindow) === null || _a === void 0 ? void 0 : _a.postMessage({ event: WebSDK.TRY_TO_CLOSE_BOARD_EVENT_NAME }, '*');\n                });\n            },\n            renameFlip: function (name) {\n                return new Promise(function (resolve, reject) {\n                    var _a;\n                    window.addEventListener('message', function (event) {\n                        var _a, _b;\n                        if (((_a = event.data) === null || _a === void 0 ? void 0 : _a.event) === WebSDK.SUCCESS_FLIP_RENAMED_EVENT_NAME) {\n                            resolve();\n                        }\n                        if (((_b = event.data) === null || _b === void 0 ? void 0 : _b.event) === WebSDK.ERROR_FLIP_RENAMED_EVENT_NAME) {\n                            reject();\n                        }\n                    });\n                    (_a = _this.iframeEl.contentWindow) === null || _a === void 0 ? void 0 : _a.postMessage({\n                        event: WebSDK.RENAME_FLIP_EVENT,\n                        data: { name: name },\n                    }, '*');\n                });\n            },\n            // Другие методы можно добавить здесь\n        };\n    };\n    WebSDK.prototype.createUrl = function () {\n        var url = new URL(\"\".concat(this.params.appUrl).concat(this.boardParams.partnerId === '0' ? '/sdkBoard' : ''));\n        url.searchParams.set('fromSDK', 'true');\n        if (this.boardParams.ui.openTemplatesModal)\n            url.searchParams.set('openTemplates', 'true');\n        if (this.boardParams.ui.spinner && this.boardParams.ui.spinner !== 'default')\n            url.searchParams.set('spinner', this.boardParams.ui.spinner);\n        return url.toString();\n    };\n    WebSDK.prototype.addEventListener = function () {\n        window.addEventListener('message', this.listenBoardEvents.bind(this));\n    };\n    WebSDK.prototype.listenBoardEvents = function (event) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n        if (((_a = event.data) === null || _a === void 0 ? void 0 : _a.event) === WebSDK.WAIT_PARAMS_EVENT_NAME) {\n            // @ts-ignore\n            (_b = this.iframeEl.contentWindow) === null || _b === void 0 ? void 0 : _b.postMessage({ event: WebSDK.SET_PARAMS_EVENT_NAME, data: this.boardParams }, '*');\n        }\n        if (((_c = event.data) === null || _c === void 0 ? void 0 : _c.event) === WebSDK.BOARD_CHANGED_EVENT_NAME) {\n            if ((_e = (_d = this.params) === null || _d === void 0 ? void 0 : _d.events) === null || _e === void 0 ? void 0 : _e.onBoardChanged) {\n                this.params.events.onBoardChanged();\n            }\n        }\n        if (((_f = event.data) === null || _f === void 0 ? void 0 : _f.event) === WebSDK.SUCCESS_FLIP_RENAMED_EVENT_NAME) {\n            if ((_h = (_g = this.params) === null || _g === void 0 ? void 0 : _g.events) === null || _h === void 0 ? void 0 : _h.onFlipRenamed) {\n                this.params.events.onFlipRenamed(((_k = (_j = event.data) === null || _j === void 0 ? void 0 : _j.data) === null || _k === void 0 ? void 0 : _k.name) || '');\n            }\n        }\n    };\n    WebSDK.prototype.destroy = function () {\n        window.removeEventListener('message', this.listenBoardEvents);\n    };\n    WebSDK.WAIT_PARAMS_EVENT_NAME = 'waitSDKParams';\n    WebSDK.BOARD_CHANGED_EVENT_NAME = 'boardChanged';\n    WebSDK.SET_PARAMS_EVENT_NAME = 'setSDKParams';\n    WebSDK.TRY_TO_CLOSE_BOARD_EVENT_NAME = 'tryToCloseApp';\n    WebSDK.SUCCESS_CLOSE_BOARD_EVENT_NAME = 'successCloseApp';\n    WebSDK.ERROR_CLOSE_BOARD_EVENT_NAME = 'errorCloseApp';\n    WebSDK.SUCCESS_FLIP_RENAMED_EVENT_NAME = 'successFlipRenamed';\n    WebSDK.ERROR_FLIP_RENAMED_EVENT_NAME = 'errorFlipRenamed';\n    WebSDK.RENAME_FLIP_EVENT = 'renameFlip';\n    return WebSDK;\n}());\nexports.WebSDK = WebSDK;\n\nexport default WebSDK;\n","import { ButtonManager, Button } from 'ui.buttons';\nimport { MenuItem } from 'main.popup';\nimport { ExternalLink } from 'disk.external-link';\nimport { LegacyPopup } from 'disk.sharing-legacy-popup';\nimport type { BoardData } from './types';\n\nexport default class Board\n{\n\tsetupSharingButton: Button = null;\n\tdata: BoardData = null;\n\n\tconstructor(options)\n\t{\n\t\tthis.setupSharingButton = ButtonManager.createByUniqId(options.panelButtonUniqIds.setupSharing);\n\t\tthis.data = options.boardData;\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tif (this.setupSharingButton)\n\t\t{\n\t\t\tconst menuWindow = this.setupSharingButton.getMenuWindow();\n\t\t\tconst extLinkOptions = menuWindow.getMenuItem('ext-link').options;\n\t\t\textLinkOptions.onclick = this.handleClickSharingByExternalLink.bind(this);\n\n\t\t\tmenuWindow.removeMenuItem('ext-link');\n\t\t\tmenuWindow.addMenuItem(extLinkOptions);\n\n\t\t\tconst sharingOptions = menuWindow.getMenuItem('sharing').options;\n\t\t\tsharingOptions.onclick = this.handleClickSharing.bind(this);\n\n\t\t\tmenuWindow.removeMenuItem('sharing');\n\t\t\tmenuWindow.addMenuItem(sharingOptions);\n\t\t}\n\t}\n\n\thandleClickSharingByExternalLink(event, menuItem: MenuItem): void\n\t{\n\t\tthis.setupSharingButton.getMenuWindow().close();\n\t\tif (menuItem.dataset.shouldBlockExternalLinkFeature)\n\t\t{\n\t\t\teval(menuItem.dataset.blockerExternalLinkFeature);\n\n\t\t\treturn;\n\t\t}\n\n\t\tExternalLink.showPopup(this.data.id);\n\t}\n\n\thandleClickSharing(): void\n\t{\n\t\tthis.setupSharingButton.getMenuWindow().close();\n\t\t(new LegacyPopup()).showSharingDetailWithChangeRights({\n\t\t\tobject: {\n\t\t\t\tid: this.data.id,\n\t\t\t\tname: this.data.name,\n\t\t\t},\n\t\t});\n\t}\n}\n","import WebSDK from './flip-board-sdk/src/lib/flip-board-sdk';\nimport Board from './board.js';\n\nconst SDK = WebSDK;\n\nexport {\n\tBoard,\n\tSDK,\n};\n"],"names":["Object","defineProperty","exports","value","DashboardFlow","AccessLevel","InvalidTokenError","Error","prototype","name","b64DecodeUnicode","str","decodeURIComponent","atob","replace","m","p","code","charCodeAt","toString","toUpperCase","length","base64UrlDecode","output","err","jwtDecode","token","options","pos","header","part","split","decoded","e","message","JSON","parse","WebSDK","params","_a","_b","_c","_d","_e","_f","_g","accessLevel","canEditBoard","boardData","jwtParams","user_id","username","avatar_url","access_level","can_edit_board","webhook_url","document_id","download_link","session_id","file_name","SDK","readonly","editable","documentId","fileUrl","sessionId","fileName","console","error","boardParams","appUrl","encodeURIComponent","lang","partnerId","ui","colorTheme","openTemplatesModal","compactHeader","showCloseButton","dashboardFlow","undefined","exportAsFile","spinner","appContainerDomain","window","location","origin","iframeEl","document","createElement","allow","addEventListener","destroy","bind","init","container","getElementById","containerId","concat","src","createUrl","style","width","height","border","appendChild","FlipBoard","getBoardMethods","_this","tryToCloseBoard","Promise","resolve","reject","event","data","SUCCESS_CLOSE_BOARD_EVENT_NAME","ERROR_CLOSE_BOARD_EVENT_NAME","contentWindow","postMessage","TRY_TO_CLOSE_BOARD_EVENT_NAME","renameFlip","SUCCESS_FLIP_RENAMED_EVENT_NAME","ERROR_FLIP_RENAMED_EVENT_NAME","RENAME_FLIP_EVENT","url","URL","searchParams","set","listenBoardEvents","_h","_j","_k","WAIT_PARAMS_EVENT_NAME","SET_PARAMS_EVENT_NAME","BOARD_CHANGED_EVENT_NAME","events","onBoardChanged","onFlipRenamed","removeEventListener","Board","setupSharingButton","ButtonManager","createByUniqId","panelButtonUniqIds","setupSharing","bindEvents","menuWindow","getMenuWindow","extLinkOptions","getMenuItem","onclick","handleClickSharingByExternalLink","removeMenuItem","addMenuItem","sharingOptions","handleClickSharing","menuItem","close","dataset","shouldBlockExternalLinkFeature","eval","blockerExternalLinkFeature","ExternalLink","showPopup","id","LegacyPopup","showSharingDetailWithChangeRights","object"],"mappings":"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"}