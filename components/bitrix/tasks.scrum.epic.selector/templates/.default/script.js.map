{"version":3,"file":"script.js","sources":["src/view.js","src/edit.js","src/index.js"],"sourcesContent":["import {Loc, Text, Tag, Dom, Type, Event, ajax} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Dialog} from 'ui.entity-selector';\n\ntype Params = {\n\tgroupId: number,\n\ttaskId: number,\n\tepic: ?Epic,\n\tcanEdit: boolean\n}\n\ntype Epic = {\n\tid: number,\n\tgroupId: number,\n\tname: string,\n\tdescription: string,\n\tcreatedBy: number,\n\tmodifiedBy: number,\n\tcolor: string\n}\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class ViewSelector\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.groupId = params.groupId;\n\t\tthis.taskId = params.taskId;\n\t\tthis.epic = params.epic;\n\t\tthis.canEdit = params.canEdit;\n\n\t\tthis.dialog = null;\n\n\t\tthis.node = null;\n\t\tthis.nameNode = null;\n\t\tthis.selectorNode = null;\n\n\t\tEventEmitter.subscribe('onChangeProjectLink', this.onChangeTaskProject.bind(this));\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tDom.append(this.render(), container);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div>\n\t\t\t\t${this.renderName()}\n\t\t\t\t${this.renderSelector()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\tonChangeTaskProject(baseEvent: BaseEvent): void\n\t{\n\t\tconst [groupId, taskId] = baseEvent.getCompatData();\n\n\t\tthis.groupId = parseInt(groupId, 10);\n\t\tthis.taskId = parseInt(taskId, 10);\n\t\tthis.epic = null;\n\n\t\tthis.dialog = null;\n\n\t\tthis.updateSelector(null);\n\t}\n\n\trenderName(): ?HTMLElement\n\t{\n\t\tif (Type.isNull(this.epic))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst colorBorder = this.convertHexToRGBA(this.epic.color, 0.7);\n\t\tconst colorBackground = this.convertHexToRGBA(this.epic.color, 0.3);\n\n\t\tthis.nameNode = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-scrum__epic-selector--epic\"\n\t\t\t\tstyle=\"background: ${colorBackground}; border-color: ${colorBorder};\"\n\t\t\t>\n\t\t\t\t${Text.encode(this.epic.name)}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.nameNode;\n\t}\n\n\trenderSelector(): HTMLElement\n\t{\n\t\tthis.selectorNode = Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"ui-btn-link tasks-scrum__epic-selector--link\">\n\t\t\t\t\t${this.getButtonText()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst buttonNode = this.selectorNode.firstElementChild;\n\n\t\tEvent.bind(buttonNode, 'click', this.onClick.bind(this, buttonNode));\n\n\t\treturn this.selectorNode;\n\t}\n\n\tonClick(buttonNode: HTMLElement)\n\t{\n\t\tif (this.dialog)\n\t\t{\n\t\t\tif (this.dialog.isOpen())\n\t\t\t{\n\t\t\t\tthis.dialog.hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.dialog.show();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.dialog = new Dialog({\n\t\t\tid: Text.getRandom(),\n\t\t\ttargetNode: this.selectorNode,\n\t\t\twidth: 350,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tcompactView: true,\n\t\t\thideOnDeselect: true,\n\t\t\tselectedItems: [],\n\t\t\titems: [],\n\t\t\tsearchOptions: {\n\t\t\t\tallowCreateItem: true,\n\t\t\t\tfooterOptions: {\n\t\t\t\t\tlabel: Loc.getMessage('TSE_SELECTOR_SEARCHER_EPIC_ADD')\n\t\t\t\t}\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\t'Search:onItemCreateAsync': (event) => {\n\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\tconst { searchQuery } = event.getData();\n\t\t\t\t\t\tthis.createEpic(searchQuery.getQuery())\n\t\t\t\t\t\t\t.then((epic: Epic) => {\n\t\t\t\t\t\t\t\tconst epicDialogItem = this.getEpicDialogItem(epic);\n\t\t\t\t\t\t\t\tepicDialogItem.selected = true;\n\t\t\t\t\t\t\t\tepicDialogItem.sort = 1;\n\t\t\t\t\t\t\t\tthis.dialog.addItem(epicDialogItem);\n\t\t\t\t\t\t\t\tthis.dialog.hide();\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\ttextBoxWidth: 300\n\t\t\t}\n\t\t});\n\n\t\tthis.dialog.subscribe('onHide', () => {\n\t\t\tconst selectedItems = this.dialog.getSelectedItems();\n\t\t\tconst epicId = selectedItems.length ? selectedItems[0].getId() : 0;\n\t\t\tthis.changeTaskEpic(epicId).then((epic: ?Epic) => this.updateSelector(epic));\n\t\t});\n\n\t\tthis.dialog.showLoader();\n\n\t\tthis.dialog.show();\n\n\t\tthis.getEpics()\n\t\t\t.then((epics) => {\n\t\t\t\tif (!Type.isNull(this.epic))\n\t\t\t\t{\n\t\t\t\t\tconst selectedItem = this.getEpicDialogItem(this.epic);\n\t\t\t\t\tselectedItem.selected = true;\n\t\t\t\t\tselectedItem.sort = 1;\n\t\t\t\t\tthis.dialog.addItem(selectedItem);\n\t\t\t\t}\n\t\t\t\tepics.forEach((item) => {\n\t\t\t\t\tthis.dialog.addItem(item);\n\t\t\t\t});\n\t\t\t\tthis.dialog.hideLoader();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.showErrorAlert(response);\n\t\t\t\tthis.dialog.hideLoader();\n\t\t\t})\n\t\t;\n\t}\n\n\tupdateSelector(epic: ?Epic)\n\t{\n\t\tthis.epic = epic;\n\n\t\tthis.selectorNode.firstElementChild.textContent = this.getButtonText();\n\n\t\tif (Type.isNull(epic))\n\t\t{\n\t\t\tDom.remove(this.nameNode);\n\n\t\t\tthis.nameNode = null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (Type.isNull(this.nameNode))\n\t\t\t{\n\t\t\t\tDom.insertBefore(this.renderName(), this.selectorNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.replace(this.nameNode, this.renderName());\n\t\t\t}\n\t\t}\n\t}\n\n\tgetEpics(): Promise\n\t{\n\t\treturn ajax.runComponentAction(\n\t\t\t'bitrix:tasks.scrum.epic.selector',\n\t\t\t'getEpics',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tgroupId: this.groupId\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then((response) => {\n\t\t\t\tconst epics = response.data;\n\t\t\t\tif (Type.isNull(epics))\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tconst list = [];\n\t\t\t\tepics.forEach((epic: Epic) => {\n\t\t\t\t\tlist.push(this.getEpicDialogItem(epic));\n\t\t\t\t});\n\n\t\t\t\treturn list;\n\t\t\t})\n\t\t\t.catch((response) => this.showErrorAlert(response))\n\t\t;\n\t}\n\n\tgetEpicDialogItem(epic: Epic): Object\n\t{\n\t\tconst avatar = '/bitrix/components/bitrix/tasks.scrum.epic.selector/templates/.default'\n\t\t\t+ '/images/search-hashtag-green.svg'\n\t\t;\n\n\t\treturn {\n\t\t\tid: epic.id,\n\t\t\tentityId: 'epic',\n\t\t\ttitle: epic.name,\n\t\t\ttabs: 'recents',\n\t\t\tavatar: avatar\n\t\t};\n\t}\n\n\tchangeTaskEpic(epicId: number): Promise\n\t{\n\t\treturn ajax.runComponentAction(\n\t\t\t'bitrix:tasks.scrum.epic.selector',\n\t\t\t'changeTaskEpic',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\tepicId: epicId\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then((response) => {\n\t\t\t\treturn response.data;\n\t\t\t})\n\t\t\t.catch((response) => this.showErrorAlert(response))\n\t\t;\n\t}\n\n\tcreateEpic(epicName: string): Promise\n\t{\n\t\treturn ajax.runAction(\n\t\t\t'bitrix:tasks.scrum.epic.createEpic',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\tname: epicName\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then((response) => {\n\t\t\t\treturn response.data;\n\t\t\t})\n\t\t\t.catch((response) => this.showErrorAlert(response))\n\t\t;\n\t}\n\n\tgetButtonText(): string\n\t{\n\t\tif (Type.isNull(this.epic))\n\t\t{\n\t\t\treturn Loc.getMessage('TSE_SELECTOR_ADD');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Loc.getMessage('TSE_SELECTOR_EDIT');\n\t\t}\n\t}\n\n\tconvertHexToRGBA(hexCode, opacity): string\n\t{\n\t\tlet hex = hexCode.replace('#', '');\n\n\t\tif (hex.length === 3)\n\t\t{\n\t\t\thex = `${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;\n\t\t}\n\n\t\tconst r = parseInt(hex.substring(0, 2), 16);\n\t\tconst g = parseInt(hex.substring(2, 4), 16);\n\t\tconst b = parseInt(hex.substring(4, 6), 16);\n\n\t\treturn `rgba(${r},${g},${b},${opacity})`;\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TSE_SELECTOR_ERROR_POPUP_TITLE'));\n\n\t\t\t\ttop.BX.UI.Dialogs.MessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Loc, Text, Tag, Dom, Type, ajax} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {TagSelector} from 'ui.entity-selector';\n\ntype Params = {\n\tgroupId: number,\n\ttaskId: number,\n\tepic: ?Epic,\n\tinputName: string\n}\n\ntype Epic = {\n\tid: number,\n\tgroupId: number,\n\tname: string,\n\tdescription: string,\n\tcreatedBy: number,\n\tmodifiedBy: number,\n\tcolor: string\n}\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class EditSelector\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.groupId = params.groupId;\n\t\tthis.taskId = params.taskId;\n\t\tthis.savedEpic = params.epic;\n\t\tthis.inputName = params.inputName;\n\n\t\tthis.selector = null;\n\n\t\tthis.listEpics = new Map();\n\n\t\tthis.node = null;\n\t\tthis.inputNode = null;\n\n\t\tEventEmitter.subscribe('BX.Tasks.MemberSelector:projectSelected', this.onProjectSelected.bind(this));\n\t\tEventEmitter.subscribe('BX.Tasks.Component.Task:projectPreselected', this.onProjectPreselected.bind(this));\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tthis.node = container;\n\n\t\tDom.addClass(this.node, 'tasks-scrum-epic-edit-selector');\n\n\t\tif (this.inputName)\n\t\t{\n\t\t\tDom.append(this.renderInput(), this.node);\n\t\t}\n\n\t\tthis.buildSelector().renderTo(this.node);\n\t}\n\n\trenderInput(): HTMLElement\n\t{\n\t\tconst value = this.savedEpic ? parseInt(this.savedEpic.id, 10) : 0;\n\n\t\tthis.inputNode = Tag.render`\n\t\t\t<input type=\"hidden\" name=\"${Text.encode(this.inputName)}\" value=\"${value}\">\n\t\t`;\n\n\t\treturn this.inputNode;\n\t}\n\n\tbuildSelector(): TagSelector\n\t{\n\t\t// todo add scrum epic provider\n\n\t\tthis.selector = new TagSelector({\n\t\t\tmultiple: false,\n\t\t\ttextBoxWidth: 200,\n\t\t\tdialogOptions: {\n\t\t\t\twidth: 350,\n\t\t\t\theight: 240,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tcompactView: true,\n\t\t\t\tmultiple: false,\n\t\t\t\thideOnDeselect: true,\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: true,\n\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\tlabel: Loc.getMessage('TSE_SELECTOR_SEARCHER_EPIC_ADD')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\titems: [],\n\t\t\t\tevents: {\n\t\t\t\t\t'Search:onItemCreateAsync': (event) => {\n\t\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\t\tconst { searchQuery } = event.getData();\n\t\t\t\t\t\t\tconst dialog = event.getTarget();\n\t\t\t\t\t\t\tthis.createEpic(searchQuery.getQuery())\n\t\t\t\t\t\t\t\t.then((epic: Epic) => {\n\t\t\t\t\t\t\t\t\tconst epicDialogItem = this.getEpicDialogItem(epic);\n\t\t\t\t\t\t\t\t\tepicDialogItem.selected = true;\n\t\t\t\t\t\t\t\t\tepicDialogItem.sort = 1;\n\t\t\t\t\t\t\t\t\tdialog.addItem(epicDialogItem);\n\t\t\t\t\t\t\t\t\tthis.updateInputValue(epicDialogItem.id);\n\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tthis.updateInputValue(selectedItem.getId());\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\t\tconst dialog = event.getTarget();\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tif (dialog.getSelectedItems().length === 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.updateInputValue(0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 50);\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.selector\n\t\t\t.subscribe('onMetaEnter', (baseEvent: BaseEvent) => {\n\t\t\t\tconst tagSelector: TagSelector = baseEvent.getTarget();\n\t\t\t\tif (tagSelector.getDialog().isOpen())\n\t\t\t\t{\n\t\t\t\t\tconst { event: keyboardEvent } = baseEvent.getData();\n\n\t\t\t\t\tkeyboardEvent.stopPropagation();\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tthis.selector.getDialog().subscribe('onShow', () => {\n\t\t\tthis.updateSelectorItems();\n\t\t});\n\n\t\tif (this.savedEpic)\n\t\t{\n\t\t\tthis.updateSelectorItems();\n\t\t}\n\n\t\treturn this.selector;\n\t}\n\n\tonProjectSelected(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\n\t\tthis.groupId = parseInt(data.ID, 10);\n\n\t\tthis.listEpics.clear();\n\n\t\tthis.selector.getDialog().removeItems();\n\n\t\tthis.updateInputValue(0);\n\t}\n\n\tonProjectPreselected(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\n\t\tthis.groupId = parseInt(data.groupId, 10);\n\n\t\tthis.listEpics.clear();\n\n\t\tthis.selector.getDialog().removeItems();\n\n\t\tthis.updateInputValue(0);\n\t}\n\n\tupdateSelectorItems()\n\t{\n\t\tif (\n\t\t\tthis.groupId === 0\n\t\t\t|| this.listEpics.has(this.groupId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.selector.getDialog().removeItems();\n\n\t\tthis.selector.getDialog().showLoader();\n\n\t\tthis.getEpics()\n\t\t\t.then((epics: Array) => {\n\t\t\t\tepics.forEach((item) => {\n\t\t\t\t\tif (this.savedEpic && this.savedEpic.id === item.id)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.selected = true;\n\t\t\t\t\t\titem.sort = 1;\n\n\t\t\t\t\t\tthis.selector.addTag(item);\n\t\t\t\t\t\tthis.updateInputValue(item.id);\n\t\t\t\t\t}\n\t\t\t\t\tthis.selector.getDialog().addItem(item);\n\t\t\t\t});\n\t\t\t\tthis.selector.getDialog().hideLoader();\n\n\t\t\t\treturn true;\n\t\t\t})\n\t\t\t.catch((response) => this.showErrorAlert(response))\n\t\t;\n\t}\n\n\tupdateInputValue(epicId: number)\n\t{\n\t\tthis.inputNode.value = parseInt(epicId, 10);\n\t}\n\n\tgetEpics(): Promise\n\t{\n\t\treturn ajax.runComponentAction(\n\t\t\t'bitrix:tasks.scrum.epic.selector',\n\t\t\t'getEpics',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tgroupId: this.groupId\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then((response) => {\n\t\t\t\tconst epics = response.data;\n\t\t\t\tif (Type.isNull(epics))\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tconst list = [];\n\t\t\t\tepics.forEach((epic: Epic) => {\n\t\t\t\t\tlist.push(this.getEpicDialogItem(epic));\n\t\t\t\t});\n\n\t\t\t\tthis.listEpics.set(this.groupId, list);\n\n\t\t\t\treturn list;\n\t\t\t})\n\t\t\t.catch((response) => this.showErrorAlert(response))\n\t\t;\n\t}\n\n\tgetEpicDialogItem(epic: Epic): Object\n\t{\n\t\tconst avatar = '/bitrix/components/bitrix/tasks.scrum.epic.selector/templates/.default'\n\t\t\t+ '/images/search-hashtag-green.svg'\n\t\t;\n\n\t\treturn {\n\t\t\tid: epic.id,\n\t\t\tentityId: 'epic',\n\t\t\ttitle: epic.name,\n\t\t\ttabs: 'recents',\n\t\t\tavatar: avatar\n\t\t};\n\t}\n\n\tcreateEpic(epicName: string): Promise\n\t{\n\t\treturn ajax.runAction(\n\t\t\t'bitrix:tasks.scrum.epic.createEpic',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\tname: epicName\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then((response) => {\n\t\t\t\treturn response.data;\n\t\t\t})\n\t\t\t.catch((response) => this.showErrorAlert(response))\n\t\t;\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TSE_SELECTOR_ERROR_POPUP_TITLE'));\n\n\t\t\t\ttop.BX.UI.Dialogs.MessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Type} from 'main.core';\n\nimport {ViewSelector} from './view';\nimport {EditSelector} from './edit';\n\nimport '../css/base.css';\n\ntype Params = {\n\tgroupId: number,\n\ttaskId: number,\n\tepic: ?Epic,\n\tcanEdit: 'Y' | 'N',\n\tmode: 'edit' | 'view',\n\tinputName: string\n}\n\ntype Epic = {\n\tid: number,\n\tgroupId: number,\n\tname: string,\n\tdescription: string,\n\tcreatedBy: number,\n\tmodifiedBy: number,\n\tcolor: string\n}\n\nexport class EpicSelector\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.taskId = parseInt(params.taskId, 10);\n\t\tthis.epic = Type.isPlainObject(params.epic) ? params.epic : null;\n\t\tthis.canEdit = params.canEdit === 'Y';\n\t\tthis.mode = params.mode === 'edit' ? 'edit' : 'view';\n\t\tthis.inputName = params.inputName;\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tif (this.mode === 'view')\n\t\t{\n\t\t\t(new ViewSelector({\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\ttaskId: this.taskId,\n\t\t\t\tepic: this.epic,\n\t\t\t\tcanEdit: this.canEdit\n\t\t\t}))\n\t\t\t\t.renderTo(container)\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t(new EditSelector({\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\ttaskId: this.taskId,\n\t\t\t\tepic: this.epic,\n\t\t\t\tinputName: this.inputName\n\t\t\t}))\n\t\t\t\t.renderTo(container)\n\t\t\t;\n\t\t}\n\t}\n}"],"names":["ViewSelector","params","groupId","taskId","epic","canEdit","dialog","node","nameNode","selectorNode","EventEmitter","subscribe","onChangeTaskProject","bind","container","Dom","append","render","Tag","renderName","renderSelector","baseEvent","getCompatData","parseInt","updateSelector","Type","isNull","colorBorder","convertHexToRGBA","color","colorBackground","Text","encode","name","getButtonText","buttonNode","firstElementChild","Event","onClick","isOpen","hide","show","Dialog","id","getRandom","targetNode","width","height","multiple","dropdownMode","enableSearch","compactView","hideOnDeselect","selectedItems","items","searchOptions","allowCreateItem","footerOptions","label","Loc","getMessage","events","event","Promise","resolve","getData","searchQuery","createEpic","getQuery","then","epicDialogItem","getEpicDialogItem","selected","sort","addItem","tagSelectorOptions","textBoxWidth","getSelectedItems","epicId","length","getId","changeTaskEpic","showLoader","getEpics","epics","selectedItem","forEach","item","hideLoader","response","showErrorAlert","textContent","remove","insertBefore","replace","ajax","runComponentAction","mode","data","list","push","avatar","entityId","title","tabs","epicName","runAction","hexCode","opacity","hex","r","substring","g","b","alertTitle","isUndefined","errors","firstError","shift","errorCode","code","message","top","BX","UI","Dialogs","MessageBox","alert","EditSelector","savedEpic","inputName","selector","listEpics","Map","inputNode","onProjectSelected","onProjectPreselected","addClass","renderInput","buildSelector","renderTo","value","TagSelector","dialogOptions","getTarget","updateInputValue","setTimeout","tagSelector","getDialog","keyboardEvent","stopPropagation","updateSelectorItems","ID","clear","removeItems","has","addTag","set","EpicSelector","isPlainObject"],"mappings":"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"}