{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Reflection, ajax, Type, Event } from 'main.core';\nimport { Alert, AlertColor } from 'ui.alerts';\nimport { Manager } from 'bizproc.debugger';\n\nconst namespace = Reflection.namespace('BX.Bizproc.Component');\n\nclass DebuggerSessionList\n{\n\tgridId;\n\tcreateDebuggerSessionButton;\n\terrorsContainerDiv;\n\tdocumentSigned;\n\tsignedParameters;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.gridId = options.gridId;\n\t\t\tthis.createDebuggerSessionButton = options.createDebuggerSessionButton;\n\t\t\tthis.errorsContainerDiv = options.errorsContainerDiv;\n\t\t\tthis.documentSigned = options.documentSigned;\n\t\t\tthis.signedParameters = options.signedParameters;\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tif (this.createDebuggerSessionButton)\n\t\t{\n\t\t\tEvent.bind(this.createDebuggerSessionButton, 'click', event => this.createSession());\n\t\t}\n\t}\n\n\tcreateSession()\n\t{\n\t\tManager.Instance.openDebuggerStartPage(this.documentSigned, {analyticsStartType: 'session_list'}).then();\n\t}\n\n\tshowSession(sessionId: string): void\n\t{\n\t\tManager.Instance.openSessionLog(sessionId).then();\n\t}\n\n\trenameSession(sessionId: string): void\n\t{\n\t\tconst grid = this.getGrid();\n\n\t\tgrid.getRows().getById(sessionId)?.select();\n\t\tgrid.getActionsPanel().getPanel().querySelector('#grid_edit_button > .edit').click();\n\t\tgrid.enableActionsPanel();\n\t\tgrid.getPinPanel().pinPanel(true);\n\t}\n\n\tdeleteChosenSessions(): void\n\t{\n\t\tconst grid = this.getGrid();\n\t\tif (grid)\n\t\t{\n\t\t\tthis.deleteSessions(grid.getRows().getSelectedIds());\n\t\t}\n\t}\n\n\tdeleteSessions(sessionIds: Array<string>): void\n\t{\n\t\tajax.runComponentAction('bitrix:bizproc.debugger.session.list', 'deleteSessions', {\n\t\t\tmode: 'class',\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tdata: {sessionIds},\n\t\t}).then((response) => {\n\t\t\tthis.reloadGrid();\n\t\t}).catch((response) => {\n\t\t\tthis.showErrors(response.errors);\n\t\t});\n\t}\n\n\tshowErrors(errors: Array<{message: string}>)\n\t{\n\t\tthis.errorsContainerDiv.style.margin = '10px';\n\n\t\terrors.forEach((error) => {\n\t\t\tconst alert = new Alert({\n\t\t\t\ttext: error.message,\n\t\t\t\tcolor: AlertColor.DANGER,\n\t\t\t\tcloseBtn: true,\n\t\t\t\tanimated: true,\n\t\t\t});\n\n\t\t\talert.renderTo(this.errorsContainerDiv);\n\t\t});\n\t}\n\n\treloadGrid()\n\t{\n\t\tconst grid = this.getGrid();\n\t\tif (grid)\n\t\t{\n\t\t\tgrid.reload();\n\t\t}\n\t}\n\n\tgetGrid()\n\t{\n\t\tif (this.gridId)\n\t\t{\n\t\t\treturn BX.Main.gridManager && BX.Main.gridManager.getInstanceById(this.gridId);\n\t\t}\n\t\treturn null;\n\t}\n}\n\nnamespace.DebuggerSessionList = DebuggerSessionList;"],"names":["namespace","Reflection","DebuggerSessionList","options","Type","isPlainObject","gridId","createDebuggerSessionButton","errorsContainerDiv","documentSigned","signedParameters","Event","bind","event","createSession","Manager","Instance","openDebuggerStartPage","analyticsStartType","then","sessionId","openSessionLog","grid","getGrid","getRows","getById","select","getActionsPanel","getPanel","querySelector","click","enableActionsPanel","getPinPanel","pinPanel","deleteSessions","getSelectedIds","sessionIds","ajax","runComponentAction","mode","data","response","reloadGrid","showErrors","errors","style","margin","forEach","error","alert","Alert","text","message","color","AlertColor","DANGER","closeBtn","animated","renderTo","reload","BX","Main","gridManager","getInstanceById"],"mappings":";;;CAIA,IAAMA,SAAS,GAAGC,oBAAU,CAACD,SAAX,CAAqB,sBAArB,CAAlB;;KAEME;CAQL,+BAAYC,OAAZ,EACA;CAAA;;CACC,QAAIC,cAAI,CAACC,aAAL,CAAmBF,OAAnB,CAAJ,EACA;CACC,WAAKG,MAAL,GAAcH,OAAO,CAACG,MAAtB;CACA,WAAKC,2BAAL,GAAmCJ,OAAO,CAACI,2BAA3C;CACA,WAAKC,kBAAL,GAA0BL,OAAO,CAACK,kBAAlC;CACA,WAAKC,cAAL,GAAsBN,OAAO,CAACM,cAA9B;CACA,WAAKC,gBAAL,GAAwBP,OAAO,CAACO,gBAAhC;CACA;CACD;;;;4BAGD;CAAA;;CACC,UAAI,KAAKH,2BAAT,EACA;CACCI,QAAAA,eAAK,CAACC,IAAN,CAAW,KAAKL,2BAAhB,EAA6C,OAA7C,EAAsD,UAAAM,KAAK;CAAA,iBAAI,KAAI,CAACC,aAAL,EAAJ;CAAA,SAA3D;CACA;CACD;;;qCAGD;CACCC,MAAAA,wBAAO,CAACC,QAAR,CAAiBC,qBAAjB,CAAuC,KAAKR,cAA5C,EAA4D;CAACS,QAAAA,kBAAkB,EAAE;CAArB,OAA5D,EAAkGC,IAAlG;CACA;;;iCAEWC,WACZ;CACCL,MAAAA,wBAAO,CAACC,QAAR,CAAiBK,cAAjB,CAAgCD,SAAhC,EAA2CD,IAA3C;CACA;;;mCAEaC,WACd;CAAA;;CACC,UAAME,IAAI,GAAG,KAAKC,OAAL,EAAb;CAEA,+BAAAD,IAAI,CAACE,OAAL,GAAeC,OAAf,CAAuBL,SAAvB,iFAAmCM,MAAnC;CACAJ,MAAAA,IAAI,CAACK,eAAL,GAAuBC,QAAvB,GAAkCC,aAAlC,CAAgD,2BAAhD,EAA6EC,KAA7E;CACAR,MAAAA,IAAI,CAACS,kBAAL;CACAT,MAAAA,IAAI,CAACU,WAAL,GAAmBC,QAAnB,CAA4B,IAA5B;CACA;;;4CAGD;CACC,UAAMX,IAAI,GAAG,KAAKC,OAAL,EAAb;;CACA,UAAID,IAAJ,EACA;CACC,aAAKY,cAAL,CAAoBZ,IAAI,CAACE,OAAL,GAAeW,cAAf,EAApB;CACA;CACD;;;oCAEcC,YACf;CAAA;;CACCC,MAAAA,cAAI,CAACC,kBAAL,CAAwB,sCAAxB,EAAgE,gBAAhE,EAAkF;CACjFC,QAAAA,IAAI,EAAE,OAD2E;CAEjF7B,QAAAA,gBAAgB,EAAE,KAAKA,gBAF0D;CAGjF8B,QAAAA,IAAI,EAAE;CAACJ,UAAAA,UAAU,EAAVA;CAAD;CAH2E,OAAlF,EAIGjB,IAJH,CAIQ,UAACsB,QAAD,EAAc;CACrB,QAAA,MAAI,CAACC,UAAL;CACA,OAND,WAMS,UAACD,QAAD,EAAc;CACtB,QAAA,MAAI,CAACE,UAAL,CAAgBF,QAAQ,CAACG,MAAzB;CACA,OARD;CASA;;;gCAEUA,QACX;CAAA;;CACC,WAAKpC,kBAAL,CAAwBqC,KAAxB,CAA8BC,MAA9B,GAAuC,MAAvC;CAEAF,MAAAA,MAAM,CAACG,OAAP,CAAe,UAACC,KAAD,EAAW;CACzB,YAAMC,KAAK,GAAG,IAAIC,eAAJ,CAAU;CACvBC,UAAAA,IAAI,EAAEH,KAAK,CAACI,OADW;CAEvBC,UAAAA,KAAK,EAAEC,oBAAU,CAACC,MAFK;CAGvBC,UAAAA,QAAQ,EAAE,IAHa;CAIvBC,UAAAA,QAAQ,EAAE;CAJa,SAAV,CAAd;CAOAR,QAAAA,KAAK,CAACS,QAAN,CAAe,MAAI,CAAClD,kBAApB;CACA,OATD;CAUA;;;kCAGD;CACC,UAAMc,IAAI,GAAG,KAAKC,OAAL,EAAb;;CACA,UAAID,IAAJ,EACA;CACCA,QAAAA,IAAI,CAACqC,MAAL;CACA;CACD;;;+BAGD;CACC,UAAI,KAAKrD,MAAT,EACA;CACC,eAAOsD,EAAE,CAACC,IAAH,CAAQC,WAAR,IAAuBF,EAAE,CAACC,IAAH,CAAQC,WAAR,CAAoBC,eAApB,CAAoC,KAAKzD,MAAzC,CAA9B;CACA;;CACD,aAAO,IAAP;CACA;;;;;CAGFN,SAAS,CAACE,mBAAV,GAAgCA,mBAAhC;;;;"}