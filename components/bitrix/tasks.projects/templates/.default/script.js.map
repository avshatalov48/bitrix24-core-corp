{"version":3,"file":"script.js","sources":["../../../../../../../main/install/components/bitrix/main.ui.grid/templates/.default/src/js/cell-action-state.js","src/actions-controller.js","src/filter/filter.js","src/members-popup.js","src/grid.js","src/pull-controller.js","src/tourguide/first-project-creation-tour-guide.js","src/tourguide/tour-guide-controller.js","src/controller.js"],"sourcesContent":["import {Reflection} from 'main.core';\n\n/**\n * @memberOf BX.Grid\n */\nexport class CellActionState\n{\n\tstatic SHOW_BY_HOVER = 'main-grid-cell-content-action-by-hover';\n\tstatic ACTIVE = 'main-grid-cell-content-action-active';\n}\n\nconst namespace = Reflection.namespace('BX.Grid');\nnamespace.CellActionState = CellActionState;","import {Dom, Loc, Runtime} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {CellActionState} from '../../../../../../../../main/install/components/bitrix/main.ui.grid/templates/.default/src/js/cell-action-state';\n\nexport class ActionsController\n{\n\tstatic options;\n\n\tstatic setOptions(options)\n\t{\n\t\tActionsController.options = options;\n\t}\n\n\tstatic setActionsPanel(actionsPanel)\n\t{\n\t\tActionsController.actionsPanel = actionsPanel;\n\t}\n\n\tstatic doAction(action, groupId, data = [])\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tBX.ajax.runComponentAction('bitrix:tasks.projects', 'processAction', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\taction,\n\t\t\t\t\tdata,\n\t\t\t\t\tids: ActionsController.getActionIds(groupId) || [],\n\t\t\t\t},\n\t\t\t\tsignedParameters: ActionsController.options.signedParameters,\n\t\t\t}).then(\n\t\t\t\t() => resolve(),\n\t\t\t\t() => reject()\n\t\t\t).catch(\n\t\t\t\t() => reject()\n\t\t\t);\n\n\t\t\tActionsController.hideActionsPanel();\n\t\t\tActionsController.unselectRows();\n\t\t});\n\t}\n\n\tstatic getActionIds(id)\n\t{\n\t\tif (id !== undefined)\n\t\t{\n\t\t\treturn [id];\n\t\t}\n\n\t\tconst selected = ActionsController.getSelectedRows();\n\t\tif (selected.length === 0)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn selected.map((row) => {\n\t\t\treturn row.getDataset().id;\n\t\t});\n\t}\n\n\tstatic getSelectedRows()\n\t{\n\t\treturn ActionsController.getGridInstance().getRows().getSelected();\n\t}\n\n\tstatic sendJoinRequest(button)\n\t{\n\t\tif (Dom.hasClass(button, 'ui-btn-clock'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tDom.addClass(button, 'ui-btn-clock');\n\n\t\tBX.ajax({\n\t\t\turl: button.getAttribute('bx-request-url'),\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tajax_request: 'Y',\n\t\t\t\tsave: 'Y',\n\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t},\n\t\t\tonsuccess: () => Dom.removeClass(button, 'ui-btn-clock'),\n\t\t\tonfailure: () => Dom.removeClass(button, 'ui-btn-clock'),\n\t\t});\n\n\t\tActionsController.hideActionsPanel();\n\t\tActionsController.unselectRows();\n\t}\n\n\tstatic sendAcceptRequest(userGroupRelationId, url)\n\t{\n\t\tBX.ajax({\n\t\t\turl: url,\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\taction: 'accept',\n\t\t\t\tmax_count: 1,\n\t\t\t\tchecked_0: 'Y',\n\t\t\t\ttype_0: 'INVITE_GROUP',\n\t\t\t\tid_0: userGroupRelationId,\n\t\t\t\ttype: 'in',\n\t\t\t\tajax_request: 'Y',\n\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t},\n\t\t\tonsuccess: result => {},\n\t\t\tonfailure: result => console.log(result),\n\t\t});\n\n\t\tActionsController.hideActionsPanel();\n\t\tActionsController.unselectRows();\n\t}\n\n\tstatic sendDenyRequest(userGroupRelationId, url)\n\t{\n\t\tActionsController.sendCancelRequest(userGroupRelationId, url);\n\t}\n\n\tstatic sendCancelRequest(userGroupRelationId, url)\n\t{\n\t\tBX.ajax({\n\t\t\turl: url,\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\taction: 'reject',\n\t\t\t\tmax_count: 1,\n\t\t\t\tchecked_0: 'Y',\n\t\t\t\ttype_0: 'INVITE_GROUP',\n\t\t\t\tid_0: userGroupRelationId,\n\t\t\t\ttype: 'out',\n\t\t\t\tajax_request: 'Y',\n\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t},\n\t\t\tonsuccess: result => {},\n\t\t\tonfailure: result => console.log(result),\n\t\t});\n\n\t\tActionsController.hideActionsPanel();\n\t\tActionsController.unselectRows();\n\t}\n\n\tstatic hideActionsPanel()\n\t{\n\t\tActionsController.options.actionsPanel.hidePanel();\n\t}\n\n\tstatic unselectRows()\n\t{\n\t\tActionsController.getGridInstance().getRows().unselectAll();\n\t}\n\n\tstatic getGridInstance()\n\t{\n\t\treturn BX.Main.gridManager.getById(ActionsController.options.gridId).instance;\n\t}\n\n\tstatic changePin(groupId, event: BaseEvent)\n\t{\n\t\tconst {button} = event.getData();\n\n\t\tif (Dom.hasClass(button, CellActionState.ACTIVE))\n\t\t{\n\t\t\tActionsController.doAction('unpin', groupId).then(() => {\n\t\t\t\tDom.removeClass(button, CellActionState.ACTIVE);\n\t\t\t\tDom.addClass(button, CellActionState.SHOW_BY_HOVER);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tActionsController.doAction('pin', groupId).then(() => {\n\t\t\t\tDom.addClass(button, CellActionState.ACTIVE);\n\t\t\t\tDom.removeClass(button, CellActionState.SHOW_BY_HOVER);\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic onTagClick(field)\n\t{\n\t\tconst {filter} = ActionsController.options;\n\t\tfilter.toggleByField(field);\n\t}\n\n\tstatic onTagAddClick(groupId, event)\n\t{\n\t\tRuntime.loadExtension('ui.entity-selector').then(exports => {\n\t\t\tconst onRowUpdate = (event: BaseEvent) => {\n\t\t\t\tconst {id} = event.getData();\n\t\t\t\tif (id === groupId)\n\t\t\t\t{\n\t\t\t\t\tconst row = ActionsController.getGridInstance().getRows().getById(id);\n\t\t\t\t\tconst button = row.getCellById('TAGS').querySelector('.main-grid-tag-add');\n\n\t\t\t\t\tdialog.setTargetNode(button);\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst onRowRemove = (event: BaseEvent) => {\n\t\t\t\tconst {id} = event.getData();\n\t\t\t\tif (id === groupId)\n\t\t\t\t{\n\t\t\t\t\tdialog.hide();\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst onTagsChange = (event: BaseEvent) => {\n\t\t\t\tconst dialog = event.getTarget();\n\t\t\t\tconst tags = dialog.getSelectedItems().map(item => item.getId());\n\n\t\t\t\tvoid ActionsController.doAction('update', groupId, {KEYWORDS: tags.join(',')});\n\t\t\t};\n\t\t\tconst {Dialog} = exports;\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: event.getData().button,\n\t\t\t\tenableSearch: true,\n\t\t\t\twidth: 350,\n\t\t\t\theight: 400,\n\t\t\t\tmultiple: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tcompactView: true,\n\t\t\t\tcontext: 'PROJECT_TAG',\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project-tag',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tgroupId,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: true,\n\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\tlabel: Loc.getMessage('TASKS_PROJECTS_ENTITY_SELECTOR_TAG_SEARCH_FOOTER_ADD'),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tfooter: BX.SocialNetwork.EntitySelector.Footer,\n\t\t\t\tfooterOptions: {\n\t\t\t\t\ttagCreationLabel: true,\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'onShow': () => {\n\t\t\t\t\t\tEventEmitter.subscribe('Tasks.Projects.Grid:RowUpdate', onRowUpdate);\n\t\t\t\t\t\tEventEmitter.subscribe('Tasks.Projects.Grid:RowRemove', onRowRemove);\n\t\t\t\t\t},\n\t\t\t\t\t'onHide': () => {\n\t\t\t\t\t\tEventEmitter.unsubscribe('Tasks.Projects.Grid:RowUpdate', onRowUpdate);\n\t\t\t\t\t\tEventEmitter.unsubscribe('Tasks.Projects.Grid:RowRemove', onRowRemove);\n\t\t\t\t\t},\n\t\t\t\t\t'Search:onItemCreateAsync': (event: BaseEvent) => {\n\t\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\t\tconst {searchQuery} = event.getData();\n\t\t\t\t\t\t\tconst name = searchQuery.getQuery().toLowerCase();\n\t\t\t\t\t\t\tconst dialog: Dialog = event.getTarget();\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\t\t\t\tid: name,\n\t\t\t\t\t\t\t\t\tentityId: 'project-tag',\n\t\t\t\t\t\t\t\t\ttitle: name,\n\t\t\t\t\t\t\t\t\ttabs: 'all',\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\titem.select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onSelect': onTagsChange,\n\t\t\t\t\t'Item:onDeselect': onTagsChange,\n\t\t\t\t},\n\t\t\t});\n\t\t\tdialog.show();\n\t\t});\n\t}\n}","import {Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class Filter\n{\n\tconstructor(options)\n\t{\n\t\tthis.filter = BX.Main.filterManager.getById(options.filterId);\n\n\t\tthis.init();\n\t\tthis.bindEvents();\n\t}\n\n\tinit()\n\t{\n\t\tthis.updateFields();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t\tEventEmitter.subscribe('Tasks.Toolbar:onItem', this.onCounterClick.bind(this));\n\t}\n\n\tonFilterApply()\n\t{\n\t\tthis.updateFields();\n\t}\n\n\tupdateFields()\n\t{\n\t\tthis.fields = this.filter.getFilterFieldsValues();\n\t}\n\n\tonCounterClick(event)\n\t{\n\t\tconst data = event.getData();\n\n\t\tif (data.counter && data.counter.filter)\n\t\t{\n\t\t\tthis.toggleByField({[data.counter.filterField]: data.counter.filterValue});\n\t\t}\n\t}\n\n\tisFilteredByField(field)\n\t{\n\t\tif (!Object.keys(this.fields).includes(field))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Type.isArray(this.fields[field]))\n\t\t{\n\t\t\treturn this.fields[field].length > 0;\n\t\t}\n\n\t\treturn this.fields[field] !== '';\n\t}\n\n\tisFilteredByFieldValue(field, value)\n\t{\n\t\treturn this.isFilteredByField(field) && this.fields[field] === value;\n\t}\n\n\ttoggleByField(field)\n\t{\n\t\tconst name = Object.keys(field)[0];\n\t\tconst value = field[name];\n\n\t\tif (!this.isFilteredByFieldValue(name, value))\n\t\t{\n\t\t\tthis.filter.getApi().extendFilter({[name]: value});\n\t\t\treturn;\n\t\t}\n\n\t\tthis.filter.getFilterFields().forEach((field) => {\n\t\t\tif (field.getAttribute('data-name') === name)\n\t\t\t{\n\t\t\t\tthis.filter.getFields().deleteField(field);\n\t\t\t}\n\t\t});\n\n\t\tthis.filter.getSearch().apply();\n\t}\n}","import {Dom, Event, Loc, Tag, Type} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {PopupWindowManager} from 'main.popup';\n\nexport class MembersPopup\n{\n\tconstructor(options)\n\t{\n\t\tthis.signedParameters = options.signedParameters;\n\t}\n\n\tshow(groupId, bindNode, type = 'all')\n\t{\n\t\tif (this.isPopupShown)\n\t\t{\n\t\t\tthis.popup.destroy();\n\t\t}\n\n\t\tthis.groupId = groupId;\n\n\t\tthis.resetPopupData();\n\t\tthis.changeType(type, false);\n\n\t\tthis.popup = PopupWindowManager.create({\n\t\t\tid: 'projects-members-popup-menu',\n\t\t\tclassName: 'tasks-projects-members-popup',\n\t\t\tbindElement: bindNode,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tlightShadow: true,\n\t\t\tbindOptions: {\n\t\t\t\tposition: 'bottom',\n\t\t\t},\n\t\t\tanimationOptions: {\n\t\t\t\tshow: {\n\t\t\t\t\ttype: 'opacity-transform',\n\t\t\t\t},\n\t\t\t\tclose: {\n\t\t\t\t\ttype: 'opacity',\n\t\t\t\t},\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\tthis.loader = null;\n\t\t\t\t\tthis.isPopupShown = false;\n\t\t\t\t},\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.popup.destroy();\n\t\t\t\t},\n\t\t\t\tonAfterPopupShow: (popup) => {\n\t\t\t\t\tpopup.contentContainer.appendChild(this.renderContainer());\n\n\t\t\t\t\tthis.showLoader();\n\t\t\t\t\tthis.showUsers(groupId, type);\n\n\t\t\t\t\tthis.isPopupShown = true;\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tthis.popupScroll(groupId, type);\n\t\tthis.popup.show();\n\t}\n\n\trenderContainer()\n\t{\n\t\treturn Tag.render`\n\t\t\t<span class=\"tasks-projects-members-popup-container\">\n\t\t\t\t<span class=\"tasks-projects-members-popup-head\">\n\t\t\t\t\t${this.popupData.all.tab}\n\t\t\t\t\t${this.popupData.heads.tab}\n\t\t\t\t\t${this.popupData.members.tab}\n\t\t\t\t</span>\n\t\t\t\t<span class=\"tasks-projects-members-popup-body\">\n\t\t\t\t\t<div class=\"tasks-projects-members-popup-content\">\n\t\t\t\t\t\t<div class=\"tasks-projects-members-popup-content-box\">\n\t\t\t\t\t\t\t${this.getCurrentPopupData().innerContainer}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</span>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tpopupScroll(groupId, type)\n\t{\n\t\tif (!BX.type.isDomNode(this.getCurrentPopupData().innerContainer))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEvent.bind(this.getCurrentPopupData().innerContainer, 'scroll', (event) => {\n\t\t\tconst area = event.target;\n\t\t\tif (area.scrollTop > (area.scrollHeight - area.offsetHeight) / 1.5)\n\t\t\t{\n\t\t\t\tthis.showUsers(groupId, type);\n\t\t\t\tEvent.unbindAll(this.getCurrentPopupData().innerContainer);\n\t\t\t}\n\t\t});\n\t};\n\n\tshowUsers(groupId, type)\n\t{\n\t\tBX.ajax.runComponentAction('bitrix:tasks.projects', 'getPopupMembers', {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tgroupId,\n\t\t\t\ttype,\n\t\t\t\tpage: this.getCurrentPopupData().currentPage,\n\t\t\t},\n\t\t\tsignedParameters: this.signedParameters,\n\t\t}).then(\n\t\t\t(response) => {\n\t\t\t\tif (this.groupId !== groupId || this.currentType !== type)\n\t\t\t\t{\n\t\t\t\t\tthis.hideLoader();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (response.data.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.renderUsers(response.data);\n\t\t\t\t\tthis.popupScroll(groupId, this.currentType);\n\t\t\t\t}\n\t\t\t\telse if (!this.getCurrentPopupData().innerContainer.hasChildNodes())\n\t\t\t\t{\n\t\t\t\t\tthis.getCurrentPopupData().innerContainer.innerText = Loc.getMessage('TASKS_PROJECTS_MEMBERS_POPUP_EMPTY');\n\t\t\t\t}\n\t\t\t\tthis.getCurrentPopupData().currentPage++;\n\t\t\t\tthis.hideLoader();\n\t\t\t},\n\t\t\t() => this.hideLoader()\n\t\t);\n\t}\n\n\trenderUsers(users)\n\t{\n\t\tObject.values(users).forEach((user) => {\n\t\t\tif (this.getCurrentPopupData().renderedUsers.indexOf(user.ID) >= 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.getCurrentPopupData().renderedUsers.push(user.ID);\n\n\t\t\tthis.getCurrentPopupData().innerContainer.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<a class=\"tasks-projects-members-popup-item\" href=\"${user['HREF']}\" target=\"_blank\">\n\t\t\t\t\t\t<span class=\"tasks-projects-members-popup-avatar-new\">\n\t\t\t\t\t\t\t${this.getAvatar(user)}\n\t\t\t\t\t\t\t<span class=\"tasks-projects-members-popup-avatar-status-icon\"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"tasks-projects-members-popup-name\">${user['FORMATTED_NAME']}</span>\n\t\t\t\t\t</a>\n\t\t\t\t`\n\t\t\t);\n\t\t})\n\t}\n\n\tgetAvatar(user)\n\t{\n\t\tif (Type.isStringFilled(user['PHOTO']))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-icon ui-icon-common-user tasks-projects-members-popup-avatar-img\">\n\t\t\t\t\t<i style=\"background-image: url('${user['PHOTO']}')\"></i>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-icon ui-icon-common-user tasks-projects-members-popup-avatar-img\"><i></i></div>\n\t\t`;\n\t}\n\n\tshowLoader()\n\t{\n\t\tif (!this.loader)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.popup.getPopupContainer().querySelector('.tasks-projects-members-popup-content'),\n\t\t\t\tsize: 40,\n\t\t\t});\n\t\t}\n\t\tvoid this.loader.show();\n\t}\n\n\thideLoader()\n\t{\n\t\tif (this.loader)\n\t\t{\n\t\t\tvoid this.loader.hide();\n\t\t\tthis.loader = null;\n\t\t}\n\t}\n\n\tchangeType(newType, loadUsers = true)\n\t{\n\t\tconst oldType = this.currentType;\n\n\t\tthis.currentType = newType;\n\n\t\tObject.values(this.popupData).forEach((item) => {\n\t\t\tDom.removeClass(item.tab, 'tasks-projects-members-popup-head-item-current');\n\t\t});\n\t\tDom.addClass(this.getCurrentPopupData().tab, 'tasks-projects-members-popup-head-item-current');\n\n\t\tif (oldType)\n\t\t{\n\t\t\tDom.replace(this.popupData[oldType].innerContainer, this.getCurrentPopupData().innerContainer);\n\t\t}\n\n\t\tif (loadUsers && this.getCurrentPopupData().currentPage === 1)\n\t\t{\n\t\t\tthis.showLoader();\n\t\t\tthis.showUsers(this.groupId, newType);\n\t\t}\n\t}\n\n\tresetPopupData()\n\t{\n\t\tthis.popupData = {\n\t\t\tall: {\n\t\t\t\tcurrentPage: 1,\n\t\t\t\trenderedUsers: [],\n\t\t\t\ttab: Tag.render`\n\t\t\t\t\t<span class=\"tasks-projects-members-popup-head-item\" onclick=\"${this.changeType.bind(this, 'all')}\">\n\t\t\t\t\t\t<span class=\"tasks-projects-members-popup-head-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_PROJECTS_MEMBERS_POPUP_TITLE_ALL')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t`,\n\t\t\t\tinnerContainer: Tag.render`<div class=\"tasks-projects-members-popup-inner\"></div>`,\n\t\t\t},\n\t\t\theads: {\n\t\t\t\tcurrentPage: 1,\n\t\t\t\trenderedUsers: [],\n\t\t\t\ttab: Tag.render`\n\t\t\t\t\t<span class=\"tasks-projects-members-popup-head-item\" onclick=\"${this.changeType.bind(this, 'heads')}\">\n\t\t\t\t\t\t<span class=\"tasks-projects-members-popup-head-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_PROJECTS_MEMBERS_POPUP_TITLE_HEADS')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t`,\n\t\t\t\tinnerContainer: Tag.render`<div class=\"tasks-projects-members-popup-inner\"></div>`,\n\t\t\t},\n\t\t\tmembers: {\n\t\t\t\tcurrentPage: 1,\n\t\t\t\trenderedUsers: [],\n\t\t\t\ttab: Tag.render`\n\t\t\t\t\t<span class=\"tasks-projects-members-popup-head-item\" onclick=\"${this.changeType.bind(this, 'members')}\">\n\t\t\t\t\t\t<span class=\"tasks-projects-members-popup-head-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_PROJECTS_MEMBERS_POPUP_TITLE_MEMBERS')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t`,\n\t\t\t\tinnerContainer: Tag.render`<div class=\"tasks-projects-members-popup-inner\"></div>`,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCurrentPopupData()\n\t{\n\t\treturn this.popupData[this.currentType];\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nexport class Grid\n{\n\tstatic get classes()\n\t{\n\t\treturn {\n\t\t\thighlighted: 'task-projects-item-highlighted',\n\t\t\tpinned: 'tasks-projects-row-pinned',\n\t\t};\n\t}\n\n\tconstructor(options)\n\t{\n\t\tthis.pageSize = 10;\n\n\t\tthis.grid = BX.Main.gridManager.getInstanceById(options.gridId);\n\t\tthis.stub = options.gridStub;\n\n\t\tthis.sort = options.sort;\n\t\tthis.actionsPanel = options.actionsPanel;\n\n\t\tthis.items = new Map();\n\t\tthis.fillItems(options.items);\n\n\t\tthis.bindEvents();\n\t\tthis.colorPinnedRows();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.grid:sort', this.onColumnSort.bind(this));\n\t\tEventEmitter.subscribe('BX.Main.grid:paramsUpdated', this.onParamsUpdated.bind(this));\n\t}\n\n\tonColumnSort(event: BaseEvent)\n\t{\n\t\tconst data = event.getData();\n\t\tconst grid = data[1];\n\t\tconst column = data[0];\n\n\t\tif (grid === this.grid)\n\t\t{\n\t\t\tthis.sort = {};\n\t\t\tthis.sort[column.sort_by] = column.sort_order;\n\t\t}\n\t}\n\n\tonParamsUpdated()\n\t{\n\t\tconst newItems = this.getRows().map(row => row.getId()).filter(id => id !== 'template_0');\n\t\tconst flipped = newItems.reduce((obj, value) => ({...obj, [value]: null}), {});\n\n\t\tthis.clearItems();\n\t\tthis.fillItems(flipped);\n\t\tthis.colorPinnedRows();\n\t}\n\n\taddRow(id, data, params)\n\t{\n\t\tconst options = {\n\t\t\tid: id,\n\t\t\tcolumns: data.content,\n\t\t\tactions: data.actions,\n\t\t\tcellActions: data.cellActions,\n\t\t\tcounters: data.counters,\n\t\t};\n\t\tconst moveParams = params.moveParams || {};\n\n\t\tif (moveParams.rowBefore)\n\t\t{\n\t\t\toptions.insertAfter = moveParams.rowBefore;\n\t\t}\n\t\telse if (moveParams.rowAfter)\n\t\t{\n\t\t\toptions.insertBefore = moveParams.rowAfter;\n\t\t}\n\t\telse\n\t\t{\n\t\t\toptions.append = true;\n\t\t}\n\n\t\tif (this.items.size > this.getCurrentPage() * this.pageSize)\n\t\t{\n\t\t\tconst lastRowId = this.getLastRowId();\n\n\t\t\tthis.removeItem(lastRowId);\n\t\t\tDom.remove(this.getRowNodeById(lastRowId));\n\t\t\tthis.showMoreButton();\n\t\t}\n\n\t\tthis.hideStub();\n\t\tthis.getRealtime().addRow(options);\n\t\tthis.colorPinnedRows();\n\n\t\tEventEmitter.emit('Tasks.Projects.Grid:RowAdd', {id});\n\t}\n\n\tupdateRow(id, data, params)\n\t{\n\t\tconst row = this.getRowById(id);\n\t\trow.setCellsContent(data.content);\n\t\trow.setActions(data.actions);\n\t\trow.setCellActions(data.cellActions);\n\t\trow.setCounters(data.counters);\n\n\t\tthis.resetRows();\n\t\tthis.moveRow(id, (params.moveParams || {}));\n\t\tthis.highlightRow(id, (params.highlightParams || {})).then(() => this.colorPinnedRows(), () => {});\n\n\t\tthis.grid.bindOnRowEvents();\n\n\t\tEventEmitter.emit('Tasks.Projects.Grid:RowUpdate', {id});\n\t}\n\n\tremoveRow(id)\n\t{\n\t\tif (!this.isRowExist(id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.grid.removeRow(id);\n\n\t\tEventEmitter.emit('Tasks.Projects.Grid:RowRemove', {id});\n\t}\n\n\tmoveRow(rowId, params): void\n\t{\n\t\tif (params.skip)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst rowBefore = params.rowBefore || 0;\n\t\tconst rowAfter = params.rowAfter || 0;\n\n\t\tif (rowBefore)\n\t\t{\n\t\t\tthis.grid.getRows().insertAfter(rowId, rowBefore);\n\t\t}\n\t\telse if (rowAfter)\n\t\t{\n\t\t\tthis.grid.getRows().insertBefore(rowId, rowAfter);\n\t\t}\n\t}\n\n\thighlightRow(rowId, params): Promise\n\t{\n\t\tparams = params || {};\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (!this.isRowExist(rowId))\n\t\t\t{\n\t\t\t\treject();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (params.skip)\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst node = this.getRowNodeById(rowId);\n\t\t\tconst isPinned = Dom.hasClass(node, Grid.classes.pinned);\n\n\t\t\tif (isPinned)\n\t\t\t{\n\t\t\t\tDom.removeClass(node, Grid.classes.pinned);\n\t\t\t}\n\n\t\t\tDom.addClass(node, Grid.classes.highlighted);\n\t\t\tsetTimeout(() => {\n\t\t\t\tDom.removeClass(node, Grid.classes.highlighted);\n\t\t\t\tif (isPinned)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(node, Grid.classes.pinned);\n\t\t\t\t}\n\t\t\t\tresolve();\n\t\t\t}, 900);\n\t\t});\n\t}\n\n\tcolorPinnedRows()\n\t{\n\t\tthis.getRows().forEach((row) => {\n\t\t\tconst node = row.getNode();\n\t\t\tthis.getIsPinned(row.getId())\n\t\t\t\t? Dom.addClass(node, Grid.classes.pinned)\n\t\t\t\t: Dom.removeClass(node, Grid.classes.pinned)\n\t\t\t;\n\t\t});\n\t}\n\n\tresetRows()\n\t{\n\t\tthis.grid.getRows().reset();\n\t}\n\n\tgetRows()\n\t{\n\t\treturn this.grid.getRows().getBodyChild();\n\t}\n\n\tgetFirstRowId()\n\t{\n\t\tconst firstRow = this.grid.getRows().getBodyFirstChild();\n\t\treturn (firstRow ? this.getRowProperty(firstRow, 'id') : 0);\n\t}\n\n\tgetLastRowId()\n\t{\n\t\tconst lastRow = this.grid.getRows().getBodyLastChild();\n\t\treturn (lastRow ? this.getRowProperty(lastRow, 'id') : 0);\n\t}\n\n\tgetLastPinnedRowId()\n\t{\n\t\tconst pinnedRows = Object.values(this.getRows()).filter(row => this.getIsPinned(row.getId()));\n\t\tconst keys = Object.keys(pinnedRows);\n\n\t\tif (keys.length > 0)\n\t\t{\n\t\t\treturn pinnedRows[keys[keys.length - 1]].getId();\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tgetIsPinned(rowId)\n\t{\n\t\treturn this.isRowExist(rowId)\n\t\t\t&& Type.isDomNode(this.getRowNodeById(rowId).querySelector('.main-grid-cell-content-action-pin.main-grid-cell-content-action-active'));\n\t}\n\n\tgetRowProperty(row, propertyName)\n\t{\n\t\treturn BX.data(row.getNode(), propertyName);\n\t}\n\n\tgetRowById(id)\n\t{\n\t\treturn this.grid.getRows().getById(id);\n\t}\n\n\tgetRowNodeById(id)\n\t{\n\t\treturn this.getRowById(id).getNode();\n\t}\n\n\tisRowExist(id)\n\t{\n\t\treturn this.getRowById(id) !== null;\n\t}\n\n\tgetCurrentPage()\n\t{\n\t\tconst currentPage = this.grid.getContainer().querySelector('.modern-page-current');\n\t\treturn (currentPage ? currentPage.innerText : 1);\n\t}\n\n\tisActivityRealtimeMode()\n\t{\n\t\treturn this.sort.ACTIVITY_DATE\n\t\t\t&& this.sort.ACTIVITY_DATE === 'desc';\n\t}\n\n\tgetItems()\n\t{\n\t\treturn Array.from(this.items.keys());\n\t}\n\n\thasItem(id)\n\t{\n\t\treturn this.items.has(parseInt(id, 10));\n\t}\n\n\taddItem(id)\n\t{\n\t\tthis.items.set(parseInt(id, 10));\n\t}\n\n\tremoveItem(id)\n\t{\n\t\tthis.items.delete(parseInt(id, 10));\n\t}\n\n\tfillItems(items)\n\t{\n\t\tObject.keys(items).forEach(id => this.addItem(id));\n\t}\n\n\tclearItems()\n\t{\n\t\tthis.items.clear();\n\t}\n\n\tgetRealtime()\n\t{\n\t\treturn this.grid.getRealtime();\n\t}\n\n\tshowStub()\n\t{\n\t\tif (this.stub)\n\t\t{\n\t\t\tthis.getRealtime().showStub({content: this.stub});\n\t\t}\n\t}\n\n\thideStub()\n\t{\n\t\tthis.grid.hideEmptyStub();\n\t}\n\n\tshowMoreButton()\n\t{\n\t\tthis.grid.getMoreButton().getNode().style.display = 'inline-block';\n\t}\n\n\thideMoreButton()\n\t{\n\t\tthis.grid.getMoreButton().getNode().style.display = 'none';\n\t}\n}","import {Grid} from './grid';\n\nexport class PullController\n{\n\tstatic get events()\n\t{\n\t\treturn {\n\t\t\tadd: 'add',\n\t\t\tupdate: 'update',\n\t\t\tremove: 'remove',\n\t\t\tuserAdd: 'userAdd',\n\t\t\tuserUpdate: 'userUpdate',\n\t\t\tuserRemove: 'userRemove',\n\t\t\tpinChanged: 'pinChanged',\n\t\t};\n\t}\n\n\tstatic get counterEvents()\n\t{\n\t\treturn [\n\t\t\t'onAfterTaskAdd',\n\t\t\t'onAfterTaskDelete',\n\t\t\t'onAfterTaskRestore',\n\t\t\t'onAfterTaskView',\n\t\t\t'onAfterTaskMute',\n\t\t\t'onAfterCommentAdd',\n\t\t\t'onAfterCommentDelete',\n\t\t\t'onProjectPermUpdate',\n\t\t];\n\t}\n\n\tstatic get movingProjectEvents()\n\t{\n\t\treturn [\n\t\t\t'onAfterTaskAdd',\n\t\t\t'onAfterCommentAdd',\n\t\t];\n\t}\n\n\tconstructor(options)\n\t{\n\t\tthis.signedParameters = options.signedParameters;\n\n\t\tthis.grid = new Grid(options);\n\n\t\tthis.timer = null;\n\t\tthis.counterData = new Map();\n\t\tthis.userOptions = options.userOptions;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tproject_add: this.onProjectAdd.bind(this),\n\t\t\tproject_update: this.onProjectUpdate.bind(this),\n\t\t\tproject_remove: this.onProjectRemove.bind(this),\n\t\t\tproject_user_add: this.onProjectUserAdd.bind(this),\n\t\t\tproject_user_update: this.onProjectUserUpdate.bind(this),\n\t\t\tproject_user_remove: this.onProjectUserRemove.bind(this),\n\t\t\tproject_user_option_changed: this.onProjectUserOptionChanged.bind(this),\n\t\t\tproject_counter: this.onProjectCounter.bind(this),\n\t\t\tproject_read_all: this.onProjectCommentsReadAll.bind(this),\n\t\t\tcomment_read_all: this.onProjectCommentsReadAll.bind(this),\n\t\t};\n\t}\n\n\tonProjectAdd(data)\n\t{\n\t\tconst params = {\n\t\t\tevent: PullController.events.add,\n\t\t\tmoveParams: {\n\t\t\t\trowBefore: this.grid.getLastPinnedRowId(),\n\t\t\t\trowAfter: this.grid.getFirstRowId(),\n\t\t\t},\n\t\t};\n\n\t\tthis.checkExistence(data.ID).then(\n\t\t\tresponse => this.onCheckExistenceSuccess(response, data.ID, params),\n\t\t\tresponse => console.error(response)\n\t\t);\n\t}\n\n\tonProjectUpdate(data)\n\t{\n\t\tconst params = {\n\t\t\tevent: PullController.events.update,\n\t\t};\n\n\t\tthis.checkExistence(data.ID).then(\n\t\t\tresponse => this.onCheckExistenceSuccess(response, data.ID, params),\n\t\t\tresponse => console.error(response)\n\t\t);\n\t}\n\n\tonProjectRemove(data)\n\t{\n\t\tthis.removeRow(data.ID);\n\t}\n\n\tonProjectUserAdd(data)\n\t{\n\t\tconst params = {\n\t\t\tevent: PullController.events.userAdd,\n\t\t};\n\n\t\tthis.checkExistence(data.GROUP_ID).then(\n\t\t\tresponse => this.onCheckExistenceSuccess(response, data.GROUP_ID, params),\n\t\t\tresponse => console.error(response)\n\t\t);\n\t}\n\n\tonProjectUserUpdate(data)\n\t{\n\t\tconst params = {\n\t\t\tevent: PullController.events.userUpdate,\n\t\t};\n\n\t\tthis.checkExistence(data.GROUP_ID).then(\n\t\t\tresponse => this.onCheckExistenceSuccess(response, data.GROUP_ID, params),\n\t\t\tresponse => console.error(response)\n\t\t);\n\t}\n\n\tonProjectUserRemove(data)\n\t{\n\t\tconst params = {\n\t\t\tevent: PullController.events.userRemove,\n\t\t};\n\n\t\tthis.checkExistence(data.GROUP_ID).then(\n\t\t\tresponse => this.onCheckExistenceSuccess(response, data.GROUP_ID, params),\n\t\t\tresponse => console.error(response)\n\t\t);\n\t}\n\n\tonProjectUserOptionChanged(data)\n\t{\n\t\tswitch (data.OPTION)\n\t\t{\n\t\t\tcase this.userOptions.pinned:\n\t\t\t\tthis.onProjectPinChanged(data);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonProjectPinChanged(data)\n\t{\n\t\tconst params = {\n\t\t\tevent: PullController.events.pinChanged,\n\t\t};\n\n\t\tthis.moveToDirectPlace(data.PROJECT_ID, null, params);\n\t}\n\n\tonProjectCounter(data)\n\t{\n\t\tconst groupId = data.GROUP_ID;\n\t\tconst event = data.EVENT;\n\n\t\tif (!PullController.counterEvents.includes(event))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.timer)\n\t\t{\n\t\t\tthis.timer = setTimeout(() => {\n\t\t\t\tthis.freeCounterQueue();\n\t\t\t}, 1000);\n\t\t}\n\n\t\tif (PullController.movingProjectEvents.includes(event) || !this.counterData.has(groupId))\n\t\t{\n\t\t\tthis.counterData.set(groupId, event);\n\t\t}\n\t}\n\n\tfreeCounterQueue()\n\t{\n\t\tthis.counterData.forEach((event, groupId) => {\n\t\t\tconst params = {\n\t\t\t\tevent,\n\t\t\t\thighlightParams: {\n\t\t\t\t\tskip: true,\n\t\t\t\t},\n\t\t\t};\n\t\t\tif (PullController.movingProjectEvents.includes(event))\n\t\t\t{\n\t\t\t\tparams.moveParams = {\n\t\t\t\t\trowBefore: (this.grid.getIsPinned(groupId) ? 0 : this.grid.getLastPinnedRowId()),\n\t\t\t\t\trowAfter: this.grid.getFirstRowId(),\n\t\t\t\t};\n\t\t\t\tparams.highlightParams = {\n\t\t\t\t\tskip: false,\n\t\t\t\t};\n\t\t\t}\n\t\t\tthis.checkExistence(groupId).then(\n\t\t\t\tresponse => this.onCheckExistenceSuccess(response, groupId, params),\n\t\t\t\tresponse => console.error(response)\n\t\t\t);\n\t\t});\n\t\tthis.counterData.clear();\n\t\tthis.timer = null;\n\t}\n\n\tonProjectCommentsReadAll(data)\n\t{\n\t\tconst groupId = data.GROUP_ID;\n\n\t\tif (groupId)\n\t\t{\n\t\t\tif (this.grid.isRowExist(groupId))\n\t\t\t{\n\t\t\t\tthis.updateCounter([groupId]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.updateCounter(this.grid.getItems());\n\t\t}\n\t}\n\n\tcheckExistence(groupId)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tBX.ajax.runComponentAction('bitrix:tasks.projects', 'checkExistence', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tgroupIds: [groupId],\n\t\t\t\t},\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t}).then(\n\t\t\t\tresponse => resolve(response),\n\t\t\t\tresponse => reject(response)\n\t\t\t);\n\t\t});\n\t}\n\n\tonCheckExistenceSuccess(response, groupId, params)\n\t{\n\t\tif (response.data[groupId] === false)\n\t\t{\n\t\t\tthis.removeRow(groupId);\n\t\t\treturn;\n\t\t}\n\n\t\tconst group = response.data[groupId];\n\n\t\tif (this.grid.isRowExist(groupId))\n\t\t{\n\t\t\tthis.grid.isActivityRealtimeMode()\n\t\t\t\t? this.updateRow(groupId, group, params)\n\t\t\t\t: this.moveToDirectPlace(groupId, group, params)\n\t\t\t;\n\t\t}\n\t\telse if (\n\t\t\tthis.grid.isActivityRealtimeMode()\n\t\t\t&& (PullController.movingProjectEvents.includes(params.event) || params.event === PullController.events.add)\n\t\t)\n\t\t{\n\t\t\tthis.updateItem(groupId, group, params);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.moveToDirectPlace(groupId, group, params);\n\t\t}\n\t}\n\n\tupdateItem(rowId, rowData, params)\n\t{\n\t\tif (!this.grid.hasItem(rowId))\n\t\t{\n\t\t\tthis.grid.addItem(rowId);\n\t\t\tthis.addRow(rowId, rowData, params);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.updateRow(rowId, rowData, params);\n\t\t}\n\t}\n\n\taddRow(rowId, rowData, params)\n\t{\n\t\tif (this.grid.isRowExist(rowId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runComponentAction('bitrix:tasks.projects', 'prepareGridRows', {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tgroupIds: [rowId],\n\t\t\t\tdata: (rowData ? {[rowId]: rowData} : null),\n\t\t\t},\n\t\t\tsignedParameters: this.signedParameters,\n\t\t}).then(response => this.grid.addRow(rowId, response.data[rowId], params));\n\t}\n\n\tupdateRow(rowId, rowData, params)\n\t{\n\t\tif (!this.grid.isRowExist(rowId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runComponentAction('bitrix:tasks.projects', 'prepareGridRows', {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tgroupIds: [rowId],\n\t\t\t\tdata: (rowData ? {[rowId]: rowData} : null),\n\t\t\t},\n\t\t\tsignedParameters: this.signedParameters,\n\t\t}).then(response => this.grid.updateRow(rowId, response.data[rowId], params));\n\t}\n\n\tremoveRow(rowId)\n\t{\n\t\tthis.grid.removeItem(rowId);\n\t\tthis.grid.removeRow(rowId);\n\t}\n\n\tmoveToDirectPlace(groupId, data, params)\n\t{\n\t\tparams = params || {};\n\n\t\tBX.ajax.runComponentAction('bitrix:tasks.projects', 'findProjectPlace', {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tgroupId,\n\t\t\t\tcurrentPage: this.grid.getCurrentPage(),\n\t\t\t},\n\t\t\tsignedParameters: this.signedParameters,\n\t\t}).then((response) => {\n\t\t\tconst {projectBefore, projectAfter} = response.data;\n\n\t\t\tif (projectBefore === false && projectAfter === false)\n\t\t\t{\n\t\t\t\tthis.removeRow(groupId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\t(projectBefore && this.grid.isRowExist(projectBefore))\n\t\t\t\t\t|| (projectAfter && this.grid.isRowExist(projectAfter))\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tparams.moveParams = {\n\t\t\t\t\t\trowBefore: projectBefore,\n\t\t\t\t\t\trowAfter: projectAfter,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tparams.moveParams = {\n\t\t\t\t\t\tskip: true,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tthis.updateItem(groupId, data, params);\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateCounter(rowIds)\n\t{\n\t\tBX.ajax.runComponentAction('bitrix:tasks.projects', 'prepareGridRows', {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tgroupIds: rowIds,\n\t\t\t\tdata: null,\n\t\t\t},\n\t\t\tsignedParameters: this.signedParameters,\n\t\t}).then((response) => {\n\t\t\tconst projects = response.data;\n\t\t\tif (projects)\n\t\t\t{\n\t\t\t\tObject.keys(projects).forEach((projectId) => {\n\t\t\t\t\tif (this.grid.isRowExist(projectId))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.grid.getRowById(projectId).setCounters(projects[projectId].counters);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n}","import {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Grid} from '../grid';\nimport {Guide, Step} from 'ui.tour';\nimport {Loc, Uri} from 'main.core';\n\nexport class FirstProjectCreationTourGuide\n{\n\tconstructor(options)\n\t{\n\t\tthis.grid = new Grid(options);\n\t\tthis.signedParameters = options.signedParameters;\n\t\tthis.popupData = options.tours.firstProjectCreation.popupData;\n\n\t\tthis.projectAddButton = BX('projectAddButton');\n\t\tthis.guide = new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.projectAddButton,\n\t\t\t\t\ttitle: this.popupData[0].title,\n\t\t\t\t\ttext: this.popupData[0].text,\n\t\t\t\t\tarticle: this.popupData[0].article,\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true\n\t\t});\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('UI.Tour.Guide:onFinish', this.onGuideFinish.bind(this));\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onProjectSliderMessage.bind(this));\n\t}\n\n\tonGuideFinish(event: BaseEvent)\n\t{\n\t\tconst {guide} = event.getData();\n\n\t\tif (guide === this.guide)\n\t\t{\n\t\t\tthis.projectAddButton.href = Uri.removeParam(this.projectAddButton.href, ['PROJECT_OPTIONS']);\n\t\t}\n\t}\n\n\tonProjectSliderMessage(event: BaseEvent)\n\t{\n\t\tconst [sliderEvent] = event.getData();\n\t\tif (sliderEvent.getEventId() !== 'sonetGroupEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sliderEventData = sliderEvent.getData();\n\t\tif (\n\t\t\tsliderEventData.code !== 'afterCreate'\n\t\t\t|| sliderEventData.data.projectOptions.tourId !== this.guide.getId()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst projectId = sliderEventData.data.group.ID;\n\n\t\tif (this.grid.isRowExist(projectId))\n\t\t{\n\t\t\tthis.showFinalStep(projectId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEventEmitter.subscribe('Tasks.Projects.Grid:RowAdd', this.onProjectRowAdded.bind(this, projectId));\n\t\t}\n\t}\n\n\tonProjectRowAdded(projectId, event: BaseEvent)\n\t{\n\t\tconst {id} = event.getData();\n\n\t\tif (Number(id) === Number(projectId))\n\t\t{\n\t\t\tthis.showFinalStep(projectId);\n\t\t}\n\t}\n\n\tshowFinalStep(projectId)\n\t{\n\t\tconst target = this.grid.getRowNodeById(projectId).querySelector('.tasks-projects-text');\n\n\t\tthis.guide.steps.push(new Step({\n\t\t\ttarget,\n\t\t\tcursorMode: true,\n\t\t\ttargetEvent: () => {\n\t\t\t\tBX.SidePanel.Instance.open(target.href);\n\t\t\t\tsetTimeout(() => this.guide.close(), 1000);\n\t\t\t},\n\t\t}));\n\t\tthis.finish();\n\t\tthis.showNextStep();\n\t}\n\n\tstart()\n\t{\n\t\tthis.projectAddButton.href = Uri.addParam(this.projectAddButton.href, {\n\t\t\tPROJECT_OPTIONS: {\n\t\t\t\ttourId: this.guide.getId(),\n\t\t\t},\n\t\t});\n\t\tthis.showNextStep();\n\t}\n\n\tfinish()\n\t{\n\t\tBX.ajax.runAction('tasks.tourguide.firstprojectcreation.finish');\n\t}\n\n\tshowNextStep()\n\t{\n\t\tsetTimeout(() => this.guide.showNextStep(), 1000);\n\t}\n}","import {FirstProjectCreationTourGuide} from './first-project-creation-tour-guide';\n\nexport class TourGuideController\n{\n\tconstructor(options)\n\t{\n\t\tthis.tours = options.tours;\n\n\t\tthis.initGuides(options);\n\t}\n\n\tinitGuides(options)\n\t{\n\t\tif (this.tours.firstProjectCreation.show)\n\t\t{\n\t\t\tthis.firstProjectCreationTourGuide = new FirstProjectCreationTourGuide(options);\n\t\t\tthis.firstProjectCreationTourGuide.start();\n\t\t}\n\t}\n}","import {PULL as Pull} from 'pull.client';\n\nimport {ActionsController} from './actions-controller';\nimport {Filter} from './filter/filter';\nimport {MembersPopup} from './members-popup';\nimport {PullController} from './pull-controller';\nimport {TourGuideController} from './tourguide/tour-guide-controller';\n\nclass Controller\n{\n\tconstructor(options)\n\t{\n\t\tthis.membersPopup = new MembersPopup(options);\n\t\tthis.filter = new Filter(options);\n\t\tthis.tourGuideController = new TourGuideController(options);\n\n\t\toptions.filter = this.filter;\n\n\t\tActionsController.setOptions(options);\n\n\t\tthis.initPull(options);\n\t}\n\n\tinitPull(options)\n\t{\n\t\tthis.pullController = new PullController(options);\n\n\t\tthis.pullClient = Pull;\n\t\tthis.pullClient.subscribe(this.pullController);\n\t}\n\n\tgetMembersPopup(): MembersPopup\n\t{\n\t\treturn this.membersPopup;\n\t}\n\n\tgetFilter(): Filter\n\t{\n\t\treturn this.filter;\n\t}\n}\n\nexport {Controller, ActionsController};"],"names":["CellActionState","namespace","Reflection","ActionsController","options","actionsPanel","action","groupId","data","Promise","resolve","reject","BX","ajax","runComponentAction","mode","ids","getActionIds","signedParameters","then","catch","hideActionsPanel","unselectRows","id","undefined","selected","getSelectedRows","length","map","row","getDataset","getGridInstance","getRows","getSelected","button","Dom","hasClass","addClass","url","getAttribute","method","dataType","ajax_request","save","sessid","bitrix_sessid","onsuccess","removeClass","onfailure","userGroupRelationId","max_count","checked_0","type_0","id_0","type","result","console","log","sendCancelRequest","hidePanel","unselectAll","Main","gridManager","getById","gridId","instance","event","getData","ACTIVE","doAction","SHOW_BY_HOVER","field","filter","toggleByField","Runtime","loadExtension","exports","onRowUpdate","getCellById","querySelector","dialog","setTargetNode","onRowRemove","hide","onTagsChange","getTarget","tags","getSelectedItems","item","getId","KEYWORDS","join","Dialog","targetNode","enableSearch","width","height","multiple","dropdownMode","compactView","context","entities","searchOptions","allowCreateItem","footerOptions","label","Loc","getMessage","footer","SocialNetwork","EntitySelector","Footer","tagCreationLabel","events","EventEmitter","subscribe","unsubscribe","searchQuery","name","getQuery","toLowerCase","setTimeout","addItem","entityId","title","tabs","select","show","Filter","filterManager","filterId","init","bindEvents","updateFields","onFilterApply","bind","onCounterClick","fields","getFilterFieldsValues","counter","filterField","filterValue","Object","keys","includes","Type","isArray","value","isFilteredByField","isFilteredByFieldValue","getApi","extendFilter","getFilterFields","forEach","getFields","deleteField","getSearch","apply","MembersPopup","bindNode","isPopupShown","popup","destroy","resetPopupData","changeType","PopupWindowManager","create","className","bindElement","autoHide","closeByEsc","lightShadow","bindOptions","position","animationOptions","close","onPopupDestroy","loader","onPopupClose","onAfterPopupShow","contentContainer","appendChild","renderContainer","showLoader","showUsers","popupScroll","Tag","render","popupData","all","tab","heads","members","getCurrentPopupData","innerContainer","isDomNode","Event","area","target","scrollTop","scrollHeight","offsetHeight","unbindAll","page","currentPage","response","currentType","hideLoader","renderUsers","hasChildNodes","innerText","users","values","user","renderedUsers","indexOf","ID","push","getAvatar","isStringFilled","Loader","getPopupContainer","size","newType","loadUsers","oldType","replace","Grid","highlighted","pinned","pageSize","grid","getInstanceById","stub","gridStub","sort","items","Map","fillItems","colorPinnedRows","onColumnSort","onParamsUpdated","column","sort_by","sort_order","newItems","flipped","reduce","obj","clearItems","params","columns","content","actions","cellActions","counters","moveParams","rowBefore","insertAfter","rowAfter","insertBefore","append","getCurrentPage","lastRowId","getLastRowId","removeItem","remove","getRowNodeById","showMoreButton","hideStub","getRealtime","addRow","emit","getRowById","setCellsContent","setActions","setCellActions","setCounters","resetRows","moveRow","highlightRow","highlightParams","bindOnRowEvents","isRowExist","removeRow","rowId","skip","node","isPinned","classes","getNode","getIsPinned","reset","getBodyChild","firstRow","getBodyFirstChild","getRowProperty","lastRow","getBodyLastChild","pinnedRows","propertyName","getContainer","ACTIVITY_DATE","Array","from","has","parseInt","set","delete","clear","showStub","hideEmptyStub","getMoreButton","style","display","PullController","add","update","userAdd","userUpdate","userRemove","pinChanged","timer","counterData","userOptions","project_add","onProjectAdd","project_update","onProjectUpdate","project_remove","onProjectRemove","project_user_add","onProjectUserAdd","project_user_update","onProjectUserUpdate","project_user_remove","onProjectUserRemove","project_user_option_changed","onProjectUserOptionChanged","project_counter","onProjectCounter","project_read_all","onProjectCommentsReadAll","comment_read_all","getLastPinnedRowId","getFirstRowId","checkExistence","onCheckExistenceSuccess","error","GROUP_ID","OPTION","onProjectPinChanged","moveToDirectPlace","PROJECT_ID","EVENT","counterEvents","freeCounterQueue","movingProjectEvents","updateCounter","getItems","groupIds","group","isActivityRealtimeMode","updateRow","updateItem","rowData","hasItem","projectBefore","projectAfter","rowIds","projects","projectId","FirstProjectCreationTourGuide","tours","firstProjectCreation","projectAddButton","guide","Guide","steps","text","article","onEvents","onGuideFinish","onProjectSliderMessage","href","Uri","removeParam","sliderEvent","getEventId","sliderEventData","code","projectOptions","tourId","showFinalStep","onProjectRowAdded","Number","Step","cursorMode","targetEvent","SidePanel","Instance","open","finish","showNextStep","addParam","PROJECT_OPTIONS","runAction","TourGuideController","initGuides","firstProjectCreationTourGuide","start","Controller","membersPopup","tourGuideController","setOptions","initPull","pullController","pullClient","Pull"],"mappings":"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"}