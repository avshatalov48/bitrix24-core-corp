if(typeof BX.CrmCarousel==="undefined"){BX.CrmCarousel=function(){this._id="";this._settings={};this._pageNum=1;this._pageCount=1;this._wrapper=null;this._container=null;this._forwardButton=null;this._backwardButton=null;this._closeButton=null;this._bulletContainer=null;this._bulletNodeId="";this._bulletNodes=[];this._autorewind=false;this._autorewindInterval=6e4;this._autorewindIntervalId=null;this._autoRewindHandler=BX.delegate(this.onAutoRewindTimer,this);this._mouseOverHandler=BX.delegate(this.onMouseOver,this);this._mouseOutHandler=BX.delegate(this.onMouseOut,this);this._forwardButtonHandler=BX.delegate(this.onForwardButtonClick,this);this._backwardButtonHandler=BX.delegate(this.onBackwardButtonClick,this);this._closeButtonHandler=BX.delegate(this.onCloseButtonClick,this);this._bulletNodeHandler=BX.delegate(this.onBulletNodeClick,this);this._closeConfirmDialog=null};BX.CrmCarousel.prototype={initialize:function(t,e){this._id=BX.type.isNotEmptyString(t)?t:Math.random().toString().substring(2);this._settings=e?e:{};this._pageNum=parseInt(this.getSetting("pageNum",1));if(!BX.type.isNumber(this._pageNum)){this._pageNum=1}this._pageCount=parseInt(this.getSetting("pageCount",1));if(!BX.type.isNumber(this._pageCount)){this._pageCount=1}this._wrapper=BX(this.getSetting("wrapperId"));if(!BX.type.isElementNode(this._wrapper)){throw"BX.CrmCarousel. Could not find wrapper."}this._container=BX(this.getSetting("containerId"));if(!BX.type.isElementNode(this._container)){throw"BX.CrmCarousel. Could not find container."}if(this._pageCount>1){this._bulletContainer=BX(this.getSetting("bulletContainerId"));if(!BX.type.isElementNode(this._bulletContainer)){throw"BX.CrmCarousel. Could not find bullet container."}this._forwardButton=BX(this.getSetting("forwardButtonId"));if(BX.type.isElementNode(this._forwardButton)){BX.bind(this._forwardButton,"click",this._forwardButtonHandler)}this._backwardButton=BX(this.getSetting("backwardButtonId"));if(BX.type.isElementNode(this._backwardButton)){BX.bind(this._backwardButton,"click",this._backwardButtonHandler)}}this._closeButton=BX(this.getSetting("closeButtonId"));if(BX.type.isElementNode(this._closeButton)){BX.bind(this._closeButton,"click",this._closeButtonHandler)}this._bulletNodeId=this.getSetting("bulletNodeId");if(!BX.type.isNotEmptyString(this._bulletNodeId)){this._bulletNodeId="bullet_#pagenum#"}if(this._pageCount>1){this._bulletNodes=this._bulletContainer.querySelectorAll(".crm-carousel-bullet-item");for(var i=0,n=this._bulletNodes.length;i<n;i++){var s=i+1;var o=this._bulletNodes[i];o.id=this.getPageBulletNodeId(s);o.setAttribute("data-page-num",s);if(s===this._pageNum){BX.addClass(o,"crm-carousel-bullet-current")}BX.bind(o,"click",this._bulletNodeHandler)}if(this._pageNum!==1){this.rewind(this._pageNum,false)}if(this.getSetting("autorewind",false)){this.enableAutoRewind(true)}}},release:function(){this.enableAutoRewind(false);if(this._forwardButton){BX.unbind(this._forwardButton,"click",this._forwardButtonHandler);this._forwardButton=null}if(this._backwardButton){BX.unbind(this._backwardButton,"click",this._backwardButtonHandler);this._backwardButton=null}if(this._closeButton){BX.unbind(this._closeButton,"click",this._closeButtonHandler);this._closeButton=null}for(var t=0,e=this._bulletNodes.length;t<e;t++){BX.unbind(this._bulletNodes[t],"click",this._bulletNodeHandler)}this._bulletNodes=[]},getId:function(){return this._id},getSetting:function(t,e){return this._settings.hasOwnProperty(t)?this._settings[t]:e},onForwardButtonClick:function(){this.enableAutoRewind(false);this.goToNext()},onBackwardButtonClick:function(){this.enableAutoRewind(false);this.goToPrevious()},onCloseButtonClick:function(){this.openCloseConfirmDialog()},onBulletNodeClick:function(t){this.enableAutoRewind(false);var e=parseInt(BX.getEventTarget(t).getAttribute("data-page-num"));if(e>0){this.rewind(e,false)}},onAutoRewindTimer:function(){if(!this._autorewind){return}this.goToNext();this.startAutoRewind()},onMouseOver:function(){if(this._autorewind){this.stopAutoRewind()}},onMouseOut:function(){if(this._autorewind){this.startAutoRewind()}},onCloseConfirm:function(t,e){if(!this._closeConfirmDialog){return}this._closeConfirmDialog.close();if(BX.type.isBoolean(e["isAccepted"])&&e["isAccepted"]){this.close()}},enableAutoRewind:function(t){t=!!t;if(this._autorewind===t){return}this._autorewind=t;if(this._autorewind){this.startAutoRewind();BX.bind(this._container,"mouseover",this._mouseOverHandler);BX.bind(this._container,"mouseout",this._mouseOutHandler)}else{this.stopAutoRewind();BX.unbind(this._container,"mouseover",this._mouseOverHandler);BX.unbind(this._container,"mouseout",this._mouseOutHandler)}},startAutoRewind:function(){this._autorewindIntervalId=window.setTimeout(this._autoRewindHandler,this._autorewindInterval)},stopAutoRewind:function(){if(this._autorewindIntervalId!==null){window.clearTimeout(this._autorewindIntervalId);this._autorewindIntervalId=null}},goToNext:function(){if(this._pageNum<this._pageCount){this.rewind(this._pageNum+1,true)}else{this.rewind(1,false)}},goToPrevious:function(){if(this._pageNum>1){this.rewind(this._pageNum-1,true)}else{this.rewind(this._pageCount,false)}},getPageBulletNodeId:function(t){return this._bulletNodeId.replace(/#pagenum#/gi,t)},getPageBulletNode:function(t){return BX(this.getPageBulletNodeId(t))},rewind:function(t,e){if(this._pageNum===t){return}BX.removeClass(BX(this.getPageBulletNode(this._pageNum)),"crm-carousel-bullet-current");this._pageNum=t;if(!!e){BX.addClass(this._container,"crm-carousel-transition")}else{BX.removeClass(this._container,"crm-carousel-transition")}this._container.style.transform="translateX(-"+(100*(this._pageNum-1)).toString()+"%)";BX.addClass(BX(this.getPageBulletNode(this._pageNum)),"crm-carousel-bullet-current")},openCloseConfirmDialog:function(){if(!this._closeConfirmDialog){this._closeConfirmDialog=BX.CrmCarouselCloseDialog.create(this._id,{callback:BX.delegate(this.onCloseConfirm,this)})}this._closeConfirmDialog.open()},close:function(){var t={cancel:false};BX.onCustomEvent(window,"ON_CAROUSEL_CLOSE",[this,t]);if(t["cancel"]){return}this.release();BX.remove(this._wrapper);this._wrapper=this._container=null}};BX.CrmCarousel.create=function(t,e){var i=new BX.CrmCarousel;i.initialize(t,e);return i}}if(typeof BX.CrmCarouselCloseDialog==="undefined"){BX.CrmCarouselCloseDialog=function(){this._id="";this._settings={};this._callback=null;this._popup=null};BX.CrmCarouselCloseDialog.prototype={initialize:function(t,e){this._id=BX.type.isNotEmptyString(t)?t:Math.random().toString().substring(2);this._settings=e?e:{};var i=this.getSetting("callback");if(BX.type.isFunction(i)){this._callback=i}},getId:function(){return this._id},getSetting:function(t,e){return this._settings.hasOwnProperty(t)?this._settings[t]:e},getMessage:function(t){return BX.CrmCarouselCloseDialog.messages.hasOwnProperty(t)?BX.CrmCarouselCloseDialog.messages[t]:t},open:function(){if(!this._popup){this._popup=new BX.PopupWindow(this._id,null,{autoHide:false,draggable:true,bindOptions:{forceBindPosition:false},closeByEsc:true,closeIcon:{marginRight:"-2px",marginTop:"3px"},events:{onPopupClose:BX.delegate(this.onPopupClose,this),onPopupDestroy:BX.delegate(this.onPopupDestroy,this)},titleBar:this.getMessage("title"),content:this.prepareContent(),buttons:[new BX.PopupWindowButton({text:this.getMessage("closeButton"),className:"popup-window-button-accept",events:{click:BX.delegate(this.onAcceptButtonClick,this)}}),new BX.PopupWindowButtonLink({text:BX.message("JS_CORE_WINDOW_CANCEL"),className:"popup-window-button-link-cancel",events:{click:BX.delegate(this.onCancelButtonClick,this)}})],className:"crm-carousel-popup-close",lightShadow:true})}if(!this._popup.isShown()){this._popup.show()}},close:function(){if(this._popup.isShown()){this._popup.close()}},prepareContent:function(){return BX.create("DIV",{attrs:{className:"crm-carousel-popup-close-text"},children:[BX.create("SPAN",{attrs:{className:"crm-carousel-popup-close-text-item"},text:this.getMessage("confirm")})]})},onAcceptButtonClick:function(){if(this._callback){this._callback(this,{isAccepted:true})}},onCancelButtonClick:function(){if(this._callback){this._callback(this,{isAccepted:false})}},onPopupClose:function(){if(this._popup){this._popup.destroy()}},onPopupDestroy:function(){if(this._popup){this._popup=null}}};if(typeof BX.CrmCarouselCloseDialog.messages==="undefined"){BX.CrmCarouselCloseDialog.messages={}}BX.CrmCarouselCloseDialog.create=function(t,e){var i=new BX.CrmCarouselCloseDialog;i.initialize(t,e);return i}}
//# sourceMappingURL=script.map.js