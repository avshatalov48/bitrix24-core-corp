(function(e,t,i){"use strict";var s=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.selectorId=t.selectorId;this.selectorHiddenId=t.selectorHiddenId;this.selectedItems=t.selectedItems;this.iblockId=t.iblockId;this.initSelector()}babelHelpers.createClass(e,[{key:"initSelector",value:function e(){if(!this.selector){this.selector=new BX.UI.EntitySelector.TagSelector({id:this.selectorId,multiple:true,placeholder:t.Loc.getMessage("CATALOG_IBLOCKSECTIONFIELD_PLACEHOLDER"),textBoxWidth:"100%",dialogOptions:{height:300,id:this.selectorId,context:"catalog-sections",enableSearch:false,multiple:false,dropdownMode:true,selectedItems:this.selectedItems,searchTabOptions:{stub:true,stubOptions:{title:t.Loc.getMessage("CATALOG_IBLOCKSECTIONFIELD_IS_EMPTY_TITLE"),subtitle:t.Loc.getMessage("CATALOG_IBLOCKSECTIONFIELD_IS_EMPTY_SUBTITLE"),arrow:true}},searchOptions:{allowCreateItem:true},events:{"Item:onSelect":this.setSelectedInputs.bind(this,"Item:onSelect"),"Item:onDeselect":this.setSelectedInputs.bind(this,"Item:onDeselect"),"Search:onItemCreateAsync":this.addNewSection.bind(this)},entities:[{id:"section",options:{iblockId:this.iblockId},dynamicSearch:true,dynamicLoad:true}]}})}this.selector.renderTo(document.getElementById(this.selectorId))}},{key:"setSelectedInputs",value:function e(t,s){s.target.hide();var n=s.getData().item.getDialog().getSelectedItems();if(Array.isArray(n)){var c="";var o=[];n.forEach(function(e){c+='<input type="hidden" name="IBLOCK_SECTION[]" value="'+e["id"]+'" />';o.push(e["id"])});document.getElementById(this.selectorHiddenId).innerHTML=c;i.EventEmitter.emit(t,o)}}},{key:"addNewSection",value:function e(i){return new Promise(function(e,s){var n=i.getData(),c=n.searchQuery;var o=i.getTarget();t.ajax.runComponentAction("bitrix:catalog.productcard.iblocksectionfield","addSection",{mode:"ajax",data:{iblockId:this.iblockId,name:c.getQuery()}}).then(function(e){var t=o.addItem({id:e.data.id,entityId:"tag",title:c.getQuery(),tabs:o.getRecentTab().getId()});if(t){t.select()}}).bind(this);e()}.bind(this))}}]);return e}();t.Reflection.namespace("BX.Catalog").SectionSelector=s})(this.window=this.window||{},BX,BX.Event);
//# sourceMappingURL=script.map.js