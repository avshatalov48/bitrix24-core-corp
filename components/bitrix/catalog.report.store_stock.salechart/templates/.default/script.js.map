{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import \"currency\";\nimport {Loc, Reflection} from 'main.core';\n\nclass StoreStockSaleChart {\n\n\t_chartId;\n\t_chart;\n\t_isOneColumn;\n\n\t_boardId;\n\t_widgetId;\n\t_hint;\n\n\t_sliderUrl;\n\t_chartCurrency;\n\n\t_categoryAxis;\n\t_valueAxis;\n\t\n\t_storeInfoPopupTemplate;\n\t_storeInfoPopup;\n\n\t_storesLabels;\n\t_legendIsPrepared = false;\n\n\t_series = [];\n\n\t_sumStoredColor = '#42659B';\n\t_sumSoldColor = '#6DA3E6';\n\n\tconstructor(params)\n\t{\n\t\tthis._chartId = params.chartId;\n\n\t\tthis._boardId = params.boardId;\n\t\tthis._widgetId = params.widgetId;\n\t\tthis._board = BX.VisualConstructor.BoardRepository.getBoard(this._boardId);\n\t\tthis._widget = this._board.dashboard.getWidget(this._widgetId);\n\n\t\tthis._storeInfoPopupTemplate = params.storeInfoPopupTemplate;\n\t\tthis._storeInfoPopup = null;\n\n\t\tthis._sliderUrl = params.chartData.sliderUrl;\n\n\t\tthis._enablePopup = Boolean(params.chartData.enablePopup);\n\n\t\tthis._currencySymbol = params.chartData.currencySymbol;\n\t\tthis._chartCurrency = params.chartData.currency;\n\n\t\tthis._isOneColumn = Boolean(params.chartData.isOneColumn);\n\n\t\tthis.createChart(params.chartData);\n\n\t\tthis.updateWidgetTitle();\n\t\tBX.addCustomEvent(this._widget, \"Dashboard.Board.Widget:onAfterRender\",\n\t\t\tthis.updateWidgetTitle.bind(this)\n\t\t)\n\t}\n\n\tcreateChart(chartData)\n\t{\n\t\twindow.am4core.useTheme(am4themes_animated);\n\n\t\tthis._chart = am4core.create(this._chartId, am4charts.XYChart);\n\n\t\tthis._chart.zoomOutButton.readerTitle = Loc.getMessage('STORE_STOCK_CHART_ZOOMOUT_TITLE');\n\n\t\tthis._chart.data = [];\n\n\t\tthis._chart.legend = new am4charts.Legend();\n\t\tthis._chart.legend.position = 'bottom';\n\n\t\tthis._chartLabel = chartData._chartLabel;\n\n\t\tthis.createAxes();\n\n\t\tthis.fillChartData(chartData.data);\n\t\tthis.fillSeries();\n\n\t\tif (chartData.isOneColumn)\n\t\t{\n\t\t\tthis._categoryAxis.renderer.labels.template.html = chartData.chartLabel;\n\t\t}\n\n\n\t\tthis._chart.events.on(\"inited\", () => {\n\t\t\tthis.onChartLoaded();\n\t\t}, this);\n\t}\n\n\tcreateAxes()\n\t{\n\t\tthis._categoryAxis = this._chart.xAxes.push(new am4charts.CategoryAxis());\n\t\tthis._categoryAxis.dataFields.category = 'ID';\n\t\tthis._categoryAxis.renderer.grid.template.opacity = 0;\n\n\t\tthis._valueAxis = this._chart.yAxes.push(new am4charts.ValueAxis());\n\t\tthis._valueAxis.min = 0;\n\t\tthis._valueAxis.renderer.grid.template.opacity = 0;\n\t\tthis._valueAxis.renderer.ticks.template.strokeOpacity = 0.5;\n\t\tthis._valueAxis.renderer.ticks.template.length = 10;\n\t\tthis._valueAxis.renderer.line.strokeOpacity = 0.5;\n\t\tthis._valueAxis.renderer.baseGrid.disabled = true;\n\t\tthis._valueAxis.renderer.minGridDistance = 40;\n\t\tthis._valueAxis.calculateTotals = true;\n\n\t\t// some space needed for the total label\n\t\tthis._categoryAxis.renderer.labels.template.marginRight = 40;\n\t}\n\n\tfillChartData(chartData)\n\t{\n\t\tthis._chart.data = chartData.map((columnData, index) => {\n\t\t\tcolumnData['ID'] = index;\n\t\t\treturn columnData;\n\t\t});\n\t}\n\n\tfillSeries()\n\t{\n\t\tlet emptySeries = this.createSeries(\"empty\", \"empty\");\n\t\temptySeries.hiddenInLegend = true;\n\t\temptySeries.maskBullets = false;\n\n\n\n\t\tlet sumStoredTitle = Loc.getMessage('STORE_STOCK_CHART_SUM_STORED_TITLE');\n\t\tlet sumStoredSeries = this.createSeries(\"SUM_STORED\", sumStoredTitle);\n\t\tsumStoredSeries.fill = am4core.color(this._sumStoredColor);\n\t\tsumStoredSeries.stroke = am4core.color(\"#FFFFFF\");\n\t\tthis._series.push(sumStoredSeries);\n\n\t\tlet sumSoldTitle = Loc.getMessage('STORE_STOCK_CHART_SUM_SOLD_TITLE');\n\t\tlet sumSoldSeries = this.createSeries(\"SUM_SOLD\", sumSoldTitle);\n\t\tsumSoldSeries.fill = am4core.color(this._sumSoldColor);\n\t\tsumSoldSeries.stroke = am4core.color(\"#FFFFFF\");\n\t\tthis._series.push(sumSoldSeries);\n\n\t\tsumStoredSeries.events.on(\"inited\", (eventObject) => {\n\t\t\tthis.onSeriesLoad(eventObject.target, 'SUM_STORED');\n\t\t}, this);\n\t\tsumSoldSeries.events.on(\"inited\", (eventObject) => {\n\t\t\tthis.onSeriesLoad(eventObject.target, 'SUM_SOLD');\n\t\t}, this);\n\t}\n\n\tonSeriesLoad(seriesObject, seriesTypeId)\n\t{\n\t\tif (this._chart.legend.labels.values.length === this._series.length)\n\t\t{\n\t\t\tthis.prepareChartLegend();\n\t\t}\n\n\t\tif (this._enablePopup)\n\t\t{\n\t\t\tthis.bindPopupEvents(seriesObject, seriesTypeId);\n\t\t}\n\t}\n\n\tbindPopupEvents(seriesObject, seriesTypeId)\n\t{\n\t\tfor (let i = 0; i < seriesObject.columns.length; i++)\n\t\t{\n\t\t\tlet column = {\n\t\t\t\tcolumnObject: seriesObject.columns.getIndex(i),\n\t\t\t\tcolumnTypeId: seriesTypeId,\n\t\t\t\tstoreData: this._chart.data[i],\n\t\t\t};\n\n\t\t\tBX.bind(column.columnObject.group.node, 'mouseover', this.handleColumnMouseOver.bind(this, column));\n\t\t\tBX.bind(column.columnObject.group.node, 'mouseout', this.handleColumnMouseOut.bind(this));\n\n\t\t\tif (this._sliderUrl)\n\t\t\t{\n\t\t\t\tcolumn.columnObject.group.node.style.cursor = 'pointer';\n\t\t\t\tBX.bind(column.columnObject.group.node, 'click', this.openStoreStockChartGridSlider.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\n\tprepareChartLegend()\n\t{\n\t\tif (this._legendIsPrepared)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._legendIsPrepared = true;\n\t\t}\n\n\t\tlet chartLegends = this._chart.legend.labels.values;\n\t\tlet currencyPostfix = ', ' + this._currencySymbol;\n\n\t\tfor (let i = 0; i < chartLegends.length; i++)\n\t\t{\n\t\t\tchartLegends[i].fill = am4core.color(\"#000000\");\n\t\t\tchartLegends[i].html = chartLegends[i].currentText + currencyPostfix;\n\t\t}\n\t}\n\n\thandleColumnMouseOver(column)\n\t{\n\t\tthis.openStoreInfoPopup(column);\n\t}\n\n\thandleColumnMouseOut()\n\t{\n\t\tif (this._storeInfoPopup !== null)\n\t\t{\n\t\t\tthis._storeInfoPopup.close();\n\t\t}\n\t}\n\n\topenStoreStockChartGridSlider()\n\t{\n\t\tBX.SidePanel.Instance.open(this._sliderUrl, {\n\t\t\tcacheable: false,\n\t\t\tallowChangeTitle: false,\n\t\t\tallowChangeHistory: false,\n\t\t});\n\t}\n\n\topenStoreInfoPopup(column)\n\t{\n\t\tif (this._storeInfoPopup !== null)\n\t\t{\n\t\t\tthis._storeInfoPopup.destroy();\n\t\t}\n\n\t\tlet popupData = {\n\t\t\ttypeId: column.columnTypeId,\n\t\t\tstoreData: column.storeData\n\t\t};\n\n\t\tthis._storeInfoPopup = new BX.PopupWindow('widget-store-stock-info-popup', column.columnObject.group.node, {\n\t\t\tbindOptions: {\n\t\t\t\tposition: \"top\"\n\t\t\t},\n\t\t\toffsetLeft: 30,\n\t\t\toffsetTop: -1,\n\t\t\tnoAllPaddings: true,\n\t\t\tautoHide: false,\n\t\t\tdraggable: {restrict: false},\n\t\t\tcacheable: false,\n\t\t\tcontent: this.getFormedStoreInfoPopupContent(popupData),\n\t\t});\n\t\tthis._storeInfoPopup.show();\n\t}\n\n\tgetFormedStoreInfoPopupContent(popupData) {\n\t\tlet popup = {\n\t\t\ttitle: this._storeInfoPopupTemplate.querySelector('#chart-popup-template-title'),\n\t\t\tsum: this._storeInfoPopupTemplate.querySelector('#chart-popup-template-sum'),\n\t\t\tsumProc: this._storeInfoPopupTemplate.querySelector('#chart-popup-template-sum-proc'),\n\t\t};\n\n\t\tswitch (popupData.typeId) {\n\t\t\tcase 'SUM_SOLD':\n\t\t\t\tpopup.title.innerText = Loc.getMessage('STORE_STOCK_CHART_POPUP_SOLD_TITLE');\n\t\t\t\tpopup.sum.innerHTML = this.sumCurrencyFormat(popupData.storeData['SUM_SOLD']);\n\t\t\t\tpopup.sumProc.innerText = this.formatPercentValue(popupData.storeData['SUM_SOLD_PERCENT']);\n\t\t\t\tthis._storeInfoPopupTemplate.style.borderColor = this._sumSoldColor;\n\t\t\t\tbreak;\n\t\t\tcase 'SUM_STORED':\n\t\t\t\tpopup.title.innerText = Loc.getMessage('STORE_STOCK_CHART_POPUP_STORED_TITLE');\n\t\t\t\tpopup.sum.innerHTML = this.sumCurrencyFormat(popupData.storeData['SUM_STORED']);\n\t\t\t\tpopup.sumProc.innerText = this.formatPercentValue(popupData.storeData['SUM_STORED_PERCENT']);\n\t\t\t\tthis._storeInfoPopupTemplate.style.borderColor = this._sumStoredColor;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn this._storeInfoPopupTemplate;\n\t}\n\n\tsumCurrencyFormat(sum)\n\t{\n\t\tsum = parseFloat(sum);\n\t\treturn BX.Currency.currencyFormat(sum, this._chartCurrency, true);\n\t}\n\n\tformatPercentValue(percentValue)\n\t{\n\t\treturn parseFloat(percentValue).toFixed(2) + '%';\n\t}\n\n\tcreateSeries(field, name)\n\t{\n\t\tlet series = this._chart.series.push(new am4charts.ColumnSeries());\n\t\tseries.dataFields.valueY = field;\n\t\tseries.dataFields.categoryX = 'ID';\n\t\tseries.stacked = true;\n\t\tseries.name = name;\n\n\t\treturn series;\n\t}\n\n\tupdateWidgetTitle()\n\t{\n\t\tBX.clean(this._widget.layout.titleContainer);\n\t\tBX.adjust(this._widget.layout.titleContainer, {\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"span\", {\n\t\t\t\t\ttext: this._widget.config.title\n\t\t\t\t}),\n\t\t\t\tthis._hint = BX.UI.Hint.createNode(Loc.getMessage('STORE_STOCK_CHART_HINT_TITLE')),\n\t\t\t]\n\t\t});\n\n\t\tBX.bind(this._hint, \"click\", function()\n\t\t{\n\t\t\tif (top.BX.Helper)\n\t\t\t{\n\t\t\t\ttop.BX.Helper.show(\"redirect=detail&code=15503856\");\n\t\t\t}\n\t\t});\n\t}\n\n\tonChartLoaded()\n\t{\n\t\tif (!this._isOneColumn)\n\t\t{\n\t\t\tthis.fillColumnsTitle();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._categoryAxis.dataItemsByCategory.getKey('0').text = '';\n\t\t}\n\t}\n\n\tfillColumnsTitle()\n\t{\n\t\tthis._chart.data.forEach((columnData) => {\n\t\t\tthis._categoryAxis.dataItemsByCategory.getKey(columnData['ID']).text = columnData['STORE_NAME'];\n\t\t});\n\t}\n}\n\nReflection.namespace('BX.Catalog.Report.StoreStock').StoreStockSaleChart = StoreStockSaleChart;"],"names":["StoreStockSaleChart","params","_chartId","chartId","_boardId","boardId","_widgetId","widgetId","_board","BX","VisualConstructor","BoardRepository","getBoard","_widget","dashboard","getWidget","_storeInfoPopupTemplate","storeInfoPopupTemplate","_storeInfoPopup","_sliderUrl","chartData","sliderUrl","_enablePopup","Boolean","enablePopup","_currencySymbol","currencySymbol","_chartCurrency","currency","_isOneColumn","isOneColumn","createChart","updateWidgetTitle","addCustomEvent","bind","window","am4core","useTheme","am4themes_animated","_chart","create","am4charts","XYChart","zoomOutButton","readerTitle","Loc","getMessage","data","legend","Legend","position","_chartLabel","createAxes","fillChartData","fillSeries","_categoryAxis","renderer","labels","template","html","chartLabel","events","on","onChartLoaded","xAxes","push","CategoryAxis","dataFields","category","grid","opacity","_valueAxis","yAxes","ValueAxis","min","ticks","strokeOpacity","length","line","baseGrid","disabled","minGridDistance","calculateTotals","marginRight","map","columnData","index","emptySeries","createSeries","hiddenInLegend","maskBullets","sumStoredTitle","sumStoredSeries","fill","color","_sumStoredColor","stroke","_series","sumSoldTitle","sumSoldSeries","_sumSoldColor","eventObject","onSeriesLoad","target","seriesObject","seriesTypeId","values","prepareChartLegend","bindPopupEvents","i","columns","column","columnObject","getIndex","columnTypeId","storeData","group","node","handleColumnMouseOver","handleColumnMouseOut","style","cursor","openStoreStockChartGridSlider","_legendIsPrepared","chartLegends","currencyPostfix","currentText","openStoreInfoPopup","close","SidePanel","Instance","open","cacheable","allowChangeTitle","allowChangeHistory","destroy","popupData","typeId","PopupWindow","bindOptions","offsetLeft","offsetTop","noAllPaddings","autoHide","draggable","restrict","content","getFormedStoreInfoPopupContent","show","popup","title","querySelector","sum","sumProc","innerText","innerHTML","sumCurrencyFormat","formatPercentValue","borderColor","parseFloat","Currency","currencyFormat","percentValue","toFixed","field","name","series","ColumnSeries","valueY","categoryX","stacked","clean","layout","titleContainer","adjust","children","text","config","_hint","UI","Hint","createNode","top","Helper","fillColumnsTitle","dataItemsByCategory","getKey","forEach","Reflection","namespace"],"mappings":"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"}