(function(){BX.namespace("BX.Transformer");if(window.BX.Transformer.onTransformLinkClick){return}BX.Transformer.onTransformLinkClick=function(r){var e=r.srcElement||r.target;BX.ajax({method:"GET",dataType:"json",url:e.href,onsuccess:function(r){BX.Transformer.onTransformAjaxSuccess(r,e)}});BX.PreventDefault(r)};BX.Transformer.onTransformAjaxSuccess=function(r,e){r=r||{};var a=BX.findParent(BX(e),{class:"transformer-uf-file-container"});var s=BX.findChild(a,{class:"transformer-uf-file-loader-title"},true,false);var t=BX.findChild(a,{class:"transformer-uf-file-loader-desc"},true,false);var n=BX.findChild(a,{class:"transformer-uf-file-loader-inner"},true,false);if(r["success"]=="success"){BX.adjust(s,{text:BX.message("VIDEO_TRANSFORMATION_IN_PROCESS_TITLE")});if(t){BX.adjust(t,{text:BX.message("VIDEO_TRANSFORMATION_IN_PROCESS_DESC")})}if(n){BX.adjust(n,{html:BX.Transformer.getDummyLoaderHtml()})}}else{BX.adjust(s,{text:BX.message("VIDEO_TRANSFORMATION_ERROR_TITLE")});if(t){var o=BX.Transformer.getErrorMessageByCode(r["success"]);if(o){BX.adjust(t,{text:o})}}if(n){BX.adjust(n,{html:BX.Transformer.getDummyErrorHtml()})}}BX(e).remove()};BX.Transformer.getDummyLoaderHtml=function(){return'<svg class="transformer-uf-file-circular hidden" viewBox="25 25 50 50"><circle class="transformer-uf-file-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/><circle class="transformer-uf-file-inner-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/></svg>'};BX.Transformer.getDummyErrorHtml=function(){return'<div class="transformer-uf-file-loader-button transformer-uf-file-loader-button-sad"></div>'};BX.Transformer.getErrorMessageByCode=function(r){var e=null;switch(r){case"not allowed":e=BX.message("VIDEO_TRANSFORMATION_ERROR_TRANSFORM_NOT_ALLOWED");break;case"no module":e=BX.message("VIDEO_TRANSFORMATION_ERROR_TRANSFORM_NOT_INSTALLED");break;case"was transformed":e=BX.message("VIDEO_TRANSFORMATION_ERROR_TRANSFORM_TRANSFORMED");break}return e};BX.Transformer.onPull=function(r,e){if(r==="refreshPlayer"&&e["id"]){var a=BX.findChildrenByClassName(document,"transformer-uf-file-container-"+e["id"],true);if(a.length>0){for(var s=0;s<a.length;s++){var t=a[s];var n=t.getAttribute("data-bx-refresh-url");if(n){BX.ajax({method:"GET",dataType:"json",url:n,onsuccess:function(r){if(r.html){var a=BX.findChildrenByClassName(document,"transformer-uf-file-container-"+e["id"],true);for(var s=0;s<a.length;s++){var t=a[s];if(t.getAttribute("data-bx-refresh-url")==this.url){var n=BX.processHTML(r.html);t.removeAttribute("data-bx-refresh-url");var o=BX.create("div",{html:n.HTML});o=o.firstChild;if(t.parentNode&&BX.hasClass(t.parentNode,"disk-player-container")){t.parentNode.parentNode.replaceChild(o,t.parentNode)}else{t.parentNode.replaceChild(o,t)}if(n.SCRIPT){BX.ajax.processScripts(n.SCRIPT)}break}}}}})}}}}};BX.addCustomEvent("onPullEvent-transformer",BX.Transformer.onPull)})(window);