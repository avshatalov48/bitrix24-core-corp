{"version":3,"file":"script.js","sources":["src/utility/request.sender.js","src/service/filter.js","src/service/disk.manager.js","src/item/task/actions.panel.js","src/item/task/taskcounts.js","src/utility/story.points.js","src/item/item.js","src/entity/group.actions.button.js","src/entity/list.items.js","src/utility/tag.searcher.js","src/utility/input.js","src/entity/entity.js","src/entity/backlog/header.js","src/entity/backlog/epic.creation.button.js","src/entity/backlog/backlog.js","src/entity/sprint/sprint.date.js","src/utility/stats.calculator.js","src/entity/sprint/stats.header.js","src/entity/sprint/completed.stats.header.js","src/entity/sprint/expired.stats.header.js","src/entity/sprint/active.stats.header.js","src/entity/sprint/stats.header.builder.js","src/entity/sprint/sprint.header.js","src/entity/sprint/events.header.js","src/entity/sprint/story.points.header.js","src/entity/sprint/sprint.js","src/utility/entity.storage.js","src/counters/pull.counters.js","src/counters/counters.js","src/service/side.panel.js","src/view/header/tabs.js","src/view/view.js","src/view/header/team.speed.button.js","src/utility/burn.down.chart.js","src/entity/sprint/sprint.side.panel.js","src/utility/item.style.designer.js","src/utility/dom.builder.js","src/utility/subtasks.manager.js","src/item/task/decomposition.js","src/dod/item.type.js","src/dod/type.storage.js","src/dod/tabs.js","src/dod/settings.js","src/dod/side.panel.js","src/team.speed/chart.js","src/team.speed/side.panel.js","src/utility/entity.counters.js","src/utility/filter.handler.js","src/utility/epic.js","src/pull/pull.sprint.js","src/utility/item.mover.js","src/pull/pull.item.js","src/pull/pull.epic.js","src/utility/sprint.mover.js","src/view/plan.js","src/view/header/active.sprint.action.button.js","src/view/header/robot.button.js","src/view/active.sprint.js","src/view/header/burn.down.button.js","src/view/completed.sprint.js","src/entry.js"],"sourcesContent":["import {ajax, Loc, Type} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tconstructor(options = {})\n\t{\n\t\tthis.signedParameters = (options.signedParameters ? options.signedParameters : '');\n\t\tthis.debugMode = options.debugMode;\n\t}\n\n\tgetSignedParameters(): string\n\t{\n\t\treturn this.signedParameters;\n\t}\n\n\tsendRequest(action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(action, {\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tsendRequestToComponent(data = {}, action): Promise\n\t{\n\t\tdata.debugMode = this.debugMode;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runComponentAction('bitrix:tasks.scrum', action, {\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tbatchUpdateItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchUpdateItem');\n\t}\n\n\tbatchRemoveItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchRemoveItem');\n\t}\n\n\tupdateItemSort(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItemSort');\n\t}\n\n\tupdateSprintSort(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateSprintSort');\n\t}\n\n\tcreateSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createSprint');\n\t}\n\n\tstartSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'startSprint');\n\t}\n\n\tcompleteSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'completeSprint');\n\t}\n\n\tcreateTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createTask');\n\t}\n\n\tupdateItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItem');\n\t}\n\n\tremoveItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeItem');\n\t}\n\n\tchangeTaskResponsible(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeTaskResponsible');\n\t}\n\n\tgetCurrentState(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getCurrentState');\n\t}\n\n\thasTaskInFilter(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'hasTaskInFilter');\n\t}\n\n\tremoveSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeSprint');\n\t}\n\n\tchangeSprintName(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeSprintName');\n\t}\n\n\tchangeSprintDeadline(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeSprintDeadline');\n\t}\n\n\tgetSprintCompletedItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintCompletedItems');\n\t}\n\n\tgetCompletedSprints(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getCompletedSprints');\n\t}\n\n\tgetItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getItems');\n\t}\n\n\tgetEntityCounters(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEntityCounters');\n\t}\n\n\tgetEpicDescriptionEditor(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicDescriptionEditor');\n\t}\n\n\tgetEpicDescription(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicDescription');\n\t}\n\n\tgetEpicFiles(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicFiles');\n\t}\n\n\tgetAddEpicFormButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getAddEpicFormButtons');\n\t}\n\n\tgetViewEpicFormButtonsAction(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getViewEpicFormButtons');\n\t}\n\n\tcreateEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createEpic');\n\t}\n\n\tgetEpicsList(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicsList');\n\t}\n\n\tgetEpicListUrl(): string\n\t{\n\t\treturn '/bitrix/services/main/ajax.php?mode=class&c=bitrix:tasks.scrum&action=getEpicsList';\n\t}\n\n\tattachFilesToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'attachFilesToTask');\n\t}\n\n\tattachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'attachTagToTask');\n\t}\n\n\tbatchAttachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchAttachTagToTask');\n\t}\n\n\tdeAttachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'deAttachTagToTask');\n\t}\n\n\tbatchDeattachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchDeattachTagToTask');\n\t}\n\n\tupdateItemEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItemEpic');\n\t}\n\n\tbatchUpdateItemEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchUpdateItemEpic');\n\t}\n\n\tgetEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpic');\n\t}\n\n\teditEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'editEpic');\n\t}\n\n\tremoveEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeEpic');\n\t}\n\n\tapplyFilter(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'applyFilter');\n\t}\n\n\tgetSprintStartButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintStartButtons');\n\t}\n\n\tgetSprintCompleteButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintCompleteButtons');\n\t}\n\n\tgetBurnDownChartData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getBurnDownChartData');\n\t}\n\n\tgetTeamSpeedChartData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getTeamSpeedChartData');\n\t}\n\n\tgetDodSettings(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getDodSettings');\n\t}\n\n\tgetDodChecklist(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getDodChecklist');\n\t}\n\n\tsaveDodSettings(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'saveDodSettings');\n\t}\n\n\tupdateBorderColorToLinkedItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateBorderColorToLinkedItems');\n\t}\n\n\tgetAllUsedItemBorderColors(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getAllUsedItemBorderColors');\n\t}\n\n\tgetSubTaskItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSubTaskItems');\n\t}\n\n\tcreateType(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createType');\n\t}\n\n\tchangeTypeName(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeTypeName');\n\t}\n\n\tremoveType(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeType');\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.log(response);\n\t\t\treturn;\n\t\t}\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {RequestSender} from '../utility/request.sender';\n\ntype ListTypeItem = {\n\tNAME: string,\n\tVALUE: string\n}\n\ntype ValueTypeField = {\n\tname: string,\n\tvalue: string\n}\n\ntype Params = {\n\tfilterId: string,\n\trequestSender?: RequestSender\n}\n\nexport class Filter extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Filter');\n\n\t\tthis.filterId = params.filterId;\n\t\tthis.requestSender = params.requestSender;\n\n\t\tthis.searchFieldApplied = false;\n\n\t\tthis.initUiFilterManager();\n\t\tthis.bindHandlers();\n\t}\n\n\tinitUiFilterManager()\n\t{\n\t\t/* eslint-disable */\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\t\t/* eslint-enable */\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onApplyFilter.bind(this));\n\t}\n\n\tisSearchFieldApplied(): boolean\n\t{\n\t\treturn this.searchFieldApplied;\n\t}\n\n\tgetSearchContainer(): HTMLElement\n\t{\n\t\treturn this.filterManager.getSearch().getContainer();\n\t}\n\n\tgetFilterManager()\n\t{\n\t\treturn this.filterManager;\n\t}\n\n\tscrollToSearchContainer()\n\t{\n\t\tconst filterSearchContainer = this.getSearchContainer();\n\t\tif (!this.isNodeInViewport(filterSearchContainer))\n\t\t{\n\t\t\tfilterSearchContainer.scrollIntoView(true);\n\t\t}\n\t}\n\n\tonApplyFilter(event: BaseEvent)\n\t{\n\t\tconst [filterId, values, filterInstance, promise, params] = event.getCompatData();\n\n\t\tif (filterInstance.getSearch().getSearchString())\n\t\t{\n\t\t\tthis.searchFieldApplied = true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.searchFieldApplied = false;\n\t\t}\n\n\t\tif (this.filterId !== filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams.autoResolve = false;\n\n\t\tthis.emit('applyFilter', {\n\t\t\tpromise: promise\n\t\t});\n\t}\n\n\taddItemToListTypeField(name: string, item: ListTypeItem)\n\t{\n\t\t//todo set item to list after epic crud actions\n\n\t\tconst fieldInstances = this.filterManager.getField(name);\n\t\tconst fieldOptions = this.filterManager.getFieldByName(name);\n\n\t\tif (!fieldInstances || !fieldOptions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfieldInstances.options.ITEMS.push(item);\n\t\tfieldOptions.ITEMS.push(item);\n\n\t\tconst itemsNode = fieldInstances.node.querySelector('[data-name='+name+']');\n\n\t\tconst items = Dom.attr(itemsNode, 'data-items');\n\t\titems.push(item);\n\t\tDom.attr(itemsNode, 'data-items', items);\n\t}\n\n\tsetValueToField(value: ValueTypeField)\n\t{\n\t\tconst filterApi = this.filterManager.getApi();\n\t\tconst filterFieldsValues = this.filterManager.getFilterFieldsValues();\n\n\t\tfilterFieldsValues[value.name] = value.value;\n\n\t\tfilterApi.setFields(filterFieldsValues);\n\t\tfilterApi.apply();\n\t}\n\n\tsetValuesToField(values: ValueTypeField[], resetFields = false)\n\t{\n\t\tconst filterApi = this.filterManager.getApi();\n\n\t\tlet filterFieldsValues = {};\n\t\tif (!resetFields)\n\t\t{\n\t\t\tfilterFieldsValues = this.filterManager.getFilterFieldsValues();\n\t\t}\n\n\t\tvalues.forEach((value) => {\n\t\t\tfilterFieldsValues[value.name] = value.value;\n\t\t});\n\n\t\tfilterApi.setFields(filterFieldsValues);\n\t\tfilterApi.apply();\n\t}\n\n\tgetValueFromField(value: ValueTypeField): string\n\t{\n\t\tconst filterFieldsValues = this.filterManager.getFilterFieldsValues();\n\t\treturn filterFieldsValues[value.name];\n\t}\n\n\tresetFilter()\n\t{\n\t\tthis.filterManager.resetFilter();\n\t}\n\n\tapplyFilter()\n\t{\n\t\tthis.filterManager.applyFilter();\n\t}\n\n\tisNodeInViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\t\treturn (\n\t\t\trect.top >= 0 &&\n\t\t\trect.left >= 0 &&\n\t\t\trect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n\t\t\trect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t);\n\t}\n}","import {Loc, Tag, Text} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\n\nimport '../css/disk.manager.css';\n\nexport class DiskManager extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DiskManager');\n\n\t\tthis.diskUrls = {\n\t\t\turlSelect: '/bitrix/tools/disk/uf.php?action=selectFile&SITE_ID=' + Loc.getMessage('SITE_ID'),\n\t\t\turlRenameFile: '/bitrix/tools/disk/uf.php?action=renameFile',\n\t\t\turlDeleteFile: '/bitrix/tools/disk/uf.php?action=deleteFile',\n\t\t\turlUpload: '/bitrix/tools/disk/uf.php?action=uploadFile&ncc=1'\n\t\t};\n\n\t\tthis.attachedIds = [];\n\t}\n\n\tshowAttachmentMenu(node)\n\t{\n\t\tconst controlId = Text.getRandom();\n\n\t\tthis.popup = new Popup(\n\t\t\t`disk-manager-attachment-menu-${Text.getRandom()}`,\n\t\t\tnode,\n\t\t\t{\n\t\t\t\tcontent: this.getAttachmentsLoaderContent(controlId),\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: false,\n\t\t\t});\n\n\t\tthis.popup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: controlId,\n\t\t\tcontrolName: `[${controlId}][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect: this.diskUrls.urlSelect,\n\t\t\turlRenameFile: this.diskUrls.urlRenameFile,\n\t\t\turlDeleteFile: this.diskUrls.urlDeleteFile,\n\t\t\turlUpload: this.diskUrls.urlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.popup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show']\n\t\t);\n\n\t\tEventEmitter.subscribe('onFinish', () => {\n\t\t\tthis.popup.close();\n\t\t\tthis.emit('onFinish', this.attachedIds);\n\t\t});\n\t}\n\n\tgetAttachmentsLoaderContent(controlId)\n\t{\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t<div id=\"diskuf-selectdialog-${controlId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t<div class=\"diskuf-files-block\">\n\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t<input type=\"hidden\" name=\"[${controlId}][]\" value=\"\"/>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<label for=\"file_loader_${controlId}\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${controlId}\" type=\n\t\t\t\t\t\t\t\"file\" multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.onFileUploadSuccess.bind(this));\n\t\t//todo show loader\n\n\t\treturn filesChooser;\n\t}\n\n\tonFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.attachedIds.push(fileResult.element_id.toString());\n\t}\n}","import {Dom, Event, Loc, Tag} from 'main.core';\n\nimport '../../css/actions-panel.css';\n\nexport class ActionsPanel\n{\n\tconstructor(options)\n\t{\n\t\tthis.actionPanelNodeId = 'tasks-scrum-actions-panel';\n\n\t\tthis.bindElement = options.bindElement;\n\n\t\tthis.itemList = {...{\n\t\t\ttask: {activity: false},\n\t\t\tattachment: {activity: false},\n\t\t\tdod: {activity: false},\n\t\t\tmove: {activity: false},\n\t\t\tsprint: {activity: false},\n\t\t\tbacklog: {activity: false},\n\t\t\ttags: {activity: false},\n\t\t\tepic: {activity: false},\n\t\t\tdecomposition: {activity: false},\n\t\t\tremove: {activity: false},\n\t\t}, ...options.itemList};\n\n\t\tthis.listBlockBlurNodes = new Set();\n\t}\n\n\tshowPanel()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\n\t\tconst actionsPanelContainer = this.calculatePanelPosition(this.createActionPanel());\n\n\t\tthis.setBlockBlurNode(actionsPanelContainer);\n\n\t\tDom.append(actionsPanelContainer, document.body);\n\n\t\tconst customBlur = (event) => {\n\t\t\tlet hasNode = false;\n\t\t\tthis.listBlockBlurNodes.forEach((blockBlurNode) => {\n\t\t\t\tif (blockBlurNode.contains(event.target))\n\t\t\t\t{\n\t\t\t\t\thasNode = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!hasNode)\n\t\t\t{\n\t\t\t\tDom.remove(actionsPanelContainer);\n\t\t\t\tEvent.unbind(document, 'click', customBlur);\n\t\t\t}\n\t\t};\n\t\tEvent.bind(document, 'click', customBlur);\n\n\t\tthis.bindItems();\n\n\t\tconst actionsPanel =  actionsPanelContainer.querySelector('.tasks-scrum-actions-panel');\n\t\tif (Dom.hasClass(actionsPanel.lastElementChild, 'tasks-scrum-actions-panel-separator'))\n\t\t{\n\t\t\tDom.remove(actionsPanel.lastElementChild);\n\t\t}\n\t}\n\n\tsetBlockBlurNode(node)\n\t{\n\t\tthis.listBlockBlurNodes.add(node);\n\t}\n\n\tisShown(): Boolean\n\t{\n\t\treturn Boolean(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tcreateActionPanel()\n\t{\n\t\tlet task = '';\n\t\tlet attachment = '';\n\t\tlet dod = '';\n\t\tlet move = '';\n\t\tlet sprint = '';\n\t\tlet backlog = '';\n\t\tlet tags = '';\n\t\tlet epic = '';\n\t\tlet decomposition = '';\n\t\tlet remove = '';\n\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tthis.showTaskActionButtonNodeId = 'tasks-scrum-actions-panel-btn-task';\n\t\t\ttask = Tag.render`\n\t\t\t\t<div id=\"${this.showTaskActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-task\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TASK')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tthis.showAttachmentActionButtonNodeId = 'tasks-scrum-actions-panel-btn-attachment';\n\t\t\tattachment = Tag.render`\n\t\t\t\t<div id=\"${this.showAttachmentActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-attachment\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.dod.activity)\n\t\t{\n\t\t\tthis.showDodActionButtonNodeId = 'tasks-scrum-actions-panel-btn-dod';\n\t\t\tdod = Tag.render`\n\t\t\t\t<div id=\"${this.showDodActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-dod\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tthis.showMoveActionButtonNodeId = 'tasks-scrum-actions-panel-btn-move';\n\t\t\tmove = Tag.render`\n\t\t\t\t<div id=\"${this.showMoveActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-move\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tthis.sprintActionButtonNodeId = 'tasks-scrum-actions-panel-btn-sprint';\n\t\t\tsprint = Tag.render`\n\t\t\t\t<div id=\"${this.sprintActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-sprint\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_SPRINT')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tthis.backlogActionButtonNodeId = 'tasks-scrum-actions-panel-btn-backlog';\n\t\t\tbacklog = Tag.render`\n\t\t\t\t<div id=\"${this.backlogActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-backlog\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_BACKLOG')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tthis.tagsActionButtonNodeId = 'tasks-scrum-actions-panel-btn-tags';\n\t\t\ttags = Tag.render`\n\t\t\t\t<div  id=\"${this.tagsActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TAGS')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tthis.epicActionButtonNodeId = 'tasks-scrum-actions-panel-btn-epic';\n\t\t\tepic = Tag.render`\n\t\t\t\t<div  id=\"${this.epicActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_EPIC')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tthis.decompositionActionButtonNodeId = 'tasks-scrum-actions-panel-btn-decomposition';\n\t\t\tdecomposition = Tag.render`\n\t\t\t\t<div  id=\"${this.decompositionActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-decomposition\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tthis.removeActionButtonNodeId = 'tasks-scrum-actions-panel-btn-remove';\n\t\t\tremove = Tag.render`\n\t\t\t\t<div  id=\"${this.removeActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-remove\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.actionPanelNodeId}\" class=\"tasks-scrum-actions-panel-container\">\n\t\t\t\t<div class=\"tasks-scrum-actions-panel\">\n\t\t\t\t\t${task}\n\t\t\t\t\t${attachment}\n\t\t\t\t\t${dod}\n\t\t\t\t\t${move}\n\t\t\t\t\t${sprint}\n\t\t\t\t\t${backlog}\n\t\t\t\t\t${tags}\n\t\t\t\t\t${epic}\n\t\t\t\t\t${decomposition}\n\t\t\t\t\t${remove}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tbindItems()\n\t{\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showTaskActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.task.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showAttachmentActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.attachment.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.dod.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showDodActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.dod.callback\n\t\t\t);\n\t\t}s\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showMoveActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.move.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.sprintActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.sprint.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.backlogActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.backlog.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.tagsActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.tags.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.epicActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.epic.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.removeActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.remove.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.decompositionActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.decomposition.callback\n\t\t\t);\n\t\t}\n\t}\n\n\tcalculatePanelPosition(panel: HTMLElement)\n\t{\n\t\tconst position = Dom.getPosition(this.bindElement);\n\n\t\tconst top = `${position.top}px`;\n\t\tlet left = `${position.left}px`;\n\n\t\tconst fakePanel = panel.cloneNode(true);\n\t\tfakePanel.style.visibility = 'hidden';\n\t\tfakePanel.style.top = `${position.top}px`;\n\t\tfakePanel.style.left = `${position.left}px`;\n\n\t\tDom.append(fakePanel, document.body);\n\t\tif (this.isPanelWiderThanViewport(fakePanel))\n\t\t{\n\t\t\tconst fakePanelRect = fakePanel.getBoundingClientRect();\n\t\t\tconst windowWidth = (window.innerWidth || document.documentElement.clientWidth);\n\t\t\tleft = `${fakePanelRect.left - (fakePanelRect.right - windowWidth + 40)}px`;\n\t\t}\n\t\tDom.remove(fakePanel);\n\n\t\tpanel.style.top = top;\n\t\tpanel.style.left = left;\n\t\tpanel.style.zIndex = 1100;\n\n\t\treturn panel;\n\t}\n\n\tisPanelWiderThanViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\t\tconst windowWidth = (window.innerWidth || document.documentElement.clientWidth);\n\n\t\treturn (rect.right > windowWidth);\n\t}\n}","import {Dom, Tag, Text, Type} from 'main.core';\n\ntype TaskCounter = {\n\tcolor: string,\n\tvalue: number\n}\n\ntype Params = {\n\titemId: number|string,\n\tattachedFilesCount: number,\n\tcheckListComplete: number,\n\tcheckListAll: number,\n\ttaskCounters: TaskCounter\n}\n\nexport class TaskCounts\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.setItemId(params.itemId);\n\t\tthis.setAttachedFilesCount(params.attachedFilesCount);\n\t\tthis.setCheckListComplete(params.checkListComplete);\n\t\tthis.setCheckListAll(params.checkListAll);\n\t\tthis.setTaskCounters(params.taskCounters);\n\t}\n\n\tsetItemId(itemId: number|string)\n\t{\n\t\tthis.itemId = (\n\t\t\tType.isInteger(itemId) ? parseInt(itemId, 10) :\n\t\t\t\t(Type.isString(itemId) && itemId) ? itemId : Text.getRandom()\n\t\t);\n\t}\n\n\tsetAttachedFilesCount(count: number)\n\t{\n\t\tthis.attachedFilesCount = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetAttachedFilesCount(): number\n\t{\n\t\treturn this.attachedFilesCount;\n\t}\n\n\tsetCheckListComplete(count: number)\n\t{\n\t\tthis.checkListComplete = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetCheckListComplete(): number\n\t{\n\t\treturn this.checkListComplete;\n\t}\n\n\tsetCheckListAll(count: number)\n\t{\n\t\tthis.checkListAll = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetCheckListAll(): number\n\t{\n\t\treturn this.checkListAll;\n\t}\n\n\tsetTaskCounters(taskCounter: TaskCounter)\n\t{\n\t\tif (Type.isUndefined(taskCounter))\n\t\t{\n\t\t\ttaskCounter = {\n\t\t\t\tcolor: '',\n\t\t\t\tvalue: 0\n\t\t\t};\n\t\t}\n\n\t\tthis.taskCounter = taskCounter;\n\t}\n\n\tgetTaskCounters(): TaskCounter\n\t{\n\t\treturn this.taskCounter;\n\t}\n\n\trenderIndicators(): ?HTMLElement|string\n\t{\n\t\tthis.indicatorsNodeId = 'tasks-scrum-item-indicators-' + this.itemId;\n\n\t\treturn Tag.render`\n\t\t\t<span id=\"${this.indicatorsNodeId}\" class=\"task-title-indicators\">\n\t\t\t\t<div class=\"task-attachment-counter ui-label ui-label-sm ui-label-light\">\n\t\t\t\t\t<span class=\"ui-label-inner\">${this.attachedFilesCount}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-checklist-counter ui-label ui-label-sm ui-label-light'>\n\t\t\t\t\t<span class='ui-label-inner'>${this.checkListComplete}/${this.checkListAll}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-comments-counter'>\n\t\t\t\t\t<div class='ui-counter ${this.taskCounter.color}'>\n\t\t\t\t\t\t<div class='ui-counter-inner'>${this.taskCounter.value}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.indicatorsNode = document.getElementById(this.indicatorsNodeId);\n\n\t\tthis.attachmentNode = this.indicatorsNode.querySelector('.task-attachment-counter');\n\t\tthis.checklistNode = this.indicatorsNode.querySelector('.task-checklist-counter');\n\t\tthis.commentsNode = this.indicatorsNode.querySelector('.task-comments-counter');\n\n\t\tthis.updateVisibility();\n\t}\n\n\t//todo update all object data and render\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (!this.indicatorsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.attachedFilesCount)\n\t\t{\n\t\t\tthis.attachedFilesCount = parseInt(data.attachedFilesCount, 10);\n\t\t\tthis.attachmentNode.firstElementChild.textContent = this.attachedFilesCount;\n\t\t}\n\t\tif (data.checkListComplete)\n\t\t{\n\t\t\tthis.checkListComplete = parseInt(data.checkListComplete, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\t\tif (data.checkListAll)\n\t\t{\n\t\t\tthis.checkListAll = parseInt(data.checkListAll, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\n\t\tif (data.taskCounter)\n\t\t{\n\t\t\tthis.setTaskCounters(data.taskCounter);\n\n\t\t\tconst commentCounter = this.commentsNode.querySelector('.ui-counter');\n\t\t\tconst innerCommentCounter = this.commentsNode.querySelector('.ui-counter-inner');\n\n\t\t\tcommentCounter.className = `ui-counter ${Text.encode(this.taskCounter.color)}`;\n\t\t\tinnerCommentCounter.textContent = parseInt(this.taskCounter.value, 10);\n\t\t}\n\n\t\tthis.updateVisibility();\n\t}\n\n\tupdateVisibility()\n\t{\n\t\tif (this.attachedFilesCount > 0)\n\t\t{\n\t\t\tthis.showNode(this.attachmentNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.attachmentNode);\n\t\t}\n\n\t\tif (this.checkListAll > 0)\n\t\t{\n\t\t\tthis.showNode(this.checklistNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.checklistNode);\n\t\t}\n\n\t\tif (this.taskCounter.value > 0)\n\t\t{\n\t\t\tthis.showNode(this.commentsNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.commentsNode);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'inline-flex');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}","import {Type} from 'main.core';\n\nexport class StoryPoints\n{\n\tconstructor()\n\t{\n\t\tthis.clearPoints();\n\n\t\tthis.differencePoints = 0;\n\t}\n\n\tsetPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.saveDifferencePoints((this.storyPoints ? this.storyPoints : 0), storyPoints);\n\n\t\tthis.storyPoints = String(storyPoints);\n\t}\n\n\tgetPoints(): string\n\t{\n\t\treturn String(this.storyPoints);\n\t}\n\n\taddPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStoryPoints = (this.storyPoints !== '' ? parseFloat(this.storyPoints) : 0);\n\t\tconst inputStoryPoints = parseFloat(storyPoints);\n\n\t\tlet result = (currentStoryPoints + inputStoryPoints);\n\n\t\tif (Type.isFloat(result))\n\t\t{\n\t\t\tresult = result.toFixed(1);\n\t\t}\n\n\t\tthis.storyPoints = String(result);\n\t}\n\n\tsubtractPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStoryPoints = (this.storyPoints !== '' ? parseFloat(this.storyPoints) : 0);\n\t\tconst inputStoryPoints = parseFloat(storyPoints);\n\n\t\tlet result = (currentStoryPoints - inputStoryPoints);\n\n\t\tif (Type.isFloat(result))\n\t\t{\n\t\t\tresult = result.toFixed(1);\n\t\t}\n\n\t\tthis.storyPoints = String(result);\n\t}\n\n\tclearPoints()\n\t{\n\t\tthis.storyPoints = '';\n\t}\n\n\tsaveDifferencePoints(firstPoints: string, secondPoints: string)\n\t{\n\t\tthis.differencePoints = 0;\n\n\t\tif (Type.isUndefined(firstPoints) || isNaN(parseFloat(firstPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isUndefined(secondPoints) || isNaN(parseFloat(secondPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfirstPoints = parseFloat(firstPoints);\n\t\tsecondPoints = parseFloat(secondPoints);\n\n\t\tthis.differencePoints = (secondPoints - firstPoints);\n\t}\n\n\tgetDifferencePoints(): number\n\t{\n\t\treturn this.differencePoints;\n\t}\n}","import {Type, Dom, Event, Tag, Text, Loc, Runtime} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Label} from 'ui.label';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {Dialog} from 'ui.entity-selector';\n\nimport {DiskManager} from '../service/disk.manager';\n\nimport {ActionsPanel} from './task/actions.panel';\nimport {TaskCounts} from './task/taskcounts';\n\nimport {StoryPoints} from '../utility/story.points';\n\nimport '../css/item.css';\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\nexport type EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tinfo: EpicInfoType\n}\n\ntype AllowedActions = {\n\ttask_edit: boolean,\n\ttask_remove: boolean,\n}\n\nexport type Responsible = {\n\tid: number,\n\tname: string,\n\tpathToUser: string,\n\tphoto: {\n\t\tsrc: string\n\t}\n}\n\ntype ItemInfo = {\n\tcolor?: string,\n\tborderColor?: string\n}\n\ntype SubTaskInfo = {\n\tsourceId: number,\n\tcompleted: 'Y' | 'N',\n\tstoryPoints: string | StoryPoints\n}\n\ntype SubTasksInfo = {\n\t[sourceId: number]: SubTaskInfo\n}\n\nexport type ItemParams = {\n\titemId: number|string,\n\ttmpId: string,\n\tname: string,\n\titemType?: string,\n\tsort?: number,\n\tinfo?: ItemInfo,\n\tentityId?: number,\n\tentityType?: string,\n\tparentId?: number,\n\tsourceId?: number,\n\tresponsible?: Responsible,\n\tstoryPoints?: string,\n\tcompleted?: 'Y' | 'N',\n\tallowedActions?: AllowedActions,\n\tepic?: EpicType,\n\ttags?: Array,\n\tisParentTask?: 'Y' | 'N',\n\tsubTasksCount?: number,\n\tsubTasksInfo?: SubTasksInfo,\n\tisLinkedTask?: 'Y' | 'N',\n\tparentTaskId?: number,\n\tisSubTask?: 'Y' | 'N'\n};\n\n//todo single responsibility principle\nexport class Item extends EventEmitter\n{\n\tconstructor(params: ItemParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item');\n\n\t\tthis.setItemParams(params);\n\n\t\tthis.groupMode = false;\n\t\tthis.previewMode = false;\n\t}\n\n\tsetItemParams(params: ItemParams)\n\t{\n\t\tthis.setItemNode();\n\n\t\tthis.setItemId(params.itemId);\n\t\tthis.setTmpId(params.tmpId);\n\t\tthis.setName(params.name);\n\t\tthis.setItemType(params.itemType);\n\t\tthis.setSort(params.sort);\n\t\tthis.setEntityId(params.entityId);\n\t\tthis.setEntityType(params.entityType);\n\t\tthis.setParentId(params.parentId);\n\t\tthis.setSourceId(params.sourceId);\n\t\tthis.setInfo(params.info);\n\n\t\tthis.setParentTask(params.isParentTask);\n\t\tthis.setSubTasksCount(params.subTasksCount);\n\t\tthis.setLinkedTask(params.isLinkedTask);\n\t\tthis.setParentTaskId(params.parentTaskId);\n\t\tthis.setSubTask(params.isSubTask);\n\t\tthis.setSubTasksInfo(params.subTasksInfo);\n\t\tthis.setResponsible(params.responsible);\n\t\tthis.setCompleted(params.completed);\n\t\tthis.setDisableStatus(this.isCompleted());\n\t\tthis.setAllowedActions(params.allowedActions);\n\t\tthis.setEpic(params.epic);\n\t\tthis.setTags(params.tags);\n\t\tthis.setTaskCounts(params);\n\n\t\tthis.setStoryPoints(params.storyPoints);\n\t}\n\n\tstatic buildItem(params: ItemParams): Item\n\t{\n\t\treturn new Item(params);\n\t}\n\n\tsetItemId(itemId: number|string)\n\t{\n\t\tthis.itemId = (\n\t\t\tType.isInteger(itemId) ? parseInt(itemId, 10) :\n\t\t\t\t(Type.isString(itemId) && itemId) ? itemId : Text.getRandom()\n\t\t);\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.getItemNode().dataset.itemId = this.itemId;\n\t\t}\n\t}\n\n\tgetItemId()\n\t{\n\t\treturn this.itemId;\n\t}\n\n\tsetTmpId(tmpId: string)\n\t{\n\t\tthis.tmpId = (Type.isString(tmpId) ? tmpId : '');\n\t}\n\n\tgetTmpId(): string\n\t{\n\t\treturn this.tmpId;\n\t}\n\n\tsetName(name: string)\n\t{\n\t\tthis.name = ((Type.isString(name) && name) ? name : '');\n\n\t\tif (!this.name)\n\t\t{\n\t\t\tthrow new Error(Loc.getMessage('TASKS_SCRUM_TASK_ADD_NAME_ERROR'));\n\t\t}\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name-field');\n\t\t\tnameNode.querySelector('.ui-ctl-element').textContent = Text.encode(this.name);\n\t\t}\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetItemType(type: string)\n\t{\n\t\tthis.itemType = (Type.isString(type) ? type : 'task');\n\t}\n\n\tgetItemType()\n\t{\n\t\treturn this.itemType;\n\t}\n\n\tsetSort(sort: number)\n\t{\n\t\tthis.setPreviousSort(this.sort);\n\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tDom.attr(this.getItemNode(), 'data-sort', this.sort);\n\t\t}\n\t}\n\n\tgetSort(): number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetPreviousSort(sort: number)\n\t{\n\t\tthis.previousSort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\t}\n\n\tgetPreviousSort(): number\n\t{\n\t\treturn this.previousSort;\n\t}\n\n\tsetEntityId(entityId: number)\n\t{\n\t\tthis.entityId = (Type.isInteger(entityId) ? parseInt(entityId, 10) : 0);\n\t}\n\n\tgetEntityId(): number\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tsetEntityType(entityType: string)\n\t{\n\t\tthis.entityType = (new Set(['backlog', 'sprint']).has(entityType) ? entityType : 'backlog');\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.entityType;\n\t}\n\n\tsetParentId(parentId: number)\n\t{\n\t\tthis.parentId = (Type.isInteger(parentId) ? parseInt(parentId, 10) : 0);\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetSourceId(sourceId: number)\n\t{\n\t\tthis.sourceId = (Type.isInteger(sourceId) ? parseInt(sourceId, 10) : 0);\n\t}\n\n\tgetSourceId()\n\t{\n\t\treturn this.sourceId;\n\t}\n\n\tsetResponsible(responsible: Responsible)\n\t{\n\t\tthis.responsible = (Type.isPlainObject(responsible) ? responsible : null);\n\n\t\tif (this.responsible && this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateResponsible();\n\t\t}\n\t}\n\n\tgetResponsible(): Responsible\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.storyPoints)\n\t\t{\n\t\t\tthis.storyPoints = new StoryPoints();\n\t\t}\n\n\t\tthis.storyPoints.setPoints(storyPoints);\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\tif (this.isParentTask())\n\t\t{\n\t\t\tconst storyPoints = new StoryPoints();\n\n\t\t\tObject.values(this.getSubTasksInfo()).map((subTaskInfo: SubTaskInfo) => {\n\t\t\t\tif (subTaskInfo.storyPoints instanceof StoryPoints)\n\t\t\t\t{\n\t\t\t\t\tstoryPoints.addPoints(subTaskInfo.storyPoints.getPoints());\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn storyPoints;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.storyPoints;\n\t\t}\n\t}\n\n\tupdateStoryPointsNode()\n\t{\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tconst storyPointsNode = this.getItemNode().querySelector('.tasks-scrum-item-story-points');\n\t\t\tstoryPointsNode.querySelector('.ui-ctl-element').textContent = Text.encode(\n\t\t\t\tthis.getStoryPoints().getPoints()\n\t\t\t);\n\n\t\t\tthis.sendEventToUpdateStoryPoints();\n\t\t}\n\t}\n\n\tsetSubTasksInfo(subTasksInfo: SubTasksInfo)\n\t{\n\t\tif (Type.isUndefined(subTasksInfo))\n\t\t{\n\t\t\tthis.subTasksInfo = [];\n\n\t\t\treturn;\n\t\t}\n\n\t\tObject.values(subTasksInfo).map((subTaskInfo: SubTaskInfo) => {\n\t\t\tconst storyPoints = new StoryPoints();\n\t\t\tif (Type.isString(subTaskInfo.storyPoints))\n\t\t\t{\n\t\t\t\tstoryPoints.setPoints(subTaskInfo.storyPoints);\n\t\t\t}\n\t\t\tsubTaskInfo.storyPoints = storyPoints;\n\t\t});\n\n\t\tthis.subTasksInfo = subTasksInfo;\n\t}\n\n\tgetSubTasksInfo(): SubTasksInfo\n\t{\n\t\treturn this.subTasksInfo;\n\t}\n\n\tupdateSubTasksPoints(sourceId: number, storyPoints: StoryPoints)\n\t{\n\t\tlet newSubTasksInfo = this.getSubTasksInfo();\n\t\tif (Type.isArray(newSubTasksInfo))\n\t\t{\n\t\t\tnewSubTasksInfo = {};\n\t\t\tnewSubTasksInfo[sourceId] = {\n\t\t\t\tsourceId: sourceId,\n\t\t\t\tcompleted: 'N',\n\t\t\t\tstoryPoints: storyPoints.getPoints()\n\t\t\t};\n\t\t\tthis.setSubTasksInfo(newSubTasksInfo);\n\n\t\t\tthis.updateStoryPointsNode();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst subTasksInfo = this.getSubTasksInfo();\n\n\t\tif (subTasksInfo.hasOwnProperty(sourceId))\n\t\t{\n\t\t\tsubTasksInfo[sourceId].storyPoints = storyPoints;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsubTasksInfo[sourceId] = {\n\t\t\t\tsourceId: sourceId,\n\t\t\t\tcompleted: 'N',\n\t\t\t\tstoryPoints: storyPoints\n\t\t\t};\n\t\t}\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetCompletedSubTasksStoryPoints(): StoryPoints\n\t{\n\t\tconst storyPoints = new StoryPoints();\n\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tstoryPoints.setPoints(this.storyPoints.getPoints());\n\t\t}\n\n\t\tObject.values(this.getSubTasksInfo()).map((subTaskInfo: SubTaskInfo) => {\n\t\t\tif (subTaskInfo.completed === 'Y')\n\t\t\t{\n\t\t\t\tif (subTaskInfo.storyPoints instanceof StoryPoints)\n\t\t\t\t{\n\t\t\t\t\tstoryPoints.addPoints(subTaskInfo.storyPoints.getPoints());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn storyPoints;\n\t}\n\n\tgetUncompletedSubTasksStoryPoints(): StoryPoints\n\t{\n\t\tconst storyPoints = new StoryPoints();\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tstoryPoints.setPoints(this.storyPoints.getPoints());\n\t\t}\n\n\t\tObject.values(this.getSubTasksInfo()).map((subTaskInfo: SubTaskInfo) => {\n\t\t\tif (subTaskInfo.completed === 'N')\n\t\t\t{\n\t\t\t\tif (subTaskInfo.storyPoints instanceof StoryPoints)\n\t\t\t\t{\n\t\t\t\t\tstoryPoints.addPoints(subTaskInfo.storyPoints.getPoints());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn storyPoints;\n\t}\n\n\tsetCompleted(value: string)\n\t{\n\t\tthis.completed = (value === 'Y');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateCompletedStatus();\n\t\t}\n\t}\n\n\tsetAllowedActions(allowedActions: AllowedActions)\n\t{\n\t\tthis.allowedActions = (Type.isPlainObject(allowedActions) ? allowedActions : {});\n\t}\n\n\tsetEpic(epic: EpicType)\n\t{\n\t\tthis.epic = (Type.isPlainObject(epic) ? epic : null);\n\t}\n\n\tgetEpic(): EpicType\n\t{\n\t\treturn this.epic;\n\t}\n\n\tsetTags(tags)\n\t{\n\t\tthis.tags = (Type.isArray(tags) ? tags : []);\n\t}\n\n\tgetTags(): Array\n\t{\n\t\treturn this.tags;\n\t}\n\n\tsetParentTask(value: string)\n\t{\n\t\tthis.parentTask = (value === 'Y');\n\t}\n\n\tisParentTask(): boolean\n\t{\n\t\treturn this.parentTask;\n\t}\n\n\tsetSubTasksCount(count: number)\n\t{\n\t\tthis.subTasksCount = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetSubTasksCount(): number\n\t{\n\t\treturn this.subTasksCount;\n\t}\n\n\tsetLinkedTask(value: string)\n\t{\n\t\tthis.linkedTask = (value === 'Y');\n\t}\n\n\tisLinkedTask(): boolean\n\t{\n\t\treturn this.linkedTask;\n\t}\n\n\tsetParentTaskId(id: number)\n\t{\n\t\tthis.parentTaskId = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\t}\n\n\tgetParentTaskId(): number\n\t{\n\t\treturn this.parentTaskId;\n\t}\n\n\tsetSubTask(value: string)\n\t{\n\t\tthis.subTask = (value === 'Y');\n\t}\n\n\tisSubTask(): boolean\n\t{\n\t\treturn this.subTask;\n\t}\n\n\tsetTaskCounts(params: ItemParams)\n\t{\n\t\tthis.taskCounts = (this.itemType === 'task' ? new TaskCounts(params) : null);\n\t}\n\n\tgetTaskCounts(): TaskCounts|null\n\t{\n\t\treturn this.taskCounts;\n\t}\n\n\tcleanTaskCounts()\n\t{\n\t\tthis.taskCounts = null;\n\t}\n\n\tsetInfo(info: ?ItemInfo)\n\t{\n\t\tif (Type.isUndefined(info))\n\t\t{\n\t\t\tthis.info = {\n\t\t\t\tcolor: '',\n\t\t\t\tborderColor: ''\n\t\t\t};\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.info = info;\n\n\t\tthis.setBorderColor(this.info.borderColor);\n\t}\n\n\tgetInfo(): ?ItemInfo\n\t{\n\t\treturn this.info;\n\t}\n\n\tsetBorderColor(color: string)\n\t{\n\t\tthis.info.borderColor = (Type.isString(color) ? color : '');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tif (this.getBorderColor())\n\t\t\t{\n\t\t\t\tDom.style(this.getItemNode(), 'border', '2px solid ' + this.getBorderColor());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.style(this.getItemNode(), 'border', null);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetBorderColor(): string\n\t{\n\t\treturn (Type.isString(this.info.borderColor) ? this.info.borderColor : '');\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn this.completed;\n\t}\n\n\tupdateCompletedStatus()\n\t{\n\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name');\n\t\tconst nameTextNode = nameNode.querySelector('.ui-ctl-element');\n\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tDom.style(nameTextNode, 'textDecoration', 'line-through');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(nameTextNode, 'textDecoration', null);\n\t\t}\n\n\t\tthis.sendEventToUpdateStoryPoints();\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn this.disableStatus;\n\t}\n\n\tsetMoveActivity(value: boolean)\n\t{\n\t\tthis.moveActivity = Boolean(value);\n\t}\n\n\tisMovable(): boolean\n\t{\n\t\treturn this.moveActivity;\n\t}\n\n\tsetDisableStatus(status: boolean)\n\t{\n\t\tthis.disableStatus = Boolean(status);\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (status)\n\t\t{\n\t\t\tthis.hideNode(this.getItemNode().querySelector('.tasks-scrum-dragndrop'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showNode(this.getItemNode().querySelector('.tasks-scrum-dragndrop'));\n\t\t}\n\t}\n\n\tactivateGroupMode()\n\t{\n\t\tthis.groupMode = true;\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\tconst groupModeCheckbox = groupModeContainer.querySelector('input');\n\t\tgroupModeCheckbox.checked = false;\n\n\t\tEvent.bind(groupModeCheckbox, 'change', (event) => {\n\t\t\tDom.toggleClass(this.getItemNode(), 'tasks-scrum-item-group-mode');\n\t\t\tif (this.getItemNode().classList.contains('tasks-scrum-item-group-mode'))\n\t\t\t{\n\t\t\t\tthis.emit('addItemToGroupMode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emit('removeItemFromGroupMode');\n\t\t\t}\n\t\t\tthis.showActionsPanel(event);\n\t\t});\n\n\t\tthis.showNode(groupModeContainer);\n\n\t\tthis.deactivateDragNDrop();\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getItemNode(), 'tasks-scrum-item-group-mode');\n\n\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\tthis.hideNode(groupModeContainer);\n\n\t\tEvent.unbindAll(groupModeContainer.querySelector('input'));\n\n\t\tthis.groupMode = false;\n\n\t\tthis.activateDragNDrop();\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\tactivatePreviewMode()\n\t{\n\t\tthis.previewMode = true;\n\t}\n\n\tisPreviewMode(): boolean\n\t{\n\t\treturn this.previewMode;\n\t}\n\n\tgetPreviewVersion(): Item\n\t{\n\t\tconst previewItem = Runtime.clone(this);\n\n\t\tpreviewItem.setItemId();\n\t\tpreviewItem.itemNode = null;\n\t\tpreviewItem.activatePreviewMode();\n\t\tpreviewItem.taskCounts = null\n\n\t\treturn previewItem;\n\t}\n\n\tactivateDecompositionMode(color: string)\n\t{\n\t\tthis.decompositionMode = true;\n\n\t\tif (this.getBorderColor() === '')\n\t\t{\n\t\t\tthis.setBorderColor(color);\n\t\t}\n\n\t\tif (this.getBorderColor())\n\t\t{\n\t\t\tDom.style(this.getItemNode(), 'border', '2px solid ' + this.getBorderColor());\n\t\t}\n\n\t\tthis.deactivateDragNDrop();\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.decompositionMode = false;\n\n\t\tif (this.getBorderColor() === '')\n\t\t{\n\t\t\tthis.setBorderColor();\n\t\t\tDom.style(this.getItemNode(), 'border', null);\n\t\t}\n\n\t\tthis.activateDragNDrop();\n\t}\n\n\tactivateDragNDrop()\n\t{\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tif (!this.getItemNode().classList.contains('tasks-scrum-item-drag'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.getItemNode(), 'tasks-scrum-item-drag');\n\t\t\t}\n\t\t}\n\t}\n\n\tdeactivateDragNDrop()\n\t{\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tDom.removeClass(this.getItemNode(), 'tasks-scrum-item-drag');\n\t\t}\n\t}\n\n\tisDecompositionMode(): boolean\n\t{\n\t\treturn this.decompositionMode;\n\t}\n\n\tsetItemNode(node?: HTMLElement)\n\t{\n\t\ttry\n\t\t{\n\t\t\tthis.itemNode = ((node instanceof HTMLElement) ? node : null);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tthis.itemNode = null;\n\t\t}\n\t}\n\n\tgetItemNode(): HTMLElement|null\n\t{\n\t\treturn this.itemNode;\n\t}\n\n\tisNodeCreated(): boolean\n\t{\n\t\treturn (this.itemNode !== null);\n\t}\n\n\tsetParentEntity(entityId: number, entityType: string)\n\t{\n\t\tthis.setEntityId(entityId);\n\t\tthis.setEntityType(entityType);\n\t}\n\n\tisEditAllowed(): boolean\n\t{\n\t\treturn Boolean(this.allowedActions['task_edit']);\n\t}\n\n\tisRemoveAllowed(): boolean\n\t{\n\t\treturn Boolean(this.allowedActions['task_remove']);\n\t}\n\n\tupdateYourself(tmpItem: Item)\n\t{\n\t\tif (tmpItem.getName() !== this.getName())\n\t\t{\n\t\t\tthis.setName(tmpItem.getName());\n\t\t}\n\t\tif (tmpItem.getEntityId() !== this.getEntityId())\n\t\t{\n\t\t\tthis.setEntityId(tmpItem.getEntityId());\n\t\t}\n\t\tif (tmpItem.getResponsible().id !== this.getResponsible().id)\n\t\t{\n\t\t\tthis.setResponsible(tmpItem.getResponsible());\n\t\t}\n\t\tif (tmpItem.getStoryPoints().getPoints() !== this.getStoryPoints().getPoints())\n\t\t{\n\t\t\tthis.setStoryPoints(tmpItem.getStoryPoints().getPoints());\n\t\t}\n\t\tif (this.getTaskCounts() && tmpItem.getTaskCounts())\n\t\t{\n\t\t\tthis.getTaskCounts().updateIndicators({\n\t\t\t\tattachedFilesCount: tmpItem.getTaskCounts().getAttachedFilesCount(),\n\t\t\t\tcheckListComplete: tmpItem.getTaskCounts().getCheckListComplete(),\n\t\t\t\tcheckListAll: tmpItem.getTaskCounts().getCheckListAll(),\n\t\t\t\ttaskCounter: tmpItem.getTaskCounts().getTaskCounters(),\n\t\t\t});\n\t\t}\n\t\tif (tmpItem.isCompleted() !== this.isCompleted())\n\t\t{\n\t\t\tthis.setCompleted(tmpItem.isCompleted() ? 'Y' : 'N')\n\t\t}\n\n\t\tthis.setParentId(tmpItem.getParentId());\n\t\tthis.setEpicAndTags(tmpItem.getEpic(), tmpItem.getTags());\n\t\tthis.setInfo(tmpItem.getInfo());\n\n\t\tthis.setParentTask(tmpItem.isParentTask() ? 'Y' : 'N');\n\t\tthis.setSubTasksCount(tmpItem.getSubTasksCount());\n\t\tthis.setLinkedTask(tmpItem.isLinkedTask() ? 'Y' : 'N');\n\t\tthis.setParentTaskId(tmpItem.getParentTaskId());\n\t\tthis.setSubTask(tmpItem.isSubTask() ? 'Y' : 'N');\n\n\t\tthis.setSubTasksInfo(tmpItem.getSubTasksInfo());\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateParentTaskNodes();\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.getItemNode());\n\t\tthis.setItemNode();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet itemClassName = 'tasks-scrum-item';\n\t\tif (this.isSubTask())\n\t\t{\n\t\t\titemClassName += ' tasks-scrum-subtask-item'\n\t\t}\n\n\t\tthis.itemNode = Tag.render`\n\t\t\t<div data-item-id=\"${Text.encode(this.itemId)}\" data-sort=\n\t\t\t\t\"${Text.encode(this.sort)}\" class=\"${itemClassName}\">\n\t\t\t\t<div class=\"tasks-scrum-item-inner\">\n\t\t\t\t\t<div class=\"tasks-scrum-item-group-mode-container\">\n\t\t\t\t\t\t<input type=\"checkbox\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-item-name\">\n\t\t\t\t\t\t${this.renderName()}\n\t\t\t\t\t\t${(this.taskCounts && this.itemType === 'task' ? this.taskCounts.renderIndicators() : '')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-item-params\">\n\t\t\t\t\t\t${this.renderSubTasksCounter()}\n\t\t\t\t\t\t${this.renderResponsible()}\n\t\t\t\t\t\t${this.renderStoryPoints()}\n\t\t\t\t\t\t${this.renderSubTasksTick()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.renderTags()}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.isNodeCreated() && this.getBorderColor())\n\t\t{\n\t\t\tDom.style(this.itemNode, 'border', '2px solid ' + this.getBorderColor());\n\t\t}\n\n\t\treturn this.itemNode;\n\t}\n\n\trenderName(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-name-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-no-border\">\n\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t${Text.encode(this.name)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderResponsible(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"ui-icon ui-icon-common-user tasks-scrum-item-responsible\"><i></i></div>`;\n\t}\n\n\trenderStoryPoints(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-story-points\">\n\t\t\t\t<div class=\"tasks-scrum-item-story-points-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-auto ui-ctl-no-border\">\n\t\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t\t${Text.encode(this.getStoryPoints().getPoints())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderSubTasksCounter(): HTMLElement\n\t{\n\t\tif (!this.isParentTask())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst subTasksCounter = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-subtasks-btn\">\n\t\t\t\t<span class=\"tasks-scrum-item-subtasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-item-subtasks-count\">\n\t\t\t\t\t${this.getSubTasksCount()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(subTasksCounter, 'click', () => {\n\t\t\tthis.emit('showTask');\n\t\t});\n\n\t\treturn subTasksCounter;\n\t}\n\n\trenderSubTasksTick(): HTMLElement\n\t{\n\t\tif (!this.isParentTask() || this.isPreviewMode())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tif (this.getEntityType() === 'backlog')\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst subTasksTick = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-subtasks-tick\">\n\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ui-btn-icon-angle-down\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(subTasksTick, 'click', () => {\n\t\t\tif (!this.isDecompositionMode())\n\t\t\t{\n\t\t\t\tthis.emit('toggleSubTasks');\n\t\t\t}\n\t\t});\n\n\t\treturn subTasksTick;\n\t}\n\n\ttoggleSubTasksTick()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst subTasksTick = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\n\t\tif (subTasksTick)\n\t\t{\n\t\t\tsubTasksTick.firstElementChild.classList.toggle('ui-btn-icon-angle-up');\n\t\t\tsubTasksTick.firstElementChild.classList.toggle('ui-btn-icon-angle-down');\n\t\t}\n\t}\n\n\tupSubTasksTick()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst subTasksTick = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\n\t\tif (subTasksTick)\n\t\t{\n\t\t\tDom.removeClass(subTasksTick.firstElementChild, 'ui-btn-icon-angle-down');\n\t\t\tDom.addClass(subTasksTick.firstElementChild, 'ui-btn-icon-angle-up');\n\t\t}\n\t}\n\n\tdownSubTasksTick()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst subTasksTick = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\n\t\tif (subTasksTick)\n\t\t{\n\t\t\tDom.removeClass(subTasksTick.firstElementChild, 'ui-btn-icon-angle-up');\n\t\t\tDom.addClass(subTasksTick.firstElementChild, 'ui-btn-icon-angle-down');\n\t\t}\n\t}\n\n\trenderTags(): ?HTMLElement|string\n\t{\n\t\tif (this.epic === null && this.tags.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEpicTag(): ?HTMLElement\n\t{\n\t\tif (this.epic === null)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst getContrastYIQ = (hexcolor) => {\n\t\t\tif (!hexcolor)\n\t\t\t{\n\t\t\t\thexcolor = Label.Color.DEFAULT;\n\t\t\t}\n\t\t\thexcolor = hexcolor.replace('#', '');\n\t\t\tconst r = parseInt(hexcolor.substr(0, 2), 16);\n\t\t\tconst g = parseInt(hexcolor.substr(2, 2), 16);\n\t\t\tconst b = parseInt(hexcolor.substr(4, 2), 16);\n\t\t\tconst yiq = ((r * 299 ) + (g* 587 ) + (b * 114)) / 1000;\n\t\t\treturn (yiq >= 128) ? 'black' : 'white';\n\t\t};\n\n\t\tconst epicLabel = new Label({\n\t\t\ttext: this.epic.name,\n\t\t\tcolor: Label.Color.DEFAULT,\n\t\t\tsize: Label.Size.MD,\n\t\t\tcustomClass: 'tasks-scrum-item-epic-label'\n\t\t});\n\t\tconst container = epicLabel.getContainer();\n\t\tconst innerLabel = container.querySelector('.ui-label-inner');\n\n\t\tconst contrast = getContrastYIQ(this.epic.info.color);\n\t\tif (contrast === 'white')\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#ffffff');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#525c69');\n\t\t}\n\t\tDom.style(container, 'backgroundColor', this.epic.info.color);\n\n\t\tEvent.bind(container, 'click', (event) => {\n\t\t\tif (this.isGroupMode())\n\t\t\t{\n\t\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\t\tthis.showActionsPanel(event);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emit('filterByEpic', this.epic.id);\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tgetListTagNodes(): HTMLElement\n\t{\n\t\treturn this.tags.map((tag) => {\n\t\t\tconst tagLabel = new Label({\n\t\t\t\ttext: tag,\n\t\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\t\tfill: true,\n\t\t\t\tsize: Label.Size.SM,\n\t\t\t\tcustomClass: ''\n\t\t\t});\n\t\t\tconst container = tagLabel.getContainer();\n\t\t\tEvent.bind(container, 'click', (event) => {\n\t\t\t\tif (this.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\t\t\tthis.showActionsPanel(event);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.emit('filterByTag', tag);\n\t\t\t});\n\t\t\treturn container;\n\t\t});\n\t}\n\n\t// todo remove all method\n\tonAfterAppend(container)\n\t{\n\t\tthis.setItemNode(container.querySelector('[data-item-id=\"'+this.itemId+'\"]'));\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.onAfterAppend();\n\t\t}\n\n\t\tthis.updateResponsible();\n\n\t\tif (this.isPreviewMode())\n\t\t{\n\t\t\tEvent.bind(this.getItemNode(), 'click', () => this.emit('showTask'));\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isDecompositionMode())\n\t\t{\n\t\t\tthis.activateDragNDrop();\n\t\t}\n\n\t\tif (this.isSubTask())\n\t\t{\n\t\t\tthis.deactivateDragNDrop();\n\t\t}\n\n\t\tEvent.unbindAll(this.getItemNode());\n\t\tEvent.bind(this.getItemNode(), 'click', this.onItemClick.bind(this));\n\n\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name');\n\t\tEvent.unbindAll(nameNode);\n\t\tEvent.bind(nameNode, 'click', this.onNameClick.bind(this));\n\n\t\tconst responsibleNode = this.getItemNode().querySelector('.tasks-scrum-item-responsible');\n\t\tEvent.unbindAll(responsibleNode);\n\t\tEvent.bind(responsibleNode, 'click', this.onResponsibleClick.bind(this));\n\n\t\tconst storyPointsNode = this.getItemNode().querySelector('.tasks-scrum-item-story-points');\n\t\tEvent.unbindAll(storyPointsNode);\n\t\tEvent.bind(storyPointsNode, 'click', this.onStoryPointsClick.bind(this));\n\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tconst nameTextNode = nameNode.querySelector('.ui-ctl-element');\n\t\t\tDom.style(nameTextNode, 'textDecoration', 'line-through');\n\t\t}\n\n\t\tthis.updateParentTaskNodes();\n\t}\n\n\tisShowIndicators(): Boolean\n\t{\n\t\treturn Boolean(this.attachedFilesCount || this.checkListAll || this.newCommentsCount);\n\t}\n\n\tupdateParentTaskNodes()\n\t{\n\t\tif (this.isParentTask())\n\t\t{\n\t\t\tconst subTasksCounterNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-btn');\n\t\t\tif (subTasksCounterNode)\n\t\t\t{\n\t\t\t\tDom.replace(subTasksCounterNode, this.renderSubTasksCounter());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst paramsNode = this.getItemNode().querySelector('.tasks-scrum-item-params');\n\t\t\t\tconst subTasksCounterNode = this.renderSubTasksCounter();\n\t\t\t\tDom.insertBefore(subTasksCounterNode, paramsNode.firstElementChild);\n\t\t\t}\n\n\t\t\tconst subTasksTickNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\t\t\tif (subTasksTickNode)\n\t\t\t{\n\t\t\t\tconst newSubTasksTickNode = this.renderSubTasksTick();\n\t\t\t\tif (newSubTasksTickNode)\n\t\t\t\t{\n\t\t\t\t\tDom.replace(subTasksTickNode, newSubTasksTickNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.remove(subTasksTickNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst paramsNode = this.getItemNode().querySelector('.tasks-scrum-item-params');\n\t\t\t\tconst newSubTasksTickNode = this.renderSubTasksTick();\n\t\t\t\tDom.append(newSubTasksTickNode, paramsNode);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst subTasksCounterNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-btn');\n\t\t\tif (subTasksCounterNode)\n\t\t\t{\n\t\t\t\tDom.remove(subTasksCounterNode);\n\t\t\t}\n\t\t\tconst subTasksTickNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\t\t\tif (subTasksTickNode)\n\t\t\t{\n\t\t\t\tDom.remove(subTasksTickNode);\n\t\t\t}\n\t\t}\n\t}\n\n\tonItemClick(event)\n\t{\n\t\tif (this.isClickOnEditableName(event) && !this.isGroupMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst ignoreTagList = new Set(['I', 'SPAN', 'INPUT']);\n\t\tif (ignoreTagList.has(event.target.tagName))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.target.closest('.tasks-scrum-item-subtasks-tick'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clickToGroupModeCheckbox();\n\n\t\tthis.showActionsPanel(event);\n\t}\n\n\tisClickOnEditableName(event): boolean\n\t{\n\t\treturn (event.target.classList.contains('ui-ctl-element'));\n\t}\n\n\tonNameClick(event)\n\t{\n\t\tif (this.isClickOnEditableName(event) && !this.isGroupMode())\n\t\t{\n\t\t\tthis.emit('showTask');\n\t\t}\n\t}\n\n\tclickToGroupModeCheckbox()\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\t\tconst groupModeCheckbox = groupModeContainer.querySelector('input');\n\t\t\tgroupModeCheckbox.click();\n\t\t}\n\t}\n\n\tonResponsibleClick(event)\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst responsibleNode = event.currentTarget;\n\n\t\tconst dialog = new Dialog({\n\t\t\ttargetNode: responsibleNode,\n\t\t\tenableSearch: true,\n\t\t\tcontext: 'TASKS',\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tthis.responsible = {\n\t\t\t\t\t\tid: selectedItem.getId(),\n\t\t\t\t\t\tname: selectedItem.getTitle(),\n\t\t\t\t\t\tphoto: {\n\t\t\t\t\t\t\tsrc: selectedItem.getAvatar()\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tthis.updateResponsible();\n\t\t\t\t\tthis.emit('changeTaskResponsible');\n\n\t\t\t\t},\n\t\t\t},\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'user',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tinviteEmployeeLink: false\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'department'\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\n\t\tdialog.show();\n\t}\n\n\tonStoryPointsClick(event)\n\t{\n\t\tif (this.isGroupMode() || this.isDisabled() || this.isCompleted() || this.isParentTask())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tconst storyPointsNode = event.currentTarget;\n\t\tconst borderNode = storyPointsNode.querySelector('.ui-ctl');\n\t\tconst valueNode = storyPointsNode.querySelector('.ui-ctl-element');\n\t\tvalueNode.textContent = valueNode.textContent.trim();\n\t\tconst oldValue = valueNode.textContent.trim();\n\n\t\tif (valueNode.contentEditable === 'true')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\tvalueNode.contentEditable = 'true';\n\n\t\tthis.placeCursorAtEnd(valueNode);\n\n\t\tEvent.bind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\tEvent.bindOnce(valueNode, 'blur', () => {\n\t\t\tEvent.unbind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\t\tvalueNode.contentEditable = 'false';\n\n\t\t\tconst newValue = valueNode.textContent.trim();\n\t\t\tif (newValue && oldValue === newValue)\n\t\t\t{\n\t\t\t\tvalueNode.textContent = oldValue;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.emit('updateItem', {\n\t\t\t\titemId: this.getItemId(),\n\t\t\t\tentityId: this.getEntityId(),\n\t\t\t\titemType: this.getItemType(),\n\t\t\t\tstoryPoints: newValue\n\t\t\t});\n\n\t\t\tthis.setStoryPoints(newValue);\n\t\t}, true);\n\t}\n\n\tsendEventToUpdateStoryPoints()\n\t{\n\t\tthis.emit('updateStoryPoints');\n\t}\n\n\tblockEnterInput(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.blur();\n\t\t\treturn;\n\t\t}\n\t};\n\n\tshowActionsPanel(event)\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown() && !this.isGroupMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t}\n\n\t\tthis.actionsPanel = new ActionsPanel({\n\t\t\tbindElement: this.getItemNode(),\n\t\t\titemList: {\n\t\t\t\ttask: {\n\t\t\t\t\tactivity: (this.itemType === 'task' && !this.isGroupMode()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('showTask');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tattachment: {\n\t\t\t\t\tactivity: (!this.isDisabled() && this.isEditAllowed() && !this.isGroupMode()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tconst diskManager = new DiskManager({\n\t\t\t\t\t\t\tufDiskFilesFieldName: 'UF_TASK_WEBDAV_FILES'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.subscribeOnce('onFinish', (baseEvent) => {\n\t\t\t\t\t\t\tthis.emit('attachFilesToTask', baseEvent.getData());\n\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.showAttachmentMenu(event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdod: {\n\t\t\t\t\tactivity: (!this.decompositionMode && !this.isGroupMode()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('dod');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tactivity: (!this.decompositionMode && this.isMovable() && !this.isSubTask()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('move', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tsprint: {\n\t\t\t\t\tactivity: (!this.isDisabled() && !this.decompositionMode && !this.isSubTask()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('moveToSprint', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbacklog: {\n\t\t\t\t\tactivity: (this.entityType === 'sprint' && !this.decompositionMode && !this.isSubTask()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('moveToBacklog');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ttags: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showTagSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tepic: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showEpicSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdecomposition: {\n\t\t\t\t\tactivity: (\n\t\t\t\t\t\t!this.isDisabled()\n\t\t\t\t\t\t&& !this.decompositionMode\n\t\t\t\t\t\t&& !this.isGroupMode()\n\t\t\t\t\t\t&& !this.isSubTask()\n\t\t\t\t\t),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('startDecomposition');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tactivity: this.isRemoveAllowed(),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tconst message = (this.isGroupMode() ? Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASKS') :\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASK'));\n\t\t\t\t\t\tMessageBox.confirm(\n\t\t\t\t\t\t\tmessage,\n\t\t\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\t\t\tthis.emit('remove');\n\t\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.actionsPanel.showPanel();\n\t}\n\n\tgetCurrentActionsPanel(): ?ActionsPanel\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown())\n\t\t{\n\t\t\treturn this.actionsPanel;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null\n\t\t}\n\t}\n\n\tsetEpicAndTags(epic, tags: Array)\n\t{\n\t\tthis.epic = (Type.isPlainObject(epic) || epic === null ? epic : this.epic);\n\t\tthis.tags = (Type.isArray(tags) ? tags : this.tags);\n\n\t\tif (this.epic === null && this.tags.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateTagsContainer();\n\t}\n\n\tupdateTagsContainer()\n\t{\n\t\tif (!this.getItemNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newContainer = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst tagsContainerNode = this.getItemNode().querySelector('.tasks-scrum-item-tags-container');\n\t\tif (tagsContainerNode)\n\t\t{\n\t\t\tDom.replace(tagsContainerNode, newContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newContainer, this.getItemNode());\n\t\t}\n\t}\n\n\tupdateResponsible()\n\t{\n\t\tif (!this.getItemNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst responsibleNode = this.getItemNode().querySelector('.tasks-scrum-item-responsible');\n\n\t\tif (!responsibleNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.attr(responsibleNode, 'title', this.responsible.name);\n\t\tif (this.responsible.photo && this.responsible.photo.src)\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', 'url(\"'+this.responsible.photo.src+'\")');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', null);\n\t\t}\n\t}\n\n\tplaceCursorAtEnd(node)\n\t{\n\t\tnode.focus();\n\t\tconst selection = window.getSelection();\n\t\tconst range = document.createRange();\n\t\trange.selectNodeContents(node);\n\t\trange.collapse(false);\n\t\tselection.removeAllRanges();\n\t\tselection.addRange(range);\n\t};\n\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.updateIndicators(data);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'block');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}\n","import {Dom, Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class GroupActionsButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.GroupActionsButton');\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-group-actions\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_GROUP')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(this.element, 'click', this.onClick.bind(this, this.element));\n\n\t\treturn this.element;\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tif (this.element && this.element.classList.contains('tasks-scrum-group-actions-active'))\n\t\t{\n\t\t\tDom.toggleClass(this.element, 'tasks-scrum-group-actions');\n\t\t\tDom.toggleClass(this.element, 'tasks-scrum-group-actions-active');\n\t\t\tDom.toggleClass(this.element, 'ui-link-secondary');\n\t\t\tDom.toggleClass(this.element, 'ui-link-dashed');\n\n\t\t\tthis.emit('deactivateGroupMode');\n\t\t}\n\t}\n\n\tonClick(element: HTMLElement)\n\t{\n\t\tDom.toggleClass(element, 'tasks-scrum-group-actions');\n\t\tDom.toggleClass(element, 'tasks-scrum-group-actions-active');\n\t\tDom.toggleClass(element, 'ui-link-secondary');\n\t\tDom.toggleClass(element, 'ui-link-dashed');\n\t\tif (element.classList.contains('tasks-scrum-group-actions-active'))\n\t\t{\n\t\t\tthis.emit('activateGroupMode');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('deactivateGroupMode');\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.element);\n\t\tthis.element = null;\n\t}\n}","import {Tag} from 'main.core';\nimport {Entity} from './entity';\nimport {Item} from '../item/item';\n\nexport class ListItems\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tthis.entity = entity;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-items-list\" data-entity-id=\"${this.entity.getId()}\">\n\t\t\t\t${this.entity.isCompleted() ? '' : this.entity.getInput().render()}\n\t\t\t\t${[...this.entity.getItems().values()].map((item: Item) => {\n\t\t\t\t\titem.setEntityType(this.entity.getEntityType());\n\t\t\t\t\treturn item.render();\n\t\t\t\t})}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.node;\n\t}\n\n\tgetNode(): HTMLElement|null\n\t{\n\t\treturn this.node;\n\t}\n\n\tsetEntityId(entityId: number)\n\t{\n\t\tthis.node.dataset.entityId = parseInt(entityId, 10);\n\t}\n}","import {Dialog} from 'ui.entity-selector';\nimport {Loc, Tag, Text} from 'main.core';\nimport {Input} from './input';\nimport {EventEmitter} from 'main.core.events';\n\nimport type {EpicType} from '../item/item';\n\nexport class TagSearcher extends EventEmitter\n{\n\tstatic tagRegExp = '#[^#@](?:[^#@]*[^\\s#@])?';\n\tstatic epicRegExp = '@[^#@](?:[^#@]*[^\\s#@])?';\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.TagSearcher');\n\n\t\tthis.allTags = new Map();\n\t}\n\n\taddTagToSearcher(tagName)\n\t{\n\t\ttagName = tagName.trim();\n\t\tthis.allTags.set('tag_' + tagName, {\n\t\t\tid: tagName,\n\t\t\tentityId: 'tag',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: tagName,\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag.svg'\n\t\t});\n\t}\n\n\taddEpicToSearcher(epic: EpicType)\n\t{\n\t\tconst epicName = epic.name.trim();\n\t\tthis.allTags.set('epic_' + epicName, {\n\t\t\tid: epic.id,\n\t\t\tentityId: 'epic',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: epicName.trim(),\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag-green.svg',\n\t\t\tname: epicName.trim(),\n\t\t\tdescription: epic.description,\n\t\t\tinfo: epic.info\n\t\t});\n\t}\n\n\tgetTagFromSearcher(name: String): Object\n\t{\n\t\treturn this.allTags.get(name);\n\t}\n\n\tremoveEpicFromSearcher(epic: Object)\n\t{\n\t\tthis.allTags.delete('epic_' + epic.name);\n\t}\n\n\tgetAllList(): Array\n\t{\n\t\treturn [...this.allTags.values()];\n\t}\n\n\tgetTagsList(): Array\n\t{\n\t\tconst tagsList = [];\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'tag')\n\t\t\t{\n\t\t\t\ttagsList.push(tag);\n\t\t\t}\n\t\t});\n\t\treturn tagsList;\n\t}\n\n\tgetEpicList(): Array\n\t{\n\t\tconst epicList = [];\n\t\t[...this.allTags.values()].forEach((epic) => {\n\t\t\tif (epic.entityId === 'epic')\n\t\t\t{\n\t\t\t\tepicList.push(epic);\n\t\t\t}\n\t\t});\n\t\treturn epicList;\n\t}\n\n\tgetEpicByName(epicName: string): EpicType|null\n\t{\n\t\tlet epic = null;\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'epic' && tag.name === epicName)\n\t\t\t{\n\t\t\t\tepic = tag;\n\t\t\t}\n\t\t});\n\t\treturn epic;\n\t}\n\n\tshowTagsDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentTags = item.getTags();\n\n\t\tconst selectedItems = [];\n\t\tcurrentTags.forEach((tag) => {\n\t\t\tconst currentTag = this.allTags.get(('tag_' + tag).trim());\n\t\t\tif (currentTag)\n\t\t\t{\n\t\t\t\tselectedItems.push(currentTag);\n\t\t\t}\n\t\t});\n\n\t\tconst createTag = () => {\n\t\t\tconst tagName = this.tagDialog.getTagSelector().getTextBoxValue();\n\t\t\tif (!tagName)\n\t\t\t{\n\t\t\t\tthis.tagDialog.focusSearch();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.addTagToSearcher(tagName);\n\t\t\tconst newTag = this.getTagFromSearcher('tag_' + tagName);\n\t\t\tconst item = this.tagDialog.addItem(newTag);\n\t\t\titem.select();\n\t\t\tthis.tagDialog.getTagSelector().clearTextBox();\n\t\t\tthis.tagDialog.focusSearch();\n\t\t\tthis.tagDialog.selectFirstTab();\n\t\t\tconst label = this.tagDialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\tlabel.textContent = '';\n\t\t};\n\n\t\tlet choiceWasMade = false;\n\n\t\tthis.tagDialog = new Dialog({\n\t\t\tid: item.getItemId(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: true,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getTagsList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst tag = selectedItem.getTitle();\n\t\t\t\t\tthis.emit('attachTagToTask', tag);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst deselectedItem = event.getData().item;\n\t\t\t\t\tconst tag = deselectedItem.getTitle();\n\t\t\t\t\tthis.emit('deAttachTagToTask', tag);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonInput: (event) => {\n\t\t\t\t\t\tconst selector = event.getData().selector;\n\t\t\t\t\t\tif (selector)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst dialog = selector.getDialog();\n\t\t\t\t\t\t\tconst label = dialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\t\t\t\t\tlabel.textContent = Text.encode(selector.getTextBoxValue());\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tfooter: [\n\t\t\t\tTag.render`\n\t\t\t\t\t<span onclick=\"${createTag}\" class=\"ui-selector-footer-link ui-selector-footer-link-add\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SEARCHER_ACTIONS_TAG_ADD')}\n\t\t\t\t\t</span>\n\t\t\t\t`,\n\t\t\t\tTag.render`<span class=\"ui-selector-footer-conjunction\"></span>`\n\t\t\t],\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(this.tagDialog.getContainer());\n\t\tthis.tagDialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t\tthis.emit('hideTagDialog');\n\t\t\t}\n\t\t});\n\n\t\tthis.tagDialog.show();\n\t}\n\n\tshowEpicDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentEpic = item.getEpic();\n\n\t\tconst selectedItems = [];\n\t\tif (currentEpic)\n\t\t{\n\t\t\tconst currentEpicInfo = this.allTags.get(('epic_' + currentEpic.name).trim());\n\t\t\tif (currentEpicInfo)\n\t\t\t{\n\t\t\t\tselectedItems.push(currentEpicInfo);\n\t\t\t}\n\t\t}\n\n\t\tlet choiceWasMade = false;\n\n\t\tconst dialog = new Dialog({\n\t\t\tid: item.getItemId(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getEpicList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst epicId = selectedItem.getId();\n\t\t\t\t\tthis.emit('updateItemEpic', epicId);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\t\tif (dialog.getSelectedItems().length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('updateItemEpic', 0);\n\t\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 50);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tplaceholder: Loc.getMessage('TASKS_SCRUM_ITEM_EPIC_SEARCHER_PLACEHOLDER')\n\t\t\t}\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(dialog.getContainer());\n\t\tdialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t}\n\t\t});\n\t\tdialog.show();\n\t}\n\n\tshowTagsSearchDialog(inputObject: Input, enteredHashTagName: string): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.tagsDialog && this.tagsDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.tagsDialog = null;\n\t\t}\n\n\t\tif (!this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getTagsList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashTag = '#' + selectedItem.getTitle();\n\t\t\t\t\t\tconst hashTags = TagSearcher.getHashTagNamesFromText(input.value);\n\t\t\t\t\t\tconst enteredHashTag = (hashTags.length > 0 ? hashTags.pop() : '');\n\t\t\t\t\t\tinput.value = input.value.replace(\n\t\t\t\t\t\t\tnew RegExp('#' + enteredHashTag, 'g'),\n\t\t\t\t\t\t\tselectedHashTag\n\t\t\t\t\t\t);\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.tagsDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setTagsSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setTagsSearchMode(true);\n\n\t\tthis.tagsDialog.show();\n\n\t\tthis.tagsDialog.search(enteredHashTagName);\n\t}\n\n\tcloseTagsSearchDialog()\n\t{\n\t\tif (this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog.hide();\n\t\t}\n\t}\n\n\tshowEpicSearchDialog(inputObject: Input, enteredHashEpicName: String): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.epicDialog && this.epicDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.epicDialog = null;\n\t\t}\n\n\t\tif (!this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getEpicList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashEpic = '@' + selectedItem.getTitle();\n\t\t\t\t\t\tinput.value = input.value.replace(new RegExp(TagSearcher.epicRegExp,'g'),'');\n\t\t\t\t\t\tinput.value = input.value + ' ' + selectedHashEpic\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t\tinputObject.setEpicId(selectedItem.getId());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.epicDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setEpicSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setEpicSearchMode(true);\n\n\t\tthis.epicDialog.show();\n\t\tthis.epicDialog.search(enteredHashEpicName);\n\t}\n\n\tcloseEpicSearchDialog()\n\t{\n\t\tif (this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog.hide();\n\t\t}\n\t}\n\n\tstatic getHashTagNamesFromText(inputText: string): Array\n\t{\n\t\tconst regex = new RegExp(TagSearcher.tagRegExp, 'g');\n\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0].substring(1));\n\t\t}\n\n\t\treturn matches;\n\t}\n\n\tstatic getHashEpicNamesFromText(inputText: string): Array\n\t{\n\t\tconst regex = new RegExp(TagSearcher.epicRegExp, 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0].substring(1));\n\t\t}\n\n\t\treturn matches;\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {TagSearcher} from './tag.searcher';\nimport {EventEmitter} from 'main.core.events';\n\nimport '../css/input.css';\n\nexport class Input extends EventEmitter\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Input');\n\n\t\tthis.nodeId = Text.getRandom();\n\t\tthis.placeholder = Loc.getMessage('TASKS_SCRUM_TASK_ADD_INPUT_TASK_PLACEHOLDER');\n\n\t\tthis.epicId = 0;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${Text.encode(this.nodeId)}\" class=\"tasks-scrum-input\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox\">\n\t\t\t\t\t<input type=\"text\" class=\"ui-ctl-element\" placeholder=\n\t\t\t\t\t\t\"${Text.encode(this.placeholder)}\" autocomplete=\"off\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdisable()\n\t{\n\t\tthis.node.querySelector('input').disabled = true;\n\t}\n\n\tunDisable()\n\t{\n\t\tthis.node.querySelector('input').disabled = false;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.setNode();\n\n\t\tEvent.bind(this.getInputNode(), 'input', (event) => {\n\t\t\tthis.onTagSearch(event);\n\t\t\tthis.onEpicSearch(event);\n\t\t});\n\t\tEvent.bind(this.getInputNode(), 'keydown', this.onKeydown.bind(this));\n\t}\n\n\tsetNode()\n\t{\n\t\tthis.node = document.getElementById(this.nodeId);\n\t}\n\n\tsetPlaceholder(placeholder: String)\n\t{\n\t\tthis.placeholder = placeholder;\n\t}\n\n\tsetEpicId(parentId)\n\t{\n\t\tthis.epicId = parseInt(parentId, 10);\n\t}\n\n\tgetNode(): HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetNodeId(): String\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tgetInputNode(): HTMLElement\n\t{\n\t\treturn this.node.querySelector('input');\n\t}\n\n\tgetEpicId()\n\t{\n\t\treturn this.epicId;\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t}\n\n\tsetTagsSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-tag-disabled', value);\n\t}\n\n\tisTagsSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-tag-disabled');\n\t}\n\n\tsetEpicSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-epic-disabled', value);\n\t}\n\n\tisEpicSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-epic-disabled');\n\t}\n\n\tonTagSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashTags = TagSearcher.getHashTagNamesFromText(inputNode.value);\n\t\tif (event.data === '#')\n\t\t{\n\t\t\tthis.setEpicSearchMode(false);\n\t\t\tthis.setTagsSearchMode(true);\n\t\t}\n\t\tif (enteredHashTags.length > 0 && this.isTagsSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashTags.pop();\n\t\t\tthis.emit('tagsSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('tagsSearchClose');\n\t\t}\n\t}\n\n\tonEpicSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashEpics = TagSearcher.getHashEpicNamesFromText(inputNode.value);\n\t\tif (event.data === '@')\n\t\t{\n\t\t\tthis.setTagsSearchMode(false);\n\t\t\tthis.setEpicSearchMode(true);\n\t\t}\n\t\tif (enteredHashEpics.length > 0 && this.isEpicSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashEpics.pop();\n\t\t\tthis.emit('epicSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('epicSearchClose');\n\t\t}\n\t}\n\n\tonCreateTaskItem()\n\t{\n\t\tif (!this.isTagsSearchMode() && !this.isEpicSearchMode())\n\t\t{\n\t\t\tconst input = this.getInputNode();\n\t\t\tif (input.value)\n\t\t\t{\n\t\t\t\tthis.emit('createTaskItem', input.value);\n\t\t\t\tinput.value = '';\n\t\t\t\tinput.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tonKeydown(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.onCreateTaskItem();\n\t\t}\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {Item} from '../item/item';\nimport {GroupActionsButton} from './group.actions.button';\nimport {ListItems} from './list.items';\n\nimport {Input} from '../utility/input';\nimport {StoryPoints} from '../utility/story.points';\n\nimport type {Views} from '../view/view';\n\nimport '../css/entity.css';\n\ntype EntityParams = {\n\tid: number,\n\tviews?: Views,\n\tnumberTasks?: number,\n\tisExactSearchApplied: 'Y' | 'N',\n\tstoryPoints?: string,\n\tpageNumberItems: number\n};\n\nexport class Entity extends EventEmitter\n{\n\tconstructor(params: EntityParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Entity');\n\n\t\tthis.setEntityParams(params);\n\n\t\tthis.items = new Map();\n\n\t\tthis.groupMode = false;\n\t\tthis.groupModeItems = new Map();\n\n\t\tthis.node = null;\n\t\tthis.groupActionsButton = null;\n\t\tthis.listItems = null;\n\n\t\tthis.input = new Input();\n\t}\n\n\tsetEntityParams(params: EntityParams)\n\t{\n\t\tthis.setId(params.id);\n\t\tthis.setViews(params.views);\n\t\tthis.setNumberTasks(params.numberTasks);\n\t\tthis.setStoryPoints(params.storyPoints);\n\n\t\tthis.exactSearchApplied = (params.isExactSearchApplied === 'Y');\n\n\t\tthis.pageNumberItems = parseInt(params.pageNumberItems, 10);\n\t}\n\n\taddGroupActionsButton(groupActionsButton: GroupActionsButton)\n\t{\n\t\tthis.groupActionsButton = groupActionsButton;\n\t\tthis.groupActionsButton.subscribe('activateGroupMode', this.onActivateGroupMode.bind(this));\n\t\tthis.groupActionsButton.subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t}\n\n\taddListItems(listItems: ListItems)\n\t{\n\t\tthis.listItems = listItems;\n\t}\n\n\tgetListItems(): ListItems|null\n\t{\n\t\treturn this.listItems;\n\t}\n\n\tgetNode(): HTMLElement|null\n\t{\n\t\treturn this.node;\n\t}\n\n\tsetId(id: number)\n\t{\n\t\tthis.id = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\n\t\tif (this.listItems)\n\t\t{\n\t\t\tthis.listItems.setEntityId(this.id);\n\t\t}\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetViews(views)\n\t{\n\t\tthis.views = (Type.isPlainObject(views) ? views : {});\n\t}\n\n\tgetViews()\n\t{\n\t\treturn this.views;\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'entity';\n\t}\n\n\tisActive()\n\t{\n\t\treturn false;\n\t}\n\n\tisCompleted()\n\t{\n\t\treturn false;\n\t}\n\n\tgetListItemsNode(): HTMLElement|null\n\t{\n\t\treturn (this.listItems ? this.listItems.getNode() : null);\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn (this.items.size === 0);\n\t}\n\n\tgetItems(): Map\n\t{\n\t\treturn this.items;\n\t}\n\n\tgetPageNumberItems(): number\n\t{\n\t\treturn this.pageNumberItems;\n\t}\n\n\tincrementPageNumberItems()\n\t{\n\t\tthis.pageNumberItems++;\n\t}\n\n\trecalculateItemsSort()\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tif (!listItemsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet sort = 1;\n\t\tlistItemsNode.querySelectorAll('.tasks-scrum-item').forEach((node: HTMLElement) => {\n\t\t\tconst item = this.getItems().get(parseInt(node.dataset.itemId, 10));\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.setSort(sort);\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\t}\n\n\tgetInput(): Input\n\t{\n\t\treturn this.input;\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tthis.items.set(newItem.getItemId(), newItem);\n\t\tthis.subscribeToItem(newItem);\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\t}\n\n\tsetItemMoveActivity(item: Item)\n\t{\n\t\titem.setMoveActivity(this.items.size > 2);\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tif (this.items.has(item.getItemId()))\n\t\t{\n\t\t\tthis.items.delete(item.getItemId());\n\t\t\titem.unsubscribeAll();\n\t\t\t[...this.items.values()].map((item) => {\n\t\t\t\tthis.setItemMoveActivity(item);\n\t\t\t});\n\t\t}\n\t}\n\n\tisNodeCreated(): boolean\n\t{\n\t\treturn (this.node !== null);\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tthis.numberTasks = (Type.isInteger(numberTasks) ? parseInt(numberTasks, 10) : 0);\n\t}\n\n\tgetNumberTasks(): number\n\t{\n\t\treturn (this.numberTasks ? this.numberTasks : this.getItems().size);\n\t}\n\n\thasInput(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tsetExactSearchApplied(value: boolean)\n\t{\n\t\tthis.exactSearchApplied = Boolean(value);\n\t}\n\n\tisExactSearchApplied(): boolean\n\t{\n\t\treturn this.exactSearchApplied;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.subscribeToItem(item);\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.input.onAfterAppend();\n\t\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t\t\tthis.input.subscribe('epicSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('epicSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashEpicName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('epicSearchClose', () => this.emit('epicSearchClose'));\n\t\t\tthis.input.subscribe('createTaskItem', (baseEvent) => {\n\t\t\t\tthis.emit('createTaskItem', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tvalue: baseEvent.getData()\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tsubscribeToItem(item: Item)\n\t{\n\t\tif (!this.getListItemsNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.onAfterAppend(this.getListItemsNode());\n\n\t\titem.setEntityType(this.getEntityType());\n\n\t\titem.subscribe('updateItem', (baseEvent) => {\n\t\t\tthis.emit('updateItem', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('updateStoryPoints', () => {\n\t\t\tif (item.isSubTask())\n\t\t\t{\n\t\t\t\tconst parentItem = this.getItemBySourceId(item.getParentTaskId());\n\t\t\t\tif (parentItem)\n\t\t\t\t{\n\t\t\t\t\tparentItem.updateSubTasksPoints(item.getSourceId(), item.getStoryPoints());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\titem.subscribe('showTask', (baseEvent) => this.emit('showTask', baseEvent.getTarget()));\n\n\t\titem.subscribe('move', (baseEvent) => {\n\t\t\tthis.emit('moveItem', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('moveToSprint', (baseEvent) => {\n\t\t\tthis.emit('moveToSprint', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('attachFilesToTask', (baseEvent) => {\n\t\t\tthis.emit('attachFilesToTask', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tattachedIds: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('dod', (baseEvent) => {\n\t\t\tthis.emit('showDod', baseEvent.getTarget())\n\t\t});\n\n\t\titem.subscribe('showTagSearcher', (baseEvent) => {\n\t\t\tthis.emit('showTagSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\titem.subscribe('showEpicSearcher', (baseEvent) => {\n\t\t\tthis.emit('showEpicSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('startDecomposition', (baseEvent) => {\n\t\t\tthis.emit('startDecomposition', baseEvent.getTarget())\n\t\t});\n\n\t\titem.subscribe('remove', (baseEvent) => {\n\t\t\tif (this.isGroupMode())\n\t\t\t{\n\t\t\t\tthis.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\tthis.removeItem(groupModeItem);\n\t\t\t\t\tgroupModeItem.removeYourself();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst item = baseEvent.getTarget();\n\t\t\t\tthis.removeItem(item);\n\t\t\t\titem.removeYourself();\n\t\t\t}\n\t\t\tthis.emit('removeItem', item);\n\t\t});\n\n\t\titem.subscribe('changeTaskResponsible', (baseEvent) => {\n\t\t\tconst item = baseEvent.getTarget();\n\t\t\tthis.emit('changeTaskResponsible', item);\n\t\t});\n\n\t\titem.subscribe('filterByEpic', (baseEvent) => {\n\t\t\tthis.emit('filterByEpic', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('filterByTag', (baseEvent) => {\n\t\t\tthis.emit('filterByTag', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('addItemToGroupMode', (baseEvent) => {\n\t\t\tthis.addItemToGroupMode(baseEvent.getTarget());\n\t\t});\n\n\t\titem.subscribe('removeItemFromGroupMode', (baseEvent) => {\n\t\t\tthis.removeItemFromGroupMode(baseEvent.getTarget());\n\t\t});\n\t}\n\n\tgetItemByItemId(itemId: number|string): Item|undefined\n\t{\n\t\treturn this.items.get((Type.isInteger(itemId) ? parseInt(itemId, 10) : itemId));\n\t}\n\n\tgetItemBySourceId(sourceId: number): Item|undefined\n\t{\n\t\treturn [...this.items.values()].find((item: Item) => item.getSourceId() === sourceId);\n\t}\n\n\tgetItemsByParentTaskId(parentTaskId: number): Map<number, Item>\n\t{\n\t\tconst items = new Map();\n\n\t\t[...this.items.values()].map((item: Item) => {\n\t\t\tif (item.getParentTaskId() === parentTaskId)\n\t\t\t{\n\t\t\t\titems.set(item.getItemId(), item);\n\t\t\t}\n\t\t});\n\n\t\treturn items;\n\t}\n\n\tsetStoryPoints(storyPoints)\n\t{\n\t\tthis.storyPoints = new StoryPoints();\n\n\t\tthis.storyPoints.addPoints(storyPoints);\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tisFirstItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\tconst firstElementChild = (\n\t\t\tthis.hasInput() ? listItemsNode.firstElementChild.nextElementSibling : listItemsNode.firstElementChild\n\t\t)\n\t\treturn firstElementChild.isEqualNode(itemNode);\n\t}\n\n\tisLastItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\treturn listItemsNode.lastElementChild.isEqualNode(itemNode);\n\t}\n\n\tfadeOut()\n\t{\n\t\tthis.getListItemsNode().classList.add('tasks-scrum-entity-items-faded');\n\t}\n\n\tfadeIn()\n\t{\n\t\tthis.getListItemsNode().classList.remove('tasks-scrum-entity-items-faded');\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tthis.groupActionsButton.deactivateGroupMode();\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tthis.groupMode = true;\n\n\t\tthis.input.disable();\n\n\t\tthis.emit('activateGroupMode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tthis.groupMode = false;\n\n\t\tthis.input.unDisable();\n\n\t\tthis.groupModeItems.forEach((item: Item) => {\n\t\t\titem.deactivateGroupMode();\n\t\t});\n\t\tthis.groupModeItems.clear();\n\n\t\tthis.emit('deactivateGroupMode');\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\taddItemToGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.set(item.getItemId(), item);\n\t}\n\n\tgetGroupModeItems(): Map\n\t{\n\t\treturn this.groupModeItems;\n\t}\n\n\tremoveItemFromGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.delete(item.getItemId());\n\t}\n\n\tbindItemsLoader(loader: HTMLElement)\n\t{\n\t\tthis.setActiveLoadItems(false);\n\n\t\tif (typeof IntersectionObserver === `undefined`)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst observer = new IntersectionObserver((entries) =>\n\t\t\t{\n\t\t\t\tif(entries[0].isIntersecting === true)\n\t\t\t\t{\n\t\t\t\t\tif (!this.isActiveLoadItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.emit('loadItems');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tthreshold: [0]\n\t\t\t}\n\t\t);\n\n\t\tobserver.observe(loader);\n\t}\n\n\tsetActiveLoadItems(value: boolean)\n\t{\n\t\tthis.activeLoadItems = Boolean(value);\n\t}\n\n\tisActiveLoadItems(): boolean\n\t{\n\t\treturn this.activeLoadItems;\n\t}\n\n\tshowItemsLoader()\n\t{\n\t\tconst listPosition = Dom.getPosition(this.itemsLoaderNode);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.itemsLoaderNode,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n\n\tupdateStoryPointsNode() {}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Entity} from '../entity';\n\nexport class Header extends EventEmitter\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tsuper(entity);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.BacklogHeader');\n\n\t\tthis.entity = entity;\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<div class=\"tasks-scrum-backlog-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-epics-title ui-btn ui-btn-xs ui-btn-secondary\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_EPICS_TITLE')}\n\t\t\t</div>\n\t\t\t<div title=\"Definition of Done\" class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-dod\">\n\t\t\t\t<span class=\"tasks-scrum-entity-dod-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-title-spacer\"></div>\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-task\">\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-title\">\n\t\t\t\t\t${this.entity.getNumberTasks()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-story-point-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE_STORY_POINTS')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-story-point\">\n\t\t\t\t${Text.encode(this.entity.getStoryPoints().getPoints())}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.getElementByClassName(this.element, 'tasks-scrum-backlog-epics-title'), 'click', () => {\n\t\t\tthis.emit('openListEpicGrid');\n\t\t});\n\n\t\tEvent.bind(this.getElementByClassName(this.element, 'tasks-scrum-entity-title-btn-dod'), 'click', () => {\n\t\t\tthis.emit('openDefinitionOfDone');\n\t\t});\n\n\t\treturn this.element;\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tthis.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-backlog-story-point'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tupdateNumberTasks()\n\t{\n\t\tconst parentNode = this.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-entity-title-btn-task'\n\t\t);\n\t\tparentNode.querySelector('.tasks-scrum-entity-tasks-title').textContent = this.entity.getNumberTasks();\n\t}\n\n\tgetElementByClassName(elements: HTMLElement[], className: string): HTMLElement\n\t{\n\t\tlet element = null;\n\t\telements.forEach((elem) => {\n\t\t\tif (elem.classList.contains(className))\n\t\t\t{\n\t\t\t\telement = elem;\n\t\t\t}\n\t\t});\n\t\treturn element;\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class EpicCreationButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.EpicCreationButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst element = Tag.render`\n\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-action-epic\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(element, 'click', this.onClick.bind(this));\n\n\t\treturn element;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('openAddEpicForm')\n\t}\n}","import {Dom, Tag} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Entity} from '../entity';\nimport {Header} from './header';\nimport {EpicCreationButton} from './epic.creation.button';\nimport {GroupActionsButton} from '../group.actions.button';\nimport {ListItems} from '../list.items';\nimport {Item} from '../../item/item';\n\nimport type {ItemParams} from '../../item/item';\n\nimport '../../css/backlog.css';\n\nexport type BacklogParams = {\n\tid: number,\n\titems?: Array<ItemParams>\n};\n\nexport class Backlog extends Entity\n{\n\tconstructor(params: BacklogParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Backlog');\n\n\t\tthis.setBacklogParams(params);\n\n\t\tthis.header = null;\n\t\tthis.epicCreationButton = null;\n\t}\n\n\tsetBacklogParams(params: BacklogParams)\n\t{\n\t\tparams.items.forEach((itemData) => {\n\t\t\tconst item = new Item(itemData);\n\t\t\tthis.items.set(item.itemId, item);\n\t\t});\n\t}\n\n\tstatic buildBacklog(backlogData: BacklogParams): Backlog\n\t{\n\t\tconst backlog = new Backlog(backlogData);\n\t\tbacklog.addHeader(new Header(backlog));\n\t\tbacklog.addEpicCreationButton(new EpicCreationButton());\n\t\tbacklog.addGroupActionsButton(new GroupActionsButton());\n\t\tbacklog.addListItems(new ListItems(backlog));\n\t\treturn backlog;\n\t}\n\n\taddHeader(header: Header)\n\t{\n\t\tthis.header = header;\n\t\tthis.header.subscribe('openListEpicGrid', () => this.emit('openListEpicGrid'));\n\t\tthis.header.subscribe('openDefinitionOfDone', () => this.emit('openDefinitionOfDone'));\n\t}\n\n\taddEpicCreationButton(epicCreationButton: EpicCreationButton)\n\t{\n\t\tthis.epicCreationButton = epicCreationButton;\n\t\tthis.epicCreationButton.subscribe('openAddEpicForm', () => this.emit('openAddEpicForm'));\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'backlog';\n\t}\n\n\tisDisabled()\n\t{\n\t\treturn false;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-backlog\">\n\t\t\t\t<div class=\"tasks-scrum-backlog-header\">\n\t\t\t\t\t${this.header ? this.header.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-backlog-actions\">\n\t\t\t\t\t${this.epicCreationButton ? this.epicCreationButton.render() : ''}\n\t\t\t\t\t${this.groupActionsButton ? this.groupActionsButton.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-backlog-items\">\n\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-entity-items-loader\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.itemsLoaderNode = this.node.querySelector('.tasks-scrum-entity-items-loader');\n\t\tthis.bindItemsLoader(this.itemsLoaderNode);\n\n\t\treturn this.node;\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tsuper.setNumberTasks(numberTasks);\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.updateNumberTasks();\n\t\t}\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onActivateGroupMode(baseEvent);\n\n\t\tDom.addClass(this.node.querySelector('.tasks-scrum-backlog-items'), 'tasks-scrum-backlog-items-group-mode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onDeactivateGroupMode(baseEvent);\n\n\t\tDom.removeClass(this.node.querySelector('.tasks-scrum-backlog-items'), 'tasks-scrum-backlog-items-group-mode');\n\t}\n\n\tupdateStoryPointsNode()\n\t{\n\t\tsuper.updateStoryPointsNode();\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.setStoryPoints(this.getStoryPoints().getPoints());\n\t\t}\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\n\nexport class SprintDate extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintDate');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.nodeId = 'tasks-scrum-sprint-header-date-' + Text.getRandom();\n\t\tthis.defaultSprintDuration = sprint.getDefaultSprintDuration();\n\t}\n\n\tcreateDate()\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn this.renderNode(this.nodeId, this.getFormattedDateStart(), this.getFormattedDateEnd());\n\t}\n\n\trenderNode(nodeId: string, dateStart: string, dateEnd: string): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${nodeId}\" class=\"tasks-scrum-sprint-date\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-start\">${dateStart}</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-separator\">-</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-end\">${dateEnd}</div>\n\t\t\t\t<input type=\"hidden\" name=\"dateStart\">\n\t\t\t\t<input type=\"hidden\" name=\"dateEnd\">\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\t\tdateStartNode.textContent = BX.date.format('j F', timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\t\tdateEndNode.textContent = BX.date.format('j F', timestamp);\n\t\t}\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.node = document.getElementById(this.nodeId);\n\t\tconst parentPopup = this.node.closest('.popup-window');\n\n\t\tconst customBlur = () => {\n\t\t\tBX.calendar.get().popup.close();\n\t\t};\n\n\t\tconst showCalendar = (node, field) => {\n\t\t\t/* eslint-disable */\n\t\t\tBX.calendar({\n\t\t\t\tnode: node,\n\t\t\t\tfield: field,\n\t\t\t\tbTime: false,\n\t\t\t\tbSetFocus: false,\n\t\t\t\tbHideTime: false\n\t\t\t});\n\t\t\t/* eslint-enable */\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.bindOnce(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t};\n\n\t\tconst updateDateNode = (node, value) => {\n\t\t\t/* eslint-disable */\n\t\t\tnode.textContent = BX.date.format('j F', Math.floor(BX.parseDate(value).getTime() / 1000));\n\t\t\t/* eslint-enable */\n\t\t};\n\t\tconst sendRequest = (data) => {\n\t\t\tthis.emit('changeSprintDeadline', data);\n\t\t};\n\n\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\tconst dateStartInput = this.node.querySelector('input[name=\"dateStart\"]');\n\t\tconst dateEndInput = this.node.querySelector('input[name=\"dateEnd\"]');\n\n\t\tEvent.bind(this.node, 'click', (event) => {\n\t\t\tconst target = event.target;\n\t\t\tif (target.classList.contains('tasks-scrum-sprint-date-start'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateStartInput);\n\t\t\t}\n\t\t\telse if (target.classList.contains('tasks-scrum-sprint-date-end'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateEndInput);\n\t\t\t}\n\t\t\tevent.stopPropagation();\n\t\t});\n\t\tEvent.bind(dateStartInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateStartNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateStart: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t\tEvent.bind(dateEndInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateEndNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateEnd: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetWeeks()\n\t{\n\t\tconst weekCount = (parseInt(this.defaultSprintDuration, 10) / 604800);\n\t\tif (weekCount > 5)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_3');\n\t\t}\n\t\telse if (weekCount === 1)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_2');\n\t\t}\n\t}\n\n\tgetFormattedTitleDatePeriod(): string\n\t{\n\t\treturn this.getFormattedDateStart() + ' - ' + this.getFormattedDateEnd();\n\t}\n\n\tgetFormattedDateStart(): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format('j F', this.sprint.getDateStart());\n\t\t/* eslint-enable */\n\t}\n\n\tgetFormattedDateEnd(): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format('j F', this.sprint.getDateEnd());\n\t\t/* eslint-enable */\n\t}\n}","export class StatsCalculator\n{\n\tcalculatePercentage(first: number, second: number): number\n\t{\n\t\tif (first === 0)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst result = Math.round(second * 100 / first);\n\n\t\treturn (isNaN(result) ? 0 : result);\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\nimport {StatsCalculator} from '../../utility/stats.calculator';\nimport {SprintDate} from \"./sprint.date\";\n\nexport class StatsHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.StatsHeader');\n\n\t\tthis.setSprintData(sprint);\n\n\t\tthis.statsCalculator = new StatsCalculator();\n\n\t\tthis.weekendDaysTime = sprint.getWeekendDaysTime();\n\n\t\tthis.headerNode = null;\n\t\tthis.headerClass = 'tasks-scrum-sprint-header-stats';\n\n\t\tthis.kanbanMode = false;\n\t}\n\n\tsetKanbanStyle()\n\t{\n\t\tthis.kanbanMode = true;\n\t\tthis.headerClass = 'tasks-scrum-sprint-header-stats-kanban';\n\t}\n\n\tisKanbanMode(): boolean\n\t{\n\t\treturn this.kanbanMode;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn '';\n\t}\n\n\tupdateStats(sprint: Sprint)\n\t{\n\t\tthis.setSprintData(sprint);\n\n\t\tDom.replace(this.headerNode, this.render());\n\t}\n\n\tsetSprintData(sprint: Sprint)\n\t{\n\t\tthis.setSprintDate(sprint);\n\t\tthis.setStoryPoints(sprint.getStoryPoints().getPoints());\n\t\tthis.setCompletedStoryPoints(sprint.getCompletedStoryPoints().getPoints());\n\t\tthis.setUncompletedStoryPoints(sprint.getUncompletedStoryPoints().getPoints());\n\t\tthis.setEndDate(sprint.getDateEnd());\n\t}\n\n\tsetSprintDate(sprint: Sprint)\n\t{\n\t\tthis.sprintDate = new SprintDate(sprint);\n\t}\n\n\tgetSprintDate(): SprintDate\n\t{\n\t\treturn this.sprintDate;\n\t}\n\n\tsetStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.storyPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.storyPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetStoryPoints(): number\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tsetCompletedStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.completedStoryPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.completedStoryPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetCompletedStoryPoints(): number\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetUncompletedStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.uncompletedStoryPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.uncompletedStoryPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetUncompletedStoryPoints(): number\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetEndDate(endDate)\n\t{\n\t\tif (Type.isUndefined(endDate) || isNaN(parseInt(endDate, 10)))\n\t\t{\n\t\t\tthis.endDate = (Date.now() / 1000);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.endDate = parseInt(endDate, 10);\n\t\t}\n\t}\n\n\tgetEndDate(): number\n\t{\n\t\treturn this.endDate;\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class CompletedStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tconst completedDate = this.getCompletedDate(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_COMPLETED_LABEL')\n\t\t\t.replace('#percent#', percentage)\n\t\t\t.replace('#date#', completedDate)\n\t\t;\n\n\t\tconst title = this.getSprintDate().getFormattedTitleDatePeriod();\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\" title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetCompletedDate(endDate: number): string\n\t{\n\t\treturn BX.date.format('j F Y', endDate);\n\t};\n}","import {Loc, Tag} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class ExpiredStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\t\tconst expiredDay = this.getExpiredDay(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_EXPIRED_LABEL')\n\t\t\t.replace('#percent#', percentage)\n\t\t\t.replace('#date#', expiredDay)\n\t\t;\n\n\t\tconst title = this.getSprintDate().getFormattedTitleDatePeriod();\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\" title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetExpiredDay(endDate: number): string\n\t{\n\t\treturn BX.date.format('j F Y', endDate);\n\t};\n}","import {Loc, Tag, Type} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class ActiveStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst remainingDays = this.getRemainingDays(this.getEndDate());\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tlet label = '';\n\t\tif (Type.isInteger(remainingDays) && remainingDays <= 1)\n\t\t{\n\t\t\tlabel = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LAST_LABEL')\n\t\t\t\t.replace('#percent#', percentage)\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabel = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LABEL')\n\t\t\t\t.replace('#days#', remainingDays)\n\t\t\t\t.replace('#percent#', percentage)\n\t\t\t;\n\t\t}\n\n\t\tconst title = this.getSprintDate().getFormattedTitleDatePeriod();\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\" title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetRemainingDays(endDate: number): string|number\n\t{\n\t\tconst dateWithWeekendOffset = new Date();\n\t\tdateWithWeekendOffset.setSeconds(dateWithWeekendOffset.getSeconds() + this.weekendDaysTime);\n\t\tdateWithWeekendOffset.setHours(0, 0, 0, 0);\n\n\t\tconst dateEnd = new Date(endDate * 1000);\n\n\t\tconst msPerMinute = 60 * 1000;\n\t\tconst msPerHour = msPerMinute * 60;\n\t\tconst msPerDay = msPerHour * 24;\n\n\t\tconst daysRemaining = Math.round((dateEnd - dateWithWeekendOffset) / msPerDay);\n\n\t\tif (daysRemaining <= 1)\n\t\t{\n\t\t\treturn daysRemaining;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.date.format('ddiff', dateWithWeekendOffset, dateEnd);\n\t\t}\n\t};\n}","import {Sprint} from './sprint';\nimport {StatsHeader} from './stats.header';\nimport {CompletedStatsHeader} from './completed.stats.header';\nimport {ExpiredStatsHeader} from './expired.stats.header';\nimport {ActiveStatsHeader} from './active.stats.header';\n\nexport class StatsHeaderBuilder\n{\n\tstatic build(sprint: Sprint): StatsHeader\n\t{\n\t\tif (sprint.isCompleted())\n\t\t{\n\t\t\treturn new CompletedStatsHeader(sprint);\n\t\t}\n\t\telse if (sprint.isExpired())\n\t\t{\n\t\t\treturn new ExpiredStatsHeader(sprint);\n\t\t}\n\t\telse if (sprint.isActive())\n\t\t{\n\t\t\treturn new ActiveStatsHeader(sprint);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn new StatsHeader(sprint);\n\t\t}\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {SprintDate} from './sprint.date';\nimport {Sprint} from './sprint';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {StatsHeaderBuilder} from './stats.header.builder';\nimport {StatsHeader} from './stats.header';\n\nexport class SprintHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintHeader');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\n\t\tthis.statsHeader = null;\n\t\tthis.sprintDate = null;\n\t}\n\n\tstatic buildHeader(sprint: Sprint): SprintHeader\n\t{\n\t\tconst sprintHeader = new SprintHeader(sprint);\n\t\tsprintHeader.addHeaderStats(StatsHeaderBuilder.build(sprint));\n\t\tsprintHeader.addHeaderDate(new SprintDate(sprint));\n\t\treturn sprintHeader;\n\t}\n\n\taddHeaderStats(statsHeader: StatsHeader)\n\t{\n\t\tthis.statsHeader = statsHeader;\n\t}\n\n\taddHeaderDate(sprintDate: SprintDate)\n\t{\n\t\tthis.sprintDate = sprintDate;\n\t\tthis.sprintDate.subscribe('changeSprintDeadline', (baseEvent) => {\n\t\t\tthis.emit('changeSprintDeadline', baseEvent.getData());\n\t\t});\n\t}\n\n\tinitStyle(sprint: Sprint)\n\t{\n\t\tthis.sprint = sprint;\n\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-active';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-success ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_COMPLETE_BUTTON');\n\t\t}\n\t\telse if (this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-completed';\n\t\t\tDom.remove(this.buttonNode);\n\t\t\tthis.sprint.hideContent();\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-planned';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-primary ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_START_BUTTON');\n\t\t}\n\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.addHeaderStats(StatsHeaderBuilder.build(this.sprint));\n\t\t\tthis.addHeaderDate(new SprintDate(this.sprint));\n\n\t\t\tif (this.sprint.isDisabled())\n\t\t\t{\n\t\t\t\tDom.remove(this.node.querySelector('.tasks-scrum-sprint-header-remove'));\n\t\t\t}\n\n\t\t\tthis.node.className = '';\n\t\t\tDom.addClass(this.node, 'tasks-scrum-sprint-header ' + this.headerClass);\n\n\t\t\tconst button = this.buttonNode.querySelector('button');\n\t\t\tbutton.className = '';\n\t\t\tDom.addClass(button, this.buttonClass);\n\t\t\tbutton.firstChild.replaceWith(this.buttonText);\n\n\t\t\tDom.replace(this.node.querySelector('.tasks-scrum-sprint-header-params'), this.renderParams());\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header ${this.headerClass}\">\n\t\t\t\t${this.renderDragnDrop()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-name-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-name\">\n\t\t\t\t\t\t${Text.encode(this.sprint.getName())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-edit\"></div>\n\t\t\t\t${this.renderRemove()}\n\t\t\t\t${this.renderParams()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t};\n\n\trenderParams(): HTMLElement\n\t{\n\t\tconst tickAngleClass = (this.sprint.isCompleted() ? 'ui-btn-icon-angle-down' : 'ui-btn-icon-angle-up');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header-params\">\n\t\t\t\t${this.renderStatsHeader()}\n\t\t\t\t${this.sprintDate ? this.sprintDate.createDate() : ''}\n\t\t\t\t${this.createButton()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-tick\">\n\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ${tickAngleClass}\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetStatsHeader(): StatsHeader\n\t{\n\t\treturn this.statsHeader;\n\t}\n\n\trenderDragnDrop(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-dragndrop\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-header-empty\"></div>`;\n\t\t}\n\t}\n\n\trenderRemove(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-header-remove\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t}\n\n\trenderStatsHeader(): HTMLElement\n\t{\n\t\treturn (this.statsHeader ? this.statsHeader.render() : '');\n\t}\n\n\tupdateNameNode(name: string)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.node.querySelector('.tasks-scrum-sprint-header-name').textContent = Text.encode(name);\n\t\t}\n\t}\n\n\tupdateStatsHeader()\n\t{\n\t\tthis.statsHeader.updateStats(this.sprint);\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.updateDateStartNode(timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.updateDateEndNode(timestamp);\n\t\t}\n\t}\n\n\tcreateButton()\n\t{\n\t\tif (this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buttonNodeId = 'tasks-scrum-sprint-header-button-' + this.sprint.getId();\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.buttonNodeId}\" class=\"tasks-scrum-sprint-header-button\">\n\t\t\t\t\t<button class=\"${this.buttonClass}\">${this.buttonText}</button>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t};\n\n\tonAfterAppend()\n\t{\n\t\tif (!this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.buttonNode = document.getElementById(this.buttonNodeId);\n\t\t\tEvent.bind(this.buttonNode, 'click', this.onButtonClick.bind(this));\n\t\t}\n\n\t\tconst nameNode = this.node.querySelector('.tasks-scrum-sprint-header-name-container');\n\t\tconst editButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-edit');\n\t\tEvent.bind(editButtonNode, 'click', () => this.emit('changeName', nameNode));\n\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\tconst removeNode = this.node.querySelector('.tasks-scrum-sprint-header-remove');\n\t\t\tEvent.bind(removeNode, 'click', () => {\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_SPRINT'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tthis.emit('removeSprint');\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\tconst tickButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-tick');\n\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-up');\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-down');\n\t\t\tthis.emit('toggleVisibilityContent');\n\t\t});\n\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.onAfterAppend();\n\t\t}\n\t}\n\n\tupTick()\n\t{\n\t\tif (!this.node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tickButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-tick');\n\n\t\tDom.removeClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\t\tDom.addClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\t}\n\n\tdownTick()\n\t{\n\t\tif (!this.node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tickButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-tick');\n\n\t\tDom.removeClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\t\tDom.addClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\t}\n\n\tonButtonClick()\n\t{\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.emit('completeSprint');\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.emit('startSprint');\n\t\t}\n\t}\n}","import {Loc, Tag} from 'main.core';\n\nexport class EventsHeader\n{\n\tconstructor()\n\t{\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<a class=\"ui-link\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_EVENT')}\n\t\t\t</a>\n\t\t`;\n\n\t\treturn this.element;\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\n\nexport class StoryPointsHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.StoryPointsHeader');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.storyPointsNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point\">\n\t\t\t\t${this.sprint.getStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.inWorkStoryPointsNode = (this.sprint.isActive() ? Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-in-work-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_IN_WORK')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-in-work\">\n\t\t\t\t${this.sprint.getUncompletedStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t` : '');\n\n\t\tthis.doneStoryPointsNode = (this.sprint.isPlanned() ? '' : Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-done-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_DONE')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-done\">\n\t\t\t\t${this.sprint.getCompletedStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t`);\n\n\t\tthis.element = Tag.render`\n\t\t\t${this.renderBurnDownChartIcon()}\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-task\">\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-title\">\n\t\t\t\t\t${this.sprint.getNumberTasks()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t${this.storyPointsNode}\n\t\t\t${this.inWorkStoryPointsNode}\n\t\t\t${this.doneStoryPointsNode}\n\t\t`;\n\n\t\tEvent.bind(this.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-entity-title-btn-burn-down-chart'\n\t\t), 'click', () => this.emit('showSprintBurnDownChart'));\n\n\t\treturn this.element;\n\t}\n\n\trenderBurnDownChartIcon(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-burn-down-chart\">\n\t\t\t\t<span class=\"tasks-scrum-entity-burn-down-chart-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateNumberTasks()\n\t{\n\t\tconst parentNode = this.getElementByClassName(this.element, 'tasks-scrum-entity-title-btn-task');\n\t\tparentNode.querySelector('.tasks-scrum-entity-tasks-title').textContent = this.sprint.getNumberTasks();\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.storyPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.storyPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tsetCompletedStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.doneStoryPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.doneStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point-done'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tsetUncompletedStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.inWorkStoryPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.inWorkStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point-in-work'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tgetElementByClassName(elements: HTMLElement[], className: string): HTMLElement\n\t{\n\t\tlet element = null;\n\t\telements.forEach((elem) => {\n\t\t\tif (elem.classList.contains(className))\n\t\t\t{\n\t\t\t\telement = elem;\n\t\t\t}\n\t\t});\n\t\treturn element;\n\t}\n}","import {Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Entity} from '../entity';\nimport {Item} from '../../item/item';\nimport {SprintHeader} from './sprint.header';\nimport {EventsHeader} from './events.header';\nimport {GroupActionsButton} from '../group.actions.button';\nimport {ListItems} from '../list.items';\nimport {StoryPointsHeader} from './story.points.header';\nimport {StoryPoints} from '../../utility/story.points';\n\nimport type {EpicType, ItemParams} from '../../item/item';\nimport type {Views} from '../../view/view';\n\nimport '../../css/sprint.css';\n\ntype SprintInfo = {\n\tsprintGoal?: string\n}\n\nexport type SprintParams = {\n\tid: number,\n\ttmpId: string,\n\tname: string,\n\tsort: number,\n\tdateStart?: number,\n\tdateEnd?: number,\n\tweekendDaysTime?: number,\n\tdefaultSprintDuration: number,\n\tstoryPoints?: string,\n\tcompletedStoryPoints?: string,\n\tuncompletedStoryPoints?: string,\n\tcompletedTasks?: number,\n\tuncompletedTasks?: number,\n\tstatus?: string,\n\tnumberTasks?: number,\n\titems?: Array<ItemParams>,\n\tinfo?: SprintInfo,\n\tviews: Views\n};\n\nexport class Sprint extends Entity\n{\n\tconstructor(params: SprintParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint');\n\n\t\tthis.setSprintParams(params);\n\n\t\tthis.sprintHeader = null;\n\t\tthis.eventsHeader = null;\n\t\tthis.storyPointsHeader = null;\n\t}\n\n\tsetSprintParams(params: SprintParams)\n\t{\n\t\tthis.setTmpId(params.tmpId);\n\t\tthis.setName(params.name);\n\t\tthis.setSort(params.sort);\n\t\tthis.setDateStart(params.dateStart);\n\t\tthis.setDateEnd(params.dateEnd);\n\t\tthis.setWeekendDaysTime(params.weekendDaysTime);\n\t\tthis.setDefaultSprintDuration(params.defaultSprintDuration);\n\t\tthis.setStatus(params.status);\n\t\tthis.setCompletedStoryPoints(params.completedStoryPoints);\n\t\tthis.setUncompletedStoryPoints(params.uncompletedStoryPoints);\n\t\tthis.setCompletedTasks(params.completedTasks);\n\t\tthis.setUncompletedTasks(params.uncompletedTasks);\n\t\tthis.setItems(params.items);\n\t\tthis.setInfo(params.info);\n\t}\n\n\tstatic buildSprint(sprintData: SprintParams = {}): Sprint\n\t{\n\t\tconst sprint = new Sprint(sprintData);\n\t\tsprint.addSprintHeader(SprintHeader.buildHeader(sprint));\n\t\tsprint.addEventsHeader(new EventsHeader());\n\t\tsprint.addStoryPointsHeader(new StoryPointsHeader(sprint));\n\t\tsprint.addGroupActionsButton(new GroupActionsButton());\n\t\tsprint.addListItems(new ListItems(sprint));\n\t\treturn sprint;\n\t}\n\n\taddSprintHeader(sprintHeader: SprintHeader)\n\t{\n\t\tthis.sprintHeader = sprintHeader;\n\t\tthis.sprintHeader.initStyle(this);\n\n\t\tthis.sprintHeader.subscribe('changeName', this.onChangeName.bind(this));\n\t\tthis.sprintHeader.subscribe('removeSprint', this.onRemoveSprint.bind(this));\n\t\tthis.sprintHeader.subscribe('completeSprint', () => this.emit('completeSprint'));\n\t\tthis.sprintHeader.subscribe('startSprint', () => this.emit('startSprint'));\n\t\tthis.sprintHeader.subscribe('changeSprintDeadline', this.onChangeSprintDeadline.bind(this));\n\t\tthis.sprintHeader.subscribe('toggleVisibilityContent', this.toggleVisibilityContent.bind(this));\n\t}\n\n\taddStoryPointsHeader(storyPointsHeader: StoryPointsHeader)\n\t{\n\t\tthis.storyPointsHeader = storyPointsHeader;\n\n\t\tthis.storyPointsHeader.subscribe('showSprintBurnDownChart', () => this.emit('showSprintBurnDownChart'));\n\t}\n\n\taddEventsHeader(eventsHeader: EventsHeader)\n\t{\n\t\tthis.eventsHeader = eventsHeader;\n\t}\n\n\tinitStyle()\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.initStyle(this);\n\t\t}\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn (this.getStatus() === 'active');\n\t}\n\n\tisPlanned(): boolean\n\t{\n\t\treturn (this.getStatus() === 'planned');\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn (this.getStatus() === 'completed');\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn (this.isCompleted());\n\t}\n\n\tisExpired(): boolean\n\t{\n\t\tconst sprintEnd = new Date(this.dateEnd * 1000);\n\t\treturn (this.isActive() && (sprintEnd.getTime() < (new Date()).getTime()));\n\t}\n\n\thasInput(): boolean\n\t{\n\t\treturn !this.isDisabled();\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'sprint';\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tsuper.setItem(newItem);\n\n\t\tnewItem.setDisableStatus(this.isDisabled());\n\t}\n\n\tsetName(name)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : '');\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateNameNode(this.name);\n\t\t}\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetTmpId(tmpId: string)\n\t{\n\t\tthis.tmpId = (Type.isString(tmpId) ? tmpId : '');\n\t}\n\n\tgetTmpId(): string\n\t{\n\t\treturn this.tmpId;\n\t}\n\n\tsetSort(sort)\n\t{\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 1);\n\t}\n\n\tgetSort()\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetDateStart(dateStart)\n\t{\n\t\tthis.dateStart = (Type.isInteger(dateStart) ? parseInt(dateStart, 10) : 0);\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateStartNode(this.dateStart);\n\t\t}\n\t}\n\n\tgetDateStart(): number\n\t{\n\t\treturn parseInt(this.dateStart, 10);\n\t}\n\n\tsetDateEnd(dateEnd)\n\t{\n\t\tthis.dateEnd = (Type.isInteger(dateEnd) ? parseInt(dateEnd, 10) : 0);\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateEndNode(this.dateEnd);\n\t\t}\n\t}\n\n\tgetDateEnd(): number\n\t{\n\t\treturn parseInt(this.dateEnd, 10);\n\t}\n\n\tsetWeekendDaysTime(weekendDaysTime)\n\t{\n\t\tthis.weekendDaysTime = (Type.isInteger(weekendDaysTime) ? parseInt(weekendDaysTime, 10) : 0);\n\t}\n\n\tgetWeekendDaysTime(): number\n\t{\n\t\treturn this.weekendDaysTime;\n\t}\n\n\tsetCompletedStoryPoints(completedStoryPoints)\n\t{\n\t\tthis.completedStoryPoints = new StoryPoints();\n\n\t\tthis.completedStoryPoints.addPoints(completedStoryPoints);\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetCompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetUncompletedStoryPoints(uncompletedStoryPoints)\n\t{\n\t\tthis.uncompletedStoryPoints = new StoryPoints();\n\n\t\tthis.uncompletedStoryPoints.addPoints(uncompletedStoryPoints);\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetUncompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.uncompletedStoryPoints;\n\t}\n\n\tsetItems(items)\n\t{\n\t\tif (!Type.isArray(items))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titems.forEach((itemParams: ItemParams) => {\n\t\t\tconst item = new Item(itemParams);\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t\tthis.items.set(item.itemId, item);\n\t\t});\n\t}\n\n\tsetInfo(info: SprintInfo)\n\t{\n\t\tthis.info = (Type.isPlainObject(info) ? info : {sprintGoal: ''});\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tsuper.setNumberTasks(numberTasks);\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.updateNumberTasks();\n\t\t}\n\t}\n\n\tsetCompletedTasks(completedTasks)\n\t{\n\t\tthis.completedTasks = (Type.isInteger(completedTasks) ? parseInt(completedTasks, 10) : 0);\n\t}\n\n\tgetCompletedTasks(): number\n\t{\n\t\treturn this.completedTasks;\n\t}\n\n\tsetUncompletedTasks(uncompletedTasks)\n\t{\n\t\tthis.uncompletedTasks = (Type.isInteger(uncompletedTasks) ? parseInt(uncompletedTasks, 10) : 0);\n\t}\n\n\tgetUncompletedTasks(): number\n\t{\n\t\treturn this.uncompletedTasks;\n\t}\n\n\tsetDefaultSprintDuration(defaultSprintDuration)\n\t{\n\t\tthis.defaultSprintDuration = (Type.isInteger(defaultSprintDuration) ? parseInt(defaultSprintDuration, 10) : 0);\n\t}\n\n\tgetDefaultSprintDuration()\n\t{\n\t\treturn this.defaultSprintDuration;\n\t}\n\n\tgetInfo(): SprintInfo\n\t{\n\t\treturn this.info;\n\t}\n\n\tgetEpics(): Map<number, EpicType>\n\t{\n\t\tconst epics = new Map();\n\t\tthis.items.forEach((item: Item) => {\n\t\t\t//todo wtf, why did not Set work?\n\t\t\tif (item.getEpic())\n\t\t\t{\n\t\t\t\tepics.set(item.getEpic().id, item.getEpic());\n\t\t\t}\n\t\t});\n\t\treturn epics;\n\t}\n\n\tgetUncompletedItems(): Map<string, Item>\n\t{\n\t\tconst items = new Map();\n\t\tthis.items.forEach((item: Item) => {\n\t\t\tif (!item.isCompleted())\n\t\t\t{\n\t\t\t\titems.set(item.getItemId(), item);\n\t\t\t}\n\t\t});\n\t\treturn items;\n\t}\n\n\tsetStatus(status)\n\t{\n\t\tconst availableStatus = new Set([\n\t\t\t'planned',\n\t\t\t'active',\n\t\t\t'completed'\n\t\t]);\n\n\t\tthis.status = (availableStatus.has(status) ? status : 'planned');\n\n\t\tthis.initStyle();\n\n\t\tthis.items.forEach((item) => {\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t});\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\tif (this.input)\n\t\t\t{\n\t\t\t\tthis.input.removeYourself();\n\t\t\t}\n\t\t\tif (this.groupActionsButton)\n\t\t\t{\n\t\t\t\tthis.groupActionsButton.removeYourself();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetStatus(): string\n\t{\n\t\treturn this.status;\n\t}\n\n\tupdateYourself(tmpSprint: Sprint)\n\t{\n\t\tif (tmpSprint.getName() !== this.getName())\n\t\t{\n\t\t\tthis.setName(tmpSprint.getName());\n\t\t}\n\t\tif (tmpSprint.getDateStart() !== this.getDateStart())\n\t\t{\n\t\t\tthis.setDateStart(tmpSprint.getDateStart());\n\t\t}\n\t\tif (tmpSprint.getDateEnd() !== this.getDateEnd())\n\t\t{\n\t\t\tthis.setDateEnd(tmpSprint.getDateEnd());\n\t\t}\n\n\t\tthis.setStoryPoints(tmpSprint.getStoryPoints().getPoints());\n\t\tthis.setCompletedStoryPoints(tmpSprint.getCompletedStoryPoints().getPoints());\n\t\tthis.setUncompletedStoryPoints(tmpSprint.getUncompletedStoryPoints().getPoints());\n\n\t\tif (tmpSprint.getStatus() !== this.getStatus())\n\t\t{\n\t\t\tthis.setStatus(tmpSprint.getStatus());\n\t\t}\n\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.addStoryPointsHeader(new StoryPointsHeader(this));\n\t\t\tDom.replace(this.node.querySelector('.tasks-scrum-sprint-header-event-params'), this.renderParams());\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t\tthis.emit('removeSprint');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint\" data-sprint-sort=\"${this.sort}\" data-sprint-id=\"${this.getId()}\">\n\t\t\t\t${this.sprintHeader ? this.sprintHeader.render() : ''}\n\t\t\t\t<div class=\"tasks-scrum-sprint-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sub-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-event\">\n\t\t\t\t\t\t\t${this.eventsHeader ? '' : ''/*todo*/}\n\t\t\t\t\t\t\t${this.isCompleted() ? this.renderLinkToCompletedSprint() : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.renderParams()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-actions\">\n\t\t\t\t\t\t${this.groupActionsButton  && !this.isDisabled() ? this.groupActionsButton.render() : ''}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-items\">\n\t\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-entity-items-loader\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.itemsLoaderNode = this.node.querySelector('.tasks-scrum-entity-items-loader');\n\t\tthis.bindItemsLoader(this.itemsLoaderNode);\n\n\t\treturn this.node;\n\t}\n\n\trenderParams(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header-event-params\">\n\t\t\t\t${this.storyPointsHeader ? this.storyPointsHeader.render() : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderLinkToCompletedSprint(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<a href=\"${Text.encode(this.getViews().completedSprint.url)}\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_COMPLETED_SPRINT_LINK')}\n\t\t\t</a>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.updateVisibility();\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.onAfterAppend();\n\t\t}\n\n\t\tsuper.onAfterAppend();\n\t}\n\n\tsubscribeToItem(item)\n\t{\n\t\tsuper.subscribeToItem(item);\n\n\t\titem.subscribe('moveToBacklog', (baseEvent) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: baseEvent.getTarget()\n\t\t\t});\n\t\t});\n\n\t\titem.subscribe('updateCompletedStatus', (baseEvent: BaseEvent) => {\n\t\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\t\tif (item.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tthis.setCompletedTasks(this.getCompletedTasks() + 1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.setUncompletedTasks(this.getUncompletedTasks() - 1);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\titem.subscribe('toggleSubTasks', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('toggleSubTasks', baseEvent.getTarget());\n\t\t})\n\t}\n\n\tonChangeName (baseEvent)\n\t{\n\t\tconst createInput = (value) => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input type=\"text\" class=\"tasks-scrum-sprint-header-name\" value=\"${Text.encode(value)}\">\n\t\t\t`;\n\t\t};\n\n\t\tconst inputNode = createInput(this.name);\n\t\tconst nameNode = baseEvent.getData().querySelector('.tasks-scrum-sprint-header-name');\n\n\t\tEvent.bind(inputNode, 'change', (event) => {\n\t\t\tconst newValue = event.target['value'];\n\t\t\tthis.emit('changeSprintName', {\n\t\t\t\tsprintId: this.getId(),\n\t\t\t\tname: newValue\n\t\t\t});\n\t\t\tthis.name = newValue;\n\t\t\tinputNode.blur();\n\t\t}, true);\n\n\t\tconst blockEnterInput = (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t\tinputNode.blur();\n\t\t};\n\n\t\tEvent.bind(inputNode, 'keydown', blockEnterInput);\n\t\tEvent.bindOnce(inputNode, 'blur', () => {\n\t\t\tEvent.unbind(inputNode, 'keydown', blockEnterInput);\n\t\t\tnameNode.textContent = Text.encode(this.name);\n\t\t\tDom.replace(inputNode, nameNode);\n\t\t}, true);\n\n\t\tDom.replace(nameNode, inputNode);\n\n\t\tinputNode.focus();\n\t\tinputNode.setSelectionRange(this.name.length, this.name.length);\n\t}\n\n\tonRemoveSprint()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: item\n\t\t\t});\n\t\t});\n\t\tthis.removeYourself();\n\t}\n\n\tremoveSprint()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: item\n\t\t\t});\n\t\t});\n\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t}\n\n\tonChangeSprintDeadline(baseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.emit('changeSprintDeadline', requestData);\n\t\tif (requestData.hasOwnProperty('dateStart'))\n\t\t{\n\t\t\tthis.dateStart = parseInt(requestData.dateStart, 10);\n\t\t}\n\t\telse if (requestData.hasOwnProperty('dateEnd'))\n\t\t{\n\t\t\tthis.dateEnd = parseInt(requestData.dateEnd, 10);\n\t\t}\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateStartNode(timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateEndNode(timestamp);\n\t\t}\n\t}\n\n\ttoggleVisibilityContent()\n\t{\n\t\tif (this.getContentNode().style.display === 'block')\n\t\t{\n\t\t\tthis.hideContent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showContent();\n\t\t\tif (this.isCompleted() && this.getItems().size === 0)\n\t\t\t{\n\t\t\t\tthis.emit('getSprintCompletedItems');\n\t\t\t}\n\t\t}\n\t}\n\n\tshowContent()\n\t{\n\t\tif (this.getContentNode())\n\t\t{\n\t\t\tthis.getContentNode().style.display = 'block';\n\t\t}\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.upTick();\n\t\t}\n\t}\n\n\thideContent()\n\t{\n\t\tif (this.getContentNode())\n\t\t{\n\t\t\tthis.getContentNode().style.display = 'none';\n\t\t}\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.downTick();\n\t\t}\n\t}\n\n\tupdateVisibility()\n\t{\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tif (this.isEmpty())\n\t\t\t{\n\t\t\t\tthis.hideContent();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showContent();\n\t\t\t}\n\n\t\t\tthis.showSprint();\n\n\t\t\tif (this.isExactSearchApplied())\n\t\t\t{\n\t\t\t\tif (this.isEmpty())\n\t\t\t\t{\n\t\t\t\t\tthis.hideSprint();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showContent();\n\n\t\t\tif (this.isExactSearchApplied())\n\t\t\t{\n\t\t\t\tif (this.isEmpty())\n\t\t\t\t{\n\t\t\t\t\tthis.hideSprint();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showSprint();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showSprint();\n\t\t\t}\n\t\t}\n\t}\n\n\tshowSprint()\n\t{\n\t\tthis.node.style.display = 'block';\n\t}\n\n\thideSprint()\n\t{\n\t\tthis.node.style.display = 'none';\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onActivateGroupMode(baseEvent);\n\n\t\tDom.addClass(this.node.querySelector('.tasks-scrum-sprint-items'), 'tasks-scrum-sprint-items-group-mode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onDeactivateGroupMode(baseEvent);\n\n\t\tDom.removeClass(this.node.querySelector('.tasks-scrum-sprint-items'), 'tasks-scrum-sprint-items-group-mode');\n\t}\n\n\tgetContentNode(): HTMLElement\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\treturn this.node.querySelector('.tasks-scrum-sprint-content');\n\t\t}\n\t}\n\n\tupdateStoryPointsNode()\n\t{\n\t\tsuper.updateStoryPointsNode();\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.setStoryPoints(this.getStoryPoints().getPoints());\n\t\t\tthis.storyPointsHeader.setCompletedStoryPoints(this.getCompletedStoryPoints().getPoints());\n\t\t\tthis.storyPointsHeader.setUncompletedStoryPoints(this.getUncompletedStoryPoints().getPoints());\n\t\t}\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateStatsHeader();\n\t\t}\n\t}\n}","import {Entity} from '../entity/entity';\nimport {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\n\nexport class EntityStorage\n{\n\tconstructor()\n\t{\n\t\tthis.backlog = null;\n\t\tthis.sprints = new Map();\n\t}\n\n\taddBacklog(backlog: Backlog)\n\t{\n\t\tif (!(backlog instanceof Backlog))\n\t\t{\n\t\t\tthrow new Error('EntityStorage: Backlog is in wrong format');\n\t\t}\n\n\t\tthis.backlog = backlog;\n\t}\n\n\taddSprint(sprint: Sprint)\n\t{\n\t\tthis.sprints.set(sprint.getId(), sprint);\n\t}\n\n\tremoveSprint(sprintId: number)\n\t{\n\t\tthis.sprints.delete(sprintId);\n\t}\n\n\tgetBacklog(): Backlog\n\t{\n\t\tif (this.backlog === null)\n\t\t{\n\t\t\tthrow new Error('EntityStorage: Backlog not found');\n\t\t}\n\n\t\treturn this.backlog;\n\t}\n\n\tgetSprints(): Map<number, Sprint>\n\t{\n\t\treturn this.sprints;\n\t}\n\n\tgetSprintsAvailableForFilling(entityFrom: Entity): Set<Sprint>\n\t{\n\t\tconst sprints = new Set();\n\n\t\tthis.sprints.forEach((sprint: Sprint) => {\n\t\t\tif (!sprint.isCompleted() && entityFrom.getId() !== sprint.getId())\n\t\t\t{\n\t\t\t\tsprints.add(sprint);\n\t\t\t}\n\t\t});\n\n\t\treturn sprints;\n\t}\n\n\tgetAllEntities(): Map<number, Entity>\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(this.backlog.getId(), this.backlog);\n\n\t\t[...this.sprints.values()].map((sprint) => entities.set(sprint.getId(), sprint));\n\n\t\treturn entities;\n\t}\n\n\tgetAllItems(): Map<number, Item>\n\t{\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\t[...this.sprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn items;\n\t}\n\n\trecalculateItemsSort()\n\t{\n\t\tthis.backlog.recalculateItemsSort();\n\t\tthis.sprints.forEach((sprint) => sprint.recalculateItemsSort());\n\t}\n\n\tfindEntityByEntityId(entityId: number): Entity\n\t{\n\t\tentityId = parseInt(entityId, 10);\n\n\t\tif (this.backlog.getId() === entityId)\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === entityId);\n\t}\n\n\tfindItemByItemId(itemId: number): Item\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn backlogItems.get(itemId);\n\t\t}\n\n\t\tconst sprint = [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t\tif (sprint)\n\t\t{\n\t\t\treturn sprint.getItems().get(itemId);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindItemBySourceId(sourceId: number): Item\n\t{\n\t\tsourceId = parseInt(sourceId, 10);\n\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\t[...this.sprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn [...items.values()].find((item: Item) => item.getSourceId() === sourceId);\n\t}\n\n\tfindEntityByItemId(itemId: number): Entity\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t}\n}","import {Filter} from '../service/filter';\nimport {Item} from '../item/item';\nimport {RequestSender} from '../utility/request.sender';\nimport {EntityStorage} from '../utility/entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tfilterService: Filter,\n\tuserId: number,\n\tgroupId: number\n}\n\nexport class PullCounters\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.filterService = params.filterService;\n\t\tthis.userId = params.userId;\n\t\tthis.groupId = params.groupId;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\ttask_view: this.onTaskView.bind(this),\n\t\t\tproject_read_all: this.onCommentsReadAll.bind(this)\n\t\t};\n\t}\n\n\tonTaskView(data)\n\t{\n\t\tconst inputTaskId = parseInt(data.TASK_ID, 10);\n\t\tconst inputUserId = parseInt(data.USER_ID, 10);\n\n\t\tif (inputUserId !== this.userId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = this.entityStorage.findItemBySourceId(inputTaskId);\n\n\t\tif (item)\n\t\t{\n\t\t\tthis.requestSender.getCurrentState({\n\t\t\t\ttaskId: item.getSourceId()\n\t\t\t}).then((response) => {\n\t\t\t\titem.updateYourself(new Item(response.data.itemData));\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t}\n\t}\n\n\tonCommentsReadAll(data)\n\t{\n\t\tconst groupId = data.GROUP_ID;\n\n\t\tif (groupId && groupId === this.groupId)\n\t\t{\n\t\t\tthis.filterService.applyFilter();\n\t\t}\n\t}\n}","import {Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {PULL as Pull} from 'pull.client';\n\nimport {Filter} from '../service/filter';\n\nimport {RequestSender} from '../utility/request.sender';\nimport {EntityStorage} from '../utility/entity.storage';\n\nimport {PullCounters} from './pull.counters';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tfilter: Filter,\n\tisOwnerCurrentUser: boolean,\n\tuserId: number,\n\tgroupId: number\n}\n\nexport class Counters\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.filterService = params.filter;\n\n\t\tthis.isOwnerCurrentUser = params.isOwnerCurrentUser;\n\n\t\tthis.userId = parseInt(params.userId, 10);\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\tthis.filter = this.filterService.getFilterManager();\n\n\t\tthis.updateFields();\n\t\tthis.bindEvents();\n\t\tthis.subscribeToPull();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t\tEventEmitter.subscribe('Tasks.Toolbar:onItem', this.onCounterClick.bind(this));\n\t}\n\n\tsubscribeToPull()\n\t{\n\t\tPull.subscribe(new PullCounters({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tfilterService: this.filterService,\n\t\t\tuserId: this.userId,\n\t\t\tgroupId: this.groupId\n\t\t}));\n\t}\n\n\tonFilterApply()\n\t{\n\t\tthis.updateFields();\n\t}\n\n\tupdateFields()\n\t{\n\t\tthis.fields = this.filter.getFilterFieldsValues();\n\t}\n\n\tonCounterClick(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\n\t\tif (data.counter && data.counter.filter)\n\t\t{\n\t\t\tthis.toggleByField({[data.counter.filterField]: data.counter.filterValue});\n\t\t}\n\t}\n\n\tisFilteredByField(field)\n\t{\n\t\tif (!Object.keys(this.fields).includes(field))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Type.isArray(this.fields[field]))\n\t\t{\n\t\t\treturn this.fields[field].length > 0;\n\t\t}\n\n\t\treturn this.fields[field] !== '';\n\t}\n\n\tisFilteredByFieldValue(field, value)\n\t{\n\t\treturn this.isFilteredByField(field) && this.fields[field] === value;\n\t}\n\n\ttoggleByField(field)\n\t{\n\t\tconst name = Object.keys(field)[0];\n\t\tconst value = field[name];\n\n\t\tif (!this.isFilteredByFieldValue(name, value))\n\t\t{\n\t\t\tthis.filter.getApi().extendFilter({[name]: value});\n\t\t\treturn;\n\t\t}\n\n\t\tthis.filter.getFilterFields().forEach((field) => {\n\t\t\tif (field.getAttribute('data-name') === name)\n\t\t\t{\n\t\t\t\tthis.filter.getFields().deleteField(field);\n\t\t\t}\n\t\t});\n\n\t\tthis.filter.getSearch().apply();\n\t}\n}","import {Dom} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\n\nexport class SidePanel extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SidePanel');\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\tthis.contentSidePanelManager = new BX.SidePanel.Manager({});\n\t\t/* eslint-enable */\n\n\t\tthis.contentSidePanels = new Set();\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onLoad', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tsidePanel.setCacheable(false);\n\t\t\tthis.emit('onLoadSidePanel', sidePanel);\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tthis.emit('onCloseSidePanel', sidePanel);\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseComplete', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tif (this.contentSidePanels.has(sidePanel.getUrl()))\n\t\t\t{\n\t\t\t\tthis.contentSidePanels.delete(sidePanel.getUrl());\n\t\t\t\tif (!this.contentSidePanels.size)\n\t\t\t\t{\n\t\t\t\t\tthis.resetBodyWidthHack();\n\t\t\t\t\tthis.addEscapePressHandler();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tisPreviousSidePanelExist(currentSidePanel): Boolean\n\t{\n\t\tconst manager = this.contentSidePanels.has(currentSidePanel.getUrl())\n\t\t\t? this.contentSidePanelManager\n\t\t\t: this.sidePanelManager\n\t\t;\n\n\t\treturn Boolean(manager.getPreviousSlider(currentSidePanel));\n\t}\n\n\tgetTopSidePanel()\n\t{\n\t\tconst topSidePanel = this.sidePanelManager.getTopSlider();\n\n\t\treturn topSidePanel ? topSidePanel : null;\n\t}\n\n\treloadTopSidePanel(contentSidePanel: boolean = false)\n\t{\n\t\tconst manager = contentSidePanel ? this.contentSidePanelManager : this.sidePanelManager;\n\n\t\tif (manager.getTopSlider())\n\t\t{\n\t\t\tmanager.getTopSlider().reload();\n\t\t}\n\t}\n\n\tcloseTopSidePanel(contentSidePanel: boolean = false)\n\t{\n\t\tconst manager = contentSidePanel ? this.contentSidePanelManager : this.sidePanelManager;\n\n\t\tif (manager.getTopSlider())\n\t\t{\n\t\t\tmanager.getTopSlider().close();\n\t\t}\n\t}\n\n\treloadPreviousSidePanel(currentSidePanel)\n\t{\n\t\tconst manager = this.contentSidePanels.has(currentSidePanel.getUrl())\n\t\t\t? this.contentSidePanelManager\n\t\t\t: this.sidePanelManager\n\t\t;\n\t\tconst previousSidePanel = manager.getPreviousSlider(currentSidePanel);\n\n\t\tpreviousSidePanel.reload();\n\t}\n\n\topenSidePanelByUrl(url)\n\t{\n\t\tthis.sidePanelManager.open(url);\n\t}\n\n\topenSidePanel(id, options)\n\t{\n\t\tthis.applyBodyWidthHack();\n\t\tthis.removeEscapePressHandler();\n\n\t\tthis.contentSidePanelManager.open(id, options);\n\n\t\tthis.contentSidePanels.add(id);\n\t}\n\n\texistFrameTopSlider(): boolean\n\t{\n\t\treturn Boolean(this.sidePanelManager.getTopSlider());\n\t}\n\n\taddEscapePressHandler()\n\t{\n\t\tconst sidePanel = this.sidePanelManager.getTopSlider();\n\t\tif (sidePanel)\n\t\t{\n\t\t\tconst frameWindow = sidePanel.getFrameWindow();\n\t\t\tframeWindow.addEventListener('keydown', sidePanel.handleFrameKeyDown);\n\t\t}\n\t}\n\n\tremoveEscapePressHandler()\n\t{\n\t\tconst sidePanel = this.sidePanelManager.getTopSlider();\n\t\tif (sidePanel)\n\t\t{\n\t\t\tconst frameWindow = sidePanel.getFrameWindow();\n\t\t\tframeWindow.removeEventListener('keydown', sidePanel.handleFrameKeyDown);\n\t\t}\n\t}\n\n\tapplyBodyWidthHack()\n\t{\n\t\tif (this.existFrameTopSlider())\n\t\t{\n\t\t\tDom.addClass(document.body, 'tasks-scrum-side-panel-padding');\n\t\t}\n\t}\n\n\tresetBodyWidthHack()\n\t{\n\t\tif (this.existFrameTopSlider())\n\t\t{\n\t\t\tDom.removeClass(document.body, 'tasks-scrum-side-panel-padding');\n\t\t}\n\t}\n}","import {Event, Tag, Text} from 'main.core';\n\nimport {SidePanel} from '../../service/side.panel';\n\nimport type {Views} from '../view';\n\ntype Params = {\n\tsidePanel: SidePanel,\n\tviews: Views\n}\n\nexport class Tabs\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.views = params.views;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst planTabActiveClass = (\n\t\t\tthis.views['plan'].active\n\t\t\t? 'tasks-view-switcher--item --active'\n\t\t\t: ''\n\t\t);\n\t\tconst activeTabActiveClass = (\n\t\t\tthis.views['activeSprint'].active\n\t\t\t? 'tasks-view-switcher--item --active'\n\t\t\t: ''\n\t\t);\n\t\tconst completedTabActiveClass = (\n\t\t\tthis.views['completedSprint'].active\n\t\t\t? 'tasks-view-switcher--item --active'\n\t\t\t: ''\n\t\t);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-view-switcher\">\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['plan'].url}\"\n\t\t\t\t\tclass=\"tasks-view-switcher--item ${planTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['plan'].name)}</a>\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['activeSprint'].url}\"\n\t\t\t\t\tclass=\"tasks-view-switcher--item ${activeTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['activeSprint'].name)}</a>\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['completedSprint'].url}\"\n\t\t\t\t\tclass=\"tasks-view-switcher--item ${completedTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['completedSprint'].name)}</a>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.node.querySelectorAll('a').forEach((tab: HTMLElement) => {\n\t\t\tEvent.bind(tab, 'click', () => {\n\t\t\t\tconst topSidePanel = this.sidePanel.getTopSidePanel()\n\t\t\t\tif (topSidePanel !== null)\n\t\t\t\t{\n\t\t\t\t\ttopSidePanel.showLoader();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn this.node;\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Filter} from '../service/filter';\n\nimport {RequestSender} from '../utility/request.sender';\nimport {Counters} from '../counters/counters';\n\nimport {Tabs} from './header/tabs';\n\nimport '../css/base.css';\nimport {SidePanel} from \"../service/side.panel\";\n\nexport type ViewInfo = {\n\tname: string,\n\turl: string,\n\tactive: boolean\n}\n\nexport type Views = {\n\tplan: ViewInfo,\n\tactiveSprint: ViewInfo,\n\tcompletedSprint: ViewInfo\n}\n\ntype Params = {\n\tsignedParameters: string,\n\tdebugMode: string,\n\tisOwnerCurrentUser: 'Y' | 'N',\n\tuserId: number,\n\tgroupId: number,\n\tfilterId: string\n}\n\nexport class View extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.View');\n\n\t\tthis.isOwnerCurrentUser = (params.isOwnerCurrentUser === 'Y');\n\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.requestSender = new RequestSender({\n\t\t\tsignedParameters: params.signedParameters,\n\t\t\tdebugMode: params.debugMode\n\t\t});\n\n\t\tthis.filter = new Filter({\n\t\t\tfilterId: params.filterId,\n\t\t\tscrumManager: this,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\n\t\tthis.userId = parseInt(params.userId, 10);\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for scrum not found');\n\t\t}\n\t}\n\n\trenderTabsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for tabs not found');\n\t\t}\n\n\t\tconst tabs = new Tabs({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tviews: this.views\n\t\t});\n\n\t\tDom.append(tabs.render(), container);\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for Sprint stats not found');\n\t\t}\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for buttons not found');\n\t\t}\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn this.userId;\n\t}\n\n\tgetCurrentGroupId(): number\n\t{\n\t\treturn this.groupId;\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class TeamSpeedButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.TeamSpeedButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-themes ui-btn-round ui-btn-xs\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Loc} from 'main.core';\n\ntype Data = {\n\tday: number,\n\tidealValue: number,\n\tremainValue: number\n}\n\n//todo import amchart4 like es6\nexport class BurnDownChart\n{\n\tconstructor(data: Data)\n\t{\n\t\tthis.data = data;\n\t}\n\n\tcreateChart(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\n\t\tthis.createAxises();\n\n\t\tthis.createIdealLine();\n\t\tthis.createRemainLine();\n\n\t\tthis.createLegend();\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst categoryAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\tcategoryAxis.renderer.grid.template.location = 0;\n\t\tcategoryAxis.dataFields.category = 'day';\n\t\tcategoryAxis.renderer.minGridDistance = 60;\n\n\t\tconst valueAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tvalueAxis.min = -0.1;\n\t}\n\n\tcreateIdealLine()\n\t{\n\t\tconst lineSeries = this.chart.series.push(new am4charts.LineSeries());\n\t\tlineSeries.name = Loc.getMessage('TASKS_SCRUM_SPRINT_IDEAL_BURN_DOWN_CHART_LINE_TITLE'); //todo move from class\n\t\tlineSeries.stroke = am4core.color('#2882b3');\n\t\tlineSeries.strokeWidth = 2;\n\n\t\tlineSeries.dataFields.categoryX = 'day';\n\t\tlineSeries.dataFields.valueY = 'idealValue';\n\n\t\tconst circleColor = '#2882b3';\n\t\tconst circleBullet = new am4charts.CircleBullet();\n\t\tcircleBullet.circle.radius = 4;\n\t\tcircleBullet.circle.fill = am4core.color(circleColor);\n\t\tcircleBullet.circle.stroke = am4core.color(circleColor);\n\n\t\tlineSeries.bullets.push(circleBullet);\n\n\t\tconst segment = lineSeries.segments.template;\n\t\tconst hoverState = segment.states.create('hover');\n\t\thoverState.properties.strokeWidth = 4;\n\t}\n\n\tcreateRemainLine()\n\t{\n\t\tconst lineSeries = this.chart.series.push(new am4charts.LineSeries());\n\t\tlineSeries.name = Loc.getMessage('TASKS_SCRUM_SPRINT_REMAIN_BURN_DOWN_CHART_LINE_TITLE'); //todo move from class\n\t\tlineSeries.stroke = am4core.color('#9c1f1f');\n\t\tlineSeries.strokeWidth = 2;\n\n\t\tlineSeries.dataFields.categoryX = 'day';\n\t\tlineSeries.dataFields.valueY = 'remainValue';\n\n\t\tconst circleColor = '#9c1f1f';\n\t\tconst circleBullet = new am4charts.CircleBullet();\n\t\tcircleBullet.circle.radius = 4;\n\t\tcircleBullet.circle.fill = am4core.color(circleColor);\n\t\tcircleBullet.circle.stroke = am4core.color(circleColor);\n\n\t\tlineSeries.bullets.push(circleBullet);\n\n\t\tconst segment = lineSeries.segments.template;\n\t\tconst hoverState = segment.states.create('hover');\n\t\thoverState.properties.strokeWidth = 4;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.itemContainers.template.events.on('over', (event) => {\n\t\t\tthis.processOver(event.target.dataItem.dataContext);\n\t\t});\n\t\tthis.chart.legend.itemContainers.template.events.on('out', () => this.processOut());\n\t}\n\n\tprocessOver(hoveredLine)\n\t{\n\t\thoveredLine.toFront();\n\t\thoveredLine.segments.each((segment) => segment.setState('hover'));\n\t};\n\n\tprocessOut()\n\t{\n\t\tthis.chart.series.each((series) => {\n\t\t\tseries.segments.each((segment) => segment.setState('default'));\n\t\t\tseries.bulletsContainer.setState('default');\n\t\t});\n\t};\n\n\tdestroyBurnDownChart()\n\t{\n\t\tthis.chart.dispose();\n\t}\n}","import {Event, Loc, Runtime, Tag, Text, Dom, Type} from 'main.core';\nimport {Sprint} from './sprint';\nimport {SidePanel} from '../../service/side.panel';\nimport {RequestSender} from '../../utility/request.sender';\nimport {BaseEvent} from 'main.core.events';\nimport {Confetti} from 'ui.confetti';\nimport {StatsCalculator} from '../../utility/stats.calculator';\nimport {BurnDownChart} from '../../utility/burn.down.chart';\n\nimport '../../css/sprint.side.panel.css';\n\ntype Params = {\n\tsprints?: Map,\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender,\n\tviews: {\n\t\tplan: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tactiveSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tcompletedSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t}\n\t}\n};\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tinfo: EpicInfoType\n}\n\ntype RequestDataToStartSprint = {\n\tsprintId: number,\n\tsprintGoal: string\n}\n\ntype RequestDataToCompleteSprint = {\n\tsprintId: number,\n\tdirection: number|string\n}\n\ntype RequestDataToGetBurnDownChartData = {\n\tsprintId: number\n}\n\nexport class SprintSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sprints = params.sprints ? params.sprints : new Map();\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.views = params.views;\n\n\t\tthis.currentSprint = null;\n\t\tthis.uncompletedItems = new Map();\n\n\t\tthis.lastCompletedSprint = this.getLastCompletedSprint(this.sprints);\n\t}\n\n\tshowStartSidePanel(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-start-side-panel';\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadStartPanel.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildStartPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000,\n\t\t\twidth: 600\n\t\t});\n\t}\n\n\tshowCompleteSidePanel(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-complete-side-panel';\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadCompletePanel.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildCompletePanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000,\n\t\t\twidth: 600\n\t\t});\n\t}\n\n\tshowBurnDownChart(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-burn-down-chart';\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadSprintBurnDownPanel.bind(this));\n\t\tthis.sidePanel.subscribe('onCloseSidePanel', this.onCloseBurnDownChart.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildBurnDownPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildStartPanel(): HTMLElement\n\t{\n\t\tlet differenceStoryPoints = this.currentSprint.getStoryPoints().getPoints();\n\t\tdifferenceStoryPoints = (differenceStoryPoints > 0 ? '+' + differenceStoryPoints : differenceStoryPoints);\n\t\tif (this.lastCompletedSprint)\n\t\t{\n\t\t\tdifferenceStoryPoints = this.getDifferenceStoryPointsBetweenSprints(\n\t\t\t\tthis.currentSprint,\n\t\t\t\tthis.lastCompletedSprint\n\t\t\t);\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_TASK_COUNT_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t\t${parseInt(this.currentSprint.getNumberTasks())}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box tasks-scrum-sprint-sidepanel-info-box-story\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_STORY_POINTS_COUNT_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t\t${Text.encode(this.currentSprint.getStoryPoints().getPoints())}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-extra\">\n\t\t\t\t\t\t\t\t\t${differenceStoryPoints}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_EPICS_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic-list\">\n\t\t\t\t\t\t\t\t${[...this.currentSprint.getEpics().values()].map((epic: EpicType) => {\n\t\t\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-epic-item\" style=\"background: ${Text.encode(epic.info.color)};\">\n\t\t\t\t\t\t\t\t\t\t\t${Text.encode(epic.name)}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_GOAL_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea ui-ctl-resize-y\">\n\t\t\t\t\t\t\t<textarea class=\"ui-ctl-element\"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadStartPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\n\t\tthis.onLoadStartButtons().then((buttonsContainer: HTMLElement) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', this.onStartSprint.bind(this));\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tbuildCompletePanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t${this.buildSprintGoal()}\n\t\t\t\t${this.buildSprintActions()}\n\t\t\t\t${this.buildSprintPlan()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildBurnDownPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_IDEAL_BURN_DOWN_CHART_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-chart\"></div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintGoal(): HTMLElement|string\n\t{\n\t\tconst sprintInfo = this.currentSprint.getInfo();\n\t\tconst sprintGoal = sprintInfo.sprintGoal;\n\t\tif (!sprintGoal)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_GOAL_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-text\">\n\t\t\t\t\t\t${Text.encode(sprintGoal)}\n\t\t\t\t\t </div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintActions(): HTMLElement|string\n\t{\n\t\tconst uncompletedTasks = this.currentSprint.getUncompletedTasks();\n\t\tif (uncompletedTasks === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tlet listSprintsOptions = '';\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tif (sprint.isPlanned())\n\t\t\t{\n\t\t\t\tlistSprintsOptions += `<option value=\"${sprint.getId()}\">${Text.encode(sprint.getName())}</option>`;\n\t\t\t}\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title tasks-scrum-sprint-sidepanel-title-icon\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-field\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-label\">\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_SELECT')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t<select class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t\t<option value=\"backlog\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_MOVE_SELECTOR_BACKLOG')}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t<option value=\"0\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_NEW_SPRINT')}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t${listSprintsOptions}\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-uncompleted\">\n\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-subtitle\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_ITEM_LIST')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-uncompleted-list\">\n\t\t\t\t\t\t\t${[...this.currentSprint.getUncompletedItems().values()].map((item: Item) => {\n\t\t\t\t\t\t\t\tif (!item.isSubTask())\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst previewItem = item.getPreviewVersion();\n\t\t\t\t\t\t\t\t\tthis.uncompletedItems.set(previewItem.getItemId(), previewItem);\n\t\t\t\t\t\t\t\t\treturn previewItem.render();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintPlan(): HTMLElement\n\t{\n\t\tconst statsCalculator = new StatsCalculator();\n\t\tconst percentage = statsCalculator.calculatePercentage(\n\t\t\tthis.currentSprint.getStoryPoints().getPoints(),\n\t\t\tthis.currentSprint.getCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\tlet differencePercentage = statsCalculator.calculatePercentage(\n\t\t\tthis.currentSprint.getStoryPoints().getPoints(),\n\t\t\tthis.currentSprint.getCompletedStoryPoints().getPoints()\n\t\t);\n\t\tif (this.lastCompletedSprint)\n\t\t{\n\t\t\tdifferencePercentage = this.getDifferencePercentageBetweenSprints(\n\t\t\t\tthis.currentSprint,\n\t\t\t\tthis.lastCompletedSprint\n\t\t\t);\n\t\t}\n\n\t\tconst percentageNodeClass = (differencePercentage > 0 ? '' : 'tasks-scrum-sprint-sidepanel-info-dif-min');\n\t\tconst absoluteValue = Math.abs(differencePercentage);\n\t\tconst speedInfoMessage = (differencePercentage > 0 ?\n\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED_UP').replace('#value#', absoluteValue) :\n\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED_DOWN').replace('#value#', absoluteValue)\n\t\t);\n\n\t\tconst renderSpeed = (speedInfoMessage) => {\n\t\t\treturn ''; //todo chart\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-speed\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-subtitle\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED')}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-result\">${speedInfoMessage}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-graph\"></div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_PLAN_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box tasks-scrum-sprint-sidepanel-info-box-w100\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_PLAN_DONE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t${percentage}%\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif ${percentageNodeClass}\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-arrow\"></span>\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-dif-block\">\n\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-val\">${absoluteValue}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-icon\">%</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${renderSpeed()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadCompletePanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\t\tconst itemsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-uncompleted-list');\n\n\t\t[...this.uncompletedItems.values()].map((previewItem: Item) => {\n\t\t\tpreviewItem.onAfterAppend(itemsContainer);\n\t\t\tpreviewItem.subscribe('showTask', () => {\n\t\t\t\tthis.currentSprint.emit('showTask', previewItem);\n\t\t\t});\n\t\t});\n\n\t\tthis.onLoadCompleteButtons().then((buttonsContainer: HTMLElement) => {\n\t\t\tEvent.bind(\n\t\t\t\tbuttonsContainer.querySelector('[name=save]'),\n\t\t\t\t'click',\n\t\t\t\tthis.onCompleteSprint.bind(this, sidePanel)\n\t\t\t);\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tonLoadSprintBurnDownPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\n\t\tthis.getBurnDownChartData().then((data) => {\n\n\t\t\tsidePanel.closeLoader();\n\t\t\t\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.burnDownChart = new BurnDownChart(data);\n\t\t\t\tthis.burnDownChart.createChart(this.form.querySelector('.tasks-scrum-sprint-sidepanel-chart'));\n\t\t\t}, 300);\n\n\t\t});\n\t}\n\n\tonCloseBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tif (this.sidePanelId === sidePanel.getUrl())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.burnDownChart)\n\t\t\t\t{\n\t\t\t\t\tthis.burnDownChart.destroyBurnDownChart();\n\t\t\t\t\tthis.burnDownChart = null;\n\t\t\t\t}\n\t\t\t}, 300);\n\t\t}\n\t}\n\n\tgetTasksCountLabel(count)\n\t{\n\t\tif (count > 5)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_3');\n\t\t}\n\t\telse if (count === 1)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_2');\n\t\t}\n\t}\n\n\tgetLastCompletedSprint(sprints: Map): Sprint\n\t{\n\t\treturn [...sprints.values()].find((sprint) => sprint.isCompleted() === true);\n\t}\n\n\tgetDifferenceStoryPointsBetweenSprints(firstSprint: Sprint, secondSprint: Sprint): string\n\t{\n\t\tlet difference = parseFloat(\n\t\t\tfirstSprint.getStoryPoints().getPoints() - secondSprint.getStoryPoints().getPoints()\n\t\t);\n\n\t\tif (Type.isFloat(difference))\n\t\t{\n\t\t\tdifference = difference.toFixed(1);\n\t\t}\n\n\t\tif (difference === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn (difference > 0 ? '+' + difference : difference);\n\t\t}\n\t}\n\n\tgetDifferencePercentageBetweenSprints(firstSprint: Sprint, secondSprint: Sprint): number\n\t{\n\t\tconst statsCalculator = new StatsCalculator();\n\n\t\tconst firstPercentage = statsCalculator.calculatePercentage(\n\t\t\tfirstSprint.getStoryPoints().getPoints(),\n\t\t\tfirstSprint.getCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\tconst secondPercentage = statsCalculator.calculatePercentage(\n\t\t\tsecondSprint.getStoryPoints().getPoints(),\n\t\t\tsecondSprint.getCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\treturn parseFloat(firstPercentage) - parseFloat(secondPercentage);\n\t}\n\n\tgetStartButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getSprintStartButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetCompleteButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getSprintCompleteButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetBurnDownChartData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getBurnDownChartData(this.getRequestDataToGetBurnDownChartData()).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t})\n\t\t});\n\t}\n\n\tonLoadStartButtons(): Promise\n\t{\n\t\treturn this.getStartButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadCompleteButtons(): Promise\n\t{\n\t\treturn this.getCompleteButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonStartSprint()\n\t{\n\t\tthis.requestSender.startSprint(this.getRequestDataToStartSprint()).then((response) => {\n\t\t\tthis.currentSprint.setStatus('active');\n\t\t\tlocation.href = this.views['activeSprint'].url;\n\t\t}).catch((response) => {\n\t\t\tthis.removeClockIconFromButton();\n\t\t\tthis.requestSender.showErrorAlert(response, Loc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP'));\n\t\t});\n\t}\n\n\tonCompleteSprint(sidePanel)\n\t{\n\t\tthis.requestSender.completeSprint(this.getRequestDataToCompleteSprint()).then((response) => {\n\t\t\tif (Confetti)\n\t\t\t{\n\t\t\t\tConfetti.fire({\n\t\t\t\t\tparticleCount: 400,\n\t\t\t\t\tspread: 80,\n\t\t\t\t\torigin: {\n\t\t\t\t\t\tx: 0.7,\n\t\t\t\t\t\ty: 0.2\n\t\t\t\t\t},\n\t\t\t\t\tzIndex: (sidePanel.getZindex() + 1)\n\t\t\t\t}).then(() => {\n\t\t\t\t\tlocation.href = this.views['plan'].url;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlocation.href = this.views['plan'].url;\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.removeClockIconFromButton();\n\t\t\tthis.requestSender.showErrorAlert(response, Loc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP'));\n\t\t});\n\t}\n\n\tgetRequestDataToStartSprint(): RequestDataToStartSprint\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\t\trequestData.sprintGoal = this.form.querySelector('textarea').value;\n\n\t\treturn requestData;\n\t}\n\n\tgetRequestDataToCompleteSprint(): RequestDataToCompleteSprint\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\t\tconst directionSelectNode = this.form.querySelector('select');\n\t\trequestData.direction = (directionSelectNode ? directionSelectNode.value : 'backlog');\n\n\t\treturn requestData;\n\t}\n\n\tgetRequestDataToGetBurnDownChartData(): RequestDataToGetBurnDownChartData\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\n\t\treturn requestData;\n\t}\n\n\tremoveClockIconFromButton()\n\t{\n\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\tif (buttonsContainer)\n\t\t{\n\t\t\tDom.removeClass(buttonsContainer.querySelector('[name=save]'), 'ui-btn-wait');\n\t\t}\n\t}\n}","import {Entity} from '../entity/entity';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage\n}\n\nexport class ItemStyleDesigner\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.listAllUsedColors = new Set();\n\n\t\tthis.updateBorderColorForLinkedItems();\n\t}\n\n\tupdateBorderColorForLinkedItems()\n\t{\n\t\tconst itemIdsToUpdateColor = new Set();\n\t\tthis.entityStorage.getAllItems().forEach((item: Item) => {\n\t\t\tif (item.isLinkedTask() && !item.getBorderColor())\n\t\t\t{\n\t\t\t\titemIdsToUpdateColor.add(item.getItemId());\n\t\t\t}\n\t\t});\n\n\t\tif (itemIdsToUpdateColor.size)\n\t\t{\n\t\t\tthis.getAllUsedColors().then(() => {\n\t\t\t\tconst items = new Map();\n\t\t\t\titemIdsToUpdateColor.forEach((itemId: number) => {\n\t\t\t\t\titems.set(itemId, this.getRandomColor(this.getAllColors()));\n\t\t\t\t});\n\t\t\t\tthis.requestSender.updateBorderColorToLinkedItems({\n\t\t\t\t\titems: Object.fromEntries(items)\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tconst updatedItems = response.data;\n\t\t\t\t\tObject.keys(updatedItems).forEach((itemId: number) => {\n\t\t\t\t\t\tconst borderColor = updatedItems[itemId];\n\t\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\t\titem.setBorderColor(borderColor);\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tgetRandomColorForItemBorder(): Promise\n\t{\n\t\treturn this.getAllUsedColors().then(() => {\n\t\t\treturn this.getRandomColor(this.getAllColors());\n\t\t});\n\t}\n\n\tgetAllColors(): Array\n\t{\n\t\tconst colorPicker = this.getColorPicker();\n\t\tlet allColors = [];\n\t\tcolorPicker.getDefaultColors().forEach((defaultColors) => {\n\t\t\tallColors = [...allColors, ...defaultColors];\n\t\t});\n\n\t\treturn allColors;\n\t}\n\n\tgetRandomColor(allColors: Array): string\n\t{\n\t\tconst randomColor = allColors[Math.floor(Math.random() * allColors.length)];\n\t\tif (this.isThisBorderColorAlreadyUse(randomColor))\n\t\t{\n\t\t\treturn this.getRandomColor(allColors);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn randomColor;\n\t\t}\n\t}\n\n\tisThisBorderColorAlreadyUse(color: string): boolean\n\t{\n\t\tlet isAlreadyUse = false;\n\n\t\tthis.listAllUsedColors.forEach((usedColor: string) => {\n\t\t\tif (usedColor === color)\n\t\t\t{\n\t\t\t\tisAlreadyUse = true;\n\t\t\t}\n\t\t});\n\n\t\treturn isAlreadyUse;\n\t}\n\n\tgetAllUsedColors(): Promise\n\t{\n\t\tconst entityIds = new Set();\n\t\tthis.entityStorage.getAllEntities().forEach((entity: Entity) => {\n\t\t\tif (!entity.isCompleted())\n\t\t\t{\n\t\t\t\tentityIds.add(entity.getId());\n\t\t\t}\n\t\t});\n\n\t\treturn this.requestSender.getAllUsedItemBorderColors({\n\t\t\tentityIds: [...entityIds.values()]\n\t\t}).then((response) => {\n\t\t\tthis.listAllUsedColors = new Set([response.data]);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tgetColorPicker()\n\t{\n\t\t/* eslint-disable */\n\t\treturn new BX.ColorPicker();\n\t\t/* eslint-enable */\n\t}\n}","import {Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {EventEmitter} from 'main.core.events';\nimport {Draggable} from 'ui.draganddrop.draggable';\n\nimport {Sprint} from '../entity/sprint/sprint';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tdefaultSprintDuration: number,\n\tpageNumberToCompletedSprints: number\n}\n\nexport class DomBuilder extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DomBuilder');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.defaultSprintDuration = params.defaultSprintDuration;\n\t\tthis.pageNumberToCompletedSprints = parseInt(params.pageNumberToCompletedSprints, 10);\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tthis.scrumContainer = container;\n\n\t\tthis.append(this.entityStorage.getBacklog().render(), this.scrumContainer);\n\t\tthis.entityStorage.getBacklog().onAfterAppend();\n\n\t\tthis.append(this.renderSprintsContainer(), this.scrumContainer);\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tsprint.onAfterAppend();\n\t\t});\n\n\t\tthis.sprintCreatingButtonNode = document.getElementById(this.sprintCreatingButtonNodeId);\n\t\tthis.sprintCreatingDropZoneNode = document.getElementById(this.sprintCreatingDropZoneNodeId);\n\t\tthis.sprintListNode = document.getElementById(this.sprintListNodeId);\n\n\t\tEvent.bind(this.sprintCreatingButtonNode, 'click', this.createSprint.bind(this));\n\n\t\tthis.setDraggable();\n\t}\n\n\tgetSprintCreatingDropZoneNode(): HTMLElement\n\t{\n\t\treturn this.sprintCreatingDropZoneNode;\n\t}\n\n\tgetSprintPlannedListNode(): HTMLElement\n\t{\n\t\treturn this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\t}\n\n\tsetDraggable()\n\t{\n\t\tconst itemContainers = [];\n\t\titemContainers.push(this.entityStorage.getBacklog().getListItemsNode());\n\t\tif (this.sprintCreatingDropZoneNode)\n\t\t{\n\t\t\titemContainers.push(this.sprintCreatingDropZoneNode);\n\t\t}\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (!sprint.isDisabled())\n\t\t\t{\n\t\t\t\titemContainers.push(sprint.getListItemsNode());\n\t\t\t}\n\t\t});\n\t\tthis.draggableItems = new Draggable({\n\t\t\tcontainer: itemContainers,\n\t\t\tdraggable: '.tasks-scrum-item-drag',\n\t\t\tdragElement: '.tasks-scrum-item',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t\tdelay: 260\n\t\t});\n\t\tthis.draggableItems.subscribe('start', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('itemMoveStart', dragEndEvent);\n\t\t\tthis.showDropZoneForSprintCreating(dragEndEvent);\n\t\t});\n\t\tthis.draggableItems.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('itemMoveEnd', dragEndEvent);\n\t\t\tthis.hideDropZoneForSprintCreating(dragEndEvent);\n\t\t});\n\n\t\tthis.draggableSprints = new Draggable({\n\t\t\tcontainer: this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list'),\n\t\t\tdraggable: '.tasks-scrum-sprint',\n\t\t\tdragElement: '.tasks-scrum-sprint-dragndrop',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t});\n\t\tthis.draggableSprints.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('sprintMove', dragEndEvent);\n\t\t});\n\t}\n\n\trenderSprintsContainer(): HTMLElement\n\t{\n\t\tconst createCreatingButton = () => {\n\t\t\tthis.sprintCreatingButtonNodeId = 'tasks-scrum-sprint-creating-button';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-sprint-create ui-btn ui-btn-md ui-btn-themes ui-btn-light-border ui-btn-icon-add\">\n\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD')}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createCreatingDropZone = () => {\n\t\t\tthis.sprintCreatingDropZoneNodeId = 'tasks-scrum-sprint-creating-drop-zone';\n\n\t\t\tconst className = this.entityStorage.getSprints().size\n\t\t\t\t? 'tasks-scrum-sprint-sprint-drop-hide'\n\t\t\t\t: 'tasks-scrum-sprint-sprint-drop'\n\t\t\t;\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingDropZoneNodeId}\" class=\"${className}\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-file-drop tasks-scrum-sprint-sprint-add-drop\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t<small>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_DROP')}</small>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createSprintsList = () => {\n\t\t\tthis.sprintListNodeId = 'tasks-scrum-sprint-list';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintListNodeId}\" class=\"tasks-scrum-sprint-list\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-active-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isActive())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-planned-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isPlanned())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-completed-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isCompleted())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-completed-loader\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst sprintsNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprints\">\n\t\t\t\t${createCreatingButton()}\n\t\t\t\t${createCreatingDropZone()}\n\t\t\t\t${createSprintsList()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.completedSprintLoader = sprintsNode.querySelector('.tasks-scrum-sprint-completed-loader');\n\t\tthis.bindLoadCompletedSprints(this.completedSprintLoader);\n\n\t\treturn sprintsNode;\n\t}\n\n\tshowDropZoneForSprintCreating(dragEndEvent)\n\t{\n\t\tif (this.isSprintSourceEntity(dragEndEvent))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dropZoneNode = this.getSprintCreatingDropZoneNode();\n\t\tif (!dropZoneNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdropZoneNode.className = 'tasks-scrum-sprint-sprint-drop';\n\t}\n\n\thideDropZoneForSprintCreating(dragEndEvent)\n\t{\n\t\tif (this.isSprintSourceEntity(dragEndEvent))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dropZoneNode = this.getSprintCreatingDropZoneNode();\n\t\tif (!dropZoneNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdropZoneNode.className = 'tasks-scrum-sprint-sprint-drop-hide';\n\t}\n\n\tisSprintSourceEntity(dragEndEvent)\n\t{\n\t\tif (dragEndEvent && dragEndEvent.sourceContainer)\n\t\t{\n\t\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\n\t\t\tif (sourceEntity && sourceEntity.getEntityType() === 'sprint')\n\t\t\t{\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tbindLoadCompletedSprints(loader: HTMLElement)\n\t{\n\t\tconst observer = new IntersectionObserver((entries) =>\n\t\t\t{\n\t\t\t\tif(entries[0].isIntersecting === true)\n\t\t\t\t{\n\t\t\t\t\tif (!this.isActiveLoadCompletedSprints)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onLoadCompletedSprints();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tthreshold: [0]\n\t\t\t}\n\t\t);\n\n\t\tobserver.observe(loader);\n\t}\n\n\tonLoadCompletedSprints()\n\t{\n\t\tthis.isActiveLoadCompletedSprints = true;\n\n\t\tconst loader = this.showLoader(this.completedSprintLoader);\n\n\t\tconst requestData = {\n\t\t\tpageNumber: this.pageNumberToCompletedSprints + 1\n\t\t};\n\n\t\tthis.requestSender.getCompletedSprints(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tconst data = response.data;\n\t\t\t\tif (Type.isArray(data) && data.length)\n\t\t\t\t{\n\t\t\t\t\tthis.pageNumberToCompletedSprints++;\n\t\t\t\t\tthis.isActiveLoadCompletedSprints = false;\n\n\t\t\t\t\tthis.createSprints(data);\n\t\t\t\t}\n\t\t\t\tloader.hide();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\tthis.isActiveLoadCompletedSprints = false;\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tcreateSprints(sprints: Array)\n\t{\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-completed-list');\n\n\t\tsprints.forEach((sprintData: SprintParams) => {\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tif (!this.entityStorage.findEntityByEntityId(sprint.getId()))\n\t\t\t{\n\t\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t\t\tthis.append(sprint.render(), sprintListNode);\n\t\t\t\tsprint.onAfterAppend();\n\t\t\t\tthis.emit('createSprint', sprint);\n\t\t\t}\n\t\t});\n\t}\n\n\tshowLoader(container: HTMLElement): Loader\n\t{\n\t\tconst listPosition = this.getPosition(container);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: container,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n\n\tcreateSprint(): Promise\n\t{\n\t\tthis.hideDropZoneForSprintCreating();\n\n\t\tconst countSprints = this.entityStorage.getSprints().size;\n\t\tconst title = Loc.getMessage('TASKS_SCRUM_SPRINT_NAME').replace('%s', countSprints + 1);\n\t\tconst storyPoints = 0;\n\t\tconst dateStart = Math.floor(Date.now() / 1000);\n\t\tconst dateEnd = (Math.floor(Date.now() / 1000) + parseInt(this.defaultSprintDuration, 10));\n\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\t\tconst sort = (sprintListNode.children.length ? sprintListNode.children.length + 1 : 1);\n\n\t\tconst sprint = Sprint.buildSprint({\n\t\t\tname: title,\n\t\t\tsort: sort,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd,\n\t\t\tstoryPoints: storyPoints\n\t\t});\n\t\tthis.append(sprint.render(), sprintListNode);\n\n\t\tconst requestData = {\n\t\t\ttmpId: Text.getRandom(),\n\t\t\tname: title,\n\t\t\tsort: sort,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd\n\t\t};\n\n\t\tthis.emit('beforeCreateSprint', requestData);\n\n\t\treturn this.requestSender.createSprint(requestData).then((response) => {\n\t\t\tsprint.setId(response.data.sprintId);\n\t\t\tsprint.onAfterAppend();\n\t\t\tsprint.getNode().scrollIntoView(true);\n\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\t\t\tthis.emit('createSprint', sprint);\n\t\t\treturn sprint;\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tcreateSprintNode(sprint: Sprint)\n\t{\n\t\tthis.remove(this.sprintCreatingDropZoneNode);\n\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\n\t\tthis.append(sprint.render(), sprintListNode);\n\n\t\tsprint.onAfterAppend();\n\n\t\tthis.entityStorage.addSprint(sprint);\n\n\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\n\t\tthis.emit('createSprintNode', sprint);\n\t}\n\n\tmoveSprintToActiveListNode(sprint: Sprint)\n\t{\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-active-list');\n\n\t\tthis.append(sprint.getNode(), sprintListNode);\n\t}\n\n\tmoveSprintToCompletedListNode(sprint: Sprint)\n\t{\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-completed-list');\n\n\t\tif (sprintListNode.firstElementChild)\n\t\t{\n\t\t\tthis.insertBefore(sprint.getNode(), sprintListNode.firstElementChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.append(sprint.getNode(), sprintListNode);\n\t\t}\n\t}\n\n\tappend(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tDom.append(current, target);\n\t}\n\n\tinsertBefore(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tDom.insertBefore(current, target);\n\t}\n\n\tremove(element: ?HTMLElement)\n\t{\n\t\tDom.remove(element);\n\t}\n\n\tgetPosition(element: HTMLElement): DOMRect\n\t{\n\t\treturn Dom.getPosition(element);\n\t}\n\n\tappendItemAfterItem(newItemNode: HTMLElement, bindItemNode: HTMLElement)\n\t{\n\t\tif (bindItemNode.nextElementSibling)\n\t\t{\n\t\t\tDom.insertBefore(newItemNode, bindItemNode.nextElementSibling);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newItemNode, bindItemNode.parentElement);\n\t\t}\n\t}\n}","import {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\n\nimport type {ItemParams} from '../item/item';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder\n}\n\nexport class SubTasksManager\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\n\t\tthis.listSubTasks = new Map();\n\t\tthis.visibilityList = new Set();\n\t}\n\n\ttoggleSubTasks(sprint: Sprint, item: Item): Promise\n\t{\n\t\tif (this.listSubTasks.has(item.getItemId()))\n\t\t{\n\t\t\tif (this.isShown(item))\n\t\t\t{\n\t\t\t\tthis.hideSubTaskItems(sprint, item);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showSubTaskItems(sprint, item);\n\t\t\t}\n\n\t\t\titem.toggleSubTasksTick();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.requestSender.getSubTaskItems({\n\t\t\t\tentityId: sprint.getId(),\n\t\t\t\ttaskId: item.getSourceId()\n\t\t\t}).then((response) => {\n\t\t\t\tconst listItemParams = response.data;\n\t\t\t\tconst listSubTaskItems = new Map();\n\t\t\t\tlistItemParams.forEach((itemParams: ItemParams) => {\n\t\t\t\t\tconst subTaskItem = this.buildSubTaskItem(itemParams);\n\t\t\t\t\tlistSubTaskItems.set(subTaskItem.getItemId(), subTaskItem);\n\t\t\t\t});\n\t\t\t\tthis.listSubTasks.set(item.getItemId(), listSubTaskItems);\n\t\t\t\tif (this.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tthis.hideSubTaskItems(sprint, item);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showSubTaskItems(sprint, item);\n\t\t\t\t}\n\t\t\t\titem.toggleSubTasksTick();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t}\n\t}\n\n\tbuildSubTaskItem(itemParams: ItemParams): Item\n\t{\n\t\treturn new Item(itemParams);\n\t}\n\n\tshowSubTaskItems(sprint: Sprint, parentItem: Item)\n\t{\n\t\tconst parentItemNode = parentItem.getItemNode();\n\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\tif (!listSubTasks)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlistSubTasks.forEach((subTaskItem: Item) => {\n\t\t\tsprint.setItem(subTaskItem);\n\t\t\tthis.domBuilder.appendItemAfterItem(subTaskItem.render(), parentItemNode);\n\t\t\tsubTaskItem.onAfterAppend(sprint.getListItemsNode());\n\t\t});\n\n\t\tthis.setVisibility(parentItem);\n\t}\n\n\thideSubTaskItems(sprint: Sprint, parentItem: Item)\n\t{\n\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\tif (!listSubTasks)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlistSubTasks.forEach((subTaskItem: Item) => {\n\t\t\tif (subTaskItem.isParentTask())\n\t\t\t{\n\t\t\t\tthis.hideSubTaskItems(sprint, subTaskItem);\n\t\t\t}\n\t\t\tsprint.removeItem(subTaskItem);\n\t\t\tsubTaskItem.removeYourself();\n\t\t});\n\n\t\tthis.cleanVisibility(parentItem);\n\t}\n\n\taddSubTask(parentItem: Item, item: Item)\n\t{\n\t\tif (this.listSubTasks.has(parentItem.getItemId()))\n\t\t{\n\t\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\t\tlistSubTasks.set(item.getItemId(), item);\n\t\t\tthis.listSubTasks.set(parentItem.getItemId(), listSubTasks);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst listSubTasks = new Map();\n\t\t\tlistSubTasks.set(item.getItemId(), item);\n\t\t\treturn this.listSubTasks.set(parentItem.getItemId(), listSubTasks);\n\t\t}\n\t}\n\n\tgetSubTasks(parentItem: Item): Map<number, Item>\n\t{\n\t\treturn this.listSubTasks.get(parentItem.getItemId());\n\t}\n\n\tisShown(item: Item)\n\t{\n\t\treturn this.visibilityList.has(item.getItemId());\n\t}\n\n\tsetVisibility(item: Item)\n\t{\n\t\tthis.visibilityList.add(item.getItemId());\n\t}\n\n\tcleanVisibility(item: Item)\n\t{\n\t\tthis.visibilityList.delete(item.getItemId());\n\t}\n\n\tcleanSubTasks(item: Item)\n\t{\n\t\tthis.listSubTasks.delete(item.getItemId());\n\t}\n}","import {Tag, Dom, Loc, Event, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Entity} from '../../entity/entity';\nimport {Responsible, Item} from '../item';\n\nimport {ItemStyleDesigner} from '../../utility/item.style.designer';\nimport {SubTasksManager} from '../../utility/subtasks.manager';\nimport {Input} from '../../utility/input';\n\nimport '../../css/decomposition.css';\n\ntype Params = {\n\tentity: Entity,\n\titemStyleDesigner: ItemStyleDesigner,\n\tsubTasksCreator: SubTasksManager\n}\n\nexport class Decomposition extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.entity = params.entity;\n\t\tthis.itemStyleDesigner = params.itemStyleDesigner;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Decomposition');\n\n\t\tthis.items = new Set();\n\n\t\tthis.input = new Input();\n\t\tthis.input.setPlaceholder(Loc.getMessage('TASKS_SCRUM_TASK_ADD_DECOMPOSITION_INPUT_PLACEHOLDER'));\n\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t}\n\n\tdecomposeItem(item: Item)\n\t{\n\t\tthis.addDecomposedItem(item);\n\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tthis.onDecomposeItem(item, item.getItemNode());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!this.subTasksCreator.isShown(item))\n\t\t\t{\n\t\t\t\tthis.subTasksCreator.toggleSubTasks(this.entity, item).then(() => {\n\t\t\t\t\tconst lastSubTask = this.getSubTasks(item)[0];\n\t\t\t\t\tconst targetItemNode = (lastSubTask ? lastSubTask.getItemNode() : item.getItemNode());\n\t\t\t\t\tthis.onDecomposeItem(item, targetItemNode);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst lastSubTask = this.getSubTasks(item)[0];\n\t\t\t\tthis.onDecomposeItem(item, lastSubTask.getItemNode());\n\t\t\t}\n\t\t}\n\t}\n\n\tonDecomposeItem(item: Item, targetItemNode)\n\t{\n\t\tDom.insertAfter(this.input.render(), targetItemNode);\n\t\tthis.input.setNode();\n\n\t\tconst inputNode = this.input.getInputNode();\n\t\tEvent.bind(inputNode, 'input', this.input.onTagSearch.bind(this.input));\n\t\tEvent.bind(inputNode, 'keydown', this.onCreateItem.bind(this));\n\t\tinputNode.focus();\n\n\t\tconst button = this.createButton();\n\t\tDom.insertAfter(button, this.input.getNode());\n\n\t\tEvent.bind(button.querySelector('button'), 'click', () => {\n\t\t\tif (this.isBacklogDecomposition() && this.isFirstDecomposition() && !item.isLinkedTask())\n\t\t\t{\n\t\t\t\titem.setBorderColor();\n\t\t\t}\n\t\t\tif (!this.isBacklogDecomposition())\n\t\t\t{\n\t\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tthis.subTasksCreator.hideSubTaskItems(this.entity, item);\n\t\t\t\t}\n\t\t\t\tthis.subTasksCreator.cleanSubTasks(item);\n\t\t\t}\n\t\t\tthis.deactivateDecompositionMode();\n\t\t\tthis.input.removeYourself()\n\t\t\tDom.remove(button);\n\t\t});\n\n\t\tthis.setResponsible(item.getResponsible());\n\t}\n\n\tgetSubTasks(parentItem: Item): Array\n\t{\n\t\treturn Array.from(this.subTasksCreator.getSubTasks(parentItem).values());\n\t}\n\n\tgetLastDecomposedItemNode(parentItem: Item): HTMLElement\n\t{\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tconst decomposedItems = this.getDecomposedItems();\n\t\t\tconst lastDecomposedItem = Array.from(decomposedItems).pop();\n\n\t\t\treturn lastDecomposedItem.getItemNode();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst subTasks = this.getSubTasks(parentItem);\n\t\t\tif (subTasks.length)\n\t\t\t{\n\t\t\t\tconst lastSubTask = (this.isFirstDecomposition() ? subTasks[0] : subTasks.pop());\n\n\t\t\t\treturn lastSubTask.getItemNode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn parentItem.getItemNode();\n\t\t\t}\n\t\t}\n\t}\n\n\tisBacklogDecomposition(): boolean\n\t{\n\t\treturn this.entity.getEntityType() === 'backlog';\n\t}\n\n\taddDecomposedItem(item: Item)\n\t{\n\t\tthis.activateDecompositionMode(item);\n\n\t\titem.subscribe('changeTaskResponsible', this.saveSelectedResponsible.bind(this));\n\n\t\tthis.items.add(item);\n\t}\n\n\tgetDecomposedItems(): Set\n\t{\n\t\treturn this.items;\n\t}\n\n\tactivateDecompositionMode(item: Item)\n\t{\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tthis.itemStyleDesigner.getRandomColorForItemBorder().then((randomColor: string) => {\n\t\t\t\titem.activateDecompositionMode(randomColor);\n\t\t\t\tthis.setBorderColor(item.getBorderColor());\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\titem.activateDecompositionMode();\n\t\t}\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.items.forEach((item) => {\n\t\t\titem.deactivateDecompositionMode();\n\t\t});\n\t\tthis.items.clear();\n\t}\n\n\tcreateButton(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-decomposition-structure\">\n\t\t\t\t<button class=\"ui-btn ui-btn-sm ui-btn-primary\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DECOMPOSITION_BUTTON')}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonCreateItem(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tif (!this.input.isTagsSearchMode())\n\t\t\t{\n\t\t\t\tconst inputNode = event.target;\n\t\t\t\tif (inputNode.value)\n\t\t\t\t{\n\t\t\t\t\tconst parentItem = this.getParentItem();\n\t\t\t\t\tif (this.isBacklogDecomposition())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isFirstDecomposition() && !parentItem.isLinkedTask())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('updateParentItem', {\n\t\t\t\t\t\t\t\titemId: parentItem.getItemId(),\n\t\t\t\t\t\t\t\tentityId: parentItem.getEntityId(),\n\t\t\t\t\t\t\t\titemType: parentItem.getItemType(),\n\t\t\t\t\t\t\t\tinfo: parentItem.getInfo()\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.emit('createItem', inputNode.value);\n\t\t\t\t\tinputNode.value = '';\n\t\t\t\t\tinputNode.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisFirstDecomposition(): boolean\n\t{\n\t\treturn (this.items.size === 1);\n\t}\n\n\tgetParentItem(): Item\n\t{\n\t\tconst iterator = this.items.values();\n\t\treturn iterator.next().value;\n\t}\n\n\tsaveSelectedResponsible(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getTarget();\n\t\tthis.setResponsible(item.getResponsible());\n\t}\n\n\tgetResponsible(): Responsible\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tsetResponsible(responsible: Responsible)\n\t{\n\t\tthis.responsible = responsible;\n\t}\n\n\tsetBorderColor(color: string)\n\t{\n\t\tthis.borderColor = (Type.isString(color) ? color : '');\n\t}\n\n\tgetBorderColor(): string\n\t{\n\t\treturn this.borderColor;\n\t}\n}","import {Text, Type} from 'main.core';\n\nexport type ItemTypeParams = {\n\tid?: number|string,\n\tname?: string,\n\tsort?: number,\n\tdodRequired?: 'Y' | 'N'\n}\n\nexport class ItemType\n{\n\tconstructor(params: ItemTypeParams = {})\n\t{\n\t\tthis.setId(params.id);\n\t\tthis.setName(params.name);\n\t\tthis.setSort(params.sort);\n\t\tthis.setDodRequired(params.dodRequired);\n\t}\n\n\tsetId(id: number)\n\t{\n\t\tthis.id = (\n\t\t\tType.isInteger(id)\n\t\t\t\t? parseInt(id, 10)\n\t\t\t\t: (Type.isString(id) && id) ? id : Text.getRandom()\n\t\t);\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetName(name: string)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : '');\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetSort(sort: number)\n\t{\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\t}\n\n\tgetSort(): number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetDodRequired(value: string)\n\t{\n\t\tthis.dodRequired = (value === 'Y');\n\t}\n\n\tisDodRequired(): boolean\n\t{\n\t\treturn this.dodRequired;\n\t}\n}","import {ItemType} from './item.type';\n\ntype Params = {\n\ttypes: Map<number, ItemType>\n}\n\nexport class TypeStorage\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.types = params.types;\n\t}\n\n\tgetNextType(): ItemType\n\t{\n\t\treturn this.types.values().next().value;\n\t}\n\n\tgetTypes(): Map<number, ItemType>\n\t{\n\t\treturn this.types;\n\t}\n\n\taddType(type: ItemType)\n\t{\n\t\tthis.types.set(type.getId(), type);\n\t}\n\n\tremoveType(type: ItemType)\n\t{\n\t\tthis.types.delete(type.getId());\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nimport {ItemType} from './item.type';\nimport {TypeStorage} from './type.storage';\n\ntype Params = {\n\ttypeStorage: TypeStorage\n}\n\nexport class Tabs extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Dod.Tabs');\n\n\t\tthis.typeStorage = params.typeStorage;\n\n\t\tthis.tabNodes = new Map();\n\n\t\tthis.activeType = null;\n\t\tthis.previousType = null;\n\n\t\tthis.setActiveType(this.typeStorage.getNextType());\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst sidebarClass = 'tasks-scrum-dod-settings-container-sidebar'\n\t\t\t+ ' tasks-scrum-dod-settings-container-sidebar-settings';\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"${sidebarClass}\">\n\t\t\t\t${[...this.typeStorage.getTypes().values()].map((type: ItemType) => this.renderTab(type))}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.tabNodes.size === 0;\n\t}\n\n\trenderTab(type: ItemType): HTMLElement\n\t{\n\t\tif (this.isEmptyType(type))\n\t\t{\n\t\t\tconst addNode = Tag.render`\n\t\t\t\t<div class=\"sidebar-tab-link\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-name\">\n\t\t\t\t\t\t+ ${Loc.getMessage('TASKS_SCRUM_CREATE_TYPE')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(addNode, 'click', this.createType.bind(this));\n\n\t\t\treturn addNode;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst tabClass = this.isActiveType(type) ? 'sidebar-tab sidebar-tab-active' : 'sidebar-tab';\n\n\t\t\tconst tabNode = Tag.render`\n\t\t\t\t<div class=\"${tabClass}\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-name\">\n\t\t\t\t\t\t${Text.encode(type.getName())}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-edit\"></div>\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-remove\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.tabNodes.set(type.getId(), tabNode);\n\n\t\t\tEvent.bind(tabNode, 'click', (event) => {\n\t\t\t\tconst edit = event.target.classList.contains('tasks-scrum-dod-settings-type-edit');\n\t\t\t\tconst remove = event.target.classList.contains('tasks-scrum-dod-settings-type-remove');\n\t\t\t\tif (!this.isActiveType(type))\n\t\t\t\t{\n\t\t\t\t\tthis.switchType(type, tabNode);\n\t\t\t\t}\n\t\t\t\tif (edit)\n\t\t\t\t{\n\t\t\t\t\tthis.changeTypeName(type, tabNode);\n\t\t\t\t}\n\t\t\t\tif (remove)\n\t\t\t\t{\n\t\t\t\t\tthis.removeType(type, tabNode);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn tabNode;\n\t\t}\n\t}\n\n\taddType(newType: ItemType, tmpType?: ItemType)\n\t{\n\t\tif (tmpType)\n\t\t{\n\t\t\tDom.remove(this.tabNodes.get(tmpType.getId()));\n\t\t\tthis.tabNodes.delete(tmpType.getId());\n\t\t}\n\n\t\tconst node = this.renderTab(newType);\n\n\t\tDom.insertBefore(node, this.node.lastElementChild);\n\n\t\tthis.switchType(newType, node);\n\t}\n\n\tswitchType(type: ItemType, typeNode: HTMLElement, savePrevious: boolean = true)\n\t{\n\t\tthis.tabNodes.forEach((node: HTMLElement) => {\n\t\t\tDom.removeClass(node, 'sidebar-tab-active');\n\t\t});\n\n\t\tDom.addClass(typeNode, 'sidebar-tab-active');\n\n\t\tif (savePrevious && !this.isEmpty())\n\t\t{\n\t\t\tthis.setPreviousType(this.getActiveType());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.setPreviousType(null);\n\t\t}\n\n\t\tthis.setActiveType(type);\n\n\t\tthis.emit('switchType', type);\n\t}\n\n\tcreateType()\n\t{\n\t\tconst type = new ItemType();\n\t\ttype.setSort(this.typeStorage.getTypes().size);\n\n\t\tthis.tabNodes.forEach((node: HTMLElement) => {\n\t\t\tDom.removeClass(node, 'sidebar-tab-active');\n\t\t});\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"sidebar-tab sidebar-tab-active\">\n\t\t\t\t<input type=\"text\" class=\"tasks-scrum-dod-settings-type-name-input\">\n\t\t\t</div>\n\t\t`;\n\t\tconst nameNode = Tag.render`<div class=\"tasks-scrum-dod-settings-type-name\"></div>`;\n\n\t\tDom.insertBefore(node, this.node.lastElementChild);\n\n\t\tconst input = node.querySelector('input');\n\n\t\tEvent.bind(input, 'change', (event) => {\n\t\t\ttype.setName(event.target['value']);\n\t\t\tthis.emit('createType', type);\n\t\t\tnameNode.textContent = Text.encode(type.getName());\n\t\t\tDom.replace(input, nameNode);\n\t\t}, true);\n\n\t\tEvent.bind(input, 'blur', (event) => {\n\t\t\tif (event.target['value'].trim() === '')\n\t\t\t{\n\t\t\t\tDom.remove(node);\n\t\t\t}\n\t\t}, true);\n\n\t\tEvent.bind(input, 'keydown', (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t{\n\t\t\t\tinput.blur();\n\t\t\t}\n\t\t});\n\n\t\tinput.focus();\n\n\t\tthis.tabNodes.set(type.getId(), node);\n\t}\n\n\tchangeTypeName(type: ItemType, typeNode: HTMLElement)\n\t{\n\t\tconst inputNode = Tag.render`\n\t\t\t<input type=\"text\" class=\"tasks-scrum-dod-settings-type-name-input\" value=\"${Text.encode(type.getName())}\">\n\t\t`;\n\t\tconst nameNode = typeNode.querySelector('.tasks-scrum-dod-settings-type-name');\n\n\t\tEvent.bind(inputNode, 'change', (event) => {\n\t\t\ttype.setName(event.target['value'])\n\t\t\tthis.emit('changeTypeName', type);\n\t\t\tinputNode.blur();\n\t\t}, true);\n\n\t\tEvent.bind(inputNode, 'blur', () => {\n\t\t\tnameNode.textContent = Text.encode(type.getName());\n\t\t\tDom.replace(inputNode, nameNode);\n\t\t}, true);\n\n\t\tEvent.bind(inputNode, 'keydown', (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t{\n\t\t\t\tinputNode.blur();\n\t\t\t}\n\t\t});\n\n\t\tDom.replace(nameNode, inputNode);\n\n\t\tinputNode.focus();\n\t\tinputNode.setSelectionRange(type.getName().length, type.getName().length);\n\t}\n\n\tremoveType(type: ItemType, typeNode: HTMLElement)\n\t{\n\t\tMessageBox.confirm(\n\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TYPE'),\n\t\t\t(messageBox) => {\n\t\t\t\tthis.tabNodes.delete(type.getId());\n\t\t\t\tif (this.isActiveType(type))\n\t\t\t\t{\n\t\t\t\t\tthis.setActiveType(null);\n\t\t\t\t}\n\t\t\t\tthis.setPreviousType(null);\n\t\t\t\tDom.remove(typeNode);\n\t\t\t\tthis.emit('removeType', type);\n\t\t\t\tmessageBox.close();\n\t\t\t},\n\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t);\n\t}\n\n\tsetActiveType(type: ItemType|null)\n\t{\n\t\tthis.activeType = type;\n\t}\n\n\tgetActiveType(): ItemType|null\n\t{\n\t\treturn this.activeType;\n\t}\n\n\tsetPreviousType(type: ItemType|null)\n\t{\n\t\tthis.previousType = type;\n\t}\n\n\tgetPreviousType(): ItemType|null\n\t{\n\t\treturn this.previousType;\n\t}\n\n\tisActiveType(type: ItemType): boolean\n\t{\n\t\treturn (\n\t\t\tthis.activeType\n\t\t\t&& this.activeType.getId() === type.getId()\n\t\t);\n\t}\n\n\tsetEmptyType(type: ItemType)\n\t{\n\t\tthis.emptyType = type;\n\t}\n\n\tisEmptyType(type: ItemType): boolean\n\t{\n\t\treturn type.getId() === this.emptyType.getId();\n\t}\n\n\tswitchToType(type: ItemType)\n\t{\n\t\tthis.switchType(type, this.tabNodes.get(type.getId()), false);\n\t}\n}","import {Dom, Tag, Type, Loc, Runtime, Event} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {ItemType} from './item.type';\nimport {TypeStorage} from './type.storage';\nimport {Tabs} from './tabs';\n\nimport {RequestSender} from '../utility/request.sender';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityId: number,\n\ttypes: Map<number, ItemType>\n}\n\nimport '../css/dod.css';\n\nexport class Settings\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityId = params.entityId;\n\t\tthis.types = params.types;\n\n\t\tthis.typeStorage = new TypeStorage({\n\t\t\ttypes: this.types\n\t\t});\n\n\t\tthis.tabs = new Tabs({\n\t\t\ttypeStorage: this.typeStorage\n\t\t});\n\t\tthis.tabs.subscribe('switchType', this.onSwitchType.bind(this));\n\t\tthis.tabs.subscribe('createType', this.onCreateType.bind(this));\n\t\tthis.tabs.subscribe('changeTypeName', this.onChangeTypeName.bind(this));\n\t\tthis.tabs.subscribe('removeType', this.onRemoveType.bind(this));\n\n\t\tthis.addEmptyCreationType();\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('DoD Settings: HTMLElement for dod settings not found');\n\t\t}\n\n\t\tDom.append(this.render(), container);\n\n\t\tif (this.tabs.isEmpty())\n\t\t{\n\t\t\tthis.buildEmptyForm();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buildEditingForm(this.typeStorage.getNextType());\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-dod-settings\">\n\t\t\t\t<div class=\"tasks-scrum-dod-settings-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-wrap\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-shell\">\n\t\t\t\t\t\t\t${this.tabs.render()}\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-sidebar-wrapper\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\trenderEditingForm(type: ItemType): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t${this.renderRequiredOption(type)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content ui-form-content-dod-list\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEmptyForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_CREATE_TYPE_PROMPT')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderRequiredOption(type: ItemType): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox\">\n\t\t\t\t\t<input type=\"checkbox\" class=\"ui-ctl-element ui-form-content-required-option\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_OPTIONS_REQUIRED_LABEL')}\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst checkbox = node.querySelector('.ui-form-content-required-option');\n\t\tcheckbox.checked = type.isDodRequired();\n\n\t\tEvent.bind(checkbox, 'click', () => {\n\t\t\tthis.updateActiveType();\n\t\t});\n\n\t\treturn node;\n\t}\n\n\tbuildEditingForm(type: ItemType)\n\t{\n\t\tconst container =this.cleanTypeForm();\n\n\t\tDom.append(this.renderEditingForm(type), container);\n\n\t\tconst listContainer = this.node.querySelector('.ui-form-content-dod-list');\n\n\t\tconst loader = this.showLoader(listContainer);\n\n\t\tthis.requestSender.getDodChecklist({\n\t\t\tentityId: type.getId()\n\t\t})\n\t\t.then((response) => {\n\t\t\tloader.hide();\n\t\t\tRuntime.html(listContainer, response.data.html);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tbuildEmptyForm()\n\t{\n\t\tconst container = this.cleanTypeForm();\n\n\t\tDom.append(this.renderEmptyForm(), container);\n\t}\n\n\tonSwitchType(baseEvent: BaseEvent)\n\t{\n\t\tconst type = baseEvent.getData();\n\t\tconst previousType = this.tabs.getPreviousType();\n\n\t\tif (previousType)\n\t\t{\n\t\t\tthis.saveSettings(previousType)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.buildEditingForm(type);\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buildEditingForm(type);\n\t\t}\n\t}\n\n\tonCreateType(baseEvent: BaseEvent)\n\t{\n\t\tconst container = this.node.querySelector('.tasks-scrum-dod-settings-container-sidebar-wrapper');\n\n\t\tconst loader = this.showLoader(container);\n\n\t\tconst tmpType = baseEvent.getData();\n\n\t\tthis.requestSender.createType({\n\t\t\tentityId: this.entityId,\n\t\t\tname: tmpType.getName(),\n\t\t\tsort: tmpType.getSort()\n\t\t})\n\t\t.then((response) => {\n\t\t\tloader.hide();\n\t\t\tconst createdType = new ItemType(response.data);\n\t\t\tthis.typeStorage.addType(createdType);\n\t\t\tthis.tabs.addType(createdType, tmpType);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeTypeName(baseEvent: BaseEvent)\n\t{\n\t\tconst type = baseEvent.getData();\n\n\t\tthis.requestSender.changeTypeName({\n\t\t\tid: type.getId(),\n\t\t\tname: type.getName()\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonRemoveType(baseEvent: BaseEvent)\n\t{\n\t\tconst type = baseEvent.getData();\n\n\t\tthis.requestSender.removeType({\n\t\t\tid: type.getId()\n\t\t})\n\t\t.then(() => {\n\t\t\tthis.typeStorage.removeType(type);\n\t\t\tif (this.tabs.isEmpty())\n\t\t\t{\n\t\t\t\tthis.buildEmptyForm();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst nextType = [...this.typeStorage.getTypes().values()]\n\t\t\t\t\t.find((type: ItemType) => !this.tabs.isEmptyType(type))\n\t\t\t\t;\n\t\t\t\tthis.tabs.switchToType(nextType);\n\t\t\t}\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tsaveSettings(inputType?: ItemType): Promise\n\t{\n\t\tif (this.tabs.isEmpty())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst type = inputType? inputType : this.tabs.getActiveType();\n\n\t\tif (!(type instanceof ItemType))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn this.requestSender.saveDodSettings({\n\t\t\tentityId: type.getId(),\n\t\t\trequiredOption: this.getRequiredOptionValue(),\n\t\t\titems: this.getChecklistItems()\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tgetChecklistItems(): Array\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst treeStructure = BX.Tasks.CheckListInstance.getTreeStructure();\n\n\t\treturn treeStructure.getRequestData();\n\t\t/* eslint-enable */\n\t}\n\n\tgetRequiredOptionValue(): string\n\t{\n\t\tconst requiredOption = this.node.querySelector('.ui-form-content-required-option');\n\n\t\treturn (requiredOption.checked === true ? 'Y' : 'N');\n\t}\n\n\tshowLoader(container: HTMLElement): Loader\n\t{\n\t\tconst listPosition = Dom.getPosition(container);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: container,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n\n\tupdateActiveType()\n\t{\n\t\tconst type = this.tabs.getActiveType();\n\n\t\ttype.setDodRequired(this.getRequiredOptionValue());\n\t}\n\n\tcleanTypeForm(): HTMLElement\n\t{\n\t\tconst container = this.node.querySelector('.tasks-scrum-dod-settings-container-sidebar-wrapper');\n\n\t\tDom.clean(container);\n\n\t\treturn container;\n\t}\n\n\taddEmptyCreationType()\n\t{\n\t\tconst itemType = new ItemType();\n\n\t\tthis.tabs.setEmptyType(itemType);\n\n\t\tthis.typeStorage.addType(itemType);\n\t}\n}","import {Event, Loc, Runtime, Tag, Type, Dom} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {Settings} from './settings';\nimport {Entity} from '../entity/entity';\nimport {ItemType, ItemTypeParams} from './item.type';\n\nimport {RequestSender} from '../utility/request.sender';\n\ntype Params = {\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender\n};\n\nimport '../css/dod.css';\n\nexport class DodSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t}\n\n\tshowSettingsPanel(entity: Entity)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-dod-side-panel';\n\n\t\tthis.entity = entity;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadSettingsPanel.bind(this));\n\t\tthis.sidePanel.subscribeOnce('onCloseSidePanel', this.onCloseSettingsPanel.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildSettingsPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildSettingsPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-dod-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum-dod-side-panel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-dod-side-panel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-dod-side-panel-container\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadSettingsPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tconst container = sidePanel.getContainer().querySelector('.tasks-scrum-dod-side-panel-container');\n\n\t\tconst dodSettingsRequest = {\n\t\t\tentityId: this.entity.getId()\n\t\t};\n\n\t\tthis.requestSender.getDodSettings(dodSettingsRequest)\n\t\t\t.then((response) => {\n\n\t\t\t\tsidePanel.closeLoader();\n\n\t\t\t\tconst types = Type.isArray(response.data.types) ? response.data.types : [];\n\n\t\t\t\tconst itemTypes = new Map();\n\n\t\t\t\ttypes.forEach((typeData: ItemTypeParams) => {\n\t\t\t\t\tconst itemType = new ItemType(typeData);\n\t\t\t\t\titemTypes.set(itemType.getId(), itemType);\n\t\t\t\t});\n\n\t\t\t\tthis.settings = new Settings({\n\t\t\t\t\trequestSender: this.requestSender,\n\t\t\t\t\tentityId: this.entity.getId(),\n\t\t\t\t\ttypes: itemTypes\n\t\t\t\t});\n\n\t\t\t\tthis.settings.renderTo(container);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\t}\n\n\tonCloseSettingsPanel(baseEvent: BaseEvent)\n\t{\n\t\tif (this.settings)\n\t\t{\n\t\t\tthis.settings.saveSettings()\n\t\t\t\t.then(() => {})\n\t\t\t\t.catch(() => {})\n\t\t\t;\n\t\t}\n\t}\n}","import {Loc} from 'main.core';\n\ntype Data = {\n\tsprintName: string,\n\tplan: number,\n\tdone: number\n}\n\n//todo import amchart4 like es6\nexport class Chart\n{\n\tconstructor(data: Data)\n\t{\n\t\tthis.data = data;\n\n\t\tthis.chart = null;\n\t}\n\n\tcreateChart(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\n\t\tthis.chart.scrollbarX = new am4core.Scrollbar();\n\t\tthis.chart.scrollbarX.parent = this.chart.bottomAxesContainer;\n\n\t\tthis.createAxises();\n\n\t\tthis.createColumn('plan', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_PLAN_COLUMN'), '#2882b3');\n\t\tthis.createColumn('done', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_DONE_COLUMN'), '#9c1f1f');\n\n\t\tthis.createLegend();\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst xAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\txAxis.dataFields.category = 'sprintName';\n\t\txAxis.renderer.grid.template.location = 0;\n\n\t\tconst label = xAxis.renderer.labels.template;\n\t\tlabel.wrap = true;\n\t\tlabel.maxWidth = 120;\n\n\t\tconst yAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tyAxis.min = 0;\n\t}\n\n\tcreateColumn(valueY: string, name: string, color: string)\n\t{\n\t\tconst series = this.chart.series.push(new am4charts.ColumnSeries());\n\t\tseries.dataFields.valueY = valueY;\n\t\tseries.dataFields.categoryX = 'sprintName';\n\t\tseries.name = name;\n\t\tseries.stroke = am4core.color(color);\n\t\tseries.fill = am4core.color(color);\n\n\t\t// const bullet = series.bullets.push(new am4charts.LabelBullet())\n\t\t// bullet.dy = 10;\n\t\t// bullet.label.text = '{valueY}';\n\t\t// bullet.label.fill = am4core.color('#ffffff');\n\n\t\treturn series;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.paddingBottom = 20;\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t}\n\n\tdestroyChart()\n\t{\n\t\tthis.chart.dispose();\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {SidePanel} from '../service/side.panel';\nimport {RequestSender} from '../utility/request.sender';\nimport {Chart} from './chart';\n\ntype Params = {\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender\n};\n\nexport class TeamSpeedSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t}\n\n\tshowTeamSpeedChart()\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-team-speed-chart';\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadTeamSpeedChartPanel.bind(this));\n\n\t\tthis.sidePanel.subscribe('onCloseSidePanel', this.onCloseTeamSpeedChart.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildTeamSpeedPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildTeamSpeedPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-project-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-project-side-panel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-chart\"></div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadTeamSpeedChartPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-project-side-panel');\n\n\t\tthis.getTeamSpeedChartData().then((data) => {\n\n\t\t\tsidePanel.closeLoader();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.teamSpeedChart = new Chart(data);\n\t\t\t\tthis.teamSpeedChart.createChart(this.form.querySelector('.tasks-scrum-project-side-panel-chart'));\n\t\t\t}, 300);\n\n\t\t});\n\t}\n\n\tonCloseTeamSpeedChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tif (this.sidePanelId === sidePanel.getUrl())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.teamSpeedChart)\n\t\t\t\t{\n\t\t\t\t\tthis.teamSpeedChart.destroyChart();\n\t\t\t\t\tthis.teamSpeedChart = null;\n\t\t\t\t}\n\t\t\t}, 300);\n\t\t}\n\t}\n\n\tgetTeamSpeedChartData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getTeamSpeedChartData().then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t});\n\t\t});\n\t}\n}","import {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage\n}\n\nexport class EntityCounters\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t}\n\n\tupdateCounters(entities: Map<number, Backlog|Sprint>)\n\t{\n\t\tconst requestData = {\n\t\t\tentityIds: [...entities.keys()]\n\t\t};\n\n\t\tthis.requestSender.getEntityCounters(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tObject.keys(response.data).forEach((entityId: number) => {\n\t\t\t\t\tentityId = parseInt(entityId, 10);\n\t\t\t\t\tconst entity = entities.get(entityId);\n\t\t\t\t\tconst counters = response.data[entityId];\n\t\t\t\t\tentity.setStoryPoints(counters.storyPoints);\n\t\t\t\t\tentity.setNumberTasks(counters.numberTasks);\n\t\t\t\t\tif (entity.isActive())\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.setCompletedStoryPoints(counters.completedStoryPoints);\n\t\t\t\t\t\tentity.setUncompletedStoryPoints(counters.uncompletedStoryPoints);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n}","import {Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Filter} from '../service/filter';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\nimport {SubTasksManager} from './subtasks.manager';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\ntype Params = {\n\tfilter: Filter,\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tsubTasksCreator: SubTasksManager\n}\n\nexport class FilterHandler extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.filter = params.filter;\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\n\t\tthis.filter.subscribe('applyFilter', this.onApplyFilter.bind(this));\n\t}\n\n\tonApplyFilter(baseEvent: BaseEvent)\n\t{\n\t\tthis.fadeOutAll();\n\n\t\tconst filterInfo = baseEvent.getData();\n\n\t\tthis.updateExactSearchStatusToEntities();\n\n\t\tthis.requestSender.applyFilter().then((response) => {\n\t\t\tfilterInfo.promise.fulfill();\n\n\t\t\tconst filteredItemsData = response.data;\n\n\t\t\tthis.entityStorage.getAllItems().forEach((item: Item) => {\n\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\tif (item.isParentTask())\n\t\t\t\t{\n\t\t\t\t\tthis.subTasksCreator.cleanVisibility(item);\n\t\t\t\t\tthis.subTasksCreator.cleanSubTasks(item);\n\t\t\t\t}\n\t\t\t\tentity.removeItem(item);\n\t\t\t\titem.removeYourself();\n\t\t\t});\n\n\t\t\tfilteredItemsData.forEach((itemData) => {\n\t\t\t\tconst item = Item.buildItem(itemData);\n\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\tDom.append(item.render(), entity.getListItemsNode());\n\t\t\t\tentity.setItem(item);\n\t\t\t\titem.onAfterAppend(entity.getListItemsNode());\n\t\t\t\tif (item.isParentTask())\n\t\t\t\t{\n\t\t\t\t\titem.downSubTasksTick();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.updateVisibilityToEntities();\n\n\t\t\tthis.fadeInAll();\n\t\t}).catch((response) => {\n\t\t\tfilterInfo.promise.reject();\n\n\t\t\tthis.fadeInAll();\n\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tupdateExactSearchStatusToEntities()\n\t{\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.setExactSearchApplied(this.filter.isSearchFieldApplied());\n\t\t});\n\t}\n\n\tupdateVisibilityToEntities()\n\t{\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.updateVisibility();\n\t\t});\n\t}\n\n\tfadeOutAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeOut();\n\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.fadeOut();\n\t\t});\n\t}\n\n\tfadeInAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeIn();\n\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.fadeIn();\n\t\t});\n\t}\n}","import {Event, Runtime, Tag, Text, Loc, Type, Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Label} from 'ui.label';\n\nimport {Filter} from '../service/filter';\nimport {SidePanel} from '../service/side.panel';\n\nimport {Entity} from '../entity/entity';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\nimport {TagSearcher} from './tag.searcher';\n\nimport type {EpicType} from '../item/item';\n\nimport '../css/epic.css';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tsidePanel: SidePanel,\n\tentity: Entity,\n\tfilter: Filter,\n\ttagSearcher: TagSearcher,\n}\n\nexport class Epic extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Epic');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.entity = params.entity;\n\t\tthis.filter = params.filter;\n\t\tthis.tagSearcher = params.tagSearcher;\n\n\t\tthis.form = null;\n\n\t\tthis.defaultColor = '#69dafc';\n\t\tthis.selectedColor = '';\n\n\t\tthis.currentEpic = null;\n\t}\n\n\tgetCurrentEpic(): ?Object\n\t{\n\t\treturn this.currentEpic;\n\t}\n\n\topenAddForm()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadAddForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildAddForm());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenEditForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadEditForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\t\tresolve(this.buildEditForm());\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenViewForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadViewForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\t\tresolve(this.buildViewForm());\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenEpicsList()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequest.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\t\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadListGrid.bind(this));\n\t\t\t\tthis.sidePanel.subscribeOnce('onCloseSidePanel', this.destroyGrid.bind(this));\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(Tag.render`\n\t\t\t\t\t<div class=\"tasks-scrum-epics-list\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-add-button\">\n\t\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-sm\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epics-list-grid\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tonLoadAddForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.currentEpic = null;\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadAddButtons().then((buttonsContainer) => {\n\t\t\tsidePanel.closeLoader();\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.createEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.onAfterCreateEpic(response.data);\n\t\t\t\t\tif (this.sidePanel.isPreviousSidePanelExist(sidePanel))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sidePanel.reloadPreviousSidePanel(sidePanel);\n\t\t\t\t\t\tsidePanel.close();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\t\tthis.openEpicsList();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\t\tresponse,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_CREATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t\tsidePanel.close();\n\t\t\t\t});\n\t\t\t});\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tonLoadViewForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadDescription();\n\t\tthis.onLoadFiles();\n\t\tthis.onLoadViewButtons().then((buttonsContainer) => {\n\t\t\tsidePanel.closeLoader();\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\tthis.openEditForm(this.currentEpic.id);\n\t\t\t\t});\n\t\t\t});\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tonLoadEditForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadEditButtons().then((buttonsContainer) => {\n\t\t\tsidePanel.closeLoader();\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.editEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.emit('onAfterEditEpic', response);\n\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\tthis.reloadGrid();\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.removeClockIconFromButton();\n\t\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\t\tresponse,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_UPDATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\treloadGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\tconst gridManager = BX.Main.gridManager.getById(this.gridId);\n\t\t\tif (gridManager)\n\t\t\t{\n\t\t\t\tgridManager.instance.reload();\n\t\t\t}\n\t\t}\n\t\t/* eslint-enable */\n\t}\n\n\tdestroyGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\tconst gridManager = BX.Main.gridManager.getById(this.gridId);\n\t\t\tif (gridManager)\n\t\t\t{\n\t\t\t\tgridManager.instance.destroy();\n\t\t\t}\n\t\t}\n\t\t/* eslint-enable */\n\t}\n\n\tonLoadEditor()\n\t{\n\t\tthis.getDescriptionEditor().then((editorHtml) => {\n\t\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\t\tRuntime.html(descriptionContainer, editorHtml).then(() => {\n\t\t\t\tthis.editor = window.LHEPostForm.getHandler(this.id);\n\t\t\t\twindow.BXHtmlEditor.Get(this.id);\n\t\t\t\tEventEmitter.emit(this.editor.eventNode, 'OnShowLHE', [true]);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.form.querySelector('.tasks-scrum-epic-form-header-title-control').focus();\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadDescription()\n\t{\n\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\tthis.requestSender.getEpicDescription({\n\t\t\tepicId: this.currentEpic.id,\n\t\t\ttext: this.currentEpic.description\n\t\t}).then(response => {\n\t\t\tRuntime.html(descriptionContainer, response.data);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonLoadFiles()\n\t{\n\t\tconst filesContainer = this.form.querySelector('.tasks-scrum-epic-form-files');\n\t\tthis.requestSender.getEpicFiles({\n\t\t\tepicId: this.currentEpic.id\n\t\t}).then(response => {\n\t\t\tRuntime.html(filesContainer, response.data.html);\n\t\t});\n\t}\n\n\tonLoadColorPicker()\n\t{\n\t\tthis.selectedColor = (this.currentEpic ? this.currentEpic.info.color : this.defaultColor);\n\t\tconst colorBlockNode = this.form.querySelector('.tasks-scrum-epic-header-color');\n\t\tEvent.bind(colorBlockNode, 'click', () => {\n\t\t\tconst colorNode = colorBlockNode.querySelector('.tasks-scrum-epic-header-color-current');\n\t\t\tconst picker = this.getColorPicker(colorNode);\n\t\t\tpicker.open();\n\t\t});\n\t}\n\n\tonLoadAddButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadViewButtons(): Promise\n\t{\n\t\treturn this.getViewEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadEditButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadListGrid(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tconst form = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list');\n\t\tconst list = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list-grid');\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.getEpicsList().then((responseData) => {\n\t\t\tsidePanel.closeLoader();\n\t\t\tif (responseData.html)\n\t\t\t{\n\t\t\t\tRuntime.html(list, responseData.html);\n\n\t\t\t\tthis.prepareTagsList(list);\n\n\t\t\t\tconst buttonNode = form.querySelector('.tasks-scrum-epic-header-add-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.remove(form.querySelector('.tasks-scrum-epic-header-add-button'));\n\t\t\t\tDom.append(this.getEmptyEpicListForm(), list);\n\t\t\t\tconst buttonNode = list.querySelector('.tasks-scrum-epics-empty-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [, eventArgs] = event.getCompatData();\n\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\teventArgs.method = 'POST';\n\n\t\tif (!eventArgs.url)\n\t\t{\n\t\t\teventArgs.url = this.requestSender.getEpicListUrl();\n\t\t}\n\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t\tentityId: this.entity.getId(),\n\t\t\tgridId: this.gridId,\n\t\t\tsignedParameters: this.requestSender.getSignedParameters()\n\t\t};\n\t}\n\n\tgetEpicsList() : Promise\n\t{\n\t\tthis.gridId = 'EntityEpicsGrid_' + this.entity.getId();\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicsList({\n\t\t\t\tentityId: this.entity.getId(),\n\t\t\t\tgridId: this.gridId\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetEpic(id: Number): Promise\n\t{\n\t\treturn this.requestSender.getEpic({id: id});\n\t}\n\n\tbuildAddForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader('', '#69dafc')}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildViewForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_VIEW_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t\t\t${Text.encode(this.currentEpic.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\t\t\"background-color: ${Text.encode(this.currentEpic.info.color)};\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\" style=\"padding: 15px 10px 15px 10px;\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-files\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildEditForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_EDIT_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader(this.currentEpic.name, this.currentEpic.info.color)}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEmptyEpicListForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epics-empty\">\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-first-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_FIRST_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-image\">\n\t\t\t\t\t<svg width=\"124px\" height=\"123px\" viewBox=\"0 0 124 123\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t\t<g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" opacity=\"0.28\">\n\t\t\t\t\t\t\t<path d=\"M83,105 L83,81.4375 L105,81.4375 L105,18 L17,18 L17,81.4375 L39,81.4375 L39,105 L83,105 Z M10.9411765,0 L113.058824,0 C119.101468,0 124,4.85902727 124,10.8529412 L124,112.147059 C124,118.140973 119.101468,123 113.058824,123 L10.9411765,123 C4.89853156,123 0,118.140973 0,112.147059 L0,10.8529412 C0,4.85902727 4.89853156,0 10.9411765,0 Z M44.0142862,47.0500004 L54.2142857,57.4416671 L79.7142857,32 L87,42.75 L54.2142857,75 L36,57.0833333 L44.0142862,47.0500004 Z\" fill=\"#A8ADB4\" />\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-second-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_SECOND_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-button\">\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-lg\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormHeader(title: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t${title}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormContainerHeader(name: String, color: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t<input type=\"text\" name=\"name\" value=\"${Text.encode(name)}\" class=\n\t\t\t\t\t\t\"tasks-scrum-epic-form-header-title-control\" placeholder=\n\t\t\t\t\t\t\"${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_NAME_PLACEHOLDER')}\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\"background-color: ${Text.encode(color)};\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetDescriptionEditor(): Promise\n\t{\n\t\tconst requestData = {\n\t\t\teditorId: this.id\n\t\t};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t\trequestData.text = this.currentEpic.description;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicDescriptionEditor(requestData).then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetAddEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getAddEpicFormButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetViewEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getViewEpicFormButtonsAction().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetColorPicker(colorNode)\n\t{\n\t\t/* eslint-disable */\n\t\treturn new BX.ColorPicker({\n\t\t\tbindElement: colorNode,\n\t\t\tdefaultColor: this.selectedColor,\n\t\t\tonColorSelected: (color, picker) => {\n\t\t\t\tthis.selectedColor = color;\n\t\t\t\tcolorNode.style.backgroundColor = color;\n\t\t\t},\n\t\t\tpopupOptions: {\n\t\t\t\tzIndex: 1100,\n\t\t\t\tclassName: 'tasks-scrum-epic-color-popup'\n\n\t\t\t},\n\t\t\tcolors: [\n\t\t\t\t[\"#aae9fc\", \"#bbecf1\", \"#98e1dc\", \"#e3f299\", \"#ffee95\", \"#ffdd93\", \"#dfd3b6\", \"#e3c6bb\"],\n\t\t\t\t[\"#ffad97\", \"#ffbdbb\", \"#ffcbd8\", \"#ffc4e4\", \"#c4baed\", \"#dbdde0\", \"#bfc5cd\", \"#a2a8b0\"]\n\t\t\t]\n\t\t});\n\t\t/* eslint-enable */\n\t}\n\n\tgetRequestData()\n\t{\n\t\tconst requestData = {};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t}\n\n\t\trequestData.entityId = this.entity.getId();\n\t\trequestData.name = (this.form.querySelector('[name=name]').value).trim();\n\t\trequestData.description = this.editor.oEditor.GetContent();\n\t\trequestData.color = this.selectedColor;\n\t\trequestData.files = this.getAttachmentsFiles();\n\n\t\treturn requestData;\n\t}\n\n\tgetAttachmentsFiles(): Array\n\t{\n\t\tconst files = [];\n\n\t\tif (!this.editor || !Type.isPlainObject(this.editor.arFiles) || !Type.isPlainObject(this.editor.controllers))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\tconst fileControllers = [];\n\t\tObject.values(this.editor.arFiles).forEach((controller) => {\n\t\t\tif(!fileControllers.includes(controller))\n\t\t\t{\n\t\t\t\tfileControllers.push(controller);\n\t\t\t}\n\t\t});\n\n\t\tfileControllers.forEach((fileController) => {\n\t\t\tif (\n\t\t\t\tthis.editor.controllers[fileController] &&\n\t\t\t\tType.isPlainObject(this.editor.controllers[fileController].values)\n\t\t\t)\n\t\t\t{\n\t\t\t\tObject.keys(this.editor.controllers[fileController].values).forEach((fileId) => {\n\t\t\t\t\tif (!files.includes(fileId))\n\t\t\t\t\t{\n\t\t\t\t\t\tfiles.push(fileId);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\n\t\treturn files;\n\t}\n\n\tprepareTagsList(container: HTMLElement)\n\t{\n\t\tconst tagsContainers = container.querySelectorAll('.tasks-scrum-epic-grid-tags');\n\t\ttagsContainers.forEach((tagsContainer) => {\n\t\t\tconst tags = this.getTagsFromNode(tagsContainer);\n\t\t\tDom.clean(tagsContainer);\n\t\t\ttags.forEach((tag) => {\n\t\t\t\tDom.append(this.getTagNode(tag), tagsContainer);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTagsFromNode(node: HTMLElement): Array\n\t{\n\t\tconst tags = [];\n\t\tnode.childNodes.forEach((childNode) => {\n\t\t\ttags.push(childNode.textContent.trim());\n\t\t});\n\t\treturn tags;\n\t}\n\n\tgetTagNode(tag: string): HTMLElement\n\t{\n\t\tconst tagLabel = new Label({\n\t\t\ttext: tag,\n\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\tfill: true,\n\t\t\tsize: Label.Size.SM,\n\t\t\tcustomClass: ''\n\t\t});\n\t\tconst container = tagLabel.getContainer();\n\t\tEvent.bind(container, 'click', () => {\n\t\t\tthis.emit('filterByTag', tag);\n\t\t\tthis.sidePanel.closeTopSidePanel(true);\n\t\t});\n\t\treturn container;\n\t}\n\n\tremoveClockIconFromButton()\n\t{\n\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\tif (buttonsContainer)\n\t\t{\n\t\t\tDom.removeClass(buttonsContainer.querySelector('[name=save]'), 'ui-btn-wait');\n\t\t}\n\t}\n\n\tonAfterCreateEpic(epic: EpicType)\n\t{\n\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\tthis.filter.addItemToListTypeField('EPIC', {\n\t\t\tNAME: epic.name.trim(),\n\t\t\tVALUE: String(epic.id)\n\t\t});\n\t}\n\n\tonAfterUpdateEpic(epic: EpicType)\n\t{\n\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\tconst itemEpic = item.getEpic();\n\t\t\tif (itemEpic && itemEpic.id === epic.id)\n\t\t\t{\n\t\t\t\titem.setEpicAndTags(epic);\n\t\t\t}\n\t\t});\n\n\t\tconst oldEpicInfo = this.getCurrentEpic();\n\t\tif (oldEpicInfo)\n\t\t{\n\t\t\tthis.tagSearcher.removeEpicFromSearcher(oldEpicInfo);\n\t\t}\n\n\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t}\n\n\tonAfterRemoveEpic(epic: EpicType)\n\t{\n\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\tconst itemEpic = item.getEpic();\n\t\t\tif (itemEpic && itemEpic.id === epic.id)\n\t\t\t{\n\t\t\t\titem.setEpicAndTags(null);\n\t\t\t}\n\t\t});\n\t\tthis.tagSearcher.removeEpicFromSearcher(epic);\n\t\tthis.sidePanel.reloadTopSidePanel(true);\n\t}\n}","import {Sprint} from '../entity/sprint/sprint';\n\nimport {RequestSender} from '../utility/request.sender';\nimport {DomBuilder} from '../utility/dom.builder';\nimport {EntityStorage} from '../utility/entity.storage';\n\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tgroupId: number\n}\n\ntype RemoveParams = {\n\tsprintId: number\n}\n\nexport class PullSprint\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tsprintAdded: this.onSprintAdded.bind(this),\n\t\t\tsprintUpdated: this.onSprintUpdated.bind(this),\n\t\t\tsprintRemoved: this.onSprintRemoved.bind(this)\n\t\t};\n\t}\n\n\tonSprintAdded(params: SprintParams)\n\t{\n\t\tif (this.groupId !== params.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = Sprint.buildSprint(params);\n\n\t\tif (this.needSkipAdd(sprint))\n\t\t{\n\t\t\tthis.cleanSkipAdd(sprint);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.domBuilder.createSprintNode(sprint);\n\t}\n\n\tonSprintUpdated(params: SprintParams)\n\t{\n\t\tconst tmpSprint = Sprint.buildSprint(params);\n\n\t\tif (this.needSkipUpdate(tmpSprint))\n\t\t{\n\t\t\tthis.cleanSkipUpdate(tmpSprint);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = this.entityStorage.findEntityByEntityId(tmpSprint.getId());\n\t\tif (sprint)\n\t\t{\n\t\t\tif (tmpSprint.getStatus() !== sprint.getStatus())\n\t\t\t{\n\t\t\t\tif (tmpSprint.getStatus() === 'active')\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.moveSprintToActiveListNode(sprint);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.moveSprintToCompletedListNode(sprint);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsprint.updateYourself(tmpSprint);\n\t\t}\n\t}\n\n\tonSprintRemoved(params: RemoveParams)\n\t{\n\t\tif (this.needSkipRemove(params.sprintId))\n\t\t{\n\t\t\tthis.cleanSkipRemove(params.sprintId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = this.entityStorage.findEntityByEntityId(params.sprintId);\n\t\tif (sprint)\n\t\t{\n\t\t\tsprint.removeSprint();\n\t\t\tthis.entityStorage.removeSprint(sprint.getId());\n\t\t}\n\t}\n\n\taddTmpIdToSkipAdding(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.add(tmpId);\n\t}\n\n\taddIdToSkipUpdating(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipUpdating.add(sprintId);\n\t}\n\n\taddIdToSkipRemoving(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.add(sprintId);\n\t}\n\n\tneedSkipAdd(sprint: Sprint): boolean\n\t{\n\t\treturn this.listIdsToSkipAdding.has(sprint.getTmpId());\n\t}\n\n\tcleanSkipAdd(sprint: Sprint)\n\t{\n\t\tthis.listIdsToSkipAdding.delete(sprint.getTmpId());\n\t}\n\n\tneedSkipUpdate(sprint: Sprint): boolean\n\t{\n\t\treturn this.listIdsToSkipUpdating.has(sprint.getId());\n\t}\n\n\tcleanSkipUpdate(sprint: Sprint)\n\t{\n\t\tthis.listIdsToSkipUpdating.delete(sprint.getId());\n\t}\n\n\tneedSkipRemove(sprintId: number): boolean\n\t{\n\t\treturn this.listIdsToSkipRemoving.has(sprintId);\n\t}\n\n\tcleanSkipRemove(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.delete(sprintId);\n\t}\n}","import {Loc, Type, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Menu} from 'main.popup';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nimport {Entity} from '../entity/entity';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\nimport {EntityCounters} from './entity.counters';\nimport {SubTasksManager} from './subtasks.manager';\n\nexport type ItemsSortInfo = {\n\t[id: number]: {\n\t\tsort: number,\n\t\tentityId?: number,\n\t\tupdatedItemId?: number\n\t}\n}\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tentityCounters: EntityCounters,\n\tsubTasksCreator: SubTasksManager\n}\n\nexport class ItemMover extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ItemMover');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.entityCounters = params.entityCounters;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\n\t\tthis.bindHandlers();\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.domBuilder.subscribe('itemMoveStart', (baseEvent: BaseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\t\tthis.hideSubTasks(sourceEntity, item);\n\t\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\t\tif (actionsPanel)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t}\n\t\t});\n\t\tthis.domBuilder.subscribe('itemMoveEnd', (baseEvent: BaseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tconst endContainer = dragEndEvent.endContainer;\n\t\t\tif (!endContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\n\t\t\tif (sourceEntityId === endEntityId)\n\t\t\t{\n\t\t\t\tthis.onItemMove(dragEndEvent);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(sourceEntity, message).then(() => {\n\t\t\t\t\tthis.onItemMove(dragEndEvent);\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\tconst itemNodeAfterSourceItem = sourceEntity.getListItemsNode().children[item.getSort()];\n\t\t\t\t\tthis.domBuilder.insertBefore(itemNode, itemNodeAfterSourceItem);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tmoveItem(item: Item, button)\n\t{\n\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\n\t\tconst listToMove = [];\n\n\t\tif (!entity.isFirstItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_UP'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\t\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst sortedItemsIds = new Set();\n\t\t\t\t\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\t\t\t\t\tthis.hideSubTasks(entity, groupModeItem);\n\t\t\t\t\t\t\tthis.moveItemToUp(groupModeItem, entity.getListItemsNode(), entity.hasInput(), false);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode(), sortedItemsIds)\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideSubTasks(entity, item);\n\t\t\t\t\t\tthis.moveItemToUp(item, entity.getListItemsNode(), entity.hasInput());\n\t\t\t\t\t}\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (!entity.isLastItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_DOWN'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\t\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst sortedItemsIds = new Set();\n\t\t\t\t\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\t\t\t\t\tthis.hideSubTasks(entity, groupModeItem);\n\t\t\t\t\t\t\tthis.moveItemToDown(groupModeItem, entity.getListItemsNode(), false);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode(), sortedItemsIds)\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideSubTasks(entity, item);\n\t\t\t\t\t\tthis.moveItemToDown(item, entity.getListItemsNode());\n\t\t\t\t\t}\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.showMoveItemMenu(item, button, listToMove);\n\t}\n\n\tmoveItemToUp(item: Item, listItemsNode, entityWithInput = true, updateSort = true)\n\t{\n\t\tif (entityWithInput)\n\t\t{\n\t\t\tthis.domBuilder.appendItemAfterItem(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.domBuilder.insertBefore(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tmoveItemToDown(item, listItemsNode, updateSort = true)\n\t{\n\t\tthis.domBuilder.append(item.getItemNode(), listItemsNode);\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tupdateItemsSort(item: Item, listItemsNode: HTMLElement)\n\t{\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(listItemsNode, new Set([item.getItemId()]))\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonItemMove(dragEndEvent)\n\t{\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\tconst endContainer = dragEndEvent.endContainer;\n\n\t\tif (endContainer === this.domBuilder.getSprintCreatingDropZoneNode())\n\t\t{\n\t\t\tconst createNewSprintAndMoveItem = () => {\n\t\t\t\tthis.domBuilder.createSprint().then((sprint) => {\n\t\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\tthis.moveTo(this.entityStorage.getBacklog(), sprint, item);\n\t\t\t\t});\n\t\t\t};\n\t\t\tcreateNewSprintAndMoveItem();\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\n\t\tif (sourceEntityId === endEntityId)\n\t\t{\n\t\t\tconst moveInCurrentContainer = () => {\n\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\tconst itemId = parseInt(itemNode.dataset.itemId, 10);\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tsortInfo: this.calculateSort(sourceContainer, new Set([itemId]))\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInCurrentContainer();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst moveInAnotherContainer = () => {\n\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\t\t\tconst endEntity = this.entityStorage.findEntityByEntityId(endEntityId);\n\t\t\t\tthis.moveItemFromEntityToEntity(item, sourceEntity, endEntity);\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tentityId: endEntity.getId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\titemType: item.getItemType(),\n\t\t\t\t\tsourceEntityId: sourceEntity.getId(),\n\t\t\t\t\tfromActiveSprint: ((sourceEntity.getEntityType() === 'sprint' && sourceEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\ttoActiveSprint: ((endEntity.getEntityType() === 'sprint' && endEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\tsortInfo: this.calculateSort(endContainer, new Set([item.getItemId()]), true)\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.updateEntityCounters(sourceEntity, endEntity);\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInAnotherContainer();\n\t\t}\n\t}\n\n\tupdateEntityCounters(sourceEntity: Entity, endEntity?: Entity)\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(sourceEntity.getId(), sourceEntity);\n\t\tif (endEntity)\n\t\t{\n\t\t\tentities.set(endEntity.getId(), endEntity);\n\t\t}\n\n\t\tthis.entityCounters.updateCounters(entities);\n\t}\n\n\tcalculateSort(container, updatedItemsIds?: Set, moveToAnotherEntity = false): ItemsSortInfo\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst items = [...container.querySelectorAll('[data-sort]')];\n\t\tlet sort = 1;\n\t\titems.forEach((itemNode) => {\n\t\t\tconst itemId = parseInt(itemNode.dataset.itemId, 10);\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tif (item && !item.isSubTask())\n\t\t\t{\n\t\t\t\tconst tmpId = Text.getRandom();\n\t\t\t\tlet isSortUpdated = (sort !== item.getSort());\n\t\t\t\titem.setSort(sort);\n\t\t\t\tlistSortInfo[itemId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tif (moveToAnotherEntity)\n\t\t\t\t{\n\t\t\t\t\tlistSortInfo[itemId].entityId = container.dataset.entityId;\n\t\t\t\t\tisSortUpdated = true;\n\t\t\t\t}\n\t\t\t\tif (isSortUpdated && updatedItemsIds && updatedItemsIds.has(itemId))\n\t\t\t\t{\n\t\t\t\t\tlistSortInfo[itemId].tmpId = tmpId;\n\t\t\t\t\tlistSortInfo[itemId].updatedItemId = itemId;\n\t\t\t\t}\n\t\t\t\titemNode.dataset.sort = sort;\n\t\t\t}\n\t\t\tsort++;\n\t\t});\n\n\t\tthis.emit('calculateSort', listSortInfo);\n\n\t\treturn listSortInfo;\n\t}\n\n\tmoveToAnotherEntity(entityFrom: Entity, item: Item, targetEntity: ?Entity, bindButton?: HTMLElement)\n\t{\n\t\tconst isMoveToSprint = (Type.isNull(targetEntity));\n\n\t\tconst sprints = (isMoveToSprint ? this.entityStorage.getSprintsAvailableForFilling(entityFrom) : null);\n\n\t\tif (entityFrom.isGroupMode())\n\t\t{\n\t\t\tif (isMoveToSprint)\n\t\t\t{\n\t\t\t\tif (sprints.size > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.showListSprintsToMove(entityFrom, item, bindButton);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (sprints.size === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.domBuilder.createSprint().then((sprint: Sprint) => {\n\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(entityFrom, message)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, targetEntity, item, false, false);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {})\n\t\t\t\t;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (isMoveToSprint)\n\t\t\t{\n\t\t\t\tif (sprints.size > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.showListSprintsToMove(entityFrom, item, bindButton);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\t\tthis.onMoveConfirm(entityFrom, message)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tif (sprints.size === 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.domBuilder.createSprint().then((sprint: Sprint) => {\n\t\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => {})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(entityFrom, message)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.moveTo(entityFrom, targetEntity, item, false);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {})\n\t\t\t\t;\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveToWithGroupMode(entityFrom: Entity, entityTo: Entity, item: Item, after = true, update = true)\n\t{\n\t\tconst groupModeItems = entityFrom.getGroupModeItems();\n\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\tif (after)\n\t\t\t{\n\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t}\n\t\t});\n\t\tconst sortedItemsIds = new Set();\n\t\tconst items = [];\n\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\tthis.moveTo(entityFrom, entityTo, groupModeItem, after, update);\n\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\titems.push({\n\t\t\t\titemId: groupModeItem.getItemId(),\n\t\t\t\titemType: groupModeItem.getItemType(),\n\t\t\t\tentityId: entityTo.getId(),\n\t\t\t\tsourceEntityId: entityFrom.getId(),\n\t\t\t\tfromActiveSprint: ((entityFrom.getEntityType() === 'sprint' && entityFrom.isActive()) ? 'Y' : 'N'),\n\t\t\t\ttoActiveSprint: ((entityTo.getEntityType() === 'sprint' && entityTo.isActive()) ? 'Y' : 'N')\n\t\t\t});\n\t\t});\n\t\tthis.requestSender.batchUpdateItem({\n\t\t\titems: items,\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), sortedItemsIds, true),\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), new Set(), true)\n\t\t\t}\n\t\t}).then(() => {\n\t\t\tthis.updateEntityCounters(entityFrom, entityTo);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t\tentityFrom.deactivateGroupMode();\n\t}\n\n\thideSubTasks(entity: Entity, item: Item)\n\t{\n\t\tif (item && item.isParentTask())\n\t\t{\n\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t{\n\t\t\t\tthis.subTasksCreator.toggleSubTasks(entity, item);\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveTo(entityFrom: Entity, entityTo: Entity, item: Item, after = true, update = true)\n\t{\n\t\tthis.hideSubTasks(entityFrom, item);\n\n\t\tconst itemNode = item.getItemNode();\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\t\tif (after)\n\t\t{\n\t\t\tthis.domBuilder.append(itemNode, entityListNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.domBuilder.appendItemAfterItem(itemNode, entityListNode.firstElementChild);\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\n\t\tif (update)\n\t\t{\n\t\t\tthis.onMoveItemUpdate(entityFrom, entityTo, item);\n\t\t}\n\t}\n\n\tmoveToPosition(entityFrom: Entity, entityTo: Entity, item: Item)\n\t{\n\t\tthis.hideSubTasks(entityFrom, item);\n\n\t\tconst itemNode = item.getItemNode();\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\t\tconst bindItemNode = entityListNode.children[item.getSort()];\n\t\tif (Type.isUndefined(bindItemNode))\n\t\t{\n\t\t\tthis.domBuilder.append(itemNode, entityListNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst bindItemSort = parseInt(bindItemNode.dataset.sort, 10);\n\t\t\tconst isMoveFromAnotherEntity = (entityFrom.getId() !== entityTo.getId())\n\n\t\t\tif (bindItemSort >= item.getPreviousSort())\n\t\t\t{\n\t\t\t\tif (isMoveFromAnotherEntity)\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.insertBefore(itemNode, bindItemNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.appendItemAfterItem(itemNode, bindItemNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.domBuilder.insertBefore(itemNode, bindItemNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\n\t\tthis.updateEntityCounters(entityFrom, entityTo);\n\t}\n\n\tonMoveItemUpdate(entityFrom: Entity, entityTo: Entity, item: Item)\n\t{\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\titemType: item.getItemType(),\n\t\t\tentityId: entityTo.getId(),\n\t\t\tsourceEntityId: entityFrom.getId(),\n\t\t\tfromActiveSprint: ((entityFrom.getEntityType() === 'sprint' && entityFrom.isActive()) ? 'Y' : 'N'),\n\t\t\ttoActiveSprint: ((entityTo.getEntityType() === 'sprint' && entityTo.isActive()) ? 'Y' : 'N'),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), new Set([item.getItemId()]), true),\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), new Set(), true)\n\t\t\t}\n\t\t}).then(() => {\n\t\t\tthis.updateEntityCounters(entityFrom, entityTo);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tmoveItemFromEntityToEntity(item: Item, entityFrom: Entity, entityTo: Entity)\n\t{\n\t\tentityFrom.removeItem(item);\n\t\titem.setParentEntity(entityTo.getId(), entityTo.getEntityType());\n\t\titem.setDisableStatus(false);\n\t\tentityTo.setItem(item);\n\t}\n\n\tshowListSprintsToMove(entityFrom: Entity, item: Item, button: HTMLElement)\n\t{\n\t\tconst id = `item-sprint-action-${entityFrom.getEntityType() + entityFrom.getId() + item.itemId}`;\n\n\t\tif (this.moveToSprintMenu)\n\t\t{\n\t\t\tif (this.moveToSprintMenu.getPopupWindow().getId() === id)\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.getPopupWindow().setBindElement(button);\n\t\t\t\tthis.moveToSprintMenu.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.moveToSprintMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveToSprintMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (!sprint.isCompleted() && !this.isSameSprint(entityFrom, sprint))\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.addMenuItem({\n\t\t\t\t\ttext: sprint.getName(),\n\t\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\t\tlet message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\t\t\tif (entityFrom.isGroupMode())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmessage = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.onMoveConfirm(entityFrom, message)\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tif (entityFrom.isGroupMode())\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(() => {})\n\t\t\t\t\t\t;\n\t\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.moveToSprintMenu.show();\n\t}\n\n\tisSameSprint(first: Sprint, second: Sprint): boolean\n\t{\n\t\treturn (first.getEntityType() === 'sprint' && first.getId() === second.getId());\n\t}\n\n\tonMoveConfirm(entity: Entity, message: string): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (entity.isActive())\n\t\t\t{\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tmessage,\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_MOVE'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\treject();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tshowMoveItemMenu(item, button, listToMove)\n\t{\n\t\tconst id = `item-move-${item.itemId}`;\n\n\t\tif (this.moveItemMenu)\n\t\t{\n\t\t\tthis.moveItemMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveItemMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tlistToMove.forEach((item) => {\n\t\t\tthis.moveItemMenu.addMenuItem(item);\n\t\t});\n\n\t\tthis.moveItemMenu.show();\n\t}\n}","import {Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {Item} from '../item/item';\n\nimport {RequestSender} from '../utility/request.sender';\nimport {DomBuilder} from '../utility/dom.builder';\nimport {EntityStorage} from '../utility/entity.storage';\nimport {EntityCounters} from '../utility/entity.counters';\nimport {TagSearcher} from '../utility/tag.searcher';\nimport {ItemMover} from '../utility/item.mover';\nimport {SubTasksManager} from '../utility/subtasks.manager';\n\nimport {Entity} from '../entity/entity';\n\nimport type {ItemParams} from '../item/item';\nimport type {ItemsSortInfo} from '../utility/item.mover';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tentityCounters: EntityCounters,\n\ttagSearcher: TagSearcher,\n\titemMover: ItemMover,\n\tsubTasksCreator: SubTasksManager,\n\tcurrentUserId: number\n}\n\ntype RemoveParams = {\n\titemId: number\n}\n\nexport class PullItem\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.entityCounters = params.entityCounters;\n\t\tthis.tagSearcher = params.tagSearcher;\n\t\tthis.itemMover = params.itemMover;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\t\tthis.currentUserId = params.currentUserId;\n\n\t\tthis.listToAddAfterUpdate = new Map();\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t\tthis.listIdsToSkipSorting = new Set();\n\n\t\tthis.itemMover.subscribe('calculateSort', this.onCalculateSort.bind(this))\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\titemAdded: this.onItemAdded.bind(this),\n\t\t\titemUpdated: this.onItemUpdated.bind(this),\n\t\t\titemRemoved: this.onItemRemoved.bind(this),\n\t\t\titemSortUpdated: this.onItemSortUpdated.bind(this),\n\t\t\tcomment_add: this.onCommentAdd.bind(this)\n\t\t};\n\t}\n\n\tonItemAdded(itemData: ItemParams)\n\t{\n\t\tconst item = new Item(itemData);\n\n\t\titem.cleanTaskCounts();\n\n\t\tthis.setDelayedAdd(item);\n\n\t\tthis.externalAdd(item)\n\t\t\t.finally(() => this.cleanDelayedAdd(item))\n\t\t\t.then(() => this.addItemToEntity(item))\n\t\t\t.catch(() => {})\n\t\t;\n\t}\n\n\tonItemUpdated(itemData: ItemParams)\n\t{\n\t\tconst item = new Item(itemData);\n\n\t\titem.cleanTaskCounts();\n\n\t\tif (this.isDelayedAdd(item))\n\t\t{\n\t\t\tthis.cleanDelayedAdd(item);\n\n\t\t\tif (this.needSkipAdd(item))\n\t\t\t{\n\t\t\t\tthis.cleanSkipAdd(item);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.addItemToEntity(item);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.needSkipUpdate(item))\n\t\t{\n\t\t\tthis.cleanSkipUpdate(item);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateItem(item);\n\t}\n\n\tonItemRemoved(params: RemoveParams)\n\t{\n\t\tif (this.needSkipRemove(params.itemId))\n\t\t{\n\t\t\tthis.cleanSkipRemove(params.itemId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = this.entityStorage.findItemByItemId(params.itemId);\n\t\tif (item)\n\t\t{\n\t\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\t\t\tentity.removeItem(item);\n\t\t\titem.removeYourself();\n\t\t}\n\t}\n\n\tonItemSortUpdated(itemsSortInfo : ItemsSortInfo)\n\t{\n\t\tconst itemsToSort = new Map();\n\t\tconst itemsInfoToSort = new Map();\n\t\tObject.entries(itemsSortInfo).forEach(([itemId, info]) => {\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tif (!this.needSkipSort(info.tmpId))\n\t\t\t\t{\n\t\t\t\t\titemsToSort.set(item.getItemId(), item);\n\t\t\t\t\titemsInfoToSort.set(item.getItemId(), info);\n\t\t\t\t}\n\t\t\t\tthis.cleanSkipRemove(info.tmpId);\n\t\t\t}\n\t\t});\n\n\t\titemsToSort.forEach((item: Item) => {\n\t\t\tconst itemInfoToSort = itemsInfoToSort.get(item.getItemId());\n\t\t\titem.setSort(itemInfoToSort.sort);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\tif (sourceEntity)\n\t\t\t{\n\t\t\t\tconst targetEntityId = (\n\t\t\t\t\tType.isUndefined(itemInfoToSort.entityId)\n\t\t\t\t\t\t? item.getEntityId()\n\t\t\t\t\t\t: itemInfoToSort.entityId\n\t\t\t\t);\n\t\t\t\tlet targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\t\t\t\tif (!targetEntity || sourceEntity.getId() === targetEntity.getId())\n\t\t\t\t{\n\t\t\t\t\ttargetEntity = sourceEntity;\n\t\t\t\t}\n\t\t\t\tthis.itemMover.moveToPosition(sourceEntity, targetEntity, item);\n\t\t\t\tthis.entityStorage.recalculateItemsSort();\n\t\t\t}\n\t\t});\n\t}\n\n\tonCommentAdd(params)\n\t{\n\t\tconst participants = Type.isArray(params.participants) ? params.participants : [];\n\n\t\tif (participants.includes(this.currentUserId.toString()))\n\t\t{\n\t\t\tconst xmlId = params.entityXmlId.split('_');\n\t\t\tif (xmlId)\n\t\t\t{\n\t\t\t\tconst entityType = xmlId[0];\n\t\t\t\tconst taskId = xmlId[1];\n\t\t\t\tconst item = this.entityStorage.findItemBySourceId(taskId);\n\t\t\t\tif (entityType === 'TASK' && item)\n\t\t\t\t{\n\t\t\t\t\tthis.requestSender.getCurrentState({\n\t\t\t\t\t\ttaskId: item.getSourceId()\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tconst tmpItem = new Item(response.data.itemData);\n\t\t\t\t\t\tthis.updateItem(tmpItem, item);\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddItemToEntity(item: Item)\n\t{\n\t\tif (item.isSubTask())\n\t\t{\n\t\t\tthis.updateParentItem(item);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.hasTaskInFilter({\n\t\t\ttaskId: item.getSourceId()\n\t\t}).then((response) => {\n\t\t\tif (!response.data.has)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\tif (!entity)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst bindItemNode = entity.getListItemsNode().children[item.getSort()];\n\n\t\t\tif (bindItemNode)\n\t\t\t{\n\t\t\t\tthis.domBuilder.insertBefore(item.render(), bindItemNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.domBuilder.append(item.render(), entity.getListItemsNode());\n\t\t\t}\n\n\t\t\tentity.setItem(item);\n\n\t\t\tthis.updateEntityCounters(entity);\n\n\t\t\titem.getTags().forEach((tag) => {\n\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t});\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tupdateItem(tmpItem: Item, item?: Item)\n\t{\n\t\tif (!item)\n\t\t{\n\t\t\titem = this.entityStorage.findItemByItemId(tmpItem.getItemId());\n\t\t}\n\n\t\tif (item)\n\t\t{\n\t\t\tif (item.isParentTask())\n\t\t\t{\n\t\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\t\tthis.subTasksCreator.hideSubTaskItems(entity, item);\n\t\t\t\t}\n\t\t\t\tthis.subTasksCreator.cleanSubTasks(item);\n\t\t\t}\n\n\t\t\tconst isParentChangeAction = tmpItem.isSubTask() !== item.isSubTask();\n\t\t\tif (isParentChangeAction)\n\t\t\t{\n\t\t\t\tif (tmpItem.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\t\t\t\t\tentity.removeItem(item);\n\t\t\t\t\titem.removeYourself();\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst targetEntityId = tmpItem.getEntityId();\n\t\t\tconst sourceEntityId = item.getEntityId();\n\t\t\tconst targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\n\t\t\tif (tmpItem.getEntityId() !== item.getEntityId())\n\t\t\t{\n\t\t\t\tif (targetEntity && sourceEntity)\n\t\t\t\t{\n\t\t\t\t\tthis.itemMover.moveToPosition(sourceEntity, targetEntity, item);\n\t\t\t\t\tthis.entityStorage.recalculateItemsSort();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.updateEntityCounters(targetEntity);\n\t\t\t}\n\n\t\t\titem.updateYourself(tmpItem);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (tmpItem.isSubTask())\n\t\t\t{\n\t\t\t\tthis.updateParentItem(tmpItem);\n\n\t\t\t\tconst targetEntityId = tmpItem.getEntityId();\n\t\t\t\tconst targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\n\t\t\t\tthis.updateEntityCounters(targetEntity);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.addItemToEntity(tmpItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateParentItem(item: Item)\n\t{\n\t\tconst parentItem = this.entityStorage.findItemBySourceId(item.getParentTaskId());\n\n\t\tif (parentItem)\n\t\t{\n\t\t\tparentItem.updateSubTasksPoints(item.getSourceId(), item.getStoryPoints());\n\t\t}\n\t}\n\n\tupdateEntityCounters(sourceEntity: Entity, endEntity?: Entity)\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(sourceEntity.getId(), sourceEntity);\n\t\tif (endEntity)\n\t\t{\n\t\t\tentities.set(endEntity.getId(), endEntity);\n\t\t}\n\n\t\tthis.entityCounters.updateCounters(entities);\n\t}\n\n\tonCalculateSort(baseEvent: BaseEvent)\n\t{\n\t\tconst listSortInfo = baseEvent.getData();\n\n\t\tObject.entries(listSortInfo).forEach(([itemId, info]) => {\n\t\t\tif (Object.prototype.hasOwnProperty.call(info, 'tmpId'))\n\t\t\t{\n\t\t\t\tthis.addTmpIdToSkipSorting(info.tmpId);\n\t\t\t}\n\t\t});\n\t}\n\n\taddTmpIdsToSkipAdding(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.add(tmpId);\n\t}\n\n\taddIdToSkipUpdating(itemId: string)\n\t{\n\t\tthis.listIdsToSkipUpdating.add(itemId);\n\t}\n\n\taddIdToSkipRemoving(itemId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.add(itemId);\n\t}\n\n\taddTmpIdToSkipSorting(itemId: number)\n\t{\n\t\tthis.listIdsToSkipSorting.add(itemId);\n\t}\n\n\texternalAdd(item: Item): boolean\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tsetTimeout(() => (this.isDelayedAdd(item) ? resolve() : reject()), 3000);\n\t\t});\n\t}\n\n\tisDelayedAdd(item: Item): boolean\n\t{\n\t\treturn this.listToAddAfterUpdate.has(item.getItemId());\n\t}\n\n\tsetDelayedAdd(item: Item)\n\t{\n\t\tthis.listToAddAfterUpdate.set(item.getItemId(), item);\n\t}\n\n\tcleanDelayedAdd(item: Item)\n\t{\n\t\tthis.listToAddAfterUpdate.delete(item.getItemId());\n\t}\n\n\tneedSkipAdd(item: Item): boolean\n\t{\n\t\treturn this.listIdsToSkipAdding.has(item.getTmpId());\n\t}\n\n\tcleanSkipAdd(item: Item)\n\t{\n\t\tthis.listIdsToSkipAdding.delete(item.getTmpId());\n\t}\n\n\tneedSkipUpdate(item: Item): boolean\n\t{\n\t\treturn this.listIdsToSkipUpdating.has(item.getItemId());\n\t}\n\n\tcleanSkipUpdate(item: Item)\n\t{\n\t\tthis.listIdsToSkipUpdating.delete(item.getItemId());\n\t}\n\n\tneedSkipRemove(itemId: number): boolean\n\t{\n\t\treturn this.listIdsToSkipRemoving.has(itemId);\n\t}\n\n\tcleanSkipRemove(itemId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.delete(itemId);\n\t}\n\n\tneedSkipSort(tmpId: string): boolean\n\t{\n\t\treturn this.listIdsToSkipSorting.has(tmpId);\n\t}\n\n\tcleanSkipSort(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipSorting.delete(tmpId);\n\t}\n}","import {RequestSender} from '../utility/request.sender';\nimport {DomBuilder} from '../utility/dom.builder';\nimport {EntityStorage} from '../utility/entity.storage';\nimport {Epic} from '../utility/epic';\n\nimport type {EpicType} from '../item/item';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tepic: Epic\n}\n\nexport class PullEpic\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.epic = params.epic;\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tepicAdded: this.onEpicAdded.bind(this),\n\t\t\tepicUpdated: this.onEpicUpdated.bind(this),\n\t\t\tepicRemoved: this.onEpicRemoved.bind(this)\n\t\t};\n\t}\n\n\tonEpicAdded(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterCreateEpic(epicData);\n\t}\n\n\tonEpicUpdated(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterUpdateEpic(epicData);\n\t}\n\n\tonEpicRemoved(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterRemoveEpic(epicData);\n\t}\n}","import {BaseEvent} from 'main.core.events';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage\n}\n\nexport class SprintMover\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.bindHandlers();\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.domBuilder.subscribe('sprintMove', this.onSprintMove.bind(this))\n\t}\n\n\tonSprintMove(baseEvent: BaseEvent)\n\t{\n\t\tconst dragEndEvent = baseEvent.getData();\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.updateSprintSort({\n\t\t\tsortInfo: this.calculateSprintSort()\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tcalculateSprintSort(increment = 0)\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst container = this.domBuilder.getSprintPlannedListNode();\n\n\t\tconst sprints = [...container.querySelectorAll('[data-sprint-sort]')];\n\t\tlet sort = 1 + increment;\n\t\tsprints.forEach((sprintNode) => {\n\t\t\tconst sprintId = sprintNode.dataset.sprintId;\n\t\t\tconst sprint = this.entityStorage.findEntityByEntityId(sprintId);\n\t\t\tif (sprint)\n\t\t\t{\n\t\t\t\tsprint.setSort(sort);\n\t\t\t\tlistSortInfo[sprintId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tsprintNode.dataset.sprintSort = sort;\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\n\t\treturn listSortInfo;\n\t}\n}","import {Type, Dom, Loc} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nimport {ScrumDod} from 'tasks.scrum.dod';\n\nimport {View} from './view';\nimport {TeamSpeedButton} from './header/team.speed.button';\n\nimport {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\nimport {Entity} from '../entity/entity';\nimport {Item} from '../item/item';\nimport {Decomposition} from '../item/task/decomposition';\nimport {DodSidePanel} from '../dod/side.panel';\nimport {TeamSpeedSidePanel} from '../team.speed/side.panel';\n\nimport {SidePanel} from '../service/side.panel';\nimport {PULL as Pull} from 'pull.client';\n\nimport {DomBuilder} from '../utility/dom.builder';\nimport {EntityStorage} from '../utility/entity.storage';\nimport {EntityCounters} from '../utility/entity.counters';\nimport {FilterHandler} from '../utility/filter.handler';\nimport {Epic} from '../utility/epic';\nimport {TagSearcher} from '../utility/tag.searcher';\nimport {PullSprint} from '../pull/pull.sprint';\nimport {PullItem} from '../pull/pull.item';\nimport {PullEpic} from '../pull/pull.epic';\nimport {SprintMover} from '../utility/sprint.mover';\nimport {ItemMover} from '../utility/item.mover';\nimport {ItemStyleDesigner} from '../utility/item.style.designer';\nimport {SubTasksManager} from '../utility/subtasks.manager';\n\nimport type {BacklogParams} from '../entity/backlog/backlog';\nimport type {SprintParams} from '../entity/sprint/sprint';\nimport type {EpicType, ItemParams} from '../item/item';\nimport type {Views} from './view';\nimport {Counters} from '../counters/counters';\n\ntype Responsible = {\n\tname: string,\n\tpathToUser: string,\n\tphoto: {\n\t\tsrc: string\n\t}\n}\n\ntype Params = {\n\tpathToTask: string,\n\tdefaultSprintDuration: number,\n\tactiveSprintId: number,\n\tbacklog: BacklogParams,\n\tsprints: Array<SprintParams>,\n\tviews: Views,\n\ttags: {\n\t\tepic: EpicType,\n\t\ttask: Array\n\t},\n\tdefaultResponsible: Responsible\n}\n\nexport class Plan extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Plan');\n\n\t\tthis.pathToTask = params.pathToTask;\n\t\tthis.defaultResponsible = params.defaultResponsible;\n\t\tthis.activeSprintId = parseInt(params.activeSprintId, 10);\n\t\tthis.views = params.views;\n\n\t\tthis.entityStorage = new EntityStorage();\n\t\tthis.entityStorage.addBacklog(Backlog.buildBacklog(params.backlog));\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tsprintData.defaultSprintDuration = params.defaultSprintDuration;\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t});\n\n\t\tthis.entityCounters = new EntityCounters({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.counters = new Counters({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tfilter: this.filter,\n\t\t\tuserId: params.userId,\n\t\t\tgroupId: params.groupId,\n\t\t\tisOwnerCurrentUser: params.isOwnerCurrentUser\n\t\t});\n\n\t\tthis.tagSearcher = new TagSearcher();\n\t\tObject.values(params.tags.epic).forEach((epic) => {\n\t\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\t});\n\t\tObject.values(params.tags.task).forEach((tagName) => {\n\t\t\tthis.tagSearcher.addTagToSearcher(tagName);\n\t\t});\n\n\t\tthis.domBuilder = new DomBuilder({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tdefaultSprintDuration: params.defaultSprintDuration,\n\t\t\tpageNumberToCompletedSprints: params.pageNumberToCompletedSprints\n\t\t});\n\t\tthis.domBuilder.subscribe('beforeCreateSprint', (baseEvent: BaseEvent) => {\n\t\t\tconst requestData = baseEvent.getData();\n\t\t\tthis.pullSprint.addTmpIdToSkipAdding(requestData.tmpId);\n\t\t});\n\t\tthis.domBuilder.subscribe(\n\t\t\t'createSprint',\n\t\t\t(baseEvent: BaseEvent) => this.subscribeToSprint(baseEvent.getData())\n\t\t);\n\t\tthis.domBuilder.subscribe(\n\t\t\t'createSprintNode',\n\t\t\t(baseEvent: BaseEvent) => this.subscribeToSprint(baseEvent.getData())\n\t\t);\n\n\t\tthis.sprintMover = new SprintMover({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.subTasksCreator = new SubTasksManager({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder\n\t\t});\n\n\t\tthis.filterHandler = new FilterHandler({\n\t\t\tfilter: this.filter,\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tsubTasksCreator: this.subTasksCreator\n\t\t});\n\n\t\tthis.itemMover = new ItemMover({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tentityCounters: this.entityCounters,\n\t\t\tsubTasksCreator: this.subTasksCreator\n\t\t});\n\n\t\tthis.itemStyleDesigner = new ItemStyleDesigner({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.epic = new Epic({\n\t\t\tentity: this.entityStorage.getBacklog(),\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tfilter: this.filter,\n\t\t\ttagSearcher: this.tagSearcher\n\t\t});\n\n\t\tthis.pullSprint = new PullSprint({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tgroupId: this.getCurrentGroupId()\n\t\t});\n\t\tthis.pullItem = new PullItem({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tentityCounters: this.entityCounters,\n\t\t\ttagSearcher: this.tagSearcher,\n\t\t\titemMover: this.itemMover,\n\t\t\tsubTasksCreator: this.subTasksCreator,\n\t\t\tcounters: this.counters,\n\t\t\tcurrentUserId: this.getCurrentUserId()\n\t\t});\n\t\tthis.pullEpic = new PullEpic({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tepic: this.epic,\n\t\t});\n\n\t\tthis.itemDod = new ScrumDod({\n\t\t\tgroupId: this.groupId\n\t\t});\n\n\t\tthis.bindHandlers();\n\n\t\tthis.subscribeToPull();\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tsuper.renderTo(container);\n\n\t\tthis.domBuilder.renderTo(container);\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderButtonsTo(container);\n\n\t\tconst teamSpeedButton = new TeamSpeedButton();\n\t\tteamSpeedButton.subscribe('click', this.onShowTeamSpeedChart.bind(this));\n\n\t\tDom.append(teamSpeedButton.render(), container);\n\t}\n\n\tsubscribeToPull()\n\t{\n\t\tPull.subscribe(this.pullSprint);\n\t\tPull.subscribe(this.pullItem);\n\t\tPull.subscribe(this.pullEpic);\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.entityStorage.getBacklog().subscribe('createTaskItem', this.onCreateTaskItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('updateItem', this.onUpdateItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showTask', this.onShowTask.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('moveItem', this.onMoveItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('moveToSprint', this.onMoveToSprint.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('removeItem', this.onRemoveItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('changeTaskResponsible', this.onChangeTaskResponsible.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('openAddEpicForm', this.onOpenAddEpicForm.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('openListEpicGrid', this.onOpenListEpicGrid.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('openDefinitionOfDone', this.onOpenDefinitionOfDone.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('attachFilesToTask', this.onAttachFilesToTask.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showDod', this.onShowDod.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showTagSearcher', this.onShowTagSearcher.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showEpicSearcher', this.onShowEpicSearcher.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('startDecomposition', this.onStartDecomposition.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('epicSearchOpen', this.onEpicSearchOpen.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('epicSearchClose', this.onEpicSearchClose.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('filterByEpic', this.onFilterByEpic.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('filterByTag', this.onFilterByTag.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('activateGroupMode', this.onActivateGroupMode.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('loadItems', this.onLoadItems.bind(this));\n\n\t\tthis.entityStorage.getSprints().forEach((sprint) => this.subscribeToSprint(sprint));\n\n\t\tthis.epic.subscribe('filterByTag', this.onFilterByTag.bind(this));\n\t}\n\n\tsubscribeToSprint(sprint: Sprint)\n\t{\n\t\tsprint.subscribe('createTaskItem', this.onCreateTaskItem.bind(this));\n\t\tsprint.subscribe('updateItem', this.onUpdateItem.bind(this));\n\t\tsprint.subscribe('showTask', this.onShowTask.bind(this));\n\t\tsprint.subscribe('moveItem', this.onMoveItem.bind(this));\n\t\tsprint.subscribe('moveToSprint', this.onMoveToSprint.bind(this));\n\t\tsprint.subscribe('moveToBacklog', this.onMoveToBacklog.bind(this));\n\t\tsprint.subscribe('removeItem', this.onRemoveItem.bind(this));\n\t\tsprint.subscribe('startSprint', this.onStartSprint.bind(this));\n\t\tsprint.subscribe('completeSprint', this.onCompleteSprint.bind(this));\n\t\tsprint.subscribe('changeTaskResponsible', this.onChangeTaskResponsible.bind(this));\n\t\tsprint.subscribe('removeSprint', this.onRemoveSprint.bind(this));\n\t\tsprint.subscribe('changeSprintName', this.onChangeSprintName.bind(this));\n\t\tsprint.subscribe('changeSprintDeadline', this.onChangeSprintDeadline.bind(this));\n\t\tsprint.subscribe('attachFilesToTask', this.onAttachFilesToTask.bind(this));\n\t\tsprint.subscribe('showDod', this.onShowDod.bind(this));\n\t\tsprint.subscribe('showTagSearcher', this.onShowTagSearcher.bind(this));\n\t\tsprint.subscribe('showEpicSearcher', this.onShowEpicSearcher.bind(this));\n\t\tsprint.subscribe('startDecomposition', this.onStartDecomposition.bind(this));\n\t\tsprint.subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tsprint.subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tsprint.subscribe('epicSearchOpen', this.onEpicSearchOpen.bind(this));\n\t\tsprint.subscribe('epicSearchClose', this.onEpicSearchClose.bind(this));\n\t\tsprint.subscribe('filterByEpic', this.onFilterByEpic.bind(this));\n\t\tsprint.subscribe('filterByTag', this.onFilterByTag.bind(this));\n\t\tsprint.subscribe('activateGroupMode', this.onActivateGroupMode.bind(this));\n\t\tsprint.subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t\tsprint.subscribe('getSprintCompletedItems', this.onGetSprintCompletedItems.bind(this));\n\t\tsprint.subscribe('showSprintBurnDownChart', this.onShowSprintBurnDownChart.bind(this));\n\t\tsprint.subscribe('toggleSubTasks', this.onToggleSubTasks.bind(this));\n\t\tsprint.subscribe('loadItems', this.onLoadItems.bind(this));\n\t}\n\n\tshowErrorAlert(message: string)\n\t{\n\t\tMessageBox.alert(message, Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\t}\n\n\tonCreateTaskItem(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst inputObject = data.inputObject;\n\t\tconst inputValue = data.value;\n\n\t\tlet newItem = null;\n\n\t\ttry\n\t\t{\n\t\t\tnewItem = this.createItem('task', inputValue);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.showErrorAlert(error.message);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.pullItem.addTmpIdsToSkipAdding(newItem.getItemId());\n\n\t\tthis.fillItemBeforeCreation(entity, newItem, inputValue);\n\n\t\tthis.domBuilder.appendItemAfterItem(newItem.render(), inputObject.getNode());\n\t\tnewItem.onAfterAppend(entity.getListItemsNode());\n\n\t\tnewItem.setParentId(inputObject.getEpicId());\n\t\tinputObject.setEpicId(0);\n\n\t\tthis.sendRequestToCreateTask(entity, newItem).then((response) => {\n\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t});\n\t\t\tentity.setItem(newItem);\n\t\t\tthis.updateEntityCounters(entity);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonUpdateItem(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst updateData = baseEvent.getData();\n\n\t\tthis.pullItem.addIdToSkipUpdating(updateData.itemId);\n\n\t\tthis.requestSender.updateItem(baseEvent.getData())\n\t\t\t.then(() => {\n\t\t\t\tconst isStoryPointsUpdated = (!Type.isUndefined(updateData.storyPoints));\n\t\t\t\tif (isStoryPointsUpdated)\n\t\t\t\t{\n\t\t\t\t\tthis.updateEntityCounters(entity);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonRemoveItem(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tif (entity.isGroupMode())\n\t\t{\n\t\t\tconst items = [];\n\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\titems.push({\n\t\t\t\t\titemId: groupModeItem.getItemId(),\n\t\t\t\t\tentityId: groupModeItem.getEntityId(),\n\t\t\t\t\titemType: groupModeItem.getItemType(),\n\t\t\t\t\tsourceId: groupModeItem.getSourceId()\n\t\t\t\t});\n\t\t\t\tthis.pullItem.addIdToSkipRemoving(groupModeItem.getItemId());\n\t\t\t});\n\t\t\tthis.requestSender.batchRemoveItem({\n\t\t\t\titems: items,\n\t\t\t\tsortInfo: this.itemMover.calculateSort(entity.getListItemsNode())\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t\tentity.deactivateGroupMode();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pullItem.addIdToSkipRemoving(baseEvent.getData().getItemId());\n\t\t\tthis.requestSender.removeItem({\n\t\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\t\tentityId: baseEvent.getData().getEntityId(),\n\t\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\t\tsortInfo: this.itemMover.calculateSort(entity.getListItemsNode())\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t}\n\t}\n\n\tonMoveItem(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tthis.itemMover.moveItem(data.item, data.button);\n\t}\n\n\tonMoveToSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst entityFrom = baseEvent.getTarget();\n\t\tthis.itemMover.moveToAnotherEntity(entityFrom, data.item, null, data.button);\n\t\tif (this.entityStorage.getSprintsAvailableForFilling(entityFrom).size <= 1)\n\t\t{\n\t\t\tthis.domBuilder.remove(data.button.parentNode);\n\t\t}\n\t}\n\n\tonMoveToBacklog(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tthis.itemMover.moveToAnotherEntity(data.sprint, data.item, this.entityStorage.getBacklog());\n\t}\n\n\tonChangeTaskResponsible(baseEvent: BaseEvent)\n\t{\n\t\tthis.pullItem.addIdToSkipUpdating(baseEvent.getData().getItemId());\n\t\tthis.requestSender.changeTaskResponsible({\n\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\tresponsible: baseEvent.getData().getResponsible(),\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonStartSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showStartSidePanel(sprint);\n\t}\n\n\tonCompleteSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showCompleteSidePanel(sprint);\n\t}\n\n\tonRemoveSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tthis.pullSprint.addIdToSkipRemoving(sprint.getId());\n\t\tthis.requestSender.removeSprint({\n\t\t\tsprintId: sprint.getId(),\n\t\t\tsortInfo: this.sprintMover.calculateSprintSort()\n\t\t}).then((response) => {\n\t\t\tthis.entityStorage.removeSprint(sprint.getId());\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeSprintName(baseEvent: BaseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.pullSprint.addIdToSkipUpdating(requestData.sprintId);\n\t\tthis.requestSender.changeSprintName(requestData).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeSprintDeadline(baseEvent: BaseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.pullSprint.addIdToSkipUpdating(requestData.sprintId);\n\t\tthis.requestSender.changeSprintDeadline(requestData).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonGetSprintCompletedItems(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst listItemsNode = sprint.getListItemsNode();\n\t\tconst listPosition = this.domBuilder.getPosition(listItemsNode);\n\t\tconst loader = new Loader({\n\t\t\ttarget: listItemsNode,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: '#eaeaea',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\t\tloader.show();\n\t\tthis.requestSender.getSprintCompletedItems({\n\t\t\tsprintId: sprint.getId()\n\t\t}).then((response) => {\n\t\t\tconst itemsData = response.data;\n\t\t\titemsData.forEach((itemData) => {\n\t\t\t\tconst item = new Item(itemData);\n\t\t\t\titem.setDisableStatus(sprint.isDisabled());\n\t\t\t\tthis.domBuilder.append(item.render(), listItemsNode);\n\t\t\t\tsprint.setItem(item);\n\t\t\t});\n\t\t\tloader.hide();\n\t\t}).catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonShowSprintBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(sprint);\n\t}\n\n\tonShowTask(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getData();\n\t\tthis.sidePanel.openSidePanelByUrl(this.pathToTask.replace('#task_id#', item.getSourceId()));\n\t}\n\n\tonAttachFilesToTask(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tthis.pullItem.addIdToSkipUpdating(data.item.getItemId());\n\t\tthis.requestSender.attachFilesToTask({\n\t\t\ttaskId: data.item.getSourceId(),\n\t\t\titemId: data.item.getItemId(),\n\t\t\tentityId: data.item.getEntityId(),\n\t\t\tattachedIds: data.attachedIds,\n\t\t}).then((response) => {\n\t\t\tdata.item.updateIndicators(response.data);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonShowDod(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getData();\n\n\t\tthis.itemDod.skipNotificationPopups();\n\n\t\tthis.itemDod.showList(item.getSourceId())\n\t\t\t.then(() => {})\n\t\t\t.catch(() => {})\n\t\t;\n\t}\n\n\tonToggleSubTasks(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst item = baseEvent.getData();\n\n\t\tthis.subTasksCreator.toggleSubTasks(sprint, item);\n\t}\n\n\tonShowTagSearcher(baseEvent: BaseEvent)\n\t{\n\t\t//todo refactor and test\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst data = baseEvent.getData();\n\t\tconst item = data.item;\n\t\tconst actionsPanelButton = data.button;\n\t\tthis.tagSearcher.showTagsDialog(item, actionsPanelButton);\n\t\tthis.tagSearcher.unsubscribeAll('attachTagToTask');\n\t\tthis.tagSearcher.subscribe('attachTagToTask', (innerBaseEvent) => {\n\t\t\tconst tag = innerBaseEvent.getData();\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tconst tasks = [];\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\ttasks.push({\n\t\t\t\t\t\ttaskId: groupModeItem.getSourceId(),\n\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.requestSender.batchAttachTagToTask({\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tconst currentTags = groupModeItem.getTags();\n\t\t\t\t\t\tcurrentTags.push(tag);\n\t\t\t\t\t\tgroupModeItem.setEpicAndTags(groupModeItem.getEpic(), currentTags);\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst currentTags = item.getTags();\n\t\t\t\tthis.requestSender.attachTagToTask({\n\t\t\t\t\ttaskId: item.getSourceId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tcurrentTags.push(tag);\n\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.tagSearcher.unsubscribeAll('deAttachTagToTask');\n\t\tthis.tagSearcher.subscribe('deAttachTagToTask', (innerBaseEvent) => {\n\t\t\tconst tag = innerBaseEvent.getData();\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tconst tasks = [];\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\ttasks.push({\n\t\t\t\t\t\ttaskId: groupModeItem.getSourceId(),\n\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.requestSender.batchDeattachTagToTask({\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tconst currentTags = groupModeItem.getTags();\n\t\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(tag), 1);\n\t\t\t\t\t\tgroupModeItem.setEpicAndTags(groupModeItem.getEpic(), currentTags);\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst currentTags = item.getTags();\n\t\t\t\tthis.requestSender.deAttachTagToTask({\n\t\t\t\t\ttaskId: item.getSourceId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(tag), 1);\n\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.tagSearcher.unsubscribeAll('hideTagDialog');\n\t\tthis.tagSearcher.subscribe('hideTagDialog', (innerBaseEvent) => {\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tentity.deactivateGroupMode();\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowEpicSearcher(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst data = baseEvent.getData();\n\t\tconst item = data.item;\n\t\tconst actionsPanelButton = data.button;\n\t\tthis.tagSearcher.showEpicDialog(item, actionsPanelButton);\n\t\tthis.tagSearcher.unsubscribeAll('updateItemEpic');\n\t\tthis.tagSearcher.subscribe('updateItemEpic', (innerBaseEvent) => {\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tconst items = [];\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t});\n\t\t\t\t\tthis.pullItem.addIdToSkipUpdating(groupModeItem.getItemId());\n\t\t\t\t});\n\t\t\t\tthis.requestSender.batchUpdateItemEpic({\n\t\t\t\t\titems: items,\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\tepicId: innerBaseEvent.getData()\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tif (Type.isArray(response.data.epic))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgroupModeItem.setParentId(0);\n\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(null, null);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgroupModeItem.setParentId(response.data.epic.id);\n\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(response.data.epic, groupModeItem.getTags());\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.pullItem.addIdToSkipUpdating(item.getItemId());\n\t\t\t\tthis.requestSender.updateItemEpic({\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\tepicId: innerBaseEvent.getData()\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tif (Type.isArray(response.data.epic))\n\t\t\t\t\t{\n\t\t\t\t\t\titem.setParentId(0);\n\t\t\t\t\t\titem.setEpicAndTags(null, null);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titem.setParentId(response.data.epic.id);\n\t\t\t\t\t\titem.setEpicAndTags(response.data.epic, item.getTags());\n\t\t\t\t\t}\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonStartDecomposition(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst parentItem = baseEvent.getData();\n\n\t\tconst decomposition = new Decomposition({\n\t\t\tentity: entity,\n\t\t\titemStyleDesigner: this.itemStyleDesigner,\n\t\t\tsubTasksCreator: this.subTasksCreator\n\t\t});\n\t\tdecomposition.subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tdecomposition.subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tdecomposition.subscribe('createItem', (innerBaseEvent) => {\n\t\t\tconst inputValue = innerBaseEvent.getData();\n\t\t\tconst decomposedItems = decomposition.getDecomposedItems();\n\t\t\tconst lastDecomposedItem = Array.from(decomposedItems).pop();\n\n\t\t\tlet newItem = null;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tnewItem = this.createItem(parentItem.getItemType(), inputValue);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tthis.showErrorAlert(error.message);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.pullItem.addTmpIdsToSkipAdding(newItem.getItemId());\n\t\t\tthis.pullItem.addIdToSkipUpdating(parentItem.getItemId());\n\n\t\t\tnewItem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\t\tnewItem.setParentId(parentItem.getParentId());\n\t\t\tnewItem.setParentTaskId(parentItem.getSourceId());\n\t\t\tnewItem.setEpic(parentItem.getEpic());\n\t\t\tnewItem.setTags(parentItem.getTags());\n\t\t\tnewItem.setResponsible(decomposition.getResponsible());\n\t\t\tif (decomposition.isBacklogDecomposition())\n\t\t\t{\n\t\t\t\tparentItem.setLinkedTask('Y');\n\n\t\t\t\tnewItem.setSort(lastDecomposedItem.getSort() + 1);\n\t\t\t\tnewItem.setInfo({\n\t\t\t\t\tborderColor: decomposition.getBorderColor()\n\t\t\t\t});\n\t\t\t\tnewItem.setLinkedTask('Y');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnewItem.setSort(decomposition.getSubTasks(parentItem).length + 1);\n\t\t\t\tnewItem.setSubTask('Y');\n\t\t\t\tnewItem.setParentTaskId(parentItem.getSourceId());\n\t\t\t\tnewItem.setParentTask('N');\n\n\t\t\t\tif (decomposition.isFirstDecomposition())\n\t\t\t\t{\n\t\t\t\t\tnewItem.setStoryPoints(parentItem.getStoryPoints().getPoints());\n\t\t\t\t}\n\n\t\t\t\tparentItem.setParentTask('Y');\n\t\t\t\tparentItem.setSubTasksCount(parentItem.getSubTasksCount() + 1);\n\t\t\t\tparentItem.updateParentTaskNodes();\n\t\t\t}\n\n\t\t\tthis.domBuilder.appendItemAfterItem(\n\t\t\t\tnewItem.render(),\n\t\t\t\tdecomposition.getLastDecomposedItemNode(parentItem)\n\t\t\t);\n\t\t\tnewItem.onAfterAppend(entity.getListItemsNode());\n\n\t\t\tdecomposition.addDecomposedItem(newItem);\n\n\t\t\tthis.sendRequestToCreateTask(entity, newItem).then((response) => {\n\t\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t\t});\n\t\t\t\tentity.setItem(newItem);\n\t\t\t\tthis.updateEntityCounters(entity);\n\t\t\t\tif (!decomposition.isBacklogDecomposition())\n\t\t\t\t{\n\t\t\t\t\tif (lastDecomposedItem.getItemId() === parentItem.getItemId())\n\t\t\t\t\t{\n\t\t\t\t\t\tparentItem.updateSubTasksPoints(newItem.getSourceId(), newItem.getStoryPoints());\n\t\t\t\t\t\tparentItem.setStoryPoints('');\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.subTasksCreator.addSubTask(parentItem, newItem);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tdecomposition.subscribe('updateParentItem', this.onUpdateItem.bind(this));\n\n\t\tdecomposition.decomposeItem(parentItem);\n\t}\n\n\tonTagsSearchOpen(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst inputObject = data.inputObject;\n\t\tconst enteredHashTagName = data.enteredHashTagName;\n\t\tthis.tagSearcher.showTagsSearchDialog(inputObject, enteredHashTagName);\n\t}\n\n\tonTagsSearchClose()\n\t{\n\t\tthis.tagSearcher.closeTagsSearchDialog();\n\t}\n\n\tonFilterByTag(baseEvent: BaseEvent)\n\t{\n\t\tconst tag = baseEvent.getData();\n\t\tconst currentValue = this.filter.getValueFromField({name: 'TAG', value: ''});\n\t\tif (String(tag) === String(currentValue))\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'TAG', value: ''});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'TAG', value: String(tag)});\n\t\t}\n\t\tthis.filter.scrollToSearchContainer();\n\t}\n\n\tonEpicSearchOpen(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst inputObject = data.inputObject;\n\t\tconst enteredHashEpicName = data.enteredHashEpicName;\n\t\tthis.tagSearcher.showEpicSearchDialog(inputObject, enteredHashEpicName);\n\t}\n\n\tonEpicSearchClose()\n\t{\n\t\tthis.tagSearcher.closeEpicSearchDialog();\n\t}\n\n\tonFilterByEpic(baseEvent: BaseEvent)\n\t{\n\t\tconst epicId = baseEvent.getData();\n\t\tconst currentValue = this.filter.getValueFromField({name: 'EPIC', value: ''});\n\t\tif (String(epicId) === String(currentValue))\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'EPIC', value: ''});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'EPIC', value: String(epicId)});\n\t\t}\n\t\tthis.filter.scrollToSearchContainer();\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tif (entity.getId() !== this.entityStorage.getBacklog().getId())\n\t\t{\n\t\t\tthis.entityStorage.getBacklog().deactivateGroupMode();\n\t\t}\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (entity.getId() !== sprint.getId())\n\t\t\t{\n\t\t\t\tsprint.deactivateGroupMode();\n\t\t\t}\n\t\t});\n\t\tentity.getItems().forEach((item: Item) => {\n\t\t\titem.activateGroupMode();\n\t\t});\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tentity.getItems().forEach((item: Item) => {\n\t\t\titem.deactivateGroupMode();\n\t\t});\n\t}\n\n\tonLoadItems(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\n\t\tentity.setActiveLoadItems(true);\n\n\t\tconst loader = entity.showItemsLoader();\n\n\t\tconst requestData = {\n\t\t\tentityId: entity.getId(),\n\t\t\tpageNumber: entity.getPageNumberItems() + 1\n\t\t};\n\n\t\tthis.requestSender.getItems(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tconst items = response.data;\n\t\t\t\tif (Type.isArray(items) && items.length)\n\t\t\t\t{\n\t\t\t\t\tentity.incrementPageNumberItems();\n\t\t\t\t\tentity.setActiveLoadItems(false);\n\n\t\t\t\t\tthis.createItemsInEntity(entity, items);\n\t\t\t\t}\n\t\t\t\tloader.hide();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\tentity.setActiveLoadItems(false);\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tcreateItemsInEntity(entity: Entity, items: Array)\n\t{\n\t\titems.forEach((itemData: ItemParams) => {\n\t\t\tconst item = new Item(itemData);\n\t\t\titem.setEntityType(entity.getEntityType());\n\t\t\tif (!this.entityStorage.findItemByItemId(item.getItemId()))\n\t\t\t{\n\t\t\t\tthis.domBuilder.append(item.render(), entity.getListItemsNode());\n\t\t\t\titem.onAfterAppend(entity.getListItemsNode());\n\t\t\t\tentity.setItem(item);\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowTeamSpeedChart(baseEvent: BaseEvent)\n\t{\n\t\tconst teamSpeedSidePanel = new TeamSpeedSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\t\tteamSpeedSidePanel.showTeamSpeedChart();\n\t}\n\n\tonOpenAddEpicForm(baseEvent: BaseEvent)\n\t{\n\t\tthis.epic.openAddForm();\n\t}\n\n\tonOpenListEpicGrid(baseEvent: BaseEvent)\n\t{\n\t\tthis.epic.openEpicsList();\n\t\tthis.epic.subscribe('onAfterEditEpic', (innerBaseEvent) => {\n\t\t\tconst response = innerBaseEvent.getData();\n\t\t\tconst updatedEpicInfo = response.data;\n\t\t\tthis.epic.onAfterUpdateEpic(updatedEpicInfo);\n\t\t});\n\t}\n\n\tonOpenDefinitionOfDone(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\n\t\tconst sidePanel = new DodSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\n\t\tsidePanel.showSettingsPanel(entity);\n\t}\n\n\tcreateItem(itemType: string, value: string): Item\n\t{\n\t\tconst valueWithoutTags = value\n\t\t\t.replace(new RegExp(TagSearcher.tagRegExp,'g'), '')\n\t\t\t.replace(new RegExp(TagSearcher.epicRegExp,'g'), '');\n\n\t\treturn new Item({\n\t\t\t'itemId': '',\n\t\t\t'itemType': itemType,\n\t\t\t'name': valueWithoutTags\n\t\t});\n\t}\n\n\tsendRequestToCreateTask(entity: Entity, item: Item): Promise\n\t{\n\t\tconst requestData = {\n\t\t\t'tmpId': item.getItemId(),\n\t\t\t'itemType': item.getItemType(),\n\t\t\t'name': item.getName(),\n\t\t\t'entityId': item.getEntityId(),\n\t\t\t'entityType': entity.getEntityType(),\n\t\t\t'parentId': item.getParentId(),\n\t\t\t'sort': item.getSort(),\n\t\t\t'storyPoints': item.getStoryPoints().getPoints(),\n\t\t\t'tags': item.getTags(),\n\t\t\t'epic': item.getEpic(),\n\t\t\t'parentTaskId': item.getParentTaskId(),\n\t\t\t'responsible': item.getResponsible(),\n\t\t\t'info': item.getInfo(),\n\t\t\t'sortInfo': this.itemMover.calculateSort(entity.getListItemsNode()),\n\t\t\t'isActiveSprint': ((entity.getEntityType() === 'sprint' && entity.isActive()) ? 'Y' : 'N')\n\t\t};\n\t\treturn this.requestSender.createTask(requestData);\n\t}\n\n\tfillItemBeforeCreation(entity: Entity, item: Item, value: string)\n\t{\n\t\titem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\titem.setSort(1);\n\t\titem.setResponsible(this.defaultResponsible);\n\n\t\tconst tags = TagSearcher.getHashTagNamesFromText(value);\n\t\tconst epicName = TagSearcher.getHashEpicNamesFromText(value).pop();\n\n\t\tlet inputEpic = null;\n\t\tif (epicName)\n\t\t{\n\t\t\tinputEpic = this.tagSearcher.getEpicByName(epicName.trim());\n\t\t}\n\n\t\tif (inputEpic || tags.length > 0)\n\t\t{\n\t\t\titem.setEpicAndTags(inputEpic, tags);\n\t\t}\n\t}\n\n\tfillItemAfterCreation(item: Item, responseData: Object): Item\n\t{\n\t\t//todo test\n\n\t\titem.setItemId(responseData.itemId);\n\t\tif (!Type.isArray(responseData.epic) || responseData.tags.length > 0)\n\t\t{\n\t\t\titem.setEpicAndTags(responseData.epic, responseData.tags);\n\t\t}\n\t\titem.setResponsible(responseData.responsible);\n\t\titem.setSourceId(responseData.sourceId);\n\t\titem.setAllowedActions(responseData.allowedActions);\n\t}\n\n\topenEpicEditForm(epicId)\n\t{\n\t\tthis.epic.openEditForm(epicId);\n\t}\n\n\topenEpicViewForm(epicId)\n\t{\n\t\tthis.epic.openViewForm(epicId);\n\t}\n\n\tremoveEpic(epicId)\n\t{\n\t\tthis.requestSender.removeItem({\n\t\t\titemId: epicId,\n\t\t\titemType: 'epic'\n\t\t}).then((response) => {\n\t\t\tconst epicInfo = response.data;\n\t\t\tthis.epic.onAfterRemoveEpic(epicInfo);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tupdateEntityCounters(sourceEntity: Entity, endEntity?: Entity)\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(sourceEntity.getId(), sourceEntity);\n\t\tif (endEntity)\n\t\t{\n\t\t\tentities.set(endEntity.getId(), endEntity);\n\t\t}\n\n\t\tthis.entityCounters.updateCounters(entities);\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Menu} from 'main.popup';\n\nexport class ActiveSprintActionButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ActiveSprintButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"ui-btn-split ui-btn-primary ui-btn-xs\"> \n\t\t\t\t<button class=\"ui-btn-main\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ACTIONS_COMPLETE_SPRINT')}\n\t\t\t\t</button> \n\t\t\t\t<button class=\"ui-btn-menu\"></button> \n\t\t\t</div>\n\t\t`;\n\n\t\tconst completeSprintButtonNode = node.querySelector('.ui-btn-main');\n\t\tconst menuButtonNode = node.querySelector('.ui-btn-menu');\n\n\t\tEvent.bind(completeSprintButtonNode, 'click', this.onCompleteSprintClick.bind(this));\n\t\tEvent.bind(menuButtonNode, 'click', this.onMenuClick.bind(this, completeSprintButtonNode));\n\n\t\treturn node;\n\t}\n\n\tonCompleteSprintClick()\n\t{\n\t\tthis.emit('completeSprint');\n\t}\n\n\tonMenuClick(bindElement: HTMLElement)\n\t{\n\t\tconst menu = new Menu({\n\t\t\tid: `active-sprint-actions-menu-${Text.getRandom()}`,\n\t\t\tbindElement: bindElement\n\t\t});\n\n\t\tmenu.addMenuItem({\n\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ACTIVE_SPRINT_BUTTON'),\n\t\t\tonclick: (event, menuItem) => {\n\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\tthis.emit('showBurnDownChart');\n\t\t\t}\n\t\t});\n\n\t\tmenu.show();\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../../service/side.panel';\n\nimport '../../css/robot.button.css';\n\ntype Params = {\n\tsidePanel: SidePanel,\n\tgroupId: number,\n\tisTaskLimitsExceeded: boolean,\n\tcanUseAutomation: boolean\n}\n\nexport class RobotButton extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.isTaskLimitsExceeded = params.isTaskLimitsExceeded;\n\t\tthis.canUseAutomation = params.canUseAutomation;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.RobotButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet className = 'tasks-scrum-robot-btn ui-btn ui-btn-light-border ui-btn-no-caps ui-btn-themes ui-btn-round';\n\t\tif (this.isShowLimitSidePanel())\n\t\t{\n\t\t\tclassName += ' ui-btn-icon-lock';\n\t\t}\n\n\t\tconst node = Tag.render`\n\t\t\t<button class=\"${className}\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ROBOTS_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonClick()\n\t{\n\t\tif (this.isShowLimitSidePanel())\n\t\t{\n\t\t\t// eslint-disable-next-line\n\t\t\tBX.UI.InfoHelper.show('limit_tasks_robots');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst url = '/bitrix/components/bitrix/tasks.automation/slider.php?site_id='\n\t\t\t\t+ Loc.getMessage('SITE_ID') + '&project_id=' + this.groupId;\n\n\t\t\tthis.sidePanel.openSidePanelByUrl(url);\n\t\t}\n\t}\n\n\tisShowLimitSidePanel(): boolean\n\t{\n\t\treturn (this.isTaskLimitsExceeded && !this.canUseAutomation);\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {View} from './view';\nimport {ActiveSprintActionButton} from './header/active.sprint.action.button';\nimport {RobotButton} from './header/robot.button';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\nimport {StatsHeaderBuilder} from '../entity/sprint/stats.header.builder';\nimport {Item} from '../item/item';\n\nimport type {SprintParams} from '../entity/sprint/sprint';\nimport type {Views} from './view';\n\ntype Params = {\n\tpathToTask: string,\n\tviews: Views,\n\tactiveSprint: SprintParams,\n\tsprints: Array<SprintParams>,\n\ttaskLimitExceeded: 'Y' | 'N',\n\tcanUseAutomation: 'Y' | 'N'\n}\n\nexport class ActiveSprint extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ActiveSprint');\n\n\t\tthis.setParams(params);\n\n\t\tif (this.existActiveSprint())\n\t\t{\n\t\t\tthis.finishStatus = this.getActiveSprintParams().finishStatus;\n\n\t\t\tthis.sprint = new Sprint(this.getActiveSprintParams());\n\n\t\t\tthis.itemsInFinishStage = new Map();\n\n\t\t\tthis.bindHandlers();\n\t\t}\n\n\t\tthis.sidePanel = new SidePanel();\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderSprintStatsTo(container);\n\n\t\tif (this.sprint)\n\t\t{\n\t\t\tthis.statsHeader = StatsHeaderBuilder.build(this.sprint);\n\t\t\tthis.statsHeader.setKanbanStyle();\n\n\t\t\tDom.append(this.statsHeader.render(), container);\n\t\t}\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderButtonsTo(container);\n\n\t\tif (!this.existActiveSprint())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst robotButton = new RobotButton({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tgroupId: this.getCurrentGroupId(),\n\t\t\tisTaskLimitsExceeded: this.isTaskLimitsExceeded(),\n\t\t\tcanUseAutomation: this.isCanUseAutomation()\n\t\t});\n\n\t\tconst activeSprintActionButton = new ActiveSprintActionButton();\n\t\tactiveSprintActionButton.subscribe('completeSprint', this.onCompleteSprint.bind(this));\n\t\tactiveSprintActionButton.subscribe('showBurnDownChart', this.onShowSprintBurnDownChart.bind(this));\n\n\t\tDom.append(robotButton.render(), container);\n\t\tDom.append(activeSprintActionButton.render(), container);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.setPathToTask(params.pathToTask);\n\t\tthis.setActiveSprintParams(params.activeSprint);\n\t\tthis.setTaskLimitsExceeded(params.taskLimitExceeded);\n\t\tthis.setCanUseAutomation(params.canUseAutomation);\n\n\t\tthis.sprints = new Map();\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tconst sprint = new Sprint(sprintData);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t});\n\n\t\tthis.views = params.views;\n\t}\n\n\tsetPathToTask(pathToTask: string)\n\t{\n\t\tthis.pathToTask = (Type.isString(pathToTask) ? pathToTask : '');\n\t}\n\n\tgetPathToTask(): string\n\t{\n\t\treturn this.pathToTask;\n\t}\n\n\tsetActiveSprintParams(params: SprintParams)\n\t{\n\t\tthis.activeSprint = (Type.isPlainObject(params) ? params : null);\n\t}\n\n\tgetActiveSprintParams(): SprintParams\n\t{\n\t\treturn this.activeSprint;\n\t}\n\n\tsetTaskLimitsExceeded(limitExceeded: string)\n\t{\n\t\tthis.limitExceeded = (limitExceeded === 'Y');\n\t}\n\n\tisTaskLimitsExceeded(): boolean\n\t{\n\t\treturn this.limitExceeded;\n\t}\n\n\tsetCanUseAutomation(canUseAutomation: string)\n\t{\n\t\tthis.canUseAutomation = (canUseAutomation === 'Y');\n\t}\n\n\tisCanUseAutomation(): boolean\n\t{\n\t\treturn this.canUseAutomation;\n\t}\n\n\texistActiveSprint(): boolean\n\t{\n\t\treturn (this.activeSprint !== null);\n\t}\n\n\tbindHandlers()\n\t{\n\t\t// eslint-disable-next-line\n\t\tconst kanbanManager = BX.Tasks.Scrum.Kanban;\n\t\tif (kanbanManager)\n\t\t{\n\t\t\tthis.bindKanbanHandlers(kanbanManager.getKanban());\n\t\t\tkanbanManager.getKanbansGroupedByParentTasks().forEach((kanban) => {\n\t\t\t\tthis.bindKanbanHandlers(kanban);\n\t\t\t});\n\t\t}\n\t}\n\n\tbindKanbanHandlers(kanban)\n\t{\n\t\tthis.onKanbanRender(kanban);\n\n\t\tEventEmitter.subscribe(kanban, 'Kanban.Grid:onItemMoved', (event: BaseEvent) => {\n\t\t\tconst [kanbanItem, targetColumn, beforeItem] = event.getCompatData();\n\t\t\tthis.onItemMoved(kanbanItem, targetColumn, beforeItem);\n\t\t});\n\t}\n\n\tonCompleteSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.sprints,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showCompleteSidePanel(this.sprint);\n\n\t\tthis.sprint.subscribe('showTask', (innerBaseEvent: BaseEvent) => {\n\t\t\tconst item = innerBaseEvent.getData();\n\t\t\tthis.sidePanel.openSidePanelByUrl(this.getPathToTask().replace('#task_id#', item.getSourceId()));\n\t\t});\n\t}\n\n\t/**\n\t * Handles Kanban render.\n\t * @param {BX.Tasks.Kanban.Grid} kanbanGrid\n\t * @returns {void}\n\t */\n\tonKanbanRender(kanbanGrid)\n\t{\n\t\tconst items = kanbanGrid.getItems();\n\t\tconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\t\tfor (let itemId in kanbanGrid.getItems())\n\t\t{\n\t\t\tif (hasOwnProperty.call(items, itemId))\n\t\t\t{\n\t\t\t\tconst item = items[itemId];\n\t\t\t\tif (item.getColumn().getType() === this.finishStatus)\n\t\t\t\t{\n\t\t\t\t\tthis.itemsInFinishStage.set(itemId, '');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Hook on item moved.\n\t * @param {BX.Tasks.Kanban.Item} kanbanItem\n\t * @param {BX.Tasks.Kanban.Column} targetColumn\n\t * @param {BX.Tasks.Kanban.Item} [beforeItem]\n\t * @returns {void}\n\t */\n\tonItemMoved(kanbanItem, targetColumn, beforeItem)\n\t{\n\t\tif (targetColumn.type === this.finishStatus)\n\t\t{\n\t\t\tif (!this.itemsInFinishStage.has(kanbanItem.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedToFinish(kanbanItem, this.sprint);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.itemsInFinishStage.has(kanbanItem.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedFromFinish(kanbanItem, this.sprint);\n\t\t\t}\n\t\t}\n\n\t\tthis.statsHeader.updateStats(this.sprint);\n\t}\n\n\tupdateStatsAfterMovedToFinish(kanbanItem, sprint: Sprint)\n\t{\n\t\tthis.itemsInFinishStage.set(kanbanItem.getId(), kanbanItem.getStoryPoints());\n\n\t\tsprint.getCompletedStoryPoints().addPoints(kanbanItem.getStoryPoints());\n\t\tsprint.getUncompletedStoryPoints().subtractPoints(kanbanItem.getStoryPoints());\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() + 1);\n\t\tsprint.setUncompletedTasks(sprint.getUncompletedTasks() - 1);\n\n\t\tsprint.getItems().forEach((scrumItem: Item) => {\n\t\t\tif (scrumItem.getSourceId() === parseInt(kanbanItem.getId(), 10))\n\t\t\t{\n\t\t\t\tscrumItem.setCompleted('Y');\n\n\t\t\t\tif (scrumItem.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tconst parentItem = sprint.getItemBySourceId(scrumItem.getParentTaskId());\n\t\t\t\t\tif (parentItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst subTasksItems = sprint.getItemsByParentTaskId(parentItem.getSourceId());\n\t\t\t\t\t\tconst unCompletedItem = [...subTasksItems.values()].find((item: Item) => !item.isCompleted());\n\t\t\t\t\t\tif (!unCompletedItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparentItem.setCompleted('Y');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateStatsAfterMovedFromFinish(kanbanItem, sprint: Sprint)\n\t{\n\t\tthis.itemsInFinishStage.delete(kanbanItem.getId());\n\n\t\tsprint.getCompletedStoryPoints().subtractPoints(kanbanItem.getStoryPoints());\n\t\tsprint.getUncompletedStoryPoints().addPoints(kanbanItem.getStoryPoints());\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() - 1);\n\t\tsprint.setUncompletedTasks(sprint.getUncompletedTasks() + 1);\n\n\t\tsprint.getItems().forEach((scrumItem: Item) => {\n\t\t\tif (scrumItem.getSourceId() === parseInt(kanbanItem.getId(), 10))\n\t\t\t{\n\t\t\t\tscrumItem.setCompleted('N');\n\n\t\t\t\tif (scrumItem.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tconst parentItem = sprint.getItemBySourceId(scrumItem.getParentTaskId());\n\t\t\t\t\tif (parentItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst subTasksItems = sprint.getItemsByParentTaskId(parentItem.getSourceId());\n\t\t\t\t\t\tconst unCompletedItem = [...subTasksItems.values()].find((item: Item) => !item.isCompleted());\n\t\t\t\t\t\tif (unCompletedItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparentItem.setCompleted('N');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowSprintBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(this.sprint);\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class BurnDownButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.BurnDownButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-xs\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ACTIVE_SPRINT_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Dom, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\n\nimport {View} from './view';\nimport {BurnDownButton} from './header/burn.down.button';\n\nimport type {Views} from './view';\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\tviews: Views,\n\tcompletedSprint: SprintParams,\n\tsprints: Array<SprintParams>\n}\n\nexport class CompletedSprint extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.CompletedSprint');\n\n\t\tthis.setParams(params);\n\n\t\tthis.bindHandlers();\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderSprintStatsTo(container);\n\n\t\tthis.titleContainer = container;\n\t\tthis.titleContainer.textContent = Text.encode(this.completedSprint.getName());\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderButtonsTo(container);\n\n\t\tconst burnDownButton = new BurnDownButton();\n\t\tburnDownButton.subscribe('click', this.onShowSprintBurnDownChart.bind(this));\n\n\t\tDom.append(burnDownButton.render(), container);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.completedSprint = new Sprint(params.completedSprint);\n\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.sprints = new Map();\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t});\n\t\tthis.views = params.views;\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEventEmitter.subscribe('onTasksGroupSelectorChange', this.onSprintSelectorChange.bind(this));\n\t}\n\n\tonSprintSelectorChange(event: BaseEvent)\n\t{\n\t\tconst [currentSprint] = event.getCompatData()\n\n\t\tthis.completedSprint = this.findSprintBySprintId(currentSprint.sprintId);\n\n\t\tthis.titleContainer.textContent = Text.encode(currentSprint.name);\n\t}\n\n\tonShowSprintBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(this.completedSprint);\n\t}\n\n\tfindSprintBySprintId(sprintId: number): Sprint\n\t{\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === parseInt(sprintId, 10));\n\t}\n}","import {View} from './view/view';\nimport {Plan} from './view/plan';\nimport {ActiveSprint} from './view/active.sprint';\nimport {CompletedSprint} from './view/completed.sprint';\n\ntype Params = {\n\tviewName: string\n}\n\nexport class Entry\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.setParams(params);\n\n\t\tthis.buildView(params);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.setViewName(params.viewName);\n\t}\n\n\tsetViewName(viewName: string)\n\t{\n\t\tconst availableViews = new Set([\n\t\t\t'plan',\n\t\t\t'activeSprint',\n\t\t\t'completedSprint'\n\t\t]);\n\n\t\tif (!availableViews.has(viewName))\n\t\t{\n\t\t\tthrow Error('Invalid value to activeView parameter');\n\t\t}\n\n\t\tthis.viewName = viewName;\n\t}\n\n\tgetViewName(): string\n\t{\n\t\treturn this.viewName;\n\t}\n\n\tsetView(view: View)\n\t{\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.view = view;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.view = null;\n\t\t}\n\t}\n\n\tgetView(): View\n\t{\n\t\treturn this.view;\n\t}\n\n\tbuildView(params: Params)\n\t{\n\t\tconst viewName = this.getViewName();\n\n\t\tif (viewName === 'plan')\n\t\t{\n\t\t\tthis.setView(new Plan(params));\n\t\t}\n\t\telse if (viewName === 'activeSprint')\n\t\t{\n\t\t\tthis.setView(new ActiveSprint(params));\n\t\t}\n\t\telse if (viewName === 'completedSprint')\n\t\t{\n\t\t\tthis.setView(new CompletedSprint(params));\n\t\t}\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderTo(container);\n\t\t}\n\t}\n\n\trenderTabsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderTabsTo(container);\n\t\t}\n\t}\n\n\trenderCountersTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderCountersTo(container);\n\t\t}\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderSprintStatsTo(container);\n\t\t}\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderButtonsTo(container);\n\t\t}\n\t}\n\n\topenEpicEditForm(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.openEpicEditForm(epicId);\n\t\t}\n\t}\n\n\topenEpicViewForm(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.openEpicViewForm(epicId);\n\t\t}\n\t}\n\n\tremoveEpic(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.removeEpic(epicId);\n\t\t}\n\t}\n}"],"names":["RequestSender","options","signedParameters","debugMode","action","data","Promise","resolve","reject","ajax","runAction","then","runComponentAction","mode","sendRequestToComponent","response","alertTitle","Type","isUndefined","errors","console","log","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","Filter","params","setEventNamespace","filterId","requestSender","searchFieldApplied","initUiFilterManager","bindHandlers","filterManager","BX","Main","getById","EventEmitter","subscribe","onApplyFilter","bind","getSearch","getContainer","filterSearchContainer","getSearchContainer","isNodeInViewport","scrollIntoView","event","getCompatData","values","filterInstance","promise","getSearchString","autoResolve","emit","name","item","fieldInstances","getField","fieldOptions","getFieldByName","ITEMS","push","itemsNode","node","querySelector","items","Dom","attr","value","filterApi","getApi","filterFieldsValues","getFilterFieldsValues","setFields","apply","resetFields","forEach","resetFilter","applyFilter","element","rect","getBoundingClientRect","top","left","bottom","window","innerHeight","document","documentElement","clientHeight","right","innerWidth","clientWidth","DiskManager","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","attachedIds","controlId","Text","getRandom","popup","Popup","content","getAttachmentsLoaderContent","autoHide","closeByEsc","angle","show","Disk","UF","add","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","close","filesChooser","Tag","render","addCustomEvent","onFileUploadSuccess","fileResult","uf","file","uploaderFile","element_id","toString","ActionsPanel","actionPanelNodeId","bindElement","itemList","task","activity","attachment","dod","move","sprint","backlog","tags","epic","decomposition","remove","listBlockBlurNodes","Set","getElementById","actionsPanelContainer","calculatePanelPosition","createActionPanel","setBlockBlurNode","append","body","customBlur","hasNode","blockBlurNode","contains","target","Event","unbind","bindItems","actionsPanel","hasClass","lastElementChild","Boolean","showTaskActionButtonNodeId","showAttachmentActionButtonNodeId","showDodActionButtonNodeId","showMoveActionButtonNodeId","sprintActionButtonNodeId","backlogActionButtonNodeId","tagsActionButtonNodeId","epicActionButtonNodeId","decompositionActionButtonNodeId","removeActionButtonNodeId","callback","panel","position","getPosition","fakePanel","cloneNode","style","visibility","isPanelWiderThanViewport","fakePanelRect","windowWidth","zIndex","TaskCounts","setItemId","itemId","setAttachedFilesCount","attachedFilesCount","setCheckListComplete","checkListComplete","setCheckListAll","checkListAll","setTaskCounters","taskCounters","isInteger","parseInt","isString","count","taskCounter","color","indicatorsNodeId","indicatorsNode","attachmentNode","checklistNode","commentsNode","updateVisibility","firstElementChild","textContent","commentCounter","innerCommentCounter","className","encode","showNode","hideNode","StoryPoints","clearPoints","differencePoints","storyPoints","saveDifferencePoints","String","isNaN","parseFloat","currentStoryPoints","inputStoryPoints","result","isFloat","toFixed","firstPoints","secondPoints","Item","setItemParams","groupMode","previewMode","setItemNode","setTmpId","tmpId","setName","setItemType","itemType","setSort","sort","setEntityId","entityId","setEntityType","entityType","setParentId","parentId","setSourceId","sourceId","setInfo","info","setParentTask","isParentTask","setSubTasksCount","subTasksCount","setLinkedTask","isLinkedTask","setParentTaskId","parentTaskId","setSubTask","isSubTask","setSubTasksInfo","subTasksInfo","setResponsible","responsible","setCompleted","completed","setDisableStatus","isCompleted","setAllowedActions","allowedActions","setEpic","setTags","setTaskCounts","setStoryPoints","isNodeCreated","getItemNode","dataset","Error","nameNode","type","setPreviousSort","previousSort","has","isPlainObject","updateResponsible","setPoints","updateStoryPointsNode","Object","getSubTasksInfo","map","subTaskInfo","addPoints","getPoints","storyPointsNode","getStoryPoints","sendEventToUpdateStoryPoints","newSubTasksInfo","isArray","hasOwnProperty","updateCompletedStatus","parentTask","linkedTask","id","subTask","taskCounts","borderColor","setBorderColor","getBorderColor","nameTextNode","disableStatus","moveActivity","status","groupModeContainer","groupModeCheckbox","checked","toggleClass","classList","showActionsPanel","deactivateDragNDrop","removeClass","unbindAll","activateDragNDrop","previewItem","Runtime","clone","itemNode","activatePreviewMode","decompositionMode","addClass","HTMLElement","e","tmpItem","getName","getEntityId","getResponsible","getTaskCounts","updateIndicators","getAttachedFilesCount","getCheckListComplete","getCheckListAll","getTaskCounters","getParentId","setEpicAndTags","getEpic","getTags","getInfo","getSubTasksCount","getParentTaskId","updateParentTaskNodes","itemClassName","renderName","renderIndicators","renderSubTasksCounter","renderResponsible","renderStoryPoints","renderSubTasksTick","renderTags","subTasksCounter","isPreviewMode","getEntityType","subTasksTick","isDecompositionMode","toggle","getEpicTag","getListTagNodes","getContrastYIQ","hexcolor","Label","Color","DEFAULT","replace","r","substr","g","b","yiq","epicLabel","text","size","Size","MD","customClass","container","innerLabel","contrast","isGroupMode","clickToGroupModeCheckbox","tag","tagLabel","TAG_LIGHT","fill","SM","onAfterAppend","onItemClick","onNameClick","responsibleNode","onResponsibleClick","onStoryPointsClick","newCommentsCount","subTasksCounterNode","paramsNode","insertBefore","subTasksTickNode","newSubTasksTickNode","isClickOnEditableName","ignoreTagList","tagName","closest","click","isDisabled","currentTarget","dialog","Dialog","targetNode","enableSearch","context","events","hide","selectedItem","getData","getId","getTitle","photo","src","getAvatar","entities","inviteEmployeeLink","borderNode","valueNode","trim","oldValue","contentEditable","placeCursorAtEnd","blockEnterInput","bindOnce","newValue","getItemId","getItemType","isComposing","keyCode","blur","isShown","stopPropagation","destroy","isEditAllowed","diskManager","ufDiskFilesFieldName","subscribeOnce","baseEvent","showAttachmentMenu","isMovable","isRemoveAllowed","confirm","messageBox","showPanel","updateTagsContainer","newContainer","tagsContainerNode","focus","selection","getSelection","range","createRange","selectNodeContents","collapse","removeAllRanges","addRange","GroupActionsButton","onClick","ListItems","entity","getInput","getItems","TagSearcher","allTags","Map","set","tabs","avatar","epicName","description","get","delete","tagsList","epicList","getCurrentActionsPanel","currentTags","selectedItems","currentTag","createTag","tagDialog","getTagSelector","getTextBoxValue","focusSearch","addTagToSearcher","newTag","getTagFromSearcher","addItem","select","clearTextBox","selectFirstTab","label","choiceWasMade","width","height","multiple","dropdownMode","getTagsList","deselectedItem","tagSelectorOptions","onInput","selector","getDialog","footer","currentEpic","currentEpicInfo","getEpicList","epicId","setTimeout","getSelectedItems","placeholder","inputObject","enteredHashTagName","input","getInputNode","tagsDialog","getNodeId","getNode","offsetWidth","selectedHashTag","hashTags","getHashTagNamesFromText","enteredHashTag","pop","RegExp","deselect","setTagsSearchMode","search","enteredHashEpicName","epicDialog","selectedHashEpic","epicRegExp","setEpicId","setEpicSearchMode","inputText","regex","tagRegExp","matches","match","exec","substring","Input","nodeId","disabled","setNode","onTagSearch","onEpicSearch","onKeydown","inputNode","enteredHashTags","isTagsSearchMode","enteredHashEpics","getHashEpicNamesFromText","isEpicSearchMode","onCreateTaskItem","Entity","setEntityParams","groupModeItems","groupActionsButton","listItems","setId","setViews","views","setNumberTasks","numberTasks","exactSearchApplied","isExactSearchApplied","pageNumberItems","onActivateGroupMode","onDeactivateGroupMode","listItemsNode","getListItemsNode","querySelectorAll","newItem","subscribeToItem","setItemMoveActivity","setMoveActivity","unsubscribeAll","getTarget","parentItem","getItemBySourceId","updateSubTasksPoints","getSourceId","button","getGroupModeItems","groupModeItem","removeItem","removeYourself","addItemToGroupMode","removeItemFromGroupMode","find","hasInput","nextElementSibling","isEqualNode","deactivateGroupMode","disable","unDisable","clear","loader","setActiveLoadItems","IntersectionObserver","observer","entries","isIntersecting","isActiveLoadItems","threshold","observe","activeLoadItems","listPosition","itemsLoaderNode","Loader","offset","Header","getNumberTasks","getElementByClassName","parentNode","elements","elem","EpicCreationButton","Backlog","setBacklogParams","header","epicCreationButton","itemData","bindItemsLoader","updateNumberTasks","backlogData","addHeader","addEpicCreationButton","addGroupActionsButton","addListItems","SprintDate","defaultSprintDuration","getDefaultSprintDuration","isActive","renderNode","getFormattedDateStart","getFormattedDateEnd","dateStart","dateEnd","timestamp","dateStartNode","date","format","dateEndNode","parentPopup","calendar","showCalendar","field","bTime","bSetFocus","bHideTime","updateDateNode","Math","floor","parseDate","getTime","sendRequest","dateStartInput","dateEndInput","sprintId","weekCount","getDateStart","getDateEnd","StatsCalculator","first","second","round","StatsHeader","setSprintData","statsCalculator","weekendDaysTime","getWeekendDaysTime","headerNode","headerClass","kanbanMode","setSprintDate","setCompletedStoryPoints","getCompletedStoryPoints","setUncompletedStoryPoints","getUncompletedStoryPoints","setEndDate","sprintDate","completedStoryPoints","uncompletedStoryPoints","endDate","Date","now","CompletedStatsHeader","percentage","calculatePercentage","completedDate","getCompletedDate","getEndDate","getSprintDate","getFormattedTitleDatePeriod","ExpiredStatsHeader","expiredDay","getExpiredDay","ActiveStatsHeader","remainingDays","getRemainingDays","dateWithWeekendOffset","setSeconds","getSeconds","setHours","msPerMinute","msPerHour","msPerDay","daysRemaining","StatsHeaderBuilder","isExpired","SprintHeader","statsHeader","buttonClass","buttonText","buttonNode","hideContent","isPlanned","addHeaderStats","build","addHeaderDate","firstChild","replaceWith","renderParams","renderDragnDrop","renderRemove","tickAngleClass","renderStatsHeader","createDate","createButton","updateStats","updateDateStartNode","updateDateEndNode","buttonNodeId","onButtonClick","editButtonNode","removeNode","tickButtonNode","sprintHeader","EventsHeader","StoryPointsHeader","inWorkStoryPointsNode","doneStoryPointsNode","renderBurnDownChartIcon","Sprint","setSprintParams","eventsHeader","storyPointsHeader","setDateStart","setDateEnd","setWeekendDaysTime","setDefaultSprintDuration","setStatus","setCompletedTasks","completedTasks","setUncompletedTasks","uncompletedTasks","setItems","initStyle","onChangeName","onRemoveSprint","onChangeSprintDeadline","toggleVisibilityContent","getStatus","sprintEnd","updateNameNode","itemParams","sprintGoal","epics","availableStatus","tmpSprint","addStoryPointsHeader","renderLinkToCompletedSprint","getViews","completedSprint","url","getCompletedTasks","getUncompletedTasks","createInput","setSelectionRange","requestData","getContentNode","display","showContent","upTick","downTick","isEmpty","showSprint","hideSprint","updateStatsHeader","sprintData","addSprintHeader","buildHeader","addEventsHeader","EntityStorage","sprints","entityFrom","recalculateItemsSort","backlogItems","PullCounters","entityStorage","filterService","userId","groupId","task_view","onTaskView","project_read_all","onCommentsReadAll","inputTaskId","TASK_ID","inputUserId","USER_ID","findItemBySourceId","getCurrentState","taskId","updateYourself","catch","showErrorAlert","GROUP_ID","Counters","filter","isOwnerCurrentUser","getFilterManager","updateFields","bindEvents","subscribeToPull","onFilterApply","onCounterClick","Pull","fields","counter","toggleByField","filterField","filterValue","keys","includes","isFilteredByField","isFilteredByFieldValue","extendFilter","getFilterFields","getAttribute","getFields","deleteField","SidePanel","sidePanelManager","Instance","contentSidePanelManager","Manager","contentSidePanels","sliderEvent","sidePanel","getSlider","setCacheable","getUrl","resetBodyWidthHack","addEscapePressHandler","currentSidePanel","manager","getPreviousSlider","topSidePanel","getTopSlider","contentSidePanel","reload","previousSidePanel","open","applyBodyWidthHack","removeEscapePressHandler","frameWindow","getFrameWindow","addEventListener","handleFrameKeyDown","removeEventListener","existFrameTopSlider","Tabs","planTabActiveClass","active","activeTabActiveClass","completedTabActiveClass","tab","getTopSidePanel","showLoader","View","scrumManager","isDomNode","TeamSpeedButton","BurnDownChart","chartDiv","am4core","useTheme","am4themes_animated","chart","create","am4charts","XYChart","paddingRight","createAxises","createIdealLine","createRemainLine","createLegend","categoryAxis","xAxes","CategoryAxis","renderer","grid","template","location","dataFields","category","minGridDistance","valueAxis","yAxes","ValueAxis","min","lineSeries","series","LineSeries","stroke","strokeWidth","categoryX","valueY","circleColor","circleBullet","CircleBullet","circle","radius","bullets","segment","segments","hoverState","states","properties","legend","Legend","itemContainers","clickable","on","processOver","dataItem","dataContext","processOut","hoveredLine","toFront","each","setState","bulletsContainer","dispose","SprintSidePanel","currentSprint","uncompletedItems","lastCompletedSprint","getLastCompletedSprint","sidePanelId","onLoadStartPanel","openSidePanel","contentCallback","buildStartPanel","onLoadCompletePanel","buildCompletePanel","onLoadSprintBurnDownPanel","onCloseBurnDownChart","buildBurnDownPanel","differenceStoryPoints","getDifferenceStoryPointsBetweenSprints","getEpics","form","onLoadStartButtons","buttonsContainer","onStartSprint","buildSprintGoal","buildSprintActions","buildSprintPlan","sprintInfo","listSprintsOptions","getUncompletedItems","getPreviewVersion","differencePercentage","getDifferencePercentageBetweenSprints","percentageNodeClass","absoluteValue","abs","speedInfoMessage","renderSpeed","itemsContainer","onLoadCompleteButtons","onCompleteSprint","getBurnDownChartData","closeLoader","burnDownChart","createChart","destroyBurnDownChart","firstSprint","secondSprint","difference","firstPercentage","secondPercentage","getSprintStartButtons","html","getSprintCompleteButtons","getRequestDataToGetBurnDownChartData","getStartButtons","buttonsHtml","getCompleteButtons","startSprint","getRequestDataToStartSprint","href","removeClockIconFromButton","completeSprint","getRequestDataToCompleteSprint","Confetti","fire","particleCount","spread","origin","x","y","getZindex","directionSelectNode","direction","ItemStyleDesigner","listAllUsedColors","updateBorderColorForLinkedItems","itemIdsToUpdateColor","getAllItems","getAllUsedColors","getRandomColor","getAllColors","updateBorderColorToLinkedItems","fromEntries","updatedItems","findItemByItemId","colorPicker","getColorPicker","allColors","getDefaultColors","defaultColors","randomColor","random","isThisBorderColorAlreadyUse","isAlreadyUse","usedColor","entityIds","getAllEntities","getAllUsedItemBorderColors","ColorPicker","DomBuilder","pageNumberToCompletedSprints","scrumContainer","getBacklog","renderSprintsContainer","getSprints","sprintCreatingButtonNode","sprintCreatingButtonNodeId","sprintCreatingDropZoneNode","sprintCreatingDropZoneNodeId","sprintListNode","sprintListNodeId","createSprint","setDraggable","draggableItems","Draggable","draggable","dragElement","DROP_PREVIEW","delay","dragEndEvent","showDropZoneForSprintCreating","hideDropZoneForSprintCreating","draggableSprints","createCreatingButton","createCreatingDropZone","createSprintsList","sprintsNode","completedSprintLoader","bindLoadCompletedSprints","isSprintSourceEntity","dropZoneNode","getSprintCreatingDropZoneNode","sourceContainer","sourceEntityId","sourceEntity","findEntityByEntityId","isActiveLoadCompletedSprints","onLoadCompletedSprints","pageNumber","getCompletedSprints","createSprints","buildSprint","addSprint","countSprints","children","addContainer","current","newItemNode","bindItemNode","parentElement","SubTasksManager","domBuilder","listSubTasks","visibilityList","hideSubTaskItems","showSubTaskItems","toggleSubTasksTick","getSubTaskItems","listItemParams","listSubTaskItems","subTaskItem","buildSubTaskItem","parentItemNode","setItem","appendItemAfterItem","setVisibility","cleanVisibility","Decomposition","itemStyleDesigner","subTasksCreator","setPlaceholder","addDecomposedItem","isBacklogDecomposition","onDecomposeItem","toggleSubTasks","lastSubTask","getSubTasks","targetItemNode","insertAfter","onCreateItem","isFirstDecomposition","cleanSubTasks","deactivateDecompositionMode","Array","from","decomposedItems","getDecomposedItems","lastDecomposedItem","subTasks","activateDecompositionMode","saveSelectedResponsible","getRandomColorForItemBorder","getParentItem","iterator","next","ItemType","setDodRequired","dodRequired","TypeStorage","types","typeStorage","tabNodes","activeType","previousType","setActiveType","getNextType","sidebarClass","getTypes","renderTab","isEmptyType","addNode","createType","tabClass","isActiveType","tabNode","edit","switchType","changeTypeName","removeType","newType","tmpType","typeNode","savePrevious","setPreviousType","getActiveType","emptyType","Settings","onSwitchType","onCreateType","onChangeTypeName","onRemoveType","addEmptyCreationType","buildEmptyForm","buildEditingForm","renderRequiredOption","checkbox","isDodRequired","updateActiveType","cleanTypeForm","renderEditingForm","listContainer","getDodChecklist","renderEmptyForm","getPreviousType","saveSettings","getSort","createdType","addType","nextType","switchToType","inputType","saveDodSettings","requiredOption","getRequiredOptionValue","getChecklistItems","Tasks","CheckListInstance","treeStructure","getTreeStructure","getRequestData","clean","setEmptyType","DodSidePanel","onLoadSettingsPanel","onCloseSettingsPanel","buildSettingsPanel","dodSettingsRequest","getDodSettings","itemTypes","typeData","settings","renderTo","Chart","scrollbarX","Scrollbar","parent","bottomAxesContainer","createColumn","xAxis","labels","wrap","maxWidth","yAxis","ColumnSeries","paddingBottom","TeamSpeedSidePanel","onLoadTeamSpeedChartPanel","onCloseTeamSpeedChart","buildTeamSpeedPanel","getTeamSpeedChartData","teamSpeedChart","destroyChart","EntityCounters","getEntityCounters","counters","FilterHandler","fadeOutAll","filterInfo","updateExactSearchStatusToEntities","fulfill","filteredItemsData","buildItem","downSubTasksTick","updateVisibilityToEntities","fadeInAll","setExactSearchApplied","isSearchFieldApplied","fadeOut","fadeIn","Epic","tagSearcher","defaultColor","selectedColor","onLoadAddForm","buildAddForm","onLoadEditForm","buildEditForm","onLoadViewForm","buildViewForm","onBeforeGridRequest","onLoadListGrid","destroyGrid","onLoadEditor","onLoadColorPicker","onLoadAddButtons","createEpic","onAfterCreateEpic","isPreviousSidePanelExist","reloadPreviousSidePanel","openEpicsList","onLoadDescription","onLoadFiles","onLoadViewButtons","openEditForm","onLoadEditButtons","editEpic","reloadGrid","gridManager","gridId","instance","getDescriptionEditor","editorHtml","descriptionContainer","editor","LHEPostForm","getHandler","BXHtmlEditor","Get","eventNode","getEpicDescription","filesContainer","getEpicFiles","colorBlockNode","colorNode","picker","getAddEpicFormButtons","getViewEpicFormButtons","list","getEpicsList","responseData","prepareTagsList","openAddForm","getEmptyEpicListForm","eventArgs","sessid","bitrix_sessid","method","getEpicListUrl","getSignedParameters","buildFormHeader","buildFormContainerHeader","editorId","getEpicDescriptionEditor","getViewEpicFormButtonsAction","onColorSelected","backgroundColor","popupOptions","colors","oEditor","GetContent","files","getAttachmentsFiles","arFiles","controllers","fileControllers","controller","fileController","fileId","tagsContainers","tagsContainer","getTagsFromNode","getTagNode","childNodes","childNode","closeTopSidePanel","addEpicToSearcher","addItemToListTypeField","NAME","VALUE","itemEpic","oldEpicInfo","getCurrentEpic","removeEpicFromSearcher","reloadTopSidePanel","PullSprint","listIdsToSkipAdding","listIdsToSkipUpdating","listIdsToSkipRemoving","sprintAdded","onSprintAdded","sprintUpdated","onSprintUpdated","sprintRemoved","onSprintRemoved","needSkipAdd","cleanSkipAdd","createSprintNode","needSkipUpdate","cleanSkipUpdate","moveSprintToActiveListNode","moveSprintToCompletedListNode","needSkipRemove","cleanSkipRemove","removeSprint","getTmpId","ItemMover","entityCounters","source","hideSubTasks","endContainer","endEntityId","onItemMove","onMoveConfirm","itemNodeAfterSourceItem","findEntityByItemId","listToMove","isFirstItem","onclick","menuItem","sortedItems","sortedItemsIds","moveItemToUp","updateItemSort","sortInfo","calculateSort","getMenuWindow","isLastItem","moveItemToDown","showMoveItemMenu","entityWithInput","updateSort","updateItemsSort","updateItem","createNewSprintAndMoveItem","moveTo","moveInCurrentContainer","moveInAnotherContainer","endEntity","moveItemFromEntityToEntity","fromActiveSprint","toActiveSprint","updateEntityCounters","updateCounters","updatedItemsIds","moveToAnotherEntity","listSortInfo","isSortUpdated","updatedItemId","targetEntity","bindButton","isMoveToSprint","isNull","getSprintsAvailableForFilling","showListSprintsToMove","moveToWithGroupMode","entityTo","after","update","batchUpdateItem","entityListNode","onMoveItemUpdate","bindItemSort","isMoveFromAnotherEntity","getPreviousSort","setParentEntity","moveToSprintMenu","getPopupWindow","setBindElement","Menu","isSameSprint","addMenuItem","moveItemMenu","PullItem","itemMover","currentUserId","listToAddAfterUpdate","listIdsToSkipSorting","onCalculateSort","itemAdded","onItemAdded","itemUpdated","onItemUpdated","itemRemoved","onItemRemoved","itemSortUpdated","onItemSortUpdated","comment_add","onCommentAdd","cleanTaskCounts","setDelayedAdd","externalAdd","finally","cleanDelayedAdd","addItemToEntity","isDelayedAdd","itemsSortInfo","itemsToSort","itemsInfoToSort","needSkipSort","itemInfoToSort","targetEntityId","moveToPosition","participants","xmlId","entityXmlId","split","updateParentItem","hasTaskInFilter","isParentChangeAction","prototype","call","addTmpIdToSkipSorting","PullEpic","epicAdded","onEpicAdded","epicUpdated","onEpicUpdated","epicRemoved","onEpicRemoved","epicData","onAfterUpdateEpic","onAfterRemoveEpic","SprintMover","onSprintMove","updateSprintSort","calculateSprintSort","increment","getSprintPlannedListNode","sprintNode","sprintSort","Plan","pathToTask","defaultResponsible","activeSprintId","addBacklog","buildBacklog","pullSprint","addTmpIdToSkipAdding","subscribeToSprint","sprintMover","filterHandler","getCurrentGroupId","pullItem","getCurrentUserId","pullEpic","itemDod","ScrumDod","teamSpeedButton","onShowTeamSpeedChart","onUpdateItem","onShowTask","onMoveItem","onMoveToSprint","onRemoveItem","onChangeTaskResponsible","onOpenAddEpicForm","onOpenListEpicGrid","onOpenDefinitionOfDone","onAttachFilesToTask","onShowDod","onShowTagSearcher","onShowEpicSearcher","onStartDecomposition","onTagsSearchOpen","onTagsSearchClose","onEpicSearchOpen","onEpicSearchClose","onFilterByEpic","onFilterByTag","onLoadItems","onMoveToBacklog","onChangeSprintName","onGetSprintCompletedItems","onShowSprintBurnDownChart","onToggleSubTasks","inputValue","createItem","error","addTmpIdsToSkipAdding","fillItemBeforeCreation","getEpicId","sendRequestToCreateTask","fillItemAfterCreation","updateData","addIdToSkipUpdating","isStoryPointsUpdated","addIdToSkipRemoving","batchRemoveItem","moveItem","changeTaskResponsible","sprintSidePanel","showStartSidePanel","showCompleteSidePanel","changeSprintName","changeSprintDeadline","getSprintCompletedItems","itemsData","showBurnDownChart","openSidePanelByUrl","attachFilesToTask","skipNotificationPopups","showList","actionsPanelButton","showTagsDialog","innerBaseEvent","tasks","batchAttachTagToTask","attachTagToTask","batchDeattachTagToTask","splice","indexOf","deAttachTagToTask","showEpicDialog","batchUpdateItemEpic","updateItemEpic","getLastDecomposedItemNode","addSubTask","decomposeItem","showTagsSearchDialog","closeTagsSearchDialog","currentValue","getValueFromField","setValueToField","scrollToSearchContainer","showEpicSearchDialog","closeEpicSearchDialog","activateGroupMode","showItemsLoader","getPageNumberItems","incrementPageNumberItems","createItemsInEntity","teamSpeedSidePanel","showTeamSpeedChart","updatedEpicInfo","showSettingsPanel","valueWithoutTags","createTask","inputEpic","getEpicByName","openViewForm","epicInfo","ActiveSprintActionButton","completeSprintButtonNode","menuButtonNode","onCompleteSprintClick","onMenuClick","menu","RobotButton","isTaskLimitsExceeded","canUseAutomation","isShowLimitSidePanel","UI","InfoHelper","ActiveSprint","setParams","existActiveSprint","finishStatus","getActiveSprintParams","itemsInFinishStage","setKanbanStyle","robotButton","isCanUseAutomation","activeSprintActionButton","setPathToTask","setActiveSprintParams","activeSprint","setTaskLimitsExceeded","taskLimitExceeded","setCanUseAutomation","limitExceeded","kanbanManager","Scrum","Kanban","bindKanbanHandlers","getKanban","getKanbansGroupedByParentTasks","kanban","onKanbanRender","kanbanItem","targetColumn","beforeItem","onItemMoved","getPathToTask","kanbanGrid","getColumn","getType","updateStatsAfterMovedToFinish","updateStatsAfterMovedFromFinish","subtractPoints","scrumItem","subTasksItems","getItemsByParentTaskId","unCompletedItem","BurnDownButton","CompletedSprint","titleContainer","burnDownButton","onSprintSelectorChange","findSprintBySprintId","Entry","buildView","setViewName","viewName","availableViews","view","getViewName","setView","getView","renderTabsTo","renderCountersTo","renderSprintStatsTo","renderButtonsTo","openEpicEditForm","openEpicViewForm","removeEpic"],"mappings":"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"}