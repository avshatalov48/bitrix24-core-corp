{"version":3,"file":"script.js","sources":["src/utility/request.sender.js","src/service/filter.js","src/utility/counters.js","src/view/header/tabs.js","src/view/view.js","src/view/header/team.speed.button.js","src/service/disk.manager.js","src/item/task/actions.panel.js","src/item/task/taskcounts.js","src/utility/story.points.js","src/item/item.js","src/entity/group.actions.button.js","src/entity/list.items.js","src/utility/tag.searcher.js","src/utility/input.js","src/entity/entity.js","src/entity/backlog/header.js","src/entity/backlog/epic.creation.button.js","src/entity/backlog/backlog.js","src/entity/sprint/sprint.date.js","src/utility/stats.calculator.js","src/entity/sprint/stats.header.js","src/entity/sprint/completed.stats.header.js","src/entity/sprint/expired.stats.header.js","src/entity/sprint/active.stats.header.js","src/entity/sprint/stats.header.builder.js","src/entity/sprint/sprint.header.js","src/entity/sprint/events.header.js","src/entity/sprint/story.points.header.js","src/entity/sprint/sprint.js","src/service/side.panel.js","src/utility/burn.down.chart.js","src/entity/sprint/sprint.side.panel.js","src/utility/entity.storage.js","src/utility/item.style.designer.js","src/utility/dom.builder.js","src/utility/subtasks.manager.js","src/item/task/decomposition.js","src/utility/filter.handler.js","src/utility/epic.js","src/utility/team.speed.chart.js","src/utility/project.side.panel.js","src/utility/pull.sprint.js","src/utility/item.mover.js","src/utility/pull.item.js","src/utility/pull.epic.js","src/utility/sprint.mover.js","src/view/plan.js","src/view/header/active.sprint.action.button.js","src/view/header/robot.button.js","src/view/active.sprint.js","src/view/header/burn.down.button.js","src/view/completed.sprint.js","src/entry.js"],"sourcesContent":["import {ajax, Loc, Type} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tconstructor(options = {})\n\t{\n\t\tthis.signedParameters = (options.signedParameters ? options.signedParameters : '');\n\t\tthis.debugMode = options.debugMode;\n\t}\n\n\tgetSignedParameters(): string\n\t{\n\t\treturn this.signedParameters;\n\t}\n\n\tsendRequest(action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(action, {\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tsendRequestToComponent(data = {}, action): Promise\n\t{\n\t\tdata.debugMode = this.debugMode;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runComponentAction('bitrix:tasks.scrum', action, {\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tbatchUpdateItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchUpdateItem');\n\t}\n\n\tbatchRemoveItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchRemoveItem');\n\t}\n\n\tupdateItemSort(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItemSort');\n\t}\n\n\tupdateSprintSort(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateSprintSort');\n\t}\n\n\tcreateSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createSprint');\n\t}\n\n\tstartSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'startSprint');\n\t}\n\n\tcompleteSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'completeSprint');\n\t}\n\n\tcreateTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createTask');\n\t}\n\n\tupdateItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItem');\n\t}\n\n\tremoveItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeItem');\n\t}\n\n\tchangeTaskResponsible(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeTaskResponsible');\n\t}\n\n\tgetCurrentState(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getCurrentState');\n\t}\n\n\thasTaskInFilter(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'hasTaskInFilter');\n\t}\n\n\tremoveSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeSprint');\n\t}\n\n\tchangeSprintName(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeSprintName');\n\t}\n\n\tchangeSprintDeadline(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeSprintDeadline');\n\t}\n\n\tgetSprintCompletedItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintCompletedItems');\n\t}\n\n\tgetCompletedSprints(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getCompletedSprints');\n\t}\n\n\tgetItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getItems');\n\t}\n\n\tgetEpicDescriptionEditor(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicDescriptionEditor');\n\t}\n\n\tgetEpicDescription(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicDescription');\n\t}\n\n\tgetEpicFiles(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicFiles');\n\t}\n\n\tgetAddEpicFormButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getAddEpicFormButtons');\n\t}\n\n\tgetViewEpicFormButtonsAction(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getViewEpicFormButtons');\n\t}\n\n\tcreateEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createEpic');\n\t}\n\n\tgetEpicsList(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicsList');\n\t}\n\n\tgetEpicListUrl(): string\n\t{\n\t\treturn '/bitrix/services/main/ajax.php?mode=class&c=bitrix:tasks.scrum&action=getEpicsList';\n\t}\n\n\tattachFilesToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'attachFilesToTask');\n\t}\n\n\tattachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'attachTagToTask');\n\t}\n\n\tbatchAttachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchAttachTagToTask');\n\t}\n\n\tdeAttachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'deAttachTagToTask');\n\t}\n\n\tbatchDeattachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchDeattachTagToTask');\n\t}\n\n\tupdateItemEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItemEpic');\n\t}\n\n\tbatchUpdateItemEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchUpdateItemEpic');\n\t}\n\n\tgetEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpic');\n\t}\n\n\teditEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'editEpic');\n\t}\n\n\tremoveEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeEpic');\n\t}\n\n\tapplyFilter(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'applyFilter');\n\t}\n\n\tgetSprintStartButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintStartButtons');\n\t}\n\n\tgetSprintCompleteButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintCompleteButtons');\n\t}\n\n\tgetBurnDownChartData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getBurnDownChartData');\n\t}\n\n\tgetTeamSpeedChartData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getTeamSpeedChartData');\n\t}\n\n\tgetDodPanelData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getDodPanelData');\n\t}\n\n\tgetDodComponent(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getDodComponent');\n\t}\n\n\tgetDodButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getDodButtons');\n\t}\n\n\tsaveDod(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'saveDod');\n\t}\n\n\treadAllTasksComment(data): Promise\n\t{\n\t\treturn this.sendRequest('tasks.task.comment.readAll', data);\n\t}\n\n\tupdateBorderColorToLinkedItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateBorderColorToLinkedItems');\n\t}\n\n\tgetAllUsedItemBorderColors(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getAllUsedItemBorderColors');\n\t}\n\n\tgetSubTaskItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSubTaskItems');\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.log(response);\n\t\t\treturn;\n\t\t}\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {RequestSender} from '../utility/request.sender';\n\ntype ListTypeItem = {\n\tNAME: string,\n\tVALUE: string\n}\n\ntype ValueTypeField = {\n\tname: string,\n\tvalue: string\n}\n\ntype Params = {\n\tfilterId: string,\n\trequestSender?: RequestSender\n}\n\nexport class Filter extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Filter');\n\n\t\tthis.filterId = params.filterId;\n\t\tthis.requestSender = params.requestSender;\n\n\t\tthis.searchFieldApplied = false;\n\n\t\tthis.initUiFilterManager();\n\t\tthis.bindHandlers();\n\t}\n\n\tinitUiFilterManager()\n\t{\n\t\t/* eslint-disable */\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\t\t/* eslint-enable */\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onApplyFilter.bind(this));\n\t}\n\n\tisSearchFieldApplied(): boolean\n\t{\n\t\treturn this.searchFieldApplied;\n\t}\n\n\tgetSearchContainer(): HTMLElement\n\t{\n\t\treturn this.filterManager.getSearch().getContainer();\n\t}\n\n\tscrollToSearchContainer()\n\t{\n\t\tconst filterSearchContainer = this.getSearchContainer();\n\t\tif (!this.isNodeInViewport(filterSearchContainer))\n\t\t{\n\t\t\tfilterSearchContainer.scrollIntoView(true);\n\t\t}\n\t}\n\n\tonApplyFilter(event: BaseEvent)\n\t{\n\t\tconst [filterId, values, filterInstance, promise, params] = event.getCompatData();\n\n\t\tif (filterInstance.getSearch().getSearchString())\n\t\t{\n\t\t\tthis.searchFieldApplied = true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.searchFieldApplied = false;\n\t\t}\n\n\t\tif (this.filterId !== filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams.autoResolve = false;\n\n\t\tthis.emit('applyFilter', {\n\t\t\tpromise: promise\n\t\t});\n\t}\n\n\taddItemToListTypeField(name: string, item: ListTypeItem)\n\t{\n\t\t//todo set item to list after epic crud actions\n\n\t\tconst fieldInstances = this.filterManager.getField(name);\n\t\tconst fieldOptions = this.filterManager.getFieldByName(name);\n\n\t\tif (!fieldInstances || !fieldOptions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfieldInstances.options.ITEMS.push(item);\n\t\tfieldOptions.ITEMS.push(item);\n\n\t\tconst itemsNode = fieldInstances.node.querySelector('[data-name='+name+']');\n\n\t\tconst items = Dom.attr(itemsNode, 'data-items');\n\t\titems.push(item);\n\t\tDom.attr(itemsNode, 'data-items', items);\n\t}\n\n\tsetValueToField(value: ValueTypeField)\n\t{\n\t\tconst filterApi = this.filterManager.getApi();\n\t\tconst filterFieldsValues = this.filterManager.getFilterFieldsValues();\n\n\t\tfilterFieldsValues[value.name] = value.value;\n\n\t\tfilterApi.setFields(filterFieldsValues);\n\t\tfilterApi.apply();\n\t}\n\n\tsetValuesToField(values: ValueTypeField[], resetFields = false)\n\t{\n\t\tconst filterApi = this.filterManager.getApi();\n\n\t\tlet filterFieldsValues = {};\n\t\tif (!resetFields)\n\t\t{\n\t\t\tfilterFieldsValues = this.filterManager.getFilterFieldsValues();\n\t\t}\n\n\t\tvalues.forEach((value) => {\n\t\t\tfilterFieldsValues[value.name] = value.value;\n\t\t});\n\n\t\tfilterApi.setFields(filterFieldsValues);\n\t\tfilterApi.apply();\n\t}\n\n\tgetValueFromField(value: ValueTypeField): string\n\t{\n\t\tconst filterFieldsValues = this.filterManager.getFilterFieldsValues();\n\t\treturn filterFieldsValues[value.name];\n\t}\n\n\tresetFilter()\n\t{\n\t\tthis.filterManager.resetFilter();\n\t}\n\n\tapplyFilter()\n\t{\n\t\tthis.filterManager.applyFilter();\n\t}\n\n\tisNodeInViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\t\treturn (\n\t\t\trect.top >= 0 &&\n\t\t\trect.left >= 0 &&\n\t\t\trect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n\t\t\trect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t);\n\t}\n}","import {Dom, Event, Loc, Tag, Type} from 'main.core';\n\nimport {RequestSender} from './request.sender';\nimport {Filter} from '../service/filter';\n\nimport '../css/counters.css';\n\nexport type CountersData = {\n\ttotal: {\n\t\tcounter: number,\n\t\tcode: number\n\t},\n\texpired: {\n\t\tcounter: number,\n\t\tcode: number\n\t},\n\tnew_comments: {\n\t\tcounter: number,\n\t\tcode: number\n\t}\n}\n\ntype Params = {\n\trequestSender: RequestSender,\n\tfilter: Filter,\n\tcounters: ?CountersData,\n\tisOwnerCurrentUser: boolean,\n\tuserId: number,\n\tgroupId: number\n}\n\nexport class Counters\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.filter = params.filter;\n\t\tthis.counters = (params.counters ? params.counters : null);\n\t\tthis.isOwnerCurrentUser = params.isOwnerCurrentUser;\n\t\tthis.userId = params.userId;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.container = null;\n\t\tthis.node = null;\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Counters: HTMLElement for Counters not found');\n\t\t}\n\n\t\tthis.container = container;\n\n\t\tif (!this.isEmptyCounters())\n\t\t{\n\t\t\tDom.append(this.renderCounters(), this.container);\n\t\t}\n\t}\n\n\tupdateState(counters: ?CountersData)\n\t{\n\t\tthis.counters = counters;\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.destroy();\n\t\t\tif (!this.isEmptyCounters())\n\t\t\t{\n\t\t\t\tDom.append(this.renderCounters(), this.container);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!this.isEmptyCounters())\n\t\t\t{\n\t\t\t\tDom.append(this.renderCounters(), this.container);\n\t\t\t}\n\t\t}\n\t}\n\n\trenderTitle(): HTMLElement\n\t{\n\t\tconst className = this.isEmptyCounters() ? 'tasks-page-name' : 'tasks-counter-page-name';\n\t\tconst text = (\n\t\t\tthis.isOwnerCurrentUser\n\t\t\t\t? Loc.getMessage('TASKS_SCRUM_COUNTER_TOTAL')\n\t\t\t\t: Loc.getMessage('TASKS_SCRUM_COUNTER_TOTAL_EMPL')\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<span class=\"${className}\">${text}</span>\n\t\t`;\n\t}\n\n\trenderCounters(): HTMLElement\n\t{\n\t\tconst newCommentsInfo = this.counters['new_comments'];\n\t\tconst commentsNumber = parseInt(newCommentsInfo.counter, 10);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-counter-container\">\n\t\t\t\t${this.renderTitle()}\n\t\t\t\t<span class=\"tasks-counter-counters\">\n\t\t\t\t\t<span class=\"tasks-comment-icon ui-counter ui-counter-success\">\n\t\t\t\t\t\t<span class=\"ui-counter-inner\">${commentsNumber}</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"tasks-comment-text\">${this.getCommentsLabel(commentsNumber)}</span>\n\t\t\t\t</span>\n\t\t\t\t${this.renderReadAllButton()}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst commentIcon = this.node.querySelector('.tasks-comment-icon');\n\t\tconst commentText = this.node.querySelector('.tasks-comment-text');\n\n\t\tconst onMouseEnter = () => Dom.addClass(commentText, 'tasks-comment-text-hover');\n\t\tconst onMouseLeave = () => Dom.removeClass(commentText, 'tasks-comment-text-hover');\n\n\t\tEvent.bind(commentIcon, 'mouseenter', onMouseEnter);\n\t\tEvent.bind(commentIcon, 'mouseleave', onMouseLeave);\n\t\tEvent.bind(commentText, 'mouseenter', onMouseEnter);\n\t\tEvent.bind(commentText, 'mouseleave', onMouseLeave);\n\n\t\tEvent.bind(commentIcon, 'click', this.applyFilterRequiringAttentionToComments.bind(this));\n\t\tEvent.bind(commentText, 'click', this.applyFilterRequiringAttentionToComments.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\trenderReadAllButton(): HTMLElement\n\t{\n\t\tconst title = Loc.getMessage('TASKS_SCRUM_NEW_COMMENTS_READ_ALL_TITLE');\n\n\t\tconst readAllButton = Tag.render`\n\t\t\t<span class=\"tasks-counter-counter-button\">\n\t\t\t\t<span class=\"tasks-counter-counter-button-icon\"></span>\n\t\t\t\t<span class=\"tasks-counter-counter-button-text\">${title}</span>\n\t\t\t</span>\n\t\t`;\n\n\t\tEvent.bind(readAllButton, 'click', this.onClickReadAll.bind(this));\n\n\t\treturn readAllButton;\n\t}\n\n\tisEmptyCounters(): boolean\n\t{\n\t\treturn !(this.counters && this.counters['new_comments'].counter > 0);\n\t}\n\n\tonClickReadAll()\n\t{\n\t\tthis.requestSender.readAllTasksComment({\n\t\t\tgroupId: this.groupId,\n\t\t\tuserId: this.userId\n\t\t}).then((response) => {\n\t\t\tDom.clean(this.container);\n\t\t\tthis.filter.applyFilter();\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tisNodeCreated(): boolean\n\t{\n\t\treturn (this.node !== null);\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t}\n\n\tgetCommentsLabel(count: number): string\n\t{\n\t\tif (count > 5)\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_COUNTER_NEW_COMMENTS_PLURAL_2');\n\t\t}\n\t\telse if (count === 1)\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_COUNTER_NEW_COMMENTS_PLURAL_0');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_COUNTER_NEW_COMMENTS_PLURAL_1');\n\t\t}\n\t}\n\n\tapplyFilterRequiringAttentionToComments()\n\t{\n\t\tthis.filter.setValuesToField([\n\t\t\t{\n\t\t\t\tname: 'COUNTER_TYPE',\n\t\t\t\tvalue: 'TASKS_COUNTER_TYPE_12582912'\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'PROBLEM',\n\t\t\t\tvalue: '12582912'\n\t\t\t},\n\t\t], true);\n\t}\n}","import {Tag, Text} from 'main.core';\n\nimport type {Views} from '../view';\n\ntype Params = {\n\tviews: Views\n}\n\nexport class Tabs\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.views = params.views;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst planTabActiveClass = (this.views['plan'].active ? 'tasks-scrum-switcher-tab-active' : '');\n\t\tconst activeTabActiveClass = (this.views['activeSprint'].active ? 'tasks-scrum-switcher-tab-active' : '');\n\t\tconst completedTabActiveClass = (this.views['completedSprint'].active ? 'tasks-scrum-switcher-tab-active' : '');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-switcher-views\">\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['plan'].url}\"\n\t\t\t\t\tclass=\"tasks-scrum-switcher-tab ${planTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['plan'].name)}</a>\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['activeSprint'].url}\"\n\t\t\t\t\tclass=\"tasks-scrum-switcher-tab ${activeTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['activeSprint'].name)}</a>\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['completedSprint'].url}\"\n\t\t\t\t\tclass=\"tasks-scrum-switcher-tab ${completedTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['completedSprint'].name)}</a>\n\t\t\t</div>\n\t\t`;\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Filter} from '../service/filter';\n\nimport {RequestSender} from '../utility/request.sender';\nimport {Counters} from '../utility/counters';\n\nimport {Tabs} from './header/tabs';\n\nimport type {CountersData} from '../utility/counters';\n\nimport '../css/base.css';\n\nexport type ViewInfo = {\n\tname: string,\n\turl: string,\n\tactive: boolean\n}\n\nexport type Views = {\n\tplan: ViewInfo,\n\tactiveSprint: ViewInfo,\n\tcompletedSprint: ViewInfo\n}\n\ntype Params = {\n\tsignedParameters: string,\n\tdebugMode: string,\n\tisOwnerCurrentUser: 'Y' | 'N',\n\tuserId: number,\n\tgroupId: number,\n\tcounters?: ?CountersData,\n\tfilterId: string\n}\n\nexport class View extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.View');\n\n\t\tthis.isOwnerCurrentUser = (params.isOwnerCurrentUser === 'Y');\n\n\t\tthis.requestSender = new RequestSender({\n\t\t\tsignedParameters: params.signedParameters,\n\t\t\tdebugMode: params.debugMode\n\t\t});\n\n\t\tthis.filter = new Filter({\n\t\t\tfilterId: params.filterId,\n\t\t\tscrumManager: this,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\n\t\tthis.counters = new Counters({\n\t\t\trequestSender: this.requestSender,\n\t\t\tfilter: this.filter,\n\t\t\tcounters: params.counters,\n\t\t\tuserId: params.userId,\n\t\t\tgroupId: params.groupId,\n\t\t\tisOwnerCurrentUser: params.isOwnerCurrentUser\n\t\t});\n\n\t\tthis.userId = parseInt(params.userId, 10);\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for scrum not found');\n\t\t}\n\t}\n\n\trenderTabsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for tabs not found');\n\t\t}\n\n\t\tconst tabs = new Tabs({\n\t\t\tviews: this.views\n\t\t});\n\n\t\tDom.append(tabs.render(), container);\n\t}\n\n\trenderCountersTo(container: HTMLElement)\n\t{\n\t\tthis.counters.renderTo(container);\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for Sprint stats not found');\n\t\t}\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for buttons not found');\n\t\t}\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn this.userId;\n\t}\n\n\tgetCurrentGroupId(): number\n\t{\n\t\treturn this.groupId;\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class TeamSpeedButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.TeamSpeedButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-button-container\">\n\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-xs\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_BUTTON')}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Loc, Tag, Text} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\n\nimport '../css/disk.manager.css';\n\nexport class DiskManager extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DiskManager');\n\n\t\tthis.diskUrls = {\n\t\t\turlSelect: '/bitrix/tools/disk/uf.php?action=selectFile&SITE_ID=' + Loc.getMessage('SITE_ID'),\n\t\t\turlRenameFile: '/bitrix/tools/disk/uf.php?action=renameFile',\n\t\t\turlDeleteFile: '/bitrix/tools/disk/uf.php?action=deleteFile',\n\t\t\turlUpload: '/bitrix/tools/disk/uf.php?action=uploadFile&ncc=1'\n\t\t};\n\n\t\tthis.attachedIds = [];\n\t}\n\n\tshowAttachmentMenu(node)\n\t{\n\t\tconst controlId = Text.getRandom();\n\n\t\tthis.popup = new Popup(\n\t\t\t`disk-manager-attachment-menu-${Text.getRandom()}`,\n\t\t\tnode,\n\t\t\t{\n\t\t\t\tcontent: this.getAttachmentsLoaderContent(controlId),\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: false,\n\t\t\t});\n\n\t\tthis.popup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: controlId,\n\t\t\tcontrolName: `[${controlId}][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect: this.diskUrls.urlSelect,\n\t\t\turlRenameFile: this.diskUrls.urlRenameFile,\n\t\t\turlDeleteFile: this.diskUrls.urlDeleteFile,\n\t\t\turlUpload: this.diskUrls.urlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.popup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show']\n\t\t);\n\n\t\tEventEmitter.subscribe('onFinish', () => {\n\t\t\tthis.popup.close();\n\t\t\tthis.emit('onFinish', this.attachedIds);\n\t\t});\n\t}\n\n\tgetAttachmentsLoaderContent(controlId)\n\t{\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t<div id=\"diskuf-selectdialog-${controlId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t<div class=\"diskuf-files-block\">\n\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t<input type=\"hidden\" name=\"[${controlId}][]\" value=\"\"/>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<label for=\"file_loader_${controlId}\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${controlId}\" type=\n\t\t\t\t\t\t\t\"file\" multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.onFileUploadSuccess.bind(this));\n\t\t//todo show loader\n\n\t\treturn filesChooser;\n\t}\n\n\tonFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.attachedIds.push(fileResult.element_id.toString());\n\t}\n}","import {Dom, Event, Loc, Tag} from 'main.core';\n\nimport '../../css/actions-panel.css';\n\nexport class ActionsPanel\n{\n\tconstructor(options)\n\t{\n\t\tthis.actionPanelNodeId = 'tasks-scrum-actions-panel';\n\n\t\tthis.bindElement = options.bindElement;\n\n\t\tthis.itemList = {...{\n\t\t\ttask: {activity: false},\n\t\t\tattachment: {activity: false},\n\t\t\tmove: {activity: false},\n\t\t\tsprint: {activity: false},\n\t\t\tbacklog: {activity: false},\n\t\t\ttags: {activity: false},\n\t\t\tepic: {activity: false},\n\t\t\tdecomposition: {activity: false},\n\t\t\tremove: {activity: false},\n\t\t}, ...options.itemList};\n\n\t\tthis.listBlockBlurNodes = new Set();\n\t}\n\n\tshowPanel()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\n\t\tconst actionsPanelContainer = this.calculatePanelPosition(this.createActionPanel());\n\n\t\tthis.setBlockBlurNode(actionsPanelContainer);\n\n\t\tDom.append(actionsPanelContainer, document.body);\n\n\t\tconst customBlur = (event) => {\n\t\t\tlet hasNode = false;\n\t\t\tthis.listBlockBlurNodes.forEach((blockBlurNode) => {\n\t\t\t\tif (blockBlurNode.contains(event.target))\n\t\t\t\t{\n\t\t\t\t\thasNode = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!hasNode)\n\t\t\t{\n\t\t\t\tDom.remove(actionsPanelContainer);\n\t\t\t\tEvent.unbind(document, 'click', customBlur);\n\t\t\t}\n\t\t};\n\t\tEvent.bind(document, 'click', customBlur);\n\n\t\tthis.bindItems();\n\n\t\tconst actionsPanel =  actionsPanelContainer.querySelector('.tasks-scrum-actions-panel');\n\t\tif (Dom.hasClass(actionsPanel.lastElementChild, 'tasks-scrum-actions-panel-separator'))\n\t\t{\n\t\t\tDom.remove(actionsPanel.lastElementChild);\n\t\t}\n\t}\n\n\tsetBlockBlurNode(node)\n\t{\n\t\tthis.listBlockBlurNodes.add(node);\n\t}\n\n\tisShown(): Boolean\n\t{\n\t\treturn Boolean(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tcreateActionPanel()\n\t{\n\t\tlet task = '';\n\t\tlet attachment = '';\n\t\tlet move = '';\n\t\tlet sprint = '';\n\t\tlet backlog = '';\n\t\tlet tags = '';\n\t\tlet epic = '';\n\t\tlet decomposition = '';\n\t\tlet remove = '';\n\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tthis.showTaskActionButtonNodeId = 'tasks-scrum-actions-panel-btn-task';\n\t\t\ttask = Tag.render`\n\t\t\t\t<div id=\"${this.showTaskActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-task\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TASK')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tthis.showAttachmentActionButtonNodeId = 'tasks-scrum-actions-panel-btn-attachment';\n\t\t\tattachment = Tag.render`\n\t\t\t\t<div id=\"${this.showAttachmentActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-attachment\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tthis.showMoveActionButtonNodeId = 'tasks-scrum-actions-panel-btn-move';\n\t\t\tmove = Tag.render`\n\t\t\t\t<div id=\"${this.showMoveActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-move\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tthis.sprintActionButtonNodeId = 'tasks-scrum-actions-panel-btn-sprint';\n\t\t\tsprint = Tag.render`\n\t\t\t\t<div id=\"${this.sprintActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-sprint\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_SPRINT')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tthis.backlogActionButtonNodeId = 'tasks-scrum-actions-panel-btn-backlog';\n\t\t\tbacklog = Tag.render`\n\t\t\t\t<div id=\"${this.backlogActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-backlog\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_BACKLOG')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tthis.tagsActionButtonNodeId = 'tasks-scrum-actions-panel-btn-tags';\n\t\t\ttags = Tag.render`\n\t\t\t\t<div  id=\"${this.tagsActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TAGS')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tthis.epicActionButtonNodeId = 'tasks-scrum-actions-panel-btn-epic';\n\t\t\tepic = Tag.render`\n\t\t\t\t<div  id=\"${this.epicActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_EPIC')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tthis.decompositionActionButtonNodeId = 'tasks-scrum-actions-panel-btn-decomposition';\n\t\t\tdecomposition = Tag.render`\n\t\t\t\t<div  id=\"${this.decompositionActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-decomposition\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tthis.removeActionButtonNodeId = 'tasks-scrum-actions-panel-btn-remove';\n\t\t\tremove = Tag.render`\n\t\t\t\t<div  id=\"${this.removeActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-remove\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.actionPanelNodeId}\" class=\"tasks-scrum-actions-panel-container\">\n\t\t\t\t<div class=\"tasks-scrum-actions-panel\">\n\t\t\t\t\t${task}\n\t\t\t\t\t${attachment}\n\t\t\t\t\t${move}\n\t\t\t\t\t${sprint}\n\t\t\t\t\t${backlog}\n\t\t\t\t\t${tags}\n\t\t\t\t\t${epic}\n\t\t\t\t\t${decomposition}\n\t\t\t\t\t${remove}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tbindItems()\n\t{\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showTaskActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.task.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showAttachmentActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.attachment.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showMoveActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.move.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.sprintActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.sprint.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.backlogActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.backlog.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.tagsActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.tags.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.epicActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.epic.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.removeActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.remove.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.decompositionActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.decomposition.callback\n\t\t\t);\n\t\t}\n\t}\n\n\tcalculatePanelPosition(panel: HTMLElement)\n\t{\n\t\tconst position = Dom.getPosition(this.bindElement);\n\n\t\tconst top = `${position.top}px`;\n\t\tlet left = `${position.left}px`;\n\n\t\tconst fakePanel = panel.cloneNode(true);\n\t\tfakePanel.style.visibility = 'hidden';\n\t\tfakePanel.style.top = `${position.top}px`;\n\t\tfakePanel.style.left = `${position.left}px`;\n\n\t\tDom.append(fakePanel, document.body);\n\t\tif (this.isPanelWiderThanViewport(fakePanel))\n\t\t{\n\t\t\tconst fakePanelRect = fakePanel.getBoundingClientRect();\n\t\t\tconst windowWidth = (window.innerWidth || document.documentElement.clientWidth);\n\t\t\tleft = `${fakePanelRect.left - (fakePanelRect.right - windowWidth + 40)}px`;\n\t\t}\n\t\tDom.remove(fakePanel);\n\n\t\tpanel.style.top = top;\n\t\tpanel.style.left = left;\n\t\tpanel.style.zIndex = 1100;\n\n\t\treturn panel;\n\t}\n\n\tisPanelWiderThanViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\t\tconst windowWidth = (window.innerWidth || document.documentElement.clientWidth);\n\n\t\treturn (rect.right > windowWidth);\n\t}\n}","import {Dom, Tag, Text, Type} from 'main.core';\n\ntype Params = {\n\titemId: number|string,\n\tattachedFilesCount: number,\n\tcheckListComplete: number,\n\tcheckListAll: number,\n\tnewCommentsCount: number\n}\n\nexport class TaskCounts\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.setItemId(params.itemId);\n\t\tthis.setAttachedFilesCount(params.attachedFilesCount);\n\t\tthis.setCheckListComplete(params.checkListComplete);\n\t\tthis.setCheckListAll(params.checkListAll);\n\t\tthis.setNewCommentsCount(params.newCommentsCount);\n\t}\n\n\tsetItemId(itemId: number|string)\n\t{\n\t\tthis.itemId = (\n\t\t\tType.isInteger(itemId) ? parseInt(itemId, 10) :\n\t\t\t\t(Type.isString(itemId) && itemId) ? itemId : Text.getRandom()\n\t\t);\n\t}\n\n\tsetAttachedFilesCount(count: number)\n\t{\n\t\tthis.attachedFilesCount = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetAttachedFilesCount(): number\n\t{\n\t\treturn this.attachedFilesCount;\n\t}\n\n\tsetCheckListComplete(count: number)\n\t{\n\t\tthis.checkListComplete = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetCheckListComplete(): number\n\t{\n\t\treturn this.checkListComplete;\n\t}\n\n\tsetCheckListAll(count: number)\n\t{\n\t\tthis.checkListAll = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetCheckListAll(): number\n\t{\n\t\treturn this.checkListAll;\n\t}\n\n\tsetNewCommentsCount(count: number)\n\t{\n\t\tthis.newCommentsCount = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetNewCommentsCount(): number\n\t{\n\t\treturn this.newCommentsCount;\n\t}\n\n\trenderIndicators(): ?HTMLElement|string\n\t{\n\t\tthis.indicatorsNodeId = 'tasks-scrum-item-indicators-' + this.itemId;\n\t\treturn Tag.render`\n\t\t\t<span id=\"${this.indicatorsNodeId}\" class=\"task-title-indicators\">\n\t\t\t\t<div class=\"task-attachment-counter ui-label ui-label-sm ui-label-light\">\n\t\t\t\t\t<span class=\"ui-label-inner\">${this.attachedFilesCount}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-checklist-counter ui-label ui-label-sm ui-label-light'>\n\t\t\t\t\t<span class='ui-label-inner'>${this.checkListComplete}/${this.checkListAll}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-comments-counter'>\n\t\t\t\t\t<div class='ui-counter ui-counter-success'>\n\t\t\t\t\t\t<div class='ui-counter-inner'>${this.newCommentsCount}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.indicatorsNode = document.getElementById(this.indicatorsNodeId);\n\n\t\tthis.attachmentNode = this.indicatorsNode.querySelector('.task-attachment-counter');\n\t\tthis.checklistNode = this.indicatorsNode.querySelector('.task-checklist-counter');\n\t\tthis.commentsNode = this.indicatorsNode.querySelector('.task-comments-counter');\n\n\t\tthis.updateVisibility();\n\t}\n\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (!this.indicatorsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.attachedFilesCount)\n\t\t{\n\t\t\tthis.attachedFilesCount = parseInt(data.attachedFilesCount, 10);\n\t\t\tthis.attachmentNode.firstElementChild.textContent = this.attachedFilesCount;\n\t\t}\n\t\tif (data.checkListComplete)\n\t\t{\n\t\t\tthis.checkListComplete = parseInt(data.checkListComplete, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\t\tif (data.checkListAll)\n\t\t{\n\t\t\tthis.checkListAll = parseInt(data.checkListAll, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\t\tif (data.newCommentsCount)\n\t\t{\n\t\t\tthis.newCommentsCount = parseInt(data.newCommentsCount, 10);\n\t\t\tconst innerCommentCounter = this.commentsNode.querySelector('.ui-counter-inner');\n\t\t\tinnerCommentCounter.textContent = this.newCommentsCount;\n\t\t}\n\n\t\tthis.updateVisibility();\n\t}\n\n\tupdateVisibility()\n\t{\n\t\tif (this.attachedFilesCount > 0)\n\t\t{\n\t\t\tthis.showNode(this.attachmentNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.attachmentNode);\n\t\t}\n\n\t\tif (this.checkListAll > 0)\n\t\t{\n\t\t\tthis.showNode(this.checklistNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.checklistNode);\n\t\t}\n\n\t\tif (this.newCommentsCount > 0)\n\t\t{\n\t\t\tthis.showNode(this.commentsNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.commentsNode);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'inline-flex');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}","import {Type} from 'main.core';\n\nexport class StoryPoints\n{\n\tconstructor()\n\t{\n\t\tthis.clearPoints();\n\n\t\tthis.differencePoints = 0;\n\t}\n\n\tsetPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.saveDifferencePoints((this.storyPoints ? this.storyPoints : 0), storyPoints);\n\n\t\tthis.storyPoints = String(storyPoints);\n\t}\n\n\tgetPoints(): string\n\t{\n\t\treturn String(this.storyPoints);\n\t}\n\n\taddPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStoryPoints = (this.storyPoints !== '' ? parseFloat(this.storyPoints) : 0);\n\t\tconst inputStoryPoints = parseFloat(storyPoints);\n\n\t\tlet result = (currentStoryPoints + inputStoryPoints);\n\n\t\tif (Type.isFloat(result))\n\t\t{\n\t\t\tresult = result.toFixed(1);\n\t\t}\n\n\t\tthis.storyPoints = String(result);\n\t}\n\n\tsubtractPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStoryPoints = (this.storyPoints !== '' ? parseFloat(this.storyPoints) : 0);\n\t\tconst inputStoryPoints = parseFloat(storyPoints);\n\n\t\tlet result = (currentStoryPoints - inputStoryPoints);\n\n\t\tif (Type.isFloat(result))\n\t\t{\n\t\t\tresult = result.toFixed(1);\n\t\t}\n\n\t\tthis.storyPoints = String(result);\n\t}\n\n\tclearPoints()\n\t{\n\t\tthis.storyPoints = '';\n\t}\n\n\tsaveDifferencePoints(firstPoints: string, secondPoints: string)\n\t{\n\t\tthis.differencePoints = 0;\n\n\t\tif (Type.isUndefined(firstPoints) || isNaN(parseFloat(firstPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isUndefined(secondPoints) || isNaN(parseFloat(secondPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfirstPoints = parseFloat(firstPoints);\n\t\tsecondPoints = parseFloat(secondPoints);\n\n\t\tthis.differencePoints = (secondPoints - firstPoints);\n\t}\n\n\tgetDifferencePoints(): number\n\t{\n\t\treturn this.differencePoints;\n\t}\n}","import {Type, Dom, Event, Tag, Text, Loc, Runtime} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Label} from 'ui.label';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {Dialog} from 'ui.entity-selector';\n\nimport {DiskManager} from '../service/disk.manager';\n\nimport {ActionsPanel} from './task/actions.panel';\nimport {TaskCounts} from './task/taskcounts';\n\nimport {StoryPoints} from '../utility/story.points';\n\nimport '../css/item.css';\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\nexport type EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tinfo: EpicInfoType\n}\n\ntype AllowedActions = {\n\ttask_edit: boolean,\n\ttask_remove: boolean,\n}\n\nexport type Responsible = {\n\tid: number,\n\tname: string,\n\tpathToUser: string,\n\tphoto: {\n\t\tsrc: string\n\t}\n}\n\ntype ItemInfo = {\n\tcolor?: string,\n\tborderColor?: string\n}\n\ntype SubTaskInfo = {\n\tsourceId: number,\n\tcompleted: 'Y' | 'N',\n\tstoryPoints: string | StoryPoints\n}\n\ntype SubTasksInfo = {\n\t[sourceId: number]: SubTaskInfo\n}\n\nexport type ItemParams = {\n\titemId: number|string,\n\ttmpId: string,\n\tname: string,\n\titemType?: string,\n\tsort?: number,\n\tinfo?: ItemInfo,\n\tentityId?: number,\n\tentityType?: string,\n\tparentId?: number,\n\tsourceId?: number,\n\tresponsible?: Responsible,\n\tstoryPoints?: string,\n\tcompleted?: 'Y' | 'N',\n\tallowedActions?: AllowedActions,\n\tepic?: EpicType,\n\ttags?: Array,\n\tisParentTask?: 'Y' | 'N',\n\tsubTasksCount?: number,\n\tsubTasksInfo?: SubTasksInfo,\n\tisLinkedTask?: 'Y' | 'N',\n\tparentTaskId?: number,\n\tisSubTask?: 'Y' | 'N'\n};\n\n//todo single responsibility principle\nexport class Item extends EventEmitter\n{\n\tconstructor(params: ItemParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item');\n\n\t\tthis.setItemParams(params);\n\n\t\tthis.groupMode = false;\n\t\tthis.previewMode = false;\n\t}\n\n\tsetItemParams(params: ItemParams)\n\t{\n\t\tthis.setItemNode();\n\n\t\tthis.setItemId(params.itemId);\n\t\tthis.setTmpId(params.tmpId);\n\t\tthis.setName(params.name);\n\t\tthis.setItemType(params.itemType);\n\t\tthis.setSort(params.sort);\n\t\tthis.setEntityId(params.entityId);\n\t\tthis.setEntityType(params.entityType);\n\t\tthis.setParentId(params.parentId);\n\t\tthis.setSourceId(params.sourceId);\n\t\tthis.setInfo(params.info);\n\n\t\tthis.setParentTask(params.isParentTask);\n\t\tthis.setSubTasksCount(params.subTasksCount);\n\t\tthis.setLinkedTask(params.isLinkedTask);\n\t\tthis.setParentTaskId(params.parentTaskId);\n\t\tthis.setSubTask(params.isSubTask);\n\t\tthis.setSubTasksInfo(params.subTasksInfo);\n\t\tthis.setResponsible(params.responsible);\n\t\tthis.setCompleted(params.completed);\n\t\tthis.setDisableStatus(this.isCompleted());\n\t\tthis.setAllowedActions(params.allowedActions);\n\t\tthis.setEpic(params.epic);\n\t\tthis.setTags(params.tags);\n\t\tthis.setTaskCounts(params);\n\n\t\tthis.setStoryPoints(params.storyPoints);\n\t}\n\n\tstatic buildItem(params: ItemParams): Item\n\t{\n\t\treturn new Item(params);\n\t}\n\n\tsetItemId(itemId: number|string)\n\t{\n\t\tthis.itemId = (\n\t\t\tType.isInteger(itemId) ? parseInt(itemId, 10) :\n\t\t\t\t(Type.isString(itemId) && itemId) ? itemId : Text.getRandom()\n\t\t);\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.getItemNode().dataset.itemId = this.itemId;\n\t\t}\n\t}\n\n\tgetItemId()\n\t{\n\t\treturn this.itemId;\n\t}\n\n\tsetTmpId(tmpId: string)\n\t{\n\t\tthis.tmpId = (Type.isString(tmpId) ? tmpId : '');\n\t}\n\n\tgetTmpId(): string\n\t{\n\t\treturn this.tmpId;\n\t}\n\n\tsetName(name: string)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : 'Name');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name-field');\n\t\t\tnameNode.querySelector('.ui-ctl-element').textContent = Text.encode(this.name);\n\t\t}\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetItemType(type: string)\n\t{\n\t\tthis.itemType = (Type.isString(type) ? type : 'task');\n\t}\n\n\tgetItemType()\n\t{\n\t\treturn this.itemType;\n\t}\n\n\tsetSort(sort: number)\n\t{\n\t\tthis.setPreviousSort(this.sort);\n\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tDom.attr(this.getItemNode(), 'data-sort', this.sort);\n\t\t}\n\t}\n\n\tgetSort(): number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetPreviousSort(sort: number)\n\t{\n\t\tthis.previousSort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\t}\n\n\tgetPreviousSort(): number\n\t{\n\t\treturn this.previousSort;\n\t}\n\n\tsetEntityId(entityId: number)\n\t{\n\t\tthis.entityId = (Type.isInteger(entityId) ? parseInt(entityId, 10) : 0);\n\t}\n\n\tgetEntityId(): number\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tsetEntityType(entityType: string)\n\t{\n\t\tthis.entityType = (new Set(['backlog', 'sprint']).has(entityType) ? entityType : 'backlog');\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.entityType;\n\t}\n\n\tsetParentId(parentId: number)\n\t{\n\t\tthis.parentId = (Type.isInteger(parentId) ? parseInt(parentId, 10) : 0);\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetSourceId(sourceId: number)\n\t{\n\t\tthis.sourceId = (Type.isInteger(sourceId) ? parseInt(sourceId, 10) : 0);\n\t}\n\n\tgetSourceId()\n\t{\n\t\treturn this.sourceId;\n\t}\n\n\tsetResponsible(responsible: Responsible)\n\t{\n\t\tthis.responsible = (Type.isPlainObject(responsible) ? responsible : null);\n\n\t\tif (this.responsible && this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateResponsible();\n\t\t}\n\t}\n\n\tgetResponsible(): Responsible\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.storyPoints)\n\t\t{\n\t\t\tthis.storyPoints = new StoryPoints();\n\t\t}\n\n\t\tthis.storyPoints.setPoints(storyPoints);\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\tif (this.isParentTask())\n\t\t{\n\t\t\tconst storyPoints = new StoryPoints();\n\n\t\t\tObject.values(this.getSubTasksInfo()).map((subTaskInfo: SubTaskInfo) => {\n\t\t\t\tstoryPoints.addPoints(subTaskInfo.storyPoints.getPoints());\n\t\t\t});\n\n\t\t\treturn storyPoints;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.storyPoints;\n\t\t}\n\t}\n\n\tupdateStoryPointsNode()\n\t{\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tconst storyPointsNode = this.getItemNode().querySelector('.tasks-scrum-item-story-points');\n\t\t\tstoryPointsNode.querySelector('.ui-ctl-element').textContent = Text.encode(\n\t\t\t\tthis.getStoryPoints().getPoints()\n\t\t\t);\n\n\t\t\tthis.sendEventToUpdateStoryPoints();\n\t\t}\n\t}\n\n\tsetSubTasksInfo(subTasksInfo: SubTasksInfo)\n\t{\n\t\tif (Type.isUndefined(subTasksInfo))\n\t\t{\n\t\t\tthis.subTasksInfo = [];\n\n\t\t\treturn;\n\t\t}\n\n\t\tObject.values(subTasksInfo).map((subTaskInfo: SubTaskInfo) => {\n\t\t\tconst storyPoints = new StoryPoints();\n\t\t\tstoryPoints.setPoints(subTaskInfo.storyPoints);\n\t\t\tsubTaskInfo.storyPoints = storyPoints;\n\t\t});\n\n\t\tthis.subTasksInfo = subTasksInfo;\n\t}\n\n\tgetSubTasksInfo(): SubTasksInfo\n\t{\n\t\treturn this.subTasksInfo;\n\t}\n\n\tupdateSubTasksPoints(sourceId: number, storyPoints: StoryPoints)\n\t{\n\t\tlet newSubTasksInfo = this.getSubTasksInfo();\n\t\tif (Type.isArray(newSubTasksInfo))\n\t\t{\n\t\t\tnewSubTasksInfo = {};\n\t\t\tnewSubTasksInfo[sourceId] = {\n\t\t\t\tsourceId: sourceId,\n\t\t\t\tcompleted: 'N',\n\t\t\t\tstoryPoints: storyPoints.getPoints()\n\t\t\t};\n\t\t\tthis.setSubTasksInfo(newSubTasksInfo);\n\n\t\t\tthis.updateStoryPointsNode();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst subTasksInfo = this.getSubTasksInfo();\n\n\t\tif (subTasksInfo.hasOwnProperty(sourceId))\n\t\t{\n\t\t\tsubTasksInfo[sourceId].storyPoints = storyPoints;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsubTasksInfo[sourceId] = {\n\t\t\t\tsourceId: sourceId,\n\t\t\t\tcompleted: 'N',\n\t\t\t\tstoryPoints: storyPoints\n\t\t\t};\n\t\t}\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetCompletedSubTasksStoryPoints(): StoryPoints\n\t{\n\t\tconst storyPoints = new StoryPoints();\n\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tstoryPoints.setPoints(this.storyPoints.getPoints());\n\t\t}\n\n\t\tObject.values(this.getSubTasksInfo()).map((subTaskInfo: SubTaskInfo) => {\n\t\t\tif (subTaskInfo.completed === 'Y')\n\t\t\t{\n\t\t\t\tstoryPoints.addPoints(subTaskInfo.storyPoints.getPoints());\n\t\t\t}\n\t\t});\n\n\t\treturn storyPoints;\n\t}\n\n\tgetUncompletedSubTasksStoryPoints(): StoryPoints\n\t{\n\t\tconst storyPoints = new StoryPoints();\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tstoryPoints.setPoints(this.storyPoints.getPoints());\n\t\t}\n\n\t\tObject.values(this.getSubTasksInfo()).map((subTaskInfo: SubTaskInfo) => {\n\t\t\tif (subTaskInfo.completed === 'N')\n\t\t\t{\n\t\t\t\tstoryPoints.addPoints(subTaskInfo.storyPoints.getPoints());\n\t\t\t}\n\t\t});\n\n\t\treturn storyPoints;\n\t}\n\n\tsetCompleted(value: string)\n\t{\n\t\tthis.completed = (value === 'Y');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateCompletedStatus();\n\t\t}\n\t}\n\n\tsetAllowedActions(allowedActions: AllowedActions)\n\t{\n\t\tthis.allowedActions = (Type.isPlainObject(allowedActions) ? allowedActions : {});\n\t}\n\n\tsetEpic(epic: EpicType)\n\t{\n\t\tthis.epic = (Type.isPlainObject(epic) ? epic : null);\n\t}\n\n\tgetEpic(): EpicType\n\t{\n\t\treturn this.epic;\n\t}\n\n\tsetTags(tags)\n\t{\n\t\tthis.tags = (Type.isArray(tags) ? tags : []);\n\t}\n\n\tgetTags(): Array\n\t{\n\t\treturn this.tags;\n\t}\n\n\tsetParentTask(value: string)\n\t{\n\t\tthis.parentTask = (value === 'Y');\n\t}\n\n\tisParentTask(): boolean\n\t{\n\t\treturn this.parentTask;\n\t}\n\n\tsetSubTasksCount(count: number)\n\t{\n\t\tthis.subTasksCount = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetSubTasksCount(): number\n\t{\n\t\treturn this.subTasksCount;\n\t}\n\n\tsetLinkedTask(value: string)\n\t{\n\t\tthis.linkedTask = (value === 'Y');\n\t}\n\n\tisLinkedTask(): boolean\n\t{\n\t\treturn this.linkedTask;\n\t}\n\n\tsetParentTaskId(id: number)\n\t{\n\t\tthis.parentTaskId = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\t}\n\n\tgetParentTaskId(): number\n\t{\n\t\treturn this.parentTaskId;\n\t}\n\n\tsetSubTask(value: string)\n\t{\n\t\tthis.subTask = (value === 'Y');\n\t}\n\n\tisSubTask(): boolean\n\t{\n\t\treturn this.subTask;\n\t}\n\n\tsetTaskCounts(params: ItemParams)\n\t{\n\t\tthis.taskCounts = (this.itemType === 'task' ? new TaskCounts(params) : null);\n\t}\n\n\tgetTaskCounts(): TaskCounts|null\n\t{\n\t\treturn this.taskCounts;\n\t}\n\n\tsetInfo(info: ?ItemInfo)\n\t{\n\t\tif (Type.isUndefined(info))\n\t\t{\n\t\t\tthis.info = {\n\t\t\t\tcolor: '',\n\t\t\t\tborderColor: ''\n\t\t\t};\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.info = info;\n\n\t\tthis.setBorderColor(this.info.borderColor);\n\t}\n\n\tgetInfo(): ?ItemInfo\n\t{\n\t\treturn this.info;\n\t}\n\n\tsetBorderColor(color: string)\n\t{\n\t\tthis.info.borderColor = (Type.isString(color) ? color : '');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tif (this.getBorderColor())\n\t\t\t{\n\t\t\t\tDom.style(this.getItemNode(), 'border', '2px solid ' + this.getBorderColor());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.style(this.getItemNode(), 'border', null);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetBorderColor(): string\n\t{\n\t\treturn (Type.isString(this.info.borderColor) ? this.info.borderColor : '');\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn this.completed;\n\t}\n\n\tupdateCompletedStatus()\n\t{\n\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name');\n\t\tconst nameTextNode = nameNode.querySelector('.ui-ctl-element');\n\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tDom.style(nameTextNode, 'textDecoration', 'line-through');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(nameTextNode, 'textDecoration', null);\n\t\t}\n\n\t\tthis.sendEventToUpdateStoryPoints();\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn this.disableStatus;\n\t}\n\n\tsetMoveActivity(value: boolean)\n\t{\n\t\tthis.moveActivity = Boolean(value);\n\t}\n\n\tisMovable(): boolean\n\t{\n\t\treturn this.moveActivity;\n\t}\n\n\tsetDisableStatus(status: boolean)\n\t{\n\t\tthis.disableStatus = Boolean(status);\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (status)\n\t\t{\n\t\t\tthis.hideNode(this.getItemNode().querySelector('.tasks-scrum-dragndrop'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showNode(this.getItemNode().querySelector('.tasks-scrum-dragndrop'));\n\t\t}\n\t}\n\n\tactivateGroupMode()\n\t{\n\t\tthis.groupMode = true;\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\tconst groupModeCheckbox = groupModeContainer.querySelector('input');\n\t\tgroupModeCheckbox.checked = false;\n\n\t\tEvent.bind(groupModeCheckbox, 'change', (event) => {\n\t\t\tDom.toggleClass(this.getItemNode(), 'tasks-scrum-item-group-mode');\n\t\t\tif (this.getItemNode().classList.contains('tasks-scrum-item-group-mode'))\n\t\t\t{\n\t\t\t\tthis.emit('addItemToGroupMode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emit('removeItemFromGroupMode');\n\t\t\t}\n\t\t\tthis.showActionsPanel(event);\n\t\t});\n\n\t\tthis.showNode(groupModeContainer);\n\n\t\tthis.deactivateDragNDrop();\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getItemNode(), 'tasks-scrum-item-group-mode');\n\n\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\tthis.hideNode(groupModeContainer);\n\n\t\tEvent.unbindAll(groupModeContainer.querySelector('input'));\n\n\t\tthis.groupMode = false;\n\n\t\tthis.activateDragNDrop();\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\tactivatePreviewMode()\n\t{\n\t\tthis.previewMode = true;\n\t}\n\n\tisPreviewMode(): boolean\n\t{\n\t\treturn this.previewMode;\n\t}\n\n\tgetPreviewVersion(): Item\n\t{\n\t\tconst previewItem = Runtime.clone(this);\n\t\tpreviewItem.setItemId();\n\t\tpreviewItem.itemNode = null;\n\t\tif (previewItem.taskCounts)\n\t\t{\n\t\t\tpreviewItem.taskCounts = new TaskCounts(previewItem);\n\t\t}\n\t\tpreviewItem.activatePreviewMode();\n\t\treturn previewItem;\n\t}\n\n\tactivateDecompositionMode(color: string)\n\t{\n\t\tthis.decompositionMode = true;\n\n\t\tif (this.getBorderColor() === '')\n\t\t{\n\t\t\tthis.setBorderColor(color);\n\t\t}\n\n\t\tif (this.getBorderColor())\n\t\t{\n\t\t\tDom.style(this.getItemNode(), 'border', '2px solid ' + this.getBorderColor());\n\t\t}\n\n\t\tthis.deactivateDragNDrop();\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.decompositionMode = false;\n\n\t\tif (this.getBorderColor() === '')\n\t\t{\n\t\t\tthis.setBorderColor();\n\t\t\tDom.style(this.getItemNode(), 'border', null);\n\t\t}\n\n\t\tthis.activateDragNDrop();\n\t}\n\n\tactivateDragNDrop()\n\t{\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tif (!this.getItemNode().classList.contains('tasks-scrum-item-drag'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.getItemNode(), 'tasks-scrum-item-drag');\n\t\t\t}\n\t\t}\n\t}\n\n\tdeactivateDragNDrop()\n\t{\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tDom.removeClass(this.getItemNode(), 'tasks-scrum-item-drag');\n\t\t}\n\t}\n\n\tisDecompositionMode(): boolean\n\t{\n\t\treturn this.decompositionMode;\n\t}\n\n\tsetItemNode(node?: HTMLElement)\n\t{\n\t\ttry\n\t\t{\n\t\t\tthis.itemNode = ((node instanceof HTMLElement) ? node : null);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tthis.itemNode = null;\n\t\t}\n\t}\n\n\tgetItemNode(): HTMLElement|null\n\t{\n\t\treturn this.itemNode;\n\t}\n\n\tisNodeCreated(): boolean\n\t{\n\t\treturn (this.itemNode !== null);\n\t}\n\n\tsetParentEntity(entityId: number, entityType: string)\n\t{\n\t\tthis.setEntityId(entityId);\n\t\tthis.setEntityType(entityType);\n\t}\n\n\tisEditAllowed(): boolean\n\t{\n\t\treturn Boolean(this.allowedActions['task_edit']);\n\t}\n\n\tisRemoveAllowed(): boolean\n\t{\n\t\treturn Boolean(this.allowedActions['task_remove']);\n\t}\n\n\tupdateYourself(tmpItem: Item)\n\t{\n\t\tif (tmpItem.getName() !== this.getName())\n\t\t{\n\t\t\tthis.setName(tmpItem.getName());\n\t\t}\n\t\tif (tmpItem.getEntityId() !== this.getEntityId())\n\t\t{\n\t\t\tthis.setEntityId(tmpItem.getEntityId());\n\t\t}\n\t\tif (tmpItem.getResponsible().id !== this.getResponsible().id)\n\t\t{\n\t\t\tthis.setResponsible(tmpItem.getResponsible());\n\t\t}\n\t\tif (tmpItem.getStoryPoints().getPoints() !== this.getStoryPoints().getPoints())\n\t\t{\n\t\t\tthis.setStoryPoints(tmpItem.getStoryPoints().getPoints());\n\t\t}\n\t\tif (this.getTaskCounts() && tmpItem.getTaskCounts())\n\t\t{\n\t\t\tthis.getTaskCounts().updateIndicators({\n\t\t\t\tattachedFilesCount: tmpItem.getTaskCounts().getAttachedFilesCount(),\n\t\t\t\tcheckListComplete: tmpItem.getTaskCounts().getCheckListComplete(),\n\t\t\t\tcheckListAll: tmpItem.getTaskCounts().getCheckListAll(),\n\t\t\t\tnewCommentsCount: tmpItem.getTaskCounts().getNewCommentsCount(),\n\t\t\t});\n\t\t}\n\t\tif (tmpItem.isCompleted() !== this.isCompleted())\n\t\t{\n\t\t\tthis.setCompleted(tmpItem.isCompleted() ? 'Y' : 'N')\n\t\t}\n\n\t\tthis.setParentId(tmpItem.getParentId());\n\t\tthis.setEpicAndTags(tmpItem.getEpic(), tmpItem.getTags());\n\t\tthis.setInfo(tmpItem.getInfo());\n\n\t\tthis.setParentTask(tmpItem.isParentTask() ? 'Y' : 'N');\n\t\tthis.setSubTasksCount(tmpItem.getSubTasksCount());\n\t\tthis.setLinkedTask(tmpItem.isLinkedTask() ? 'Y' : 'N');\n\t\tthis.setParentTaskId(tmpItem.getParentTaskId());\n\t\tthis.setSubTask(tmpItem.isSubTask() ? 'Y' : 'N');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateParentTaskNodes();\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.getItemNode());\n\t\tthis.setItemNode();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet itemClassName = 'tasks-scrum-item';\n\t\tif (this.isSubTask())\n\t\t{\n\t\t\titemClassName += ' tasks-scrum-subtask-item'\n\t\t}\n\n\t\tthis.itemNode = Tag.render`\n\t\t\t<div data-item-id=\"${Text.encode(this.itemId)}\" data-sort=\n\t\t\t\t\"${Text.encode(this.sort)}\" class=\"${itemClassName}\">\n\t\t\t\t<div class=\"tasks-scrum-item-inner\">\n\t\t\t\t\t<div class=\"tasks-scrum-item-group-mode-container\">\n\t\t\t\t\t\t<input type=\"checkbox\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-item-name\">\n\t\t\t\t\t\t${this.renderName()}\n\t\t\t\t\t\t${(this.taskCounts && this.itemType === 'task' ? this.taskCounts.renderIndicators() : '')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-item-params\">\n\t\t\t\t\t\t${this.renderSubTasksCounter()}\n\t\t\t\t\t\t${this.renderResponsible()}\n\t\t\t\t\t\t${this.renderStoryPoints()}\n\t\t\t\t\t\t${this.renderSubTasksTick()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.renderTags()}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.isNodeCreated() && this.getBorderColor())\n\t\t{\n\t\t\tDom.style(this.itemNode, 'border', '2px solid ' + this.getBorderColor());\n\t\t}\n\n\t\treturn this.itemNode;\n\t}\n\n\trenderName(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-name-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-no-border\">\n\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t${Text.encode(this.name)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderResponsible(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"ui-icon ui-icon-common-user tasks-scrum-item-responsible\"><i></i></div>`;\n\t}\n\n\trenderStoryPoints(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-story-points\">\n\t\t\t\t<div class=\"tasks-scrum-item-story-points-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-auto ui-ctl-no-border\">\n\t\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t\t${Text.encode(this.getStoryPoints().getPoints())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderSubTasksCounter(): HTMLElement\n\t{\n\t\tif (!this.isParentTask())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst subTasksCounter = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-subtasks-btn\">\n\t\t\t\t<span class=\"tasks-scrum-item-subtasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-item-subtasks-count\">\n\t\t\t\t\t${this.getSubTasksCount()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(subTasksCounter, 'click', () => {\n\t\t\tthis.emit('showTask');\n\t\t});\n\n\t\treturn subTasksCounter;\n\t}\n\n\trenderSubTasksTick(): HTMLElement\n\t{\n\t\tif (!this.isParentTask() || this.isPreviewMode())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tif (this.getEntityType() === 'backlog')\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst subTasksTick = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-subtasks-tick\">\n\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ui-btn-icon-angle-down\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(subTasksTick, 'click', () => {\n\t\t\tif (!this.isDecompositionMode())\n\t\t\t{\n\t\t\t\tthis.emit('toggleSubTasks');\n\t\t\t}\n\t\t});\n\n\t\treturn subTasksTick;\n\t}\n\n\ttoggleSubTasksTick()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst subTasksTick = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\n\t\tif (subTasksTick)\n\t\t{\n\t\t\tsubTasksTick.firstElementChild.classList.toggle('ui-btn-icon-angle-up');\n\t\t\tsubTasksTick.firstElementChild.classList.toggle('ui-btn-icon-angle-down');\n\t\t}\n\t}\n\n\trenderTags(): ?HTMLElement|string\n\t{\n\t\tif (this.epic === null && this.tags.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEpicTag(): ?HTMLElement\n\t{\n\t\tif (this.epic === null)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst getContrastYIQ = (hexcolor) => {\n\t\t\tif (!hexcolor)\n\t\t\t{\n\t\t\t\thexcolor = Label.Color.DEFAULT;\n\t\t\t}\n\t\t\thexcolor = hexcolor.replace('#', '');\n\t\t\tconst r = parseInt(hexcolor.substr(0, 2), 16);\n\t\t\tconst g = parseInt(hexcolor.substr(2, 2), 16);\n\t\t\tconst b = parseInt(hexcolor.substr(4, 2), 16);\n\t\t\tconst yiq = ((r * 299 ) + (g* 587 ) + (b * 114)) / 1000;\n\t\t\treturn (yiq >= 128) ? 'black' : 'white';\n\t\t};\n\n\t\tconst epicLabel = new Label({\n\t\t\ttext: this.epic.name,\n\t\t\tcolor: Label.Color.DEFAULT,\n\t\t\tsize: Label.Size.MD,\n\t\t\tcustomClass: 'tasks-scrum-item-epic-label'\n\t\t});\n\t\tconst container = epicLabel.getContainer();\n\t\tconst innerLabel = container.querySelector('.ui-label-inner');\n\n\t\tconst contrast = getContrastYIQ(this.epic.info.color);\n\t\tif (contrast === 'white')\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#ffffff');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#525c69');\n\t\t}\n\t\tDom.style(container, 'backgroundColor', this.epic.info.color);\n\n\t\tEvent.bind(container, 'click', (event) => {\n\t\t\tif (this.isGroupMode())\n\t\t\t{\n\t\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\t\tthis.showActionsPanel(event);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emit('filterByEpic', this.epic.id);\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tgetListTagNodes(): HTMLElement\n\t{\n\t\treturn this.tags.map((tag) => {\n\t\t\tconst tagLabel = new Label({\n\t\t\t\ttext: tag,\n\t\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\t\tfill: true,\n\t\t\t\tsize: Label.Size.SM,\n\t\t\t\tcustomClass: ''\n\t\t\t});\n\t\t\tconst container = tagLabel.getContainer();\n\t\t\tEvent.bind(container, 'click', (event) => {\n\t\t\t\tif (this.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\t\t\tthis.showActionsPanel(event);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.emit('filterByTag', tag);\n\t\t\t});\n\t\t\treturn container;\n\t\t});\n\t}\n\n\t// todo remove all method\n\tonAfterAppend(container)\n\t{\n\t\tthis.setItemNode(container.querySelector('[data-item-id=\"'+this.itemId+'\"]'));\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.onAfterAppend();\n\t\t}\n\n\t\tthis.updateResponsible();\n\n\t\tif (this.isPreviewMode())\n\t\t{\n\t\t\tEvent.bind(this.getItemNode(), 'click', () => this.emit('showTask'));\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isDecompositionMode())\n\t\t{\n\t\t\tthis.activateDragNDrop();\n\t\t}\n\n\t\tif (this.isSubTask())\n\t\t{\n\t\t\tthis.deactivateDragNDrop();\n\t\t}\n\n\t\tEvent.unbindAll(this.getItemNode());\n\t\tEvent.bind(this.getItemNode(), 'click', this.onItemClick.bind(this));\n\n\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name');\n\t\tEvent.unbindAll(nameNode);\n\t\tEvent.bind(nameNode, 'click', this.onNameClick.bind(this));\n\n\t\tconst responsibleNode = this.getItemNode().querySelector('.tasks-scrum-item-responsible');\n\t\tEvent.unbindAll(responsibleNode);\n\t\tEvent.bind(responsibleNode, 'click', this.onResponsibleClick.bind(this));\n\n\t\tconst storyPointsNode = this.getItemNode().querySelector('.tasks-scrum-item-story-points');\n\t\tEvent.unbindAll(storyPointsNode);\n\t\tEvent.bind(storyPointsNode, 'click', this.onStoryPointsClick.bind(this));\n\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tconst nameTextNode = nameNode.querySelector('.ui-ctl-element');\n\t\t\tDom.style(nameTextNode, 'textDecoration', 'line-through');\n\t\t}\n\n\t\tthis.updateParentTaskNodes();\n\t}\n\n\tisShowIndicators(): Boolean\n\t{\n\t\treturn Boolean(this.attachedFilesCount || this.checkListAll || this.newCommentsCount);\n\t}\n\n\tupdateParentTaskNodes()\n\t{\n\t\tif (this.isParentTask())\n\t\t{\n\t\t\tconst subTasksCounterNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-btn');\n\t\t\tif (subTasksCounterNode)\n\t\t\t{\n\t\t\t\tDom.replace(subTasksCounterNode, this.renderSubTasksCounter());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst paramsNode = this.getItemNode().querySelector('.tasks-scrum-item-params');\n\t\t\t\tconst subTasksCounterNode = this.renderSubTasksCounter();\n\t\t\t\tDom.insertBefore(subTasksCounterNode, paramsNode.firstElementChild);\n\t\t\t}\n\n\t\t\tconst subTasksTickNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\t\t\tif (subTasksTickNode)\n\t\t\t{\n\t\t\t\tconst newSubTasksTickNode = this.renderSubTasksTick();\n\t\t\t\tif (newSubTasksTickNode)\n\t\t\t\t{\n\t\t\t\t\tDom.replace(subTasksTickNode, newSubTasksTickNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.remove(subTasksTickNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst paramsNode = this.getItemNode().querySelector('.tasks-scrum-item-params');\n\t\t\t\tconst newSubTasksTickNode = this.renderSubTasksTick();\n\t\t\t\tDom.append(newSubTasksTickNode, paramsNode);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst subTasksCounterNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-btn');\n\t\t\tif (subTasksCounterNode)\n\t\t\t{\n\t\t\t\tDom.remove(subTasksCounterNode);\n\t\t\t}\n\t\t\tconst subTasksTickNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\t\t\tif (subTasksTickNode)\n\t\t\t{\n\t\t\t\tDom.remove(subTasksTickNode);\n\t\t\t}\n\t\t}\n\t}\n\n\tonItemClick(event)\n\t{\n\t\tif (this.isClickOnEditableName(event))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst ignoreTagList = new Set(['I', 'SPAN', 'INPUT']);\n\t\tif (ignoreTagList.has(event.target.tagName))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.target.closest('.tasks-scrum-item-subtasks-tick'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clickToGroupModeCheckbox();\n\n\t\tthis.showActionsPanel(event);\n\t}\n\n\tisClickOnEditableName(event): boolean\n\t{\n\t\treturn (event.target.classList.contains('ui-ctl-element'));\n\t}\n\n\tonNameClick(event)\n\t{\n\t\tif (event.target.classList.contains('ui-ctl-element'))\n\t\t{\n\t\t\tthis.emit('showTask');\n\t\t}\n\t}\n\n\tclickToGroupModeCheckbox()\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\t\tconst groupModeCheckbox = groupModeContainer.querySelector('input');\n\t\t\tgroupModeCheckbox.click();\n\t\t}\n\t}\n\n\tonResponsibleClick(event)\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst responsibleNode = event.currentTarget;\n\n\t\tconst dialog = new Dialog({\n\t\t\ttargetNode: responsibleNode,\n\t\t\tenableSearch: true,\n\t\t\tcontext: 'TASKS',\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tthis.responsible = {\n\t\t\t\t\t\tid: selectedItem.getId(),\n\t\t\t\t\t\tname: selectedItem.getTitle(),\n\t\t\t\t\t\tphoto: {\n\t\t\t\t\t\t\tsrc: selectedItem.getAvatar()\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tthis.updateResponsible();\n\t\t\t\t\tthis.emit('changeTaskResponsible');\n\n\t\t\t\t},\n\t\t\t},\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'user',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tinviteEmployeeLink: false\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'department'\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\n\t\tdialog.show();\n\t}\n\n\tonStoryPointsClick(event)\n\t{\n\t\tif (this.isGroupMode() || this.isDisabled() || this.isCompleted() || this.isParentTask())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tconst storyPointsNode = event.currentTarget;\n\t\tconst borderNode = storyPointsNode.querySelector('.ui-ctl');\n\t\tconst valueNode = storyPointsNode.querySelector('.ui-ctl-element');\n\t\tvalueNode.textContent = valueNode.textContent.trim();\n\t\tconst oldValue = valueNode.textContent.trim();\n\n\t\tif (valueNode.contentEditable === 'true')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\tvalueNode.contentEditable = 'true';\n\n\t\tthis.placeCursorAtEnd(valueNode);\n\n\t\tEvent.bind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\tEvent.bindOnce(valueNode, 'blur', () => {\n\t\t\tEvent.unbind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\t\tvalueNode.contentEditable = 'false';\n\n\t\t\tconst newValue = valueNode.textContent.trim();\n\t\t\tif (newValue && oldValue === newValue)\n\t\t\t{\n\t\t\t\tvalueNode.textContent = oldValue;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.emit('updateItem', {\n\t\t\t\titemId: this.getItemId(),\n\t\t\t\tentityId: this.getEntityId(),\n\t\t\t\titemType: this.getItemType(),\n\t\t\t\tstoryPoints: newValue\n\t\t\t});\n\n\t\t\tthis.setStoryPoints(newValue);\n\t\t}, true);\n\t}\n\n\tsendEventToUpdateStoryPoints()\n\t{\n\t\tthis.emit('updateStoryPoints');\n\t}\n\n\tblockEnterInput(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.blur();\n\t\t\treturn;\n\t\t}\n\t};\n\n\tshowActionsPanel(event)\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown() && !this.isGroupMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t}\n\n\t\tthis.actionsPanel = new ActionsPanel({\n\t\t\tbindElement: this.getItemNode(),\n\t\t\titemList: {\n\t\t\t\ttask: {\n\t\t\t\t\tactivity: (this.itemType === 'task' && !this.isGroupMode()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('showTask');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tattachment: {\n\t\t\t\t\tactivity: (!this.isDisabled() && this.isEditAllowed() && !this.isGroupMode()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tconst diskManager = new DiskManager({\n\t\t\t\t\t\t\tufDiskFilesFieldName: 'UF_TASK_WEBDAV_FILES'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.subscribeOnce('onFinish', (baseEvent) => {\n\t\t\t\t\t\t\tthis.emit('attachFilesToTask', baseEvent.getData());\n\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.showAttachmentMenu(event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tactivity: (!this.decompositionMode && this.isMovable() && !this.isSubTask()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('move', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tsprint: {\n\t\t\t\t\tactivity: (!this.isDisabled() && !this.decompositionMode && !this.isSubTask()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('moveToSprint', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbacklog: {\n\t\t\t\t\tactivity: (this.entityType === 'sprint' && !this.decompositionMode && !this.isSubTask()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('moveToBacklog');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ttags: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showTagSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tepic: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showEpicSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdecomposition: {\n\t\t\t\t\tactivity: (\n\t\t\t\t\t\t!this.isDisabled()\n\t\t\t\t\t\t&& !this.decompositionMode\n\t\t\t\t\t\t&& !this.isGroupMode()\n\t\t\t\t\t\t&& !this.isSubTask()\n\t\t\t\t\t),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('startDecomposition');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tactivity: this.isRemoveAllowed(),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tconst message = (this.isGroupMode() ? Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASKS') :\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASK'));\n\t\t\t\t\t\tMessageBox.confirm(\n\t\t\t\t\t\t\tmessage,\n\t\t\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\t\t\tthis.emit('remove');\n\t\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.actionsPanel.showPanel();\n\t}\n\n\tgetCurrentActionsPanel(): ?ActionsPanel\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown())\n\t\t{\n\t\t\treturn this.actionsPanel;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null\n\t\t}\n\t}\n\n\tsetEpicAndTags(epic, tags: Array)\n\t{\n\t\tthis.epic = (Type.isPlainObject(epic) || epic === null ? epic : this.epic);\n\t\tthis.tags = (Type.isArray(tags) ? tags : this.tags);\n\n\t\tthis.updateTagsContainer();\n\t}\n\n\tupdateTagsContainer()\n\t{\n\t\tif (!this.getItemNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newContainer = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst tagsContainerNode = this.getItemNode().querySelector('.tasks-scrum-item-tags-container');\n\t\tif (tagsContainerNode)\n\t\t{\n\t\t\tDom.replace(tagsContainerNode, newContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newContainer, this.getItemNode());\n\t\t}\n\t}\n\n\tupdateResponsible()\n\t{\n\t\tif (!this.getItemNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst responsibleNode = this.getItemNode().querySelector('.tasks-scrum-item-responsible');\n\n\t\tif (!responsibleNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.attr(responsibleNode, 'title', this.responsible.name);\n\t\tif (this.responsible.photo && this.responsible.photo.src)\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', 'url(\"'+this.responsible.photo.src+'\")');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', null);\n\t\t}\n\t}\n\n\tplaceCursorAtEnd(node)\n\t{\n\t\tnode.focus();\n\t\tconst selection = window.getSelection();\n\t\tconst range = document.createRange();\n\t\trange.selectNodeContents(node);\n\t\trange.collapse(false);\n\t\tselection.removeAllRanges();\n\t\tselection.addRange(range);\n\t};\n\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.updateIndicators(data);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'block');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}\n","import {Dom, Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class GroupActionsButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.GroupActionsButton');\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-group-actions\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_GROUP')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(this.element, 'click', this.onClick.bind(this, this.element));\n\n\t\treturn this.element;\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tif (this.element && this.element.classList.contains('tasks-scrum-group-actions-active'))\n\t\t{\n\t\t\tDom.toggleClass(this.element, 'tasks-scrum-group-actions');\n\t\t\tDom.toggleClass(this.element, 'tasks-scrum-group-actions-active');\n\t\t\tDom.toggleClass(this.element, 'ui-link-secondary');\n\t\t\tDom.toggleClass(this.element, 'ui-link-dashed');\n\n\t\t\tthis.emit('deactivateGroupMode');\n\t\t}\n\t}\n\n\tonClick(element: HTMLElement)\n\t{\n\t\tDom.toggleClass(element, 'tasks-scrum-group-actions');\n\t\tDom.toggleClass(element, 'tasks-scrum-group-actions-active');\n\t\tDom.toggleClass(element, 'ui-link-secondary');\n\t\tDom.toggleClass(element, 'ui-link-dashed');\n\t\tif (element.classList.contains('tasks-scrum-group-actions-active'))\n\t\t{\n\t\t\tthis.emit('activateGroupMode');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('deactivateGroupMode');\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.element);\n\t\tthis.element = null;\n\t}\n}","import {Tag} from 'main.core';\nimport {Entity} from './entity';\nimport {Item} from '../item/item';\n\nexport class ListItems\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tthis.entity = entity;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-items-list\" data-entity-id=\"${this.entity.getId()}\">\n\t\t\t\t${this.entity.isCompleted() ? '' : this.entity.getInput().render()}\n\t\t\t\t${[...this.entity.getItems().values()].map((item: Item) => {\n\t\t\t\t\titem.setEntityType(this.entity.getEntityType());\n\t\t\t\t\treturn item.render();\n\t\t\t\t})}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.node;\n\t}\n\n\tgetNode(): HTMLElement|null\n\t{\n\t\treturn this.node;\n\t}\n\n\tsetEntityId(entityId: number)\n\t{\n\t\tthis.node.dataset.entityId = parseInt(entityId, 10);\n\t}\n}","import {Dialog} from 'ui.entity-selector';\nimport {Loc, Tag, Text} from 'main.core';\nimport {Input} from './input';\nimport {EventEmitter} from 'main.core.events';\n\nimport type {EpicType} from '../item/item';\n\nexport class TagSearcher extends EventEmitter\n{\n\tstatic tagRegExp = '#[^#@](?:[^#@]*[^\\s#@])?';\n\tstatic epicRegExp = '@[^#@](?:[^#@]*[^\\s#@])?';\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.TagSearcher');\n\n\t\tthis.allTags = new Map();\n\t}\n\n\taddTagToSearcher(tagName)\n\t{\n\t\ttagName = tagName.trim();\n\t\tthis.allTags.set('tag_' + tagName, {\n\t\t\tid: tagName,\n\t\t\tentityId: 'tag',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: tagName,\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag.svg'\n\t\t});\n\t}\n\n\taddEpicToSearcher(epic: EpicType)\n\t{\n\t\tconst epicName = epic.name.trim();\n\t\tthis.allTags.set('epic_' + epicName, {\n\t\t\tid: epic.id,\n\t\t\tentityId: 'epic',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: epicName.trim(),\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag-green.svg',\n\t\t\tname: epicName.trim(),\n\t\t\tdescription: epic.description,\n\t\t\tinfo: epic.info\n\t\t});\n\t}\n\n\tgetTagFromSearcher(name: String): Object\n\t{\n\t\treturn this.allTags.get(name);\n\t}\n\n\tremoveEpicFromSearcher(epic: Object)\n\t{\n\t\tthis.allTags.delete('epic_' + epic.name);\n\t}\n\n\tgetAllList(): Array\n\t{\n\t\treturn [...this.allTags.values()];\n\t}\n\n\tgetTagsList(): Array\n\t{\n\t\tconst tagsList = [];\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'tag')\n\t\t\t{\n\t\t\t\ttagsList.push(tag);\n\t\t\t}\n\t\t});\n\t\treturn tagsList;\n\t}\n\n\tgetEpicList(): Array\n\t{\n\t\tconst epicList = [];\n\t\t[...this.allTags.values()].forEach((epic) => {\n\t\t\tif (epic.entityId === 'epic')\n\t\t\t{\n\t\t\t\tepicList.push(epic);\n\t\t\t}\n\t\t});\n\t\treturn epicList;\n\t}\n\n\tgetEpicByName(epicName: string): EpicType|null\n\t{\n\t\tlet epic = null;\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'epic' && tag.name === epicName)\n\t\t\t{\n\t\t\t\tepic = tag;\n\t\t\t}\n\t\t});\n\t\treturn epic;\n\t}\n\n\tshowTagsDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentTags = item.getTags();\n\n\t\tconst selectedItems = [];\n\t\tcurrentTags.forEach((tag) => {\n\t\t\tconst currentTag = this.allTags.get(('tag_' + tag).trim());\n\t\t\tif (currentTag)\n\t\t\t{\n\t\t\t\tselectedItems.push(currentTag);\n\t\t\t}\n\t\t});\n\n\t\tconst createTag = () => {\n\t\t\tconst tagName = this.tagDialog.getTagSelector().getTextBoxValue();\n\t\t\tif (!tagName)\n\t\t\t{\n\t\t\t\tthis.tagDialog.focusSearch();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.addTagToSearcher(tagName);\n\t\t\tconst newTag = this.getTagFromSearcher('tag_' + tagName);\n\t\t\tconst item = this.tagDialog.addItem(newTag);\n\t\t\titem.select();\n\t\t\tthis.tagDialog.getTagSelector().clearTextBox();\n\t\t\tthis.tagDialog.focusSearch();\n\t\t\tthis.tagDialog.selectFirstTab();\n\t\t\tconst label = this.tagDialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\tlabel.textContent = '';\n\t\t};\n\n\t\tlet choiceWasMade = false;\n\n\t\tthis.tagDialog = new Dialog({\n\t\t\tid: item.getItemId(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: true,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getTagsList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst tag = selectedItem.getTitle();\n\t\t\t\t\tthis.emit('attachTagToTask', tag);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst deselectedItem = event.getData().item;\n\t\t\t\t\tconst tag = deselectedItem.getTitle();\n\t\t\t\t\tthis.emit('deAttachTagToTask', tag);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonInput: (event) => {\n\t\t\t\t\t\tconst selector = event.getData().selector;\n\t\t\t\t\t\tif (selector)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst dialog = selector.getDialog();\n\t\t\t\t\t\t\tconst label = dialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\t\t\t\t\tlabel.textContent = Text.encode(selector.getTextBoxValue());\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tfooter: [\n\t\t\t\tTag.render`\n\t\t\t\t\t<span onclick=\"${createTag}\" class=\"ui-selector-footer-link ui-selector-footer-link-add\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SEARCHER_ACTIONS_TAG_ADD')}\n\t\t\t\t\t</span>\n\t\t\t\t`,\n\t\t\t\tTag.render`<span class=\"ui-selector-footer-conjunction\"></span>`\n\t\t\t],\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(this.tagDialog.getContainer());\n\t\tthis.tagDialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t\tthis.emit('hideTagDialog');\n\t\t\t}\n\t\t});\n\n\t\tthis.tagDialog.show();\n\t}\n\n\tshowEpicDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentEpic = item.getEpic();\n\n\t\tconst selectedItems = [];\n\t\tif (currentEpic)\n\t\t{\n\t\t\tconst currentEpicInfo = this.allTags.get(('epic_' + currentEpic.name).trim());\n\t\t\tif (currentEpicInfo)\n\t\t\t{\n\t\t\t\tselectedItems.push(currentEpicInfo);\n\t\t\t}\n\t\t}\n\n\t\tlet choiceWasMade = false;\n\n\t\tconst dialog = new Dialog({\n\t\t\tid: item.getItemId(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getEpicList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst epicId = selectedItem.getId();\n\t\t\t\t\tthis.emit('updateItemEpic', epicId);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\t\tif (dialog.getSelectedItems().length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('updateItemEpic', 0);\n\t\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 50);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tplaceholder: Loc.getMessage('TASKS_SCRUM_ITEM_EPIC_SEARCHER_PLACEHOLDER')\n\t\t\t}\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(dialog.getContainer());\n\t\tdialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t}\n\t\t});\n\t\tdialog.show();\n\t}\n\n\tshowTagsSearchDialog(inputObject: Input, enteredHashTagName: string): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.tagsDialog && this.tagsDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.tagsDialog = null;\n\t\t}\n\n\t\tif (!this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getTagsList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashTag = '#' + selectedItem.getTitle();\n\t\t\t\t\t\tconst hashTags = TagSearcher.getHashTagNamesFromText(input.value);\n\t\t\t\t\t\tconst enteredHashTag = (hashTags.length > 0 ? hashTags.pop() : '');\n\t\t\t\t\t\tinput.value = input.value.replace(\n\t\t\t\t\t\t\tnew RegExp('#' + enteredHashTag, 'g'),\n\t\t\t\t\t\t\tselectedHashTag\n\t\t\t\t\t\t);\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.tagsDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setTagsSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setTagsSearchMode(true);\n\n\t\tthis.tagsDialog.show();\n\n\t\tthis.tagsDialog.search(enteredHashTagName);\n\t}\n\n\tcloseTagsSearchDialog()\n\t{\n\t\tif (this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog.hide();\n\t\t}\n\t}\n\n\tshowEpicSearchDialog(inputObject: Input, enteredHashEpicName: String): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.epicDialog && this.epicDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.epicDialog = null;\n\t\t}\n\n\t\tif (!this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getEpicList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashEpic = '@' + selectedItem.getTitle();\n\t\t\t\t\t\tinput.value = input.value.replace(new RegExp(TagSearcher.epicRegExp,'g'),'');\n\t\t\t\t\t\tinput.value = input.value + ' ' + selectedHashEpic\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t\tinputObject.setEpicId(selectedItem.getId());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.epicDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setEpicSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setEpicSearchMode(true);\n\n\t\tthis.epicDialog.show();\n\t\tthis.epicDialog.search(enteredHashEpicName);\n\t}\n\n\tcloseEpicSearchDialog()\n\t{\n\t\tif (this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog.hide();\n\t\t}\n\t}\n\n\tstatic getHashTagNamesFromText(inputText: string): Array\n\t{\n\t\tconst regex = new RegExp(TagSearcher.tagRegExp, 'g');\n\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0].substring(1));\n\t\t}\n\n\t\treturn matches;\n\t}\n\n\tstatic getHashEpicNamesFromText(inputText: string): Array\n\t{\n\t\tconst regex = new RegExp(TagSearcher.epicRegExp, 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0].substring(1));\n\t\t}\n\n\t\treturn matches;\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {TagSearcher} from './tag.searcher';\nimport {EventEmitter} from 'main.core.events';\n\nimport '../css/input.css';\n\nexport class Input extends EventEmitter\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Input');\n\n\t\tthis.nodeId = Text.getRandom();\n\t\tthis.placeholder = Loc.getMessage('TASKS_SCRUM_TASK_ADD_INPUT_TASK_PLACEHOLDER');\n\n\t\tthis.epicId = 0;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${Text.encode(this.nodeId)}\" class=\"tasks-scrum-input\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox\">\n\t\t\t\t\t<input type=\"text\" class=\"ui-ctl-element\" placeholder=\n\t\t\t\t\t\t\"${Text.encode(this.placeholder)}\" autocomplete=\"off\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdisable()\n\t{\n\t\tthis.node.querySelector('input').disabled = true;\n\t}\n\n\tunDisable()\n\t{\n\t\tthis.node.querySelector('input').disabled = false;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.setNode();\n\n\t\tEvent.bind(this.getInputNode(), 'input', (event) => {\n\t\t\tthis.onTagSearch(event);\n\t\t\tthis.onEpicSearch(event);\n\t\t});\n\t\tEvent.bind(this.getInputNode(), 'keydown', this.onKeydown.bind(this));\n\t}\n\n\tsetNode()\n\t{\n\t\tthis.node = document.getElementById(this.nodeId);\n\t}\n\n\tsetPlaceholder(placeholder: String)\n\t{\n\t\tthis.placeholder = placeholder;\n\t}\n\n\tsetEpicId(parentId)\n\t{\n\t\tthis.epicId = parseInt(parentId, 10);\n\t}\n\n\tgetNode(): HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetNodeId(): String\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tgetInputNode(): HTMLElement\n\t{\n\t\treturn this.node.querySelector('input');\n\t}\n\n\tgetEpicId()\n\t{\n\t\treturn this.epicId;\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t}\n\n\tsetTagsSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-tag-disabled', value);\n\t}\n\n\tisTagsSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-tag-disabled');\n\t}\n\n\tsetEpicSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-epic-disabled', value);\n\t}\n\n\tisEpicSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-epic-disabled');\n\t}\n\n\tonTagSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashTags = TagSearcher.getHashTagNamesFromText(inputNode.value);\n\t\tif (event.data === '#')\n\t\t{\n\t\t\tthis.setEpicSearchMode(false);\n\t\t\tthis.setTagsSearchMode(true);\n\t\t}\n\t\tif (enteredHashTags.length > 0 && this.isTagsSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashTags.pop();\n\t\t\tthis.emit('tagsSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('tagsSearchClose');\n\t\t}\n\t}\n\n\tonEpicSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashEpics = TagSearcher.getHashEpicNamesFromText(inputNode.value);\n\t\tif (event.data === '@')\n\t\t{\n\t\t\tthis.setTagsSearchMode(false);\n\t\t\tthis.setEpicSearchMode(true);\n\t\t}\n\t\tif (enteredHashEpics.length > 0 && this.isEpicSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashEpics.pop();\n\t\t\tthis.emit('epicSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('epicSearchClose');\n\t\t}\n\t}\n\n\tonCreateTaskItem()\n\t{\n\t\tif (!this.isTagsSearchMode() && !this.isEpicSearchMode())\n\t\t{\n\t\t\tconst input = this.getInputNode();\n\t\t\tif (input.value)\n\t\t\t{\n\t\t\t\tthis.emit('createTaskItem', input.value);\n\t\t\t\tinput.value = '';\n\t\t\t\tinput.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tonKeydown(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.onCreateTaskItem();\n\t\t}\n\t}\n}","import {Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Item} from '../item/item';\nimport {GroupActionsButton} from './group.actions.button';\nimport {ListItems} from './list.items';\n\nimport {Input} from '../utility/input';\nimport {StoryPoints} from '../utility/story.points';\n\nimport type {Views} from '../view/view';\n\nimport '../css/entity.css';\n\ntype EntityParams = {\n\tid: number,\n\tviews?: Views,\n\tnumberTasks?: number,\n\tisExactSearchApplied: 'Y' | 'N'\n};\n\nexport class Entity extends EventEmitter\n{\n\tconstructor(params: EntityParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Entity');\n\n\t\tthis.setEntityParams(params);\n\n\t\tthis.storyPoints = new StoryPoints();\n\n\t\tthis.items = new Map();\n\n\t\tthis.groupMode = false;\n\t\tthis.groupModeItems = new Map();\n\n\t\tthis.node = null;\n\t\tthis.groupActionsButton = null;\n\t\tthis.listItems = null;\n\n\t\tthis.input = new Input();\n\t}\n\n\tsetEntityParams(params: EntityParams)\n\t{\n\t\tthis.setId(params.id);\n\t\tthis.setViews(params.views);\n\t\tthis.setNumberTasks(params.numberTasks);\n\n\t\tthis.exactSearchApplied = (params.isExactSearchApplied === 'Y');\n\t}\n\n\taddGroupActionsButton(groupActionsButton: GroupActionsButton)\n\t{\n\t\tthis.groupActionsButton = groupActionsButton;\n\t\tthis.groupActionsButton.subscribe('activateGroupMode', this.onActivateGroupMode.bind(this));\n\t\tthis.groupActionsButton.subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t}\n\n\taddListItems(listItems: ListItems)\n\t{\n\t\tthis.listItems = listItems;\n\t}\n\n\tgetListItems(): ListItems|null\n\t{\n\t\treturn this.listItems;\n\t}\n\n\tgetNode(): HTMLElement|null\n\t{\n\t\treturn this.node;\n\t}\n\n\tsetId(id: number)\n\t{\n\t\tthis.id = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\n\t\tif (this.listItems)\n\t\t{\n\t\t\tthis.listItems.setEntityId(this.id);\n\t\t}\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetViews(views)\n\t{\n\t\tthis.views = (Type.isPlainObject(views) ? views : {});\n\t}\n\n\tgetViews()\n\t{\n\t\treturn this.views;\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'entity';\n\t}\n\n\tisActive()\n\t{\n\t\treturn false;\n\t}\n\n\tisCompleted()\n\t{\n\t\treturn false;\n\t}\n\n\tgetListItemsNode(): HTMLElement|null\n\t{\n\t\treturn (this.listItems ? this.listItems.getNode() : null);\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn (this.items.size === 0);\n\t}\n\n\tgetItems(): Map\n\t{\n\t\treturn this.items;\n\t}\n\n\trecalculateItemsSort()\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tif (!listItemsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet sort = 1;\n\t\tlistItemsNode.querySelectorAll('.tasks-scrum-item').forEach((node: HTMLElement) => {\n\t\t\tconst item = this.getItems().get(parseInt(node.dataset.itemId, 10));\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.setSort(sort);\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\t}\n\n\tgetInput(): Input\n\t{\n\t\treturn this.input;\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tthis.items.set(newItem.getItemId(), newItem);\n\t\tthis.subscribeToItem(newItem);\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\n\t\tif (!newItem.isSubTask())\n\t\t{\n\t\t\tthis.addNumberTasks(1);\n\t\t}\n\t}\n\n\tsetItemMoveActivity(item: Item)\n\t{\n\t\titem.setMoveActivity(this.items.size > 2);\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tif (this.items.has(item.getItemId()))\n\t\t{\n\t\t\tthis.items.delete(item.getItemId());\n\t\t\titem.unsubscribeAll();\n\t\t\t[...this.items.values()].map((item) => {\n\t\t\t\tthis.setItemMoveActivity(item);\n\t\t\t});\n\n\t\t\tif (!item.isSubTask())\n\t\t\t{\n\t\t\t\tthis.subtractNumberTasks(1);\n\t\t\t}\n\t\t}\n\t}\n\n\tisNodeCreated(): boolean\n\t{\n\t\treturn (this.node !== null);\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tthis.numberTasks = (Type.isInteger(numberTasks) ? parseInt(numberTasks, 10) : 0);\n\t}\n\n\tgetNumberTasks(): number\n\t{\n\t\treturn (this.numberTasks ? this.numberTasks : this.getItems().size);\n\t}\n\n\taddNumberTasks(value: number)\n\t{\n\t\tif (!Type.isUndefined(value) && !isNaN(parseInt(value, 10)))\n\t\t{\n\t\t\tthis.numberTasks = (this.numberTasks + parseInt(value, 10));\n\t\t}\n\t}\n\n\tsubtractNumberTasks(value: number)\n\t{\n\t\tif (!Type.isUndefined(value) && !isNaN(parseInt(value, 10)))\n\t\t{\n\t\t\tthis.numberTasks = (this.numberTasks - parseInt(value, 10));\n\t\t}\n\t}\n\n\thasInput(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tsetExactSearchApplied(value: boolean)\n\t{\n\t\tthis.exactSearchApplied = Boolean(value);\n\t}\n\n\tisExactSearchApplied(): boolean\n\t{\n\t\treturn this.exactSearchApplied;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.subscribeToItem(item);\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.input.onAfterAppend();\n\t\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t\t\tthis.input.subscribe('epicSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('epicSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashEpicName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('epicSearchClose', () => this.emit('epicSearchClose'));\n\t\t\tthis.input.subscribe('createTaskItem', (baseEvent) => {\n\t\t\t\tthis.emit('createTaskItem', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tvalue: baseEvent.getData()\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.updateStoryPoints();\n\t}\n\n\tsubscribeToItem(item: Item)\n\t{\n\t\tif (!this.getListItemsNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.onAfterAppend(this.getListItemsNode());\n\n\t\titem.setEntityType(this.getEntityType());\n\n\t\titem.subscribe('updateItem', (baseEvent) => {\n\t\t\tthis.emit('updateItem', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('updateStoryPoints', () => {\n\t\t\tif (item.isSubTask())\n\t\t\t{\n\t\t\t\tconst parentItem = this.getItemBySourceId(item.getParentTaskId());\n\t\t\t\tif (parentItem)\n\t\t\t\t{\n\t\t\t\t\tparentItem.updateSubTasksPoints(item.getSourceId(), item.getStoryPoints());\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.updateStoryPoints();\n\t\t});\n\n\t\titem.subscribe('showTask', (baseEvent) => this.emit('showTask', baseEvent.getTarget()));\n\n\t\titem.subscribe('move', (baseEvent) => {\n\t\t\tthis.emit('moveItem', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('moveToSprint', (baseEvent) => {\n\t\t\tthis.emit('moveToSprint', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('attachFilesToTask', (baseEvent) => {\n\t\t\tthis.emit('attachFilesToTask', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tattachedIds: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('showTagSearcher', (baseEvent) => {\n\t\t\tthis.emit('showTagSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\titem.subscribe('showEpicSearcher', (baseEvent) => {\n\t\t\tthis.emit('showEpicSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('startDecomposition', (baseEvent) => {\n\t\t\tthis.emit('startDecomposition', baseEvent.getTarget())\n\t\t});\n\n\t\titem.subscribe('remove', (baseEvent) => {\n\t\t\tif (this.isGroupMode())\n\t\t\t{\n\t\t\t\tthis.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\tthis.removeItem(groupModeItem);\n\t\t\t\t\tgroupModeItem.removeYourself();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst item = baseEvent.getTarget();\n\t\t\t\tthis.removeItem(item);\n\t\t\t\titem.removeYourself();\n\t\t\t}\n\t\t\tthis.emit('removeItem', item);\n\t\t});\n\n\t\titem.subscribe('changeTaskResponsible', (baseEvent) => {\n\t\t\tconst item = baseEvent.getTarget();\n\t\t\tthis.emit('changeTaskResponsible', item);\n\t\t});\n\n\t\titem.subscribe('filterByEpic', (baseEvent) => {\n\t\t\tthis.emit('filterByEpic', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('filterByTag', (baseEvent) => {\n\t\t\tthis.emit('filterByTag', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('addItemToGroupMode', (baseEvent) => {\n\t\t\tthis.addItemToGroupMode(baseEvent.getTarget());\n\t\t});\n\n\t\titem.subscribe('removeItemFromGroupMode', (baseEvent) => {\n\t\t\tthis.removeItemFromGroupMode(baseEvent.getTarget());\n\t\t});\n\t}\n\n\tupdateStoryPoints()\n\t{\n\t\tthis.storyPoints.clearPoints();\n\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\tif (!item.isSubTask())\n\t\t\t{\n\t\t\t\tthis.storyPoints.addPoints(item.getStoryPoints().getPoints());\n\t\t\t}\n\t\t});\n\t}\n\n\taddTotalStoryPoints(item: Item) {}\n\n\tsubtractTotalStoryPoints(item: Item) {}\n\n\tgetItemByItemId(itemId: number|string): Item|undefined\n\t{\n\t\treturn this.items.get((Type.isInteger(itemId) ? parseInt(itemId, 10) : itemId));\n\t}\n\n\tgetItemBySourceId(sourceId: number): Item|undefined\n\t{\n\t\treturn [...this.items.values()].find((item: Item) => item.getSourceId() === sourceId);\n\t}\n\n\tgetItemsByParentTaskId(parentTaskId: number): Map<number, Item>\n\t{\n\t\tconst items = new Map();\n\n\t\t[...this.items.values()].map((item: Item) => {\n\t\t\tif (item.getParentTaskId() === parentTaskId)\n\t\t\t{\n\t\t\t\titems.set(item.getItemId(), item);\n\t\t\t}\n\t\t});\n\n\t\treturn items;\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tisFirstItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\tconst firstElementChild = (\n\t\t\tthis.hasInput() ? listItemsNode.firstElementChild.nextElementSibling : listItemsNode.firstElementChild\n\t\t)\n\t\treturn firstElementChild.isEqualNode(itemNode);\n\t}\n\n\tisLastItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\treturn listItemsNode.lastElementChild.isEqualNode(itemNode);\n\t}\n\n\tfadeOut()\n\t{\n\t\tthis.getListItemsNode().classList.add('tasks-scrum-entity-items-faded');\n\t}\n\n\tfadeIn()\n\t{\n\t\tthis.getListItemsNode().classList.remove('tasks-scrum-entity-items-faded');\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tthis.groupActionsButton.deactivateGroupMode();\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tthis.groupMode = true;\n\n\t\tthis.input.disable();\n\n\t\tthis.emit('activateGroupMode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tthis.groupMode = false;\n\n\t\tthis.input.unDisable();\n\n\t\tthis.groupModeItems.forEach((item: Item) => {\n\t\t\titem.deactivateGroupMode();\n\t\t});\n\t\tthis.groupModeItems.clear();\n\n\t\tthis.emit('deactivateGroupMode');\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\taddItemToGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.set(item.getItemId(), item);\n\t}\n\n\tgetGroupModeItems(): Map\n\t{\n\t\treturn this.groupModeItems;\n\t}\n\n\tremoveItemFromGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.delete(item.getItemId());\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Entity} from '../entity';\n\nexport class Header extends EventEmitter\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tsuper(entity);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.BacklogHeader');\n\n\t\tthis.entity = entity;\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<div class=\"tasks-scrum-backlog-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-epics-title ui-btn ui-btn-xs ui-btn-secondary\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_EPICS_TITLE')}\n\t\t\t</div>\n\t\t\t<div title=\"Definition of Done\" class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-dod\">\n\t\t\t\t<span class=\"tasks-scrum-entity-dod-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-title-spacer\"></div>\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-task\">\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-title\">\n\t\t\t\t\t${this.entity.getNumberTasks()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-story-point-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE_STORY_POINTS')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-story-point\">\n\t\t\t\t${Text.encode(this.entity.getStoryPoints().getPoints())}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.getElementByClassName(this.element, 'tasks-scrum-backlog-epics-title'), 'click', () => {\n\t\t\tthis.emit('openListEpicGrid');\n\t\t});\n\n\t\tEvent.bind(this.getElementByClassName(this.element, 'tasks-scrum-entity-title-btn-dod'), 'click', () => {\n\t\t\tthis.emit('openDefinitionOfDone');\n\t\t});\n\n\t\treturn this.element;\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tthis.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-backlog-story-point'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tupdateNumberTasks()\n\t{\n\t\tconst parentNode = this.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-entity-title-btn-task'\n\t\t);\n\t\tparentNode.querySelector('.tasks-scrum-entity-tasks-title').textContent = this.entity.getNumberTasks();\n\t}\n\n\tgetElementByClassName(elements: HTMLElement[], className: string): HTMLElement\n\t{\n\t\tlet element = null;\n\t\telements.forEach((elem) => {\n\t\t\tif (elem.classList.contains(className))\n\t\t\t{\n\t\t\t\telement = elem;\n\t\t\t}\n\t\t});\n\t\treturn element;\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class EpicCreationButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.EpicCreationButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst element = Tag.render`\n\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-action-epic\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(element, 'click', this.onClick.bind(this));\n\n\t\treturn element;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('openAddEpicForm')\n\t}\n}","import {Dom, Tag} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {BaseEvent} from 'main.core.events';\nimport {Entity} from '../entity';\nimport {Header} from './header';\nimport {EpicCreationButton} from './epic.creation.button';\nimport {GroupActionsButton} from '../group.actions.button';\nimport {ListItems} from '../list.items';\nimport {Item} from '../../item/item';\n\nimport type {ItemParams} from '../../item/item';\n\nimport '../../css/backlog.css';\n\nexport type BacklogParams = {\n\tid: number,\n\titems?: Array<ItemParams>,\n\tpageNumberItems: number\n};\n\nexport class Backlog extends Entity\n{\n\tconstructor(params: BacklogParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Backlog');\n\n\t\tthis.setBacklogParams(params);\n\n\t\tthis.header = null;\n\t\tthis.epicCreationButton = null;\n\t}\n\n\tsetBacklogParams(params: BacklogParams)\n\t{\n\t\tparams.items.forEach((itemData) => {\n\t\t\tconst item = new Item(itemData);\n\t\t\tthis.items.set(item.itemId, item);\n\t\t});\n\n\t\tthis.pageNumberItems = parseInt(params.pageNumberItems, 10);\n\t}\n\n\tstatic buildBacklog(backlogData: BacklogParams): Backlog\n\t{\n\t\tconst backlog = new Backlog(backlogData);\n\t\tbacklog.addHeader(new Header(backlog));\n\t\tbacklog.addEpicCreationButton(new EpicCreationButton());\n\t\tbacklog.addGroupActionsButton(new GroupActionsButton());\n\t\tbacklog.addListItems(new ListItems(backlog));\n\t\treturn backlog;\n\t}\n\n\taddHeader(header: Header)\n\t{\n\t\tthis.header = header;\n\t\tthis.header.subscribe('openListEpicGrid', () => this.emit('openListEpicGrid'));\n\t\tthis.header.subscribe('openDefinitionOfDone', () => this.emit('openDefinitionOfDone'));\n\t}\n\n\taddEpicCreationButton(epicCreationButton: EpicCreationButton)\n\t{\n\t\tthis.epicCreationButton = epicCreationButton;\n\t\tthis.epicCreationButton.subscribe('openAddEpicForm', () => this.emit('openAddEpicForm'));\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'backlog';\n\t}\n\n\tisDisabled()\n\t{\n\t\treturn false;\n\t}\n\n\tgetPageNumberItems(): number\n\t{\n\t\treturn this.pageNumberItems;\n\t}\n\n\tincrementPageNumberItems()\n\t{\n\t\tthis.pageNumberItems++;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-backlog\">\n\t\t\t\t<div class=\"tasks-scrum-backlog-header\">\n\t\t\t\t\t${this.header ? this.header.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-backlog-actions\">\n\t\t\t\t\t${this.epicCreationButton ? this.epicCreationButton.render() : ''}\n\t\t\t\t\t${this.groupActionsButton ? this.groupActionsButton.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-backlog-items\">\n\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-backlog-items-loader\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.backlogItemsLoaderNode = this.node.querySelector('.tasks-scrum-backlog-items-loader');\n\t\tthis.bindBacklogItemsLoader(this.backlogItemsLoaderNode);\n\n\t\treturn this.node;\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tsuper.setItem(newItem);\n\n\t\tthis.updateStoryPoints();\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tsuper.removeItem(item);\n\n\t\tthis.updateStoryPoints();\n\t}\n\n\taddNumberTasks(value: number)\n\t{\n\t\tsuper.addNumberTasks(value);\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.updateNumberTasks();\n\t\t}\n\t}\n\n\tsubtractNumberTasks(value: number)\n\t{\n\t\tsuper.subtractNumberTasks(value);\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.updateNumberTasks();\n\t\t}\n\t}\n\n\tupdateStoryPoints()\n\t{\n\t\tsuper.updateStoryPoints();\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.setStoryPoints(this.getStoryPoints().getPoints());\n\t\t}\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onActivateGroupMode(baseEvent);\n\n\t\tDom.addClass(this.node.querySelector('.tasks-scrum-backlog-items'), 'tasks-scrum-backlog-items-group-mode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onDeactivateGroupMode(baseEvent);\n\n\t\tDom.removeClass(this.node.querySelector('.tasks-scrum-backlog-items'), 'tasks-scrum-backlog-items-group-mode');\n\t}\n\n\tbindBacklogItemsLoader(loader: HTMLElement)\n\t{\n\t\tthis.setActiveLoadBacklogItems(false);\n\n\t\tconst observer = new IntersectionObserver((entries) =>\n\t\t\t{\n\t\t\t\tif(entries[0].isIntersecting === true)\n\t\t\t\t{\n\t\t\t\t\tif (!this.isActiveLoadBacklogItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.emit('loadBacklogItems');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tthreshold: [0]\n\t\t\t}\n\t\t);\n\n\t\tobserver.observe(loader);\n\t}\n\n\tsetActiveLoadBacklogItems(value: boolean)\n\t{\n\t\tthis.activeLoadBacklogItems = Boolean(value);\n\t}\n\n\tisActiveLoadBacklogItems(): boolean\n\t{\n\t\treturn this.activeLoadBacklogItems;\n\t}\n\n\tshowItemsLoader()\n\t{\n\t\tconst listPosition = Dom.getPosition(this.backlogItemsLoaderNode);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.backlogItemsLoaderNode,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\n\nexport class SprintDate extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintDate');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.nodeId = 'tasks-scrum-sprint-header-date-' + Text.getRandom();\n\t\tthis.defaultSprintDuration = sprint.getDefaultSprintDuration();\n\t}\n\n\tcreateDate()\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn this.renderNode(this.nodeId, this.getFormattedDateStart(), this.getFormattedDateEnd());\n\t}\n\n\trenderNode(nodeId: string, dateStart: string, dateEnd: string): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${nodeId}\" class=\"tasks-scrum-sprint-date\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-start\">${dateStart}</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-separator\">-</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-end\">${dateEnd}</div>\n\t\t\t\t<input type=\"hidden\" name=\"dateStart\">\n\t\t\t\t<input type=\"hidden\" name=\"dateEnd\">\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\t\tdateStartNode.textContent = BX.date.format('j F', timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\t\tdateEndNode.textContent = BX.date.format('j F', timestamp);\n\t\t}\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.node = document.getElementById(this.nodeId);\n\t\tconst parentPopup = this.node.closest('.popup-window');\n\n\t\tconst customBlur = () => {\n\t\t\tBX.calendar.get().popup.close();\n\t\t};\n\n\t\tconst showCalendar = (node, field) => {\n\t\t\t/* eslint-disable */\n\t\t\tBX.calendar({\n\t\t\t\tnode: node,\n\t\t\t\tfield: field,\n\t\t\t\tbTime: false,\n\t\t\t\tbSetFocus: false,\n\t\t\t\tbHideTime: false\n\t\t\t});\n\t\t\t/* eslint-enable */\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.bindOnce(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t};\n\n\t\tconst updateDateNode = (node, value) => {\n\t\t\t/* eslint-disable */\n\t\t\tnode.textContent = BX.date.format('j F', Math.floor(BX.parseDate(value).getTime() / 1000));\n\t\t\t/* eslint-enable */\n\t\t};\n\t\tconst sendRequest = (data) => {\n\t\t\tthis.emit('changeSprintDeadline', data);\n\t\t};\n\n\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\tconst dateStartInput = this.node.querySelector('input[name=\"dateStart\"]');\n\t\tconst dateEndInput = this.node.querySelector('input[name=\"dateEnd\"]');\n\n\t\tEvent.bind(this.node, 'click', (event) => {\n\t\t\tconst target = event.target;\n\t\t\tif (target.classList.contains('tasks-scrum-sprint-date-start'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateStartInput);\n\t\t\t}\n\t\t\telse if (target.classList.contains('tasks-scrum-sprint-date-end'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateEndInput);\n\t\t\t}\n\t\t\tevent.stopPropagation();\n\t\t});\n\t\tEvent.bind(dateStartInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateStartNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateStart: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t\tEvent.bind(dateEndInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateEndNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateEnd: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetWeeks()\n\t{\n\t\tconst weekCount = (parseInt(this.defaultSprintDuration, 10) / 604800);\n\t\tif (weekCount > 5)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_3');\n\t\t}\n\t\telse if (weekCount === 1)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_2');\n\t\t}\n\t}\n\n\tgetFormattedTitleDatePeriod(): string\n\t{\n\t\treturn this.getFormattedDateStart() + ' - ' + this.getFormattedDateEnd();\n\t}\n\n\tgetFormattedDateStart(): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format('j F', this.sprint.getDateStart());\n\t\t/* eslint-enable */\n\t}\n\n\tgetFormattedDateEnd(): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format('j F', this.sprint.getDateEnd());\n\t\t/* eslint-enable */\n\t}\n}","export class StatsCalculator\n{\n\tcalculatePercentage(first: number, second: number): number\n\t{\n\t\tif (first === 0)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst result = Math.round(second * 100 / first);\n\n\t\treturn (isNaN(result) ? 0 : result);\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\nimport {StatsCalculator} from '../../utility/stats.calculator';\nimport {SprintDate} from \"./sprint.date\";\n\nexport class StatsHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.StatsHeader');\n\n\t\tthis.setSprintData(sprint);\n\n\t\tthis.statsCalculator = new StatsCalculator();\n\n\t\tthis.weekendDaysTime = sprint.getWeekendDaysTime();\n\n\t\tthis.headerNode = null;\n\t\tthis.headerClass = 'tasks-scrum-sprint-header-stats';\n\n\t\tthis.kanbanMode = false;\n\t}\n\n\tsetKanbanStyle()\n\t{\n\t\tthis.kanbanMode = true;\n\t\tthis.headerClass = 'tasks-scrum-sprint-header-stats-kanban';\n\t}\n\n\tisKanbanMode(): boolean\n\t{\n\t\treturn this.kanbanMode;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn '';\n\t}\n\n\tupdateStats(sprint: Sprint)\n\t{\n\t\tthis.setSprintData(sprint);\n\n\t\tDom.replace(this.headerNode, this.render());\n\t}\n\n\tsetSprintData(sprint: Sprint)\n\t{\n\t\tthis.setSprintDate(sprint);\n\t\tthis.setStoryPoints(sprint.getTotalStoryPoints().getPoints());\n\t\tthis.setCompletedStoryPoints(sprint.getTotalCompletedStoryPoints().getPoints());\n\t\tthis.setUncompletedStoryPoints(sprint.getTotalUncompletedStoryPoints().getPoints());\n\t\tthis.setEndDate(sprint.getDateEnd());\n\t}\n\n\tsetSprintDate(sprint: Sprint)\n\t{\n\t\tthis.sprintDate = new SprintDate(sprint);\n\t}\n\n\tgetSprintDate(): SprintDate\n\t{\n\t\treturn this.sprintDate;\n\t}\n\n\tsetStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.storyPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.storyPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetStoryPoints(): number\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tsetCompletedStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.completedStoryPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.completedStoryPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetCompletedStoryPoints(): number\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetUncompletedStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.uncompletedStoryPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.uncompletedStoryPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetUncompletedStoryPoints(): number\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetEndDate(endDate)\n\t{\n\t\tif (Type.isUndefined(endDate) || isNaN(parseInt(endDate, 10)))\n\t\t{\n\t\t\tthis.endDate = (Date.now() / 1000);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.endDate = parseInt(endDate, 10);\n\t\t}\n\t}\n\n\tgetEndDate(): number\n\t{\n\t\treturn this.endDate;\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class CompletedStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tconst completedDate = this.getCompletedDate(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_COMPLETED_LABEL')\n\t\t\t.replace('#percent#', percentage)\n\t\t\t.replace('#date#', completedDate)\n\t\t;\n\n\t\tconst title = this.getSprintDate().getFormattedTitleDatePeriod();\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\" title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetCompletedDate(endDate: number): string\n\t{\n\t\treturn BX.date.format('j F Y', endDate);\n\t};\n}","import {Loc, Tag} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class ExpiredStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\t\tconst expiredDay = this.getExpiredDay(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_EXPIRED_LABEL')\n\t\t\t.replace('#percent#', percentage)\n\t\t\t.replace('#date#', expiredDay)\n\t\t;\n\n\t\tconst title = this.getSprintDate().getFormattedTitleDatePeriod();\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\" title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetExpiredDay(endDate: number): string\n\t{\n\t\treturn BX.date.format('j F Y', endDate);\n\t};\n}","import {Loc, Tag, Type} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class ActiveStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst remainingDays = this.getRemainingDays(this.getEndDate());\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tlet label = '';\n\t\tif (Type.isInteger(remainingDays) && remainingDays <= 1)\n\t\t{\n\t\t\tlabel = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LAST_LABEL')\n\t\t\t\t.replace('#percent#', percentage)\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabel = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LABEL')\n\t\t\t\t.replace('#days#', remainingDays)\n\t\t\t\t.replace('#percent#', percentage)\n\t\t\t;\n\t\t}\n\n\t\tconst title = this.getSprintDate().getFormattedTitleDatePeriod();\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\" title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetRemainingDays(endDate: number): string|number\n\t{\n\t\tconst dateWithWeekendOffset = new Date();\n\t\tdateWithWeekendOffset.setSeconds(dateWithWeekendOffset.getSeconds() + this.weekendDaysTime);\n\t\tdateWithWeekendOffset.setHours(0, 0, 0, 0);\n\n\t\tconst dateEnd = new Date(endDate * 1000);\n\n\t\tconst msPerMinute = 60 * 1000;\n\t\tconst msPerHour = msPerMinute * 60;\n\t\tconst msPerDay = msPerHour * 24;\n\n\t\tconst daysRemaining = Math.round((dateEnd - dateWithWeekendOffset) / msPerDay);\n\n\t\tif (daysRemaining <= 1)\n\t\t{\n\t\t\treturn daysRemaining;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.date.format('ddiff', dateWithWeekendOffset, dateEnd);\n\t\t}\n\t};\n}","import {Sprint} from './sprint';\nimport {StatsHeader} from './stats.header';\nimport {CompletedStatsHeader} from './completed.stats.header';\nimport {ExpiredStatsHeader} from './expired.stats.header';\nimport {ActiveStatsHeader} from './active.stats.header';\n\nexport class StatsHeaderBuilder\n{\n\tstatic build(sprint: Sprint): StatsHeader\n\t{\n\t\tif (sprint.isCompleted())\n\t\t{\n\t\t\treturn new CompletedStatsHeader(sprint);\n\t\t}\n\t\telse if (sprint.isExpired())\n\t\t{\n\t\t\treturn new ExpiredStatsHeader(sprint);\n\t\t}\n\t\telse if (sprint.isActive())\n\t\t{\n\t\t\treturn new ActiveStatsHeader(sprint);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn new StatsHeader(sprint);\n\t\t}\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {SprintDate} from './sprint.date';\nimport {Sprint} from './sprint';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {StatsHeaderBuilder} from './stats.header.builder';\nimport {StatsHeader} from './stats.header';\n\nexport class SprintHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintHeader');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\n\t\tthis.statsHeader = null;\n\t\tthis.sprintDate = null;\n\t}\n\n\tstatic buildHeader(sprint: Sprint): SprintHeader\n\t{\n\t\tconst sprintHeader = new SprintHeader(sprint);\n\t\tsprintHeader.addHeaderStats(StatsHeaderBuilder.build(sprint));\n\t\tsprintHeader.addHeaderDate(new SprintDate(sprint));\n\t\treturn sprintHeader;\n\t}\n\n\taddHeaderStats(statsHeader: StatsHeader)\n\t{\n\t\tthis.statsHeader = statsHeader;\n\t}\n\n\taddHeaderDate(sprintDate: SprintDate)\n\t{\n\t\tthis.sprintDate = sprintDate;\n\t\tthis.sprintDate.subscribe('changeSprintDeadline', (baseEvent) => {\n\t\t\tthis.emit('changeSprintDeadline', baseEvent.getData());\n\t\t});\n\t}\n\n\tinitStyle(sprint: Sprint)\n\t{\n\t\tthis.sprint = sprint;\n\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-active';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-success ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_COMPLETE_BUTTON');\n\t\t}\n\t\telse if (this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-completed';\n\t\t\tDom.remove(this.buttonNode);\n\t\t\tthis.sprint.hideContent();\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-planned';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-primary ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_START_BUTTON');\n\t\t}\n\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.addHeaderStats(StatsHeaderBuilder.build(this.sprint));\n\t\t\tthis.addHeaderDate(new SprintDate(this.sprint));\n\n\t\t\tif (this.sprint.isDisabled())\n\t\t\t{\n\t\t\t\tDom.remove(this.node.querySelector('.tasks-scrum-sprint-header-remove'));\n\t\t\t}\n\n\t\t\tthis.node.className = '';\n\t\t\tDom.addClass(this.node, 'tasks-scrum-sprint-header ' + this.headerClass);\n\n\t\t\tconst button = this.buttonNode.querySelector('button');\n\t\t\tbutton.className = '';\n\t\t\tDom.addClass(button, this.buttonClass);\n\t\t\tbutton.firstChild.replaceWith(this.buttonText);\n\n\t\t\tDom.replace(this.node.querySelector('.tasks-scrum-sprint-header-params'), this.renderParams());\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header ${this.headerClass}\">\n\t\t\t\t${this.renderDragnDrop()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-name-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-name\">\n\t\t\t\t\t\t${Text.encode(this.sprint.getName())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-edit\"></div>\n\t\t\t\t${this.renderRemove()}\n\t\t\t\t${this.renderParams()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t};\n\n\trenderParams(): HTMLElement\n\t{\n\t\tconst tickAngleClass = (this.sprint.isCompleted() ? 'ui-btn-icon-angle-down' : 'ui-btn-icon-angle-up');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header-params\">\n\t\t\t\t${this.renderStatsHeader()}\n\t\t\t\t${this.sprintDate ? this.sprintDate.createDate() : ''}\n\t\t\t\t${this.createButton()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-tick\">\n\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ${tickAngleClass}\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetStatsHeader(): StatsHeader\n\t{\n\t\treturn this.statsHeader;\n\t}\n\n\trenderDragnDrop(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-dragndrop\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-header-empty\"></div>`;\n\t\t}\n\t}\n\n\trenderRemove(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-header-remove\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t}\n\n\trenderStatsHeader(): HTMLElement\n\t{\n\t\treturn (this.statsHeader ? this.statsHeader.render() : '');\n\t}\n\n\tupdateNameNode(name: string)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.node.querySelector('.tasks-scrum-sprint-header-name').textContent = Text.encode(name);\n\t\t}\n\t}\n\n\tupdateStatsHeader()\n\t{\n\t\tthis.statsHeader.updateStats(this.sprint);\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.updateDateStartNode(timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.updateDateEndNode(timestamp);\n\t\t}\n\t}\n\n\tcreateButton()\n\t{\n\t\tif (this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buttonNodeId = 'tasks-scrum-sprint-header-button-' + this.sprint.getId();\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.buttonNodeId}\" class=\"tasks-scrum-sprint-header-button\">\n\t\t\t\t\t<button class=\"${this.buttonClass}\">${this.buttonText}</button>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t};\n\n\tonAfterAppend()\n\t{\n\t\tif (!this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.buttonNode = document.getElementById(this.buttonNodeId);\n\t\t\tEvent.bind(this.buttonNode, 'click', this.onButtonClick.bind(this));\n\t\t}\n\n\t\tconst nameNode = this.node.querySelector('.tasks-scrum-sprint-header-name-container');\n\t\tconst editButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-edit');\n\t\tEvent.bind(editButtonNode, 'click', () => this.emit('changeName', nameNode));\n\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\tconst removeNode = this.node.querySelector('.tasks-scrum-sprint-header-remove');\n\t\t\tEvent.bind(removeNode, 'click', () => {\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_SPRINT'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tthis.emit('removeSprint');\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\tconst tickButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-tick');\n\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-up');\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-down');\n\t\t\tthis.emit('toggleVisibilityContent');\n\t\t});\n\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.onAfterAppend();\n\t\t}\n\t}\n\n\tonButtonClick()\n\t{\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.emit('completeSprint');\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.emit('startSprint');\n\t\t}\n\t}\n}","import {Loc, Tag} from 'main.core';\n\nexport class EventsHeader\n{\n\tconstructor()\n\t{\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<a class=\"ui-link\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_EVENT')}\n\t\t\t</a>\n\t\t`;\n\n\t\treturn this.element;\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\n\nexport class StoryPointsHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.StoryPointsHeader');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.totalStoryPointsNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point\">\n\t\t\t\t${this.sprint.getTotalStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.inWorkStoryPointsNode = (this.sprint.isActive() ? Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-in-work-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_IN_WORK')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-in-work\">\n\t\t\t\t${this.sprint.getTotalUncompletedStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t` : '');\n\n\t\tthis.doneStoryPointsNode = (this.sprint.isPlanned() ? '' : Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-done-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_DONE')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-done\">\n\t\t\t\t${this.sprint.getTotalCompletedStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t`);\n\n\t\tthis.element = Tag.render`\n\t\t\t${this.renderBurnDownChartIcon()}\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-task\">\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-title\">\n\t\t\t\t\t${this.sprint.getNumberTasks()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t${this.totalStoryPointsNode}\n\t\t\t${this.inWorkStoryPointsNode}\n\t\t\t${this.doneStoryPointsNode}\n\t\t`;\n\n\t\tEvent.bind(this.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-entity-title-btn-burn-down-chart'\n\t\t), 'click', () => this.emit('showSprintBurnDownChart'));\n\n\t\treturn this.element;\n\t}\n\n\trenderBurnDownChartIcon(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-burn-down-chart\">\n\t\t\t\t<span class=\"tasks-scrum-entity-burn-down-chart-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateNumberTasks()\n\t{\n\t\tconst parentNode = this.getElementByClassName(this.element, 'tasks-scrum-entity-title-btn-task');\n\t\tparentNode.querySelector('.tasks-scrum-entity-tasks-title').textContent = this.sprint.getNumberTasks();\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.totalStoryPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.totalStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tsetCompletedStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.doneStoryPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.doneStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point-done'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tsetUncompletedStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.inWorkStoryPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.inWorkStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point-in-work'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tgetElementByClassName(elements: HTMLElement[], className: string): HTMLElement\n\t{\n\t\tlet element = null;\n\t\telements.forEach((elem) => {\n\t\t\tif (elem.classList.contains(className))\n\t\t\t{\n\t\t\t\telement = elem;\n\t\t\t}\n\t\t});\n\t\treturn element;\n\t}\n}","import {Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Entity} from '../entity';\nimport {Item} from '../../item/item';\nimport {SprintHeader} from './sprint.header';\nimport {EventsHeader} from './events.header';\nimport {GroupActionsButton} from '../group.actions.button';\nimport {ListItems} from '../list.items';\nimport {StoryPointsHeader} from './story.points.header';\nimport {StoryPoints} from '../../utility/story.points';\n\nimport type {EpicType, ItemParams} from '../../item/item';\nimport type {Views} from '../../view/view';\n\nimport '../../css/sprint.css';\n\ntype SprintInfo = {\n\tsprintGoal?: string\n}\n\nexport type SprintParams = {\n\tid: number,\n\ttmpId: string,\n\tname: string,\n\tsort: number,\n\tdateStart?: number,\n\tdateEnd?: number,\n\tweekendDaysTime?: number,\n\tdefaultSprintDuration: number,\n\ttotalStoryPoints?: string,\n\ttotalCompletedStoryPoints?: string,\n\ttotalUncompletedStoryPoints?: string,\n\tcompletedTasks?: number,\n\tuncompletedTasks?: number,\n\tstatus?: string,\n\tnumberTasks?: number,\n\titems?: Array<ItemParams>,\n\tinfo?: SprintInfo,\n\tviews: Views\n};\n\nexport class Sprint extends Entity\n{\n\tconstructor(params: SprintParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint');\n\n\t\tthis.setSprintParams(params);\n\n\t\tthis.sprintHeader = null;\n\t\tthis.eventsHeader = null;\n\t\tthis.storyPointsHeader = null;\n\t}\n\n\tsetSprintParams(params: SprintParams)\n\t{\n\t\tthis.setTmpId(params.tmpId);\n\t\tthis.setName(params.name);\n\t\tthis.setSort(params.sort);\n\t\tthis.setDateStart(params.dateStart);\n\t\tthis.setDateEnd(params.dateEnd);\n\t\tthis.setWeekendDaysTime(params.weekendDaysTime);\n\t\tthis.setDefaultSprintDuration(params.defaultSprintDuration);\n\t\tthis.setStatus(params.status);\n\t\tthis.setTotalStoryPoints(params.totalStoryPoints);\n\t\tthis.setTotalCompletedStoryPoints(params.totalCompletedStoryPoints);\n\t\tthis.setTotalUncompletedStoryPoints(params.totalUncompletedStoryPoints);\n\t\tthis.setCompletedTasks(params.completedTasks);\n\t\tthis.setUncompletedTasks(params.uncompletedTasks);\n\t\tthis.setItems(params.items);\n\t\tthis.setInfo(params.info);\n\t}\n\n\tstatic buildSprint(sprintData: SprintParams = {}): Sprint\n\t{\n\t\tconst sprint = new Sprint(sprintData);\n\t\tsprint.addSprintHeader(SprintHeader.buildHeader(sprint));\n\t\tsprint.addEventsHeader(new EventsHeader());\n\t\tsprint.addStoryPointsHeader(new StoryPointsHeader(sprint));\n\t\tsprint.addGroupActionsButton(new GroupActionsButton());\n\t\tsprint.addListItems(new ListItems(sprint));\n\t\treturn sprint;\n\t}\n\n\taddSprintHeader(sprintHeader: SprintHeader)\n\t{\n\t\tthis.sprintHeader = sprintHeader;\n\t\tthis.sprintHeader.initStyle(this);\n\n\t\tthis.sprintHeader.subscribe('changeName', this.onChangeName.bind(this));\n\t\tthis.sprintHeader.subscribe('removeSprint', this.onRemoveSprint.bind(this));\n\t\tthis.sprintHeader.subscribe('completeSprint', () => this.emit('completeSprint'));\n\t\tthis.sprintHeader.subscribe('startSprint', () => this.emit('startSprint'));\n\t\tthis.sprintHeader.subscribe('changeSprintDeadline', this.onChangeSprintDeadline.bind(this));\n\t\tthis.sprintHeader.subscribe('toggleVisibilityContent', this.toggleVisibilityContent.bind(this));\n\t}\n\n\taddStoryPointsHeader(storyPointsHeader: StoryPointsHeader)\n\t{\n\t\tthis.storyPointsHeader = storyPointsHeader;\n\n\t\tthis.storyPointsHeader.subscribe('showSprintBurnDownChart', () => this.emit('showSprintBurnDownChart'));\n\t}\n\n\taddEventsHeader(eventsHeader: EventsHeader)\n\t{\n\t\tthis.eventsHeader = eventsHeader;\n\t}\n\n\tinitStyle()\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.initStyle(this);\n\t\t}\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn (this.getStatus() === 'active');\n\t}\n\n\tisPlanned(): boolean\n\t{\n\t\treturn (this.getStatus() === 'planned');\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn (this.getStatus() === 'completed');\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn (this.isCompleted());\n\t}\n\n\tisExpired(): boolean\n\t{\n\t\tconst sprintEnd = new Date(this.dateEnd * 1000);\n\t\treturn (this.isActive() && (sprintEnd.getTime() < (new Date()).getTime()));\n\t}\n\n\thasInput(): boolean\n\t{\n\t\treturn !this.isDisabled();\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'sprint';\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tsuper.setItem(newItem);\n\t\tnewItem.setDisableStatus(this.isDisabled());\n\t\tthis.updateStoryPoints();\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tsuper.removeItem(item);\n\t\tthis.updateStoryPoints();\n\t}\n\n\tsetName(name)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : '');\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateNameNode(this.name);\n\t\t}\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetTmpId(tmpId: string)\n\t{\n\t\tthis.tmpId = (Type.isString(tmpId) ? tmpId : '');\n\t}\n\n\tgetTmpId(): string\n\t{\n\t\treturn this.tmpId;\n\t}\n\n\tsetSort(sort)\n\t{\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 1);\n\t}\n\n\tgetSort()\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetDateStart(dateStart)\n\t{\n\t\tthis.dateStart = (Type.isInteger(dateStart) ? parseInt(dateStart, 10) : 0);\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateStartNode(this.dateStart);\n\t\t}\n\t}\n\n\tgetDateStart(): number\n\t{\n\t\treturn parseInt(this.dateStart, 10);\n\t}\n\n\tsetDateEnd(dateEnd)\n\t{\n\t\tthis.dateEnd = (Type.isInteger(dateEnd) ? parseInt(dateEnd, 10) : 0);\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateEndNode(this.dateEnd);\n\t\t}\n\t}\n\n\tgetDateEnd(): number\n\t{\n\t\treturn parseInt(this.dateEnd, 10);\n\t}\n\n\tsetWeekendDaysTime(weekendDaysTime)\n\t{\n\t\tthis.weekendDaysTime = (Type.isInteger(weekendDaysTime) ? parseInt(weekendDaysTime, 10) : 0);\n\t}\n\n\tgetWeekendDaysTime(): number\n\t{\n\t\treturn this.weekendDaysTime;\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\treturn this.totalStoryPoints;\n\t}\n\n\tsetTotalStoryPoints(totalStoryPoints)\n\t{\n\t\tthis.totalStoryPoints = new StoryPoints();\n\t\tthis.totalStoryPoints.addPoints(totalStoryPoints);\n\t}\n\n\tgetTotalStoryPoints(): StoryPoints\n\t{\n\t\treturn this.totalStoryPoints;\n\t}\n\n\tsetTotalCompletedStoryPoints(totalCompletedStoryPoints)\n\t{\n\t\tthis.totalCompletedStoryPoints = new StoryPoints();\n\t\tthis.totalCompletedStoryPoints.addPoints(totalCompletedStoryPoints);\n\t}\n\n\tgetTotalCompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.totalCompletedStoryPoints;\n\t}\n\n\tsetTotalUncompletedStoryPoints(totalUncompletedStoryPoints)\n\t{\n\t\tthis.totalUncompletedStoryPoints = new StoryPoints();\n\t\tthis.totalUncompletedStoryPoints.addPoints(totalUncompletedStoryPoints);\n\t}\n\n\tgetTotalUncompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.totalUncompletedStoryPoints;\n\t}\n\n\tsetItems(items)\n\t{\n\t\tif (!Type.isArray(items))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titems.forEach((itemParams: ItemParams) => {\n\t\t\tconst item = new Item(itemParams);\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t\tthis.items.set(item.itemId, item);\n\t\t});\n\t}\n\n\tsetInfo(info: SprintInfo)\n\t{\n\t\tthis.info = (Type.isPlainObject(info) ? info : {sprintGoal: ''});\n\t}\n\n\taddNumberTasks(value: number)\n\t{\n\t\tsuper.addNumberTasks(value);\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.updateNumberTasks();\n\t\t}\n\t}\n\n\tsubtractNumberTasks(value: number)\n\t{\n\t\tsuper.subtractNumberTasks(value);\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.updateNumberTasks();\n\t\t}\n\t}\n\n\tsetCompletedTasks(completedTasks)\n\t{\n\t\tthis.completedTasks = (Type.isInteger(completedTasks) ? parseInt(completedTasks, 10) : 0);\n\t}\n\n\tgetCompletedTasks(): number\n\t{\n\t\treturn this.completedTasks;\n\t}\n\n\tsetUncompletedTasks(uncompletedTasks)\n\t{\n\t\tthis.uncompletedTasks = (Type.isInteger(uncompletedTasks) ? parseInt(uncompletedTasks, 10) : 0);\n\t}\n\n\tgetUncompletedTasks(): number\n\t{\n\t\treturn this.uncompletedTasks;\n\t}\n\n\tsetDefaultSprintDuration(defaultSprintDuration)\n\t{\n\t\tthis.defaultSprintDuration = (Type.isInteger(defaultSprintDuration) ? parseInt(defaultSprintDuration, 10) : 0);\n\t}\n\n\tgetDefaultSprintDuration()\n\t{\n\t\treturn this.defaultSprintDuration;\n\t}\n\n\tgetInfo(): SprintInfo\n\t{\n\t\treturn this.info;\n\t}\n\n\tgetEpics(): Map<number, EpicType>\n\t{\n\t\tconst epics = new Map();\n\t\tthis.items.forEach((item: Item) => {\n\t\t\t//todo wtf, why did not Set work?\n\t\t\tif (item.getEpic())\n\t\t\t{\n\t\t\t\tepics.set(item.getEpic().id, item.getEpic());\n\t\t\t}\n\t\t});\n\t\treturn epics;\n\t}\n\n\tgetUncompletedItems(): Map<string, Item>\n\t{\n\t\tconst items = new Map();\n\t\tthis.items.forEach((item: Item) => {\n\t\t\tif (!item.isCompleted())\n\t\t\t{\n\t\t\t\titems.set(item.getItemId(), item);\n\t\t\t}\n\t\t});\n\t\treturn items;\n\t}\n\n\tsetStatus(status)\n\t{\n\t\tconst availableStatus = new Set([\n\t\t\t'planned',\n\t\t\t'active',\n\t\t\t'completed'\n\t\t]);\n\n\t\tthis.status = (availableStatus.has(status) ? status : 'planned');\n\n\t\tthis.initStyle();\n\n\t\tthis.items.forEach((item) => {\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t});\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\tif (this.input)\n\t\t\t{\n\t\t\t\tthis.input.removeYourself();\n\t\t\t}\n\t\t\tif (this.groupActionsButton)\n\t\t\t{\n\t\t\t\tthis.groupActionsButton.removeYourself();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetStatus(): string\n\t{\n\t\treturn this.status;\n\t}\n\n\tupdateYourself(tmpSprint: Sprint)\n\t{\n\t\tif (tmpSprint.getName() !== this.getName())\n\t\t{\n\t\t\tthis.setName(tmpSprint.getName());\n\t\t}\n\t\tif (tmpSprint.getDateStart() !== this.getDateStart())\n\t\t{\n\t\t\tthis.setDateStart(tmpSprint.getDateStart());\n\t\t}\n\t\tif (tmpSprint.getDateEnd() !== this.getDateEnd())\n\t\t{\n\t\t\tthis.setDateEnd(tmpSprint.getDateEnd());\n\t\t}\n\n\t\tthis.setTotalStoryPoints(tmpSprint.getTotalStoryPoints().getPoints());\n\t\tthis.setTotalCompletedStoryPoints(tmpSprint.getTotalCompletedStoryPoints().getPoints());\n\t\tthis.setTotalUncompletedStoryPoints(tmpSprint.getTotalUncompletedStoryPoints().getPoints());\n\n\t\tif (tmpSprint.getStatus() !== this.getStatus())\n\t\t{\n\t\t\tthis.setStatus(tmpSprint.getStatus());\n\t\t}\n\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.addStoryPointsHeader(new StoryPointsHeader(this));\n\t\t\tDom.replace(this.node.querySelector('.tasks-scrum-sprint-header-event-params'), this.renderParams());\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t\tthis.emit('removeSprint');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint\" data-sprint-sort=\"${this.sort}\" data-sprint-id=\"${this.getId()}\">\n\t\t\t\t${this.sprintHeader ? this.sprintHeader.render() : ''}\n\t\t\t\t<div class=\"tasks-scrum-sprint-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sub-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-event\">\n\t\t\t\t\t\t\t${this.eventsHeader ? '' : ''/*todo*/}\n\t\t\t\t\t\t\t${this.isCompleted() ? this.renderLinkToCompletedSprint() : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.renderParams()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-actions\">\n\t\t\t\t\t\t${this.groupActionsButton  && !this.isDisabled() ? this.groupActionsButton.render() : ''}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-items\">\n\t\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\trenderParams(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header-event-params\">\n\t\t\t\t${this.storyPointsHeader ? this.storyPointsHeader.render() : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderLinkToCompletedSprint(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<a href=\"${Text.encode(this.getViews().completedSprint.url)}\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_COMPLETED_SPRINT_LINK')}\n\t\t\t</a>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.updateVisibility();\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.onAfterAppend();\n\t\t}\n\n\t\tsuper.onAfterAppend();\n\t}\n\n\tupdateStoryPoints()\n\t{\n\t\tsuper.updateStoryPoints();\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.totalStoryPoints.clearPoints();\n\t\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\t\tif (!item.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tthis.totalStoryPoints.addPoints(item.getStoryPoints().getPoints());\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.totalCompletedStoryPoints.clearPoints();\n\t\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\t\tif (item.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tif (!item.isSubTask())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.totalCompletedStoryPoints.addPoints(item.getStoryPoints().getPoints());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (item.isParentTask())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.totalCompletedStoryPoints.addPoints(\n\t\t\t\t\t\t\titem.getCompletedSubTasksStoryPoints().getPoints()\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.totalUncompletedStoryPoints.clearPoints();\n\t\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\t\tif (!item.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tif (!item.isSubTask())\n\t\t\t\t\t{\n\t\t\t\t\t\tlet storyPoints = item.getStoryPoints().getPoints();\n\t\t\t\t\t\tif (item.isParentTask())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstoryPoints = item.getUncompletedSubTasksStoryPoints().getPoints();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.totalUncompletedStoryPoints.addPoints(storyPoints);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (item.isParentTask())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.totalUncompletedStoryPoints.addPoints(\n\t\t\t\t\t\t\titem.getUncompletedSubTasksStoryPoints().getPoints()\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tif (this.isActive())\n\t\t\t{\n\t\t\t\tthis.updateActiveSprintStoryPointsHeader();\n\t\t\t}\n\t\t\telse if (this.isCompleted())\n\t\t\t{\n\t\t\t\tthis.storyPointsHeader.setStoryPoints(this.getTotalStoryPoints().getPoints());\n\t\t\t\tthis.storyPointsHeader.setCompletedStoryPoints(this.getTotalCompletedStoryPoints().getPoints());\n\t\t\t}\n\t\t\telse if (this.isPlanned())\n\t\t\t{\n\t\t\t\tthis.storyPointsHeader.setStoryPoints(this.storyPoints.getPoints());\n\t\t\t}\n\t\t}\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateStatsHeader();\n\t\t}\n\t}\n\n\taddTotalStoryPoints(item: Item)\n\t{\n\t\tconst itemStoryPoints = item.getStoryPoints().getPoints();\n\n\t\tthis.getTotalStoryPoints().addPoints(itemStoryPoints);\n\t\tif (item.isCompleted())\n\t\t{\n\t\t\tthis.getTotalCompletedStoryPoints().addPoints(itemStoryPoints);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTotalUncompletedStoryPoints().addPoints(itemStoryPoints);\n\t\t}\n\t}\n\n\tsubtractTotalStoryPoints(item: Item)\n\t{\n\t\tconst itemStoryPoints = item.getStoryPoints().getPoints();\n\n\t\tthis.getTotalStoryPoints().subtractPoints(itemStoryPoints);\n\t\tif (item.isCompleted())\n\t\t{\n\t\t\tthis.getTotalCompletedStoryPoints().subtractPoints(itemStoryPoints);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTotalUncompletedStoryPoints().subtractPoints(itemStoryPoints);\n\t\t}\n\t}\n\n\tupdateActiveSprintStoryPointsHeader()\n\t{\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.setStoryPoints(this.getTotalStoryPoints().getPoints());\n\t\t\tthis.storyPointsHeader.setCompletedStoryPoints(this.getTotalCompletedStoryPoints().getPoints());\n\t\t\tthis.storyPointsHeader.setUncompletedStoryPoints(this.getTotalUncompletedStoryPoints().getPoints());\n\t\t}\n\t}\n\n\tsubscribeToItem(item)\n\t{\n\t\tsuper.subscribeToItem(item);\n\n\t\titem.subscribe('moveToBacklog', (baseEvent) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: baseEvent.getTarget()\n\t\t\t});\n\t\t});\n\n\t\titem.subscribe('updateCompletedStatus', (baseEvent: BaseEvent) => {\n\t\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\t\tif (item.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tthis.setCompletedTasks(this.getCompletedTasks() + 1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.setUncompletedTasks(this.getUncompletedTasks() - 1);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\titem.subscribe('toggleSubTasks', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('toggleSubTasks', baseEvent.getTarget());\n\t\t})\n\t}\n\n\tonChangeName (baseEvent)\n\t{\n\t\tconst createInput = (value) => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input type=\"text\" class=\"tasks-scrum-sprint-header-name\" value=\"${Text.encode(value)}\">\n\t\t\t`;\n\t\t};\n\n\t\tconst inputNode = createInput(this.name);\n\t\tconst nameNode = baseEvent.getData().querySelector('.tasks-scrum-sprint-header-name');\n\n\t\tEvent.bind(inputNode, 'change', (event) => {\n\t\t\tconst newValue = event.target['value'];\n\t\t\tthis.emit('changeSprintName', {\n\t\t\t\tsprintId: this.getId(),\n\t\t\t\tname: newValue\n\t\t\t});\n\t\t\tthis.name = newValue;\n\t\t\tinputNode.blur();\n\t\t}, true);\n\n\t\tconst blockEnterInput = (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t\tinputNode.blur();\n\t\t};\n\n\t\tEvent.bind(inputNode, 'keydown', blockEnterInput);\n\t\tEvent.bindOnce(inputNode, 'blur', () => {\n\t\t\tEvent.unbind(inputNode, 'keydown', blockEnterInput);\n\t\t\tnameNode.textContent = Text.encode(this.name);\n\t\t\tDom.replace(inputNode, nameNode);\n\t\t}, true);\n\n\t\tDom.replace(nameNode, inputNode);\n\n\t\tinputNode.focus();\n\t\tinputNode.setSelectionRange(this.name.length, this.name.length);\n\t}\n\n\tonRemoveSprint()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: item\n\t\t\t});\n\t\t});\n\t\tthis.removeYourself();\n\t}\n\n\tremoveSprint()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: item\n\t\t\t});\n\t\t});\n\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t}\n\n\tonChangeSprintDeadline(baseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.emit('changeSprintDeadline', requestData);\n\t\tif (requestData.hasOwnProperty('dateStart'))\n\t\t{\n\t\t\tthis.dateStart = parseInt(requestData.dateStart, 10);\n\t\t}\n\t\telse if (requestData.hasOwnProperty('dateEnd'))\n\t\t{\n\t\t\tthis.dateEnd = parseInt(requestData.dateEnd, 10);\n\t\t}\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateStartNode(timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateEndNode(timestamp);\n\t\t}\n\t}\n\n\ttoggleVisibilityContent()\n\t{\n\t\tif (this.getContentNode().style.display === 'block')\n\t\t{\n\t\t\tthis.hideContent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showContent();\n\t\t\tif (this.isCompleted() && this.getItems().size === 0)\n\t\t\t{\n\t\t\t\tthis.emit('getSprintCompletedItems');\n\t\t\t}\n\t\t}\n\t}\n\n\tshowContent()\n\t{\n\t\tif (this.getContentNode())\n\t\t{\n\t\t\tthis.getContentNode().style.display = 'block';\n\t\t}\n\t}\n\n\thideContent()\n\t{\n\t\tif (this.getContentNode())\n\t\t{\n\t\t\tthis.getContentNode().style.display = 'none';\n\t\t}\n\t}\n\n\tupdateVisibility()\n\t{\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tif (this.isEmpty())\n\t\t\t{\n\t\t\t\tthis.hideContent();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showContent();\n\t\t\t}\n\n\t\t\tthis.showSprint();\n\n\t\t\tif (this.isExactSearchApplied())\n\t\t\t{\n\t\t\t\tif (this.isEmpty())\n\t\t\t\t{\n\t\t\t\t\tthis.hideSprint();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showContent();\n\n\t\t\tif (this.isExactSearchApplied())\n\t\t\t{\n\t\t\t\tif (this.isEmpty())\n\t\t\t\t{\n\t\t\t\t\tthis.hideSprint();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showSprint();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showSprint();\n\t\t\t}\n\t\t}\n\t}\n\n\tshowSprint()\n\t{\n\t\tthis.node.style.display = 'block';\n\t}\n\n\thideSprint()\n\t{\n\t\tthis.node.style.display = 'none';\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onActivateGroupMode(baseEvent);\n\n\t\tDom.addClass(this.node.querySelector('.tasks-scrum-sprint-items'), 'tasks-scrum-sprint-items-group-mode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onDeactivateGroupMode(baseEvent);\n\n\t\tDom.removeClass(this.node.querySelector('.tasks-scrum-sprint-items'), 'tasks-scrum-sprint-items-group-mode');\n\t}\n\n\tgetContentNode(): HTMLElement\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\treturn this.node.querySelector('.tasks-scrum-sprint-content');\n\t\t}\n\t}\n}","import {Dom} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\n\nexport class SidePanel extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SidePanel');\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\tthis.contentSidePanelManager = new BX.SidePanel.Manager({});\n\t\t/* eslint-enable */\n\n\t\tthis.contentSidePanels = new Set();\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onLoad', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tsidePanel.setCacheable(false);\n\t\t\tthis.emit('onLoadSidePanel', sidePanel);\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tthis.emit('onCloseSidePanel', sidePanel);\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseComplete', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tif (this.contentSidePanels.has(sidePanel.getUrl()))\n\t\t\t{\n\t\t\t\tthis.contentSidePanels.delete(sidePanel.getUrl());\n\t\t\t\tif (!this.contentSidePanels.size)\n\t\t\t\t{\n\t\t\t\t\tthis.resetBodyWidthHack();\n\t\t\t\t\tthis.addEscapePressHandler();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tisPreviousSidePanelExist(currentSidePanel): Boolean\n\t{\n\t\tconst manager = this.contentSidePanels.has(currentSidePanel.getUrl())\n\t\t\t? this.contentSidePanelManager\n\t\t\t: this.sidePanelManager\n\t\t;\n\n\t\treturn Boolean(manager.getPreviousSlider(currentSidePanel));\n\t}\n\n\treloadTopSidePanel(contentSidePanel: boolean = false)\n\t{\n\t\tconst manager = contentSidePanel ? this.contentSidePanelManager : this.sidePanelManager;\n\n\t\tif (manager.getTopSlider())\n\t\t{\n\t\t\tmanager.getTopSlider().reload();\n\t\t}\n\t}\n\n\tcloseTopSidePanel(contentSidePanel: boolean = false)\n\t{\n\t\tconst manager = contentSidePanel ? this.contentSidePanelManager : this.sidePanelManager;\n\n\t\tif (manager.getTopSlider())\n\t\t{\n\t\t\tmanager.getTopSlider().close();\n\t\t}\n\t}\n\n\treloadPreviousSidePanel(currentSidePanel)\n\t{\n\t\tconst manager = this.contentSidePanels.has(currentSidePanel.getUrl())\n\t\t\t? this.contentSidePanelManager\n\t\t\t: this.sidePanelManager\n\t\t;\n\t\tconst previousSidePanel = manager.getPreviousSlider(currentSidePanel);\n\n\t\tpreviousSidePanel.reload();\n\t}\n\n\topenSidePanelByUrl(url)\n\t{\n\t\tthis.sidePanelManager.open(url);\n\t}\n\n\topenSidePanel(id, options)\n\t{\n\t\tthis.applyBodyWidthHack();\n\t\tthis.removeEscapePressHandler();\n\n\t\tthis.contentSidePanelManager.open(id, options);\n\n\t\tthis.contentSidePanels.add(id);\n\t}\n\n\texistFrameTopSlider(): boolean\n\t{\n\t\treturn Boolean(this.sidePanelManager.getTopSlider());\n\t}\n\n\taddEscapePressHandler()\n\t{\n\t\tconst sidePanel = this.sidePanelManager.getTopSlider();\n\t\tif (sidePanel)\n\t\t{\n\t\t\tconst frameWindow = sidePanel.getFrameWindow();\n\t\t\tframeWindow.addEventListener('keydown', sidePanel.handleFrameKeyDown);\n\t\t}\n\t}\n\n\tremoveEscapePressHandler()\n\t{\n\t\tconst sidePanel = this.sidePanelManager.getTopSlider();\n\t\tif (sidePanel)\n\t\t{\n\t\t\tconst frameWindow = sidePanel.getFrameWindow();\n\t\t\tframeWindow.removeEventListener('keydown', sidePanel.handleFrameKeyDown);\n\t\t}\n\t}\n\n\tapplyBodyWidthHack()\n\t{\n\t\tif (this.existFrameTopSlider())\n\t\t{\n\t\t\tDom.addClass(document.body, 'tasks-scrum-side-panel-padding');\n\t\t}\n\t}\n\n\tresetBodyWidthHack()\n\t{\n\t\tif (this.existFrameTopSlider())\n\t\t{\n\t\t\tDom.removeClass(document.body, 'tasks-scrum-side-panel-padding');\n\t\t}\n\t}\n}","import {Loc} from 'main.core';\n\ntype Data = {\n\tday: number,\n\tidealValue: number,\n\tremainValue: number\n}\n\n//todo import amchart4 like es6\nexport class BurnDownChart\n{\n\tconstructor(data: Data)\n\t{\n\t\tthis.data = data;\n\t}\n\n\tcreateChart(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\n\t\tthis.createAxises();\n\n\t\tthis.createIdealLine();\n\t\tthis.createRemainLine();\n\n\t\tthis.createLegend();\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst categoryAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\tcategoryAxis.renderer.grid.template.location = 0;\n\t\tcategoryAxis.dataFields.category = 'day';\n\t\tcategoryAxis.renderer.minGridDistance = 60;\n\n\t\tconst valueAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tvalueAxis.min = -0.1;\n\t}\n\n\tcreateIdealLine()\n\t{\n\t\tconst lineSeries = this.chart.series.push(new am4charts.LineSeries());\n\t\tlineSeries.name = Loc.getMessage('TASKS_SCRUM_SPRINT_IDEAL_BURN_DOWN_CHART_LINE_TITLE'); //todo move from class\n\t\tlineSeries.stroke = am4core.color('#2882b3');\n\t\tlineSeries.strokeWidth = 2;\n\n\t\tlineSeries.dataFields.categoryX = 'day';\n\t\tlineSeries.dataFields.valueY = 'idealValue';\n\n\t\tconst circleColor = '#2882b3';\n\t\tconst circleBullet = new am4charts.CircleBullet();\n\t\tcircleBullet.circle.radius = 4;\n\t\tcircleBullet.circle.fill = am4core.color(circleColor);\n\t\tcircleBullet.circle.stroke = am4core.color(circleColor);\n\n\t\tlineSeries.bullets.push(circleBullet);\n\n\t\tconst segment = lineSeries.segments.template;\n\t\tconst hoverState = segment.states.create('hover');\n\t\thoverState.properties.strokeWidth = 4;\n\t}\n\n\tcreateRemainLine()\n\t{\n\t\tconst lineSeries = this.chart.series.push(new am4charts.LineSeries());\n\t\tlineSeries.name = Loc.getMessage('TASKS_SCRUM_SPRINT_REMAIN_BURN_DOWN_CHART_LINE_TITLE'); //todo move from class\n\t\tlineSeries.stroke = am4core.color('#9c1f1f');\n\t\tlineSeries.strokeWidth = 2;\n\n\t\tlineSeries.dataFields.categoryX = 'day';\n\t\tlineSeries.dataFields.valueY = 'remainValue';\n\n\t\tconst circleColor = '#9c1f1f';\n\t\tconst circleBullet = new am4charts.CircleBullet();\n\t\tcircleBullet.circle.radius = 4;\n\t\tcircleBullet.circle.fill = am4core.color(circleColor);\n\t\tcircleBullet.circle.stroke = am4core.color(circleColor);\n\n\t\tlineSeries.bullets.push(circleBullet);\n\n\t\tconst segment = lineSeries.segments.template;\n\t\tconst hoverState = segment.states.create('hover');\n\t\thoverState.properties.strokeWidth = 4;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.itemContainers.template.events.on('over', (event) => {\n\t\t\tthis.processOver(event.target.dataItem.dataContext);\n\t\t});\n\t\tthis.chart.legend.itemContainers.template.events.on('out', () => this.processOut());\n\t}\n\n\tprocessOver(hoveredLine)\n\t{\n\t\thoveredLine.toFront();\n\t\thoveredLine.segments.each((segment) => segment.setState('hover'));\n\t};\n\n\tprocessOut()\n\t{\n\t\tthis.chart.series.each((series) => {\n\t\t\tseries.segments.each((segment) => segment.setState('default'));\n\t\t\tseries.bulletsContainer.setState('default');\n\t\t});\n\t};\n\n\tdestroyBurnDownChart()\n\t{\n\t\tthis.chart.dispose();\n\t}\n}","import {Event, Loc, Runtime, Tag, Text, Dom, Type} from 'main.core';\nimport {Sprint} from './sprint';\nimport {SidePanel} from '../../service/side.panel';\nimport {RequestSender} from '../../utility/request.sender';\nimport {BaseEvent} from 'main.core.events';\nimport {Confetti} from 'ui.confetti';\nimport {StatsCalculator} from '../../utility/stats.calculator';\nimport {BurnDownChart} from '../../utility/burn.down.chart';\n\nimport '../../css/sprint.side.panel.css';\n\ntype Params = {\n\tsprints?: Map,\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender,\n\tviews: {\n\t\tplan: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tactiveSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tcompletedSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t}\n\t}\n};\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tinfo: EpicInfoType\n}\n\ntype RequestDataToStartSprint = {\n\tsprintId: number,\n\tsprintGoal: string\n}\n\ntype RequestDataToCompleteSprint = {\n\tsprintId: number,\n\tdirection: number|string\n}\n\ntype RequestDataToGetBurnDownChartData = {\n\tsprintId: number\n}\n\nexport class SprintSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sprints = params.sprints ? params.sprints : new Map();\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.views = params.views;\n\n\t\tthis.currentSprint = null;\n\t\tthis.uncompletedItems = new Map();\n\n\t\tthis.lastCompletedSprint = this.getLastCompletedSprint(this.sprints);\n\t}\n\n\tshowStartSidePanel(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-start-side-panel';\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadStartPanel.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildStartPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000,\n\t\t\twidth: 600\n\t\t});\n\t}\n\n\tshowCompleteSidePanel(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-complete-side-panel';\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadCompletePanel.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildCompletePanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000,\n\t\t\twidth: 600\n\t\t});\n\t}\n\n\tshowBurnDownChart(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-burn-down-chart';\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadSprintBurnDownPanel.bind(this));\n\t\tthis.sidePanel.subscribe('onCloseSidePanel', this.onCloseBurnDownChart.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildBurnDownPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildStartPanel(): HTMLElement\n\t{\n\t\tlet differenceStoryPoints = this.currentSprint.getTotalStoryPoints().getPoints();\n\t\tdifferenceStoryPoints = (differenceStoryPoints > 0 ? '+' + differenceStoryPoints : differenceStoryPoints);\n\t\tif (this.lastCompletedSprint)\n\t\t{\n\t\t\tdifferenceStoryPoints = this.getDifferenceStoryPointsBetweenSprints(\n\t\t\t\tthis.currentSprint,\n\t\t\t\tthis.lastCompletedSprint\n\t\t\t);\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_TASK_COUNT_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t\t${parseInt(this.currentSprint.getNumberTasks())}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box tasks-scrum-sprint-sidepanel-info-box-story\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_STORY_POINTS_COUNT_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t\t${Text.encode(this.currentSprint.getTotalStoryPoints().getPoints())}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-extra\">\n\t\t\t\t\t\t\t\t\t${differenceStoryPoints}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_EPICS_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic-list\">\n\t\t\t\t\t\t\t\t${[...this.currentSprint.getEpics().values()].map((epic: EpicType) => {\n\t\t\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-epic-item\" style=\"background: ${Text.encode(epic.info.color)};\">\n\t\t\t\t\t\t\t\t\t\t\t${Text.encode(epic.name)}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_GOAL_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea ui-ctl-resize-y\">\n\t\t\t\t\t\t\t<textarea class=\"ui-ctl-element\"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadStartPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\n\t\tthis.onLoadStartButtons().then((buttonsContainer: HTMLElement) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', this.onStartSprint.bind(this));\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tbuildCompletePanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t${this.buildSprintGoal()}\n\t\t\t\t${this.buildSprintActions()}\n\t\t\t\t${this.buildSprintPlan()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildBurnDownPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_IDEAL_BURN_DOWN_CHART_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-chart\"></div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintGoal(): HTMLElement|string\n\t{\n\t\tconst sprintInfo = this.currentSprint.getInfo();\n\t\tconst sprintGoal = sprintInfo.sprintGoal;\n\t\tif (!sprintGoal)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_GOAL_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-text\">\n\t\t\t\t\t\t${Text.encode(sprintGoal)}\n\t\t\t\t\t </div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintActions(): HTMLElement|string\n\t{\n\t\tconst uncompletedTasks = this.currentSprint.getUncompletedTasks();\n\t\tif (uncompletedTasks === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tlet listSprintsOptions = '';\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tif (sprint.isPlanned())\n\t\t\t{\n\t\t\t\tlistSprintsOptions += `<option value=\"${sprint.getId()}\">${Text.encode(sprint.getName())}</option>`;\n\t\t\t}\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title tasks-scrum-sprint-sidepanel-title-icon\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-field\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-label\">\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_SELECT')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t<select class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t\t<option value=\"backlog\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_MOVE_SELECTOR_BACKLOG')}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t<option value=\"0\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_NEW_SPRINT')}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t${listSprintsOptions}\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-uncompleted\">\n\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-subtitle\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_ITEM_LIST')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-uncompleted-list\">\n\t\t\t\t\t\t\t${[...this.currentSprint.getUncompletedItems().values()].map((item: Item) => {\n\t\t\t\t\t\t\t\tif (!item.isSubTask())\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst previewItem = item.getPreviewVersion();\n\t\t\t\t\t\t\t\t\tthis.uncompletedItems.set(previewItem.getItemId(), previewItem);\n\t\t\t\t\t\t\t\t\treturn previewItem.render();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintPlan(): HTMLElement\n\t{\n\t\tconst statsCalculator = new StatsCalculator();\n\t\tconst percentage = statsCalculator.calculatePercentage(\n\t\t\tthis.currentSprint.getTotalStoryPoints().getPoints(),\n\t\t\tthis.currentSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\tlet differencePercentage = statsCalculator.calculatePercentage(\n\t\t\tthis.currentSprint.getTotalStoryPoints().getPoints(),\n\t\t\tthis.currentSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\t\tif (this.lastCompletedSprint)\n\t\t{\n\t\t\tdifferencePercentage = this.getDifferencePercentageBetweenSprints(\n\t\t\t\tthis.currentSprint,\n\t\t\t\tthis.lastCompletedSprint\n\t\t\t);\n\t\t}\n\n\t\tconst percentageNodeClass = (differencePercentage > 0 ? '' : 'tasks-scrum-sprint-sidepanel-info-dif-min');\n\t\tconst absoluteValue = Math.abs(differencePercentage);\n\t\tconst speedInfoMessage = (differencePercentage > 0 ?\n\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED_UP').replace('#value#', absoluteValue) :\n\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED_DOWN').replace('#value#', absoluteValue)\n\t\t);\n\n\t\tconst renderSpeed = (speedInfoMessage) => {\n\t\t\treturn ''; //todo chart\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-speed\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-subtitle\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED')}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-result\">${speedInfoMessage}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-graph\"></div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_PLAN_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box tasks-scrum-sprint-sidepanel-info-box-w100\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_PLAN_DONE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t${percentage}%\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif ${percentageNodeClass}\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-arrow\"></span>\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-dif-block\">\n\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-val\">${absoluteValue}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-icon\">%</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${renderSpeed()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadCompletePanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\t\tconst itemsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-uncompleted-list');\n\n\t\t[...this.uncompletedItems.values()].map((previewItem: Item) => {\n\t\t\tpreviewItem.onAfterAppend(itemsContainer);\n\t\t\tpreviewItem.subscribe('showTask', () => {\n\t\t\t\tthis.currentSprint.emit('showTask', previewItem);\n\t\t\t});\n\t\t});\n\n\t\tthis.onLoadCompleteButtons().then((buttonsContainer: HTMLElement) => {\n\t\t\tEvent.bind(\n\t\t\t\tbuttonsContainer.querySelector('[name=save]'),\n\t\t\t\t'click',\n\t\t\t\tthis.onCompleteSprint.bind(this, sidePanel)\n\t\t\t);\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tonLoadSprintBurnDownPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\n\t\tthis.getBurnDownChartData().then((data) => {\n\n\t\t\tsidePanel.closeLoader();\n\t\t\t\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.burnDownChart = new BurnDownChart(data);\n\t\t\t\tthis.burnDownChart.createChart(this.form.querySelector('.tasks-scrum-sprint-sidepanel-chart'));\n\t\t\t}, 300);\n\n\t\t});\n\t}\n\n\tonCloseBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tif (this.sidePanelId === sidePanel.getUrl())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.burnDownChart)\n\t\t\t\t{\n\t\t\t\t\tthis.burnDownChart.destroyBurnDownChart();\n\t\t\t\t\tthis.burnDownChart = null;\n\t\t\t\t}\n\t\t\t}, 300);\n\t\t}\n\t}\n\n\tgetTasksCountLabel(count)\n\t{\n\t\tif (count > 5)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_3');\n\t\t}\n\t\telse if (count === 1)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_2');\n\t\t}\n\t}\n\n\tgetLastCompletedSprint(sprints: Map): Sprint\n\t{\n\t\treturn [...sprints.values()].find((sprint) => sprint.isCompleted() === true);\n\t}\n\n\tgetDifferenceStoryPointsBetweenSprints(firstSprint: Sprint, secondSprint: Sprint): string\n\t{\n\t\tlet difference = parseFloat(\n\t\t\tfirstSprint.getTotalStoryPoints().getPoints() - secondSprint.getTotalStoryPoints().getPoints()\n\t\t);\n\n\t\tif (Type.isFloat(difference))\n\t\t{\n\t\t\tdifference = difference.toFixed(1);\n\t\t}\n\n\t\tif (difference === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn (difference > 0 ? '+' + difference : difference);\n\t\t}\n\t}\n\n\tgetDifferencePercentageBetweenSprints(firstSprint: Sprint, secondSprint: Sprint): number\n\t{\n\t\tconst statsCalculator = new StatsCalculator();\n\n\t\tconst firstPercentage = statsCalculator.calculatePercentage(\n\t\t\tfirstSprint.getTotalStoryPoints().getPoints(),\n\t\t\tfirstSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\tconst secondPercentage = statsCalculator.calculatePercentage(\n\t\t\tsecondSprint.getTotalStoryPoints().getPoints(),\n\t\t\tsecondSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\treturn parseFloat(firstPercentage) - parseFloat(secondPercentage);\n\t}\n\n\tgetStartButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getSprintStartButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetCompleteButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getSprintCompleteButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetBurnDownChartData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getBurnDownChartData(this.getRequestDataToGetBurnDownChartData()).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t})\n\t\t});\n\t}\n\n\tonLoadStartButtons(): Promise\n\t{\n\t\treturn this.getStartButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadCompleteButtons(): Promise\n\t{\n\t\treturn this.getCompleteButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonStartSprint()\n\t{\n\t\tthis.requestSender.startSprint(this.getRequestDataToStartSprint()).then((response) => {\n\t\t\tthis.currentSprint.setStatus('active');\n\t\t\tlocation.href = this.views['activeSprint'].url;\n\t\t}).catch((response) => {\n\t\t\tthis.removeClockIconFromButton();\n\t\t\tthis.requestSender.showErrorAlert(response, Loc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP'));\n\t\t});\n\t}\n\n\tonCompleteSprint(sidePanel)\n\t{\n\t\tthis.requestSender.completeSprint(this.getRequestDataToCompleteSprint()).then((response) => {\n\t\t\tif (Confetti)\n\t\t\t{\n\t\t\t\tConfetti.fire({\n\t\t\t\t\tparticleCount: 400,\n\t\t\t\t\tspread: 80,\n\t\t\t\t\torigin: {\n\t\t\t\t\t\tx: 0.7,\n\t\t\t\t\t\ty: 0.2\n\t\t\t\t\t},\n\t\t\t\t\tzIndex: (sidePanel.getZindex() + 1)\n\t\t\t\t}).then(() => {\n\t\t\t\t\tlocation.href = this.views['plan'].url;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlocation.href = this.views['plan'].url;\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.removeClockIconFromButton();\n\t\t\tthis.requestSender.showErrorAlert(response, Loc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP'));\n\t\t});\n\t}\n\n\tgetRequestDataToStartSprint(): RequestDataToStartSprint\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\t\trequestData.sprintGoal = this.form.querySelector('textarea').value;\n\n\t\treturn requestData;\n\t}\n\n\tgetRequestDataToCompleteSprint(): RequestDataToCompleteSprint\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\t\tconst directionSelectNode = this.form.querySelector('select');\n\t\trequestData.direction = (directionSelectNode ? directionSelectNode.value : 'backlog');\n\n\t\treturn requestData;\n\t}\n\n\tgetRequestDataToGetBurnDownChartData(): RequestDataToGetBurnDownChartData\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\n\t\treturn requestData;\n\t}\n\n\tremoveClockIconFromButton()\n\t{\n\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\tif (buttonsContainer)\n\t\t{\n\t\t\tDom.removeClass(buttonsContainer.querySelector('[name=save]'), 'ui-btn-wait');\n\t\t}\n\t}\n}","import {Entity} from '../entity/entity';\nimport {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\n\nexport class EntityStorage\n{\n\tconstructor()\n\t{\n\t\tthis.backlog = null;\n\t\tthis.sprints = new Map();\n\t}\n\n\taddBacklog(backlog: Backlog)\n\t{\n\t\tif (!(backlog instanceof Backlog))\n\t\t{\n\t\t\tthrow new Error('EntityStorage: Backlog is in wrong format');\n\t\t}\n\n\t\tthis.backlog = backlog;\n\t}\n\n\taddSprint(sprint: Sprint)\n\t{\n\t\tthis.sprints.set(sprint.getId(), sprint);\n\t}\n\n\tremoveSprint(sprintId: number)\n\t{\n\t\tthis.sprints.delete(sprintId);\n\t}\n\n\tgetBacklog(): Backlog\n\t{\n\t\tif (this.backlog === null)\n\t\t{\n\t\t\tthrow new Error('EntityStorage: Backlog not found');\n\t\t}\n\n\t\treturn this.backlog;\n\t}\n\n\tgetSprints(): Map<number, Sprint>\n\t{\n\t\treturn this.sprints;\n\t}\n\n\tgetSprintsAvailableForFilling(entityFrom: Entity): Set<Sprint>\n\t{\n\t\tconst sprints = new Set();\n\n\t\tthis.sprints.forEach((sprint: Sprint) => {\n\t\t\tif (!sprint.isCompleted() && entityFrom.getId() !== sprint.getId())\n\t\t\t{\n\t\t\t\tsprints.add(sprint);\n\t\t\t}\n\t\t});\n\n\t\treturn sprints;\n\t}\n\n\tgetAllEntities(): Map<number, Entity>\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(this.backlog.getId(), this.backlog);\n\n\t\t[...this.sprints.values()].map((sprint) => entities.set(sprint.getId(), sprint));\n\n\t\treturn entities;\n\t}\n\n\tgetAllItems(): Map<number, Item>\n\t{\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\t[...this.sprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn items;\n\t}\n\n\trecalculateItemsSort()\n\t{\n\t\tthis.backlog.recalculateItemsSort();\n\t\tthis.sprints.forEach((sprint) => sprint.recalculateItemsSort());\n\t}\n\n\tfindEntityByEntityId(entityId: number): Entity\n\t{\n\t\tentityId = parseInt(entityId, 10);\n\n\t\tif (this.backlog.getId() === entityId)\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === entityId);\n\t}\n\n\tfindItemByItemId(itemId: number): Item\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn backlogItems.get(itemId);\n\t\t}\n\n\t\tconst sprint = [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t\tif (sprint)\n\t\t{\n\t\t\treturn sprint.getItems().get(itemId);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindItemBySourceId(sourceId: number): Item\n\t{\n\t\tsourceId = parseInt(sourceId, 10);\n\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\t[...this.sprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn [...items.values()].find((item: Item) => item.getSourceId() === sourceId);\n\t}\n\n\tfindEntityByItemId(itemId: number): Entity\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t}\n}","import {Entity} from '../entity/entity';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage\n}\n\nexport class ItemStyleDesigner\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.listAllUsedColors = new Set();\n\n\t\tthis.updateBorderColorForLinkedItems();\n\t}\n\n\tupdateBorderColorForLinkedItems()\n\t{\n\t\tconst itemIdsToUpdateColor = new Set();\n\t\tthis.entityStorage.getAllItems().forEach((item: Item) => {\n\t\t\tif (item.isLinkedTask() && !item.getBorderColor())\n\t\t\t{\n\t\t\t\titemIdsToUpdateColor.add(item.getItemId());\n\t\t\t}\n\t\t});\n\n\t\tif (itemIdsToUpdateColor.size)\n\t\t{\n\t\t\tthis.getAllUsedColors().then(() => {\n\t\t\t\tconst items = new Map();\n\t\t\t\titemIdsToUpdateColor.forEach((itemId: number) => {\n\t\t\t\t\titems.set(itemId, this.getRandomColor(this.getAllColors()));\n\t\t\t\t});\n\t\t\t\tthis.requestSender.updateBorderColorToLinkedItems({\n\t\t\t\t\titems: Object.fromEntries(items)\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tconst updatedItems = response.data;\n\t\t\t\t\tObject.keys(updatedItems).forEach((itemId: number) => {\n\t\t\t\t\t\tconst borderColor = updatedItems[itemId];\n\t\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\t\titem.setBorderColor(borderColor);\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tgetRandomColorForItemBorder(): Promise\n\t{\n\t\treturn this.getAllUsedColors().then(() => {\n\t\t\treturn this.getRandomColor(this.getAllColors());\n\t\t});\n\t}\n\n\tgetAllColors(): Array\n\t{\n\t\tconst colorPicker = this.getColorPicker();\n\t\tlet allColors = [];\n\t\tcolorPicker.getDefaultColors().forEach((defaultColors) => {\n\t\t\tallColors = [...allColors, ...defaultColors];\n\t\t});\n\n\t\treturn allColors;\n\t}\n\n\tgetRandomColor(allColors: Array): string\n\t{\n\t\tconst randomColor = allColors[Math.floor(Math.random() * allColors.length)];\n\t\tif (this.isThisBorderColorAlreadyUse(randomColor))\n\t\t{\n\t\t\treturn this.getRandomColor(allColors);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn randomColor;\n\t\t}\n\t}\n\n\tisThisBorderColorAlreadyUse(color: string): boolean\n\t{\n\t\tlet isAlreadyUse = false;\n\n\t\tthis.listAllUsedColors.forEach((usedColor: string) => {\n\t\t\tif (usedColor === color)\n\t\t\t{\n\t\t\t\tisAlreadyUse = true;\n\t\t\t}\n\t\t});\n\n\t\treturn isAlreadyUse;\n\t}\n\n\tgetAllUsedColors(): Promise\n\t{\n\t\tconst entityIds = new Set();\n\t\tthis.entityStorage.getAllEntities().forEach((entity: Entity) => {\n\t\t\tif (!entity.isCompleted())\n\t\t\t{\n\t\t\t\tentityIds.add(entity.getId());\n\t\t\t}\n\t\t});\n\n\t\treturn this.requestSender.getAllUsedItemBorderColors({\n\t\t\tentityIds: [...entityIds.values()]\n\t\t}).then((response) => {\n\t\t\tthis.listAllUsedColors = new Set([response.data]);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tgetColorPicker()\n\t{\n\t\t/* eslint-disable */\n\t\treturn new BX.ColorPicker();\n\t\t/* eslint-enable */\n\t}\n}","import {Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {EventEmitter} from 'main.core.events';\nimport {Draggable} from 'ui.draganddrop.draggable';\n\nimport {Sprint} from '../entity/sprint/sprint';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tdefaultSprintDuration: number,\n\tpageNumberToCompletedSprints: number\n}\n\nexport class DomBuilder extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DomBuilder');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.defaultSprintDuration = params.defaultSprintDuration;\n\t\tthis.pageNumberToCompletedSprints = parseInt(params.pageNumberToCompletedSprints, 10);\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tthis.scrumContainer = container;\n\n\t\tthis.append(this.entityStorage.getBacklog().render(), this.scrumContainer);\n\t\tthis.entityStorage.getBacklog().onAfterAppend();\n\n\t\tthis.append(this.renderSprintsContainer(), this.scrumContainer);\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tsprint.onAfterAppend();\n\t\t});\n\n\t\tthis.sprintCreatingButtonNode = document.getElementById(this.sprintCreatingButtonNodeId);\n\t\tthis.sprintCreatingDropZoneNode = document.getElementById(this.sprintCreatingDropZoneNodeId);\n\t\tthis.sprintListNode = document.getElementById(this.sprintListNodeId);\n\n\t\tEvent.bind(this.sprintCreatingButtonNode, 'click', this.createSprint.bind(this));\n\n\t\tthis.setDraggable();\n\t}\n\n\tgetSprintCreatingDropZoneNode(): HTMLElement\n\t{\n\t\treturn this.sprintCreatingDropZoneNode;\n\t}\n\n\tgetSprintPlannedListNode(): HTMLElement\n\t{\n\t\treturn this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\t}\n\n\tsetDraggable()\n\t{\n\t\tconst itemContainers = [];\n\t\titemContainers.push(this.entityStorage.getBacklog().getListItemsNode());\n\t\tif (this.sprintCreatingDropZoneNode)\n\t\t{\n\t\t\titemContainers.push(this.sprintCreatingDropZoneNode);\n\t\t}\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (!sprint.isDisabled())\n\t\t\t{\n\t\t\t\titemContainers.push(sprint.getListItemsNode());\n\t\t\t}\n\t\t});\n\t\tthis.draggableItems = new Draggable({\n\t\t\tcontainer: itemContainers,\n\t\t\tdraggable: '.tasks-scrum-item-drag', // todo add tmp class\n\t\t\tdragElement: '.tasks-scrum-item',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t\tdelay: 200\n\t\t});\n\t\tthis.draggableItems.subscribe('start', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('itemMoveStart', dragEndEvent);\n\t\t});\n\t\tthis.draggableItems.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('itemMoveEnd', dragEndEvent);\n\t\t});\n\n\t\tthis.draggableSprints = new Draggable({\n\t\t\tcontainer: this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list'),\n\t\t\tdraggable: '.tasks-scrum-sprint',\n\t\t\tdragElement: '.tasks-scrum-sprint-dragndrop',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t});\n\t\tthis.draggableSprints.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('sprintMove', dragEndEvent);\n\t\t});\n\t}\n\n\trenderSprintsContainer(): HTMLElement\n\t{\n\t\tconst createCreatingButton = () => {\n\t\t\tthis.sprintCreatingButtonNodeId = 'tasks-scrum-sprint-creating-button';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-sprint-create ui-btn ui-btn-md ui-btn-themes ui-btn-light-border ui-btn-icon-add\">\n\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD')}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createCreatingDropZone = () => {\n\t\t\tif (this.entityStorage.getSprints().size)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tthis.sprintCreatingDropZoneNodeId = 'tasks-scrum-sprint-creating-drop-zone';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingDropZoneNodeId}\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-file-drop tasks-scrum-sprint-sprint-add-drop\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t<small>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_DROP')}</small>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createSprintsList = () => {\n\t\t\tthis.sprintListNodeId = 'tasks-scrum-sprint-list';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintListNodeId}\" class=\"tasks-scrum-sprint-list\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-active-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isActive())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-planned-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isPlanned())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-completed-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isCompleted())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-completed-loader\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst sprintsNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprints\">\n\t\t\t\t${createCreatingButton()}\n\t\t\t\t${createCreatingDropZone()}\n\t\t\t\t${createSprintsList()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.completedSprintLoader = sprintsNode.querySelector('.tasks-scrum-sprint-completed-loader');\n\t\tthis.bindLoadCompletedSprints(this.completedSprintLoader);\n\n\t\treturn sprintsNode;\n\t}\n\n\tbindLoadCompletedSprints(loader: HTMLElement)\n\t{\n\t\tconst observer = new IntersectionObserver((entries) =>\n\t\t\t{\n\t\t\t\tif(entries[0].isIntersecting === true)\n\t\t\t\t{\n\t\t\t\t\tif (!this.isActiveLoadCompletedSprints)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onLoadCompletedSprints();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tthreshold: [0]\n\t\t\t}\n\t\t);\n\n\t\tobserver.observe(loader);\n\t}\n\n\tonLoadCompletedSprints()\n\t{\n\t\tthis.isActiveLoadCompletedSprints = true;\n\n\t\tconst loader = this.showLoader(this.completedSprintLoader);\n\n\t\tconst requestData = {\n\t\t\tpageNumber: this.pageNumberToCompletedSprints + 1\n\t\t};\n\n\t\tthis.requestSender.getCompletedSprints(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tconst data = response.data;\n\t\t\t\tif (Type.isArray(data) && data.length)\n\t\t\t\t{\n\t\t\t\t\tthis.pageNumberToCompletedSprints++;\n\t\t\t\t\tthis.isActiveLoadCompletedSprints = false;\n\n\t\t\t\t\tthis.createSprints(data);\n\t\t\t\t}\n\t\t\t\tloader.hide();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\tthis.isActiveLoadCompletedSprints = false;\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tcreateSprints(sprints: Array)\n\t{\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-completed-list');\n\n\t\tsprints.forEach((sprintData: SprintParams) => {\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tif (!this.entityStorage.findEntityByEntityId(sprint.getId()))\n\t\t\t{\n\t\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t\t\tthis.append(sprint.render(), sprintListNode);\n\t\t\t\tsprint.onAfterAppend();\n\t\t\t\tthis.emit('createSprint', sprint);\n\t\t\t}\n\t\t});\n\t}\n\n\tshowLoader(container: HTMLElement): Loader\n\t{\n\t\tconst listPosition = this.getPosition(container);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: container,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n\n\tcreateSprint(): Promise\n\t{\n\t\tthis.remove(this.sprintCreatingDropZoneNode);\n\n\t\tconst countSprints = this.entityStorage.getSprints().size;\n\t\tconst title = Loc.getMessage('TASKS_SCRUM_SPRINT_NAME').replace('%s', countSprints + 1);\n\t\tconst storyPoints = 0;\n\t\tconst dateStart = Math.floor(Date.now() / 1000);\n\t\tconst dateEnd = (Math.floor(Date.now() / 1000) + parseInt(this.defaultSprintDuration, 10));\n\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\t\tconst sort = (sprintListNode.children.length ? sprintListNode.children.length + 1 : 1);\n\n\t\tconst sprint = Sprint.buildSprint({\n\t\t\tname: title,\n\t\t\tsort: sort,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd,\n\t\t\tstoryPoints: storyPoints\n\t\t});\n\t\tthis.append(sprint.render(), sprintListNode);\n\n\t\tconst requestData = {\n\t\t\ttmpId: Text.getRandom(),\n\t\t\tname: title,\n\t\t\tsort: sort,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd\n\t\t};\n\n\t\tthis.emit('beforeCreateSprint', requestData);\n\n\t\treturn this.requestSender.createSprint(requestData).then((response) => {\n\t\t\tsprint.setId(response.data.sprintId);\n\t\t\tsprint.onAfterAppend();\n\t\t\tsprint.getNode().scrollIntoView(true);\n\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\t\t\tthis.emit('createSprint', sprint);\n\t\t\treturn sprint;\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tcreateSprintNode(sprint: Sprint)\n\t{\n\t\tthis.remove(this.sprintCreatingDropZoneNode);\n\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\n\t\tthis.append(sprint.render(), sprintListNode);\n\n\t\tsprint.onAfterAppend();\n\n\t\tthis.entityStorage.addSprint(sprint);\n\n\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\n\t\tthis.emit('createSprintNode', sprint);\n\t}\n\n\tmoveSprintToActiveListNode(sprint: Sprint)\n\t{\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-active-list');\n\n\t\tthis.append(sprint.getNode(), sprintListNode);\n\t}\n\n\tmoveSprintToCompletedListNode(sprint: Sprint)\n\t{\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-completed-list');\n\n\t\tif (sprintListNode.firstElementChild)\n\t\t{\n\t\t\tthis.insertBefore(sprint.getNode(), sprintListNode.firstElementChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.append(sprint.getNode(), sprintListNode);\n\t\t}\n\t}\n\n\tappend(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tDom.append(current, target);\n\t}\n\n\tinsertBefore(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tDom.insertBefore(current, target);\n\t}\n\n\tremove(element: ?HTMLElement)\n\t{\n\t\tDom.remove(element);\n\t}\n\n\tgetPosition(element: HTMLElement): DOMRect\n\t{\n\t\treturn Dom.getPosition(element);\n\t}\n\n\tappendItemAfterItem(newItemNode: HTMLElement, bindItemNode: HTMLElement)\n\t{\n\t\tif (bindItemNode.nextElementSibling)\n\t\t{\n\t\t\tDom.insertBefore(newItemNode, bindItemNode.nextElementSibling);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newItemNode, bindItemNode.parentElement);\n\t\t}\n\t};\n}","import {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\n\nimport type {ItemParams} from '../item/item';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder\n}\n\nexport class SubTasksManager\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\n\t\tthis.listSubTasks = new Map();\n\t\tthis.visibilityList = new Set();\n\t}\n\n\ttoggleSubTasks(sprint: Sprint, item: Item): Promise\n\t{\n\t\tif (this.listSubTasks.has(item.getItemId()))\n\t\t{\n\t\t\tif (this.isShown(item))\n\t\t\t{\n\t\t\t\tthis.hideSubTaskItems(sprint, item);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showSubTaskItems(sprint, item);\n\t\t\t}\n\n\t\t\titem.toggleSubTasksTick();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.requestSender.getSubTaskItems({\n\t\t\t\tentityId: sprint.getId(),\n\t\t\t\ttaskId: item.getSourceId()\n\t\t\t}).then((response) => {\n\t\t\t\tconst listItemParams = response.data;\n\t\t\t\tconst listSubTaskItems = new Map();\n\t\t\t\tlistItemParams.forEach((itemParams: ItemParams) => {\n\t\t\t\t\tconst subTaskItem = this.buildSubTaskItem(itemParams);\n\t\t\t\t\tlistSubTaskItems.set(subTaskItem.getItemId(), subTaskItem);\n\t\t\t\t});\n\t\t\t\tthis.listSubTasks.set(item.getItemId(), listSubTaskItems);\n\t\t\t\tif (this.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tthis.hideSubTaskItems(sprint, item);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showSubTaskItems(sprint, item);\n\t\t\t\t}\n\t\t\t\titem.toggleSubTasksTick();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t}\n\t}\n\n\tbuildSubTaskItem(itemParams: ItemParams): Item\n\t{\n\t\treturn new Item(itemParams);\n\t}\n\n\tshowSubTaskItems(sprint: Sprint, parentItem: Item)\n\t{\n\t\tconst parentItemNode = parentItem.getItemNode();\n\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\tif (!listSubTasks)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlistSubTasks.forEach((subTaskItem: Item) => {\n\t\t\tsprint.setItem(subTaskItem);\n\t\t\tthis.domBuilder.appendItemAfterItem(subTaskItem.render(), parentItemNode);\n\t\t\tsubTaskItem.onAfterAppend(sprint.getListItemsNode());\n\t\t});\n\n\t\tthis.setVisibility(parentItem);\n\t}\n\n\thideSubTaskItems(sprint: Sprint, parentItem: Item)\n\t{\n\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\tif (!listSubTasks)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlistSubTasks.forEach((subTaskItem: Item) => {\n\t\t\tif (subTaskItem.isParentTask())\n\t\t\t{\n\t\t\t\tthis.hideSubTaskItems(sprint, subTaskItem);\n\t\t\t}\n\t\t\tsprint.removeItem(subTaskItem);\n\t\t\tsubTaskItem.removeYourself();\n\t\t});\n\n\t\tthis.cleanVisibility(parentItem);\n\t}\n\n\taddSubTask(parentItem: Item, item: Item)\n\t{\n\t\tif (this.listSubTasks.has(parentItem.getItemId()))\n\t\t{\n\t\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\t\tlistSubTasks.set(item.getItemId(), item);\n\t\t\tthis.listSubTasks.set(parentItem.getItemId(), listSubTasks);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst listSubTasks = new Map();\n\t\t\tlistSubTasks.set(item.getItemId(), item);\n\t\t\treturn this.listSubTasks.set(parentItem.getItemId(), listSubTasks);\n\t\t}\n\t}\n\n\tgetSubTasks(parentItem: Item): Map<number, Item>\n\t{\n\t\treturn this.listSubTasks.get(parentItem.getItemId());\n\t}\n\n\tisShown(item: Item)\n\t{\n\t\treturn this.visibilityList.has(item.getItemId());\n\t}\n\n\tsetVisibility(item: Item)\n\t{\n\t\tthis.visibilityList.add(item.getItemId());\n\t}\n\n\tcleanVisibility(item: Item)\n\t{\n\t\tthis.visibilityList.delete(item.getItemId());\n\t}\n\n\tcleanSubTasks(item: Item)\n\t{\n\t\tthis.listSubTasks.delete(item.getItemId());\n\t}\n}","import {Tag, Dom, Loc, Event, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Entity} from '../../entity/entity';\nimport {Responsible, Item} from '../item';\n\nimport {ItemStyleDesigner} from '../../utility/item.style.designer';\nimport {SubTasksManager} from '../../utility/subtasks.manager';\nimport {Input} from '../../utility/input';\n\nimport '../../css/decomposition.css';\n\ntype Params = {\n\tentity: Entity,\n\titemStyleDesigner: ItemStyleDesigner,\n\tsubTasksCreator: SubTasksManager\n}\n\nexport class Decomposition extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.entity = params.entity;\n\t\tthis.itemStyleDesigner = params.itemStyleDesigner;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Decomposition');\n\n\t\tthis.items = new Set();\n\n\t\tthis.input = new Input();\n\t\tthis.input.setPlaceholder(Loc.getMessage('TASKS_SCRUM_TASK_ADD_DECOMPOSITION_INPUT_PLACEHOLDER'));\n\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t}\n\n\tdecomposeItem(item: Item)\n\t{\n\t\tthis.addDecomposedItem(item);\n\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tthis.onDecomposeItem(item, item.getItemNode());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!this.subTasksCreator.isShown(item))\n\t\t\t{\n\t\t\t\tthis.subTasksCreator.toggleSubTasks(this.entity, item).then(() => {\n\t\t\t\t\tconst lastSubTask = this.getSubTasks(item)[0];\n\t\t\t\t\tconst targetItemNode = (lastSubTask ? lastSubTask.getItemNode() : item.getItemNode());\n\t\t\t\t\tthis.onDecomposeItem(item, targetItemNode);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst lastSubTask = this.getSubTasks(item)[0];\n\t\t\t\tthis.onDecomposeItem(item, lastSubTask.getItemNode());\n\t\t\t}\n\t\t}\n\t}\n\n\tonDecomposeItem(item: Item, targetItemNode)\n\t{\n\t\tDom.insertAfter(this.input.render(), targetItemNode);\n\t\tthis.input.setNode();\n\n\t\tconst inputNode = this.input.getInputNode();\n\t\tEvent.bind(inputNode, 'input', this.input.onTagSearch.bind(this.input));\n\t\tEvent.bind(inputNode, 'keydown', this.onCreateItem.bind(this));\n\t\tinputNode.focus();\n\n\t\tconst button = this.createButton();\n\t\tDom.insertAfter(button, this.input.getNode());\n\n\t\tEvent.bind(button.querySelector('button'), 'click', () => {\n\t\t\tif (this.isBacklogDecomposition() && this.isFirstDecomposition() && !item.isLinkedTask())\n\t\t\t{\n\t\t\t\titem.setBorderColor();\n\t\t\t}\n\t\t\tif (!this.isBacklogDecomposition())\n\t\t\t{\n\t\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tthis.subTasksCreator.hideSubTaskItems(this.entity, item);\n\t\t\t\t}\n\t\t\t\tthis.subTasksCreator.cleanSubTasks(item);\n\t\t\t}\n\t\t\tthis.deactivateDecompositionMode();\n\t\t\tthis.input.removeYourself()\n\t\t\tDom.remove(button);\n\t\t});\n\n\t\tthis.setResponsible(item.getResponsible());\n\t}\n\n\tgetSubTasks(parentItem: Item): Array\n\t{\n\t\treturn Array.from(this.subTasksCreator.getSubTasks(parentItem).values());\n\t}\n\n\tgetLastDecomposedItemNode(parentItem: Item): HTMLElement\n\t{\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tconst decomposedItems = this.getDecomposedItems();\n\t\t\tconst lastDecomposedItem = Array.from(decomposedItems).pop();\n\n\t\t\treturn lastDecomposedItem.getItemNode();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst subTasks = this.getSubTasks(parentItem);\n\t\t\tif (subTasks.length)\n\t\t\t{\n\t\t\t\tconst lastSubTask = (this.isFirstDecomposition() ? subTasks[0] : subTasks.pop());\n\n\t\t\t\treturn lastSubTask.getItemNode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn parentItem.getItemNode();\n\t\t\t}\n\t\t}\n\t}\n\n\tisBacklogDecomposition(): boolean\n\t{\n\t\treturn this.entity.getEntityType() === 'backlog';\n\t}\n\n\taddDecomposedItem(item: Item)\n\t{\n\t\tthis.activateDecompositionMode(item);\n\n\t\titem.subscribe('changeTaskResponsible', this.saveSelectedResponsible.bind(this));\n\n\t\tthis.items.add(item);\n\t}\n\n\tgetDecomposedItems(): Set\n\t{\n\t\treturn this.items;\n\t}\n\n\tactivateDecompositionMode(item: Item)\n\t{\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tthis.itemStyleDesigner.getRandomColorForItemBorder().then((randomColor: string) => {\n\t\t\t\titem.activateDecompositionMode(randomColor);\n\t\t\t\tthis.setBorderColor(item.getBorderColor());\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\titem.activateDecompositionMode();\n\t\t}\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.items.forEach((item) => {\n\t\t\titem.deactivateDecompositionMode();\n\t\t});\n\t\tthis.items.clear();\n\t}\n\n\tcreateButton(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-decomposition-structure\">\n\t\t\t\t<button class=\"ui-btn ui-btn-sm ui-btn-primary\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DECOMPOSITION_BUTTON')}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonCreateItem(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tif (!this.input.isTagsSearchMode())\n\t\t\t{\n\t\t\t\tconst inputNode = event.target;\n\t\t\t\tif (inputNode.value)\n\t\t\t\t{\n\t\t\t\t\tconst parentItem = this.getParentItem();\n\t\t\t\t\tif (this.isBacklogDecomposition())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isFirstDecomposition() && !parentItem.isLinkedTask())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('updateParentItem', {\n\t\t\t\t\t\t\t\titemId: parentItem.getItemId(),\n\t\t\t\t\t\t\t\tentityId: parentItem.getEntityId(),\n\t\t\t\t\t\t\t\titemType: parentItem.getItemType(),\n\t\t\t\t\t\t\t\tinfo: parentItem.getInfo()\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.emit('createItem', inputNode.value);\n\t\t\t\t\tinputNode.value = '';\n\t\t\t\t\tinputNode.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisFirstDecomposition(): boolean\n\t{\n\t\treturn (this.items.size === 1);\n\t}\n\n\tgetParentItem(): Item\n\t{\n\t\tconst iterator = this.items.values();\n\t\treturn iterator.next().value;\n\t}\n\n\tsaveSelectedResponsible(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getTarget();\n\t\tthis.setResponsible(item.getResponsible());\n\t}\n\n\tgetResponsible(): Responsible\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tsetResponsible(responsible: Responsible)\n\t{\n\t\tthis.responsible = responsible;\n\t}\n\n\tsetBorderColor(color: string)\n\t{\n\t\tthis.borderColor = (Type.isString(color) ? color : '');\n\t}\n\n\tgetBorderColor(): string\n\t{\n\t\treturn this.borderColor;\n\t}\n}","import {Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Filter} from '../service/filter';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\ntype Params = {\n\tfilter: Filter,\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage\n}\n\nexport class FilterHandler extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.filter = params.filter;\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.filter.subscribe('applyFilter', this.onApplyFilter.bind(this));\n\t}\n\n\tonApplyFilter(baseEvent: BaseEvent)\n\t{\n\t\tthis.fadeOutAll();\n\n\t\tconst filterInfo = baseEvent.getData();\n\n\t\tthis.updateExactSearchStatusToEntities();\n\n\t\tthis.requestSender.applyFilter().then(response => {\n\t\t\tfilterInfo.promise.fulfill();\n\n\t\t\tconst filteredItemsData = response.data;\n\n\t\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\tentity.removeItem(item);\n\t\t\t\titem.removeYourself();\n\t\t\t});\n\n\t\t\tfilteredItemsData.forEach((itemData) => {\n\t\t\t\tconst item = Item.buildItem(itemData);\n\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\tDom.append(item.render(), entity.getListItemsNode());\n\t\t\t\tentity.setItem(item);\n\t\t\t\titem.onAfterAppend(entity.getListItemsNode());\n\t\t\t});\n\n\t\t\tthis.entityStorage.getBacklog().updateStoryPoints();\n\t\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\t\tif (!sprint.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tsprint.updateStoryPoints();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.updateVisibilityToEntities();\n\n\t\t\tthis.fadeInAll();\n\t\t}).catch((response) => {\n\t\t\tfilterInfo.promise.reject();\n\n\t\t\tthis.fadeInAll();\n\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tupdateExactSearchStatusToEntities()\n\t{\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.setExactSearchApplied(this.filter.isSearchFieldApplied());\n\t\t});\n\t}\n\n\tupdateVisibilityToEntities()\n\t{\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.updateVisibility();\n\t\t});\n\t}\n\n\tfadeOutAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeOut();\n\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.fadeOut();\n\t\t});\n\t}\n\n\tfadeInAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeIn();\n\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.fadeIn();\n\t\t});\n\t}\n}","import {Event, Runtime, Tag, Text, Loc, Type, Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Label} from 'ui.label';\n\nimport {Filter} from '../service/filter';\nimport {SidePanel} from '../service/side.panel';\n\nimport {Entity} from '../entity/entity';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\nimport {TagSearcher} from './tag.searcher';\n\nimport type {EpicType} from '../item/item';\n\nimport '../css/epic.css';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tsidePanel: SidePanel,\n\tentity: Entity,\n\tfilter: Filter,\n\ttagSearcher: TagSearcher,\n}\n\nexport class Epic extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Epic');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.entity = params.entity;\n\t\tthis.filter = params.filter;\n\t\tthis.tagSearcher = params.tagSearcher;\n\n\t\tthis.form = null;\n\n\t\tthis.defaultColor = '#69dafc';\n\t\tthis.selectedColor = '';\n\n\t\tthis.currentEpic = null;\n\t}\n\n\tgetCurrentEpic(): ?Object\n\t{\n\t\treturn this.currentEpic;\n\t}\n\n\topenAddForm()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadAddForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildAddForm());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenEditForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadEditForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\t\tresolve(this.buildEditForm());\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenViewForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadViewForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\t\tresolve(this.buildViewForm());\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenEpicsList()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequest.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadListGrid.bind(this));\n\t\t\t\tthis.sidePanel.subscribeOnce('onCloseSidePanel', this.destroyGrid.bind(this));\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(Tag.render`\n\t\t\t\t\t<div class=\"tasks-scrum-epics-list\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-add-button\">\n\t\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-sm\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epics-list-grid\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tonLoadAddForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.currentEpic = null;\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadAddButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.createEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.onAfterCreateEpic(response.data);\n\t\t\t\t\tif (this.sidePanel.isPreviousSidePanelExist(sidePanel))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sidePanel.reloadPreviousSidePanel(sidePanel);\n\t\t\t\t\t\tsidePanel.close();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\t\tthis.openEpicsList();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\t\tresponse,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_CREATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t\tsidePanel.close();\n\t\t\t\t});\n\t\t\t});\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tonLoadViewForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadDescription();\n\t\tthis.onLoadFiles();\n\t\tthis.onLoadViewButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\tthis.openEditForm(this.currentEpic.id);\n\t\t\t\t});\n\t\t\t});\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tonLoadEditForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadEditButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.editEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.emit('onAfterEditEpic', response);\n\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\tthis.reloadGrid();\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.removeClockIconFromButton();\n\t\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\t\tresponse,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_UPDATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\treloadGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\tconst gridManager = BX.Main.gridManager.getById(this.gridId);\n\t\t\tif (gridManager)\n\t\t\t{\n\t\t\t\tgridManager.instance.reload();\n\t\t\t}\n\t\t}\n\t\t/* eslint-enable */\n\t}\n\n\tdestroyGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\tconst gridManager = BX.Main.gridManager.getById(this.gridId);\n\t\t\tif (gridManager)\n\t\t\t{\n\t\t\t\tgridManager.instance.destroy();\n\t\t\t}\n\t\t}\n\t\t/* eslint-enable */\n\t}\n\n\tonLoadEditor()\n\t{\n\t\tthis.getDescriptionEditor().then((editorHtml) => {\n\t\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\t\tRuntime.html(descriptionContainer, editorHtml).then(() => {\n\t\t\t\tthis.editor = window.LHEPostForm.getHandler(this.id);\n\t\t\t\twindow.BXHtmlEditor.Get(this.id);\n\t\t\t\tEventEmitter.emit(this.editor.eventNode, 'OnShowLHE', [true]);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.form.querySelector('.tasks-scrum-epic-form-header-title-control').focus();\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadDescription()\n\t{\n\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\tthis.requestSender.getEpicDescription({\n\t\t\tepicId: this.currentEpic.id,\n\t\t\ttext: this.currentEpic.description\n\t\t}).then(response => {\n\t\t\tRuntime.html(descriptionContainer, response.data);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonLoadFiles()\n\t{\n\t\tconst filesContainer = this.form.querySelector('.tasks-scrum-epic-form-files');\n\t\tthis.requestSender.getEpicFiles({\n\t\t\tepicId: this.currentEpic.id\n\t\t}).then(response => {\n\t\t\tRuntime.html(filesContainer, response.data.html);\n\t\t});\n\t}\n\n\tonLoadColorPicker()\n\t{\n\t\tthis.selectedColor = (this.currentEpic ? this.currentEpic.info.color : this.defaultColor);\n\t\tconst colorBlockNode = this.form.querySelector('.tasks-scrum-epic-header-color');\n\t\tEvent.bind(colorBlockNode, 'click', () => {\n\t\t\tconst colorNode = colorBlockNode.querySelector('.tasks-scrum-epic-header-color-current');\n\t\t\tconst picker = this.getColorPicker(colorNode);\n\t\t\tpicker.open();\n\t\t});\n\t}\n\n\tonLoadAddButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadViewButtons(): Promise\n\t{\n\t\treturn this.getViewEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadEditButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadListGrid(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tconst form = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list');\n\t\tconst list = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list-grid');\n\n\t\tthis.getEpicsList().then((responseData) => {\n\t\t\tif (responseData.html)\n\t\t\t{\n\t\t\t\tRuntime.html(list, responseData.html);\n\n\t\t\t\tthis.prepareTagsList(list);\n\n\t\t\t\tconst buttonNode = form.querySelector('.tasks-scrum-epic-header-add-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.remove(form.querySelector('.tasks-scrum-epic-header-add-button'));\n\t\t\t\tDom.append(this.getEmptyEpicListForm(), list);\n\t\t\t\tconst buttonNode = list.querySelector('.tasks-scrum-epics-empty-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [, eventArgs] = event.getCompatData();\n\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\teventArgs.method = 'POST';\n\n\t\tif (!eventArgs.url)\n\t\t{\n\t\t\teventArgs.url = this.requestSender.getEpicListUrl();\n\t\t}\n\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t\tentityId: this.entity.getId(),\n\t\t\tgridId: this.gridId,\n\t\t\tsignedParameters: this.requestSender.getSignedParameters()\n\t\t};\n\t}\n\n\tgetEpicsList() : Promise\n\t{\n\t\tthis.gridId = 'EntityEpicsGrid_' + this.entity.getId();\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicsList({\n\t\t\t\tentityId: this.entity.getId(),\n\t\t\t\tgridId: this.gridId\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetEpic(id: Number): Promise\n\t{\n\t\treturn this.requestSender.getEpic({id: id});\n\t}\n\n\tbuildAddForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader('', '#69dafc')}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildViewForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_VIEW_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t\t\t${Text.encode(this.currentEpic.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\t\t\"background-color: ${Text.encode(this.currentEpic.info.color)};\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\" style=\"padding: 15px 10px 15px 10px;\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-files\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildEditForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_EDIT_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader(this.currentEpic.name, this.currentEpic.info.color)}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEmptyEpicListForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epics-empty\">\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-first-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_FIRST_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-image\">\n\t\t\t\t\t<svg width=\"124px\" height=\"123px\" viewBox=\"0 0 124 123\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t\t<g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" opacity=\"0.28\">\n\t\t\t\t\t\t\t<path d=\"M83,105 L83,81.4375 L105,81.4375 L105,18 L17,18 L17,81.4375 L39,81.4375 L39,105 L83,105 Z M10.9411765,0 L113.058824,0 C119.101468,0 124,4.85902727 124,10.8529412 L124,112.147059 C124,118.140973 119.101468,123 113.058824,123 L10.9411765,123 C4.89853156,123 0,118.140973 0,112.147059 L0,10.8529412 C0,4.85902727 4.89853156,0 10.9411765,0 Z M44.0142862,47.0500004 L54.2142857,57.4416671 L79.7142857,32 L87,42.75 L54.2142857,75 L36,57.0833333 L44.0142862,47.0500004 Z\" fill=\"#A8ADB4\" />\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-second-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_SECOND_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-button\">\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-lg\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormHeader(title: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t${title}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormContainerHeader(name: String, color: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t<input type=\"text\" name=\"name\" value=\"${Text.encode(name)}\" class=\n\t\t\t\t\t\t\"tasks-scrum-epic-form-header-title-control\" placeholder=\n\t\t\t\t\t\t\"${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_NAME_PLACEHOLDER')}\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\"background-color: ${Text.encode(color)};\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetDescriptionEditor(): Promise\n\t{\n\t\tconst requestData = {\n\t\t\teditorId: this.id\n\t\t};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t\trequestData.text = this.currentEpic.description;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicDescriptionEditor(requestData).then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetAddEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getAddEpicFormButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetViewEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getViewEpicFormButtonsAction().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetColorPicker(colorNode)\n\t{\n\t\t/* eslint-disable */\n\t\treturn new BX.ColorPicker({\n\t\t\tbindElement: colorNode,\n\t\t\tdefaultColor: this.selectedColor,\n\t\t\tonColorSelected: (color, picker) => {\n\t\t\t\tthis.selectedColor = color;\n\t\t\t\tcolorNode.style.backgroundColor = color;\n\t\t\t},\n\t\t\tpopupOptions: {\n\t\t\t\tzIndex: 1100,\n\t\t\t\tclassName: 'tasks-scrum-epic-color-popup'\n\n\t\t\t},\n\t\t\tcolors: [\n\t\t\t\t[\"#aae9fc\", \"#bbecf1\", \"#98e1dc\", \"#e3f299\", \"#ffee95\", \"#ffdd93\", \"#dfd3b6\", \"#e3c6bb\"],\n\t\t\t\t[\"#ffad97\", \"#ffbdbb\", \"#ffcbd8\", \"#ffc4e4\", \"#c4baed\", \"#dbdde0\", \"#bfc5cd\", \"#a2a8b0\"]\n\t\t\t]\n\t\t});\n\t\t/* eslint-enable */\n\t}\n\n\tgetRequestData()\n\t{\n\t\tconst requestData = {};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t}\n\n\t\trequestData.entityId = this.entity.getId();\n\t\trequestData.name = (this.form.querySelector('[name=name]').value).trim();\n\t\trequestData.description = this.editor.oEditor.GetContent();\n\t\trequestData.color = this.selectedColor;\n\t\trequestData.files = this.getAttachmentsFiles();\n\n\t\treturn requestData;\n\t}\n\n\tgetAttachmentsFiles(): Array\n\t{\n\t\tconst files = [];\n\n\t\tif (!this.editor || !Type.isPlainObject(this.editor.arFiles) || !Type.isPlainObject(this.editor.controllers))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\tconst fileControllers = [];\n\t\tObject.values(this.editor.arFiles).forEach((controller) => {\n\t\t\tif(!fileControllers.includes(controller))\n\t\t\t{\n\t\t\t\tfileControllers.push(controller);\n\t\t\t}\n\t\t});\n\n\t\tfileControllers.forEach((fileController) => {\n\t\t\tif (\n\t\t\t\tthis.editor.controllers[fileController] &&\n\t\t\t\tType.isPlainObject(this.editor.controllers[fileController].values)\n\t\t\t)\n\t\t\t{\n\t\t\t\tObject.keys(this.editor.controllers[fileController].values).forEach((fileId) => {\n\t\t\t\t\tif (!files.includes(fileId))\n\t\t\t\t\t{\n\t\t\t\t\t\tfiles.push(fileId);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\n\t\treturn files;\n\t}\n\n\tprepareTagsList(container: HTMLElement)\n\t{\n\t\tconst tagsContainers = container.querySelectorAll('.tasks-scrum-epic-grid-tags');\n\t\ttagsContainers.forEach((tagsContainer) => {\n\t\t\tconst tags = this.getTagsFromNode(tagsContainer);\n\t\t\tDom.clean(tagsContainer);\n\t\t\ttags.forEach((tag) => {\n\t\t\t\tDom.append(this.getTagNode(tag), tagsContainer);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTagsFromNode(node: HTMLElement): Array\n\t{\n\t\tconst tags = [];\n\t\tnode.childNodes.forEach((childNode) => {\n\t\t\ttags.push(childNode.textContent.trim());\n\t\t});\n\t\treturn tags;\n\t}\n\n\tgetTagNode(tag: string): HTMLElement\n\t{\n\t\tconst tagLabel = new Label({\n\t\t\ttext: tag,\n\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\tfill: true,\n\t\t\tsize: Label.Size.SM,\n\t\t\tcustomClass: ''\n\t\t});\n\t\tconst container = tagLabel.getContainer();\n\t\tEvent.bind(container, 'click', () => {\n\t\t\tthis.emit('filterByTag', tag);\n\t\t\tthis.sidePanel.closeTopSidePanel(true);\n\t\t});\n\t\treturn container;\n\t}\n\n\tremoveClockIconFromButton()\n\t{\n\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\tif (buttonsContainer)\n\t\t{\n\t\t\tDom.removeClass(buttonsContainer.querySelector('[name=save]'), 'ui-btn-wait');\n\t\t}\n\t}\n\n\tonAfterCreateEpic(epic: EpicType)\n\t{\n\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\tthis.filter.addItemToListTypeField('EPIC', {\n\t\t\tNAME: epic.name.trim(),\n\t\t\tVALUE: String(epic.id)\n\t\t});\n\t}\n\n\tonAfterUpdateEpic(epic: EpicType)\n\t{\n\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\tconst itemEpic = item.getEpic();\n\t\t\tif (itemEpic && itemEpic.id === epic.id)\n\t\t\t{\n\t\t\t\titem.setEpicAndTags(epic);\n\t\t\t}\n\t\t});\n\n\t\tconst oldEpicInfo = this.getCurrentEpic();\n\t\tif (oldEpicInfo)\n\t\t{\n\t\t\tthis.tagSearcher.removeEpicFromSearcher(oldEpicInfo);\n\t\t}\n\n\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t}\n\n\tonAfterRemoveEpic(epic: EpicType)\n\t{\n\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\tconst itemEpic = item.getEpic();\n\t\t\tif (itemEpic && itemEpic.id === epic.id)\n\t\t\t{\n\t\t\t\titem.setEpicAndTags(null);\n\t\t\t}\n\t\t});\n\t\tthis.tagSearcher.removeEpicFromSearcher(epic);\n\t\tthis.sidePanel.reloadTopSidePanel(true);\n\t}\n}","import {Loc} from 'main.core';\n\ntype Data = {\n\tsprintName: string,\n\tplan: number,\n\tdone: number\n}\n\n//todo import amchart4 like es6\nexport class TeamSpeedChart\n{\n\tconstructor(data: Data)\n\t{\n\t\tthis.data = data;\n\n\t\tthis.chart = null;\n\t}\n\n\tcreateChart(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\n\t\tthis.chart.scrollbarX = new am4core.Scrollbar();\n\t\tthis.chart.scrollbarX.parent = this.chart.bottomAxesContainer;\n\n\t\tthis.createAxises();\n\n\t\tthis.createColumn('plan', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_PLAN_COLUMN'), '#2882b3');\n\t\tthis.createColumn('done', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_DONE_COLUMN'), '#9c1f1f');\n\n\t\tthis.createLegend();\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst xAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\txAxis.dataFields.category = 'sprintName';\n\t\txAxis.renderer.grid.template.location = 0;\n\n\t\tconst label = xAxis.renderer.labels.template;\n\t\tlabel.wrap = true;\n\t\tlabel.maxWidth = 120;\n\n\t\tconst yAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tyAxis.min = 0;\n\t}\n\n\tcreateColumn(valueY: string, name: string, color: string)\n\t{\n\t\tconst series = this.chart.series.push(new am4charts.ColumnSeries());\n\t\tseries.dataFields.valueY = valueY;\n\t\tseries.dataFields.categoryX = 'sprintName';\n\t\tseries.name = name;\n\t\tseries.stroke = am4core.color(color);\n\t\tseries.fill = am4core.color(color);\n\n\t\t// const bullet = series.bullets.push(new am4charts.LabelBullet())\n\t\t// bullet.dy = 10;\n\t\t// bullet.label.text = '{valueY}';\n\t\t// bullet.label.fill = am4core.color('#ffffff');\n\n\t\treturn series;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.paddingBottom = 20;\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t}\n\n\tdestroyChart()\n\t{\n\t\tthis.chart.dispose();\n\t}\n}","import {Event, Loc, Runtime, Tag, Text} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {SidePanel} from '../service/side.panel';\nimport {RequestSender} from './request.sender';\nimport {TeamSpeedChart} from './team.speed.chart';\nimport {Entity} from '../entity/entity';\n\ntype Params = {\n\tsprints?: Map,\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender\n};\n\nexport class ProjectSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sprints = params.sprints ? params.sprints : new Map();\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t}\n\n\tshowTeamSpeedChart()\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-team-speed-chart';\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadTeamSpeedChartPanel.bind(this));\n\n\t\tthis.sidePanel.subscribe('onCloseSidePanel', this.onCloseTeamSpeedChart.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildTeamSpeedPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tshowDefinitionOfDone(entity: Entity)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-dod-panel';\n\n\t\tthis.entity = entity;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadDodPanel.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildDodPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildTeamSpeedPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-project-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-project-side-panel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-chart\"></div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildDodPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-project-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-project-side-panel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-dod-panel\"></div>\n\t\t\t\t<div class=\"tasks-scrum-project-dod-options\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox\">\n\t\t\t\t\t\t<input type=\"checkbox\" class=\"ui-ctl-element dod-items-required\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_OPTIONS_REQUIRED_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadTeamSpeedChartPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-project-side-panel');\n\n\t\tthis.getTeamSpeedChartData().then((data) => {\n\n\t\t\tsidePanel.closeLoader();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.teamSpeedChart = new TeamSpeedChart(data);\n\t\t\t\tthis.teamSpeedChart.createChart(this.form.querySelector('.tasks-scrum-project-side-panel-chart'));\n\t\t\t}, 300);\n\n\t\t});\n\t}\n\n\tonCloseTeamSpeedChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tif (this.sidePanelId === sidePanel.getUrl())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.teamSpeedChart)\n\t\t\t\t{\n\t\t\t\t\tthis.teamSpeedChart.destroyChart();\n\t\t\t\t\tthis.teamSpeedChart = null;\n\t\t\t\t}\n\t\t\t}, 300);\n\t\t}\n\t}\n\n\tonLoadDodPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-project-side-panel');\n\n\t\tthis.getDodComponent().then((data) => {\n\t\t\tsidePanel.closeLoader();\n\t\t\tconst dodContainer = this.form.querySelector('.tasks-scrum-project-dod-panel');\n\t\t\tRuntime.html(dodContainer, data.html);\n\t\t}).then(() => {\n\t\t\tthis.getDodPanelData().then((data) => {\n\t\t\t\tthis.prepareDodOptionsContainer(data);\n\t\t\t});\n\t\t}).then(() => {\n\t\t\tthis.requestSender.getDodButtons().then(response => {\n\t\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-project-side-panel-buttons');\n\t\t\t\tRuntime.html(buttonsContainer, response.data.html).then(() => {\n\t\t\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\t\t\tthis.requestSender.saveDod(this.getRequestDataForSaveList()).then(() => sidePanel.close());\n\t\t\t\t\t});\n\t\t\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTeamSpeedChartData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getTeamSpeedChartData().then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDodComponent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getDodComponent({\n\t\t\t\tentityId: this.entity.getId()\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDodPanelData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getDodPanelData({\n\t\t\t\tentityId: this.entity.getId()\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetRequestDataForSaveList()\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.entityId = this.entity.getId();\n\t\trequestData.items = this.getEntityChecklistItems();\n\t\trequestData.required = this.getDodItemsRequired();\n\n\t\treturn requestData;\n\t}\n\n\tgetEntityChecklistItems(): Array\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst treeStructure = BX.Tasks.CheckListInstance.getTreeStructure();\n\t\treturn treeStructure.getRequestData();\n\t\t/* eslint-enable */\n\t}\n\n\tgetDodItemsRequired(): string\n\t{\n\t\tconst optionsContainer = this.form.querySelector('.tasks-scrum-project-dod-options');\n\t\tconst option = optionsContainer.querySelector('.dod-items-required');\n\n\t\treturn (option.checked === true ? 'Y' : 'N');\n\t}\n\n\tprepareDodOptionsContainer(data)\n\t{\n\t\tif (data['dodItemsRequired'])\n\t\t{\n\t\t\tconst optionsContainer = this.form.querySelector('.tasks-scrum-project-dod-options');\n\t\t\tconst option = optionsContainer.querySelector('.dod-items-required');\n\t\t\toption.checked = (data['dodItemsRequired'] === 'Y');\n\t\t}\n\t}\n}","import {Sprint} from '../entity/sprint/sprint';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\n\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tgroupId: number\n}\n\ntype RemoveParams = {\n\tsprintId: number\n}\n\nexport class PullSprint\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tsprintAdded: this.onSprintAdded.bind(this),\n\t\t\tsprintUpdated: this.onSprintUpdated.bind(this),\n\t\t\tsprintRemoved: this.onSprintRemoved.bind(this)\n\t\t};\n\t}\n\n\tonSprintAdded(params: SprintParams)\n\t{\n\t\tif (this.groupId !== params.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = Sprint.buildSprint(params);\n\n\t\tif (this.needSkipAdd(sprint))\n\t\t{\n\t\t\tthis.cleanSkipAdd(sprint);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.domBuilder.createSprintNode(sprint);\n\t}\n\n\tonSprintUpdated(params: SprintParams)\n\t{\n\t\tconst tmpSprint = Sprint.buildSprint(params);\n\n\t\tif (this.needSkipUpdate(tmpSprint))\n\t\t{\n\t\t\tthis.cleanSkipUpdate(tmpSprint);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = this.entityStorage.findEntityByEntityId(tmpSprint.getId());\n\t\tif (sprint)\n\t\t{\n\t\t\tif (tmpSprint.getStatus() !== sprint.getStatus())\n\t\t\t{\n\t\t\t\tif (tmpSprint.getStatus() === 'active')\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.moveSprintToActiveListNode(sprint);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.moveSprintToCompletedListNode(sprint);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsprint.updateYourself(tmpSprint);\n\t\t}\n\t}\n\n\tonSprintRemoved(params: RemoveParams)\n\t{\n\t\tif (this.needSkipRemove(params.sprintId))\n\t\t{\n\t\t\tthis.cleanSkipRemove(params.sprintId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = this.entityStorage.findEntityByEntityId(params.sprintId);\n\t\tif (sprint)\n\t\t{\n\t\t\tsprint.removeSprint();\n\t\t\tthis.entityStorage.removeSprint(sprint.getId());\n\t\t}\n\t}\n\n\taddTmpIdToSkipAdding(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.add(tmpId);\n\t}\n\n\taddIdToSkipUpdating(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipUpdating.add(sprintId);\n\t}\n\n\taddIdToSkipRemoving(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.add(sprintId);\n\t}\n\n\tneedSkipAdd(sprint: Sprint): boolean\n\t{\n\t\treturn this.listIdsToSkipAdding.has(sprint.getTmpId());\n\t}\n\n\tcleanSkipAdd(sprint: Sprint)\n\t{\n\t\tthis.listIdsToSkipAdding.delete(sprint.getTmpId());\n\t}\n\n\tneedSkipUpdate(sprint: Sprint): boolean\n\t{\n\t\treturn this.listIdsToSkipUpdating.has(sprint.getId());\n\t}\n\n\tcleanSkipUpdate(sprint: Sprint)\n\t{\n\t\tthis.listIdsToSkipUpdating.delete(sprint.getId());\n\t}\n\n\tneedSkipRemove(sprintId: number): boolean\n\t{\n\t\treturn this.listIdsToSkipRemoving.has(sprintId);\n\t}\n\n\tcleanSkipRemove(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.delete(sprintId);\n\t}\n}","import {Loc, Type, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Menu} from 'main.popup';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nimport {Entity} from '../entity/entity';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\nimport {SubTasksManager} from './subtasks.manager';\n\nexport type ItemsSortInfo = {\n\t[id: number]: {\n\t\tsort: number,\n\t\tentityId?: number,\n\t\tupdatedItemId?: number\n\t}\n}\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tsubTasksCreator: SubTasksManager\n}\n\nexport class ItemMover extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\n\t\tthis.bindHandlers();\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.domBuilder.subscribe('itemMoveStart', (baseEvent: BaseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\t\tthis.hideSubTasks(sourceEntity, item);\n\t\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\t\tif (actionsPanel)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t}\n\t\t});\n\t\tthis.domBuilder.subscribe('itemMoveEnd', (baseEvent: BaseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tconst endContainer = dragEndEvent.endContainer;\n\t\t\tif (!endContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\n\t\t\tif (sourceEntityId === endEntityId)\n\t\t\t{\n\t\t\t\tthis.onItemMove(dragEndEvent);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(sourceEntity, message).then(() => {\n\t\t\t\t\tthis.onItemMove(dragEndEvent);\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\tconst itemNodeAfterSourceItem = sourceEntity.getListItemsNode().children[item.getSort()];\n\t\t\t\t\tthis.domBuilder.insertBefore(itemNode, itemNodeAfterSourceItem);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tmoveItem(item: Item, button)\n\t{\n\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\n\t\tconst listToMove = [];\n\n\t\tif (!entity.isFirstItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_UP'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\t\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst sortedItemsIds = new Set();\n\t\t\t\t\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\t\t\t\t\tthis.hideSubTasks(entity, groupModeItem);\n\t\t\t\t\t\t\tthis.moveItemToUp(groupModeItem, entity.getListItemsNode(), entity.hasInput(), false);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode(), sortedItemsIds)\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideSubTasks(entity, item);\n\t\t\t\t\t\tthis.moveItemToUp(item, entity.getListItemsNode(), entity.hasInput());\n\t\t\t\t\t}\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (!entity.isLastItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_DOWN'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\t\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst sortedItemsIds = new Set();\n\t\t\t\t\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\t\t\t\t\tthis.hideSubTasks(entity, groupModeItem);\n\t\t\t\t\t\t\tthis.moveItemToDown(groupModeItem, entity.getListItemsNode(), false);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode(), sortedItemsIds)\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideSubTasks(entity, item);\n\t\t\t\t\t\tthis.moveItemToDown(item, entity.getListItemsNode());\n\t\t\t\t\t}\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.showMoveItemMenu(item, button, listToMove);\n\t}\n\n\tmoveItemToUp(item: Item, listItemsNode, entityWithInput = true, updateSort = true)\n\t{\n\t\tif (entityWithInput)\n\t\t{\n\t\t\tthis.domBuilder.appendItemAfterItem(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.domBuilder.insertBefore(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tmoveItemToDown(item, listItemsNode, updateSort = true)\n\t{\n\t\tthis.domBuilder.append(item.getItemNode(), listItemsNode);\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tupdateItemsSort(item: Item, listItemsNode: HTMLElement)\n\t{\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(listItemsNode, new Set([item.getItemId()]))\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonItemMove(dragEndEvent)\n\t{\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\tconst endContainer = dragEndEvent.endContainer;\n\n\t\tif (endContainer === this.domBuilder.getSprintCreatingDropZoneNode())\n\t\t{\n\t\t\tconst createNewSprintAndMoveItem = () => {\n\t\t\t\tthis.domBuilder.createSprint().then((sprint) => {\n\t\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\tthis.moveTo(this.entityStorage.getBacklog(), sprint, item);\n\t\t\t\t});\n\t\t\t};\n\t\t\tcreateNewSprintAndMoveItem();\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\n\t\tif (sourceEntityId === endEntityId)\n\t\t{\n\t\t\tconst moveInCurrentContainer = () => {\n\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\tconst itemId = parseInt(itemNode.dataset.itemId, 10);\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tsortInfo: this.calculateSort(sourceContainer, new Set([itemId]))\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInCurrentContainer();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst moveInAnotherContainer = () => {\n\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\t\t\tconst endEntity = this.entityStorage.findEntityByEntityId(endEntityId);\n\t\t\t\tthis.moveItemFromEntityToEntity(item, sourceEntity, endEntity);\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tentityId: endEntity.getId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\titemType: item.getItemType(),\n\t\t\t\t\tsourceEntityId: sourceEntity.getId(),\n\t\t\t\t\tfromActiveSprint: ((sourceEntity.getEntityType() === 'sprint' && sourceEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\ttoActiveSprint: ((endEntity.getEntityType() === 'sprint' && endEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\tsortInfo: this.calculateSort(endContainer, new Set([item.getItemId()]), true)\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInAnotherContainer();\n\t\t}\n\t}\n\n\tcalculateSort(container, updatedItemsIds?: Set, moveToAnotherEntity = false): ItemsSortInfo\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst items = [...container.querySelectorAll('[data-sort]')];\n\t\tlet sort = 1;\n\t\titems.forEach((itemNode) => {\n\t\t\tconst itemId = parseInt(itemNode.dataset.itemId, 10);\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tif (item && !item.isSubTask())\n\t\t\t{\n\t\t\t\tconst tmpId = Text.getRandom();\n\t\t\t\tlet isSortUpdated = (sort !== item.getSort());\n\t\t\t\titem.setSort(sort);\n\t\t\t\tlistSortInfo[itemId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tif (moveToAnotherEntity)\n\t\t\t\t{\n\t\t\t\t\tlistSortInfo[itemId].entityId = container.dataset.entityId;\n\t\t\t\t\tisSortUpdated = true;\n\t\t\t\t}\n\t\t\t\tif (isSortUpdated && updatedItemsIds && updatedItemsIds.has(itemId))\n\t\t\t\t{\n\t\t\t\t\tlistSortInfo[itemId].tmpId = tmpId;\n\t\t\t\t\tlistSortInfo[itemId].updatedItemId = itemId;\n\t\t\t\t}\n\t\t\t\titemNode.dataset.sort = sort;\n\t\t\t}\n\t\t\tsort++;\n\t\t});\n\n\t\tthis.emit('calculateSort', listSortInfo);\n\n\t\treturn listSortInfo;\n\t}\n\n\tmoveToAnotherEntity(entityFrom: Entity, item: Item, targetEntity: ?Entity, bindButton?: HTMLElement)\n\t{\n\t\tconst isMoveToSprint = (Type.isNull(targetEntity));\n\n\t\tconst sprints = (isMoveToSprint ? this.entityStorage.getSprintsAvailableForFilling(entityFrom) : null);\n\n\t\tif (entityFrom.isGroupMode())\n\t\t{\n\t\t\tif (isMoveToSprint)\n\t\t\t{\n\t\t\t\tif (sprints.size > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.showListSprintsToMove(entityFrom, item, bindButton);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (sprints.size === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.domBuilder.createSprint().then((sprint: Sprint) => {\n\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, targetEntity, item, false, false);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (isMoveToSprint)\n\t\t\t{\n\t\t\t\tif (sprints.size > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.showListSprintsToMove(entityFrom, item, bindButton);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\t\tif (sprints.size === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.domBuilder.createSprint().then((sprint: Sprint) => {\n\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\tthis.moveTo(entityFrom, targetEntity, item, false);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveToWithGroupMode(entityFrom: Entity, entityTo: Entity, item: Item, after = true, update = true)\n\t{\n\t\tconst groupModeItems = entityFrom.getGroupModeItems();\n\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\tif (after)\n\t\t\t{\n\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t}\n\t\t});\n\t\tconst sortedItemsIds = new Set();\n\t\tconst items = [];\n\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\tthis.moveTo(entityFrom, entityTo, groupModeItem, after, update);\n\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\titems.push({\n\t\t\t\titemId: groupModeItem.getItemId(),\n\t\t\t\titemType: groupModeItem.getItemType(),\n\t\t\t\tentityId: entityTo.getId(),\n\t\t\t\tsourceEntityId: entityFrom.getId(),\n\t\t\t\tfromActiveSprint: ((entityFrom.getEntityType() === 'sprint' && entityFrom.isActive()) ? 'Y' : 'N'),\n\t\t\t\ttoActiveSprint: ((entityTo.getEntityType() === 'sprint' && entityTo.isActive()) ? 'Y' : 'N')\n\t\t\t});\n\t\t});\n\t\tthis.requestSender.batchUpdateItem({\n\t\t\titems: items,\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), sortedItemsIds, true),\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), new Set(), true)\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t\tentityFrom.deactivateGroupMode();\n\t}\n\n\thideSubTasks(entity: Entity, item: Item)\n\t{\n\t\tif (item && item.isParentTask())\n\t\t{\n\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t{\n\t\t\t\tthis.subTasksCreator.toggleSubTasks(entity, item);\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveTo(entityFrom: Entity, entityTo: Entity, item: Item, after = true, update = true)\n\t{\n\t\tthis.hideSubTasks(entityFrom, item);\n\n\t\tconst itemNode = item.getItemNode();\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\t\tif (after)\n\t\t{\n\t\t\tthis.domBuilder.append(itemNode, entityListNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.domBuilder.appendItemAfterItem(itemNode, entityListNode.firstElementChild);\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\n\t\tif (update)\n\t\t{\n\t\t\tthis.onMoveItemUpdate(entityFrom, entityTo, item);\n\t\t}\n\t}\n\n\tmoveToPosition(entityFrom: Entity, entityTo: Entity, item: Item)\n\t{\n\t\tthis.hideSubTasks(entityFrom, item);\n\n\t\tconst itemNode = item.getItemNode();\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\t\tconst bindItemNode = entityListNode.children[item.getSort()];\n\t\tif (Type.isUndefined(bindItemNode))\n\t\t{\n\t\t\tthis.domBuilder.append(itemNode, entityListNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst bindItemSort = parseInt(bindItemNode.dataset.sort, 10);\n\t\t\tconst isMoveFromAnotherEntity = (entityFrom.getId() !== entityTo.getId())\n\n\t\t\tif (bindItemSort >= item.getPreviousSort())\n\t\t\t{\n\t\t\t\tif (isMoveFromAnotherEntity)\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.insertBefore(itemNode, bindItemNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.appendItemAfterItem(itemNode, bindItemNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.domBuilder.insertBefore(itemNode, bindItemNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\t}\n\n\tonMoveItemUpdate(entityFrom: Entity, entityTo: Entity, item: Item)\n\t{\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\titemType: item.getItemType(),\n\t\t\tentityId: entityTo.getId(),\n\t\t\tsourceEntityId: entityFrom.getId(),\n\t\t\tfromActiveSprint: ((entityFrom.getEntityType() === 'sprint' && entityFrom.isActive()) ? 'Y' : 'N'),\n\t\t\ttoActiveSprint: ((entityTo.getEntityType() === 'sprint' && entityTo.isActive()) ? 'Y' : 'N'),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), new Set([item.getItemId()]), true),\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), new Set(), true)\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tmoveItemFromEntityToEntity(item: Item, entityFrom: Entity, entityTo: Entity)\n\t{\n\t\tif (entityFrom.isActive())\n\t\t{\n\t\t\tentityFrom.subtractTotalStoryPoints(item);\n\t\t}\n\n\t\tif (entityTo.isActive())\n\t\t{\n\t\t\tentityTo.addTotalStoryPoints(item);\n\t\t}\n\n\t\tentityFrom.removeItem(item);\n\t\titem.setParentEntity(entityTo.getId(), entityTo.getEntityType());\n\t\titem.setDisableStatus(false);\n\t\tentityTo.setItem(item);\n\t}\n\n\tshowListSprintsToMove(entityFrom: Entity, item: Item, button: HTMLElement)\n\t{\n\t\tconst id = `item-sprint-action-${entityFrom.getEntityType() + entityFrom.getId() + item.itemId}`;\n\n\t\tif (this.moveToSprintMenu)\n\t\t{\n\t\t\tif (this.moveToSprintMenu.getPopupWindow().getId() === id)\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.getPopupWindow().setBindElement(button);\n\t\t\t\tthis.moveToSprintMenu.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.moveToSprintMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveToSprintMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (!sprint.isCompleted() && !this.isSameSprint(entityFrom, sprint))\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.addMenuItem({\n\t\t\t\t\ttext: sprint.getName(),\n\t\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\t\tlet message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\t\t\tif (entityFrom.isGroupMode())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmessage = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\t\t\tif (entityFrom.isGroupMode())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\t\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.moveToSprintMenu.show();\n\t}\n\n\tisSameSprint(first: Sprint, second: Sprint): boolean\n\t{\n\t\treturn (first.getEntityType() === 'sprint' && first.getId() === second.getId());\n\t}\n\n\tonMoveConfirm(entity: Entity, message: string): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (entity.isActive())\n\t\t\t{\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tmessage,\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_MOVE'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\treject();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tshowMoveItemMenu(item, button, listToMove)\n\t{\n\t\tconst id = `item-move-${item.itemId}`;\n\n\t\tif (this.moveItemMenu)\n\t\t{\n\t\t\tthis.moveItemMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveItemMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tlistToMove.forEach((item) => {\n\t\t\tthis.moveItemMenu.addMenuItem(item);\n\t\t});\n\n\t\tthis.moveItemMenu.show();\n\t}\n}","import {Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\nimport {TagSearcher} from './tag.searcher';\nimport {ItemMover} from './item.mover';\nimport {SubTasksManager} from './subtasks.manager';\nimport {Counters} from './counters';\n\nimport type {ItemParams} from '../item/item';\nimport type {ItemsSortInfo} from './item.mover';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\ttagSearcher: TagSearcher,\n\titemMover: ItemMover,\n\tsubTasksCreator: SubTasksManager,\n\tcounters: Counters,\n\tcurrentUserId: number\n}\n\ntype RemoveParams = {\n\titemId: number\n}\n\nexport class PullItem\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.tagSearcher = params.tagSearcher;\n\t\tthis.itemMover = params.itemMover;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\t\tthis.counters = params.counters;\n\t\tthis.currentUserId = params.currentUserId;\n\n\t\tthis.listToAddAfterUpdate = new Map();\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t\tthis.listIdsToSkipSorting = new Set();\n\n\t\tthis.itemMover.subscribe('calculateSort', this.onCalculateSort.bind(this))\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\titemAdded: this.onItemAdded.bind(this),\n\t\t\titemUpdated: this.onItemUpdated.bind(this),\n\t\t\titemRemoved: this.onItemRemoved.bind(this),\n\t\t\titemSortUpdated: this.onItemSortUpdated.bind(this),\n\t\t\tcomment_add: this.onCommentAdd.bind(this)\n\t\t};\n\t}\n\n\tonItemAdded(itemData: ItemParams)\n\t{\n\t\tconst item = new Item(itemData);\n\n\t\tthis.setDelayedAdd(item);\n\n\t\tthis.externalAdd(item)\n\t\t\t.finally(() => this.cleanDelayedAdd(item))\n\t\t\t.then(() => this.addItemToEntity(item))\n\t\t\t.catch(() => {})\n\t\t;\n\t}\n\n\tonItemUpdated(itemData: ItemParams)\n\t{\n\t\tconst item = new Item(itemData);\n\n\t\tif (this.isDelayedAdd(item))\n\t\t{\n\t\t\tthis.cleanDelayedAdd(item);\n\n\t\t\tif (this.needSkipAdd(item))\n\t\t\t{\n\t\t\t\tthis.cleanSkipAdd(item);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.addItemToEntity(item);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.needSkipUpdate(item))\n\t\t{\n\t\t\tthis.cleanSkipUpdate(item);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateItem(item);\n\t}\n\n\tonItemRemoved(params: RemoveParams)\n\t{\n\t\tif (this.needSkipRemove(params.itemId))\n\t\t{\n\t\t\tthis.cleanSkipRemove(params.itemId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = this.entityStorage.findItemByItemId(params.itemId);\n\t\tif (item)\n\t\t{\n\t\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\t\t\tentity.removeItem(item);\n\t\t\titem.removeYourself();\n\t\t}\n\t}\n\n\tonItemSortUpdated(itemsSortInfo : ItemsSortInfo)\n\t{\n\t\tconst itemsToSort = new Map();\n\t\tconst itemsInfoToSort = new Map();\n\t\tObject.entries(itemsSortInfo).forEach(([itemId, info]) => {\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tif (!this.needSkipSort(info.tmpId))\n\t\t\t\t{\n\t\t\t\t\titemsToSort.set(item.getItemId(), item);\n\t\t\t\t\titemsInfoToSort.set(item.getItemId(), info);\n\t\t\t\t}\n\t\t\t\tthis.cleanSkipRemove(info.tmpId);\n\t\t\t}\n\t\t});\n\n\t\titemsToSort.forEach((item: Item) => {\n\t\t\tconst itemInfoToSort = itemsInfoToSort.get(item.getItemId());\n\t\t\titem.setSort(itemInfoToSort.sort);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\tif (sourceEntity)\n\t\t\t{\n\t\t\t\tconst targetEntityId = (\n\t\t\t\t\tType.isUndefined(itemInfoToSort.entityId)\n\t\t\t\t\t\t? item.getEntityId()\n\t\t\t\t\t\t: itemInfoToSort.entityId\n\t\t\t\t);\n\t\t\t\tlet targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\t\t\t\tif (!targetEntity || sourceEntity.getId() === targetEntity.getId())\n\t\t\t\t{\n\t\t\t\t\ttargetEntity = sourceEntity;\n\t\t\t\t}\n\t\t\t\tthis.itemMover.moveToPosition(sourceEntity, targetEntity, item);\n\t\t\t\tthis.entityStorage.recalculateItemsSort();\n\t\t\t}\n\t\t});\n\t}\n\n\tonCommentAdd(params)\n\t{\n\t\tconst participants = Type.isArray(params.participants) ? params.participants : [];\n\n\t\tif (participants.includes(this.currentUserId.toString()))\n\t\t{\n\t\t\tconst xmlId = params.entityXmlId.split('_');\n\t\t\tif (xmlId)\n\t\t\t{\n\t\t\t\tconst entityType = xmlId[0];\n\t\t\t\tconst taskId = xmlId[1];\n\t\t\t\tconst item = this.entityStorage.findItemBySourceId(taskId);\n\t\t\t\tif (entityType === 'TASK' && item)\n\t\t\t\t{\n\t\t\t\t\tthis.requestSender.getCurrentState({\n\t\t\t\t\t\ttaskId: item.getSourceId()\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tconst tmpItem = new Item(response.data.itemData);\n\t\t\t\t\t\tthis.updateItem(tmpItem, item);\n\t\t\t\t\t\tthis.counters.updateState(response.data.counters);\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddItemToEntity(item: Item)\n\t{\n\t\tif (item.isSubTask())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.hasTaskInFilter({\n\t\t\ttaskId: item.getSourceId()\n\t\t}).then((response) => {\n\t\t\tif (!response.data.has)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\tif (!entity)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst bindItemNode = entity.getListItemsNode().children[1];\n\n\t\t\tif (bindItemNode)\n\t\t\t{\n\t\t\t\tthis.domBuilder.insertBefore(item.render(), bindItemNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.domBuilder.append(item.render(), entity.getListItemsNode());\n\t\t\t}\n\n\t\t\titem.onAfterAppend(entity.getListItemsNode());\n\t\t\tentity.setItem(item);\n\n\t\t\titem.getTags().forEach((tag) => {\n\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t});\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tupdateItem(tmpItem: Item, item?: Item)\n\t{\n\t\tif (!item)\n\t\t{\n\t\t\titem = this.entityStorage.findItemByItemId(tmpItem.getItemId());\n\t\t}\n\t\tif (item)\n\t\t{\n\t\t\tif (item.isParentTask())\n\t\t\t{\n\t\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\t\tthis.subTasksCreator.hideSubTaskItems(entity, item);\n\t\t\t\t}\n\t\t\t\tthis.subTasksCreator.cleanSubTasks(item);\n\t\t\t}\n\n\t\t\tconst isParentChangeAction = tmpItem.isSubTask() !== item.isSubTask();\n\t\t\tif (isParentChangeAction)\n\t\t\t{\n\t\t\t\tif (tmpItem.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\t\t\t\t\tentity.removeItem(item);\n\t\t\t\t\titem.removeYourself();\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (tmpItem.getEntityId() !== item.getEntityId())\n\t\t\t{\n\t\t\t\tconst targetEntityId = tmpItem.getEntityId();\n\t\t\t\tconst sourceEntityId = item.getEntityId();\n\t\t\t\tconst targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\t\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\t\t\tif (targetEntity && sourceEntity)\n\t\t\t\t{\n\t\t\t\t\tthis.itemMover.moveToPosition(sourceEntity, targetEntity, item);\n\t\t\t\t\tthis.entityStorage.recalculateItemsSort();\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.updateYourself(tmpItem);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (tmpItem.isSubTask())\n\t\t\t{\n\t\t\t\tconst parentItem = this.entityStorage.findItemBySourceId(tmpItem.getParentTaskId());\n\t\t\t\tif (parentItem)\n\t\t\t\t{\n\t\t\t\t\tparentItem.updateSubTasksPoints(tmpItem.getSourceId(), tmpItem.getStoryPoints());\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.addItemToEntity(tmpItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tonCalculateSort(baseEvent: BaseEvent)\n\t{\n\t\tconst listSortInfo = baseEvent.getData();\n\n\t\tObject.entries(listSortInfo).forEach(([itemId, info]) => {\n\t\t\tif (Object.prototype.hasOwnProperty.call(info, 'tmpId'))\n\t\t\t{\n\t\t\t\tthis.addTmpIdToSkipSorting(info.tmpId);\n\t\t\t}\n\t\t});\n\t}\n\n\taddTmpIdsToSkipAdding(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.add(tmpId);\n\t}\n\n\taddIdToSkipUpdating(itemId: string)\n\t{\n\t\tthis.listIdsToSkipUpdating.add(itemId);\n\t}\n\n\taddIdToSkipRemoving(itemId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.add(itemId);\n\t}\n\n\taddTmpIdToSkipSorting(itemId: number)\n\t{\n\t\tthis.listIdsToSkipSorting.add(itemId);\n\t}\n\n\texternalAdd(item: Item): boolean\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tsetTimeout(() => (this.isDelayedAdd(item) ? resolve() : reject()), 3000);\n\t\t});\n\t}\n\n\tisDelayedAdd(item: Item): boolean\n\t{\n\t\treturn this.listToAddAfterUpdate.has(item.getItemId());\n\t}\n\n\tsetDelayedAdd(item: Item)\n\t{\n\t\tthis.listToAddAfterUpdate.set(item.getItemId(), item);\n\t}\n\n\tcleanDelayedAdd(item: Item)\n\t{\n\t\tthis.listToAddAfterUpdate.delete(item.getItemId());\n\t}\n\n\tneedSkipAdd(item: Item): boolean\n\t{\n\t\treturn this.listIdsToSkipAdding.has(item.getTmpId());\n\t}\n\n\tcleanSkipAdd(item: Item)\n\t{\n\t\tthis.listIdsToSkipAdding.delete(item.getTmpId());\n\t}\n\n\tneedSkipUpdate(item: Item): boolean\n\t{\n\t\treturn this.listIdsToSkipUpdating.has(item.getItemId());\n\t}\n\n\tcleanSkipUpdate(item: Item)\n\t{\n\t\tthis.listIdsToSkipUpdating.delete(item.getItemId());\n\t}\n\n\tneedSkipRemove(itemId: number): boolean\n\t{\n\t\treturn this.listIdsToSkipRemoving.has(itemId);\n\t}\n\n\tcleanSkipRemove(itemId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.delete(itemId);\n\t}\n\n\tneedSkipSort(tmpId: string): boolean\n\t{\n\t\treturn this.listIdsToSkipSorting.has(tmpId);\n\t}\n\n\tcleanSkipSort(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipSorting.delete(tmpId);\n\t}\n}","import {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\nimport {Epic} from './epic';\n\nimport type {EpicType} from '../item/item';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tepic: Epic\n}\n\nexport class PullEpic\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.epic = params.epic;\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tepicAdded: this.onEpicAdded.bind(this),\n\t\t\tepicUpdated: this.onEpicUpdated.bind(this),\n\t\t\tepicRemoved: this.onEpicRemoved.bind(this)\n\t\t};\n\t}\n\n\tonEpicAdded(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterCreateEpic(epicData);\n\t}\n\n\tonEpicUpdated(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterUpdateEpic(epicData);\n\t}\n\n\tonEpicRemoved(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterRemoveEpic(epicData);\n\t}\n}","import {BaseEvent} from 'main.core.events';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage\n}\n\nexport class SprintMover\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.bindHandlers();\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.domBuilder.subscribe('sprintMove', this.onSprintMove.bind(this))\n\t}\n\n\tonSprintMove(baseEvent: BaseEvent)\n\t{\n\t\tconst dragEndEvent = baseEvent.getData();\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.updateSprintSort({\n\t\t\tsortInfo: this.calculateSprintSort()\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tcalculateSprintSort(increment = 0)\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst container = this.domBuilder.getSprintPlannedListNode();\n\n\t\tconst sprints = [...container.querySelectorAll('[data-sprint-sort]')];\n\t\tlet sort = 1 + increment;\n\t\tsprints.forEach((sprintNode) => {\n\t\t\tconst sprintId = sprintNode.dataset.sprintId;\n\t\t\tconst sprint = this.entityStorage.findEntityByEntityId(sprintId);\n\t\t\tif (sprint)\n\t\t\t{\n\t\t\t\tsprint.setSort(sort);\n\t\t\t\tlistSortInfo[sprintId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tsprintNode.dataset.sprintSort = sort;\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\n\t\treturn listSortInfo;\n\t}\n}","import {Type, Dom} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {View} from './view';\nimport {TeamSpeedButton} from './header/team.speed.button';\n\nimport {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\nimport {Entity} from '../entity/entity';\nimport {Item} from '../item/item';\nimport {Decomposition} from '../item/task/decomposition';\n\nimport {SidePanel} from '../service/side.panel';\nimport {PULL as Pull} from 'pull.client';\n\nimport {DomBuilder} from '../utility/dom.builder';\nimport {EntityStorage} from '../utility/entity.storage';\nimport {FilterHandler} from '../utility/filter.handler';\nimport {Epic} from '../utility/epic';\nimport {TagSearcher} from '../utility/tag.searcher';\nimport {ProjectSidePanel} from '../utility/project.side.panel';\nimport {PullSprint} from '../utility/pull.sprint';\nimport {PullItem} from '../utility/pull.item';\nimport {PullEpic} from '../utility/pull.epic';\nimport {SprintMover} from '../utility/sprint.mover';\nimport {ItemMover} from '../utility/item.mover';\nimport {ItemStyleDesigner} from '../utility/item.style.designer';\nimport {SubTasksManager} from '../utility/subtasks.manager';\n\nimport type {BacklogParams} from '../entity/backlog/backlog';\nimport type {SprintParams} from '../entity/sprint/sprint';\nimport type {EpicType, ItemParams} from '../item/item';\nimport type {Views} from './view';\n\ntype Responsible = {\n\tname: string,\n\tpathToUser: string,\n\tphoto: {\n\t\tsrc: string\n\t}\n}\n\ntype Params = {\n\tpathToTask: string,\n\tdefaultSprintDuration: number,\n\tactiveSprintId: number,\n\tbacklog: BacklogParams,\n\tsprints: Array<SprintParams>,\n\tviews: Views,\n\ttags: {\n\t\tepic: EpicType,\n\t\ttask: Array\n\t},\n\tdefaultResponsible: Responsible\n}\n\nexport class Plan extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Plan');\n\n\t\tthis.pathToTask = params.pathToTask;\n\t\tthis.defaultResponsible = params.defaultResponsible;\n\t\tthis.activeSprintId = parseInt(params.activeSprintId, 10);\n\t\tthis.views = params.views;\n\n\t\tthis.entityStorage = new EntityStorage();\n\t\tthis.entityStorage.addBacklog(Backlog.buildBacklog(params.backlog));\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tsprintData.defaultSprintDuration = params.defaultSprintDuration;\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t});\n\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.filterHandler = new FilterHandler({\n\t\t\tfilter: this.filter,\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.tagSearcher = new TagSearcher();\n\t\tObject.values(params.tags.epic).forEach((epic) => {\n\t\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\t});\n\t\tObject.values(params.tags.task).forEach((tagName) => {\n\t\t\tthis.tagSearcher.addTagToSearcher(tagName);\n\t\t});\n\n\t\tthis.domBuilder = new DomBuilder({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tdefaultSprintDuration: params.defaultSprintDuration,\n\t\t\tpageNumberToCompletedSprints: params.pageNumberToCompletedSprints\n\t\t});\n\t\tthis.domBuilder.subscribe('beforeCreateSprint', (baseEvent: BaseEvent) => {\n\t\t\tconst requestData = baseEvent.getData();\n\t\t\tthis.pullSprint.addTmpIdToSkipAdding(requestData.tmpId);\n\t\t});\n\t\tthis.domBuilder.subscribe(\n\t\t\t'createSprint',\n\t\t\t(baseEvent: BaseEvent) => this.onSubscribeToSprint(baseEvent.getData())\n\t\t);\n\t\tthis.domBuilder.subscribe(\n\t\t\t'createSprintNode',\n\t\t\t(baseEvent: BaseEvent) => this.onSubscribeToSprint(baseEvent.getData())\n\t\t);\n\n\t\tthis.sprintMover = new SprintMover({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.subTasksCreator = new SubTasksManager({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder\n\t\t});\n\n\t\tthis.itemMover = new ItemMover({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tsubTasksCreator: this.subTasksCreator\n\t\t});\n\n\t\tthis.itemStyleDesigner = new ItemStyleDesigner({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.epic = new Epic({\n\t\t\tentity: this.entityStorage.getBacklog(),\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tfilter: this.filter,\n\t\t\ttagSearcher: this.tagSearcher\n\t\t});\n\n\t\tthis.pullSprint = new PullSprint({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tgroupId: this.getCurrentGroupId()\n\t\t});\n\t\tthis.pullItem = new PullItem({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\ttagSearcher: this.tagSearcher,\n\t\t\titemMover: this.itemMover,\n\t\t\tsubTasksCreator: this.subTasksCreator,\n\t\t\tcounters: this.counters,\n\t\t\tcurrentUserId: this.getCurrentUserId()\n\t\t});\n\t\tthis.pullEpic = new PullEpic({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tepic: this.epic,\n\t\t});\n\n\t\tthis.bindHandlers();\n\n\t\tthis.subscribeToPull();\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tsuper.renderTo(container);\n\n\t\tthis.domBuilder.renderTo(container);\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderButtonsTo(container);\n\n\t\tconst teamSpeedButton = new TeamSpeedButton();\n\t\tteamSpeedButton.subscribe('click', this.onShowTeamSpeedChart.bind(this));\n\n\t\tDom.append(teamSpeedButton.render(), container);\n\t}\n\n\tsubscribeToPull()\n\t{\n\t\tPull.subscribe(this.pullSprint);\n\t\tPull.subscribe(this.pullItem);\n\t\tPull.subscribe(this.pullEpic);\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.entityStorage.getBacklog().subscribe('createTaskItem', this.onCreateTaskItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('updateItem', this.onUpdateItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showTask', this.onShowTask.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('moveItem', this.onMoveItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('moveToSprint', this.onMoveToSprint.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('removeItem', this.onRemoveItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('changeTaskResponsible', this.onChangeTaskResponsible.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('openAddEpicForm', this.onOpenAddEpicForm.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('openListEpicGrid', this.onOpenListEpicGrid.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('openDefinitionOfDone', this.onOpenDefinitionOfDone.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('attachFilesToTask', this.onAttachFilesToTask.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showTagSearcher', this.onShowTagSearcher.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showEpicSearcher', this.onShowEpicSearcher.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('startDecomposition', this.onStartDecomposition.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('epicSearchOpen', this.onEpicSearchOpen.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('epicSearchClose', this.onEpicSearchClose.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('filterByEpic', this.onFilterByEpic.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('filterByTag', this.onFilterByTag.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('activateGroupMode', this.onActivateGroupMode.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('loadBacklogItems', this.onLoadBacklogItems.bind(this));\n\n\t\tthis.entityStorage.getSprints().forEach((sprint) => this.onSubscribeToSprint(sprint));\n\n\t\tthis.epic.subscribe('filterByTag', this.onFilterByTag.bind(this));\n\t}\n\n\tonSubscribeToSprint(sprint: Sprint)\n\t{\n\t\tsprint.subscribe('createTaskItem', this.onCreateTaskItem.bind(this));\n\t\tsprint.subscribe('updateItem', this.onUpdateItem.bind(this));\n\t\tsprint.subscribe('showTask', this.onShowTask.bind(this));\n\t\tsprint.subscribe('moveItem', this.onMoveItem.bind(this));\n\t\tsprint.subscribe('moveToSprint', this.onMoveToSprint.bind(this));\n\t\tsprint.subscribe('moveToBacklog', this.onMoveToBacklog.bind(this));\n\t\tsprint.subscribe('removeItem', this.onRemoveItem.bind(this));\n\t\tsprint.subscribe('startSprint', this.onStartSprint.bind(this));\n\t\tsprint.subscribe('completeSprint', this.onCompleteSprint.bind(this));\n\t\tsprint.subscribe('changeTaskResponsible', this.onChangeTaskResponsible.bind(this));\n\t\tsprint.subscribe('removeSprint', this.onRemoveSprint.bind(this));\n\t\tsprint.subscribe('changeSprintName', this.onChangeSprintName.bind(this));\n\t\tsprint.subscribe('changeSprintDeadline', this.onChangeSprintDeadline.bind(this));\n\t\tsprint.subscribe('attachFilesToTask', this.onAttachFilesToTask.bind(this));\n\t\tsprint.subscribe('showTagSearcher', this.onShowTagSearcher.bind(this));\n\t\tsprint.subscribe('showEpicSearcher', this.onShowEpicSearcher.bind(this));\n\t\tsprint.subscribe('startDecomposition', this.onStartDecomposition.bind(this));\n\t\tsprint.subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tsprint.subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tsprint.subscribe('epicSearchOpen', this.onEpicSearchOpen.bind(this));\n\t\tsprint.subscribe('epicSearchClose', this.onEpicSearchClose.bind(this));\n\t\tsprint.subscribe('filterByEpic', this.onFilterByEpic.bind(this));\n\t\tsprint.subscribe('filterByTag', this.onFilterByTag.bind(this));\n\t\tsprint.subscribe('activateGroupMode', this.onActivateGroupMode.bind(this));\n\t\tsprint.subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t\tsprint.subscribe('getSprintCompletedItems', this.onGetSprintCompletedItems.bind(this));\n\t\tsprint.subscribe('showSprintBurnDownChart', this.onShowSprintBurnDownChart.bind(this));\n\t\tsprint.subscribe('toggleSubTasks', this.onToggleSubTasks.bind(this));\n\t}\n\n\tonCreateTaskItem(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst inputObject = data.inputObject;\n\t\tconst inputValue = data.value;\n\n\t\tconst newItem = this.createItem('task', inputValue);\n\n\t\tthis.pullItem.addTmpIdsToSkipAdding(newItem.getItemId());\n\n\t\tthis.fillItemBeforeCreation(entity, newItem, inputValue);\n\n\t\tthis.domBuilder.appendItemAfterItem(newItem.render(), inputObject.getNode());\n\t\tnewItem.onAfterAppend(entity.getListItemsNode());\n\n\t\tnewItem.setParentId(inputObject.getEpicId());\n\t\tinputObject.setEpicId(0);\n\n\t\tthis.sendRequestToCreateTask(entity, newItem).then((response) => {\n\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t});\n\t\t\tentity.setItem(newItem);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonUpdateItem(baseEvent: BaseEvent)\n\t{\n\t\tconst updateData = baseEvent.getData();\n\t\tthis.pullItem.addIdToSkipUpdating(updateData.itemId);\n\t\tthis.requestSender.updateItem(baseEvent.getData()).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonRemoveItem(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tif (entity.isGroupMode())\n\t\t{\n\t\t\tconst items = [];\n\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\titems.push({\n\t\t\t\t\titemId: groupModeItem.getItemId(),\n\t\t\t\t\tentityId: groupModeItem.getEntityId(),\n\t\t\t\t\titemType: groupModeItem.getItemType(),\n\t\t\t\t\tsourceId: groupModeItem.getSourceId()\n\t\t\t\t});\n\t\t\t\tthis.pullItem.addIdToSkipRemoving(groupModeItem.getItemId());\n\t\t\t});\n\t\t\tthis.requestSender.batchRemoveItem({\n\t\t\t\titems: items,\n\t\t\t\tsortInfo: this.itemMover.calculateSort(entity.getListItemsNode())\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t\tentity.deactivateGroupMode();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pullItem.addIdToSkipRemoving(baseEvent.getData().getItemId());\n\t\t\tthis.requestSender.removeItem({\n\t\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\t\tentityId: baseEvent.getData().getEntityId(),\n\t\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\t\tsortInfo: this.itemMover.calculateSort(entity.getListItemsNode())\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t}\n\t}\n\n\tonMoveItem(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tthis.itemMover.moveItem(data.item, data.button);\n\t}\n\n\tonMoveToSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst entityFrom = baseEvent.getTarget();\n\t\tthis.itemMover.moveToAnotherEntity(entityFrom, data.item, null, data.button);\n\t\tif (this.entityStorage.getSprintsAvailableForFilling(entityFrom).size <= 1)\n\t\t{\n\t\t\tthis.domBuilder.remove(data.button.parentNode);\n\t\t}\n\t}\n\n\tonMoveToBacklog(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tthis.itemMover.moveToAnotherEntity(data.sprint, data.item, this.entityStorage.getBacklog());\n\t}\n\n\tonChangeTaskResponsible(baseEvent: BaseEvent)\n\t{\n\t\tthis.pullItem.addIdToSkipUpdating(baseEvent.getData().getItemId());\n\t\tthis.requestSender.changeTaskResponsible({\n\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\tresponsible: baseEvent.getData().getResponsible(),\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonStartSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showStartSidePanel(sprint);\n\t}\n\n\tonCompleteSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showCompleteSidePanel(sprint);\n\t}\n\n\tonRemoveSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tthis.pullSprint.addIdToSkipRemoving(sprint.getId());\n\t\tthis.requestSender.removeSprint({\n\t\t\tsprintId: sprint.getId(),\n\t\t\tsortInfo: this.sprintMover.calculateSprintSort()\n\t\t}).then((response) => {\n\t\t\tthis.entityStorage.removeSprint(sprint.getId());\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeSprintName(baseEvent: BaseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.pullSprint.addIdToSkipUpdating(requestData.sprintId);\n\t\tthis.requestSender.changeSprintName(requestData).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeSprintDeadline(baseEvent: BaseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.pullSprint.addIdToSkipUpdating(requestData.sprintId);\n\t\tthis.requestSender.changeSprintDeadline(requestData).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonGetSprintCompletedItems(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst listItemsNode = sprint.getListItemsNode();\n\t\tconst listPosition = this.domBuilder.getPosition(listItemsNode);\n\t\tconst loader = new Loader({\n\t\t\ttarget: listItemsNode,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: '#eaeaea',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\t\tloader.show();\n\t\tthis.requestSender.getSprintCompletedItems({\n\t\t\tsprintId: sprint.getId()\n\t\t}).then((response) => {\n\t\t\tconst itemsData = response.data;\n\t\t\titemsData.forEach((itemData) => {\n\t\t\t\tconst item = new Item(itemData);\n\t\t\t\titem.setDisableStatus(sprint.isDisabled());\n\t\t\t\tthis.domBuilder.append(item.render(), listItemsNode);\n\t\t\t\tsprint.setItem(item);\n\t\t\t});\n\t\t\tloader.hide();\n\t\t}).catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonShowSprintBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(sprint);\n\t}\n\n\tonShowTask(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getData();\n\t\tthis.sidePanel.openSidePanelByUrl(this.pathToTask.replace('#task_id#', item.getSourceId()));\n\t}\n\n\tonAttachFilesToTask(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tthis.pullItem.addIdToSkipUpdating(data.item.getItemId());\n\t\tthis.requestSender.attachFilesToTask({\n\t\t\ttaskId: data.item.getSourceId(),\n\t\t\titemId: data.item.getItemId(),\n\t\t\tentityId: data.item.getEntityId(),\n\t\t\tattachedIds: data.attachedIds,\n\t\t}).then((response) => {\n\t\t\tdata.item.updateIndicators(response.data);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonToggleSubTasks(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst item = baseEvent.getData();\n\n\t\tthis.subTasksCreator.toggleSubTasks(sprint, item);\n\t}\n\n\tonShowTagSearcher(baseEvent: BaseEvent)\n\t{\n\t\t//todo refactor and test\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst data = baseEvent.getData();\n\t\tconst item = data.item;\n\t\tconst actionsPanelButton = data.button;\n\t\tthis.tagSearcher.showTagsDialog(item, actionsPanelButton);\n\t\tthis.tagSearcher.unsubscribeAll('attachTagToTask');\n\t\tthis.tagSearcher.subscribe('attachTagToTask', (innerBaseEvent) => {\n\t\t\tconst tag = innerBaseEvent.getData();\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tconst tasks = [];\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\ttasks.push({\n\t\t\t\t\t\ttaskId: groupModeItem.getSourceId(),\n\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.requestSender.batchAttachTagToTask({\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tconst currentTags = groupModeItem.getTags();\n\t\t\t\t\t\tcurrentTags.push(tag);\n\t\t\t\t\t\tgroupModeItem.setEpicAndTags(groupModeItem.getEpic(), currentTags);\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst currentTags = item.getTags();\n\t\t\t\tthis.requestSender.attachTagToTask({\n\t\t\t\t\ttaskId: item.getSourceId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tcurrentTags.push(tag);\n\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.tagSearcher.unsubscribeAll('deAttachTagToTask');\n\t\tthis.tagSearcher.subscribe('deAttachTagToTask', (innerBaseEvent) => {\n\t\t\tconst tag = innerBaseEvent.getData();\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tconst tasks = [];\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\ttasks.push({\n\t\t\t\t\t\ttaskId: groupModeItem.getSourceId(),\n\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.requestSender.batchDeattachTagToTask({\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tconst currentTags = groupModeItem.getTags();\n\t\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(tag), 1);\n\t\t\t\t\t\tgroupModeItem.setEpicAndTags(groupModeItem.getEpic(), currentTags);\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst currentTags = item.getTags();\n\t\t\t\tthis.requestSender.deAttachTagToTask({\n\t\t\t\t\ttaskId: item.getSourceId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(tag), 1);\n\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.tagSearcher.unsubscribeAll('hideTagDialog');\n\t\tthis.tagSearcher.subscribe('hideTagDialog', (innerBaseEvent) => {\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tentity.deactivateGroupMode();\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowEpicSearcher(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst data = baseEvent.getData();\n\t\tconst item = data.item;\n\t\tconst actionsPanelButton = data.button;\n\t\tthis.tagSearcher.showEpicDialog(item, actionsPanelButton);\n\t\tthis.tagSearcher.unsubscribeAll('updateItemEpic');\n\t\tthis.tagSearcher.subscribe('updateItemEpic', (innerBaseEvent) => {\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tconst items = [];\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t});\n\t\t\t\t\tthis.pullItem.addIdToSkipUpdating(groupModeItem.getItemId());\n\t\t\t\t});\n\t\t\t\tthis.requestSender.batchUpdateItemEpic({\n\t\t\t\t\titems: items,\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\tepicId: innerBaseEvent.getData()\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tif (Type.isArray(response.data.epic))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgroupModeItem.setParentId(0);\n\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(null, null);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgroupModeItem.setParentId(response.data.epic.id);\n\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(response.data.epic, groupModeItem.getTags());\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.pullItem.addIdToSkipUpdating(item.getItemId());\n\t\t\t\tthis.requestSender.updateItemEpic({\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\tepicId: innerBaseEvent.getData()\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tif (Type.isArray(response.data.epic))\n\t\t\t\t\t{\n\t\t\t\t\t\titem.setParentId(0);\n\t\t\t\t\t\titem.setEpicAndTags(null, null);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titem.setParentId(response.data.epic.id);\n\t\t\t\t\t\titem.setEpicAndTags(response.data.epic, item.getTags());\n\t\t\t\t\t}\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonStartDecomposition(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst parentItem = baseEvent.getData();\n\n\t\tconst decomposition = new Decomposition({\n\t\t\tentity: entity,\n\t\t\titemStyleDesigner: this.itemStyleDesigner,\n\t\t\tsubTasksCreator: this.subTasksCreator\n\t\t});\n\t\tdecomposition.subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tdecomposition.subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tdecomposition.subscribe('createItem', (innerBaseEvent) => {\n\t\t\tconst inputValue = innerBaseEvent.getData();\n\t\t\tconst decomposedItems = decomposition.getDecomposedItems();\n\t\t\tconst lastDecomposedItem = Array.from(decomposedItems).pop();\n\n\t\t\tconst newItem = this.createItem(parentItem.getItemType(), inputValue);\n\n\t\t\tthis.pullItem.addTmpIdsToSkipAdding(newItem.getItemId());\n\t\t\tthis.pullItem.addIdToSkipUpdating(parentItem.getItemId());\n\n\t\t\tnewItem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\t\tnewItem.setParentId(parentItem.getParentId());\n\t\t\tnewItem.setParentTaskId(parentItem.getSourceId());\n\t\t\tnewItem.setEpic(parentItem.getEpic());\n\t\t\tnewItem.setTags(parentItem.getTags());\n\t\t\tnewItem.setResponsible(decomposition.getResponsible());\n\t\t\tif (decomposition.isBacklogDecomposition())\n\t\t\t{\n\t\t\t\tparentItem.setLinkedTask('Y');\n\n\t\t\t\tnewItem.setSort(lastDecomposedItem.getSort() + 1);\n\t\t\t\tnewItem.setInfo({\n\t\t\t\t\tborderColor: decomposition.getBorderColor()\n\t\t\t\t});\n\t\t\t\tnewItem.setLinkedTask('Y');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnewItem.setSort(decomposition.getSubTasks(parentItem).length + 1);\n\t\t\t\tnewItem.setSubTask('Y');\n\t\t\t\tnewItem.setParentTaskId(parentItem.getSourceId());\n\t\t\t\tnewItem.setParentTask('N');\n\n\t\t\t\tif (decomposition.isFirstDecomposition())\n\t\t\t\t{\n\t\t\t\t\tnewItem.setStoryPoints(parentItem.getStoryPoints().getPoints());\n\t\t\t\t}\n\n\t\t\t\tparentItem.setParentTask('Y');\n\t\t\t\tparentItem.setSubTasksCount(parentItem.getSubTasksCount() + 1);\n\t\t\t\tparentItem.updateParentTaskNodes();\n\t\t\t}\n\n\t\t\tthis.domBuilder.appendItemAfterItem(\n\t\t\t\tnewItem.render(),\n\t\t\t\tdecomposition.getLastDecomposedItemNode(parentItem)\n\t\t\t);\n\t\t\tnewItem.onAfterAppend(entity.getListItemsNode());\n\n\t\t\tdecomposition.addDecomposedItem(newItem);\n\n\t\t\tthis.sendRequestToCreateTask(entity, newItem).then((response) => {\n\t\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t\t});\n\t\t\t\tentity.setItem(newItem);\n\t\t\t\tif (!decomposition.isBacklogDecomposition())\n\t\t\t\t{\n\t\t\t\t\tif (lastDecomposedItem.getItemId() === parentItem.getItemId())\n\t\t\t\t\t{\n\t\t\t\t\t\tparentItem.updateSubTasksPoints(newItem.getSourceId(), newItem.getStoryPoints());\n\t\t\t\t\t\tparentItem.setStoryPoints('');\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.subTasksCreator.addSubTask(parentItem, newItem);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tdecomposition.subscribe('updateParentItem', this.onUpdateItem.bind(this));\n\n\t\tdecomposition.decomposeItem(parentItem);\n\t}\n\n\tonTagsSearchOpen(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst inputObject = data.inputObject;\n\t\tconst enteredHashTagName = data.enteredHashTagName;\n\t\tthis.tagSearcher.showTagsSearchDialog(inputObject, enteredHashTagName);\n\t}\n\n\tonTagsSearchClose()\n\t{\n\t\tthis.tagSearcher.closeTagsSearchDialog();\n\t}\n\n\tonFilterByTag(baseEvent: BaseEvent)\n\t{\n\t\tconst tag = baseEvent.getData();\n\t\tconst currentValue = this.filter.getValueFromField({name: 'TAG', value: ''});\n\t\tif (String(tag) === String(currentValue))\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'TAG', value: ''});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'TAG', value: String(tag)});\n\t\t}\n\t\tthis.filter.scrollToSearchContainer();\n\t}\n\n\tonEpicSearchOpen(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst inputObject = data.inputObject;\n\t\tconst enteredHashEpicName = data.enteredHashEpicName;\n\t\tthis.tagSearcher.showEpicSearchDialog(inputObject, enteredHashEpicName);\n\t}\n\n\tonEpicSearchClose()\n\t{\n\t\tthis.tagSearcher.closeEpicSearchDialog();\n\t}\n\n\tonFilterByEpic(baseEvent: BaseEvent)\n\t{\n\t\tconst epicId = baseEvent.getData();\n\t\tconst currentValue = this.filter.getValueFromField({name: 'EPIC', value: ''});\n\t\tif (String(epicId) === String(currentValue))\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'EPIC', value: ''});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'EPIC', value: String(epicId)});\n\t\t}\n\t\tthis.filter.scrollToSearchContainer();\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tif (entity.getId() !== this.entityStorage.getBacklog().getId())\n\t\t{\n\t\t\tthis.entityStorage.getBacklog().deactivateGroupMode();\n\t\t}\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (entity.getId() !== sprint.getId())\n\t\t\t{\n\t\t\t\tsprint.deactivateGroupMode();\n\t\t\t}\n\t\t});\n\t\tentity.getItems().forEach((item: Item) => {\n\t\t\titem.activateGroupMode();\n\t\t});\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tentity.getItems().forEach((item: Item) => {\n\t\t\titem.deactivateGroupMode();\n\t\t});\n\t}\n\n\tonLoadBacklogItems(baseEvent: BaseEvent)\n\t{\n\t\tconst backlog = baseEvent.getTarget();\n\n\t\tbacklog.setActiveLoadBacklogItems(true);\n\n\t\tconst loader = backlog.showItemsLoader();\n\n\t\tconst requestData = {\n\t\t\tentityId: backlog.getId(),\n\t\t\tpageNumber: backlog.getPageNumberItems() + 1\n\t\t};\n\n\t\tthis.requestSender.getItems(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tconst items = response.data;\n\t\t\t\tif (Type.isArray(items) && items.length)\n\t\t\t\t{\n\t\t\t\t\tbacklog.incrementPageNumberItems();\n\t\t\t\t\tbacklog.setActiveLoadBacklogItems(false);\n\n\t\t\t\t\tthis.createItemsInEntity(backlog, items);\n\t\t\t\t}\n\t\t\t\tloader.hide();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\tbacklog.setActiveLoadBacklogItems(false);\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tcreateItemsInEntity(entity: Entity, items: Array)\n\t{\n\t\titems.forEach((itemData: ItemParams) => {\n\t\t\tconst item = new Item(itemData);\n\t\t\tif (!this.entityStorage.findItemByItemId(item.getItemId()))\n\t\t\t{\n\t\t\t\tthis.domBuilder.append(item.render(), entity.getListItemsNode());\n\t\t\t\titem.onAfterAppend(entity.getListItemsNode());\n\t\t\t\tentity.setItem(item);\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowTeamSpeedChart(baseEvent: BaseEvent)\n\t{\n\t\tconst projectSidePanel = new ProjectSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\t\tprojectSidePanel.showTeamSpeedChart();\n\t}\n\n\tonOpenAddEpicForm(baseEvent: BaseEvent)\n\t{\n\t\tthis.epic.openAddForm();\n\t}\n\n\tonOpenListEpicGrid(baseEvent: BaseEvent)\n\t{\n\t\tthis.epic.openEpicsList();\n\t\tthis.epic.subscribe('onAfterEditEpic', (innerBaseEvent) => {\n\t\t\tconst response = innerBaseEvent.getData();\n\t\t\tconst updatedEpicInfo = response.data;\n\t\t\tthis.epic.onAfterUpdateEpic(updatedEpicInfo);\n\t\t});\n\t}\n\n\tonOpenDefinitionOfDone(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst projectSidePanel = new ProjectSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\t\tprojectSidePanel.showDefinitionOfDone(entity);\n\t}\n\n\tcreateItem(itemType: string, value: string): Item\n\t{\n\t\tconst valueWithoutTags = value\n\t\t\t.replace(new RegExp(TagSearcher.tagRegExp,'g'), '')\n\t\t\t.replace(new RegExp(TagSearcher.epicRegExp,'g'), '');\n\n\t\treturn new Item({\n\t\t\t'itemId': '',\n\t\t\t'itemType': itemType,\n\t\t\t'name': valueWithoutTags\n\t\t});\n\t}\n\n\tsendRequestToCreateTask(entity: Entity, item: Item): Promise\n\t{\n\t\tconst requestData = {\n\t\t\t'tmpId': item.getItemId(),\n\t\t\t'itemType': item.getItemType(),\n\t\t\t'name': item.getName(),\n\t\t\t'entityId': item.getEntityId(),\n\t\t\t'entityType': entity.getEntityType(),\n\t\t\t'parentId': item.getParentId(),\n\t\t\t'sort': item.getSort(),\n\t\t\t'storyPoints': item.getStoryPoints().getPoints(),\n\t\t\t'tags': item.getTags(),\n\t\t\t'epic': item.getEpic(),\n\t\t\t'parentTaskId': item.getParentTaskId(),\n\t\t\t'responsible': item.getResponsible(),\n\t\t\t'info': item.getInfo(),\n\t\t\t'sortInfo': this.itemMover.calculateSort(entity.getListItemsNode()),\n\t\t\t'isActiveSprint': ((entity.getEntityType() === 'sprint' && entity.isActive()) ? 'Y' : 'N')\n\t\t};\n\t\treturn this.requestSender.createTask(requestData);\n\t}\n\n\tfillItemBeforeCreation(entity: Entity, item: Item, value: string)\n\t{\n\t\titem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\titem.setSort(1);\n\t\titem.setResponsible(this.defaultResponsible);\n\n\t\tconst tags = TagSearcher.getHashTagNamesFromText(value);\n\t\tconst epicName = TagSearcher.getHashEpicNamesFromText(value).pop();\n\n\t\tlet inputEpic = null;\n\t\tif (epicName)\n\t\t{\n\t\t\tinputEpic = this.tagSearcher.getEpicByName(epicName.trim());\n\t\t}\n\n\t\tif (inputEpic || tags.length > 0)\n\t\t{\n\t\t\titem.setEpicAndTags(inputEpic, tags);\n\t\t}\n\t}\n\n\tfillItemAfterCreation(item: Item, responseData: Object): Item\n\t{\n\t\t//todo test\n\n\t\titem.setItemId(responseData.itemId);\n\t\tif (!Type.isArray(responseData.epic) || responseData.tags.length > 0)\n\t\t{\n\t\t\titem.setEpicAndTags(responseData.epic, responseData.tags);\n\t\t}\n\t\titem.setResponsible(responseData.responsible);\n\t\titem.setSourceId(responseData.sourceId);\n\t\titem.setAllowedActions(responseData.allowedActions);\n\t}\n\n\topenEpicEditForm(epicId)\n\t{\n\t\tthis.epic.openEditForm(epicId);\n\t}\n\n\topenEpicViewForm(epicId)\n\t{\n\t\tthis.epic.openViewForm(epicId);\n\t}\n\n\tremoveEpic(epicId)\n\t{\n\t\tthis.requestSender.removeItem({\n\t\t\titemId: epicId,\n\t\t\titemType: 'epic'\n\t\t}).then((response) => {\n\t\t\tconst epicInfo = response.data;\n\t\t\tthis.epic.onAfterRemoveEpic(epicInfo);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Menu} from 'main.popup';\n\nexport class ActiveSprintActionButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ActiveSprintButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-button-container\">\n\t\t\t\t<div class=\"ui-btn-split ui-btn-primary ui-btn-xs\"> \n\t\t\t\t\t<button class=\"ui-btn-main\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ACTIONS_COMPLETE_SPRINT')}\n\t\t\t\t\t</button> \n\t\t\t\t\t<button class=\"ui-btn-menu\"></button> \n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst completeSprintButtonNode = node.querySelector('.ui-btn-main');\n\t\tconst menuButtonNode = node.querySelector('.ui-btn-menu');\n\n\t\tEvent.bind(completeSprintButtonNode, 'click', this.onCompleteSprintClick.bind(this));\n\t\tEvent.bind(menuButtonNode, 'click', this.onMenuClick.bind(this, completeSprintButtonNode));\n\n\t\treturn node;\n\t}\n\n\tonCompleteSprintClick()\n\t{\n\t\tthis.emit('completeSprint');\n\t}\n\n\tonMenuClick(bindElement: HTMLElement)\n\t{\n\t\tconst menu = new Menu({\n\t\t\tid: `active-sprint-actions-menu-${Text.getRandom()}`,\n\t\t\tbindElement: bindElement\n\t\t});\n\n\t\tmenu.addMenuItem({\n\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ACTIVE_SPRINT_BUTTON'),\n\t\t\tonclick: (event, menuItem) => {\n\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\tthis.emit('showBurnDownChart');\n\t\t\t}\n\t\t});\n\n\t\tmenu.show();\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../../service/side.panel';\n\nimport '../../css/robot.button.css';\n\ntype Params = {\n\tsidePanel: SidePanel,\n\tgroupId: number,\n\tisTaskLimitsExceeded: boolean,\n\tcanUseAutomation: boolean\n}\n\nexport class RobotButton extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.isTaskLimitsExceeded = params.isTaskLimitsExceeded;\n\t\tthis.canUseAutomation = params.canUseAutomation;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.RobotButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet className = 'tasks-scrum-robot-btn ui-btn ui-btn-light-border ui-btn-no-caps ui-btn-themes ui-btn-round';\n\t\tif (this.isShowLimitSidePanel())\n\t\t{\n\t\t\tclassName += ' ui-btn-icon-lock';\n\t\t}\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-button-container\">\n\t\t\t\t<button class=\"${className}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ROBOTS_BUTTON')}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonClick()\n\t{\n\t\tif (this.isShowLimitSidePanel())\n\t\t{\n\t\t\t// eslint-disable-next-line\n\t\t\tBX.UI.InfoHelper.show('limit_tasks_robots');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst url = '/bitrix/components/bitrix/tasks.automation/slider.php?site_id='\n\t\t\t\t+ Loc.getMessage('SITE_ID') + '&project_id=' + this.groupId;\n\n\t\t\tthis.sidePanel.openSidePanelByUrl(url);\n\t\t}\n\t}\n\n\tisShowLimitSidePanel(): boolean\n\t{\n\t\treturn (this.isTaskLimitsExceeded && !this.canUseAutomation);\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {View} from './view';\nimport {ActiveSprintActionButton} from './header/active.sprint.action.button';\nimport {RobotButton} from './header/robot.button';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\nimport {StatsHeaderBuilder} from '../entity/sprint/stats.header.builder';\nimport {Item} from '../item/item';\n\nimport type {SprintParams} from '../entity/sprint/sprint';\nimport type {Views} from './view';\n\ntype Params = {\n\tpathToTask: string,\n\tviews: Views,\n\tactiveSprint: SprintParams,\n\tsprints: Array<SprintParams>,\n\ttaskLimitExceeded: 'Y' | 'N',\n\tcanUseAutomation: 'Y' | 'N'\n}\n\nexport class ActiveSprint extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ActiveSprint');\n\n\t\tthis.setParams(params);\n\n\t\tif (this.existActiveSprint())\n\t\t{\n\t\t\tthis.finishStatus = this.getActiveSprintParams().finishStatus;\n\n\t\t\tthis.sprint = new Sprint(this.getActiveSprintParams());\n\n\t\t\tthis.itemsInFinishStage = new Map();\n\n\t\t\tthis.bindHandlers();\n\t\t}\n\n\t\tthis.sidePanel = new SidePanel();\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderSprintStatsTo(container);\n\n\t\tthis.statsHeader = StatsHeaderBuilder.build(this.sprint);\n\t\tthis.statsHeader.setKanbanStyle();\n\n\t\tDom.append(this.statsHeader.render(), container);\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderButtonsTo(container);\n\n\t\tif (!this.existActiveSprint())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst robotButton = new RobotButton({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tgroupId: this.getCurrentGroupId(),\n\t\t\tisTaskLimitsExceeded: this.isTaskLimitsExceeded(),\n\t\t\tcanUseAutomation: this.isCanUseAutomation()\n\t\t});\n\n\t\tconst activeSprintActionButton = new ActiveSprintActionButton();\n\t\tactiveSprintActionButton.subscribe('completeSprint', this.onCompleteSprint.bind(this));\n\t\tactiveSprintActionButton.subscribe('showBurnDownChart', this.onShowSprintBurnDownChart.bind(this));\n\n\t\tDom.append(robotButton.render(), container);\n\t\tDom.append(activeSprintActionButton.render(), container);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.setPathToTask(params.pathToTask);\n\t\tthis.setActiveSprintParams(params.activeSprint);\n\t\tthis.setTaskLimitsExceeded(params.taskLimitExceeded);\n\t\tthis.setCanUseAutomation(params.canUseAutomation);\n\n\t\tthis.sprints = new Map();\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tconst sprint = new Sprint(sprintData);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t});\n\n\t\tthis.views = params.views;\n\t}\n\n\tsetPathToTask(pathToTask: string)\n\t{\n\t\tthis.pathToTask = (Type.isString(pathToTask) ? pathToTask : '');\n\t}\n\n\tgetPathToTask(): string\n\t{\n\t\treturn this.pathToTask;\n\t}\n\n\tsetActiveSprintParams(params: SprintParams)\n\t{\n\t\tthis.activeSprint = (Type.isPlainObject(params) ? params : null);\n\t}\n\n\tgetActiveSprintParams(): SprintParams\n\t{\n\t\treturn this.activeSprint;\n\t}\n\n\tsetTaskLimitsExceeded(limitExceeded: string)\n\t{\n\t\tthis.limitExceeded = (limitExceeded === 'Y');\n\t}\n\n\tisTaskLimitsExceeded(): boolean\n\t{\n\t\treturn this.limitExceeded;\n\t}\n\n\tsetCanUseAutomation(canUseAutomation: string)\n\t{\n\t\tthis.canUseAutomation = (canUseAutomation === 'Y');\n\t}\n\n\tisCanUseAutomation(): boolean\n\t{\n\t\treturn this.canUseAutomation;\n\t}\n\n\texistActiveSprint(): boolean\n\t{\n\t\treturn (this.activeSprint !== null);\n\t}\n\n\tbindHandlers()\n\t{\n\t\t// eslint-disable-next-line\n\t\tconst kanbanManager = BX.Tasks.Scrum.Kanban;\n\t\tif (kanbanManager)\n\t\t{\n\t\t\tthis.bindKanbanHandlers(kanbanManager.getKanban());\n\t\t\tkanbanManager.getKanbansGroupedByParentTasks().forEach((kanban) => {\n\t\t\t\tthis.bindKanbanHandlers(kanban);\n\t\t\t});\n\t\t}\n\t}\n\n\tbindKanbanHandlers(kanban)\n\t{\n\t\tthis.onKanbanRender(kanban);\n\n\t\tEventEmitter.subscribe(kanban, 'Kanban.Grid:onItemMoved', (event: BaseEvent) => {\n\t\t\tconst [kanbanItem, targetColumn, beforeItem] = event.getCompatData();\n\t\t\tthis.onItemMoved(kanbanItem, targetColumn, beforeItem);\n\t\t});\n\t}\n\n\tonCompleteSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.sprints,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showCompleteSidePanel(this.sprint);\n\n\t\tthis.sprint.subscribe('showTask', (innerBaseEvent: BaseEvent) => {\n\t\t\tconst item = innerBaseEvent.getData();\n\t\t\tthis.sidePanel.openSidePanelByUrl(this.getPathToTask().replace('#task_id#', item.getSourceId()));\n\t\t});\n\t}\n\n\t/**\n\t * Handles Kanban render.\n\t * @param {BX.Tasks.Kanban.Grid} kanbanGrid\n\t * @returns {void}\n\t */\n\tonKanbanRender(kanbanGrid)\n\t{\n\t\tconst items = kanbanGrid.getItems();\n\t\tconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\t\tfor (let itemId in kanbanGrid.getItems())\n\t\t{\n\t\t\tif (hasOwnProperty.call(items, itemId))\n\t\t\t{\n\t\t\t\tconst item = items[itemId];\n\t\t\t\tif (item.getColumn().getType() === this.finishStatus)\n\t\t\t\t{\n\t\t\t\t\tthis.itemsInFinishStage.set(itemId, '');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Hook on item moved.\n\t * @param {BX.Tasks.Kanban.Item} kanbanItem\n\t * @param {BX.Tasks.Kanban.Column} targetColumn\n\t * @param {BX.Tasks.Kanban.Item} [beforeItem]\n\t * @returns {void}\n\t */\n\tonItemMoved(kanbanItem, targetColumn, beforeItem)\n\t{\n\t\tif (targetColumn.type === this.finishStatus)\n\t\t{\n\t\t\tif (!this.itemsInFinishStage.has(kanbanItem.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedToFinish(kanbanItem, this.sprint);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.itemsInFinishStage.has(kanbanItem.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedFromFinish(kanbanItem, this.sprint);\n\t\t\t}\n\t\t}\n\n\t\tthis.statsHeader.updateStats(this.sprint);\n\t}\n\n\tupdateStatsAfterMovedToFinish(kanbanItem, sprint: Sprint)\n\t{\n\t\tthis.itemsInFinishStage.set(kanbanItem.getId(), kanbanItem.getStoryPoints());\n\n\t\tsprint.getTotalCompletedStoryPoints().addPoints(kanbanItem.getStoryPoints());\n\t\tsprint.getTotalUncompletedStoryPoints().subtractPoints(kanbanItem.getStoryPoints());\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() + 1);\n\t\tsprint.setUncompletedTasks(sprint.getUncompletedTasks() - 1);\n\n\t\tsprint.getItems().forEach((scrumItem: Item) => {\n\t\t\tif (scrumItem.getSourceId() === parseInt(kanbanItem.getId(), 10))\n\t\t\t{\n\t\t\t\tscrumItem.setCompleted('Y');\n\n\t\t\t\tif (scrumItem.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tconst parentItem = sprint.getItemBySourceId(scrumItem.getParentTaskId());\n\t\t\t\t\tif (parentItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst subTasksItems = sprint.getItemsByParentTaskId(parentItem.getSourceId());\n\t\t\t\t\t\tconst unCompletedItem = [...subTasksItems.values()].find((item: Item) => !item.isCompleted());\n\t\t\t\t\t\tif (!unCompletedItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparentItem.setCompleted('Y');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateStatsAfterMovedFromFinish(kanbanItem, sprint: Sprint)\n\t{\n\t\tthis.itemsInFinishStage.delete(kanbanItem.getId());\n\n\t\tsprint.getTotalCompletedStoryPoints().subtractPoints(kanbanItem.getStoryPoints());\n\t\tsprint.getTotalUncompletedStoryPoints().addPoints(kanbanItem.getStoryPoints());\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() - 1);\n\t\tsprint.setUncompletedTasks(sprint.getUncompletedTasks() + 1);\n\n\t\tsprint.getItems().forEach((scrumItem: Item) => {\n\t\t\tif (scrumItem.getSourceId() === parseInt(kanbanItem.getId(), 10))\n\t\t\t{\n\t\t\t\tscrumItem.setCompleted('N');\n\n\t\t\t\tif (scrumItem.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tconst parentItem = sprint.getItemBySourceId(scrumItem.getParentTaskId());\n\t\t\t\t\tif (parentItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst subTasksItems = sprint.getItemsByParentTaskId(parentItem.getSourceId());\n\t\t\t\t\t\tconst unCompletedItem = [...subTasksItems.values()].find((item: Item) => !item.isCompleted());\n\t\t\t\t\t\tif (unCompletedItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparentItem.setCompleted('N');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowSprintBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(this.sprint);\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class BurnDownButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.BurnDownButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-button-container\">\n\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-xs\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ACTIVE_SPRINT_BUTTON')}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Dom, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\n\nimport {View} from './view';\nimport {BurnDownButton} from './header/burn.down.button';\n\nimport type {Views} from './view';\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\tviews: Views,\n\tcompletedSprint: SprintParams,\n\tsprints: Array<SprintParams>\n}\n\nexport class CompletedSprint extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.CompletedSprint');\n\n\t\tthis.setParams(params);\n\n\t\tthis.bindHandlers();\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderSprintStatsTo(container);\n\n\t\tthis.titleContainer = container;\n\t\tthis.titleContainer.textContent = Text.encode(this.completedSprint.getName());\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderButtonsTo(container);\n\n\t\tconst burnDownButton = new BurnDownButton();\n\t\tburnDownButton.subscribe('click', this.onShowSprintBurnDownChart.bind(this));\n\n\t\tDom.append(burnDownButton.render(), container);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.completedSprint = new Sprint(params.completedSprint);\n\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.sprints = new Map();\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t});\n\t\tthis.views = params.views;\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEventEmitter.subscribe('onTasksGroupSelectorChange', this.onSprintSelectorChange.bind(this));\n\t}\n\n\tonSprintSelectorChange(event: BaseEvent)\n\t{\n\t\tconst [currentSprint] = event.getCompatData()\n\n\t\tthis.completedSprint = this.findSprintBySprintId(currentSprint.sprintId);\n\n\t\tthis.titleContainer.textContent = Text.encode(currentSprint.name);\n\t}\n\n\tonShowSprintBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(this.completedSprint);\n\t}\n\n\tfindSprintBySprintId(sprintId: number): Sprint\n\t{\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === parseInt(sprintId, 10));\n\t}\n}","import {View} from './view/view';\nimport {Plan} from './view/plan';\nimport {ActiveSprint} from './view/active.sprint';\nimport {CompletedSprint} from './view/completed.sprint';\n\ntype Params = {\n\tviewName: string\n}\n\nexport class Entry\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.setParams(params);\n\n\t\tthis.buildView(params);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.setViewName(params.viewName);\n\t}\n\n\tsetViewName(viewName: string)\n\t{\n\t\tconst availableViews = new Set([\n\t\t\t'plan',\n\t\t\t'activeSprint',\n\t\t\t'completedSprint'\n\t\t]);\n\n\t\tif (!availableViews.has(viewName))\n\t\t{\n\t\t\tthrow Error('Invalid value to activeView parameter');\n\t\t}\n\n\t\tthis.viewName = viewName;\n\t}\n\n\tgetViewName(): string\n\t{\n\t\treturn this.viewName;\n\t}\n\n\tsetView(view: View)\n\t{\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.view = view;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.view = null;\n\t\t}\n\t}\n\n\tgetView(): View\n\t{\n\t\treturn this.view;\n\t}\n\n\tbuildView(params: Params)\n\t{\n\t\tconst viewName = this.getViewName();\n\n\t\tif (viewName === 'plan')\n\t\t{\n\t\t\tthis.setView(new Plan(params));\n\t\t}\n\t\telse if (viewName === 'activeSprint')\n\t\t{\n\t\t\tthis.setView(new ActiveSprint(params));\n\t\t}\n\t\telse if (viewName === 'completedSprint')\n\t\t{\n\t\t\tthis.setView(new CompletedSprint(params));\n\t\t}\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderTo(container);\n\t\t}\n\t}\n\n\trenderTabsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderTabsTo(container);\n\t\t}\n\t}\n\n\trenderCountersTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderCountersTo(container);\n\t\t}\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderSprintStatsTo(container);\n\t\t}\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderButtonsTo(container);\n\t\t}\n\t}\n\n\topenEpicEditForm(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.openEpicEditForm(epicId);\n\t\t}\n\t}\n\n\topenEpicViewForm(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.openEpicViewForm(epicId);\n\t\t}\n\t}\n\n\tremoveEpic(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.removeEpic(epicId);\n\t\t}\n\t}\n}"],"names":["RequestSender","options","signedParameters","debugMode","action","data","Promise","resolve","reject","ajax","runAction","then","runComponentAction","mode","sendRequestToComponent","sendRequest","response","alertTitle","Type","isUndefined","errors","console","log","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","Filter","params","setEventNamespace","filterId","requestSender","searchFieldApplied","initUiFilterManager","bindHandlers","filterManager","BX","Main","getById","EventEmitter","subscribe","onApplyFilter","bind","getSearch","getContainer","filterSearchContainer","getSearchContainer","isNodeInViewport","scrollIntoView","event","getCompatData","values","filterInstance","promise","getSearchString","autoResolve","emit","name","item","fieldInstances","getField","fieldOptions","getFieldByName","ITEMS","push","itemsNode","node","querySelector","items","Dom","attr","value","filterApi","getApi","filterFieldsValues","getFilterFieldsValues","setFields","apply","resetFields","forEach","resetFilter","applyFilter","element","rect","getBoundingClientRect","top","left","bottom","window","innerHeight","document","documentElement","clientHeight","right","innerWidth","clientWidth","Counters","filter","counters","isOwnerCurrentUser","userId","groupId","container","isDomNode","Error","isEmptyCounters","append","renderCounters","isNodeCreated","destroy","className","text","Tag","render","newCommentsInfo","commentsNumber","parseInt","counter","renderTitle","getCommentsLabel","renderReadAllButton","commentIcon","commentText","onMouseEnter","addClass","onMouseLeave","removeClass","Event","applyFilterRequiringAttentionToComments","readAllButton","onClickReadAll","readAllTasksComment","clean","catch","showErrorAlert","remove","count","setValuesToField","Tabs","views","planTabActiveClass","active","activeTabActiveClass","completedTabActiveClass","url","Text","encode","View","scrumManager","tabs","renderTo","TeamSpeedButton","onClick","DiskManager","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","attachedIds","controlId","getRandom","popup","Popup","content","getAttachmentsLoaderContent","autoHide","closeByEsc","angle","show","Disk","UF","add","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","close","filesChooser","addCustomEvent","onFileUploadSuccess","fileResult","uf","file","uploaderFile","element_id","toString","ActionsPanel","actionPanelNodeId","bindElement","itemList","task","activity","attachment","move","sprint","backlog","tags","epic","decomposition","listBlockBlurNodes","Set","getElementById","actionsPanelContainer","calculatePanelPosition","createActionPanel","setBlockBlurNode","body","customBlur","hasNode","blockBlurNode","contains","target","unbind","bindItems","actionsPanel","hasClass","lastElementChild","Boolean","showTaskActionButtonNodeId","showAttachmentActionButtonNodeId","showMoveActionButtonNodeId","sprintActionButtonNodeId","backlogActionButtonNodeId","tagsActionButtonNodeId","epicActionButtonNodeId","decompositionActionButtonNodeId","removeActionButtonNodeId","callback","panel","position","getPosition","fakePanel","cloneNode","style","visibility","isPanelWiderThanViewport","fakePanelRect","windowWidth","zIndex","TaskCounts","setItemId","itemId","setAttachedFilesCount","attachedFilesCount","setCheckListComplete","checkListComplete","setCheckListAll","checkListAll","setNewCommentsCount","newCommentsCount","isInteger","isString","indicatorsNodeId","indicatorsNode","attachmentNode","checklistNode","commentsNode","updateVisibility","firstElementChild","textContent","innerCommentCounter","showNode","hideNode","StoryPoints","clearPoints","differencePoints","storyPoints","saveDifferencePoints","String","isNaN","parseFloat","currentStoryPoints","inputStoryPoints","result","isFloat","toFixed","firstPoints","secondPoints","Item","setItemParams","groupMode","previewMode","setItemNode","setTmpId","tmpId","setName","setItemType","itemType","setSort","sort","setEntityId","entityId","setEntityType","entityType","setParentId","parentId","setSourceId","sourceId","setInfo","info","setParentTask","isParentTask","setSubTasksCount","subTasksCount","setLinkedTask","isLinkedTask","setParentTaskId","parentTaskId","setSubTask","isSubTask","setSubTasksInfo","subTasksInfo","setResponsible","responsible","setCompleted","completed","setDisableStatus","isCompleted","setAllowedActions","allowedActions","setEpic","setTags","setTaskCounts","setStoryPoints","getItemNode","dataset","nameNode","type","setPreviousSort","previousSort","has","isPlainObject","updateResponsible","setPoints","updateStoryPointsNode","Object","getSubTasksInfo","map","subTaskInfo","addPoints","getPoints","storyPointsNode","getStoryPoints","sendEventToUpdateStoryPoints","newSubTasksInfo","isArray","hasOwnProperty","updateCompletedStatus","parentTask","linkedTask","id","subTask","taskCounts","color","borderColor","setBorderColor","getBorderColor","nameTextNode","disableStatus","moveActivity","status","groupModeContainer","groupModeCheckbox","checked","toggleClass","classList","showActionsPanel","deactivateDragNDrop","unbindAll","activateDragNDrop","previewItem","Runtime","clone","itemNode","activatePreviewMode","decompositionMode","HTMLElement","e","tmpItem","getName","getEntityId","getResponsible","getTaskCounts","updateIndicators","getAttachedFilesCount","getCheckListComplete","getCheckListAll","getNewCommentsCount","getParentId","setEpicAndTags","getEpic","getTags","getInfo","getSubTasksCount","getParentTaskId","updateParentTaskNodes","itemClassName","renderName","renderIndicators","renderSubTasksCounter","renderResponsible","renderStoryPoints","renderSubTasksTick","renderTags","subTasksCounter","isPreviewMode","getEntityType","subTasksTick","isDecompositionMode","toggle","getEpicTag","getListTagNodes","getContrastYIQ","hexcolor","Label","Color","DEFAULT","replace","r","substr","g","b","yiq","epicLabel","size","Size","MD","customClass","innerLabel","contrast","isGroupMode","clickToGroupModeCheckbox","tag","tagLabel","TAG_LIGHT","fill","SM","onAfterAppend","onItemClick","onNameClick","responsibleNode","onResponsibleClick","onStoryPointsClick","subTasksCounterNode","paramsNode","insertBefore","subTasksTickNode","newSubTasksTickNode","isClickOnEditableName","ignoreTagList","tagName","closest","click","isDisabled","currentTarget","dialog","Dialog","targetNode","enableSearch","context","events","hide","selectedItem","getData","getId","getTitle","photo","src","getAvatar","entities","inviteEmployeeLink","borderNode","valueNode","trim","oldValue","contentEditable","placeCursorAtEnd","blockEnterInput","bindOnce","newValue","getItemId","getItemType","isComposing","keyCode","blur","isShown","stopPropagation","isEditAllowed","diskManager","ufDiskFilesFieldName","subscribeOnce","baseEvent","showAttachmentMenu","isMovable","isRemoveAllowed","confirm","messageBox","showPanel","updateTagsContainer","newContainer","tagsContainerNode","focus","selection","getSelection","range","createRange","selectNodeContents","collapse","removeAllRanges","addRange","GroupActionsButton","ListItems","entity","getInput","getItems","TagSearcher","allTags","Map","set","avatar","epicName","description","get","delete","tagsList","epicList","getCurrentActionsPanel","currentTags","selectedItems","currentTag","createTag","tagDialog","getTagSelector","getTextBoxValue","focusSearch","addTagToSearcher","newTag","getTagFromSearcher","addItem","select","clearTextBox","selectFirstTab","label","choiceWasMade","width","height","multiple","dropdownMode","getTagsList","deselectedItem","tagSelectorOptions","onInput","selector","getDialog","footer","currentEpic","currentEpicInfo","getEpicList","epicId","setTimeout","getSelectedItems","placeholder","inputObject","enteredHashTagName","input","getInputNode","tagsDialog","getNodeId","getNode","offsetWidth","selectedHashTag","hashTags","getHashTagNamesFromText","enteredHashTag","pop","RegExp","deselect","setTagsSearchMode","search","enteredHashEpicName","epicDialog","selectedHashEpic","epicRegExp","setEpicId","setEpicSearchMode","inputText","regex","tagRegExp","matches","match","exec","substring","Input","nodeId","disabled","setNode","onTagSearch","onEpicSearch","onKeydown","inputNode","enteredHashTags","isTagsSearchMode","enteredHashEpics","getHashEpicNamesFromText","isEpicSearchMode","onCreateTaskItem","Entity","setEntityParams","groupModeItems","groupActionsButton","listItems","setId","setViews","setNumberTasks","numberTasks","exactSearchApplied","isExactSearchApplied","onActivateGroupMode","onDeactivateGroupMode","listItemsNode","getListItemsNode","querySelectorAll","newItem","subscribeToItem","setItemMoveActivity","addNumberTasks","setMoveActivity","unsubscribeAll","subtractNumberTasks","getTarget","updateStoryPoints","parentItem","getItemBySourceId","updateSubTasksPoints","getSourceId","button","getGroupModeItems","groupModeItem","removeItem","removeYourself","addItemToGroupMode","removeItemFromGroupMode","find","hasInput","nextElementSibling","isEqualNode","deactivateGroupMode","disable","unDisable","clear","Header","getNumberTasks","getElementByClassName","parentNode","elements","elem","EpicCreationButton","Backlog","setBacklogParams","header","epicCreationButton","itemData","pageNumberItems","backlogItemsLoaderNode","bindBacklogItemsLoader","updateNumberTasks","loader","setActiveLoadBacklogItems","observer","IntersectionObserver","entries","isIntersecting","isActiveLoadBacklogItems","threshold","observe","activeLoadBacklogItems","listPosition","Loader","offset","backlogData","addHeader","addEpicCreationButton","addGroupActionsButton","addListItems","SprintDate","defaultSprintDuration","getDefaultSprintDuration","isActive","renderNode","getFormattedDateStart","getFormattedDateEnd","dateStart","dateEnd","timestamp","dateStartNode","date","format","dateEndNode","parentPopup","calendar","showCalendar","field","bTime","bSetFocus","bHideTime","updateDateNode","Math","floor","parseDate","getTime","dateStartInput","dateEndInput","sprintId","weekCount","getDateStart","getDateEnd","StatsCalculator","first","second","round","StatsHeader","setSprintData","statsCalculator","weekendDaysTime","getWeekendDaysTime","headerNode","headerClass","kanbanMode","setSprintDate","getTotalStoryPoints","setCompletedStoryPoints","getTotalCompletedStoryPoints","setUncompletedStoryPoints","getTotalUncompletedStoryPoints","setEndDate","sprintDate","completedStoryPoints","uncompletedStoryPoints","endDate","Date","now","CompletedStatsHeader","percentage","calculatePercentage","getCompletedStoryPoints","completedDate","getCompletedDate","getEndDate","getSprintDate","getFormattedTitleDatePeriod","ExpiredStatsHeader","expiredDay","getExpiredDay","ActiveStatsHeader","remainingDays","getRemainingDays","dateWithWeekendOffset","setSeconds","getSeconds","setHours","msPerMinute","msPerHour","msPerDay","daysRemaining","StatsHeaderBuilder","isExpired","SprintHeader","statsHeader","buttonClass","buttonText","buttonNode","hideContent","isPlanned","addHeaderStats","build","addHeaderDate","firstChild","replaceWith","renderParams","renderDragnDrop","renderRemove","tickAngleClass","renderStatsHeader","createDate","createButton","updateStats","updateDateStartNode","updateDateEndNode","buttonNodeId","onButtonClick","editButtonNode","removeNode","tickButtonNode","sprintHeader","EventsHeader","StoryPointsHeader","totalStoryPointsNode","inWorkStoryPointsNode","doneStoryPointsNode","renderBurnDownChartIcon","Sprint","setSprintParams","eventsHeader","storyPointsHeader","setDateStart","setDateEnd","setWeekendDaysTime","setDefaultSprintDuration","setStatus","setTotalStoryPoints","totalStoryPoints","setTotalCompletedStoryPoints","totalCompletedStoryPoints","setTotalUncompletedStoryPoints","totalUncompletedStoryPoints","setCompletedTasks","completedTasks","setUncompletedTasks","uncompletedTasks","setItems","initStyle","onChangeName","onRemoveSprint","onChangeSprintDeadline","toggleVisibilityContent","getStatus","sprintEnd","updateNameNode","itemParams","sprintGoal","epics","availableStatus","tmpSprint","addStoryPointsHeader","renderLinkToCompletedSprint","getViews","completedSprint","getCompletedSubTasksStoryPoints","getUncompletedSubTasksStoryPoints","updateActiveSprintStoryPointsHeader","updateStatsHeader","itemStoryPoints","subtractPoints","getCompletedTasks","getUncompletedTasks","createInput","setSelectionRange","requestData","getContentNode","display","showContent","isEmpty","showSprint","hideSprint","sprintData","addSprintHeader","buildHeader","addEventsHeader","SidePanel","sidePanelManager","Instance","contentSidePanelManager","Manager","contentSidePanels","bindEvents","sliderEvent","sidePanel","getSlider","setCacheable","getUrl","resetBodyWidthHack","addEscapePressHandler","currentSidePanel","manager","getPreviousSlider","contentSidePanel","getTopSlider","reload","previousSidePanel","open","applyBodyWidthHack","removeEscapePressHandler","frameWindow","getFrameWindow","addEventListener","handleFrameKeyDown","removeEventListener","existFrameTopSlider","BurnDownChart","chartDiv","am4core","useTheme","am4themes_animated","chart","create","am4charts","XYChart","paddingRight","createAxises","createIdealLine","createRemainLine","createLegend","categoryAxis","xAxes","CategoryAxis","renderer","grid","template","location","dataFields","category","minGridDistance","valueAxis","yAxes","ValueAxis","min","lineSeries","series","LineSeries","stroke","strokeWidth","categoryX","valueY","circleColor","circleBullet","CircleBullet","circle","radius","bullets","segment","segments","hoverState","states","properties","legend","Legend","itemContainers","clickable","on","processOver","dataItem","dataContext","processOut","hoveredLine","toFront","each","setState","bulletsContainer","dispose","SprintSidePanel","sprints","currentSprint","uncompletedItems","lastCompletedSprint","getLastCompletedSprint","sidePanelId","onLoadStartPanel","openSidePanel","contentCallback","buildStartPanel","onLoadCompletePanel","buildCompletePanel","onLoadSprintBurnDownPanel","onCloseBurnDownChart","buildBurnDownPanel","differenceStoryPoints","getDifferenceStoryPointsBetweenSprints","getEpics","form","onLoadStartButtons","buttonsContainer","onStartSprint","buildSprintGoal","buildSprintActions","buildSprintPlan","sprintInfo","listSprintsOptions","getUncompletedItems","getPreviewVersion","differencePercentage","getDifferencePercentageBetweenSprints","percentageNodeClass","absoluteValue","abs","speedInfoMessage","renderSpeed","itemsContainer","onLoadCompleteButtons","onCompleteSprint","showLoader","getBurnDownChartData","closeLoader","burnDownChart","createChart","destroyBurnDownChart","firstSprint","secondSprint","difference","firstPercentage","secondPercentage","getSprintStartButtons","html","getSprintCompleteButtons","getRequestDataToGetBurnDownChartData","getStartButtons","buttonsHtml","getCompleteButtons","startSprint","getRequestDataToStartSprint","href","removeClockIconFromButton","completeSprint","getRequestDataToCompleteSprint","Confetti","fire","particleCount","spread","origin","x","y","getZindex","directionSelectNode","direction","EntityStorage","entityFrom","recalculateItemsSort","backlogItems","ItemStyleDesigner","entityStorage","listAllUsedColors","updateBorderColorForLinkedItems","itemIdsToUpdateColor","getAllItems","getAllUsedColors","getRandomColor","getAllColors","updateBorderColorToLinkedItems","fromEntries","updatedItems","keys","findItemByItemId","colorPicker","getColorPicker","allColors","getDefaultColors","defaultColors","randomColor","random","isThisBorderColorAlreadyUse","isAlreadyUse","usedColor","entityIds","getAllEntities","getAllUsedItemBorderColors","ColorPicker","DomBuilder","pageNumberToCompletedSprints","scrumContainer","getBacklog","renderSprintsContainer","getSprints","sprintCreatingButtonNode","sprintCreatingButtonNodeId","sprintCreatingDropZoneNode","sprintCreatingDropZoneNodeId","sprintListNode","sprintListNodeId","createSprint","setDraggable","draggableItems","Draggable","draggable","dragElement","DROP_PREVIEW","delay","dragEndEvent","draggableSprints","createCreatingButton","createCreatingDropZone","createSprintsList","sprintsNode","completedSprintLoader","bindLoadCompletedSprints","isActiveLoadCompletedSprints","onLoadCompletedSprints","pageNumber","getCompletedSprints","createSprints","buildSprint","findEntityByEntityId","addSprint","countSprints","children","addContainer","current","newItemNode","bindItemNode","parentElement","SubTasksManager","domBuilder","listSubTasks","visibilityList","hideSubTaskItems","showSubTaskItems","toggleSubTasksTick","getSubTaskItems","taskId","listItemParams","listSubTaskItems","subTaskItem","buildSubTaskItem","parentItemNode","setItem","appendItemAfterItem","setVisibility","cleanVisibility","Decomposition","itemStyleDesigner","subTasksCreator","setPlaceholder","addDecomposedItem","isBacklogDecomposition","onDecomposeItem","toggleSubTasks","lastSubTask","getSubTasks","targetItemNode","insertAfter","onCreateItem","isFirstDecomposition","cleanSubTasks","deactivateDecompositionMode","Array","from","decomposedItems","getDecomposedItems","lastDecomposedItem","subTasks","activateDecompositionMode","saveSelectedResponsible","getRandomColorForItemBorder","getParentItem","iterator","next","FilterHandler","fadeOutAll","filterInfo","updateExactSearchStatusToEntities","fulfill","filteredItemsData","buildItem","updateVisibilityToEntities","fadeInAll","setExactSearchApplied","isSearchFieldApplied","fadeOut","fadeIn","Epic","tagSearcher","defaultColor","selectedColor","onLoadAddForm","buildAddForm","onLoadEditForm","buildEditForm","onLoadViewForm","buildViewForm","onBeforeGridRequest","onLoadListGrid","destroyGrid","onLoadEditor","onLoadColorPicker","onLoadAddButtons","createEpic","getRequestData","onAfterCreateEpic","isPreviousSidePanelExist","reloadPreviousSidePanel","openEpicsList","onLoadDescription","onLoadFiles","onLoadViewButtons","openEditForm","onLoadEditButtons","editEpic","reloadGrid","gridManager","gridId","instance","getDescriptionEditor","editorHtml","descriptionContainer","editor","LHEPostForm","getHandler","BXHtmlEditor","Get","eventNode","getEpicDescription","filesContainer","getEpicFiles","colorBlockNode","colorNode","picker","getAddEpicFormButtons","getViewEpicFormButtons","list","getEpicsList","responseData","prepareTagsList","openAddForm","getEmptyEpicListForm","eventArgs","sessid","bitrix_sessid","method","getEpicListUrl","getSignedParameters","buildFormHeader","buildFormContainerHeader","editorId","getEpicDescriptionEditor","getViewEpicFormButtonsAction","onColorSelected","backgroundColor","popupOptions","colors","oEditor","GetContent","files","getAttachmentsFiles","arFiles","controllers","fileControllers","controller","includes","fileController","fileId","tagsContainers","tagsContainer","getTagsFromNode","getTagNode","childNodes","childNode","closeTopSidePanel","addEpicToSearcher","addItemToListTypeField","NAME","VALUE","itemEpic","oldEpicInfo","getCurrentEpic","removeEpicFromSearcher","reloadTopSidePanel","TeamSpeedChart","scrollbarX","Scrollbar","parent","bottomAxesContainer","createColumn","xAxis","labels","wrap","maxWidth","yAxis","ColumnSeries","paddingBottom","ProjectSidePanel","onLoadTeamSpeedChartPanel","onCloseTeamSpeedChart","buildTeamSpeedPanel","onLoadDodPanel","buildDodPanel","getTeamSpeedChartData","teamSpeedChart","destroyChart","getDodComponent","dodContainer","getDodPanelData","prepareDodOptionsContainer","getDodButtons","saveDod","getRequestDataForSaveList","getEntityChecklistItems","required","getDodItemsRequired","Tasks","CheckListInstance","treeStructure","getTreeStructure","optionsContainer","option","PullSprint","listIdsToSkipAdding","listIdsToSkipUpdating","listIdsToSkipRemoving","sprintAdded","onSprintAdded","sprintUpdated","onSprintUpdated","sprintRemoved","onSprintRemoved","needSkipAdd","cleanSkipAdd","createSprintNode","needSkipUpdate","cleanSkipUpdate","moveSprintToActiveListNode","moveSprintToCompletedListNode","updateYourself","needSkipRemove","cleanSkipRemove","removeSprint","getTmpId","ItemMover","source","sourceContainer","sourceEntityId","sourceEntity","hideSubTasks","endContainer","endEntityId","onItemMove","onMoveConfirm","itemNodeAfterSourceItem","getSort","findEntityByItemId","listToMove","isFirstItem","onclick","menuItem","sortedItems","sortedItemsIds","moveItemToUp","updateItemSort","sortInfo","calculateSort","getMenuWindow","isLastItem","moveItemToDown","showMoveItemMenu","entityWithInput","updateSort","updateItemsSort","updateItem","getSprintCreatingDropZoneNode","createNewSprintAndMoveItem","moveTo","moveInCurrentContainer","moveInAnotherContainer","endEntity","moveItemFromEntityToEntity","fromActiveSprint","toActiveSprint","updatedItemsIds","moveToAnotherEntity","listSortInfo","isSortUpdated","updatedItemId","targetEntity","bindButton","isMoveToSprint","isNull","getSprintsAvailableForFilling","showListSprintsToMove","moveToWithGroupMode","entityTo","after","update","batchUpdateItem","entityListNode","onMoveItemUpdate","bindItemSort","isMoveFromAnotherEntity","getPreviousSort","subtractTotalStoryPoints","addTotalStoryPoints","setParentEntity","moveToSprintMenu","getPopupWindow","setBindElement","Menu","isSameSprint","addMenuItem","moveItemMenu","PullItem","itemMover","currentUserId","listToAddAfterUpdate","listIdsToSkipSorting","onCalculateSort","itemAdded","onItemAdded","itemUpdated","onItemUpdated","itemRemoved","onItemRemoved","itemSortUpdated","onItemSortUpdated","comment_add","onCommentAdd","setDelayedAdd","externalAdd","finally","cleanDelayedAdd","addItemToEntity","isDelayedAdd","itemsSortInfo","itemsToSort","itemsInfoToSort","needSkipSort","itemInfoToSort","targetEntityId","moveToPosition","participants","xmlId","entityXmlId","split","findItemBySourceId","getCurrentState","updateState","hasTaskInFilter","isParentChangeAction","prototype","call","addTmpIdToSkipSorting","PullEpic","epicAdded","onEpicAdded","epicUpdated","onEpicUpdated","epicRemoved","onEpicRemoved","epicData","onAfterUpdateEpic","onAfterRemoveEpic","SprintMover","onSprintMove","updateSprintSort","calculateSprintSort","increment","getSprintPlannedListNode","sprintNode","sprintSort","Plan","pathToTask","defaultResponsible","activeSprintId","addBacklog","buildBacklog","filterHandler","pullSprint","addTmpIdToSkipAdding","onSubscribeToSprint","sprintMover","getCurrentGroupId","pullItem","getCurrentUserId","pullEpic","subscribeToPull","teamSpeedButton","onShowTeamSpeedChart","Pull","onUpdateItem","onShowTask","onMoveItem","onMoveToSprint","onRemoveItem","onChangeTaskResponsible","onOpenAddEpicForm","onOpenListEpicGrid","onOpenDefinitionOfDone","onAttachFilesToTask","onShowTagSearcher","onShowEpicSearcher","onStartDecomposition","onTagsSearchOpen","onTagsSearchClose","onEpicSearchOpen","onEpicSearchClose","onFilterByEpic","onFilterByTag","onLoadBacklogItems","onMoveToBacklog","onChangeSprintName","onGetSprintCompletedItems","onShowSprintBurnDownChart","onToggleSubTasks","inputValue","createItem","addTmpIdsToSkipAdding","fillItemBeforeCreation","getEpicId","sendRequestToCreateTask","fillItemAfterCreation","updateData","addIdToSkipUpdating","addIdToSkipRemoving","batchRemoveItem","moveItem","changeTaskResponsible","sprintSidePanel","showStartSidePanel","showCompleteSidePanel","changeSprintName","changeSprintDeadline","getSprintCompletedItems","itemsData","showBurnDownChart","openSidePanelByUrl","attachFilesToTask","actionsPanelButton","showTagsDialog","innerBaseEvent","tasks","batchAttachTagToTask","attachTagToTask","batchDeattachTagToTask","splice","indexOf","deAttachTagToTask","showEpicDialog","batchUpdateItemEpic","updateItemEpic","getLastDecomposedItemNode","addSubTask","decomposeItem","showTagsSearchDialog","closeTagsSearchDialog","currentValue","getValueFromField","setValueToField","scrollToSearchContainer","showEpicSearchDialog","closeEpicSearchDialog","activateGroupMode","showItemsLoader","getPageNumberItems","incrementPageNumberItems","createItemsInEntity","projectSidePanel","showTeamSpeedChart","updatedEpicInfo","showDefinitionOfDone","valueWithoutTags","createTask","inputEpic","getEpicByName","openViewForm","epicInfo","ActiveSprintActionButton","completeSprintButtonNode","menuButtonNode","onCompleteSprintClick","onMenuClick","menu","RobotButton","isTaskLimitsExceeded","canUseAutomation","isShowLimitSidePanel","UI","InfoHelper","ActiveSprint","setParams","existActiveSprint","finishStatus","getActiveSprintParams","itemsInFinishStage","setKanbanStyle","robotButton","isCanUseAutomation","activeSprintActionButton","setPathToTask","setActiveSprintParams","activeSprint","setTaskLimitsExceeded","taskLimitExceeded","setCanUseAutomation","limitExceeded","kanbanManager","Scrum","Kanban","bindKanbanHandlers","getKanban","getKanbansGroupedByParentTasks","kanban","onKanbanRender","kanbanItem","targetColumn","beforeItem","onItemMoved","getPathToTask","kanbanGrid","getColumn","getType","updateStatsAfterMovedToFinish","updateStatsAfterMovedFromFinish","scrumItem","subTasksItems","getItemsByParentTaskId","unCompletedItem","BurnDownButton","CompletedSprint","titleContainer","burnDownButton","onSprintSelectorChange","findSprintBySprintId","Entry","buildView","setViewName","viewName","availableViews","view","getViewName","setView","getView","renderTabsTo","renderCountersTo","renderSprintStatsTo","renderButtonsTo","openEpicEditForm","openEpicViewForm","removeEpic"],"mappings":"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"}