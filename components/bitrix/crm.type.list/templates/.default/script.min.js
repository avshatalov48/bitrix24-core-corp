(function(e,t,r,n){"use strict";var i=t.Reflection.namespace("BX.Crm");var o=function(){function e(r){babelHelpers.classCallCheck(this,e);if(t.Type.isPlainObject(r)){if(t.Type.isString(r.gridId)){this.gridId=r.gridId}if(this.gridId&&BX.Main.grid&&BX.Main.gridManager){this.grid=BX.Main.gridManager.getInstanceById(this.gridId)}if(t.Type.isElementNode(r.errorTextContainer)){this.errorTextContainer=r.errorTextContainer}if(t.Type.isElementNode(r.welcomeMessageContainer)){this.welcomeMessageContainer=r.welcomeMessageContainer}this.isEmptyList=Boolean(r.isEmptyList)}}babelHelpers.createClass(e,[{key:"init",value:function e(){this.bindEvents()}},{key:"bindEvents",value:function e(){var n=this;r.EventEmitter.subscribe("BX.Crm.TypeListComponent:onClickDelete",this.handleTypeDelete.bind(this));var i=this.getToolbarComponent();if(i){i.subscribeTypeUpdatedEvent((function(e){var r=t.Type.isObject(e.getData())&&e.getData().isUrlChanged===true;if(r){window.location.reload();return}if(n.gridId&&t.Reflection.getClass("BX.Main.gridManager.reload")){t.Dom.removeClass(document.getElementById("crm-type-list-container"),"crm-type-list-grid-empty");BX.Main.gridManager.reload(n.gridId)}}))}}},{key:"showErrors",value:function e(r){var n="";r.forEach((function(e){n=n+e+" "}));if(t.Type.isElementNode(this.errorTextContainer)){this.errorTextContainer.innerText=n;this.errorTextContainer.parentElement.style.display="block"}else{console.error(n)}}},{key:"hideErrors",value:function e(){if(t.Type.isElementNode(this.errorTextContainer)){this.errorTextContainer.innerText="";this.errorTextContainer.parentElement.style.display="none"}}},{key:"showErrorsFromResponse",value:function e(t){var r=t.errors;var n=[];r.forEach((function(e){var t=e.message;return n.push(t)}));this.showErrors(n)}},{key:"handleTypeDelete",value:function e(r){var i=this;var o=t.Text.toInteger(r.data.id);if(!o){this.showErrors([t.Loc.getMessage("CRM_TYPE_TYPE_NOT_FOUND")]);return}n.MessageBox.show({title:t.Loc.getMessage("CRM_TYPE_TYPE_DELETE_CONFIRMATION_TITLE"),message:t.Loc.getMessage("CRM_TYPE_TYPE_DELETE_CONFIRMATION_MESSAGE"),modal:true,buttons:n.MessageBoxButtons.YES_CANCEL,onYes:function e(r){t.ajax.runAction("crm.controller.type.delete",{analyticsLabel:"crmTypeListDeleteType",data:{id:o}}).then((function(e){var r=t.Type.isObject(e.data)&&e.data.isUrlChanged===true;if(r){window.location.reload();return}i.grid.reloadTable()}))["catch"](i.showErrorsFromResponse.bind(i));r.close()}})}},{key:"getToolbarComponent",value:function e(){if(t.Reflection.getClass("BX.Crm.ToolbarComponent")){return BX.Crm.ToolbarComponent.Instance}return null}}]);return e}();i.TypeListComponent=o})(this.window=this.window||{},BX,BX.Event,BX.UI.Dialogs);
//# sourceMappingURL=script.map.js