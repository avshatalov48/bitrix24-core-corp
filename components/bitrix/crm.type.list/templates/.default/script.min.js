(function(e,t,n,r){"use strict";var i=t.Reflection.namespace("BX.Crm");var o=function(){function e(n){babelHelpers.classCallCheck(this,e);if(t.Type.isPlainObject(n)){if(t.Type.isString(n.gridId)){this.gridId=n.gridId}if(this.gridId&&BX.Main.grid&&BX.Main.gridManager){this.grid=BX.Main.gridManager.getInstanceById(this.gridId)}if(t.Type.isElementNode(n.errorTextContainer)){this.errorTextContainer=n.errorTextContainer}if(t.Type.isElementNode(n.welcomeMessageContainer)){this.welcomeMessageContainer=n.welcomeMessageContainer}this.isEmptyList=Boolean(n.isEmptyList)}}babelHelpers.createClass(e,[{key:"init",value:function e(){this.bindEvents()}},{key:"bindEvents",value:function e(){var r=this;n.EventEmitter.subscribe("BX.Crm.TypeListComponent:onClickDelete",this.handleTypeDelete.bind(this));var i=this.getToolbarComponent();if(this.gridId&&t.Reflection.getClass("BX.Main.gridManager")&&i){i.subscribeTypeUpdatedEvent(function(){t.Dom.removeClass(document.getElementById("crm-type-list-container"),"crm-type-list-grid-empty");BX.Main.gridManager.reload(r.gridId)})}}},{key:"showErrors",value:function e(n){var r="";n.forEach(function(e){r=r+e+" "});if(t.Type.isElementNode(this.errorTextContainer)){this.errorTextContainer.innerText=r;this.errorTextContainer.parentElement.style.display="block"}else{console.error(r)}}},{key:"hideErrors",value:function e(){if(t.Type.isElementNode(this.errorTextContainer)){this.errorTextContainer.innerText="";this.errorTextContainer.parentElement.style.display="none"}}},{key:"showErrorsFromResponse",value:function e(t){var n=t.errors;var r=[];n.forEach(function(e){var t=e.message;return r.push(t)});this.showErrors(r)}},{key:"handleTypeDelete",value:function e(n){var i=this;var o=t.Text.toInteger(n.data.entityTypeId);if(!o){this.showErrors([t.Loc.getMessage("CRM_TYPE_TYPE_NOT_FOUND")]);return}r.MessageBox.show({title:t.Loc.getMessage("CRM_TYPE_TYPE_DELETE_CONFIRMATION_TITLE"),message:t.Loc.getMessage("CRM_TYPE_TYPE_DELETE_CONFIRMATION_MESSAGE"),modal:true,buttons:r.MessageBoxButtons.YES_CANCEL,onYes:function e(n){t.ajax.runAction("crm.controller.type.delete",{analyticsLabel:"crmTypeListDeleteType",data:{entityTypeId:o}}).then(function(){i.grid.reloadTable()}).catch(i.showErrorsFromResponse.bind(i));n.close()}})}},{key:"getToolbarComponent",value:function e(){if(t.Reflection.getClass("BX.Crm.ToolbarComponent")){return BX.Crm.ToolbarComponent.Instance}return null}}]);return e}();i.TypeListComponent=o})(this.window=this.window||{},BX,BX.Event,BX.UI.Dialogs);
//# sourceMappingURL=script.map.js