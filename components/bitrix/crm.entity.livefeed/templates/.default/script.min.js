if(typeof BX.CrmEntityLiveFeed==="undefined"){BX.CrmEntityLiveFeed=function(){this._settings={};this._id="";this._prefix="";this._menuContainer=this._addMessageButton=this._addCallButton=this._addMeetingButton=this._addEmailButton=null;this._activityEditor=this._eventEditor=null;this._enableTaskProcessing=false};BX.CrmEntityLiveFeed.prototype={initialize:function(t,i){this._id=t;this._settings=i;this._prefix=this.getSetting("prefix");this._menuContainer=this._resolveElement("menu");this._addMessageButton=this._resolveElement("add_message");if(this._addMessageButton){BX.bind(this._addMessageButton,"click",BX.delegate(this._onAddMessageButtonClick,this))}this._addCallButton=this._resolveElement("add_call");if(this._addCallButton){BX.bind(this._addCallButton,"click",BX.delegate(this._onAddCallButtonClick,this))}this._addMeetingButton=this._resolveElement("add_meeting");if(this._addMeetingButton){BX.bind(this._addMeetingButton,"click",BX.delegate(this._onAddMeetingButtonClick,this))}this._addEmailButton=this._resolveElement("add_email");if(this._addEmailButton){BX.bind(this._addEmailButton,"click",BX.delegate(this._onAddEmailButtonClick,this))}this._addTaskButton=this._resolveElement("add_task");if(this._addTaskButton){BX.bind(this._addTaskButton,"click",BX.delegate(this._onAddTaskButtonClick,this))}var e=this.getSetting("eventEditorId","");if(BX.type.isNotEmptyString(e)&&typeof(BX.CrmSonetEventEditor!=="undefined")){this._eventEditor=typeof BX.CrmSonetEventEditor.items[e]!=="undefined"?BX.CrmSonetEventEditor.items[e]:null}var n=this.getSetting("activityEditorId","");if(BX.type.isNotEmptyString(n)&&typeof(BX.CrmActivityEditor!=="undefined")){this._activityEditor=typeof BX.CrmActivityEditor.items[n]!=="undefined"?BX.CrmActivityEditor.items[n]:null}},getSetting:function(t,i){return this._settings.hasOwnProperty(t)?this._settings[t]:i},setSetting:function(t,i){this._settings[t]=i},setActivityCompleted:function(t,i){if(this._activityEditor){this._activityEditor.setActivityCompleted(t,i)}},_resolveElement:function(t){var i=t;if(this._prefix){i=this._prefix+i}return BX(i)},_onAddMessageButtonClick:function(t){if(this._eventEditor){this._eventEditor.showEditor()}},_onAddCallButtonClick:function(t){if(this._activityEditor){BX.namespace("BX.Crm.Activity");if(typeof BX.Crm.Activity.Planner!=="undefined"){(new BX.Crm.Activity.Planner).showEdit({TYPE_ID:BX.CrmActivityType.call,OWNER_TYPE:this._activityEditor.getSetting("ownerType",""),OWNER_ID:this._activityEditor.getSetting("ownerID","0")});return}this._activityEditor.addCall()}},_onAddMeetingButtonClick:function(t){if(this._activityEditor){BX.namespace("BX.Crm.Activity");if(typeof BX.Crm.Activity.Planner!=="undefined"){(new BX.Crm.Activity.Planner).showEdit({TYPE_ID:BX.CrmActivityType.meeting,OWNER_TYPE:this._activityEditor.getSetting("ownerType",""),OWNER_ID:this._activityEditor.getSetting("ownerID","0")});return}this._activityEditor.addMeeting()}},_onAddEmailButtonClick:function(t){if(this._activityEditor){this._activityEditor.addEmail()}},_onAddTaskButtonClick:function(t){if(this._activityEditor){this._activityEditor.addTask();this._enableTaskProcessing=true}}};BX.CrmEntityLiveFeed.items={};BX.CrmEntityLiveFeed.create=function(t,i){var e=new BX.CrmEntityLiveFeed;e.initialize(t,i);this.items[t]=e;return e}}