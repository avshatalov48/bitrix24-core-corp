jn.define("intranet/layout/department-selector-card",((e,t,n)=>{const{Loc:o}=e("loc");const{DepartmentSelector:a}=e("selector/widget/entity/intranet/department");const{RunActionExecutor:r}=e("rest/run-action-executor");const{InputDesign:s,InputSize:i,InputMode:p,Input:d}=e("ui-system/form/inputs/input");class l extends LayoutComponent{constructor(e){super(e);this.parentWidget=e.parentWidget??PageManager;this.defaultDepartment=null;this.state={selectedDepartment:this.getDefaultDepartment()}}componentDidMount(){super.componentDidMount();this.fetchDefaultDepartment()}getDefaultDepartment(){if(this.defaultDepartment){return this.defaultDepartment}return null}fetchDefaultDepartment(){new r("intranetmobile.departments.getRootDepartment",{}).setCacheId("root-department").setCacheHandler((e=>this.onLoadRootDepartment(e))).setHandler((e=>this.onLoadRootDepartment(e))).setCacheTtl(3600).call(true)}onLoadRootDepartment(e){if(e.status!=="success"){return}this.defaultDepartment={id:e.data?.id,title:e.data?.name};if(!this.state.selectedDepartment){this.setState({selectedDepartment:this.defaultDepartment});this.props.onLoadRootDepartment(this.defaultDepartment?.id)}}render(){return d({value:this.state.selectedDepartment?.title??"",label:this.props.title??o.getMessage("M_INTRANET_DEPARTMENT_SELECTOR_CARD_DEFAULT_TITLE"),size:i.L,design:s.PRIMARY,mode:p.NAKED,align:"left",dropdown:true,onDropdown:this.openDepartmentSelector,onFocus:this.openDepartmentSelector})}openDepartmentSelector=()=>{a.make({provider:{options:this.props.departmentProviderOption??{}},initSelectedIds:this.state.selectedDepartment?.id?[this.state.selectedDepartment.id]:null,widgetParams:{backdrop:{mediumPositionPercent:70,horizontalSwipeAllowed:false}},allowMultipleSelection:false,closeOnSelect:true,events:{onClose:this.onChange,onViewHidden:this.onViewHidden}}).show({},this.parentWidget??layout)};onViewHidden=()=>{this.props.onViewHidden()};onChange=e=>{this.setState({selectedDepartment:e.pop()??this.getDefaultDepartment()},(()=>{this.props.onChange?.(this.state.selectedDepartment.id)}))}}l.propTypes={title:PropTypes.string,parentWidget:PropTypes.object,departmentProviderOptions:PropTypes.object,onViewHidden:PropTypes.func,onChange:PropTypes.func};n.exports={DepartmentSelectorCard:l}}));
//# sourceMappingURL=extension.map.js