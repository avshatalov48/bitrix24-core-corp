jn.define("intranet/invite-opener-new",((e,n,t)=>{const{Notify:i}=e("notify");const{Invite:o,IntranetInviteAnalytics:r}=e("intranet/invite-new");const{Alert:a}=e("alert");const{Loc:s}=e("loc");const{InviteStatusBox:I}=e("intranet/invite-status-box");const T={POSSIBILITIES_RESTRICTED:"Invite possibilities restricted",PERMISSIONS_RESTRICTED:"Invite permissions restricted"};const l=e=>{i.showIndicatorLoading();_().then((n=>c(n,e)),(n=>E(n,e))).catch((e=>console.error(e))).finally((()=>i.hideCurrentIndicator()))};const E=(e,n)=>{const t=e.errors&&e.errors.length>0;if(t){u(e.errors,n.onInviteError)}};const c=(e,n)=>{const t=e.errors&&e.errors.length>0;if(t){u(e.errors,n.onInviteError);return}const{canCurrentUserInvite:i,canInviteByPhone:o,canInviteByLink:r,isBitrix24Included:a,adminInBoxRedirectLink:s}=e.data;if(!a){if(env.isAdmin){g(n.onInviteError,s,n.parentLayout)}else{d(n.onInviteError,n.parentLayout)}return}if(!i||!o&&!r){N(n.onInviteError,n.parentLayout);return}p({...v(e.data),...n})};const g=(e,n,t=PageManager)=>{I.open({backdropTitle:s.getMessage("INTRANET_INVITE_OPENER_TITLE"),testId:"status-box-invite-in-web",imageName:"user-locked.svg",description:s.getMessage("INTRANET_INVITE_ADMIN_ONLY_IN_WEB_BOX_TEXT"),buttonText:s.getMessage("INTRANET_INVITE_GO_TO_WEB_BUTTON_TEXT"),parentWidget:t,onButtonClick:()=>{setTimeout((()=>{qrauth.open({redirectUrl:n,showHint:true})}),500)}});if(e){e([new Error(T.POSSIBILITIES_RESTRICTED)])}};const d=(e,n=PageManager)=>{I.open({backdropTitle:s.getMessage("INTRANET_INVITE_OPENER_TITLE"),testId:"status-box-no-permission",imageName:"user-locked.svg",parentWidget:n,description:s.getMessage("INTRANET_INVITE_ADMIN_ONLY_BOX_TEXT"),buttonText:s.getMessage("INTRANET_INVITE_DISABLED_BOX_BUTTON_TEXT")});if(e){e([new Error(T.PERMISSIONS_RESTRICTED)])}};const N=(e,n=PageManager)=>{I.open({backdropTitle:s.getMessage("INTRANET_INVITE_OPENER_TITLE"),testId:"status-box-no-invitation",imageName:"no-invitation.svg",parentWidget:n,description:s.getMessage("INTRANET_INVITE_DISABLED_BOX_TEXT"),buttonText:s.getMessage("INTRANET_INVITE_DISABLED_BOX_BUTTON_TEXT")});if(e){e([new Error(T.PERMISSIONS_RESTRICTED)])}};const u=(e,n)=>{a.alert("",o.getAjaxErrorText(e));if(n){n(e)}};const _=()=>BX.ajax.runAction("intranetmobile.invite.getInviteSettings");const v=e=>({inviteLink:e.inviteLink??"",creatorEmailConfirmed:e.creatorEmailConfirmed??false,sharingMessage:e.sharingMessage??"",canInviteByPhone:e.canInviteByPhone??false,canInviteByLink:e.canInviteByLink??false});const p=({parentLayout:e=null,openWidgetConfig:n={},analytics:t={},onInviteSentHandler:i=null,onInviteError:a=null,onViewHiddenWithoutInvitingHandler:I=null,inviteLink:T="",canInviteByPhone:l=false,canInviteByLink:E=false,creatorEmailConfirmed:c=false,sharingMessage:g="",multipleInvite:d=true})=>{const N=new r({analytics:t});N.sendDrawerOpenEvent();N.setDepartmentParam(false);const u={enableNavigationBarBorder:false,titleParams:{text:s.getMessage("INTRANET_INVITE_OPENER_TITLE"),type:"dialog"},modal:true,backdrop:{showOnTop:false,onlyMediumPosition:false,mediumPositionHeight:516,bounceEnable:true,swipeAllowed:true,swipeContentAllowed:false,horizontalSwipeAllowed:false,shouldResizeContent:true,adoptHeightByKeyboard:true},...n,onReady:t=>{let r=false;let s=false;t.showComponent(new o({layout:t,parentLayout:e,openWidgetConfig:n,analytics:N,onInviteSentHandler:e=>{r=true;if(i){i(e)}},onInviteError:e=>{s=true;if(a){a(e)}},inviteLink:T,canInviteByPhone:l,canInviteByLink:E,creatorEmailConfirmed:c,sharingMessage:g,multipleInvite:d}));t.on("onViewRemoved",(()=>{if(!r&&!s&&I){I()}}))}};if(e){e.openWidget("layout",u);return}PageManager.openWidget("layout",u)};t.exports={openIntranetInviteWidget:l,ErrorCode:T}}));
//# sourceMappingURL=extension.map.js