BX.namespace("BX.Lists");BX.Lists.ListsFieldEditClass=function(){var t=function(t){this.randomString=t.randomString;this.ajaxUrl="/bitrix/components/bitrix/lists.field.edit/ajax.php";this.iblockTypeId=t.iblockTypeId;this.iblockId=t.iblockId;this.socnetGroupId=t.socnetGroupId;this.jsClass="ListsFieldEditClass"+t.randomString;this.maxSort=0;this.generateCode=Boolean(t.generateCode);this.prefixFieldId="bx-lists-field-";this.listAction=t.listAction;this.init()};t.prototype.init=function(){this.transliterate();if(this.generateCode&&BX(this.prefixFieldId+"name")){BX(this.prefixFieldId+"name").onkeyup=BX.delegate(function(){this.transliterate()},this);BX(this.prefixFieldId+"name").onblur=BX.delegate(function(){this.transliterate()},this)}this.setStyleForForm();this.actionButton=BX("lists-title-action");this.actionPopupItems=[];this.actionPopupObject=null;this.actionPopupId="lists-title-action";BX.bind(this.actionButton,"click",BX.delegate(this.showListAction,this))};t.prototype.showListAction=function(){if(!this.actionPopupItems.length){for(var t=0;t<this.listAction.length;t++){this.actionPopupItems.push({text:this.listAction[t].text,onclick:this.listAction[t].action})}}if(!BX.PopupMenu.getMenuById(this.actionPopupId)){var e=this.actionButton.getBoundingClientRect();this.actionPopupObject=BX.PopupMenu.create(this.actionPopupId,this.actionButton,this.actionPopupItems,{closeByEsc:true,angle:true,offsetLeft:e.width/2,events:{onPopupShow:BX.proxy(function(){BX.addClass(this.actionButton,"webform-button-active")},this),onPopupClose:BX.proxy(function(){BX.removeClass(this.actionButton,"webform-button-active")},this)}})}if(this.actionPopupObject)this.actionPopupObject.popupWindow.show()};t.prototype.setStyleForForm=function(){var t=BX("tab1_edit_table").rows;[].forEach.call(t||[],function(t){if(t.cells[0]&&!t.cells[0].className)t.cells[0].className="bx-field-name";if(t.cells[1]&&!t.cells[1].className)t.cells[1].className="bx-field-value"})};t.prototype.transliterate=function(){if(!this.generateCode||!BX(this.prefixFieldId+"name")||!BX(this.prefixFieldId+"code"))return false;var t=BX.translit(BX(this.prefixFieldId+"name").value,{change_case:"U"});while(true){var e=t.charAt(0);if(!isNaN(parseInt(e)))t=t.substr(1);else break}t=t.replace(/([\'`]+)+/g,"");BX(this.prefixFieldId+"code").value=t};t.prototype.changeType=function(t){var e=BX(t);var i=BX("action");if(e&&i){BX.showWait();i.value="type_changed";e.submit()}};t.prototype.deleteField=function(t,e){var i=BX(t);var a=BX("action");if(i&&a){if(confirm(e)){a.value="delete";i.submit()}}};t.prototype.deleteListItem=function(t){var e=BX.findParent(t,{tag:"tr"});if(e){var i=BX.findChild(e,{tag:"input","class":"sort-input"},true);if(i){var a=e.parentNode;a.parentNode.appendChild(i);a.removeChild(e)}}};t.prototype.toggleInput=function(t){var e=BX(t);if(e){if(e.style.display=="block")e.style.display="none";else e.style.display="block"}};t.prototype.addNewTableRow=function(t,e,i){var a=BX(t);var n=a.rows.length;var s=a.insertRow(n);var r=a.rows[n-1].cells.length;if(!this.maxSort){var o=BX.findChild(a.rows[n-1],{tag:"input","class":"sort-input"},true);if(o)this.maxSort=parseInt(o.value)+10}for(var l=0;l<r;l++){var c=s.insertCell(l);var u=a.rows[n-1].cells[l].innerHTML;c.align=a.rows[n-1].cells[l].align;if(l==0)c.style.display="none";else c.className=a.rows[n-1].cells[l].className;c.innerHTML=u.replace(e,function(t){return t.replace("[n"+arguments[i]+"]","[n"+(1+parseInt(arguments[i]))+"]")})}var p=BX.findChild(a.rows[n],{tag:"input","class":"sort-input"},true);if(p){p.value=this.maxSort;this.maxSort+=10}};return t}();var dragTable=function(t,e){var i=false;var a=false;var n=false;var s=false;var r=false;var o=function(){a=t.getElementsByTagName("tbody")[0];t.onmousedown=l;t.onmouseleave=c;t.onmouseup=c;t.onmousemove=u};var l=function(a){var o=a.target||a.srcElement;if(o.tagName=="TD"){BX.eventReturnFalse(a);var l=o.parentNode;if(l.parentNode.nodeName!=="TBODY"&&o.tagName=="TD")return false;if(i&&o.tagName=="TD")return false;r=l;i=l;i.setAttribute("class","lists-field-drag-tr");n=a.y||a.clientY;s=p(i);if(e&&e.start)e.start(t,r,s)}};var c=function(a){var o=a.target||a.srcElement;if(o.tagName=="TD"){if(!i)return false;i.removeAttribute("class");n=false;i=false;if(e&&e.stop)e.stop(t,r,s,p(r))}};var u=function(s){var o=s.target||s.srcElement;if(o.tagName=="TD"){if(!i)return false;var l=o.parentNode;if(l===i||l.nodeName!=="TR"||l.parentNode.nodeName!=="TBODY")return false;var c=s.y||s.clientY;var u=c<n;n=c;if(u){a.insertBefore(i,l)}else{a.insertBefore(l,i)}if(e&&e.dragging)e.dragging(t,i,l,p(r))}};var p=function(t){var e=a.getElementsByTagName("tr");for(var i=0,n=e.length;i<n;i++){if(e[i]===t)return i+1}return 0};o()};function enumerationValues(t){var e=BX.findChildren(t,{tag:"input",attribute:{type:"hidden"}},true);if(e[e.length-1].getAttribute("name")=="LIST[n0][SORT]"){for(var i=1;i<=e.length;i++){e[i-1].setAttribute("value",i*10)}}}
//# sourceMappingURL=script.map.js