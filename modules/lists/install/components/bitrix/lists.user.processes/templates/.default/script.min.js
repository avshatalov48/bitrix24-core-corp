BX.namespace("BX.Lists");BX.Lists.ListsProcessesClass=function(){var s=function(s){this.ajaxUrl="/bitrix/components/bitrix/lists.user.processes/ajax.php";BX.bind(BX("lists-title-action-add"),"click",BX.delegate(this.showProcesses,this))};s.prototype.showProcesses=function(){var s=BX("bx-lists-store_items"),t=[],e=BX.findChildren(s,{tag:"span",className:"feed-add-post-form-link-lists"},true);if(e.length){t=this.getMenuItems(e);this.showMoreMenuLists(t)}else{var i=null,a=null;if(BX("bx-lists-select-site-id")){i=BX("bx-lists-select-site-id").value}if(BX("bx-lists-select-site")){a=BX("bx-lists-select-site").value}BX.Lists.ajax({method:"POST",dataType:"json",url:BX.Lists.addToLinkParam(this.ajaxUrl,"action","showProcesses"),data:{siteDir:a,siteId:i,sessid:BX.bitrix_sessid()},onsuccess:BX.delegate(function(i){if(i.status=="success"){for(var a in i.lists){s.appendChild(BX.create("span",{attrs:{"data-name":BX.util.htmlspecialchars(i.lists[a].name),"data-picture":i.lists[a].picture,"data-url":'document.location.href = "'+i.lists[a].url+'"'},props:{className:"feed-add-post-form-link-lists",id:"bx-lists-tab-create-processes"},style:{display:"none"}}))}e=BX.findChildren(s,{tag:"span",className:"feed-add-post-form-link-lists"},true);t=this.getMenuItems(e);this.showMoreMenuLists(t)}else{i.errors=i.errors||[{}];BX.Lists.showModalWithStatusAction({status:"error",message:i.errors.pop().message})}},this)})}};s.prototype.getMenuItems=function(s){var t=[];for(var e=0;e<s.length;e++){t.push({tabId:"lists",text:s[e].getAttribute("data-name"),className:"feed-add-post-form-lists",onclick:s[e].getAttribute("data-url")})}return t};s.prototype.showMoreMenuLists=function(s){var t=BX("lists-title-action-add").getBoundingClientRect();var e=BX.PopupMenu.create("lists",BX("lists-title-action-add"),s,{closeByEsc:true,offsetLeft:t.width/2,angle:true});var i=BX.findChildren(BX("popup-window-content-menu-popup-lists"),{tag:"span",className:"menu-popup-item-icon"},true),a=BX.findChildren(BX("bx-lists-store_items"),{tag:"span",className:"feed-add-post-form-link-lists"},true);for(var r=0;r<i.length;r++){i[r].innerHTML=a[r].getAttribute("data-picture")}e.popupWindow.show()};return s}();
//# sourceMappingURL=script.map.js