jn.define("sign/grid/item-factory/document",((e,t,s)=>{const{ChipStatus:i,ChipStatusDesign:r,ChipStatusMode:n}=e("ui-system/blocks/chips/chip-status");const{Button:o,ButtonSize:a,ButtonDesign:u}=e("ui-system/form/buttons/button");const{BadgeCounter:d,BadgeCounterDesign:S}=e("ui-system/blocks/badges/counter");const{makeLibraryImagePath:g}=e("ui-system/blocks/status-block");const{Base:m}=e("layout/ui/simple-list/items/base");const{IconView:c,Icon:I}=e("ui-system/blocks/icon");const{H5:l}=e("ui-system/typography/heading");const{Text6:D}=e("ui-system/typography/text");const{Avatar:p}=e("ui-system/blocks/avatar");const{ProfileView:_}=e("user/profile");const{InitiatedByType:h}=e("sign/type/initiated-by-type");const{ActionStatus:E}=e("sign/type/action-status");const{MemberStatus:T}=e("sign/type/member-status");const{DocumentStatus:b}=e("sign/type/document-status");const{MemberRole:y}=e("sign/type/member-role");const{downloadFile:M}=e("sign/download-file");const{SignOpener:N}=e("sign/opener");const{FriendlyDate:C}=e("layout/ui/friendly-date");const{date:B}=e("utils/date/formats");const{Moment:G}=e("utils/date");const{Indent:A,Color:O,Component:U}=e("tokens");const{Loc:R}=e("loc");const f={default:"sign-doc.svg",pdf:"pdf-doc.svg",zip:"zip-doc.svg"};class w extends m{renderItemContent(){return View({style:{position:"relative",paddingLeft:U.cardPaddingLr.toNumber(),paddingRight:U.cardPaddingLr.toNumber(),paddingBottom:U.cardPaddingB.toNumber(),paddingTop:U.cardPaddingT.toNumber(),borderRadius:U.cardCorner.toNumber(),borderColor:O.bgSeparatorPrimary.toHex(),marginBottom:15,marginLeft:15,marginRight:13,borderWidth:1}},View({style:{flexDirection:"row"}},this.renderImage(),this.renderBody(),this.renderDownloadButton()),this.renderActionButton(),this.renderBadge())}renderImage(){const e=E.isDownloadStatus(this.getActionStatus())?f[this.getFileExtension()]??f.default:f.default;return Image({svg:{uri:g(e,"empty-states","sign")},style:{width:40,height:40}})}renderBody(){return View({style:{flex:1,paddingLeft:A.XL.toNumber(),paddingBottom:A.M.toNumber()}},this.renderTitle(),this.renderDescription(),this.renderSecondSide())}renderTitle(){return this.renderText({type:"title",text:this.getDocumentTitle(),typography:l,style:{marginBottom:A.XS.toNumber(),marginRight:15}})}renderDescription(){if(h.isInitiatedByEmployee(this.getDocumentInitiatedType())&&!b.isFinalStatus(this.getDocumentStatus())&&this.isInitiatorCurrentUser()&&!E.isActionStatus(this.getActionStatus())){return this.renderText({type:"description",text:R.getMessage("SIGN_MOBILE_GRID_DOCUMENT_DATE_SEND",{"#DATE#":this.getDocumentSendDate()}),typography:D,style:{marginTop:A.M.toNumber(),marginBottom:A.M.toNumber()}})}return View()}renderSecondSide(){if(!E.isActionStatus(this.getActionStatus())){const{secondSideText:e,SecondSideDesign:t}=this.prepareSecondSideData();return View({style:{flexDirection:"row",marginTop:10},onClick:this.#e},p({id:this.getUserId(0),testId:`USER_AVATAR_${this.getMemberId(0)}`,size:24,withRedux:true,onClick:this.#e}),i({text:e,design:t,mode:n.OUTLINE,style:{marginLeft:10}}))}return View()}renderDownloadButton(){if(E.isDownloadStatus(this.getActionStatus())&&this.getFileUrl()){return View({style:{display:"flex",align:"center",justifyContent:"center"}},c({size:{height:40,width:40},icon:I.CHEVRON_TO_THE_RIGHT_SIZE_S,color:O.base1,opacity:.5,onClick:this.#t}))}return View()}renderBadge(){if(!E.isActionStatus(this.getActionStatus())){return View()}return View({style:{position:"absolute",top:A.S.toNumber(),right:A.S.toNumber()}},d({value:1,design:S.ALERT}))}renderActionButton(){let e="";switch(this.getActionStatus()){case E.SIGN.value:e=R.getMessage("SIGN_MOBILE_GRID_SIGN_BUTTON_TEXT");break;case E.APPROVE.value:e=R.getMessage("SIGN_MOBILE_GRID_APPROVE_BUTTON_TEXT");break;case E.EDIT.value:e=R.getMessage("SIGN_MOBILE_GRID_EDIT_BUTTON_TEXT");break;default:return View()}return o({text:e,testId:"Button",size:a.M,design:u.OUTLINE_ACCENT_2,stretched:true,onClick:this.#s,style:{width:"50%",marginTop:10}})}prepareSecondSideData(){let e="";let t=r.NEUTRAL;if(h.isInitiatedByEmployee(this.getDocumentInitiatedType())&&this.isInitiatorCurrentUser()&&this.isMemberCurrentUser()&&!b.isFinalStatus(this.getDocumentStatus())&&!T.isDoneStatus(this.getMemberStatus(0))){switch(this.getMemberRole(0)){case y.ASSIGNEE.value:case y.SIGNER.value:e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGNING");break;case y.EDITOR.value:e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDITING");break;case y.REVIEWER.value:e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVING");break;default:break}return{secondSideText:e,SecondSideDesign:t}}if(T.isCanceledStatus(this.getMemberStatus(0))||b.isStopped(this.getDocumentStatus())){if(this.isCurrentUserCanceled()){return{secondSideText:R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_REFUSED_BY_YOU",{"#DATE#":String(this.getDocumentCancelledDate())}),SecondSideDesign:r.WARNING}}if(h.isInitiatedByEmployee(this.getDocumentInitiatedType())&&(this.isInitiatorCurrentUser()&&!this.isMemberCurrentUser()||this.isSecondSideStopped(0))){return{secondSideText:R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_REFUSED",{"#DATE#":String(this.getDocumentCancelledDate())}),SecondSideDesign:r.WARNING}}}switch(this.getMemberRole(0)){case y.ASSIGNEE.value:case y.SIGNER.value:if(T.isDoneStatus(this.getMemberStatus(0))){t=r.SUCCESS;e=R.getMessage(this.isMemberCurrentUser()?"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGN_BY_YOU":"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGN",{"#DATE#":String(this.getDocumentSignDate())})}else{e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGNING")}break;case y.EDITOR.value:if(T.isDoneStatus(this.getMemberStatus(0))){e=R.getMessage(this.isMemberCurrentUser()?"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDIT_BY_YOU":"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDIT",{"#DATE#":String(this.getDocumentEditDate())})}else{e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDITING")}break;case y.REVIEWER.value:if(T.isDoneStatus(this.getMemberStatus(0))){e=R.getMessage(this.isMemberCurrentUser()?"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVE_BY_YOU":"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVE",{"#DATE#":String(this.getDocumentApprovedDate())})}else{e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVING")}break;default:break}return{secondSideText:e,SecondSideDesign:t}}renderText({text:e,typography:t,style:s}){return typeof e==="string"?t({text:e,style:s}):View({style:s},e)}isCurrentUserCanceled(){if(this.isMemberCurrentUser()&&T.isCanceledStatus(this.getMemberStatus(0))){return true}else if(this.isMyMemberCurrentUser()&&T.isCanceledStatus(this.getMyMemberStatus())){return true}return false}isMyMemberCurrentUser(){return Number(env.userId)===this.getMyMemberId()&&this.getUserId(0)===this.getMyMemberId()}isMemberCurrentUser(){return Number(env.userId)===this.getUserId(0)}isInitiatorCurrentUser(){return Number(env.userId)===this.getInitiatorId()}isSecondSideStopped(e){return this.props.item?.members[e]?.isStopped}#e=()=>{_.open({userId:this.getUserId(0)})};#t=()=>M(currentDomain+String(this.getFileUrl()));#s=()=>{N.openSigning({memberId:this.getMemberId(0)})};getFileExtension(){return this.props.item?.file?.ext}getDocumentTitle(){return this.props.item?.document?.title}getDocumentInitiatedType(){return this.props.item?.document?.initiatedByType}getDocumentSendDate(){return this.getFormattedDate(this.props.item?.document?.sendDate)}getDocumentCancelledDate(){return this.getFormattedDate(this.props.item?.document?.cancelledDate)}getDocumentSignDate(){return this.getFormattedDate(this.props.item?.document?.signDate)}getDocumentEditDate(){return this.getFormattedDate(this.props.item?.document?.editDate)}getDocumentApprovedDate(){return this.getFormattedDate(this.props.item?.document?.approvedDate)}getFormattedDate(e){if(!e){return""}const t=new G(e);return new C({moment:t,defaultFormat:B(),useTimeAgo:true}).makeText(t)}getActionStatus(){return this.props.item?.action?.status}getDocumentStatus(){return this.props.item?.document?.status}getFileUrl(){return this.props.item?.file?.url}getMemberStatus(e){return this.props.item?.members[e]?.status}getMyMemberStatus(){return this.props.item?.myMemberInProcess?.status}getMyMemberId(){return this.props.item?.myMemberInProcess?.id}getMemberRole(e){return this.props.item?.members[e]?.role}getUserId(e){return this.props.item?.members[e]?.id}getMemberId(e){return this.props.item?.members[e]?.memberId}getInitiatorId(){return this.props.item?.document?.initiator?.id}}s.exports={Document:w}}));
//# sourceMappingURL=extension.map.js