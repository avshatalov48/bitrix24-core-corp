jn.define("sign/grid/item-factory/document",((e,t,s)=>{const{ChipStatus:i,ChipStatusDesign:r,ChipStatusMode:n}=e("ui-system/blocks/chips/chip-status");const{Button:o,ButtonSize:a,ButtonDesign:d}=e("ui-system/form/buttons/button");const{BadgeCounter:u,BadgeCounterDesign:S}=e("ui-system/blocks/badges/counter");const{makeLibraryImagePath:m}=e("ui-system/blocks/status-block");const{Base:g}=e("layout/ui/simple-list/items/base");const{IconView:c,Icon:I}=e("ui-system/blocks/icon");const{H5:l}=e("ui-system/typography/heading");const{Text6:D}=e("ui-system/typography/text");const{Avatar:h}=e("ui-system/blocks/avatar");const{ProfileView:p}=e("user/profile");const{InitiatedByType:_}=e("sign/type/initiated-by-type");const{ActionStatus:E}=e("sign/type/action-status");const{MemberStatus:b}=e("sign/type/member-status");const{DocumentStatus:T}=e("sign/type/document-status");const{MemberRole:M}=e("sign/type/member-role");const{downloadFile:y}=e("sign/download-file");const{SignOpener:N}=e("sign/opener");const{FriendlyDate:C}=e("layout/ui/friendly-date");const{date:U}=e("utils/date/formats");const{Moment:B}=e("utils/date");const{Indent:G,Color:A,Component:O}=e("tokens");const{useCallback:R}=e("utils/function");const{Loc:f}=e("loc");const w={default:"sign-doc.svg",pdf:"pdf-doc.svg",zip:"zip-doc.svg"};class k extends g{renderItemContent(){return View({style:{position:"relative",paddingLeft:O.cardPaddingLr.toNumber(),paddingRight:O.cardPaddingLr.toNumber(),paddingBottom:O.cardPaddingB.toNumber(),paddingTop:O.cardPaddingT.toNumber(),borderRadius:O.cardCorner.toNumber(),borderColor:A.bgSeparatorPrimary.toHex(),marginBottom:15,marginLeft:15,marginRight:13,borderWidth:1}},View({style:{flexDirection:"row"}},this.renderImage(),this.renderBody(),this.renderDownloadButton()),this.renderActionButton(),this.renderBadge())}renderImage(){const e=E.isDownloadStatus(this.getAction())?w[this.getFileExtension()]??w.default:w.default;return Image({svg:{uri:m(e,"empty-states","sign")},style:{width:40,height:40}})}renderBody(){return View({style:{flex:1,paddingLeft:G.XL.toNumber(),paddingBottom:G.M.toNumber()}},this.renderTitle(),this.renderDescription(),this.renderSecondSide())}renderTitle(){return this.renderText({type:"title",text:this.getDocumentTitle(),typography:l,style:{marginBottom:G.XS.toNumber(),marginRight:15}})}renderDescription(){if(_.isInitiatedByEmployee(this.getDocumentInitiatedType())&&!T.isFinalStatus(this.getDocumentStatus())&&this.isInitiatorCurrentUser()&&!E.isActionStatus(this.getAction())){return this.renderText({type:"description",text:f.getMessage("SIGN_MOBILE_GRID_DOCUMENT_DATE_SEND",{"#DATE#":this.getDocumentSendDate()}),typography:D,style:{marginTop:G.M.toNumber(),marginBottom:G.M.toNumber()}})}return View()}renderSecondSide(){if(!E.isActionStatus(this.getAction())){const{secondSideText:e,SecondSideDesign:t,secondSideMemberId:s}=this.prepareSecondSideData();return View({style:{flexDirection:"row",marginTop:10},onClick:R((()=>this.#e(s)),[s])},h({id:s,testId:`USER_AVATAR_${this.getMemberId(0)}`,size:24,withRedux:true,onClick:R((()=>this.#e(s)),[s])}),i({text:e,design:t,mode:n.OUTLINE,style:{marginLeft:10}}))}return View()}renderDownloadButton(){if(E.isDownloadStatus(this.getAction())&&this.getFileUrl()){return View({style:{display:"flex",align:"center",justifyContent:"center"}},c({size:{height:40,width:40},icon:I.CHEVRON_TO_THE_RIGHT_SIZE_S,color:A.base1,opacity:.5,onClick:this.#t}))}return View()}renderBadge(){if(!E.isActionStatus(this.getAction())){return View()}return View({style:{position:"absolute",top:G.S.toNumber(),right:G.S.toNumber()}},u({value:1,design:S.ALERT}))}renderActionButton(){let e="";switch(this.getAction()){case E.SIGN.value:e=f.getMessage("SIGN_MOBILE_GRID_SIGN_BUTTON_TEXT");break;case E.APPROVE.value:e=f.getMessage("SIGN_MOBILE_GRID_APPROVE_BUTTON_TEXT");break;case E.EDIT.value:e=f.getMessage("SIGN_MOBILE_GRID_EDIT_BUTTON_TEXT");break;default:return View()}return o({text:e,testId:"Button",size:a.M,design:d.OUTLINE_ACCENT_2,stretched:true,onClick:this.#s,style:{width:"50%",marginTop:10}})}prepareSecondSideData(){let e="";let t=r.NEUTRAL;let s=this.getMemberUserId(0);if(_.isInitiatedByEmployee(this.getDocumentInitiatedType())&&this.isInitiatorCurrentUser()&&this.isMemberCurrentUser()&&!T.isFinalStatus(this.getDocumentStatus())&&!b.isDoneStatus(this.getMemberStatus(0))){switch(this.getMemberRole(0)){case M.ASSIGNEE.value:case M.SIGNER.value:e=f.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGNING");break;case M.EDITOR.value:e=f.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDITING");break;case M.REVIEWER.value:e=f.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVING");break;default:break}return{secondSideText:e,SecondSideDesign:t,secondSideMemberId:s}}if(b.isCanceledStatus(this.getMemberStatus(0))||T.isStopped(this.getDocumentStatus())){if(this.isCurrentUserCanceled()){return{secondSideText:f.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_REFUSED_BY_YOU",{"#DATE#":String(this.getDocumentCancelledDate())}),SecondSideDesign:r.WARNING,secondSideMemberId:this.getInitiatorUserId()}}if(_.isInitiatedByEmployee(this.getDocumentInitiatedType())&&(this.isInitiatorCurrentUser()&&!this.isMemberCurrentUser()||this.isSecondSideStopped(0))){return{secondSideText:f.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_REFUSED",{"#DATE#":String(this.getDocumentCancelledDate())}),SecondSideDesign:r.WARNING,secondSideMemberId:s}}}switch(this.getMemberRole(0)){case M.ASSIGNEE.value:case M.SIGNER.value:if(b.isDoneStatus(this.getMemberStatus(0))){t=r.SUCCESS;e=f.getMessage(this.isMemberCurrentUser()?"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGN_BY_YOU":"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGN",{"#DATE#":String(this.getDocumentSignDate())})}else{e=f.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGNING")}break;case M.EDITOR.value:if(b.isDoneStatus(this.getMemberStatus(0))){e=f.getMessage(this.isMemberCurrentUser()?"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDIT_BY_YOU":"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDIT",{"#DATE#":String(this.getDocumentEditDate())})}else{e=f.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDITING")}break;case M.REVIEWER.value:if(b.isDoneStatus(this.getMemberStatus(0))){e=f.getMessage(this.isMemberCurrentUser()?"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVE_BY_YOU":"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVE",{"#DATE#":String(this.getDocumentApprovedDate())})}else{e=f.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVING")}break;default:break}s=this.isMemberCurrentUser()&&b.isDoneStatus(this.getMemberStatus(0))?this.getInitiatorUserId():s;return{secondSideText:e,SecondSideDesign:t,secondSideMemberId:s}}renderText({text:e,typography:t,style:s}){return typeof e==="string"?t({text:e,style:s}):View({style:s},e)}isCurrentUserCanceled(){if(this.isMemberCurrentUser()&&b.isCanceledStatus(this.getMemberStatus(0))){return true}else if(this.isMyMemberCurrentUser()&&b.isCanceledStatus(this.getMyMemberStatus())){return true}return false}isMyMemberCurrentUser(){return Number(env.userId)===this.getMyMemberUserId()&&this.getMemberUserId(0)===this.getMyMemberUserId()}isMemberCurrentUser(){return Number(env.userId)===this.getMemberUserId(0)}isInitiatorCurrentUser(){return Number(env.userId)===this.getInitiatorUserId()}isSecondSideStopped(e){return this.props.item?.members[e]?.isStopped}#e=e=>{p.open({userId:e})};#t=()=>y(currentDomain+String(this.getFileUrl()));#s=()=>{N.openSigning({memberId:this.getMemberId(0)})};getFileExtension(){return this.props.item?.file?.ext}getDocumentTitle(){return this.props.item?.document?.title}getDocumentInitiatedType(){return this.props.item?.document?.initiatedByType}getDocumentSendDate(){return this.getFormattedDate(this.props.item?.document?.sendDate)}getDocumentCancelledDate(){return this.getFormattedDate(this.props.item?.document?.cancelledDate)}getDocumentSignDate(){return this.getFormattedDate(this.props.item?.document?.signDate)}getDocumentEditDate(){return this.getFormattedDate(this.props.item?.document?.editDate)}getDocumentApprovedDate(){return this.getFormattedDate(this.props.item?.document?.approvedDate)}getFormattedDate(e){if(!e){return""}const t=new B(e);return new C({moment:t,defaultFormat:U(),useTimeAgo:true}).makeText(t)}getAction(){return this.props.item?.action}getDocumentStatus(){return this.props.item?.document?.status}getFileUrl(){return this.props.item?.file?.url}getMemberStatus(e){return this.props.item?.members[e]?.status}getMyMemberStatus(){return this.props.item?.myMemberInProcess?.status}getMyMemberUserId(){return this.props.item?.myMemberInProcess?.userId}getMemberRole(e){return this.props.item?.members[e]?.role}getMemberUserId(e){return this.props.item?.members[e]?.userId}getMemberId(e){return this.props.item?.members[e]?.id}getInitiatorUserId(){return this.props.item?.document?.initiator?.userId}}s.exports={Document:k}}));
//# sourceMappingURL=extension.map.js