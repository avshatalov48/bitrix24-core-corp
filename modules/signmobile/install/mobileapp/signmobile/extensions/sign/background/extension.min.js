(()=>{const e=e=>jn.require(e);const{SignOpener:n}=e("sign/opener");const{Push:s}=e("native/app");const t="SIGN_MOBILE_FOUND_DOCUMENT_FOR_SIGNING";const i="SIGN_MOBILE_REQUEST_FOR_SIGN_CONFIRMATION";class r{constructor(){n.clearCacheSomeBannerIsAlreadyOpen();this.bindEvents()}unpackJsonEventParams(e){let n=null;const s=JSON.parse(e);if(s.message){const e=JSON.parse(s.message);n=this.unpackEventParams(e)}return n}unpackEventParams(e){let n=null;const s=e.payload;if(s){const{role:t,memberId:i=0,forcedBannerOpening:r=false,isGoskey:a=false,isExternal:o=false,initiatedByType:c}=s;n={type:e.type,role:t,memberId:Number(i),forcedBannerOpening:r,title:"",url:"",isGoskey:a,isExternal:o,initiatedByType:c};const l=s.document;if(l){const{title:e="",url:s=""}=l;n.title=e;n.url=s}}return n}processEvent(e){if(e!==null){const{url:s,title:r,memberId:a,role:o,forcedBannerOpening:c,isGoskey:l,isExternal:p,initiatedByType:u}=e;switch(e.type){case t:n.openSigning({url:s,title:r,memberId:a,role:o,goWithoutConfirmation:false,isGoskey:l,isExternal:p,initiatedByType:u});break;case i:n.openConfirmation({role:o,memberId:a,title:r,forcedBannerOpening:c,initiatedByType:u});break;default:break}}}bindEvents(){s.on("receivedPush",(({params:e})=>{this.processEvent(this.unpackJsonEventParams(e))}));PushListener.subscribe(t,(e=>{this.processEvent(this.unpackEventParams(e))}));PushListener.subscribe(i,(e=>{this.processEvent(this.unpackEventParams(e))}));BX.addCustomEvent("signbackground::router",(e=>{n.openSigning({memberId:e})}))}}this.SignBackground=new r})();
//# sourceMappingURL=extension.map.js