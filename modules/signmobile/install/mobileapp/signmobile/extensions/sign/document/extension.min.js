jn.define("sign/document",((e,t,i)=>{const{Card:n}=e("ui-system/layout/card");const{ButtonSize:o,ButtonDesign:s,Button:r}=e("ui-system/form/buttons/button");const{Indent:l,Color:a}=e("tokens");const{Loc:d}=e("loc");const{ResponseMobile:c}=e("sign/dialog/banners/responsemobile");const{ResponseReviewMobile:_}=e("sign/dialog/banners/responsereviewmobile");const{RefusedJustNow:I}=e("sign/dialog/banners/refusedjustnow");const{InitiatedByType:u}=e("sign/type/initiated-by-type");const{External:E}=e("sign/dialog/banners/external");const{NotifyManager:T}=e("notify-manager");const{showConfirm:N}=e("sign/dialog/banners/template");const{rejectConfirmation:C}=e("sign/connector");const{MemberRole:h}=e("sign/type/member-role");const g=Application.getPlatform()==="ios";const m="https://www.gosuslugi.ru/select-app-goskey";class B extends LayoutComponent{constructor(e){super(e);const{url:t,widget:i,memberId:n,title:o,isGoskey:s,isExternal:r,initiatedByType:l,role:a}=e;this.layout=i;const d=t.indexOf("?")!==-1?"&":"?";this.url=t+d+"hide_reviewer_buttons=1";this.memberId=n;this.isGoskey=s;this.isExternal=r;this.title=o;this.initiatedByType=l;this.role=a}clearHeader(){this.layout.setTitle({text:""});this.layout.setRightButtons([]);this.layout.setLeftButtons([])}render(){return View({style:{backgroundColor:a.bgPrimary.toHex(),flex:1}},WebView({style:{flex:1},scrollDisabled:true,zoomEnabled:true,data:{url:this.url}}),View({style:{paddingBottom:g?device.screen.safeArea.bottom:0}},h.isReviewerRole(this.role)?this.renderReviewButtons():this.renderSignButtons()))}renderSignButtons(){return n({},r({text:d.getMessage("SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_BUTTON_TITLE"),size:o.XL,design:s.FILLED,disabled:false,badge:false,stretched:true,onClick:this.#e,style:{marginBottom:l.L.toNumber()}}),this.renderRejectButton())}renderReviewButtons(){return n({},r({text:d.getMessage("SIGN_MOBILE_DOCUMENT_CONFIRM_REVIEW_BUTTON_TITLE"),size:o.XL,design:s.FILLED,disabled:false,badge:false,stretched:true,onClick:this.#t,style:{marginBottom:l.L.toNumber()}}),this.renderRejectButton())}renderRejectButton(){const{titleCode:e}=this.#i();return r({text:d.getMessage(e),size:o.XL,design:s.PLAN_ACCENT,disabled:false,badge:false,stretched:true,onClick:this.#n})}#e=()=>{if(this.isGoskey){if(Application.canOpenUrl(m)){Application.openUrl(m)}return}this.clearHeader();if(this.isExternal){this.layout.showComponent(new E({documentTitle:this.title,memberId:this.memberId,layoutWidget:this.layout}));return}this.layout.showComponent(new c({documentTitle:this.title,memberId:this.memberId,layoutWidget:this.layout,initiatedByType:this.initiatedByType}))};#t=()=>{this.clearHeader();this.layout.showComponent(new _({documentTitle:this.title,memberId:this.memberId,layoutWidget:this.layout,initiatedByType:this.initiatedByType}))};#n=()=>{if(this.isGoskey&&!h.isReviewerRole(this.role)){if(Application.canOpenUrl(m)){Application.openUrl(m)}return}const{titleCode:e,confirmTitleCode:t,descriptionCode:i,cancelTitleCode:n}=this.#i();N({title:d.getMessage(e),description:d.getMessage(i),confirmTitle:d.getMessage(t),cancelTitle:d.getMessage(n),onConfirm:this.#o})};#o=()=>{T.showLoadingIndicator();C(this.memberId).then((()=>{T.hideLoadingIndicatorWithoutFallback();this.clearHeader();this.layout.showComponent(new I({role:this.role,documentTitle:this.title,memberId:this.memberId,layoutWidget:this.layout,initiatedByType:this.initiatedByType}))})).catch((()=>{T.showErrors([{message:d.getMessage("SIGN_MOBILE_DOCUMENT_UNKNOWN_ERROR_TEXT")}])}))};#i(){const e=u.isInitiatedByEmployee(this.initiatedByType);const t=h.isReviewerRole(this.role);const i=h.isSignerRole(this.role);const n=e||t?"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_REJECT_BY_EMPLOYEE_TITLE":"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_REJECT_TITLE";const o=e||t?"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_BY_EMPLOYEE_REJECT_BUTTON_TITLE":"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_REJECT_BUTTON_TITLE";let s=e&&i?"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_BY_EMPLOYEE_DESCRIPTION":t?"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_BY_REVIEWER_DESCRIPTION":"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_DESCRIPTION";const r=t?"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_CANCEL_BY_REVIEWER_BUTTON_TITLE":"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_CANCEL_BUTTON_TITLE";return{titleCode:n,confirmTitleCode:o,descriptionCode:s,cancelTitleCode:r}}}i.exports={SignDocument:B}}));
//# sourceMappingURL=extension.map.js