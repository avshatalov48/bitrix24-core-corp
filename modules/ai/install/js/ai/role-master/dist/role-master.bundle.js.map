{"version":3,"file":"role-master.bundle.js","sources":["../src/components/role-master-editor.js","../src/components/role-master-progress.js","../src/components/role-master-warning.js","../src/components/role-master-step.js","../src/components/role-master-text-step.js","../src/components/role-master-btn.js","../src/components/role-master-avatar-uploader.js","../src/directives/role-master-hover-hint.js","../src/components/role-master-user-selector.js","../src/components/role-master-main-step.js","../src/components/role-master-saving-status.js","../src/helpers.js","../src/components/role-master.js","../src/role-master.js","../src/role-master-popup.js"],"sourcesContent":["import '../css/role-master-editor.css';\n\nexport const RoleMasterEditor = {\n\tprops: {\n\t\ttext: String,\n\t\tmaxTextLength: Number,\n\t\tminTextLength: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 5,\n\t\t},\n\t\tplaceholder: String,\n\t},\n\temits: ['update:text'],\n\tcomputed: {\n\t\ttextLength(): number {\n\t\t\treturn this.text?.length || 0;\n\t\t},\n\t},\n\tmethods: {\n\t\thandleInput(e: InputEvent) {\n\t\t\tthis.$emit('update:text', e.target.value);\n\t\t},\n\t},\n\tmounted() {\n\t\trequestAnimationFrame(() => {\n\t\t\tthis.$refs.textField.focus();\n\t\t});\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__role-master_editor ui-ctl-textarea\">\n\t\t\t<textarea\n\t\t\t\tref=\"textField\"\n\t\t\t\t:value=\"text\"\n\t\t\t\t:maxlength=\"maxTextLength\"\n\t\t\t\t:minlength=\"minTextLength\"\n\t\t\t\t:placeholder=\"placeholder\"\n\t\t\t\t@input=\"handleInput\"\n\t\t\t\tclass=\"ai__role-master_editor-text-field ui-ctl-element\"\n\t\t\t></textarea>\n\t\t\t<div class=\"ai__role-master_editor-character-counter\">\n\t\t\t\t{{ textLength }}/{{ maxTextLength }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../css/role-master-progress.css';\n\nexport const RoleMasterProgress = {\n\tprops: {\n\t\tcurrent: Number,\n\t},\n\tcomputed: {\n\t\ttotal(): number {\n\t\t\treturn 2;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetProgressStepClassname(isActive: boolean): Object {\n\t\t\treturn {\n\t\t\t\t'ai__role-master_progress-step': true,\n\t\t\t\t'--active': isActive,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__role-master_progress\">\n\t\t\t<span\n\t\t\t\tv-for=\"index in total\"\n\t\t\t\t:class=\"getProgressStepClassname(index <= current)\"\n\t\t\t>\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import { Alert } from 'ui.alerts';\n\nexport const RoleMasterWarning = {\n\tprops: {\n\t\ttext: String,\n\t},\n\tcomputed: {\n\t\talertHtmlString(): string {\n\t\t\tconst alert = new Alert({\n\t\t\t\tinline: true,\n\t\t\t\ttext: this.text,\n\t\t\t\tcolor: Alert.Color.WARNING,\n\t\t\t\tanimated: false,\n\t\t\t\ticon: Alert.Icon.INFO,\n\t\t\t\tsize: Alert.Size.XS,\n\t\t\t\tcloseBtn: false,\n\t\t\t});\n\n\t\t\talert.show();\n\n\t\t\treturn alert.render().outerHTML;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-html=\"alertHtmlString\"></div>\n\t`,\n};\n","import { Hint } from 'ui.vue3.components.hint';\nimport { RoleMasterProgress } from './role-master-progress';\nimport { RoleMasterWarning } from './role-master-warning';\n\nimport '../css/role-master-step.css';\n\nexport const RoleMasterStep = {\n\tname: 'RoleMasterStep',\n\tcomponents: {\n\t\tRoleMasterProgress,\n\t\tRoleMasterWarning,\n\t\tHint,\n\t},\n\tprops: {\n\t\ttitle: String,\n\t\ttitleHint: String,\n\t\tstepNumber: Number,\n\t\twarningText: String,\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__role-master_step\">\n\t\t\t<div class=\"ai__role-master_step-header\">\n\t\t\t\t<div class=\"ai__role-master_step-title-with-hint\">\n\t\t\t\t\t<h4 class=\"ai__role-master_step-title\">{{ title }}</h4>\n\t\t\t\t\t<span v-if=\"titleHint\" class=\"ai__role-master_step-title-hint\">\n\t\t\t\t\t\t<Hint :text=\"titleHint\"></Hint>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ai__role-master_step-progress\">\n\t\t\t\t\t<RoleMasterProgress\n\t\t\t\t\t\t:current=\"stepNumber\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"warningText\" class=\"ai__role-master_step-warning\">\n\t\t\t\t\t<RoleMasterWarning :text=\"warningText\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ai__role-master_step-content\">\n\t\t\t\t<slot></slot>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { RoleMasterEditor } from './role-master-editor';\nimport { RoleMasterStep } from './role-master-step';\nexport const RoleMasterTextStep = {\n\tprops: {\n\t\troleText: String,\n\t\tstepNumber: Number,\n\t\tmaxTextLength: Number,\n\t\tminTextLength: Number,\n\t\twarningText: String,\n\t},\n\tcomponents: {\n\t\tRoleMasterStep,\n\t\tRoleMasterEditor,\n\t},\n\tmethods: {\n\t\thandleRoleTextUpdate(value: string): void {\n\t\t\tthis.$emit('update:role-text', value);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<RoleMasterStep\n\t\t\t:title=\"$Bitrix.Loc.getMessage('ROLE_MASTER_ROLE_TEXT_STEP_TITLE')\"\n\t\t\t:title-hint=\"$Bitrix.Loc.getMessage('ROLE_MASTER_ROLE_TEXT_STEP_TITLE_HINT')\"\n\t\t\t:warningText=\"warningText\"\n\t\t\t:step-number=\"stepNumber\"\n\t\t>\n\t\t\t<slot>\n\t\t\t\t<RoleMasterEditor\n\t\t\t\t\t:text=\"roleText\"\n\t\t\t\t\t@update:text=\"handleRoleTextUpdate\"\n\t\t\t\t\t:max-text-length=\"maxTextLength\"\n\t\t\t\t\t:min-text-length=\"minTextLength\"\n\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('ROLE_MASTER_ROLE_TEXT_FIELD_PLACEHOLDER')\"\n\t\t\t\t></RoleMasterEditor>\n\t\t\t</slot>\n\t\t</RoleMasterStep>\n\t`,\n};\n","import { Button, ButtonState } from 'ui.buttons';\n\nexport const RoleMasterBtn = {\n\tprops: {\n\t\ttext: String,\n\t\tstate: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: Button.Color.AI,\n\t\t},\n\t},\n\tcomputed: {\n\t\tbuttonOuterHtmlString(): string {\n\t\t\tconst button = new Button({\n\t\t\t\ttext: this.text,\n\t\t\t\tstate: this.state,\n\t\t\t\tcolor: this.color,\n\t\t\t\tround: true,\n\t\t\t});\n\n\t\t\treturn button.render().outerHTML;\n\t\t},\n\t\tButtonState(): ButtonState {\n\t\t\treturn ButtonState;\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClick(e: MouseEvent): boolean {\n\t\t\tif (this.state === ButtonState.DISABLED)\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopImmediatePropagation();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t},\n\ttemplate: '<div @click=\"handleClick\" v-html=\"buttonOuterHtmlString\"></div>',\n};\n","import { bind, unbind } from 'main.core';\nimport { Uploader, UploaderError, UploaderEvent, UploaderFile } from 'ui.uploader.core';\nimport { BIcon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport { UI } from 'ui.notification';\nimport { toRaw } from 'ui.vue3';\n\nimport 'ui.icon-set.main';\nimport 'ui.icon-set.actions';\n\nimport '../css/role-master-avatar-uploader.css';\n\nexport const RoleMasterAvatarUploader = {\n\tname: 'RoleMasterAvatarUploader',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tavatarUrl: '',\n\t},\n\temits: ['uploadAvatarFile', 'removeAvatarFile', 'selectAvatar', 'generateAvatar'],\n\tdata(): { isDraggingFile: boolean, uploader: Uploader } {\n\t\treturn {\n\t\t\tuploader: null,\n\t\t\tisDraggingFile: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tavatarUploaderStyle(): Object {\n\t\t\treturn {\n\t\t\t\tbackgroundImage: this.avatarUrl ? `url(${this.avatarUrl})` : null,\n\t\t\t};\n\t\t},\n\t\tIconSet(): IconSet {\n\t\t\treturn IconSet;\n\t\t},\n\n\t},\n\tmethods: {\n\t\thandleDragElementEnterDocument() {\n\t\t\tthis.isDraggingFile = true;\n\t\t},\n\t\thandleDragElementLeaveDocument(event: DragEvent) {\n\t\t\tif (event.relatedTarget === null)\n\t\t\t{\n\t\t\t\tthis.isDraggingFile = false;\n\t\t\t}\n\t\t},\n\t\thandleDropFile(): void {\n\t\t\tthis.isDraggingFile = false;\n\t\t},\n\t\thandleDragOverFile(event: DragEvent): void {\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tshowNotification(message: string): void {\n\t\t\tconst id = String(Math.random() * 1000);\n\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tid,\n\t\t\t\tcontent: message,\n\t\t\t});\n\t\t},\n\t\tremoveUploadedFile(): void {\n\t\t\tconst files: UploaderFile[] = this.uploader.getFiles();\n\n\t\t\tif (files.length > 0)\n\t\t\t{\n\t\t\t\ttoRaw(this.uploader).removeFiles();\n\t\t\t\tthis.$emit('removeAvatarFile');\n\t\t\t}\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.uploader = new Uploader({\n\t\t\tdropElement: this.$refs.dropArea,\n\t\t\tbrowseElement: this.$refs.uploaderContainer,\n\t\t\tassignServerFile: false,\n\t\t\tallowReplaceSingle: true,\n\t\t\tassignAsFile: true,\n\t\t\tacceptOnlyImages: true,\n\t\t\tacceptedFileTypes: ['image/jpeg', 'image/png'],\n\t\t\tmaxFileSize: 1_048_076,\n\t\t\tmultiple: false,\n\t\t\tevents: {\n\t\t\t\t[UploaderEvent.FILE_LOAD_COMPLETE]: (event) => {\n\t\t\t\t\tthis.uploadedFile = event.getData().file;\n\t\t\t\t\tthis.$emit('uploadAvatarFile', event.getData().file);\n\t\t\t\t\tthis.$refs.uploaderContainer.blur();\n\t\t\t\t},\n\t\t\t\t[UploaderEvent.FILE_ERROR]: (event) => {\n\t\t\t\t\tconst error: UploaderError = event.getData().error;\n\t\t\t\t\tthis.showNotification(error.getMessage());\n\t\t\t\t\tthis.$refs.uploaderContainer.blur();\n\t\t\t\t},\n\t\t\t\t[UploaderEvent.FILE_REMOVE]: () => {\n\t\t\t\t\t// TODO don't work this event\n\t\t\t\t\tthis.$emit('removeAvatarFile');\n\t\t\t\t\tthis.$refs.uploaderContainer.blur();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tif (this.avatarUrl)\n\t\t{\n\t\t\tthis.uploader.addFile(0);\n\t\t\tthis.$emit('loadAvatarFile', toRaw(this.uploader.getFiles()[0]));\n\t\t}\n\t\tbind(document, 'dragenter', this.handleDragElementEnterDocument);\n\t\tbind(document, 'dragleave', this.handleDragElementLeaveDocument);\n\t\tbind(document, 'drop', this.handleDropFile);\n\t\tbind(document, 'dragover', this.handleDragOverFile);\n\t},\n\tunmounted() {\n\t\tunbind(document, 'dragenter', this.handleDragElementEnterDocument);\n\t\tunbind(document, 'dragleave', this.handleDragElementLeaveDocument);\n\t\tunbind(document, 'drop', this.handleDropFile);\n\t\tunbind(document, 'dragover', this.handleDragOverFile);\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ai__role-master_avatar-uploader-wrapper\"\n\t\t\t:style=\"avatarUploaderStyle\"\n\t\t>\n\t\t\t<div\n\t\t\t\tv-show=\"!avatarUrl\"\n\t\t\t\tref=\"uploaderContainer\"\n\t\t\t\tclass=\"ai__role-master_avatar-uploader\"\n\t\t\t\t:tabindex=\"0\"\n\t\t\t\t@keyup.enter=\"$event.target.click()\"\n\t\t\t>\n\t\t\t\t<div class=\"ai__role-master_avatar-uploader-icon\">\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\tv-if=\"!avatarUrl\"\n\t\t\t\t\t\t:size=\"28\"\n\t\t\t\t\t\t:name=\"IconSet.CAMERA\"\n\t\t\t\t\t></BIcon>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ai__role-master_avatar-uploader-hover\">\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\tv-if=\"isDraggingFile === false && !avatarUrl\"\n\t\t\t\t\t\t:size=\"24\"\n\t\t\t\t\t\t:name=\"IconSet.EDIT_PENCIL\"\n\t\t\t\t\t></BIcon>\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\tv-else-if=\"isDraggingFile === false && avatarUrl\"\n\t\t\t\t\t\t:size=\"24\"\n\t\t\t\t\t\t:name=\"IconSet.TRASH_BIN\"\n\t\t\t\t\t></BIcon>\n\t\t\t\t</div>\n\t\t\t\t<teleport to=\".ai__role-master-app-container main\">\n\t\t\t\t\t<transition name=\"ai-role-master-drop-area-fade\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tref=\"dropArea\"\n\t\t\t\t\t\t\tv-show=\"isDraggingFile\"\n\t\t\t\t\t\t\tclass=\"ai__role-master_avatar-uploader-drop-area\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"ai__role-master_avatar-uploader-drop-area-icon\">\n\t\t\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t\t\t:size=\"64\"\n\t\t\t\t\t\t\t\t\t:name=\"IconSet.FILE_UPLOAD\"\n\t\t\t\t\t\t\t\t></BIcon>\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span class=\"ai__role-master_avatar-uploader-drop-area-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_FILE_DROPAREA_TEXT') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</transition>\n\t\t\t\t</teleport>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"ai__role-master_avatar-uploader\"\n\t\t\t\tv-if=\"isDraggingFile === false && avatarUrl\"\n\t\t\t\t@click=\"removeUploadedFile\"\n\t\t\t>\n\t\t\t\t<div class=\"ai__role-master_avatar-uploader-hover\">\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:size=\"24\"\n\t\t\t\t\t\t:name=\"IconSet.TRASH_BIN\"\n\t\t\t\t\t></BIcon>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { bind, Dom, Event } from 'main.core';\nimport { Popup } from 'main.popup';\nimport '../css/role-master-hint.css';\n\nexport const clickableHint = {\n\tbeforeMount(bindElement: HTMLElement, bindings: string): void {\n\t\tlet popup: Popup = null;\n\t\tlet isMouseOnHintPopup = false;\n\n\t\tconst destroyPopup = () => {\n\t\t\tpopup?.destroy();\n\t\t\tpopup = null;\n\t\t\tisMouseOnHintPopup = false;\n\t\t};\n\n\t\tEvent.bind(bindElement, 'mouseenter', () => {\n\t\t\tif (popup === null)\n\t\t\t{\n\t\t\t\tpopup = createHintPopup(bindElement, bindings.value);\n\t\t\t\tpopup.show();\n\t\t\t\tEvent.bind(popup.getPopupContainer(), 'mouseenter', () => {\n\t\t\t\t\tisMouseOnHintPopup = true;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tEvent.bind(bindElement, 'mouseleave', () => {\n\t\t\tconst popupContainer = popup?.getPopupContainer();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (isMouseOnHintPopup)\n\t\t\t\t{\n\t\t\t\t\tbind(popupContainer, 'mouseleave', (e: MouseEvent) => {\n\t\t\t\t\t\tif (bindElement.contains(e.relatedTarget) === false)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdestroyPopup();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdestroyPopup();\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t});\n\t},\n};\n\nfunction createHintPopup(bindElement: HTMLElement, html: string): Popup\n{\n\tconst bindElementPosition = Dom.getPosition(bindElement);\n\n\treturn new Popup({\n\t\tbindElement: {\n\t\t\ttop: bindElementPosition.top + 10,\n\t\t\tleft: bindElementPosition.left + bindElementPosition.width / 2,\n\t\t},\n\t\tclassName: 'ai__role-master_hint-popup',\n\t\tdarkMode: true,\n\t\tcontent: html,\n\t\tmaxWidth: 266,\n\t\tmaxHeight: 300,\n\t\tanimation: 'fading-slide',\n\t\tangle: true,\n\t\tbindOptions: {\n\t\t\tposition: 'top',\n\t\t},\n\t});\n}\n","import { bind, Text } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { BaseEvent } from 'main.core.events';\nimport { Dialog, Item } from 'ui.entity-selector';\n\nimport '../css/role-master-user-selector.css';\n\nimport { clickableHint } from '../directives/role-master-hover-hint';\n\ntype RoleMasterUserSelectorSelectedItemWithData = {\n\tentityId: string;\n\tid: string | number;\n\ttitle?: string;\n\tavatar?: string;\n}\n\ntype RoleMasterUserSelectorSelectedItem = [string, string | number];\n\nexport const RoleMasterUserSelector = {\n\tdirectives: {\n\t\tclickableHint,\n\t},\n\tevents: [\n\t\t'update:selected-items',\n\t],\n\tprops: {\n\t\tselectedItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => {\n\t\t\t\treturn [];\n\t\t\t},\n\t\t},\n\t\tmaxCirclesInInput: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 8,\n\t\t},\n\t\tundeselectedItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => {\n\t\t\t\treturn [];\n\t\t\t},\n\t\t},\n\t},\n\tdata(): { etcItemHint: Popup } {\n\t\treturn {\n\t\t\tetcItemHint: null,\n\t\t\tcursorOnEtcItem: false,\n\t\t\tselectedItemsWithData: [],\n\t\t\tdataIsLoaded: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpreselectedItems(): Array<string, string | number> {\n\t\t\treturn this.typedSelectedItems.map((item) => {\n\t\t\t\treturn item;\n\t\t\t});\n\t\t},\n\t\ttypedSelectedItems(): RoleMasterUserSelectorSelectedItem[] {\n\t\t\treturn this.selectedItems;\n\t\t},\n\t\tetcItemHintContent(): Object {\n\t\t\tconst titles = this.selectedItemsWithData\n\t\t\t\t.slice(this.maxCirclesInInput)\n\t\t\t\t.map((item) => this.getEncodedString(item.title));\n\n\t\t\tconst titlesText = titles.join('<br>');\n\n\t\t\treturn `<div>${titlesText}</div>`;\n\t\t},\n\t\tetcSelectedItemsCount(): number {\n\t\t\treturn this.selectedItems.slice(this.maxCirclesInInput).length;\n\t\t},\n\t\tetcSelectedItemsCircleNumber(): number {\n\t\t\treturn this.etcSelectedItemsCount < 100 ? this.etcSelectedItemsCount : 99;\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateSelectedItemsWithData(): void {\n\t\t\tconst selectedItems = this.getUserSelectorDialog().getSelectedItems();\n\n\t\t\tif (selectedItems.length === this.selectedItemsWithData.length)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.selectedItemsWithData = selectedItems.map((item) => {\n\t\t\t\treturn this.getSelectedItemsWithDataFromDialogItem(item);\n\t\t\t});\n\t\t},\n\t\tgetSelectedItemsWithDataFromDialogItem(item: Item): RoleMasterUserSelectorSelectedItemWithData {\n\t\t\treturn {\n\t\t\t\tid: item.id,\n\t\t\t\tavatar: item.avatar,\n\t\t\t\tentityId: item.entityId,\n\t\t\t\ttitle: item.title.text,\n\t\t\t};\n\t\t},\n\t\tgetUserSelectorDialog(): Dialog {\n\t\t\tconst existingDialog = Dialog.getById('ai-role-master-user-selector');\n\n\t\t\tif (existingDialog)\n\t\t\t{\n\t\t\t\texistingDialog.setTargetNode(this.$refs.userSelector);\n\n\t\t\t\treturn existingDialog;\n\t\t\t}\n\n\t\t\treturn new Dialog({\n\t\t\t\tid: 'ai-role-master-user-selector',\n\t\t\t\ttargetNode: this.$refs.userSelector,\n\t\t\t\twidth: 400,\n\t\t\t\theight: 300,\n\t\t\t\tdropdownMode: false,\n\t\t\t\tshowAvatars: true,\n\t\t\t\tcompactView: true,\n\t\t\t\tmultiple: true,\n\t\t\t\tpreload: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tpreselectedItems: this.preselectedItems,\n\t\t\t\tundeselectedItems: this.undeselectedItems,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.selectItem(event.getData().item);\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onDeselect': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.deselectItem(event.getData().item);\n\t\t\t\t\t},\n\t\t\t\t\tonLoad: (): void => {\n\t\t\t\t\t\tthis.dataIsLoaded = true;\n\t\t\t\t\t\tthis.updateSelectedItemsWithData();\n\t\t\t\t\t},\n\t\t\t\t\tonHide: () => {\n\t\t\t\t\t\tthis.$refs.addBtn.focus();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tshowUserSelector(): void {\n\t\t\tconst dialog = this.getUserSelectorDialog();\n\n\t\t\tdialog.show();\n\t\t},\n\t\tselectItem(item: Item): void {\n\t\t\tthis.$emit('update:selected-items', this.getDialogSelectedItems());\n\t\t},\n\t\tdeselectItem(item: Item): void {\n\t\t\tthis.$emit('update:selected-items', this.getDialogSelectedItems());\n\t\t},\n\t\tgetDialogSelectedItems(): Array {\n\t\t\treturn this.getUserSelectorDialog().getSelectedItems().map((item) => {\n\t\t\t\treturn [\n\t\t\t\t\titem.entityId,\n\t\t\t\t\titem.getId(),\n\t\t\t\t];\n\t\t\t});\n\t\t},\n\t\tgetSelectedItemStyle(item: Object, index: number): Object {\n\t\t\tconst backgroundImage = `url('${this.getAvatarFromItem(item)}')`;\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage,\n\t\t\t\tleft: `${index > 0 ? 24 * index : 0}px`,\n\t\t\t};\n\t\t},\n\t\tgetAvatarFromItem(item: RoleMasterUserSelectorSelectedItemWithData): string {\n\t\t\tif (item.avatar)\n\t\t\t{\n\t\t\t\treturn item.avatar;\n\t\t\t}\n\n\t\t\tif (item.entityId === 'user')\n\t\t\t{\n\t\t\t\treturn '/bitrix/js/socialnetwork/entity-selector/src/images/default-user.svg';\n\t\t\t}\n\n\t\t\tif (item.entityId === 'meta-user')\n\t\t\t{\n\t\t\t\treturn '/bitrix/js/socialnetwork/entity-selector/src/images/meta-user-all.svg';\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tgetDepartmentFirstLetter(title: string): string {\n\t\t\treturn title.split(' ')[0][0].toUpperCase();\n\t\t},\n\t\tshowEtcItemsHint(): void {\n\t\t\tthis.cursorOnEtcItem = true;\n\t\t\tif (this.etcItemHint)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.etcItemHint = new Popup({\n\t\t\t\tbindElement: this.$refs.etcItem,\n\t\t\t\tdarkMode: true,\n\t\t\t\tcontent: this.etcItemHintContent,\n\t\t\t\tautoHide: true,\n\t\t\t\tmaxHeight: 300,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tangle: true,\n\t\t\t});\n\n\t\t\tthis.etcItemHint.setOffset({\n\t\t\t\toffsetTop: -10,\n\t\t\t\toffsetLeft: 16,\n\t\t\t});\n\n\t\t\tthis.etcItemHint.show();\n\t\t},\n\t\tcloseEtcItemsHint(): void {\n\t\t\tthis.cursorOnEtcItem = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst hoveredItems = document.querySelectorAll(':hover');\n\t\t\t\tconst lastHoveredItem = hoveredItems[hoveredItems.length - 1];\n\n\t\t\t\tconst popupContainer = this.etcItemHint.getPopupContainer();\n\t\t\t\tconst isHintPopupUnderCursor = popupContainer.contains(lastHoveredItem);\n\n\t\t\t\tif (isHintPopupUnderCursor === false)\n\t\t\t\t{\n\t\t\t\t\tthis.destroyEtcItemsHint();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tbind(popupContainer, 'mouseleave', () => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tif (this.cursorOnEtcItem === false)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.destroyEtcItemsHint();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 100);\n\t\t\t\t});\n\t\t\t}, 100);\n\t\t},\n\t\tdestroyEtcItemsHint(): void {\n\t\t\tthis.etcItemHint?.destroy();\n\t\t\tthis.etcItemHint = null;\n\t\t},\n\t\tgetEncodedString(str: string): string {\n\t\t\treturn Text.encode(str);\n\t\t},\n\t},\n\twatch: {\n\t\t'selectedItems.length': function() {\n\t\t\tthis.updateSelectedItemsWithData();\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.updateSelectedItemsWithData();\n\t},\n\tunmounted() {\n\t\tthis.getUserSelectorDialog().destroy();\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__role-master_user-selector\">\n\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t<div\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t>\n\t\t\t\t\t<div ref=\"userSelector\" class=\"ai__role-master_user-selector_inner\">\n\t\t\t\t\t\t<ul class=\"ai__role-master-user-selector_users\">\n\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\tv-for=\"(item, index) in selectedItemsWithData.slice(0, maxCirclesInInput)\"\n\t\t\t\t\t\t\t\t:style=\"getSelectedItemStyle(item, index)\"\n\t\t\t\t\t\t\t\tv-clickable-hint=\"getEncodedString(item.title)\"\n\t\t\t\t\t\t\t\tclass=\"ai__role-master-user-selector_user\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span v-if=\"item.entityId === 'department'\">\n\t\t\t\t\t\t\t\t\t{{ getDepartmentFirstLetter(item.title) }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\tv-if=\"etcSelectedItemsCount > 0\"\n\t\t\t\t\t\t\t\tref=\"etcItem\"\n\t\t\t\t\t\t\t\tclass=\"ai__role-master-user-selector_etc-item\"\n\t\t\t\t\t\t\t\t@mouseenter=\"showEtcItemsHint\"\n\t\t\t\t\t\t\t\t@mouseleave=\"closeEtcItemsHint\"\n\t\t\t\t\t\t\t\t:style=\"{left: 24 * this.maxCirclesInInput - 8 + 'px'}\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span class=\"ai__role-master-user-selector_etc-item-plus\">+</span>\n\t\t\t\t\t\t\t\t<span>{{ etcSelectedItemsCircleNumber }}</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<button ref=\"addBtn\" @click=\"showUserSelector\" class=\"ai__role-master-user-selector_add\">\n\t\t\t\t\t\t\t<span class=\"ai__role-master-user-selector_add-text\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_USER_SELECTOR_ADD_BTN') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"getUserSelectorDialog().getItems().length === 99999\" class=\"ai__role-master_user-selector-loader\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t<div\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"ai__role-master_user-selector_inner\">\n\t\t\t\t\t\t\t<ul class=\"ai__role-master-user-selector_users\">\n\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\tv-for=\"(item, index) in selectedItems.slice(0, maxCirclesInInput)\"\n\t\t\t\t\t\t\t\t\t:style=\"getSelectedItemStyle(item, index)\"\n\t\t\t\t\t\t\t\t\tclass=\"ai__role-master-user-selector_user\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span v-if=\"item.entityId === 'department'\">\n\t\t\t\t\t\t\t\t\t{{ getDepartmentFirstLetter(item.title) }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\tv-if=\"etcSelectedItemsCount > 0\"\n\t\t\t\t\t\t\t\t\tclass=\"ai__role-master-user-selector_etc-item\"\n\t\t\t\t\t\t\t\t\t:style=\"{left: 24 * this.maxCirclesInInput - 8 + 'px'}\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<span class=\"ai__role-master-user-selector_etc-item-plus\">+</span>\n\t\t\t\t\t\t\t\t\t<span>{{ etcSelectedItemsCircleNumber }}</span>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import 'ui.layout-form';\nimport type { UploaderFile } from 'ui.uploader.core';\n\nimport { RoleMasterAvatarUploader } from './role-master-avatar-uploader';\nimport { RoleMasterStep } from './role-master-step';\nimport { RoleMasterUserSelector } from './role-master-user-selector';\nimport { RoleMasterEditor } from './role-master-editor';\n\nimport '../css/role-master-main-step.css';\n\nexport const RoleMasterMainStep = {\n\tcomponents: {\n\t\tRoleMasterStep,\n\t\tRoleMasterUserSelector,\n\t\tRoleMasterAvatarUploader,\n\t\tRoleMasterEditor,\n\t},\n\temits: ['uploadAvatarFile', 'removeAvatarFile', 'update:name', 'update:description', 'update:items-with-access'],\n\tprops: {\n\t\tstepNumber: Number,\n\t\tavatar: String,\n\t\tname: String,\n\t\tdescription: String,\n\t\titemsWithAccess: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => {\n\t\t\t\treturn [];\n\t\t\t},\n\t\t},\n\t\tundeselectedItemsWithAccess: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => {\n\t\t\t\treturn [];\n\t\t\t},\n\t\t},\n\t},\n\tmethods: {\n\t\thandleAvatarFileUpload(file: UploaderFile): void\n\t\t{\n\t\t\tthis.$emit('uploadAvatarFile', file);\n\t\t},\n\t\thandleAvatarFileRemove(): void\n\t\t{\n\t\t\tthis.$emit('removeAvatarFile');\n\t\t},\n\t\thandleAvatarFileLoad(file: UploaderFile): void\n\t\t{\n\t\t\tthis.$emit('loadAvatarFile', file);\n\t\t},\n\t},\n\tmounted() {\n\t\trequestAnimationFrame(() => {\n\t\t\tthis.$refs.roleNameInput.focus();\n\t\t});\n\t},\n\ttemplate: `\n\t\t<RoleMasterStep\n\t\t\t:title=\"$Bitrix.Loc.getMessage('ROLE_MASTER_ROLE_MAIN_STEP_TITLE')\"\n\t\t\t:step-number=\"stepNumber\"\n\t\t>\n\t\t\t<slot>\n\t\t\t\t<div class=\"ai__role-master_main-step\">\n\t\t\t\t\t<div class=\"ui-form\">\n\t\t\t\t\t\t<div class=\"ui-form-row-inline\">\n\t\t\t\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_ROLE_AVATAR_AND_NAME_FIELD') }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl\">\n\t\t\t\t\t\t\t\t\t\t<RoleMasterAvatarUploader\n\t\t\t\t\t\t\t\t\t\t\t:avatar-url=\"avatar\"\n\t\t\t\t\t\t\t\t\t\t\t@upload-avatar-file=\"handleAvatarFileUpload\"\n\t\t\t\t\t\t\t\t\t\t\t@remove-avatar-file=\"handleAvatarFileRemove\"\n\t\t\t\t\t\t\t\t\t\t\t@load-avatar-file=\"handleAvatarFileLoad\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\tref=\"roleNameInput\"\n\t\t\t\t\t\t\t\t\t\t\t:value=\"name\"\n\t\t\t\t\t\t\t\t\t\t\t@input=\"$emit('update:name', $event.target.value)\"\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\t:minlength=\"1\"\n\t\t\t\t\t\t\t\t\t\t\t:maxlength=\"70\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('ROLE_MASTER_ROLE_AVATAR_AND_NAME_FIELD_PLACEHOLDER')\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_ROLE_USERS_WITH_ACCESS_FIELD') }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t\t\t\t\t<RoleMasterUserSelector\n\t\t\t\t\t\t\t\t\t\t:selected-items=\"itemsWithAccess\"\n\t\t\t\t\t\t\t\t\t\t:undeselected-items=\"undeselectedItemsWithAccess\"\n\t\t\t\t\t\t\t\t\t\t@update:selected-items=\"items => $emit('update:items-with-access', items)\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-form-row --with-textarea\">\n\t\t\t\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_ROLE_DESCRIPTION_FIELD') }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea ui-ctl-w100 ui-ctl-no-resize\">\n\t\t\t\t\t\t\t\t\t<RoleMasterEditor\n\t\t\t\t\t\t\t\t\t\t:min-text-length=\"0\"\n\t\t\t\t\t\t\t\t\t\t:max-text-length=\"150\"\n\t\t\t\t\t\t\t\t\t\t:text=\"description\"\n\t\t\t\t\t\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('ROLE_MASTER_ROLE_DESCRIPTION_FIELD_PLACEHOLDER')\"\n\t\t\t\t\t\t\t\t\t\t@update:text=\"$emit('update:description', $event)\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</slot>\n\t\t</RoleMasterStep>\n\t`,\n};\n","import { ButtonColor } from 'ui.buttons';\nimport { RoleSavingStatus } from './role-master';\nimport { RoleMasterBtn } from './role-master-btn';\nimport { Loader } from 'main.loader';\nimport { BIcon, Set as IconSet } from 'ui.icon-set.api.vue';\n\n// ButtonColor.LIGHT_BORDER\nimport 'ui.icon-set.main';\n\nimport '../css/role-master-saving-status.css';\n\nexport const RoleMasterSavingStatus = {\n\tprops: {\n\t\tstatus: String,\n\t},\n\temits: ['repeat-request', 'back-to-editor', 'close-master'],\n\tcomponents: {\n\t\tBIcon,\n\t\tRoleMasterBtn,\n\t},\n\tcomputed: {\n\t\tsavingStatus(): RoleSavingStatus {\n\t\t\treturn RoleSavingStatus;\n\t\t},\n\t\tIconSet(): IconSet {\n\t\t\treturn IconSet;\n\t\t},\n\t\tButtonColor(): ButtonColor {\n\t\t\treturn ButtonColor;\n\t\t},\n\t},\n\tmethods: {\n\t\tshowLoader(): void {\n\t\t\tconst loader = new Loader({\n\t\t\t\tsize: 80,\n\t\t\t\tcolor: getComputedStyle(document.body).getPropertyValue('--ui-color-copilot-primary') ?? '#8e52ec',\n\t\t\t\tstrokeWidth: 4,\n\t\t\t});\n\n\t\t\tloader.show(this.$refs.loaderContainer);\n\t\t},\n\t},\n\tmounted(): void {\n\t\tif (this.status === RoleSavingStatus.SAVING)\n\t\t{\n\t\t\tthis.showLoader();\n\t\t}\n\t},\n\tupdated(): void {\n\t\tif (this.status === RoleSavingStatus.SAVING)\n\t\t{\n\t\t\tthis.showLoader();\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__role-master_saving-status\">\n\t\t\t<div v-if=\"status === savingStatus.SAVING\" class=\"ai__role-master_saving-loading\">\n\t\t\t\t<div ref=\"loaderContainer\" class=\"ai__role-master_saving-loader\"></div>\n\t\t\t\t<div class=\"ai__role-master_saving-loading-text\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_LOADER_TEXT') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-else-if=\"status === savingStatus.SAVING_SUCCESS\" class=\"ai__role-master_saving-success\">\n\t\t\t\t<div class=\"ai__role-master_saving-success-top\">\n\t\t\t\t\t<div class=\"ai__role-master_saving-success-icon\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"IconSet.CHECK\"\n\t\t\t\t\t\t\t:size=\"58\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ai__role-master_saving-success-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_SAVING_DONE') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ai__role-master_saving-success-bottom\">\n\t\t\t\t\t<RoleMasterBtn\n\t\t\t\t\t\t@click=\"$emit('close-master')\"\n\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('ROLE_MASTER_CLOSE_BTN')\"\n\t\t\t\t\t\t:color=\"ButtonColor.LIGHT_BORDER\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-else-if=\"status === savingStatus.SAVING_ERROR\" class=\"ai__role-master_saving-error\">\n\t\t\t\t<div class=\"ai__role-master_saving-error-center\">\n\t\t\t\t\t<div class=\"ai__role-master_saving-error-icon\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"IconSet.NOTE_CIRCLE\"\n\t\t\t\t\t\t\t:size=\"66\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ai__role-master_saving-error-status-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_SAVE_PROMPT_ON_ERROR_SHORT_TEXT') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<RoleMasterBtn\n\t\t\t\t\t\t@click=\"$emit('repeat-request')\"\n\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('ROLE_MASTER_REPEAT_REQUEST_BTN')\"\n\t\t\t\t\t\t:color=\"ButtonColor.LIGHT_BORDER\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ai__role-master_saving-error-bottom\">\n\t\t\t\t\t<p class=\"ai__role-master_saving-error-description-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_SAVE_PROMPT_ON_ERROR_TEXT') }}\n\t\t\t\t\t</p>\n\t\t\t\t\t<button\n\t\t\t\t\t\t@click=\"$emit('back-to-editor')\"\n\t\t\t\t\t\tclass=\"ai__role-master_back-to-editor-btn\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:size=\"16\"\n\t\t\t\t\t\t\t:name=\"IconSet.CHEVRON_LEFT\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span class=\"ai__role-master_back-to-editor-btn-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_BACK_TO_EDITOR_BTN') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export async function loadImageAsFile(imgPath: string): Promise<File>\n{\n\tconst fileName = imgPath.split('/').pop();\n\tconst response = await fetch(imgPath);\n\tconst mimeType = response.headers.get('Content-Type') || 'application/octet-stream';\n\n\tconst data = await response.blob();\n\tconst blob = new Blob([data], { type: mimeType });\n\n\treturn new File([blob], fileName, { type: mimeType });\n}","import { Reflection, Extension, ajax, Http } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport type { UploaderFile } from 'ui.uploader.core';\nimport { RoleMasterTextStep } from './role-master-text-step';\nimport { RoleMasterBtn } from './role-master-btn';\nimport { RoleMasterMainStep } from './role-master-main-step';\nimport { RoleMasterSavingStatus } from './role-master-saving-status';\nimport { RoleMasterWarning } from './role-master-warning';\nimport { ButtonState } from 'ui.buttons';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Actions } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.actions';\nimport { toRaw } from 'ui.vue3';\nimport { loadImageAsFile } from '../helpers';\n\nconst currentUserId = Extension.getSettings('ai.role-master').get('currentUserId');\n\ntype RoleMasterData = {\n\tcurrentStepNumber: number;\n\troleText: string;\n\troleName: string;\n\troleAvatar: string;\n\troleDescription: string;\n\troleItemsWithAccess: [];\n\tuploadedAvatarFile: UploaderFile;\n}\n\nexport const RoleSavingStatus = Object.freeze({\n\tNONE: 'none',\n\tSAVING: 'saving',\n\tSAVING_ERROR: 'saving-error',\n\tSAVING_SUCCESS: 'saving-success',\n});\n\nexport const RoleMaster = {\n\tname: 'RoleMaster',\n\tcomponents: {\n\t\tRoleMasterTextStep,\n\t\tRoleMasterMainStep,\n\t\tRoleMasterSavingStatus,\n\t\tRoleMasterBtn,\n\t\tRoleMasterWarning,\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tauthorId: String,\n\t\ttext: String,\n\t\tname: String,\n\t\tavatar: String,\n\t\tdescription: String,\n\t\tavatarUrl: String,\n\t\titemsWithAccess: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => [],\n\t\t},\n\t},\n\tdata(): RoleMasterData {\n\t\treturn {\n\t\t\tcurrentStepNumber: 1,\n\t\t\troleText: this.text,\n\t\t\troleName: this.name,\n\t\t\troleAvatar: this.avatar,\n\t\t\troleAvatarUrl: this.avatarUrl,\n\t\t\troleDescription: this.description,\n\t\t\troleItemsWithAccess: this.itemsWithAccess.length > 0 ? this.itemsWithAccess : [['user', currentUserId]],\n\t\t\tuploadedAvatarFile: null,\n\t\t\troleSavingStatus: RoleSavingStatus.NONE,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisEditRoleMode(): boolean {\n\t\t\treturn this.id;\n\t\t},\n\t\tmaxTextLength(): number {\n\t\t\treturn 2000;\n\t\t},\n\t\tminTextLength(): number {\n\t\t\treturn 1;\n\t\t},\n\t\tisEditMode(): boolean {\n\t\t\treturn false;\n\t\t},\n\t\tuploadedAvatarFilePreview(): ?string {\n\t\t\treturn this.uploadedAvatarFile?.getPreviewUrl() ?? null;\n\t\t},\n\t\tRoleSavingStatus(): typeof RoleSavingStatus {\n\t\t\treturn RoleSavingStatus;\n\t\t},\n\t\tButtonState(): ButtonState {\n\t\t\treturn ButtonState;\n\t\t},\n\t\tisRoleTextValid(): boolean {\n\t\t\treturn this.roleText.length >= this.minTextLength && this.roleText.length <= this.maxTextLength;\n\t\t},\n\t\tisRoleNameValid(): boolean {\n\t\t\treturn this.roleName.length > 0 && this.roleName.length <= 70;\n\t\t},\n\t\tisRoleDescriptionValid(): boolean {\n\t\t\treturn this.roleDescription.length > 0 && this.roleDescription.length <= 150;\n\t\t},\n\t\tisRoleDataValid(): boolean {\n\t\t\treturn this.isRoleTextValid\n\t\t\t\t&& this.isRoleNameValid\n\t\t\t\t&& this.isRoleDescriptionValid\n\t\t\t\t&& this.roleItemsWithAccess.length > 0\n\t\t\t;\n\t\t},\n\t\tnextStepBtnState(): string {\n\t\t\treturn this.isRoleTextValid ? '' : this.ButtonState.DISABLED;\n\t\t},\n\t\tsaveBtnState(): string {\n\t\t\tif (this.isRoleDataValid === false)\n\t\t\t{\n\t\t\t\treturn ButtonState.DISABLED;\n\t\t\t}\n\n\t\t\tif (this.roleSavingStatus === RoleSavingStatus.SAVING)\n\t\t\t{\n\t\t\t\treturn ButtonState.CLOCKING;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tbackIconProps(): { size: number, icon: string } {\n\t\t\treturn {\n\t\t\t\tsize: 16,\n\t\t\t\ticon: Actions.CHEVRON_LEFT,\n\t\t\t};\n\t\t},\n\t\twarningText(): string {\n\t\t\treturn this.isEditRoleMode && this.itemsWithAccess.length > 1 ? this.$Bitrix.Loc.getMessage('ROLE_MASTER_EDIT_WARNING_TEXT') : '';\n\t\t},\n\t\tundeselectedItemsWithAccess(): Array\n\t\t{\n\t\t\tif (this.isEditRoleMode)\n\t\t\t{\n\t\t\t\treturn [['user', this.authorId]];\n\t\t\t}\n\n\t\t\treturn [['user', currentUserId]];\n\t\t},\n\t},\n\tmethods: {\n\t\tasync saveRole(): Promise<void>\n\t\t{\n\t\t\tconst action = this.isEditRoleMode ? 'change' : 'create';\n\n\t\t\tlet isLoadFinished = false;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (isLoadFinished === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.roleSavingStatus = RoleSavingStatus.SAVING;\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t\tconst roleAvatar = await this.getAvatarFile();\n\n\t\t\t\tconst data = {\n\t\t\t\t\troleText: this.roleText,\n\t\t\t\t\troleTitle: this.roleName,\n\t\t\t\t\troleAvatar,\n\t\t\t\t\troleAvatarUrl: this.roleAvatarUrl,\n\t\t\t\t\troleDescription: this.roleDescription,\n\t\t\t\t\taccessCodes: this.roleItemsWithAccess,\n\t\t\t\t};\n\n\t\t\t\tif (action === 'change')\n\t\t\t\t{\n\t\t\t\t\tdata.roleCode = this.id;\n\t\t\t\t}\n\n\t\t\t\tawait ajax.runAction(\n\t\t\t\t\t`ai.shareRole.${action}`,\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: Http.Data.convertObjectToFormData(data),\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tthis.roleSavingStatus = RoleSavingStatus.SAVING_SUCCESS;\n\t\t\t\tEventEmitter.emit('AI.RoleMasterApp:Save-success', data);\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tconsole.error(e);\n\t\t\t\tthis.roleSavingStatus = RoleSavingStatus.SAVING_ERROR;\n\t\t\t\tEventEmitter.emit('AI.RoleMasterApp:Save-failed');\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tisLoadFinished = true;\n\t\t\t}\n\t\t},\n\t\tasync getAvatarFile(): File | Promise<File> | string {\n\t\t\tif (!this.uploadedAvatarFile)\n\t\t\t{\n\t\t\t\tconst pathToDefaultAvatar = '/bitrix/js/ai/role-master/images/role-master-default-avatar.svg';\n\n\t\t\t\treturn loadImageAsFile(pathToDefaultAvatar);\n\t\t\t}\n\n\t\t\tif (!this.uploadedAvatarFile.getBinary())\n\t\t\t{\n\t\t\t\treturn this.avatarUrl;\n\t\t\t}\n\n\t\t\treturn this.uploadedAvatarFile.getBinary();\n\t\t},\n\t\thandleAvatarFileUpload(file: UploaderFile): void {\n\t\t\tthis.uploadedAvatarFile = file;\n\t\t},\n\t\thandleAvatarFileRemove(): void {\n\t\t\tthis.uploadedAvatarFile = null;\n\t\t\tthis.roleAvatar = null;\n\t\t},\n\t\thandleAvatarFileLoad(file: UploaderFile): void\n\t\t{\n\t\t\tthis.uploadedAvatarFile = toRaw(file);\n\t\t},\n\t\tcloseMaster(): void {\n\t\t\tEventEmitter.emit('AI.RoleMasterApp:Close');\n\t\t},\n\t\tbackToEditor(): void {\n\t\t\tthis.roleSavingStatus = RoleSavingStatus.NONE;\n\t\t},\n\t\topenHelpdeskSlider(): void\n\t\t{\n\t\t\tconst articleCode = '23184474';\n\n\t\t\tconst Helper = Reflection.getClass('top.BX.Helper');\n\n\t\t\tif (Helper)\n\t\t\t{\n\t\t\t\tHelper.show(`redirect=detail&code=${articleCode}`);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<header></header>\n\t\t\t<main>\n\t\t\t\t<RoleMasterTextStep\n\t\t\t\t\tv-if=\"currentStepNumber === 1\"\n\t\t\t\t\t:step-number=\"1\"\n\t\t\t\t\t:role-text=\"roleText\"\n\t\t\t\t\t:warning-text=\"warningText\"\n\t\t\t\t\t@update:role-text=\"roleText = $event\"\n\t\t\t\t\t:max-text-length=\"maxTextLength\"\n\t\t\t\t\t:min-text-length=\"minTextLength\"\n\t\t\t\t/>\n\t\t\t\t<RoleMasterMainStep\n\t\t\t\t\tv-if=\"currentStepNumber === 2\"\n\t\t\t\t\t:step-number=\"2\"\n\t\t\t\t\t:name=\"roleName\"\n\t\t\t\t\t:description=\"roleDescription\"\n\t\t\t\t\t:avatar=\"uploadedAvatarFilePreview || roleAvatar\"\n\t\t\t\t\t:items-with-access=\"roleItemsWithAccess\"\n\t\t\t\t\t:undeselected-items-with-access=\"undeselectedItemsWithAccess\"\n\t\t\t\t\t@upload-avatar-file=\"handleAvatarFileUpload\"\n\t\t\t\t\t@remove-avatar-file=\"handleAvatarFileRemove\"\n\t\t\t\t\t@load-avatar-file=\"handleAvatarFileLoad\"\n\t\t\t\t\t@update:name=\"roleName = $event\"\n\t\t\t\t\t@update:description=\"roleDescription = $event\"\n\t\t\t\t\t@update:avatar=\"roleAvatar = $event\"\n\t\t\t\t\t@update:items-with-access=\"roleItemsWithAccess = $event\"\n\t\t\t\t/>\n\t\t\t</main>\n\t\t\t<footer class=\"ai__role-master-app_footer\">\n\t\t\t\t<a\n\t\t\t\t\tv-if=\"currentStepNumber === 1\"\n\t\t\t\t\t@click=\"openHelpdeskSlider\"\n\t\t\t\t\tclass=\"ai__role-master_about-link\"\n\t\t\t\t\thref=\"#\"\n\t\t\t\t>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_ABOUT_ROLE_MASTER_LINK') }}\n\t\t\t\t</a>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"currentStepNumber > 1\"\n\t\t\t\t\t@click=\"currentStepNumber -= 1\"\n\t\t\t\t\tclass=\"ai__role-master_back-btn\"\n\t\t\t\t>\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:size=\"backIconProps.size\"\n\t\t\t\t\t\t:name=\"backIconProps.icon\"\n\t\t\t\t\t/>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('ROLE_MASTER_PREV_BUTTON') }}\n\t\t\t\t</button>\n\t\t\t\t<RoleMasterBtn\n\t\t\t\t\tv-if=\"currentStepNumber < 2\"\n\t\t\t\t\t@click=\"currentStepNumber += 1\"\n\t\t\t\t\t:state=\"nextStepBtnState\"\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('ROLE_MASTER_NEXT_BUTTON')\"\n\t\t\t\t/>\n\t\t\t\t<RoleMasterBtn\n\t\t\t\t\tv-else\n\t\t\t\t\t@click=\"saveRole\"\n\t\t\t\t\t:state=\"saveBtnState\"\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('ROLE_MASTER_SAVE_BUTTON')\"\n\t\t\t\t/>\n\t\t\t</footer>\n\n\t\t\t<div v-if=\"roleSavingStatus !== RoleSavingStatus.NONE\" class=\"ai__role-master_saving-status-container\">\n\t\t\t\t<RoleMasterSavingStatus\n\t\t\t\t\t:status=\"roleSavingStatus\"\n\t\t\t\t\t@close-master=\"closeMaster\"\n\t\t\t\t\t@back-to-editor=\"backToEditor\"\n\t\t\t\t\t@repeat-request=\"saveRole\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Tag, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { BitrixVue, VueCreateAppResult } from 'ui.vue3';\nimport { type RoleMasterOptions } from './types';\nimport { RoleMaster as RoleMasterRootComponent } from './components/role-master';\n\nimport './css/role-master.css';\n\nexport const RoleMasterEvents = {\n\tCLOSE: 'close',\n\tSAVE_SUCCESS: 'save-success',\n};\n\nexport class RoleMaster extends EventEmitter\n{\n\t#roleMasterOptions: RoleMasterOptions;\n\t#app: VueCreateAppResult;\n\n\tconstructor(options: RoleMasterOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('AI.RoleMaster');\n\n\t\tthis.#roleMasterOptions = options;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tEventEmitter.subscribe('AI.RoleMasterApp:Close', () => {\n\t\t\tthis.emit(RoleMasterEvents.CLOSE);\n\t\t});\n\t\tEventEmitter.subscribe('AI.RoleMasterApp:Save-success', (event) => {\n\t\t\tthis.emit(RoleMasterEvents.SAVE_SUCCESS, event.getData());\n\t\t});\n\n\t\tconst appContainer = Tag.render`<div class=\"ai__role-master-app-container\"></div>`;\n\t\tthis.#app = BitrixVue.createApp(RoleMasterRootComponent, {\n\t\t\tid: this.#roleMasterOptions.id ?? '',\n\t\t\tauthorId: this.#roleMasterOptions.authorId ?? '',\n\t\t\tname: this.#roleMasterOptions.name ?? '',\n\t\t\ttext: this.#roleMasterOptions.text ?? '',\n\t\t\tdescription: this.#roleMasterOptions?.description ?? '',\n\t\t\tavatar: this.#roleMasterOptions?.avatar ?? '',\n\t\t\tavatarUrl: this.#roleMasterOptions?.avatarUrl ?? '',\n\t\t\titemsWithAccess: this.#roleMasterOptions?.itemsWithAccess ?? [],\n\t\t});\n\n\t\tthis.#app.mount(appContainer);\n\n\t\treturn appContainer;\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#app?.unmount();\n\t}\n\n\tstatic validateOptions(options: RoleMasterOptions)\n\t{\n\t\tif (!options)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (options && Type.isObject(options) === false)\n\t\t{\n\t\t\tthrow new Error('AI.RoleMaster: options must be the object');\n\t\t}\n\n\t\tif (options.id && Type.isStringFilled(options.id) === false)\n\t\t{\n\t\t\tthrow new Error('AI.RoleMaster: id option must be the filled string');\n\t\t}\n\n\t\tif (options.text && Type.isStringFilled(options.text) === false)\n\t\t{\n\t\t\tthrow new Error('AI.RoleMaster: roleText option must be the filled string');\n\t\t}\n\n\t\tif (options.avatar && Type.isStringFilled(options.avatar) === false)\n\t\t{\n\t\t\tthrow new Error('AI.RoleMaster: avatar option must be the url string');\n\t\t}\n\n\t\tif (options.avatarUrl && Type.isStringFilled(options.avatar) === false)\n\t\t{\n\t\t\tthrow new Error('AI.RoleMaster: avatar option must be the url string');\n\t\t}\n\n\t\tif (options.description && Type.isStringFilled(options.description) === false)\n\t\t{\n\t\t\tthrow new Error('AI.RoleMaster: description option must be the filled string');\n\t\t}\n\n\t\tif (options.name && Type.isStringFilled(options.name) === false)\n\t\t{\n\t\t\tthrow new Error('AI.RoleMaster: name option must be the filled string');\n\t\t}\n\n\t\tif (options.itemsWithAccess && Type.isArrayFilled(options.itemsWithAccess) === false)\n\t\t{\n\t\t\tthrow new Error('AI.RoleMaster: users option must be the array.');\n\t\t}\n\t}\n}\n","import { Tag, Loc, Event, bind } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { RoleMaster, RoleMasterEvents } from './role-master';\nimport type { RoleMasterOptions } from './types';\n\nimport './css/role-master-popup.css';\nimport { Runtime } from 'main.core';\nimport type { AnalyticsOptions } from 'ui.analytics';\nexport type RoleMasterPopupOptions = {\n\troleMaster: RoleMasterOptions;\n}\n\nexport const RoleMasterPopupEvents = Object.freeze({\n\tOPEN: 'open',\n\tCANCEL: 'cancel',\n\tSAVE_SUCCESS: 'role-save-success',\n\tSAVE_FAILED: 'role-save-success',\n});\n\nexport class RoleMasterPopup extends Event.EventEmitter\n{\n\t#roleMasterOptions: RoleMasterOptions;\n\t#popup: Popup = null;\n\t#roleMaster: RoleMaster;\n\t#cancelledRoleSavingHandler: Function | null;\n\n\tconstructor(options: RoleMasterPopupOptions = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('AI.RoleMaster');\n\n\t\tthis.#validateOptions(options);\n\n\t\tthis.#roleMasterOptions = options.roleMaster || {};\n\t}\n\n\tasync sendAnalytics(event: string): void\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst { sendData } = await Runtime.loadExtension('ui.analytics');\n\n\t\t\tconst sendDataOptions: AnalyticsOptions = {\n\t\t\t\tevent,\n\t\t\t\tstatus: 'success',\n\t\t\t\ttool: 'ai',\n\t\t\t\tcategory: 'roles_saving',\n\t\t\t};\n\n\t\t\tsendData(sendDataOptions);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error('AI: RolesDialog: Can\\'t send analytics', e);\n\t\t}\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tthis.#popup = this.#initPopup();\n\t\t}\n\t\tthis.sendAnalytics(RoleMasterPopupEvents.OPEN);\n\t\tthis.#cancelledRoleSavingHandler = this.#cancelRoleSavingAnalyticEvent.bind(this);\n\t\tbind(this.#popup.closeIcon, 'click', this.#cancelledRoleSavingHandler);\n\t\tthis.#popup.show();\n\t}\n\n\thide(): void\n\t{\n\t\tthis.#popup?.close();\n\t}\n\n\t#initPopup(): Popup\n\t{\n\t\treturn new Popup({\n\t\t\tid: 'role-master-popup',\n\t\t\twidth: 360,\n\t\t\tminHeight: 592,\n\t\t\tcontent: this.#renderPopupContent(),\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\toverlay: true,\n\t\t\tpadding: 17,\n\t\t\tborderRadius: '12px',\n\t\t\tevents: {\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.#popup = null;\n\t\t\t\t\tthis.#roleMaster.unsubscribeAll(RoleMasterEvents.CLOSE);\n\t\t\t\t\tthis.#roleMaster.unsubscribeAll(RoleMasterEvents.SAVE_SUCCESS);\n\t\t\t\t\tthis.#roleMaster.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#cancelRoleSavingAnalyticEvent()\n\t{\n\t\tthis.sendAnalytics(RoleMasterPopupEvents.CANCEL);\n\t}\n\n\t#renderPopupContent(): HTMLElement\n\t{\n\t\tthis.#roleMaster = new RoleMaster({\n\t\t\t...this.#roleMasterOptions,\n\t\t});\n\n\t\tthis.#roleMaster.subscribeOnce(RoleMasterEvents.CLOSE, () => {\n\t\t\tthis.#popup.close();\n\t\t});\n\t\tthis.#roleMaster.subscribeOnce(RoleMasterEvents.SAVE_SUCCESS, (event) => {\n\t\t\tthis.emit(RoleMasterPopupEvents.SAVE_SUCCESS, event.getData());\n\t\t});\n\n\t\tconst headerText = this.#roleMasterOptions.id === undefined\n\t\t\t? Loc.getMessage('ROLE_MASTER_POPUP_TITLE')\n\t\t\t: Loc.getMessage('ROLE_MASTER_POPUP_TITLE_EDIT_MODE')\n\t\t;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ai__role-master-popup-content\">\n\t\t\t\t<header class=\"ai__role-master-popup-content-header\">\n\t\t\t\t\t${headerText}\n\t\t\t\t</header>\n\t\t\t\t<div class=\"ai__role-master-popup-content-main\">\n\t\t\t\t\t${this.#roleMaster.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#validateOptions(options: RoleMasterPopupOptions): void\n\t{\n\t\tRoleMaster.validateOptions(options.roleMaster);\n\t}\n}\n"],"names":["RoleMasterEditor","props","text","String","maxTextLength","Number","minTextLength","type","required","default","placeholder","emits","computed","textLength","length","methods","handleInput","e","$emit","target","value","mounted","requestAnimationFrame","$refs","textField","focus","template","RoleMasterProgress","current","total","getProgressStepClassname","isActive","RoleMasterWarning","alertHtmlString","alert","Alert","inline","color","Color","WARNING","animated","icon","Icon","INFO","size","Size","XS","closeBtn","show","render","outerHTML","RoleMasterStep","name","components","Hint","title","titleHint","stepNumber","warningText","RoleMasterTextStep","roleText","handleRoleTextUpdate","RoleMasterBtn","state","Button","AI","buttonOuterHtmlString","button","round","ButtonState","handleClick","DISABLED","preventDefault","stopImmediatePropagation","RoleMasterAvatarUploader","BIcon","avatarUrl","data","uploader","isDraggingFile","avatarUploaderStyle","backgroundImage","IconSet","handleDragElementEnterDocument","handleDragElementLeaveDocument","event","relatedTarget","handleDropFile","handleDragOverFile","showNotification","message","id","Math","random","UI","Notification","Center","notify","content","removeUploadedFile","files","getFiles","toRaw","removeFiles","Uploader","dropElement","dropArea","browseElement","uploaderContainer","assignServerFile","allowReplaceSingle","assignAsFile","acceptOnlyImages","acceptedFileTypes","maxFileSize","multiple","events","UploaderEvent","FILE_LOAD_COMPLETE","uploadedFile","getData","file","blur","FILE_ERROR","error","getMessage","FILE_REMOVE","addFile","bind","document","unmounted","unbind","clickableHint","beforeMount","bindElement","bindings","popup","isMouseOnHintPopup","destroyPopup","destroy","Event","createHintPopup","getPopupContainer","popupContainer","setTimeout","contains","html","bindElementPosition","Dom","getPosition","Popup","top","left","width","className","darkMode","maxWidth","maxHeight","animation","angle","bindOptions","position","RoleMasterUserSelector","directives","selectedItems","Array","maxCirclesInInput","undeselectedItems","etcItemHint","cursorOnEtcItem","selectedItemsWithData","dataIsLoaded","preselectedItems","typedSelectedItems","map","item","etcItemHintContent","titles","slice","getEncodedString","titlesText","join","etcSelectedItemsCount","etcSelectedItemsCircleNumber","updateSelectedItemsWithData","getUserSelectorDialog","getSelectedItems","getSelectedItemsWithDataFromDialogItem","avatar","entityId","existingDialog","Dialog","getById","setTargetNode","userSelector","targetNode","height","dropdownMode","showAvatars","compactView","preload","enableSearch","entities","options","inviteEmployeeLink","selectMode","selectItem","deselectItem","onLoad","onHide","addBtn","showUserSelector","dialog","getDialogSelectedItems","getId","getSelectedItemStyle","index","getAvatarFromItem","getDepartmentFirstLetter","split","toUpperCase","showEtcItemsHint","etcItem","autoHide","setOffset","offsetTop","offsetLeft","closeEtcItemsHint","hoveredItems","querySelectorAll","lastHoveredItem","isHintPopupUnderCursor","destroyEtcItemsHint","str","Text","encode","watch","RoleMasterMainStep","description","itemsWithAccess","undeselectedItemsWithAccess","handleAvatarFileUpload","handleAvatarFileRemove","handleAvatarFileLoad","roleNameInput","RoleMasterSavingStatus","status","savingStatus","RoleSavingStatus","ButtonColor","showLoader","loader","Loader","getComputedStyle","body","getPropertyValue","strokeWidth","loaderContainer","SAVING","updated","loadImageAsFile","imgPath","fileName","pop","response","fetch","mimeType","headers","get","blob","Blob","File","currentUserId","Extension","getSettings","Object","freeze","NONE","SAVING_ERROR","SAVING_SUCCESS","RoleMaster","authorId","currentStepNumber","roleName","roleAvatar","roleAvatarUrl","roleDescription","roleItemsWithAccess","uploadedAvatarFile","roleSavingStatus","isEditRoleMode","isEditMode","uploadedAvatarFilePreview","getPreviewUrl","isRoleTextValid","isRoleNameValid","isRoleDescriptionValid","isRoleDataValid","nextStepBtnState","saveBtnState","CLOCKING","backIconProps","Actions","CHEVRON_LEFT","$Bitrix","Loc","saveRole","action","isLoadFinished","getAvatarFile","roleTitle","accessCodes","roleCode","ajax","runAction","Http","Data","convertObjectToFormData","EventEmitter","emit","console","pathToDefaultAvatar","getBinary","closeMaster","backToEditor","openHelpdeskSlider","articleCode","Helper","Reflection","getClass","RoleMasterEvents","CLOSE","SAVE_SUCCESS","constructor","setEventNamespace","subscribe","appContainer","Tag","BitrixVue","createApp","RoleMasterRootComponent","mount","unmount","validateOptions","Type","isObject","Error","isStringFilled","isArrayFilled","RoleMasterPopupEvents","OPEN","CANCEL","SAVE_FAILED","RoleMasterPopup","roleMaster","sendAnalytics","sendData","Runtime","loadExtension","sendDataOptions","tool","category","closeIcon","hide","close","minHeight","cacheable","overlay","padding","borderRadius","onPopupClose","unsubscribeAll","subscribeOnce","headerText","undefined"],"mappings":"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"}