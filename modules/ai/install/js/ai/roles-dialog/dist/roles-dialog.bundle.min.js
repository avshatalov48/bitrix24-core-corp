this.BX=this.BX||{};(function(e,t,s,a,i,l,o,r,n,c,d,b){"use strict";let v=e=>e,p,u;var h=babelHelpers.classPrivateFieldLooseKey("popup");var L=babelHelpers.classPrivateFieldLooseKey("initPopup");var _=babelHelpers.classPrivateFieldLooseKey("renderContent");var P=babelHelpers.classPrivateFieldLooseKey("renderPopupTitleBar");class g{constructor(){Object.defineProperty(this,P,{value:H});Object.defineProperty(this,_,{value:F});Object.defineProperty(this,L,{value:m});Object.defineProperty(this,h,{writable:true,value:void 0})}show(){if(!babelHelpers.classPrivateFieldLooseBase(this,h)[h]){babelHelpers.classPrivateFieldLooseBase(this,L)[L]()}babelHelpers.classPrivateFieldLooseBase(this,h)[h].show()}hide(){var e;(e=babelHelpers.classPrivateFieldLooseBase(this,h)[h])==null?void 0:e.close()}}function m(){babelHelpers.classPrivateFieldLooseBase(this,h)[h]=new a.Popup({content:babelHelpers.classPrivateFieldLooseBase(this,_)[_](),resizable:true,width:881,height:621,padding:0,contentPadding:0,borderRadius:"10px 10px 4px 4px",className:"ai_roles-dialog_popup",animation:true,cacheable:false})}function F(){return c.Tag.render(p||(p=v`
			<div class="ai__roles-dialog_loader-popup-inner">
				${0}
				<div class="ai__roles-dialog_loader-popup-content">
					<div class="ai__roles-dialog_loader-popup-content-left">
						<div style="width: 145px; height: 10px; margin-bottom: 22px; margin-left: 12px;">
							<div class="rec --color-ai"></div>
						</div>
						<div style="width: 100%; height: 119px; margin-bottom: 14px;">
							<div class="rec --color-ai"></div>
						</div>
						<div style="width: 100%; height: 54px;">
							<div class="rec --color-ai"></div>
						</div>
					</div>
					<div class="ai__roles-dialog_loader-popup-content-right">
					<div style="width: 101px; height: 10px; margin-bottom: 22px;">
							<div class="rec"></div>
						</div>
						<div style="width: 100%; height: 75px; margin-bottom: 8px;">
							<div class="rec"></div>
						</div>
						<div style="width: 100%; height: 75px;">
							<div class="rec"></div>
						</div>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,P)[P]())}function H(){return c.Tag.render(u||(u=v`
			<div class="ai__roles-dialog_loader-popup-title-bar">
				<div
					style="width: 152px; height: 16px;"
					class="ai__roles-dialog_loader-popup-title-bar-left"
				>
					<div class="rec"></div>
				</div>
				<div
					style="width: 98px; height: 16px;"
					class="ai__roles-dialog_loader-popup-title-bar-left"
				>
					<div class="rec"></div>
				</div>
			</div>
		`))}let O=e=>e,f;function I(){const e=new a.Popup({content:R(),resizable:false,width:881,height:621,padding:0,contentPadding:0,borderRadius:"10px 10px 4px 4px",className:"ai_roles-dialog_popup",animation:true,cacheable:false,autoHide:true,closeByEsc:true,closeIcon:true,closeIconSize:a.CloseIconSize.LARGE});e.show()}function R(){return c.Tag.render(f||(f=O`
		<div class="ai__roles-dialog_error-popup-inner">
			<div class="ai__roles-dialog_error-popup-content">
				<div class="ai__roles-dialog_error-popup-content-warning-icon">
					${0}
				</div>
				<p class="ai__roles-dialog_error-popup-content-error-text">
					${0}
				</p>
			</div>
		</div>
	`),B(),c.Loc.getMessage("AI_COPILOT_ROLES_ERROR_TEXT"))}function B(){const e="rgba(176, 149, 220, 0.4)";const t=new n.Icon({icon:n.Main.WARNING,size:56,color:e});return t.render()}const E=Object.freeze({OPEN:"open",CLOSE:"close",SAVE:"save",SEARCH:"search",FEEDBACK:"feedback",SELECT:"save"});const y=Object.freeze({SUCCESS:"success",ERROR:"error"});var S=babelHelpers.classPrivateFieldLooseKey("cSection");var T=babelHelpers.classPrivateFieldLooseKey("sendLabel");var C=babelHelpers.classPrivateFieldLooseKey("getCommonParameters");var D=babelHelpers.classPrivateFieldLooseKey("getFormattedExtraParams");var A=babelHelpers.classPrivateFieldLooseKey("formatCSectionParam");class w{constructor(e){Object.defineProperty(this,A,{value:K});Object.defineProperty(this,D,{value:M});Object.defineProperty(this,C,{value:x});Object.defineProperty(this,T,{value:N});Object.defineProperty(this,S,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,S)[S]=babelHelpers.classPrivateFieldLooseBase(this,A)[A](e.cSection)}sendOpenLabel(e,t){const s=e?y.SUCCESS:y.ERROR;const a=t?{p1:{name:"role",value:t}}:{};babelHelpers.classPrivateFieldLooseBase(this,T)[T]({status:s,extraParams:a,event:E.OPEN})}sendCloseLabel(e){const t=e?{p1:{name:"role",value:e}}:{};babelHelpers.classPrivateFieldLooseBase(this,T)[T]({extraParams:t,event:E.CLOSE})}sendSelectLabel(e){const t=e?{p1:{name:"role",value:e}}:{};babelHelpers.classPrivateFieldLooseBase(this,T)[T]({extraParams:t,event:E.SELECT})}sendSearchLabel(e){const t=e?{p1:{name:"search",value:e}}:{};babelHelpers.classPrivateFieldLooseBase(this,T)[T]({extraParams:t,event:E.SEARCH})}sendFeedBackLabel(){babelHelpers.classPrivateFieldLooseBase(this,T)[T]({event:E.FEEDBACK})}}async function N(e){const t=e.status||y.SUCCESS;const s=e.event;const a=e.extraParams||{};try{const{sendData:e}=await c.Runtime.loadExtension("ui.analytics");const i={event:s,status:t,...babelHelpers.classPrivateFieldLooseBase(this,C)[C](),...babelHelpers.classPrivateFieldLooseBase(this,D)[D](a)};e(i)}catch(e){console.error("AI: RolesDialog: Can't send analytics",e)}}function x(){return{tool:"ai",category:"roles_picker",c_section:babelHelpers.classPrivateFieldLooseBase(this,S)[S]}}function M(e){const t={};Object.entries(e).forEach((([e,s])=>{t[e]=`${c.Text.toCamelCase(s.name)}_${c.Text.toCamelCase(s.value)}`}));return t}function K(e){return e.split("_").map((e=>{if(Number.isNaN(parseInt(e,10))){return e}return""})).filter((e=>e)).join("_")}const j={CHOOSE_STANDARD_ROLE:"AI.RolesDialog.GroupListFooter:ChooseStandardRole"};const U={methods:{handleClick(){d.EventEmitter.emit(document,j.CHOOSE_STANDARD_ROLE)}},template:`\n\t\t<button @click="handleClick" class="ai__roles-dialog_standard-group-btn">\n\t\t\t<span class="ai__roles-dialog_standard-group-btn-text">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('AI_COPILOT_ROLES_USE_STANDARD_ROLE') }}\n\t\t\t</span>\n\t\t</button>\n\t`};const G={components:{Hint:i.Hint},props:{header:{type:String,required:false,default:""},hint:{type:String,required:false,default:""}},template:`\n\t\t<div class="ai__roles-dialog_header-with-hint">\n\t\t\t<span class="ai__roles-dialog_header-with-hint-text">\n\t\t\t\t{{ header }}\n\t\t\t</span>\n\t\t\t<span\n\t\t\t\tv-if="hint"\n\t\t\t\tclass="ai__roles-dialog_header-with-hint-text-hint"\n\t\t\t>\n\t\t\t\t<Hint :text="hint" />\n\t\t\t</span>\n\t\t</div>\n\t`};const z={components:{RolesDialogHeaderWithHint:G},computed:{text(){return this.$Bitrix.Loc.getMessage("AI_COPILOT_ROLES_GROUP_LIST_HEADER_2")},hint(){return this.$Bitrix.Loc.getMessage("AI_COPILOT_ROLES_GROUP_LIST_HEADER_HINT_2")}},template:`\n\t\t<div class="ai__roles-dialog_group-list-header">\n\t\t\t<RolesDialogHeaderWithHint\n\t\t\t\t:header="text"\n\t\t\t\t:hint="hint"\n\t\t\t/>\n\t\t</div>\n\t`};function k(e,t){const s=e=>{t.sendSearchLabel(e)};const a=c.Runtime.debounce(s,800);return{components:{RolesDialogHeaderWithHint:G},computed:{...b.mapWritableState(e.useGlobalState,{searchQuery:"searchQuery",searching:"searchApplied"}),header(){return this.$Bitrix.Loc.getMessage("AI_COPILOT_ROLES_MAIN_CONTENT_HEADER")},hint(){return this.$Bitrix.Loc.getMessage("AI_COPILOT_ROLES_MAIN_CONTENT_HEADER_HINT")}},watch:{searchQuery(){if(this.searching){a(this.searchQuery)}}},template:`\n\t\t\t<div class="ai__roles-dialog_main-content-header">\n\t\t\t\t<RolesDialogHeaderWithHint\n\t\t\t\t\t:header="header"\n\t\t\t\t\t:hint="hint"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t`}}const V={name:"RolesDialogRoleItemAvatar",components:{BIcon:r.BIcon},data(){return{isAvatarLoaded:null}},props:{avatar:{type:String,required:false,default:null},avatarAlt:{type:String,required:false,default:""},icon:{type:String,required:false,default:null}},computed:{iconSize(){return 24},iconColor(){return getComputedStyle(document.body).getPropertyValue("--ui-color-background-primary")||"#fff"},fallbackIcon(){return n.Main.COPILOT_AI}},methods:{onImageLoad(){this.isAvatarLoaded=true},onImageLoadError(){this.isAvatarLoaded=false}},template:`\n\t\t<div\n\t\t\tclass="ai__roles-dialog_role-image-wrapper"\n\t\t>\n\t\t\t<div\n\t\t\t\tv-if="icon"\n\t\t\t\tclass="ai__roles-dialog_role-image-icon"\n\t\t\t>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name="icon"\n\t\t\t\t\t:size="iconSize"\n\t\t\t\t\t:color="iconColor"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-else\n\t\t\t>\n\t\t\t\t<transition name="ai-roles-dialog-icon-fade">\n\t\t\t\t\t<img\n\t\t\t\t\t\tv-show="isAvatarLoaded"\n\t\t\t\t\t\tclass="ai__roles-dialog_role-image"\n\t\t\t\t\t\t:src="avatar"\n\t\t\t\t\t\t:alt="avatarAlt"\n\t\t\t\t\t\t@error="onImageLoadError"\n\t\t\t\t\t\t@load="onImageLoad"\n\t\t\t\t\t/>\n\t\t\t\t</transition>\n\t\t\t\t<div\n\t\t\t\t\tv-if="isAvatarLoaded === null || isAvatarLoaded === false"\n\t\t\t\t\t:class="{'ai__roles-dialog_role-image-icon': true, '--loading': isAvatarLoaded === null}"\n\t\t\t\t>\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:name="fallbackIcon"\n\t\t\t\t\t\t:size="iconSize"\n\t\t\t\t\t\t:color="iconColor"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const $={props:{inverted:{type:Boolean,required:false,default:false}},computed:{labelHTML(){const e=this.inverted?l.LabelColor.COPILOT_LIGHT_REVERSE:l.LabelColor.COPILOT_LIGHT;const t=new l.Label({color:e,size:l.LabelSize.SM,text:"NEW",fill:true});return t.render().outerHTML}},template:`\n\t\t<div ref="label" class="ai__roles-dialog_label" v-html="labelHTML"></div>\n\t`};function X(e){return{name:"RolesDialogRoleItem",components:{BIcon:r.BIcon,RolesDialogRoleItemAvatar:V,RolesDialogLabelNew:$},data(){return{isFavourite:this.itemData.itemData.customData.isFavourite,isProcessingRoleFavourite:false}},props:["itemData"],computed:{...b.mapWritableState(e.useGlobalState,{searching:"searchApplied",searchQuery:"searchQuery"}),item(){return this.itemData.itemData},subtitle(){const e=this.item.subtitle;if(this.searching&&this.searchQuery!==""){return e.replaceAll(new RegExp(this.searchQuery,"gi"),(e=>`<mark>${e}</mark>`))}return e},title(){const e=this.item.title;if(this.searching&&this.searchQuery!==""){return e.replaceAll(new RegExp(this.searchQuery,"gi"),(e=>`<mark>${e}</mark>`))}return e},isSelected(){var e;return Boolean((e=this.item.customData)==null?void 0:e.selected)},isNew(){var e;return Boolean((e=this.item.customData)==null?void 0:e.isNew)},isInfoItem(){var e;return Boolean((e=this.item.customData)==null?void 0:e.isInfoItem)},className(){return{"ai__roles-dialog_role-item":true,"--selected":this.isSelected}},isRoleCanBeFavourite(){return this.item.customData.canBeFavourite===true},favouriteLabelIconData(){const e=this.isProcessingRoleFavourite?n.Animated.LOADER_WAIT:n.Main.BOOKMARK_1;return{name:e,size:24}},favouriteLabelTitle(){return this.isFavourite?this.$Bitrix.Loc.getMessage("AI_COPILOT_ROLES_REMOVE_FROM_FAVOURITE"):this.$Bitrix.Loc.getMessage("AI_COPILOT_ROLES_ADD_TO_FAVOURITE")},favouriteLabelClassname(){return{"ai__roles-dialog_role-item-favourite-label":true,"--active":this.isFavourite,"--loading":this.isProcessingRoleFavourite}},infoIcon(){return n.Main.INFO}},methods:{selectRole(){if(c.Type.isFunction(this.item.button.action)){this.item.button.action()}},toggleFavourite(){if(this.isProcessingRoleFavourite){return}let e=false;setTimeout((()=>{if(e===false){this.isProcessingRoleFavourite=true}}),300);this.item.customData.actions.toggleFavourite(!this.isFavourite).then((()=>{this.isFavourite=!this.isFavourite})).finally((()=>{this.isProcessingRoleFavourite=false;e=true}))}},template:`\n\t\t\t<article @click="selectRole" :class="className">\n\t\t\t\t<RolesDialogRoleItemAvatar\n\t\t\t\t\t:avatar="item.customData.avatar"\n\t\t\t\t\t:avatar-alt="item.title"\n\t\t\t\t\t:icon="isInfoItem ? infoIcon : null"\n\t\t\t\t/>\n\t\t\t\t<div class="ai__roles-dialog_role-item-info">\n\t\t\t\t\t<div class="ai__roles-dialog_role-item-title-wrapper">\n\t\t\t\t\t\t<div class="ai__roles-dialog_role-item-title" v-html="title"></div>\n\t\t\t\t\t\t<div class="ai__roles-dialog_role-item-label">\n\t\t\t\t\t\t\t<RolesDialogLabelNew v-if="isNew" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p class="ai__roles-dialog_role-item-description" v-html="subtitle"></p>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\tv-if="isRoleCanBeFavourite"\n\t\t\t\t\t:class="favouriteLabelClassname"\n\t\t\t\t\t:title="favouriteLabelTitle"\n\t\t\t\t\t@click.stop.prevent="toggleFavourite"\n\t\t\t\t\t@mousedown.stop\n\t\t\t\t>\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:name="favouriteLabelIconData.name"\n\t\t\t\t\t\t:size="favouriteLabelIconData.size"\n\t\t\t\t\t/>\n\t\t\t\t</button>\n\t\t\t</article>\n\t\t`}}const W={components:{BIcon:r.BIcon,RolesDialogLabelNew:$},props:["groupData"],computed:{group(){return this.groupData.groupData},isNew(){return this.group.customData.isNew},isSelected(){return this.group.selected},handleClick(){if(this.group.selected){return undefined}return this.groupData.handleClick},groupItemClassname(){return{"ai__roles-dialog_group-item":true,"--selected":this.isSelected}},chevronRightIconName(){return n.Actions.CHEVRON_RIGHT}},template:`\n\t\t<div @click="handleClick" class="ai__roles-dialog_group-item-wrapper">\n\t\t\t<div :class="groupItemClassname">\n\t\t\t\t<div class="ai__roles-dialog_group-item-inner">\n\t\t\t\t<div class="ai__roles-dialog_group-item-title-wrapper">\n\t\t\t\t\t<span class="ai__roles-dialog_group-item-title">\n\t\t\t\t\t\t{{ group.name }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class="ai__roles-dialog_group-item-label-new">\n\t\t\t\t\t\t<RolesDialogLabelNew\n\t\t\t\t\t\t\tv-if="isNew"\n\t\t\t\t\t\t\t:inverted="isSelected"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\t<b-icon :size="16" :name="chevronRightIconName"></b-icon>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const q={CHOOSE_STANDARD_ROLE:"AI.RolesDialog.RolesDialogSearchStub:ChooseStandardRole"};const Q=c.Loc.getMessage("AI_COPILOT_ROLES_SEARCH_NO_RESULT_3",{"#LINK#":'<span @click.prevent="selectUniversalRole">',"#/LINK#":"</span>"});const Y={methods:{selectUniversalRole(){d.EventEmitter.emit(document,q.CHOOSE_STANDARD_ROLE)}},template:`\n\t\t<div class="ai__roles-dialog_search-stub">\n\t\t\t<div class="ai__roles-dialog_search-stub-content">\n\t\t\t\t<div class="ai__roles-dialog_search-stub-image"></div>\n\t\t\t\t<h3 class="ai__roles-dialog_search-stub-title">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('AI_COPILOT_ROLES_SEARCH_NO_RESULT_TITLE') }}\n\t\t\t\t</h3>\n\t\t\t\t<div class="ai__roles-dialog_search-stub-text">\n\t\t\t\t\t${Q}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const J=e=>({computed:{...b.mapWritableState(e.useGlobalState,{currentGroup:"currentGroup"}),emptyStubData(){return this.currentGroup.customData.emptyStubData},groupCode(){return this.currentGroup.id},title(){return this.emptyStubData.title},description(){return this.emptyStubData.description}},template:`\n\t\t\t<div class="ai__roles-dialog_empty-group-stub">\n\t\t\t\t<div class="ai__roles-dialog_empty-group-stub-content">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass="ai__roles-dialog_empty-group-stub-image"\n\t\t\t\t\t\t:class="'--' + groupCode"\n\t\t\t\t\t></div>\n\t\t\t\t\t<h3 class="ai__roles-dialog_empty-group-stub-title">\n\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t</h3>\n\t\t\t\t\t<div class="ai__roles-dialog_empty-group-stub-text">\n\t\t\t\t\t\t{{ description }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`});const Z={HIDE:"hide",SELECT_ROLE:"select-role"};const ee="recommended";const te="recents";const se="favorites";var ae=babelHelpers.classPrivateFieldLooseKey("entityCatalog");var ie=babelHelpers.classPrivateFieldLooseKey("engine");var le=babelHelpers.classPrivateFieldLooseKey("analytic");var oe=babelHelpers.classPrivateFieldLooseKey("roles");var re=babelHelpers.classPrivateFieldLooseKey("recentRoles");var ne=babelHelpers.classPrivateFieldLooseKey("favouriteRoles");var ce=babelHelpers.classPrivateFieldLooseKey("defaultRoleCode");var de=babelHelpers.classPrivateFieldLooseKey("industries");var be=babelHelpers.classPrivateFieldLooseKey("selectedDefaultRoleHandler");var ve=babelHelpers.classPrivateFieldLooseKey("selectedRoleCode");var pe=babelHelpers.classPrivateFieldLooseKey("universalRole");var ue=babelHelpers.classPrivateFieldLooseKey("title");var he=babelHelpers.classPrivateFieldLooseKey("moduleId");var Le=babelHelpers.classPrivateFieldLooseKey("contextId");var _e=babelHelpers.classPrivateFieldLooseKey("validateOptions");var Pe=babelHelpers.classPrivateFieldLooseKey("showAfterInit");var ge=babelHelpers.classPrivateFieldLooseKey("subscribeEvents");var me=babelHelpers.classPrivateFieldLooseKey("unsubscribeEvents");var Fe=babelHelpers.classPrivateFieldLooseKey("selectRole");var He=babelHelpers.classPrivateFieldLooseKey("selectDefaultRole");var Oe=babelHelpers.classPrivateFieldLooseKey("init");var fe=babelHelpers.classPrivateFieldLooseKey("initEntityCatalog");var Ie=babelHelpers.classPrivateFieldLooseKey("getSlots");var Re=babelHelpers.classPrivateFieldLooseKey("getInfoItemData");var Be=babelHelpers.classPrivateFieldLooseKey("getAllIndustryCodesWithExcludes");var Ee=babelHelpers.classPrivateFieldLooseKey("loadData");var ye=babelHelpers.classPrivateFieldLooseKey("getRecommendedRoleIndustry");var Se=babelHelpers.classPrivateFieldLooseKey("getRecentRoleIndustry");var Te=babelHelpers.classPrivateFieldLooseKey("getFavouriteRoleIndustry");var Ce=babelHelpers.classPrivateFieldLooseKey("getItemsData");var De=babelHelpers.classPrivateFieldLooseKey("getUniversalRoleItemData");var Ae=babelHelpers.classPrivateFieldLooseKey("getItemGroupsFromIndustries");var we=babelHelpers.classPrivateFieldLooseKey("getItemGroupDataFromIndustry");var Ne=babelHelpers.classPrivateFieldLooseKey("getRecentItemGroupData");var xe=babelHelpers.classPrivateFieldLooseKey("compareRecentItems");var Me=babelHelpers.classPrivateFieldLooseKey("getFavouriteItemGroupData");var Ke=babelHelpers.classPrivateFieldLooseKey("compareFavouriteItems");var je=babelHelpers.classPrivateFieldLooseKey("getItemDataFromRole");var Ue=babelHelpers.classPrivateFieldLooseKey("getSelectedGroupIndex");var Ge=babelHelpers.classPrivateFieldLooseKey("isSelectedIndustry");var ze=babelHelpers.classPrivateFieldLooseKey("isRoleInFavouriteList");var ke=babelHelpers.classPrivateFieldLooseKey("toggleRoleFavourite");var Ve=babelHelpers.classPrivateFieldLooseKey("addRoleToFavouriteList");var $e=babelHelpers.classPrivateFieldLooseKey("removeRoleFromFavouriteList");class Xe extends d.EventEmitter{constructor(e){super(e);Object.defineProperty(this,$e,{value:Ot});Object.defineProperty(this,Ve,{value:Ht});Object.defineProperty(this,ke,{value:Ft});Object.defineProperty(this,ze,{value:mt});Object.defineProperty(this,Ge,{value:gt});Object.defineProperty(this,Ue,{value:Pt});Object.defineProperty(this,je,{value:_t});Object.defineProperty(this,Ke,{value:Lt});Object.defineProperty(this,Me,{value:ht});Object.defineProperty(this,xe,{value:ut});Object.defineProperty(this,Ne,{value:pt});Object.defineProperty(this,we,{value:vt});Object.defineProperty(this,Ae,{value:bt});Object.defineProperty(this,De,{value:dt});Object.defineProperty(this,Ce,{value:ct});Object.defineProperty(this,Te,{value:nt});Object.defineProperty(this,Se,{value:rt});Object.defineProperty(this,ye,{value:ot});Object.defineProperty(this,Ee,{value:lt});Object.defineProperty(this,Be,{value:it});Object.defineProperty(this,Re,{value:at});Object.defineProperty(this,Ie,{value:st});Object.defineProperty(this,fe,{value:tt});Object.defineProperty(this,Oe,{value:et});Object.defineProperty(this,He,{value:Ze});Object.defineProperty(this,Fe,{value:Je});Object.defineProperty(this,me,{value:Ye});Object.defineProperty(this,ge,{value:Qe});Object.defineProperty(this,Pe,{value:qe});Object.defineProperty(this,_e,{value:We});Object.defineProperty(this,ae,{writable:true,value:void 0});Object.defineProperty(this,ie,{writable:true,value:void 0});Object.defineProperty(this,le,{writable:true,value:void 0});Object.defineProperty(this,oe,{writable:true,value:void 0});Object.defineProperty(this,re,{writable:true,value:void 0});Object.defineProperty(this,ne,{writable:true,value:void 0});Object.defineProperty(this,ce,{writable:true,value:void 0});Object.defineProperty(this,de,{writable:true,value:void 0});Object.defineProperty(this,be,{writable:true,value:void 0});Object.defineProperty(this,ve,{writable:true,value:void 0});Object.defineProperty(this,pe,{writable:true,value:void 0});Object.defineProperty(this,ue,{writable:true,value:void 0});Object.defineProperty(this,he,{writable:true,value:void 0});Object.defineProperty(this,Le,{writable:true,value:void 0});this.setEventNamespace("AI.RolesDialog");babelHelpers.classPrivateFieldLooseBase(this,_e)[_e](e);babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]=e.title||"";if(e.engine){babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]=e.engine}else{babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]=new t.Engine({})}babelHelpers.classPrivateFieldLooseBase(this,he)[he]=e.moduleId;babelHelpers.classPrivateFieldLooseBase(this,Le)[Le]=e.contextId;babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].setModuleId(e.moduleId);babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].setContextId(e.contextId);babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]=c.Type.isString(e.selectedRoleCode)?e.selectedRoleCode:"";babelHelpers.classPrivateFieldLooseBase(this,le)[le]=new w({cSection:`${babelHelpers.classPrivateFieldLooseBase(this,he)[he]}_${babelHelpers.classPrivateFieldLooseBase(this,Le)[Le]}`})}setSelectedRoleCode(e){babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]=e;if(babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]){babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].setGroups(babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]());babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].setItems(babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]())}}async show(){if(babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]){babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].show();babelHelpers.classPrivateFieldLooseBase(this,le)[le].sendOpenLabel(true,babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]);return}await babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe]()}hide(){var e;(e=babelHelpers.classPrivateFieldLooseBase(this,ae)[ae])==null?void 0:e.close()}}function We(e){if(c.Type.isStringFilled(e.moduleId)===false){throw new c.BaseError("AI.RolesDialog: moduleId is required option and must be string")}if(c.Type.isStringFilled(e.contextId)===false){throw new c.BaseError("AI.RolesDialog: contextId is required option and must be string")}if(e.selectedRoleCode!==undefined&&c.Type.isString(e.selectedRoleCode)===false){throw new c.BaseError("AI.RolesDialog: selectedRoleCode must be string")}if(e.title&&c.Type.isString(e.title)===false){throw new c.BaseError("AI.RolesDialog: title must be string")}if(e.engine&&!(e.engine instanceof t.Engine)){throw new c.BaseError("AI.RolesDialog: engine option must be instance of Engine")}}async function qe(){const e=new g;let t=true;setTimeout((()=>{if(t){e.show()}}),300);try{await babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]();babelHelpers.classPrivateFieldLooseBase(this,le)[le].sendOpenLabel(true,babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]);babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].show()}catch(e){I();babelHelpers.classPrivateFieldLooseBase(this,le)[le].sendOpenLabel(false,babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]);console.error(e)}finally{t=false;e.hide()}}function Qe(){babelHelpers.classPrivateFieldLooseBase(this,be)[be]=babelHelpers.classPrivateFieldLooseBase(this,He)[He].bind(this);d.EventEmitter.subscribe(document,j.CHOOSE_STANDARD_ROLE,babelHelpers.classPrivateFieldLooseBase(this,be)[be]);d.EventEmitter.subscribe(document,q.CHOOSE_STANDARD_ROLE,babelHelpers.classPrivateFieldLooseBase(this,be)[be])}function Ye(){d.EventEmitter.unsubscribe(document,j.CHOOSE_STANDARD_ROLE,babelHelpers.classPrivateFieldLooseBase(this,be)[be]);d.EventEmitter.unsubscribe(document,q.CHOOSE_STANDARD_ROLE,babelHelpers.classPrivateFieldLooseBase(this,be)[be])}function Je(e){const t=new d.BaseEvent({data:{role:e}});this.setSelectedRoleCode(e.code);babelHelpers.classPrivateFieldLooseBase(this,le)[le].sendSelectLabel(babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]);this.emit(Z.SELECT_ROLE,t)}function Ze(){this.setSelectedRoleCode(babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]);const e=new d.BaseEvent({data:{role:babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]}});this.emit(Z.SELECT_ROLE,e);babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].close()}async function et(){await babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee]();await babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]()}async function tt(){const{EntityCatalog:e,States:t}=await c.Runtime.loadExtension("ui.entity-catalog");babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]=new e({title:babelHelpers.classPrivateFieldLooseBase(this,ue)[ue],showSearch:true,showEmptyGroups:true,customComponents:{RolesDialogContentHeader:k(t,babelHelpers.classPrivateFieldLooseBase(this,le)[le]),RolesDialogRoleItem:X(t),RolesDialogGroupListHeader:z,RolesDialogGroupItem:W,RolesDialogGroupListFooter:U,RolesDialogSearchStub:Y,RolesDialogEmptyGroupStub:J(t)},popupOptions:{className:"ai_roles-dialog_popup ui-entity-catalog__scope",resizable:false,width:852,height:510,animation:true,events:{onPopupShow:()=>{babelHelpers.classPrivateFieldLooseBase(this,ge)[ge]()},onPopupClose:()=>{this.emit(Z.HIDE);babelHelpers.classPrivateFieldLooseBase(this,me)[me]();babelHelpers.classPrivateFieldLooseBase(this,le)[le].sendCloseLabel(babelHelpers.classPrivateFieldLooseBase(this,ve)[ve])}}},slots:babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie](e),groups:babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae](),items:babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]()})}function st(e){const t={[e.SLOT_MAIN_CONTENT_HEADER]:"<RolesDialogContentHeader />",[e.SLOT_MAIN_CONTENT_ITEM]:'<RolesDialogRoleItem :itemData="itemSlotProps" />',[e.SLOT_GROUP]:'<RolesDialogGroupItem :groupData="groupSlotProps" />',[e.SLOT_GROUP_LIST_HEADER]:"<RolesDialogGroupListHeader />",[e.SLOT_MAIN_CONTENT_EMPTY_GROUP_STUB]:"<RolesDialogEmptyGroupStub />"};if(e.SLOT_MAIN_CONTENT_SEARCH_STUB){t[e.SLOT_MAIN_CONTENT_NO_SELECTED_GROUP_STUB]="<RolesDialogSearchStub />";t[e.SLOT_MAIN_CONTENT_SEARCH_STUB]="<RolesDialogSearchStub />"}return t}function at(){return{id:"info-item-data",title:c.Loc.getMessage("AI_COPILOT_ROLES_HELP_ITEM_TITLE"),subtitle:c.Loc.getMessage("AI_COPILOT_ROLES_HELP_ITEM_DESCRIPTION"),groupIds:babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]([se]),customData:{isInfoItem:true},button:{action:async()=>{await c.Runtime.loadExtension("ui.feedback.form");const e=Math.round(Math.random()*1e3);BX.UI.Feedback.Form.open({id:`ai.roles-dialog.feedback-form_${e}`,presets:{sender_page:`${babelHelpers.classPrivateFieldLooseBase(this,he)[he]}_${babelHelpers.classPrivateFieldLooseBase(this,Le)[Le]}`},forms:[{zones:["es"],id:738,lang:"es",sec:"77ui4p"},{zones:["en"],id:740,lang:"en",sec:"obza3e"},{zones:["de"],id:742,lang:"de",sec:"vqqxgr"},{zones:["com.br"],id:744,lang:"com.br",sec:"nz3zig"},{zones:["ru","by","kz"],id:746,lang:"ru",sec:"we50kv"}]});babelHelpers.classPrivateFieldLooseBase(this,le)[le].sendFeedBackLabel()}}}}function it(e){const t=new Set(e);return babelHelpers.classPrivateFieldLooseBase(this,de)[de].map((e=>e.code)).filter((e=>t.has(e)===false))}async function lt(){const e=await babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].getRolesDialogData();babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]=e.data.universalRole;babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]=babelHelpers.classPrivateFieldLooseBase(this,pe)[pe].code;babelHelpers.classPrivateFieldLooseBase(this,de)[de]=e.data.items.map((e=>{const{code:t,name:s,isNew:a}=e;return{code:t,name:s,isNew:a}}));babelHelpers.classPrivateFieldLooseBase(this,de)[de].unshift(babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](),babelHelpers.classPrivateFieldLooseBase(this,Te)[Te](),babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]());babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]=e.data.items.reduce(((e,t)=>{const s=t.roles;return[...e,...s]}),[]);babelHelpers.classPrivateFieldLooseBase(this,re)[re]=e.data.recents;babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]=e.data.favorites;babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]=[...babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]];babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]=babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]||null}function ot(){return{code:ee,name:c.Loc.getMessage("AI_COPILOT_ROLES_RECOMMENDED_GROUP")}}function rt(){return{code:te,name:c.Loc.getMessage("AI_COPILOT_ROLES_RECENT_GROUP")}}function nt(){return{code:se,name:c.Loc.getMessage("AI_COPILOT_ROLES_FAVOURITE_GROUP")}}function ct(){let e=null;const t=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].map((t=>{const s=[t.industryCode];if(t.isRecommended){s.push(ee)}if(babelHelpers.classPrivateFieldLooseBase(this,re)[re].findIndex((e=>e.code===t.code))>-1){s.push(te)}if(babelHelpers.classPrivateFieldLooseBase(this,ne)[ne].findIndex((e=>e.code===t.code))>-1){s.push(se)}if(t.code===babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]){e=babelHelpers.classPrivateFieldLooseBase(this,je)[je](t,s);return null}return babelHelpers.classPrivateFieldLooseBase(this,je)[je](t,s)})).filter((e=>e));const s=t.sort((e=>e.customData.isNew?-1:1));const a=babelHelpers.classPrivateFieldLooseBase(this,De)[De]();return[a,e,...s,babelHelpers.classPrivateFieldLooseBase(this,Re)[Re]()].filter((e=>e))}function dt(){const e=babelHelpers.classPrivateFieldLooseBase(this,pe)[pe];const t=[...babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]([se])];return babelHelpers.classPrivateFieldLooseBase(this,je)[je](e,t)}function bt(){const e=babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue]();const t=babelHelpers.classPrivateFieldLooseBase(this,de)[de].map(((t,s)=>{const a=s===e;if(t.code===te){return babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](a)}if(t.code===se){return babelHelpers.classPrivateFieldLooseBase(this,Me)[Me](a)}return babelHelpers.classPrivateFieldLooseBase(this,we)[we](t,a)}));return[[...t]]}function vt(e,t=false){return{id:e.code,name:e.name,selected:t,customData:{isNew:e.isNew}}}function pt(e=false){return{...babelHelpers.classPrivateFieldLooseBase(this,we)[we](babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](),e),compare:(e,t)=>babelHelpers.classPrivateFieldLooseBase(this,xe)[xe](e,t)}}function ut(e,t){const s=babelHelpers.classPrivateFieldLooseBase(this,re)[re].findIndex((t=>e.id===t.code))+1;const a=babelHelpers.classPrivateFieldLooseBase(this,re)[re].findIndex((e=>t.id===e.code))+1;if(e.id===babelHelpers.classPrivateFieldLooseBase(this,Re)[Re]().id){return 1}return s-a}function ht(e=false){return{...babelHelpers.classPrivateFieldLooseBase(this,we)[we](babelHelpers.classPrivateFieldLooseBase(this,Te)[Te](),e),compare:(e,t)=>babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke](e,t),customData:{emptyStubData:{title:c.Loc.getMessage("AI_COPILOT_ROLES_EMPTY_FAVOURITE_GROUP_TITLE"),description:c.Loc.getMessage("AI_COPILOT_ROLES_EMPTY_FAVOURITE_GROUP")}}}}function Lt(e,t){const s=babelHelpers.classPrivateFieldLooseBase(this,ne)[ne].findIndex((t=>e.id===t.code))+1;const a=babelHelpers.classPrivateFieldLooseBase(this,ne)[ne].findIndex((e=>t.id===e.code))+1;return s-a}function _t(e,t=[]){const s=babelHelpers.classPrivateFieldLooseBase(this,ze)[ze](e.code);return{groupIds:t,id:e.code,name:e.name,title:e.name,subtitle:e.description,description:e.description,button:{text:c.Loc.getMessage("AI_COPILOT_ROLES_USE_ROLE_BTN"),action:()=>{babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe](e);babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].close()}},customData:{selected:e.code===babelHelpers.classPrivateFieldLooseBase(this,ve)[ve],avatar:e.avatar.medium,isNew:e.isNew,isFavourite:s,canBeFavourite:e.code!==babelHelpers.classPrivateFieldLooseBase(this,pe)[pe].code,actions:{toggleFavourite:t=>{const s=e.code;return babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](s,t)}}}}}function Pt(){const e=babelHelpers.classPrivateFieldLooseBase(this,de)[de].findIndex((e=>babelHelpers.classPrivateFieldLooseBase(this,Ge)[Ge](e)));return e>-1?e:0}function gt(e){const t=babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]();const s=t.find((e=>e.id===babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]));return(s==null?void 0:s.groupIds.includes(e.code))||false}function mt(e){return babelHelpers.classPrivateFieldLooseBase(this,ne)[ne].some((t=>t.code===e))}async function Ft(e,t){const a=e===babelHelpers.classPrivateFieldLooseBase(this,pe)[pe].code?babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]:babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].find((t=>t.code===e));if(!a&&e!==babelHelpers.classPrivateFieldLooseBase(this,pe)[pe].code){const e=t?c.Loc.getMessage("AI_COPILOT_ROLES_ADD_TO_FAVOURITE_ACTION_FAILED"):c.Loc.getMessage("AI_COPILOT_ROLES_REMOVE_FROM_FAVOURITE_ACTION_FAILED");s.UI.Notification.Center.notify({content:e});return Promise.reject()}if(t){return babelHelpers.classPrivateFieldLooseBase(this,Ve)[Ve](a.code,a.name)}return babelHelpers.classPrivateFieldLooseBase(this,$e)[$e](a.code,a.name)}async function Ht(e,t){return babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].addRoleToFavouriteList(e).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]=e.data.items;babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].setItems(babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]());babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].setGroups(babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]());s.UI.Notification.Center.notify({content:c.Loc.getMessage("AI_COPILOT_ROLES_ADD_TO_FAVOURITE_NOTIFICATION_SUCCESS",{"#ROLE#":t})})})).catch((e=>{console.error(e);s.UI.Notification.Center.notify({content:c.Loc.getMessage("AI_COPILOT_ROLES_ADD_TO_FAVOURITE_ACTION_FAILED")})}))}async function Ot(e,t){return babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].removeRoleFromFavouriteList(e).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]=e.data.items;babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].setItems(babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]());babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].setGroups(babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]());s.UI.Notification.Center.notify({content:c.Loc.getMessage("AI_COPILOT_ROLES_REMOVE_FROM_FAVOURITE_NOTIFICATION_SUCCESS",{"#ROLE#":t})})})).catch((e=>{console.error(e);s.UI.Notification.Center.notify({content:c.Loc.getMessage("AI_COPILOT_ROLES_REMOVE_FROM_FAVOURITE_ACTION_FAILED")})}))}e.RolesDialogEvents=Z;e.RolesDialog=Xe})(this.BX.AI=this.BX.AI||{},BX.AI,BX,BX.Main,BX.Vue3.Components,BX.UI,BX,BX.UI.IconSet,BX.UI.IconSet,BX,BX.Event,BX.Vue3.Pinia);
//# sourceMappingURL=roles-dialog.bundle.map.js