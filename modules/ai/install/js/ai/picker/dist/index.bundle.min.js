this.BX=this.BX||{};(function(e,t,r,i,a,n,s,l,o,c,u,p,h,d,b){"use strict";function v(e,t,r){f(e,t);t.set(e,r)}function f(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var g=new WeakMap;var y=function(){function e(){babelHelpers.classCallCheck(this,e);v(this,g,{writable:true,value:{header:null,submit:null,action_use:null,action_copy:null,action_copy_notify:null,max_capacity:null,placeholder:null}})}babelHelpers.createClass(e,[{key:"setSpace",value:function t(r){var i=this;Object.keys(babelHelpers.classPrivateFieldGet(this,g)).forEach((function(e){babelHelpers.classPrivateFieldGet(i,g)[e]=b.Loc.getMessage("AI_JS_PICKER_".concat(r.toUpperCase(),"_").concat(e.toUpperCase()))}));e.generalKeys.forEach((function(e){babelHelpers.classPrivateFieldGet(i,g)[e]=b.Loc.getMessage("AI_JS_PICKER_GENERAL_".concat(e.toUpperCase()))}))}},{key:"getMessage",value:function e(t){return babelHelpers.classPrivateFieldGet(this,g)[t]}}],[{key:"getInstance",value:function t(){if(!e.instance){e.instance=new e}return e.instance}}]);return e}();babelHelpers.defineProperty(y,"generalKeys",["help_link","agree_with_terms"]);function m(e,t,r){H(e,t);t.set(e,r)}function H(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var w=new WeakMap;var P=function(e){babelHelpers.inherits(t,e);function t(e){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));m(babelHelpers.assertThisInitialized(r),w,{writable:true,value:void 0});r.props=e;babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),w,y.getInstance());r.setEventNamespace("AI:Picker:UI");return r}babelHelpers.createClass(t,[{key:"getMessage",value:function e(t){return babelHelpers.classPrivateFieldGet(this,w).getMessage(t)}},{key:"render",value:function e(){return null}}]);return t}(s.EventEmitter);var _;var k=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"render",value:function e(){var t=new d.Icon({icon:d.Actions.CROSS_40,size:24});return b.Tag.render(_||(_=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_icon-close" onclick="','">',"</div>\n\t\t"])),this.props.onClick,t.render())}}]);return t}(P);var F,G;function T(e,t){x(e,t);t.add(e)}function S(e,t,r){x(e,t);t.set(e,r)}function x(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function I(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var E=new WeakMap;var L=new WeakMap;var C=new WeakSet;var M=function(e){babelHelpers.inherits(t,e);function t(e){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));T(babelHelpers.assertThisInitialized(r),C);S(babelHelpers.assertThisInitialized(r),E,{writable:true,value:void 0});S(babelHelpers.assertThisInitialized(r),L,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),E,b.Type.isNumber(e.articleCode)?e.articleCode:null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),L,b.Type.isString(e.className)?e.className:"");r.setEventNamespace("AI:Picker:Header");return r}babelHelpers.createClass(t,[{key:"render",value:function e(){var t=this;var r=new k({onClick:function e(){t.emit("click-close-icon")}});return b.Tag.render(F||(F=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_header ','">\n\t\t\t\t<div class="ai__picker_header-icon"></div>\n\t\t\t\t<div style="margin-top: -10px;">\n\t\t\t\t\t<h3 class="ui-typography-heading-h3 ui- ai__picker_header-title">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</h3>\n\t\t\t\t\t","\n\t\t\t\t</div>\n\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),babelHelpers.classPrivateFieldGet(this,L),this.getMessage("header"),I(this,C,O).call(this),r.render())}}]);return t}(P);function O(){if(!babelHelpers.classPrivateFieldGet(this,E)||!top.BX||!top.BX.Helper){return null}var e=b.Tag.render(G||(G=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<a href="" class="ai__picker_header-subtitle">\n\t\t\t\t',"\n\t\t\t</a>\n\t\t"])),this.getMessage("help_link"));var t=babelHelpers.classPrivateFieldGet(this,E);b.bind(e,"click",(function(e){if(top.BX&&top.BX.Helper){top.BX.Helper.show("redirect=detail&code=".concat(t))}e.preventDefault();return false}));return e}var W,z,A;var D=function(e){babelHelpers.inherits(t,e);function t(e){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));r.setEventNamespace("AI:Picker:History");r.onGenerate=e.onGenerate;r.onLoadHistory=e.onLoadHistory;r.onSelect=e.onSelect;r.notifiers=new Map;r.listWrapper=r.getListWrapper();r.items=e.items||[];r.capacity=e.capacity||30;r.isHistoryLoaded=true;return r}babelHelpers.createClass(t,[{key:"onSelectClick",value:function e(t){this.onSelect(t)}},{key:"showNotify",value:function e(t,r,i){var a=this;if(!this.notifiers.has(r)){var n=new l.Popup(r,t,{content:i,darkMode:true,autoHide:true,angle:true,offsetLeft:20,bindOptions:{position:"top"}});b.bind(t,"mouseout",(function(){setTimeout((function(){a.notifiers.get(r).close()}),300)}));this.notifiers.set(r,n)}this.notifiers.get(r).show()}},{key:"buildHistory",value:function e(){}},{key:"addNewItem",value:function e(t){}},{key:"getCapacityLabel",value:function e(t){var r=getComputedStyle(document.body).getPropertyValue("--ui-color-base-35");var i=new d.Icon({icon:d.Actions.ARROW_TOP,size:14,color:r});return b.Tag.render(W||(W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker-text_capacity-label">\n\t\t\t\t','\n\t\t\t\t<div class="ai__picker-text_capacity-label-text">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),i.render(),this.getMessage("max_capacity").replace("#capacity#",t))}},{key:"getListWrapper",value:function e(){return b.Tag.render(z||(z=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_list-wrapper">\n\t\t\t\t<div class="ai__picker_list-wrapper-loader-text">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),b.Loc.getMessage("AI_JS_PICKER_HISTORY_LOADING"))}},{key:"getWrapper",value:function e(){return b.Tag.render(A||(A=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_history">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.listWrapper)}},{key:"render",value:function e(){return this.getWrapper()}},{key:"loadHistory",value:function e(){var t=this;if(!this.onLoadHistory){return null}return new Promise((function(e,r){t.onLoadHistory().then((function(r){t.isHistoryLoaded=true;t.items=r.data.items;t.capacity=r.data.capacity;e(r)}))["catch"]((function(e){r(e)}))}))}},{key:"generate",value:function e(t,r){}}]);return t}(P);var N,R;function j(e,t){X(e,t);t.add(e)}function B(e,t,r){X(e,t);t.set(e,r)}function X(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Y(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var U=new WeakMap;var K=new WeakMap;var J=new WeakMap;var V=new WeakMap;var q=new WeakSet;var Q=function(e){babelHelpers.inherits(t,e);function t(){var e;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,r));j(babelHelpers.assertThisInitialized(e),q);B(babelHelpers.assertThisInitialized(e),U,{writable:true,value:void 0});B(babelHelpers.assertThisInitialized(e),K,{writable:true,value:void 0});B(babelHelpers.assertThisInitialized(e),J,{writable:true,value:void 0});B(babelHelpers.assertThisInitialized(e),V,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(e),U,b.Type.isString(r===null||r===void 0?void 0:r.text)?r.text:"");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(e),K,null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(e),J,null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(e),V,false);return e}babelHelpers.createClass(t,[{key:"render",value:function e(){babelHelpers.classPrivateFieldSet(this,K,Y(this,q,Z).call(this));babelHelpers.classPrivateFieldSet(this,J,b.Tag.render(N||(N=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_image-loader-container ','">\n\t\t\t\t<div class="ai__picker_image-loader">\n\t\t\t\t\t<div class="ai__picker_image-loader-star ai__picker_image-loader-right-star --pulse"></div>\n\t\t\t\t\t<div class="ai__picker_image-loader-left-star-container">\n\t\t\t\t\t\t<div class="ai__picker_image-loader-left-star ai__picker_image-loader-star --pulse"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ai__picker_image-loader-square">\n\t\t\t\t\t\t<div class="ai__picker_image-loader-square-image"></div>\n\t\t\t\t\t\t<div class="ai__picker_image-loader-square-star ai__picker_image-loader-star --pulse"></div>\n\t\t\t\t\t\t<div class="ai__picker_image-loader-square-loader-line"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ai__picker_image-loader-text-container">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),babelHelpers.classPrivateFieldGet(this,V)?"--animating":"",babelHelpers.classPrivateFieldGet(this,K)));return babelHelpers.classPrivateFieldGet(this,J)}},{key:"getLayout",value:function e(){return babelHelpers.classPrivateFieldGet(this,J)}},{key:"setText",value:function e(t){babelHelpers.classPrivateFieldSet(this,U,t);if(babelHelpers.classPrivateFieldGet(this,K)){babelHelpers.classPrivateFieldGet(this,K).innerText=t}}},{key:"start",value:function e(){babelHelpers.classPrivateFieldSet(this,V,true);if(babelHelpers.classPrivateFieldGet(this,J)){b.Dom.addClass(babelHelpers.classPrivateFieldGet(this,J),"--animating")}}},{key:"stop",value:function e(){babelHelpers.classPrivateFieldSet(this,V,false);if(babelHelpers.classPrivateFieldGet(this,J)){b.Dom.removeClass(babelHelpers.classPrivateFieldGet(this,J),"--animating")}}}]);return t}(P);function Z(){return b.Tag.render(R||(R=babelHelpers.taggedTemplateLiteral(['<div class="ai__picker_image-loader-text">',"</div>"])),babelHelpers.classPrivateFieldGet(this,U))}var $,ee,te,re;function ie(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ie=function t(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function e(t,r,i){return t[r]=i}}function c(e,t,r,a){var n=t&&t.prototype instanceof h?t:h,s=Object.create(n.prototype),l=new F(a||[]);return i(s,"_invoke",{value:w(e,r,l)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function h(){}function d(){}function b(){}var v={};o(v,n,(function(){return this}));var f=Object.getPrototypeOf,g=f&&f(f(G([])));g&&g!==t&&r.call(g,n)&&(v=g);var y=b.prototype=h.prototype=Object.create(v);function m(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function H(e,t){function a(i,n,s,l){var o=u(e[i],e,n);if("throw"!==o.type){var c=o.arg,p=c.value;return p&&"object"==babelHelpers["typeof"](p)&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,s,l)}),(function(e){a("throw",e,s,l)})):t.resolve(p).then((function(e){c.value=e,s(c)}),(function(e){return a("throw",e,s,l)}))}l(o.arg)}var n;i(this,"_invoke",{value:function e(r,i){function s(){return new t((function(e,t){a(r,i,e,t)}))}return n=n?n.then(s,s):s()}})}function w(e,t,r){var i="suspendedStart";return function(a,n){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw n;return T()}for(r.method=a,r.arg=n;;){var s=r.delegate;if(s){var l=P(s,r);if(l){if(l===p)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var o=u(e,t,r);if("normal"===o.type){if(i=r.done?"completed":"suspendedYield",o.arg===p)continue;return{value:o.arg,done:r.done}}"throw"===o.type&&(i="completed",r.method="throw",r.arg=o.arg)}}}function P(e,t){var r=t.method,i=e.iterator[r];if(undefined===i)return t.delegate=null,"throw"===r&&e.iterator["return"]&&(t.method="return",t.arg=undefined,P(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var a=u(i,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var n=a.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,p):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function F(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function G(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=undefined,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:undefined,done:!0}}return d.prototype=b,i(y,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:d,configurable:!0}),d.displayName=o(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,o(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},m(H.prototype),o(H.prototype,s,(function(){return this})),e.AsyncIterator=H,e.async=function(t,r,i,a,n){void 0===n&&(n=Promise);var s=new H(c(t,r,i,a),n);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},m(y),o(y,l,"Generator"),o(y,n,(function(){return this})),o(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=G,F.prototype={constructor:F,reset:function e(t){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(k),!t)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=undefined)},stop:function e(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function e(t){if(this.done)throw t;var i=this;function a(e,r){return l.type="throw",l.arg=t,i.next=e,r&&(i.method="next",i.arg=undefined),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],l=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(o&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function e(t,i){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=i&&i<=s.finallyLoc&&(s=null);var l=s?s.completion:{};return l.type=t,l.arg=i,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(l)},complete:function e(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),k(i),p}},catch:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===t){var a=i.completion;if("throw"===a.type){var n=a.arg;k(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function e(t,r,i){return this.delegate={iterator:G(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=undefined),p}},e}function ae(e,t){se(e,t);t.add(e)}function ne(e,t,r){se(e,t);t.set(e,r)}function se(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function le(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var oe=Object.freeze({EMPTY:"empty",ERROR:"error",GENERATING:"generating",IN_LINE_FOR_GENERATING:"in_line_for_generating",IMAGE_LOADING:"image_loading",IMAGE_LOADING_SUCCESS:"image_loading_success",IMAGE_LOADING_ERROR:"image_loading_error"});var ce=new WeakMap;var ue=new WeakMap;var pe=new WeakMap;var he=new WeakMap;var de=new WeakMap;var be=new WeakMap;var ve=new WeakSet;var fe=new WeakSet;var ge=new WeakSet;var ye=new WeakSet;var me=function(e){babelHelpers.inherits(t,e);function t(e){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));ae(babelHelpers.assertThisInitialized(r),ye);ae(babelHelpers.assertThisInitialized(r),ge);ae(babelHelpers.assertThisInitialized(r),fe);ae(babelHelpers.assertThisInitialized(r),ve);ne(babelHelpers.assertThisInitialized(r),ce,{writable:true,value:void 0});ne(babelHelpers.assertThisInitialized(r),ue,{writable:true,value:void 0});ne(babelHelpers.assertThisInitialized(r),pe,{writable:true,value:void 0});ne(babelHelpers.assertThisInitialized(r),he,{writable:true,value:void 0});ne(babelHelpers.assertThisInitialized(r),de,{writable:true,value:void 0});ne(babelHelpers.assertThisInitialized(r),be,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),be,b.Type.isFunction(e.onSelect)?e.onSelect:null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),ue,e.state);r.setImage(e.image);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),pe,new Q);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),de,null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),he,null);return r}babelHelpers.createClass(t,[{key:"render",value:function e(){babelHelpers.classPrivateFieldSet(this,he,le(this,ye,_e).call(this));babelHelpers.classPrivateFieldSet(this,de,b.Tag.render($||($=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_history-image-group-item --empty">\n\t\t\t\t<div class="ai__picker_history-image-group-item-controls">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),le(this,ve,He).call(this),le(this,ge,Pe).call(this),babelHelpers.classPrivateFieldGet(this,he)));return babelHelpers.classPrivateFieldGet(this,de)}},{key:"setImage",value:function e(t){babelHelpers.classPrivateFieldSet(this,ce,t);if(babelHelpers.classPrivateFieldGet(this,he)){babelHelpers.classPrivateFieldSet(this,ue,babelHelpers.classPrivateFieldGet(this,ce)?oe.IMAGE_LOADING:oe.IMAGE_LOADING_ERROR);if(babelHelpers.classPrivateFieldGet(this,ue)===oe.IMAGE_LOADING_ERROR){b.Dom.removeClass(babelHelpers.classPrivateFieldGet(this,de),"--empty");b.Dom.addClass(babelHelpers.classPrivateFieldGet(this,de),"--error")}babelHelpers.classPrivateFieldGet(this,he).setAttribute("src",babelHelpers.classPrivateFieldGet(this,ce))}}},{key:"getImage",value:function e(){return babelHelpers.classPrivateFieldGet(this,ce)}},{key:"getState",value:function e(){return babelHelpers.classPrivateFieldGet(this,ue)}},{key:"isEmpty",value:function e(){return babelHelpers.classPrivateFieldGet(this,ue)===oe.EMPTY}},{key:"isInQueue",value:function e(){return babelHelpers.classPrivateFieldGet(this,ue)===oe.IN_LINE_FOR_GENERATING}},{key:"isGenerating",value:function e(){return babelHelpers.classPrivateFieldGet(this,ue)===oe.GENERATING}},{key:"setGeneratingState",value:function e(){babelHelpers.classPrivateFieldSet(this,ue,oe.GENERATING);babelHelpers.classPrivateFieldGet(this,pe).start()}}]);return t}(P);function He(){var e=this;var t="ai__picker_text-history-item-action-btn --paste --accent";var r=b.Tag.render(ee||(ee=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<button\n\t\t\t\tclass="','"\n\t\t\t>\n\t\t\t\t<span class="ai__picker_text-history-item-action-icon"></span>\n\t\t\t\t',"\n\t\t\t</button>\n\t\t"])),t,this.getMessage("action_use"));b.bind(r,"click",babelHelpers.asyncToGenerator(ie().mark((function t(){return ie().wrap((function t(r){while(1)switch(r.prev=r.next){case 0:try{babelHelpers.classPrivateFieldGet(e,be).call(e,le(e,fe,we).call(e,babelHelpers.classPrivateFieldGet(e,ce)))}catch(e){console.error(e)}case 1:case"end":return r.stop()}}),t)}))));return r}function we(e){var t=new URL(e);t.searchParams.set("t",Date.now());return t.href}function Pe(){if(babelHelpers.classPrivateFieldGet(this,ue)===oe.GENERATING){babelHelpers.classPrivateFieldGet(this,pe).start()}return b.Tag.render(te||(te=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_history-image-group-item-loader">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),babelHelpers.classPrivateFieldGet(this,pe).render())}function _e(){var e=this;var t=b.Tag.render(re||(re=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<img\n\t\t\t\tloading="lazy" \n\t\t\t\tclass="ai__picker_history-image-group-item-image"\n\t\t\t/>\n\t\t'])));if(babelHelpers.classPrivateFieldGet(this,ue)!==oe.GENERATING){t.setAttribute("src",babelHelpers.classPrivateFieldGet(this,ce))}t.onload=function(){babelHelpers.classPrivateFieldSet(e,ue,oe.IMAGE_LOADING_SUCCESS);b.Dom.removeClass(babelHelpers.classPrivateFieldGet(e,de),"--empty");b.Dom.removeClass(babelHelpers.classPrivateFieldGet(e,de),"--error");babelHelpers.classPrivateFieldGet(e,pe).getLayout().remove()};t.onerror=function(){if(babelHelpers.classPrivateFieldGet(e,ue)===oe.GENERATING||babelHelpers.classPrivateFieldGet(e,ue)===oe.EMPTY){babelHelpers.classPrivateFieldSet(e,ue,oe.IMAGE_LOADING_ERROR);b.Dom.removeClass(babelHelpers.classPrivateFieldGet(e,de),"--empty");b.Dom.addClass(babelHelpers.classPrivateFieldGet(e,de),"--error");babelHelpers.classPrivateFieldGet(e,pe).getLayout().remove()}};return t}var ke,Fe;function Ge(e,t){Se(e,t);t.add(e)}function Te(e,t,r){Se(e,t);t.set(e,r)}function Se(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function xe(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var Ie=new WeakMap;var Ee=new WeakMap;var Le=new WeakMap;var Ce=new WeakMap;var Me=new WeakMap;var Oe=new WeakMap;var We=new WeakMap;var ze=new WeakMap;var Ae=new WeakSet;var De=new WeakSet;var Ne=function(e){babelHelpers.inherits(t,e);function t(){var e;var r;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,i));Ge(babelHelpers.assertThisInitialized(r),De);Ge(babelHelpers.assertThisInitialized(r),Ae);Te(babelHelpers.assertThisInitialized(r),Ie,{writable:true,value:void 0});Te(babelHelpers.assertThisInitialized(r),Ee,{writable:true,value:void 0});Te(babelHelpers.assertThisInitialized(r),Le,{writable:true,value:void 0});Te(babelHelpers.assertThisInitialized(r),Ce,{writable:true,value:void 0});Te(babelHelpers.assertThisInitialized(r),Me,{writable:true,value:void 0});Te(babelHelpers.assertThisInitialized(r),Oe,{writable:true,value:void 0});Te(babelHelpers.assertThisInitialized(r),We,{writable:true,value:void 0});Te(babelHelpers.assertThisInitialized(r),ze,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Ie,b.Type.isString(i===null||i===void 0?void 0:(e=i.item)===null||e===void 0?void 0:e.payload)?i.item.payload:"");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Ee,b.Type.isInteger(i.size)?i.size:4);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Le,i.item||[]);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),We,b.Type.isBoolean(i.isNew)?i.isNew:false);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),ze,b.Type.isFunction(i.onSelect)?i.onSelect:null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Me,[]);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Oe,null);return r}babelHelpers.createClass(t,[{key:"render",value:function e(){babelHelpers.classPrivateFieldSet(this,Oe,b.Tag.render(ke||(ke=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_history-image-group">\n\t\t\t\t<div class="ai__picker_history-image-group-title">','</div>\n\t\t\t\t<div class="ai__picker_history-image-group-items">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),BX.util.htmlspecialchars(babelHelpers.classPrivateFieldGet(this,Ie)),xe(this,Ae,Re).call(this)));return babelHelpers.classPrivateFieldGet(this,Oe)}},{key:"getLayout",value:function e(){return babelHelpers.classPrivateFieldGet(this,Oe)}},{key:"remove",value:function e(){if(this.getLayout()){this.getLayout().remove()}}},{key:"addImage",value:function e(t){var r=babelHelpers.classPrivateFieldGet(this,Me).find((function(e){return e.isGenerating()}));if(!r){return}r.setImage(t);var i=babelHelpers.classPrivateFieldGet(this,Me).find((function(e){return e.isInQueue()}));if(!i){return}i.setGeneratingState()}},{key:"geGeneratedImagesCount",value:function e(){return babelHelpers.classPrivateFieldGet(this,Me).filter((function(e){return e.getState()===oe.IMAGE_LOADING||e.getState()===oe.IMAGE_LOADING_ERROR||e.getState()===oe.IMAGE_LOADING_SUCCESS})).length}}]);return t}(P);function Re(){var e=this;babelHelpers.classPrivateFieldSet(this,Ce,b.Tag.render(Fe||(Fe=babelHelpers.taggedTemplateLiteral(['<div class="ai__picker_history-image-group-items"></div>']))));xe(this,De,je).call(this).forEach((function(t){var r=babelHelpers.classPrivateFieldGet(e,We)?oe.GENERATING:oe.EMPTY;var i=new me({image:t,state:r,onSelect:babelHelpers.classPrivateFieldGet(e,ze)});i.subscribe("select",(function(t){e.emit("select",{item:t.data.item})}));babelHelpers.classPrivateFieldGet(e,Me).push(i);b.Dom.append(i.render(),babelHelpers.classPrivateFieldGet(e,Ce))}));return babelHelpers.classPrivateFieldGet(this,Ce)}function je(){var e=[];var t=babelHelpers.classPrivateFieldGet(this,Le).groupData||JSON.parse(babelHelpers.classPrivateFieldGet(this,Le).data);for(var r=0;r<babelHelpers.classPrivateFieldGet(this,Ee);r++){var i=t[r]||"";e.push(i)}return e}var Be;var Xe=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"render",value:function e(){var t=b.Loc.getMessage("AI_JS_PICKER_IMAGE_EMPTY_STATE");return b.Tag.render(Be||(Be=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_image-history-empty-state">\n\t\t\t\t<div class="ai__picker_image-history-empty-state-icon"></div>\n\t\t\t\t<div class="ai__picker_image-history-empty-state-text">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),t)}}]);return t}(P);var Ye;function Ue(e,t){Ke(e,t);t.add(e)}function Ke(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Je(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var Ve=new WeakSet;var qe=new WeakSet;var Qe=new WeakSet;var Ze=new WeakSet;var $e=new WeakSet;var et=new WeakSet;var tt=function(e){babelHelpers.inherits(t,e);function t(){var e;var r;babelHelpers.classCallCheck(this,t);for(var i=arguments.length,a=new Array(i),n=0;n<i;n++){a[n]=arguments[n]}r=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(a)));Ue(babelHelpers.assertThisInitialized(r),et);Ue(babelHelpers.assertThisInitialized(r),$e);Ue(babelHelpers.assertThisInitialized(r),Ze);Ue(babelHelpers.assertThisInitialized(r),Qe);Ue(babelHelpers.assertThisInitialized(r),qe);Ue(babelHelpers.assertThisInitialized(r),Ve);return r}babelHelpers.createClass(t,[{key:"render",value:function e(){this.buildHistory();return this.getWrapper()}},{key:"generate",value:function e(t){var r=this;if(!this.onGenerate){return null}if(this.items.length===0){b.Dom.clean(this.listWrapper)}var i=Je(this,$e,st).call(this,t);var a=Je(this,qe,it).call(this,i);return new Promise((function(e,i){r.onGenerate(t).then((function(t){r.items.push(t.data.last);var i=JSON.parse(t.data.result);i.forEach((function(e){a.addImage(e)}));e(t)}))["catch"]((function(e){Je(r,et,lt).call(r,a);i(e)}))}))}},{key:"buildHistory",value:function e(){var t=this;b.Dom.clean(this.listWrapper);if(this.items.length===0){var r=new Xe;b.Dom.append(r.render(),this.listWrapper)}this.items.forEach((function(e){try{Je(t,Ve,rt).call(t,e)}catch(t){console.error("AI.Picker: history item error",t,e)}}));if(this.items.length>3){b.Dom.append(this.getCapacityLabel(this.capacity),this.listWrapper)}}}]);return t}(D);function rt(e){var t=Je(this,Ze,nt).call(this,e);var r=Je(this,Qe,at).call(this,t);b.Dom.append(r,this.listWrapper);b.Dom.style(r,"opacity",1);return t}function it(e){var t=Je(this,Ze,nt).call(this,e,true);var r=Je(this,Qe,at).call(this,t);b.Dom.prepend(r,this.listWrapper);var i=b.Dom.getPosition(r),a=i.height;b.Dom.style(r,"height",0);requestAnimationFrame((function(){b.Dom.style(r,{opacity:1,height:"".concat(a,"px")})}));return t}function at(e){var t=b.Tag.render(Ye||(Ye=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__history-image_item-wrapper"></div>\n\t\t'])));b.Dom.append(e.render(),t);return t}function nt(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return new Ne({item:e,size:tt.imagesInItem,isNew:t,onSelect:this.onSelect})}function st(e){return{payload:e,id:Math.random(),groupData:[],data:""}}function lt(e){if(!e.getLayout()||!e.getLayout().parentElement){return}var t=e.getLayout().parentElement;b.Dom.style(t,"height",0);b.Dom.style(t,"padding-bottom",0);b.bind(t,"transitionend",(function(){b.Dom.remove(t)}))}babelHelpers.defineProperty(tt,"imagesInItem",4);var ot;var ct=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"render",value:function e(){return b.Tag.render(ot||(ot=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_text-loader">\n\t\t\t\t<div class="ai__picker_text-loader-line --one"></div>\n\t\t\t\t<div class="ai__picker_text-loader-line --two"></div>\n\t\t\t\t<div class="ai__picker_text-loader-line --three"></div>\n\t\t\t\t<div class="ai__picker_text-loader-line --four"></div>\n\t\t\t\t<div class="ai__picker_text-loader-cursor">\n\t\t\t\t\t<div class="ai__picker_text-loader-cursor-inner">\n\t\t\t\t\t\t<div class="ai__picker_text-loader-cursor-icon"></div>\n\t\t\t\t\t\t<span class="ai__picker_text-loader-cursor-text">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),b.Loc.getMessage("AI_JS_PICKER_TEXT_LOADER"))}}]);return t}(P);var ut,pt,ht,dt,bt,vt,ft,gt,yt,mt;function Ht(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ht=function t(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function e(t,r,i){return t[r]=i}}function c(e,t,r,a){var n=t&&t.prototype instanceof h?t:h,s=Object.create(n.prototype),l=new F(a||[]);return i(s,"_invoke",{value:w(e,r,l)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function h(){}function d(){}function b(){}var v={};o(v,n,(function(){return this}));var f=Object.getPrototypeOf,g=f&&f(f(G([])));g&&g!==t&&r.call(g,n)&&(v=g);var y=b.prototype=h.prototype=Object.create(v);function m(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function H(e,t){function a(i,n,s,l){var o=u(e[i],e,n);if("throw"!==o.type){var c=o.arg,p=c.value;return p&&"object"==babelHelpers["typeof"](p)&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,s,l)}),(function(e){a("throw",e,s,l)})):t.resolve(p).then((function(e){c.value=e,s(c)}),(function(e){return a("throw",e,s,l)}))}l(o.arg)}var n;i(this,"_invoke",{value:function e(r,i){function s(){return new t((function(e,t){a(r,i,e,t)}))}return n=n?n.then(s,s):s()}})}function w(e,t,r){var i="suspendedStart";return function(a,n){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw n;return T()}for(r.method=a,r.arg=n;;){var s=r.delegate;if(s){var l=P(s,r);if(l){if(l===p)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var o=u(e,t,r);if("normal"===o.type){if(i=r.done?"completed":"suspendedYield",o.arg===p)continue;return{value:o.arg,done:r.done}}"throw"===o.type&&(i="completed",r.method="throw",r.arg=o.arg)}}}function P(e,t){var r=t.method,i=e.iterator[r];if(undefined===i)return t.delegate=null,"throw"===r&&e.iterator["return"]&&(t.method="return",t.arg=undefined,P(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var a=u(i,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var n=a.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,p):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function F(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function G(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=undefined,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:undefined,done:!0}}return d.prototype=b,i(y,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:d,configurable:!0}),d.displayName=o(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,o(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},m(H.prototype),o(H.prototype,s,(function(){return this})),e.AsyncIterator=H,e.async=function(t,r,i,a,n){void 0===n&&(n=Promise);var s=new H(c(t,r,i,a),n);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},m(y),o(y,l,"Generator"),o(y,n,(function(){return this})),o(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=G,F.prototype={constructor:F,reset:function e(t){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(k),!t)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=undefined)},stop:function e(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function e(t){if(this.done)throw t;var i=this;function a(e,r){return l.type="throw",l.arg=t,i.next=e,r&&(i.method="next",i.arg=undefined),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],l=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(o&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function e(t,i){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=i&&i<=s.finallyLoc&&(s=null);var l=s?s.completion:{};return l.type=t,l.arg=i,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(l)},complete:function e(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),k(i),p}},catch:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===t){var a=i.completion;if("throw"===a.type){var n=a.arg;k(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function e(t,r,i){return this.delegate={iterator:G(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=undefined),p}},e}function wt(e,t){_t(e,t);t.add(e)}function Pt(e,t,r){_t(e,t);t.set(e,r)}function _t(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function kt(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var Ft=new WeakMap;var Gt=new WeakMap;var Tt=new WeakMap;var St=new WeakMap;var xt=new WeakMap;var It=new WeakMap;var Et=new WeakMap;var Lt=new WeakMap;var Ct=new WeakSet;var Mt=new WeakSet;var Ot=new WeakSet;var Wt=new WeakSet;var zt=new WeakSet;var At=new WeakSet;var Dt=new WeakSet;var Nt=new WeakSet;var Rt=new WeakSet;var jt=new WeakSet;var Bt=new WeakSet;var Xt=new WeakSet;var Yt=new WeakSet;var Ut=new WeakSet;var Kt=function(e){babelHelpers.inherits(t,e);function t(e){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));wt(babelHelpers.assertThisInitialized(r),Ut);wt(babelHelpers.assertThisInitialized(r),Yt);wt(babelHelpers.assertThisInitialized(r),Xt);wt(babelHelpers.assertThisInitialized(r),Bt);wt(babelHelpers.assertThisInitialized(r),jt);wt(babelHelpers.assertThisInitialized(r),Rt);wt(babelHelpers.assertThisInitialized(r),Nt);wt(babelHelpers.assertThisInitialized(r),Dt);wt(babelHelpers.assertThisInitialized(r),At);wt(babelHelpers.assertThisInitialized(r),zt);wt(babelHelpers.assertThisInitialized(r),Wt);wt(babelHelpers.assertThisInitialized(r),Ot);wt(babelHelpers.assertThisInitialized(r),Mt);wt(babelHelpers.assertThisInitialized(r),Ct);Pt(babelHelpers.assertThisInitialized(r),Ft,{writable:true,value:void 0});Pt(babelHelpers.assertThisInitialized(r),Gt,{writable:true,value:void 0});Pt(babelHelpers.assertThisInitialized(r),Tt,{writable:true,value:void 0});Pt(babelHelpers.assertThisInitialized(r),St,{writable:true,value:void 0});Pt(babelHelpers.assertThisInitialized(r),xt,{writable:true,value:void 0});Pt(babelHelpers.assertThisInitialized(r),It,{writable:true,value:void 0});Pt(babelHelpers.assertThisInitialized(r),Et,{writable:true,value:void 0});Pt(babelHelpers.assertThisInitialized(r),Lt,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Lt,e.onCopy);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Et,false);return r}babelHelpers.createClass(t,[{key:"generate",value:function(){var e=babelHelpers.asyncToGenerator(Ht().mark((function e(t){return Ht().wrap((function e(r){while(1)switch(r.prev=r.next){case 0:if(this.onGenerate){r.next=2;break}return r.abrupt("return",null);case 2:this.emit("ai-generate-start");r.next=5;return Promise.all([kt(this,Mt,qt).call(this),this.moveLastToHistory()]);case 5:return r.abrupt("return",kt(this,Ct,Jt).call(this,t));case 6:case"end":return r.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"render",value:function e(){this.buildHistory();return this.getWrapper()}},{key:"onCopyClick",value:function e(t,r){this.showNotify(r.target,"action_copy_notify_".concat(t.id),this.getMessage("action_copy_notify"));babelHelpers.classPrivateFieldGet(this,Lt).call(this,t)}},{key:"buildHistory",value:function e(){var t=this;b.Dom.style(this.listWrapper,"opacity",0);b.Dom.style(this.listWrapper,"transform","translateY(-30px)");b.Dom.clean(this.listWrapper);setTimeout((function(){var e=t.items[0];kt(t,Wt,Zt).call(t,e);kt(t,At,er).call(t,t.items.slice(1));kt(t,Ut,cr).call(t);b.Dom.style(t.listWrapper,{opacity:1,transform:"translateY(0)"});b.bindOnce(t.listWrapper,"transitionend",(function(){b.Dom.style(t.listWrapper,"transform",null)}))}),50)}},{key:"moveLastToHistory",value:function e(){var t=this;return new Promise((function(e){var r,i;var a=(r=babelHelpers.classPrivateFieldGet(t,xt))===null||r===void 0?void 0:r.firstElementChild;if(!a){e(true)}if(t.items.length>0&&!babelHelpers.classPrivateFieldGet(t,Tt)){babelHelpers.classPrivateFieldSet(t,Tt,kt(t,Bt,sr).call(t,b.Loc.getMessage("AI_JS_PICKER_TEXT_PREVIOUS_ITEMS_LABEL")));babelHelpers.classPrivateFieldGet(t,Ft).prepend(babelHelpers.classPrivateFieldGet(t,Tt))}b.Dom.removeClass(a.firstElementChild,"--first");kt(t,Xt,lr).call(t,a);var n=kt(t,Yt,or).call(t);b.bindOnce(a,"transitionend",(function(){n.remove();b.Dom.prepend(a,babelHelpers.classPrivateFieldGet(t,Gt));a.style=null;e(true)}));var s=((i=babelHelpers.classPrivateFieldGet(t,It))===null||i===void 0?void 0:i.offsetHeight)||0;var l=a.offsetHeight;var o=-b.Dom.getRelativePosition(a,n).y-(l-s);b.Dom.style(a,"transform","translateY(".concat(o,"px)"));b.Dom.style(n,"height","".concat(a.offsetHeight,"px"))}))}},{key:"moveTopHistoryItem",value:function e(){var t=this;return new Promise((function(e){babelHelpers.classPrivateFieldGet(t,xt).style=null;var r=babelHelpers.classPrivateFieldGet(t,Gt).children[0];kt(t,Xt,lr).call(t,r);var i=kt(t,Yt,or).call(t,r);requestAnimationFrame((function(){var a=-b.Dom.getRelativePosition(babelHelpers.classPrivateFieldGet(t,St),i).y;b.bindOnce(r,"transitionend",(function(){r.style=null;babelHelpers.classPrivateFieldGet(t,xt).prepend(r);e(true)}));b.bindOnce(i,"transitionend",(function(){i.remove()}));b.Dom.style(r,"transform","translateY(".concat(-a,"px"));b.Dom.addClass(r.children[0],"--first");b.Dom.style(i,"height","0px");var n=b.Dom.getPosition(r).height;b.Dom.style(babelHelpers.classPrivateFieldGet(t,St),"height","".concat(n,"px"))}))}))}}]);return t}(D);function Jt(e){return Vt.apply(this,arguments)}function Vt(){Vt=babelHelpers.asyncToGenerator(Ht().mark((function e(t){var r;return Ht().wrap((function e(i){while(1)switch(i.prev=i.next){case 0:i.prev=0;i.next=3;return this.onGenerate(t);case 3:r=i.sent;i.next=6;return kt(this,Dt,tr).call(this,r.data.last);case 6:this.emit("ai-generate-finish");return i.abrupt("return",r);case 10:i.prev=10;i.t0=i["catch"](0);kt(this,Nt,rr).call(this,i.t0);throw i.t0;case 14:case"end":return i.stop()}}),e,this,[[0,10]])})));return Vt.apply(this,arguments)}function qt(){var e=this;return new Promise((function(t){var r;if(!babelHelpers.classPrivateFieldGet(e,xt)){t(true)}b.Dom.style(babelHelpers.classPrivateFieldGet(e,St),"height","".concat((r=babelHelpers.classPrivateFieldGet(e,xt))===null||r===void 0?void 0:r.scrollHeight,"px"));b.bindOnce(babelHelpers.classPrivateFieldGet(e,St),"transitionend",(function(){t(true)}));babelHelpers.classPrivateFieldGet(e,It).hidden=false;b.Dom.append((new ct).render(),babelHelpers.classPrivateFieldGet(e,It));b.Dom.style(babelHelpers.classPrivateFieldGet(e,It),"opacity",1);b.Dom.style(babelHelpers.classPrivateFieldGet(e,St),"height","".concat(babelHelpers.classPrivateFieldGet(e,It).offsetHeight,"px"))}))}function Qt(){var e=this;return new Promise((function(t){if(babelHelpers.classPrivateFieldGet(e,It).hidden===true){t(true)}b.Dom.style(babelHelpers.classPrivateFieldGet(e,It),"opacity",0);b.bindOnce(babelHelpers.classPrivateFieldGet(e,It),"transitionend",(function(){b.Dom.clean(babelHelpers.classPrivateFieldGet(e,It));babelHelpers.classPrivateFieldGet(e,It).hidden=true;t(true)}))}))}function Zt(e){babelHelpers.classPrivateFieldSet(this,St,b.Tag.render(ut||(ut=babelHelpers.taggedTemplateLiteral(['<div class="ai__picker__text-history-last"></div>']))));kt(this,zt,$t).call(this);babelHelpers.classPrivateFieldSet(this,xt,b.Tag.render(pt||(pt=babelHelpers.taggedTemplateLiteral(['<div class="ai__picker__text-history-last-item"></div>']))));b.Dom.append(babelHelpers.classPrivateFieldGet(this,xt),babelHelpers.classPrivateFieldGet(this,St));b.Dom.append(babelHelpers.classPrivateFieldGet(this,It),babelHelpers.classPrivateFieldGet(this,St));b.Dom.clean(this.listWrapper);if(e){var t=kt(this,jt,nr).call(this);var r=kt(this,Rt,ar).call(this,e,true);b.Dom.append(r,t);b.Dom.append(t,babelHelpers.classPrivateFieldGet(this,xt))}b.Dom.prepend(babelHelpers.classPrivateFieldGet(this,St),this.listWrapper)}function $t(){babelHelpers.classPrivateFieldSet(this,It,b.Tag.render(ht||(ht=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker__text-history-loader"></div>\n\t\t']))));babelHelpers.classPrivateFieldGet(this,It).hidden=true;b.Dom.style(babelHelpers.classPrivateFieldGet(this,It),"opacity",0);return babelHelpers.classPrivateFieldGet(this,It)}function er(e){var t=this;babelHelpers.classPrivateFieldSet(this,Ft,b.Tag.render(dt||(dt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker__text-history-previous"></div>\n\t\t']))));if(e.length>1){babelHelpers.classPrivateFieldSet(this,Tt,kt(this,Bt,sr).call(this,b.Loc.getMessage("AI_JS_PICKER_TEXT_PREVIOUS_ITEMS_LABEL")));b.Dom.append(babelHelpers.classPrivateFieldGet(this,Tt),babelHelpers.classPrivateFieldGet(this,Ft))}babelHelpers.classPrivateFieldSet(this,Gt,b.Tag.render(bt||(bt=babelHelpers.taggedTemplateLiteral(['<div class="ai__picker__text-history-previous-items"></div>']))));b.Dom.append(babelHelpers.classPrivateFieldGet(this,Gt),babelHelpers.classPrivateFieldGet(this,Ft));e.slice(1).forEach((function(e){var r=kt(t,Rt,ar).call(t,e);var i=kt(t,jt,nr).call(t);b.Dom.append(r,i);b.Dom.append(i,babelHelpers.classPrivateFieldGet(t,Gt))}));b.Dom.append(babelHelpers.classPrivateFieldGet(this,Ft),this.listWrapper)}function tr(e){var t=this;return new Promise((function(r){b.Dom.style(babelHelpers.classPrivateFieldGet(t,xt),{opacity:0,transform:"translateY(-5px)"});t.items.unshift(e);kt(t,Ut,cr).call(t);kt(t,Ot,Qt).call(t).then((function(){var i=kt(t,jt,nr).call(t);var a=kt(t,Rt,ar).call(t,e,true);b.Dom.append(a,i);b.Dom.append(i,babelHelpers.classPrivateFieldGet(t,xt));babelHelpers.classPrivateFieldGet(t,xt).style=null;b.Dom.style(babelHelpers.classPrivateFieldGet(t,St),"height","".concat(babelHelpers.classPrivateFieldGet(t,St).scrollHeight,"px"));var n=function e(){babelHelpers.classPrivateFieldGet(t,xt).removeAttribute("style")};b.bindOnce(babelHelpers.classPrivateFieldGet(t,xt),"transitionend",(function(){n();r(true)}))}))["catch"]((function(e){console.error(e)}))}))}function rr(){return ir.apply(this,arguments)}function ir(){ir=babelHelpers.asyncToGenerator(Ht().mark((function e(){return Ht().wrap((function e(t){while(1)switch(t.prev=t.next){case 0:t.next=2;return kt(this,Ot,Qt).call(this);case 2:if(!(this.items.length===0)){t.next=5;break}this.emit("ai-generate-failed");return t.abrupt("return");case 5:t.next=7;return this.moveTopHistoryItem();case 7:this.emit("ai-generate-failed");case 8:case"end":return t.stop()}}),e,this)})));return ir.apply(this,arguments)}function ar(e,t){if(!e){return null}var r="ai__picker_text-history-item ".concat(t?"--first":"");var i=t?"--accent":"";var a="ai__picker_text-history-item-action-btn --copy";var n="ai__picker_text-history-item-action-btn --paste ".concat(i);return b.Tag.render(vt||(vt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<article\n\t\t\t\tclass="','"\n\t\t\t>\n\t\t\t\t<div class="ai__picker_text-history-item-text">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="ai__picker_text-history-item-actions">\n\t\t\t\t\t<div class="ai__picker_text-history-item-action">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass="','"\n\t\t\t\t\t\t\tonclick="','"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class="ai__picker_text-history-item-action-icon"></span>\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ai__picker_text-history-item-action">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass="','"\n\t\t\t\t\t\t\tonclick="','"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class="ai__picker_text-history-item-action-icon"></span>\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</article>\n\t\t"])),r,b.Text.encode(e.data).replaceAll(/(\r\n|\r|\n)/g,"<br>"),n,this.onSelectClick.bind(this,e),this.getMessage("action_use"),a,this.onCopyClick.bind(this,e),this.getMessage("action_copy"))}function nr(){return b.Tag.render(ft||(ft=babelHelpers.taggedTemplateLiteral(['<div class="ai__picker_text-history-item-wrapper"></div>'])))}function sr(e){var t=e?b.Tag.render(gt||(gt=babelHelpers.taggedTemplateLiteral(['<span class="ai__picker_text-history-item-divider-text">',"</span>"])),e):"";return b.Tag.render(yt||(yt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_text-history-item-divider">\n\t\t\t\t<hr class="ai__picker_text-history-item-divider-line"/>\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),t)}function lr(e){var t=b.Dom.getPosition(e);b.Dom.style(e,{position:"fixed",top:"".concat(t.y,"px"),left:"".concat(t.x,"px"),width:"".concat(t.width,"px")});return e}function or(e){var t=b.Dom.getPosition(e).height;var r=b.Tag.render(mt||(mt=babelHelpers.taggedTemplateLiteral(['<div class="ai__picker_text-history-space-for-new-item"></div>'])));b.Dom.style(r,"height","".concat(t,"px"));if(e){b.Dom.insertBefore(r,e.nextSibling)}else{babelHelpers.classPrivateFieldGet(this,Gt).prepend(r)}return r}function cr(){if(this.items.length>Math.round(this.capacity/2)&&!babelHelpers.classPrivateFieldGet(this,Et)){b.Dom.append(this.getCapacityLabel(this.capacity),this.listWrapper);babelHelpers.classPrivateFieldSet(this,Et,true)}}var ur,pr;function hr(e,t){br(e,t);t.add(e)}function dr(e,t,r){br(e,t);t.set(e,r)}function br(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function vr(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var fr=new WeakMap;var gr=new WeakMap;var yr=new WeakMap;var mr=new WeakSet;var Hr=new WeakSet;var wr=function(e){babelHelpers.inherits(t,e);function t(e){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));hr(babelHelpers.assertThisInitialized(r),Hr);hr(babelHelpers.assertThisInitialized(r),mr);dr(babelHelpers.assertThisInitialized(r),fr,{writable:true,value:void 0});dr(babelHelpers.assertThisInitialized(r),gr,{writable:true,value:void 0});dr(babelHelpers.assertThisInitialized(r),yr,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),fr,null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),gr,b.Type.isString(e.value)?e.value:"");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),yr,b.Type.isString(e.placeholder)?e.placeholder:"");return r}babelHelpers.createClass(t,[{key:"getValue",value:function e(){return babelHelpers.classPrivateFieldGet(this,fr).value}},{key:"setValue",value:function e(t){if(b.Type.isString(t)&&babelHelpers.classPrivateFieldGet(this,fr)){babelHelpers.classPrivateFieldGet(this,fr).value=t}}},{key:"render",value:function e(){return b.Tag.render(ur||(ur=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_textarea_wrapper">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),vr(this,mr,Pr).call(this))}},{key:"disable",value:function e(){babelHelpers.classPrivateFieldGet(this,fr).disabled=true}},{key:"enable",value:function e(){babelHelpers.classPrivateFieldGet(this,fr).disabled=false}},{key:"focus",value:function e(){var t=babelHelpers.classPrivateFieldGet(this,fr).value.length;babelHelpers.classPrivateFieldGet(this,fr).setSelectionRange(t,t);babelHelpers.classPrivateFieldGet(this,fr).focus()}},{key:"isDisabled",value:function e(){return babelHelpers.classPrivateFieldGet(this,fr).disabled}}]);return t}(P);function Pr(){babelHelpers.classPrivateFieldSet(this,fr,b.Tag.render(pr||(pr=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<textarea\n\t\t\t\tclass="ai__picker_textarea"\n\t\t\t\tplaceholder="','"\n\t\t\t>\n\t\t\t\t',"\n\t\t\t</textarea>\n\t\t"])),babelHelpers.classPrivateFieldGet(this,yr),babelHelpers.classPrivateFieldGet(this,gr)));b.bind(babelHelpers.classPrivateFieldGet(this,fr),"input",vr(this,Hr,_r).bind(this));this.setValue(babelHelpers.classPrivateFieldGet(this,gr));return babelHelpers.classPrivateFieldGet(this,fr)}function _r(e){var t=e.target.value;s.EventEmitter.emit(this,"input",{value:t});this.setValue(t)}var kr,Fr,Gr,Tr,Sr;function xr(e,t){Er(e,t);t.add(e)}function Ir(e,t,r){Er(e,t);t.set(e,r)}function Er(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Lr(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var Cr=Object.freeze({PENCIL:"pencil",BRUSH:"brush"});var Mr=new WeakMap;var Or=new WeakMap;var Wr=new WeakMap;var zr=new WeakMap;var Ar=new WeakMap;var Dr=new WeakMap;var Nr=new WeakMap;var Rr=new WeakMap;var jr=new WeakSet;var Br=new WeakSet;var Xr=new WeakSet;var Yr=new WeakSet;var Ur=new WeakSet;var Kr=new WeakSet;var Jr=new WeakSet;var Vr=new WeakSet;var qr=new WeakSet;var Qr=function(e){babelHelpers.inherits(t,e);function t(e){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));xr(babelHelpers.assertThisInitialized(r),qr);xr(babelHelpers.assertThisInitialized(r),Vr);xr(babelHelpers.assertThisInitialized(r),Jr);xr(babelHelpers.assertThisInitialized(r),Kr);xr(babelHelpers.assertThisInitialized(r),Ur);xr(babelHelpers.assertThisInitialized(r),Yr);xr(babelHelpers.assertThisInitialized(r),Xr);xr(babelHelpers.assertThisInitialized(r),Br);xr(babelHelpers.assertThisInitialized(r),jr);Ir(babelHelpers.assertThisInitialized(r),Mr,{writable:true,value:void 0});Ir(babelHelpers.assertThisInitialized(r),Or,{writable:true,value:void 0});Ir(babelHelpers.assertThisInitialized(r),Wr,{writable:true,value:void 0});Ir(babelHelpers.assertThisInitialized(r),zr,{writable:true,value:void 0});Ir(babelHelpers.assertThisInitialized(r),Ar,{writable:true,value:void 0});Ir(babelHelpers.assertThisInitialized(r),Dr,{writable:true,value:void 0});Ir(babelHelpers.assertThisInitialized(r),Nr,{writable:true,value:void 0});Ir(babelHelpers.assertThisInitialized(r),Rr,{writable:true,value:void 0});r.setEventNamespace("AI:Picker:TextMessage");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Wr,e.hint);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),zr,null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Dr,null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Ar,Lr(babelHelpers.assertThisInitialized(r),jr,Zr).call(babelHelpers.assertThisInitialized(r),e.submitButtonIcon)?e.submitButtonIcon:"pencil");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Rr,e.isLoading);return r}babelHelpers.createClass(t,[{key:"focus",value:function e(){if(!babelHelpers.classPrivateFieldGet(this,Or)){return}babelHelpers.classPrivateFieldGet(this,Or).focus()}},{key:"getButton",value:function e(){var t=this;var r=new n.Button({text:this.getMessage("submit"),round:true,color:n.Button.Color.PRIMARY,icon:n.ButtonIcon.SEARCH,onclick:function e(r){if(r.getState()===null&&babelHelpers.classPrivateFieldGet(t,Or).getValue()!==""){t.emit("submit",{text:babelHelpers.classPrivateFieldGet(t,Or).getValue()})}},state:this.props.message?"":n.Button.State.DISABLED,className:"ai__picker_submit-btn --".concat(babelHelpers.classPrivateFieldGet(this,Ar))});babelHelpers.classPrivateFieldSet(this,Mr,r);return r.render()}},{key:"closeMenu",value:function e(){if(babelHelpers.classPrivateFieldGet(this,zr)){babelHelpers.classPrivateFieldGet(this,zr).close()}}},{key:"render",value:function e(){babelHelpers.classPrivateFieldSet(this,Nr,b.Tag.render(kr||(kr=babelHelpers.taggedTemplateLiteral(["<div></div>"]))));babelHelpers.classPrivateFieldSet(this,Dr,b.Tag.render(Fr||(Fr=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_text-message">\n\t\t\t\t<div class="ai__picker_text-message_text-field-wrapper">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),Lr(this,Xr,ei).call(this).render(),Lr(this,Jr,ai).call(this),babelHelpers.classPrivateFieldGet(this,Nr)));Lr(this,Br,$r).call(this);return babelHelpers.classPrivateFieldGet(this,Dr)}},{key:"disable",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Or)){babelHelpers.classPrivateFieldGet(this,Or).disable()}Lr(this,Kr,ii).call(this,n.Button.State.DISABLED)}},{key:"enable",value:function e(){babelHelpers.classPrivateFieldGet(this,Or).enable();if(babelHelpers.classPrivateFieldGet(this,Or).getValue()){Lr(this,Kr,ii).call(this,null)}}},{key:"startLoading",value:function e(){babelHelpers.classPrivateFieldSet(this,Rr,true);babelHelpers.classPrivateFieldGet(this,Or).disable();Lr(this,Kr,ii).call(this,n.Button.State.CLOCKING)}},{key:"finishLoading",value:function e(){babelHelpers.classPrivateFieldSet(this,Rr,false);babelHelpers.classPrivateFieldGet(this,Or).enable();var t=Lr(this,Ur,ri).call(this);Lr(this,Kr,ii).call(this,t)}}]);return t}(P);function Zr(e){return Object.values(Cr).includes(e)}function $r(){if(babelHelpers.classPrivateFieldGet(this,Nr)){babelHelpers.classPrivateFieldGet(this,Nr).innerHTML="";b.Dom.append(this.getButton(),babelHelpers.classPrivateFieldGet(this,Nr))}}function ei(){var e=this.getMessage("placeholder");var t=new wr({value:this.props.message,placeholder:e});babelHelpers.classPrivateFieldSet(this,Or,t);s.EventEmitter.subscribe(t,"input",Lr(this,Yr,ti).bind(this));return t}function ti(e){if(e.data.value&&babelHelpers.classPrivateFieldGet(this,Rr)===false){Lr(this,Kr,ii).call(this,null)}else{Lr(this,Kr,ii).call(this,n.Button.State.DISABLED)}}function ri(){if(babelHelpers.classPrivateFieldGet(this,Rr)){return n.Button.State.CLOCKING}if(!babelHelpers.classPrivateFieldGet(this,Or).getValue()){return n.Button.State.DISABLED}return null}function ii(e){if(babelHelpers.classPrivateFieldGet(this,Mr)){babelHelpers.classPrivateFieldGet(this,Mr).getContainer().blur();babelHelpers.classPrivateFieldGet(this,Mr).setState(e)}}function ai(){var e=this;if(!babelHelpers.classPrivateFieldGet(this,Wr)){return null}var t=babelHelpers.classPrivateFieldGet(this,Wr).title;var r=babelHelpers.classPrivateFieldGet(this,Wr).text;var i=new d.Icon({icon:d.Main.INFO_1,color:getComputedStyle(document.body).getPropertyValue("--ui-color-base-40"),size:16});var a=b.Tag.render(Gr||(Gr=babelHelpers.taggedTemplateLiteral(['<div class="ai__picker_text-message-hint-icon">',"</div>"])),i.render());var n=b.Tag.render(Tr||(Tr=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_text-message-hint">\n\t\t\t\t','\n\t\t\t\t<div class="ai__picker_text-message-hint-title">',"</div>\n\t\t\t</div>\n\t\t"])),a,t);var s=b.Tag.render(Sr||(Sr=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker_text-message-hint-text">',"</div>\n\t\t"])),r);var l=false;var o=294;b.bind(n,"mouseenter",(function(){if(!babelHelpers.classPrivateFieldGet(e,zr)){babelHelpers.classPrivateFieldSet(e,zr,Lr(e,Vr,ni).call(e,{width:o,content:s,targetContainer:a.closest("body")}))}l=true;var t=500;setTimeout((function(){if(l){Lr(e,qr,si).call(e,a,o)}}),t)}));b.bind(n,"mouseleave",(function(){babelHelpers.classPrivateFieldGet(e,zr).close();l=false}));return n}function ni(e){return new l.Popup({angle:{position:"top",offset:e.width/2-17},animation:"fading-slide",content:e.content,maxWidth:e.width,padding:10,targetContainer:e.targetContainer,darkMode:true,closeByEsc:true,autoHide:true})}function si(e,t){var r=e.getBoundingClientRect();var i={left:r.left+r.width/2-t/2+40,top:r.bottom};babelHelpers.classPrivateFieldGet(this,zr).setToFrontOnShow();babelHelpers.classPrivateFieldGet(this,zr).setBindElement(i);babelHelpers.classPrivateFieldGet(this,zr).adjustPosition();babelHelpers.classPrivateFieldGet(this,zr).show()}var li={Base:P,IconClose:k,Header:M,HistoryImage:tt,HistoryText:Kt,TextMessage:Qr};var oi;function ci(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ci=function t(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function e(t,r,i){return t[r]=i}}function c(e,t,r,a){var n=t&&t.prototype instanceof h?t:h,s=Object.create(n.prototype),l=new F(a||[]);return i(s,"_invoke",{value:w(e,r,l)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function h(){}function d(){}function b(){}var v={};o(v,n,(function(){return this}));var f=Object.getPrototypeOf,g=f&&f(f(G([])));g&&g!==t&&r.call(g,n)&&(v=g);var y=b.prototype=h.prototype=Object.create(v);function m(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function H(e,t){function a(i,n,s,l){var o=u(e[i],e,n);if("throw"!==o.type){var c=o.arg,p=c.value;return p&&"object"==babelHelpers["typeof"](p)&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,s,l)}),(function(e){a("throw",e,s,l)})):t.resolve(p).then((function(e){c.value=e,s(c)}),(function(e){return a("throw",e,s,l)}))}l(o.arg)}var n;i(this,"_invoke",{value:function e(r,i){function s(){return new t((function(e,t){a(r,i,e,t)}))}return n=n?n.then(s,s):s()}})}function w(e,t,r){var i="suspendedStart";return function(a,n){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw n;return T()}for(r.method=a,r.arg=n;;){var s=r.delegate;if(s){var l=P(s,r);if(l){if(l===p)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var o=u(e,t,r);if("normal"===o.type){if(i=r.done?"completed":"suspendedYield",o.arg===p)continue;return{value:o.arg,done:r.done}}"throw"===o.type&&(i="completed",r.method="throw",r.arg=o.arg)}}}function P(e,t){var r=t.method,i=e.iterator[r];if(undefined===i)return t.delegate=null,"throw"===r&&e.iterator["return"]&&(t.method="return",t.arg=undefined,P(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var a=u(i,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var n=a.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,p):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function F(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function G(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=undefined,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:undefined,done:!0}}return d.prototype=b,i(y,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:d,configurable:!0}),d.displayName=o(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,o(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},m(H.prototype),o(H.prototype,s,(function(){return this})),e.AsyncIterator=H,e.async=function(t,r,i,a,n){void 0===n&&(n=Promise);var s=new H(c(t,r,i,a),n);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},m(y),o(y,l,"Generator"),o(y,n,(function(){return this})),o(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=G,F.prototype={constructor:F,reset:function e(t){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(k),!t)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=undefined)},stop:function e(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function e(t){if(this.done)throw t;var i=this;function a(e,r){return l.type="throw",l.arg=t,i.next=e,r&&(i.method="next",i.arg=undefined),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],l=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(o&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function e(t,i){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=i&&i<=s.finallyLoc&&(s=null);var l=s?s.completion:{};return l.type=t,l.arg=i,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(l)},complete:function e(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),k(i),p}},catch:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===t){var a=i.completion;if("throw"===a.type){var n=a.arg;k(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function e(t,r,i){return this.delegate={iterator:G(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=undefined),p}},e}function ui(e,t){pi(e,t);t.add(e)}function pi(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function hi(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var di=new WeakSet;var bi=new WeakSet;var vi=function(e){babelHelpers.inherits(t,e);function t(){var e;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,r));ui(babelHelpers.assertThisInitialized(e),bi);ui(babelHelpers.assertThisInitialized(e),di);e.onGenerate=r.onGenerate;e.onLoadHistory=r.onLoadHistory;e.onTariffRestriction=r.onTariffRestriction;e.startMessage=r.startMessage;e.engines=r.engines;e.items=[];e.capacity=30;e.historyContainer=null;e.isToolingLoading=false;e.engine=r.engine;e.context=r.context;e.isResultCopied=false;e.isResultSelected=false;e.onSelect=r.onSelect;e.pickerType="";e.setEventNamespace("AI:PickerBase");return e}babelHelpers.createClass(t,[{key:"render",value:function e(){throw new Error("You must implement render method")}},{key:"setEngineParameters",value:function e(t){if(this.engine){this.engine.setParameters(t)}}},{key:"setOnGenerate",value:function e(t){this.onGenerate=t}},{key:"setEngine",value:function e(t){this.engine=t}},{key:"setOnLoadHistory",value:function e(t){this.onLoadHistory=t}},{key:"setStartMessage",value:function e(t){this.startMessage=t}},{key:"setContext",value:function e(t){this.context=t}},{key:"isResultUsed",value:function e(){return this.isResultCopied||this.isResultSelected}},{key:"resetResultUsedFlag",value:function e(){this.isResultCopied=false;this.isResultSelected=false}},{key:"closeAllMenus",value:function e(){this.textMessage.closeMenu()}},{key:"initTooling",value:function(){var e=babelHelpers.asyncToGenerator(ci().mark((function e(t){var r=this;var i;return ci().wrap((function e(t){while(1)switch(t.prev=t.next){case 0:this.isToolingLoading=true;if(this.textMessage){this.textMessage.startLoading()}t.prev=2;t.next=5;return this.engine.getImagePickerTooling();case 5:i=t.sent;this.engines=i.data.engines;this.items=i.data.history.items;this.capacity=i.data.history.capacity;if(this.textMessage){this.textMessage.finishLoading();this.textMessage.focus()}t.next=16;break;case 12:t.prev=12;t.t0=t["catch"](2);console.error(t.t0);BX.UI.Notification.Center.notify({id:"AI_JS_PICKER_INIT_ERROR",content:b.Loc.getMessage("AI_JS_PICKER_INIT_ERROR"),showOnTopWindow:true});case 16:t.prev=16;if(this.history){this.history.items=this.items;b.Dom.style(this.historyContainer,"opacity",0);b.bindOnce(this.historyContainer,"transitionend",(function(){b.Dom.clean(r.historyContainer);b.Dom.append(r.history.render(),r.historyContainer);b.Dom.style(r.historyContainer,"opacity",1)}))}if(this.textMessage){this.textMessage.finishLoading()}this.isToolingLoading=false;return t.finish(16);case 21:case"end":return t.stop()}}),e,this,[[2,12,16,21]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"renderTextMessage",value:function e(){this.initTextMessage();return b.Tag.render(oi||(oi=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker-text_message-field">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.textMessage.render())}},{key:"initTextMessage",value:function e(){this.textMessage=new li.TextMessage({message:this.startMessage,engines:this.engines,submitButtonIcon:this.getTextMessageSubmitButtonIcon(),hint:this.getHint(),context:this.context,isLoading:this.isToolingLoading});this.textMessage.subscribe("submit",this.handleTextMessageSubmit.bind(this))}},{key:"handleSelect",value:function e(t){this.isResultSelected=true;this.emit("select",{item:t.data.item})}},{key:"handleCopy",value:function e(t){this.isResultCopied=true;this.emit("copy",{item:t.data.item})}},{key:"getTextMessageSubmitButtonIcon",value:function e(){return Cr.PENCIL}},{key:"getHint",value:function e(){return null}},{key:"handleTextMessageSubmit",value:function e(t){var r=t.data.text;this.generate(r)}},{key:"generate",value:function e(t){var r=this;this.textMessage.startLoading();this.history.generate(t).then((function(){r.textMessage.finishLoading()}))["catch"]((function(e){var i;r.textMessage.finishLoading();var a=(i=e.errors)===null||i===void 0?void 0:i[0];if(hi(r,di,fi).call(r,a)){hi(r,bi,gi).call(r,a,t)}else if((a===null||a===void 0?void 0:a.code)==="LIMIT_IS_EXCEEDED_MONTHLY"||(a===null||a===void 0?void 0:a.code)==="LIMIT_IS_EXCEEDED_DAILY"||(a===null||a===void 0?void 0:a.code)==="LIMIT_IS_EXCEEDED_BAAS"||(a===null||a===void 0?void 0:a.code)==="SERVICE_IS_NOT_AVAILABLE_BY_TARIFF"){p.AjaxErrorHandler.handleImageGenerateError({errorCode:a===null||a===void 0?void 0:a.code,baasOptions:{bindElement:null,useSlider:true,context:"notSet"}});r.textMessage.finishLoading()}else{r.handleGenerateFail()}}))}},{key:"handleGenerateFail",value:function e(){BX.UI.Notification.Center.notify({id:"AI_JS_PICKER_TEXT_GENERATE_FAILED",content:b.Loc.getMessage("AI_JS_PICKER_TEXT_GENERATE_FAILED"),showOnTopWindow:true});this.textMessage.finishLoading()}}]);return t}(P);function fi(e){return(e===null||e===void 0?void 0:e.code)==="AGREEMENT_IS_NOT_ACCEPTED"}function gi(e,t){var r=this;var i=e.customData;var a=this.engines.find((function(e){return e.selected}));var n=new h.Agreement({agreement:{title:i.title,text:i.text,accepted:i.accepted},engineCode:a.code,engine:this.engine,type:this.pickerType});n.showAgreementPopup((function(){r.generate(t)}))}var yi,mi,Hi;function wi(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */wi=function t(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function e(t,r,i){return t[r]=i}}function c(e,t,r,a){var n=t&&t.prototype instanceof h?t:h,s=Object.create(n.prototype),l=new F(a||[]);return i(s,"_invoke",{value:w(e,r,l)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function h(){}function d(){}function b(){}var v={};o(v,n,(function(){return this}));var f=Object.getPrototypeOf,g=f&&f(f(G([])));g&&g!==t&&r.call(g,n)&&(v=g);var y=b.prototype=h.prototype=Object.create(v);function m(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function H(e,t){function a(i,n,s,l){var o=u(e[i],e,n);if("throw"!==o.type){var c=o.arg,p=c.value;return p&&"object"==babelHelpers["typeof"](p)&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,s,l)}),(function(e){a("throw",e,s,l)})):t.resolve(p).then((function(e){c.value=e,s(c)}),(function(e){return a("throw",e,s,l)}))}l(o.arg)}var n;i(this,"_invoke",{value:function e(r,i){function s(){return new t((function(e,t){a(r,i,e,t)}))}return n=n?n.then(s,s):s()}})}function w(e,t,r){var i="suspendedStart";return function(a,n){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw n;return T()}for(r.method=a,r.arg=n;;){var s=r.delegate;if(s){var l=P(s,r);if(l){if(l===p)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var o=u(e,t,r);if("normal"===o.type){if(i=r.done?"completed":"suspendedYield",o.arg===p)continue;return{value:o.arg,done:r.done}}"throw"===o.type&&(i="completed",r.method="throw",r.arg=o.arg)}}}function P(e,t){var r=t.method,i=e.iterator[r];if(undefined===i)return t.delegate=null,"throw"===r&&e.iterator["return"]&&(t.method="return",t.arg=undefined,P(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var a=u(i,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var n=a.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,p):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function F(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function G(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=undefined,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:undefined,done:!0}}return d.prototype=b,i(y,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:d,configurable:!0}),d.displayName=o(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,o(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},m(H.prototype),o(H.prototype,s,(function(){return this})),e.AsyncIterator=H,e.async=function(t,r,i,a,n){void 0===n&&(n=Promise);var s=new H(c(t,r,i,a),n);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},m(y),o(y,l,"Generator"),o(y,n,(function(){return this})),o(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=G,F.prototype={constructor:F,reset:function e(t){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(k),!t)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=undefined)},stop:function e(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function e(t){if(this.done)throw t;var i=this;function a(e,r){return l.type="throw",l.arg=t,i.next=e,r&&(i.method="next",i.arg=undefined),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],l=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(o&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function e(t,i){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=i&&i<=s.finallyLoc&&(s=null);var l=s?s.completion:{};return l.type=t,l.arg=i,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(l)},complete:function e(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),k(i),p}},catch:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===t){var a=i.completion;if("throw"===a.type){var n=a.arg;k(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function e(t,r,i){return this.delegate={iterator:G(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=undefined),p}},e}function Pi(e,t){ki(e,t);t.add(e)}function _i(e,t,r){ki(e,t);t.set(e,r)}function ki(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Fi(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var Gi=new WeakMap;var Ti=new WeakSet;var Si=new WeakSet;var xi=function(e){babelHelpers.inherits(t,e);function t(){var e;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,r));Pi(babelHelpers.assertThisInitialized(e),Si);Pi(babelHelpers.assertThisInitialized(e),Ti);_i(babelHelpers.assertThisInitialized(e),Gi,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(e),Gi,r.onCopy);e.pickerType="text";e.setEventNamespace("AI:PickerText");return e}babelHelpers.createClass(t,[{key:"render",value:function e(){return b.Tag.render(yi||(yi=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker-text">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.renderTextMessage(),Fi(this,Ti,Ii).call(this))}},{key:"initHistory",value:function e(){var t=this;var r=function e(r){var i;var a=t.engines.find((function(e){return e.selected}));var n=(i=a===null||a===void 0?void 0:a.code)!==null&&i!==void 0?i:t.engines[0].code;return t.onGenerate(r,n)};this.history=new li.HistoryText({items:this.items,capacity:this.capacity,onGenerate:r,onSelect:this.onSelect,onCopy:babelHelpers.classPrivateFieldGet(this,Gi)})}},{key:"acceptAgreement",value:function(){var e=babelHelpers.asyncToGenerator(wi().mark((function e(t){return wi().wrap((function e(r){while(1)switch(r.prev=r.next){case 0:return r.abrupt("return",this.engine.acceptTextAgreement(t));case 1:case"end":return r.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]);return t}(vi);function Ii(){this.initHistory();this.historyContainer=b.Tag.render(mi||(mi=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker-text_history">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.isToolingLoading?Fi(this,Si,Ei).call(this):this.history.render());return this.historyContainer}function Ei(){return b.Tag.render(Hi||(Hi=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker-text_history-loader">',"</div>\n\t\t"])),b.Loc.getMessage("AI_JS_PICKER_HISTORY_LOADING"))}var Li,Ci,Mi;function Oi(e,t){Wi(e,t);t.add(e)}function Wi(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function zi(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var Ai=new WeakSet;var Di=new WeakSet;var Ni=function(e){babelHelpers.inherits(t,e);function t(){var e;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,r));Oi(babelHelpers.assertThisInitialized(e),Di);Oi(babelHelpers.assertThisInitialized(e),Ai);e.pickerType="image";e.setEventNamespace("AI:PickerImage");return e}babelHelpers.createClass(t,[{key:"render",value:function e(){return b.Tag.render(Li||(Li=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker-image">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.renderTextMessage(),zi(this,Ai,Ri).call(this))}},{key:"getTextMessageSubmitButtonIcon",value:function e(){return Cr.BRUSH}},{key:"initHistory",value:function e(){var t=this;var r=function e(r){var i;var a=t.engines.find((function(e){return e.selected}));var n=(i=a===null||a===void 0?void 0:a.code)!==null&&i!==void 0?i:t.engines[0].code;return t.onGenerate(r,n)};this.history=new tt({items:this.items,capacity:this.capacity,onGenerate:r,onSelect:this.onSelect})}},{key:"getHint",value:function e(){if(b.Loc.getMessage("LANGUAGE_ID")!=="en"){return{title:b.Loc.getMessage("AI_JS_PICKER_IMAGE_HINT_TITLE"),text:b.Loc.getMessage("AI_JS_PICKER_IMAGE_HINT_TEXT")}}return null}},{key:"acceptAgreement",value:function e(t){return this.engine.acceptImageAgreement(t)}},{key:"isResultUsed",value:function e(){return this.isResultSelected}}]);return t}(vi);function Ri(){this.initHistory();this.historyContainer=b.Tag.render(Ci||(Ci=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker-image_history">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.isToolingLoading?zi(this,Di,ji).call(this):this.history.render());return this.historyContainer}function ji(){return b.Tag.render(Mi||(Mi=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker-text_history-loader">',"</div>\n\t\t"])),b.Loc.getMessage("AI_JS_PICKER_HISTORY_LOADING"))}var Bi;function Xi(e,t,r){Yi(e,t);t.set(e,r)}function Yi(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var Ui=new WeakMap;var Ki=new WeakMap;var Ji=function(e){babelHelpers.inherits(t,e);function t(e){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));Xi(babelHelpers.assertThisInitialized(r),Ui,{writable:true,value:void 0});Xi(babelHelpers.assertThisInitialized(r),Ki,{writable:true,value:void 0});r.setEventNamespace("AI:Picker:ScrollTopButton");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Ui,null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(r),Ki,true);return r}babelHelpers.createClass(t,[{key:"render",value:function e(){var t=this;var r=new d.Icon({icon:d.Actions.CHEVRON_UP,size:26});babelHelpers.classPrivateFieldSet(this,Ui,b.Tag.render(Bi||(Bi=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<button class="ai__picker_go-top-btn">\n\t\t\t\t',"\n\t\t\t</button>\n\t\t"])),r.render()));b.Dom.style(babelHelpers.classPrivateFieldGet(this,Ui),{visibility:babelHelpers.classPrivateFieldGet(this,Ki)?"":"hidden"});b.bind(babelHelpers.classPrivateFieldGet(this,Ui),"click",(function(){t.emit("click")}));return babelHelpers.classPrivateFieldGet(this,Ui)}},{key:"show",value:function e(){var t=this;if(babelHelpers.classPrivateFieldGet(this,Ki)){return}babelHelpers.classPrivateFieldSet(this,Ki,true);if(babelHelpers.classPrivateFieldGet(this,Ui)){b.Dom.style(babelHelpers.classPrivateFieldGet(this,Ui),"visibility",null);setTimeout((function(){b.Dom.style(babelHelpers.classPrivateFieldGet(t,Ui),"opacity",1)}),10)}}},{key:"hide",value:function e(){var t=this;if(!babelHelpers.classPrivateFieldGet(this,Ki)){return}babelHelpers.classPrivateFieldSet(this,Ki,false);if(babelHelpers.classPrivateFieldGet(this,Ui)){b.Dom.style(babelHelpers.classPrivateFieldGet(this,Ui),"opacity",0);b.bindOnce(babelHelpers.classPrivateFieldGet(this,Ui),"transitionend",(function(){b.Dom.style(babelHelpers.classPrivateFieldGet(t,Ui),"visibility","hidden")}))}}},{key:"isShow",value:function e(){babelHelpers.classPrivateFieldSet(this,Ki,true)}}]);return t}(P);function Vi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function qi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vi(Object(r),!0).forEach((function(t){babelHelpers.defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Qi(e,t){$i(e,t);t.add(e)}function Zi(e,t,r){$i(e,t);t.set(e,r)}function $i(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function ea(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var ta=new WeakMap;var ra=new WeakSet;var ia=new WeakSet;var aa=new WeakSet;var na=new WeakSet;var sa=new WeakSet;var la=new WeakSet;var oa=function(){function e(t){var r=this;babelHelpers.classCallCheck(this,e);Qi(this,la);Qi(this,sa);Qi(this,na);Qi(this,aa);Qi(this,ia);Qi(this,ra);Zi(this,ta,{writable:true,value:void 0});babelHelpers.defineProperty(this,"labels",Object.freeze({open:function e(){return ea(r,ra,ca).call(r)},generate:function e(t){return ea(r,ia,ua).call(r,t)},copy:function e(){return ea(r,aa,pa).call(r)},paste:function e(){return ea(r,na,ha).call(r)},cancel:function e(){return ea(r,sa,da).call(r)}}));babelHelpers.classPrivateFieldSet(this,ta,t.analyticLabel)}babelHelpers.createClass(e,[{key:"getAnalyticLabel",value:function e(){return babelHelpers.classPrivateFieldGet(this,ta)}},{key:"setAnalyticLabel",value:function e(t){babelHelpers.classPrivateFieldSet(this,ta,t)}}]);return e}();function ca(){ea(this,la,ba).call(this,"open")}function ua(e){var t=e?e.slice(0,50):"";ea(this,la,ba).call(this,"generate",{text:t})}function pa(){return ea(this,la,ba).call(this,"copy")}function ha(){return ea(this,la,ba).call(this,"past")}function da(){return ea(this,la,ba).call(this,"cancel")}function ba(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r="/bitrix/images/1.gif";var i=Date.now();var a=qi({module:"ai",context:babelHelpers.classPrivateFieldGet(this,ta),action:"picker.".concat(e),ts:i},t);var n=b.ajax.prepareData(a);if(n){r+=(r.includes("?")?"&":"?")+n}b.ajax({method:"GET",url:r})}var va,fa,ga;function ya(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ya=function t(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function e(t,r,i){return t[r]=i}}function c(e,t,r,a){var n=t&&t.prototype instanceof h?t:h,s=Object.create(n.prototype),l=new F(a||[]);return i(s,"_invoke",{value:w(e,r,l)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function h(){}function d(){}function b(){}var v={};o(v,n,(function(){return this}));var f=Object.getPrototypeOf,g=f&&f(f(G([])));g&&g!==t&&r.call(g,n)&&(v=g);var y=b.prototype=h.prototype=Object.create(v);function m(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function H(e,t){function a(i,n,s,l){var o=u(e[i],e,n);if("throw"!==o.type){var c=o.arg,p=c.value;return p&&"object"==babelHelpers["typeof"](p)&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,s,l)}),(function(e){a("throw",e,s,l)})):t.resolve(p).then((function(e){c.value=e,s(c)}),(function(e){return a("throw",e,s,l)}))}l(o.arg)}var n;i(this,"_invoke",{value:function e(r,i){function s(){return new t((function(e,t){a(r,i,e,t)}))}return n=n?n.then(s,s):s()}})}function w(e,t,r){var i="suspendedStart";return function(a,n){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw n;return T()}for(r.method=a,r.arg=n;;){var s=r.delegate;if(s){var l=P(s,r);if(l){if(l===p)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var o=u(e,t,r);if("normal"===o.type){if(i=r.done?"completed":"suspendedYield",o.arg===p)continue;return{value:o.arg,done:r.done}}"throw"===o.type&&(i="completed",r.method="throw",r.arg=o.arg)}}}function P(e,t){var r=t.method,i=e.iterator[r];if(undefined===i)return t.delegate=null,"throw"===r&&e.iterator["return"]&&(t.method="return",t.arg=undefined,P(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var a=u(i,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var n=a.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,p):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function F(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function G(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=undefined,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:undefined,done:!0}}return d.prototype=b,i(y,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:d,configurable:!0}),d.displayName=o(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,o(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},m(H.prototype),o(H.prototype,s,(function(){return this})),e.AsyncIterator=H,e.async=function(t,r,i,a,n){void 0===n&&(n=Promise);var s=new H(c(t,r,i,a),n);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},m(y),o(y,l,"Generator"),o(y,n,(function(){return this})),o(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=G,F.prototype={constructor:F,reset:function e(t){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(k),!t)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=undefined)},stop:function e(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function e(t){if(this.done)throw t;var i=this;function a(e,r){return l.type="throw",l.arg=t,i.next=e,r&&(i.method="next",i.arg=undefined),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],l=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(o&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function e(t,i){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=i&&i<=s.finallyLoc&&(s=null);var l=s?s.completion:{};return l.type=t,l.arg=i,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(l)},complete:function e(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),k(i),p}},catch:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===t){var a=i.completion;if("throw"===a.type){var n=a.arg;k(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function e(t,r,i){return this.delegate={iterator:G(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=undefined),p}},e}function ma(e,t){wa(e,t);t.add(e)}function Ha(e,t,r){wa(e,t);t.set(e,r)}function wa(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Pa(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var _a=new WeakMap;var ka=new WeakMap;var Fa=new WeakMap;var Ga=new WeakMap;var Ta=new WeakMap;var Sa=new WeakMap;var xa=new WeakMap;var Ia=new WeakMap;var Ea=new WeakMap;var La=new WeakMap;var Ca=new WeakMap;var Ma=new WeakMap;var Oa=new WeakMap;var Wa=new WeakMap;var za=new WeakMap;var Aa=new WeakMap;var Da=new WeakMap;var Na=new WeakMap;var Ra=new WeakSet;var ja=new WeakSet;var Ba=new WeakSet;var Xa=new WeakSet;var Ya=new WeakSet;var Ua=new WeakSet;var Ka=new WeakSet;var Ja=new WeakSet;var Va=new WeakSet;var qa=new WeakSet;var Qa=new WeakSet;var Za=new WeakSet;var $a=new WeakSet;var en=new WeakSet;var tn=new WeakSet;var rn=new WeakSet;var an=new WeakSet;var nn=new WeakSet;var sn=new WeakSet;var ln=function(){function e(t){babelHelpers.classCallCheck(this,e);ma(this,sn);ma(this,nn);ma(this,an);ma(this,rn);ma(this,tn);ma(this,en);ma(this,$a);ma(this,Za);ma(this,Qa);ma(this,qa);ma(this,Va);ma(this,Ja);ma(this,Ka);ma(this,Ua);ma(this,Ya);ma(this,Xa);ma(this,Ba);ma(this,ja);ma(this,Ra);Ha(this,_a,{writable:true,value:void 0});Ha(this,ka,{writable:true,value:void 0});Ha(this,Fa,{writable:true,value:void 0});Ha(this,Ga,{writable:true,value:void 0});Ha(this,Ta,{writable:true,value:void 0});Ha(this,Sa,{writable:true,value:void 0});Ha(this,xa,{writable:true,value:void 0});Ha(this,Ia,{writable:true,value:void 0});Ha(this,Ea,{writable:true,value:void 0});Ha(this,La,{writable:true,value:void 0});Ha(this,Ca,{writable:true,value:void 0});Ha(this,Ma,{writable:true,value:void 0});Ha(this,Oa,{writable:true,value:void 0});Ha(this,Wa,{writable:true,value:void 0});Ha(this,za,{writable:true,value:void 0});Ha(this,Aa,{writable:true,value:void 0});Ha(this,Da,{writable:true,value:void 0});Ha(this,Na,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,Ga,new u.Engine);babelHelpers.classPrivateFieldSet(this,Ta,new Map);babelHelpers.classPrivateFieldSet(this,xa,t.popupContainer||document.body);babelHelpers.classPrivateFieldSet(this,_a,t.startMessage);babelHelpers.classPrivateFieldSet(this,ka,t.onSelect);babelHelpers.classPrivateFieldSet(this,Fa,t.onTariffRestriction);babelHelpers.classPrivateFieldSet(this,Oa,null);babelHelpers.classPrivateFieldSet(this,za,t.analyticLabel);babelHelpers.classPrivateFieldSet(this,La,t.saveImages===true);babelHelpers.classPrivateFieldSet(this,Ca,{});babelHelpers.classPrivateFieldSet(this,Ma,{});babelHelpers.classPrivateFieldSet(this,Na,25);babelHelpers.classPrivateFieldSet(this,Wa,new oa({analyticLabel:babelHelpers.classPrivateFieldGet(this,za)}));babelHelpers.classPrivateFieldGet(this,Ga).setModuleId(t.moduleId).setContextId(t.contextId).setHistoryState(t.history);babelHelpers.classPrivateFieldSet(this,Aa,null);babelHelpers.classPrivateFieldSet(this,Da,null)}babelHelpers.createClass(e,[{key:"initTooling",value:function(){var e=babelHelpers.asyncToGenerator(ya().mark((function e(){var t;return ya().wrap((function e(r){while(1)switch(r.prev=r.next){case 0:r.next=2;return babelHelpers.classPrivateFieldGet(this,Ga).getTooling("text");case 2:t=r.sent;babelHelpers.classPrivateFieldGet(this,Ca).text=t.data.engines;babelHelpers.classPrivateFieldGet(this,Ma).text=t.data.history;return r.abrupt("return",true);case 6:case"end":return r.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setLangSpace",value:function e(t){y.getInstance().setSpace(t);return this}},{key:"setSelectCallback",value:function e(t){babelHelpers.classPrivateFieldSet(this,ka,t)}},{key:"setEngineParameters",value:function e(t){if(babelHelpers.classPrivateFieldGet(this,Ga)){babelHelpers.classPrivateFieldGet(this,Ga).setParameters(t);if(babelHelpers.classPrivateFieldGet(this,Aa)){babelHelpers.classPrivateFieldGet(this,Aa).setEngineParameters(t)}if(babelHelpers.classPrivateFieldGet(this,Da)){babelHelpers.classPrivateFieldGet(this,Da).setEngineParameters(t)}}}},{key:"setStartMessage",value:function e(t){babelHelpers.classPrivateFieldSet(this,_a,b.Type.isString(t)?t:babelHelpers.classPrivateFieldGet(this,_a))}},{key:"text",value:function e(){babelHelpers.classPrivateFieldGet(this,Wa).labels.open();babelHelpers.classPrivateFieldSet(this,Oa,17587362);var t=babelHelpers.classPrivateFieldGet(this,Ta).get("text");if(babelHelpers.classPrivateFieldGet(this,Da)){var r=babelHelpers.classPrivateFieldGet(this,xa)===document.body?window.pageYOffset:0;t.setBindElement({left:babelHelpers.classPrivateFieldGet(this,xa).offsetWidth-t.getWidth()-25,top:25+r});t.adjustPosition();babelHelpers.classPrivateFieldSet(this,Sa,t);babelHelpers.classPrivateFieldGet(this,Da).resetResultUsedFlag();Pa(this,ja,cn).call(this)}else{Pa(this,en,wn).call(this);Pa(this,Ya,hn).call(this,"text",babelHelpers.classPrivateFieldGet(this,Da).render({textMessageText:babelHelpers.classPrivateFieldGet(this,_a)}),{contentClassname:""});babelHelpers.classPrivateFieldGet(this,Da).resetResultUsedFlag();Pa(this,ja,cn).call(this)}}},{key:"image",value:function(){var e=babelHelpers.asyncToGenerator(ya().mark((function e(){var t,r,i,a;return ya().wrap((function e(n){while(1)switch(n.prev=n.next){case 0:t=b.Extension.getSettings("ai.picker").get("isRestrictedByEula");r=null;if(!t){n.next=16;break}n.next=5;return b.Runtime.loadExtension("bitrix24.license.feature");case 5:r=n.sent;n.prev=6;n.next=9;return r.Feature.checkEulaRestrictions("ai_available_by_version");case 9:n.next=14;break;case 11:n.prev=11;n.t0=n["catch"](6);if(b.Type.isFunction(n.t0===null||n.t0===void 0?void 0:n.t0.callback)){n.t0===null||n.t0===void 0?void 0:n.t0.callback()}case 14:n.next=21;break;case 16:babelHelpers.classPrivateFieldGet(this,Wa).labels.open();babelHelpers.classPrivateFieldSet(this,Oa,17586054);if(babelHelpers.classPrivateFieldGet(this,Aa)){i=babelHelpers.classPrivateFieldGet(this,Ta).get("image");a=babelHelpers.classPrivateFieldGet(this,xa)===document.body?window.pageYOffset:0;babelHelpers.classPrivateFieldSet(this,Sa,i);i.setBindElement({left:babelHelpers.classPrivateFieldGet(this,xa).offsetWidth-i.getWidth()-25,top:25+a});i.adjustPosition()}else{Pa(this,tn,_n).call(this);Pa(this,Ya,hn).call(this,"image",babelHelpers.classPrivateFieldGet(this,Aa).render(),{width:550,contentClassname:"--image",headerClassname:"--image"})}babelHelpers.classPrivateFieldGet(this,Aa).resetResultUsedFlag();Pa(this,ja,cn).call(this);case 21:case"end":return n.stop()}}),e,this,[[6,11]])})));function t(){return e.apply(this,arguments)}return t}()}]);return e}();function on(e,t){if(b.Type.isFunction(babelHelpers.classPrivateFieldGet(this,ka))){babelHelpers.classPrivateFieldGet(this,ka).call(this,e,t)}babelHelpers.classPrivateFieldGet(this,Sa).close()}function cn(){babelHelpers.classPrivateFieldGet(this,Sa).show()}function un(){var e=b.Tag.render(va||(va=babelHelpers.taggedTemplateLiteral(['<div style="overflow-y: scroll; width: 50px; height: 50px; opacity: 0; pointer-events: none; position: absolute;"></div>'])));b.Dom.append(e,document.body);var t=e.offsetWidth-e.clientWidth;b.Dom.remove(e);return t}function pn(e){if(!e){return}var t=babelHelpers.classPrivateFieldGet(this,Ta).get(e).overlay.element;b.Dom.style(t,"padding-right","".concat(Pa(this,Ba,un).call(this),"px"))}function hn(e,t,r){var i=this;var a=(r===null||r===void 0?void 0:r.width)||450;var n=r.contentClassname||"";var s=r.headerClassname||"";var o=Pa(this,Ka,bn).bind(this);if(!babelHelpers.classPrivateFieldGet(this,Ta).has(e)){babelHelpers.classPrivateFieldGet(this,Ta).set(e,new l.Popup({bindElement:Pa(this,Ja,vn).call(this,a),className:"ai__picker-popup",autoHide:true,closeByEsc:false,width:a,height:Pa(this,Va,fn).call(this),disableScroll:true,padding:0,borderRadius:"12px",contentBorderRadius:"12px",overlay:{backgroundColor:"#fff",opacity:50},animation:{showClassName:"ai__picker-popup-show",closeClassName:"ai__picker-popup-hide",closeAnimationType:"animation"},targetContainer:babelHelpers.classPrivateFieldGet(this,xa),events:{onPopupShow:function t(){Pa(i,Xa,pn).call(i,e);b.Dom.style(document.body,"overflow-x","hidden")},onPopupAfterClose:function e(){b.Dom.style(document.body,"overflow-x",null)},onAfterShow:function e(){b.bind(window,"resize",o)},onPopupClose:function e(){Pa(i,Ua,dn).call(i);if(babelHelpers.classPrivateFieldGet(i,Aa)){babelHelpers.classPrivateFieldGet(i,Aa).closeAllMenus()}if(babelHelpers.classPrivateFieldGet(i,Da)){babelHelpers.classPrivateFieldGet(i,Da).closeAllMenus()}b.unbind(window,"resize",o)}}}))}babelHelpers.classPrivateFieldSet(this,Sa,babelHelpers.classPrivateFieldGet(this,Ta).get(e));if(babelHelpers.classPrivateFieldGet(this,Sa).isShown()){babelHelpers.classPrivateFieldGet(this,Sa).close()}Pa(this,qa,gn).call(this,babelHelpers.classPrivateFieldGet(this,Sa),Pa(this,Za,mn).call(this,t,{contentClassname:n,headerClassname:s}))}function dn(){if(babelHelpers.classPrivateFieldGet(this,Da)&&!babelHelpers.classPrivateFieldGet(this,Da).isResultUsed()){babelHelpers.classPrivateFieldGet(this,Wa).labels.cancel()}if(babelHelpers.classPrivateFieldGet(this,Aa)&&!babelHelpers.classPrivateFieldGet(this,Aa).isResultUsed()){babelHelpers.classPrivateFieldGet(this,Wa).labels.cancel()}}function bn(){babelHelpers.classPrivateFieldGet(this,Sa).setBindElement(Pa(this,Ja,vn).call(this));babelHelpers.classPrivateFieldGet(this,Sa).setHeight(Pa(this,Va,fn).call(this));babelHelpers.classPrivateFieldGet(this,Sa).adjustPosition();b.Dom.style(babelHelpers.classPrivateFieldGet(this,Ia),"height","".concat(Pa(this,Qa,yn).call(this),"px"))}function vn(e){var t=babelHelpers.classPrivateFieldGet(this,xa)===document.body?window.pageYOffset:0;var r=e||babelHelpers.classPrivateFieldGet(this,Sa).getWidth();return{left:babelHelpers.classPrivateFieldGet(this,xa).offsetWidth-r-25,top:25+t}}function fn(){var e=babelHelpers.classPrivateFieldGet(this,xa).clientHeight>window.innerHeight?window.innerHeight:babelHelpers.classPrivateFieldGet(this,xa).clientHeight;return e-babelHelpers.classPrivateFieldGet(this,Na)*2}function gn(e,t){e.setContent(t)}function yn(){var e=94;return babelHelpers.classPrivateFieldGet(this,Sa).getHeight()-e}function mn(e,t){var r=this;var i="height: ".concat(Pa(this,Qa,yn).call(this),"px");var a=(t===null||t===void 0?void 0:t.contentClassname)||"";var n=(t===null||t===void 0?void 0:t.headerClassname)||"";babelHelpers.classPrivateFieldSet(this,Ia,b.Tag.render(fa||(fa=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div\n\t\t\t\tclass="ai__picker_content '," ",'"\n\t\t\t\tstyle="','"\n\t\t\t>\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),b.Browser.isMac()?"--is-mac-os":"",a,i,e));b.bind(babelHelpers.classPrivateFieldGet(this,Ia),"scroll",(function(){if(babelHelpers.classPrivateFieldGet(r,Ia).scrollTop>200){babelHelpers.classPrivateFieldGet(r,Ea).show()}else{babelHelpers.classPrivateFieldGet(r,Ea).hide()}if(babelHelpers.classPrivateFieldGet(r,Aa)){babelHelpers.classPrivateFieldGet(r,Aa).closeAllMenus()}if(babelHelpers.classPrivateFieldGet(r,Da)){babelHelpers.classPrivateFieldGet(r,Da).closeAllMenus()}}));babelHelpers.classPrivateFieldSet(this,Ea,new Ji);babelHelpers.classPrivateFieldGet(this,Ea).hide();babelHelpers.classPrivateFieldGet(this,Ea).subscribe("click",(function(){babelHelpers.classPrivateFieldGet(r,Ia).scrollTo({top:0})}));return b.Tag.render(ga||(ga=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="ai__picker">\n\t\t\t\t<div>\n\t\t\t\t\t<div class="ai__picker-header">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),Pa(this,$a,Hn).call(this,{className:n}),babelHelpers.classPrivateFieldGet(this,Ia),babelHelpers.classPrivateFieldGet(this,Ea).render())}function Hn(){var e=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=new li.Header({articleCode:babelHelpers.classPrivateFieldGet(this,Oa),className:t.className});r.subscribe("click-close-icon",(function(){babelHelpers.classPrivateFieldGet(e,Sa).close()}));return r.render()}function wn(){return Pn.apply(this,arguments)}function Pn(){Pn=babelHelpers.asyncToGenerator(ya().mark((function e(){var r=this;var i;return ya().wrap((function e(a){while(1)switch(a.prev=a.next){case 0:if(!babelHelpers.classPrivateFieldGet(this,Da)){a.next=2;break}return a.abrupt("return");case 2:babelHelpers.classPrivateFieldSet(this,Da,new xi({onTariffRestriction:babelHelpers.classPrivateFieldGet(this,Fa),onSelect:Pa(this,rn,kn).bind(this),onCopy:Pa(this,an,Fn).bind(this)}));i=function e(i,a){babelHelpers.classPrivateFieldGet(r,Ga).setPayload(new t.Text({engineCode:a,prompt:i}));babelHelpers.classPrivateFieldGet(r,Wa).labels.generate(i);return babelHelpers.classPrivateFieldGet(r,Ga).textCompletions()};babelHelpers.classPrivateFieldGet(this,Da).setOnGenerate(i);babelHelpers.classPrivateFieldGet(this,Da).setStartMessage(babelHelpers.classPrivateFieldGet(this,_a));babelHelpers.classPrivateFieldGet(this,Da).setEngine(babelHelpers.classPrivateFieldGet(this,Ga));babelHelpers.classPrivateFieldGet(this,Da).setContext(babelHelpers.classPrivateFieldGet(this,xa));babelHelpers.classPrivateFieldGet(this,Da).initTooling("text");babelHelpers.classPrivateFieldGet(this,Da).subscribe("select",Pa(this,rn,kn).bind(this));case 10:case"end":return a.stop()}}),e,this)})));return Pn.apply(this,arguments)}function _n(){var e=this;if(babelHelpers.classPrivateFieldGet(this,Aa)){return}babelHelpers.classPrivateFieldSet(this,Aa,new Ni({onTariffRestriction:babelHelpers.classPrivateFieldGet(this,Fa),onSelect:Pa(this,nn,Gn).bind(this),context:babelHelpers.classPrivateFieldGet(this,xa)}));var r=function r(i,a){babelHelpers.classPrivateFieldGet(e,Ga).setPayload(new t.Text({prompt:i,engineCode:a}));babelHelpers.classPrivateFieldGet(e,Wa).labels.generate(i);babelHelpers.classPrivateFieldGet(e,Ga).setAnalyticParameters({type:"create_image",c_section:Pa(e,sn,Sn).call(e)});return babelHelpers.classPrivateFieldGet(e,Ga).imageCompletions()};babelHelpers.classPrivateFieldGet(this,Aa).setOnGenerate(r);babelHelpers.classPrivateFieldGet(this,Aa).setStartMessage(babelHelpers.classPrivateFieldGet(this,_a));babelHelpers.classPrivateFieldGet(this,Aa).setEngine(babelHelpers.classPrivateFieldGet(this,Ga));babelHelpers.classPrivateFieldGet(this,Aa).setContext(babelHelpers.classPrivateFieldGet(this,xa));babelHelpers.classPrivateFieldGet(this,Aa).initTooling("image");babelHelpers.classPrivateFieldGet(this,Aa).subscribe("select",Pa(this,rn,kn).bind(this))}function kn(e){babelHelpers.classPrivateFieldGet(this,Wa).labels.paste();Pa(this,Ra,on).call(this,e)}function Fn(e){BX.clipboard.copy(e.data);babelHelpers.classPrivateFieldGet(this,Wa).labels.copy()}function Gn(e){return Tn.apply(this,arguments)}function Tn(){Tn=babelHelpers.asyncToGenerator(ya().mark((function e(t){var r=this;var i;return ya().wrap((function e(a){while(1)switch(a.prev=a.next){case 0:babelHelpers.classPrivateFieldGet(this,Wa).labels.paste();if(babelHelpers.classPrivateFieldGet(this,La)){i=new Promise((function(e,i){babelHelpers.classPrivateFieldGet(r,Ga).saveImage(t).then((function(t){e(t.data)}))["catch"]((function(e){i(e)}))}));Pa(this,Ra,on).call(this,t,i)}else{Pa(this,Ra,on).call(this,t)}case 2:case"end":return a.stop()}}),e,this)})));return Tn.apply(this,arguments)}function Sn(){if(!babelHelpers.classPrivateFieldGet(this,za)){return""}return babelHelpers.classPrivateFieldGet(this,za).split("_").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}babelHelpers.defineProperty(ln,"LangSpace",{text:"text",image:"image"});e.Picker=ln})(this.BX.AI=this.BX.AI||{},BX.AI.Payload,BX,BX,BX,BX.UI,BX.Event,BX.Main,BX,BX,BX.AI,BX.AI,BX.AI,BX.UI.IconSet,BX);
//# sourceMappingURL=index.bundle.map.js