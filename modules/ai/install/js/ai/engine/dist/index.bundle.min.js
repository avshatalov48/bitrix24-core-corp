this.BX=this.BX||{};(function(e,t,a){"use strict";function i(e,t){r(e,t);t.add(e)}function s(e,t,a){r(e,t);t.set(e,a)}function r(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function l(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var n=new WeakMap;var o=new WeakMap;var c=new WeakMap;var p=new WeakMap;var u=new WeakMap;var v=new WeakMap;var b=new WeakMap;var h=new WeakSet;var d=new WeakSet;var f=new WeakSet;var m=new WeakSet;var P=function(){function e(){babelHelpers.classCallCheck(this,e);i(this,m);i(this,f);i(this,d);i(this,h);s(this,n,{writable:true,value:void 0});s(this,o,{writable:true,value:void 0});s(this,c,{writable:true,value:void 0});s(this,p,{writable:true,value:void 0});s(this,u,{writable:true,value:false});s(this,v,{writable:true,value:-1});s(this,b,{writable:true,value:{}})}babelHelpers.createClass(e,[{key:"setPayload",value:function e(t){babelHelpers.classPrivateFieldSet(this,p,t);return this}},{key:"getPayload",value:function e(){return babelHelpers.classPrivateFieldGet(this,p)}},{key:"setParameters",value:function e(t){babelHelpers.classPrivateFieldSet(this,b,t);return this}},{key:"setModuleId",value:function e(t){babelHelpers.classPrivateFieldSet(this,n,t);return this}},{key:"setContextId",value:function e(t){babelHelpers.classPrivateFieldSet(this,o,t);return this}},{key:"setContextParameters",value:function e(t){babelHelpers.classPrivateFieldSet(this,c,t);return this}},{key:"setHistoryState",value:function e(t){babelHelpers.classPrivateFieldSet(this,u,t);return this}},{key:"setHistoryGroupId",value:function e(t){babelHelpers.classPrivateFieldSet(this,v,t);return this}},{key:"setBannerLaunched",value:function t(){l(this,h,g).call(this);return l(this,f,x).call(this,e.setBannerLaunchedUrl,{parameters:babelHelpers.classPrivateFieldGet(this,b)})}},{key:"textCompletions",value:function t(){l(this,h,g).call(this);return l(this,f,x).call(this,e.textCompletionsUrl,{prompt:babelHelpers.classPrivateFieldGet(this,p).getRawData().prompt,engineCode:babelHelpers.classPrivateFieldGet(this,p).getRawData().engineCode,markers:babelHelpers.classPrivateFieldGet(this,p).getMarkers(),parameters:babelHelpers.classPrivateFieldGet(this,b)})}},{key:"imageCompletions",value:function t(){l(this,h,g).call(this);return l(this,f,x).call(this,e.imageCompletionsUrl,{prompt:babelHelpers.classPrivateFieldGet(this,p).getRawData().prompt,engineCode:babelHelpers.classPrivateFieldGet(this,p).getRawData().engineCode,markers:babelHelpers.classPrivateFieldGet(this,p).getMarkers(),parameters:babelHelpers.classPrivateFieldGet(this,b)})}},{key:"getTooling",value:function t(i){l(this,h,g).call(this);var s={category:i,parameters:babelHelpers.classPrivateFieldGet(this,b)};return new Promise((function(t,i){var r=a.Http.Data.convertObjectToFormData(s);var l=a.ajax({method:"POST",dataType:"json",url:e.getToolingUrl,data:r,start:false,preparePost:false,onsuccess:function e(a){if(a.status==="error"){i(a)}else{t(a)}},onfailure:i});l.send(r)}))}},{key:"installKit",value:function t(i){l(this,h,g).call(this);var s={code:i,parameters:babelHelpers.classPrivateFieldGet(this,b)};return new Promise((function(t,i){var r=a.Http.Data.convertObjectToFormData(s);var l=a.ajax({method:"POST",dataType:"json",url:e.installKitUrl,data:r,start:false,preparePost:false,onsuccess:function e(a){if(a.status==="error"){i(a)}else{t(a)}},onfailure:i});l.send(r)}))}},{key:"acceptImageAgreement",value:function t(i){l(this,h,g).call(this);var s={engineCode:i,sessid:a.Loc.getMessage("bitrix_sessid"),parameters:babelHelpers.classPrivateFieldGet(this,b)};return new Promise((function(t,i){var r=a.Http.Data.convertObjectToFormData(s);var l=a.ajax({method:"POST",dataType:"json",url:e.imageAcceptationUrl,data:r,start:false,preparePost:false,onsuccess:function e(a){if(a.status==="error"){i(a)}else{t(a)}},onfailure:i});l.send(r)}))}},{key:"acceptTextAgreement",value:function t(i){l(this,h,g).call(this);var s={engineCode:i,sessid:a.Loc.getMessage("bitrix_sessid"),parameters:babelHelpers.classPrivateFieldGet(this,b)};return new Promise((function(t,i){var r=a.Http.Data.convertObjectToFormData(s);var l=a.ajax({method:"POST",dataType:"json",url:e.textAcceptationUrl,data:r,start:false,preparePost:false,onsuccess:function e(a){if(a.status==="error"){i(a)}else{t(a)}},onfailure:i});l.send(r)}))}},{key:"saveImage",value:function t(a){l(this,h,g).call(this);var i={pictureUrl:a,parameters:babelHelpers.classPrivateFieldGet(this,b)};return l(this,f,x).call(this,e.saveImageUrl,i)}}]);return e}();function g(){babelHelpers.classPrivateFieldGet(this,b).bx_module=babelHelpers.classPrivateFieldGet(this,n);babelHelpers.classPrivateFieldGet(this,b).bx_context=babelHelpers.classPrivateFieldGet(this,o);babelHelpers.classPrivateFieldGet(this,b).bx_context_parameters=babelHelpers.classPrivateFieldGet(this,c);babelHelpers.classPrivateFieldGet(this,b).bx_history=babelHelpers.classPrivateFieldGet(this,u);babelHelpers.classPrivateFieldGet(this,b).bx_history_group_id=babelHelpers.classPrivateFieldGet(this,v)}function H(e,t,i){a.addCustomEvent("onPullEvent-ai",(function(a,s){var r=s.hash,l=s.data,n=s.error;if(a==="onQueueJobExecute"&&r===e){t({data:l})}else if(a==="onQueueJobFail"&&r===e){i({error:n})}}))}function x(e,t){var i=this;if(l(this,m,y).call(this)){return Promise.reject(new Error(a.Loc.getMessage("AI_ENGINE_INTERNET_PROBLEM")))}return new Promise((function(s,r){var n=a.Http.Data.convertObjectToFormData(t);var o=a.ajax({method:"POST",dataType:"json",url:e,data:n,start:false,preparePost:false,onsuccess:function e(t){if(t.status==="error"){r(t)}else{var a;var n=(a=t.data)===null||a===void 0?void 0:a.queue;if(n){l(i,d,H).call(i,n,s,r)}else{s(t)}}},onfailure:function e(t,a){if(t==="processing"&&(a===null||a===void 0?void 0:a.bProactive)===true){r(a.data)}r(t)}});o.send(n)}))}function y(){return!window.navigator.onLine}babelHelpers.defineProperty(P,"textCompletionsUrl","/bitrix/services/main/ajax.php?action=ai.api.text.completions");babelHelpers.defineProperty(P,"imageCompletionsUrl","/bitrix/services/main/ajax.php?action=ai.api.image.completions");babelHelpers.defineProperty(P,"textAcceptationUrl","/bitrix/services/main/ajax.php?action=ai.api.text.acceptation");babelHelpers.defineProperty(P,"imageAcceptationUrl","/bitrix/services/main/ajax.php?action=ai.api.image.acceptation");babelHelpers.defineProperty(P,"saveImageUrl","/bitrix/services/main/ajax.php?action=ai.api.image.save");babelHelpers.defineProperty(P,"getToolingUrl","/bitrix/services/main/ajax.php?action=ai.api.tooling.get");babelHelpers.defineProperty(P,"installKitUrl","/bitrix/services/main/ajax.php?action=ai.api.tooling.installKit");babelHelpers.defineProperty(P,"setBannerLaunchedUrl","/bitrix/services/main/ajax.php?action=ai.api.tooling.setLaunched");e.Engine=P})(this.BX.AI=this.BX.AI||{},BX.AI.Payload,BX);
//# sourceMappingURL=index.bundle.map.js