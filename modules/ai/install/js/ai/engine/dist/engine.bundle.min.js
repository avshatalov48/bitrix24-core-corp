this.BX=this.BX||{};(function(e,t){"use strict";var r=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"payload",null);babelHelpers.defineProperty(this,"markers",{});this.payload=t}babelHelpers.createClass(e,[{key:"setMarkers",value:function e(t){this.markers=t;return this}},{key:"getMarkers",value:function e(){return this.markers}},{key:"getPrettifiedData",value:function e(){return this.payload}},{key:"getRawData",value:function e(){return this.payload}}]);return e}();var a=function(e){babelHelpers.inherits(t,e);function t(e){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e))}babelHelpers.createClass(t,[{key:"setMarkers",value:function e(r){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setMarkers",this).call(this,r)}},{key:"getMarkers",value:function e(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getMarkers",this).call(this)}},{key:"getPrettifiedData",value:function e(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getPrettifiedData",this).call(this)}},{key:"getRawData",value:function e(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getRawData",this).call(this)}}]);return t}(r);function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i=function t(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",l=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function e(t,r,a){return t[r]=a}}function u(e,t,r,i){var n=t&&t.prototype instanceof f?t:f,s=Object.create(n.prototype),l=new G(i||[]);return a(s,"_invoke",{value:w(e,r,l)}),s}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h={};function f(){}function v(){}function b(){}var d={};c(d,s,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(j([])));m&&m!==t&&r.call(m,s)&&(d=m);var g=b.prototype=f.prototype=Object.create(d);function P(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function H(e,t){function i(a,n,s,l){var o=p(e[a],e,n);if("throw"!==o.type){var c=o.arg,u=c.value;return u&&"object"==babelHelpers["typeof"](u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,s,l)}),(function(e){i("throw",e,s,l)})):t.resolve(u).then((function(e){c.value=e,s(c)}),(function(e){return i("throw",e,s,l)}))}l(o.arg)}var n;a(this,"_invoke",{value:function e(r,a){function s(){return new t((function(e,t){i(r,a,e,t)}))}return n=n?n.then(s,s):s()}})}function w(e,t,r){var a="suspendedStart";return function(i,n){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===i)throw n;return T()}for(r.method=i,r.arg=n;;){var s=r.delegate;if(s){var l=x(s,r);if(l){if(l===h)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===a)throw a="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a="executing";var o=p(e,t,r);if("normal"===o.type){if(a=r.done?"completed":"suspendedYield",o.arg===h)continue;return{value:o.arg,done:r.done}}"throw"===o.type&&(a="completed",r.method="throw",r.arg=o.arg)}}}function x(e,t){var r=t.method,a=e.iterator[r];if(undefined===a)return t.delegate=null,"throw"===r&&e.iterator["return"]&&(t.method="return",t.arg=undefined,x(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=p(a,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var n=i.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,h):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function F(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function G(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function j(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function t(){for(;++a<e.length;)if(r.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=undefined,t.done=!0,t};return i.next=i}}return{next:T}}function T(){return{value:undefined,done:!0}}return v.prototype=b,a(g,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:v,configurable:!0}),v.displayName=c(b,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,o,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},P(H.prototype),c(H.prototype,l,(function(){return this})),e.AsyncIterator=H,e.async=function(t,r,a,i,n){void 0===n&&(n=Promise);var s=new H(u(t,r,a,i),n);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},P(g),c(g,o,"Generator"),c(g,s,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var a in t)r.push(a);return r.reverse(),function e(){for(;r.length;){var a=r.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},e.values=j,G.prototype={constructor:G,reset:function e(t){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(F),!t)for(var a in this)"t"===a.charAt(0)&&r.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=undefined)},stop:function e(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function e(t){if(this.done)throw t;var a=this;function i(e,r){return l.type="throw",l.arg=t,a.next=e,r&&(a.method="next",a.arg=undefined),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],l=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(o&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function e(t,a){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=a&&a<=s.finallyLoc&&(s=null);var l=s?s.completion:{};return l.type=t,l.arg=a,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(l)},complete:function e(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),F(a),h}},catch:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc===t){var i=a.completion;if("throw"===i.type){var n=i.arg;F(a)}return n}}throw new Error("illegal catch attempt")},delegateYield:function e(t,r,a){return this.delegate={iterator:j(t),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=undefined),h}},e}function n(e,t){l(e,t);t.add(e)}function s(e,t,r){l(e,t);t.set(e,r)}function l(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function o(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var c=r;var u=a;var p=new WeakMap;var h=new WeakMap;var f=new WeakMap;var v=new WeakMap;var b=new WeakMap;var d=new WeakMap;var y=new WeakMap;var m=new WeakMap;var g=new WeakSet;var P=new WeakSet;var H=new WeakSet;var w=new WeakSet;var x=function(){function e(){babelHelpers.classCallCheck(this,e);n(this,w);n(this,H);n(this,P);n(this,g);s(this,p,{writable:true,value:void 0});s(this,h,{writable:true,value:void 0});s(this,f,{writable:true,value:void 0});s(this,v,{writable:true,value:void 0});s(this,b,{writable:true,value:false});s(this,d,{writable:true,value:-1});s(this,y,{writable:true,value:{}});s(this,m,{writable:true,value:{}})}babelHelpers.createClass(e,[{key:"setPayload",value:function e(t){babelHelpers.classPrivateFieldSet(this,v,t);return this}},{key:"getPayload",value:function e(){return babelHelpers.classPrivateFieldGet(this,v)}},{key:"setParameters",value:function e(t){babelHelpers.classPrivateFieldSet(this,y,t);return this}},{key:"setAnalyticParameters",value:function e(t){babelHelpers.classPrivateFieldSet(this,m,t);return this}},{key:"setModuleId",value:function e(t){babelHelpers.classPrivateFieldSet(this,p,t);return this}},{key:"getModuleId",value:function e(){return babelHelpers.classPrivateFieldGet(this,p)}},{key:"setContextId",value:function e(t){babelHelpers.classPrivateFieldSet(this,h,t);return this}},{key:"getContextId",value:function e(){return babelHelpers.classPrivateFieldGet(this,h)}},{key:"setContextParameters",value:function e(t){babelHelpers.classPrivateFieldSet(this,f,t);return this}},{key:"setHistoryState",value:function e(t){babelHelpers.classPrivateFieldSet(this,b,t);return this}},{key:"setHistoryGroupId",value:function e(t){babelHelpers.classPrivateFieldSet(this,d,t);return this}},{key:"setBannerLaunched",value:function t(){o(this,g,k).call(this);return o(this,H,G).call(this,e.setBannerLaunchedUrl,{parameters:babelHelpers.classPrivateFieldGet(this,y)})}},{key:"checkAgreement",value:function(){var t=babelHelpers.asyncToGenerator(i().mark((function t(){return i().wrap((function t(r){while(1)switch(r.prev=r.next){case 0:o(this,g,k).call(this);return r.abrupt("return",o(this,H,G).call(this,e.checkAgreementUrl,{parameters:babelHelpers.classPrivateFieldGet(this,y),agreementCode:"AI_BOX_AGREEMENT"}));case 2:case"end":return r.stop()}}),t,this)})));function r(){return t.apply(this,arguments)}return r}()},{key:"acceptAgreement",value:function t(){o(this,g,k).call(this);return o(this,H,G).call(this,e.acceptAgreementUrl,{parameters:babelHelpers.classPrivateFieldGet(this,y),agreementCode:"AI_BOX_AGREEMENT"})}},{key:"textCompletions",value:function t(){var r;o(this,g,k).call(this);return o(this,H,G).call(this,e.textCompletionsUrl,{prompt:babelHelpers.classPrivateFieldGet(this,v).getRawData().prompt,engineCode:babelHelpers.classPrivateFieldGet(this,v).getRawData().engineCode,roleCode:(r=babelHelpers.classPrivateFieldGet(this,v).getRawData())===null||r===void 0?void 0:r.roleCode,markers:babelHelpers.classPrivateFieldGet(this,v).getMarkers(),parameters:babelHelpers.classPrivateFieldGet(this,y)})}},{key:"imageCompletions",value:function t(){o(this,g,k).call(this);return o(this,H,G).call(this,e.imageCompletionsUrl,{prompt:babelHelpers.classPrivateFieldGet(this,v).getRawData().prompt,engineCode:babelHelpers.classPrivateFieldGet(this,v).getRawData().engineCode,markers:babelHelpers.classPrivateFieldGet(this,v).getMarkers(),parameters:babelHelpers.classPrivateFieldGet(this,y)})}},{key:"getTooling",value:function e(r){o(this,g,k).call(this);babelHelpers.classPrivateFieldGet(this,y).category=babelHelpers.classPrivateFieldGet(this,y).promptCategory;var a={parameters:babelHelpers.classPrivateFieldGet(this,y),category:babelHelpers.classPrivateFieldGet(this,y).promptCategory,moduleId:babelHelpers.classPrivateFieldGet(this,p),context:babelHelpers.classPrivateFieldGet(this,h)};return t.ajax.runAction("ai.prompt.getPromptsForUser",{data:t.Http.Data.convertObjectToFormData(a),method:"POST",start:false,preparePost:false})}},{key:"getImagePickerTooling",value:function r(){o(this,g,k).call(this);var a={parameters:babelHelpers.classPrivateFieldGet(this,y),category:"image"};return new Promise((function(r,i){var n=t.Http.Data.convertObjectToFormData(a);var s=t.ajax({method:"POST",dataType:"json",url:e.getToolingUrl,data:n,start:false,preparePost:false,onsuccess:function e(t){if(t.status==="error"){i(t)}else{r(t)}},onfailure:i});s.send(n)}))}},{key:"getImageCopilotTooling",value:function r(){o(this,g,k).call(this);var a={parameters:babelHelpers.classPrivateFieldGet(this,y)};return new Promise((function(r,i){var n=t.Http.Data.convertObjectToFormData(a);var s=t.ajax({method:"POST",dataType:"json",url:e.getImageToolingUrl,data:n,start:false,preparePost:false,onsuccess:function e(t){if(t.status==="error"){i(t)}else{r(t)}},onfailure:i});s.send(n)}))}},{key:"getRolesDialogData",value:function(){var t=babelHelpers.asyncToGenerator(i().mark((function t(){var r;return i().wrap((function t(a){while(1)switch(a.prev=a.next){case 0:o(this,g,k).call(this);r={parameters:babelHelpers.classPrivateFieldGet(this,y)};return a.abrupt("return",o(this,H,G).call(this,e.getRolesDialogDataUrl,r));case 3:case"end":return a.stop()}}),t,this)})));function r(){return t.apply(this,arguments)}return r}()},{key:"getRoles",value:function(){var t=babelHelpers.asyncToGenerator(i().mark((function t(){var r;return i().wrap((function t(a){while(1)switch(a.prev=a.next){case 0:o(this,g,k).call(this);r={parameters:babelHelpers.classPrivateFieldGet(this,y)};return a.abrupt("return",o(this,H,G).call(this,e.getRolesListUrl,r));case 3:case"end":return a.stop()}}),t,this)})));function r(){return t.apply(this,arguments)}return r}()},{key:"addRoleToFavouriteList",value:function(){var t=babelHelpers.asyncToGenerator(i().mark((function t(r){var a;return i().wrap((function t(i){while(1)switch(i.prev=i.next){case 0:o(this,g,k).call(this);a={roleCode:r,parameters:babelHelpers.classPrivateFieldGet(this,y)};return i.abrupt("return",o(this,H,G).call(this,e.addRoleToFavouriteListUrl,a));case 3:case"end":return i.stop()}}),t,this)})));function r(e){return t.apply(this,arguments)}return r}()},{key:"removeRoleFromFavouriteList",value:function(){var t=babelHelpers.asyncToGenerator(i().mark((function t(r){var a;return i().wrap((function t(i){while(1)switch(i.prev=i.next){case 0:o(this,g,k).call(this);a={roleCode:r,parameters:babelHelpers.classPrivateFieldGet(this,y)};return i.abrupt("return",o(this,H,G).call(this,e.removeRoleFromFavouriteListUrl,a));case 3:case"end":return i.stop()}}),t,this)})));function r(e){return t.apply(this,arguments)}return r}()},{key:"installKit",value:function r(a){o(this,g,k).call(this);var i={code:a,parameters:babelHelpers.classPrivateFieldGet(this,y)};return new Promise((function(r,a){var n=t.Http.Data.convertObjectToFormData(i);var s=t.ajax({method:"POST",dataType:"json",url:e.installKitUrl,data:n,start:false,preparePost:false,onsuccess:function e(t){if(t.status==="error"){a(t)}else{r(t)}},onfailure:a});s.send(n)}))}},{key:"acceptImageAgreement",value:function r(a){o(this,g,k).call(this);var i={engineCode:a,sessid:t.Loc.getMessage("bitrix_sessid"),parameters:babelHelpers.classPrivateFieldGet(this,y)};return new Promise((function(r,a){var n=t.Http.Data.convertObjectToFormData(i);var s=t.ajax({method:"POST",dataType:"json",url:e.imageAcceptationUrl,data:n,start:false,preparePost:false,onsuccess:function e(t){if(t.status==="error"){a(t)}else{r(t)}},onfailure:a});s.send(n)}))}},{key:"acceptTextAgreement",value:function r(a){o(this,g,k).call(this);var i={engineCode:a,sessid:t.Loc.getMessage("bitrix_sessid"),parameters:babelHelpers.classPrivateFieldGet(this,y)};return new Promise((function(r,a){var n=t.Http.Data.convertObjectToFormData(i);var s=t.ajax({method:"POST",dataType:"json",url:e.textAcceptationUrl,data:n,start:false,preparePost:false,onsuccess:function e(t){if(t.status==="error"){a(t)}else{r(t)}},onfailure:a});s.send(n)}))}},{key:"saveImage",value:function t(r){o(this,g,k).call(this);var a={pictureUrl:r,parameters:babelHelpers.classPrivateFieldGet(this,y)};return o(this,H,G).call(this,e.saveImageUrl,a)}},{key:"getFeedbackData",value:function t(){var r={parameters:babelHelpers.classPrivateFieldGet(this,y)};return o(this,H,G).call(this,e.textFeedbackDataUrl,r)}}]);return e}();function k(){babelHelpers.classPrivateFieldGet(this,y).bx_module=babelHelpers.classPrivateFieldGet(this,p);babelHelpers.classPrivateFieldGet(this,y).bx_context=babelHelpers.classPrivateFieldGet(this,h);babelHelpers.classPrivateFieldGet(this,y).bx_context_parameters=babelHelpers.classPrivateFieldGet(this,f);babelHelpers.classPrivateFieldGet(this,y).bx_history=babelHelpers.classPrivateFieldGet(this,b);babelHelpers.classPrivateFieldGet(this,y).bx_history_group_id=babelHelpers.classPrivateFieldGet(this,d);babelHelpers.classPrivateFieldGet(this,y).bx_analytic=babelHelpers.classPrivateFieldGet(this,m)}function F(e,r,a){t.addCustomEvent("onPullEvent-ai",(function(t,i){var n=i.hash,s=i.data,l=i.error;if(t==="onQueueJobExecute"&&n===e){r({data:s})}else if(t==="onQueueJobFail"&&n===e){a({errors:[l]})}}))}function G(e,r){var a=this;if(o(this,w,j).call(this)){return Promise.reject(new Error(t.Loc.getMessage("AI_ENGINE_INTERNET_PROBLEM")))}return new Promise((function(i,n){var s=t.Http.Data.convertObjectToFormData(r);var l=t.ajax({method:"POST",dataType:"json",url:e,data:s,start:false,preparePost:false,onsuccess:function e(t){if(t.status==="error"){n(t)}else{var r;var s=(r=t.data)===null||r===void 0?void 0:r.queue;if(s){o(a,P,F).call(a,s,i,n)}else{i(t)}}},onfailure:function e(t,r){if(t==="processing"&&(r===null||r===void 0?void 0:r.bProactive)===true){n(r.data)}n(t)}});l.send(s)}))}function j(){return!window.navigator.onLine}babelHelpers.defineProperty(x,"textCompletionsUrl","/bitrix/services/main/ajax.php?action=ai.api.text.completions");babelHelpers.defineProperty(x,"imageCompletionsUrl","/bitrix/services/main/ajax.php?action=ai.api.image.completions");babelHelpers.defineProperty(x,"textAcceptationUrl","/bitrix/services/main/ajax.php?action=ai.api.text.acceptation");babelHelpers.defineProperty(x,"textFeedbackDataUrl","/bitrix/services/main/ajax.php?action=ai.api.text.getFeedbackData");babelHelpers.defineProperty(x,"imageAcceptationUrl","/bitrix/services/main/ajax.php?action=ai.api.image.acceptation");babelHelpers.defineProperty(x,"saveImageUrl","/bitrix/services/main/ajax.php?action=ai.api.image.save");babelHelpers.defineProperty(x,"getToolingUrl","/bitrix/services/main/ajax.php?action=ai.api.tooling.get");babelHelpers.defineProperty(x,"getImageToolingUrl","/bitrix/services/main/ajax.php?action=ai.api.image.getTooling");babelHelpers.defineProperty(x,"installKitUrl","/bitrix/services/main/ajax.php?action=ai.api.tooling.installKit");babelHelpers.defineProperty(x,"getRolesListUrl","/bitrix/services/main/ajax.php?action=ai.api.role.list");babelHelpers.defineProperty(x,"getRolesDialogDataUrl","/bitrix/services/main/ajax.php?action=ai.api.role.picker");babelHelpers.defineProperty(x,"addRoleToFavouriteListUrl","/bitrix/services/main/ajax.php?action=ai.api.role.addfavorite");babelHelpers.defineProperty(x,"removeRoleFromFavouriteListUrl","/bitrix/services/main/ajax.php?action=ai.api.role.removefavorite");babelHelpers.defineProperty(x,"acceptAgreementUrl","/bitrix/services/main/ajax.php?action=ai.api.agreement.accept");babelHelpers.defineProperty(x,"checkAgreementUrl","/bitrix/services/main/ajax.php?action=ai.api.agreement.check");babelHelpers.defineProperty(x,"setBannerLaunchedUrl","/bitrix/services/main/ajax.php?action=ai.api.tooling.setLaunched");e.Base=c;e.Text=u;e.Engine=x})(this.BX.AI=this.BX.AI||{},BX);
//# sourceMappingURL=engine.bundle.map.js