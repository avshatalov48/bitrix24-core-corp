{"version":3,"file":"copilot-image-controller.bundle.js","sources":["../src/menu-items-commands/base-command.js","../src/menu-items-commands/cancel-image-command.js","../src/menu-items-commands/place-image-under-command.js","../src/menu-items-commands/place-image-above-command.js","../src/menu-items-commands/save-image-command.js","../src/menu-items-commands/repeat-image-completion.js","../src/menu-items/error-menu-items.js","../src/menu-items/result-menu-items.js","../src/image-configurator-styles.js","../src/image-configurator-params-config.js","../src/image-configurator-params.js","../src/image-configurator.js","../src/image-configurator-popup.js","../src/copilot-image-controller.js"],"sourcesContent":["import type { CopilotImageController } from 'ai.copilot.copilot-image-controller';\n\nexport type BaseCommandOptions = {\n\tcopilotImageController: CopilotImageController;\n}\n\nexport class BaseCommand\n{\n\tcopilotImageController: CopilotImageController;\n\tconstructor(options: BaseCommandOptions)\n\t{\n\t\tthis.copilotImageController = options.copilotImageController;\n\t}\n\n\texecute(): void\n\t{\n\t\tthrow new Error('You must implement this method!');\n\t}\n}\n","import { Dom } from 'main.core';\nimport type { CopilotInput } from 'ai.copilot';\nimport type { BaseCommandOptions } from './base-command';\nimport { BaseCommand } from './base-command';\n\ntype CancelImageCommandOptions = {\n\tinputField: CopilotInput;\n\tcopilotContainer: HTMLElement;\n} | BaseCommandOptions;\n\nexport class CancelImageCommand extends BaseCommand\n{\n\t#inputField: CopilotInput;\n\t#copilotContainer: HTMLElement;\n\n\tconstructor(options: CancelImageCommandOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.#copilotContainer = options.copilotContainer;\n\t\tthis.#inputField = options.inputField;\n\t}\n\n\texecute()\n\t{\n\t\tthis.copilotImageController.emit('cancel');\n\t\tthis.copilotImageController.destroyAllMenus();\n\t\tthis.copilotImageController.showImageConfigurator();\n\t\tthis.#inputField.clearErrors();\n\t\tthis.#inputField.clear();\n\t\tthis.#inputField.enable();\n\t\tDom.removeClass(this.#copilotContainer, '--error');\n\t\t// this.#selectedCommand = null;\n\t\t// this.#resultStack = [];\n\t\tthis.#inputField.focus();\n\t\tthis.copilotImageController.getAnalytics().sendEventCancel();\n\t}\n}\n","import { BaseCommand } from './base-command';\n\nexport class PlaceImageUnderCommand extends BaseCommand\n{\n\texecute()\n\t{\n\t\tthis.copilotImageController.emit('place-under');\n\t}\n}\n","import { BaseCommand } from './base-command';\n\nexport class PlaceImageAboveCommand extends BaseCommand\n{\n\texecute()\n\t{\n\t\tthis.copilotImageController.emit('place-above');\n\t}\n}\n","import { BaseEvent } from 'main.core.events';\nimport { BaseCommand } from './base-command';\n\nexport type saveEventData = {\n\timageUrl: string | null;\n}\n\nexport class SaveImageCommand extends BaseCommand\n{\n\texecute()\n\t{\n\t\tthis.copilotImageController.emit('save', new BaseEvent({\n\t\t\tdata: {\n\t\t\t\timageUrl: this.copilotImageController.getResultImageUrl(),\n\t\t\t},\n\t\t}));\n\n\t\tthis.copilotImageController.getAnalytics().sendEventSave();\n\t}\n}\n","import { BaseCommand } from './base-command';\n\nexport class RepeatImageCompletion extends BaseCommand\n{\n\texecute()\n\t{\n\t\tthis.copilotImageController.completions();\n\t}\n}\n","import type { CopilotImageController } from 'ai.copilot.copilot-image-controller';\nimport type { CopilotInput, CopilotMenuItem } from 'ai.copilot';\nimport { Loc } from 'main.core';\nimport { RepeatImageCompletion, CancelImageCommand } from '../menu-items-commands/index';\n\ntype CopilotErrorMenuItemsOptions = {\n\tcopilotImageController: CopilotImageController;\n\tinputField: CopilotInput;\n\tcopilotContainer: HTMLElement;\n}\n\nexport class ImageConfiguratorErrorMenuItems\n{\n\tstatic getMenuItems(options: CopilotErrorMenuItemsOptions): CopilotMenuItem[]\n\t{\n\t\tconst copilotImageController = options.copilotImageController;\n\t\tconst inputField = options.inputField;\n\t\tconst copilotContainer = options.copilotContainer;\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tcode: 'repeat',\n\t\t\t\ttext: Loc.getMessage('AI_COPILOT_COMMAND_REPEAT'),\n\t\t\t\ticon: 'left-semicircular-anticlockwise-arrow-1',\n\t\t\t\tnotHighlight: true,\n\t\t\t\tcommand: new RepeatImageCompletion({\n\t\t\t\t\tcopilotImageController,\n\t\t\t\t}),\n\t\t\t},\n\t\t\t{\n\t\t\t\tcode: 'cancel',\n\t\t\t\ttext: Loc.getMessage('AI_COPILOT_COMMAND_CANCEL'),\n\t\t\t\ticon: 'cross-45',\n\t\t\t\tnotHighlight: true,\n\t\t\t\tcommand: new CancelImageCommand({\n\t\t\t\t\tcopilotImageController,\n\t\t\t\t\tinputField,\n\t\t\t\t\tcopilotContainer,\n\t\t\t\t}),\n\t\t\t},\n\t\t];\n\t}\n}\n","import type { CopilotImageController } from 'ai.copilot.copilot-image-controller';\nimport type { CopilotInput, CopilotMenuItem } from 'ai.copilot';\nimport { Loc } from 'main.core';\nimport { Main as IconSetMain, Actions as IconSetActions } from 'ui.icon-set.api.core';\nimport {\n\tSaveImageCommand,\n\tPlaceImageAboveCommand,\n\tPlaceImageUnderCommand,\n\tCancelImageCommand,\n\tRepeatImageCompletion,\n} from '../menu-items-commands/index';\n\ntype CopilotErrorMenuItemsOptions = {\n\tcopilotImageController: CopilotImageController;\n\tinputField: CopilotInput;\n\tuseInsertAboveAndUnderMenuItems: boolean;\n}\n\nexport class ImageConfiguratorResultMenuItems\n{\n\tstatic getMenuItems(options: CopilotErrorMenuItemsOptions): CopilotMenuItem[]\n\t{\n\t\tconst copilotImageController = options?.copilotImageController;\n\t\tconst inputField = options.inputField;\n\t\tconst useAboveAndUnderTextMenuItems = options.useInsertAboveAndUnderMenuItems;\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tcode: 'save',\n\t\t\t\ttext: Loc.getMessage('AI_COPILOT_IMAGE_RESULT_MENU_SAVE'),\n\t\t\t\ticon: IconSetMain.CHECK,\n\t\t\t\tnotHighlight: true,\n\t\t\t\tcommand: new SaveImageCommand({\n\t\t\t\t\tcopilotImageController,\n\t\t\t\t}),\n\t\t\t},\n\t\t\tuseAboveAndUnderTextMenuItems\n\t\t\t\t? {\n\t\t\t\t\tcode: 'place_above',\n\t\t\t\t\ttext: Loc.getMessage('AI_COPILOT_IMAGE_RESULT_MENU_PLACE_ABOVE_TEXT'),\n\t\t\t\t\ticon: IconSetActions.ARROW_TOP,\n\t\t\t\t\tnotHighlight: true,\n\t\t\t\t\tcommand: new PlaceImageAboveCommand({\n\t\t\t\t\t\tcopilotImageController,\n\t\t\t\t\t}),\n\t\t\t\t} : null,\n\t\t\tuseAboveAndUnderTextMenuItems\n\t\t\t\t? {\n\t\t\t\t\tcode: 'place_under',\n\t\t\t\t\ttext: Loc.getMessage('AI_COPILOT_IMAGE_RESULT_MENU_PLACE_UNDER_TEXT'),\n\t\t\t\t\ticon: IconSetActions.ARROW_DOWN,\n\t\t\t\t\tnotHighlight: true,\n\t\t\t\t\tcommand: new PlaceImageUnderCommand({\n\t\t\t\t\t\tcopilotImageController,\n\t\t\t\t\t}),\n\t\t\t\t} : null,\n\t\t\t{\n\t\t\t\tcode: 'repeat',\n\t\t\t\ttext: Loc.getMessage('AI_COPILOT_IMAGE_RESULT_MENU_REPEAT'),\n\t\t\t\ticon: IconSetActions.LEFT_SEMICIRCULAR_ANTICLOCKWISE_ARROW_1,\n\t\t\t\tnotHighlight: true,\n\t\t\t\tcommand: new RepeatImageCompletion({\n\t\t\t\t\tcopilotImageController,\n\t\t\t\t}),\n\t\t\t},\n\t\t\t{\n\t\t\t\tseparator: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tcode: 'cancel',\n\t\t\t\ttext: Loc.getMessage('AI_COPILOT_IMAGE_RESULT_MENU_CANCEL'),\n\t\t\t\ticon: IconSetActions.CROSS_45,\n\t\t\t\tnotHighlight: true,\n\t\t\t\tcommand: new CancelImageCommand({\n\t\t\t\t\tcopilotImageController,\n\t\t\t\t\tinputField,\n\t\t\t\t}),\n\t\t\t},\n\t\t].filter((item) => Boolean(item));\n\t}\n}\n","import type { ImageCopilotStyle } from 'ai.engine';\nimport { Tag, Loc, Event, Dom } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport './css/image-configurator-styles.css';\n\nconst ImageConfiguratorStylesEvents = Object.freeze({\n\tselect: 'select',\n});\n\ntype ImageConfiguratorStylesOptions = {\n\tstyles: ImageCopilotStyle[];\n}\n\nexport class ImageConfiguratorStyles extends EventEmitter\n{\n\t#mainStylesCount: number = 0;\n\t#currentMainStylesCount: number = 9;\n\t#selectedStyle: string | null = null;\n\t#isExpanded: boolean = false;\n\t#styleList: HTMLElement | null = null;\n\t#container: HTMLElement | null = null;\n\t#styles: ImageCopilotStyle[];\n\n\tconstructor(options: ImageConfiguratorStylesOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.#styles = options.styles;\n\n\t\tthis.#mainStylesCount = this.#styles.length;\n\n\t\tthis.#selectedStyle = this.#styles[0].code;\n\t\tthis.setEventNamespace('AI.Copilot.ImageConfiguratorStyles');\n\t}\n\n\tgetSelectedStyle(): string\n\t{\n\t\treturn this.#selectedStyle;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"ai__image-configurator-styles\">\n\t\t\t\t${this.#renderHeader()}\n\t\t\t\t${this.#renderStylesList()}\n\t\t\t</div>\n\t\t`;\n\n\t\trequestAnimationFrame(() => {\n\t\t\tconst styleListStyles = getComputedStyle(this.#styleList);\n\t\t\tconst paddingTop = styleListStyles.getPropertyValue('padding-top');\n\t\t\tconst paddingBottom = styleListStyles.getPropertyValue('padding-bottom');\n\t\t\tconst padding = parseFloat(paddingTop) + parseFloat(paddingBottom);\n\n\t\t\tDom.style(this.#styleList, 'height', `${this.#styleList.offsetHeight - padding + 4}px`);\n\t\t});\n\n\t\treturn this.#container;\n\t}\n\n\t#renderHeader(): HTMLElement\n\t{\n\t\tconst expandListBtn = this.#isShowExpandBtn() ? this.#renderExpandListBtn() : null;\n\n\t\treturn Tag.render`\n\t\t\t<header class=\"ai__image-configurator-styles_header\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ai__image-configurator-styles_title\"\n\t\t\t\t\ttitle=\"${Loc.getMessage('AI_COPILOT_IMAGE_POPULAR_STYLES')}\"\n\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('AI_COPILOT_IMAGE_POPULAR_STYLES')}\n\t\t\t\t</div>\n\t\t\t\t${expandListBtn}\n\t\t\t</header>\n\t\t`;\n\t}\n\n\t#isShowExpandBtn(): boolean\n\t{\n\t\treturn this.#mainStylesCount > this.#currentMainStylesCount;\n\t}\n\n\t#renderExpandListBtn(): HTMLElement\n\t{\n\t\tconst expandListBtn = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"ai__image-configurator-styles_all-styles\"\n\t\t\t\ttitle=\"${Loc.getMessage('AI_COPILOT_IMAGE_ALL_STYLES')}\"\n\t\t\t>\n\t\t\t\t${Loc.getMessage('AI_COPILOT_IMAGE_ALL_STYLES')}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(expandListBtn, 'click', () => {\n\t\t\tthis.#isExpanded = !this.#isExpanded;\n\n\t\t\tif (this.#isExpanded)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#styleList, '--expanded');\n\t\t\t\tthis.#currentMainStylesCount = Object.values(this.#styles).length;\n\t\t\t\tthis.#styleList.innerHTML = '';\n\t\t\t\tthis.#styleList.append(...this.#renderStyleItems());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.#styleList, '--expanded');\n\t\t\t}\n\t\t});\n\n\t\treturn expandListBtn;\n\t}\n\n\t#renderStylesList(): HTMLElement\n\t{\n\t\tthis.#styleList = Tag.render`\n\t\t\t<div class=\"ai__image-configurator-styles_list\">\n\t\t\t\t${this.#renderStyleItems()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#styleList;\n\t}\n\n\t#renderStyleItems(): HTMLElement[]\n\t{\n\t\treturn this.#styles.slice(0, this.#currentMainStylesCount).map((styleItem) => {\n\t\t\treturn this.#renderStyleItem(styleItem);\n\t\t});\n\t}\n\n\t#renderStyleItem(style: ImageCopilotStyle): HTMLElement\n\t{\n\t\tconst radioButton = Tag.render`\n\t\t\t<input\n\t\t\t\t${style.code === this.#selectedStyle ? 'checked' : ''}\n\t\t\t\tid=\"${style.code}\"\n\t\t\t\tname=\"ai__image-configurator-style\"\n\t\t\t\ttype=\"radio\"\n\t\t\t\tclass=\"ai__image-configurator-style_item-radio-btn\"\n\t\t\t/>\n\t\t`;\n\t\tconst item = Tag.render`\n\t\t\t<div\n\t\t\t\ttitle=\"${style.name}\"\n\t\t\t\tclass=\"ai__image-configurator-styles_item\"\n\t\t\t>\n\t\t\t\t${radioButton}\n\t\t\t\t<label\n\t\t\t\t\tfor=\"${style.code}\"\n\t\t\t\t\tclass=\"ai__image-configurator-styles_item-inner\"\n\t\t\t\t\tstyle=\"background-image: url(${style.preview})\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ai__image-configurator-styles_item-title\">${style.name}</div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(radioButton, 'input', () => {\n\t\t\tthis.#selectedStyle = style.code;\n\t\t\tthis.emit(ImageConfiguratorStylesEvents.select, new BaseEvent({\n\t\t\t\tdata: style.code,\n\t\t\t}));\n\t\t});\n\n\t\treturn item;\n\t}\n}\n","import type { EngineInfo, ImageCopilotFormat } from 'ai.engine';\nimport { Loc } from 'main.core';\nimport { Editor, Main } from 'ui.icon-set.api.core';\n\nexport type ImageConfiguratorParam = {\n\ttitle: string;\n\ticon: string;\n\toptions?: ImageConfiguratorParamOption[];\n}\n\nexport type ImageConfiguratorParamOption = {\n\ttitle: string,\n\tvalue: string,\n}\n\nexport type ImageConfiguratorParamsCurrentValues = {\n\tformat: string;\n\tengine: string;\n}\n\ntype getParamsOptions = {\n\tformats: ImageCopilotFormat[];\n\tengines: EngineInfo[];\n}\n\nexport const getParams = (options: getParamsOptions): {[code: string]: ImageConfiguratorParam} => {\n\treturn {\n\t\tformat: {\n\t\t\ttitle: Loc.getMessage('AI_COPILOT_IMAGE_FORMAT_OPTION_TITLE'),\n\t\t\ticon: Editor.INCERT_IMAGE,\n\t\t\toptions: getOptionsFromFormats(options.formats),\n\t\t},\n\t\tengine: {\n\t\t\ttitle: Loc.getMessage('AI_COPILOT_IMAGE_ENGINE_OPTION_TITLE'),\n\t\t\ticon: Main.ROBOT,\n\t\t\toptions: getOptionsFromEngines(options.engines),\n\t\t},\n\t};\n};\n\nconst getOptionsFromFormats = (formats: ImageCopilotFormat[]): ImageConfiguratorParamOption[] => {\n\treturn formats.map((format) => {\n\t\treturn {\n\t\t\ttitle: format.name,\n\t\t\tvalue: format.code,\n\t\t};\n\t});\n};\n\nconst getOptionsFromEngines = (engines: EngineInfo[]): ImageConfiguratorParamOption[] => {\n\treturn engines.map((engine) => {\n\t\treturn {\n\t\t\ttitle: engine.title,\n\t\t\tvalue: engine.code,\n\t\t};\n\t});\n};\n","import type { ImageCopilotFormat, EngineInfo } from 'ai.engine';\nimport { Tag, Event, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport type { MenuItemOptions, MenuOptions } from 'main.popup';\nimport { Menu, MenuItem } from 'main.popup';\nimport { Icon, Actions, Main } from 'ui.icon-set.api.core';\n\nimport './css/image-configurator-params.css';\n\nimport { getParams } from './image-configurator-params-config';\nimport type {\n\tImageConfiguratorParam,\n\tImageConfiguratorParamOption,\n\tImageConfiguratorParamsCurrentValues,\n} from './image-configurator-params-config';\n\ntype ImageConfiguratorParamsOptions = {\n\tformats: ImageCopilotFormat[];\n\tengines: EngineInfo[];\n};\n\nexport class ImageConfiguratorParams extends EventEmitter\n{\n\t#container: HTMLElement | null;\n\t#currentValues: ImageConfiguratorParamsCurrentValues;\n\t#openOptionsMenu: Menu | null;\n\t#params: any = {};\n\n\tconstructor(options: ImageConfiguratorParamsOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.#params = this.#initParams(options);\n\n\t\tconst data = {\n\t\t\tformat: this.#params.format.options[0].value,\n\t\t\tengine: this.#getSelectedEngineCodeFromEngines(options.engines),\n\t\t};\n\n\t\tconst handler = {\n\t\t\tset: (target: ImageConfiguratorParamsCurrentValues, property, value) => {\n\t\t\t\tReflect.set(target, property, value);\n\n\t\t\t\tif (this.#container && (property === 'format' || property === 'engine'))\n\t\t\t\t{\n\t\t\t\t\tconst option = this.#params[property].options.find((currentOption) => currentOption.value === value);\n\n\t\t\t\t\tconst optionElem = this.#container.querySelector(`#ai__copilot-image-params-item-${property}`);\n\n\t\t\t\t\tif (optionElem)\n\t\t\t\t\t{\n\t\t\t\t\t\toptionElem.innerText = option.title;\n\n\t\t\t\t\t\tDom.attr(optionElem, 'title', option.title);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t};\n\n\t\tthis.#currentValues = new Proxy(data, handler);\n\n\t\tthis.setEventNamespace('AI.Copilot.ImageParams');\n\t}\n\n\tgetCurrentValues(): ImageConfiguratorParamsCurrentValues\n\t{\n\t\treturn { ...this.#currentValues };\n\t}\n\n\t#getSelectedEngineCodeFromEngines(engines: EngineInfo[]): ?string\n\t{\n\t\tconst selectedEngine: ?EngineInfo = engines.find((engine) => engine.selected);\n\n\t\treturn selectedEngine.code || engines?.[0]?.code;\n\t}\n\n\tisContainsTarget(target: HTMLElement): boolean\n\t{\n\t\treturn this.#container?.contains(target)\n\t\t\t|| this.#openOptionsMenu?.getPopupWindow()?.getPopupContainer()?.contains(target);\n\t}\n\n\tsetFormats(formats: ImageCopilotFormat[]): void\n\t{\n\t\tthis.#params.format = getParams({\n\t\t\tformats,\n\t\t\tengines: [],\n\t\t}).format;\n\t}\n\n\tsetSelectedEngine(engineCode: string): void\n\t{\n\t\tthis.#currentValues.engine = engineCode;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"ai__copilot-image-params\">\n\t\t\t\t${this.#renderParams(this.#params)}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#container;\n\t}\n\n\t#renderParams(parameters: ImageConfiguratorParam[]): HTMLElement[]\n\t{\n\t\treturn Object.entries(parameters).map(([parameterName, parameter]) => {\n\t\t\treturn this.#renderParam(parameter, parameterName);\n\t\t});\n\t}\n\n\t#renderParam(options: ImageConfiguratorParam, parameterName): HTMLElement\n\t{\n\t\tconst selectedOption = options.options.find((option) => option.value === this.#currentValues[parameterName]);\n\t\tconst icon = new Icon({\n\t\t\tsize: 24,\n\t\t\ticon: options.icon,\n\t\t\tcolor: '#8E52EC',\n\t\t});\n\n\t\tconst rightChevronIcon = new Icon({\n\t\t\tsize: 16,\n\t\t\ticon: Actions.CHEVRON_RIGHT,\n\t\t\tcolor: getComputedStyle(document.body).getPropertyValue('--ui-color-base-50'),\n\t\t});\n\n\t\tconst param = Tag.render`\n\t\t\t<div class=\"ai__copilot-image-params-item\">\n\t\t\t\t<div class=\"ai__copilot-image-params-item_title\">\n\t\t\t\t\t<div class=\"ai__copilot-image-params-item_title-icon\">\n\t\t\t\t\t\t${icon.render()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ai__copilot-image-params-item_title-text\"\n\t\t\t\t\t\ttitle=\"${options.title}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${options.title}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div ref=\"value\" class=\"ai__copilot-image-params-item_value\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tid=\"ai__copilot-image-params-item-${parameterName}\"\n\t\t\t\t\t\tclass=\"ai__copilot-image-params-item_value-text\"\n\t\t\t\t\t\ttitle=\"${selectedOption.title}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${selectedOption.title}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ai__copilot-image-params-item_value-arrow-icon\">\n\t\t\t\t\t\t${rightChevronIcon.render()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(param.root, 'click', () => {\n\t\t\tif (this.#openOptionsMenu)\n\t\t\t{\n\t\t\t\tthis.#openOptionsMenu.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#showOptionsMenu(param.value, this.#params[parameterName].options, parameterName);\n\t\t\t}\n\t\t});\n\n\t\treturn param.root;\n\t}\n\n\t#showOptionsMenu(bindElement: HTMLElement, options: ImageConfiguratorParam[], parameterName): void\n\t{\n\t\tthis.#openOptionsMenu = new Menu({\n\t\t\t...this.#getMenuOptions(bindElement, options, parameterName),\n\t\t});\n\n\t\tthis.#openOptionsMenu.show();\n\t}\n\n\t#getMenuOptions(\n\t\tbindElement: HTMLElement,\n\t\timageConfiguratorParams: ImageConfiguratorParam[],\n\t\tparameterName: string,\n\t): MenuOptions\n\t{\n\t\tconst position = Dom.getPosition(bindElement);\n\n\t\treturn {\n\t\t\tbindElement: {\n\t\t\t\ttop: position.top - 6,\n\t\t\t\tleft: position.right + 18,\n\t\t\t},\n\t\t\tcacheable: false,\n\t\t\tminWidth: 200,\n\t\t\titems: this.#getMenuItemsFromOptions(imageConfiguratorParams, parameterName),\n\t\t\tevents: {\n\t\t\t\tonPopupAfterClose: () => {\n\t\t\t\t\tthis.#openOptionsMenu = null;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t#getMenuItemsFromOptions(options: ImageConfiguratorParamOption[], parameterName: string): MenuItemOptions[]\n\t{\n\t\treturn options.map((option): MenuItemOptions => {\n\t\t\tconst isSelectedOption = option.value === this.#currentValues[parameterName];\n\n\t\t\treturn {\n\t\t\t\tid: option.value,\n\t\t\t\ttext: option.title,\n\t\t\t\thtml: this.#getMenuItemHtml(option.title, isSelectedOption),\n\t\t\t\tonclick: this.#handleMenuItemClick(parameterName, option.value),\n\t\t\t};\n\t\t});\n\t}\n\n\t#getMenuItemHtml(title: string, isSelected: boolean): string\n\t{\n\t\tconst selectedIcon = new Icon({\n\t\t\tsize: 18,\n\t\t\ticon: Main.CHECK,\n\t\t\tcolor: getComputedStyle(document.body).getPropertyValue('--ui-color-link-primary-base'),\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ai__copilot-image-params-popup-item\">\n\t\t\t\t<span class=\"ai__copilot-image-params-popup-item_title\">${title}</span>\n\t\t\t\t${isSelected ? selectedIcon.render() : null}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#handleMenuItemClick(parameterName: string, parameterValue): Function\n\t{\n\t\treturn (e: PointerEvent, menuItem: MenuItem): void => {\n\t\t\tif (this.#currentValues[parameterName] !== parameterValue)\n\t\t\t{\n\t\t\t\tthis.emit('change-parameter', { parameter: parameterName, value: parameterValue });\n\t\t\t}\n\n\t\t\tthis.#currentValues[parameterName] = parameterValue;\n\n\t\t\tmenuItem.getMenuWindow().close();\n\t\t\tthis.#openOptionsMenu = null;\n\t\t};\n\t}\n\n\t#initParams(options: ImageConfiguratorParamsOptions): Proxy\n\t{\n\t\tconst params = getParams({\n\t\t\tformats: Object.values(options.formats),\n\t\t\tengines: options.engines,\n\t\t});\n\n\t\tconst changeParamsHandler = {\n\t\t\tset: (target, property, value) => {\n\t\t\t\tReflect.set(target, property, value);\n\n\t\t\t\tif (property === 'format')\n\t\t\t\t{\n\t\t\t\t\tthis.#currentValues.format = this.#params.format.options[0].value;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t};\n\n\t\treturn new Proxy(params, changeParamsHandler);\n\t}\n}\n","import { Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport './css/image-configurator.css';\n\nimport { ImageConfiguratorStyles } from './image-configurator-styles';\nimport { ImageConfiguratorParams } from './image-configurator-params';\nimport type { ImageConfiguratorParamsCurrentValues } from './image-configurator-params-config';\nimport type { ImageCopilotFormat, ImageCopilotStyle, EngineInfo } from 'ai.engine';\n\nexport type ImageConfiguratorOptions = {\n\tformats: ImageCopilotFormat[];\n\tstyles: ImageCopilotStyle[];\n\tengines: EngineInfo[];\n}\n\nexport type getParamsResult = {\n\tstyle: string;\n} | ImageConfiguratorParamsCurrentValues;\n\nexport class ImageConfigurator extends EventEmitter\n{\n\t#container: HTMLElement;\n\t#imageConfiguratorStyles: ImageConfiguratorStyles;\n\t#imageConfiguratorParams: ImageConfiguratorParams;\n\n\tconstructor(options: ImageConfiguratorOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('AI.Copilot.ImageConfigurator');\n\n\t\tthis.#imageConfiguratorStyles = new ImageConfiguratorStyles({\n\t\t\tstyles: options?.styles ?? [],\n\t\t});\n\n\t\tthis.#imageConfiguratorParams = new ImageConfiguratorParams({\n\t\t\tformats: options?.formats ?? [],\n\t\t\tengines: options?.engines ?? [],\n\t\t});\n\n\t\tthis.#imageConfiguratorParams.subscribe('change-parameter', (event) => {\n\t\t\tconst data = event.getData();\n\n\t\t\tthis.emit('change-parameter', data);\n\t\t});\n\t}\n\n\tsetFormats(formats: ImageCopilotFormat[]): void\n\t{\n\t\tthis.#imageConfiguratorParams.setFormats(formats);\n\t}\n\n\tsetSelectedEngine(engineCode: string): void\n\t{\n\t\tthis.#imageConfiguratorParams.setSelectedEngine(engineCode);\n\t}\n\n\tgetParams(): getParamsResult\n\t{\n\t\treturn {\n\t\t\tstyle: this.#imageConfiguratorStyles.getSelectedStyle(),\n\t\t\t...this.#imageConfiguratorParams.getCurrentValues(),\n\t\t};\n\t}\n\n\tisContainsTarget(target: HTMLElement): boolean\n\t{\n\t\treturn this.#container?.contains(target) || this.#imageConfiguratorParams?.isContainsTarget(target);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"ai__copilot-image-configurator\">\n\t\t\t\t<div class=\"ai__copilot-image-configurator_styles\">\n\t\t\t\t\t${this.#renderImageStyles()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ai__copilot-image-configurator_params\">\n\t\t\t\t\t${this.#renderImageParams()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#container;\n\t}\n\n\t#renderImageStyles(): HTMLElement\n\t{\n\t\treturn this.#imageConfiguratorStyles.render();\n\t}\n\n\t#renderImageParams(): HTMLElement\n\t{\n\t\treturn this.#imageConfiguratorParams.render();\n\t}\n}\n","import { Tag, Loc, Event, Dom } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Loader } from 'main.loader';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Icon, Actions } from 'ui.icon-set.api.core';\nimport { Button } from 'ui.buttons';\nimport type { ImageConfiguratorOptions } from './image-configurator';\n\nimport { ImageConfigurator } from './image-configurator';\nimport './css/image-configurator-popup.css';\n\ntype ImageConfiguratorPopupOffset = {\n\ttop: number;\n\tleft: number;\n}\n\ntype ImageConfiguratorPopupOptions = {\n\tbindElement: HTMLElement,\n\tpopupId: string;\n\tpopupOffset?: ImageConfiguratorPopupOffset;\n\twithoutBackBtn: boolean;\n\timageConfiguratorOptions: ImageConfiguratorOptions;\n}\n\ntype ImageConfiguration = {\n\tstyle: string;\n\tformat: string;\n\tengine: string;\n}\n\nexport const ImageConfiguratorPopupEvents = Object.freeze({\n\tcompletions: 'completions',\n\tback: 'back',\n\tselectEngine: 'selectEngine',\n});\n\nexport class ImageConfiguratorPopup extends EventEmitter\n{\n\t#bindElement: HTMLElement | null = null;\n\t#popup: Popup | null = null;\n\t#popupOffset: ImageConfiguratorPopupOffset;\n\t#popupId: string;\n\t#imageConfigurator: ImageConfigurator;\n\t#withoutBackBtn: boolean;\n\t#submitButton: Button;\n\t#loader: Loader;\n\t#loaderOverlay: HTMLElement;\n\n\tconstructor(options: ImageConfiguratorPopupOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.#popupId = options.popupId || String(Math.random());\n\t\tthis.#bindElement = options.bindElement;\n\t\tthis.#popupOffset = options.popupOffset;\n\t\tthis.#withoutBackBtn = options.withoutBackBtn === true;\n\t\tthis.#imageConfigurator = new ImageConfigurator({\n\t\t\tformats: options.imageConfiguratorOptions.formats,\n\t\t\tstyles: options.imageConfiguratorOptions.styles,\n\t\t\tengines: options.imageConfiguratorOptions.engines,\n\t\t});\n\n\t\tthis.#imageConfigurator.subscribe('change-parameter', (event) => {\n\t\t\tconst data = event.getData();\n\n\t\t\tif (data.parameter === 'engine')\n\t\t\t{\n\t\t\t\tthis.emit(ImageConfiguratorPopupEvents.selectEngine, data.value);\n\t\t\t}\n\t\t});\n\n\t\tthis.#initSubmitButton();\n\n\t\tthis.setEventNamespace('AI.Copilot:ImagePopup');\n\t}\n\n\tgetPopupId(): string\n\t{\n\t\treturn this.#popupId;\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\treturn this.#popup;\n\t}\n\n\tshow(): void\n\t{\n\t\tif (this.#popup === null)\n\t\t{\n\t\t\tthis.#createPopup();\n\t\t}\n\n\t\tthis.#popup.show();\n\t}\n\n\thide(): void\n\t{\n\t\tthis.#popup?.close();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#popup?.destroy();\n\n\t\tthis.#popup = null;\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.#popup.isShown();\n\t}\n\n\tisContainsTarget(target: HTMLElement): boolean\n\t{\n\t\treturn this.#popup?.getPopupContainer()?.contains(target) || this.#imageConfigurator?.isContainsTarget(target);\n\t}\n\n\tadjustPosition(): void\n\t{\n\t\tthis.#popup?.adjustPosition({\n\t\t\tforceBindPosition: true,\n\t\t});\n\t}\n\n\tgetImageConfiguration(): ImageConfiguration\n\t{\n\t\treturn this.#imageConfigurator.getParams();\n\t}\n\n\tsetFormats(formats): void\n\t{\n\t\tthis.#imageConfigurator.setFormats(formats);\n\t}\n\n\tsetSelectedEngine(engineCode: string): void\n\t{\n\t\tthis.#imageConfigurator.setSelectedEngine(engineCode);\n\t}\n\n\tdisableSubmitButton(): void\n\t{\n\t\tthis.#submitButton.setDisabled(true);\n\t}\n\n\tenableSubmitButton(): void\n\t{\n\t\tthis.#submitButton.setDisabled(false);\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tthis.#loaderOverlay = Tag.render`\n\t\t\t<div class=\"ai__copilot-image-configurator-popup-loader-overlay\"></div>\n\t\t`;\n\n\t\tDom.append(this.#loaderOverlay, this.#popup?.getPopupContainer());\n\n\t\tthis.#loader = new Loader({\n\t\t\tsize: 110,\n\t\t\tcolor: getComputedStyle(document.body).getPropertyValue('--ui-color-copilot-primary'),\n\t\t\ttarget: this.#loaderOverlay,\n\t\t});\n\n\t\tthis.#loader.show(this.#loaderOverlay);\n\t}\n\n\thideLoader(): void\n\t{\n\t\tthis.#loader.destroy();\n\t\tDom.remove(this.#loaderOverlay);\n\n\t\tthis.#loader = null;\n\t\tthis.#loaderOverlay = null;\n\t}\n\n\t#createPopup(): Popup\n\t{\n\t\tthis.#popup = new Popup({\n\t\t\tid: this.#popupId,\n\t\t\tbindElement: this.#bindElement,\n\t\t\tcacheable: true,\n\t\t\twidth: 278,\n\t\t\tpadding: 0,\n\t\t\tcontent: this.#renderPopupContent(),\n\t\t});\n\n\t\tthis.#popup.setOffset({\n\t\t\toffsetTop: this.#popupOffset?.top,\n\t\t\toffsetLeft: this.#popupOffset?.left,\n\t\t});\n\t}\n\n\t#renderPopupContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ai__copilot-image-configurator-popup-content\">\n\t\t\t\t<header class=\"ai__copilot-image-configurator-popup-content_header\">\n\t\t\t\t\t${this.#renderBackBtnIfNeeded()}\n\t\t\t\t\t<div class=\"ai__copilot-image-configurator-popup-content_title\">\n\t\t\t\t\t\t${Loc.getMessage('AI_COPILOT_IMAGE_POPUP_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\t\t\t\t<div class=\"ai__copilot-image-configurator-popup-content_params\">\n\t\t\t\t\t${this.#imageConfigurator.render()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ai__copilot-image-configurator-popup-content_footer\">\n\t\t\t\t\t${this.#submitButton.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderBackBtnIfNeeded(): HTMLElement\n\t{\n\t\tif (this.#withoutBackBtn)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst backBtnIcon = new Icon({\n\t\t\tsize: 24,\n\t\t\tcolor: getComputedStyle(document.body).getPropertyValue('--ui-color-base-90'),\n\t\t\ticon: Actions.CHEVRON_LEFT,\n\t\t});\n\n\t\tconst backBtnIconElem = backBtnIcon.render();\n\n\t\tEvent.bind(backBtnIconElem, 'click', () => {\n\t\t\tthis.emit(ImageConfiguratorPopupEvents.back, new BaseEvent());\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ai__copilot-image-configurator-popup-content_back-btn\">\n\t\t\t\t${backBtnIconElem}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#initSubmitButton(): void\n\t{\n\t\tthis.#submitButton = new Button({\n\t\t\tcolor: Button.Color.AI,\n\t\t\ttext: Loc.getMessage('AI_COPILOT_IMAGE_POPUP_GENERATE_BTN'),\n\t\t\tround: true,\n\t\t\tnoCaps: true,\n\t\t\tonclick: () => {\n\t\t\t\tthis.emit(ImageConfiguratorPopupEvents.completions, new BaseEvent({\n\t\t\t\t\tdata: this.#imageConfigurator.getParams(),\n\t\t\t\t}));\n\t\t\t},\n\t\t});\n\t}\n}\n","import type { EngineInfo, ImageCopilotFormat, ImageCopilotStyle } from 'ai.engine';\nimport { Engine, Text as TextPayload } from 'ai.engine';\nimport { Dom, Loc } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { AjaxErrorHandler } from 'ai.ajax-error-handler';\nimport type { CopilotAnalytics } from '../../src/copilot-analytics';\nimport { ImageConfiguratorErrorMenuItems } from './menu-items/error-menu-items';\nimport { ImageConfiguratorResultMenuItems } from './menu-items/result-menu-items';\nimport { ImageConfiguratorPopup, ImageConfiguratorPopupEvents } from './image-configurator-popup';\nimport type { CopilotInput, CopilotInputEvents, CopilotMenu } from 'ai.copilot';\n\nexport type saveEventData = {\n\timageUrl: string | null;\n}\n\ntype CopilotImageControllerOptions = {\n\tinputField: CopilotInput;\n\tcopilotContainer: HTMLElement;\n\tengine: Engine;\n\tcopilotInputEvents: CopilotInputEvents;\n\tcopilotMenu: CopilotMenu;\n\tpopupWithoutBackBtn: boolean;\n\tuseInsertAboveAndUnderMenuItems: boolean;\n\tanalytics: CopilotAnalytics;\n}\n\nexport class CopilotImageController extends EventEmitter\n{\n\t#analytics: CopilotAnalytics;\n\t#copilotContainer: HTMLElement;\n\t#inputField: CopilotInput;\n\t#engine: Engine;\n\t#imageConfiguratorPopup: ImageConfiguratorPopup;\n\t#errorMenu: CopilotMenu;\n\t#resultMenu: CopilotMenu;\n\t#resultImageUrl: string | null;\n\t#copilotInputEvents: CopilotInputEvents;\n\t#CopilotMenu: CopilotMenu;\n\t#popupWithoutBackBtn: boolean;\n\t#currentGenerateRequestId: number;\n\t#useInsertAboveAndUnderTextMenuItems: boolean;\n\t#formats: ImageCopilotFormat[] = [];\n\t#styles: ImageCopilotStyle[] = [];\n\t#engines: EngineInfo[] = [];\n\n\t#inputFieldCancelLoadingEventHandler: Function;\n\t#inputFieldSubmitEventHandler: Function;\n\t#inputFieldAdjustHeightEventHandler: Function;\n\n\tconstructor(options: CopilotImageControllerOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('AI.CopilotImage');\n\n\t\tthis.#resultImageUrl = null;\n\t\tthis.#inputField = options.inputField;\n\t\tthis.#copilotContainer = options.copilotContainer;\n\t\tthis.#engine = options.engine;\n\t\tthis.#copilotInputEvents = options.copilotInputEvents;\n\t\tthis.#CopilotMenu = options.copilotMenu;\n\t\tthis.#popupWithoutBackBtn = options.popupWithoutBackBtn === true;\n\t\tthis.#useInsertAboveAndUnderTextMenuItems = options.useInsertAboveAndUnderMenuItems;\n\t\tthis.#analytics = options.analytics;\n\n\t\tthis.#inputFieldSubmitEventHandler = this.#handleInputFieldSubmitEvent.bind(this);\n\t\tthis.#inputFieldCancelLoadingEventHandler = this.#handleInputFieldCancelLoadingEvent.bind(this);\n\t\tthis.#inputFieldAdjustHeightEventHandler = this.#handleInputFieldAdjustHeightEvent.bind(this);\n\t}\n\n\tsetCopilotContainer(copilotContainer: HTMLElement)\n\t{\n\t\tthis.#copilotContainer = copilotContainer;\n\t}\n\n\tgetResultImageUrl(): string | null\n\t{\n\t\treturn this.#resultImageUrl;\n\t}\n\n\tisContainsTarget(target: HTMLElement): boolean\n\t{\n\t\tconst isImageConfiguratorPopup = this.#imageConfiguratorPopup?.isContainsTarget(target);\n\t\tconst isErrorMenu = this.#errorMenu?.contains(target);\n\t\tconst isResultMenu = this.#resultMenu?.contains(target);\n\n\t\treturn isImageConfiguratorPopup || isErrorMenu || isResultMenu;\n\t}\n\n\tasync init(): void\n\t{\n\t\tconst res = await this.#engine.getImageCopilotTooling();\n\n\t\tthis.#formats = res.data.params.formats;\n\t\tthis.#engines = res.data.engines;\n\t\tthis.#styles = res.data.params.styles;\n\t}\n\n\tshowImageConfigurator(): void\n\t{\n\t\tif (!this.#imageConfiguratorPopup)\n\t\t{\n\t\t\tthis.#initImageConfiguratorPopup();\n\t\t}\n\n\t\tthis.#imageConfiguratorPopup.show();\n\t}\n\n\tshowMenu(): void\n\t{\n\t\tthis.#resultMenu?.show();\n\t\tthis.#errorMenu?.show();\n\t\tthis.#imageConfiguratorPopup?.show();\n\t}\n\n\t#initImageConfiguratorPopup(): void\n\t{\n\t\tthis.#imageConfiguratorPopup = new ImageConfiguratorPopup({\n\t\t\tbindElement: this.#copilotContainer,\n\t\t\tpopupId: 'ai-image-configuration-popup',\n\t\t\tpopupOffset: {\n\t\t\t\ttop: 8,\n\t\t\t},\n\t\t\twithoutBackBtn: this.#popupWithoutBackBtn,\n\t\t\timageConfiguratorOptions: {\n\t\t\t\tstyles: this.#styles,\n\t\t\t\tformats: this.#formats,\n\t\t\t\tengines: this.#engines,\n\t\t\t},\n\t\t});\n\n\t\tif (!this.#inputField.getValue())\n\t\t{\n\t\t\tthis.#imageConfiguratorPopup.disableSubmitButton();\n\t\t}\n\n\t\tthis.#imageConfiguratorPopup.subscribe(ImageConfiguratorPopupEvents.completions, (e: BaseEvent) => {\n\t\t\tconst { style, format, engine } = e.getData();\n\n\t\t\tthis.#setPayload({\n\t\t\t\tstyle,\n\t\t\t\tformat,\n\t\t\t\tengine,\n\t\t\t});\n\n\t\t\tthis.completions();\n\t\t});\n\n\t\tthis.#imageConfiguratorPopup.subscribe(ImageConfiguratorPopupEvents.selectEngine, (event) => {\n\t\t\tconst engineCode = event.getData();\n\t\t\tconst oldSelectedEngineCode = this.#imageConfiguratorPopup.getImageConfiguration().engine;\n\t\t\tlet isRequestComplete = false;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (isRequestComplete === false)\n\t\t\t\t{\n\t\t\t\t\tthis.#imageConfiguratorPopup.showLoader();\n\t\t\t\t}\n\t\t\t}, 300);\n\n\t\t\tthis.#engine.getImageEngineParams(engineCode)\n\t\t\t\t.then((res) => {\n\t\t\t\t\tconst data = res.data;\n\n\t\t\t\t\tthis.#imageConfiguratorPopup.setFormats(data.formats);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('AI_COPILOT_IMAGE_FETCH_NEW_ENGINE_PARAMS_ERROR'),\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.#imageConfiguratorPopup.setSelectedEngine(oldSelectedEngineCode);\n\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tisRequestComplete = true;\n\t\t\t\t\tthis.#imageConfiguratorPopup.hideLoader();\n\t\t\t\t});\n\t\t});\n\n\t\tthis.#imageConfiguratorPopup.subscribe(ImageConfiguratorPopupEvents.back, () => {\n\t\t\tthis.#unsubscribeFromInputFieldEvents();\n\t\t\tthis.emit('back');\n\t\t});\n\t}\n\n\tgetAnalytics(): CopilotAnalytics\n\t{\n\t\tconst usedTextInput = this.#inputField.usedTextInput();\n\t\tconst usedVoiceRecord = this.#inputField.usedVoiceRecord();\n\n\t\tif (usedTextInput && usedVoiceRecord)\n\t\t{\n\t\t\tthis.#analytics.setContextTypeFromTextAndAudio();\n\t\t}\n\t\telse if (usedTextInput)\n\t\t{\n\t\t\tthis.#analytics.setContextTypeFromText();\n\t\t}\n\t\telse if (usedVoiceRecord)\n\t\t{\n\t\t\tthis.#analytics.setContextTypeFromAudio();\n\t\t}\n\n\t\tthis.#analytics.setCategoryImage();\n\t\tthis.#analytics.setTypeImageNew();\n\n\t\treturn this.#analytics;\n\t}\n\n\tstart(): void\n\t{\n\t\tthis.showImageConfigurator();\n\t\tthis.#subscribeToInputFieldEvents();\n\t}\n\n\tfinish(): void\n\t{\n\t\tthis.#currentGenerateRequestId = -1;\n\t\tthis.destroyAllMenus();\n\t\tthis.#unsubscribeFromInputFieldEvents();\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.#imageConfiguratorPopup.isShown();\n\t}\n\n\tgetOpenMenuPopup(): Popup | null\n\t{\n\t\treturn this.#errorMenu?.getPopup()\n\t\t\t\t|| this.#resultMenu?.getPopup()\n\t\t\t\t|| this.#imageConfiguratorPopup?.getPopup()\n\t\t\t\t|| null;\n\t}\n\n\thideAllMenus(): void\n\t{\n\t\tthis.#imageConfiguratorPopup?.hide();\n\t\tthis.#resultMenu?.hide();\n\t\tthis.#errorMenu?.hide();\n\t}\n\n\tdestroyAllMenus(): void\n\t{\n\t\tthis.#errorMenu?.close();\n\t\tthis.#resultMenu?.close();\n\t\tthis.#imageConfiguratorPopup?.destroy();\n\n\t\tthis.#errorMenu = null;\n\t\tthis.#resultMenu = null;\n\t\tthis.#imageConfiguratorPopup = null;\n\t}\n\n\tadjustMenusPosition(): void\n\t{\n\t\tthis.#imageConfiguratorPopup?.adjustPosition();\n\t\tthis.#resultMenu?.adjustPosition();\n\t\tthis.#errorMenu?.adjustPosition();\n\t}\n\n\tasync completions(): void\n\t{\n\t\tthis.destroyAllMenus();\n\t\tDom.removeClass(this.#copilotContainer, '--error');\n\t\tthis.#inputField.startGenerating();\n\n\t\ttry\n\t\t{\n\t\t\tconst id = Math.round(Math.random() * 10000);\n\n\t\t\tthis.#currentGenerateRequestId = id;\n\n\t\t\tconst res = await this.#engine.imageCompletions();\n\n\t\t\tif (this.#currentGenerateRequestId !== id)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.#resultImageUrl = JSON.parse(res.data.result)[0];\n\t\t\tthis.#inputField.finishGenerating();\n\t\t\tthis.#showResultMenu();\n\n\t\t\tthis.emit('completion-result', new BaseEvent({\n\t\t\t\tdata: {\n\t\t\t\t\timageUrl: this.#resultImageUrl,\n\t\t\t\t},\n\t\t\t}));\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.#inputField.finishGenerating();\n\t\t\tthis.#handleCompletionsError(error);\n\t\t}\n\t}\n\n\t#subscribeToInputFieldEvents(): void\n\t{\n\t\tthis.#inputField.subscribe(this.#copilotInputEvents.input, (event: BaseEvent) => {\n\t\t\tconst inputFieldValue = event.getData();\n\n\t\t\tif (inputFieldValue)\n\t\t\t{\n\t\t\t\tthis.#imageConfiguratorPopup?.enableSubmitButton();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#imageConfiguratorPopup?.disableSubmitButton();\n\t\t\t}\n\t\t});\n\t\tthis.#inputField.subscribe(this.#copilotInputEvents.cancelLoading, this.#inputFieldCancelLoadingEventHandler);\n\t\tthis.#inputField.subscribe(this.#copilotInputEvents.submit, this.#inputFieldSubmitEventHandler);\n\t\tthis.#inputField.subscribe(this.#copilotInputEvents.adjustHeight, this.#inputFieldAdjustHeightEventHandler);\n\t}\n\n\t#unsubscribeFromInputFieldEvents(): void\n\t{\n\t\tthis.#inputField.unsubscribe(this.#copilotInputEvents.cancelLoading, this.#inputFieldCancelLoadingEventHandler);\n\t\tthis.#inputField.unsubscribe(this.#copilotInputEvents.submit, this.#inputFieldSubmitEventHandler);\n\t\tthis.#inputField.unsubscribe(this.#copilotInputEvents.adjustHeight, this.#inputFieldAdjustHeightEventHandler);\n\t}\n\n\t#handleCompletionsError(error): void\n\t{\n\t\tconst firstError = error?.errors?.[0];\n\n\t\tif (firstError && firstError?.code === 'LIMIT_IS_EXCEEDED_BAAS')\n\t\t{\n\t\t\tthis.#inputField.disable();\n\t\t}\n\t\telse if (firstError && (\n\t\t\tfirstError.code === 'LIMIT_IS_EXCEEDED_MONTHLY'\n\t\t\t|| firstError.code === 'LIMIT_IS_EXCEEDED_DAILY'\n\t\t\t|| firstError.code === 'SERVICE_IS_NOT_AVAILABLE_BY_TARIFF'\n\t\t))\n\t\t{\n\t\t\tthis.emit('close');\n\t\t}\n\t\telse if (firstError)\n\t\t{\n\t\t\tDom.addClass(this.#copilotContainer, '--error');\n\t\t\tthis.#showErrorMenu();\n\n\t\t\tthis.#inputField.setErrors([{\n\t\t\t\tcode: firstError.code,\n\t\t\t\tmessage: firstError.message,\n\t\t\t}]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#inputField.setErrors([{\n\t\t\t\tcode: -1,\n\t\t\t\tmessage: Loc.getMessage('AI_COPILOT_IMAGE_GENERATION_ERROR'),\n\t\t\t}]);\n\t\t}\n\n\t\tAjaxErrorHandler.handleImageGenerateError({\n\t\t\tbaasOptions: {\n\t\t\t\tbindElement: this.#inputField.getContainer().querySelector('.ai__copilot_input-field-baas-point'),\n\t\t\t\tcontext: this.#engine.getContextId(),\n\t\t\t\tuseAngle: false,\n\t\t\t},\n\t\t\terrorCode: firstError?.code,\n\t\t});\n\t}\n\n\t#setPayload(options: { style: string, format: string, engine: string }): void\n\t{\n\t\tconst payload = new TextPayload({\n\t\t\tprompt: this.#inputField.getValue(),\n\t\t\tengineCode: options.engine,\n\t\t});\n\n\t\tpayload.setMarkers({\n\t\t\tstyle: options.style,\n\t\t\tformat: options.format,\n\t\t});\n\n\t\tthis.#engine.setPayload(payload);\n\n\t\tthis.#engine.setAnalyticParameters({\n\t\t\ttype: this.getAnalytics().getType(),\n\t\t\tc_sub_section: this.getAnalytics().getCSubSection(),\n\t\t\tc_section: this.getAnalytics().getCSection(),\n\t\t\tc_element: this.getAnalytics().getCElement(),\n\t\t});\n\n\t\tthis.getAnalytics()\n\t\t\t.setP1('prompt', options.style)\n\t\t\t.setP2('format', options.format);\n\t}\n\n\t#handleInputFieldSubmitEvent(): void\n\t{\n\t\tif (!this.#imageConfiguratorPopup?.isShown() || !this.#inputField.getValue()?.trim())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { style, format, engine } = this.#imageConfiguratorPopup.getImageConfiguration();\n\n\t\tthis.#setPayload({\n\t\t\tstyle,\n\t\t\tformat,\n\t\t\tengine,\n\t\t});\n\n\t\tthis.completions();\n\t}\n\n\t#handleInputFieldCancelLoadingEvent(): void\n\t{\n\t\tthis.#currentGenerateRequestId = -1;\n\t\tthis.#inputField.finishGenerating();\n\t\tthis.#inputField.focus();\n\t\tthis.showImageConfigurator();\n\t}\n\n\t#handleInputFieldAdjustHeightEvent(): void\n\t{\n\t\tthis.#resultMenu?.adjustPosition();\n\t\tthis.#errorMenu?.adjustPosition();\n\t\tthis.#imageConfiguratorPopup?.adjustPosition();\n\t}\n\n\t#showResultMenu(): void\n\t{\n\t\tif (!this.#resultMenu)\n\t\t{\n\t\t\tthis.#initResultMenu();\n\t\t}\n\n\t\tthis.#resultMenu.open();\n\t}\n\n\t#initResultMenu(): void\n\t{\n\t\tthis.#resultMenu = new this.#CopilotMenu({\n\t\t\tbindElement: this.#copilotContainer,\n\t\t\toffsetTop: 8,\n\t\t\toffsetLeft: 0,\n\t\t\titems: ImageConfiguratorResultMenuItems.getMenuItems({\n\t\t\t\tcopilotImageController: this,\n\t\t\t\tinputField: this.#inputField,\n\t\t\t\tuseInsertAboveAndUnderMenuItems: this.#useInsertAboveAndUnderTextMenuItems,\n\t\t\t}),\n\t\t\tkeyboardControlOptions: {\n\t\t\t\tclearHighlightAfterType: false,\n\t\t\t\tcanGoOutFromTop: false,\n\t\t\t\thighlightFirstItemAfterShow: true,\n\t\t\t},\n\t\t\tcacheable: false,\n\t\t});\n\n\t\tthis.#resultMenu.setBindElement(this.#copilotContainer, {\n\t\t\tleft: 0,\n\t\t\ttop: 8,\n\t\t});\n\t}\n\n\t#showErrorMenu(): void\n\t{\n\t\tif (!this.#errorMenu)\n\t\t{\n\t\t\tthis.#initErrorMenu();\n\t\t}\n\n\t\tthis.#errorMenu.setBindElement(this.#copilotContainer, {\n\t\t\ttop: 8,\n\t\t\tleft: 0,\n\t\t});\n\n\t\tthis.#errorMenu?.open();\n\t}\n\n\t#initErrorMenu(): void\n\t{\n\t\tthis.#errorMenu = new this.#CopilotMenu({\n\t\t\tbindElement: this.#copilotContainer,\n\t\t\toffsetTop: 8,\n\t\t\titems: ImageConfiguratorErrorMenuItems.getMenuItems({\n\t\t\t\tcopilotImageController: this,\n\t\t\t\tinputField: this.#inputField,\n\t\t\t\tcopilotContainer: this.#copilotContainer,\n\t\t\t}),\n\t\t\tkeyboardControlOptions: {\n\t\t\t\tcanGoOutFromTop: false,\n\t\t\t\thighlightFirstItemAfterShow: true,\n\t\t\t\tclearHighlightAfterType: false,\n\t\t\t},\n\t\t\tcacheable: false,\n\t\t});\n\t}\n}\n"],"names":["BaseCommand","constructor","options","copilotImageController","execute","Error","CancelImageCommand","copilotContainer","inputField","emit","destroyAllMenus","showImageConfigurator","clearErrors","clear","enable","Dom","removeClass","focus","getAnalytics","sendEventCancel","PlaceImageUnderCommand","PlaceImageAboveCommand","SaveImageCommand","BaseEvent","data","imageUrl","getResultImageUrl","sendEventSave","RepeatImageCompletion","completions","ImageConfiguratorErrorMenuItems","getMenuItems","code","text","Loc","getMessage","icon","notHighlight","command","ImageConfiguratorResultMenuItems","useAboveAndUnderTextMenuItems","useInsertAboveAndUnderMenuItems","IconSetMain","CHECK","IconSetActions","ARROW_TOP","ARROW_DOWN","LEFT_SEMICIRCULAR_ANTICLOCKWISE_ARROW_1","separator","CROSS_45","filter","item","Boolean","ImageConfiguratorStylesEvents","Object","freeze","select","ImageConfiguratorStyles","EventEmitter","styles","length","setEventNamespace","getSelectedStyle","render","Tag","requestAnimationFrame","styleListStyles","getComputedStyle","paddingTop","getPropertyValue","paddingBottom","padding","parseFloat","style","offsetHeight","expandListBtn","Event","bind","addClass","values","innerHTML","append","slice","map","styleItem","radioButton","name","preview","getParams","format","title","Editor","INCERT_IMAGE","getOptionsFromFormats","formats","engine","Main","ROBOT","getOptionsFromEngines","engines","value","ImageConfiguratorParams","handler","set","target","property","Reflect","option","find","currentOption","optionElem","querySelector","innerText","attr","Proxy","getCurrentValues","isContainsTarget","contains","getPopupWindow","getPopupContainer","setFormats","setSelectedEngine","engineCode","selectedEngine","selected","parameters","entries","parameterName","parameter","selectedOption","Icon","size","color","rightChevronIcon","Actions","CHEVRON_RIGHT","document","body","param","root","close","bindElement","Menu","show","imageConfiguratorParams","position","getPosition","top","left","right","cacheable","minWidth","items","events","onPopupAfterClose","isSelectedOption","id","html","onclick","isSelected","selectedIcon","parameterValue","e","menuItem","getMenuWindow","params","changeParamsHandler","ImageConfigurator","subscribe","event","getData","ImageConfiguratorPopupEvents","back","selectEngine","ImageConfiguratorPopup","popupId","String","Math","random","popupOffset","withoutBackBtn","imageConfiguratorOptions","getPopupId","getPopup","hide","destroy","isShown","adjustPosition","forceBindPosition","getImageConfiguration","disableSubmitButton","setDisabled","enableSubmitButton","showLoader","Loader","hideLoader","remove","Popup","width","content","setOffset","offsetTop","offsetLeft","backBtnIcon","CHEVRON_LEFT","backBtnIconElem","Button","Color","AI","round","noCaps","CopilotImageController","copilotInputEvents","copilotMenu","popupWithoutBackBtn","analytics","setCopilotContainer","isImageConfiguratorPopup","isErrorMenu","isResultMenu","init","res","getImageCopilotTooling","showMenu","usedTextInput","usedVoiceRecord","setContextTypeFromTextAndAudio","setContextTypeFromText","setContextTypeFromAudio","setCategoryImage","setTypeImageNew","start","finish","getOpenMenuPopup","hideAllMenus","adjustMenusPosition","startGenerating","imageCompletions","JSON","parse","result","finishGenerating","error","getValue","oldSelectedEngineCode","isRequestComplete","setTimeout","getImageEngineParams","then","catch","BX","UI","Notification","Center","notify","console","finally","input","inputFieldValue","cancelLoading","submit","adjustHeight","unsubscribe","firstError","errors","disable","setErrors","message","AjaxErrorHandler","handleImageGenerateError","baasOptions","getContainer","context","getContextId","useAngle","errorCode","payload","TextPayload","prompt","setMarkers","setPayload","setAnalyticParameters","type","getType","c_sub_section","getCSubSection","c_section","getCSection","c_element","getCElement","setP1","setP2","trim","open","keyboardControlOptions","clearHighlightAfterType","canGoOutFromTop","highlightFirstItemAfterShow","setBindElement"],"mappings":"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"}