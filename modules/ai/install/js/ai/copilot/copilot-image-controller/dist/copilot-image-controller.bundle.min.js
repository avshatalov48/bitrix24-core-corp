this.BX=this.BX||{};(function(e,s,a,l,t,i,o,r){"use strict";class n{constructor(e){this.copilotImageController=e.copilotImageController}execute(){throw new Error("You must implement this method!")}}var b=babelHelpers.classPrivateFieldLooseKey("inputField");var c=babelHelpers.classPrivateFieldLooseKey("copilotContainer");class d extends n{constructor(e){super(e);Object.defineProperty(this,b,{writable:true,value:void 0});Object.defineProperty(this,c,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,c)[c]=e.copilotContainer;babelHelpers.classPrivateFieldLooseBase(this,b)[b]=e.inputField}execute(){this.copilotImageController.emit("cancel");this.copilotImageController.destroyAllMenus();this.copilotImageController.showImageConfigurator();babelHelpers.classPrivateFieldLooseBase(this,b)[b].clearErrors();babelHelpers.classPrivateFieldLooseBase(this,b)[b].clear();babelHelpers.classPrivateFieldLooseBase(this,b)[b].enable();o.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,c)[c],"--error");babelHelpers.classPrivateFieldLooseBase(this,b)[b].focus();this.copilotImageController.getAnalytics().sendEventCancel()}}class p extends n{execute(){this.copilotImageController.emit("place-under")}}class v extends n{execute(){this.copilotImageController.emit("place-above")}}class u extends n{execute(){this.copilotImageController.emit("save",new t.BaseEvent({data:{imageUrl:this.copilotImageController.getResultImageUrl()}}));this.copilotImageController.getAnalytics().sendEventSave()}}class P extends n{execute(){this.copilotImageController.completions()}}class h{static getMenuItems(e){const s=e.copilotImageController;const a=e.inputField;const l=e.copilotContainer;return[{code:"repeat",text:o.Loc.getMessage("AI_COPILOT_COMMAND_REPEAT"),icon:"left-semicircular-anticlockwise-arrow-1",notHighlight:true,command:new P({copilotImageController:s})},{code:"cancel",text:o.Loc.getMessage("AI_COPILOT_COMMAND_CANCEL"),icon:"cross-45",notHighlight:true,command:new d({copilotImageController:s,inputField:a,copilotContainer:l})}]}}class L{static getMenuItems(e){const s=e==null?void 0:e.copilotImageController;const a=e.inputField;const l=e.useInsertAboveAndUnderMenuItems;return[{code:"save",text:o.Loc.getMessage("AI_COPILOT_IMAGE_RESULT_MENU_SAVE"),icon:r.Main.CHECK,notHighlight:true,command:new u({copilotImageController:s})},l?{code:"place_above",text:o.Loc.getMessage("AI_COPILOT_IMAGE_RESULT_MENU_PLACE_ABOVE_TEXT"),icon:r.Actions.ARROW_TOP,notHighlight:true,command:new v({copilotImageController:s})}:null,l?{code:"place_under",text:o.Loc.getMessage("AI_COPILOT_IMAGE_RESULT_MENU_PLACE_UNDER_TEXT"),icon:r.Actions.ARROW_DOWN,notHighlight:true,command:new p({copilotImageController:s})}:null,{code:"repeat",text:o.Loc.getMessage("AI_COPILOT_IMAGE_RESULT_MENU_REPEAT"),icon:r.Actions.LEFT_SEMICIRCULAR_ANTICLOCKWISE_ARROW_1,notHighlight:true,command:new P({copilotImageController:s})},{separator:true},{code:"cancel",text:o.Loc.getMessage("AI_COPILOT_IMAGE_RESULT_MENU_CANCEL"),icon:r.Actions.CROSS_45,notHighlight:true,command:new d({copilotImageController:s,inputField:a})}].filter((e=>Boolean(e)))}}let F=e=>e,H,g,B,m,f,y;const _=Object.freeze({select:"select"});var I=babelHelpers.classPrivateFieldLooseKey("mainStylesCount");var O=babelHelpers.classPrivateFieldLooseKey("currentMainStylesCount");var C=babelHelpers.classPrivateFieldLooseKey("selectedStyle");var E=babelHelpers.classPrivateFieldLooseKey("isExpanded");var A=babelHelpers.classPrivateFieldLooseKey("styleList");var w=babelHelpers.classPrivateFieldLooseKey("container");var T=babelHelpers.classPrivateFieldLooseKey("styles");var j=babelHelpers.classPrivateFieldLooseKey("renderHeader");var M=babelHelpers.classPrivateFieldLooseKey("isShowExpandBtn");var K=babelHelpers.classPrivateFieldLooseKey("renderExpandListBtn");var S=babelHelpers.classPrivateFieldLooseKey("renderStylesList");var x=babelHelpers.classPrivateFieldLooseKey("renderStyleItems");var R=babelHelpers.classPrivateFieldLooseKey("renderStyleItem");class $ extends t.EventEmitter{constructor(e){super(e);Object.defineProperty(this,R,{value:V});Object.defineProperty(this,x,{value:D});Object.defineProperty(this,S,{value:k});Object.defineProperty(this,K,{value:U});Object.defineProperty(this,M,{value:G});Object.defineProperty(this,j,{value:N});Object.defineProperty(this,I,{writable:true,value:0});Object.defineProperty(this,O,{writable:true,value:9});Object.defineProperty(this,C,{writable:true,value:null});Object.defineProperty(this,E,{writable:true,value:false});Object.defineProperty(this,A,{writable:true,value:null});Object.defineProperty(this,w,{writable:true,value:null});Object.defineProperty(this,T,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,T)[T]=e.styles;babelHelpers.classPrivateFieldLooseBase(this,I)[I]=babelHelpers.classPrivateFieldLooseBase(this,T)[T].length;babelHelpers.classPrivateFieldLooseBase(this,C)[C]=babelHelpers.classPrivateFieldLooseBase(this,T)[T][0].code;this.setEventNamespace("AI.Copilot.ImageConfiguratorStyles")}getSelectedStyle(){return babelHelpers.classPrivateFieldLooseBase(this,C)[C]}render(){babelHelpers.classPrivateFieldLooseBase(this,w)[w]=o.Tag.render(H||(H=F`
			<div class="ai__image-configurator-styles">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,j)[j](),babelHelpers.classPrivateFieldLooseBase(this,S)[S]());requestAnimationFrame((()=>{const e=getComputedStyle(babelHelpers.classPrivateFieldLooseBase(this,A)[A]);const s=e.getPropertyValue("padding-top");const a=e.getPropertyValue("padding-bottom");const l=parseFloat(s)+parseFloat(a);o.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,A)[A],"height",`${babelHelpers.classPrivateFieldLooseBase(this,A)[A].offsetHeight-l+4}px`)}));return babelHelpers.classPrivateFieldLooseBase(this,w)[w]}}function N(){const e=babelHelpers.classPrivateFieldLooseBase(this,M)[M]()?babelHelpers.classPrivateFieldLooseBase(this,K)[K]():null;return o.Tag.render(g||(g=F`
			<header class="ai__image-configurator-styles_header">
				<div
					class="ai__image-configurator-styles_title"
					title="${0}"
				>
					${0}
				</div>
				${0}
			</header>
		`),o.Loc.getMessage("AI_COPILOT_IMAGE_POPULAR_STYLES"),o.Loc.getMessage("AI_COPILOT_IMAGE_POPULAR_STYLES"),e)}function G(){return babelHelpers.classPrivateFieldLooseBase(this,I)[I]>babelHelpers.classPrivateFieldLooseBase(this,O)[O]}function U(){const e=o.Tag.render(B||(B=F`
			<div
				class="ai__image-configurator-styles_all-styles"
				title="${0}"
			>
				${0}
			</div>
		`),o.Loc.getMessage("AI_COPILOT_IMAGE_ALL_STYLES"),o.Loc.getMessage("AI_COPILOT_IMAGE_ALL_STYLES"));o.Event.bind(e,"click",(()=>{babelHelpers.classPrivateFieldLooseBase(this,E)[E]=!babelHelpers.classPrivateFieldLooseBase(this,E)[E];if(babelHelpers.classPrivateFieldLooseBase(this,E)[E]){o.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,A)[A],"--expanded");babelHelpers.classPrivateFieldLooseBase(this,O)[O]=Object.values(babelHelpers.classPrivateFieldLooseBase(this,T)[T]).length;babelHelpers.classPrivateFieldLooseBase(this,A)[A].innerHTML="";babelHelpers.classPrivateFieldLooseBase(this,A)[A].append(...babelHelpers.classPrivateFieldLooseBase(this,x)[x]())}else{o.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,A)[A],"--expanded")}}));return e}function k(){babelHelpers.classPrivateFieldLooseBase(this,A)[A]=o.Tag.render(m||(m=F`
			<div class="ai__image-configurator-styles_list">
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,x)[x]());return babelHelpers.classPrivateFieldLooseBase(this,A)[A]}function D(){return babelHelpers.classPrivateFieldLooseBase(this,T)[T].slice(0,babelHelpers.classPrivateFieldLooseBase(this,O)[O]).map((e=>babelHelpers.classPrivateFieldLooseBase(this,R)[R](e)))}function V(e){const s=o.Tag.render(f||(f=F`
			<input
				${0}
				id="${0}"
				name="ai__image-configurator-style"
				type="radio"
				class="ai__image-configurator-style_item-radio-btn"
			/>
		`),e.code===babelHelpers.classPrivateFieldLooseBase(this,C)[C]?"checked":"",e.code);const a=o.Tag.render(y||(y=F`
			<div
				title="${0}"
				class="ai__image-configurator-styles_item"
			>
				${0}
				<label
					for="${0}"
					class="ai__image-configurator-styles_item-inner"
					style="background-image: url(${0})"
				>
					<div class="ai__image-configurator-styles_item-title">${0}</div>
				</label>
			</div>
		`),e.name,s,e.code,e.preview,e.name);o.Event.bind(s,"input",(()=>{babelHelpers.classPrivateFieldLooseBase(this,C)[C]=e.code;this.emit(_.select,new t.BaseEvent({data:e.code}))}));return a}const X=e=>({format:{title:o.Loc.getMessage("AI_COPILOT_IMAGE_FORMAT_OPTION_TITLE"),icon:r.Editor.INCERT_IMAGE,options:W(e.formats)},engine:{title:o.Loc.getMessage("AI_COPILOT_IMAGE_ENGINE_OPTION_TITLE"),icon:r.Main.ROBOT,options:Y(e.engines)}});const W=e=>e.map((e=>({title:e.name,value:e.code})));const Y=e=>e.map((e=>({title:e.title,value:e.code})));let z=e=>e,q,J,Q;var Z=babelHelpers.classPrivateFieldLooseKey("container");var ee=babelHelpers.classPrivateFieldLooseKey("currentValues");var se=babelHelpers.classPrivateFieldLooseKey("openOptionsMenu");var ae=babelHelpers.classPrivateFieldLooseKey("params");var le=babelHelpers.classPrivateFieldLooseKey("getSelectedEngineCodeFromEngines");var te=babelHelpers.classPrivateFieldLooseKey("renderParams");var ie=babelHelpers.classPrivateFieldLooseKey("renderParam");var oe=babelHelpers.classPrivateFieldLooseKey("showOptionsMenu");var re=babelHelpers.classPrivateFieldLooseKey("getMenuOptions");var ne=babelHelpers.classPrivateFieldLooseKey("getMenuItemsFromOptions");var be=babelHelpers.classPrivateFieldLooseKey("getMenuItemHtml");var ce=babelHelpers.classPrivateFieldLooseKey("handleMenuItemClick");class de extends t.EventEmitter{constructor(e){super(e);Object.defineProperty(this,ce,{value:He});Object.defineProperty(this,be,{value:Fe});Object.defineProperty(this,ne,{value:Le});Object.defineProperty(this,re,{value:he});Object.defineProperty(this,oe,{value:Pe});Object.defineProperty(this,ie,{value:ue});Object.defineProperty(this,te,{value:ve});Object.defineProperty(this,le,{value:pe});Object.defineProperty(this,Z,{writable:true,value:void 0});Object.defineProperty(this,ee,{writable:true,value:void 0});Object.defineProperty(this,se,{writable:true,value:void 0});Object.defineProperty(this,ae,{writable:true,value:{}});babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]=X({formats:Object.values(e.formats),engines:e.engines});const s={format:babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].format.options[0].value,engine:babelHelpers.classPrivateFieldLooseBase(this,le)[le](e.engines)};const a={set:(e,s,a)=>{Reflect.set(e,s,a);if(babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]){const e=babelHelpers.classPrivateFieldLooseBase(this,ae)[ae][s].options.find((e=>e.value===a));const l=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].querySelector(`#ai__copilot-image-params-item-${s}`);if(l){l.innerText=e.title;o.Dom.attr(l,"title",e.title)}}return true}};babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]=new Proxy(s,a);this.setEventNamespace("AI.Copilot.ImageParams")}getCurrentValues(){return{...babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]}}isContainsTarget(e){var s,a,l,t;return((s=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z])==null?void 0:s.contains(e))||((a=babelHelpers.classPrivateFieldLooseBase(this,se)[se])==null?void 0:(l=a.getPopupWindow())==null?void 0:(t=l.getPopupContainer())==null?void 0:t.contains(e))}render(){babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]=o.Tag.render(q||(q=z`
			<div class="ai__copilot-image-params">
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,te)[te](babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]));return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]}}function pe(e){var s;const a=e.find((e=>e.selected));return a.code||(e==null?void 0:(s=e[0])==null?void 0:s.code)}function ve(e){return Object.entries(e).map((([e,s])=>babelHelpers.classPrivateFieldLooseBase(this,ie)[ie](s,e)))}function ue(e,s){const a=e.options.find((e=>e.value===babelHelpers.classPrivateFieldLooseBase(this,ee)[ee][s]));const l=new r.Icon({size:24,icon:e.icon,color:"#8E52EC"});const t=new r.Icon({size:16,icon:r.Actions.CHEVRON_RIGHT,color:getComputedStyle(document.body).getPropertyValue("--ui-color-base-50")});const i=o.Tag.render(J||(J=z`
			<div class="ai__copilot-image-params-item">
				<div class="ai__copilot-image-params-item_title">
					<div class="ai__copilot-image-params-item_title-icon">
						${0}
					</div>
					<div
						class="ai__copilot-image-params-item_title-text"
						title="${0}"
					>
						${0}
					</div>
				</div>
				<div ref="value" class="ai__copilot-image-params-item_value">
					<div
						id="ai__copilot-image-params-item-${0}"
						class="ai__copilot-image-params-item_value-text"
						title="${0}"
					>
						${0}
					</div>
					<div class="ai__copilot-image-params-item_value-arrow-icon">
						${0}
					</div>
				</div>
			</div>
		`),l.render(),e.title,e.title,s,a.title,a.title,t.render());o.Event.bind(i.root,"click",(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,se)[se]){babelHelpers.classPrivateFieldLooseBase(this,se)[se].close()}else{babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](i.value,e.options,s)}}));return i.root}function Pe(e,s,a){babelHelpers.classPrivateFieldLooseBase(this,se)[se]=new i.Menu({...babelHelpers.classPrivateFieldLooseBase(this,re)[re](e,s,a)});babelHelpers.classPrivateFieldLooseBase(this,se)[se].show()}function he(e,s,a){const l=o.Dom.getPosition(e);return{bindElement:{top:l.top-6,left:l.right+18},cacheable:false,minWidth:200,items:babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](s,a),events:{onPopupAfterClose:()=>{babelHelpers.classPrivateFieldLooseBase(this,se)[se]=null}}}}function Le(e,s){return e.map((e=>{const a=e.value===babelHelpers.classPrivateFieldLooseBase(this,ee)[ee][s];return{id:e.value,text:e.title,html:babelHelpers.classPrivateFieldLooseBase(this,be)[be](e.title,a),onclick:babelHelpers.classPrivateFieldLooseBase(this,ce)[ce](s,e.value)}}))}function Fe(e,s){const a=new r.Icon({size:18,icon:r.Main.CHECK,color:getComputedStyle(document.body).getPropertyValue("--ui-color-link-primary-base")});return o.Tag.render(Q||(Q=z`
			<div class="ai__copilot-image-params-popup-item">
				<span class="ai__copilot-image-params-popup-item_title">${0}</span>
				${0}
			</div>
		`),e,s?a.render():null)}function He(e,s){return(a,l)=>{babelHelpers.classPrivateFieldLooseBase(this,ee)[ee][e]=s;l.getMenuWindow().close();babelHelpers.classPrivateFieldLooseBase(this,se)[se]=null}}let ge=e=>e,Be;var me=babelHelpers.classPrivateFieldLooseKey("container");var fe=babelHelpers.classPrivateFieldLooseKey("imageConfiguratorStyles");var ye=babelHelpers.classPrivateFieldLooseKey("imageConfiguratorParams");var _e=babelHelpers.classPrivateFieldLooseKey("renderImageStyles");var Ie=babelHelpers.classPrivateFieldLooseKey("renderImageParams");class Oe extends t.EventEmitter{constructor(e){var s,a,l;super(e);Object.defineProperty(this,Ie,{value:Ee});Object.defineProperty(this,_e,{value:Ce});Object.defineProperty(this,me,{writable:true,value:void 0});Object.defineProperty(this,fe,{writable:true,value:void 0});Object.defineProperty(this,ye,{writable:true,value:void 0});this.setEventNamespace("AI.Copilot.ImageConfigurator");babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]=new $({styles:(s=e==null?void 0:e.styles)!=null?s:[]});babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]=new de({formats:(a=e==null?void 0:e.formats)!=null?a:[],engines:(l=e==null?void 0:e.engines)!=null?l:[]})}getParams(){return{style:babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].getSelectedStyle(),...babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getCurrentValues()}}isContainsTarget(e){var s,a;return((s=babelHelpers.classPrivateFieldLooseBase(this,me)[me])==null?void 0:s.contains(e))||((a=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye])==null?void 0:a.isContainsTarget(e))}render(){babelHelpers.classPrivateFieldLooseBase(this,me)[me]=o.Tag.render(Be||(Be=ge`
			<div class="ai__copilot-image-configurator">
				<div class="ai__copilot-image-configurator_styles">
					${0}
				</div>
				<div class="ai__copilot-image-configurator_params">
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,_e)[_e](),babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]());return babelHelpers.classPrivateFieldLooseBase(this,me)[me]}}function Ce(){return babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].render()}function Ee(){return babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].render()}let Ae=e=>e,we,Te;const je=Object.freeze({completions:"completions",back:"back"});var Me=babelHelpers.classPrivateFieldLooseKey("bindElement");var Ke=babelHelpers.classPrivateFieldLooseKey("popup");var Se=babelHelpers.classPrivateFieldLooseKey("popupOffset");var xe=babelHelpers.classPrivateFieldLooseKey("popupId");var Re=babelHelpers.classPrivateFieldLooseKey("imageConfigurator");var $e=babelHelpers.classPrivateFieldLooseKey("withoutBackBtn");var Ne=babelHelpers.classPrivateFieldLooseKey("submitButton");var Ge=babelHelpers.classPrivateFieldLooseKey("createPopup");var Ue=babelHelpers.classPrivateFieldLooseKey("renderPopupContent");var ke=babelHelpers.classPrivateFieldLooseKey("renderBackBtnIfNeeded");var De=babelHelpers.classPrivateFieldLooseKey("initSubmitButton");class Ve extends t.EventEmitter{constructor(e){super(e);Object.defineProperty(this,De,{value:ze});Object.defineProperty(this,ke,{value:Ye});Object.defineProperty(this,Ue,{value:We});Object.defineProperty(this,Ge,{value:Xe});Object.defineProperty(this,Me,{writable:true,value:null});Object.defineProperty(this,Ke,{writable:true,value:null});Object.defineProperty(this,Se,{writable:true,value:void 0});Object.defineProperty(this,xe,{writable:true,value:void 0});Object.defineProperty(this,Re,{writable:true,value:void 0});Object.defineProperty(this,$e,{writable:true,value:void 0});Object.defineProperty(this,Ne,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,xe)[xe]=e.popupId||String(Math.random());babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]=e.bindElement;babelHelpers.classPrivateFieldLooseBase(this,Se)[Se]=e.popupOffset;babelHelpers.classPrivateFieldLooseBase(this,$e)[$e]=e.withoutBackBtn===true;babelHelpers.classPrivateFieldLooseBase(this,Re)[Re]=new Oe({formats:e.imageConfiguratorOptions.formats,styles:e.imageConfiguratorOptions.styles,engines:e.imageConfiguratorOptions.engines});babelHelpers.classPrivateFieldLooseBase(this,De)[De]();this.setEventNamespace("AI.Copilot:ImagePopup")}getPopupId(){return babelHelpers.classPrivateFieldLooseBase(this,xe)[xe]}getPopup(){return babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]}show(){if(babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]===null){babelHelpers.classPrivateFieldLooseBase(this,Ge)[Ge]()}babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].show()}hide(){var e;(e=babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke])==null?void 0:e.close()}destroy(){var e;(e=babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke])==null?void 0:e.destroy();babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]=null}isShown(){return babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].isShown()}isContainsTarget(e){var s,a,l;return((s=babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke])==null?void 0:(a=s.getPopupContainer())==null?void 0:a.contains(e))||((l=babelHelpers.classPrivateFieldLooseBase(this,Re)[Re])==null?void 0:l.isContainsTarget(e))}adjustPosition(){var e;(e=babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke])==null?void 0:e.adjustPosition({forceBindPosition:true})}getImageConfiguration(){return babelHelpers.classPrivateFieldLooseBase(this,Re)[Re].getParams()}disableSubmitButton(){babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne].setDisabled(true)}enableSubmitButton(){babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne].setDisabled(false)}}function Xe(){var e,s;babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]=new i.Popup({id:babelHelpers.classPrivateFieldLooseBase(this,xe)[xe],bindElement:babelHelpers.classPrivateFieldLooseBase(this,Me)[Me],cacheable:true,width:278,padding:0,content:babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue]()});babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].setOffset({offsetTop:(e=babelHelpers.classPrivateFieldLooseBase(this,Se)[Se])==null?void 0:e.top,offsetLeft:(s=babelHelpers.classPrivateFieldLooseBase(this,Se)[Se])==null?void 0:s.left})}function We(){return o.Tag.render(we||(we=Ae`
			<div class="ai__copilot-image-configurator-popup-content">
				<header class="ai__copilot-image-configurator-popup-content_header">
					${0}
					<div class="ai__copilot-image-configurator-popup-content_title">
						${0}
					</div>
				</header>
				<div class="ai__copilot-image-configurator-popup-content_params">
					${0}
				</div>
				<div class="ai__copilot-image-configurator-popup-content_footer">
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](),o.Loc.getMessage("AI_COPILOT_IMAGE_POPUP_TITLE"),babelHelpers.classPrivateFieldLooseBase(this,Re)[Re].render(),babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne].render())}function Ye(){if(babelHelpers.classPrivateFieldLooseBase(this,$e)[$e]){return null}const e=new r.Icon({size:24,color:getComputedStyle(document.body).getPropertyValue("--ui-color-base-90"),icon:r.Actions.CHEVRON_LEFT});const s=e.render();o.Event.bind(s,"click",(()=>{this.emit(je.back,new t.BaseEvent)}));return o.Tag.render(Te||(Te=Ae`
			<div class="ai__copilot-image-configurator-popup-content_back-btn">
				${0}
			</div>
		`),s)}function ze(){babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne]=new l.Button({color:l.Button.Color.AI,text:o.Loc.getMessage("AI_COPILOT_IMAGE_POPUP_GENERATE_BTN"),round:true,noCaps:true,onclick:()=>{this.emit(je.completions,new t.BaseEvent({data:babelHelpers.classPrivateFieldLooseBase(this,Re)[Re].getParams()}))}})}var qe=babelHelpers.classPrivateFieldLooseKey("analytics");var Je=babelHelpers.classPrivateFieldLooseKey("copilotContainer");var Qe=babelHelpers.classPrivateFieldLooseKey("inputField");var Ze=babelHelpers.classPrivateFieldLooseKey("engine");var es=babelHelpers.classPrivateFieldLooseKey("imageConfiguratorPopup");var ss=babelHelpers.classPrivateFieldLooseKey("errorMenu");var as=babelHelpers.classPrivateFieldLooseKey("resultMenu");var ls=babelHelpers.classPrivateFieldLooseKey("resultImageUrl");var ts=babelHelpers.classPrivateFieldLooseKey("copilotInputEvents");var is=babelHelpers.classPrivateFieldLooseKey("CopilotMenu");var os=babelHelpers.classPrivateFieldLooseKey("popupWithoutBackBtn");var rs=babelHelpers.classPrivateFieldLooseKey("currentGenerateRequestId");var ns=babelHelpers.classPrivateFieldLooseKey("useInsertAboveAndUnderTextMenuItems");var bs=babelHelpers.classPrivateFieldLooseKey("formats");var cs=babelHelpers.classPrivateFieldLooseKey("styles");var ds=babelHelpers.classPrivateFieldLooseKey("engines");var ps=babelHelpers.classPrivateFieldLooseKey("inputFieldCancelLoadingEventHandler");var vs=babelHelpers.classPrivateFieldLooseKey("inputFieldSubmitEventHandler");var us=babelHelpers.classPrivateFieldLooseKey("inputFieldAdjustHeightEventHandler");var Ps=babelHelpers.classPrivateFieldLooseKey("initImageConfiguratorPopup");var hs=babelHelpers.classPrivateFieldLooseKey("subscribeToInputFieldEvents");var Ls=babelHelpers.classPrivateFieldLooseKey("unsubscribeFromInputFieldEvents");var Fs=babelHelpers.classPrivateFieldLooseKey("handleCompletionsError");var Hs=babelHelpers.classPrivateFieldLooseKey("setPayload");var gs=babelHelpers.classPrivateFieldLooseKey("handleInputFieldSubmitEvent");var Bs=babelHelpers.classPrivateFieldLooseKey("handleInputFieldCancelLoadingEvent");var ms=babelHelpers.classPrivateFieldLooseKey("handleInputFieldAdjustHeightEvent");var fs=babelHelpers.classPrivateFieldLooseKey("showResultMenu");var ys=babelHelpers.classPrivateFieldLooseKey("initResultMenu");var _s=babelHelpers.classPrivateFieldLooseKey("showErrorMenu");var Is=babelHelpers.classPrivateFieldLooseKey("initErrorMenu");class Os extends t.EventEmitter{constructor(e){super(e);Object.defineProperty(this,Is,{value:$s});Object.defineProperty(this,_s,{value:Rs});Object.defineProperty(this,ys,{value:xs});Object.defineProperty(this,fs,{value:Ss});Object.defineProperty(this,ms,{value:Ks});Object.defineProperty(this,Bs,{value:Ms});Object.defineProperty(this,gs,{value:js});Object.defineProperty(this,Hs,{value:Ts});Object.defineProperty(this,Fs,{value:ws});Object.defineProperty(this,Ls,{value:As});Object.defineProperty(this,hs,{value:Es});Object.defineProperty(this,Ps,{value:Cs});Object.defineProperty(this,qe,{writable:true,value:void 0});Object.defineProperty(this,Je,{writable:true,value:void 0});Object.defineProperty(this,Qe,{writable:true,value:void 0});Object.defineProperty(this,Ze,{writable:true,value:void 0});Object.defineProperty(this,es,{writable:true,value:void 0});Object.defineProperty(this,ss,{writable:true,value:void 0});Object.defineProperty(this,as,{writable:true,value:void 0});Object.defineProperty(this,ls,{writable:true,value:void 0});Object.defineProperty(this,ts,{writable:true,value:void 0});Object.defineProperty(this,is,{writable:true,value:void 0});Object.defineProperty(this,os,{writable:true,value:void 0});Object.defineProperty(this,rs,{writable:true,value:void 0});Object.defineProperty(this,ns,{writable:true,value:void 0});Object.defineProperty(this,bs,{writable:true,value:[]});Object.defineProperty(this,cs,{writable:true,value:[]});Object.defineProperty(this,ds,{writable:true,value:[]});Object.defineProperty(this,ps,{writable:true,value:void 0});Object.defineProperty(this,vs,{writable:true,value:void 0});Object.defineProperty(this,us,{writable:true,value:void 0});this.setEventNamespace("AI.CopilotImage");babelHelpers.classPrivateFieldLooseBase(this,ls)[ls]=null;babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe]=e.inputField;babelHelpers.classPrivateFieldLooseBase(this,Je)[Je]=e.copilotContainer;babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze]=e.engine;babelHelpers.classPrivateFieldLooseBase(this,ts)[ts]=e.copilotInputEvents;babelHelpers.classPrivateFieldLooseBase(this,is)[is]=e.copilotMenu;babelHelpers.classPrivateFieldLooseBase(this,os)[os]=e.popupWithoutBackBtn===true;babelHelpers.classPrivateFieldLooseBase(this,ns)[ns]=e.useInsertAboveAndUnderMenuItems;babelHelpers.classPrivateFieldLooseBase(this,qe)[qe]=e.analytics;babelHelpers.classPrivateFieldLooseBase(this,vs)[vs]=babelHelpers.classPrivateFieldLooseBase(this,gs)[gs].bind(this);babelHelpers.classPrivateFieldLooseBase(this,ps)[ps]=babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs].bind(this);babelHelpers.classPrivateFieldLooseBase(this,us)[us]=babelHelpers.classPrivateFieldLooseBase(this,ms)[ms].bind(this)}setCopilotContainer(e){babelHelpers.classPrivateFieldLooseBase(this,Je)[Je]=e}getResultImageUrl(){return babelHelpers.classPrivateFieldLooseBase(this,ls)[ls]}isContainsTarget(e){var s,a,l;const t=(s=babelHelpers.classPrivateFieldLooseBase(this,es)[es])==null?void 0:s.isContainsTarget(e);const i=(a=babelHelpers.classPrivateFieldLooseBase(this,ss)[ss])==null?void 0:a.contains(e);const o=(l=babelHelpers.classPrivateFieldLooseBase(this,as)[as])==null?void 0:l.contains(e);return t||i||o}async init(){const e=await babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze].getImageCopilotTooling();babelHelpers.classPrivateFieldLooseBase(this,bs)[bs]=e.data.params.formats;babelHelpers.classPrivateFieldLooseBase(this,ds)[ds]=e.data.engines;babelHelpers.classPrivateFieldLooseBase(this,cs)[cs]=e.data.params.styles}showImageConfigurator(){if(!babelHelpers.classPrivateFieldLooseBase(this,es)[es]){babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps]()}babelHelpers.classPrivateFieldLooseBase(this,es)[es].show()}showMenu(){var e,s,a;(e=babelHelpers.classPrivateFieldLooseBase(this,as)[as])==null?void 0:e.show();(s=babelHelpers.classPrivateFieldLooseBase(this,ss)[ss])==null?void 0:s.show();(a=babelHelpers.classPrivateFieldLooseBase(this,es)[es])==null?void 0:a.show()}getAnalytics(){const e=babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].usedTextInput();const s=babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].usedVoiceRecord();if(e&&s){babelHelpers.classPrivateFieldLooseBase(this,qe)[qe].setContextTypeFromTextAndAudio()}else if(e){babelHelpers.classPrivateFieldLooseBase(this,qe)[qe].setContextTypeFromText()}else if(s){babelHelpers.classPrivateFieldLooseBase(this,qe)[qe].setContextTypeFromAudio()}babelHelpers.classPrivateFieldLooseBase(this,qe)[qe].setCategoryImage();babelHelpers.classPrivateFieldLooseBase(this,qe)[qe].setTypeImageNew();return babelHelpers.classPrivateFieldLooseBase(this,qe)[qe]}start(){this.showImageConfigurator();babelHelpers.classPrivateFieldLooseBase(this,hs)[hs]()}finish(){babelHelpers.classPrivateFieldLooseBase(this,rs)[rs]=-1;this.destroyAllMenus();babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls]()}isShown(){return babelHelpers.classPrivateFieldLooseBase(this,es)[es].isShown()}getOpenMenuPopup(){var e,s,a;return((e=babelHelpers.classPrivateFieldLooseBase(this,ss)[ss])==null?void 0:e.getPopup())||((s=babelHelpers.classPrivateFieldLooseBase(this,as)[as])==null?void 0:s.getPopup())||((a=babelHelpers.classPrivateFieldLooseBase(this,es)[es])==null?void 0:a.getPopup())||null}hideAllMenus(){var e,s,a;(e=babelHelpers.classPrivateFieldLooseBase(this,es)[es])==null?void 0:e.hide();(s=babelHelpers.classPrivateFieldLooseBase(this,as)[as])==null?void 0:s.hide();(a=babelHelpers.classPrivateFieldLooseBase(this,ss)[ss])==null?void 0:a.hide()}destroyAllMenus(){var e,s,a;(e=babelHelpers.classPrivateFieldLooseBase(this,ss)[ss])==null?void 0:e.close();(s=babelHelpers.classPrivateFieldLooseBase(this,as)[as])==null?void 0:s.close();(a=babelHelpers.classPrivateFieldLooseBase(this,es)[es])==null?void 0:a.destroy();babelHelpers.classPrivateFieldLooseBase(this,ss)[ss]=null;babelHelpers.classPrivateFieldLooseBase(this,as)[as]=null;babelHelpers.classPrivateFieldLooseBase(this,es)[es]=null}adjustMenusPosition(){var e,s,a;(e=babelHelpers.classPrivateFieldLooseBase(this,es)[es])==null?void 0:e.adjustPosition();(s=babelHelpers.classPrivateFieldLooseBase(this,as)[as])==null?void 0:s.adjustPosition();(a=babelHelpers.classPrivateFieldLooseBase(this,ss)[ss])==null?void 0:a.adjustPosition()}async completions(){this.destroyAllMenus();o.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,Je)[Je],"--error");babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].startGenerating();try{const e=Math.round(Math.random()*1e4);babelHelpers.classPrivateFieldLooseBase(this,rs)[rs]=e;const s=await babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze].imageCompletions();if(babelHelpers.classPrivateFieldLooseBase(this,rs)[rs]!==e){return}babelHelpers.classPrivateFieldLooseBase(this,ls)[ls]=JSON.parse(s.data.result)[0];babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].finishGenerating();babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]();this.emit("completion-result",new t.BaseEvent({data:{imageUrl:babelHelpers.classPrivateFieldLooseBase(this,ls)[ls]}}))}catch(e){babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].finishGenerating();babelHelpers.classPrivateFieldLooseBase(this,Fs)[Fs](e)}}}function Cs(){babelHelpers.classPrivateFieldLooseBase(this,es)[es]=new Ve({bindElement:babelHelpers.classPrivateFieldLooseBase(this,Je)[Je],popupId:"ai-image-configuration-popup",popupOffset:{top:8},withoutBackBtn:babelHelpers.classPrivateFieldLooseBase(this,os)[os],imageConfiguratorOptions:{styles:babelHelpers.classPrivateFieldLooseBase(this,cs)[cs],formats:babelHelpers.classPrivateFieldLooseBase(this,bs)[bs],engines:babelHelpers.classPrivateFieldLooseBase(this,ds)[ds]}});if(!babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].getValue()){babelHelpers.classPrivateFieldLooseBase(this,es)[es].disableSubmitButton()}babelHelpers.classPrivateFieldLooseBase(this,es)[es].subscribe(je.completions,(e=>{const{style:s,format:a,engine:l}=e.getData();babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs]({style:s,format:a,engine:l});this.completions()}));babelHelpers.classPrivateFieldLooseBase(this,es)[es].subscribe(je.back,(()=>{babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls]();this.emit("back")}))}function Es(){babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].subscribe(babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].input,(e=>{const s=e.getData();if(s){var a;(a=babelHelpers.classPrivateFieldLooseBase(this,es)[es])==null?void 0:a.enableSubmitButton()}else{var l;(l=babelHelpers.classPrivateFieldLooseBase(this,es)[es])==null?void 0:l.disableSubmitButton()}}));babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].subscribe(babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].cancelLoading,babelHelpers.classPrivateFieldLooseBase(this,ps)[ps]);babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].subscribe(babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].submit,babelHelpers.classPrivateFieldLooseBase(this,vs)[vs]);babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].subscribe(babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].adjustHeight,babelHelpers.classPrivateFieldLooseBase(this,us)[us])}function As(){babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].unsubscribe(babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].cancelLoading,babelHelpers.classPrivateFieldLooseBase(this,ps)[ps]);babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].unsubscribe(babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].submit,babelHelpers.classPrivateFieldLooseBase(this,vs)[vs]);babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].unsubscribe(babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].adjustHeight,babelHelpers.classPrivateFieldLooseBase(this,us)[us])}function ws(e){var s;const l=e==null?void 0:(s=e.errors)==null?void 0:s[0];if(l&&(l==null?void 0:l.code)==="LIMIT_IS_EXCEEDED_BAAS"){babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].disable()}else if(l&&(l.code==="LIMIT_IS_EXCEEDED_MONTHLY"||l.code==="LIMIT_IS_EXCEEDED_DAILY"||l.code==="SERVICE_IS_NOT_AVAILABLE_BY_TARIFF")){this.emit("close")}else if(l){o.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,Je)[Je],"--error");babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]();babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].setErrors([{code:l.code,message:l.message}])}else{babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].setErrors([{code:-1,message:o.Loc.getMessage("AI_COPILOT_IMAGE_GENERATION_ERROR")}])}a.AjaxErrorHandler.handleImageGenerateError({baasOptions:{bindElement:babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].getContainer().querySelector(".ai__copilot_input-field-baas-point"),context:babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze].getContextId(),useAngle:false},errorCode:l==null?void 0:l.code})}function Ts(e){const a=new s.Text({prompt:babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].getValue(),engineCode:e.engine});a.setMarkers({style:e.style,format:e.format});babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze].setPayload(a);babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze].setAnalyticParameters({type:this.getAnalytics().getType(),c_sub_section:this.getAnalytics().getCSubSection(),c_section:this.getAnalytics().getCSection(),c_element:this.getAnalytics().getCElement()});this.getAnalytics().setP1("prompt",e.style).setP2("format",e.format)}function js(){var e,s;if(!((e=babelHelpers.classPrivateFieldLooseBase(this,es)[es])!=null&&e.isShown())||!((s=babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].getValue())!=null&&s.trim())){return}const{style:a,format:l,engine:t}=babelHelpers.classPrivateFieldLooseBase(this,es)[es].getImageConfiguration();babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs]({style:a,format:l,engine:t});this.completions()}function Ms(){babelHelpers.classPrivateFieldLooseBase(this,rs)[rs]=-1;babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].finishGenerating();babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].focus();this.showImageConfigurator()}function Ks(){var e,s,a;(e=babelHelpers.classPrivateFieldLooseBase(this,as)[as])==null?void 0:e.adjustPosition();(s=babelHelpers.classPrivateFieldLooseBase(this,ss)[ss])==null?void 0:s.adjustPosition();(a=babelHelpers.classPrivateFieldLooseBase(this,es)[es])==null?void 0:a.adjustPosition()}function Ss(){if(!babelHelpers.classPrivateFieldLooseBase(this,as)[as]){babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]()}babelHelpers.classPrivateFieldLooseBase(this,as)[as].open()}function xs(){babelHelpers.classPrivateFieldLooseBase(this,as)[as]=new(babelHelpers.classPrivateFieldLooseBase(this,is)[is])({bindElement:babelHelpers.classPrivateFieldLooseBase(this,Je)[Je],offsetTop:8,offsetLeft:0,items:L.getMenuItems({copilotImageController:this,inputField:babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe],useInsertAboveAndUnderMenuItems:babelHelpers.classPrivateFieldLooseBase(this,ns)[ns]}),keyboardControlOptions:{clearHighlightAfterType:false,canGoOutFromTop:false,highlightFirstItemAfterShow:true},cacheable:false});babelHelpers.classPrivateFieldLooseBase(this,as)[as].setBindElement(babelHelpers.classPrivateFieldLooseBase(this,Je)[Je],{left:0,top:8})}function Rs(){var e;if(!babelHelpers.classPrivateFieldLooseBase(this,ss)[ss]){babelHelpers.classPrivateFieldLooseBase(this,Is)[Is]()}babelHelpers.classPrivateFieldLooseBase(this,ss)[ss].setBindElement(babelHelpers.classPrivateFieldLooseBase(this,Je)[Je],{top:8,left:0});(e=babelHelpers.classPrivateFieldLooseBase(this,ss)[ss])==null?void 0:e.open()}function $s(){babelHelpers.classPrivateFieldLooseBase(this,ss)[ss]=new(babelHelpers.classPrivateFieldLooseBase(this,is)[is])({bindElement:babelHelpers.classPrivateFieldLooseBase(this,Je)[Je],offsetTop:8,items:h.getMenuItems({copilotImageController:this,inputField:babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe],copilotContainer:babelHelpers.classPrivateFieldLooseBase(this,Je)[Je]}),keyboardControlOptions:{canGoOutFromTop:false,highlightFirstItemAfterShow:true,clearHighlightAfterType:false},cacheable:false})}e.CopilotImageController=Os})(this.BX.AI=this.BX.AI||{},BX.AI,BX.AI,BX.UI,BX.Event,BX.Main,BX,BX.UI.IconSet);
//# sourceMappingURL=copilot-image-controller.bundle.map.js