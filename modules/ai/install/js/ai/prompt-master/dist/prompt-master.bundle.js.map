{"version":3,"file":"prompt-master.bundle.js","sources":["../src/components/prompt-master-prompt-types.js","../src/components/prompt-master-progress.js","../src/components/prompt-master-alert-message.js","../src/components/prompt-master-step.js","../src/helpers/content-editable-cursor.js","../src/components/prompt-master-editor.js","../src/components/prompt-master-editor-step.js","../src/helpers/available-prompt-icons.js","../src/components/prompt-master-icon-selector.js","../src/directives/prompt-master-hover-hint.js","../src/components/prompt-master-user-selector.js","../src/components/prompt-master-categories-selector.js","../src/components/prompt-master-hint.js","../src/components/prompt-master-access-step.js","../src/components/prompt-master-btn.js","../src/components/prompt-master-back-btn.js","../src/components/prompt-master-save-error-screen.js","../src/components/prompt-master.js","../src/prompt-master.js","../src/prompt-master-popup.js"],"sourcesContent":["import { Loc } from 'main.core';\n\nimport { Hint } from 'ui.vue3.components.hint';\nimport { hint } from 'ui.vue3.directives.hint';\n\nimport '../css/prompt-master-prompt-types.css';\n\nexport const promptTypes: PromptTypesInfo = [\n\t{\n\t\tid: 'DEFAULT',\n\t\ttitle: Loc.getMessage('PROMPT_MASTER_TYPE_FIRST_TITLE'),\n\t\tdescription: Loc.getMessage('PROMPT_MASTER_TYPE_FIRST_DESCRIPTION'),\n\t\texample: Loc.getMessage('PROMPT_MASTER_TYPE_FIRST_EXAMPLE'),\n\t\tactive: false,\n\t\ticon: 'stars',\n\t},\n\t{\n\t\tid: 'SIMPLE_TEMPLATE',\n\t\ttitle: Loc.getMessage('PROMPT_MASTER_TYPE_SECOND_TITLE'),\n\t\tdescription: Loc.getMessage('PROMPT_MASTER_TYPE_SECOND_DESCRIPTION'),\n\t\texample: Loc.getMessage('PROMPT_MASTER_TYPE_SECOND_EXAMPLE', {\n\t\t\t'#accent#': '<strong>',\n\t\t\t'#/accent#': '</strong>',\n\t\t}),\n\t\tactive: false,\n\t\ticon: 'stars-question',\n\t},\n];\n\ntype PromptTypesInfo = PromptTypeInfo[];\n\ntype PromptTypeInfo = {\n\tid: string;\n\ttitle: string;\n\tdescription: string;\n\texample: string;\n\tactive: boolean;\n\ticon: string;\n};\n\nexport const PromptMasterPromptTypes = {\n\tcomponents: {\n\t\tHint,\n\t},\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\tactivePromptType: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\tpromptTypes(): PromptTypesInfo {\n\t\t\treturn promptTypes.map((type) => {\n\t\t\t\tconst isActive = type.id === this.activePromptType;\n\n\t\t\t\treturn {\n\t\t\t\t\t...type,\n\t\t\t\t\tactive: isActive,\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tgetPromptTypeClass(isActive: boolean): Object {\n\t\t\treturn {\n\t\t\t\t'ai__prompt-master_prompt-type': true,\n\t\t\t\t'--active': isActive,\n\t\t\t};\n\t\t},\n\t\tgetPromptTypeIconClassname(iconName: string): string[] {\n\t\t\treturn ['ai__prompt-master_prompt-type_icon', `--icon-${iconName}`];\n\t\t},\n\t\tselectPromptType(type: string): void {\n\t\t\tthis.$emit('select', type);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__prompt-master_prompt-types-step\">\n\t\t\t<ul class=\"ai__prompt-master_prompt-types\">\n\t\t\t\t<li\n\t\t\t\t\tv-for=\"promptType in promptTypes\"\n\t\t\t\t\tclass=\"ai__prompt-master_prompt-types_type\"\n\t\t\t\t\t@click=\"selectPromptType(promptType.id)\"\n\t\t\t\t>\n\t\t\t\t\t<div :class=\"getPromptTypeClass(promptType.active)\">\n\t\t\t\t\t\t<div :class=\"getPromptTypeIconClassname(promptType.icon)\"></div>\n\t\t\t\t\t\t<div class=\"ai__prompt-master_prompt-type_title\">\n\t\t\t\t\t\t\t{{ promptType.title }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p class=\"ai__prompt-master_prompt-type_description\">\n\t\t\t\t\t\t\t{{ promptType.description }}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<i class=\"ai__prompt-master_prompt-type_example\" v-html=\"promptType.example\"></i>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t`,\n};\n","import '../css/prompt-master-progress.css';\n\nexport const PromptMasterProgress = {\n\tprops: {\n\t\tstepsCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tdefault: 1,\n\t\t},\n\t\tcurrentStep: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tdefault: 1,\n\t\t},\n\t},\n\tmethods: {\n\t\tgetProgressStepClassname(isPassedStep: boolean): Object {\n\t\t\treturn {\n\t\t\t\t'ai__prompt-master-progress_step': true,\n\t\t\t\t'--passed': isPassedStep,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__prompt-master-progress\">\n\t\t\t<div\n\t\t\t\tv-for=\"(_, step) in stepsCount\"\n\t\t\t\t:class=\"getProgressStepClassname(step < currentStep)\"\n\t\t\t>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Alert, AlertSize, AlertColor, AlertIcon } from 'ui.alerts';\n\nexport const PromptMasterAlertMessage = {\n\tprops: {\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\talertHtml(): String {\n\t\t\tconst alert = new Alert({\n\t\t\t\ticon: AlertIcon.INFO,\n\t\t\t\tcolor: AlertColor.WARNING,\n\t\t\t\tsize: AlertSize.XS,\n\t\t\t\ttext: this.text,\n\t\t\t});\n\n\t\t\treturn alert.render().outerHTML;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-html=\"alertHtml\"></div>\n\t`,\n};\n","import '../css/prompt-master-step.css';\nimport { PromptMasterProgress } from './prompt-master-progress';\nimport { PromptMasterAlertMessage } from './prompt-master-alert-message';\n\nexport const PromptMasterStep = {\n\tcomponents: {\n\t\tPromptMasterProgress,\n\t\tPromptMasterAlertMessage,\n\t},\n\tprops: {\n\t\tsuptitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tdefault: '',\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tdefault: '',\n\t\t},\n\t\tstepIndex: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tdefault: 0,\n\t\t},\n\t\tstepsCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tdefault: 3,\n\t\t},\n\t\talertMessage: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__prompt-master-step\">\n\t\t\t<header class=\"ai__prompt-master-step_header\">\n\t\t\t\t<span class=\"ai__prompt-master-step_suptitle\">{{ suptitle }}</span>\n\t\t\t\t<h4 class=\"ai__prompt-master-step_title\">{{ title }}</h4>\n\t\t\t\t<div class=\"ai__prompt-master-step__progress\">\n\t\t\t\t\t<PromptMasterProgress :current-step=\"stepIndex\" :steps-count=\"stepsCount\" />\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"alertMessage\" class=\"ai__prompt-master-step__alert-message\">\n\t\t\t\t\t<PromptMasterAlertMessage :text=\"alertMessage\"></PromptMasterAlertMessage>\n\t\t\t\t</div>\n\t\t\t</header>\n\t\t\t<main class=\"ai__prompt-master-step_content\">\n\t\t\t\t<slot name=\"content\"></slot>\n\t\t\t</main>\n\t\t\t<footer\n\t\t\t\tclass=\"ai__prompt-master-step_footer\"\n\t\t\t>\n\t\t\t\t<slot name=\"footer\"></slot>\n\t\t\t</footer>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\n\n// eslint-disable-next-line sonarjs/cognitive-complexity\nconst createRangeWithPosition = (node: Node, targetPosition: number): Range => {\n\tconst range = document.createRange();\n\trange.selectNode(node);\n\trange.setStart(node, 0);\n\n\tlet pos = 0;\n\tconst stack = [node];\n\twhile (stack.length > 0)\n\t{\n\t\tconst current = stack.pop();\n\n\t\tif (current.nodeType === Node.TEXT_NODE)\n\t\t{\n\t\t\tconst len = current.textContent.length;\n\t\t\tif (pos + len >= targetPosition)\n\t\t\t{\n\t\t\t\trange.setStart(current, targetPosition - pos);\n\t\t\t\trange.setEnd(current, targetPosition - pos);\n\n\t\t\t\treturn range;\n\t\t\t}\n\n\t\t\tpos += len;\n\t\t}\n\t\telse if (current.nodeType === Node.ELEMENT_NODE && current.childNodes.length === 0)\n\t\t{\n\t\t\tif (pos === targetPosition)\n\t\t\t{\n\t\t\t\trange.setStart(current, 0);\n\t\t\t\trange.setEnd(current, 0);\n\n\t\t\t\treturn range;\n\t\t\t}\n\t\t}\n\t\telse if (current.childNodes && current.childNodes.length > 0)\n\t\t{\n\t\t\tif (current.nodeName === 'DIV' && current !== node && current !== node.childNodes[0])\n\t\t\t{\n\t\t\t\tpos += 1;\n\t\t\t}\n\n\t\t\tfor (let i = current.childNodes.length - 1; i >= 0; i--)\n\t\t\t{\n\t\t\t\tstack.push(current.childNodes[i]);\n\t\t\t}\n\t\t}\n\t}\n\n\trange.setStart(node, node.childNodes.length);\n\trange.setEnd(node, node.childNodes.length);\n\n\treturn range;\n};\n\nexport const setCursorPosition = (node: Node, targetPosition: number): void => {\n\tconst range = createRangeWithPosition(node, targetPosition);\n\tconst selection = window.getSelection();\n\tselection.removeAllRanges();\n\tselection.addRange(range);\n};\n\nexport const getCursorPosition = (node: HTMLElement): number => {\n\tconst selection = window.getSelection();\n\tif (!selection.rangeCount)\n\t{\n\t\treturn 0;\n\t}\n\n\tconst range = selection.getRangeAt(0);\n\tconst clonedRange = range.cloneRange();\n\tclonedRange.selectNodeContents(node);\n\tclonedRange.setEnd(range.endContainer, range.endOffset);\n\n\tlet cursorPosition = clonedRange.toString().length;\n\n\tconst div = document.createElement('div');\n\tDom.append(clonedRange.cloneContents(), div);\n\n\tconst lineBreakElements = div.querySelectorAll('div');\n\n\tcursorPosition += lineBreakElements.length;\n\n\tif (node.firstChild?.nodeName === 'DIV' && node.childNodes[1]?.nodeType !== Node.TEXT_NODE)\n\t{\n\t\tcursorPosition -= 1;\n\t}\n\n\treturn cursorPosition;\n};\n","import '../css/prompt-master-editor.css';\nimport { bindOnce, Type, Text, Browser, Dom } from 'main.core';\nimport { getCursorPosition, setCursorPosition } from '../helpers/content-editable-cursor';\n\ntype PromptMasterEditorData = {\n\tselection: Selection;\n}\nexport const PromptMasterEditor = {\n\tprops: {\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tplaceholder: {\n\t\t\tType: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tmaxSymbolsCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tdefault: 2500,\n\t\t},\n\t\tuseClarification: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): PromptMasterEditorData {\n\t\treturn {\n\t\t\tselection: null,\n\t\t\tsymbolsCount: this.text.length,\n\t\t\teditorInFocus: false,\n\t\t\tcursorPosition: 0,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttextContent(): string {\n\t\t\treturn this.convertTextToHtml(this.text);\n\t\t},\n\t\tsymbolCounterClassname(): Object {\n\t\t\treturn {\n\t\t\t\t'ai__prompt-master-editor_symbols-counter': true,\n\t\t\t\t'--error': this.symbolsCount > this.maxSymbolsCount,\n\t\t\t};\n\t\t},\n\t\tclarificationBtnClassname(): Object {\n\t\t\treturn {\n\t\t\t\t'ai__prompt-master-editor_clarification-btn': true,\n\t\t\t\t'--disabled': this.editorInFocus === false,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tformatEditorContent(): void\n\t\t{\n\t\t\tthis.$refs.editor.innerHTML = this.textContent;\n\t\t},\n\t\tconvertTextToHtml(str: string): string {\n\t\t\tif (Type.isStringFilled(str) === false)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst stringWithoutDoubleLineBreaks = Text.encode(str);\n\n\t\t\tconst lines = stringWithoutDoubleLineBreaks.split('\\n');\n\n\t\t\tif (lines.every((line) => line === ''))\n\t\t\t{\n\t\t\t\tlines.shift();\n\t\t\t}\n\n\t\t\tlet resultHtmlString = lines.map((line: string, index: number): string => {\n\t\t\t\tif (index === 0 && line !== '')\n\t\t\t\t{\n\t\t\t\t\treturn line;\n\t\t\t\t}\n\n\t\t\t\treturn `<div>${line === '' ? '<br>' : line}</div>`;\n\t\t\t}).join('');\n\n\t\t\tif (this.useClarification)\n\t\t\t{\n\t\t\t\tresultHtmlString = resultHtmlString\n\t\t\t\t\t.replaceAll('<strong>', '')\n\t\t\t\t\t.replaceAll('</strong>', '')\n\t\t\t\t\t.replaceAll('[', '<strong>[')\n\t\t\t\t\t.replaceAll(']', ']</strong>')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn resultHtmlString;\n\t\t},\n\t\tcheckSelection(): void {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tif (window.getSelection().toString())\n\t\t\t\t{\n\t\t\t\t\tthis.selection = window.getSelection();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.selection = null;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\taddClarification(): void {\n\t\t\tif (this.editorInFocus === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst selection = window.getSelection();\n\t\t\tif (!selection.rangeCount)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst cursorPosition = this.getEditorCursorPosition();\n\n\t\t\tconst range = selection.getRangeAt(0);\n\t\t\tconst strong = document.createElement('strong');\n\t\t\tstrong.textContent = `[ ${this.$Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_EDITOR_CLARIFICATION')} ]`;\n\n\t\t\tif (range.startContainer.nodeName === 'BR')\n\t\t\t{\n\t\t\t\tconst parent: HTMLElement = range.startContainer.parentNode;\n\t\t\t\tparent.children[0].remove();\n\t\t\t\trange.setStart(parent, 0);\n\t\t\t\trange.setEnd(parent, 0);\n\t\t\t}\n\n\t\t\trange.deleteContents();\n\t\t\trange.insertNode(strong);\n\n\t\t\tbindOnce(window, 'mouseup', () => {\n\t\t\t\tthis.focusEditor();\n\t\t\t\tthis.setEditorCursorPosition(cursorPosition + strong.textContent.length);\n\t\t\t});\n\n\t\t\tthis.$emit('input-text', this.getEditorContent());\n\t\t},\n\t\thandleInput(e: InputEvent): boolean {\n\t\t\t// hack for :empty with dynamic content in Safari\n\t\t\tDom.style(this.$refs.placeholder, 'display', 'initial');\n\t\t\tDom.style(this.$refs.placeholder, 'display', null);\n\n\t\t\tif (e.inputType !== 'insertCompositionText')\n\t\t\t{\n\t\t\t\tthis.$emit('input-text', this.getEditorContent());\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tgetEditorContent(): string {\n\t\t\tif (Browser.isSafari())\n\t\t\t{\n\t\t\t\treturn this.$refs.editor.innerText.trimEnd();\n\t\t\t}\n\n\t\t\treturn this.$refs.editor.innerText\n\t\t\t\t.replaceAll('\\r\\n', '\\n\\n')\n\t\t\t\t.replaceAll('\\n\\n', '\\n')\n\t\t\t;\n\t\t},\n\t\tfocusEditor(): void {\n\t\t\tthis.setEditorCursorPosition(999);\n\t\t\tthis.cursorPosition = 999;\n\t\t\tthis.$refs.editor.focus();\n\t\t},\n\t\thandlePaste(event): boolean\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\tlet text = (event.clipboardData || window.clipboardData).getData('text/plain');\n\n\t\t\ttext = text\n\t\t\t\t.replaceAll('\\r\\n', '\\n')\n\t\t\t\t.replaceAll('\\n', '\\n\\n')\n\t\t\t;\n\n\t\t\tconst selection = window.getSelection();\n\t\t\tif (!selection.rangeCount)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tselection.deleteFromDocument();\n\n\t\t\tconst textNode = document.createTextNode(text);\n\n\t\t\tconst range = selection.getRangeAt(0);\n\n\t\t\tif (range.startContainer.nodeName === 'BR')\n\t\t\t{\n\t\t\t\tconst parent: HTMLElement = range.startContainer.parentNode;\n\t\t\t\tparent.children[0].remove();\n\t\t\t\trange.setStart(parent, 0);\n\t\t\t\trange.setEnd(parent, 0);\n\t\t\t}\n\n\t\t\trange.insertNode(textNode);\n\n\t\t\trange.setStartAfter(textNode);\n\t\t\trange.setEndAfter(textNode);\n\t\t\tselection.removeAllRanges();\n\t\t\tselection.addRange(range);\n\n\t\t\tthis.cursorPosition = this.getEditorCursorPosition();\n\n\t\t\tthis.$emit('input-text', this.getEditorContent());\n\n\t\t\treturn true;\n\t\t},\n\t\tupdateSymbolsCounter(): void\n\t\t{\n\t\t\tthis.symbolsCount = this.getEditorContent().length;\n\t\t},\n\t\thandleFocus(): void\n\t\t{\n\t\t\tthis.editorInFocus = true;\n\t\t},\n\t\thandleBlur(): void\n\t\t{\n\t\t\tthis.editorInFocus = false;\n\t\t},\n\t\thandleKeyDown(e: KeyboardEvent): boolean\n\t\t{\n\t\t\tif (e.shiftKey && e.code === 'Enter')\n\t\t\t{\n\t\t\t\te.preventDefault();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (e.metaKey || e.ctrlKey)\n\t\t\t{\n\t\t\t\tconst allowedKeysWithCtrlAndMeta = ['KeyA', 'KeyZ', 'KeyC', 'KeyV', 'KeyR', 'KeyX', 'KeyR', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown', 'Backspace'];\n\t\t\t\tconst key = e.code;\n\t\t\t\tif (allowedKeysWithCtrlAndMeta.includes(key) === false)\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\thandleCompositionEndEvent(): void\n\t\t{\n\t\t\tthis.$emit('input-text', this.getEditorContent());\n\t\t},\n\t\tgetEditorCursorPosition(): number\n\t\t{\n\t\t\treturn getCursorPosition(this.$refs.editor);\n\t\t},\n\t\tsetEditorCursorPosition(position: number): void\n\t\t{\n\t\t\treturn setCursorPosition(this.$refs.editor, position);\n\t\t},\n\t},\n\twatch: {\n\t\ttext() {\n\t\t\tthis.cursorPosition = this.getEditorCursorPosition();\n\t\t\tthis.formatEditorContent();\n\t\t\tif (this.editorInFocus === false)\n\t\t\t{\n\t\t\t\tthis.focusEditor();\n\t\t\t}\n\n\t\t\tthis.setEditorCursorPosition(this.cursorPosition);\n\t\t\tthis.updateSymbolsCounter();\n\t\t},\n\t\tisShown(newValue: boolean, oldValue: boolean): void {\n\t\t\tif (newValue === true && oldValue === false)\n\t\t\t{\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tthis.formatEditorContent();\n\t\t\t\t\tthis.focusEditor();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.focusEditor();\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ai__prompt-master-editor-wrapper\"\n\t\t>\n\t\t\t<div class=\"ai__prompt-master-editor-inner\">\n\t\t\t\t<div\n\t\t\t\t\tv-once\n\t\t\t\t\t@mouseup=\"checkSelection\"\n\t\t\t\t\tclass=\"ai__prompt-master-editor\"\n\t\t\t\t\tcontenteditable=\"true\"\n\t\t\t\t\tref=\"editor\"\n\t\t\t\t\t@input=\"handleInput\"\n\t\t\t\t\t@compositionend=\"handleCompositionEndEvent\"\n\t\t\t\t\t@paste=\"handlePaste\"\n\t\t\t\t\t@focus=\"handleFocus\"\n\t\t\t\t\t@blur=\"handleBlur\"\n\t\t\t\t\t@keydown=\"handleKeyDown\"\n\t\t\t\t\tv-html=\"textContent\"\n\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<span ref=\"placeholder\" class=\"ai__prompt-master-editor-inner_placeholder\">\n\t\t\t\t\t{{ placeholder ? placeholder : $Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_EDITOR_PLACEHOLDER') }}\n\t\t\t\t</span>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"useClarification\"\n\t\t\t\t\t:aria-disabled=\"editorInFocus\"\n\t\t\t\t\t@mousedown=\"addClarification\"\n\t\t\t\t\t:class=\"clarificationBtnClassname\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"ai__prompt-master-editor_clarification-btn-icon\"></span>\n\t\t\t\t\t<span class=\"ai__prompt-master-editor_clarification-btn-text\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_EDITOR_ADD_CLARIFICATION') }}\n\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div :class=\"symbolCounterClassname\">\n\t\t\t\t<span class=\"ai__prompt-master-editor_symbols-counter-current\">\n\t\t\t\t\t{{ symbolsCount }}\n\t\t\t\t</span>\n\t\t\t\t/\n\t\t\t\t<span class=\"ai__prompt-master-editor_symbols-counter-total\">\n\t\t\t\t\t{{ maxSymbolsCount }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Extension, Runtime } from 'main.core';\nimport { PromptMasterEditor } from './prompt-master-editor';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Actions } from 'ui.icon-set.api.core';\n\nimport '../css/prompt-master-editor-step.css';\n\nconst language = Extension.getSettings('ai.prompt-master').language ?? 'en';\n\nexport const PromptMasterEditorStep = {\n\tprops: {\n\t\tpromptText: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tuseClarification: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tmaxSymbolsCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tdefault: 2500,\n\t\t},\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomponents: {\n\t\tPromptMasterEditor,\n\t\tBIcon,\n\t},\n\tdata(): { isInfoSliderShown: boolean } {\n\t\treturn {\n\t\t\tisInfoSliderShown: false,\n\t\t\tanimation: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tcloseInfoSliderIcon(): string {\n\t\t\treturn Actions.CROSS_30;\n\t\t},\n\t\tinstructionSecondStepText(): string {\n\t\t\treturn this.$Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_STEP_ABOUT_STEP_2', {\n\t\t\t\t'#ICON#': '<span class=\"ai__prompt-master_about-editor-slider-step-clarification-icon\"></span>',\n\t\t\t});\n\t\t},\n\t\teditorPlaceholder(): string {\n\t\t\treturn this.useClarification\n\t\t\t\t? this.$Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_EDITOR_PLACEHOLDER_FOR_TEMPLATE_PROMPT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_EDITOR_PLACEHOLDER_FOR_DEFAULT_PROMPT')\n\t\t\t;\n\t\t},\n\t},\n\tmethods: {\n\t\topenInfoSlider(): void {\n\t\t\tthis.isInfoSliderShown = true;\n\t\t},\n\t\tcloseInfoSlider(): void {\n\t\t\tthis.isInfoSliderShown = false;\n\t\t},\n\t\thandleInput(text: string): void {\n\t\t\tthis.$emit('input-text', text);\n\t\t},\n\t\tasync loadLottieAnimation(): Promise<void> {\n\t\t\tconst { Lottie } = await Runtime.loadExtension('ui.lottie');\n\n\t\t\tconst path = language.toLowerCase() === 'ru'\n\t\t\t\t? '/bitrix/js/ai/prompt-master/lottie/insert-text-guide-ru.json'\n\t\t\t\t: '/bitrix/js/ai/prompt-master/lottie/insert-text-guide-en.json';\n\n\t\t\tthis.animation = Lottie.loadAnimation({\n\t\t\t\tpath,\n\t\t\t\tcontainer: this.$refs.guideContainer,\n\t\t\t\tloop: true,\n\t\t\t\tautoplay: true,\n\t\t\t\trenderer: 'svg',\n\t\t\t\trendererSettings: {\n\t\t\t\t\tviewBoxOnly: true,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t},\n\twatch: {\n\t\tasync isInfoSliderShown(): Promise<void> {\n\t\t\tif (this.isInfoSliderShown)\n\t\t\t{\n\t\t\t\tif (this.animation)\n\t\t\t\t{\n\t\t\t\t\tthis.animation.play();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tawait this.loadLottieAnimation();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.animation?.stop();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__prompt-master_prompt-step\">\n\t\t\t<div class=\"ai__prompt-master_prompt-step-editor\">\n\t\t\t\t<PromptMasterEditor\n\t\t\t\t\t:is-shown=\"isShown\"\n\t\t\t\t\t:text=\"promptText\"\n\t\t\t\t\t:use-clarification=\"useClarification\"\n\t\t\t\t\t:max-symbols-count=\"maxSymbolsCount\"\n\t\t\t\t\t:placeholder=\"editorPlaceholder\"\n\t\t\t\t\t@input-text=\"handleInput\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"useClarification\"\n\t\t\t\tclass=\"ai__prompt-master_prompt-step-more-details\"\n\t\t\t>\n\t\t\t\t<span @click=\"openInfoSlider\" class=\"ai__prompt-master_more-details\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_STEP_MORE') }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<transition>\n\t\t\t\t<div\n\t\t\t\t\tv-show=\"isInfoSliderShown\"\n\t\t\t\t\t@click=\"closeInfoSlider\"\n\t\t\t\t\tclass=\"ai__prompt-master_about-editor-slider-wrapper\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ai__prompt-master_about-editor-slider\">\n\t\t\t\t\t\t<header class=\"ai__prompt-master_about-editor-slider__header\">\n\t\t\t\t\t\t\t<h4 class=\"ai__prompt-master_about-editor-slider__title\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_STEP_ABOUT_TITLE') }}\n\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t@click=\"closeInfoSlider\"\n\t\t\t\t\t\t\t\tclass=\"ai__prompt-master_about-editor-slider__close-icon\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BIcon :name=\"closeInfoSliderIcon\" :size=\"20\"></BIcon>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</header>\n\t\t\t\t\t\t<main class=\"ai__prompt-master_about-editor-slider__main\">\n\t\t\t\t\t\t\t<div ref=\"guideContainer\" class=\"ai__prompt-master_about-editor-slider__video-wrapper\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<ul class=\"ai__prompt-master_about-editor-slider-steps\">\n\t\t\t\t\t\t\t\t<li class=\"ai__prompt-master_about-editor-slider-step\">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_STEP_ABOUT_STEP_1') }}\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class=\"ai__prompt-master_about-editor-slider-step\">\n\t\t\t\t\t\t\t\t\t<span v-html=\"instructionSecondStepText\"></span>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class=\"ai__prompt-master_about-editor-slider-step\">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_STEP_ABOUT_STEP_3') }}\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</main>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t</div>\n\t`,\n};\n","import { CRM as CrmIconSet, Main as MainIconSet } from 'ui.icon-set.api.core';\n\nimport 'ui.icon-set.main';\nimport 'ui.icon-set.crm';\n\nexport const availablePromptIcons = [\n\tMainIconSet.ROCKET,\n\tMainIconSet.SHINING,\n\tMainIconSet.CHAT_MESSAGE,\n\tMainIconSet.INFO_CIRCLE,\n\tMainIconSet.WARNING,\n\tMainIconSet.PERSON,\n\tMainIconSet.BLACK_CLOCK,\n\tMainIconSet.CAMERA,\n\tMainIconSet.MICROPHONE_ON,\n\tMainIconSet.PICTURE,\n\tMainIconSet.BELL,\n\tMainIconSet.HEART,\n\tMainIconSet.CROWN_1,\n\tMainIconSet.HOME,\n\tMainIconSet.SHIELD,\n\tMainIconSet.SUITCASE,\n\tMainIconSet.CIRCLE_CHECK,\n\tMainIconSet.FIRE,\n\tMainIconSet.CRM,\n\tMainIconSet.LOCATION_1,\n\tMainIconSet.PRINT_1,\n\tCrmIconSet.DEAL,\n\tMainIconSet.CITY,\n\tMainIconSet.GIFT,\n\tMainIconSet.STOP_HAND,\n\tMainIconSet.ROBOT,\n\tMainIconSet.SITES_STORES,\n\tMainIconSet.CLOCK_BLACK_WHITE,\n\tMainIconSet.CASH_TERMINAL,\n];\n","import { Tag, Dom, Event } from 'main.core';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Icon } from 'ui.icon-set.api.core';\nimport { availablePromptIcons } from '../helpers/available-prompt-icons';\nimport { Popup } from 'main.popup';\n\nimport '../css/prompt-master-icon-selector.css';\n\nexport const PromptMasterIconSelector = {\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tselectedIcon: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata(): { isPopupShown: boolean, popup: Popup } {\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t\tpopup: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tselectedIconColor(): string {\n\t\t\treturn getComputedStyle(document.body).getPropertyValue('--ui-color-copilot-primary');\n\t\t},\n\t},\n\tmethods: {\n\t\ttoggleIconsPopup(): void {\n\t\t\tif (this.isPopupShown)\n\t\t\t{\n\t\t\t\tthis.closeIconsPopup();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showIconsPopup();\n\t\t\t}\n\t\t},\n\t\tcloseIconsPopup(): void {\n\t\t\tthis.isPopupShown = false;\n\t\t\tthis.popup?.close();\n\t\t\tthis.popup = null;\n\t\t},\n\t\tshowIconsPopup(): void {\n\t\t\tif (this.isPopupShown)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.popup)\n\t\t\t{\n\t\t\t\tthis.initIconsPopup();\n\t\t\t}\n\n\t\t\tthis.isPopupShown = true;\n\n\t\t\tthis.popup.show();\n\t\t},\n\t\tinitIconsPopup(): void\n\t\t{\n\t\t\tconst bindElementPosition = Dom.getPosition(this.$el);\n\n\t\t\tthis.popup = new Popup({\n\t\t\t\tcontent: this.getPopupContent(),\n\t\t\t\tbindElement: {\n\t\t\t\t\ttop: bindElementPosition.bottom,\n\t\t\t\t\tleft: bindElementPosition.left - 210,\n\t\t\t\t},\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tcacheable: false,\n\t\t\t\tmaxWidth: 299,\n\t\t\t\tmaxHeight: 208,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: 253,\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.isPopupShown = false;\n\t\t\t\t\t\tthis.popup = null;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tgetPopupContent(): HTMLElement {\n\t\t\tconst container = Tag.render`<div class=\"ai__prompt-master-icon-selector_popup-content\"></div>`;\n\n\t\t\tavailablePromptIcons.forEach((iconCode) => {\n\t\t\t\tconst icon = new Icon({\n\t\t\t\t\ticon: iconCode,\n\t\t\t\t\tsize: 24,\n\t\t\t\t});\n\n\t\t\t\tconst iconContainer = Tag.render`<div class=\"ai__prompt-master-icon-selector_popup-content-icon\"></div>`;\n\n\t\t\t\tif (iconCode === this.selectedIcon)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(iconContainer, '--selected');\n\t\t\t\t}\n\n\t\t\t\ticon.renderTo(iconContainer);\n\n\t\t\t\tEvent.bind(iconContainer, 'click', () => {\n\t\t\t\t\tthis.selectIcon(iconCode);\n\t\t\t\t\tthis.closeIconsPopup();\n\t\t\t\t});\n\n\t\t\t\tDom.append(iconContainer, container);\n\t\t\t});\n\n\t\t\treturn container;\n\t\t},\n\t\tselectIcon(iconCode: string): void {\n\t\t\tthis.$emit('select', iconCode);\n\t\t},\n\t},\n\tunmounted() {\n\t\tthis.popup?.destroy();\n\t\tthis.popup = null;\n\t},\n\ttemplate: `\n\t\t<button @click=\"toggleIconsPopup\" class=\"ai__prompt-master-icon-selector\">\n\t\t\t<span ref=\"selectedIcon\" class=\"ai__prompt-master-icon-selector_selected-icon\">\n\t\t\t\t<BIcon :name=\"selectedIcon\" :size=\"28\" :color=\"selectedIconColor\" />\n\t\t\t</span>\n\t\t</button>\n\t`,\n};\n","import { bind, Dom, Event } from 'main.core';\nimport { Popup } from 'main.popup';\nimport '../css/prompt-master-hint.css';\n\nexport const clickableHint = {\n\tbeforeMount(bindElement: HTMLElement, bindings: string): void {\n\t\tlet popup: Popup = null;\n\t\tlet isMouseOnHintPopup = false;\n\n\t\tconst destroyPopup = () => {\n\t\t\tpopup?.destroy();\n\t\t\tpopup = null;\n\t\t\tisMouseOnHintPopup = false;\n\t\t};\n\n\t\tEvent.bind(bindElement, 'mouseenter', () => {\n\t\t\tif (popup === null)\n\t\t\t{\n\t\t\t\tpopup = createHintPopup(bindElement, bindings.value);\n\t\t\t\tpopup.show();\n\t\t\t\tEvent.bind(popup.getPopupContainer(), 'mouseenter', () => {\n\t\t\t\t\tisMouseOnHintPopup = true;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tEvent.bind(bindElement, 'mouseleave', () => {\n\t\t\tconst popupContainer = popup?.getPopupContainer();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (isMouseOnHintPopup)\n\t\t\t\t{\n\t\t\t\t\tbind(popupContainer, 'mouseleave', (e: MouseEvent) => {\n\t\t\t\t\t\tif (bindElement.contains(e.relatedTarget) === false)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdestroyPopup();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdestroyPopup();\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t});\n\t},\n};\n\nfunction createHintPopup(bindElement: HTMLElement, html: string): Popup\n{\n\tconst bindElementPosition = Dom.getPosition(bindElement);\n\n\treturn new Popup({\n\t\tbindElement: {\n\t\t\ttop: bindElementPosition.top + 10,\n\t\t\tleft: bindElementPosition.left + bindElementPosition.width / 2,\n\t\t},\n\t\tclassName: 'ai__prompt-master_hint-popup',\n\t\tdarkMode: true,\n\t\tcontent: html,\n\t\tmaxWidth: 266,\n\t\tmaxHeight: 300,\n\t\tanimation: 'fading-slide',\n\t\tangle: true,\n\t\tbindOptions: {\n\t\t\tposition: 'top',\n\t\t},\n\t});\n}\n","import { bind, Text } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { BaseEvent } from 'main.core.events';\nimport { Dialog, Item } from 'ui.entity-selector';\n\nimport '../css/prompt-master-user-selector.css';\n\nimport { clickableHint } from '../directives/prompt-master-hover-hint';\n\ntype PromptMasterUserSelectorSelectedItemWithData = {\n\tentityId: string;\n\tid: string | number;\n\ttitle?: string;\n\tavatar?: string;\n}\n\ntype PromptMasterUserSelectorSelectedItem = [string, string | number];\n\nexport const PromptMasterUserSelector = {\n\tdirectives: {\n\t\tclickableHint,\n\t},\n\tprops: {\n\t\tselectedItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => {\n\t\t\t\treturn [];\n\t\t\t},\n\t\t},\n\t\tmaxCirclesInInput: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 8,\n\t\t},\n\t\tundeselectedItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => {\n\t\t\t\treturn [];\n\t\t\t},\n\t\t},\n\t},\n\tdata(): { etcItemHint: Popup } {\n\t\treturn {\n\t\t\tetcItemHint: null,\n\t\t\tcursorOnEtcItem: false,\n\t\t\tselectedItemsWithData: [],\n\t\t\tdataIsLoaded: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpreselectedItems(): Array<string, string | number> {\n\t\t\treturn this.typedSelectedItems.map((item) => {\n\t\t\t\treturn item;\n\t\t\t});\n\t\t},\n\t\ttypedSelectedItems(): PromptMasterUserSelectorSelectedItem[] {\n\t\t\treturn this.selectedItems;\n\t\t},\n\t\tetcItemHintContent(): Object {\n\t\t\tconst titles = this.selectedItemsWithData\n\t\t\t\t.slice(this.maxCirclesInInput)\n\t\t\t\t.map((item) => this.getEncodedString(item.title));\n\n\t\t\tconst titlesText = titles.join('<br>');\n\n\t\t\treturn `<div>${titlesText}</div>`;\n\t\t},\n\t\tetcSelectedItemsCount(): number {\n\t\t\treturn this.selectedItems.slice(this.maxCirclesInInput).length;\n\t\t},\n\t\tetcSelectedItemsCircleNumber(): number {\n\t\t\treturn this.etcSelectedItemsCount < 100 ? this.etcSelectedItemsCount : 99;\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateSelectedItemsWithData(): void {\n\t\t\tconst selectedItems = this.getUserSelectorDialog().getSelectedItems();\n\n\t\t\tif (selectedItems.length === this.selectedItemsWithData.length)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.selectedItemsWithData = selectedItems.map((item) => {\n\t\t\t\treturn this.getSelectedItemsWithDataFromDialogItem(item);\n\t\t\t});\n\t\t},\n\t\tgetSelectedItemsWithDataFromDialogItem(item: Item): PromptMasterUserSelectorSelectedItemWithData {\n\t\t\treturn {\n\t\t\t\tid: item.id,\n\t\t\t\tavatar: item.avatar,\n\t\t\t\tentityId: item.entityId,\n\t\t\t\ttitle: item.title.text,\n\t\t\t};\n\t\t},\n\t\tgetUserSelectorDialog(): Dialog {\n\t\t\tconst existingDialog = Dialog.getById('ai-prompt-master-user-selector');\n\n\t\t\tif (existingDialog)\n\t\t\t{\n\t\t\t\texistingDialog.setTargetNode(this.$refs.userSelector);\n\n\t\t\t\treturn existingDialog;\n\t\t\t}\n\n\t\t\treturn new Dialog({\n\t\t\t\tid: 'ai-prompt-master-user-selector',\n\t\t\t\ttargetNode: this.$refs.userSelector,\n\t\t\t\twidth: 400,\n\t\t\t\theight: 300,\n\t\t\t\tdropdownMode: false,\n\t\t\t\tshowAvatars: true,\n\t\t\t\tcompactView: true,\n\t\t\t\tmultiple: true,\n\t\t\t\tpreload: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tpreselectedItems: this.preselectedItems,\n\t\t\t\tundeselectedItems: this.undeselectedItems,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.selectItem(event.getData().item);\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onDeselect': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.deselectItem(event.getData().item);\n\t\t\t\t\t},\n\t\t\t\t\tonLoad: (): void => {\n\t\t\t\t\t\tthis.dataIsLoaded = true;\n\t\t\t\t\t\tthis.updateSelectedItemsWithData();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tshowUserSelector(): void {\n\t\t\tconst dialog = this.getUserSelectorDialog();\n\n\t\t\tdialog.show();\n\t\t},\n\t\tselectItem(item: Item): void {\n\t\t\tthis.$emit('select-item', {\n\t\t\t\tid: item.id,\n\t\t\t\tentityId: item.entityId,\n\t\t\t});\n\t\t},\n\t\tdeselectItem(item): void {\n\t\t\tthis.$emit('deselect-item', {\n\t\t\t\tid: item.id,\n\t\t\t\tentityId: item.entityId,\n\t\t\t});\n\t\t},\n\t\tgetSelectedItemStyle(item: Object, index: number): Object {\n\t\t\tconst backgroundImage = `url('${this.getAvatarFromItem(item)}')`;\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage,\n\t\t\t\tleft: `${24 * index - 8}px`,\n\t\t\t};\n\t\t},\n\t\tgetAvatarFromItem(item: PromptMasterUserSelectorSelectedItemWithData): string {\n\t\t\tif (item.avatar)\n\t\t\t{\n\t\t\t\treturn item.avatar;\n\t\t\t}\n\n\t\t\tif (item.entityId === 'user')\n\t\t\t{\n\t\t\t\treturn '/bitrix/js/socialnetwork/entity-selector/src/images/default-user.svg';\n\t\t\t}\n\n\t\t\tif (item.entityId === 'meta-user')\n\t\t\t{\n\t\t\t\treturn '/bitrix/js/socialnetwork/entity-selector/src/images/meta-user-all.svg';\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tgetDepartmentFirstLetter(title: string): string {\n\t\t\treturn title.split(' ')[0][0].toUpperCase();\n\t\t},\n\t\tshowEtcItemsHint(): void {\n\t\t\tthis.cursorOnEtcItem = true;\n\t\t\tif (this.etcItemHint)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.etcItemHint = new Popup({\n\t\t\t\tbindElement: this.$refs.etcItem,\n\t\t\t\tdarkMode: true,\n\t\t\t\tcontent: this.etcItemHintContent,\n\t\t\t\tautoHide: true,\n\t\t\t\tmaxHeight: 300,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tangle: true,\n\t\t\t});\n\n\t\t\tthis.etcItemHint.setOffset({\n\t\t\t\toffsetTop: -10,\n\t\t\t\toffsetLeft: 16,\n\t\t\t});\n\n\t\t\tthis.etcItemHint.show();\n\t\t},\n\t\tcloseEtcItemsHint(): void {\n\t\t\tthis.cursorOnEtcItem = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst hoveredItems = document.querySelectorAll(':hover');\n\t\t\t\tconst lastHoveredItem = hoveredItems[hoveredItems.length - 1];\n\n\t\t\t\tconst popupContainer = this.etcItemHint.getPopupContainer();\n\t\t\t\tconst isHintPopupUnderCursor = popupContainer.contains(lastHoveredItem);\n\n\t\t\t\tif (isHintPopupUnderCursor === false)\n\t\t\t\t{\n\t\t\t\t\tthis.destroyEtcItemsHint();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tbind(popupContainer, 'mouseleave', () => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tif (this.cursorOnEtcItem === false)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.destroyEtcItemsHint();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 100);\n\t\t\t\t});\n\t\t\t}, 100);\n\t\t},\n\t\tdestroyEtcItemsHint(): void {\n\t\t\tthis.etcItemHint?.destroy();\n\t\t\tthis.etcItemHint = null;\n\t\t},\n\t\tgetEncodedString(str: string): string {\n\t\t\treturn Text.encode(str);\n\t\t},\n\t},\n\twatch: {\n\t\t'selectedItems.length': function() {\n\t\t\tthis.updateSelectedItemsWithData();\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.updateSelectedItemsWithData();\n\t},\n\tunmounted() {\n\t\tthis.getUserSelectorDialog().destroy();\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__prompt-master_user-selector\">\n\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t<div\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t>\n\t\t\t\t\t<div ref=\"userSelector\" class=\"ai__prompt-master_user-selector_inner\">\n\t\t\t\t\t\t<ul class=\"ai__prompt-master-user-selector_users\">\n\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\tv-for=\"(item, index) in selectedItemsWithData.slice(0, maxCirclesInInput)\"\n\t\t\t\t\t\t\t\t:style=\"getSelectedItemStyle(item, index)\"\n\t\t\t\t\t\t\t\tv-clickable-hint=\"getEncodedString(item.title)\"\n\t\t\t\t\t\t\t\tclass=\"ai__prompt-master-user-selector_user\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span v-if=\"item.entityId === 'department'\">\n\t\t\t\t\t\t\t\t\t{{ getDepartmentFirstLetter(item.title) }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\tv-if=\"etcSelectedItemsCount > 0\"\n\t\t\t\t\t\t\t\tref=\"etcItem\"\n\t\t\t\t\t\t\t\tclass=\"ai__prompt-master-user-selector_etc-item\"\n\t\t\t\t\t\t\t\t@mouseenter=\"showEtcItemsHint\"\n\t\t\t\t\t\t\t\t@mouseleave=\"closeEtcItemsHint\"\n\t\t\t\t\t\t\t\t:style=\"{left: 24 * this.maxCirclesInInput - 8 + 'px'}\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span class=\"ai__prompt-master-user-selector_etc-item-plus\">+</span>\n\t\t\t\t\t\t\t\t<span>{{ etcSelectedItemsCircleNumber }}</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<button @click=\"showUserSelector\" class=\"ai__prompt-master-user-selector_add\">\n\t\t\t\t\t\t\t<span class=\"ai__prompt-master-user-selector_add-text\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_USER_SELECTOR_ADD_BTN') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"getUserSelectorDialog().getItems().length === 0\" class=\"ai__prompt-master_user-selector-loader\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t<div\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"ai__prompt-master_user-selector_inner\">\n\t\t\t\t\t\t\t<ul class=\"ai__prompt-master-user-selector_users\">\n\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\tv-for=\"(item, index) in selectedItems.slice(0, maxCirclesInInput)\"\n\t\t\t\t\t\t\t\t\t:style=\"getSelectedItemStyle(item, index)\"\n\t\t\t\t\t\t\t\t\tclass=\"ai__prompt-master-user-selector_user\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span v-if=\"item.entityId === 'department'\">\n\t\t\t\t\t\t\t\t\t{{ getDepartmentFirstLetter(item.title) }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\tv-if=\"etcSelectedItemsCount > 0\"\n\t\t\t\t\t\t\t\t\tclass=\"ai__prompt-master-user-selector_etc-item\"\n\t\t\t\t\t\t\t\t\t:style=\"{left: 24 * this.maxCirclesInInput - 8 + 'px'}\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<span class=\"ai__prompt-master-user-selector_etc-item-plus\">+</span>\n\t\t\t\t\t\t\t\t\t<span>{{ etcSelectedItemsCircleNumber }}</span>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { ajax } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport type { ItemOptions } from 'ui.entity-selector';\nimport { TagSelector, Dialog } from 'ui.entity-selector';\n\nexport const PromptMasterCategoriesSelector = {\n\tprops: {\n\t\tselectedCategoryIds: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault(): [] {\n\t\t\t\treturn [];\n\t\t\t},\n\t\t},\n\t},\n\tdata(): { allCategories: [], tagSelector: TagSelector } {\n\t\treturn {\n\t\t\tallCategories: [],\n\t\t\ttagSelector: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tdialogItemOptions(): ItemOptions[] {\n\t\t\treturn this.allCategories\n\t\t\t\t.map((category) => {\n\t\t\t\t\treturn this.getTagSelectorItemFromCategory(category);\n\t\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tasync getAllCategories(): Promise<any> {\n\t\t\tconst result = await ajax.runAction('ai.prompt.getCategoriesListWithTranslations');\n\n\t\t\treturn result.data.list;\n\t\t},\n\t\tgetTagSelectorItemFromCategory(category): Object {\n\t\t\treturn {\n\t\t\t\tid: category.code,\n\t\t\t\ttitle: category.name,\n\t\t\t\ttabs: ['prompt-category'],\n\t\t\t\tentityId: 'prompt-category',\n\t\t\t};\n\t\t},\n\t\tselectCategory(item) {\n\t\t\tthis.$emit('select', item.id);\n\t\t},\n\t\tdeselectCategory(item) {\n\t\t\tthis.$emit('deselect', item.id);\n\t\t},\n\t\tinitTagSelector(): TagSelector {\n\t\t\tconst tagSelector = new TagSelector({\n\t\t\t\titems: [],\n\t\t\t\ttagMaxWidth: 300,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tid: 'ai-prompt-master-categories-selector-dialog',\n\t\t\t\t\trecentItemsLimit: 0,\n\t\t\t\t\tcompactView: true,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\twidth: 400,\n\t\t\t\t\titems: [],\n\t\t\t\t\ttabs: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'prompt-category',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tthis.selectCategory(event.getData().item);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Item:onDeselect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tthis.deselectCategory(event.getData().item);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\ttagSelector.renderTo(this.$el);\n\n\t\t\treturn tagSelector;\n\t\t},\n\t},\n\tasync mounted() {\n\t\tconst tagSelector = this.initTagSelector();\n\n\t\tthis.allCategories = await this.getAllCategories();\n\n\t\tthis.dialogItemOptions.forEach((item) => {\n\t\t\tconst selected = this.selectedCategoryIds.length > 0 ? this.selectedCategoryIds.includes(item.id) : true;\n\n\t\t\ttagSelector.getDialog()?.addItem({\n\t\t\t\t...item,\n\t\t\t\tselected,\n\t\t\t});\n\t\t});\n\n\t\tif (this.selectedCategoryIds.length === 0)\n\t\t{\n\t\t\tthis.allCategories.forEach((item) => {\n\t\t\t\tthis.$emit('select', item.code);\n\t\t\t});\n\t\t}\n\t},\n\tunmounted() {\n\t\tDialog.getById('ai-prompt-master-categories-selector-dialog')?.destroy();\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__prompt-master_prompt-categories-selector\"></div>\n\t`,\n};\n","import 'ui.hint';\nimport { clickableHint } from '../directives/prompt-master-hover-hint';\n\nexport const PromptMasterHint = {\n\tdirectives: {\n\t\tclickableHint,\n\t},\n\tprops: {\n\t\thtml: String,\n\t},\n\ttemplate: `\n\t\t<span class=\"ui-hint\" v-clickable-hint=\"html\">\n\t\t\t<span class=\"ui-hint-icon\"/>\n\t\t</span>\n\t`,\n};\n","import { bind, Reflection, Tag } from 'main.core';\nimport { PromptMasterIconSelector } from './prompt-master-icon-selector';\nimport { PromptMasterUserSelector } from './prompt-master-user-selector';\nimport { PromptMasterCategoriesSelector } from './prompt-master-categories-selector';\nimport { clickableHint } from '../directives/prompt-master-hover-hint';\nimport { PromptMasterHint } from './prompt-master-hint';\n\nimport '../css/prompt-master-access-step.css';\n\nexport const PromptMasterAccessStep = {\n\tdirectives: {\n\t\thoverHint: clickableHint,\n\t},\n\tcomponents: {\n\t\tPromptMasterIconSelector,\n\t\tPromptMasterUserSelector,\n\t\tPromptMasterCategoriesSelector,\n\t\tPromptMasterHint,\n\t},\n\tprops: {\n\t\tpromptTitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tpromptIcon: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tpromptAuthorId: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '-1',\n\t\t},\n\t\tselectedItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => {\n\t\t\t\treturn [];\n\t\t\t},\n\t\t},\n\t\tselectedCategories: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => {\n\t\t\t\treturn [];\n\t\t\t},\n\t\t},\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\taccessPointsHintHtml(): string {\n\t\t\tconst htmlMessage = this.$Bitrix.Loc.getMessage('PROMPT_MASTER_ACCESS_STEP_POINTS_HINT', {\n\t\t\t\t'<link>': '<a style=\"display: inline-block;\" href=\"#\">',\n\t\t\t\t'</link>': '</a>',\n\t\t\t});\n\n\t\t\tconst elem = Tag.render`<div style=\"font-size: 14px;\">${htmlMessage}</div>`;\n\t\t\tconst link = elem.querySelector('a');\n\n\t\t\tbind(link, 'click', () => {\n\t\t\t\tconst articleCode = '21979776';\n\n\t\t\t\tconst Helper = Reflection.getClass('top.BX.Helper');\n\n\t\t\t\tif (Helper)\n\t\t\t\t{\n\t\t\t\t\tHelper.show(`redirect=detail&code=${articleCode}`);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn elem;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.$refs.promptTitleInput.focus();\n\t},\n\tmethods: {\n\t\tselectIcon(iconCode: string): void {\n\t\t\tthis.$emit('select-icon', iconCode);\n\t\t},\n\t\tselectItem(item: Object): void {\n\t\t\tthis.$emit('select-item', item);\n\t\t},\n\t\tdeselectItem(item: Object): void {\n\t\t\tthis.$emit('deselect-item', item);\n\t\t},\n\t\thandleNameInput(e): void {\n\t\t\tthis.$emit('input-name', e.target.value);\n\t\t},\n\t\tselectCategory(categoryId: string) {\n\t\t\tthis.$emit('select-category', categoryId);\n\t\t},\n\t\tdeselectCategory(categoryId: string) {\n\t\t\tthis.$emit('deselect-category', categoryId);\n\t\t},\n\t},\n\twatch: {\n\t\tisShown(newValue: boolean, oldValue: boolean): void {\n\t\t\tif (newValue === true && oldValue === false)\n\t\t\t{\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tthis.$refs.promptTitleInput.focus();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__prompt-master-access-step\">\n\t\t\t<div class=\"ai__prompt-master-access-step_section\">\n\t\t\t\t<div class=\"ai__prompt-master-access-step_section-title\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_ACCESS_STEP_NAME_AND_ICON') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ai__prompt-master-access-step_section-content --row\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tref=\"promptTitleInput\"\n\t\t\t\t\t\t\tmaxlength=\"70\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t:value=\"promptTitle\"\n\t\t\t\t\t\t\t@input=\"handleNameInput\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_TITLE_PLACEHOLDER')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ai__prompt-master-access-step_icon-selector\">\n\t\t\t\t\t\t<PromptMasterIconSelector @select=\"selectIcon\" :selected-icon=\"promptIcon\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ai__prompt-master-access-step_section\">\n\t\t\t\t<div class=\"ai__prompt-master-access-step_section-title\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_ACCESS_STEP_GENERAL_ACCESS') }}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ai__prompt-master-access-step_section-content\"\n\t\t\t\t>\n\t\t\t\t\t<PromptMasterUserSelector\n\t\t\t\t\t\t:selected-items=\"selectedItems\"\n\t\t\t\t\t\t:undeselected-items=\"[['user', this.promptAuthorId]]\"\n\t\t\t\t\t\t@select-item=\"selectItem\"\n\t\t\t\t\t\t@deselect-item=\"deselectItem\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ai__prompt-master-access-step_section\">\n\t\t\t\t<div class=\"ai__prompt-master-access-step_section-title\">\n\t\t\t\t\t<span>{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_ACCESS_STEP_POINTS') }}</span>\n\t\t\t\t\t<PromptMasterHint :html=\"accessPointsHintHtml\"></PromptMasterHint>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ai__prompt-master-access-step_section-content\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ai__prompt-master-access-step_section-content\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<PromptMasterCategoriesSelector\n\t\t\t\t\t\t\t:selected-category-ids=\"selectedCategories\"\n\t\t\t\t\t\t\t@select=\"selectCategory\"\n\t\t\t\t\t\t\t@deselect=\"deselectCategory\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Button } from 'ui.buttons';\n\nexport const PromptMasterBtn = {\n\tprops: {\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tdefault: '',\n\t\t},\n\t\tstate: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: Button.Color.AI,\n\t\t},\n\t},\n\tcomputed: {\n\t\tbuttonState(): string {\n\t\t\treturn this.disabled ? Button.State.DISABLED : this.state;\n\t\t},\n\t\tbuttonHtml(): string {\n\t\t\tconst btn = new Button({\n\t\t\t\tcolor: this.color,\n\t\t\t\tsize: Button.Size.MEDIUM,\n\t\t\t\ttext: this.text,\n\t\t\t\tround: true,\n\t\t\t\tstate: this.buttonState,\n\t\t\t});\n\n\t\t\tbtn.setDisabled(this.disabled);\n\n\t\t\treturn btn.render().outerHTML;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-html=\"buttonHtml\"></div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Actions } from 'ui.icon-set.api.core';\n\nimport '../css/prompt-master-back-btn.css';\n\nexport const PromptMasterBackBtn = {\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tcomputed: {\n\t\ticonColor(): string {\n\t\t\treturn getComputedStyle(document.body).getPropertyValue('--ui-color-copilot-secondary');\n\t\t},\n\t\tchevronLeftIconCode(): string {\n\t\t\treturn Actions.CHEVRON_LEFT;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button class=\"ai__prompt-master_back-btn\">\n\t\t\t<BIcon :name=\"chevronLeftIconCode\" :size=\"24\"></BIcon>\n\t\t\t<span>{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_BTN_PREV') }}</span>\n\t\t</button>\n\t`,\n};\n","import { Button } from 'ui.buttons';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { PromptMasterBtn } from './prompt-master-btn';\nimport { Main as MainIconSet, Actions as ActionsIconSet } from 'ui.icon-set.api.core';\n\nimport '../css/prompt-master-error-screen.css';\n\nexport const PromptMasterSaveErrorScreen = {\n\tcomponents: {\n\t\tPromptMasterBtn,\n\t\tBIcon,\n\t},\n\tcomputed: {\n\t\terrorIcon(): string {\n\t\t\treturn MainIconSet.NOTE_CIRCLE;\n\t\t},\n\t\terrorIconColor(): string {\n\t\t\treturn getComputedStyle(document.body).getPropertyValue('--ui-color-text-alert');\n\t\t},\n\t\tbackBtnIconName(): string {\n\t\t\treturn ActionsIconSet.CHEVRON_LEFT;\n\t\t},\n\t\trepeatBtnColor(): string {\n\t\t\treturn Button.Color.LIGHT_BORDER;\n\t\t},\n\t},\n\tmethods: {\n\t\temitRepeatRequest(): void {\n\t\t\tthis.$emit('click-repeat-btn');\n\t\t},\n\t\temitBackBtnClick(): void {\n\t\t\tthis.$emit('click-back-btn');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__prompt-master_error-screen\">\n\t\t\t<div class=\"ai__prompt-master_error-screen-icon\">\n\t\t\t\t<BIcon\n\t\t\t\t\t:name=\"errorIcon\"\n\t\t\t\t\t:color=\"errorIconColor\"\n\t\t\t\t\t:size=\"66\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<span class=\"ai__prompt-master_error-screen-error\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_SAVE_ERROR') }}\n\t\t\t</span>\n\t\t\t<div class=\"ai__prompt-master_error-screen-repeat-btn\">\n\t\t\t\t<PromptMasterBtn\n\t\t\t\t\t@click=\"emitRepeatRequest\"\n\t\t\t\t\t:color=\"repeatBtnColor\"\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('PROMPT_MASTER_SAVE_REPEAT_BTN')\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<p class=\"ai__prompt-master_error-screen-warning-message\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_ERROR_WARNING_MESSAGE') }}\n\t\t\t</p>\n\t\t\t<div @click=\"emitBackBtnClick\" class=\"ai__prompt-master_error-screen-back-btn\">\n\t\t\t\t<BIcon :name=\"backBtnIconName\" :size=\"16\"  />\n\t\t\t\t<span class=\"ai__prompt-master_error-screen-back-btn-text\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_SAVE_ERROR_BACK_BTN') }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc, ajax, Event, Reflection, Extension } from 'main.core';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Actions, Main as MainIconSet } from 'ui.icon-set.api.core';\nimport { Button } from 'ui.buttons';\nimport { hint } from 'ui.vue3.directives.hint';\nimport { Loader } from 'main.loader';\n\nimport { PromptMasterPromptTypes, promptTypes } from './prompt-master-prompt-types';\nimport { PromptMasterStep } from './prompt-master-step';\nimport { PromptMasterEditorStep } from './prompt-master-editor-step';\nimport { PromptMasterAccessStep } from './prompt-master-access-step';\nimport { PromptMasterBtn } from './prompt-master-btn';\nimport { PromptMasterBackBtn } from './prompt-master-back-btn';\nimport { PromptMasterProgress } from './prompt-master-progress';\nimport { PromptMasterAlertMessage } from './prompt-master-alert-message';\nimport { PromptMasterSaveErrorScreen } from './prompt-master-save-error-screen';\n\nconst promptTypeName = {\n\tDEFAULT: Loc.getMessage('PROMPT_MASTER_PROMPT_TYPE_FIRST_NAME'),\n\tSIMPLE_TEMPLATE: Loc.getMessage('PROMPT_MASTER_PROMPT_TYPE_SECOND_NAME'),\n};\n\ntype PromptMasterData = {\n\tpromptType: string;\n};\n\nconst currentUserId = Extension.getSettings('ai.prompt-master').get('userId');\n\nexport const PromptMaster = {\n\tprops: {\n\t\tcode: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\ttype: String,\n\t\ttitle: String,\n\t\ttext: String,\n\t\ticon: String,\n\t\tcategories: Array,\n\t\taccessCodes: Array,\n\t\tanalyticCategory: String,\n\t\tauthorId: String,\n\t},\n\tdirectives: {\n\t\thint,\n\t},\n\tcomponents: {\n\t\tPromptMasterStep,\n\t\tPromptMasterPromptTypes,\n\t\tPromptMasterEditorStep,\n\t\tPromptMasterAccessStep,\n\t\tPromptMasterBtn,\n\t\tPromptMasterBackBtn,\n\t\tPromptMasterProgress,\n\t\tPromptMasterAlertMessage,\n\t\tPromptMasterSaveErrorScreen,\n\t\tBIcon,\n\t},\n\tdata(): PromptMasterData {\n\t\treturn {\n\t\t\tcurrentStepIndex: 0,\n\t\t\tpromptType: this.type || '',\n\t\t\tpromptTitle: this.title || '',\n\t\t\tpromptText: this.text || '',\n\t\t\tpromptIcon: this.icon || MainIconSet.ROCKET,\n\t\t\tselectedItems: this.accessCodes || [['user', currentUserId]],\n\t\t\tpromptCategories: this.categories || [],\n\t\t\tsaveButtonState: '',\n\t\t\tisPromptSaving: false,\n\t\t\tisPromptSaved: false,\n\t\t\tisPromptSavedError: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisPromptEditing(): boolean {\n\t\t\treturn !this.isPromptSaving && !this.isPromptSavedError && !this.isPromptSaved;\n\t\t},\n\t\tisSecondStepEnabled(): boolean {\n\t\t\treturn Boolean(this.promptType);\n\t\t},\n\t\tpromptTypeName(): string {\n\t\t\treturn promptTypeName[this.promptType];\n\t\t},\n\t\tchevronLeftIcon(): string {\n\t\t\treturn Actions.CHEVRON_LEFT;\n\t\t},\n\t\tcheckIcon(): string {\n\t\t\treturn MainIconSet.CHECK;\n\t\t},\n\t\tisEditPromptMaster(): boolean\n\t\t{\n\t\t\treturn Boolean(this.code);\n\t\t},\n\t\talertMessage(): string\n\t\t{\n\t\t\tif (this.isEditPromptMaster && this.accessCodes.length > 1)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('PROMPT_MASTER_TYPE_ALERT');\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tuseClarificationInEditor(): boolean\n\t\t{\n\t\t\treturn this.promptType === promptTypes[1].id;\n\t\t},\n\t\tmaxSymbolsCount(): number {\n\t\t\treturn 2500;\n\t\t},\n\t\tisPromptCanBeSave(): boolean {\n\t\t\tconst isTitleValid = this.promptTitle.length > 1 && this.promptTitle.length <= 70;\n\t\t\tconst isPromptCategoriesValid = this.promptCategories.length > 0;\n\t\t\tconst isAccessPointsValid = this.selectedItems.length > 0;\n\n\t\t\treturn isTitleValid && isPromptCategoriesValid && isAccessPointsValid && !this.isPromptSaving;\n\t\t},\n\t\tcloseMasterBtnColor(): string {\n\t\t\treturn Button.Color.LIGHT_BORDER;\n\t\t},\n\t\tpromptEditorStepTitle(): string {\n\t\t\tif (this.promptType === 'DEFAULT')\n\t\t\t{\n\t\t\t\treturn this.text\n\t\t\t\t\t? this.$Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_STEP_TITLE_FOR_EDIT_SIMPLE_PROMPT')\n\t\t\t\t\t: this.$Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_STEP_TITLE_FOR_ADD_SIMPLE_PROMPT')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('PROMPT_MASTER_PROMPT_STEP_TITLE');\n\t\t},\n\t},\n\tmethods: {\n\t\thandlePromptTypeSelect(selectedPromptType: string): void {\n\t\t\tthis.promptType = selectedPromptType;\n\t\t\t// this.currentStepIndex += 1;\n\t\t},\n\t\thandlePromptIconSelect(selectedIcon: string): void {\n\t\t\tthis.promptIcon = selectedIcon;\n\t\t},\n\t\tasync savePrompt(): void {\n\t\t\tif (this.isPromptCanBeSave === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet isLoadFinished = false;\n\t\t\ttry\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (isLoadFinished === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.isPromptSavedError = false;\n\t\t\t\t\t\tthis.saveButtonState = Button.State.WAITING;\n\t\t\t\t\t\tthis.isPromptSaving = true;\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\n\t\t\t\tconst action = this.code ? 'change' : 'create';\n\n\t\t\t\tconst data = {\n\t\t\t\t\tpromptCode: this.code,\n\t\t\t\t\tanalyticCategory: this.analyticCategory,\n\t\t\t\t\tpromptType: this.promptType,\n\t\t\t\t\tpromptTitle: this.promptTitle,\n\t\t\t\t\tpromptDescription: this.promptText,\n\t\t\t\t\tpromptIcon: this.promptIcon,\n\t\t\t\t\taccessCodes: this.selectedItems,\n\t\t\t\t\tcategoriesForSave: this.promptCategories,\n\t\t\t\t};\n\n\t\t\t\tawait ajax.runAction(`ai.prompt.${action}`, {\n\t\t\t\t\tdata,\n\t\t\t\t});\n\n\t\t\t\tEvent.EventEmitter.emit('AI.prompt-master-app:save-success', data);\n\t\t\t\tthis.isPromptSaved = true;\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tconsole.error(e);\n\t\t\t\tthis.isPromptSavedError = true;\n\t\t\t\tEvent.EventEmitter.emit('AI.prompt-master-app:save-failed');\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tthis.isPromptSaving = false;\n\t\t\t\tisLoadFinished = true;\n\t\t\t\tthis.saveButtonState = '';\n\t\t\t}\n\t\t},\n\t\tselectItem(user: Object): void {\n\t\t\tthis.selectedItems.push([\n\t\t\t\tuser.entityId,\n\t\t\t\tuser.id,\n\t\t\t]);\n\t\t},\n\t\tdeselectItem(item: Object): void {\n\t\t\tconst removingUserIndex = this.selectedItems.findIndex((currentItem) => {\n\t\t\t\treturn currentItem[0] === item.entityId && String(currentItem[1]) === String(item.id);\n\t\t\t});\n\n\t\t\tif (removingUserIndex > -1)\n\t\t\t{\n\t\t\t\tthis.selectedItems.splice(removingUserIndex, 1);\n\t\t\t}\n\t\t},\n\t\thandlePromptNameInput(name: string): void {\n\t\t\tthis.promptTitle = name;\n\t\t},\n\t\thandlePromptTextInput(text: string): void {\n\t\t\tthis.promptText = text;\n\t\t},\n\t\tselectCategory(categoryId: string) {\n\t\t\tthis.promptCategories.push(categoryId);\n\t\t},\n\t\tdeselectCategory(categoryId: string) {\n\t\t\tconst removingCategoryIndex = this.promptCategories.indexOf(categoryId);\n\n\t\t\tthis.promptCategories.splice(removingCategoryIndex, 1);\n\t\t},\n\t\thandleBackBtnClick() {\n\t\t\tthis.isPromptSavedError = false;\n\t\t},\n\t\thandleRepeatRequestBtnClick() {\n\t\t\tthis.savePrompt();\n\t\t},\n\t\topenArticleAboutPromptMaster(): void {\n\t\t\tconst articleCode = '21979776';\n\n\t\t\tconst Helper = Reflection.getClass('top.BX.Helper');\n\n\t\t\tif (Helper)\n\t\t\t{\n\t\t\t\tHelper.show(`redirect=detail&code=${articleCode}`);\n\t\t\t}\n\t\t},\n\t\temitCloseMasterEvent(): void {\n\t\t\tEvent.EventEmitter.emit('AI.prompt-master-app:close-master');\n\t\t},\n\t},\n\twatch: {\n\t\tisPromptSaving(isSaving) {\n\t\t\tif (isSaving === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst copilotPrimaryColor = getComputedStyle(document.body).getPropertyValue('--ui-color-copilot-primary');\n\n\t\t\tconst loader = new Loader({\n\t\t\t\tsize: 80,\n\t\t\t\tstrokeWidth: 4,\n\t\t\t\ttarget: this.$refs.loaderScreen,\n\t\t\t\tcolor: copilotPrimaryColor,\n\t\t\t});\n\n\t\t\tloader.show(this.$refs.loaderScreen);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__prompt-master\">\n\t\t\t<transition-group>\n\t\t\t\t<PromptMasterStep\n\t\t\t\t\tv-show=\"currentStepIndex === 0 && isPromptEditing\"\n\t\t\t\t\t:suptitle=\"$Bitrix.Loc.getMessage('PROMPT_MASTER_SELECT_TYPE_STEP_SUPTITLE')\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('PROMPT_MASTER_SELECT_TYPE_STEP_TITLE')\"\n\t\t\t\t\t:steps-count=\"3\"\n\t\t\t\t\t:step-index=\"1\"\n\t\t\t\t\t:alert-message=\"alertMessage\"\n\t\t\t\t>\n\t\t\t\t\t<template #content>\n\t\t\t\t\t\t<PromptMasterPromptTypes @select=\"handlePromptTypeSelect\" :active-prompt-type=\"promptType\"/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #footer>\n\t\t\t\t\t\t<div class=\"ai__prompt-master_navigation\">\n\t\t\t\t\t\t\t<div class=\"ai__prompt-master_prompt-types-step-more\">\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t@click=\"openArticleAboutPromptMaster\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ai__prompt-master_more-details\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_SELECT_TYPE_STEP_MORE') }}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<PromptMasterBtn\n\t\t\t\t\t\t\t\t@click=\"currentStepIndex += 1\"\n\t\t\t\t\t\t\t\t:disabled=\"isSecondStepEnabled === false\"\n\t\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('PROMPT_MASTER_BTN_NEXT')\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</PromptMasterStep>\n\t\t\t\t<PromptMasterStep\n\t\t\t\t\tv-show=\"currentStepIndex === 1 && isPromptEditing\"\n\t\t\t\t\t:suptitle=\"promptTypeName\"\n\t\t\t\t\t:title=\"promptEditorStepTitle\"\n\t\t\t\t\t:steps-count=\"3\"\n\t\t\t\t\t:step-index=\"2\"\n\t\t\t\t>\n\t\t\t\t\t<template #content>\n\t\t\t\t\t\t<PromptMasterEditorStep\n\t\t\t\t\t\t\t:is-shown=\"currentStepIndex === 1 && isPromptEditing\"\n\t\t\t\t\t\t\t:use-clarification=\"useClarificationInEditor\"\n\t\t\t\t\t\t\t:prompt-text=\"promptText\"\n\t\t\t\t\t\t\t:max-symbols-count=\"maxSymbolsCount\"\n\t\t\t\t\t\t\t@input-text=\"handlePromptTextInput\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #footer>\n\t\t\t\t\t\t<div class=\"ai__prompt-master_navigation\">\n\t\t\t\t\t\t\t<PromptMasterBackBtn @click=\"currentStepIndex -= 1\"></PromptMasterBackBtn>\n\t\t\t\t\t\t\t<PromptMasterBtn\n\t\t\t\t\t\t\t\t:disabled=\"promptText.length > maxSymbolsCount || promptText.length < 6\"\n\t\t\t\t\t\t\t\t@click=\"currentStepIndex += 1\"\n\t\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('PROMPT_MASTER_BTN_NEXT')\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</PromptMasterStep>\n\t\t\t\t<PromptMasterStep\n\t\t\t\t\tv-show=\"currentStepIndex === 2 && isPromptEditing\"\n\t\t\t\t\t:suptitle=\"promptTypeName\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('PROMPT_MASTER_ACCESS_STEP_TITLE')\"\n\t\t\t\t\t:steps-count=\"3\"\n\t\t\t\t\t:step-index=\"3\"\n\t\t\t\t>\n\t\t\t\t\t<template #content>\n\t\t\t\t\t\t<PromptMasterAccessStep\n\t\t\t\t\t\t\t:is-shown=\"currentStepIndex === 2 && isPromptEditing\"\n\t\t\t\t\t\t\t:prompt-icon=\"promptIcon\"\n\t\t\t\t\t\t\t:prompt-title=\"promptTitle\"\n\t\t\t\t\t\t\t:selected-items=\"selectedItems\"\n\t\t\t\t\t\t\t:selected-categories=\"promptCategories\"\n\t\t\t\t\t\t\t:prompt-author-id=\"authorId\"\n\t\t\t\t\t\t\t@select-icon=\"handlePromptIconSelect\"\n\t\t\t\t\t\t\t@input-name=\"handlePromptNameInput\"\n\t\t\t\t\t\t\t@select-item=\"selectItem\"\n\t\t\t\t\t\t\t@deselect-item=\"deselectItem\"\n\t\t\t\t\t\t\t@select-category=\"selectCategory\"\n\t\t\t\t\t\t\t@deselect-category=\"deselectCategory\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #footer>\n\t\t\t\t\t\t<div class=\"ai__prompt-master_navigation\">\n\t\t\t\t\t\t\t<PromptMasterBackBtn @click=\"currentStepIndex -= 1\"></PromptMasterBackBtn>\n\t\t\t\t\t\t\t<PromptMasterBtn\n\t\t\t\t\t\t\t\t@click=\"savePrompt\"\n\t\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('PROMPT_MASTER_BTN_SAVE')\"\n\t\t\t\t\t\t\t\t:disabled=\"isPromptCanBeSave === false\"\n\t\t\t\t\t\t\t\t:state=\"saveButtonState\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</PromptMasterStep>\n\t\t\t\t<div v-show=\"isPromptSaving\" class=\"ai__prompt-master_loader\">\n\t\t\t\t\t<div ref=\"loaderScreen\" class=\"ai__prompt-master_loader-loader\"></div>\n\t\t\t\t\t<div class=\"ai__prompt-master_loader-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_SAVE_IN_PROCESS') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"isPromptSaved\" class=\"ai__prompt-master_success\">\n\t\t\t\t\t<div class=\"ai__prompt-master_success-icon\">\n\t\t\t\t\t\t<BIcon :name=\"checkIcon\" size=\"58\" color=\"#8E52EC\"></BIcon>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ai__prompt-master_success-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('PROMPT_MASTER_SAVE_SUCCESS') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ai__prompt-master_success-close-btn\">\n\t\t\t\t\t\t<PromptMasterBtn\n\t\t\t\t\t\t\t@click=\"emitCloseMasterEvent\"\n\t\t\t\t\t\t\t:color=\"closeMasterBtnColor\"\n\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('PROMPT_MASTER_SAVE_CLOSE_BTN')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"isPromptSavedError\" class=\"ai__prompt-master_error\">\n\t\t\t\t\t<PromptMasterSaveErrorScreen\n\t\t\t\t\t\t@click-repeat-btn=\"handleRepeatRequestBtnClick\"\n\t\t\t\t\t\t@click-back-btn=\"handleBackBtnClick\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</transition-group>\n\t\t</div>\n\t`,\n};\n","import { Tag, Event, Extension } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { BitrixVue, type VueCreateAppResult } from 'ui.vue3';\nimport { PromptMaster as PromptMasterApp } from './components/prompt-master';\n\nimport './css/prompt-master.css';\n\nexport type PromptMasterOptions = {\n\tauthorId?: string;\n\tprompt?: string;\n\ttype?: string;\n\tname?: string;\n\taccessCodes?: [];\n\tcategories?: [];\n\ticon?: string;\n\tcode?: string;\n\tanalyticCategory: string;\n}\n\nexport const PromptMasterEvents = {\n\tSAVE_SUCCESS: 'save-success',\n\tSAVE_FAILED: 'save-failed',\n\tCLOSE_MASTER: 'close-master',\n};\n\nexport class PromptMaster extends Event.EventEmitter\n{\n\t#promptOptions: PromptMasterOptions = {};\n\t#app: VueCreateAppResult;\n\t#successPromptSavingEventHandler: Function;\n\t#closeBtnClickHandler: Function;\n\n\tconstructor(options: PromptMasterOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('AI.prompt-master');\n\t\tthis.#promptOptions = options || {};\n\t\tthis.#successPromptSavingEventHandler = this.#handleSuccessPromptSaving.bind(this);\n\t\tthis.#closeBtnClickHandler = this.#handleClickOnCloseBtn.bind(this);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst container = Tag.render`<div class=\"ai__prompt-master-container\"></div>`;\n\n\t\tconst currentUserId = Extension.getSettings('ai.prompt-master').get('userId');\n\n\t\tlet authorId = this.#promptOptions.authorId;\n\n\t\tif (!this.#promptOptions.code && currentUserId)\n\t\t{\n\t\t\tauthorId = currentUserId;\n\t\t}\n\n\t\tthis.#app = BitrixVue.createApp(PromptMasterApp, {\n\t\t\tauthorId,\n\t\t\tcode: this.#promptOptions.code,\n\t\t\ttext: this.#promptOptions.prompt,\n\t\t\ttype: this.#promptOptions.type,\n\t\t\ttitle: this.#promptOptions.name,\n\t\t\taccessCodes: this.#promptOptions.accessCodes,\n\t\t\tcategories: this.#promptOptions.categories,\n\t\t\ticon: this.#promptOptions.icon,\n\t\t\tanalyticCategory: this.#promptOptions.analyticCategory,\n\t\t});\n\n\t\tEvent.EventEmitter.subscribe('AI.prompt-master-app:save-success', this.#successPromptSavingEventHandler);\n\t\tEvent.EventEmitter.subscribe('AI.prompt-master-app:close-master', this.#closeBtnClickHandler);\n\n\t\tthis.#app.mount(container);\n\n\t\treturn container;\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#app.unmount();\n\t\tEvent.EventEmitter.unsubscribe('AI.prompt-master-app:save-success', this.#successPromptSavingEventHandler);\n\t\tEvent.EventEmitter.unsubscribe('AI.prompt-master-app:close-master', this.#closeBtnClickHandler);\n\t}\n\n\t#handleSuccessPromptSaving(event: BaseEvent): void\n\t{\n\t\tthis.emit(PromptMasterEvents.SAVE_SUCCESS, event.getData());\n\t}\n\n\t#handleClickOnCloseBtn(): void\n\t{\n\t\tthis.emit(PromptMasterEvents.CLOSE_MASTER);\n\t}\n}\n","import { Event } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { PromptMaster, PromptMasterEvents } from './prompt-master';\nimport { sendData } from 'ui.analytics';\n\nimport './css/prompt-master-popup.css';\n\nimport type { PromptMasterOptions } from './prompt-master';\n\nexport type PromptMasterPopupAnalyticFields = {\n\tc_section?: string;\n}\n\nexport type PromptMasterPopupOptions = {\n\tmasterOptions: PromptMasterOptions;\n\tpopupEvents: Object;\n\tanalyticFields: PromptMasterPopupAnalyticFields;\n}\n\nexport const PromptMasterPopupEvents = Object.freeze({\n\tSAVE_SUCCESS: 'save-success',\n\tSAVE_FAILED: 'save-success',\n});\n\nexport class PromptMasterPopup extends Event.EventEmitter\n{\n\t#masterOptions: PromptMasterOptions = {};\n\t#popupEvents: Object = {};\n\t#analyticFields: PromptMasterPopupAnalyticFields;\n\t#popup: Popup | null;\n\t#successPromptSavingHandler: Function;\n\t#closeMasterHandler: Function;\n\t#isPromptWasSaved: boolean;\n\n\tconstructor(options: PromptMasterPopupOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('AI.prompt-master-popup');\n\t\tthis.#masterOptions = options.masterOptions || {};\n\t\tthis.#popupEvents = options.popupEvents || {};\n\t\tthis.#analyticFields = options.analyticFields || {};\n\t\tthis.#isPromptWasSaved = false;\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tthis.#popup = this.#initPopup();\n\t\t}\n\n\t\tthis.#popup.show();\n\t}\n\n\thide(): void\n\t{\n\t\tthis.#popup?.close();\n\t}\n\n\t#initPopup(): Popup\n\t{\n\t\tconst masterOptions = {\n\t\t\tanalyticCategory: this.#analyticFields.c_section,\n\t\t\t...this.#masterOptions,\n\t\t};\n\n\t\tconst promptMaster = new PromptMaster(masterOptions);\n\n\t\tthis.#successPromptSavingHandler = this.#handleSuccessPromptSaving.bind(this);\n\t\tthis.#closeMasterHandler = this.#handleCloseMasterEvent.bind(this);\n\n\t\tpromptMaster.subscribe(PromptMasterEvents.SAVE_SUCCESS, this.#successPromptSavingHandler);\n\t\tpromptMaster.subscribe(PromptMasterEvents.CLOSE_MASTER, this.#closeMasterHandler);\n\n\t\treturn new Popup({\n\t\t\tid: 'prompt-master-popup',\n\t\t\tcontent: promptMaster.render(),\n\t\t\twidth: 360,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tautoHide: false,\n\t\t\tcloseByEsc: false,\n\t\t\tclassName: 'ai__prompt-master-popup',\n\t\t\tpadding: 0,\n\t\t\tborderRadius: '12px',\n\t\t\toverlay: true,\n\t\t\tevents: {\n\t\t\t\t...this.#popupEvents,\n\t\t\t\tonAfterShow: () => {\n\t\t\t\t\tthis.#popup.setHeight(this.#popup.getPopupContainer().offsetHeight);\n\t\t\t\t},\n\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\tthis.#popup = null;\n\t\t\t\t\tpromptMaster.unsubscribe(PromptMasterEvents.SAVE_SUCCESS, this.#successPromptSavingHandler);\n\t\t\t\t\tpromptMaster.unsubscribe(PromptMasterEvents.CLOSE_MASTER, this.#closeMasterHandler);\n\t\t\t\t\tpromptMaster.destroy();\n\t\t\t\t\tif (this.#popupEvents.onPopupDestroy)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#popupEvents.onPopupDestroy();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.#isPromptWasSaved === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#sendAnalyticCancelLabel();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonPopupShow: () => {\n\t\t\t\t\tif (this.#popupEvents.onPopupShow)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#popupEvents.onPopupShow();\n\t\t\t\t\t}\n\t\t\t\t\tthis.#sendAnalyticOpenLabel();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#handleSuccessPromptSaving(event: BaseEvent): void\n\t{\n\t\tthis.emit(PromptMasterPopupEvents.SAVE_SUCCESS, event.getData());\n\t\tthis.#popup.setAutoHide(true);\n\t\tthis.#popup.setClosingByEsc(true);\n\t\tthis.#isPromptWasSaved = true;\n\t}\n\n\t#handleCloseMasterEvent(): void\n\t{\n\t\tthis.hide();\n\t}\n\n\t#sendAnalyticOpenLabel(): void\n\t{\n\t\tsendData({\n\t\t\ttool: 'ai',\n\t\t\tcategory: 'prompt_saving',\n\t\t\tevent: 'open',\n\t\t\tc_section: this.#analyticFields.c_section,\n\t\t\tstatus: 'success',\n\t\t});\n\t}\n\n\t#sendAnalyticCancelLabel(): void\n\t{\n\t\tsendData({\n\t\t\ttool: 'ai',\n\t\t\tcategory: 'prompt_saving',\n\t\t\tevent: 'cancel',\n\t\t\tc_section: this.#analyticFields.c_section,\n\t\t\tstatus: 'success',\n\t\t});\n\t}\n}\n"],"names":["promptTypes","id","title","Loc","getMessage","description","example","active","icon","PromptMasterPromptTypes","components","Hint","directives","hint","props","activePromptType","type","String","required","default","computed","map","isActive","methods","getPromptTypeClass","getPromptTypeIconClassname","iconName","selectPromptType","$emit","template","PromptMasterProgress","stepsCount","Number","currentStep","getProgressStepClassname","isPassedStep","PromptMasterAlertMessage","text","alertHtml","alert","Alert","AlertIcon","INFO","color","AlertColor","WARNING","size","AlertSize","XS","render","outerHTML","PromptMasterStep","suptitle","stepIndex","alertMessage","createRangeWithPosition","node","targetPosition","range","document","createRange","selectNode","setStart","pos","stack","length","current","pop","nodeType","Node","TEXT_NODE","len","textContent","setEnd","ELEMENT_NODE","childNodes","nodeName","i","push","setCursorPosition","selection","window","getSelection","removeAllRanges","addRange","getCursorPosition","rangeCount","getRangeAt","clonedRange","cloneRange","selectNodeContents","endContainer","endOffset","cursorPosition","toString","div","createElement","Dom","append","cloneContents","lineBreakElements","querySelectorAll","firstChild","PromptMasterEditor","placeholder","Type","maxSymbolsCount","useClarification","Boolean","isShown","data","symbolsCount","editorInFocus","convertTextToHtml","symbolCounterClassname","clarificationBtnClassname","formatEditorContent","$refs","editor","innerHTML","str","isStringFilled","stringWithoutDoubleLineBreaks","Text","encode","lines","split","every","line","shift","resultHtmlString","index","join","replaceAll","checkSelection","requestAnimationFrame","addClarification","getEditorCursorPosition","strong","$Bitrix","startContainer","parent","parentNode","children","remove","deleteContents","insertNode","bindOnce","focusEditor","setEditorCursorPosition","getEditorContent","handleInput","e","style","inputType","Browser","isSafari","innerText","trimEnd","focus","handlePaste","event","preventDefault","clipboardData","getData","deleteFromDocument","textNode","createTextNode","setStartAfter","setEndAfter","updateSymbolsCounter","handleFocus","handleBlur","handleKeyDown","shiftKey","code","metaKey","ctrlKey","allowedKeysWithCtrlAndMeta","key","includes","handleCompositionEndEvent","position","watch","newValue","oldValue","mounted","language","Extension","getSettings","PromptMasterEditorStep","promptText","BIcon","isInfoSliderShown","animation","closeInfoSliderIcon","Actions","CROSS_30","instructionSecondStepText","editorPlaceholder","openInfoSlider","closeInfoSlider","loadLottieAnimation","Lottie","Runtime","loadExtension","path","toLowerCase","loadAnimation","container","guideContainer","loop","autoplay","renderer","rendererSettings","viewBoxOnly","play","stop","availablePromptIcons","MainIconSet","ROCKET","SHINING","CHAT_MESSAGE","INFO_CIRCLE","PERSON","BLACK_CLOCK","CAMERA","MICROPHONE_ON","PICTURE","BELL","HEART","CROWN_1","HOME","SHIELD","SUITCASE","CIRCLE_CHECK","FIRE","CRM","LOCATION_1","PRINT_1","CrmIconSet","DEAL","CITY","GIFT","STOP_HAND","ROBOT","SITES_STORES","CLOCK_BLACK_WHITE","CASH_TERMINAL","PromptMasterIconSelector","selectedIcon","isPopupShown","popup","selectedIconColor","getComputedStyle","body","getPropertyValue","toggleIconsPopup","closeIconsPopup","showIconsPopup","close","initIconsPopup","show","bindElementPosition","getPosition","$el","Popup","content","getPopupContent","bindElement","top","bottom","left","autoHide","closeByEsc","cacheable","maxWidth","maxHeight","angle","offset","events","onPopupClose","Tag","forEach","iconCode","Icon","iconContainer","addClass","renderTo","Event","bind","selectIcon","unmounted","destroy","clickableHint","beforeMount","bindings","isMouseOnHintPopup","destroyPopup","createHintPopup","value","getPopupContainer","popupContainer","setTimeout","contains","relatedTarget","html","width","className","darkMode","bindOptions","PromptMasterUserSelector","selectedItems","Array","maxCirclesInInput","undeselectedItems","etcItemHint","cursorOnEtcItem","selectedItemsWithData","dataIsLoaded","preselectedItems","typedSelectedItems","item","etcItemHintContent","titles","slice","getEncodedString","titlesText","etcSelectedItemsCount","etcSelectedItemsCircleNumber","updateSelectedItemsWithData","getUserSelectorDialog","getSelectedItems","getSelectedItemsWithDataFromDialogItem","avatar","entityId","existingDialog","Dialog","getById","setTargetNode","userSelector","targetNode","height","dropdownMode","showAvatars","compactView","multiple","preload","enableSearch","entities","options","inviteEmployeeLink","selectMode","selectItem","deselectItem","onLoad","showUserSelector","dialog","getSelectedItemStyle","backgroundImage","getAvatarFromItem","getDepartmentFirstLetter","toUpperCase","showEtcItemsHint","etcItem","setOffset","offsetTop","offsetLeft","closeEtcItemsHint","hoveredItems","lastHoveredItem","isHintPopupUnderCursor","destroyEtcItemsHint","PromptMasterCategoriesSelector","selectedCategoryIds","allCategories","tagSelector","dialogItemOptions","category","getTagSelectorItemFromCategory","getAllCategories","result","ajax","runAction","list","name","tabs","selectCategory","deselectCategory","initTagSelector","TagSelector","items","tagMaxWidth","dialogOptions","recentItemsLimit","selected","getDialog","addItem","PromptMasterHint","PromptMasterAccessStep","hoverHint","promptTitle","promptIcon","promptAuthorId","selectedCategories","accessPointsHintHtml","htmlMessage","elem","link","querySelector","articleCode","Helper","Reflection","getClass","promptTitleInput","handleNameInput","target","categoryId","PromptMasterBtn","state","disabled","Button","Color","AI","buttonState","State","DISABLED","buttonHtml","btn","Size","MEDIUM","round","setDisabled","PromptMasterBackBtn","iconColor","chevronLeftIconCode","CHEVRON_LEFT","PromptMasterSaveErrorScreen","errorIcon","NOTE_CIRCLE","errorIconColor","backBtnIconName","ActionsIconSet","repeatBtnColor","LIGHT_BORDER","emitRepeatRequest","emitBackBtnClick","promptTypeName","DEFAULT","SIMPLE_TEMPLATE","currentUserId","get","PromptMaster","categories","accessCodes","analyticCategory","authorId","currentStepIndex","promptType","promptCategories","saveButtonState","isPromptSaving","isPromptSaved","isPromptSavedError","isPromptEditing","isSecondStepEnabled","chevronLeftIcon","checkIcon","CHECK","isEditPromptMaster","useClarificationInEditor","isPromptCanBeSave","isTitleValid","isPromptCategoriesValid","isAccessPointsValid","closeMasterBtnColor","promptEditorStepTitle","handlePromptTypeSelect","selectedPromptType","handlePromptIconSelect","savePrompt","isLoadFinished","WAITING","action","promptCode","promptDescription","categoriesForSave","EventEmitter","emit","console","error","user","removingUserIndex","findIndex","currentItem","splice","handlePromptNameInput","handlePromptTextInput","removingCategoryIndex","indexOf","handleBackBtnClick","handleRepeatRequestBtnClick","openArticleAboutPromptMaster","emitCloseMasterEvent","isSaving","copilotPrimaryColor","loader","Loader","strokeWidth","loaderScreen","PromptMasterEvents","SAVE_SUCCESS","SAVE_FAILED","CLOSE_MASTER","constructor","setEventNamespace","BitrixVue","createApp","PromptMasterApp","prompt","subscribe","mount","unmount","unsubscribe","PromptMasterPopupEvents","Object","freeze","PromptMasterPopup","masterOptions","popupEvents","analyticFields","hide","c_section","promptMaster","closeIcon","padding","borderRadius","overlay","onAfterShow","setHeight","offsetHeight","onPopupDestroy","onPopupShow","setAutoHide","setClosingByEsc","sendData","tool","status"],"mappings":"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"}