{"version":3,"file":"script.js","sources":["src/popup-categories-renderer.js","src/list-renderer.js","src/helpers.js","src/shares-list-renderer.js","src/popup-with-loader.js","src/index.js"],"sourcesContent":["import { Tag } from 'main.core';\nimport { Label } from 'ui.label';\n\ntype PromptCategoryItem = {\n\tname: string;\n\tcode: string;\n};\n\nexport class PopupCategoriesRenderer\n{\n\trender(list: PromptCategoryItem[]): HTMLElement\n\t{\n\t\tconst listElements = list.map((item) => {\n\t\t\tconst label = new Label({\n\t\t\t\ttext: item.name,\n\t\t\t\tfill: true,\n\t\t\t\tcolor: Label.Color.LIGHT,\n\t\t\t});\n\n\t\t\treturn Tag.render`<li>${label.render()}</li>`;\n\t\t});\n\n\t\treturn Tag.render`<ul class=\"ai__categories-popup_list\">${listElements}</ul>`;\n\t}\n}\n","export class ListRenderer\n{\n\trender() {}\n}\n","import { Runtime, Tag, Type } from 'main.core';\n\nexport async function showNotification(content: string | HTMLElement): void\n{\n\tRuntime.loadExtension('ui.notification')\n\t\t.then(({ BX }) => {\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent,\n\t\t\t});\n\t\t})\n\t\t.catch(() => {\n\t\t\tif (Type.isElementNode(content))\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line @bitrix24/bitrix24-rules/no-native-dialogs,no-alert\n\t\t\t\talert(content.innerText);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line @bitrix24/bitrix24-rules/no-native-dialogs,no-alert\n\t\t\t\talert(content);\n\t\t\t}\n\t\t});\n}\n\nexport function highlightText(text: string, searchTerm: string): string\n{\n\tif (!searchTerm || !text)\n\t{\n\t\treturn text;\n\t}\n\n\tconst lowerSearchTerm = searchTerm.toLowerCase();\n\n\tconst regex = new RegExp(lowerSearchTerm, 'gi');\n\n\treturn text.replace(regex, (match) => `<mark>${match}</mark>`);\n}\n\nexport function wrapTextToHtmlWithWordBreak(text: string): HTMLElement\n{\n\treturn Tag.render`<span style=\"word-break: break-word;\">${text}</span>`;\n}\n","import { Tag, Type, Text } from 'main.core';\nimport { ListRenderer } from './list-renderer';\nimport { highlightText } from './helpers';\n\ntype SharesListItem = {\n\tname: string;\n\timg: ?string;\n}\n\nexport class SharesListRenderer extends ListRenderer\n{\n\trender(sharesList: SharesListItem[], searchValue: string): HTMLElement\n\t{\n\t\tconst search = searchValue || null;\n\t\tconst itemsElements = sharesList.map((item: SharesListItem) => {\n\t\t\tconst encodedName = Text.encode(item.name);\n\n\t\t\tconst highlightedName = highlightText(encodedName, search);\n\n\t\t\treturn Tag.render`\n\t\t\t\t<li class=\"ai__prompt-library-grid-shares-popup_shares-list-item\">\n\t\t\t\t\t<div class=\"ai__prompt-library-grid-shares-popup_shares-list-item-avatar\">\n\t\t\t\t\t\t${this.#renderShareItemImg(item)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ai__prompt-library-grid-shares-popup_shares-list-item-title\">\n\t\t\t\t\t\t${highlightedName}\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t`;\n\t\t});\n\n\t\treturn Tag.render`<ul class=\"ai__prompt-library-grid-shares-popup_shares-list\">${itemsElements}</ul>`;\n\t}\n\n\t#renderShareItemImg(shareItem: SharesListItem): HTMLElement\n\t{\n\t\tif (Type.isStringFilled(shareItem.img))\n\t\t{\n\t\t\treturn Tag.render`<img src=\"${shareItem.img}\" alt=\"${shareItem.name}\" />`;\n\t\t}\n\n\t\treturn this.#renderShareItemInitials(shareItem.name);\n\t}\n\n\t#renderShareItemInitials(title: string): HTMLElement\n\t{\n\t\tif (!title)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst initials = title\n\t\t\t.split(' ')\n\t\t\t.slice(0, 2)\n\t\t\t.map((titleWord: string) => {\n\t\t\t\treturn titleWord[0].toUpperCase();\n\t\t\t})\n\t\t\t.join('');\n\n\t\treturn Tag.render`<span class=\"ai__prompt-library-grid-shares-popup_shares-list-item-initials\">${initials}</span>`;\n\t}\n}\n","import { bind, Tag, Dom } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Loader } from 'main.loader';\nimport { ListRenderer } from './list-renderer';\n\nexport type PopupWithLoaderOptions = {\n\tbindElement: HTMLElement;\n\tlistRenderer: ListRenderer;\n\tevents?: Object;\n\tfilter?: Function;\n\tuseSearch?: boolean;\n}\n\nexport class PopupWithLoader\n{\n\t#bindElement: HTMLElement = null;\n\t#popupContent: {root: HTMLElement, listContainer: HTMLElement};\n\t#isLoading: boolean = false;\n\t#popup: Popup = null;\n\t#list: string[] = [];\n\t#listRenderer: ListRenderer;\n\t#events: Object;\n\t#useSearch: boolean;\n\t#searchValue: string = '';\n\t#filter: Function | null;\n\n\tconstructor(options: PopupWithLoaderOptions)\n\t{\n\t\tthis.#bindElement = options.bindElement;\n\t\tthis.#listRenderer = options.listRenderer;\n\t\tthis.#events = options.events || {};\n\t\tthis.#filter = options.filter || null;\n\t\tthis.#useSearch = options.useSearch === true;\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tthis.#initPopup();\n\t\t}\n\n\t\tthis.#popup.show();\n\n\t\tif (this.#isLoading)\n\t\t{\n\t\t\tconst copilotColor = getComputedStyle(document.body).getPropertyValue('--ui-color-copilot-primary');\n\n\t\t\tconst loader = new Loader({\n\t\t\t\ttarget: this.#popupContent,\n\t\t\t\tsize: 30,\n\t\t\t\tcolor: copilotColor,\n\t\t\t});\n\n\t\t\tloader.show(this.#popupContent.root);\n\t\t}\n\t}\n\n\thide(): void\n\t{\n\t\tthis.#popup?.destroy();\n\t\tthis.#popup = null;\n\t\tthis.#popupContent = null;\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn Boolean(this.#popup?.isShown());\n\t}\n\n\tsetLoading(isLoading: boolean): void\n\t{\n\t\tthis.#isLoading = isLoading;\n\t}\n\n\tsetList(list: string[])\n\t{\n\t\tthis.#list = list;\n\n\t\tif (this.#popup)\n\t\t{\n\t\t\tthis.#popup.setContent(this.#renderPopupContent());\n\t\t}\n\t}\n\n\t#initPopup()\n\t{\n\t\tthis.#popup = new Popup({\n\t\t\tbindElement: this.#bindElement,\n\t\t\tcacheable: false,\n\t\t\tclassName: 'ai__share-prompt-library-grid_popup-with-more-info',\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t},\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcontent: this.#renderPopupContent(),\n\t\t\twidth: 285,\n\t\t\tminHeight: 190,\n\t\t\tmaxHeight: 300,\n\t\t\tpadding: 16,\n\t\t\tcontentPadding: 0,\n\t\t\tevents: {\n\t\t\t\t...this.#events,\n\t\t\t},\n\t\t});\n\t}\n\n\t#renderPopupContent(): HTMLElement\n\t{\n\t\tconst listWithSearchClassnameModifier = this.#useSearch ? '--with-search' : '';\n\n\t\tthis.#popupContent = Tag.render`\n\t\t\t<div class=\"ai__prompt-library_info-popup\">\n\t\t\t\t${this.#renderSearch()}\n\t\t\t\t<div class=\"ai__prompt-library_info-popup_list ${listWithSearchClassnameModifier}\" ref=\"listContainer\">\n\t\t\t\t\t${this.#renderList()}\n\t\t\t\t</div>\n\t\t\t<div>\n\t\t`;\n\n\t\treturn this.#popupContent.root;\n\t}\n\n\t#renderList(): HTMLElement\n\t{\n\t\tconst list = this.#list.filter((item) => {\n\t\t\tif (this.#filter)\n\t\t\t{\n\t\t\t\treturn this.#filter(item, this.#searchValue);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\n\t\treturn this.#listRenderer.render(list, this.#searchValue);\n\t}\n\n\t#updateList(): void\n\t{\n\t\tif (this.#popupContent.listContainer)\n\t\t{\n\t\t\tthis.#popupContent.listContainer.innerHTML = '';\n\t\t\tDom.append(this.#renderList(), this.#popupContent.listContainer);\n\t\t}\n\t}\n\n\t#renderSearch(): HTMLElement\n\t{\n\t\tif (this.#useSearch === false)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst container = Tag.render`\n\t\t\t<div class=\"ai__prompt-library_info-popup_search\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-before-icon ui-ctl-after-icon\">\n\t\t\t\t\t<div class=\"ui-ctl-before ui-ctl-icon-search\"></div>\n\t\t\t\t\t<button ref=\"clear\" class=\"ui-ctl-after ui-ctl-icon-clear\"></button>\n\t\t\t\t\t<input ref=\"input\" type=\"text\" class=\"ui-ctl-element\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tbind(container.clear, 'click', () => {\n\t\t\tcontainer.input.value = '';\n\t\t\tthis.#searchValue = '';\n\t\t\tthis.#updateList();\n\t\t});\n\n\t\tbind(container.input, 'input', (e) => {\n\t\t\tthis.#searchValue = e.target.value;\n\t\t\tthis.#updateList();\n\t\t});\n\n\t\treturn container.root;\n\t}\n}\n","import { BaseEvent } from 'main.core.events';\nimport { type BannerDispatcher as BannerDispatcherType } from 'ui.banner-dispatcher';\nimport { PopupCategoriesRenderer } from './popup-categories-renderer';\nimport { SharesListRenderer } from './shares-list-renderer';\nimport { PopupWithLoader } from './popup-with-loader';\nimport { ajax, bind, Runtime, Loc, Event, Dom, Text } from 'main.core';\nimport { showNotification, wrapTextToHtmlWithWordBreak } from './helpers';\nimport { sendData } from 'ui.analytics';\nimport { type Guide as GuideType } from 'ui.tour';\nimport type { PromptMasterPopupOptions } from 'ai.prompt-master';\n\ntype CategoryWithTranslate = {\n\tname: string;\n\tcode: string;\n};\n\nexport class Controller\n{\n\t/**\n\t * @var BX.Main.Grid\n\t */\n\tstatic #grid;\n\tstatic #categoriesListPopup: PopupWithLoader = null;\n\tstatic #allSharesListPopup: PopupWithLoader = null;\n\tstatic #categoriesWithTranslate: CategoryWithTranslate[] = [];\n\tstatic #promptSuccessSavingEventHandler: Function = null;\n\n\tstatic async fetchPromptCategories(promptCode: string): Promise<Array> {\n\t\tconst data = new FormData();\n\t\tdata.append('promptCode', promptCode);\n\n\t\tconst res = await ajax.runAction('ai.prompt.getCategoriesForPrompt', {\n\t\t\tdata,\n\t\t});\n\n\t\treturn res.data.list;\n\t}\n\n\tstatic handleClickOnDeletePromptSwitcher(event: PointerEvent, promptCode: string, promptTitle: string): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tthis.#sendRowAction('toggle-deleted', {\n\t\t\tpromptCode,\n\t\t\tneedDeleted: 1,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(\n\t\t\t\tLoc.getMessage(\n\t\t\t\t\t'PROMPT_LIBRARY_GRID_NOTIFICATION_HIDE',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(promptTitle)}</b>` },\n\t\t\t\t),\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic handleClickOnUndoDeletePromptSwitcher(event: PointerEvent, promptCode: string, promptTitle: string): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tthis.#sendRowAction('toggle-deleted', {\n\t\t\tpromptCode,\n\t\t\tneedDeleted: 0,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(\n\t\t\t\tLoc.getMessage(\n\t\t\t\t\t'PROMPT_LIBRARY_GRID_NOTIFICATION_SHOW',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(promptTitle)}</b>` },\n\t\t\t\t),\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic handleClickOnActivatePromptMenuItem(event: PointerEvent, promptCode: string, promptName: string): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\n\t\tthis.#sendRowAction('toggle-active', {\n\t\t\tpromptCode,\n\t\t\tneedActivate: 1,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(\n\t\t\t\twrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'PROMPT_LIBRARY_GRID_NOTIFICATION_ACTIVATE',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(promptName)}</b>` },\n\t\t\t\t)),\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic handleClickOnDeactivatePromptMenuItem(event: PointerEvent, promptCode: string, promptName: string): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\n\t\tthis.#sendRowAction('toggle-active', {\n\t\t\tpromptCode,\n\t\t\tneedActivate: 0,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(\n\t\t\t\twrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'PROMPT_LIBRARY_GRID_NOTIFICATION_DEACTIVATE',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(promptName)}</b>` },\n\t\t\t\t)),\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic async handleClickOnSharesCell(sharePromptCode: string, event: PointerEvent): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\n\t\tif (this.#allSharesListPopup)\n\t\t{\n\t\t\tthis.#allSharesListPopup.hide();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#allSharesListPopup = new PopupWithLoader({\n\t\t\tbindElement: event.target,\n\t\t\tlistRenderer: new SharesListRenderer(),\n\t\t\tevents: {\n\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\tthis.#allSharesListPopup = null;\n\t\t\t\t},\n\t\t\t},\n\t\t\tfilter: (item: {code: string, name: string}, searchValue: string) => {\n\t\t\t\treturn item.name.toLowerCase().includes(searchValue?.toLowerCase());\n\t\t\t},\n\t\t\tuseSearch: true,\n\t\t});\n\n\t\ttry\n\t\t{\n\t\t\tthis.#allSharesListPopup.setLoading(true);\n\t\t\tthis.#allSharesListPopup.show();\n\n\t\t\tconst formData = new FormData();\n\n\t\t\tformData.append('promptCode', sharePromptCode);\n\n\t\t\tconst res = await ajax.runAction('ai.prompt.getShareForPrompt', {\n\t\t\t\tdata: formData,\n\t\t\t});\n\n\t\t\tconst list = res.data.list;\n\n\t\t\tthis.#allSharesListPopup.setList(list.slice(5));\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\t\t\tawait showNotification(Loc.getMessage('PROMPT_LIBRARY_GRID_NOTIFICATION_SHOW_PROMPT_USERS_ERROR'));\n\t\t\tthis.#allSharesListPopup.hide();\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tthis.#allSharesListPopup.setLoading(false);\n\t\t}\n\t}\n\n\tstatic handleClickOnCategoriesCell(e: PointerEvent, promptCode: string, excludedCategoryCode: string)\n\t{\n\t\te.preventDefault();\n\t\te.stopImmediatePropagation();\n\n\t\tconst target = e.target;\n\n\t\tif (Controller.#categoriesListPopup)\n\t\t{\n\t\t\tController.#categoriesListPopup.hide();\n\n\t\t\treturn;\n\t\t}\n\n\t\tController.#categoriesListPopup = new PopupWithLoader({\n\t\t\tbindElement: target,\n\t\t\tlistRenderer: new PopupCategoriesRenderer(),\n\t\t\tevents: {\n\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\tController.#categoriesListPopup = null;\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tController.#categoriesListPopup.setLoading(true);\n\t\tController.#categoriesListPopup.show();\n\n\t\tController.fetchPromptCategories(promptCode)\n\t\t\t.then((list) => {\n\t\t\t\tconst excludedCategoryListItemIndex = list.findIndex((item) => item.code === excludedCategoryCode);\n\n\t\t\t\tlist.splice(excludedCategoryListItemIndex, 1);\n\n\t\t\t\tController.#categoriesWithTranslate = list;\n\t\t\t\tController.#categoriesListPopup.setLoading(false);\n\t\t\t\tController.#categoriesListPopup.setList(Controller.#categoriesWithTranslate);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.error(err);\n\t\t\t\tController.#categoriesListPopup.setLoading(false);\n\t\t\t\tController.#categoriesListPopup.setList([]);\n\t\t\t});\n\n\t\tController.#categoriesListPopup.show();\n\t}\n\n\tstatic async handleClickOnPromptName(event: PointerEvent, promptCode: string): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\n\t\tthis.editPrompt(promptCode);\n\t}\n\n\tstatic async editPrompt(promptCode: string): void\n\t{\n\t\tthis.#grid.getLoader().show();\n\t\tthis.#grid.tableFade();\n\t\tconst formData = new FormData();\n\t\tformData.append('promptCode', promptCode);\n\n\t\tconst fetchPromptByCodePromise = ajax.runAction('ai.prompt.getPromptByCodeForUpdate', {\n\t\t\tmethod: 'POST',\n\t\t\tdata: formData,\n\t\t});\n\n\t\tconst loadPromptMasterExtensionPromise = Runtime.loadExtension('ai.prompt-master');\n\n\t\ttry\n\t\t{\n\t\t\tconst results = await Promise.all([fetchPromptByCodePromise, loadPromptMasterExtensionPromise]);\n\n\t\t\tconst res = results[0];\n\t\t\tconst PromptMasterPopup = results[1].PromptMasterPopup;\n\t\t\tconst PromptMasterPopupEvents = results[1].PromptMasterPopupEvents;\n\n\t\t\tconst prompt = res.data.prompt;\n\n\t\t\tconst options: PromptMasterPopupOptions = {\n\t\t\t\tmasterOptions: {\n\t\t\t\t\tcode: prompt.code,\n\t\t\t\t\tprompt: prompt.prompt,\n\t\t\t\t\ttype: prompt.type,\n\t\t\t\t\tname: prompt.translate,\n\t\t\t\t\ticon: prompt.icon,\n\t\t\t\t\tcategories: Object.values(prompt.categories),\n\t\t\t\t\taccessCodes: prompt.accessCodes,\n\t\t\t\t\tauthorId: prompt.authorId,\n\t\t\t\t},\n\t\t\t};\n\t\t\tconst popup = new PromptMasterPopup({\n\t\t\t\t...options,\n\t\t\t\tpopupEvents: {\n\t\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\t\tpopup.unsubscribe(PromptMasterPopupEvents.SAVE_SUCCESS, Controller.#promptSuccessSavingEventHandler);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tanalyticFields: {\n\t\t\t\t\tc_section: 'list',\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tController.#promptSuccessSavingEventHandler = Controller.#handlePromptSuccessSaving.bind(Controller);\n\n\t\t\tpopup.subscribe(PromptMasterPopupEvents.SAVE_SUCCESS, Controller.#promptSuccessSavingEventHandler);\n\n\t\t\tpopup.show();\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\n\t\t\tshowNotification(Loc.getMessage('PROMPT_LIBRARY_GRID_ACTION_OPEN_EDIT_MASTER_ERROR'));\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tthis.#grid.getLoader().hide();\n\t\t\tthis.#grid.tableUnfade();\n\t\t}\n\t}\n\n\tstatic async handleClickOnCreatePromptButton(button: Button): void\n\t{\n\t\ttry\n\t\t{\n\t\t\tbutton.setClocking(true);\n\t\t\tconst { PromptMasterPopup, PromptMasterPopupEvents } = await Runtime.loadExtension('ai.prompt-master');\n\n\t\t\tconst popup = new PromptMasterPopup({\n\t\t\t\tpopupEvents: {\n\t\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\t\tpopup.unsubscribe(PromptMasterPopupEvents.SAVE_SUCCESS, Controller.#promptSuccessSavingEventHandler);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tanalyticFields: {\n\t\t\t\t\tc_section: 'list',\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tController.#promptSuccessSavingEventHandler = Controller.#handlePromptSuccessSaving.bind(Controller);\n\n\t\t\tpopup.subscribe(PromptMasterPopupEvents.SAVE_SUCCESS, Controller.#promptSuccessSavingEventHandler);\n\n\t\t\tpopup.show();\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\t\t\tshowNotification(Loc.getMessage('PROMPT_LIBRARY_GRID_NOTIFICATION_PROMPT_MASTER_OPEN_ERROR'));\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tbutton.setClocking(false);\n\t\t}\n\t}\n\n\tstatic handleClickOnPromptIsFavouriteLabel(\n\t\tevent: PointerEvent,\n\t\tpromptCode: string,\n\t\tfavourite: 'true' | 'false',\n\t\tpromptName: string,\n\t): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\n\t\tthis.#sendRowAction('toggle-favourite', {\n\t\t\tpromptCode,\n\t\t\tfavourite,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tconst message = favourite === 'true'\n\t\t\t\t? wrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'PROMPT_LIBRARY_GRID_NOTIFICATION_FAVOURITE_ADD',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(promptName)}</b>` },\n\t\t\t\t))\n\t\t\t\t: wrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'PROMPT_LIBRARY_GRID_NOTIFICATION_FAVOURITE_REMOVE',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(promptName)}</b>` },\n\t\t\t\t))\n\t\t\t;\n\n\t\t\tshowNotification(message);\n\t\t});\n\t}\n\n\tstatic togglePromptFavourite(promptCode: string, favourite: boolean, promptName: string): void\n\t{\n\t\tthis.#sendRowAction('toggle-favourite', {\n\t\t\tpromptCode,\n\t\t\tfavourite,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tconst message = favourite === 'true'\n\t\t\t\t? wrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'PROMPT_LIBRARY_GRID_NOTIFICATION_FAVOURITE_ADD',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(promptName)}</b>` },\n\t\t\t\t))\n\t\t\t\t: wrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'PROMPT_LIBRARY_GRID_NOTIFICATION_FAVOURITE_REMOVE',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(promptName)}</b>` },\n\t\t\t\t))\n\t\t\t;\n\n\t\t\tshowNotification(message);\n\t\t});\n\t}\n\n\tstatic applyMultipleAction(): void\n\t{\n\t\tconst action = this.#grid.getActionsPanel().getPanel().querySelector('#action-menu span').dataset.value;\n\n\t\tconst actionWithoutQuotes = action.replaceAll('\"', '');\n\n\t\tconst message = this.#getNotificationMessageForMassAction(actionWithoutQuotes);\n\n\t\tthis.#sendRowAction(actionWithoutQuotes, {\n\t\t\tselectedSharePromptsCodes: this.#grid.getRows().getSelectedIds(),\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(message);\n\t\t});\n\t}\n\n\tstatic #getNotificationMessageForMassAction(actionName: string): string\n\t{\n\t\tswitch (actionName)\n\t\t{\n\t\t\tcase 'multiple-activate':\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('PROMPT_LIBRARY_GRID_NOTIFICATION_MASS_ACTIVATE');\n\t\t\t}\n\n\t\t\tcase 'multiple-deactivate':\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('PROMPT_LIBRARY_GRID_NOTIFICATION_MASS_DEACTIVATE');\n\t\t\t}\n\n\t\t\tcase 'multiple-show-for-me':\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('PROMPT_LIBRARY_GRID_NOTIFICATION_MASS_SHOW');\n\t\t\t}\n\n\t\t\tcase 'multiple-hide-from-me':\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('PROMPT_LIBRARY_GRID_NOTIFICATION_MASS_HIDE');\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('PROMPT_LIBRARY_GRID_NOTIFICATION_MASS_ACTION_DEFAULT');\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic init(gridId: string, isShowTour: boolean = false)\n\t{\n\t\tif (isShowTour)\n\t\t{\n\t\t\tthis.#showSimpleTour();\n\t\t}\n\n\t\tthis.#grid = BX.Main.gridManager.getById(gridId)?.instance;\n\n\t\tbind(this.#grid.getScrollContainer(), 'scroll', () => {\n\t\t\tthis.#categoriesListPopup?.hide();\n\t\t\tthis.#allSharesListPopup?.hide();\n\t\t});\n\n\t\tController.#updateApplyButtonClassname();\n\t\tController.#observeSelectActionButtonValue();\n\n\t\tEvent.EventEmitter.subscribe('Grid::updated', () => {\n\t\t\tController.#updateApplyButtonClassname();\n\t\t\tController.#observeSelectActionButtonValue();\n\t\t\tBX.UI.Hint.init(BX('main-grid-table'));\n\t\t});\n\n\t\tEvent.EventEmitter.subscribe('BX.Main.Filter:apply', () => {\n\t\t\tsendData({\n\t\t\t\ttool: 'ai',\n\t\t\t\tcategory: 'prompt_saving',\n\t\t\t\tevent: 'use_filter',\n\t\t\t\tc_section: 'list',\n\t\t\t\tstatus: 'success',\n\t\t\t});\n\t\t});\n\n\t\tBX.UI.Hint.init(BX('main-grid-table'));\n\t}\n\n\tstatic #observeSelectActionButtonValue(): void\n\t{\n\t\tconst panel = this.#grid.getActionsPanel();\n\n\t\tif (!panel)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst attributesObserver = new MutationObserver(() => {\n\t\t\tController.#updateApplyButtonClassname();\n\t\t});\n\n\t\tconst selectActionButton = panel.getControls()[0];\n\n\t\tattributesObserver.observe(selectActionButton, {\n\t\t\tchildList: false,\n\t\t\tsubtree: true,\n\t\t\tcharacterDataOldValue: false,\n\t\t\tattributes: true,\n\t\t\tattributeOldValue: true,\n\t\t\tattributeFilter: ['data-value'],\n\t\t\tcharacterData: false,\n\t\t});\n\t}\n\n\tstatic #updateApplyButtonClassname(): void\n\t{\n\t\tconst panel = this.#grid.getActionsPanel();\n\n\t\tif (!panel)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst values = panel.getValues();\n\n\t\tconst btn = panel.getPanel().querySelector('#apply_button_control.ui-btn');\n\n\t\tconst action = values['action-menu'];\n\n\t\tif (action === '\"select-action\"' || action === 'select-action')\n\t\t{\n\t\t\tDom.addClass(btn, 'ui-btn-disabled');\n\t\t\tDom.addClass(btn, 'ai__prompt-library-grid_share-initials');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(btn, 'ui-btn-disabled');\n\t\t\tDom.removeClass(btn, 'ai__prompt-library-grid_share-initials');\n\t\t}\n\t}\n\n\tstatic #handlePromptSuccessSaving(event: BaseEvent): void\n\t{\n\t\tthis.#sendRowAction('edit-prompt', {\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(\n\t\t\t\tLoc.getMessage(\n\t\t\t\t\t'PROMPT_LIBRARY_GRID_NOTIFICATION_PROMPT_SAVE_SUCCESS',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(event.getData().promptTitle)}</b>` },\n\t\t\t\t),\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic async #showSimpleTour(): void\n\t{\n\t\tconst loadGuideExtensionPromise = Runtime.loadExtension('ui.tour');\n\t\tconst loadBannerDispatcherExtensionPromise = Runtime.loadExtension('ui.banner-dispatcher');\n\n\t\tconst result = await Promise.all([loadGuideExtensionPromise, loadBannerDispatcherExtensionPromise]);\n\n\t\tconst Guide = result[0].Guide;\n\t\tconst BannerDispatcher: BannerDispatcherType = result[1].BannerDispatcher;\n\n\t\tBannerDispatcher.critical.toQueue((onDone) => {\n\t\t\tconst guide: GuideType = new Guide({\n\t\t\t\tid: 'share-prompt-grid-create-prompt-hint',\n\t\t\t\tsimpleMode: true,\n\t\t\t\toverlay: false,\n\t\t\t\tonEvents: true,\n\t\t\t\tautoSave: true,\n\t\t\t\tsteps: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttarget: '.ui-btn.ui-btn-success',\n\t\t\t\t\t\ttitle: Loc.getMessage('PROMPT_LIBRARY_GRID_TOUR_TITLE'),\n\t\t\t\t\t\ttext: Loc.getMessage('PROMPT_LIBRARY_GRID_TOUR_DESCRIPTION'),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\n\t\t\tEvent.EventEmitter.subscribe('UI.Tour.Guide:onFinish', () => {\n\t\t\t\tguide.save();\n\t\t\t\tonDone();\n\t\t\t});\n\n\t\t\tguide.start();\n\t\t});\n\t}\n\n\tstatic #getCurrentPage(): number\n\t{\n\t\tconst currentPageElement = document.body.querySelector('.main-ui-pagination-page.main-ui-pagination-active');\n\n\t\treturn Number.parseInt(currentPageElement?.innerText, 10) || 1;\n\t}\n\n\tstatic #sendRowAction(action: string, data: Object, callback: Function): void\n\t{\n\t\tconst dataWithAction = {\n\t\t\t[this.#grid.getActionKey()]: action,\n\t\t\t...data,\n\t\t};\n\n\t\tthis.#grid.reloadTable('POST', dataWithAction, callback);\n\t}\n}\n"],"names":["PopupCategoriesRenderer","list","listElements","map","item","label","Label","text","name","fill","color","Color","LIGHT","Tag","render","ListRenderer","showNotification","content","Runtime","loadExtension","then","BX","UI","Notification","Center","notify","Type","isElementNode","alert","innerText","highlightText","searchTerm","lowerSearchTerm","toLowerCase","regex","RegExp","replace","match","wrapTextToHtmlWithWordBreak","SharesListRenderer","sharesList","searchValue","search","itemsElements","encodedName","Text","encode","highlightedName","shareItem","isStringFilled","img","title","initials","split","slice","titleWord","toUpperCase","join","PopupWithLoader","options","_classPrivateMethodInitSpec","bindElement","listRenderer","events","filter","useSearch","_classPrivateMethodGet","show","copilotColor","getComputedStyle","document","body","getPropertyValue","loader","Loader","target","size","root","destroy","Boolean","isShown","isLoading","setContent","Popup","cacheable","className","angle","position","autoHide","closeByEsc","width","minHeight","maxHeight","padding","contentPadding","listWithSearchClassnameModifier","listContainer","innerHTML","Dom","append","container","bind","clear","input","value","e","Controller","promptCode","data","FormData","ajax","runAction","res","event","promptTitle","preventDefault","stopPropagation","needDeleted","page","Loc","getMessage","promptName","stopImmediatePropagation","needActivate","sharePromptCode","hide","onPopupDestroy","includes","setLoading","formData","setList","console","error","excludedCategoryCode","fetchPromptCategories","excludedCategoryListItemIndex","findIndex","code","splice","err","editPrompt","getLoader","tableFade","fetchPromptByCodePromise","method","loadPromptMasterExtensionPromise","Promise","all","results","PromptMasterPopup","PromptMasterPopupEvents","prompt","masterOptions","type","translate","icon","categories","Object","values","accessCodes","authorId","popup","popupEvents","unsubscribe","SAVE_SUCCESS","analyticFields","c_section","subscribe","tableUnfade","button","setClocking","favourite","message","action","getActionsPanel","getPanel","querySelector","dataset","actionWithoutQuotes","replaceAll","selectedSharePromptsCodes","getRows","getSelectedIds","gridId","isShowTour","Main","gridManager","getById","instance","getScrollContainer","Event","EventEmitter","Hint","init","sendData","tool","category","status","actionName","panel","attributesObserver","MutationObserver","selectActionButton","getControls","observe","childList","subtree","characterDataOldValue","attributes","attributeOldValue","attributeFilter","characterData","getValues","btn","addClass","removeClass","getData","loadGuideExtensionPromise","loadBannerDispatcherExtensionPromise","result","Guide","BannerDispatcher","critical","toQueue","onDone","guide","id","simpleMode","overlay","onEvents","autoSave","steps","save","start","currentPageElement","Number","parseInt","callback","dataWithAction","getActionKey","reloadTable"],"mappings":"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"}