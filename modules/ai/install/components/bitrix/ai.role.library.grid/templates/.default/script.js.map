{"version":3,"file":"script.js","sources":["src/list-renderer.js","src/helpers.js","src/shares-list-renderer.js","src/popup-with-loader.js","src/index.js"],"sourcesContent":["export class ListRenderer\n{\n\trender() {}\n}\n","import { Runtime, Tag, Type } from 'main.core';\n\nexport async function showNotification(content: string | HTMLElement): void\n{\n\tRuntime.loadExtension('ui.notification')\n\t\t.then(({ BX }) => {\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent,\n\t\t\t});\n\t\t})\n\t\t.catch(() => {\n\t\t\tif (Type.isElementNode(content))\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line @bitrix24/bitrix24-rules/no-native-dialogs,no-alert\n\t\t\t\talert(content.innerText);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line @bitrix24/bitrix24-rules/no-native-dialogs,no-alert\n\t\t\t\talert(content);\n\t\t\t}\n\t\t});\n}\n\nexport function highlightText(text: string, searchTerm: string): string\n{\n\tif (!searchTerm || !text)\n\t{\n\t\treturn text;\n\t}\n\n\tconst lowerSearchTerm = searchTerm.toLowerCase();\n\n\tconst regex = new RegExp(lowerSearchTerm, 'gi');\n\n\treturn text.replace(regex, (match) => `<mark>${match}</mark>`);\n}\n\nexport function wrapTextToHtmlWithWordBreak(text: string): HTMLElement\n{\n\treturn Tag.render`<span style=\"word-break: break-word;\">${text}</span>`;\n}\n","import { Tag, Type, Text } from 'main.core';\nimport { ListRenderer } from './list-renderer';\nimport { highlightText } from './helpers';\n\ntype SharesListItem = {\n\tname: string;\n\timg: ?string;\n}\n\nexport class SharesListRenderer extends ListRenderer\n{\n\trender(sharesList: SharesListItem[], searchValue: string): HTMLElement\n\t{\n\t\tconst search = searchValue || null;\n\t\tconst itemsElements = sharesList.map((item: SharesListItem) => {\n\t\t\tconst encodedName = Text.encode(item.name);\n\n\t\t\tconst highlightedName = highlightText(encodedName, search);\n\n\t\t\treturn Tag.render`\n\t\t\t\t<li class=\"ai__role-library-grid-shares-popup_shares-list-item\">\n\t\t\t\t\t<div class=\"ai__role-library-grid-shares-popup_shares-list-item-avatar\">\n\t\t\t\t\t\t${this.#renderShareItemImg(item)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ai__role-library-grid-shares-popup_shares-list-item-title\">\n\t\t\t\t\t\t${highlightedName}\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t`;\n\t\t});\n\n\t\treturn Tag.render`<ul class=\"ai__role-library-grid-shares-popup_shares-list\">${itemsElements}</ul>`;\n\t}\n\n\t#renderShareItemImg(shareItem: SharesListItem): HTMLElement\n\t{\n\t\tif (Type.isStringFilled(shareItem.img))\n\t\t{\n\t\t\treturn Tag.render`<img src=\"${shareItem.img}\" alt=\"${shareItem.name}\" />`;\n\t\t}\n\n\t\treturn this.#renderShareItemInitials(shareItem.name);\n\t}\n\n\t#renderShareItemInitials(title: string): HTMLElement\n\t{\n\t\tif (!title)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst initials = title\n\t\t\t.split(' ')\n\t\t\t.slice(0, 2)\n\t\t\t.map((titleWord: string) => {\n\t\t\t\treturn titleWord[0].toUpperCase();\n\t\t\t})\n\t\t\t.join('');\n\n\t\treturn Tag.render`<span class=\"ai__role-library-grid-shares-popup_shares-list-item-initials\">${initials}</span>`;\n\t}\n}\n","import { bind, Tag, Dom } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Loader } from 'main.loader';\nimport { ListRenderer } from './list-renderer';\n\nexport type PopupWithLoaderOptions = {\n\tbindElement: HTMLElement;\n\tlistRenderer: ListRenderer;\n\tevents?: Object;\n\tfilter?: Function;\n\tuseSearch?: boolean;\n}\n\nexport class PopupWithLoader\n{\n\t#bindElement: HTMLElement = null;\n\t#popupContent: {root: HTMLElement, listContainer: HTMLElement};\n\t#isLoading: boolean = false;\n\t#popup: Popup = null;\n\t#list: string[] = [];\n\t#listRenderer: ListRenderer;\n\t#events: Object;\n\t#useSearch: boolean;\n\t#searchValue: string = '';\n\t#filter: Function | null;\n\n\tconstructor(options: PopupWithLoaderOptions)\n\t{\n\t\tthis.#bindElement = options.bindElement;\n\t\tthis.#listRenderer = options.listRenderer;\n\t\tthis.#events = options.events || {};\n\t\tthis.#filter = options.filter || null;\n\t\tthis.#useSearch = options.useSearch === true;\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tthis.#initPopup();\n\t\t}\n\n\t\tthis.#popup.show();\n\n\t\tif (this.#isLoading)\n\t\t{\n\t\t\tconst copilotColor = getComputedStyle(document.body).getPropertyValue('--ui-color-copilot-primary');\n\n\t\t\tconst loader = new Loader({\n\t\t\t\ttarget: this.#popupContent,\n\t\t\t\tsize: 30,\n\t\t\t\tcolor: copilotColor,\n\t\t\t});\n\n\t\t\tloader.show(this.#popupContent.root);\n\t\t}\n\t}\n\n\thide(): void\n\t{\n\t\tthis.#popup?.destroy();\n\t\tthis.#popup = null;\n\t\tthis.#popupContent = null;\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn Boolean(this.#popup?.isShown());\n\t}\n\n\tsetLoading(isLoading: boolean): void\n\t{\n\t\tthis.#isLoading = isLoading;\n\t}\n\n\tsetList(list: string[])\n\t{\n\t\tthis.#list = list;\n\n\t\tif (this.#popup)\n\t\t{\n\t\t\tthis.#popup.setContent(this.#renderPopupContent());\n\t\t}\n\t}\n\n\t#initPopup()\n\t{\n\t\tthis.#popup = new Popup({\n\t\t\tbindElement: this.#bindElement,\n\t\t\tcacheable: false,\n\t\t\tclassName: 'ai__share-role-library-grid_popup-with-more-info',\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t},\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcontent: this.#renderPopupContent(),\n\t\t\twidth: 285,\n\t\t\tminHeight: 190,\n\t\t\tmaxHeight: 300,\n\t\t\tpadding: 16,\n\t\t\tcontentPadding: 0,\n\t\t\tevents: {\n\t\t\t\t...this.#events,\n\t\t\t},\n\t\t});\n\t}\n\n\t#renderPopupContent(): HTMLElement\n\t{\n\t\tconst listWithSearchClassnameModifier = this.#useSearch ? '--with-search' : '';\n\n\t\tthis.#popupContent = Tag.render`\n\t\t\t<div class=\"ai__role-library_info-popup\">\n\t\t\t\t${this.#renderSearch()}\n\t\t\t\t<div class=\"ai__role-library_info-popup_list ${listWithSearchClassnameModifier}\" ref=\"listContainer\">\n\t\t\t\t\t${this.#renderList()}\n\t\t\t\t</div>\n\t\t\t<div>\n\t\t`;\n\n\t\treturn this.#popupContent.root;\n\t}\n\n\t#renderList(): HTMLElement\n\t{\n\t\tconst list = this.#list.filter((item) => {\n\t\t\tif (this.#filter)\n\t\t\t{\n\t\t\t\treturn this.#filter(item, this.#searchValue);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\n\t\treturn this.#listRenderer.render(list, this.#searchValue);\n\t}\n\n\t#updateList(): void\n\t{\n\t\tif (this.#popupContent.listContainer)\n\t\t{\n\t\t\tthis.#popupContent.listContainer.innerHTML = '';\n\t\t\tDom.append(this.#renderList(), this.#popupContent.listContainer);\n\t\t}\n\t}\n\n\t#renderSearch(): HTMLElement\n\t{\n\t\tif (this.#useSearch === false)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst container = Tag.render`\n\t\t\t<div class=\"ai__role-library_info-popup_search\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-before-icon ui-ctl-after-icon\">\n\t\t\t\t\t<div class=\"ui-ctl-before ui-ctl-icon-search\"></div>\n\t\t\t\t\t<button ref=\"clear\" class=\"ui-ctl-after ui-ctl-icon-clear\"></button>\n\t\t\t\t\t<input ref=\"input\" type=\"text\" class=\"ui-ctl-element\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tbind(container.clear, 'click', () => {\n\t\t\tcontainer.input.value = '';\n\t\t\tthis.#searchValue = '';\n\t\t\tthis.#updateList();\n\t\t});\n\n\t\tbind(container.input, 'input', (e) => {\n\t\t\tthis.#searchValue = e.target.value;\n\t\t\tthis.#updateList();\n\t\t});\n\n\t\treturn container.root;\n\t}\n}\n","import { BaseEvent } from 'main.core.events';\nimport { type BannerDispatcher as BannerDispatcherType } from 'ui.banner-dispatcher';\nimport { SharesListRenderer } from './shares-list-renderer';\nimport { PopupWithLoader } from './popup-with-loader';\nimport { ajax, bind, Runtime, Loc, Event, Dom, Text } from 'main.core';\nimport { showNotification, wrapTextToHtmlWithWordBreak } from './helpers';\nimport { sendData } from 'ui.analytics';\nimport { type Guide as GuideType } from 'ui.tour';\nimport type { RoleMasterPopupOptions } from 'ai.role-master';\n\nexport class Controller\n{\n\t/**\n\t * @var BX.Main.Grid\n\t */\n\tstatic #grid;\n\tstatic #categoriesListPopup: PopupWithLoader = null;\n\tstatic #allSharesListPopup: PopupWithLoader = null;\n\tstatic #roleSuccessSavingEventHandler: Function = null;\n\n\tstatic handleClickOnDeleteRoleSwitcher(event: PointerEvent, roleCode: string, roleName: string): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tthis.#sendRowAction('toggle-deleted', {\n\t\t\troleCode,\n\t\t\tneedDeleted: 1,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(\n\t\t\t\tLoc.getMessage(\n\t\t\t\t\t'ROLE_LIBRARY_GRID_NOTIFICATION_HIDE',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(roleName)}</b>` },\n\t\t\t\t),\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic handleClickOnUndoDeleteRoleSwitcher(event: PointerEvent, roleCode: string, roleName: string): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tthis.#sendRowAction('toggle-deleted', {\n\t\t\troleCode,\n\t\t\tneedDeleted: 0,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(\n\t\t\t\tLoc.getMessage(\n\t\t\t\t\t'ROLE_LIBRARY_GRID_NOTIFICATION_SHOW',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(roleName)}</b>` },\n\t\t\t\t),\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic handleClickOnActivateRoleMenuItem(event: PointerEvent, roleCode: string, roleName: string): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\n\t\tthis.#sendRowAction('toggle-active', {\n\t\t\troleCode,\n\t\t\tneedActivate: 1,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(\n\t\t\t\twrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'ROLE_LIBRARY_GRID_NOTIFICATION_ACTIVATE',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(roleName)}</b>` },\n\t\t\t\t)),\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic handleClickOnDeactivateRoleMenuItem(event: PointerEvent, roleCode: string, roleName: string): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\n\t\tthis.#sendRowAction('toggle-active', {\n\t\t\troleCode,\n\t\t\tneedActivate: 0,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(\n\t\t\t\twrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'ROLE_LIBRARY_GRID_NOTIFICATION_DEACTIVATE',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(roleName)}</b>` },\n\t\t\t\t)),\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic async handleClickOnRoleName(event: PointerEvent, roleCode: string): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\n\t\tthis.editRole(roleCode);\n\t}\n\n\tstatic async editRole(roleCode: string): void\n\t{\n\t\tthis.#grid.getLoader().show();\n\t\tthis.#grid.tableFade();\n\t\tconst formData = new FormData();\n\t\tformData.append('roleCode', roleCode);\n\n\t\tconst fetchRoleByCodePromise = ajax.runAction('ai.shareRole.getRoleByCodeForUpdate', {\n\t\t\tmethod: 'POST',\n\t\t\tdata: formData,\n\t\t});\n\n\t\tconst loadRoleMasterExtensionPromise = Runtime.loadExtension('ai.role-master');\n\n\t\ttry\n\t\t{\n\t\t\tconst results = await Promise.all([fetchRoleByCodePromise, loadRoleMasterExtensionPromise]);\n\t\t\tconst res = results[0];\n\t\t\tconst RoleMasterPopup = results[1].RoleMasterPopup;\n\t\t\tconst RoleMasterPopupEvents = results[1].RoleMasterPopupEvents;\n\n\t\t\tconst role = res.data.role;\n\t\t\tconst options: RoleMasterPopupOptions = {\n\t\t\t\troleMaster: {\n\t\t\t\t\tid: role.code,\n\t\t\t\t\ttext: role.instruction,\n\t\t\t\t\tname: role.nameTranslate,\n\t\t\t\t\tavatar: role.avatar,\n\t\t\t\t\tavatarUrl: role.avatarUrl,\n\t\t\t\t\titemsWithAccess: role.accessCodes,\n\t\t\t\t\tauthorId: role.authorId,\n\t\t\t\t\tdescription: role.descriptionTranslate,\n\t\t\t\t},\n\t\t\t};\n\t\t\tconst popup = new RoleMasterPopup({\n\t\t\t\t...options,\n\t\t\t\tpopupEvents: {\n\t\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\t\tpopup.unsubscribe(RoleMasterPopupEvents.SAVE_SUCCESS, Controller.#roleSuccessSavingEventHandler);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tanalyticFields: {\n\t\t\t\t\tc_section: 'list',\n\t\t\t\t},\n\t\t\t});\n\t\t\tController.#roleSuccessSavingEventHandler = Controller.#handleRoleSuccessSaving.bind(Controller);\n\n\t\t\tpopup.subscribe(RoleMasterPopupEvents.SAVE_SUCCESS, Controller.#roleSuccessSavingEventHandler);\n\n\t\t\tpopup.show();\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\n\t\t\tshowNotification(Loc.getMessage('ROLE_LIBRARY_GRID_ACTION_OPEN_EDIT_MASTER_ERROR'));\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tthis.#grid.getLoader().hide();\n\t\t\tthis.#grid.tableUnfade();\n\t\t}\n\t}\n\n\tstatic async handleClickOnCreateRoleButton(button: Button): void\n\t{\n\t\ttry\n\t\t{\n\t\t\tbutton.setClocking(true);\n\t\t\tconst { RoleMasterPopup, RoleMasterPopupEvents } = await Runtime.loadExtension('ai.role-master');\n\t\t\tconst popup = new RoleMasterPopup({\n\t\t\t\tpopupEvents: {\n\t\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\t\tpopup.unsubscribe(\n\t\t\t\t\t\t\tRoleMasterPopupEvents.SAVE_SUCCESS,\n\t\t\t\t\t\t\tController.#roleSuccessSavingEventHandler,\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tanalyticFields: {\n\t\t\t\t\tc_section: 'list',\n\t\t\t\t},\n\t\t\t});\n\t\t\tController.#roleSuccessSavingEventHandler = Controller.#handleRoleSuccessSaving.bind(Controller);\n\n\t\t\tpopup.subscribe(RoleMasterPopupEvents.SAVE_SUCCESS, Controller.#roleSuccessSavingEventHandler);\n\n\t\t\tpopup.show();\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\t\t\tshowNotification(Loc.getMessage('ROLE_LIBRARY_GRID_NOTIFICATION_ROLE_MASTER_OPEN_ERROR'));\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tbutton.setClocking(false);\n\t\t}\n\t}\n\n\tstatic handleClickOnRoleIsFavouriteLabel(\n\t\tevent: PointerEvent,\n\t\troleCode: string,\n\t\tfavourite: 'true' | 'false',\n\t\troleName: string,\n\t): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\n\t\tthis.#sendRowAction('toggle-favourite', {\n\t\t\troleCode,\n\t\t\tfavourite,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tconst message = favourite === 'true'\n\t\t\t\t? wrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'ROLE_LIBRARY_GRID_NOTIFICATION_FAVOURITE_ADD',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(roleName)}</b>` },\n\t\t\t\t))\n\t\t\t\t: wrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'ROLE_LIBRARY_GRID_NOTIFICATION_FAVOURITE_REMOVE',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(roleName)}</b>` },\n\t\t\t\t))\n\t\t\t;\n\n\t\t\tshowNotification(message);\n\t\t});\n\t}\n\n\tstatic toggleRoleFavourite(roleCode: string, favourite: boolean, roleName: string): void\n\t{\n\t\tthis.#sendRowAction('toggle-favourite', {\n\t\t\troleCode,\n\t\t\tfavourite,\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tconst message = favourite === 'true'\n\t\t\t\t? wrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'ROLE_LIBRARY_GRID_NOTIFICATION_FAVOURITE_ADD',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(roleName)}</b>` },\n\t\t\t\t))\n\t\t\t\t: wrapTextToHtmlWithWordBreak(Loc.getMessage(\n\t\t\t\t\t'ROLE_LIBRARY_GRID_NOTIFICATION_FAVOURITE_REMOVE',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(roleName)}</b>` },\n\t\t\t\t))\n\t\t\t;\n\n\t\t\tshowNotification(message);\n\t\t});\n\t}\n\n\tstatic applyMultipleAction(): void\n\t{\n\t\tconst action = this.#grid.getActionsPanel().getPanel().querySelector('#action-menu span').dataset.value;\n\n\t\tconst actionWithoutQuotes = action.replaceAll('\"', '');\n\n\t\tconst message = this.#getNotificationMessageForMassAction(actionWithoutQuotes);\n\n\t\tthis.#sendRowAction(actionWithoutQuotes, {\n\t\t\tselectedShareRolesCodes: this.#grid.getRows().getSelectedIds(),\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(message);\n\t\t});\n\t}\n\n\tstatic #getNotificationMessageForMassAction(actionName: string): string\n\t{\n\t\tswitch (actionName)\n\t\t{\n\t\t\tcase 'multiple-activate':\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('ROLE_LIBRARY_GRID_NOTIFICATION_MASS_ACTIVATE');\n\t\t\t}\n\n\t\t\tcase 'multiple-deactivate':\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('ROLE_LIBRARY_GRID_NOTIFICATION_MASS_DEACTIVATE');\n\t\t\t}\n\n\t\t\tcase 'multiple-show-for-me':\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('ROLE_LIBRARY_GRID_NOTIFICATION_MASS_SHOW');\n\t\t\t}\n\n\t\t\tcase 'multiple-hide-from-me':\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('ROLE_LIBRARY_GRID_NOTIFICATION_MASS_HIDE');\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('ROLE_LIBRARY_GRID_NOTIFICATION_MASS_ACTION_DEFAULT');\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic init(gridId: string, isShowTour: boolean = false)\n\t{\n\t\tif (isShowTour)\n\t\t{\n\t\t\tthis.#showSimpleTour();\n\t\t}\n\n\t\tthis.#grid = BX.Main.gridManager.getById(gridId)?.instance;\n\n\t\tbind(this.#grid.getScrollContainer(), 'scroll', () => {\n\t\t\tthis.#categoriesListPopup?.hide();\n\t\t\tthis.#allSharesListPopup?.hide();\n\t\t});\n\n\t\tController.#updateApplyButtonClassname();\n\t\tController.#observeSelectActionButtonValue();\n\n\t\tEvent.EventEmitter.subscribe('Grid::updated', () => {\n\t\t\tController.#updateApplyButtonClassname();\n\t\t\tController.#observeSelectActionButtonValue();\n\t\t\tBX.UI.Hint.init(BX('main-grid-table'));\n\t\t});\n\n\t\tEvent.EventEmitter.subscribe('BX.Main.Filter:apply', () => {\n\t\t\tsendData({\n\t\t\t\ttool: 'ai',\n\t\t\t\tcategory: 'roles_saving',\n\t\t\t\tevent: 'use_filter',\n\t\t\t\tc_section: 'list',\n\t\t\t\tstatus: 'success',\n\t\t\t});\n\t\t});\n\n\t\tBX.UI.Hint.init(BX('main-grid-table'));\n\t}\n\n\tstatic async handleClickOnSharesCell(shareRoleCode: string, event: PointerEvent): void\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\n\t\tif (this.#allSharesListPopup)\n\t\t{\n\t\t\tthis.#allSharesListPopup.hide();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#allSharesListPopup = new PopupWithLoader({\n\t\t\tbindElement: event.target,\n\t\t\tlistRenderer: new SharesListRenderer(),\n\t\t\tevents: {\n\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\tthis.#allSharesListPopup = null;\n\t\t\t\t},\n\t\t\t},\n\t\t\tfilter: (item: {code: string, name: string}, searchValue: string) => {\n\t\t\t\treturn item.name.toLowerCase().includes(searchValue?.toLowerCase());\n\t\t\t},\n\t\t\tuseSearch: true,\n\t\t});\n\n\t\ttry\n\t\t{\n\t\t\tthis.#allSharesListPopup.setLoading(true);\n\t\t\tthis.#allSharesListPopup.show();\n\n\t\t\tconst formData = new FormData();\n\n\t\t\tformData.append('roleCode', shareRoleCode);\n\n\t\t\tconst res = await ajax.runAction('ai.shareRole.getShareForRole', {\n\t\t\t\tdata: formData,\n\t\t\t});\n\n\t\t\tconst list = res.data.list;\n\t\t\tthis.#allSharesListPopup.setList(list.slice(5));\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\t\t\tawait showNotification(Loc.getMessage('ROLE_LIBRARY_GRID_NOTIFICATION_SHOW_ROLE_USERS_ERROR'));\n\t\t\tthis.#allSharesListPopup.hide();\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tthis.#allSharesListPopup.setLoading(false);\n\t\t}\n\t}\n\n\tstatic #observeSelectActionButtonValue(): void\n\t{\n\t\tconst panel = this.#grid.getActionsPanel();\n\n\t\tif (!panel)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst attributesObserver = new MutationObserver(() => {\n\t\t\tController.#updateApplyButtonClassname();\n\t\t});\n\n\t\tconst selectActionButton = panel.getControls()[0];\n\n\t\tattributesObserver.observe(selectActionButton, {\n\t\t\tchildList: false,\n\t\t\tsubtree: true,\n\t\t\tcharacterDataOldValue: false,\n\t\t\tattributes: true,\n\t\t\tattributeOldValue: true,\n\t\t\tattributeFilter: ['data-value'],\n\t\t\tcharacterData: false,\n\t\t});\n\t}\n\n\tstatic #updateApplyButtonClassname(): void\n\t{\n\t\tconst panel = this.#grid.getActionsPanel();\n\n\t\tif (!panel)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst values = panel.getValues();\n\n\t\tconst btn = panel.getPanel().querySelector('#apply_button_control.ui-btn');\n\n\t\tconst action = values['action-menu'];\n\n\t\tif (action === '\"select-action\"' || action === 'select-action')\n\t\t{\n\t\t\tDom.addClass(btn, 'ui-btn-disabled');\n\t\t\tDom.addClass(btn, 'ai__role-library-grid_share-initials');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(btn, 'ui-btn-disabled');\n\t\t\tDom.removeClass(btn, 'ai__role-library-grid_share-initials');\n\t\t}\n\t}\n\n\tstatic #handleRoleSuccessSaving(event: BaseEvent): void\n\t{\n\t\tthis.#sendRowAction('edit-role', {\n\t\t\tpage: this.#getCurrentPage(),\n\t\t}, () => {\n\t\t\tshowNotification(\n\t\t\t\tLoc.getMessage(\n\t\t\t\t\t'ROLE_LIBRARY_GRID_NOTIFICATION_ROLE_SAVE_SUCCESS',\n\t\t\t\t\t{ '#NAME#': `<b>${Text.encode(event.getData().roleTitle)}</b>` },\n\t\t\t\t),\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic async #showSimpleTour(): void\n\t{\n\t\tconst loadGuideExtensionPromise = Runtime.loadExtension('ui.tour');\n\t\tconst loadBannerDispatcherExtensionPromise = Runtime.loadExtension('ui.banner-dispatcher');\n\n\t\tconst result = await Promise.all([loadGuideExtensionPromise, loadBannerDispatcherExtensionPromise]);\n\n\t\tconst Guide = result[0].Guide;\n\t\tconst BannerDispatcher: BannerDispatcherType = result[1].BannerDispatcher;\n\n\t\tBannerDispatcher.critical.toQueue((onDone) => {\n\t\t\tconst guide: GuideType = new Guide({\n\t\t\t\tid: 'share-role-grid-create-prompt-hint',\n\t\t\t\tsimpleMode: true,\n\t\t\t\toverlay: false,\n\t\t\t\tonEvents: true,\n\t\t\t\tautoSave: true,\n\t\t\t\tsteps: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttarget: '.ui-btn.ui-btn-success',\n\t\t\t\t\t\ttitle: Loc.getMessage('ROLE_LIBRARY_GRID_TOUR_TITLE'),\n\t\t\t\t\t\ttext: Loc.getMessage('ROLE_LIBRARY_GRID_TOUR_DESCRIPTION'),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\n\t\t\tEvent.EventEmitter.subscribe('UI.Tour.Guide:onFinish', () => {\n\t\t\t\tguide.save();\n\t\t\t\tonDone();\n\t\t\t});\n\n\t\t\tguide.start();\n\t\t});\n\t}\n\n\tstatic #getCurrentPage(): number\n\t{\n\t\tconst currentPageElement = document.body.querySelector('.main-ui-pagination-page.main-ui-pagination-active');\n\n\t\treturn Number.parseInt(currentPageElement?.innerText, 10) || 1;\n\t}\n\n\tstatic #sendRowAction(action: string, data: Object, callback: Function): void\n\t{\n\t\tconst dataWithAction = {\n\t\t\t[this.#grid.getActionKey()]: action,\n\t\t\t...data,\n\t\t};\n\n\t\tthis.#grid.reloadTable('POST', dataWithAction, callback);\n\t}\n}\n"],"names":["ListRenderer","showNotification","content","Runtime","loadExtension","then","BX","UI","Notification","Center","notify","Type","isElementNode","alert","innerText","highlightText","text","searchTerm","lowerSearchTerm","toLowerCase","regex","RegExp","replace","match","wrapTextToHtmlWithWordBreak","Tag","render","SharesListRenderer","sharesList","searchValue","search","itemsElements","map","item","encodedName","Text","encode","name","highlightedName","shareItem","isStringFilled","img","title","initials","split","slice","titleWord","toUpperCase","join","PopupWithLoader","options","_classPrivateMethodInitSpec","bindElement","listRenderer","events","filter","useSearch","_classPrivateMethodGet","show","copilotColor","getComputedStyle","document","body","getPropertyValue","loader","Loader","target","size","color","root","destroy","Boolean","isShown","isLoading","list","setContent","Popup","cacheable","className","angle","position","autoHide","closeByEsc","width","minHeight","maxHeight","padding","contentPadding","listWithSearchClassnameModifier","listContainer","innerHTML","Dom","append","container","bind","clear","input","value","e","Controller","event","roleCode","roleName","preventDefault","stopPropagation","needDeleted","page","Loc","getMessage","stopImmediatePropagation","needActivate","editRole","getLoader","tableFade","formData","FormData","fetchRoleByCodePromise","ajax","runAction","method","data","loadRoleMasterExtensionPromise","Promise","all","results","res","RoleMasterPopup","RoleMasterPopupEvents","role","roleMaster","id","code","instruction","nameTranslate","avatar","avatarUrl","itemsWithAccess","accessCodes","authorId","description","descriptionTranslate","popup","popupEvents","onPopupDestroy","unsubscribe","SAVE_SUCCESS","analyticFields","c_section","subscribe","console","error","hide","tableUnfade","button","setClocking","favourite","message","action","getActionsPanel","getPanel","querySelector","dataset","actionWithoutQuotes","replaceAll","selectedShareRolesCodes","getRows","getSelectedIds","gridId","isShowTour","Main","gridManager","getById","instance","getScrollContainer","Event","EventEmitter","Hint","init","sendData","tool","category","status","shareRoleCode","includes","setLoading","setList","actionName","panel","attributesObserver","MutationObserver","selectActionButton","getControls","observe","childList","subtree","characterDataOldValue","attributes","attributeOldValue","attributeFilter","characterData","values","getValues","btn","addClass","removeClass","getData","roleTitle","loadGuideExtensionPromise","loadBannerDispatcherExtensionPromise","result","Guide","BannerDispatcher","critical","toQueue","onDone","guide","simpleMode","overlay","onEvents","autoSave","steps","save","start","currentPageElement","Number","parseInt","callback","dataWithAction","getActionKey","reloadTable"],"mappings":"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"}