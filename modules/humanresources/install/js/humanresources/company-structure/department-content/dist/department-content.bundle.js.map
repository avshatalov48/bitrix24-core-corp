{"version":3,"file":"department-content.bundle.js","sources":["../src/api.js","../src/components/users/list/item/move-user-action-popup.js","../src/components/users/list/item/action-button.js","../src/components/users/list/item/item.js","../src/components/users/list/list.js","../src/components/users/list/list-action-button.js","../src/components/users/empty-state-types.js","../src/components/users/empty-state-container.js","../src/components/users/tab.js","../src/components/chat/tab.js","../src/components/department-content.js"],"sourcesContent":["import { getData, postData } from 'humanresources.company-structure.api';\n\nexport const DepartmentAPI = {\n\tgetPagedEmployees: (id: Number, page: Number, countPerPage: Number) => {\n\t\treturn getData('humanresources.api.Structure.Node.Member.Employee.list', { nodeId: id, page, countPerPage });\n\t},\n\tremoveUserFromDepartment: (nodeId: number, userId: number): Promise<void> => {\n\t\treturn postData('humanresources.api.Structure.Node.Member.deleteUser', {\n\t\t\tnodeId,\n\t\t\tuserId,\n\t\t});\n\t},\n\tmoveUserToDepartment: (nodeId: number, userId: number, targetNodeId: number,): Promise<void> => {\n\t\treturn postData('humanresources.api.Structure.Node.Member.moveUser', {\n\t\t\tnodeId,\n\t\t\tuserId,\n\t\t\ttargetNodeId,\n\t\t});\n\t},\n\tisUserInMultipleDepartments: (userId: number): Promise<void> => {\n\t\treturn getData('humanresources.api.User.isUserInMultipleDepartments', {\n\t\t\tuserId,\n\t\t});\n\t},\n\tgetUserInfo: (nodeId: number, userId: number): Promise<void> => {\n\t\treturn getData('humanresources.api.User.getInfoByUserMember', {\n\t\t\tnodeId,\n\t\t\tuserId,\n\t\t});\n\t},\n\tfindMemberByQuery: (nodeId: number, query: string): Promise<void> => {\n\t\treturn getData('humanresources.api.Structure.Node.Member.find', {\n\t\t\tnodeId,\n\t\t\tquery,\n\t\t});\n\t},\n};\n","import { ConfirmationPopup } from 'humanresources.company-structure.structure-components';\nimport { Text } from 'main.core';\nimport { TagSelector } from 'ui.entity-selector';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { moveUserStoreToAnotherDepartment } from 'humanresources.company-structure.utils';\nimport { memberRoles } from 'humanresources.company-structure.api';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { DepartmentAPI } from '../../../../api';\nimport { UI } from 'ui.notification';\n\nexport const MoveUserActionPopup = {\n\tname: 'MoveUserActionPopup',\n\tcomponents: { ConfirmationPopup },\n\temits: ['close', 'action'],\n\n\tprops: {\n\t\tparentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tuser: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\trole: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: memberRoles.employee,\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.permissionChecker = PermissionChecker.getInstance();\n\n\t\tif (!this.permissionChecker)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.action = PermissionActions.employeeAddToDepartment;\n\t\tthis.selectedDepartmentId = 0;\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tshowMoveUserActionLoader: false,\n\t\t\tlockMoveUserActionButton: false,\n\t\t\tshowUserAlreadyBelongsToDepartmentPopup: false,\n\t\t\taccessDenied: false,\n\t\t};\n\t},\n\n\tmounted(): void\n\t{\n\t\tconst departmentContainer = this.$refs['department-selector'];\n\t\tthis.departmentSelector = this.getTagSelector(departmentContainer);\n\t\tthis.departmentSelector.renderTo(departmentContainer);\n\t},\n\n\tcomputed: {\n\t\t...mapState(useChartStore, ['departments', 'focusedNode']),\n\t\tgetMoveUserActionPhrase(): string\n\t\t{\n\t\t\tconst departmentName = Text.encode(this.departments.get(this.focusedNode).name ?? '');\n\t\t\tconst userName = Text.encode(this.user.name ?? '');\n\n\t\t\treturn this.loc(\n\t\t\t\t'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_POPUP_ACTION_REMOVE_USER_DESCRIPTION',\n\t\t\t\t{\n\t\t\t\t\t'#LINK_START#': `<a class=\"hr-department-detail-content__move-user-department-user-link\" href=\"${this.user.url}\">`,\n\t\t\t\t\t'#LINK_END#': '</a>',\n\t\t\t\t\t'#USER_NAME': userName,\n\t\t\t\t\t'#DEPARTMENT_NAME': departmentName,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tgetUserAlreadyBelongsToDepartmentPopupPhrase(): string\n\t\t{\n\t\t\tconst departmentName = Text.encode(this.departments.get(this.selectedParentDepartment ?? 0).name ?? '');\n\t\t\tconst userName = Text.encode(this.user.name ?? '');\n\n\t\t\treturn this.loc(\n\t\t\t\t'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_ALREADY_BELONGS_TO_DEPARTMENT_DESCRIPTION',\n\t\t\t\t{\n\t\t\t\t\t'#LINK_START#': `<a class=\"hr-department-detail-content__move-user-department-user-link\" href=\"${this.user.url}\">`,\n\t\t\t\t\t'#LINK_END#': '</a>',\n\t\t\t\t\t'#USER_NAME': userName,\n\t\t\t\t\t'#DEPARTMENT_NAME': departmentName,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tmemberRoles(): typeof memberRoles\n\t\t{\n\t\t\treturn memberRoles;\n\t\t},\n\t},\n\n\tmethods: {\n\t\tgetTagSelector(): TagSelector\n\t\t{\n\t\t\treturn new TagSelector({\n\t\t\t\tevents: {\n\t\t\t\t\tonTagAdd: (event: BaseEvent) => {\n\t\t\t\t\t\tthis.accessDenied = false;\n\t\t\t\t\t\tconst { tag } = event.data;\n\t\t\t\t\t\tthis.selectedParentDepartment = tag.id;\n\t\t\t\t\t\tif (PermissionChecker.hasPermission(this.action, tag.id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.lockMoveUserActionButton = false;\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.accessDenied = true;\n\t\t\t\t\t\tthis.lockMoveUserActionButton = true;\n\t\t\t\t\t},\n\t\t\t\t\tonTagRemove: () => {\n\t\t\t\t\t\tthis.lockMoveUserActionButton = true;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmultiple: false,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\twidth: 425,\n\t\t\t\t\theight: 350,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\thideOnDeselect: true,\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'structure-node',\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tselectMode: 'departmentsOnly',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tpreselectedItems: [['structure-node', this.parentId]],\n\t\t\t\t},\n\t\t\t\ttagBgColor: '#ade7e4',\n\t\t\t\ttagTextColor: '#207976',\n\t\t\t\ttagFontWeight: '700',\n\t\t\t\ttagAvatar: '/bitrix/js/humanresources/entity-selector/src/images/department.svg',\n\t\t\t});\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tasync confirmMoveUser(): Promise<void>\n\t\t{\n\t\t\tthis.showMoveUserActionLoader = true;\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tconst userId = this.user.id;\n\t\t\tconst targetNodeId = this.selectedParentDepartment;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait DepartmentAPI.moveUserToDepartment(\n\t\t\t\t\tnodeId,\n\t\t\t\t\tuserId,\n\t\t\t\t\ttargetNodeId,\n\t\t\t\t);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tthis.showMoveUserActionLoader = false;\n\n\t\t\t\tconst code = error.code ?? 0;\n\n\t\t\t\tif (code === 'MEMBER_ALREADY_BELONGS_TO_NODE')\n\t\t\t\t{\n\t\t\t\t\tthis.showUserAlreadyBelongsToDepartmentPopup = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_ERROR'),\n\t\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t\t});\n\t\t\t\t\tthis.$emit('close');\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst departmentName = Text.encode(this.departments.get(targetNodeId).name ?? '');\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: this.loc(\n\t\t\t\t\t'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_SUCCESS_MESSAGE',\n\t\t\t\t\t{\n\t\t\t\t\t\t'#DEPARTMENT_NAME': departmentName,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t\tautoHideDelay: 2000,\n\t\t\t});\n\n\t\t\tmoveUserStoreToAnotherDepartment(this.departments, nodeId, userId, targetNodeId, this.role);\n\t\t\tthis.$emit('action');\n\t\t\tthis.showMoveUserActionLoader = false;\n\t\t},\n\t\tcloseAction(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tcloseUserAlreadyBelongsToDepartmentPopup(): void\n\t\t{\n\t\t\tthis.showUserAlreadyBelongsToDepartmentPopup = false;\n\t\t\tthis.closeAction();\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<ConfirmationPopup\n\t\t\t@action=\"confirmMoveUser\"\n\t\t\t@close=\"closeAction\"\n\t\t\t:showActionButtonLoader=\"showMoveUserActionLoader\"\n\t\t\t:lockActionButton=\"lockMoveUserActionButton\"\n\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_POPUP_CONFIRM_TITLE')\"\n\t\t\t:confirmBtnText = \"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_POPUP_CONFIRM_BUTTON')\"\n\t\t\t:width=\"364\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<div class=\"hr-department-detail-content__user-action-text-container\">\n\t\t\t\t\t<div v-html=\"getMoveUserActionPhrase\"/>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_POPUP_ACTION_SELECT_DEPARTMENT_DESCRIPTION')}}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"hr-department-detail-content__move-user-department-selector\" ref=\"department-selector\"></div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"hr-department-detail-content__move-user-department-selector\"\n\t\t\t\t\tref=\"department-selector\"\n\t\t\t\t\t:class=\"{ 'ui-ctl-warning': accessDenied }\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"accessDenied\"\n\t\t\t\t\tclass=\"hr-department-detail-content__move-user-department_item-error\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-icon-set --warning\"></div>\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"hr-department-detail-content__move-user-department_item-error-message\"\n\t\t\t\t\t>\n\t\t\t\t\t\t\t{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_PERMISSION_ERROR')}}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</ConfirmationPopup>\n\t\t<ConfirmationPopup\n\t\t\t@action=\"closeUserAlreadyBelongsToDepartmentPopup\"\n\t\t\t@close=\"closeUserAlreadyBelongsToDepartmentPopup\"\n\t\t\tv-if=\"showUserAlreadyBelongsToDepartmentPopup\"\n\t\t\t:withoutTitleBar = true\n\t\t\t:onlyConfirmButtonMode = true\n\t\t\t:confirmBtnText = \"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_ALREADY_BELONGS_TO_DEPARTMENT_CLOSE_BUTTON')\"\n\t\t\t:width=\"300\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<div class=\"hr-department-detail-content__user-action-text-container\">\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"hr-department-detail-content__user-belongs-to-department-text-container\"\n\t\t\t\t\t\tv-html=\"getUserAlreadyBelongsToDepartmentPopupPhrase\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"hr-department-detail-content__move-user-department-selector\" ref=\"department-selector\"></div>\n\t\t\t</template>\n\t\t</ConfirmationPopup>\n\t`,\n};\n","import { RouteActionMenu, ConfirmationPopup } from 'humanresources.company-structure.structure-components';\nimport { Main } from 'ui.icon-set.api.core';\nimport { DepartmentAPI } from '../../../../api';\nimport { memberRoles } from 'humanresources.company-structure.api';\nimport { getColorCode, moveUserStoreToAnotherDepartment, removeUserFromStore } from 'humanresources.company-structure.utils';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { MoveUserActionPopup } from './move-user-action-popup';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { UI } from 'ui.notification';\n\nconst MenuOption = Object.freeze({\n\tremoveUserFromDepartment: 'removeUserFromDepartment',\n\tmoveUserToAnotherDepartment: 'moveUserToAnotherDepartment',\n\tfireUserFromCompany: 'fireUserFromCompany',\n});\n\nexport const UserListItemActionButton = {\n\tname: 'userList',\n\n\tprops: {\n\t\tuserId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tuser: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\trole: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: memberRoles.employee,\n\t\t},\n\t\tdepartmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t\tConfirmationPopup,\n\t\tMoveUserActionPopup,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: {},\n\t\t\tshowRemoveUserConfirmationPopup: false,\n\t\t\tshowRemoveUserConfirmationActionLoader: false,\n\t\t\tshowMoveUserPopup: false,\n\t\t};\n\t},\n\n\tmethods: {\n\t\ttoggleMenu(userId)\n\t\t{\n\t\t\tthis.menuVisible[userId] = !this.menuVisible[userId];\n\t\t},\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tif (actionId === MenuOption.removeUserFromDepartment)\n\t\t\t{\n\t\t\t\tthis.showRemoveUserConfirmationPopup = true;\n\t\t\t}\n\n\t\t\tif (actionId === MenuOption.moveUserToAnotherDepartment)\n\t\t\t{\n\t\t\t\tthis.showMoveUserPopup = true;\n\t\t\t}\n\t\t},\n\t\tasync removeUser(): Promise<void>\n\t\t{\n\t\t\tthis.showRemoveUserConfirmationActionLoader = true;\n\t\t\tconst userId = this.userId;\n\t\t\tconst isUserInMultipleDepartments = await DepartmentAPI.isUserInMultipleDepartments(userId);\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tthis.showRemoveUserConfirmationActionLoader = false;\n\t\t\tthis.showRemoveUserConfirmationPopup = false;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait DepartmentAPI.removeUserFromDepartment(nodeId, userId);\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_ERROR'),\n\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (isUserInMultipleDepartments)\n\t\t\t{\n\t\t\t\tremoveUserFromStore(this.departments, nodeId, userId, this.role);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst rootDepartment = [...this.departments.values()].find((department) => department.parentId === 0);\n\t\t\tif (!rootDepartment)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmoveUserStoreToAnotherDepartment(this.departments, nodeId, userId, rootDepartment.id, this.role);\n\t\t},\n\t\tcancelRemoveUser(): void\n\t\t{\n\t\t\tthis.showRemoveUserConfirmationPopup = false;\n\t\t},\n\t\thandleMoveUserAction() {\n\t\t\tthis.showMoveUserPopup = false;\n\t\t},\n\t\thandleMoveUserClose() {\n\t\t\tthis.showMoveUserPopup = false;\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tconst permissionChecker = PermissionChecker.getInstance();\n\n\t\tconst menuItems = [\n\t\t\t{\n\t\t\t\tid: MenuOption.moveUserToAnotherDepartment,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.PERSON_ARROW_LEFT_1,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: {\n\t\t\t\t\taction: PermissionActions.employeeAddToDepartment,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuOption.removeUserFromDepartment,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.TRASH_BIN,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteRed40'),\n\t\t\t\t},\n\t\t\t\tpermission: {\n\t\t\t\t\taction: PermissionActions.employeeRemoveFromDepartment,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuOption.fireUserFromCompany,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_FIRE_FROM_COMPANY_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_FIRE_FROM_COMPANY_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.PERSONS_DENY,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteRed40'),\n\t\t\t\t},\n\t\t\t\tpermission: {\n\t\t\t\t\taction: PermissionActions.employeeFire,\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tthis.menuItems = menuItems.filter((item) => {\n\t\t\tif (!item.permission)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn permissionChecker.hasPermission(item.permission.action, this.departmentId);\n\t\t});\n\t},\n\n\tcomputed: {\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t\tmemberRoles(): typeof memberRoles\n\t\t{\n\t\t\treturn memberRoles;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<button \n\t\t\tv-if=\"menuItems.length\"\n\t\t\tclass=\"ui-icon-set --more hr-department-detail-content__user-action-btn\"\n\t\t\t:class=\"{ '--focused': menuVisible[userId] }\"\n\t\t\t@click.stop=\"toggleMenu(userId)\"\n\t\t\tref=\"actionUserButton\"\n\t\t/>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menuVisible[userId]\"\n\t\t\t:id=\"'tree-node-department-menu-' + userId\"\n\t\t\t:items=\"menuItems\"\n\t\t\t:width=\"302\"\n\t\t\t:bindElement=\"$refs.actionUserButton\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"menuVisible[userId] = false\"\n\t\t/>\n\t\t<ConfirmationPopup\n\t\t\tref=\"removeUserConfirmationPopup\"\n\t\t\tv-if=\"showRemoveUserConfirmationPopup\"\n\t\t\t:showActionButtonLoader=\"showRemoveUserConfirmationActionLoader\"\n\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_POPUP_TITLE')\"\n\t\t\t:description=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_POPUP_DESCRIPTION')\"\n\t\t\t:confirmBtnText = \"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_POPUP_CONFIRM_BUTTON')\"\n\t\t\t@action=\"removeUser\"\n\t\t\t@close=\"cancelRemoveUser\"\n\t\t/>\n\t\t<MoveUserActionPopup\n\t\t\tv-if=\"showMoveUserPopup\"\n\t\t\t:parentId=\"focusedNode\"\n\t\t\t:user=\"user\"\n\t\t\t:role=\"role\"\n\t\t\t@action=\"handleMoveUserAction\"\n\t\t\t@close=\"handleMoveUserClose\"\n\t\t/>\n\t`,\n};\n","import { memberRoles } from 'humanresources.company-structure.api';\nimport { UserListItemActionButton } from './action-button';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { SidePanel } from 'main.sidepanel';\nimport { mapState } from 'ui.vue3.pinia';\nimport 'ui.tooltip';\n\nexport const UserListItem = {\n\tname: 'userList',\n\n\tprops: {\n\t\tuser: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tselectedUserId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tcomponents: { UserListItemActionButton },\n\n\tcomputed: {\n\t\tmemberRoles(): typeof memberRoles\n\t\t{\n\t\t\treturn memberRoles;\n\t\t},\n\t\tdefaultAvatar(): string\n\t\t{\n\t\t\treturn '/bitrix/js/humanresources/company-structure/org-chart/src/images/default-user.svg';\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode']),\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\thandleUserClick(item): void\n\t\t{\n\t\t\tSidePanel.Instance.open(item.url, {\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div \n\t\t\t:key=\"user.id\"\n\t\t\tclass=\"hr-department-detail-content__user-container\"\n\t\t\t:class=\"{ '--searched': user.id === selectedUserId }\"\n\t\t\t:data-id=\"user.id\"\n\t\t>\n\t\t\t<div class=\"hr-department-detail-content__user-avatar-container\" @click=\"handleUserClick(user)\">\n\t\t\t\t<img \n\t\t\t\t\tclass=\"hr-department-detail-content__user-avatar-img\"\n\t\t\t\t\t:src=\"user.avatar ? encodeURI(user.avatar) : defaultAvatar\"\n\t\t\t\t/>\n\t\t\t\t<div v-if=\"user.role === memberRoles.head\" class=\"hr-department-detail-content__user-avatar-overlay\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"hr-department-detail-content-user__text-container\">\n\t\t\t\t<div class=\"hr-department-detail-content__user-title\">\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"hr-department-detail-content__user-name\" \n\t\t\t\t\t\t@click=\"handleUserClick(user)\"\n\t\t\t\t\t\t:bx-tooltip-user-id=\"user.id\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ user.name }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"user.badgeText\" class=\"hr-department-detail-content-user__name-badge\">{{ user.badgeText }}</div>\n\t\t\t\t</div>\n\t\t\t\t<div \n\t\t\t\t\tclass=\"hr-department-detail-content__user-subtitle\" \n\t\t\t\t\t:class=\"{ '--without-work-position': !user.subtitle }\"\n\t\t\t\t>\n\t\t\t\t\t{{ (user.subtitle?.length ?? 0) > 0 ? user.subtitle : this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_LIST_DEFAULT_WORK_POSITION') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<UserListItemActionButton\n\t\t\t\t:userId=\"user.id\"\n\t\t\t\t:user=\"user\"\n\t\t\t\t:departmentId=\"focusedNode\"\n\t\t\t\t:role=\"user.role\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { UserListItem } from './item/item';\nimport 'ui.icon-set.main';\n\nexport const UserList = {\n\tname: 'userList',\n\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tselectedUserId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tcomponents: { RouteActionMenu, UserListItem },\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tdraggedEmployee: null,\n\t\t\tdraggedIndex: null,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tonDragStart(item, targetElement)\n\t\t{\n\t\t\tthis.$emit('dragstart', item, targetElement);\n\t\t},\n\t\tonDrop(item, targetIndex)\n\t\t{\n\t\t\tthis.$emit('drop', item, targetIndex);\n\t\t},\n\t\tupdateEmployeeRole(employee, newRole)\n\t\t{\n\t\t\temployee.role = newRole;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"hr-department-detail-content__user-list-container\"\n\t\t>\n\t\t\t<UserListItem\n\t\t\t\tv-for=\"user in items\"\n\t\t\t\t:user=\"user\"\n\t\t\t\t:selectedUserId=\"selectedUserId\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { CRM } from 'ui.icon-set.api.core';\nimport '../../../style.css';\nimport 'ui.icon-set.crm';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\n\nconst MenuOption = Object.freeze({\n\taddToDepartment: 'addToDepartment',\n\teditDepartmentUsers: 'editDepartmentUsers',\n});\n\nexport const UserListActionButton = {\n\tname: 'userListActionButton',\n\temits: ['addToDepartment', 'editDepartmentUsers'],\n\n\tprops:\n\t{\n\t\trole: {\n\t\t\ttype: String,\n\t\t\tdefault: 'employee',\n\t\t},\n\t\tdepartmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomponents:\n\t\t{\n\t\t\tRouteActionMenu,\n\t\t},\n\n\tcreated()\n\t{\n\t\tthis.permissionChecker = PermissionChecker.getInstance();\n\t\tthis.menuItems = this.getMenuItems();\n\t},\n\n\twatch:\n\t{\n\t\tdepartmentId()\n\t\t{\n\t\t\tthis.menuItems = this.getMenuItems()\n\t\t},\n\t},\n\n\tcomputed:\n\t\t{\n\t\t\t...mapState(useChartStore, ['focusedNode']),\n\t\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.$emit(actionId);\n\t\t},\n\t\tgetMenuItems(): Array\n\t\t{\n\t\t\tif (!this.permissionChecker)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tlet menuItems = [\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.addToDepartment,\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: CRM.PERSON_PLUS_2,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: {\n\t\t\t\t\t\taction: PermissionActions.employeeAddToDepartment,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.editDepartmentUsers,\n\t\t\t\t\timageClass: '--hr-department-detail-members-action-menu-edit-list',\n\t\t\t\t\tpermission: {\n\t\t\t\t\t\taction: PermissionActions.employeeAddToDepartment,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\n\t\t\tconst menuItemText = {\n\t\t\t\t[MenuOption.addToDepartment]: {\n\t\t\t\t\thead: {\n\t\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_MEMBER_ACTION_MENU_ADD_HEAD_TITLE'),\n\t\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_MEMBER_ACTION_MENU_ADD_HEAD_SUBTITLE'),\n\t\t\t\t\t},\n\t\t\t\t\temployee: {\n\t\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_MEMBER_ACTION_MENU_ADD_EMPLOYEE_TITLE'),\n\t\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_MEMBER_ACTION_MENU_ADD_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t[MenuOption.editDepartmentUsers]: {\n\t\t\t\t\thead: {\n\t\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_MEMBER_ACTION_MENU_EDIT_HEAD_TITLE'),\n\t\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_MEMBER_ACTION_MENU_EDIT_HEAD_SUBTITLE'),\n\t\t\t\t\t},\n\t\t\t\t\temployee: {\n\t\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_MEMBER_ACTION_MENU_EDIT_EMPLOYEE_TITLE'),\n\t\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_MEMBER_ACTION_MENU_EDIT_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tmenuItems = menuItems.map((item) => ({\n\t\t\t\t...item,\n\t\t\t\t...menuItemText[item.id][this.role],\n\t\t\t}));\n\n\t\t\treturn menuItems.filter((item) => {\n\t\t\t\tif (!item.permission)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn this.permissionChecker.hasPermission(item.permission.action, this.departmentId);\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n      <button\n\t\t v-if=\"menuItems.length\"\n          class=\"hr-department-detail-content__list-header-button\"\n          :class=\"{ '--focused': menuVisible }\"\n          :ref=\"'actionMenuButton' + role\"\n          @click.stop=\"menuVisible = true\"\n      >\n        {{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_LIST_ACTION_BUTTON_TITLE') }}\n      </button>\n      <RouteActionMenu\n          v-if=\"menuVisible\"\n          :id=\"'tree-node-department-menu-' + role + '-' + focusedNode\"\n          :items=\"menuItems\"\n          :width=\"302\"\n          :bindElement=\"$refs['actionMenuButton' + role]\"\n          @action=\"onActionMenuItemClick\"\n          @close=\"menuVisible = false\"\n      />\n\t`,\n};\n","export const emptyStateTypes = {\n\tNO_MEMBERS_WITH_ADD_PERMISSION: 'NO_MEMBERS_WITH_ADD_PERMISSION',\n\tNO_MEMBERS_WITHOUT_ADD_PERMISSION: 'NO_MEMBERS_WITHOUT_ADD_PERMISSION',\n\tNO_SEARCHED_USERS_RESULTS: 'NO_SEARCHED_USERS_RESULTS',\n};\n","import { emptyStateTypes } from './empty-state-types';\nimport { CRM, Main } from 'ui.icon-set.api.core';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\n\nimport 'ui.icon-set.crm';\nimport 'ui.icon-set.main';\n\nconst MenuOption = Object.freeze({\n\tmoveUser: 'moveUser',\n\tuserInvite: 'userInvite',\n\taddToDepartment: 'addToDepartment',\n});\n\nexport const EmptyStateContainer = {\n\tname: 'emptyStateContainer',\n\n\tprops: {\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdepartmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomponents:\n\t{\n\t\tRouteActionMenu,\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.permissionChecker = PermissionChecker.getInstance();\n\t\tthis.menuItems = this.getMenuItems();\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tshowAddButtons(): boolean\n\t\t{\n\t\t\treturn this.type === emptyStateTypes.NO_MEMBERS_WITH_ADD_PERMISSION;\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode']),\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\temptyStateIconClass(): ?string\n\t\t{\n\t\t\tif (this.type === emptyStateTypes.NO_SEARCHED_USERS_RESULTS)\n\t\t\t{\n\t\t\t\treturn '--user-not-found';\n\t\t\t}\n\n\t\t\tif (this.type === emptyStateTypes.NO_MEMBERS_WITH_ADD_PERMISSION)\n\t\t\t{\n\t\t\t\treturn '--with-add-permission';\n\t\t\t}\n\n\t\t\tif (this.type === emptyStateTypes.NO_MEMBERS_WITHOUT_ADD_PERMISSION)\n\t\t\t{\n\t\t\t\treturn '--without-add-permission';\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\temptyStateTitle(): ?string\n\t\t{\n\t\t\tif (this.type === emptyStateTypes.NO_SEARCHED_USERS_RESULTS)\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_SEARCHED_EMPLOYEES_TITLE');\n\t\t\t}\n\n\t\t\tif (this.type === emptyStateTypes.NO_MEMBERS_WITH_ADD_PERMISSION)\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_ADD_USER_TITLE');\n\t\t\t}\n\n\t\t\tif (this.type === emptyStateTypes.NO_MEMBERS_WITHOUT_ADD_PERMISSION)\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_TITLE');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\temptyStateDescription(): ?string\n\t\t{\n\t\t\tif (this.type === emptyStateTypes.NO_SEARCHED_USERS_RESULTS)\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_SEARCHED_EMPLOYEES_SUBTITLE');\n\t\t\t}\n\n\t\t\tif (this.type === emptyStateTypes.NO_MEMBERS_WITH_ADD_PERMISSION)\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_ADD_USER_SUBTITLE');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.$emit(actionId, { type: 'employee', bindElement: this.$refs.actionMenuButton });\n\t\t},\n\t\tgetMenuItems(): Array\n\t\t{\n\t\t\tif (!this.permissionChecker)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.moveUser,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_CONTENT_EDIT_MENU_MOVE_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_CONTENT_EDIT_MENU_MOVE_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.PERSON_ARROW_LEFT_1,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.userInvite,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_CONTENT_EDIT_MENU_INVITE_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_CONTENT_EDIT_MENU_INVITE_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.PERSON_LETTER,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.inviteToDepartment },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.addToDepartment,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_CONTENT_EDIT_MENU_ADD_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_CONTENT_EDIT_MENU_ADD_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: CRM.PERSON_PLUS_2,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t\t},\n\t\t\t].filter((item) => {\n\t\t\t\tif (!item.permission)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn this.permissionChecker.hasPermission(item.permission.action, this.focusedNode);\n\t\t\t});\n\t\t},\n\t},\n\n\twatch:\n\t{\n\t\tdepartmentId()\n\t\t{\n\t\t\tthis.menuItems = this.getMenuItems();\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content__tab-container --empty\">\n\t\t\t<div :class=\"['hr-department-detail-content__tab-entity-icon', this.emptyStateIconClass()]\"></div>\n\t\t\t<div class=\"hr-department-detail-content__tab-entity-content\">\n\t\t\t\t<span class=\"hr-department-detail-content__empty-tab-entity-title\">\n\t\t\t\t\t{{ this.emptyStateTitle() }}\n\t\t\t\t</span>\n\t\t\t\t<span class=\"hr-department-detail-content__empty-tab-entity-subtitle\">\n\t\t\t\t\t{{ this.emptyStateDescription() }}\n\t\t\t\t</span>\n\t\t\t\t<div v-if=\"showAddButtons\" class=\"hr-department-detail-content__empty-tab-entity-buttons-container\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"hr-add-employee-empty-tab-entity-btn ui-btn ui-btn ui-btn-sm ui-btn-primary ui-btn-round\"\n\t\t\t\t\t\tref=\"actionMenuButton\"\n\t\t\t\t\t\t@click.stop=\"menuVisible = true\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"hr-add-employee-empty-tab-entity-btn-text\">{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_ADD_USER_ADD_BUTTON')}}</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<RouteActionMenu\n\t\t\t\t\t\tv-if=\"menuVisible\"\n\t\t\t\t\t\t:id=\"'empty-state-department-detail-add-menu-' + focusedNode\"\n\t\t\t\t\t\t:items=\"menuItems\"\n\t\t\t\t\t\t:width=\"302\"\n\t\t\t\t\t\t:bindElement=\"$refs['actionMenuButton']\"\n\t\t\t\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t\t\t\t@close=\"menuVisible = false\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { AddUserDialog } from 'humanresources.company-structure.add-user-dialog';\nimport { MoveUserFromDialog } from 'humanresources.company-structure.move-user-from-dialog';\nimport { DepartmentAPI } from '../../api';\nimport { UserList } from './list/list';\nimport { UserListActionButton } from './list/list-action-button';\nimport { EmptyStateContainer } from './empty-state-container';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState, mapWritableState } from 'ui.vue3.pinia';\nimport { memberRoles } from 'humanresources.company-structure.api';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { emptyStateTypes } from './empty-state-types';\nimport 'ui.buttons';\nimport './../../style.css';\n\nexport const EmployeeTab = {\n\tname: 'employeeTab',\n\n\temits: ['editDepartmentUsers', 'showDetailLoader', 'hideDetailLoader'],\n\n\tcomponents: { UserList, UserListActionButton, EmptyStateContainer },\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsearchQuery: '',\n\t\t\tshouldUpdateList: true,\n\t\t\tselectedUserId: null,\n\t\t\thasFocus: false,\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.loadEmployeesAction();\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.tabContainer = this.$refs['tab-container'];\n\t},\n\n\tcomputed:\n\t\t{\n\t\t\theads(): Array\n\t\t\t{\n\t\t\t\treturn this.departments.get(this.focusedNode).heads ?? [];\n\t\t\t},\n\t\t\theadCount(): number\n\t\t\t{\n\t\t\t\treturn this.heads.length ?? 0;\n\t\t\t},\n\t\t\tformattedHeads(): Array\n\t\t\t{\n\t\t\t\treturn this.heads.map((head) => ({\n\t\t\t\t\t...head,\n\t\t\t\t\tsubtitle: head.workPosition,\n\t\t\t\t\tbadgeText: this.getBadgeText(head.role),\n\t\t\t\t})).sort((a, b) => {\n\t\t\t\t\tconst roleOrder = {\n\t\t\t\t\t\t[memberRoles.head]: 1,\n\t\t\t\t\t\t[memberRoles.deputyHead]: 2,\n\t\t\t\t\t};\n\n\t\t\t\t\tconst roleA = roleOrder[a.role] || 3;\n\t\t\t\t\tconst roleB = roleOrder[b.role] || 3;\n\n\t\t\t\t\treturn roleA - roleB;\n\t\t\t\t});\n\t\t\t},\n\t\t\tfilteredHeads(): Array\n\t\t\t{\n\t\t\t\treturn this.formattedHeads.filter(\n\t\t\t\t\t(head) => head.name.toLowerCase().includes(this.searchQuery.toLowerCase())\n\t\t\t\t\t\t|| head.workPosition.toLowerCase().includes(this.searchQuery.toLowerCase()),\n\t\t\t\t);\n\t\t\t},\n\t\t\temployeeCount(): number\n\t\t\t{\n\t\t\t\tconst memberCount = this.departments.get(this.focusedNode).userCount ?? 0;\n\n\t\t\t\treturn memberCount - (this.headCount ?? 0);\n\t\t\t},\n\t\t\tformattedEmployees(): Array\n\t\t\t{\n\t\t\t\treturn this.employees.map((employee) => ({\n\t\t\t\t\t...employee,\n\t\t\t\t\tsubtitle: employee.workPosition,\n\t\t\t\t})).reverse();\n\t\t\t},\n\t\t\tfilteredEmployees(): Array\n\t\t\t{\n\t\t\t\treturn this.formattedEmployees.filter(\n\t\t\t\t\t(employee) => employee.name.toLowerCase().includes(this.searchQuery.toLowerCase())\n\t\t\t\t\t\t|| employee.workPosition.toLowerCase().includes(this.searchQuery.toLowerCase()),\n\t\t\t\t);\n\t\t\t},\n\t\t\tmemberCount(): number\n\t\t\t{\n\t\t\t\treturn this.departments.get(this.focusedNode).userCount ?? 0;\n\t\t\t},\n\t\t\t...mapState(useChartStore, ['focusedNode', 'departments', 'searchedUserId']),\n\t\t\t...mapWritableState(useChartStore, ['searchedUserId']),\n\t\t\temployees(): Array\n\t\t\t{\n\t\t\t\treturn this.departments.get(this.focusedNode)?.employees ?? [];\n\t\t\t},\n\t\t\tshowEmptyState(): boolean\n\t\t\t{\n\t\t\t\tif (!this.memberCount)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn this.filteredHeads.length === 0 && this.filteredEmployees.length === 0;\n\t\t\t},\n\t\t\temptyStateType(): ?string\n\t\t\t{\n\t\t\t\tif (!this.memberCount && this.canAddUsers)\n\t\t\t\t{\n\t\t\t\t\treturn emptyStateTypes.NO_MEMBERS_WITH_ADD_PERMISSION;\n\t\t\t\t}\n\n\t\t\t\tif (!this.memberCount)\n\t\t\t\t{\n\t\t\t\t\treturn emptyStateTypes.NO_MEMBERS_WITHOUT_ADD_PERMISSION;\n\t\t\t\t}\n\n\t\t\t\tif (this.filteredHeads.length === 0 && this.filteredEmployees.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn emptyStateTypes.NO_SEARCHED_USERS_RESULTS;\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\tshowSearchBar(): boolean\n\t\t\t{\n\t\t\t\treturn this.memberCount > 0;\n\t\t\t},\n\t\t\tcanAddUsers(): boolean\n\t\t\t{\n\t\t\t\tconst permissionChecker = PermissionChecker.getInstance();\n\t\t\t\tif (!permissionChecker)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst nodeId = this.focusedNode;\n\n\t\t\t\treturn permissionChecker.hasPermission(PermissionActions.employeeAddToDepartment, nodeId);\n\t\t\t},\n\t\t\theadListEmptyStateTitle(): string\n\t\t\t{\n\t\t\t\tif (this.canAddUsers)\n\t\t\t\t{\n\t\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_HEAD_EMPTY_LIST_ITEM_TITLE');\n\t\t\t\t}\n\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_HEAD_EMPTY_LIST_ITEM_TITLE_WITHOUT_ADD_PERMISSION');\n\t\t\t},\n\t\t\temployeesListEmptyStateTitle(): string\n\t\t\t{\n\t\t\t\tif (this.canAddUsers)\n\t\t\t\t{\n\t\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_EMPLOYEE_EMPTY_LIST_ITEM_TITLE');\n\t\t\t\t}\n\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_EMPLOYEE_EMPTY_LIST_ITEM_TITLE_WITHOUT_ADD_PERMISSION');\n\t\t\t},\n\t\t},\n\n\tmethods: {\n\t\tonDragStart(targetElement)\n\t\t{\n\t\t\tif (!targetElement.id)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.draggedEmployee = targetElement;\n\t\t},\n\t\tonDropToEmployee(targetIndex)\n\t\t{\n\t\t\t// @todo send order or new member to backend\n\t\t\tif (this.draggedEmployee)\n\t\t\t{\n\t\t\t\tif (this.draggedEmployee.role)\n\t\t\t\t{\n\t\t\t\t\tconst movedEmployee = { ...this.draggedEmployee };\n\t\t\t\t\tdelete movedEmployee.role;\n\t\t\t\t\tdelete movedEmployee.badgeText;\n\n\t\t\t\t\tconst index = this.heads.findIndex((head) => head.id === this.draggedEmployee.id);\n\t\t\t\t\tthis.heads.splice(index, 1);\n\t\t\t\t\tthis.employees.splice(targetIndex.id, 0, movedEmployee);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst index = this.employees.findIndex((employee) => employee && employee.id === this.draggedEmployee.id);\n\t\t\t\t\tconst movedEmployee = this.employees.splice(index, 1)[0];\n\t\t\t\t\tthis.employees.splice(targetIndex.id, 0, movedEmployee);\n\t\t\t\t}\n\n\t\t\t\tthis.draggedEmployee = null;\n\t\t\t\tthis.draggedIndex = null;\n\t\t\t}\n\t\t},\n\t\tonDropToHead(targetElement)\n\t\t{\n\t\t\tif (this.draggedEmployee)\n\t\t\t{\n\t\t\t\tif (this.draggedEmployee.role === 'MEMBER_HEAD')\n\t\t\t\t{\n\t\t\t\t\tconst index = this.heads.findIndex((head) => head.id === this.draggedEmployee.id);\n\t\t\t\t\tconst movedHead = this.heads.splice(index, 1)[0];\n\t\t\t\t\tthis.heads.splice(targetElement.id, 0, movedHead);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst movedHead = { ...this.draggedEmployee, role: 'MEMBER_HEAD' };\n\n\t\t\t\t\tconst index = this.employees.findIndex((employee) => employee && employee.id === this.draggedEmployee.id);\n\t\t\t\t\tthis.employees.splice(index, 1);\n\n\t\t\t\t\tthis.heads.splice(targetElement.id, 0, movedHead);\n\t\t\t\t}\n\n\t\t\t\tthis.draggedEmployee = null;\n\t\t\t\tthis.draggedIndex = null;\n\t\t\t}\n\t\t},\n\t\tloc(phraseCode, replacements = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tgetBadgeText(role): ?string\n\t\t{\n\t\t\tif (role === memberRoles.head)\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPLOYEES_HEAD_BADGE');\n\t\t\t}\n\n\t\t\tif (role === memberRoles.deputyHead)\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPLOYEES_DEPUTY_HEAD_BADGE');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tupdateList(event): void\n\t\t{\n\t\t\tconst employeesList = event.target;\n\t\t\tconst scrollPosition = employeesList.scrollTop + employeesList.clientHeight;\n\n\t\t\tif (\n\t\t\t\temployeesList.scrollHeight - scrollPosition < 40\n\t\t\t\t&& !this.isLoading\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.loadEmployeesAction();\n\t\t\t}\n\t\t},\n\t\taddToDepartment(options): void\n\t\t{\n\t\t\tAddUserDialog.openDialog(options);\n\t\t},\n\t\tuserInvite(): void\n\t\t{\n\t\t\tconst departmentToInvite = this.departments.get(this.focusedNode).accessCode.slice(1);\n\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t'/bitrix/services/main/ajax.php?action=getSliderContent'\n\t\t\t\t+ '&c=bitrix%3Aintranet.invitation&mode=ajax'\n\t\t\t\t+ `&departments[]=${departmentToInvite}&firstInvitationBlock=invite-with-group-dp`,\n\t\t\t\t{ cacheable: false, allowChangeHistory: false, width: 1100 },\n\t\t\t);\n\t\t},\n\t\tmoveUser(): void\n\t\t{\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tMoveUserFromDialog.openDialog(nodeId);\n\t\t},\n\t\teditDepartmentUsers(): void\n\t\t{\n\t\t\tthis.$emit('editDepartmentUsers');\n\t\t},\n\t\tasync loadEmployeesAction(): void\n\t\t{\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tconst department = this.departments.get(nodeId);\n\n\t\t\tif (!department)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdepartment.page = department.page ?? 0;\n\t\t\tdepartment.shouldUpdateList = department.shouldUpdateList ?? true;\n\n\t\t\tif (!this.isListUpdated && department.page === 0 && department.shouldUpdateList === true)\n\t\t\t{\n\t\t\t\tthis.$emit('showDetailLoader');\n\t\t\t}\n\n\t\t\tif (this.isListUpdated || !department.shouldUpdateList)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isListUpdated = true;\n\t\t\tconst page = department.page + 1;\n\n\t\t\tconst loadedEmployees = await DepartmentAPI.getPagedEmployees(nodeId, page, 25);\n\n\t\t\tif (!loadedEmployees)\n\t\t\t{\n\t\t\t\tdepartment.shouldUpdateList = false;\n\t\t\t\tthis.isListUpdated = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdepartment.employees = department.employees || [];\n\t\t\tconst employeeIds = new Set(department.employees.map((employee) => employee.id));\n\n\t\t\tconst newEmployees = loadedEmployees.reverse().filter((employee) => !employeeIds.has(employee.id));\n\t\t\tdepartment.employees.unshift(...newEmployees);\n\n\t\t\tif (newEmployees.length > 0)\n\t\t\t{\n\t\t\t\tdepartment.page = page;\n\t\t\t\tdepartment.shouldUpdateList = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdepartment.shouldUpdateList = false;\n\t\t\t}\n\n\t\t\tthis.departments.set(nodeId, department);\n\t\t\tthis.isListUpdated = false;\n\t\t\tthis.$emit('hideDetailLoader');\n\t\t},\n\t\tasync scrollToUser(): void\n\t\t{\n\t\t\tconst userId = this.needToFocusUserId;\n\t\t\tthis.needToFocusUserId = null;\n\t\t\tconst selectors = `.hr-department-detail-content__user-container[data-id=\"${userId}\"]`;\n\t\t\tlet element = this.tabContainer.querySelector(selectors);\n\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\tlet user = null;\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tuser = await DepartmentAPI.getUserInfo(this.focusedNode, userId);\n\t\t\t\t}\n\t\t\t\tcatch\n\t\t\t\t{ /* empty */ }\n\n\t\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\t\tif (!user || !department)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (user.role === memberRoles.head || user.role === memberRoles.deputyHead)\n\t\t\t\t{\n\t\t\t\t\tdepartment.heads = department.heads ?? [];\n\t\t\t\t\tif (!department.heads.some((head) => head.id === user.id))\n\t\t\t\t\t{\n\t\t\t\t\t\tdepartment.heads.push(user);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdepartment.employees = department.employees ?? [];\n\t\t\t\t\tif (!department.employees.some((employee) => employee.id === user.id))\n\t\t\t\t\t{\n\t\t\t\t\t\tdepartment.employees.push(user);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tawait this.$nextTick(() => {\n\t\t\t\t\telement = this.tabContainer.querySelector(selectors);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.selectedUserId = userId;\n\t\t\t}, 750);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.searchedUserId === userId)\n\t\t\t\t{\n\t\t\t\t\tthis.selectedUserId = null;\n\t\t\t\t\tthis.searchedUserId = null;\n\t\t\t\t}\n\t\t\t}, 4000);\n\t\t},\n\t\tasync searchMembers(query)\n\t\t{\n\t\t\tif (query.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.findQueryResult = this.findQueryResult || {};\n\t\t\tthis.findQueryResult[this.focusedNode] = this.findQueryResult[this.focusedNode] || {\n\t\t\t\tsuccess: [],\n\t\t\t\tfailure: [],\n\t\t\t};\n\n\t\t\tconst nodeResults = this.findQueryResult[this.focusedNode];\n\n\t\t\tif (nodeResults.failure.some((failedQuery) => query.startsWith(failedQuery)))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (nodeResults.success.includes(query) || nodeResults.failure.includes(query))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst founded = await DepartmentAPI.findMemberByQuery(this.focusedNode, query);\n\n\t\t\tif (founded.length === 0)\n\t\t\t{\n\t\t\t\tnodeResults.failure.push(query);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\tconst newMembers = founded.filter((found) => !department.heads.some((head) => head.id === found.id)\n\t\t\t\t&& !department.employees.some((employee) => employee.id === found.id));\n\n\t\t\tdepartment.employees.push(...newMembers);\n\t\t\tnodeResults.success.push(query);\n\t\t},\n\t\tonBlur(): void\n\t\t{\n\t\t\tif (this.searchQuery.length === 0)\n\t\t\t{\n\t\t\t\tthis.hasFocus = false;\n\t\t\t}\n\t\t},\n\t\tclearInput(): void\n\t\t{\n\t\t\tthis.searchQuery = '';\n\t\t\tthis.hasFocus = false;\n\t\t},\n\t},\n\n\twatch: {\n\t\tfocusedNode(newId): void\n\t\t{\n\t\t\tconst department = this.departments.get(newId) || {};\n\t\t\tif (!department.page)\n\t\t\t{\n\t\t\t\tdepartment.page = department.page ?? 0;\n\t\t\t\tdepartment.shouldUpdateList = department.shouldUpdateList ?? true;\n\t\t\t\tthis.departments.set(newId, department);\n\t\t\t\tthis.loadEmployeesAction();\n\t\t\t}\n\t\t\tthis.isDescriptionExpanded = false;\n\t\t\tthis.searchQuery = '';\n\t\t},\n\t\tsearchedUserId: {\n\t\t\thandler(userId): void\n\t\t\t{\n\t\t\t\tif (!userId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.needToFocusUserId = userId;\n\t\t\t\tif (!this.isListUpdated)\n\t\t\t\t{\n\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\tthis.scrollToUser();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\timmediate: true,\n\t\t},\n\t\tasync searchQuery(newQuery) {\n\t\t\tawait this.searchMembers(newQuery);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"hr-department-detail-content__tab-container\"\n\t\t\tref=\"tab-container\"\n\t\t>\n\t\t\t<div\n\t\t\t\tv-if=\"showSearchBar\"\n\t\t\t\tclass=\"hr-department-detail-content__content-search\"\n\t\t\t\t:class=\"{'--focused': hasFocus}\"\n\t\t\t>\n\t\t\t\t<div class=\"hr-department-detail-content__content-search-icon\"/>\n\t\t\t\t<input\n\t\t\t\t\tv-model=\"searchQuery\"\n\t\t\t\t\tclass=\"hr-department-detail-content__content-search-input\"\n\t\t\t\t\t:placeholder=\"!hasFocus ? loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_SEARCH_PLACEHOLDER') : ''\"\n\t\t\t\t\t@focus=\"hasFocus = true\"\n\t\t\t\t\t@blur=\"onBlur\"\n\t\t\t\t>\n\t\t\t\t<div \n\t\t\t\t\tclass=\"hr-department-detail-content__content-search-close-button ui-icon-set --cross-circle-50\"\n\t\t\t\t\t:class=\"{'--hide': !hasFocus}\"\n\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 24px; --ui-icon-set__icon-color: #2FC6F6;\"\n\t\t\t\t\t@click=\"clearInput\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<EmptyStateContainer\n\t\t\t\tv-if=\"emptyStateType\"\n\t\t\t\t:type=\"emptyStateType\"\n\t\t\t\t:departmentId=\"focusedNode\"\n\t\t\t\t@addToDepartment=\"addToDepartment\"\n\t\t\t\t@userInvite=\"userInvite\"\n\t\t\t\t@moveUser=\"moveUser\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tv-else\n\t\t\t\tv-on=\"shouldUpdateList ? { scroll: updateList } : {}\"\n\t\t\t\tclass=\"hr-department-detail-content__lists-container\"\n\t\t\t>\n\t\t\t\t<div class=\"hr-department-detail-content__list --head\">\n\t\t\t\t\t<div class=\"hr-department-detail-content__list-header-container\">\n\t\t\t\t\t\t<div class=\"hr-department-detail-content__list-title\">\n\t\t\t\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_HEAD_LIST_TITLE') }}\n\t\t\t\t\t\t\t<span class=\"hr-department-detail-content__list-count\">{{ headCount }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<UserListActionButton\n\t\t\t\t\t\t\trole=\"head\"\n\t\t\t\t\t\t\t@addToDepartment=\"addToDepartment({ type: 'head' })\"\n\t\t\t\t\t\t\t@editDepartmentUsers=\"editDepartmentUsers\"\n\t\t\t\t\t\t\t:departmentId=\"focusedNode\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"!headCount\" :class=\"['hr-department-detail-content__empty-list-item', { '--with-add': canAddUsers }]\">\n\t\t\t\t\t\t<div class=\"hr-department-detail-content__empty-list-item-image\"/>\n\t\t\t\t\t\t<div class=\"hr-department-detail-content__empty-list-item-content\">\n\t\t\t\t\t\t\t<div class=\"hr-department-detail-content__empty-list-item-title\">\n\t\t\t\t\t\t\t\t{{ headListEmptyStateTitle }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<UserList\n\t\t\t\t\t\t:items=\"filteredHeads\"\n\t\t\t\t\t\t@dragstart=\"onDragStart\"\n\t\t\t\t\t\t@drop=\"onDropToHead\"\n\t\t\t\t\t\t:selectedUserId=\"selectedUserId\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"hr-department-detail-content__list --employee\">\n\t\t\t\t\t<div class=\"hr-department-detail-content__list-header-container\">\n\t\t\t\t\t\t<div class=\"hr-department-detail-content__list-title\">\n\t\t\t\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_EMPLOYEE_LIST_TITLE') }}\n\t\t\t\t\t\t\t<span class=\"hr-department-detail-content__list-count\">{{ employeeCount }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<UserListActionButton\n\t\t\t\t\t\t\trole=\"employee\"\n\t\t\t\t\t\t\t@addToDepartment=\"addToDepartment({ type: 'employee' })\"\n\t\t\t\t\t\t\t@editDepartmentUsers=\"editDepartmentUsers\"\n\t\t\t\t\t\t\t:departmentId=\"focusedNode\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"!employeeCount\" :class=\"['hr-department-detail-content__empty-list-item', { '--with-add': canAddUsers }]\">\n\t\t\t\t\t\t<div class=\"hr-department-detail-content__empty-list-item-image\"/>\n\t\t\t\t\t\t<div class=\"hr-department-detail-content__empty-list-item-content\">\n\t\t\t\t\t\t\t<div class=\"hr-department-detail-content__empty-list-item-title\">\n\t\t\t\t\t\t\t\t{{ employeesListEmptyStateTitle }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<UserList\n\t\t\t\t\t\t:items=\"filteredEmployees\"\n\t\t\t\t\t\t@dragstart=\"onDragStart\"\n\t\t\t\t\t\t@drop=\"onDropToEmployee\"\n\t\t\t\t\t\t:selectedUserId=\"selectedUserId\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export const ChatTab = {\n\tname: 'chatTab',\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\n\tcomputed:\n\t{\n\t\tunavailableChatList(): Array<{ text: string; }>\n\t\t{\n\t\t\treturn [\n\t\t\t\t{ text: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_TAB_CONTENT_UNAVAILABLE_CHATS_LIST_ITEM_1') },\n\t\t\t\t{ text: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_TAB_CONTENT_UNAVAILABLE_CHATS_LIST_ITEM_2') },\n\t\t\t];\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content__tab-container --empty\">\n\t\t\t<div class=\"hr-department-detail-content__tab-entity-icon --chat --default\"></div>\n\t\t\t<div class=\"hr-department-detail-content__tab-entity-content\">\n\t\t\t\t<div class=\"hr-department-detail-content__empty-tab-entity-title\">\n\t\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_TAB_CONTENT_UNAVAILABLE_CHATS_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"hr-department-detail-content__empty-tab-entity-list\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-for=\"item in unavailableChatList\"\n\t\t\t\t\t\tclass=\"hr-department-detail-content__empty-tab-entity-item --check\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ item.text }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { EmployeeTab } from './users/tab';\nimport { ChatTab } from './chat/tab';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\n\nexport const DepartmentContent = {\n\tname: 'departmentContent',\n\n\tcomponents: { EmployeeTab, ChatTab },\n\n\temits: ['showDetailLoader', 'hideDetailLoader', 'editEmployee'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tactiveTab: 'employeeTab',\n\t\t\ttabs: [\n\t\t\t\t{ name: 'employeeTab', component: 'EmployeeTab' },\n\t\t\t\t{ name: 'chatTab', component: 'ChatTab', soon: true },\n\t\t\t],\n\t\t\tisDescriptionOverflowed: false,\n\t\t\tisDescriptionExpanded: false,\n\t\t};\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.isDescriptionOverflowed = this.checkDescriptionOverflowed();\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tselectTab(tabName): void\n\t\t{\n\t\t\tthis.activeTab = tabName;\n\t\t},\n\t\tgetTabLabel(name: string): string\n\t\t{\n\t\t\tif (name === 'employeeTab')\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TITLE');\n\t\t\t}\n\n\t\t\tif (name === 'chatTab')\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_TITLE');\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\ttoggleDescriptionExpand(): void\n\t\t{\n\t\t\tthis.isDescriptionExpanded = !this.isDescriptionExpanded;\n\t\t},\n\t\tcheckDescriptionOverflowed(): boolean\n\t\t{\n\t\t\tconst descriptionContainer = this.$refs.descriptionContainer ?? null;\n\t\t\tif (descriptionContainer)\n\t\t\t{\n\t\t\t\treturn descriptionContainer.scrollWidth > descriptionContainer.clientWidth;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\thideDetailLoader(): boolean\n\t\t{\n\t\t\tthis.$emit('hideDetailLoader');\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.isDescriptionOverflowed = this.checkDescriptionOverflowed();\n\t\t\t});\n\t\t},\n\t},\n\n\tcomputed: {\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t\tactiveTabComponent()\n\t\t{\n\t\t\tconst activeTab = this.tabs.find((tab) => tab.name === this.activeTab);\n\n\t\t\treturn activeTab ? activeTab.component : null;\n\t\t},\n\t\tcount(): Number\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.userCount ?? 0;\n\t\t},\n\t\ttabArray(): Array\n\t\t{\n\t\t\treturn this.tabs.map((tab) => {\n\t\t\t\tif (tab.name === 'employeeTab')\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...tab,\n\t\t\t\t\t\tcount: this.count,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn tab;\n\t\t\t});\n\t\t},\n\t\tdescription(): ?string\n\t\t{\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\tif (!department.description)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn department.description;\n\t\t},\n\t},\n\n\twatch: {\n\t\tdescription(): void\n\t\t{\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.isDescriptionOverflowed = this.checkDescriptionOverflowed();\n\t\t\t});\n\t\t},\n\t\tfocusedNode(): void\n\t\t{\n\t\t\tthis.isDescriptionExpanded = false;\n\t\t\tthis.selectTab('employeeTab');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content hr-department-detail-content__scope\">\n\t\t\t<div\n\t\t\t\tref=\"descriptionContainer\"\n\t\t\t\tv-show=\"description\"\n\t\t\t\t:class=\"[\n\t\t\t\t\t'hr-department-detail-content-description',\n\t\t\t\t\t{ '--expanded': isDescriptionExpanded },\n\t\t\t\t\t{ '--overflowed': isDescriptionOverflowed},\n\t\t\t\t]\"\n\t\t\t\tv-on=\"isDescriptionOverflowed ? { click: toggleDescriptionExpand } : {}\"\n\t\t\t>\n\t\t\t\t{{ description }}\n\t\t\t</div>\n\t\t\t<div class=\"hr-department-detail-content__tab-list\">\n\t\t\t\t<button\n\t\t\t\t\tv-for=\"tab in tabArray\"\n\t\t\t\t\t:key=\"tab.name\"\n\t\t\t\t\tclass=\"hr-department-detail-content__tab-item\"\n\t\t\t\t\t:class=\"[{'--active-tab' : activeTab === tab.name}, {'--soon' : tab.soon}]\"\n\t\t\t\t\t:data-title=\"tab.soon ? loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_BADGE_SOON') : null\"\n\t\t\t\t\t@click=\"selectTab(tab.name)\"\n\t\t\t\t>\n\t\t\t\t\t{{ this.getTabLabel(tab.name) }}\n\t\t\t\t\t<span v-if=\"!tab.soon\" class=\"hr-department-detail-content__tab-count\">{{ tab.count }}</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<component\n\t\t\t\t:is=\"activeTabComponent\"\n\t\t\t\t@editDepartmentUsers=\"$emit('editEmployee')\"\n\t\t\t\t@showDetailLoader=\"$emit('showDetailLoader')\"\n\t\t\t\t@hideDetailLoader=\"hideDetailLoader\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n"],"names":["DepartmentAPI","getPagedEmployees","id","page","countPerPage","getData","nodeId","removeUserFromDepartment","userId","postData","moveUserToDepartment","targetNodeId","isUserInMultipleDepartments","getUserInfo","findMemberByQuery","query","MoveUserActionPopup","name","components","ConfirmationPopup","emits","props","parentId","type","Number","required","user","Object","role","String","default","memberRoles","employee","created","permissionChecker","PermissionChecker","getInstance","action","PermissionActions","employeeAddToDepartment","selectedDepartmentId","data","showMoveUserActionLoader","lockMoveUserActionButton","showUserAlreadyBelongsToDepartmentPopup","accessDenied","mounted","departmentContainer","$refs","departmentSelector","getTagSelector","renderTo","computed","mapState","useChartStore","getMoveUserActionPhrase","departmentName","Text","encode","departments","get","focusedNode","userName","loc","url","getUserAlreadyBelongsToDepartmentPopupPhrase","selectedParentDepartment","methods","TagSelector","events","onTagAdd","event","tag","hasPermission","onTagRemove","multiple","dialogOptions","width","height","dropdownMode","hideOnDeselect","entities","options","selectMode","preselectedItems","tagBgColor","tagTextColor","tagFontWeight","tagAvatar","phraseCode","replacements","$Bitrix","Loc","getMessage","confirmMoveUser","error","code","UI","Notification","Center","notify","content","autoHideDelay","$emit","moveUserStoreToAnotherDepartment","closeAction","closeUserAlreadyBelongsToDepartmentPopup","template","MenuOption","freeze","moveUserToAnotherDepartment","fireUserFromCompany","UserListItemActionButton","departmentId","RouteActionMenu","menuVisible","showRemoveUserConfirmationPopup","showRemoveUserConfirmationActionLoader","showMoveUserPopup","toggleMenu","onActionMenuItemClick","actionId","removeUser","removeUserFromStore","rootDepartment","values","find","department","cancelRemoveUser","handleMoveUserAction","handleMoveUserClose","menuItems","title","description","bIcon","Main","PERSON_ARROW_LEFT_1","size","color","getColorCode","permission","TRASH_BIN","employeeRemoveFromDepartment","PERSONS_DENY","employeeFire","filter","item","UserListItem","selectedUserId","defaultAvatar","handleUserClick","SidePanel","Instance","open","cacheable","UserList","items","Array","draggedEmployee","draggedIndex","onDragStart","targetElement","onDrop","targetIndex","updateEmployeeRole","newRole","addToDepartment","editDepartmentUsers","UserListActionButton","getMenuItems","watch","CRM","PERSON_PLUS_2","imageClass","menuItemText","head","map","emptyStateTypes","NO_MEMBERS_WITH_ADD_PERMISSION","NO_MEMBERS_WITHOUT_ADD_PERMISSION","NO_SEARCHED_USERS_RESULTS","moveUser","userInvite","EmptyStateContainer","showAddButtons","emptyStateIconClass","emptyStateTitle","emptyStateDescription","bindElement","actionMenuButton","PERSON_LETTER","inviteToDepartment","EmployeeTab","searchQuery","shouldUpdateList","hasFocus","loadEmployeesAction","tabContainer","heads","headCount","length","formattedHeads","subtitle","workPosition","badgeText","getBadgeText","sort","a","b","roleOrder","deputyHead","roleA","roleB","filteredHeads","toLowerCase","includes","employeeCount","memberCount","userCount","formattedEmployees","employees","reverse","filteredEmployees","mapWritableState","showEmptyState","emptyStateType","canAddUsers","showSearchBar","headListEmptyStateTitle","employeesListEmptyStateTitle","onDropToEmployee","movedEmployee","index","findIndex","splice","onDropToHead","movedHead","updateList","employeesList","target","scrollPosition","scrollTop","clientHeight","scrollHeight","isLoading","AddUserDialog","openDialog","departmentToInvite","accessCode","slice","BX","allowChangeHistory","MoveUserFromDialog","isListUpdated","loadedEmployees","employeeIds","Set","newEmployees","has","unshift","set","scrollToUser","needToFocusUserId","selectors","element","querySelector","some","push","$nextTick","scrollIntoView","behavior","block","setTimeout","searchedUserId","searchMembers","findQueryResult","success","failure","nodeResults","failedQuery","startsWith","founded","newMembers","found","onBlur","clearInput","newId","isDescriptionExpanded","handler","immediate","newQuery","ChatTab","unavailableChatList","text","DepartmentContent","activeTab","tabs","component","soon","isDescriptionOverflowed","checkDescriptionOverflowed","selectTab","tabName","getTabLabel","toggleDescriptionExpand","descriptionContainer","scrollWidth","clientWidth","hideDetailLoader","activeTabComponent","tab","count","tabArray"],"mappings":"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"}