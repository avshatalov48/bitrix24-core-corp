this.BX=this.BX||{};this.BX.Humanresources=this.BX.Humanresources||{};(function(e,t,r){"use strict";const s=e=>{const t=new Map;e.forEach((e=>{var r,s,n;const{id:i,parentId:a}=e;const u=(r=t.get(i))!=null?r:{};t.set(i,{...u,...e});if(a===0){return}const c=(s=t.get(a))!=null?s:{};const o=(n=c.children)!=null?n:[];t.set(a,{...c,children:[...o,i]})}));return t};const n={removeDepartment:e=>t.getData("humanresources.api.Structure.Node.delete",{nodeId:e}),getDepartmentsData:()=>t.getData("humanresources.api.Structure.get",{},{tool:"structure",category:"structure",event:"open_structure"}),getCurrentDepartments:()=>t.getData("humanresources.api.Structure.Node.current"),getDictionary:()=>t.getData("humanresources.api.Structure.dictionary"),getUserId:()=>t.getData("humanresources.api.User.getCurrentId"),firstTimeOpened:()=>t.postData("humanresources.api.User.firstTimeOpen"),createTreeDataStore:s};const i=Object.freeze({structureView:"ACTION_STRUCTURE_VIEW",chanelBindToStructure:"ACTION_CHANEL_BIND_TO_STRUCTURE",chanelUnbindToStructure:"ACTION_CHANEL_UNBIND_TO_STRUCTURE",chatBindToStructure:"ACTION_CHAT_BIND_TO_STRUCTURE",chatUnbindToStructure:"ACTION_CHAT_UNBIND_TO_STRUCTURE",departmentCreate:"ACTION_DEPARTMENT_CREATE",departmentDelete:"ACTION_DEPARTMENT_DELETE",departmentEdit:"ACTION_DEPARTMENT_EDIT",employeeAddToDepartment:"ACTION_EMPLOYEE_ADD_TO_DEPARTMENT",employeeRemoveFromDepartment:"ACTION_EMPLOYEE_REMOVE_FROM_DEPARTMENT",accessEdit:"ACTION_USERS_ACCESS_EDIT",inviteToDepartment:"ACTION_USER_INVITE"});class a{constructor(){if(!a.instance){this.currentUserPermissions={};this.permissionVariablesDictionary=[];this.isInitialized=false;a.instance=this}return a.instance}getInstance(){return a.instance}async init(){if(this.isInitialized){return}const{currentUserPermissions:e,permissionVariablesDictionary:t}=await n.getDictionary();this.currentUserPermissions=e;this.permissionVariablesDictionary=t;this.isInitialized=true}hasPermission(e,t){const s=this.currentUserPermissions[e];if(!s){return false}const n=this.permissionVariablesDictionary.find((e=>e.id===s));if(!n){return false}const u=r.useChartStore().departments;if(e===i.departmentDelete){const e=[...u.values()].find((e=>e.parentId===0)).id;if(t===e){return false}}const c=r.useChartStore().currentDepartments;switch(n.id){case a.FULL_COMPANY:return true;case a.SELF_AND_SUB:{if(c.includes(t)){return true}let e=u.get(t);while(e){if(c.includes(e.id)){return true}e=u.get(e.parentId)}return false}case a.SELF:return c.includes(t);case a.NONE:default:return false}}hasPermissionOfAction(e){return this.currentUserPermissions[e]!==undefined&&this.currentUserPermissions[e]!==null&&this.currentUserPermissions[e]!==a.NONE}}a.FULL_COMPANY=30;a.SELF_AND_SUB=20;a.SELF=10;a.NONE=0;const u=new a;e.PermissionActions=i;e.PermissionChecker=u})(this.BX.Humanresources.CompanyStructure=this.BX.Humanresources.CompanyStructure||{},BX.Humanresources.CompanyStructure,BX.Humanresources.CompanyStructure);
//# sourceMappingURL=checker.bundle.map.js