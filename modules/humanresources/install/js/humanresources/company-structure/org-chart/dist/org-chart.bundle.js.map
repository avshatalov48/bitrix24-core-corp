{"version":3,"file":"org-chart.bundle.js","sources":["../src/events.js","../src/components/title-panel/add-button/add-button.js","../src/actions.js","../src/components/title-panel/search/search-bar.js","../src/components/title-panel/burger-menu-button/burger-menu-button.js","../src/components/title-panel/title-panel.js","../src/components/tree/tree-node/head-list.js","../src/components/tree/tree-node/department-menu-button.js","../src/components/tree/tree-node/subdivision-add-button.js","../src/components/tree/tree-node/tree-node.js","../src/api.js","../src/components/tree/tree.js","../src/components/transfrom-panel.js","../src/components/detail-panel/detail-panel-collapsed-title.js","../src/components/detail-panel/detail-panel-edit-button.js","../src/components/detail-panel/detail-panel.js","../src/components/first-popup/first-popup.js","../src/app.js","../src/main.js"],"sourcesContent":["export const events = Object.freeze({\n\tHR_DEPARTMENT_CONNECT: 'hr-department-connect',\n\tHR_DEPARTMENT_DISCONNECT: 'hr-department-disconnect',\n\tHR_DEPARTMENT_ADAPT_SIBLINGS: 'hr-department-adapt-siblings',\n\tHR_DEPARTMENT_ADAPT_CONNECTOR_HEIGHT: 'hr-department-adapt-connector-height',\n\tHR_DEPARTMENT_FOCUS: 'hr-department-focus',\n\tHR_DEPARTMENT_CONTROL: 'hr-department-control',\n\tHR_DEPARTMENT_MENU_CLOSE: 'hr-department-menu-close',\n\tHR_ORG_CHART_CLOSE_BY_ESC: 'SidePanel.Slider:onCloseByEsc',\n\tHR_ORG_CHART_CLOSE: 'SidePanel.Slider:onClose',\n\tHR_FIRST_POPUP_SHOW: 'HR.company-structure:first-popup-showed',\n\tHR_DEPARTMENT_SLIDER_ON_MESSAGE: 'SidePanel.Slider:onMessage',\n});\n","import { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { Main, CRM } from 'ui.icon-set.api.core';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport 'ui.icon-set.main';\nimport 'ui.icon-set.crm';\n\nconst MenuOption = Object.freeze({\n\taddDepartment: 'add-department',\n\taddEmployee: 'add-employee',\n});\n\nexport const AddButton = {\n\tname: 'AddButton',\n\n\temits: ['addDepartment'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tactionMenu: {\n\t\t\t\tvisible: false,\n\t\t\t},\n\t\t};\n\t},\n\tcomponents: {\n\t\tRouteActionMenu,\n\t},\n\n\tmounted(): void\n\t{\n\t\tconst permissionChecker = PermissionChecker.getInstance();\n\n\t\tif (!permissionChecker)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.dropdownItems = [\n\t\t\t{\n\t\t\t\tid: MenuOption.addDepartment,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_DEPARTMENT_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_DEPARTMENT_DESCR'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.CUBE_PLUS,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: {\n\t\t\t\t\taction: PermissionActions.departmentCreate,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuOption.addEmployee,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_EMPLOYEE_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_EMPLOYEE_DESCR'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: CRM.PERSON_PLUS_2,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: {\n\t\t\t\t\taction: PermissionActions.employeeAddToDepartment,\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tthis.dropdownItems = this.dropdownItems.filter((item) => {\n\t\t\tif (!item.permission)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn permissionChecker.hasPermissionOfAction(item.permission.action);\n\t\t});\n\t},\n\n\tcomputed: {\n\t\tMenuOption(): typeof MenuOption\n\t\t{\n\t\t\treturn MenuOption;\n\t\t},\n\t},\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\taddDepartment(): void\n\t\t{\n\t\t\tthis.$emit('addDepartment');\n\t\t},\n\t\tactionMenuItemClickHandler(actionId: string): void\n\t\t{\n\t\t\tif (actionId === MenuOption.addDepartment)\n\t\t\t{\n\t\t\t\tthis.$emit('addDepartment');\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-btn ui-btn-success ui-btn-round ui-btn-sm\" @click=\"addDepartment\">\n\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON') }}\n\t\t</div>\n\t`,\n};\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { memberRoles } from 'humanresources.company-structure.api';\nimport type { TreeItem } from './types';\nimport type { UserData } from 'humanresources.company-structure.utils';\n\nexport const OrgChartActions = {\n\tapplyData: (departments: Map<Number, TreeItem>, currentDepartments: number[], userId: number): void => {\n\t\tconst store = useChartStore();\n\t\tstore.$patch({\n\t\t\tdepartments,\n\t\t\tcurrentDepartments,\n\t\t\tuserId,\n\t\t\tsearchedUserId: userId,\n\t\t});\n\t},\n\tfocusDepartment: (departmentId: number): void => {\n\t\tconst store = useChartStore();\n\t\tstore.focusedNode = departmentId;\n\t},\n\tsearchUserInDepartment: (userId: number): void => {\n\t\tconst store = useChartStore();\n\t\tstore.searchedUserId = userId;\n\t},\n\tmoveSubordinatesToParent: (removableDepartmentId: number): void => {\n\t\tconst store = useChartStore();\n\t\tconst { departments, currentDepartments } = store;\n\t\tconst removableDepartment = departments.get(removableDepartmentId);\n\t\tconst {\n\t\t\tparentId,\n\t\t\tchildren: removableDeparmentChildren = [],\n\t\t\tuserCount: removableDepartmentUserCount,\n\t\t\theads: removableDeparmentHeads,\n\t\t\temployees: removableDeparmentEmployees = [],\n\t\t} = removableDepartment;\n\t\tremovableDeparmentChildren.forEach((childId) => {\n\t\t\tconst department = departments.get(childId);\n\t\t\tdepartment.parentId = parentId;\n\t\t});\n\t\tconst parentDepartment = departments.get(parentId);\n\t\tif (removableDepartmentUserCount > 0)\n\t\t{\n\t\t\tconst parentDepartmentUsersIds = new Set([\n\t\t\t\t...parentDepartment.heads,\n\t\t\t\t...(parentDepartment.employees ?? []),\n\t\t\t].map((user) => user.id));\n\t\t\tconst removableDeparmentUsers = [...removableDeparmentHeads, ...removableDeparmentEmployees];\n\t\t\tconst movableUsers = removableDeparmentUsers.filter((user) => {\n\t\t\t\treturn !parentDepartmentUsersIds.has(user.id);\n\t\t\t});\n\t\t\tfor (const user of movableUsers)\n\t\t\t{\n\t\t\t\tuser.role = memberRoles.employee;\n\t\t\t}\n\t\t\tparentDepartment.userCount += movableUsers.length;\n\t\t\tparentDepartment.employees = [\n\t\t\t\t...(parentDepartment.employees ?? []),\n\t\t\t\t...movableUsers,\n\t\t\t];\n\t\t}\n\n\t\tparentDepartment.children = [...parentDepartment.children, ...removableDeparmentChildren];\n\t\tif (currentDepartments.includes(removableDepartmentId))\n\t\t{\n\t\t\tstore.changeCurrentDepartment(removableDepartmentId, parentId);\n\t\t}\n\t},\n\tmarkDepartmentAsRemoved: (removableDepartmentId: number): void => {\n\t\tconst { departments } = useChartStore();\n\t\tconst removableDepartment = departments.get(removableDepartmentId);\n\t\tconst { parentId } = removableDepartment;\n\t\tconst parentDepartment = departments.get(parentId);\n\t\tparentDepartment.children = parentDepartment.children.filter((childId) => {\n\t\t\treturn childId !== removableDepartmentId;\n\t\t});\n\t\tdelete removableDepartment.parentId;\n\t\tdepartments.set(removableDepartmentId, { ...removableDepartment, prevParentId: parentId });\n\t},\n\tremoveDepartment: (departmentId: number): void => {\n\t\tconst { departments } = useChartStore();\n\t\tdepartments.delete(departmentId);\n\t},\n\tinviteUser: (userData: UserData): void => {\n\t\tconst { nodeId, ...restData } = userData;\n\t\tconst { departments } = useChartStore();\n\t\tconst department = departments.get(nodeId);\n\t\tif (department.employees)\n\t\t{\n\t\t\tdepartments.set(nodeId, {\n\t\t\t\t...department,\n\t\t\t\temployees: [...department.employees, { ...restData }],\n\t\t\t\tuserCount: department.userCount + 1,\n\t\t\t});\n\t\t}\n\t},\n};\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { Event } from 'main.core';\nimport { Dialog } from 'ui.entity-selector';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { mapState } from 'ui.vue3.pinia';\nimport { sendData as analyticsSendData } from 'ui.analytics';\nimport { OrgChartActions } from '../../../actions';\n\nimport './style.css';\n\nexport const SearchBar = {\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tdirectives: {\n\t\tfocus: {\n\t\t\tmounted(el)\n\t\t\t{\n\t\t\t\tel.focus();\n\t\t\t},\n\t\t},\n\t},\n\tdata(): { canEditPermissions: boolean; showSearchBar: boolean; }\n\t{\n\t\treturn {\n\t\t\tcanEditPermissions: false,\n\t\t\tshowSearchBar: false,\n\t\t};\n\t},\n\n\tcreated()\n\t{\n\t\tthis.searchDialog = this.getSearchDialog();\n\t},\n\n\tname: 'search-bar',\n\n\temits: [\n\t\t'locate',\n\t],\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\t...mapState(useChartStore, ['departments']),\n\t},\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tshowSearchbar(): void\n\t\t{\n\t\t\tif (this.showSearchBar)\n\t\t\t{\n\t\t\t\tthis.showSearchBar = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tanalyticsSendData({ tool: 'structure', category: 'structure', event: 'search' });\n\n\t\t\tthis.showSearchBar = true;\n\t\t},\n\t\thideSearchbar(): void\n\t\t{\n\t\t\tthis.showSearchBar = false;\n\t\t},\n\t\tgetSearchDialog(): Dialog\n\t\t{\n\t\t\tconst dialog = new Dialog({\n\t\t\t\twidth: 425,\n\t\t\t\theight: 320,\n\t\t\t\tmultiple: false,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\tsearchFields: [\n\t\t\t\t\t\t\t{ name: 'supertitle', type: 'string', system: true, searchable: true },\n\t\t\t\t\t\t\t{ name: 'position', type: 'string' },\n\t\t\t\t\t\t],\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'structure-node',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'onlyDepartments',\n\t\t\t\t\t\t\tflatMode: true,\n\t\t\t\t\t\t\tfillRecentTab: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\trecentTabOptions: {\n\t\t\t\t\tid: 'recents',\n\t\t\t\t\tvisible: true,\n\t\t\t\t},\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: false,\n\t\t\t\thideOnDeselect: false,\n\t\t\t\tcontext: 'HR_STRUCTURE',\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst item = event.getData().item;\n\n\t\t\t\t\t\tif (item.entityType === 'employee')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$emit('locate', item.customData.get('nodeId'));\n\t\t\t\t\t\t\tOrgChartActions.searchUserInDepartment(item.id);\n\t\t\t\t\t\t\tdialog.recentItemsToSave.push(item);\n\t\t\t\t\t\t\tdialog.saveRecentItems();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdialog.recentItemsToSave.push(item);\n\t\t\t\t\t\tdialog.saveRecentItems();\n\n\t\t\t\t\t\tthis.$emit('locate', item.id);\n\t\t\t\t\t},\n\t\t\t\t\tonLoad: (event) => {\n\t\t\t\t\t\tevent.target.items.get('user').forEach((item) => {\n\t\t\t\t\t\t\tif (!item.getSubtitle())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.setSubtitle(item.customData.get('position'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\t'SearchTab:onLoad': (event) => {\n\t\t\t\t\t\tevent.target.items.get('user').forEach((item) => {\n\t\t\t\t\t\t\tif (!item.getSubtitle())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.setSubtitle(item.customData.get('position'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tonDestroy: () => {\n\t\t\t\t\t\tthis.searchDialog = this.getSearchDialog();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\treturn dialog;\n\t\t},\n\n\t\tonEnter(): void\n\t\t{\n\t\t\tif (this.$refs.searchName)\n\t\t\t{\n\t\t\t\tthis.searchDialog.setTargetNode(this.$refs.searchName);\n\t\t\t\tif (!this.searchDialog.isOpen())\n\t\t\t\t{\n\t\t\t\t\tthis.searchDialog.show();\n\t\t\t\t}\n\t\t\t\tEvent.bind(window, 'mousedown', this.handleClickOutside);\n\t\t\t}\n\t\t},\n\t\thandleClickOutside(event): void\n\t\t{\n\t\t\tif (this.$refs.searchName\n\t\t\t\t&& !this.$refs.searchName.parentElement.contains(event.target) && !this.searchDialog.isOpen())\n\t\t\t{\n\t\t\t\tthis.clearSearch();\n\t\t\t\tthis.hideSearchbar();\n\t\t\t\tEvent.unbind(window, 'mousedown', this.handleClickOutside);\n\t\t\t}\n\t\t},\n\t\tsearch(value: string): void\n\t\t{\n\t\t\tif (!this.searchDialog.isOpen())\n\t\t\t{\n\t\t\t\tthis.searchDialog.show();\n\t\t\t}\n\n\t\t\tthis.searchDialog.search(value);\n\t\t},\n\t\tclearSearch()\n\t\t{\n\t\t\tthis.searchDialog.getSearchTab().clearResults();\n\t\t\tthis.searchDialog.selectTab('recents');\n\n\t\t\tif (this.$refs.searchName)\n\t\t\t{\n\t\t\t\tthis.$refs.searchName.value = '';\n\t\t\t\tthis.$refs.searchName.focus();\n\t\t\t}\n\t\t},\n\t},\n\n\twatch: {\n\t\tdepartments: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.searchDialog.destroy();\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t    class=\"humanresources-title-panel-search-bar-container\"\n\t\t    :class=\"{'--opened': showSearchBar}\"\n\t\t>\n\t\t  <div\n\t\t      class=\"humanresources-title-panel-search-bar-block__search\"\n\t\t      @click=\"showSearchbar\"\n\t\t  >\n\t\t    <BIcon :name=\"set.SEARCH_2\" :size=\"24\" class=\"hr-title-search-icon\"></BIcon>\n\t\t  </div>\n\t\t  <transition name=\"humanresources-title-panel-search-bar-fade\" mode=\"in-out\" @after-enter=\"onEnter\">\n\t\t    <div v-if=\"showSearchBar\"\n\t\t         class=\"humanresources-title-panel-search-bar-block__search-bar\"\n\t\t    >\n\t\t      <input\n\t\t          ref=\"searchName\"\n\t\t          key=\"searchInput\"\n\t\t          type=\"text\"\n\t\t          :placeholder=\"loc('HUMANRESOURCES_SEARCH_PLACEHOLDER')\"\n\t\t          v-focus\n\t\t          class=\"humanresources-title-panel-search-bar-block__search-input\"\n\t\t          @click=\"onEnter\"\n\t\t          @input=\"search($event.target.value)\"\n\t\t      >\n\t\t      <div\n\t\t          key=\"searchReset\"\n\t\t          @click=\"clearSearch\"\n\t\t          class=\"humanresources-title-panel-search-bar-block__search-reset\"\n\t\t      >\n\t\t        <div class=\"humanresources-title-panel-search-bar-block__search-cursor\"></div>\n\t\t        <BIcon\n\t\t            :name=\"set.CROSS_CIRCLE_50\"\n\t\t            :size=\"24\"\n\t\t            color=\"#2FC6F6\"\n\t\t        ></BIcon>\n\t\t      </div>\n\t\t    </div>\n\t\t  </transition>\n\t\t</div>\n\t`,\n};\n","import { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { Main } from 'ui.icon-set.api.core';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { sendData as analyticsSendData } from 'ui.analytics';\n\nimport 'ui.icon-set.main';\n\nconst MenuOption = Object.freeze({\n\taccessRights: 'access-rights',\n});\n\nexport const BurgerMenuButton = {\n\tname: 'BurgerMenuButton',\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tactionMenu: {\n\t\t\t\tvisible: false,\n\t\t\t},\n\t\t};\n\t},\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.dropdownItems = [\n\t\t\t{\n\t\t\t\tid: MenuOption.accessRights,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIG_PERMISSION_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIG_PERMISSION_DESCR'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.SHIELD,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\n\t\tactionMenuItemClickHandler(actionId: string): void\n\t\t{\n\t\t\tif (actionId === MenuOption.accessRights)\n\t\t\t{\n\t\t\t\tanalyticsSendData({ tool: 'structure', category: 'structure', event: 'open_roles' });\n\n\t\t\t\tBX.SidePanel.Instance.open('/hr/config/permission/', { usePadding: true });\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<span\n\t\t\tref=\"burgerMenuButton\"\n\t\t\t@click=\"actionMenu.visible = true\"\n\t\t>\n\t\t\t<svg\n\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\tfill=\"none\"\n\t\t\t\tclass=\"humanresources-title-panel__icon\"\n\t\t\t\t:class=\"{'--selected': actionMenu.visible }\"\n\t\t\t\t>\n\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M18.7067 15.5577C18.8172 15.5577 18.9067 15.6473 18.9067 15.7577L18.9067 17.2424C18.9067 17.3528 18.8172 17.4424 18.7067 17.4424H5.29375C5.1833 17.4424 5.09375 17.3528 5.09375 17.2424L5.09379 15.7577C5.09379 15.6473 5.18333 15.5577 5.29379 15.5577H18.7067ZM18.7067 11.5577C18.8172 11.5577 18.9067 11.6473 18.9067 11.7577L18.9067 13.2424C18.9067 13.3528 18.8172 13.4424 18.7067 13.4424H5.29375C5.1833 13.4424 5.09375 13.3528 5.09375 13.2424L5.09379 11.7577C5.09379 11.6473 5.18333 11.5577 5.29379 11.5577H18.7067ZM18.7067 7.55774C18.8172 7.55774 18.9067 7.64729 18.9067 7.75774L18.9067 9.24238C18.9067 9.35284 18.8172 9.44238 18.7067 9.44238H5.29375C5.1833 9.44238 5.09375 9.35283 5.09375 9.24237L5.09379 7.75773C5.09379 7.64728 5.18333 7.55774 5.29379 7.55774H18.7067Z\" fill=\"#525C69\"/>\n\t\t\t</svg>\n\t\t </span>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"actionMenu.visible\"\n\t\t\tid=\"title-panel-burger-menu\"\n\t\t\t:items=\"dropdownItems\"\n\t\t\t:bindElement=\"this.$refs.burgerMenuButton\"\n\t\t\t@action=\"actionMenuItemClickHandler($event)\"\n\t\t\t@close=\"this.actionMenu.visible = false\"\n\t\t/>\n\t`,\n\n};\n","import { AddButton } from './add-button/add-button.js';\nimport { SearchBar } from './search/search-bar.js';\nimport { BurgerMenuButton } from './burger-menu-button/burger-menu-button.js';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { UI } from 'ui.notification';\nimport { Dom } from 'main.core';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\n\nimport './style.css';\n\nexport const TitlePanel = {\n\tcomponents: {\n\t\tAddButton,\n\t\tBurgerMenuButton,\n\t\tSearchBar,\n\t\tBIcon,\n\t\tSet,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcanEditPermissions: false,\n\t\t\tcanAddNode: false,\n\t\t\ttoolbarStarActive: false,\n\t\t\tisHovered: false,\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.toolbarStarElement = document.getElementById('uiToolbarStar');\n\t},\n\n\tmounted()\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst permissionChecker = PermissionChecker.getInstance();\n\t\t\tthis.canEditPermissions = permissionChecker\n\t\t\t\t&& permissionChecker.hasPermissionOfAction(PermissionActions.accessEdit);\n\t\t\tthis.canAddNode = permissionChecker\n\t\t\t\t&& permissionChecker.hasPermissionOfAction(PermissionActions.departmentCreate);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('Failed to fetch data:', error);\n\t\t}\n\n\t\tconst observer = new MutationObserver(() => {\n\t\t\tthis.toolbarStarActive = Dom.hasClass(this.toolbarStarElement, 'ui-toolbar-star-active');\n\t\t});\n\n\t\tobserver.observe(this.toolbarStarElement, { attributes: true, attributeFilter: ['class'] });\n\n\t\tthis.toolbarStarActive = Dom.hasClass(this.toolbarStarElement, 'ui-toolbar-star-active');\n\t},\n\n\tname: 'title-panel',\n\n\temits: ['showWizard', 'locate'],\n\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\ttoolbarStarIcon(): string\n\t\t{\n\t\t\treturn this.toolbarStarActive ? this.set.FAVORITE_1 : this.set.FAVORITE_0;\n\t\t},\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\taddDepartment(): void\n\t\t{\n\t\t\tthis.$emit('showWizard', { source: AnalyticsSourceType.HEADER });\n\t\t},\n\t\tonLocate(nodeId: number)\n\t\t{\n\t\t\tthis.$emit('locate', nodeId);\n\t\t},\n\t\ttriggerFavoriteStar()\n\t\t{\n\t\t\tthis.toolbarStarElement.click();\n\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: this.toolbarStarActive\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_LEFT_MENU_UN_SAVED')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_LEFT_MENU_SAVED'),\n\t\t\t\tautoHideDelay: 2000,\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-title-panel\">\n\t\t  <p class=\"humanresources-title-panel__title\">\n\t\t    {{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_TITLE') }}\n\t\t  </p>\n\t\t  <BIcon :name=\"isHovered ? set.FAVORITE_1 : toolbarStarIcon\" :size=\"24\" class=\"humanresources-title-panel__star\"\n\t\t               @mouseover=\"isHovered = true\"\n\t\t               @mouseleave=\"isHovered = false\" @click=\"triggerFavoriteStar\"\n\t\t  ></BIcon>\n\t\t  <div class=\"humanresources-title-panel__separator\"></div>\n\t\t  <AddButton\n\t\t\t  v-if=\"canAddNode\"\n\t\t      @addDepartment=\"addDepartment\"\n\t\t  />\n\t\t  <div class=\"humanresources-title-panel__separator\" v-if=\"canAddNode\"></div>\n\t\t  <BurgerMenuButton v-if=\"canEditPermissions\"/>\n\t\t  <div class=\"humanresources-title-panel__separator\" v-if=\"canEditPermissions\"></div>\n\t\t  <SearchBar @locate=\"onLocate\"/>\n\t\t</div>\n\t`,\n};\n","import { SidePanel } from 'main.sidepanel';\nimport './style.css';\nimport { UserListActionMenu } from 'humanresources.company-structure.structure-components';\nimport { events } from '../../../events';\nimport { EventEmitter } from 'main.core.events';\nimport type { UserData } from 'humanresources.company-structure.utils';\n\nexport const HeadList = {\n\tname: 'headList',\n\n\tcomponents: {\n\t\tUserListActionMenu,\n\t},\n\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => [],\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tcollapsed: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'head',\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisCollapsed: false,\n\t\t\tisUpdating: true,\n\t\t\theadsVisible: false,\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.userTypes = {\n\t\t\thead: 'head',\n\t\t\tdeputy: 'deputy',\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tdefaultAvatar(): String\n\t\t{\n\t\t\treturn '/bitrix/js/humanresources/company-structure/org-chart/src/images/default-user.svg';\n\t\t},\n\t\tdropdownItems(): Array<UserData>\n\t\t{\n\t\t\treturn this.items.map((item: UserData): UserData => {\n\t\t\t\tconst workPosition = item.workPosition || this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_HEAD_POSITION');\n\n\t\t\t\treturn { ...item, workPosition };\n\t\t\t});\n\t\t},\n\t\ttitleBar(): string\n\t\t{\n\t\t\treturn this.type === this.userTypes.deputy\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_WIZARD_EMPLOYEE_DEPUTY_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_WIZARD_EMPLOYEE_HEAD_TITLE')\n\t\t\t;\n\t\t},\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\thandleUserClick(url: string): void\n\t\t{\n\t\t\tSidePanel.Instance.open(url, {\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t},\n\t\tcloseHeadList(): void\n\t\t{\n\t\t\tthis.headsVisible = false;\n\t\t\tEventEmitter.unsubscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.closeHeadList);\n\t\t},\n\t\topenHeadList(): void\n\t\t{\n\t\t\tthis.headsVisible = true;\n\t\t\tEventEmitter.subscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.closeHeadList);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div v-if=\"items.length\">\n\t\t\t<p v-if=\"title\" class=\"humanresources-tree__node_employees-title\">\n\t\t\t\t{{ title }}\n\t\t\t</p>\n\t\t\t<div\n\t\t\t\tclass=\"humanresources-tree__node_head\"\n\t\t\t\t:class=\"{ '--collapsed': collapsed }\"\n\t\t\t\tv-for=\"(item, index) in items.slice(0, 2)\"\n\t\t\t>\n\t\t\t\t<img\n\t\t\t\t\t:src=\"item.avatar ? encodeURI(item.avatar) : defaultAvatar\"\n\t\t\t\t\tclass=\"humanresources-tree__node_avatar --head\"\n\t\t\t\t\t:class=\"{ '--collapsed': collapsed }\"\n\t\t\t\t\t@click.stop=\"handleUserClick(item.url)\"\n\t\t\t\t/>\n\t\t\t\t<div class=\"humanresources-tree__node_head-text\">\n\t\t\t\t\t<span\n\t\t\t\t\t\t:bx-tooltip-user-id=\"item.id\"\n\t\t\t\t\t\tclass=\"humanresources-tree__node_head-name\"\n\t\t\t\t\t\t@click.stop=\"handleUserClick(item.url)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ item.name }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span v-if=\"!collapsed\" class=\"humanresources-tree__node_head-position\">\n\t\t\t\t\t\t{{ item.workPosition || loc('HUMANRESOURCES_COMPANY_STRUCTURE_HEAD_POSITION') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<span\n\t\t\t\t\tv-if=\"index === 1 && items.length > 2\"\n\t\t\t\t\tclass=\"humanresources-tree__node_head-rest\"\n\t\t\t\t\t:class=\"{ '--active': headsVisible }\"\n\t\t\t\t\t:data-test-id=\"'hr-company-structure_org-chart-tree__node-' + type + '-rest'\"\n\t\t\t\t\tref=\"showMoreHeadList\"\n\t\t\t\t\t@click.stop=\"openHeadList\"\n\t\t\t\t>\n\t\t\t\t\t{{ '+' + String(items.length - 2) }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t\t<UserListActionMenu\n\t\t\tv-if=\"headsVisible\"\n\t\t\t:id=\"type === userTypes.head ? 'head-list-popup-head' : 'head-list-popup-deputy'\"\n\t\t\t:items=\"dropdownItems\"\n\t\t\t:width=\"228\"\n\t\t\t:bindElement=\"$refs.showMoreHeadList[0]\"\n\t\t\t@close=\"closeHeadList\"\n\t\t\t:titleBar=\"titleBar\"\n\t\t/>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { Main, CRM } from 'ui.icon-set.api.core';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport 'ui.icon-set.main';\nimport { events } from '../../../events';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\n\nexport const MenuActions = Object.freeze({\n\teditDepartment: 'editDepartment',\n\taddDepartment: 'addDepartment',\n\teditEmployee: 'editEmployee',\n\tmoveEmployee: 'moveEmployee',\n\taddEmployee: 'addEmployee',\n\tuserInvite: 'userInvite',\n\tremoveDepartment: 'removeDepartment',\n});\n\nexport const DepartmentMenuButton = {\n\tname: 'DepartmentMenuButton',\n\temits: ['addDepartment', 'editDepartment', 'moveEmployee', 'addEmployee', 'removeDepartment', 'editEmployee', 'userInvite'],\n\n\tprops: {\n\t\tdepartmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.menuItems = [];\n\t\tthis.permissionChecker = PermissionChecker.getInstance();\n\n\t\tif (!this.permissionChecker)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.menuItems = [\n\t\t\t{\n\t\t\t\tid: MenuActions.editDepartment,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_DEPARTMENT_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_DEPARTMENT_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.EDIT_PENCIL,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.departmentEdit },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.addDepartment,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.CUBE_PLUS,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.departmentCreate },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.editEmployee,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_EMPLOYEE_LIST_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_EMPLOYEE_LIST_SUBTITLE'),\n\t\t\t\timageClass: '-hr-department-org-chart-menu-edit-list',\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.EDIT_MENU,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.moveEmployee,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_MOVE_EMPLOYEE_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_MOVE_EMPLOYEE_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.PERSON_ARROW_LEFT_1,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.userInvite,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_USER_INVITE_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_USER_INVITE_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.PERSON_LETTER,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.inviteToDepartment },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.addEmployee,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_EMPLOYEE_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_EMPLOYEE_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: CRM.PERSON_PLUS_2,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.removeDepartment,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_DEPARTMENT_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_DEPARTMENT_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.TRASH_BIN,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteRed40'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.departmentDelete },\n\t\t\t},\n\t\t];\n\n\t\tthis.menuItems = this.menuItems.filter((item) => {\n\t\t\tif (!item.permission)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.permissionChecker.hasPermission(item.permission.action, this.departmentId);\n\t\t});\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenu: {\n\t\t\t\tvisible: false,\n\t\t\t},\n\t\t};\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.$emit(actionId, actionId);\n\t\t},\n\t\tcloseMenu(): void\n\t\t{\n\t\t\tthis.menu.visible = false;\n\t\t\tEventEmitter.unsubscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.closeMenu);\n\t\t},\n\t\topenMenu(): void\n\t\t{\n\t\t\tthis.menu.visible = true;\n\t\t\tEventEmitter.subscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.closeMenu);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"menuItems.length\"\n\t\t\tclass=\"ui-icon-set --more humanresources-tree__node_department-menu-button\"\n\t\t\t:class=\"{ '--focused': this.menu.visible }\"\n\t\t\tref=\"departmentMenuButton\"\n\t\t\t@click.stop=\"openMenu\"\n\t\t>\n\t\t</div>\n\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menu.visible\"\n\t\t\t:id=\"'tree-node-department-menu-' + departmentId\"\n\t\t\t:width=\"302\"\n\t\t\t:items=\"menuItems\"\n\t\t\t:bindElement=\"this.$refs.departmentMenuButton\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"closeMenu\"\n\t\t/>\n\t`,\n};\n","import { BIcon, Set } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\n\nexport const SubdivisionAddButton = {\n\tname: 'SubdivisionAddButton',\n\temits: ['addDepartment'],\n\n\tprops: {\n\t\tdepartmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomponents: {\n\t\tBIcon,\n\t},\n\n\tcreated(): void\n\t{\n\t\tconst permissionChecker = PermissionChecker.getInstance();\n\n\t\tthis.canShow = permissionChecker\n\t\t\t&& permissionChecker.hasPermission(PermissionActions.departmentCreate, this.departmentId);\n\t},\n\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\taddSubdivision(event): void\n\t\t{\n\t\t\tthis.$emit('addDepartment');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-tree__node_add-subdivision\" v-if=\"canShow\">\n\t\t  <button class=\"humanresources-tree__node_add-button\" @click=\"addSubdivision\">\n\t\t    <BIcon :name=\"set.PLUS_20\" :size=\"32\" class=\"humanresources-tree__node_add-icon\"></BIcon>\n\t\t  </button>\n\t\t</div>\n\t`,\n};\n","import { Loc, Dom } from 'main.core';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { memberRoles, AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { UserManagementDialog } from 'humanresources.company-structure.user-management-dialog';\nimport { Hint } from 'humanresources.company-structure.structure-components';\nimport { EventEmitter } from 'main.core.events';\nimport { events } from '../../../events';\nimport { HeadList } from './head-list';\nimport { DepartmentMenuButton } from './department-menu-button';\nimport type { TreeItem, ConnectorData, TreeNodeData } from '../../../types';\nimport { SubdivisionAddButton } from './subdivision-add-button';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport './style.css';\n\nexport const TreeNode = {\n\tname: 'treeNode',\n\n\tinject: ['getTreeBounds'],\n\n\tprops: {\n\t\tnodeId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\texpandedNodes: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tzoom: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentDepartment: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['calculatePosition'],\n\n\tcomponents: {\n\t\tDepartmentMenuButton,\n\t\tHeadList,\n\t\tSubdivisionAddButton,\n\t},\n\n\tdirectives: { hint: Hint },\n\n\tdata(): TreeNodeData\n\t{\n\t\treturn {\n\t\t\tchildrenOffset: 0,\n\t\t\tchildrenMounted: false,\n\t\t\tshowInfo: true,\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.width = 278;\n\t\tthis.gap = 20;\n\t\tthis.prevChildrenOffset = 0;\n\t\tthis.prevHeight = 0;\n\t},\n\n\twatch: {\n\t\tasync head(): Promise<void>\n\t\t{\n\t\t\tawait this.$nextTick();\n\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_ADAPT_CONNECTOR_HEIGHT, {\n\t\t\t\tnodeId: this.nodeId,\n\t\t\t\tshift: this.$el.offsetHeight - this.prevHeight,\n\t\t\t});\n\t\t\tthis.prevHeight = this.$el.offsetHeight;\n\t\t},\n\t},\n\tasync mounted(): Promise<void>\n\t{\n\t\tthis.showInfo = PermissionChecker.getInstance().hasPermission(PermissionActions.structureView, this.nodeId);\n\t\tthis.$emit('calculatePosition', this.nodeId);\n\t\tawait this.$nextTick();\n\t\tthis.prevHeight = this.$el.offsetHeight;\n\t\tEventEmitter.emit(events.HR_DEPARTMENT_CONNECT, {\n\t\t\tid: this.nodeId,\n\t\t\tparentId: this.nodeData.parentId,\n\t\t\thtml: this.$el,\n\t\t\tparentsPath: this.getParentsPath(this.nodeData.parentId),\n\t\t\t...this.calculateNodePoints(),\n\t\t});\n\t},\n\tunmounted(): void\n\t{\n\t\tDom.remove(this.$el);\n\t\tconst { prevParentId } = this.nodeData;\n\t\tif (!prevParentId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$emit('calculatePosition', this.nodeId);\n\t\tEventEmitter.emit(events.HR_DEPARTMENT_DISCONNECT, {\n\t\t\tid: this.nodeId,\n\t\t\tparentId: prevParentId,\n\t\t});\n\t},\n\n\tcomputed:\n\t{\n\t\tnodeData(): TreeItem\n\t\t{\n\t\t\treturn this.departments.get(this.nodeId);\n\t\t},\n\t\tnodeClass(): { [key: string]: boolean; }\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--expanded': this.expandedNodes.includes(this.nodeId),\n\t\t\t\t'--current-department': this.isCurrentDepartment,\n\t\t\t\t'--focused': this.focusedNode === this.nodeId,\n\t\t\t\t'--with-restricted-access-rights': !this.showInfo,\n\t\t\t};\n\t\t},\n\t\tsubdivisionsClass(): { [key: string]: boolean; }\n\t\t{\n\t\t\treturn {\n\t\t\t\t'humanresources-tree__node_arrow': this.hasChildren,\n\t\t\t\t'--up': this.hasChildren && this.isExpanded,\n\t\t\t\t'--down': this.hasChildren && !this.isExpanded,\n\t\t\t\t'--transparent': !this.hasChildren,\n\t\t\t};\n\t\t},\n\t\thasChildren(): boolean\n\t\t{\n\t\t\treturn this.nodeData.children?.length > 0;\n\t\t},\n\t\tisExpanded(): boolean\n\t\t{\n\t\t\tconst isExpanded = this.expandedNodes.includes(this.nodeId);\n\t\t\tif (isExpanded)\n\t\t\t{\n\t\t\t\tthis.childrenMounted = true;\n\t\t\t}\n\n\t\t\treturn isExpanded;\n\t\t},\n\t\tisCurrentDepartment(): Boolean\n\t\t{\n\t\t\treturn this.currentDepartment === this.nodeId;\n\t\t},\n\t\thead(): ?TreeItem['heads']\n\t\t{\n\t\t\treturn this.nodeData.heads?.filter((head) => {\n\t\t\t\treturn head.role === memberRoles.head;\n\t\t\t});\n\t\t},\n\t\tdeputy(): ?TreeItem['heads']\n\t\t{\n\t\t\treturn this.nodeData.heads?.filter((head) => {\n\t\t\t\treturn head.role === memberRoles.deputyHead;\n\t\t\t});\n\t\t},\n\t\temployeeCount(): number\n\t\t{\n\t\t\treturn this.nodeData.userCount - this.nodeData.heads.length;\n\t\t},\n\t\tchildNodeStyle(): { left: String; }\n\t\t{\n\t\t\treturn { left: `${this.childrenOffset}px` };\n\t\t},\n\t\tshowSubdivisionAddButton(): boolean\n\t\t{\n\t\t\treturn this.expandedNodes.includes(this.nodeId) || this.focusedNode === this.nodeId;\n\t\t},\n\t\t...mapState(useChartStore, ['departments', 'focusedNode']),\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonDepartmentClick(targetId: string): void\n\t\t{\n\t\t\tif (!this.showInfo)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_FOCUS, {\n\t\t\t\tnodeId: this.nodeId,\n\t\t\t\tshowEmployees: targetId === 'employees',\n\t\t\t\tsubdivisionsSelected: targetId === 'subdivisions',\n\t\t\t});\n\t\t},\n\t\tcalculatePosition(nodeId: number): void\n\t\t{\n\t\t\tconst node = this.departments.get(this.nodeId);\n\n\t\t\tif (node.children.length === 0)\n\t\t\t{\n\t\t\t\tthis.childrenOffset = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst gap = this.gap * (node.children.length - 1);\n\t\t\t\tthis.prevChildrenOffset = this.childrenOffset;\n\t\t\t\tthis.childrenOffset = (this.width - (this.width * node.children.length + gap)) / 2;\n\t\t\t}\n\n\t\t\tconst offset = this.childrenOffset - this.prevChildrenOffset;\n\t\t\tif (offset !== 0)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_ADAPT_SIBLINGS, {\n\t\t\t\t\tparentId: this.nodeId,\n\t\t\t\t\tnodeId,\n\t\t\t\t\toffset,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tcontrolDepartment(action: string, source: string = AnalyticsSourceType.CARD): void\n\t\t{\n\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_CONTROL, {\n\t\t\t\tnodeId: this.nodeId,\n\t\t\t\taction,\n\t\t\t\tsource,\n\t\t\t});\n\t\t},\n\t\taddEmployee(): void\n\t\t{\n\t\t\tUserManagementDialog.openDialog({\n\t\t\t\tnodeId: this.nodeId,\n\t\t\t\ttype: 'add',\n\t\t\t});\n\t\t},\n\t\tuserInvite(): void\n\t\t{\n\t\t\tconst departmentToInvite = this.departments.get(this.nodeId).accessCode.slice(1);\n\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t'/bitrix/services/main/ajax.php?action=getSliderContent'\n\t\t\t\t+ '&c=bitrix%3Aintranet.invitation&mode=ajax'\n\t\t\t\t+ `&departments[]=${departmentToInvite}&firstInvitationBlock=invite-with-group-dp`,\n\t\t\t\t{ cacheable: false, allowChangeHistory: false, width: 1100 },\n\t\t\t);\n\t\t},\n\t\tmoveEmployee(): void\n\t\t{\n\t\t\tUserManagementDialog.openDialog({\n\t\t\t\tnodeId: this.nodeId,\n\t\t\t\ttype: 'move',\n\t\t\t});\n\t\t},\n\t\tlocPlural(phraseCode: string, count: number): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural(phraseCode, count, { '#COUNT#': count });\n\t\t},\n\t\tcalculateNodePoints(): { startPoint: ConnectorData['startPoint'], endPoint: ConnectorData['endPoint'] }\n\t\t{\n\t\t\tconst { left, top, width } = this.$el.getBoundingClientRect();\n\t\t\tconst { $el: parentNode } = this.$parent.$parent;\n\t\t\tconst {\n\t\t\t\tleft: parentLeft,\n\t\t\t\ttop: parentTop,\n\t\t\t\twidth: parentWidth,\n\t\t\t\theight: parentHeight,\n\t\t\t} = parentNode.getBoundingClientRect();\n\t\t\tconst { x: chartX, y: chartY } = this.getTreeBounds();\n\n\t\t\treturn {\n\t\t\t\tstartPoint: {\n\t\t\t\t\tx: (parentLeft - chartX + parentWidth / 2) / this.zoom,\n\t\t\t\t\ty: (parentTop - chartY + parentHeight) / this.zoom,\n\t\t\t\t},\n\t\t\t\tendPoint: {\n\t\t\t\t\tx: (left - chartX + width / 2) / this.zoom,\n\t\t\t\t\ty: (top - chartY) / this.zoom,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetParentsPath(parentId: number): Array<number>\n\t\t{\n\t\t\tlet topLevelId = parentId;\n\t\t\tconst parentsPath = [parentId];\n\t\t\twhile (topLevelId)\n\t\t\t{\n\t\t\t\tconst parentNode = this.departments.get(topLevelId);\n\t\t\t\ttopLevelId = parentNode.parentId;\n\t\t\t\tif (topLevelId)\n\t\t\t\t{\n\t\t\t\t\tparentsPath.push(topLevelId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn parentsPath;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:data-id=\"nodeId\"\n\t\t\t:class=\"nodeClass\"\n\t\t\t:data-title=\"isCurrentDepartment ? loc('HUMANRESOURCES_COMPANY_CURRENT_DEPARTMENT') : null\"\n\t\t\tclass=\"humanresources-tree__node\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"humanresources-tree__node_summary\"\n\t\t\t\t@click.stop=\"onDepartmentClick('department')\"\n\t\t\t>\n\t\t\t\t<div class=\"humanresources-tree__node_description\">\n\t\t\t\t\t<div class=\"humanresources-tree__node_department\">\n\t\t\t\t\t\t<span class=\"humanresources-tree__node_department-title\">\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tv-hint\n\t\t\t\t\t\t\t\tclass=\"humanresources-tree__node_department-title_text\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{nodeData.name}}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<DepartmentMenuButton\n\t\t\t\t\t\t\tv-if=\"showInfo && head && deputy\"\n\t\t\t\t\t\t\t:department-id=\"nodeId\"\n\t\t\t\t\t\t\t@addDepartment=\"controlDepartment\"\n\t\t\t\t\t\t\t@editDepartment=\"controlDepartment\"\n\t\t\t\t\t\t\t@editEmployee=\"controlDepartment\"\n\t\t\t\t\t\t\t@removeDepartment=\"controlDepartment\"\n\t\t\t\t\t\t\t@addEmployee=\"addEmployee\"\n\t\t\t\t\t\t\t@userInvite=\"userInvite\"\n\t\t\t\t\t\t\t@moveEmployee=\"moveEmployee\"\n\t\t\t\t\t\t></DepartmentMenuButton>\n\t\t\t\t\t</div>\n\t\t\t\t  \t<HeadList v-if=\"head && showInfo\" :items=\"head\"></HeadList>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-else-if=\"showInfo\"\n\t\t\t\t\t\tclass=\"humanresources-tree__node_load-skeleton --heads\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div v-if=\"deputy && showInfo\" class=\"humanresources-tree__node_employees\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<p class=\"humanresources-tree__node_employees-title\">\n\t\t\t\t\t\t\t\t{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_EMPLOYEES_TITLE')}}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"humanresources-tree__node_employees-count\"\n\t\t\t\t\t\t\t\t@click.stop=\"onDepartmentClick('employees')\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{locPlural('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_EMPLOYEES_COUNT', employeeCount)}}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"!deputy.length\"></div>\n\t\t\t\t\t\t<HeadList :items=\"deputy\"\n\t\t\t\t\t\t\t\t  :title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_DEPUTY_TITLE')\" \n\t\t\t\t\t\t\t\t  :collapsed=\"true\"\n\t\t\t\t\t\t\t\t  :type=\"'deputy'\">\n\t\t\t\t\t\t</HeadList>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-else-if=\"showInfo\"\n\t\t\t\t\t\tclass=\"humanresources-tree__node_load-skeleton --deputies\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"humanresources-tree__node_subdivisions\"\n\t\t\t\t\t:class=\"subdivisionsClass\"\n\t\t\t\t\tv-if=\"showInfo\"\n\t\t\t\t\t@click.stop=\"onDepartmentClick('subdivisions')\"\n\t\t\t\t>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t\tnodeData.children?.length ?\n\t\t\t\t\t\t\t\tlocPlural('HUMANRESOURCES_COMPANY_DEPARTMENT_CHILDREN_COUNT', nodeData.children.length) :\n\t\t\t\t\t\t\t\tloc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_NO_SUBDEPARTMENTS')\n\t\t\t\t\t\t}}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t  \t<SubdivisionAddButton\n\t\t\t\t\tv-if=\"showSubdivisionAddButton\"\n\t\t\t\t\t@addDepartment=\"controlDepartment('addDepartment', 'plus')\"\n\t\t\t\t\t:department-id=\"nodeId\"\n\t\t\t\t\t@click.stop\n\t\t\t\t></SubdivisionAddButton>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"nodeData.parentId === 0 && !hasChildren\"\n\t\t\t\tclass=\"humanresources-tree__node_empty-skeleton\"\n\t\t\t></div>\n\t\t\t<div\n\t\t\t\tv-if=\"hasChildren\"\n\t\t\t\tref=\"childrenNode\"\n\t\t\t\tclass=\"humanresources-tree__node_children\"\n\t\t\t\t:style=\"childNodeStyle\"\n\t\t\t>\n\t\t\t\t<TransitionGroup>\n\t\t\t\t\t<treeNode\n\t\t\t\t\t\tv-for=\"id in nodeData.children\"\n\t\t\t\t\t\tv-if=\"isExpanded || childrenMounted\"\n\t\t\t\t\t\tv-show=\"isExpanded\"\n\t\t\t\t\t\t:ref=\"'node-' + id\"\n\t\t\t\t\t\t:key=\"id\"\n\t\t\t\t\t\t:nodeId=\"id\"\n\t\t\t\t\t\t:expandedNodes=\"expandedNodes\"\n\t\t\t\t\t\t:zoom=\"zoom\"\n\t\t\t\t\t\t:currentDepartment=\"currentDepartment\"\n\t\t\t\t\t\t@calculatePosition=\"calculatePosition\"\n\t\t\t\t\t/>\n\t\t\t\t</TransitionGroup>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { getData, postData } from 'humanresources.company-structure.api';\nimport type { TreeItem } from './types';\n\nconst createTreeDataStore = (treeData: Array<TreeItem>): Map<number, TreeItem> => {\n\tconst dataMap = new Map();\n\ttreeData.forEach((item) => {\n\t\tconst { id, parentId } = item;\n\t\tconst mapItem = dataMap.get(id) ?? {};\n\t\tdataMap.set(id, { ...mapItem, ...item });\n\t\tif (parentId === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst mapParentItem = dataMap.get(parentId) ?? {};\n\t\tconst children = mapParentItem.children ?? [];\n\t\tdataMap.set(parentId, {\n\t\t\t...mapParentItem,\n\t\t\tchildren: [...children, id],\n\t\t});\n\t});\n\n\treturn dataMap;\n};\n\nexport const chartAPI = {\n\tremoveDepartment: (id: Number): Promise<void> => {\n\t\treturn getData('humanresources.api.Structure.Node.delete', { nodeId: id });\n\t},\n\tgetDepartmentsData: (): Promise<Array<TreeItem>> => {\n\t\treturn getData('humanresources.api.Structure.get', {}, { tool: 'structure', category: 'structure', event: 'open_structure' });\n\t},\n\tgetCurrentDepartments: (): Promise<number[]> => {\n\t\treturn getData('humanresources.api.Structure.Node.current');\n\t},\n\tgetDictionary: (): Promise<string> => {\n\t\treturn getData('humanresources.api.Structure.dictionary');\n\t},\n\tgetUserId: (): Promise<number> => {\n\t\treturn getData('humanresources.api.User.getCurrentId');\n\t},\n\tfirstTimeOpened: (): Promise<void> => {\n\t\treturn postData('humanresources.api.User.firstTimeOpen');\n\t},\n\tcreateTreeDataStore,\n};\n","import { Event } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport { UI } from 'ui.notification';\nimport { ButtonColor } from 'ui.buttons';\nimport { TreeNode } from './tree-node/tree-node';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { EventEmitter } from 'main.core.events';\nimport { events } from '../../events';\nimport { chartAPI } from '../../api';\nimport { MenuActions } from './tree-node/department-menu-button';\nimport { sendData as analyticsSendData } from 'ui.analytics';\nimport { OrgChartActions } from '../../actions';\nimport type { ConnectorData, TreeData } from '../../types';\nimport './style.css';\n\nexport const Tree = {\n\tname: 'tree',\n\n\tcomponents: { TreeNode },\n\n\tprops: {\n\t\tzoom: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['moveTo', 'showWizard', 'controlDetail'],\n\n\tdata(): TreeData\n\t{\n\t\treturn {\n\t\t\tconnectors: {},\n\t\t\texpandedNodes: [],\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.treeNodes = new Map();\n\t\tthis.subscribeOnEvents();\n\t\tthis.loadHeads([this.rootId]);\n\t\tthis.prevWindowWidth = window.innerWidth;\n\t\tconst [currentDepartment] = this.currentDepartments;\n\t\tif (!currentDepartment)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (currentDepartment !== this.rootId)\n\t\t{\n\t\t\tthis.expandDepartmentParents(currentDepartment);\n\t\t\tthis.focus(currentDepartment, { expandAfterFocus: true });\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.expandLowerDepartments();\n\t\tthis.focus(currentDepartment);\n\t},\n\n\tbeforeUnmount(): void\n\t{\n\t\tthis.unsubscribeOnEvents();\n\t},\n\n\tprovide(): { [key: string]: Function }\n\t{\n\t\treturn {\n\t\t\tgetTreeBounds: () => this.getTreeBounds(),\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\trootId(): number\n\t\t{\n\t\t\tconst { id: rootId } = [...this.departments.values()].find((department) => {\n\t\t\t\treturn department.parentId === 0;\n\t\t\t});\n\n\t\t\treturn rootId;\n\t\t},\n\t\t...mapState(useChartStore, ['currentDepartments', 'userId', 'focusedNode', 'departments']),\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tgetTreeBounds(): DOMRect\n\t\t{\n\t\t\treturn this.$el.getBoundingClientRect();\n\t\t},\n\t\tgetPath(id: string): string\n\t\t{\n\t\t\tconst connector = this.connectors[id];\n\t\t\tconst { startPoint, endPoint } = connector;\n\n\t\t\tif (!startPoint || !endPoint)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst lineLength = 90;\n\t\t\tconst shiftY = 1;\n\n\t\t\tconst startY = startPoint.y - shiftY;\n\t\t\tconst shadowOffset = this.focusedNode === connector.id ? 9 : 0;\n\t\t\tconst rounded = { start: '', end: '' };\n\t\t\tlet arcRadius = 0;\n\n\t\t\tif (Math.round(startPoint.x) > Math.round(endPoint.x))\n\t\t\t{\n\t\t\t\tarcRadius = 15;\n\t\t\t\trounded.start = 'a15,15 0 0 1 -15,15';\n\t\t\t\trounded.end = 'a15,15 0 0 0 -15,15';\n\t\t\t}\n\t\t\telse if (Math.round(startPoint.x) < Math.round(endPoint.x))\n\t\t\t{\n\t\t\t\tarcRadius = -15;\n\t\t\t\trounded.start = 'a15,15 0 0 0 15,15';\n\t\t\t\trounded.end = 'a15,15 0 0 1 15,15';\n\t\t\t}\n\n\t\t\tconst adjustedEndY = endPoint.y - shadowOffset;\n\n\t\t\treturn [\n\t\t\t\t`M${startPoint.x} ${startY}`,\n\t\t\t\t`V${startY + lineLength}`,\n\t\t\t\t`${String(rounded.start)}`,\n\t\t\t\t`H${endPoint.x + arcRadius}`,\n\t\t\t\t`${String(rounded.end)}`,\n\t\t\t\t`V${adjustedEndY}`,\n\t\t\t].join('');\n\t\t},\n\t\tonConnectDepartment({ data }: ConnectorData): void\n\t\t{\n\t\t\tconst { id, parentId, html } = data;\n\t\t\tthis.treeNodes.set(id, html);\n\t\t\tconst [currentDepartment] = this.currentDepartments;\n\t\t\tif (id === currentDepartment)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.moveTo(currentDepartment);\n\t\t\t\t}, 1800);\n\t\t\t}\n\n\t\t\tif (!parentId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst connector = this.connectors[`${parentId}-${id}`] ?? {};\n\t\t\tObject.assign(connector, data);\n\t\t\tif (connector.highlighted)\n\t\t\t{\n\t\t\t\tdelete this.connectors[`${parentId}-${id}`];\n\t\t\t}\n\n\t\t\tthis.connectors[`${parentId}-${id}`] = {\n\t\t\t\tshow: true,\n\t\t\t\thighlighted: false,\n\t\t\t\t...connector,\n\t\t\t};\n\t\t},\n\t\tonDisconnectDepartment({ data }: ConnectorData): void\n\t\t{\n\t\t\tconst { id, parentId } = data;\n\t\t\tdelete this.connectors[`${parentId}-${id}`];\n\t\t\tconst department = this.departments.get(id);\n\t\t\tdelete department.prevParentId;\n\t\t\tif (!department.parentId)\n\t\t\t{\n\t\t\t\tOrgChartActions.removeDepartment(id);\n\t\t\t}\n\t\t},\n\t\tonAdaptSiblings({ data }): void\n\t\t{\n\t\t\tconst { nodeId, parentId, offset } = data;\n\t\t\tconst parentDepartment = this.departments.get(parentId);\n\t\t\tif (parentDepartment.children.includes(nodeId))\n\t\t\t{\n\t\t\t\tthis.adaptConnectorsAfterMount(parentId, nodeId, offset);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.adaptConnectorsAfterUnmount(parentId, nodeId, offset);\n\t\t},\n\t\tadaptConnectorsAfterMount(parentId: number, nodeId: number, offset: number): void\n\t\t{\n\t\t\tObject.entries(this.connectors).forEach(([key, connector]) => {\n\t\t\t\tif (!connector.id)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (connector.parentId === parentId)\n\t\t\t\t{\n\t\t\t\t\tconst { x } = connector.endPoint;\n\t\t\t\t\tObject.assign(connector.endPoint, { x: x + offset });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (connector.parentsPath.includes(parentId))\n\t\t\t\t{\n\t\t\t\t\tconst { startPoint: currentStartPoint, endPoint } = connector;\n\t\t\t\t\tObject.assign(currentStartPoint, { x: currentStartPoint.x + offset });\n\t\t\t\t\tObject.assign(endPoint, { x: endPoint.x + offset });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tadaptConnectorsAfterUnmount(parentId: number, nodeId: number, offset: number): void\n\t\t{\n\t\t\tconst entries = Object.entries(this.connectors);\n\t\t\tconst { endPoint } = this.connectors[`${parentId}-${nodeId}`];\n\t\t\tconst parsedSiblingConnectors = entries.reduce((acc, [key, connector]) => {\n\t\t\t\tconst { endPoint: currentEndPoint, id, parentId: currentParentId } = connector;\n\t\t\t\tif (currentParentId !== parentId || id === nodeId)\n\t\t\t\t{\n\t\t\t\t\treturn acc;\n\t\t\t\t}\n\n\t\t\t\tconst sign = endPoint.x > currentEndPoint.x ? 1 : -1;\n\n\t\t\t\treturn {\n\t\t\t\t\t...acc,\n\t\t\t\t\t[id]: sign,\n\t\t\t\t};\n\t\t\t}, {});\n\t\t\tentries.forEach(([key, connector]) => {\n\t\t\t\tconst {\n\t\t\t\t\tid: currentId,\n\t\t\t\t\tparentId: currentParentId,\n\t\t\t\t\tparentsPath,\n\t\t\t\t\tendPoint: currentEndPoint,\n\t\t\t\t\tstartPoint: currentStartPoint,\n\t\t\t\t} = connector;\n\t\t\t\tif (currentId === nodeId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (currentParentId === parentId)\n\t\t\t\t{\n\t\t\t\t\tconst { x } = currentEndPoint;\n\t\t\t\t\tconst sign = parsedSiblingConnectors[currentId];\n\t\t\t\t\tObject.assign(currentEndPoint, { x: x + offset * sign });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst ancestorId = parentsPath?.find((id) => {\n\t\t\t\t\treturn Boolean(parsedSiblingConnectors[id]);\n\t\t\t\t});\n\t\t\t\tif (ancestorId)\n\t\t\t\t{\n\t\t\t\t\tconst ancestorSign = parsedSiblingConnectors[ancestorId];\n\t\t\t\t\tObject.assign(currentStartPoint, { x: currentStartPoint.x + offset * ancestorSign });\n\t\t\t\t\tObject.assign(currentEndPoint, { x: currentEndPoint.x + offset * ancestorSign });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tonAdaptConnectorHeight({ data }): void\n\t\t{\n\t\t\tconst { shift, nodeId } = data;\n\t\t\tObject.entries(this.connectors).forEach(([id, connector]) => {\n\t\t\t\tif (connector.parentId === nodeId)\n\t\t\t\t{\n\t\t\t\t\tObject.assign(connector.startPoint, { y: connector.startPoint.y + shift });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tcollapse(nodeId: number): void\n\t\t{\n\t\t\tthis.expandedNodes = this.expandedNodes.filter((expandedId) => expandedId !== nodeId);\n\t\t\tthis.toggleConnectorsVisibility(nodeId, false);\n\t\t\tthis.toggleConnectorHighlighting(nodeId, false);\n\t\t},\n\t\tcollapseRecursively(nodeId: number): void\n\t\t{\n\t\t\tconst deepCollapse = (id: number) => {\n\t\t\t\tthis.collapse(id);\n\t\t\t\tconst node = this.departments.get(id);\n\t\t\t\tnode.children?.forEach((childId) => {\n\t\t\t\t\tif (this.expandedNodes.includes(childId))\n\t\t\t\t\t{\n\t\t\t\t\t\tdeepCollapse(childId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t\tconst { parentId } = this.departments.get(nodeId);\n\t\t\tconst expandedNode = this.expandedNodes.find((id) => {\n\t\t\t\tconst node = this.departments.get(id);\n\n\t\t\t\treturn node.parentId === parentId;\n\t\t\t});\n\t\t\tif (expandedNode)\n\t\t\t{\n\t\t\t\tdeepCollapse(expandedNode);\n\t\t\t}\n\t\t},\n\t\texpand(departmentId: number): void\n\t\t{\n\t\t\tthis.collapseRecursively(departmentId);\n\t\t\tthis.expandedNodes = [...this.expandedNodes, departmentId];\n\t\t\tthis.toggleConnectorsVisibility(departmentId, true);\n\t\t\tthis.toggleConnectorHighlighting(departmentId, true);\n\t\t\tconst department = this.departments.get(departmentId);\n\t\t\tconst childrenWithoutHeads = department.children.filter((childId) => {\n\t\t\t\treturn !this.departments.get(childId).heads;\n\t\t\t});\n\t\t\tif (childrenWithoutHeads.length > 0)\n\t\t\t{\n\t\t\t\tthis.loadHeads(childrenWithoutHeads);\n\t\t\t}\n\n\t\t\tanalyticsSendData({ tool: 'structure', category: 'structure', event: 'expand_department' });\n\t\t},\n\t\tfocus(nodeId: number, options: Object = {}): void\n\t\t{\n\t\t\tconst { expandAfterFocus = false, showEmployees = false, subdivisionsSelected = false } = options;\n\t\t\tconst hasChildren = this.departments.get(nodeId).children?.length > 0;\n\n\t\t\tlet shouldExpand = expandAfterFocus || !this.expandedNodes.includes(nodeId);\n\t\t\tif (showEmployees)\n\t\t\t{\n\t\t\t\tshouldExpand = this.expandedNodes.includes(nodeId);\n\t\t\t}\n\n\t\t\tif (subdivisionsSelected || !hasChildren)\n\t\t\t{\n\t\t\t\tthis.collapseRecursively(nodeId);\n\t\t\t}\n\n\t\t\tif (hasChildren && shouldExpand)\n\t\t\t{\n\t\t\t\tthis.expand(nodeId);\n\t\t\t}\n\n\t\t\tif (this.focusedNode && !this.expandedNodes.includes(this.focusedNode))\n\t\t\t{\n\t\t\t\tthis.toggleConnectorHighlighting(this.focusedNode, false);\n\t\t\t}\n\n\t\t\tOrgChartActions.focusDepartment(nodeId);\n\t\t\tthis.toggleConnectorHighlighting(this.focusedNode, true);\n\t\t},\n\t\tonFocusDepartment({ data }: { nodeId: number }): void\n\t\t{\n\t\t\tconst { nodeId, showEmployees, subdivisionsSelected } = data;\n\t\t\tthis.focus(nodeId, { showEmployees, subdivisionsSelected });\n\t\t\tthis.$emit('controlDetail', {\n\t\t\t\tshowEmployees,\n\t\t\t\tpreventSwitch: subdivisionsSelected,\n\t\t\t});\n\t\t},\n\t\tonControlDepartment({ data }): void\n\t\t{\n\t\t\tconst { action, nodeId, source } = data;\n\t\t\tconst isEditMode = action === MenuActions.editDepartment\n\t\t\t\t|| action === MenuActions.editEmployee;\n\n\t\t\tif (isEditMode)\n\t\t\t{\n\t\t\t\tconst type = action === MenuActions.editDepartment\n\t\t\t\t\t? 'department' : 'employees';\n\t\t\t\tthis.$emit('showWizard', { nodeId, isEditMode: true, type, source });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (action === MenuActions.addDepartment)\n\t\t\t{\n\t\t\t\tthis.$emit('showWizard', { nodeId, isEditMode: false, showEntitySelector: false, source });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.tryRemoveDepartment(nodeId);\n\t\t},\n\t\ttryRemoveDepartment(nodeId: number): void\n\t\t{\n\t\t\tconst messageBox = MessageBox.create({\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_TITLE'),\n\t\t\t\tmessage: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_MESSAGE'),\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\tonOk: async (dialog: MessageBox) => {\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tawait this.removeDepartment(nodeId);\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_REMOVED'),\n\t\t\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t}\n\t\t\t\t\tcatch\n\t\t\t\t\t{\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_ERROR'),\n\t\t\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonCancel: (dialog: MessageBox) => dialog.close(),\n\t\t\t\tminWidth: 250,\n\t\t\t\tmaxWidth: 320,\n\t\t\t\tminHeight: 175,\n\t\t\t\tokCaption: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_OK_CAPTION'),\n\t\t\t\tpopupOptions: { className: 'humanresources-tree__message-box', overlay: { opacity: 40 } },\n\t\t\t});\n\t\t\tconst okButton = messageBox.getOkButton();\n\t\t\tconst cancelButton = messageBox.getCancelButton();\n\t\t\tokButton.setRound(true);\n\t\t\tcancelButton.setRound(true);\n\t\t\tokButton.setColor(ButtonColor.DANGER);\n\t\t\tcancelButton.setColor(ButtonColor.LIGHT_BORDER);\n\t\t\tmessageBox.show();\n\t\t},\n\t\tasync removeDepartment(nodeId: number): Promise<void>\n\t\t{\n\t\t\tawait chartAPI.removeDepartment(nodeId);\n\t\t\tconst removableDepartment = this.departments.get(nodeId);\n\t\t\tconst { parentId, children: removableDeparmentChildren = [] } = removableDepartment;\n\t\t\tif (removableDeparmentChildren.length > 0)\n\t\t\t{\n\t\t\t\tthis.collapse(nodeId);\n\t\t\t}\n\n\t\t\tOrgChartActions.moveSubordinatesToParent(nodeId);\n\t\t\tawait this.$nextTick();\n\t\t\tOrgChartActions.markDepartmentAsRemoved(nodeId);\n\t\t\tthis.focus(parentId, { expandAfterFocus: true });\n\t\t\tthis.moveTo(parentId);\n\t\t},\n\t\ttoggleConnectorsVisibility(parentId: number, show: boolean): void\n\t\t{\n\t\t\tconst { children } = this.departments.get(parentId);\n\t\t\tchildren.forEach((childId) => {\n\t\t\t\tconst connector = this.connectors[`${parentId}-${childId}`] ?? {};\n\t\t\t\tthis.connectors = {\n\t\t\t\t\t...this.connectors,\n\t\t\t\t\t[`${parentId}-${childId}`]: { ...connector, show },\n\t\t\t\t};\n\t\t\t\tif (this.expandedNodes.includes(childId))\n\t\t\t\t{\n\t\t\t\t\tthis.toggleConnectorsVisibility(childId, show);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttoggleConnectorHighlighting(nodeId: number, expanded: boolean): void\n\t\t{\n\t\t\tconst { parentId } = this.departments.get(nodeId);\n\t\t\tif (!parentId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!expanded)\n\t\t\t{\n\t\t\t\tthis.connectors[`${parentId}-${nodeId}`] = {\n\t\t\t\t\t...this.connectors[`${parentId}-${nodeId}`],\n\t\t\t\t\thighlighted: false,\n\t\t\t\t};\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst highlightedConnector = this.connectors[`${parentId}-${nodeId}`] ?? {};\n\t\t\tdelete this.connectors[`${parentId}-${nodeId}`];\n\t\t\tthis.connectors = {\n\t\t\t\t...this.connectors,\n\t\t\t\t[`${parentId}-${nodeId}`]: {\n\t\t\t\t\t...highlightedConnector,\n\t\t\t\t\thighlighted: true,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\texpandDepartmentParents(nodeId: number): void\n\t\t{\n\t\t\tlet { parentId } = this.departments.get(nodeId);\n\t\t\twhile (parentId)\n\t\t\t{\n\t\t\t\tif (!this.expandedNodes.includes(parentId))\n\t\t\t\t{\n\t\t\t\t\tthis.expand(parentId);\n\t\t\t\t}\n\n\t\t\t\tparentId = this.departments.get(parentId).parentId;\n\t\t\t}\n\t\t},\n\t\texpandLowerDepartments(): void\n\t\t{\n\t\t\tlet expandLevel = 0;\n\t\t\tconst expandRecursively = (departmentId: number) => {\n\t\t\t\tconst { children = [] } = this.departments.get(departmentId);\n\t\t\t\tif (expandLevel === 4 || children.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.expand(departmentId);\n\t\t\t\texpandLevel += 1;\n\t\t\t\tconst middleBound = Math.trunc(children.length / 2);\n\t\t\t\tconst childId = children[middleBound];\n\t\t\t\tif (this.departments.get(childId).children?.length > 0)\n\t\t\t\t{\n\t\t\t\t\texpandRecursively(childId);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor (let i = middleBound - 1; i >= 0; i--)\n\t\t\t\t{\n\t\t\t\t\tif (traverseSibling(children[i]))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (let i = middleBound + 1; i < children.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (traverseSibling(children[i]))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst traverseSibling = (siblingId: number) => {\n\t\t\t\tconst { children: currentChildren = [] } = this.departments.get(siblingId);\n\n\t\t\t\tif (currentChildren.length > 0)\n\t\t\t\t{\n\t\t\t\t\texpandRecursively(siblingId);\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\texpandRecursively(this.rootId);\n\t\t},\n\t\tlocateToCurrentDepartment(): void\n\t\t{\n\t\t\tconst [currentDepartment] = this.currentDepartments;\n\t\t\tif (!currentDepartment)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.expandDepartmentParents(currentDepartment);\n\t\t\tthis.focus(currentDepartment, { expandAfterFocus: true });\n\t\t\tthis.moveTo(currentDepartment);\n\t\t\tOrgChartActions.searchUserInDepartment(this.userId);\n\t\t},\n\t\tasync locateToDepartment(nodeId: number): Promise<void>\n\t\t{\n\t\t\tawait this.expandDepartmentParents(nodeId);\n\t\t\tawait this.focus(nodeId, { expandAfterFocus: true });\n\t\t\tawait this.moveTo(nodeId);\n\t\t},\n\t\tasync moveTo(nodeId: number): Promise<void>\n\t\t{\n\t\t\tawait this.$nextTick();\n\t\t\tconst treeRect = this.getTreeBounds();\n\t\t\tconst centerX = treeRect.x + treeRect.width / 2;\n\t\t\tconst centerY = treeRect.y + treeRect.height / 2;\n\t\t\tconst treeNode = this.treeNodes.get(nodeId);\n\t\t\tconst treeNodeRect = treeNode.getBoundingClientRect();\n\t\t\tthis.$emit('moveTo', {\n\t\t\t\tx: centerX - treeNodeRect.x - treeNodeRect.width / 2,\n\t\t\t\ty: centerY - treeNodeRect.y - treeNodeRect.height / 2,\n\t\t\t\tnodeId,\n\t\t\t});\n\t\t},\n\t\tloadHeads(departmentIds: number[]): void\n\t\t{\n\t\t\tconst store = useChartStore();\n\t\t\tstore.loadHeads(departmentIds);\n\t\t},\n\t\tsubscribeOnEvents(): void\n\t\t{\n\t\t\tthis.events = {\n\t\t\t\t[events.HR_DEPARTMENT_CONNECT]: this.onConnectDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_DISCONNECT]: this.onDisconnectDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_FOCUS]: this.onFocusDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_CONTROL]: this.onControlDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_ADAPT_SIBLINGS]: this.onAdaptSiblings,\n\t\t\t\t[events.HR_DEPARTMENT_ADAPT_CONNECTOR_HEIGHT]: this.onAdaptConnectorHeight,\n\t\t\t};\n\t\t\tObject.entries(this.events).forEach(([event, handle]) => {\n\t\t\t\tEventEmitter.subscribe(event, handle);\n\t\t\t});\n\t\t\tEvent.bind(window, 'resize', this.onResizeWindow);\n\t\t},\n\t\tunsubscribeOnEvents(): void\n\t\t{\n\t\t\tObject.entries(this.events).forEach(([event, handle]) => {\n\t\t\t\tEventEmitter.unsubscribe(event, handle);\n\t\t\t});\n\t\t\tEvent.unbind(window, 'resize', this.onResizeWindow);\n\t\t},\n\t\tonResizeWindow(): void\n\t\t{\n\t\t\tconst offset = (window.innerWidth - this.prevWindowWidth) / 2;\n\t\t\tthis.prevWindowWidth = window.innerWidth;\n\t\t\tif (offset === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tObject.keys(this.connectors).forEach((key) => {\n\t\t\t\tconst connector = this.connectors[key];\n\t\t\t\tif (connector.startPoint && connector.endPoint)\n\t\t\t\t{\n\t\t\t\t\tconst startPointX = connector.startPoint.x;\n\t\t\t\t\tconst endPointX = connector.endPoint.x;\n\t\t\t\t\tObject.assign(connector.startPoint, { x: startPointX + offset });\n\t\t\t\t\tObject.assign(connector.endPoint, { x: endPointX + offset });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"humanresources-tree\"\n\t\t\tv-if=\"departments.size > 0\"\n\t\t>\n\t\t\t<TreeNode\n\t\t\t\tclass=\"--root\"\n\t\t\t\t:key=\"rootId\"\n\t\t\t\t:nodeId=\"rootId\"\n\t\t\t\t:expandedNodes=\"[...expandedNodes]\"\n\t\t\t\t:zoom=\"zoom\"\n\t\t\t\t:currentDepartment=\"currentDepartments[0]\"\n\t\t\t/>\n\t\t\t<svg class=\"humanresources-tree__connectors\" fill=\"none\">\n\t\t\t\t<marker\n\t\t\t\t\tid='arrow'\n\t\t\t\t\tmarkerUnits='userSpaceOnUse'\n\t\t\t\t\tmarkerWidth='20'\n\t\t\t\t\tmarkerHeight='12'\n\t\t\t\t\trefX='10'\n\t\t\t\t\trefY='10.5'\n\t\t\t\t>\n\t\t\t\t\t<path d=\"M1 1L10 10L19 1\" class=\"--highlighted\" />\n\t\t\t\t</marker>\n\t\t\t\t<path\n\t\t\t\t\tv-for=\"(connector, id) in connectors\"\n\t\t\t\t\tv-show=\"connector.show\"\n\t\t\t\t\t:ref=\"id\"\n\t\t\t\t\t:marker-end=\"connector.highlighted ? 'url(#arrow)' : null\"\n\t\t\t\t\t:class=\"{ '--highlighted': connector.highlighted }\"\n\t\t\t\t\t:id=\"id\"\n\t\t\t\t\t:d=\"getPath(id)\"\n\t\t\t\t></path>\n\t\t\t</svg>\n\t\t</div>\n\t`,\n};\n","export const TransformPanel = {\n\tname: 'transform-panel',\n\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['locate', 'update:modelValue'],\n\n\tdata(): { selectedId: string; }\n\t{\n\t\treturn {\n\t\t\tselectedId: '',\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.actions = Object.freeze({\n\t\t\tzoomIn: 'zoomIn',\n\t\t\tzoomOut: 'zoomOut',\n\t\t\tlocate: 'locate',\n\t\t\tnavigate: 'navigate',\n\t\t});\n\t},\n\n\tcomputed:\n\t{\n\t\tzoomInPercent(): string\n\t\t{\n\t\t\tconst percent = '<span class=\"humanresources-transform-panel__zoom_percent\">%</span>';\n\n\t\t\treturn `${(this.modelValue.zoom * 100).toFixed(0)}${percent}`;\n\t\t},\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonZoom(zoomIn: boolean): void\n\t\t{\n\t\t\tconst leftBound = 0.2;\n\t\t\tconst rightBound = 3;\n\t\t\tlet direction = -1;\n\t\t\tif (zoomIn)\n\t\t\t{\n\t\t\t\tdirection = 1;\n\t\t\t\tthis.selectedId = this.actions.zoomIn;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selectedId = this.actions.zoomOut;\n\t\t\t}\n\n\t\t\tconst zoom = Number((this.modelValue.zoom + leftBound * direction).toFixed(1));\n\t\t\tif (zoom < leftBound || zoom > rightBound)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('update:modelValue', { ...this.modelValue, zoom });\n\t\t},\n\t\tonLocate(): void\n\t\t{\n\t\t\tconst { locate } = this.actions;\n\t\t\tthis.$emit(locate);\n\t\t\tthis.selectedId = locate;\n\t\t},\n\t\tonfocusout(): void\n\t\t{\n\t\t\tthis.selectedId = '';\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-transform-panel\" @focusout=\"onfocusout\" tabindex=\"-1\">\n\t\t\t<div\n\t\t\t\tclass=\"humanresources-transform-panel__locate\"\n\t\t\t\t:class=\"{ '--selected': selectedId === actions.locate }\"\n\t\t\t\t@click=\"onLocate\"\n\t\t\t>\n\t\t\t\t{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_LOCATE')}}\n\t\t\t</div>\n\t\t\t<div class=\"humanresources-transform-panel__separator\"></div>\n\t\t\t<div class=\"humanresources-transform-panel__zoom\">\n\t\t\t\t<svg\n\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tclass=\"humanresources-transform-panel__icon --zoom-out\"\n\t\t\t\t\t:class=\"{ '--selected': selectedId === actions.zoomOut }\"\n\t\t\t\t\t@click=\"onZoom(false)\"\n\t\t\t\t>\n\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M4 8.66671V7.33337H7.33333H8.66667H12V8.66671H8.66667H7.33333H4Z\" fill=\"#6A737F\"/>\n\t\t\t\t</svg>\n\t\t\t\t<span v-html=\"zoomInPercent\"></span>\n\t\t\t\t<svg\n\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tclass=\"humanresources-transform-panel__icon --zoom-in\"\n\t\t\t\t\t:class=\"{ '--selected': selectedId === actions.zoomIn }\"\n\t\t\t\t\t@click=\"onZoom(true)\"\n\t\t\t\t>\n\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M7.83333 4H9.16667V7.33333H12.5V8.66667H9.16667V12H7.83333V8.66667H4.5V7.33333H7.83333V4Z\" fill=\"#6A737F\"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export const DetailPanelCollapsedTitle = {\n\tname: 'detailPanelCollapsedTitle',\n\n\tprops:\n\t{\n\t\ttitle:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tavatars:\n\t\t{\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomputed:\n\t{\n\t\tmaxVisibleAvatarsCount(): Number\n\t\t{\n\t\t\treturn 2;\n\t\t},\n\t\tadditionalCount(): Number\n\t\t{\n\t\t\treturn this.avatars.length > this.maxVisibleAvatarsCount ? this.avatars.length - this.maxVisibleAvatarsCount : 0;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-detail-panel__collapsed-title\">\n\t\t\t<template v-for=\"(avatar, index) in avatars\">\n\t\t\t\t<img\n\t\t\t\t\tv-if=\"index < this.maxVisibleAvatarsCount\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:src=\"encodeURI(avatar)\"\n\t\t\t\t\tclass=\"humanresources-detail-panel__collapsed-title-avatar\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<div\n\t\t\t\tv-if=\"avatars.length > maxVisibleAvatarsCount\"\n\t\t\t\tclass=\"humanresources-detail-panel__collapsed-title-avatar --additional\"\n\t\t\t>\n\t\t\t +{{ additionalCount }}\t\n\t\t\t</div>\n\t\t\t<div class=\"humanresources-detail-panel__title\">{{ title }}</div>\n\t\t</div>\n\t`,\n};\n","import { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { Main, CRM } from 'ui.icon-set.api.core';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\n\nimport '../../style.css';\nimport 'ui.icon-set.main';\nimport 'ui.icon-set.crm';\n\nconst MenuOption = Object.freeze({\n\teditDepartment: 'editDepartment',\n\taddDepartment: 'addDepartment',\n\teditEmployee: 'editEmployee',\n\tmoveEmployee: 'moveEmployee',\n\tuserInvite: 'userInvite',\n\taddEmployee: 'addEmployee',\n\tremoveDepartment: 'removeDepartment',\n});\n\nexport const DetailPanelEditButton = {\n\tname: 'detailPanelEditButton',\n\temits: ['editDepartment', 'addDepartment', 'editEmployee', 'addEmployee', 'removeDepartment', 'moveEmployee', 'userInvite'],\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t\tBIcon,\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.permissionChecker = PermissionChecker.getInstance();\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.$emit(actionId, { role: this.role, bindElement: this.$refs.detailPanelEditButton });\n\t\t},\n\t},\n\n\tcomputed: {\n\t\t...mapState(useChartStore, ['focusedNode']),\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\tmenuItems(): Array\n\t\t{\n\t\t\tif (!this.permissionChecker)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.editDepartment,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_DEPARTMENT_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_DEPARTMENT_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.EDIT_PENCIL,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.departmentEdit },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.addDepartment,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.CUBE_PLUS,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.departmentCreate },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.editEmployee,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_EMPLOYEE_LIST_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_EMPLOYEE_LIST_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.EDIT_MENU,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.moveEmployee,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_MOVE_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_MOVE_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.PERSON_ARROW_LEFT_1,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.userInvite,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_USER_INVITE_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_USER_INVITE_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.PERSON_LETTER,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.inviteToDepartment },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.addEmployee,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: CRM.PERSON_PLUS_2,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.removeDepartment,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_DEPARTMENT_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_DEPARTMENT_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.TRASH_BIN,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteRed40'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.departmentDelete },\n\t\t\t\t},\n\t\t\t].filter((item) => {\n\t\t\t\tif (!item.permission)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn this.permissionChecker.hasPermission(item.permission.action, this.focusedNode);\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"menuItems.length\"\n\t\t\tclass=\"humanresources-detail-panel__edit-button\"\n\t\t\t:class=\"{ '--focused': menuVisible }\"\n\t\t\t:ref=\"'detailPanelEditButton'\"\n\t\t\tdata-id=\"hr-department-detail-panel__edit-menu-button\"\n\t\t\t@click.stop=\"menuVisible = true\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\tclass=\"humanresources-detail-panel__edit-button-icon\"\n\t\t\t\t:name=\"set.MORE\"\n\t\t\t\t:size=\"20\"\n\t\t\t/>\n\t\t</div>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menuVisible\"\n\t\t\tid=\"department-detail-content-edit-menu\"\n\t\t\t:items=\"menuItems\"\n\t\t\t:width=\"302\"\n\t\t\t:bindElement=\"$refs.detailPanelEditButton\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"menuVisible = false\"\n\t\t/>\n\t`,\n};\n","import { DetailPanelCollapsedTitle } from './detail-panel-collapsed-title';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { memberRoles, AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { DepartmentContent } from 'humanresources.company-structure.department-content';\nimport { UserManagementDialog } from 'humanresources.company-structure.user-management-dialog';\nimport { Hint } from 'humanresources.company-structure.structure-components';\nimport { DetailPanelEditButton } from './detail-panel-edit-button';\n\nimport './style.css';\n\nexport const DetailPanel = {\n\tname: 'detailPanel',\n\n\temits: ['showWizard', 'removeDepartment', 'update:modelValue'],\n\n\tcomponents: { DepartmentContent, DetailPanelCollapsedTitle, DetailPanelEditButton },\n\n\tdirectives: { hint: Hint },\n\n\tprops: {\n\t\tpreventPanelSwitch: Boolean,\n\t\tmodelValue: Boolean,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttitle: '',\n\t\t\tisCollapsed: true,\n\t\t\tisLoading: true,\n\t\t\tneedToShowLoader: false,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t\tdefaultAvatar(): String\n\t\t{\n\t\t\treturn '/bitrix/js/humanresources/company-structure/org-chart/src/images/default-user.svg';\n\t\t},\n\t\theadAvatarsArray(): Array\n\t\t{\n\t\t\tconst heads = this.departments.get(this.focusedNode).heads ?? [];\n\n\t\t\treturn heads\n\t\t\t\t?.filter((employee) => employee.role === memberRoles.head)\n\t\t\t\t?.map((employee) => employee.avatar || this.defaultAvatar) ?? []\n\t\t\t;\n\t\t},\n\t},\n\n\tmethods:\n\t{\n\t\ttoggleCollapse(): void\n\t\t{\n\t\t\tthis.$emit('update:modelValue', !this.isCollapsed);\n\t\t},\n\t\tupdateDetailPageHandler(nodeId: number, oldId: number): void\n\t\t{\n\t\t\tif (!this.preventPanelSwitch && oldId !== 0)\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', false);\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tconst department = this.departments.get(nodeId);\n\n\t\t\tthis.title = department.name ?? '';\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\taddEmployee(): void\n\t\t{\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tUserManagementDialog.openDialog({\n\t\t\t\tnodeId,\n\t\t\t\ttype: 'add',\n\t\t\t});\n\t\t},\n\t\tuserInvite(): void\n\t\t{\n\t\t\tconst departmentToInvite = this.departments.get(this.focusedNode).accessCode.slice(1);\n\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t'/bitrix/services/main/ajax.php?action=getSliderContent'\n\t\t\t\t+ '&c=bitrix%3Aintranet.invitation&mode=ajax'\n\t\t\t\t+ `&departments[]=${departmentToInvite}&firstInvitationBlock=invite-with-group-dp`,\n\t\t\t\t{ cacheable: false, allowChangeHistory: false, width: 1100 },\n\t\t\t);\n\t\t},\n\t\tmoveEmployee(): void\n\t\t{\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tUserManagementDialog.openDialog({\n\t\t\t\tnodeId,\n\t\t\t\ttype: 'move',\n\t\t\t});\n\t\t},\n\t\teditEmployee(): void\n\t\t{\n\t\t\tthis.$emit('showWizard', {\n\t\t\t\tnodeId: this.focusedNode,\n\t\t\t\tisEditMode: true,\n\t\t\t\ttype: 'employees',\n\t\t\t\tsource: AnalyticsSourceType.DETAIL,\n\t\t\t});\n\t\t},\n\t\teditDepartment(): void\n\t\t{\n\t\t\tthis.$emit('showWizard', {\n\t\t\t\tnodeId: this.focusedNode,\n\t\t\t\tisEditMode: true,\n\t\t\t\ttype: 'department',\n\t\t\t\tsource: AnalyticsSourceType.DETAIL,\n\t\t\t});\n\t\t},\n\t\taddDepartment(): void\n\t\t{\n\t\t\tthis.$emit('showWizard', {\n\t\t\t\tnodeId: this.focusedNode,\n\t\t\t\tisEditMode: false,\n\t\t\t\tshowEntitySelector: false,\n\t\t\t\tsource: AnalyticsSourceType.DETAIL,\n\t\t\t});\n\t\t},\n\t\tremoveDepartment(): void\n\t\t{\n\t\t\tthis.$emit('removeDepartment', this.focusedNode);\n\t\t},\n\t\tshowLoader(): void\n\t\t{\n\t\t\tthis.needToShowLoader = true;\n\t\t},\n\t\thideLoader(): void\n\t\t{\n\t\t\tthis.needToShowLoader = false;\n\t\t},\n\t},\n\n\twatch: {\n\t\tfocusedNode(newId: number, oldId: number): void\n\t\t{\n\t\t\tthis.updateDetailPageHandler(newId, oldId);\n\t\t},\n\t\tmodelValue(collapsed: boolean): void\n\t\t{\n\t\t\tthis.isCollapsed = collapsed;\n\t\t},\n\t\tdepartments: {\n\t\t\thandler(newDepartments): void\n\t\t\t{\n\t\t\t\tconst department = newDepartments.get(this.focusedNode);\n\t\t\t\tif (department)\n\t\t\t\t{\n\t\t\t\t\tthis.title = department.name ?? '';\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"['humanresources-detail-panel', { '--collapsed': isCollapsed }]\"\n\t\t\tv-on=\"isCollapsed ? { click: toggleCollapse } : {}\"\n\t\t\tdata-id=\"hr-department-detail-panel__container\"\n\t\t>\n\t\t\t<div\n\t\t\t\tv-if=\"!isLoading\"\n\t\t\t\tclass=\"humanresources-detail-panel-container\"\n\t\t\t\t:class=\"{ '--hide': needToShowLoader && !isCollapsed }\"\n\t\t\t>\n\t\t\t\t<div class=\"humanresources-detail-panel__head\">\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-if=\"!isCollapsed\"\n\t\t\t\t\t\tv-hint\n\t\t\t\t\t\tclass=\"humanresources-detail-panel__title\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<DetailPanelCollapsedTitle\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\t:title=\"title\"\n\t\t\t\t\t\t:avatars=\"headAvatarsArray\"\n\t\t\t\t\t>\n\t\t\t\t\t</DetailPanelCollapsedTitle>\n\t\t\t\t\t<div class=\"humanresources-detail-panel__header_buttons_container\">\n\t\t\t\t\t\t<DetailPanelEditButton\n\t\t\t\t\t\t\tv-if=\"!isCollapsed\"\n\t\t\t\t\t\t\t@addEmployee=\"addEmployee\"\n\t\t\t\t\t\t\t@editEmployee=\"editEmployee\"\n\t\t\t\t\t\t\t@editDepartment=\"editDepartment\"\n\t\t\t\t\t\t\t@addDepartment=\"addDepartment\"\n\t\t\t\t\t\t\t@moveEmployee=\"moveEmployee\"\n\t\t\t\t\t\t\t@removeDepartment=\"removeDepartment\"\n\t\t\t\t\t\t\t@userInvite=\"userInvite\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"humanresources-detail-panel__collapse_button --icon\"\n\t\t\t\t\t\t\t@click=\"toggleCollapse\"\n\t\t\t\t\t\t\t:class=\"{ '--collapsed': isCollapsed }\"\n\t\t\t\t\t\t\tdata-id=\"hr-department-detail-panel__collapse-button\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"humanresources-detail-panel__content\" v-show=\"!isCollapsed\">\n\t\t\t\t\t<DepartmentContent\n\t\t\t\t\t\t@editEmployee=\"editEmployee\"\n\t\t\t\t\t\t@showDetailLoader=\"showLoader\"\n\t\t\t\t\t\t@hideDetailLoader=\"hideLoader\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"needToShowLoader && !isCollapsed\" class=\"humanresources-detail-panel-loader-container\"/>\n\t\t</div>\n\t`,\n};\n","import 'ui.buttons';\nimport 'ui.forms';\nimport './style.css';\nimport { chartAPI } from '../../api';\nimport { events } from '../../events';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport type { FirstPopupData } from '../../types';\n\nexport const FirstPopup = {\n\tname: 'FirstPopup',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\n\tdata(): FirstPopupData\n\t{\n\t\treturn {\n\t\t\tshow: false,\n\t\t\ttitle: '',\n\t\t\tdescription: '',\n\t\t\tsubDescription: '',\n\t\t\tfeatures: [],\n\t\t};\n\t},\n\tasync mounted(): Promise<void>\n\t{\n\t\tthis.title = this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_TITLE');\n\t\tthis.description = this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_DESCRIPTION');\n\t\tthis.subDescription = this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_SUB_DESCRIPTION');\n\t\tthis.features = [\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_1'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_2'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_3'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_4'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_5'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_6'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_7'),\n\t\t];\n\n\t\tconst { firstTimeOpened } = await chartAPI.getDictionary();\n\t\tthis.show = firstTimeOpened === 'N' && this.title.length > 0;\n\t},\n\n\tmethods: {\n\t\tclosePopup(): void\n\t\t{\n\t\t\tchartAPI.firstTimeOpened();\n\t\t\tthis.show = false;\n\t\t\ttop.BX.Event.EventEmitter.emit(events.HR_FIRST_POPUP_SHOW);\n\t\t},\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"show\" class=\"first-popup\">\n\t\t\t<div class=\"first-popup-overlay\" @click=\"closePopup\"></div>\n\t\t\t<div class=\"first-popup-content\">\n\t\t\t\t<div class=\"title\">{{ title }}</div>\n\t\t\t\t<div class=\"first-popup-left\">\n\t\t\t\t\t<p class=\"description\">{{ description }}</p>\n\t\t\t\t\t<p class=\"sub-description\">{{ subDescription }}</p>\n\t\t\t\t\t<div class=\"first-popup-list\">\n\t\t\t\t\t\t<div class=\"first-popup-list-item\" v-for=\"(feature, index) in features\" :key=\"index\">\n\t\t\t\t\t\t\t<div class=\"first-popup-list-item-point\"></div>\n\t\t\t\t\t\t\t<div class=\"first-popup-list-item-feature\">{{ feature }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class=\"ui-btn ui-btn-success first-popup-ui-btn\" @click=\"closePopup\">\n\t\t\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_BUTTON_START') }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"first-popup-right\">\n\t\t\t\t\t<video\n\t\t\t\t\t\tsrc=\"/bitrix/js/humanresources/company-structure/org-chart/src/components/first-popup/images/preview.webm\"\n\t\t\t\t\t\tautoplay\n\t\t\t\t\t\tloop\n\t\t\t\t\t\tmuted\n\t\t\t\t\t\tplaysinline\n\t\t\t\t\t\tclass=\"first-popup-animation\"\n\t\t\t\t\t></video>\n\t\t\t\t</div>\n\t\t\t\t<BIcon :name=\"set.CROSS_25\" :size=\"24\" class=\"first-popup-close\" @click=\"closePopup\"></BIcon>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { Confetti } from 'ui.confetti';\nimport { mapState } from 'ui.vue3.pinia';\nimport { TransformCanvas } from 'humanresources.company-structure.canvas';\nimport { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { TitlePanel } from './components/title-panel/title-panel';\nimport { Tree } from './components/tree/tree';\nimport { TransformPanel } from './components/transfrom-panel';\nimport { DetailPanel } from './components/detail-panel/detail-panel';\nimport { FirstPopup } from './components/first-popup/first-popup';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { ChartWizard } from 'humanresources.company-structure.chart-wizard';\nimport { getInvitedUserData } from 'humanresources.company-structure.utils';\nimport { chartAPI } from './api';\nimport { events } from './events';\nimport { OrgChartActions } from './actions';\nimport { sendData as analyticsSendData } from 'ui.analytics';\n\nimport type { ChartData } from './types';\nimport './style.css';\nimport 'ui.design-tokens';\n\nexport const Chart = {\n\tcomponents: {\n\t\tTransformCanvas,\n\t\tTree,\n\t\tTransformPanel,\n\t\tChartWizard,\n\t\tFirstPopup,\n\t\tDetailPanel,\n\t\tTitlePanel,\n\t},\n\n\tdata(): ChartData\n\t{\n\t\treturn {\n\t\t\tcanvas: {\n\t\t\t\tshown: false,\n\t\t\t\tmoving: false,\n\t\t\t\tmodelTransform: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\tzoom: 0.3,\n\t\t\t\t},\n\t\t\t},\n\t\t\twizard: {\n\t\t\t\tshown: false,\n\t\t\t\tisEditMode: false,\n\t\t\t\tshowEntitySelector: true,\n\t\t\t\tentity: '',\n\t\t\t\tnodeId: 0,\n\t\t\t\tsource: '',\n\t\t\t},\n\t\t\tdetailPanel: {\n\t\t\t\tcollapsed: true,\n\t\t\t\tpreventSwitch: false,\n\t\t\t},\n\t\t};\n\t},\n\n\tasync created(): Promise<void>\n\t{\n\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\tslider?.showLoader();\n\t\tconst [departments, currentDepartments, userId] = await Promise.all([\n\t\t\tchartAPI.getDepartmentsData(),\n\t\t\tchartAPI.getCurrentDepartments(),\n\t\t\tchartAPI.getUserId(),\n\t\t]);\n\t\tslider?.closeLoader();\n\t\tconst parsedDepartments = chartAPI.createTreeDataStore(departments);\n\t\tOrgChartActions.applyData(parsedDepartments, currentDepartments, userId);\n\t\tthis.rootOffset = 100;\n\t\tthis.transformCanvas();\n\t\tthis.canvas.shown = true;\n\t\tthis.showConfetti = false;\n\t\tEventEmitter.subscribe(events.HR_DEPARTMENT_SLIDER_ON_MESSAGE, this.handleInviteSliderMessage);\n\t},\n\n\tunmounted(): void\n\t{\n\t\tEventEmitter.unsubscribe(events.HR_DEPARTMENT_SLIDER_ON_MESSAGE, this.handleInviteSliderMessage);\n\t},\n\n\tcomputed:\n\t{\n\t\trootId(): number\n\t\t{\n\t\t\tconst { id: rootId } = [...this.departments.values()].find((department) => {\n\t\t\t\treturn department.parentId === 0;\n\t\t\t});\n\n\t\t\treturn rootId;\n\t\t},\n\t\t...mapState(useChartStore, ['departments', 'currentDepartments']),\n\t},\n\n\tmethods:\n\t{\n\t\tonMoveTo({ x, y, nodeId }: { x: Number; y: Number; nodeId: Number; }): void\n\t\t{\n\t\t\tconst { x: prevX, y: prevY, zoom } = this.canvas.modelTransform;\n\t\t\tconst detailPanelWidth = 364 * zoom;\n\t\t\tconst newX = x - detailPanelWidth / 2;\n\t\t\tconst newY = nodeId === this.rootId ? this.rootOffset : y / zoom;\n\t\t\tconst notSamePoint = Math.round(newX) !== Math.round(prevX) || Math.round(y) !== Math.round(prevY);\n\t\t\tconst shouldMove = notSamePoint && !this.canvas.moving;\n\t\t\tthis.detailPanel = {\n\t\t\t\t...this.detailPanel,\n\t\t\t\tcollapsed: false,\n\t\t\t};\n\t\t\tif (!shouldMove)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.canvas = {\n\t\t\t\t...this.canvas,\n\t\t\t\tmoving: true,\n\t\t\t\tmodelTransform: { ...this.canvas.modelTransform, x: newX / zoom, y: newY, zoom: 1 },\n\t\t\t};\n\t\t},\n\t\tonLocate(nodeId: ?number): void\n\t\t{\n\t\t\tif (nodeId)\n\t\t\t{\n\t\t\t\tthis.$refs.tree.locateToDepartment(nodeId);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$refs.tree.locateToCurrentDepartment();\n\t\t},\n\t\tonShowWizard({\n\t\t\tnodeId = 0,\n\t\t\tisEditMode = false,\n\t\t\ttype,\n\t\t\tshowEntitySelector = true,\n\t\t\tsource = '',\n\t\t}: { nodeId: number; isEditMode: boolean, showEntitySelector: boolean, source: string } = {}): void\n\t\t{\n\t\t\tthis.wizard = {\n\t\t\t\t...this.wizard,\n\t\t\t\tshown: true,\n\t\t\t\tisEditMode,\n\t\t\t\tshowEntitySelector,\n\t\t\t\tentity: type,\n\t\t\t\tnodeId,\n\t\t\t\tsource,\n\t\t\t};\n\n\t\t\tif (!isEditMode && source !== AnalyticsSourceType.HEADER)\n\t\t\t{\n\t\t\t\tanalyticsSendData({\n\t\t\t\t\ttool: 'structure',\n\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\tevent: 'create_dept_step1',\n\t\t\t\t\tc_element: source,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// eslint-disable-next-line default-case\n\t\t\tswitch (type)\n\t\t\t{\n\t\t\t\tcase 'department':\n\t\t\t\t\tanalyticsSendData({\n\t\t\t\t\t\ttool: 'structure',\n\t\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\t\tevent: 'create_dept_step1',\n\t\t\t\t\t\tc_element: source,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'employees':\n\t\t\t\t\tanalyticsSendData({\n\t\t\t\t\t\ttool: 'structure',\n\t\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\t\tevent: 'create_dept_step2',\n\t\t\t\t\t\tc_element: source,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'bindChat':\n\t\t\t\t\tanalyticsSendData({\n\t\t\t\t\t\ttool: 'structure',\n\t\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\t\tevent: 'create_dept_step3',\n\t\t\t\t\t\tc_element: source,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\tasync onModifyTree({ id, parentId, showConfetti }): Promise<void>\n\t\t{\n\t\t\tthis.showConfetti = showConfetti ?? false;\n\t\t\tconst { tree } = this.$refs;\n\t\t\ttree.expandDepartmentParents(id);\n\t\t\ttree.focus(id, { expandAfterFocus: true });\n\t\t\tawait this.$nextTick();\n\t\t\ttree.moveTo(id);\n\t\t},\n\t\tonWizardClose(): void\n\t\t{\n\t\t\tthis.wizard.shown = false;\n\t\t},\n\t\tonRemoveDepartment(nodeId: number): void\n\t\t{\n\t\t\tconst { tree } = this.$refs;\n\t\t\ttree.tryRemoveDepartment(nodeId);\n\t\t},\n\t\tonTransitionEnd(): void\n\t\t{\n\t\t\tthis.canvas.moving = false;\n\t\t\tif (this.showConfetti)\n\t\t\t{\n\t\t\t\tConfetti.fire({\n\t\t\t\t\tparticleCount: 300,\n\t\t\t\t\tstartVelocity: 10,\n\t\t\t\t\tspread: 400,\n\t\t\t\t\tticks: 100,\n\t\t\t\t\torigin: { y: 0.4, x: 0.37 },\n\t\t\t\t});\n\t\t\t\tthis.showConfetti = false;\n\t\t\t}\n\t\t},\n\t\tonControlDetail({ showEmployees, preventSwitch }): void\n\t\t{\n\t\t\tthis.detailPanel = {\n\t\t\t\t...this.detailPanel,\n\t\t\t\tpreventSwitch,\n\t\t\t};\n\t\t\tif (!showEmployees)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.detailPanel = {\n\t\t\t\t...this.detailPanel,\n\t\t\t\tcollapsed: false,\n\t\t\t};\n\t\t},\n\t\ttransformCanvas(): void\n\t\t{\n\t\t\tconst { zoom } = this.canvas.modelTransform;\n\t\t\tconst { offsetWidth, offsetHeight } = this.$el;\n\t\t\tconst [currentDepartment] = this.currentDepartments;\n\t\t\tconst y = currentDepartment === this.rootId ? this.rootOffset : offsetHeight / 2 - (offsetHeight * zoom) / 2;\n\t\t\tthis.canvas.modelTransform = {\n\t\t\t\t...this.canvas.modelTransform,\n\t\t\t\tx: offsetWidth / 2 - (offsetWidth * zoom) / 2,\n\t\t\t\ty,\n\t\t\t};\n\t\t},\n\t\tonUpdateTransform(): void\n\t\t{\n\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_MENU_CLOSE);\n\t\t},\n\t\thandleInviteSliderMessage(event: BaseEvent): void\n\t\t{\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tconst eventId = messageEvent.getEventId();\n\t\t\tif (eventId !== 'BX.Intranet.Invitation:onAdd')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { users } = messageEvent.getData();\n\t\t\tusers.forEach((user) => {\n\t\t\t\tconst invitedUserData = getInvitedUserData(user);\n\t\t\t\tOrgChartActions.inviteUser(invitedUserData);\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-chart\">\n\t\t\t<TitlePanel @showWizard=\"onShowWizard\" @locate=\"onLocate\"></TitlePanel>\n\t\t\t<TransformCanvas\n\t\t\t\tv-if=\"canvas.shown\"\n\t\t\t\tv-slot=\"{transform}\"\n\t\t\t\tv-model=\"canvas.modelTransform\"\n\t\t\t\t@update:modelValue=\"onUpdateTransform\"\n\t\t\t\t:class=\"{ '--moving': canvas.moving }\"\n\t\t\t\t@transitionend=\"onTransitionEnd\"\n\t\t\t>\n\t\t\t\t<Tree\n\t\t\t\t\t:zoom=\"transform.zoom\"\n\t\t\t\t\tref=\"tree\"\n\t\t\t\t\t@moveTo=\"onMoveTo\"\n\t\t\t\t\t@showWizard=\"onShowWizard\"\n\t\t\t\t\t@controlDetail=\"onControlDetail\"\n\t\t\t\t/>\n\t\t\t</TransformCanvas>\n\t\t\t<DetailPanel\n\t\t\t\t@showWizard=\"onShowWizard\"\n\t\t\t\t@removeDepartment=\"onRemoveDepartment\"\n\t\t\t\tv-model=\"detailPanel.collapsed\"\n\t\t\t\t:preventPanelSwitch=\"detailPanel.preventSwitch\"\n\t\t\t></DetailPanel>\n\t\t\t<TransformPanel\n\t\t\t\tv-model=\"canvas.modelTransform\"\n\t\t\t\t@locate=\"onLocate\"\n\t\t\t></TransformPanel>\n\t\t\t<ChartWizard\n\t\t\t\tv-if=\"wizard.shown\"\n\t\t\t\t:nodeId=\"wizard.nodeId\"\n\t\t\t\t:isEditMode=\"wizard.isEditMode\"\n\t\t\t\t:showEntitySelector=\"wizard.showEntitySelector\"\n\t\t\t\t:entity=\"wizard.entity\"\n\t\t\t\t:source=\"wizard.source\"\n\t\t\t\t@modifyTree=\"onModifyTree\"\n\t\t\t\t@close=\"onWizardClose\"\n\t\t\t></ChartWizard>\n\t\t\t<FirstPopup/>\n\t\t\t<div class=\"humanresources-chart__back\"></div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { events } from './events';\nimport { BitrixVue } from 'ui.vue3';\nimport { createPinia } from 'ui.vue3.pinia';\nimport { Dom } from 'main.core';\nimport { Chart } from './app';\nimport { PermissionChecker } from 'humanresources.company-structure.permission-checker';\n\nexport class App\n{\n\tstatic #subscribeOnEvents(app: Object): void\n\t{\n\t\tconst onCloseByEsc = (event: BaseEvent) => {\n\t\t\tconst [sidePanelEvent] = event.data;\n\t\t\tsidePanelEvent.denyAction();\n\t\t};\n\n\t\tconst onClose = () => {\n\t\t\tEventEmitter.unsubscribe(events.HR_ORG_CHART_CLOSE_BY_ESC, onCloseByEsc);\n\t\t\tEventEmitter.unsubscribe(events.HR_ORG_CHART_CLOSE, onClose);\n\t\t\tapp.unmount();\n\t\t};\n\t\tEventEmitter.subscribe(events.HR_ORG_CHART_CLOSE_BY_ESC, onCloseByEsc);\n\t\tEventEmitter.subscribe(events.HR_ORG_CHART_CLOSE, onClose);\n\t}\n\n\tstatic async mount(containerId: string): Promise<void>\n\t{\n\t\tconst container = document.getElementById(containerId);\n\t\tconst app = BitrixVue.createApp(Chart);\n\t\tconst store = createPinia();\n\t\tapp.use(store);\n\t\tApp.#subscribeOnEvents(app);\n\n\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\tslider.showLoader();\n\t\t}\n\t\tDom.addClass(container, 'humanresources-chart__back');\n\n\t\tawait PermissionChecker.init();\n\t\tif (slider)\n\t\t{\n\t\t\tslider.closeLoader();\n\t\t}\n\t\tDom.removeClass(container, 'humanresources-chart__back');\n\t\tapp.mount(container);\n\t}\n}\n"],"names":["events","Object","freeze","HR_DEPARTMENT_CONNECT","HR_DEPARTMENT_DISCONNECT","HR_DEPARTMENT_ADAPT_SIBLINGS","HR_DEPARTMENT_ADAPT_CONNECTOR_HEIGHT","HR_DEPARTMENT_FOCUS","HR_DEPARTMENT_CONTROL","HR_DEPARTMENT_MENU_CLOSE","HR_ORG_CHART_CLOSE_BY_ESC","HR_ORG_CHART_CLOSE","HR_FIRST_POPUP_SHOW","HR_DEPARTMENT_SLIDER_ON_MESSAGE","MenuOption","addDepartment","addEmployee","AddButton","name","emits","data","actionMenu","visible","components","RouteActionMenu","mounted","permissionChecker","PermissionChecker","getInstance","dropdownItems","id","title","loc","description","bIcon","Main","CUBE_PLUS","size","color","getColorCode","permission","action","PermissionActions","departmentCreate","CRM","PERSON_PLUS_2","employeeAddToDepartment","filter","item","hasPermissionOfAction","computed","methods","phraseCode","replacements","$Bitrix","Loc","getMessage","$emit","actionMenuItemClickHandler","actionId","template","OrgChartActions","applyData","departments","currentDepartments","userId","store","useChartStore","$patch","searchedUserId","focusDepartment","departmentId","focusedNode","searchUserInDepartment","moveSubordinatesToParent","removableDepartmentId","removableDepartment","get","parentId","children","removableDeparmentChildren","userCount","removableDepartmentUserCount","heads","removableDeparmentHeads","employees","removableDeparmentEmployees","forEach","childId","department","parentDepartment","parentDepartmentUsersIds","Set","map","user","removableDeparmentUsers","movableUsers","has","role","memberRoles","employee","length","includes","changeCurrentDepartment","markDepartmentAsRemoved","set","prevParentId","removeDepartment","delete","inviteUser","userData","nodeId","restData","SearchBar","BIcon","directives","focus","el","canEditPermissions","showSearchBar","created","searchDialog","getSearchDialog","mapState","showSearchbar","analyticsSendData","tool","category","event","hideSearchbar","dialog","Dialog","width","height","multiple","entities","searchFields","type","system","searchable","options","intranetUsersOnly","emailUsers","inviteEmployeeLink","selectMode","flatMode","fillRecentTab","recentTabOptions","dropdownMode","enableSearch","hideOnDeselect","context","getData","entityType","customData","recentItemsToSave","push","saveRecentItems","onLoad","target","items","getSubtitle","setSubtitle","onDestroy","onEnter","$refs","searchName","setTargetNode","isOpen","show","Event","bind","window","handleClickOutside","parentElement","contains","clearSearch","unbind","search","value","getSearchTab","clearResults","selectTab","watch","handler","destroy","deep","accessRights","BurgerMenuButton","SHIELD","BX","SidePanel","Instance","open","usePadding","TitlePanel","canAddNode","toolbarStarActive","isHovered","toolbarStarElement","document","getElementById","accessEdit","error","console","observer","MutationObserver","Dom","hasClass","observe","attributes","attributeFilter","toolbarStarIcon","FAVORITE_1","FAVORITE_0","source","AnalyticsSourceType","HEADER","onLocate","triggerFavoriteStar","click","UI","Notification","Center","notify","content","autoHideDelay","HeadList","UserListActionMenu","props","Array","required","default","String","collapsed","Boolean","isCollapsed","isUpdating","headsVisible","userTypes","head","deputy","defaultAvatar","workPosition","titleBar","handleUserClick","url","cacheable","closeHeadList","EventEmitter","unsubscribe","openHeadList","subscribe","MenuActions","editDepartment","editEmployee","moveEmployee","userInvite","DepartmentMenuButton","Number","menuItems","EDIT_PENCIL","departmentEdit","imageClass","EDIT_MENU","PERSON_ARROW_LEFT_1","PERSON_LETTER","inviteToDepartment","TRASH_BIN","departmentDelete","hasPermission","menu","onActionMenuItemClick","closeMenu","openMenu","SubdivisionAddButton","canShow","addSubdivision","TreeNode","inject","expandedNodes","zoom","currentDepartment","hint","Hint","childrenOffset","childrenMounted","showInfo","gap","prevChildrenOffset","prevHeight","$nextTick","emit","shift","$el","offsetHeight","structureView","nodeData","html","parentsPath","getParentsPath","calculateNodePoints","unmounted","remove","nodeClass","isCurrentDepartment","subdivisionsClass","hasChildren","isExpanded","deputyHead","employeeCount","childNodeStyle","left","showSubdivisionAddButton","onDepartmentClick","targetId","showEmployees","subdivisionsSelected","calculatePosition","node","offset","controlDepartment","CARD","UserManagementDialog","openDialog","departmentToInvite","accessCode","slice","allowChangeHistory","locPlural","count","getMessagePlural","top","getBoundingClientRect","parentNode","$parent","parentLeft","parentTop","parentWidth","parentHeight","x","chartX","y","chartY","getTreeBounds","startPoint","endPoint","topLevelId","createTreeDataStore","treeData","dataMap","Map","mapItem","mapParentItem","chartAPI","getDepartmentsData","getCurrentDepartments","getDictionary","getUserId","firstTimeOpened","postData","Tree","connectors","treeNodes","subscribeOnEvents","loadHeads","rootId","prevWindowWidth","innerWidth","expandDepartmentParents","expandAfterFocus","expandLowerDepartments","beforeUnmount","unsubscribeOnEvents","provide","values","find","getPath","connector","lineLength","shiftY","startY","shadowOffset","rounded","start","end","arcRadius","Math","round","adjustedEndY","join","onConnectDepartment","setTimeout","moveTo","assign","highlighted","onDisconnectDepartment","onAdaptSiblings","adaptConnectorsAfterMount","adaptConnectorsAfterUnmount","entries","key","currentStartPoint","parsedSiblingConnectors","reduce","acc","currentEndPoint","currentParentId","sign","currentId","ancestorId","ancestorSign","onAdaptConnectorHeight","collapse","expandedId","toggleConnectorsVisibility","toggleConnectorHighlighting","collapseRecursively","deepCollapse","expandedNode","expand","childrenWithoutHeads","shouldExpand","onFocusDepartment","preventSwitch","onControlDepartment","isEditMode","showEntitySelector","tryRemoveDepartment","messageBox","MessageBox","create","message","buttons","MessageBoxButtons","OK_CANCEL","onOk","close","onCancel","minWidth","maxWidth","minHeight","okCaption","popupOptions","className","overlay","opacity","okButton","getOkButton","cancelButton","getCancelButton","setRound","setColor","ButtonColor","DANGER","LIGHT_BORDER","expanded","highlightedConnector","expandLevel","expandRecursively","middleBound","trunc","i","traverseSibling","siblingId","currentChildren","locateToCurrentDepartment","locateToDepartment","treeRect","centerX","centerY","treeNode","treeNodeRect","departmentIds","handle","onResizeWindow","keys","startPointX","endPointX","TransformPanel","modelValue","selectedId","actions","zoomIn","zoomOut","locate","navigate","zoomInPercent","percent","toFixed","onZoom","leftBound","rightBound","direction","onfocusout","DetailPanelCollapsedTitle","avatars","maxVisibleAvatarsCount","additionalCount","DetailPanelEditButton","menuVisible","bindElement","detailPanelEditButton","DetailPanel","DepartmentContent","preventPanelSwitch","isLoading","needToShowLoader","headAvatarsArray","avatar","toggleCollapse","updateDetailPageHandler","oldId","DETAIL","showLoader","hideLoader","newId","newDepartments","FirstPopup","subDescription","features","closePopup","Chart","TransformCanvas","ChartWizard","canvas","shown","moving","modelTransform","wizard","entity","detailPanel","slider","getTopSlider","Promise","all","closeLoader","parsedDepartments","rootOffset","transformCanvas","showConfetti","handleInviteSliderMessage","onMoveTo","prevX","prevY","detailPanelWidth","newX","newY","notSamePoint","shouldMove","tree","onShowWizard","c_element","onModifyTree","onWizardClose","onRemoveDepartment","onTransitionEnd","Confetti","fire","particleCount","startVelocity","spread","ticks","origin","onControlDetail","offsetWidth","onUpdateTransform","messageEvent","eventId","getEventId","users","invitedUserData","getInvitedUserData","App","mount","containerId","container","app","BitrixVue","createApp","createPinia","use","addClass","init","removeClass","onCloseByEsc","sidePanelEvent","denyAction","onClose","unmount"],"mappings":"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"}