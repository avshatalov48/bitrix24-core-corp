{"version":3,"file":"org-chart.bundle.js","sources":["../src/events.js","../src/components/title-panel/add-button/add-button.js","../src/components/title-panel/search/search-bar.js","../src/components/title-panel/burger-menu-button/burger-menu-button.js","../src/components/title-panel/title-panel.js","../src/components/tree/tree-node/head-list/head-list.js","../src/components/tree/tree-node/department-menu-button/department-menu-button.js","../src/components/tree/tree-node/subdivision-add-button/subdivision-add-button.js","../src/components/tree/tree-node/tree-node.js","../src/api.js","../src/components/tree/tree.js","../src/components/transfrom-panel.js","../src/components/detail-panel/detail-panel-collapsed-title.js","../src/components/detail-panel/detail-panel-edit-button.js","../src/components/detail-panel/detail-panel.js","../src/components/first-popup/first-popup.js","../src/app.js","../src/main.js"],"sourcesContent":["export const events = Object.freeze({\n\tHR_DEPARTMENT_CONNECT: 'hr-department-connect',\n\tHR_DEPARTMENT_DISCONNECT: 'hr-department-disconnect',\n\tHR_DEPARTMENT_ADAPT_SIBLINGS: 'hr-department-adapt-siblings',\n\tHR_DEPARTMENT_FOCUS: 'hr-department-focus',\n\tHR_DEPARTMENT_CONTROL: 'hr-department-control',\n\tHR_DEPARTMENT_UPDATE: 'hr-department-update',\n\tHR_DEPARTMENT_MENU_CLOSE: 'hr-department-menu-close',\n\tHR_ORG_CHART_CLOSE_BY_ESC: 'SidePanel.Slider:onCloseByEsc',\n\tHR_ORG_CHART_CLOSE: 'SidePanel.Slider:onClose',\n});\n","import { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { Main, CRM } from 'ui.icon-set.api.core';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport 'ui.icon-set.main';\nimport 'ui.icon-set.crm';\n\nconst MenuOption = Object.freeze({\n\taddDepartment: 'add-department',\n\taddEmployee: 'add-employee',\n});\n\nexport const AddButton = {\n\tname: 'AddButton',\n\n\temits: ['addDepartment'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tactionMenu: {\n\t\t\t\tvisible: false,\n\t\t\t},\n\t\t};\n\t},\n\tcomponents: {\n\t\tRouteActionMenu,\n\t},\n\n\tmounted(): void\n\t{\n\t\tconst permissionChecker = PermissionChecker.getInstance();\n\n\t\tif (!permissionChecker)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.dropdownItems = [\n\t\t\t{\n\t\t\t\tid: MenuOption.addDepartment,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_DEPARTMENT_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_DEPARTMENT_DESCR'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.CUBE_PLUS,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: {\n\t\t\t\t\taction: PermissionActions.departmentCreate,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuOption.addEmployee,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_EMPLOYEE_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_EMPLOYEE_DESCR'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: CRM.PERSON_PLUS_2,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: {\n\t\t\t\t\taction: PermissionActions.employeeAddToDepartment,\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tthis.dropdownItems = this.dropdownItems.filter((item) => {\n\t\t\tif (!item.permission)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn permissionChecker.hasPermissionOfAction(item.permission.action);\n\t\t});\n\t},\n\n\tcomputed: {\n\t\tMenuOption(): typeof MenuOption\n\t\t{\n\t\t\treturn MenuOption;\n\t\t},\n\t},\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\taddDepartment(): void\n\t\t{\n\t\t\tthis.$emit('addDepartment');\n\t\t},\n\t\tactionMenuItemClickHandler(actionId: string): void\n\t\t{\n\t\t\tif (actionId === MenuOption.addDepartment)\n\t\t\t{\n\t\t\t\tthis.$emit('addDepartment');\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-btn ui-btn-success ui-btn-round ui-btn-sm\" @click=\"addDepartment\">\n\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON') }}\n\t\t</div>\n\t`,\n};\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { Event } from 'main.core';\nimport { Dialog } from 'ui.entity-selector';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { mapWritableState } from 'ui.vue3.pinia';\nimport { sendData as analyticsSendData } from 'ui.analytics';\n\nimport './style.css';\n\nexport const SearchBar = {\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tdirectives: {\n\t\tfocus: {\n\t\t\tmounted(el)\n\t\t\t{\n\t\t\t\tel.focus();\n\t\t\t},\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcanEditPermissions: false,\n\t\t\tshowSearchBar: false,\n\t\t};\n\t},\n\n\tcreated()\n\t{\n\t\tthis.searchDialog = this.getSearchDialog();\n\t},\n\n\tname: 'search-bar',\n\n\temits: [\n\t\t'locate',\n\t],\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\t...mapWritableState(useChartStore, ['searchedUserId', 'departments']),\n\t},\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tshowSearchbar(): void\n\t\t{\n\t\t\tif (this.showSearchBar)\n\t\t\t{\n\t\t\t\tthis.showSearchBar = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tanalyticsSendData({ tool: 'structure', category: 'structure', event: 'search' });\n\n\t\t\tthis.showSearchBar = true;\n\t\t},\n\t\thideSearchbar(): void\n\t\t{\n\t\t\tthis.showSearchBar = false;\n\t\t},\n\t\tgetSearchDialog(): Dialog\n\t\t{\n\t\t\tconst dialog = new Dialog({\n\t\t\t\twidth: 425,\n\t\t\t\theight: 320,\n\t\t\t\tmultiple: false,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\tsearchFields: [\n\t\t\t\t\t\t\t{ name: 'supertitle', type: 'string', system: true, searchable: true },\n\t\t\t\t\t\t\t{ name: 'position', type: 'string' },\n\t\t\t\t\t\t],\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'structure-node',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'onlyDepartments',\n\t\t\t\t\t\t\tflatMode: true,\n\t\t\t\t\t\t\tfillRecentTab: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\trecentTabOptions: {\n\t\t\t\t\tid: 'recents',\n\t\t\t\t\tvisible: true,\n\t\t\t\t},\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: false,\n\t\t\t\thideOnDeselect: false,\n\t\t\t\tcontext: 'HR_STRUCTURE',\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst item = event.getData().item;\n\n\t\t\t\t\t\tif (item.entityType === 'employee')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$emit('locate', item.customData.get('nodeId'));\n\t\t\t\t\t\t\tthis.searchedUserId = item.id;\n\t\t\t\t\t\t\tdialog.recentItemsToSave.push(item);\n\t\t\t\t\t\t\tdialog.saveRecentItems();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdialog.recentItemsToSave.push(item);\n\t\t\t\t\t\tdialog.saveRecentItems();\n\n\t\t\t\t\t\tthis.$emit('locate', item.id);\n\t\t\t\t\t},\n\t\t\t\t\tonLoad: (event) => {\n\t\t\t\t\t\tevent.target.items.get('user').forEach((item) => {\n\t\t\t\t\t\t\tif (!item.getSubtitle())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.setSubtitle(item.customData.get('position'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\t'SearchTab:onLoad': (event) => {\n\t\t\t\t\t\tevent.target.items.get('user').forEach((item) => {\n\t\t\t\t\t\t\tif (!item.getSubtitle())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.setSubtitle(item.customData.get('position'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tonDestroy: () => {\n\t\t\t\t\t\tthis.searchDialog = this.getSearchDialog();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\treturn dialog;\n\t\t},\n\n\t\tonEnter(): void\n\t\t{\n\t\t\tif (this.$refs.searchName)\n\t\t\t{\n\t\t\t\tthis.searchDialog.setTargetNode(this.$refs.searchName);\n\t\t\t\tif (!this.searchDialog.isOpen())\n\t\t\t\t{\n\t\t\t\t\tthis.searchDialog.show();\n\t\t\t\t}\n\t\t\t\tEvent.bind(window, 'mousedown', this.handleClickOutside);\n\t\t\t}\n\t\t},\n\t\thandleClickOutside(event): void\n\t\t{\n\t\t\tif (this.$refs.searchName\n\t\t\t\t&& !this.$refs.searchName.parentElement.contains(event.target) && !this.searchDialog.isOpen())\n\t\t\t{\n\t\t\t\tthis.clearSearch();\n\t\t\t\tthis.hideSearchbar();\n\t\t\t\tEvent.unbind(window, 'mousedown', this.handleClickOutside);\n\t\t\t}\n\t\t},\n\t\tsearch(value: string): void\n\t\t{\n\t\t\tif (!this.searchDialog.isOpen())\n\t\t\t{\n\t\t\t\tthis.searchDialog.show();\n\t\t\t}\n\n\t\t\tthis.searchDialog.search(value);\n\t\t},\n\t\tclearSearch()\n\t\t{\n\t\t\tthis.searchDialog.getSearchTab().clearResults();\n\t\t\tthis.searchDialog.selectTab('recents');\n\n\t\t\tif (this.$refs.searchName)\n\t\t\t{\n\t\t\t\tthis.$refs.searchName.value = '';\n\t\t\t\tthis.$refs.searchName.focus();\n\t\t\t}\n\t\t},\n\t},\n\n\twatch: {\n\t\tdepartments: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.searchDialog.destroy();\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t    class=\"humanresources-title-panel-search-bar-container\"\n\t\t    :class=\"{'--opened': showSearchBar}\"\n\t\t>\n\t\t  <div\n\t\t      class=\"humanresources-title-panel-search-bar-block__search\"\n\t\t      @click=\"showSearchbar\"\n\t\t  >\n\t\t    <BIcon :name=\"set.SEARCH_2\" :size=\"24\" class=\"hr-title-search-icon\"></BIcon>\n\t\t  </div>\n\t\t  <transition name=\"humanresources-title-panel-search-bar-fade\" mode=\"in-out\" @after-enter=\"onEnter\">\n\t\t    <div v-if=\"showSearchBar\"\n\t\t         class=\"humanresources-title-panel-search-bar-block__search-bar\"\n\t\t    >\n\t\t      <input\n\t\t          ref=\"searchName\"\n\t\t          key=\"searchInput\"\n\t\t          type=\"text\"\n\t\t          :placeholder=\"loc('HUMANRESOURCES_SEARCH_PLACEHOLDER')\"\n\t\t          v-focus\n\t\t          class=\"humanresources-title-panel-search-bar-block__search-input\"\n\t\t          @click=\"onEnter\"\n\t\t          @input=\"search($event.target.value)\"\n\t\t      >\n\t\t      <div\n\t\t          key=\"searchReset\"\n\t\t          @click=\"clearSearch\"\n\t\t          class=\"humanresources-title-panel-search-bar-block__search-reset\"\n\t\t      >\n\t\t        <div class=\"humanresources-title-panel-search-bar-block__search-cursor\"></div>\n\t\t        <BIcon\n\t\t            :name=\"set.CROSS_CIRCLE_50\"\n\t\t            :size=\"24\"\n\t\t            color=\"#2FC6F6\"\n\t\t        ></BIcon>\n\t\t      </div>\n\t\t    </div>\n\t\t  </transition>\n\t\t</div>\n\t`,\n};\n","import { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { Main } from 'ui.icon-set.api.core';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { sendData as analyticsSendData } from 'ui.analytics';\n\nimport 'ui.icon-set.main';\n\nconst MenuOption = Object.freeze({\n\taccessRights: 'access-rights',\n});\n\nexport const BurgerMenuButton = {\n\tname: 'BurgerMenuButton',\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tactionMenu: {\n\t\t\t\tvisible: false,\n\t\t\t},\n\t\t};\n\t},\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.dropdownItems = [\n\t\t\t{\n\t\t\t\tid: MenuOption.accessRights,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIG_PERMISSION_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIG_PERMISSION_DESCR'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.SHIELD,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\n\t\tactionMenuItemClickHandler(actionId: string): void\n\t\t{\n\t\t\tif (actionId === MenuOption.accessRights)\n\t\t\t{\n\t\t\t\tanalyticsSendData({ tool: 'structure', category: 'structure', event: 'open_roles' });\n\n\t\t\t\tBX.SidePanel.Instance.open('/hr/config/permission/', { usePadding: true });\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<span\n\t\t\tref=\"burgerMenuButton\"\n\t\t\t@click=\"actionMenu.visible = true\"\n\t\t>\n\t\t\t<svg\n\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\tfill=\"none\"\n\t\t\t\tclass=\"humanresources-title-panel__icon\"\n\t\t\t\t:class=\"{'--selected': actionMenu.visible }\"\n\t\t\t\t>\n\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M18.7067 15.5577C18.8172 15.5577 18.9067 15.6473 18.9067 15.7577L18.9067 17.2424C18.9067 17.3528 18.8172 17.4424 18.7067 17.4424H5.29375C5.1833 17.4424 5.09375 17.3528 5.09375 17.2424L5.09379 15.7577C5.09379 15.6473 5.18333 15.5577 5.29379 15.5577H18.7067ZM18.7067 11.5577C18.8172 11.5577 18.9067 11.6473 18.9067 11.7577L18.9067 13.2424C18.9067 13.3528 18.8172 13.4424 18.7067 13.4424H5.29375C5.1833 13.4424 5.09375 13.3528 5.09375 13.2424L5.09379 11.7577C5.09379 11.6473 5.18333 11.5577 5.29379 11.5577H18.7067ZM18.7067 7.55774C18.8172 7.55774 18.9067 7.64729 18.9067 7.75774L18.9067 9.24238C18.9067 9.35284 18.8172 9.44238 18.7067 9.44238H5.29375C5.1833 9.44238 5.09375 9.35283 5.09375 9.24237L5.09379 7.75773C5.09379 7.64728 5.18333 7.55774 5.29379 7.55774H18.7067Z\" fill=\"#525C69\"/>\n\t\t\t</svg>\n\t\t </span>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"actionMenu.visible\"\n\t\t\tid=\"title-panel-burger-menu\"\n\t\t\t:items=\"dropdownItems\"\n\t\t\t:bindElement=\"this.$refs.burgerMenuButton\"\n\t\t\t@action=\"actionMenuItemClickHandler($event)\"\n\t\t\t@close=\"this.actionMenu.visible = false\"\n\t\t/>\n\t`,\n\n};\n","import { AddButton } from './add-button/add-button.js';\nimport { SearchBar } from './search/search-bar.js';\nimport { BurgerMenuButton } from './burger-menu-button/burger-menu-button.js';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { UI } from 'ui.notification';\nimport { Dom } from 'main.core';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\n\nimport './style.css';\n\nexport const TitlePanel = {\n\tcomponents: {\n\t\tAddButton,\n\t\tBurgerMenuButton,\n\t\tSearchBar,\n\t\tBIcon,\n\t\tSet,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcanEditPermissions: false,\n\t\t\tcanAddNode: false,\n\t\t\ttoolbarStarActive: false,\n\t\t\tisHovered: false,\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.toolbarStarElement = document.getElementById('uiToolbarStar');\n\t},\n\n\tmounted()\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst permissionChecker = PermissionChecker.getInstance();\n\t\t\tthis.canEditPermissions = permissionChecker\n\t\t\t\t&& permissionChecker.hasPermissionOfAction(PermissionActions.accessEdit);\n\t\t\tthis.canAddNode = permissionChecker\n\t\t\t\t&& permissionChecker.hasPermissionOfAction(PermissionActions.departmentCreate);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('Failed to fetch data:', error);\n\t\t}\n\n\t\tconst observer = new MutationObserver(() => {\n\t\t\tthis.toolbarStarActive = Dom.hasClass(this.toolbarStarElement, 'ui-toolbar-star-active');\n\t\t});\n\n\t\tobserver.observe(this.toolbarStarElement, { attributes: true, attributeFilter: ['class'] });\n\n\t\tthis.toolbarStarActive = Dom.hasClass(this.toolbarStarElement, 'ui-toolbar-star-active');\n\t},\n\n\tname: 'title-panel',\n\n\temits: ['showWizard', 'locate'],\n\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\ttoolbarStarIcon(): string\n\t\t{\n\t\t\treturn this.toolbarStarActive ? this.set.FAVORITE_1 : this.set.FAVORITE_0;\n\t\t},\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\taddDepartment(): void\n\t\t{\n\t\t\tthis.$emit('showWizard', { source: AnalyticsSourceType.HEADER });\n\t\t},\n\t\tonLocate(nodeId: number)\n\t\t{\n\t\t\tthis.$emit('locate', nodeId);\n\t\t},\n\t\ttriggerFavoriteStar()\n\t\t{\n\t\t\tthis.toolbarStarElement.click();\n\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: this.toolbarStarActive\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_LEFT_MENU_UN_SAVED')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_LEFT_MENU_SAVED'),\n\t\t\t\tautoHideDelay: 2000,\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-title-panel\">\n\t\t  <p class=\"humanresources-title-panel__title\">\n\t\t    {{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_TITLE') }}\n\t\t  </p>\n\t\t  <BIcon :name=\"isHovered ? set.FAVORITE_1 : toolbarStarIcon\" :size=\"24\" class=\"humanresources-title-panel__star\"\n\t\t               @mouseover=\"isHovered = true\"\n\t\t               @mouseleave=\"isHovered = false\" @click=\"triggerFavoriteStar\"\n\t\t  ></BIcon>\n\t\t  <div class=\"humanresources-title-panel__separator\"></div>\n\t\t  <AddButton\n\t\t\t  v-if=\"canAddNode\"\n\t\t      @addDepartment=\"addDepartment\"\n\t\t  />\n\t\t  <div class=\"humanresources-title-panel__separator\" v-if=\"canAddNode\"></div>\n\t\t  <BurgerMenuButton v-if=\"canEditPermissions\"/>\n\t\t  <div class=\"humanresources-title-panel__separator\" v-if=\"canEditPermissions\"></div>\n\t\t  <SearchBar @locate=\"onLocate\"/>\n\t\t</div>\n\t`,\n};\n","import { SidePanel } from 'main.sidepanel';\nimport './style.css';\n\nexport const HeadList = {\n\tname: 'headList',\n\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => [],\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tcollapsed: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisCollapsed: false,\n\t\t\tisUpdating: true,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tdefaultAvatar(): String\n\t\t{\n\t\t\treturn '/bitrix/js/humanresources/company-structure/org-chart/src/images/default-user.svg';\n\t\t},\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\thandleUserClick(url: string): void\n\t\t{\n\t\t\tSidePanel.Instance.open(url, {\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div v-if=\"items.length\" class=\"humanresources-tree__node_employees-container\">\n\t\t\t<p v-if=\"title\" class=\"humanresources-tree__node_employees-title\">\n\t\t\t\t{{ title }}\n\t\t\t</p>\n\t\t\t<div\n\t\t\t\tclass=\"humanresources-tree__node_head\"\n\t\t\t\t:class=\"{ '--collapsed': collapsed }\"\n\t\t\t\tv-for=\"(item, index) in items.slice(0, 2)\"\n\t\t\t>\n\t\t\t\t<img\n\t\t\t\t\t:src=\"item.avatar ? encodeURI(item.avatar) : defaultAvatar\"\n\t\t\t\t\tclass=\"humanresources-tree__node_avatar --head\"\n\t\t\t\t\t:class=\"{ '--collapsed': collapsed }\"\n\t\t\t\t\t@click.stop=\"handleUserClick(item.url)\"\n\t\t\t\t/>\n\t\t\t\t<div class=\"humanresources-tree__node_head-text\">\n\t\t\t\t\t<span\n\t\t\t\t\t\t:bx-tooltip-user-id=\"item.id\"\n\t\t\t\t\t\tclass=\"humanresources-tree__node_head-name\"\n\t\t\t\t\t\t@click.stop=\"handleUserClick(item.url)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ item.name }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span v-if=\"!collapsed\" class=\"humanresources-tree__node_head-position\">\n\t\t\t\t\t\t{{ item.workPosition || loc('HUMANRESOURCES_COMPANY_STRUCTURE_HEAD_POSITION') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<span\n\t\t\t\t\tv-if=\"index === 1 && items.length > 2\"\n\t\t\t\t\tclass=\"humanresources-tree__node_head-rest\"\n\t\t\t\t>\n\t\t\t\t\t{{ '+' + String(items.length - 2) }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { Main, CRM } from 'ui.icon-set.api.core';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport 'ui.icon-set.main';\nimport './style.css';\nimport { events } from '../../../../events';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\n\nexport const MenuActions = Object.freeze({\n\teditDepartment: 'editDepartment',\n\taddDepartment: 'addDepartment',\n\teditEmployee: 'editEmployee',\n\tmoveEmployee: 'moveEmployee',\n\taddEmployee: 'addEmployee',\n\tuserInvite: 'userInvite',\n\tremoveDepartment: 'removeDepartment',\n});\n\nexport const DepartmentMenuButton = {\n\tname: 'DepartmentMenuButton',\n\temits: ['addDepartment', 'editDepartment', 'moveEmployee', 'addEmployee', 'removeDepartment', 'editEmployee', 'userInvite'],\n\n\tprops: {\n\t\tdepartmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.menuItems = [];\n\t\tthis.permissionChecker = PermissionChecker.getInstance();\n\n\t\tif (!this.permissionChecker)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.menuItems = [\n\t\t\t{\n\t\t\t\tid: MenuActions.editDepartment,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_DEPARTMENT_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_DEPARTMENT_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.EDIT_PENCIL,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.departmentEdit },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.addDepartment,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.CUBE_PLUS,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.departmentCreate },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.editEmployee,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_EMPLOYEE_LIST_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_EMPLOYEE_LIST_SUBTITLE'),\n\t\t\t\timageClass: '-hr-department-org-chart-menu-edit-list',\n\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.moveEmployee,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_MOVE_EMPLOYEE_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_MOVE_EMPLOYEE_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.PERSON_ARROW_LEFT_1,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.userInvite,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_USER_INVITE_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_USER_INVITE_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.PERSON_LETTER,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.inviteToDepartment },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.addEmployee,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_EMPLOYEE_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_EMPLOYEE_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: CRM.PERSON_PLUS_2,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuActions.removeDepartment,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_DEPARTMENT_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_DEPARTMENT_SUBTITLE'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.TRASH_BIN,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteRed40'),\n\t\t\t\t},\n\t\t\t\tpermission: { action: PermissionActions.departmentDelete },\n\t\t\t},\n\t\t];\n\n\t\tthis.menuItems = this.menuItems.filter((item) => {\n\t\t\tif (!item.permission)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.permissionChecker.hasPermission(item.permission.action, this.departmentId);\n\t\t});\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenu: {\n\t\t\t\tvisible: false,\n\t\t\t},\n\t\t};\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.$emit(actionId, actionId);\n\t\t},\n\t\tcloseMenu(): void\n\t\t{\n\t\t\tthis.menu.visible = false;\n\t\t\tEventEmitter.unsubscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.closeMenu);\n\t\t},\n\t\topenMenu(): void\n\t\t{\n\t\t\tthis.menu.visible = true;\n\t\t\tEventEmitter.subscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.closeMenu);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"menuItems.length\"\n\t\t\tclass=\"ui-icon-set --more humanresources-tree__node_department-menu-button\"\n\t\t\t:class=\"{ '--focused': this.menu.visible }\"\n\t\t\tref=\"departmentMenuButton\"\n\t\t\t@click.stop=\"openMenu\"\n\t\t>\n\t\t</div>\n\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menu.visible\"\n\t\t\t:id=\"'tree-node-department-menu-' + departmentId\"\n\t\t\t:width=\"302\"\n\t\t\t:items=\"menuItems\"\n\t\t\t:bindElement=\"this.$refs.departmentMenuButton\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"closeMenu\"\n\t\t/>\n\t`,\n};\n","import { BIcon, Set } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\n\nexport const SubdivisionAddButton = {\n\tname: 'SubdivisionAddButton',\n\temits: ['addDepartment'],\n\n\tprops: {\n\t\tdepartmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomponents: {\n\t\tBIcon,\n\t},\n\n\tcreated(): void\n\t{\n\t\tconst permissionChecker = PermissionChecker.getInstance();\n\n\t\tthis.canShow = permissionChecker\n\t\t\t&& permissionChecker.hasPermission(PermissionActions.departmentCreate, this.departmentId);\n\t},\n\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\taddSubdivision(event): void\n\t\t{\n\t\t\tthis.$emit('addDepartment');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-tree__node_add-subdivision\" v-if=\"canShow\">\n\t\t  <button class=\"humanresources-tree__add-button\" @click=\"addSubdivision\">\n\t\t    <BIcon :name=\"set.PLUS_20\" :size=\"32\" class=\"humanresources-tree-add-icon\"></BIcon>\n\t\t  </button>\n\t\t</div>\n\t`,\n};\n","import { Loc, Dom } from 'main.core';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { memberRoles, AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { AddUserDialog } from 'humanresources.company-structure.add-user-dialog';\nimport { MoveUserFromDialog } from 'humanresources.company-structure.move-user-from-dialog';\nimport { EventEmitter } from 'main.core.events';\nimport { events } from '../../../events';\nimport { HeadList } from './head-list/head-list';\n\nimport { DepartmentMenuButton } from './department-menu-button/department-menu-button';\nimport type { TreeItem, ConnectorData, TreeNodeData } from '../../../types';\nimport { SubdivisionAddButton } from './subdivision-add-button/subdivision-add-button';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\n\nexport const TreeNode = {\n\tname: 'treeNode',\n\n\tinject: ['getTreeBounds', 'getHeightDifference'],\n\n\tprops: {\n\t\tnodeId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\texpandedNodes: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tzoom: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentDepartment: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['calculatePosition'],\n\n\tcomponents: {\n\t\tDepartmentMenuButton,\n\t\tHeadList,\n\t\tSubdivisionAddButton,\n\t},\n\n\tdata(): TreeNodeData\n\t{\n\t\treturn {\n\t\t\tchildrenLoaded: false,\n\t\t\tchildrenOffset: 0,\n\t\t\tchildrenMounted: false,\n\t\t\tshowInfo: true,\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.width = 278;\n\t\tthis.gap = 20;\n\t\tthis.prevChildrenOffset = 0;\n\t},\n\n\tasync mounted(): Promise<void>\n\t{\n\t\tthis.showInfo = PermissionChecker.getInstance().hasPermission(PermissionActions.structureView, this.nodeId);\n\t\tthis.$emit('calculatePosition', this.nodeId);\n\t\tawait this.$nextTick();\n\t\tEventEmitter.emit(events.HR_DEPARTMENT_CONNECT, {\n\t\t\tid: this.nodeId,\n\t\t\tparentId: this.nodeData.parentId,\n\t\t\thtml: this.$el,\n\t\t\tparentsPath: this.getParentsPath(this.nodeData.parentId),\n\t\t\t...this.calculateNodePoints(),\n\t\t});\n\t},\n\twatch: {\n\t\thead()\n\t\t{\n\t\t\tthis.updateConnectors();\n\t\t},\n\t},\n\tunmounted(): Promise<void>\n\t{\n\t\tDom.remove(this.$el);\n\t\tconst { prevParentId } = this.nodeData;\n\t\tif (!prevParentId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$emit('calculatePosition', this.nodeId);\n\t\tEventEmitter.emit(events.HR_DEPARTMENT_DISCONNECT, {\n\t\t\tid: this.nodeId,\n\t\t\tparentId: prevParentId,\n\t\t});\n\t},\n\n\tcomputed:\n\t{\n\t\tnodeData(): TreeItem\n\t\t{\n\t\t\treturn this.departments.get(this.nodeId);\n\t\t},\n\t\tnodeClass(): { [key: string]: boolean; }\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--expanded': this.expandedNodes.includes(this.nodeId),\n\t\t\t\t'--current-department': this.isCurrentDepartment,\n\t\t\t\t'--focused': this.focusedNode === this.nodeId,\n\t\t\t};\n\t\t},\n\t\tsubdivisionsClass(): { [key: string]: boolean; }\n\t\t{\n\t\t\treturn {\n\t\t\t\t'humanresources-tree__node_arrow': this.hasChildren,\n\t\t\t\t'--up': this.hasChildren && this.isExpanded,\n\t\t\t\t'--down': this.hasChildren && !this.isExpanded,\n\t\t\t\t'--transparent': !this.hasChildren,\n\t\t\t};\n\t\t},\n\t\thasChildren(): boolean\n\t\t{\n\t\t\treturn this.nodeData.children?.length > 0;\n\t\t},\n\t\tisExpanded(): boolean\n\t\t{\n\t\t\tconst isExpanded = this.expandedNodes.includes(this.nodeId);\n\t\t\tif (isExpanded)\n\t\t\t{\n\t\t\t\tthis.childrenMounted = true;\n\t\t\t}\n\n\t\t\treturn isExpanded;\n\t\t},\n\t\tisCurrentDepartment(): Boolean\n\t\t{\n\t\t\treturn this.currentDepartment === this.nodeId;\n\t\t},\n\t\thead(): TreeItem['heads']\n\t\t{\n\t\t\treturn this.nodeData.heads?.filter((head) => {\n\t\t\t\treturn head.role === memberRoles.head;\n\t\t\t});\n\t\t},\n\t\tdeputy(): ?TreeItem['heads']\n\t\t{\n\t\t\treturn this.nodeData.heads?.filter((head) => {\n\t\t\t\treturn head.role === memberRoles.deputyHead;\n\t\t\t});\n\t\t},\n\t\temployeeCount(): number\n\t\t{\n\t\t\treturn this.nodeData.userCount - this.nodeData.heads.length;\n\t\t},\n\t\tchildNodeStyle(): Object\n\t\t{\n\t\t\tconst style = { left: `${this.childrenOffset}px` };\n\n\t\t\tif (!this.childrenLoaded)\n\t\t\t{\n\t\t\t\treturn style;\n\t\t\t}\n\n\t\t\tconst { childrenNode } = this.$refs;\n\n\t\t\tif (!childrenNode)\n\t\t\t{\n\t\t\t\treturn style;\n\t\t\t}\n\n\t\t\tconst { offsetParent: rootNode } = childrenNode;\n\n\t\t\tconst node = this.departments.get(this.nodeId);\n\n\t\t\tif (node.children.length === 0)\n\t\t\t{\n\t\t\t\treturn style;\n\t\t\t}\n\n\t\t\tconst top = this.top(node.children[0], rootNode);\n\t\t\tif (top !== null)\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line unicorn/consistent-destructuring,@bitrix24/bitrix24-rules/no-style\n\t\t\t\tstyle.top = `${top}px`;\n\t\t\t}\n\n\t\t\treturn style;\n\t\t},\n\t\tshowSubdivisionAddButton(): boolean\n\t\t{\n\t\t\treturn this.expandedNodes.includes(this.nodeId) || this.focusedNode === this.nodeId;\n\t\t},\n\t\t...mapState(useChartStore, ['departments', 'focusedNode']),\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonDepartmentClick(targetId: string): void\n\t\t{\n\t\t\tif (!this.showInfo)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_FOCUS, {\n\t\t\t\tnodeId: this.nodeId,\n\t\t\t\tshowEmployees: targetId === 'employees',\n\t\t\t\tsubdivisionsSelected: targetId === 'subdivisions',\n\t\t\t});\n\t\t},\n\t\tcalculatePosition(nodeId: number): void\n\t\t{\n\t\t\tconst node = this.departments.get(this.nodeId);\n\n\t\t\tif (node.children.length === 0)\n\t\t\t{\n\t\t\t\tthis.childrenOffset = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst gap = this.gap * (node.children.length - 1);\n\t\t\t\tthis.prevChildrenOffset = this.childrenOffset;\n\t\t\t\tthis.childrenOffset = (this.width - (this.width * node.children.length + gap)) / 2;\n\t\t\t\tthis.childrenLoaded = true;\n\t\t\t}\n\n\t\t\tconst offset = this.childrenOffset - this.prevChildrenOffset;\n\t\t\tif (offset !== 0)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_ADAPT_SIBLINGS, {\n\t\t\t\t\tparentId: this.nodeId,\n\t\t\t\t\tnodeId,\n\t\t\t\t\toffset,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\ttop(id: number, parentNode): ?number\n\t\t{\n\t\t\tconst heightDifference = this.getHeightDifference(id, parentNode, this.$refs[`node-${id}`][0].$el);\n\n\t\t\tif (heightDifference === 0)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\treturn parentNode.firstElementChild.offsetHeight + heightDifference;\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\tcontrolDepartment(action: string, source: string = AnalyticsSourceType.CARD): void\n\t\t{\n\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_CONTROL, {\n\t\t\t\tnodeId: this.nodeId,\n\t\t\t\taction,\n\t\t\t\tsource,\n\t\t\t});\n\t\t},\n\t\taddEmployee(): void\n\t\t{\n\t\t\tAddUserDialog.openDialog({ type: 'employee', nodeId: this.nodeId });\n\t\t},\n\t\tuserInvite(): void\n\t\t{\n\t\t\tconst departmentToInvite = this.departments.get(this.nodeId).accessCode.slice(1);\n\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t'/bitrix/services/main/ajax.php?action=getSliderContent'\n\t\t\t\t+ '&c=bitrix%3Aintranet.invitation&mode=ajax'\n\t\t\t\t+ `&departments[]=${departmentToInvite}&firstInvitationBlock=invite-with-group-dp`,\n\t\t\t\t{ cacheable: false, allowChangeHistory: false, width: 1100 },\n\t\t\t);\n\t\t},\n\t\tmoveEmployee(): void\n\t\t{\n\t\t\tMoveUserFromDialog.openDialog(this.nodeId);\n\t\t},\n\t\tlocPlural(phraseCode: string, count: number): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural(phraseCode, count, { '#COUNT#': count });\n\t\t},\n\t\tcalculateNodePoints(): { startPoint: ConnectorData['startPoint'], endPoint: ConnectorData['endPoint'] }\n\t\t{\n\t\t\tconst { left, top, width } = this.$el.getBoundingClientRect();\n\t\t\tconst { $el: parentNode } = this.$parent.$parent;\n\t\t\tconst {\n\t\t\t\tleft: parentLeft,\n\t\t\t\ttop: parentTop,\n\t\t\t\twidth: parentWidth,\n\t\t\t\theight: parentHeight,\n\t\t\t} = parentNode.getBoundingClientRect();\n\t\t\tconst { x: chartX, y: chartY } = this.getTreeBounds();\n\n\t\t\treturn {\n\t\t\t\tstartPoint: {\n\t\t\t\t\tx: (parentLeft - chartX + parentWidth / 2) / this.zoom,\n\t\t\t\t\ty: (parentTop - chartY + parentHeight) / this.zoom,\n\t\t\t\t},\n\t\t\t\tendPoint: {\n\t\t\t\t\tx: (left - chartX + width / 2) / this.zoom,\n\t\t\t\t\ty: (top - chartY) / this.zoom,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetParentsPath(parentId: number): Array<number>\n\t\t{\n\t\t\tlet topLevelId = parentId;\n\t\t\tconst parentsPath = [parentId];\n\t\t\twhile (topLevelId)\n\t\t\t{\n\t\t\t\tconst parentNode = this.departments.get(topLevelId);\n\t\t\t\ttopLevelId = parentNode.parentId;\n\t\t\t\tif (topLevelId)\n\t\t\t\t{\n\t\t\t\t\tparentsPath.push(topLevelId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn parentsPath;\n\t\t},\n\t\tupdateConnectors(): void\n\t\t{\n\t\t\tconst currentHeight = this.$el.firstElementChild.offsetHeight;\n\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tconst heightDifference = this.$el.firstElementChild.offsetHeight - currentHeight;\n\n\t\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_UPDATE, {\n\t\t\t\t\tid: this.nodeId,\n\t\t\t\t\tparentId: this.nodeData.parentId,\n\t\t\t\t\thtml: this.$el,\n\t\t\t\t\toffset: this.offset,\n\t\t\t\t\tparentsPath: this.getParentsPath(this.nodeData.parentId),\n\t\t\t\t\theightDifference,\n\t\t\t\t\t...this.calculateNodePoints(),\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:data-id=\"nodeId\"\n\t\t\t:class=\"nodeClass\"\n\t\t\t:data-title=\"isCurrentDepartment ? loc('HUMANRESOURCES_COMPANY_CURRENT_DEPARTMENT') : null\"\n\t\t\tclass=\"humanresources-tree__node\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"humanresources-tree__node_summary\"\n\t\t\t\t@click.stop=\"onDepartmentClick('department')\"\n\t\t\t>\n\t\t\t\t<div class=\"humanresources-tree__node_description\" :style=\"{ minHeight: !showInfo ? null : '136px'}\">\n\t\t\t\t\t<div class=\"humanresources-tree__node_department\" :style=\"{ justifyContent: !showInfo ? 'center' : 'space-between'}\">\n\t\t\t\t\t\t<span class=\"humanresources-tree__node_department-title\">\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"humanresources-tree__node_department-title_text\"\n\t\t\t\t\t\t\t\t:title=\"nodeData.name\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{nodeData.name}}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<DepartmentMenuButton\n\t\t\t\t\t\t\tv-if=\"showInfo\"\n\t\t\t\t\t\t\t:department-id=\"nodeId\"\n\t\t\t\t\t\t\t@addDepartment=\"controlDepartment\"\n\t\t\t\t\t\t\t@editDepartment=\"controlDepartment\"\n\t\t\t\t\t\t\t@editEmployee=\"controlDepartment\"\n\t\t\t\t\t\t\t@removeDepartment=\"controlDepartment\"\n\t\t\t\t\t\t\t@addEmployee=\"addEmployee\"\n\t\t\t\t\t\t\t@userInvite=\"userInvite\"\n\t\t\t\t\t\t\t@moveEmployee=\"moveEmployee\"\n\t\t\t\t\t\t></DepartmentMenuButton>\n\t\t\t\t\t</div>\n\t\t\t\t  \t<HeadList v-if=\"showInfo\" :items=\"head\"></HeadList>\n\t\t\t\t\t<div v-if=\"showInfo\" class=\"humanresources-tree__node_employees\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<p class=\"humanresources-tree__node_employees-title\">\n\t\t\t\t\t\t\t\t{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_EMPLOYEES_TITLE')}}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"humanresources-tree__node_employees-count\"\n\t\t\t\t\t\t\t\t@click.stop=\"onDepartmentClick('employees')\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{locPlural('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_EMPLOYEES_COUNT', employeeCount)}}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"!deputy.length\"></div>\n\t\t\t\t\t\t<HeadList :items=\"deputy\" :title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_DEPUTY_TITLE')\" :collapsed=\"true\"></HeadList>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"humanresources-tree__node_subdivisions\"\n\t\t\t\t\t:class=\"subdivisionsClass\"\n\t\t\t\t\tv-if=\"showInfo\"\n\t\t\t\t\t@click.stop=\"onDepartmentClick('subdivisions')\"\n\t\t\t\t>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t\tnodeData.children?.length ?\n\t\t\t\t\t\t\t\tlocPlural('HUMANRESOURCES_COMPANY_DEPARTMENT_CHILDREN_COUNT', nodeData.children.length) :\n\t\t\t\t\t\t\t\tloc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_NO_SUBDEPARTMENTS')\n\t\t\t\t\t\t}}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t  \t<SubdivisionAddButton\n\t\t\t\t\tv-if=\"showSubdivisionAddButton\"\n\t\t\t\t\t@addDepartment=\"controlDepartment('addDepartment', 'plus')\"\n\t\t\t\t\t:department-id=\"nodeId\"\n\t\t\t\t\t@click.stop\n\t\t\t\t></SubdivisionAddButton>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"hasChildren\"\n\t\t\t\tref=\"childrenNode\"\n\t\t\t\tclass=\"humanresources-tree__node_children\"\n\t\t\t\t:style=\"childNodeStyle\"\n\t\t\t>\n\t\t\t\t<TransitionGroup>\n\t\t\t\t\t<treeNode\n\t\t\t\t\t\tv-for=\"id in nodeData.children\"\n\t\t\t\t\t\tv-if=\"isExpanded || childrenMounted\"\n\t\t\t\t\t\tv-show=\"isExpanded\"\n\t\t\t\t\t\t:ref=\"'node-' + id\"\n\t\t\t\t\t\t:key=\"id\"\n\t\t\t\t\t\t:nodeId=\"id\"\n\t\t\t\t\t\t:expandedNodes=\"expandedNodes\"\n\t\t\t\t\t\t:zoom=\"zoom\"\n\t\t\t\t\t\t:currentDepartment=\"currentDepartment\"\n\t\t\t\t\t\t@calculatePosition=\"calculatePosition\"\n\t\t\t\t\t/>\n\t\t\t\t</TransitionGroup>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { getData, postData } from 'humanresources.company-structure.api';\n\nconst createTreeDataStore = (treeData) => {\n\tconst dataMap = new Map();\n\ttreeData.forEach((item) => {\n\t\tconst { id, parentId } = item;\n\t\tconst mapItem = dataMap.get(id) ?? {};\n\t\tdataMap.set(id, { ...mapItem, ...item });\n\t\tconst mapParentItem = dataMap.get(parentId) ?? {};\n\t\tconst children = mapParentItem.children ?? [];\n\t\tdataMap.set(parentId, {\n\t\t\t...mapParentItem,\n\t\t\tchildren: [...children, id],\n\t\t});\n\t});\n\n\treturn dataMap;\n};\n\nexport const chartAPI = {\n\tgetDepartment: (id: Number) => {\n\t\treturn getData('humanresources.api.Structure.Node.get', { nodeId: id });\n\t},\n\tremoveDepartment: (id: Number) => {\n\t\treturn getData('humanresources.api.Structure.Node.delete', { nodeId: id });\n\t},\n\tgetEmployees: (id: Number) => {\n\t\treturn getData('humanresources.api.Structure.Node.Member.Employee.get', { nodeId: id });\n\t},\n\tgetChartData: () => {\n\t\treturn getData('humanresources.api.Structure.get', {}, { tool: 'structure', category: 'structure', event: 'open_structure' });\n\t},\n\tgetCurrentDepartment: () => {\n\t\treturn getData('humanresources.api.Structure.Node.current');\n\t},\n\tgetDictionary: () => {\n\t\treturn getData('humanresources.api.Structure.dictionary');\n\t},\n\tgetUserId: () => {\n\t\treturn getData('humanresources.api.User.getCurrentId');\n\t},\n\tfirstTimeOpened: () => {\n\t\treturn postData('humanresources.api.User.firstTimeOpen');\n\t},\n\tcreateTreeDataStore,\n};\n","import { Event } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport { UI } from 'ui.notification';\nimport { ButtonColor } from 'ui.buttons';\nimport { TreeNode } from './tree-node/tree-node';\nimport { memberRoles, AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapWritableState, mapState } from 'ui.vue3.pinia';\nimport { EventEmitter } from 'main.core.events';\nimport { events } from '../../events';\nimport { chartAPI } from '../../api';\nimport { MenuActions } from './tree-node/department-menu-button/department-menu-button';\nimport { sendData as analyticsSendData } from 'ui.analytics';\n\nimport type { ConnectorData, TreeData } from '../../types';\nimport './style.css';\n\nexport const Tree = {\n\tname: 'tree',\n\n\tcomponents: { TreeNode },\n\n\tprops: {\n\t\tzoom: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['moveTo', 'showWizard', 'controlDetail'],\n\n\tdata(): TreeData\n\t{\n\t\treturn {\n\t\t\tconnectors: {},\n\t\t\texpandedNodes: [],\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.treeNodes = new Map();\n\t\tthis.subscribeOnEvents();\n\t\tthis.prevWindowWidth = window.innerWidth;\n\t\tconst [currentDepartment] = this.currentDepartments;\n\t\tif (currentDepartment)\n\t\t{\n\t\t\tif (currentDepartment !== this.rootId)\n\t\t\t{\n\t\t\t\tthis.expandDepartmentParents(currentDepartment);\n\t\t\t\tthis.focus(currentDepartment, { expandAfterFocus: true });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.expandLowerDepartments();\n\t\t\tthis.focus(currentDepartment);\n\t\t}\n\t},\n\n\tbeforeUnmount(): void\n\t{\n\t\tthis.unsubscribeOnEvents();\n\t},\n\n\tprovide(): { [key: string]: Function }\n\t{\n\t\treturn {\n\t\t\tgetTreeBounds: () => this.getTreeBounds(),\n\t\t\tgetHeightDifference: (nodeId: number, parentNode: HTMLElement, currentNode: HTMLElement) => {\n\t\t\t\treturn this.getHeightDifference(nodeId, parentNode, currentNode);\n\t\t\t},\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\trootId(): number\n\t\t{\n\t\t\tconst { id: rootId } = [...this.departments.values()].find((department) => {\n\t\t\t\treturn department.parentId === 0;\n\t\t\t});\n\n\t\t\treturn rootId;\n\t\t},\n\t\t...mapState(useChartStore, ['currentDepartments', 'userId']),\n\t\t...mapWritableState(useChartStore, ['departments', 'focusedNode', 'searchedUserId']),\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tgetTreeBounds(): DOMRect\n\t\t{\n\t\t\treturn this.$el.getBoundingClientRect();\n\t\t},\n\t\tgetHeightDifference(nodeId: number, parentNode: HTMLElement, currentNode: HTMLElement): number\n\t\t{\n\t\t\tconst node = this.departments.get(nodeId);\n\n\t\t\tif (!node || !node.parentId)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tconst parent = this.departments.get(node.parentId);\n\n\t\t\tif (!parent.parentId)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tlet parentHtml = this.treeNodes.get(node.parentId);\n\n\t\t\tif (!parentHtml && parentNode)\n\t\t\t{\n\t\t\t\tthis.treeNodes.set(node.parentId, parentNode);\n\t\t\t\tparentHtml = parentNode;\n\t\t\t}\n\n\t\t\tlet currentHtml = this.treeNodes.get(node.id);\n\n\t\t\tif (!currentHtml && currentNode)\n\t\t\t{\n\t\t\t\tthis.treeNodes.set(node.id, currentNode);\n\t\t\t\tcurrentHtml = currentNode;\n\t\t\t}\n\n\t\t\tif (parentHtml)\n\t\t\t{\n\t\t\t\treturn parentHtml.offsetHeight\n\t\t\t\t\t- parentHtml.firstElementChild.offsetHeight;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t},\n\t\tgetPath(id: string): string\n\t\t{\n\t\t\tconst connector = this.connectors[id];\n\t\t\tconst { startPoint, endPoint } = connector;\n\n\t\t\tif (!startPoint || !endPoint)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst calculatedHeightDifference = this.getHeightDifference(connector.id);\n\n\t\t\tconst lineLength = 50 + calculatedHeightDifference;\n\t\t\tconst shiftY = 1;\n\n\t\t\tconst startY = startPoint.y - shiftY - calculatedHeightDifference;\n\t\t\tconst shadowOffset = this.focusedNode === connector.id ? 9 : 0;\n\t\t\tconst rounded = { start: '', end: '' };\n\t\t\tlet arcRadius = 0;\n\n\t\t\tif (Math.round(startPoint.x) > Math.round(endPoint.x))\n\t\t\t{\n\t\t\t\tarcRadius = 15;\n\t\t\t\trounded.start = 'a15,15 0 0 1 -15,15';\n\t\t\t\trounded.end = 'a15,15 0 0 0 -15,15';\n\t\t\t}\n\t\t\telse if (Math.round(startPoint.x) < Math.round(endPoint.x))\n\t\t\t{\n\t\t\t\tarcRadius = -15;\n\t\t\t\trounded.start = 'a15,15 0 0 0 15,15';\n\t\t\t\trounded.end = 'a15,15 0 0 1 15,15';\n\t\t\t}\n\n\t\t\tconst adjustedEndY = endPoint.y - shadowOffset;\n\n\t\t\treturn [\n\t\t\t\t`M${startPoint.x} ${startY}`,\n\t\t\t\t`V${startY + lineLength}`,\n\t\t\t\t`${String(rounded.start)}`,\n\t\t\t\t`H${endPoint.x + arcRadius}`,\n\t\t\t\t`${String(rounded.end)}`,\n\t\t\t\t`V${adjustedEndY}`,\n\t\t\t].join('');\n\t\t},\n\t\tonConnectDepartment({ data }: ConnectorData): void\n\t\t{\n\t\t\tconst { id, parentId, html } = data;\n\t\t\tthis.treeNodes.set(id, html);\n\t\t\tconst [currentDepartment] = this.currentDepartments;\n\t\t\tif (id === currentDepartment)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.moveTo(currentDepartment);\n\t\t\t\t}, 1800);\n\t\t\t}\n\n\t\t\tif (!parentId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst connector = this.connectors[`${parentId}-${id}`] ?? {};\n\t\t\tObject.assign(connector, data);\n\t\t\tif (connector.highlighted)\n\t\t\t{\n\t\t\t\tdelete this.connectors[`${parentId}-${id}`];\n\t\t\t}\n\n\t\t\tthis.connectors[`${parentId}-${id}`] = {\n\t\t\t\tshow: true,\n\t\t\t\thighlighted: false,\n\t\t\t\t...connector,\n\t\t\t};\n\t\t},\n\t\tonDisconnectDepartment({ data }: ConnectorData): void\n\t\t{\n\t\t\tconst { id, parentId } = data;\n\t\t\tdelete this.connectors[`${parentId}-${id}`];\n\t\t\tconst department = this.departments.get(id);\n\t\t\tdelete department.prevParentId;\n\t\t\tif (!department.parentId)\n\t\t\t{\n\t\t\t\tthis.departments.delete(id);\n\t\t\t}\n\t\t},\n\t\tonAdaptSiblings({ data }): void\n\t\t{\n\t\t\tconst { nodeId, parentId, offset } = data;\n\t\t\tconst parentDepartment = this.departments.get(parentId);\n\t\t\tif (parentDepartment.children.includes(nodeId))\n\t\t\t{\n\t\t\t\tthis.adaptConnectorsAfterMount(parentId, nodeId, offset);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.adaptConnectorsAfterUnmount(parentId, nodeId, offset);\n\t\t},\n\t\tadaptConnectorsAfterMount(parentId: number, nodeId: number, offset: number): void\n\t\t{\n\t\t\tObject.entries(this.connectors).forEach(([key, connector]) => {\n\t\t\t\tif (!connector.id)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (connector.parentId === parentId)\n\t\t\t\t{\n\t\t\t\t\tconst { x } = connector.endPoint;\n\t\t\t\t\tObject.assign(connector.endPoint, { x: x + offset });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (connector.parentsPath.includes(parentId))\n\t\t\t\t{\n\t\t\t\t\tconst { startPoint: currentStartPoint, endPoint } = connector;\n\t\t\t\t\tObject.assign(currentStartPoint, { x: currentStartPoint.x + offset });\n\t\t\t\t\tObject.assign(endPoint, { x: endPoint.x + offset });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tadaptConnectorsAfterUnmount(parentId: number, nodeId: number, offset: number): void\n\t\t{\n\t\t\tconst entries = Object.entries(this.connectors);\n\t\t\tconst { endPoint } = this.connectors[`${parentId}-${nodeId}`];\n\t\t\tconst parsedSiblingConnectors = entries.reduce((acc, [key, connector]) => {\n\t\t\t\tconst { endPoint: currentEndPoint, id, parentId: currentParentId } = connector;\n\t\t\t\tif (currentParentId !== parentId || id === nodeId)\n\t\t\t\t{\n\t\t\t\t\treturn acc;\n\t\t\t\t}\n\n\t\t\t\tconst sign = endPoint.x > currentEndPoint.x ? 1 : -1;\n\n\t\t\t\treturn {\n\t\t\t\t\t...acc,\n\t\t\t\t\t[id]: sign,\n\t\t\t\t};\n\t\t\t}, {});\n\t\t\tentries.forEach(([key, connector]) => {\n\t\t\t\tconst {\n\t\t\t\t\tid: currentId,\n\t\t\t\t\tparentId: currentParentId,\n\t\t\t\t\tparentsPath,\n\t\t\t\t\tendPoint: currentEndPoint,\n\t\t\t\t\tstartPoint: currentStartPoint,\n\t\t\t\t} = connector;\n\t\t\t\tif (currentId === nodeId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (currentParentId === parentId)\n\t\t\t\t{\n\t\t\t\t\tconst { x } = currentEndPoint;\n\t\t\t\t\tconst sign = parsedSiblingConnectors[currentId];\n\t\t\t\t\tObject.assign(currentEndPoint, { x: x + offset * sign });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst ancestorId = parentsPath?.find((id) => {\n\t\t\t\t\treturn Boolean(parsedSiblingConnectors[id]);\n\t\t\t\t});\n\t\t\t\tif (ancestorId)\n\t\t\t\t{\n\t\t\t\t\tconst ancestorSign = parsedSiblingConnectors[ancestorId];\n\t\t\t\t\tObject.assign(currentStartPoint, { x: currentStartPoint.x + offset * ancestorSign });\n\t\t\t\t\tObject.assign(currentEndPoint, { x: currentEndPoint.x + offset * ancestorSign });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tcollapse(nodeId: number): void\n\t\t{\n\t\t\tthis.expandedNodes = this.expandedNodes.filter((expandedId) => expandedId !== nodeId);\n\t\t\tthis.toggleConnectorsVisibility(nodeId, false);\n\t\t\tthis.toggleConnectorHighlighting(nodeId, false);\n\t\t},\n\t\tcollapseRecursively(nodeId: number): void\n\t\t{\n\t\t\tconst deepCollapse = (id: number) => {\n\t\t\t\tthis.collapse(id);\n\t\t\t\tconst node = this.departments.get(id);\n\t\t\t\tnode.children?.forEach((childId) => {\n\t\t\t\t\tif (this.expandedNodes.includes(childId))\n\t\t\t\t\t{\n\t\t\t\t\t\tdeepCollapse(childId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t\tconst { parentId } = this.departments.get(nodeId);\n\t\t\tconst expandedNode = this.expandedNodes.find((id) => {\n\t\t\t\tconst node = this.departments.get(id);\n\n\t\t\t\treturn node.parentId === parentId;\n\t\t\t});\n\t\t\tif (expandedNode)\n\t\t\t{\n\t\t\t\tdeepCollapse(expandedNode);\n\t\t\t}\n\t\t},\n\t\texpand(nodeId: number): void\n\t\t{\n\t\t\tthis.collapseRecursively(nodeId);\n\t\t\tthis.expandedNodes = [...this.expandedNodes, nodeId];\n\t\t\tthis.toggleConnectorsVisibility(nodeId, true);\n\t\t\tthis.toggleConnectorHighlighting(nodeId, true);\n\n\t\t\tanalyticsSendData({ tool: 'structure', category: 'structure', event: 'expand_department' });\n\t\t},\n\t\tfocus(nodeId: number, options: Object = {}): void\n\t\t{\n\t\t\tconst { expandAfterFocus = false, showEmployees = false, subdivisionsSelected = false } = options;\n\t\t\tconst hasChildren = this.departments.get(nodeId).children?.length > 0;\n\n\t\t\tlet shouldExpand = expandAfterFocus || !this.expandedNodes.includes(nodeId);\n\t\t\tif (showEmployees)\n\t\t\t{\n\t\t\t\tshouldExpand = this.expandedNodes.includes(nodeId);\n\t\t\t}\n\n\t\t\tif (subdivisionsSelected || !hasChildren)\n\t\t\t{\n\t\t\t\tthis.collapseRecursively(nodeId);\n\t\t\t}\n\n\t\t\tif (hasChildren && shouldExpand)\n\t\t\t{\n\t\t\t\tthis.expand(nodeId);\n\t\t\t}\n\n\t\t\tif (this.focusedNode && !this.expandedNodes.includes(this.focusedNode))\n\t\t\t{\n\t\t\t\tthis.toggleConnectorHighlighting(this.focusedNode, false);\n\t\t\t}\n\n\t\t\tthis.focusedNode = nodeId;\n\t\t\tthis.toggleConnectorHighlighting(this.focusedNode, true);\n\t\t},\n\t\tonFocusDepartment({ data }: { nodeId: number }): void\n\t\t{\n\t\t\tconst { nodeId, showEmployees, subdivisionsSelected } = data;\n\t\t\tthis.focus(nodeId, { showEmployees, subdivisionsSelected });\n\t\t\tthis.$emit('controlDetail', {\n\t\t\t\tshowEmployees,\n\t\t\t\tpreventSwitch: subdivisionsSelected,\n\t\t\t});\n\t\t},\n\t\tonControlDepartment({ data }): void\n\t\t{\n\t\t\tconst { action, nodeId, source } = data;\n\t\t\tconst isEditMode = action === MenuActions.editDepartment\n\t\t\t\t|| action === MenuActions.editEmployee;\n\n\t\t\tif (isEditMode)\n\t\t\t{\n\t\t\t\tconst type = action === MenuActions.editDepartment\n\t\t\t\t\t? 'department' : 'employees';\n\t\t\t\tthis.$emit('showWizard', { nodeId, isEditMode: true, type, source });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (action === MenuActions.addDepartment)\n\t\t\t{\n\t\t\t\tthis.$emit('showWizard', { nodeId, isEditMode: false, showEntitySelector: false, source });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.tryRemoveDepartment(nodeId);\n\t\t},\n\t\ttryRemoveDepartment(nodeId: number): void\n\t\t{\n\t\t\tconst messageBox = MessageBox.create({\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_TITLE'),\n\t\t\t\tmessage: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_MESSAGE'),\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\tonOk: async (dialog: MessageBox) => {\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tawait this.removeDepartment(nodeId);\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_REMOVED'),\n\t\t\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t}\n\t\t\t\t\tcatch\n\t\t\t\t\t{\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_ERROR'),\n\t\t\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonCancel: (dialog: MessageBox) => dialog.close(),\n\t\t\t\tminWidth: 250,\n\t\t\t\tmaxWidth: 320,\n\t\t\t\tminHeight: 175,\n\t\t\t\tokCaption: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_OK_CAPTION'),\n\t\t\t\tpopupOptions: { className: 'humanresources-tree__message-box', overlay: { opacity: 40 } },\n\t\t\t});\n\t\t\tconst okButton = messageBox.getOkButton();\n\t\t\tconst cancelButton = messageBox.getCancelButton();\n\t\t\tokButton.setRound(true);\n\t\t\tcancelButton.setRound(true);\n\t\t\tokButton.setColor(ButtonColor.DANGER);\n\t\t\tcancelButton.setColor(ButtonColor.LIGHT_BORDER);\n\t\t\tmessageBox.show();\n\t\t},\n\t\tasync removeDepartment(nodeId: number): Promise<void>\n\t\t{\n\t\t\tawait chartAPI.removeDepartment(nodeId);\n\t\t\tconst removableDepartment = this.departments.get(nodeId);\n\t\t\tconst {\n\t\t\t\tparentId,\n\t\t\t\tchildren: removableDeparmentChildren = [],\n\t\t\t\tuserCount: removableDepartmentUserCount,\n\t\t\t\theads: removableDeparmentHeads,\n\t\t\t\temployees: removableDeparmentEmployees = [],\n\t\t\t} = removableDepartment;\n\t\t\tconst parentDepartment = this.departments.get(parentId);\n\t\t\tif (removableDeparmentChildren.length > 0)\n\t\t\t{\n\t\t\t\tthis.collapse(nodeId);\n\t\t\t}\n\n\t\t\tremovableDeparmentChildren.forEach((childId) => {\n\t\t\t\tconst department = this.departments.get(childId);\n\t\t\t\tdepartment.parentId = parentId;\n\t\t\t});\n\t\t\tif (removableDepartmentUserCount > 0)\n\t\t\t{\n\t\t\t\tconst parentDepartmentUsersIds = new Set([\n\t\t\t\t\t...parentDepartment.heads,\n\t\t\t\t\t...(parentDepartment.employees ?? []),\n\t\t\t\t].map((user) => user.id));\n\t\t\t\tconst removableDeparmentUsers = [...removableDeparmentHeads, ...removableDeparmentEmployees];\n\t\t\t\tconst movableUsers = removableDeparmentUsers.filter((user) => {\n\t\t\t\t\treturn !parentDepartmentUsersIds.has(user.id);\n\t\t\t\t});\n\t\t\t\tfor (const user of movableUsers)\n\t\t\t\t{\n\t\t\t\t\tuser.role = memberRoles.employee;\n\t\t\t\t}\n\t\t\t\tparentDepartment.userCount += movableUsers.length;\n\t\t\t\tparentDepartment.employees = [\n\t\t\t\t\t...(parentDepartment.employees ?? []),\n\t\t\t\t\t...movableUsers,\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tparentDepartment.children = [...parentDepartment.children, ...removableDeparmentChildren];\n\t\t\tawait this.$nextTick();\n\t\t\tparentDepartment.children = parentDepartment.children.filter((childId) => {\n\t\t\t\treturn childId !== nodeId;\n\t\t\t});\n\t\t\tdelete removableDepartment.parentId;\n\t\t\tthis.departments.set(nodeId, { ...removableDepartment, prevParentId: parentId });\n\t\t\tthis.focus(parentId, { expandAfterFocus: true });\n\t\t\tthis.moveTo(parentId);\n\t\t},\n\t\tonUpdateDepartment({ data }): void\n\t\t{\n\t\t\tconst { id, parentId, html, heightDifference } = data;\n\t\t\tthis.treeNodes.set(id, html);\n\n\t\t\tif (!parentId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst connector = this.connectors[`${parentId}-${id}`] ?? {};\n\t\t\tObject.assign(connector, data);\n\t\t\tif (connector.highlighted)\n\t\t\t{\n\t\t\t\tdelete this.connectors[`${parentId}-${id}`];\n\t\t\t}\n\n\t\t\tthis.connectors[`${parentId}-${id}`] = {\n\t\t\t\tshow: true,\n\t\t\t\thighlighted: false,\n\t\t\t\t...connector,\n\t\t\t};\n\n\t\t\tconst { children } = this.departments.get(id);\n\n\t\t\tchildren?.forEach((childId) => {\n\t\t\t\tthis.updateChildren(id, childId, heightDifference);\n\t\t\t});\n\t\t},\n\t\tupdateChildren(parentId: number, nodeId: number, heightDifference: number)\n\t\t{\n\t\t\tconst connectorId = `${parentId}-${nodeId}`;\n\n\t\t\tconst childConnector = this.connectors[connectorId];\n\n\t\t\tif (!childConnector)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchildConnector.startPoint.y += heightDifference;\n\t\t\tchildConnector.endPoint.y += heightDifference;\n\n\t\t\tconst connectorPath = this.$refs[connectorId][0];\n\n\t\t\tconnectorPath.setAttribute('d', this.getPath(connectorId));\n\n\t\t\tconst { children } = this.departments.get(nodeId);\n\n\t\t\tchildren?.forEach((childId) => {\n\t\t\t\tthis.updateChildren(nodeId, childId, heightDifference);\n\t\t\t});\n\t\t},\n\t\ttoggleConnectorsVisibility(parentId: number, show: boolean): void\n\t\t{\n\t\t\tconst { children } = this.departments.get(parentId);\n\t\t\tchildren.forEach((childId) => {\n\t\t\t\tconst connector = this.connectors[`${parentId}-${childId}`] ?? {};\n\t\t\t\tthis.connectors = {\n\t\t\t\t\t...this.connectors,\n\t\t\t\t\t[`${parentId}-${childId}`]: { ...connector, show },\n\t\t\t\t};\n\t\t\t\tif (this.expandedNodes.includes(childId))\n\t\t\t\t{\n\t\t\t\t\tthis.toggleConnectorsVisibility(childId, show);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttoggleConnectorHighlighting(nodeId: number, expanded: boolean): void\n\t\t{\n\t\t\tconst { parentId } = this.departments.get(nodeId);\n\t\t\tif (!parentId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!expanded)\n\t\t\t{\n\t\t\t\tthis.connectors[`${parentId}-${nodeId}`] = {\n\t\t\t\t\t...this.connectors[`${parentId}-${nodeId}`],\n\t\t\t\t\thighlighted: false,\n\t\t\t\t};\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst highlightedConnector = this.connectors[`${parentId}-${nodeId}`] ?? {};\n\t\t\tdelete this.connectors[`${parentId}-${nodeId}`];\n\t\t\tthis.connectors = {\n\t\t\t\t...this.connectors,\n\t\t\t\t[`${parentId}-${nodeId}`]: {\n\t\t\t\t\t...highlightedConnector,\n\t\t\t\t\thighlighted: true,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\texpandDepartmentParents(nodeId: number): void\n\t\t{\n\t\t\tlet { parentId } = this.departments.get(nodeId);\n\t\t\twhile (parentId)\n\t\t\t{\n\t\t\t\tif (!this.expandedNodes.includes(parentId))\n\t\t\t\t{\n\t\t\t\t\tthis.expand(parentId);\n\t\t\t\t}\n\n\t\t\t\tparentId = this.departments.get(parentId).parentId;\n\t\t\t}\n\t\t},\n\t\texpandLowerDepartments(): void\n\t\t{\n\t\t\tlet expandLevel = 0;\n\t\t\tconst expandRecursively = (departmentId: number) => {\n\t\t\t\tconst { children = [] } = this.departments.get(departmentId);\n\t\t\t\tif (expandLevel === 4 || children.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.expand(departmentId);\n\t\t\t\texpandLevel += 1;\n\t\t\t\tconst middleBound = Math.trunc(children.length / 2);\n\t\t\t\tconst childId = children[middleBound];\n\t\t\t\tif (this.departments.get(childId).children?.length > 0)\n\t\t\t\t{\n\t\t\t\t\texpandRecursively(childId);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor (let i = middleBound - 1; i >= 0; i--)\n\t\t\t\t{\n\t\t\t\t\tif (traverseSibling(children[i]))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (let i = middleBound + 1; i < children.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (traverseSibling(children[i]))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst traverseSibling = (siblingId: number) => {\n\t\t\t\tconst { children: currentChildren = [] } = this.departments.get(siblingId);\n\n\t\t\t\tif (currentChildren.length > 0)\n\t\t\t\t{\n\t\t\t\t\texpandRecursively(siblingId);\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\texpandRecursively(this.rootId);\n\t\t},\n\t\tlocateToCurrentDepartment(): void\n\t\t{\n\t\t\tconst [currentDepartment] = this.currentDepartments;\n\t\t\tif (!currentDepartment)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.expandDepartmentParents(currentDepartment);\n\t\t\tthis.focus(currentDepartment, { expandAfterFocus: true });\n\t\t\tthis.moveTo(currentDepartment);\n\t\t\tthis.searchedUserId = this.userId;\n\t\t},\n\t\tasync locateToDepartment(nodeId: number): Promise<void>\n\t\t{\n\t\t\tawait this.expandDepartmentParents(nodeId);\n\t\t\tawait this.focus(nodeId, { expandAfterFocus: true });\n\t\t\tawait this.moveTo(nodeId);\n\t\t},\n\t\tasync moveTo(nodeId: number): Promise<void>\n\t\t{\n\t\t\tawait this.$nextTick();\n\t\t\tconst treeRect = this.getTreeBounds();\n\t\t\tconst centerX = treeRect.x + treeRect.width / 2;\n\t\t\tconst centerY = treeRect.y + treeRect.height / 2;\n\t\t\tconst treeNode = this.treeNodes.get(nodeId);\n\t\t\tconst treeNodeRect = treeNode.getBoundingClientRect();\n\t\t\tthis.$emit('moveTo', {\n\t\t\t\tx: centerX - treeNodeRect.x - treeNodeRect.width / 2,\n\t\t\t\ty: centerY - treeNodeRect.y - treeNodeRect.height / 2,\n\t\t\t});\n\t\t},\n\t\tsubscribeOnEvents(): void\n\t\t{\n\t\t\tthis.events = {\n\t\t\t\t[events.HR_DEPARTMENT_CONNECT]: this.onConnectDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_DISCONNECT]: this.onDisconnectDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_FOCUS]: this.onFocusDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_CONTROL]: this.onControlDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_UPDATE]: this.onUpdateDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_ADAPT_SIBLINGS]: this.onAdaptSiblings,\n\t\t\t};\n\t\t\tObject.entries(this.events).forEach(([event, handle]) => {\n\t\t\t\tEventEmitter.subscribe(event, handle);\n\t\t\t});\n\t\t\tEvent.bind(window, 'resize', this.onResizeWindow);\n\t\t},\n\t\tunsubscribeOnEvents(): void\n\t\t{\n\t\t\tObject.entries(this.events).forEach(([event, handle]) => {\n\t\t\t\tEventEmitter.unsubscribe(event, handle);\n\t\t\t});\n\t\t\tEvent.unbind(window, 'resize', this.onResizeWindow);\n\t\t},\n\t\tonResizeWindow(): void\n\t\t{\n\t\t\tconst offset = (window.innerWidth - this.prevWindowWidth) / 2;\n\t\t\tthis.prevWindowWidth = window.innerWidth;\n\t\t\tif (offset === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tObject.keys(this.connectors).forEach((key) => {\n\t\t\t\tconst connector = this.connectors[key];\n\t\t\t\tif (connector.startPoint && connector.endPoint)\n\t\t\t\t{\n\t\t\t\t\tconst startPointX = connector.startPoint.x;\n\t\t\t\t\tconst endPointX = connector.endPoint.x;\n\t\t\t\t\tObject.assign(connector.startPoint, { x: startPointX + offset });\n\t\t\t\t\tObject.assign(connector.endPoint, { x: endPointX + offset });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"humanresources-tree\"\n\t\t\tv-if=\"departments.size > 0\"\n\t\t>\n\t\t\t<TreeNode\n\t\t\t\tclass=\"--root\"\n\t\t\t\t:key=\"rootId\"\n\t\t\t\t:nodeId=\"rootId\"\n\t\t\t\t:expandedNodes=\"[...expandedNodes]\"\n\t\t\t\t:zoom=\"zoom\"\n\t\t\t\t:currentDepartment=\"currentDepartments[0]\"\n\t\t\t/>\n\t\t\t<svg class=\"humanresources-tree__connectors\" fill=\"none\">\n\t\t\t\t<marker\n\t\t\t\t\tid='arrow'\n\t\t\t\t\tmarkerUnits='userSpaceOnUse'\n\t\t\t\t\tmarkerWidth='20'\n\t\t\t\t\tmarkerHeight='12'\n\t\t\t\t\trefX='10'\n\t\t\t\t\trefY='10.5'\n\t\t\t\t>\n\t\t\t\t\t<path d=\"M1 1L10 10L19 1\" class=\"--highlighted\" />\n\t\t\t\t</marker>\n\t\t\t\t<path\n\t\t\t\t\tv-for=\"(connector, id) in connectors\"\n\t\t\t\t\tv-show=\"connector.show\"\n\t\t\t\t\t:ref=\"id\"\n\t\t\t\t\t:marker-end=\"connector.highlighted ? 'url(#arrow)' : null\"\n\t\t\t\t\t:class=\"{ '--highlighted': connector.highlighted }\"\n\t\t\t\t\t:id=\"id\"\n\t\t\t\t\t:d=\"getPath(id)\"\n\t\t\t\t></path>\n\t\t\t</svg>\n\t\t</div>\n\t`,\n};\n","export const TransformPanel = {\n\tname: 'transform-panel',\n\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['locate', 'update:modelValue'],\n\n\tdata(): { selectedId: string; }\n\t{\n\t\treturn {\n\t\t\tselectedId: '',\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.actions = Object.freeze({\n\t\t\tzoomIn: 'zoomIn',\n\t\t\tzoomOut: 'zoomOut',\n\t\t\tlocate: 'locate',\n\t\t\tnavigate: 'navigate',\n\t\t});\n\t},\n\n\tcomputed:\n\t{\n\t\tzoomInPercent(): string\n\t\t{\n\t\t\tconst percent = '<span class=\"humanresources-transform-panel__zoom_percent\">%</span>';\n\n\t\t\treturn `${(this.modelValue.zoom * 100).toFixed(0)}${percent}`;\n\t\t},\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonZoom(zoomIn: boolean): void\n\t\t{\n\t\t\tconst leftBound = 0.2;\n\t\t\tconst rightBound = 3;\n\t\t\tlet direction = -1;\n\t\t\tif (zoomIn)\n\t\t\t{\n\t\t\t\tdirection = 1;\n\t\t\t\tthis.selectedId = this.actions.zoomIn;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selectedId = this.actions.zoomOut;\n\t\t\t}\n\n\t\t\tconst zoom = Number((this.modelValue.zoom + leftBound * direction).toFixed(1));\n\t\t\tif (zoom < leftBound || zoom > rightBound)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('update:modelValue', { ...this.modelValue, zoom });\n\t\t},\n\t\tonLocate(): void\n\t\t{\n\t\t\tconst { locate } = this.actions;\n\t\t\tthis.$emit(locate);\n\t\t\tthis.selectedId = locate;\n\t\t},\n\t\tonfocusout(): void\n\t\t{\n\t\t\tthis.selectedId = '';\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-transform-panel\" @focusout=\"onfocusout\" tabindex=\"-1\">\n\t\t\t<div\n\t\t\t\tclass=\"humanresources-transform-panel__locate\"\n\t\t\t\t:class=\"{ '--selected': selectedId === actions.locate }\"\n\t\t\t\t@click=\"onLocate\"\n\t\t\t>\n\t\t\t\t{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_LOCATE')}}\n\t\t\t</div>\n\t\t\t<div class=\"humanresources-transform-panel__separator\"></div>\n\t\t\t<div class=\"humanresources-transform-panel__zoom\">\n\t\t\t\t<svg\n\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tclass=\"humanresources-transform-panel__icon --zoom-out\"\n\t\t\t\t\t:class=\"{ '--selected': selectedId === actions.zoomOut }\"\n\t\t\t\t\t@click=\"onZoom(false)\"\n\t\t\t\t>\n\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M4 8.66671V7.33337H7.33333H8.66667H12V8.66671H8.66667H7.33333H4Z\" fill=\"#6A737F\"/>\n\t\t\t\t</svg>\n\t\t\t\t<span v-html=\"zoomInPercent\"></span>\n\t\t\t\t<svg\n\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tclass=\"humanresources-transform-panel__icon --zoom-in\"\n\t\t\t\t\t:class=\"{ '--selected': selectedId === actions.zoomIn }\"\n\t\t\t\t\t@click=\"onZoom(true)\"\n\t\t\t\t>\n\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M7.83333 4H9.16667V7.33333H12.5V8.66667H9.16667V12H7.83333V8.66667H4.5V7.33333H7.83333V4Z\" fill=\"#6A737F\"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export const DetailPanelCollapsedTitle = {\n\tname: 'detailPanelCollapsedTitle',\n\n\tprops:\n\t{\n\t\ttitle:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tavatars:\n\t\t{\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomputed:\n\t{\n\t\tmaxVisibleAvatarsCount(): Number\n\t\t{\n\t\t\treturn 2;\n\t\t},\n\t\tadditionalCount(): Number\n\t\t{\n\t\t\treturn this.avatars.length > this.maxVisibleAvatarsCount ? this.avatars.length - this.maxVisibleAvatarsCount : 0;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-detail-panel__collapsed-title\">\n\t\t\t<template v-for=\"(avatar, index) in avatars\">\n\t\t\t\t<img\n\t\t\t\t\tv-if=\"index < this.maxVisibleAvatarsCount\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:src=\"encodeURI(avatar)\"\n\t\t\t\t\tclass=\"humanresources-detail-panel__collapsed-title-avatar\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<div\n\t\t\t\tv-if=\"avatars.length > maxVisibleAvatarsCount\"\n\t\t\t\tclass=\"humanresources-detail-panel__collapsed-title-avatar --additional\"\n\t\t\t>\n\t\t\t +{{ additionalCount }}\t\n\t\t\t</div>\n\t\t\t<div class=\"humanresources-detail-panel__title\">{{ title }}</div>\n\t\t</div>\n\t`,\n};\n","import { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { Main, CRM } from 'ui.icon-set.api.core';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\n\nimport '../../style.css';\nimport 'ui.icon-set.main';\nimport 'ui.icon-set.crm';\n\nconst MenuOption = Object.freeze({\n\teditDepartment: 'editDepartment',\n\taddDepartment: 'addDepartment',\n\teditEmployee: 'editEmployee',\n\tmoveEmployee: 'moveEmployee',\n\tuserInvite: 'userInvite',\n\taddEmployee: 'addEmployee',\n\tremoveDepartment: 'removeDepartment',\n});\n\nexport const DetailPanelEditButton = {\n\tname: 'detailPanelEditButton',\n\temits: ['editDepartment', 'addDepartment', 'editEmployee', 'addEmployee', 'removeDepartment', 'moveEmployee', 'userInvite'],\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t\tBIcon,\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.permissionChecker = PermissionChecker.getInstance();\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.$emit(actionId, { role: this.role, bindElement: this.$refs.detailPanelEditButton });\n\t\t},\n\t},\n\n\tcomputed: {\n\t\t...mapState(useChartStore, ['focusedNode']),\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\tmenuItems(): Array\n\t\t{\n\t\t\tif (!this.permissionChecker)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.editDepartment,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_DEPARTMENT_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_DEPARTMENT_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.EDIT_PENCIL,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.departmentEdit },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.addDepartment,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.CUBE_PLUS,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.departmentCreate },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.editEmployee,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_EMPLOYEE_LIST_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_EMPLOYEE_LIST_SUBTITLE'),\n\t\t\t\t\timageClass: '-hr-department-org-chart-menu-edit-list',\n\t\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.moveEmployee,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_MOVE_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_MOVE_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.PERSON_ARROW_LEFT_1,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.userInvite,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_USER_INVITE_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_USER_INVITE_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.PERSON_LETTER,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.inviteToDepartment },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.addEmployee,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: CRM.PERSON_PLUS_2,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.employeeAddToDepartment },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.removeDepartment,\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_DEPARTMENT_TITLE'),\n\t\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_DEPARTMENT_SUBTITLE'),\n\t\t\t\t\tbIcon: {\n\t\t\t\t\t\tname: Main.TRASH_BIN,\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tcolor: getColorCode('paletteRed40'),\n\t\t\t\t\t},\n\t\t\t\t\tpermission: { action: PermissionActions.departmentDelete },\n\t\t\t\t},\n\t\t\t].filter((item) => {\n\t\t\t\tif (!item.permission)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn this.permissionChecker.hasPermission(item.permission.action, this.focusedNode);\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"menuItems.length\"\n\t\t\tclass=\"humanresources-detail-panel__edit-button\"\n\t\t\t:class=\"{ '--focused': menuVisible }\"\n\t\t\t:ref=\"'detailPanelEditButton'\"\n\t\t\t@click.stop=\"menuVisible = true\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\tclass=\"humanresources-detail-panel__edit-button-icon\"\n\t\t\t\t:name=\"set.MORE\"\n\t\t\t\t:size=\"20\"\n\t\t\t/>\n\t\t</div>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menuVisible\"\n\t\t\tid=\"department-detail-content-edit-menu\"\n\t\t\t:items=\"menuItems\"\n\t\t\t:width=\"302\"\n\t\t\t:bindElement=\"$refs.detailPanelEditButton\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"menuVisible = false\"\n\t\t/>\n\t`,\n};\n","import { DetailPanelCollapsedTitle } from './detail-panel-collapsed-title';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { memberRoles, AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { DepartmentContent } from 'humanresources.company-structure.department-content';\nimport { AddUserDialog } from 'humanresources.company-structure.add-user-dialog';\nimport { MoveUserFromDialog } from 'humanresources.company-structure.move-user-from-dialog';\nimport { DetailPanelEditButton } from './detail-panel-edit-button';\n\nexport const DetailPanel = {\n\tname: 'detailPanel',\n\n\temits: ['showWizard', 'removeDepartment', 'update:modelValue'],\n\n\tcomponents: { DepartmentContent, DetailPanelCollapsedTitle, DetailPanelEditButton },\n\n\tprops: {\n\t\tpreventPanelSwitch: Boolean,\n\t\tmodelValue: Boolean,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttitle: '',\n\t\t\tisCollapsed: true,\n\t\t\tisLoading: true,\n\t\t\tneedToShowLoader: false,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t\tdefaultAvatar(): String\n\t\t{\n\t\t\treturn '/bitrix/js/humanresources/company-structure/org-chart/src/images/default-user.svg';\n\t\t},\n\t\theadAvatarsArray(): Array\n\t\t{\n\t\t\tconst heads = this.departments.get(this.focusedNode).heads ?? [];\n\n\t\t\treturn heads\n\t\t\t\t?.filter((employee) => employee.role === memberRoles.head)\n\t\t\t\t?.map((employee) => employee.avatar || this.defaultAvatar) ?? []\n\t\t\t;\n\t\t},\n\t},\n\n\tmethods:\n\t{\n\t\ttoggleCollapse(): void\n\t\t{\n\t\t\tthis.$emit('update:modelValue', !this.isCollapsed);\n\t\t},\n\t\tupdateDetailPageHandler(nodeId: number, oldId: number): void\n\t\t{\n\t\t\tif (!this.preventPanelSwitch && oldId !== 0)\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', false);\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tconst department = this.departments.get(nodeId);\n\n\t\t\tthis.title = department.name ?? '';\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\taddEmployee(): void\n\t\t{\n\t\t\tAddUserDialog.openDialog();\n\t\t},\n\t\tuserInvite(): void\n\t\t{\n\t\t\tconst departmentToInvite = this.departments.get(this.focusedNode).accessCode.slice(1);\n\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t'/bitrix/services/main/ajax.php?action=getSliderContent'\n\t\t\t\t+ '&c=bitrix%3Aintranet.invitation&mode=ajax'\n\t\t\t\t+ `&departments[]=${departmentToInvite}&firstInvitationBlock=invite-with-group-dp`,\n\t\t\t\t{ cacheable: false, allowChangeHistory: false, width: 1100 },\n\t\t\t);\n\t\t},\n\t\tmoveEmployee(): void\n\t\t{\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tMoveUserFromDialog.openDialog(nodeId);\n\t\t},\n\t\teditEmployee(): void\n\t\t{\n\t\t\tthis.$emit('showWizard', {\n\t\t\t\tnodeId: this.focusedNode,\n\t\t\t\tisEditMode: true,\n\t\t\t\ttype: 'employees',\n\t\t\t\tsource: AnalyticsSourceType.DETAIL,\n\t\t\t});\n\t\t},\n\t\teditDepartment(): void\n\t\t{\n\t\t\tthis.$emit('showWizard', {\n\t\t\t\tnodeId: this.focusedNode,\n\t\t\t\tisEditMode: true,\n\t\t\t\ttype: 'department',\n\t\t\t\tsource: AnalyticsSourceType.DETAIL,\n\t\t\t});\n\t\t},\n\t\taddDepartment(): void\n\t\t{\n\t\t\tthis.$emit('showWizard', {\n\t\t\t\tnodeId: this.focusedNode,\n\t\t\t\tisEditMode: false,\n\t\t\t\tshowEntitySelector: false,\n\t\t\t\tsource: AnalyticsSourceType.DETAIL,\n\t\t\t});\n\t\t},\n\t\tremoveDepartment(): void\n\t\t{\n\t\t\tthis.$emit('removeDepartment', this.focusedNode);\n\t\t},\n\t\tshowLoader(): void\n\t\t{\n\t\t\tthis.needToShowLoader = true;\n\t\t},\n\t\thideLoader(): void\n\t\t{\n\t\t\tthis.needToShowLoader = false;\n\t\t},\n\t},\n\n\twatch: {\n\t\tfocusedNode(newId: number, oldId: number): void\n\t\t{\n\t\t\tthis.updateDetailPageHandler(newId, oldId);\n\t\t},\n\t\tmodelValue(collapsed: boolean): void\n\t\t{\n\t\t\tthis.isCollapsed = collapsed;\n\t\t},\n\t\tdepartments: {\n\t\t\thandler(newDepartments): void\n\t\t\t{\n\t\t\t\tconst department = newDepartments.get(this.focusedNode);\n\t\t\t\tif (department)\n\t\t\t\t{\n\t\t\t\t\tthis.title = department.name ?? '';\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"['humanresources-detail-panel', { '--collapsed': isCollapsed }]\"\n\t\t\tv-on=\"isCollapsed ? { click: toggleCollapse } : {}\"\n\t\t>\n\t\t\t<div\n\t\t\t\tv-if=\"!isLoading\"\n\t\t\t\tclass=\"humanresources-detail-panel-container\"\n\t\t\t\t:class=\"{ '--hide': needToShowLoader && !isCollapsed }\"\n\t\t\t>\n\t\t\t\t<div class=\"humanresources-detail-panel__head\">\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-if=\"!isCollapsed\"\n\t\t\t\t\t\tclass=\"humanresources-detail-panel__title\"\n\t\t\t\t\t\t:title=\"title\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<DetailPanelCollapsedTitle\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\t:title=\"title\"\n\t\t\t\t\t\t:avatars=\"headAvatarsArray\"\n\t\t\t\t\t>\n\t\t\t\t\t</DetailPanelCollapsedTitle>\n\t\t\t\t\t<div class=\"humanresources-detail-panel__header_buttons_container\">\n\t\t\t\t\t\t<DetailPanelEditButton\n\t\t\t\t\t\t\tv-if=\"!isCollapsed\"\n\t\t\t\t\t\t\t@addEmployee=\"addEmployee\"\n\t\t\t\t\t\t\t@editEmployee=\"editEmployee\"\n\t\t\t\t\t\t\t@editDepartment=\"editDepartment\"\n\t\t\t\t\t\t\t@addDepartment=\"addDepartment\"\n\t\t\t\t\t\t\t@moveEmployee=\"moveEmployee\"\n\t\t\t\t\t\t\t@removeDepartment=\"removeDepartment\"\n\t\t\t\t\t\t\t@userInvite=\"userInvite\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"humanresources-detail-panel__collapse_button --icon\"\n\t\t\t\t\t\t\t@click=\"toggleCollapse\"\n\t\t\t\t\t\t\t:class=\"{ '--collapsed': isCollapsed }\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"humanresources-detail-panel__content\" v-show=\"!isCollapsed\">\n\t\t\t\t\t<DepartmentContent\n\t\t\t\t\t\t@editEmployee=\"editEmployee\"\n\t\t\t\t\t\t@showDetailLoader=\"showLoader\"\n\t\t\t\t\t\t@hideDetailLoader=\"hideLoader\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"needToShowLoader && !isCollapsed\" class=\"humanresources-detail-panel-loader-container\"/>\n\t\t</div>\n\t`,\n};\n","import 'ui.buttons';\nimport 'ui.forms';\nimport './style.css';\nimport { chartAPI } from '../../api';\n\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\n\nexport const FirstPopup = {\n\tname: 'FirstPopup',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tshow: false,\n\t\t\ttitle: '',\n\t\t\tdescription: '',\n\t\t\tsubDescription: '',\n\t\t\tfeatures: [],\n\t\t};\n\t},\n\tasync mounted() {\n\t\tthis.title = this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_TITLE');\n\t\tthis.description = this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_DESCRIPTION');\n\t\tthis.subDescription = this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_SUB_DESCRIPTION');\n\t\tthis.features = [\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_1'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_2'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_3'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_4'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_5'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_6'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_7'),\n\t\t];\n\n\t\tconst { firstTimeOpened } = await chartAPI.getDictionary();\n\t\tthis.show = firstTimeOpened === 'N' && this.title.length > 0;\n\t},\n\n\tmethods: {\n\t\tclosePopup() {\n\t\t\tchartAPI.firstTimeOpened();\n\t\t\tthis.show = false;\n\t\t\ttop.BX.Event.EventEmitter.emit('HR.company-structure:first-popup-showed');\n\t\t},\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"show\" class=\"first-popup\">\n\t\t\t<div class=\"first-popup-overlay\" @click=\"closePopup\"></div>\n\t\t\t<div class=\"first-popup-content\">\n\t\t\t\t<div class=\"title\">{{ title }}</div>\n\t\t\t\t<div class=\"first-popup-left\">\n\t\t\t\t\t<p class=\"description\">{{ description }}</p>\n\t\t\t\t\t<p class=\"sub-description\">{{ subDescription }}</p>\n\t\t\t\t\t<div class=\"first-popup-list\">\n\t\t\t\t\t\t<div class=\"first-popup-list-item\" v-for=\"(feature, index) in features\" :key=\"index\">\n\t\t\t\t\t\t\t<div class=\"first-popup-list-item-point\">•</div>\n\t\t\t\t\t\t\t<div class=\"first-popup-list-item-feature\">{{ feature }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class=\"ui-btn ui-btn-success first-popup-ui-btn\" @click=\"closePopup\">\n\t\t\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_BUTTON_START') }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"first-popup-right\">\n\t\t\t\t\t<video\n\t\t\t\t\t\tsrc=\"/bitrix/js/humanresources/company-structure/org-chart/src/images/preview.webm\"\n\t\t\t\t\t\tautoplay\n\t\t\t\t\t\tloop\n\t\t\t\t\t\tmuted\n\t\t\t\t\t\tplaysinline\n\t\t\t\t\t\tclass=\"first-popup-animation\"\n\t\t\t\t\t></video>\n\t\t\t\t</div>\n\t\t\t\t<BIcon :name=\"set.CROSS_25\" :size=\"24\" class=\"first-popup-close\" @click=\"closePopup\"></BIcon>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapWritableState } from 'ui.vue3.pinia';\nimport { Confetti } from 'ui.confetti';\nimport { TransformCanvas } from 'humanresources.company-structure.canvas';\nimport { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { TitlePanel } from './components/title-panel/title-panel';\nimport { Tree } from './components/tree/tree';\nimport { TransformPanel } from './components/transfrom-panel';\nimport { DetailPanel } from './components/detail-panel/detail-panel';\nimport { FirstPopup } from './components/first-popup/first-popup';\nimport { ChartWizard } from 'humanresources.company-structure.chart-wizard';\nimport { chartAPI } from './api';\nimport { events } from './events';\nimport { sendData as analyticsSendData } from 'ui.analytics';\n\nimport type { ChartData } from './types';\nimport './style.css';\nimport 'ui.design-tokens';\n\nexport const Chart = {\n\tcomponents: {\n\t\tTransformCanvas,\n\t\tTree,\n\t\tTransformPanel,\n\t\tChartWizard,\n\t\tFirstPopup,\n\t\tDetailPanel,\n\t\tTitlePanel,\n\t},\n\n\tdata(): ChartData\n\t{\n\t\treturn {\n\t\t\tcanvas: {\n\t\t\t\tshown: false,\n\t\t\t\tmoving: false,\n\t\t\t\tmodelTransform: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\tzoom: 0.3,\n\t\t\t\t},\n\t\t\t},\n\t\t\twizard: {\n\t\t\t\tshown: false,\n\t\t\t\tisEditMode: false,\n\t\t\t\tshowEntitySelector: true,\n\t\t\t\tentity: '',\n\t\t\t\tnodeId: 0,\n\t\t\t\tsource: '',\n\t\t\t},\n\t\t\tdetailPanel: {\n\t\t\t\tcollapsed: true,\n\t\t\t\tpreventSwitch: false,\n\t\t\t},\n\t\t};\n\t},\n\n\tasync created(): Promise<void>\n\t{\n\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\tslider.showLoader();\n\t\t}\n\t\tconst [departments, currentDepartments, userId] = await Promise.all([\n\t\t\tchartAPI.getChartData(),\n\t\t\tchartAPI.getCurrentDepartment(),\n\t\t\tchartAPI.getUserId(),\n\t\t]);\n\t\tconst parsedDepartments = chartAPI.createTreeDataStore(departments);\n\t\tif (slider)\n\t\t{\n\t\t\tslider.closeLoader();\n\t\t}\n\t\tthis.departments = parsedDepartments;\n\t\tthis.currentDepartments = currentDepartments;\n\t\tthis.userId = userId;\n\t\tthis.searchedUserId = this.userId;\n\t\tconst [currentDepartment] = this.currentDepartments;\n\t\tthis.transformCanvas(currentDepartment);\n\t\tthis.canvas.shown = true;\n\t\tthis.showConfetti = false;\n\t},\n\n\tcomputed:\n\t{\n\t\trootId(): number\n\t\t{\n\t\t\tconst { id: rootId } = [...this.departments.values()].find((department) => {\n\t\t\t\treturn department.parentId === 0;\n\t\t\t});\n\n\t\t\treturn rootId;\n\t\t},\n\t\t...mapWritableState(useChartStore, ['departments', 'currentDepartments', 'userId', 'searchedUserId']),\n\t},\n\n\tmethods:\n\t{\n\t\tonMoveTo({ x, y }: { x: Number; y: Number; }): void\n\t\t{\n\t\t\tconst { x: prevX, y: prevY, zoom } = this.canvas.modelTransform;\n\t\t\tconst detailPanelWidth = 364 * zoom;\n\t\t\tconst newX = x - detailPanelWidth / 2;\n\t\t\tconst notSamePoint = Math.round(newX) !== Math.round(prevX) || Math.round(y) !== Math.round(prevY);\n\t\t\tconst shouldMove = notSamePoint && !this.canvas.moving;\n\t\t\tthis.detailPanel = {\n\t\t\t\t...this.detailPanel,\n\t\t\t\tcollapsed: false,\n\t\t\t};\n\t\t\tif (!shouldMove)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.canvas = {\n\t\t\t\t...this.canvas,\n\t\t\t\tmoving: true,\n\t\t\t\tmodelTransform: { ...this.canvas.modelTransform, x: newX / zoom, y: y / zoom, zoom: 1 },\n\t\t\t};\n\t\t},\n\t\tonLocate(nodeId: ?number): void\n\t\t{\n\t\t\tif (nodeId)\n\t\t\t{\n\t\t\t\tthis.$refs.tree.locateToDepartment(nodeId);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$refs.tree.locateToCurrentDepartment();\n\t\t},\n\t\tonShowWizard({\n\t\t\tnodeId = 0,\n\t\t\tisEditMode = false,\n\t\t\ttype,\n\t\t\tshowEntitySelector = true,\n\t\t\tsource = '',\n\t\t}: { nodeId: number; isEditMode: boolean, showEntitySelector: boolean, source: string } = {}): void\n\t\t{\n\t\t\tthis.wizard = {\n\t\t\t\t...this.wizard,\n\t\t\t\tshown: true,\n\t\t\t\tisEditMode,\n\t\t\t\tshowEntitySelector,\n\t\t\t\tentity: type,\n\t\t\t\tnodeId,\n\t\t\t\tsource,\n\t\t\t};\n\n\t\t\tif (!isEditMode && source !== AnalyticsSourceType.HEADER)\n\t\t\t{\n\t\t\t\tanalyticsSendData({\n\t\t\t\t\ttool: 'structure',\n\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\tevent: 'create_dept_step1',\n\t\t\t\t\tc_element: source,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// eslint-disable-next-line default-case\n\t\t\tswitch (type)\n\t\t\t{\n\t\t\t\tcase 'department':\n\t\t\t\t\tanalyticsSendData({\n\t\t\t\t\t\ttool: 'structure',\n\t\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\t\tevent: 'create_dept_step1',\n\t\t\t\t\t\tc_element: source,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'employees':\n\t\t\t\t\tanalyticsSendData({\n\t\t\t\t\t\ttool: 'structure',\n\t\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\t\tevent: 'create_dept_step2',\n\t\t\t\t\t\tc_element: source,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'bindChat':\n\t\t\t\t\tanalyticsSendData({\n\t\t\t\t\t\ttool: 'structure',\n\t\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\t\tevent: 'create_dept_step3',\n\t\t\t\t\t\tc_element: source,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\tasync onModifyTree({ id, parentId, showConfetti }): Promise<void>\n\t\t{\n\t\t\tthis.showConfetti = showConfetti ?? false;\n\t\t\tconst { tree } = this.$refs;\n\t\t\ttree.expandDepartmentParents(id);\n\t\t\ttree.focus(id, { expandAfterFocus: true });\n\t\t\tawait this.$nextTick();\n\t\t\ttree.moveTo(id);\n\t\t},\n\t\tonWizardClose(): void\n\t\t{\n\t\t\tthis.wizard.shown = false;\n\t\t},\n\t\tonRemoveDepartment(nodeId: number): void\n\t\t{\n\t\t\tconst { tree } = this.$refs;\n\t\t\ttree.tryRemoveDepartment(nodeId);\n\t\t},\n\t\tonTransitionEnd(): void\n\t\t{\n\t\t\tthis.canvas.moving = false;\n\t\t\tif (this.showConfetti)\n\t\t\t{\n\t\t\t\tConfetti.fire({\n\t\t\t\t\tparticleCount: 300,\n\t\t\t\t\tstartVelocity: 10,\n\t\t\t\t\tspread: 400,\n\t\t\t\t\tticks: 100,\n\t\t\t\t\torigin: { y: 0.4, x: 0.37 },\n\t\t\t\t});\n\t\t\t\tthis.showConfetti = false;\n\t\t\t}\n\t\t},\n\t\tonControlDetail({ showEmployees, preventSwitch }): void\n\t\t{\n\t\t\tthis.detailPanel = {\n\t\t\t\t...this.detailPanel,\n\t\t\t\tpreventSwitch,\n\t\t\t};\n\t\t\tif (!showEmployees)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.detailPanel = {\n\t\t\t\t...this.detailPanel,\n\t\t\t\tcollapsed: false,\n\t\t\t};\n\t\t},\n\t\ttransformCanvas(currentDepartment: number): void\n\t\t{\n\t\t\tconst { zoom } = this.canvas.modelTransform;\n\t\t\tconst { offsetWidth, offsetHeight } = this.$el;\n\t\t\tconst y = currentDepartment === this.rootId ? 10 : offsetHeight / 2 - (offsetHeight * zoom) / 2;\n\t\t\tthis.canvas.modelTransform = {\n\t\t\t\t...this.canvas.modelTransform,\n\t\t\t\tx: offsetWidth / 2 - (offsetWidth * zoom) / 2,\n\t\t\t\ty,\n\t\t\t};\n\t\t},\n\t\tonUpdateTransform(): void\n\t\t{\n\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_MENU_CLOSE);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-chart\">\n\t\t\t<TitlePanel @showWizard=\"onShowWizard\" @locate=\"onLocate\"></TitlePanel>\n\t\t\t<TransformCanvas\n\t\t\t\tv-if=\"canvas.shown\"\n\t\t\t\tv-slot=\"{transform}\"\n\t\t\t\tv-model=\"canvas.modelTransform\"\n\t\t\t\t@update:modelValue=\"onUpdateTransform\"\n\t\t\t\t:class=\"{ '--moving': canvas.moving }\"\n\t\t\t\t@transitionend=\"onTransitionEnd\"\n\t\t\t>\n\t\t\t\t<Tree\n\t\t\t\t\t:zoom=\"transform.zoom\"\n\t\t\t\t\tref=\"tree\"\n\t\t\t\t\t@moveTo=\"onMoveTo\"\n\t\t\t\t\t@showWizard=\"onShowWizard\"\n\t\t\t\t\t@controlDetail=\"onControlDetail\"\n\t\t\t\t/>\n\t\t\t</TransformCanvas>\n\t\t\t<DetailPanel\n\t\t\t\t@showWizard=\"onShowWizard\"\n\t\t\t\t@removeDepartment=\"onRemoveDepartment\"\n\t\t\t\tv-model=\"detailPanel.collapsed\"\n\t\t\t\t:preventPanelSwitch=\"detailPanel.preventSwitch\"\n\t\t\t></DetailPanel>\n\t\t\t<TransformPanel\n\t\t\t\tv-model=\"canvas.modelTransform\"\n\t\t\t\t@locate=\"onLocate\"\n\t\t\t></TransformPanel>\n\t\t\t<ChartWizard\n\t\t\t\tv-if=\"wizard.shown\"\n\t\t\t\t:nodeId=\"wizard.nodeId\"\n\t\t\t\t:isEditMode=\"wizard.isEditMode\"\n\t\t\t\t:showEntitySelector=\"wizard.showEntitySelector\"\n\t\t\t\t:entity=\"wizard.entity\"\n\t\t\t\t:source=\"wizard.source\"\n\t\t\t\t@modifyTree=\"onModifyTree\"\n\t\t\t\t@close=\"onWizardClose\"\n\t\t\t></ChartWizard>\n\t\t\t<FirstPopup/>\n\t\t\t<div class=\"humanresources-chart__back\"></div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { events } from './events';\nimport { BitrixVue } from 'ui.vue3';\nimport { createPinia } from 'ui.vue3.pinia';\nimport { Dom } from 'main.core';\nimport { Chart } from './app';\nimport { PermissionChecker } from 'humanresources.company-structure.permission-checker';\n\nexport class App\n{\n\tstatic #subscribeOnEvents(app: Object): void\n\t{\n\t\tconst onCloseByEsc = (event: BaseEvent) => {\n\t\t\tconst [sidePanelEvent] = event.data;\n\t\t\tsidePanelEvent.denyAction();\n\t\t};\n\n\t\tconst onClose = () => {\n\t\t\tEventEmitter.unsubscribe(events.HR_ORG_CHART_CLOSE_BY_ESC, onCloseByEsc);\n\t\t\tEventEmitter.unsubscribe(events.HR_ORG_CHART_CLOSE, onClose);\n\t\t\tapp.unmount();\n\t\t};\n\t\tEventEmitter.subscribe(events.HR_ORG_CHART_CLOSE_BY_ESC, onCloseByEsc);\n\t\tEventEmitter.subscribe(events.HR_ORG_CHART_CLOSE, onClose);\n\t}\n\n\tstatic async mount(containerId: string): void\n\t{\n\t\tconst container = document.getElementById(containerId);\n\t\tconst app = BitrixVue.createApp(Chart);\n\t\tconst store = createPinia();\n\t\tapp.use(store);\n\t\tApp.#subscribeOnEvents(app);\n\n\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\tslider.showLoader();\n\t\t}\n\t\tDom.addClass(container, 'humanresources-chart__back');\n\n\t\tawait PermissionChecker.init();\n\t\tif (slider)\n\t\t{\n\t\t\tslider.closeLoader();\n\t\t}\n\t\tDom.removeClass(container, 'humanresources-chart__back');\n\t\tapp.mount(container);\n\t}\n}\n"],"names":["events","Object","freeze","HR_DEPARTMENT_CONNECT","HR_DEPARTMENT_DISCONNECT","HR_DEPARTMENT_ADAPT_SIBLINGS","HR_DEPARTMENT_FOCUS","HR_DEPARTMENT_CONTROL","HR_DEPARTMENT_UPDATE","HR_DEPARTMENT_MENU_CLOSE","HR_ORG_CHART_CLOSE_BY_ESC","HR_ORG_CHART_CLOSE","MenuOption","addDepartment","addEmployee","AddButton","name","emits","data","actionMenu","visible","components","RouteActionMenu","mounted","permissionChecker","PermissionChecker","getInstance","dropdownItems","id","title","loc","description","bIcon","Main","CUBE_PLUS","size","color","getColorCode","permission","action","PermissionActions","departmentCreate","CRM","PERSON_PLUS_2","employeeAddToDepartment","filter","item","hasPermissionOfAction","computed","methods","phraseCode","replacements","$Bitrix","Loc","getMessage","$emit","actionMenuItemClickHandler","actionId","template","SearchBar","BIcon","directives","focus","el","canEditPermissions","showSearchBar","created","searchDialog","getSearchDialog","set","Set","mapWritableState","useChartStore","showSearchbar","analyticsSendData","tool","category","event","hideSearchbar","dialog","Dialog","width","height","multiple","entities","searchFields","type","system","searchable","options","intranetUsersOnly","emailUsers","inviteEmployeeLink","selectMode","flatMode","fillRecentTab","recentTabOptions","dropdownMode","enableSearch","hideOnDeselect","context","getData","entityType","customData","get","searchedUserId","recentItemsToSave","push","saveRecentItems","onLoad","target","items","forEach","getSubtitle","setSubtitle","onDestroy","onEnter","$refs","searchName","setTargetNode","isOpen","show","Event","bind","window","handleClickOutside","parentElement","contains","clearSearch","unbind","search","value","getSearchTab","clearResults","selectTab","watch","departments","handler","destroy","deep","accessRights","BurgerMenuButton","SHIELD","BX","SidePanel","Instance","open","usePadding","TitlePanel","canAddNode","toolbarStarActive","isHovered","toolbarStarElement","document","getElementById","accessEdit","error","console","observer","MutationObserver","Dom","hasClass","observe","attributes","attributeFilter","toolbarStarIcon","FAVORITE_1","FAVORITE_0","source","AnalyticsSourceType","HEADER","onLocate","nodeId","triggerFavoriteStar","click","UI","Notification","Center","notify","content","autoHideDelay","HeadList","props","Array","required","default","String","collapsed","Boolean","isCollapsed","isUpdating","defaultAvatar","handleUserClick","url","cacheable","MenuActions","editDepartment","editEmployee","moveEmployee","userInvite","removeDepartment","DepartmentMenuButton","departmentId","Number","menuItems","EDIT_PENCIL","departmentEdit","imageClass","PERSON_ARROW_LEFT_1","PERSON_LETTER","inviteToDepartment","TRASH_BIN","departmentDelete","hasPermission","menu","onActionMenuItemClick","closeMenu","EventEmitter","unsubscribe","openMenu","subscribe","SubdivisionAddButton","canShow","addSubdivision","TreeNode","inject","expandedNodes","zoom","currentDepartment","childrenLoaded","childrenOffset","childrenMounted","showInfo","gap","prevChildrenOffset","structureView","$nextTick","emit","parentId","nodeData","html","$el","parentsPath","getParentsPath","calculateNodePoints","head","updateConnectors","unmounted","remove","prevParentId","nodeClass","includes","isCurrentDepartment","focusedNode","subdivisionsClass","hasChildren","isExpanded","children","length","heads","role","memberRoles","deputy","deputyHead","employeeCount","userCount","childNodeStyle","style","left","childrenNode","offsetParent","rootNode","node","top","showSubdivisionAddButton","mapState","onDepartmentClick","targetId","showEmployees","subdivisionsSelected","calculatePosition","offset","parentNode","heightDifference","getHeightDifference","firstElementChild","offsetHeight","controlDepartment","CARD","AddUserDialog","openDialog","departmentToInvite","accessCode","slice","allowChangeHistory","MoveUserFromDialog","locPlural","count","getMessagePlural","getBoundingClientRect","$parent","parentLeft","parentTop","parentWidth","parentHeight","x","chartX","y","chartY","getTreeBounds","startPoint","endPoint","topLevelId","currentHeight","createTreeDataStore","treeData","dataMap","Map","mapItem","mapParentItem","chartAPI","getDepartment","getEmployees","getChartData","getCurrentDepartment","getDictionary","getUserId","firstTimeOpened","postData","Tree","connectors","treeNodes","subscribeOnEvents","prevWindowWidth","innerWidth","currentDepartments","rootId","expandDepartmentParents","expandAfterFocus","expandLowerDepartments","beforeUnmount","unsubscribeOnEvents","provide","currentNode","values","find","department","parent","parentHtml","currentHtml","getPath","connector","calculatedHeightDifference","lineLength","shiftY","startY","shadowOffset","rounded","start","end","arcRadius","Math","round","adjustedEndY","join","onConnectDepartment","setTimeout","moveTo","assign","highlighted","onDisconnectDepartment","delete","onAdaptSiblings","parentDepartment","adaptConnectorsAfterMount","adaptConnectorsAfterUnmount","entries","key","currentStartPoint","parsedSiblingConnectors","reduce","acc","currentEndPoint","currentParentId","sign","currentId","ancestorId","ancestorSign","collapse","expandedId","toggleConnectorsVisibility","toggleConnectorHighlighting","collapseRecursively","deepCollapse","childId","expandedNode","expand","shouldExpand","onFocusDepartment","preventSwitch","onControlDepartment","isEditMode","showEntitySelector","tryRemoveDepartment","messageBox","MessageBox","create","message","buttons","MessageBoxButtons","OK_CANCEL","onOk","close","onCancel","minWidth","maxWidth","minHeight","okCaption","popupOptions","className","overlay","opacity","okButton","getOkButton","cancelButton","getCancelButton","setRound","setColor","ButtonColor","DANGER","LIGHT_BORDER","removableDepartment","removableDeparmentChildren","removableDepartmentUserCount","removableDeparmentHeads","employees","removableDeparmentEmployees","parentDepartmentUsersIds","map","user","removableDeparmentUsers","movableUsers","has","employee","onUpdateDepartment","updateChildren","connectorId","childConnector","connectorPath","setAttribute","expanded","highlightedConnector","expandLevel","expandRecursively","middleBound","trunc","i","traverseSibling","siblingId","currentChildren","locateToCurrentDepartment","userId","locateToDepartment","treeRect","centerX","centerY","treeNode","treeNodeRect","handle","onResizeWindow","keys","startPointX","endPointX","TransformPanel","modelValue","selectedId","actions","zoomIn","zoomOut","locate","navigate","zoomInPercent","percent","toFixed","onZoom","leftBound","rightBound","direction","onfocusout","DetailPanelCollapsedTitle","avatars","maxVisibleAvatarsCount","additionalCount","DetailPanelEditButton","menuVisible","bindElement","detailPanelEditButton","DetailPanel","DepartmentContent","preventPanelSwitch","isLoading","needToShowLoader","headAvatarsArray","avatar","toggleCollapse","updateDetailPageHandler","oldId","DETAIL","showLoader","hideLoader","newId","newDepartments","FirstPopup","subDescription","features","closePopup","Chart","TransformCanvas","ChartWizard","canvas","shown","moving","modelTransform","wizard","entity","detailPanel","slider","getTopSlider","Promise","all","parsedDepartments","closeLoader","transformCanvas","showConfetti","onMoveTo","prevX","prevY","detailPanelWidth","newX","notSamePoint","shouldMove","tree","onShowWizard","c_element","onModifyTree","onWizardClose","onRemoveDepartment","onTransitionEnd","Confetti","fire","particleCount","startVelocity","spread","ticks","origin","onControlDetail","offsetWidth","onUpdateTransform","App","mount","containerId","container","app","BitrixVue","createApp","store","createPinia","use","addClass","init","removeClass","onCloseByEsc","sidePanelEvent","denyAction","onClose","unmount"],"mappings":"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"}