this.BX=this.BX||{};this.BX.Humanresources=this.BX.Humanresources||{};(function(e,s,t,o,r,i,a){"use strict";let l=e=>e,n;class d extends i.BaseHeader{render(){const{header:e,headerCloseButton:s}=o.Tag.render(n||(n=l`
			<div ref="header" class="hr-move-user-from-dialog__header">
				<div ref="headerCloseButton" class="hr-move-user-from-dialog__header-close_button"></div>
				<div class="hr-move-user-from__header-text-container">
					<span class="hr-move-user-from-dialog__header-title">
						${0}
					</span>
					<span class="hr-move-user-from-dialog__header-description">
						${0}
					</span>
				</div>
			</div>
		`),o.Loc.getMessage("HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_MOVE_USER_FROM_DIALOG_TITLE"),o.Loc.getMessage("HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_MOVE_USER_FROM_DIALOG_DESCRIPTION"));o.Event.bind(s,"click",(e=>{this.getDialog().hide()}));return e}}let u=e=>e,c;const h="ui-btn-disabled";var b=babelHelpers.classPrivateFieldLooseKey("nodeId");var v=babelHelpers.classPrivateFieldLooseKey("moveEmployees");var p=babelHelpers.classPrivateFieldLooseKey("destroyDialog");var E=babelHelpers.classPrivateFieldLooseKey("handleOnTagAdd");var m=babelHelpers.classPrivateFieldLooseKey("handleOnTagRemove");var _=babelHelpers.classPrivateFieldLooseKey("onUserToggle");var f=babelHelpers.classPrivateFieldLooseKey("toggleAddButton");class g extends i.BaseFooter{constructor(e,s){super(e,s);Object.defineProperty(this,f,{value:C});Object.defineProperty(this,_,{value:R});Object.defineProperty(this,m,{value:M});Object.defineProperty(this,E,{value:T});Object.defineProperty(this,p,{value:P});Object.defineProperty(this,v,{value:O});Object.defineProperty(this,b,{writable:true,value:void 0});const t=this.getDialog().getSelectedItems();this.userCount=t.length;this.users=[];t.forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,_)[_](e)}));babelHelpers.classPrivateFieldLooseBase(this,b)[b]=this.getOption("nodeId");this.getDialog().subscribe("Item:onSelect",babelHelpers.classPrivateFieldLooseBase(this,E)[E].bind(this));this.getDialog().subscribe("Item:onDeselect",babelHelpers.classPrivateFieldLooseBase(this,m)[m].bind(this))}render(){const{footer:e,footerAddButton:s,footerCloseButton:t}=o.Tag.render(c||(c=u`
			<div ref="footer" class="hr-move-user-from-dialog__footer">
				<button ref="footerAddButton" class="ui-btn ui-btn ui-btn-sm ui-btn-primary ${0} ui-btn-round hr-move-user-from-dialog-btn-width">
					${0}
				</button>
				<button ref="footerCloseButton" class="ui-btn ui-btn ui-btn-sm ui-btn-light-border ui-btn-round hr-move-user-from-dialog-btn-width">
					${0}
				</button>
			</div>
		`),this.users.length===0?h:"",o.Loc.getMessage("HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_MOVE_USER_FROM_DIALOG_ADD"),o.Loc.getMessage("HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_MOVE_USER_FROM_DIALOG_REMOVE"));this.footerAddButton=s;o.Event.bind(t,"click",(e=>{this.dialog.hide()}));o.Event.bind(s,"click",(e=>{const t=this.dialog.getSelectedItems();const r=t.map((e=>e.getId()));if(r.length>0){o.Dom.addClass(s,"ui-btn-wait");babelHelpers.classPrivateFieldLooseBase(this,v)[v](r)}}));return e}}async function O(e){var i,l;if(!this.userCount){return}if(this.isMoving){return}this.isMoving=true;const n={[r.memberRoles.employee]:e};const{data:d}=await o.ajax.runAction("humanresources.api.Structure.Node.Member.moveUserListToDepartment",{data:{nodeId:babelHelpers.classPrivateFieldLooseBase(this,b)[b],userIds:n}});const u=s.useChartStore();const c=u.departments.get(babelHelpers.classPrivateFieldLooseBase(this,b)[b]);if(!c){babelHelpers.classPrivateFieldLooseBase(this,p)[p]();return}const h=new Set(this.users.map((e=>e.id)));const v=((i=c.employees)!=null?i:[]).filter((e=>!h.has(e.id)));const E=new Set(c.heads.map((e=>e.id)));this.users=this.users.filter((e=>!E.has(e.id)));v.push(...this.users);c.employees=v;c.userCount=(l=d.userCount)!=null?l:0;if(d.updatedDepartmentIds){void t.refreshDepartments(d.updatedDepartmentIds)}if(this.users.length>1){a.UI.Notification.Center.notify({content:o.Text.encode(o.Loc.getMessage("HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_MOVE_USER_FROM_DIALOG_ADD_EMPLOYEES_MESSAGE",{"#DEPARTMENT#":c.name})),autoHideDelay:2e3});babelHelpers.classPrivateFieldLooseBase(this,p)[p]();return}if(this.users.length===1){a.UI.Notification.Center.notify({content:o.Text.encode(o.Loc.getMessage("HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_MOVE_USER_FROM_DIALOG_ADD_EMPLOYEE_MESSAGE",{"#DEPARTMENT#":c.name})),autoHideDelay:2e3})}babelHelpers.classPrivateFieldLooseBase(this,p)[p]()}function P(){this.isAdding=false;this.getDialog().destroy()}function T(e){const{item:s}=e.getData();babelHelpers.classPrivateFieldLooseBase(this,_)[_](s)}function M(e){const{item:s}=e.getData();babelHelpers.classPrivateFieldLooseBase(this,_)[_](s,false)}function R(e,s=true){if(!s){this.users=this.users.filter((s=>s.id!==e.id));this.userCount-=1;babelHelpers.classPrivateFieldLooseBase(this,f)[f]();return}const o=t.getUserStoreItemByDialogItem(e,this.role);this.users=[...this.users,o];this.userCount+=1;babelHelpers.classPrivateFieldLooseBase(this,f)[f]()}function C(){if(this.userCount===0){o.Dom.addClass(this.footerAddButton,h);return}o.Dom.removeClass(this.footerAddButton,h)}const H="hr-move-user-from-department-dialog";var L=babelHelpers.classPrivateFieldLooseKey("dialog");var S=babelHelpers.classPrivateFieldLooseKey("nodeId");var B=babelHelpers.classPrivateFieldLooseKey("createDialog");class D{constructor(e){Object.defineProperty(this,B,{value:y});Object.defineProperty(this,L,{writable:true,value:void 0});Object.defineProperty(this,S,{writable:true,value:void 0});this.id=H;babelHelpers.classPrivateFieldLooseBase(this,S)[S]=e;babelHelpers.classPrivateFieldLooseBase(this,B)[B]()}static openDialog(e){const s=new D(e);s.show()}show(){babelHelpers.classPrivateFieldLooseBase(this,L)[L].show()}}function y(){babelHelpers.classPrivateFieldLooseBase(this,L)[L]=new i.Dialog({id:this.id,width:400,height:511,multiple:true,cacheable:false,dropdownMode:true,compactView:false,enableSearch:true,showAvatars:true,autoHide:false,header:d,footer:g,footerOptions:{nodeId:babelHelpers.classPrivateFieldLooseBase(this,S)[S]},popupOptions:{overlay:{opacity:40}},entities:[{id:"user",options:{intranetUsersOnly:true,inviteEmployeeLink:false}}]})}e.MoveUserFromDialog=D})(this.BX.Humanresources.CompanyStructure=this.BX.Humanresources.CompanyStructure||{},BX.Humanresources.CompanyStructure,BX.Humanresources.CompanyStructure,BX,BX.Humanresources.CompanyStructure,BX.UI.EntitySelector,BX);
//# sourceMappingURL=move-user-from-dialog.bundle.map.js