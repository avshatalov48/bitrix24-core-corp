{"version":3,"file":"canvas.bundle.js","sources":["../src/components/canvas.js"],"sourcesContent":["import type { CanvasData } from '../types';\nimport '../style.css';\n\nexport const TransformCanvas = {\n\tname: 'transform-canvas',\n\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t\tzoomSensitivity: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0.01,\n\t\t},\n\t\tzoomSensitivityMouse: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0.001,\n\t\t},\n\t},\n\n\temits: ['update:modelValue'],\n\n\tdata(): CanvasData\n\t{\n\t\treturn {\n\t\t\ttransform: {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0,\n\t\t\t\tzoom: 1,\n\t\t\t},\n\t\t\tdragging: false,\n\t\t\tzooming: false,\n\t\t\tlastWheelEventTime: null,\n\t\t\tdragDirection: null,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tcanvasClass(): { [key: string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--dragging': this.dragging,\n\t\t\t\t'--zooming': this.zooming,\n\t\t\t};\n\t\t},\n\t\ttransformStyles(): { [key: string]: string }\n\t\t{\n\t\t\tthis.transform = this.modelValue ? {\n\t\t\t\t...this.modelValue,\n\t\t\t} : this.transform;\n\t\t\tconst { x, y, zoom } = this.transform;\n\n\t\t\treturn {\n\t\t\t\ttransform: `translate(${x}px, ${y}px) scale(${zoom})`,\n\t\t\t};\n\t\t},\n\t},\n\n\tmethods: {\n\t\tonmousedown(event: MouseEvent): void\n\t\t{\n\t\t\tthis.dragOn = true;\n\t\t\tthis.dragDirection = null;\n\t\t},\n\n\t\tonmousemove(event: MouseEvent): void\n\t\t{\n\t\t\tif (!this.dragOn)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (event.buttons !== 1)\n\t\t\t{\n\t\t\t\tthis.dragOn = false;\n\t\t\t\tthis.dragging = false;\n\t\t\t\tthis.dragDirection = null;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.dragging = true;\n\t\t\tif (!this.dragDirection)\n\t\t\t{\n\t\t\t\tif (Math.abs(event.movementX) > Math.abs(event.movementY))\n\t\t\t\t{\n\t\t\t\t\tthis.dragDirection = 'horizontal';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.dragDirection = 'vertical';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twindow.requestAnimationFrame(() => {\n\t\t\t\tthis.transform.x += event.movementX;\n\t\t\t\tthis.transform.y += event.movementY;\n\t\t\t\tthis.$emit('update:modelValue', this.transform);\n\t\t\t});\n\t\t},\n\n\t\tonmouseup(): void\n\t\t{\n\t\t\tthis.dragOn = false;\n\t\t\tthis.dragging = false;\n\t\t\tthis.dragDirection = null;\n\t\t},\n\n\t\toncontextmenu(event: MouseEvent): void\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t},\n\n\t\tisTrackpad(event: WheelEvent): boolean\n\t\t{\n\t\t\treturn event.wheelDeltaY\n\t\t\t\t? event.wheelDeltaY === -3 * event.deltaY\n\t\t\t\t: event.deltaMode === 0\n\t\t\t;\n\t\t},\n\n\t\tonwheel(event: WheelEvent): void\n\t\t{\n\t\t\tconst isTrackpad = this.isTrackpad(event);\n\n\t\t\tif (event.ctrlKey)\n\t\t\t{\n\t\t\t\tconst zoomSensitivity =\t!isTrackpad && !event.ctrlKey\n\t\t\t\t\t? this.zoomSensitivityMouse\n\t\t\t\t\t: this.zoomSensitivity\n\t\t\t\t;\n\n\t\t\t\tconst mouseX = event.clientX;\n\t\t\t\tconst mouseY = event.clientY;\n\t\t\t\tconst zoomChange = -event.deltaY * zoomSensitivity;\n\n\t\t\t\tconst newZoom = Math.min(Math.max(0.2, this.transform.zoom + zoomChange), 3);\n\n\t\t\t\tconst oldCenterX = (mouseX - this.transform.x) / this.transform.zoom;\n\t\t\t\tconst oldCenterY = (mouseY - this.transform.y) / this.transform.zoom;\n\n\t\t\t\tthis.transform.zoom = newZoom;\n\t\t\t\tthis.transform.x = mouseX - oldCenterX * newZoom;\n\t\t\t\tthis.transform.y = mouseY - oldCenterY * newZoom;\n\n\t\t\t\tthis.zooming = true;\n\t\t\t\tthis.$emit('update:modelValue', this.transform);\n\n\t\t\t\tevent.preventDefault();\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.zooming = false;\n\t\t\t\t}, 200);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst dx = event.deltaX;\n\t\t\t\tconst dy = event.deltaY;\n\n\t\t\t\tthis.transform.x -= dx;\n\t\t\t\tthis.transform.y -= dy;\n\t\t\t\tthis.$emit('update:modelValue', this.transform);\n\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"humanresources-canvas\"\n\t\t\t:class=\"canvasClass\"\n\t\t\t@mousedown=\"onmousedown\"\n\t\t\t@mousemove=\"onmousemove\"\n\t\t\t@mouseup=\"onmouseup\"\n\t\t\t@wheel=\"onwheel\"\n\t\t\t@contextmenu=\"oncontextmenu\"\n\t\t>\n\t\t<div\n\t\t\tclass=\"humanresources-canvas__transform\"\n\t\t\t:style=\"transformStyles\"\n\t\t>\n\t\t\t<slot :transform=\"transform\"/>\n\t\t</div>\n\t\t</div>\n\t`,\n};\n"],"names":["TransformCanvas","name","props","modelValue","type","Object","required","zoomSensitivity","Number","default","zoomSensitivityMouse","emits","data","transform","x","y","zoom","dragging","zooming","lastWheelEventTime","dragDirection","computed","canvasClass","transformStyles","methods","onmousedown","event","dragOn","onmousemove","buttons","Math","abs","movementX","movementY","window","requestAnimationFrame","$emit","onmouseup","oncontextmenu","preventDefault","isTrackpad","wheelDeltaY","deltaY","deltaMode","onwheel","ctrlKey","mouseX","clientX","mouseY","clientY","zoomChange","newZoom","min","max","oldCenterX","oldCenterY","setTimeout","dx","deltaX","dy","template"],"mappings":"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"}