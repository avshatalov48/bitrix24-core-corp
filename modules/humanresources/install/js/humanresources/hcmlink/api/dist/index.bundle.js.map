{"version":3,"file":"index.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { UI } from 'ui.notification';\nimport { ajax, Text } from 'main.core';\n\ntype ApiOptions = {\n\tendpoint: string;\n\ttoken: string;\n};\n\ntype LoadMapperConfig = {\n\titems: $ReadOnlyArray<{\n\t\tid: number,\n\t\tname: string,\n\t\tavatarLink: string,\n\t\tposition: string,\n\t\tsuggestId: number | null\n\t}>,\n\tisHideInfoAlert: boolean,\n\tcountUnmappedPersons: number,\n\tcountMappedPersons: number,\n\tmappedUserIds: Array,\n};\n\nexport type {\n\tApiOptions,\n};\n\nexport class Api\n{\n\t// eslint-disable-next-line no-unused-private-class-members\n\t#options: ApiOptions;\n\n\tconstructor(options: ApiOptions)\n\t{\n\t\tthis.#options = options;\n\t}\n\n\tsaveMapping(data)\n\t{\n\t\treturn this.#post('humanresources.HcmLink.Mapper.save', data, true);\n\t}\n\n\tloadMapperConfig(data): Promise<LoadMapperConfig>\n\t{\n\t\treturn this.#post('humanresources.HcmLink.Mapper.load', data, true);\n\t}\n\n\tgetJobStatus(data): Promise<{status?: string, jobId?: number, finishedAt: string}>\n\t{\n\t\treturn this.#post('humanresources.HcmLink.Mapper.getJobStatus', data, true);\n\t}\n\n\tloadCompanyConfig(data)\n\t{\n\t\treturn this.#post('humanresources.HcmLink.Company.Config.load', data, true);\n\t}\n\n\tcloseInfoAlert()\n\t{\n\t\treturn this.#post('humanresources.HcmLink.Mapper.closeInfoAlert');\n\t}\n\n\tremoveLinkMapped(data)\n\t{\n\t\treturn this.#post('humanresources.HcmLink.Mapper.delete', data, true);\n\t}\n\n\tcreateUpdateEmployeeListJob(data)\n\t{\n\t\treturn this.#post('humanresources.HcmLink.Mapper.start', data, true);\n\t}\n\n\tgetLastJob(data): Promise<{status?: string, jobId?: number, finishedAt: string}>\n\t{\n\t\treturn this.#post('humanresources.HcmLink.Mapper.getLastJob', data, true);\n\t}\n\n\tcancelJob(data): Promise<void>\n\t{\n\t\treturn this.#post('humanresources.HcmLink.Mapper.cancelJob', data, true);\n\t}\n\n\tcreateCompleteMappingEmployeeListJob(data)\n\t{\n\t\treturn this.#post('humanresources.HcmLink.Mapper.end', data, true);\n\t}\n\n\t#get(endpoint: string, displayErrors: boolean = true): Promise\n\t{\n\t\treturn this.#request('GET', endpoint, null, displayErrors);\n\t}\n\n\t#post(endpoint: string, data: Object = null, displayErrors: boolean = true): Promise\n\t{\n\t\treturn this.#request('POST', endpoint, data, displayErrors);\n\t}\n\n\tasync #request(method: string, endpoint: string, data: Object = {}, displayError: boolean = true): Promise\n\t{\n\t\tconst config = { method };\n\t\tif (method === 'POST')\n\t\t{\n\t\t\tObject.assign(config, { data }, {\n\t\t\t\tpreparePost: false,\n\t\t\t\theaders: [{\n\t\t\t\t\tname: 'Content-Type',\n\t\t\t\t\tvalue: 'application/json',\n\t\t\t\t}],\n\t\t\t});\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst response = await ajax.runAction(endpoint, config);\n\t\t\tif (response.errors?.length > 0)\n\t\t\t{\n\t\t\t\tthrow new Error(response.errors[0].message);\n\t\t\t}\n\n\t\t\treturn response.data;\n\t\t}\n\t\tcatch (ex)\n\t\t{\n\t\t\tconst { message = `Error in ${endpoint}`, errors = [] } = ex;\n\t\t\tconst content = errors[0]?.message ?? message;\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: Text.encode(content),\n\t\t\t\tautoHideDelay: 4000,\n\t\t\t});\n\n\t\t\tthrow ex;\n\t\t}\n\t}\n}\n"],"names":["Api","constructor","options","saveMapping","data","loadMapperConfig","getJobStatus","loadCompanyConfig","closeInfoAlert","removeLinkMapped","createUpdateEmployeeListJob","getLastJob","cancelJob","createCompleteMappingEmployeeListJob","endpoint","displayErrors","method","displayError","config","Object","assign","preparePost","headers","name","value","response","ajax","runAction","errors","length","Error","message","ex","content","UI","Notification","Center","notify","Text","encode","autoHideDelay"],"mappings":"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"}