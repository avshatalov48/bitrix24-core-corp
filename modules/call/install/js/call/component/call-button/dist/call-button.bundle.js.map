{"version":3,"file":"call-button.bundle.js","sources":["../src/classes/call-menu.js","../src/components/call-button-title.js","../src/components/call-button-promo.js","../src/components/pulse-animation/pulse-animation.js","../src/call-button.js"],"sourcesContent":["import { Loc, Tag } from 'main.core';\n\nimport { Messenger } from 'im.public';\nimport { Core } from 'im.v2.application.core';\nimport { ActionByRole, ChatType, RestMethod } from 'im.v2.const';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { BaseMenu } from 'im.v2.lib.menu';\nimport { CallManager } from 'im.v2.lib.call';\nimport { runAction } from 'im.v2.lib.rest';\nimport { Feature, FeatureManager } from 'im.v2.lib.feature';\nimport { Analytics } from 'call.lib.analytics';\n\nimport { CallTypes } from 'call.const';\n\nimport type { ImModelChat, ImModelUser } from 'im.v2.model';\nimport type { MenuItem } from 'im.v2.lib.menu';\nimport type { PopupOptions } from 'main.popup';\n\nexport class CallMenu extends BaseMenu\n{\n\tcontext: ImModelChat;\n\n\tstatic events = {\n\t\tonMenuItemClick: 'onMenuItemClick',\n\t};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'bx-im-chat-header-call-menu';\n\t}\n\n\tgetMenuOptions(): PopupOptions\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\tangle: true,\n\t\t\toffsetLeft: 4,\n\t\t\toffsetTop: 5,\n\t\t};\n\t}\n\n\tgetMenuClassName(): String\n\t{\n\t\treturn 'bx-im-messenger__scope bx-call-chat-header-call-button__scope';\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.#getVideoCallItem(),\n\t\t\tthis.#getAudioCallItem(),\n\t\t\tthis.#getZoomItem(),\n\t\t\tthis.#getDelimiter(),\n\t\t\tthis.#getPersonalPhoneItem(),\n\t\t\tthis.#getWorkPhoneItem(),\n\t\t\tthis.#getInnerPhoneItem(),\n\t\t];\n\t}\n\n\t#getDelimiter(): MenuItem\n\t{\n\t\treturn { delimiter: true };\n\t}\n\n\t#getVideoCallItem(): MenuItem\n\t{\n\t\tconst isAvailable = this.#isCallAvailable(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('CALL_CONTENT_CHAT_HEADER_VIDEOCALL'),\n\t\t\tonclick: () => {\n\t\t\t\tif (!isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.#analyticsOnStartCallClick(CallTypes.video.id);\n\n\t\t\t\tCallTypes.video.start(this.context.dialogId);\n\t\t\t\tthis.emit(CallMenu.events.onMenuItemClick, CallTypes.video);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t\tdisabled: !isAvailable,\n\t\t};\n\t}\n\n\t#getAudioCallItem(): MenuItem\n\t{\n\t\tconst isAvailable = this.#isCallAvailable(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('CALL_CONTENT_CHAT_HEADER_CALL_MENU_AUDIO'),\n\t\t\tonclick: () => {\n\t\t\t\tif (!isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.#analyticsOnStartCallClick(CallTypes.audio.id);\n\t\t\t\tCallTypes.audio.start(this.context.dialogId);\n\n\t\t\t\tthis.emit(CallMenu.events.onMenuItemClick, CallTypes.audio);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t\tdisabled: !isAvailable,\n\t\t};\n\t}\n\n\t#analyticsOnStartCallClick(callType)\n\t{\n\t\tAnalytics.getInstance().onContextMenuStartCallClick({\n\t\t\tcontext: this.context,\n\t\t\tcallType,\n\t\t});\n\t}\n\n\t#getPersonalPhoneItem(): ?MenuItem\n\t{\n\t\tif (!this.#isUser())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { phones } = this.#getUser();\n\t\tif (!phones.personalMobile)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst title = Loc.getMessage('CALL_CONTENT_CHAT_HEADER_CALL_MENU_PERSONAL_PHONE');\n\n\t\treturn {\n\t\t\tclassName: 'menu-popup-no-icon bx-call-chat-header-call-button-menu__item',\n\t\t\thtml: this.#getUserPhoneHtml(title, phones.personalMobile),\n\t\t\tonclick: () => {\n\t\t\t\tMessenger.startPhoneCall(phones.personalMobile);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getWorkPhoneItem(): ?MenuItem\n\t{\n\t\tif (!this.#isUser())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { phones } = this.#getUser();\n\t\tif (!phones.workPhone)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst title = Loc.getMessage('CALL_CONTENT_CHAT_HEADER_CALL_MENU_WORK_PHONE');\n\n\t\treturn {\n\t\t\tclassName: 'menu-popup-no-icon bx-call-chat-header-call-button-menu__item',\n\t\t\thtml: this.#getUserPhoneHtml(title, phones.workPhone),\n\t\t\tonclick: () => {\n\t\t\t\tMessenger.startPhoneCall(phones.workPhone);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getInnerPhoneItem(): ?MenuItem\n\t{\n\t\tif (!this.#isUser())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { phones } = this.#getUser();\n\t\tif (!phones.innerPhone)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst title = Loc.getMessage('CALL_CONTENT_CHAT_HEADER_CALL_MENU_INNER_PHONE_MSGVER_1');\n\n\t\treturn {\n\t\t\tclassName: 'menu-popup-no-icon bx-call-chat-header-call-button-menu__item',\n\t\t\thtml: this.#getUserPhoneHtml(title, phones.innerPhone),\n\t\t\tonclick: () => {\n\t\t\t\tMessenger.startPhoneCall(phones.innerPhone);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getZoomItem(): ?MenuItem\n\t{\n\t\tconst isActive = FeatureManager.isFeatureAvailable(Feature.zoomActive);\n\t\tif (!isActive)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst classNames = ['bx-call-chat-header-call-button-menu__zoom', 'menu-popup-no-icon'];\n\t\tconst isFeatureAvailable = FeatureManager.isFeatureAvailable(Feature.zoomAvailable);\n\t\tif (!isFeatureAvailable)\n\t\t{\n\t\t\tclassNames.push('--disabled');\n\t\t}\n\n\t\treturn {\n\t\t\tclassName: classNames.join(' '),\n\t\t\ttext: Loc.getMessage('CALL_CONTENT_CHAT_HEADER_CALL_MENU_ZOOM'),\n\t\t\tonclick: () => {\n\t\t\t\tif (!isFeatureAvailable)\n\t\t\t\t{\n\t\t\t\t\tBX.UI.InfoHelper.show('limit_video_conference_zoom');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.#requestCreateZoomConference(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getUserPhoneHtml(title, phoneNumber): HTMLSpanElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<span class=\"bx-call-chat-header-call-button-menu__phone_container\">\n\t\t\t\t<span class=\"bx-call-chat-header-call-button-menu__phone_title\">${title}</span>\n\t\t\t\t<span class=\"bx-call-chat-header-call-button-menu__phone_number\">${phoneNumber}</span>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\t#isCallAvailable(dialogId: String): boolean\n\t{\n\t\tif (CallManager.getInstance().hasActiveCurrentCall(dialogId))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (CallManager.getInstance().hasActiveAnotherCall())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst chatCanBeCalled = CallManager.getInstance().chatCanBeCalled(dialogId);\n\t\tconst chatIsAllowedToCall = PermissionManager.getInstance().canPerformActionByRole(ActionByRole.call, dialogId);\n\n\t\treturn chatCanBeCalled && chatIsAllowedToCall;\n\t}\n\n\t#getUser(): ?ImModelUser\n\t{\n\t\tif (!this.#isUser())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Core.getStore().getters['users/get'](this.context.dialogId);\n\t}\n\n\t#isUser(): true\n\t{\n\t\treturn this.context.type === ChatType.user;\n\t}\n\n\t#requestCreateZoomConference(dialogId: string)\n\t{\n\t\trunAction(RestMethod.imV2CallZoomCreate, { data: { dialogId } })\n\t\t\t.catch((errors) => {\n\t\t\t\tlet errorText = Loc.getMessage('CALL_CONTENT_CHAT_HEADER_CALL_MENU_ZOOM_CREATE_ERROR');\n\n\t\t\t\tconst notConnected = errors.some((error) => error.code === 'ZOOM_CONNECTED_ERROR');\n\t\t\t\tif (notConnected)\n\t\t\t\t{\n\t\t\t\t\tconst userProfileUri = `/company/personal/user/${Core.getUserId()}/social_services/`;\n\t\t\t\t\terrorText = Loc.getMessage('CALL_CONTENT_CHAT_HEADER_CALL_MENU_ZOOM_CONNECT_ERROR')\n\t\t\t\t\t\t.replace('#HREF_START#', `<a href=${userProfileUri}>`)\n\t\t\t\t\t\t.replace('#HREF_END#', '</>');\n\t\t\t\t}\n\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: errorText,\n\t\t\t\t});\n\t\t\t});\n\t}\n}\n","// @vue/component\nexport const CallButtonTitle = {\n\tname: 'CallButtonTitle',\n\tprops:\n\t{\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tcompactMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tcopilotMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tcallButtonIconClasses(): Array<String>\n\t\t{\n\t\t\treturn [\n\t\t\t\t'bx-call-chat-header-call-button__icon',\n\t\t\t\t...(this.copilotMode ? ['--copilot'] : []),\n\t\t\t\t...(this.compactMode ? ['--compact'] : []),\n\t\t\t];\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"callButtonIconClasses\"></div>\n\t\t<div v-if=\"!compactMode\" class=\"bx-call-chat-header-call-button__text\">\n\t\t\t{{ text }}\n\t\t</div>\n\t`,\n};\n","import { CallPopupContainer } from 'call.component.elements';\nimport { Loc, Dom } from 'main.core';\nimport { Util, CallAI } from 'call.core';\n\nimport type { PopupOptions } from 'main.popup';\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const CallButtonPromo = {\n\tname: 'CallButtonPromo',\n\tcomponents: { CallPopupContainer },\n\temits: ['close'],\n\tprops:\n\t{\n\t\tbindElement: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisAIConcertAccepted: CallAI.agreementAccepted,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tgetId()\n\t\t{\n\t\t\treturn 'call-ai-user-list-popup';\n\t\t},\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 380,\n\t\t\t\tpadding: 0,\n\t\t\t\toverlay: false,\n\t\t\t\tautoHide: false,\n\t\t\t\tcloseByEsc: false,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: Dom.getPosition(this.bindElement).width / 2,\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tcloseIcon: true,\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\toffsetTop: 28,\n\t\t\t};\n\t\t},\n\t\tcallButtonPromoText(): string\n\t\t{\n\t\t\treturn this.isAIConcertAccepted\n\t\t\t\t? this.loc('CALL_CHAT_HEADER_BUTTON_PROMO_TEXT')\n\t\t\t\t: this.loc('CALL_CHAT_HEADER_BUTTON_PROMO_TEXT_WITHOUT_TOS')\n\t\t\t;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<CallPopupContainer\n\t\t\t:config=\"config\"\n\t\t\t@close=\"$emit('close')\"\n\t\t\t:id=\"getId\"\n\t\t>\n\t\t\t<div class='bx-call-chat-header-call-button__promo-container'>\n                <div class='bx-call-chat-header-call-button__promo-title'>\n                    {{ loc('CALL_CHAT_HEADER_BUTTON_PROMO_TITLE') }}\n                </div>\n                <div class='bx-call-chat-header-call-button__promo-text'>\n                    {{ callButtonPromoText }}\n                </div>\n\t\t\t</div>\n\t\t</CallPopupContainer>\n\t`,\n};\n","import './pulse-animation.css';\n\nconst RING_COUNT = 3;\n\n// @vue/component\nexport const PulseAnimation = {\n\tname: 'PulseAnimation',\n\tprops:\n\t{\n\t\tshowPulse: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tisConference: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\trings(): number[]\n\t\t{\n\t\t\tif (!this.showPulse)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn Array.from({ length: RING_COUNT });\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-call-pulse-animation__container\">\n\t\t\t<slot />\n\t\t\t<div v-for=\"ring in rings\" class=\"bx-call-pulse-animation__ring\" :class=\"{'--conference': isConference}\"></div>\n\t\t</div>\n\t`,\n};\n","import { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Loc } from 'main.core';\n\nimport { Messenger } from 'im.public';\nimport { LocalStorageKey, ChatType } from 'im.v2.const';\nimport { CallManager } from 'im.v2.lib.call';\nimport { LocalStorageManager } from 'im.v2.lib.local-storage';\nimport { PromoManager } from 'im.v2.lib.promo';\nimport { Analytics } from 'call.lib.analytics';\nimport { Util, CallAI } from 'call.core';\n\nimport { CallMenu } from './classes/call-menu';\nimport { CallTypes } from 'call.const';\nimport { CallButtonTitle } from './components/call-button-title';\nimport { CallButtonPromo } from './components/call-button-promo';\nimport { PulseAnimation } from './components/pulse-animation/pulse-animation';\n\nimport { hint } from 'ui.vue3.directives.hint';\n\nimport './css/call-button.css';\n\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const CallButton = {\n\tdirectives: { hint },\n\tcomponents: { CallButtonTitle, CallButtonPromo, PulseAnimation },\n\tprops:\n\t{\n\t\tdialog: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcompactMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tlastCallType: '',\n\t\t\tcopilotMinUserLimit: CallAI.recordingMinUsers,\n\t\t\tisCopilotActive: CallAI.serviceEnabled,\n\t\t\tisTariffAvailable: CallAI.tariffAvailable,\n\t\t\tshowPromo: false,\n\t\t\tshowPromoTimer: null,\n\t\t\tpromoId: 'call:copilot-call-button:29102024:all',\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialogId(): string\n\t\t{\n\t\t\treturn this.dialog.dialogId;\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tuserCount(): number\n\t\t{\n\t\t\treturn this.dialog.userCounter;\n\t\t},\n\t\tisConference(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === ChatType.videoconf;\n\t\t},\n\t\tcallButtonText(): string\n\t\t{\n\t\t\tconst locCode = CallTypes[this.lastCallType].locCode;\n\n\t\t\treturn this.loc(locCode);\n\t\t},\n\t\thasActiveCurrentCall(): boolean\n\t\t{\n\t\t\treturn CallManager.getInstance().hasActiveCurrentCall(this.dialogId);\n\t\t},\n\t\thasActiveAnotherCall(): boolean\n\t\t{\n\t\t\treturn CallManager.getInstance().hasActiveAnotherCall(this.dialogId);\n\t\t},\n\t\tisActive(): boolean\n\t\t{\n\t\t\tif (this.hasActiveCurrentCall)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.hasActiveAnotherCall)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn CallManager.getInstance().chatCanBeCalled(this.dialogId);\n\t\t},\n\t\tuserLimit(): number\n\t\t{\n\t\t\treturn CallManager.getInstance().getCallUserLimit();\n\t\t},\n\t\tisChatUserLimitExceeded(): boolean\n\t\t{\n\t\t\treturn CallManager.getInstance().isChatUserLimitExceeded(this.dialogId);\n\t\t},\n\t\tshouldShowMenu(): boolean\n\t\t{\n\t\t\treturn this.isActive;\n\t\t},\n\t\thintContent(): Object | null\n\t\t{\n\t\t\tif (!this.isChatUserLimitExceeded)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.loc('IM_LIB_CALL_USER_LIMIT_EXCEEDED_TOOLTIP', { '#USER_LIMIT#': this.userLimit }),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\t},\n\t\t\t\t\tangle: { position: 'top' },\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetLeft: 63,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tisCopilotCall(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.isCopilotActive\n\t\t\t\t&& this.userCount >= this.copilotMinUserLimit\n\t\t\t\t&& !this.isConference\n\t\t\t\t&& this.isTariffAvailable\n\t\t\t);\n\t\t},\n\t\tcallButtonContainerClasses(): Array<String>\n\t\t{\n\t\t\treturn [\n\t\t\t\t'bx-call-chat-header-call-button__scope',\n\t\t\t\t'bx-call-chat-header-call-button__container',\n\t\t\t\t...(this.isConference ? ['--conference'] : []),\n\t\t\t\t...(this.isCopilotCall ? ['--copilot'] : []),\n\t\t\t\t...(!this.isActive ? ['--disabled'] : []),\n\t\t\t];\n\t\t},\n\t\tcanShowPromo(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.isCopilotCall\n\t\t\t\t&& PromoManager.getInstance().needToShow(this.promoId)\n\t\t\t\t&& !this.hasActiveCurrentCall\n\t\t\t\t&& this.isActive\n\t\t\t);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.lastCallType = this.getLastCallChoice();\n\t\tthis.subscribeToMenuItemClick();\n\t\tEventEmitter.subscribe('BX.Call.View:onShow', this.onShowCallView);\n\t},\n\tmounted()\n\t{\n\t\tthis.showPromoTimer = setTimeout(() => {\n\t\t\tthis.showPromo = this.canShowPromo;\n\t\t}, 20000);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.clearShowPromoTimer();\n\t\tthis.showPromo = false;\n\t\tEventEmitter.unsubscribe('BX.Call.View:onShow', this.onShowCallView);\n\t},\n\tmethods:\n\t{\n\t\tstartVideoCall()\n\t\t{\n\t\t\tif (!this.isActive)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tMessenger.startVideoCall(this.dialogId);\n\t\t},\n\t\tsubscribeToMenuItemClick()\n\t\t{\n\t\t\tthis.getCallMenu().subscribe(\n\t\t\t\tCallMenu.events.onMenuItemClick,\n\t\t\t\t(event: BaseEvent<{id: string}>) => {\n\t\t\t\t\tconst { id: callTypeId } = event.getData();\n\t\t\t\t\tthis.saveLastCallChoice(callTypeId);\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tonShowCallView()\n\t\t{\n\t\t\tthis.onClosePromo();\n\t\t},\n\t\tonButtonClick()\n\t\t{\n\t\t\tif (!this.isActive)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isCopilotCall)\n\t\t\t{\n\t\t\t\tthis.onClosePromo();\n\t\t\t}\n\n\t\t\tAnalytics.getInstance().onChatHeaderStartCallClick({\n\t\t\t\tdialog: this.dialog,\n\t\t\t\tcallType: this.lastCallType,\n\t\t\t});\n\n\t\t\tCallTypes[this.lastCallType].start(this.dialogId);\n\t\t},\n\t\tonMenuClick()\n\t\t{\n\t\t\tif (!this.shouldShowMenu)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.getCallMenu().openMenu(this.dialog, this.$refs.menu);\n\t\t},\n\t\tonStartConferenceClick()\n\t\t{\n\t\t\tif (!this.isActive)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isCopilotCall)\n\t\t\t{\n\t\t\t\tthis.onClosePromo();\n\t\t\t}\n\n\t\t\tAnalytics.getInstance().onStartConferenceClick({ chatId: this.chatId });\n\n\t\t\tMessenger.openConference({ code: this.dialog.public.code });\n\t\t},\n\t\tgetLastCallChoice(): string\n\t\t{\n\t\t\treturn LocalStorageManager.getInstance().get(LocalStorageKey.lastCallType, CallTypes.video.id);\n\t\t},\n\t\tsaveLastCallChoice(callTypeId: string)\n\t\t{\n\t\t\tthis.lastCallType = callTypeId;\n\t\t\tLocalStorageManager.getInstance().set(LocalStorageKey.lastCallType, callTypeId);\n\t\t},\n\t\tgetCallMenu(): CallMenu\n\t\t{\n\t\t\tif (!this.callMenu)\n\t\t\t{\n\t\t\t\tthis.callMenu = new CallMenu();\n\t\t\t}\n\n\t\t\treturn this.callMenu;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonClosePromo()\n\t\t{\n\t\t\tthis.clearShowPromoTimer();\n\t\t\tthis.showPromo = false;\n\t\t\tPromoManager.getInstance().markAsWatched(this.promoId);\n\t\t},\n\t\tclearShowPromoTimer()\n\t\t{\n\t\t\tclearTimeout(this.showPromoTimer);\n\t\t\tthis.showPromoTimer = null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<PulseAnimation :showPulse=\"showPromo\" :isConference=\"isConference\">\n\t\t\t<div\n\t\t\t\tv-if=\"isConference\"\n\t\t\t\t:class=\"callButtonContainerClasses\"\n\t\t\t\t@click=\"onStartConferenceClick\"\n\t\t\t\tref=\"call-button\"\n\t\t\t>\n\t\t\t\t<CallButtonTitle :compactMode=\"compactMode\" :copilotMode=\"isCopilotCall\" :text=\"loc('IM_CONTENT_CHAT_HEADER_START_CONFERENCE')\" />\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-else\n\t\t\t\t:class=\"callButtonContainerClasses\"\n\t\t\t\tv-hint=\"hintContent\"\n\t\t\t\t@click=\"onButtonClick\"\n\t\t\t\tref=\"call-button\"\n\t\t\t>\n\t\t\t\t<CallButtonTitle :compactMode=\"compactMode\" :copilotMode=\"isCopilotCall\" :text=\"callButtonText\" />\n\t\t\t\t<div class=\"bx-call-chat-header-call-button__separator\"></div>\n\t\t\t\t<div class=\"bx-call-chat-header-call-button__chevron_container\" @click.stop=\"onMenuClick\">\n\t\t\t\t\t<div class=\"bx-call-chat-header-call-button__chevron\" ref=\"menu\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<CallButtonPromo\n\t\t\t\tv-if=\"showPromo\"\n\t\t\t\t:bindElement=\"$refs['call-button']\"\n\t\t\t\t@close=\"onClosePromo\"\n\t\t\t/>\n\t\t</PulseAnimation>\n\t`,\n};\n"],"names":["CallMenu","BaseMenu","constructor","id","getMenuOptions","className","getMenuClassName","angle","offsetLeft","offsetTop","getMenuItems","delimiter","isAvailable","context","dialogId","text","Loc","getMessage","onclick","CallTypes","video","start","emit","events","onMenuItemClick","menuInstance","close","disabled","audio","callType","Analytics","getInstance","onContextMenuStartCallClick","phones","personalMobile","title","html","Messenger","startPhoneCall","workPhone","innerPhone","isActive","FeatureManager","isFeatureAvailable","Feature","zoomActive","classNames","zoomAvailable","push","join","BX","UI","InfoHelper","show","phoneNumber","Tag","render","CallManager","hasActiveCurrentCall","hasActiveAnotherCall","chatCanBeCalled","chatIsAllowedToCall","PermissionManager","canPerformActionByRole","ActionByRole","call","Core","getStore","getters","type","ChatType","user","runAction","RestMethod","imV2CallZoomCreate","data","catch","errors","errorText","notConnected","some","error","code","userProfileUri","getUserId","replace","Notification","Center","notify","content","CallButtonTitle","name","props","String","required","compactMode","Boolean","default","copilotMode","computed","callButtonIconClasses","template","CallButtonPromo","components","CallPopupContainer","emits","bindElement","Object","isAIConcertAccepted","CallAI","agreementAccepted","getId","config","width","padding","overlay","autoHide","closeByEsc","offset","Dom","getPosition","position","closeIcon","callButtonPromoText","loc","methods","phraseCode","replacements","RING_COUNT","PulseAnimation","showPulse","isConference","rings","Array","from","length","CallButton","directives","hint","dialog","lastCallType","copilotMinUserLimit","recordingMinUsers","isCopilotActive","serviceEnabled","isTariffAvailable","tariffAvailable","showPromo","showPromoTimer","promoId","chatId","userCount","userCounter","videoconf","callButtonText","locCode","userLimit","getCallUserLimit","isChatUserLimitExceeded","shouldShowMenu","hintContent","popupOptions","bindOptions","targetContainer","document","body","isCopilotCall","callButtonContainerClasses","canShowPromo","PromoManager","needToShow","created","getLastCallChoice","subscribeToMenuItemClick","EventEmitter","subscribe","onShowCallView","mounted","setTimeout","beforeUnmount","clearShowPromoTimer","unsubscribe","startVideoCall","getCallMenu","event","callTypeId","getData","saveLastCallChoice","onClosePromo","onButtonClick","onChatHeaderStartCallClick","onMenuClick","openMenu","$refs","menu","onStartConferenceClick","openConference","public","LocalStorageManager","get","LocalStorageKey","set","callMenu","markAsWatched","clearTimeout"],"mappings":"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"}