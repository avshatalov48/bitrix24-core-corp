{"version":3,"file":"script.js","sources":["src/util.js","src/favorites.js","src/subscription.js","src/themepicker.js","src/avatar.js","src/card.js"],"sourcesContent":["import {Loc, Tag} from 'main.core';\nimport {Popup} from 'main.popup';\n\nclass WorkgroupCardUtil\n{\n\tstatic processAJAXError(errorCode)\n\t{\n\t\tif (errorCode.indexOf('SESSION_ERROR', 0) === 0)\n\t\t{\n\t\t\tthis.showError(Loc.getMessage('SGMErrorSessionWrong'));\n\t\t}\n\t\telse if (errorCode.indexOf('CURRENT_USER_NOT_AUTH', 0) === 0)\n\t\t{\n\t\t\tthis.showError(Loc.getMessage('SGMErrorCurrentUserNotAuthorized'));\n\t\t}\n\t\telse if (errorCode.indexOf('SONET_MODULE_NOT_INSTALLED', 0) === 0)\n\t\t{\n\t\t\tthis.showError(Loc.getMessage('SGMErrorModuleNotInstalled'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showError(errorCode);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic showError(errorText)\n\t{\n\t\t(new Popup(`sgm-error${Math.random()}`, null, {\n\t\t\tautoHide: true,\n\t\t\tlightShadow: false,\n\t\t\tzIndex: 2,\n\t\t\tcontent: Tag.render`<div class=\"sonet-sgm-error-text-block\">${errorText}</div>`,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: true,\n\t\t})).show();\n\t}\n}\n\nexport {\n\tWorkgroupCardUtil,\n}","import {Type} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Common, SonetGroupMenu} from 'socialnetwork.common';\n\nimport {WorkgroupCardUtil} from './util';\n\nclass WorkgroupCardFavorites\n{\n\tconstructor(params)\n\t{\n\t\tthis.value = !!params.value;\n\t\tthis.containerNode = params.containerNode;\n\t\tthis.groupId = parseInt(params.groupId);\n\n\t\tif (this.containerNode)\n\t\t{\n\t\t\tEventEmitter.subscribe('BX.Socialnetwork.WorkgroupMenu:onSetFavorites', (event: BaseEvent) => {\n\t\t\t\tconst [ params ] = event.getCompatData();\n\n\t\t\t\tthis.setValue(params.value);\n\t\t\t});\n\t\t}\n\t}\n\n\tsetValue(value)\n\t{\n\t\tthis.value = value;\n\t}\n\n\tgetValue()\n\t{\n\t\treturn this.value;\n\t}\n\n\tset(event)\n\t{\n\t\tconst currentValue = this.getValue();\n\t\tconst newValue = !currentValue;\n\t\tconst sonetGroupMenu = SonetGroupMenu.getInstance();\n\n\t\tthis.setValue(newValue);\n\n\t\tsonetGroupMenu.favoritesValue = newValue;\n\t\tsonetGroupMenu.setItemTitle(newValue);\n\n\t\tCommon.setFavoritesAjax({\n\t\t\tgroupId: this.groupId,\n\t\t\tfavoritesValue: currentValue,\n\t\t\tcallback: {\n\t\t\t\tsuccess: (data) => {\n\n\t\t\t\t\tconst eventData = {\n\t\t\t\t\t\tcode: 'afterSetFavorites',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tgroupId: data.ID,\n\t\t\t\t\t\t\tvalue: (data.RESULT == 'Y'),\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\twindow.top.BX.SidePanel.Instance.postMessageAll(window, 'sonetGroupEvent', eventData);\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tType.isStringFilled(data.NAME)\n\t\t\t\t\t\t&& Type.isStringFilled(data.URL)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tEventEmitter.emit('BX.Socialnetwork.WorkgroupFavorites:onSet', new BaseEvent({\n\t\t\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\t\t\tid: this.groupId,\n\t\t\t\t\t\t\t\tname: data.NAME,\n\t\t\t\t\t\t\t\turl: data.URL,\n\t\t\t\t\t\t\t\textranet: (Type.isStringFilled(data.EXTRANET) ? data.EXTRANET : 'N'),\n\t\t\t\t\t\t\t}, newValue],\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfailure: (data) => {\n\n\t\t\t\t\tthis.setValue(currentValue);\n\t\t\t\t\tsonetGroupMenu.favoritesValue = currentValue;\n\t\t\t\t\tsonetGroupMenu.setItemTitle(currentValue);\n\n\t\t\t\t\tif (Type.isStringFilled(data.ERROR))\n\t\t\t\t\t{\n\t\t\t\t\t\tWorkgroupCardUtil.processAJAXError(data.ERROR);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tevent.preventDefault();\n\t}\n}\n\nexport {\n\tWorkgroupCardFavorites,\n}","import {ajax, Loc, Tag, Type} from 'main.core';\nimport {Popup} from 'main.popup';\n\nimport {WorkgroupCardUtil} from './util';\n\nclass WorkgroupCardSubscription\n{\n\tconstructor(params)\n\t{\n\t\tthis.groupId = parseInt(params.groupId);\n\t\tthis.buttonNode = params.buttonNode;\n\t\tthis.notifyHintTimeout = null;\n\t\tthis.notifyHintPopup = null;\n\t\tthis.notifyHintTime = 3000;\n\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tthis.buttonNode.addEventListener('click', () => {\n\t\t\t\tthis.set();\n\t\t\t}, true);\n\t\t}\n\t}\n\n\tset()\n\t{\n\t\tconst action = (!this.buttonNode.classList.contains('ui-btn-active') ? 'set' : 'unset');\n\t\tthis.switch(this.buttonNode, (action === 'set'));\n\n\t\tajax.runAction('socialnetwork.api.workgroup.setSubscription', {\n\t\t\tdata: {\n\t\t\t\tparams: {\n\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\tvalue: (action === 'set' ? 'Y' : 'N'),\n\t\t\t\t}\n\t\t\t},\n\t\t}).then((data) => {\n\t\t\tconst eventData = {\n\t\t\t\tcode: 'afterSetSubscribe',\n\t\t\t\tdata: {\n\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\tvalue: (data.RESULT == 'Y'),\n\t\t\t\t}\n\t\t\t};\n\t\t\twindow.top.BX.SidePanel.Instance.postMessageAll(window, 'sonetGroupEvent', eventData);\n\t\t}).catch((response) => {\n\t\t\tthis.switch(this.buttonNode, !(action === 'set'));\n\t\t\tWorkgroupCardUtil.processAJAXError(response.errors[0].message);\n\t\t});\n\t}\n\n\tswitch(node, active)\n\t{\n\t\tif (!Type.isDomNode(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!!active)\n\t\t{\n\t\t\tnode.classList.add('ui-btn-active');\n\t\t\tnode.classList.remove('ui-btn-icon-unfollow');\n\t\t\tnode.classList.add('ui-btn-icon-follow');\n\n\t\t\tthis.showNotifyHint(node, Loc.getMessage('SGCSSubscribeButtonHintOn'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.classList.remove('ui-btn-active');\n\t\t\tnode.classList.add('ui-btn-icon-unfollow');\n\t\t\tnode.classList.remove('ui-btn-icon-follow');\n\n\t\t\tthis.showNotifyHint(node, Loc.getMessage('SGCSSubscribeButtonHintOff'));\n\t\t}\n\t}\n\n\tshowNotifyHint(node, hintText)\n\t{\n\t\tif (this.notifyHintTimeout)\n\t\t{\n\t\t\tclearTimeout(this.notifyHintTimeout);\n\t\t\tthis.notifyHintTimeout = null;\n\t\t}\n\n\t\tif (Type.isNull(this.notifyHintPopup))\n\t\t{\n\t\t\tthis.notifyHintPopup = new Popup('sgm_notify_hint', node, {\n\t\t\t\tautoHide: true,\n\t\t\t\tlightShadow: true,\n\t\t\t\tzIndex: 2,\n\t\t\t\tcontent: Tag.render`<div class=\"sonet-sgm-notify-hint-content\" style=\"display: none;\"><span id=\"sgm_notify_hint_text\">${hintText}</span></div>`,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tcloseIcon: false,\n\t\t\t\toffsetLeft: 21,\n\t\t\t\toffsetTop: 2,\n\t\t\t});\n\n\t\t\tthis.notifyHintPopup.TEXT = document.getElementById('sgm_notify_hint_text');\n\t\t\tthis.notifyHintPopup.setBindElement(node);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.notifyHintPopup.TEXT.innerHTML = hintText;\n\t\t\tthis.notifyHintPopup.setBindElement(node);\n\t\t}\n\n\t\tthis.notifyHintPopup.setAngle({});\n\t\tthis.notifyHintPopup.show();\n\n\t\tthis.notifyHintTimeout = setTimeout(() => {\n\t\t\tthis.notifyHintPopup.close();\n\t\t}, this.notifyHintTime);\n\t}\n}\n\nexport {\n\tWorkgroupCardSubscription,\n}\n","import {Type} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\n\nclass WorkgroupCardThemePicker\n{\n\tconstructor(params)\n\t{\n\t\tthis.containerNode = params.containerNode;\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tif (!this.containerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst themePickerInstance = BX.Intranet.Bitrix24.ThemePicker.Singleton;\n\t\tconst themePickerNode = this.containerNode.querySelector('.socialnetwork-group-slider-theme-btn');\n\n\t\tif (themePickerNode)\n\t\t{\n\t\t\tthemePickerNode.addEventListener('click', () => {\n\t\t\t\tthemePickerInstance.showDialog(true);\n\t\t\t});\n\t\t}\n\n\t\tEventEmitter.subscribe('Intranet.ThemePicker:onSave', (event: BaseEvent) => {\n\t\t\tconst [ data ] = event.getData();\n\n\t\t\tif (\n\t\t\t\t!Type.isPlainObject(data.theme)\n\t\t\t\t|| window === top.window\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthemePickerInstance.applyTheme(data.theme.id);\n\t\t\tthemePickerInstance.saveTheme(data.theme.id);\n\n\t\t\tthis.draw(data.theme);\n\t\t});\n\n\t}\n\n\tdraw(theme)\n\t{\n\t\tconst themeBoxNode = this.containerNode.querySelector('.socialnetwork-group-slider-theme-box');\n\t\tif (!themeBoxNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthemeBoxNode.style.backgroundImage = (Type.isStringFilled(theme.previewImage) ? `url('${theme.previewImage}')` : 'none');\n\t\tthemeBoxNode.style.backgroundColor = (Type.isStringFilled(theme.previewColor) ? theme.previewColor : 'transparent');\n\t}\n}\n\nexport {\n\tWorkgroupCardThemePicker,\n}","import {Type, Dom, ajax} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nclass WorkgroupCardAvatar\n{\n\tconstructor(params)\n\t{\n\t\tthis.componentName = (params.componentName ?? '');\n\t\tthis.signedParameters = (params.signedParameters ?? '');\n\n\t\tthis.containerNode = params.containerNode;\n\t\tthis.groupId = parseInt(params.groupId);\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tif (!this.containerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst avatarEditor = new BX.AvatarEditor({\n\t\t\tenableCamera: false,\n\t\t});\n\n\t\tconst editButtonNode = this.containerNode.querySelector('.socialnetwork-group-slider-group-logo-btn');\n\t\tif (!editButtonNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\teditButtonNode.addEventListener('click', () => {\n\t\t\tavatarEditor.show('file');\n\t\t});\n\n\t\tEventEmitter.subscribe(avatarEditor, 'onApply', (event: BaseEvent) => {\n\t\t\tconst [ file ] = event.getCompatData();\n\n\t\t\tconst formData = new FormData();\n\t\t\tif (!file.name)\n\t\t\t{\n\t\t\t\tfile.name = 'tmp.png';\n\t\t\t}\n\t\t\tformData.append('newPhoto', file, file.name);\n\n\t\t\tthis.changePhoto(formData);\n\t\t});\n\t}\n\n\tchangePhoto(formData)\n\t{\n\t\tif (this.componentName === '')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet loader = null;\n\t\tconst boxNode = this.containerNode.querySelector('.socialnetwork-group-slider-group-logo-box');\n\n\t\tif (boxNode)\n\t\t{\n\t\t\tloader = this.showLoader({\n\t\t\t\tnode: boxNode,\n\t\t\t\tloader: null,\n\t\t\t\tsize: 50,\n\t\t\t});\n\t\t}\n\n\t\tajax.runComponentAction(this.componentName, 'loadPhoto', {\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tmode: 'ajax',\n\t\t\tdata: formData,\n\t\t}).then((response) => {\n\n\t\t\tif (Type.isPlainObject(response.data))\n\t\t\t{\n\t\t\t\tif (!boxNode)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst avatarNode = boxNode.querySelector('i');\n\t\t\t\tif (!avatarNode)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tboxNode.className = 'sonet-common-workgroup-avatar socialnetwork-group-slider-group-logo-box';\n\t\t\t\tif (Type.isStringFilled(response.data.imageSrc))\n\t\t\t\t{\n\t\t\t\t\tboxNode.className += ' ui-icon ui-icon-common-user-group';\n\t\t\t\t\tavatarNode.style = `background: url('${encodeURI(response.data.imageSrc)}') no-repeat center center; background-size: cover;`;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tavatarNode.style = 'background: none;';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.hideLoader({\n\t\t\t\tloader: loader,\n\t\t\t});\n\t\t}, (response) => {\n\t\t\tthis.hideLoader({\n\t\t\t\tloader: loader,\n\t\t\t});\n//\t\t\tthis.showErrorPopup(response[\"errors\"][0].message);\n\t\t});\n\t}\n\n\tshowLoader(params)\n\t{\n\t\tlet loader = null;\n\n\t\tif (Type.isDomNode(params.node))\n\t\t{\n\t\t\tif (params.loader === null)\n\t\t\t{\n\t\t\t\tloader = new Loader({\n\t\t\t\t\ttarget: params.node,\n\t\t\t\t\tsize: !Type.isUndefined(params.size) ? Number(params.size) : 40,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tloader = params.loader;\n\t\t\t}\n\n\t\t\tloader.show();\n\t\t}\n\n\t\treturn loader;\n\t}\n\n\thideLoader(params)\n\t{\n\t\tif (params.loader !== null)\n\t\t{\n\t\t\tparams.loader.hide();\n\t\t}\n\n\t\tif (params.loader !== null)\n\t\t{\n\t\t\tparams.loader = null;\n\t\t}\n\t}\n}\n\nexport {\n\tWorkgroupCardAvatar,\n}","import {Type, Loc} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Circle} from 'ui.graph.circle';\n\nimport {WorkgroupCardFavorites} from './favorites';\nimport {WorkgroupCardSubscription} from './subscription';\nimport {WorkgroupCardThemePicker} from './themepicker';\nimport {WorkgroupCardAvatar} from './avatar';\n\nclass WorkgroupCard\n{\n\tconstructor()\n\t{\n\t\tthis.componentName = '';\n\t\tthis.signedParameters = '';\n\n\t\tthis.instance = null;\n\t\tthis.currentUserId = null;\n\n\t\tthis.userRole = null;\n\t\tthis.initiatedByType = null;\n\t\tthis.initiatedByUserId = null;\n\t\tthis.userIsMember = null;\n\t\tthis.userIsAutoMember = null;\n\t\tthis.userIsScrumMaster = null;\n\n\t\tthis.canInitiate = null;\n\t\tthis.canModify = null;\n\t\tthis.canLeave = null;\n\n\t\tthis.groupId = null;\n\t\tthis.isProject = null;\n\t\tthis.isScrumProject = null;\n\t\tthis.styles = null;\n\t\tthis.urls = null;\n\t\tthis.containerNode = null;\n\t\tthis.menuButtonNode = null;\n\t\tthis.editFeaturesAllowed = true;\n\t\tthis.copyFeatureAllowed = true;\n\n\t\tthis.favoritesInstance = null;\n\t}\n\n\tinit(params)\n\t{\n\t\tif (\n\t\t\tType.isUndefined(params)\n\t\t\t|| Type.isUndefined(params.groupId)\n\t\t\t|| parseInt(params.groupId) <= 0\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.componentName = (params.componentName ?? '');\n\t\tthis.signedParameters = (params.signedParameters ?? '');\n\t\tthis.currentUserId = parseInt(params.currentUserId);\n\n\t\tthis.groupId = parseInt(params.groupId);\n\t\tthis.groupType = params.groupType;\n\t\tthis.isProject = !!params.isProject;\n\t\tthis.isScrumProject = !!params.isScrumProject;\n\t\tthis.isOpened = !!params.isOpened;\n\n\t\tthis.userRole = params.userRole;\n\t\tthis.initiatedByType = params.initiatedByType;\n\t\tthis.initiatedByUserId = parseInt(params.initiatedByUserId);\n\t\tthis.userIsMember = !!params.userIsMember;\n\t\tthis.userIsAutoMember = !!params.userIsAutoMember;\n\t\tthis.userIsScrumMaster = this.isScrumProject && (Type.isBoolean(params.userIsScrumMaster) ? params.userIsScrumMaster : false);\n\n\t\tthis.canInitiate = !!params.canInitiate;\n\t\tthis.canProcessRequestsIn = !!params.canProcessRequestsIn;\n\t\tthis.canModify = !!params.canModify;\n\t\tthis.canLeave = (\n\t\t\tType.isBoolean(params.canLeave)\n\t\t\t\t? params.canLeave\n\t\t\t\t: (\n\t\t\t\t\tthis.userIsMember\n\t\t\t\t\t&& this.userRole !== 'A'\n\t\t\t\t\t&& !this.userIsAutoMember\n\t\t\t\t\t&& !this.userIsScrumMaster\n\t\t\t\t)\n\t\t);\n\n\t\tthis.containerNode = (Type.isStringFilled(params.containerNodeId) ? document.getElementById(params.containerNodeId) : null);\n\t\tthis.menuButtonNode = (Type.isStringFilled(params.menuButtonNodeId) ? document.getElementById(params.menuButtonNodeId) : null);\n\t\tthis.editFeaturesAllowed = (!Type.isUndefined(params.editFeaturesAllowed) ? !!params.editFeaturesAllowed : true);\n\t\tthis.copyFeatureAllowed = (!Type.isUndefined(params.copyFeatureAllowed) ? !!params.copyFeatureAllowed : true);\n\n\t\tthis.favoritesInstance = new WorkgroupCardFavorites({\n\t\t\tgroupId: this.groupId,\n\t\t\tvalue: !!params.favoritesValue,\n\t\t\tcontainerNode: this.containerNode,\n\t\t});\n\n\t\tthis.subscriptionInstance = new WorkgroupCardSubscription({\n\t\t\tgroupId: this.groupId,\n\t\t\tbuttonNode: (Type.isStringFilled(params.subscribeButtonNodeId) ? document.getElementById(params.subscribeButtonNodeId) : null),\n\t\t});\n\n\t\tnew WorkgroupCardThemePicker({\n\t\t\tcontainerNode: this.containerNode,\n\t\t});\n\n\t\tnew WorkgroupCardAvatar({\n\t\t\tcomponentName: this.componentName,\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tcontainerNode: this.containerNode,\n\t\t\tgroupId: this.groupId,\n\t\t});\n\n\t\tif (\n\t\t\tthis.containerNode\n\t\t\t&& Type.isPlainObject(params.styles)\n\t\t)\n\t\t{\n\t\t\tthis.styles = params.styles;\n\n\t\t\tif (\n\t\t\t\tType.isPlainObject(params.styles.tags)\n\t\t\t\t&& Type.isStringFilled(params.styles.tags.box)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.containerNode.querySelectorAll('[bx-tag-value]').forEach((node) => {\n\t\t\t\t\tnode.addEventListener('click', (e) => {\n\t\t\t\t\t\tconst tagValue = e.target.getAttribute('bx-tag-value');\n\t\t\t\t\t\tif (Type.isStringFilled(tagValue))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.clickTag(tagValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}, true);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tType.isPlainObject(params.tasksEfficiency)\n\t\t\t\t&& params.tasksEfficiency.available === true\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst circleNode = this.containerNode.querySelector('.socialnetwork-group-slider-efficency');\n\t\t\t\tif (circleNode)\n\t\t\t\t{\n\t\t\t\t\tconst circle = new Circle(circleNode, 131, Number(params.tasksEfficiency.value), null, null);\n\t\t\t\t\tcircle.show();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst efficiencyHelperNode = this.containerNode.querySelector('[data-role=\"efficiency-helper\"]');\n\t\t\tif (efficiencyHelperNode)\n\t\t\t{\n\t\t\t\tefficiencyHelperNode.addEventListener('click', () => {\n\t\t\t\t\ttop.BX.Helper.show('redirect=detail&code=6576263');\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isPlainObject(params.urls))\n\t\t{\n\t\t\tthis.urls = params.urls;\n\t\t}\n\n\t\tif (Type.isDomNode(this.menuButtonNode))\n\t\t{\n\t\t\tconst sonetGroupMenu = BX.SocialnetworkUICommon.SonetGroupMenu.getInstance();\n\t\t\tsonetGroupMenu.favoritesValue = this.favoritesInstance.getValue();\n\n\t\t\tthis.menuButtonNode.addEventListener('click', () => {\n\n\t\t\t\tBX.SocialnetworkUICommon.showGroupMenuPopup({\n\t\t\t\t\tbindElement: this.menuButtonNode,\n\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\tgroupType: this.groupType,\n\t\t\t\t\tuserIsMember: this.userIsMember,\n\t\t\t\t\tuserIsAutoMember: this.userIsAutoMember,\n\t\t\t\t\tuserIsScrumMaster: this.userIsScrumMaster,\n\t\t\t\t\tuserRole: this.userRole,\n\t\t\t\t\tinitiatedByType: this.initiatedByType,\n\t\t\t\t\tinitiatedByUserId: this.initiatedByUserId,\n\t\t\t\t\teditFeaturesAllowed: this.editFeaturesAllowed,\n\t\t\t\t\tcopyFeatureAllowed: this.copyFeatureAllowed,\n\t\t\t\t\tisProject: this.isProject,\n\t\t\t\t\tisScrumProject: this.isScrumProject,\n\t\t\t\t\tisOpened: this.isOpened,\n\t\t\t\t\tperms: {\n\t\t\t\t\t\tcanInitiate: this.canInitiate,\n\t\t\t\t\t\tcanProcessRequestsIn: this.canProcessRequestsIn,\n\t\t\t\t\t\tcanModify: this.canModify,\n\t\t\t\t\t\tcanLeave: this.canLeave,\n\t\t\t\t\t},\n\t\t\t\t\turls: {\n\t\t\t\t\t\trequestUser: Loc.getMessage('SGCSPathToRequestUser'),\n\t\t\t\t\t\tedit: Loc.getMessage('SGCSPathToEdit'),\n\t\t\t\t\t\tdelete: Loc.getMessage('SGCSPathToDelete'),\n\t\t\t\t\t\tfeatures: Loc.getMessage('SGCSPathToFeatures'),\n\t\t\t\t\t\tmembers: Loc.getMessage('SGCSPathToMembers'),\n\t\t\t\t\t\trequests: Loc.getMessage('SGCSPathToRequests'),\n\t\t\t\t\t\trequestsOut: Loc.getMessage('SGCSPathToRequestsOut'),\n\t\t\t\t\t\tuserRequestGroup: Loc.getMessage('SGCSPathToUserRequestGroup'),\n\t\t\t\t\t\tuserLeaveGroup: Loc.getMessage('SGCSPathToUserLeaveGroup'),\n\t\t\t\t\t\tcopy: Loc.getMessage('SGCSPathToCopy')\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}, true);\n\t\t}\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onSliderMessage.bind(this));\n\t}\n\n\tclickTag(tagValue)\n\t{\n\t\tif (!Type.isStringFilled(tagValue))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttop.location.href = Loc.getMessage('SGCSPathToGroupTag').replace('#tag#', tagValue);\n\t}\n\n\tonSliderMessage(event: BaseEvent)\n\t{\n\t\tconst [ sliderEvent ] = event.getCompatData();\n\n\t\tif (sliderEvent.getEventId() !== 'sonetGroupEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst eventData = sliderEvent.getData();\n\n\t\tif (\n\t\t\t!Type.isStringFilled(eventData.code)\n\t\t\t|| !Type.isPlainObject(eventData.data)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\teventData.code === 'afterJoinRequestSend'\n\t\t\t&& parseInt(eventData.data.groupId) === this.groupId\n\t\t)\n\t\t{\n\t\t\tBX.SocialnetworkUICommon.reload();\n\t\t}\n\t\telse if (\n\t\t\teventData.code === 'afterEdit'\n\t\t\t&& Type.isPlainObject(eventData.data.group)\n\t\t\t&& parseInt(eventData.data.group.ID) === this.groupId\n\t\t)\n\t\t{\n\t\t\tBX.SocialnetworkUICommon.reload();\n\t\t}\n\t\telse if (\n\t\t\t[ 'afterDelete', 'afterLeave', 'afterIncomingRequestCancel',  ].includes(eventData.code)\n\t\t\t&& !Type.isUndefined(eventData.data.groupId)\n\t\t\t&& parseInt(eventData.data.groupId) === this.groupId\n\t\t)\n\t\t{\n\t\t\tif (window !== top.window) // frame\n\t\t\t{\n\t\t\t\ttop.BX.SidePanel.Instance.getSliderByWindow(window).close();\n\t\t\t}\n\n\t\t\ttop.location.href = this.urls.groupsList;\n\t\t}\n\t}\n}\n\nexport {\n\tWorkgroupCard,\n}"],"names":["WorkgroupCardUtil","errorCode","indexOf","showError","Loc","getMessage","errorText","Popup","Math","random","autoHide","lightShadow","zIndex","content","Tag","render","closeByEsc","closeIcon","show","WorkgroupCardFavorites","params","value","containerNode","groupId","parseInt","EventEmitter","subscribe","event","getCompatData","setValue","currentValue","getValue","newValue","sonetGroupMenu","SonetGroupMenu","getInstance","favoritesValue","setItemTitle","Common","setFavoritesAjax","callback","success","data","eventData","code","ID","RESULT","window","top","BX","SidePanel","Instance","postMessageAll","Type","isStringFilled","NAME","URL","emit","BaseEvent","compatData","id","name","url","extranet","EXTRANET","failure","ERROR","processAJAXError","preventDefault","WorkgroupCardSubscription","buttonNode","notifyHintTimeout","notifyHintPopup","notifyHintTime","addEventListener","set","action","classList","contains","ajax","runAction","then","response","errors","message","node","active","isDomNode","add","remove","showNotifyHint","hintText","clearTimeout","isNull","offsetLeft","offsetTop","TEXT","document","getElementById","setBindElement","innerHTML","setAngle","setTimeout","close","WorkgroupCardThemePicker","init","themePickerInstance","Intranet","Bitrix24","ThemePicker","Singleton","themePickerNode","querySelector","showDialog","getData","isPlainObject","theme","applyTheme","saveTheme","draw","themeBoxNode","style","backgroundImage","previewImage","backgroundColor","previewColor","WorkgroupCardAvatar","componentName","signedParameters","avatarEditor","AvatarEditor","enableCamera","editButtonNode","file","formData","FormData","append","changePhoto","loader","boxNode","showLoader","size","runComponentAction","mode","avatarNode","className","imageSrc","encodeURI","hideLoader","Loader","target","isUndefined","Number","hide","WorkgroupCard","instance","currentUserId","userRole","initiatedByType","initiatedByUserId","userIsMember","userIsAutoMember","userIsScrumMaster","canInitiate","canModify","canLeave","isProject","isScrumProject","styles","urls","menuButtonNode","editFeaturesAllowed","copyFeatureAllowed","favoritesInstance","groupType","isOpened","isBoolean","canProcessRequestsIn","containerNodeId","menuButtonNodeId","subscriptionInstance","subscribeButtonNodeId","tags","box","querySelectorAll","forEach","e","tagValue","getAttribute","clickTag","tasksEfficiency","available","circleNode","circle","Circle","efficiencyHelperNode","Helper","SocialnetworkUICommon","showGroupMenuPopup","bindElement","perms","requestUser","edit","features","members","requests","requestsOut","userRequestGroup","userLeaveGroup","copy","onSliderMessage","bind","location","href","replace","sliderEvent","getEventId","reload","group","includes","getSliderByWindow","groupsList"],"mappings":"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"}