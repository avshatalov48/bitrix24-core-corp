{"version":3,"file":"script.js","sources":["src/actionmanager.js","src/manager.js"],"sourcesContent":["import {ajax, Type, Loc, Tag} from 'main.core';\nimport {PopupManager} from 'main.popup';\nimport {SendButton, CancelButton} from 'ui.buttons';\n\nimport Manager from './manager'\n\nexport default class ActionManager\n{\n\tconstructor(\n\t\tparams: {\n\t\t\tparent: Manager,\n\t\t}\n\t)\n\t{\n\t\tthis.parent = params.parent;\n\t\tthis.componentName = (Type.isStringFilled(this.parent.componentName) ? this.parent.componentName : '');\n\t\tthis.signedParameters = (Type.isStringFilled(this.parent.signedParameters) ? this.parent.signedParameters : '');\n\t\tthis.gridId = (Type.isStringFilled(this.parent.gridId) ? this.parent.gridId : '');\n\t\tthis.useSlider = (Type.isBoolean(this.parent.useSlider) ? this.parent.useSlider : false);\n\t}\n\n\tviewProfile(params)\n\t{\n\t\tconst userId = parseInt(!Type.isUndefined(params.userId) ? params.userId : 0);\n\t\tlet pathToUser = (Type.isStringFilled(params.pathToUser) ? params.pathToUser : '');\n\n\t\tif (\n\t\t\tuserId <= 0\n\t\t\t|| !Type.isStringFilled(pathToUser)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpathToUser = pathToUser.replace('#ID#', userId)\n\t\t\t.replace('#USER_ID#', userId)\n\t\t\t.replace('#user_id#', userId);\n\n\t\tif (this.useSlider)\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\tpathToUser,\n\t\t\t\t{\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tallowChangeHistory: true,\n\t\t\t\t\tcontentClassName: 'bitrix24-profile-slider-content',\n\t\t\t\t\tloader: 'intranet:profile',\n\t\t\t\t\twidth: 1100,\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twindow.location.href = pathToUser;\n\t\t}\n\t}\n\n\tact(\n\t\tparams: {\n\t\t\taction: string,\n\t\t\tuserId: number,\n\t\t}\n\t)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\treturn ajax.runComponentAction(this.componentName, 'act', {\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: {\n\t\t\t\t\taction: params.action,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tuserId: params.userId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tif (response.data.success)\n\t\t\t\t{\n\t\t\t\t\tthis.processActionSuccess(params);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.processActionFailure(params);\n\t\t\t\t}\n\t\t\t\tresolve(response);\n\t\t\t}, (response) => {\n\n\t\t\t\tif (response.errors)\n\t\t\t\t{\n\t\t\t\t\tthis.processActionFailure(params, response.errors[0].message);\n\t\t\t\t}\n\t\t\t\treject(response);\n\t\t\t});\n\t\t});\n\t}\n\n\tprocessActionSuccess(\n\t\tparams: {\n\t\t\taction: string,\n\t\t\tuserId: number,\n\t\t}\n\t)\n\t{\n\t\tlet eventCode = null;\n\n\t\tswitch (params.action)\n\t\t{\n\t\t\tcase 'exclude':\n\t\t\t\teventCode = 'afterUserExclude';\n\t\t\t\tbreak;\n\t\t\tcase 'setOwner':\n\t\t\t\teventCode = 'afterOwnerSet';\n\t\t\t\tbreak;\n\t\t\tcase 'setScrumMaster':\n\t\t\t\teventCode = 'afterSetScrumMaster';\n\t\t\t\tbreak;\n\t\t\tcase 'setModerator':\n\t\t\t\teventCode = 'afterModeratorAdd';\n\t\t\t\tbreak;\n\t\t\tcase 'removeModerator':\n\t\t\t\teventCode = 'afterModeratorRemove';\n\t\t\t\tbreak;\n\t\t\tcase 'acceptIncomingRequest':\n\t\t\tcase 'rejectIncomingRequest':\n\t\t\t\teventCode = 'afterRequestDelete';\n\t\t\t\tbreak;\n\t\t\tcase 'deleteOutgoingRequest':\n\t\t\t\teventCode = 'afterRequestOutDelete';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\n\t\tif (\n\t\t\teventCode\n\t\t\t&& top.BX.SidePanel\n\t\t\t&& window !== top.window\n\t\t)\n\t\t{\n\t\t\ttop.BX.SidePanel.Instance.postMessageAll(window, 'sonetGroupEvent', {\n\t\t\t\tcode: eventCode,\n\t\t\t});\n\t\t}\n\n\t\tif (params.action === 'reinvite')\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('SOCIALNETWORK_GROUP_USER_LIST_ACTION_REINVITE_SUCCESS'),\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.parent.reload();\n\t\t}\n\t}\n\n\tprocessActionFailure(\n\t\tparams: {\n\t\t\taction: string,\n\t\t\tuserId: number,\n\t\t\tevent: PointerEvent,\n\t\t},\n\t\terrorMessage: ?string\n\t)\n\t{\n\t\tif (!Type.isStringFilled(errorMessage))\n\t\t{\n\t\t\terrorMessage = Loc.getMessage('SOCIALNETWORK_GROUP_USER_LIST_ACTION_FAILURE');\n\t\t}\n\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: errorMessage,\n\t\t});\n\t}\n\n\tdisconnectDepartment(params)\n\t{\n\t\tconst id = parseInt(!Type.isUndefined(params.id) ? params.id : 0);\n\n\t\tif (id <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runComponentAction(this.componentName, 'disconnectDepartment', {\n\t\t\tmode: 'class',\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tdata: {\n\t\t\t\tfields: {\n\t\t\t\t\tid: id,\n\t\t\t\t},\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.data.success)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttop.BX.SidePanel\n\t\t\t\t\t&& window !== top.window\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\ttop.BX.SidePanel.Instance.postMessageAll(window, 'sonetGroupEvent', {\n\t\t\t\t\t\tcode: 'afterDeptUnconnect',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.parent.reload();\n\t\t\t}\n\t\t});\n\t}\n\n\tgroupDelete()\n\t{\n\t\tconst buttons = [\n\t\t\tnew SendButton({\n\t\t\t\ttext: Loc.getMessage('SOCIALNETWORK_GROUP_USER_LIST_GROUP_ACTION_BUTTON_DELETE'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tPopupManager.getCurrentPopup().destroy();\n\n\t\t\t\t\t\tconst gridInstance = BX.Main.gridManager.getInstanceById(this.gridId);\n\t\t\t\t\t\tif (!gridInstance)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst data = {\n\t\t\t\t\t\t\tID: gridInstance.getRows().getSelectedIds(),\n\t\t\t\t\t\t\tapply_filter: 'Y',\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tdata[gridInstance.getActionKey()] = 'delete';\n\t\t\t\t\t\tdata[gridInstance.getForAllKey()] = 'N';\n\n\t\t\t\t\t\tgridInstance.reloadTable('POST', data);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t\tnew CancelButton({\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tPopupManager.getCurrentPopup().destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t})\n\t\t];\n\n\t\tconst confirmPopup = PopupManager.create({\n\t\t\tid: 'bx-sgul-group-delete-confirm',\n\t\t\tautoHide: false,\n\t\t\tcloseByEsc: true,\n\t\t\tbuttons: buttons,\n\t\t\tevents: {\n\t\t\t\tonPopupClose: (popup) => {\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t\tcontent: Tag.render`<div>${Loc.getMessage('SOCIALNETWORK_GROUP_USER_LIST_GROUP_ACTION_CONFIRM_TEXT')}</div>`,\n\t\t\tpadding: 20,\n\t\t});\n\n\t\tconfirmPopup.show();\n\t}\n}\n","import {Type} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport ActionManager from './actionmanager';\n\nexport default class Manager\n{\n\tstatic repo = new Map();\n\n\tstatic getById(id)\n\t{\n\t\treturn Manager.repo.get(id);\n\t}\n\n\tconstructor(\n\t\tparams: {\n\t\t\tid: string,\n\t\t\tgridId: string,\n\t\t\tfilterId: string,\n\t\t\tdefaultFilterPresetId: string,\n\t\t\tdefaultCounter: string,\n\t\t\tgridContainerId: string,\n\t\t\tcomponentName: string,\n\t\t\tsignedParameters: string,\n\t\t\tuseSlider: boolean,\n\t\t\turls: {\n\t\t\t\tusers: string,\n\t\t\t\trequests: string,\n\t\t\t\trequestsOut: string,\n\t\t\t},\n\t\t}\n\t)\n\t{\n\t\tthis.id = params.id;\n\t\tthis.componentName = params.componentName;\n\t\tthis.signedParameters = params.signedParameters;\n\t\tthis.useSlider = params.useSlider;\n\t\tthis.gridId = params.gridId;\n\t\tthis.filterId = (Type.isStringFilled(params.filterId) ? params.filterId : null);\n\t\tthis.defaultFilterPresetId = (\n\t\t\tType.isStringFilled(params.defaultFilterPresetId)\n\t\t\t&& ![ 'requests_in', 'requests_out' ].includes(params.defaultFilterPresetId)\n\t\t\t\t? params.defaultFilterPresetId\n\t\t\t\t: 'tmp_filter'\n\t\t);\n\t\tthis.defaultCounter = (Type.isStringFilled(params.defaultCounter) ? params.defaultCounter : '');\n\t\tthis.gridContainer = (Type.isStringFilled(params.gridContainerId) ? document.getElementById(params.gridContainerId) : null);\n\t\tthis.urls = params.urls;\n\n\t\tthis.actionManagerInstance = new ActionManager({\n\t\t\tparent: this,\n\t\t});\n\n\t\tManager.repo.set(this.id, this);\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tthis.initEvents();\n\t}\n\n\tinitEvents()\n\t{\n\t\tif (this.gridContainer)\n\t\t{\n\t\t\tthis.gridContainer.addEventListener('click', this.processClickEvent.bind(this));\n\t\t}\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', (event: BaseEvent) => {\n\n\t\t\tconst [ sliderEvent ] = event.getCompatData();\n\n\t\t\tif (\n\t\t\t\tsliderEvent.getEventId() === 'sonetGroupEvent'\n\t\t\t\t&& !Type.isUndefined(sliderEvent.data)\n\t\t\t\t&& Type.isStringFilled(sliderEvent.data.code)\n\t\t\t\t&& [ 'afterInvite', 'afterIncomingRequestCancel' ].includes(sliderEvent.data.code)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.reload();\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('Socialnetwork.Toolbar:onItem', (event: BaseEvent) => {\n\t\t\tconst data = event.getData();\n\n\t\t\tif (data.counter)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tdata.counter.filter\n\t\t\t\t\t&& data.counter.filterPresetId\n\t\t\t\t\t&& data.counter.filter.filterManager\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tconst filterApi = data.counter.filter.getFilter().getApi();\n\t\t\t\t\tconst filterManager = data.counter.filter.filterManager;\n\n\t\t\t\t\tfilterApi.setFilter({\n\t\t\t\t\t\tpreset_id: (\n\t\t\t\t\t\t\tfilterManager.getPreset().getCurrentPresetId() === data.counter.filterPresetId\n\t\t\t\t\t\t\t\t? this.defaultFilterPresetId\n\t\t\t\t\t\t\t\t: data.counter.filterPresetId\n\t\t\t\t\t\t),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse if (Type.isStringFilled(data.counter.type))\n\t\t\t\t{\n\t\t\t\t\tlet url = '';\n\n\t\t\t\t\tif (data.counter.type === this.defaultCounter)\n\t\t\t\t\t{\n\t\t\t\t\t\turl = this.urls.users;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tswitch (data.counter.type)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcase 'workgroup_requests_in':\n\t\t\t\t\t\t\t\turl = this.urls.requests;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'workgroup_requests_out':\n\t\t\t\t\t\t\t\turl = this.urls.requestsOut;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isStringFilled(url))\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.location = url.replace('#group_id#', this.g);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst filterInstance = BX.Main.filterManager.getById(this.filterId);\n\t\tif (filterInstance)\n\t\t{\n\t\t\tconst filterEmitter = filterInstance.getEmitter();\n\t\t\tconst filterApi = filterInstance.getApi();\n\n\t\t\tfilterEmitter.subscribe('init', (event) => {\n\t\t\t\tconst { field } = event.getData();\n\t\t\t\tif (field.id === 'INITIATED_BY_TYPE')\n\t\t\t\t{\n\t\t\t\t\tfield.subscribe('change', () => {\n\n\t\t\t\t\t\tif (Type.isStringFilled(field.getValue()))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst filterFieldsValues = filterInstance.getFilterFieldsValues();\n\n\t\t\t\t\t\t\tif (Type.isStringFilled(filterFieldsValues.INITIATED_BY_TYPE))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (JSON.stringify(Object.values(filterFieldsValues.ROLE)) === JSON.stringify([ 'Z' ]))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tfilterFieldsValues.ROLE = { 0: 'Z' };\n\t\t\t\t\t\t\t\tfilterApi.setFields(filterFieldsValues);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe('BX.Grid.SettingsWindow:save', (event: BaseEvent) => {\n\t\t\t\tconst [ settingsWindow ] = event.getData();\n\t\t\t\tif (!settingsWindow || !settingsWindow.parent || settingsWindow.parent.getId() !== this.gridId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfilterApi.setFilter({\n\t\t\t\t\tpreset_id: this.defaultFilterPresetId,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\treload()\n\t{\n\t\tconst gridInstance = BX.Main.gridManager.getInstanceById(this.gridId);\n\t\tif (!gridInstance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tgridInstance.reloadTable('POST', {\n\t\t\tapply_filter: 'Y',\n\t\t});\n\t}\n\n\tprocessClickEvent(e)\n\t{\n\t\tconst targetNode = e.target;\n\n\t\tif (!targetNode.classList.contains('sonet-group-user-grid-action'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = targetNode.getAttribute('data-bx-action');\n\n\t\tif (action === 'disconnectDepartment')\n\t\t{\n\t\t\tconst departmentId = Number(targetNode.getAttribute('data-bx-department'));\n\t\t\tif (departmentId > 0)\n\t\t\t{\n\t\t\t\tthis.getActionManager().disconnectDepartment({\n\t\t\t\t\tid: departmentId,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet userId = targetNode.getAttribute('data-bx-user-id');\n\n\t\tif (\n\t\t\t!Type.isStringFilled(action)\n\t\t\t|| !Type.isStringFilled(userId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tuserId = parseInt(userId);\n\t\tif (userId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttargetNode.classList.add('--inactive');\n\n\t\tthis.actionManagerInstance.act({\n\t\t\taction: action,\n\t\t\tuserId: userId,\n\t\t}).then(() => {\n\t\t\ttargetNode.classList.remove('--inactive');\n\t\t}, () => {\n\t\t\ttargetNode.classList.remove('--inactive');\n\t\t});\n\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t}\n\n\tgetActionManager()\n\t{\n\t\treturn this.actionManagerInstance;\n\t}\n\n}\n"],"names":["ActionManager","params","parent","componentName","Type","isStringFilled","signedParameters","gridId","useSlider","isBoolean","userId","parseInt","isUndefined","pathToUser","replace","BX","SidePanel","Instance","open","cacheable","allowChangeHistory","contentClassName","loader","width","window","location","href","Promise","resolve","reject","ajax","runComponentAction","mode","data","action","fields","then","response","success","processActionSuccess","processActionFailure","errors","message","eventCode","top","postMessageAll","code","UI","Notification","Center","notify","content","Loc","getMessage","reload","errorMessage","id","buttons","SendButton","text","events","click","PopupManager","getCurrentPopup","destroy","gridInstance","Main","gridManager","getInstanceById","ID","getRows","getSelectedIds","apply_filter","getActionKey","getForAllKey","reloadTable","CancelButton","confirmPopup","create","autoHide","closeByEsc","onPopupClose","popup","Tag","render","padding","show","Manager","repo","get","filterId","defaultFilterPresetId","includes","defaultCounter","gridContainer","gridContainerId","document","getElementById","urls","actionManagerInstance","set","init","initEvents","addEventListener","processClickEvent","bind","EventEmitter","subscribe","event","getCompatData","sliderEvent","getEventId","getData","counter","filter","filterPresetId","filterManager","filterApi","getFilter","getApi","setFilter","preset_id","getPreset","getCurrentPresetId","type","url","users","requests","requestsOut","g","filterInstance","getById","filterEmitter","getEmitter","field","getValue","filterFieldsValues","getFilterFieldsValues","INITIATED_BY_TYPE","JSON","stringify","Object","values","ROLE","setFields","settingsWindow","getId","e","targetNode","target","classList","contains","getAttribute","departmentId","Number","getActionManager","disconnectDepartment","add","act","remove","preventDefault","stopPropagation","Map"],"mappings":"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"}