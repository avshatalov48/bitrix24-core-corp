this.BX=this.BX||{};this.BX.Socialnetwork=this.BX.Socialnetwork||{};(function(e,t,n,i){"use strict";var s=function(){function e(t){var n=this;babelHelpers.classCallCheck(this,e);this.id=t.id;this.menuItems=t.menuItems;this.componentName=t.componentName;if(i.Type.isStringFilled(t.menuButtonId)){var s=document.getElementById(t.menuButtonId);if(s){s.addEventListener("click",function(e){n.menuButtonClick(e.currentTarget)})}}}babelHelpers.createClass(e,[{key:"getId",value:function e(){return this._id}},{key:"getSetting",value:function e(t,n){return this._settings.getParam(t,n)}},{key:"menuButtonClick",value:function e(t){this.openMenu(t)}},{key:"openMenu",value:function e(t){if(this.menuOpened){this.closeMenu();return}if(!i.Type.isArray(this.menuItems)){return}var s=[];this.menuItems.forEach(function(e){if(!i.Type.isUndefined(e.SEPARATOR)&&e.SEPARATOR){s.push({SEPARATOR:true});return}if(!i.Type.isStringFilled(e.TYPE)){return}s.push({text:i.Type.isStringFilled(e.TITLE)?e.TITLE:"",onclick:i.Type.isStringFilled(e.LINK)?'window.location.href = "'.concat(e.LINK,'"; return false;'):""})});this.menuId="".concat(this.id.toLowerCase(),"_menu");n.Popup.show(this.menuId,t,s,{autoHide:true,closeByEsc:true,offsetTop:0,offsetLeft:0,events:{onPopupShow:this.onPopupShow.bind(this),onPopupClose:this.onPopupClose.bind(this),onPopupDestroy:this.onPopupDestroy.bind(this)}});this.menuPopup=n.MenuManager.currentItem}},{key:"closeMenu",value:function e(){if(!this.menuPopup||!this.menuPopup.popupWindow){return}this.menuPopup.popupWindow.destroy()}},{key:"onPopupShow",value:function e(){this.menuOpened=true}},{key:"onPopupClose",value:function e(){this.closeMenu()}},{key:"onPopupDestroy",value:function e(){this.menuOpened=false;this.menuPopup=null;if(!i.Type.isUndefined(n.MenuManager.Data[this.menuId])){delete n.MenuManager.Data[this.menuId]}}}]);return e}();var a=function(){function e(t){babelHelpers.classCallCheck(this,e);this.componentName=t.componentName;this.signedParameters=t.signedParameters;this.gridId=t.gridId}babelHelpers.createClass(e,[{key:"viewProfile",value:function e(t){var n=parseInt(!i.Type.isUndefined(t.userId)?t.userId:0);var s=i.Type.isStringFilled(t.pathToUser)?t.pathToUser:"";if(n<=0||!i.Type.isStringFilled(s)){return}BX.SidePanel.Instance.open(s.replace("#ID#",n).replace("#USER_ID#",n).replace("#user_id#",n),{cacheable:false,allowChangeHistory:true,contentClassName:"bitrix24-profile-slider-content",loader:"intranet:profile",width:1100})}},{key:"act",value:function e(t,n){var s=this;i.ajax.runComponentAction(this.componentName,"act",{mode:"class",signedParameters:this.signedParameters,data:{action:t,fields:{userId:n}}}).then(function(e){if(e.data.success){BX.Main.gridManager.reload(s.gridId)}})}},{key:"disconnectDepartment",value:function e(t){var n=this;var s=parseInt(!i.Type.isUndefined(t.id)?t.id:0);if(s<=0){return}i.ajax.runComponentAction(this.componentName,"disconnectDepartment",{mode:"class",signedParameters:this.signedParameters,data:{fields:{id:s}}}).then(function(e){if(e.data.success){BX.Main.gridManager.reload(n.gridId)}})}}]);return e}();var r=function(){babelHelpers.createClass(e,null,[{key:"getById",value:function t(n){return e.repo.get(n)}}]);function e(n){var r=this;babelHelpers.classCallCheck(this,e);this.componentName=n.componentName;this.signedParameters=n.signedParameters;this.gridId=n.gridId;this.filterId=i.Type.isStringFilled(n.filterId)?n.filterId:null;this.gridContainer=i.Type.isStringFilled(n.gridContainerId)?document.getElementById(n.gridContainerId):null;n.toolbar.componentName=this.componentName;this.toolbarInstance=new s(n.toolbar);this.actionManagerInstance=new a({componentName:this.componentName,signedParameters:this.signedParameters,gridId:this.gridId});t.EventEmitter.subscribe("SidePanel.Slider:onMessage",function(e){var t=e.getCompatData(),n=babelHelpers.slicedToArray(t,1),s=n[0];if(s.getEventId()==="sonetGroupEvent"&&!i.Type.isUndefined(s.data)&&i.Type.isStringFilled(s.data.code)&&s.data.code==="afterInvite"){BX.Main.gridManager.reload(r.gridId)}});e.repo.set(this.id,this)}babelHelpers.createClass(e,[{key:"getActionManager",value:function e(){return this.actionManagerInstance}}]);return e}();babelHelpers.defineProperty(r,"repo",new Map);e.Manager=r;e.Toolbar=s})(this.BX.Socialnetwork.WorkgroupUserList=this.BX.Socialnetwork.WorkgroupUserList||{},BX.Event,BX.Main,BX);
//# sourceMappingURL=script.map.js