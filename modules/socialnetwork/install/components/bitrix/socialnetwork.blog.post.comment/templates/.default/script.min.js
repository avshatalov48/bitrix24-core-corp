(function(){if(!!window.__blogEditComment)return;window.checkForQuote=function(e,i,o,t){if(window.mplCheckForQuote)mplCheckForQuote(e,i,o,t)};window.__blogLinkEntity=function(e,i){if(!!window["UC"]&&!!window["UC"]["f"+i]){window["UC"]["f"+i].linkEntity(e);for(var o in e){if(e.hasOwnProperty(o)){BX.bind(BX("blog-post-addc-add-"+e[o][1]),"click",BX.proxy(window["UC"][o].reply,window["UC"][o]));BX.bind(BX("blg-post-"+e[o][1]),"dragenter",BX.proxy(window["UC"][o].reply,window["UC"][o]));BX.addCustomEvent(window["UC"]["f"+i].eventNode,"OnUCFormBeforeShow",function(i){if(!!i&&!!i.id&&i.id[0]==o){BX.show(BX("blg-comment-"+e[o][1]))}})}}}};window.__blogEditComment=function(e,i){var o={messageBBCode:top["text"+e],messageFields:{arImages:top["arComFiles"+e],arDocs:top["arComDocs"+e],arFiles:top["arComFilesUf"+e],arDFiles:top["arComDFiles"+e],UrlPreview:top["UrlPreview"+e]}};BX.onCustomEvent(window,"OnUCAfterRecordEdit",["BLOG_"+i,e,o,"EDIT"])};window.__blogOnUCFormClear=function(e){LHEPostForm.reinitDataBefore(e.editorId)};window.__blogOnUCFormAfterShow=function(e,i,o){o=!!o?o:{};BX.onCustomEvent(window,"OnBeforeSocialnetworkCommentShowedUp",["socialnetwork_blog"]);var t={ENTITY_XML_ID:e.id[0],ENTITY_TYPE:e.entitiesId[e.id[0]][0],ENTITY_ID:e.entitiesId[e.id[0]][1],parentId:e.id[1],comment_post_id:e.entitiesId[e.id[0]][1],edit_id:e.id[1],act:e.id[1]>0?"edit":"add",logId:e.entitiesId[e.id[0]][2]};for(var n in t){if(!e.form[n])e.form.appendChild(BX.create("INPUT",{attrs:{name:n,type:"hidden"}}));e.form[n].value=t[n]}e.form.action=SBPC.actionUrl.replace(/#source_post_id#/,t["comment_post_id"]);var a=BX("captcha");if(!!a){BX.ajax.getCaptcha(function(e){BX("captcha_word").value="";BX("captcha_code").value=e["captcha_sid"];BX("captcha").src="/bitrix/tools/captcha.php?captcha_code="+e["captcha_sid"];BX("captcha").style.display=""})}onLightEditorShow(i,o)};window.__blogOnUCFormSubmit=function(e,i){i["decode"]="Y"};window.__blogOnUCAfterRecordAdd=function(e,i){if(i.errorMessage.length>0)return;if(BX("blg-post-inform-"+e.substr(5))){var o=BX.findChild(BX("blg-post-inform-"+e.substr(5)),{tag:"span",className:"feed-inform-follow"},true);if(o){var t=o.getAttribute("data-follow")=="Y"?"Y":"N";if(t=="N"){BX.findChild(o,{tagName:"a"}).innerHTML=BX.message("sonetBPFollowY");o.setAttribute("data-follow","Y")}}}};window.onLightEditorShow=function(e,i){var o={};if(i["arFiles"]){var t={},n,a;for(var r=0;r<i["arFiles"].length;r++){n=BX.findChild(BX("wdif-doc-"+i["arFiles"][r]),{className:"feed-com-file-name"},true);a=BX.findChild(BX("wdif-doc-"+i["arFiles"][r]),{className:"feed-con-file-size"},true);t["F"+r]={FILE_ID:i["arFiles"][r],FILE_NAME:n?n.innerHTML:"noname",FILE_SIZE:a?a.innerHTML:"unknown",CONTENT_TYPE:"notimage/xyz"}}o["UF_BLOG_COMMENT_DOC"]={USER_TYPE_ID:"file",FIELD_NAME:"UF_BLOG_COMMENT_DOC[]",VALUE:t}}if(i["arDocs"])o["UF_BLOG_COMMENT_FILE"]={USER_TYPE_ID:"webdav_element",FIELD_NAME:"UF_BLOG_COMMENT_FILE[]",VALUE:BX.clone(i["arDocs"])};if(i["arDFiles"])o["UF_BLOG_COMMENT_FILE"]={USER_TYPE_ID:"disk_file",FIELD_NAME:"UF_BLOG_COMMENT_FILE[]",VALUE:BX.clone(i["arDFiles"])};if(i["UrlPreview"])o["UF_BLOG_COMMENT_URL_PRV"]={USER_TYPE_ID:"url_preview",FIELD_NAME:"UF_BLOG_COMMENT_URL_PRV",VALUE:BX.clone(i["UrlPreview"])};LHEPostForm.reinitData(SBPC.editorId,e,o);if(i["arImages"]){var d,l=LHEPostForm.getHandler(SBPC.editorId),s="";for(var m in i["arImages"]){if(i["arImages"].hasOwnProperty(m)){d={id:i["arImages"][m]["id"],element_id:i["arImages"][m]["id"],element_name:i["arImages"][m]["name"],element_size:0,element_content_type:i["arImages"][m]["type"],element_url:i["arImages"][m]["src"],element_thumbnail:i["arImages"][m]["thumbnail"],element_image:i["arImages"][m]["src"],parser:"postimage",storage:"bfile"};var _=l.checkFile(d.id,"common",d,true)}}}};BX.SocialnetworkBlogPostComment={};BX.SocialnetworkBlogPostComment.registerViewAreaList=function(e){if(typeof e=="undefined"||typeof e.containerId=="undefined"||typeof e.className=="undefined"){return}if(BX(e.containerId)){var i=BX.findChildren(BX(e.containerId),{tag:"div",className:e.className},true),o=null;for(var t=0,n=i.length;t<n;t++){if(i[t].id.length>0){o=null;if(BX.type.isNotEmptyString(e.fullContentClassName)){o=BX.findChild(i[t],{className:e.fullContentClassName})}BX.UserContentView.registerViewArea(i[t].id,o?o:null)}}}}})(window);