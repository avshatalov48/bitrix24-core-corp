window["__logCommentsListRedefine"]=function(e,t,n,s){if(window["UC"]&&!!window["UC"][e]){BX.addCustomEvent(window["UC"][e],"OnUCListWasBuilt",function(t,n,a){if(BX(a)&&a.hasChildNodes){var i=a.firstChild,o;do{if(BX(i)&&i["getAttribute"]){o=i.getAttribute("id").replace("record-"+e+"-","").replace("-cover","");BX.onCustomEvent(window,"OnUCAddEntitiesCorrespondence",[e+"-"+o,[s,top["arLogCom"+s+o]]])}}while(i=i.nextSibling)}})}if(!!window.mplCheckForQuote)BX.bind(BX(t),"mouseup",function(t){mplCheckForQuote(t,this,e,n)})};window["__logBuildRating"]=function(e,t,n){var s="";n=!!n?n:Math.floor(Math.random()*1e5)+1;if(BX.message("sonetLShowRating")=="Y"&&!!e["RATING_TYPE_ID"]>0&&e["RATING_ENTITY_ID"]>0&&(BX.message("sonetLRatingType")=="like"&&!!window["RatingLike"]||BX.message("sonetLRatingType")=="standart_text"&&!!window["Rating"])){if(BX.message("sonetLRatingType")=="like"){var a=e["RATING_USER_VOTE_VALUE"]>0?" bx-you-like":"",i=e["RATING_USER_VOTE_VALUE"]>0?BX.message("sonetLTextLikeN"):BX.message("sonetLTextLikeY"),o=null;if(!!t["ALLOW_VOTE"]&&!!t["ALLOW_VOTE"]["RESULT"])o=BX.create("span",{props:{className:"bx-ilike-text"},html:i});s=BX.create("span",{attrs:{id:"sonet-rating-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+n},props:{className:"sonet-log-comment-like rating_vote_text"},children:[BX.create("span",{props:{className:"ilike-light"},children:[BX.create("span",{props:{id:"bx-ilike-button-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+n,className:"bx-ilike-button"},children:[BX.create("span",{props:{className:"bx-ilike-right-wrap"+a},children:[BX.create("span",{props:{className:"bx-ilike-right"},html:e["RATING_TOTAL_POSITIVE_VOTES"]})]}),BX.create("span",{props:{className:"bx-ilike-left-wrap"},children:[o]})]}),BX.create("span",{props:{id:"bx-ilike-popup-cont-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+n,className:"bx-ilike-wrap-block"},style:{display:"none"},children:[BX.create("span",{props:{className:"bx-ilike-popup"},children:[BX.create("span",{props:{className:"bx-ilike-wait"}})]})]})]})]})}else if(BX.message("sonetLRatingType")=="standart_text"){s=BX.create("span",{attrs:{id:"sonet-rating-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+n},props:{className:"sonet-log-comment-like rating_vote_text"},children:[BX.create("span",{props:{className:"bx-rating"+(!t["ALLOW_VOTE"]["RESULT"]?" bx-rating-disabled":"")+(e["RATING_USER_VOTE_VALUE"]!=0?" bx-rating-active":""),id:"bx-rating-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+n,title:!t["ALLOW_VOTE"]["RESULT"]?t["ERROR_MSG"]:""},children:[BX.create("span",{props:{className:"bx-rating-absolute"},children:[BX.create("span",{props:{className:"bx-rating-question"},html:!t["ALLOW_VOTE"]["RESULT"]?BX.message("sonetLTextDenied"):BX.message("sonetLTextAvailable")}),BX.create("span",{props:{className:"bx-rating-yes "+(e["RATING_USER_VOTE_VALUE"]>0?"  bx-rating-yes-active":""),title:e["RATING_USER_VOTE_VALUE"]>0?BX.message("sonetLTextCancel"):BX.message("sonetLTextPlus")},children:[BX.create("a",{props:{className:"bx-rating-yes-count",href:"#like"},html:""+parseInt(e["RATING_TOTAL_POSITIVE_VOTES"])}),BX.create("a",{props:{className:"bx-rating-yes-text",href:"#like"},html:BX.message("sonetLTextRatingY")})]}),BX.create("span",{props:{className:"bx-rating-separator"},html:"/"}),BX.create("span",{props:{className:"bx-rating-no "+(e["RATING_USER_VOTE_VALUE"]<0?"  bx-rating-no-active":""),title:e["RATING_USER_VOTE_VALUE"]<0?BX.message("sonetLTextCancel"):BX.message("sonetLTextMinus")},children:[BX.create("a",{props:{className:"bx-rating-no-count",href:"#dislike"},html:""+parseInt(e["RATING_TOTAL_NEGATIVE_VOTES"])}),BX.create("a",{props:{className:"bx-rating-no-text",href:"#dislike"},html:BX.message("sonetLTextRatingN")})]})]})]}),BX.create("span",{props:{id:"bx-rating-popup-cont-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+n+"-plus"},style:{display:"none"},children:[BX.create("span",{props:{className:"bx-ilike-popup  bx-rating-popup"},children:[BX.create("span",{props:{className:"bx-ilike-wait"}})]})]}),BX.create("span",{props:{id:"bx-rating-popup-cont-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+n+"-minus"},style:{display:"none"},children:[BX.create("span",{props:{className:"bx-ilike-popup  bx-rating-popup"},children:[BX.create("span",{props:{className:"bx-ilike-wait"}})]})]})]})}}if(!!s){s=BX.create("span",{children:[s]});s=s.innerHTML+'<script>window["#OBJ#"].Set("#ID#", "#RATING_TYPE_ID#", #RATING_ENTITY_ID#, "#ALLOW_VOTE#", BX.message("sonetLCurrentUserID"), #TEMPLATE#, "light", BX.message("sonetLPathToUser"));<\/script>'.replace("#OBJ#",BX.message("sonetLRatingType")=="like"?"RatingLike":"Rating").replace("#ID#",e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+n).replace("#RATING_TYPE_ID#",e["RATING_TYPE_ID"]).replace("#RATING_ENTITY_ID#",e["RATING_ENTITY_ID"]).replace("#ALLOW_VOTE#",!!t["ALLOW_VOTE"]&&!!t["ALLOW_VOTE"]["RESULT"]?"Y":"N").replace("#TEMPLATE#",BX.message("sonetLRatingType")=="like"?'{LIKE_Y:BX.message("sonetLTextLikeN"),LIKE_N:BX.message("sonetLTextLikeY"),LIKE_D:BX.message("sonetLTextLikeD")}':'{PLUS:BX.message("sonetLTextPlus"),MINUS:BX.message("sonetLTextMinus"),CANCEL:BX.message("sonetLTextCancel")}')}return s};window["__logShowCommentForm"]=function(e){if(!!window["UC"][e])window["UC"][e].reply()};var waitTimeout=null;var waitDiv=null;var waitPopup=null;var waitTime=500;function __logShowHiddenDestination(e,t,n){var s=new XMLHttpRequest;s.open("POST",BX.message("sonetLESetPath"),true);s.setRequestHeader("Content-Type","application/x-www-form-urlencoded");s.onreadystatechange=function(){if(s.readyState==4){if(s.status==200){var e=LBlock.DataParser(s.responseText);if(typeof e=="object"){if(e[0]=="*"){if(sonetLErrorDiv!=null){sonetLErrorDiv.style.display="block";sonetLErrorDiv.innerHTML=s.responseText}return}s.abort();var t=e["arDestinations"];if(typeof t=="object"){if(BX(n)){var a=n.parentNode;a.removeChild(n);var i="";for(var o=0;o<t.length;o++){if(typeof t[o]["TITLE"]!="undefined"&&t[o]["TITLE"].length>0){a.appendChild(BX.create("SPAN",{html:",&nbsp;"}));if(typeof t[o]["CRM_PREFIX"]!="undefined"&&t[o]["CRM_PREFIX"].length>0){a.appendChild(BX.create("SPAN",{props:{className:"feed-add-post-destination-prefix"},html:t[o]["CRM_PREFIX"]+":&nbsp;"}))}if(typeof t[o]["URL"]!="undefined"&&t[o]["URL"].length>0){a.appendChild(BX.create("A",{props:{className:"feed-add-post-destination-new"+(typeof t[o]["IS_EXTRANET"]!="undefined"&&t[o]["IS_EXTRANET"]=="Y"?" feed-post-user-name-extranet":""),href:t[o]["URL"]},html:t[o]["TITLE"]}))}else{a.appendChild(BX.create("SPAN",{props:{className:"feed-add-post-destination-new"+(typeof t[o]["IS_EXTRANET"]!="undefined"&&t[o]["IS_EXTRANET"]=="Y"?" feed-post-user-name-extranet":"")},html:t[o]["TITLE"]}))}}}if(e["iDestinationsHidden"]!="undefined"&&parseInt(e["iDestinationsHidden"])>0){e["iDestinationsHidden"]=parseInt(e["iDestinationsHidden"]);var r=e["iDestinationsHidden"]%100>10&&e["iDestinationsHidden"]%100<20?5:e["iDestinationsHidden"]%10;a.appendChild(BX.create("SPAN",{html:"&nbsp;"+BX.message("sonetLDestinationHidden"+r).replace("#COUNT#",e["iDestinationsHidden"])}))}}}}}else{}}};s.send("r="+Math.floor(Math.random()*1e3)+"&"+BX.message("sonetLSessid")+"&site="+BX.util.urlencode(BX.message("SITE_ID"))+"&nt="+BX.util.urlencode(BX.message("sonetLNameTemplate"))+"&log_id="+encodeURIComponent(e)+(t?"&created_by_id="+encodeURIComponent(t):"")+"&p_user="+BX.util.urlencode(BX.message("sonetLPathToUser"))+"&p_group="+BX.util.urlencode(BX.message("sonetLPathToGroup"))+"&p_dep="+BX.util.urlencode(BX.message("sonetLPathToDepartment"))+"&dlim="+BX.util.urlencode(BX.message("sonetLDestinationLimit"))+"&action=get_more_destination")}function __logSetFollow(e){var t=BX("log_entry_follow_"+e).getAttribute("data-follow")=="Y"?"Y":"N",n=t=="Y"?"N":"Y",s=BX("log_entry_follow_"+e);if(s){BX.findChild(s,{tagName:"a"}).innerHTML=BX.message("sonetLFollow"+n);s.setAttribute("data-follow",n)}var a=BX.message("sonetLSetPath");a=BX.util.add_url_param(a,{b24statAction:n=="Y"?"setFollow":"setUnfollow"});BX.ajax({url:a,method:"POST",dataType:"json",data:{log_id:e,action:"change_follow",follow:n,sessid:BX.bitrix_sessid(),site:BX.message("sonetLSiteId")},onsuccess:function(e){if(e["SUCCESS"]!="Y"&&s){BX.findChild(s,{tagName:"a"}).innerHTML=BX.message("sonetLFollow"+t);s.setAttribute("data-follow",t)}},onfailure:function(e){if(s){BX.findChild(s,{tagName:"a"}).innerHTML=BX.message("sonetLFollow"+t);s.setAttribute("data-follow",t)}}});return false}function __logRefreshEntry(e){var t=e.node!==undefined?BX(e.node):false;var n=e.logId!==undefined?parseInt(e.logId):0;if(!t||n<=0||BX.message("sonetLEPath")===undefined){return}BX.ajax({url:BX.message("sonetLEPath").replace("#log_id#",n),method:"POST",dataType:"json",data:{log_id:n,action:"get_entry"},onsuccess:function(e){if(e["ENTRY_HTML"]!==undefined){BX.cleanNode(t);t.innerHTML=e["ENTRY_HTML"];var n=BX.processHTML(t.innerHTML,true);var s=n.SCRIPT;BX.ajax.processScripts(s,true)}},onfailure:function(e){}});return false}window.__logEditComment=function(e,t,n){BX.ajax({url:BX.message("sonetLESetPath"),method:"POST",dataType:"json",data:{comment_id:t,post_id:n,site:BX.message("sonetLSiteId"),action:"get_comment_src",sessid:BX.bitrix_sessid()},onsuccess:function(t){if(typeof t.message!="undefined"&&typeof t.sourceId!="undefined"){var s={messageBBCode:t.message,messageFields:{arFiles:typeof t["UF"]!="undefined"&&typeof t["UF"]["UF_SONET_COM_FILE"]!="undefined"?t["UF"]["UF_SONET_COM_FILE"]["VALUE"]:[]}};if(typeof t["UF"]!="undefined"&&typeof t["UF"]["UF_SONET_COM_DOC"]!="undefined"&&typeof t["UF"]["UF_SONET_COM_DOC"]["USER_TYPE_ID"]!="undefined"){if(t["UF"]["UF_SONET_COM_DOC"]["USER_TYPE_ID"]=="webdav_element"){s["messageFields"]["arDocs"]=t["UF"]["UF_SONET_COM_DOC"]["VALUE"]}else if(t["UF"]["UF_SONET_COM_DOC"]["USER_TYPE_ID"]=="disk_file"){s["messageFields"]["arDFiles"]=t["UF"]["UF_SONET_COM_DOC"]["VALUE"]}}window["UC"][window.SLEC.formKey]["entitiesCorrespondence"][e+"-"+t.sourceId]=[n,t.id];BX.onCustomEvent(window,"OnUCAfterRecordEdit",[e,t.sourceId,s,"EDIT"])}},onfailure:function(e){}})};(function(){BX.SocialnetworkLogEntry={};BX.SocialnetworkLogEntry.registerViewAreaList=function(e){if(typeof e=="undefined"||typeof e.containerId=="undefined"||typeof e.className=="undefined"){return}if(BX(e.containerId)){var t=BX.findChildren(BX(e.containerId),{tag:"div",className:e.className},true),n=null;for(var s=0,a=t.length;s<a;s++){if(t[s].id.length>0){n=null;if(BX.type.isNotEmptyString(e.fullContentClassName)){n=BX.findChild(t[s],{className:e.fullContentClassName})}BX.UserContentView.registerViewArea(t[s].id,n?n:null)}}}}})();