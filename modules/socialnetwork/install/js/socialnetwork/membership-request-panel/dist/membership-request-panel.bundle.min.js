this.BX=this.BX||{};(function(t,e,a,n,s,i){"use strict";var r,l;function c(t,e){p(t,e);e.add(t)}function o(t,e,a){p(t,e);e.set(t,a)}function p(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function u(t,e,a){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return a}var b=new WeakMap;var d=new WeakMap;var v=new WeakMap;var h=new WeakMap;var w=new WeakMap;var m=new WeakMap;var f=new WeakSet;var g=new WeakSet;var _=new WeakSet;var S=new WeakSet;var P=new WeakSet;var k=new WeakSet;var H=new WeakSet;var F=new WeakSet;var T=new WeakSet;var I=function(){function t(e){babelHelpers.classCallCheck(this,t);c(this,T);c(this,F);c(this,H);c(this,k);c(this,P);c(this,S);c(this,_);c(this,g);c(this,f);o(this,b,{writable:true,value:void 0});o(this,d,{writable:true,value:void 0});o(this,v,{writable:true,value:void 0});o(this,h,{writable:true,value:void 0});o(this,w,{writable:true,value:void 0});o(this,m,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,v,a.Type.isInteger(parseInt(e.groupId,10))?parseInt(e.groupId,10):0);babelHelpers.classPrivateFieldSet(this,b,u(this,f,E).call(this,e.bindElement));babelHelpers.classPrivateFieldSet(this,h,e.pathToUser);babelHelpers.classPrivateFieldSet(this,m,new Set);babelHelpers.classPrivateFieldSet(this,w,1)}babelHelpers.createClass(t,[{key:"show",value:function t(){babelHelpers.classPrivateFieldGet(this,b).toggle()}}]);return t}();function E(t){var e=this;var a=new n.Popup({id:"sn-mrp-members-popup",className:"sn-mrp-members-popup",bindElement:t,autoHide:true,closeByEsc:true,content:u(this,_,W).call(this),events:{onAfterPopupShow:function t(){var n=a.getContentContainer();var s=n.querySelector(".sn-mrp-members-popup-content");var i=n.querySelector(".sn-mrp-members-popup-inner");u(e,P,L).call(e,i);u(e,k,y).call(e,s);u(e,g,M).call(e,i).then((function(){u(e,H,R).call(e);u(e,P,L).call(e,i)}))}}});return a}function M(t){var e=this;return u(this,F,C).call(this).then((function(n){n.forEach((function(n){babelHelpers.classPrivateFieldGet(e,m).add(n);a.Dom.append(u(e,S,G).call(e,n),t)}))}))}function W(){return a.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sn-mrp-members-popup-container">\n\t\t\t\t<div class="sn-mrp-members-popup-content">\n\t\t\t\t\t<div class="sn-mrp-members-popup-content-box">\n\t\t\t\t\t\t<div class="sn-mrp-members-popup-inner"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'])))}function G(t){var e="<i></i>";if(t.photo){e="<i style=\"background-image: url('".concat(encodeURI(t.photo),"')\"></i>")}return a.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<a\n\t\t\t\tclass="sn-mrp-members-popup-item"\n\t\t\t\thref="','"\n\t\t\t\tdata-id="sn-mrp-members-popup-item-','"\n\t\t\t>\n\t\t\t\t<span class="sn-mrp-members-popup-avatar-new">\n\t\t\t\t\t<div class="ui-icon ui-icon-common-user sn-mrp-members-popup-avatar-img">\n\t\t\t\t\t\t','\n\t\t\t\t\t</div>\n\t\t\t\t\t<span></span>\n\t\t\t\t</span>\n\t\t\t\t<span class="sn-mrp-members-popup-name">\n\t\t\t\t\t',"\n\t\t\t\t</span>\n\t\t\t</a>\n\t\t"])),a.Text.encode(babelHelpers.classPrivateFieldGet(this,h).replace("#user_id#",t.id)),t.id,e,a.Text.encode(t.name))}function L(t){var e=this;a.Event.bind(t,"scroll",(function(){if(t.scrollTop>(t.scrollHeight-t.offsetHeight)/1.5){u(e,g,M).call(e,t);a.Event.unbindAll(t,"scroll")}}))}function y(t){babelHelpers.classPrivateFieldSet(this,d,new s.Loader({target:t,size:40}));babelHelpers.classPrivateFieldGet(this,d).show()}function R(){babelHelpers.classPrivateFieldGet(this,d).destroy()}function C(){var t=this;return new Promise((function(e){a.ajax.runAction("socialnetwork.api.workgroup.getListIncomingUsers",{data:{groupId:babelHelpers.classPrivateFieldGet(t,v),pageNum:babelHelpers.classPrivateFieldGet(t,w)}}).then((function(a){var n,s;babelHelpers.classPrivateFieldSet(t,w,(n=babelHelpers.classPrivateFieldGet(t,w),s=n++,n)),s;e(a.data)}))["catch"]((function(e){u(t,T,N).call(t,"getList",e)}))}))}function N(t,e){console.error("MembershipRequestPanel.MembersList: ".concat(t," error"),e)}function B(t,e){x(t,e);e.add(t)}function q(t,e,a){x(t,e);e.set(t,a)}function x(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function A(t,e,a){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return a}var U=new WeakMap;var X=new WeakSet;var j=function(t){babelHelpers.inherits(e,t);function e(t){var a;babelHelpers.classCallCheck(this,e);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this));B(babelHelpers.assertThisInitialized(a),X);q(babelHelpers.assertThisInitialized(a),U,{writable:true,value:void 0});a.setEventNamespace("BX.Socialnetwork.MRP.PullRequests");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),U,t);return a}babelHelpers.createClass(e,[{key:"getModuleId",value:function t(){return"socialnetwork"}},{key:"getMap",value:function t(){return{workgroup_user_add:A(this,X,D).bind(this),workgroup_user_delete:A(this,X,D).bind(this),workgroup_user_update:A(this,X,D).bind(this)}}}]);return e}(i.EventEmitter);function D(t){if(parseInt(t.params.GROUP_ID,10)===babelHelpers.classPrivateFieldGet(this,U)){this.emit("update")}}var z,O,J,V;function Q(t,e){Y(t,e);e.add(t)}function K(t,e,a){Y(t,e);e.set(t,a)}function Y(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Z(t,e,a){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return a}var $=new WeakMap;var tt=new WeakMap;var et=new WeakMap;var at=new WeakMap;var nt=new WeakMap;var st=new WeakMap;var it=new WeakMap;var rt=new WeakMap;var lt=new WeakSet;var ct=new WeakSet;var ot=new WeakSet;var pt=new WeakSet;var ut=new WeakSet;var bt=new WeakSet;var dt=new WeakSet;var vt=new WeakSet;var ht=new WeakSet;var wt=new WeakSet;var mt=new WeakSet;var ft=new WeakSet;var gt=new WeakSet;var _t=new WeakSet;var St=new WeakSet;var Pt=new WeakSet;var kt=function(){function t(e){babelHelpers.classCallCheck(this,t);Q(this,Pt);Q(this,St);Q(this,_t);Q(this,gt);Q(this,ft);Q(this,mt);Q(this,wt);Q(this,ht);Q(this,vt);Q(this,dt);Q(this,bt);Q(this,ut);Q(this,pt);Q(this,ot);Q(this,ct);Q(this,lt);K(this,$,{writable:true,value:void 0});K(this,tt,{writable:true,value:void 0});K(this,et,{writable:true,value:void 0});K(this,at,{writable:true,value:void 0});K(this,nt,{writable:true,value:void 0});K(this,st,{writable:true,value:void 0});K(this,it,{writable:true,value:void 0});K(this,rt,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,$,BX.SidePanel.Instance);babelHelpers.classPrivateFieldSet(this,tt,a.Type.isInteger(parseInt(e.groupId,10))?parseInt(e.groupId,10):0);babelHelpers.classPrivateFieldSet(this,et,e.pathToUser);babelHelpers.classPrivateFieldSet(this,at,e.pathToUsers);babelHelpers.classPrivateFieldSet(this,nt,false);babelHelpers.classPrivateFieldSet(this,rt,null);Z(this,lt,Ht).call(this)}babelHelpers.createClass(t,[{key:"renderTo",value:function t(e){if(!a.Type.isDomNode(e)){throw new Error("BX.Socialnetwork.Spaces.MembershipRequestPanel: HTMLElement for render not found")}babelHelpers.classPrivateFieldSet(this,it,e);Z(this,pt,It).call(this,babelHelpers.classPrivateFieldGet(this,it),Z(this,ct,Ft).call(this))}}]);return t}();function Ht(){var t=new j(babelHelpers.classPrivateFieldGet(this,tt));t.subscribe("update",Z(this,ot,Tt).bind(this));e.PULL.subscribe(t)}function Ft(){var t=this;return a.ajax.runAction("socialnetwork.api.workgroup.get",{data:{params:{select:["LIST_OF_MEMBERS_AWAITING_INVITE","COUNTERS"],groupId:babelHelpers.classPrivateFieldGet(this,tt)}}}).then((function(t){return{listAwaitingMembers:t.data.LIST_OF_MEMBERS_AWAITING_INVITE,counters:t.data.COUNTERS}}))["catch"]((function(e){Z(t,Pt,xt).call(t,"getData",e)}))}function Tt(){babelHelpers.classPrivateFieldSet(this,st,null);Z(this,pt,It).call(this,babelHelpers.classPrivateFieldGet(this,it),Z(this,ct,Ft).call(this))}function It(t,e){var n=this;e.then((function(e){a.Dom.clean(t);var s=e.listAwaitingMembers;if(s.length>0){if(s.length>1){var i=parseInt(e.counters.workgroup_requests_in,10);a.Dom.append(Z(n,dt,Wt).call(n,i,s),t)}else{a.Dom.append(Z(n,bt,Mt).call(n,s[0]),t)}}}))}function Et(){a.Dom.remove(babelHelpers.classPrivateFieldGet(this,rt))}function Mt(t){var e="sn-mrp-single-accept-btn";var n="sn-mrp-single-reject-btn";babelHelpers.classPrivateFieldSet(this,rt,a.Tag.render(z||(z=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sn-spaces__warning">\n\t\t\t\t<div class="sn-spaces__warning-icon">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="sn-spaces__warning-info">\n\t\t\t\t\t<div class="sn-spaces__warning-info_count">1</div>\n\t\t\t\t\t<div class="sn-spaces__warning-info_text">\n\t\t\t\t\t\t','\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="sn-spaces__warning-btns">\n\t\t\t\t\t<button\n\t\t\t\t\t\tdata-id="','"\n\t\t\t\t\t\tclass="ui-btn ui-btn-xs ui-btn-success ui-btn-no-caps ui-btn-round"\n\t\t\t\t\t>\n\t\t\t\t\t\t','\n\t\t\t\t\t</button>\n\t\t\t\t\t<button\n\t\t\t\t\t\tdata-id="','"\n\t\t\t\t\t\tclass="ui-btn ui-btn-xs ui-btn-light ui-btn-no-caps ui-btn-round"\n\t\t\t\t\t>\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),Z(this,vt,Gt).call(this,t.photo),a.Loc.getMessage("SN_MRP_SINGLE_LABEL").replace("#id#","sn-mrp-member-profile-link").replace("#class#","sn-spaces__warning-info_link").replace("#path#",a.Text.encode(babelHelpers.classPrivateFieldGet(this,et).replace("#user_id#",t.id))).replace("#name#",a.Text.encode(t.name)),e,a.Loc.getMessage("SN_MRP_SINGLE_ACCEPT_BTN"),n,a.Loc.getMessage("SN_MRP_SINGLE_REJECT_BTN")));var s=babelHelpers.classPrivateFieldGet(this,rt).querySelector("[data-id='".concat(e,"']"));a.Event.bind(s,"click",Z(this,wt,yt).bind(this,s,[t.id]));var i=babelHelpers.classPrivateFieldGet(this,rt).querySelector("[data-id='".concat(n,"']"));a.Event.bind(i,"click",Z(this,mt,Rt).bind(this,i,[t.id]));return babelHelpers.classPrivateFieldGet(this,rt)}function Wt(t,e){var n=this;var s=5;var i=t-s;var r=e.slice(0,s);var l="sn-mrp-multiple-photos";var c="sn-mrp-multiple-accept-btn";var o="sn-mrp-multiple-reject-btn";babelHelpers.classPrivateFieldSet(this,rt,a.Tag.render(O||(O=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sn-spaces__warning">\n\t\t\t\t<div\n\t\t\t\t\tdata-id="','"\n\t\t\t\t\tclass="sn-spaces__warning-icon"\n\t\t\t\t\tstyle="cursor: pointer;"\n\t\t\t\t>\n\t\t\t\t\t','\n\t\t\t\t\t<div\n\t\t\t\t\t\tstyle="','"\n\t\t\t\t\t\tclass="sn-spaces__warning-icon_element --count"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class="sn-spaces__warning-icon_element-plus">+</span>\n\t\t\t\t\t\t<span class="sn-spaces__warning-icon_element-number">','</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="sn-spaces__warning-info">\n\t\t\t\t\t<div class="sn-spaces__warning-info_count">\n\t\t\t\t\t\t','\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="sn-spaces__warning-info_text">\n\t\t\t\t\t\t','\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="sn-spaces__warning-btns">\n\t\t\t\t\t<button\n\t\t\t\t\t\tdata-id="','"\n\t\t\t\t\t\tclass="ui-btn ui-btn-xs ui-btn-success ui-btn-no-caps ui-btn-round"\n\t\t\t\t\t>\n\t\t\t\t\t\t','\n\t\t\t\t\t</button>\n\t\t\t\t\t<button\n\t\t\t\t\t\tdata-id="','"\n\t\t\t\t\t\tclass="ui-btn ui-btn-xs ui-btn-light ui-btn-no-caps ui-btn-round"\n\t\t\t\t\t>\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),l,r.map((function(t){return Z(n,vt,Gt).call(n,t.photo)})),i>0?"":"display: none;",i,parseInt(t,10),a.Loc.getMessage("SN_MRP_MULTIPLE_LABEL"),c,a.Loc.getMessage("SN_MRP_MULTIPLE_ACCEPT_BTN"),o,a.Loc.getMessage("SN_MRP_MULTIPLE_REJECT_BTN")));var p=babelHelpers.classPrivateFieldGet(this,rt).querySelector("[data-id='".concat(l,"']"));a.Event.bind(p,"click",(function(){return Z(n,ht,Lt).call(n,p)}));var u=babelHelpers.classPrivateFieldGet(this,rt).querySelector("[data-id='".concat(c,"']"));a.Event.bind(u,"click",(function(){Z(n,wt,yt).call(n,u,e.map((function(t){return t.id})))}));var b=babelHelpers.classPrivateFieldGet(this,rt).querySelector("[data-id='".concat(o,"']"));a.Event.bind(b,"click",Z(this,ft,Ct).bind(this,"in"));return babelHelpers.classPrivateFieldGet(this,rt)}function Gt(t){if(t){return a.Tag.render(J||(J=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div\n\t\t\t\t\tclass="sn-spaces__warning-icon_element"\n\t\t\t\t\tstyle="background-image: url(\'',"');\"\n\t\t\t\t></div>\n\t\t\t"])),encodeURI(t))}return a.Tag.render(V||(V=babelHelpers.taggedTemplateLiteral(['<div class="sn-spaces__warning-icon_element ui-icon ui-icon-common-user ui-icon-xs"><i></i></div>'])))}function Lt(t){if(!babelHelpers.classPrivateFieldGet(this,st)){babelHelpers.classPrivateFieldSet(this,st,new I({groupId:babelHelpers.classPrivateFieldGet(this,tt),bindElement:t,pathToUser:babelHelpers.classPrivateFieldGet(this,et)}))}babelHelpers.classPrivateFieldGet(this,st).show()}function yt(t,e){var n=this;if(Z(this,gt,Nt).call(this)){return}Z(this,_t,Bt).call(this,t);a.ajax.runAction("socialnetwork.api.workgroup.acceptIncomingRequest",{data:{groupId:babelHelpers.classPrivateFieldGet(this,tt),userIds:e}}).then((function(e){Z(n,ut,Et).call(n);Z(n,St,qt).call(n,t)}))["catch"]((function(e){Z(n,Pt,xt).call(n,"acceptIncomingRequest",e);Z(n,St,qt).call(n,t)}))}function Rt(t,e){var n=this;if(Z(this,gt,Nt).call(this)){return}Z(this,_t,Bt).call(this,t);a.ajax.runAction("socialnetwork.api.workgroup.rejectIncomingRequest",{data:{groupId:babelHelpers.classPrivateFieldGet(this,tt),userIds:e}}).then((function(e){Z(n,ut,Et).call(n);Z(n,St,qt).call(n,t)}))["catch"]((function(e){Z(n,Pt,xt).call(n,"acceptIncomingRequest",e);Z(n,St,qt).call(n,t)}))}function Ct(t){var e={all:"members",in:"requests_in",out:"requests_out"};var n=new a.Uri(babelHelpers.classPrivateFieldGet(this,at));n.setQueryParams({mode:e[t]});babelHelpers.classPrivateFieldGet(this,$).open(n.toString(),{width:1200,cacheable:false,loader:"group-users-loader"})}function Nt(){return babelHelpers.classPrivateFieldGet(this,nt)}function Bt(t){babelHelpers.classPrivateFieldSet(this,nt,true);a.Dom.addClass(t,"ui-btn-wait")}function qt(t){babelHelpers.classPrivateFieldSet(this,nt,false);a.Dom.removeClass(t,"ui-btn-wait")}function xt(t,e){console.error("MembershipRequestPanel: ".concat(t," error"),e)}t.MembershipRequestPanel=kt})(this.BX.Socialnetwork=this.BX.Socialnetwork||{},BX,BX,BX.Main,BX,BX.Event);
//# sourceMappingURL=membership-request-panel.bundle.map.js