{"version":3,"file":"commentaux.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Type, Loc, Text, Dom } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { RenderParts } from 'socialnetwork.renderparts';\n\nexport class CommentAux\n{\n\tstatic postEventTypeList = [\n\t\t'BLOG_POST',\n\t\t'FORUM_TOPIC',\n\t\t'TASK',\n\t\t'TIMEMAN_ENTRY',\n\t\t'TIMEMAN_REPORT',\n\t\t'LOG_ENTRY',\n\t\t'PHOTO_ALBUM',\n\t\t'PHOTO_PHOTO',\n\t\t'WIKI',\n\t\t'LISTS_NEW_ELEMENT',\n\t\t'CALENDAR_EVENT',\n\t\t'INTRANET_NEW_USER',\n\t\t'BITRIX24_NEW_USER',\n\t];\n\n\tstatic commentEventTypeList = [\n\t\t'BLOG_COMMENT',\n\t\t'FORUM_POST',\n\t\t'LOG_COMMENT'\n\t];\n\n\tstatic typesList = {\n\t\tshare: 'share',\n\t\tcreateentity: 'createentity',\n\t\tcreatetask: 'createtask',\n\t\tfileversion: 'fileversion',\n\t\ttaskinfo: 'taskinfo',\n\t};\n\n\tstatic init(params)\n\t{\n\t\tEventEmitter.emit('BX.CommentAux.initialize', new BaseEvent({\n\t\t\tcompatData: [],\n\t\t}));\n\n\t\tRenderParts.init(params);\n\t}\n\n\tstatic isSourcePost(eventType)\n\t{\n\t\treturn this.postEventTypeList.includes(eventType);\n\t}\n\n\tstatic isSourceComment(eventType)\n\t{\n\n\t\treturn this.commentEventTypeList.includes(eventType);\n\t}\n\n\tstatic getTypesList()\n\t{\n\t\treturn Object.values(this.typesList);\n\t}\n\n\tstatic getLiveTypesList()\n\t{\n\t\treturn [\n\t\t\tthis.typesList.createentity,\n\t\t\tthis.typesList.createtask,\n\t\t\tthis.typesList.fileversion,\n\t\t\tthis.typesList.taskinfo,\n\t\t];\n\t}\n\n\tstatic getLiveText(type, params)\n\t{\n\t\tlet result = '';\n\t\tlet sourceEntityType = '';\n\t\tlet sourceEntityLink = '';\n\t\tlet suffix = '';\n\n\t\tif (type.toLowerCase() === this.typesList.share)\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isPlainObject(params)\n\t\t\t\t&& params.length > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult = Loc.getMessage(params.length === 1 ? 'SONET_COMMENTAUX_JS_SHARE_TEXT' : 'SONET_COMMENTAUX_JS_SHARE_TEXT_1');\n\t\t\t\tresult = result.replace('#SHARE_LIST#', this.getShareList(params));\n\t\t\t}\n\t\t}\n\t\telse if (type.toLowerCase() === this.typesList.createentity)\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isPlainObject(params)\n\t\t\t\t&& Type.isStringFilled(params.entityType)\n\t\t\t\t&& !Type.isUndefined(params.entityId)\n\t\t\t\t&& parseInt(params.entityId) > 0\n\t\t\t\t&& Type.isStringFilled(params.entityName)\n\t\t\t\t&& Type.isStringFilled(params.sourceEntityType)\n\t\t\t\t&& !Type.isUndefined(params.sourceEntityId)\n\t\t\t\t&& parseInt(params.sourceEntityId) > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst entityName = this.renderEntity({\n\t\t\t\t\tENTITY_TYPE: params.entityType,\n\t\t\t\t\tNAME: params.entityName,\n\t\t\t\t\tLINK: (Type.isStringFilled(params.entityUrl) ? params.entityUrl : ''),\n\t\t\t\t\tVISIBILITY: this.getEntityVisibility(params),\n\t\t\t\t});\n\n\t\t\t\tsourceEntityLink = (Type.isStringFilled(params.sourceEntityLink) ? params.sourceEntityLink : '');\n\t\t\t\tsourceEntityLink = (!RenderParts.mobile ? `<a target=\"_blank\" href=\"${sourceEntityLink}\">` : '');\n\n\t\t\t\tif (this.isSourcePost(params.sourceEntityType))\n\t\t\t\t{\n\t\t\t\t\tsourceEntityType = (Type.isStringFilled(params.sourceEntityType) ? params.sourceEntityType : 'BLOG_POST');\n\t\t\t\t\tsuffix = (Type.isStringFilled(params.suffix) ? `_${params.suffix}` : '');\n\n\t\t\t\t\tsourceEntityType = `${sourceEntityType}${suffix}`;\n\t\t\t\t\tresult = Loc.getMessage(`SONET_COMMENTAUX_JS_CREATEENTITY_POST_${sourceEntityType}`)\n\t\t\t\t\t\t.replace('#ENTITY_CREATED#', this.getEntityCreatedMessage(params.entityType))\n\t\t\t\t\t\t.replace('#ENTITY_NAME#', entityName)\n\t\t\t\t\t\t.replace('#A_BEGIN#', sourceEntityLink)\n\t\t\t\t\t\t.replace('#A_END#', (!RenderParts.mobile ? '</a>' : ''));\n\t\t\t\t}\n\t\t\t\telse if (this.isSourceComment(params.sourceEntityType))\n\t\t\t\t{\n\t\t\t\t\tsuffix = (Type.isStringFilled(params.suffix) ? `_${params.suffix}` : '');\n\t\t\t\t\tsourceEntityType = (Type.isStringFilled(params.sourceEntityType) ? `${params.sourceEntityType}${suffix}` : 'BLOG_COMMENT');\n\n\t\t\t\t\tresult = Loc.getMessage(`SONET_COMMENTAUX_JS_CREATEENTITY_COMMENT_${sourceEntityType}`)\n\t\t\t\t\t\t.replace('#ENTITY_CREATED#', this.getEntityCreatedMessage(params.entityType))\n\t\t\t\t\t\t.replace('#ENTITY_NAME#', entityName)\n\t\t\t\t\t\t.replace('#A_BEGIN#', sourceEntityLink)\n\t\t\t\t\t\t.replace('#A_END#', (!RenderParts.mobile ? '</a>' : ''));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (type.toLowerCase() === this.typesList.createtask)\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isPlainObject(params)\n\t\t\t\t&& !Type.isUndefined(params.taskId)\n\t\t\t\t&& parseInt(params.taskId) > 0\n\t\t\t\t&& Type.isStringFilled(params.taskName)\n\t\t\t\t&& Type.isStringFilled(params.sourceEntityType)\n\t\t\t\t&& !Type.isUndefined(params.sourceEntityId)\n\t\t\t\t&& parseInt(params.sourceEntityId) > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst task = this.renderEntity({\n\t\t\t\t\tENTITY_TYPE: 'task',\n\t\t\t\t\tNAME: params.taskName,\n\t\t\t\t\tLINK: (Type.isStringFilled(params.taskUrl) ? params.taskUrl : ''),\n\t\t\t\t\tVISIBILITY: {\n\t\t\t\t\t\tuserId: (!Type.isUndefined(params.taskResponsibleId) && parseInt(params.taskResponsibleId) > 0 ? parseInt(params.taskResponsibleId) : 0)\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tif (this.isSourcePost(params.sourceEntityType))\n\t\t\t\t{\n\t\t\t\t\tsourceEntityType = (Type.isStringFilled(params.sourceEntityType) ? params.sourceEntityType : 'BLOG_POST');\n\t\t\t\t\tsuffix = (Type.isStringFilled(params.suffix) ? `_${params.suffix}` : '');\n\t\t\t\t\tsourceEntityLink = (Type.isStringFilled(params.sourceEntityLink) ? params.sourceEntityLink : '');\n\n\t\t\t\t\tresult = Loc.getMessage(`SONET_COMMENTAUX_JS_CREATETASK_POST_${sourceEntityType}${suffix}`)\n\t\t\t\t\t\t.replace('#TASK_NAME#', task)\n\t\t\t\t\t\t.replace('#A_BEGIN#', (!RenderParts.mobile ? `<a target=\"_blank\" href=\"${sourceEntityLink}\">` : ''))\n\t\t\t\t\t\t.replace('#A_END#', (!RenderParts.mobile ? '</a>' : ''));\n\t\t\t\t}\n\t\t\t\telse if (this.isSourceComment(params.sourceEntityType))\n\t\t\t\t{\n\t\t\t\t\tsuffix = (Type.isStringFilled(params.suffix) ? `_${params.suffix}` : '');\n\t\t\t\t\tsourceEntityType = (Type.isStringFilled(params.sourceEntityType) ? `${params.sourceEntityType}${suffix}` : 'BLOG_COMMENT');\n\t\t\t\t\tsourceEntityLink = (Type.isStringFilled(params.sourceEntityLink) ? params.sourceEntityLink : '');\n\n\t\t\t\t\tresult = Loc.getMessage(`SONET_COMMENTAUX_JS_CREATETASK_COMMENT_${sourceEntityType}`)\n\t\t\t\t\t\t.replace('#TASK_NAME#', task)\n\t\t\t\t\t\t.replace('#A_BEGIN#', (!RenderParts.mobile ? `<a target=\"_blank\" href=\"${sourceEntityLink}\">` : ''))\n\t\t\t\t\t\t.replace('#A_END#', (!RenderParts.mobile ? '</a>' : '')\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (type.toLowerCase() === this.typesList.fileversion)\n\t\t{\n\t\t\tconst messageType = (\n\t\t\t\tType.isPlainObject(params)\n\t\t\t\t&& !Type.isUndefined(params.isEnabledKeepVersion)\n\t\t\t\t&& params.isEnabledKeepVersion\n\t\t\t\t\t? 'SONET_COMMENTAUX_JS_FILEVERSION_TEXT'\n\t\t\t\t\t: 'SONET_COMMENTAUX_JS_HEAD_FILEVERSION_TEXT'\n\t\t\t);\n\t\t\tconst userGenderSuffix = (\n\t\t\t\tType.isPlainObject(params)\n\t\t\t\t&& Type.isStringFilled(params.userGender)\n\t\t\t\t\t? `_${params.userGender}`\n\t\t\t\t\t: ''\n\t\t\t);\n\t\t\tresult = Loc.getMessage(`${messageType}${userGenderSuffix}`);\n\t\t}\n\t\telse if (type.toLowerCase() === this.typesList.taskinfo)\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isPlainObject(params)\n\t\t\t\t&& Type.isStringFilled(params.JSON)\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst textList = [];\n\t\t\t\tlet partsData = {};\n\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tpartsData = JSON.parse(Text.decode(params.JSON));\n\t\t\t\t}\n\t\t\t\tcatch(e)\n\t\t\t\t{\n\t\t\t\t\tpartsData = {};\n\t\t\t\t}\n\n\t\t\t\tType.isArray(partsData)\n\t\t\t\t{\n\t\t\t\t\tpartsData.forEach((partsItems) => {\n\t\t\t\t\t\tif (!Type.isArray(partsItems))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tpartsItems.forEach((item) => {\n\t\t\t\t\t\t\tconst messageCode = item[0];\n\n\t\t\t\t\t\t\tif (!Type.isStringFilled(messageCode))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\ttextList.push(this.renderEntity({\n\t\t\t\t\t\t\t\tENTITY_TYPE: 'TASK_COMMENT_PART',\n\t\t\t\t\t\t\t\tCODE: messageCode,\n\t\t\t\t\t\t\t\tREPLACE_LIST: (Type.isPlainObject(item[1]) ? item[1] : {}),\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (textList.length)\n\t\t\t\t{\n\t\t\t\t\tresult = textList.join('<br>');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic getShareList(params)\n\t{\n\t\tlet result = '';\n\t\tconst renderedShareList = [];\n\n\t\tif (\n\t\t\t!Type.isPlainObject(params)\n\t\t\t|| params.length <= 0\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tObject.values(params).forEach((value) => {\n\t\t\trenderedShareList.push(this.renderEntity(value));\n\t\t});\n\n\t\tresult = renderedShareList.join(', ');\n\n\t\treturn result;\n\t}\n\n\tstatic renderEntity(entity)\n\t{\n\t\tlet result = '';\n\n\t\tif (\n\t\t\t!Type.isPlainObject(entity)\n\t\t\t|| !Type.isStringFilled(entity.ENTITY_TYPE)\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tswitch (entity.ENTITY_TYPE.toUpperCase())\n\t\t{\n\t\t\tcase 'U':\n\t\t\t\tresult = RenderParts.getNodeU(entity);\n\t\t\t\tbreak;\n\t\t\tcase 'UA':\n\t\t\t\tresult = RenderParts.getNodeUA();\n\t\t\t\tbreak;\n\t\t\tcase 'SG':\n\t\t\t\tresult = RenderParts.getNodeSG(entity);\n\t\t\t\tbreak;\n\t\t\tcase 'DR':\n\t\t\t\tresult = RenderParts.getNodeDR(entity);\n\t\t\t\tbreak;\n\t\t\tcase 'TASK':\n\t\t\t\tresult = RenderParts.getNodeTask(entity);\n\t\t\t\tbreak;\n\t\t\tcase 'BLOG_POST':\n\t\t\t\tresult = RenderParts.getNodePost(entity);\n\t\t\t\tbreak;\n\t\t\tcase 'CALENDAR_EVENT':\n\t\t\t\tresult = RenderParts.getNodeCalendarEvent(entity);\n\t\t\t\tbreak;\n\t\t\tcase 'TASK_COMMENT_PART':\n\t\t\t\tresult = RenderParts.getTaskCommentPart(entity);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\n\t\tconst tmp = Dom.create('div', {\n\t\t\tchildren: [\n\t\t\t\tresult,\n\t\t\t]\n\t\t});\n\n\t\tresult = tmp.innerHTML;\n\t\tDom.clean(tmp);\n\t\tDom.remove(tmp);\n\n\t\treturn result;\n\t}\n\n\tstatic getEntityCreatedMessage(entityType)\n\t{\n\t\tlet result = '';\n\n\t\tif (!Type.isStringFilled(entityType))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tswitch (entityType)\n\t\t{\n\t\t\tcase 'TASK':\n\t\t\t\tresult = Loc.getMessage('SONET_COMMENTAUX_JS_CREATEENTITY_ENTITY_CREATED_TASK');\n\t\t\t\tbreak;\n\t\t\tcase 'BLOG_POST':\n\t\t\t\tresult = Loc.getMessage('SONET_COMMENTAUX_JS_CREATEENTITY_ENTITY_CREATED_BLOG_POST');\n\t\t\t\tbreak;\n\t\t\tcase 'CALENDAR_EVENT':\n\t\t\t\tresult = Loc.getMessage('SONET_COMMENTAUX_JS_CREATEENTITY_ENTITY_CREATED_CALENDAR_EVENT');\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic getEntityTypeName(entityType)\n\t{\n\t\tlet result = '';\n\n\t\tif (!Type.isStringFilled(entityType))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tswitch (entityType)\n\t\t{\n\t\t\tcase 'TASK':\n\t\t\t\tresult = Loc.getMessage('SONET_COMMENTAUX_CREATEENTITY_ENTITY_TASK');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic getEntityVisibility(params)\n\t{\n\t\tconst result = {};\n\t\tconst currentUserId = parseInt(Loc.getMessage('USER_ID'));\n\n\t\tif (params.entityType.toUpperCase() === 'TASK')\n\t\t{\n\t\t\tresult.userId = (\n\t\t\t\t!Type.isUndefined(params.taskResponsibleId)\n\t\t\t\t&& parseInt(params.taskResponsibleId) > 0\n\t\t\t\t\t? parseInt(params.taskResponsibleId)\n\t\t\t\t\t: 0\n\t\t\t);\n\t\t}\n\t\telse if (params.entityType.toUpperCase() === 'BLOG_POST')\n\t\t{\n\t\t\tresult.available = (\n\t\t\t\tType.isArray(params.socNetPermissions)\n\t\t\t\t&& (\n\t\t\t\t\tparams.socNetPermissions.indexOf('G2') > -1\n\t\t\t\t\t|| params.socNetPermissions.indexOf('UA') > -1\n\t\t\t\t\t|| params.socNetPermissions.indexOf(`U${currentUserId}`) > -1\n\t\t\t\t\t|| params.socNetPermissions.indexOf(`US${currentUserId}`) > -1\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\telse if (params.entityType.toUpperCase() === 'CALENDAR_EVENT')\n\t\t{\n\t\t\tresult.available = (\n\t\t\t\tType.isArray(params.attendees)\n\t\t\t\t&& params.attendees.indexOf(currentUserId) > -1\n\t\t\t);\n\t\t}\n\n\t\treturn result;\n\t}\n}\n"],"names":["CommentAux","params","EventEmitter","emit","BaseEvent","compatData","RenderParts","init","eventType","postEventTypeList","includes","commentEventTypeList","Object","values","typesList","createentity","createtask","fileversion","taskinfo","type","result","sourceEntityType","sourceEntityLink","suffix","toLowerCase","share","Type","isPlainObject","length","Loc","getMessage","replace","getShareList","isStringFilled","entityType","isUndefined","entityId","parseInt","entityName","sourceEntityId","renderEntity","ENTITY_TYPE","NAME","LINK","entityUrl","VISIBILITY","getEntityVisibility","mobile","isSourcePost","getEntityCreatedMessage","isSourceComment","taskId","taskName","task","taskUrl","userId","taskResponsibleId","messageType","isEnabledKeepVersion","userGenderSuffix","userGender","JSON","textList","partsData","parse","Text","decode","e","isArray","forEach","partsItems","item","messageCode","push","CODE","REPLACE_LIST","join","renderedShareList","value","entity","toUpperCase","getNodeU","getNodeUA","getNodeSG","getNodeDR","getNodeTask","getNodePost","getNodeCalendarEvent","getTaskCommentPart","tmp","Dom","create","children","innerHTML","clean","remove","currentUserId","available","socNetPermissions","indexOf","attendees"],"mappings":"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"}