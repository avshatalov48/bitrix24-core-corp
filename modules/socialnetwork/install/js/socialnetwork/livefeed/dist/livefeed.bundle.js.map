{"version":3,"file":"livefeed.bundle.js","sources":["../src/utils.js","../src/pinned.js","../src/post.js","../src/feed.js"],"sourcesContent":["class Utils\n{\n\tstatic setStyle(node, styles)\n\t{\n\t\tObject.entries(styles).forEach(([key, value]) => {\n\t\t\tnode.style[key] = value;\n\t\t});\n\t}\n}\n\nexport {\n\tUtils\n};\n","import { ajax, Event, Type, Loc, Dom, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\nimport { Utils } from \"./utils\";\n\nclass PinnedPanel\n{\n\tconstructor()\n\t{\n\t\tthis.class = {\n\t\t\tpin: 'feed-post-pin',\n\n\t\t\tpost: 'feed-item-wrap',\n\t\t\tpostHide: 'feed-item-wrap-hide',\n\t\t\tpostComments: 'feed-comments-block',\n\n\t\t\tpostPinned: 'feed-post-block-pinned',\n\t\t\tpostPinnedHide: 'feed-post-block-pinned-hide',\n\t\t\tpostPinActive: 'feed-post-block-pin-active',\n\t\t\tpostUnfollowed: 'feed-post-block-unfollowed',\n\n\t\t\tpostExpanding: 'feed-post-block-expand',\n\n\t\t\tpanelCollapsed: 'feed-pinned-panel-collapsed',\n\t\t\tpanelNonEmpty: 'feed-pinned-panel-nonempty',\n\t\t\tpanelPosts: 'feed-pinned-panel-posts',\n\n\t\t\tcollapsedPanel: 'feed-post-collapsed-panel',\n\t\t\tcollapsedPanelExpand: 'feed-post-collapsed-panel-right',\n\t\t\tcollapsedPanelCounterPostsValue: 'feed-post-collapsed-panel-count-posts',\n\t\t\tcollapsedPanelCounterComments: 'feed-post-collapsed-panel-box-comments',\n\t\t\tcollapsedPanelCounterCommentsValue: 'feed-post-collapsed-panel-count-comments-value',\n\t\t\tcollapsedPanelCounterCommentsShown: 'feed-post-collapsed-panel-box-shown',\n\t\t\tcollapsedPanelCounterCommentsValueNew: 'feed-inform-comments-pinned-new',\n\t\t\tcollapsedPanelCounterCommentsValueNewValue: 'feed-inform-comments-pinned-new-value',\n\t\t\tcollapsedPanelCounterCommentsValueNewActive: 'feed-inform-comments-pinned-new-active',\n\t\t\tcollapsedPanelCounterCommentsValueOld: 'feed-inform-comments-pinned-old',\n\t\t\tcollapsedPanelCounterCommentsValueAll: 'feed-inform-comments-pinned-all',\n\t\t\tcollapsedPanelShow: 'feed-post-collapsed-panel--show',\n\t\t\tcollapsedPanelHide: 'feed-post-collapsed-panel--hide',\n\n\t\t\tcancelPanel: 'feed-post-cancel-pinned-panel',\n\t\t\tcancelPanelButton: 'feed-post-cancel-pinned-btn',\n\t\t\tcancelPanelLabel: 'feed-post-cancel-pinned-label'\n\t\t};\n\n\t\tthis.panelInitialized = false;\n\t\tthis.postsInitialized = false;\n\t\tthis.handlePostClick = this.handlePostClick.bind(this);\n\n\t\tthis.init();\n\t}\n\n\tresetFlags()\n\t{\n\t\tthis.panelInitialized = false;\n\t\tthis.postsInitialized = false;\n\t}\n\n\tinit()\n\t{\n\t\tthis.options = {};\n\n\t\tthis.initPanel();\n\t\tthis.initPosts();\n\t\tthis.initEvents();\n\t\tEventEmitter.subscribe('onFrameDataProcessed', () => {\n\t\t\tthis.initPanel();\n\t\t\tthis.initPosts();\n\t\t});\n\t}\n\n\tsetOptions(options)\n\t{\n\t\tthis.options = { ...this.options, ...options };\n\t}\n\n\tgetOption(optionName)\n\t{\n\t\treturn this.options[optionName];\n\t}\n\n\tinitPanel()\n\t{\n\t\tif (this.panelInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.panelInitialized = true;\n\n\t\tthis.adjustCollapsedPostsPanel();\n\n\t\tEvent.bind(this.getCollapsedPanelNode(), 'click', () => {\n\t\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\t\tif (!pinnedPanelNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst collapsedHeight = pinnedPanelNode.offsetHeight;\n\n\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\theight: collapsedHeight + 'px',\n\t\t\t\ttransition: 'height .5s'\n\t\t\t});\n\t\t\tsetTimeout(() => {\n\t\t\t\tpinnedPanelNode.style = '';\n\t\t\t}, 550);\n\t\t\tthis.hideCollapsedPanel();\n\t\t});\n\n\t\tEvent.bind(pinnedPanelNode, 'click', (event) => {\n\t\t\tconst likeClicked = event.target.classList.contains('feed-inform-ilike') || event.target.closest('.feed-inform-ilike') !== null;\n\t\t\tconst followClicked = event.target.classList.contains('feed-inform-follow') || event.target.closest('.feed-inform-follow') !== null;\n\t\t\tconst menuClicked = (\n\t\t\t\tevent.target.classList.contains('feed-post-more-link')\n\t\t\t\t|| event.target.closest('.feed-post-more-link') !== null\n\t\t\t\t|| event.target.classList.contains('feed-post-right-top-menu')\n\t\t\t);\n\t\t\tconst contentViewClicked = event.target.classList.contains('feed-inform-contentview') || event.target.closest('.feed-inform-contentview') !== null;\n\t\t\tconst pinClicked = event.target.classList.contains(`${this.class.pin}`) || event.target.closest(`.${this.class.pin}`) !== null;\n\t\t\tconst collapseClicked = event.target.classList.contains('feed-post-pinned-link-collapse');\n\t\t\tconst commentsClicked = event.target.classList.contains('feed-inform-comments-pinned') || event.target.closest('.feed-inform-comments-pinned') !== null;\n\n\t\t\tlet postNode = null;\n\n\t\t\tif (event.target.classList.contains('feed-post-block'))\n\t\t\t{\n\t\t\t\tpostNode = event.target;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpostNode = event.target.closest('.feed-post-block');\n\t\t\t}\n\n\t\t\tif (!postNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (postNode.classList.contains(`${this.class.postPinned}`))\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\t!likeClicked\n\t\t\t\t\t&& !followClicked\n\t\t\t\t\t&& !menuClicked\n\t\t\t\t\t&& !contentViewClicked\n\t\t\t\t\t&& !pinClicked\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tpostNode.classList.remove(`${this.class.postPinned}`);\n\n\t\t\t\t\tconst menuId = postNode.getAttribute('data-menu-id');\n\n\t\t\t\t\tif (menuId)\n\t\t\t\t\t{\n\t\t\t\t\t\tMenuManager.destroy(menuId);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst event = new BaseEvent({\n\t\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\t\trootNode: postNode\n\t\t\t\t\t\t}],\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\trootNode: postNode\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tEventEmitter.emit('BX.Livefeed:recalculateComments', event);\n\t\t\t\t}\n\n\t\t\t\tif (commentsClicked)\n\t\t\t\t{\n\t\t\t\t\tconst anchorNode = postNode.querySelector(`.${this.class.postComments} a[name=comments]`);\n\n\t\t\t\t\tif (anchorNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst position = Dom.getPosition(anchorNode);\n\t\t\t\t\t\twindow.scrollTo(0, position.top - 200);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (collapseClicked)\n\t\t\t{\n\t\t\t\tpostNode.classList.add(`${this.class.postPinned}`);\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t});\n\t}\n\n\tinitPosts()\n\t{\n\t\tif (this.postsInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst postList = document.querySelectorAll('[data-livefeed-post-pinned]');\n\t\tif (postList.length > 0)\n\t\t{\n\t\t\tthis.postsInitialized = true;\n\t\t}\n\n\t\tArray.from(postList).forEach((post) => {\n\t\t\tEvent.unbind(post, 'click', this.handlePostClick);\n\t\t\tEvent.bind(post, 'click', this.handlePostClick);\n\t\t});\n\t}\n\n\thandlePostClick(event)\n\t{\n\t\tif (!event.target.classList.contains(`${this.class.pin}`))\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst post = event.target.closest('[data-livefeed-id]');\n\n\t\tif (!post)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newState = (post.getAttribute('data-livefeed-post-pinned') === 'Y' ? 'N' : 'Y');\n\t\tconst logId = parseInt(post.getAttribute('data-livefeed-id'));\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.changePinned({\n\t\t\tlogId: logId,\n\t\t\tnewState: newState,\n\t\t\tevent: event\n\t\t\t\t}).then(() => {\n\t\t});\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('OnUCCommentWasRead', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, options ] = event.getData();\n\t\t\tconst { oldValue, newValue } = this.getCommentsData(xmlId);\n\n\t\t\tif (!!options.new)\n\t\t\t{\n\t\t\t\tthis.setCommentsData(xmlId, {\n\t\t\t\t\tnewValue: (Type.isInteger(newValue) ? (newValue - 1) : 0),\n\t\t\t\t\toldValue: (Type.isInteger(oldValue) ? (oldValue + 1) : 1)\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.incrementMaxListeners('OnUCCommentWasPulled');\n\t\tEventEmitter.subscribe('OnUCCommentWasPulled', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ id, data, params ] = event.getData();\n\t\t\tconst [ xmlId, commentId ] = id;\n\t\t\tconst { newValue, oldValue, allValue, follow } = this.getCommentsData(xmlId);\n\n\t\t\tconst commentsData = {\n\t\t\t\tallValue: (Type.isInteger(allValue) ? (allValue + 1) : 1)\n\t\t\t};\n\n\t\t\tif (parseInt(params.AUTHOR.ID) !== parseInt(BX.message('USER_ID')))\n\t\t\t{\n\t\t\t\tcommentsData.newValue = (Type.isInteger(newValue) ? (newValue + 1) : 1);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommentsData.oldValue = (Type.isInteger(oldValue) ? (oldValue + 1) : 1);\n\t\t\t}\n\n\t\t\tthis.setCommentsData(xmlId, commentsData);\n\t\t});\n\n\t\tEventEmitter.subscribe('OnUCommentWasDeleted', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, data ] = event.getData();\n\t\t\tconst { oldValue, allValue } = this.getCommentsData(xmlId);\n\n\t\t\tthis.setCommentsData(xmlId, {\n\t\t\t\tallValue: (Type.isInteger(allValue) ? (allValue - 1) : 0),\n\t\t\t\toldValue: (Type.isInteger(oldValue) ? (oldValue - 1) : 0)\n\t\t\t});\n\t\t});\n\t}\n\n\tchangePinned(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst event = (params.event ? params.event : null);\n\n\t\tlet node = (params.node ? params.node : null);\n\t\tlet newState = (params.newState ? params.newState : null);\n\n\t\tconst panelNode = this.getPanelNode();\n\n\t\tif (\n\t\t\t!node\n\t\t\t&& !event\n\t\t\t&& logId > 0\n\t\t\t&& panelNode\n\t\t)\n\t\t{\n\t\t\tnode = panelNode.querySelector(`.${this.class.post} > [data-livefeed-id=\"${logId}\"]`);\n\t\t}\n\n\t\tif (\n\t\t\t!node\n\t\t\t&& event\n\t\t)\n\t\t{\n\t\t\tnode = event.target;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (\n\t\t\t\t!!this.getOption('pinBlocked') ||\n\t\t\t\t!node\n\t\t\t\t|| !newState\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tthis.setPostState({\n\t\t\t\tnode: node,\n\t\t\t\tstate: newState\n\t\t\t});\n\n\t\t\tajax.runAction('socialnetwork.api.livefeed.logentry.' + (newState === 'Y' ? 'pin' : 'unpin'), {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: logId\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tb24statAction: (newState === 'Y' ? 'pinLivefeedEntry' : 'unpinLivefeedEntry')\n\t\t\t\t}\n\t\t\t}).then(response => {\n\t\t\t\tif (!response.data.success)\n\t\t\t\t{\n\t\t\t\t\tthis.setPostState({\n\t\t\t\t\t\tnode: node,\n\t\t\t\t\t\tstate: (newState === 'Y' ? 'N' : 'Y')\n\t\t\t\t\t});\n\t\t\t\t\treturn resolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.movePost({\n\t\t\t\t\t\tnode: node,\n\t\t\t\t\t\tstate: newState\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\treturn resolve();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, response => {\n\t\t\t\tthis.setPostState({\n\t\t\t\t\tnode: node,\n\t\t\t\t\tstate: (newState === 'Y' ? 'N' : 'Y')\n\t\t\t\t});\n\t\t\t\treturn resolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tsetPostState(params)\n\t{\n\t\tconst state = (params.state ? params.state : null);\n\t\tconst node = (params.node ? params.node : null);\n\n\t\tif (\n\t\t\t!node\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst post = node.closest('[data-livefeed-post-pinned]');\n\t\tif (!post)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpost.setAttribute('data-livefeed-post-pinned', state);\n\n\t\tif (state === 'Y')\n\t\t{\n\t\t\tpost.classList.add(`${this.class.postPinActive}`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpost.classList.remove(`${this.class.postPinActive}`);\n\t\t}\n\n\t\tconst pin = post.querySelector(`.${this.class.pin}`);\n\t\tif (pin)\n\t\t{\n\t\t\tpin.setAttribute('title', Loc.getMessage(`SONET_EXT_LIVEFEED_PIN_TITLE_${state}`));\n\t\t}\n\t}\n\n\tgetPanelNode()\n\t{\n\t\treturn document.querySelector('[data-livefeed-pinned-panel]');\n\t}\n\n\tgetPinnedData(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction('socialnetwork.api.livefeed.logentry.getPinData', {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: logId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).then(response => {\n\t\t\t\treturn resolve(response.data);\n\t\t\t}, response => {\n\t\t\t\treturn reject();\n\t\t\t});\n\t\t})\n\t}\n\n\tmovePost(params)\n\t{\n\t\tconst state = (params.state ? params.state : null);\n\t\tconst node = (params.node ? params.node : null);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (\n\t\t\t\t!node\n\t\t\t\t|| !['Y', 'N'].includes(state)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst post = node.closest('[data-livefeed-post-pinned]');\n\t\t\tif (!post)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst logId = parseInt(post.getAttribute('data-livefeed-id'));\n\t\t\tif (!logId)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\t\tif (!pinnedPanelNode)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst postToMove = (post.parentNode.classList.contains(`${this.class.post}`) ? post.parentNode : post);\n\n\t\t\tif (state === 'Y')\n\t\t\t{\n\t\t\t\tconst originalPostHeight = postToMove.offsetHeight;\n\t\t\t\tpostToMove.setAttribute('bx-data-height', originalPostHeight);\n\n\t\t\t\tthis.getPinnedData({\n\t\t\t\t\tlogId: logId\n\t\t\t\t}).then(data => {\n\t\t\t\t\tconst pinnedPanelTitleNode = post.querySelector('.feed-post-pinned-title');\n\t\t\t\t\tconst pinnedPanelDescriptionNode = post.querySelector('.feed-post-pinned-desc');\n\t\t\t\t\tconst pinnedPanelPinNode = post.querySelector(`.${this.class.pin}`);\n\n\t\t\t\t\tif (pinnedPanelTitleNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelTitleNode.innerHTML = data.TITLE;\n\t\t\t\t\t}\n\t\t\t\t\tif (pinnedPanelDescriptionNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelDescriptionNode.innerHTML = data.DESCRIPTION;\n\t\t\t\t\t}\n\t\t\t\t\tif (pinnedPanelPinNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelPinNode.title = Loc.getMessage('SONET_EXT_LIVEFEED_PIN_TITLE_Y');\n\t\t\t\t\t}\n\n\t\t\t\t\tpost.classList.add(`${this.class.postPinnedHide}`);\n\n\t\t\t\t\tconst cancelPinnedPanel = this.getCancelPinnedPanel({ logId });\n\t\t\t\t\tconst anchor = postToMove.nextSibling;\n\n\t\t\t\t\tanchor.parentNode.insertBefore(cancelPinnedPanel, anchor);\n\t\t\t\t\tthis.centerCancelPinnedPanelElements({ cancelPinnedPanel });\n\n\t\t\t\t\tcancelPinnedPanel.setAttribute('bx-data-height', originalPostHeight);\n\t\t\t\t\tconst cancelPanelHeight = cancelPinnedPanel.getAttribute('bx-data-height');\n\n\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\theight: cancelPanelHeight + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\theight: originalPostHeight + 'px',\n\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\topacity: 0\n\t\t\t\t\t});\n\n\t\t\t\t\tconst panelNode = this.getPanelNode();\n\t\t\t\t\tif (panelNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\tpanelHeight: panelNode.offsetHeight\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// list.post::hide.start, cancelPanel::show.start\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tpostToMove.classList.add(`${this.class.postHide}`);\n\t\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\t\theight: '53px'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\t\topacity: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\tpinBlocked: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\t// list.post::hide.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\n\t\t\t\t\t\tconst panelPostsNode = pinnedPanelNode.querySelector(`.${this.class.panelPosts}`);\n\n\t\t\t\t\t\tpanelPostsNode.insertBefore(postToMove, panelPostsNode.firstChild);\n\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\n\t\t\t\t\t\tpostToMove.classList.remove(`${this.class.postHide}`);\n\t\t\t\t\t\tpost.classList.remove(`${this.class.postPinnedHide}`);\n\n\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t\tthis.showCollapsedPostsPanel();\n\n\t\t\t\t\t\t// pinnedPanel.post::show.start\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tpost.classList.add(`${this.class.postPinned}`);\n\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\tposition: '',\n\t\t\t\t\t\t\t\twidth: '',\n\t\t\t\t\t\t\t\theight: '80px',\n\t\t\t\t\t\t\t\tbackgroundColor: '',\n\t\t\t\t\t\t\t\topacity: 1\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\t\tpinBlocked: false\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tpostToMove.classList.remove(`${this.class.postHide}`);\n\t\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\t\tposition: '',\n\t\t\t\t\t\t\t\t\twidth: '',\n\t\t\t\t\t\t\t\t\theight: '',\n\t\t\t\t\t\t\t\t\tbackgroundColor: '',\n\t\t\t\t\t\t\t\t\topacity: ''\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}, 600); // 600 > transition 0.5\n\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn resolve();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst height = postToMove.getAttribute('bx-data-height');\n\t\t\t\tconst pinnedHeight = postToMove.scrollHeight;\n\n\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\ttransition: '',\n\t\t\t\t});\n\n\t\t\t\tconst cancelPinnedPanel = document.querySelector(`.${this.class.cancelPanel}[bx-data-log-id=\"${logId}\"]`);\n\t\t\t\tif (Type.isDomNode(cancelPinnedPanel))\n\t\t\t\t{\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\theight: pinnedHeight + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\t// pinnedPanel.post::hide.start, cancelPanel::show.start\n\t\t\t\t\trequestAnimationFrame(() => {\n\n\t\t\t\t\t\tpostToMove.classList.add(`${this.class.postExpanding}`);\n\t\t\t\t\t\tcancelPinnedPanel.classList.add(`${this.class.postExpanding}`);\n\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\theight: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\theight: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tconst collapsed = pinnedPanelNode.classList.contains(`${this.class.panelCollapsed}`);\n\n\t\t\t\t\tif (collapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tcancelPinnedPanel.parentNode.insertBefore(postToMove, cancelPinnedPanel.nextSibling);\n\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t}\n\n\t\t\t\t\tconst showCollapsed = this.getCollapsedPanelNode().classList.contains(`${this.class.collapsedPanelShow}`);\n\t\t\t\t\tif (showCollapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideCollapsedPostsPanel();\n\n\t\t\t\t\t\t// cancelPanel::show.end\n\t\t\t\t\t\tEvent.unbindAll(cancelPinnedPanel, 'transitionend');\n\t\t\t\t\t\tEvent.bind(cancelPinnedPanel, 'transitionend', (event) => {\n\t\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\ttransform: '',\n\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.animateCancel({\n\t\t\t\t\t\t\t\tpost,\n\t\t\t\t\t\t\t\tpostToMove,\n\t\t\t\t\t\t\t\tcancelPinnedPanel,\n\t\t\t\t\t\t\t\theight\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// pinnedPanel.post::hide.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'opacity'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!collapsed)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcancelPinnedPanel.parentNode.insertBefore(postToMove, cancelPinnedPanel.nextSibling);\n\t\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\t\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.animateCancel({\n\t\t\t\t\t\t\tpost,\n\t\t\t\t\t\t\tpostToMove,\n\t\t\t\t\t\t\tcancelPinnedPanel,\n\t\t\t\t\t\t\theight\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpost.classList.remove(`${this.class.postPinned}`);\n\t\t\t\t\tpinnedPanelNode.parentNode.insertBefore(postToMove, pinnedPanelNode.nextSibling);\n\t\t\t\t\tthis.adjustPanel();\n\n\t\t\t\t\tconst originalPostHeight = postToMove.scrollHeight;\n\t\t\t\t\tpostToMove.setAttribute('bx-data-height', originalPostHeight);\n\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\theight: '80px'\n\t\t\t\t\t});\n\n\t\t\t\t\t// list.post::show.start\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\t\theight: originalPostHeight + 'px'\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\t// list.post::show.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\theight:''\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\treturn resolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tanimateCancel({\n\t\tpost,\n\t \tpostToMove,\n\t\tcancelPinnedPanel,\n\t\theight\n\t})\n\t{\n\t\tpost.classList.remove(`${this.class.postPinned}`);\n\n\t\t// post.list:show.start, cancelPanel::hide.start\n\t\tsetTimeout(() => {\n\n\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\topacity: 1,\n\t\t\t\theight: height + 'px'\n\t\t\t});\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\theight: 0\n\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tcancelPinnedPanel.remove();\n\t\t\t}, 100)\n\t\t}, 100);\n\n\t\t// post.list:show.end\n\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpost.classList.remove(`${this.class.postPinnedHide}`);\n\n\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\tmarginBottom: '',\n\t\t\t\theight: ''\n\t\t\t});\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\tmarginBottom: '',\n\t\t\t\theight: ''\n\t\t\t});\n\n\t\t\tpostToMove.classList.remove(`${this.class.postExpanding}`);\n\t\t\tcancelPinnedPanel.classList.remove(`${this.class.postExpanding}`);\n\t\t});\n\t}\n\n\tgetCancelPinnedPanel(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet cancelPinnedPanel = document.querySelector(`.${this.class.cancelPanel}[bx-data-log-id=\"${logId}\"]`);\n\n\t\tif (!Type.isDomNode(cancelPinnedPanel))\n\t\t{\n\t\t\tcancelPinnedPanel = Tag.render`\n\t\t\t\t<div class=\"${this.class.cancelPanel}\" bx-data-log-id=\"${logId}\">\n\t\t\t\t\t<div class=\"feed-post-cancel-pinned-panel-inner\">\n\t\t\t\t\t\t<div class=\"feed-post-cancel-pinned-content\">\n\t\t\t\t\t\t\t<span class=\"${this.class.cancelPanelLabel}\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_TITLE')}</span>\n\t\t\t\t\t\t\t<span class=\"feed-post-cancel-pinned-text\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_DESCRIPTION')}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-round ui-btn-sm ${this.class.cancelPanelButton}\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_BUTTON')}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t\t`;\n\n\t\t\tEvent.bind(cancelPinnedPanel.querySelector(`.${this.class.cancelPanelButton}`), 'click', () => {\n\t\t\t\tthis.changePinned({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tnewState: 'N'\n\t\t\t\t}).then(() => {\n\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\theight: 0\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn cancelPinnedPanel;\n\t}\n\n\tcenterCancelPinnedPanelElements({ cancelPinnedPanel })\n\t{\n\t\tif (!Type.isDomNode(cancelPinnedPanel))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// cancelPanel::show.start\n\t\tsetTimeout(() => {\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\topacity: 1\n\t\t\t});\n\t\t}, 100);\n\n\t\tUtils.setStyle(cancelPinnedPanel.querySelector(`.${this.class.cancelPanelLabel}`), {\n\t\t\tmarginLeft: cancelPinnedPanel.querySelector(`.${this.class.cancelPanelButton}`).getBoundingClientRect().width + 'px'\n\t\t});\n\t}\n\n\tgetPostsCount()\n\t{\n\t\tconst panelNode = this.getPanelNode();\n\t\treturn (panelNode ? Array.from(panelNode.getElementsByClassName(`${this.class.post}`)).length : 0);\n\t}\n\n\thidePinnedItems()\n\t{\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\theight: parseInt(this.getOption('panelHeight')) + 'px'\n\t\t});\n\n\t\tArray.from(pinnedPanelNode.getElementsByClassName(`${this.class.post}`)).reduce((count, item) => {\n\n\t\t\tcount += item.offsetHeight;\n\n\t\t\tUtils.setStyle(item, {\n\t\t\t\ttransition: 'opacity .1s linear, transform .2s .1s linear, height .5s linear'\n\t\t\t});\n\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\ttransition: 'height .5s .1s linear'\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::hide.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\topacity: '0!important',\n\t\t\t\t\ttransform: `translateY(-${count}px)`\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: '58px'\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::hide.end\n\t\t\tEvent.unbindAll(item, 'transitionend');\n\t\t\tEvent.bind(item, 'transitionend', (event) => {\n\t\t\t\tif (!this.checkTransitionProperty(event, 'transform'))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\topacity: '',\n\t\t\t\t\ttransform: '',\n\t\t\t\t\ttransition: ''\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\ttransition: ''\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn count;\n\t\t}, 0);\n\t}\n\n\tshowPinnedItems()\n\t{\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tArray.from(pinnedPanelNode.getElementsByClassName(`${this.class.post}`)).map((item, currentIndex, originalItemsList) => {\n\n\t\t\tUtils.setStyle(item, {\n\t\t\t\tdisplay: 'block',\n\t\t\t\topacity: 0\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::show.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: ((84 * (currentIndex + 1)) - 4) + 'px'\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\ttransform: `translateY(${0}px)`,\n\t\t\t\t\topacity: 1\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::show.end\n\t\t\tEvent.unbindAll(item, 'transitionend');\n\t\t\tEvent.bind(item, 'transitionend', (event) => {\n\t\t\t\tif (!this.checkTransitionProperty(event, 'transform'))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\theight: '',\n\t\t\t\t\ttransform: ''\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: ''\n\t\t\t\t});\n\n\t\t\t\tif ((currentIndex + 1) === originalItemsList.length)\n\t\t\t\t{\n\t\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\t\ttransition: '',\n\t\t\t\t\t\theight: ''\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tanimateCollapsedPanel()\n\t{\n\t\t// collapsedPanel::hide.start\n\t\trequestAnimationFrame(() => {\n\t\t\tconst collapsedPanel = this.getCollapsedPanelNode();\n\n\t\t\tUtils.setStyle(collapsedPanel, {\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: 0,\n\t\t\t\twidth: '100%',\n\t\t\t\topacity: 0\n\t\t\t});\n\n\t\t\tcollapsedPanel.classList.remove(`${this.class.collapsedPanelHide}`);\n\t\t\tcollapsedPanel.classList.add(`${this.class.collapsedPanelShow}`);\n\n\t\t\t// collapsedPanel::show.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(collapsedPanel, {\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\topacity: 1\n\t\t\t\t});\n\t\t\t});\n\t\t})\n\t}\n\n\tadjustCollapsedPostsPanel()\n\t{\n\t\tconst postsCounter = this.getPostsCount();\n\t\tconst postsCounterNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterPostsValue}`);\n\t\tif (postsCounterNode)\n\t\t{\n\t\t\tpostsCounterNode.innerHTML = parseInt(postsCounter);\n\t\t}\n\n\t\tconst commentsCounterNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterComments}`);\n\t\tconst commentsCounterValueNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterCommentsValue}`);\n\t\tconst panelNode = this.getPanelNode();\n\n\t\tif (\n\t\t\tcommentsCounterNode\n\t\t\t&& commentsCounterValueNode\n\t\t\t&& panelNode\n\t\t)\n\t\t{\n\t\t\tconst newCommentCounter = Array.from(panelNode.querySelectorAll(`.${this.class.collapsedPanelCounterCommentsValueNewValue}`)).reduce((acc, node) => {\n\t\t\t\treturn acc + (node.closest(`.${this.class.postUnfollowed}`) ? 0 : parseInt(node.innerHTML));\n\t\t\t}, 0);\n\n\t\t\tcommentsCounterValueNode.innerHTML = newCommentCounter;\n\t\t\tif (newCommentCounter > 0)\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.add(`${this.class.collapsedPanelCounterCommentsShown}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.remove(`${this.class.collapsedPanelCounterCommentsShown}`);\n\t\t\t}\n\t\t}\n\t}\n\n\tadjustPanel()\n\t{\n\t\tconst panelNode = this.getPanelNode();\n\t\tif (!panelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.getPostsCount() > 0)\n\t\t\t{\n\t\t\t\tpanelNode.classList.add(`${this.class.panelNonEmpty}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpanelNode.classList.remove(`${this.class.panelNonEmpty}`);\n\t\t\t}\n\t\t}, 0);\n\t}\n\n\tshowCollapsedPostsPanel()\n\t{\n\t\tif (this.getPostsCount() >= Loc.getMessage('SONET_EXT_LIVEFEED_COLLAPSED_PINNED_PANEL_ITEMS_LIMIT'))\n\t\t{\n\t\t\tthis.showCollapsedPanel();\n\t\t\tthis.hidePinnedItems();\n\t\t}\n\t}\n\n\thideCollapsedPostsPanel()\n\t{\n\t\tif (this.getPostsCount() < Loc.getMessage('SONET_EXT_LIVEFEED_COLLAPSED_PINNED_PANEL_ITEMS_LIMIT'))\n\t\t{\n\t\t\tthis.getPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t\t\tthis.removeCollapsedPanel();\n\t\t\tthis.showPinnedItems();\n\t\t}\n\t}\n\n\tshowCollapsedPanel()\n\t{\n\t\tthis.getPanelNode().classList.add(`${this.class.panelCollapsed}`);\n\t\tthis.animateCollapsedPanel();\n\t}\n\n\thideCollapsedPanel()\n\t{\n\t\tthis.getPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t\tthis.showPinnedItems();\n\t\tthis.removeCollapsedPanel();\n\t}\n\n\tremoveCollapsedPanel()\n\t{\n\t\tconst collapsedPanel = this.getCollapsedPanelNode();\n\n\t\tUtils.setStyle(collapsedPanel, {\n\t\t\tposition: 'absolute',\n\t\t\ttop: 0,\n\t\t\twidth: '100%'\n\t\t});\n\n\t\tcollapsedPanel.classList.remove(`${this.class.collapsedPanelShow}`);\n\t\tcollapsedPanel.classList.add(`${this.class.collapsedPanelHide}`);\n\t}\n\n\tgetCommentsNodes(xmlId)\n\t{\n\t\tconst result = {\n\t\t\tfollow: true,\n\t\t\tnewNode: null,\n\t\t\tnewValueNode: null,\n\t\t\toldNode: null,\n\t\t\tallNode: null\n\t\t};\n\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst commentsNode = document.querySelector(`.${this.class.postComments}[data-bx-comments-entity-xml-id=\"${xmlId}\"]`);\n\t\tif (!commentsNode)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst postNode = commentsNode.closest(`.${this.class.postPinActive}`);\n\t\tif (!postNode)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst newPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueNew}`);\n\t\tconst newValuePinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueNewValue}`);\n\t\tconst oldPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueOld}`);\n\t\tconst allPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueAll}`);\n\n\t\tif (\n\t\t\t!newPinnedCommentsNode\n\t\t\t|| !newValuePinnedCommentsNode\n\t\t\t|| !oldPinnedCommentsNode\n\t\t\t|| !allPinnedCommentsNode\n\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tresult.newNode = newPinnedCommentsNode;\n\t\tresult.newValueNode = newValuePinnedCommentsNode;\n\t\tresult.oldNode = oldPinnedCommentsNode;\n\t\tresult.allNode = allPinnedCommentsNode;\n\t\tresult.follow = (commentsNode.getAttribute('data-bx-follow') !== 'N');\n\n\t\treturn result;\n\t}\n\n\tgetCommentsData(xmlId)\n\t{\n\t\tconst result = {\n\t\t\tnewValue: null,\n\t\t\toldValue: null,\n\t\t\tallValue: null\n\t\t};\n\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst { newValueNode, oldNode, allNode, follow } = this.getCommentsNodes(xmlId);\n\n\t\tresult.follow = follow;\n\n\t\tif (\n\t\t\t!Type.isDomNode(newValueNode)\n\t\t\t|| !Type.isDomNode(oldNode)\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tlet newCommentsValue = 0;\n\t\tlet oldCommentsValue = 0;\n\t\tlet allCommentsValue = 0;\n\n\t\tlet matches = newValueNode.innerHTML.match(/(\\d+)/);\n\n\t\tif (matches)\n\t\t{\n\t\t\tnewCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tmatches = oldNode.innerHTML.match(/(\\d+)/);\n\t\tif (matches)\n\t\t{\n\t\t\toldCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tmatches = allNode.innerHTML.match(/(\\d+)/);\n\t\tif (matches)\n\t\t{\n\t\t\tallCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tresult.oldValue = oldCommentsValue;\n\t\tresult.newValue = newCommentsValue;\n\t\tresult.allValue = allCommentsValue;\n\n\t\treturn result;\n\t}\n\n\tsetCommentsData(xmlId, value)\n\t{\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { newNode, newValueNode, oldNode, allNode } = this.getCommentsNodes(xmlId);\n\t\tif (\n\t\t\t!Type.isDomNode(newNode)\n\t\t\t|| !Type.isDomNode(newValueNode)\n\t\t\t|| !Type.isDomNode(oldNode)\n\t\t\t|| !Type.isDomNode(allNode)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isInteger(value.newValue))\n\t\t{\n\t\t\tnewValueNode.innerHTML = `${value.newValue}`;\n\t\t\tif (\n\t\t\t\tvalue.newValue > 0\n\t\t\t\t&& !newNode.classList.contains(`${this.class.collapsedPanelCounterCommentsValueNewActive}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tnewNode.classList.add(`${this.class.collapsedPanelCounterCommentsValueNewActive}`);\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tvalue.newValue <= 0\n\t\t\t\t&& newNode.classList.contains(`${this.class.collapsedPanelCounterCommentsValueNewActive}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tnewNode.classList.remove(`${this.class.collapsedPanelCounterCommentsValueNewActive}`);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isInteger(value.oldValue))\n\t\t{\n\t\t\toldNode.innerHTML = value.oldValue;\n\t\t}\n\n\t\tif (Type.isInteger(value.allValue))\n\t\t{\n\t\t\tallNode.innerHTML = value.allValue;\n\t\t}\n\n\t\tthis.adjustCollapsedPostsPanel();\n\t}\n\n\tgetCollapsedPanelNode()\n\t{\n\t\treturn this.getPanelNode().querySelector(`.${this.class.collapsedPanel}`);\n\t}\n\n\tcheckTransitionProperty(event, propertyName)\n\t{\n\t\treturn (event.propertyName === propertyName);\n\t}\n}\n\nexport {\n\tPinnedPanel\n};\n","import {Popup} from 'main.popup';\nimport {Dom, Loc, Tag} from \"main.core\";\nimport {Button} from \"ui.buttons\";\n\nclass Post\n{\n\tconstructor()\n\t{\n\t}\n\n\tshowBackgroundWarning({\n\t\turlToEdit,\n\t\tmenuPopupWindow\n\t})\n\t{\n\t\tconst content = Tag.render`<div>${Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_DESCRIPTION')}</div>`;\n\n\t\tconst dialog = new Popup('create id here', null, {\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tdraggable: true,\n\t\t\tbindOnResize: false,\n\t\t\ttitleBar: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_TITLE'),\n\t\t\tcloseIcon: true,\n\t\t\tclassName: 'sonet-livefeed-popup-warning',\n\t\t\tcontent: content,\n\t\t\tevents: {},\n\t\t\tcacheable: false,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_BUTTON_SUBMIT'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-primary',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\twindow.location = urlToEdit;\n\t\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\t\tif (menuPopupWindow)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmenuPopupWindow.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_BUTTON_CANCEL'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-light',\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\tif (menuPopupWindow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuPopupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tdialog.show();\n\n\t\treturn false;\n\t}\n}\n\nexport {\n\tPost\n};","import {Type, Loc, ajax, Event} from \"main.core\";\nimport {PinnedPanel} from \"./pinned\";\nimport {Post} from \"./post\";\n\nimport './css/feed.css';\nimport './css/gratitude.css';\nimport './css/important.css';\nimport './css/warning.css';\n\nclass Feed\n{\n\tconstructor()\n\t{\n\t\tthis.init();\n\t\tthis.entryData = {};\n\t}\n\n\tinit()\n\t{\n\n\t}\n\n\tchangeFollow(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (!logId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst followNode = document.getElementById('log_entry_follow_' + logId);\n\t\tconst valueOld = (followNode && followNode.getAttribute('data-follow') === 'Y' ? 'Y' : 'N');\n\t\tconst valueNew = (valueOld === 'Y' ? 'N' : 'Y');\n\n\t\tthis.renderFollow({\n\t\t\tlogId: logId,\n\t\t\tvalue: valueNew\n\t\t});\n\n\t\tajax.runAction('socialnetwork.api.livefeed.changeFollow', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: valueNew\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: (valueNew === 'Y' ? 'setFollow' : 'setUnfollow')\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tif (!response.data.success)\n\t\t\t{\n\t\t\t\tthis.renderFollow({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tvalue: valueOld\n\t\t\t\t});\n\t\t\t}\n\t\t}, () => {\n\t\t\tthis.renderFollow({\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: valueOld\n\t\t\t});\n\t\t});\n\n\t\treturn false;\n\t}\n\n\trenderFollow(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (!logId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst followNode = document.getElementById('log_entry_follow_' + logId);\n\t\tconst value = (params.value && params.value === 'Y' ? 'Y' : 'N');\n\n\t\tif (followNode)\n\t\t{\n\t\t\tfollowNode.setAttribute('data-follow', value);\n\t\t}\n\n\t\tconst textNode = (followNode ? followNode.querySelector('a') : null);\n\t\tif (textNode)\n\t\t{\n\t\t\ttextNode.innerHTML = Loc.getMessage('SONET_EXT_LIVEFEED_FOLLOW_TITLE_' + value);\n\t\t}\n\n\t\tconst postNode = (followNode ? followNode.closest('.feed-post-block') : null);\n\t\tif (postNode)\n\t\t{\n\t\t\tif (value === 'N')\n\t\t\t{\n\t\t\t\tpostNode.classList.add('feed-post-block-unfollowed');\n\t\t\t}\n\t\t\telse if (value === 'Y')\n\t\t\t{\n\t\t\t\tpostNode.classList.remove('feed-post-block-unfollowed');\n\t\t\t}\n\t\t}\n\t}\n\n\tchangeFavorites(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst event = (params.event ? params.event : null);\n\n\t\tlet node = (params.node ? params.node : null);\n\t\tlet newState = (params.newState ? params.newState : null);\n\n\t\tif (Type.isStringFilled(node))\n\t\t{\n\t\t\tnode = document.getElementById(node);\n\t\t}\n\n\t\tif (!logId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menuItem = null;\n\n\t\tif (event)\n\t\t{\n\t\t\tmenuItem = event.target;\n\t\t\tif (!menuItem.classList.contains('menu-popup-item-text'))\n\t\t\t{\n\t\t\t\tmenuItem = menuItem.querySelector('.menu-popup-item-text');\n\t\t\t}\n\t\t}\n\n\t\tlet nodeToAdjust = null;\n\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tnodeToAdjust = (\n\t\t\t\tnode.classList.contains('feed-post-important-switch')\n\t\t\t\t\t? node\n\t\t\t\t\t: node.querySelector('.feed-post-important-switch')\n\t\t\t);\n\t\t}\n\n\t\tif (typeof this.entryData[logId] == 'undefined')\n\t\t{\n\t\t\tthis.entryData[logId] = {};\n\t\t}\n\n\t\tif (typeof this.entryData[logId].favorites != 'undefined')\n\t\t{\n\t\t\tnewState = (this.entryData[logId].favorites ? 'N' : 'Y');\n\t\t\tthis.entryData[logId].favorites = !this.entryData[logId].favorites;\n\t\t}\n\t\telse if (nodeToAdjust)\n\t\t{\n\t\t\tnewState = (\n\t\t\t\tnodeToAdjust.classList.contains('feed-post-important-switch-active')\n\t\t\t\t\t? 'N'\n\t\t\t\t\t: 'Y'\n\t\t\t);\n\t\t\tthis.entryData[logId].favorites = (newState == 'Y');\n\t\t}\n\n\t\tif (!newState)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.adjustFavoritesControlItem(nodeToAdjust, newState);\n\t\tthis.adjustFavoritesMenuItem(menuItem, newState);\n\n\t\tajax.runAction('socialnetwork.api.livefeed.changeFavorites', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: newState\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: (newState == 'Y' ? 'addFavorites' : 'removeFavorites')\n\t\t\t}\n\t\t}).then(response =>\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isStringFilled(response.data.newValue)\n\t\t\t\t&& ['Y', 'N'].includes(response.data.newValue)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.entryData[logId].favorites = (response.data.newValue == 'Y');\n\t\t\t}\n\n\t\t\tthis.adjustFavoritesControlItem(nodeToAdjust, response.data.newValue);\n\t\t\tthis.adjustFavoritesMenuItem(menuItem, response.data.newValue);\n\n\t\t}, response => {\n\t\t\tthis.entryData[logId].favorites = !this.entryData[logId].favorites;\n\t\t});\n\t}\n\n\tadjustFavoritesMenuItem(menuItemNode, state)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(menuItemNode)\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tmenuItemNode.innerHTML = this.getMenuTitle(state === 'Y');\n\t}\n\n\tadjustFavoritesControlItem(node, state)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(node)\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnode.title = this.getMenuTitle(state === 'Y');\n\t\tif (state == 'Y')\n\t\t{\n\t\t\tnode.classList.add('feed-post-important-switch-active');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.classList.remove('feed-post-important-switch-active');\n\t\t}\n\t}\n\n\tgetMenuTitle(state: boolean): string\n\t{\n\t\treturn Loc.getMessage(`SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_${state ? 'Y' : 'N'}`);\n\t}\n}\n\nlet FeedInstance = null;\nlet PinnedPanelInstance = null;\nlet PostInstance = null;\n\nEvent.ready(() =>\n{\n\tFeedInstance = new Feed();\n\tPinnedPanelInstance = new PinnedPanel();\n\tPostInstance = new Post();\n});\n\nexport {\n\tFeedInstance,\n\tPinnedPanelInstance,\n\tPostInstance\n};"],"names":["Utils","node","styles","Object","entries","forEach","key","value","style","PinnedPanel","class","pin","post","postHide","postComments","postPinned","postPinnedHide","postPinActive","postUnfollowed","postExpanding","panelCollapsed","panelNonEmpty","panelPosts","collapsedPanel","collapsedPanelExpand","collapsedPanelCounterPostsValue","collapsedPanelCounterComments","collapsedPanelCounterCommentsValue","collapsedPanelCounterCommentsShown","collapsedPanelCounterCommentsValueNew","collapsedPanelCounterCommentsValueNewValue","collapsedPanelCounterCommentsValueNewActive","collapsedPanelCounterCommentsValueOld","collapsedPanelCounterCommentsValueAll","collapsedPanelShow","collapsedPanelHide","cancelPanel","cancelPanelButton","cancelPanelLabel","panelInitialized","postsInitialized","handlePostClick","bind","init","options","initPanel","initPosts","initEvents","EventEmitter","subscribe","optionName","pinnedPanelNode","getPanelNode","adjustCollapsedPostsPanel","Event","getCollapsedPanelNode","collapsedHeight","offsetHeight","setStyle","height","transition","setTimeout","hideCollapsedPanel","event","likeClicked","target","classList","contains","closest","followClicked","menuClicked","contentViewClicked","pinClicked","collapseClicked","commentsClicked","postNode","remove","menuId","getAttribute","MenuManager","destroy","BaseEvent","compatData","rootNode","data","emit","anchorNode","querySelector","position","Dom","getPosition","window","scrollTo","top","stopPropagation","preventDefault","add","postList","document","querySelectorAll","length","Array","from","unbind","newState","logId","parseInt","changePinned","then","getData","xmlId","id","getCommentsData","oldValue","newValue","new","setCommentsData","Type","isInteger","incrementMaxListeners","params","commentId","allValue","follow","commentsData","AUTHOR","ID","BX","message","panelNode","Promise","resolve","reject","getOption","setPostState","state","ajax","runAction","analyticsLabel","b24statAction","response","success","movePost","includes","setAttribute","Loc","getMessage","postToMove","parentNode","originalPostHeight","getPinnedData","pinnedPanelTitleNode","pinnedPanelDescriptionNode","pinnedPanelPinNode","innerHTML","TITLE","DESCRIPTION","title","cancelPinnedPanel","getCancelPinnedPanel","anchor","nextSibling","insertBefore","centerCancelPinnedPanelElements","cancelPanelHeight","width","backgroundColor","opacity","setOptions","panelHeight","pinBlocked","unbindAll","checkTransitionProperty","panelPostsNode","firstChild","adjustPanel","showCollapsedPostsPanel","pinnedHeight","scrollHeight","isDomNode","requestAnimationFrame","collapsed","showCollapsed","hideCollapsedPostsPanel","transform","display","animateCancel","marginBottom","Tag","render","marginLeft","getBoundingClientRect","getElementsByClassName","reduce","count","item","map","currentIndex","originalItemsList","postsCounter","getPostsCount","postsCounterNode","commentsCounterNode","commentsCounterValueNode","newCommentCounter","acc","showCollapsedPanel","hidePinnedItems","removeCollapsedPanel","showPinnedItems","animateCollapsedPanel","result","newNode","newValueNode","oldNode","allNode","isStringFilled","commentsNode","newPinnedCommentsNode","newValuePinnedCommentsNode","oldPinnedCommentsNode","allPinnedCommentsNode","getCommentsNodes","newCommentsValue","oldCommentsValue","allCommentsValue","matches","match","propertyName","Post","urlToEdit","menuPopupWindow","content","dialog","Popup","autoHide","closeByEsc","offsetLeft","offsetTop","draggable","bindOnResize","titleBar","closeIcon","className","events","cacheable","buttons","Button","text","click","location","close","show","Feed","entryData","followNode","getElementById","valueOld","valueNew","renderFollow","textNode","menuItem","nodeToAdjust","favorites","adjustFavoritesControlItem","adjustFavoritesMenuItem","menuItemNode","getMenuTitle","FeedInstance","PinnedPanelInstance","PostInstance","ready"],"mappings":"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"}