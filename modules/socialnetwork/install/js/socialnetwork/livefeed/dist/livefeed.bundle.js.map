{"version":3,"file":"livefeed.bundle.js","sources":["../src/utils.js","../src/pinned.js","../src/taskcreator.js","../src/post.js","../src/informer.js","../src/loader.js","../src/morebutton.js","../src/forum.js","../src/filter.js","../src/contentview.js","../src/page.js","../src/commentform.js","../src/feed.js"],"sourcesContent":["class Utils\n{\n\tstatic setStyle(node, styles)\n\t{\n\t\tObject.entries(styles).forEach(([key, value]) => {\n\t\t\tnode.style[key] = value;\n\t\t});\n\t}\n}\n\nexport {\n\tUtils\n};\n","import { ajax, Event, Type, Loc, Dom, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\nimport { Utils } from \"./utils\";\n\nclass PinnedPanel\n{\n\tconstructor()\n\t{\n\t\tthis.class = {\n\t\t\tpin: 'feed-post-pin',\n\n\t\t\tpost: 'feed-item-wrap',\n\t\t\tpostHide: 'feed-item-wrap-hide',\n\t\t\tpostComments: 'feed-comments-block',\n\n\t\t\tpostPinned: 'feed-post-block-pinned',\n\t\t\tpostPinnedHide: 'feed-post-block-pinned-hide',\n\t\t\tpostPinActive: 'feed-post-block-pin-active',\n\t\t\tpostUnfollowed: 'feed-post-block-unfollowed',\n\n\t\t\tpostExpanding: 'feed-post-block-expand',\n\n\t\t\tpanelCollapsed: 'feed-pinned-panel-collapsed',\n\t\t\tpanelNonEmpty: 'feed-pinned-panel-nonempty',\n\t\t\tpanelPosts: 'feed-pinned-panel-posts',\n\n\t\t\tcollapsedPanel: 'feed-post-collapsed-panel',\n\t\t\tcollapsedPanelExpand: 'feed-post-collapsed-panel-right',\n\t\t\tcollapsedPanelCounterPostsValue: 'feed-post-collapsed-panel-count-posts',\n\t\t\tcollapsedPanelCounterComments: 'feed-post-collapsed-panel-box-comments',\n\t\t\tcollapsedPanelCounterCommentsValue: 'feed-post-collapsed-panel-count-comments-value',\n\t\t\tcollapsedPanelCounterCommentsShown: 'feed-post-collapsed-panel-box-shown',\n\t\t\tcollapsedPanelCounterCommentsValueNew: 'feed-inform-comments-pinned-new',\n\t\t\tcollapsedPanelCounterCommentsValueNewValue: 'feed-inform-comments-pinned-new-value',\n\t\t\tcollapsedPanelCounterCommentsValueNewActive: 'feed-inform-comments-pinned-new-active',\n\t\t\tcollapsedPanelCounterCommentsValueOld: 'feed-inform-comments-pinned-old',\n\t\t\tcollapsedPanelCounterCommentsValueAll: 'feed-inform-comments-pinned-all',\n\t\t\tcollapsedPanelShow: 'feed-post-collapsed-panel--show',\n\t\t\tcollapsedPanelHide: 'feed-post-collapsed-panel--hide',\n\n\t\t\tcancelPanel: 'feed-post-cancel-pinned-panel',\n\t\t\tcancelPanelButton: 'feed-post-cancel-pinned-btn',\n\t\t\tcancelPanelLabel: 'feed-post-cancel-pinned-label'\n\t\t};\n\n\t\tthis.panelInitialized = false;\n\t\tthis.postsInitialized = false;\n\t\tthis.handlePostClick = this.handlePostClick.bind(this);\n\t\tthis.options = {};\n\n\t\tEvent.ready(() => {\n\t\t\t/* for detail page without pinned panel */\n\t\t\tthis.initPosts();\n\t\t});\n\t}\n\n\tresetFlags()\n\t{\n\t\tthis.panelInitialized = false;\n\t\tthis.postsInitialized = false;\n\t}\n\n\tinit()\n\t{\n\t\t/* for list page in composite mode */\n\t\tthis.initPanel();\n\n\t\tthis.initPosts();\n\t\tthis.initEvents();\n\t}\n\n\tsetOptions(options)\n\t{\n\t\tthis.options = { ...this.options, ...options };\n\t}\n\n\tgetOption(optionName)\n\t{\n\t\treturn this.options[optionName];\n\t}\n\n\tinitPanel()\n\t{\n\t\tif (this.panelInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.panelInitialized = true;\n\n\t\tthis.adjustCollapsedPostsPanel();\n\n\t\tEvent.bind(this.getCollapsedPanelNode(), 'click', () => {\n\t\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\t\tif (!pinnedPanelNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst collapsedHeight = pinnedPanelNode.offsetHeight;\n\n\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\theight: collapsedHeight + 'px',\n\t\t\t\ttransition: 'height .5s'\n\t\t\t});\n\t\t\tsetTimeout(() => {\n\t\t\t\tpinnedPanelNode.style = '';\n\t\t\t}, 550);\n\t\t\tthis.hideCollapsedPanel();\n\t\t});\n\n\t\tEvent.bind(pinnedPanelNode, 'click', (event) => {\n\t\t\tconst likeClicked = event.target.classList.contains('feed-inform-ilike') || event.target.closest('.feed-inform-ilike') !== null;\n\t\t\tconst followClicked = event.target.classList.contains('feed-inform-follow') || event.target.closest('.feed-inform-follow') !== null;\n\t\t\tconst menuClicked = (\n\t\t\t\tevent.target.classList.contains('feed-post-more-link')\n\t\t\t\t|| event.target.closest('.feed-post-more-link') !== null\n\t\t\t\t|| event.target.classList.contains('feed-post-right-top-menu')\n\t\t\t);\n\t\t\tconst contentViewClicked = event.target.classList.contains('feed-inform-contentview') || event.target.closest('.feed-inform-contentview') !== null;\n\t\t\tconst pinClicked = event.target.classList.contains(`${this.class.pin}`) || event.target.closest(`.${this.class.pin}`) !== null;\n\t\t\tconst collapseClicked = event.target.classList.contains('feed-post-pinned-link-collapse');\n\t\t\tconst commentsClicked = event.target.classList.contains('feed-inform-comments-pinned') || event.target.closest('.feed-inform-comments-pinned') !== null;\n\n\t\t\tlet postNode = null;\n\n\t\t\tif (event.target.classList.contains('feed-post-block'))\n\t\t\t{\n\t\t\t\tpostNode = event.target;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpostNode = event.target.closest('.feed-post-block');\n\t\t\t}\n\n\t\t\tif (!postNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (postNode.classList.contains(`${this.class.postPinned}`))\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\t!likeClicked\n\t\t\t\t\t&& !followClicked\n\t\t\t\t\t&& !menuClicked\n\t\t\t\t\t&& !contentViewClicked\n\t\t\t\t\t&& !pinClicked\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tpostNode.classList.remove(`${this.class.postPinned}`);\n\n\t\t\t\t\tconst menuId = postNode.getAttribute('data-menu-id');\n\n\t\t\t\t\tif (menuId)\n\t\t\t\t\t{\n\t\t\t\t\t\tMenuManager.destroy(menuId);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst event = new BaseEvent({\n\t\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\t\trootNode: postNode\n\t\t\t\t\t\t}],\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\trootNode: postNode\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tEventEmitter.emit('BX.Livefeed:recalculateComments', event);\n\t\t\t\t}\n\n\t\t\t\tif (commentsClicked)\n\t\t\t\t{\n\t\t\t\t\tconst anchorNode = postNode.querySelector(`.${this.class.postComments} a[name=comments]`);\n\n\t\t\t\t\tif (anchorNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst position = Dom.getPosition(anchorNode);\n\t\t\t\t\t\twindow.scrollTo(0, position.top - 200);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (collapseClicked)\n\t\t\t{\n\t\t\t\tpostNode.classList.add(`${this.class.postPinned}`);\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t});\n\t}\n\n\tinitPosts()\n\t{\n\t\tif (this.postsInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst postList = document.querySelectorAll('[data-livefeed-post-pinned]');\n\t\tif (postList.length > 0)\n\t\t{\n\t\t\tthis.postsInitialized = true;\n\t\t}\n\n\t\tArray.from(postList).forEach((post) => {\n\t\t\tEvent.unbind(post, 'click', this.handlePostClick);\n\t\t\tEvent.bind(post, 'click', this.handlePostClick);\n\t\t});\n\t}\n\n\thandlePostClick(event)\n\t{\n\t\tif (!event.target.classList.contains(`${this.class.pin}`))\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst post = event.target.closest('[data-livefeed-id]');\n\n\t\tif (!post)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newState = (post.getAttribute('data-livefeed-post-pinned') === 'Y' ? 'N' : 'Y');\n\t\tconst logId = parseInt(post.getAttribute('data-livefeed-id'));\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.changePinned({\n\t\t\tlogId: logId,\n\t\t\tnewState: newState,\n\t\t\tevent: event\n\t\t\t\t}).then(() => {\n\t\t});\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('OnUCCommentWasRead', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, options ] = event.getData();\n\t\t\tconst { oldValue, newValue } = this.getCommentsData(xmlId);\n\n\t\t\tif (!!options.new)\n\t\t\t{\n\t\t\t\tthis.setCommentsData(xmlId, {\n\t\t\t\t\tnewValue: (Type.isInteger(newValue) ? (newValue - 1) : 0),\n\t\t\t\t\toldValue: (Type.isInteger(oldValue) ? (oldValue + 1) : 1)\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.incrementMaxListeners('OnUCCommentWasPulled');\n\t\tEventEmitter.subscribe('OnUCCommentWasPulled', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ id, data, params ] = event.getData();\n\t\t\tconst [ xmlId, commentId ] = id;\n\t\t\tconst { newValue, oldValue, allValue, follow } = this.getCommentsData(xmlId);\n\n\t\t\tconst commentsData = {\n\t\t\t\tallValue: (Type.isInteger(allValue) ? (allValue + 1) : 1)\n\t\t\t};\n\n\t\t\tif (parseInt(params.AUTHOR.ID) !== parseInt(BX.message('USER_ID')))\n\t\t\t{\n\t\t\t\tcommentsData.newValue = (Type.isInteger(newValue) ? (newValue + 1) : 1);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommentsData.oldValue = (Type.isInteger(oldValue) ? (oldValue + 1) : 1);\n\t\t\t}\n\n\t\t\tthis.setCommentsData(xmlId, commentsData);\n\t\t});\n\n\t\tEventEmitter.subscribe('OnUCommentWasDeleted', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, data ] = event.getData();\n\t\t\tconst { oldValue, allValue } = this.getCommentsData(xmlId);\n\n\t\t\tthis.setCommentsData(xmlId, {\n\t\t\t\tallValue: (Type.isInteger(allValue) ? (allValue - 1) : 0),\n\t\t\t\toldValue: (Type.isInteger(oldValue) ? (oldValue - 1) : 0)\n\t\t\t});\n\t\t});\n\t}\n\n\tchangePinned(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst event = (params.event ? params.event : null);\n\n\t\tlet node = (params.node ? params.node : null);\n\t\tlet newState = (params.newState ? params.newState : null);\n\n\t\tconst panelNode = this.getPanelNode();\n\n\t\tif (\n\t\t\t!node\n\t\t\t&& !event\n\t\t\t&& logId > 0\n\t\t\t&& panelNode\n\t\t)\n\t\t{\n\t\t\tnode = panelNode.querySelector(`.${this.class.post} > [data-livefeed-id=\"${logId}\"]`);\n\t\t}\n\n\t\tif (\n\t\t\t!node\n\t\t\t&& event\n\t\t)\n\t\t{\n\t\t\tnode = event.target;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (\n\t\t\t\t!!this.getOption('pinBlocked') ||\n\t\t\t\t!node\n\t\t\t\t|| !newState\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tthis.setPostState({\n\t\t\t\tnode: node,\n\t\t\t\tstate: newState\n\t\t\t});\n\n\t\t\tconst action = (\n\t\t\t\tnewState === 'Y'\n\t\t\t\t\t? 'socialnetwork.api.livefeed.logentry.pin'\n\t\t\t\t\t: 'socialnetwork.api.livefeed.logentry.unpin'\n\t\t\t);\n\n\t\t\tajax.runAction(action, {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: logId\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tb24statAction: (newState === 'Y' ? 'pinLivefeedEntry' : 'unpinLivefeedEntry')\n\t\t\t\t}\n\t\t\t}).then(response => {\n\t\t\t\tif (!response.data.success)\n\t\t\t\t{\n\t\t\t\t\tthis.setPostState({\n\t\t\t\t\t\tnode: node,\n\t\t\t\t\t\tstate: (newState === 'Y' ? 'N' : 'Y')\n\t\t\t\t\t});\n\t\t\t\t\treturn resolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.movePost({\n\t\t\t\t\t\tnode: node,\n\t\t\t\t\t\tstate: newState\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\treturn resolve();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, response => {\n\t\t\t\tthis.setPostState({\n\t\t\t\t\tnode: node,\n\t\t\t\t\tstate: (newState === 'Y' ? 'N' : 'Y')\n\t\t\t\t});\n\t\t\t\treturn resolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tsetPostState(params)\n\t{\n\t\tconst state = (params.state ? params.state : null);\n\t\tconst node = (params.node ? params.node : null);\n\n\t\tif (\n\t\t\t!node\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst post = node.closest('[data-livefeed-post-pinned]');\n\t\tif (!post)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpost.setAttribute('data-livefeed-post-pinned', state);\n\n\t\tif (state === 'Y')\n\t\t{\n\t\t\tpost.classList.add(`${this.class.postPinActive}`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpost.classList.remove(`${this.class.postPinActive}`);\n\t\t}\n\n\t\tconst pin = post.querySelector(`.${this.class.pin}`);\n\t\tif (pin)\n\t\t{\n\t\t\tpin.setAttribute('title', Loc.getMessage(`SONET_EXT_LIVEFEED_PIN_TITLE_${state}`));\n\t\t}\n\t}\n\n\tgetPanelNode()\n\t{\n\t\treturn document.querySelector('[data-livefeed-pinned-panel]');\n\t}\n\n\tgetPinnedData(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction('socialnetwork.api.livefeed.logentry.getPinData', {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: logId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\theaders: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: Loc.getMessage('SONET_EXT_LIVEFEED_AJAX_ENTITY_HEADER_NAME'),\n\t\t\t\t\t\tvalue: params.entityValue || '',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: Loc.getMessage('SONET_EXT_LIVEFEED_AJAX_TOKEN_HEADER_NAME'),\n\t\t\t\t\t\tvalue: params.tokenValue || '',\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t}).then(response => {\n\t\t\t\treturn resolve(response.data);\n\t\t\t}, response => {\n\t\t\t\treturn reject();\n\t\t\t});\n\t\t})\n\t}\n\n\tmovePost(params)\n\t{\n\t\tconst state = (params.state ? params.state : null);\n\t\tconst node = (params.node ? params.node : null);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (\n\t\t\t\t!node\n\t\t\t\t|| !['Y', 'N'].includes(state)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst post = node.closest('[data-livefeed-post-pinned]');\n\t\t\tif (!post)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst logId = parseInt(post.getAttribute('data-livefeed-id'));\n\t\t\tif (!logId)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\t\tif (!pinnedPanelNode)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst postToMove = (post.parentNode.classList.contains(`${this.class.post}`) ? post.parentNode : post);\n\n\t\t\tconst entityValue = post.getAttribute('data-security-entity-pin');\n\t\t\tconst tokenValue = post.getAttribute('data-security-token-pin');\n\n\t\t\tif (state === 'Y')\n\t\t\t{\n\t\t\t\tconst originalPostHeight = postToMove.offsetHeight;\n\t\t\t\tpostToMove.setAttribute('bx-data-height', originalPostHeight);\n\n\t\t\t\tthis.getPinnedData({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tentityValue: entityValue,\n\t\t\t\t\ttokenValue: tokenValue,\n\t\t\t\t}).then(data => {\n\t\t\t\t\tconst pinnedPanelTitleNode = post.querySelector('.feed-post-pinned-title');\n\t\t\t\t\tconst pinnedPanelDescriptionNode = post.querySelector('.feed-post-pinned-desc');\n\t\t\t\t\tconst pinnedPanelPinNode = post.querySelector(`.${this.class.pin}`);\n\n\t\t\t\t\tif (pinnedPanelTitleNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelTitleNode.innerHTML = data.TITLE;\n\t\t\t\t\t}\n\t\t\t\t\tif (pinnedPanelDescriptionNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelDescriptionNode.innerHTML = data.DESCRIPTION;\n\t\t\t\t\t}\n\t\t\t\t\tif (pinnedPanelPinNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelPinNode.title = Loc.getMessage('SONET_EXT_LIVEFEED_PIN_TITLE_Y');\n\t\t\t\t\t}\n\n\t\t\t\t\tpost.classList.add(`${this.class.postPinnedHide}`);\n\n\t\t\t\t\tconst cancelPinnedPanel = this.getCancelPinnedPanel({ logId });\n\t\t\t\t\tconst anchor = postToMove.nextSibling;\n\n\t\t\t\t\tanchor.parentNode.insertBefore(cancelPinnedPanel, anchor);\n\t\t\t\t\tthis.centerCancelPinnedPanelElements({ cancelPinnedPanel });\n\n\t\t\t\t\tcancelPinnedPanel.setAttribute('bx-data-height', originalPostHeight);\n\t\t\t\t\tconst cancelPanelHeight = cancelPinnedPanel.getAttribute('bx-data-height');\n\n\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\theight: cancelPanelHeight + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\theight: originalPostHeight + 'px',\n\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\topacity: 0\n\t\t\t\t\t});\n\n\t\t\t\t\tconst panelNode = this.getPanelNode();\n\t\t\t\t\tif (panelNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\tpanelHeight: panelNode.offsetHeight\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// list.post::hide.start, cancelPanel::show.start\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tpostToMove.classList.add(`${this.class.postHide}`);\n\t\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\t\theight: '53px'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\t\topacity: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\tpinBlocked: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\t// list.post::hide.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\n\t\t\t\t\t\tconst panelPostsNode = pinnedPanelNode.querySelector(`.${this.class.panelPosts}`);\n\n\t\t\t\t\t\tpanelPostsNode.insertBefore(postToMove, panelPostsNode.firstChild);\n\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\n\t\t\t\t\t\tpostToMove.classList.remove(`${this.class.postHide}`);\n\t\t\t\t\t\tpost.classList.remove(`${this.class.postPinnedHide}`);\n\n\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t\tthis.showCollapsedPostsPanel();\n\n\t\t\t\t\t\t// pinnedPanel.post::show.start\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tpost.classList.add(`${this.class.postPinned}`);\n\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\tposition: '',\n\t\t\t\t\t\t\t\twidth: '',\n\t\t\t\t\t\t\t\theight: '80px',\n\t\t\t\t\t\t\t\tbackgroundColor: '',\n\t\t\t\t\t\t\t\topacity: 1\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\t\tpinBlocked: false\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tpostToMove.classList.remove(`${this.class.postHide}`);\n\t\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\t\tposition: '',\n\t\t\t\t\t\t\t\t\twidth: '',\n\t\t\t\t\t\t\t\t\theight: '',\n\t\t\t\t\t\t\t\t\tbackgroundColor: '',\n\t\t\t\t\t\t\t\t\topacity: ''\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}, 600); // 600 > transition 0.5\n\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn resolve();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst height = postToMove.getAttribute('bx-data-height');\n\t\t\t\tconst pinnedHeight = postToMove.scrollHeight;\n\n\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\ttransition: '',\n\t\t\t\t});\n\n\t\t\t\tconst cancelPinnedPanel = document.querySelector(`.${this.class.cancelPanel}[bx-data-log-id=\"${logId}\"]`);\n\t\t\t\tif (Type.isDomNode(cancelPinnedPanel))\n\t\t\t\t{\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\theight: pinnedHeight + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\t// pinnedPanel.post::hide.start, cancelPanel::show.start\n\t\t\t\t\trequestAnimationFrame(() => {\n\n\t\t\t\t\t\tpostToMove.classList.add(`${this.class.postExpanding}`);\n\t\t\t\t\t\tcancelPinnedPanel.classList.add(`${this.class.postExpanding}`);\n\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\theight: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\theight: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tconst collapsed = pinnedPanelNode.classList.contains(`${this.class.panelCollapsed}`);\n\n\t\t\t\t\tif (collapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tcancelPinnedPanel.parentNode.insertBefore(postToMove, cancelPinnedPanel.nextSibling);\n\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t}\n\n\t\t\t\t\tconst showCollapsed = this.getCollapsedPanelNode().classList.contains(`${this.class.collapsedPanelShow}`);\n\t\t\t\t\tif (showCollapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideCollapsedPostsPanel();\n\n\t\t\t\t\t\t// cancelPanel::show.end\n\t\t\t\t\t\tEvent.unbindAll(cancelPinnedPanel, 'transitionend');\n\t\t\t\t\t\tEvent.bind(cancelPinnedPanel, 'transitionend', (event) => {\n\t\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\ttransform: '',\n\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.animateCancel({\n\t\t\t\t\t\t\t\tpost,\n\t\t\t\t\t\t\t\tpostToMove,\n\t\t\t\t\t\t\t\tcancelPinnedPanel,\n\t\t\t\t\t\t\t\theight\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// pinnedPanel.post::hide.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'opacity'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!collapsed)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcancelPinnedPanel.parentNode.insertBefore(postToMove, cancelPinnedPanel.nextSibling);\n\t\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\t\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.animateCancel({\n\t\t\t\t\t\t\tpost,\n\t\t\t\t\t\t\tpostToMove,\n\t\t\t\t\t\t\tcancelPinnedPanel,\n\t\t\t\t\t\t\theight\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpost.classList.remove(`${this.class.postPinned}`);\n\t\t\t\t\tpinnedPanelNode.parentNode.insertBefore(postToMove, pinnedPanelNode.nextSibling);\n\t\t\t\t\tthis.adjustPanel();\n\n\t\t\t\t\tconst originalPostHeight = postToMove.scrollHeight;\n\t\t\t\t\tpostToMove.setAttribute('bx-data-height', originalPostHeight);\n\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\theight: '80px'\n\t\t\t\t\t});\n\n\t\t\t\t\t// list.post::show.start\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\t\theight: originalPostHeight + 'px'\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\t// list.post::show.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\theight:''\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\treturn resolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tanimateCancel({\n\t\tpost,\n\t \tpostToMove,\n\t\tcancelPinnedPanel,\n\t\theight\n\t})\n\t{\n\t\tpost.classList.remove(`${this.class.postPinned}`);\n\n\t\t// post.list:show.start, cancelPanel::hide.start\n\t\tsetTimeout(() => {\n\n\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\topacity: 1,\n\t\t\t\theight: height + 'px'\n\t\t\t});\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\theight: 0\n\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tcancelPinnedPanel.remove();\n\t\t\t}, 100)\n\t\t}, 100);\n\n\t\t// post.list:show.end\n\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpost.classList.remove(`${this.class.postPinnedHide}`);\n\n\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\tmarginBottom: '',\n\t\t\t\theight: ''\n\t\t\t});\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\tmarginBottom: '',\n\t\t\t\theight: ''\n\t\t\t});\n\n\t\t\tpostToMove.classList.remove(`${this.class.postExpanding}`);\n\t\t\tcancelPinnedPanel.classList.remove(`${this.class.postExpanding}`);\n\t\t});\n\t}\n\n\tgetCancelPinnedPanel(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet cancelPinnedPanel = document.querySelector(`.${this.class.cancelPanel}[bx-data-log-id=\"${logId}\"]`);\n\n\t\tif (!Type.isDomNode(cancelPinnedPanel))\n\t\t{\n\t\t\tcancelPinnedPanel = Tag.render`\n\t\t\t\t<div class=\"${this.class.cancelPanel}\" bx-data-log-id=\"${logId}\">\n\t\t\t\t\t<div class=\"feed-post-cancel-pinned-panel-inner\">\n\t\t\t\t\t\t<div class=\"feed-post-cancel-pinned-content\">\n\t\t\t\t\t\t\t<span class=\"${this.class.cancelPanelLabel}\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_TITLE')}</span>\n\t\t\t\t\t\t\t<span class=\"feed-post-cancel-pinned-text\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_DESCRIPTION')}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-round ui-btn-sm ${this.class.cancelPanelButton}\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_BUTTON')}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t\t`;\n\n\t\t\tEvent.bind(cancelPinnedPanel.querySelector(`.${this.class.cancelPanelButton}`), 'click', () => {\n\t\t\t\tthis.changePinned({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tnewState: 'N'\n\t\t\t\t}).then(() => {\n\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\theight: 0\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn cancelPinnedPanel;\n\t}\n\n\tcenterCancelPinnedPanelElements({ cancelPinnedPanel })\n\t{\n\t\tif (!Type.isDomNode(cancelPinnedPanel))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// cancelPanel::show.start\n\t\tsetTimeout(() => {\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\topacity: 1\n\t\t\t});\n\t\t}, 100);\n\n\t\tUtils.setStyle(cancelPinnedPanel.querySelector(`.${this.class.cancelPanelLabel}`), {\n\t\t\tmarginLeft: cancelPinnedPanel.querySelector(`.${this.class.cancelPanelButton}`).getBoundingClientRect().width + 'px'\n\t\t});\n\t}\n\n\tgetPostsCount()\n\t{\n\t\tconst panelNode = this.getPanelNode();\n\t\treturn (panelNode ? Array.from(panelNode.getElementsByClassName(`${this.class.post}`)).length : 0);\n\t}\n\n\thidePinnedItems()\n\t{\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\theight: parseInt(this.getOption('panelHeight')) + 'px'\n\t\t});\n\n\t\tArray.from(pinnedPanelNode.getElementsByClassName(`${this.class.post}`)).reduce((count, item) => {\n\n\t\t\tcount += item.offsetHeight;\n\n\t\t\tUtils.setStyle(item, {\n\t\t\t\ttransition: 'opacity .1s linear, transform .2s .1s linear, height .5s linear'\n\t\t\t});\n\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\ttransition: 'height .5s .1s linear'\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::hide.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\topacity: '0!important',\n\t\t\t\t\ttransform: `translateY(-${count}px)`\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: '58px'\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::hide.end\n\t\t\tEvent.unbindAll(item, 'transitionend');\n\t\t\tEvent.bind(item, 'transitionend', (event) => {\n\t\t\t\tif (!this.checkTransitionProperty(event, 'transform'))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\topacity: '',\n\t\t\t\t\ttransform: '',\n\t\t\t\t\ttransition: ''\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\ttransition: ''\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn count;\n\t\t}, 0);\n\t}\n\n\tshowPinnedItems()\n\t{\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tArray.from(pinnedPanelNode.getElementsByClassName(`${this.class.post}`)).map((item, currentIndex, originalItemsList) => {\n\n\t\t\tUtils.setStyle(item, {\n\t\t\t\tdisplay: 'block',\n\t\t\t\topacity: 0\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::show.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: ((84 * (currentIndex + 1)) - 4) + 'px'\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\ttransform: `translateY(${0}px)`,\n\t\t\t\t\topacity: 1\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::show.end\n\t\t\tEvent.unbindAll(item, 'transitionend');\n\t\t\tEvent.bind(item, 'transitionend', (event) => {\n\t\t\t\tif (!this.checkTransitionProperty(event, 'transform'))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\theight: '',\n\t\t\t\t\ttransform: ''\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: ''\n\t\t\t\t});\n\n\t\t\t\tif ((currentIndex + 1) === originalItemsList.length)\n\t\t\t\t{\n\t\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\t\ttransition: '',\n\t\t\t\t\t\theight: ''\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tanimateCollapsedPanel()\n\t{\n\t\t// collapsedPanel::hide.start\n\t\trequestAnimationFrame(() => {\n\t\t\tconst collapsedPanel = this.getCollapsedPanelNode();\n\n\t\t\tUtils.setStyle(collapsedPanel, {\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: 0,\n\t\t\t\twidth: '100%',\n\t\t\t\topacity: 0\n\t\t\t});\n\n\t\t\tcollapsedPanel.classList.remove(`${this.class.collapsedPanelHide}`);\n\t\t\tcollapsedPanel.classList.add(`${this.class.collapsedPanelShow}`);\n\n\t\t\t// collapsedPanel::show.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(collapsedPanel, {\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\topacity: 1\n\t\t\t\t});\n\t\t\t});\n\t\t})\n\t}\n\n\tadjustCollapsedPostsPanel()\n\t{\n\t\tconst postsCounter = this.getPostsCount();\n\t\tconst postsCounterNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterPostsValue}`);\n\t\tif (postsCounterNode)\n\t\t{\n\t\t\tpostsCounterNode.innerHTML = parseInt(postsCounter);\n\t\t}\n\n\t\tconst commentsCounterNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterComments}`);\n\t\tconst commentsCounterValueNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterCommentsValue}`);\n\t\tconst panelNode = this.getPanelNode();\n\n\t\tif (\n\t\t\tcommentsCounterNode\n\t\t\t&& commentsCounterValueNode\n\t\t\t&& panelNode\n\t\t)\n\t\t{\n\t\t\tconst newCommentCounter = Array.from(panelNode.querySelectorAll(`.${this.class.collapsedPanelCounterCommentsValueNewValue}`)).reduce((acc, node) => {\n\t\t\t\treturn acc + (node.closest(`.${this.class.postUnfollowed}`) ? 0 : parseInt(node.innerHTML));\n\t\t\t}, 0);\n\n\t\t\tcommentsCounterValueNode.innerHTML = newCommentCounter;\n\t\t\tif (newCommentCounter > 0)\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.add(`${this.class.collapsedPanelCounterCommentsShown}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.remove(`${this.class.collapsedPanelCounterCommentsShown}`);\n\t\t\t}\n\t\t}\n\t}\n\n\tadjustPanel()\n\t{\n\t\tconst panelNode = this.getPanelNode();\n\t\tif (!panelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.getPostsCount() > 0)\n\t\t\t{\n\t\t\t\tpanelNode.classList.add(`${this.class.panelNonEmpty}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpanelNode.classList.remove(`${this.class.panelNonEmpty}`);\n\t\t\t}\n\t\t}, 0);\n\t}\n\n\tshowCollapsedPostsPanel()\n\t{\n\t\tif (this.getPostsCount() >= Loc.getMessage('SONET_EXT_LIVEFEED_COLLAPSED_PINNED_PANEL_ITEMS_LIMIT'))\n\t\t{\n\t\t\tthis.showCollapsedPanel();\n\t\t\tthis.hidePinnedItems();\n\t\t}\n\t}\n\n\thideCollapsedPostsPanel()\n\t{\n\t\tif (this.getPostsCount() < Loc.getMessage('SONET_EXT_LIVEFEED_COLLAPSED_PINNED_PANEL_ITEMS_LIMIT'))\n\t\t{\n\t\t\tthis.getPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t\t\tthis.removeCollapsedPanel();\n\t\t\tthis.showPinnedItems();\n\t\t}\n\t}\n\n\tshowCollapsedPanel()\n\t{\n\t\tthis.getPanelNode().classList.add(`${this.class.panelCollapsed}`);\n\t\tthis.animateCollapsedPanel();\n\t}\n\n\thideCollapsedPanel()\n\t{\n\t\tthis.getPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t\tthis.showPinnedItems();\n\t\tthis.removeCollapsedPanel();\n\t}\n\n\tremoveCollapsedPanel()\n\t{\n\t\tconst collapsedPanel = this.getCollapsedPanelNode();\n\n\t\tUtils.setStyle(collapsedPanel, {\n\t\t\tposition: 'absolute',\n\t\t\ttop: 0,\n\t\t\twidth: '100%'\n\t\t});\n\n\t\tcollapsedPanel.classList.remove(`${this.class.collapsedPanelShow}`);\n\t\tcollapsedPanel.classList.add(`${this.class.collapsedPanelHide}`);\n\t}\n\n\tgetCommentsNodes(xmlId)\n\t{\n\t\tconst result = {\n\t\t\tfollow: true,\n\t\t\tnewNode: null,\n\t\t\tnewValueNode: null,\n\t\t\toldNode: null,\n\t\t\tallNode: null\n\t\t};\n\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst commentsNode = document.querySelector(`.${this.class.postComments}[data-bx-comments-entity-xml-id=\"${xmlId}\"]`);\n\t\tif (!commentsNode)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst postNode = commentsNode.closest(`.${this.class.postPinActive}`);\n\t\tif (!postNode)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst newPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueNew}`);\n\t\tconst newValuePinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueNewValue}`);\n\t\tconst oldPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueOld}`);\n\t\tconst allPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueAll}`);\n\n\t\tif (\n\t\t\t!newPinnedCommentsNode\n\t\t\t|| !newValuePinnedCommentsNode\n\t\t\t|| !oldPinnedCommentsNode\n\t\t\t|| !allPinnedCommentsNode\n\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tresult.newNode = newPinnedCommentsNode;\n\t\tresult.newValueNode = newValuePinnedCommentsNode;\n\t\tresult.oldNode = oldPinnedCommentsNode;\n\t\tresult.allNode = allPinnedCommentsNode;\n\t\tresult.follow = (commentsNode.getAttribute('data-bx-follow') !== 'N');\n\n\t\treturn result;\n\t}\n\n\tgetCommentsData(xmlId)\n\t{\n\t\tconst result = {\n\t\t\tnewValue: null,\n\t\t\toldValue: null,\n\t\t\tallValue: null\n\t\t};\n\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst { newValueNode, oldNode, allNode, follow } = this.getCommentsNodes(xmlId);\n\n\t\tresult.follow = follow;\n\n\t\tif (\n\t\t\t!Type.isDomNode(newValueNode)\n\t\t\t|| !Type.isDomNode(oldNode)\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tlet newCommentsValue = 0;\n\t\tlet oldCommentsValue = 0;\n\t\tlet allCommentsValue = 0;\n\n\t\tlet matches = newValueNode.innerHTML.match(/(\\d+)/);\n\n\t\tif (matches)\n\t\t{\n\t\t\tnewCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tmatches = oldNode.innerHTML.match(/(\\d+)/);\n\t\tif (matches)\n\t\t{\n\t\t\toldCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tmatches = allNode.innerHTML.match(/(\\d+)/);\n\t\tif (matches)\n\t\t{\n\t\t\tallCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tresult.oldValue = oldCommentsValue;\n\t\tresult.newValue = newCommentsValue;\n\t\tresult.allValue = allCommentsValue;\n\n\t\treturn result;\n\t}\n\n\tsetCommentsData(xmlId, value)\n\t{\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { newNode, newValueNode, oldNode, allNode } = this.getCommentsNodes(xmlId);\n\t\tif (\n\t\t\t!Type.isDomNode(newNode)\n\t\t\t|| !Type.isDomNode(newValueNode)\n\t\t\t|| !Type.isDomNode(oldNode)\n\t\t\t|| !Type.isDomNode(allNode)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isInteger(value.newValue))\n\t\t{\n\t\t\tnewValueNode.innerHTML = `${value.newValue}`;\n\t\t\tif (\n\t\t\t\tvalue.newValue > 0\n\t\t\t\t&& !newNode.classList.contains(`${this.class.collapsedPanelCounterCommentsValueNewActive}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tnewNode.classList.add(`${this.class.collapsedPanelCounterCommentsValueNewActive}`);\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tvalue.newValue <= 0\n\t\t\t\t&& newNode.classList.contains(`${this.class.collapsedPanelCounterCommentsValueNewActive}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tnewNode.classList.remove(`${this.class.collapsedPanelCounterCommentsValueNewActive}`);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isInteger(value.oldValue))\n\t\t{\n\t\t\toldNode.innerHTML = value.oldValue;\n\t\t}\n\n\t\tif (Type.isInteger(value.allValue))\n\t\t{\n\t\t\tallNode.innerHTML = value.allValue;\n\t\t}\n\n\t\tthis.adjustCollapsedPostsPanel();\n\t}\n\n\tgetCollapsedPanelNode()\n\t{\n\t\treturn this.getPanelNode().querySelector(`.${this.class.collapsedPanel}`);\n\t}\n\n\tcheckTransitionProperty(event, propertyName)\n\t{\n\t\treturn (event.propertyName === propertyName);\n\t}\n}\n\nexport {\n\tPinnedPanel\n};\n","import {ajax, Type, Loc, Dom, Tag} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nexport class TaskCreator\n{\n\tstatic createTaskPopup = null;\n\tstatic cssClass = {\n\t\tpopupContent: 'feed-create-task-popup-content',\n\t\tpopupTitle: 'feed-create-task-popup-title',\n\t\tpopupDescription: 'feed-create-task-popup-description',\n\t};\n\tstatic signedFiles = null;\n\tstatic sliderUrl = '';\n\n\tconstructor()\n\t{\n\t\tthis.initEvents();\n\t}\n\n\tinitEvents()\n\t{\n\n\t\tEventEmitter.subscribe('tasksTaskEvent', (event: BaseEvent) => {\n\n\t\t\tconst [ type, data ] = event.getCompatData();\n\t\t\tif (\n\t\t\t\ttype !== 'ADD'\n\t\t\t\t|| !Type.isPlainObject(data.options)\n\t\t\t\t|| !Type.isBoolean(data.options.STAY_AT_PAGE)\n\t\t\t\t|| data.options.STAY_AT_PAGE\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tTaskCreator.signedFiles = null;\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseComplete', (event: BaseEvent) => {\n\n\t\t\tconst sliderInstance = event.getTarget();\n\t\t\tif (!sliderInstance)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst sliderUrl = sliderInstance.getUrl();\n\t\t\tif (\n\t\t\t\t!Type.isStringFilled(sliderUrl)\n\t\t\t\t|| sliderUrl !== TaskCreator.sliderUrl\n\t\t\t\t|| !Type.isStringFilled(TaskCreator.signedFiles)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tajax.runAction('intranet.controlbutton.clearNewTaskFiles', {\n\t\t\t\tdata: {\n\t\t\t\t\tsignedFiles: TaskCreator.signedFiles,\n\t\t\t\t},\n\t\t\t}).then(() => {\n\t\t\t\tTaskCreator.signedFiles = null;\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic create(params)\n\t{\n\t\tif (Loc.getMessage('SONET_EXT_LIVEFEED_INTRANET_INSTALLED') === 'Y')\n\t\t{\n\t\t\tajax.runAction('intranet.controlbutton.getTaskLink', {\n\t\t\t\tdata: {\n\t\t\t\t\tentityType: params.entityType,\n\t\t\t\t\tentityId: params.entityId,\n\t\t\t\t\tpostEntityType: (Type.isStringFilled(params.postEntityType) ? params.postEntityType : params.entityType),\n\t\t\t\t\tentityData: {},\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\n\t\t\t\tif (!Type.isStringFilled(response.data.SUFFIX))\n\t\t\t\t{\n\t\t\t\t\tresponse.data.SUFFIX = '';\n\t\t\t\t}\n\n\n\t\t\t\tconst requestData = response.data;\n\n\t\t\t\trequestData.DESCRIPTION = this.formatTaskDescription(requestData.DESCRIPTION, requestData.URL, params.entityType, requestData.SUFFIX);\n\n\t\t\t\tif (parseInt(params.parentTaskId) > 0)\n\t\t\t\t{\n\t\t\t\t\trequestData.PARENT_ID = parseInt(params.parentTaskId);\n\t\t\t\t}\n\n\t\t\t\tif (Type.isStringFilled(requestData.UF_TASK_WEBDAV_FILES_SIGN))\n\t\t\t\t{\n\t\t\t\t\tthis.signedFiles = requestData.UF_TASK_WEBDAV_FILES_SIGN;\n\t\t\t\t}\n\n\t\t\t\tthis.sliderUrl = response.data.link;\n\n\t\t\t\tBX.SidePanel.Instance.open(response.data.link, {\n\t\t\t\t\trequestMethod: 'post',\n\t\t\t\t\trequestParams: requestData,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.createTaskPopup = new Popup('BXCTP', null, {\n\t\t\t\tautoHide: false,\n\t\t\t\tzIndex: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toverlay: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcloseIcon: {\n\t\t\t\t\tright: '12px',\n\t\t\t\t\ttop: '10px',\n\t\t\t\t},\n\t\t\t\tdraggable: {\n\t\t\t\t\trestrict: true,\n\t\t\t\t},\n\t\t\t\tcloseByEsc: false,\n\t\t\t\tcontentColor : 'white',\n\t\t\t\tcontentNoPaddings: true,\n\t\t\t\tbuttons: [],\n\t\t\t\tcontent: Tag.render`<div id=\"BXCTP_content\" class=\"${this.cssClass.popupContent}\"></div>`,\n\t\t\t\tevents: {\n\t\t\t\t\tonAfterPopupShow: () => {\n\t\t\t\t\t\tthis.createTaskSetContent(Tag.render`<div class=\"${this.cssClass.popupTitle}\">${Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_WAIT')}</div>`);\n\n\t\t\t\t\t\tajax.runAction('socialnetwork.api.livefeed.getRawEntryData', {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tentityType: params.entityType,\n\t\t\t\t\t\t\t\t\tentityId: params.entityId,\n\t\t\t\t\t\t\t\t\tlogId: (Type.isNumber(params.logId) ? params.logId : null),\n\t\t\t\t\t\t\t\t\tadditionalParams: {\n\t\t\t\t\t\t\t\t\t\tgetSonetGroupAvailable: 'Y',\n\t\t\t\t\t\t\t\t\t\tgetLivefeedUrl: 'Y',\n\t\t\t\t\t\t\t\t\t\tcheckPermissions: {\n\t\t\t\t\t\t\t\t\t\t\tfeature: 'tasks',\n\t\t\t\t\t\t\t\t\t\t\toperation: 'create_tasks',\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then((response) => {\n\n\t\t\t\t\t\t\tconst entryTitle = (Type.isStringFilled(response.data.TITLE) ? response.data.TITLE : '');\n\t\t\t\t\t\t\tconst entryDescription = (Type.isStringFilled(response.data.DESCRIPTION) ? response.data.DESCRIPTION : '');\n\t\t\t\t\t\t\tconst entryDiskObjects = (Type.isPlainObject(response.data.DISK_OBJECTS) ? response.data.DISK_OBJECTS : []);\n\t\t\t\t\t\t\tconst entryUrl = (Type.isStringFilled(response.data.LIVEFEED_URL) ? response.data.LIVEFEED_URL : '');\n\t\t\t\t\t\t\tconst entrySuffix = (Type.isStringFilled(response.data.SUFFIX) ? response.data.SUFFIX : '');\n\t\t\t\t\t\t\tconst groupsAvailable = (Type.isPlainObject(response.data.GROUPS_AVAILABLE) ? response.data.GROUPS_AVAILABLE : []);\n\t\t\t\t\t\t\tconst logId = (!Type.isUndefined(response.data.LOG_ID) ? parseInt(response.data.LOG_ID) : 0);\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\tType.isStringFilled(entryTitle)\n\t\t\t\t\t\t\t\t\t|| Type.isStringFilled(entryDescription)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t&& Type.isStringFilled(entryUrl)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst taskDescription = this.formatTaskDescription(entryDescription, entryUrl, params.entityType, entrySuffix);\n\t\t\t\t\t\t\t\tconst taskData = {\n\t\t\t\t\t\t\t\t\tTITLE: entryTitle,\n\t\t\t\t\t\t\t\t\tDESCRIPTION: taskDescription,\n\t\t\t\t\t\t\t\t\tRESPONSIBLE_ID: Loc.getMessage('USER_ID'),\n\t\t\t\t\t\t\t\t\tCREATED_BY: Loc.getMessage('USER_ID'),\n\t\t\t\t\t\t\t\t\tUF_TASK_WEBDAV_FILES: entryDiskObjects,\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tconst sonetGroupIdList = [];\n\n\t\t\t\t\t\t\t\tfor (const [key, value] of Object.entries(groupsAvailable))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tsonetGroupIdList.push(value);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (sonetGroupIdList.length == 1)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttaskData.GROUP_ID = parseInt(sonetGroupIdList[0]);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (parseInt(params.entityType) > 0)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttaskData.PARENT_ID = parseInt(params.entityType);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tajax.runComponentAction('bitrix:tasks.task', 'legacyAdd', {\n\t\t\t\t\t\t\t\t\tmode: 'class',\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tdata: taskData,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}).then((response) => {\n\n\t\t\t\t\t\t\t\t\tconst resultData = response.data;\n\n\t\t\t\t\t\t\t\t\tthis.createTaskSetContentSuccess(resultData.DATA.ID);\n\n\t\t\t\t\t\t\t\t\tajax.runAction('socialnetwork.api.livefeed.createEntityComment', {\n\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\t\t\t\tpostEntityType: (Type.isStringFilled(params.postEntityType) ? params.postEntityType : params.entityType),\n\t\t\t\t\t\t\t\t\t\t\t\tsourceEntityType: params.entityType,\n\t\t\t\t\t\t\t\t\t\t\t\tsourceEntityId: params.entityId,\n\t\t\t\t\t\t\t\t\t\t\t\tentityType: 'TASK',\n\t\t\t\t\t\t\t\t\t\t\t\tentityId: resultData.DATA.ID,\n\t\t\t\t\t\t\t\t\t\t\t\tlogId: (\n\t\t\t\t\t\t\t\t\t\t\t\t\tType.isNumber(params.logId)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? params.logId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: logId > 0 ? logId : null\n\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}, (response) => {\n\t\t\t\t\t\t\t\t\tif (response.errors && response.errors.length)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tconst errors = [];\n\t\t\t\t\t\t\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\t\t\t\t\t\t\terrors.push(error.message);\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\tthis.createTaskSetContentFailure(errors);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.createTaskSetContentFailure([\n\t\t\t\t\t\t\t\t\tLoc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_ERROR_GET_DATA'),\n\t\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\tthis.createTaskSetContentFailure([\n\t\t\t\t\t\t\t\tLoc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_ERROR_GET_DATA'),\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.createTaskPopup.destroy();\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.createTaskPopup.show();\n\t\t}\n\t}\n\n\tstatic createTaskSetContentSuccess(taskId) {\n\n\t\tconst taskLink = Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_PATH').replace('#user_id#', Loc.getMessage('USER_ID')).replace('#task_id#', taskId);\n\n\t\tthis.createTaskPopup.destroy();\n\n\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_SUCCESS_TITLE'),\n\t\t\tactions: [{\n\t\t\t\ttitle: Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_VIEW'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (event, balloon, action) => {\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\twindow.top.BX.SidePanel.Instance.open(taskLink);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}],\n\n\t\t});\n\t}\n\n\tstatic createTaskSetContentFailure(errors)\n\t{\n\t\tthis.createTaskSetContent(Tag.render`<div>\n\t\t\t<div class=\"${this.cssClass.popupTitle}\">${Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_FAILURE_TITLE')}</div>\n\t\t\t<div class=\"${this.cssClass.popupDescription}\">${errors.join('<br>')}</div>\n\t\t</div>`);\n\t}\n\n\tstatic createTaskSetContent(contentNode)\n\t{\n\t\tconst containerNode = document.getElementById('BXCTP_content');\n\t\tif (!containerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(containerNode);\n\t\tcontainerNode.appendChild(contentNode);\n\t}\n\n\tstatic formatTaskDescription(taskDescription, livefeedUrl, entityType, suffix)\n\t{\n\t\tlet result = taskDescription;\n\n\t\tsuffix = (Type.isStringFilled(suffix) ? `_${suffix}` : '');\n\n\t\tif (\n\t\t\t!!livefeedUrl\n\t\t\t&& !!entityType\n\t\t\t&& livefeedUrl.length > 0\n\t\t)\n\t\t{\n\t\t\tresult += \"\\n\\n\" + Loc.getMessage(`SONET_EXT_COMMENTAUX_CREATE_TASK_${entityType}${suffix}`).replace(\n\t\t\t\t'#A_BEGIN#', `[URL=${livefeedUrl}]`\n\t\t\t).replace(\n\t\t\t\t'#A_END#', '[/URL]'\n\t\t\t);\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type, Loc, Tag, Dom} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {Button} from 'ui.buttons';\nimport {MenuManager} from 'main.popup';\n\nimport {FeedInstance, PinnedPanelInstance} from './feed';\nimport {TaskCreator} from './taskcreator';\n\nclass Post\n{\n\tstatic showBackgroundWarning({\n\t\turlToEdit,\n\t\tmenuPopupWindow\n\t})\n\t{\n\t\tconst content = Tag.render`<div>${Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_DESCRIPTION')}</div>`;\n\n\t\tconst dialog = new Popup('backgroundWarning', null, {\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tdraggable: true,\n\t\t\tbindOnResize: false,\n\t\t\ttitleBar: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_TITLE'),\n\t\t\tcloseIcon: true,\n\t\t\tclassName: 'sonet-livefeed-popup-warning',\n\t\t\tcontent: content,\n\t\t\tevents: {},\n\t\t\tcacheable: false,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_BUTTON_SUBMIT'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-primary',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\twindow.location = urlToEdit;\n\t\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\t\tif (menuPopupWindow)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmenuPopupWindow.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_BUTTON_CANCEL'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-light',\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\tif (menuPopupWindow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuPopupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tdialog.show();\n\n\t\treturn false;\n\t}\n\n\tstatic showMenu(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tconst menuElement = params.menuElement;\n\t\tconst ind = params.ind;\n\t\tconst menuId = this.getMenuId(ind);\n\n\t\tMenuManager.destroy(menuId);\n\n\t\tlet log_id = (!Type.isUndefined(params.log_id) ? parseInt(params.log_id) : 0);\n\n\t\tif (log_id <= 0)\n\t\t{\n\t\t\tlog_id = parseInt(menuElement.getAttribute('data-log-entry-log-id'));\n\t\t}\n\t\tif (log_id <= 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet bFavorites = params.bFavorites;\n\t\tif (Type.isUndefined(bFavorites))\n\t\t{\n\t\t\tbFavorites = (menuElement.getAttribute('data-log-entry-favorites') === 'Y');\n\t\t}\n\n\t\tlet arMenuItemsAdditional = params.arMenuItemsAdditional;\n\t\tif (Type.isUndefined(arMenuItemsAdditional))\n\t\t{\n\t\t\tarMenuItemsAdditional = menuElement.getAttribute('data-bx-items');\n\t\t\ttry\n\t\t\t{\n\t\t\t\tarMenuItemsAdditional = JSON.parse(arMenuItemsAdditional);\n\t\t\t\tif (!Type.isPlainObject(arMenuItemsAdditional))\n\t\t\t\t{\n\t\t\t\t\tarMenuItemsAdditional = {};\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tarMenuItemsAdditional = {};\n\t\t\t}\n\t\t}\n\n\t\tconst bindElement = params.bindElement;\n\n\t\tlet itemPinned = null;\n\t\tconst pinnedPostNode = bindElement.closest('[data-livefeed-post-pinned]');\n\t\tif (pinnedPostNode)\n\t\t{\n\t\t\tconst pinnedState = (pinnedPostNode.getAttribute('data-livefeed-post-pinned') === 'Y');\n\n\t\t\titemPinned = {\n\t\t\t\ttext : (pinnedState ? Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_PINNED_Y') : Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_PINNED_N')),\n\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\tonclick: (e) => {\n\t\t\t\t\tPinnedPanelInstance.changePinned({\n\t\t\t\t\t\tlogId: log_id,\n\t\t\t\t\t\tnewState: (pinnedState ? 'N' : 'Y'),\n\t\t\t\t\t\tevent: e,\n\t\t\t\t\t\tnode: bindElement,\n\t\t\t\t\t});\n\n\t\t\t\t\tMenuManager.getMenuById(this.getMenuId(ind)).popupWindow.close();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tconst itemFavorites = (\n\t\t\tLoc.getMessage('sonetLbUseFavorites') !== 'N'\n\t\t\t\t? {\n\t\t\t\t\ttext: (bFavorites ? Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_Y') : Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_N')),\n\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\tonclick : (e) => {\n\t\t\t\t\t\t__logChangeFavorites(\n\t\t\t\t\t\t\tlog_id,\n\t\t\t\t\t\t\t`log_entry_favorites_${log_id}`,\n\t\t\t\t\t\t\t(bFavorites ? 'N' : 'Y'),\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\te\n\t\t\t\t\t\t);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t: null\n\t\t);\n\n\t\tlet arItems = [\n\t\t\titemPinned,\n\t\t\titemFavorites,\n\t\t\t(\n\t\t\t\tType.isStringFilled(menuElement.getAttribute('data-log-entry-url'))\n\t\t\t\t\t? {\n\t\t\t\t\t\thtml: `<span id=\"${menuId}-href-text\">${Loc.getMessage('sonetLMenuHref')}</span>`,\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon feed-entry-popup-menu feed-entry-popup-menu-href',\n\t\t\t\t\t\thref: menuElement.getAttribute('data-log-entry-url'),\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t\t(\n\t\t\t\tType.isStringFilled(menuElement.getAttribute('data-log-entry-url'))\n\t\t\t\t\t? {\n\t\t\t\t\t\thtml: `<span id=\"${menuId}-link-text\">${Loc.getMessage('sonetLMenuLink')}</span>` +\n\t\t\t\t\t\t\t`<span id=\"${menuId}-link-icon-animate\" class=\"post-menu-link-icon-wrap\">` +\n\t\t\t\t\t\t\t`<span class=\"post-menu-link-icon\" id=\"${menuId}-link-icon-done\" style=\"display: none;\">` +\n\n\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t'</span>',\n\t\t\t\t\t\tclassName : 'menu-popup-no-icon feed-entry-popup-menu feed-entry-popup-menu-link',\n\t\t\t\t\t\tonclick: (e) => {\n\n\t\t\t\t\t\t\tconst menuItemText = document.getElementById(`${menuId}-link-text`);\n\t\t\t\t\t\t\tconst menuItemIconDone = document.getElementById(`${menuId}-link-icon-done`);\n\n\t\t\t\t\t\t\tif (BX.clipboard.isCopySupported())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (menuItemText && menuItemText.getAttribute('data-block-click') === 'Y')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tBX.clipboard.copy(menuElement.getAttribute('data-log-entry-url'));\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tmenuItemText\n\t\t\t\t\t\t\t\t\t&& menuItemIconDone\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmenuItemIconDone.style.display = 'inline-block';\n\t\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link-icon-animate`).classList.remove('post-menu-link-icon-animate');\n\n\t\t\t\t\t\t\t\t\tDom.adjust(document.getElementById(`${menuId}-link-text`), {\n\t\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\t\t'data-block-click': 'Y',\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link-icon-animate`).classList.add('post-menu-link-icon-animate');\n\t\t\t\t\t\t\t\t\t}, 1);\n\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\tDom.adjust(document.getElementById(`${menuId}-link-text`), {\n\t\t\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\t\t\t'data-block-click': 'N',\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}, 500);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst it = e.currentTarget;\n\t\t\t\t\t\t\tconst height = parseInt(!!it.getAttribute('bx-height') ? it.getAttribute('bx-height') : it.offsetHeight);\n\n\t\t\t\t\t\t\tif (it.getAttribute('bx-status') !== 'shown')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tit.setAttribute('bx-status', 'shown');\n\n\t\t\t\t\t\t\t\tconst node = document.getElementById(`${menuId}-link-text`);\n\n\t\t\t\t\t\t\t\tif (!document.getElementById(`${menuId}-link`) && !!node)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst pos = BX.pos(node);\n\t\t\t\t\t\t\t\t\tconst pos2 = BX.pos(node.parentNode);\n\t\t\t\t\t\t\t\t\tconst pos3 = BX.pos(node.closest('.menu-popup-item'));\n\n\t\t\t\t\t\t\t\t\tpos.height = pos2.height - 1;\n\n\t\t\t\t\t\t\t\t\tDom.adjust(it, {\n\t\t\t\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\t\t\t\t'bx-height': it.offsetHeight,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tstyle : {\n\t\t\t\t\t\t\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tchildren : [\n\t\t\t\t\t\t\t\t\t\t\tDom.create('BR'),\n\t\t\t\t\t\t\t\t\t\t\tDom.create('DIV', {\n\t\t\t\t\t\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: `${menuId}-link`,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\tchildren : [\n\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {attrs: {className: 'menu-popup-item-left'}}),\n\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {attrs: {className: 'menu-popup-item-icon'}}),\n\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: 'menu-popup-item-text'},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren : [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('INPUT', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: `${menuId}-link-input`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: menuElement.getAttribute('data-log-entry-url'),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle : {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\theight: `${pos.height}px`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth: `${(pos3.width - 21)}px`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclick: (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.currentTarget.select();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {attrs: {className: 'menu-popup-item-right'}}),\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tEvent.bind(document.getElementById(`${menuId}-link-input`), 'click', (e) => {\n\t\t\t\t\t\t\t\t\t\te.currentTarget.select();\n\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\te.stopPropagation()\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t(new BX.fx({\n\t\t\t\t\t\t\t\t\ttime: 0.2,\n\t\t\t\t\t\t\t\t\tstep: 0.05,\n\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\tstart: height,\n\t\t\t\t\t\t\t\t\tfinish: height * 2,\n\t\t\t\t\t\t\t\t\tcallback: function (height) {\n\t\t\t\t\t\t\t\t\t\tthis.style.height = `${height}px`;\n\t\t\t\t\t\t\t\t\t}.bind(it),\n\t\t\t\t\t\t\t\t})).start();\n\t\t\t\t\t\t\t\tBX.fx.show(document.getElementById(`${menuId}-link`), 0.2);\n\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link-input`).select();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tit.setAttribute('bx-status', 'hidden');\n\t\t\t\t\t\t\t\t(new BX.fx({\n\t\t\t\t\t\t\t\t\ttime: 0.2,\n\t\t\t\t\t\t\t\t\tstep: 0.05,\n\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\tstart: it.offsetHeight,\n\t\t\t\t\t\t\t\t\tfinish: height,\n\t\t\t\t\t\t\t\t\tcallback: function(height) {\n\t\t\t\t\t\t\t\t\t\tthis.style.height = `${height}px`;\n\t\t\t\t\t\t\t\t\t}.bind(it),\n\t\t\t\t\t\t\t\t})).start();\n\t\t\t\t\t\t\t\tBX.fx.hide(document.getElementById(`${menuId}-link`), 0.2);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t\t(\n\t\t\t\tLoc.getMessage('sonetLCanDelete') === 'Y'\n\t\t\t\t\t? {\n\t\t\t\t\t\ttext: Loc.getMessage('sonetLMenuDelete'),\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\t\tonclick: (e) => {\n\t\t\t\t\t\t\tif (confirm(Loc.getMessage('sonetLMenuDeleteConfirm')))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tFeedInstance.delete({\n\t\t\t\t\t\t\t\t\tlogId: log_id,\n\t\t\t\t\t\t\t\t\tnodeId: `log-entry-${log_id}`,\n\t\t\t\t\t\t\t\t\tind: ind,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t} : null\n\t\t\t),\n\t\t\t(\n\t\t\t\tmenuElement.getAttribute('data-log-entry-createtask') === 'Y'\n\t\t\t\t\t? {\n\t\t\t\t\t\ttext: Loc.getMessage('sonetLMenuCreateTask'),\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\t\tonclick: (e) => {\n\t\t\t\t\t\t\tTaskCreator.create({\n\t\t\t\t\t\t\t\tentryEntityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityId: menuElement.getAttribute('data-log-entry-entity-id'),\n\t\t\t\t\t\t\t\tlogId: parseInt(menuElement.getAttribute('data-log-entry-log-id')),\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tMenuManager.getMenuById(this.getMenuId(ind)).popupWindow.close();\n\t\t\t\t\t\t\treturn e.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t\t(\n\t\t\t\tmenuElement.getAttribute('data-log-entry-createtask') === 'Y'\n\t\t\t\t&& menuElement.getAttribute('data-log-entry-entity-type') === 'TASK'\n\t\t\t\t\t? {\n\t\t\t\t\t\ttext: Loc.getMessage('sonetLMenuCreateSubTask'),\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\t\tonclick: (e) => {\n\t\t\t\t\t\t\tTaskCreator.create({\n\t\t\t\t\t\t\t\tentryEntityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityId: menuElement.getAttribute('data-log-entry-entity-id'),\n\t\t\t\t\t\t\t\tlogId: parseInt(menuElement.getAttribute('data-log-entry-log-id')),\n\t\t\t\t\t\t\t\tparentTaskId: parseInt(menuElement.getAttribute('data-log-entry-entity-id')),\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tMenuManager.getMenuById(this.getMenuId(ind)).popupWindow.close();\n\t\t\t\t\t\t\treturn e.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t];\n\n\t\tif (\n\t\t\t!!arMenuItemsAdditional\n\t\t\t&& Type.isArray(arMenuItemsAdditional)\n\t\t)\n\t\t{\n\t\t\tarMenuItemsAdditional.forEach((item) => {\n\t\t\t\tif (Type.isUndefined(item.className))\n\t\t\t\t{\n\t\t\t\t\titem.className = 'menu-popup-no-icon';\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tarItems = arItems.concat(arMenuItemsAdditional);\n\t\t}\n\n\t\tconst arParams = {\n\t\t\toffsetLeft: -14,\n\t\t\toffsetTop: 4,\n\t\t\tlightShadow: false,\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t\toffset : 50,\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonPopupShow: (ob) => {\n\t\t\t\t\tif (document.getElementById(`log_entry_favorites_${log_id}`))\n\t\t\t\t\t{\n\t\t\t\t\t\tlet favoritesMenuItem = null;\n\n\t\t\t\t\t\tconst menuItems = ob.contentContainer.querySelectorAll('.menu-popup-item-text');\n\t\t\t\t\t\tmenuItems.forEach((menuItem) => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tmenuItem.innerHTML === Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_Y')\n\t\t\t\t\t\t\t\t|| menuItem.innerHTML === Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_N')\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfavoritesMenuItem = menuItem;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (Type.isDomNode(favoritesMenuItem))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfavoritesMenuItem.innerHTML = (\n\t\t\t\t\t\t\t\tdocument.getElementById(`log_entry_favorites_${log_id}`).classList.contains('feed-post-important-switch-active')\n\t\t\t\t\t\t\t\t\t? Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_Y')\n\t\t\t\t\t\t\t\t\t: Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_N')\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (document.getElementById(`${menuId}-link`))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst linkMenuItem = ob.popupContainer.querySelector('.feed-entry-popup-menu-link');\n\t\t\t\t\t\tif (linkMenuItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst height = parseInt(!!linkMenuItem.getAttribute('bx-height') ? linkMenuItem.getAttribute('bx-height') : 0);\n\t\t\t\t\t\t\tif (height > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link`).style.display = 'none';\n\t\t\t\t\t\t\t\tlinkMenuItem.setAttribute('bx-status', 'hidden');\n\t\t\t\t\t\t\t\tlinkMenuItem.style.height = `${height}px`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tMenuManager.show(this.getMenuId(ind), bindElement, arItems, arParams);\n\t}\n\n\tstatic getMenuId(ind)\n\t{\n\t\treturn `post-menu-${ind}`;\n\t}\n\n}\n\nexport {\n\tPost\n};","import { Loc, Type, Runtime } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nclass Informer\n{\n\tconstructor()\n\t{\n\t\tthis.container = null;\n\t\tthis.wrap = null;\n\t\tthis.plus = null;\n\t\tthis.value = null;\n\n\t\tthis.currentSiteId = null;\n\t\tthis.currentCounterType = null;\n\n\t\tthis.counterDecrementStack = 0;\n\t\tthis.counterValue = 0;\n\n\t\tthis.lockCounterAnimation = null;\n\n\t\tthis.class = {\n\t\t\tinformerFixed: 'feed-new-message-informer-fixed',\n\t\t\tinformerAnimation: 'feed-new-message-informer-anim',\n\t\t\tinformerFixedAnimation: 'feed-new-message-informer-fix-anim',\n\t\t\tcounterText: 'feed-new-message-inf-text',\n\t\t\tcounterContainer: 'feed-new-message-inf-text-counter',\n\t\t\treloadContainer: 'feed-new-message-inf-text-reload',\n\t\t\ticon: 'feed-new-message-icon',\n\t\t\ticonRotating: 'new-message-balloon-icon-rotating',\n\t\t\tplusHidden: 'feed-new-message-informer-counter-plus-hidden',\n\t\t};\n\t}\n\n\tinit()\n\t{\n\t\tthis.initNodes();\n\t\tthis.initEvents();\n\t}\n\n\tinitNodes()\n\t{\n\t\tthis.currentCounterType = Loc.getMessage('sonetLCounterType') ? Loc.getMessage('sonetLCounterType') : '**';\n\t\tthis.currentSiteId = Loc.getMessage('SITE_ID');\n\n\t\tthis.container = document.getElementById('sonet_log_counter_2_container');\n\t\tif (this.container)\n\t\t{\n\t\t\tthis.container.addEventListener('click', this.showReloadAnimation.bind(this));\n\t\t}\n\n\t\tthis.wrap = document.getElementById('sonet_log_counter_2_wrap');\n\t\tthis.plus = document.getElementById('sonet_log_counter_2_plus');\n\t\tthis.value = document.getElementById('sonet_log_counter_2');\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('onGoUp', (event: BaseEvent) =>\n\t\t{\n\t\t\tthis.unfixWrap();\n\t\t});\n\n\t\tEventEmitter.subscribe('onPullEvent-main', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ command, eventParams ] = event.getData();\n\n\t\t\tif (\n\t\t\t\tcommand !== 'user_counter'\n\t\t\t\t|| !eventParams[this.currentSiteId]\n\t\t\t\t|| !eventParams[this.currentSiteId][this.currentCounterType]\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeCounter(Runtime.clone(eventParams[this.currentSiteId][this.currentCounterType]));\n\t\t});\n\n\t\tEventEmitter.subscribe('onImUpdateCounter', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ counterData ] = event.getData();\n\n\t\t\tif (\n\t\t\t\t!Type.isObjectLike(counterData)\n\t\t\t\t|| Type.isUndefined(counterData[this.currentCounterType])\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeCounter(counterData[this.currentCounterType]);\n\t\t});\n\n\t\tEventEmitter.subscribe('OnUCCommentWasRead', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, options ] = event.getData();\n\n\t\t\tif (\n\t\t\t\t!Type.isObjectLike(options)\n\t\t\t\t|| !options.live\n\t\t\t\t|| !options.new\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit('onCounterDecrement', new BaseEvent({\n\t\t\t\tcompatData: [1],\n\t\t\t}));\n\n\t\t\tthis.decrementCounter(1);\n\t\t});\n\t};\n\n\tchangeCounter(count)\n\t{\n\t\tthis.counterValue = parseInt(count);\n\n\t\tif (this.counterValue <= 0)\n\t\t{\n\t\t\tthis.counterDecrementStack = 0;\n\t\t}\n\n\t\tconst valueToShow = this.counterValue - this.counterDecrementStack;\n\n\t\tthis.changeAnimate({\n\t\t\tshow: (valueToShow > 0),\n\t\t\tcounter: valueToShow,\n\t\t\tzeroCounterFromDb: (valueToShow <= 0),\n\t\t});\n\t};\n\n\tchangeAnimate(params)\n\t{\n\t\tconst show = (!!params.show);\n\t\tconst counterValue = parseInt(params.counter);\n\t\tconst zeroCounterFromDb = !!params.zeroCounterFromDb;\n\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterTextNode = this.container.querySelector(`span.${this.class.counterText}`);\n\t\tconst reloadNode = this.container.querySelector(`span.${this.class.reloadContainer}`);\n\n\t\tif (this.lockCounterAnimation)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.changeAnimate({\n\t\t\t\t\tshow: show,\n\t\t\t\t\tcounter: counterValue,\n\t\t\t\t})\n\t\t\t}, 200);\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (show)\n\t\t{\n\t\t\tif (this.value)\n\t\t\t{\n\t\t\t\tthis.value.innerHTML = counterValue;\n\t\t\t}\n\n\t\t\tthis.showWrapAnimation();\n\n\t\t\tif (\n\t\t\t\tthis.plus\n\t\t\t\t&& reloadNode\n\t\t\t\t&& !reloadNode.classList.contains('--hidden')\n\t\t\t\t&& counterTextNode\n\t\t\t)\n\t\t\t{\n\t\t\t\treloadNode.classList.add('--hidden');\n\t\t\t\tcounterTextNode.classList.remove('--hidden');\n\t\t\t\tthis.plus.classList.remove(`${this.class.plusHidden}`);\n\t\t\t}\n\t\t}\n\t\telse if (this.wrap)\n\t\t{\n\t\t\tif (\n\t\t\t\tzeroCounterFromDb\n\t\t\t\t&& this.wrap.classList.contains(`${this.class.informerAnimation}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tcounterTextNode\n\t\t\t\t\t&& reloadNode\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tcounterTextNode.classList.add('--hidden');\n\t\t\t\t\treloadNode.classList.remove('--hidden');\n\n\t\t\t\t\tthis.hideReloadAnimation();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.hideWrapAnimation();\n\t\t\t\t}, 400);\n\t\t\t}\n\t\t}\n\t};\n\n\tshowWrapAnimation()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.style.visibility = 'visible';\n\t\tthis.wrap.classList.add(`${this.class.informerAnimation}`);\n\t};\n\n\thideWrapAnimation()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.remove(`${this.class.informerAnimation}`);\n\t\tthis.wrap.style.visibility = 'hidden';\n\t}\n\n\tshowReloadAnimation()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterWaiterNode = this.container.querySelector(`span.${this.class.icon}`);\n\t\tif (counterWaiterNode)\n\t\t{\n\t\t\tcounterWaiterNode.classList.add(this.class.iconRotating);\n\t\t}\n\t}\n\n\thideReloadAnimation()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterNodeWaiter = this.container.querySelector(`span.${this.class.icon}`);\n\t\tif (counterNodeWaiter)\n\t\t{\n\t\t\tcounterNodeWaiter.classList.remove(this.class.iconRotating);\n\t\t}\n\t}\n\n\tonFeedScroll()\n\t{\n\t\tif (\n\t\t\t!this.container\n\t\t\t|| !this.wrap\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst top = this.wrap.parentNode.getBoundingClientRect().top;\n//\t\tconst counterRect = this.container.getBoundingClientRect();\n\n\t\tif (top <= 53)\n\t\t{\n/*\n\t\t\tif (!this.wrap.classList.contains(`${this.class.informerFixed}`))\n\t\t\t{\n\t\t\t\tthis.container.style.left = `${(counterRect.left + (counterRect.width / 2))}px`;\n\t\t\t}\n*/\n\t\t\tthis.fixWrap();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.unfixWrap();\n//\t\t\tthis.container.style.left = 'auto';\n\t\t}\n\t};\n\n\tfixWrap()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.add(`${this.class.informerFixed}`, `${this.class.informerFixedAnimation}`);\n\t}\n\n\tunfixWrap()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.remove(`${this.class.informerFixed}`, `${this.class.informerFixedAnimation}`);\n\t};\n\n\trecover()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterContainerNode = this.container.querySelector(`span.${this.class.counterContainer}`);\n\n\t\tif (!counterContainerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcounterContainerNode.classList.remove('--hidden');\n\t\tthis.hideReloadNode();\n\n\t\tif (this.plus)\n\t\t{\n\t\t\tthis.plus.classList.add(`${this.class.plusHidden}`);\n\t\t}\n\t};\n\n\thideReloadNode()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst reloadNode = this.container.querySelector(`span.${this.class.reloadContainer}`);\n\n\t\tif (!reloadNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treloadNode.classList.add('--hidden');\n\t};\n\n\tdecrementCounter(value)\n\t{\n\t\tthis.counterDecrementStack += parseInt(value);\n\n\t\tif (!this.value)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterValue = this.counterValue - this.counterDecrementStack;\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tthis.value.innerHTML = counterValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.changeAnimate({\n\t\t\t\tshow: false,\n\t\t\t\tcounter: 0,\n\t\t\t});\n\t\t}\n\t}\n\n\tgetWrap()\n\t{\n\t\treturn this.wrap;\n\t}\n}\n\nexport {\n\tInformer\n};","export class Loader\n{\n\tstatic cssClass = {\n\t\tfeedMask: 'log-internal-mask',\n\t\tfeedNoMask: 'log-internal-nomask',\n\t\tshowLoader: 'livefeed-show-loader',\n\t\thideLoader: 'livefeed-hide-loader',\n\t};\n\n\tstatic onAnimationEnd = (event) => {\n\t\tif (\n\t\t\t'animationName' in event\n\t\t\t&& event.animationName\n\t\t\t&& event.animationName === 'hideLoader'\n\t\t)\n\t\t{\n\t\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\t\tif (!loaderContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tloaderContainer.classList.remove(this.cssClass.showLoader);\n\t\t\tloaderContainer.classList.remove(this.cssClass.hideLoader);\n\t\t\tloaderContainer.style.display = '';\n\t\t}\n\t}\n\n\tstatic showRefreshFade()\n\t{\n\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\tif (feedContainer)\n\t\t{\n\t\t\tfeedContainer.classList.add(this.cssClass.feedMask);\n\t\t\tfeedContainer.classList.remove(this.cssClass.feedNoMask);\n\t\t}\n\n\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\tif (loaderContainer)\n\t\t{\n\t\t\tloaderContainer.style.display = 'block';\n\t\t\tloaderContainer.classList.remove(this.cssClass.hideLoader);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tloaderContainer.classList.add(this.cssClass.showLoader);\n\t\t\t}, 0);\n\t\t}\n\t}\n\n\tstatic hideRefreshFade()\n\t{\n\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\tif (feedContainer)\n\t\t{\n\t\t\tfeedContainer.classList.remove(this.cssClass.feedMask);\n\t\t\tfeedContainer.classList.add(this.cssClass.feedNoMask);\n\t\t}\n\n\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\tif (loaderContainer)\n\t\t{\n\t\t\tloaderContainer.classList.remove(this.cssClass.showLoader);\n\t\t\tloaderContainer.classList.add(this.cssClass.hideLoader);\n\t\t}\n\t}\n}\n","import {Type, Event} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {FeedInstance} from './feed';\n\nexport class MoreButton\n{\n\tstatic cssClass = {\n\t\tpost: 'feed-post-block',\n\t\tpostShort: 'feed-post-block-short',\n\t\tpostSeparator: 'feed-post-block-separator',\n\t\tpostText: 'feed-post-text-block',\n\t\tpostTextInner: 'feed-post-text-block-inner',\n\t\tpostTextInnerInner: 'feed-post-text-block-inner-inner',\n\t\tmore: 'feed-post-text-more',\n\t\tcomment: 'feed-com-text',\n\t};\n\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Livefeed:recalculateComments',\n\t\t\tthis.onRecalculateLivefeedComments.bind(this)\n\t\t);\n\t}\n\n\tonRecalculateLivefeedComments(baseEvent: BaseEvent)\n\t{\n\t\tconst [ data ] = baseEvent.getCompatData();\n\t\tif (!Type.isDomNode(data.rootNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst informerBlock = data.rootNode;\n\n\t\tconst moreBlock = informerBlock.querySelector(`.${MoreButton.cssClass.more}`);\n\t\tif (moreBlock)\n\t\t{\n\t\t\tinformerBlock.classList.remove(MoreButton.cssClass.postSeparator);\n\t\t}\n\n\t\tMoreButton.recalcPost({\n\t\t\tarPos: { height: (data.rootNode.offsetHeight + data.rootNode.offsetTop) },\n\t\t\tinformerBlock\n\t\t});\n\t}\n\n\tstatic recalcPost(params)\n\t{\n\t\tif (!Type.isDomNode(params.informerBlock))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst blockHeight = (!Type.isUndefined(params.arPos) ? params.arPos.height : params.bodyBlock.offsetHeight);\n\n\t\tconst postBlock = params.informerBlock.closest(`.${this.cssClass.post}`);\n\t\tif (!postBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (blockHeight <= 284)\n\t\t{\n\t\t\tpostBlock.classList.add(this.cssClass.postShort)\n\t\t\tpostBlock.classList.add(this.cssClass.postSeparator)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpostBlock.classList.remove(this.cssClass.postShort)\n\t\t}\n\t}\n\n\tstatic recalcPostsList()\n\t{\n\t\tconst buttonsList = FeedInstance.getMoreButtons();\n\t\tbuttonsList.forEach((buttonData, key) => {\n\n\t\t\tif (\n\t\t\t\t!Type.isPlainObject(buttonData)\n\t\t\t\t|| !Type.isStringFilled(buttonData.bodyBlockID)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst bodyNode = document.getElementById(buttonData.bodyBlockID)\n\t\t\tif (!bodyNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(buttonData.outerBlockID))\n\t\t\t{\n\t\t\t\tconst outerNode = document.getElementById(buttonData.outerBlockID);\n\t\t\t\tif (outerNode)\n\t\t\t\t{\n\t\t\t\t\tif (outerNode.offsetWidth < bodyNode.offsetWidth)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst innerNode = outerNode.querySelector(`div.${this.cssClass.postTextInner}`);\n\t\t\t\t\t\tinnerNode.style.overflowX = 'scroll';\n\t\t\t\t\t}\n\n\t\t\t\t\tconst moreButton = outerNode.querySelector(`.${this.cssClass.more}`);\n\t\t\t\t\tif (moreButton)\n\t\t\t\t\t{\n\t\t\t\t\t\tEvent.unbindAll(moreButton, 'click');\n\t\t\t\t\t\tEvent.bind(moreButton, 'click', (e) => {\n\n\t\t\t\t\t\t\tBX.UI.Animations.expand({\n\t\t\t\t\t\t\t\tmoreButtonNode: e.currentTarget,\n\t\t\t\t\t\t\t\ttype: 'post',\n\t\t\t\t\t\t\t\tclassBlock: this.cssClass.postText,\n\t\t\t\t\t\t\t\tclassOuter: this.cssClass.postTextInner,\n\t\t\t\t\t\t\t\tclassInner: this.cssClass.postTextInnerInner,\n\t\t\t\t\t\t\t\theightLimit: 300,\n\t\t\t\t\t\t\t\tcallback: (textBlock) => {\n\t\t\t\t\t\t\t\t\tthis.expand(textBlock);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.recalcPost({\n\t\t\t\tarPos: { height: (bodyNode.offsetHeight + bodyNode.offsetTop)},\n\t\t\t\tinformerBlock: (Type.isStringFilled(buttonData.informerBlockID) ? document.getElementById(buttonData.informerBlockID) : null)\n\t\t\t});\n\t\t\tbuttonsList.delete(key);\n\t\t});\n\n\t\tFeedInstance.setMoreButtons(buttonsList);\n\n\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\tif (!feedContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst onLoadImageList = feedContainer.querySelectorAll('[data-bx-onload=\"Y\"]');\n\t\tonLoadImageList.forEach((imageNode) => {\n\t\t\timageNode.addEventListener('load', (e) => {\n\n\t\t\t\tlet outerBlock = e.currentTarget.closest(`.${this.cssClass.comment}`);\n\t\t\t\tif (!outerBlock) // post\n\t\t\t\t{\n\t\t\t\t\touterBlock = e.currentTarget.closest(`.${this.cssClass.post}`);\n\t\t\t\t\tif (outerBlock)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst bodyBlock = outerBlock.querySelector(`.${this.cssClass.postTextInnerInner}`);\n\t\t\t\t\t\tif (bodyBlock)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.recalcPost({\n\t\t\t\t\t\t\t\tbodyBlock: bodyBlock,\n\t\t\t\t\t\t\t\tinformerBlock: outerBlock.querySelector(`.${this.cssClass.more}`),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\te.currentTarget.setAttribute('data-bx-onload', 'N');\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic recalcCommentsList()\n\t{\n\t\tEventEmitter.emit('OnUCMoreButtonListRecalc', new BaseEvent({\n\t\t\tcompatData: [],\n\t\t}));\n\t}\n\n\tstatic clearCommentsList()\n\t{\n\t\tEventEmitter.emit('OnUCMoreButtonListClear', new BaseEvent({\n\t\t\tcompatData: [],\n\t\t}));\n\t}\n\n\tstatic expand(textBlock)\n\t{\n\t\tif (!Type.isDomNode(textBlock))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst postBlock = textBlock.closest(`.${this.cssClass.post}`);\n\t\tif (!postBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpostBlock.classList.add(this.cssClass.postShort);\n\t\tpostBlock.classList.add(this.cssClass.postSeparator);\n\t}\n\n\t/*\n\tis not used actually by disk uf\n\t*/\n\tstatic lazyLoadCheckVisibility(image)\n\t{\n\t\tif (\n\t\t\t!Type.isPlainObject(image)\n\t\t\t|| !Type.isDomNode(image.node)\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst imageNode = image.node;\n\n\t\tlet textType = 'comment';\n\n\t\tlet textBlock = imageNode.closest(`.${this.cssClass.comment}`);\n\t\tif (!textBlock)\n\t\t{\n\t\t\ttextType = 'post';\n\t\t\ttextBlock = imageNode.closest(`.${this.cssClass.postText}`);\n\t\t}\n\n\t\tif (!textBlock)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst moreBlock = textBlock.querySelector(`div.${this.cssClass.more}`);\n\t\tif (\n\t\t\t!moreBlock\n\t\t\t|| moreBlock.style.display === 'none'\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn imageNode.parentNode.parentNode.offsetTop < (textType === 'comment' ? 220 : 270);\n\t}\n}\n","import {Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {MoreButton} from './morebutton';\n\nexport class Forum\n{\n\tstatic cssClass = {\n\t};\n\n\tstatic processSpoilerToggle(event: BaseEvent)\n\t{\n\t\tlet [ params ] = event.getCompatData();\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (!Type.isDomNode(params.node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst outerBlock = params.node.closest('.feed-post-block');\n\t\tif (!outerBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst bodyBlock = outerBlock.querySelector('.feed-post-text-block-inner-inner');\n\t\tif (!bodyBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst moreBlock = outerBlock.querySelector('.feed-post-text-more');\n\n\t\tMoreButton.recalcPost({\n\t\t\tbodyBlock: bodyBlock,\n\t\t\tinformerBlock: moreBlock,\n\t\t});\n\t}\n}\n","import {Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Loader} from './loader';\nimport {PageInstance} from './feed';\n\nclass Filter\n{\n\tconstructor()\n\t{\n\t\tthis.filterId = '';\n\t\tthis.filterApi = null;\n\t}\n\n\tinit(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (\n\t\t\tType.isStringFilled(params.filterId)\n\t\t\t&& !Type.isUndefined(BX.Main)\n\t\t\t&& !Type.isUndefined(BX.Main.filterManager)\n\t\t)\n\t\t{\n\t\t\tconst filterManager = BX.Main.filterManager.getById(params.filterId);\n\t\t\tthis.filterId = params.filterId;\n\n\t\t\tif(filterManager)\n\t\t\t{\n\t\t\t\tthis.filterApi = filterManager.getApi();\n\t\t\t}\n\t\t}\n\n\t\tthis.initEvents();\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:beforeApply', (event: BaseEvent) =>\n\t\t{\n\t\t\tLoader.showRefreshFade();\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:apply', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ filterValues, filterPromise, filterParams ] = event.getCompatData();\n\n\t\t\tif (typeof filterParams != 'undefined')\n\t\t\t{\n\t\t\t\tfilterParams.autoResolve = false;\n\t\t\t}\n\t\t\tPageInstance.refresh({\n\t\t\t\tuseBXMainFilter: 'Y',\n\t\t\t}, filterPromise);\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:searchInput', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ searchString ] = event.getCompatData();\n\n\t\t\tif (Type.isStringFilled(searchString))\n\t\t\t{\n\t\t\t\tLoader.showRefreshFade();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLoader.hideRefreshFade();\n\t\t\t}\n\t\t});\n\t}\n\n\tinitEventsCrm()\n\t{\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:searchInput', () => {\n\t\t\tPageInstance.refresh();\n\t\t});\n\t}\n\n\tclickTag(tagValue)\n\t{\n\t\tif (\n\t\t\t!Type.isStringFilled(tagValue)\n\t\t\t|| !this.filterApi\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.filterApi.setFields({\n\t\t\tTAG: tagValue\n\t\t});\n\t\tthis.filterApi.apply();\n\n\t\tif (\n\t\t\tType.isStringFilled(this.filterId)\n\t\t\t&& !Type.isUndefined(BX.Main)\n\t\t\t&& !Type.isUndefined(BX.Main.filterManager)\n\t\t)\n\t\t{\n\t\t\tconst filterContainer = document.getElementById(`${this.filterId}_filter_container`);\n\t\t\tif (\n\t\t\t\tfilterContainer\n\t\t\t\t&& BX.Main.filterManager.getById(this.filterId)\n\t\t\t\t&& (\n\t\t\t\t\tBX.Main.filterManager.getById(this.filterId).getSearch().getSquares().length > 0\n\t\t\t\t\t|| BX.Main.filterManager.getById(this.filterId).getSearch().getSearchString().length > 0\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst pagetitleContainer = filterContainer.closest('.pagetitle-wrap');\n\t\t\t\tif (pagetitleContainer)\n\t\t\t\t{\n\t\t\t\t\tpagetitleContainer.classList.add('pagetitle-wrap-filter-opened');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t(new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: { scroll: window.pageYOffset },\n\t\t\tfinish: { scroll: 0 },\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: (state) => {\n\t\t\t\twindow.scrollTo(0, state.scroll);\n\t\t\t},\n\t\t\tcomplete: () => {}\n\t\t})).animate();\n\n\t\treturn true;\n\t}\n}\n\nexport {\n\tFilter,\n};","import { ajax, Type, Loc, Dom, Tag } from 'main.core';\nimport { Popup } from 'main.popup';\n\nexport class ContentView\n{\n\tstatic registerAreaList()\n\t{\n\t\tvar\n\t\t\tcontainer = BX('log_internal_container'),\n\t\t\tfullContentArea = null;\n\n\t\tif (container)\n\t\t{\n\t\t\tvar viewAreaList = BX.findChildren(container, {\n\t\t\t\ttag: 'div',\n\t\t\t\tclassName: 'feed-post-contentview'\n\t\t\t}, true);\n\t\t\tfor (var i = 0, length = viewAreaList.length; i < length; i++)\n\t\t\t{\n\t\t\t\tif (viewAreaList[i].id.length > 0)\n\t\t\t\t{\n\t\t\t\t\tfullContentArea = BX.findChild(viewAreaList[i], {\n\t\t\t\t\t\ttag: 'div',\n\t\t\t\t\t\tclassName: 'feed-post-text-block-inner-inner'\n\t\t\t\t\t});\n\t\t\t\t\tBX.UserContentView.registerViewArea(viewAreaList[i].id, (fullContentArea ? fullContentArea : null));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","import { Loc, Type, ajax, Dom, Runtime, Uri, Event, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport {FeedInstance, PinnedPanelInstance, InformerInstance} from './feed';\nimport {Loader} from './loader';\nimport {MoreButton} from './morebutton';\nimport {ContentView} from './contentview';\n\nclass Page\n{\n\tconstructor()\n\t{\n\t\tthis.loadStarted = null;\n\t\tthis.stopTrackNextPage = null;\n\t\tthis.requestMode = null;\n\t\tthis.nextPageFirst = null;\n\t\tthis.nextPageUrl = null;\n\t\tthis.scrollInitialized = null;\n\t\tthis.firstPageLastTS = 0;\n\t\tthis.firstPageLastId = 0;\n\t\tthis.useBXMainFilter = 'N';\n\t\tthis.commentFormUID = '';\n\t\tthis.blogCommentFormUID = '';\n\n\t\tthis.signedParameters = '';\n\t\tthis.componentName = '';\n\n\t\tthis.class = {\n\t\t};\n\n\t\tEvent.ready(() => {\n\t\t\tthis.init();\n\t\t});\n\t}\n\n\tinit()\n\t{\n\t\tthis.loadStarted = false;\n\t\tthis.stopTrackNextPage = false;\n\t\tthis.requestMode = false;\n\t\tthis.nextPageFirst = true;\n\t\tthis.nextPageUrl = false;\n\t\tthis.scrollInitialized = false;\n\t}\n\n\trefresh(params, filterPromise)\n\t{\n\t\tif (this.loadStarted)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setRequestModeNew();\n\n\t\tparams = (\n\t\t\tType.isPlainObject(params)\n\t\t\t\t? params\n\t\t\t\t: {}\n\t\t);\n\n\t\tparams.siteTemplateId = Loc.getMessage('SONET_EXT_LIVEFEED_SITE_TEMPLATE_ID');\n\t\tparams.assetsCheckSum = Loc.getMessage('sonetLAssetsCheckSum');\n\n\t\tthis.loadStarted = true;\n\n\t\tLoader.showRefreshFade();\n\n\t\tMoreButton.clearCommentsList();\n\t\tFeedInstance.clearMoreButtons();\n\n\t\tif (Type.isStringFilled(this.commentFormUID))\n\t\t{\n\t\t\tparams.commentFormUID = this.commentFormUID;\n\t\t}\n\n\t\tif (\n\t\t\t!Type.isStringFilled(params.useBXMainFilter)\n\t\t\t|| params.useBXMainFilter !== 'Y'\n\t\t)\n\t\t{\n\t\t\tEventEmitter.emit('BX.Livefeed:refresh', new BaseEvent({\n\t\t\t\tcompatData: [],\n\t\t\t}));\n\t\t}\n\n\t\tInformerInstance.hideReloadNode();\n\t\tInformerInstance.lockCounterAnimation = true;\n\n\t\tthis.loadStarted = false;\n\n\t\tajax.runAction('socialnetwork.api.livefeed.refresh', {\n\t\t\tsignedParameters: this.getSignedParameters(),\n\t\t\tdata: {\n\t\t\t\tc: this.getComponentName(),\n\t\t\t\tlogajax: 'Y', // compatibility\n\t\t\t\tRELOAD: 'Y', // compatibility\n\t\t\t\tparams: params,\n\t\t\t}\n\t\t}).then((response) => {\n\n\t\t\tconst responseData = (Type.isPlainObject(response.data) ? response.data : {});\n\n\t\t\tthis.loadStarted = false;\n\t\t\tLoader.hideRefreshFade();\n\n\t\t\tif (filterPromise)\n\t\t\t{\n\t\t\t\tfilterPromise.fulfill();\n\t\t\t}\n\n\t\t\tconst emptyLivefeed = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& Type.isStringFilled(responseData.componentResult.EMPTY)\n\t\t\t\t\t? responseData.componentResult.EMPTY\n\t\t\t\t\t: 'N'\n\t\t\t);\n\t\t\tconst forcePageRefresh = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& Type.isStringFilled(responseData.componentResult.FORCE_PAGE_REFRESH)\n\t\t\t\t\t? responseData.componentResult.FORCE_PAGE_REFRESH\n\t\t\t\t\t: 'N'\n\t\t\t);\n\n\t\t\tconst isFilterUsed = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& Type.isStringFilled(responseData.componentResult.FILTER_USED)\n\t\t\t\t&& responseData.componentResult.FILTER_USED === 'Y'\n\t\t\t);\n\n\t\t\tif (forcePageRefresh === 'Y')\n\t\t\t{\n\t\t\t\ttop.window.location.reload();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\n\t\t\tInformerInstance.lockCounterAnimation = false;\n\n\t\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\t\tif (!feedContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.clean(feedContainer);\n\n\t\t\tconst emptyBlock = document.getElementById('feed-empty-wrap');\n\n\t\t\tif (emptyBlock)\n\t\t\t{\n\t\t\t\tif (emptyLivefeed === 'Y')\n\t\t\t\t{\n\t\t\t\t\temptyBlock.style.display = 'block';\n\n\t\t\t\t\tconst emptyTextNode = emptyBlock.querySelector('.feed-wrap-empty');\n\t\t\t\t\tif (emptyTextNode)\n\t\t\t\t\t{\n\t\t\t\t\t\temptyTextNode.innerHTML = (\n\t\t\t\t\t\t\tisFilterUsed\n\t\t\t\t\t\t\t\t? Loc.getMessage('SONET_C30_T_EMPTY_SEARCH')\n\t\t\t\t\t\t\t\t: Loc.getMessage('SONET_C30_T_EMPTY')\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\temptyBlock.style.display = 'none';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (loaderContainer)\n\t\t\t{\n\t\t\t\tfeedContainer.appendChild(loaderContainer);\n\t\t\t}\n\n\t\t\tif (responseData.html.length > 0)\n\t\t\t{\n\t\t\t\tthis.clearContainerExternal();\n\t\t\t\tBX.LazyLoad.clearImages();\n\n\t\t\t\tconst pageNode = Tag.render`<div id=\"content_block_${(Math.floor(Math.random() * 1000))}\" class=\"feed-wrap\" style=\"display: block;\"></div>`;\n\n\t\t\t\tfeedContainer.appendChild(pageNode);\n\n\t\t\t\tRuntime.html(pageNode, responseData.html).then(() => {\n\t\t\t\t\tMoreButton.recalcPostsList()\n\t\t\t\t\tMoreButton.recalcCommentsList();\n\n\t\t\t\t\tContentView.registerAreaList();\n\n\t\t\t\t\tPinnedPanelInstance.resetFlags();\n\t\t\t\t\tPinnedPanelInstance.initPanel();\n\t\t\t\t\tPinnedPanelInstance.initPosts();\n\t\t\t\t});\n\n\t\t\t\tthis.stopTrackNextPage = false;\n\n\t\t\t\tMoreButton.clearCommentsList();\n\n\t\t\t\tconst informerWrap = InformerInstance.getWrap();\n\n\t\t\t\tif (\n\t\t\t\t\tinformerWrap\n\t\t\t\t\t&& informerWrap.classList.contains(InformerInstance.class.informerFixed)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\t(new BX.easing({\n\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\tstart: { scroll: window.pageYOffset },\n\t\t\t\t\t\tfinish: { scroll: 0 },\n\t\t\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\t\twindow.scrollTo(0, state.scroll);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\tEventEmitter.emit('onGoUp', []);\n\t\t\t\t\t\t}\n\t\t\t\t\t})).animate();\n\t\t\t\t}\n\t\t\t}\n\t\t}, () => {\n\n\t\t\tthis.loadStarted = false;\n\t\t\tif (filterPromise)\n\t\t\t{\n\t\t\t\tfilterPromise.reject();\n\t\t\t}\n\n\t\t\tLoader.hideRefreshFade();\n\t\t\tthis.showRefreshError();\n\t\t});\n\n\t\treturn false;\n\t}\n\n\tgetNextPage()\n\t{\n\t\tconst stubContainer = document.getElementById('feed-new-message-inf-wrap');\n\t\tconst stubFirstContainer = document.getElementById('feed-new-message-inf-wrap-first');\n\n\t\tif (this.loadStarted)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.setRequestModeMore();\n\n\t\tthis.loadStarted = true;\n\n\t\tInformerInstance.lockCounterAnimation = true;\n\t\tFeedInstance.clearMoreButtons();\n\n\t\tif (\n\t\t\t!this.nextPageFirst\n\t\t\t&& stubContainer\n\t\t)\n\t\t{\n\t\t\tstubContainer.style.display = 'block';\n\t\t}\n\t\telse if (\n\t\t\tthis.nextPageFirst\n\t\t\t&& stubFirstContainer\n\t\t)\n\t\t{\n\t\t\tstubFirstContainer.classList.add('feed-new-message-inf-wrap-first-visible');\n\t\t}\n\n\t\tconst nextUrlParamsList = (new Uri(this.getNextPageUrl())).getQueryParams();\n\t\tlet pageNumber = 1;\n\t\tlet prevPageLogId = '';\n\t\tlet ts = 0;\n\t\tlet noblog = 'N';\n\n\t\tObject.entries(nextUrlParamsList).forEach(([ key, value ]) => {\n\t\t\tif (key.match(/^PAGEN_(\\d+)$/i))\n\t\t\t{\n\t\t\t\tpageNumber = parseInt(value);\n\t\t\t}\n\t\t\telse if (key === 'pplogid')\n\t\t\t{\n\t\t\t\tprevPageLogId = decodeURI(value);\n\t\t\t}\n\t\t\telse if (key === 'ts')\n\t\t\t{\n\t\t\t\tts = value;\n\t\t\t}\n\t\t\telse if (key === 'noblog')\n\t\t\t{\n\t\t\t\tnoblog = value;\n\t\t\t}\n\t\t});\n\n\t\tconst queryParams = {\n\t\t\tPAGE_NUMBER: pageNumber,\n\t\t\tLAST_LOG_TIMESTAMP: ts,\n\t\t\tPREV_PAGE_LOG_ID: prevPageLogId,\n\t\t\tsiteTemplateId: Loc.getMessage('SONET_EXT_LIVEFEED_SITE_TEMPLATE_ID'),\n\t\t\tuseBXMainFilter: this.useBXMainFilter,\n\t\t\tpreset_filter_top_id: (Type.isStringFilled(nextUrlParamsList.preset_filter_top_id) && nextUrlParamsList.preset_filter_top_id !== '0' ? nextUrlParamsList.preset_filter_top_id : ''),\n\t\t\tpreset_filter_id: (Type.isStringFilled(nextUrlParamsList.preset_filter_id) && nextUrlParamsList.preset_filter_id !== '0' ? nextUrlParamsList.preset_filter_id : '')\n\t\t};\n\n\t\tif (Type.isStringFilled(this.commentFormUID))\n\t\t{\n\t\t\tqueryParams.commentFormUID = this.commentFormUID;\n\t\t}\n\n\t\tif (Type.isStringFilled(this.blogCommentFormUID))\n\t\t{\n\t\t\tqueryParams.blogCommentFormUID = this.blogCommentFormUID;\n\t\t}\n\n\t\tconst queryData = {\n\t\t\tc: this.getComponentName(),\n\t\t\tlogajax: 'Y', // compatibility with socialnetwork.blog.post.comment\n\t\t\tnoblog: noblog, // compatibility with socialnetwork.blog.post.comment\n\t\t\tparams: queryParams,\n\t\t};\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.CREATED_BY_ID))\n\t\t{\n\t\t\tqueryData.flt_created_by_id = parseInt(nextUrlParamsList.CREATED_BY_ID);\n\t\t}\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.flt_date_datesel))\n\t\t{\n\t\t\tqueryData.flt_date_datesel = nextUrlParamsList.flt_date_datesel;\n\t\t}\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.flt_date_from))\n\t\t{\n\t\t\tqueryData.flt_date_from = decodeURIComponent(nextUrlParamsList.flt_date_from);\n\t\t}\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.flt_date_to))\n\t\t{\n\t\t\tqueryData.flt_date_to = decodeURIComponent(nextUrlParamsList.flt_date_to);\n\t\t}\n\n\t\tajax.runAction('socialnetwork.api.livefeed.getNextPage', {\n\t\t\tsignedParameters: this.getSignedParameters(),\n\t\t\tdata: queryData,\n\t\t}).then((response) => {\n\t\t\tconst responseData = (Type.isPlainObject(response.data) ? response.data : {});\n\n\t\t\tthis.loadStarted = false;\n\n\t\t\tconst stubContainer = document.getElementById('feed-new-message-inf-wrap');\n\t\t\tif (stubContainer)\n\t\t\t{\n\t\t\t\tDom.clean(stubContainer);\n\t\t\t\tDom.remove(stubContainer)\n\t\t\t}\n\n\t\t\tInformerInstance.lockCounterAnimation = false;\n\n\t\t\tconst lastEntryTimestamp = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& !Type.isUndefined(responseData.componentResult.LAST_TS)\n\t\t\t\t\t? parseInt(responseData.componentResult.LAST_TS)\n\t\t\t\t\t: 0\n\t\t\t);\n\t\t\tconst lastEntryId = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& !Type.isUndefined(responseData.componentResult.LAST_ID)\n\t\t\t\t\t? parseInt(responseData.componentResult.LAST_ID)\n\t\t\t\t\t: null\n\t\t\t);\n\n\t\t\tif (\n\t\t\t\tresponseData.html.length > 0\n\t\t\t\t&& lastEntryTimestamp > 0\n\t\t\t\t&& (\n\t\t\t\t\tparseInt(this.firstPageLastTS) <= 0\n\t\t\t\t\t|| lastEntryTimestamp < parseInt(this.firstPageLastTS)\n\t\t\t\t\t|| (\n\t\t\t\t\t\tlastEntryTimestamp == parseInt(this.firstPageLastTS)\n\t\t\t\t\t\t&& !Type.isNull(lastEntryId)\n\t\t\t\t\t\t&& lastEntryId < parseInt(this.firstPageLastId)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tMoreButton.clearCommentsList();\n\n\t\t\t\tconst contentBlockId = `content_block_${(Math.floor(Math.random() * 1000))}`;\n\n\t\t\t\tconst pageNode = Tag.render`<div id=\"${contentBlockId}\" class=\"feed-wrap\" style=\"display:${(this.nextPageFirst ? 'none' : 'block')};\"></div>`;\n\n\t\t\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\t\t\tif (!feedContainer)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfeedContainer.appendChild(pageNode);\n\n\t\t\t\tRuntime.html(pageNode, responseData.html).then(() => {\n\t\t\t\t\tif (pageNumber > 2)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.stopTrackNextPage = false;\n\t\t\t\t\t\tMoreButton.recalcPostsList();\n\t\t\t\t\t\tContentView.registerAreaList();\n\t\t\t\t\t\tMoreButton.recalcCommentsList();\n\t\t\t\t\t\tPinnedPanelInstance.resetFlags();\n\t\t\t\t\t\tPinnedPanelInstance.initPosts();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.clearContainerExternal();\n\n\t\t\t\tif (pageNumber === 2)\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById('feed-new-message-inf-text-first').style.display = 'block';\n\t\t\t\t\tdocument.getElementById('feed-new-message-inf-loader-first').style.display = 'none';\n\t\t\t\t\tstubFirstContainer.classList.add('feed-new-message-inf-wrap-first-active');\n\n\t\t\t\t\tconst f = () => {\n\n\t\t\t\t\t\tthis.stopTrackNextPage = false;\n\t\t\t\t\t\tif (pageNode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpageNode.style.display = 'block';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tEvent.unbind(document.getElementById('sonet_log_more_container_first'), 'click', f);\n\t\t\t\t\t\tstubFirstContainer.style.display = 'none';\n\t\t\t\t\t\tMoreButton.recalcPostsList()\n\t\t\t\t\t\tContentView.registerAreaList();\n\t\t\t\t\t\tMoreButton.recalcCommentsList();\n\n\t\t\t\t\t\tEventEmitter.emit('BX.Livefeed:recalculateComments', new BaseEvent({\n\t\t\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\t\t\trootNode: pageNode,\n\t\t\t\t\t\t\t}],\n\t\t\t\t\t\t}));\n\n\n\t\t\t\t\t\tPinnedPanelInstance.resetFlags();\n\t\t\t\t\t\tPinnedPanelInstance.initPosts();\n\t\t\t\t\t};\n\t\t\t\t\tEvent.bind(document.getElementById('sonet_log_more_container_first'), 'click', f);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (pageNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpageNode.style.display = 'block';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.nextPageFirst = false;\n\t\t\t}\n\n\t\t\telse if (document.getElementById('feed-new-message-inf-wrap-first'))\n\t\t\t{\n\t\t\t\tdocument.getElementById('feed-new-message-inf-wrap-first').style.display = 'none';\n\t\t\t}\n\t\t}, () => {\n\n\t\t\tthis.loadStarted = false;\n\t\t\tthis.stopTrackNextPage = false;\n\n\t\t\tconst stubContainer = document.getElementById('feed-new-message-inf-wrap');\n\t\t\tif (stubContainer)\n\t\t\t{\n\t\t\t\tstubContainer.style.display = 'none';\n\t\t\t}\n\n\t\t\tInformerInstance.lockCounterAnimation = false;\n\t\t\tthis.clearContainerExternal();\n\t\t});\n\n\t\treturn false;\n\t}\n\n\tclearContainerExternal()\n\t{\n\t\tif (this.requestMode === 'new')\n\t\t{\n\t\t\tInformerInstance.hideWrapAnimation();\n\t\t\tInformerInstance.recover();\n\t\t}\n\n\t\tInformerInstance.hideReloadAnimation();\n\n\t\tconst counterPreset = document.getElementById('sonet_log_counter_preset');\n\t\tif (\n\t\t\tcounterPreset\n\t\t\t&& this.requestMode === 'new'\n\t\t)\n\t\t{\n\t\t\tcounterPreset.style.display = 'none';\n\t\t}\n\t}\n\n\tsetRequestModeNew()\n\t{\n\t\tthis.requestMode = 'new';\n\t}\n\n\tsetRequestModeMore()\n\t{\n\t\tthis.requestMode = 'more';\n\t}\n\n\tshowRefreshError()\n\t{\n\t\tInformerInstance.lockCounterAnimation = false;\n\t\tthis.clearContainerExternal();\n\t}\n\tsetSignedParameters(value)\n\t{\n\t\tthis.signedParameters = value;\n\t}\n\tgetSignedParameters()\n\t{\n\t\treturn this.signedParameters;\n\t}\n\n\tsetComponentName(value)\n\t{\n\t\tthis.componentName = value;\n\t}\n\tgetComponentName()\n\t{\n\t\treturn this.componentName;\n\t}\n\n\tsetNextPageUrl(value)\n\t{\n\t\tthis.nextPageUrl = value;\n\t}\n\tgetNextPageUrl()\n\t{\n\t\treturn this.nextPageUrl;\n\t}\n\n\tinitScroll()\n\t{\n\t\tif (this.scrollInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.scrollInitialized = true;\n\t\tdocument.addEventListener('scroll', this.onFeedScroll.bind(this));\n\t}\n\n\tonFeedScroll()\n\t{\n\t\tif (!this.stopTrackNextPage)\n\t\t{\n\t\t\tconst maxScroll = (document.documentElement.scrollHeight - window.innerHeight) - 500;\n\t\t\tif (\n\t\t\t\twindow.pageYOffset >= maxScroll\n\t\t\t\t&& this.getNextPageUrl()\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.stopTrackNextPage = true;\n\t\t\t\tthis.getNextPage();\n\t\t\t}\n\t\t}\n\n\t\tInformerInstance.onFeedScroll();\n\t}\n}\n\nexport {\n\tPage\n};\n","import { Type, Tag, Runtime } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { ResultManager } from 'tasks.result';\n\nexport class CommentForm\n{\n\tstatic resultFieldTaskIdList = [];\n\tstatic taskResultCommentsData = {};\n\n\tstatic appendResultFieldTaskIds(taskIdList)\n\t{\n\t\tif (!Type.isArray(taskIdList))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttaskIdList = taskIdList.map((value) => { return parseInt(value); })\n\t\tthis.resultFieldTaskIdList = [...this.resultFieldTaskIdList, ...taskIdList];\n\t}\n\n\tstatic appendTaskResultComments(data)\n\t{\n\t\tif (Type.isUndefined(ResultManager))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.taskResultCommentsData = Object.assign(this.taskResultCommentsData, data);\n\n\t\tObject.entries(this.taskResultCommentsData).forEach(([taskId, commentsIdList]) => {\n\t\t\tResultManager.getInstance().initResult({\n\t\t\t\tcontext: 'task',\n\t\t\t\ttaskId: parseInt(taskId),\n\t\t\t\tcomments: commentsIdList,\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic onAfterShow(obj, text, data)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tEventEmitter.emit('OnBeforeSocialnetworkCommentShowedUp', new BaseEvent({\n\t\t\tcompatData: ['socialnetwork'],\n\t\t}));\n\n\t\tconst postData = {\n\t\t\tENTITY_XML_ID: obj.currentEntity.ENTITY_XML_ID,\n\t\t\tENTITY_TYPE: obj.currentEntity.ENTITY_XML_ID.split('_')[0],\n\t\t\tENTITY_ID: obj.currentEntity.ENTITY_XML_ID.split('_')[1],\n\t\t\tparentId: obj.id[1],\n\t\t\tcomment_post_id: obj.currentEntity.ENTITY_XML_ID.split('_')[1],\n\t\t\tedit_id: obj.id[1],\n\t\t\tact: (obj.id[1] > 0 ? 'edit' : 'add'),\n\t\t};\n\n\t\tObject.entries(postData).forEach(([key, value]) =>\n\t\t{\n\t\t\tif (!obj.form[key])\n\t\t\t{\n\t\t\t\tobj.form.appendChild(Tag.render`<input type=\"hidden\" name=\"${key}\">`);\n\t\t\t}\n\t\t\tobj.form[key].value = value;\n\t\t});\n\n\t\tthis.onLightEditorShow(text, data);\n\n\t\tif (!BX.Type.isUndefined(BX.Tasks))\n\t\t{\n\t\t\tconst matches = obj.currentEntity.ENTITY_XML_ID.match(/^TASK_(\\d+)$/i);\n\t\t\tif (\n\t\t\t\tmatches\n\t\t\t\t&& this.resultFieldTaskIdList.includes(parseInt(matches[1]))\n\t\t\t)\n\t\t\t{\n\t\t\t\tBX.Tasks.ResultManager.showField();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Tasks.ResultManager.hideField();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic onLightEditorShow(content, data)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tlet result = {};\n\n\t\tif (Type.isPlainObject(data.UF))\n\t\t{\n\t\t\tresult = data.UF;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (data.arFiles)\n\t\t\t{\n\t\t\t\tconst value = {};\n\n\t\t\t\tdata.arFiles.forEach((fileId, index) => {\n\t\t\t\t\tconst container = document.getElementById(`wdif-doc-${fileId}`);\n\n\t\t\t\t\tconst name = container.querySelector('.feed-com-file-name');\n\t\t\t\t\tconst size = container.querySelector('.feed-con-file-size');\n\n\t\t\t\t\tvalue[`F${index}`] = {\n\t\t\t\t\t\tFILE_ID: fileId,\n\t\t\t\t\t\tFILE_NAME: (name ? name.innerHTML : 'noname'),\n\t\t\t\t\t\tFILE_SIZE: (size ? size.innerHTML : 'unknown'),\n\t\t\t\t\t\tCONTENT_TYPE: 'notimage/xyz'\n\t\t\t\t\t};\n\t\t\t\t})\n\n\t\t\t\tresult.UF_SONET_COM_DOC = {\n\t\t\t\t\tUSER_TYPE_ID: 'file',\n\t\t\t\t\tFIELD_NAME: 'UF_SONET_COM_FILE[]',\n\t\t\t\t\tVALUE: value,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (data.arDocs)\n\t\t\t{\n\t\t\t\tresult.UF_SONET_COM_FILE = {\n\t\t\t\t\tUSER_TYPE_ID: 'webdav_element',\n\t\t\t\t\tFIELD_NAME: 'UF_SONET_COM_DOC[]',\n\t\t\t\t\tVALUE: Runtime.clone(data.arDocs),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (data.arDFiles)\n\t\t\t{\n\t\t\t\tresult.UF_SONET_COM_FILE = {\n\t\t\t\t\tUSER_TYPE_ID: 'disk_file',\n\t\t\t\t\tFIELD_NAME: 'UF_SONET_COM_DOC[]',\n\t\t\t\t\tVALUE: Runtime.clone(data.arDFiles)\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tLHEPostForm.reinitData(window.SLEC.editorId, content, result);\n\t}\n}\n","import {Type, Loc, ajax, Event, Dom, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {MenuManager} from 'main.popup';\n\nimport {PinnedPanel} from './pinned';\nimport {Post} from './post';\nimport {Informer} from './informer';\nimport {TaskCreator} from './taskcreator';\nimport {Loader} from './loader';\nimport {Forum} from './forum';\nimport {MoreButton} from './morebutton';\nimport {Filter} from './filter';\nimport {Page} from './page';\nimport {ContentView} from './contentview';\nimport {CommentForm} from './commentform';\n\nimport './css/feed.css';\nimport './css/gratitude.css';\nimport './css/important.css';\nimport './css/warning.css';\nimport './css/taskcreator.css';\nimport './css/task.css';\nimport './css/timeman.css';\nimport './css/calendar.css';\n\nclass Feed\n{\n\tconstructor()\n\t{\n\t\tthis.entryData = {};\n\t\tthis.feedInitialized = false;\n\t\tthis.moreButtonDataList = new Map();\n\t}\n\n\tinitOnce(params)\n\t{\n\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (Type.isStringFilled(params.signedParameters))\n\t\t{\n\t\t\tPageInstance.setSignedParameters(params.signedParameters);\n\t\t}\n\n\t\tif (Type.isStringFilled(params.componentName))\n\t\t{\n\t\t\tPageInstance.setComponentName(params.componentName);\n\t\t}\n\n\t\tif (Type.isStringFilled(params.commentFormUID))\n\t\t{\n\t\t\tPageInstance.commentFormUID = params.commentFormUID;\n\t\t}\n\n\t\tif (loaderContainer)\n\t\t{\n\t\t\tEvent.bind(loaderContainer, 'animationend', Loader.onAnimationEnd)\n\t\t\tEvent.bind(loaderContainer, 'webkitAnimationEnd', Loader.onAnimationEnd)\n\t\t\tEvent.bind(loaderContainer, 'oanimationend', Loader.onAnimationEnd)\n\t\t\tEvent.bind(loaderContainer, 'MSAnimationEnd', Loader.onAnimationEnd)\n\t\t}\n\n\t\tEventEmitter.subscribe('BX.Forum.Spoiler:toggle', Forum.processSpoilerToggle);\n\n\t\tFilterInstance.init({\n\t\t\tfilterId: params.filterId,\n\t\t});\n\n\t\tif (\n\t\t\tType.isStringFilled(params.crmEntityTypeName)\n\t\t\t&& !Type.isUndefined(params.crmEntityId)\n\t\t\t&& parseInt(params.crmEntityId) > 0\n\t\t)\n\t\t{\n\t\t\tFilterInstance.initEventsCrm();\n\t\t}\n\n\t\tBX.UserContentView.init();\n\n\t\tdocument.getElementById('log_internal_container').addEventListener('click', (e) => {\n\t\t\tconst tagValue = e.target.getAttribute('bx-tag-value');\n\t\t\tif (!Type.isStringFilled(tagValue))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (FilterInstance.clickTag(tagValue))\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t}, true);\n\n\t\tconst noTasksNotificationCloseIcon = document.getElementById('feed-notification-notasks-close-btn');\n\t\tconst noTasksNotificationReadButton = document.getElementById('feed-notification-notasks-read-btn');\n\n\t\tif (noTasksNotificationCloseIcon)\n\t\t{\n\t\t\tEvent.bind(noTasksNotificationCloseIcon, 'click', this.setNoTasksNotificationRead.bind(this));\n\t\t}\n\t\tif (noTasksNotificationReadButton)\n\t\t{\n\t\t\tEvent.bind(noTasksNotificationReadButton, 'click', this.setNoTasksNotificationRead.bind(this));\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tif (this.feedInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tPinnedPanelInstance.init();\n\t\tInformerInstance.init();\n\n\t\tthis.feedInitialized = true;\n\t}\n\n\tchangeFollow(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (!logId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst followNode = document.getElementById('log_entry_follow_' + logId);\n\t\tconst valueOld = (followNode && followNode.getAttribute('data-follow') === 'Y' ? 'Y' : 'N');\n\t\tconst valueNew = (valueOld === 'Y' ? 'N' : 'Y');\n\n\t\tthis.renderFollow({\n\t\t\tlogId: logId,\n\t\t\tvalue: valueNew\n\t\t});\n\n\t\tajax.runAction('socialnetwork.api.livefeed.changeFollow', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: valueNew\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: (valueNew === 'Y' ? 'setFollow' : 'setUnfollow')\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tif (!response.data.success)\n\t\t\t{\n\t\t\t\tthis.renderFollow({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tvalue: valueOld\n\t\t\t\t});\n\t\t\t}\n\t\t}, () => {\n\t\t\tthis.renderFollow({\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: valueOld\n\t\t\t});\n\t\t});\n\n\t\treturn false;\n\t}\n\n\trenderFollow(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (!logId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst followNode = document.getElementById('log_entry_follow_' + logId);\n\t\tconst value = (params.value && params.value === 'Y' ? 'Y' : 'N');\n\n\t\tif (followNode)\n\t\t{\n\t\t\tfollowNode.setAttribute('data-follow', value);\n\t\t}\n\n\t\tconst textNode = (followNode ? followNode.querySelector('a') : null);\n\t\tif (textNode)\n\t\t{\n\t\t\ttextNode.innerHTML = Loc.getMessage('SONET_EXT_LIVEFEED_FOLLOW_TITLE_' + value);\n\t\t}\n\n\t\tconst postNode = (followNode ? followNode.closest('.feed-post-block') : null);\n\t\tif (postNode)\n\t\t{\n\t\t\tif (value === 'N')\n\t\t\t{\n\t\t\t\tpostNode.classList.add('feed-post-block-unfollowed');\n\t\t\t}\n\t\t\telse if (value === 'Y')\n\t\t\t{\n\t\t\t\tpostNode.classList.remove('feed-post-block-unfollowed');\n\t\t\t}\n\t\t}\n\t}\n\n\tchangeFavorites(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst event = (params.event ? params.event : null);\n\n\t\tlet node = (params.node ? params.node : null);\n\t\tlet newState = (params.newState ? params.newState : null);\n\n\t\tif (Type.isStringFilled(node))\n\t\t{\n\t\t\tnode = document.getElementById(node);\n\t\t}\n\n\t\tif (!logId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menuItem = null;\n\n\t\tif (event)\n\t\t{\n\t\t\tmenuItem = event.target;\n\t\t\tif (!menuItem.classList.contains('menu-popup-item-text'))\n\t\t\t{\n\t\t\t\tmenuItem = menuItem.querySelector('.menu-popup-item-text');\n\t\t\t}\n\t\t}\n\n\t\tlet nodeToAdjust = null;\n\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tnodeToAdjust = (\n\t\t\t\tnode.classList.contains('feed-post-important-switch')\n\t\t\t\t\t? node\n\t\t\t\t\t: node.querySelector('.feed-post-important-switch')\n\t\t\t);\n\t\t}\n\n\t\tif (typeof this.entryData[logId] == 'undefined')\n\t\t{\n\t\t\tthis.entryData[logId] = {};\n\t\t}\n\n\t\tif (typeof this.entryData[logId].favorites != 'undefined')\n\t\t{\n\t\t\tnewState = (this.entryData[logId].favorites ? 'N' : 'Y');\n\t\t\tthis.entryData[logId].favorites = !this.entryData[logId].favorites;\n\t\t}\n\t\telse if (nodeToAdjust)\n\t\t{\n\t\t\tnewState = (\n\t\t\t\tnodeToAdjust.classList.contains('feed-post-important-switch-active')\n\t\t\t\t\t? 'N'\n\t\t\t\t\t: 'Y'\n\t\t\t);\n\t\t\tthis.entryData[logId].favorites = (newState == 'Y');\n\t\t}\n\n\t\tif (!newState)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.adjustFavoritesControlItem(nodeToAdjust, newState);\n\t\tthis.adjustFavoritesMenuItem(menuItem, newState);\n\n\t\tajax.runAction('socialnetwork.api.livefeed.changeFavorites', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: newState,\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: (newState == 'Y' ? 'addFavorites' : 'removeFavorites')\n\t\t\t}\n\t\t}).then(response =>\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isStringFilled(response.data.newValue)\n\t\t\t\t&& ['Y', 'N'].includes(response.data.newValue)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.entryData[logId].favorites = (response.data.newValue == 'Y');\n\t\t\t}\n\n\t\t\tthis.adjustFavoritesControlItem(nodeToAdjust, response.data.newValue);\n\t\t\tthis.adjustFavoritesMenuItem(menuItem, response.data.newValue);\n\n\t\t}, () => {\n\t\t\tthis.entryData[logId].favorites = !this.entryData[logId].favorites;\n\t\t});\n\t}\n\n\tadjustFavoritesMenuItem(menuItemNode, state)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(menuItemNode)\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tmenuItemNode.innerHTML = this.getMenuTitle(state === 'Y');\n\t}\n\n\tadjustFavoritesControlItem(node, state)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(node)\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnode.title = this.getMenuTitle(state === 'Y');\n\t\tif (state == 'Y')\n\t\t{\n\t\t\tnode.classList.add('feed-post-important-switch-active');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.classList.remove('feed-post-important-switch-active');\n\t\t}\n\t}\n\n\tgetMenuTitle(state: boolean): string\n\t{\n\t\treturn Loc.getMessage(`SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_${state ? 'Y' : 'N'}`);\n\t}\n\n\tdelete(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst node = (Type.isStringFilled(params.nodeId) ? document.getElementById(params.nodeId) : null);\n\t\tconst ind = (params.ind ? params.ind : '');\n\n\t\tif (\n\t\t\tlogId <= 0\n\t\t\t|| !node\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction('socialnetwork.api.livefeed.deleteEntry', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: 'deleteLogEntry',\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tif (response.data.success)\n\t\t\t{\n\t\t\t\tif (!Type.isUndefined(ind))\n\t\t\t\t{\n\t\t\t\t\tMenuManager.destroy(Post.getMenuId(ind));\n\t\t\t\t}\n\t\t\t\tthis.deleteSuccess(node);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.deleteFailure(node);\n\t\t\t}\n\t\t}, () => {\n\t\t\tthis.deleteFailure(node);\n\t\t});\n\t}\n\n\tdeleteSuccess(node)\n\t{\n\t\tif (!Type.isDomNode(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t(new BX.fx({\n\t\t\ttime: 0.5,\n\t\t\tstep: 0.05,\n\t\t\ttype: 'linear',\n\t\t\tstart: node.offsetHeight,\n\t\t\tfinish: 56,\n\t\t\tcallback: (height) => {\n\t\t\t\tnode.style.height = `${height}px`;\n\t\t\t},\n\t\t\tcallback_start: () => {\n\t\t\t\tnode.style.overflow = 'hidden';\n\t\t\t\tnode.style.minHeight = 0;\n\t\t\t},\n\t\t\tcallback_complete: () => {\n\t\t\t\tnode.style.marginBottom = 0;\n\t\t\t\tDom.clean(node);\n\t\t\t\tnode.classList.add('feed-post-block-deleted');\n\t\t\t\tnode.appendChild(Tag.render`<div class=\"feed-add-successfully\"><span class=\"feed-add-info-text\"><span class=\"feed-add-info-icon\"></span><span>${Loc.getMessage('SONET_EXT_LIVEFEED_DELETE_SUCCESS')}</span></span></span></div>`);\n\t\t\t}\n\t\t})).start();\n\t}\n\n\tdeleteFailure(node)\n\t{\n\t\tif (!Type.isDomNode(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnode.insertBefore(Tag.render`<div class=\"feed-add-error\" style=\"margin: 18px 37px 4px 84px;\"><span class=\"feed-add-info-text\"><span class=\"feed-add-info-icon\"></span><span>${Loc.getMessage('sonetLMenuDeleteFailure')}</span></span></div>`, node.firstChild);\n\t}\n\n\tsetMoreButtons(value)\n\t{\n\t\tthis.moreButtonDataList = value;\n\t}\n\n\tgetMoreButtons()\n\t{\n\t\treturn this.moreButtonDataList;\n\t}\n\n\tclearMoreButtons()\n\t{\n\t\tthis.moreButtonDataList.clear();\n\t}\n\n\taddMoreButton(key, data)\n\t{\n\t\tthis.moreButtonDataList.set(key, data);\n\t}\n\n\tsetNoTasksNotificationRead(event)\n\t{\n\t\tconst notificationNode = event.currentTarget.closest('.feed-notification-container');\n\t\tif (!notificationNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction('socialnetwork.api.livefeed.readNoTasksNotification', {\n\t\t\tdata: {}\n\t\t}).then((response) => {\n\t\t\tif (!response.data.success)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnotificationNode.style.height = notificationNode.offsetHeight + 'px';\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnotificationNode.classList.add('feed-notification-container-collapsed');\n\t\t\t}, 10);\n\t\t\tsetTimeout(() => {\n\t\t\t\tnotificationNode.parentNode.removeChild(notificationNode);\n\t\t\t}, 250);\n\n\t\t}, () => {});\n\t}\n\n}\n\nconst FeedInstance = new Feed();\nconst PinnedPanelInstance = new PinnedPanel();\nconst InformerInstance = new Informer();\nconst FilterInstance = new Filter();\nconst PageInstance = new Page();\nconst MoreButtonInstance = new MoreButton();\nnew TaskCreator();\n\nexport {\n\tFeedInstance,\n\tPinnedPanelInstance,\n\tInformerInstance,\n\tFilterInstance,\n\tPageInstance,\n\tMoreButtonInstance,\n\tPost,\n\tTaskCreator,\n\tLoader,\n\tMoreButton,\n\tContentView,\n\tCommentForm,\n};\n"],"names":["Utils","node","styles","Object","entries","forEach","key","value","style","PinnedPanel","pin","post","postHide","postComments","postPinned","postPinnedHide","postPinActive","postUnfollowed","postExpanding","panelCollapsed","panelNonEmpty","panelPosts","collapsedPanel","collapsedPanelExpand","collapsedPanelCounterPostsValue","collapsedPanelCounterComments","collapsedPanelCounterCommentsValue","collapsedPanelCounterCommentsShown","collapsedPanelCounterCommentsValueNew","collapsedPanelCounterCommentsValueNewValue","collapsedPanelCounterCommentsValueNewActive","collapsedPanelCounterCommentsValueOld","collapsedPanelCounterCommentsValueAll","collapsedPanelShow","collapsedPanelHide","cancelPanel","cancelPanelButton","cancelPanelLabel","panelInitialized","postsInitialized","handlePostClick","bind","options","Event","ready","initPosts","initPanel","initEvents","optionName","pinnedPanelNode","getPanelNode","adjustCollapsedPostsPanel","getCollapsedPanelNode","collapsedHeight","offsetHeight","setStyle","height","transition","setTimeout","hideCollapsedPanel","event","likeClicked","target","classList","contains","closest","followClicked","menuClicked","contentViewClicked","pinClicked","collapseClicked","commentsClicked","postNode","remove","menuId","getAttribute","MenuManager","destroy","BaseEvent","compatData","rootNode","data","EventEmitter","emit","anchorNode","querySelector","position","Dom","getPosition","window","scrollTo","top","stopPropagation","preventDefault","add","postList","document","querySelectorAll","length","Array","from","unbind","newState","logId","parseInt","changePinned","then","subscribe","getData","xmlId","id","getCommentsData","oldValue","newValue","setCommentsData","Type","isInteger","incrementMaxListeners","params","commentId","allValue","follow","commentsData","AUTHOR","ID","BX","message","panelNode","Promise","resolve","reject","getOption","setPostState","state","action","ajax","runAction","analyticsLabel","b24statAction","response","success","movePost","includes","setAttribute","Loc","getMessage","headers","name","entityValue","tokenValue","postToMove","parentNode","originalPostHeight","getPinnedData","pinnedPanelTitleNode","pinnedPanelDescriptionNode","pinnedPanelPinNode","innerHTML","TITLE","DESCRIPTION","title","cancelPinnedPanel","getCancelPinnedPanel","anchor","nextSibling","insertBefore","centerCancelPinnedPanelElements","cancelPanelHeight","width","backgroundColor","opacity","setOptions","panelHeight","pinBlocked","unbindAll","checkTransitionProperty","panelPostsNode","firstChild","adjustPanel","showCollapsedPostsPanel","pinnedHeight","scrollHeight","isDomNode","requestAnimationFrame","collapsed","showCollapsed","hideCollapsedPostsPanel","transform","display","animateCancel","marginBottom","Tag","render","marginLeft","getBoundingClientRect","getElementsByClassName","reduce","count","item","map","currentIndex","originalItemsList","postsCounter","getPostsCount","postsCounterNode","commentsCounterNode","commentsCounterValueNode","newCommentCounter","acc","showCollapsedPanel","hidePinnedItems","removeCollapsedPanel","showPinnedItems","animateCollapsedPanel","result","newNode","newValueNode","oldNode","allNode","isStringFilled","commentsNode","newPinnedCommentsNode","newValuePinnedCommentsNode","oldPinnedCommentsNode","allPinnedCommentsNode","getCommentsNodes","newCommentsValue","oldCommentsValue","allCommentsValue","matches","match","propertyName","TaskCreator","getCompatData","type","isPlainObject","isBoolean","STAY_AT_PAGE","signedFiles","sliderInstance","getTarget","sliderUrl","getUrl","entityType","entityId","postEntityType","entityData","SUFFIX","requestData","formatTaskDescription","URL","parentTaskId","PARENT_ID","UF_TASK_WEBDAV_FILES_SIGN","link","SidePanel","Instance","open","requestMethod","requestParams","cacheable","createTaskPopup","Popup","autoHide","zIndex","offsetLeft","offsetTop","overlay","lightShadow","closeIcon","right","draggable","restrict","closeByEsc","contentColor","contentNoPaddings","buttons","content","cssClass","popupContent","events","onAfterPopupShow","createTaskSetContent","popupTitle","isNumber","additionalParams","getSonetGroupAvailable","getLivefeedUrl","checkPermissions","feature","operation","entryTitle","entryDescription","entryDiskObjects","DISK_OBJECTS","entryUrl","LIVEFEED_URL","entrySuffix","groupsAvailable","GROUPS_AVAILABLE","isUndefined","LOG_ID","taskDescription","taskData","RESPONSIBLE_ID","CREATED_BY","UF_TASK_WEBDAV_FILES","sonetGroupIdList","push","GROUP_ID","runComponentAction","mode","resultData","createTaskSetContentSuccess","DATA","sourceEntityType","sourceEntityId","errors","error","createTaskSetContentFailure","onPopupClose","show","taskId","taskLink","replace","UI","Notification","Center","notify","actions","click","balloon","close","popupDescription","join","contentNode","containerNode","getElementById","clean","appendChild","livefeedUrl","suffix","Post","urlToEdit","menuPopupWindow","dialog","bindOnResize","titleBar","className","Button","text","location","menuElement","ind","getMenuId","log_id","bFavorites","arMenuItemsAdditional","JSON","parse","e","bindElement","itemPinned","pinnedPostNode","pinnedState","onclick","PinnedPanelInstance","getMenuById","popupWindow","itemFavorites","__logChangeFavorites","arItems","html","href","menuItemText","menuItemIconDone","clipboard","isCopySupported","copy","adjust","attrs","it","currentTarget","pos","pos2","pos3","overflow","children","create","select","fx","time","step","start","finish","callback","hide","confirm","FeedInstance","nodeId","entryEntityType","isArray","concat","arParams","angle","offset","onPopupShow","ob","favoritesMenuItem","menuItems","contentContainer","menuItem","linkMenuItem","popupContainer","Informer","container","wrap","plus","currentSiteId","currentCounterType","counterDecrementStack","counterValue","lockCounterAnimation","informerFixed","informerAnimation","informerFixedAnimation","counterText","counterContainer","reloadContainer","icon","iconRotating","plusHidden","initNodes","addEventListener","showReloadAnimation","unfixWrap","command","eventParams","changeCounter","Runtime","clone","counterData","isObjectLike","live","decrementCounter","valueToShow","changeAnimate","counter","zeroCounterFromDb","counterTextNode","reloadNode","showWrapAnimation","hideReloadAnimation","hideWrapAnimation","visibility","counterWaiterNode","counterNodeWaiter","fixWrap","counterContainerNode","hideReloadNode","Loader","feedContainer","feedMask","feedNoMask","loaderContainer","hideLoader","showLoader","animationName","MoreButton","onRecalculateLivefeedComments","baseEvent","informerBlock","moreBlock","more","postSeparator","recalcPost","arPos","blockHeight","bodyBlock","postBlock","postShort","buttonsList","getMoreButtons","buttonData","bodyBlockID","bodyNode","outerBlockID","outerNode","offsetWidth","innerNode","postTextInner","overflowX","moreButton","Animations","expand","moreButtonNode","classBlock","postText","classOuter","classInner","postTextInnerInner","heightLimit","textBlock","informerBlockID","setMoreButtons","onLoadImageList","imageNode","outerBlock","comment","image","textType","Forum","Filter","filterId","filterApi","Main","filterManager","getById","getApi","showRefreshFade","filterValues","filterPromise","filterParams","autoResolve","PageInstance","refresh","useBXMainFilter","searchString","hideRefreshFade","tagValue","setFields","TAG","apply","filterContainer","getSearch","getSquares","getSearchString","pagetitleContainer","easing","duration","scroll","pageYOffset","makeEaseOut","transitions","quart","complete","animate","ContentView","fullContentArea","viewAreaList","findChildren","tag","i","findChild","UserContentView","registerViewArea","Page","loadStarted","stopTrackNextPage","requestMode","nextPageFirst","nextPageUrl","scrollInitialized","firstPageLastTS","firstPageLastId","commentFormUID","blogCommentFormUID","signedParameters","componentName","init","setRequestModeNew","siteTemplateId","assetsCheckSum","clearCommentsList","clearMoreButtons","InformerInstance","getSignedParameters","c","getComponentName","logajax","RELOAD","responseData","fulfill","emptyLivefeed","componentResult","EMPTY","forcePageRefresh","FORCE_PAGE_REFRESH","isFilterUsed","FILTER_USED","reload","emptyBlock","emptyTextNode","clearContainerExternal","LazyLoad","clearImages","pageNode","Math","floor","random","recalcPostsList","recalcCommentsList","registerAreaList","resetFlags","informerWrap","getWrap","showRefreshError","stubContainer","stubFirstContainer","setRequestModeMore","nextUrlParamsList","Uri","getNextPageUrl","getQueryParams","pageNumber","prevPageLogId","ts","noblog","decodeURI","queryParams","PAGE_NUMBER","LAST_LOG_TIMESTAMP","PREV_PAGE_LOG_ID","preset_filter_top_id","preset_filter_id","queryData","CREATED_BY_ID","flt_created_by_id","flt_date_datesel","flt_date_from","decodeURIComponent","flt_date_to","lastEntryTimestamp","LAST_TS","lastEntryId","LAST_ID","isNull","contentBlockId","f","recover","counterPreset","onFeedScroll","maxScroll","documentElement","innerHeight","getNextPage","CommentForm","taskIdList","resultFieldTaskIdList","ResultManager","taskResultCommentsData","assign","commentsIdList","getInstance","initResult","context","comments","obj","postData","ENTITY_XML_ID","currentEntity","ENTITY_TYPE","split","ENTITY_ID","parentId","comment_post_id","edit_id","act","form","onLightEditorShow","Tasks","showField","hideField","UF","arFiles","fileId","index","size","FILE_ID","FILE_NAME","FILE_SIZE","CONTENT_TYPE","UF_SONET_COM_DOC","USER_TYPE_ID","FIELD_NAME","VALUE","arDocs","UF_SONET_COM_FILE","arDFiles","LHEPostForm","reinitData","SLEC","editorId","Feed","entryData","feedInitialized","moreButtonDataList","Map","setSignedParameters","setComponentName","onAnimationEnd","processSpoilerToggle","FilterInstance","crmEntityTypeName","crmEntityId","initEventsCrm","clickTag","noTasksNotificationCloseIcon","noTasksNotificationReadButton","setNoTasksNotificationRead","followNode","valueOld","valueNew","renderFollow","textNode","nodeToAdjust","favorites","adjustFavoritesControlItem","adjustFavoritesMenuItem","menuItemNode","getMenuTitle","deleteSuccess","deleteFailure","callback_start","minHeight","callback_complete","clear","set","notificationNode","removeChild","MoreButtonInstance"],"mappings":"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"}