{"version":3,"file":"livefeed.bundle.js","sources":["../src/utils.js","../src/pinned.js","../src/post.js","../src/informer.js","../src/feed.js"],"sourcesContent":["class Utils\n{\n\tstatic setStyle(node, styles)\n\t{\n\t\tObject.entries(styles).forEach(([key, value]) => {\n\t\t\tnode.style[key] = value;\n\t\t});\n\t}\n}\n\nexport {\n\tUtils\n};\n","import { ajax, Event, Type, Loc, Dom, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\nimport { Utils } from \"./utils\";\n\nclass PinnedPanel\n{\n\tconstructor()\n\t{\n\t\tthis.class = {\n\t\t\tpin: 'feed-post-pin',\n\n\t\t\tpost: 'feed-item-wrap',\n\t\t\tpostHide: 'feed-item-wrap-hide',\n\t\t\tpostComments: 'feed-comments-block',\n\n\t\t\tpostPinned: 'feed-post-block-pinned',\n\t\t\tpostPinnedHide: 'feed-post-block-pinned-hide',\n\t\t\tpostPinActive: 'feed-post-block-pin-active',\n\t\t\tpostUnfollowed: 'feed-post-block-unfollowed',\n\n\t\t\tpostExpanding: 'feed-post-block-expand',\n\n\t\t\tpanelCollapsed: 'feed-pinned-panel-collapsed',\n\t\t\tpanelNonEmpty: 'feed-pinned-panel-nonempty',\n\t\t\tpanelPosts: 'feed-pinned-panel-posts',\n\n\t\t\tcollapsedPanel: 'feed-post-collapsed-panel',\n\t\t\tcollapsedPanelExpand: 'feed-post-collapsed-panel-right',\n\t\t\tcollapsedPanelCounterPostsValue: 'feed-post-collapsed-panel-count-posts',\n\t\t\tcollapsedPanelCounterComments: 'feed-post-collapsed-panel-box-comments',\n\t\t\tcollapsedPanelCounterCommentsValue: 'feed-post-collapsed-panel-count-comments-value',\n\t\t\tcollapsedPanelCounterCommentsShown: 'feed-post-collapsed-panel-box-shown',\n\t\t\tcollapsedPanelCounterCommentsValueNew: 'feed-inform-comments-pinned-new',\n\t\t\tcollapsedPanelCounterCommentsValueNewValue: 'feed-inform-comments-pinned-new-value',\n\t\t\tcollapsedPanelCounterCommentsValueNewActive: 'feed-inform-comments-pinned-new-active',\n\t\t\tcollapsedPanelCounterCommentsValueOld: 'feed-inform-comments-pinned-old',\n\t\t\tcollapsedPanelCounterCommentsValueAll: 'feed-inform-comments-pinned-all',\n\t\t\tcollapsedPanelShow: 'feed-post-collapsed-panel--show',\n\t\t\tcollapsedPanelHide: 'feed-post-collapsed-panel--hide',\n\n\t\t\tcancelPanel: 'feed-post-cancel-pinned-panel',\n\t\t\tcancelPanelButton: 'feed-post-cancel-pinned-btn',\n\t\t\tcancelPanelLabel: 'feed-post-cancel-pinned-label'\n\t\t};\n\n\t\tthis.panelInitialized = false;\n\t\tthis.postsInitialized = false;\n\t\tthis.handlePostClick = this.handlePostClick.bind(this);\n\t\tthis.options = {};\n\n\t\t/* for detail page without pinned panel */\n\t\tthis.initPosts();\n\t}\n\n\tresetFlags()\n\t{\n\t\tthis.panelInitialized = false;\n\t\tthis.postsInitialized = false;\n\t}\n\n\tinit()\n\t{\n\t\t/* for list page in composite mode */\n\t\tthis.initPanel();\n\n\t\tthis.initPosts();\n\t\tthis.initEvents();\n\t}\n\n\tsetOptions(options)\n\t{\n\t\tthis.options = { ...this.options, ...options };\n\t}\n\n\tgetOption(optionName)\n\t{\n\t\treturn this.options[optionName];\n\t}\n\n\tinitPanel()\n\t{\n\t\tif (this.panelInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.panelInitialized = true;\n\n\t\tthis.adjustCollapsedPostsPanel();\n\n\t\tEvent.bind(this.getCollapsedPanelNode(), 'click', () => {\n\t\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\t\tif (!pinnedPanelNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst collapsedHeight = pinnedPanelNode.offsetHeight;\n\n\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\theight: collapsedHeight + 'px',\n\t\t\t\ttransition: 'height .5s'\n\t\t\t});\n\t\t\tsetTimeout(() => {\n\t\t\t\tpinnedPanelNode.style = '';\n\t\t\t}, 550);\n\t\t\tthis.hideCollapsedPanel();\n\t\t});\n\n\t\tEvent.bind(pinnedPanelNode, 'click', (event) => {\n\t\t\tconst likeClicked = event.target.classList.contains('feed-inform-ilike') || event.target.closest('.feed-inform-ilike') !== null;\n\t\t\tconst followClicked = event.target.classList.contains('feed-inform-follow') || event.target.closest('.feed-inform-follow') !== null;\n\t\t\tconst menuClicked = (\n\t\t\t\tevent.target.classList.contains('feed-post-more-link')\n\t\t\t\t|| event.target.closest('.feed-post-more-link') !== null\n\t\t\t\t|| event.target.classList.contains('feed-post-right-top-menu')\n\t\t\t);\n\t\t\tconst contentViewClicked = event.target.classList.contains('feed-inform-contentview') || event.target.closest('.feed-inform-contentview') !== null;\n\t\t\tconst pinClicked = event.target.classList.contains(`${this.class.pin}`) || event.target.closest(`.${this.class.pin}`) !== null;\n\t\t\tconst collapseClicked = event.target.classList.contains('feed-post-pinned-link-collapse');\n\t\t\tconst commentsClicked = event.target.classList.contains('feed-inform-comments-pinned') || event.target.closest('.feed-inform-comments-pinned') !== null;\n\n\t\t\tlet postNode = null;\n\n\t\t\tif (event.target.classList.contains('feed-post-block'))\n\t\t\t{\n\t\t\t\tpostNode = event.target;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpostNode = event.target.closest('.feed-post-block');\n\t\t\t}\n\n\t\t\tif (!postNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (postNode.classList.contains(`${this.class.postPinned}`))\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\t!likeClicked\n\t\t\t\t\t&& !followClicked\n\t\t\t\t\t&& !menuClicked\n\t\t\t\t\t&& !contentViewClicked\n\t\t\t\t\t&& !pinClicked\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tpostNode.classList.remove(`${this.class.postPinned}`);\n\n\t\t\t\t\tconst menuId = postNode.getAttribute('data-menu-id');\n\n\t\t\t\t\tif (menuId)\n\t\t\t\t\t{\n\t\t\t\t\t\tMenuManager.destroy(menuId);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst event = new BaseEvent({\n\t\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\t\trootNode: postNode\n\t\t\t\t\t\t}],\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\trootNode: postNode\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tEventEmitter.emit('BX.Livefeed:recalculateComments', event);\n\t\t\t\t}\n\n\t\t\t\tif (commentsClicked)\n\t\t\t\t{\n\t\t\t\t\tconst anchorNode = postNode.querySelector(`.${this.class.postComments} a[name=comments]`);\n\n\t\t\t\t\tif (anchorNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst position = Dom.getPosition(anchorNode);\n\t\t\t\t\t\twindow.scrollTo(0, position.top - 200);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (collapseClicked)\n\t\t\t{\n\t\t\t\tpostNode.classList.add(`${this.class.postPinned}`);\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t});\n\t}\n\n\tinitPosts()\n\t{\n\t\tif (this.postsInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst postList = document.querySelectorAll('[data-livefeed-post-pinned]');\n\t\tif (postList.length > 0)\n\t\t{\n\t\t\tthis.postsInitialized = true;\n\t\t}\n\n\t\tArray.from(postList).forEach((post) => {\n\t\t\tEvent.unbind(post, 'click', this.handlePostClick);\n\t\t\tEvent.bind(post, 'click', this.handlePostClick);\n\t\t});\n\t}\n\n\thandlePostClick(event)\n\t{\n\t\tif (!event.target.classList.contains(`${this.class.pin}`))\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst post = event.target.closest('[data-livefeed-id]');\n\n\t\tif (!post)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newState = (post.getAttribute('data-livefeed-post-pinned') === 'Y' ? 'N' : 'Y');\n\t\tconst logId = parseInt(post.getAttribute('data-livefeed-id'));\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.changePinned({\n\t\t\tlogId: logId,\n\t\t\tnewState: newState,\n\t\t\tevent: event\n\t\t\t\t}).then(() => {\n\t\t});\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('OnUCCommentWasRead', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, options ] = event.getData();\n\t\t\tconst { oldValue, newValue } = this.getCommentsData(xmlId);\n\n\t\t\tif (!!options.new)\n\t\t\t{\n\t\t\t\tthis.setCommentsData(xmlId, {\n\t\t\t\t\tnewValue: (Type.isInteger(newValue) ? (newValue - 1) : 0),\n\t\t\t\t\toldValue: (Type.isInteger(oldValue) ? (oldValue + 1) : 1)\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.incrementMaxListeners('OnUCCommentWasPulled');\n\t\tEventEmitter.subscribe('OnUCCommentWasPulled', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ id, data, params ] = event.getData();\n\t\t\tconst [ xmlId, commentId ] = id;\n\t\t\tconst { newValue, oldValue, allValue, follow } = this.getCommentsData(xmlId);\n\n\t\t\tconst commentsData = {\n\t\t\t\tallValue: (Type.isInteger(allValue) ? (allValue + 1) : 1)\n\t\t\t};\n\n\t\t\tif (parseInt(params.AUTHOR.ID) !== parseInt(BX.message('USER_ID')))\n\t\t\t{\n\t\t\t\tcommentsData.newValue = (Type.isInteger(newValue) ? (newValue + 1) : 1);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommentsData.oldValue = (Type.isInteger(oldValue) ? (oldValue + 1) : 1);\n\t\t\t}\n\n\t\t\tthis.setCommentsData(xmlId, commentsData);\n\t\t});\n\n\t\tEventEmitter.subscribe('OnUCommentWasDeleted', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, data ] = event.getData();\n\t\t\tconst { oldValue, allValue } = this.getCommentsData(xmlId);\n\n\t\t\tthis.setCommentsData(xmlId, {\n\t\t\t\tallValue: (Type.isInteger(allValue) ? (allValue - 1) : 0),\n\t\t\t\toldValue: (Type.isInteger(oldValue) ? (oldValue - 1) : 0)\n\t\t\t});\n\t\t});\n\t}\n\n\tchangePinned(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst event = (params.event ? params.event : null);\n\n\t\tlet node = (params.node ? params.node : null);\n\t\tlet newState = (params.newState ? params.newState : null);\n\n\t\tconst panelNode = this.getPanelNode();\n\n\t\tif (\n\t\t\t!node\n\t\t\t&& !event\n\t\t\t&& logId > 0\n\t\t\t&& panelNode\n\t\t)\n\t\t{\n\t\t\tnode = panelNode.querySelector(`.${this.class.post} > [data-livefeed-id=\"${logId}\"]`);\n\t\t}\n\n\t\tif (\n\t\t\t!node\n\t\t\t&& event\n\t\t)\n\t\t{\n\t\t\tnode = event.target;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (\n\t\t\t\t!!this.getOption('pinBlocked') ||\n\t\t\t\t!node\n\t\t\t\t|| !newState\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tthis.setPostState({\n\t\t\t\tnode: node,\n\t\t\t\tstate: newState\n\t\t\t});\n\n\t\t\tajax.runAction('socialnetwork.api.livefeed.logentry.' + (newState === 'Y' ? 'pin' : 'unpin'), {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: logId\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tb24statAction: (newState === 'Y' ? 'pinLivefeedEntry' : 'unpinLivefeedEntry')\n\t\t\t\t}\n\t\t\t}).then(response => {\n\t\t\t\tif (!response.data.success)\n\t\t\t\t{\n\t\t\t\t\tthis.setPostState({\n\t\t\t\t\t\tnode: node,\n\t\t\t\t\t\tstate: (newState === 'Y' ? 'N' : 'Y')\n\t\t\t\t\t});\n\t\t\t\t\treturn resolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.movePost({\n\t\t\t\t\t\tnode: node,\n\t\t\t\t\t\tstate: newState\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\treturn resolve();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, response => {\n\t\t\t\tthis.setPostState({\n\t\t\t\t\tnode: node,\n\t\t\t\t\tstate: (newState === 'Y' ? 'N' : 'Y')\n\t\t\t\t});\n\t\t\t\treturn resolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tsetPostState(params)\n\t{\n\t\tconst state = (params.state ? params.state : null);\n\t\tconst node = (params.node ? params.node : null);\n\n\t\tif (\n\t\t\t!node\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst post = node.closest('[data-livefeed-post-pinned]');\n\t\tif (!post)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpost.setAttribute('data-livefeed-post-pinned', state);\n\n\t\tif (state === 'Y')\n\t\t{\n\t\t\tpost.classList.add(`${this.class.postPinActive}`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpost.classList.remove(`${this.class.postPinActive}`);\n\t\t}\n\n\t\tconst pin = post.querySelector(`.${this.class.pin}`);\n\t\tif (pin)\n\t\t{\n\t\t\tpin.setAttribute('title', Loc.getMessage(`SONET_EXT_LIVEFEED_PIN_TITLE_${state}`));\n\t\t}\n\t}\n\n\tgetPanelNode()\n\t{\n\t\treturn document.querySelector('[data-livefeed-pinned-panel]');\n\t}\n\n\tgetPinnedData(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction('socialnetwork.api.livefeed.logentry.getPinData', {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: logId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).then(response => {\n\t\t\t\treturn resolve(response.data);\n\t\t\t}, response => {\n\t\t\t\treturn reject();\n\t\t\t});\n\t\t})\n\t}\n\n\tmovePost(params)\n\t{\n\t\tconst state = (params.state ? params.state : null);\n\t\tconst node = (params.node ? params.node : null);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (\n\t\t\t\t!node\n\t\t\t\t|| !['Y', 'N'].includes(state)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst post = node.closest('[data-livefeed-post-pinned]');\n\t\t\tif (!post)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst logId = parseInt(post.getAttribute('data-livefeed-id'));\n\t\t\tif (!logId)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\t\tif (!pinnedPanelNode)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst postToMove = (post.parentNode.classList.contains(`${this.class.post}`) ? post.parentNode : post);\n\n\t\t\tif (state === 'Y')\n\t\t\t{\n\t\t\t\tconst originalPostHeight = postToMove.offsetHeight;\n\t\t\t\tpostToMove.setAttribute('bx-data-height', originalPostHeight);\n\n\t\t\t\tthis.getPinnedData({\n\t\t\t\t\tlogId: logId\n\t\t\t\t}).then(data => {\n\t\t\t\t\tconst pinnedPanelTitleNode = post.querySelector('.feed-post-pinned-title');\n\t\t\t\t\tconst pinnedPanelDescriptionNode = post.querySelector('.feed-post-pinned-desc');\n\t\t\t\t\tconst pinnedPanelPinNode = post.querySelector(`.${this.class.pin}`);\n\n\t\t\t\t\tif (pinnedPanelTitleNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelTitleNode.innerHTML = data.TITLE;\n\t\t\t\t\t}\n\t\t\t\t\tif (pinnedPanelDescriptionNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelDescriptionNode.innerHTML = data.DESCRIPTION;\n\t\t\t\t\t}\n\t\t\t\t\tif (pinnedPanelPinNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelPinNode.title = Loc.getMessage('SONET_EXT_LIVEFEED_PIN_TITLE_Y');\n\t\t\t\t\t}\n\n\t\t\t\t\tpost.classList.add(`${this.class.postPinnedHide}`);\n\n\t\t\t\t\tconst cancelPinnedPanel = this.getCancelPinnedPanel({ logId });\n\t\t\t\t\tconst anchor = postToMove.nextSibling;\n\n\t\t\t\t\tanchor.parentNode.insertBefore(cancelPinnedPanel, anchor);\n\t\t\t\t\tthis.centerCancelPinnedPanelElements({ cancelPinnedPanel });\n\n\t\t\t\t\tcancelPinnedPanel.setAttribute('bx-data-height', originalPostHeight);\n\t\t\t\t\tconst cancelPanelHeight = cancelPinnedPanel.getAttribute('bx-data-height');\n\n\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\theight: cancelPanelHeight + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\theight: originalPostHeight + 'px',\n\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\topacity: 0\n\t\t\t\t\t});\n\n\t\t\t\t\tconst panelNode = this.getPanelNode();\n\t\t\t\t\tif (panelNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\tpanelHeight: panelNode.offsetHeight\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// list.post::hide.start, cancelPanel::show.start\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tpostToMove.classList.add(`${this.class.postHide}`);\n\t\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\t\theight: '53px'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\t\topacity: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\tpinBlocked: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\t// list.post::hide.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\n\t\t\t\t\t\tconst panelPostsNode = pinnedPanelNode.querySelector(`.${this.class.panelPosts}`);\n\n\t\t\t\t\t\tpanelPostsNode.insertBefore(postToMove, panelPostsNode.firstChild);\n\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\n\t\t\t\t\t\tpostToMove.classList.remove(`${this.class.postHide}`);\n\t\t\t\t\t\tpost.classList.remove(`${this.class.postPinnedHide}`);\n\n\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t\tthis.showCollapsedPostsPanel();\n\n\t\t\t\t\t\t// pinnedPanel.post::show.start\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tpost.classList.add(`${this.class.postPinned}`);\n\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\tposition: '',\n\t\t\t\t\t\t\t\twidth: '',\n\t\t\t\t\t\t\t\theight: '80px',\n\t\t\t\t\t\t\t\tbackgroundColor: '',\n\t\t\t\t\t\t\t\topacity: 1\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\t\tpinBlocked: false\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tpostToMove.classList.remove(`${this.class.postHide}`);\n\t\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\t\tposition: '',\n\t\t\t\t\t\t\t\t\twidth: '',\n\t\t\t\t\t\t\t\t\theight: '',\n\t\t\t\t\t\t\t\t\tbackgroundColor: '',\n\t\t\t\t\t\t\t\t\topacity: ''\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}, 600); // 600 > transition 0.5\n\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn resolve();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst height = postToMove.getAttribute('bx-data-height');\n\t\t\t\tconst pinnedHeight = postToMove.scrollHeight;\n\n\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\ttransition: '',\n\t\t\t\t});\n\n\t\t\t\tconst cancelPinnedPanel = document.querySelector(`.${this.class.cancelPanel}[bx-data-log-id=\"${logId}\"]`);\n\t\t\t\tif (Type.isDomNode(cancelPinnedPanel))\n\t\t\t\t{\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\theight: pinnedHeight + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\t// pinnedPanel.post::hide.start, cancelPanel::show.start\n\t\t\t\t\trequestAnimationFrame(() => {\n\n\t\t\t\t\t\tpostToMove.classList.add(`${this.class.postExpanding}`);\n\t\t\t\t\t\tcancelPinnedPanel.classList.add(`${this.class.postExpanding}`);\n\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\theight: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\theight: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tconst collapsed = pinnedPanelNode.classList.contains(`${this.class.panelCollapsed}`);\n\n\t\t\t\t\tif (collapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tcancelPinnedPanel.parentNode.insertBefore(postToMove, cancelPinnedPanel.nextSibling);\n\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t}\n\n\t\t\t\t\tconst showCollapsed = this.getCollapsedPanelNode().classList.contains(`${this.class.collapsedPanelShow}`);\n\t\t\t\t\tif (showCollapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideCollapsedPostsPanel();\n\n\t\t\t\t\t\t// cancelPanel::show.end\n\t\t\t\t\t\tEvent.unbindAll(cancelPinnedPanel, 'transitionend');\n\t\t\t\t\t\tEvent.bind(cancelPinnedPanel, 'transitionend', (event) => {\n\t\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\ttransform: '',\n\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.animateCancel({\n\t\t\t\t\t\t\t\tpost,\n\t\t\t\t\t\t\t\tpostToMove,\n\t\t\t\t\t\t\t\tcancelPinnedPanel,\n\t\t\t\t\t\t\t\theight\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// pinnedPanel.post::hide.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'opacity'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!collapsed)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcancelPinnedPanel.parentNode.insertBefore(postToMove, cancelPinnedPanel.nextSibling);\n\t\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\t\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.animateCancel({\n\t\t\t\t\t\t\tpost,\n\t\t\t\t\t\t\tpostToMove,\n\t\t\t\t\t\t\tcancelPinnedPanel,\n\t\t\t\t\t\t\theight\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpost.classList.remove(`${this.class.postPinned}`);\n\t\t\t\t\tpinnedPanelNode.parentNode.insertBefore(postToMove, pinnedPanelNode.nextSibling);\n\t\t\t\t\tthis.adjustPanel();\n\n\t\t\t\t\tconst originalPostHeight = postToMove.scrollHeight;\n\t\t\t\t\tpostToMove.setAttribute('bx-data-height', originalPostHeight);\n\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\theight: '80px'\n\t\t\t\t\t});\n\n\t\t\t\t\t// list.post::show.start\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\t\theight: originalPostHeight + 'px'\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\t// list.post::show.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\theight:''\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\treturn resolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tanimateCancel({\n\t\tpost,\n\t \tpostToMove,\n\t\tcancelPinnedPanel,\n\t\theight\n\t})\n\t{\n\t\tpost.classList.remove(`${this.class.postPinned}`);\n\n\t\t// post.list:show.start, cancelPanel::hide.start\n\t\tsetTimeout(() => {\n\n\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\topacity: 1,\n\t\t\t\theight: height + 'px'\n\t\t\t});\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\theight: 0\n\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tcancelPinnedPanel.remove();\n\t\t\t}, 100)\n\t\t}, 100);\n\n\t\t// post.list:show.end\n\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpost.classList.remove(`${this.class.postPinnedHide}`);\n\n\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\tmarginBottom: '',\n\t\t\t\theight: ''\n\t\t\t});\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\tmarginBottom: '',\n\t\t\t\theight: ''\n\t\t\t});\n\n\t\t\tpostToMove.classList.remove(`${this.class.postExpanding}`);\n\t\t\tcancelPinnedPanel.classList.remove(`${this.class.postExpanding}`);\n\t\t});\n\t}\n\n\tgetCancelPinnedPanel(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet cancelPinnedPanel = document.querySelector(`.${this.class.cancelPanel}[bx-data-log-id=\"${logId}\"]`);\n\n\t\tif (!Type.isDomNode(cancelPinnedPanel))\n\t\t{\n\t\t\tcancelPinnedPanel = Tag.render`\n\t\t\t\t<div class=\"${this.class.cancelPanel}\" bx-data-log-id=\"${logId}\">\n\t\t\t\t\t<div class=\"feed-post-cancel-pinned-panel-inner\">\n\t\t\t\t\t\t<div class=\"feed-post-cancel-pinned-content\">\n\t\t\t\t\t\t\t<span class=\"${this.class.cancelPanelLabel}\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_TITLE')}</span>\n\t\t\t\t\t\t\t<span class=\"feed-post-cancel-pinned-text\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_DESCRIPTION')}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-round ui-btn-sm ${this.class.cancelPanelButton}\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_BUTTON')}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t\t`;\n\n\t\t\tEvent.bind(cancelPinnedPanel.querySelector(`.${this.class.cancelPanelButton}`), 'click', () => {\n\t\t\t\tthis.changePinned({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tnewState: 'N'\n\t\t\t\t}).then(() => {\n\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\theight: 0\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn cancelPinnedPanel;\n\t}\n\n\tcenterCancelPinnedPanelElements({ cancelPinnedPanel })\n\t{\n\t\tif (!Type.isDomNode(cancelPinnedPanel))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// cancelPanel::show.start\n\t\tsetTimeout(() => {\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\topacity: 1\n\t\t\t});\n\t\t}, 100);\n\n\t\tUtils.setStyle(cancelPinnedPanel.querySelector(`.${this.class.cancelPanelLabel}`), {\n\t\t\tmarginLeft: cancelPinnedPanel.querySelector(`.${this.class.cancelPanelButton}`).getBoundingClientRect().width + 'px'\n\t\t});\n\t}\n\n\tgetPostsCount()\n\t{\n\t\tconst panelNode = this.getPanelNode();\n\t\treturn (panelNode ? Array.from(panelNode.getElementsByClassName(`${this.class.post}`)).length : 0);\n\t}\n\n\thidePinnedItems()\n\t{\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\theight: parseInt(this.getOption('panelHeight')) + 'px'\n\t\t});\n\n\t\tArray.from(pinnedPanelNode.getElementsByClassName(`${this.class.post}`)).reduce((count, item) => {\n\n\t\t\tcount += item.offsetHeight;\n\n\t\t\tUtils.setStyle(item, {\n\t\t\t\ttransition: 'opacity .1s linear, transform .2s .1s linear, height .5s linear'\n\t\t\t});\n\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\ttransition: 'height .5s .1s linear'\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::hide.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\topacity: '0!important',\n\t\t\t\t\ttransform: `translateY(-${count}px)`\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: '58px'\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::hide.end\n\t\t\tEvent.unbindAll(item, 'transitionend');\n\t\t\tEvent.bind(item, 'transitionend', (event) => {\n\t\t\t\tif (!this.checkTransitionProperty(event, 'transform'))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\topacity: '',\n\t\t\t\t\ttransform: '',\n\t\t\t\t\ttransition: ''\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\ttransition: ''\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn count;\n\t\t}, 0);\n\t}\n\n\tshowPinnedItems()\n\t{\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tArray.from(pinnedPanelNode.getElementsByClassName(`${this.class.post}`)).map((item, currentIndex, originalItemsList) => {\n\n\t\t\tUtils.setStyle(item, {\n\t\t\t\tdisplay: 'block',\n\t\t\t\topacity: 0\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::show.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: ((84 * (currentIndex + 1)) - 4) + 'px'\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\ttransform: `translateY(${0}px)`,\n\t\t\t\t\topacity: 1\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::show.end\n\t\t\tEvent.unbindAll(item, 'transitionend');\n\t\t\tEvent.bind(item, 'transitionend', (event) => {\n\t\t\t\tif (!this.checkTransitionProperty(event, 'transform'))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\theight: '',\n\t\t\t\t\ttransform: ''\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: ''\n\t\t\t\t});\n\n\t\t\t\tif ((currentIndex + 1) === originalItemsList.length)\n\t\t\t\t{\n\t\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\t\ttransition: '',\n\t\t\t\t\t\theight: ''\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tanimateCollapsedPanel()\n\t{\n\t\t// collapsedPanel::hide.start\n\t\trequestAnimationFrame(() => {\n\t\t\tconst collapsedPanel = this.getCollapsedPanelNode();\n\n\t\t\tUtils.setStyle(collapsedPanel, {\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: 0,\n\t\t\t\twidth: '100%',\n\t\t\t\topacity: 0\n\t\t\t});\n\n\t\t\tcollapsedPanel.classList.remove(`${this.class.collapsedPanelHide}`);\n\t\t\tcollapsedPanel.classList.add(`${this.class.collapsedPanelShow}`);\n\n\t\t\t// collapsedPanel::show.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(collapsedPanel, {\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\topacity: 1\n\t\t\t\t});\n\t\t\t});\n\t\t})\n\t}\n\n\tadjustCollapsedPostsPanel()\n\t{\n\t\tconst postsCounter = this.getPostsCount();\n\t\tconst postsCounterNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterPostsValue}`);\n\t\tif (postsCounterNode)\n\t\t{\n\t\t\tpostsCounterNode.innerHTML = parseInt(postsCounter);\n\t\t}\n\n\t\tconst commentsCounterNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterComments}`);\n\t\tconst commentsCounterValueNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterCommentsValue}`);\n\t\tconst panelNode = this.getPanelNode();\n\n\t\tif (\n\t\t\tcommentsCounterNode\n\t\t\t&& commentsCounterValueNode\n\t\t\t&& panelNode\n\t\t)\n\t\t{\n\t\t\tconst newCommentCounter = Array.from(panelNode.querySelectorAll(`.${this.class.collapsedPanelCounterCommentsValueNewValue}`)).reduce((acc, node) => {\n\t\t\t\treturn acc + (node.closest(`.${this.class.postUnfollowed}`) ? 0 : parseInt(node.innerHTML));\n\t\t\t}, 0);\n\n\t\t\tcommentsCounterValueNode.innerHTML = newCommentCounter;\n\t\t\tif (newCommentCounter > 0)\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.add(`${this.class.collapsedPanelCounterCommentsShown}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.remove(`${this.class.collapsedPanelCounterCommentsShown}`);\n\t\t\t}\n\t\t}\n\t}\n\n\tadjustPanel()\n\t{\n\t\tconst panelNode = this.getPanelNode();\n\t\tif (!panelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.getPostsCount() > 0)\n\t\t\t{\n\t\t\t\tpanelNode.classList.add(`${this.class.panelNonEmpty}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpanelNode.classList.remove(`${this.class.panelNonEmpty}`);\n\t\t\t}\n\t\t}, 0);\n\t}\n\n\tshowCollapsedPostsPanel()\n\t{\n\t\tif (this.getPostsCount() >= Loc.getMessage('SONET_EXT_LIVEFEED_COLLAPSED_PINNED_PANEL_ITEMS_LIMIT'))\n\t\t{\n\t\t\tthis.showCollapsedPanel();\n\t\t\tthis.hidePinnedItems();\n\t\t}\n\t}\n\n\thideCollapsedPostsPanel()\n\t{\n\t\tif (this.getPostsCount() < Loc.getMessage('SONET_EXT_LIVEFEED_COLLAPSED_PINNED_PANEL_ITEMS_LIMIT'))\n\t\t{\n\t\t\tthis.getPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t\t\tthis.removeCollapsedPanel();\n\t\t\tthis.showPinnedItems();\n\t\t}\n\t}\n\n\tshowCollapsedPanel()\n\t{\n\t\tthis.getPanelNode().classList.add(`${this.class.panelCollapsed}`);\n\t\tthis.animateCollapsedPanel();\n\t}\n\n\thideCollapsedPanel()\n\t{\n\t\tthis.getPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t\tthis.showPinnedItems();\n\t\tthis.removeCollapsedPanel();\n\t}\n\n\tremoveCollapsedPanel()\n\t{\n\t\tconst collapsedPanel = this.getCollapsedPanelNode();\n\n\t\tUtils.setStyle(collapsedPanel, {\n\t\t\tposition: 'absolute',\n\t\t\ttop: 0,\n\t\t\twidth: '100%'\n\t\t});\n\n\t\tcollapsedPanel.classList.remove(`${this.class.collapsedPanelShow}`);\n\t\tcollapsedPanel.classList.add(`${this.class.collapsedPanelHide}`);\n\t}\n\n\tgetCommentsNodes(xmlId)\n\t{\n\t\tconst result = {\n\t\t\tfollow: true,\n\t\t\tnewNode: null,\n\t\t\tnewValueNode: null,\n\t\t\toldNode: null,\n\t\t\tallNode: null\n\t\t};\n\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst commentsNode = document.querySelector(`.${this.class.postComments}[data-bx-comments-entity-xml-id=\"${xmlId}\"]`);\n\t\tif (!commentsNode)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst postNode = commentsNode.closest(`.${this.class.postPinActive}`);\n\t\tif (!postNode)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst newPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueNew}`);\n\t\tconst newValuePinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueNewValue}`);\n\t\tconst oldPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueOld}`);\n\t\tconst allPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueAll}`);\n\n\t\tif (\n\t\t\t!newPinnedCommentsNode\n\t\t\t|| !newValuePinnedCommentsNode\n\t\t\t|| !oldPinnedCommentsNode\n\t\t\t|| !allPinnedCommentsNode\n\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tresult.newNode = newPinnedCommentsNode;\n\t\tresult.newValueNode = newValuePinnedCommentsNode;\n\t\tresult.oldNode = oldPinnedCommentsNode;\n\t\tresult.allNode = allPinnedCommentsNode;\n\t\tresult.follow = (commentsNode.getAttribute('data-bx-follow') !== 'N');\n\n\t\treturn result;\n\t}\n\n\tgetCommentsData(xmlId)\n\t{\n\t\tconst result = {\n\t\t\tnewValue: null,\n\t\t\toldValue: null,\n\t\t\tallValue: null\n\t\t};\n\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst { newValueNode, oldNode, allNode, follow } = this.getCommentsNodes(xmlId);\n\n\t\tresult.follow = follow;\n\n\t\tif (\n\t\t\t!Type.isDomNode(newValueNode)\n\t\t\t|| !Type.isDomNode(oldNode)\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tlet newCommentsValue = 0;\n\t\tlet oldCommentsValue = 0;\n\t\tlet allCommentsValue = 0;\n\n\t\tlet matches = newValueNode.innerHTML.match(/(\\d+)/);\n\n\t\tif (matches)\n\t\t{\n\t\t\tnewCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tmatches = oldNode.innerHTML.match(/(\\d+)/);\n\t\tif (matches)\n\t\t{\n\t\t\toldCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tmatches = allNode.innerHTML.match(/(\\d+)/);\n\t\tif (matches)\n\t\t{\n\t\t\tallCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tresult.oldValue = oldCommentsValue;\n\t\tresult.newValue = newCommentsValue;\n\t\tresult.allValue = allCommentsValue;\n\n\t\treturn result;\n\t}\n\n\tsetCommentsData(xmlId, value)\n\t{\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { newNode, newValueNode, oldNode, allNode } = this.getCommentsNodes(xmlId);\n\t\tif (\n\t\t\t!Type.isDomNode(newNode)\n\t\t\t|| !Type.isDomNode(newValueNode)\n\t\t\t|| !Type.isDomNode(oldNode)\n\t\t\t|| !Type.isDomNode(allNode)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isInteger(value.newValue))\n\t\t{\n\t\t\tnewValueNode.innerHTML = `${value.newValue}`;\n\t\t\tif (\n\t\t\t\tvalue.newValue > 0\n\t\t\t\t&& !newNode.classList.contains(`${this.class.collapsedPanelCounterCommentsValueNewActive}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tnewNode.classList.add(`${this.class.collapsedPanelCounterCommentsValueNewActive}`);\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tvalue.newValue <= 0\n\t\t\t\t&& newNode.classList.contains(`${this.class.collapsedPanelCounterCommentsValueNewActive}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tnewNode.classList.remove(`${this.class.collapsedPanelCounterCommentsValueNewActive}`);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isInteger(value.oldValue))\n\t\t{\n\t\t\toldNode.innerHTML = value.oldValue;\n\t\t}\n\n\t\tif (Type.isInteger(value.allValue))\n\t\t{\n\t\t\tallNode.innerHTML = value.allValue;\n\t\t}\n\n\t\tthis.adjustCollapsedPostsPanel();\n\t}\n\n\tgetCollapsedPanelNode()\n\t{\n\t\treturn this.getPanelNode().querySelector(`.${this.class.collapsedPanel}`);\n\t}\n\n\tcheckTransitionProperty(event, propertyName)\n\t{\n\t\treturn (event.propertyName === propertyName);\n\t}\n}\n\nexport {\n\tPinnedPanel\n};\n","import {Popup} from 'main.popup';\nimport {Dom, Loc, Tag} from \"main.core\";\nimport {Button} from \"ui.buttons\";\n\nclass Post\n{\n\tconstructor()\n\t{\n\t}\n\n\tshowBackgroundWarning({\n\t\turlToEdit,\n\t\tmenuPopupWindow\n\t})\n\t{\n\t\tconst content = Tag.render`<div>${Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_DESCRIPTION')}</div>`;\n\n\t\tconst dialog = new Popup('create id here', null, {\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tdraggable: true,\n\t\t\tbindOnResize: false,\n\t\t\ttitleBar: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_TITLE'),\n\t\t\tcloseIcon: true,\n\t\t\tclassName: 'sonet-livefeed-popup-warning',\n\t\t\tcontent: content,\n\t\t\tevents: {},\n\t\t\tcacheable: false,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_BUTTON_SUBMIT'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-primary',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\twindow.location = urlToEdit;\n\t\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\t\tif (menuPopupWindow)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmenuPopupWindow.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_BUTTON_CANCEL'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-light',\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\tif (menuPopupWindow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuPopupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tdialog.show();\n\n\t\treturn false;\n\t}\n}\n\nexport {\n\tPost\n};","import { Loc, Type, Runtime } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nclass Informer\n{\n\tconstructor()\n\t{\n\t\tthis.container = null;\n\t\tthis.wrap = null;\n\t\tthis.plus = null;\n\t\tthis.value = null;\n\n\t\tthis.currentSiteId = null;\n\t\tthis.currentCounterType = null;\n\n\t\tthis.counterDecrementStack = 0;\n\t\tthis.counterValue = 0;\n\n\t\tthis.lockCounterAnimation = null;\n\n\t\tthis.class = {\n\t\t\tinformerFixed: 'feed-new-message-informer-fixed',\n\t\t\tinformerAnimation: 'feed-new-message-informer-anim',\n\t\t\tinformerFixedAnimation: 'feed-new-message-informer-fix-anim',\n\t\t\tcounterText: 'feed-new-message-inf-text',\n\t\t\tcounterContainer: 'feed-new-message-inf-text-counter',\n\t\t\treloadContainer: 'feed-new-message-inf-text-reload',\n\t\t\ticon: 'feed-new-message-icon',\n\t\t\ticonRotating: 'new-message-balloon-icon-rotating',\n\t\t\tplusHidden: 'feed-new-message-informer-counter-plus-hidden',\n\t\t};\n\t}\n\n\tinit()\n\t{\n\t\tthis.initNodes();\n\t\tthis.initEvents();\n\t}\n\n\tinitNodes()\n\t{\n\t\tthis.currentCounterType = Loc.getMessage('sonetLCounterType') ? Loc.getMessage('sonetLCounterType') : '**';\n\t\tthis.currentSiteId = Loc.getMessage('SITE_ID');\n\n\t\tthis.container = document.getElementById('sonet_log_counter_2_container');\n\t\tif (this.container)\n\t\t{\n\t\t\tthis.container.addEventListener('click', this.showReloadAnimation.bind(this));\n\t\t}\n\n\t\tthis.wrap = document.getElementById('sonet_log_counter_2_wrap');\n\t\tthis.plus = document.getElementById('sonet_log_counter_2_plus');\n\t\tthis.value = document.getElementById('sonet_log_counter_2');\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('onGoUp', (event: BaseEvent) =>\n\t\t{\n\t\t\tthis.unfixWrap();\n\t\t});\n\n\t\tEventEmitter.subscribe('onPullEvent-main', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ command, params ] = event.getData();\n\n\t\t\tif (\n\t\t\t\tcommand !== 'user_counter'\n\t\t\t\t|| !params[this.currentSiteId]\n\t\t\t\t|| !params[this.currentSiteId][this.currentCounterType]\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeCounter(Runtime.clone(params[this.currentSiteId][this.currentCounterType]));\n\t\t});\n\n\t\tEventEmitter.subscribe('onImUpdateCounter', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ arCount ] = event.getData();\n\n\t\t\tif (\n\t\t\t\t!Type.isObjectLike(arCount)\n\t\t\t\t|| Type.isUndefined(arCount[this.currentCounterType])\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeCounter(arCount[this.currentCounterType]);\n\t\t});\n\n\t\tEventEmitter.subscribe('OnUCCommentWasRead', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, options ] = event.getData();\n\n\t\t\tif (\n\t\t\t\t!Type.isObjectLike(options)\n\t\t\t\t|| !options.live\n\t\t\t\t|| !options.new\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit('onCounterDecrement', new BaseEvent({\n\t\t\t\tcompatData: [1],\n\t\t\t}));\n\n\t\t\tthis.decrementCounter(1);\n\t\t});\n\t};\n\n\tchangeCounter(count)\n\t{\n\t\tthis.counterValue = parseInt(count);\n\n\t\tif (this.counterValue <= 0)\n\t\t{\n\t\t\tthis.decrementStack = 0;\n\t\t}\n\n\t\tconst valueToShow = this.counterValue - this.counterDecrementStack;\n\n\t\tthis.changeAnimate({\n\t\t\tshow: (valueToShow > 0),\n\t\t\tcounter: valueToShow,\n\t\t\tzeroCounterFromDb: (valueToShow <= 0),\n\t\t});\n\t};\n\n\tchangeAnimate(params)\n\t{\n\t\tconst show = (!!params.show);\n\t\tconst counterValue = parseInt(params.counter);\n\t\tconst zeroCounterFromDb = !!params.zeroCounterFromDb;\n\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterTextNode = this.container.querySelector(`span.${this.class.counterText}`);\n\t\tconst reloadNode = this.container.querySelector(`span.${this.class.reloadContainer}`);\n\n\t\tif (this.lockCounterAnimation)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.changeAnimate({\n\t\t\t\t\tshow: show,\n\t\t\t\t\tcounter: counterValue,\n\t\t\t\t})\n\t\t\t}, 200);\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (show)\n\t\t{\n\t\t\tif (this.value)\n\t\t\t{\n\t\t\t\tthis.value.innerHTML = counterValue;\n\t\t\t}\n\n\t\t\tthis.showWrapAnimation();\n\n\t\t\tif (\n\t\t\t\tthis.plus\n\t\t\t\t&& reloadNode\n\t\t\t\t&& reloadNode.style.display !== 'none'\n\t\t\t\t&& counterTextNode\n\t\t\t)\n\t\t\t{\n\t\t\t\treloadNode.style.display = 'none';\n\t\t\t\tcounterTextNode.style.display = 'inline-block';\n\t\t\t\tthis.plus.classList.remove(`${this.class.plusHidden}`);\n\t\t\t}\n\t\t}\n\t\telse if (this.wrap)\n\t\t{\n\t\t\tif (\n\t\t\t\tzeroCounterFromDb\n\t\t\t\t&& this.wrap.classList.contains(`${this.class.informerAnimation}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tcounterTextNode\n\t\t\t\t\t&& reloadNode\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tcounterTextNode.style.display = 'none';\n\t\t\t\t\treloadNode.style.display = 'inline-block';\n\n\t\t\t\t\tthis.hideReloadAnimation();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.hideWrapAnimation();\n\t\t\t\t}, 400);\n\t\t\t}\n\t\t}\n\t};\n\n\tshowWrapAnimation()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.style.visibility = 'visible';\n\t\tthis.wrap.classList.add(`${this.class.informerAnimation}`);\n\t};\n\n\thideWrapAnimation()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.remove(`${this.class.informerAnimation}`);\n\t\tthis.wrap.style.visibility = 'hidden';\n\t}\n\n\tshowReloadAnimation()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterWaiterNode = this.container.querySelector(`span.${this.class.icon}`);\n\t\tif (counterWaiterNode)\n\t\t{\n\t\t\tcounterWaiterNode.classList.add(this.class.iconRotating);\n\t\t}\n\t}\n\n\thideReloadAnimation()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterNodeWaiter = this.container.querySelector(`span.${this.class.icon}`);\n\t\tif (counterNodeWaiter)\n\t\t{\n\t\t\tcounterNodeWaiter.classList.remove(this.class.iconRotating);\n\t\t}\n\t}\n\n\tonFeedScroll()\n\t{\n\t\tif (\n\t\t\t!this.container\n\t\t\t|| !this.wrap\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst top = this.wrap.parentNode.getBoundingClientRect().top;\n\t\tconst counterRect = this.container.getBoundingClientRect();\n\n\t\tif (top <= 0)\n\t\t{\n\n\t\t\tif (!this.wrap.classList.contains(`${this.class.informerFixed}`))\n\t\t\t{\n\t\t\t\tthis.container.style.left = `${(counterRect.left + (counterRect.width / 2))}px`;\n\t\t\t}\n\n\t\t\tthis.fixWrap();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.unfixWrap();\n\t\t\tthis.container.style.left = 'auto';\n\t\t}\n\t};\n\n\tfixWrap()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.add(`${this.class.informerFixed}`, `${this.class.informerFixedAnimation}`);\n\t}\n\n\tunfixWrap()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.remove(`${this.class.informerFixed}`, `${this.class.informerFixedAnimation}`);\n\t};\n\n\trecover()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterContainerNode = this.container.querySelector(`span.${this.class.counterContainer}`);\n\n\t\tif (!counterContainerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcounterContainerNode.style.display = 'inline-block';\n\t\tthis.hideReloadNode();\n\n\t\tif (this.plus)\n\t\t{\n\t\t\tthis.plus.classList.add(`${this.class.plusHidden}`);\n\t\t}\n\t};\n\n\thideReloadNode()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst reloadContainerNode = this.container.querySelector(`span.${this.class.reloadContainer}`);\n\n\t\tif (!reloadContainerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treloadContainerNode.style.display = 'none';\n\t};\n\n\tdecrementCounter(value)\n\t{\n\t\tthis.counterDecrementStack += parseInt(value);\n\n\t\tif (!this.value)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterValue = this.counterValue - this.counterDecrementStack;\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tthis.value.innerHTML = counterValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.changeAnimate({\n\t\t\t\tshow: false,\n\t\t\t\tcounter: 0,\n\t\t\t});\n\t\t}\n\t};\n\n}\n\nexport {\n\tInformer\n};","import {Type, Loc, ajax, Event} from \"main.core\";\nimport {PinnedPanel} from \"./pinned\";\nimport {Post} from \"./post\";\nimport {Informer} from \"./informer\";\n\nimport './css/feed.css';\nimport './css/gratitude.css';\nimport './css/important.css';\nimport './css/warning.css';\n\nclass Feed\n{\n\tconstructor()\n\t{\n\t\tthis.entryData = {};\n\t\tthis.feedInitialized = false;\n\t}\n\n\tinit()\n\t{\n\t\tif (this.feedInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tPinnedPanelInstance.init();\n\t\tInformerInstance.init();\n\n\t\tthis.feedInitialized = true;\n\t}\n\n\tchangeFollow(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (!logId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst followNode = document.getElementById('log_entry_follow_' + logId);\n\t\tconst valueOld = (followNode && followNode.getAttribute('data-follow') === 'Y' ? 'Y' : 'N');\n\t\tconst valueNew = (valueOld === 'Y' ? 'N' : 'Y');\n\n\t\tthis.renderFollow({\n\t\t\tlogId: logId,\n\t\t\tvalue: valueNew\n\t\t});\n\n\t\tajax.runAction('socialnetwork.api.livefeed.changeFollow', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: valueNew\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: (valueNew === 'Y' ? 'setFollow' : 'setUnfollow')\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tif (!response.data.success)\n\t\t\t{\n\t\t\t\tthis.renderFollow({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tvalue: valueOld\n\t\t\t\t});\n\t\t\t}\n\t\t}, () => {\n\t\t\tthis.renderFollow({\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: valueOld\n\t\t\t});\n\t\t});\n\n\t\treturn false;\n\t}\n\n\trenderFollow(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (!logId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst followNode = document.getElementById('log_entry_follow_' + logId);\n\t\tconst value = (params.value && params.value === 'Y' ? 'Y' : 'N');\n\n\t\tif (followNode)\n\t\t{\n\t\t\tfollowNode.setAttribute('data-follow', value);\n\t\t}\n\n\t\tconst textNode = (followNode ? followNode.querySelector('a') : null);\n\t\tif (textNode)\n\t\t{\n\t\t\ttextNode.innerHTML = Loc.getMessage('SONET_EXT_LIVEFEED_FOLLOW_TITLE_' + value);\n\t\t}\n\n\t\tconst postNode = (followNode ? followNode.closest('.feed-post-block') : null);\n\t\tif (postNode)\n\t\t{\n\t\t\tif (value === 'N')\n\t\t\t{\n\t\t\t\tpostNode.classList.add('feed-post-block-unfollowed');\n\t\t\t}\n\t\t\telse if (value === 'Y')\n\t\t\t{\n\t\t\t\tpostNode.classList.remove('feed-post-block-unfollowed');\n\t\t\t}\n\t\t}\n\t}\n\n\tchangeFavorites(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst event = (params.event ? params.event : null);\n\n\t\tlet node = (params.node ? params.node : null);\n\t\tlet newState = (params.newState ? params.newState : null);\n\n\t\tif (Type.isStringFilled(node))\n\t\t{\n\t\t\tnode = document.getElementById(node);\n\t\t}\n\n\t\tif (!logId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menuItem = null;\n\n\t\tif (event)\n\t\t{\n\t\t\tmenuItem = event.target;\n\t\t\tif (!menuItem.classList.contains('menu-popup-item-text'))\n\t\t\t{\n\t\t\t\tmenuItem = menuItem.querySelector('.menu-popup-item-text');\n\t\t\t}\n\t\t}\n\n\t\tlet nodeToAdjust = null;\n\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tnodeToAdjust = (\n\t\t\t\tnode.classList.contains('feed-post-important-switch')\n\t\t\t\t\t? node\n\t\t\t\t\t: node.querySelector('.feed-post-important-switch')\n\t\t\t);\n\t\t}\n\n\t\tif (typeof this.entryData[logId] == 'undefined')\n\t\t{\n\t\t\tthis.entryData[logId] = {};\n\t\t}\n\n\t\tif (typeof this.entryData[logId].favorites != 'undefined')\n\t\t{\n\t\t\tnewState = (this.entryData[logId].favorites ? 'N' : 'Y');\n\t\t\tthis.entryData[logId].favorites = !this.entryData[logId].favorites;\n\t\t}\n\t\telse if (nodeToAdjust)\n\t\t{\n\t\t\tnewState = (\n\t\t\t\tnodeToAdjust.classList.contains('feed-post-important-switch-active')\n\t\t\t\t\t? 'N'\n\t\t\t\t\t: 'Y'\n\t\t\t);\n\t\t\tthis.entryData[logId].favorites = (newState == 'Y');\n\t\t}\n\n\t\tif (!newState)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.adjustFavoritesControlItem(nodeToAdjust, newState);\n\t\tthis.adjustFavoritesMenuItem(menuItem, newState);\n\n\t\tajax.runAction('socialnetwork.api.livefeed.changeFavorites', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: newState\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: (newState == 'Y' ? 'addFavorites' : 'removeFavorites')\n\t\t\t}\n\t\t}).then(response =>\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isStringFilled(response.data.newValue)\n\t\t\t\t&& ['Y', 'N'].includes(response.data.newValue)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.entryData[logId].favorites = (response.data.newValue == 'Y');\n\t\t\t}\n\n\t\t\tthis.adjustFavoritesControlItem(nodeToAdjust, response.data.newValue);\n\t\t\tthis.adjustFavoritesMenuItem(menuItem, response.data.newValue);\n\n\t\t}, response => {\n\t\t\tthis.entryData[logId].favorites = !this.entryData[logId].favorites;\n\t\t});\n\t}\n\n\tadjustFavoritesMenuItem(menuItemNode, state)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(menuItemNode)\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tmenuItemNode.innerHTML = this.getMenuTitle(state === 'Y');\n\t}\n\n\tadjustFavoritesControlItem(node, state)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(node)\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnode.title = this.getMenuTitle(state === 'Y');\n\t\tif (state == 'Y')\n\t\t{\n\t\t\tnode.classList.add('feed-post-important-switch-active');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.classList.remove('feed-post-important-switch-active');\n\t\t}\n\t}\n\n\tgetMenuTitle(state: boolean): string\n\t{\n\t\treturn Loc.getMessage(`SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_${state ? 'Y' : 'N'}`);\n\t}\n}\n\nlet FeedInstance = null;\nlet PinnedPanelInstance = null;\nlet PostInstance = null;\nlet InformerInstance = null;\n\nEvent.ready(() =>\n{\n\tFeedInstance = new Feed();\n\tPinnedPanelInstance = new PinnedPanel();\n\tPostInstance = new Post();\n\tInformerInstance = new Informer();\n});\n\nexport {\n\tFeedInstance,\n\tPinnedPanelInstance,\n\tPostInstance,\n\tInformerInstance,\n};"],"names":["Utils","node","styles","Object","entries","forEach","key","value","style","PinnedPanel","class","pin","post","postHide","postComments","postPinned","postPinnedHide","postPinActive","postUnfollowed","postExpanding","panelCollapsed","panelNonEmpty","panelPosts","collapsedPanel","collapsedPanelExpand","collapsedPanelCounterPostsValue","collapsedPanelCounterComments","collapsedPanelCounterCommentsValue","collapsedPanelCounterCommentsShown","collapsedPanelCounterCommentsValueNew","collapsedPanelCounterCommentsValueNewValue","collapsedPanelCounterCommentsValueNewActive","collapsedPanelCounterCommentsValueOld","collapsedPanelCounterCommentsValueAll","collapsedPanelShow","collapsedPanelHide","cancelPanel","cancelPanelButton","cancelPanelLabel","panelInitialized","postsInitialized","handlePostClick","bind","options","initPosts","initPanel","initEvents","optionName","pinnedPanelNode","getPanelNode","adjustCollapsedPostsPanel","Event","getCollapsedPanelNode","collapsedHeight","offsetHeight","setStyle","height","transition","setTimeout","hideCollapsedPanel","event","likeClicked","target","classList","contains","closest","followClicked","menuClicked","contentViewClicked","pinClicked","collapseClicked","commentsClicked","postNode","remove","menuId","getAttribute","MenuManager","destroy","BaseEvent","compatData","rootNode","data","EventEmitter","emit","anchorNode","querySelector","position","Dom","getPosition","window","scrollTo","top","stopPropagation","preventDefault","add","postList","document","querySelectorAll","length","Array","from","unbind","newState","logId","parseInt","changePinned","then","subscribe","getData","xmlId","id","getCommentsData","oldValue","newValue","new","setCommentsData","Type","isInteger","incrementMaxListeners","params","commentId","allValue","follow","commentsData","AUTHOR","ID","BX","message","panelNode","Promise","resolve","reject","getOption","setPostState","state","ajax","runAction","analyticsLabel","b24statAction","response","success","movePost","includes","setAttribute","Loc","getMessage","postToMove","parentNode","originalPostHeight","getPinnedData","pinnedPanelTitleNode","pinnedPanelDescriptionNode","pinnedPanelPinNode","innerHTML","TITLE","DESCRIPTION","title","cancelPinnedPanel","getCancelPinnedPanel","anchor","nextSibling","insertBefore","centerCancelPinnedPanelElements","cancelPanelHeight","width","backgroundColor","opacity","setOptions","panelHeight","pinBlocked","unbindAll","checkTransitionProperty","panelPostsNode","firstChild","adjustPanel","showCollapsedPostsPanel","pinnedHeight","scrollHeight","isDomNode","requestAnimationFrame","collapsed","showCollapsed","hideCollapsedPostsPanel","transform","display","animateCancel","marginBottom","Tag","render","marginLeft","getBoundingClientRect","getElementsByClassName","reduce","count","item","map","currentIndex","originalItemsList","postsCounter","getPostsCount","postsCounterNode","commentsCounterNode","commentsCounterValueNode","newCommentCounter","acc","showCollapsedPanel","hidePinnedItems","removeCollapsedPanel","showPinnedItems","animateCollapsedPanel","result","newNode","newValueNode","oldNode","allNode","isStringFilled","commentsNode","newPinnedCommentsNode","newValuePinnedCommentsNode","oldPinnedCommentsNode","allPinnedCommentsNode","getCommentsNodes","newCommentsValue","oldCommentsValue","allCommentsValue","matches","match","propertyName","Post","urlToEdit","menuPopupWindow","content","dialog","Popup","autoHide","closeByEsc","offsetLeft","offsetTop","draggable","bindOnResize","titleBar","closeIcon","className","events","cacheable","buttons","Button","text","click","location","close","show","Informer","container","wrap","plus","currentSiteId","currentCounterType","counterDecrementStack","counterValue","lockCounterAnimation","informerFixed","informerAnimation","informerFixedAnimation","counterText","counterContainer","reloadContainer","icon","iconRotating","plusHidden","initNodes","getElementById","addEventListener","showReloadAnimation","unfixWrap","command","changeCounter","Runtime","clone","arCount","isObjectLike","isUndefined","live","decrementCounter","decrementStack","valueToShow","changeAnimate","counter","zeroCounterFromDb","counterTextNode","reloadNode","showWrapAnimation","hideReloadAnimation","hideWrapAnimation","visibility","counterWaiterNode","counterNodeWaiter","counterRect","left","fixWrap","counterContainerNode","hideReloadNode","reloadContainerNode","Feed","entryData","feedInitialized","PinnedPanelInstance","init","InformerInstance","followNode","valueOld","valueNew","renderFollow","textNode","menuItem","nodeToAdjust","favorites","adjustFavoritesControlItem","adjustFavoritesMenuItem","menuItemNode","getMenuTitle","FeedInstance","PostInstance","ready"],"mappings":"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"}