{"version":3,"file":"livefeed.bundle.js","sources":["../src/utils.js","../src/pinned.js","../src/taskcreator.js","../src/post.js","../src/informer.js","../src/loader.js","../src/morebutton.js","../src/forum.js","../src/filter.js","../src/contentview.js","../src/page.js","../src/commentform.js","../src/feed.js"],"sourcesContent":["class Utils\n{\n\tstatic setStyle(node, styles)\n\t{\n\t\tObject.entries(styles).forEach(([key, value]) => {\n\t\t\tnode.style[key] = value;\n\t\t});\n\t}\n}\n\nexport {\n\tUtils\n};\n","import { ajax, Event, Type, Loc, Dom, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\nimport { Utils } from \"./utils\";\n\nclass PinnedPanel\n{\n\tconstructor()\n\t{\n\t\tthis.class = {\n\t\t\tpin: 'feed-post-pin',\n\n\t\t\tpost: 'feed-item-wrap',\n\t\t\tpostHide: 'feed-item-wrap-hide',\n\t\t\tpostComments: 'feed-comments-block',\n\n\t\t\tpostPinned: 'feed-post-block-pinned',\n\t\t\tpostPinnedHide: 'feed-post-block-pinned-hide',\n\t\t\tpostPinActive: 'feed-post-block-pin-active',\n\t\t\tpostUnfollowed: 'feed-post-block-unfollowed',\n\n\t\t\tpostExpanding: 'feed-post-block-expand',\n\n\t\t\tpanelCollapsed: 'feed-pinned-panel-collapsed',\n\t\t\tpanelNonEmpty: 'feed-pinned-panel-nonempty',\n\t\t\tpanelPosts: 'feed-pinned-panel-posts',\n\n\t\t\tcollapsedPanel: 'feed-post-collapsed-panel',\n\t\t\tcollapsedPanelExpand: 'feed-post-collapsed-panel-right',\n\t\t\tcollapsedPanelCounterPostsValue: 'feed-post-collapsed-panel-count-posts',\n\t\t\tcollapsedPanelCounterComments: 'feed-post-collapsed-panel-box-comments',\n\t\t\tcollapsedPanelCounterCommentsValue: 'feed-post-collapsed-panel-count-comments-value',\n\t\t\tcollapsedPanelCounterCommentsShown: 'feed-post-collapsed-panel-box-shown',\n\t\t\tcollapsedPanelCounterCommentsValueNew: 'feed-inform-comments-pinned-new',\n\t\t\tcollapsedPanelCounterCommentsValueNewValue: 'feed-inform-comments-pinned-new-value',\n\t\t\tcollapsedPanelCounterCommentsValueNewActive: 'feed-inform-comments-pinned-new-active',\n\t\t\tcollapsedPanelCounterCommentsValueOld: 'feed-inform-comments-pinned-old',\n\t\t\tcollapsedPanelCounterCommentsValueAll: 'feed-inform-comments-pinned-all',\n\t\t\tcollapsedPanelShow: 'feed-post-collapsed-panel--show',\n\t\t\tcollapsedPanelHide: 'feed-post-collapsed-panel--hide',\n\n\t\t\tcancelPanel: 'feed-post-cancel-pinned-panel',\n\t\t\tcancelPanelButton: 'feed-post-cancel-pinned-btn',\n\t\t\tcancelPanelLabel: 'feed-post-cancel-pinned-label'\n\t\t};\n\n\t\tthis.panelInitialized = false;\n\t\tthis.postsInitialized = false;\n\t\tthis.handlePostClick = this.handlePostClick.bind(this);\n\t\tthis.options = {};\n\n\t\tEvent.ready(() => {\n\t\t\t/* for detail page without pinned panel */\n\t\t\tthis.initPosts();\n\t\t});\n\t}\n\n\tresetFlags()\n\t{\n\t\tthis.panelInitialized = false;\n\t\tthis.postsInitialized = false;\n\t}\n\n\tinit()\n\t{\n\t\t/* for list page in composite mode */\n\t\tthis.initPanel();\n\n\t\tthis.initPosts();\n\t\tthis.initEvents();\n\t}\n\n\tsetOptions(options)\n\t{\n\t\tthis.options = { ...this.options, ...options };\n\t}\n\n\tgetOption(optionName)\n\t{\n\t\treturn this.options[optionName];\n\t}\n\n\tinitPanel()\n\t{\n\t\tif (this.panelInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.panelInitialized = true;\n\n\t\tthis.adjustCollapsedPostsPanel();\n\n\t\tEvent.bind(this.getCollapsedPanelNode(), 'click', () => {\n\t\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\t\tif (!pinnedPanelNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst collapsedHeight = pinnedPanelNode.offsetHeight;\n\n\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\theight: collapsedHeight + 'px',\n\t\t\t\ttransition: 'height .5s'\n\t\t\t});\n\t\t\tsetTimeout(() => {\n\t\t\t\tpinnedPanelNode.style = '';\n\t\t\t}, 550);\n\t\t\tthis.hideCollapsedPanel();\n\t\t});\n\n\t\tEvent.bind(pinnedPanelNode, 'click', (event) => {\n\t\t\tconst likeClicked = event.target.classList.contains('feed-inform-ilike') || event.target.closest('.feed-inform-ilike') !== null;\n\t\t\tconst followClicked = event.target.classList.contains('feed-inform-follow') || event.target.closest('.feed-inform-follow') !== null;\n\t\t\tconst menuClicked = (\n\t\t\t\tevent.target.classList.contains('feed-post-more-link')\n\t\t\t\t|| event.target.closest('.feed-post-more-link') !== null\n\t\t\t\t|| event.target.classList.contains('feed-post-right-top-menu')\n\t\t\t);\n\t\t\tconst contentViewClicked = event.target.classList.contains('feed-inform-contentview') || event.target.closest('.feed-inform-contentview') !== null;\n\t\t\tconst pinClicked = event.target.classList.contains(`${this.class.pin}`) || event.target.closest(`.${this.class.pin}`) !== null;\n\t\t\tconst collapseClicked = event.target.classList.contains('feed-post-pinned-link-collapse');\n\t\t\tconst commentsClicked = event.target.classList.contains('feed-inform-comments-pinned') || event.target.closest('.feed-inform-comments-pinned') !== null;\n\n\t\t\tlet postNode = null;\n\n\t\t\tif (event.target.classList.contains('feed-post-block'))\n\t\t\t{\n\t\t\t\tpostNode = event.target;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpostNode = event.target.closest('.feed-post-block');\n\t\t\t}\n\n\t\t\tif (!postNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (postNode.classList.contains(`${this.class.postPinned}`))\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\t!likeClicked\n\t\t\t\t\t&& !followClicked\n\t\t\t\t\t&& !menuClicked\n\t\t\t\t\t&& !contentViewClicked\n\t\t\t\t\t&& !pinClicked\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tpostNode.classList.remove(`${this.class.postPinned}`);\n\n\t\t\t\t\tconst menuId = postNode.getAttribute('data-menu-id');\n\n\t\t\t\t\tif (menuId)\n\t\t\t\t\t{\n\t\t\t\t\t\tMenuManager.destroy(menuId);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst event = new BaseEvent({\n\t\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\t\trootNode: postNode\n\t\t\t\t\t\t}],\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\trootNode: postNode\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tEventEmitter.emit('BX.Livefeed:recalculateComments', event);\n\t\t\t\t}\n\n\t\t\t\tif (commentsClicked)\n\t\t\t\t{\n\t\t\t\t\tconst anchorNode = postNode.querySelector(`.${this.class.postComments} a[name=comments]`);\n\n\t\t\t\t\tif (anchorNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst position = Dom.getPosition(anchorNode);\n\t\t\t\t\t\twindow.scrollTo(0, position.top - 200);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (collapseClicked)\n\t\t\t{\n\t\t\t\tpostNode.classList.add(`${this.class.postPinned}`);\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t});\n\t}\n\n\tinitPosts()\n\t{\n\t\tif (this.postsInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst postList = document.querySelectorAll('[data-livefeed-post-pinned]');\n\t\tif (postList.length > 0)\n\t\t{\n\t\t\tthis.postsInitialized = true;\n\t\t}\n\n\t\tArray.from(postList).forEach((post) => {\n\t\t\tEvent.unbind(post, 'click', this.handlePostClick);\n\t\t\tEvent.bind(post, 'click', this.handlePostClick);\n\t\t});\n\t}\n\n\thandlePostClick(event)\n\t{\n\t\tif (!event.target.classList.contains(`${this.class.pin}`))\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst post = event.target.closest('[data-livefeed-id]');\n\n\t\tif (!post)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newState = (post.getAttribute('data-livefeed-post-pinned') === 'Y' ? 'N' : 'Y');\n\t\tconst logId = parseInt(post.getAttribute('data-livefeed-id'));\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.changePinned({\n\t\t\tlogId: logId,\n\t\t\tnewState: newState,\n\t\t\tevent: event\n\t\t\t\t}).then(() => {\n\t\t});\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('OnUCCommentWasRead', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, options ] = event.getData();\n\t\t\tconst { oldValue, newValue } = this.getCommentsData(xmlId);\n\n\t\t\tif (!!options.new)\n\t\t\t{\n\t\t\t\tthis.setCommentsData(xmlId, {\n\t\t\t\t\tnewValue: (Type.isInteger(newValue) ? (newValue - 1) : 0),\n\t\t\t\t\toldValue: (Type.isInteger(oldValue) ? (oldValue + 1) : 1)\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.incrementMaxListeners('OnUCCommentWasPulled');\n\t\tEventEmitter.subscribe('OnUCCommentWasPulled', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ id, data, params ] = event.getData();\n\t\t\tconst [ xmlId, commentId ] = id;\n\t\t\tconst { newValue, oldValue, allValue, follow } = this.getCommentsData(xmlId);\n\n\t\t\tconst commentsData = {\n\t\t\t\tallValue: (Type.isInteger(allValue) ? (allValue + 1) : 1)\n\t\t\t};\n\n\t\t\tif (parseInt(params.AUTHOR.ID) !== parseInt(BX.message('USER_ID')))\n\t\t\t{\n\t\t\t\tcommentsData.newValue = (Type.isInteger(newValue) ? (newValue + 1) : 1);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommentsData.oldValue = (Type.isInteger(oldValue) ? (oldValue + 1) : 1);\n\t\t\t}\n\n\t\t\tthis.setCommentsData(xmlId, commentsData);\n\t\t});\n\n\t\tEventEmitter.subscribe('OnUCommentWasDeleted', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, data ] = event.getData();\n\t\t\tconst { oldValue, allValue } = this.getCommentsData(xmlId);\n\n\t\t\tthis.setCommentsData(xmlId, {\n\t\t\t\tallValue: (Type.isInteger(allValue) ? (allValue - 1) : 0),\n\t\t\t\toldValue: (Type.isInteger(oldValue) ? (oldValue - 1) : 0)\n\t\t\t});\n\t\t});\n\t}\n\n\tchangePinned(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst event = (params.event ? params.event : null);\n\n\t\tlet node = (params.node ? params.node : null);\n\t\tlet newState = (params.newState ? params.newState : null);\n\n\t\tconst panelNode = this.getPanelNode();\n\n\t\tif (\n\t\t\t!node\n\t\t\t&& !event\n\t\t\t&& logId > 0\n\t\t\t&& panelNode\n\t\t)\n\t\t{\n\t\t\tnode = panelNode.querySelector(`.${this.class.post} > [data-livefeed-id=\"${logId}\"]`);\n\t\t}\n\n\t\tif (\n\t\t\t!node\n\t\t\t&& event\n\t\t)\n\t\t{\n\t\t\tnode = event.target;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (\n\t\t\t\t!!this.getOption('pinBlocked') ||\n\t\t\t\t!node\n\t\t\t\t|| !newState\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tthis.setPostState({\n\t\t\t\tnode: node,\n\t\t\t\tstate: newState\n\t\t\t});\n\n\t\t\tajax.runAction('socialnetwork.api.livefeed.logentry.' + (newState === 'Y' ? 'pin' : 'unpin'), {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: logId\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tb24statAction: (newState === 'Y' ? 'pinLivefeedEntry' : 'unpinLivefeedEntry')\n\t\t\t\t}\n\t\t\t}).then(response => {\n\t\t\t\tif (!response.data.success)\n\t\t\t\t{\n\t\t\t\t\tthis.setPostState({\n\t\t\t\t\t\tnode: node,\n\t\t\t\t\t\tstate: (newState === 'Y' ? 'N' : 'Y')\n\t\t\t\t\t});\n\t\t\t\t\treturn resolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.movePost({\n\t\t\t\t\t\tnode: node,\n\t\t\t\t\t\tstate: newState\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\treturn resolve();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, response => {\n\t\t\t\tthis.setPostState({\n\t\t\t\t\tnode: node,\n\t\t\t\t\tstate: (newState === 'Y' ? 'N' : 'Y')\n\t\t\t\t});\n\t\t\t\treturn resolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tsetPostState(params)\n\t{\n\t\tconst state = (params.state ? params.state : null);\n\t\tconst node = (params.node ? params.node : null);\n\n\t\tif (\n\t\t\t!node\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst post = node.closest('[data-livefeed-post-pinned]');\n\t\tif (!post)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpost.setAttribute('data-livefeed-post-pinned', state);\n\n\t\tif (state === 'Y')\n\t\t{\n\t\t\tpost.classList.add(`${this.class.postPinActive}`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpost.classList.remove(`${this.class.postPinActive}`);\n\t\t}\n\n\t\tconst pin = post.querySelector(`.${this.class.pin}`);\n\t\tif (pin)\n\t\t{\n\t\t\tpin.setAttribute('title', Loc.getMessage(`SONET_EXT_LIVEFEED_PIN_TITLE_${state}`));\n\t\t}\n\t}\n\n\tgetPanelNode()\n\t{\n\t\treturn document.querySelector('[data-livefeed-pinned-panel]');\n\t}\n\n\tgetPinnedData(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction('socialnetwork.api.livefeed.logentry.getPinData', {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: logId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).then(response => {\n\t\t\t\treturn resolve(response.data);\n\t\t\t}, response => {\n\t\t\t\treturn reject();\n\t\t\t});\n\t\t})\n\t}\n\n\tmovePost(params)\n\t{\n\t\tconst state = (params.state ? params.state : null);\n\t\tconst node = (params.node ? params.node : null);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (\n\t\t\t\t!node\n\t\t\t\t|| !['Y', 'N'].includes(state)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst post = node.closest('[data-livefeed-post-pinned]');\n\t\t\tif (!post)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst logId = parseInt(post.getAttribute('data-livefeed-id'));\n\t\t\tif (!logId)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\t\tif (!pinnedPanelNode)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst postToMove = (post.parentNode.classList.contains(`${this.class.post}`) ? post.parentNode : post);\n\n\t\t\tif (state === 'Y')\n\t\t\t{\n\t\t\t\tconst originalPostHeight = postToMove.offsetHeight;\n\t\t\t\tpostToMove.setAttribute('bx-data-height', originalPostHeight);\n\n\t\t\t\tthis.getPinnedData({\n\t\t\t\t\tlogId: logId\n\t\t\t\t}).then(data => {\n\t\t\t\t\tconst pinnedPanelTitleNode = post.querySelector('.feed-post-pinned-title');\n\t\t\t\t\tconst pinnedPanelDescriptionNode = post.querySelector('.feed-post-pinned-desc');\n\t\t\t\t\tconst pinnedPanelPinNode = post.querySelector(`.${this.class.pin}`);\n\n\t\t\t\t\tif (pinnedPanelTitleNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelTitleNode.innerHTML = data.TITLE;\n\t\t\t\t\t}\n\t\t\t\t\tif (pinnedPanelDescriptionNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelDescriptionNode.innerHTML = data.DESCRIPTION;\n\t\t\t\t\t}\n\t\t\t\t\tif (pinnedPanelPinNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelPinNode.title = Loc.getMessage('SONET_EXT_LIVEFEED_PIN_TITLE_Y');\n\t\t\t\t\t}\n\n\t\t\t\t\tpost.classList.add(`${this.class.postPinnedHide}`);\n\n\t\t\t\t\tconst cancelPinnedPanel = this.getCancelPinnedPanel({ logId });\n\t\t\t\t\tconst anchor = postToMove.nextSibling;\n\n\t\t\t\t\tanchor.parentNode.insertBefore(cancelPinnedPanel, anchor);\n\t\t\t\t\tthis.centerCancelPinnedPanelElements({ cancelPinnedPanel });\n\n\t\t\t\t\tcancelPinnedPanel.setAttribute('bx-data-height', originalPostHeight);\n\t\t\t\t\tconst cancelPanelHeight = cancelPinnedPanel.getAttribute('bx-data-height');\n\n\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\theight: cancelPanelHeight + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\theight: originalPostHeight + 'px',\n\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\topacity: 0\n\t\t\t\t\t});\n\n\t\t\t\t\tconst panelNode = this.getPanelNode();\n\t\t\t\t\tif (panelNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\tpanelHeight: panelNode.offsetHeight\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// list.post::hide.start, cancelPanel::show.start\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tpostToMove.classList.add(`${this.class.postHide}`);\n\t\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\t\theight: '53px'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\t\topacity: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\tpinBlocked: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\t// list.post::hide.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\n\t\t\t\t\t\tconst panelPostsNode = pinnedPanelNode.querySelector(`.${this.class.panelPosts}`);\n\n\t\t\t\t\t\tpanelPostsNode.insertBefore(postToMove, panelPostsNode.firstChild);\n\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\n\t\t\t\t\t\tpostToMove.classList.remove(`${this.class.postHide}`);\n\t\t\t\t\t\tpost.classList.remove(`${this.class.postPinnedHide}`);\n\n\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t\tthis.showCollapsedPostsPanel();\n\n\t\t\t\t\t\t// pinnedPanel.post::show.start\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tpost.classList.add(`${this.class.postPinned}`);\n\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\tposition: '',\n\t\t\t\t\t\t\t\twidth: '',\n\t\t\t\t\t\t\t\theight: '80px',\n\t\t\t\t\t\t\t\tbackgroundColor: '',\n\t\t\t\t\t\t\t\topacity: 1\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\t\tpinBlocked: false\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tpostToMove.classList.remove(`${this.class.postHide}`);\n\t\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\t\tposition: '',\n\t\t\t\t\t\t\t\t\twidth: '',\n\t\t\t\t\t\t\t\t\theight: '',\n\t\t\t\t\t\t\t\t\tbackgroundColor: '',\n\t\t\t\t\t\t\t\t\topacity: ''\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}, 600); // 600 > transition 0.5\n\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn resolve();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst height = postToMove.getAttribute('bx-data-height');\n\t\t\t\tconst pinnedHeight = postToMove.scrollHeight;\n\n\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\ttransition: '',\n\t\t\t\t});\n\n\t\t\t\tconst cancelPinnedPanel = document.querySelector(`.${this.class.cancelPanel}[bx-data-log-id=\"${logId}\"]`);\n\t\t\t\tif (Type.isDomNode(cancelPinnedPanel))\n\t\t\t\t{\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\theight: pinnedHeight + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\t// pinnedPanel.post::hide.start, cancelPanel::show.start\n\t\t\t\t\trequestAnimationFrame(() => {\n\n\t\t\t\t\t\tpostToMove.classList.add(`${this.class.postExpanding}`);\n\t\t\t\t\t\tcancelPinnedPanel.classList.add(`${this.class.postExpanding}`);\n\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\theight: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\theight: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tconst collapsed = pinnedPanelNode.classList.contains(`${this.class.panelCollapsed}`);\n\n\t\t\t\t\tif (collapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tcancelPinnedPanel.parentNode.insertBefore(postToMove, cancelPinnedPanel.nextSibling);\n\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t}\n\n\t\t\t\t\tconst showCollapsed = this.getCollapsedPanelNode().classList.contains(`${this.class.collapsedPanelShow}`);\n\t\t\t\t\tif (showCollapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideCollapsedPostsPanel();\n\n\t\t\t\t\t\t// cancelPanel::show.end\n\t\t\t\t\t\tEvent.unbindAll(cancelPinnedPanel, 'transitionend');\n\t\t\t\t\t\tEvent.bind(cancelPinnedPanel, 'transitionend', (event) => {\n\t\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\ttransform: '',\n\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.animateCancel({\n\t\t\t\t\t\t\t\tpost,\n\t\t\t\t\t\t\t\tpostToMove,\n\t\t\t\t\t\t\t\tcancelPinnedPanel,\n\t\t\t\t\t\t\t\theight\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// pinnedPanel.post::hide.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'opacity'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!collapsed)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcancelPinnedPanel.parentNode.insertBefore(postToMove, cancelPinnedPanel.nextSibling);\n\t\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\t\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.animateCancel({\n\t\t\t\t\t\t\tpost,\n\t\t\t\t\t\t\tpostToMove,\n\t\t\t\t\t\t\tcancelPinnedPanel,\n\t\t\t\t\t\t\theight\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpost.classList.remove(`${this.class.postPinned}`);\n\t\t\t\t\tpinnedPanelNode.parentNode.insertBefore(postToMove, pinnedPanelNode.nextSibling);\n\t\t\t\t\tthis.adjustPanel();\n\n\t\t\t\t\tconst originalPostHeight = postToMove.scrollHeight;\n\t\t\t\t\tpostToMove.setAttribute('bx-data-height', originalPostHeight);\n\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\theight: '80px'\n\t\t\t\t\t});\n\n\t\t\t\t\t// list.post::show.start\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\t\theight: originalPostHeight + 'px'\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\t// list.post::show.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\theight:''\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\treturn resolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tanimateCancel({\n\t\tpost,\n\t \tpostToMove,\n\t\tcancelPinnedPanel,\n\t\theight\n\t})\n\t{\n\t\tpost.classList.remove(`${this.class.postPinned}`);\n\n\t\t// post.list:show.start, cancelPanel::hide.start\n\t\tsetTimeout(() => {\n\n\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\topacity: 1,\n\t\t\t\theight: height + 'px'\n\t\t\t});\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\theight: 0\n\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tcancelPinnedPanel.remove();\n\t\t\t}, 100)\n\t\t}, 100);\n\n\t\t// post.list:show.end\n\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpost.classList.remove(`${this.class.postPinnedHide}`);\n\n\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\tmarginBottom: '',\n\t\t\t\theight: ''\n\t\t\t});\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\tmarginBottom: '',\n\t\t\t\theight: ''\n\t\t\t});\n\n\t\t\tpostToMove.classList.remove(`${this.class.postExpanding}`);\n\t\t\tcancelPinnedPanel.classList.remove(`${this.class.postExpanding}`);\n\t\t});\n\t}\n\n\tgetCancelPinnedPanel(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet cancelPinnedPanel = document.querySelector(`.${this.class.cancelPanel}[bx-data-log-id=\"${logId}\"]`);\n\n\t\tif (!Type.isDomNode(cancelPinnedPanel))\n\t\t{\n\t\t\tcancelPinnedPanel = Tag.render`\n\t\t\t\t<div class=\"${this.class.cancelPanel}\" bx-data-log-id=\"${logId}\">\n\t\t\t\t\t<div class=\"feed-post-cancel-pinned-panel-inner\">\n\t\t\t\t\t\t<div class=\"feed-post-cancel-pinned-content\">\n\t\t\t\t\t\t\t<span class=\"${this.class.cancelPanelLabel}\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_TITLE')}</span>\n\t\t\t\t\t\t\t<span class=\"feed-post-cancel-pinned-text\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_DESCRIPTION')}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-round ui-btn-sm ${this.class.cancelPanelButton}\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_BUTTON')}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t\t`;\n\n\t\t\tEvent.bind(cancelPinnedPanel.querySelector(`.${this.class.cancelPanelButton}`), 'click', () => {\n\t\t\t\tthis.changePinned({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tnewState: 'N'\n\t\t\t\t}).then(() => {\n\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\theight: 0\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn cancelPinnedPanel;\n\t}\n\n\tcenterCancelPinnedPanelElements({ cancelPinnedPanel })\n\t{\n\t\tif (!Type.isDomNode(cancelPinnedPanel))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// cancelPanel::show.start\n\t\tsetTimeout(() => {\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\topacity: 1\n\t\t\t});\n\t\t}, 100);\n\n\t\tUtils.setStyle(cancelPinnedPanel.querySelector(`.${this.class.cancelPanelLabel}`), {\n\t\t\tmarginLeft: cancelPinnedPanel.querySelector(`.${this.class.cancelPanelButton}`).getBoundingClientRect().width + 'px'\n\t\t});\n\t}\n\n\tgetPostsCount()\n\t{\n\t\tconst panelNode = this.getPanelNode();\n\t\treturn (panelNode ? Array.from(panelNode.getElementsByClassName(`${this.class.post}`)).length : 0);\n\t}\n\n\thidePinnedItems()\n\t{\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\theight: parseInt(this.getOption('panelHeight')) + 'px'\n\t\t});\n\n\t\tArray.from(pinnedPanelNode.getElementsByClassName(`${this.class.post}`)).reduce((count, item) => {\n\n\t\t\tcount += item.offsetHeight;\n\n\t\t\tUtils.setStyle(item, {\n\t\t\t\ttransition: 'opacity .1s linear, transform .2s .1s linear, height .5s linear'\n\t\t\t});\n\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\ttransition: 'height .5s .1s linear'\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::hide.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\topacity: '0!important',\n\t\t\t\t\ttransform: `translateY(-${count}px)`\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: '58px'\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::hide.end\n\t\t\tEvent.unbindAll(item, 'transitionend');\n\t\t\tEvent.bind(item, 'transitionend', (event) => {\n\t\t\t\tif (!this.checkTransitionProperty(event, 'transform'))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\topacity: '',\n\t\t\t\t\ttransform: '',\n\t\t\t\t\ttransition: ''\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\ttransition: ''\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn count;\n\t\t}, 0);\n\t}\n\n\tshowPinnedItems()\n\t{\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tArray.from(pinnedPanelNode.getElementsByClassName(`${this.class.post}`)).map((item, currentIndex, originalItemsList) => {\n\n\t\t\tUtils.setStyle(item, {\n\t\t\t\tdisplay: 'block',\n\t\t\t\topacity: 0\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::show.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: ((84 * (currentIndex + 1)) - 4) + 'px'\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\ttransform: `translateY(${0}px)`,\n\t\t\t\t\topacity: 1\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::show.end\n\t\t\tEvent.unbindAll(item, 'transitionend');\n\t\t\tEvent.bind(item, 'transitionend', (event) => {\n\t\t\t\tif (!this.checkTransitionProperty(event, 'transform'))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\theight: '',\n\t\t\t\t\ttransform: ''\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: ''\n\t\t\t\t});\n\n\t\t\t\tif ((currentIndex + 1) === originalItemsList.length)\n\t\t\t\t{\n\t\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\t\ttransition: '',\n\t\t\t\t\t\theight: ''\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tanimateCollapsedPanel()\n\t{\n\t\t// collapsedPanel::hide.start\n\t\trequestAnimationFrame(() => {\n\t\t\tconst collapsedPanel = this.getCollapsedPanelNode();\n\n\t\t\tUtils.setStyle(collapsedPanel, {\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: 0,\n\t\t\t\twidth: '100%',\n\t\t\t\topacity: 0\n\t\t\t});\n\n\t\t\tcollapsedPanel.classList.remove(`${this.class.collapsedPanelHide}`);\n\t\t\tcollapsedPanel.classList.add(`${this.class.collapsedPanelShow}`);\n\n\t\t\t// collapsedPanel::show.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(collapsedPanel, {\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\topacity: 1\n\t\t\t\t});\n\t\t\t});\n\t\t})\n\t}\n\n\tadjustCollapsedPostsPanel()\n\t{\n\t\tconst postsCounter = this.getPostsCount();\n\t\tconst postsCounterNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterPostsValue}`);\n\t\tif (postsCounterNode)\n\t\t{\n\t\t\tpostsCounterNode.innerHTML = parseInt(postsCounter);\n\t\t}\n\n\t\tconst commentsCounterNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterComments}`);\n\t\tconst commentsCounterValueNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterCommentsValue}`);\n\t\tconst panelNode = this.getPanelNode();\n\n\t\tif (\n\t\t\tcommentsCounterNode\n\t\t\t&& commentsCounterValueNode\n\t\t\t&& panelNode\n\t\t)\n\t\t{\n\t\t\tconst newCommentCounter = Array.from(panelNode.querySelectorAll(`.${this.class.collapsedPanelCounterCommentsValueNewValue}`)).reduce((acc, node) => {\n\t\t\t\treturn acc + (node.closest(`.${this.class.postUnfollowed}`) ? 0 : parseInt(node.innerHTML));\n\t\t\t}, 0);\n\n\t\t\tcommentsCounterValueNode.innerHTML = newCommentCounter;\n\t\t\tif (newCommentCounter > 0)\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.add(`${this.class.collapsedPanelCounterCommentsShown}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.remove(`${this.class.collapsedPanelCounterCommentsShown}`);\n\t\t\t}\n\t\t}\n\t}\n\n\tadjustPanel()\n\t{\n\t\tconst panelNode = this.getPanelNode();\n\t\tif (!panelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.getPostsCount() > 0)\n\t\t\t{\n\t\t\t\tpanelNode.classList.add(`${this.class.panelNonEmpty}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpanelNode.classList.remove(`${this.class.panelNonEmpty}`);\n\t\t\t}\n\t\t}, 0);\n\t}\n\n\tshowCollapsedPostsPanel()\n\t{\n\t\tif (this.getPostsCount() >= Loc.getMessage('SONET_EXT_LIVEFEED_COLLAPSED_PINNED_PANEL_ITEMS_LIMIT'))\n\t\t{\n\t\t\tthis.showCollapsedPanel();\n\t\t\tthis.hidePinnedItems();\n\t\t}\n\t}\n\n\thideCollapsedPostsPanel()\n\t{\n\t\tif (this.getPostsCount() < Loc.getMessage('SONET_EXT_LIVEFEED_COLLAPSED_PINNED_PANEL_ITEMS_LIMIT'))\n\t\t{\n\t\t\tthis.getPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t\t\tthis.removeCollapsedPanel();\n\t\t\tthis.showPinnedItems();\n\t\t}\n\t}\n\n\tshowCollapsedPanel()\n\t{\n\t\tthis.getPanelNode().classList.add(`${this.class.panelCollapsed}`);\n\t\tthis.animateCollapsedPanel();\n\t}\n\n\thideCollapsedPanel()\n\t{\n\t\tthis.getPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t\tthis.showPinnedItems();\n\t\tthis.removeCollapsedPanel();\n\t}\n\n\tremoveCollapsedPanel()\n\t{\n\t\tconst collapsedPanel = this.getCollapsedPanelNode();\n\n\t\tUtils.setStyle(collapsedPanel, {\n\t\t\tposition: 'absolute',\n\t\t\ttop: 0,\n\t\t\twidth: '100%'\n\t\t});\n\n\t\tcollapsedPanel.classList.remove(`${this.class.collapsedPanelShow}`);\n\t\tcollapsedPanel.classList.add(`${this.class.collapsedPanelHide}`);\n\t}\n\n\tgetCommentsNodes(xmlId)\n\t{\n\t\tconst result = {\n\t\t\tfollow: true,\n\t\t\tnewNode: null,\n\t\t\tnewValueNode: null,\n\t\t\toldNode: null,\n\t\t\tallNode: null\n\t\t};\n\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst commentsNode = document.querySelector(`.${this.class.postComments}[data-bx-comments-entity-xml-id=\"${xmlId}\"]`);\n\t\tif (!commentsNode)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst postNode = commentsNode.closest(`.${this.class.postPinActive}`);\n\t\tif (!postNode)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst newPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueNew}`);\n\t\tconst newValuePinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueNewValue}`);\n\t\tconst oldPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueOld}`);\n\t\tconst allPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueAll}`);\n\n\t\tif (\n\t\t\t!newPinnedCommentsNode\n\t\t\t|| !newValuePinnedCommentsNode\n\t\t\t|| !oldPinnedCommentsNode\n\t\t\t|| !allPinnedCommentsNode\n\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tresult.newNode = newPinnedCommentsNode;\n\t\tresult.newValueNode = newValuePinnedCommentsNode;\n\t\tresult.oldNode = oldPinnedCommentsNode;\n\t\tresult.allNode = allPinnedCommentsNode;\n\t\tresult.follow = (commentsNode.getAttribute('data-bx-follow') !== 'N');\n\n\t\treturn result;\n\t}\n\n\tgetCommentsData(xmlId)\n\t{\n\t\tconst result = {\n\t\t\tnewValue: null,\n\t\t\toldValue: null,\n\t\t\tallValue: null\n\t\t};\n\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst { newValueNode, oldNode, allNode, follow } = this.getCommentsNodes(xmlId);\n\n\t\tresult.follow = follow;\n\n\t\tif (\n\t\t\t!Type.isDomNode(newValueNode)\n\t\t\t|| !Type.isDomNode(oldNode)\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tlet newCommentsValue = 0;\n\t\tlet oldCommentsValue = 0;\n\t\tlet allCommentsValue = 0;\n\n\t\tlet matches = newValueNode.innerHTML.match(/(\\d+)/);\n\n\t\tif (matches)\n\t\t{\n\t\t\tnewCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tmatches = oldNode.innerHTML.match(/(\\d+)/);\n\t\tif (matches)\n\t\t{\n\t\t\toldCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tmatches = allNode.innerHTML.match(/(\\d+)/);\n\t\tif (matches)\n\t\t{\n\t\t\tallCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tresult.oldValue = oldCommentsValue;\n\t\tresult.newValue = newCommentsValue;\n\t\tresult.allValue = allCommentsValue;\n\n\t\treturn result;\n\t}\n\n\tsetCommentsData(xmlId, value)\n\t{\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { newNode, newValueNode, oldNode, allNode } = this.getCommentsNodes(xmlId);\n\t\tif (\n\t\t\t!Type.isDomNode(newNode)\n\t\t\t|| !Type.isDomNode(newValueNode)\n\t\t\t|| !Type.isDomNode(oldNode)\n\t\t\t|| !Type.isDomNode(allNode)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isInteger(value.newValue))\n\t\t{\n\t\t\tnewValueNode.innerHTML = `${value.newValue}`;\n\t\t\tif (\n\t\t\t\tvalue.newValue > 0\n\t\t\t\t&& !newNode.classList.contains(`${this.class.collapsedPanelCounterCommentsValueNewActive}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tnewNode.classList.add(`${this.class.collapsedPanelCounterCommentsValueNewActive}`);\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tvalue.newValue <= 0\n\t\t\t\t&& newNode.classList.contains(`${this.class.collapsedPanelCounterCommentsValueNewActive}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tnewNode.classList.remove(`${this.class.collapsedPanelCounterCommentsValueNewActive}`);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isInteger(value.oldValue))\n\t\t{\n\t\t\toldNode.innerHTML = value.oldValue;\n\t\t}\n\n\t\tif (Type.isInteger(value.allValue))\n\t\t{\n\t\t\tallNode.innerHTML = value.allValue;\n\t\t}\n\n\t\tthis.adjustCollapsedPostsPanel();\n\t}\n\n\tgetCollapsedPanelNode()\n\t{\n\t\treturn this.getPanelNode().querySelector(`.${this.class.collapsedPanel}`);\n\t}\n\n\tcheckTransitionProperty(event, propertyName)\n\t{\n\t\treturn (event.propertyName === propertyName);\n\t}\n}\n\nexport {\n\tPinnedPanel\n};\n","import {ajax, Type, Loc, Dom, Tag} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nexport class TaskCreator\n{\n\tstatic createTaskPopup = null;\n\tstatic cssClass = {\n\t\tpopupContent: 'feed-create-task-popup-content',\n\t\tpopupTitle: 'feed-create-task-popup-title',\n\t\tpopupDescription: 'feed-create-task-popup-description',\n\t};\n\tstatic signedFiles = null;\n\tstatic sliderUrl = '';\n\n\tconstructor()\n\t{\n\t\tthis.initEvents();\n\t}\n\n\tinitEvents()\n\t{\n\n\t\tEventEmitter.subscribe('tasksTaskEvent', (event: BaseEvent) => {\n\n\t\t\tconst [ type, data ] = event.getCompatData();\n\t\t\tif (\n\t\t\t\ttype !== 'ADD'\n\t\t\t\t|| !Type.isPlainObject(data.options)\n\t\t\t\t|| !Type.isBoolean(data.options.STAY_AT_PAGE)\n\t\t\t\t|| data.options.STAY_AT_PAGE\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tTaskCreator.signedFiles = null;\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseComplete', (event: BaseEvent) => {\n\n\t\t\tconst sliderInstance = event.getTarget();\n\t\t\tif (!sliderInstance)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst sliderUrl = sliderInstance.getUrl();\n\t\t\tif (\n\t\t\t\t!Type.isStringFilled(sliderUrl)\n\t\t\t\t|| sliderUrl !== TaskCreator.sliderUrl\n\t\t\t\t|| !Type.isStringFilled(TaskCreator.signedFiles)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tajax.runAction('intranet.controlbutton.clearNewTaskFiles', {\n\t\t\t\tdata: {\n\t\t\t\t\tsignedFiles: TaskCreator.signedFiles,\n\t\t\t\t},\n\t\t\t}).then(() => {\n\t\t\t\tTaskCreator.signedFiles = null;\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic create(params)\n\t{\n\t\tif (Loc.getMessage('SONET_EXT_LIVEFEED_INTRANET_INSTALLED') === 'Y')\n\t\t{\n\t\t\tajax.runAction('intranet.controlbutton.getTaskLink', {\n\t\t\t\tdata: {\n\t\t\t\t\tentityType: params.entityType,\n\t\t\t\t\tentityId: params.entityId,\n\t\t\t\t\tpostEntityType: (Type.isStringFilled(params.postEntityType) ? params.postEntityType : params.entityType),\n\t\t\t\t\tentityData: {},\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\n\t\t\t\tif (!Type.isStringFilled(response.data.SUFFIX))\n\t\t\t\t{\n\t\t\t\t\tresponse.data.SUFFIX = '';\n\t\t\t\t}\n\n\n\t\t\t\tconst requestData = response.data;\n\n\t\t\t\trequestData.DESCRIPTION = this.formatTaskDescription(requestData.DESCRIPTION, requestData.URL, params.entityType, requestData.SUFFIX);\n\n\t\t\t\tif (parseInt(params.parentTaskId) > 0)\n\t\t\t\t{\n\t\t\t\t\trequestData.PARENT_ID = parseInt(params.parentTaskId);\n\t\t\t\t}\n\n\t\t\t\tif (Type.isStringFilled(requestData.UF_TASK_WEBDAV_FILES_SIGN))\n\t\t\t\t{\n\t\t\t\t\tthis.signedFiles = requestData.UF_TASK_WEBDAV_FILES_SIGN;\n\t\t\t\t}\n\n\t\t\t\tthis.sliderUrl = response.data.link;\n\n\t\t\t\tBX.SidePanel.Instance.open(response.data.link, {\n\t\t\t\t\trequestMethod: 'post',\n\t\t\t\t\trequestParams: requestData,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.createTaskPopup = new Popup('BXCTP', null, {\n\t\t\t\tautoHide: false,\n\t\t\t\tzIndex: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toverlay: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcloseIcon: {\n\t\t\t\t\tright: '12px',\n\t\t\t\t\ttop: '10px',\n\t\t\t\t},\n\t\t\t\tdraggable: {\n\t\t\t\t\trestrict: true,\n\t\t\t\t},\n\t\t\t\tcloseByEsc: false,\n\t\t\t\tcontentColor : 'white',\n\t\t\t\tcontentNoPaddings: true,\n\t\t\t\tbuttons: [],\n\t\t\t\tcontent: Tag.render`<div id=\"BXCTP_content\" class=\"${this.cssClass.popupContent}\"></div>`,\n\t\t\t\tevents: {\n\t\t\t\t\tonAfterPopupShow: () => {\n\t\t\t\t\t\tthis.createTaskSetContent(Tag.render`<div class=\"${this.cssClass.popupTitle}\">${Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_WAIT')}</div>`);\n\n\t\t\t\t\t\tajax.runAction('socialnetwork.api.livefeed.getRawEntryData', {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tentityType: params.entityType,\n\t\t\t\t\t\t\t\t\tentityId: params.entityId,\n\t\t\t\t\t\t\t\t\tlogId: (Type.isNumber(params.logId) ? params.logId : null),\n\t\t\t\t\t\t\t\t\tadditionalParams: {\n\t\t\t\t\t\t\t\t\t\tgetSonetGroupAvailable: 'Y',\n\t\t\t\t\t\t\t\t\t\tgetLivefeedUrl: 'Y',\n\t\t\t\t\t\t\t\t\t\tcheckPermissions: {\n\t\t\t\t\t\t\t\t\t\t\tfeature: 'tasks',\n\t\t\t\t\t\t\t\t\t\t\toperation: 'create_tasks',\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then((response) => {\n\n\t\t\t\t\t\t\tconst entryTitle = (Type.isStringFilled(response.data.TITLE) ? response.data.TITLE : '');\n\t\t\t\t\t\t\tconst entryDescription = (Type.isStringFilled(response.data.DESCRIPTION) ? response.data.DESCRIPTION : '');\n\t\t\t\t\t\t\tconst entryDiskObjects = (Type.isPlainObject(response.data.DISK_OBJECTS) ? response.data.DISK_OBJECTS : []);\n\t\t\t\t\t\t\tconst entryUrl = (Type.isStringFilled(response.data.LIVEFEED_URL) ? response.data.LIVEFEED_URL : '');\n\t\t\t\t\t\t\tconst entrySuffix = (Type.isStringFilled(response.data.SUFFIX) ? response.data.SUFFIX : '');\n\t\t\t\t\t\t\tconst groupsAvailable = (Type.isPlainObject(response.data.GROUPS_AVAILABLE) ? response.data.GROUPS_AVAILABLE : []);\n\t\t\t\t\t\t\tconst logId = (!Type.isUndefined(response.data.LOG_ID) ? parseInt(response.data.LOG_ID) : 0);\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\tType.isStringFilled(entryTitle)\n\t\t\t\t\t\t\t\t\t|| Type.isStringFilled(entryDescription)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t&& Type.isStringFilled(entryUrl)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst taskDescription = this.formatTaskDescription(entryDescription, entryUrl, params.entityType, entrySuffix);\n\t\t\t\t\t\t\t\tconst taskData = {\n\t\t\t\t\t\t\t\t\tTITLE: entryTitle,\n\t\t\t\t\t\t\t\t\tDESCRIPTION: taskDescription,\n\t\t\t\t\t\t\t\t\tRESPONSIBLE_ID: Loc.getMessage('USER_ID'),\n\t\t\t\t\t\t\t\t\tCREATED_BY: Loc.getMessage('USER_ID'),\n\t\t\t\t\t\t\t\t\tUF_TASK_WEBDAV_FILES: entryDiskObjects,\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tconst sonetGroupIdList = [];\n\n\t\t\t\t\t\t\t\tfor (const [key, value] of Object.entries(groupsAvailable))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tsonetGroupIdList.push(value);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (sonetGroupIdList.length == 1)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttaskData.GROUP_ID = parseInt(sonetGroupIdList[0]);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (parseInt(params.entityType) > 0)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttaskData.PARENT_ID = parseInt(params.entityType);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tBX.Tasks.Util.Query.runOnce('task.add', { data: taskData }).then((result) => {\n\n\t\t\t\t\t\t\t\t\tconst resultData = result.getData();\n\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tType.isPlainObject(resultData)\n\t\t\t\t\t\t\t\t\t\t&& Type.isPlainObject(resultData.DATA)\n\t\t\t\t\t\t\t\t\t\t&& !Type.isUndefined(resultData.DATA.ID)\n\t\t\t\t\t\t\t\t\t\t&& parseInt(resultData.DATA.ID) > 0\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.createTaskSetContentSuccess(resultData.DATA.ID);\n\n\t\t\t\t\t\t\t\t\t\tajax.runAction('socialnetwork.api.livefeed.createEntityComment', {\n\t\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tpostEntityType: (Type.isStringFilled(params.postEntityType) ? params.postEntityType : params.entityType),\n\t\t\t\t\t\t\t\t\t\t\t\t\tsourceEntityType: params.entityType,\n\t\t\t\t\t\t\t\t\t\t\t\t\tsourceEntityId: params.entityId,\n\t\t\t\t\t\t\t\t\t\t\t\t\tentityType: 'TASK',\n\t\t\t\t\t\t\t\t\t\t\t\t\tentityId: resultData.DATA.ID,\n\t\t\t\t\t\t\t\t\t\t\t\t\tlogId: (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tType.isNumber(params.logId)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? params.logId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: logId > 0 ? logId : null\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.createTaskSetContentFailure(result.getErrors().getMessages());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.createTaskSetContentFailure([\n\t\t\t\t\t\t\t\t\tLoc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_ERROR_GET_DATA'),\n\t\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\tthis.createTaskSetContentFailure([\n\t\t\t\t\t\t\t\tLoc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_ERROR_GET_DATA'),\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.createTaskPopup.destroy();\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.createTaskPopup.show();\n\t\t}\n\t}\n\n\tstatic createTaskSetContentSuccess(taskId) {\n\n\t\tconst taskLink = Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_PATH').replace('#user_id#', Loc.getMessage('USER_ID')).replace('#task_id#', taskId);\n\n\t\tthis.createTaskPopup.destroy();\n\n\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_SUCCESS_TITLE'),\n\t\t\tactions: [{\n\t\t\t\ttitle: Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_VIEW'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (event, balloon, action) => {\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\twindow.top.BX.SidePanel.Instance.open(taskLink);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}],\n\n\t\t});\n\t}\n\n\tstatic createTaskSetContentFailure(errors)\n\t{\n\t\tthis.createTaskSetContent(Tag.render`<div>\n\t\t\t<div class=\"${this.cssClass.popupTitle}\">${Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_FAILURE_TITLE')}</div>\n\t\t\t<div class=\"${this.cssClass.popupDescription}\">${errors.join('<br>')}</div>\n\t\t</div>`);\n\t}\n\n\tstatic createTaskSetContent(contentNode)\n\t{\n\t\tconst containerNode = document.getElementById('BXCTP_content');\n\t\tif (!containerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(containerNode);\n\t\tcontainerNode.appendChild(contentNode);\n\t}\n\n\tstatic formatTaskDescription(taskDescription, livefeedUrl, entityType, suffix)\n\t{\n\t\tlet result = taskDescription;\n\n\t\tsuffix = (Type.isStringFilled(suffix) ? `_${suffix}` : '');\n\n\t\tif (\n\t\t\t!!livefeedUrl\n\t\t\t&& !!entityType\n\t\t\t&& livefeedUrl.length > 0\n\t\t)\n\t\t{\n\t\t\tresult += \"\\n\\n\" + Loc.getMessage(`SONET_EXT_COMMENTAUX_CREATE_TASK_${entityType}${suffix}`).replace(\n\t\t\t\t'#A_BEGIN#', `[URL=${livefeedUrl}]`\n\t\t\t).replace(\n\t\t\t\t'#A_END#', '[/URL]'\n\t\t\t);\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type, Loc, Tag, Dom} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {Button} from 'ui.buttons';\nimport {MenuManager} from 'main.popup';\n\nimport {FeedInstance, PinnedPanelInstance} from './feed';\nimport {TaskCreator} from './taskcreator';\n\nclass Post\n{\n\tstatic showBackgroundWarning({\n\t\turlToEdit,\n\t\tmenuPopupWindow\n\t})\n\t{\n\t\tconst content = Tag.render`<div>${Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_DESCRIPTION')}</div>`;\n\n\t\tconst dialog = new Popup('backgroundWarning', null, {\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tdraggable: true,\n\t\t\tbindOnResize: false,\n\t\t\ttitleBar: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_TITLE'),\n\t\t\tcloseIcon: true,\n\t\t\tclassName: 'sonet-livefeed-popup-warning',\n\t\t\tcontent: content,\n\t\t\tevents: {},\n\t\t\tcacheable: false,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_BUTTON_SUBMIT'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-primary',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\twindow.location = urlToEdit;\n\t\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\t\tif (menuPopupWindow)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmenuPopupWindow.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_BUTTON_CANCEL'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-light',\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\tif (menuPopupWindow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuPopupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tdialog.show();\n\n\t\treturn false;\n\t}\n\n\tstatic showMenu(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tconst menuElement = params.menuElement;\n\t\tconst ind = params.ind;\n\t\tconst menuId = this.getMenuId(ind);\n\n\t\tMenuManager.destroy(menuId);\n\n\t\tlet log_id = (!Type.isUndefined(params.log_id) ? parseInt(params.log_id) : 0);\n\n\t\tif (log_id <= 0)\n\t\t{\n\t\t\tlog_id = parseInt(menuElement.getAttribute('data-log-entry-log-id'));\n\t\t}\n\t\tif (log_id <= 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet bFavorites = params.bFavorites;\n\t\tif (Type.isUndefined(bFavorites))\n\t\t{\n\t\t\tbFavorites = (menuElement.getAttribute('data-log-entry-favorites') === 'Y');\n\t\t}\n\n\t\tlet arMenuItemsAdditional = params.arMenuItemsAdditional;\n\t\tif (Type.isUndefined(arMenuItemsAdditional))\n\t\t{\n\t\t\tarMenuItemsAdditional = menuElement.getAttribute('data-bx-items');\n\t\t\ttry\n\t\t\t{\n\t\t\t\tarMenuItemsAdditional = JSON.parse(arMenuItemsAdditional);\n\t\t\t\tif (!Type.isPlainObject(arMenuItemsAdditional))\n\t\t\t\t{\n\t\t\t\t\tarMenuItemsAdditional = {};\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tarMenuItemsAdditional = {};\n\t\t\t}\n\t\t}\n\n\t\tconst bindElement = params.bindElement;\n\n\t\tlet itemPinned = null;\n\t\tconst pinnedPostNode = bindElement.closest('[data-livefeed-post-pinned]');\n\t\tif (pinnedPostNode)\n\t\t{\n\t\t\tconst pinnedState = (pinnedPostNode.getAttribute('data-livefeed-post-pinned') === 'Y');\n\n\t\t\titemPinned = {\n\t\t\t\ttext : (pinnedState ? Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_PINNED_Y') : Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_PINNED_N')),\n\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\tonclick: (e) => {\n\t\t\t\t\tPinnedPanelInstance.changePinned({\n\t\t\t\t\t\tlogId: log_id,\n\t\t\t\t\t\tnewState: (pinnedState ? 'N' : 'Y'),\n\t\t\t\t\t\tevent: e,\n\t\t\t\t\t\tnode: bindElement,\n\t\t\t\t\t});\n\n\t\t\t\t\tMenuManager.getMenuById(this.getMenuId(ind)).popupWindow.close();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tconst itemFavorites = (\n\t\t\tLoc.getMessage('sonetLbUseFavorites') !== 'N'\n\t\t\t\t? {\n\t\t\t\t\ttext: (bFavorites ? Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_Y') : Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_N')),\n\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\tonclick : (e) => {\n\t\t\t\t\t\t__logChangeFavorites(\n\t\t\t\t\t\t\tlog_id,\n\t\t\t\t\t\t\t`log_entry_favorites_${log_id}`,\n\t\t\t\t\t\t\t(bFavorites ? 'N' : 'Y'),\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\te\n\t\t\t\t\t\t);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t: null\n\t\t);\n\n\t\tlet arItems = [\n\t\t\titemPinned,\n\t\t\titemFavorites,\n\t\t\t(\n\t\t\t\tType.isStringFilled(menuElement.getAttribute('data-log-entry-url'))\n\t\t\t\t\t? {\n\t\t\t\t\t\thtml: `<span id=\"${menuId}-href-text\">${Loc.getMessage('sonetLMenuHref')}</span>`,\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon feed-entry-popup-menu feed-entry-popup-menu-href',\n\t\t\t\t\t\thref: menuElement.getAttribute('data-log-entry-url'),\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t\t(\n\t\t\t\tType.isStringFilled(menuElement.getAttribute('data-log-entry-url'))\n\t\t\t\t\t? {\n\t\t\t\t\t\thtml: `<span id=\"${menuId}-link-text\">${Loc.getMessage('sonetLMenuLink')}</span>` +\n\t\t\t\t\t\t\t`<span id=\"${menuId}-link-icon-animate\" class=\"post-menu-link-icon-wrap\">` +\n\t\t\t\t\t\t\t`<span class=\"post-menu-link-icon\" id=\"${menuId}-link-icon-done\" style=\"display: none;\">` +\n\n\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t'</span>',\n\t\t\t\t\t\tclassName : 'menu-popup-no-icon feed-entry-popup-menu feed-entry-popup-menu-link',\n\t\t\t\t\t\tonclick: (e) => {\n\n\t\t\t\t\t\t\tconst menuItemText = document.getElementById(`${menuId}-link-text`);\n\t\t\t\t\t\t\tconst menuItemIconDone = document.getElementById(`${menuId}-link-icon-done`);\n\n\t\t\t\t\t\t\tif (BX.clipboard.isCopySupported())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (menuItemText && menuItemText.getAttribute('data-block-click') === 'Y')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tBX.clipboard.copy(menuElement.getAttribute('data-log-entry-url'));\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tmenuItemText\n\t\t\t\t\t\t\t\t\t&& menuItemIconDone\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmenuItemIconDone.style.display = 'inline-block';\n\t\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link-icon-animate`).classList.remove('post-menu-link-icon-animate');\n\n\t\t\t\t\t\t\t\t\tDom.adjust(document.getElementById(`${menuId}-link-text`), {\n\t\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\t\t'data-block-click': 'Y',\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link-icon-animate`).classList.add('post-menu-link-icon-animate');\n\t\t\t\t\t\t\t\t\t}, 1);\n\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\tDom.adjust(document.getElementById(`${menuId}-link-text`), {\n\t\t\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\t\t\t'data-block-click': 'N',\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}, 500);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst it = e.currentTarget;\n\t\t\t\t\t\t\tconst height = parseInt(!!it.getAttribute('bx-height') ? it.getAttribute('bx-height') : it.offsetHeight);\n\n\t\t\t\t\t\t\tif (it.getAttribute('bx-status') !== 'shown')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tit.setAttribute('bx-status', 'shown');\n\n\t\t\t\t\t\t\t\tconst node = document.getElementById(`${menuId}-link-text`);\n\n\t\t\t\t\t\t\t\tif (!document.getElementById(`${menuId}-link`) && !!node)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst pos = BX.pos(node);\n\t\t\t\t\t\t\t\t\tconst pos2 = BX.pos(node.parentNode);\n\t\t\t\t\t\t\t\t\tconst pos3 = BX.pos(node.closest('.menu-popup-item'));\n\n\t\t\t\t\t\t\t\t\tpos.height = pos2.height - 1;\n\n\t\t\t\t\t\t\t\t\tDom.adjust(it, {\n\t\t\t\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\t\t\t\t'bx-height': it.offsetHeight,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tstyle : {\n\t\t\t\t\t\t\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tchildren : [\n\t\t\t\t\t\t\t\t\t\t\tDom.create('BR'),\n\t\t\t\t\t\t\t\t\t\t\tDom.create('DIV', {\n\t\t\t\t\t\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: `${menuId}-link`,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\tchildren : [\n\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {attrs: {className: 'menu-popup-item-left'}}),\n\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {attrs: {className: 'menu-popup-item-icon'}}),\n\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: 'menu-popup-item-text'},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren : [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('INPUT', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: `${menuId}-link-input`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: menuElement.getAttribute('data-log-entry-url'),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle : {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\theight: `${pos.height}px`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth: `${(pos3.width - 21)}px`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclick: (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.currentTarget.select();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {attrs: {className: 'menu-popup-item-right'}}),\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tEvent.bind(document.getElementById(`${menuId}-link-input`), 'click', (e) => {\n\t\t\t\t\t\t\t\t\t\te.currentTarget.select();\n\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\te.stopPropagation()\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t(new BX.fx({\n\t\t\t\t\t\t\t\t\ttime: 0.2,\n\t\t\t\t\t\t\t\t\tstep: 0.05,\n\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\tstart: height,\n\t\t\t\t\t\t\t\t\tfinish: height * 2,\n\t\t\t\t\t\t\t\t\tcallback: function (height) {\n\t\t\t\t\t\t\t\t\t\tthis.style.height = `${height}px`;\n\t\t\t\t\t\t\t\t\t}.bind(it),\n\t\t\t\t\t\t\t\t})).start();\n\t\t\t\t\t\t\t\tBX.fx.show(document.getElementById(`${menuId}-link`), 0.2);\n\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link-input`).select();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tit.setAttribute('bx-status', 'hidden');\n\t\t\t\t\t\t\t\t(new BX.fx({\n\t\t\t\t\t\t\t\t\ttime: 0.2,\n\t\t\t\t\t\t\t\t\tstep: 0.05,\n\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\tstart: it.offsetHeight,\n\t\t\t\t\t\t\t\t\tfinish: height,\n\t\t\t\t\t\t\t\t\tcallback: function(height) {\n\t\t\t\t\t\t\t\t\t\tthis.style.height = `${height}px`;\n\t\t\t\t\t\t\t\t\t}.bind(it),\n\t\t\t\t\t\t\t\t})).start();\n\t\t\t\t\t\t\t\tBX.fx.hide(document.getElementById(`${menuId}-link`), 0.2);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t\t(\n\t\t\t\tLoc.getMessage('sonetLCanDelete') === 'Y'\n\t\t\t\t\t? {\n\t\t\t\t\t\ttext: Loc.getMessage('sonetLMenuDelete'),\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\t\tonclick: (e) => {\n\t\t\t\t\t\t\tif (confirm(Loc.getMessage('sonetLMenuDeleteConfirm')))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tFeedInstance.delete({\n\t\t\t\t\t\t\t\t\tlogId: log_id,\n\t\t\t\t\t\t\t\t\tnodeId: `log-entry-${log_id}`,\n\t\t\t\t\t\t\t\t\tind: ind,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t} : null\n\t\t\t),\n\t\t\t(\n\t\t\t\tmenuElement.getAttribute('data-log-entry-createtask') === 'Y'\n\t\t\t\t\t? {\n\t\t\t\t\t\ttext: Loc.getMessage('sonetLMenuCreateTask'),\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\t\tonclick: (e) => {\n\t\t\t\t\t\t\tTaskCreator.create({\n\t\t\t\t\t\t\t\tentryEntityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityId: menuElement.getAttribute('data-log-entry-entity-id'),\n\t\t\t\t\t\t\t\tlogId: parseInt(menuElement.getAttribute('data-log-entry-log-id')),\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tMenuManager.getMenuById(this.getMenuId(ind)).popupWindow.close();\n\t\t\t\t\t\t\treturn e.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t\t(\n\t\t\t\tmenuElement.getAttribute('data-log-entry-createtask') === 'Y'\n\t\t\t\t&& menuElement.getAttribute('data-log-entry-entity-type') === 'TASK'\n\t\t\t\t\t? {\n\t\t\t\t\t\ttext: Loc.getMessage('sonetLMenuCreateSubTask'),\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\t\tonclick: (e) => {\n\t\t\t\t\t\t\tTaskCreator.create({\n\t\t\t\t\t\t\t\tentryEntityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityId: menuElement.getAttribute('data-log-entry-entity-id'),\n\t\t\t\t\t\t\t\tlogId: parseInt(menuElement.getAttribute('data-log-entry-log-id')),\n\t\t\t\t\t\t\t\tparentTaskId: parseInt(menuElement.getAttribute('data-log-entry-entity-id')),\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tMenuManager.getMenuById(this.getMenuId(ind)).popupWindow.close();\n\t\t\t\t\t\t\treturn e.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t];\n\n\t\tif (\n\t\t\t!!arMenuItemsAdditional\n\t\t\t&& Type.isArray(arMenuItemsAdditional)\n\t\t)\n\t\t{\n\t\t\tarMenuItemsAdditional.forEach((item) => {\n\t\t\t\tif (Type.isUndefined(item.className))\n\t\t\t\t{\n\t\t\t\t\titem.className = 'menu-popup-no-icon';\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tarItems = arItems.concat(arMenuItemsAdditional);\n\t\t}\n\n\t\tconst arParams = {\n\t\t\toffsetLeft: -14,\n\t\t\toffsetTop: 4,\n\t\t\tlightShadow: false,\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t\toffset : 50,\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonPopupShow: (ob) => {\n\t\t\t\t\tif (document.getElementById(`log_entry_favorites_${log_id}`))\n\t\t\t\t\t{\n\t\t\t\t\t\tlet favoritesMenuItem = null;\n\n\t\t\t\t\t\tconst menuItems = ob.contentContainer.querySelectorAll('.menu-popup-item-text');\n\t\t\t\t\t\tmenuItems.forEach((menuItem) => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tmenuItem.innerHTML === Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_Y')\n\t\t\t\t\t\t\t\t|| menuItem.innerHTML === Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_N')\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfavoritesMenuItem = menuItem;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (Type.isDomNode(favoritesMenuItem))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfavoritesMenuItem.innerHTML = (\n\t\t\t\t\t\t\t\tdocument.getElementById(`log_entry_favorites_${log_id}`).classList.contains('feed-post-important-switch-active')\n\t\t\t\t\t\t\t\t\t? Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_Y')\n\t\t\t\t\t\t\t\t\t: Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_N')\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (document.getElementById(`${menuId}-link`))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst linkMenuItem = ob.popupContainer.querySelector('.feed-entry-popup-menu-link');\n\t\t\t\t\t\tif (linkMenuItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst height = parseInt(!!linkMenuItem.getAttribute('bx-height') ? linkMenuItem.getAttribute('bx-height') : 0);\n\t\t\t\t\t\t\tif (height > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link`).style.display = 'none';\n\t\t\t\t\t\t\t\tlinkMenuItem.setAttribute('bx-status', 'hidden');\n\t\t\t\t\t\t\t\tlinkMenuItem.style.height = `${height}px`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tMenuManager.show(this.getMenuId(ind), bindElement, arItems, arParams);\n\t}\n\n\tstatic getMenuId(ind)\n\t{\n\t\treturn `post-menu-${ind}`;\n\t}\n\n}\n\nexport {\n\tPost\n};","import { Loc, Type, Runtime } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nclass Informer\n{\n\tconstructor()\n\t{\n\t\tthis.container = null;\n\t\tthis.wrap = null;\n\t\tthis.plus = null;\n\t\tthis.value = null;\n\n\t\tthis.currentSiteId = null;\n\t\tthis.currentCounterType = null;\n\n\t\tthis.counterDecrementStack = 0;\n\t\tthis.counterValue = 0;\n\n\t\tthis.lockCounterAnimation = null;\n\n\t\tthis.class = {\n\t\t\tinformerFixed: 'feed-new-message-informer-fixed',\n\t\t\tinformerAnimation: 'feed-new-message-informer-anim',\n\t\t\tinformerFixedAnimation: 'feed-new-message-informer-fix-anim',\n\t\t\tcounterText: 'feed-new-message-inf-text',\n\t\t\tcounterContainer: 'feed-new-message-inf-text-counter',\n\t\t\treloadContainer: 'feed-new-message-inf-text-reload',\n\t\t\ticon: 'feed-new-message-icon',\n\t\t\ticonRotating: 'new-message-balloon-icon-rotating',\n\t\t\tplusHidden: 'feed-new-message-informer-counter-plus-hidden',\n\t\t};\n\t}\n\n\tinit()\n\t{\n\t\tthis.initNodes();\n\t\tthis.initEvents();\n\t}\n\n\tinitNodes()\n\t{\n\t\tthis.currentCounterType = Loc.getMessage('sonetLCounterType') ? Loc.getMessage('sonetLCounterType') : '**';\n\t\tthis.currentSiteId = Loc.getMessage('SITE_ID');\n\n\t\tthis.container = document.getElementById('sonet_log_counter_2_container');\n\t\tif (this.container)\n\t\t{\n\t\t\tthis.container.addEventListener('click', this.showReloadAnimation.bind(this));\n\t\t}\n\n\t\tthis.wrap = document.getElementById('sonet_log_counter_2_wrap');\n\t\tthis.plus = document.getElementById('sonet_log_counter_2_plus');\n\t\tthis.value = document.getElementById('sonet_log_counter_2');\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('onGoUp', (event: BaseEvent) =>\n\t\t{\n\t\t\tthis.unfixWrap();\n\t\t});\n\n\t\tEventEmitter.subscribe('onPullEvent-main', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ command, params ] = event.getData();\n\n\t\t\tif (\n\t\t\t\tcommand !== 'user_counter'\n\t\t\t\t|| !params[this.currentSiteId]\n\t\t\t\t|| !params[this.currentSiteId][this.currentCounterType]\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeCounter(Runtime.clone(params[this.currentSiteId][this.currentCounterType]));\n\t\t});\n\n\t\tEventEmitter.subscribe('onImUpdateCounter', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ arCount ] = event.getData();\n\n\t\t\tif (\n\t\t\t\t!Type.isObjectLike(arCount)\n\t\t\t\t|| Type.isUndefined(arCount[this.currentCounterType])\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeCounter(arCount[this.currentCounterType]);\n\t\t});\n\n\t\tEventEmitter.subscribe('OnUCCommentWasRead', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, options ] = event.getData();\n\n\t\t\tif (\n\t\t\t\t!Type.isObjectLike(options)\n\t\t\t\t|| !options.live\n\t\t\t\t|| !options.new\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit('onCounterDecrement', new BaseEvent({\n\t\t\t\tcompatData: [1],\n\t\t\t}));\n\n\t\t\tthis.decrementCounter(1);\n\t\t});\n\t};\n\n\tchangeCounter(count)\n\t{\n\t\tthis.counterValue = parseInt(count);\n\n\t\tif (this.counterValue <= 0)\n\t\t{\n\t\t\tthis.counterDecrementStack = 0;\n\t\t}\n\n\t\tconst valueToShow = this.counterValue - this.counterDecrementStack;\n\n\t\tthis.changeAnimate({\n\t\t\tshow: (valueToShow > 0),\n\t\t\tcounter: valueToShow,\n\t\t\tzeroCounterFromDb: (valueToShow <= 0),\n\t\t});\n\t};\n\n\tchangeAnimate(params)\n\t{\n\t\tconst show = (!!params.show);\n\t\tconst counterValue = parseInt(params.counter);\n\t\tconst zeroCounterFromDb = !!params.zeroCounterFromDb;\n\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterTextNode = this.container.querySelector(`span.${this.class.counterText}`);\n\t\tconst reloadNode = this.container.querySelector(`span.${this.class.reloadContainer}`);\n\n\t\tif (this.lockCounterAnimation)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.changeAnimate({\n\t\t\t\t\tshow: show,\n\t\t\t\t\tcounter: counterValue,\n\t\t\t\t})\n\t\t\t}, 200);\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (show)\n\t\t{\n\t\t\tif (this.value)\n\t\t\t{\n\t\t\t\tthis.value.innerHTML = counterValue;\n\t\t\t}\n\n\t\t\tthis.showWrapAnimation();\n\n\t\t\tif (\n\t\t\t\tthis.plus\n\t\t\t\t&& reloadNode\n\t\t\t\t&& reloadNode.style.display !== 'none'\n\t\t\t\t&& counterTextNode\n\t\t\t)\n\t\t\t{\n\t\t\t\treloadNode.style.display = 'none';\n\t\t\t\tcounterTextNode.style.display = 'inline-block';\n\t\t\t\tthis.plus.classList.remove(`${this.class.plusHidden}`);\n\t\t\t}\n\t\t}\n\t\telse if (this.wrap)\n\t\t{\n\t\t\tif (\n\t\t\t\tzeroCounterFromDb\n\t\t\t\t&& this.wrap.classList.contains(`${this.class.informerAnimation}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tcounterTextNode\n\t\t\t\t\t&& reloadNode\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tcounterTextNode.style.display = 'none';\n\t\t\t\t\treloadNode.style.display = 'inline-block';\n\n\t\t\t\t\tthis.hideReloadAnimation();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.hideWrapAnimation();\n\t\t\t\t}, 400);\n\t\t\t}\n\t\t}\n\t};\n\n\tshowWrapAnimation()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.style.visibility = 'visible';\n\t\tthis.wrap.classList.add(`${this.class.informerAnimation}`);\n\t};\n\n\thideWrapAnimation()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.remove(`${this.class.informerAnimation}`);\n\t\tthis.wrap.style.visibility = 'hidden';\n\t}\n\n\tshowReloadAnimation()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterWaiterNode = this.container.querySelector(`span.${this.class.icon}`);\n\t\tif (counterWaiterNode)\n\t\t{\n\t\t\tcounterWaiterNode.classList.add(this.class.iconRotating);\n\t\t}\n\t}\n\n\thideReloadAnimation()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterNodeWaiter = this.container.querySelector(`span.${this.class.icon}`);\n\t\tif (counterNodeWaiter)\n\t\t{\n\t\t\tcounterNodeWaiter.classList.remove(this.class.iconRotating);\n\t\t}\n\t}\n\n\tonFeedScroll()\n\t{\n\t\tif (\n\t\t\t!this.container\n\t\t\t|| !this.wrap\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst top = this.wrap.parentNode.getBoundingClientRect().top;\n\t\tconst counterRect = this.container.getBoundingClientRect();\n\n\t\tif (top <= 0)\n\t\t{\n\n\t\t\tif (!this.wrap.classList.contains(`${this.class.informerFixed}`))\n\t\t\t{\n\t\t\t\tthis.container.style.left = `${(counterRect.left + (counterRect.width / 2))}px`;\n\t\t\t}\n\n\t\t\tthis.fixWrap();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.unfixWrap();\n\t\t\tthis.container.style.left = 'auto';\n\t\t}\n\t};\n\n\tfixWrap()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.add(`${this.class.informerFixed}`, `${this.class.informerFixedAnimation}`);\n\t}\n\n\tunfixWrap()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.remove(`${this.class.informerFixed}`, `${this.class.informerFixedAnimation}`);\n\t};\n\n\trecover()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterContainerNode = this.container.querySelector(`span.${this.class.counterContainer}`);\n\n\t\tif (!counterContainerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcounterContainerNode.style.display = 'inline-block';\n\t\tthis.hideReloadNode();\n\n\t\tif (this.plus)\n\t\t{\n\t\t\tthis.plus.classList.add(`${this.class.plusHidden}`);\n\t\t}\n\t};\n\n\thideReloadNode()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst reloadContainerNode = this.container.querySelector(`span.${this.class.reloadContainer}`);\n\n\t\tif (!reloadContainerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treloadContainerNode.style.display = 'none';\n\t};\n\n\tdecrementCounter(value)\n\t{\n\t\tthis.counterDecrementStack += parseInt(value);\n\n\t\tif (!this.value)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterValue = this.counterValue - this.counterDecrementStack;\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tthis.value.innerHTML = counterValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.changeAnimate({\n\t\t\t\tshow: false,\n\t\t\t\tcounter: 0,\n\t\t\t});\n\t\t}\n\t}\n\n\tgetWrap()\n\t{\n\t\treturn this.wrap;\n\t}\n}\n\nexport {\n\tInformer\n};","export class Loader\n{\n\tstatic cssClass = {\n\t\tfeedMask: 'log-internal-mask',\n\t\tfeedNoMask: 'log-internal-nomask',\n\t\tshowLoader: 'livefeed-show-loader',\n\t\thideLoader: 'livefeed-hide-loader',\n\t};\n\n\tstatic onAnimationEnd = (event) => {\n\t\tif (\n\t\t\t'animationName' in event\n\t\t\t&& event.animationName\n\t\t\t&& event.animationName === 'hideLoader'\n\t\t)\n\t\t{\n\t\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\t\tif (!loaderContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tloaderContainer.classList.remove(this.cssClass.showLoader);\n\t\t\tloaderContainer.classList.remove(this.cssClass.hideLoader);\n\t\t\tloaderContainer.style.display = '';\n\t\t}\n\t}\n\n\tstatic showRefreshFade()\n\t{\n\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\tif (feedContainer)\n\t\t{\n\t\t\tfeedContainer.classList.add(this.cssClass.feedMask);\n\t\t\tfeedContainer.classList.remove(this.cssClass.feedNoMask);\n\t\t}\n\n\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\tif (loaderContainer)\n\t\t{\n\t\t\tloaderContainer.style.display = 'block';\n\t\t\tloaderContainer.classList.remove(this.cssClass.hideLoader);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tloaderContainer.classList.add(this.cssClass.showLoader);\n\t\t\t}, 0);\n\t\t}\n\t}\n\n\tstatic hideRefreshFade()\n\t{\n\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\tif (feedContainer)\n\t\t{\n\t\t\tfeedContainer.classList.remove(this.cssClass.feedMask);\n\t\t\tfeedContainer.classList.add(this.cssClass.feedNoMask);\n\t\t}\n\n\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\tif (loaderContainer)\n\t\t{\n\t\t\tloaderContainer.classList.remove(this.cssClass.showLoader);\n\t\t\tloaderContainer.classList.add(this.cssClass.hideLoader);\n\t\t}\n\t}\n}\n","import {Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {FeedInstance} from './feed';\n\nexport class MoreButton\n{\n\tstatic cssClass = {\n\t\tpost: 'feed-post-block',\n\t\tpostShort: 'feed-post-block-short',\n\t\tpostSeparator: 'feed-post-block-separator',\n\t\tpostText: 'feed-post-text-block',\n\t\tpostTextInner: 'feed-post-text-block-inner',\n\t\tpostTextInnerInner: 'feed-post-text-block-inner-inner',\n\t\tmore: 'feed-post-text-more',\n\t\tcomment: 'feed-com-text',\n\t};\n\n\tstatic recalcPost(params)\n\t{\n\t\tif (!Type.isDomNode(params.informerBlock))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst blockHeight = (!Type.isUndefined(params.arPos) ? params.arPos.height : params.bodyBlock.offsetHeight);\n\n\t\tconst postBlock = params.informerBlock.closest(`.${this.cssClass.post}`);\n\t\tif (!postBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (blockHeight <= 284)\n\t\t{\n\t\t\tpostBlock.classList.add(this.cssClass.postShort)\n\t\t\tpostBlock.classList.add(this.cssClass.postSeparator)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpostBlock.classList.remove(this.cssClass.postShort)\n\t\t}\n\t}\n\n\tstatic recalcPostsList()\n\t{\n\t\tconst buttonsList = FeedInstance.getMoreButtons();\n\t\tbuttonsList.forEach((buttonData, index, object) => {\n\n\t\t\tif (\n\t\t\t\t!Type.isPlainObject(buttonData)\n\t\t\t\t|| !Type.isStringFilled(buttonData.bodyBlockID)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst bodyNode = document.getElementById(buttonData.bodyBlockID)\n\t\t\tif (!bodyNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(buttonData.outerBlockID))\n\t\t\t{\n\t\t\t\tconst outerNode = document.getElementById(buttonData.outerBlockID);\n\t\t\t\tif (outerNode)\n\t\t\t\t{\n\t\t\t\t\tif (outerNode.offsetWidth < bodyNode.offsetWidth)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst innerNode = outerNode.querySelector(`div.${this.cssClass.postTextInner}`);\n\t\t\t\t\t\tinnerNode.style.overflowX = 'scroll';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.recalcPost({\n\t\t\t\tarPos: { height: bodyNode.offsetHeight},\n\t\t\t\tinformerBlock: (Type.isStringFilled(buttonData.informerBlockID) ? document.getElementById(buttonData.informerBlockID) : null)\n\t\t\t});\n\t\t\tobject.splice(index, 1);\n\t\t});\n\n\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\tif (!feedContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst onLoadImageList = feedContainer.querySelectorAll('[data-bx-onload=\"Y\"]');\n\t\tonLoadImageList.forEach((imageNode) => {\n\t\t\timageNode.addEventListener('load', (e) => {\n\n\t\t\t\tlet outerBlock = e.currentTarget.closest(`.${this.cssClass.comment}`);\n\t\t\t\tif (!outerBlock) // post\n\t\t\t\t{\n\t\t\t\t\touterBlock = e.currentTarget.closest(`.${this.cssClass.post}`);\n\t\t\t\t\tif (outerBlock)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst bodyBlock = outerBlock.querySelector(`.${this.cssClass.postTextInnerInner}`);\n\t\t\t\t\t\tif (bodyBlock)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.recalcPost({\n\t\t\t\t\t\t\t\tbodyBlock: bodyBlock,\n\t\t\t\t\t\t\t\tinformerBlock: outerBlock.querySelector(`.${this.cssClass.more}`),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\te.currentTarget.setAttribute('data-bx-onload', 'N');\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic recalcCommentsList()\n\t{\n\t\tEventEmitter.emit('OnUCMoreButtonListRecalc', new BaseEvent({\n\t\t\tcompatData: [],\n\t\t}));\n\t}\n\n\tstatic clearCommentsList()\n\t{\n\t\tEventEmitter.emit('OnUCMoreButtonListClear', new BaseEvent({\n\t\t\tcompatData: [],\n\t\t}));\n\t}\n\n\tstatic expand(textBlock)\n\t{\n\t\tif (!Type.isDomNode(textBlock))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst postBlock = textBlock.closest(`.${this.cssClass.post}`);\n\t\tif (!postBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpostBlock.classList.add(this.cssClass.postShort);\n\t\tpostBlock.classList.add(this.cssClass.postSeparator);\n\t}\n\n\t/*\n\tis not used actually by disk uf\n\t*/\n\tstatic lazyLoadCheckVisibility(image)\n\t{\n\t\tif (\n\t\t\t!Type.isPlainObject(image)\n\t\t\t|| !Type.isDomNode(image.node)\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst imageNode = image.node;\n\n\t\tlet textType = 'comment';\n\n\t\tlet textBlock = imageNode.closest(`.${this.cssClass.comment}`);\n\t\tif (!textBlock)\n\t\t{\n\t\t\ttextType = 'post';\n\t\t\ttextBlock = imageNode.closest(`.${this.cssClass.postText}`);\n\t\t}\n\n\t\tif (!textBlock)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst moreBlock = textBlock.querySelector(`div.${this.cssClass.more}`);\n\t\tif (\n\t\t\t!moreBlock\n\t\t\t|| moreBlock.style.display === 'none'\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn imageNode.parentNode.parentNode.offsetTop < (textType === 'comment' ? 220 : 270);\n\t}\n}\n","import {Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {MoreButton} from './morebutton';\n\nexport class Forum\n{\n\tstatic cssClass = {\n\t};\n\n\tstatic processSpoilerToggle(event: BaseEvent)\n\t{\n\t\tlet [ params ] = event.getCompatData();\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (!Type.isDomNode(params.node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst outerBlock = params.node.closest('.feed-post-block');\n\t\tif (!outerBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst bodyBlock = outerBlock.querySelector('.feed-post-text-block-inner-inner');\n\t\tif (!bodyBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst moreBlock = outerBlock.querySelector('.feed-post-text-more');\n\n\t\tMoreButton.recalcPost({\n\t\t\tbodyBlock: bodyBlock,\n\t\t\tinformerBlock: moreBlock,\n\t\t});\n\t}\n}\n","import {Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Loader} from './loader';\nimport {PageInstance} from './feed';\n\nclass Filter\n{\n\tconstructor()\n\t{\n\t\tthis.filterId = '';\n\t\tthis.filterApi = null;\n\t}\n\n\tinit(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (\n\t\t\tType.isStringFilled(params.filterId)\n\t\t\t&& !Type.isUndefined(BX.Main)\n\t\t\t&& !Type.isUndefined(BX.Main.filterManager)\n\t\t)\n\t\t{\n\t\t\tconst filterManager = BX.Main.filterManager.getById(params.filterId);\n\t\t\tthis.filterId = params.filterId;\n\n\t\t\tif(filterManager)\n\t\t\t{\n\t\t\t\tthis.filterApi = filterManager.getApi();\n\t\t\t}\n\t\t}\n\n\t\tthis.initEvents();\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:beforeApply', (event: BaseEvent) =>\n\t\t{\n\t\t\tLoader.showRefreshFade();\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:apply', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ filterValues, filterPromise, filterParams ] = event.getCompatData();\n\n\t\t\tif (typeof filterParams != 'undefined')\n\t\t\t{\n\t\t\t\tfilterParams.autoResolve = false;\n\t\t\t}\n\t\t\tPageInstance.refresh({\n\t\t\t\tuseBXMainFilter: 'Y',\n\t\t\t}, filterPromise);\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:searchInput', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ searchString ] = event.getCompatData();\n\n\t\t\tif (Type.isStringFilled(searchString))\n\t\t\t{\n\t\t\t\tLoader.showRefreshFade();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLoader.hideRefreshFade();\n\t\t\t}\n\t\t});\n\t}\n\n\tinitEventsCrm()\n\t{\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:searchInput', () => {\n\t\t\tPageInstance.refresh();\n\t\t});\n\t}\n\n\tclickTag(tagValue)\n\t{\n\t\tif (\n\t\t\t!Type.isStringFilled(tagValue)\n\t\t\t|| !this.filterApi\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.filterApi.setFields({\n\t\t\tTAG: tagValue\n\t\t});\n\t\tthis.filterApi.apply();\n\n\t\tif (\n\t\t\tType.isStringFilled(this.filterId)\n\t\t\t&& !Type.isUndefined(BX.Main)\n\t\t\t&& !Type.isUndefined(BX.Main.filterManager)\n\t\t)\n\t\t{\n\t\t\tconst filterContainer = document.getElementById(`${this.filterId}_filter_container`);\n\t\t\tif (\n\t\t\t\tfilterContainer\n\t\t\t\t&& BX.Main.filterManager.getById(this.filterId)\n\t\t\t\t&& (\n\t\t\t\t\tBX.Main.filterManager.getById(this.filterId).getSearch().getSquares().length > 0\n\t\t\t\t\t|| BX.Main.filterManager.getById(this.filterId).getSearch().getSearchString().length > 0\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst pagetitleContainer = filterContainer.closest('.pagetitle-wrap');\n\t\t\t\tif (pagetitleContainer)\n\t\t\t\t{\n\t\t\t\t\tpagetitleContainer.classList.add('pagetitle-wrap-filter-opened');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t(new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: { scroll: window.pageYOffset },\n\t\t\tfinish: { scroll: 0 },\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: (state) => {\n\t\t\t\twindow.scrollTo(0, state.scroll);\n\t\t\t},\n\t\t\tcomplete: () => {}\n\t\t})).animate();\n\n\t\treturn true;\n\t}\n}\n\nexport {\n\tFilter,\n};","import { ajax, Type, Loc, Dom, Tag } from 'main.core';\nimport { Popup } from 'main.popup';\n\nexport class ContentView\n{\n\tstatic registerAreaList()\n\t{\n\t\tvar\n\t\t\tcontainer = BX('log_internal_container'),\n\t\t\tfullContentArea = null;\n\n\t\tif (container)\n\t\t{\n\t\t\tvar viewAreaList = BX.findChildren(container, {\n\t\t\t\ttag: 'div',\n\t\t\t\tclassName: 'feed-post-contentview'\n\t\t\t}, true);\n\t\t\tfor (var i = 0, length = viewAreaList.length; i < length; i++)\n\t\t\t{\n\t\t\t\tif (viewAreaList[i].id.length > 0)\n\t\t\t\t{\n\t\t\t\t\tfullContentArea = BX.findChild(viewAreaList[i], {\n\t\t\t\t\t\ttag: 'div',\n\t\t\t\t\t\tclassName: 'feed-post-text-block-inner-inner'\n\t\t\t\t\t});\n\t\t\t\t\tBX.UserContentView.registerViewArea(viewAreaList[i].id, (fullContentArea ? fullContentArea : null));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","import { Loc, Type, ajax, Dom, Runtime, Uri, Event, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport {FeedInstance, PinnedPanelInstance, InformerInstance} from './feed';\nimport {Loader} from './loader';\nimport {MoreButton} from './morebutton';\nimport {ContentView} from './contentview';\n\nclass Page\n{\n\tconstructor()\n\t{\n\t\tthis.loadStarted = null;\n\t\tthis.stopTrackNextPage = null;\n\t\tthis.requestMode = null;\n\t\tthis.nextPageFirst = null;\n\t\tthis.nextPageUrl = null;\n\t\tthis.scrollInitialized = null;\n\t\tthis.firstPageLastTS = 0;\n\t\tthis.firstPageLastId = 0;\n\t\tthis.useBXMainFilter = 'N';\n\t\tthis.commentFormUID = '';\n\t\tthis.blogCommentFormUID = '';\n\n\t\tthis.signedParameters = '';\n\t\tthis.componentName = '';\n\n\t\tthis.class = {\n\t\t};\n\n\t\tEvent.ready(() => {\n\t\t\tthis.init();\n\t\t});\n\t}\n\n\tinit()\n\t{\n\t\tthis.loadStarted = false;\n\t\tthis.stopTrackNextPage = false;\n\t\tthis.requestMode = false;\n\t\tthis.nextPageFirst = true;\n\t\tthis.nextPageUrl = false;\n\t\tthis.scrollInitialized = false;\n\t}\n\n\trefresh(params, filterPromise)\n\t{\n\t\tif (this.loadStarted)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams = (\n\t\t\tType.isPlainObject(params)\n\t\t\t\t? params\n\t\t\t\t: {}\n\t\t);\n\n\t\tparams.siteTemplateId = Loc.getMessage('SONET_EXT_LIVEFEED_SITE_TEMPLATE_ID');\n\t\tparams.assetsCheckSum = Loc.getMessage('sonetLAssetsCheckSum');\n\n\t\tthis.loadStarted = true;\n\n\t\tLoader.showRefreshFade();\n\n\t\tMoreButton.clearCommentsList();\n\t\tFeedInstance.clearMoreButtons();\n\n\t\tif (Type.isStringFilled(this.commentFormUID))\n\t\t{\n\t\t\tparams.commentFormUID = this.commentFormUID;\n\t\t}\n\n\t\tif (\n\t\t\t!Type.isStringFilled(params.useBXMainFilter)\n\t\t\t|| params.useBXMainFilter !== 'Y'\n\t\t)\n\t\t{\n\t\t\tEventEmitter.emit('BX.Livefeed:refresh', new BaseEvent({\n\t\t\t\tcompatData: [],\n\t\t\t}));\n\t\t}\n\n\t\tInformerInstance.hideReloadNode();\n\t\tInformerInstance.lockCounterAnimation = true;\n\n\t\tthis.loadStarted = false;\n\n\t\tajax.runAction('socialnetwork.api.livefeed.refresh', {\n\t\t\tsignedParameters: this.getSignedParameters(),\n\t\t\tdata: {\n\t\t\t\tc: this.getComponentName(),\n\t\t\t\tlogajax: 'Y', // compatibility\n\t\t\t\tRELOAD: 'Y', // compatibility\n\t\t\t\tparams: params,\n\t\t\t}\n\t\t}).then((response) => {\n\n\t\t\tconst responseData = (Type.isPlainObject(response.data) ? response.data : {});\n\n\t\t\tthis.loadStarted = false;\n\t\t\tLoader.hideRefreshFade();\n\n\t\t\tif (filterPromise)\n\t\t\t{\n\t\t\t\tfilterPromise.fulfill();\n\t\t\t}\n\n\t\t\tconst emptyLivefeed = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& Type.isStringFilled(responseData.componentResult.EMPTY)\n\t\t\t\t\t? responseData.componentResult.EMPTY\n\t\t\t\t\t: 'N'\n\t\t\t);\n\t\t\tconst forcePageRefresh = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& Type.isStringFilled(responseData.componentResult.FORCE_PAGE_REFRESH)\n\t\t\t\t\t? responseData.componentResult.FORCE_PAGE_REFRESH\n\t\t\t\t\t: 'N'\n\t\t\t);\n\n\t\t\tif (forcePageRefresh === 'Y')\n\t\t\t{\n\t\t\t\ttop.window.location.reload();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\n\t\t\tInformerInstance.lockCounterAnimation = false;\n\n\t\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\t\tif (!feedContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.clean(feedContainer);\n\n\t\t\tconst emptyBlock = (\n\t\t\t\temptyLivefeed === 'Y'\n\t\t\t\t&& document.getElementById('feed-empty-wrap')\n\t\t\t\t\t? document.getElementById('feed-empty-wrap')\n\t\t\t\t\t: null\n\t\t\t);\n\n\t\t\tif (emptyBlock)\n\t\t\t{\n\t\t\t\tfeedContainer.appendChild(Dom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'feed-wrap',\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [ emptyBlock ],\n\t\t\t\t}));\n\t\t\t\temptyBlock.style.display = 'block';\n\n\t\t\t\tconst emptyTextNode = emptyBlock.querySelector('.feed-wrap-empty');\n\t\t\t\tif (emptyTextNode)\n\t\t\t\t{\n\t\t\t\t\temptyTextNode.innerHTML = Loc.getMessage('SONET_C30_T_EMPTY_SEARCH');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (loaderContainer)\n\t\t\t{\n\t\t\t\tfeedContainer.appendChild(loaderContainer);\n\t\t\t}\n\n\t\t\tif (responseData.html.length > 0)\n\t\t\t{\n\t\t\t\tthis.clearContainerExternal(false);\n\t\t\t\tBX.LazyLoad.clearImages();\n\n\t\t\t\tconst pageNode = Tag.render`<div id=\"content_block_${(Math.floor(Math.random() * 1000))}\" class=\"feed-wrap\" style=\"display: block;\">${responseData.html}</div>`;\n\n\t\t\t\tfeedContainer.appendChild(pageNode);\n\n\t\t\t\tRuntime.html(pageNode, responseData.html).then(() => {\n\t\t\t\t\tMoreButton.recalcPostsList()\n\t\t\t\t\tMoreButton.recalcCommentsList();\n\n\t\t\t\t\tContentView.registerAreaList();\n\n\t\t\t\t\tPinnedPanelInstance.resetFlags();\n\t\t\t\t\tPinnedPanelInstance.initPanel();\n\t\t\t\t\tPinnedPanelInstance.initPosts();\n\t\t\t\t});\n\n\t\t\t\tthis.stopTrackNextPage = false;\n\n\t\t\t\tMoreButton.clearCommentsList();\n\n\t\t\t\tconst informerWrap = InformerInstance.getWrap();\n\n\t\t\t\tif (\n\t\t\t\t\tinformerWrap\n\t\t\t\t\t&& informerWrap.classList.contains(InformerInstance.class.informerFixed)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\t(new BX.easing({\n\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\tstart: { scroll: window.pageYOffset },\n\t\t\t\t\t\tfinish: { scroll: 0 },\n\t\t\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\t\twindow.scrollTo(0, state.scroll);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\tEventEmitter.emit('onGoUp', []);\n\t\t\t\t\t\t}\n\t\t\t\t\t})).animate();\n\t\t\t\t}\n\t\t\t}\n\t\t}, () => {\n\n\t\t\tthis.loadStarted = false;\n\t\t\tif (filterPromise)\n\t\t\t{\n\t\t\t\tfilterPromise.reject();\n\t\t\t}\n\n\t\t\tLoader.hideRefreshFade();\n\t\t\tthis.showRefreshError();\n\t\t});\n\n\t\treturn false;\n\t}\n\n\tgetNextPage()\n\t{\n\t\tconst stubContainer = document.getElementById('feed-new-message-inf-wrap');\n\t\tconst stubFirstContainer = document.getElementById('feed-new-message-inf-wrap-first');\n\n\t\tif (this.loadStarted)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.loadStarted = true;\n\n\t\tInformerInstance.lockCounterAnimation = true;\n\t\tFeedInstance.clearMoreButtons();\n\n\t\tif (\n\t\t\t!this.nextPageFirst\n\t\t\t&& stubContainer\n\t\t)\n\t\t{\n\t\t\tstubContainer.style.display = 'block';\n\t\t}\n\t\telse if (\n\t\t\tthis.nextPageFirst\n\t\t\t&& stubFirstContainer\n\t\t)\n\t\t{\n\t\t\tstubFirstContainer.classList.add('feed-new-message-inf-wrap-first-visible');\n\t\t}\n\n\t\tconst nextUrlParamsList = (new Uri(this.getNextPageUrl())).getQueryParams();\n\t\tlet pageNumber = 1;\n\t\tlet prevPageLogId = '';\n\t\tlet ts = 0;\n\t\tlet noblog = 'N';\n\n\t\tObject.entries(nextUrlParamsList).forEach(([ key, value ]) => {\n\t\t\tif (key.match(/^PAGEN_(\\d+)$/i))\n\t\t\t{\n\t\t\t\tpageNumber = parseInt(value);\n\t\t\t}\n\t\t\telse if (key === 'pplogid')\n\t\t\t{\n\t\t\t\tprevPageLogId = decodeURI(value);\n\t\t\t}\n\t\t\telse if (key === 'ts')\n\t\t\t{\n\t\t\t\tts = value;\n\t\t\t}\n\t\t\telse if (key === 'noblog')\n\t\t\t{\n\t\t\t\tnoblog = value;\n\t\t\t}\n\t\t});\n\n\t\tconst queryParams = {\n\t\t\tPAGE_NUMBER: pageNumber,\n\t\t\tLAST_LOG_TIMESTAMP: ts,\n\t\t\tPREV_PAGE_LOG_ID: prevPageLogId,\n\t\t\tsiteTemplateId: Loc.getMessage('SONET_EXT_LIVEFEED_SITE_TEMPLATE_ID'),\n\t\t\tuseBXMainFilter: this.useBXMainFilter,\n\t\t\tpreset_filter_top_id: (Type.isStringFilled(nextUrlParamsList.preset_filter_top_id) && nextUrlParamsList.preset_filter_top_id !== '0' ? nextUrlParamsList.preset_filter_top_id : ''),\n\t\t\tpreset_filter_id: (Type.isStringFilled(nextUrlParamsList.preset_filter_id) && nextUrlParamsList.preset_filter_id !== '0' ? nextUrlParamsList.preset_filter_id : '')\n\t\t};\n\n\t\tif (Type.isStringFilled(this.commentFormUID))\n\t\t{\n\t\t\tqueryParams.commentFormUID = this.commentFormUID;\n\t\t}\n\n\t\tif (Type.isStringFilled(this.blogCommentFormUID))\n\t\t{\n\t\t\tqueryParams.blogCommentFormUID = this.blogCommentFormUID;\n\t\t}\n\n\t\tconst queryData = {\n\t\t\tc: this.getComponentName(),\n\t\t\tlogajax: 'Y', // compatibility with socialnetwork.blog.post.comment\n\t\t\tnoblog: noblog, // compatibility with socialnetwork.blog.post.comment\n\t\t\tparams: queryParams,\n\t\t};\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.CREATED_BY_ID))\n\t\t{\n\t\t\tqueryData.flt_created_by_id = parseInt(nextUrlParamsList.CREATED_BY_ID);\n\t\t}\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.flt_date_datesel))\n\t\t{\n\t\t\tqueryData.flt_date_datesel = nextUrlParamsList.flt_date_datesel;\n\t\t}\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.flt_date_from))\n\t\t{\n\t\t\tqueryData.flt_date_from = decodeURIComponent(nextUrlParamsList.flt_date_from);\n\t\t}\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.flt_date_to))\n\t\t{\n\t\t\tqueryData.flt_date_to = decodeURIComponent(nextUrlParamsList.flt_date_to);\n\t\t}\n\n\t\tajax.runAction('socialnetwork.api.livefeed.getNextPage', {\n\t\t\tsignedParameters: this.getSignedParameters(),\n\t\t\tdata: queryData,\n\t\t}).then((response) => {\n\t\t\tconst responseData = (Type.isPlainObject(response.data) ? response.data : {});\n\n\t\t\tthis.loadStarted = false;\n\n\t\t\tconst stubContainer = document.getElementById('feed-new-message-inf-wrap');\n\t\t\tif (stubContainer)\n\t\t\t{\n\t\t\t\tDom.clean(stubContainer);\n\t\t\t\tDom.remove(stubContainer)\n\t\t\t}\n\n\t\t\tInformerInstance.lockCounterAnimation = false;\n\n\t\t\tconst lastEntryTimestamp = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& !Type.isUndefined(responseData.componentResult.LAST_TS)\n\t\t\t\t\t? parseInt(responseData.componentResult.LAST_TS)\n\t\t\t\t\t: 0\n\t\t\t);\n\t\t\tconst lastEntryId = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& !Type.isUndefined(responseData.componentResult.LAST_ID)\n\t\t\t\t\t? parseInt(responseData.componentResult.LAST_ID)\n\t\t\t\t\t: null\n\t\t\t);\n\n\t\t\tif (\n\t\t\t\tresponseData.html.length > 0\n\t\t\t\t&& lastEntryTimestamp > 0\n\t\t\t\t&& (\n\t\t\t\t\tparseInt(this.firstPageLastTS) <= 0\n\t\t\t\t\t|| lastEntryTimestamp < parseInt(this.firstPageLastTS)\n\t\t\t\t\t|| (\n\t\t\t\t\t\tlastEntryTimestamp == parseInt(this.firstPageLastTS)\n\t\t\t\t\t\t&& !Type.isNull(lastEntryId)\n\t\t\t\t\t\t&& lastEntryId < parseInt(this.firstPageLastId)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tMoreButton.clearCommentsList();\n\n\t\t\t\tconst contentBlockId = `content_block_${(Math.floor(Math.random() * 1000))}`;\n\n\t\t\t\tconst pageNode = Tag.render`<div id=\"${contentBlockId}\" class=\"feed-wrap\" style=\"display:${(this.nextPageFirst ? 'none' : 'block')};\">${responseData.html}</div>`;\n\n\t\t\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\t\t\tif (!feedContainer)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfeedContainer.appendChild(pageNode);\n\n\t\t\t\tRuntime.html(pageNode, responseData.html).then(() => {\n\t\t\t\t\tif (pageNumber > 2)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.stopTrackNextPage = false;\n\t\t\t\t\t\tMoreButton.recalcPostsList();\n\t\t\t\t\t\tContentView.registerAreaList();\n\t\t\t\t\t\tMoreButton.recalcCommentsList();\n\t\t\t\t\t\tPinnedPanelInstance.resetFlags();\n\t\t\t\t\t\tPinnedPanelInstance.initPosts();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.clearContainerExternal(false);\n\n\t\t\t\tif (pageNumber === 2)\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById('feed-new-message-inf-text-first').style.display = 'block';\n\t\t\t\t\tdocument.getElementById('feed-new-message-inf-loader-first').style.display = 'none';\n\t\t\t\t\tstubFirstContainer.classList.add('feed-new-message-inf-wrap-first-active');\n\n\t\t\t\t\tconst f = () => {\n\n\t\t\t\t\t\tthis.stopTrackNextPage = false;\n\t\t\t\t\t\tif (pageNode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpageNode.style.display = 'block';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tEvent.unbind(document.getElementById('sonet_log_more_container_first'), 'click', f);\n\t\t\t\t\t\tstubFirstContainer.style.display = 'none';\n\t\t\t\t\t\tMoreButton.recalcPostsList()\n\t\t\t\t\t\tContentView.registerAreaList();\n\t\t\t\t\t\tMoreButton.recalcCommentsList();\n\n\t\t\t\t\t\tEventEmitter.emit('BX.Livefeed:recalculateComments', new BaseEvent({\n\t\t\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\t\t\trootNode: pageNode,\n\t\t\t\t\t\t\t}],\n\t\t\t\t\t\t}));\n\n\n\t\t\t\t\t\tPinnedPanelInstance.resetFlags();\n\t\t\t\t\t\tPinnedPanelInstance.initPosts();\n\t\t\t\t\t};\n\t\t\t\t\tEvent.bind(document.getElementById('sonet_log_more_container_first'), 'click', f);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (pageNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpageNode.style.display = 'block';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.nextPageFirst = false;\n\t\t\t}\n\n\t\t\telse if (document.getElementById('feed-new-message-inf-wrap-first'))\n\t\t\t{\n\t\t\t\tdocument.getElementById('feed-new-message-inf-wrap-first').style.display = 'none';\n\t\t\t}\n\t\t}, () => {\n\n\t\t\tthis.loadStarted = false;\n\t\t\tthis.stopTrackNextPage = false;\n\n\t\t\tconst stubContainer = document.getElementById('feed-new-message-inf-wrap');\n\t\t\tif (stubContainer)\n\t\t\t{\n\t\t\t\tstubContainer.style.display = 'none';\n\t\t\t}\n\n\t\t\tInformerInstance.lockCounterAnimation = false;\n\t\t\tthis.clearContainerExternal(false);\n\t\t});\n\n\t\treturn false;\n\t}\n\n\tclearContainerExternal(mode)\n\t{\n\t\tInformerInstance.hideWrapAnimation();\n\t\tInformerInstance.hideReloadAnimation();\n\t\tInformerInstance.recover();\n\n\t\tconst counterPreset = document.getElementById('sonet_log_counter_preset');\n\t\tif (\n\t\t\tcounterPreset\n\t\t\t&& this.requestMode === 'new'\n\t\t)\n\t\t{\n\t\t\tcounterPreset.style.display = 'none';\n\t\t}\n\t}\n\n\tclearContainerExternalNew()\n\t{\n\t\tthis.requestMode = 'new';\n\t}\n\n\tclearContainerExternalMore()\n\t{\n\t\tthis.requestMode = 'more';\n\t}\n\n\tshowRefreshError()\n\t{\n\t\tInformerInstance.lockCounterAnimation = false;\n\t\tthis.clearContainerExternal(false);\n\t}\n\tsetSignedParameters(value)\n\t{\n\t\tthis.signedParameters = value;\n\t}\n\tgetSignedParameters()\n\t{\n\t\treturn this.signedParameters;\n\t}\n\n\tsetComponentName(value)\n\t{\n\t\tthis.componentName = value;\n\t}\n\tgetComponentName()\n\t{\n\t\treturn this.componentName;\n\t}\n\n\tsetNextPageUrl(value)\n\t{\n\t\tthis.nextPageUrl = value;\n\t}\n\tgetNextPageUrl()\n\t{\n\t\treturn this.nextPageUrl;\n\t}\n\n\tinitScroll()\n\t{\n\t\tif (this.scrollInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.scrollInitialized = true;\n\t\tdocument.addEventListener('scroll', Runtime.throttle(this.onFeedScroll.bind(this), 100));\n\t}\n\n\tonFeedScroll()\n\t{\n\t\tif (!this.stopTrackNextPage)\n\t\t{\n\t\t\tconst maxScroll = (document.documentElement.scrollHeight - window.innerHeight) - 500;\n\t\t\tif (\n\t\t\t\twindow.pageYOffset >= maxScroll\n\t\t\t\t&& this.getNextPageUrl()\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.stopTrackNextPage = true;\n\t\t\t\tthis.getNextPage();\n\t\t\t}\n\t\t}\n\n\t\tInformerInstance.onFeedScroll();\n\t}\n}\n\nexport {\n\tPage\n};\n","import { Type, Tag, Loc, Runtime, Dom } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { ResultManager } from 'tasks.result';\n\nexport class CommentForm\n{\n\tstatic taskResultCommentsData = {};\n\n\tstatic appendTaskResultComments(data)\n\t{\n\t\tif (Type.isUndefined(ResultManager))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.taskResultCommentsData = Object.assign(this.taskResultCommentsData, data);\n\n\t\tObject.entries(this.taskResultCommentsData).forEach(([taskId, commentsIdList]) => {\n\t\t\tResultManager.getInstance().initResult({\n\t\t\t\ttaskId: parseInt(taskId),\n\t\t\t\tcommentIds: commentsIdList,\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic onAfterShow(obj, text, data)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tEventEmitter.emit('OnBeforeSocialnetworkCommentShowedUp', new BaseEvent({\n\t\t\tcompatData: [ 'socialnetwork' ],\n\t\t}));\n\n\t\tconst postData = {\n\t\t\tENTITY_XML_ID : obj.currentEntity.ENTITY_XML_ID,\n\t\t\tENTITY_TYPE : obj.currentEntity.ENTITY_XML_ID.split('_')[0],\n\t\t\tENTITY_ID : obj.currentEntity.ENTITY_XML_ID.split('_')[1],\n\t\t\tparentId : obj.id[1],\n\t\t\tcomment_post_id : obj.currentEntity.ENTITY_XML_ID.split('_')[1],\n\t\t\tedit_id : obj.id[1],\n\t\t\tact : (obj.id[1] > 0 ? 'edit' : 'add'),\n\t\t};\n\n\t\tObject.entries(postData).forEach(([key, value]) => {\n\t\t\tif (!obj.form[key])\n\t\t\t{\n\t\t\t\tobj.form.appendChild(Tag.render`<input type=\"hidden\" name=\"${key}\">`);\n\t\t\t}\n\t\t\tobj.form[key].value = value;\n\t\t});\n\n\t\tthis.onLightEditorShow(text, data);\n\n\t\tconst matches = obj.currentEntity.ENTITY_XML_ID.match(/^TASK_(\\d+)$/i);\n\t\tif (matches)\n\t\t{\n//console.log('show');\n\t\t}\n\t\telse\n\t\t{\n//console.log('hide');\n\t\t}\n\t}\n\n\tstatic onLightEditorShow(content, data)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tlet result = {};\n\n\t\tif (Type.isPlainObject(data.UF))\n\t\t{\n\t\t\tresult = data.UF;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (data.arFiles)\n\t\t\t{\n\t\t\t\tconst value = {};\n\n\t\t\t\tdata.arFiles.forEach((fileId, index) => {\n\t\t\t\t\tconst container = document.getElementById(`wdif-doc-${fileId}`);\n\n\t\t\t\t\tconst name = container.querySelector('.feed-com-file-name');\n\t\t\t\t\tconst size = container.querySelector('.feed-con-file-size');\n\n\t\t\t\t\tvalue[`F${index}`] = {\n\t\t\t\t\t\tFILE_ID: fileId,\n\t\t\t\t\t\tFILE_NAME: (name ? name.innerHTML : 'noname'),\n\t\t\t\t\t\tFILE_SIZE: (size ? size.innerHTML : 'unknown'),\n\t\t\t\t\t\tCONTENT_TYPE: 'notimage/xyz'\n\t\t\t\t\t};\n\t\t\t\t})\n\n\t\t\t\tresult.UF_SONET_COM_DOC = {\n\t\t\t\t\tUSER_TYPE_ID: 'file',\n\t\t\t\t\tFIELD_NAME: 'UF_SONET_COM_FILE[]',\n\t\t\t\t\tVALUE: value,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (data.arDocs)\n\t\t\t{\n\t\t\t\tresult.UF_SONET_COM_FILE = {\n\t\t\t\t\tUSER_TYPE_ID: 'webdav_element',\n\t\t\t\t\tFIELD_NAME: 'UF_SONET_COM_DOC[]',\n\t\t\t\t\tVALUE: Runtime.clone(data.arDocs),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (data.arDFiles)\n\t\t\t{\n\t\t\t\tresult.UF_SONET_COM_FILE = {\n\t\t\t\t\tUSER_TYPE_ID: 'disk_file',\n\t\t\t\t\tFIELD_NAME: 'UF_SONET_COM_DOC[]',\n\t\t\t\t\tVALUE: Runtime.clone(data.arDFiles)\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tLHEPostForm.reinitData(window.SLEC.editorId, content, result);\n\t}\n}\n","import {Type, Loc, ajax, Event, Dom, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {MenuManager} from 'main.popup';\n\nimport {PinnedPanel} from './pinned';\nimport {Post} from './post';\nimport {Informer} from './informer';\nimport {TaskCreator} from './taskcreator';\nimport {Loader} from './loader';\nimport {Forum} from './forum';\nimport {MoreButton} from './morebutton';\nimport {Filter} from './filter';\nimport {Page} from './page';\nimport {ContentView} from './contentview';\nimport {CommentForm} from './commentform';\n\nimport './css/feed.css';\nimport './css/gratitude.css';\nimport './css/important.css';\nimport './css/warning.css';\nimport './css/taskcreator.css';\n\nclass Feed\n{\n\tconstructor()\n\t{\n\t\tthis.entryData = {};\n\t\tthis.feedInitialized = false;\n\t\tthis.moreButtonDataList = [];\n\t}\n\n\tinitOnce(params)\n\t{\n\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (Type.isStringFilled(params.signedParameters))\n\t\t{\n\t\t\tPageInstance.setSignedParameters(params.signedParameters);\n\t\t}\n\n\t\tif (Type.isStringFilled(params.componentName))\n\t\t{\n\t\t\tPageInstance.setComponentName(params.componentName);\n\t\t}\n\n\t\tif (Type.isStringFilled(params.commentFormUID))\n\t\t{\n\t\t\tPageInstance.commentFormUID = params.commentFormUID;\n\t\t}\n\n\t\tif (loaderContainer)\n\t\t{\n\t\t\tEvent.bind(loaderContainer, 'animationend', Loader.onAnimationEnd)\n\t\t\tEvent.bind(loaderContainer, 'webkitAnimationEnd', Loader.onAnimationEnd)\n\t\t\tEvent.bind(loaderContainer, 'oanimationend', Loader.onAnimationEnd)\n\t\t\tEvent.bind(loaderContainer, 'MSAnimationEnd', Loader.onAnimationEnd)\n\t\t}\n\n\t\tEventEmitter.subscribe('BX.Forum.Spoiler:toggle', Forum.processSpoilerToggle);\n\n\t\tFilterInstance.init({\n\t\t\tfilterId: params.filterId,\n\t\t});\n\n\t\tif (\n\t\t\tType.isStringFilled(params.crmEntityTypeName)\n\t\t\t&& !Type.isUndefined(params.crmEntityId)\n\t\t\t&& parseInt(params.crmEntityId) > 0\n\t\t)\n\t\t{\n\t\t\tFilterInstance.initEventsCrm();\n\t\t}\n\n\t\tBX.UserContentView.init();\n\n\t\tdocument.getElementById('log_internal_container').addEventListener('click', (e) => {\n\t\t\tconst tagValue = e.target.getAttribute('bx-tag-value');\n\t\t\tif (!Type.isStringFilled(tagValue))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (FilterInstance.clickTag(tagValue))\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t}, true);\n\n\t\tconst noTasksNotificationCloseIcon = document.getElementById('feed-notification-notasks-close-btn');\n\t\tconst noTasksNotificationReadButton = document.getElementById('feed-notification-notasks-read-btn');\n\n\t\tif (noTasksNotificationCloseIcon)\n\t\t{\n\t\t\tEvent.bind(noTasksNotificationCloseIcon, 'click', this.setNoTasksNotificationRead.bind(this));\n\t\t}\n\t\tif (noTasksNotificationReadButton)\n\t\t{\n\t\t\tEvent.bind(noTasksNotificationReadButton, 'click', this.setNoTasksNotificationRead.bind(this));\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tif (this.feedInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tPinnedPanelInstance.init();\n\t\tInformerInstance.init();\n\n\t\tthis.feedInitialized = true;\n\t}\n\n\tchangeFollow(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (!logId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst followNode = document.getElementById('log_entry_follow_' + logId);\n\t\tconst valueOld = (followNode && followNode.getAttribute('data-follow') === 'Y' ? 'Y' : 'N');\n\t\tconst valueNew = (valueOld === 'Y' ? 'N' : 'Y');\n\n\t\tthis.renderFollow({\n\t\t\tlogId: logId,\n\t\t\tvalue: valueNew\n\t\t});\n\n\t\tajax.runAction('socialnetwork.api.livefeed.changeFollow', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: valueNew\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: (valueNew === 'Y' ? 'setFollow' : 'setUnfollow')\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tif (!response.data.success)\n\t\t\t{\n\t\t\t\tthis.renderFollow({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tvalue: valueOld\n\t\t\t\t});\n\t\t\t}\n\t\t}, () => {\n\t\t\tthis.renderFollow({\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: valueOld\n\t\t\t});\n\t\t});\n\n\t\treturn false;\n\t}\n\n\trenderFollow(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (!logId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst followNode = document.getElementById('log_entry_follow_' + logId);\n\t\tconst value = (params.value && params.value === 'Y' ? 'Y' : 'N');\n\n\t\tif (followNode)\n\t\t{\n\t\t\tfollowNode.setAttribute('data-follow', value);\n\t\t}\n\n\t\tconst textNode = (followNode ? followNode.querySelector('a') : null);\n\t\tif (textNode)\n\t\t{\n\t\t\ttextNode.innerHTML = Loc.getMessage('SONET_EXT_LIVEFEED_FOLLOW_TITLE_' + value);\n\t\t}\n\n\t\tconst postNode = (followNode ? followNode.closest('.feed-post-block') : null);\n\t\tif (postNode)\n\t\t{\n\t\t\tif (value === 'N')\n\t\t\t{\n\t\t\t\tpostNode.classList.add('feed-post-block-unfollowed');\n\t\t\t}\n\t\t\telse if (value === 'Y')\n\t\t\t{\n\t\t\t\tpostNode.classList.remove('feed-post-block-unfollowed');\n\t\t\t}\n\t\t}\n\t}\n\n\tchangeFavorites(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst event = (params.event ? params.event : null);\n\n\t\tlet node = (params.node ? params.node : null);\n\t\tlet newState = (params.newState ? params.newState : null);\n\n\t\tif (Type.isStringFilled(node))\n\t\t{\n\t\t\tnode = document.getElementById(node);\n\t\t}\n\n\t\tif (!logId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menuItem = null;\n\n\t\tif (event)\n\t\t{\n\t\t\tmenuItem = event.target;\n\t\t\tif (!menuItem.classList.contains('menu-popup-item-text'))\n\t\t\t{\n\t\t\t\tmenuItem = menuItem.querySelector('.menu-popup-item-text');\n\t\t\t}\n\t\t}\n\n\t\tlet nodeToAdjust = null;\n\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tnodeToAdjust = (\n\t\t\t\tnode.classList.contains('feed-post-important-switch')\n\t\t\t\t\t? node\n\t\t\t\t\t: node.querySelector('.feed-post-important-switch')\n\t\t\t);\n\t\t}\n\n\t\tif (typeof this.entryData[logId] == 'undefined')\n\t\t{\n\t\t\tthis.entryData[logId] = {};\n\t\t}\n\n\t\tif (typeof this.entryData[logId].favorites != 'undefined')\n\t\t{\n\t\t\tnewState = (this.entryData[logId].favorites ? 'N' : 'Y');\n\t\t\tthis.entryData[logId].favorites = !this.entryData[logId].favorites;\n\t\t}\n\t\telse if (nodeToAdjust)\n\t\t{\n\t\t\tnewState = (\n\t\t\t\tnodeToAdjust.classList.contains('feed-post-important-switch-active')\n\t\t\t\t\t? 'N'\n\t\t\t\t\t: 'Y'\n\t\t\t);\n\t\t\tthis.entryData[logId].favorites = (newState == 'Y');\n\t\t}\n\n\t\tif (!newState)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.adjustFavoritesControlItem(nodeToAdjust, newState);\n\t\tthis.adjustFavoritesMenuItem(menuItem, newState);\n\n\t\tajax.runAction('socialnetwork.api.livefeed.changeFavorites', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: newState,\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: (newState == 'Y' ? 'addFavorites' : 'removeFavorites')\n\t\t\t}\n\t\t}).then(response =>\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isStringFilled(response.data.newValue)\n\t\t\t\t&& ['Y', 'N'].includes(response.data.newValue)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.entryData[logId].favorites = (response.data.newValue == 'Y');\n\t\t\t}\n\n\t\t\tthis.adjustFavoritesControlItem(nodeToAdjust, response.data.newValue);\n\t\t\tthis.adjustFavoritesMenuItem(menuItem, response.data.newValue);\n\n\t\t}, () => {\n\t\t\tthis.entryData[logId].favorites = !this.entryData[logId].favorites;\n\t\t});\n\t}\n\n\tadjustFavoritesMenuItem(menuItemNode, state)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(menuItemNode)\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tmenuItemNode.innerHTML = this.getMenuTitle(state === 'Y');\n\t}\n\n\tadjustFavoritesControlItem(node, state)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(node)\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnode.title = this.getMenuTitle(state === 'Y');\n\t\tif (state == 'Y')\n\t\t{\n\t\t\tnode.classList.add('feed-post-important-switch-active');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.classList.remove('feed-post-important-switch-active');\n\t\t}\n\t}\n\n\tgetMenuTitle(state: boolean): string\n\t{\n\t\treturn Loc.getMessage(`SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_${state ? 'Y' : 'N'}`);\n\t}\n\n\tdelete(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst node = (Type.isStringFilled(params.nodeId) ? document.getElementById(params.nodeId) : null);\n\t\tconst ind = (params.ind ? params.ind : '');\n\n\t\tif (\n\t\t\tlogId <= 0\n\t\t\t|| !node\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction('socialnetwork.api.livefeed.deleteEntry', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: 'deleteLogEntry',\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tif (response.data.success)\n\t\t\t{\n\t\t\t\tif (!Type.isUndefined(ind))\n\t\t\t\t{\n\t\t\t\t\tMenuManager.destroy(Post.getMenuId(ind));\n\t\t\t\t}\n\t\t\t\tthis.deleteSuccess(node);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.deleteFailure(node);\n\t\t\t}\n\t\t}, () => {\n\t\t\tthis.deleteFailure(node);\n\t\t});\n\t}\n\n\tdeleteSuccess(node)\n\t{\n\t\tif (!Type.isDomNode(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t(new BX.fx({\n\t\t\ttime: 0.5,\n\t\t\tstep: 0.05,\n\t\t\ttype: 'linear',\n\t\t\tstart: node.offsetHeight,\n\t\t\tfinish: 56,\n\t\t\tcallback: (height) => {\n\t\t\t\tnode.style.height = `${height}px`;\n\t\t\t},\n\t\t\tcallback_start: () => {\n\t\t\t\tnode.style.overflow = 'hidden';\n\t\t\t\tnode.style.minHeight = 0;\n\t\t\t},\n\t\t\tcallback_complete: () => {\n\t\t\t\tnode.style.marginBottom = 0;\n\t\t\t\tDom.clean(node);\n\t\t\t\tnode.classList.add('feed-post-block-deleted');\n\t\t\t\tnode.appendChild(Tag.render`<div class=\"feed-add-successfully\"><span class=\"feed-add-info-text\"><span class=\"feed-add-info-icon\"></span><span>${Loc.getMessage('SONET_EXT_LIVEFEED_DELETE_SUCCESS')}</span></span></span></div>`);\n\t\t\t}\n\t\t})).start();\n\t}\n\n\tdeleteFailure(node)\n\t{\n\t\tif (!Type.isDomNode(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnode.insertBefore(Tag.render`<div class=\"feed-add-error\" style=\"margin: 18px 37px 4px 84px;\"><span class=\"feed-add-info-text\"><span class=\"feed-add-info-icon\"></span><span>${Loc.getMessage('sonetLMenuDeleteFailure')}</span></span></div>`, node.firstChild);\n\t}\n\n\tgetMoreButtons()\n\t{\n\t\treturn this.moreButtonDataList;\n\t}\n\n\tclearMoreButtons()\n\t{\n\t\tthis.moreButtonDataList = [];\n\t}\n\n\taddMoreButton(data)\n\t{\n\t\tthis.moreButtonDataList.push(data);\n\t}\n\n\tsetNoTasksNotificationRead(event)\n\t{\n\t\tconst notificationNode = event.currentTarget.closest('.feed-notification-container');\n\t\tif (!notificationNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction('socialnetwork.api.livefeed.readNoTasksNotification', {\n\t\t\tdata: {}\n\t\t}).then((response) => {\n\t\t\tif (!response.data.success)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnotificationNode.style.height = notificationNode.offsetHeight + 'px';\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnotificationNode.classList.add('feed-notification-container-collapsed');\n\t\t\t}, 10);\n\t\t\tsetTimeout(() => {\n\t\t\t\tnotificationNode.parentNode.removeChild(notificationNode);\n\t\t\t}, 250);\n\n\t\t}, () => {});\n\t}\n\n}\n\nconst FeedInstance = new Feed();\nconst PinnedPanelInstance = new PinnedPanel();\nconst InformerInstance = new Informer();\nconst FilterInstance = new Filter();\nconst PageInstance = new Page();\nnew TaskCreator();\n\nexport {\n\tFeedInstance,\n\tPinnedPanelInstance,\n\tInformerInstance,\n\tFilterInstance,\n\tPageInstance,\n\tPost,\n\tTaskCreator,\n\tLoader,\n\tMoreButton,\n\tContentView,\n\tCommentForm,\n};\n"],"names":["Utils","node","styles","Object","entries","forEach","key","value","style","PinnedPanel","class","pin","post","postHide","postComments","postPinned","postPinnedHide","postPinActive","postUnfollowed","postExpanding","panelCollapsed","panelNonEmpty","panelPosts","collapsedPanel","collapsedPanelExpand","collapsedPanelCounterPostsValue","collapsedPanelCounterComments","collapsedPanelCounterCommentsValue","collapsedPanelCounterCommentsShown","collapsedPanelCounterCommentsValueNew","collapsedPanelCounterCommentsValueNewValue","collapsedPanelCounterCommentsValueNewActive","collapsedPanelCounterCommentsValueOld","collapsedPanelCounterCommentsValueAll","collapsedPanelShow","collapsedPanelHide","cancelPanel","cancelPanelButton","cancelPanelLabel","panelInitialized","postsInitialized","handlePostClick","bind","options","Event","ready","initPosts","initPanel","initEvents","optionName","pinnedPanelNode","getPanelNode","adjustCollapsedPostsPanel","getCollapsedPanelNode","collapsedHeight","offsetHeight","setStyle","height","transition","setTimeout","hideCollapsedPanel","event","likeClicked","target","classList","contains","closest","followClicked","menuClicked","contentViewClicked","pinClicked","collapseClicked","commentsClicked","postNode","remove","menuId","getAttribute","MenuManager","destroy","BaseEvent","compatData","rootNode","data","EventEmitter","emit","anchorNode","querySelector","position","Dom","getPosition","window","scrollTo","top","stopPropagation","preventDefault","add","postList","document","querySelectorAll","length","Array","from","unbind","newState","logId","parseInt","changePinned","then","subscribe","getData","xmlId","id","getCommentsData","oldValue","newValue","new","setCommentsData","Type","isInteger","incrementMaxListeners","params","commentId","allValue","follow","commentsData","AUTHOR","ID","BX","message","panelNode","Promise","resolve","reject","getOption","setPostState","state","ajax","runAction","analyticsLabel","b24statAction","response","success","movePost","includes","setAttribute","Loc","getMessage","postToMove","parentNode","originalPostHeight","getPinnedData","pinnedPanelTitleNode","pinnedPanelDescriptionNode","pinnedPanelPinNode","innerHTML","TITLE","DESCRIPTION","title","cancelPinnedPanel","getCancelPinnedPanel","anchor","nextSibling","insertBefore","centerCancelPinnedPanelElements","cancelPanelHeight","width","backgroundColor","opacity","setOptions","panelHeight","pinBlocked","unbindAll","checkTransitionProperty","panelPostsNode","firstChild","adjustPanel","showCollapsedPostsPanel","pinnedHeight","scrollHeight","isDomNode","requestAnimationFrame","collapsed","showCollapsed","hideCollapsedPostsPanel","transform","display","animateCancel","marginBottom","Tag","render","marginLeft","getBoundingClientRect","getElementsByClassName","reduce","count","item","map","currentIndex","originalItemsList","postsCounter","getPostsCount","postsCounterNode","commentsCounterNode","commentsCounterValueNode","newCommentCounter","acc","showCollapsedPanel","hidePinnedItems","removeCollapsedPanel","showPinnedItems","animateCollapsedPanel","result","newNode","newValueNode","oldNode","allNode","isStringFilled","commentsNode","newPinnedCommentsNode","newValuePinnedCommentsNode","oldPinnedCommentsNode","allPinnedCommentsNode","getCommentsNodes","newCommentsValue","oldCommentsValue","allCommentsValue","matches","match","propertyName","TaskCreator","getCompatData","type","isPlainObject","isBoolean","STAY_AT_PAGE","signedFiles","sliderInstance","getTarget","sliderUrl","getUrl","entityType","entityId","postEntityType","entityData","SUFFIX","requestData","formatTaskDescription","URL","parentTaskId","PARENT_ID","UF_TASK_WEBDAV_FILES_SIGN","link","SidePanel","Instance","open","requestMethod","requestParams","cacheable","createTaskPopup","Popup","autoHide","zIndex","offsetLeft","offsetTop","overlay","lightShadow","closeIcon","right","draggable","restrict","closeByEsc","contentColor","contentNoPaddings","buttons","content","cssClass","popupContent","events","onAfterPopupShow","createTaskSetContent","popupTitle","isNumber","additionalParams","getSonetGroupAvailable","getLivefeedUrl","checkPermissions","feature","operation","entryTitle","entryDescription","entryDiskObjects","DISK_OBJECTS","entryUrl","LIVEFEED_URL","entrySuffix","groupsAvailable","GROUPS_AVAILABLE","isUndefined","LOG_ID","taskDescription","taskData","RESPONSIBLE_ID","CREATED_BY","UF_TASK_WEBDAV_FILES","sonetGroupIdList","push","GROUP_ID","Tasks","Util","Query","runOnce","resultData","DATA","createTaskSetContentSuccess","sourceEntityType","sourceEntityId","createTaskSetContentFailure","getErrors","getMessages","onPopupClose","show","taskId","taskLink","replace","UI","Notification","Center","notify","actions","click","balloon","action","close","errors","popupDescription","join","contentNode","containerNode","getElementById","clean","appendChild","livefeedUrl","suffix","Post","urlToEdit","menuPopupWindow","dialog","bindOnResize","titleBar","className","Button","text","location","menuElement","ind","getMenuId","log_id","bFavorites","arMenuItemsAdditional","JSON","parse","e","bindElement","itemPinned","pinnedPostNode","pinnedState","onclick","PinnedPanelInstance","getMenuById","popupWindow","itemFavorites","__logChangeFavorites","arItems","html","href","menuItemText","menuItemIconDone","clipboard","isCopySupported","copy","adjust","attrs","it","currentTarget","pos","pos2","pos3","overflow","children","create","select","fx","time","step","start","finish","callback","hide","confirm","FeedInstance","delete","nodeId","entryEntityType","isArray","concat","arParams","angle","offset","onPopupShow","ob","favoritesMenuItem","menuItems","contentContainer","menuItem","linkMenuItem","popupContainer","Informer","container","wrap","plus","currentSiteId","currentCounterType","counterDecrementStack","counterValue","lockCounterAnimation","informerFixed","informerAnimation","informerFixedAnimation","counterText","counterContainer","reloadContainer","icon","iconRotating","plusHidden","initNodes","addEventListener","showReloadAnimation","unfixWrap","command","changeCounter","Runtime","clone","arCount","isObjectLike","live","decrementCounter","valueToShow","changeAnimate","counter","zeroCounterFromDb","counterTextNode","reloadNode","showWrapAnimation","hideReloadAnimation","hideWrapAnimation","visibility","counterWaiterNode","counterNodeWaiter","counterRect","left","fixWrap","counterContainerNode","hideReloadNode","reloadContainerNode","Loader","feedContainer","feedMask","feedNoMask","loaderContainer","hideLoader","showLoader","animationName","MoreButton","informerBlock","blockHeight","arPos","bodyBlock","postBlock","postShort","postSeparator","buttonsList","getMoreButtons","buttonData","index","object","bodyBlockID","bodyNode","outerBlockID","outerNode","offsetWidth","innerNode","postTextInner","overflowX","recalcPost","informerBlockID","splice","onLoadImageList","imageNode","outerBlock","comment","postTextInnerInner","more","textBlock","image","textType","postText","moreBlock","Forum","Filter","filterId","filterApi","Main","filterManager","getById","getApi","showRefreshFade","filterValues","filterPromise","filterParams","autoResolve","PageInstance","refresh","useBXMainFilter","searchString","hideRefreshFade","tagValue","setFields","TAG","apply","filterContainer","getSearch","getSquares","getSearchString","pagetitleContainer","easing","duration","scroll","pageYOffset","makeEaseOut","transitions","quart","complete","animate","ContentView","fullContentArea","viewAreaList","findChildren","tag","i","findChild","UserContentView","registerViewArea","Page","loadStarted","stopTrackNextPage","requestMode","nextPageFirst","nextPageUrl","scrollInitialized","firstPageLastTS","firstPageLastId","commentFormUID","blogCommentFormUID","signedParameters","componentName","init","siteTemplateId","assetsCheckSum","clearCommentsList","clearMoreButtons","InformerInstance","getSignedParameters","c","getComponentName","logajax","RELOAD","responseData","fulfill","emptyLivefeed","componentResult","EMPTY","forcePageRefresh","FORCE_PAGE_REFRESH","reload","emptyBlock","props","emptyTextNode","clearContainerExternal","LazyLoad","clearImages","pageNode","Math","floor","random","recalcPostsList","recalcCommentsList","registerAreaList","resetFlags","informerWrap","getWrap","showRefreshError","stubContainer","stubFirstContainer","nextUrlParamsList","Uri","getNextPageUrl","getQueryParams","pageNumber","prevPageLogId","ts","noblog","decodeURI","queryParams","PAGE_NUMBER","LAST_LOG_TIMESTAMP","PREV_PAGE_LOG_ID","preset_filter_top_id","preset_filter_id","queryData","CREATED_BY_ID","flt_created_by_id","flt_date_datesel","flt_date_from","decodeURIComponent","flt_date_to","lastEntryTimestamp","LAST_TS","lastEntryId","LAST_ID","isNull","contentBlockId","f","mode","recover","counterPreset","throttle","onFeedScroll","maxScroll","documentElement","innerHeight","getNextPage","CommentForm","ResultManager","taskResultCommentsData","assign","commentsIdList","getInstance","initResult","commentIds","obj","postData","ENTITY_XML_ID","currentEntity","ENTITY_TYPE","split","ENTITY_ID","parentId","comment_post_id","edit_id","act","form","onLightEditorShow","UF","arFiles","fileId","name","size","FILE_ID","FILE_NAME","FILE_SIZE","CONTENT_TYPE","UF_SONET_COM_DOC","USER_TYPE_ID","FIELD_NAME","VALUE","arDocs","UF_SONET_COM_FILE","arDFiles","LHEPostForm","reinitData","SLEC","editorId","Feed","entryData","feedInitialized","moreButtonDataList","setSignedParameters","setComponentName","onAnimationEnd","processSpoilerToggle","FilterInstance","crmEntityTypeName","crmEntityId","initEventsCrm","clickTag","noTasksNotificationCloseIcon","noTasksNotificationReadButton","setNoTasksNotificationRead","followNode","valueOld","valueNew","renderFollow","textNode","nodeToAdjust","favorites","adjustFavoritesControlItem","adjustFavoritesMenuItem","menuItemNode","getMenuTitle","deleteSuccess","deleteFailure","callback_start","minHeight","callback_complete","notificationNode","removeChild"],"mappings":"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"}