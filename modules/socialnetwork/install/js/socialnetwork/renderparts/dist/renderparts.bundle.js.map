{"version":3,"file":"renderparts.bundle.js","sources":["../src/index.js"],"sourcesContent":["import {Type, Loc, Dom} from 'main.core';\nimport {CommentRenderer} from 'tasks.comment-renderer';\n\nexport class RenderParts\n{\n\tstatic currentUserSonetGroupIdList = [];\n\tstatic mobile: false;\n\tstatic publicSection: false;\n\tstatic currentExtranetUser: false;\n\tstatic availableUsersList: [];\n\n\tstatic init(params)\n\t{\n\t\tif (!Type.isUndefined(params.currentUserSonetGroupIdList))\n\t\t{\n\t\t\tthis.currentUserSonetGroupIdList = params.currentUserSonetGroupIdList;\n\t\t}\n\t\tif (!Type.isUndefined(params.publicSection))\n\t\t{\n\t\t\tthis.publicSection = !!params.publicSection;\n\t\t}\n\t\tthis.mobile = !!params.mobile;\n\n\t\tif (!Type.isUndefined(params.currentExtranetUser))\n\t\t{\n\t\t\tthis.currentExtranetUser = !!params.currentExtranetUser;\n\t\t}\n\n\t\tif (this.currentExtranetUser)\n\t\t{\n\t\t\tif (Type.isPlainObject(params.availableUsersList))\n\t\t\t{\n\t\t\t\tparams.availableUsersList = Object.entries(params.availableUsersList).map(([key, value]) => value);\n\t\t\t}\n\n\t\t\tif (Type.isArray(params.availableUsersList))\n\t\t\t{\n\t\t\t\tthis.availableUsersList = params.availableUsersList.map(value => parseInt(value)).filter(value => !Type.isNil(value));\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getNodeSG(entity)\n\t{\n\t\tconst hidden = (\n\t\t\tType.isStringFilled(entity.VISIBILITY)\n\t\t\t&& entity.VISIBILITY === 'group_members'\n\t\t\t&& !this.currentUserSonetGroupIdList.includes(entity.ENTITY_ID)\n\t\t);\n\n\t\tif (hidden)\n\t\t{\n\t\t\treturn this.getNodeHiddenDestination();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn (\n\t\t\t\t!this.mobile\n\t\t\t\t\t? Dom.create('a', {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t\t})\n\t\t\t\t\t: Dom.create('span', {\n\t\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\tstatic getNodeU(entity)\n\t{\n\t\tconst hidden = (\n\t\t\tthis.currentExtranetUser\n\t\t\t&& !this.availableUsersList.includes(entity.ENTITY_ID)\n\t\t);\n\n\t\tif (hidden)\n\t\t{\n\t\t\treturn this.getNodeHiddenDestination();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst classesList = [\n\t\t\t\t'blog-p-user-name',\n\t\t\t];\n\n\t\t\tif (entity.VISIBILITY === 'extranet')\n\t\t\t{\n\t\t\t\tclassesList.push('blog-p-user-name-extranet');\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\t!this.mobile\n\t\t\t\t\t? Dom.create('a', {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: classesList.join(' '),\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: entity.NAME\n\t\t\t\t\t})\n\t\t\t\t\t: Dom.create('a', {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\tstatic getNodeDR(entity)\n\t{\n\t\treturn (\n\t\t\t!this.mobile\n\t\t\t\t? Dom.create('a', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t},\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t\t\t: Dom.create('span', {\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic getNodeTask(entity)\n\t{\n\t\treturn (\n\t\t\t!this.mobile\n\t\t\t&& !this.publicSection\n\t\t\t&& entity.LINK.length > 0\n\t\t\t&& typeof entity.VISIBILITY != 'undefined'\n\t\t\t&& typeof entity.VISIBILITY.userId != 'undefined'\n\t\t\t&& parseInt(entity.VISIBILITY.userId) == parseInt(Loc.getMessage('USER_ID'))\n\t\t\t\t? Dom.create('a', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t},\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t\t\t: Dom.create('span', {\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic getNodePost(entity)\n\t{\n\t\treturn (\n\t\t\t!this.mobile\n\t\t\t&& !this.publicSection\n\t\t\t&& entity.LINK.length > 0\n\t\t\t&& Type.isPlainObject(entity.VISIBILITY)\n\t\t\t&& entity.VISIBILITY.available === true\n\n\t\t\t\t? Dom.create('a', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\ttarget: '_blank'\n\t\t\t\t\t},\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t\t\t: Dom.create('span', {\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic getNodeCalendarEvent(entity)\n\t{\n\t\treturn (\n\t\t\t!this.mobile\n\t\t\t&& !this.publicSection\n\t\t\t&& entity.LINK.length > 0\n\t\t\t&& Type.isPlainObject(entity.VISIBILITY)\n\t\t\t&& entity.VISIBILITY.available === true\n\t\t\t\t? Dom.create('a', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t},\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t\t\t: Dom.create('span', {\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic getNodeUA()\n\t{\n\t\treturn Dom.create('span', {\n\t\t\ttext: Loc.getMessage('SONET_RENDERPARTS_JS_DESTINATION_ALL'),\n\t\t});\n\t}\n\n\tstatic getNodeHiddenDestination()\n\t{\n\t\treturn Dom.create('span', {\n\t\t\ttext: Loc.getMessage('SONET_RENDERPARTS_JS_HIDDEN'),\n\t\t});\n\t}\n\n\tstatic getTaskCommentPart(entity): string\n\t{\n\t\treturn CommentRenderer.getCommentPart(entity);\n\t}\n}\n"],"names":["RenderParts","params","Type","isUndefined","currentUserSonetGroupIdList","publicSection","mobile","currentExtranetUser","isPlainObject","availableUsersList","Object","entries","map","key","value","isArray","parseInt","filter","isNil","entity","hidden","isStringFilled","VISIBILITY","includes","ENTITY_ID","getNodeHiddenDestination","Dom","create","attrs","href","LINK","target","text","NAME","classesList","push","props","className","join","length","userId","Loc","getMessage","available","CommentRenderer","getCommentPart"],"mappings":"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"}