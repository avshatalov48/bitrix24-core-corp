this.BX=this.BX||{};this.BX.SocialNetwork=this.BX.SocialNetwork||{};(function(e,t,a,i){"use strict";var r,n,s,l,o;var c=function(e){babelHelpers.inherits(i,e);function i(e,t){var a;babelHelpers.classCallCheck(this,i);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this,e,t));a.handleDialogDestroy=a.handleDialogDestroy.bind(babelHelpers.assertThisInitialized(a));a.handleSliderMessage=a.handleSliderMessage.bind(babelHelpers.assertThisInitialized(a));a.bindEvents();return a}babelHelpers.createClass(i,[{key:"getContent",value:function e(){var a=this;return this.cache.remember("content",function(){var e=a.getOption("inviteEmployeeLink");var i=a.getOption("inviteGuestLink");var s=a.getOption("createProjectLink");var l={111:"SOCNET_ENTITY_SELECTOR_EMPLOYEE_OR_PROJECT_OR_GUEST",110:"SOCNET_ENTITY_SELECTOR_INVITE_EMPLOYEE_OR_GUEST",101:"SOCNET_ENTITY_SELECTOR_EMPLOYEE_OR_PROJECT","011":"SOCNET_ENTITY_SELECTOR_PROJECT_OR_GUEST"};var o=Number(Boolean(e)).toString()+Number(Boolean(i)).toString()+Number(Boolean(s)).toString();var c=l[o]?l[o]:null;if(c){var g=t.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(["<div>","</div>"])),t.Loc.getMessage(c));var d=g.querySelector("employee");var u=g.querySelector("guest");var v=g.querySelector("project");var E=Array.from(g.querySelectorAll("span"));var h=Array.from(g.children).find(function(e){return[d,u,v].includes(e)});var T=d&&u&&v;if(d){var f=!T&&h===d;g.replaceChild(a.createInviteEmployeeLink(d.innerHTML,f),d)}if(u){var p=!T&&h===u;var S=a.createInviteGuestLink(u.innerHTML,p);g.replaceChild(S,u);a.createHint(S)}if(v){var b=!T&&h===v;g.replaceChild(a.createProjectLink(v.innerHTML,b),v)}E.forEach(function(e){g.replaceChild(t.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['<span class="ui-selector-footer-conjunction">',"</span>"])),e.innerHTML),e)});var I=document.createDocumentFragment();Array.from(g.childNodes).forEach(function(e){I.appendChild(e)});return I}else if(e){return a.createInviteEmployeeLink(t.Loc.getMessage("SOCNET_ENTITY_SELECTOR_INVITE_EMPLOYEE"),true)}else if(i){var y=a.createInviteGuestLink(t.Loc.getMessage("SOCNET_ENTITY_SELECTOR_INVITE_GUEST"),true);a.createHint(y);return y}else if(s){return a.createProjectLink(t.Loc.getMessage("SOCNET_ENTITY_SELECTOR_CREATE_PROJECT"),true)}return null})}},{key:"createInviteEmployeeLink",value:function e(a,i){var r="ui-selector-footer-link".concat(i?" ui-selector-footer-link-add":"");return t.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<span class="','" onclick="','">',"</span>\n\t\t"])),r,this.handleInviteEmployeeClick.bind(this),a)}},{key:"createInviteGuestLink",value:function e(a,i){var r="ui-selector-footer-link".concat(i?" ui-selector-footer-link-add":"");return t.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<span class="','" onclick="','">',"</span>\n\t\t"])),r,this.handleInviteGuestClick.bind(this),a)}},{key:"createProjectLink",value:function e(a,i){var r="ui-selector-footer-link".concat(i?" ui-selector-footer-link-add":"");return t.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<span class="','" onclick="','">',"</span>\n\t\t"])),r,this.handleCreateProjectClick.bind(this),a)}},{key:"createHint",value:function e(a){t.Runtime.loadExtension("ui.hint").then(function(){var e=BX.UI.Hint.createInstance();var i=e.createNode(t.Loc.getMessage("SOCNET_ENTITY_SELECTOR_INVITED_GUEST_HINT"));t.Dom.insertAfter(i,a)})}},{key:"handleInviteEmployeeClick",value:function e(){var a=this.getOption("inviteEmployeeLink");if(t.Type.isStringFilled(a)){var i=this.getDialog().getEntity("user");var r=i.getOptions()||{};BX.SidePanel.Instance.open(a,{allowChangeHistory:false,cacheable:false,requestMethod:"post",requestParams:{componentParams:JSON.stringify({USER_OPTIONS:r})},data:{entitySelectorId:this.getDialog().getId()}})}}},{key:"handleInviteGuestClick",value:function e(){var a=this.getOption("inviteGuestLink");if(t.Type.isStringFilled(a)){var i=this.getDialog().getEntity("user");var r=i.getOptions()||{};var n=[];var s=this.getDialog().getTagSelectorQuery();if(t.Validation.isEmail(s)){n.push({email:s})}BX.SidePanel.Instance.open(a,{width:1200,allowChangeHistory:false,cacheable:false,requestMethod:"post",requestParams:{componentParams:JSON.stringify({USER_OPTIONS:r,ROWS:n})},data:{entitySelectorId:this.getDialog().getId()}})}}},{key:"handleCreateProjectClick",value:function e(){var a=this.getOption("createProjectLink");if(t.Type.isStringFilled(a)){var i=this.getDialog().getEntity("project");var r=i.getOptions()||{};BX.SidePanel.Instance.open(a,{allowChangeHistory:false,cacheable:false,requestMethod:"post",requestParams:{PROJECT_OPTIONS:r,refresh:"N"},data:{entitySelectorId:this.getDialog().getId()}})}}},{key:"bindEvents",value:function e(){this.getDialog().subscribe("onDestroy",this.handleDialogDestroy);a.EventEmitter.subscribe("SidePanel.Slider:onMessage",this.handleSliderMessage)}},{key:"unbindEvents",value:function e(){this.getDialog().unsubscribe("onDestroy",this.handleDialogDestroy);a.EventEmitter.unsubscribe("SidePanel.Slider:onMessage",this.handleSliderMessage)}},{key:"handleDialogDestroy",value:function e(){this.unbindEvents()}},{key:"handleSliderMessage",value:function e(t){var a=t.getData(),i=babelHelpers.slicedToArray(a,1),r=i[0];var n=r.getSender();if(n.getData().get("entitySelectorId")!==this.getDialog().getId()){return}if(r.getEventId()==="BX.Intranet.Invitation:onAdd"||r.getEventId()==="BX.Intranet.Invitation.Guest:onAdd"){var s=r.getData(),l=s.users;this.addUsers(l)}if(r.getEventId()==="BX.Socialnetwork.Workgroup:onAdd"){var o=r.getData(),c=o.projects;this.addProjects(c)}}},{key:"addUsers",value:function e(a){var i=this;if(!t.Type.isArrayFilled(a)){return}var r=this.getDialog().getRecentTab()||this.getDialog().getTab("invited-users");if(!r){r=this.getDialog().addTab(this.createInvitedUsersTab())}a.forEach(function(e){if(!t.Type.isPlainObject(e)){return}var a=i.getDialog().addItem(Object.assign({},e,{tabs:r.getId(),sort:2}));if(a){a.select()}});this.getDialog().selectTab(r.getId())}},{key:"addProjects",value:function e(a){var i=this;if(!t.Type.isArrayFilled(a)){return}var r=this.getDialog().getRecentTab()||this.getDialog().getTab("projects");var n=r?r.getId():null;a.forEach(function(e){if(!t.Type.isPlainObject(e)){return}var a=i.getDialog().addItem(Object.assign({},e,{tabs:n,sort:2}));if(a){a.select()}});this.getDialog().selectTab(n)}},{key:"createInvitedUsersTab",value:function e(){var a="data:image/svg+xml;charset=US-ASCII,%3Csvg%20width%3D%2223%22%20height%3D%2223%22%20"+"fill%3D%22none%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cpath%20fill-rule%3D%22evenodd"+"%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11.447%202.984a8.447%208.447%200%20100%2016.893%208.447%2"+"08.447%200%20000-16.893zM5.785%2016.273c-.02.018-.116.09-.234.177a7.706%207.706%200%2001-1.846-5.02"+"c0-.36.025-.717.073-1.069.442.573.927%201.347%201.094%201.579.272.379.575.75.84%201.136.444.648.91%"+"201.534.673%202.34-.102.346-.328.627-.6.857zm8.92-6.27s.402%201.575%202.122%201.444c.544-.04.509%20"+"1.414.162%202.015-.43.743-.318%201.627-.725%202.37-.256.467-.69.814-1.035%201.213-.43.501-.913.984-"+"1.631.922-.474-.04-.67-.565-.763-.939-.23-.928-.39-2.828-.39-2.828s-.668-1.443-2.177-1.003c-1.509."+"44-1.816-.728-1.859-1.84-.102-2.742%202.204-3.032%202.472-2.984.383.069%201.507.262%201.79.418.956"+".528%201.935-.2%201.858-.585-.077-.385-2.453-.939-3.296-.999-.843-.06-.92.24-1.151-.014-.187-.205-"+".015-.53.116-.703.93-1.225%202.48-1.522%203.791-2.16.02-.01.051-.08.087-.184a7.72%207.72%200%20012."+"846%201.81%207.719%207.719%200%20011.894%203.091c-.28.165.277-.057-1.185.283-1.462.34-2.926.673-2.9"+"26.673z%22%20fill%3D%22%23ABB1B8%22/%3E%3C/svg%3E";return{id:"invited-users",title:t.Loc.getMessage("SOCNET_ENTITY_SELECTOR_INVITED_USERS_TAB_TITLE"),bgColor:{selected:"#f7a700",selectedHovered:"#faac09"},icon:{default:a,selected:a.replace(/ABB1B8/g,"fff")}}}}]);return i}(i.DefaultFooter);e.Footer=c})(this.BX.SocialNetwork.EntitySelector=this.BX.SocialNetwork.EntitySelector||{},BX,BX.Event,BX.UI.EntitySelector);
//# sourceMappingURL=sonet-entity-selector.bundle.map.js