{"version":3,"file":"sonet-entity-selector.bundle.js","sources":["../src/footer.js","../src/text-footer.js"],"sourcesContent":["import { Type, Tag, Loc, Runtime, Dom, Validation } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { DefaultFooter } from 'ui.entity-selector';\nimport type { Dialog, TabOptions } from 'ui.entity-selector';\n\nexport default class Footer extends DefaultFooter\n{\n\tconstructor(dialog: Dialog, options: { [option: string]: any })\n\t{\n\t\tsuper(dialog, options);\n\n\t\tthis.handleDialogDestroy = this.handleDialogDestroy.bind(this);\n\t\tthis.handleSliderMessage = this.handleSliderMessage.bind(this);\n\n\t\tthis.bindEvents();\n\t}\n\n\tgetContent(): HTMLElement | HTMLElement[] | string | null\n\t{\n\t\treturn this.cache.remember('content', () => {\n\t\t\tif (this.getOption('tagCreationLabel', false))\n\t\t\t{\n\t\t\t\treturn this.createTagCreationLabel();\n\t\t\t}\n\n\t\t\tconst inviteEmployeeLink = this.getOption('inviteEmployeeLink');\n\t\t\tconst inviteGuestLink = this.getOption('inviteGuestLink');\n\t\t\tconst inviteEmployeeScope = this.getOption('inviteEmployeeScope');\n\t\t\tconst createProjectLink = this.getOption('createProjectLink');\n\n\t\t\tconst complexPhrases = {\n\t\t\t\t'111': 'SOCNET_ENTITY_SELECTOR_EMPLOYEE_OR_PROJECT_OR_GUEST',\n\t\t\t\t'110': 'SOCNET_ENTITY_SELECTOR_INVITE_EMPLOYEE_OR_GUEST',\n\t\t\t\t'101': 'SOCNET_ENTITY_SELECTOR_EMPLOYEE_OR_PROJECT',\n\t\t\t\t'011': 'SOCNET_ENTITY_SELECTOR_PROJECT_OR_GUEST',\n\t\t\t};\n\n\t\t\tconst complexCode =\n\t\t\t\tNumber(Boolean(inviteEmployeeLink)).toString() +\n\t\t\t\tNumber(Boolean(inviteGuestLink)).toString() +\n\t\t\t\tNumber(Boolean(createProjectLink)).toString()\n\t\t\t;\n\n\t\t\tconst complexPhrase = complexPhrases[complexCode] ? complexPhrases[complexCode] : null;\n\t\t\tif (complexPhrase)\n\t\t\t{\n\t\t\t\tconst phrase = Tag.render`<div>${Loc.getMessage(complexPhrase)}</div>`;\n\t\t\t\tconst employee = phrase.querySelector('employee');\n\t\t\t\tconst guest = phrase.querySelector('guest');\n\t\t\t\tconst project = phrase.querySelector('project');\n\t\t\t\tconst spans = Array.from(phrase.querySelectorAll('span'));\n\n\t\t\t\tconst firstTag = Array.from(phrase.children).find(element => {\n\t\t\t\t\treturn [employee, guest, project].includes(element);\n\t\t\t\t});\n\n\t\t\t\tconst hideIcon = employee && guest && project;\n\n\t\t\t\tif (employee)\n\t\t\t\t{\n\t\t\t\t\tconst showIcon = !hideIcon && firstTag === employee;\n\t\t\t\t\tphrase.replaceChild(\n\t\t\t\t\t\tthis.createInviteEmployeeLink(employee.innerHTML, showIcon),\n\t\t\t\t\t\temployee\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (guest)\n\t\t\t\t{\n\t\t\t\t\tconst showIcon = !hideIcon && firstTag === guest;\n\t\t\t\t\tconst guestLink = this.createInviteGuestLink(guest.innerHTML, showIcon);\n\t\t\t\t\tphrase.replaceChild(guestLink, guest);\n\t\t\t\t\tthis.createHint(guestLink);\n\t\t\t\t}\n\n\t\t\t\tif (project)\n\t\t\t\t{\n\t\t\t\t\tconst showIcon = !hideIcon && firstTag === project;\n\t\t\t\t\tphrase.replaceChild(\n\t\t\t\t\t\tthis.createProjectLink(project.innerHTML, showIcon),\n\t\t\t\t\t\tproject\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tspans.forEach(span => {\n\t\t\t\t\tphrase.replaceChild(\n\t\t\t\t\t\tTag.render`<span class=\"ui-selector-footer-conjunction\">${span.innerHTML}</span>`,\n\t\t\t\t\t\tspan\n\t\t\t\t\t);\n\t\t\t\t});\n\n\t\t\t\t// Get rid of the outer <div>\n\t\t\t\tconst fragment = document.createDocumentFragment();\n\t\t\t\tArray.from(phrase.childNodes).forEach(element => {\n\t\t\t\t\tfragment.appendChild(element);\n\t\t\t\t});\n\n\t\t\t\treturn fragment;\n\t\t\t}\n\t\t\telse if (inviteEmployeeLink)\n\t\t\t{\n\t\t\t\tlet phrase = '';\n\t\t\t\tswitch (inviteEmployeeScope)\n\t\t\t\t{\n\t\t\t\t\tcase 'I':\n\t\t\t\t\t\tphrase = Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITE_EMPLOYEE');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'E':\n\t\t\t\t\t\tphrase = Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITE_EXTRANET');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'IE':\n\t\t\t\t\t\tphrase = Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITE_EMPLOYEE_OR_EXTRANET');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t}\n\n\t\t\t\treturn this.createInviteEmployeeLink(phrase, true);\n\t\t\t}\n\t\t\telse if (inviteGuestLink)\n\t\t\t{\n\t\t\t\tconst guestLink =\n\t\t\t\t\tthis.createInviteGuestLink(Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITE_GUEST'), true)\n\t\t\t\t;\n\n\t\t\t\tthis.createHint(guestLink);\n\n\t\t\t\treturn guestLink;\n\t\t\t}\n\t\t\telse if (createProjectLink)\n\t\t\t{\n\t\t\t\treturn this.createProjectLink(Loc.getMessage('SOCNET_ENTITY_SELECTOR_CREATE_PROJECT'), true);\n\t\t\t}\n\n\t\t\treturn null;\n\t\t});\n\t}\n\n\tcreateTagCreationLabel()\n\t{\n\t\treturn Loc.getMessage('SOCNET_ENTITY_SELECTOR_TAG_FOOTER_LABEL');\n\t}\n\n\tcreateInviteEmployeeLink(text: string, icon: boolean): string\n\t{\n\t\tconst className = `ui-selector-footer-link${icon ? ' ui-selector-footer-link-add' : ''}`;\n\n\t\treturn Tag.render`\n\t\t\t<span class=\"${className}\" onclick=\"${this.handleInviteEmployeeClick.bind(this)}\">${text}</span>\n\t\t`;\n\t}\n\n\tcreateInviteGuestLink(text: string, icon: boolean): string\n\t{\n\t\tconst className = `ui-selector-footer-link${icon ? ' ui-selector-footer-link-add' : ''}`;\n\n\t\treturn Tag.render`\n\t\t\t<span class=\"${className}\" onclick=\"${this.handleInviteGuestClick.bind(this)}\">${text}</span>\n\t\t`;\n\t}\n\n\tcreateProjectLink(text: string, icon: boolean): string\n\t{\n\t\tconst className = `ui-selector-footer-link${icon ? ' ui-selector-footer-link-add' : ''}`;\n\n\t\treturn Tag.render`\n\t\t\t<span class=\"${className}\" onclick=\"${this.handleCreateProjectClick.bind(this)}\">${text}</span>\n\t\t`;\n\t}\n\n\tcreateHint(link: HTMLElement): void\n\t{\n\t\tRuntime.loadExtension('ui.hint').then(() => {\n\t\t\tconst hint = BX.UI.Hint.createInstance();\n\t\t\tconst node = hint.createNode(Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITED_GUEST_HINT'));\n\t\t\tDom.insertAfter(node, link);\n\t\t});\n\t}\n\n\thandleInviteEmployeeClick(): void\n\t{\n\t\tconst inviteEmployeeLink = this.getOption('inviteEmployeeLink');\n\n\t\tif (Type.isStringFilled(inviteEmployeeLink))\n\t\t{\n\t\t\tconst entity = this.getDialog().getEntity('user');\n\t\t\tconst userOptions = entity.getOptions() || {};\n\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\tinviteEmployeeLink,\n\t\t\t\t{\n\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\trequestMethod: 'post',\n\t\t\t\t\trequestParams: {\n\t\t\t\t\t\tcomponentParams: JSON.stringify({\n\t\t\t\t\t\t\t'USER_OPTIONS': userOptions\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tentitySelectorId: this.getDialog().getId()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\thandleInviteGuestClick(): void\n\t{\n\t\tconst inviteGuestLink = this.getOption('inviteGuestLink');\n\n\t\tif (Type.isStringFilled(inviteGuestLink))\n\t\t{\n\t\t\tconst entity = this.getDialog().getEntity('user');\n\t\t\tconst userOptions = entity.getOptions() || {};\n\n\t\t\tconst rows = [];\n\t\t\tconst searchQuery = this.getDialog().getTagSelectorQuery();\n\t\t\tif (Validation.isEmail(searchQuery))\n\t\t\t{\n\t\t\t\trows.push({ 'email': searchQuery });\n\t\t\t}\n\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\tinviteGuestLink,\n\t\t\t\t{\n\t\t\t\t\twidth: 1200,\n\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\trequestMethod: 'post',\n\t\t\t\t\trequestParams: {\n\t\t\t\t\t\tcomponentParams: JSON.stringify({\n\t\t\t\t\t\t\t'USER_OPTIONS': userOptions,\n\t\t\t\t\t\t\t'ROWS': rows\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tentitySelectorId: this.getDialog().getId()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\thandleCreateProjectClick(): void\n\t{\n\t\tconst createProjectLink = this.getOption('createProjectLink');\n\n\t\tif (Type.isStringFilled(createProjectLink))\n\t\t{\n\t\t\tconst entity = this.getDialog().getEntity('project');\n\t\t\tconst projectOptions = entity.getOptions() || {};\n\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\tcreateProjectLink,\n\t\t\t\t{\n\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\trequestMethod: 'post',\n\t\t\t\t\trequestParams: {\n\t\t\t\t\t\tPROJECT_OPTIONS: projectOptions,\n\t\t\t\t\t\trefresh: 'N'\n\t\t\t\t\t},\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tentitySelectorId: this.getDialog().getId()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tthis.getDialog().subscribe('onDestroy', this.handleDialogDestroy);\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.handleSliderMessage);\n\t}\n\n\tunbindEvents(): void\n\t{\n\t\tthis.getDialog().unsubscribe('onDestroy', this.handleDialogDestroy);\n\t\tEventEmitter.unsubscribe('SidePanel.Slider:onMessage', this.handleSliderMessage);\n\t}\n\n\thandleDialogDestroy(): void\n\t{\n\t\tthis.unbindEvents();\n\t}\n\n\thandleSliderMessage(event: BaseEvent): void\n\t{\n\t\tconst [messageEvent] = event.getData();\n\t\tconst slider = messageEvent.getSender();\n\n\t\tif (slider.getData().get('entitySelectorId') !== this.getDialog().getId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tmessageEvent.getEventId() === 'BX.Intranet.Invitation:onAdd' ||\n\t\t\tmessageEvent.getEventId() === 'BX.Intranet.Invitation.Guest:onAdd'\n\t\t)\n\t\t{\n\t\t\tconst { users } = messageEvent.getData();\n\t\t\tthis.addUsers(users);\n\t\t}\n\n\t\tif (messageEvent.getEventId() === 'BX.Socialnetwork.Workgroup:onAdd')\n\t\t{\n\t\t\tconst { projects } = messageEvent.getData();\n\t\t\tthis.addProjects(projects);\n\t\t}\n\t}\n\n\taddUsers(users: Array): void\n\t{\n\t\tif (!Type.isArrayFilled(users))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet tab = this.getDialog().getRecentTab() || this.getDialog().getTab('invited-users');\n\t\tif (!tab)\n\t\t{\n\t\t\ttab = this.getDialog().addTab(this.createInvitedUsersTab());\n\t\t}\n\n\t\tusers.forEach(user => {\n\t\t\tif (!Type.isPlainObject(user))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst item = this.getDialog().addItem(\n\t\t\t\tObject.assign({}, user, { tabs: tab.getId(), sort: 2 })\n\t\t\t);\n\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.select();\n\t\t\t}\n\t\t});\n\n\t\tthis.getDialog().selectTab(tab.getId());\n\t}\n\n\taddProjects(projects: Array): void\n\t{\n\t\tif (!Type.isArrayFilled(projects))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tab = this.getDialog().getRecentTab() || this.getDialog().getTab('projects');\n\t\tconst tabId = tab ? tab.getId() : null;\n\n\t\tprojects.forEach(project => {\n\t\t\tif (!Type.isPlainObject(project))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst item = this.getDialog().addItem(\n\t\t\t\tObject.assign({}, project, { tabs: tabId, sort: 2 })\n\t\t\t);\n\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.select();\n\t\t\t}\n\t\t});\n\n\t\tthis.getDialog().selectTab(tabId);\n\t}\n\n\tcreateInvitedUsersTab(): TabOptions\n\t{\n\t\tconst icon =\n\t\t\t'data:image/svg+xml;charset=US-ASCII,%3Csvg%20width%3D%2223%22%20height%3D%2223%22%20' +\n\t\t\t'fill%3D%22none%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cpath%20fill-rule%3D%22evenodd' +\n\t\t\t'%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11.447%202.984a8.447%208.447%200%20100%2016.893%208.447%2' +\n\t\t\t'08.447%200%20000-16.893zM5.785%2016.273c-.02.018-.116.09-.234.177a7.706%207.706%200%2001-1.846-5.02' +\n\t\t\t'c0-.36.025-.717.073-1.069.442.573.927%201.347%201.094%201.579.272.379.575.75.84%201.136.444.648.91%' +\n\t\t\t'201.534.673%202.34-.102.346-.328.627-.6.857zm8.92-6.27s.402%201.575%202.122%201.444c.544-.04.509%20' +\n\t\t\t'1.414.162%202.015-.43.743-.318%201.627-.725%202.37-.256.467-.69.814-1.035%201.213-.43.501-.913.984-' +\n\t\t\t'1.631.922-.474-.04-.67-.565-.763-.939-.23-.928-.39-2.828-.39-2.828s-.668-1.443-2.177-1.003c-1.509.' +\n\t\t\t'44-1.816-.728-1.859-1.84-.102-2.742%202.204-3.032%202.472-2.984.383.069%201.507.262%201.79.418.956' +\n\t\t\t'.528%201.935-.2%201.858-.585-.077-.385-2.453-.939-3.296-.999-.843-.06-.92.24-1.151-.014-.187-.205-' +\n\t\t\t'.015-.53.116-.703.93-1.225%202.48-1.522%203.791-2.16.02-.01.051-.08.087-.184a7.72%207.72%200%20012.' +\n\t\t\t'846%201.81%207.719%207.719%200%20011.894%203.091c-.28.165.277-.057-1.185.283-1.462.34-2.926.673-2.9' +\n\t\t\t'26.673z%22%20fill%3D%22%23ABB1B8%22/%3E%3C/svg%3E'\n\t\t;\n\n\t\treturn {\n\t\t\tid: 'invited-users',\n\t\t\ttitle: Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITED_USERS_TAB_TITLE'),\n\t\t\tbgColor: {\n\t\t\t\tselected: '#f7a700',\n\t\t\t\tselectedHovered:  '#faac09',\n\t\t\t},\n\t\t\ticon: {\n\t\t\t\t//default: '/bitrix/js/socialnetwork/entity-selector/src/images/invited-users-tab-icon.svg',\n\t\t\t\t//selected: '/bitrix/js/socialnetwork/entity-selector/src/images/invited-users-tab-icon-selected.svg'\n\t\t\t\tdefault: icon,\n\t\t\t\tselected: icon.replace(/ABB1B8/g, 'fff'),\n\t\t\t}\n\t\t};\n\t}\n}","import {DefaultFooter} from \"ui.entity-selector\";\nimport {Tag} from \"main.core\";\n\nexport default class TextFooter extends DefaultFooter\n{\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-footer-default ui-selector-footer-long-text\">\n\t\t\t\t${this.getContent() ? this.getContent() : '' }\n\t\t\t</div>\n\t\t`;\n\t}\n}\n"],"names":["Footer","dialog","options","handleDialogDestroy","bind","handleSliderMessage","bindEvents","cache","remember","getOption","createTagCreationLabel","inviteEmployeeLink","inviteGuestLink","inviteEmployeeScope","createProjectLink","complexPhrases","complexCode","Number","Boolean","toString","complexPhrase","phrase","Tag","render","Loc","getMessage","employee","querySelector","guest","project","spans","Array","from","querySelectorAll","firstTag","children","find","element","includes","hideIcon","showIcon","replaceChild","createInviteEmployeeLink","innerHTML","guestLink","createInviteGuestLink","createHint","forEach","span","fragment","document","createDocumentFragment","childNodes","appendChild","text","icon","className","handleInviteEmployeeClick","handleInviteGuestClick","handleCreateProjectClick","link","Runtime","loadExtension","then","hint","BX","UI","Hint","createInstance","node","createNode","Dom","insertAfter","Type","isStringFilled","entity","getDialog","getEntity","userOptions","getOptions","SidePanel","Instance","open","allowChangeHistory","cacheable","requestMethod","requestParams","componentParams","JSON","stringify","data","entitySelectorId","getId","rows","searchQuery","getTagSelectorQuery","Validation","isEmail","push","width","projectOptions","PROJECT_OPTIONS","refresh","subscribe","EventEmitter","unsubscribe","unbindEvents","event","getData","messageEvent","slider","getSender","get","getEventId","users","addUsers","projects","addProjects","isArrayFilled","tab","getRecentTab","getTab","addTab","createInvitedUsersTab","user","isPlainObject","item","addItem","Object","assign","tabs","sort","select","selectTab","tabId","id","title","bgColor","selected","selectedHovered","default","replace","DefaultFooter","TextFooter","getContent"],"mappings":"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"}