(function(){BX.VoximplantStatisticDetail=function(t){this.gridContainer=t.gridContainer;this.exportButton=t.exportButton;this.exportUrl=t.exportUrl;this.exportRequestCookieName=t.exportRequestCookieName;this.exportAllowed=t.exportAllowed;this.exporting=false;this.init()};BX.VoximplantStatisticDetail.prototype.init=function(){this.exportButton.addEventListener("click",this.startExport.bind(this));this.initPlayer()};BX.VoximplantStatisticDetail.prototype.initPlayer=function(){var t=new BX.Fileman.Player("vi_records_player",{width:10,height:10,onInit:function(t){t.vjsPlayer.on("pause",function(){var t=BX.findChildrenByClassName(this.gridContainer,"vi-player-pause");for(var i in t){BX.removeClass(t[i],"vi-player-pause")}}.bind(this))}});t.isAudio=true;var i=t.createElement();i.style.display="none";BX.insertAfter(i,this.gridContainer);t.init();BX.bindDelegate(this.gridContainer,"click",{className:"vi-player-button"},function(i){var e=BX.findChildrenByClassName(this.gridContainer,"vi-player-pause");for(var r in e){BX.removeClass(e[r],"vi-player-pause")}var a=i.srcElement||i.target;var n=a.getAttribute("data-bx-record");if(n){n={src:n,type:"audio/mp3"};var o=t.getSource();if(o&&o.indexOf(n.src)!==-1&&t.isPlaying()){t.pause()}else{t.setSource(n);t.play();BX.addClass(a,"vi-player-pause")}i.preventDefault();return false}}.bind(this))};BX.VoximplantStatisticDetail.prototype.startExport=function(){if(this.exporting){return}if(!this.exportAllowed){viOpenTrialPopup("excel-export");return}var t=BX.util.getRandomString(16);this.exportButton.classList.add("ui-btn-wait");this.exportButton.classList.add("ui-btn-disabled");window.location.href=BX.util.add_url_param(this.exportUrl,{exportRequest:t});this.waitForExportFinish(t).then(function(){this.exportButton.classList.remove("ui-btn-wait");this.exportButton.classList.remove("ui-btn-disabled");this.exporting=false}.bind(this))};BX.VoximplantStatisticDetail.prototype.waitForExportFinish=function(t){var i=new BX.Promise;var e=setInterval(function(){if(BX.getCookie(this.exportRequestCookieName)===t){clearInterval(e);i.resolve()}}.bind(this),1e3);return i}})();