(function(){BX.namespace("BX.Voximplant");var e={};BX.Voximplant.Rent=function(e){this.id=e.id;this.publicFolder=e.publicFolder;this.selectPlaceholder=e.selectPlaceholder;this.numbersPlaceholder=e.numbersPlaceholder;this.verifiedAddressesPlaceholder=e.verifiedAddressesPlaceholder;this.location=e.location;this.canRent=e.canRent;this.iframe=e.iframe;this.currentBalance=e.currentBalance;this.rentPacketSize=e.rentPacketSize||1;this.maximumNumbersToRent=e.maximumNumbersToRent||0;this._data={};this._countryId="";this._categoryId="";this._stateId="";this._regionId="";Object.defineProperty(this,"currentCountry",{get:function(){return this._data[this._countryId]}});Object.defineProperty(this,"currentCategory",{get:function(){return this._data[this._countryId]["CATEGORIES"][this._categoryId]}});Object.defineProperty(this,"currentState",{get:function(){return this._data[this._countryId]["CATEGORIES"][this._categoryId]["STATES"][this._stateId]}});Object.defineProperty(this,"currentRegion",{get:function(){if(this._data[this._countryId]["CATEGORIES"][this._categoryId]["HAS_STATES"]){return this._data[this._countryId]["CATEGORIES"][this._categoryId]["STATES"][this._stateId]["REGIONS"]?this._data[this._countryId]["CATEGORIES"][this._categoryId]["STATES"][this._stateId]["REGIONS"][this._regionId]:undefined}else{return this._data[this._countryId]["CATEGORIES"][this._categoryId]["REGIONS"]?this._data[this._countryId]["CATEGORIES"][this._categoryId]["REGIONS"][this._regionId]:undefined}}});Object.defineProperty(this,"isRentButtonVisible",{get:function(){if(this.currentRegion["PHONE_COUNT"]>0){if(this.currentRegion["IS_NEED_REGULATION_ADDRESS"]){return!!this.currentAddressVerification}else{return true}}else{return false}}});this.countryTypes={};this.countryStates={};this.countryRegion={};this.countryRegionNumbers={};this.countryVerifiedAddresses={};this.countryRegionNumberCount=0;this.currentNumber="";this.currentAddressVerification=null;this.phoneNumberInstallationPrice=0;this.phoneNumberMonthPrice=0;this.phoneNumberFullPrice=0;this.phoneNumberCurrency="RUR";this.numberName="";this.selectedNumbers={};Object.defineProperty(this,"selectedCount",{get:function(){return Object.keys(this.selectedNumbers).length}});this.nodes={rentButton:BX("vi_rent_options"),container:BX("vi_rent_options_div")};this.container=e.container;this.loader=null;this.elements={loaderOverlay:null,countryBox:null,countrySelect:null,stateBox:null,stateSelect:null,categoryBox:null,categorySelect:null,regionBox:null,regionLabel:null,regionSelect:null,priceContainer:null,messageContainer:null,numbersContainer:null,title:null,counterTitle:null,selectedCount:null,buttons:null};this.init()};BX.Voximplant.Rent.create=function(t){var s=new BX.Voximplant.Rent(t);e[t.id]=s;return s};BX.Voximplant.Rent.getInstance=function(t){return e[t]};BX.Voximplant.Rent.prototype.init=function(){var e=this.render();this.container.appendChild(e);this.loader=new BX.Loader({target:this.elements.loaderOverlay});this.getCountries().then(function(){this.updateCountrySelect();this.setCurrentCountry(this.elements.countrySelect.value)}.bind(this))};BX.Voximplant.Rent.prototype.render=function(){return BX.createFragment([this.elements.loaderOverlay=BX.create("div",{props:{className:"voximplant-config-rent-overlay"}}),BX.create("div",{props:{className:"tel-set-select-block"},children:[this.elements.countryBox=BX.create("div",{props:{className:"tel-set-item-select-wrap"},children:[BX.create("div",{props:{className:"tel-set-item-select-label"},text:BX.message("VI_CONFIG_RENT_COUNTRY")}),this.elements.countrySelect=BX.create("select",{props:{className:"tel-set-item-select"},events:{bxchange:this.onCountrySelected.bind(this)}})]}),this.elements.categoryBox=BX.create("div",{props:{className:"tel-set-item-select-wrap"},style:{display:"none"},children:[BX.create("div",{props:{className:"tel-set-item-select-label"},text:BX.message("VI_CONFIG_RENT_PHONE_NUMBER")}),this.elements.categorySelect=BX.create("select",{props:{className:"tel-set-item-select"},events:{bxchange:this.onCategorySelected.bind(this)}})]}),this.elements.stateBox=BX.create("div",{props:{className:"tel-set-item-select-wrap"},style:{display:"none"},children:[BX.create("div",{props:{className:"tel-set-item-select-label"},text:BX.message("VI_CONFIG_RENT_STATE")}),this.elements.stateSelect=BX.create("select",{props:{className:"tel-set-item-select"},events:{bxchange:this.onStateSelected.bind(this)}})]}),this.elements.regionBox=BX.create("div",{props:{className:"tel-set-item-select-wrap"},style:{display:"none"},children:[this.elements.regionLabel=BX.create("div",{props:{className:"tel-set-item-select-label"},text:BX.message("VI_CONFIG_RENT_REGION")}),this.elements.regionSelect=BX.create("select",{props:{className:"tel-set-item-select"},events:{bxchange:this.onRegionSelected.bind(this)}})]})]}),BX.create("div",{children:[BX.create("div",{props:{className:"tel-set-list-nums"},children:[this.elements.priceContainer=BX.create("div",{props:{className:"tel-set-amount-box"}}),this.elements.messageContainer=BX.create("div",{props:{className:"tel-message-container"}}),this.elements.numbersContainer=BX.create("div",{props:{className:"tel-set-list-nums-container"}})]})]})])};BX.Voximplant.Rent.prototype.showLoader=function(){this.elements.loaderOverlay.classList.add("active");this.loader.show()};BX.Voximplant.Rent.prototype.hideLoader=function(){this.loader.hide();this.elements.loaderOverlay.classList.remove("active")};BX.Voximplant.Rent.prototype.showCategoryBox=function(){this.elements.categoryBox.style.removeProperty("display")};BX.Voximplant.Rent.prototype.showStateBox=function(){this.elements.stateBox.style.removeProperty("display")};BX.Voximplant.Rent.prototype.showRegionBox=function(){this.elements.regionBox.style.removeProperty("display");BX.adjust(this.elements.regionLabel,{text:this._categoryId=="TOLLFREE"?BX.message("VI_CONFIG_RENT_CATEGORY"):BX.message("VI_CONFIG_RENT_REGION")})};BX.Voximplant.Rent.prototype.hideCategoryBox=function(){this.elements.categoryBox.style.display="none"};BX.Voximplant.Rent.prototype.hideStateBox=function(){this.elements.stateBox.style.display="none"};BX.Voximplant.Rent.prototype.hideRegionBox=function(){this.elements.regionBox.style.display="none"};BX.Voximplant.Rent.prototype.getCountries=function(){return new Promise(function(e,t){if(this.blockAjax){return e()}if(Object.keys(this._data).length>0){return e()}this.blockAjax=true;this.showLoader();BX.ajax.runComponentAction("bitrix:voximplant.config.rent","getCountries").then(function(t){this.hideLoader();this.blockAjax=false;this._data=t.data;e()}.bind(this)).catch(function(e){this.hideLoader();this.blockAjax=false;BX.Voximplant.alert(BX.message("VI_CONFIG_RENT_ERROR_TITLE"),BX.message("VI_CONFIG_RENT_AJAX_ERROR"));t()}.bind(this))}.bind(this))};BX.Voximplant.Rent.prototype.getStates=function(){return new Promise(function(e,t){if(this.blockAjax)return e();this.blockAjax=true;this.showLoader();BX.ajax.runComponentAction("bitrix:voximplant.config.rent","getStates",{data:{country:this._countryId,category:this._categoryId}}).then(function(t){this.hideLoader();this.blockAjax=false;this._data[this._countryId]["CATEGORIES"][this._categoryId]["STATES"]=t.data;e()}.bind(this)).catch(function(e){this.hideLoader();this.blockAjax=false;BX.Voximplant.alert(BX.message("VI_CONFIG_RENT_ERROR_TITLE"),BX.message("VI_CONFIG_RENT_AJAX_ERROR"));t()}.bind(this))}.bind(this))};BX.Voximplant.Rent.prototype.getRegions=function(){return new Promise(function(e,t){if(this.blockAjax)return e();this.blockAjax=true;this.showLoader();BX.ajax.runComponentAction("bitrix:voximplant.config.rent","getRegions",{data:{country:this._countryId,category:this._categoryId,state:this._stateId,bundleSize:this.rentPacketSize>1?this.rentPacketSize:0}}).then(function(t){this.hideLoader();this.blockAjax=false;if(this._stateId){this.currentState["REGIONS"]=t.data}else{this.currentCategory["REGIONS"]=t.data}e(t.data)}.bind(this)).catch(function(e){this.hideLoader();this.blockAjax=false;BX.Voximplant.alert(BX.message("VI_CONFIG_RENT_ERROR_TITLE"),BX.message("VI_CONFIG_RENT_AJAX_ERROR"));t()}.bind(this))}.bind(this))};BX.Voximplant.Rent.prototype.clearSelect=function(e){for(var t=e.options.length-1;t>=0;t--){e.options.remove(t)}};BX.Voximplant.Rent.prototype.updateCountrySelect=function(){this.clearSelect(this.elements.countrySelect);for(var e in this._data){var t={value:e};if(this._countryId===e){t["selected"]="true"}this.elements.countrySelect.options.add(BX.create("option",{attrs:t,html:this._data[e].NAME}))}};BX.Voximplant.Rent.prototype.updateCategorySelect=function(){var e=this._data[this._countryId].CATEGORIES;this.clearSelect(this.elements.categorySelect);var t=BX.util.objectSort(e,"TITLE","asc");for(var s in t){var i=t[s];if(i["PHONE_TYPE"]==="MOSCOW495"||i["PHONE_TYPE"]==="TOLLFREE_CATEGORY2"){continue}var n={value:i["PHONE_TYPE"]};if(this._categoryId===i["PHONE_TYPE"]){n["selected"]="true"}this.elements.categorySelect.options.add(BX.create("option",{attrs:n,text:i["TITLE"]}))}};BX.Voximplant.Rent.prototype.updateStateSelect=function(){this.clearSelect(this.elements.stateSelect);var e=this._data[this._countryId]["CATEGORIES"][this._categoryId]["STATES"];for(var t in e){var s={value:t};if(this._stateId==t){s["selected"]="true"}this.elements.stateSelect.options.add(BX.create("option",{attrs:s,text:e[t]["NAME"]}))}};BX.Voximplant.Rent.prototype.updateRegionSelect=function(){var e=this._data[this._countryId]["CATEGORIES"][this._categoryId];var t;this.clearSelect(this.elements.regionSelect);if(e["HAS_STATES"]){t=this._data[this._countryId]["CATEGORIES"][this._categoryId]["STATES"][this._stateId]["REGIONS"]}else{t=this._data[this._countryId]["CATEGORIES"][this._categoryId]["REGIONS"]}var s=[1,15,2];var i=Object.values(t).sort(function(e,t){if(this._countryId==="RU"&&s.indexOf(e.REGION_ID)!=-1&&s.indexOf(t.REGION_ID)!=-1){return s.indexOf(e.REGION_ID)-s.indexOf(t.REGION_ID)}else if(this._countryId==="RU"&&s.indexOf(e.REGION_ID)!=-1){return-1}else if(this._countryId==="RU"&&s.indexOf(t.REGION_ID)!=-1){return 1}else{return e["REGION_NAME"].localeCompare(t["REGION_NAME"])}}.bind(this));for(var n=0;n<i.length;n++){this.elements.regionSelect.options.add(BX.create("option",{attrs:{value:i[n].REGION_ID},html:i[n].REGION_NAME}))}};BX.Voximplant.Rent.prototype._onUploadDocumentsButtonClick=function(e){BX.SidePanel.Instance.open(this.getUploadUrl(),{cacheable:false,allowChangeHistory:false});e.preventDefault();e.stopPropagation()};BX.Voximplant.Rent.prototype._onRentButtonClick=function(e){if(!this.canRent){BX.Voximplant.showLicensePopup("numbers");return}if(this.currentCountry["CAN_LIST_PHONES"]){if(this.selectedCount==0){BX.Voximplant.alert(BX.message("VI_CONFIG_RENT_ERROR_TITLE"),BX.message("VI_CONFIG_RENT_AJAX_NUMBER"));return}else if(this.rentPacketSize>1&&this.selectedCount!=this.rentPacketSize){BX.Voximplant.alert(BX.message("VI_CONFIG_RENT_ERROR_TITLE"),BX.message("VI_CONFIG_RENT_AJAX_WRONG_NUMBER_COUNT").replace("#COUNT#",this.rentPacketSize.toString()));return}}if(this.currentRegion["IS_NEED_REGULATION_ADDRESS"]&&!this.currentAddressVerification){BX.Voximplant.alert(BX.message("VI_CONFIG_RENT_ERROR_TITLE"),BX.message("VI_CONFIG_SELECT_ADDRESS_ERROR"));return}this.showLoader();var t={country:this._countryId,category:this._categoryId,region:this._regionId};if(this.currentCategory["HAS_STATES"]){t["state"]=this._stateId}if(this.currentCountry["CAN_LIST_PHONES"]){t["numbers"]=Object.keys(this.selectedNumbers)}else{t["count"]=this.rentPacketSize}if(this.rentPacketSize>1){t["singleSubscription"]="Y"}if(this.currentAddressVerification){t["verificationId"]=this.currentAddressVerification}if(this.numberName){t["name"]=this.numberName}BX.ajax.runComponentAction("bitrix:voximplant.config.rent","attachNumbers",{data:t}).then(function(e){this.hideLoader();if(BX.SidePanel.Instance.isOpen()){BX.SidePanel.Instance.postMessage(window,"BX.Voximplant.Rent::onSuccess",{configId:e.data.configId,numbers:e.data.numbers});BX.SidePanel.Instance.close()}}.bind(this)).catch(function(e){this.hideLoader();var t;if(e.errors.length>0){t=e.errors.map(function(e){return e.message}).join("; ")}else{t=BX.message("VI_CONFIG_RENT_AJAX_RENT_UNKNOWN_ERROR")}BX.Voximplant.alert(BX.message("VI_CONFIG_RENT_ERROR_TITLE"),t)}.bind(this));e.preventDefault();e.stopPropagation()};BX.Voximplant.Rent.prototype._onCancelButtonClick=function(){BX.SidePanel.Instance.close()};BX.Voximplant.Rent.prototype.getNumbers=function(e){e=e===true;return new Promise(function(t,s){var i;if(this._stateId){i=this._data[this._countryId]["CATEGORIES"][this._categoryId]["STATES"][this._stateId]["REGIONS"][this._regionId]}else{i=this._data[this._countryId]["CATEGORIES"][this._categoryId]["REGIONS"][this._regionId]}if(!i["NUMBERS"]){i["NUMBERS"]={}}if(i["PHONE_COUNT"]===0){return false}var n=Object.keys(i["NUMBERS"]).length;var r={country:this._countryId,category:this._categoryId,region:this._regionId};if(e&&n>0){r.offset=n}this.showLoader();BX.ajax.runComponentAction("bitrix:voximplant.config.rent","getPhoneNumbers",{data:r}).then(function(s){this.hideLoader();for(var n in s.data){if(s.data.hasOwnProperty(n)){this.currentRegion["NUMBERS"][n]=s.data[n]}}if(this.selectedCount===0&&!e&&Object.keys(i["NUMBERS"]).length>=this.rentPacketSize&&this.rentPacketSize>1){for(var r=0;r<this.rentPacketSize;r++){this.selectedNumbers[Object.keys(i["NUMBERS"])[r]]=true}}t()}.bind(this)).catch(function(e){this.hideLoader();BX.Voximplant.alert(BX.message("VI_CONFIG_RENT_ERROR_TITLE"),BX.message("VI_CONFIG_RENT_AJAX_ERROR"));s()}.bind(this))}.bind(this))};BX.Voximplant.Rent.prototype.getAvailableVerifications=function(){return new Promise(function(e,t){if(this.blockAjax){return e()}var s={country:this._countryId,category:this._categoryId,region:this.currentRegion.REGION_CODE};this.blockAjax=true;this.showLoader();BX.ajax.runComponentAction("bitrix:voximplant.config.rent","getAvailableVerifications",{data:s}).then(function(t){this.hideLoader();this.blockAjax=false;this.currentRegion["ADDRESS_VERIFICATION"]=t.data;e(t.data)}.bind(this)).catch(function(e){this.hideLoader();this.blockAjax=false;BX.Voximplant.alert(BX.message("VI_CONFIG_RENT_ERROR_TITLE"),BX.message("VI_CONFIG_RENT_AJAX_ERROR"));t()}.bind(this))}.bind(this))};BX.Voximplant.Rent.prototype.setCurrentCountry=function(e){this.hideStateBox();this.hideRegionBox();this.clearInterface();this._countryId=e;this._categoryId="";this._stateId="";this._regionId="";this.selectedNumbers={};this.currentNumber="";this.updateCategorySelect();this.showCategoryBox();this.setCurrentCategory(this.elements.categorySelect.value)};BX.Voximplant.Rent.prototype.setCurrentCategory=function(e){this.hideStateBox();this.hideRegionBox();this.clearInterface();this._stateId="";this._regionId="";this._categoryId=e;this.selectedNumbers={};if(this.currentCategory.HAS_STATES){this.getStates().then(function(){this.updateStateSelect();this.showStateBox();this.setCurrentState(this.elements.stateSelect.value)}.bind(this))}else{this.getRegions().then(function(e){if(e.length===0){BX.adjust(this.elements.messageContainer,{children:[this.renderMessage(BX.message("VI_CONFIG_RENT_NO_PHONES"))]});this.hideButtons()}else{this.updateRegionSelect();this.showRegionBox();this.setCurrentRegion(this.elements.regionSelect.value)}}.bind(this))}};BX.Voximplant.Rent.prototype.setCurrentState=function(e){this.hideRegionBox();this.clearInterface();this._stateId=e;this._regionId="";this.selectedNumbers={};this.getRegions().then(function(e){if(e.length===0){BX.adjust(this.elements.messageContainer,{children:[this.renderMessage(BX.message("VI_CONFIG_RENT_NO_PHONES"))]});this.hideButtons()}else{this.updateRegionSelect();this.showRegionBox();this.setCurrentRegion(this.elements.regionSelect.value)}}.bind(this))};BX.Voximplant.Rent.prototype.setCurrentRegion=function(e){this.clearInterface();this._regionId=e;var t=this.currentRegion;this.countryRegionNumberCount=t.PHONE_COUNT;this.currentNumber="";this.selectedNumbers={};if(this.countryRegionNumberCount==0){BX.adjust(this.elements.messageContainer,{children:[this.renderMessage(BX.message("VI_CONFIG_RENT_NO_PHONES"))]});this.hideButtons()}else if(this.currentRegion.REGULATION_ADDRESS_TYPE!=""){this.getAvailableVerifications().then(function(e){this.showPhonePrice();if(e.VERIFICATIONS_AVAILABLE>0){this.showVerifiedAddress();this.showButtons()}else{this.showVerificationRequired();this.hideButtons()}}.bind(this))}else if(this.currentRegion.REQUIRED_VERIFICATION!=""&&this.rentPacketSize>1){this.showDocumentsRequiredForMassRent()}else if(this.currentCountry.CAN_LIST_PHONES){this.getNumbers().then(function(){this.showPhonePrice();this.showNumbers();this.showButtons()}.bind(this))}else{this.showPhonePrice();BX.adjust(this.elements.messageContainer,{children:[this.renderMessage(BX.message("VI_CONFIG_RENT_WITHOUT_CHOICE"))]});this.showButtons()}};BX.Voximplant.Rent.prototype.onCountrySelected=function(e){this.setCurrentCountry(e.currentTarget.value)};BX.Voximplant.Rent.prototype.onCategorySelected=function(e){this.setCurrentCategory(e.currentTarget.value)};BX.Voximplant.Rent.prototype.onStateSelected=function(e){this.setCurrentState(e.currentTarget.value)};BX.Voximplant.Rent.prototype.onRegionSelected=function(e){this.setCurrentRegion(e.currentTarget.value)};BX.Voximplant.Rent.prototype.onMoreNumbersClick=function(e){this.getNumbers(true).then(this.showNumbers.bind(this))};BX.Voximplant.Rent.prototype.getCurrentRegionParameters=function(){var e=this._data[this._countryId]["CATEGORIES"][this._categoryId];if(e.HAS_STATES){return this._data[this._countryId]["CATEGORIES"][this._categoryId]["STATES"][this._stateId]["REGIONS"][this._regionId]}else{return this._data[this._countryId]["CATEGORIES"][this._categoryId]["REGIONS"][this._regionId]}};BX.Voximplant.Rent.prototype.clearInterface=function(){BX.cleanNode(this.elements.priceContainer);BX.cleanNode(this.elements.messageContainer);BX.cleanNode(this.elements.numbersContainer)};BX.Voximplant.Rent.prototype.showPhonePrice=function(){BX.cleanNode(this.elements.priceContainer);if(!this._regionId){return}var e=this._data[this._countryId]["CATEGORIES"][this._categoryId];var t;if(this._stateId){t=this._data[this._countryId]["CATEGORIES"][this._categoryId]["STATES"][this._stateId]["REGIONS"][this._regionId]}else{t=this._data[this._countryId]["CATEGORIES"][this._categoryId]["REGIONS"][this._regionId]}if(this._data[this._countryId]["CAN_LIST_PHONES"]&&!t["NUMBERS"]){return}var s=e["CURRENCY"].toLocaleLowerCase();var i=0;var n=0;var r=this.selectedCount||1;if(this._data[this._countryId]["CAN_LIST_PHONES"]){i=parseFloat(t["MONTH_PRICE"])*r;n=parseFloat(t["INSTALLATION_PRICE"])*r}else{i=parseFloat(t["MONTH_PRICE"])||0;n=parseFloat(t["INSTALLATION_PRICE"])||0}i=parseFloat(i.toFixed(4));n=parseFloat(n.toFixed(4));this.elements.priceContainer.appendChild(BX.create("div",{props:{className:"tel-set-frame-title"},text:BX.message("VI_CONFIG_RENT_MONTH_PRICE")}));var a=BX.create("div",{props:{className:"tel-set-amount-inner"}});this.elements.priceContainer.appendChild(a);var o=BX.create("div",{props:{className:"tel-set-amount-content"},children:[BX.create("div",{props:{className:"tel-set-amount-main tel-set-amount "+"tel-set-amount-"+s},children:[BX.create("div",{props:{className:"tel-set-amount-number"},text:i.toString(10)}),BX.create("div",{props:{className:"tel-set-amount-text"},text:BX.message("VI_CONFIG_RENT_MONTHLY_PAYMENT_HINT")})]})]});a.appendChild(o);if(n>0){var l=BX.create("div",{props:{className:"tel-set-amount-content"},children:[BX.create("div",{props:{className:"tel-set-amount-subtitle"},text:BX.message("VI_CONFIG_RENT_INSTALLATION_PRICE")}),BX.create("div",{props:{className:"tel-set-amount-main tel-set-amount-value-md "+"tel-set-amount-"+s},children:[BX.create("div",{props:{className:"tel-set-amount-number"},text:n.toString(10)}),BX.create("div",{props:{className:"tel-set-amount-text"},text:BX.message("VI_CONFIG_RENT_INSTALLATION_PAYMENT_HINT")})]})]});a.appendChild(l)}if(i+n>this.currentBalance){this.elements.priceContainer.appendChild(BX.create("div",{props:{className:"tel-set-amount-warning-box"},children:[BX.create("div",{props:{className:"tel-set-amount-warning-text"},text:BX.type.isNotEmptyString(this.currentRegion["REQUIRED_VERIFICATION"])?BX.message("VI_CONFIG_RENT_NO_MONEY_TO_RESERVE"):BX.message("VI_CONFIG_RENT_NO_MONEY_TO_RENT")}),BX.create("span",{props:{className:"tel-set-amount-warning-link"},text:BX.message("VI_CONFIG_RENT_TOP_UP_BALANCE"),events:{click:function(){BX.Voximplant.openBilling()}}})]}))}};BX.Voximplant.Rent.prototype.showNumbers=function(){var e=[];var t=this.currentRegion["NUMBERS"];var s=this.currentRegion["PHONE_COUNT"];BX.cleanNode(this.elements.numbersContainer);for(var i in t){if(this._countryId==="RU"&&(this._categoryId==="TOLLFREE"||this._categoryId==="TOLLFREE804")){phoneName=t[i]["PHONE_NUMBER_LOCAL"]}else{phoneName=t[i]["PHONE_NUMBER_INTERNATIONAL"]}e.push(BX.create("span",{props:{className:"tel-set-list-item"},children:[BX.create("input",{props:{className:"tel-set-list-item-checkbox"},attrs:{id:"phone"+i,name:"tel-set-list-item",type:"checkbox",value:i,checked:this.selectedNumbers[i]===true},dataset:{countryCode:t[i].COUNTRY_CODE,regionId:t[i].REGION_ID,phoneNumber:t[i].PHONE_NUMBER},events:{bxchange:this.onNumberSelected.bind(this)}}),BX.create("label",{props:{className:"tel-set-list-item-num"},attrs:{for:"phone"+i},text:phoneName})]}))}this.elements.title=BX.create("div",{props:{className:"tel-set-frame-title"},children:[BX.create("div",{props:{className:"tel-set-frame-title-name"},text:BX.message("VI_CONFIG_RENT_LIST_PHONES")})]});this.elements.counterTitle=BX.create("div",{props:{className:"tel-set-frame-counter"},children:[BX.create("div",{props:{className:"tel-set-frame-counter-name"},text:BX.message("VI_CONFIG_SELECTED")})]});if(this.rentPacketSize==1){this.elements.selectedCount=BX.create("div",{props:{className:"tel-set-frame-number"},text:Object.keys(this.selectedNumbers).length})}else{this.elements.selectedCount=BX.create("div",{props:{className:"tel-set-frame-number"},text:BX.message("VI_CONFIG_RENT_SELECTED_COUNT").replace("#SELECTED#",Object.keys(this.selectedNumbers).length).replace("#TOTAL#",this.rentPacketSize)})}this.elements.counterTitle.appendChild(this.elements.selectedCount);if(this.rentPacketSize>1||Object.keys(this.selectedNumbers).length>0){this.elements.title.appendChild(this.elements.counterTitle)}this.elements.numbersContainer.appendChild(this.elements.title);var n=BX.create("div",{props:{className:"tel-set-list-nums-content"},children:[BX.create("div",{props:{className:"tel-set-list-nums-wrap"},children:e})]});if(s>Object.keys(t).length){n.appendChild(BX.create("div",{props:{className:"tel-set-list-nums-control-box"},children:[BX.create("div",{props:{className:"ui-btn ui-btn-sm ui-btn-light-border"},text:BX.message("VI_CONFIG_RENT_MORE_NUMBERS"),events:{click:this.onMoreNumbersClick.bind(this)}})]}))}this.elements.numbersContainer.appendChild(n);if(this.currentRegion["REQUIRED_VERIFICATION"]){this.showDocumentsRequired()}};BX.Voximplant.Rent.prototype.showDocumentsRequired=function(){this.elements.numbersContainer.appendChild(BX.create("div",{props:{className:"tel-set-list-nums-warning"},children:[BX.create("p",{children:[BX.create("strong",{text:BX.message("VI_CONFIG_RENT_TEXT_REQUIRE_VERIFICATION_P1")})]}),BX.create("p",{text:BX.message("VI_CONFIG_RENT_TEXT_REQUIRE_VERIFICATION_P2")}),BX.create("a",{attrs:{href:this.publicFolder+"documents.php",target:"_blank"},text:BX.message("VI_CONFIG_RENT_TEXT_REQUIRE_VERIFICATION_P3"),events:{click:this._onUploadDocumentsButtonClick.bind(this)}})]}))};BX.Voximplant.Rent.prototype.showDocumentsRequiredForMassRent=function(){this.elements.numbersContainer.appendChild(BX.create("div",{props:{className:"tel-set-list-nums-warning"},children:[BX.create("p",{children:[BX.create("strong",{text:BX.message("VI_CONFIG_RENT_TEXT_REQUIRE_VERIFICATION_MASS_P1")})]}),BX.create("p",{text:BX.message("VI_CONFIG_RENT_TEXT_REQUIRE_VERIFICATION_MASS_P2")}),BX.create("a",{attrs:{href:this.publicFolder+"documents.php",target:"_blank"},text:BX.message("VI_CONFIG_RENT_TEXT_REQUIRE_VERIFICATION_P3"),events:{click:this._onUploadDocumentsButtonClick.bind(this)}})]}))};BX.Voximplant.Rent.prototype.showVerificationRequired=function(){BX.adjust(this.elements.messageContainer,{children:[this.renderMessage(BX.message("VI_CONFIG_ADDRESS_VERIFICATION_REQUIRED_2")),BX.create("button",{props:{className:"ui-btn ui-btn-primary"},text:BX.message("VI_CONFIG_UPLOAD_ADDRESS_VERIFICATION"),events:{click:this._onUploadDocumentsButtonClick.bind(this)}})]})};BX.Voximplant.Rent.prototype.showVerifiedAddress=function(e){var t=this.currentRegion.ADDRESS_VERIFICATION.VERIFIED_ADDRESS.map(function(e){return BX.create("div",{props:{className:"tel-set-frame-radio-item"},children:[BX.create("input",{props:{className:"tel-set-frame-radio-input"},attrs:{type:"radio",id:"address-"+e["ID"],value:e["ID"],name:"ADDRESS_ID"},events:{change:function(e){this.currentAddressVerification=e.currentTarget.value;this.showButtons()}.bind(this)}}),BX.create("label",{props:{className:"tel-set-frame-radio-name"},attrs:{for:"address-"+e["ID"]},text:this.formatVerifiedAddress(e)})]})},this);var s=BX.create("div",{props:{className:"tel-set-frame-address"},children:[BX.create("div",{props:{className:"tel-set-frame-title"},text:BX.message("VI_CONFIG_SELECT_ADDRESS")}),BX.create("div",{props:{className:"tel-set-list-nums-content"},children:[BX.create("div",{props:{className:"tel-set-list-nums-wrap"},children:t}),BX.create("div",{props:{className:"tel-set-list-nums-control-box"},children:[BX.create("div",{props:{className:"ui-btn ui-btn-sm ui-btn-light-border"},text:BX.message("VI_CONFIG_RENT_UPLOAD_DOCUMENTS"),events:{click:this._onUploadDocumentsButtonClick.bind(this)}})]})]})]});this.elements.numbersContainer.appendChild(s)};BX.Voximplant.Rent.prototype.renderMessage=function(e){return BX.create("div",{props:{className:"ui-alert ui-alert-success"},children:[BX.create("span",{props:{className:"ui-alert-message"},text:e})]})};BX.Voximplant.Rent.prototype.renderButtons=function(e){var t=BX.createFragment([]);if(this.isRentButtonVisible){t.appendChild(BX.create("button",{props:{className:"ui-btn ui-btn-success"},text:BX.type.isNotEmptyString(this.currentRegion["REQUIRED_VERIFICATION"])?BX.message("VI_CONFIG_RESERVE_BTN"):BX.message("VI_CONFIG_RENT_BTN"),events:{click:this._onRentButtonClick.bind(this)}}))}t.appendChild(BX.create("button",{props:{className:"ui-btn ui-btn-link"},text:BX.message("VI_CONFIG_CANCEL_BTN"),events:{click:this._onCancelButtonClick.bind(this)}}));return t};BX.Voximplant.Rent.prototype.showButtons=function(){if(this.elements.buttons){BX.cleanNode(this.elements.buttons)}else{this.elements.buttons=BX.create("div",{props:{className:"voximplant-button-panel"}});document.body.appendChild(this.elements.buttons)}this.elements.buttons.appendChild(this.renderButtons())};BX.Voximplant.Rent.prototype.hideButtons=function(){BX.cleanNode(this.elements.buttons)};BX.Voximplant.Rent.prototype.onNumberSelected=function(e){var t=e.currentTarget;if(t.checked){if(this.rentPacketSize>1&&this.selectedCount==this.rentPacketSize){t.checked=false;e.stopPropagation();e.preventDefault()}else if(this.maximumNumbersToRent>0&&this.selectedCount==this.maximumNumbersToRent){t.checked=false;e.stopPropagation();e.preventDefault();BX.Voximplant.showLicensePopup("main")}else{this.selectedNumbers[t.dataset.phoneNumber]=true}}else{delete this.selectedNumbers[t.dataset.phoneNumber]}if(this.rentPacketSize==1){BX.adjust(this.elements.selectedCount,{text:Object.keys(this.selectedNumbers).length})}else{BX.adjust(this.elements.selectedCount,{text:BX.message("VI_CONFIG_RENT_SELECTED_COUNT").replace("#SELECTED#",Object.keys(this.selectedNumbers).length).replace("#TOTAL#",this.rentPacketSize)})}if(this.rentPacketSize==1&&Object.keys(this.selectedNumbers).length===0){this.elements.title.removeChild(this.elements.counterTitle)}else{this.elements.title.appendChild(this.elements.counterTitle)}this.showPhonePrice();this.showButtons()};BX.Voximplant.Rent.prototype.getUploadUrl=function(){var e={SHOW_UPLOAD_IFRAME:"Y",UPLOAD_COUNTRY_CODE:this._countryId,UPLOAD_ADDRESS_TYPE:this.currentRegion.REGULATION_ADDRESS_TYPE,UPLOAD_PHONE_CATEGORY:this._categoryId,UPLOAD_REGION_CODE:this.currentRegion.REGION_CODE,UPLOAD_REGION_ID:this.currentRegion.REGION_ID,IFRAME:this.iframe===true?"Y":"N"};return this.publicFolder+"documents.php?"+BX.util.buildQueryString(e)};BX.Voximplant.Rent.prototype.formatVerifiedAddress=function(e){var t="";var s;var i=["ZIP_CODE","COUNTRY","CITY","STREET","BUILDING_NUMBER"];if(e.BUILDING_LETTER)e.BUILDING_NUMBER+="-"+e.BUILDING_LETTER;var n=true;i.forEach(function(s){if(e[s]){t+=(n?"":", ")+e[s];n=false}});return t}})();
//# sourceMappingURL=template.map.js