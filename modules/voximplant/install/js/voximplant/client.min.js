(function(){var e=null;var n="";var t="";BX.namespace("BX.Voximplant");var r=function(n){return new Promise(function(t,r){if(e.alreadyInitialized){return t()}e.init(n).then(t).catch(r)})};var i=function(){return new Promise(function(n,t){if(e.connected()){return n()}e.connect().then(n).catch(t)})};var o=function(){return new Promise(function(r,i){a().then(u).then(s).then(function(r){return e.loginWithOneTimeKey(n+"@"+t,r)}).then(r).catch(i)})};var a=function(){return new Promise(function(e,r){if(BX.type.isNotEmptyString(n)){return e({login:n,server:t})}else if(BX.message("voximplantLogin")){n=BX.message("voximplantLogin");t=BX.message("voximplantServer");return e({login:n,server:t})}else{BX.rest.callMethod("voximplant.authorization.get").then(function(i){var o=i.data();if(BX.type.isNotEmptyString(o.LOGIN)&&BX.type.isNotEmptyString(o.SERVER)){n=o.LOGIN;t=o.SERVER;e({login:n,server:t})}else{var a=new Error("Could not get voximplant login for user");a.name="AuthResult";r(a)}}).catch(function(e){r(e)})}})};var u=function(n){return new Promise(function(t,r){var i=function(n){e.removeEventListener(VoxImplant.Events.AuthResult,i);if(n.code==302&&n.key){t(n.key)}else{r(n)}};e.addEventListener(VoxImplant.Events.AuthResult,i);e.requestOneTimeLoginKey(n.login+"@"+n.server)})};var s=function(e){return new Promise(function(n,t){BX.rest.callMethod("voximplant.authorization.signOneTimeKey",{KEY:e}).then(function(e){var t=e.data();if(t.HASH){n(t.HASH)}}).catch(function(e){t(e)})})};BX.Voximplant.getClient=function(n){n=BX.type.isPlainObject(n)?n:{};var t=new BX.Promise;if(!e){e=VoxImplant.getInstance()}if(e.getClientState()==="LOGGED_IN"){t.resolve(e);return t}var a={micRequired:false,progressTone:false,experiments:{preventRendering:true}};if(n.debug===true){a.showDebugInfo=true;a.showWarnings=true;a.prettyPrint=true}if(BX.type.isPlainObject(n.apiParameters)){a=BX.util.objectMerge(a,n.apiParameters)}r(a).then(i).then(o).then(function(n){t.resolve(e)}).catch(function(e){console.error(e);if(e.name==="AuthResult"){BX.rest.callMethod("voximplant.authorization.onError")}t.reject(e)});return t}})();
//# sourceMappingURL=client.map.js