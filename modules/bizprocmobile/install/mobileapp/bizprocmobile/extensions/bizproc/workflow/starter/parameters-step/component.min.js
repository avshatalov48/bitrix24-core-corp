jn.define("bizproc/workflow/starter/parameters-step/component",((t,e,i)=>{const{EventEmitter:r}=t("event-emitter");const{NotifyManager:o}=t("notify-manager");const{PureComponent:a}=t("layout/pure-component");const{ParametersStepView:s}=t("bizproc/workflow/starter/parameters-step/view");class n extends a{constructor(t){super(t);this.state={editorConfig:this.props.editorConfig||null};this.uid=t.uid||Random.getString();this.customEventEmitter=r.createWithUid(this.uid);this.signedDocument=t.signedDocument;this.isLoading=false;this.view=null;this.viewCallbackRef=t=>{this.view=t};this.handleEditorFieldChangeState=this.handleEditorFieldChangeState.bind(this)}handleEditorFieldChangeState(){this.customEventEmitter.emit("ParametersStepComponent:OnFieldChangeState")}componentDidMount(){this.customEventEmitter.on("ParametersStepView:OnFieldChangeState",this.handleEditorFieldChangeState);this.loadEditor()}componentWillUnmount(){this.customEventEmitter.off("ParametersStepView:OnFieldChangeState",this.handleEditorFieldChangeState)}get isLoaded(){return this.state.editorConfig!==null}validate(){return this.view.validate()}getData(){return new Promise(((t,e)=>{this.view.getData().then((e=>t(e))).catch((t=>e(t)))}))}loadEditor(){if(this.isLoaded||this.isLoading){return}this.isLoading=true;let t={};let e=false;BX.ajax.runAction("bizprocmobile.Workflow.loadParametersEditor",{data:{templateId:this.props.templateId,signedDocument:this.signedDocument}}).then((e=>{t=e.data&&e.data.editorConfig||{}})).catch((t=>{console.error(t.errors);if(Array.isArray(t.errors)){o.showErrors(t.errors)}e=true})).finally((()=>{this.isLoading=false;this.setState({editorConfig:t});this.customEventEmitter.emit("ParametersStepComponent:OnAfterLoadEditor",[{editorConfig:this.state.editorConfig,hasErrors:e}])}))}render(){return new s({uid:this.uid,layout:this.props.layout,editorConfig:this.state.editorConfig,isLoaded:this.isLoaded,ref:this.viewCallbackRef})}}i.exports={ParametersStepComponent:n}}));
//# sourceMappingURL=component.map.js