jn.define("bizproc/workflow/starter/description-step",((e,t,s)=>{const{Loc:r}=e("loc");const{NotifyManager:i}=e("notify-manager");const{WizardStep:n}=e("layout/ui/wizard/step");const{ProgressBarNumber:a}=e("bizproc/wizard/progress-bar-number");const{DescriptionStepView:o}=e("bizproc/workflow/starter/description-step/view");class d extends n{constructor(e){super(e);this.templateId=e.templateId||null;this.name=e.name||null;this.formattedTime=e.formattedTime||null;this.description=e.description||null;this.hasParameters=e.hasParameters??true;this.isConstantsTuned=e.isConstantsTuned??true}updateProps(e){this.templateId=e.templateId===undefined?this.templateId:e.templateId;this.name=e.name===undefined?this.name:e.name;this.description=e.description===undefined?this.description:e.description;this.hasParameters=e.hasParameters===undefined?this.hasParameters:e.hasParameters;this.isConstantsTuned=e.isConstantsTuned===undefined?this.isConstantsTuned:e.isConstantsTuned;this.formattedTime=e.formattedTime===undefined?this.formattedTime:e.formattedTime}renderNumberBlock(){return new a({isCompleted:true,number:this.props.stepNumber})}getProgressBarSettings(){return{...super.getProgressBarSettings(),isEnabled:true,title:{text:r.getMessage("M_BP_WORKFLOW_STARTER_DESCRIPTION_STEP_TITLE")},number:this.props.stepNumber,count:this.hasParameters?this.props.totalSteps:this.props.totalSteps-1}}getTitle(){return this.props.title||""}getNextStepButtonText(){return this.hasParameters?r.getMessage("M_BP_WORKFLOW_STARTER_DESCRIPTION_STEP_NEXT_STEP_BUTTON_TEXT"):r.getMessage("M_BP_WORKFLOW_STARTER_DESCRIPTION_STEP_NEXT_STEP_BUTTON_FINISH_TEXT")}isNextStepEnabled(){return true}isPrevStepEnabled(){return true}async onMoveToNextStep(e){if(!this.isConstantsTuned){i.showError(r.getMessage("M_BP_WORKFLOW_STARTER_DESCRIPTION_STEP_ERROR_CONSTANTS_NOT_TUNED"));return Promise.resolve({finish:false,next:false})}if(this.hasParameters){return Promise.resolve({finish:false,next:true})}await i.showLoadingIndicator();return new Promise((e=>{BX.ajax.runAction("bizprocmobile.Workflow.start",{data:{signedDocument:this.props.signedDocument,templateId:this.templateId}}).then((()=>{i.hideLoadingIndicator(true,r.getMessage("M_BP_WORKFLOW_STARTER_DESCRIPTION_STEP_SUCCESS_MESSAGE"),1500);setTimeout((()=>e({finish:true,next:false})),1500)})).catch((t=>{console.error(t.errors);i.hideLoadingIndicator(false);if(Array.isArray(t.errors)){i.showErrors(t.errors)}e({finish:false,next:false})}))}))}createLayout(e){return new o({name:this.name,description:this.description,formattedTime:this.formattedTime})}}s.exports={DescriptionStep:d}}));
//# sourceMappingURL=extension.map.js