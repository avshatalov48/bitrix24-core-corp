BX.namespace("BX.Disk");BX.Disk.MeasureClass=function(){var e=500;var t=1e3*60;var i;var s=function(e){e=e||{};if(typeof e.componentParams==="undefined"||e.componentParams===""){throw new Error("BX.Disk.Measure: 'componentParams' parameter missing.")}this.componentParams=e.componentParams;this.amount={};this.ajaxUrl=e.ajaxUrl||"/bitrix/components/bitrix/disk.volume/ajax.php";this.relUrl=e.relUrl;this.filterId=e.filterId;this.storageId=e.storageId;this.gridId=e.gridId;this.progressBar=BX("bx-disk-volume-loader-progress-bar");this.hasWorkerInProcess=e.hasWorkerInProcess||false;this.stepper=BX("bx-disk-volume-stepper");this.suppressStepperAlert=e.suppressStepperAlert||false;this.stepperAlert=BX("bx-disk-volume-stepper-alert");BX.addCustomEvent(window,"onStepperHasBeenFinished",BX.proxy(this.stepperFinished,this));setTimeout(BX.proxy(this.initStepperHints,this),100);setTimeout(BX.proxy(this.stepperAddCancelButton,this),110);setTimeout(BX.proxy(this.initLocalLinks,this),120);d=BX("bx-disk-volume-total-disk-size");p=BX("bx-disk-volume-total-disk-count");u=BX("bx-disk-volume-total-unnecessary");u=BX("bx-disk-volume-total-unnecessary");c=BX("bx-disk-volume-total-unnecessary-format");h=BX("bx-disk-volume-total-trashcan");f=BX("bx-disk-volume-total-trashcan-format");m=BX("bx-disk-volume-drop-size-digit");B=BX("bx-disk-volume-drop-size-units");var i=location.href;i=i.replace(/(reload|expert|admin|filterId)=(Y|N|on|off|[0-9]*)/g,"").replace(/\&\&/g,"&").replace(/[\&\?]+$/,"");if(i!==""&&i!==location.href){if(typeof window.history.replaceState==="function"){window.history.replaceState({},null,i)}else if(typeof window.history.pushState==="function"){window.history.pushState({},null,i)}}BX.bind(window,"beforeunload",BX.proxy(this.onUnload,this));window.setTimeout(BX.proxy(this.refreshTotals,this),t)};s.prototype.onUnload=function(e){if(typeof e==="undefined"){e=window.event}if(this.hasWorkerInProcess&&this.suppressStepperAlert!==true){var t=BX.message("DISK_VOLUME_CLOSE_WARNING");if(e){e.returnValue=t}this.stepperAlertShow();return t}};s.prototype.suppressUnload=function(){this.suppressStepperAlert=true};s.prototype.initLocalLinks=function(e){e=e||BX("content-table");var t=BX.findChildrenByClassName(e,"disk-volume-reload-link");for(var i=0;i<t.length;i++){BX.bind(t[i],"click",BX.proxy(this.repeatMeasure,this))}var s=BX.findChildren(e,{tagName:"a",attribute:{href:/\/volume\//i}},true);for(var i=0;i<s.length;i++){BX.bind(s[i],"click",BX.proxy(this.suppressUnload,this))}};s.prototype.callAction=function(e){e=e||{};if(typeof e.action==="undefined"||e.action===""){throw new Error("BX.Disk.Measure: 'action' parameter missing.")}if(typeof e.before==="function"){e.before.apply(this,[e]);delete e.before}var t=BX.clone(e);delete t.before;delete t.after;var s=this.ajaxUrl+"?action="+e.action;if(!!e.metric){s+="&metric="+e.metric;delete e.metric}if(!!e.metric1){s+="&metric1="+e.metric1;delete e.metric1}if(!!e.metric2){s+="&metric2="+e.metric2;delete e.metric2}i=BX.Disk.ajax({method:"POST",dataType:"json",url:s,data:BX.merge(this.ajaxAuxParams(),t),onsuccess:BX.proxy(function(t){this.actionComplete(t,e)},this)})};s.prototype.ajaxAuxParams=function(){var e={componentParams:this.componentParams};if(!!this.storageId){e.storageId=this.storageId}return e};s.prototype.actionComplete=function(e,t){e=e||{};t=t||{};var i;if(!!e.status&&e.status==="success"){if(typeof e.subTask!=="undefined"&&e.subTask.length>0){o=e.subTask}if(typeof e.subStep!=="undefined"&&parseInt(e.subStep)>0){r=parseInt(e.subStep)}if(r>0){t.subStep=r;t.subTask=o}if(e.queueStep&&e.timeout){if(this.progressBar){i=Math.round((a+r)*100/this.lengthQueue());this.progressBarShow(i)}this.callAction(BX.merge({queueStep:a+1,queueLength:n.length,subTask:o,subStep:r},n[a]));return}else if(e.timeout){if(this.progressBar){i=Math.round((a+r)*100/this.lengthQueue());this.progressBarShow(i)}this.callAction(t);return}else if(e.queueStep){a++;if(a<n.length&&n[a]){if(this.progressBar){i=Math.round((a+r)*100/this.lengthQueue());this.progressBarShow(i)}else{BX.Disk.showActionModal({text:e.message,showLoaderIcon:true,autoHide:false})}this.callAction(BX.merge({queueStep:a+1,queueLength:n.length},n[a]));return}else{a=-1;this.progressBarShow(100)}}if(typeof t.after==="function"){t.after.apply(this,[e,t])}if(!!e.stepper){this.stepperShow(e.stepper)}if(typeof t.doNotShowModalAlert==="undefined"&&!!e.message){BX.Disk.showModalWithStatusAction(e)}else{var s=BX.PopupWindowManager.getCurrentPopup();if(s){if(!s.isShown()||s.uniquePopupId==="bx-disk-status-action"){s.destroy()}}}}else if(!!e.status&&!!e.status){BX.Disk.showModalWithStatusAction(e)}if(typeof t.doNotFollowRedirect==="undefined"){if(!!e.url){this.suppressUnload();window.location.href=e.url}}};var r=-1;var o=null;var a=-1;var n=[];var l=0;s.prototype.addQueueItem=function(e){n.push(e);l++;if(typeof e.subTaskCount!=="undefined"&&parseInt(e.subTaskCount)>0){l+=parseInt(e.subTaskCount)}};s.prototype.runQueue=function(e,t){e=e||1;t=t||{};if(this.lengthQueue()>0){r=0;o=null;a=0;if(e>0){a=e-1}this.callAction(BX.merge({queueStep:a+1,queueLength:n.length},n[a],t))}};s.prototype.stopQueue=function(){r=-1;o=null;a=-1;try{i.abort()}catch(e){}};s.prototype.lengthQueue=function(){return l};s.prototype.openConfirm=function(e){var t=e.payload;var i;if(!!e.messageConfirmId){i=BX.message(e.messageConfirmId)}else{i=e.messageConfirm}if(!!e.name){i=i.replace("#NAME#",e.name)}var s=e.acceptButton||BX.message("DISK_VOLUME_DELETE_BUTTON");var r=e.cancelButton||BX.message("DISK_VOLUME_CANCEL_BUTTON");var o=e.title||BX.message("DISK_VOLUME_DELETE_CONFIRM_TITLE");delete e.payload;delete e.messageConfirm;delete e.messageConfirmId;delete e.name;delete e.acceptButton;delete e.cancelButton;delete e.title;var a=[new BX.PopupWindowButton({text:s,className:"popup-window-button-accept",events:{click:BX.delegate(function(i){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(i);if(!!t){if(typeof this[t]==="function"){this[t].apply(this,[e])}else if(typeof t==="function"){t.apply(this,[e])}}return false},this)}})];a.push(new BX.PopupWindowButton({text:r,events:{click:function(e){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(e);return false}}}));BX.Disk.modalWindow({modalId:"bx-link-unlink-confirm",title:o,contentClassName:"tac",contentStyle:{paddingTop:"70px",paddingBottom:"70px"},content:i,buttons:a})};s.prototype.showAlertSetupProcess=function(){BX.Disk.showActionModal({text:BX.message("DISK_VOLUME_SETUP_CLEANER"),showLoaderIcon:true,autoHide:false})};var d,p,u,h;var c,f;var m,B;s.prototype.refreshTotals=function(e){if(a>=0||r>=0){window.setTimeout(BX.proxy(this.refreshTotals,this),t);return}e=e||{};BX.Disk.ajax({method:"POST",dataType:"json",url:this.ajaxUrl,data:BX.merge({action:"reloadTotals"},this.ajaxAuxParams(),e),onsuccess:BX.proxy(function(e){if(!!e.status&&e.status==="success"){this.amount=e;if(!!m&&!!e.DROP_TOTAL_SIZE_DIGIT){m.innerText=e.DROP_TOTAL_SIZE_DIGIT}if(!!B&&!!e.DROP_TOTAL_SIZE_UNITS){B.innerText=e.DROP_TOTAL_SIZE_UNITS}if(!!d){if(!!e.TOTAL_FILE_SIZE_FORMAT){if(e.TOTAL_FILE_SIZE>0){d.innerText=BX.message("DISK_VOLUME_DISK_TOTAL_USEAGE").replace("#FILE_SIZE#",e.TOTAL_FILE_SIZE_FORMAT);BX.show(d,"inline-block");BX.Disk.helperHint.initHints(d,true)}else{BX.hide(d)}}}if(!!p){if(e.TOTAL_FILE_COUNT>0){p.innerText=BX.message("DISK_VOLUME_DISK_TOTAL_COUNT").replace("#FILE_COUNT#",e.TOTAL_FILE_COUNT);BX.show(p,"inline-block");BX.Disk.helperHint.initHints(p,true)}else{BX.hide(p)}}if(!!u||!!c){if(!!e.DROP_UNNECESSARY_VERSION_FORMAT){if(!!u){if(e.DROP_UNNECESSARY_VERSION_COUNT>0){u.innerText=BX.message("DISK_VOLUME_VERSION_FILES").replace("#FILE_SIZE#",e.DROP_UNNECESSARY_VERSION_FORMAT);BX.show(u,"inline-block");BX.Disk.helperHint.initHints(u,true)}else{BX.hide(u)}}if(!!c){if(e.DROP_UNNECESSARY_VERSION_COUNT>0){c.innerText=e.DROP_UNNECESSARY_VERSION_FORMAT}else{var i=BX.findParent(c,{className:"disc-volume-space-entity-block"});if(!!i){BX.hide(i)}}}}else if(!!u){BX.hide(u)}}if(!!h||!!f){if(!!e.DROP_TRASHCAN_FORMAT){if(!!h){if(e.DROP_TRASHCAN_COUNT>0){var s=BX.findChildren(h,{tagName:"a"});if(!!s){s.innerText=BX.message("DISK_VOLUME_TRASHCAN").replace("#FILE_SIZE#",e.DROP_TRASHCAN_FORMAT)}else{h.innerText=BX.message("DISK_VOLUME_TRASHCAN").replace("#FILE_SIZE#",e.DROP_TRASHCAN_FORMAT);BX.Disk.helperHint.initHints(h,true)}BX.show(h,"inline-block")}else{BX.hide(h)}}if(!!f){if(e.DROP_TRASHCAN_COUNT>0){f.innerText=e.DROP_TRASHCAN_FORMAT;if(e.DROP_TRASHCAN==0){f.innerText=e.DROP_TRASHCAN_FORMAT+" ("+BX.message("DISK_VOLUME_TRASHCAN").replace("#FILE_SIZE#",e.DROP_TRASHCAN_COUNT)+")"}}else{var i=BX.findParent(f,{className:"disc-volume-space-entity-block"});if(!!i){BX.hide(i)}}}}else if(!!h){BX.hide(h)}}}window.setTimeout(BX.proxy(this.refreshTotals,this),t)},this)})};s.prototype.deleteFile=function(e){this.markGridRowWait([e.fileId]);BX.Disk.ajax({method:"POST",dataType:"json",url:this.ajaxUrl,data:BX.merge({action:"deleteFile"},this.ajaxAuxParams(),e),onsuccess:BX.proxy(function(t){if(t.status==="error"){this.markGridRowNormal([e.fileId]);BX.Disk.showModalWithStatusAction(t)}else{this.removeGridRow([e.fileId]);this.reloadGrid();BX.Disk.showActionModal({text:t.message,autoHide:true})}},this)})};s.prototype.deleteFileUnnecessaryVersion=function(e){this.markGridRowWait([e.fileId]);BX.Disk.ajax({method:"POST",dataType:"json",url:this.ajaxUrl,data:BX.merge({action:"deleteFileUnnecessaryVersion"},this.ajaxAuxParams(),e),onsuccess:BX.proxy(function(t){this.markGridRowNormal([e.fileId]);if(t.status==="error"){BX.Disk.showModalWithStatusAction(t)}else{BX.Disk.showActionModal({text:t.message,autoHide:true})}},this)})};s.prototype.deleteUnnecessaryVersion=function(t){this.markGridRowWait([t.filterId]);BX.Disk.ajax({method:"POST",dataType:"json",url:this.ajaxUrl,data:BX.merge({action:"deleteUnnecessaryVersion"},this.ajaxAuxParams(),t),onsuccess:BX.proxy(function(i){this.markGridRowNormal([t.filterId]);if(i.status==="error"){BX.Disk.showModalWithStatusAction(i)}else if(!!i.timeout&&i.timeout==="Y"){setTimeout(BX.proxy(this.deleteUnnecessaryVersion,this),e,t)}else{BX.Disk.showActionModal({text:i.message,autoHide:true})}},this)})};s.prototype.deleteFolder=function(t){this.markGridRowWait([t.filterId]);BX.Disk.ajax({method:"POST",dataType:"json",url:this.ajaxUrl,data:BX.merge({action:"deleteFolder"},this.ajaxAuxParams(),t),onsuccess:BX.proxy(function(i){this.markGridRowNormal([t.filterId]);if(i.status==="error"){BX.Disk.showModalWithStatusAction(i)}else if(!!i.timeout&&i.timeout==="Y"){setTimeout(BX.proxy(this.deleteFolder,this),e,t)}else{BX.Disk.showActionModal({text:i.message,autoHide:true});this.reloadGrid()}},this)})};s.prototype.emptyFolder=function(t){this.markGridRowWait([t.filterId]);BX.Disk.ajax({method:"POST",dataType:"json",url:this.ajaxUrl,data:BX.merge({action:"emptyFolder"},this.ajaxAuxParams(),t),onsuccess:BX.proxy(function(i){this.markGridRowNormal([t.filterId]);if(i.status==="error"){BX.Disk.showModalWithStatusAction(i)}else if(!!i.timeout&&i.timeout==="Y"){setTimeout(BX.proxy(this.emptyFolder,this),e,t)}else{BX.Disk.showActionModal({text:i.message,autoHide:true});this.reloadGrid()}},this)})};s.prototype.progressBarShow=function(e){if(this.progressBar){var t=BX.findChildByClassName(this.progressBar,"disk-volume-loader-progress-bar-number",true);var i=BX.findChildByClassName(this.progressBar,"disk-volume-loader-progress-bar-line-active",true);if(e>100)e=100;if(e<0)e=0;t.innerHTML=e+"%";i.style.width=e+"%";BX.addClass(BX("bx-disk-volume-main-block"),"disk-volume-running");if(!!BX("bx-disk-volume-menu")){BX.hide(BX("bx-disk-volume-menu"))}}};s.prototype.progressBarHide=function(){BX.removeClass(BX("bx-disk-volume-main-block"),"disk-volume-running");if(!!BX("bx-disk-volume-menu")){BX.show(BX("bx-disk-volume-menu"))}};s.prototype.groupAction=function(){var e=this.getGrid();var t=e.getActionsPanel();var i=t.getSelectedIds();if(i.length>0){var s=t.getValues();var r=s.action_button,o;var a,n,l=e.getRows();var d={payload:"callAction",action:"setupCleanerJob",filterIdsStorage:[],filterIdsTrashCan:[],fileIds:[],before:function(){BX.Disk.showActionModal({text:BX.message("DISK_VOLUME_SETUP_CLEANER"),showLoaderIcon:true,autoHide:false})}};for(var p in i){n=l.getById(i[p]);if(n){a=n.getDataset();if(a){o=a.indicatorid;d.filterIdsStorage.push(n.getId());if(parseInt(a.filteridtrashcan)>0){d.filterIdsTrashCan.push(a.filteridtrashcan)}if(o==="Folder"||o==="File"||o==="FileDeleted"){if(parseInt(a.storageid)>0){d.storageId=a.storageid}}if(o==="File"||o==="FileDeleted"){d.fileIds.push(n.getId())}}}}switch(r){case"sendNotification":{if(o==="Storage_TrashCan"){this.callAction({action:"sendNotification",indicatorId:o,filterIdsStorage:d.filterIdsTrashCan})}else{this.callAction({action:"sendNotification",indicatorId:o,filterIdsStorage:d.filterIdsStorage})}break}case"setupCleanerJob":{d.metric=this.getMetricMark("CERTAIN_DISK_CLEAN");if(o==="Storage_Storage"||o==="Storage_Common"||o==="Storage_Group"||o==="Storage_User"){d.messageConfirm=BX.message("DISK_VOLUME_GROUP_DISK_SAFE_CLEAR_CONFIRM");d.deleteUnnecessaryVersion="Y";d.emptyTrashcan="Y"}else if(o==="Storage_Uploaded"){d.messageConfirm=BX.message("DISK_VOLUME_GROUP_UPLOADED_SAFE_CLEAR_CONFIRM");d.deleteUnnecessaryVersion="Y";d.emptyTrashcan="N"}else if(o==="Storage_TrashCan"){d.messageConfirm=BX.message("DISK_VOLUME_GROUP_TRASHCAN_SAFE_CLEAR_CONFIRM");d.deleteUnnecessaryVersion="N";d.emptyTrashcan="Y"}this.openConfirm(d);break}case"setupFolderEmptyJob":{d.metric=this.getMetricMark("CERTAIN_FOLDER_CLEAN");d.messageConfirm=BX.message("DISK_VOLUME_GROUP_FOLDER_EMPTY_CONFIRM");d.emptyFolder="Y";delete d.filterIdsTrashCan;this.openConfirm(d);break}case"setupFolderDropJob":{d.metric=this.getMetricMark("CERTAIN_FOLDER_CLEAN");d.messageConfirm=BX.message("DISK_VOLUME_GROUP_FOLDER_DROP_CONFIRM");d.deleteFolder="Y";delete d.filterIdsTrashCan;this.openConfirm(d);break}case"setupFolderCleanerJob":{d.metric=this.getMetricMark("CERTAIN_FOLDER_CLEAN");d.messageConfirm=BX.message("DISK_VOLUME_GROUP_FOLDER_SAFE_CLEAR_CONFIRM");d.deleteUnnecessaryVersion="Y";delete d.filterIdsTrashCan;this.openConfirm(d);break}case"deleteFileUnnecessaryVersion":{d.messageConfirm=BX.message("DISK_VOLUME_GROUP_DELETE_FILE_UNNECESSARY_VERSION_CONFIRM");d.action="deleteGroupFileUnnecessaryVersion";d.deleteUnnecessaryVersion="Y";d.before=function(e){this.markGridRowWait(e.fileIds)};d.after=function(e,t){this.markGridRowNormal(t.fileIds);this.reloadGrid()};delete d.filterIdsStorage;this.openConfirm(d);break}case"deleteFile":{d.messageConfirm=BX.message("DISK_VOLUME_GROUP_DELETE_FILE_CONFIRM");d.action="deleteGroupFile";d.before=function(e){this.markGridRowWait(e.fileIds)};d.after=function(e,t){this.markGridRowNormal(t.fileIds);this.removeGridRow(t.fileIds);this.reloadGrid()};delete d.filterIdsStorage;this.openConfirm(d);break}}}};var X;s.prototype.getGrid=function(){if(typeof X!=="object"||typeof X.instance!=="object"||!X.instance instanceof BX.Main.grid){if(this.gridId!==""||BX(this.gridId)){X=BX.Main.gridManager.getById(this.gridId)}}if(typeof X==="object"&&typeof X.instance==="object"&&X.instance instanceof BX.Main.grid){return X.instance}return null};s.prototype.reloadGrid=function(){if(this.getGrid()){this.getGrid().reload()}};s.prototype.getGridRow=function(e){return this.getGrid().getRows().getById(""+e)};s.prototype.markGridRowWait=function(e){for(var t,i=0;i<e.length;i++){t=this.getGridRow(e[i]);if(t){t.getNode().style.opacity=.5}}};s.prototype.markGridRowNormal=function(e){for(var t,i=0;i<e.length;i++){t=this.getGridRow(e[i]);if(t){t.getNode().style.opacity=1}}};s.prototype.removeGridRow=function(e){for(var t,i=0;i<e.length;i++){t=this.getGridRow(e[i]);if(t){t.getNode().remove()}}};s.prototype.stepperShow=function(e){if(this.stepper){this.hasWorkerInProcess=true;var t=BX.processHTML(e,false);this.stepper.innerHTML=t.HTML;BX.ajax.processScripts(t.SCRIPT);setTimeout(BX.proxy(this.stepperAddCancelButton,this),100);BX.show(this.stepper);BX.addCustomEvent(window,"onStepperHasBeenFinished",BX.proxy(this.stepperFinished,this));BX.hide(BX("bx-disk-volume-reload-warning"));setTimeout(BX.proxy(this.initStepperHints,this),10)}};s.prototype.stepperHide=function(){this.hasWorkerInProcess=false;if(this.stepper){BX.hide(this.stepper);this.stepper.innerHTML=""}};s.prototype.stepperFinished=function(){this.stepperHide();BX.onCustomEvent(window,"OnDiskVolumeStepperFinished",[this]);BX.show(BX("bx-disk-volume-reload-warning"));if(this.getGrid()){this.reloadGrid()}else{this.suppressUnload();window.location.href=this.relUrl}};s.prototype.stepperAddCancelButton=function(){if(!!this.stepper){var e=BX.findChildByClassName(this.stepper,"main-stepper");if(!!e){BX.append(BX.create("span",{attrs:{id:"bx-disk-volume-cancel-workers",className:"disk-volume-header-link",title:BX.message("DISK_VOLUME_CANCEL_WORKERS")},events:{click:BX.proxy(this.showHintBalloon,this)},text:BX.message("DISK_VOLUME_CANCEL_BUTTON")}),e);BX.bind(BX("bx-disk-volume-cancel-workers"),"click",function(){BX.Disk.showActionModal({text:BX.message("DISK_VOLUME_PERFORMING_CANCEL_WORKERS"),showLoaderIcon:true,autoHide:false});BX.Disk.measureManager.callAction({action:"cancelWorkers",after:BX.Disk.measureManager.stepperHide,doNotShowModalAlert:true})})}}};s.prototype.stepperAlertShow=function(){if(this.stepperAlert&&this.suppressStepperAlert!==true){BX.show(this.stepperAlert)}};s.prototype.initGridHeadHints=function(){if(BX.Disk.helperHint){var e=BX.findChildrenByClassName(this.getGrid().getContainer(),"disk-volume-hint");for(var t=0;t<e.length;t++){var i=BX.data(e[t],"name");if(i){var s=BX.message("DISK_VOLUME_"+i.toUpperCase()+"_HINT");if(s.length>0&&typeof BX.data(BX(e[t]),"hint-exists")==="undefined"){var r=BX.findChildrenByClassName(BX(e[t]),"main-grid-head-title");BX.Disk.helperHint.addHintAfter(r[0],s);BX.data(BX(e[t]),"hint-exists",1)}}}}};s.prototype.initStepperHints=function(){if(BX.Disk.helperHint){var e=BX.findChildByClassName(this.stepper,BX.Disk.helperHint.classNameMarker);if(e===null){var t=BX.findChildByClassName(this.stepper,"main-stepper-steps");if(t){BX.addClass(t,BX.Disk.helperHint.className);BX.data(t,"hint","stepper_steps");BX.Disk.helperHint.initHints(this.stepper)}}}};s.prototype.repeatMeasure=function(e){BX.PreventDefault(e);var t=BX(e.target);var i=BX("bx-disk-volume-link-measure");if(!!i){BX.addClass(i,"ui-btn-clock");t.disabled=true;this.progressBarShow(0);this.runQueue(1)}else{var s=t.href;if(this.hasWorkerInProcess){this.openConfirm({title:BX.message("DISK_VOLUME_MEASURE"),messageConfirm:BX.message("DISK_VOLUME_MEASURE_CONFIRM")+"\n\n"+BX.message("DISK_VOLUME_MEASURE_CONFIRM_QUESTION"),acceptButton:BX.message("DISK_VOLUME_MEASURE_ACCEPT"),payload:function(){BX.addClass(t,"ui-btn-clock");window.location.href=s}})}else{BX.addClass(t,"ui-btn-clock");window.location.href=s}}return true};var g={};s.prototype.addMetricMark=function(e){BX.merge(g,e)};s.prototype.getMetricMark=function(e){return g[e]};return s}();BX.Disk.HintClass=function(){var e=[];var t=[];var i=[];var s=function(e){this.className=e.className||"disk-volume-hint";this.classNameMarker=e.classNameMarker||"disk-volume-hint-marker";this.classNameBalloon=e.classNameBalloon||"disk-volume-hint-balloon"};s.prototype.initHints=function(e,t){e=e||BX("workarea");t=t||false;var i=BX.findChildrenByClassName(e,"disk-volume-hint");if(BX.hasClass(e,"disk-volume-hint")){i.push(e)}for(var s=0;s<i.length;s++){var r=BX.data(i[s],"hint");if(r){try{var o=BX.message("DISK_VOLUME_"+r.toUpperCase()+"_HINT");if(o.length>0&&(typeof BX.data(BX(i[s]),"hint-exists")==="undefined"||t)){this.appendHint(BX(i[s]),o);BX.data(BX(i[s]),"hint-exists",1)}}catch(e){}}}};s.prototype.appendHint=function(i,s){var r=e.push(s);t[r]=s;BX.append(BX.create("span",{attrs:{className:this.classNameMarker,"data-id":r},events:{click:BX.proxy(this.showHintBalloon,this)},text:"?"}),i)};s.prototype.addHintAfter=function(i,s){var r=e.push(s);t[r]=s;BX.insertAfter(BX.create("span",{attrs:{className:this.classNameMarker,"data-id":r},events:{click:BX.proxy(this.showHintBalloon,this)},text:"?"}),i)};s.prototype.showHintBalloon=function(e){BX.eventCancelBubble(e);BX.fireEvent(document,"click");var s=BX(e.target);var r=BX.data(s,"id");var o=t[r];if(typeof i[r]!=="object"||!i[r]instanceof BX.PopupWindow){i[r]=new BX.PopupWindow("disk-hint-"+r,s,{className:this.classNameBalloon,lightShadow:true,offsetLeft:6,autoHide:true,closeByEsc:true,angle:true,bindOptions:{position:"bottom"},content:o})}var a=i[r];a.show();return BX.PreventDefault(e)};return s}();
//# sourceMappingURL=script.map.js