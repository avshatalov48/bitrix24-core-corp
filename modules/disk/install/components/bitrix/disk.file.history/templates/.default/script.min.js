(function(){"use strict";BX.namespace("BX.Disk");BX.Disk.FileHistoryComponent=function(e){this.layout={};this.object=e.object;this.gridId=e.gridId;this.grid=BX.Main.gridManager.getById(this.gridId);this.bindEvents()};BX.Disk.FileHistoryComponent.prototype={bindEvents:function(){BX.bind(window,"popstate",this.onPopState.bind(this))},onPopState:function(e){var n=e.state;if(n&&n.disk){window.location.reload()}},openRestoreConfirm:function(e){var n=e.object.name;var t=e.object.id;var i=e.version.id;var o=BX.message("DISK_FILE_HISTORY_VERSION_RESTORE_CONFIRM");var s=this;var a=[new BX.PopupWindowCustomButton({text:BX.message("DISK_FILE_HISTORY_VERSION_RESTORE_BUTTON"),className:"ui-btn ui-btn-success",events:{click:function(e){this.addClassName("ui-btn-clock");BX.ajax.runAction("disk.api.file.restoreFromVersion",{analyticsLabel:"file.history",data:{fileId:t,versionId:i}}).then(function(e){BX.PopupWindowManager.getCurrentPopup().close();s.grid.instance.reload();var n=BX.SidePanel.Instance.getSliderByWindow(window);if(n){BX.SidePanel.Instance.postMessageAll(window,"Disk.File:onRestoredFromVersion",{fileId:t,versionId:i})}})}}}),new BX.PopupWindowCustomButton({text:BX.message("DISK_JS_BTN_CANCEL"),className:"ui-btn ui-btn-link",events:{click:function(e){BX.PopupWindowManager.getCurrentPopup().close()}}})];BX.Disk.modalWindow({modalId:"bx-link-unlink-confirm",title:BX.message("DISK_FILE_HISTORY_VERSION_RESTORE_TITLE"),contentClassName:"disk-popup-content",content:o.replace("#NAME#",n),buttons:a})},openDeleteConfirm:function(e){var n=e.object.name;var t=e.object.id;var i=e.version.id;var o=BX.message("DISK_FILE_HISTORY_VERSION_DELETE_VERSION_CONFIRM");var s=this;var a=[new BX.PopupWindowCustomButton({text:BX.message("DISK_FILE_HISTORY_VERSION_DELETE_VERSION_BUTTON"),className:"ui-btn ui-btn-success",events:{click:function(e){this.addClassName("ui-btn-clock");BX.ajax.runAction("disk.api.version.delete",{analyticsLabel:"file.history",data:{versionId:i}}).then(function(e){BX.PopupWindowManager.getCurrentPopup().close();s.grid.instance.reload();var n=BX.SidePanel.Instance.getSliderByWindow(window);if(n){BX.SidePanel.Instance.postMessageAll(window,"Disk.Version:onDeleted",{fileId:t,versionId:i})}})}}}),new BX.PopupWindowCustomButton({text:BX.message("DISK_JS_BTN_CANCEL"),className:"ui-btn ui-btn-link",events:{click:function(e){BX.PopupWindowManager.getCurrentPopup().close()}}})];BX.Disk.modalWindow({modalId:"bx-link-unlink-confirm",title:BX.message("DISK_FILE_HISTORY_VERSION_DELETE_VERSION_TITLE"),contentClassName:"disk-popup-content",content:o.replace("#NAME#",n),buttons:a})}}})();