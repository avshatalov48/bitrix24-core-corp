{"version":3,"file":"script.js","sources":["src/utils.js","src/backend.js","src/fields/sharing.js","src/fields/externallink.js","src/grid/common-grid.js","src/options.js","src/toolbar.js","src/gridmenu/item.js","src/gridmenu/item-history.js","src/gridmenu/itemopen.js","src/gridmenu/itemsharesection.js","src/gridmenu/iteminternallink.js","src/gridmenu/itemexternallink.js","src/gridmenu/itemrename.js","src/gridmenu/item-sharing.js","src/gridmenu/item-delete.js","src/gridmenu/index.js","src/grid/list.js","src/grid/tile.js","src/index.js"],"sourcesContent":["import 'main.polyfill.intersectionobserver';\n\nlet intersectionObserver;\nfunction observeIntersection(entity, callback)\n{\n\tif (!intersectionObserver)\n\t{\n\t\tintersectionObserver = new IntersectionObserver(function(entries) {\n\t\t\tentries.forEach((entry) => {\n\t\t\t\tif (entry.isIntersecting)\n\t\t\t\t{\n\t\t\t\t\tintersectionObserver.unobserve(entry.target);\n\t\t\t\t\tconst observedCallback = entry.target.observedCallback;\n\t\t\t\t\tdelete entry.target.observedCallback;\n\t\t\t\t\tsetTimeout(observedCallback);\n\t\t\t\t}\n\t\t\t});\n\t\t}, {\n\t\t\tthreshold: 0\n\t\t});\n\t}\n\tentity.observedCallback = callback;\n\n\tintersectionObserver.observe(entity);\n}\n\n\nexport {\n\tobserveIntersection\n}","import {ajax, Runtime} from 'main.core';\n\nclass BackendInner {\n\tstatic idsForShared = { }\n\tstatic idsForExternalLinks = { }\n\tstatic sendForInfo = Runtime.debounce(\n\t\tfunction()\n\t\t{\n\t\t\tconst requestData = {\n\t\t\t\t'shared': BackendInner.idsForShared,\n\t\t\t\t'externalLink': BackendInner.idsForExternalLinks\n\t\t\t}\n\t\t\tBackendInner.idsForShared = {};\n\t\t\tBackendInner.idsForExternalLinks = {};\n\n\t\t\tconst request = {};\n\t\t\tfor (let action in requestData)\n\t\t\t{\n\t\t\t\tif (requestData.hasOwnProperty(action))\n\t\t\t\t{\n\t\t\t\t\tfor (let id in requestData[action])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (requestData[action].hasOwnProperty(id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trequest[id] = (request[id] || []);\n\t\t\t\t\t\t\trequest[id].push(action);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tajax\n\t\t\t\t.runComponentAction(\n\t\t\t\t\tBackend.component,\n\t\t\t\t\t'getInfo',\n\t\t\t\t\t{\n\t\t\t\t\t\tmode: 'ajax',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\ttrackedObjectIds: request\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tfor (let action in requestData)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (requestData.hasOwnProperty(action))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor (let id in requestData[action])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (requestData[action].hasOwnProperty(id))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\trequestData[action][id][0]({data: data[id][action]});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(({errors}) => {\n\t\t\t\t\tfor (let action in requestData)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (requestData.hasOwnProperty(action))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor (let id in requestData[action])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (requestData[action].hasOwnProperty(id))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\trequestData[action][id][1]({errors});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}, 500\n\t)\n}\n\nexport default class Backend\n{\n\tstatic component: string = 'bitrix:disk.documents';\n\n\tstatic getShared(id)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tBackendInner.idsForShared[id] = [resolve, reject];\n\t\t\tBackendInner.sendForInfo();\n\t\t});\n\t}\n\n\tstatic getExternalLink(id)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tBackendInner.idsForExternalLinks[id] = [resolve, reject];\n\t\t\tBackendInner.sendForInfo();\n\t\t});\n\t}\n\n\tstatic getMenuActions(id)\n\t{\n\t\treturn ajax\n\t\t\t.runComponentAction(\n\t\t\t\tBackend.component,\n\t\t\t\t'getMenuActions',\n\t\t\t\t{\n\t\t\t\t\tmode: 'ajax',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttrackedObjectId: id\n\t\t\t\t\t},\n\t\t\t\t\tanalyticsLabel: Backend.component + '.gridMenuActions',\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\tstatic getMenuOpenAction(id)\n\t{\n\t\treturn ajax\n\t\t\t.runComponentAction(\n\t\t\t\tBackend.component,\n\t\t\t\t'getMenuOpenAction',\n\t\t\t\t{\n\t\t\t\t\tmode: 'ajax',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttrackedObjectId: id\n\t\t\t\t\t},\n\t\t\t\t\tanalyticsLabel: Backend.component + '.gridMenuOpenAction',\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\tstatic renameAction(id, newName)\n\t{\n\t\treturn ajax\n\t\t\t.runAction('disk.api.trackedObject.rename', {\n\t\t\t\tdata: {\n\t\t\t\t\tobjectId: id,\n\t\t\t\t\tnewName: newName\n\t\t\t\t}\n\t\t\t});\n\t}\n}","import {Loader} from 'main.loader';\nimport {Users} from 'disk.users';\nimport {observeIntersection} from \"../utils\";\nimport Backend from '../backend';\n\nexport class Sharing\n{\n\tid: Number;\n\tloader: ?Loader;\n\tnode: Element;\n\n\tconstructor(id, node)\n\t{\n\t\tthis.id = id;\n\t\tthis.node = node;\n\t\tthis.init();\n\t\tthis.observe();\n\t}\n\n\tinit()\n\t{\n\t\tthis.actionName = 'getShared';\n\t}\n\n\tobserve() {\n\t\tobserveIntersection(this.node, () => {\n\t\t\tthis.showLoading();\n\t\t\tBackend\n\t\t\t\t[this.actionName](this.id)\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tthis.hideLoading();\n\t\t\t\t\tthis.renderData(data);\n\t\t\t\t}, ({errors}) => {\n\t\t\t\t\tthis.hideLoading();\n\t\t\t\t\tconst errorMessages = [];\n\t\t\t\t\terrors.forEach((error) => {\n\t\t\t\t\t\terrorMessages.push(error.message);\n\t\t\t\t\t});\n\t\t\t\t\tthis.node.innerHTML = 'Error! ' + errorMessages.join('<br>');\n\t\t\t\t});\n\t\t});\n\t}\n\n\tshowLoading()\n\t{\n\t\tthis.loader = (this.loader || new Loader({target: this.node, mode: 'inline', size: 20}));\n\t\tthis.loader.show();\n\t\tthis.node.dataset.bxLoading = 'Y';\n\t}\n\n\thideLoading()\n\t{\n\t\tdelete this.node.dataset.bxLoading;\n\t\tthis.loader.hide();\n\t}\n\n\trenderData(data)\n\t{\n\t\tthis.node.innerHTML = '';\n\n\t\tconst res = new Users(data, null, {\n\t\t\tplaceInGrid: true\n\t\t});\n\t\tthis.node.appendChild(res.getContainer());\n\t}\n}","import {Sharing} from './sharing';\nimport {ExternalLinkForTrackedObject} from 'disk.external-link';\n\nexport class ExternalLink extends Sharing\n{\n\tinit()\n\t{\n\t\tthis.actionName = 'getExternalLink';\n\t}\n\n\tshowLoading()\n\t{\n\t}\n\n\thideLoading()\n\t{\n\t}\n\n\trenderData(data)\n\t{\n\t\tthis.node.innerHTML = '';\n\t\tconst res = new ExternalLinkForTrackedObject(this.id, data);\n\t\tthis.node.appendChild(res.getContainer());\n\t}\n}\n","\nexport default class CommonGrid\n{\n\t/**\n\t * @type {BX.TileGrid.Grid|BX.Main.grid}\n\t */\n\tgridInstance: any = null;\n\n\tconstructor(options)\n\t{\n\t\tthis.gridInstance = options.gridInstance;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.gridInstance.getId();\n\t}\n\n\tisGrid(): boolean\n\t{\n\t\treturn !this.isTile();\n\t}\n\n\tisTile(): boolean\n\t{\n\t\treturn BX.TileGrid.Grid && (this.gridInstance instanceof BX.TileGrid.Grid);\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.gridInstance.getContainer();\n\t}\n\n\tfade(): void\n\t{\n\t\tif (this.isGrid())\n\t\t{\n\t\t\tthis.gridInstance.tableFade();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.gridInstance.setFadeContainer();\n\t\t\tthis.gridInstance.getLoader();\n\t\t\tthis.gridInstance.showLoader();\n\t\t}\n\t}\n\n\tunFade(): void\n\t{\n\t\tif (this.isGrid())\n\t\t{\n\t\t\tthis.gridInstance.tableUnfade();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.gridInstance.getLoader().hide();\n\t\t\tthis.gridInstance.unSetFadeContainer();\n\t\t}\n\t}\n\n\tgetActionKey(): string\n\t{\n\t\treturn ('action_button_' + this.gridInstance.getId());\n\t}\n\n\tgetSelectedIds(): Array<string>\n\t{\n\t\tif (this.isGrid())\n\t\t{\n\t\t\treturn this.gridInstance.getRows().getSelectedIds();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.gridInstance.getSelectedItems().map(function (item) {\n\t\t\t\treturn item.getId();\n\t\t\t});\n\t\t}\n\t}\n\n\tgetIds(): Array<string>\n\t{\n\t\tif (this.isGrid())\n\t\t{\n\t\t\treturn this.gridInstance.getRows().getBodyChild().map(function (row) {\n\t\t\t\treturn row.getId();\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.gridInstance.items.map(function (item) {\n\t\t\t\treturn item.id;\n\t\t\t});\n\t\t}\n\t}\n\n\tcountItems(): number\n\t{\n\t\tif (this.isGrid())\n\t\t{\n\t\t\treturn this.gridInstance.getRows().getBodyChild().length;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.gridInstance.countItems();\n\t\t}\n\t}\n\n\treload(url, data)\n\t{\n\t\tdata = data || {};\n\n\t\tif (this.isGrid())\n\t\t{\n\t\t\tvar promise = new BX.Promise();\n\t\t\tthis.gridInstance.reloadTable(\n\t\t\t\t\"POST\",\n\t\t\t\tdata,\n\t\t\t\tfunction () {\n\t\t\t\t\tpromise.fulfill();\n\t\t\t\t},\n\t\t\t\turl\n\t\t\t);\n\n\t\t\treturn promise;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.gridInstance.reload(url, data);\n\t\t}\n\t}\n\n\tgetActionsMenu(itemId): BX.Main.Menu\n\t{\n\t\tif (this.isGrid())\n\t\t{\n\t\t\treturn this.gridInstance.getRows().getById(itemId).getActionsMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvar item = this.gridInstance.getItem(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\treturn item.getActionsMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetItemById(id)\n\t{\n\t\tif (this.isGrid())\n\t\t{\n\t\t\treturn this.gridInstance.getRows().getById(id);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.gridInstance.getItem(id);\n\t\t}\n\t}\n\n\tscrollTo(id): void\n\t{\n\t\tvar contentNode;\n\t\tif (this.isGrid())\n\t\t{\n\t\t\tvar row = this.gridInstance.getRows().getById(id);\n\t\t\tif (row && row.node)\n\t\t\t{\n\t\t\t\tcontentNode = row.node;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvar item = this.gridInstance.getItem(id);\n\t\t\tif (row && row.node)\n\t\t\t{\n\t\t\t\tcontentNode = row.getContainer();\n\t\t\t}\n\t\t}\n\n\t\tif (contentNode)\n\t\t{\n\t\t\t(new BX.easing({\n\t\t\t\tduration: 500,\n\t\t\t\tstart: {scroll: window.pageYOffset || document.documentElement.scrollTop},\n\t\t\t\tfinish: {scroll: BX.pos(contentNode).top},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\twindow.scrollTo(0, state.scroll);\n\t\t\t\t}\n\t\t\t})).animate();\n\t\t}\n\t}\n\n\tgetActionById(id, menuItemId)\n\t{\n\t\tvar item = this.getItemById(id);\n\t\tif (item)\n\t\t{\n\t\t\tvar actions = item.getActions();\n\t\t\tfor (var i = 0; i < actions.length; i++)\n\t\t\t{\n\t\t\t\tif (actions[i].id && actions[i].id === menuItemId)\n\t\t\t\t{\n\t\t\t\t\treturn actions[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tremoveItemById(itemId): void\n\t{\n\t\tBX.fireEvent(document, 'click');\n\n\t\tif (this.isGrid())\n\t\t{\n\t\t\tthis.gridInstance.removeRow(itemId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvar item = this.gridInstance.getItem(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\t//todo here we have to remove item from server\n\t\t\t\tthis.gridInstance.removeItem(item);\n\t\t\t}\n\t\t}\n\t}\n\n\tselectItemById(itemId): void\n\t{\n\t\tvar item;\n\t\tif (this.isGrid())\n\t\t{\n\t\t\titem = this.gridInstance.getRows().getById(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.select();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\titem = this.gridInstance.getItem(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tthis.gridInstance.selectItem(item);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveSelected(): void\n\t{\n\t\tif (this.isGrid())\n\t\t{\n\t\t\tthis.gridInstance.removeSelected();\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//todo here we have to remove items from server\n\t\t}\n\t}\n\n\tsortByColumn(column): void\n\t{\n\t\tthis.gridInstance.sortByColumn(column);\n\t}\n}","import {Reflection} from \"main.core\";\nimport CommonGrid from \"./grid/common-grid\";\n\nexport class Options\n{\n\tstatic gridId: String = 'diskDocumentsGrid'; // $arParams['GRID_ID']\n\tstatic filterId: String = 'diskDocumentsFilter'; // $arParams['GRID_ID']\n\tstatic editableExt = ['doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'xodt'];\n\n\tstatic getGridId()\n\t{\n\t\treturn Options.gridId;\n\t}\n\n\tstatic getCommonGrid(): CommonGrid\n\t{\n\t\tlet gridInstance;\n\t\tconst gridId = this.getGridId();\n\t\tif (Reflection.getClass('BX.Main.gridManager') && BX.Main.gridManager.getInstanceById(gridId))\n\t\t{\n\t\t\tgridInstance = BX.Main.gridManager.getInstanceById(gridId);\n\t\t}\n\t\telse if (Reflection.getClass('BX.Main.tileGridManager') && BX.Main.tileGridManager.getInstanceById(gridId))\n\t\t{\n\t\t\tgridInstance = BX.Main.tileGridManager.getInstanceById(gridId);\n\t\t}\n\n\t\treturn new CommonGrid({\n\t\t\tgridInstance: gridInstance,\n\t\t});\n\t}\n\n\tstatic setGridId(gridId: ?String)\n\t{\n\t\tOptions.gridId = gridId;\n\t}\n\n\tstatic getFilterId()\n\t{\n\t\treturn Options.filterId;\n\t}\n\n\tstatic getEditableExt()\n\t{\n\t\treturn Options.editableExt;\n\t}\n\n\tstatic setEditableExt(extensions: ?Array)\n\t{\n\t\tOptions.editableExt = extensions;\n\t}\n\n\tstatic setViewList()\n\t{\n\t\tBX.userOptions.save('disk', 'documents', 'viewMode', 'list');\n\t\tBX.userOptions.save('disk', 'documents', 'viewSize', '');\n\t\twindow.location.reload();\n\t}\n\n\tstatic setViewSmallTile()\n\t{\n\t\tBX.userOptions.save('disk', 'documents', 'viewMode', 'tile');\n\t\tBX.userOptions.save('disk', 'documents', 'viewSize', 'm');\n\t\twindow.location.reload();\n\t}\n\n\tstatic setViewBigTile()\n\t{\n\t\tBX.userOptions.save('disk', 'documents', 'viewMode', 'tile');\n\t\tBX.userOptions.save('disk', 'documents', 'viewSize', 'xl');\n\t\twindow.location.reload();\n\t}\n}","import {BaseEvent, EventEmitter} from \"main.core.events\";\nimport CommonGrid from \"./grid/common-grid\";\nimport {Options as GridOptions} from \"./options\";\nimport {Reflection} from \"main.core\";\n\nexport default class Toolbar\n{\n\tconstructor()\n\t{\n\n\t}\n\n\tstatic reloadGridAndFocus(rowId: ?number)\n\t{\n\t\tconst commonGrid = GridOptions.getCommonGrid();\n\t\tcommonGrid.reload();\n\t}\n\n\tstatic runCreating(documentType, service): void\n\t{\n\t\tif (BX.message('disk_restriction'))\n\t\t{\n\t\t\t//this.blockFeatures();\n\t\t\treturn;\n\t\t}\n\n\t\tif (service === 'l' && BX.Disk.Document.Local.Instance.isEnabled())\n\t\t{\n\t\t\tBX.Disk.Document.Local.Instance.createFile({\n\t\t\t\ttype: documentType,\n\t\t\t}).then((response) => {\n\t\t\t\tthis.reloadGridAndFocus(response.object.id);\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst createProcess = new BX.Disk.Document.CreateProcess({\n\t\t\ttypeFile: documentType,\n\t\t\tserviceCode: service,\n\t\t\tonAfterSave: (response) => {\n\t\t\t\tif (response.status === 'success')\n\t\t\t\t{\n\t\t\t\t\tthis.reloadGridAndFocus(response.object.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tcreateProcess.start();\n\t}\n\n\tstatic resolveServiceCode(service)\n\t{\n\t\tif (!service)\n\t\t{\n\t\t\tservice = BX.Disk.getDocumentService();\n\t\t}\n\n\t\tif (service)\n\t\t{\n\t\t\treturn service;\n\t\t}\n\n\t\tif (BX.Disk.isAvailableOnlyOffice())\n\t\t{\n\t\t\treturn 'onlyoffice';\n\t\t}\n\n\t\tBX.Disk.InformationPopups.openWindowForSelectDocumentService({});\n\n\t\treturn null;\n\t}\n\n\tstatic createDocx(service)\n\t{\n\t\tconst code = this.resolveServiceCode(service);\n\t\tif (code)\n\t\t{\n\t\t\tthis.runCreating('docx', code);\n\t\t}\n\t}\n\n\tstatic createXlsx(service)\n\t{\n\t\tconst code = this.resolveServiceCode(service);\n\t\tif (code)\n\t\t{\n\t\t\tthis.runCreating('xlsx', code);\n\t\t}\n\t}\n\n\tstatic createPptx(service)\n\t{\n\t\tconst code = this.resolveServiceCode(service);\n\t\tif (code)\n\t\t{\n\t\t\tthis.runCreating('pptx', code);\n\t\t}\n\t}\n\n\tstatic createByDefault(service)\n\t{\n\t\tconsole.log('createByDefault: ', service);\n\t\tconsole.log('try to upload just for the test');\n\t}\n}","import {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Menu, MenuItem} from 'main.popup';\nimport {Loader} from 'main.loader';\n\nexport default class Item extends EventEmitter\n{\n\ttrackedObjectId: Number;\n\tobjectId: ?Number;\n\tdata: Object = {};\n\tpopupMenuItem: ?MenuItem;\n\n\tconstructor(trackedObjectId, itemData)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('Disk:Documents:');\n\t\tthis.trackedObjectId = trackedObjectId;\n\t\tthis.data = Object.assign({}, itemData);\n\t\tthis.data['className'] = (this.data['className'] || '') + ' disk-folder-list-context-menu-item';\n\t\tif (!this.data['text'])\n\t\t{\n\t\t\tthis.data['text'] = this.data['id'];\n\t\t}\n\t\tthis.objectId = this.data['objectId'];\n\t\tdelete this.data['objectId'];\n\t}\n\n\tgetData(key:?string)\n\t{\n\t\tif (key)\n\t\t{\n\t\t\treturn this.data[key];\n\t\t}\n\t\treturn this.data;\n\t}\n\n\tshowError(errors)\n\t{\n\t\tconsole.log('errors: ', errors);\n\t}\n\n\taddPopupMenuItem(popupMenu: Menu)\n\t{\n\t\tthis.popupMenuItem = popupMenu.addMenuItem(this.data);\n\t}\n\n\tshowLoad()\n\t{\n\t\tif (this.popupMenuItem)\n\t\t{\n\t\t\tthis.loader = (this.loader || new Loader({target: this.popupMenuItem.getContainer(), size: 32}));\n\t\t\tthis.loader.show();\n\t\t}\n\t}\n\n\thideLoad()\n\t{\n\t\tif (this.loader)\n\t\t{\n\t\t\tthis.loader.hide();\n\t\t}\n\t}\n\tstatic detect(itemData)\n\t{\n\t\treturn true;\n\t}\n}\n","import Item from './item';\n\nexport default class ItemHistory extends Item\n{\n\tconstructor(trackedObjectId, itemData)\n\t{\n\t\tsuper(trackedObjectId, itemData);\n\n\t\tthis.object = {\n\t\t\tid: itemData.dataset.objectId,\n\t\t\tfileHistoryUrl: itemData.dataset.fileHistoryUrl,\n\t\t\tname: itemData.dataset.objectName,\n\t\t\tblockedByFeature: itemData.dataset.blockedByFeature,\n\t\t};\n\n\t\tthis.data.onclick = this.handleClick.bind(this);\n\t}\n\n\thandleClick()\n\t{\n\t\tthis.emit('close');\n\n\t\tif (this.object.blockedByFeature)\n\t\t{\n\t\t\ttop.BX.UI.InfoHelper.show('limit_office_version_storage');\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst fileHistoryUrl = this.object.fileHistoryUrl;\n\t\tBX.SidePanel.Instance.open(fileHistoryUrl, {\n\t\t\tcacheable: false,\n\t\t\tallowChangeHistory: false,\n\t\t});\n\t}\n\n\tstatic detect(itemData): boolean\n\t{\n\t\treturn itemData.id === 'history';\n\t}\n}\n","import {Type} from 'main.core';\nimport Item from './item';\nimport Backend from '../backend';\n\nexport default class ItemOpen extends Item\n{\n\tconstructor(objectId, itemData)\n\t{\n\t\tsuper(objectId, itemData);\n\t\tthis.data['dataset'] = (this.data['dataset'] || {});\n\t\tthis.data['dataset']['preventCloseContextMenu'] = true;\n\t\tthis.data['onclick'] = function() {\n\t\t\tif (this.data['href'])\n\t\t\t{\n\t\t\t\treturn this.open();\n\t\t\t}\n\t\t\tthis.showLoad();\n\t\t\tBackend\n\t\t\t\t.getMenuOpenAction(this.objectId)\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tthis.hideLoad();\n\t\t\t\t\tthis.data['href'] = data;\n\t\t\t\t\tthis.open();\n\t\t\t\t})\n\t\t\t\t.catch(({errors}) => {\n\t\t\t\t\tthis.hideLoad();\n\t\t\t\t\tthis.showError(errors);\n\t\t\t\t})\n\t\t}.bind(this);\n\t}\n\n\topen()\n\t{\n\t\tif (Type.isStringFilled(this.data['href']))\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(this.data['href']);\n\t\t\tthis.emit('close');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showError([{text: 'Empty href'}])\n\t\t}\n\t}\n\n\tstatic detect(itemData)\n\t{\n\t\treturn itemData['id'] === 'open';\n\t}\n}\n\n","import {Type} from 'main.core';\nimport Item from './item';\nimport 'clipboard';\n\nexport default class ItemShareSection extends Item\n{\n\tconstructor(objectId, itemData)\n\t{\n\t\tsuper(objectId, itemData);\n\t\tthis.data['dataset'] = (this.data['dataset'] || {});\n\t\tthis.data['dataset']['preventCloseContextMenu'] = true;\n\t}\n\n\tstatic detect(itemData)\n\t{\n\t\treturn itemData['id'] === 'share-section';\n\t}\n}\n\n","import {MenuItem} from 'main.popup';\nimport Item from './item';\nimport 'clipboard';\n\nexport default class ItemInternalLink extends Item\n{\n\tconstructor(trackedObjectId, itemData)\n\t{\n\t\tsuper(trackedObjectId, itemData);\n\t\tthis.data['className'] += ' disk-documents-grid-actions-copy-internal-link';\n\t\tthis.data['html'] = [\n\t\t\tthis.data.text,\n\t\t\t'<span class=\"disk-documents-grid-actions-copy-internal-link-icon\">' +\n\t\t\t\t'<span class=\"disk-documents-grid-actions-copy-internal-link-icon-inner\">' +\n\t\t\t\t'</span>' +\n\t\t\t'</span>'\n\t\t].join('');\n\t\tdelete this.data['text'];\n\n\t\tthis.data['dataset'] = (this.data['dataset'] || {});\n\t\tthis.data['dataset']['preventCloseContextMenu'] = true;\n\t\tthis.data['onclick'] = function(event, menuItem: MenuItem) {\n\t\t\tconst target = menuItem.getLayout().item;\n\t\t\ttarget.classList.add('menu-popup-item-accept', 'disk-folder-list-context-menu-item-accept-animate');\n\t\t\ttarget.style.minWidth = (target.offsetWidth) + 'px';\n\t\t\tconst textNode = target.querySelector('.menu-popup-item-text');\n\t\t\tif (textNode)\n\t\t\t{\n\t\t\t\ttextNode.textContent = this.data['dataset']['textCopied'];\n\t\t\t}\n\t\t\tBX.clipboard.copy(this.data['dataset']['internalLink']);\n\t\t}.bind(this);\n\t}\n\n\tstatic detect(itemData)\n\t{\n\t\treturn itemData['id'] === 'internalLink';\n\t}\n}\n\n","import Item from './item';\nimport {ExternalLinkForTrackedObject} from 'disk.external-link';\nexport default class ItemExternalLink extends Item\n{\n\tconstructor(objectId, itemData)\n\t{\n\t\tsuper(objectId, itemData);\n\n\t\tconst shouldBlockFeature = itemData['dataset']['shouldBlockFeature']\n\t\tconst blocker = itemData['dataset']['blocker'];\n\n\t\tthis.data['onclick'] = function() {\n\t\t\tthis.emit('close');\n\n\t\t\tif (shouldBlockFeature && blocker)\n\t\t\t{\n\t\t\t\teval(blocker);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tExternalLinkForTrackedObject.showPopup(this.trackedObjectId);\n\t\t}.bind(this);\n\t}\n\n\tstatic detect(itemData)\n\t{\n\t\treturn itemData['id'] === 'externalLink';\n\t}\n}","import {Text} from 'main.core';\nimport {Options as GridOptions} from '../options';\nimport Item from './item';\nimport Backend from \"../backend\";\n\nexport default class ItemRename extends Item\n{\n\tbuffExtension:string = '';\n\n\tconstructor(trackedObjectId, itemData)\n\t{\n\t\tsuper(trackedObjectId, itemData);\n\n\t\tif (!this.data['onclick'])\n\t\t{\n\t\t\tthis.data['onclick'] = this.rename.bind(this);\n\t\t}\n\t}\n\n\tcutExtension(name: string): string\n\t{\n\t\tthis.buffExtension = '';\n\t\tif (name.lastIndexOf('.') > 0)\n\t\t{\n\t\t\tthis.buffExtension = name.substr(name.lastIndexOf('.'));\n\t\t\treturn name.substr(0, name.lastIndexOf('.'));\n\t\t}\n\t\treturn name;\n\t}\n\n\trestoreExtension(name: string): string\n\t{\n\t\tname += this.buffExtension;\n\t\tthis.buffExtension = '';\n\t\treturn name;\n\t}\n\n\trename()\n\t{\n\t\tconst grid = BX.Main.gridManager\n\t\t\t.getInstanceById(GridOptions.getGridId());\n\n\t\tconst row = grid\n\t\t\t.getRows()\n\t\t\t.getById(this.trackedObjectId);\n\t\trow.edit();\n\n\t\tconst editorContainer = BX.Grid.Utils.getByClass(\n\t\t\trow.getNode(), 'main-grid-editor-container', true);\n\t\tconst input = editorContainer.querySelector('input');\n\n\t\tif (input)\n\t\t{\n\t\t\tinput.value = this.cutExtension(input.value);\n\t\t\tconst onBlur = function(event) {\n\t\t\t\tonBeforeSend(event);\n\t\t\t}.bind(this);\n\n\t\t\tconst onBeforeSend = (event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tconst fullName = this.restoreExtension(input.value);\n\t\t\t\tBackend\n\t\t\t\t\t.renameAction(this.trackedObjectId, fullName)\n\t\t\t\t\t.then(({data: {object: {name}}}) => {\n\t\t\t\t\t\tif (fullName !== name)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trow.getNode().querySelector('#disk_obj_' + this.trackedObjectId).innerHTML = Text.encode(name);\n\t\t\t\t\t\t\trow.editData['NAME'] = name;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\tinput.removeEventListener('blur', onBlur);\n\t\t\t\trow.getNode().querySelector('#disk_obj_' + this.trackedObjectId).innerHTML = Text.encode(fullName);\n\t\t\t\trow.editData['NAME'] = fullName;\n\n\t\t\t\trow.editCancel();\n\t\t\t};\n\n\t\t\tinput.addEventListener('keydown', function(event) {\n\t\t\t\tif(event.key === 'Enter')\n\t\t\t\t{\n\t\t\t\t\tonBeforeSend(event);\n\t\t\t\t}\n\t\t\t\telse if(event.key === 'Escape')\n\t\t\t\t{\n\t\t\t\t\tinput.removeEventListener('blur', onBlur);\n\t\t\t\t\trow.editCancel();\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t\tinput.addEventListener('blur', onBlur);\n\t\t\tBX.focus(input);\n\t\t}\n\t}\n\n\tstatic detect(itemData)\n\t{\n\t\treturn itemData['id'] === 'rename';\n\t}\n}\n\n","import Item from './item';\nimport {LegacyPopup, SharingControlType} from \"disk.sharing-legacy-popup\";\n\nexport default class ItemSharing extends Item\n{\n\tconstructor(trackedObjectId, itemData)\n\t{\n\t\tsuper(trackedObjectId, itemData);\n\n\t\tconst object = {\n\t\t\tid: itemData['dataset']['objectId'],\n\t\t\tname: itemData['dataset']['objectName'],\n\t\t}\n\n\t\tthis.data['onclick'] = () => {\n\t\t\tthis.emit('close');\n\n\t\t\tswitch (this.data['dataset']['type'])\n\t\t\t{\n\t\t\t\tcase SharingControlType.WITH_CHANGE_RIGHTS:\n\t\t\t\t\t(new LegacyPopup()).showSharingDetailWithChangeRights({\n\t\t\t\t\t\tobject: object\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase SharingControlType.WITH_SHARING:\n\t\t\t\t\t(new LegacyPopup()).showSharingDetailWithChangeRights({\n\t\t\t\t\t\tobject: object\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase SharingControlType.WITHOUT_EDIT:\n\t\t\t\t\t(new LegacyPopup()).showSharingDetailWithoutEdit({\n\t\t\t\t\t\tobject: object\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic detect(itemData)\n\t{\n\t\treturn itemData['id'] === 'sharing';\n\t}\n}\n\n","import Item from './item';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport {Loc, ajax as Ajax} from \"main.core\";\nimport {Options as GridOptions} from \"../options\";\n\nexport default class ItemDelete extends Item\n{\n\tobject: {id: number, name: string};\n\n\tconstructor(trackedObjectId, itemData)\n\t{\n\t\tsuper(trackedObjectId, itemData);\n\t\tthis.object = {\n\t\t\tid: itemData['dataset']['objectId'],\n\t\t\tname: itemData['dataset']['objectName'],\n\t\t};\n\n\t\tthis.data['onclick'] = this.handleClick.bind(this);\n\t}\n\n\thandleClick()\n\t{\n\t\tthis.emit('close');\n\n\t\tMessageBox.show({\n\t\t\ttitle: Loc.getMessage('DISK_DOCUMENTS_ACT_DELETE_TITLE'),\n\t\t\tmessage: Loc.getMessage('DISK_DOCUMENTS_ACT_DELETE_MESSAGE', {\n\t\t\t\t'#NAME#': this.object.name,\n\t\t\t}),\n\t\t\tmodal: true,\n\t\t\tbuttons: BX.UI.Dialogs.MessageBoxButtons.OK_CANCEL,\n\t\t\tokCaption: Loc.getMessage('DISK_DOCUMENTS_ACT_DELETE_OK_BUTTON'),\n\t\t\tonOk: this.handleClickDelete.bind(this),\n\t\t});\n\t}\n\n\thandleClickDelete(): boolean\n\t{\n\t\tAjax.runAction('disk.api.commonActions.markDeleted', {\n\t\t\tanalyticsLabel: 'folder.list.dd',\n\t\t\tdata: {\n\t\t\t\tobjectId: this.object.id\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tif (response.status === 'success')\n\t\t\t{\n\t\t\t\tconst commonGrid = GridOptions.getCommonGrid();\n\t\t\t\tcommonGrid.removeItemById(this.trackedObjectId);\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tstatic detect(itemData)\n\t{\n\t\treturn itemData['id'] === 'delete';\n\t}\n}\n\n","import Item from './item';\nimport ItemHistory from './item-history';\nimport ItemOpen from './itemopen';\nimport ItemShareSection from './itemsharesection';\nimport ItemInternalLink from './iteminternallink';\nimport ItemExternalLink from './itemexternallink';\nimport ItemRename from './itemrename';\nimport ItemSharing from \"./item-sharing\";\nimport ItemDelete from \"./item-delete\";\n\nconst itemMappings = [\n\tItemOpen,\n\tItemShareSection,\n\tItemSharing,\n\tItemInternalLink,\n\tItemExternalLink,\n\tItemHistory,\n\tItemRename,\n\tItemDelete,\n];\n\nexport default function getMenuItem(trackedObjectId, itemData)\n{\n\tlet itemClassName = Item;\n\titemMappings.forEach((itemClass) => {\n\t\tif (itemClass.detect(itemData))\n\t\t{\n\t\t\titemClassName = itemClass;\n\t\t}\n\t});\n\n\treturn new itemClassName(trackedObjectId, itemData);\n}","import {Dom, pos} from 'main.core';\nimport {Options as GridOptions} from '../options';\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\nimport Backend from \"../backend\";\nimport getMenuItem from \"../gridmenu/index\";\n\nexport default class List\n{\n\tconstructor()\n\t{\n\t\tthis.addReloadGrid();\n\t\tthis.addMenuActionLoader();\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEventEmitter.subscribe('Disk.OnlyOffice:onSaved', this.handleDocumentSaved.bind(this));\n\t}\n\n\thandleDocumentSaved(event: BaseEvent): void\n\t{\n\t\tconst [object, documentSession] = event.getCompatData();\n\t\tconst grid = BX.Main.gridManager.getInstanceById(GridOptions.getGridId());\n\t\tconst objectNode = grid.getBody().querySelector(`span[data-object-id=\"${object.id}\"]`)\n\t\tif (!objectNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst row = objectNode.closest('.main-grid-row');\n\t\tif (!row || !row.dataset.id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst rowId = row.dataset.id;\n\t\tgrid.updateRow(rowId, null, null, () => {\n\t\t\tconst rowNode = grid.getRows().getById(rowId).getNode();\n\t\t\tif (!rowNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.addClass(rowNode, 'main-grid-row-checked');\n\t\t\tsetInterval(() => {\n\t\t\t\tDom.removeClass(rowNode, 'main-grid-row-checked');\n\t\t\t}, 8000);\n\t\t});\n\t}\n\n\taddReloadGrid()\n\t{\n\t\tBX.addCustomEvent('onPopupFileUploadClose', () => {\n\t\t\tBX.Main.gridManager\n\t\t\t\t.getInstanceById(GridOptions.getGridId())\n\t\t\t\t.reload();\n\t\t});\n\t}\n\n\taddMenuActionLoader()\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\t'onPopupFirstShow',\n\t\t\tfunction({compatData: [popup]}: BaseEvent) {\n\t\t\t\tif (popup.uniquePopupId.indexOf('menu-popup-main-grid-actions-menu-') !== 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst objectId = popup.uniquePopupId.replace(/^menu-popup-main-grid-actions-menu-/, '');\n\n\t\t\t\tpopup.getContentContainer().classList.add('disk-documents-animate');\n\t\t\t\tpopup.getContentContainer().style.height = 80 + 'px';\n\n\t\t\t\tBackend\n\t\t\t\t\t.getMenuActions(objectId)\n\t\t\t\t\t.then(function({data}) {\n\t\t\t\t\t\tconst row =  BX.Main.gridManager\n\t\t\t\t\t\t\t.getInstanceById(GridOptions.getGridId())\n\t\t\t\t\t\t\t.getRows()\n\t\t\t\t\t\t\t.getById(objectId);\n\t\t\t\t\t\tconst menu = row.getActionsMenu();\n\n\t\t\t\t\t\trow.actions = [];\n\t\t\t\t\t\tconst prepareActionMenu = (item, index, ar) => {\n\t\t\t\t\t\t\tif (item['items'])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem['items'].forEach(prepareActionMenu)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst menuItem = getMenuItem(objectId, item);\n\t\t\t\t\t\t\tmenuItem.subscribe('close', () => {\n\t\t\t\t\t\t\t\trow.closeActionsMenu();\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (ar === data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmenuItem.addPopupMenuItem(menu);\n\t\t\t\t\t\t\t\trow.actions.push(menuItem.getData());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tar[index] = menuItem.getData();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tpopup.getContentContainer().style.height = (data.length * 36) + 16 + 'px';\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tpopup.getContentContainer().addEventListener('transitionend', () => {\n\t\t\t\t\t\t\tpopup.getContentContainer().classList.remove('disk-documents-animate');\n\t\t\t\t\t\t\tpopup.getContentContainer().style.height = '';\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tdata.forEach(prepareActionMenu);\n\t\t\t\t\t\tif (menu)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenu.removeMenuItem('loader');\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this))\n\t\t\t\t\t.catch(function({errors})\n\t\t\t\t\t{\n\t\t\t\t\t\t//Hide Loader and show errors\n\t\t\t\t\t\tconsole.log(errors);\n\t\t\t\t\t}.bind(this));\n\t\t\t}.bind(this)\n\t\t);\n\t}\n}\n","import {Tag, Loc} from 'main.core';\nimport {Options as GridOptions} from '../options';\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\nimport Backend from \"../backend\";\nimport getMenuItem from \"../gridmenu/index\";\n\nexport default class Tile\n{\n\tconstructor()\n\t{\n\t\tthis.addReloadGrid();\n\t\tthis.addMenuActionLoader();\n\t\tthis.addFilterSequence();\n\t}\n\n\taddFilterSequence()\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Main.Filter:apply',\n\t\t\tfunction({compatData: [filterId, data, filter, promise, params]}: BaseEvent)\n\t\t\t{\n\t\t\t\tif (filterId === GridOptions.getFilterId())\n\t\t\t\t{\n\t\t\t\t\tpromise.then(function () {\n\t\t\t\t\t\tBX.Main.tileGridManager\n\t\t\t\t\t\t\t.getInstanceById(GridOptions.getGridId())\n\t\t\t\t\t\t\t.reload();\n\t\t\t\t\t}.bind(this));\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\taddReloadGrid()\n\t{\n\t\tBX.addCustomEvent('onPopupFileUploadClose', () => {\n\t\t\tBX.Main.tileGridManager\n\t\t\t\t.getInstanceById(GridOptions.getGridId())\n\t\t\t\t.reload();\n\t\t});\n\t}\n\n\taddMenuActionLoader()\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\t'Disk:Documents:TileGrid:MenuAction:FirstShow',\n\t\t\tfunction({compatData: [row, objectId, menuPopup]}: BaseEvent) {\n\t\t\t\tBackend\n\t\t\t\t\t.getMenuActions(objectId)\n\t\t\t\t\t.then(function({data}) {\n\t\t\t\t\t\tconst menu = menuPopup;\n\t\t\t\t\t\trow.actions = [];\n\t\t\t\t\t\tconst prepareActionMenu = (item, index, ar) => {\n\t\t\t\t\t\t\tif (item['items'])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem['items'].forEach(prepareActionMenu)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (item['id'] === 'rename')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem['onclick'] = row.onRename.bind(row);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst menuItem = getMenuItem(objectId, item);\n\t\t\t\t\t\t\tmenuItem.subscribe('close', () => {\n\t\t\t\t\t\t\t\tmenu.close();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (ar === data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmenuItem.addPopupMenuItem(menu);\n\t\t\t\t\t\t\t\trow.actions.push(menuItem.getData());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tar[index] = menuItem.getData();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdata.forEach(prepareActionMenu);\n\n\t\t\t\t\t\tif (menu)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenu.removeMenuItem('loader');\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this))\n\t\t\t\t\t.catch(function({errors})\n\t\t\t\t\t{\n\t\t\t\t\t\t//Hide Loader and show errors\n\t\t\t\t\t\tconsole.log(errors);\n\t\t\t\t\t}.bind(this));\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tstatic generateEmptyBlock()\n\t{\n\t\treturn Tag.render`\n\t\t<div class=\"disk-folder-list-no-data-inner\">\n\t\t\t<div class=\"disk-folder-list-no-data-inner-message\">\n\t\t\t\t${Loc.getMessage('DISK_DOCUMENTS_GRID_TILE_EMPTY_BLOCK_TITLE')}\n\t\t\t</div>\n\t\t\t<div class=\"disk-folder-list-no-data-inner-variable\">\n\t\t\t\t<div class=\"disk-folder-list-no-data-inner-create-file\" onmouseover=\"BX.onCustomEvent(window, 'onDiskUploadPopupShow', [this]);\">\n\t\t\t\t\t${Loc.getMessage('DISK_DOCUMENTS_GRID_TILE_EMPTY_BLOCK_UPLOAD')}</div>\n\t\t\t</div>\n\t\t</div>`;\n\t}\n}","import {Sharing} from './fields/sharing';\nimport {ExternalLink} from './fields/externallink';\nimport Toolbar from './toolbar';\nimport GridList from './grid/list';\nimport GridTile from './grid/tile';\nimport {Options as GridOptions, Options} from './options';\nimport {Ears} from 'ui.ears';\nimport {EventEmitter} from 'main.core.events';\nimport Backend from './backend';\n\nfunction showShared(objectId, node) {\n\tnew Sharing(objectId, node);\n}\n\nfunction showExternalLink(objectId, node) {\n\tnew ExternalLink(objectId, node);\n}\n\nconst TileGridEmptyBlockGenerator = GridTile.generateEmptyBlock;\nexport {\n\tshowExternalLink,\n\tshowShared,\n\tToolbar,\n\tOptions,\n\tTileGridEmptyBlockGenerator,\n\tBackend\n}\n\n//Template things\nBX.ready(() => {\n\tif (BX.Main.gridManager && BX.Main.gridManager\n\t\t.getInstanceById(GridOptions.getGridId()))\n\t{\n\t\tnew GridList;\n\t}\n\telse if (BX.Main.tileGridManager && BX.Main.tileGridManager\n\t\t.getInstanceById(GridOptions.getGridId()))\n\t{\n\t\tnew GridTile;\n\t}\n\telse\n\t{\n\t\tEventEmitter.subscribeOnce(EventEmitter.GLOBAL_TARGET, 'Grid::ready', ({compatData: [instance]}) => {\n\t\t\tif (instance && instance.getId() === GridOptions.getGridId())\n\t\t\t{\n\t\t\t\tnew GridList;\n\t\t\t}\n\t\t});\n\t\tEventEmitter.subscribeOnce(EventEmitter.GLOBAL_TARGET, 'BX.TileGrid.Grid:initialized', ({compatData: [instance]}) => {\n\t\t\tif (instance && instance.getId() === GridOptions.getGridId())\n\t\t\t{\n\t\t\t\tnew GridTile;\n\t\t\t}\n\t\t});\n\t}\n\n\tif (document.querySelector('#disk-documents-control-panel'))\n\t{\n\t\tconst ears = new Ears({\n\t\t\tcontainer: document.querySelector('#disk-documents-control-panel'),\n\t\t\tnoScrollbar: false,\n\t\t\tclassName: 'disk-documents-ears'\n\t\t});\n\t\tears.init();\n\t}\n\n\tconst func = (id, uploader) => {\n\t\tuploader.limits[\"uploadFileExt\"] = Options.getEditableExt().join(',');\n\t\tuploader.limits[\"uploadFile\"] = '.' + Options.getEditableExt().join(',.');\n\t\tif (uploader.fileInput)\n\t\t{\n\t\t\tuploader.fileInput.accept = uploader.limits[\"uploadFile\"];\n\t\t}\n\t}\n\tif (BX.UploaderManager && BX.UploaderManager.getById('DiskDocuments'))\n\t{\n\t\tfunc('DiskDocuments', BX.UploaderManager.getById('DiskDocuments'));\n\t}\n\telse\n\t{\n\t\tconst listener = ({compatData: [id, uploader]}) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tfunc(id, uploader)\n\t\t\t}, 200);\n\t\t\tEventEmitter.unsubscribe(EventEmitter.GLOBAL_TARGET, 'onUploaderIsInited', listener);\n\t\t};\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'onUploaderIsInited', listener);\n\t}\n});"],"names":["intersectionObserver","observeIntersection","entity","callback","IntersectionObserver","entries","forEach","entry","isIntersecting","unobserve","target","observedCallback","setTimeout","threshold","observe","BackendInner","Runtime","debounce","requestData","idsForShared","idsForExternalLinks","request","action","hasOwnProperty","id","push","ajax","runComponentAction","Backend","component","mode","data","trackedObjectIds","then","errors","Promise","resolve","reject","sendForInfo","trackedObjectId","analyticsLabel","newName","runAction","objectId","Sharing","node","init","actionName","showLoading","hideLoading","renderData","errorMessages","error","message","innerHTML","join","loader","Loader","size","show","dataset","bxLoading","hide","res","Users","placeInGrid","appendChild","getContainer","ExternalLink","ExternalLinkForTrackedObject","CommonGrid","options","gridInstance","getId","isTile","BX","TileGrid","Grid","isGrid","tableFade","setFadeContainer","getLoader","showLoader","tableUnfade","unSetFadeContainer","getRows","getSelectedIds","getSelectedItems","map","item","getBodyChild","row","items","length","countItems","url","promise","reloadTable","fulfill","reload","itemId","getById","getActionsMenu","getItem","contentNode","easing","duration","start","scroll","window","pageYOffset","document","documentElement","scrollTop","finish","pos","top","transition","makeEaseOut","transitions","quart","step","state","scrollTo","animate","menuItemId","getItemById","actions","getActions","i","fireEvent","removeRow","removeItem","select","selectItem","removeSelected","column","sortByColumn","Options","gridId","getGridId","Reflection","getClass","Main","gridManager","getInstanceById","tileGridManager","filterId","editableExt","extensions","userOptions","save","location","Toolbar","rowId","commonGrid","GridOptions","getCommonGrid","documentType","service","Disk","Document","Local","Instance","isEnabled","createFile","type","response","reloadGridAndFocus","object","createProcess","CreateProcess","typeFile","serviceCode","onAfterSave","status","getDocumentService","isAvailableOnlyOffice","InformationPopups","openWindowForSelectDocumentService","code","resolveServiceCode","runCreating","console","log","Item","itemData","setEventNamespace","Object","assign","key","popupMenu","popupMenuItem","addMenuItem","EventEmitter","ItemHistory","fileHistoryUrl","name","objectName","blockedByFeature","onclick","handleClick","bind","emit","UI","InfoHelper","SidePanel","open","cacheable","allowChangeHistory","ItemOpen","showLoad","getMenuOpenAction","hideLoad","showError","Type","isStringFilled","text","ItemShareSection","ItemInternalLink","event","menuItem","getLayout","classList","add","style","minWidth","offsetWidth","textNode","querySelector","textContent","clipboard","copy","ItemExternalLink","shouldBlockFeature","blocker","eval","showPopup","ItemRename","rename","buffExtension","lastIndexOf","substr","grid","edit","editorContainer","Utils","getByClass","getNode","input","value","cutExtension","onBlur","onBeforeSend","stopPropagation","preventDefault","fullName","restoreExtension","renameAction","Text","encode","editData","removeEventListener","editCancel","addEventListener","focus","ItemSharing","SharingControlType","WITH_CHANGE_RIGHTS","LegacyPopup","showSharingDetailWithChangeRights","WITH_SHARING","WITHOUT_EDIT","showSharingDetailWithoutEdit","ItemDelete","MessageBox","title","Loc","getMessage","modal","buttons","Dialogs","MessageBoxButtons","OK_CANCEL","okCaption","onOk","handleClickDelete","Ajax","removeItemById","itemMappings","getMenuItem","itemClassName","itemClass","detect","List","addReloadGrid","addMenuActionLoader","bindEvents","subscribe","handleDocumentSaved","getCompatData","documentSession","objectNode","getBody","closest","updateRow","rowNode","Dom","addClass","setInterval","removeClass","addCustomEvent","compatData","popup","uniquePopupId","indexOf","replace","getContentContainer","height","getMenuActions","menu","prepareActionMenu","index","ar","closeActionsMenu","addPopupMenuItem","getData","remove","removeMenuItem","Tile","addFilterSequence","filter","params","getFilterId","menuPopup","onRename","close","Tag","render","showShared","showExternalLink","TileGridEmptyBlockGenerator","GridTile","generateEmptyBlock","ready","GridList","subscribeOnce","GLOBAL_TARGET","instance","ears","Ears","container","noScrollbar","className","func","uploader","limits","getEditableExt","fileInput","accept","UploaderManager","listener","unsubscribe"],"mappings":"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"}