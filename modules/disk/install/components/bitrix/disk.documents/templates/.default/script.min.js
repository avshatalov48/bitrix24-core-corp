this.BX=this.BX||{};this.BX.Disk=this.BX.Disk||{};(function(exports,disk_users,main_polyfill_intersectionobserver,main_loader,main_popup,clipboard,disk_externalLink,disk_sharingLegacyPopup,ui_dialogs_messagebox,main_core,ui_ears,main_core_events){"use strict";var intersectionObserver;function observeIntersection(e,t){if(!intersectionObserver){intersectionObserver=new IntersectionObserver((function(e){e.forEach((function(e){if(e.isIntersecting){intersectionObserver.unobserve(e.target);var t=e.target.observedCallback;delete e.target.observedCallback;setTimeout(t)}}))}),{threshold:0})}e.observedCallback=t;intersectionObserver.observe(e)}var BackendInner=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(BackendInner,"idsForShared",{});babelHelpers.defineProperty(BackendInner,"idsForExternalLinks",{});babelHelpers.defineProperty(BackendInner,"sendForInfo",main_core.Runtime.debounce((function(){var e={shared:BackendInner.idsForShared,externalLink:BackendInner.idsForExternalLinks};BackendInner.idsForShared={};BackendInner.idsForExternalLinks={};var t={};for(var n in e){if(e.hasOwnProperty(n)){for(var i in e[n]){if(e[n].hasOwnProperty(i)){t[i]=t[i]||[];t[i].push(n)}}}}main_core.ajax.runComponentAction(Backend.component,"getInfo",{mode:"ajax",data:{trackedObjectIds:t}}).then((function(t){var n=t.data;for(var i in e){if(e.hasOwnProperty(i)){for(var a in e[i]){if(e[i].hasOwnProperty(a)){e[i][a][0]({data:n[a][i]})}}}}}))["catch"]((function(t){var n=t.errors;for(var i in e){if(e.hasOwnProperty(i)){for(var a in e[i]){if(e[i].hasOwnProperty(a)){e[i][a][1]({errors:n})}}}}}))}),500));var Backend=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"getShared",value:function e(t){return new Promise((function(e,n){BackendInner.idsForShared[t]=[e,n];BackendInner.sendForInfo()}))}},{key:"getExternalLink",value:function e(t){return new Promise((function(e,n){BackendInner.idsForExternalLinks[t]=[e,n];BackendInner.sendForInfo()}))}},{key:"getMenuActions",value:function t(n){return main_core.ajax.runComponentAction(e.component,"getMenuActions",{mode:"ajax",data:{trackedObjectId:n},analyticsLabel:e.component+".gridMenuActions"})}},{key:"getMenuOpenAction",value:function t(n){return main_core.ajax.runComponentAction(e.component,"getMenuOpenAction",{mode:"ajax",data:{trackedObjectId:n},analyticsLabel:e.component+".gridMenuOpenAction"})}},{key:"renameAction",value:function e(t,n){return main_core.ajax.runAction("disk.api.trackedObject.rename",{data:{objectId:t,newName:n}})}}]);return e}();babelHelpers.defineProperty(Backend,"component","bitrix:disk.documents");var Sharing=function(){function e(t,n){babelHelpers.classCallCheck(this,e);this.id=t;this.node=n;this.init();this.observe()}babelHelpers.createClass(e,[{key:"init",value:function e(){this.actionName="getShared"}},{key:"observe",value:function e(){var t=this;observeIntersection(this.node,(function(){t.showLoading();Backend[t.actionName](t.id).then((function(e){var n=e.data;t.hideLoading();t.renderData(n)}),(function(e){var n=e.errors;t.hideLoading();var i=[];n.forEach((function(e){i.push(e.message)}));t.node.innerHTML="Error! "+i.join("<br>")}))}))}},{key:"showLoading",value:function e(){this.loader=this.loader||new main_loader.Loader({target:this.node,mode:"inline",size:20});this.loader.show();this.node.dataset.bxLoading="Y"}},{key:"hideLoading",value:function e(){delete this.node.dataset.bxLoading;this.loader.hide()}},{key:"renderData",value:function e(t){this.node.innerHTML="";var n=new disk_users.Users(t,null,{placeInGrid:true});this.node.appendChild(n.getContainer())}}]);return e}();var ExternalLink=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"init",value:function e(){this.actionName="getExternalLink"}},{key:"showLoading",value:function e(){}},{key:"hideLoading",value:function e(){}},{key:"renderData",value:function e(t){this.node.innerHTML="";var n=new disk_externalLink.ExternalLinkForTrackedObject(this.id,t);this.node.appendChild(n.getContainer())}}]);return t}(Sharing);var CommonGrid=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"gridInstance",null);this.gridInstance=t.gridInstance}babelHelpers.createClass(e,[{key:"getId",value:function e(){return this.gridInstance.getId()}},{key:"isGrid",value:function e(){return!this.isTile()}},{key:"isTile",value:function e(){return BX.TileGrid.Grid&&this.gridInstance instanceof BX.TileGrid.Grid}},{key:"getContainer",value:function e(){return this.gridInstance.getContainer()}},{key:"fade",value:function e(){if(this.isGrid()){this.gridInstance.tableFade()}else{this.gridInstance.setFadeContainer();this.gridInstance.getLoader();this.gridInstance.showLoader()}}},{key:"unFade",value:function e(){if(this.isGrid()){this.gridInstance.tableUnfade()}else{this.gridInstance.getLoader().hide();this.gridInstance.unSetFadeContainer()}}},{key:"getActionKey",value:function e(){return"action_button_"+this.gridInstance.getId()}},{key:"getSelectedIds",value:function e(){if(this.isGrid()){return this.gridInstance.getRows().getSelectedIds()}else{return this.gridInstance.getSelectedItems().map((function(e){return e.getId()}))}}},{key:"getIds",value:function e(){if(this.isGrid()){return this.gridInstance.getRows().getBodyChild().map((function(e){return e.getId()}))}else{return this.gridInstance.items.map((function(e){return e.id}))}}},{key:"countItems",value:function e(){if(this.isGrid()){return this.gridInstance.getRows().getBodyChild().length}else{return this.gridInstance.countItems()}}},{key:"reload",value:function e(t,n){n=n||{};if(this.isGrid()){var i=new BX.Promise;this.gridInstance.reloadTable("POST",n,(function(){i.fulfill()}),t);return i}else{return this.gridInstance.reload(t,n)}}},{key:"getActionsMenu",value:function e(t){if(this.isGrid()){return this.gridInstance.getRows().getById(t).getActionsMenu()}else{var n=this.gridInstance.getItem(t);if(n){return n.getActionsMenu()}}}},{key:"getItemById",value:function e(t){if(this.isGrid()){return this.gridInstance.getRows().getById(t)}else{return this.gridInstance.getItem(t)}}},{key:"scrollTo",value:function e(t){var n;if(this.isGrid()){var i=this.gridInstance.getRows().getById(t);if(i&&i.node){n=i.node}}else{var a=this.gridInstance.getItem(t);if(i&&i.node){n=i.getContainer()}}if(n){new BX.easing({duration:500,start:{scroll:window.pageYOffset||document.documentElement.scrollTop},finish:{scroll:BX.pos(n).top},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function e(t){window.scrollTo(0,t.scroll)}}).animate()}}},{key:"getActionById",value:function e(t,n){var i=this.getItemById(t);if(i){var a=i.getActions();for(var r=0;r<a.length;r++){if(a[r].id&&a[r].id===n){return a[r]}}}return null}},{key:"removeItemById",value:function e(t){BX.fireEvent(document,"click");if(this.isGrid()){this.gridInstance.removeRow(t)}else{var n=this.gridInstance.getItem(t);if(n){this.gridInstance.removeItem(n)}}}},{key:"selectItemById",value:function e(t){var n;if(this.isGrid()){n=this.gridInstance.getRows().getById(t);if(n){n.select()}}else{n=this.gridInstance.getItem(t);if(n){this.gridInstance.selectItem(n)}}}},{key:"removeSelected",value:function e(){if(this.isGrid()){this.gridInstance.removeSelected()}}},{key:"sortByColumn",value:function e(t){this.gridInstance.sortByColumn(t)}}]);return e}();var Options=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"getGridId",value:function t(){return e.gridId}},{key:"getCommonGrid",value:function e(){var t;var n=this.getGridId();if(main_core.Reflection.getClass("BX.Main.gridManager")&&BX.Main.gridManager.getInstanceById(n)){t=BX.Main.gridManager.getInstanceById(n)}else if(main_core.Reflection.getClass("BX.Main.tileGridManager")&&BX.Main.tileGridManager.getInstanceById(n)){t=BX.Main.tileGridManager.getInstanceById(n)}return new CommonGrid({gridInstance:t})}},{key:"setGridId",value:function t(n){e.gridId=n}},{key:"getFilterId",value:function t(){return e.filterId}},{key:"getEditableExt",value:function t(){return e.editableExt}},{key:"setEditableExt",value:function t(n){e.editableExt=n}},{key:"setViewList",value:function e(){BX.userOptions.save("disk","documents","viewMode","list");BX.userOptions.save("disk","documents","viewSize","");window.location.reload()}},{key:"setViewSmallTile",value:function e(){BX.userOptions.save("disk","documents","viewMode","tile");BX.userOptions.save("disk","documents","viewSize","m");window.location.reload()}},{key:"setViewBigTile",value:function e(){BX.userOptions.save("disk","documents","viewMode","tile");BX.userOptions.save("disk","documents","viewSize","xl");window.location.reload()}}]);return e}();babelHelpers.defineProperty(Options,"gridId","diskDocumentsGrid");babelHelpers.defineProperty(Options,"filterId","diskDocumentsFilter");babelHelpers.defineProperty(Options,"editableExt",["doc","docx","xls","xlsx","ppt","pptx","xodt"]);var Toolbar=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"reloadGridAndFocus",value:function e(t){var n=Options.getCommonGrid();n.reload()}},{key:"runCreating",value:function e(t,n){var i=this;if(BX.message("disk_restriction")){return}if(n==="l"&&BX.Disk.Document.Local.Instance.isEnabled()){BX.Disk.Document.Local.Instance.createFile({type:t}).then((function(e){i.reloadGridAndFocus(e.object.id)}));return}var a=new BX.Disk.Document.CreateProcess({typeFile:t,serviceCode:n,onAfterSave:function e(t){if(t.status==="success"){i.reloadGridAndFocus(t.object.id)}}});a.start()}},{key:"resolveServiceCode",value:function e(t){if(!t){t=BX.Disk.getDocumentService()}if(t){return t}if(BX.Disk.isAvailableOnlyOffice()){return"onlyoffice"}BX.Disk.InformationPopups.openWindowForSelectDocumentService({});return null}},{key:"createDocx",value:function e(t){var n=this.resolveServiceCode(t);if(n){this.runCreating("docx",n)}}},{key:"createXlsx",value:function e(t){var n=this.resolveServiceCode(t);if(n){this.runCreating("xlsx",n)}}},{key:"createPptx",value:function e(t){var n=this.resolveServiceCode(t);if(n){this.runCreating("pptx",n)}}},{key:"createByDefault",value:function e(t){console.log("createByDefault: ",t);console.log("try to upload just for the test")}}]);return e}();var Item=function(e){babelHelpers.inherits(t,e);function t(e,n){var i;babelHelpers.classCallCheck(this,t);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"data",{});i.setEventNamespace("Disk:Documents:");i.trackedObjectId=e;i.data=Object.assign({},n);i.data["className"]=(i.data["className"]||"")+" disk-folder-list-context-menu-item";if(!i.data["text"]){i.data["text"]=i.data["id"]}i.objectId=i.data["objectId"];delete i.data["objectId"];return i}babelHelpers.createClass(t,[{key:"getData",value:function e(t){if(t){return this.data[t]}return this.data}},{key:"showError",value:function e(t){console.log("errors: ",t)}},{key:"addPopupMenuItem",value:function e(t){this.popupMenuItem=t.addMenuItem(this.data)}},{key:"showLoad",value:function e(){if(this.popupMenuItem){this.loader=this.loader||new main_loader.Loader({target:this.popupMenuItem.getContainer(),size:32});this.loader.show()}}},{key:"hideLoad",value:function e(){if(this.loader){this.loader.hide()}}}],[{key:"detect",value:function e(t){return true}}]);return t}(main_core_events.EventEmitter);var ItemOpen=function(e){babelHelpers.inherits(t,e);function t(e,n){var i;babelHelpers.classCallCheck(this,t);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n));i.data["dataset"]=i.data["dataset"]||{};i.data["dataset"]["preventCloseContextMenu"]=true;i.data["onclick"]=function(){var e=this;if(this.data["href"]){return this.open()}this.showLoad();Backend.getMenuOpenAction(this.objectId).then((function(t){var n=t.data;e.hideLoad();e.data["href"]=n;e.open()}))["catch"]((function(t){var n=t.errors;e.hideLoad();e.showError(n)}))}.bind(babelHelpers.assertThisInitialized(i));return i}babelHelpers.createClass(t,[{key:"open",value:function e(){if(main_core.Type.isStringFilled(this.data["href"])){BX.SidePanel.Instance.open(this.data["href"]);this.emit("close")}else{this.showError([{text:"Empty href"}])}}}],[{key:"detect",value:function e(t){return t["id"]==="open"}}]);return t}(Item);var ItemShareSection=function(e){babelHelpers.inherits(t,e);function t(e,n){var i;babelHelpers.classCallCheck(this,t);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n));i.data["dataset"]=i.data["dataset"]||{};i.data["dataset"]["preventCloseContextMenu"]=true;return i}babelHelpers.createClass(t,null,[{key:"detect",value:function e(t){return t["id"]==="share-section"}}]);return t}(Item);var ItemInternalLink=function(e){babelHelpers.inherits(t,e);function t(e,n){var i;babelHelpers.classCallCheck(this,t);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n));i.data["className"]+=" disk-documents-grid-actions-copy-internal-link";i.data["html"]=[i.data.text,'<span class="disk-documents-grid-actions-copy-internal-link-icon">'+'<span class="disk-documents-grid-actions-copy-internal-link-icon-inner">'+"</span>"+"</span>"].join("");delete i.data["text"];i.data["dataset"]=i.data["dataset"]||{};i.data["dataset"]["preventCloseContextMenu"]=true;i.data["onclick"]=function(e,t){var n=t.getLayout().item;n.classList.add("menu-popup-item-accept","disk-folder-list-context-menu-item-accept-animate");n.style.minWidth=n.offsetWidth+"px";var i=n.querySelector(".menu-popup-item-text");if(i){i.textContent=this.data["dataset"]["textCopied"]}BX.clipboard.copy(this.data["dataset"]["internalLink"])}.bind(babelHelpers.assertThisInitialized(i));return i}babelHelpers.createClass(t,null,[{key:"detect",value:function e(t){return t["id"]==="internalLink"}}]);return t}(Item);var ItemExternalLink=function(_Item){babelHelpers.inherits(ItemExternalLink,_Item);function ItemExternalLink(objectId,itemData){var _this;babelHelpers.classCallCheck(this,ItemExternalLink);_this=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(ItemExternalLink).call(this,objectId,itemData));var shouldBlockFeature=itemData["dataset"]["shouldBlockFeature"];var blocker=itemData["dataset"]["blocker"];_this.data["onclick"]=function(){this.emit("close");if(shouldBlockFeature&&blocker){eval(blocker);return}disk_externalLink.ExternalLinkForTrackedObject.showPopup(this.trackedObjectId)}.bind(babelHelpers.assertThisInitialized(_this));return _this}babelHelpers.createClass(ItemExternalLink,null,[{key:"detect",value:function e(t){return t["id"]==="externalLink"}}]);return ItemExternalLink}(Item);var ItemRename=function(e){babelHelpers.inherits(t,e);function t(e,n){var i;babelHelpers.classCallCheck(this,t);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"buffExtension","");if(!i.data["onclick"]){i.data["onclick"]=i.rename.bind(babelHelpers.assertThisInitialized(i))}return i}babelHelpers.createClass(t,[{key:"cutExtension",value:function e(t){this.buffExtension="";if(t.lastIndexOf(".")>0){this.buffExtension=t.substr(t.lastIndexOf("."));return t.substr(0,t.lastIndexOf("."))}return t}},{key:"restoreExtension",value:function e(t){t+=this.buffExtension;this.buffExtension="";return t}},{key:"rename",value:function e(){var t=this;var n=BX.Main.gridManager.getInstanceById(Options.getGridId());var i=n.getRows().getById(this.trackedObjectId);i.edit();var a=BX.Grid.Utils.getByClass(i.getNode(),"main-grid-editor-container",true);var r=a.querySelector("input");if(r){r.value=this.cutExtension(r.value);var s=function(e){o(e)}.bind(this);var o=function e(n){n.stopPropagation();n.preventDefault();var a=t.restoreExtension(r.value);Backend.renameAction(t.trackedObjectId,a).then((function(e){var n=e.data.object.name;if(a!==n){i.getNode().querySelector("#disk_obj_"+t.trackedObjectId).innerHTML=main_core.Text.encode(n);i.editData["NAME"]=n}}));r.removeEventListener("blur",s);i.getNode().querySelector("#disk_obj_"+t.trackedObjectId).innerHTML=main_core.Text.encode(a);i.editData["NAME"]=a;i.editCancel()};r.addEventListener("keydown",function(e){if(e.key==="Enter"){o(e)}else if(e.key==="Escape"){r.removeEventListener("blur",s);i.editCancel()}}.bind(this));r.addEventListener("blur",s);BX.focus(r)}}}],[{key:"detect",value:function e(t){return t["id"]==="rename"}}]);return t}(Item);var ItemSharing=function(e){babelHelpers.inherits(t,e);function t(e,n){var i;babelHelpers.classCallCheck(this,t);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n));var a={id:n["dataset"]["objectId"],name:n["dataset"]["objectName"]};i.data["onclick"]=function(){i.emit("close");switch(i.data["dataset"]["type"]){case disk_sharingLegacyPopup.SharingControlType.WITH_CHANGE_RIGHTS:(new disk_sharingLegacyPopup.LegacyPopup).showSharingDetailWithChangeRights({object:a});break;case disk_sharingLegacyPopup.SharingControlType.WITH_SHARING:(new disk_sharingLegacyPopup.LegacyPopup).showSharingDetailWithChangeRights({object:a});break;case disk_sharingLegacyPopup.SharingControlType.WITHOUT_EDIT:(new disk_sharingLegacyPopup.LegacyPopup).showSharingDetailWithoutEdit({object:a});break}};return i}babelHelpers.createClass(t,null,[{key:"detect",value:function e(t){return t["id"]==="sharing"}}]);return t}(Item);var ItemDelete=function(e){babelHelpers.inherits(t,e);function t(e,n){var i;babelHelpers.classCallCheck(this,t);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n));i.object={id:n["dataset"]["objectId"],name:n["dataset"]["objectName"]};i.data["onclick"]=i.handleClick.bind(babelHelpers.assertThisInitialized(i));return i}babelHelpers.createClass(t,[{key:"handleClick",value:function e(){this.emit("close");ui_dialogs_messagebox.MessageBox.show({title:main_core.Loc.getMessage("DISK_DOCUMENTS_ACT_DELETE_TITLE"),message:main_core.Loc.getMessage("DISK_DOCUMENTS_ACT_DELETE_MESSAGE",{"#NAME#":this.object.name}),modal:true,buttons:BX.UI.Dialogs.MessageBoxButtons.OK_CANCEL,okCaption:main_core.Loc.getMessage("DISK_DOCUMENTS_ACT_DELETE_OK_BUTTON"),onOk:this.handleClickDelete.bind(this)})}},{key:"handleClickDelete",value:function e(){var t=this;main_core.ajax.runAction("disk.api.commonActions.markDeleted",{analyticsLabel:"folder.list.dd",data:{objectId:this.object.id}}).then((function(e){if(e.status==="success"){var n=Options.getCommonGrid();n.removeItemById(t.trackedObjectId)}}));return true}}],[{key:"detect",value:function e(t){return t["id"]==="delete"}}]);return t}(Item);var itemMappings=[ItemOpen,ItemShareSection,ItemSharing,ItemInternalLink,ItemExternalLink,ItemRename,ItemDelete];function getMenuItem(e,t){var n=Item;itemMappings.forEach((function(e){if(e.detect(t)){n=e}}));return new n(e,t)}var List=function(){function e(){babelHelpers.classCallCheck(this,e);this.addReloadGrid();this.addMenuActionLoader();this.bindEvents()}babelHelpers.createClass(e,[{key:"bindEvents",value:function e(){main_core_events.EventEmitter.subscribe("Disk.OnlyOffice:onSaved",this.handleDocumentSaved.bind(this))}},{key:"handleDocumentSaved",value:function e(t){var n=t.getCompatData(),i=babelHelpers.slicedToArray(n,2),a=i[0],r=i[1];var s=BX.Main.gridManager.getInstanceById(Options.getGridId());var o=s.getBody().querySelector('span[data-object-id="'.concat(a.id,'"]'));if(!o){return}var l=o.closest(".main-grid-row");if(!l||!l.dataset.id){return}var d=l.dataset.id;s.updateRow(d,null,null,(function(){var e=s.getRows().getById(d).getNode();if(!e){return}main_core.Dom.addClass(e,"main-grid-row-checked");setInterval((function(){main_core.Dom.removeClass(e,"main-grid-row-checked")}),8e3)}))}},{key:"addReloadGrid",value:function e(){BX.addCustomEvent("onPopupFileUploadClose",(function(){BX.Main.gridManager.getInstanceById(Options.getGridId()).reload()}))}},{key:"addMenuActionLoader",value:function e(){main_core_events.EventEmitter.subscribe("onPopupFirstShow",function(e){var t=babelHelpers.slicedToArray(e.compatData,1),n=t[0];if(n.uniquePopupId.indexOf("menu-popup-main-grid-actions-menu-")!==0){return}var i=n.uniquePopupId.replace(/^menu-popup-main-grid-actions-menu-/,"");n.getContentContainer().classList.add("disk-documents-animate");n.getContentContainer().style.height=80+"px";Backend.getMenuActions(i).then(function(e){var t=e.data;var a=BX.Main.gridManager.getInstanceById(Options.getGridId()).getRows().getById(i);var r=a.getActionsMenu();a.actions=[];var s=function e(n,s,o){if(n["items"]){n["items"].forEach(e)}var l=getMenuItem(i,n);l.subscribe("close",(function(){a.closeActionsMenu()}));if(o===t){l.addPopupMenuItem(r);a.actions.push(l.getData())}else{o[s]=l.getData()}};setTimeout((function(){n.getContentContainer().style.height=t.length*36+16+"px"}));n.getContentContainer().addEventListener("transitionend",(function(){n.getContentContainer().classList.remove("disk-documents-animate");n.getContentContainer().style.height=""}));t.forEach(s);if(r){r.removeMenuItem("loader")}}.bind(this))["catch"](function(e){var t=e.errors;console.log(t)}.bind(this))}.bind(this))}}]);return e}();var _templateObject;var Tile=function(){function e(){babelHelpers.classCallCheck(this,e);this.addReloadGrid();this.addMenuActionLoader();this.addFilterSequence()}babelHelpers.createClass(e,[{key:"addFilterSequence",value:function e(){main_core_events.EventEmitter.subscribe("BX.Main.Filter:apply",(function(e){var t=babelHelpers.slicedToArray(e.compatData,5),n=t[0],i=t[1],a=t[2],r=t[3],s=t[4];if(n===Options.getFilterId()){r.then(function(){BX.Main.tileGridManager.getInstanceById(Options.getGridId()).reload()}.bind(this))}}))}},{key:"addReloadGrid",value:function e(){BX.addCustomEvent("onPopupFileUploadClose",(function(){BX.Main.tileGridManager.getInstanceById(Options.getGridId()).reload()}))}},{key:"addMenuActionLoader",value:function e(){main_core_events.EventEmitter.subscribe("Disk:Documents:TileGrid:MenuAction:FirstShow",function(e){var t=babelHelpers.slicedToArray(e.compatData,3),n=t[0],i=t[1],a=t[2];Backend.getMenuActions(i).then(function(e){var t=e.data;var r=a;n.actions=[];var s=function e(a,s,o){if(a["items"]){a["items"].forEach(e)}if(a["id"]==="rename"){a["onclick"]=n.onRename.bind(n)}var l=getMenuItem(i,a);l.subscribe("close",(function(){r.close()}));if(o===t){l.addPopupMenuItem(r);n.actions.push(l.getData())}else{o[s]=l.getData()}};t.forEach(s);if(r){r.removeMenuItem("loader")}}.bind(this))["catch"](function(e){var t=e.errors;console.log(t)}.bind(this))}.bind(this))}}],[{key:"generateEmptyBlock",value:function e(){return main_core.Tag.render(_templateObject||(_templateObject=babelHelpers.taggedTemplateLiteral(['\n\t\t<div class="disk-folder-list-no-data-inner">\n\t\t\t<div class="disk-folder-list-no-data-inner-message">\n\t\t\t\t','\n\t\t\t</div>\n\t\t\t<div class="disk-folder-list-no-data-inner-variable">\n\t\t\t\t<div class="disk-folder-list-no-data-inner-create-file" onmouseover="BX.onCustomEvent(window, \'onDiskUploadPopupShow\', [this]);">\n\t\t\t\t\t',"</div>\n\t\t\t</div>\n\t\t</div>"])),main_core.Loc.getMessage("DISK_DOCUMENTS_GRID_TILE_EMPTY_BLOCK_TITLE"),main_core.Loc.getMessage("DISK_DOCUMENTS_GRID_TILE_EMPTY_BLOCK_UPLOAD"))}}]);return e}();function showShared(e,t){new Sharing(e,t)}function showExternalLink(e,t){new ExternalLink(e,t)}var TileGridEmptyBlockGenerator=Tile.generateEmptyBlock;BX.ready((function(){if(BX.Main.gridManager&&BX.Main.gridManager.getInstanceById(Options.getGridId())){new List}else if(BX.Main.tileGridManager&&BX.Main.tileGridManager.getInstanceById(Options.getGridId())){new Tile}else{main_core_events.EventEmitter.subscribeOnce(main_core_events.EventEmitter.GLOBAL_TARGET,"Grid::ready",(function(e){var t=babelHelpers.slicedToArray(e.compatData,1),n=t[0];if(n&&n.getId()===Options.getGridId()){new List}}));main_core_events.EventEmitter.subscribeOnce(main_core_events.EventEmitter.GLOBAL_TARGET,"BX.TileGrid.Grid:initialized",(function(e){var t=babelHelpers.slicedToArray(e.compatData,1),n=t[0];if(n&&n.getId()===Options.getGridId()){new Tile}}))}if(document.querySelector("#disk-documents-control-panel")){var e=new ui_ears.Ears({container:document.querySelector("#disk-documents-control-panel"),noScrollbar:false,className:"disk-documents-ears"});e.init()}var t=function e(t,n){n.limits["uploadFileExt"]=Options.getEditableExt().join(",");n.limits["uploadFile"]="."+Options.getEditableExt().join(",.");if(n.fileInput){n.fileInput.accept=n.limits["uploadFile"]}};if(BX.UploaderManager&&BX.UploaderManager.getById("DiskDocuments")){t("DiskDocuments",BX.UploaderManager.getById("DiskDocuments"))}else{var n=function e(n){var i=babelHelpers.slicedToArray(n.compatData,2),a=i[0],r=i[1];setTimeout((function(){t(a,r)}),200);main_core_events.EventEmitter.unsubscribe(main_core_events.EventEmitter.GLOBAL_TARGET,"onUploaderIsInited",e)};main_core_events.EventEmitter.subscribe(main_core_events.EventEmitter.GLOBAL_TARGET,"onUploaderIsInited",n)}}));exports.showExternalLink=showExternalLink;exports.showShared=showShared;exports.Toolbar=Toolbar;exports.Options=Options;exports.TileGridEmptyBlockGenerator=TileGridEmptyBlockGenerator;exports.Backend=Backend})(this.BX.Disk.Documents=this.BX.Disk.Documents||{},BX.Disk,BX,BX,BX.Main,BX,BX.Disk,BX.Disk.Sharing,BX.UI.Dialogs,BX,BX.UI,BX.Event);
//# sourceMappingURL=script.map.js