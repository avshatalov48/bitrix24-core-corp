BX.namespace("BX.Disk");BX.Disk.FolderToolbarClass=function(){var e=function(e){this.id=e.id;this.destFormName=e.destFormName;this.toolbarContainer=e.toolbarContainer||null;this.createBlankFileUrl=e.createBlankFileUrl;this.renameBlankFileUrl=e.renameBlankFileUrl;this.targetFolderId=e.targetFolderId;this.defaultService=e.defaultService;this.defaultServiceLabel=e.defaultServiceLabel;this.ajaxUrl="/bitrix/components/bitrix/disk.folder.toolbar/ajax.php";this.setEvents()};e.prototype.setEvents=function(){};e.prototype.emptyTrashCan=function(){BX.onCustomEvent("onEmptyTrashCan",[])};e.prototype.createFolder=function(){BX.Disk.modalWindow({modalId:"bx-disk-create-folder",title:BX.message("DISK_FOLDER_TOOLBAR_TITLE_CREATE_FOLDER"),contentClassName:"",contentStyle:{paddingTop:"30px",paddingBottom:"70px"},events:{onAfterPopupShow:function(){BX.focus(BX("disk-new-create-filename"))},onPopupClose:function(){this.destroy()}},content:[BX.create("label",{props:{className:"bx-disk-popup-label","for":"disk-new-create-filename"},children:[BX.create("span",{props:{className:"req"},text:"*"}),BX.message("DISK_FOLDER_TOOLBAR_LABEL_NAME_CREATE_FOLDER")]}),BX.create("input",{props:{id:"disk-new-create-filename",className:"bx-disk-popup-input",type:"text",value:""},style:{fontSize:"16px",marginTop:"10px"}})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CREATE_FOLDER"),className:"popup-window-button-accept",events:{click:BX.delegate(function(){var e=BX("disk-new-create-filename").value;if(!e){BX.focus(BX("disk-new-create-filename"));return}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","addFolder"),data:{targetFolderId:this.targetFolderId,name:e},onsuccess:function(e){if(!e){return}if(e.status&&e.status=="success"){document.location=BX.Disk.getUrlToShowObjectInGrid(e.folder.id)}else{BX.Disk.showModalWithStatusAction(e)}}})},this)}}),new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CLOSE"),events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})]})};e.prototype.removeShared=function(e){var i=e.item.id;var s=e.item.name;var a=e.item.avatar;var o=e.type;delete t[i];var r=BX.findChild(BX("bx-disk-popup-shared-people-list"),{attribute:{"data-dest-id":""+i+""}},true);if(r){BX.remove(r)}};var t={};var i=0;e.prototype.appendNewShared=function(e){t[e.item.id]={destFormName:this.destFormName,item:e.item,type:e.type,right:"disk_access_read"};BX.Disk.appendNewShared(e)};e.prototype.createExtendedFolder=function(){t={};BX.onCustomEvent("onCreateExtendedFolder",[])};e.prototype.createFile=function(){BX.Disk.modalWindow({modalId:"bx-disk-create-file",title:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_FILE_TITLE"),contentClassName:"tac bx-disk-create-file-big",contentStyle:{paddingTop:"30px",paddingBottom:"70px"},events:{onPopupClose:function(){BX.PopupMenu.destroy("disk_open_menu_with_services")}},content:[BX.create("div",{props:{className:"bx-disk-create-file-section"},children:[BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_FILE_TEXT")+" ",BX.create("span",{style:{cursor:"pointer"},children:[BX.create("span",{text:this.defaultServiceLabel,props:{className:"bx-disk-create-file-bdbdotted",id:"bx-disk-default-service-label"}}),BX.create("SPAN",{html:"&nbsp;"}),BX.create("span",{props:{className:"bx-disk-create-file-big-icon"}})],events:{click:BX.delegate(function(e){this.openMenuWithServices(BX("bx-disk-default-service-label"));BX.PreventDefault(e)},this)}})]}),BX.create("div",{props:{className:"bx-disk-create-file-section"},children:[BX.create("a",{text:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_TYPE_DOC"),props:{className:"bx-disk-create-file-big-icon bx-disk-create-file-big-doc"},style:{cursor:"pointer"},events:{click:BX.delegate(function(e){this.runCreatingFile("docx");BX.PreventDefault(e)},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_TYPE_XLS"),props:{className:"bx-disk-create-file-big-icon bx-disk-create-file-big-table"},style:{cursor:"pointer"},events:{click:BX.delegate(function(e){this.runCreatingFile("xlsx");BX.PreventDefault(e)},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_TYPE_PPT"),props:{className:"bx-disk-create-file-big-icon bx-disk-create-file-big-pres"},style:{cursor:"pointer"},events:{click:BX.delegate(function(e){this.runCreatingFile("pptx");BX.PreventDefault(e)},this)}})]})]})};e.prototype.openMenuWithServices=function(e){var t=new BX.CViewer({});BX.PopupMenu.show("disk_open_menu_with_services",BX(e),[{text:BX.message("DISK_FOLDER_TOOLBAR_LABEL_LOCAL_BDISK_EDIT"),className:"bx-viewer-popup-item item-b24",href:"#",onclick:BX.delegate(function(e){if(BX.CViewer.isEnableLocalEditInDesktop()){this.setEditService("l");BX.adjust(BX("bx-disk-default-service-label"),{text:BX.message("DISK_FOLDER_TOOLBAR_LABEL_LOCAL_BDISK_EDIT")});BX.PopupMenu.destroy("disk_open_menu_with_services")}else{this.helpDiskDialog()}return BX.PreventDefault(e)},t)},{text:t.getNameEditService("google"),className:"bx-viewer-popup-item item-gdocs",href:"#",onclick:BX.delegate(function(e){this.setEditService("google");BX.adjust(BX("bx-disk-default-service-label"),{text:this.getNameEditService("google")});BX.PopupMenu.destroy("disk_open_menu_with_services");return BX.PreventDefault(e)},t)},{text:t.getNameEditService("office365"),className:"bx-viewer-popup-item item-office365",href:"#",onclick:BX.delegate(function(e){this.setEditService("office365");BX.adjust(BX("bx-disk-default-service-label"),{text:this.getNameEditService("office365")});BX.PopupMenu.destroy("disk_open_menu_with_services");return BX.PreventDefault(e)},t)},{text:t.getNameEditService("skydrive"),className:"bx-viewer-popup-item item-office",href:"#",onclick:BX.delegate(function(e){this.setEditService("skydrive");BX.adjust(BX("bx-disk-default-service-label"),{text:this.getNameEditService("skydrive")});BX.PopupMenu.destroy("disk_open_menu_with_services");return BX.PreventDefault(e)},t)}],{angle:{position:"top",offset:45},autoHide:true,overlay:{opacity:.01}})};e.prototype.blockFeatures=function(){BX.PopupWindowManager.create("bx-disk-business-tools-info",null,{content:BX("bx-bitrix24-business-tools-info"),closeIcon:true,onPopupClose:function(){this.destroy()},autoHide:true,zIndex:11e3}).show()};e.prototype.runCreatingFile=function(e){if(BX.message("disk_restriction")){this.blockFeatures();return}var t=new BX.CViewer({createDoc:true});var i=t.createBlankElementByParams({targetFolderId:this.targetFolderId,docType:e,editUrl:this.createBlankFileUrl,renameUrl:this.renameBlankFileUrl});t.setCurrent(i);i.afterSuccessCreate=function(e){if(e&&e.status=="success"){if(!BX.CViewer.isLocalEditService(t.initEditService())){window.document.location=BX.Disk.getUrlToShowObjectInGrid(e.objectId)}else{window.onbeforeunload=function(){if(!window.diskUnloadCreateDoc){window.diskUnloadCreateDoc=true;setTimeout(function(){window.document.location=BX.Disk.getUrlToShowObjectInGrid(e.objectId)},250)}}}}};t.runActionByCurrentElement("create",{obElementViewer:t});try{BX.PreventDefault()}catch(s){}return false};return e}();
//# sourceMappingURL=script.map.js