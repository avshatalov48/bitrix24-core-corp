(function(){"use strict";BX.namespace("BX.Disk.Model.ExternalLink");BX.Disk.Model.ExternalLink.Input=function(t){BX.Disk.Model.Item.apply(this,arguments);this.templateId=this.templateId||"external-link-setting-input";this.externalLinkSettings=t.models.externalLinkSettings;this.externalLinkDescription=t.models.externalLinkDescription};BX.Disk.Model.ExternalLink.Input.prototype={__proto__:BX.Disk.Model.Item.prototype,constructor:BX.Disk.Model.ExternalLink.Input,getDefaultStateValues:function(){return{placeholderDescription:this.placeholderDescription.bind(this),firstRender:this.getRenderCount()===0}},renderSubItems:function(){this.externalLinkDescription.render();var t=this.getEntity(this.getContainer(),"external-link-placeholderDescription");t.parentNode.replaceChild(this.externalLinkDescription.getContainer(),t)},bindEvents:function(){var t=this.getEntity(this.getContainer(),"public-link-config");var i=this.getEntity(this.getContainer(),"copy-btn");var e=this.getEntity(this.getContainer(),"external-link-input");var n=this.getEntity(this.getContainer(),"external-link-switcher");BX.bind(t,"click",this.handleConfigButton.bind(this));BX.bind(i,"click",this.handleCopyLink.bind(this));BX.bind(e,"click",this.handleClickInput);BX.bind(n,"click",this.handleSwitcher.bind(this))},handleSwitcher:function(t){var i=t.currentTarget;var e=this.getEntity(this.getContainer(),"external-link-block");if(BX.hasClass(i,"js-disk-switcher-on")){BX.ajax.runAction("disk.api.commonActions.disableExternalLink",{data:{objectId:this.data.objectId}});this.toggleOnOff(i,e)}else{BX.ajax.runAction("disk.api.commonActions.generateExternalLink",{data:{objectId:this.data.objectId}}).then(function(t){if(!t||t.status!=="success"){return}this.setState(t.data.externalLink);this.toggleOnOff(i,e);this.render()}.bind(this))}},toggleOnOff:function(t,i){t.classList.toggle("js-disk-switcher-on");t.classList.toggle("js-disk-switcher-off");t.classList.remove("disk-switcher-on");t.classList.remove("disk-switcher-off");if(t.classList.contains("js-disk-switcher-on")){t.classList.toggle("disk-switcher-animate-to-on")}else{t.classList.toggle("disk-switcher-animate-to-off")}i.classList.toggle("disk-detail-sidebar-public-link-block-show");i.classList.toggle("disk-detail-sidebar-public-link-block-hide");i.classList.toggle("disk-public-link-block-hide");setTimeout(function(){this.adjustHeight()}.bind(this),0)},handleClickInput:function(){BX.focus(this);this.setSelectionRange(0,this.value.length)},handleCopyLink:function(t){var i=BX.getEventTarget(t);var e=i.getAttribute("for");var n=document.getElementById(e);n.select();document.execCommand("copy");if(!this.popupOuterLink){this.showCopyLinkPopup(n,BX.message("DISK_JS_EL_INPUT_LINK_COPIED"))}},showCopyLinkPopup:function(t,i){this.popupOuterLink=new BX.PopupWindow("disk-popup-copy-link",t,{className:"disk-popup-copy-link",bindPosition:{position:"top"},offsetLeft:-10,darkMode:true,angle:true,content:i});this.popupOuterLink.show();setTimeout(function(){BX.addClass(BX(this.popupOuterLink.uniquePopupId),"disk-popup-copy-link-hide")}.bind(this),2e3);setTimeout(function(){this.popupOuterLink.destroy();this.popupOuterLink=null}.bind(this),2200)},handleConfigButton:function(t){var i=this.getEntity(this.getContainer(),"external-link-config-place");this.externalLinkSettings.render();if(i){i.appendChild(this.externalLinkSettings.getContainer());var e=this.getEntity(this.getContainer(),"external-link-block");e.style.height=""}else{var n=null;if(BX.getClass("BX.SidePanel.Instance")&&BX.SidePanel.Instance.isOpen()){n=BX.SidePanel.Instance.getTopSlider().getZindex()}var s=new BX.PopupWindow("disk-detail-public-link-settings-popup",BX.getEventTarget(t),{className:"disk-detail-public-link-settings-popup",closeByEsc:true,offsetTop:-6,offsetLeft:17,zIndex:n,overlay:{backgroundColor:"rgba(0,0,0,0)"},autoHide:true,angle:true,events:{onPopupClose:function(){this.externalLinkSettings.save(function(t,i){this.setState(t)}.bind(this));s.destroy()}.bind(this)},content:this.externalLinkSettings.getContainer()});s.show()}BX.onCustomEvent("Disk.ExternalLink.Input:onShowConfig",[])},adjustHeight:function(){var t=this.getEntity(this.getContainer(),"external-link-block");if(t.classList.contains("disk-detail-sidebar-public-link-block-show")||t.classList.contains("disk-detail-properties-public-link-block-show")||t.classList.contains("disk-public-link-block-show")){var i=this.getEntity(this.getContainer(),"external-link-block-wrapper");t.style.height=i.offsetHeight+"px";t.style.opacity="1"}else{t.style.opacity="0";t.style.height="0"}if(t.classList.contains("disk-detail-sidebar-public-link-block-hide")){t.style.opacity="0";t.style.height="0"}},placeholderDescription:function(){return'<span data-entity="external-link-placeholderDescription"></span>'}}})();
//# sourceMappingURL=external-link-input.map.js