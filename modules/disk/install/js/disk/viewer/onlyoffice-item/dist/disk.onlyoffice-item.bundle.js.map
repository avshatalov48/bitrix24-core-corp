{"version":3,"file":"disk.onlyoffice-item.bundle.js","sources":["../src/onlyoffice-item.js","../src/onlyoffice-external-link-item.js"],"sourcesContent":["export default class OnlyOfficeItem extends BX.UI.Viewer.Item\n{\n\tconstructor(options)\n\t{\n\t\toptions = options || {};\n\n\t\tsuper(options);\n\t\tthis.objectId = options.objectId;\n\t\tthis.attachedObjectId = options.attachedObjectId;\n\t\tthis.versionId = options.versionId;\n\t\tthis.openEditInsteadPreview = options.openEditInsteadPreview;\n\t}\n\n\tsetController (controller: BX.UI.Viewer.Controller)\n\t{\n\t\tsuper.setController(controller);\n\n\t\tthis.controller.preload = 0;\n\t}\n\n\tenableEditInsteadPreview()\n\t{\n\t\tthis.openEditInsteadPreview = true;\n\t}\n\n\tsetPropertiesByNode (node: HTMLElement)\n\t{\n\t\tsuper.setPropertiesByNode(node);\n\n\t\tthis.objectId = node.dataset.objectId;\n\t\tthis.attachedObjectId = node.dataset.attachedObjectId;\n\t\tthis.versionId = node.dataset.versionId;\n\t\tthis.openEditInsteadPreview = node.dataset.openEditInsteadPreview;\n\t}\n\n\tloadData ()\n\t{\n\t\tconst uid = BX.util.getRandomString(16);\n\t\tBX.Disk.sendTelemetryEvent({\n\t\t\taction: 'start',\n\t\t\tuid: uid\n\t\t});\n\n\t\tBX.SidePanel.Instance.open(BX.util.add_url_param('/bitrix/services/main/ajax.php', this.getSliderQueryParameters()), {\n\t\t\twidth: '100%',\n\t\t\tcacheable: false,\n\t\t\tcustomLeftBoundary: 30,\n\t\t\tallowChangeHistory: false,\n\t\t\tdata: {\n\t\t\t\tdocumentEditor: true,\n\t\t\t\tuid: uid\n\t\t\t}\n\t\t});\n\n\t\treturn new BX.Promise();\n\t}\n\n\tgetSliderQueryParameters(): Object\n\t{\n\t\tlet action = 'disk.api.documentService.goToPreview';\n\t\tif (this.openEditInsteadPreview && BX.Disk.getDocumentService() === 'onlyoffice')\n\t\t{\n\t\t\taction = 'disk.api.documentService.goToEditOrPreview';\n\t\t}\n\n\t\treturn {\n\t\t\taction: action,\n\t\t\tserviceCode: 'onlyoffice',\n\t\t\tobjectId: this.objectId || 0,\n\t\t\tattachedObjectId: this.attachedObjectId || 0,\n\t\t\tversionId: this.versionId || 0\n\t\t}\n\t}\n}","\nexport default class OnlyofficeExternalLinkItem extends BX.UI.Viewer.Item\n{\n\tdocumentViewUrl: string;\n\n\tconstructor(options)\n\t{\n\t\toptions = options || {};\n\n\t\tsuper(options);\n\t\tthis.documentViewUrl = options.documentViewUrl;\n\t}\n\n\tsetPropertiesByNode (node: HTMLElement)\n\t{\n\t\tsuper.setPropertiesByNode(node);\n\t\tthis.documentViewUrl = node.dataset.documentViewUrl;\n\t}\n\n\tgetDocumentViewUrl(): string\n\t{\n\t\treturn this.documentViewUrl;\n\t}\n\n\tsetController (controller: BX.UI.Viewer.Controller)\n\t{\n\t\tsuper.setController(controller);\n\n\t\tthis.controller.preload = 0;\n\t}\n\n\tloadData ()\n\t{\n\t\tconst uid = BX.util.getRandomString(16);\n\t\tBX.Disk.sendTelemetryEvent({\n\t\t\taction: 'start',\n\t\t\tuid: uid\n\t\t});\n\n\t\tBX.SidePanel.Instance.open(this.getDocumentViewUrl(), {\n\t\t\twidth: '100%',\n\t\t\tcacheable: false,\n\t\t\tcustomLeftBoundary: 30,\n\t\t\tallowChangeHistory: false,\n\t\t\tdata: {\n\t\t\t\tdocumentEditor: true,\n\t\t\t\tuid: uid\n\t\t\t}\n\t\t});\n\n\t\treturn new BX.Promise();\n\t}\n}"],"names":["OnlyOfficeItem","options","objectId","attachedObjectId","versionId","openEditInsteadPreview","controller","preload","node","dataset","uid","BX","util","getRandomString","Disk","sendTelemetryEvent","action","SidePanel","Instance","open","add_url_param","getSliderQueryParameters","width","cacheable","customLeftBoundary","allowChangeHistory","data","documentEditor","Promise","getDocumentService","serviceCode","UI","Viewer","Item","OnlyofficeExternalLinkItem","documentViewUrl","getDocumentViewUrl"],"mappings":"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"}