{"version":3,"file":"disk.boards-promo-popup.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Loc, ajax } from 'main.core';\nimport {\n\tPromoVideoPopup,\n\tPromoVideoPopupTargetOptions,\n\tPromoVideoPopupEvents,\n\tPromoVideoPopupButtonPosition,\n} from 'ui.promo-video-popup';\nimport { Button } from 'ui.buttons';\nimport { Main as MainIconSet } from 'ui.icon-set.api.core';\n\nimport './style.css';\n\nexport type DiskPromoPopupOptions = {\n\ttargetOptions: PromoVideoPopupTargetOptions;\n\tboardsUrl: string,\n\tcomponentName: string,\n}\n\nexport class DiskVideoPopup\n{\n\t#promoVideoPopup: ?PromoVideoPopup = null;\n\n\tconstructor(options: DiskPromoPopupOptions): DiskVideoPopup\n\t{\n\t\tthis.targetOptions = options.targetOptions ? options.targetOptions : window;\n\t\tthis.boardsUrl = options.boardsUrl;\n\t\tthis.componentName = options.componentName;\n\t}\n\n\tgetWidth(): number\n\t{\n\t\treturn PromoVideoPopup.getWidth();\n\t}\n\n\tgetPopup(): PromoVideoPopup\n\t{\n\t\tconst language = Loc.getMessage('LANGUAGE_ID');\n\t\tconst sources = {\n\t\t\tru: '/bitrix/js/disk/boards-promo-popup/video/ru/disk-promo-ru.webm',\n\t\t\ten: '/bitrix/js/disk/boards-promo-popup/video/en/disk-promo-en.webm',\n\t\t};\n\n\t\tif (this.#promoVideoPopup === null)\n\t\t{\n\t\t\tthis.#promoVideoPopup = new PromoVideoPopup({\n\t\t\t\tvideoSrc: language === 'ru' ? sources.ru : sources.en,\n\t\t\t\tvideoContainerMinHeight: 255,\n\t\t\t\ttitle: Loc.getMessage('DISK_PROMO_VIDEO_POPUP_TITLE'),\n\t\t\t\ttext: Loc.getMessage('DISK_PROMO_VIDEO_POPUP_TEXT'),\n\t\t\t\ttargetOptions: this.targetOptions,\n\t\t\t\ticon: MainIconSet.DEMONSTRATION_GRAPHICS,\n\t\t\t\tbutton: {\n\t\t\t\t\ttext: Loc.getMessage('DISK_PROMO_VIDEO_POPUP_BUTTON'),\n\t\t\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\t\t\tsize: Button.Size.LARGE,\n\t\t\t\t\tposition: PromoVideoPopupButtonPosition.RIGHT,\n\t\t\t\t},\n\t\t\t\toffset: {\n\t\t\t\t\ttop: 50,\n\t\t\t\t\tleft: 50,\n\t\t\t\t},\n\t\t\t\tuseOverlay: true,\n\t\t\t\tautoHide: false,\n\t\t\t});\n\n\t\t\tthis.#promoVideoPopup.subscribe(PromoVideoPopupEvents.ACCEPT, () => {\n\t\t\t\tthis.setCompleted().then(() => {\n\t\t\t\t\twindow.location.href = this.boardsUrl;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.#promoVideoPopup.subscribe(PromoVideoPopupEvents.HIDE, () => {\n\t\t\t\tthis.setViewed();\n\t\t\t\tdocument.body.style.overflowY = 'scroll';\n\t\t\t});\n\t\t}\n\n\t\treturn this.#promoVideoPopup;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.getPopup().show();\n\t\tdocument.body.style.overflowY = 'hidden';\n\t}\n\n\tsetViewed(): void\n\t{\n\t\tthis.#requestToBackend('setViewed');\n\t}\n\n\tsetCompleted(): Promise\n\t{\n\t\treturn this.#requestToBackend('setCompleted');\n\t}\n\n\t#requestToBackend(action: string): Promise\n\t{\n\t\treturn ajax.runComponentAction(this.componentName, action, {\n\t\t\tmode: 'class',\n\t\t});\n\t}\n}\n"],"names":["DiskVideoPopup","options","targetOptions","window","boardsUrl","componentName","PromoVideoPopup","getWidth","language","Loc","getMessage","sources","ru","en","videoSrc","videoContainerMinHeight","title","text","icon","MainIconSet","DEMONSTRATION_GRAPHICS","button","color","Button","Color","SUCCESS","size","Size","LARGE","position","PromoVideoPopupButtonPosition","RIGHT","offset","top","left","useOverlay","autoHide","subscribe","PromoVideoPopupEvents","ACCEPT","setCompleted","then","location","href","HIDE","setViewed","document","body","style","overflowY","getPopup","show","action","ajax","runComponentAction","mode"],"mappings":";;;;;;;;;;AAAA,CAUqB;CAAA;AAQrB,KAAaA,cAAc;GAI1B,wBAAYC,OAA8B,EAC1C;KAAA;KAAA;KAAA;OAAA;OAAA,OAHqC;;KAIpC,IAAI,CAACC,aAAa,GAAGD,OAAO,CAACC,aAAa,GAAGD,OAAO,CAACC,aAAa,GAAGC,MAAM;KAC3E,IAAI,CAACC,SAAS,GAAGH,OAAO,CAACG,SAAS;KAClC,IAAI,CAACC,aAAa,GAAGJ,OAAO,CAACI,aAAa;;GAC1C;KAAA;KAAA,2BAGD;OACC,OAAOC,kCAAe,CAACC,QAAQ,EAAE;;;KACjC;KAAA,2BAGD;OAAA;OACC,IAAMC,QAAQ,GAAGC,aAAG,CAACC,UAAU,CAAC,aAAa,CAAC;OAC9C,IAAMC,OAAO,GAAG;SACfC,EAAE,EAAE,gEAAgE;SACpEC,EAAE,EAAE;QACJ;OAED,IAAI,sCAAI,wBAAsB,IAAI,EAClC;SACC,sCAAI,oBAAoB,IAAIP,kCAAe,CAAC;WAC3CQ,QAAQ,EAAEN,QAAQ,KAAK,IAAI,GAAGG,OAAO,CAACC,EAAE,GAAGD,OAAO,CAACE,EAAE;WACrDE,uBAAuB,EAAE,GAAG;WAC5BC,KAAK,EAAEP,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC;WACrDO,IAAI,EAAER,aAAG,CAACC,UAAU,CAAC,6BAA6B,CAAC;WACnDR,aAAa,EAAE,IAAI,CAACA,aAAa;WACjCgB,IAAI,EAAEC,wBAAW,CAACC,sBAAsB;WACxCC,MAAM,EAAE;aACPJ,IAAI,EAAER,aAAG,CAACC,UAAU,CAAC,+BAA+B,CAAC;aACrDY,KAAK,EAAEC,iBAAM,CAACC,KAAK,CAACC,OAAO;aAC3BC,IAAI,EAAEH,iBAAM,CAACI,IAAI,CAACC,KAAK;aACvBC,QAAQ,EAAEC,gDAA6B,CAACC;YACxC;WACDC,MAAM,EAAE;aACPC,GAAG,EAAE,EAAE;aACPC,IAAI,EAAE;YACN;WACDC,UAAU,EAAE,IAAI;WAChBC,QAAQ,EAAE;UACV,CAAC;SAEF,sCAAI,oBAAkBC,SAAS,CAACC,wCAAqB,CAACC,MAAM,EAAE,YAAM;WACnE,KAAI,CAACC,YAAY,EAAE,CAACC,IAAI,CAAC,YAAM;aAC9BtC,MAAM,CAACuC,QAAQ,CAACC,IAAI,GAAG,KAAI,CAACvC,SAAS;YACrC,CAAC;UACF,CAAC;SAEF,sCAAI,oBAAkBiC,SAAS,CAACC,wCAAqB,CAACM,IAAI,EAAE,YAAM;WACjE,KAAI,CAACC,SAAS,EAAE;WAChBC,QAAQ,CAACC,IAAI,CAACC,KAAK,CAACC,SAAS,GAAG,QAAQ;UACxC,CAAC;;OAGH,yCAAO,IAAI;;;KACX;KAAA,uBAGD;OACC,IAAI,CAACC,QAAQ,EAAE,CAACC,IAAI,EAAE;OACtBL,QAAQ,CAACC,IAAI,CAACC,KAAK,CAACC,SAAS,GAAG,QAAQ;;;KACxC;KAAA,4BAGD;OACC,2BAAI,8CAAJ,IAAI,EAAmB,WAAW;;;KAClC;KAAA,+BAGD;OACC,8BAAO,IAAI,8CAAJ,IAAI,EAAmB,cAAc;;;GAC5C;CAAA;CAQD,4BANkBG,MAAc,EAChC;GACC,OAAOC,cAAI,CAACC,kBAAkB,CAAC,IAAI,CAACjD,aAAa,EAAE+C,MAAM,EAAE;KAC1DG,IAAI,EAAE;IACN,CAAC;CACH;;;;;;;;"}