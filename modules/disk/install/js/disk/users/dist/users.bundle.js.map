{"version":3,"file":"users.bundle.js","sources":["../src/utils.js","../src/pagination.js","../src/users.js"],"sourcesContent":["import 'main.polyfill.intersectionobserver';\n\nlet intersectionObserver;\nfunction observeIntersection(entity, callback)\n{\n\tif (!intersectionObserver)\n\t{\n\t\tintersectionObserver = new IntersectionObserver(function(entries) {\n\t\t\tentries.forEach((entry) => {\n\t\t\t\tif (entry.isIntersecting)\n\t\t\t\t{\n\t\t\t\t\tintersectionObserver.unobserve(entry.target);\n\t\t\t\t\tconst observedCallback = entry.target.observedCallback;\n\t\t\t\t\tdelete entry.target.observedCallback;\n\t\t\t\t\tsetTimeout(observedCallback);\n\t\t\t\t}\n\t\t\t});\n\t\t}, {\n\t\t\tthreshold: 0\n\t\t});\n\t}\n\tentity.observedCallback = callback;\n\n\tintersectionObserver.observe(entity);\n}\n\n\nexport {\n\tobserveIntersection\n}","import {EventEmitter} from \"main.core.events\";\n\nexport default class Pagination extends EventEmitter\n{\n\tbusy: boolean = false;\n\tfinished: boolean = true;\n\tpageNumber: Number = 1;\n\tcallback: ?Function;\n\n\tconstructor(callback: ?Function)\n\t{\n\t\tsuper('disk.users');\n\t\tif (callback instanceof Function)\n\t\t{\n\t\t\tthis.finished = false;\n\t\t\tthis.callback = callback;\n\t\t}\n\t}\n\n\tisFinished()\n\t{\n\t\treturn this.finished === true;\n\t}\n\n\tgetNext(): boolean\n\t{\n\t\tif (this.busy === true || this.finished === true)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.busy = true;\n\t\tthis.callback(++this.pageNumber)\n\t\t\t.then(({data: {\n\t\t\t\tdata,\n\t\t\t\tgetPageCount,\n\t\t\t\tgetCurrentPage\n\t\t\t}, errors}) => {\n\t\t\t\tthis.emit('onGetPage', {\n\t\t\t\t\tdata,\n\t\t\t\t\tgetPageCount,\n\t\t\t\t\tgetCurrentPage\n\t\t\t\t});\n\t\t\t\tif (getCurrentPage >= getPageCount)\n\t\t\t\t{\n\t\t\t\t\tthis.finished = true;\n\t\t\t\t\tthis.emit('onEndPage', {\n\t\t\t\t\t\tgetPageCount,\n\t\t\t\t\t\tgetCurrentPage\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthis.busy = false;\n\t\t\t}, () => {\n\t\t\t\tthis.emit('onError');\n\t\t\t\tthis.busy = false;\n\n\t\t\t});\n\t}\n\n}","import {Cache, Loc, Type, Text, Tag} from \"main.core\";\nimport {Popup} from \"main.popup\";\nimport {observeIntersection} from './utils';\nimport Pagination from './pagination';\nimport {Loader} from 'main.loader';\n\ntype UserType = {\n\tid: Number,\n\tentityId: ?Number,\n\turl: ?String,\n\tavatar: ?String,\n\tname: String\n};\n\nconst repo = [];\n\nexport default class Users {\n\t/*\n\t * @test\n\t * @return {*}\n\t */\n\tstatic get(index)\n\t{\n\t\treturn repo[index > 0 ? index : 0];\n\t}\n\n\tcache = new Cache.MemoryCache();\n\tmaxCount = 3;\n\tpopup: ?Popup;\n\tpagination: Pagination;\n\tloader: ?Loader;\n\ttitle: ?String = null;\n\titems: Map = new Map();\n\toptions = {};\n\n\tconstructor(data: UserType[], paginationCallback: ?Function, options: {})\n\t{\n\t\tthis.options = options || {};\n\n\t\tdata.forEach(this.addItem.bind(this));\n\t\tthis.renderFirst();\n\n\t\tthis.pagination = new Pagination(paginationCallback);\n\t\tthis.pagination.subscribe('onGetPage', this.onGetPage.bind(this));\n\t\tthis.pagination.subscribe('onEndPage', this.onEndPage.bind(this));\n\t\trepo.push(this);\n\t}\n\n\t/**\n\t * @private\n\t */\n\taddItem(user: UserType): UserType\n\t{\n\t\tuser.id = user.id || user.entityId;\n\t\tthis.items.set(user.id, user);\n\n\t\treturn user;\n\t}\n\t/**\n\t * @private\n\t */\n\trenderFirst()\n\t{\n\t\tlet visibleCount = 0;\n\t\tconst keys = this.items.keys();\n\n\t\tlet key;\n\t\tconst usersContainer = this.getUserListContainer();\n\t\twhile (\n\t\t\t(visibleCount < this.maxCount)\n\t\t\t&&\n\t\t\t(key = keys.next().value)\n\t\t)\n\t\t{\n\t\t\tconst userNode = this.getUserContainer(this.items.get(key));\n\t\t\tif (!usersContainer.contains(userNode))\n\t\t\t{\n\t\t\t\tusersContainer.appendChild(\n\t\t\t\t\tuserNode\n\t\t\t\t);\n\t\t\t}\n\t\t\tvisibleCount++;\n\t\t}\n\n\t\tif (this.items.size > this.maxCount)\n\t\t{\n\t\t\tthis.getMoreButton().innerHTML = this.items.size - this.maxCount;\n\t\t\tthis.getMoreButton().style.display = 'flex';\n\t\t\tthis.getContainer().style.cursor = 'pointer';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getMoreButton().style.display = 'none';\n\t\t\tthis.getContainer().style.cursor = '';\n\t\t}\n\n\t\tif (this.items.size <= 0)\n\t\t{\n\t\t\tthis.getContainer().style.display = 'none';\n\t\t}\n\t\telse if (this.getContainer().style.display === 'none')\n\t\t{\n\t\t\tthis.getContainer().style.display = 'flex';\n\t\t}\n\t}\n\t/**\n\t * @private\n\t */\n\tgetUserContainer(user: UserType)\n\t{\n\t\treturn this.cache.remember('userContainer' + user['id'], () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-icon ui-icon-common-user disk-active-user-list-item\" title=\"${Text.encode(user['name'])}\">\n\t\t\t\t\t<i ${user['avatar'] ? `style=\"background: url('${encodeURI(Text.encode(user['avatar']))}') no-repeat center; background-size: cover;\" ` : ''}>\n\t\t\t\t\t</i>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\t/**\n\t * @private\n\t */\n\trenderPopupUser(user: UserType)\n\t{\n\t\tlet wrapper;\n\t\tif (user.url)\n\t\t{\n\t\t\twrapper = Tag.render`\n\t\t\t\t<a href=\"${user['url']}\" class=\"disk-active-user-popup-item\">\n\t\t\t\t</a>>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapper = Tag.render`\n\t\t\t\t<div class=\"disk-active-user-popup-item\">\n\t\t\t\t</div>>\n\t\t\t`;\n\t\t}\n\n\t\tconst userRow = Tag.render`\n\t\t\t<div class=\"ui-icon ui-icon-common-user disk-active-user-popup-icon\">\n\t\t\t\t<i ${user['avatar'] ? `style=\"background: url('${encodeURI(Text.encode(user['avatar']))}') no-repeat center; background-size: cover;\" `: ''}>\n\t\t\t\t</i>\n\t\t\t</div>\n\t\t\t<div class=\"disk-active-user-popup-name\">${Text.encode(user['name'])}</div>\n\t\t`;\n\n\t\twrapper.append(...userRow);\n\n\t\treturn wrapper;\n\t}\n\t/**\n\t * @public\n\t */\n\tgetContainer()\n\t{\n\t\tconst placeInGrid = this.options.placeInGrid || false;\n\n\t\treturn this.cache.remember('mainContainer', () => {\n\t\t\tconst style = this.items.size <= 0 ? ' style=\"display: none;\" ' : '';\n\t\t\tconst gridModifier = placeInGrid? 'disk-active-user--grid' : '';\n\n\t\t\treturn Tag.render`\n\t\t<div class=\"disk-active-user-box ${gridModifier}\" ${style} onclick=\"${this.showPopupUsers.bind(this)}\">\n\t\t\t<div class=\"disk-active-user\">\n\t\t\t\t<div class=\"disk-active-user-inner\">\n\t\t\t\t\t${this.getUserListContainer()}\n\t\t\t\t\t${this.getMoreButton()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>`\n\t\t});\n\t}\n\t/**\n\t * @private\n\t */\n\tgetUserListContainer()\n\t{\n\t\treturn this.cache.remember('users', () => {\n\t\t\treturn Tag.render`\n\t\t\t<div class=\"disk-active-user-list\"></div>`;\n\t\t});\n\t}\n\t/**\n\t * @private\n\t */\n\tgetMoreButton()\n\t{\n\t\treturn this.cache.remember('more', () => {\n\t\t\treturn Tag.render`\n\t\t<div class=\"disk-active-user-value\" style=\"display: none;\"></div>`;\n\t\t});\n\t}\n\t/**\n\t * @private\n\t */\n\tshowPopupUsers()\n\t{\n\t\tthis.getPopup().show();\n\t\tthis.items.forEach(\n\t\t\t(item) => {\n\t\t\t\tthis.getPopupUsersContainer().appendChild(this.renderPopupUser(item));\n\t\t\t}\n\t\t);\n\t}\n\t/**\n\t * @private\n\t */\n\tgetPopup()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\treturn this.popup;\n\t\t}\n\n\t\tthis.popup = new Popup({\n\t\t\tclassName: 'disk-active-user-popup',\n\t\t\tcontent: Tag.render`<div class=\"disk-active-user-popup-content disk-active-user-popup--grid\">\n\t\t\t\t${this.title ? `<div class=\"disk-active-user-popup-title\">${this.title}</div>` : ''}\n\t\t\t\t<div class=\"disk-active-user-popup-box\">\n\t\t\t\t\t<div class=\"disk-active-user-popup-inner\">\n\t\t\t\t\t\t${this.getPopupUsersContainer()}\n\t\t\t\t\t\t${this.getPopupUsersEndBlock()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`,\n\t\t\tbindElement: this.getContainer(),\n\t\t\tcloseByEsc: true,\n\t\t\tautoHide: true,\n\t\t});\n\t\tthis.popup.subscribeOnce('onAfterClose', function() {\n\t\t\tdelete this.popup;\n\t\t\tthis.cache.delete('popupUsers');\n\t\t\tthis.cache.delete('popupUsersEndBlock');\n\t\t}.bind(this));\n\t\treturn this.popup\n\t}\n\t/**\n\t * @private\n\t */\n\tgetPopupUsersContainer()\n\t{\n\t\treturn this.cache.remember('popupUsers', () => {\n\t\t\treturn document.createElement('div');\n\t\t});\n\t}\n\t/**\n\t * @private\n\t */\n\tgetPopupUsersEndBlock()\n\t{\n\t\treturn this.cache.remember('popupUsersEndBlock', () => {\n\t\t\tconst res = document.createElement('div');\n\n\t\t\tif (this.pagination.isFinished())\n\t\t\t{\n\t\t\t\treturn res;\n\t\t\t}\n\n\t\t\tconst onclick = this.getNextPage.bind(this);\n\t\t\tres.className = 'disk-active-user-popup-box-pagination-loader';\n\t\t\tres.innerHTML = Loc.getMessage('JS_DISK_USERS_PAGINATION');\n\t\t\tres.addEventListener('click', onclick);\n\t\t\tobserveIntersection(res, onclick)\n\t\t\treturn res;\n\t\t});\n\t}\n\t/**\n\t * @private\n\t */\n\tgetNextPage()\n\t{\n\t\tthis.loader = (this.loader || new Loader({target: this.getPopupUsersEndBlock(), size: 20}));\n\t\tthis.loader.show();\n\t\tthis.pagination.getNext();\n\t}\n\t/**\n\t * @private\n\t */\n\tonGetPage({data})\n\t{\n\t\tif (Type.isArray(data))\n\t\t{\n\t\t\tdata.forEach((item: UserType) => {\n\t\t\t\tconst user = this.addItem(item);\n\t\t\t\tthis.getPopupUsersContainer()\n\t\t\t\t\t.appendChild(this.renderPopupUser(user))\n\t\t\t});\n\t\t}\n\t}\n\t/**\n\t * @private\n\t */\n\tonEndPage()\n\t{\n\t\tif (this.loader)\n\t\t{\n\t\t\tthis.loader.hide();\n\t\t}\n\t\tthis.getPopupUsersEndBlock().style.display = 'none';\n\t}\n\t/**\n\t * @public\n\t */\n\taddUser(userData: UserType)\n\t{\n\t\tthis.addItem(userData);\n\t\tthis.renderFirst();\n\t}\n\n\thasUser(userId: number)\n\t{\n\t\treturn this.items.has(userId);\n\t}\n\n\tgetUser(userId: number)\n\t{\n\t\treturn this.items.get(userId);\n\t}\n\n\tforEach(fn)\n\t{\n\t\tthis.items.forEach(fn);\n\t}\n\n\t/**\n\t * @public\n\t */\n\tdeleteUser(userId)\n\t{\n\t\tif (!this.hasUser(userId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst user = this.items.get(userId);\n\t\tthis.items.delete(userId);\n\t\tif (this.cache.has('userContainer' + user['id']))\n\t\t{\n\t\t\tconst usersContainer = this.getUserListContainer();\n\t\t\tconst userNode = this.cache.get('userContainer' + userId);\n\t\t\tthis.cache.delete('userContainer' + userId)\n\n\t\t\tif (usersContainer.contains(userNode))\n\t\t\t{\n\t\t\t\tusersContainer.removeChild(userNode);\n\t\t\t}\n\t\t}\n\t\tthis.renderFirst();\n\t}\n}\n"],"names":["intersectionObserver","observeIntersection","entity","callback","IntersectionObserver","entries","forEach","entry","isIntersecting","unobserve","target","observedCallback","setTimeout","threshold","observe","Pagination","Function","finished","busy","pageNumber","then","data","getPageCount","getCurrentPage","errors","emit","EventEmitter","repo","Users","index","paginationCallback","options","Cache","MemoryCache","Map","addItem","bind","renderFirst","pagination","subscribe","onGetPage","onEndPage","push","user","id","entityId","items","set","visibleCount","keys","key","usersContainer","getUserListContainer","maxCount","next","value","userNode","getUserContainer","get","contains","appendChild","size","getMoreButton","innerHTML","style","display","getContainer","cursor","cache","remember","Tag","render","Text","encode","encodeURI","wrapper","url","userRow","append","placeInGrid","gridModifier","showPopupUsers","getPopup","show","item","getPopupUsersContainer","renderPopupUser","popup","Popup","className","content","title","getPopupUsersEndBlock","bindElement","closeByEsc","autoHide","subscribeOnce","document","createElement","res","isFinished","onclick","getNextPage","Loc","getMessage","addEventListener","loader","Loader","getNext","Type","isArray","hide","userData","userId","has","fn","hasUser","removeChild"],"mappings":"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"}