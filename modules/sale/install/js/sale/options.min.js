(function(e){if(!BX.Sale)BX.Sale={};if(BX.Sale.Options)return;BX.Sale.Options={lang:null,reqTimeIntervalId:null,reqDelay:1e3,countryPrf:"sales_zone_countries_",regionPrf:"sales_zone_regions_",cityPrf:"sales_zone_cities_",onCountrySelect:function(t){if(BX.Sale.Options.reqTimeIntervalId)e.clearInterval(BX.Sale.Options.reqTimeIntervalId);var t=t||e.event;var i=t.target||t.srcElement;var s=i.id.replace(BX.Sale.Options.countryPrf,"");var a=BX.Sale.Options.getValuesFromMultiselect(i);BX.Sale.Options.reqTimeIntervalId=e.setInterval(function(){ShowWaitWindow();BX.selectUtils.deleteAllOptions(BX(BX.Sale.Options.regionPrf+s));BX.selectUtils.deleteAllOptions(BX(BX.Sale.Options.cityPrf+s));BX.Sale.Options.getLocationRegions(a,s)},BX.Sale.Options.reqDelay)},setLocationRegions:function(e,t){if(!t)return false;var i=BX(BX.Sale.Options.regionPrf+t);if(!i)return false;BX.selectUtils.addNewOption(i,"",BX.message("SMO_LOCATION_ALL"),false,false);BX.selectUtils.addNewOption(i,"NULL",BX.message("SMO_LOCATION_NO_REGION"),false,false);BX.selectUtils.addNewOption(BX(BX.Sale.Options.cityPrf+t),"",BX.message("SMO_LOCATION_ALL"),false,false);for(var s in e)if(e.hasOwnProperty(s))BX.selectUtils.addNewOption(i,s,e[s],false,false)},getLocationRegions:function(t,i){e.clearInterval(BX.Sale.Options.reqTimeIntervalId);var s="/bitrix/services/ajax/sale/location/index.php";var a={action:"getRegionList",countryIds:t,lang:BX.Sale.Options.lang,sessid:BX.bitrix_sessid()};BX.ajax({timeout:30,method:"POST",dataType:"json",url:s,data:a,onsuccess:function(e){CloseWaitWindow();if(e&&e.DATA&&!e.ERROR)BX.Sale.Options.setLocationRegions(e.DATA,i);else if(e&&e.ERROR)alert(BX.message("SMO_LOCATION_JS_GET_DATA_ERROR")+": "+e.ERROR);else alert(BX.message("SMO_LOCATION_JS_GET_DATA_ERROR"))},onfailure:function(){CloseWaitWindow();alert(BX.message("SMO_LOCATION_JS_GET_DATA_ERROR"))}})},getValuesFromMultiselect:function(e){var t=[];for(var i=0;i<e.options.length;i++)if(e.options[i].selected==true)t.push(e.options[i].value);return t},onRegionSelect:function(t){if(BX.Sale.Options.reqTimeIntervalId)e.clearInterval(BX.Sale.Options.reqTimeIntervalId);var t=t||e.event;var i=t.target||t.srcElement;var s=i.id.replace(BX.Sale.Options.regionPrf,"");var a=BX.Sale.Options.getValuesFromMultiselect(i);var n=BX.Sale.Options.getValuesFromMultiselect(BX(BX.Sale.Options.countryPrf+s));BX.Sale.Options.reqTimeIntervalId=e.setInterval(function(){ShowWaitWindow();BX.selectUtils.deleteAllOptions(BX(BX.Sale.Options.cityPrf+s));BX.Sale.Options.getLocationCities(n,a,s)},BX.Sale.Options.reqDelay)},getLocationCities:function(t,i,s){e.clearInterval(BX.Sale.Options.reqTimeIntervalId);var a="/bitrix/services/ajax/sale/location/index.php";var n={action:"getCityList",regionIds:i,countryIds:t,lang:BX.Sale.Options.lang,sessid:BX.bitrix_sessid()};BX.ajax({timeout:30,method:"POST",dataType:"json",url:a,data:n,onsuccess:function(e){CloseWaitWindow();if(e&&e.DATA&&!e.ERROR)BX.Sale.Options.setLocationCities(e.DATA,s);else if(e&&e.ERROR)alert(BX.message("SMO_LOCATION_JS_GET_DATA_ERROR")+": "+e.ERROR);else alert(BX.message("SMO_LOCATION_JS_GET_DATA_ERROR"))},onfailure:function(){CloseWaitWindow();alert(BX.message("SMO_LOCATION_JS_GET_DATA_ERROR"))}})},setLocationCities:function(e,t){if(!t)return false;var i=BX(BX.Sale.Options.cityPrf+t);if(!i)return false;BX.selectUtils.deleteAllOptions(i);BX.selectUtils.addNewOption(i,"",BX.message("SMO_LOCATION_ALL"),false,false);for(var s in e)if(e.hasOwnProperty(s))BX.selectUtils.addNewOption(i,s,e[s],false,false)}}})(window);
//# sourceMappingURL=options.map.js