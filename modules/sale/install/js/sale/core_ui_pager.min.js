BX.ui.scrollablePager=function(e,t){this.parentConstruct(BX.ui.scrollablePager,e);BX.merge(this,{opts:{areaHeight:100,eventTimeout:100,pageRenderer:false,setTopReachedOnPage:false,setBottomReachedOnPage:false},vars:{pages:0,boundsReached:{top:false,bottom:false},prevScrollTop:false,scrollEventLock:false,pageRange:false,renderer:false},sys:{code:"pager"}});this.handleInitStack(t,BX.ui.scrollablePager,e)};BX.extend(BX.ui.scrollablePager,BX.ui.widget);BX.merge(BX.ui.scrollablePager.prototype,{init:function(){this.ctrls.pane=this.getControl("pane");this.vars.scrollEventDispatcher=BX.throttle(this.checkScrollState,this.opts.eventTimeout,this);if(this.opts.pageRenderer!==false)this.vars.renderer=this.opts.pageRenderer;else this.vars.renderer=new BX.ui.scrollablePager.renderers.native;this.vars.renderer.init({scope:this.ctrls.scope,pane:this.ctrls.pane,parent:this});this.pushFuncStack("buildUpDOM",BX.ui.scrollablePager);this.pushFuncStack("bindEvents",BX.ui.scrollablePager)},buildUpDOM:function(){var e=this.ctrls;var t=null;if(typeof this.template("pager-area")!="undefined")t=this.createNodesByTemplate("pager-area",{},true);if(t==null||!BX.type.isDomNode(t[0]))t=BX.create("div",{style:{height:parseInt(this.opts.areaHeight)+"px"}});else t=t[0];e.areas={top:{node:t,height:0},bottom:{node:BX.clone(t),height:0}};e.pool=BX.create("div");BX.append(e.areas.top.node,e.pane);BX.append(e.pool,e.pane);BX.append(e.areas.bottom.node,e.pane);this.vars.renderer.update()},bindEvents:function(){BX.addCustomEvent(this.vars.renderer,"bx-ui-pagerenderer-scroll-changed",BX.proxy(function(){this.dispatchScrollEvents()},this));this.vars.renderer.bindScrollEvents()},scrollTo:function(e,t,s){var r=this.vars;if(t)r.scrollEventLock=true;r.renderer.setScrollTop(e,s);if(t)r.scrollEventLock=false;return true},scrollToNode:function(e){},dispatchScrollEvents:function(){if(this.vars.scrollEventLock)return false;this.vars.scrollEventDispatcher()},lockScrollEvents:function(){this.vars.scrollEventLock=true},unLockScrollEvents:function(){this.vars.scrollEventLock=false},prependPage:function(e){this.addPage(e,this.vars.pageRange==false?0:this.vars.pageRange[0]-1)},appendPage:function(e){this.addPage(e,this.vars.pageRange==false?0:this.vars.pageRange[1]+1)},getFreePageNumber:function(e){if(this.vars.pageRange==false)return 0;if(e==0)return this.vars.pageRange[0]-1;if(e==1)return this.vars.pageRange[1]+1;return false},getPageCount:function(){return this.vars.pages},setTopReached:function(e){if(typeof e=="undefined")e=true;this.manageBounds(e,true)},setBottomReached:function(e){if(typeof e=="undefined")e=true;this.manageBounds(e,false)},cleanUp:function(){this.ctrls.pool.innerHTML="";this.setTopReached(false);this.setBottomReached(false);this.vars.pages=0;this.vars.pageRange=false;this.vars.renderer.update()},remove:function(){if(BX.type.isDomNode(this.ctrls.scope))this.ctrls.scope.innerHTML="";BX.unbindAll(this);this.vars.renderer.remove()},addPage:function(e,t){var s=this.vars,r=this.opts,o=this.getPageWrapper();var n=this.ctrls.scope.scrollTop;if(s.pageRange!=false){if(t!=s.pageRange[1]+1&&t!=s.pageRange[0]-1)throw new Error("Not allowed to break page range integrity")}if(r.setTopReachedOnPage!==false&&t==r.setTopReachedOnPage)this.setTopReached();if(r.setBottomReachedOnPage!==false&&t==r.setBottomReachedOnPage)this.setBottomReached();var i=s.pageRange==false||t>s.pageRange[1];if(BX.type.isString(e))o.innerHTML=e;else if(BX.type.isDomNode(e))BX.append(e,o);else if("length"in e&&e.length>0){for(var a in e){if(e.hasOwnProperty(a))if(BX.type.isDomNode(e[a]))BX.append(e[a],o)}}else return false;var l=this.vars.renderer.getScrollTop();BX[i?"append":"prepend"](o,this.ctrls.pool);if(!s.boundsReached.top&&s.pages==0){this.scrollTo(this.ctrls.areas.top.node.offsetHeight,true)}else{if(i){this.scrollTo(l,true)}else this.scrollTo(o.offsetHeight,true,+1)}this.vars.renderer.update();if(s.pageRange==false){s.pageRange=[t,t]}else{if(i)s.pageRange[1]++;else s.pageRange[0]--}s.pages++;this.dispatchScrollEvents()},checkScrollState:function(){var e=this.vars;var t=e.renderer.getScrollTop();if(t!=0&&e.prevScrollTop==t)return false;if(this.checkScrolledToTop(t)&&!e.boundsReached.top)this.fireEvent("scroll-to-top");if(this.checkScrolledToBottom(t)&&!e.boundsReached.bottom)this.fireEvent("scroll-to-bottom");e.prevScrollTop=t},getPageWrapper:function(){return BX.create("div",{props:{className:"bx-ui-"+this.sys.code+"-page-wrapper"}})},topOn:function(){this.manageBounds(false,true)},topOff:function(){this.manageBounds(true,true)},manageBounds:function(e,t){e=!!e;t=!!t;var s=this.vars,r=this.ctrls;if(t){var o=this.vars.renderer.getScrollTop();var n=!s.boundsReached.top&&e||s.boundsReached.top&&!e;if(n){var i=BX.style(r.areas.top.node,"display")=="none";var a=0;if(i){BX.show(r.areas.top.node);a=r.areas.top.node.offsetHeight}else{a=r.areas.top.node.offsetHeight;BX.hide(r.areas.top.node)}this.scrollTo(a,true,e?-1:+1)}}else BX[e?"hide":"show"](this.ctrls.areas.bottom.node);this.vars.boundsReached[t?"top":"bottom"]=e;this.vars.renderer.update()},checkFreeBottomSpace:function(){return this.vars.renderer.getScrollTop()<=this.vars.renderer.getClientHeight()},checkScrolledToTop:function(e){return e<=this.ctrls.areas.top.node.offsetHeight},checkScrolledToBottom:function(e){var t=this.ctrls;return e>=this.vars.renderer.getScrollHeight()-this.vars.renderer.getClientHeight()-t.areas.bottom.node.offsetHeight}});BX.ui.scrollablePager.renderers={"native":function(){this.opts={};this.wheelLock=false;this.init=function(e){this.opts=e};this.remove=function(){BX.unbind(this.opts.scope,"scroll",this.fireEvent);BX.unbind(this.opts.scope,"mousewheel",this.fireEvent);BX.unbind(this.opts.pane,"touchstart",this.fireEvent);BX.unbind(window,"resize",this.fireEvent);this.opts=null};this.update=function(){};this.setScrollTop=function(e,t){if(typeof e=="undefined")return false;e=parseInt(e);if(e.toString()=="NaN")return false;if(t!=1&&t!=-1)this.opts.scope.scrollTop=e;else this.opts.scope.scrollTop+=t*e};this.getScrollTop=function(){return this.opts.scope.scrollTop};this.getScrollHeight=function(){return this.opts.scope.scrollHeight};this.getClientHeight=function(){return this.opts.scope.clientHeight};this.bindScrollEvents=function(){var e=this;BX.bind(this.opts.scope,"mousewheel",function(t){var s=BX.getWheelData(t);var r=false;if(s>0&&e.getScrollTop()==0)r=true;if(s<0&&e.getScrollTop()>=e.getScrollHeight()-e.getClientHeight())r=true;if(r){BX.PreventDefault(t);BX.eventCancelBubble(t);return false}});this.fireEvent=function(t){BX.onCustomEvent(e,"bx-ui-pagerenderer-scroll-changed",[])};BX.bind(this.opts.scope,"scroll",this.fireEvent);BX.bind(this.opts.pane,"touchstart",this.fireEvent);BX.bind(window,"resize",this.fireEvent)};return this}};
//# sourceMappingURL=core_ui_pager.map.js