(function(){if(typeof BX.ui!="object")BX.ui={};BX.ui.widget=function(t){BX.merge(this,{opts:{scope:false,useSpawn:false,messages:{},controls:{},bindEvents:{},removeTemplates:true,initializeByGlobalEvent:false,globalEventScope:"document"},vars:{},ctrls:{},tmpls:{},sys:{stack:{init:[]},code:"widget",initialized:false}});this.pushFuncStack("init",BX.ui.widget);this.isUIWidget=true};BX.merge(BX.ui.widget.prototype,{preInit:function(){var t=this,e=this.opts,i=this.ctrls,s=this.sys.code;i.scope=null;if(!("querySelector"in document))throw new Error("Your browser does not support querySelector");if(!s.match(/^[a-zA-Z0-9-_]+$/))throw new Error('Only letters, digitis, "-" and "_" allowed in code')},init:function(){var t=this,e=this.ctrls,i=this.opts,s=this.sys.code;if(i.scope!==false){e.scope=BX.type.isNotEmptyString(i.scope)?BX(i.scope):i.scope;if(!BX.type.isElementNode(e.scope))throw new Error("Invalid node passed");if(i.useSpawn&&e.scope)t.tmpls["scope"]=e.scope.outerHTML;var n=e.scope.querySelectorAll('script[type="text/html"]');for(var r=0;r<n.length;r++){var o=BX.data(n[r],"template-id");if(typeof o=="string"&&o.length>0&&o.search("bx-ui-"+s)==0){o=o.replace("bx-ui-"+s+"-","");t.tmpls[o]=n[r].innerHTML;if(this.opts.removeTemplates)BX.remove(n[r])}}}if(typeof i.bindEvents=="object"){for(var r in i.bindEvents){if(i.bindEvents.hasOwnProperty(r))if(BX.type.isFunction(i.bindEvents[r]))this.bindEvent(r,i.bindEvents[r])}}i.bindEvents=null},remove:function(){if(BX.type.isDomNode(this.ctrls.scope))this.ctrls.scope.innerHTML="";BX.unbindAll(this)},getControlClassName:function(t){return"bx-ui-"+this.sys.code+"-"+t},getControl:function(t,e,i,s){if(!BX.type.isNotEmptyString(t))return null;if(BX.type.isElementNode(this.opts.controls[t]))return this.opts.controls[t];if(!this.ctrls.scope&&!searchWholeDoc)return null;var n=this.ctrls.scope;if(BX.type.isElementNode(i))n=i;var r=function(t){return!s&&t!==null||s&&t.length>0};try{var o=n[s?"querySelectorAll":"querySelector"]('[data-bx-ui-id="'+this.sys.code+"-"+t+'"]');if(r(o))return o}catch(l){}try{var o=n[s?"querySelectorAll":"querySelector"]("."+this.getControlClassName(t));if(r(o))return o}catch(l){}try{var o=n[s?"querySelectorAll":"querySelector"]("."+t);if(r(o))return o}catch(l){}try{var o=n[s?"querySelectorAll":"querySelector"](t);if(r(o))return o}catch(l){}if(o===null&&!e)throw new Error("Requested control node can not be found ("+t+")");return o},setOption:function(t,e){this.opts[t]=e},getOption:function(t){return this.opts[t]},getSysCode:function(){return this.sys.code},template:function(t,e){if(typeof e=="undefined"){return this.tmpls[t]}else{if(!BX.type.isString(e))throw new TypeError("Bad template html");this.tmpls[t]=e}},getHTMLByTemplate:function(t,e){var i=this.tmpls[t];if(!BX.type.isNotEmptyString(i)){BX.debug("template not found: "+t);return""}for(var s in e){if(!e.hasOwnProperty(s))continue;if(typeof e[s]!="undefined"&&e.hasOwnProperty(s)){var n="";if(s.toString().indexOf("=")==0){n=e[s].toString();s=s.toString().substr(1)}else n=BX.util.htmlspecialchars(e[s]).toString();var r="{{"+s.toString().toLowerCase()+"}}";if(n.search(r)>=0)n="";while(i.search(r)>=0)i=i.replace(r,n)}}return i},createNodesByTemplate:function(t,e,i){var s=this.getHTMLByTemplate(t,e);var n=this.tmpls[t];if(!BX.type.isNotEmptyString(n)){return null}n=n.replace(/^\s\s*/,"").replace(/\s\s*$/,"");var r=false;var o=false;if(n.search(/^<\s*(tr|th)[^<]*>/)>=0)r=true;else if(n.search(/^<\s*td[^<]*>/)>=0)o=true;var l=document.createElement("div");if(r||o){if(r){l.innerHTML="<table><tbody>"+s+"</tbody></table>";l=l.childNodes[0].childNodes[0]}else{l.innerHTML="<table><tbody><tr>"+s+"</tr></tbody></table>";l=l.childNodes[0].childNodes[0].childNodes[0]}}else l.innerHTML=s;if(i){var c=l.childNodes;var a=[];for(var u=0;u<c.length;u++)if(BX.type.isElementNode(c[u]))a.push(c[u]);return a}else return Array.prototype.slice.call(l.childNodes)},replaceTemplate:function(t,e){this.tmpls[t]=e},parentConstruct:function(t,e){var i=t.superclass;if(typeof i=="object")i.constructor.apply(this,[e,true])},handleInitStack:function(t,e,i){this.pushFuncStack("init",e);if(!t){BX.merge(this.opts,i);BX.ui.widget.prototype.preInit.call(this);var s=function(){if(this.sys.initialized)return;this.resolveFuncStack("init");for(var t in this.sys.stack){if(this.sys.stack.hasOwnProperty(t))if(t!="init")this.resolveFuncStack(t,true)}this.sys.initialized=true;this.fireEvent("init",[this])};if(BX.type.isString(this.opts.initializeByGlobalEvent)&&this.opts.initializeByGlobalEvent.length>0){var n=this.opts.globalEventScope=="window"?window:document;BX.addCustomEvent(n,this.opts.initializeByGlobalEvent,BX.proxy(s,this))}else s.call(this)}},pushFuncStack:function(t,e){if(BX.type.isFunction(e.prototype[t])){if(typeof this.sys.stack[t]=="undefined")this.sys.stack[t]=[];this.sys.stack[t].push({owner:e,f:e.prototype[t]})}},disableInFuncStack:function(t,e){var i=this.sys.stack[t];if(typeof i=="undefined")return;for(var s=0;s<i.length;s++){if(i[s].owner==e)i[s].f=BX.DoNothing}},resolveFuncStack:function(t,e){var i=this.sys.stack[t];if(typeof i=="undefined")return;for(var s=0;s<i.length;s++){i[s].f.call(this)}if(e)this.fireEvent(t,[this],document);this.sys.stack[t]=null},fireEvent:function(t,e,i){i=i||this;e=e||[];BX.onCustomEvent(i,"bx-ui-"+this.sys.code+"-"+t,e)},bindEvent:function(t,e){BX.addCustomEvent(this,"bx-ui-"+this.sys.code+"-"+t,e)},setCSSState:function(t,e){this.changeCSSState(t,e,true)},dropCSSState:function(t,e){this.changeCSSState(t,e,false)},changeCSSState:function(t,e,i){e=e||this.ctrls.scope;if(typeof t!="string"||t.length==0)return;BX[i?"addClass":"removeClass"](e,"bx-ui-state-"+t)},spawn:function(t,e){if(this.opts.useSpawn)BX.html(t,this.tmpls.scope);var i=BX.clone(this.opts);i.scope=t;if(BX.type.isFunction(e))e.apply(this,[i,t]);return new this.constructor(i)},getRandom:function(){return"bx"+this.sys.code+Math.floor(Math.random()*1e3+1)+Math.floor(Math.random()*1e3+1)}})})();
//# sourceMappingURL=core_ui_widget.map.js