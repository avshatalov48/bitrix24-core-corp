this.BX=this.BX||{};this.BX.Sale=this.BX.Sale||{};this.BX.Sale.PaymentPay=this.BX.Sale.PaymentPay||{};this.BX.Sale.PaymentPay.Mixins=this.BX.Sale.PaymentPay.Mixins||{};(function(e,t,a,s){"use strict";var n={methods:{prepareParamsPaymentInfo:function e(t){return{paySystem:t.get("app.paySystems",[])[0],title:t.get("app.title"),sum:t.get("payment.sumFormatted"),paid:t.get("payment.paid"),checks:t.get("payment.checks",[])}},prepareParamsPaymentProcess:function e(t){return{returnUrl:t.get("paymentProcess.returnUrl"),orderId:t.get("paymentProcess.orderId"),paymentId:t.get("paymentProcess.paymentId"),accessCode:t.get("paymentProcess.accessCode"),allowPaymentRedirect:t.get("paymentProcess.allowPaymentRedirect")}},startPayment:function e(t){if(this.loading){return false}this.loading=true;this.stages.paySystemList.selectedPaySystem=t;this.backendProvider.paySystemId=t;this.paymentProcess.start()},initPayment:function e(){this.initBackendProvider();this.initPaymentProcess()},initBackendProvider:function e(){throw new Error("Method 'initBackendProvider' must be overloaded")},initPaymentProcess:function e(){this.paymentProcess=new s.PaymentProcess({backendProvider:this.backendProvider,allowPaymentRedirect:this.paymentProcess.allowPaymentRedirect})},subscribeToGlobalEvents:function e(){var s=this;a.EventEmitter.subscribe(t.EventType.payment.reset,function(e){s.resetView(s.props)});a.EventEmitter.subscribe(t.EventType.payment.error,function(e){s.handlePaymentError(e.getData())});a.EventEmitter.subscribe(t.EventType.payment.success,function(e){s.handlePaymentSuccess(e.getData())});a.EventEmitter.subscribe(t.EventType.global.paySystemAjaxError,function(e){s.handlePaySystemAjaxError(e.getData())});a.EventEmitter.subscribe(t.EventType.global.paySystemUpdateTemplate,function(e){s.handlePaySystemUpdateTemplate(e.getData())})},handlePaymentError:function e(a){this.stages.paySystemErrors.errors=a.errors||[];this.stage=t.StageType.errors},handlePaymentSuccess:function e(a){this.stages.paySystemResult.html=a.data.html||null;this.stages.paySystemResult.fields=a.data.fields||null;this.stage=t.StageType.result},handlePaySystemAjaxError:function e(a){this.stages.paySystemErrors.errors=a||[];this.stage=t.StageType.errors},handlePaySystemUpdateTemplate:function e(t){s.VirtualForm.createFromNode(this.$el).submit()},resetView:function e(t){this.stages=this.prepareParamsStages(t);this.stage=this.setStageType(t);this.loading=false},currentPS:function e(t,a){return a.find(function(e){return e.ID===t})},prepareParamsStages:function e(t){throw new Error("Method 'initStages' must be overloaded")},setStageType:function e(t){throw new Error("Method 'setStageType' must be overloaded")}}};e.MixinMethods=n})(this.BX.Sale.PaymentPay.Mixins.Application=this.BX.Sale.PaymentPay.Mixins.Application||{},BX.Sale.PaymentPay.Const,BX.Event,BX.Sale.PaymentPay.Lib);
//# sourceMappingURL=registry.bundle.map.js