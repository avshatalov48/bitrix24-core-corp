this.BX=this.BX||{};this.BX.Sale=this.BX.Sale||{};this.BX.Sale.PaymentPay=this.BX.Sale.PaymentPay||{};(function(e,t,n){"use strict";var r=function(){function e(t){babelHelpers.classCallCheck(this,e);this.options=t||{}}babelHelpers.createClass(e,[{key:"initiatePayment",value:function e(){}},{key:"getResponse",value:function e(){}},{key:"isResponseSucceed",value:function e(){}},{key:"getPaymentGateUrl",value:function e(){}},{key:"getPaymentFormHtml",value:function e(){}},{key:"option",value:function e(t,n){return this.options.hasOwnProperty(t)?this.options[t]:n}}]);return e}();var i=function(){function e(t){babelHelpers.classCallCheck(this,e);this.form=t||null}babelHelpers.createClass(e,[{key:"submit",value:function e(){if(!this.canSubmit()){return false}if(this.isVirtual()){var t=document.createElement("div");t.style.display="none";t.append(this.form);document.body.appendChild(t)}HTMLFormElement.prototype.submit.call(this.form);return true}},{key:"canSubmit",value:function e(){return this.isValidFormObject()&&this.containsAllowedInputTypesOnly()}},{key:"isValidFormObject",value:function e(){return this.form instanceof HTMLFormElement}},{key:"containsAllowedInputTypesOnly",value:function t(){if(!this.form||!this.form.elements){return false}for(var n=0;n<this.form.elements.length;n++){if(!e.elementAllowed(this.form.elements[n])){return false}}return true}},{key:"isVirtual",value:function e(){if(this.form){return!document.body.contains(this.form)}return true}}],[{key:"createFromHtml",value:function t(n){var r=document.createElement("div");r.innerHTML=n;var i=r.querySelector("form");return new e(i)}},{key:"createFromNode",value:function t(n){if(n instanceof HTMLFormElement){return new e(n)}var r=n.querySelector("form");return new e(r)}},{key:"elementAllowed",value:function t(n){var r=e.getAllowedInputTypes();if(n instanceof HTMLInputElement){return r.indexOf(n.type)!==-1}return true}},{key:"getAllowedInputTypes",value:function e(){return["hidden","submit"]}}]);return e}();var a=function(){function e(t){babelHelpers.classCallCheck(this,e);this.options=t||{};this.backendProvider=this.option("backendProvider",null);if(!this.backendProvider||!this.backendProvider instanceof r){throw new Error("Invalid backend provider")}this.allowPaymentRedirect=this.option("allowPaymentRedirect",true)}babelHelpers.createClass(e,[{key:"start",value:function e(){var t=this;this.backendProvider.initiatePayment().then(function(){t.handleResponse()})}},{key:"handleResponse",value:function e(){if(this.backendProvider.isResponseSucceed()){var r=this.tryToRedirectUserOnPaymentGate();if(!r){t.EventEmitter.emit(n.EventType.payment.success,this.backendProvider.getResponse())}}else{t.EventEmitter.emit(n.EventType.payment.error,this.backendProvider.getResponse())}}},{key:"tryToRedirectUserOnPaymentGate",value:function e(){var t=this.backendProvider.getPaymentGateUrl();var n=this.backendProvider.getPaymentFormHtml();if(this.allowPaymentRedirect){if(t){window.location.href=t;return true}else if(n){return this.tryToAutoSubmitHtmlChunk(n)}}return false}},{key:"tryToAutoSubmitHtmlChunk",value:function e(t){return i.createFromHtml(t).submit()}},{key:"option",value:function e(t,n){return this.options.hasOwnProperty(t)?this.options[t]:n}}]);return e}();var s=function(){function e(t){babelHelpers.classCallCheck(this,e);this.settings=t}babelHelpers.createClass(e,[{key:"get",value:function e(t,n){var r=t.split(".");var i=this.settings;var a=false;r.map(function(e){if(i&&i.hasOwnProperty(e)){i=i[e];a=true}else{i=null;a=false}});return a?i:n}}]);return e}();e.AbstractBackendProvider=r;e.PaymentProcess=a;e.VirtualForm=i;e.Settings=s})(this.BX.Sale.PaymentPay.Lib=this.BX.Sale.PaymentPay.Lib||{},BX.Event,BX.Sale.PaymentPay.Const);
//# sourceMappingURL=lib.bundle.map.js