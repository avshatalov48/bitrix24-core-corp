{"version":3,"file":"user-consent.bundle.js","sources":["../src/user-consent.js"],"sourcesContent":["import {Vue} from 'ui.vue';\nimport {ajax, Tag, Event, Type} from 'main.core';\nimport {EventType, Component, RestMethod} from 'sale.checkout.const';\n\nimport './user-consent.css'\n\nVue.component('sale-checkout-view-user_consent', {\n\tprops: ['item'],\n\tmethods:\n\t\t{\n\t\t\tgetBlockHtml()\n\t\t\t{\n\t\t\t\tlet userConsent = {\n\t\t\t\t\tid: this.item.id,\n\t\t\t\t\ttitle: this.item.title,\n\t\t\t\t\tisLoaded: this.item.isLoaded,\n\t\t\t\t\tautoSave: this.item.autoSave,\n\t\t\t\t\tisChecked: this.item.isChecked,\n\t\t\t\t\tsubmitEventName: this.item.submitEventName,\n\t\t\t\t\tfields: Type.isArrayFilled(this.item.params)? JSON.stringify(this.item.params):[]\n\t\t\t\t};\n\n\t\t\t\tajax.runComponentAction(\n\t\t\t\t\tComponent.bitrixSaleOrderCheckout,\n\t\t\t\t\tRestMethod.saleEntityUserConsentRequest,\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tfields: userConsent\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\t.then((response)=>{\n\t\t\t\t\t\t\tif(\n\t\t\t\t\t\t\t\tBX.type.isPlainObject(response.data)\n\t\t\t\t\t\t\t\t&& BX.type.isNotEmptyString(response.data.html)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlet consent = response.data.html;\n\n\t\t\t\t\t\t\t\tif (BX.UserConsent !== undefined)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlet wrapper = this.$refs.consentDiv;\n\n\t\t\t\t\t\t\t\t\twrapper.appendChild(Tag.render`<div>${consent}</div>`);\n\n\t\t\t\t\t\t\t\t\tlet control = BX.UserConsent.load(wrapper);\n\n\n\t\t\t\t\t\t\t\t\tBX.addCustomEvent(\n\t\t\t\t\t\t\t\t\t\tcontrol,\n\t\t\t\t\t\t\t\t\t\tBX.UserConsent.events.accepted,\n\t\t\t\t\t\t\t\t\t\t() => Event.EventEmitter.emit(EventType.consent.accepted, {})\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tBX.addCustomEvent(\n\t\t\t\t\t\t\t\t\t\tcontrol,\n\t\t\t\t\t\t\t\t\t\tBX.UserConsent.events.refused,\n\t\t\t\t\t\t\t\t\t\t() => Event.EventEmitter.emit(EventType.consent.refused, {})\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t}\n\t\t},\n\tmounted()\n\t{\n\t\tthis.getBlockHtml();\n\t},\n\t// language=Vue\n\ttemplate: `\n\t  <div class=\"checkout-basket-section checkout-basket-section-consent\">\n\t\t<div ref=\"consentDiv\"/>\n      </div>\n\t`\n});"],"names":["Vue","component","props","methods","getBlockHtml","userConsent","id","item","title","isLoaded","autoSave","isChecked","submitEventName","fields","Type","isArrayFilled","params","JSON","stringify","ajax","runComponentAction","Component","bitrixSaleOrderCheckout","RestMethod","saleEntityUserConsentRequest","data","then","response","BX","type","isPlainObject","isNotEmptyString","html","consent","UserConsent","undefined","wrapper","$refs","consentDiv","appendChild","Tag","render","control","load","addCustomEvent","events","accepted","Event","EventEmitter","emit","EventType","refused","mounted","template"],"mappings":";;;;;;;;;;;;;;;AAMAA,WAAG,CAACC,SAAJ,CAAc,iCAAd,EAAiD;CAChDC,EAAAA,KAAK,EAAE,CAAC,MAAD,CADyC;CAEhDC,EAAAA,OAAO,EACN;CACCC,IAAAA,YADD,0BAEC;CAAA;;CACC,UAAIC,WAAW,GAAG;CACjBC,QAAAA,EAAE,EAAE,KAAKC,IAAL,CAAUD,EADG;CAEjBE,QAAAA,KAAK,EAAE,KAAKD,IAAL,CAAUC,KAFA;CAGjBC,QAAAA,QAAQ,EAAE,KAAKF,IAAL,CAAUE,QAHH;CAIjBC,QAAAA,QAAQ,EAAE,KAAKH,IAAL,CAAUG,QAJH;CAKjBC,QAAAA,SAAS,EAAE,KAAKJ,IAAL,CAAUI,SALJ;CAMjBC,QAAAA,eAAe,EAAE,KAAKL,IAAL,CAAUK,eANV;CAOjBC,QAAAA,MAAM,EAAEC,cAAI,CAACC,aAAL,CAAmB,KAAKR,IAAL,CAAUS,MAA7B,IAAsCC,IAAI,CAACC,SAAL,CAAe,KAAKX,IAAL,CAAUS,MAAzB,CAAtC,GAAuE;CAP9D,OAAlB;CAUAG,MAAAA,cAAI,CAACC,kBAAL,CACCC,6BAAS,CAACC,uBADX,EAECC,8BAAU,CAACC,4BAFZ,EAGC;CACCC,QAAAA,IAAI,EAAE;CACLZ,UAAAA,MAAM,EAAER;CADH;CADP,OAHD,EASEqB,IATF,CASO,UAACC,QAAD,EAAY;CAChB,YACCC,EAAE,CAACC,IAAH,CAAQC,aAAR,CAAsBH,QAAQ,CAACF,IAA/B,KACGG,EAAE,CAACC,IAAH,CAAQE,gBAAR,CAAyBJ,QAAQ,CAACF,IAAT,CAAcO,IAAvC,CAFJ,EAIA;CACC,cAAIC,OAAO,GAAGN,QAAQ,CAACF,IAAT,CAAcO,IAA5B;;CAEA,cAAIJ,EAAE,CAACM,WAAH,KAAmBC,SAAvB,EACA;CACC,gBAAIC,OAAO,GAAG,KAAI,CAACC,KAAL,CAAWC,UAAzB;CAEAF,YAAAA,OAAO,CAACG,WAAR,CAAoBC,aAAG,CAACC,MAAxB,oBAAsCR,OAAtC;CAEA,gBAAIS,OAAO,GAAGd,EAAE,CAACM,WAAH,CAAeS,IAAf,CAAoBP,OAApB,CAAd;CAGAR,YAAAA,EAAE,CAACgB,cAAH,CACCF,OADD,EAECd,EAAE,CAACM,WAAH,CAAeW,MAAf,CAAsBC,QAFvB,EAGC;CAAA,qBAAMC,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwBC,6BAAS,CAACjB,OAAV,CAAkBa,QAA1C,EAAoD,EAApD,CAAN;CAAA,aAHD;CAKAlB,YAAAA,EAAE,CAACgB,cAAH,CACCF,OADD,EAECd,EAAE,CAACM,WAAH,CAAeW,MAAf,CAAsBM,OAFvB,EAGC;CAAA,qBAAMJ,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwBC,6BAAS,CAACjB,OAAV,CAAkBkB,OAA1C,EAAmD,EAAnD,CAAN;CAAA,aAHD;CAKA;CACD;CACF,OAtCF;CAuCA;CApDF,GAH+C;CAyDhDC,EAAAA,OAzDgD,qBA0DhD;CACC,SAAKhD,YAAL;CACA,GA5D+C;CA6DhD;CACAiD,EAAAA,QAAQ;CA9DwC,CAAjD;;;;"}