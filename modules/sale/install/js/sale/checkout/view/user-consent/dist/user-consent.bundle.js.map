{"version":3,"file":"user-consent.bundle.js","sources":["../src/user-consent.js"],"sourcesContent":["import { BitrixVue } from 'ui.vue';\nimport { ajax, Tag, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events'\nimport { EventType, Component, RestMethod } from 'sale.checkout.const';\n\n\nBitrixVue.component('sale-checkout-view-user_consent', {\n\tprops: ['item'],\n\tmethods:\n\t{\n\t\tgetBlockHtml()\n\t\t{\n\t\t\tlet userConsent = {\n\t\t\t\tid: this.item.id,\n\t\t\t\ttitle: this.item.title,\n\t\t\t\tisLoaded: this.item.isLoaded,\n\t\t\t\tautoSave: this.item.autoSave,\n\t\t\t\tisChecked: this.item.isChecked,\n\t\t\t\tsubmitEventName: this.item.submitEventName,\n\t\t\t\tfields: this.item.params\n\t\t\t};\n\n\t\t\tajax.runComponentAction(\n\t\t\t\tComponent.bitrixSaleOrderCheckout,\n\t\t\t\tRestMethod.saleEntityUserConsentRequest,\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfields: userConsent\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((response)=>{\n\t\t\t\t\t\tif(\n\t\t\t\t\t\t\tBX.type.isPlainObject(response.data)\n\t\t\t\t\t\t\t&& BX.type.isNotEmptyString(response.data.html)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet consent = response.data.html;\n\n\t\t\t\t\t\t\tif (BX.UserConsent !== undefined)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlet wrapper = this.$refs.consentDiv;\n\n\t\t\t\t\t\t\t\twrapper.appendChild(Tag.render`<div>${consent}</div>`);\n\n\t\t\t\t\t\t\t\tlet control = BX.UserConsent.load(wrapper);\n\n\n\t\t\t\t\t\t\t\tBX.addCustomEvent(\n\t\t\t\t\t\t\t\t\tcontrol,\n\t\t\t\t\t\t\t\t\tBX.UserConsent.events.accepted,\n\t\t\t\t\t\t\t\t\t() => EventEmitter.emit(EventType.consent.accepted, {})\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tBX.addCustomEvent(\n\t\t\t\t\t\t\t\t\tcontrol,\n\t\t\t\t\t\t\t\t\tBX.UserConsent.events.refused,\n\t\t\t\t\t\t\t\t\t() => EventEmitter.emit(EventType.consent.refused, {})\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t})\n\t\t}\n\t},\n\tmounted()\n\t{\n\t\tthis.getBlockHtml();\n\t},\n\t// language=Vue\n\ttemplate: `\n\t  <div class=\"checkout-basket-section checkout-basket-section-consent\">\n\t\t<div ref=\"consentDiv\"/>\n      </div>\n\t`\n});"],"names":["BitrixVue","component","props","methods","getBlockHtml","userConsent","id","item","title","isLoaded","autoSave","isChecked","submitEventName","fields","params","ajax","runComponentAction","Component","bitrixSaleOrderCheckout","RestMethod","saleEntityUserConsentRequest","data","then","response","BX","type","isPlainObject","isNotEmptyString","html","consent","UserConsent","undefined","wrapper","$refs","consentDiv","appendChild","Tag","render","control","load","addCustomEvent","events","accepted","EventEmitter","emit","EventType","refused","mounted","template"],"mappings":";;;;;;;AAMAA,iBAAS,CAACC,SAAV,CAAoB,iCAApB,EAAuD;GACtDC,KAAK,EAAE,CAAC,MAAD,CAD+C;GAEtDC,OAAO,EACP;KACCC,YADD,0BAEC;OAAA;;OACC,IAAIC,WAAW,GAAG;SACjBC,EAAE,EAAE,KAAKC,IAAL,CAAUD,EADG;SAEjBE,KAAK,EAAE,KAAKD,IAAL,CAAUC,KAFA;SAGjBC,QAAQ,EAAE,KAAKF,IAAL,CAAUE,QAHH;SAIjBC,QAAQ,EAAE,KAAKH,IAAL,CAAUG,QAJH;SAKjBC,SAAS,EAAE,KAAKJ,IAAL,CAAUI,SALJ;SAMjBC,eAAe,EAAE,KAAKL,IAAL,CAAUK,eANV;SAOjBC,MAAM,EAAE,KAAKN,IAAL,CAAUO;QAPnB;OAUAC,cAAI,CAACC,kBAAL,CACCC,6BAAS,CAACC,uBADX,EAECC,8BAAU,CAACC,4BAFZ,EAGC;SACCC,IAAI,EAAE;WACLR,MAAM,EAAER;;QALX,EASEiB,IATF,CASO,UAACC,QAAD,EAAY;SAChB,IACCC,EAAE,CAACC,IAAH,CAAQC,aAAR,CAAsBH,QAAQ,CAACF,IAA/B,KACGG,EAAE,CAACC,IAAH,CAAQE,gBAAR,CAAyBJ,QAAQ,CAACF,IAAT,CAAcO,IAAvC,CAFJ,EAIA;WACC,IAAIC,OAAO,GAAGN,QAAQ,CAACF,IAAT,CAAcO,IAA5B;;WAEA,IAAIJ,EAAE,CAACM,WAAH,KAAmBC,SAAvB,EACA;aACC,IAAIC,OAAO,GAAG,KAAI,CAACC,KAAL,CAAWC,UAAzB;aAEAF,OAAO,CAACG,WAAR,CAAoBC,aAAG,CAACC,MAAxB,iGAAsCR,OAAtC;aAEA,IAAIS,OAAO,GAAGd,EAAE,CAACM,WAAH,CAAeS,IAAf,CAAoBP,OAApB,CAAd;aAGAR,EAAE,CAACgB,cAAH,CACCF,OADD,EAECd,EAAE,CAACM,WAAH,CAAeW,MAAf,CAAsBC,QAFvB,EAGC;eAAA,OAAMC,6BAAY,CAACC,IAAb,CAAkBC,6BAAS,CAAChB,OAAV,CAAkBa,QAApC,EAA8C,EAA9C,CAAN;cAHD;aAKAlB,EAAE,CAACgB,cAAH,CACCF,OADD,EAECd,EAAE,CAACM,WAAH,CAAeW,MAAf,CAAsBK,OAFvB,EAGC;eAAA,OAAMH,6BAAY,CAACC,IAAb,CAAkBC,6BAAS,CAAChB,OAAV,CAAkBiB,OAApC,EAA6C,EAA7C,CAAN;cAHD;;;QA/BL;;IAhBoD;GAyDtDC,OAzDsD,qBA0DtD;KACC,KAAK3C,YAAL;IA3DqD;;GA8DtD4C,QAAQ;CA9D8C,CAAvD;;;;"}