{"version":3,"file":"registry.bundle.js","sources":["../src/pay-system-application.js","../src/payment-paid-application.js","../src/payment.js"],"sourcesContent":["import { BitrixVue } from 'ui.vue';\n\nimport 'sale.payment-pay.components';\n\nBitrixVue.component('sale-checkout-view-payment-pay_system_application', {\n\tprops: ['order', 'paySystems', 'config'],\n\tmethods:\n\t{\n\t\tprepare(items)\n\t\t{\n\t\t\tlet paymentProcess = {\n\t\t\t\treturnUrl: this.config.returnUrl,\n\t\t\t\torderId: this.order.id,\n\t\t\t\taccessCode: this.order.hash,\n\t\t\t\tallowPaymentRedirect: true\n\t\t\t}\n\n\t\t\tlet paySystems = items.map((item)=>\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tID: item.id,\n\t\t\t\t\tNAME: item.name,\n\t\t\t\t\tLOGOTIP: item.picture,\n\t\t\t\t}\n\t\t\t})\n\n\t\t\treturn {\n\t\t\t\tapp: { paySystems },\n\t\t\t\tpaymentProcess\n\t\t\t}\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<sale-payment_pay-components-application-pay_system :options=\"prepare(paySystems)\"/>\n\t`\n});","import { BitrixVue } from 'ui.vue';\nimport { Type } from 'main.core';\nimport {CurrencyCore} from 'currency.currency-core';\n\nimport 'sale.payment-pay.components';\n\nBitrixVue.component('sale-checkout-view-payment-payment_paid_application', {\n\tprops: ['order', 'payments', 'paySystems', 'check', 'config'],\n\tmethods:\n\t{\n\t\tgetChecksByPaymentId(paymentId)\n\t\t{\n\t\t\tconst result = [];\n\t\t\tlet list = this.check;\n\n\t\t\tif(Type.isArrayFilled(list))\n\t\t\t{\n\t\t\t\tlist.forEach((fields) =>\n\t\t\t\t{\n\t\t\t\t\tif(fields.paymentId === paymentId)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\tstatus: fields.status,\n\t\t\t\t\t\t\tlink: fields.link,\n\t\t\t\t\t\t\tid: fields.id,\n\t\t\t\t\t\t\tdateFormatted: fields.dateFormatted\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\treturn result\n\t\t},\n\n\t\tgetFirstPaymentPaidY()\n\t\t{\n\t\t\treturn this.payments[0];\n\t\t},\n\n\t\tgetPaySystemById(id)\n\t\t{\n\t\t\tlet paySystem = this.paySystems.find(item => item.id === id)\n\t\t\treturn !!paySystem ? paySystem:null\n\t\t},\n\n\t\tprepare()\n\t\t{\n\t\t\tlet result = null\n\n\t\t\tlet item = this.getFirstPaymentPaidY()\n\t\t\tif(item !== null)\n\t\t\t{\n\t\t\t\tlet paySystem = this.getPaySystemById(item.paySystemId)\n\n\t\t\t\tlet list = [];\n\t\t\t\tlist.push({\n\t\t\t\t\tID: paySystem.id,\n\t\t\t\t\tNAME: paySystem.name,\n\t\t\t\t\tLOGOTIP: paySystem.picture\n\t\t\t\t})\n\n\t\t\t\tlet app = {\n\t\t\t\t\tpaySystems: list,\n\t\t\t\t\ttitle: this.getTitle(item)\n\t\t\t\t}\n\n\t\t\t\tlet payment = {\n\t\t\t\t\tsumFormatted: this.sumFormatted(item),\n\t\t\t\t\tpaid: item.paid === 'Y',\n\t\t\t\t\tchecks: this.getChecksByPaymentId(item.id),\n\t\t\t\t};\n\n\t\t\t\tlet paymentProcess = {\n\t\t\t\t\treturnUrl: this.config.returnUrl,\n\t\t\t\t\torderId: this.order.id,\n\t\t\t\t\taccessCode: this.order.hash,\n\t\t\t\t\tallowPaymentRedirect: true,\n\t\t\t\t\tpaymentId: item.id\n\t\t\t\t}\n\n\t\t\t\tresult = {\n\t\t\t\t\tapp,\n\t\t\t\t\tpayment,\n\t\t\t\t\tpaymentProcess\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result\n\t\t},\n\t\tsumFormatted(item)\n\t\t{\n\t\t\treturn CurrencyCore.currencyFormat(item.sum, item.currency, true);\n\t\t},\n\t\tgetTitle(item)\n\t\t{\n\t\t\treturn this.localize.CHECKOUT_VIEW_PAYMENT_PAYMENT_INFO\n\t\t\t\t.replace('#DATE_INSERT#', item.dateBillFormatted)\n\t\t\t\t.replace('#ACCOUNT_NUMBER#', item.accountNumber)\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Object.freeze(\n\t\t\t\tBitrixVue.getFilteredPhrases('CHECKOUT_VIEW_PAYMENT'))\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<sale-payment_pay-components-application-payment :options=\"prepare()\"/>\n\t`\n});","import { BitrixVue } from 'ui.vue';\n\nimport './pay-system-application'\nimport './payment-paid-application'\n\nBitrixVue.component('sale-checkout-view-payment', {\n\tprops: ['order', 'payments', 'paySystems', 'check', 'config'],\n\tmethods:\n\t{\n\t\thasPaymentPaidY()\n\t\t{\n\t\t\treturn this\n\t\t\t.getPaymentPaidY()\n\t\t\t\t.length > 0\n\t\t},\n\t\tgetPaymentPaidY()\n\t\t{\n\t\t\tconst result = [];\n\t\t\tlet list = this.payments;\n\t\t\tlist.forEach((fields) =>\n\t\t\t{\n\t\t\t\tif(fields.paid !== 'N')\n\t\t\t\t{\n\t\t\t\t\tresult.push(fields)\n\t\t\t\t}\n\t\t\t})\n\t\t\treturn result\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t  <div>\n\t  <template v-if=\"hasPaymentPaidY()\">\n        <sale-checkout-view-payment-payment_paid_application :order=\"order\" :payments=\"getPaymentPaidY()\" :paySystems=\"paySystems\" :check=\"check\" :config=\"config\"/>\n      </template>\n      <template v-else>\n        <sale-checkout-view-payment-pay_system_application :order=\"order\" :paySystems=\"paySystems\" :config=\"config\"/>\n\t  </template>\n\t</div>\n\t`\n});"],"names":["BitrixVue","component","props","methods","prepare","items","paymentProcess","returnUrl","config","orderId","order","id","accessCode","hash","allowPaymentRedirect","paySystems","map","item","ID","NAME","name","LOGOTIP","picture","app","template","getChecksByPaymentId","paymentId","result","list","check","Type","isArrayFilled","forEach","fields","push","status","link","dateFormatted","getFirstPaymentPaidY","payments","getPaySystemById","paySystem","find","paySystemId","title","getTitle","payment","sumFormatted","paid","checks","CurrencyCore","currencyFormat","sum","currency","localize","CHECKOUT_VIEW_PAYMENT_PAYMENT_INFO","replace","dateBillFormatted","accountNumber","computed","Object","freeze","getFilteredPhrases","hasPaymentPaidY","getPaymentPaidY","length"],"mappings":"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"}