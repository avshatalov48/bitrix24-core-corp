{"version":3,"file":"registry.bundle.js","sources":["../src/pay-system-application.js","../src/payment-paid-application.js","../src/payment.js"],"sourcesContent":["import { BitrixVue } from 'ui.vue';\n\nimport 'sale.payment-pay.components';\n\nBitrixVue.component('sale-checkout-view-payment-pay_system_application', {\n\tprops: ['order', 'paySystems', 'config'],\n\tmethods:\n\t{\n\t\tprepare(items)\n\t\t{\n\t\t\tlet paymentProcess = {\n\t\t\t\treturnUrl: this.config.returnUrl,\n\t\t\t\torderId: this.order.id,\n\t\t\t\taccessCode: this.order.hash,\n\t\t\t\tallowPaymentRedirect: true\n\t\t\t}\n\n\t\t\tlet paySystems = items.map((item)=>\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tID: item.id,\n\t\t\t\t\tNAME: item.name,\n\t\t\t\t\tLOGOTIP: item.picture,\n\t\t\t\t}\n\t\t\t})\n\n\t\t\treturn {\n\t\t\t\tapp: { paySystems },\n\t\t\t\tpaymentProcess\n\t\t\t}\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<sale-payment_pay-components-application-pay_system :options=\"prepare(paySystems)\"/>\n\t`\n});","import { BitrixVue } from 'ui.vue';\nimport { Type } from 'main.core';\nimport {CurrencyCore} from 'currency.currency-core';\n\nimport 'sale.payment-pay.components';\n\nBitrixVue.component('sale-checkout-view-payment-payment_paid_application', {\n\tprops: ['order', 'payments', 'paySystems', 'check', 'config'],\n\tmethods:\n\t{\n\t\tgetChecksByPaymentId(paymentId)\n\t\t{\n\t\t\tconst result = [];\n\t\t\tlet list = this.check;\n\n\t\t\tif(Type.isArrayFilled(list))\n\t\t\t{\n\t\t\t\tlist.forEach((fields) =>\n\t\t\t\t{\n\t\t\t\t\tif(fields.paymentId === paymentId)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\tstatus: fields.status,\n\t\t\t\t\t\t\tlink: fields.link,\n\t\t\t\t\t\t\tid: fields.id,\n\t\t\t\t\t\t\tdateFormatted: fields.dateFormatted\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\treturn result\n\t\t},\n\n\t\tgetFirstPaymentPaidY()\n\t\t{\n\t\t\treturn this.payments[0];\n\t\t},\n\n\t\tgetPaySystemById(id)\n\t\t{\n\t\t\tlet paySystem = this.paySystems.find(item => item.id === id)\n\t\t\treturn !!paySystem ? paySystem:null\n\t\t},\n\n\t\tprepare()\n\t\t{\n\t\t\tlet result = null\n\n\t\t\tlet item = this.getFirstPaymentPaidY()\n\t\t\tif(item !== null)\n\t\t\t{\n\t\t\t\tlet paySystem = this.getPaySystemById(item.paySystemId)\n\n\t\t\t\tlet list = [];\n\t\t\t\tlist.push({\n\t\t\t\t\tID: paySystem.id,\n\t\t\t\t\tNAME: paySystem.name,\n\t\t\t\t\tLOGOTIP: paySystem.picture\n\t\t\t\t})\n\n\t\t\t\tlet app = {\n\t\t\t\t\tpaySystems: list,\n\t\t\t\t\ttitle: this.getTitle(item)\n\t\t\t\t}\n\n\t\t\t\tlet payment = {\n\t\t\t\t\tsumFormatted: this.sumFormatted(item),\n\t\t\t\t\tpaid: item.paid === 'Y',\n\t\t\t\t\tchecks: this.getChecksByPaymentId(item.id),\n\t\t\t\t};\n\n\t\t\t\tlet paymentProcess = {\n\t\t\t\t\treturnUrl: this.config.returnUrl,\n\t\t\t\t\torderId: this.order.id,\n\t\t\t\t\taccessCode: this.order.hash,\n\t\t\t\t\tallowPaymentRedirect: true,\n\t\t\t\t\tpaymentId: item.id\n\t\t\t\t}\n\n\t\t\t\tresult = {\n\t\t\t\t\tapp,\n\t\t\t\t\tpayment,\n\t\t\t\t\tpaymentProcess\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result\n\t\t},\n\t\tsumFormatted(item)\n\t\t{\n\t\t\treturn CurrencyCore.currencyFormat(item.sum, item.currency, true);\n\t\t},\n\t\tgetTitle(item)\n\t\t{\n\t\t\treturn this.localize.CHECKOUT_VIEW_PAYMENT_PAYMENT_INFO\n\t\t\t\t.replace('#DATE_INSERT#', item.dateBillFormatted)\n\t\t\t\t.replace('#ACCOUNT_NUMBER#', item.accountNumber)\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Object.freeze(\n\t\t\t\tBitrixVue.getFilteredPhrases('CHECKOUT_VIEW_PAYMENT'))\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<sale-payment_pay-components-application-payment :options=\"prepare()\"/>\n\t`\n});","import { BitrixVue } from 'ui.vue';\n\nimport './pay-system-application'\nimport './payment-paid-application'\n\nBitrixVue.component('sale-checkout-view-payment', {\n\tprops: ['order', 'payments', 'paySystems', 'check', 'config'],\n\tmethods:\n\t{\n\t\thasPaymentPaidY()\n\t\t{\n\t\t\treturn this\n\t\t\t.getPaymentPaidY()\n\t\t\t\t.length > 0\n\t\t},\n\t\tgetPaymentPaidY()\n\t\t{\n\t\t\tconst result = [];\n\t\t\tlet list = this.payments;\n\t\t\tlist.forEach((fields) =>\n\t\t\t{\n\t\t\t\tif(fields.paid !== 'N')\n\t\t\t\t{\n\t\t\t\t\tresult.push(fields)\n\t\t\t\t}\n\t\t\t})\n\t\t\treturn result\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t  <div>\n\t  <template v-if=\"hasPaymentPaidY()\">\n        <sale-checkout-view-payment-payment_paid_application :order=\"order\" :payments=\"getPaymentPaidY()\" :paySystems=\"paySystems\" :check=\"check\" :config=\"config\"/>\n      </template>\n      <template v-else>\n        <sale-checkout-view-payment-pay_system_application :order=\"order\" :paySystems=\"paySystems\" :config=\"config\"/>\n\t  </template>\n\t</div>\n\t`\n});"],"names":["BitrixVue","component","props","methods","prepare","items","paymentProcess","returnUrl","config","orderId","order","id","accessCode","hash","allowPaymentRedirect","paySystems","map","item","ID","NAME","name","LOGOTIP","picture","app","template","getChecksByPaymentId","paymentId","result","list","check","Type","isArrayFilled","forEach","fields","push","status","link","dateFormatted","getFirstPaymentPaidY","payments","getPaySystemById","paySystem","find","paySystemId","title","getTitle","payment","sumFormatted","paid","checks","CurrencyCore","currencyFormat","sum","currency","localize","CHECKOUT_VIEW_PAYMENT_PAYMENT_INFO","replace","dateBillFormatted","accountNumber","computed","Object","freeze","getFilteredPhrases","hasPaymentPaidY","getPaymentPaidY","length"],"mappings":"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"}