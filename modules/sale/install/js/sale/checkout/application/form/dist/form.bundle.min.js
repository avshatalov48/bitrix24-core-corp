this.BX=this.BX||{};this.BX.Sale=this.BX.Sale||{};this.BX.Sale.Checkout=this.BX.Sale.Checkout||{};(function(t,e,s,o,r,n,i,a,c){"use strict";i.Vue.component("sale-checkout-form",{data:function t(){return{stage:c.Application.stage,mode:c.Application.mode,status:c.Loader.status,totalIsShow:"N"}},computed:{checkoutButtonEnabled:function t(){var e=[];var s=this.$store.getters["property/getProperty"];for(var o in s){if(s[o].value.length>0){e.push(s[o].value)}}return e.length>0},hasPS:function t(){var e=[];var s=this.$store.getters["pay-system/getPaySystem"];s.forEach(function(t){if(t.type!==c.PaySystem.type.cash){e.push(t)}});return e.length>0},needCheckConsent:function t(){return this.getConsent.id>0},getBasket:function t(){return this.$store.getters["basket/getBasket"]},getOrder:function t(){return this.$store.getters["order/getOrder"]},getProperty:function t(){return this.$store.getters["property/getProperty"]},getPropertyErrors:function t(){return this.$store.getters["property/getErrors"]},getTotal:function t(){var e=this.$store.getters["basket/getTotal"];return{price:e.price,basePrice:e.basePrice,discount:this.$store.getters["basket/getDiscount"],currency:this.$store.getters["basket/getCurrency"]}},getConsent:function t(){return this.$store.getters["consent/get"]},getStage:function t(){return this.$store.getters["application/getStage"]},getStatus:function t(){return this.$store.getters["application/getStatus"]},getBasketConfig:function t(){return{status:this.$store.getters["basket/getStatus"]}},getPaymentConfig:function t(){return{status:this.$store.getters["pay-system/getStatus"],returnUrl:this.$store.getters["application/getPathLocation"],mainPage:this.$store.getters["application/getPathMainPage"]}},getSuccessfulConfig:function t(){return{mainPage:this.$store.getters["application/getPathMainPage"]}},getEmptyCartConfig:function t(){return{path:this.$store.getters["application/getPath"]}},getTitleCheckoutButton:function t(){return{title:this.$store.getters["application/getTitleCheckoutButton"]}},getErrors:function t(){return this.$store.getters["application/getErrors"]}},created:function t(){var e=this;a.EventEmitter.subscribe(c.EventType.basket.backdropTotalOpen,function(t){e.totalIsShow="Y"});a.EventEmitter.subscribe(c.EventType.basket.backdropTotalClose,function(t){e.totalIsShow="N"})},template:'\n      <div class="checkout-container-wrapper">\n\t\t  <div class="checkout-basket-container">\n\t\t\t<template v-if="getStage === stage.edit">\n\t\t\t  <sale-checkout-view-product :items="getBasket" :total="getTotal" :mode="mode.edit" :config="getBasketConfig"/>\n\t\t\t  <sale-checkout-view-property :items="getProperty" :mode="mode.edit" :errors="getPropertyErrors"/>\n\t\t\t  <sale-checkout-view-user_consent :item="getConsent" v-if="needCheckConsent"/>\n\t\t\t  <template v-if="checkoutButtonEnabled">\n\t\t\t\t<sale-checkout-view-element-button-checkout :title="getTitleCheckoutButton.title" :wait="getStatus === status.wait"/>\n\t\t\t  </template>\n\t\t\t  <template v-else>\n\t\t\t\t<sale-checkout-view-element-button-checkout_disabled :title="getTitleCheckoutButton.title"/>\n\t\t\t  </template>\n\t\t\t  <sale-checkout-view-alert-list :errors="getErrors"/>\n\t\t\t</template>\n\t\t\t<template v-else-if="getStage === stage.success">\n\t\t\t  <template v-if="hasPS">\n\t\t\t\t<sale-checkout-view-successful :items="getProperty" :order="getOrder" :config="getSuccessfulConfig"/>\n\t\t\t  </template>\n\t\t\t  <template v-else>\n\t\t\t\t<sale-checkout-view-successful-without-ps :items="getProperty" :order="getOrder" :config="getSuccessfulConfig"/>\n\t\t\t  </template>\n\t\t\t</template>\n\t\t\t<template v-else-if="getStage === stage.payed">\n              <sale-checkout-view-successful_ps_return :items="getProperty" :order="getOrder" :total="getTotal" :config="getSuccessfulConfig"/>\n\t\t\t</template>\n\t\t\t<template v-else-if="getStage === stage.view">\n\t\t\t  <sale-checkout-view-product :items="getBasket" :total="getTotal" :mode="mode.view" :config="getBasketConfig"/>\n\t\t\t  <sale-checkout-view-property :items="getProperty" :mode="mode.view" :order="getOrder"/>\n\t\t\t  <sale-checkout-view-product-summary :total="getTotal" :mode="mode.view"/>\n\t\t\t  <sale-checkout-view-payment :order="getOrder" :config="getPaymentConfig"/>\n\t\t\t</template>\n\t\t\t<template v-else-if="getStage === stage.empty">\n\t\t\t  <sale-checkout-view-empty_cart :config="getEmptyCartConfig"/>\n\t\t\t</template>\n\t\t  </div>\n\t\t  <template v-if="getStage === stage.view">\n\t\t\t<sale-checkout-view-total :total="getTotal" :showBackdrop="totalIsShow"/>\n\t\t  </template>\n      </div>\n\t'});function u(){var t=babelHelpers.taggedTemplateLiteral(['<div class=""></div>']);u=function e(){return t};return t}var p=function(){function t(){var e=this;var o=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);this.wrapper=s.Tag.render(u());this.init().then(function(){return e.prepareParams({options:o})}).then(function(){e.initStore().then(function(t){return e.initTemplate(t).then(function(){return e.initController()})}).catch(function(e){return t.showError(e)})})}babelHelpers.createClass(t,[{key:"init",value:function t(){return Promise.resolve()}},{key:"prepareParams",value:function t(e){this.options=e.options;return Promise.resolve()}},{key:"initStore",value:function t(){var s=new o.VuexBuilder;var r={product:this.options.product};var i={path:this.options.path,common:this.options.common,option:this.options.option,messages:this.options.messages};i.path.location=e.Url.getCurrentUrl();return s.addModel(n.Order.create()).addModel(n.Basket.create().setVariables(r)).addModel(n.Property.create()).addModel(n.PaySystem.create()).addModel(n.Application.create().setVariables(i)).addModel(n.Consent.create()).build()}},{key:"layout",value:function t(){return this.wrapper}},{key:"initController",value:function t(){this.controller=new r.Application({store:this.store});return new Promise(function(t){return t()})}},{key:"initTemplate",value:function t(e){var s=this;return new Promise(function(t){var o=s;s.store=e.store;s.templateEngine=i.Vue.create({el:s.wrapper,store:s.store,data:{options:s.options},created:function t(){this.$app=o;var e={};if(o.options.basket.length>0){e={order:this.options.order,basket:this.options.basket,paySystem:this.options.paySystem,total:this.options.total,currency:this.options.currency,discount:this.options.discount,property:this.options.property,consent:this.options.consent,consentStatus:this.options.consentStatus}}e.stage=this.options.stage;o.setModelData(e)},mounted:function e(){t()},template:"<sale-checkout-form/>"})})}},{key:"setModelData",value:function t(e){var o=this;if(s.Type.isString(e.stage)){this.store.dispatch("application/setStage",{stage:e.stage})}if(s.Type.isObject(e.order)){this.store.dispatch("order/set",e.order)}if(s.Type.isObject(e.basket)){e.basket.forEach(function(t,e){o.store.dispatch("basket/changeItem",{index:e,fields:t})})}if(s.Type.isString(e.currency)){this.store.dispatch("basket/setCurrency",{currency:e.currency})}if(s.Type.isObject(e.discount)){this.store.dispatch("basket/setDiscount",e.discount)}if(s.Type.isObject(e.total)){this.store.dispatch("basket/setTotal",e.total)}if(s.Type.isObject(e.property)){e.property.forEach(function(t,e){o.store.dispatch("property/changeItem",{index:e,fields:t})})}if(s.Type.isObject(e.paySystem)){e.paySystem.forEach(function(t,e){o.store.dispatch("pay-system/changeItem",{index:e,fields:t})})}if(s.Type.isString(e.consentStatus)){this.store.dispatch("consent/setStatus",e.consentStatus)}if(s.Type.isObject(e.consent)){this.store.dispatch("consent/set",e.consent)}if(s.Type.isObject(e.errors)){this.store.commit("basket/setErrors",e.errors)}}}],[{key:"showError",value:function t(e){console.error(e)}}]);return t}();t.FormApplication=p})(this.BX.Sale.Checkout.Application=this.BX.Sale.Checkout.Application||{},BX.Sale.Checkout.Lib,BX,BX,BX.Sale.Checkout.Controller,BX.Sale.Checkout.Model,BX,BX.Event,BX.Sale.Checkout.Const);
//# sourceMappingURL=form.bundle.map.js