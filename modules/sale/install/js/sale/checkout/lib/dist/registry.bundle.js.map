{"version":3,"file":"registry.bundle.js","sources":["../src/url.js","../src/pool.js","../src/timer.js","../src/basket.js","../src/history.js"],"sourcesContent":["import { Uri } from 'main.core';\r\n\r\nexport class Url\r\n{\r\n\tstatic getCurrentUrl()\r\n\t{\r\n\t\treturn window.location.protocol + \"//\" + window.location.hostname + (window.location.port != '' ? ':' + window.location.port : '') +\r\n\t\t\twindow.location.pathname + window.location.search;\r\n\t}\r\n\t\r\n\tstatic addLinkParam(link, name, value)\r\n\t{\r\n\t\tif(!link.length)\r\n\t\t{\r\n\t\t\treturn '?' + name + '=' + value;\r\n\t\t}\r\n\t\tlink = Uri.removeParam(link, name);\r\n\t\tif(link.indexOf('?') != -1)\r\n\t\t{\r\n\t\t\treturn link + '&' + name + '=' + value;\r\n\t\t}\r\n\t\treturn link + '?' + name + '=' + value;\r\n\t}\r\n}","class Pool\r\n{\r\n    constructor()\r\n    {\r\n        this.pool = {};\r\n    }\r\n\r\n    add(cmd, index, fields)\r\n    {\r\n        if (!this.pool.hasOwnProperty(index))\r\n        {\r\n            this.pool[index] = [];\r\n        }\r\n\r\n        this.pool[index].push({\r\n            [cmd]: {fields}\r\n        });\r\n    }\r\n\r\n    get()\r\n    {\r\n        return this.pool;\r\n    }\r\n\r\n    clean()\r\n    {\r\n        this.pool = {};\r\n    }\r\n\r\n    isEmpty()\r\n    {\r\n        return Object.keys(this.pool).length === 0;\r\n    }\r\n}\r\n\r\nexport {\r\n    Pool\r\n}","class Timer\n{\n\tconstructor()\n\t{\n\t\tthis.list = [];\n\t}\n\n\tadd(fields)\n\t{\n\t\tif (!fields.hasOwnProperty('index'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.list[fields.index] = {\n\t\t\tid: fields.id\n\t\t};\n\t}\n\n\tget(index)\n\t{\n\t\tif (!this.list[index] || this.list[index].length <= 0)\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\treturn this.list[index];\n\t}\n\n\tdelete(fields)\n\t{\n\t\tthis.list.splice(fields.index, 1);\n\t}\n\n\tclean(fields)\n\t{\n\t\tlet timer = this.get(fields.index);\n\n\t\tclearTimeout(timer.id);\n\n\t\tthis.delete({\n\t\t\tindex: fields.index\n\t\t});\n\t}\n\n\tcreate(time, index = 'default', callback = null, callbackParams)\n\t{\n\t\tthis.clean({index});\n\n\t\tindex = index == null? 'default': index;\n\t\tcallback = typeof callback === 'function'? callback: function() {}\n\n\t\tlet timer = setTimeout(callback, time);\n\n\t\tlet item = {id: timer, index: index};\n\n\t\tthis.add(item)\n\t}\n\n\tisEmpty()\n\t{\n\t\treturn this.list.length === 0;\n\t}\n}\n\nexport {Timer}","class Basket\r\n{\r\n\tstatic toFixed(quantity, measureRatio, availableQuantity = 0)\r\n\t{\r\n\t\tlet precisionFactor =  Math.pow(10, 6);\r\n\t\tlet reminder = (quantity / measureRatio - ((quantity / measureRatio).toFixed(0))).toFixed(5),\r\n\t\t\tremain;\r\n\r\n\r\n\r\n\t\tif (parseFloat(reminder) === 0)\r\n\t\t{\r\n\t\t\treturn quantity;\r\n\t\t}\r\n\t\t\r\n\t\tif (measureRatio !== 0 && measureRatio !== 1)\r\n\t\t{\r\n\t\t\tremain = (quantity * precisionFactor) % (measureRatio * precisionFactor) / precisionFactor;\r\n\r\n\t\t\tif (measureRatio > 0 && remain > 0)\r\n\t\t\t{\r\n\t\t\t\tif (\r\n\t\t\t\t\tremain >= measureRatio / 2\r\n\t\t\t\t\t&& (\r\n\t\t\t\t\t\tavailableQuantity === 0\r\n\t\t\t\t\t\t|| (quantity + measureRatio - remain) <= availableQuantity\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t\t{\r\n\t\t\t\t\tquantity += (measureRatio * precisionFactor - remain * precisionFactor) / precisionFactor;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tquantity = (quantity * precisionFactor -  remain * precisionFactor) / precisionFactor;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn quantity;\r\n\t}\r\n\r\n\t// isRatioFloat(value)\r\n\t// {\r\n\t// \treturn parseInt(value) !== parseFloat(value)\r\n\t// }\r\n\r\n\tstatic isValueFloat(value)\r\n\t{\r\n\t\treturn parseInt(value) !== parseFloat(value)\r\n\t}\r\n\r\n\tstatic roundValue(value)\r\n\t{\r\n\t\tif(Basket.isValueFloat(value))\r\n\t\t{\r\n\t\t\treturn Basket.roundFloatValue(value)\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\treturn parseInt(value, 10)\r\n\t\t}\r\n\t}\r\n\r\n\tstatic roundFloatValue(value)\r\n\t{\r\n\t\tlet precision = 6;\r\n\t\tlet precisionFactor = Math.pow(10, precision);\r\n\r\n\t\treturn Math.round(parseFloat(value) * precisionFactor) / precisionFactor;\r\n\t}\r\n}\r\n\r\nexport {\r\n\tBasket\r\n}","import { Url } from './url'\r\n\r\nexport class History\r\n{\r\n    constructor(options)\r\n    {\r\n        this.location = options.location;\r\n        this.params = options.params;\r\n    }\r\n\r\n    build()\r\n    {\r\n        let path = this.location;\r\n        let params = this.params;\r\n\r\n        try\r\n        {\r\n            for (let name in params)\r\n            {\r\n                if (!params.hasOwnProperty(name))\r\n                {\r\n                    continue;\r\n                }\r\n                path = Url.addLinkParam(path, name, params[name]);\r\n            }\r\n        }\r\n        catch (e) {}\r\n\r\n        return path;\r\n    }\r\n\r\n    static pushState(location, params)\r\n    {\r\n        let url = new History({location, params})\r\n            .build();\r\n\r\n        window.history.pushState(null, null, url);\r\n\r\n        return url;\r\n    }\r\n}"],"names":["Url","window","location","protocol","hostname","port","pathname","search","link","name","value","length","Uri","removeParam","indexOf","Pool","pool","cmd","index","fields","hasOwnProperty","push","Object","keys","Timer","list","id","splice","timer","get","clearTimeout","delete","time","callback","clean","setTimeout","item","add","Basket","quantity","measureRatio","availableQuantity","precisionFactor","Math","pow","reminder","toFixed","remain","parseFloat","parseInt","isValueFloat","roundFloatValue","precision","round","History","options","params","path","addLinkParam","e","url","build","history","pushState"],"mappings":"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"}