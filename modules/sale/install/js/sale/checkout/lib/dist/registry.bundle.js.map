{"version":3,"file":"registry.bundle.js","sources":["../src/url.js","../src/pool.js","../src/timer.js","../src/basket.js","../src/product.js","../src/history.js"],"sourcesContent":["import { Uri } from 'main.core';\r\n\r\nexport class Url\r\n{\r\n\tstatic getCurrentUrl()\r\n\t{\r\n\t\treturn window.location.protocol + \"//\" + window.location.hostname + (window.location.port != '' ? ':' + window.location.port : '') +\r\n\t\t\twindow.location.pathname + window.location.search;\r\n\t}\r\n\t\r\n\tstatic addLinkParam(link, name, value)\r\n\t{\r\n\t\tif(!link.length)\r\n\t\t{\r\n\t\t\treturn '?' + name + '=' + value;\r\n\t\t}\r\n\t\tlink = Uri.removeParam(link, name);\r\n\t\tif(link.indexOf('?') != -1)\r\n\t\t{\r\n\t\t\treturn link + '&' + name + '=' + value;\r\n\t\t}\r\n\t\treturn link + '?' + name + '=' + value;\r\n\t}\r\n}","class Pool\r\n{\r\n    constructor()\r\n    {\r\n        this.pool = {};\r\n    }\r\n\r\n    add(cmd, index, fields)\r\n    {\r\n        if (!this.pool.hasOwnProperty(index))\r\n        {\r\n            this.pool[index] = [];\r\n        }\r\n\r\n        this.pool[index].push({\r\n            [cmd]: {fields}\r\n        });\r\n    }\r\n\r\n    get()\r\n    {\r\n        return this.pool;\r\n    }\r\n\r\n    clean()\r\n    {\r\n        this.pool = {};\r\n    }\r\n\r\n    isEmpty()\r\n    {\r\n        return Object.keys(this.pool).length === 0;\r\n    }\r\n}\r\n\r\nexport {\r\n    Pool\r\n}","class Timer\n{\n\tconstructor()\n\t{\n\t\tthis.list = [];\n\t}\n\n\tadd(fields)\n\t{\n\t\tif (!fields.hasOwnProperty('index'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.list[fields.index] = {\n\t\t\tid: fields.id\n\t\t};\n\t}\n\n\tget(index)\n\t{\n\t\tif (!this.list[index] || this.list[index].length <= 0)\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\treturn this.list[index];\n\t}\n\n\tdelete(fields)\n\t{\n\t\tthis.list.splice(fields.index, 1);\n\t}\n\n\tclean(fields)\n\t{\n\t\tlet timer = this.get(fields.index);\n\n\t\tclearTimeout(timer.id);\n\n\t\tthis.delete({\n\t\t\tindex: fields.index\n\t\t});\n\t}\n\n\tcreate(time, index = 'default', callback = null, callbackParams)\n\t{\n\t\tthis.clean({index});\n\n\t\tindex = index == null? 'default': index;\n\t\tcallback = typeof callback === 'function'? callback: function() {}\n\n\t\tlet timer = setTimeout(callback, time);\n\n\t\tlet item = {id: timer, index: index};\n\n\t\tthis.add(item)\n\t}\n\n\tisEmpty()\n\t{\n\t\treturn this.list.length === 0;\n\t}\n}\n\nexport {Timer}","class Basket\n{\n\tstatic toFixed(quantity, measureRatio, availableQuantity = 0)\n\t{\n\t\tlet precisionFactor =  Math.pow(10, 6);\n\t\tlet reminder = (quantity / measureRatio - ((quantity / measureRatio).toFixed(0))).toFixed(5),\n\t\t\tremain;\n\n\n\n\t\tif (parseFloat(reminder) === 0)\n\t\t{\n\t\t\treturn quantity;\n\t\t}\n\t\t\n\t\tif (measureRatio !== 0 && measureRatio !== 1)\n\t\t{\n\t\t\tremain = (quantity * precisionFactor) % (measureRatio * precisionFactor) / precisionFactor;\n\n\t\t\tif (measureRatio > 0 && remain > 0)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tremain >= measureRatio / 2\n\t\t\t\t\t&& (\n\t\t\t\t\t\tavailableQuantity === 0\n\t\t\t\t\t\t|| (quantity + measureRatio - remain) <= availableQuantity\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tquantity += (measureRatio * precisionFactor - remain * precisionFactor) / precisionFactor;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tquantity = (quantity * precisionFactor -  remain * precisionFactor) / precisionFactor;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn quantity;\n\t}\n\n\t// isRatioFloat(value)\n\t// {\n\t// \treturn parseInt(value) !== parseFloat(value)\n\t// }\n\n\tstatic isValueFloat(value)\n\t{\n\t\treturn parseInt(value) !== parseFloat(value)\n\t}\n\n\tstatic roundValue(value)\n\t{\n\t\tif(Basket.isValueFloat(value))\n\t\t{\n\t\t\treturn Basket.roundFloatValue(value)\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn parseInt(value, 10)\n\t\t}\n\t}\n\n\tstatic roundFloatValue(value)\n\t{\n\t\tlet precision = 6;\n\t\tlet precisionFactor = Math.pow(10, precision);\n\n\t\treturn Math.round(parseFloat(value) * precisionFactor) / precisionFactor;\n\t}\n}\n\nexport {\n\tBasket\n}","import {Product as ProductConst} from \"sale.checkout.const\";\n\nclass Product\n{\n\tstatic isService(item)\n\t{\n\t\treturn item.product.type === ProductConst.type.service;\n\t}\n\n\tstatic isLimitedQuantity(item)\n\t{\n\t\treturn item.product.checkMaxQuantity === 'Y'\n\t}\n}\n\nexport {\n\tProduct\n}","import { Url } from './url'\r\n\r\nexport class History\r\n{\r\n    constructor(options)\r\n    {\r\n        this.location = options.location;\r\n        this.params = options.params;\r\n    }\r\n\r\n    build()\r\n    {\r\n        let path = this.location;\r\n        let params = this.params;\r\n\r\n        try\r\n        {\r\n            for (let name in params)\r\n            {\r\n                if (!params.hasOwnProperty(name))\r\n                {\r\n                    continue;\r\n                }\r\n                path = Url.addLinkParam(path, name, params[name]);\r\n            }\r\n        }\r\n        catch (e) {}\r\n\r\n        return path;\r\n    }\r\n\r\n    static pushState(location, params)\r\n    {\r\n        let url = new History({location, params})\r\n            .build();\r\n\r\n        window.history.pushState(null, null, url);\r\n\r\n        return url;\r\n    }\r\n}"],"names":["Url","window","location","protocol","hostname","port","pathname","search","link","name","value","length","Uri","removeParam","indexOf","Pool","pool","cmd","index","fields","hasOwnProperty","push","Object","keys","Timer","list","id","splice","timer","get","clearTimeout","time","callback","clean","setTimeout","item","add","Basket","quantity","measureRatio","availableQuantity","precisionFactor","Math","pow","reminder","toFixed","remain","parseFloat","parseInt","isValueFloat","roundFloatValue","precision","round","Product","product","type","ProductConst","service","checkMaxQuantity","History","options","params","path","addLinkParam","e","url","build","history","pushState"],"mappings":"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"}