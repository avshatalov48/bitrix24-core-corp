{"version":3,"file":"controller.bundle.js","sources":["../src/basket.js","../src/application.js"],"sourcesContent":["import { ajax } from 'main.core';\nimport { Pool, Timer, Basket as Lib } from 'sale.checkout.lib'\nimport {\n    Application as ApplicationConst,\n    RestMethod as RestMethodConst,\n    Component as ComponentConst,\n    Loader as LoaderConst,\n    Pool as PoolConst,\n} from 'sale.checkout.const';\n\nexport class Basket\n{\n    constructor()\n    {\n        this.pool = this.getPool();\n        this.timer = this.getTimer();\n\n        this.running = 'N';\n    }\n\n    /**\n     * @private\n     */\n    getPool()\n    {\n        return new Pool();\n    }\n\n    /**\n     * @private\n     */\n    getTimer()\n    {\n        return new Timer();\n    }\n\n    /**\n     * @private\n     */\n    isRunning()\n    {\n        return this.running === 'Y';\n    }\n\n    /**\n     * @private\n     */\n    setRunningY()\n    {\n        this.running = 'Y'\n    }\n\n    /**\n     * @private\n     */\n    setRunningN()\n    {\n        this.running = 'N'\n    }\n\n    /**\n     * @private\n     */\n    setStore(store)\n    {\n        this.store = store;\n        return this;\n    }\n\n    /**\n     * @private\n     */\n    setProvider(provider)\n    {\n        this.provider = provider;\n        return this;\n    }\n\n    /**\n     * @private\n     */\n    executeRestAnswer(command, result, extra)\n    {\n        return this.provider.execute(command, result, extra);\n    }\n\n    /**\n     * @private\n     */\n    getItem(index)\n    {\n        return this.store.getters['basket/get'](index);\n    }\n\n    /**\n     * @private\n     */\n    getBasket()\n    {\n        return this.store.getters['basket/getBasket'];\n    }\n\n\t/**\n\t * @private\n\t */\n\tgetBasketCollection()\n\t{\n\t\treturn this.getBasket().filter(item => item.deleted === 'N');\n\t}\n\n    /**\n     * @private\n     */\n    changeItem(product)\n    {\n        this.store.dispatch('basket/changeItem', {\n            index: product.index,\n            fields: product.fields\n        });\n    }\n\n    /**\n     * @private\n     */\n    setQuantity(index, quantity)\n    {\n        let fields = this.getItem(index);\n\n        fields.quantity = quantity;\n        fields.baseSum = this.round(fields.basePrice * fields.quantity);\n        fields.sum = this.round(fields.price * fields.quantity);\n        fields.discount.sum = this.round(fields.discount.price * fields.quantity);\n\n        this.refreshDiscount();\n        this.refreshTotal();\n\n        this.pool.add(PoolConst.action.quantity, index, {id: fields.id, value: fields.quantity});\n        this.changeItem({index, fields});\n        this.shelveCommit();\n    }\n\n    refreshDiscount()\n    {\n        let basket = this.getBasket();\n        if(basket.length > 0)\n        {\n            this.store.dispatch('basket/setDiscount', {\n                sum: basket.reduce((result, value) => result + value.discount.sum, 0),\n            });\n        }\n    }\n\n    refreshTotal()\n    {\n        let basket = this.getBasketCollection();\n        if(basket.length > 0)\n        {\n            this.store.dispatch('basket/setTotal', {\n                price: basket.reduce((result, value) => result + value.sum, 0),\n                basePrice: basket.reduce((result, value) => result + value.baseSum, 0)\n            });\n        }\n    }\n\n    /**\n     * @private\n     */\n    removeItem(product)\n    {\n        return this.store.dispatch('basket/removeItem', {\n            index: product.index\n        });\n    }\n\n    /**\n     * @private\n     */\n    round(value, precision = 10)\n    {\n        const factor = Math.pow(10, precision);\n\n        return Math.round(value * factor) / factor;\n    }\n\n    emitOnBasketChange()\n    {\n        BX.onCustomEvent('OnBasketChange');\n    }\n\n    /**\n     * @private\n     */\n    handlerOrderSuccess()\n    {\n        this.emitOnBasketChange()\n    }\n\n    /**\n     * @private\n     */\n    handlerRemoveProductSuccess()\n    {\n        this.emitOnBasketChange()\n    }\n\n    /**\n     * @private\n     */\n    handlerRestoreProductSuccess()\n    {\n        this.emitOnBasketChange()\n    }\n\n    /**\n     * @private\n     */\n    handlerRemove(event)\n    {\n        let index = event.getData().index;\n        let fields = this.getItem(index);\n\n        fields.deleted = 'Y';\n        fields.status = LoaderConst.status.wait;\n\n        this.pool.add(PoolConst.action.delete, index, {id: fields.id, fields: {value: 'Y'}});\n        this.changeItem({index, fields});\n        this.shelveCommit();\n    }\n\n    /**\n     * @private\n     */\n    handlerSuccessRemove(event)\n    {\n        let index = event.getData().index;\n\n        this.timer.create(5000, index + '_DELETE', () =>\n            this.removeItem({index})\n                .then(() =>\n                {\n                    if(this.getBasket().length === 0)\n                    {\n                        this.store.dispatch('application/setStage', {stage: ApplicationConst.stage.empty})\n                    }\n                })\n        )\n    }\n\n    /**\n     * @private\n     */\n    handlerRestore(event)\n    {\n        let index = event.getData().index;\n        let fields = this.getItem(index);\n\n        this.timer.clean({\n            index: index + '_DELETE'\n        });\n\n        fields.deleted = 'N';\n        fields.status = LoaderConst.status.wait;\n\n        //todo: send all fields ?\n        this.pool.add(PoolConst.action.restore, index, {\n            basePrice:fields.basePrice,\n            baseSum:fields.baseSum,\n            currency:fields.currency,\n            discount:fields.discount,\n            id:fields.id,\n            measureText:fields.measureText,\n            module:fields.module,\n            name:fields.name,\n            price:fields.price,\n            product:fields.product,\n            productProviderClass:fields.productProviderClass,\n            props:fields.props,\n            quantity:fields.quantity,\n            sum:fields.sum,\n        });\n        this.changeItem({index, fields});\n        this.shelveCommit();\n    }\n\n    /**\n     * @private\n     */\n    handlerChangeQuantity(event)\n    {\n        // let data = event.getData().data;\n        let index = event.getData().index;\n        let fields = this.getItem(index);\n\n        let quantity = fields.quantity;\n        let ratio = fields.product.ratio;\n        let available = fields.product.availableQuantity;\n\n        quantity = Lib.roundValue(quantity)\n        ratio = Lib.roundValue(ratio)\n\n        quantity = isNaN(quantity) ? 0:quantity\n\n        if (ratio > 0 && quantity < ratio)\n        {\n            quantity = ratio;\n        }\n\n        if (available > 0 && quantity > available)\n        {\n            quantity = available;\n        }\n\n        quantity = Lib.toFixed(quantity, ratio, available)\n\n        if(fields.quantity !== quantity)\n        {\n            this.setQuantity(index, quantity)\n        }\n    }\n\n    /**\n     * @private\n     */\n    handlerQuantityPlus(event)\n    {\n        let index = event.getData().index;\n        let fields = this.getItem(index);\n        let quantity = fields.quantity;\n        let ratio = fields.product.ratio;\n        let available = fields.product.availableQuantity;\n\n        quantity = Lib.roundValue(quantity)\n        ratio = Lib.roundValue(ratio)\n\n        quantity = quantity + ratio;\n\n        if(Lib.isValueFloat(quantity))\n        {\n            quantity = Lib.roundFloatValue(quantity)\n        }\n\n        if (available > 0 && quantity > available)\n        {\n            quantity = available;\n        }\n\n        quantity = Lib.toFixed(quantity, ratio, available)\n\n        if(fields.quantity < quantity)\n        {\n            this.setQuantity(index, quantity)\n        }\n    }\n\n    /**\n     * @private\n     */\n    handlerQuantityMinus(event)\n    {\n        let index = event.getData().index;\n        let fields = this.getItem(index);\n        let quantity = fields.quantity;\n        let ratio = fields.product.ratio;\n        let available = fields.product.availableQuantity;\n\n        quantity = Lib.roundValue(quantity)\n        ratio = Lib.roundValue(ratio)\n\n        let delta = quantity = quantity - ratio;\n\n        if(Lib.isValueFloat(quantity))\n        {\n            quantity = Lib.roundFloatValue(quantity)\n\t\t\tdelta = Lib.roundFloatValue(delta)\n        }\n\n        if (ratio > 0 && quantity < ratio)\n        {\n            quantity = ratio;\n        }\n\n        if (available > 0 && quantity > available)\n        {\n            quantity = available;\n        }\n\n        quantity = Lib.toFixed(quantity, ratio, available)\n\n        if(delta >= ratio)\n        {\n            this.setQuantity(index, quantity)\n        }\n    }\n\n    /**\n     * @private\n     */\n    commit()\n    {\n        return new Promise((resolve, reject) =>\n        {\n            let fields = {};\n\n            if(this.pool.isEmpty() === false)\n            {\n                fields = this.pool.get();\n                this.pool.clean();\n\n                const component = ComponentConst.bitrixSaleOrderCheckout;\n                const cmd = RestMethodConst.saleEntityRecalculateBasket;\n\n                ajax.runComponentAction(\n                    component,\n                    cmd,\n                    {\n                        data: {\n                            actions: fields\n                        },\n                        signedParameters: this.store.getters['application/getSignedParameters']\n                    }\n                )\n                .then((result) => this.executeRestAnswer(cmd, result, this.pool)\n                    .then(() => this.commit()\n                        .then(() => resolve())))\n                .catch()\n            }\n            else\n            {\n                resolve();\n            }\n        });\n    }\n\n    /**\n     * @private\n     */\n    shelveCommit(index = 'BASKET')\n    {\n        if(this.isRunning() === false)\n        {\n            this.timer.create(300, index,\n                () => {\n                    this.setRunningY();\n                    this.commit()\n                        .then(()=>this.setRunningN())\n                }\n            );\n        }\n    }\n\n    /**\n     * @private\n     */\n    getStatus()\n    {\n        return this.store.getters['basket/getStatus'];\n    }\n\n    /**\n     * @private\n     */\n    setStatusWait()\n    {\n        let app = {status: LoaderConst.status.wait};\n        return this.store.dispatch('basket/setStatus', app);\n    }\n\n    /**\n     * @private\n     */\n    setStatusNone()\n    {\n        let app = {status: LoaderConst.status.none};\n        return this.store.dispatch('basket/setStatus', app);\n    }\n\n    /**\n     * @private\n     */\n    handlerNeedRefreshY()\n    {\n        this.setNeedRefreshY();\n        this.setStatusWait();\n    }\n\n    /**\n     * @private\n     */\n    handlerNeedRefreshN()\n    {\n        this.setNeedRefreshN();\n        this.setStatusNone();\n    }\n\n    /**\n     * @private\n     */\n    setNeedRefreshY()\n    {\n        let app = {needRefresh: 'Y'};\n        return this.store.dispatch('basket/setNeedRefresh', app);\n    }\n\n    /**\n     * @private\n     */\n    setNeedRefreshN()\n    {\n        let app = {needRefresh: 'N'};\n        return this.store.dispatch('basket/setNeedRefresh', app);\n    }\n\n    /**\n     * @private\n     */\n    handlerChangeSku(event)\n    {\n        let offerId = event.getData().data[0].ID;\n\n        let index = event.getData().index;\n        let fields = this.getItem(index);\n\n        fields.status = LoaderConst.status.wait;\n\n        this.pool.add(PoolConst.action.offer, index, {id: fields.id, fields: {offerId: offerId}});\n        this.changeItem({index, fields});\n        this.shelveCommit();\n    }\n}\n","import { Runtime, ajax } from 'main.core';\r\nimport { EventEmitter } from 'main.core.events'\r\nimport { BasketRestHandler } from 'sale.checkout.provider.rest'\r\nimport {\r\n    Application as ApplicationConst,\r\n    RestMethod as RestMethodConst,\r\n    Component as ComponentConst,\r\n    Consent as ConsentConst,\r\n    Loader as LoaderConst,\r\n    EventType\r\n} from 'sale.checkout.const';\r\n\r\nimport { History } from 'sale.checkout.lib';\r\n\r\nimport { Basket } from \"./basket\";\r\n\r\nexport class Application\r\n{\r\n    constructor(option)\r\n    {\r\n        this.init(option)\r\n            .then(() => this.initProvider())\r\n            .then(() => this.iniController())\r\n            .then(() => this.subscribeToEvents())\r\n            .then(() => this.subscribeToStoreChanges())\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    init(option)\r\n    {\r\n        this.store = option.store;\r\n        return new Promise((resolve, reject) => resolve());\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    initProvider()\r\n    {\r\n        this.provider = BasketRestHandler.create({store: this.store})\r\n        return new Promise((resolve, reject) => resolve());\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    iniController()\r\n    {\r\n        this.basket = new Basket().setStore(this.store).setProvider(this.provider);\r\n        return new Promise((resolve, reject) => resolve());\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    executeRestAnswer(command, result, extra)\r\n    {\r\n        return this.provider.execute(command, result, extra);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    subscribeToEvents()\r\n    {\r\n        EventEmitter.subscribe(EventType.order.success, (e)=>this.basket.handlerOrderSuccess(e));\r\n\r\n        EventEmitter.subscribe(EventType.basket.removeProduct, (e)=>this.basket.handlerRemoveProductSuccess(e));\r\n        EventEmitter.subscribe(EventType.basket.restoreProduct, (e)=>this.basket.handlerRestoreProductSuccess(e));\r\n\r\n        EventEmitter.subscribe(EventType.basket.buttonRemoveProduct, Runtime.debounce((e)=>this.basket.handlerRemove(e), 500, this));\r\n        EventEmitter.subscribe(EventType.basket.buttonPlusProduct, (e) => this.basket.handlerQuantityPlus(e));\r\n        EventEmitter.subscribe(EventType.basket.buttonMinusProduct, (e) => this.basket.handlerQuantityMinus(e));\r\n        EventEmitter.subscribe(EventType.basket.inputChangeQuantityProduct, (e) => this.basket.handlerChangeQuantity(e));\r\n        EventEmitter.subscribe(EventType.basket.buttonRestoreProduct, Runtime.debounce((e) => this.basket.handlerRestore(e), 500, this));\r\n        EventEmitter.subscribe(EventType.basket.needRefresh, (e) => this.basket.handlerNeedRefreshY(e));\r\n        EventEmitter.subscribe(EventType.basket.refreshAfter, (e) => this.basket.handlerNeedRefreshN(e));\r\n    \r\n        EventEmitter.subscribe(EventType.basket.changeSku, (e) => this.basket.handlerChangeSku(e));\r\n        \r\n        EventEmitter.subscribe(EventType.consent.refused, () => this.handlerConsentRefused());\r\n        EventEmitter.subscribe(EventType.consent.accepted, () => this.handlerConsentAccepted());\r\n    \r\n        EventEmitter.subscribe(EventType.element.buttonCheckout, Runtime.debounce(() => this.handlerCheckout(), 1000, this));\r\n        EventEmitter.subscribe(EventType.element.buttonShipping, Runtime.debounce(() => this.handlerShipping(), 1000, this));\r\n    \r\n        EventEmitter.subscribe(EventType.paysystem.beforeInitList, () => this.paySystemSetStatusWait());\r\n        EventEmitter.subscribe(EventType.paysystem.afterInitList, () => this.paySystemSetStatusNone());\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    subscribeToStoreChanges()\r\n    {\r\n        // this.store.subscribe((mutation, state) => {\r\n        //     const { payload, type } = mutation;\r\n        //     if (type === 'basket/setNeedRefresh')\r\n        //     {\r\n        //     \talert('@@');\r\n        //     \tthis.getData();\r\n        //     }\r\n        // });\r\n\r\n        return new Promise((resolve, reject) => resolve());\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    paySystemSetStatusWait()\r\n    {\r\n        let paySystem = { status: LoaderConst.status.wait};\r\n        return this.store.dispatch('pay-system/setStatus', paySystem);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    paySystemSetStatusNone()\r\n    {\r\n        let paySystem = { status: LoaderConst.status.none};\r\n        return this.store.dispatch('pay-system/setStatus', paySystem);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    appSetStatusWait()\r\n    {\r\n        let app = { status: LoaderConst.status.wait};\r\n        return this.store.dispatch('application/setStatus', app);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    appSetStatusNone()\r\n    {\r\n        let app = { status: LoaderConst.status.none};\r\n        return this.store.dispatch('application/setStatus', app);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    handlerConsentAccepted()\r\n    {\r\n        this.store.dispatch('consent/setStatus', ConsentConst.status.accepted);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    handlerConsentRefused()\r\n    {\r\n        this.store.dispatch('consent/setStatus', ConsentConst.status.refused);\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    handlerCheckout()\r\n    {\r\n        BX.onCustomEvent(ConsentConst.validate.submit, []);\r\n\r\n        const consent = this.store.getters['consent/get'];\r\n        const consentStatus = this.store.getters['consent/getStatus'];\r\n        const allowed = consent.id > 0 ?  consentStatus === ConsentConst.status.accepted:true;\r\n\r\n        if(allowed)\r\n        {\r\n            // this.propertiesValidate();\r\n            // this.propertiesIsValid() ? alert('propsSuccess'):alert('propsError')\r\n \r\n            this.appSetStatusWait();\r\n\r\n            this.saveOrder()\r\n                .then(() => {\r\n                        this.appSetStatusNone()\r\n                            .then(()=>\r\n                            {\r\n                                let order = this.store.getters['order/getOrder'];\r\n\r\n                                if(order.id>0)\r\n                                {\r\n                                    const url = History.pushState(\r\n                                        this.store.getters['application/getPathLocation'],\r\n                                        {\r\n                                            accountNumber: order.accountNumber,\r\n                                            access: order.hash\r\n                                        })\r\n\r\n                                    this.store.dispatch('application/setPathLocation', url);\r\n                                }\r\n                            })\r\n                    }\r\n                )\r\n                .catch(() => this.appSetStatusNone())\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    handlerShipping()\r\n    {\r\n        this.store.dispatch('application/setStage', {stage: ApplicationConst.stage.view});\r\n        // todo\r\n        delete BX.UserConsent;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    saveOrder()\r\n    {\r\n        const component = ComponentConst.bitrixSaleOrderCheckout;\r\n        const cmd = RestMethodConst.saleEntitySaveOrder;\r\n        return ajax.runComponentAction(\r\n            component,\r\n            cmd,\r\n            {\r\n                data: {\r\n                    fields: {\r\n                        siteId: this.store.getters['application/getSiteId'],\r\n                        personTypeId: this.store.getters['application/getPersonTypeId'],\r\n                        tradingPlatformId: this.store.getters['application/getTradingPlatformId'],\r\n                        properties: this.preparePropertyFields(\r\n                            this.getPropertyList()\r\n                        ),\r\n                    }\r\n                },\r\n                signedParameters: this.store.getters['application/getSignedParameters']\r\n            }\r\n        )\r\n            .then((result) => this.executeRestAnswer(cmd, result))\r\n            .catch((result) => this.executeRestAnswer(cmd, {error: result.errors}));\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    getPropertyList()\r\n    {\r\n        const result = [];\r\n        let list = this.store.getters['property/getProperty'];\r\n        try\r\n        {\r\n            for (let key in list)\r\n            {\r\n                if (!list.hasOwnProperty(key))\r\n                {\r\n                    continue;\r\n                }\r\n\r\n                result[list[key].id] = list[key];\r\n            }\r\n        }\r\n        catch (e) {}\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    preparePropertyFields(list)\r\n    {\r\n        let fields = {};\r\n        list.forEach((property, inx)=>\r\n        {\r\n            fields[inx] = property.value\r\n        })\r\n        return fields;\r\n    }\r\n}"],"names":["Basket","pool","getPool","timer","getTimer","running","Pool","Timer","store","provider","command","result","extra","execute","index","getters","getBasket","filter","item","deleted","product","dispatch","fields","quantity","getItem","baseSum","round","basePrice","sum","price","discount","refreshDiscount","refreshTotal","add","PoolConst","action","id","value","changeItem","shelveCommit","basket","length","reduce","getBasketCollection","precision","factor","Math","pow","BX","onCustomEvent","emitOnBasketChange","event","getData","status","LoaderConst","wait","delete","create","removeItem","then","stage","ApplicationConst","empty","clean","restore","currency","measureText","module","name","productProviderClass","props","ratio","available","availableQuantity","Lib","roundValue","isNaN","toFixed","setQuantity","isValueFloat","roundFloatValue","delta","Promise","resolve","reject","isEmpty","get","component","ComponentConst","bitrixSaleOrderCheckout","cmd","RestMethodConst","saleEntityRecalculateBasket","ajax","runComponentAction","data","actions","signedParameters","executeRestAnswer","commit","catch","isRunning","setRunningY","setRunningN","app","none","setNeedRefreshY","setStatusWait","setNeedRefreshN","setStatusNone","needRefresh","offerId","ID","offer","Application","option","init","initProvider","iniController","subscribeToEvents","subscribeToStoreChanges","BasketRestHandler","setStore","setProvider","EventEmitter","subscribe","EventType","order","success","e","handlerOrderSuccess","removeProduct","handlerRemoveProductSuccess","restoreProduct","handlerRestoreProductSuccess","buttonRemoveProduct","Runtime","debounce","handlerRemove","buttonPlusProduct","handlerQuantityPlus","buttonMinusProduct","handlerQuantityMinus","inputChangeQuantityProduct","handlerChangeQuantity","buttonRestoreProduct","handlerRestore","handlerNeedRefreshY","refreshAfter","handlerNeedRefreshN","changeSku","handlerChangeSku","consent","refused","handlerConsentRefused","accepted","handlerConsentAccepted","element","buttonCheckout","handlerCheckout","buttonShipping","handlerShipping","paysystem","beforeInitList","paySystemSetStatusWait","afterInitList","paySystemSetStatusNone","paySystem","ConsentConst","validate","submit","consentStatus","allowed","appSetStatusWait","saveOrder","appSetStatusNone","url","History","pushState","accountNumber","access","hash","view","UserConsent","saleEntitySaveOrder","siteId","personTypeId","tradingPlatformId","properties","preparePropertyFields","getPropertyList","error","errors","list","key","hasOwnProperty","forEach","property","inx"],"mappings":"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"}