{"version":3,"file":"checkout-form.bundle.js","sources":["../src/form/model.js","../src/blocks/base-block.js","../src/blocks/basket.js","../src/blocks/total.js","../src/blocks/loader.js","../src/blocks/payments.js","../src/blocks/place-order.js","../src/blocks/properties.js","../src/blocks/success.js","../src/blocks/factory.js","../src/form/scheme.js","../src/form/form.js","../src/form/factory.js"],"sourcesContent":["export default class Model\n{\n\tfields: Map<string, mixed> = null;\n\toriginalFields: Map<string, mixed> = null;\n\n\tconstructor(fields: Object<string, mixed>)\n\t{\n\t\tthis.initFields(fields);\n\t}\n\n\tinitFields(fields: Object<string, mixed>): void\n\t{\n\t\tthis.fields = new Map(Object.entries(fields));\n\t\tthis.originalFields = new Map(Object.entries(fields));\n\t}\n\n\thasField(name: string): boolean\n\t{\n\t\treturn this.fields.has(name);\n\t}\n\n\tgetFields(): Object\n\t{\n\t\tconst fields = {};\n\n\t\tfor (let [k, v] of this.fields)\n\t\t{\n\t\t\tfields[k] = v;\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\tgetField(name: string, defaultValue: ?mixed = null): mixed\n\t{\n\t\treturn this.fields.has(name) ? this.fields.get(name) : defaultValue;\n\t}\n\n\tgetOriginalField(name: string): ?mixed\n\t{\n\t\treturn this.originalFields.has(name) ? this.originalFields.get(name) : null;\n\t}\n\n\tsetField(name: string, value: mixed): boolean\n\t{\n\t\tthis.fields.set(name, value);\n\n\t\treturn this.getOriginalField(name) === value;\n\t}\n}","import {Cache, Dom, Event, Tag, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Form, {Stage} from '../form/form';\nimport Model from '../form/model';\nimport {BlockType} from './factory';\n\nexport class BaseBlock extends EventEmitter\n{\n\tstatic VIEW_MODE: Mode = 'view';\n\tstatic EDIT_MODE: Mode = 'edit';\n\n\tform: Form = null;\n\tsettings: BlockSetting = null;\n\n\tcache = new Cache.MemoryCache();\n\tmode: Mode = BaseBlock.EDIT_MODE;\n\n\tconstructor(form: Form, settings: BlockSetting = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Sale.CheckoutForm.Block');\n\n\t\tthis.form = form;\n\t\tthis.settings = settings;\n\t}\n\n\tgetForm(): Form\n\t{\n\t\treturn this.form;\n\t}\n\n\tgetModel(): Model\n\t{\n\t\treturn this.getForm().getModel();\n\t}\n\n\tgetCache()\n\t{\n\t\treturn this.cache;\n\t}\n\n\tgetWrapper(): ?HTMLElement\n\t{\n\t\treturn this.getCache().remember('wrapper', () => {\n\t\t\tlet wrapper;\n\n\t\t\tif (this.hasSetting('wrapperId'))\n\t\t\t{\n\t\t\t\twrapper = document.getElementById(this.getSetting('wrapperId'));\n\t\t\t\tif (!Type.isDomNode(wrapper))\n\t\t\t\t{\n\t\t\t\t\tthrow new Error(`Can't find block wrapper with id '${this.getSetting('wrapperId')}'.`);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twrapper = Tag.render`<div></div>`;\n\t\t\t\tthis.getForm().getContainer().appendChild(wrapper);\n\t\t\t}\n\n\t\t\treturn wrapper;\n\t\t});\n\t}\n\n\thasSetting(name: string): boolean\n\t{\n\t\treturn name in this.settings;\n\t}\n\n\tgetSetting(name: string, defaultValue = null): mixed\n\t{\n\t\treturn this.settings[name] || defaultValue;\n\t}\n\n\tgetMode(): Mode\n\t{\n\t\treturn this.mode;\n\t}\n\n\tsetMode(mode: Mode): void\n\t{\n\t\tthis.mode = mode;\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn this.getSetting('type');\n\t}\n\n\tgetStage(): number\n\t{\n\t\treturn this.getSetting('stage', Stage.INITIAL);\n\t}\n\n\tisSuccess(): boolean\n\t{\n\t\treturn this.getSetting('type') === BlockType.SUCCESS;\n\t}\n\n\trefreshLayout(forceLayout: boolean = false): void\n\t{\n\t\tlet mode;\n\n\t\tconst formStage = this.getForm().getStage();\n\t\tconst blockStage = this.getStage();\n\n\t\tif (Type.isPlainObject(blockStage))\n\t\t{\n\t\t\tconst {view: viewStage, edit: editStage, hide: hideStage} = blockStage;\n\t\t\tlet currentStage = 0;\n\n\t\t\twhile (currentStage <= formStage)\n\t\t\t{\n\t\t\t\tif (currentStage === hideStage)\n\t\t\t\t{\n\t\t\t\t\tmode = undefined;\n\t\t\t\t}\n\t\t\t\telse if (currentStage === editStage)\n\t\t\t\t{\n\t\t\t\t\tmode = BaseBlock.EDIT_MODE;\n\t\t\t\t}\n\t\t\t\telse if (currentStage === viewStage)\n\t\t\t\t{\n\t\t\t\t\tmode = BaseBlock.VIEW_MODE;\n\t\t\t\t}\n\n\t\t\t\tcurrentStage++;\n\t\t\t}\n\t\t}\n\t\telse if (Type.isNumber(blockStage))\n\t\t{\n\t\t\tif (blockStage <= formStage)\n\t\t\t{\n\t\t\t\tmode = BaseBlock.EDIT_MODE;\n\t\t\t}\n\t\t}\n\n\t\tthis.clearLayout();\n\n\t\tif (mode || forceLayout)\n\t\t{\n\t\t\tif (mode)\n\t\t\t{\n\t\t\t\tthis.setMode(mode);\n\t\t\t}\n\n\t\t\tthis.layout();\n\t\t}\n\t}\n\n\tclearLayout(): void\n\t{\n\t\tif (this.getCache().has('wrapper'))\n\t\t{\n\t\t\tconst wrapper = this.getWrapper();\n\n\t\t\tif (Type.isDomNode(wrapper))\n\t\t\t{\n\t\t\t\tEvent.unbindAll(wrapper);\n\n\t\t\t\tif (this.hasSetting('wrapperId'))\n\t\t\t\t{\n\t\t\t\t\tDom.clean(wrapper);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.remove(wrapper);\n\t\t\t\t}\n\n\t\t\t\tthis.getCache().delete('wrapper');\n\t\t\t}\n\t\t}\n\t}\n\n\tlayout(): void\n\t{\n\t\tthrow new Error('Not implemented method.');\n\t}\n}\n\nexport type BlockSetting = {\n\ttype: string,\n\toptions: { [key: string]: any }\n}\n\nexport type Mode = 'view' | 'edit'","import {BaseBlock} from './base-block';\nimport {Dom, Tag, Text, Loc, Type, ajax} from 'main.core';\nimport Form from \"../form/form\";\n\nexport class Basket extends BaseBlock\n{\n\tconstructor(form: Form, options: Object = {})\n\t{\n\t\tsuper(form, options);\n\n\t\tthis.deleteItemHandler = this.delete.bind(this);\n\t}\n\n\tdelete(event: Event)\n\t{\n\t\tconst div = event.target;\n\n\t\tif (!Type.isDomNode(div))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemId = div.getAttribute('data-item-id');\n\n\t\tajax.runAction(\n\t\t\t'sale.entity.deletebasketitem',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tid: itemId\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then((response)=>{\n\t\t\t\tconst redirectPath = this.getForm().getParameter('currentPage');\n\t\t\t\tif (Type.isStringFilled(redirectPath))\n\t\t\t\t{\n\t\t\t\t\tdocument.location.href = redirectPath;\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tlayout(): void\n\t{\n\t\tthis.getWrapper().appendChild(\n\t\t\t// workaround: Tag.render`` can't render table with dynamic rows content\n\t\t\tDom.create('table', {\n\t\t\t\tattrs: {className: 'checkout-item-list'},\n\t\t\t\tchildren: [\n\t\t\t\t\t...this.getProducts(),\n\t\t\t\t\tthis.getTotalNode()\n\t\t\t\t]\n\t\t\t})\n\t\t);\n\t}\n\n\tgetBasketItems(): Array<mixed>\n\t{\n\t\treturn this.getForm().getSchemeField('basketItems', []);\n\t}\n\n\tgetBasketPositionsCount(): number\n\t{\n\t\treturn this.getBasketItems().length;\n\t}\n\n\tgetProducts(): HTMLElement[]\n\t{\n\t\tconst itemNodes = [];\n\n\t\tthis.getBasketItems().forEach((item) => {\n\t\t\tconst discountNode = this.getItemDiscountNode(item);\n\t\t\tconst propsNode = this.getItemPropsNode(item);\n\t\t\tconst imageSrc = item.catalogProduct.frontImage ? item.catalogProduct.frontImage.src : '';\n\t\t\tconst itemNode = Tag.render`\n\t\t\t\t<table>\n\t\t\t\t\t<tr class=\"checkout-item\">\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<div class=\"checkout-item-info\">\n\t\t\t\t\t\t\t\t<div class=\"checkout-item-image-block\">\n\t\t\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\t\t\tclass=\"checkout-item-remove-btn\" \n\t\t\t\t\t\t\t\t\t\tdata-item-id=\"${item.id}\"\n\t\t\t\t\t\t\t\t\t\tonclick=\"${this.deleteItemHandler}\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<svg class=\"checkout-item-remove-btn-icon\"  width=\"8\" height=\"9\" viewBox=\"0 0 8 9\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M1.18631 0.79834L0.0958433 1.88881L2.70705 4.50001L0.0957031 7.11136L1.18617 8.20182L3.79752 5.59048L6.40848 8.20145L7.49895 7.11098L4.88798 4.50001L7.49881 1.88918L6.40834 0.798718L3.79752 3.40955L1.18631 0.79834Z\" fill=\"#C4C4C4\"/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<img src=\"${imageSrc}\" alt=\"\" class=\"checkout-item-image\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div class=\"checkout-item-name-block\">\n\t\t\t\t\t\t\t\t\t<h2 class=\"checkout-item-name\">${Text.encode(item.name)}</h2>\n\t\t\t\t\t\t\t\t\t<div>${propsNode}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div class=\"checkout-item-quantity-block\">\n\t\t\t\t\t\t\t\t\t<div class=\"checkout-item-quantity-field-container\">\n<!--\t\t\t\t\t\t\t\t\t\t<div class=\"checkout-item-quantity-btn-minus no-select\"></div>-->\n\t\t\t\t\t\t\t\t\t\t<div class=\"checkout-item-quantity-field-block\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"checkout-item-quantity-field\" type=\"text\" inputmode=\"numeric\" value=\"${item.quantity}\">\n\t\t\t\t\t\t\t\t\t\t</div>\n<!--\t\t\t\t\t\t\t\t\t\t<div class=\"checkout-item-quantity-btn-plus no-select\"></div>-->\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<span class=\"checkout-item-quantity-description\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"checkout-item-quantity-description-text\">${Text.encode(item.measureText)}</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"checkout-item-quantity-description-price\"></span>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<div class=\"checkout-item-price-block\">\n\t\t\t\t\t\t\t\t${discountNode}\n\t\t\t\t\t\t\t\t<span class=\"checkout-item-price\">${item.sum}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t`;\n\t\t\titemNodes.push(this.getFirstRowFromTable(itemNode))\n\t\t});\n\n\t\treturn itemNodes;\n\t}\n\n\tgetItemDiscountNode(item)\n\t{\n\t\tif (item.sumDiscountDiff === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"checkout-item-price-discount-container d-flex justify-content-between align-items-center\">\n\t\t\t\t<span class=\"checkout-item-price-discount\">${item.sumBaseFormated}</span>\n\t\t\t\t<span class=\"checkout-item-price-discount-diff\">-${item.sumDiscountDiffFormated}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetItemPropsNode(item)\n\t{\n\t\tif (item.props === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\tconst propsItems = {};\n\t\tconst propsItemsDom = [];\n\t\titem.props.forEach((i) => {\n\t\t\tpropsItems[i] = {\n\t\t\t\tname: i.name,\n\t\t\t\tvalue: i.value,\n\t\t\t};\n\n\t\t\tvar domRender = Tag.render`<div class=\"checkout-item-props\">${propsItems[i].name}: ${propsItems[i].value}</div>`;\n\n\t\t\tpropsItemsDom.push(domRender);\n\t\t});\n\n\t\treturn propsItemsDom;\n\t}\n\n\tgetTotalData(): Array<mixed>\n\t{\n\t\treturn this.getForm().getSchemeField('orderPriceTotal', {});\n\t}\n\n\tgetTotalNode(): HTMLElement\n\t{\n\t\tconst total = this.getTotalData();\n\t\tconst discountNode = this.getTotalDiscountNode(total);\n\t\tconst subTotalNode = Tag.render`\n\t\t\t<table>\n\t\t\t\t<tr class=\"checkout-item-summary\">\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-summary\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('SALE_BLOCKS_BASKET_ITEMS')}</span>\n<!--\t\t\t\t\t\t\t<span class=\"checkout-icon-helper\"></span>-->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-item-price-block\">\n\t\t\t\t\t\t\t${discountNode}\n\t\t\t\t\t\t\t<span class=\"checkout-item-price\">${total.orderPriceFormated}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t`;\n\n\t\treturn this.getFirstRowFromTable(subTotalNode);\n\t}\n\n\tgetTotalDiscountNode(total)\n\t{\n\t\tif (total.basketPriceDiscountDiffValue === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"checkout-item-price-discount-container d-flex justify-content-between align-items-center\">\n\t\t\t\t<span class=\"checkout-item-price-discount\">${total.priceWithoutDiscount}</span>\n\t\t\t\t<span class=\"checkout-item-price-discount-diff\">-${total.basketPriceDiscountDiff}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t// workaround: Tag.render`` can't render tr/td nodes without table node\n\tgetFirstRowFromTable(table: HTMLTableElement): HTMLTableRowElement\n\t{\n\t\treturn table.rows[0];\n\t}\n}","import {BaseBlock} from './base-block';\nimport {Dom, Tag, Loc} from 'main.core';\n\nexport class Total extends BaseBlock\n{\n\tlayout(): void\n\t{\n\t\tconst total = this.getForm().getSchemeField('orderPriceTotal');\n\n\t\tthis.getWrapper().appendChild(\n\t\t\t// workaround: Tag.render`` can't render table with dynamic rows content\n\t\t\tDom.create('table', {\n\t\t\t\tattrs: {className: 'checkout-summary-list'},\n\t\t\t\tchildren: [\n\t\t\t\t\tthis.getBasketTotalNode(total),\n\t\t\t\t\tthis.getDiscountNode(total),\n\t\t\t\t\tthis.getShippingNode(total),\n\t\t\t\t\tthis.getTaxesNode(total),\n\t\t\t\t\tthis.getSummaryNode(total)\n\t\t\t\t]\n\t\t\t})\n\t\t);\n\t}\n\n\tgetBasketPositionsCount(): number\n\t{\n\t\treturn this.getForm().getSchemeField('basketItems', []).length;\n\t}\n\n\tgetBasketTotalNode(total): HTMLTableRowElement\n\t{\n\n\t\treturn this.getFirstRowFromTable(Tag.render`\n\t\t\t<table>\n\t\t\t\t<tr class=\"checkout-summary-item checkout-summary-item-subtotal\">\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-summary\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('SALE_BLOCKS_TOTAL_ITEMS')}</span>\n<!--\t\t\t\t\t\t\t<span class=\"checkout-icon-helper\"></span>-->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-item-price-block\">\n\t\t\t\t\t\t\t<span class=\"checkout-item-price\">${total.priceWithoutDiscount}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t`);\n\t}\n\n\tgetDiscountNode(total): HTMLTableRowElement\n\t{\n\t\tif (total.discountPrice === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn this.getFirstRowFromTable(Tag.render`\n\t\t\t<table>\n\t\t\t\t<tr class=\"checkout-summary-item checkout-summary-item-discount\">\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-summary\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('SALE_BLOCKS_TOTAL_DISCOUNT')}</span>\n<!--\t\t\t\t\t\t\t<span class=\"checkout-icon-helper\"></span>-->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-item-price-block\">\n\t\t\t\t\t\t\t<span class=\"checkout-summary-item-price-discount\">-${total.discountPriceFormated}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t`);\n\t}\n\n\tgetShippingNode(total): HTMLTableRowElement\n\t{\n\t\tif (true)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn this.getFirstRowFromTable(Tag.render`\n\t\t\t<table>\n\t\t\t\t<tr class=\"checkout-summary-item\">\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-summary\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('SALE_BLOCKS_TOTAL_NAME')}</span>\n<!--\t\t\t\t\t\t\t<span class=\"checkout-icon-helper\"></span>-->\n\t\t\t\t\t\t\t<div class=\"checkout-summary-item-description\">${Loc.getMessage('SALE_BLOCKS_TOTAL_DESCRIPTION')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-item-price-block\">\n\t\t\t\t\t\t\t<span class=\"checkout-item-price\">$10.55</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t`);\n\t}\n\n\tgetTaxesNode(total): HTMLTableRowElement\n\t{\n\t\tif (true)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn this.getFirstRowFromTable(Tag.render`\n\t\t\t<table>\n\t\t\t\t<tr class=\"checkout-summary-item\">\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-summary\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('SALE_BLOCKS_TOTAL_TAXES')}</span>\n\t\t\t\t\t\t\t<span class=\"checkout-icon-helper\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-item-price-block\">\n\t\t\t\t\t\t\t<span class=\"checkout-item-price\">$13.99</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t`);\n\t}\n\n\tgetSummaryNode(total): HTMLTableRowElement\n\t{\n\t\treturn this.getFirstRowFromTable(Tag.render`\n\t\t\t<table>\n\t\t\t\t<tr class=\"checkout-summary-item checkout-summary-item-total\">\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-summary\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('SALE_BLOCKS_TOTAL_TOTAL')}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class=\"checkout-item-price-block\">\n<!--\t\t\t\t\t\t\t<span class=\"checkout-item-price\">${total.orderTotalPriceFormated}</span>-->\n\t\t\t\t\t\t\t<span class=\"checkout-item-price\">${total.orderPriceFormated}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t`);\n\t}\n\n\t// workaround: Tag.render`` can't render tr/td nodes without table node\n\tgetFirstRowFromTable(table: HTMLTableElement): HTMLTableRowElement\n\t{\n\t\treturn table.rows[0];\n\t}\n}","import {BaseBlock} from './base-block';\n\nexport class Loader extends BaseBlock\n{\n\tlayout()\n\t{\n\t\tthis.getWrapper();\n\t\tthis.clearLayout();\n\t}\n}","import {ajax, Type} from 'main.core';\nimport {BaseBlock} from './base-block';\nimport {Dom, Tag, Text} from 'main.core';\nimport {rest as Rest} from 'rest.client';\n\nexport class Payments extends BaseBlock\n{\n\trefreshLayout(forceLayout: boolean = false): void\n\t{\n\t\tlet mode;\n\n\t\tconst formStage = this.getForm().getStage();\n\t\tconst blockStage = this.getStage();\n\n\t\tif (Type.isPlainObject(blockStage))\n\t\t{\n\t\t\tconst {view: viewStage, edit: editStage, hide: hideStage} = blockStage;\n\t\t\tlet currentStage = 0;\n\n\t\t\twhile (currentStage <= formStage)\n\t\t\t{\n\t\t\t\tif (currentStage === hideStage)\n\t\t\t\t{\n\t\t\t\t\tmode = undefined;\n\t\t\t\t}\n\t\t\t\telse if (currentStage === editStage)\n\t\t\t\t{\n\t\t\t\t\tmode = BaseBlock.EDIT_MODE;\n\t\t\t\t}\n\t\t\t\telse if (currentStage === viewStage)\n\t\t\t\t{\n\t\t\t\t\tmode = BaseBlock.VIEW_MODE;\n\t\t\t\t}\n\n\t\t\t\tcurrentStage++;\n\t\t\t}\n\t\t}\n\t\telse if (Type.isNumber(blockStage))\n\t\t{\n\t\t\tif (blockStage <= formStage)\n\t\t\t{\n\t\t\t\tmode = BaseBlock.EDIT_MODE;\n\t\t\t}\n\t\t}\n\n\t\tthis.clearLayout();\n\n\t\tif (mode || forceLayout)\n\t\t{\n\t\t\tif (mode)\n\t\t\t{\n\t\t\t\tthis.setMode(mode);\n\t\t\t}\n\n\t\t\tthis.layout();\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tlet access = this.getForm().getSchemeField('hash');\n\t\tlet paySystemReturnUrl = this.getForm().getParameter('paySystemReturnUrl');\n\n\t\tlet payments = this.getForm().getField('payments');\n\n\t\tlet paymentId = 0;\n\t\tObject.keys(payments).forEach((id)=>{paymentId = id; return false;});\n\n\t\tajax.runAction(\n\t\t\t'sale.entity.paymentpay',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tpaymentId: paymentId,\n\t\t\t\t\t\taccessCode: access,\n\t\t\t\t\t\treturnUrl: paySystemReturnUrl,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then(this.getPaySystemsList.bind(this));\n\n\t\t//${this.getPaySystemNodes()}\n\t}\n\n\tgetPaySystemsList(response)\n\t{\n\t\tconst wrapper = this.getWrapper();\n\n\t\tif(\n\t\t\tBX.type.isPlainObject(response.data)\n\t\t\t&& BX.type.isNotEmptyString(response.data.html)\n\t\t)\n\t\t{\n\t\t\t BX.html(wrapper, response.data.html);\n\n\t\t\tBX.addCustomEvent('onChangePaySystems', ()=>{\n\t\t\t\tthis.getForm().refreshLayout();\n\t\t\t});\n\t\t}\n\t}\n\n\tgetPaySystems(): []\n\t{\n\t\treturn this.getForm().getSchemeField('paySystems', []);\n\t}\n\n\tgetPaySystemNodes(): HTMLElement[]\n\t{\n\t\tconst paySystemNodes = [];\n\n\t\tthis.getPaySystems().forEach((item) => {\n\t\t\tpaySystemNodes.push(Tag.render`\n\t\t\t\t<div class=\"checkout-checkout-method\">\n\t\t\t\t\t<div class=\"checkout-checkout-method-image-block\">\n\t\t\t\t\t\t<img src=\"${item.logotipSrc}\" alt=\"\" class=\"checkout-checkout-method-img\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"checkout-checkout-method-name-block\">\n\t\t\t\t\t\t<div class=\"checkout-checkout-method-name\">${Text.encode(item.name)}</div>\n\t\t\t\t\t\t<div class=\"checkout-checkout-method-description\">${Text.encode(item.description)}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"checkout-checkout-method-btn-block\">\n\t\t\t\t\t\t<button \n\t\t\t\t\t\t\tclass=\"btn btn-primary checkout-checkout-btn btn-sm rounded-pill\"\n\t\t\t\t\t\t\tdata-paysystem-id=\"${item.id}\"\n\t\t\t\t\t\t\tonclick=\"${this.handleCheckoutClick.bind(this)}\"\n\t\t\t\t\t\t>Checkout</button>\n<!--\t\t\t\t\t\t<button class=\"checkout-checkout-btn checkout-checkout-btn-selected btn btn-sm rounded-pill\">Selected</button>-->\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`);\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"checkout-checkout-method-list\">\n\t\t\t\t${paySystemNodes}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\thandleCheckoutClick(event: MouseEvent): void\n\t{\n\t\tconst paySystemId = Text.toNumber(event.target.getAttribute('data-paysystem-id'));\n\n\t\tthis.getForm().setFieldNoDemand('paySystemId', paySystemId);\n\t\tevent.target.setAttribute('disabled', 'disabled');\n\t\tDom.addClass(event.target, 'checkout-checkout-btn-selected');\n\t\tevent.target.innerHTML = '<span class=\"spinner-border spinner-border-sm mr-2\"></span>' + event.target.innerHTML;\n\n\t\tlet payments = this.getForm().getField('payments');\n\t\tlet paymentId = 0;\n\t\tObject.keys(payments).forEach((id)=>{paymentId = id; return false;});\n\n\t\tajax.runAction(\n\t\t\t'sale.entity.paymentpay',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tID: paymentId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then(function (response) {\n\n\t\t\t\tif(\n\t\t\t\t\tBX.type.isPlainObject(response.data)\n\t\t\t\t\t&& BX.type.isNotEmptyString(response.data.html)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tBX.html(event.target, response.data.html);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n}","import {BaseBlock} from './base-block';\nimport {ajax, Tag, Loc, Type} from 'main.core';\nimport Form from '../form/form';\n\nexport class PlaceOrder extends BaseBlock\n{\n\tconstructor(form: Form, options: Object = {})\n\t{\n\t\tsuper(form, options);\n\n\t\tthis.saveOrderHandler = this.saveOrder.bind(this);\n\n\t\tconst properties = this.getForm().getParameter('userConsentPropertyData');\n\n\t\tthis.userConsent = {\n\t\t\tid: 1,\n\t\t\ttitle: Loc.getMessage('SALE_BLOCKS_PLACE_ORDER_NOW'),\n\t\t\tisLoaded: 'Y',\n\t\t\tautoSave: 'Y',\n\t\t\tisChecked: 'Y',\n\t\t\tsubmitEventName: 'onUserConsent',\n\t\t\tfields: Type.isArrayFilled(properties)? JSON.stringify(properties):[]\n\t\t};\n\n\t\tthis.isAllowedSubmitting = this.userConsent.isChecked === 'Y';\n\t}\n\n\tlayout_(): void\n\t{\n\t\tthis.getWrapper().appendChild(Tag.render`\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t${this.getConsent()}\n\t\t\t\t\t\t\t${this.getSaveButton()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`);\n\t}\n\n\tlayout(): void\n\t{\n\t\tconst wrapper = this.getWrapper();\n\n\t\tajax.runAction(\n\t\t\t'sale.entity.userconsentrequest',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tfields: this.userConsent\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then((response)=>{\n\t\t\t\tif(\n\t\t\t\t\tBX.type.isPlainObject(response.data)\n\t\t\t\t\t&& BX.type.isNotEmptyString(response.data.html)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tlet consent = response.data.html;\n\n\t\t\t\t\twrapper.appendChild(Tag.render`\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t${consent}\n\t\t\t\t\t\t\t${this.getSaveButton()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`);\n\n\t\t\t\t\tif (BX.UserConsent !== undefined)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet control = BX.UserConsent.load(wrapper);\n\n\t\t\t\t\t\tBX.addCustomEvent(\n\t\t\t\t\t\t\tcontrol,\n\t\t\t\t\t\t\tBX.UserConsent.events.accepted,\n\t\t\t\t\t\t\t() => this.isAllowedSubmitting = true\n\t\t\t\t\t\t);\n\t\t\t\t\t\tBX.addCustomEvent(\n\t\t\t\t\t\t\tcontrol,\n\t\t\t\t\t\t\tBX.UserConsent.events.refused,\n\t\t\t\t\t\t\t() => this.isAllowedSubmitting = false\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tgetConsent(): HTMLElement\n\t{\n\n\t\t// todo replace with existing consent api\n\t\treturn Tag.render`\n\t\t \t<label class=\"checkout-agreement-container\">\n\t\t \t\t<div class=\"checkout-agreement-block\">\n\t\t \t\t\t<input type=\"checkbox\" class=\"checkout-agreement-input\" checked=\"checked\">\n\t\t \t\t</div>\n\t\t \t\t<div class=\"checkout-agreement-block\">\n\t\t \t\t\t<div class=\"checkout-agreement-text\">${Loc.getMessage('SALE_BLOCKS_PLACE_ORDER_TEXT')}</div>\n\t\t \t\t</div>\n\t\t \t</label>\n\t\t `;\n\t}\n\n\tgetSaveButton(): HTMLElement\n\t{\n\t\treturn this.getCache().remember('save-button', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"checkout-btn-container\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn btn-primary product-item-detail-buy-button btn-md rounded-pill\"\n\t\t\t\t\t\tonclick=\"${this.saveOrderHandler}\"\n\t\t\t\t\t\t>${Loc.getMessage('SALE_BLOCKS_PLACE_ORDER_NOW')}</button>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tsaveOrder()\n\t{\n\t\tBX.onCustomEvent(this.userConsent.submitEventName, []);\n\n\t\tif(this.isAllowedSubmitting)\n\t\t{\n\t\t\tthis.getSaveButton().disabled = true;\n\t\t\tthis.getForm().requestSave();\n\t\t}\n\t}\n}","import {BaseBlock} from './base-block';\nimport {Dom, Tag, Text, Type, Loc} from 'main.core';\n\nexport class Properties extends BaseBlock\n{\n\tlayout()\n\t{\n\t\tthis.getWrapper().appendChild(\n\t\t\tthis.getMode() === BaseBlock.VIEW_MODE ? this.getViewLayout() : this.getEditLayout()\n\t\t);\n\t}\n\n\tgetPropertiesShort(): string\n\t{\n\t\tconst propertyValues = this.getForm().getField('properties');\n\t\tconst properties = [];\n\n\t\tfor (let propertyId in propertyValues)\n\t\t{\n\t\t\tif (propertyValues.hasOwnProperty(propertyId) && Type.isStringFilled(propertyValues[propertyId]))\n\t\t\t{\n\t\t\t\tproperties.push(propertyValues[propertyId]);\n\t\t\t}\n\t\t}\n\n\t\treturn properties.join(', ');\n\t}\n\n\tgetViewLayout(): HTMLElement\n\t{\n\t\tconst orderNumber = this.getForm().getSchemeField('accountNumber');\n\t\tconst propertiesInfo = this.getPropertiesShort();\n\n\t\treturn Tag.render`\n\t\t\t<div style=\"border-bottom: 1px solid #cecece;\">\n\t\t\t\t<tr class=\"checkout-summary-item\">\n\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t<div class=\"checkout-item-personal-order-info\">\n\t\t\t\t\t\t\t<div class=\"checkout-item-personal-order-payment\">\n\t\t\t\t\t\t\t\t<strong>${Loc.getMessage('SALE_BLOCKS_PROPERTIES_ORDER_TITLE').replace('#ORDER_NUMBER#', orderNumber)}</strong>\n\t\t\t\t\t\t\t\t<div>${propertiesInfo}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"checkout-item-personal-order-shipping\">\n\t\t\t\t\t\t\t\t<strong>${Loc.getMessage('SALE_BLOCKS_PROPERTIES_SHIPPING_METHOD')}</strong>\n\t\t\t\t\t\t\t\t<div>${Loc.getMessage('SALE_BLOCKS_PROPERTIES_SHIPPING_METHOD_DESCRIPTION')}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEditLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"checkout-form-container\">\n\t\t\t\t<div class=\"checkout-form-header\">\n\t\t\t\t\t<div class=\"checkout-form-title\">${Loc.getMessage('SALE_BLOCKS_PROPERTIES_TITLE')}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"checkout-form-block\">\n\t\t\t\t\t<form>\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t${this.getProperties()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetProperties(): HTMLElement[]\n\t{\n\t\tconst properties = [];\n\n\t\tthis.getForm().getSchemeField('properties', []).forEach((item) => {\n\t\t\tif (item.type === 'STRING')\n\t\t\t{\n\t\t\t\tconst value = this.getForm().getField('properties', {})[item.id] || '';\n\t\t\t\tconst type = item.isPhone === 'Y' ? 'tel' : 'text';\n\t\t\t\tconst propertyNode = Tag.render`\n\t\t\t\t\t<input \n\t\t\t\t\t\ttype=\"${type}\"\n\t\t\t\t\t\tclass=\"form-control form-control-lg\"\n\t\t\t\t\t\tplaceholder=\"${Text.encode(item.name)}\"\n\t\t\t\t\t\tvalue=\"${Text.encode(value)}\"\n\t\t\t\t\t\tdata-property-id=\"${item.id}\"\n\t\t\t\t\t\tonchange=\"${this.onChangeHandler.bind(this)}\"\n\t\t\t\t\t\tonfocusout=\"${this.onFocusOutHandler.bind(this)}\">\n\t\t\t`;\n\n\t\t\t\tBX.addCustomEvent(\"BX.Sale.Checkout.Property.Error:onSave_\" + item.id, ()=>{\n\t\t\t\t\tDom.addClass(propertyNode, 'border-danger');\n\t\t\t\t\tDom.removeClass(propertyNode, 'border-success');\n\t\t\t\t});\n\n\t\t\t\tproperties.push(propertyNode);\n\t\t\t}\n\t\t});\n\n\t\treturn properties;\n\t}\n\n\tonChangeHandler(event: Event)\n\t{\n\t\tconst input = event.target;\n\n\t\tif (!Type.isDomNode(input))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst propertyId = input.getAttribute('data-property-id');\n\t\tconst properties = this.getForm().getField('properties');\n\n\t\tproperties[propertyId] = input.value;\n\t\tthis.getForm().setFieldNoDemand('properties', properties);\n\t}\n\n\tonFocusOutHandler(event: Event)\n\t{\n\t\tconst input = event.target;\n\t\tif (!Type.isDomNode(input))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isStringFilled(input.value))\n\t\t{\n\t\t\tDom.addClass(input, 'border-success');\n\t\t\tDom.removeClass(input, 'border-danger');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(input, 'border-danger');\n\t\t\tDom.removeClass(input, 'border-success');\n\t\t}\n\t}\n}","import {BaseBlock} from './base-block';\nimport {Dom, Tag, Text, Type, Loc} from 'main.core';\n\nexport class Success extends BaseBlock\n{\n\tlayout()\n\t{\n\t\tthis.getWrapper().appendChild(Tag.render`\n\t\t\t<div class=\"checkout-order-status-successful\">\n\t\t\t\t<svg class=\"checkout-order-status-icon\" width=\"105\" height=\"106\" viewBox=\"0 0 105 106\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t<path opacity=\"0.6\" stroke=\"#fff\" stroke-width=\"3\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M52.5 104C80.6665 104 103.5 81.1665 103.5 53C103.5 24.8335 80.6665 2 52.5 2C24.3335 2 1.5 24.8335 1.5 53C1.5 81.1665 24.3335 104 52.5 104Z\"/>\n\t\t\t\t\t<path fill=\"#fff\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M45.517 72L28.5 55.4156L34.4559 49.611L45.517 60.3909L70.5441 36L76.5 41.8046L45.517 72Z\"/>\n\t\t\t\t</svg>\t\t\t\t\n\t\t\t\t${this.showBeforePayment()}\n\t\t\t\t${this.showAfterPayment()}\n\t\t\t</div>\n\t\t`);\n\n\t\tDom.addClass(document.body, 'container-overflow-hidden');\n\t}\n\n\tclearLayout()\n\t{\n\t\tsuper.clearLayout();\n\t\tDom.removeClass(document.body, 'container-overflow-hidden');\n\t}\n\n\tshowOrderStatus()\n\t{\n\t\tconst orderNumber = this.getForm().getSchemeField('ACCOUNT_NUMBER');\n\n\t\treturn Tag.render`\t\t\t\n\t\t\t<div class=\"checkout-order-status-text\">\n\t\t\t\t<strong>${Loc.getMessage('SALE_BLOCKS_SUCCESS_ORDER')} #${Text.encode(orderNumber)}</strong> ${Loc.getMessage('SALE_BLOCKS_SUCCESS_ORDER_CREATED')}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowPaymentStatus()\n\t{\n\t\tconst orderNumber = this.getForm().getSchemeField('ACCOUNT_NUMBER');\n\n\t\treturn Tag.render`\t\t\t\n\t\t\t<div class=\"checkout-order-status-text\">\n\t\t\t\t<strong>${Loc.getMessage('SALE_BLOCKS_SUCCESS_ORDER')} #${Text.encode(orderNumber)}</strong>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowManagerWillCall()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"checkout-order-common-container\">\n\t\t\t\t<div class=\"checkout-order-common-row\">\n\t\t\t\t\t<svg class=\"checkout-order-common-row-icon\" width=\"26\" height=\"27\" viewBox=\"0 0 26 27\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M12.9124 26.6569C20.0093 26.6569 25.7624 20.9038 25.7624 13.807C25.7624 6.71014 20.0093 0.957031 12.9124 0.957031C5.81561 0.957031 0.0625 6.71014 0.0625 13.807C0.0625 20.9038 5.81561 26.6569 12.9124 26.6569Z\" fill=\"white\"/>\n\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M10.8218 19.498L5.72461 14.5304L7.50861 12.7918L10.8218 16.0207L18.3182 8.71484L20.1022 10.4535L10.8218 19.498Z\" fill=\"#65A90F\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<div>${Loc.getMessage('SALE_BLOCKS_SUCCESS_CALL')}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowPaymentSum()\n\t{\n\t\tconst total = this.getForm().getSchemeField('ORDER_PRICE_TOTAL');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"checkout-order-common-container\">\n\t\t\t\t<div class=\"checkout-order-common-row\">\n\t\t\t\t\t<svg class=\"checkout-order-common-row-icon\" width=\"26\" height=\"27\" viewBox=\"0 0 26 27\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M12.9124 26.6569C20.0093 26.6569 25.7624 20.9038 25.7624 13.807C25.7624 6.71014 20.0093 0.957031 12.9124 0.957031C5.81561 0.957031 0.0625 6.71014 0.0625 13.807C0.0625 20.9038 5.81561 26.6569 12.9124 26.6569Z\" fill=\"white\"/>\n\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M10.8218 19.498L5.72461 14.5304L7.50861 12.7918L10.8218 16.0207L18.3182 8.71484L20.1022 10.4535L10.8218 19.498Z\" fill=\"#65A90F\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<div>${Loc.getMessage('SALE_BLOCKS_SUCCESS_TO_PAID').replace('#PAID#', total.orderTotalPriceFormated)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"checkout-order-common-row\">\n\t\t\t\t\t<div>${Loc.getMessage('SALE_BLOCKS_SUCCESS_DELIVERY')}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowSeparator()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"checkout-order-section-separator\">${Loc.getMessage('SALE_BLOCKS_SUCCESS_OR')}</div>\n\t\t`;\n\t}\n\n\tshowContinueProcessing()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"checkout-order-status-btn-container\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"btn btn-checkout-order-status btn-md rounded-pill\"\n\t\t\t\t\tonclick=\"${this.onContinueProcessingHandler.bind(this)}\"\n\t\t\t\t>${Loc.getMessage('SALE_BLOCKS_SUCCESS_CHECKOUT')}</button>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonContinueProcessingHandler(event: Event)\n\t{\n\t\t// todo setField()\n\t\tlet url = this.getForm().parameters['paySystemReturnUrl'];\n\t\t//todo\n\t\turl = this.addLinkParam(url, 'orderId', this.getForm().getSchemeField('orderId'));\n\t\turl = this.addLinkParam(url, 'access', this.getForm().getSchemeField('hash'));\n\t\tthis.getForm().parameters['paySystemReturnUrl'] = url;\n\n\t\t// todo refresh layout with paysystems\n\t\tthis.getForm().refreshLayout();\n\n\t\t// todo\n\t\tdelete BX.UserConsent;\n\n\t\tthis.pushState({\n\t\t\torderId: this.getForm().getSchemeField('orderId'),\n\t\t\taccess:  this.getForm().getSchemeField('hash')\n\t\t});\n\t}\n\n\tgetCurrentUrl()\n\t{\n\t\treturn window.location.protocol + \"//\" + window.location.hostname + (window.location.port != '' ? ':' + window.location.port : '') +\n\t\t\twindow.location.pathname + window.location.search;\n\t}\n\n\taddLinkParam(link, name, value)\n\t{\n\t\tif(!link.length)\n\t\t{\n\t\t\treturn '?' + name + '=' + value;\n\t\t}\n\t\tlink = BX.Uri.removeParam(link, name);\n\t\tif(link.indexOf('?') != -1)\n\t\t{\n\t\t\treturn link + '&' + name + '=' + value;\n\t\t}\n\t\treturn link + '?' + name + '=' + value;\n\t}\n\n\tpushState(params)\n\t{\n\t\tlet url = '';\n\t\turl = this.getCurrentUrl();\n\t\turl = this.addLinkParam(url, 'orderId', params.orderId);\n\t\turl = this.addLinkParam(url, 'access', params.access);\n\n\t\twindow.history.pushState(null, null, url);\n\t}\n\n\tshowContinueShopping()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"checkout-order-status-btn-container\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"btn btn-checkout-order-status btn-md rounded-pill\"\n\t\t\t\t\tonclick=\"${this.onContinueShoppingHandler.bind(this)}\"\n\t\t\t\t>${Loc.getMessage('SALE_BLOCKS_SUCCESS_CONTINUE')}</button>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonContinueShoppingHandler(event: Event)\n\t{\n\t\tevent.target.disable = true;\n\n\t\tconst redirectPath = this.getForm().getParameter('emptyBasketHintPath');\n\t\tif (Type.isStringFilled(redirectPath))\n\t\t{\n\t\t\tdocument.location.href = redirectPath;\n\t\t}\n\t}\n\n\tisContinueProcessingEnabled()\n\t{\n\t\treturn this.getForm().getParameter('showContinueProcessing', false);\n\t}\n\n\tisPaymentSelected()\n\t{\n\t\treturn this.getForm().getField('paySystemId', 0) > 0;\n\t}\n\n\thasPaySystems()\n\t{\n\t\treturn this.getForm().getSchemeField('paySystems', []).length > 0;\n\t}\n\n\tshowBeforePayment()\n\t{\n\t\tif (!this.isContinueProcessingEnabled || this.isPaymentSelected())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tif(this.hasPaySystems())\n\t\t{\n\t\t\treturn [\n\t\t\t\tthis.showOrderStatus(),\n\t\t\t\tthis.showManagerWillCall(),\n\t\t\t\tthis.showSeparator(),\n\t\t\t\tthis.showContinueProcessing()\n\t\t\t];\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn [\n\t\t\t\tthis.showOrderStatus(),\n\t\t\t\tthis.showManagerWillCall(),\n\t\t\t];\n\t\t}\n\n\n\t}\n\n\tshowAfterPayment()\n\t{\n\t\tif (!this.isPaymentSelected())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn [\n\t\t\tthis.showPaymentStatus(),\n\t\t\tthis.showPaymentSum(),\n\t\t\tthis.showContinueShopping()\n\t\t];\n\t}\n}","import {Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Basket} from './basket';\nimport Form from '../form/form';\nimport {Total} from './total';\nimport {Loader} from './loader';\nimport {Payments} from './payments';\nimport {PlaceOrder} from './place-order';\nimport {Properties} from './properties';\nimport {Success} from './success';\n\nexport class BlockType\n{\n\tstatic BASKET = 'basket';\n\tstatic LOADER = 'loader';\n\tstatic PAYMENTS = 'payments';\n\tstatic PLACE_ORDER = 'place-order';\n\tstatic PROPERTIES = 'properties';\n\tstatic SUCCESS = 'success';\n\tstatic TOTAL = 'total';\n}\n\nconst blocks = [\n\t{\n\t\ttype: BlockType.BASKET,\n\t\tentity: Basket\n\t},\n\t{\n\t\ttype: BlockType.LOADER,\n\t\tentity: Loader\n\t},\n\t{\n\t\ttype: BlockType.PAYMENTS,\n\t\tentity: Payments\n\t},\n\t{\n\t\ttype: BlockType.PLACE_ORDER,\n\t\tentity: PlaceOrder\n\t},\n\t{\n\t\ttype: BlockType.PROPERTIES,\n\t\tentity: Properties\n\t},\n\t{\n\t\ttype: BlockType.SUCCESS,\n\t\tentity: Success\n\t},\n\t{\n\t\ttype: BlockType.TOTAL,\n\t\tentity: Total\n\t}\n];\n\nexport default class Factory extends EventEmitter\n{\n\tstatic create(type: string, form: Form, options = {})\n\t{\n\t\tthis.emit('BX.Sale.Checkout.Factory:onBeforeCreateBlock', blocks);\n\n\t\tlet entity = blocks.find((item) => {\n\t\t\treturn item.type === type;\n\t\t})['entity'];\n\n\t\tif (!entity)\n\t\t{\n\t\t\tconst eventData = {};\n\t\t\tthis.emit('BX.Sale.Checkout.Factory:onCreate', eventData);\n\t\t\tif (eventData[type])\n\t\t\t{\n\t\t\t\tentity = eventData[type];\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isFunction(entity))\n\t\t{\n\t\t\treturn new entity(form, options);\n\t\t}\n\n\t\treturn null;\n\t}\n}","export default class Scheme\n{\n\tfields: Map<string, mixed> = null;\n\n\tconstructor(fields: Object<string, mixed>)\n\t{\n\t\tthis.initFields(fields);\n\t}\n\n\tinitFields(fields: Object<string, mixed>): void\n\t{\n\t\tthis.fields = new Map(Object.entries(fields));\n\t}\n\n\thasField(name: string): boolean\n\t{\n\t\treturn this.fields.has(name);\n\t}\n\n\tgetFields(): Object\n\t{\n\t\tconst fields = {};\n\n\t\tfor (let [k, v] of this.fields)\n\t\t{\n\t\t\tfields[k] = v;\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\tgetField(name: string, defaultValue: ?mixed = null): mixed\n\t{\n\t\treturn this.fields.has(name) ? this.fields.get(name) : defaultValue;\n\t}\n}","import {ajax, Dom, Event, Type} from 'main.core';\nimport type {BaseBlock, BlockSetting} from '../blocks/base-block';\nimport BlockFactory, {BlockType} from '../blocks/factory';\nimport {EventEmitter} from 'main.core.events';\nimport Scheme from './scheme';\n\ntype FormParameters = {\n\tblocks: { type: string, options: mixed }[],\n};\n\nexport class Stage\n{\n\tstatic INITIAL: number = 1;\n\tstatic VIEW: number = 2;\n}\n\nexport default class Form extends EventEmitter\n{\n\tmodel: Model = null;\n\tscheme: Scheme = null;\n\tparameters: FormParameters = null;\n\n\tstage: number = null;\n\tcontainer: HTMLElement = null;\n\tblocks: BaseBlock[] = null;\n\n\tconstructor(model: Model, scheme: Scheme, parameters: FormParameters = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Sale.CheckoutForm');\n\n\t\tthis.model = model;\n\t\tthis.scheme = scheme;\n\t\tthis.parameters = parameters;\n\t}\n\n\tsetStage(stage: number)\n\t{\n\t\tthis.stage = stage;\n\t\treturn this;\n\t}\n\n\tsetModel(fields: Object): void\n\t{\n\t\tthis.model.initFields(fields);\n\t}\n\n\t// todo model and fields\n\thasField(name: string): boolean\n\t{\n\t\treturn this.model.hasField(name);\n\t}\n\n\tgetField(name: string, defaultValue: mixed): mixed\n\t{\n\t\treturn this.model.getField(name, defaultValue);\n\t}\n\n\tsetField(name: string, value: mixed): boolean\n\t{\n\t\tconst isChanged = this.setFieldNoDemand(name, value);\n\n\t\tif (isChanged)\n\t\t{\n\t\t\tthis.requestRefresh();\n\t\t}\n\n\t\treturn isChanged;\n\t}\n\n\tsetFieldNoDemand(name: string, value: mixed): boolean\n\t{\n\t\treturn this.model.setField(name, value);\n\t}\n\n\tsetScheme(fields: Object): void\n\t{\n\t\tfor (let name in fields)\n\t\t{\n\t\t\tif (fields.hasOwnProperty(name))\n\t\t\t{\n\t\t\t\tthis.scheme.fields.set(name, fields[name]);\n\t\t\t}\n\t\t}\n\t\t// todo init when all fields come from api request\n\t\t// this.scheme.initFields(fields);\n\t}\n\n\tgetSchemeField(name: string, defaultValue: mixed)\n\t{\n\t\treturn this.scheme.getField(name, defaultValue);\n\t}\n\n\tgetParameter(name: string, defaultValue = null)\n\t{\n\t\treturn this.parameters[name] || defaultValue;\n\t}\n\n\tgetStage(): number\n\t{\n\t\treturn this.stage;\n\t}\n\n\tgetContainer(): ?HTMLElement\n\t{\n\t\treturn this.container;\n\t}\n\n\tsetContainer(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Wrong target node to render');\n\t\t}\n\n\t\tconst oldContainer = this.getContainer();\n\t\tif (Type.isDomNode(oldContainer))\n\t\t{\n\t\t\tthis.clearContainer(oldContainer);\n\t\t}\n\n\t\tthis.container = container;\n\t}\n\n\tclearContainer(container: HTMLElement)\n\t{\n\t\tEvent.unbindAll(container);\n\t\tDom.clean(container);\n\t}\n\n\tbuildBlocks(): BaseBlock[]\n\t{\n\t\tlet blocks = [];\n\n\t\tthis.getParameter('blocks', []).forEach((setting: BlockSetting) => {\n\t\t\tblocks.push(BlockFactory.create(setting.type, this, setting));\n\t\t});\n\n\t\treturn blocks;\n\t}\n\n\tgetBlocks(): BaseBlock[]\n\t{\n\t\tif (this.blocks === null)\n\t\t{\n\t\t\tthis.blocks = this.buildBlocks();\n\t\t}\n\n\t\treturn this.blocks;\n\t}\n\n\trefreshLayout(): void\n\t{\n\t\tthis.getBlocks().forEach((block) => {\n\t\t\tblock.refreshLayout();\n\t\t});\n\t}\n\n\trenderTo(target: string | HTMLElement): void\n\t{\n\t\tif (Type.isString(target))\n\t\t{\n\t\t\ttarget = document.getElementById(target);\n\t\t}\n\n\t\tthis.setContainer(target);\n\t\tthis.refreshLayout();\n\t}\n\n\tlayoutSuccessBlock(): void\n\t{\n\t\tconst finalBlock = this.getBlocks().find((block) => {\n\t\t\treturn block.isSuccess();\n\t\t});\n\n\t\tif (finalBlock)\n\t\t{\n\t\t\tfinalBlock.refreshLayout(true);\n\t\t}\n\t}\n\n\trequestRefresh()\n\t{\n\t\tajax.runAction(\n\t\t\t'sale.entity.refreshorder',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tfields: this.prepareFields()\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then(this.handleRefreshResponse.bind(this))\n\t\t;\n\t}\n\n\thandleRefreshResponse(response): void\n\t{\n\t\tif (response.status === 'success')\n\t\t{\n\t\t\tconst modelFields = this.extractModelFields(response.data);\n\t\t\tthis.setModel(modelFields);\n\n\t\t\tconst schemeFields = this.extractSchemeFields(response.data);\n\t\t\tthis.setModel(schemeFields);\n\n\t\t\tthis.refreshLayout();\n\t\t}\n\t}\n\n\tgetPropertyErrorCollection():Array\n\t{\n\t\tlet collection = this.getField('ERROR_COLLECTION', {});\n\t\treturn collection.hasOwnProperty('PROPERTIES') && Type.isArrayFilled(collection.PROPERTIES)\n\t\t\t? collection.PROPERTIES:[];\n\t}\n\n\tverify()\n\t{\n\t\treturn this.verifyProperty();\n\t}\n\n\tverifyProperty()\n\t{\n\t\tlet list = [];\n\t\tlet properties = this.getField('properties');\n\n\t\tthis.getSchemeField('properties', []).forEach((item) => {\n\t\t\tif (item.type === 'STRING' && item.required === 'Y')\n\t\t\t{\n\t\t\t\t//console.log('properties', properties[item.ID]);\n\t\t\t\tif(Type.isStringFilled(properties[item.id]) === false)\n\t\t\t\t{\n\t\t\t\t\tlist.push({\n\t\t\t\t\t\tid: item.id,\n\t\t\t\t\t\tmessage: ''\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.setFieldNoDemand('ERROR_COLLECTION', {PROPERTIES: list});\n\n\t\treturn Type.isArrayFilled(list) === false;\n\t}\n\n\trequestSave()\n\t{\n\t\tif(this.verify())\n\t\t{\n\t\t\tajax.runAction(\n\t\t\t\t'sale.entity.saveorder',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfields: this.prepareFields()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then(\n\t\t\t\t\tthis.handleSaveResponse.bind(this),\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tif(response.status === 'error')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.fillErrorCollection(response.errors);\n\n\t\t\t\t\t\t\tthis.getPropertyErrorCollection().forEach((error)=>{\n\n\t\t\t\t\t\t\t\tBX.onCustomEvent(\"BX.Sale.Checkout.Property.Error:onSave_\" + error.id);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getPropertyErrorCollection().forEach((error)=>{\n\t\t\t\tBX.onCustomEvent(\"BX.Sale.Checkout.Property.Error:onSave_\" + error.id);\n\t\t\t});\n\t\t}\n\t}\n\n\thandleSaveResponse(response): void\n\t{\n\t\tif (response.status === 'success')\n\t\t{\n\t\t\tconst modelFields = this.extractModelFields(response.data);\n\t\t\tthis.setModel(modelFields);\n\n\t\t\tconst schemeFields = this.extractSchemeFields(response.data);\n\t\t\tthis.setScheme(schemeFields);\n\n\t\t\tthis.layoutSuccessBlock();\n\t\t\tthis.stage++;\n\t\t}\n\t}\n\n\tfillErrorCollection(errors)\n\t{\n\t\tlet list = [];\n\t\tif(Type.isArrayFilled(errors))\n\t\t{\n\t\t\terrors.forEach((error) => {\n\t\t\t\tif(error.code === 'properties')\n\t\t\t\t{\n\t\t\t\t\tlist.push({\n\t\t\t\t\t\tid: error.customData.id,\n\t\t\t\t\t\tmessage: error.customData.message\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.setFieldNoDemand('ERROR_COLLECTION', {PROPERTIES: list});\n\t\t}\n\t}\n\n\tprepareFields(): Object\n\t{\n\t\tconst fields = {\n\t\t\t'siteId': this.getSchemeField('siteId'),\n\t\t\t'products': this.getField('basketItems'),\n\t\t\t'properties': this.getField('properties')\n\t\t};\n\n\t\tconst userId = this.getSchemeField('userId');\n\t\tif (userId)\n\t\t{\n\t\t\tfields['userId'] = userId;\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\textractModelFields(data: Object): Object\n\t{\n\t\tconst basketItems = {};\n\t\tdata.basketItems.forEach((item) => {\n\t\t\tbasketItems[item.id] = {\n\t\t\t\tproductId: item.productId,\n\t\t\t\tquantity: item.quantity,\n\t\t\t\tprops: item.props\n\t\t\t};\n\t\t});\n\n\t\tconst properties = {};\n\t\tdata.properties.forEach((item) => {\n\t\t\tproperties[item.orderPropsId] = item.value;\n\t\t});\n\n\t\tconst payments = {};\n\t\tdata.payments.forEach((item) => {\n\t\t\tpayments[item.id] = {\n\t\t\t\tid: item.id,\n\t\t\t\tsum: item.sum\n\t\t\t};\n\t\t});\n\n\t\treturn {\n\t\t\tbasketItems: basketItems,\n\t\t\tproperties: properties,\n\t\t\tpayments: payments\n\t\t};\n\t}\n\n\textractSchemeFields(data: Object): Object\n\t{\n\t\treturn {\n\t\t\tsiteId: data.lid,\n\t\t\tuserId: data.userId,\n\t\t\taccountNumber: data.accountNumber,\n\t\t\torderId: data.id,\n\t\t\tpaySystems: data.paySystems,\n\t\t\t//SIGNED_PARAMETERS: data.SIGNED_PARAMETERS,\n\t\t\thash: data.hash\n\t\t\t// ToDo TOTAL, BASKET_ITEMS, PROPERTIES\n\t\t};\n\t}\n}","import {Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Form from './form';\nimport Model from './model';\nimport Scheme from './scheme';\n\nexport class EntityType\n{\n\tstatic FORM = 'form';\n\tstatic MODEL = 'model';\n\tstatic SCHEME = 'scheme';\n}\n\nconst entities = [\n\t{\n\t\ttype: EntityType.FORM,\n\t\tentity: Form\n\t},\n\t{\n\t\ttype: EntityType.MODEL,\n\t\tentity: Model\n\t},\n\t{\n\t\ttype: EntityType.SCHEME,\n\t\tentity: Scheme\n\t}\n];\n\nexport default class Factory extends EventEmitter\n{\n\tstatic createForm(model: Object, scheme: Object, parameters: Object)\n\t{\n\t\tconst modelEntity = this.create(EntityType.MODEL, model);\n\t\tconst schemeEntity = this.create(EntityType.SCHEME, scheme);\n\n\t\treturn this.create(EntityType.FORM, modelEntity, schemeEntity, parameters);\n\t}\n\n\tstatic create(type: string, ...options)\n\t{\n\t\tthis.emit('BX.Sale.Checkout.Factory:onBeforeCreate', entities);\n\n\t\tlet entity = entities.find((item) => {\n\t\t\treturn item.type === type;\n\t\t})['entity'];\n\n\t\tif (!entity)\n\t\t{\n\t\t\tconst eventData = {};\n\t\t\tthis.emit('BX.Sale.Checkout.Factory:onCreate', eventData);\n\t\t\tif (eventData[type])\n\t\t\t{\n\t\t\t\tentity = eventData[type];\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isFunction(entity))\n\t\t{\n\t\t\treturn new entity(...options);\n\t\t}\n\n\t\treturn null;\n\t}\n}"],"names":["Model","fields","initFields","Map","Object","entries","originalFields","name","has","k","v","defaultValue","get","value","set","getOriginalField","BaseBlock","form","settings","Cache","MemoryCache","EDIT_MODE","setEventNamespace","getForm","getModel","cache","getCache","remember","wrapper","hasSetting","document","getElementById","getSetting","Type","isDomNode","Error","Tag","render","getContainer","appendChild","mode","Stage","INITIAL","BlockType","SUCCESS","forceLayout","formStage","getStage","blockStage","isPlainObject","viewStage","view","editStage","edit","hideStage","hide","currentStage","undefined","VIEW_MODE","isNumber","clearLayout","setMode","layout","getWrapper","Event","unbindAll","Dom","clean","remove","delete","EventEmitter","Basket","options","deleteItemHandler","bind","event","div","target","itemId","getAttribute","ajax","runAction","data","id","then","response","redirectPath","getParameter","isStringFilled","location","href","create","attrs","className","children","getProducts","getTotalNode","getSchemeField","getBasketItems","length","itemNodes","forEach","item","discountNode","getItemDiscountNode","propsNode","getItemPropsNode","imageSrc","catalogProduct","frontImage","src","itemNode","Text","encode","quantity","measureText","sum","push","getFirstRowFromTable","sumDiscountDiff","sumBaseFormated","sumDiscountDiffFormated","props","propsItems","propsItemsDom","i","domRender","total","getTotalData","getTotalDiscountNode","subTotalNode","Loc","getMessage","orderPriceFormated","basketPriceDiscountDiffValue","priceWithoutDiscount","basketPriceDiscountDiff","table","rows","Total","getBasketTotalNode","getDiscountNode","getShippingNode","getTaxesNode","getSummaryNode","discountPrice","discountPriceFormated","orderTotalPriceFormated","Loader","Payments","access","paySystemReturnUrl","payments","getField","paymentId","keys","accessCode","returnUrl","getPaySystemsList","BX","type","isNotEmptyString","html","addCustomEvent","refreshLayout","paySystemNodes","getPaySystems","logotipSrc","description","handleCheckoutClick","paySystemId","toNumber","setFieldNoDemand","setAttribute","addClass","innerHTML","ID","PlaceOrder","saveOrderHandler","saveOrder","properties","userConsent","title","isLoaded","autoSave","isChecked","submitEventName","isArrayFilled","JSON","stringify","isAllowedSubmitting","getConsent","getSaveButton","consent","UserConsent","control","load","events","accepted","refused","onCustomEvent","disabled","requestSave","Properties","getMode","getViewLayout","getEditLayout","propertyValues","propertyId","hasOwnProperty","join","orderNumber","propertiesInfo","getPropertiesShort","replace","getProperties","isPhone","propertyNode","onChangeHandler","onFocusOutHandler","removeClass","input","Success","showBeforePayment","showAfterPayment","body","onContinueProcessingHandler","url","parameters","addLinkParam","pushState","orderId","window","protocol","hostname","port","pathname","search","link","Uri","removeParam","indexOf","params","getCurrentUrl","history","onContinueShoppingHandler","disable","isContinueProcessingEnabled","isPaymentSelected","hasPaySystems","showOrderStatus","showManagerWillCall","showSeparator","showContinueProcessing","showPaymentStatus","showPaymentSum","showContinueShopping","blocks","BASKET","entity","LOADER","PAYMENTS","PLACE_ORDER","PROPERTIES","TOTAL","Factory","emit","find","eventData","isFunction","Scheme","Form","model","scheme","stage","hasField","isChanged","requestRefresh","setField","container","oldContainer","clearContainer","setting","BlockFactory","buildBlocks","getBlocks","block","isString","setContainer","finalBlock","isSuccess","prepareFields","handleRefreshResponse","status","modelFields","extractModelFields","setModel","schemeFields","extractSchemeFields","collection","verifyProperty","list","required","message","verify","handleSaveResponse","fillErrorCollection","errors","getPropertyErrorCollection","error","setScheme","layoutSuccessBlock","code","customData","userId","basketItems","productId","orderPropsId","siteId","lid","accountNumber","paySystems","hash","EntityType","entities","FORM","MODEL","SCHEME","modelEntity","schemeEntity"],"mappings":"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"}