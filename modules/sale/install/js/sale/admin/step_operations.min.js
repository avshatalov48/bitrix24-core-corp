BX.namespace("BX.Sale.Admin.StepOperations");BX.Sale.Admin.StepOperations.StepOperationsFilter=function(){var t=function(e){this.useFilter=false;this.filter=[];this.filterFields=[];this.filterValues={};if(!!e.filter&&BX.type.isArray(e.filter))this.filterFields=e.filter;this.useFilter=this.filterFields.length>0;this.emptyOrders=null;t.superclass.constructor.apply(this,arguments)};BX.extend(t,BX.Catalog.StepOperations);t.prototype.init=function(){var e,i;t.superclass.init.apply(this,arguments);if(this.errorCode===0&&this.useFilter){for(e=0;e<this.filterFields.length;e++){i=BX(this.filterFields[e]);if(!!i)this.filter[this.filter.length]=i}this.useFilter=this.filter.length>0;if(this.useFilter){for(e=0;e<this.filter.length;e++){switch(this.filter[e].type.toLowerCase()){case"text":case"select-one":BX.bind(this.filter[e],"change",BX.proxy(this.getFilterCounter,this));break}}}this.getFilterCounter();if(BX.type.isNotEmptyString(this.visual.emptyOrdersId))this.emptyOrders=BX(this.visual.emptyOrdersId)}};t.prototype.nextStep=function(){if(this.useFilter){this.getFilterValues();this.ajaxParams.filter=this.filterValues}t.superclass.nextStep.apply(this,arguments)};t.prototype.finishOperation=function(){t.superclass.finishOperation.apply(this,arguments);BX.ajax.get(this.url,{sessid:BX.bitrix_sessid(),clearTags:"Y"})};t.prototype.getFilterCounter=function(){var t={sessid:BX.bitrix_sessid(),lang:BX.message("LANGUAGE_ID"),getCount:"Y"};if(this.useFilter){this.getFilterValues();t.filter=this.filterValues;BX.showWait();this.disableFilterFields();BX.ajax.loadJSON(this.url,t,BX.proxy(this.getFilterCounterResult,this))}};t.prototype.getFilterCounterResult=function(t){BX.closeWait();this.enableFilterFields();if(typeof t==="object"){this.currentState.allCounter=parseInt(t.counter,10);if(isNaN(this.currentState.allCounter))this.currentState.allCounter=0;this.buttons.start.disabled=this.currentState.allCounter<=0;if(BX.type.isElementNode(this.emptyOrders))BX.style(this.emptyOrders,"display",this.currentState.allCounter<=0?"block":"none")}};t.prototype.getFilterValues=function(){var t;if(!this.useFilter)return;this.filterValues={};for(t=0;t<this.filter.length;t++){switch(this.filter[t].type.toLowerCase()){case"text":case"select-one":this.filterValues[this.filter[t].name]=this.filter[t].value;break;default:break}}};t.prototype.enableFilterFields=function(){if(!this.useFilter)return;var t;for(t=0;t<this.filter.length;t++)this.filter[t].disabled=false};t.prototype.disableFilterFields=function(){if(!this.useFilter)return;var t;for(t=0;t<this.filter.length;t++)this.filter[t].disabled=false};return t}();
//# sourceMappingURL=step_operations.map.js