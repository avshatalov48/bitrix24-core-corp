BX.namespace("BX.Sale.PersonalProfileComponent");(function(){BX.Sale.PersonalProfileComponent.PersonalProfileDetail={init:function(e){if(BX.type.isPlainObject(e))this.ajaxUrl=e.ajaxUrl;var t=document.getElementsByClassName("sale-personal-profile-detail-property-file");Array.prototype.forEach.call(t,function(e){var t=e.getElementsByClassName("profile-property-input-delete-file")[0];var a=e.getElementsByClassName("sale-personal-profile-detail-input-file")[0];var i=e.getElementsByClassName("sale-personal-profile-detail-load-file-info")[0];var r=e.getElementsByClassName("sale-personal-profile-detail-load-file-cancel")[0];BX.bindDelegate(e,"click",{class:"profile-property-check-file"},BX.proxy(function(e){if(t.value!=""){idList=t.value.split(";");if(idList.indexOf(e.target.value)===-1){t.value=t.value+";"+e.target.value}else{idList.splice(idList.indexOf(e.target.value),1);t.value=idList.join(";")}}else{t.value=e.target.value}},this));BX.bind(a,"change",BX.delegate(function(e){if(e.target.files.length>1){i.innerHTML=BX.message("SPPD_FILE_COUNT")+e.target.files.length;r.classList.remove("sale-personal-profile-hide")}else if(e.target.files.length==1){fileName=e.target.files[0].name;if(fileName.length>40){i.innerHTML=fileName.substr(0,9)+"..."+fileName.substr(-9)}else{i.innerHTML=e.target.files[0].name}r.classList.remove("sale-personal-profile-hide")}else{r.classList.add("sale-personal-profile-hide");i.innerHTML=BX.message("SPPD_FILE_NOT_SELECTED")}},this));var l=document.querySelectorAll(".sale-personal-profile-detail-form-date");for(var s=0;s<l.length;s++){BX.bind(l[s],"click",BX.delegate(function(e){parentBlock=e.target.parentNode;if(e.target.classList.contains("bx-calendar")){parentBlock=parentBlock.parentNode}var t=parentBlock.querySelector("input");if(!BX.type.isDomNode(t)){return}BX.calendar({node:t,field:t.name,form:"",bTime:false,bHideTime:true})},this))}BX.bind(r,"click",BX.delegate(function(){r.classList.add("sale-personal-profile-hide");i.innerHTML=BX.message("SPPD_FILE_NOT_SELECTED");a.value="";a.files=[]},this))});var a=document.getElementsByClassName("input-add-multiple");for(var i in a){var r=a[i];if(!BX.type.isDomNode(r)&&BX.type.isNotEmptyString(this.ajaxUrl))continue;BX.bind(r,"click",BX.delegate(function(e){switch(e.target.getAttribute("data-add-type")){case"LOCATION":this.createLocationInput(e);break;case"TEXT":this.createTextInput(e);break}},this))}},createTextInput:function(e){if(!BX.type.isDomNode(e.target))return;var t=BX.create("input",{attrs:{className:"form-control",type:"text",name:e.target.getAttribute("data-add-name")}});e.target.parentNode.insertBefore(t,e.target)},createLocationInput:function(e){var t=parseInt(e.target.getAttribute("data-add-last-key"))+1;BX.ajax({method:"POST",dataType:"html",url:this.ajaxUrl,data:{sessid:BX.bitrix_sessid(),params:{LOCATION_NAME:e.target.getAttribute("data-add-name"),LOCATION_TEMPLATE:e.target.getAttribute("data-add-template"),LOCATION_KEY:t,ACTION:"getLocationHtml"},signedParamsString:this.signedParams},onsuccess:BX.proxy(function(a){var i=BX.create("div");i.innerHTML=a;e.target.parentNode.insertBefore(i,e.target);e.target.setAttribute("data-add-last-key",t)},this),onfailure:BX.proxy(function(){return this},this)},this)}}})();
//# sourceMappingURL=script.map.js