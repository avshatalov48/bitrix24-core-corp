{"version":3,"file":"client_selector.bundle.js","sources":["../src/client_selector.js"],"sourcesContent":["import { Dom, Event, Loc, Tag, Type } from \"main.core\";\nimport { Loader } from \"main.loader\";\nimport \"ui.design-tokens\";\nimport \"./client_selector.css\";\n\nexport class ClientSelector\n{\n\tconstructor(container, params)\n\t{\n\t\tthis.container = container;\n\t\tthis.canAddItems = !!params.canAddItems;\n\t\tthis.canUnSelectItem = !!params.canUnSelectItem;\n\t\tthis.onNewItemCallback = params.events && Type.isFunction(params.events.onNewItem) ? params.events.onNewItem : null;\n\t\tthis.onSelectItemCallback = params.events && Type.isFunction(params.events.onSelectItem) ? params.events.onSelectItem : null;\n\t\tthis.onUnSelectItemCallback = params.events && Type.isFunction(params.events.onUnSelectItem) ? params.events.onUnSelectItem : null;\n\t\tthis.onRemoveItemCallback = params.events && Type.isFunction(params.events.onRemoveItem) ? params.events.onRemoveItem : null;\n\t\tthis.init();\n\t\tthis.setSelected(params.selected);\n\t\tthis.setItems(params.items ? params.items : {});\n\t\tthis.enabled = true;\n\t\tthis.loader = new Loader({size: 20});\n\t}\n\n\tsetSelected(item)\n\t{\n\t\tthis.selected = item;\n\t\tthis.closeMenu();\n\t\tthis.updateClientHtml();\n\t}\n\tsetItems(items)\n\t{\n\t\tthis.closeMenu();\n\t\tthis.items = items;\n\t}\n\n\tinit()\n\t{\n\t\tDom.append(this.getHtml(), this.container);\n\t\tthis.updateClientHtml();\n\t\tEvent.bind(this.container, 'click', this.onContainerClick.bind(this));\n\t}\n\n\tenable()\n\t{\n\t\tthis.enabled = true;\n\t\tlet selector = this.getSelectorNode();\n\t\tselector ? selector.classList.remove('seo-ads-client-selector-loading') : false;\n\t\tthis.loader.hide();\n\t}\n\n\tdisable()\n\t{\n\t\tthis.enabled = false;\n\t\tlet selector = this.getSelectorNode();\n\t\tselector ? selector.classList.add('seo-ads-client-selector-loading') : false;\n\t\tthis.loader.hide();\n\t\tif (selector)\n\t\t{\n\t\t\tselector.classList.add('seo-ads-client-selector-loading');\n\t\t\tlet loader = selector.getElementsByClassName('seo-ads-client-selector-loader')[0];\n\t\t\tthis.loader.show(loader);\n\t\t}\n\t}\n\n\tgetHtml()\n\t{\n\t\treturn Tag.render`\n\t\t<div class=\"seo-ads-client\">\n\t\t\t<div class=\"seo-ads-client-selector\">\n\t\t\t\t<div class=\"seo-ads-client-selector-avatar\" data-role=\"user-avatar\"></div>\n\t\t\t\t<div class=\"seo-ads-client-selector-user\">\n\t\t\t\t\t<a target=\"_top\" data-role=\"user-name user-link\" class=\"seo-ads-client-selector-user-link\" title=\"\"></a>\n\t\t\t\t</div>\n\t\t\t\t<span class=\"seo-ads-client-selector-arrow\"></span>\n\t\t\t\t<span class=\"seo-ads-client-selector-loader\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"seo-ads-client-note\">\n\t\t\t${Loc.getMessage('SEO_ADS_CLIENT_NOTE')}\n\t\t\t</div>\n\t\t</div>\n\t\t`;\n\t}\n\n\tgetMenuItemHtml(item)\n\t{\n\t\tconst name = BX.util.htmlspecialchars(item.NAME);\n\t\tconst html =  Tag.render`<div>\n\t\t\t${item.PICTURE ? \n\t\t\t\tTag.render`<div class=\"seo-ads-client-menu-avatar\" style=\"background-image: url('${item.PICTURE}');\"></div>` :\n\t\t\t\tTag.render`<div class=\"seo-ads-client-menu-avatar\"></div>`}\n\t\t\t<span class=\"seo-ads-client-menu-popup-user\">${name}</span>\n\t\t\t<span class=\"seo-ads-client-menu-popup-shutoff\" data-role=\"client-remove\" data-client-id=\"${item.CLIENT_ID}\">${Loc.getMessage('SEO_ADS_CLIENT_DISCONNECT')}</span>\n\t\t</div>`;\n\t\treturn html.innerHTML;\n\t}\n\n\tgetRemoveConfirmPopupHtml(item)\n\t{\n\t\tconst name = BX.util.htmlspecialchars(item.NAME);\n\t\treturn Tag.render`<div class=\"seo-ads-client-popup\">\n\t\t\t<div class=\"seo-ads-client-popup-text\">\n\t\t\t${Loc.getMessage('SEO_ADS_CLIENT_REMOVE').replace('#NAME#', name)}\n\t\t\t</div>\n\t\t</div>`;\n\t}\n\n\tupdateClientHtml()\n\t{\n\t\tlet userAvatar = '';\n\t\tlet userName = '';\n\t\tlet userLink = '';\n\t\tlet empty = false;\n\t\tif (this.selected)\n\t\t{\n\t\t\tuserAvatar = this.selected.hasOwnProperty('PICTURE') ? this.selected.PICTURE : '';\n\t\t\tuserName = this.selected.hasOwnProperty('NAME') ? this.selected.NAME : Loc.getMessage('SEO_ADS_CLIENT_SELECTOR_UNTITLED');\n\t\t\tuserLink = this.selected.hasOwnProperty('LINK') ? this.selected.LINK : '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tuserName = Loc.getMessage('SEO_ADS_CLIENT_SELECTOR_EMPTY')\n\t\t\tempty = true;\n\t\t}\n\t\tlet selector = this.getSelectorNode();\n\n\t\tif (empty)\n\t\t{\n\t\t\tselector ? selector.classList.add('seo-ads-client-selector-empty') : false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselector ? selector.classList.remove('seo-ads-client-selector-empty') : false;\n\t\t}\n\t\tlet avatarNode = this.container.querySelector('[data-role=\"user-avatar\"]');\n\t\tlet nameNode = this.container.querySelector('[data-role*=\"user-name\"]');\n\t\tlet linkNode = this.container.querySelector('[data-role*=\"user-link\"]');\n\n\t\tif (userAvatar)\n\t\t\tavatarNode.style.backgroundImage = \"url('\"+userAvatar+\"')\";\n\t\telse\n\t\t\tavatarNode.style.removeProperty('background-image');\n\n\t\tnameNode.textContent = userName;\n\n\t\tif (userLink)\n\t\t\tlinkNode.setAttribute('href', userLink);\n\t\telse\n\t\t\tlinkNode.removeAttribute('href');\n\t}\n\n\tonSelectItem(item)\n\t{\n\t\tthis.setSelected(item);\n\t\tif (Type.isFunction(this.onSelectItemCallback))\n\t\t\tthis.onSelectItemCallback(item);\n\t}\n\n\tonUnSelectItem()\n\t{\n\t\tthis.setSelected(null);\n\t\tif (Type.isFunction(this.onUnSelectItemCallback))\n\t\t{\n\t\t\tthis.onUnSelectItemCallback();\n\t\t}\n\t}\n\n\tonRemoveItem(item)\n\t{\n\t\tif (Type.isFunction(this.onRemoveItemCallback))\n\t\t\tthis.onRemoveItemCallback(item);\n\t}\n\n\tonContainerClick()\n\t{\n\t\tif (!this.enabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menuItems = [];\n\n\t\tfor (let item of this.items)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\thtml: this.getMenuItemHtml(item),\n\t\t\t\tclassName : \"seo-ads-client-menu menu-popup-no-icon\",\n\t\t\t\tonclick: this.onSelectItem.bind(this, item)\n\t\t\t});\n\t\t}\n\n\t\tif (this.canUnSelectItem)\n\t\t{\n\t\t\tmenuItems.push(\n\t\t\t\t{delimiter: true},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('SEO_ADS_CLIENT_NO_ACCOUNT'),\n\t\t\t\t\tonclick: this.onUnSelectItem.bind(this)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif (this.canAddItems)\n\t\t{\n\t\t\tmenuItems.push(\n\t\t\t\t{delimiter: true},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('SEO_ADS_CLIENT_ADD'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\tif (Type.isFunction(this.onNewItemCallback))\n\t\t\t\t\t\t\tthis.onNewItemCallback();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t\tlet selector = this.getSelectorNode();\n\n\t\tBX.PopupMenu.show(\n\t\t\t\"clientsMenuDropdown\",\n\t\t\tthis.container,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 42,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tselector ? selector.classList.remove('seo-ads-client-selector-active') : false;\n\t\t\t\t\t\tBX.PopupMenu.destroy('clientsMenuDropdown');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tselector ? selector.classList.add('seo-ads-client-selector-active') : false;\n\n\t\tlet removeClientLinks = BX.PopupMenu.currentItem.popupWindow.getContentContainer().querySelectorAll('[data-role=\"client-remove\"]');\n\t\tfor (let removeClientLink of removeClientLinks) {\n\t\t\tEvent.bind(removeClientLink, \"click\", (event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tlet clientId = BX.data(event.target, \"client-id\");\n\t\t\t\tthis.closeMenu();\n\t\t\t\tfor (let item of this.items) {\n\t\t\t\t\tif (item.CLIENT_ID == clientId) {\n\t\t\t\t\t\tthis.confirmRemoveItem(item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tconfirmRemoveItem(item)\n\t{\n\t\tlet confirmPopup = new BX.PopupWindow({\n\t\t\tcontent: this.getRemoveConfirmPopupHtml(item),\n\t\t\tautoHide: true,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tcloseByEsc: true,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext : Loc.getMessage('SEO_ADS_CLIENT_DISCONNECT'),\n\t\t\t\t\tcolor: BX.UI.Button.Color.DANGER,\n\t\t\t\t\tonclick: (event) => {\n\t\t\t\t\t\tconfirmPopup.close();\n\t\t\t\t\t\tthis.onRemoveItem(item);\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext : Loc.getMessage('SEO_ADS_CLIENT_BTN_CANCEL'),\n\t\t\t\t\tcolor: BX.UI.Button.Color.LINK,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tconfirmPopup.close();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t\tconfirmPopup.show();\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif (BX.PopupMenu.currentItem) {\n\t\t\tBX.PopupMenu.currentItem.close();\n\t\t}\n\t}\n\n\tdestroy()\n\t{\n\t\tif (BX.PopupMenu.currentItem) {\n\t\t\tBX.PopupMenu.currentItem.close();\n\t\t}\n\t\tthis.container.innerHTML = '';\n\t}\n\n\tgetSelectorNode()\n\t{\n\t\tlet selector = this.container.getElementsByClassName('seo-ads-client-selector');\n\t\tif (selector)\n\t\t\tselector = selector[0];\n\n\t\treturn selector;\n\t}\n}"],"names":["ClientSelector","container","params","canAddItems","canUnSelectItem","onNewItemCallback","events","Type","isFunction","onNewItem","onSelectItemCallback","onSelectItem","onUnSelectItemCallback","onUnSelectItem","onRemoveItemCallback","onRemoveItem","init","setSelected","selected","setItems","items","enabled","loader","Loader","size","item","closeMenu","updateClientHtml","Dom","append","getHtml","Event","bind","onContainerClick","selector","getSelectorNode","classList","remove","hide","add","getElementsByClassName","show","Tag","render","Loc","getMessage","name","BX","util","htmlspecialchars","NAME","html","PICTURE","CLIENT_ID","innerHTML","replace","userAvatar","userName","userLink","empty","hasOwnProperty","LINK","avatarNode","querySelector","nameNode","linkNode","style","backgroundImage","removeProperty","textContent","setAttribute","removeAttribute","menuItems","push","getMenuItemHtml","className","onclick","delimiter","text","PopupMenu","offsetTop","offsetLeft","angle","onPopupClose","destroy","removeClientLinks","currentItem","popupWindow","getContentContainer","querySelectorAll","removeClientLink","event","stopPropagation","clientId","data","target","confirmRemoveItem","confirmPopup","PopupWindow","content","getRemoveConfirmPopupHtml","autoHide","cacheable","closeIcon","closeByEsc","buttons","UI","Button","color","Color","DANGER","close"],"mappings":"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"}