this.BX=this.BX||{};this.BX.Seo=this.BX.Seo||{};(function(e,t,n){"use strict";function s(){var e=babelHelpers.taggedTemplateLiteral(['<div class="seo-ads-client-popup">\n\t\t\t<div class="seo-ads-client-popup-text">\n\t\t\t',"\n\t\t\t</div>\n\t\t</div>"]);s=function t(){return e};return e}function a(){var e=babelHelpers.taggedTemplateLiteral(['<div class="seo-ads-client-menu-avatar"></div>']);a=function t(){return e};return e}function l(){var e=babelHelpers.taggedTemplateLiteral(['<div class="seo-ads-client-menu-avatar" style="background-image: url(\'',"');\"></div>"]);l=function t(){return e};return e}function i(){var e=babelHelpers.taggedTemplateLiteral(["<div>\n\t\t\t",'\n\t\t\t<span class="seo-ads-client-menu-popup-user">','</span>\n\t\t\t<span class="seo-ads-client-menu-popup-shutoff" data-role="client-remove" data-client-id="','">',"</span>\n\t\t</div>"]);i=function t(){return e};return e}function o(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t<div class="seo-ads-client">\n\t\t\t<div class="seo-ads-client-selector">\n\t\t\t\t<div class="seo-ads-client-selector-avatar" data-role="user-avatar"></div>\n\t\t\t\t<div class="seo-ads-client-selector-user">\n\t\t\t\t\t<a target="_top" data-role="user-name user-link" class="seo-ads-client-selector-user-link" title=""></a>\n\t\t\t\t</div>\n\t\t\t\t<span class="seo-ads-client-selector-arrow"></span>\n\t\t\t\t<span class="seo-ads-client-selector-loader"></span>\n\t\t\t</div>\n\t\t\t<div class="seo-ads-client-note">\n\t\t\t',"\n\t\t\t</div>\n\t\t</div>\n\t\t"]);o=function t(){return e};return e}var r=function(){function e(s,a){babelHelpers.classCallCheck(this,e);this.container=s;this.canAddItems=!!a.canAddItems;this.canUnSelectItem=!!a.canUnSelectItem;this.onNewItemCallback=a.events&&t.Type.isFunction(a.events.onNewItem)?a.events.onNewItem:null;this.onSelectItemCallback=a.events&&t.Type.isFunction(a.events.onSelectItem)?a.events.onSelectItem:null;this.onUnSelectItemCallback=a.events&&t.Type.isFunction(a.events.onUnSelectItem)?a.events.onUnSelectItem:null;this.onRemoveItemCallback=a.events&&t.Type.isFunction(a.events.onRemoveItem)?a.events.onRemoveItem:null;this.init();this.setSelected(a.selected);this.setItems(a.items?a.items:{});this.enabled=true;this.loader=new n.Loader({size:20})}babelHelpers.createClass(e,[{key:"setSelected",value:function e(t){this.selected=t;this.closeMenu();this.updateClientHtml()}},{key:"setItems",value:function e(t){this.closeMenu();this.items=t}},{key:"init",value:function e(){t.Dom.append(this.getHtml(),this.container);this.updateClientHtml();t.Event.bind(this.container,"click",this.onContainerClick.bind(this))}},{key:"enable",value:function e(){this.enabled=true;var t=this.getSelectorNode();t?t.classList.remove("seo-ads-client-selector-loading"):false;this.loader.hide()}},{key:"disable",value:function e(){this.enabled=false;var t=this.getSelectorNode();t?t.classList.add("seo-ads-client-selector-loading"):false;this.loader.hide();if(t){t.classList.add("seo-ads-client-selector-loading");var n=t.getElementsByClassName("seo-ads-client-selector-loader")[0];this.loader.show(n)}}},{key:"getHtml",value:function e(){return t.Tag.render(o(),t.Loc.getMessage("SEO_ADS_CLIENT_NOTE"))}},{key:"getMenuItemHtml",value:function e(n){var s=t.Tag.render(i(),n.PICTURE?t.Tag.render(l(),n.PICTURE):t.Tag.render(a()),n.NAME,n.CLIENT_ID,t.Loc.getMessage("SEO_ADS_CLIENT_DISCONNECT"));return s.innerHTML}},{key:"getRemoveConfirmPopupHtml",value:function e(n){return t.Tag.render(s(),t.Loc.getMessage("SEO_ADS_CLIENT_REMOVE").replace("#NAME#",n.NAME))}},{key:"updateClientHtml",value:function e(){var n="";var s="";var a="";var l=false;if(this.selected){n=this.selected.hasOwnProperty("PICTURE")?this.selected.PICTURE:"";s=this.selected.hasOwnProperty("NAME")?this.selected.NAME:t.Loc.getMessage("SEO_ADS_CLIENT_SELECTOR_UNTITLED");a=this.selected.hasOwnProperty("LINK")?this.selected.LINK:""}else{s=t.Loc.getMessage("SEO_ADS_CLIENT_SELECTOR_EMPTY");l=true}var i=this.getSelectorNode();if(l){i?i.classList.add("seo-ads-client-selector-empty"):false}else{i?i.classList.remove("seo-ads-client-selector-empty"):false}var o=this.container.querySelector('[data-role="user-avatar"]');var r=this.container.querySelector('[data-role*="user-name"]');var c=this.container.querySelector('[data-role*="user-link"]');if(n)o.style.backgroundImage="url('"+n+"')";else o.style.removeProperty("background-image");r.textContent=s;if(a)c.setAttribute("href",a);else c.removeAttribute("href")}},{key:"onSelectItem",value:function e(n){this.setSelected(n);if(t.Type.isFunction(this.onSelectItemCallback))this.onSelectItemCallback(n)}},{key:"onUnSelectItem",value:function e(){this.setSelected(null);if(t.Type.isFunction(this.onUnSelectItemCallback)){this.onUnSelectItemCallback()}}},{key:"onRemoveItem",value:function e(n){if(t.Type.isFunction(this.onRemoveItemCallback))this.onRemoveItemCallback(n)}},{key:"onContainerClick",value:function e(){var n=this;if(!this.enabled){return}var s=[];var a=true;var l=false;var i=undefined;try{for(var o=this.items[Symbol.iterator](),r;!(a=(r=o.next()).done);a=true){var c=r.value;s.push({text:this.getMenuItemHtml(c),className:"seo-ads-client-menu menu-popup-no-icon",onclick:this.onSelectItem.bind(this,c)})}}catch(e){l=true;i=e}finally{try{if(!a&&o.return!=null){o.return()}}finally{if(l){throw i}}}if(this.canUnSelectItem){s.push({delimiter:true},{text:t.Loc.getMessage("SEO_ADS_CLIENT_NO_ACCOUNT"),onclick:this.onUnSelectItem.bind(this)})}if(this.canAddItems){s.push({delimiter:true},{text:t.Loc.getMessage("SEO_ADS_CLIENT_ADD"),onclick:function e(){n.closeMenu();if(t.Type.isFunction(n.onNewItemCallback))n.onNewItemCallback()}})}var u=this.getSelectorNode();BX.PopupMenu.show("clientsMenuDropdown",this.container,s,{offsetTop:0,offsetLeft:42,angle:true,events:{onPopupClose:function e(){u?u.classList.remove("seo-ads-client-selector-active"):false;BX.PopupMenu.destroy("clientsMenuDropdown")}}});u?u.classList.add("seo-ads-client-selector-active"):false;var d=BX.PopupMenu.currentItem.popupWindow.getContentContainer().querySelectorAll('[data-role="client-remove"]');var v=true;var m=false;var f=undefined;try{for(var h=d[Symbol.iterator](),p;!(v=(p=h.next()).done);v=true){var I=p.value;t.Event.bind(I,"click",function(e){e.stopPropagation();var t=BX.data(e.target,"client-id");n.closeMenu();var s=true;var a=false;var l=undefined;try{for(var i=n.items[Symbol.iterator](),o;!(s=(o=i.next()).done);s=true){var r=o.value;if(r.CLIENT_ID==t){n.confirmRemoveItem(r)}}}catch(e){a=true;l=e}finally{try{if(!s&&i.return!=null){i.return()}}finally{if(a){throw l}}}})}}catch(e){m=true;f=e}finally{try{if(!v&&h.return!=null){h.return()}}finally{if(m){throw f}}}}},{key:"confirmRemoveItem",value:function e(n){var s=this;var a=new BX.PopupWindow({content:this.getRemoveConfirmPopupHtml(n),autoHide:true,cacheable:false,closeIcon:true,closeByEsc:true,buttons:[new BX.UI.Button({text:t.Loc.getMessage("SEO_ADS_CLIENT_DISCONNECT"),color:BX.UI.Button.Color.DANGER,onclick:function e(t){a.close();s.onRemoveItem(n)}}),new BX.UI.Button({text:t.Loc.getMessage("SEO_ADS_CLIENT_BTN_CANCEL"),color:BX.UI.Button.Color.LINK,onclick:function e(){a.close()}})]});a.show()}},{key:"closeMenu",value:function e(){if(BX.PopupMenu.currentItem){BX.PopupMenu.currentItem.close()}}},{key:"destroy",value:function e(){if(BX.PopupMenu.currentItem){BX.PopupMenu.currentItem.close()}this.container.innerHTML=""}},{key:"getSelectorNode",value:function e(){var t=this.container.getElementsByClassName("seo-ads-client-selector");if(t)t=t[0];return t}}]);return e}();e.ClientSelector=r})(this.BX.Seo.Ads=this.BX.Seo.Ads||{},BX,BX);
//# sourceMappingURL=client_selector.bundle.map.js