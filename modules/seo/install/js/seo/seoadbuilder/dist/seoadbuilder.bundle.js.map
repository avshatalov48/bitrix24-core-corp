{"version":3,"file":"seoadbuilder.bundle.js","sources":["../src/seoaccount.js","../src/helper.js","../src/seoadbuilder.js","../src/seopostselector.js","../src/seoaudience.js","../src/seocrmaudience.js","../src/pageconfiguration.js"],"sourcesContent":["import { Helper } from './helper';\nimport { type AccountFields } from './types/account';\nimport {LoginFactory} from \"seo.ads.login\";\n\nexport class SeoAccount\n{\n\t_helper: Helper;\n\tconstructor(options: AccountFields): SeoAccount\n\t{\n\t\tthis.clientNode = options.clientNode;\n\t\tthis.avatarNode = options.avatarNode;\n\t\tthis.accountNode = options.accountNode;\n\t\tthis.instagramAccountNode = options.instagramAccountNode;\n\t\tthis.linkNode = options.linkNode;\n\t\tthis.provider = options.provider;\n\t\tthis.componentName = options.componentName;\n\t\tthis.signedParameters = options.signedParameters;\n\t\tthis.uiNodes = options.uiNodes;\n\t\tthis._helper = Helper.getInstance(this, []);\n\t\tthis.loaded = [];\n\n\t\tthis.clientSelector = new BX.Seo.Ads.ClientSelector(options.clientBlock, {\n\t\t\tselected: this.provider.PROFILE,\n\t\t\titems: this.provider.CLIENTS,\n\t\t\tcanAddItems: true,\n\t\t\tevents: {\n\t\t\t\tonNewItem: () => {\n\t\t\t\t\tLoginFactory.getLoginObject(this.provider).login();\n\t\t\t\t},\n\t\t\t\tonSelectItem: item => {\n\t\t\t\t\tthis.setProfile(item);\n\t\t\t\t},\n\t\t\t\tonRemoveItem: item => {\n\t\t\t\t\tthis.logout(item.CLIENT_ID);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn this;\n\t}\n\n\tlistenSeoAuth()\n\t{\n\t\tBX.addCustomEvent(\n\t\t\twindow,\n\t\t\t'seo-client-auth-result',\n\t\t\tBX.proxy(this.onSeoAuth, this)\n\t\t);\n\t}\n\n\tonSeoAuth(eventData)\n\t{\n\t\teventData.reload = false;\n\t\tthis.getProvider(eventData.clientId);\n\t}\n\n\tlogout(clientId)\n\t{\n\t\tconst analyticsLabel =\n\t\t\t!(this.provider.TYPE === \"facebook\" || this.provider.TYPE === \"instagram\")\n\t\t\t\t? {}\n\t\t\t\t: {\n\t\t\t\t\tconnect: \"FBE\",\n\t\t\t\t\taction: \"disconnect\",\n\t\t\t\t\ttype: \"disconnect\"\n\t\t\t\t}\n\t\t;\n\n\t\tthis._helper.showBlock('loading');\n\t\tthis._helper.request(\n\t\t\t'logout',\n\t\t\t{logoutClientId: clientId},\n\t\t\tprovider =>\n\t\t\t\t{\n\t\t\t\t\tthis.provider = provider;\n\t\t\t\t\tif (this.clientSelector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.clientSelector.setSelected(this.provider.PROFILE);\n\t\t\t\t\t\tthis.clientSelector.setItems(this.provider.CLIENTS);\n\t\t\t\t\t}\n\t\t\t\t\tthis._helper.setProvider(provider);\n\t\t\t\t\tthis._helper.showBlockByAuth();\n\t\t\t\t},\n\t\t\tanalyticsLabel\n\t\t);\n\t}\n\n\tgetProvider(clientId)\n\t{\n\t\tthis.showBlock('loading');\n\t\tthis.request('getProvider', {}, provider => {\n\t\t\tthis.provider = provider;\n\n\t\t\tif (this.clientSelector)\n\t\t\t{\n\t\t\t\tif (!this.provider.PROFILE ||\n\t\t\t\t\t(clientId && clientId !== this.provider.PROFILE.CLIENT_ID)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\t// set PROFILE equal to clientId or first record from CLIENTS:\n\t\t\t\t\tfor (let i = 0; i < this.provider.CLIENTS.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet client = this.provider.CLIENTS[i];\n\n\t\t\t\t\t\tif (!clientId || clientId.toString() === client.CLIENT_ID.toString())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setProfile(client);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.clientSelector.setSelected(this.provider.PROFILE);\n\t\t\t\tthis.clientSelector.setItems(this.provider.CLIENTS);\n\t\t\t}\n\t\t\tthis.showBlockByAuth();\n\t\t});\n\t}\n\n\tloadAccounts(type)\n\t{\n\t\t// this.loader.forAccount(true);\n\t\tif (this.clientSelector)\n\t\t{\n\t\t\tthis.clientSelector.disable();\n\t\t}\n\n\t\tthis._helper.request('getAccounts', {}, data => {\n\t\t\t\tif (this.clientSelector)\n\t\t\t\t{\n\t\t\t\t\tthis.clientSelector.enable();\n\t\t\t\t}\n\n\t\t\t\tthis.uiNodes.accountNotice.ad.style.display = 'none';\n\t\t\t\tif (!data.length)\n\t\t\t\t{\n\t\t\t\t\tthis.uiNodes.accountNotice.ad.style.display = 'block';\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst dropDownData = data.map(accountData => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcaption: BX.util.htmlspecialchars(accountData.name),\n\t\t\t\t\t\tvalue: accountData.id,\n\t\t\t\t\t\tselected: accountData.id === this.accountId,\n\t\t\t\t\t\tcurrency: accountData.currency\n\t\t\t\t\t};\n\t\t\t\t}, this);\n\n\t\t\t\tthis._helper.fillDropDownControl(this.accountNode, dropDownData);\n\t\t\t\tif (dropDownData.length > 0)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tBX.fireEvent(this.accountNode, 'change');\n\t\t\t\t\t}, 150);\n\t\t\t\t}\n\t\t\t\tthis.accountNode.disabled = false\n\n\t\t\t}\n\t\t);\n\t}\n\n\tloadInstagramAccounts(type)\n\t{\n\t\tif (this.clientSelector)\n\t\t{\n\t\t\tthis.clientSelector.disable();\n\t\t}\n\n\t\tthis._helper.request('getInstagramAccounts', {}, data => {\n\t\t\t\tif (this.clientSelector)\n\t\t\t\t{\n\t\t\t\t\tthis.clientSelector.enable();\n\t\t\t\t}\n\n\t\t\t\tthis.uiNodes.accountNotice.instagram.style.display = 'none';\n\t\t\t\tif (!data.length)\n\t\t\t\t{\n\t\t\t\t\tthis.uiNodes.accountNotice.instagram.style.display = 'block';\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst dropDownData = data.map(accountData => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcaption: BX.util.htmlspecialchars(accountData.name),\n\t\t\t\t\t\tvalue: accountData.id,\n\t\t\t\t\t\tpageId: accountData.page_id,\n\t\t\t\t\t\tactorId: accountData.actor_id\n\t\t\t\t\t};\n\t\t\t\t}, this);\n\n\t\t\t\tthis._helper.fillDropDownControl(this.instagramAccountNode, dropDownData);\n\t\t\t\tif (dropDownData.length > 0)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tBX.fireEvent(this.instagramAccountNode, 'change');\n\t\t\t\t\t}, 150);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\n\t\t\t\t}\n\n\t\t\t\tthis.instagramAccountNode.disabled = false;\n\t\t\t}\n\t\t);\n\t}\n\n\tloadSettings()\n\t{\n\t\tthis.instagramAccountNode.disabled  = true;\n\t\tthis.accountNode.disabled  = true;\n\n\t\tconst type = this.provider.TYPE;\n\t\tconst isSupportAccount = this.provider.IS_SUPPORT_ACCOUNT;\n\n\t\tif (!this.provider.PROFILE)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.loaded.includes(type))\n\t\t{\n\t\t\tthis.loaded.push(type);\n\t\t}\n\n\t\tif (this.accountNode && isSupportAccount)\n\t\t{\n\t\t\tthis.loadAccounts();\n\t\t\tthis.loadInstagramAccounts();\n\t\t}\n\t}\n\n\tsetProfile(item)\n\t{\n\t\tthis.clientId = item && item.CLIENT_ID ? item.CLIENT_ID : null;\n\t\tthis.provider.PROFILE = item;\n\t\tthis.accountId = null;\n\t\tthis.pageId = null;\n\n\t\tif(this.clientSelector.selected)\n\t\t{\n\t\t\tthis._helper.showBlockMain();\n\t\t}\n\n\t\tthis.clientSelector.setSelected(item);\n\t}\n}","import { PopupManager } from 'main.popup';\nimport { Button } from 'ui.buttons';\nimport { SeoAccount } from './seoaccount';\nimport { Loc, Tag, Type } from \"main.core\";\n\nexport class Helper\n{\n\t_instance: Helper;\n\n\tconstructor(seoAccount: SeoAccount): Helper\n\t{\n\t\tthis.provider = seoAccount.provider;\n\t\tthis.clientId = seoAccount.clientId;\n\t\tthis.clientSelector = seoAccount.clientSelector;\n\t\tthis.clientNode = seoAccount.clientNode;\n\t\tthis.avatarNode = seoAccount.avatarNode;\n\t\tthis.linkNode = seoAccount.linkNode;\n\t\tthis.seoAccount = seoAccount;\n\t\tthis.signedParameters = seoAccount.signedParameters;\n\t\tthis.containerNode = BX('crm-ads-new-campaign');\n\n\t\tthis.mess = {\n\t\t\terrorAction: Loc.getMessage('UI_HELPER_ERROR_MSG'),\n\t\t\tdlgBtnClose: Loc.getMessage('UI_HELPER_BUTTON_CLOSE')\n\n\t\t}\n\n\t\treturn this;\n\t}\n\n\n\tsetProvider(value)\n\t{\n\t\tthis.provider = value;\n\t}\n\n\tstatic getCreated(): Helper\n\t{\n\t\tif(this._instance === undefined)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn this._instance\n\t}\n\n\tstatic getInstance(seoAccount: SeoAccount, signedParameters): Helper\n\t{\n\t\tif(this._instance === undefined)\n\t\t{\n\t\t\tthis._instance = new Helper(seoAccount, signedParameters)\n\t\t}\n\n\t\treturn this._instance;\n\t}\n\n\trequest(action, requestData, callback, analytics)\n\t{\n\t\trequestData.action = action;\n\t\trequestData.type = this.seoAccount.provider.TYPE;\n\t\trequestData.clientId = this.seoAccount.clientId;\n\n\t\tthis.sendActionRequest(\n\t\t\taction,\n\t\t\trequestData,\n\t\t\t(response) => this.onResponse(response, callback),\n\t\t\tnull,\n\t\t\tanalytics || {}\n\t\t);\n\t}\n\n\tonResponse(response, callback)\n\t{\n\t\tif (!response.error)\n\t\t{\n\t\t\tcallback.apply(this, [response.data]);\n\t\t}\n\t}\n\n\tsendActionRequest(action, data, callbackSuccess, callbackFailure, analytics)\n\t{\n\t\tcallbackSuccess = callbackSuccess || null;\n\t\tcallbackFailure = callbackFailure || BX.proxy(this.showErrorPopup, this);\n\t\tdata = data || {};\n\t\tanalytics = analytics || {};\n\n\t\tBX.ajax.runComponentAction(\n\t\t\tthis.seoAccount.componentName,\n\t\t\taction,\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data,\n\t\t\t\tanalyticsLabel: analytics\n\t\t\t})\n\t\t.then(\n\t\t\tresponse => {\n\t\t\t\tconst data = response.data || {};\n\t\t\t\tif (data.error)\n\t\t\t\t{\n\t\t\t\t\tcallbackFailure.apply(this, [data]);\n\t\t\t\t}\n\t\t\t\telse if (callbackSuccess)\n\t\t\t\t{\n\t\t\t\t\tcallbackSuccess.apply(this, [data]);\n\t\t\t\t}\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tconst data = { 'error': true, 'text': '' };\n\t\t\t\tcallbackFailure.apply(this, [data]);\n\t\t\t}\n\t\t);\n\t}\n\n\tshowErrorPopup(data)\n\t{\n\t\tconsole.log(data);\n\t\tconst text = data.text || this.mess.errorAction;\n\n\t\tconst popup = PopupManager.create({\n\t\t\t\tid: 'crm_ads_rtg_error',\n\t\t\t\tautoHide: true,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toverlay: { backgroundColor: 'black', opacity: 500 },\n\t\t\t\tevents: {\n\t\t\t\t\t'onPopupClose': this.onErrorPopupClose.bind(this)\n\t\t\t\t},\n\t\t\t\tbuttons: [\n\t\t\t\t\tnew Button({\n\t\t\t\t\t\ttext: 'close' || this.mess.dlgBtnClose,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t}\n\t\t);\n\n\t\tpopup.setContent( `<span class=\"crm-ads-rtg-warning-popup-alert\">${text}</span>`)\n\n\t\tpopup.show();\n\t}\n\n\tonErrorPopupClose()\n\t{\n\t\tif (this.clientSelector)\n\t\t{\n\t\t\tthis.clientSelector.enable();\n\t\t}\n\t}\n\n\n\tshowBlock(blockCodes)\n\t{\n\t\tblockCodes = Type.isArray(blockCodes) ? blockCodes : [blockCodes];\n\t\tconst attributeBlock = 'data-bx-ads-block';\n\t\tconst blockNodes = [...this.containerNode.querySelectorAll('[' + attributeBlock + ']')];\n\t\tblockNodes.forEach(blockNode => {\n\t\t\tconst code = blockNode.getAttribute(attributeBlock);\n\t\t\tconst isShow = blockCodes.includes(code);\n\t\t\tblockNode.style.display = isShow ? (blockNode.dataset.flex?'flex':'block') : 'none';\n\t\t}, this);\n\t}\n\n\tshowBlockRefresh()\n\t{\n\t\tthis.showBlock(['auth', 'refresh']);\n\t}\n\n\tshowBlockLogin()\n\t{\n\t\tthis.showBlock('login');\n\n\t\tconst btn = BX('seo-ads-login-btn');\n\t\tif (btn && this.provider && this.provider.AUTH_URL)\n\t\t{\n\t\t\tbtn.setAttribute(\n\t\t\t\t'onclick',\n\t\t\t\t'BX.util.popup(\\'' + this.provider.AUTH_URL + '\\', 800, 600);'\n\t\t\t);\n\t\t}\n\t\tif (this.clientNode)\n\t\t{\n\t\t\tthis.clientNode.value = \"\";\n\t\t}\n\t}\n\n\tshowBlockMain()\n\t{\n\t\tif (this.avatarNode)\n\t\t{\n\t\t\tthis.avatarNode.style['background-image'] = 'url(' + this.provider.PROFILE.PICTURE + ')';\n\t\t}\n\t\tif (this.nameNode)\n\t\t{\n\t\t\tthis.nameNode.innerText = this.provider.PROFILE.NAME;\n\t\t}\n\t\tif (this.linkNode)\n\t\t{\n\t\t\tif (this.provider.PROFILE.LINK)\n\t\t\t{\n\t\t\t\tthis.linkNode.setAttribute('href', this.provider.PROFILE.LINK);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.linkNode.removeAttribute('href');\n\t\t\t}\n\t\t}\n\t\tif (this.clientNode)\n\t\t{\n\t\t\tthis.clientNode.value =\n\t\t\t\tthis.provider.PROFILE && this.provider.PROFILE.CLIENT_ID ?\n\t\t\t\t\tthis.provider.PROFILE.CLIENT_ID :\n\t\t\t\t\t\"\";\n\t\t}\n\n\t\tthis.showBlock(['auth', 'main']);\n\n\t\tthis.seoAccount.loadSettings();\n\t}\n\n\n\tshowBlockByAuth()\n\t{\n\t\tif (this.provider.HAS_AUTH)\n\t\t{\n\t\t\tthis.showBlockMain();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showBlockLogin();\n\t\t}\n\t}\n\n\tfillDropDownControl(node, items)\n\t{\n\t\titems = items || [];\n\t\tnode.innerHTML = '';\n\t\titems.forEach(item => {\n\t\t\tif (!item || !item.caption)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst option =\n\t\t\t\tTag.render`<option value='${item.value}' selected='${!!item.selected}'>${item.caption}</option>`;\n\n\t\t\tif(item.currency)\n\t\t\t{\n\t\t\t\toption.dataset.currency = item.currency;\n\t\t\t}\n\n\t\t\tif(item.pageId)\n\t\t\t{\n\t\t\t\toption.dataset.pageId = item.pageId;\n\t\t\t}\n\n\t\t\tif(item.actorId)\n\t\t\t{\n\t\t\t\toption.dataset.actorId = item.actorId;\n\t\t\t}\n\n\t\t\tnode.appendChild(option);\n\t\t});\n\t}\n}","import {SeoAccount} from \"./seoaccount\";\nimport {ProductSelector} from 'catalog.product-selector';\nimport {Event, Loc, Tag} from \"main.core\";\nimport {EventEmitter} from 'main.core.events';\nimport { type AdBuilderOptions } from './types/adbuilderoptions';\nimport { TagSelector } from 'ui.entity-selector';\n\nexport class SeoAdBuilder\n{\n\t_instance: SeoAdBuilder;\n\tproductSelector: ProductSelector;\n\t_DEFAULT_CURRENCY = 'RUB';\n\n\t_STAGES = {\n\t\taccountSelected: 1,\n\t\tpostSelected: 2,\n\t\tpageSelected: 3,\n\t\taudienceSelected: 4,\n\t\tbudgetSelected: 5,\n\t\ttoModeration: 6\n\t};\n\n\tconstructor(options: AdBuilderOptions)\n\t{\n\t\tif (this._instance)\n\t\t{\n\t\t\treturn this._instance;\n\t\t}\n\n\t\tthis.optionSelectedClass = 'crm-ads-new-campaign-item-option--selected';\n\t\tthis.containerId = options.containerId;\n\t\tthis.provider = options.provider;\n\t\tthis.context = options.context;\n\t\tthis.onRequest = options.onRequest;\n\t\tthis.componentName = options.componentName;\n\t\tthis.signedParameters = options.signedParameters;\n\t\tthis.postListUrl = options.postListUrl;\n\t\tthis.audienceUrl = options.audienceUrl;\n\t\tthis.crmAudienceUrl = options.crmAudienceUrl;\n\t\tthis.pageConfigurationUrl = options.pageConfigurationUrl;\n\t\tthis.mess = options.mess;\n\t\tthis.type = options.type;\n\t\tthis.iBlockId = options.iBlockId;\n\t\tthis.basePriceId = options.basePriceId;\n\t\tthis.storeExists = options.storeExists;\n\t\tthis.isCloud = options.isCloud || false;\n\n\t\tthis.clientId = options.clientId;\n\t\tthis.accountId = options.accountId;\n\t\tthis.baseCurrency = options.baseCurrency;\n\t\tthis.arrows = document.querySelectorAll(\".crm-ads-new-campaign-item-arrow\");\n\n\t\tthis.price = [];\n\t\tthis.price[this._DEFAULT_CURRENCY] = [];\n\t\tthis.price[this._DEFAULT_CURRENCY]['recommended'] = { duration: 3, value: 100 };\n\t\tthis.price[this._DEFAULT_CURRENCY]['verified'] = { duration: 3, value: 200 };\n\t\tthis.price[this._DEFAULT_CURRENCY]['boost'] = { duration: 3, value: 300 };\n\t\tthis.price[this._DEFAULT_CURRENCY]['confident'] = { duration: 5, value: 500 };\n\n\t\tthis.price['USD'] = [];\n\t\tthis.price['USD']['recommended'] = { duration: 3, value: 50 };\n\t\tthis.price['USD']['verified'] = { duration: 3, value: 100 };\n\t\tthis.price['USD']['boost'] = { duration: 3, value: 150 };\n\t\tthis.price['USD']['confident'] = { duration: 5, value: 200 };\n\n\t\tthis.price['EUR'] = [];\n\t\tthis.price['EUR']['recommended'] = { duration: 3, value: 50 };\n\t\tthis.price['EUR']['verified'] = { duration: 3, value: 100 };\n\t\tthis.price['EUR']['boost'] = { duration: 3, value: 150 };\n\t\tthis.price['EUR']['confident'] = { duration: 5, value: 200 };\n\n\t\tthis.completedStages = {};\n\t\tthis.selectedRegions = {};\n\n\t\tthis.loader = {\n\t\t\tinit: caller => {\n\t\t\t\tthis.caller = caller;\n\t\t\t},\n\n\t\t\tchange: (loaderNode, inputNode, isShow) => {\n\t\t\t\tloaderNode.style.display = isShow ? '' : 'none';\n\t\t\t\tif (inputNode)\n\t\t\t\t{\n\t\t\t\t\tinputNode.disabled = (!inputNode.options.length === 0 || isShow) ? false : true;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tthis._instance = this;\n\t\tthis.initiateUINodes();\n\t\tthis.initiateAutoAudienceMode();\n\n\n\t\tfor (let i = this._STAGES.accountSelected; i <= this._STAGES.toModeration; i++)\n\t\t{\n\t\t\tthis.deActivateStage(i);\n\t\t}\n\n\t\tthis.initiateAccounts();\n\t\tthis.activateStage(this._STAGES.audienceSelected);\n\n\t\tthis.initiateSwitcher('product');\n\t\tthis.initiateSwitcher('audience');\n\t\tthis.initiateSwitcher('budget');\n\n\t\tthis.bindEvents()\n\t\tthis.buildSelector();\n\n\t\tthis.storeBlockShow(true);\n\t}\n\n\treInitAdCreator()\n\t{\n\t\tthis.adCreatorData = {};\n\t\tthis.adCreatorData.audienceConfig = {};\n\t\tthis.adCreatorData.crmAudienceConfig = {};\n\t}\n\n\tinitiateAccounts()\n\t{\n\t\tthis.seoAccount = new SeoAccount({\n\t\t\tclientNode: this.uiNodes.clientInput,\n\t\t\tprovider: this.provider,\n\t\t\tavatarNode: this.uiNodes.avatar,\n\t\t\tlinkNode: this.uiNodes.link,\n\t\t\taccountNode: this.uiNodes.account,\n\t\t\tinstagramAccountNode: this.uiNodes.instagramAccount,\n\t\t\tclientBlock: this.uiNodes.clientBlock,\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tcomponentName: this.componentName,\n\t\t\tuiNodes: this.uiNodes\n\t\t});\n\n\t\tthis.profileConfigured = false;\n\t\tif (!this.clientId && !this.provider.PROFILE)\n\t\t{ // use first client by default\n\t\t\tfor (let i = 0; i < this.provider.CLIENTS.length; i++)\n\t\t\t{\n\t\t\t\tthis.seoAccount.setProfile(this.provider.CLIENTS[i]);\n\t\t\t\tthis.profileConfigured = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.loader.init(this);\n\n\t\tif (this.provider.PROFILE)\n\t\t{\n\t\t\tthis.activateStage(this._STAGES.accountSelected);\n\t\t}\n\n\t\tif(!this.profileConfigured)\n\t\t{\n\t\t\tthis.seoAccount.setProfile(this.provider.PROFILE);\n\t\t}\n\n\t\tthis.seoAccount._helper.showBlockByAuth();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEvent.bind(this.uiNodes.addPost, 'click', this.openPostSlider.bind(this));\n\n\t\tthis.uiNodes.createLinks.forEach(function(createLink) {\n\t\t\tEvent.bind(createLink, 'click', BX.proxy(function() {\n\t\t\t\tif (!this.hasPostLis)\n\t\t\t\t{\n\t\t\t\t\tthis.showBlockRefresh();\n\t\t\t\t}\n\t\t\t}, this));\n\t\t}, this);\n\n\t\tEvent.bind(this.uiNodes.refreshButton, 'click', BX.proxy(function() {\n\t\t\tthis.seoAccount.getProvider();\n\t\t}, this));\n\n\t\tif (this.uiNodes.autoRemover.checker)\n\t\t{\n\t\t\tEvent.bind(this.uiNodes.autoRemover.checker, 'click', () => {\n\t\t\t\tvar autoRemover = this.uiNodes.autoRemover;\n\t\t\t\tautoRemover.select.disabled = !autoRemover.checker.checked;\n\t\t\t});\n\t\t}\n\n\t\tEvent.bind(this.uiNodes.logout, 'click', BX.proxy(function() {\n\t\t\tthis.seoAccount.logout(this.clientId);\n\t\t}, this));\n\n\t\tEvent.bind(this.uiNodes.addClientBtn, 'click', BX.proxy(function() {\n\t\t\tBX.util.popup(_this.provider.AUTH_URL, 800, 600);\n\t\t}, this));\n\n\t\tthis.arrows.forEach(arrow => {\n\t\t\t\tarrow.addEventListener('click', this.switchCollapsed);\n\t\t\t}\n\t\t);\n\n\t\tEvent.bind(this.uiNodes.account, 'change', this.checkCurrency.bind(this));\n\t\tdocument.querySelectorAll('.seo-ads-budget-item-block').forEach(div => {\n\t\t\tEvent.bind(div, 'click', this.calculateTotal.bind(this));\n\t\t});\n\n\t\tdocument.querySelectorAll('.seo-ads-audience-item-block').forEach(div => {\n\t\t\tEvent.bind(div, 'click', this.changeAudienceMode.bind(this));\n\t\t});\n\n\t\tdocument.querySelectorAll('.seo-ads-product-item-block').forEach(div => {\n\t\t\tEvent.bind(div, 'click', this.changeProductSelectionMode.bind(this));\n\t\t});\n\n\t\tEvent.bind(this.uiNodes.audienceExpert, 'click', this.showAudienceExpertModeForm.bind(this));\n\t\tEvent.bind(this.uiNodes.productExpert, 'click', this.openTargetPageSlider.bind(this));\n\n\t\tEvent.bind(this.uiNodes.addProductBtn, 'click', this.toCreateStoreSlider.bind(this));\n\t\tEvent.bind(this.uiNodes.addCurrencyBtn, 'click', this.addCurrency.bind(this));\n\t\tEvent.bind(this.uiNodes.toModerationBtn, 'click', this.sendToModeration.bind(this));\n\t}\n\n\tinitiateUINodes()\n\t{\n\t\tthis.containerNode = BX('crm-ads-new-campaign');\n\t\tBX.UI.Hint.init(this.containerNode);\n\n\t\tthis.uiNodes = {\n\t\t\t'avatar': this.containerNode.querySelector('[data-bx-ads-auth-avatar]'),\n\t\t\t'name': this.containerNode.querySelector('[data-bx-ads-auth-name]'),\n\t\t\t'link': this.containerNode.querySelector('[data-bx-ads-auth-link]'),\n\t\t\t'logout': this.containerNode.querySelector('[data-bx-ads-auth-logout]'),\n\t\t\t'clientBlock': this.containerNode.querySelector('[data-bx-ads-client]'),\n\t\t\t'clientInput': this.containerNode.querySelector('[data-bx-ads-client-input]'),\n\t\t\t'account': this.containerNode.querySelector('[data-bx-ads-account]'),\n\t\t\t'accountLoader': this.containerNode.querySelector('[data-bx-ads-account-loader]'),\n\t\t\t'instagramAccount': this.containerNode.querySelector('[data-bx-ads-instagram-account]'),\n\t\t\t'instagramAccountLoader': this.containerNode.querySelector('[data-bx-ads-instagram-account-loader]'),\n\t\t\t'errorNotFound': this.containerNode.querySelector('[data-bx-ads-post-not-found]'),\n\t\t\t'addPost': this.containerNode.querySelector('.crm-ads-new-campaign-item-post-new'),\n\t\t\t'addProductBtn': this.containerNode.querySelector('.seo-ads-add-product-btn'),\n\t\t\t'addCurrencyBtn': this.containerNode.querySelector('.seo-ads-currency-apply-btn'),\n\t\t\t'toModerationBtn': this.containerNode.querySelector('.seo-ads-to-moderation-btn'),\n\t\t\t'refreshButton': this.containerNode.querySelector('[data-bx-ads-refresh-btn]'),\n\t\t\t'currencyBlock': document.querySelector('.seo-ads-currency-block'),\n\t\t\t'audienceSummary': document.querySelector('.seo-ads-audience-summary'),\n\t\t\t'createLinks': BX.convert.nodeListToArray(\n\t\t\t\tthis.containerNode.querySelectorAll('[data-bx-ads-post-create-link]')\n\t\t\t),\n\t\t\t'accountNotice': {\n\t\t\t\t'instagram': this.containerNode.querySelector('.seo-ads-no-ad-account-instagram'),\n\t\t\t\t'ad': this.containerNode.querySelector('.seo-ads-no-ad-account'),\n\t\t\t},\n\t\t\t'audienceExpert': BX('crm-ads-new-campaign-item-expert-audience'),\n\t\t\t'productExpert': BX('crm-ads-new-campaign-item-expert-product'),\n\t\t\t'budgetExpert': BX('crm-ads-new-campaign-item-expert-budget'),\n\t\t\t'autoRemover': {\n\t\t\t\t'node': this.containerNode.querySelector('[data-bx-ads-post-auto-remove]'),\n\t\t\t\t'checker': this.containerNode.querySelector('[data-bx-ads-post-auto-remove-checker]'),\n\t\t\t\t'select': this.containerNode.querySelector('[data-bx-ads-post-auto-remove-select]')\n\t\t\t},\n\t\t\t'form': {\n\t\t\t\t'permalink': this.containerNode.querySelector('[data-bx-ads-permalink]'),\n\t\t\t\t'mediaId': this.containerNode.querySelector('[data-bx-ads-media-id]'),\n\t\t\t\t'targetUrl': this.containerNode.querySelector('[data-bx-ads-target-url]'),\n\t\t\t\t'duration': this.containerNode.querySelector('[data-bx-ads-duration]'),\n\t\t\t\t'page': this.containerNode.querySelector('[data-bx-ads-page-id]'),\n\t\t\t\t'body': this.containerNode.querySelector('[data-bx-ads-body]'),\n\t\t\t\t'adsId': this.containerNode.querySelector('[data-bx-ads-id]'),\n\t\t\t\t'pageId': this.containerNode.querySelector('[data-bx-ads-page-id]'),\n\t\t\t\t'budget': this.containerNode.querySelector('[data-bx-ads-budget]'),\n\t\t\t\t'ageFrom': this.containerNode.querySelector('[data-bx-ads-age-from]'),\n\t\t\t\t'ageTo': this.containerNode.querySelector('[data-bx-ads-age-to]'),\n\t\t\t\t'genders': this.containerNode.querySelector('[data-bx-ads-genders]'),\n\t\t\t\t'interests': this.containerNode.querySelector('[data-bx-ads-interests]'),\n\t\t\t\t'imageUrl': this.containerNode.querySelector('[data-bx-ads-image-url]'),\n\t\t\t\t'instagramAccountId': this.containerNode.querySelector('[data-bx-ads-actor-id]'),\n\t\t\t\t'segmentInclude': this.containerNode.querySelector('[data-bx-ads-segment-include]'),\n\t\t\t\t'segmentExclude': this.containerNode.querySelector('[data-bx-ads-segment-exclude]'),\n\t\t\t\t'regions': this.containerNode.querySelector('[data-bx-ads-regions]')\n\t\t\t},\n\t\t\t'adsStoreBlock': this.containerNode.querySelectorAll('.seo-ads-store'),\n\t\t\t'addClientBtn': this.containerNode.querySelector('[data-bx-ads-client-add-btn]'),\n\t\t\t'addPostBtn': this.containerNode.querySelector('[data-bx-ads-post-add]')\n\t\t};\n\t}\n\n\tinitiateSwitcher(id)\n\t{\n\t\tnew BX.UI.Switcher({\n\t\t\tnode: BX(`crm-ads-new-campaign-item-expert-${id}`),\n\t\t\tsize: \"small\"\n\t\t});\n\t}\n\n\tcheckCurrency()\n\t{\n\t\tconst account = this.uiNodes.account;\n\t\tthis.usedCurrency = account.options[account.selectedIndex].dataset.currency;\n\t\tthis.currencyExists(this.usedCurrency);\n\t}\n\n\tcalculateTotal(event)\n\t{\n\t\tif(this.checkInstagramAccount())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst target = event.target.dataset.type ? event.target : event.target.parentNode;\n\n\t\tconst type = target.dataset.type;\n\t\tconst price = this.price[this.usedCurrency][type];\n\t\tconst total = price.duration * price.value;\n\n\t\tdocument.querySelectorAll('.seo-ads-budget-total-value').forEach(element => {\n\t\t\telement.textContent = total;\n\t\t});\n\n\t\tdocument.querySelector('.seo-ads-budget-total-currency').textContent = this.usedCurrency;\n\t\tdocument.querySelector('.seo-ads-budget-total-duration').textContent = price.duration;\n\n\t\tdocument.querySelector('.seo-ads-total-budget').textContent = total;\n\t\tdocument.querySelector('.seo-ads-total-currency').textContent = this.usedCurrency;\n\t\tdocument.querySelector('.seo-ads-total-duration').textContent = price.duration;\n\n\t\tdocument.querySelector('.crm-ads-new-campaign-item-cost').style.display = 'block';\n\n\t\tdocument.querySelectorAll('.seo-ads-budget-item-block').forEach(div => {\n\t\t\tdiv.classList.remove(this.optionSelectedClass);\n\t\t});\n\n\t\ttarget.classList.add(this.optionSelectedClass);\n\n\t\tthis.uiNodes.form.budget.value = total;\n\t\tthis.uiNodes.form.duration.value = price.duration;\n\t\tthis.prepareCurrencyBlocks();\n\t\tthis.activateStage(this._STAGES.budgetSelected);\n\t}\n\n\tcheckInstagramAccount()\n\t{\n\t\tif (!this.uiNodes.instagramAccount.value)\n\t\t{\n\t\t\tthis.scrollToStage(this._STAGES.accountSelected);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tchangeAudienceMode(event)\n\t{\n\t\tif(this.checkInstagramAccount())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst target = event.target.dataset.type ? event.target : event.target.parentNode;\n\n\t\tconst type = target.dataset.type;\n\n\t\tdocument.querySelectorAll('.seo-ads-audience-item-block').forEach(div => {\n\t\t\tdiv.classList.remove(this.optionSelectedClass);\n\t\t});\n\n\t\ttarget.classList.add(this.optionSelectedClass);\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase 'auto':\n\t\t\t\tthis.initiateAutoAudienceMode();\n\t\t\t\tbreak;\n\t\t\tcase 'crm':\n\t\t\t\tthis.showCrmAudienceExpertModeForm();\n\t\t\t\tbreak;\n\t\t\tcase 'expert':\n\t\t\t\tthis.showAudienceExpertModeForm();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tchangeProductSelectionMode(event)\n\t{\n\t\tif(this.checkInstagramAccount())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst target = event.target.dataset.type ? event.target : event.target.parentNode;\n\n\t\tconst type = target.dataset.type;\n\t\tdocument.querySelectorAll('.seo-ads-product-item-block').forEach(div => {\n\t\t\tdiv.classList.remove(this.optionSelectedClass);\n\t\t});\n\n\t\ttarget.classList.add(this.optionSelectedClass);\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase 'auto':\n\t\t\t\tthis.storeBlockShow(true);\n\t\t\t\tbreak;\n\t\t\tcase 'expert':\n\t\t\t\tthis.openTargetPageSlider();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tstoreBlockShow(isShown)\n\t{\n\t\tthis.uiNodes.adsStoreBlock.forEach((element) => {\n\t\t\tif(this.storeExists && element.dataset.type === 'store-not-created')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(!this.storeExists && element.dataset.type !== 'store-not-created')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\telement.style.display = isShown?'block':'none';\n\t\t});\n\t}\n\n\tprepareCurrencyBlocks()\n\t{\n\t\tdocument.querySelectorAll('.seo-ads-current-currency').forEach(element => {\n\t\t\telement.textContent = this.usedCurrency;\n\t\t});\n\t}\n\n\tprepareCurrencyBlock(currency = this._DEFAULT_CURRENCY)\n\t{\n\t\tif (!this.price[currency])\n\t\t{\n\t\t\tfor (const key in this.price[this._DEFAULT_CURRENCY])\n\t\t\t{\n\t\t\t\tthis.convertToCurrency(\n\t\t\t\t\tkey,\n\t\t\t\t\tthis._DEFAULT_CURRENCY !== this.baseCurrency ? this.baseCurrency : currency,\n\t\t\t\t\tthis.price[this._DEFAULT_CURRENCY][key]\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const key in this.price[currency])\n\t\t{\n\t\t\tdocument.querySelector(`.seo-ads-budget-${key}-duration`).textContent = this.price[currency][key].duration;\n\t\t\tdocument.querySelector(`.seo-ads-budget-${key}-value`).textContent = this.price[currency][key].value;\n\t\t\tdocument.querySelector(`.seo-ads-budget-${key}-currency`).textContent = currency;\n\t\t}\n\t}\n\n\tconvertToCurrency(key, targetCurrency, price)\n\t{\n\t\tthis.seoAccount._helper.request('convertCurrency', {\n\t\t\t\tsourceCurrency: this.baseCurrency,\n\t\t\t\ttargetCurrency: targetCurrency,\n\t\t\t\tamount: price.value\n\t\t\t}, response => {\n\t\t\t\tconst amount = response.amount;\n\n\t\t\t\tif (!this.price[targetCurrency])\n\t\t\t\t{\n\t\t\t\t\tthis.price[targetCurrency] = [];\n\t\t\t\t}\n\n\t\t\t\tif (!this.price[targetCurrency][key])\n\t\t\t\t{\n\t\t\t\t\tthis.price[targetCurrency][key] = { duration: price.duration, value: amount };\n\t\t\t\t}\n\n\t\t\t\tif (Object.keys(this.price[targetCurrency]).length === 4)\n\t\t\t\t{\n\t\t\t\t\tthis.prepareCurrencyBlock(targetCurrency);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tcurrencyExists(currency)\n\t{\n\t\tthis.seoAccount._helper.request('checkCurrencyExists', {\n\t\t\t\tcurrency: currency\n\t\t\t}, response => {\n\t\t\t\tconst exists = response.exists;\n\n\t\t\t\tif (exists === false)\n\t\t\t\t{\n\t\t\t\t\tthis.prepareCurrencyBlocks();\n\t\t\t\t\tthis.uiNodes.currencyBlock.style.display = 'block';\n\t\t\t\t}\n\n\t\t\t\tthis.prepareCurrencyBlock(this.usedCurrency);\n\t\t\t}\n\t\t);\n\t}\n\n\taddCurrency()\n\t{\n\t\tconst count = document.querySelector('.seo-ads-currency-count');\n\t\tconst course = document.querySelector('.seo-ads-currency-course');\n\t\tif (!count.value || !course)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.seoAccount._helper.request('addCurrency', {\n\t\t\t\tnewCurrency: this.usedCurrency,\n\t\t\t\tcourse: course.value,\n\t\t\t\tamountCnt: count.value\n\t\t\t}, response => {\n\t\t\t\tconst success = response.success;\n\n\t\t\t\tif (success === false)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.uiNodes.currencyBlock.style.display = 'none';\n\t\t\t\tdelete (this.price[this.usedCurrency]);\n\t\t\t\tthis.prepareCurrencyBlock(this.usedCurrency);\n\t\t\t}\n\t\t);\n\t}\n\n\tswitchCollapsed(event)\n\t{\n\t\tconst block = event.target.closest('.crm-ads-new-campaign-item');\n\t\tconst content = block.querySelector('.crm-ads-new-campaign-item-content');\n\n\t\tif (block.classList.contains('crm-ads-new-campaign-item--hide'))\n\t\t{\n\t\t\tblock.classList.remove('crm-ads-new-campaign-item--hide');\n\t\t\tcontent.style.height = content.scrollHeight + 'px';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tblock.classList.add('crm-ads-new-campaign-item--hide');\n\t\t\tcontent.style.height = content.scrollHeight + 'px';\n\t\t\tsetTimeout(() => content.style.height = '0');\n\t\t}\n\t}\n\n\tclipTitle(title)\n\t{\n\t\tif (!title)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst text = title.textContent;\n\t\tconst nodeHeight = 20;\n\t\tBX.cleanNode(title);\n\n\t\tconst titleInner = BX.create(\"span\", {\n\t\t\ttext: text\n\t\t});\n\t\ttitle.appendChild(titleInner);\n\n\t\tlet a = 0;\n\t\twhile (titleInner.offsetHeight > nodeHeight && text.length > a)\n\t\t{\n\t\t\ta = a + 1;\n\t\t\ttitleInner.innerText = text.slice(0, -a) + '...';\n\t\t}\n\t}\n\n\tonPostSelected(event)\n\t{\n\t\tif (event.eventId === \"seo-ads-post-selected\" && event.data)\n\t\t{\n\t\t\tif (!event.data.media_url)\n\t\t\t{\n\t\t\t\tthis.deActivateStage(this._STAGES.postSelected);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst postItem = Tag.render` \n\t\t\t<div class=\"crm-ads-new-campaign-item-post\">\n\t\t\t   <div class=\"crm-ads-new-campaign-item-post-img\" \n\t\t\t\t\tstyle=\"background-image: url(${event.data.media_url})\">\n\t\t\t   </div>\n\t\t\t   <span class=\"crm-ads-new-campaign-item-post-text\">${event.data.caption||''}</span>\n\t\t\t   <span class=\"crm-ads-new-campaign-item-post-delete\"></span>\n\t\t\t</div>\n\t\t\t`;\n\n\t\t\tconst postListNode = document.querySelector('.crm-ads-new-campaign-item-posts');\n\t\t\tconst addNewNode = document.querySelector('.crm-ads-new-campaign-item-post-new');\n\t\t\tconst previewNode = document.querySelector('.crm-ads-new-campaign-item-total-preview-img-value');\n\n\t\t\tif (addNewNode !== postListNode.firstChild)\n\t\t\t{\n\t\t\t\tpostListNode.removeChild(postListNode.firstChild);\n\t\t\t}\n\n\t\t\tpostListNode.insertBefore(postItem, postListNode.firstChild);\n\t\t\tEvent.bind(postItem.querySelector('.crm-ads-new-campaign-item-post-delete'), 'click', () => {\n\t\t\t\tpostItem.parentNode.removeChild(postItem);\n\t\t\t});\n\n\t\t\tpreviewNode.style.backgroundImage = 'url(' + event.data.media_url + ')';\n\n\t\t\tthis.postData = event.data;\n\n\t\t\tconst title = document.querySelector('.crm-ads-new-campaign-item-post-text');\n\t\t\tthis.clipTitle(title);\n\t\t\tthis.activateStage(this._STAGES.postSelected);\n\t\t}\n\t}\n\n\topenPostSlider()\n\t{\n\t\tif (this.uiNodes.instagramAccount.value)\n\t\t{\n\t\t\tthis.openSlider(this.postListUrl, {\n\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t\tcomponentParams: {\n\t\t\t\t\tACCOUNT_ID: this.uiNodes.instagramAccount.value,\n\t\t\t\t\tCLIENT_ID: this.uiNodes.clientInput.value,\n\t\t\t\t\tTYPE: this.provider.TYPE\n\t\t\t\t}\n\t\t\t}, this.onPostSelected);\n\t\t}\n\t}\n\n\tonTargetPageSelected(event)\n\t{\n\t\tif (event.eventId === \"seo-ads-target-post-selected\" && event.data)\n\t\t{\n\t\t\tif (!event.data.targetUrl)\n\t\t\t{\n\t\t\t\tthis.deActivateStage(this._STAGES.pageSelected);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdocument.querySelector('.seo-ads-target-url').textContent = event.data.targetUrl;\n\t\t\tthis.uiNodes.form.targetUrl.value = event.data.targetUrl;\n\t\t\tthis.activateStage(this._STAGES.pageSelected);\n\t\t}\n\t}\n\n\tonFBAudienceConfigured(event)\n\t{\n\t\tif (event.eventId === \"seo-fb-audience-configured\" && event.data)\n\t\t{\n\t\t\tthis.reInitAdCreator();\n\t\t\tif (!event.data)\n\t\t\t{\n\t\t\t\tthis.deActivateStage(this._STAGES.audienceSelected);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.adCreatorData.audienceConfig = event.data;\n\t\t\tthis.activateStage(this._STAGES.audienceSelected);\n\n\t\t\tthis.uiNodes.audienceSummary.innerHTML = this.buildAudienceSummary();\n\t\t}\n\t}\n\n\tonCrmAudienceConfigured(event)\n\t{\n\t\tif (event.eventId === \"seo-crm-audience-configured\" && event.data)\n\t\t{\n\t\t\tthis.reInitAdCreator();\n\t\t\tif (!event.data)\n\t\t\t{\n\t\t\t\tthis.deActivateStage(this._STAGES.audienceSelected);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.adCreatorData.crmAudienceConfig = event.data;\n\t\t\tthis.activateStage(this._STAGES.audienceSelected);\n\t\t\tthis.uiNodes.audienceSummary.innerHTML = this.buildAudienceSummary();\n\t\t}\n\t}\n\n\topenTargetPageSlider()\n\t{\n\t\tif (this.uiNodes.instagramAccount.value)\n\t\t{\n\t\t\tthis.storeBlockShow(false);\n\t\t\tthis.openSlider(\n\t\t\t\tthis.pageConfigurationUrl, {\n\t\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t\t\ttargetUrl: this.uiNodes.form.targetUrl.value || '',\n\t\t\t\t\tcacheable: false\n\t\t\t\t},\n\t\t\t\tthis.onTargetPageSelected\n\t\t\t);\n\t\t}\n\t}\n\n\topenSlider(url, params, callback)\n\t{\n\t\tconst sliderOptions = {\n\t\t\twidth: 1150,\n\t\t\tcacheable: params.cacheable || true,\n\t\t\tallowChangeHistory: false,\n\t\t\trequestMethod: 'post',\n\t\t\trequestParams: params\n\t\t};\n\n\t\tconst eventName = BX.SidePanel.Slider.getEventFullName(\"onMessage\");\n\n\t\tBX.removeAllCustomEvents(\n\t\t\twindow,\n\t\t\teventName,\n\t\t\tcallback.bind(this)\n\t\t);\n\n\t\tBX.addCustomEvent(\n\t\t\twindow,\n\t\t\teventName,\n\t\t\tcallback.bind(this)\n\t\t);\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\turl,\n\t\t\tsliderOptions\n\t\t);\n\t}\n\n\tshowAudienceExpertModeForm()\n\t{\n\t\tif (this.uiNodes.instagramAccount.value)\n\t\t{\n\t\t\tthis.openSlider(this.audienceUrl, {\n\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t\tcomponentParams: {\n\t\t\t\t\tACCOUNT_ID: this.uiNodes.instagramAccount.value,\n\t\t\t\t\tCLIENT_ID: this.uiNodes.clientInput.value,\n\t\t\t\t\tTYPE: this.provider.TYPE\n\t\t\t\t}\n\t\t\t}, this.onFBAudienceConfigured);\n\t\t}\n\t}\n\n\tshowCrmAudienceExpertModeForm()\n\t{\n\t\tif (this.uiNodes.instagramAccount.value)\n\t\t{\n\t\t\tthis.openSlider(this.crmAudienceUrl, {\n\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t\tcomponentParams: {\n\t\t\t\t\tTYPE: this.provider.TYPE\n\t\t\t\t}\n\t\t\t}, this.onCrmAudienceConfigured);\n\t\t}\n\t}\n\n\tinitiateAutoAudienceMode()\n\t{\n\n\t\t\tthis.reInitAdCreator();\n\t\t\tthis.adCreatorData.crmAudienceConfig.genders = [1,2];\n\t\t\tthis.adCreatorData.crmAudienceConfig.ageFrom = 25;\n\t\t\tthis.adCreatorData.crmAudienceConfig.ageTo = 45;\n\n\t\t\tthis.activateStage(this._STAGES.audienceSelected);\n\t\t\tthis.uiNodes.audienceSummary.innerHTML = Loc.getMessage('SEO_AD_BUILDER_AUDIENCE_MEN_WOMAN_25_45');\n\t}\n\n\tbuildAudienceSummary()\n\t{\n\t\tlet summary = ''\n\n\t\tif(this.adCreatorData.audienceConfig.genderTitles)\n\t\t{\n\t\t\tsummary += `${Loc.getMessage('SEO_AD_BUILDER_GENDER')}: ${this.adCreatorData.audienceConfig.genderTitles.join(', ')} `;\n\t\t}\n\n\t\tif(this.adCreatorData.audienceConfig.ageFrom)\n\t\t{\n\t\t\tsummary += `${this.adCreatorData.audienceConfig.ageFrom} - ${this.adCreatorData.audienceConfig.ageTo}\n\t\t\t ${Loc.getMessage('SEO_AD_BUILDER_YEARS_OLD')} <br/>`;\n\t\t}\n\n\t\tif(this.adCreatorData.audienceConfig.interests)\n\t\t{\n\t\t\tlet interests = [];\n\t\t\tthis.adCreatorData.audienceConfig.interests.forEach((interest) => {\n\t\t\t\tinterests.push(interest.name);\n\t\t\t});\n\n\t\t\tsummary += `${Loc.getMessage('SEO_AD_BUILDER_INTERESTS')}: ${interests.join(', ')}<br/>`;\n\t\t}\n\n\t\tif(this.adCreatorData.crmAudienceConfig.segmentInclude)\n\t\t{\n\t\t\tsummary += `${Loc.getMessage('SEO_AD_BUILDER_CRM_AUDIENCE')}<br/>`;\n\t\t}\n\n\t\tif(Object.keys(this.selectedRegions).length)\n\t\t{\n\t\t\tlet regions = [];\n\t\t\tfor(let code in this.selectedRegions)\n\t\t\t{\n\t\t\t\tregions.push(this.selectedRegions[code].title);\n\t\t\t}\n\n\t\t\tsummary += `${Loc.getMessage('SEO_AD_BUILDER_REGION')}: ${regions.join(', ')}<br/>`;\n\t\t}\n\n\t\treturn summary;\n\t}\n\n\tsendToModeration(event)\n\t{\n\t\tthis.uiNodes.toModerationBtn.classList.add('ui-btn-wait');\n\n\t\tconst formNode = this.uiNodes.form;\n\n\t\tif (Object.keys(this.completedStages).length < 6)\n\t\t{\n\t\t\tfor (let i = this._STAGES.accountSelected; i <= this._STAGES.toModeration; i++)\n\t\t\t{\n\t\t\t\tif (!this.completedStages[i])\n\t\t\t\t{\n\t\t\t\t\tthis.scrollToStage(i);\n\t\t\t\t\tthis.uiNodes.toModerationBtn.classList.remove('ui-btn-wait');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.uiNodes.toModerationBtn.classList.remove('ui-btn-wait');\n\t\t\treturn;\n\t\t}\n\n\t\tconst instagramAccount = this.uiNodes.instagramAccount.options[\n\t\t\tthis.uiNodes.instagramAccount.selectedIndex\n\t\t\t].dataset;\n\n\t\tconst params = {\n\t\t\tclient_id: this.uiNodes.clientInput.value,\n\t\t\tbudget: formNode.budget.value,\n\t\t\tduration: formNode.duration.value,\n\t\t\ttargetUrl: formNode.targetUrl.value,\n\t\t\taccountId: this.uiNodes.account.value,\n\t\t\tinstagramAccountId: instagramAccount.actorId,\n\t\t\tpageId: instagramAccount.pageId,\n\t\t\tbody: this.postData.caption,\n\t\t\tmediaId: this.postData.id,\n\t\t\tpermalink: this.postData.permalink,\n\t\t\timageUrl: this.postData.media_url,\n\t\t\tcountries: this.selectedRegions,\n\t\t\tinterests: this.adCreatorData.audienceConfig.interests || [],\n\t\t\tageFrom: this.adCreatorData.audienceConfig.ageFrom || '',\n\t\t\tageTo: this.adCreatorData.audienceConfig.ageTo || '',\n\t\t\tgenders: this.adCreatorData.audienceConfig.genders || ''\n\t\t};\n\n\t\tconst form = document.getElementById('bx-sender-letter-edit')\n\t\t\t.querySelector('form');\n\n\t\tformNode.permalink.value = this.postData.permalink;\n\t\tformNode.pageId.value = params.pageId;\n\t\tformNode.body.value = this.postData.caption;\n\t\tformNode.mediaId.value = params.mediaId;\n\t\tformNode.imageUrl.value = params.imageUrl;\n\t\tformNode.instagramAccountId.value = params.instagramAccountId;\n\t\tformNode.interests.value = JSON.stringify(params.interests);\n\t\tformNode.ageFrom.value = params.ageFrom;\n\t\tformNode.ageTo.value = params.ageTo;\n\t\tformNode.genders.value = JSON.stringify(params.genders);\n\t\tformNode.regions.value = JSON.stringify(params.countries);\n\n\t\tconst include = this.adCreatorData.crmAudienceConfig.segmentInclude || [];\n\t\tconst exclude = this.adCreatorData.crmAudienceConfig.segmentExclude || [];\n\t\tfor (let i = 0; i < include.length; i++)\n\t\t{\n\t\t\tconst input = Tag.render`<input type=\"hidden\" name='SEGMENT[INCLUDE][]'>`;\n\t\t\tinput.value = include[i];\n\t\t\tform.appendChild(input);\n\t\t}\n\t\tfor (let i = 0; i < exclude.length; i++)\n\t\t{\n\t\t\tconst input = Tag.render`<input type=\"hidden\" name='SEGMENT[EXCLUDE][]'>`;\n\t\t\tinput.value = exclude[i];\n\t\t\tform.appendChild(input);\n\t\t}\n\n\t\tform.submit();\n\t}\n\n\tactivateStage(stageNum)\n\t{\n\t\tconst stage = document.querySelector(`[data-stage=\"${stageNum}\"]`);\n\t\tconst line = stage.querySelector('.crm-ads-new-campaign-item-line');\n\t\tconst number = stage.querySelector('.crm-ads-new-campaign-item-number');\n\t\tconst checker = stage.querySelector('.crm-ads-new-campaign-item-number-checker');\n\n\t\tif (line && number)\n\t\t{\n\t\t\tline.classList.remove('crm-ads-new-campaign-item--inactive');\n\t\t\tnumber.classList.remove('crm-ads-new-campaign-item--inactive');\n\t\t}\n\n\t\tif (checker)\n\t\t{\n\t\t\tchecker.style.display = 'block';\n\t\t}\n\n\t\tthis.completedStages[stageNum] = stageNum;\n\n\t\tif (Object.keys(this.completedStages).length === 5)\n\t\t{\n\t\t\tthis.activateStage(this._STAGES.toModeration);\n\t\t}\n\n\t\tif (Object.keys(this.completedStages).length < 5)\n\t\t{\n\t\t\tthis.deActivateStage(this._STAGES.toModeration);\n\t\t}\n\t}\n\n\tdeActivateStage(stageNum)\n\t{\n\t\tconst stage = document.querySelector(`[data-stage=\"${stageNum}\"]`);\n\t\tconst line = stage.querySelector('.crm-ads-new-campaign-item-line');\n\t\tconst number = stage.querySelector('.crm-ads-new-campaign-item-number');\n\t\tconst checker = stage.querySelector('.crm-ads-new-campaign-item-number-checker');\n\n\t\tif (line && number)\n\t\t{\n\t\t\tline.classList.add('crm-ads-new-campaign-item--inactive');\n\t\t\tnumber.classList.add('crm-ads-new-campaign-item--inactive');\n\t\t}\n\n\t\tif (checker)\n\t\t{\n\t\t\tchecker.style.display = 'none';\n\t\t}\n\n\t\tdelete (this.completedStages[stageNum]);\n\n\t\tif (Object.keys(this.completedStages).length < 6 && this.completedStages[this._STAGES.toModeration])\n\t\t{\n\t\t\tthis.deActivateStage(this._STAGES.toModeration);\n\t\t}\n\t}\n\n\tscrollToStage(stageNum)\n\t{\n\t\tconst stage = document.querySelector(`[data-stage=\"${stageNum}\"]`);\n\n\t\tstage.scrollIntoView({\n\t\t\tbehavior: 'smooth'\n\t\t});\n\t}\n\n\tbuildSelector()\n\t{\n\t\tconst selector = new TagSelector({\n\t\t\tid: 'seo-ads-regions',\n\t\t\tdialogOptions: {\n\t\t\t\tid: 'seo-ads-regions',\n\t\t\t\tcontext: 'SEO_ADS_REGIONS',\n\t\t\t\tdropdownMode: true,\n\t\t\t\tcompactView: true,\n\t\t\t\tshowAvatars: false,\n\t\t\t\twidth: 350,\n\t\t\t\theight: 250,\n\t\t\t\trecentTabOptions: {\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Loc.getMessage('UI_TAG_SELECTOR_START_INPUT')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: false\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': event => {\n\t\t\t\t\t\tconst data = event.data.item;\n\t\t\t\t\t\tthis.selectedRegions[data.id] = data;\n\t\t\t\t\t\tthis.uiNodes.audienceSummary.innerHTML = this.buildAudienceSummary();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'facebook_regions',\n\t\t\t\t\t\tsearchable: true,\n\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tclientId: this.uiNodes.clientInput.value\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t});\n\n\t\tselector.renderTo(document.getElementById('seo-ads-regions'));\n\t\tselector.getDialog().getRecentTab().setVisible(false)\n\t\tconst selectorOptions = {\n\t\t\tiblockId: this.iBlockId,\n\t\t\tbasePriceId: this.basePriceId,\n\t\t\tfileInputId: '',\n\t\t\tconfig: {\n\t\t\t\tENABLE_SEARCH: true,\n\t\t\t\tENABLE_IMAGE_CHANGE_SAVING: true\n\t\t\t}\n\t\t};\n\n\t\tthis.productSelector = new ProductSelector('facebook-product-selector', selectorOptions);\n\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onChange', this.productSelectedEvent.bind(this));\n\t}\n\n\tproductSelectedEvent(event)\n\t{\n\t\tconst fieldData = event.data.fields;\n\t\tthis.seoAccount._helper.request('getProductUrl', {\n\t\t\t\tid: fieldData.ID\n\t\t\t}, response => {\n\t\t\t\tdocument.querySelector('.seo-ads-target-url').textContent = response;\n\t\t\t\tthis.uiNodes.form.targetUrl.value = response;\n\t\t\t\tthis.activateStage(this._STAGES.pageSelected)\n\t\t\t}\n\t\t)\n\t}\n\n\ttoCreateStoreSlider()\n\t{\n\t\tif (!this.isCloud)\n\t\t{\n\t\t\tthis.openTargetPageSlider();\n\t\t\treturn;\n\t\t}\n\n\t\tconst sliderOptions = {\n\t\t\twidth: 990,\n\t\t\tcacheable: true,\n\t\t\tallowChangeHistory: false,\n\t\t\trequestMethod: 'get'\n\t\t};\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\t'/shop/stores/site/edit/0/?super=Y',\n\t\t\tsliderOptions\n\t\t);\n\t}\n}","import { Helper } from './helper';\nimport { Event, Loc, Tag } from \"main.core\";\nimport {type PostSelectorOptions} from './types/postselectoroptions'\nimport {TextCrop} from 'ui.textcrop';\n\nexport class SeoPostSelector\n{\n\t_accountId: string;\n\t_clientId: string;\n\t_type: string;\n\n\tconstructor(options: PostSelectorOptions)\n\t{\n\t\tthis.helper = Helper.getCreated();\n\t\tthis.last = null;\n\t\tthis.stopLoading = false;\n\t\tthis.loadInProgress = false;\n\t\tthis._accountId = options.accountId;\n\t\tthis._clientId = options.clientId;\n\t\tthis._type = options.type;\n\t\tthis.signedParameters = options.signedParameters;\n\t\tthis.emptyBlock = document.querySelector('.seo-ads-empty-post-list-block');\n\t\tthis.listContent = document.querySelector('.crm-order-instagram-view-list');\n\t\tthis.dataContent = [];\n\t\tthis.loader = new BX.Loader({\n\t\t\ttarget: document.querySelector(\".crm-order-instagram-view\")\n\t\t});\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tthis.hideListContentBlock();\n\t\tconst topSlider = BX.SidePanel.Instance.getTopSlider().iframe.contentDocument;\n\n\t\tconst observer = new IntersectionObserver(this.loadPostList.bind(this), {\n\t\t\troot: topSlider,\n\t\t\trootMargin: '0px',\n\t\t\tthreshold: 1.0\n\t\t});\n\n\t\tobserver.observe(this.listContent)\n\n\t\tthis.loadPostList();\n\n\t}\n\n\tloadPostList()\n\t{\n\t\tif(this.loadInProgress)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.stopLoading)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.loader.show();\n\n\t\tthis.loadInProgress = true;\n\t\tconst requestData = {\n\t\t\t'clientId': this._clientId || null,\n\t\t\t'type': this._type || null,\n\t\t\t'accountId': this._accountId || null,\n\t\t\t'last': this.last\n\t\t};\n\n\t\tBX.ajax.runComponentAction('bitrix:seo.ads.builder', 'getPostList', {\n\t\t\t'mode': 'class',\n\t\t\t'signedParameters': this.signedParameters,\n\t\t\t'data': requestData\n\t\t}).then(\n\t\t\tresponse => {\n\t\t\t\tconst data = response.data || {};\n\t\t\t\tif (data.error)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.successFn.apply(this, [data]);\n\t\t\t\t}\n\t\t\t\tthis.loadInProgress = false;\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tconst data = { 'error': true, 'text': '' };\n\t\t\t\tthis.loadInProgress = false;\n\t\t\t\tthis.loader.hide();\n\t\t\t}\n\t\t);\n\n\t}\n\n\tshowEmptyListBlock()\n\t{\n\t\tthis.emptyBlock.style.display = 'block';\n\t}\n\n\thideEmptyListBlock()\n\t{\n\t\tthis.emptyBlock.style.display = 'none';\n\t}\n\n\tshowListContentBlock()\n\t{\n\t\tthis.listContent.parentNode.style.display = 'block';\n\t}\n\n\thideListContentBlock()\n\t{\n\t\tthis.listContent.parentNode.style.display = 'none';\n\t}\n\n\tsuccessFn(response)\n\t{\n\t\tconst data = response.data;\n\t\tif (this.clientSelector)\n\t\t{\n\t\t\tthis.clientSelector.enable();\n\t\t}\n\n\t\tdata.postList.forEach(postListItem => {\n\t\t\t\tconst postBlock = Tag.render`\n\t\t\t\t\t<label class=\"crm-order-instagram-view-item\" id=\"instItemID_${postListItem.id}\">\n\t\t\t\t\t\t<div class=\"crm-order-instagram-view-item-detail\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<span class=\"crm-order-instagram-view-item-img\" style=\"background-image: url(${postListItem.media_url})\"></span>\n\t\t\t\t\t\t\t\t<span class=\"crm-order-instagram-decal-container\">\n\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t<svg width=\"67\" height=\"16\" viewBox=\"0 0 67 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t\t\t\t<path d=\"M48.6026 0.306715C54.4273 0.290801 60.2679 0.306716 66.1244 0.290802C63.0688 5.35159 60.0292 10.3805 56.9736 15.4413C56.9577 15.3777 56.9418 15.3299 56.9418 15.2981C56.7508 13.9931 56.5439 12.6722 56.353 11.3672C56.162 10.0782 55.971 8.78911 55.7641 7.50004C55.6845 6.95895 55.605 6.41785 55.5254 5.86085C55.5095 5.74945 55.4458 5.66988 55.3503 5.60622C54.8252 5.19245 54.3 4.77867 53.7589 4.36489C52.0879 3.05991 50.401 1.75493 48.7299 0.449946C48.6822 0.402203 48.6345 0.370374 48.5708 0.32263C48.5867 0.338545 48.5867 0.322629 48.6026 0.306715ZM56.4962 5.66988C56.8463 7.96156 57.1805 10.2532 57.5306 12.5449C57.642 12.4335 63.976 1.96182 64.0078 1.81859C61.4933 3.10765 58.9947 4.38081 56.4962 5.66988ZM62.7824 1.34115C62.7824 1.32524 62.7665 1.32524 62.7665 1.30932C62.3845 1.2775 51.6105 1.2775 51.4672 1.32524C52.9791 2.50291 54.4751 3.66466 55.971 4.82641C58.2468 3.66466 60.5066 2.50291 62.7824 1.34115Z\" fill=\"#999\"/>\n\t\t\t\t\t\t\t\t\t\t\t<path d=\"M9.46094 15.2344C8.60547 14.3984 4.79192 10.6375 2.65772 8.51853C2.49858 8.3753 2.35535 8.21616 2.21212 8.05702C1.44823 7.26129 1.03445 6.32234 0.954879 5.24016C0.859393 4.01475 1.1936 2.91666 1.95749 1.96179C2.67364 1.07058 3.59667 0.481747 4.74251 0.306688C6.66816 0.00431397 8.19594 0.672722 9.34178 2.24825C9.37361 2.28008 9.38952 2.31191 9.40544 2.34374C9.40544 2.34374 9.42135 2.35965 9.45318 2.37556C9.48501 2.32782 9.53275 2.26416 9.5805 2.21642C10.2012 1.34113 11.0128 0.752293 12.0313 0.434004C12.4769 0.290774 12.9384 0.258947 13.4 0.258947C14.0206 0.258947 14.6095 0.370347 15.1665 0.640892C16.5828 1.29338 17.49 2.37556 17.8242 3.88743C18.1425 5.31973 17.8242 6.64063 16.933 7.80238C16.7738 8.00927 16.5828 8.18433 16.3919 8.37531C14.9277 9.82352 13.4795 11.2717 12.0154 12.7199C11.1923 13.543 10.2422 14.4922 9.46094 15.2344ZM9.42135 13.818C9.51684 13.7226 9.61233 13.643 9.6919 13.5634C10.233 13.0223 10.79 12.4812 11.3311 11.9401C12.827 10.4601 14.3389 8.98005 15.8349 7.4841C15.9622 7.3727 16.0736 7.24538 16.1691 7.10215C17.0125 5.95631 17.1717 4.71498 16.6306 3.39409C15.9622 1.77081 14.1479 0.879609 12.4292 1.32521C11.5539 1.54801 10.8537 2.04136 10.3444 2.78934C10.0579 3.21903 9.8033 3.64872 9.51684 4.07841C9.48501 4.12615 9.45318 4.1739 9.42135 4.23755C9.3577 4.14207 9.30995 4.07841 9.26221 3.99884C8.99166 3.58506 8.73703 3.15537 8.46649 2.7416C7.65485 1.56393 6.19073 0.975095 4.80617 1.27747C2.60998 1.7549 1.40048 3.99883 2.13255 6.09954C2.32352 6.64063 2.64181 7.10215 3.05558 7.51593C3.81948 8.2639 4.58337 9.01188 5.33135 9.75986C6.58859 11.0012 7.84583 12.2584 9.11898 13.4997C9.21447 13.6111 9.30995 13.7066 9.42135 13.818Z\" fill=\"#999\"/>\n\t\t\t\t\t\t\t\t\t\t\t<path d=\"M41.4411 14.9002C41.282 14.8843 41.1387 14.8684 40.9796 14.8525C40.343 14.7888 39.7223 14.7093 39.0858 14.6456C38.5447 14.5819 38.0195 14.5501 37.4784 14.4705C37.2874 14.4546 37.1442 14.4865 36.9851 14.566C36.2371 14.9002 35.4414 15.1071 34.6297 15.1708C32.9269 15.2981 31.3354 14.948 29.8872 14.009C28.5504 13.1337 27.5796 11.9561 26.9749 10.476C26.7043 9.82352 26.5452 9.13921 26.4815 8.43897C26.3383 6.60881 26.7203 4.92188 27.7865 3.42593C28.9642 1.77082 30.5397 0.736386 32.529 0.35444C32.9269 0.274868 33.3407 0.227125 33.7385 0.243039C34.0727 0.258954 34.4069 0.243039 34.7411 0.274868C35.7278 0.370354 36.6668 0.656814 37.5262 1.15016C39.2927 2.13686 40.4862 3.60098 41.1069 5.54254C41.3138 6.19503 41.4093 6.86344 41.4252 7.54776C41.457 8.50263 41.2979 9.40975 40.9796 10.301C40.9478 10.3964 40.9478 10.4919 40.9478 10.5874C41.0432 11.4627 41.1387 12.338 41.2342 13.1974C41.2979 13.7066 41.3456 14.2159 41.4093 14.7411C41.4411 14.7888 41.4411 14.8366 41.4411 14.9002ZM40.3271 13.8021C40.3271 13.7544 40.3271 13.7385 40.3271 13.7226C40.2793 13.2292 40.2157 12.7518 40.1679 12.2584C40.1043 11.6537 40.0406 11.0649 39.977 10.4601C39.9611 10.3487 39.977 10.2691 40.0088 10.1577C40.4385 9.09146 40.5499 7.97745 40.4226 6.84753C40.3271 6.03589 40.0725 5.272 39.6587 4.57177C38.3219 2.1846 35.7119 0.895532 33.0065 1.29339C31.7333 1.48437 30.6193 2.00954 29.6644 2.853C27.8502 4.46036 27.0863 6.83161 27.6274 9.18695C28.0889 11.1444 29.2347 12.5926 31.0012 13.5316C31.7492 13.9294 32.5449 14.1522 33.3884 14.2159C33.8499 14.2477 34.2955 14.2477 34.757 14.2C35.505 14.1045 36.2212 13.8817 36.9055 13.5475C37.0487 13.4838 37.176 13.4679 37.3352 13.4838C37.6694 13.5316 37.9877 13.5634 38.3219 13.5952C38.7675 13.643 39.2131 13.6907 39.6587 13.7385C39.8656 13.7544 40.0884 13.7703 40.3271 13.8021Z\" fill=\"#999\"/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t<svg width=\"13\" height=\"14\" viewBox=\"0 0 13 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M6.145 8.0856L0.5 13.7847V0.5H12.5V13.7847L6.855 8.0856L6.5 7.727L6.145 8.0856Z\" stroke=\"#999\"/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<div class=\"crm-order-instagram-view-item-decs-block\">\n\t\t\t\t\t\t\t\t\t<div class=\"crm-order-instagram-view-item-decs\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"crm-order-instagram-view-item-name\">${BX.util.htmlspecialchars(postListItem.caption||'')}</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"crm-order-instagram-view-item-edit\"></span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"crm-order-instagram-view-item-checkbox-container\">\n\t\t\t\t\t\t\t\t<input class=\"crm-order-instagram-view-item-input\" \n\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\" \n\t\t\t\t\t\t\t\t\t\tid=\"${postListItem.id}\" \n\t\t\t\t\t\t\t\t\t\tdata-id=\"${postListItem.id}\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"crm-order-instagram-view-item-input-title\">${Loc.getMessage('SEO_AD_BUILDER_POST_SELECTOR_SELECT')}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-order-instagram-view-item-selected-icon\">\n\t\t\t\t\t\t\t<svg width=\"13\" height=\"10\" viewBox=\"0 0 13 10\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M4.87744 6.02868L10.9842 0L12.8322 1.85828L4.90632 9.7162L4.87744 9.68717L4.84857 9.7162L0 5.02339L1.84802 3.16511L4.87744 6.02868Z\" fill=\"white\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>`;\n\t\t\t\tthis.listContent.appendChild(postBlock);\n\n\t\t\t\tEvent.bind(postBlock, 'click', this.selectPost.bind(this));\n\n\t\t\t\tthis.dataContent[postListItem.id] = postListItem;\n\t\t\t\tthis.showListContentBlock();\n\n\t\t\t\tconst text = new BX.UI.TextCrop({\n\t\t\t\t\trows: 3,\n\t\t\t\t\ttarget: postBlock.querySelector('.crm-order-instagram-view-item-name'),\n\t\t\t\t});\n\t\t\t\ttext.init();\n\t\t\t}\n\t\t);\n\n\t\tthis.loader.hide();\n\n\t\tif (data.last)\n\t\t{\n\t\t\tthis.last = data.last;\n\t\t\treturn;\n\t\t}\n\n\t\tif(Object.keys(this.dataContent).length === 0)\n\t\t{\n\t\t\tthis.hideListContentBlock();\n\t\t\tthis.showEmptyListBlock();\n\t\t}\n\n\t\tthis.stopLoading = true;\n\t}\n\n\tselectPost(event)\n\t{\n\t\tconst targetElement = event.target;\n\t\tconst id = targetElement.dataset.id;\n\n\t\tdocument.querySelectorAll('.crm-order-instagram-view-item-input').forEach(\n\t\t\telement => {\n\t\t\t\telement.checked = id === element.dataset.id;\n\t\t\t}\n\t\t)\n\n\t\tdocument.querySelectorAll('.crm-order-instagram-view-item').forEach(\n\t\t\telement => {\n\t\t\t\tBX.removeClass(element, \"crm-order-instagram-view-item-selected\")\n\t\t\t}\n\t\t)\n\n\t\tBX.addClass(document.querySelector('#instItemID_' + id), \"crm-order-instagram-view-item-selected\");\n\n\t\tBX.SidePanel.Instance.close();\n\n\t\tBX.SidePanel.Instance.postMessage(\n\t\t\twindow,\n\t\t\t'seo-ads-post-selected',\n\t\t\tthis.dataContent[id]\n\t\t);\n\t}\n}","import { Helper } from './helper';\nimport { Event, Loc } from \"main.core\";\nimport {type PostSelectorOptions} from './types/postselectoroptions'\nimport { TagSelector } from 'ui.entity-selector';\n\nexport class SeoAudience\n{\n\t_accountId: string;\n\t_clientId: string;\n\t_type: string;\n\n\tconstructor(options: PostSelectorOptions)\n\t{\n\t\tthis.helper = Helper.getCreated();\n\t\tthis.last = null;\n\t\tthis._accountId = options.accountId;\n\t\tthis._clientId = options.clientId;\n\t\tthis._type = options.type;\n\t\tthis.signedParameters = options.signedParameters;\n\t\tthis.emptyBlock = document.querySelector('.seo-ads-empty-post-list-block');\n\t\tthis.listContent = document.querySelector('.crm-order-instagram-view-list');\n\t\tthis.dataContent = [];\n\t\tthis.selectedInterest = {};\n\t\tthis.loader = new BX.Loader({\n\t\t\ttarget: document.querySelector(\".crm-order-instagram-view\")\n\t\t});\n\n\t\tthis.rangeInput = document.querySelector('.crm-ads-new-campaign-item-runner-value');\n\t\tthis.inputMax = BX('max');\n\t\tthis.inputMin = BX('min');\n\t\tthis.MAX_VALUE = 65;\n\t\tthis.MIN_VALUE = 13;\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tdocument.querySelectorAll('.crm-ads-new-campaign-item-runner-input').forEach(element => {\n\t\t\tconst block = element.closest('.crm-ads-new-campaign-item-runner-block--double');\n\t\t\tif (block)\n\t\t\t{\n\t\t\t\tthis.setDoubleInputPosition();\n\t\t\t\tthis.setDoubleLabelPosition(element);\n\t\t\t\tEvent.bind(element, 'change', this.onDoubleInputRange.bind(this));\n\t\t\t\tEvent.bind(element, 'input', this.onDoubleInputRange.bind(this));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEvent.bind(element, 'change', this.onInputRange.bind(this));\n\t\t\t\tEvent.bind(element, 'input', this.onInputRange.bind(this));\n\t\t\t}\n\t\t});\n\n\t\tthis.buildSelector();\n\t}\n\n\tcheckSex()\n\t{\n\n\t}\n\n\tonInputRange(event)\n\t{\n\t\tconst label = event.target.closest('.crm-ads-new-campaign-item-runner-block').children[0].children[0];\n\t\tconst value = event.target.value;\n\n\t\tif(value < this.MIN_VALUE)\n\t\t{\n\t\t\tevent.target.value = this.MIN_VALUE;\n\t\t}\n\n\t\tlabel.textContent = event.target.value;\n\t\tthis.rangeInput.style.width = event.target.offsetWidth * event.target.value/65 +\"px\";\n\t}\n\n\tonDoubleInputRange(event)\n\t{\n\t\tthis.setDoubleLabelPosition(event.target);\n\t\tthis.setDoubleInputPosition();\n\n\t}\n\n\tsetDoubleLabelPosition (element)\n\t{\n\t\tconst value = element.value;\n\t\tconst label = element.previousElementSibling;\n\n\t\tif (value < this.MIN_VALUE)\n\t\t{\n\t\t\telement.value = this.MIN_VALUE;\n\t\t}\n\n\t\tlabel.children[0].textContent = element.value;\n\t\tlabel.style.left = (((value - this.MIN_VALUE) / (this.MAX_VALUE - this.MIN_VALUE)) * (element.offsetWidth - 70)) + 20 + 'px';\n\n\t}\n\n\tsetDoubleInputPosition()\n\t{\n\t\tconst labelMaxLeft = BX('label-max').getBoundingClientRect().left;\n\t\tconst labelMinLeft = BX('label-min').getBoundingClientRect().left;\n\n\t\tconst min = Math.min(labelMaxLeft, labelMinLeft);\n\n\t\tif (labelMaxLeft === min)\n\t\t{\n\t\t\tthis.rangeInput.style.width = ((((this.inputMin.value - this.MIN_VALUE)/ (this.MAX_VALUE - this.MIN_VALUE)) * (this.inputMin.offsetWidth - 40)) + 20)\n\t\t\t\t- ((((this.inputMax.value - this.MIN_VALUE)/ (this.MAX_VALUE - this.MIN_VALUE)) * (this.inputMax.offsetWidth - 40)) + 20) + 'px';\n\t\t\tthis.rangeInput.style.left = (((this.inputMax.value - this.MIN_VALUE)/ (this.MAX_VALUE- this.MIN_VALUE)) * (this.inputMax.offsetWidth - 40)) + 20 + 'px';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.rangeInput.style.width = ((((this.inputMax.value - this.MIN_VALUE)/ (this.MAX_VALUE - this.MIN_VALUE)) * (this.inputMax.offsetWidth - 40)) + 20)\n\t\t\t\t- ((((this.inputMin.value - this.MIN_VALUE)/ (this.MAX_VALUE - this.MIN_VALUE)) * (this.inputMin.offsetWidth - 40)) + 20) + 'px';\n\n\t\t\tthis.rangeInput.style.left = (((this.inputMin.value - this.MIN_VALUE) / (this.MAX_VALUE - this.MIN_VALUE)) * (this.inputMin.offsetWidth - 40)) + 20 + 'px';\n\t\t}\n\t}\n\n\tbuildSelector()\n\t{\n\t\tconst selector = new TagSelector({\n\t\t\tid: 'seo-ads-interests',\n\t\t\tdialogOptions: {\n\t\t\t\tid: 'seo-ads-interests',\n\t\t\t\tcontext: 'SEO_ADS_INTERESTS',\n\t\t\t\tdropdownMode: true,\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: false\n\t\t\t\t},\n\t\t\t\twidth: 350,\n\t\t\t\theight: 250,\n\t\t\t\trecentTabOptions: {\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Loc.getMessage('UI_TAG_SELECTOR_START_INPUT'),\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': event => {\n\t\t\t\t\t\tconst data = event.data.item;\n\t\t\t\t\t\tthis.selectedInterest[data.id] = data;\n\t\t\t\t\t\tlet sum = 0;\n\n\t\t\t\t\t\tfor (let key in this.selectedInterest)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsum += this.selectedInterest[key].customData.get('audienceSize');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdocument.querySelector('.crm-ads-new-campaign-item-cost-value').textContent = sum;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'facebook_interests',\n\t\t\t\t\t\tsearchable: true,\n\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tclientId: this._clientId\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t}\n\t\t});\n\n\t\tselector.renderTo(document.getElementById('seo-ads-interests'));\n\t}\n\n\tshowEmptyListBlock()\n\t{\n\t\tthis.emptyBlock.style.display = 'block';\n\t}\n\n\thideEmptyListBlock()\n\t{\n\t\tthis.emptyBlock.style.display = 'none';\n\t}\n\n\tshowListContentBlock()\n\t{\n\t\tthis.listContent.parentNode.style.display = 'block';\n\t}\n\n\thideListContentBlock()\n\t{\n\t\tthis.listContent.parentNode.style.display = 'none';\n\t}\n\n\tapply()\n\t{\n\t\tconst applyBtn = document.getElementById('ui-button-panel-apply');\n\n\t\tBX.SidePanel.Instance.close();\n\t\tlet genders = [];\n\t\tlet genderTitles = [];\n\n\t\tif(document.getElementById('male').checked)\n\t\t{\n\t\t\tgenders.push(1);\n\t\t\tgenderTitles.push(document.getElementById('male').parentNode.querySelector('span').innerText);\n\t\t}\n\n\t\tif(document.getElementById('female').checked)\n\t\t{\n\t\t\tgenders.push(2);\n\t\t\tgenderTitles.push(document.getElementById('female').parentNode.querySelector('span').innerText);\n\t\t}\n\n\t\tlet interests = []\n\t\tObject.entries(this.selectedInterest).forEach(entry => {\n\t\t\tconst [key, value] = entry;\n\t\t\tinterests.push({\n\t\t\t\tid: value.id,\n\t\t\t\tname: value.title,\n\t\t\t})\n\t\t});\n\n\t\tBX.SidePanel.Instance.postMessage(\n\t\t\twindow,\n\t\t\t'seo-fb-audience-configured',\n\t\t\t{\n\t\t\t\tinterests: interests,\n\t\t\t\tageFrom: this.inputMin.value,\n\t\t\t\tageTo: this.inputMax.value,\n\t\t\t\tgenderTitles: genderTitles,\n\t\t\t\tgenders: genders\n\t\t\t}\n\t\t);\n\t\tdocument.getElementById('ui-button-panel-apply').classList.remove('ui-btn-wait');\n\t}\n}","export class SeoCrmAudience\n{\n\tstatic apply(applyBtn)\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t\tBX.SidePanel.Instance.postMessage(\n\t\t\twindow,\n\t\t\t'seo-crm-audience-configured',\n\t\t\t{\n\t\t\t\tsegmentInclude: window.senderSegmentSelector.selectorInclude.selector.getTilesId() || [],\n\t\t\t\tsegmentExclude: window.senderSegmentSelector.selectorExclude.selector.getTilesId() || []\n\t\t\t}\n\t\t);\n\n\t\tsetTimeout(() => {\n\t\t\tapplyBtn.classList.remove('ui-btn-wait')\n\t\t}, 200)\n\t}\n}","import { Helper } from './helper';\n\nexport class PageConfiguration\n{\n\n\tconstructor()\n\t{\n\t\tthis.helper = Helper.getCreated();\n\t\tthis.targetUrlBlock = document.querySelector('.seo-ads-target-url');\n\n\t\treturn this;\n\t}\n\n\tapply(applyBtn)\n\t{\n\t\tif(!this.validateUrl(this.targetUrlBlock.value))\n\t\t{\n\t\t\tthis.removeWait(applyBtn);\n\t\t\treturn;\n\t\t}\n\n\t\tBX.SidePanel.Instance.close();\n\n\t\tBX.SidePanel.Instance.postMessage(\n\t\t\twindow,\n\t\t\t'seo-ads-target-post-selected',\n\t\t\t{\n\t\t\t\ttargetUrl: this.targetUrlBlock.value\n\t\t\t}\n\t\t);\n\t\tthis.removeWait(applyBtn);\n\t}\n\n\tremoveWait(applyBtn)\n\t{\n\t\tsetTimeout(() => {\n\t\t\tapplyBtn.classList.remove('ui-btn-wait')\n\t\t}, 200);\n\t}\n\n\tcancel()\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t}\n\n\tvalidateUrl(value)\n\t{\n\t\treturn /^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i.test(value);\n\t}\n}"],"names":["SeoAccount","options","clientNode","avatarNode","accountNode","instagramAccountNode","linkNode","provider","componentName","signedParameters","uiNodes","_helper","Helper","getInstance","loaded","clientSelector","BX","Seo","Ads","ClientSelector","clientBlock","selected","PROFILE","items","CLIENTS","canAddItems","events","onNewItem","LoginFactory","getLoginObject","login","onSelectItem","item","setProfile","onRemoveItem","logout","CLIENT_ID","addCustomEvent","window","proxy","onSeoAuth","eventData","reload","getProvider","clientId","analyticsLabel","TYPE","connect","action","type","showBlock","request","logoutClientId","setSelected","setItems","setProvider","showBlockByAuth","i","length","client","toString","disable","data","enable","accountNotice","ad","style","display","dropDownData","map","accountData","caption","util","htmlspecialchars","name","value","id","accountId","currency","fillDropDownControl","setTimeout","fireEvent","disabled","instagram","pageId","page_id","actorId","actor_id","isSupportAccount","IS_SUPPORT_ACCOUNT","includes","push","loadAccounts","loadInstagramAccounts","showBlockMain","seoAccount","containerNode","mess","errorAction","Loc","getMessage","dlgBtnClose","requestData","callback","analytics","sendActionRequest","response","onResponse","error","apply","callbackSuccess","callbackFailure","showErrorPopup","ajax","runComponentAction","mode","then","console","log","text","popup","PopupManager","create","autoHide","lightShadow","closeByEsc","overlay","backgroundColor","opacity","onErrorPopupClose","bind","buttons","Button","click","close","setContent","show","blockCodes","Type","isArray","attributeBlock","blockNodes","querySelectorAll","forEach","blockNode","code","getAttribute","isShow","dataset","flex","btn","AUTH_URL","setAttribute","PICTURE","nameNode","innerText","NAME","LINK","removeAttribute","loadSettings","HAS_AUTH","showBlockLogin","node","innerHTML","option","Tag","render","appendChild","_instance","undefined","SeoAdBuilder","accountSelected","postSelected","pageSelected","audienceSelected","budgetSelected","toModeration","optionSelectedClass","containerId","context","onRequest","postListUrl","audienceUrl","crmAudienceUrl","pageConfigurationUrl","iBlockId","basePriceId","storeExists","isCloud","baseCurrency","arrows","document","price","_DEFAULT_CURRENCY","duration","completedStages","selectedRegions","loader","init","caller","change","loaderNode","inputNode","initiateUINodes","initiateAutoAudienceMode","_STAGES","deActivateStage","initiateAccounts","activateStage","initiateSwitcher","bindEvents","buildSelector","storeBlockShow","adCreatorData","audienceConfig","crmAudienceConfig","clientInput","avatar","link","account","instagramAccount","profileConfigured","Event","addPost","openPostSlider","createLinks","createLink","hasPostLis","showBlockRefresh","refreshButton","autoRemover","checker","select","checked","addClientBtn","_this","arrow","addEventListener","switchCollapsed","checkCurrency","div","calculateTotal","changeAudienceMode","changeProductSelectionMode","audienceExpert","showAudienceExpertModeForm","productExpert","openTargetPageSlider","addProductBtn","toCreateStoreSlider","addCurrencyBtn","addCurrency","toModerationBtn","sendToModeration","UI","Hint","querySelector","convert","nodeListToArray","Switcher","size","usedCurrency","selectedIndex","currencyExists","event","checkInstagramAccount","target","parentNode","total","element","textContent","classList","remove","add","form","budget","prepareCurrencyBlocks","scrollToStage","showCrmAudienceExpertModeForm","isShown","adsStoreBlock","key","convertToCurrency","targetCurrency","sourceCurrency","amount","Object","keys","prepareCurrencyBlock","exists","currencyBlock","count","course","newCurrency","amountCnt","success","block","closest","content","contains","height","scrollHeight","title","nodeHeight","cleanNode","titleInner","a","offsetHeight","slice","eventId","media_url","postItem","postListNode","addNewNode","previewNode","firstChild","removeChild","insertBefore","backgroundImage","postData","clipTitle","openSlider","sessid","bitrix_sessid","componentParams","ACCOUNT_ID","onPostSelected","targetUrl","reInitAdCreator","audienceSummary","buildAudienceSummary","cacheable","onTargetPageSelected","url","params","sliderOptions","width","allowChangeHistory","requestMethod","requestParams","eventName","SidePanel","Slider","getEventFullName","removeAllCustomEvents","Instance","open","onFBAudienceConfigured","onCrmAudienceConfigured","genders","ageFrom","ageTo","summary","genderTitles","join","interests","interest","segmentInclude","regions","formNode","client_id","instagramAccountId","body","mediaId","permalink","imageUrl","countries","getElementById","JSON","stringify","include","exclude","segmentExclude","input","submit","stageNum","stage","line","number","scrollIntoView","behavior","selector","TagSelector","dialogOptions","dropdownMode","compactView","showAvatars","recentTabOptions","stub","stubOptions","searchOptions","allowCreateItem","entities","searchable","dynamicSearch","renderTo","getDialog","getRecentTab","setVisible","selectorOptions","iblockId","fileInputId","config","ENABLE_SEARCH","ENABLE_IMAGE_CHANGE_SAVING","productSelector","ProductSelector","EventEmitter","subscribe","productSelectedEvent","fieldData","fields","ID","SeoPostSelector","helper","getCreated","last","stopLoading","loadInProgress","_accountId","_clientId","_type","emptyBlock","listContent","dataContent","Loader","hideListContentBlock","topSlider","getTopSlider","iframe","contentDocument","observer","IntersectionObserver","loadPostList","root","rootMargin","threshold","observe","successFn","hide","postList","postListItem","postBlock","selectPost","showListContentBlock","TextCrop","rows","showEmptyListBlock","targetElement","removeClass","addClass","postMessage","SeoAudience","selectedInterest","rangeInput","inputMax","inputMin","MAX_VALUE","MIN_VALUE","setDoubleInputPosition","setDoubleLabelPosition","onDoubleInputRange","onInputRange","label","children","offsetWidth","previousElementSibling","left","labelMaxLeft","getBoundingClientRect","labelMinLeft","min","Math","sum","customData","get","applyBtn","entries","entry","SeoCrmAudience","senderSegmentSelector","selectorInclude","getTilesId","selectorExclude","PageConfiguration","targetUrlBlock","validateUrl","removeWait","test"],"mappings":"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"}