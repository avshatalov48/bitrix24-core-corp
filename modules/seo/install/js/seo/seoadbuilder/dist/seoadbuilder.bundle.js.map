{"version":3,"file":"seoadbuilder.bundle.js","sources":["../src/seoaccount.js","../src/helper.js","../src/seoadbuilder.js","../src/seopostselector.js","../src/seoaudience.js","../src/seocrmaudience.js","../src/pageconfiguration.js"],"sourcesContent":["import { Helper } from './helper';\nimport { type AccountFields } from './types/account';\n\nexport class SeoAccount\n{\n\t_helper: Helper;\n\tconstructor(options: AccountFields): SeoAccount\n\t{\n\t\tthis.clientNode = options.clientNode;\n\t\tthis.avatarNode = options.avatarNode;\n\t\tthis.accountNode = options.accountNode;\n\t\tthis.instagramAccountNode = options.instagramAccountNode;\n\t\tthis.linkNode = options.linkNode;\n\t\tthis.provider = options.provider;\n\t\tthis.componentName = options.componentName;\n\t\tthis.signedParameters = options.signedParameters;\n\t\tthis.uiNodes = options.uiNodes;\n\t\tthis._helper = Helper.getInstance(this, []);\n\t\tthis.loaded = [];\n\n\t\tthis.clientSelector = new BX.Seo.Ads.ClientSelector(options.clientBlock, {\n\t\t\tselected: this.provider.PROFILE,\n\t\t\titems: this.provider.CLIENTS,\n\t\t\tcanAddItems: true,\n\t\t\tevents: {\n\t\t\t\tonNewItem: () => {\n\t\t\t\t\tBX.util.popup(this.provider.AUTH_URL, 800, 600);\n\t\t\t\t},\n\t\t\t\tonSelectItem: item => {\n\t\t\t\t\tthis.setProfile(item);\n\t\t\t\t},\n\t\t\t\tonRemoveItem: item => {\n\t\t\t\t\tthis.logout(item.CLIENT_ID);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn this;\n\t}\n\n\tlistenSeoAuth()\n\t{\n\t\tBX.addCustomEvent(\n\t\t\twindow,\n\t\t\t'seo-client-auth-result',\n\t\t\tBX.proxy(this.onSeoAuth, this)\n\t\t);\n\t}\n\n\tonSeoAuth(eventData)\n\t{\n\t\teventData.reload = false;\n\t\tthis.getProvider(eventData.clientId);\n\t}\n\n\tlogout(clientId)\n\t{\n\t\tthis._helper.showBlock('loading');\n\t\tthis._helper.request('logout', { logoutClientId: clientId }, provider =>\n\t\t\t{\n\t\t\t\tthis.provider = provider;\n\t\t\t\tif (this.clientSelector)\n\t\t\t\t{\n\t\t\t\t\tthis.clientSelector.setSelected(this.provider.PROFILE);\n\t\t\t\t\tthis.clientSelector.setItems(this.provider.CLIENTS);\n\t\t\t\t}\n\t\t\t\tthis._helper.setProvider(provider);\n\t\t\t\tthis._helper.showBlockByAuth();\n\t\t\t}\n\t\t);\n\t}\n\n\tgetProvider(clientId)\n\t{\n\t\tthis.showBlock('loading');\n\t\tthis.request('getProvider', {}, provider => {\n\t\t\tthis.provider = provider;\n\n\t\t\tif (this.clientSelector)\n\t\t\t{\n\t\t\t\tif (!this.provider.PROFILE ||\n\t\t\t\t\t(clientId && clientId !== this.provider.PROFILE.CLIENT_ID)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\t// set PROFILE equal to clientId or first record from CLIENTS:\n\t\t\t\t\tfor (let i = 0; i < this.provider.CLIENTS.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet client = this.provider.CLIENTS[i];\n\n\t\t\t\t\t\tif (!clientId || clientId.toString() === client.CLIENT_ID.toString())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setProfile(client);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.clientSelector.setSelected(this.provider.PROFILE);\n\t\t\t\tthis.clientSelector.setItems(this.provider.CLIENTS);\n\t\t\t}\n\t\t\tthis.showBlockByAuth();\n\t\t});\n\t}\n\n\tloadAccounts(type)\n\t{\n\t\t// this.loader.forAccount(true);\n\t\tif (this.clientSelector)\n\t\t{\n\t\t\tthis.clientSelector.disable();\n\t\t}\n\n\t\tthis._helper.request('getAccounts', {}, data => {\n\t\t\t\tif (this.clientSelector)\n\t\t\t\t{\n\t\t\t\t\tthis.clientSelector.enable();\n\t\t\t\t}\n\n\t\t\t\tthis.uiNodes.accountNotice.ad.style.display = 'none';\n\t\t\t\tif (!data.length)\n\t\t\t\t{\n\t\t\t\t\tthis.uiNodes.accountNotice.ad.style.display = 'block';\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst dropDownData = data.map(accountData => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcaption: accountData.name,\n\t\t\t\t\t\tvalue: accountData.id,\n\t\t\t\t\t\tselected: accountData.id === this.accountId,\n\t\t\t\t\t\tcurrency: accountData.currency\n\t\t\t\t\t};\n\t\t\t\t}, this);\n\n\t\t\t\tthis._helper.fillDropDownControl(this.accountNode, dropDownData);\n\t\t\t\tif (dropDownData.length > 0)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tBX.fireEvent(this.accountNode, 'change');\n\t\t\t\t\t}, 150);\n\t\t\t\t}\n\t\t\t\tthis.accountNode.disabled = false\n\n\t\t\t}\n\t\t);\n\t}\n\n\tloadInstagramAccounts(type)\n\t{\n\t\tif (this.clientSelector)\n\t\t{\n\t\t\tthis.clientSelector.disable();\n\t\t}\n\n\t\tthis._helper.request('getInstagramAccounts', {}, data => {\n\t\t\t\tif (this.clientSelector)\n\t\t\t\t{\n\t\t\t\t\tthis.clientSelector.enable();\n\t\t\t\t}\n\n\t\t\t\tthis.uiNodes.accountNotice.instagram.style.display = 'none';\n\t\t\t\tif (!data.length)\n\t\t\t\t{\n\t\t\t\t\tthis.uiNodes.accountNotice.instagram.style.display = 'block';\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst dropDownData = data.map(accountData => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcaption: accountData.name,\n\t\t\t\t\t\tvalue: accountData.id,\n\t\t\t\t\t\tpageId: accountData.page_id,\n\t\t\t\t\t\tactorId: accountData.actor_id\n\t\t\t\t\t};\n\t\t\t\t}, this);\n\n\t\t\t\tthis._helper.fillDropDownControl(this.instagramAccountNode, dropDownData);\n\t\t\t\tif (dropDownData.length > 0)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tBX.fireEvent(this.instagramAccountNode, 'change');\n\t\t\t\t\t}, 150);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\n\t\t\t\t}\n\n\t\t\t\tthis.instagramAccountNode.disabled = false;\n\t\t\t}\n\t\t);\n\t}\n\n\tloadSettings()\n\t{\n\t\tthis.instagramAccountNode.disabled  = true;\n\t\tthis.accountNode.disabled  = true;\n\n\t\tconst type = this.provider.TYPE;\n\t\tconst isSupportAccount = this.provider.IS_SUPPORT_ACCOUNT;\n\n\t\tif (!this.provider.PROFILE)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.loaded.includes(type))\n\t\t{\n\t\t\tthis.loaded.push(type);\n\t\t}\n\n\t\tif (this.accountNode && isSupportAccount)\n\t\t{\n\t\t\tthis.loadAccounts();\n\t\t\tthis.loadInstagramAccounts();\n\t\t}\n\t}\n\n\tsetProfile(item)\n\t{\n\t\tthis.clientId = item && item.CLIENT_ID ? item.CLIENT_ID : null;\n\t\tthis.provider.PROFILE = item;\n\t\tthis.accountId = null;\n\t\tthis.pageId = null;\n\n\t\tif(this.clientSelector.selected)\n\t\t{\n\t\t\tthis._helper.showBlockMain();\n\t\t}\n\n\t\tthis.clientSelector.setSelected(item);\n\t}\n}","import { PopupManager } from 'main.popup';\nimport { Button } from 'ui.buttons';\nimport { SeoAccount } from './seoaccount';\nimport { Loc, Tag, Type } from \"main.core\";\n\nexport class Helper\n{\n\t_instance: Helper;\n\n\tconstructor(seoAccount: SeoAccount): Helper\n\t{\n\t\tthis.provider = seoAccount.provider;\n\t\tthis.clientId = seoAccount.clientId;\n\t\tthis.clientSelector = seoAccount.clientSelector;\n\t\tthis.clientNode = seoAccount.clientNode;\n\t\tthis.avatarNode = seoAccount.avatarNode;\n\t\tthis.linkNode = seoAccount.linkNode;\n\t\tthis.seoAccount = seoAccount;\n\t\tthis.signedParameters = seoAccount.signedParameters;\n\t\tthis.containerNode = BX('crm-ads-new-campaign');\n\n\t\tthis.mess = {\n\t\t\terrorAction: Loc.getMessage('UI_HELPER_ERROR_MSG'),\n\t\t\tdlgBtnClose: Loc.getMessage('UI_HELPER_BUTTON_CLOSE')\n\n\t\t}\n\n\t\treturn this;\n\t}\n\n\n\tsetProvider(value)\n\t{\n\t\tthis.provider = value;\n\t}\n\n\tstatic getCreated(): Helper\n\t{\n\t\tif(this._instance === undefined)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn this._instance\n\t}\n\n\tstatic getInstance(seoAccount: SeoAccount, signedParameters): Helper\n\t{\n\t\tif(this._instance === undefined)\n\t\t{\n\t\t\tthis._instance = new Helper(seoAccount, signedParameters)\n\t\t}\n\n\t\treturn this._instance;\n\t}\n\n\trequest(action, requestData, callback)\n\t{\n\t\trequestData.action = action;\n\t\trequestData.type = this.seoAccount.provider.TYPE;\n\t\trequestData.clientId = this.seoAccount.clientId;\n\n\t\tthis.sendActionRequest(action, requestData, function(response) {\n\t\t\tthis.onResponse(response, callback);\n\t\t});\n\t}\n\n\tonResponse(response, callback)\n\t{\n\t\tif (!response.error)\n\t\t{\n\t\t\tcallback.apply(this, [response.data]);\n\t\t}\n\t}\n\n\tsendActionRequest(action, data, callbackSuccess, callbackFailure)\n\t{\n\t\tcallbackSuccess = callbackSuccess || null;\n\t\tcallbackFailure = callbackFailure || BX.proxy(this.showErrorPopup, this);\n\t\tdata = data || {};\n\n\t\tBX.ajax.runComponentAction(this.seoAccount.componentName, action, {\n\t\t\t'mode': 'class',\n\t\t\t'signedParameters': this.signedParameters,\n\t\t\t'data': data\n\t\t}).then(\n\t\t\tresponse => {\n\t\t\t\tconst data = response.data || {};\n\t\t\t\tif (data.error)\n\t\t\t\t{\n\t\t\t\t\tcallbackFailure.apply(this, [data]);\n\t\t\t\t}\n\t\t\t\telse if (callbackSuccess)\n\t\t\t\t{\n\t\t\t\t\tcallbackSuccess.apply(this, [data]);\n\t\t\t\t}\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tconst data = { 'error': true, 'text': '' };\n\t\t\t\tcallbackFailure.apply(this, [data]);\n\t\t\t}\n\t\t);\n\t}\n\n\tshowErrorPopup(data)\n\t{\n\t\tconsole.log(data);\n\t\tconst text = data.text || this.mess.errorAction;\n\n\t\tconst popup = PopupManager.create({\n\t\t\t\tid: 'crm_ads_rtg_error',\n\t\t\t\tautoHide: true,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toverlay: { backgroundColor: 'black', opacity: 500 },\n\t\t\t\tevents: {\n\t\t\t\t\t'onPopupClose': this.onErrorPopupClose.bind(this)\n\t\t\t\t},\n\t\t\t\tbuttons: [\n\t\t\t\t\tnew Button({\n\t\t\t\t\t\ttext: 'close' || this.mess.dlgBtnClose,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t}\n\t\t);\n\n\t\tpopup.setContent( `<span class=\"crm-ads-rtg-warning-popup-alert\">${text}</span>`)\n\n\t\tpopup.show();\n\t}\n\n\tonErrorPopupClose()\n\t{\n\t\tif (this.clientSelector)\n\t\t{\n\t\t\tthis.clientSelector.enable();\n\t\t}\n\t}\n\n\n\tshowBlock(blockCodes)\n\t{\n\t\tblockCodes = Type.isArray(blockCodes) ? blockCodes : [blockCodes];\n\t\tconst attributeBlock = 'data-bx-ads-block';\n\t\tconst blockNodes = [...this.containerNode.querySelectorAll('[' + attributeBlock + ']')];\n\t\tblockNodes.forEach(blockNode => {\n\t\t\tconst code = blockNode.getAttribute(attributeBlock);\n\t\t\tconst isShow = blockCodes.includes(code);\n\t\t\tblockNode.style.display = isShow ? (blockNode.dataset.flex?'flex':'block') : 'none';\n\t\t}, this);\n\t}\n\n\tshowBlockRefresh()\n\t{\n\t\tthis.showBlock(['auth', 'refresh']);\n\t}\n\n\tshowBlockLogin()\n\t{\n\t\tthis.showBlock('login');\n\n\t\tconst btn = BX('seo-ads-login-btn');\n\t\tif (btn && this.provider && this.provider.AUTH_URL)\n\t\t{\n\t\t\tbtn.setAttribute(\n\t\t\t\t'onclick',\n\t\t\t\t'BX.util.popup(\\'' + this.provider.AUTH_URL + '\\', 800, 600);'\n\t\t\t);\n\t\t}\n\t\tif (this.clientNode)\n\t\t{\n\t\t\tthis.clientNode.value = \"\";\n\t\t}\n\t}\n\n\tshowBlockMain()\n\t{\n\t\tif (this.avatarNode)\n\t\t{\n\t\t\tthis.avatarNode.style['background-image'] = 'url(' + this.provider.PROFILE.PICTURE + ')';\n\t\t}\n\t\tif (this.nameNode)\n\t\t{\n\t\t\tthis.nameNode.innerText = this.provider.PROFILE.NAME;\n\t\t}\n\t\tif (this.linkNode)\n\t\t{\n\t\t\tif (this.provider.PROFILE.LINK)\n\t\t\t{\n\t\t\t\tthis.linkNode.setAttribute('href', this.provider.PROFILE.LINK);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.linkNode.removeAttribute('href');\n\t\t\t}\n\t\t}\n\t\tif (this.clientNode)\n\t\t{\n\t\t\tthis.clientNode.value =\n\t\t\t\tthis.provider.PROFILE && this.provider.PROFILE.CLIENT_ID ?\n\t\t\t\t\tthis.provider.PROFILE.CLIENT_ID :\n\t\t\t\t\t\"\";\n\t\t}\n\n\t\tthis.showBlock(['auth', 'main']);\n\n\t\tthis.seoAccount.loadSettings();\n\t}\n\n\n\tshowBlockByAuth()\n\t{\n\t\tif (this.provider.HAS_AUTH)\n\t\t{\n\t\t\tthis.showBlockMain();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showBlockLogin();\n\t\t}\n\t}\n\n\tfillDropDownControl(node, items)\n\t{\n\t\titems = items || [];\n\t\tnode.innerHTML = '';\n\t\titems.forEach(item => {\n\t\t\tif (!item || !item.caption)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst option =\n\t\t\t\tTag.render`<option value='${item.value}' selected='${!!item.selected}'>${item.caption}</option>`;\n\n\t\t\tif(item.currency)\n\t\t\t{\n\t\t\t\toption.dataset.currency = item.currency;\n\t\t\t}\n\n\t\t\tif(item.pageId)\n\t\t\t{\n\t\t\t\toption.dataset.pageId = item.pageId;\n\t\t\t}\n\n\t\t\tif(item.actorId)\n\t\t\t{\n\t\t\t\toption.dataset.actorId = item.actorId;\n\t\t\t}\n\n\t\t\tnode.appendChild(option);\n\t\t});\n\t}\n}","import {SeoAccount} from \"./seoaccount\";\nimport {ProductSelector} from 'catalog.product-selector';\nimport {Event, Loc, Tag} from \"main.core\";\nimport {EventEmitter} from 'main.core.events';\nimport { type AdBuilderOptions } from './types/adbuilderoptions';\n\nexport class SeoAdBuilder\n{\n\t_instance: SeoAdBuilder;\n\tproductSelector: ProductSelector;\n\t_DEFAULT_CURRENCY = 'RUB';\n\n\t_STAGES = {\n\t\taccountSelected: 1,\n\t\tpostSelected: 2,\n\t\tpageSelected: 3,\n\t\taudienceSelected: 4,\n\t\tbudgetSelected: 5,\n\t\ttoModeration: 6\n\t};\n\n\tconstructor(options: AdBuilderOptions)\n\t{\n\t\tif (this._instance)\n\t\t{\n\t\t\treturn this._instance;\n\t\t}\n\n\t\tthis.optionSelectedClass = 'crm-ads-new-campaign-item-option--selected';\n\t\tthis.containerId = options.containerId;\n\t\tthis.provider = options.provider;\n\t\tthis.context = options.context;\n\t\tthis.onRequest = options.onRequest;\n\t\tthis.componentName = options.componentName;\n\t\tthis.signedParameters = options.signedParameters;\n\t\tthis.postListUrl = options.postListUrl;\n\t\tthis.audienceUrl = options.audienceUrl;\n\t\tthis.crmAudienceUrl = options.crmAudienceUrl;\n\t\tthis.pageConfigurationUrl = options.pageConfigurationUrl;\n\t\tthis.mess = options.mess;\n\t\tthis.type = options.type;\n\t\tthis.iBlockId = options.iBlockId;\n\t\tthis.basePriceId = options.basePriceId;\n\t\tthis.storeExists = options.storeExists;\n\t\tthis.isCloud = options.isCloud || false;\n\n\t\tthis.clientId = options.clientId;\n\t\tthis.accountId = options.accountId;\n\t\tthis.baseCurrency = options.baseCurrency;\n\t\tthis.arrows = document.querySelectorAll(\".crm-ads-new-campaign-item-arrow\");\n\n\t\tthis.price = [];\n\t\tthis.price[this._DEFAULT_CURRENCY] = [];\n\t\tthis.price[this._DEFAULT_CURRENCY]['recommended'] = { duration: 3, value: 100 };\n\t\tthis.price[this._DEFAULT_CURRENCY]['verified'] = { duration: 3, value: 200 };\n\t\tthis.price[this._DEFAULT_CURRENCY]['boost'] = { duration: 3, value: 300 };\n\t\tthis.price[this._DEFAULT_CURRENCY]['confident'] = { duration: 5, value: 500 };\n\n\t\tthis.price['USD'] = [];\n\t\tthis.price['USD']['recommended'] = { duration: 3, value: 50 };\n\t\tthis.price['USD']['verified'] = { duration: 3, value: 100 };\n\t\tthis.price['USD']['boost'] = { duration: 3, value: 150 };\n\t\tthis.price['USD']['confident'] = { duration: 5, value: 200 };\n\n\t\tthis.price['EUR'] = [];\n\t\tthis.price['EUR']['recommended'] = { duration: 3, value: 50 };\n\t\tthis.price['EUR']['verified'] = { duration: 3, value: 100 };\n\t\tthis.price['EUR']['boost'] = { duration: 3, value: 150 };\n\t\tthis.price['EUR']['confident'] = { duration: 5, value: 200 };\n\n\t\tthis.completedStages = {};\n\t\tthis.selectedRegions = {};\n\n\t\tthis.loader = {\n\t\t\tinit: caller => {\n\t\t\t\tthis.caller = caller;\n\t\t\t},\n\n\t\t\tchange: (loaderNode, inputNode, isShow) => {\n\t\t\t\tloaderNode.style.display = isShow ? '' : 'none';\n\t\t\t\tif (inputNode)\n\t\t\t\t{\n\t\t\t\t\tinputNode.disabled = (!inputNode.options.length === 0 || isShow) ? false : true;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tthis._instance = this;\n\t\tthis.initiateUINodes();\n\t\tthis.initiateAutoAudienceMode();\n\n\n\t\tfor (let i = this._STAGES.accountSelected; i <= this._STAGES.toModeration; i++)\n\t\t{\n\t\t\tthis.deActivateStage(i);\n\t\t}\n\n\t\tthis.initiateAccounts();\n\t\tthis.activateStage(this._STAGES.audienceSelected);\n\n\t\tthis.initiateSwitcher('product');\n\t\tthis.initiateSwitcher('audience');\n\t\tthis.initiateSwitcher('budget');\n\n\t\tthis.bindEvents()\n\t\tthis.buildSelector();\n\n\t\tthis.storeBlockShow(true);\n\t}\n\n\treInitAdCreator()\n\t{\n\t\tthis.adCreatorData = {};\n\t\tthis.adCreatorData.audienceConfig = {};\n\t\tthis.adCreatorData.crmAudienceConfig = {};\n\t}\n\n\tinitiateAccounts()\n\t{\n\t\tthis.seoAccount = new SeoAccount({\n\t\t\tclientNode: this.uiNodes.clientInput,\n\t\t\tprovider: this.provider,\n\t\t\tavatarNode: this.uiNodes.avatar,\n\t\t\tlinkNode: this.uiNodes.link,\n\t\t\taccountNode: this.uiNodes.account,\n\t\t\tinstagramAccountNode: this.uiNodes.instagramAccount,\n\t\t\tclientBlock: this.uiNodes.clientBlock,\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tcomponentName: this.componentName,\n\t\t\tuiNodes: this.uiNodes\n\t\t});\n\n\t\tthis.profileConfigured = false;\n\t\tif (!this.clientId && !this.provider.PROFILE)\n\t\t{ // use first client by default\n\t\t\tfor (let i = 0; i < this.provider.CLIENTS.length; i++)\n\t\t\t{\n\t\t\t\tthis.seoAccount.setProfile(this.provider.CLIENTS[i]);\n\t\t\t\tthis.profileConfigured = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.loader.init(this);\n\n\t\tif (this.provider.PROFILE)\n\t\t{\n\t\t\tthis.activateStage(this._STAGES.accountSelected);\n\t\t}\n\n\t\tif(!this.profileConfigured)\n\t\t{\n\t\t\tthis.seoAccount.setProfile(this.provider.PROFILE);\n\t\t}\n\n\t\tthis.seoAccount._helper.showBlockByAuth();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEvent.bind(this.uiNodes.addPost, 'click', this.openPostSlider.bind(this));\n\n\t\tthis.uiNodes.createLinks.forEach(function(createLink) {\n\t\t\tEvent.bind(createLink, 'click', BX.proxy(function() {\n\t\t\t\tif (!this.hasPostLis)\n\t\t\t\t{\n\t\t\t\t\tthis.showBlockRefresh();\n\t\t\t\t}\n\t\t\t}, this));\n\t\t}, this);\n\n\t\tEvent.bind(this.uiNodes.refreshButton, 'click', BX.proxy(function() {\n\t\t\tthis.seoAccount.getProvider();\n\t\t}, this));\n\n\t\tif (this.uiNodes.autoRemover.checker)\n\t\t{\n\t\t\tEvent.bind(this.uiNodes.autoRemover.checker, 'click', () => {\n\t\t\t\tvar autoRemover = this.uiNodes.autoRemover;\n\t\t\t\tautoRemover.select.disabled = !autoRemover.checker.checked;\n\t\t\t});\n\t\t}\n\n\t\tEvent.bind(this.uiNodes.logout, 'click', BX.proxy(function() {\n\t\t\tthis.seoAccount.logout(this.clientId);\n\t\t}, this));\n\n\t\tEvent.bind(this.uiNodes.addClientBtn, 'click', BX.proxy(function() {\n\t\t\tBX.util.popup(_this.provider.AUTH_URL, 800, 600);\n\t\t}, this));\n\n\t\tthis.arrows.forEach(arrow => {\n\t\t\t\tarrow.addEventListener('click', this.switchCollapsed);\n\t\t\t}\n\t\t);\n\n\t\tEvent.bind(this.uiNodes.account, 'change', this.checkCurrency.bind(this));\n\t\tdocument.querySelectorAll('.seo-ads-budget-item-block').forEach(div => {\n\t\t\tEvent.bind(div, 'click', this.calculateTotal.bind(this));\n\t\t});\n\n\t\tdocument.querySelectorAll('.seo-ads-audience-item-block').forEach(div => {\n\t\t\tEvent.bind(div, 'click', this.changeAudienceMode.bind(this));\n\t\t});\n\n\t\tdocument.querySelectorAll('.seo-ads-product-item-block').forEach(div => {\n\t\t\tEvent.bind(div, 'click', this.changeProductSelectionMode.bind(this));\n\t\t});\n\n\t\tEvent.bind(this.uiNodes.audienceExpert, 'click', this.showAudienceExpertModeForm.bind(this));\n\t\tEvent.bind(this.uiNodes.productExpert, 'click', this.openTargetPageSlider.bind(this));\n\n\t\tEvent.bind(this.uiNodes.addProductBtn, 'click', this.toCreateStoreSlider.bind(this));\n\t\tEvent.bind(this.uiNodes.addCurrencyBtn, 'click', this.addCurrency.bind(this));\n\t\tEvent.bind(this.uiNodes.toModerationBtn, 'click', this.sendToModeration.bind(this));\n\t}\n\n\tinitiateUINodes()\n\t{\n\t\tthis.containerNode = BX('crm-ads-new-campaign');\n\t\tBX.UI.Hint.init(this.containerNode);\n\n\t\tthis.uiNodes = {\n\t\t\t'avatar': this.containerNode.querySelector('[data-bx-ads-auth-avatar]'),\n\t\t\t'name': this.containerNode.querySelector('[data-bx-ads-auth-name]'),\n\t\t\t'link': this.containerNode.querySelector('[data-bx-ads-auth-link]'),\n\t\t\t'logout': this.containerNode.querySelector('[data-bx-ads-auth-logout]'),\n\t\t\t'clientBlock': this.containerNode.querySelector('[data-bx-ads-client]'),\n\t\t\t'clientInput': this.containerNode.querySelector('[data-bx-ads-client-input]'),\n\t\t\t'account': this.containerNode.querySelector('[data-bx-ads-account]'),\n\t\t\t'accountLoader': this.containerNode.querySelector('[data-bx-ads-account-loader]'),\n\t\t\t'instagramAccount': this.containerNode.querySelector('[data-bx-ads-instagram-account]'),\n\t\t\t'instagramAccountLoader': this.containerNode.querySelector('[data-bx-ads-instagram-account-loader]'),\n\t\t\t'errorNotFound': this.containerNode.querySelector('[data-bx-ads-post-not-found]'),\n\t\t\t'addPost': this.containerNode.querySelector('.crm-ads-new-campaign-item-post-new'),\n\t\t\t'addProductBtn': this.containerNode.querySelector('.seo-ads-add-product-btn'),\n\t\t\t'addCurrencyBtn': this.containerNode.querySelector('.seo-ads-currency-apply-btn'),\n\t\t\t'toModerationBtn': this.containerNode.querySelector('.seo-ads-to-moderation-btn'),\n\t\t\t'refreshButton': this.containerNode.querySelector('[data-bx-ads-refresh-btn]'),\n\t\t\t'currencyBlock': document.querySelector('.seo-ads-currency-block'),\n\t\t\t'audienceSummary': document.querySelector('.seo-ads-audience-summary'),\n\t\t\t'createLinks': BX.convert.nodeListToArray(\n\t\t\t\tthis.containerNode.querySelectorAll('[data-bx-ads-post-create-link]')\n\t\t\t),\n\t\t\t'accountNotice': {\n\t\t\t\t'instagram': this.containerNode.querySelector('.seo-ads-no-ad-account-instagram'),\n\t\t\t\t'ad': this.containerNode.querySelector('.seo-ads-no-ad-account'),\n\t\t\t},\n\t\t\t'audienceExpert': BX('crm-ads-new-campaign-item-expert-audience'),\n\t\t\t'productExpert': BX('crm-ads-new-campaign-item-expert-product'),\n\t\t\t'budgetExpert': BX('crm-ads-new-campaign-item-expert-budget'),\n\t\t\t'autoRemover': {\n\t\t\t\t'node': this.containerNode.querySelector('[data-bx-ads-post-auto-remove]'),\n\t\t\t\t'checker': this.containerNode.querySelector('[data-bx-ads-post-auto-remove-checker]'),\n\t\t\t\t'select': this.containerNode.querySelector('[data-bx-ads-post-auto-remove-select]')\n\t\t\t},\n\t\t\t'form': {\n\t\t\t\t'permalink': this.containerNode.querySelector('[data-bx-ads-permalink]'),\n\t\t\t\t'mediaId': this.containerNode.querySelector('[data-bx-ads-media-id]'),\n\t\t\t\t'targetUrl': this.containerNode.querySelector('[data-bx-ads-target-url]'),\n\t\t\t\t'duration': this.containerNode.querySelector('[data-bx-ads-duration]'),\n\t\t\t\t'page': this.containerNode.querySelector('[data-bx-ads-page-id]'),\n\t\t\t\t'body': this.containerNode.querySelector('[data-bx-ads-body]'),\n\t\t\t\t'adsId': this.containerNode.querySelector('[data-bx-ads-id]'),\n\t\t\t\t'pageId': this.containerNode.querySelector('[data-bx-ads-page-id]'),\n\t\t\t\t'budget': this.containerNode.querySelector('[data-bx-ads-budget]'),\n\t\t\t\t'ageFrom': this.containerNode.querySelector('[data-bx-ads-age-from]'),\n\t\t\t\t'ageTo': this.containerNode.querySelector('[data-bx-ads-age-to]'),\n\t\t\t\t'genders': this.containerNode.querySelector('[data-bx-ads-genders]'),\n\t\t\t\t'interests': this.containerNode.querySelector('[data-bx-ads-interests]'),\n\t\t\t\t'imageUrl': this.containerNode.querySelector('[data-bx-ads-image-url]'),\n\t\t\t\t'instagramAccountId': this.containerNode.querySelector('[data-bx-ads-actor-id]'),\n\t\t\t\t'segmentInclude': this.containerNode.querySelector('[data-bx-ads-segment-include]'),\n\t\t\t\t'segmentExclude': this.containerNode.querySelector('[data-bx-ads-segment-exclude]'),\n\t\t\t\t'regions': this.containerNode.querySelector('[data-bx-ads-regions]')\n\t\t\t},\n\t\t\t'adsStoreBlock': this.containerNode.querySelectorAll('.seo-ads-store'),\n\t\t\t'addClientBtn': this.containerNode.querySelector('[data-bx-ads-client-add-btn]'),\n\t\t\t'addPostBtn': this.containerNode.querySelector('[data-bx-ads-post-add]')\n\t\t};\n\t}\n\n\tinitiateSwitcher(id)\n\t{\n\t\tnew BX.UI.Switcher({\n\t\t\tnode: BX(`crm-ads-new-campaign-item-expert-${id}`),\n\t\t\tsize: \"small\"\n\t\t});\n\t}\n\n\tcheckCurrency()\n\t{\n\t\tconst account = this.uiNodes.account;\n\t\tthis.usedCurrency = account.options[account.selectedIndex].dataset.currency;\n\t\tthis.currencyExists(this.usedCurrency);\n\t}\n\n\tcalculateTotal(event)\n\t{\n\t\tif(this.checkInstagramAccount())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst target = event.target.dataset.type ? event.target : event.target.parentNode;\n\n\t\tconst type = target.dataset.type;\n\t\tconst price = this.price[this.usedCurrency][type];\n\t\tconst total = price.duration * price.value;\n\n\t\tdocument.querySelectorAll('.seo-ads-budget-total-value').forEach(element => {\n\t\t\telement.textContent = total;\n\t\t});\n\n\t\tdocument.querySelector('.seo-ads-budget-total-currency').textContent = this.usedCurrency;\n\t\tdocument.querySelector('.seo-ads-budget-total-duration').textContent = price.duration;\n\n\t\tdocument.querySelector('.seo-ads-total-budget').textContent = total;\n\t\tdocument.querySelector('.seo-ads-total-currency').textContent = this.usedCurrency;\n\t\tdocument.querySelector('.seo-ads-total-duration').textContent = price.duration;\n\n\t\tdocument.querySelector('.crm-ads-new-campaign-item-cost').style.display = 'block';\n\n\t\tdocument.querySelectorAll('.seo-ads-budget-item-block').forEach(div => {\n\t\t\tdiv.classList.remove(this.optionSelectedClass);\n\t\t});\n\n\t\ttarget.classList.add(this.optionSelectedClass);\n\n\t\tthis.uiNodes.form.budget.value = total;\n\t\tthis.uiNodes.form.duration.value = price.duration;\n\t\tthis.prepareCurrencyBlocks();\n\t\tthis.activateStage(this._STAGES.budgetSelected);\n\t}\n\n\tcheckInstagramAccount()\n\t{\n\t\tif (!this.uiNodes.instagramAccount.value)\n\t\t{\n\t\t\tthis.scrollToStage(this._STAGES.accountSelected);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tchangeAudienceMode(event)\n\t{\n\t\tif(this.checkInstagramAccount())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst target = event.target.dataset.type ? event.target : event.target.parentNode;\n\n\t\tconst type = target.dataset.type;\n\n\t\tdocument.querySelectorAll('.seo-ads-audience-item-block').forEach(div => {\n\t\t\tdiv.classList.remove(this.optionSelectedClass);\n\t\t});\n\n\t\ttarget.classList.add(this.optionSelectedClass);\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase 'auto':\n\t\t\t\tthis.initiateAutoAudienceMode();\n\t\t\t\tbreak;\n\t\t\tcase 'crm':\n\t\t\t\tthis.showCrmAudienceExpertModeForm();\n\t\t\t\tbreak;\n\t\t\tcase 'expert':\n\t\t\t\tthis.showAudienceExpertModeForm();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tchangeProductSelectionMode(event)\n\t{\n\t\tif(this.checkInstagramAccount())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst target = event.target.dataset.type ? event.target : event.target.parentNode;\n\n\t\tconst type = target.dataset.type;\n\t\tdocument.querySelectorAll('.seo-ads-product-item-block').forEach(div => {\n\t\t\tdiv.classList.remove(this.optionSelectedClass);\n\t\t});\n\n\t\ttarget.classList.add(this.optionSelectedClass);\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase 'auto':\n\t\t\t\tthis.storeBlockShow(true);\n\t\t\t\tbreak;\n\t\t\tcase 'expert':\n\t\t\t\tthis.openTargetPageSlider();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tstoreBlockShow(isShown)\n\t{\n\t\tthis.uiNodes.adsStoreBlock.forEach((element) => {\n\t\t\tif(this.storeExists && element.dataset.type === 'store-not-created')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(!this.storeExists && element.dataset.type !== 'store-not-created')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\telement.style.display = isShown?'block':'none';\n\t\t});\n\t}\n\n\tprepareCurrencyBlocks()\n\t{\n\t\tdocument.querySelectorAll('.seo-ads-current-currency').forEach(element => {\n\t\t\telement.textContent = this.usedCurrency;\n\t\t});\n\t}\n\n\tprepareCurrencyBlock(currency = this._DEFAULT_CURRENCY)\n\t{\n\t\tif (!this.price[currency])\n\t\t{\n\t\t\tfor (const key in this.price[this._DEFAULT_CURRENCY])\n\t\t\t{\n\t\t\t\tthis.convertToCurrency(\n\t\t\t\t\tkey,\n\t\t\t\t\tthis._DEFAULT_CURRENCY !== this.baseCurrency ? this.baseCurrency : currency,\n\t\t\t\t\tthis.price[this._DEFAULT_CURRENCY][key]\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const key in this.price[currency])\n\t\t{\n\t\t\tdocument.querySelector(`.seo-ads-budget-${key}-duration`).textContent = this.price[currency][key].duration;\n\t\t\tdocument.querySelector(`.seo-ads-budget-${key}-value`).textContent = this.price[currency][key].value;\n\t\t\tdocument.querySelector(`.seo-ads-budget-${key}-currency`).textContent = currency;\n\t\t}\n\t}\n\n\tconvertToCurrency(key, targetCurrency, price)\n\t{\n\t\tthis.seoAccount._helper.request('convertCurrency', {\n\t\t\t\tsourceCurrency: this.baseCurrency,\n\t\t\t\ttargetCurrency: targetCurrency,\n\t\t\t\tamount: price.value\n\t\t\t}, response => {\n\t\t\t\tconst amount = response.amount;\n\n\t\t\t\tif (!this.price[targetCurrency])\n\t\t\t\t{\n\t\t\t\t\tthis.price[targetCurrency] = [];\n\t\t\t\t}\n\n\t\t\t\tif (!this.price[targetCurrency][key])\n\t\t\t\t{\n\t\t\t\t\tthis.price[targetCurrency][key] = { duration: price.duration, value: amount };\n\t\t\t\t}\n\n\t\t\t\tif (Object.keys(this.price[targetCurrency]).length === 4)\n\t\t\t\t{\n\t\t\t\t\tthis.prepareCurrencyBlock(targetCurrency);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tcurrencyExists(currency)\n\t{\n\t\tthis.seoAccount._helper.request('checkCurrencyExists', {\n\t\t\t\tcurrency: currency\n\t\t\t}, response => {\n\t\t\t\tconst exists = response.exists;\n\n\t\t\t\tif (exists === false)\n\t\t\t\t{\n\t\t\t\t\tthis.prepareCurrencyBlocks();\n\t\t\t\t\tthis.uiNodes.currencyBlock.style.display = 'block';\n\t\t\t\t}\n\n\t\t\t\tthis.prepareCurrencyBlock(this.usedCurrency);\n\t\t\t}\n\t\t);\n\t}\n\n\taddCurrency()\n\t{\n\t\tconst count = document.querySelector('.seo-ads-currency-count');\n\t\tconst course = document.querySelector('.seo-ads-currency-course');\n\t\tif (!count.value || !course)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.seoAccount._helper.request('addCurrency', {\n\t\t\t\tnewCurrency: this.usedCurrency,\n\t\t\t\tcourse: course.value,\n\t\t\t\tamountCnt: count.value\n\t\t\t}, response => {\n\t\t\t\tconst success = response.success;\n\n\t\t\t\tif (success === false)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.uiNodes.currencyBlock.style.display = 'none';\n\t\t\t\tdelete (this.price[this.usedCurrency]);\n\t\t\t\tthis.prepareCurrencyBlock(this.usedCurrency);\n\t\t\t}\n\t\t);\n\t}\n\n\tswitchCollapsed(event)\n\t{\n\t\tconst block = event.target.closest('.crm-ads-new-campaign-item');\n\t\tconst content = block.querySelector('.crm-ads-new-campaign-item-content');\n\n\t\tif (block.classList.contains('crm-ads-new-campaign-item--hide'))\n\t\t{\n\t\t\tblock.classList.remove('crm-ads-new-campaign-item--hide');\n\t\t\tcontent.style.height = content.scrollHeight + 'px';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tblock.classList.add('crm-ads-new-campaign-item--hide');\n\t\t\tcontent.style.height = content.scrollHeight + 'px';\n\t\t\tsetTimeout(() => content.style.height = '0');\n\t\t}\n\t}\n\n\tclipTitle(title)\n\t{\n\t\tif (!title)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst text = title.textContent;\n\t\tconst nodeHeight = 20;\n\t\tBX.cleanNode(title);\n\n\t\tconst titleInner = BX.create(\"span\", {\n\t\t\ttext: text\n\t\t});\n\t\ttitle.appendChild(titleInner);\n\n\t\tlet a = 0;\n\t\twhile (titleInner.offsetHeight > nodeHeight && text.length > a)\n\t\t{\n\t\t\ta = a + 1;\n\t\t\ttitleInner.innerText = text.slice(0, -a) + '...';\n\t\t}\n\t}\n\n\tonPostSelected(event)\n\t{\n\t\tif (event.eventId === \"seo-ads-post-selected\" && event.data)\n\t\t{\n\t\t\tif (!event.data.media_url)\n\t\t\t{\n\t\t\t\tthis.deActivateStage(this._STAGES.postSelected);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst postItem = Tag.render` \n\t\t\t<div class=\"crm-ads-new-campaign-item-post\">\n\t\t\t   <div class=\"crm-ads-new-campaign-item-post-img\" \n\t\t\t\t\tstyle=\"background-image: url(${event.data.media_url})\">\n\t\t\t   </div>\n\t\t\t   <span class=\"crm-ads-new-campaign-item-post-text\">${event.data.caption||''}</span>\n\t\t\t   <span class=\"crm-ads-new-campaign-item-post-delete\"></span>\n\t\t\t</div>\n\t\t\t`;\n\n\t\t\tconst postListNode = document.querySelector('.crm-ads-new-campaign-item-posts');\n\t\t\tconst addNewNode = document.querySelector('.crm-ads-new-campaign-item-post-new');\n\t\t\tconst previewNode = document.querySelector('.crm-ads-new-campaign-item-total-preview-img-value');\n\n\t\t\tif (addNewNode !== postListNode.firstChild)\n\t\t\t{\n\t\t\t\tpostListNode.removeChild(postListNode.firstChild);\n\t\t\t}\n\n\t\t\tpostListNode.insertBefore(postItem, postListNode.firstChild);\n\t\t\tEvent.bind(postItem.querySelector('.crm-ads-new-campaign-item-post-delete'), 'click', () => {\n\t\t\t\tpostItem.parentNode.removeChild(postItem);\n\t\t\t});\n\n\t\t\tpreviewNode.style.backgroundImage = 'url(' + event.data.media_url + ')';\n\n\t\t\tthis.postData = event.data;\n\n\t\t\tconst title = document.querySelector('.crm-ads-new-campaign-item-post-text');\n\t\t\tthis.clipTitle(title);\n\t\t\tthis.activateStage(this._STAGES.postSelected);\n\t\t}\n\t}\n\n\topenPostSlider()\n\t{\n\t\tif (this.uiNodes.instagramAccount.value)\n\t\t{\n\t\t\tthis.openSlider(this.postListUrl, {\n\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t\tcomponentParams: {\n\t\t\t\t\tACCOUNT_ID: this.uiNodes.instagramAccount.value,\n\t\t\t\t\tCLIENT_ID: this.uiNodes.clientInput.value,\n\t\t\t\t\tTYPE: this.provider.TYPE\n\t\t\t\t}\n\t\t\t}, this.onPostSelected);\n\t\t}\n\t}\n\n\tonTargetPageSelected(event)\n\t{\n\t\tif (event.eventId === \"seo-ads-target-post-selected\" && event.data)\n\t\t{\n\t\t\tif (!event.data.targetUrl)\n\t\t\t{\n\t\t\t\tthis.deActivateStage(this._STAGES.pageSelected);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdocument.querySelector('.seo-ads-target-url').textContent = event.data.targetUrl;\n\t\t\tthis.uiNodes.form.targetUrl.value = event.data.targetUrl;\n\t\t\tthis.activateStage(this._STAGES.pageSelected);\n\t\t}\n\t}\n\n\tonFBAudienceConfigured(event)\n\t{\n\t\tif (event.eventId === \"seo-fb-audience-configured\" && event.data)\n\t\t{\n\t\t\tthis.reInitAdCreator();\n\t\t\tif (!event.data)\n\t\t\t{\n\t\t\t\tthis.deActivateStage(this._STAGES.audienceSelected);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.adCreatorData.audienceConfig = event.data;\n\t\t\tthis.activateStage(this._STAGES.audienceSelected);\n\n\t\t\tthis.uiNodes.audienceSummary.innerHTML = this.buildAudienceSummary();\n\t\t}\n\t}\n\n\tonCrmAudienceConfigured(event)\n\t{\n\t\tif (event.eventId === \"seo-crm-audience-configured\" && event.data)\n\t\t{\n\t\t\tthis.reInitAdCreator();\n\t\t\tif (!event.data)\n\t\t\t{\n\t\t\t\tthis.deActivateStage(this._STAGES.audienceSelected);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.adCreatorData.crmAudienceConfig = event.data;\n\t\t\tthis.activateStage(this._STAGES.audienceSelected);\n\t\t\tthis.uiNodes.audienceSummary.innerHTML = this.buildAudienceSummary();\n\t\t}\n\t}\n\n\topenTargetPageSlider()\n\t{\n\t\tif (this.uiNodes.instagramAccount.value)\n\t\t{\n\t\t\tthis.storeBlockShow(false);\n\t\t\tthis.openSlider(\n\t\t\t\tthis.pageConfigurationUrl, {\n\t\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t\t\ttargetUrl: this.uiNodes.form.targetUrl.value || '',\n\t\t\t\t\tcacheable: false\n\t\t\t\t},\n\t\t\t\tthis.onTargetPageSelected\n\t\t\t);\n\t\t}\n\t}\n\n\topenSlider(url, params, callback)\n\t{\n\t\tconst sliderOptions = {\n\t\t\twidth: 990,\n\t\t\tcacheable: params.cacheable ?? true,\n\t\t\tallowChangeHistory: false,\n\t\t\trequestMethod: 'post',\n\t\t\trequestParams: params\n\t\t};\n\n\t\tconst eventName = BX.SidePanel.Slider.getEventFullName(\"onMessage\");\n\n\t\tBX.removeAllCustomEvents(\n\t\t\twindow,\n\t\t\teventName,\n\t\t\tcallback.bind(this)\n\t\t);\n\n\t\tBX.addCustomEvent(\n\t\t\twindow,\n\t\t\teventName,\n\t\t\tcallback.bind(this)\n\t\t);\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\turl,\n\t\t\tsliderOptions\n\t\t);\n\t}\n\n\tshowAudienceExpertModeForm()\n\t{\n\t\tif (this.uiNodes.instagramAccount.value)\n\t\t{\n\t\t\tthis.openSlider(this.audienceUrl, {\n\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t\tcomponentParams: {\n\t\t\t\t\tACCOUNT_ID: this.uiNodes.instagramAccount.value,\n\t\t\t\t\tCLIENT_ID: this.uiNodes.clientInput.value,\n\t\t\t\t\tTYPE: this.provider.TYPE\n\t\t\t\t}\n\t\t\t}, this.onFBAudienceConfigured);\n\t\t}\n\t}\n\n\tshowCrmAudienceExpertModeForm()\n\t{\n\t\tif (this.uiNodes.instagramAccount.value)\n\t\t{\n\t\t\tthis.openSlider(this.crmAudienceUrl, {\n\t\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\t\tcomponentParams: {\n\t\t\t\t\tTYPE: this.provider.TYPE\n\t\t\t\t}\n\t\t\t}, this.onCrmAudienceConfigured);\n\t\t}\n\t}\n\n\tinitiateAutoAudienceMode()\n\t{\n\n\t\t\tthis.reInitAdCreator();\n\t\t\tthis.adCreatorData.crmAudienceConfig.genders = [1,2];\n\t\t\tthis.adCreatorData.crmAudienceConfig.ageFrom = 25;\n\t\t\tthis.adCreatorData.crmAudienceConfig.ageTo = 45;\n\n\t\t\tthis.activateStage(this._STAGES.audienceSelected);\n\t\t\tthis.uiNodes.audienceSummary.innerHTML = Loc.getMessage('SEO_AD_BUILDER_AUDIENCE_MEN_WOMAN_25_45');\n\t}\n\n\tbuildAudienceSummary()\n\t{\n\t\tlet summary = ''\n\n\t\tif(this.adCreatorData.audienceConfig.genderTitles)\n\t\t{\n\t\t\tsummary += `${Loc.getMessage('SEO_AD_BUILDER_GENDER')}: ${this.adCreatorData.audienceConfig.genderTitles.join(', ')} `;\n\t\t}\n\n\t\tif(this.adCreatorData.audienceConfig.ageFrom)\n\t\t{\n\t\t\tsummary += `${this.adCreatorData.audienceConfig.ageFrom} - ${this.adCreatorData.audienceConfig.ageTo}\n\t\t\t ${Loc.getMessage('SEO_AD_BUILDER_YEARS_OLD')} <br/>`;\n\t\t}\n\n\t\tif(this.adCreatorData.audienceConfig.interests)\n\t\t{\n\t\t\tlet interests = [];\n\t\t\tthis.adCreatorData.audienceConfig.interests.forEach((interest) => {\n\t\t\t\tinterests.push(interest.name);\n\t\t\t});\n\n\t\t\tsummary += `${Loc.getMessage('SEO_AD_BUILDER_INTERESTS')}: ${interests.join(', ')}<br/>`;\n\t\t}\n\n\t\tif(this.adCreatorData.crmAudienceConfig.segmentInclude)\n\t\t{\n\t\t\tsummary += `${Loc.getMessage('SEO_AD_BUILDER_CRM_AUDIENCE')}<br/>`;\n\t\t}\n\n\t\tif(Object.keys(this.selectedRegions).length)\n\t\t{\n\t\t\tlet regions = [];\n\t\t\tfor(let code in this.selectedRegions)\n\t\t\t{\n\t\t\t\tregions.push(this.selectedRegions[code].title);\n\t\t\t}\n\n\t\t\tsummary += `${Loc.getMessage('SEO_AD_BUILDER_REGION')}: ${regions.join(', ')}<br/>`;\n\t\t}\n\n\t\treturn summary;\n\t}\n\n\tsendToModeration(event)\n\t{\n\t\tthis.uiNodes.toModerationBtn.classList.add('ui-btn-wait');\n\n\t\tconst formNode = this.uiNodes.form;\n\n\t\tif (Object.keys(this.completedStages).length < 6)\n\t\t{\n\t\t\tfor (let i = this._STAGES.accountSelected; i <= this._STAGES.toModeration; i++)\n\t\t\t{\n\t\t\t\tif (!this.completedStages[i])\n\t\t\t\t{\n\t\t\t\t\tthis.scrollToStage(i);\n\t\t\t\t\tthis.uiNodes.toModerationBtn.classList.remove('ui-btn-wait');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.uiNodes.toModerationBtn.classList.remove('ui-btn-wait');\n\t\t\treturn;\n\t\t}\n\n\t\tconst instagramAccount = this.uiNodes.instagramAccount.options[\n\t\t\tthis.uiNodes.instagramAccount.selectedIndex\n\t\t\t].dataset;\n\n\t\tconst params = {\n\t\t\tclient_id: this.uiNodes.clientInput.value,\n\t\t\tbudget: formNode.budget.value,\n\t\t\tduration: formNode.duration.value,\n\t\t\ttargetUrl: formNode.targetUrl.value,\n\t\t\taccountId: this.uiNodes.account.value,\n\t\t\tinstagramAccountId: instagramAccount.actorId,\n\t\t\tpageId: instagramAccount.pageId,\n\t\t\tbody: this.postData.caption,\n\t\t\tmediaId: this.postData.id,\n\t\t\tpermalink: this.postData.permalink,\n\t\t\timageUrl: this.postData.media_url,\n\t\t\tcountries: Object.keys(this.selectedRegions),\n\t\t\tinterests: this.adCreatorData.audienceConfig.interests || [],\n\t\t\tageFrom: this.adCreatorData.audienceConfig.ageFrom || '',\n\t\t\tageTo: this.adCreatorData.audienceConfig.ageTo || '',\n\t\t\tgenders: this.adCreatorData.audienceConfig.genders || ''\n\t\t};\n\n\t\tconst form = document.getElementById('bx-sender-letter-edit')\n\t\t\t.querySelector('form');\n\n\t\tformNode.permalink.value = this.postData.permalink;\n\t\tformNode.pageId.value = params.pageId;\n\t\tformNode.body.value = this.postData.caption;\n\t\tformNode.mediaId.value = params.mediaId;\n\t\tformNode.imageUrl.value = params.imageUrl;\n\t\tformNode.instagramAccountId.value = params.instagramAccountId;\n\t\tformNode.interests.value = JSON.stringify(params.interests);\n\t\tformNode.ageFrom.value = params.ageFrom;\n\t\tformNode.ageTo.value = params.ageTo;\n\t\tformNode.genders.value = JSON.stringify(params.genders);\n\t\tformNode.regions.value = JSON.stringify(params.countries);\n\n\t\tconst include = this.adCreatorData.crmAudienceConfig.segmentInclude || [];\n\t\tconst exclude = this.adCreatorData.crmAudienceConfig.segmentExclude || [];\n\t\tfor (let i = 0; i < include.length; i++)\n\t\t{\n\t\t\tconst input = Tag.render`<input type=\"hidden\" name='SEGMENT[INCLUDE][]'>`;\n\t\t\tinput.value = include[i];\n\t\t\tform.appendChild(input);\n\t\t}\n\t\tfor (let i = 0; i < exclude.length; i++)\n\t\t{\n\t\t\tconst input = Tag.render`<input type=\"hidden\" name='SEGMENT[EXCLUDE][]'>`;\n\t\t\tinput.value = exclude[i];\n\t\t\tform.appendChild(input);\n\t\t}\n\n\t\tform.submit();\n\t}\n\n\tactivateStage(stageNum)\n\t{\n\t\tconst stage = document.querySelector(`[data-stage=\"${stageNum}\"]`);\n\t\tconst line = stage.querySelector('.crm-ads-new-campaign-item-line');\n\t\tconst number = stage.querySelector('.crm-ads-new-campaign-item-number');\n\t\tconst checker = stage.querySelector('.crm-ads-new-campaign-item-number-checker');\n\n\t\tif (line && number)\n\t\t{\n\t\t\tline.classList.remove('crm-ads-new-campaign-item--inactive');\n\t\t\tnumber.classList.remove('crm-ads-new-campaign-item--inactive');\n\t\t}\n\n\t\tif (checker)\n\t\t{\n\t\t\tchecker.style.display = 'block';\n\t\t}\n\n\t\tthis.completedStages[stageNum] = stageNum;\n\n\t\tif (Object.keys(this.completedStages).length === 5)\n\t\t{\n\t\t\tthis.activateStage(this._STAGES.toModeration);\n\t\t}\n\n\t\tif (Object.keys(this.completedStages).length < 5)\n\t\t{\n\t\t\tthis.deActivateStage(this._STAGES.toModeration);\n\t\t}\n\t}\n\n\tdeActivateStage(stageNum)\n\t{\n\t\tconst stage = document.querySelector(`[data-stage=\"${stageNum}\"]`);\n\t\tconst line = stage.querySelector('.crm-ads-new-campaign-item-line');\n\t\tconst number = stage.querySelector('.crm-ads-new-campaign-item-number');\n\t\tconst checker = stage.querySelector('.crm-ads-new-campaign-item-number-checker');\n\n\t\tif (line && number)\n\t\t{\n\t\t\tline.classList.add('crm-ads-new-campaign-item--inactive');\n\t\t\tnumber.classList.add('crm-ads-new-campaign-item--inactive');\n\t\t}\n\n\t\tif (checker)\n\t\t{\n\t\t\tchecker.style.display = 'none';\n\t\t}\n\n\t\tdelete (this.completedStages[stageNum]);\n\n\t\tif (Object.keys(this.completedStages).length < 6 && this.completedStages[this._STAGES.toModeration])\n\t\t{\n\t\t\tthis.deActivateStage(this._STAGES.toModeration);\n\t\t}\n\t}\n\n\tscrollToStage(stageNum)\n\t{\n\t\tconst stage = document.querySelector(`[data-stage=\"${stageNum}\"]`);\n\n\t\tstage.scrollIntoView({\n\t\t\tbehavior: 'smooth'\n\t\t});\n\t}\n\n\tbuildSelector()\n\t{\n\t\tconst selector = new BX.UI.EntitySelector.TagSelector({\n\t\t\tid: 'seo-ads-regions',\n\t\t\tdialogOptions: {\n\t\t\t\tid: 'seo-ads-regions',\n\t\t\t\tcontext: 'SEO_ADS_REGIONS',\n\t\t\t\ttabs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'custom-region-tab',\n\t\t\t\t\t\tvisible: true,\n\t\t\t\t\t\ttitle: Loc.getMessage('SEO_AD_BUILDER_REGION'),\n\t\t\t\t\t\tstub: true,\n\t\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\t\ttitle: Loc.getMessage('UI_TAG_SELECTOR_START_INPUT'),\n\t\t\t\t\t\t\tarrow: true\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: false\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': event => {\n\t\t\t\t\t\tconst data = event.data.item;\n\t\t\t\t\t\tthis.selectedRegions[data.id] = data;\n\t\t\t\t\t\tthis.uiNodes.audienceSummary.innerHTML = this.buildAudienceSummary();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'facebook_regions',\n\t\t\t\t\t\tsearchable: true,\n\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tclientId: this.uiNodes.clientInput.value\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t});\n\n\t\tselector.renderTo(document.getElementById('seo-ads-regions'));\n\t\tselector.getDialog().getRecentTab().setVisible(false)\n\t\tconst selectorOptions = {\n\t\t\tiblockId: this.iBlockId,\n\t\t\tbasePriceId: this.basePriceId,\n\t\t\tfileInputId: '',\n\t\t\tconfig: {\n\t\t\t\tENABLE_SEARCH: true,\n\t\t\t\tENABLE_IMAGE_CHANGE_SAVING: true\n\t\t\t}\n\t\t};\n\n\t\tthis.productSelector = new ProductSelector('facebook-product-selector', selectorOptions);\n\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onChange', this.productSelectedEvent.bind(this));\n\t}\n\n\tproductSelectedEvent(event)\n\t{\n\t\tconst fieldData = event.data.fields;\n\t\tthis.seoAccount._helper.request('getProductUrl', {\n\t\t\t\tid: fieldData.ID\n\t\t\t}, response => {\n\t\t\t\tdocument.querySelector('.seo-ads-target-url').textContent = response;\n\t\t\t\tthis.uiNodes.form.targetUrl.value = response;\n\t\t\t\tthis.activateStage(this._STAGES.pageSelected)\n\t\t\t}\n\t\t)\n\t}\n\n\ttoCreateStoreSlider()\n\t{\n\t\tif (!this.isCloud)\n\t\t{\n\t\t\tthis.openTargetPageSlider();\n\t\t\treturn;\n\t\t}\n\n\t\tconst sliderOptions = {\n\t\t\twidth: 990,\n\t\t\tcacheable: true,\n\t\t\tallowChangeHistory: false,\n\t\t\trequestMethod: 'get'\n\t\t};\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\t'/shop/stores/site/edit/0/?super=Y',\n\t\t\tsliderOptions\n\t\t);\n\t}\n}","import { Helper } from './helper';\nimport { Event, Tag } from \"main.core\";\nimport {type PostSelectorOptions} from './types/postselectoroptions'\n\nexport class SeoPostSelector\n{\n\t_accountId: string;\n\t_clientId: string;\n\t_type: string;\n\n\tconstructor(options: PostSelectorOptions)\n\t{\n\t\tthis.helper = Helper.getCreated();\n\t\tthis.last = null;\n\t\tthis.stopLoading = false;\n\t\tthis.loadInProgress = false;\n\t\tthis._accountId = options.accountId;\n\t\tthis._clientId = options.clientId;\n\t\tthis._type = options.type;\n\t\tthis.signedParameters = options.signedParameters;\n\t\tthis.emptyBlock = document.querySelector('.seo-ads-empty-post-list-block');\n\t\tthis.listContent = document.querySelector('.crm-order-instagram-view-list');\n\t\tthis.dataContent = [];\n\t\tthis.loader = new BX.Loader({\n\t\t\ttarget: document.querySelector(\".crm-order-instagram-view\")\n\t\t});\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tthis.hideListContentBlock();\n\t\tconst topSlider = BX.SidePanel.Instance.getTopSlider().iframe.contentDocument;\n\n\t\tconst observer = new IntersectionObserver(this.loadPostList.bind(this), {\n\t\t\troot: topSlider,\n\t\t\trootMargin: '0px',\n\t\t\tthreshold: 1.0\n\t\t});\n\n\t\tobserver.observe(this.listContent)\n\n\t\tthis.loadPostList();\n\n\t}\n\n\tloadPostList()\n\t{\n\t\tif(this.loadInProgress)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.stopLoading)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.loader.show();\n\n\t\tthis.loadInProgress = true;\n\t\tconst requestData = {\n\t\t\t'clientId': this._clientId || null,\n\t\t\t'type': this._type || null,\n\t\t\t'accountId': this._accountId || null,\n\t\t\t'last': this.last\n\t\t};\n\n\t\tBX.ajax.runComponentAction('bitrix:seo.ads.builder', 'getPostList', {\n\t\t\t'mode': 'class',\n\t\t\t'signedParameters': this.signedParameters,\n\t\t\t'data': requestData\n\t\t}).then(\n\t\t\tresponse => {\n\t\t\t\tconst data = response.data || {};\n\t\t\t\tif (data.error)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.successFn.apply(this, [data]);\n\t\t\t\t}\n\t\t\t\tthis.loadInProgress = false;\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tconst data = { 'error': true, 'text': '' };\n\t\t\t\tthis.loadInProgress = false;\n\t\t\t\tthis.loader.hide();\n\t\t\t}\n\t\t);\n\n\t}\n\n\tshowEmptyListBlock()\n\t{\n\t\tthis.emptyBlock.style.display = 'block';\n\t}\n\n\thideEmptyListBlock()\n\t{\n\t\tthis.emptyBlock.style.display = 'none';\n\t}\n\n\tshowListContentBlock()\n\t{\n\t\tthis.listContent.parentNode.style.display = 'block';\n\t}\n\n\thideListContentBlock()\n\t{\n\t\tthis.listContent.parentNode.style.display = 'none';\n\t}\n\n\tsuccessFn(response)\n\t{\n\t\tconst data = response.data;\n\t\tif (this.clientSelector)\n\t\t{\n\t\t\tthis.clientSelector.enable();\n\t\t}\n\n\t\tdata.postList.forEach(postListItem => {\n\t\t\t\tconst postBlock = Tag.render`\n\t\t\t\t\t<div class=\"crm-order-instagram-view-item\">\n\t\t\t\t\t\t<input class=\"crm-order-instagram-view-item-input\" \n\t\t\t\t\t\t\ttype=\"checkbox\" \n\t\t\t\t\t\t\tid=\"${postListItem.id}\" \n\t\t\t\t\t\t\tdata-id=\"${postListItem.id}\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t<label class=\"crm-order-instagram-view-item-detail\"\n\t\t\t\t\t\t \tfor=\"${postListItem.id}\"\n\t\t\t\t\t\t \t>\n\t\t\t\t\t\t\t <span class=\"crm-order-instagram-view-item-img\" \n\t\t\t\t\t\t\t style=\"background-image: url(${postListItem.media_url})\"></span>\n\t\t\t\t\t\t\t <div class=\"crm-order-instagram-view-item-decs-block\">\n\t\t\t\t\t\t\t\t  <div class=\"crm-order-instagram-view-item-decs\">\n\t\t\t\t\t\t\t\t\t   <span class=\"crm-order-instagram-view-item-name\">\n\t\t\t\t\t\t\t\t\t   ${postListItem.caption||''}\n\t\t\t\t\t\t\t\t\t   </span>\n\t\t\t\t\t\t\t\t\t   <span class=\"crm-order-instagram-view-item-edit\"></span>\n\t\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t </div>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>`;\n\t\t\t\tthis.listContent.appendChild(postBlock);\n\n\t\t\t\tEvent.bind(postBlock, 'click', this.selectPost.bind(this));\n\t\t\t\tthis.dataContent[postListItem.id] = postListItem;\n\t\t\t\tthis.showListContentBlock();\n\t\t\t}\n\t\t);\n\n\t\tthis.loader.hide();\n\n\t\tif (data.last)\n\t\t{\n\t\t\tthis.last = data.last;\n\t\t\treturn;\n\t\t}\n\n\t\tif(Object.keys(this.dataContent).length === 0)\n\t\t{\n\t\t\tthis.hideListContentBlock();\n\t\t\tthis.showEmptyListBlock();\n\t\t}\n\n\t\tthis.stopLoading = true;\n\t}\n\n\tselectPost(event)\n\t{\n\t\tconst targetElement = event.target;\n\t\tconst id = targetElement.dataset.id;\n\n\t\tdocument.querySelectorAll('.crm-order-instagram-view-item-input').forEach(\n\t\t\telement => {\n\t\t\t\telement.checked = id === element.dataset.id;\n\t\t\t}\n\t\t)\n\t\tBX.SidePanel.Instance.close();\n\n\t\tBX.SidePanel.Instance.postMessage(\n\t\t\twindow,\n\t\t\t'seo-ads-post-selected',\n\t\t\tthis.dataContent[id]\n\t\t);\n\t}\n}","import { Helper } from './helper';\nimport { Event, Loc } from \"main.core\";\nimport {type PostSelectorOptions} from './types/postselectoroptions'\n\nexport class SeoAudience\n{\n\t_accountId: string;\n\t_clientId: string;\n\t_type: string;\n\n\tconstructor(options: PostSelectorOptions)\n\t{\n\t\tthis.helper = Helper.getCreated();\n\t\tthis.last = null;\n\t\tthis._accountId = options.accountId;\n\t\tthis._clientId = options.clientId;\n\t\tthis._type = options.type;\n\t\tthis.signedParameters = options.signedParameters;\n\t\tthis.emptyBlock = document.querySelector('.seo-ads-empty-post-list-block');\n\t\tthis.listContent = document.querySelector('.crm-order-instagram-view-list');\n\t\tthis.dataContent = [];\n\t\tthis.selectedInterest = {};\n\t\tthis.loader = new BX.Loader({\n\t\t\ttarget: document.querySelector(\".crm-order-instagram-view\")\n\t\t});\n\n\t\tthis.rangeInput = document.querySelector('.crm-ads-new-campaign-item-runner-value');\n\t\tthis.inputMax = BX('max');\n\t\tthis.inputMin = BX('min');\n\t\tthis.MAX_VALUE = 65;\n\t\tthis.MIN_VALUE = 13;\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tdocument.querySelectorAll('.crm-ads-new-campaign-item-runner-input').forEach(element => {\n\t\t\tconst block = element.closest('.crm-ads-new-campaign-item-runner-block--double');\n\t\t\tif (block)\n\t\t\t{\n\t\t\t\tthis.setDoubleInputPosition();\n\t\t\t\tthis.setDoubleLabelPosition(element);\n\t\t\t\tEvent.bind(element, 'change', this.onDoubleInputRange.bind(this));\n\t\t\t\tEvent.bind(element, 'input', this.onDoubleInputRange.bind(this));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEvent.bind(element, 'change', this.onInputRange.bind(this));\n\t\t\t\tEvent.bind(element, 'input', this.onInputRange.bind(this));\n\t\t\t}\n\t\t});\n\n\t\tthis.buildSelector();\n\t}\n\n\tcheckSex()\n\t{\n\n\t}\n\n\tonInputRange(event)\n\t{\n\t\tconst label = event.target.closest('.crm-ads-new-campaign-item-runner-block').children[0].children[0];\n\t\tconst value = event.target.value;\n\n\t\tif(value < this.MIN_VALUE)\n\t\t{\n\t\t\tevent.target.value = this.MIN_VALUE;\n\t\t}\n\n\t\tlabel.textContent = event.target.value;\n\t\tthis.rangeInput.style.width = event.target.offsetWidth * event.target.value/65 +\"px\";\n\t}\n\n\tonDoubleInputRange(event)\n\t{\n\t\tthis.setDoubleLabelPosition(event.target);\n\t\tthis.setDoubleInputPosition();\n\n\t}\n\n\tsetDoubleLabelPosition (element)\n\t{\n\t\tconst value = element.value;\n\t\tconst label = element.previousElementSibling;\n\n\t\tif (value < this.MIN_VALUE)\n\t\t{\n\t\t\telement.value = this.MIN_VALUE;\n\t\t}\n\n\t\tlabel.children[0].textContent = element.value;\n\t\tlabel.style.left = (((value - this.MIN_VALUE) / (this.MAX_VALUE - this.MIN_VALUE)) * (element.offsetWidth - 70)) + 20 + 'px';\n\n\t}\n\n\tsetDoubleInputPosition()\n\t{\n\t\tconst labelMaxLeft = BX('label-max').getBoundingClientRect().left;\n\t\tconst labelMinLeft = BX('label-min').getBoundingClientRect().left;\n\n\t\tconst min = Math.min(labelMaxLeft, labelMinLeft);\n\n\t\tif (labelMaxLeft === min)\n\t\t{\n\t\t\tthis.rangeInput.style.width = ((((this.inputMin.value - this.MIN_VALUE)/ (this.MAX_VALUE - this.MIN_VALUE)) * (this.inputMin.offsetWidth - 40)) + 20)\n\t\t\t\t- ((((this.inputMax.value - this.MIN_VALUE)/ (this.MAX_VALUE - this.MIN_VALUE)) * (this.inputMax.offsetWidth - 40)) + 20) + 'px';\n\t\t\tthis.rangeInput.style.left = (((this.inputMax.value - this.MIN_VALUE)/ (this.MAX_VALUE- this.MIN_VALUE)) * (this.inputMax.offsetWidth - 40)) + 20 + 'px';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.rangeInput.style.width = ((((this.inputMax.value - this.MIN_VALUE)/ (this.MAX_VALUE - this.MIN_VALUE)) * (this.inputMax.offsetWidth - 40)) + 20)\n\t\t\t\t- ((((this.inputMin.value - this.MIN_VALUE)/ (this.MAX_VALUE - this.MIN_VALUE)) * (this.inputMin.offsetWidth - 40)) + 20) + 'px';\n\n\t\t\tthis.rangeInput.style.left = (((this.inputMin.value - this.MIN_VALUE) / (this.MAX_VALUE - this.MIN_VALUE)) * (this.inputMin.offsetWidth - 40)) + 20 + 'px';\n\t\t}\n\t}\n\n\tbuildSelector()\n\t{\n\t\tconst selector = new BX.UI.EntitySelector.TagSelector({\n\t\t\tid: 'seo-ads-interests',\n\t\t\tdialogOptions: {\n\t\t\t\tid: 'seo-ads-interests',\n\t\t\t\tcontext: 'SEO_ADS_INTERESTS',\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: false\n\t\t\t\t},\n\t\t\t\trecentTabOptions: {\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Loc.getMessage('UI_TAG_SELECTOR_START_INPUT'),\n\t\t\t\t\t\tarrow: true,\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': event => {\n\t\t\t\t\t\tconst data = event.data.item;\n\t\t\t\t\t\tthis.selectedInterest[data.id] = data;\n\t\t\t\t\t\tlet sum = 0;\n\n\t\t\t\t\t\tfor (let key in this.selectedInterest)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsum += this.selectedInterest[key].customData.get('audienceSize');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdocument.querySelector('.crm-ads-new-campaign-item-cost-value').textContent = sum;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'facebook_interests',\n\t\t\t\t\t\tsearchable: true,\n\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tclientId: this._clientId\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t}\n\t\t});\n\n\t\tselector.renderTo(document.getElementById('seo-ads-interests'));\n\t}\n\n\tshowEmptyListBlock()\n\t{\n\t\tthis.emptyBlock.style.display = 'block';\n\t}\n\n\thideEmptyListBlock()\n\t{\n\t\tthis.emptyBlock.style.display = 'none';\n\t}\n\n\tshowListContentBlock()\n\t{\n\t\tthis.listContent.parentNode.style.display = 'block';\n\t}\n\n\thideListContentBlock()\n\t{\n\t\tthis.listContent.parentNode.style.display = 'none';\n\t}\n\n\tapply()\n\t{\n\t\tconst applyBtn = document.getElementById('ui-button-panel-apply');\n\n\t\tBX.SidePanel.Instance.close();\n\t\tlet genders = [];\n\t\tlet genderTitles = [];\n\n\t\tif(document.getElementById('male').checked)\n\t\t{\n\t\t\tgenders.push(1);\n\t\t\tgenderTitles.push(document.getElementById('male').parentNode.querySelector('span').innerText);\n\t\t}\n\n\t\tif(document.getElementById('female').checked)\n\t\t{\n\t\t\tgenders.push(2);\n\t\t\tgenderTitles.push(document.getElementById('female').parentNode.querySelector('span').innerText);\n\t\t}\n\n\t\tlet interests = []\n\t\tObject.entries(this.selectedInterest).forEach(entry => {\n\t\t\tconst [key, value] = entry;\n\t\t\tinterests.push({\n\t\t\t\tid: value.id,\n\t\t\t\tname: value.title,\n\t\t\t})\n\t\t});\n\n\t\tBX.SidePanel.Instance.postMessage(\n\t\t\twindow,\n\t\t\t'seo-fb-audience-configured',\n\t\t\t{\n\t\t\t\tinterests: interests,\n\t\t\t\tageFrom: this.inputMin.value,\n\t\t\t\tageTo: this.inputMax.value,\n\t\t\t\tgenderTitles: genderTitles,\n\t\t\t\tgenders: genders\n\t\t\t}\n\t\t);\n\t\tdocument.getElementById('ui-button-panel-apply').classList.remove('ui-btn-wait');\n\t}\n}","export class SeoCrmAudience\n{\n\tstatic apply(applyBtn)\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t\tBX.SidePanel.Instance.postMessage(\n\t\t\twindow,\n\t\t\t'seo-crm-audience-configured',\n\t\t\t{\n\t\t\t\tsegmentInclude: window.senderSegmentSelector.selectorInclude.selector.getTilesId() || [],\n\t\t\t\tsegmentExclude: window.senderSegmentSelector.selectorExclude.selector.getTilesId() || []\n\t\t\t}\n\t\t);\n\n\t\tsetTimeout(() => {\n\t\t\tapplyBtn.classList.remove('ui-btn-wait')\n\t\t}, 200)\n\t}\n}","import { Helper } from './helper';\n\nexport class PageConfiguration\n{\n\n\tconstructor()\n\t{\n\t\tthis.helper = Helper.getCreated();\n\t\tthis.targetUrlBlock = document.querySelector('.seo-ads-target-url');\n\n\t\treturn this;\n\t}\n\n\tapply(applyBtn)\n\t{\n\t\tif(!this.validateUrl(this.targetUrlBlock.value))\n\t\t{\n\t\t\tthis.removeWait(applyBtn);\n\t\t\treturn;\n\t\t}\n\n\t\tBX.SidePanel.Instance.close();\n\n\t\tBX.SidePanel.Instance.postMessage(\n\t\t\twindow,\n\t\t\t'seo-ads-target-post-selected',\n\t\t\t{\n\t\t\t\ttargetUrl: this.targetUrlBlock.value\n\t\t\t}\n\t\t);\n\t\tthis.removeWait(applyBtn);\n\t}\n\n\tremoveWait(applyBtn)\n\t{\n\t\tsetTimeout(() => {\n\t\t\tapplyBtn.classList.remove('ui-btn-wait')\n\t\t}, 200);\n\t}\n\n\tcancel()\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t}\n\n\tvalidateUrl(value)\n\t{\n\t\treturn /^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i.test(value);\n\t}\n}"],"names":["SeoAccount","options","clientNode","avatarNode","accountNode","instagramAccountNode","linkNode","provider","componentName","signedParameters","uiNodes","_helper","Helper","getInstance","loaded","clientSelector","BX","Seo","Ads","ClientSelector","clientBlock","selected","PROFILE","items","CLIENTS","canAddItems","events","onNewItem","util","popup","AUTH_URL","onSelectItem","item","setProfile","onRemoveItem","logout","CLIENT_ID","addCustomEvent","window","proxy","onSeoAuth","eventData","reload","getProvider","clientId","showBlock","request","logoutClientId","setSelected","setItems","setProvider","showBlockByAuth","i","length","client","toString","type","disable","data","enable","accountNotice","ad","style","display","dropDownData","map","accountData","caption","name","value","id","accountId","currency","fillDropDownControl","setTimeout","fireEvent","disabled","instagram","pageId","page_id","actorId","actor_id","TYPE","isSupportAccount","IS_SUPPORT_ACCOUNT","includes","push","loadAccounts","loadInstagramAccounts","showBlockMain","seoAccount","containerNode","mess","errorAction","Loc","getMessage","dlgBtnClose","action","requestData","callback","sendActionRequest","response","onResponse","error","apply","callbackSuccess","callbackFailure","showErrorPopup","ajax","runComponentAction","then","console","log","text","PopupManager","create","autoHide","lightShadow","closeByEsc","overlay","backgroundColor","opacity","onErrorPopupClose","bind","buttons","Button","click","close","setContent","show","blockCodes","Type","isArray","attributeBlock","blockNodes","querySelectorAll","forEach","blockNode","code","getAttribute","isShow","dataset","flex","btn","setAttribute","PICTURE","nameNode","innerText","NAME","LINK","removeAttribute","loadSettings","HAS_AUTH","showBlockLogin","node","innerHTML","option","Tag","render","appendChild","_instance","undefined","SeoAdBuilder","accountSelected","postSelected","pageSelected","audienceSelected","budgetSelected","toModeration","optionSelectedClass","containerId","context","onRequest","postListUrl","audienceUrl","crmAudienceUrl","pageConfigurationUrl","iBlockId","basePriceId","storeExists","isCloud","baseCurrency","arrows","document","price","_DEFAULT_CURRENCY","duration","completedStages","selectedRegions","loader","init","caller","change","loaderNode","inputNode","initiateUINodes","initiateAutoAudienceMode","_STAGES","deActivateStage","initiateAccounts","activateStage","initiateSwitcher","bindEvents","buildSelector","storeBlockShow","adCreatorData","audienceConfig","crmAudienceConfig","clientInput","avatar","link","account","instagramAccount","profileConfigured","Event","addPost","openPostSlider","createLinks","createLink","hasPostLis","showBlockRefresh","refreshButton","autoRemover","checker","select","checked","addClientBtn","_this","arrow","addEventListener","switchCollapsed","checkCurrency","div","calculateTotal","changeAudienceMode","changeProductSelectionMode","audienceExpert","showAudienceExpertModeForm","productExpert","openTargetPageSlider","addProductBtn","toCreateStoreSlider","addCurrencyBtn","addCurrency","toModerationBtn","sendToModeration","UI","Hint","querySelector","convert","nodeListToArray","Switcher","size","usedCurrency","selectedIndex","currencyExists","event","checkInstagramAccount","target","parentNode","total","element","textContent","classList","remove","add","form","budget","prepareCurrencyBlocks","scrollToStage","showCrmAudienceExpertModeForm","isShown","adsStoreBlock","key","convertToCurrency","targetCurrency","sourceCurrency","amount","Object","keys","prepareCurrencyBlock","exists","currencyBlock","count","course","newCurrency","amountCnt","success","block","closest","content","contains","height","scrollHeight","title","nodeHeight","cleanNode","titleInner","a","offsetHeight","slice","eventId","media_url","postItem","postListNode","addNewNode","previewNode","firstChild","removeChild","insertBefore","backgroundImage","postData","clipTitle","openSlider","sessid","bitrix_sessid","componentParams","ACCOUNT_ID","onPostSelected","targetUrl","reInitAdCreator","audienceSummary","buildAudienceSummary","cacheable","onTargetPageSelected","url","params","sliderOptions","width","allowChangeHistory","requestMethod","requestParams","eventName","SidePanel","Slider","getEventFullName","removeAllCustomEvents","Instance","open","onFBAudienceConfigured","onCrmAudienceConfigured","genders","ageFrom","ageTo","summary","genderTitles","join","interests","interest","segmentInclude","regions","formNode","client_id","instagramAccountId","body","mediaId","permalink","imageUrl","countries","getElementById","JSON","stringify","include","exclude","segmentExclude","input","submit","stageNum","stage","line","number","scrollIntoView","behavior","selector","EntitySelector","TagSelector","dialogOptions","tabs","visible","stub","stubOptions","searchOptions","allowCreateItem","entities","searchable","dynamicSearch","renderTo","getDialog","getRecentTab","setVisible","selectorOptions","iblockId","fileInputId","config","ENABLE_SEARCH","ENABLE_IMAGE_CHANGE_SAVING","productSelector","ProductSelector","EventEmitter","subscribe","productSelectedEvent","fieldData","fields","ID","SeoPostSelector","helper","getCreated","last","stopLoading","loadInProgress","_accountId","_clientId","_type","emptyBlock","listContent","dataContent","Loader","hideListContentBlock","topSlider","getTopSlider","iframe","contentDocument","observer","IntersectionObserver","loadPostList","root","rootMargin","threshold","observe","successFn","hide","postList","postListItem","postBlock","selectPost","showListContentBlock","showEmptyListBlock","targetElement","postMessage","SeoAudience","selectedInterest","rangeInput","inputMax","inputMin","MAX_VALUE","MIN_VALUE","setDoubleInputPosition","setDoubleLabelPosition","onDoubleInputRange","onInputRange","label","children","offsetWidth","previousElementSibling","left","labelMaxLeft","getBoundingClientRect","labelMinLeft","min","Math","recentTabOptions","sum","customData","get","applyBtn","entries","entry","SeoCrmAudience","senderSegmentSelector","selectorInclude","getTilesId","selectorExclude","PageConfiguration","targetUrlBlock","validateUrl","removeWait","test"],"mappings":"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"}