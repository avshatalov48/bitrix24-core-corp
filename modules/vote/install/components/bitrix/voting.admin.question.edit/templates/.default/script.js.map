{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["/**\n * @package bitrix\n * @subpackage vote\n * @copyright 2001-2019 Bitrix\n */\nimport 'main.polyfill.core';\nimport {ajax, Uri, Loc} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nBX.namespace('BX.Vote');\n\nclass answer {\n\tconstructor(id, data)\n\t{\n\t\tthis.id = null;\n\t\tthis.params = {\n\t\t\tisNew : true,\n\t\t\tisSaved : false\n\t\t};\n\t\tif (id > 0)\n\t\t{\n\t\t\tthis.params.isNew = false;\n\t\t\tthis.id = id;\n\t\t}\n\t\telse if (id !== 0)\n\t\t{\n\t\t\tthis.id = id;\n\t\t}\n\n\t\tthis.data =  {\n\t\t\tMESSAGE : \"\",\n\t\t\tMESSAGE_TYPE : \"text\",\n\t//\t\tIMAGE_ID : \"\",\n\t\t\tFIELD_TYPE : 0,\n\t//\t\tFIELD_WIDTH : 0, //out of date\n\t//\t\tFIELD_HEIGHT : 0, //out of date\n\t//\t\tFIELD_PARAM : \"\", //out of date\n\t//\t\tACTIVE : \"Y\",\n\t//\t\tC_SORT : 0,\n\t//\t\tCOLOR : \"\" //out of date\n\t\t};\n\n\t\tthis.adjust(data);\n\t\tEventEmitter.subscribe(this, 'onApply', this.apply.bind(this));\n\t\tEventEmitter.subscribe(this, 'onDelete', this.delete.bind(this));\n\t}\n\tadjust(data)\n\t{\n\t\tlet i, d = BX.type.isPlainObject(data) ? data : {};\n\t\tfor (i in this.data)\n\t\t{\n\t\t\tif (this.data.hasOwnProperty(i))\n\t\t\t{\n\t\t\t\tif (d[i])\n\t\t\t\t\tthis.data[i] = d[i];\n\t\t\t}\n\t\t}\n\t}\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\tgetData()\n\t{\n\t\treturn this.data;\n\t}\n\tapply({data: [fromData]})\n\t{\n\t\tthis.adjust(fromData);\n\t\treturn this;\n\t}\n\tdelete()\n\t{\n\t\treturn this;\n\t}\n}\n\nanswer.repo = {};\nanswer.getItem = function(id, data) {\n\tconst item = new answer(id, BX.type.isPlainObject(data) ? data : {});\n\tif (id !== 0 && answer.repo[id])\n\t{\n\t\tanswer.repo[id] = null;\n\t\tdelete answer.repo[id];\n\t\tanswer.repo[id] = item;\n\t}\n\treturn item;\n};\n\nclass entityType\n{\n\tconstructor (values)\n\t{\n\t\tthis.values = [];\n\t\tthis.valuesById = {};\n\t\tthis.valuesByCode = {};\n\t\tvalues.forEach(function(current) {\n\t\t\tthis.values.push(current);\n\t\t\tthis.valuesById[current[\"ID\"].toLowerCase()] = current;\n\t\t\tthis.valuesByCode[current[\"CODE\"].toLowerCase()] = current;\n\t\t}.bind(this));\n\t}\n\tgetByCode(code)\n\t{\n\t\treturn this.valuesByCode[code];\n\t}\n\tgetById(id)\n\t{\n\t\treturn this.valuesById[id];\n\t}\n\tgetIdByCode(code)\n\t{\n\t\tif (this.valuesByCode.hasOwnProperty(code))\n\t\t{\n\t\t\treturn this.valuesByCode[code][\"ID\"];\n\t\t}\n\t\treturn null;\n\t}\n}\n\nconst answerTypes = {\n\tsetTypes : function(values) {\n\t\tanswerTypes.obj = new entityType(values);\n\t},\n\tgetValues : function() {\n\t\treturn answerTypes.obj.values;\n\t},\n\tisTextType : function(id) {\n\t\tlet item = answerTypes.obj.getById(id);\n\t\tif (BX.type.isPlainObject(item))\n\t\t{\n\t\t\treturn (item[\"CODE\"].toUpperCase().substr(0, 4) === \"TEXT\");\n\t\t}\n\t\treturn false;\n\t}\n};\nconst questionTypes = {\n\tsetTypes : function(values) {\n\t\tquestionTypes.obj = new entityType(values);\n\t},\n\tisCompatibilityMode : function() {\n\t\tlet val = BX('FIELD_TYPE').value;\n\t\treturn (String(val).toLowerCase() === questionTypes.obj.getIdByCode(\"compatibility\"));\n\t},\n\tgetActive : function() {\n\t\treturn String(BX('FIELD_TYPE').value).toUpperCase();\n\t}\n};\n\nclass answerEditor\n{\n\tconstructor()\n\t{\n\t\tthis.id = 'Editor';\n\t\tthis.popup = null;\n\t\tthis.reset();\n\n\t\tthis.debug = true;\n\n\t\treturn this;\n\t}\n\tonApply(formData)\n\t{\n\t\tEventEmitter.emit(this.answer, 'onApply', [formData]);\n\t\tEventEmitter.emit(this, 'onApply', [\n\t\t\tthis.answer.getId(),\n\t\t\tthis.answer.getData(),\n\t\t\tObject.assign({}, this.gridData)\n\t\t]);\n\t\tthis.reset();\n\t}\n\tonCancel()\n\t{\n\t\tEventEmitter.emit(this.answer, \"onCancel\", []);\n\t\tthis.reset();\n\t}\n\tonDelete()\n\t{\n\t\tEventEmitter.emit(this.answer, \"onDelete\", []);\n\t\tthis.reset();\n\t}\n\tsetGridData(gridData)\n\t{\n\t\tthis.gridData = {\n\t\t\tgridInstanceId : gridData[\"gridInstanceId\"],\n\t\t\tgridId : gridData[\"gridId\"],\n\t\t\tmaxSort : gridData[\"maxSort\"],\n\t\t};\n\t\treturn this;\n\t}\n\tgetGridId()\n\t{\n\t\treturn this.gridData.gridId;\n\t}\n\tsetAnswer(id, data)\n\t{\n\t\tconst item = answer.getItem(id, data);\n\t\tif (this.answer !== null && this.answer !== item)\n\t\t\tthis.onCancel();\n\t\tthis.answer = item;\n\t\treturn this;\n\t}\n\treset()\n\t{\n\t\tdelete this.answer;\n\t\tthis.answer = null;\n\t\tdelete this.gridData;\n\t\tthis.gridData = {\n\t\t\tid : null,\n\t\t\tgridId : null,\n\t\t\tmaxSort : null\n\t\t};\n\t}\n\tshow()\n\t{\n\t\tthis.showEditor(this.answer.getData());\n\t}\n\tshowEditor(data)\n\t{\n\t\tif (this.popup !== null)\n\t\t\tthis.popup.close();\n\t\tlet isTextMode = false;\n\t\tlet fieldType = String(data[\"FIELD_TYPE\"]);\n\t\tlet htmlReg = '';\n\t\tanswerTypes.getValues().forEach(function(current){\n\t\t\thtmlReg += ['<option value=\"' + current[\"ID\"] + '\"' + (fieldType === current[\"ID\"] ? ' selected' : '') + '>', current[\"TITLE\"], '</option>'].join('');\n\t\t});\n\t\thtmlReg = [\n\t\t\t\t'<div class=\"ui-form-block ui-form-block-html-text\">\\\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-radio ui-ctl-wa ui-ctl-xs\"> \\\n\t\t\t\t\t\t<input type=\"radio\" name=\"answer[MESSAGE_TYPE]\" ' + (data[\"MESSAGE_TYPE\"] === \"html\" ? \"\" : \"checked\" ) + ' class=\"ui-ctl-element\" value=\"text\"> \\\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">text</div> \\\n\t\t\t\t\t</label>\\\n\t\t\t\t\t<label className=\"ui-ctl ui-ctl-wa ui-ctl-xs\"><div class=\"ui-ctl-label-text\">&nbsp;/&nbsp;</div></label> \\\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-radio ui-ctl-wa ui-ctl-xs\"> \\\n\t\t\t\t\t\t<input type=\"radio\" name=\"answer[MESSAGE_TYPE]\" ' + (data[\"MESSAGE_TYPE\"] === \"html\" ? \"checked\" : \"\" ) + ' class=\"ui-ctl-element\" value=\"html\"> \\\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">html</div> \\\n\t\t\t\t\t</label>\\\n\t\t\t\t</div>\\\n\t\t\t\t<div class=\"ui-form-block\">\\\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea\" id=\"answer_MESSAGE_block\">\\\n\t\t\t\t\t\t<textarea name=\"answer[MESSAGE]\" class=\"ui-ctl-element\" id=\"ANSWER_MESSAGE\" placeholder=\"' + Loc.getMessage('VOTE_ANSWER_PLACEHOLDER') + '\">' + BX.util.htmlspecialchars(data[\"MESSAGE\"]) +'</textarea>\\\n\t\t\t\t\t</div>\\\n\t\t\t\t</div>\\\n\t\t\t\t<input id=\"answer_FIELD_TYPE\" name=\"answer[FIELD_TYPE]\" type=\"hidden\" value=\"\" class=\"ui-ctl-element\"> ' +\n\t\t\t\t(questionTypes.isCompatibilityMode() === true ?\n\t\t\t\t'<div class=\"ui-form-block\">\\\n\t\t\t\t\t<label for=\"id1\" class=\"ui-ctl-label-text\">' + Loc.getMessage('VOTE_ANSWER_FIELD_TYPE') + '</label>\\\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown\">\\\n\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\\\n\t\t\t\t\t\t<select name=\"answer[FIELD_TYPE]\" class=\"ui-ctl-element\">' + htmlReg + '</select>\\\n\t\t\t\t\t</div>\\\n\t\t\t\t</div> ' : '<input  name=\"answer[FIELD_TYPE]\" type=\"hidden\" value=\"' + questionTypes.getActive() + '\">')].join();\n\t\tlet htmlText = '';\n\t\tanswerTypes.getValues().forEach(function(current){\n\t\t\tif (current[\"CODE\"].substring(0, 4).toUpperCase() === \"TEXT\")\n\t\t\t{\n\t\t\t\tisTextMode = isTextMode || (fieldType === current[\"ID\"]);\n\t\t\t\thtmlText += ['<option value=\"' + current[\"ID\"] + '\"' + (fieldType === current[\"ID\"] ? ' selected' : '') + '>', current[\"TITLE\"], '</option>'].join(\"\");\n\t\t\t}\n\t\t});\n\t\thtmlText = [\n\t\t\t\t'<div class=\"ui-form-block ui-form-block-html-text\">\\\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-radio ui-ctl-wa ui-ctl-xs\"> \\\n\t\t\t\t\t\t<input type=\"radio\" name=\"answer[MESSAGE_TYPE]\" ' + (data[\"MESSAGE_TYPE\"] === \"html\" ? \"\" : \"checked\" ) + ' class=\"ui-ctl-element\" value=\"text\"> \\\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">text</div> \\\n\t\t\t\t\t</label>\\\n\t\t\t\t\t<label className=\"ui-ctl ui-ctl-wa ui-ctl-xs\"><div class=\"ui-ctl-label-text\">&nbsp;/&nbsp;</div></label> \\\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-radio ui-ctl-wa ui-ctl-xs\"> \\\n\t\t\t\t\t\t<input type=\"radio\" name=\"answer[MESSAGE_TYPE]\" ' + (data[\"MESSAGE_TYPE\"] === \"html\" ? \"checked\" : \"\" ) + ' class=\"ui-ctl-element\" value=\"html\"> \\\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">html</div> \\\n\t\t\t\t\t</label>\\\n\t\t\t\t</div>\\\n\t\t\t\t<div class=\"ui-form-block\"> \\\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea\" id=\"answer_MESSAGE_block\">\\\n\t\t\t\t\t\t<textarea name=\"answer[MESSAGE]\" class=\"ui-ctl-element\" id=\"ANSWER_MESSAGE\" placeholder=\"' + Loc.getMessage('VOTE_ANSWER_PLACEHOLDER1') + '\">'\n\t\t\t\t\t\t\t+ BX.util.htmlspecialchars(data[\"MESSAGE\"] || Loc.getMessage('VOTE_ANSWER_TEXT_OTHER')) +\n\t\t\t\t\t\t'</textarea>\\\n\t\t\t\t\t</div>\\\n\t\t\t\t</div>\\\n\t\t\t\t<div class=\"ui-form-block\">\\\n\t\t\t\t\t<label for=\"id1\" class=\"ui-ctl-label-text\">' + Loc.getMessage('VOTE_ANSWER_FIELD_TYPE') + '</label>\\\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown\">\\\n\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\\\n\t\t\t\t\t\t<select name=\"answer[FIELD_TYPE]\" class=\"ui-ctl-element\">', htmlText, '</select>\\\n\t\t\t\t\t</div>\\\n\t\t\t\t</div> '\n\t\t\t].join();\n\t\tlet editorNode = BX.create(\"DIV\", {\n\t\t\tattrs : {\n\t\t\t\tid : this.id + 'Proper',\n\t\t\t\tclassName : \"vote-edit-popup\"\n\t\t\t},\n\t\t\thtml : [\n\t\t\t\t'<div class=\"vote-edit-inp-wrap\">\\\n\t\t\t\t\t<form onsubmit=\"return false;\" id=\"', this.id , '_form\">\\\n\t\t\t\t\t\t',\n\t\t\t\t(isTextMode ? htmlText : htmlReg),\n\t\t\t\t\t'</form>\\\n\t\t\t\t</div>'].join(\"\")\n\t\t});\n\t\tconst onApplyPopupPressed = function() {\n\t\t\tconst d = BX.ajax.prepareForm(BX(this.id + '_form'));\n\t\t\tif (BX.type.isNotEmptyString(d.data.answer.MESSAGE))\n\t\t\t{\n\t\t\t\tthis.onApply(d.data.answer);\n\t\t\t\tthis.popup.fired = true;\n\t\t\t\tthis.popup.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.addClass(BX('answer_MESSAGE_block'), 'ui-ctl-danger');\n\t\t\t}\n\t\t}.bind(this);\n\n\t\tthis.popup = BX.PopupWindowManager.create(\n\t\t\t'popup' + this.id,\n\t\t\tnull,\n\t\t\t{\n\t\t\t\ttitleBar: Loc.getMessage('VOTE_ANSWER_MESSAGE'),\n\t\t\t\tclassName : \"vote-answer\",\n\t\t\t\tautoHide : false,\n\t\t\t\tlightShadow : true,\n\t\t\t\tcloseIcon : true,\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tzIndex : 1,\n\t\t\t\tcontent : editorNode,\n\t\t\t\toverlay : {},\n\t\t\t\tevents : {\n\t\t\t\t\tonPopupClose : function(){\n\t\t\t\t\t\tif (this.popup.fired !== true)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tEventEmitter.emit(this, \"onCancel\", [this]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.popup.destroy();\n\t\t\t\t\t\tthis.popup = null;\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\tonAfterPopupShow : function(){\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tif (BX(this.id + '_form'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.focus(BX(this.id + '_form').elements[\"ANSWER_MESSAGE\"]);\n\t\t\t\t\t\t\t\tBX.bind(BX(this.id + '_form').elements[\"ANSWER_MESSAGE\"], \"keydown\", function(e) {\n\t\t\t\t\t\t\t\t\tif ((e.ctrlKey === true || e.altKey === true) && e.keyCode === 13)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tonApplyPopupPressed();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}.bind(this), 50)\n\t\t\t\t\t}.bind(this)\n\t\t\t\t},\n\t\t\t\tbuttons : [\n\t\t\t\t\tnew BX.PopupWindowButton(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext : Loc.getMessage('VOTE_SAVE'),\n\t\t\t\t\t\t\tclassName : \"\",\n\t\t\t\t\t\t\tevents : {\n\t\t\t\t\t\t\t\tclick : onApplyPopupPressed\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t),\n\t\t\t\t\tnew BX.PopupWindowButton(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext : Loc.getMessage('VOTE_CANCEL'),\n\t\t\t\t\t\t\tclassName : \"\",\n\t\t\t\t\t\t\tevents : { click : function(){\n\t\t\t\t\t\t\t\tthis.onCancel();\n\t\t\t\t\t\t\t\tthis.popup.fired = true;\n\t\t\t\t\t\t\t\tthis.popup.close();\n\t\t\t\t\t\t\t}.bind(this) } } )\n\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tthis.popup.show();\n\t\tthis.popup.adjustPosition();\n\t}\n}\n\nBX.Vote.addTextAnswer = function(gridInstanceId) { initEditor(gridInstanceId, 0, {FIELD_TYPE : 4}); };\nBX.Vote.addAnswer = function(gridInstanceId, answerData) { initEditor(gridInstanceId, 0, answerData); };\nBX.Vote.editAnswer = function(gridInstanceId, rowId) {\n\tconst grid = BX.Main.gridManager.getInstanceById(answerPopupParams[gridInstanceId][\"gridId\"]);\n\tlet data = (grid !== null ? grid.getRows().getById(rowId).getEditData() : {});\n\tinitEditor(gridInstanceId, rowId, data);\n};\nBX.Vote.setTypes = function(types) {\n\tquestionTypes.setTypes(types.questionTypes);\n\tanswerTypes.setTypes(types.answerTypes);\n};\nBX.Vote.setParams = function(gridInstanceId, params) {\n\tsetTimeout(function(){\n\t\tbindForm(params['formId'], params.gridId, gridInstanceId);\n\t\tBX.bind(document, \"keydown\", function(e) {\n\t\t\tif (e.keyCode === 45 &&\n\t\t\t\t(e.ctrlKey === false && e.metaKey === false && e.altKey === false) &&\n\t\t\t\t(!BX(e.target) || BX(e.target).tagName === 'BODY'))\n\t\t\t{\n\t\t\t\tBX.Vote.addAnswer(gridInstanceId, {});\n\t\t\t}\n\t\t});\n\t}, 50);\n\tanswerPopupParams[gridInstanceId] = {\n\t\tgridInstanceId : gridInstanceId,\n\t\tgridId : params.gridId,\n\t\tmaxSort : (params[\"maxSort\"] || 100)\n\t};\n\n\tEventEmitter.subscribeOnce('onVoteQuestionDelete', ({data: [voteId, questionId]}) => {\n\t\tif (confirm(Loc.getMessage('VOTE_DELETE_RECORD_CONFIRM')))\n\t\t{\n\t\t\tajax.runComponentAction('bitrix:voting.admin.question.edit',\n\t\t\t\t'delete',\n\t\t\t\t{\n\t\t\t\t\tmode: 'class',\n\t\t\t\t\tsignedParameters: params.componentSignedParams,\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then(() => {\n\t\t\t\twindow.location = Uri.addParam(\n\t\t\t\t\t'/bitrix/admin/vote_question_list.php',\n\t\t\t\t\t{VOTE_ID: voteId, lang: Loc.getMessage('LANGUAGE_ID')});\n\t\t\t}, ({errors}) => {\n\t\t\t\tconst errorMessages = [];\n\t\t\t\terrors.forEach(({message}) => {\n\t\t\t\t\terrorMessages.push(message);\n\t\t\t\t});\n\t\t\t\tMessageBox.alert(errorMessages.join(' '));\n\t\t\t});\n\t\t}\n\t});\n};\n\nlet answerPopup = null;\nlet answerPopupParams = {};\nconst initEditor = function(gridInstanceId, id, data) {\n\tif (answerPopup === null)\n\t{\n\t\tanswerPopup = new answerEditor();\n\t\tEventEmitter.subscribe(\n\t\t\tanswerPopup,\n\t\t\t'onApply',\n\t\t\tfunction({data: [answerId, data, gridData]})\n\t\t\t{\n\t\t\t\tconst gridId = gridData['gridId'];\n\t\t\t\tconst grid = BX.Main.gridManager.getInstanceById(gridId);\n\n\t\t\t\tif (grid instanceof BX.Main.grid)\n\t\t\t\t{\n\t\t\t\t\tlet newRowData = BX.clone(data);\n\t\t\t\t\tif (answerId !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tgrid.updateRow(answerId, newRowData, null, function(){});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tanswerPopupParams[gridData[\"gridInstanceId\"]][\"maxSort\"] += 100;\n\t\t\t\t\t\tnewRowData[\"C_SORT\"] = answerPopupParams[gridData[\"gridInstanceId\"]][\"maxSort\"];\n\t\t\t\t\t\tgrid.addRow(newRowData, null, function(){});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\tanswerPopup.\n\t\tsetGridData(answerPopupParams[gridInstanceId]).\n\t\tsetAnswer(id, data).\n\t\tshow();\n};\nEventEmitter.subscribe(\n\t'Grid::beforeRequest',\n\tfunction({data: [gridData, args]})\n\t{\n\t\tconsole.log('gridData, args: ', gridData, args);\n\t\tlet i;\n\t\tfor (i in answerPopupParams)\n\t\t{\n\t\t\tif (answerPopupParams.hasOwnProperty(i))\n\t\t\t{\n\t\t\t\tif (answerPopupParams[i][\"gridId\"] === args.gridId)\n\t\t\t\t{\n\t\t\t\t\targs.data.gridId = args.gridId;\n\t\t\t\t\targs.data.gridInstanceId = answerPopupParams[i][\"gridInstanceId\"];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\nconst bindForm = function(formId, gridId, gridInstanceId) {\n\tlet form = BX(formId, true);\n\tlet controlName = \"save\";\n\tlet func = (function(event) {\n\t\tform.removeEventListener('submit', func);\n\t\tlet grid = BX.Main.gridManager.getInstanceById(gridId);\n\t\tif (!grid.getRows().hasEditable())\n\t\t{\n\t\t\tprepareForm(form, gridId, gridInstanceId);\n\t\t\treturn true;\n\t\t}\n\t\tlet func1 = function({data: [someGrid]}) {\n\t\t\tif (someGrid === grid)\n\t\t\t{\n\t\t\t\tform.appendChild(BX.create(\"INPUT\", { \"props\": { \"type\": \"hidden\", \"name\": controlName, \"value\":  \"Y\" } } ));\n\t\t\t\tprepareForm(form, gridId, gridInstanceId);\n\t\t\t\tform.submit();\n\t\t\t}\n\t\t};\n\t\tEventEmitter.subscribeOnce(\"Grid::updated\", func1);\n\t\tgrid.editSelectedSave();\n\t\treturn BX.PreventDefault(event);\n\t});\n\n\tform.addEventListener('submit', func);\n\tif (form.elements['apply'])\n\t{\n\t\tform.elements['apply'].addEventListener('mousedown', function () { controlName = \"apply\"; });\n\t}\n\n\tconst f = function(e) {\n\t\tconst el = e.target;\n\t\tconst rows = BX.Main.gridManager.getInstanceById(gridId).getRows();\n\t\tif (!questionTypes.isCompatibilityMode() && rows)\n\t\t{\n\t\t\tlet ids = [];\n\t\t\trows.getRows().forEach(function(current){\n\t\t\t\tconst attrs = BX.parseJSON(BX.data(current.getNode(), \"item\"), current);\n\t\t\t\tif (attrs &&\n\t\t\t\t\tBX.type.isPlainObject(attrs) &&\n\t\t\t\t\tattrs.hasOwnProperty(\"field_type\") &&\n\t\t\t\t\tString(attrs[\"field_type\"]) !== String(el.value) &&\n\t\t\t\t\t!answerTypes.isTextType(attrs[\"field_type\"]))\n\t\t\t\t{\n\t\t\t\t\tcurrent.select();\n\t\t\t\t\tids.push(current.getId());\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (ids.length > 0)\n\t\t\t{\n\t\t\t\tBX.Main.gridManager.getInstanceById(gridId).reloadTable(\n\t\t\t\t\t\"POST\",\n\t\t\t\t\t{\n\t\t\t\t\t\tID: ids,\n\t\t\t\t\t\taction_button_grid_vote_answer: \"change_answer_type\",\n\t\t\t\t\t\tFIELD_TYPE : this.value\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\tdocument.querySelectorAll('#' + formId + ' [name=FIELD_TYPE]').forEach((node) => {\n\t\tnode.addEventListener('change', f);\n\t});\n};\nconst prepareForm = function(form, gridId/*, gridInstanceId*/) {\n\tconst grid = BX.Main.gridManager.getInstanceById(gridId);\n\tif (grid)\n\t{\n\t\tconst rows = grid.getRows().getRows();\n\t\trows.forEach(function(current) {\n\t\t\tif (current.getIndex() < 1 || current.getId() === \"template_0\")\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst id = current.getId();\n\n\t\t\tform.appendChild(BX.create(\"INPUT\", {\n\t\t\t\t\tprops : {\n\t\t\t\t\t\ttype : \"hidden\",\n\t\t\t\t\t\tname : \"ANSWER[\" + id.toLowerCase() + \"][ID]\",\n\t\t\t\t\t\tvalue : id\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t));\n\t\t\tconst attrs = BX.parseJSON(BX.data(current.getNode(), \"item\"), current);\n\t\t\tvar func = function(prefix, params, depth)\n\t\t\t{\n\t\t\t\tvar key;\n\t\t\t\tfor (var j in params)\n\t\t\t\t{\n\t\t\t\t\tif (params.hasOwnProperty(j))\n\t\t\t\t\t{\n\t\t\t\t\t\tkey = \"[\" + (depth > 0 ? j : String(j).toUpperCase()) + \"]\";\n\t\t\t\t\t\tif (BX.type.isPlainObject(params[j]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfunc(prefix + key, params[j], depth + 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tform.appendChild(BX.create('INPUT', {\n\t\t\t\t\t\t\t\t\tprops : {\n\t\t\t\t\t\t\t\t\t\ttype : \"hidden\",\n\t\t\t\t\t\t\t\t\t\tname : prefix + key,\n\t\t\t\t\t\t\t\t\t\tvalue : params[j]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (BX.type.isPlainObject(attrs))\n\t\t\t{\n\t\t\t\tfunc(\"ANSWER[\" + id + \"]\", attrs, 0);\n\t\t\t}\n\t\t});\n\t}\n};\nlet picker = null;\nBX.Vote.showColorPicker = function(input)\n{\n\tif (picker === null)\n\t{\n\t\tpicker = new BX.ColorPicker({\n\t\t\tbindElement: null,\n\t\t\tpopupOptions: {\n\t\t\t\tangle: true,\n\t\t\t}\n\t\t})\n\t}\n\tpicker.open({\n\t\tselectedColor: BX.type.isNotEmptyString(input.value) ? input.value : null,\n\t\tbindElement: input,\n\t\tonColorSelected: function (color) { input.value = color; }\n\t});\n}"],"names":["BX","namespace","answer","id","data","params","isNew","isSaved","MESSAGE","MESSAGE_TYPE","FIELD_TYPE","adjust","EventEmitter","subscribe","apply","bind","delete","i","d","type","isPlainObject","hasOwnProperty","fromData","repo","getItem","item","entityType","values","valuesById","valuesByCode","forEach","current","push","toLowerCase","code","answerTypes","setTypes","obj","getValues","isTextType","getById","toUpperCase","substr","questionTypes","isCompatibilityMode","val","value","String","getIdByCode","getActive","answerEditor","popup","reset","debug","formData","emit","getId","getData","Object","assign","gridData","gridInstanceId","gridId","maxSort","onCancel","showEditor","close","isTextMode","fieldType","htmlReg","join","Loc","getMessage","util","htmlspecialchars","htmlText","substring","editorNode","create","attrs","className","html","onApplyPopupPressed","ajax","prepareForm","isNotEmptyString","onApply","fired","addClass","PopupWindowManager","titleBar","autoHide","lightShadow","closeIcon","closeByEsc","zIndex","content","overlay","events","onPopupClose","destroy","onAfterPopupShow","setTimeout","focus","elements","e","ctrlKey","altKey","keyCode","buttons","PopupWindowButton","text","click","show","adjustPosition","Vote","addTextAnswer","initEditor","addAnswer","answerData","editAnswer","rowId","grid","Main","gridManager","getInstanceById","answerPopupParams","getRows","getEditData","types","setParams","bindForm","document","metaKey","target","tagName","subscribeOnce","voteId","questionId","confirm","runComponentAction","mode","signedParameters","componentSignedParams","then","window","location","Uri","addParam","VOTE_ID","lang","errors","errorMessages","message","MessageBox","alert","answerPopup","answerId","newRowData","clone","updateRow","addRow","setGridData","setAnswer","args","console","log","formId","form","controlName","func","event","removeEventListener","hasEditable","func1","someGrid","appendChild","submit","editSelectedSave","PreventDefault","addEventListener","f","el","rows","ids","parseJSON","getNode","select","length","reloadTable","ID","action_button_grid_vote_answer","querySelectorAll","node","getIndex","props","name","prefix","depth","key","j","picker","showColorPicker","input","ColorPicker","bindElement","popupOptions","angle","open","selectedColor","onColorSelected","color"],"mappings":"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"}