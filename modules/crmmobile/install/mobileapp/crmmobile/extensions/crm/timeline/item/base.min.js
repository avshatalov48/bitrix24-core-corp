jn.define("crm/timeline/item/base",((e,t,i)=>{const{MarketBanner:n}=e("crm/timeline/item/ui/market-banner");const{TimelineItemHeader:o}=e("crm/timeline/item/ui/header");const{TimelineItemIcon:r}=e("crm/timeline/item/ui/icon");const{TimelineItemBody:s}=e("crm/timeline/item/ui/body");const{TimelineItemFooter:a}=e("crm/timeline/item/ui/footer");const{TimelineItemBackground:l}=e("crm/timeline/item/ui/styles");const{TimelineItemBackgroundLayer:h}=e("crm/timeline/item/ui/background");const{TimelineItemLoadingOverlay:c}=e("crm/timeline/item/ui/loading-overlay");const{get:d}=e("utils/object");const{EventEmitter:m}=e("event-emitter");class u extends LayoutComponent{constructor(e){super(e);this.uid=Random.getString();this.itemScopeEventBus=m.createWithUid(this.uid);this.timelineScopeEventBus=e.timelineScopeEventBus;this.backgroundLayerRef=null;this.loadingOverlayRef=null;this.containerRef=null}get model(){return this.props.model}get layoutSchema(){return this.model.layout}get hasIcon(){const e=d(this.layoutSchema,"body.logo",null);return e!==null}get hasNote(){const e=d(this.layoutSchema,"body.blocks",{});return Object.values(e).some((e=>{if(e.rendererName==="Note"){const t=d(e,"properties.text","");return t.length>0}return false}))}get backgroundColor(){return l.getByModel(this.model)}get hasPlayer(){return false}render(){return this.renderContainer(this.renderInnerContent(),this.model.needShowMarketBanner&&n({onClick:()=>this.openMarketBannerInfo(),onClose:()=>this.hideMarketBanner()}))}renderContainer(...e){return View({ref:e=>this.containerRef=e,style:{borderRadius:16,padding:0,marginBottom:16,borderColor:"#DFE0E3",borderWidth:this.model.hasLowPriority?1:0}},...e)}renderInnerContent(){return View({},new h({ref:e=>this.backgroundLayerRef=e,color:this.backgroundColor,opacity:this.model.hasLowPriority?.4:1}),View({style:{flexDirection:"row",justifyContent:"space-between"}},this.hasIcon&&new r({logo:this.layoutSchema.body.logo,additionalIcon:this.layoutSchema.icon,counterType:this.layoutSchema.icon.counterType,onAction:this.onAction.bind(this),hasPlayer:this.hasPlayer,itemScopeEventBus:this.itemScopeEventBus}),this.layoutSchema.header&&new o({...this.layoutSchema.header,hasIcon:this.hasIcon,opacity:this.model.hasLowPriority?.6:1,onAction:this.onAction.bind(this),useFriendlyDate:this.model.isScheduled||this.model.isPinned,isReadonly:this.model.isReadonly})),this.layoutSchema.body&&new s({...this.layoutSchema.body,onAction:this.onAction.bind(this),isReadonly:this.model.isReadonly,model:this.model,itemScopeEventBus:this.itemScopeEventBus}),this.layoutSchema.footer&&new a({...this.layoutSchema.footer,onAction:this.onAction.bind(this),isReadonly:this.model.isReadonly,hasNote:this.hasNote}),new c({ref:e=>this.loadingOverlayRef=e}))}openMarketBannerInfo(){helpdesk.openHelpArticle("14529842")}hideMarketBanner(){if(this.props.onHideMarketBanner){this.props.onHideMarketBanner()}}onAction({type:e,value:t,actionParams:i}){if(this.props.onAction){this.props.onAction({type:e,value:t,actionParams:i,source:this})}}blink(){return new Promise((e=>{if(this.backgroundLayerRef){return this.backgroundLayerRef.blink()}else{e()}}))}fadeOut(){return new Promise((e=>{if(this.containerRef){this.containerRef.animate({duration:300,opacity:0},e)}else{e()}}))}fadeIn(){return new Promise((e=>{if(this.containerRef){this.containerRef.animate({duration:300,opacity:1},e)}else{e()}}))}showLoader(){if(this.loadingOverlayRef){this.loadingOverlayRef.show()}}hideLoader(){if(this.loadingOverlayRef){this.loadingOverlayRef.hide()}}}i.exports={TimelineItemBase:u}}));
//# sourceMappingURL=base.map.js