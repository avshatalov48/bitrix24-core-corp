jn.define("catalog/store/document-card/component",((t,e,o)=>{const{PureComponent:n}=t("layout/pure-component");const{CatalogStoreActivationWizard:c}=t("catalog/store/activation-wizard");const{DetailCardComponent:r}=t("layout/ui/detail-card");const{DocumentType:s}=t("catalog/store/document-type");class a extends n{static createDetailCardComponent(t){const e=t.card.tabs.find((t=>t.id==="main"));if(e){e.desktopUrl=t.desktopUrl}r.create(t.card).setItemActions([{id:"conductDocument",type:"primary",title:BX.message("MOBILE_STORE_DOCUMENT_CARD_COMPONENT_ACTION_CONDUCT_DOCUMENT"),onClickCallback:e=>new Promise(((o,n)=>{BX.ajax.runAction(`${t.endpoint}.conduct`,{json:{entityId:e.ID,docType:e.DOC_TYPE}}).then((n=>{t.eventEmitter.emit("Catalog.StoreDocument::onConduct",[e.DOC_TYPE]);o(n.data)}),(t=>{n(this.processErrorAction(t))})).catch((t=>{n(this.processErrorAction(t))}))})),onActiveCallback:e=>this.hasPermission(t.permissions,e,"catalog_store_document_conduct")&&!t.isDocumentConducted(e)}]).renderTo(layout).setAnalyticsProvider((t=>({entity:"store-document",type:t.DOC_TYPE}))).setMenuActionsProvider(((e,o)=>{const{entityModel:n}=e;const c=[];const r=this.hasPermission(t.permissions,n,"catalog_store_document_cancel")&&t.isDocumentConducted(n);if(r){c.push({id:"cancelDocument",sectionCode:"action",onItemSelected:(e,c)=>{const r={id:"cancelDocument"};o.onActionStart(r);BX.ajax.runAction(`${t.endpoint}.cancel`,{json:{entityId:n.ID,docType:n.DOC_TYPE}}).then((e=>{t.eventEmitter.emit("Catalog.StoreDocument::onCancel",[n.DOC_TYPE]);o.onActionSuccess(r,e.data)}),(t=>{o.onActionFailure(r,this.processErrorAction(t))}))},title:BX.message("MOBILE_STORE_DOCUMENT_CARD_COMPONENT_ACTION_CANCEL_DOCUMENT"),iconUrl:"/bitrix/mobileapp/catalogmobile/extensions/catalog/store/document-card/component/images/cancel_document.png"})}c.push({type:UI.Menu.Types.DESKTOP,showHint:false,showTopSeparator:r,data:{qrUrl:t.desktopUrl}});const s=this.getArticleCodeByType(n.DOC_TYPE);if(s){c.push({type:UI.Menu.Types.HELPDESK,data:{articleCode:s}})}return c}))}static getArticleCodeByType(t){switch(t){case s.StoreAdjustment:return"14662772";case s.Arrival:return"14662786";default:return null}}static processErrorAction(t){const e=t.errors.length>0?t.errors:[{message:"Could not perform action"}];const o=c.openIfNeeded(e);return{errors:e,showErrors:!o}}static hasPermission(t,e,o){return!e||t.document[e.DOC_TYPE][o]===true}}o.exports={DocumentCardComponent:a}}));
//# sourceMappingURL=extension.map.js