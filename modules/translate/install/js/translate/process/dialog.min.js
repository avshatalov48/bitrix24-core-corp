(function(){"use strict";BX.namespace("BX.Translate");if(BX.Translate.ProcessDialog){return}BX.Translate.ProcessDialog=function(){this.id="";this.settings={};this.optionsFields={};this.optionsFieldsValue={};this.optionsFieldsBlock=null;this.popupWindow=null;this.isShown=false;this.buttons={};this.summaryBlock=null;this.error=null;this.errorBlock=null;this.warningBlock=null;this.progressBar=null;this.progressBarBlock=null;this.messages={};this.handlers={}};BX.Translate.ProcessDialog.prototype={STYLES:{dialogProcessWindow:"bx-translate-dialog-process",dialogProcessPopup:"bx-translate-dialog-process-popup",dialogProcessSummary:"bx-translate-dialog-process-summary",dialogProcessProgressbar:"bx-translate-dialog-process-progressbar",dialogProcessOptions:"bx-translate-dialog-process-options",dialogProcessOptionsTitle:"bx-translate-dialog-process-options-title",dialogProcessOptionsInput:"bx-translate-dialog-process-options-input",dialogProcessOptionsObligatory:"ui-alert ui-alert-xs ui-alert-warning",dialogProcessOptionText:"bx-translate-dialog-process-option-text",dialogButtonAccept:"popup-window-button-accept",dialogButtonDisable:"popup-window-button-disable",dialogButtonCancel:"popup-window-button-link-cancel",dialogButtonDownload:"ui-btn ui-btn-sm ui-btn-success ui-btn-icon-download",dialogButtonRemove:"ui-btn ui-btn-sm ui-btn-default ui-btn-icon-remove"},init:function(t){this.settings=t?t:{};this.id=BX.type.isNotEmptyString(this.settings.id)?this.settings.id:"TranslateProcessDialog_"+Math.random().toString().substring(2);this.messages=this.getSetting("messages");if(!this.messages){this.messages={}}this.optionsFields=this.getSetting("optionsFields");if(!this.optionsFields){this.optionsFields={}}this.optionsFieldsValue=this.getSetting("optionsFieldsValue");if(!this.optionsFieldsValue){this.optionsFieldsValue={}}var s=this.getSetting("showButtons");if(!s){this.setSetting("showButtons",{start:true,stop:true,close:true})}if(typeof BX.UI!="undefined"&&typeof BX.UI.ProgressBar!="undefined"){this.progressBar=new BX.UI.ProgressBar({statusType:BX.UI.ProgressBar.Status.COUNTER,size:BX.UI.ProgressBar.Size.LARGE,fill:true})}this.handlers=this.getSetting("handlers");if(!this.handlers){this.handlers={}}if(BX.type.isArray(t.styles)){this.STYLES=BX.mergeEx(this.STYLES,t.styles)}},destroy:function(){if(this.popupWindow){this.popupWindow.destroy();this.popupWindow=null}},getId:function(){return this.id},getSetting:function(t,s){return this.settings.hasOwnProperty(t)?this.settings[t]:s},setSetting:function(t,s){this.settings[t]=s},getMessage:function(t){return this.messages&&this.messages.hasOwnProperty(t)?this.messages[t]:""},callHandler:function(t,s){if(typeof this.handlers[t]=="function"){this.handlers[t].apply(this,s)}},setHandler:function(t,s){if(typeof s=="function"){this.handlers[t]=s}},show:function(){if(this.isShown){return}this.error=new BX.UI.Alert({color:BX.UI.Alert.Color.DANGER,icon:BX.UI.Alert.Icon.DANGER,size:BX.UI.Alert.Size.SMALL});this.warning=new BX.UI.Alert({color:BX.UI.Alert.Color.WARNING,icon:BX.UI.Alert.Icon.WARNING,size:BX.UI.Alert.Size.SMALL});this.popupWindow=BX.PopupWindowManager.create(this.id.toLowerCase(),null,{className:this.STYLES.dialogProcessWindow,autoHide:false,bindOptions:{forceBindPosition:false},buttons:this.prepareDialogButtons(),closeByEsc:false,closeIcon:false,content:this.prepareDialogContent(),draggable:true,events:{onPopupClose:BX.delegate(this.onDialogClose,this)},offsetLeft:0,offsetTop:0,titleBar:this.getMessage("title"),overlay:true,resizable:true});if(!this.popupWindow.isShown()){this.popupWindow.show()}this.isShown=this.popupWindow.isShown();if(this.isShown){this.callHandler("dialogShown");BX.onCustomEvent(this,"BX.Translate.ProcessDialog.Shown",[this])}},close:function(){if(!this.isShown){return}if(this.popupWindow){this.popupWindow.close()}this.isShown=false;this.callHandler("dialogClosed");BX.onCustomEvent(this,"BX.Translate.ProcessDialog.Closed",[this])},start:function(){this.callHandler("start");BX.onCustomEvent(this,"BX.Translate.ProcessDialog.Start",[this])},stop:function(){this.callHandler("stop");BX.onCustomEvent(this,"BX.Translate.ProcessDialog.Stop",[this])},prepareDialogContent:function(){var t=this.getMessage("summary");this.summaryBlock=BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessSummary},html:t});this.errorBlock=this.error.getContainer();this.warningBlock=this.warning.getContainer();this.errorBlock.style.display="none";this.warningBlock.style.display="none";if(this.progressBar){this.progressBarBlock=BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessProgressbar},style:{display:"none"},children:[this.progressBar.getContainer()]})}if(this.optionsFieldsBlock===null){this.optionsFieldsBlock=BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessOptions}})}else{BX.clean(this.optionsFieldsBlock)}var s,e,i,o,a,r,n=0,l,h,c,p,u;for(e in this.optionsFields){if(this.optionsFields.hasOwnProperty(e)){s=this.optionsFields[e];i=this.optionsFieldsValue[e]?this.optionsFieldsValue[e]:null;if(BX.type.isPlainObject(s)&&s.hasOwnProperty("name")&&s.hasOwnProperty("type")&&s.hasOwnProperty("title")){l=o=null;a=this.id+"_opt_"+e;r=this.id+"_alert_"+e;switch(s["type"]){case"text":l={id:a,name:e,rows:s["size"]?s["size"]:10,cols:50,value:s["value"]?s["value"]:""};p=[];p.push(BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessOptionsTitle},children:[BX.create("LABEL",{attrs:{for:a},text:s["title"]})]}));var d=BX.create("TEXTAREA",{attrs:l});if(s["value"]){d.value=s["value"]}p.push(BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessOptionsInput},children:[d]}));if(s["obligatory"]===true){p.push(BX.create("DIV",{attrs:{id:r,className:this.STYLES.dialogProcessOptionsObligatory},style:{display:"none"},children:[BX.create("SPAN",{attrs:{className:"ui-alert-message"},text:s["emptyMessage"]})]}))}o=BX.create("DIV",{children:p,attrs:{className:this.STYLES.dialogProcessOptionText}});break;case"file":l={id:a,type:s["type"],name:e};p=[];p.push(BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessOptionsTitle},children:[BX.create("LABEL",{attrs:{for:a},text:s["title"]})]}));p.push(BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessOptionsInput},children:[BX.create("INPUT",{attrs:l})]}));if(s["obligatory"]===true){p.push(BX.create("DIV",{attrs:{id:r,className:this.STYLES.dialogProcessOptionsObligatory},style:{display:"none"},children:[BX.create("SPAN",{attrs:{className:"ui-alert-message"},text:s["emptyMessage"]})]}))}o=BX.create("DIV",{children:p,attrs:{className:this.STYLES.dialogProcessOptionFile}});break;case"checkbox":l={id:a,type:s["type"],name:e};if(i==="Y"||s["value"]==="Y"){l["checked"]="checked"}o=BX.create("DIV",{children:[BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessOptionsTitle},children:[BX.create("LABEL",{attrs:{for:a},text:s["title"]})]}),BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessOptionsInput},children:[BX.create("INPUT",{attrs:l})]})],attrs:{className:this.STYLES.dialogProcessOptionCheckbox}});break;case"select":l={id:a,name:e};if(s["multiple"]==="Y"){l["multiple"]="Y";if(s["size"]){l["size"]=s["size"]}}c=[];for(h in s.list){if(s.list.hasOwnProperty(h)){if(s["multiple"]==="Y"){u=BX.type.isArray(i)&&i.indexOf(h)!==-1||BX.type.isArray(s["value"])&&s["value"].indexOf(h)!==-1}else{u=h===i||h===s["value"]}c.push(BX.create("OPTION",{attrs:{value:h,selected:u},text:s.list[h]}))}}p=[];p.push(BX.create("DIV",{text:s["title"],attrs:{className:this.STYLES.dialogProcessOptionsTitle}}));p.push(BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessOptionsInput},children:[BX.create("SELECT",{attrs:l,children:c})]}));if(s["obligatory"]===true){p.push(BX.create("DIV",{attrs:{id:r,className:this.STYLES.dialogProcessOptionsObligatory},style:{display:"none"},children:[BX.create("SPAN",{attrs:{className:"ui-alert-message"},text:s["emptyMessage"]})]}))}o=BX.create("DIV",{children:p,attrs:{className:this.STYLES.dialogProcessOptionSelect}});break;case"radio":l={name:e,type:s["type"]};c=[];for(h in s.list){if(s.list.hasOwnProperty(h)){l.value=h;l.checked=h===i||h===s["value"];c.push(BX.create("LABEL",{children:[BX.create("INPUT",{attrs:l}),s.list[h]]}))}}p=[];p.push(BX.create("DIV",{text:s["title"],attrs:{className:this.STYLES.dialogProcessOptionsTitle}}));p.push(BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessOptionsInput,id:a},children:c}));if(s["obligatory"]===true){p.push(BX.create("DIV",{attrs:{id:r,className:this.STYLES.dialogProcessOptionsObligatory},style:{display:"none"},children:[BX.create("SPAN",{attrs:{className:"ui-alert-message"},text:s["emptyMessage"]})]}))}o=BX.create("DIV",{children:p,attrs:{className:this.STYLES.dialogProcessOptionRadio}});break}if(o!==null){this.optionsFieldsBlock.appendChild(o);n++}}}}var B=[this.summaryBlock,this.warningBlock,this.errorBlock];if(this.progressBarBlock)B.push(this.progressBarBlock);if(this.optionsFieldsBlock)B.push(this.optionsFieldsBlock);return BX.create("DIV",{attrs:{className:this.STYLES.dialogProcessPopup},children:B})},prepareDialogButtons:function(){var t=[],s=this.getSetting("showButtons");this.buttons={};if(s.start){var e=this.getMessage("startButton");this.buttons["start"]=new BX.PopupWindowButton({text:e!==""?e:"Start",className:this.STYLES.dialogButtonAccept,events:{click:BX.delegate(this.handleStartButtonClick,this)}});t.push(this.buttons["start"])}if(s.stop){var i=this.getMessage("stopButton");this.buttons["stop"]=new BX.PopupWindowButton({text:i!==""?i:"Stop",className:this.STYLES.dialogButtonDisable,events:{click:BX.delegate(this.handleStopButtonClick,this)}});t.push(this.buttons["stop"])}if(s.close){var o=this.getMessage("closeButton");this.buttons["close"]=new BX.PopupWindowButtonLink({text:o!==""?o:"Close",className:this.STYLES.dialogButtonCancel,events:{click:BX.delegate(this.handleCloseButtonClick,this)}});t.push(this.buttons["close"])}return t},getButton:function(t){return typeof this.buttons[t]!=="undefined"?this.buttons[t]:null},onDialogClose:function(t){if(this.popupWindow){this.popupWindow.destroy();this.popupWindow=null}this.buttons={};this.summaryBlock=null;this.isShown=false;this.callHandler("dialogClosed");BX.onCustomEvent(this,"BX.Translate.ProcessDialog.Closed",[this])},handleStartButtonClick:function(){var t=this.getButton("start");if(t){var s=BX.data(t.buttonNode,"disabled");if(s===true){return}}this.start()},handleStopButtonClick:function(){var t=this.getButton("stop");if(t){var s=BX.data(t.buttonNode,"disabled");if(s===true){return}}this.stop()},handleCloseButtonClick:function(){this.popupWindow.close()},lockButton:function(t,s){var e=this.getButton(t);if(!e){return}if(!!s){BX.removeClass(e.buttonNode,this.STYLES.dialogButtonAccept);BX.addClass(e.buttonNode,this.STYLES.dialogButtonDisable);e.buttonNode.disabled=true;BX.data(e.buttonNode,"disabled",true)}else{BX.removeClass(e.buttonNode,this.STYLES.dialogButtonDisable);BX.addClass(e.buttonNode,this.STYLES.dialogButtonAccept);e.buttonNode.disabled=false;BX.data(e.buttonNode,"disabled",false)}return this},showButton:function(t,s){var e=this.getButton(t);if(e){e.buttonNode.style.display=!!s?"":"none"}return this},setSummary:function(t,s){if(this.optionsFieldsBlock){BX.clean(this.optionsFieldsBlock)}if(BX.type.isNotEmptyString(t)){s=!!s;if(this.summaryBlock){if(s)this.summaryBlock.innerHTML=t;else this.summaryBlock.innerHTML=BX.util.htmlspecialchars(t);this.summaryBlock.style.display="block"}}else{this.summaryBlock.innerHTML="";this.summaryBlock.style.display="none"}return this},setError:function(t,s){if(BX.type.isNotEmptyString(t)){if(this.progressBar){this.progressBar.setColor(BX.UI.ProgressBar.Color.DANGER)}s=!!s;if(s)this.error.setText(t);else this.error.setText(BX.util.htmlspecialchars(t));this.error.getTextNode().innerHTML=this.error.getText();this.errorBlock.style.display="flex"}else{if(this.errorBlock){this.error.setText("");this.error.getTextNode().innerHTML="";this.errorBlock.style.display="none"}}return this},setWarning:function(t,s){if(BX.type.isNotEmptyString(t)){s=!!s;if(s)this.warning.setText(t);else this.warning.setText(BX.util.htmlspecialchars(t));this.warning.getTextNode().innerHTML=this.warning.getText();this.warningBlock.style.display="flex"}else{if(this.warningBlock){this.warning.setText("");this.warning.getTextNode().innerHTML="";this.warningBlock.style.display="none"}}return this},setDownloadButtons:function(t,s){BX.clean(this.optionsFieldsBlock);if(t){var e=this.getMessage("downloadButton");var i=BX.create("A",{text:e!==""?e:"Download",props:{href:t},attrs:{className:this.STYLES.dialogButtonDownload}});this.optionsFieldsBlock.appendChild(i)}if(typeof s=="function"){var o=this.getMessage("clearButton");var a=BX.create("BUTTON",{text:o!==""?o:"Drop",attrs:{className:this.STYLES.dialogButtonRemove},events:{click:s}});this.optionsFieldsBlock.appendChild(a)}return this},setProgressBar:function(t,s,e){if(this.progressBar){if(BX.type.isNumber(s)&&BX.type.isNumber(t)&&t>0){BX.show(this.progressBarBlock);this.progressBar.setColor(BX.UI.ProgressBar.Color.PRIMARY);this.progressBar.setMaxValue(t);e=e||"";this.progressBar.setTextBefore(e);this.progressBar.update(s)}else{BX.hide(this.progressBarBlock)}}return this},hideProgressBar:function(){if(this.progressBar){BX.hide(this.progressBarBlock)}return this},getOptions:function(){var t={};if(this.optionsFieldsBlock){var s,e,i,o,a,r,n,l,h;for(e in this.optionsFields){if(this.optionsFields.hasOwnProperty(e)){s=this.optionsFields[e];if(BX.type.isPlainObject(s)&&s.hasOwnProperty("name")&&s.hasOwnProperty("type")&&s.hasOwnProperty("title")){l=false;i=this.id+"_opt_"+e;switch(s["type"]){case"text":o=BX(i);if(o){if(typeof o.value!="undefined"){t[e]=o.value}}break;case"file":o=BX(i);if(o){if(typeof o.files[0]!="undefined"){t[e]=o.files[0]}}break;case"radio":n=BX(i);if(n){a=n.querySelectorAll("input[type=radio]");if(a){for(h=0;h<a.length;h++){if(a[h].checked){r=a[h].value;l=true;break}}}}break;case"checkbox":o=BX(i);if(o){r=o.checked?"Y":"N";l=true}break;case"select":o=BX(i);if(o){if(s.multiple==="Y"){r=[];for(h=0;h<o.options.length;h++){if(o.options[h].selected){r.push(o.options[h].value);l=true}}}else{r=o.value;l=true}}break}if(l){t[e]=r}}s=null;n=null;r=null;o=null;a=null}}}return t},getOption:function(t){var s;if(this.optionsFieldsBlock){var e,i,o;e=this.optionsFields[t];if(BX.type.isPlainObject(e)&&e.hasOwnProperty("name")&&e.hasOwnProperty("type")&&e.hasOwnProperty("title")){i=this.id+"_opt_"+t;switch(e["type"]){case"file":case"checkbox":case"select":s=BX(i);break;case"radio":o=BX(i);if(o){s=o.querySelectorAll("input[type=radio]")}break}}}return s},checkOptions:function(){var t=true;if(this.optionsFieldsBlock){var s,e,i,o,a,r,n,l,h;for(e in this.optionsFields){if(this.optionsFields.hasOwnProperty(e)){s=this.optionsFields[e];if(BX.type.isPlainObject(s)&&s.hasOwnProperty("name")&&s.hasOwnProperty("type")&&s.hasOwnProperty("title")){l=false;i=this.id+"_opt_"+e;o=this.id+"_alert_"+e;switch(s["type"]){case"file":a=BX(i);if(a&&s["obligatory"]===true){if(typeof a.files[0]=="undefined"){t=false;BX.show(BX(o))}else{BX.hide(BX(o))}}break;case"radio":n=BX(i);if(n&&s["obligatory"]===true){r=n.querySelectorAll("input[type=radio]");if(r){for(h=0;h<r.length;h++){if(r[h].checked){l=true;break}}}if(!l){t=false}}break;case"select":a=BX(i);if(a&&s["obligatory"]===true){if(s.multiple==="Y"){for(h=0;h<a.options.length;h++){if(a.options[h].selected){l=true}}}else{l=true}if(!l){t=false}}break}}s=null;n=null;a=null;r=null}}}return t}};if(typeof BX.Translate.ProcessDialogManager=="undefined"){BX.Translate.ProcessDialogManager={}}if(typeof BX.Translate.ProcessDialogManager.items=="undefined"){BX.Translate.ProcessDialogManager.items={}}BX.Translate.ProcessDialogManager.create=function(t){var s=new BX.Translate.ProcessDialog;s.init(t);BX.Translate.ProcessDialogManager.items[s.getId()]=s;return s};BX.Translate.ProcessDialogManager.delete=function(t){if(BX.Translate.ProcessDialogManager.items.hasOwnProperty(t)){BX.Translate.ProcessDialogManager.items[t].destroy();delete BX.Translate.ProcessDialogManager.items[t]}};BX.Translate.ProcessDialogManager.getInstance=function(t){return BX.Translate.ProcessDialogManager.items[t]?BX.Translate.ProcessDialogManager.items[t]:null}})();
//# sourceMappingURL=dialog.map.js