(function(){"use strict";BX.namespace("BX.Tasks.Kanban");BX.Tasks.Kanban.Item=function(t){BX.Kanban.Item.apply(this,arguments);this.container=null;this.timer=null;this.isSprintView=t.isSprintView==="Y";this.networkEnabled=t.networkEnabled||false;this.storyPoints=this.data.storyPoints?this.data.storyPoints:"";this.epic=BX.type.isPlainObject(this.data.epic)?this.data.epic:null;this.calendarSettings=t.calendarSettings?t.calendarSettings:{}};BX.Tasks.Kanban.Item.prototype={__proto__:BX.Kanban.Item.prototype,constructor:BX.Tasks.Kanban.Item,dateFormats:{short:{en:"F j",de:"j. F",ru:"j F"},full:{en:"F j, Y",de:"j. F Y",ru:"j F Y"}},setOptions:function(t){if(!BX.type.isPlainObject(t)){return}BX.Kanban.Item.prototype.setOptions.apply(this,arguments);this.storyPoints=t.data.storyPoints?t.data.storyPoints:"";this.epic=BX.type.isPlainObject(t.data.epic)?t.data.epic:null},renderTime:function(t,e){var s=parseInt(t,10);var a=Math.floor(s/3600);var i=Math.floor((s-a*3600)/60);var n=s-a*3600-i*60;e=typeof e==="undefined"?true:e;if(a<10){a="0"+a}if(i<10){i="0"+i}if(n<10){n="0"+n}return a+":"+i+(e?":"+n:"")},clipTitle:function(t){let e=t;const s=e.split(" ");const a="<span>"+s[s.length-1]+"</span>";s.splice(s.length-1);e=s.join(" ")+" "+a;return e},setDataKey:function(t,e){var s=this.getData();s[t]=e},getDataKey:function(t){var e=this.getData();return e[t]},getDeadline:function(){return this.deadlineNotificationDate},setStatus:function(t){const e=this.getData();if(this.task_complete){BX.show(this.task_complete)}BX.show(this.task_status_title);BX.style(this.task_status_title,"display","inline-block");BX.removeClass(this.task_status_title,"tasks-kanban-item-blue");BX.removeClass(this.task_status_title,"tasks-kanban-item-gray");BX.removeClass(this.task_status_title,"tasks-kanban-item-red");BX.removeClass(this.task_status_title,"tasks-kanban-item-white-blue");this.setDataKey("status",t);if(t==="completed"){if(this.task_complete){BX.hide(this.task_complete)}BX.addClass(this.task_status_title,"tasks-kanban-item-gray");this.task_status_title.textContent=BX.message("TASKS_KANBAN_STATUS_COMPLETED")}else{BX.hide(this.task_status_title)}if(this.task_start&&e.in_progress&&!BX.hasClass(this.task_start,"tasks-kanban-task-pause")){BX.addClass(this.task_start,"tasks-kanban-task-pause");this.task_start.setAttribute("title",BX.message("TASKS_KANBAN_TITLE_PAUSE"))}else if(this.task_start&&!e.in_progress){BX.removeClass(this.task_start,"tasks-kanban-task-pause");this.task_start.setAttribute("title",BX.message("TASKS_KANBAN_TITLE_START"))}if(this.task_mute&&e.muted&&!BX.hasClass(this.task_mute,"tasks-kanban-task-muted")){BX.addClass(this.container,"tasks-kanban-task-muted");this.task_mute.setAttribute("title",BX.message("TASKS_KANBAN_TITLE_UNMUTE"));this.task_counter.setColor(BX.UI.Counter.Color.GRAY)}else if(this.task_mute&&!e.muted){var s=e.is_expired&&!e.completed&&!e.completed_supposedly;BX.removeClass(this.container,"tasks-kanban-task-muted");this.task_mute.setAttribute("title",BX.message("TASKS_KANBAN_TITLE_MUTE"));this.task_counter.setColor(s?BX.UI.Counter.Color.DANGER:BX.UI.Counter.Color.SUCCESS)}},muteTask:function(){var t=this.getId();var e=this.getData();var s=e.muted?"unmuteTask":"muteTask";this.getGrid().ajax(s,{taskId:t}).then((t=>{const e=t.data;const s=t.errors.pop();if(e&&!s){this.getGrid().updateItem(this.getId(),e)}else if(s){BX.Kanban.Utils.showErrorDialog(s.message,true)}}),(t=>{const e=t.errors.pop();BX.Kanban.Utils.showErrorDialog("Error: "+e.message,true)}))},startTask:function(){var t=this.getId();var e=this.getData();var s=e.in_progress?"pauseTask":"startTask";if(e.allow_time_tracking&&e.time_tracking){if(s==="startTask"){BX.TasksTimerManager.start(t)}else{BX.TasksTimerManager.stop(t)}}if(!e.allow_time_tracking||!e.time_tracking||s==="pauseTask"){this.getGrid().ajax(s,{taskId:t}).then((t=>{const e=t.data;const s=t.errors.pop();if(e&&!s){this.getGrid().updateItem(this.getId(),e)}else if(s){BX.Kanban.Utils.showErrorDialog(s.message,true)}}),(t=>{const e=t.errors.pop();BX.Kanban.Utils.showErrorDialog("Error: "+e.message,true)}))}},completeTask:function(){var t=this.getDataKey("status");this.setStatus("completed");this.getGrid().ajax("completeTask",{taskId:this.getId(),columnId:this.getColumnId()}).then((e=>{const s=e.data;const a=e.errors.pop();if(s&&!a){this.getGrid().updateItem(this.getId(),s)}else if(a){this.setStatus(t);BX.Kanban.Utils.showErrorDialog(a.message,true)}}),(e=>{const s=e.errors.pop();this.setStatus(t);BX.Kanban.Utils.showErrorDialog("Error: "+s.message,true)}))},deadlineTask:function(){var t=this.getData();var e=BX.date.convertBitrixFormat(BX.message("FORMAT_DATETIME"));var s=BX.date.format(e,t.date_deadline||t.date_day_end);var a=BX.calendar({node:BX.proxy_context,value:s,currentTime:s,bTime:true,bCompatibility:true,bCategoryTimeVisibilityOption:"tasks.bx.calendar.deadline",bTimeVisibility:this.calendarSettings?this.calendarSettings.deadlineTimeVisibility==="Y":false,callback:function(t){this.getGrid().ajax("deadlineTask",{taskId:this.getId(),deadline:BX.date.format(e,t),columnId:this.getColumnId()}).then((t=>{const e=t.data;const s=t.errors.pop();if(e&&!s){this.getGrid().updateItem(e.id,e)}else if(s){BX.Kanban.Utils.showErrorDialog(s.message,true)}}),(t=>{const e=t.errors.pop();BX.Kanban.Utils.showErrorDialog("Error: "+e.message,true)}))}.bind(this),callback_after:function(t){BX.onCustomEvent(this.getGrid(),"Tasks.Kanban.Item:deadlineChanged",{value:t})}.bind(this)});BX.onCustomEvent(this.getGrid(),"Tasks.Kanban.Item:deadlineChangeClick",{calendar:a,itemId:t.id})},changeAuthorTask:function(){this.changeMemberTask("changeAuthorTask")},delegateTask:function(){this.changeMemberTask("delegateTask")},changeMemberTask:function(t){var e=this.getData();var s=this.responsible;var a=e.responsible.id;var i="R";if(t==="changeAuthorTask"){s=this.author;a=e.author.id;i="O"}var n;if(this.isSprintView){n=[{id:"scrum-user",options:{groupId:this.getGrid().getGroupId()},dynamicLoad:true},{id:"department"}]}else{n=[{id:"user",options:{emailUsers:true,networkUsers:this.networkEnabled,extranetUsers:true,inviteGuestLink:true,myEmailUsers:true,analyticsSource:"tasks"}},{id:"department"}]}BX.loadExt("ui.entity-selector").then(function(){var r=new BX.UI.EntitySelector.Dialog({targetNode:s,enableSearch:true,multiple:false,dropdownMode:this.isSprintView,context:"KANBAN_RESPONSIBLE_SELECTOR_"+t+e.id,preselectedItems:[["user",a]],undeselectedItems:[["user",a]],entities:n,events:{"Item:onSelect":function(e){const s=e.getData().item;const a=this.prepareUserData(s,i);this.getGrid().ajax(t,{taskId:this.getId(),columnId:this.getColumnId(),userId:a.id}).then((t=>{const e=t.data;const s=t.errors.pop();if(e&&!s){this.getGrid().updateItem(e.id,e)}else if(s){BX.Kanban.Utils.showErrorDialog(s.message,true)}}),(t=>{const e=t.errors.pop();BX.Kanban.Utils.showErrorDialog("Error: "+e.message,true)}))}.bind(this)}});r.show()}.bind(this))},prepareUserData:function(t,e){const s=t.getCustomData();const a=t.getEntityType();return{avatar:t.avatar,description:"",entityType:e,id:t.getId(),name:s.get("name"),lastName:s.get("lastName"),email:s.get("email"),nameFormatted:BX.Text.encode(t.getTitle()),networkId:"",type:{crmemail:false,extranet:a==="extranet",email:a==="email",network:a==="network"}}},getTaskUrl:function(t){if(parseInt(this.getGridData().groupId,10)>0){return this.getGridData().pathToGroupTask.replace("#task_id#",t)}return this.getGridData().pathToTask.replace("#task_id#",t)},isCompleted:function(){var t=this.getData();return t.completed},getStoryPoints:function(){return this.storyPoints},switchClass:function(t,e,s){if(s){BX.addClass(t,e)}else{BX.removeClass(t,e)}},switchVisible:function(t,e){if(e){t.style.display=""}else{BX.hide(t)}},onDragDrop:function(t,e,s){if(this.selectable&&this.getGrid().getSelectedItems().size>1){return this.onDragDropMultiple()}this.hideDragTarget();var a=this.getGrid().getItemByElement(t);var i=new BX.Kanban.DragEvent;i.setItem(a);i.setTargetColumn(this.getColumn());i.setTargetItem(this);BX.onCustomEvent(this.getGrid(),"Kanban.Grid:onBeforeItemMoved",[i]);if(!i.isActionAllowed()){return}var n=new BX.Promise;if(this.isSprintView&&this.getColumn().isFinishType()&&!a.getColumn().isFinishType()){top.BX.loadExt("tasks.scrum.dod").then(function(){if(typeof top.BX.Tasks.Scrum==="undefined"||typeof top.BX.Tasks.Scrum.Dod==="undefined"){n.fulfill()}this.scrumDod=new top.BX.Tasks.Scrum.Dod({groupId:this.getData()["groupId"],taskId:a.getId()});this.scrumDod.subscribe("resolve",(function(){n.fulfill()}));this.scrumDod.subscribe("reject",(function(){n.reject()}));this.scrumDod.isNecessary().then(function(t){if(t){this.scrumDod.showList()}else{n.fulfill()}}.bind(this))}.bind(this))}else{n.fulfill()}n.then(function(){var t=this.getGrid().moveItem(a,this.getColumn(),this);if(t){BX.onCustomEvent(this.getGrid(),"Kanban.Grid:onItemMoved",[a,this.getColumn(),this])}}.bind(this))},setFilterTag:function(){var t=BX.proxy_context.textContent.substring(1);var e=this.getGridData();var s=BX.Main.filterManager.getById(e.gridId);s.getApi().extendFilter({TAG:t,TAG_label:t})},setFilterEpic:function(t){var e=this.getGridData();var s=BX.Main.filterManager.getById(e.gridId);s.getApi().extendFilter({EPIC:String(t)})},render:function(){if(!this.container){this.createLayout()}var t=this.getData();var e=this.getColumn().getColor();var s=BX.util.hex2rgb(e);var a="rgba("+s.r+","+s.g+","+s.b+","+".7)";var i=BX.message("LANGUAGE_ID");if(i!=="en"&&i!=="de"){i="ru"}this.container.style.setProperty("--tasks-kanban-item-color",a);if(t.background){BX.style(this.containerImg,"background-image","url('"+t.background+"')");this.containerImg.setAttribute("href",this.getTaskUrl(this.getId()))}this.switchVisible(this.containerImg,t.background);this.link.innerHTML=this.clipTitle(t.name);this.link.setAttribute("href",this.getTaskUrl(this.getId()));this.switchClass(this.link,"tasks-kanban-item-title-hot",t.high);this.switchVisible(this.link,t.name!=="");if(this.getGrid().isScrumGrid()){BX.cleanNode(this.epicLayout);if(this.epic){this.epicLayout.appendChild(this.createEpicLayout())}}if(t.tags&&t.tags.length>0){BX.cleanNode(this.tags);for(var n=0,r=t.tags.length;n<r;n++){this.tag=BX.create("span",{props:{className:"ui-label ui-label-tag-light ui-label-fill ui-label-md ui-label-link"},children:[BX.create("span",{props:{className:"ui-label-inner"},text:"#"+t.tags[n],events:{click:BX.delegate((function(t){this.setFilterTag();t.stopPropagation()}),this)}})]});this.tags.appendChild(this.tag)}}this.switchClass(this.date_deadline_container,"tasks-kanban-item-pointer",t.allow_change_deadline);if(t.allow_change_deadline){BX.bind(this.date_deadline_container,"click",BX.delegate((function(t){this.deadlineTask();t.stopPropagation()}),this))}else{BX.unbind(this.date_deadline_container,"click",BX.delegate((function(t){this.deadlineTask();t.stopPropagation()}),this))}if(!this.isSprintView&&t?.deadline_visibility!=="hidden"){if(t.date_deadline||t.deferred||t.completed_supposedly){this.deadlineNotificationDate=t.deadline.value.replace("&minus;","-");this.date_deadline.setText(this.deadlineNotificationDate);this.date_deadline.setFill(t.deadline.fill);this.date_deadline.setColor(t.deadline.color)}else{this.deadlineNotificationDate="";this.date_deadline.setText(BX.message("TASKS_KANBAN_NO_DATE"));this.date_deadline.setFill(false);this.date_deadline.setColor(BX.UI.Label.LIGHT)}this.date_deadline.setCustomClass("tasks-kanban-item-deadline")}if(t.deferred){this.setStatus("deferred")}else if(t.completed){this.setStatus("completed")}else if(t.completed_supposedly){this.setStatus("completed_supposedly")}else if(t.overdue){this.setStatus("overdue")}else if(t.in_progress){this.setStatus("in_progress")}else if(t.date_start){this.setStatus("pause")}else if(t.new){this.setStatus("new")}else{this.setStatus("")}this.switchVisible(this.task_content,t.count_files>0||t.check_list.complete!==0||t.check_list.work!==0);if(t.counter.value>0){this.task_counter.setColor(t.counter.color);if(Number(this.task_counter.getValue())!==Number(t.counter.value)){this.task_counter.update(t.counter.value)}}this.switchVisible(this.task_counter_container,t.counter.value>0);this.switchVisible(this.check_list,t.check_list.complete!==0||t.check_list.work!==0);this.switchClass(this.check_list,"tasks-kanban-item-super-blue",t.log.checklist>0);this.check_list.setAttribute("title",BX.message("TASKS_KANBAN_TITLE_CHECKLIST").replace("#complete#",t.check_list.complete).replace("#all#",parseInt(t.check_list.complete)+parseInt(t.check_list.work)));this.check_list.textContent=t.log.checklist>0?"+"+t.log.checklist:t.check_list.complete+"/"+(+t.check_list.complete+ +t.check_list.work);this.switchVisible(this.count_files,t.count_files>0);this.switchClass(this.count_files,"tasks-kanban-item-super-blue",t.log.file>0);this.count_files.setAttribute("title",BX.message("TASKS_KANBAN_TITLE_FILES").replace("#count#",t.count_files));this.count_files.textContent=t.log.file>0?"+"+t.log.file:t.count_files;if(!this.isSprintView&&t.author){if(this.author){BX.remove(this.author)}this.author=BX.create("div",{props:{className:"tasks-kanban-item-author",style:"cursor: pointer"}});var o;if(t.author.extranet){o="tasks-kanban-item-author-avatar tasks-kanban-item-author-avatar-extranet"}else if(t.author.crm){o="tasks-kanban-item-author-avatar tasks-kanban-item-author-avatar-crm"}else if(t.author.mail){o="tasks-kanban-item-author-avatar tasks-kanban-item-author-avatar-mail"}else if(t.author.collaber){o="tasks-kanban-item-author-avatar tasks-kanban-item-author-avatar-collaber"}else{o="tasks-kanban-item-author-avatar"}var l;!t.author.photo?l=" tasks-kanban-item-author-avatar-empty":l="";this.author.appendChild(BX.create("div",{props:{title:t.author.name,className:o+l},style:{backgroundImage:t.author.photo?"url('"+encodeURI(t.author.photo.src)+"')":"",cursor:t.allow_edit?"pointer":"default"},events:{click:t.allow_edit?BX.delegate((function(t){this.changeAuthorTask();t.stopPropagation()}),this):function(){}}}));this.user_container.appendChild(this.author)}if(t.responsible){if(this.responsible){BX.remove(this.responsible)}var c=this.isSprintView?"tasks-kanban-item-responsible-sprint":"tasks-kanban-item-responsible";this.responsible=BX.create("div",{props:{className:c,style:"cursor: pointer"}});var h;if(t.responsible.extranet){h="tasks-kanban-item-author-avatar tasks-kanban-item-author-avatar-extranet"}else if(t.responsible.crm){h="tasks-kanban-item-author-avatar tasks-kanban-item-author-avatar-crm"}else if(t.responsible.mail){h="tasks-kanban-item-author-avatar tasks-kanban-item-author-avatar-mail"}else if(t.responsible.collaber){h="tasks-kanban-item-author-avatar tasks-kanban-item-author-avatar-collaber"}else{h="tasks-kanban-item-author-avatar"}this.responsible.appendChild(BX.create("div",{props:{title:t.responsible.name,className:h},style:{backgroundImage:t.responsible.photo?"url('"+encodeURI(t.responsible.photo.src)+"')":"",cursor:t.allow_delegate?"pointer":"default"},events:{click:t.allow_delegate?BX.delegate((function(t){this.delegateTask();t.stopPropagation()}),this):function(){}}}));this.user_container.appendChild(this.responsible)}if(this.time_logs){this.switchVisible(this.time_logs,t.time_tracking);if(t.time_tracking){this.time_logs.textContent=parseInt(t.time_estimate)>0?this.renderTime(t.time_logs)+" / "+this.renderTime(t.time_estimate,false):this.renderTime(t.time_logs)}else{this.time_logs.textContent=""}}if(!this.getGrid().isScrumGrid()){this.switchClass(this.container,"tasks-kanban-item-without-control",t.completed||!t.allow_complete&&!t.allow_start);if(this.task_start){this.switchVisible(this.task_start,t.allow_start)}if(this.task_complete){this.switchVisible(this.task_complete,t.allow_complete)}}BX.cleanNode(this.itemFieldsNode);if(t?.item_fields?.length>0){t.item_fields.forEach((t=>{if(t?.value||t?.collection?.length>0){this.itemFieldsNode.appendChild(this.getItemFieldDiv(t))}}))}return this.container},getItemFieldDiv(t){return BX.create("div",{props:{className:"tasks-kanban-item-fields-item"},children:[BX.create("div",{props:{className:"tasks-kanban-item-fields-item-title"},children:[BX.create("div",{props:{className:"tasks-kanban-item-fields-item-title-text"},text:t?.label})]}),BX.create("div",{props:{className:"tasks-kanban-item-fields-item-value"},text:t?.value,html:t?.collection?.length>0?this.getItemFieldLinks(t.collection):""})]})},getItemFieldLinks(t){return t.map((t=>`<a href="${BX.util.htmlspecialchars(t.url)}">${BX.util.htmlspecialchars(t.name)}</a>`))},animate:function(t){var e=t.duration;var s=t.draw;var a=t.timing||function(t){return t};var i=t.useAnimation&&!this.isAnimationInProgress||false;var n=performance.now();return new Promise(function(t,r){if(!i){this.isAnimationInProgress=false;return t()}var o=this;o.isAnimationInProgress=true;requestAnimationFrame(function i(r){var l=(r-n)/e;if(l>1){l=1}var c=a(l);s(c);if(l<1){requestAnimationFrame(i)}if(c===1){o.isAnimationInProgress=false;t()}}.bind(this))}.bind(this))},createLayout:function(){const t=this.getData();this.container=BX.create("div",{props:{className:"tasks-kanban-item"},events:{click:function(){if(typeof BX.Bitrix24!=="undefined"&&typeof BX.Bitrix24.PageSlider!=="undefined"){}}.bind(this)}});this.link=BX.create("a",{props:{className:t.counter.value>0?"tasks-kanban-item-title":"tasks-kanban-item-title tasks-kanban-item-title--with-counter"}});BX.Event.bind(this.link,"click",(()=>{this.getGrid().analytics("task_view","title_click")}));this.container.appendChild(this.link);this.container.appendChild(BX.Tag.render`<div class="tasks-kanban-item-line"></div>`);this.itemFieldsNode=BX.create("div",{props:{className:"tasks-kanban-item-fields"}});this.container.appendChild(this.itemFieldsNode);if(this.getGrid().isScrumGrid()){this.epicLayout=BX.create("span",{props:{className:"tasks-kanban-item-epic-container"}});if(this.epic){this.epicLayout.appendChild(this.createEpicLayout())}this.container.appendChild(this.epicLayout)}this.tags=BX.create("span",{props:{className:"tasks-kanban-item-tags"}});this.container.appendChild(this.tags);this.task_status=BX.create("div",{props:{className:"tasks-kanban-item-task-status"}});this.container.appendChild(this.task_status);this.task_status_title=BX.create("div",{props:{className:"tasks-kanban-item-status"}});this.task_status.appendChild(this.task_status_title);this.containerImg=BX.create("a",{props:{className:"tasks-kanban-item-image"}});this.container.appendChild(this.containerImg);this.task_content=BX.create("div",{props:{className:"tasks-kanban-item-info"}});this.container.appendChild(this.task_content);if(!this.isSprintView&&t.deadline_visibility!=="hidden"){this.date_deadline=new BX.UI.Label({text:t.deadline.value.replace("&minus;","-"),color:t.deadline.color,fill:t.date_deadline?t.deadline.fill:false});this.date_deadline_container=BX.create("div",{props:{className:"tasks-kanban-item-deadline"},children:[this.date_deadline.getContainer()]});this.container.appendChild(this.date_deadline_container)}this.check_list=BX.create("div",{props:{className:"tasks-kanban-item-checklist"}});this.task_content.appendChild(this.check_list);this.count_files=BX.create("div",{props:{className:"tasks-kanban-item-files"}});this.task_content.appendChild(this.count_files);this.actions_container=BX.create("div",{props:{className:"tasks-kanban-actions-container"}});this.container.appendChild(this.actions_container);this.user_container=BX.create("div",{props:{className:"tasks-kanban-item-users"}});this.actions_container.appendChild(this.user_container);if(!this.getGrid().isScrumGrid()){this.time_logs=BX.create("div",{props:{className:"tasks-kanban-item-timelogs"}});this.actions_container.appendChild(this.time_logs);this.track_control=BX.create("div",{props:{className:"tasks-kanban-item-control"}});this.container.appendChild(this.track_control);this.task_mute=BX.create("div",{props:{className:"tasks-kanban-task-mute"},events:{click:function(t){this.muteTask();t.stopPropagation()}.bind(this)}});this.track_control.appendChild(this.task_mute);this.task_start=BX.create("div",{props:{className:"tasks-kanban-task-start"},events:{click:function(t){this.startTask();t.stopPropagation()}.bind(this)}});this.track_control.appendChild(this.task_start);this.task_complete=BX.create("div",{props:{className:"tasks-kanban-task-complete",title:BX.message("TASKS_KANBAN_TITLE_COMPLETE")},events:{click:function(t){this.completeTask();t.stopPropagation()}.bind(this)}});this.track_control.appendChild(this.task_complete)}else{this.storyPointsNode=BX.create("div",{props:{className:"tasks-kanban-item-story-points",title:BX.message("TASKS_KANBAN_ITEM_STORY_POINTS_TITLE")},text:this.getDataKey("storyPoints")});this.container.appendChild(this.storyPointsNode)}this.task_counter=new BX.UI.Counter({value:t.counter.value,color:t.counter.color,animate:true});this.task_counter_container=BX.create("div",{props:{className:"tasks-kanban-task-counter"},children:[this.task_counter.getContainer()]});this.container.appendChild(this.task_counter_container);this.container.appendChild(this.createShadow());this.container.addEventListener("mouseenter",function(){this.addHoverClass(this.container)}.bind(this));this.container.addEventListener("mouseleave",function(){this.removeHoverClass(this.container)}.bind(this),false)},createShadow:function(){return BX.create("div",{props:{className:"tasks-kanban-item-shadow"}})},getContainer:function(){if(this.layout.container!==null){return this.layout.container}this.layout.container=BX.create("div",{attrs:{className:"main-kanban-item","data-id":this.getId(),"data-type":"item"},children:[this.getDragTarget(),this.getBodyContainer()]});this.makeDraggable();this.makeDroppable();if(this.grid.firstRenderComplete&&!this.draftContainer){this.layout.container.classList.add("main-kanban-item-new");const t=()=>{this.layout.container.classList.remove("main-kanban-item-new");this.getBodyContainer().removeEventListener("animationend",t)};this.getBodyContainer().addEventListener("animationend",t)}return this.layout.container},addHoverClass:function(t){this.timer=setTimeout((function(){t.classList.add("tasks-kanban-item-hover")}),150)},removeHoverClass:function(t){clearTimeout(this.timer);t.classList.remove("tasks-kanban-item-hover")},createEpicLayout:function(){const t=this.convertHexToRGBA(this.epic.color,.7);const e=this.convertHexToRGBA(this.epic.color,.3);return BX.create("span",{props:{className:"tasks-kanban-item-epic"},style:{background:e,borderColor:t},text:this.epic.name,events:{click:BX.delegate((function(t){this.setFilterEpic(this.epic.id);t.stopPropagation()}),this)}})},convertHexToRGBA:function(t,e){let s=t.replace("#","");if(s.length===3){s=String(s[0]+s[0]+s[1]+s[1]+s[2]+s[2])}const a=parseInt(s.substring(0,2),16);const i=parseInt(s.substring(2,4),16);const n=parseInt(s.substring(4,6),16);return"rgba("+a+","+i+","+n+","+e+")"}}})();
//# sourceMappingURL=item.map.js