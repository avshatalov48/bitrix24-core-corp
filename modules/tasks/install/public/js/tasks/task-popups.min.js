(function(t){if(BX.TaskPriorityPopup)return;var s=function(t,s,e,i,p){this.items=[];this.popupId=t;this.popupClassName=s;if(BX.type.isArray(i)){for(var o=0;o<i.length;o++){if(typeof i[o]["id"]!=="undefined")this.items.push(i[o])}}this.params=p||{};this.title=e;this.popupWindow=null;this.currentTask=null;this.tasksData={};this.itemList=[]};s.prototype.show=function(t,s,e,i){if(this.popupWindow!==null)this.popupWindow.close();this.currentTask=this.__getTask(t,s,e,i);if(this.currentTask===null)return false;if(this.popupWindow==null)this.__createLayout();else this.popupWindow.setBindElement(this.currentTask.bindElement);this.__redrawList();this.popupWindow.show()};s.prototype.__createLayout=function(){var t=[];for(var s=0;s<this.items.length;s++){var e=this.items[s];var i=BX.create("a",{props:{className:"task-popup-list-item"},events:{click:BX.proxy(this.__onItemClick,{obj:this,listItem:e})},children:[BX.create("span",{props:{className:"task-popup-list-item-left"}}),BX.create("span",{props:{className:"task-popup-list-item-icon task-popup-"+this.popupClassName+"-icon-"+e.className}}),BX.create("span",{props:{className:"task-popup-list-item-text"},text:e.name}),BX.create("span",{props:{className:"task-popup-list-item-right"}})]});BX.data(i,"item",e);this.itemList[e.id]=i;t.push(i)}this.popupWindow=BX.PopupWindowManager.create("bx-task-"+this.popupId+"-popup",this.currentTask.bindElement,{autoHide:true,offsetTop:1,lightShadow:true,closeByEsc:true,events:{onPopupClose:BX.proxy(this.__onPopupClose,this)},content:this.popupWindowContent=BX.create("div",{props:{className:"task-"+this.popupClassName+"-popup"},children:[BX.create("div",{props:{className:"task-"+this.popupClassName+"-popup-title"},text:this.title}),BX.create("div",{props:{className:"popup-window-hr"},children:[BX.create("i",{})]}),BX.create("div",{props:{className:"task-popup-list-list"},children:t})]})})};s.prototype.__redrawList=function(){this.__selectItem(this.currentTask.listValue)};s.prototype.__selectItem=function(t){BX.Tasks.each(this.itemList,function(s,e){var i=BX.data(s,"item");if(i.id==t||typeof i.values!="undefined"&&i.values[t]){BX.addClass(s,"task-popup-list-item-selected")}else{BX.removeClass(s,"task-popup-list-item-selected")}}.bind(this))};s.prototype.__getTask=function(t,s,e,i){if(!BX.type.isNumber(t))return null;this.tasksData[t]={id:t,bindElement:s,listItem:{},onPopupChange:i.events&&i.events.onPopupChange&&BX.type.isFunction(i.events.onPopupChange)?i.events.onPopupChange:null,onPopupClose:i.events&&i.events.onPopupClose&&BX.type.isFunction(i.events.onPopupClose)?i.events.onPopupClose:null};if(typeof e==="object"){for(var p in e){this.tasksData[t][p]=e[p]}}else{this.tasksData[t].listValue=e}if(typeof this.tasksData[t]["listValue"]!=="undefined"){for(var o=0;o<this.items.length;o++){if(this.items[o].id===this.tasksData[t].listValue){this.tasksData[t].listItem=this.items[o];break}}}return this.tasksData[t]};s.prototype.__onItemClick=function(t){this.obj.popupWindow.close();if(this.obj.currentTask.listValue!=this.listItem.id){this.obj.currentTask.listValue=this.listItem.id;this.obj.currentTask.listItem=this.listItem;if(this.obj.currentTask.onPopupChange)this.obj.currentTask.onPopupChange()}BX.PreventDefault(t)};s.prototype.__onPopupClose=function(t){if(this.currentTask.onPopupClose)this.currentTask.onPopupClose()};var e=function(){e.superclass.constructor.apply(this,["priority","priority",BX.message("TASKS_PRIORITY_V2"),[{id:0,name:BX.message("TASKS_COMMON_NO"),className:"low",values:{0:true,1:true}},{id:2,name:BX.message("TASKS_COMMON_YES"),className:"high"}],{}])};BX.extend(e,s);BX.TaskPriorityPopup={popup:null,show:function(t,s,i,p){if(this.popup===null){this.popup=new e}this.popup.show(t,s,i,p)}};var i=function(t){i.superclass.constructor.apply(this,[t,"grade",BX.message("TASKS_MARK"),[{id:"NULL",name:BX.message("TASKS_MARK_NONE"),className:"none"},{id:"P",name:BX.message("TASKS_MARK_P"),className:"plus"},{id:"N",name:BX.message("TASKS_MARK_N"),className:"minus"}],{}])};BX.extend(i,s);BX.TaskGradePopup={simplePopup:null,show:function(t,s,e,p){if(this.simplePopup==null){this.simplePopup=new i("grade-simple")}this.simplePopup.show(t,s,e,p)}}})(window);
//# sourceMappingURL=task-popups.map.js