BX.namespace("Tasks.UI");BX.Tasks.UI.Widget=BX.Tasks.Base.extend({options:{id:false,code:false,scope:false,removeTemplates:false,registerDispatcher:false},sys:{id:false,code:false,instanceCode:false,scope:false},methods:{construct:function(){this.vars={cache:{control:{}}};this.ctrls={};this.tmpls={};if(!("querySelector"in document)){throw new Error("Your browser does not support querySelector")}if(BX.type.isNotEmptyString(this.option("code"))){this.instanceCode(this.option("code"))}if(BX.type.isNotEmptyString(this.opts.id)){this.sys.id=this.opts.id}this.detectScope();this.findTemplates();this.register()},destruct:function(){this.vars=null;this.sys=null;this.ctrls=null;this.tmpls=null;this.sys=null},scope:function(){return this.sys.scope},control:function(e,t){if(!t){if(typeof this.vars.cache.control[e]=="undefined"){var s=this.scope().querySelector(this.getControlSearchQuery(e));if(s!==null){this.vars.cache.control[e]=s}}return this.vars.cache.control[e]}else{return t.querySelector(this.getControlSearchQuery(e))}},controlAll:function(e,t){t=t||this.scope();return t.querySelectorAll(this.getControlSearchQuery(e))},detectScope:function(){if(this.opts.scope!==false){if(BX.type.isNotEmptyString(this.opts.scope)){this.sys.scope=BX(this.opts.scope)}else if(BX.type.isElementNode(this.opts.scope)){this.sys.scope=this.opts.scope}}else if(this.opts.id!==false){this.sys.scope=BX("bx-component-scope-"+this.opts.id)}if(!BX.type.isElementNode(this.sys.scope)){throw new Error("Cant find correct scope ("+this.opts.id+")")}},getFullBxId:function(e){var t=[];if(this.sys.code!==false){t.push(this.sys.code)}if(this.sys.instanceCode!==false){t.push(this.sys.instanceCode)}t.push(e);return t.join("-")},getControlSearchQuery:function(e){return'[data-bx-id~="'+this.getFullBxId(e)+'"]'},code:function(e){if(typeof e!="undefined"&&BX.type.isNotEmptyString(e)){this.sys.code=e.toString().toLowerCase()}else{return this.sys.code}},id:function(){return this.opts.id},instanceCode:function(e){if(typeof e!="undefined"&&BX.type.isNotEmptyString(e)){this.sys.instanceCode=e.toString().toLowerCase()}else{return this.sys.instanceCode}},findTemplates:function(){var e=this.scope().querySelectorAll('script[type="text/html"]');for(k=0;k<e.length;k++){var t=BX.data(e[k],"bx-id");if(typeof t=="string"&&t.length>0){this.tmpls[t]=e[k].innerHTML;if(this.opts.removeTemplates){BX.remove(e[k])}}}},getNodeByTemplate:function(e,t){var s=this.template(e);return s.getNode(t,false)},getHTMLByTemplate:function(e,t){var s=this.template(e);return s.get(t)},template:function(e){if(typeof BX.Tasks.Util.Template=="undefined"){throw new ReferenceError("Template API does not seem to be included")}var t=this.getFullBxId(e);if(typeof this.tmpls[t]=="undefined"){throw new ReferenceError("No such template: "+e+" ("+t+")")}if(typeof this.tmpls[t]=="string"){this.tmpls[t]=BX.Tasks.Util.Template.compile(this.tmpls[t])}return this.tmpls[t]},register:function(){if(this.id()&&this.option("registerDispatcher")){BX.Tasks.UI.Dispatcher.register(this.id(),this)}},fireEvent:function(e,t){this.callMethod(BX.Tasks.Base,"fireEvent",arguments);BX.Tasks.UI.Dispatcher.fireEvent(this,e,t)},bindDelegateControl:function(e,t,s,i){i=i||this.scope();BX.bindDelegate(i,e,{attr:{"data-bx-id":this.getFullBxId(t)}},s)},setCSSFlag:function(e,t){this.changeCSSFlag(e,t,true)},dropCSSFlag:function(e,t){this.changeCSSFlag(e,t,false)},toggleCSSFlag:function(e,t){this.changeCSSFlag(e,t,!BX.hasClass(t,e))},dropCSSFlags:function(e,t){t=t||this.sys.scope;var s=t.classList;e=new RegExp("^"+e.replace("*","[a-z0-9-]*")+"$");for(var i=0;i<s.length;i++){if(s[i].toString().match(e)){BX.removeClass(t,s[i])}}},dropAllCSSFlags:function(e){this.dropCSSFlags("*",e)},changeCSSFlag:function(e,t,s){t=t||this.sys.scope;if(typeof e!="string"||e.length==0){return}BX[s?"addClass":"removeClass"](t,e)}}});BX.Tasks.UI.Dispatcher=BX.Tasks.Base.extend({options:{},methods:{construct:function(){this.vars={registry:{},events:{}}},destruct:function(){this.vars=null},register:function(e,t){if(!BX.type.isNotEmptyString(e)){throw new ReferenceError("Id must not be empty")}if(t==null||t==false){throw new ReferenceError("Strange instance")}if(typeof this.vars.registry[e]!="undefined"){throw new ReferenceError('The id "'+e.toString()+'" is already in use in registry')}this.vars.registry[e]=t},get:function(e){if(typeof this.vars.registry[e]=="undefined"){throw new ReferenceError('No such id "'+e.toString()+'" in registry')}return this.vars.registry[e]}}});BX.Tasks.UI.Dispatcher.register=function(e,t){BX.Tasks.UI.Dispatcher.makeInstance();BX.Tasks.Instances.dispatcher.register(e,t)};BX.Tasks.UI.Dispatcher.get=function(e){BX.Tasks.UI.Dispatcher.makeInstance();return BX.Tasks.Instances.dispatcher.get(e)};BX.Tasks.UI.Dispatcher.bindEvent=function(e,t,s){if(!BX.type.isNotEmptyString(e)){throw new TypeError("Bad id: "+e)}if(!BX.type.isNotEmptyString(t)){throw new TypeError("Bad event name: "+t)}if(!BX.type.isFunction(s)){throw new TypeError("Callback is not a function to call for: "+e+" "+t)}BX.Tasks.UI.Dispatcher.makeInstance();var i=BX.Tasks.Instances.dispatcher;if(typeof i.vars.events[t]=="undefined"){i.vars.events[t]={}}i.vars.events[t][e]=s},BX.Tasks.UI.Dispatcher.fireEvent=function(e,t,s){BX.Tasks.UI.Dispatcher.makeInstance();if(typeof e=="undefined"||e==null){throw new TypeError("Bad reference to fire event on")}if(!BX.type.isNotEmptyString(t)){throw new TypeError("Bad event name: "+t)}s=s||[];var i=BX.Tasks.Instances.dispatcher;for(var n in i.vars.registry){if(i.vars.registry[n]==e){if(typeof i.vars.events[t][n]!="undefined"){i.vars.events[t][n].apply(e,s)}return}}},BX.Tasks.UI.Dispatcher.makeInstance=function(){if(typeof BX.Tasks.Instances=="undefined"){BX.Tasks.Instances={}}if(typeof BX.Tasks.Instances.dispatcher=="undefined"){BX.Tasks.Instances.dispatcher=new BX.Tasks.UI.Dispatcher}};
//# sourceMappingURL=1.map.js