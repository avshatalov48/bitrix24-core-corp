BX.namespace("Tasks.UI");(function(){Item=function(t,e){this.data=t;this.scope=e.getNodeByTemplate("item",this.data)[0];this.ctrls={btnDelete:e.control("item-btn-delete",this.scope)};BX.data(this.scope,"item-value",t.VALUE);for(var i in this.ctrls){if(this.ctrls[i]!=null){BX.data(this.ctrls[i],"item-value",t.VALUE)}}};BX.merge(Item.prototype,{value:function(){return this.data.VALUE},display:function(){return this.data.DISPLAY},destruct:function(){var t=this.value();BX.remove(this.scope);this.scope=null;this.ctrls=null;this.data=null;return t}});BX.Tasks.UI.ItemSet=BX.Tasks.UI.Widget.extend({options:{multiple:true},sys:{code:"item-set"},methods:{construct:function(){BX.merge(this.vars,{items:{},order:[]});this.bindEvents()},getDisplay:function(t){return t.DISPLAY},getValue:function(t){return t.VALUE},bindEvents:function(){this.bindDelegateControl("click","item-btn-delete",this.passCtx(this.setItemDelete));this.bindDelegateControl("click","open-form",this.passCtx(this.openAddForm))},createItem:function(t){return new Item(t,this)},setItemDelete:function(t){this.doOnItem(t,function(t){this.deleteItem(t.value())})},deleteItem:function(t){var e=this.vars.items[t];if(typeof e!="undefined"){e.destruct();this.vars.items[t]=null;delete this.vars.items[t];for(var i in this.vars.order){if(this.vars.order[i]==t){this.vars.order.splice(i,1);break}}this.setCSSFlagEmpty();return true}return false},doOnItem:function(t,e){var i=BX.data(t,"item-value");if(typeof i!="undefined"&&i!==null){e.apply(this,[this.vars.items[i]])}},openAddForm:function(){},addItem:function(t){t.VALUE=this.getValue.apply(this,[t]);t.DISPLAY=this.getDisplay.apply(this,[t]);var e=this.createItem(t);this.vars.items[e.value()]=e;this.vars.order.push(e.value())},hasItem:function(t){return typeof this.vars.items[t]!="undefined"},getValue:function(t){return t.VALUE},getDisplay:function(t){return t.DISPLAY},load:function(t,e){if(BX.type.isPlainObject(t)||BX.type.isArray(t)){t=BX.clone(t);if(!this.option("multiple")){this.addItem(t)}else{for(var i in t){this.addItem(t[i])}}this.redraw()}},redraw:function(){var t=BX.create("div");for(var e in this.vars.order){var i=this.vars.order[e];BX.append(this.vars.items[i].scope,t)}this.moveNodePool(t,this.control("items"));this.setCSSFlagEmpty()},setCSSFlagEmpty:function(){var t=this.getFullBxId("empty");this.dropCSSFlags(t+"-*");this.setCSSFlag(t+"-"+(this.vars.order.length>0?"false":"true"))},moveNodePool:function(t,e){while(t.childNodes.length>0){BX.append(t.childNodes[0],e)}},isEnter:function(t){t=t||window.event;return t.keyCode==13}}})})();
//# sourceMappingURL=1.map.js