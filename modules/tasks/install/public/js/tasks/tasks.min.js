BX.namespace("Tasks");BX.mergeEx(BX.Tasks,{alert:function(e,t){var i=new BX.Promise;if(BX.Tasks.Runtime.errorPopup==null){BX.Tasks.Runtime.errorPopup=new BX.PopupWindow("task-error-popup",null,{lightShadow:true})}var n=BX.Tasks.Runtime.errorPopup;if(n===null){n=new BX.PopupWindow("task-error-popup",null,{lightShadow:true})}n.setButtons([new BX.PopupWindowButton({text:BX.message("JS_CORE_WINDOW_CLOSE"),className:"",events:{click:function(){if(BX.type.isFunction(t)){t()}this.popupWindow.close();i.resolve()}}})]);var s="";for(var o=0;o<e.length;o++){var a=null;if(typeof e[o].MESSAGE!=="undefined"){a=e[o].MESSAGE}else if(typeof e[o].message!=="undefined"){a=e[o].message}s+=BX.util.htmlspecialchars(a?a:e[o])+"<br>"}var r=BX.message("TASKS_COMMON_ERROR_OCCURRED");if(BX.type.isPlainObject(t)&&typeof t.title!="undefined"){r=t.title}n.setTitleBar({content:BX.type.isElementNode(r)?r:BX.create("div",{html:r})});var l=e.length?e[0].DATA||e[0].data:null;if(l&&l.ui==="notification"){s=s.replace("&lt;br&gt;",'<div class="task-popup-divider">&nbsp;</div>');s=s.replace("#BR#",'<div class="task-popup-divider">&nbsp;</div>');s="<div class='task-popup-notification'>"+s+"</div>"}else{s="<div style='width: 350px;padding: 10px; font-size: 12px; color: red;'>"+s+"</div>"}n.setContent(s);if(window.console&&window.console.dir){window.console.dir(e)}n.show();return i},confirm:function(e,t,i){if(!BX.type.isFunction(t)){t=BX.DoNothing}i=i||{};i.ctx=i.ctx||this;var n=new BX.Promise(null,i.ctx);if(BX.Tasks.Runtime.confirmPopup==null){BX.Tasks.Runtime.confirmPopup=new BX.PopupWindow("task-confirm-popup",null,{zIndex:22e3,overlay:{opacity:50},content:"",autoHide:false,closeByEsc:false})}var s=i.isDisposable&&i.id&&"hintManager"in BX.Tasks.Util;var o=null;var a=i.buttonSet||[{text:BX.message("JS_CORE_WINDOW_CONTINUE"),type:"green",code:"continue",default:true}];if(s){if(BX.Tasks.Util.hintManager.wasDisposed(i.id)){var r=a.filter((function(e){return e.default}));r=r[0]||a[0];n.fulfill(r.code);return n}else{o=BX.create("P",{style:{margin:"10px 20px 0 0"},children:[BX.create("LABEL",{children:[BX.create("INPUT",{props:{type:"checkbox",id:"bx-tasks-disposable-"+i.id}}),BX.create("SPAN",{style:{color:"gray"},text:BX.message("TASKS_COMMON_DONT_ASK_AGAIN")})]})]})}}var l=[];BX.Tasks.each(a,(function(e){(function(e,t,i,s,o){e.push(new BX.PopupWindowButton({text:t.text,className:t.type=="red"?"popup-window-button-decline":"popup-window-button-accept",events:{click:function(){o.apply(i.ctx,[true]);this.popupWindow.close();if(s&&BX("bx-tasks-disposable-"+i.id).checked){BX.Tasks.Util.hintManager.disable(i.id)}n.fulfill(t.code);delete i}}}))})(l,e,i,s,t)}));l.push(new BX.PopupWindowButtonLink({text:BX.message("JS_CORE_WINDOW_CANCEL"),events:{click:function(){t.apply(i.ctx,[false]);this.popupWindow.close();n.reject();delete i}}}));BX.Tasks.Runtime.confirmPopup.setButtons(l);if(typeof i.title!="undefined"){BX.Tasks.Runtime.confirmPopup.setTitleBar(BX.type.isElementNode(i.title)?i.title:BX.create("div",{html:i.title}))}e=BX.create("div",{style:{padding:"16px 12px",maxWidth:"400px",maxHeight:"400px",overflow:"hidden"},html:BX.type.isElementNode(e)?e.outerHTML:e.toString()});if(o){BX.append(o,e)}BX.Tasks.Runtime.confirmPopup.setContent(e.outerHTML);BX.Tasks.Runtime.confirmPopup.show();return n},confirmDelete:function(e){e=(e||"").toString();e=e.substr(0,1).toLowerCase()+e.substr(1);return this.confirm(BX.message("TASKS_COMMON_CONFIRM_DELETE").replace("#ENTITY_NAME#",e))},passCtx:function(e,t){return function(){var i=Array.prototype.slice.call(arguments);i.unshift(this);return e.apply(t,i)}},each:function(e,t,i){var n;i=i||this;if(BX.type.isArray(e)||e instanceof Object&&"length"in e){for(n=0;n<e.length;n++){if(e.hasOwnProperty(n)){if(t.apply(i,[e[n],n])===false){break}}}}else if(BX.type.isPlainObject(e)){for(n in e){if(e.hasOwnProperty(n)){if(t.apply(i,[e[n],n])===false){break}}}}},deReference:function(e,t){if(!BX.type.isNotEmptyString(e)){return null}e=e.split(".");var i=e.length;var n=t;for(var s=0;s<i;s++){if(e.hasOwnProperty(s)){if(typeof n=="undefined"||n===null){return null}if(!BX.type.isNotEmptyString(e[s])){return null}n=n[e[s].trim()]}else{return null}}return n},handleAddCrmDialog(){BX.ajax.runAction("tasks.analytics.hit",{data:{},analyticsLabel:{scenario:"task_add_crm_field"}})},handleEditCrmDialog(){BX.ajax.runAction("tasks.analytics.hit",{data:{},analyticsLabel:{scenario:"task_edit_crm_field"}})}});if(typeof BX.Tasks.Runtime=="undefined"){BX.Tasks.Runtime={errorPopup:null,confirmPopup:null}}
//# sourceMappingURL=tasks.map.js