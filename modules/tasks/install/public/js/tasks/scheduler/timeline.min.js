BX.namespace("BX.Scheduler");BX.Scheduler.Timeline=function(){var t=function(t){this.settings=t||{};this.layout={root:null,list:null,tree:null,treeStub:null,gutter:null,timelineInner:null,scalePrimary:null,scaleSecondary:null,timelineData:null,currentDay:null,print:null};this.chartContainer={element:BX.type.isDomNode(this.settings.renderTo)?this.settings.renderTo:null,padding:30,width:0,pos:{left:0,top:0},minPageX:0,maxPageX:0};this.adjustChartContainer();this.rowHeight=BX.type.isNumber(this.settings.rowHeight)?this.settings.rowHeight:32;this.printSettings=null;this.headerViewportWidth=null;var e=BX.type.isNumber(this.settings.gutterOffset)?this.settings.gutterOffset:300;this.gutterOffset=this.normalizeGutterOffset(e);this.createLayout();this.currentDatetime=BX.Tasks.Date.isDate(this.settings.currentDatetime)?BX.Tasks.Date.convertToUTC(this.settings.currentDatetime):BX.Tasks.Date.convertToUTC(new Date);this.currentDate=new Date(Date.UTC(this.currentDatetime.getUTCFullYear(),this.currentDatetime.getUTCMonth(),this.currentDatetime.getUTCDate(),0,0,0,0));this.timelineDataOffset=null;this.firstWeekDay=1;this.setFirstWeekDay(this.settings.firstWeekDay);this.calendar=new BX.Tasks.Calendar(this.settings);this.zoom=new BX.Scheduler.TimelineZoom(this.settings.zoomLevel);this.reconfigure(this.zoom.getPreset());if(this.settings.events){for(var i in this.settings.events){if(this.settings.events.hasOwnProperty(i)){BX.addCustomEvent(this,i,this.settings.events[i])}}}BX.bind(window,"resize",BX.proxy(this.onWindowResize,this))};t.prototype.appendRows=function(t){if(!BX.type.isArray(t)){return}var e=document.createDocumentFragment();var i=document.createDocumentFragment();for(var s=0,n=t.length;s<n;s++){var o=t[s];e.appendChild(o.getResourceRow());i.appendChild(o.getEventRow())}this.appendTreeItem(e);this.appendDataItem(i)};t.prototype.appendRow=function(t){if(t instanceof BX.Scheduler.TimelineRow){return this.appendRows([t])}};t.prototype.appendTreeItem=function(t){if(BX.type.isDomNode(t)){this.layout.tree.appendChild(t)}};t.prototype.appendDataItem=function(t){if(BX.type.isDomNode(t)){this.layout.timelineData.appendChild(t)}};t.prototype.clearItems=function(){BX.cleanNode(this.layout.tree)};t.prototype.clearRows=function(){BX.cleanNode(this.layout.timelineData)};t.prototype.adjustChartContainer=function(){if(this.chartContainer.element!==null){var t=this.chartContainer.width;this.chartContainer.width=this.chartContainer.element.offsetWidth;this.chartContainer.pos=BX.pos(this.chartContainer.element);this.adjustChartContainerPadding();if(this.layout.root!==null&&t!==this.chartContainer.width){this.layout.root.style.width=this.chartContainer.width+"px";this.renderHeader()}}};t.prototype.adjustChartContainerPadding=function(){if(this.chartContainer.element!=null){this.chartContainer.minPageX=this.chartContainer.pos.left+this.gutterOffset+this.chartContainer.padding;this.chartContainer.maxPageX=this.chartContainer.pos.left+this.chartContainer.width-this.chartContainer.padding}};t.prototype.normalizeGutterOffset=function(t){var e=2;var i=this.chartContainer.width-100;return Math.min(Math.max(t,e),i>e?i:e)};t.prototype.setGutterOffset=function(t){this.gutterOffset=this.normalizeGutterOffset(t);this.layout.list.style.width=this.gutterOffset+"px";return this.gutterOffset};t.prototype.onGutterMouseDown=function(t){t=t||window.event;BX.bind(document,"mouseup",BX.proxy(this.onGutterMouseUp,this));BX.bind(document,"mousemove",BX.proxy(this.onGutterMouseMove,this));this.gutterClientX=t.clientX;document.onmousedown=BX.False;document.body.onselectstart=BX.False;document.body.ondragstart=BX.False;document.body.style.MozUserSelect="none";document.body.style.cursor="ew-resize"};t.prototype.onGutterMouseUp=function(t){t=t||window.event;BX.unbind(document,"mouseup",BX.proxy(this.onGutterMouseUp,this));BX.unbind(document,"mousemove",BX.proxy(this.onGutterMouseMove,this));document.onmousedown=null;document.body.onselectstart=null;document.body.ondragstart=null;document.body.style.MozUserSelect="";document.body.style.cursor="default";BX.onCustomEvent(this,"onGutterResize",[this.gutterOffset])};t.prototype.onGutterMouseMove=function(t){t=t||window.event;this.setGutterOffset(this.gutterOffset+(t.clientX-this.gutterClientX));this.adjustChartContainerPadding();this.gutterClientX=t.clientX};t.prototype.getTimelineDataOffset=function(){if(this.timelineDataOffset===null){this.timelineDataOffset=this.layout.timelineData.offsetTop}return this.timelineDataOffset};t.prototype.handleTimelineScroll=function(){this.renderHeader()};t.prototype.onTimelineMouseDown=function(t){t=t||window.event;if(t.button!==0){return}this.dragClientX=t.clientX;BX.Scheduler.Util.startDrag(document.body,{mouseup:BX.proxy(this.onTimelineMouseUp,this),mousemove:BX.proxy(this.onTimelineMouseMove,this)});BX.PreventDefault(t)};t.prototype.onTimelineMouseUp=function(t){t=t||window.event;BX.Scheduler.Util.stopDrag(document.body,{mouseup:BX.proxy(this.onTimelineMouseUp,this),mousemove:BX.proxy(this.onTimelineMouseMove,this)});this.dragClientX=0};t.prototype.onTimelineMouseMove=function(t){t=t||window.event;var e=this.layout.timeline.scrollLeft+(this.dragClientX-t.clientX);this.layout.timeline.scrollLeft=e<0?0:e;this.dragClientX=t.clientX};t.prototype.onWindowResize=function(t){this.adjustChartContainer()};t.prototype.onPrintClick=function(){if(this.printSettings===null){this.printSettings=new BX.Scheduler.PrintSettings(this)}this.printSettings.show()};t.prototype.zoomToLevel=function(t){if(this.layout.root===null){return}BX.onCustomEvent(this,"onBeforeZoomChange",[t]);this.setZoomLevel(t);this.drawScale();this.autoScroll();BX.onCustomEvent(this,"onZoomChange",[t])};t.prototype.zoomIn=function(){var t=this.zoom.getNextLevel();var e=this.zoom.getCurrentLevel();if(t.id!==e.id){BX.onCustomEvent(this,"onBeforeZoomIn",[t.id]);this.zoomToLevel(t.id)}};t.prototype.zoomOut=function(){var t=this.zoom.getPrevLevel();var e=this.zoom.getCurrentLevel();if(t.id!==e.id){BX.onCustomEvent(this,"onBeforeZoomOut",[t.id]);this.zoomToLevel(t.id)}};t.prototype.onZoomInClick=function(t){t=t||window.event;this.zoomIn()};t.prototype.onZoomOutClick=function(t){t=t||window.event;this.zoomOut()};t.prototype.getRowHeight=function(){return this.rowHeight};t.prototype.reconfigure=function(t){this.topUnit=t.topUnit||this.topUnit||BX.Tasks.Date.Unit.Month;this.topIncrement=t.topIncrement||this.topIncrement||1;this.topDateFormat=t.topDateFormat||this.topDateFormat||"F Y";this.bottomUnit=t.bottomUnit||this.bottomUnit||BX.Tasks.Date.Unit.Day;this.bottomIncrement=t.bottomIncrement||this.bottomIncrement||1;this.bottomDateFormat=t.bottomDateFormat||this.bottomDateFormat||"j";this.snapUnit=t.snapUnit||this.snapUnit||BX.Tasks.Date.Unit.Hour;this.snapIncrement=t.snapIncrement||this.snapIncrement||1;this.snapWidth=t.snapWidth||this.snapWidth||1;this.columnWidth=t.columnWidth||this.columnWidth||24;var e=BX.Tasks.Date.floorDate(this.currentDatetime,this.topUnit,this.firstWeekDay);var i=BX.Tasks.Date.ceilDate(this.currentDatetime,this.topUnit,this.topIncrement,this.firstWeekDay);var s=Math.ceil(this.chartContainer.width/this.getUnitInPixels(this.snapUnit));var n=BX.Tasks.Date.getDurationInUnit(e,i,this.snapUnit);var o=Math.ceil(s/n);this.startDate=BX.Tasks.Date.add(e,this.topUnit,-o);this.endDate=BX.Tasks.Date.add(i,this.topUnit,o)};t.prototype.setFirstWeekDay=function(t){if(BX.type.isNumber(t)&&t>=0&&t<=6){this.firstWeekDay=t}};t.prototype.setZoomLevel=function(t){this.zoom.setLevel(t);this.reconfigure(this.zoom.getPreset())};t.prototype.createLayout=function(){if(!this.chartContainer.element||this.layout.root!==null){return}this.layout.root=BX.create("div",{props:{className:"task-gantt"},style:{width:this.chartContainer.width+"px"},children:[this.layout.list=BX.create("div",{props:{className:"task-gantt-list"},style:{width:this.gutterOffset+"px"},children:[BX.create("div",{props:{className:"task-gantt-list-controls"},children:[BX.Scheduler.Util.isMSBrowser()?null:this.layout.print=BX.create("div",{props:{className:"task-gantt-print"},events:{click:BX.proxy(this.onPrintClick,this)}}),this.layout.zoomIn=BX.create("div",{props:{className:"task-gantt-zoom-in"},events:{click:BX.proxy(this.onZoomInClick,this)}}),this.layout.zoomOut=BX.create("div",{props:{className:"task-gantt-zoom-out"},events:{click:BX.proxy(this.onZoomOutClick,this)}})]}),BX.create("div",{props:{className:"task-gantt-list-title"},text:BX.type.isNotEmptyString(this.settings.headerText)?this.settings.headerText:""}),this.layout.tree=BX.create("div",{props:{className:"task-gantt-items"}}),this.layout.gutter=BX.create("div",{props:{className:"task-gantt-gutter"},events:{mousedown:BX.proxy(this.onGutterMouseDown,this)}}),this.layout.treeStub=BX.create("div",{props:{className:"task-gantt-item task-gantt-item-stub"},attrs:{"data-project-id":"stub"}})]}),this.layout.timeline=BX.create("div",{props:{className:"task-gantt-timeline"},events:{scroll:this.handleTimelineScroll.bind(this)},children:[this.layout.timelineInner=BX.create("div",{props:{className:"task-gantt-timeline-inner"},events:{mousedown:BX.proxy(this.onTimelineMouseDown,this)},children:[BX.create("div",{props:{className:"task-gantt-timeline-head"},children:[this.layout.scalePrimary=BX.create("div",{props:{className:"task-gantt-scale-primary"}}),this.layout.scaleSecondary=BX.create("div",{props:{className:"task-gantt-scale-secondary"}})]}),this.layout.timelineData=BX.create("div",{props:{className:"task-gantt-timeline-data"}}),this.layout.currentDay=BX.create("div",{props:{className:"task-gantt-current-day"}})]})]})]})};t.prototype.drawScale=function(){this.setTimelineWidth()};t.prototype.draw=function(){if(this.chartContainer.element&&this.layout.root!==null){this.drawScale();this.chartContainer.element.appendChild(this.layout.root);this.adjustChartContainer()}};t.prototype.getTimelineWidth=function(){return this.getTimespanInPixels(this.startDate,this.endDate,this.snapUnit)};t.prototype.getTimespanWidth=function(t,e){return this.getTimespanInPixels(t,e,this.snapUnit)};t.prototype.getTimespanInPixels=function(t,e,i){var s=BX.Tasks.Date.getDurationInUnit(t,e,i);var n=this.getUnitInPixels(i);return s*n};t.prototype.setTimelineWidth=function(){this.layout.timelineInner.style.width=this.getTimelineWidth()+"px"};t.prototype.getColumnWidth=function(){return this.gutterOffset};t.prototype.getScrollHeight=function(){return this.layout.root.scrollHeight};t.prototype.getRootContainer=function(){return this.layout.root};t.prototype.autoExpandTimeline=function(t){if(!BX.type.isArray(t)){t=[t]}var e=Math.ceil(this.chartContainer.width/this.getUnitInPixels(this.snapUnit));for(var i=0;i<t.length;i++){var s=t[i];var n=BX.Tasks.Date.floorDate(s,this.topUnit,this.firstWeekDay);var o=BX.Tasks.Date.ceilDate(s,this.topUnit,this.topIncrement,this.firstWeekDay);var a=BX.Tasks.Date.getDurationInUnit(n,o,this.snapUnit);var r=Math.ceil(e/a);var h=BX.Tasks.Date.getDurationInUnit(this.startDate,s,this.snapUnit);if(h<=e){var l=BX.Tasks.Date.add(n,this.topUnit,-r);this.expandTimelineLeft(l);continue}h=BX.Tasks.Date.getDurationInUnit(s,this.endDate,this.snapUnit);if(h<=e){var u=BX.Tasks.Date.add(o,this.topUnit,r);this.expandTimelineRight(u)}}};t.prototype.expandTimelineLeft=function(t){if(t>=this.startDate){return}var e=new Date(this.startDate.getTime());this.startDate=t;if(this.layout.root===null){return}var i=BX.Tasks.Date.getDurationInUnit(this.startDate,e,this.snapUnit);var s=this.getUnitInPixels(this.snapUnit);var n=i*s;var o=this.getScrollLeft();this.setTimelineWidth();this.setScrollLeft(o+n)};t.prototype.expandTimelineRight=function(t){if(t<=this.endDate){return}var e=new Date(this.endDate.getTime());this.endDate=t;if(this.layout.root===null){return}var i=this.getScrollLeft();this.setTimelineWidth();this.setScrollLeft(i)};t.prototype.getCurrentDate=function(){return this.currentDate};t.prototype.getCurrentDatetime=function(){return this.currentDatetime};t.prototype.getStart=function(){return this.startDate};t.prototype.getEnd=function(){return this.endDate};t.prototype.getHeaderViewportWidth=function(){return this.headerViewportWidth!==null?this.headerViewportWidth:this.chartContainer.width};t.prototype.setHeaderViewportWidth=function(t){if(BX.type.isNumber(t)||t===null){this.headerViewportWidth=t}};t.prototype.renderHeader=function(){var t=this.getHeaderViewportWidth();var e=this.getScrollLeft();var i=this.getDateFromPixels(e);var s=this.getDateFromPixels(e+t);i=BX.Tasks.Date.floorDate(i,this.topUnit,this.firstWeekDay);s=BX.Tasks.Date.ceilDate(s,this.topUnit,this.topIncrement,this.firstWeekDay);var n=Math.ceil(t/this.getUnitInPixels(this.topUnit));i=BX.Tasks.Date.add(i,this.topUnit,-n);s=BX.Tasks.Date.add(s,this.topUnit,n);i=BX.Tasks.Date.max(i,this.getStart());s=BX.Tasks.Date.min(s,this.getEnd());this.layout.scalePrimary.innerHTML=this.createHeader(i,s,"top",this.topUnit,this.topIncrement);this.layout.scaleSecondary.innerHTML=this.createHeader(i,s,"bottom",this.bottomUnit,this.bottomIncrement)};t.prototype.createHeader=function(t,e,i,s,n){var o=this.getStart();var a=e;var r="";var h=0;while(o<a){var l=BX.Tasks.Date.min(BX.Tasks.Date.getNext(o,s,n,this.firstWeekDay),a);if(o>=t){r+=i==="top"?this.renderTopHeader(o,l):this.renderBottomHeader(o,l)}else{h+=this.getTimespanInPixels(o,l,this.snapUnit)}o=l}return'<div style="position: absolute; left: '+h+'px">'+r+"</div>"};t.prototype.renderTopHeader=function(t,e){var i=BX.Tasks.Date.getDurationInUnit(t,e,this.snapUnit);var s=this.getUnitInPixels(this.snapUnit);return'<span class="task-gantt-top-column" '+'style="width:'+i*s+'px"><span class="task-gantt-scale-month-text">'+BX.date.format(this.topDateFormat,t,null,true)+"</span></span>"};t.prototype.renderBottomHeader=function(t,e){var i=BX.Tasks.Date.getDurationInUnit(t,e,this.snapUnit);var s=this.getUnitInPixels(this.snapUnit);var n="task-gantt-bottom-column";if(this.bottomUnit!==BX.Tasks.Date.Unit.Month&&this.bottomUnit!==BX.Tasks.Date.Unit.Quarter&&this.bottomUnit!==BX.Tasks.Date.Unit.Year){if(this.isToday(t,e)){n+=" task-gantt-today-column"}if(this.isWeekend(t,e)){n+=" task-gantt-weekend-column"}if(this.isHoliday(t,e)){n+=" task-gantt-holiday-column"}}return'<span class="'+n+'" style="width:'+i*s+'px">'+BX.date.format(this.bottomDateFormat,t,null,true)+"</span>"};t.prototype.isToday=function(t,e){return this.currentDate.getUTCMonth()===t.getUTCMonth()&&this.currentDate.getUTCDate()===t.getUTCDate()};t.prototype.isHoliday=function(t,e){return this.calendar.isHoliday(t)};t.prototype.isWeekend=function(t,e){return this.calendar.isWeekend(t)};t.prototype.getPixelsFromDate=function(t){var e=BX.Tasks.Date.getDurationInUnit(this.startDate,t,this.snapUnit);return e*this.getUnitInPixels(this.snapUnit)};t.prototype.getDateFromPixels=function(t){var e=BX.Tasks.Date.add(this.startDate,this.snapUnit,Math.floor(t/this.getUnitInPixels(this.snapUnit)));return this.snapDate(e)};t.prototype.getUnitInPixels=function(t){return BX.Tasks.Date.getUnitRatio(this.bottomUnit,t)*this.columnWidth/this.bottomIncrement};t.prototype.snapDate=function(t){var e=new Date(t.getTime());if(this.snapUnit===BX.Tasks.Date.Unit.Day){var i=BX.Tasks.Date.getDurationInDays(this.startDate,e);var s=Math.round(i/this.snapIncrement)*this.snapIncrement;e=BX.Tasks.Date.add(this.startDate,BX.Tasks.Date.Unit.Day,s)}else if(this.snapUnit===BX.Tasks.Date.Unit.Hour){var n=BX.Tasks.Date.getDurationInHours(this.startDate,e);var o=Math.round(n/this.snapIncrement)*this.snapIncrement;e=BX.Tasks.Date.add(this.startDate,BX.Tasks.Date.Unit.Minute,o*60)}else if(this.snapUnit===BX.Tasks.Date.Unit.Minute){var a=BX.Tasks.Date.getDurationInMinutes(this.startDate,e);var r=Math.round(a/this.snapIncrement)*this.snapIncrement;e=BX.Tasks.Date.add(this.startDate,BX.Tasks.Date.Unit.Second,r*60)}else if(this.snapUnit===BX.Tasks.Date.Unit.Week){e.setUTCHours(0,0,0,0);var h=e.getUTCDay()-this.firstWeekDay;if(h<0){h=7+h}var l=Math.round(h/7)===1?7-h:-h;e=BX.Tasks.Date.add(e,BX.Tasks.Date.Unit.Day,l)}else if(this.snapUnit===BX.Tasks.Date.Unit.Month){var u=BX.Tasks.Date.getDurationInMonths(this.startDate,e)+e.getUTCDate()/BX.Tasks.Date.getDaysInMonth(e);var p=Math.round(u/this.snapIncrement)*this.snapIncrement;e=BX.Tasks.Date.add(this.startDate,BX.Tasks.Date.Unit.Month,p)}else if(this.snapUnit===BX.Tasks.Date.Unit.Second){var c=BX.Tasks.Date.getDurationInSeconds(this.startDate,e);var d=Math.round(c/this.snapIncrement)*this.snapIncrement;e=BX.Tasks.Date.add(this.startDate,BX.Tasks.Date.Unit.Milli,d*1e3)}else if(this.snapUnit===BX.Tasks.Date.Unit.Milli){var m=BX.Tasks.Date.getDurationInMilliseconds(this.startDate,e);var D=Math.round(m/this.snapIncrement)*this.snapIncrement;e=BX.Tasks.Date.add(this.startDate,BX.Tasks.Date.Unit.Milli,D)}else if(this.snapUnit===BX.Tasks.Date.Unit.Year){var y=BX.Tasks.Date.getDurationInYears(this.startDate,e);var f=Math.round(y/this.snapIncrement)*this.snapIncrement;e=BX.Tasks.Date.add(this.startDate,BX.Tasks.Date.Unit.Year,f)}else if(this.snapUnit===BX.Tasks.Date.Unit.Quarter){e.setUTCHours(0,0,0,0);e.setDate(1);e=BX.Tasks.Date.add(e,BX.Tasks.Date.Unit.Month,3-e.getUTCMonth()%3)}return e};t.prototype.scrollToDate=function(t){if(!BX.Tasks.Date.isDate(t)||t<this.startDate||t>this.endDate){return}var e=this.getMaxScrollLeft();var i=this.getPixelsFromDate(t);this.setScrollLeft(i>e?e:i)};t.prototype.scrollTo=function(t){this.setScrollLeft(Math.min(Math.max(0,t),this.getMaxScrollLeft()));this.renderHeader()};t.prototype.getScrollLeft=function(){return this.layout.timeline.scrollLeft};t.prototype.setScrollLeft=function(t){this.layout.timeline.scrollLeft=t};t.prototype.getMaxScrollLeft=function(){var t=this.getPixelsFromDate(this.endDate);var e=this.getViewportWidth();return t-e};t.prototype.getViewportWidth=function(){return this.chartContainer.width-this.gutterOffset};t.prototype.autoScroll=function(){var t=this.getViewportWidth();var e=this.getPixelsFromDate(BX.Tasks.Date.floorDate(this.currentDatetime,this.snapUnit,this.firstWeekDay));this.scrollToDate(this.getDateFromPixels(e-t/4))};t.prototype.getRelativeXY=function(t){BX.fixEventPageXY(t);return{x:t.pageX-this.chartContainer.pos.left-this.gutterOffset+this.layout.timeline.scrollLeft,y:t.pageY-this.chartContainer.pos.top+this.layout.timeline.scrollTop}};return t}();BX.Scheduler.TimelineRow=function(){var t=function(t){this.config=t||{};this.rowHeight=BX.type.isNumber(this.config.rowHeight)?this.config.rowHeight:32;this.resourceRow=BX.create("div",{props:{className:"scheduler-row-resource"},style:{height:this.rowHeight+"px"},events:{mouseover:BX.proxy(this.onMouseOver,this),mouseout:BX.proxy(this.onMouseOut,this)}});this.eventRow=BX.create("div",{props:{className:"scheduler-row-event"},style:{height:this.rowHeight+"px"},events:{mouseover:BX.proxy(this.onMouseOver,this),mouseout:BX.proxy(this.onMouseOut,this)}})};t.prototype.getResourceRow=function(){return this.resourceRow};t.prototype.getEventRow=function(){return this.eventRow};t.prototype.setRowHeight=function(t){if(BX.type.isNumber(t)){this.rowHeight=t;this.resourceRow.style.height=t+"px";this.eventRow.style.height=t+"px"}};t.prototype.getRowHeight=function(){return this.rowHeight};t.prototype.onMouseOver=function(){BX.addClass(this.resourceRow,"scheduler-row-resource-hover");BX.addClass(this.eventRow,"scheduler-row-event-hover")};t.prototype.onMouseOut=function(){BX.removeClass(this.resourceRow,"scheduler-row-resource-hover");BX.removeClass(this.eventRow,"scheduler-row-event-hover")};return t}();BX.Scheduler.TimelineZoom=function(){function t(t){this.setLevel(t)}t.prototype.presets={yearquarter:{columnWidth:200,topUnit:BX.Tasks.Date.Unit.Year,topIncrement:1,topDateFormat:"Y",bottomUnit:BX.Tasks.Date.Unit.Quarter,bottomIncrement:1,bottomDateFormat:"f",snapUnit:BX.Tasks.Date.Unit.Day,snapIncrement:1,firstWeekDay:1},yearmonth:{columnWidth:100,topUnit:BX.Tasks.Date.Unit.Year,topIncrement:1,topDateFormat:"Y",bottomUnit:BX.Tasks.Date.Unit.Month,bottomIncrement:1,bottomDateFormat:"f",snapUnit:BX.Tasks.Date.Unit.Day,snapIncrement:1,firstWeekDay:1},monthday:{columnWidth:24,topUnit:BX.Tasks.Date.Unit.Month,topIncrement:1,topDateFormat:"f Y",bottomUnit:BX.Tasks.Date.Unit.Day,bottomIncrement:1,bottomDateFormat:"j",snapUnit:BX.Tasks.Date.Unit.Hour,snapIncrement:1},weekday:{columnWidth:48,topUnit:BX.Tasks.Date.Unit.Week,topIncrement:1,topDateFormat:"j F",bottomUnit:BX.Tasks.Date.Unit.Day,bottomIncrement:1,bottomDateFormat:"D",snapUnit:BX.Tasks.Date.Unit.Hour,snapIncrement:1,firstWeekDay:1},dayhour:{columnWidth:60,topUnit:BX.Tasks.Date.Unit.Day,topIncrement:1,topDateFormat:"j F",bottomUnit:BX.Tasks.Date.Unit.Hour,bottomIncrement:6,bottomDateFormat:"G:i",snapUnit:BX.Tasks.Date.Unit.Minute,snapIncrement:15},hourminute:{columnWidth:48,topUnit:BX.Tasks.Date.Unit.Hour,topIncrement:1,topDateFormat:"j F H:i",bottomUnit:BX.Tasks.Date.Unit.Minute,bottomIncrement:15,bottomDateFormat:"i:s",snapUnit:BX.Tasks.Date.Unit.Minute,snapIncrement:1}};t.prototype.levels=[{id:"yearquarter",preset:"yearquarter"},{id:"yearmonth",preset:"yearmonth"},{id:"monthday",preset:"monthday"},{id:"monthday2x",preset:"monthday",columnWidth:48},{id:"weekday",preset:"weekday"},{id:"dayhour",preset:"dayhour"}].concat(!BX.Scheduler.Util.isMSBrowser()?[{id:"daysecondhour",preset:"dayhour",bottomIncrement:2,snapIncrement:15},{id:"dayeveryhour",preset:"dayhour",bottomIncrement:1,snapIncrement:5},{id:"hourminute",preset:"hourminute"}]:[]);t.prototype.setLevel=function(t){var e=this.getLevelIndex(t);if(e===null){this.levelIndex=typeof this.levelIndex!=="undefined"?this.levelIndex:this.getLevelIndex("monthday")}else{this.levelIndex=e}};t.prototype.getLevelIndex=function(t){for(var e=0,i=this.levels.length;e<i;e++){var s=this.levels[e];if(s.id===t){return e}}return null};t.prototype.getCurrentLevel=function(){return this.levels[this.levelIndex]};t.prototype.getNextLevel=function(){return this.levelIndex===this.levels.length-1?this.levels[this.levels.length-1]:this.levels[this.levelIndex+1]};t.prototype.getPrevLevel=function(){return this.levelIndex>0?this.levels[this.levelIndex-1]:this.levels[0]};t.prototype.getPreset=function(){var t=this.levels[this.levelIndex];var e=BX.clone(this.presets[t.preset]);for(var i in t){if(t.hasOwnProperty(i)){e[i]=t[i]}}return e};return t}();