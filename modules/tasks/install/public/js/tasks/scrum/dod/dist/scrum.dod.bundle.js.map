{"version":3,"file":"scrum.dod.bundle.js","sources":["../src/side.panel.js","../src/request.sender.js","../src/scrum.dod.js"],"sourcesContent":["import {Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nexport class SidePanel extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DodSidePanel');\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\tthis.contentSidePanelManager = new BX.SidePanel.Manager({});\n\t\t/* eslint-enable */\n\n\t\tthis.contentSidePanels = new Set();\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onLoad', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tsidePanel.setCacheable(false);\n\t\t\tthis.emit('onLoadSidePanel', sidePanel);\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tthis.emit('onCloseSidePanel', sidePanel);\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseComplete', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tif (this.contentSidePanels.has(sidePanel.getUrl()))\n\t\t\t{\n\t\t\t\tthis.contentSidePanels.delete(sidePanel.getUrl());\n\t\t\t\tif (!this.contentSidePanels.size)\n\t\t\t\t{\n\t\t\t\t\tthis.resetBodyWidthHack();\n\t\t\t\t\tthis.addEscapePressHandler();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\topenSidePanel(id, options)\n\t{\n\t\tthis.applyBodyWidthHack();\n\t\tthis.removeEscapePressHandler();\n\n\t\tthis.contentSidePanelManager.open(id, options);\n\n\t\tthis.contentSidePanels.add(id);\n\t}\n\n\texistFrameTopSlider(): boolean\n\t{\n\t\treturn Boolean(this.sidePanelManager.getTopSlider());\n\t}\n\n\taddEscapePressHandler()\n\t{\n\t\tconst sidePanel = this.sidePanelManager.getTopSlider();\n\t\tif (sidePanel)\n\t\t{\n\t\t\tconst frameWindow = sidePanel.getFrameWindow();\n\t\t\tframeWindow.addEventListener('keydown', sidePanel.handleFrameKeyDown);\n\t\t}\n\t}\n\n\tremoveEscapePressHandler()\n\t{\n\t\tconst sidePanel = this.sidePanelManager.getTopSlider();\n\t\tif (sidePanel)\n\t\t{\n\t\t\tconst frameWindow = sidePanel.getFrameWindow();\n\t\t\tframeWindow.removeEventListener('keydown', sidePanel.handleFrameKeyDown);\n\t\t}\n\t}\n\n\tapplyBodyWidthHack()\n\t{\n\t\tif (this.existFrameTopSlider())\n\t\t{\n\t\t\tDom.addClass(document.body, 'tasks-scrum-dod-panel-padding');\n\t\t}\n\t}\n\n\tresetBodyWidthHack()\n\t{\n\t\tif (this.existFrameTopSlider())\n\t\t{\n\t\t\tDom.removeClass(document.body, 'tasks-scrum-dod-panel-padding');\n\t\t}\n\t}\n}","import {Loc, Type} from 'main.core';\nimport {MessageBox} from \"ui.dialogs.messagebox\";\n\ntype RequestDataListComponent = {\n\tgroupId: number\n}\n\ntype RequestDataSaveList = {\n\ttaskId: number,\n\titems: Array\n}\n\ntype RequestDataListOptions = {\n\tgroupId: number\n}\n\nexport class RequestSender\n{\n\tconstructor()\n\t{\n\t\tthis.BX = window.top.BX;\n\t}\n\n\tsendRequest(action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.BX.ajax.runAction('bitrix:tasks.scrum.service.definitionOfDoneService.' + action, {\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tgetListComponent(data: RequestDataListComponent): Promise\n\t{\n\t\treturn this.sendRequest('getItemComponent', data);\n\t}\n\n\tgetListOptions(data: RequestDataListOptions): Promise\n\t{\n\t\treturn this.sendRequest('getListOptions', data);\n\t}\n\n\tgetListButtons(): Promise\n\t{\n\t\treturn this.sendRequest('getTaskCompleteButtons');\n\t}\n\n\tsaveList(data: RequestDataSaveList): Promise\n\t{\n\t\treturn this.sendRequest('saveList', data);\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.log(response);\n\t\t\treturn;\n\t\t}\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Event, Loc, Runtime, Tag, Text, Dom} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {SidePanel} from './side.panel';\nimport {RequestSender} from './request.sender';\n\nimport './css/base.css';\n\ntype Params = {\n\tgroupId: number\n}\n\nexport class ScrumDod\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\tthis.sidePanel = new SidePanel();\n\t\tthis.requestSender = new RequestSender();\n\t}\n\n\tshowList(taskId: number): Promise\n\t{\n\t\treturn this.getListOptions().then((data) => {\n\t\t\tif (this.isRequiredToggle(data))\n\t\t\t{\n\t\t\t\tthis.sidePanelId = 'tasks-scrum-dod';\n\n\t\t\t\tthis.taskId = taskId;\n\n\t\t\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\t\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadList.bind(this));\n\n\t\t\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\t\t\tcontentCallback: () => {\n\t\t\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\t\t\tresolve(this.buildList());\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tzIndex: 1000\n\t\t\t\t});\n\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.resolver = resolve;\n\t\t\t\t\tthis.rejecter = reject;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tbuildList(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-project-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-project-side-panel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-dod-error\"></div>\n\t\t\t\t<div class=\"tasks-scrum-project-dod-list\"></div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadList(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-project-side-panel');\n\n\t\tthis.getListComponent().then((data) => {\n\t\t\tconst listContainer = this.form.querySelector('.tasks-scrum-project-dod-list');\n\t\t\tRuntime.html(listContainer, data.html);\n\t\t}).then(() => {\n\t\t\tthis.getListButtons().then((response) => {\n\t\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-project-side-panel-buttons');\n\t\t\t\tRuntime.html(buttonsContainer, response.html).then(() => {\n\t\t\t\t\tEvent.bind(\n\t\t\t\t\t\tbuttonsContainer.querySelector('[name=save]'),\n\t\t\t\t\t\t'click',\n\t\t\t\t\t\tthis.onCompleteClick.bind(this, sidePanel)\n\t\t\t\t\t);\n\t\t\t\t\tEvent.bind(\n\t\t\t\t\t\tbuttonsContainer.querySelector('[name=cancel]'),\n\t\t\t\t\t\t'click',\n\t\t\t\t\t\tthis.onCancelClick.bind(this, sidePanel)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tgetListComponent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getListComponent({\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\ttaskId: this.taskId\n\t\t\t}).then((response) => {\n\t\t\t\tresolve(response.data);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetListOptions(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getListOptions({\n\t\t\t\tgroupId: this.groupId\n\t\t\t}).then((response) => {\n\t\t\t\tresolve(response.data);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetListButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getListButtons()\n\t\t\t\t.then((response) => {\n\t\t\t\t\tresolve(response.data);\n\t\t\t\t});\n\t\t});\n\t}\n\n\tsaveList(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.saveList(this.getRequestDataForSaveList())\n\t\t\t\t.then((response) => {\n\t\t\t\t\tresolve(response.data);\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\treject(response);\n\t\t\t\t});\n\t\t});\n\t}\n\n\tgetRequestDataForSaveList()\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.taskId = this.taskId;\n\t\trequestData.items = this.getListItems();\n\n\t\treturn requestData;\n\t}\n\n\tgetListItems(): Array\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst treeStructure = BX.Tasks.CheckListInstance.getTreeStructure();\n\t\treturn treeStructure.getRequestData();\n\t\t/* eslint-enable */\n\t}\n\n\tonCompleteClick(sidePanel)\n\t{\n\t\tif (this.isAllToggled())\n\t\t{\n\t\t\tthis.saveList().then((response) => {\n\t\t\t\tsidePanel.close();\n\t\t\t\tthis.resolver();\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.removeClockIconFromButton();\n\t\t\tthis.showError(this.getErrorContainer());\n\t\t}\n\t}\n\n\tonCancelClick(sidePanel)\n\t{\n\t\tsidePanel.close();\n\t}\n\n\tshowError(node: HTMLElement)\n\t{\n\t\tDom.clean(this.form.querySelector('.tasks-scrum-project-dod-error'));\n\t\tDom.append(node, this.form.querySelector('.tasks-scrum-project-dod-error'));\n\t\tthis.form.querySelector('.tasks-scrum-project-side-panel-header').scrollIntoView(true);\n\t}\n\n\tgetErrorContainer(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-alert ui-alert-danger\">\n\t\t\t\t<span class=\"ui-alert-message\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ERROR_ALL_TOGGLED')}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tisAllToggled(): boolean\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet isAllToggled = true;\n\n\t\tconst treeStructure = BX.Tasks.CheckListInstance.getTreeStructure();\n\n\t\ttreeStructure.getDescendants().forEach((checkList) => {\n\t\t\tif (!checkList.checkIsComplete())\n\t\t\t{\n\t\t\t\tisAllToggled = false;\n\t\t\t}\n\t\t});\n\n\t\treturn isAllToggled;\n\t\t/* eslint-enable */\n\t}\n\n\tisRequiredToggle(data): boolean\n\t{\n\t\treturn (data.requiredOption === 'Y');\n\t}\n\n\tremoveClockIconFromButton()\n\t{\n\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-project-side-panel-buttons');\n\t\tif (buttonsContainer)\n\t\t{\n\t\t\tDom.removeClass(buttonsContainer.querySelector('[name=save]'), 'ui-btn-wait');\n\t\t}\n\t}\n}"],"names":["SidePanel","setEventNamespace","sidePanelManager","BX","Instance","contentSidePanelManager","Manager","contentSidePanels","Set","bindEvents","EventEmitter","subscribe","event","getCompatData","sliderEvent","sidePanel","getSlider","setCacheable","emit","has","getUrl","delete","size","resetBodyWidthHack","addEscapePressHandler","id","options","applyBodyWidthHack","removeEscapePressHandler","open","add","Boolean","getTopSlider","frameWindow","getFrameWindow","addEventListener","handleFrameKeyDown","removeEventListener","existFrameTopSlider","Dom","addClass","document","body","removeClass","RequestSender","window","top","action","data","Promise","resolve","reject","ajax","runAction","then","sendRequest","response","alertTitle","Type","isUndefined","errors","console","log","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","ScrumDod","params","groupId","parseInt","requestSender","taskId","getListOptions","isRequiredToggle","sidePanelId","unsubscribeAll","subscribeOnce","onLoadList","bind","openSidePanel","contentCallback","buildList","zIndex","resolver","rejecter","Tag","render","baseEvent","getData","form","getContainer","querySelector","getListComponent","listContainer","Runtime","html","getListButtons","buttonsContainer","Event","onCompleteClick","onCancelClick","saveList","getRequestDataForSaveList","catch","requestData","items","getListItems","Tasks","CheckListInstance","treeStructure","getTreeStructure","getRequestData","isAllToggled","close","removeClockIconFromButton","showError","getErrorContainer","node","clean","append","scrollIntoView","getDescendants","forEach","checkList","checkIsComplete","requiredOption"],"mappings":"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"}