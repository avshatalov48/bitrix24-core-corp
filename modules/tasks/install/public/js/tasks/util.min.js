BX.namespace("Tasks.Util");BX.mergeEx(BX.Tasks.Util,{formatTimeAmount:function(e,t){e=parseInt(e);if(isNaN(e)){return""}var i=e<0?"-":"";e=Math.abs(e);var n=""+Math.floor(e/3600);var s=""+Math.floor(e/60)%60;var o=""+e%60;var a=function(e){return"00".substring(0,2-e.length)+e};var l=a(n)+":"+a(s);if(!t||t=="HH:MI:SS"){l+=":"+a(o)}return i+l},delay:function(e,t,i,n){e=e||BX.DoNothing;t=t||BX.DoNothing;i=i||300;n=n||this;var s=null;var o=function(){var t=arguments;s=setTimeout((function(){e.apply(n,t)}),i)};o.cancel=function(){t.apply(n,[]);clearTimeout(s)};return o},showByClass:function(e){if(BX.hasClass(e,"invisible")){BX.removeClass(e,"invisible")}},hideByClass:function(e){if(!BX.hasClass(e,"invisible")){BX.addClass(e,"invisible")}},fadeToggleByClass:function(e,t,i){return BX.Tasks.Util.animateShowHide({node:e,duration:t,toShow:{opacity:100},toHide:{opacity:0},complete:i})},fadeSlideToggleByClass:function(e,t,i){return BX.Tasks.Util.animateShowHide({node:e,duration:t,toShow:{opacity:100,height:BX.Tasks.Util.getInvisibleSize(e).height},toHide:{opacity:0,height:0},complete:i})},fadeSlideHToggleByClass:function(e,t,i){return BX.Tasks.Util.animateShowHide({node:e,duration:t,toShow:{opacity:100,width:BX.Tasks.Util.getInvisibleSize(e).width},toHide:{opacity:0,width:0},complete:i})},animateShowHide:function(e){e=e||{};var t=e.node||null;if(!BX.type.isElementNode(t)){var i=new BX.Promise;i.reject();return i}var n=BX.hasClass(t,"invisible");var s=typeof e.way=="undefined"||e.way===null?n:!!e.way;if(n!=s){var i=new BX.Promise;i.resolve();return i}var o=e.toShow||{};var a=e.toHide||{};return BX.Tasks.Util.animate({node:t,duration:e.duration,start:!s?o:a,finish:s?o:a,complete:function(){BX[!s?"addClass":"removeClass"](t,"invisible");t.style.cssText="";if(BX.type.isFunction(e.complete)){e.complete.call(this)}},step:function(e){if(typeof e.opacity!="undefined"){t.style.opacity=e.opacity/100}if(typeof e.height!="undefined"){t.style.height=e.height+"px"}if(typeof e.width!="undefined"){t.style.width=e.width+"px"}}})},animate:function(e){e=e||{};var t=e.node||null;var i=new BX.Promise;if(!BX.type.isElementNode(t)){i.reject();return i}var n=e.duration||300;var s=BX.Tasks.Runtime;if(typeof s.animations=="undefined"){s.animations=[]}var o=null;for(var a in s.animations){if(s.animations[a].node==t){o=s.animations[a];break}}if(o===null){var l=new BX.easing({duration:n,start:e.start,finish:e.finish,transition:BX.easing.transitions.linear,step:e.step,complete:function(){for(var n in s.animations){if(s.animations[n].node==t){s.animations[n].easing=null;s.animations[n].node=null;s.animations.splice(n,1);break}}t=null;o=null;e.complete.call(this);if(i){i.fulfill()}}});o={node:t,easing:l};s.animations.push(o)}else{o.easing.stop();if(i){i.reject()}}o.easing.animate();return i},getInvisibleSize:function(e){var t=BX.hasClass(e,"invisible");if(t){BX.removeClass(e,"invisible")}var i=BX.pos(e);if(t){BX.addClass(e,"invisible")}return i},isEnter:function(e){return this.getKeyFromEvent(e)==13},isEsc:function(e){return this.getKeyFromEvent(e)==27},getKeyFromEvent:function(e){e=e||window.event;return e.keyCode||e.which},filterFocusBlur:function(e,t,i,n){if(!BX.type.isElementNode(e)){return false}var s=false;t=t||BX.DoNothing;i=i||BX.DoNothing;n=n||50;var o=function(e,o){if(e){if(s!=false){clearTimeout(s);s=false}else{t.apply(this,o)}}else{s=setTimeout((function(){s=false;i.apply(this,o)}),n)}};BX.bind(e,"blur",(function(){o.apply(this,[false,arguments])}));BX.bind(e,"focus",(function(){o.apply(this,[true,arguments])}));return true},bindInstantChange:function(e,t,i){if(!BX.type.isElementNode(e)){return BX.DoNothing}i=i||e;var n=e.value;var s=BX.debounce((function(s){if(e.value.toString()!=n.toString()){t.apply(i,arguments);n=e.value}}),3,i);BX.bind(e,"input",s);BX.bind(e,"keyup",s);BX.bind(e,"change",s)},disable:function(e){if(BX.type.isElementNode(e)){e.setAttribute("disabled","disabled")}},enable:function(e){if(BX.type.isElementNode(e)){e.removeAttribute("disabled")}},getMessagePlural:function(e,t){return BX.Loc.getMessagePlural(t,parseInt(e))},fireGlobalTaskEvent:function(e,t,i,n){if(!e){return false}e=e.toString();i=i||{};var s=["ADD","UPDATE","DELETE","NOOP","UPDATE_STAGE"];if(s.indexOf(e.toUpperCase())===-1){return false}var o=[e,{task:t,taskUgly:n,options:i}];BX.onCustomEvent(window,"tasksTaskEvent",o);if(window!=window.top){var a=BX.SidePanel.Instance.getOpenSliders();a.forEach((function(e){var t=e.getFrameWindow();if(t){t.BX.onCustomEvent(t,"tasksTaskEvent",o)}}));window.top.BX.onCustomEvent(window.top,"tasksTaskEvent",o)}return true}});BX.Tasks.Util.hintManager={bindHelp:function(e){var t={className:"js-id-hint-help"};BX.bindDelegate(e,"mouseover",t,BX.Tasks.passCtx(this.onHelpShow,this));BX.bindDelegate(e,"mouseout",t,BX.Tasks.passCtx(this.onHelpHide,this))},showDisposable:function(e,t,i,n){if(!BX.type.isPlainObject(n)){n={}}if(!("closeLabel"in n)){n.closeLabel=BX.message("TASKS_COMMON_DONT_SHOW_AGAIN")}if(!("autoHide"in n)){n.autoHide=true}this.show(e,t,false,i,n)},show:function(e,t,i,n,s){n=n||BX.util.hashCode((Math.random()*100).toString()).toString();s=s||{};var o=BX.Tasks.Runtime;o.hintPopup=o.hintPopup||{};if(typeof o.hintPopup[n]=="undefined"){o.hintPopup[n]={popup:null,disable:false}}if(this.wasDisposed(n)){return}if(o.hintPopup[n].popup==null){var a=[];if(BX.type.isNotEmptyString(s.title)){a.push(BX.create("SPAN",{attrs:{className:"task-hint-popup-title"},text:s.title}))}if(!BX.type.isNotEmptyString(t)){t=""}t=BX.util.htmlspecialchars(t).replace(/#BR#/g,"<br />");a.push(BX.create("P",{html:t,style:{margin:"10px 20px 10px 5px"}}));if(BX.type.isNotEmptyString(s.closeLabel)){a.push(BX.create("P",{style:{margin:"10px 20px 10px 5px"},children:[BX.create("A",{props:{href:"javascript:void(0)"},text:s.closeLabel,events:{click:function(){BX.Tasks.Util.hintManager.disable(n);BX.Tasks.Util.hintManager.hide(n)}}})]}))}o.hintPopup[n].popup=BX.PopupWindowManager.create(n,e,{closeByEsc:false,closeIcon:true,angle:{},autoHide:s.autoHide===true,offsetLeft:50,offsetTop:5,content:BX.create("DIV",{attrs:{className:"task-hint-popup-contents"},children:a})})}o.hintPopup[n].popup.show()},wasDisposed:function(e){BX.Tasks.Runtime.hintPopup=BX.Tasks.Runtime.hintPopup||{};BX.Tasks.Runtime.hintPopup[e]=BX.Tasks.Runtime.hintPopup[e]||{};return BX.Tasks.Runtime.hintPopup[e].disable},hide:function(e){try{BX.Tasks.Runtime.hintPopup[e].popup.close()}catch(e){}},disable:function(e){BX.Tasks.Runtime.hintPopup=BX.Tasks.Runtime.hintPopup||{};BX.Tasks.Runtime.hintPopup[e]=BX.Tasks.Runtime.hintPopup[e]||{};BX.Tasks.Runtime.hintPopup[e].disable=true;BX.userOptions.save("tasks","task_hints",e,"N",false)},disableSeveral:function(e){if(BX.type.isPlainObject(e)){var t=BX.Tasks.Runtime;t.hintPopup=t.hintPopup||{};for(var i in e){t.hintPopup[i]=t.hintPopup[i]||{};t.hintPopup[i].disable=!e[i]}}},onHelpShow:function(e){var t=BX.data(e,"hint-enabled");if(t!==null&&typeof t!="undefined"&&t!="1"){return}var i=BX.data(e,"hint-text");if(!i){i=e.innerHTML}if(BX.type.isNotEmptyString(i)){this.onHelpHide();var n=new BX.PopupWindow("tasks-generic-help-popup",e,{lightShadow:true,autoHide:false,darkMode:true,offsetLeft:0,offsetTop:2,bindOptions:{position:"top"},zIndex:200,events:{onPopupClose:function(){this.destroy();BX.Tasks.Runtime.helpWindow=null}},content:BX.create("div",{attrs:{style:"padding-right: 5px; width: 250px;"},html:i})});n.setAngle({offset:13,position:"bottom"});n.show();BX.Tasks.Runtime.helpWindow=n}},onHelpHide:function(){if(BX.Tasks.Runtime.helpWindow){BX.Tasks.Runtime.helpWindow.close()}}};BX.Tasks.Util.MouseTracker=function(){this.coords={x:0,y:0};BX.bind(document,"mousemove",BX.delegate((function(e){this.coords={x:e.pageX?e.pageX:e.clientX?e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft:0,y:e.pageY?e.pageY:e.clientY?e.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop:0}}),this))};BX.Tasks.Util.MouseTracker.getCoordinates=function(){return BX.clone(BX.Tasks.Util.MouseTracker.getInstance().coords)};BX.Tasks.Util.MouseTracker.getInstance=function(){if(typeof BX.Tasks.Runtime.mouseTracker=="undefined"){BX.Tasks.Runtime.mouseTracker=new BX.Tasks.Util.MouseTracker}return BX.Tasks.Runtime.mouseTracker};if(typeof BX.Tasks.Runtime=="undefined"){BX.Tasks.Runtime={}}
//# sourceMappingURL=util.map.js