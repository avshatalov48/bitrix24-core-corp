BX.namespace("BX.Tasks");BX.Tasks.Date={Unit:{Milli:"milli",Second:"second",Minute:"minute",Hour:"hour",Day:"day",Week:"week",Month:"month",Quarter:"quarter",Year:"year"},getNext:function(t,e,i,n){var s=new Date(t.getTime());n=typeof n!=="undefined"?n:1;i=i||1;if(e===this.Unit.Day){s.setUTCMinutes(0,0,0);s=this.add(s,this.Unit.Day,i)}else if(e===this.Unit.Week){var r=s.getUTCDay();s=this.add(s,this.Unit.Day,7*(i-1)+(r<n?n-r:7-r+n))}else if(e===this.Unit.Month){s=this.add(s,this.Unit.Month,i);s.setUTCDate(1)}else if(e===this.Unit.Quarter){s=this.add(s,this.Unit.Month,(i-1)*3+(3-s.getUTCMonth()%3))}else if(e===this.Unit.Year){s=new Date(Date.UTC(s.getUTCFullYear()+i,0,1))}else{s=this.add(t,e,i)}return s},add:function(t,e,i){var n=new Date(t.getTime());if(!e||i===0){return n}switch(e.toLowerCase()){case this.Unit.Milli:n=new Date(t.getTime()+i);break;case this.Unit.Second:n=new Date(t.getTime()+i*1e3);break;case this.Unit.Minute:n=new Date(t.getTime()+i*6e4);break;case this.Unit.Hour:n=new Date(t.getTime()+i*36e5);break;case this.Unit.Day:n.setUTCDate(t.getUTCDate()+i);break;case this.Unit.Week:n.setUTCDate(t.getUTCDate()+i*7);break;case this.Unit.Month:var s=t.getUTCDate();if(s>28){var r=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),1));s=Math.min(s,this.getDaysInMonth(this.add(r,this.Unit.Month,i)))}n.setUTCDate(s);n.setUTCMonth(n.getUTCMonth()+i);break;case this.Unit.Quarter:n=this.add(t,this.Unit.Month,i*3);break;case this.Unit.Year:n.setUTCFullYear(t.getUTCFullYear()+i);break}return n},getUnitRatio:function(t,e){if(t===e){return 1}else if(t===this.Unit.Day){switch(e){case this.Unit.Quarter:return 90;case this.Unit.Month:return 30;case this.Unit.Week:return 7;case this.Unit.Hour:return 1/24;case this.Unit.Minute:return 1/1440}}else if(t===this.Unit.Week){switch(e){case this.Unit.Day:return 1/7;case this.Unit.Hour:return 1/168}}else if(t===this.Unit.Hour){switch(e){case this.Unit.Week:return 168;case this.Unit.Day:return 24;case this.Unit.Minute:return 1/60}}else if(t===this.Unit.Month){switch(e){case this.Unit.Day:return 1/30;case this.Unit.Year:return 12;case this.Unit.Quarter:return 3}}else if(t===this.Unit.Year){switch(e){case this.Unit.Quarter:return 1/4;case this.Unit.Month:return 1/12}}else if(t===this.Unit.Quarter){switch(e){case this.Unit.Year:return 4;case this.Unit.Month:return 1/3;case this.Unit.Day:return 1/90}}else if(t===this.Unit.Minute){switch(e){case this.Unit.Hour:return 60;case this.Unit.Second:return 1/60;case this.Unit.Milli:return 1/6e4}}else if(t===this.Unit.Second){switch(e){case this.Unit.Milli:return 1/1e3}}else if(t===this.Unit.Milli){switch(e){case this.Unit.Week:return 6048e5;case this.Unit.Day:return 864e5;case this.Unit.Hour:return 36e5;case this.Unit.Minute:return 6e4;case this.Unit.Second:return 1e3}}return-1},getDurationInUnit:function(t,e,i){var n=null;if(i===this.Unit.Day){n=Math.round(this.getDurationInDays(t,e))}else if(i===this.Unit.Week){n=Math.round(this.getDurationInDays(t,e)/7)}else if(i===this.Unit.Month){n=Math.round(this.getDurationInMonths(t,e))}else if(i===this.Unit.Hour){n=Math.round(this.getDurationInHours(t,e))}else if(i===this.Unit.Minute){n=Math.round(this.getDurationInMinutes(t,e))}else if(i===this.Unit.Second){n=Math.round(this.getDurationInSeconds(t,e))}else if(i===this.Unit.Year){n=Math.round(this.getDurationInYears(t,e))}else if(i===this.Unit.Quarter){n=Math.round(this.getDurationInMonths(t,e)/3)}else if(i===this.Unit.Milli){n=Math.round(this.getDurationInMilliseconds(t,e))}return n},getDurationInMilliseconds:function(t,e){return e-t},getDurationInSeconds:function(t,e){return(e-t)/1e3},getDurationInMinutes:function(t,e){return(e-t)/6e4},getDurationInHours:function(t,e){return(e-t)/36e5},getDurationInDays:function(t,e){return(e-t)/864e5},getDurationInMonths:function(t,e){return(e.getUTCFullYear()-t.getUTCFullYear())*12+(e.getUTCMonth()-t.getUTCMonth())},getDurationInYears:function(t,e){return this.getDurationInMonths(t,e)/12},min:function(t,e){return t<e?t:e},max:function(t,e){return t>e?t:e},isDate:function(t){return t&&Object.prototype.toString.call(t)==="[object Date]"},getDaysInMonth:function(t){var e=t.getUTCMonth();var i=t.getUTCFullYear();var n=[31,29,31,30,31,30,31,31,30,31,30,31];if(e!==1||(i%4===0&&i%100!==0||i%400===0)){return n[e]}else{return 28}},floorDate:function(t,e,i){var n=new Date(t.getTime());if(e===this.Unit.Day){n.setUTCHours(0,0,0,0)}else if(e===this.Unit.Week){var s=n.getUTCDay();n.setUTCHours(0,0,0,0);if(s!==i){n=this.add(n,this.Unit.Day,-(s>i?s-i:7-s-i))}}else if(e===this.Unit.Month){n.setUTCHours(0,0,0,0);n.setUTCDate(1)}else if(e===this.Unit.Hour){n.setUTCMinutes(0,0,0)}else if(e===this.Unit.Minute){n.setUTCSeconds(0);n.setUTCMilliseconds(0)}else if(e===this.Unit.Second){n.setUTCMilliseconds(0)}else if(e===this.Unit.Year){n=new Date(Date.UTC(t.getUTCFullYear(),0,1))}else if(e===this.Unit.Quarter){n.setUTCHours(0,0,0,0);n.setUTCDate(1);n=this.add(n,this.Unit.Month,-(n.getUTCMonth()%3))}return n},ceilDate:function(t,e,i,n){var s=new Date(t.getTime());if(e===this.Unit.Week){s.setUTCHours(0,0,0,0);return this.add(this.floorDate(s,e,n),e,1)}if(e===this.Unit.Hour){s.setUTCMinutes(0,0,0)}else if(e===this.Unit.Minute){s.setUTCSeconds(0,0)}else if(e===this.Unit.Second){s.setUTCMilliseconds(0)}else{s.setUTCHours(0,0,0,0)}return this.getNext(s,e,i)},convertToUTC:function(t){if(!t){return null}return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),0))},convertFromUTC:function(t){if(!t){return null}return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),0)}};