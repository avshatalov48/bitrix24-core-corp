{"version":3,"file":"check-list-item.bundle.js","sources":["../src/tree-item.js","../src/composite-tree-item.js","../src/check-list-item-fields.js","../src/check-list-item.js"],"sourcesContent":["class TreeItem\n{\n\tstatic generateUniqueNodeId()\n\t{\n\t\treturn Math.random().toString(36).substr(2, 9);\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.setNodeId(TreeItem.generateUniqueNodeId());\n\t\tthis.setParent(null);\n\t}\n\n\tgetRootNode()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (parent.getParent() !== null)\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tgetNodeId()\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tsetNodeId(nodeId)\n\t{\n\t\tthis.nodeId = nodeId;\n\t}\n\n\tgetParent()\n\t{\n\t\treturn this.parent;\n\t}\n\n\tsetParent(parent)\n\t{\n\t\tthis.parent = parent;\n\t}\n}\n\nexport {TreeItem};","import {TreeItem} from './tree-item';\n\nclass CompositeTreeItem extends TreeItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.descendants = [];\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\titem.setParent(this);\n\n\t\tif (position === null)\n\t\t{\n\t\t\tthis.descendants.push(item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.descendants.splice(position, 0, item);\n\t\t}\n\t}\n\n\taddAfter(item, after)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === after);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index + 1);\n\t\t}\n\t}\n\n\taddBefore(item, before)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === before);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index);\n\t\t}\n\t}\n\n\tremove(item)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === item);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.descendants.splice(index, 1);\n\t\t}\n\t}\n\n\tgetDescendants()\n\t{\n\t\treturn this.descendants;\n\t}\n\n\tgetDescendantsCount()\n\t{\n\t\treturn this.descendants.length;\n\t}\n\n\tgetFirstDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[0];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetLastDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[this.descendants.length - 1];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tisFirstDescendant()\n\t{\n\t\treturn (this === this.getParent().getFirstDescendant());\n\t}\n\n\tisLastDescendant()\n\t{\n\t\treturn (this === this.getParent().getLastDescendant());\n\t}\n\n\tgetLeftSibling()\n\t{\n\t\tif (this.isFirstDescendant())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index - 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetRightSibling()\n\t{\n\t\tif (this.isLastDescendant())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index + 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetLeftSiblingThrough()\n\t{\n\t\tif (this === this.getRootNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.isFirstDescendant())\n\t\t{\n\t\t\treturn this.getParent();\n\t\t}\n\n\t\tlet leftSiblingThrough = this.getLeftSibling();\n\t\twhile (leftSiblingThrough && leftSiblingThrough.getDescendantsCount() > 0)\n\t\t{\n\t\t\tleftSiblingThrough = leftSiblingThrough.getLastDescendant();\n\t\t}\n\n\t\treturn leftSiblingThrough;\n\t}\n\n\tgetRightSiblingThrough()\n\t{\n\t\tif (this.getDescendantsCount() > 0)\n\t\t{\n\t\t\treturn this.getFirstDescendant();\n\t\t}\n\n\t\tif (!this.isLastDescendant())\n\t\t{\n\t\t\treturn this.getRightSibling();\n\t\t}\n\n\t\tlet parent = this;\n\t\twhile (parent.getParent() !== null && parent.isLastDescendant())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\tif (parent !== this.getRootNode())\n\t\t{\n\t\t\treturn parent.getRightSibling();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindChild(nodeId)\n\t{\n\t\tif (!nodeId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.getNodeId().toString() === nodeId.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findChild(nodeId);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountTreeSize()\n\t{\n\t\tlet size = this.getDescendantsCount();\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tsize += descendant.countTreeSize();\n\t\t});\n\n\t\treturn size;\n\t}\n\n\tgetTreeSize()\n\t{\n\t\treturn this.getRootNode().countTreeSize() + 1;\n\t}\n}\n\nexport {CompositeTreeItem};","import {Text, Type} from 'main.core';\n\nclass CheckListItemFields\n{\n\tstatic snakeToCamelCase(string)\n\t{\n\t\tlet camelCaseString = string;\n\n\t\tif (Type.isString(camelCaseString))\n\t\t{\n\t\t\tcamelCaseString = camelCaseString.toLowerCase();\n\t\t\tcamelCaseString = camelCaseString.replace(/[-_\\s]+(.)?/g, (match, chr) => (chr ? chr.toUpperCase() : ''));\n\n\t\t\treturn camelCaseString.substr(0, 1).toLowerCase() + camelCaseString.substr(1);\n\t\t}\n\n\t\treturn camelCaseString;\n\t}\n\n\tstatic camelToSnakeCase(string)\n\t{\n\t\tlet snakeCaseString = string;\n\n\t\tif (Type.isString(snakeCaseString))\n\t\t{\n\t\t\tsnakeCaseString = snakeCaseString.replace(/(.)([A-Z])/g, '$1_$2').toUpperCase();\n\t\t}\n\n\t\treturn snakeCaseString;\n\t}\n\n\tconstructor(fields)\n\t{\n\t\tthis.fields = [\n\t\t\t'id',\n\t\t\t'copiedId',\n\t\t\t'parentId',\n\t\t\t'title',\n\t\t\t'sortIndex',\n\t\t\t'displaySortIndex',\n\t\t\t'isComplete',\n\t\t\t'isImportant',\n\t\t\t'isSelected',\n\t\t\t'isCollapse',\n\t\t\t'completedCount',\n\t\t\t'totalCount',\n\t\t\t'members',\n\t\t\t'attachments',\n\t\t];\n\n\t\tthis.id = null;\n\t\tthis.parentId = null;\n\t\tthis.title = '';\n\t\tthis.sortIndex = 0;\n\t\tthis.displaySortIndex = '';\n\t\tthis.isComplete = false;\n\t\tthis.isImportant = false;\n\t\tthis.isSelected = false;\n\t\tthis.isCollapse = false;\n\t\tthis.completedCount = 0;\n\t\tthis.totalCount = 0;\n\t\tthis.members = new Map();\n\t\tthis.attachments = {};\n\n\t\tthis.setFields(fields);\n\t}\n\n\tsetFields(fields)\n\t{\n\t\tObject.keys(fields).forEach((name) => {\n\t\t\tconst camelCaseName = CheckListItemFields.snakeToCamelCase(name);\n\n\t\t\tif (this.fields.indexOf(name) !== -1)\n\t\t\t{\n\t\t\t\tconst snakeCaseName = CheckListItemFields.camelToSnakeCase(name);\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${snakeCaseName}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t\telse if (this.fields.indexOf(camelCaseName) !== -1)\n\t\t\t{\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${name}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\tgetCopiedId()\n\t{\n\t\treturn this.copiedId;\n\t}\n\n\tsetCopiedId(copiedId)\n\t{\n\t\tthis.copiedId = copiedId;\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetParentId(parentId)\n\t{\n\t\tthis.parentId = parentId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title)\n\t{\n\t\tthis.title = Text.encode(title);\n\t}\n\n\tgetSortIndex()\n\t{\n\t\treturn this.sortIndex;\n\t}\n\n\tsetSortIndex(sortIndex)\n\t{\n\t\tthis.sortIndex = sortIndex;\n\t}\n\n\tgetDisplaySortIndex()\n\t{\n\t\treturn this.displaySortIndex;\n\t}\n\n\tsetDisplaySortIndex(displaySortIndex)\n\t{\n\t\tthis.displaySortIndex = displaySortIndex;\n\t}\n\n\tgetIsComplete()\n\t{\n\t\treturn this.isComplete;\n\t}\n\n\tsetIsComplete(isComplete)\n\t{\n\t\tthis.isComplete = isComplete;\n\t}\n\n\tgetIsImportant()\n\t{\n\t\treturn this.isImportant;\n\t}\n\n\tsetIsImportant(isImportant)\n\t{\n\t\tthis.isImportant = isImportant;\n\t}\n\n\tgetIsSelected()\n\t{\n\t\treturn this.isSelected;\n\t}\n\n\tsetIsSelected(isSelected)\n\t{\n\t\tthis.isSelected = isSelected;\n\t}\n\n\tgetIsCollapse()\n\t{\n\t\treturn this.isCollapse;\n\t}\n\n\tsetIsCollapse(isCollapse)\n\t{\n\t\tthis.isCollapse = isCollapse;\n\t}\n\n\tgetCompletedCount()\n\t{\n\t\treturn this.completedCount;\n\t}\n\n\tsetCompletedCount(completedCount)\n\t{\n\t\tthis.completedCount = completedCount;\n\t}\n\n\tgetTotalCount()\n\t{\n\t\treturn this.totalCount;\n\t}\n\n\tsetTotalCount(totalCount)\n\t{\n\t\tthis.totalCount = totalCount;\n\t}\n\n\tgetMembers()\n\t{\n\t\treturn this.members;\n\t}\n\n\tsetMembers(members)\n\t{\n\t\tconst types = {\n\t\t\tA: 'accomplice',\n\t\t\tU: 'auditor',\n\t\t};\n\n\t\tthis.members.clear();\n\n\t\tObject.keys(members).forEach((id) => {\n\t\t\tconst {NAME, TYPE} = members[id];\n\t\t\tthis.members.set(id, {id, nameFormatted: Text.encode(NAME), type: types[TYPE]});\n\t\t});\n\t}\n\n\taddMember(member)\n\t{\n\t\tthis.members.set(member.id, member);\n\t}\n\n\tremoveMember(id)\n\t{\n\t\tthis.members.delete(id);\n\t}\n\n\tgetAttachments()\n\t{\n\t\treturn this.attachments;\n\t}\n\n\tsetAttachments(attachments)\n\t{\n\t\tthis.attachments = attachments;\n\t}\n\n\taddAttachments(attachments)\n\t{\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\tthis.attachments[id] = attachments[id];\n\t\t});\n\t}\n\n\tremoveAttachment(id)\n\t{\n\t\tdelete this.attachments[id];\n\t}\n}\n\nexport {CheckListItemFields};","import 'ui.design-tokens';\nimport './css/check-list-item.css';\n\nimport {Dom, Event, Loc, Runtime, Tag, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {CompositeTreeItem} from './composite-tree-item';\nimport {CheckListItemFields} from './check-list-item-fields';\n\nclass CheckListItem extends CompositeTreeItem\n{\n\tclass = CheckListItem;\n\n\tcheckedClass = 'tasks-checklist-item-solved';\n\thiddenClass = 'tasks-checklist-item-hidden';\n\tcollapseClass = 'tasks-checklist-collapse';\n\twrapperClass = 'tasks-checklist-items-wrapper';\n\n\tshowClass = 'tasks-checklist-item-show';\n\thideClass = 'tasks-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.tasks-checklist-item-important',\n\t\t\t'.tasks-checklist-item-dragndrop',\n\t\t\t'.tasks-checklist-item-group-checkbox',\n\t\t\t'.tasks-checklist-item-remove',\n\t\t\t'.tasks-checklist-item-flag-block',\n\t\t],\n\t};\n\n\tstatic addDangerToElement(element)\n\t{\n\t\tconst dangerClass = 'ui-ctl-danger';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tstatic updateParents(oldParent, newParent)\n\t{\n\t\tif (oldParent !== newParent)\n\t\t{\n\t\t\toldParent.updateCounts();\n\t\t\tnewParent.updateCounts();\n\n\t\t\toldParent.updateProgress();\n\t\t\tnewParent.updateProgress();\n\n\t\t\toldParent.updateIndexes();\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t}\n\n\tstatic getProgressText(completed, total)\n\t{\n\t\tconst replaces = {\n\t\t\t'#total#': total,\n\t\t\t'#completed#': completed,\n\t\t};\n\t\tlet progressText = Loc.getMessage('TASKS_CHECKLIST_PROGRESS_BAR_PROGRESS_TEXT');\n\n\t\tObject.keys(replaces).forEach((search) => {\n\t\t\tprogressText = progressText.replace(search, replaces[search]);\n\t\t});\n\n\t\treturn progressText;\n\t}\n\n\tstatic getFileExtension(ext)\n\t{\n\t\tlet fileExtension;\n\n\t\tswitch (ext)\n\t\t{\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'swf':\n\t\t\tcase 'wmv':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'txt':\n\t\t\t\tfileExtension = 'txt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'doc':\n\t\t\tcase 'docx':\n\t\t\t\tfileExtension = 'doc';\n\t\t\t\tbreak;\n\n\t\t\tcase 'xls':\n\t\t\tcase 'xlsx':\n\t\t\t\tfileExtension = 'xls';\n\t\t\t\tbreak;\n\n\t\t\tcase 'php':\n\t\t\t\tfileExtension = 'php';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pdf':\n\t\t\t\tfileExtension = 'pdf';\n\t\t\t\tbreak;\n\n\t\t\tcase 'ppt':\n\t\t\tcase 'pptx':\n\t\t\t\tfileExtension = 'ppt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rar':\n\t\t\t\tfileExtension = 'rar';\n\t\t\t\tbreak;\n\n\t\t\tcase 'zip':\n\t\t\t\tfileExtension = 'zip';\n\t\t\t\tbreak;\n\n\t\t\tcase 'set':\n\t\t\t\tfileExtension = 'set';\n\t\t\t\tbreak;\n\n\t\t\tcase 'mov':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'img':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\t\tfileExtension = 'img';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tfileExtension = 'empty';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn fileExtension;\n\t}\n\n\tstatic getInputSelection(input)\n\t{\n\t\tlet start = 0;\n\t\tlet end = 0;\n\t\tlet normalizedValue;\n\t\tlet range;\n\t\tlet textInputRange;\n\t\tlet len;\n\t\tlet endRange;\n\n\t\tif (typeof input.selectionStart === 'number' && typeof input.selectionEnd === 'number')\n\t\t{\n\t\t\tstart = input.selectionStart;\n\t\t\tend = input.selectionEnd;\n\t\t}\n\t\telse\n\t\t{\n\t\t\trange = document.selection.createRange();\n\n\t\t\tif (range && range.parentElement() === input)\n\t\t\t{\n\t\t\t\tlen = input.value.length;\n\t\t\t\tnormalizedValue = input.value.replace(/\\r\\n/g, '\\n');\n\n\t\t\t\t// Create a working TextRange that lives only in the input\n\t\t\t\ttextInputRange = input.createTextRange();\n\t\t\t\ttextInputRange.moveToBookmark(range.getBookmark());\n\n\t\t\t\t// Check if the start and end of the selection are at the very end\n\t\t\t\t// of the input, since moveStart/moveEnd doesn't return what we want\n\t\t\t\t// in those cases\n\t\t\t\tendRange = input.createTextRange();\n\t\t\t\tendRange.collapse(false);\n\n\t\t\t\tif (textInputRange.compareEndPoints('StartToEnd', endRange) > -1)\n\t\t\t\t{\n\t\t\t\t\tstart = len;\n\t\t\t\t\tend = len;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstart = -textInputRange.moveStart('character', -len);\n\t\t\t\t\tstart += normalizedValue.slice(0, start).split('\\n').length - 1;\n\n\t\t\t\t\tif (textInputRange.compareEndPoints('EndToEnd', endRange) > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tend = len;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tend = -textInputRange.moveEnd('character', -len);\n\t\t\t\t\t\tend += normalizedValue.slice(0, end).split('\\n').length - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {start, end};\n\t}\n\n\tstatic getDefaultCheckListTitle(title)\n\t{\n\t\tlet defaultTitle = title;\n\n\t\tif (title.indexOf('BX_CHECKLIST') === 0)\n\t\t{\n\t\t\tif (title === 'BX_CHECKLIST')\n\t\t\t{\n\t\t\t\tdefaultTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_2');\n\t\t\t}\n\t\t\telse if (title.match(/BX_CHECKLIST_\\d+$/))\n\t\t\t{\n\t\t\t\tconst itemNumber = title.replace('BX_CHECKLIST_', '');\n\t\t\t\tdefaultTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_WITH_NUMBER').replace('#ITEM_NUMBER#', itemNumber);\n\t\t\t}\n\t\t}\n\n\t\treturn defaultTitle;\n\t}\n\n\tstatic smoothScroll(node)\n\t{\n\t\tconst posFrom = BX.GetWindowScrollPos().scrollTop;\n\t\tconst posTo = BX.pos(node).top - Math.round(BX.GetWindowInnerSize().innerHeight / 2);\n\t\tconst toBottom = posFrom < posTo;\n\t\tconst distance = Math.abs(posTo - posFrom);\n\t\tconst speed = (Math.round(distance / 100) > 20 ? 20 : Math.round(distance / 100));\n\t\tconst step = speed / 2;\n\n\t\tif (step <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet posCurrent = (toBottom ? posFrom + step : posFrom - step);\n\t\tlet timer = 0;\n\n\t\tif (toBottom)\n\t\t{\n\t\t\tfor (let i = posFrom; i < posTo; i += step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent += step;\n\t\t\t\tif (posCurrent > posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor (let i = posFrom; i > posTo; i -= step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent -= step;\n\t\t\t\tif (posCurrent < posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getMemberLinkLayout(type, name, url)\n\t{\n\t\tconst messageId = `TASKS_CHECKLIST_${type.toUpperCase()}_ICON_HINT`;\n\t\treturn `\n\t\t\t<span class=\"tasks-checklist-item-auditor\">\n\t\t\t\t<a class=\"tasks-checklist-item-${type}-icon\" title=\"${Loc.getMessage(messageId)}\"></a>\n\t\t\t\t<a href=\"${url}\" class=\"tasks-checklist-item-${type}-link\">${name}</a>\n\t\t\t</span> \n\t\t`;\n\t}\n\n\tstatic getLinkLayout(url)\n\t{\n\t\treturn `<a class=\"tasks-checklist-item-link\" href=\"${url}\" target=\"_blank\">${url}</a>`;\n\t}\n\n\tstatic get keyCodes()\n\t{\n\t\treturn {\n\t\t\tesc: 27,\n\t\t\tenter: 13,\n\t\t\tplus: 43,\n\t\t\tatsign: 64,\n\t\t\ttab: 9,\n\t\t\tup: 38,\n\t\t\tdown: 40,\n\t\t\tbackspace: 8,\n\t\t};\n\t}\n\n\tconstructor(fields = {})\n\t{\n\t\tconst {action} = fields;\n\n\t\tsuper();\n\t\tthis.fields = new CheckListItemFields(fields);\n\t\tthis.action = {\n\t\t\tcanUpdate: (action && 'MODIFY' in action) ? action.MODIFY : true,\n\t\t\tcanRemove: (action && 'REMOVE' in action) ? action.REMOVE : true,\n\t\t\tcanToggle: (action && 'TOGGLE' in action) ? action.TOGGLE : true,\n\t\t\tcanDrag: (action && 'DRAG' in action) ? action.DRAG : true,\n\t\t};\n\n\t\tthis.input = null;\n\t\tthis.panel = null;\n\t\tthis.progress = null;\n\t\tthis.filesLoaderPopup = null;\n\t\tthis.filesLoaderProgressBars = new Map();\n\t\tthis.updateMode = false;\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\tsuper.add(item, position);\n\n\t\titem.optionManager = this.optionManager;\n\t\titem.clickEventHandler = this.clickEventHandler;\n\t}\n\n\tisTaskRoot()\n\t{\n\t\treturn this.getNodeId() === 0 && this.getParent() === null;\n\t}\n\n\tisCheckList()\n\t{\n\t\treturn !this.isTaskRoot() && this.getParent().isTaskRoot();\n\t}\n\n\tgetCheckList()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (!parent.getParent().isTaskRoot())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tfindById(id)\n\t{\n\t\tif (!id)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.fields.getId() && this.fields.getId().toString() === id.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findById(id);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountCompletedCount(recursively = false)\n\t{\n\t\tlet completedCount = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsComplete())\n\t\t\t{\n\t\t\t\tcompletedCount += 1;\n\t\t\t}\n\n\t\t\tif (recursively)\n\t\t\t{\n\t\t\t\tcompletedCount += descendant.countCompletedCount(recursively);\n\t\t\t}\n\t\t});\n\n\t\treturn completedCount;\n\t}\n\n\tcountTotalCount(recursively = false)\n\t{\n\t\tlet totalCount = 0;\n\n\t\tif (!recursively)\n\t\t{\n\t\t\ttotalCount = this.getDescendantsCount();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\ttotalCount += 1;\n\t\t\t\ttotalCount += descendant.countTotalCount(recursively);\n\t\t\t});\n\t\t}\n\n\t\treturn totalCount;\n\t}\n\n\tupdateCompletedCount()\n\t{\n\t\tconst completedCount = this.countCompletedCount();\n\t\tthis.fields.setCompletedCount(completedCount);\n\t}\n\n\tupdateTotalCount()\n\t{\n\t\tconst totalCount = this.countTotalCount();\n\t\tthis.fields.setTotalCount(totalCount);\n\t}\n\n\tupdateCounts()\n\t{\n\t\tthis.updateCompletedCount();\n\t\tthis.updateTotalCount();\n\t}\n\n\tupdateProgress()\n\t{\n\t\tif (this.progress === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst total = this.fields.getTotalCount();\n\t\tconst completed = this.fields.getCompletedCount();\n\n\t\tthis.progress.setMaxValue(total);\n\t\tthis.progress.update(completed);\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tthis.updateProgressText(completed, total);\n\t\t}\n\t}\n\n\tupdateProgressText(completed, total)\n\t{\n\t\tconst progressText = CheckListItem.getProgressText(completed, total);\n\t\tthis.progress.setTextAfter(progressText);\n\t}\n\n\tsetDefaultStyles(layout, action = 'add')\n\t{\n\t\tif (action === 'add')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = 0;\n\t\t\tlayout.style.opacity = 0;\n\n\t\t\tDom.addClass(layout, this.showClass);\n\t\t}\n\t\telse if (action === 'delete')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = `${layout.scrollHeight}px`;\n\t\t\tlayout.style.opacity = 1;\n\n\t\t\tDom.addClass(layout, this.hideClass);\n\t\t}\n\t}\n\n\tdelete()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tparent.remove(this);\n\t\tparent.updateCounts();\n\t\tparent.updateProgress();\n\n\t\tthis.setDefaultStyles(this.container, 'delete');\n\n\t\tsetTimeout(() => {\n\t\t\tthis.container.style.height = 0;\n\t\t\tthis.container.style.opacity = 0;\n\t\t\tthis.container.style.paddingTop = 0;\n\t\t}, 1);\n\n\t\tsetTimeout(() => {\n\t\t\tDom.remove(this.container);\n\t\t}, 250);\n\t}\n\n\trestore()\n\t{\n\t\tconst parent = this.getParent();\n\t\tconst position = this.fields.getSortIndex();\n\n\t\tif (position === 0)\n\t\t{\n\t\t\tif (parent.getDescendantsCount() > 0)\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this, parent.getFirstDescendant(), 'before');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparent.addCheckListItem(this, parent.getDescendants()[position - 1]);\n\t\t}\n\t}\n\n\tdeleteAction(showBalloon = true)\n\t{\n\t\tconst title = this.fields.getTitle();\n\n\t\tthis.delete();\n\n\t\tif (showBalloon && title.length > 0 && title !== '')\n\t\t{\n\t\t\tconst action = 'DELETE';\n\t\t\tconst data = {\n\t\t\t\ttype: this.isCheckList() ? 'CHECKLIST' : 'ITEM',\n\t\t\t};\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'delete'});\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tonDeleteClick(e)\n\t{\n\t\te.preventDefault();\n\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tconst items = this.getSelectedItems();\n\t\t\tconst action = 'DELETE_SELECTED';\n\t\t\tconst data = {items};\n\n\t\t\tthis.runForEachSelectedItem((item) => {\n\t\t\t\titem.fields.setIsSelected(false);\n\t\t\t\titem.deleteAction(false);\n\t\t\t});\n\n\t\t\titems.forEach((item) => {\n\t\t\t\titem.getParent().updateIndexes();\n\t\t\t\titem.handleCheckListChanges();\n\t\t\t});\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteAction();\n\t\tthis.getParent().updateIndexes();\n\n\t\tthis.handleCheckListChanges();\n\t}\n\n\tgetNotificationBalloon(action, data)\n\t{\n\t\tconst actions = [];\n\t\tlet content = '';\n\n\t\tswitch (action)\n\t\t{\n\t\t\tcase 'DELETE':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_${data.type}`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tthis.restore();\n\t\t\t\t\t\t\tthis.handleCheckListChanges();\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'DELETE_SELECTED':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_ITEMS`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tdata.items.forEach((item) => {\n\t\t\t\t\t\t\t\titem.restore();\n\t\t\t\t\t\t\t\titem.handleCheckListChanges();\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'AUDITOR_ADDED':\n\t\t\tcase 'ACCOMPLICE_ADDED':\n\t\t\t{\n\t\t\t\tlet image = '';\n\t\t\t\tif (data.avatar)\n\t\t\t\t{\n\t\t\t\t\timage = Tag.render`\n\t\t\t\t\t\t<img class=\"tasks-checklist-notification-balloon-avatar-img\" src=\"${data.avatar}\" alt=\"\"/>\n\t\t\t\t\t`;\n\t\t\t\t}\n\t\t\t\tcontent = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-message-container\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-avatar\">\n\t\t\t\t\t\t\t${image}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"tasks-checklist-notification-balloon-message\">\n\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}`)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tBX.loadExt('ui.notification').then(() => {\n\t\t\tBX.UI.Notification.Center.notify({content, actions});\n\t\t});\n\t}\n\n\tonToAnotherCheckListClick(e)\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (rootNode.getDescendantsCount() === 1)\n\t\t{\n\t\t\tthis.moveToNewCheckList(2);\n\t\t\treturn;\n\t\t}\n\n\t\tnew BX.PopupMenuWindow(\n\t\t\t'to-another-checklist',\n\t\t\te.target,\n\t\t\tthis.getToAnotherCheckListPopupItems(),\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 3,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose() {\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t).show();\n\t}\n\n\tgetToAnotherCheckListPopupItems()\n\t{\n\t\tconst selectMode = this.checkSelectedItems();\n\t\tconst popupMenuItems = [];\n\t\tconst toNewCheckListMenuItem = {\n\t\t\ttext: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tonclick: (event, item) => {\n\t\t\t\titem.getMenuWindow().close();\n\t\t\t\tthis.moveToNewCheckList(this.getRootNode().getDescendantsCount() + 1);\n\t\t\t},\n\t\t};\n\n\t\tif (selectMode)\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tpopupMenuItems.push({\n\t\t\t\t\ttext: descendant.fields.getTitle(),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\titem.getMenuWindow().close();\n\n\t\t\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\t\t\tselectedItem.makeChildOf(descendant);\n\t\t\t\t\t\t\tdescendant.unselectAll();\n\n\t\t\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tpopupMenuItems.push({delimiter: true});\n\t\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\t\treturn popupMenuItems;\n\t\t}\n\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupMenuItems.push({\n\t\t\t\ttext: descendant.fields.getTitle(),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\tthis.makeChildOf(descendant);\n\t\t\t\t\tthis.handleUpdateEnding();\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tpopupMenuItems.push({delimiter: true});\n\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\treturn popupMenuItems;\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new CheckListItem({TITLE: title});\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tif (this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\tselectedItem.makeChildOf(newCheckList);\n\t\t\t\t\tnewCheckList.unselectAll();\n\n\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.makeChildOf(newCheckList);\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessMemberSelect(member)\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tconst title = selectedItem.fields.getTitle();\n\t\t\t\tconst space = (title.slice(-1) === ' ' ? '' : ' ');\n\t\t\t\tconst newTitle = `${title}${space}${member.nameFormatted}`;\n\n\t\t\t\tselectedItem.fields.addMember(member);\n\t\t\t\tselectedItem.updateTitle(Text.decode(newTitle));\n\t\t\t\tselectedItem.updateTitleNode();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputText = this.input.value;\n\t\tconst mentioned = +this.mentioned;\n\t\tconst start = this.inputCursorPosition.start || 0;\n\t\tconst startSpace = (start === 0 || start - mentioned === 0 || inputText.charAt(start - mentioned - 1) === ' ') ? '' : ' ';\n\t\tconst endSpace = (inputText.charAt(start) === ' ' ? '' : ' ');\n\n\t\tthis.fields.addMember(member);\n\n\t\tconst newInputText = `${inputText.slice(0, start - mentioned)}${startSpace}${Text.decode(member.nameFormatted)}${endSpace}`;\n\n\t\tthis.inputCursorPosition.start = newInputText.length;\n\t\tthis.inputCursorPosition.end = newInputText.length;\n\n\t\tthis.input.value = `${newInputText}${inputText.slice(start)}`;\n\t\tthis.mentioned = false;\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tonSocNetSelectorAuditorSelected(auditor)\n\t{\n\t\tconst type = 'auditor';\n\t\tconst userData = this.prepareUserData(auditor);\n\t\tconst resultAuditor = {...userData, type};\n\n\t\tconst notificationAction = `${type.toUpperCase()}_ADDED`;\n\t\tconst notificationData = {avatar: auditor.avatar};\n\n\t\tthis.processMemberSelect(resultAuditor);\n\t\tthis.getNotificationBalloon(notificationAction, notificationData);\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:auditorAdded', userData);\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'addAuditor'});\n\t}\n\n\tonSocNetSelectorAccompliceSelected(accomplice)\n\t{\n\t\tconst type = 'accomplice';\n\t\tconst userData = this.prepareUserData(accomplice);\n\t\tconst resultAccomplice = {...userData, type};\n\n\t\tconst notificationAction = `${type.toUpperCase()}_ADDED`;\n\t\tconst notificationData = {avatar: accomplice.avatar};\n\n\t\tthis.processMemberSelect(resultAccomplice);\n\t\tthis.getNotificationBalloon(notificationAction, notificationData);\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:accompliceAdded', userData);\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'addAccomplice'});\n\t}\n\n\tprepareUserData(user)\n\t{\n\t\tconst customData = user.getCustomData();\n\t\tconst entityType = user.getEntityType();\n\n\t\treturn {\n\t\t\tavatar: user.avatar,\n\t\t\tdescription: '',\n\t\t\tentityType: 'U',\n\t\t\tid: user.getId(),\n\t\t\tname: customData.get('name'),\n\t\t\tlastName: customData.get('lastName'),\n\t\t\temail: customData.get('email'),\n\t\t\tnameFormatted: Text.encode(user.getTitle()),\n\t\t\tnetworkId: '',\n\t\t\ttype: {\n\t\t\t\tcrmemail: false,\n\t\t\t\textranet: (entityType === 'extranet'),\n\t\t\t\temail: (entityType === 'email'),\n\t\t\t\tnetwork: (entityType === 'network'),\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMemberSelector(e, memberType = 'auditor', mentioned = false)\n\t{\n\t\tif (!this.checkCanAddAccomplice())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst typeFunctionMap = {\n\t\t\tauditor: this.onSocNetSelectorAuditorSelected.bind(this),\n\t\t\taccomplice: this.onSocNetSelectorAccompliceSelected.bind(this),\n\t\t};\n\t\tconst typeFunction = typeFunctionMap[memberType] || typeFunctionMap.auditor;\n\n\t\tthis.isSelectorLoading = true;\n\n\t\tRuntime.loadExtension('ui.entity-selector').then(exports => {\n\t\t\tconst {Dialog} = exports;\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: e.target,\n\t\t\t\tenableSearch: true,\n\t\t\t\tmultiple: false,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\temailUsers: true,\n\t\t\t\t\t\t\tnetworkUsers: this.optionManager.isNetworkEnabled,\n\t\t\t\t\t\t\textranetUsers: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\t'onLoad': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.isSelectorLoading = false;\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.isSelectorLoading = false;\n\t\t\t\t\t\tthis.mentioned = mentioned;\n\t\t\t\t\t\tthis.retrieveFocus();\n\n\t\t\t\t\t\tconst {item: selectedItem} = event.getData();\n\t\t\t\t\t\ttypeFunction(selectedItem);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\tonAddAuditorClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'auditor');\n\t}\n\n\tonAddAccompliceClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'accomplice');\n\t}\n\n\tonUploadAttachmentClick(e)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst {prefix, diskUrls} = this.optionManager;\n\t\tconst {urlSelect, urlRenameFile, urlDeleteFile, urlUpload} = diskUrls;\n\n\t\tif (this.filesLoaderPopup === null)\n\t\t{\n\t\t\tthis.filesLoaderPopup = new BX.PopupWindow({\n\t\t\t\tcontent: this.getAttachmentsLoaderLayout(),\n\t\t\t\tbindElement: e.target,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 2,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: true,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filesLoaderPopup.setBindElement(e.target);\n\t\t}\n\n\t\tthis.filesLoaderPopup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: nodeId,\n\t\t\tcontrolName: `${prefix}[${nodeId}][UF_CHECKLIST_FILES][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect,\n\t\t\turlRenameFile,\n\t\t\turlDeleteFile,\n\t\t\turlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.filesLoaderPopup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show'],\n\t\t);\n\t}\n\n\tonDeleteAttachmentClick(fileId)\n\t{\n\t\tthis.fields.removeAttachment(fileId);\n\t\tDom.remove(this.getAttachmentsContainer().querySelector(`#disk-attach-${fileId}`));\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'deleteAttachment'});\n\t}\n\n\tgetPanelBodyLayout()\n\t{\n\t\tconst membersLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-auditor\" onclick=\"${this.onAddAuditorClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_AUDITOR'}`}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-accomplice\" onclick=\"${this.onAddAccompliceClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_ACCOMPLICE'}`}</span>\n\t\t\t</div>\n\t\t`;\n\t\tconst attachmentButtonLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-attachment\" onclick=\"${this.onUploadAttachmentClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tconst itemsActionButtonsLayout = Tag.render`\n\t\t\t${this.checkSelectedItems() ? '' : attachmentButtonLayout}\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabin\" onclick=\"${this.onTabInClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabout\" onclick=\"${this.onTabOutClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-important\n\t\t\t\t${this.fields.getIsImportant() ? ' tasks-checklist-item-editor-panel-btn-important-selected' : ''}\" onclick=\"${this.onImportantClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage('TASKS_CHECKLIST_PANEL_IMPORTANT')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-checklist\" onclick=\"${this.onToAnotherCheckListClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage('TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-remove\" onclick=\"${this.onDeleteClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tconst separator = Tag.render`<div class=\"tasks-checklist-item-editor-panel-separator\"></div>`;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel ${this.isTaskRoot() || this.isCheckList() ? 'tasks-checklist-item-editor-group-panel' : ''}\">\n\t\t\t\t${this.checkCanAddAccomplice() ? membersLayout : ''}\n\t\t\t\t${this.checkCanAddAccomplice() && !this.isCheckList() ? separator : ''}\n\t\t\t\t${!this.isCheckList() ? itemsActionButtonsLayout : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateTitle(text)\n\t{\n\t\tthis.fields.setTitle(text);\n\t}\n\n\tupdateTitleNode()\n\t{\n\t\tDom.replace(this.getTitleNodeContainer(), this.getTitleLayout());\n\t}\n\n\tgetTitleLayout()\n\t{\n\t\tconst {userPath} = this.optionManager;\n\t\tconst escapeRegExp = (string) => string.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n\t\tlet title = this.fields.getTitle();\n\n\t\ttitle = (this.isCheckList() ? CheckListItem.getDefaultCheckListTitle(title) : title);\n\n\t\tthis.fields.getMembers().forEach(({id, nameFormatted, type}) => {\n\t\t\tconst regExp = new RegExp(escapeRegExp(nameFormatted), 'g');\n\t\t\tconst url = userPath.replace('#user_id#', id).replace('#USER_ID#', id);\n\t\t\ttitle = title.replace(regExp, CheckListItem.getMemberLinkLayout(type, nameFormatted, url));\n\t\t});\n\n\t\ttitle = title.replace(/(https?:\\/\\/[^\\s]+)/g, url => CheckListItem.getLinkLayout(url));\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${this.getTitleNodeClass()}\">\n\t\t\t\t${title}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tprocessMembersFromText()\n\t{\n\t\tconst membersToDelete = [];\n\n\t\tthis.fields.getMembers().forEach(({id, nameFormatted}) => {\n\t\t\tif (this.fields.getTitle().indexOf(nameFormatted) === -1)\n\t\t\t{\n\t\t\t\tmembersToDelete.push(id);\n\t\t\t}\n\t\t});\n\n\t\tmembersToDelete.forEach((id) => {\n\t\t\tthis.fields.removeMember(id);\n\t\t});\n\t}\n\n\tupdateIndexes()\n\t{\n\t\tthis.updateSortIndexes();\n\t\tthis.updateDisplaySortIndexes();\n\t}\n\n\tupdateSortIndexes()\n\t{\n\t\tlet sortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.fields.setSortIndex(sortIndex);\n\t\t\tsortIndex += 1;\n\t\t});\n\t}\n\n\tupdateDisplaySortIndexes()\n\t{\n\t\tconst parentSortIndex = (this.isCheckList() || this.isTaskRoot() ? '' : `${this.fields.getDisplaySortIndex()}.`);\n\t\tlet localSortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tlocalSortIndex += 1;\n\t\t\tconst newSortIndex = `${parentSortIndex}${localSortIndex}`;\n\n\t\t\tdescendant.fields.setDisplaySortIndex(newSortIndex);\n\n\t\t\tif (!descendant.isCheckList())\n\t\t\t{\n\t\t\t\tdescendant.container.querySelector('.tasks-checklist-item-number').innerText = newSortIndex;\n\t\t\t}\n\n\t\t\tdescendant.updateDisplaySortIndexes();\n\t\t});\n\t}\n\n\thandleTaskOptions()\n\t{\n\t\tconst {userId, showCompleted, showOnlyMine} = this.optionManager;\n\n\t\tthis.getRootNode().hideByCondition((item) => {\n\t\t\tconst isComplete = item.fields.getIsComplete();\n\t\t\tconst hasUserInMembers = item.fields.getMembers().has(userId.toString());\n\t\t\tlet condition;\n\n\t\t\tif (!showCompleted && showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = isComplete || !hasUserInMembers;\n\t\t\t}\n\t\t\telse if (!showCompleted)\n\t\t\t{\n\t\t\t\tcondition = isComplete;\n\t\t\t}\n\t\t\telse if (showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = !hasUserInMembers;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcondition = false;\n\t\t\t}\n\n\t\t\treturn condition;\n\t\t});\n\t}\n\n\thideByCondition(condition)\n\t{\n\t\tif (this.checkCanHide(condition))\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tdescendant.hideByCondition(condition);\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckCanHide(condition)\n\t{\n\t\tif (\n\t\t\tthis.isTaskRoot()\n\t\t\t|| this.updateMode\n\t\t\t|| Dom.hasClass(this.container, this.showClass)\n\t\t\t|| !condition(this)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet canHide = true;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (!condition(descendant))\n\t\t\t{\n\t\t\t\tcanHide = false;\n\t\t\t}\n\t\t\telse if (canHide)\n\t\t\t{\n\t\t\t\tcanHide = descendant.checkCanHide(condition);\n\t\t\t}\n\t\t});\n\n\t\treturn canHide;\n\t}\n\n\thide()\n\t{\n\t\tDom.hide(this.container);\n\t}\n\n\tshow()\n\t{\n\t\tDom.show(this.container);\n\t}\n\n\tcheckIsComplete()\n\t{\n\t\tlet isComplete;\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\tisComplete = false;\n\t\t}\n\t\telse if (this.isCheckList())\n\t\t{\n\t\t\tconst completedCount = this.countCompletedCount(true);\n\t\t\tconst totalCount = this.countTotalCount(true);\n\n\t\t\tisComplete = (completedCount === totalCount && totalCount > 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tisComplete = this.fields.getIsComplete();\n\t\t}\n\n\t\treturn isComplete;\n\t}\n\n\tcheckActiveUpdateExist()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tlet found = false;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === false)\n\t\t\t{\n\t\t\t\tfound = descendant.checkActiveUpdateExist();\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tdisableAllGroup()\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsSelected())\n\t\t\t{\n\t\t\t\tdescendant.toggleGroup();\n\t\t\t}\n\t\t});\n\t}\n\n\tdisableAllUpdateModes()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tthis.handleUpdateEnding();\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.disableAllUpdateModes();\n\t\t});\n\t}\n\n\trememberInputState()\n\t{\n\t\tthis.input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\t}\n\n\tclearInput(e)\n\t{\n\t\te.preventDefault();\n\n\t\tthis.container.querySelector(`#text_${this.getNodeId()}`).value = '';\n\t\tthis.retrieveFocus();\n\t}\n\n\tretrieveFocus()\n\t{\n\t\tif (this.input !== null && this.inputCursorPosition)\n\t\t{\n\t\t\tconst {start, end} = this.inputCursorPosition;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.setSelectionRange(start, end);\n\t\t\t}, 10);\n\t\t}\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-header-name tasks-checklist-header-name-edit-mode\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-after-icon ui-ctl-xs ui-ctl-no-padding ui-ctl-underline \n\t\t\t\t\t\t\t\ttasks-checklist-header-name-editor\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t\t   onkeydown=\"${this.onInputKeyDown.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.UI.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-inner tasks-checklist-item-new ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\">\n\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\">\n\t\t\t\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"></span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-after-icon ui-ctl-w100\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t\t   onkeydown=\"${this.onInputKeyDown.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\tconst node = nodeToPosition || item.getContainer();\n\t\tconst position = Dom.getPosition(node);\n\n\t\tif (!this.panel)\n\t\t{\n\t\t\tthis.panel = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-editor-panel-container\">\n\t\t\t\t\t${item.getPanelBodyLayout()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\n\t\t\tDom.append(this.panel, document.body);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.replace(this.panel.querySelector('.tasks-checklist-item-editor-panel'), item.getPanelBodyLayout());\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\t\t}\n\n\t\tif (!Dom.isShown(this.panel))\n\t\t{\n\t\t\tDom.show(this.panel);\n\t\t}\n\n\t\tif (\n\t\t\t(Dom.isShown(this.panel) && item.isCheckList() && !item.checkCanAddAccomplice())\n\t\t\t|| (position.left === 0 && position.right === 0 && position.width === 0)\n\t\t)\n\t\t{\n\t\t\tDom.hide(this.panel);\n\t\t}\n\t}\n\n\tenableUpdateMode()\n\t{\n\t\tconst viewModeLayout = this.getInnerContainer();\n\t\tconst updateModeLayout = this.getUpdateModeLayout();\n\n\t\tDom.addClass(viewModeLayout, this.hiddenClass);\n\t\tDom.insertBefore(updateModeLayout, viewModeLayout);\n\n\t\tthis.input = updateModeLayout.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.input.focus();\n\t\tthis.input.setSelectionRange(this.input.value.length, this.input.value.length);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\n\t\tEvent.bind(this.input, 'beforeinput', this.onInputBeforeInput.bind(this));\n\n\t\tif (this.input.value === '' || this.input.value.length === 0)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (Dom.isShown(this.input))\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}, 250);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t}\n\n\t\tthis.updateMode = true;\n\t}\n\n\tdisableUpdateMode()\n\t{\n\t\tconst currentInner = this.getInnerContainer();\n\t\tconst text = currentInner.querySelector(`#text_${this.getNodeId()}`).value.trim();\n\n\t\tthis.updateTitle(text);\n\t\tthis.processMembersFromText();\n\t\tthis.updateTitleNode();\n\n\t\tDom.removeClass(currentInner.nextElementSibling, this.hiddenClass);\n\t\tDom.remove(currentInner);\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tcheckCanDeleteOnUpdateEnding()\n\t{\n\t\treturn this.getDescendantsCount() === 0\n\t\t\t&& Object.keys(this.fields.getAttachments()).length === 0\n\t\t\t&& this.filesLoaderProgressBars.size === 0;\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tCheckListItem.addDangerToElement(input.parentElement);\n\n\t\t\t\tif (this.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\t\t}\n\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\ttoggleUpdateMode(e)\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tif (e.keyCode === CheckListItem.keyCodes.enter || e.keyCode === CheckListItem.keyCodes.tab)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding(!this.isCheckList());\n\t\t\t}\n\t\t\telse if (e.keyCode === CheckListItem.keyCodes.esc)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst rootNode = this.getRootNode();\n\n\t\t\trootNode.disableAllUpdateModes();\n\t\t\trootNode.disableAllGroup();\n\n\t\t\tif (!rootNode.checkActiveUpdateExist())\n\t\t\t{\n\t\t\t\tthis.enableUpdateMode();\n\t\t\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'toggleUpdateMode'});\n\t\t\t}\n\t\t}\n\t}\n\n\tonInputKeyDown(e)\n\t{\n\t\tif (this.isSelectorLoading)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (e.keyCode)\n\t\t{\n\t\t\tcase CheckListItem.keyCodes.esc:\n\t\t\tcase CheckListItem.keyCodes.enter:\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\tsetTimeout(() => this.toggleUpdateMode(e));\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.tab:\n\t\t\t{\n\t\t\t\tif (!this.isCheckList())\n\t\t\t\t{\n\t\t\t\t\t(e.shiftKey ? this.tabOut.bind(this) : this.tabIn.bind(this))();\n\t\t\t\t}\n\t\t\t\tthis.retrieveFocus();\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.up:\n\t\t\t{\n\t\t\t\tconst leftSiblingThrough = this.getLeftSiblingThrough();\n\t\t\t\tif (leftSiblingThrough && leftSiblingThrough !== this.getRootNode())\n\t\t\t\t{\n\t\t\t\t\tleftSiblingThrough.toggleUpdateMode(e);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.down:\n\t\t\t{\n\t\t\t\tconst rightSiblingThrough = this.getRightSiblingThrough();\n\t\t\t\tif (rightSiblingThrough)\n\t\t\t\t{\n\t\t\t\t\trightSiblingThrough.toggleUpdateMode(e);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\t// do nothing\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonInputBeforeInput(e)\n\t{\n\t\tif (this.isSelectorLoading)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (['+', '@'].includes(e.data))\n\t\t{\n\t\t\tthis.getMemberSelector(e, this.optionManager.defaultMemberSelectorType, true);\n\t\t}\n\t}\n\n\tonHeaderMouseDown(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseDown(e);\n\t\tthis.clickEventHandler.registerClickDoneCallback(this.onHeaderClickDone.bind(this, e));\n\t}\n\n\tonHeaderMouseUp(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseUp(e);\n\t}\n\n\tonHeaderClickDone(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'header'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tonInnerContainerMouseDown(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseDown(e);\n\t\tthis.clickEventHandler.registerClickDoneCallback(this.onInnerContainerClickDone.bind(this, e));\n\t}\n\n\tonInnerContainerMouseUp(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseUp(e);\n\t}\n\n\tonInnerContainerClickDone(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'item'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getCheckList().fields.getIsSelected())\n\t\t{\n\t\t\tthis.toggleSelect(e);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tgetImportantLayout()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-important\" onclick=\"${this.onImportantClick.bind(this)}\"></div>\n\t\t`;\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.remove(this.container.querySelector('.tasks-checklist-item-important'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.insertBefore(this.getImportantLayout(), this.container.querySelector('.tasks-checklist-item-description'));\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'toggleImportant'});\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tcheckSelectedItems()\n\t{\n\t\treturn this.getRootNode().getSelectedItems().length > 0;\n\t}\n\n\trunForEachSelectedItem(callback, reverse = false)\n\t{\n\t\tlet selectedItems = this.getRootNode().getSelectedItems();\n\n\t\tif (reverse)\n\t\t{\n\t\t\tselectedItems = [...selectedItems.reverse()];\n\t\t}\n\n\t\tselectedItems.forEach((item) => {\n\t\t\tcallback(item);\n\t\t});\n\t}\n\n\tonImportantClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.toggleImportant();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleImportant();\n\n\t\tconst panelImportantButton = e.target.closest('.tasks-checklist-item-editor-panel-btn-important');\n\t\tif (panelImportantButton)\n\t\t{\n\t\t\tDom.toggleClass(panelImportantButton, 'tasks-checklist-item-editor-panel-btn-important-selected');\n\t\t}\n\t}\n\n\tonCompleteAllButtonClick()\n\t{\n\t\tif (this.fields.getIsSelected() || this.updateMode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.completeAll();\n\t\tthis.runAjaxCompleteAll();\n\t}\n\n\tcompleteAll(): void\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (\n\t\t\t\tdescendant.checkCanToggle()\n\t\t\t\t&& !descendant.updateMode\n\t\t\t\t&& !descendant.fields.getIsComplete()\n\t\t\t)\n\t\t\t{\n\t\t\t\tdescendant.toggleComplete(false);\n\t\t\t}\n\t\t\tdescendant.completeAll();\n\t\t});\n\t}\n\n\trunAjaxCompleteAll(): void\n\t{\n\t\tconst {ajaxActions, entityId, entityType, stableTreeStructure} = this.optionManager;\n\n\t\tif (!ajaxActions || !ajaxActions.COMPLETE_ALL)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runAction(ajaxActions.COMPLETE_ALL, {\n\t\t\tdata: {\n\t\t\t\t[`${entityType.toLowerCase()}Id`]: entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tresponse.data.forEach(item => {\n\t\t\t\tthis.findById(item.id).updateStableTreeStructure(item.isComplete, stableTreeStructure, stableTreeStructure);\n\t\t\t});\n\t\t});\n\t}\n\n\tonCompleteButtonClick()\n\t{\n\t\tif (\n\t\t\tthis.getCheckList().fields.getIsSelected()\n\t\t\t|| this.updateMode\n\t\t\t|| !this.checkCanToggle()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleComplete();\n\t}\n\n\ttoggleComplete(runAjax = true)\n\t{\n\t\tconst isComplete = this.fields.getIsComplete();\n\n\t\tthis.fields.setIsComplete(!isComplete);\n\t\tthis.getParent().updateCounts();\n\t\tthis.getParent().updateProgress();\n\n\t\tDom.toggleClass(this.getInnerContainer(), this.checkedClass);\n\n\t\tthis.handleCheckListChanges();\n\t\tthis.handleTaskOptions();\n\n\t\tif (runAjax)\n\t\t{\n\t\t\tthis.runAjaxToggleComplete();\n\t\t}\n\t}\n\n\trunAjaxToggleComplete()\n\t{\n\t\tconst id = this.fields.getId();\n\n\t\tif (!id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {};\n\t\tconst {ajaxActions, entityId, entityType, stableTreeStructure} = this.optionManager;\n\t\tconst actionName = (this.fields.getIsComplete() ? ajaxActions.COMPLETE : ajaxActions.RENEW);\n\n\t\tdata[`${entityType.toLowerCase()}Id`] = entityId;\n\t\tdata.checkListItemId = id;\n\n\t\tBX.ajax.runAction(actionName, {data}).then((response) => {\n\t\t\tconst {isComplete} = response.data.checkListItem;\n\t\t\tthis.updateStableTreeStructure(isComplete, stableTreeStructure, stableTreeStructure);\n\t\t});\n\t}\n\n\tupdateStableTreeStructure(isComplete, item, parent)\n\t{\n\t\tif (this.fields.getId() === item.FIELDS.id)\n\t\t{\n\t\t\titem.FIELDS.isComplete = isComplete;\n\t\t\tparent.FIELDS.completedCount += (isComplete ? 1 : -1);\n\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.updateStableTreeStructure(isComplete, descendant, item);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tunselectAll()\n\t{\n\t\tconst checkBox = this.container.querySelector(`#select_${this.getNodeId()}`);\n\n\t\tif (checkBox && checkBox.checked === true)\n\t\t{\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tcheckBox.checked = false;\n\t\t\tDom.removeClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.unselectAll();\n\t\t});\n\t}\n\n\tgetSelected()\n\t{\n\t\tlet selected = [];\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tselected.push(this);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tselected = [...selected, ...descendant.getSelected()];\n\t\t});\n\n\t\treturn selected;\n\t}\n\n\tgetSelectedItems()\n\t{\n\t\treturn this.getSelected().filter(item => !item.isCheckList() && !item.isTaskRoot());\n\t}\n\n\tonSelectCheckboxClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\te.target.checked = false;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleSelect();\n\t}\n\n\ttoggleSelect()\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = false;\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(rootNode.panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = true;\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\t\t}\n\n\t\tDom.toggleClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t}\n\n\tonGroupButtonClick()\n\t{\n\t\tif (!this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\tthis.toggleGroup();\n\t\t}\n\t}\n\n\ttoggleGroup()\n\t{\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.unselectAll();\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\tif (this.fields.getIsCollapse())\n\t\t\t{\n\t\t\t\tthis.toggleCollapse();\n\t\t\t}\n\t\t}\n\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-collapse');\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-expand');\n\t}\n\n\tonCollapseButtonClick()\n\t{\n\t\tif (this.collapseFreezed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleCollapse();\n\t}\n\n\ttoggleCollapse()\n\t{\n\t\tthis.collapseFreezed = true;\n\n\t\tconst wrapperList = this.container.querySelector(`.${this.wrapperClass}`);\n\t\tconst wrapperListHeight = `${Dom.getPosition(wrapperList).height}px`;\n\n\t\tif (!Dom.hasClass(this.container, this.collapseClass))\n\t\t{\n\t\t\tthis.fields.setIsCollapse(true);\n\n\t\t\twrapperList.style.overflow = 'hidden';\n\t\t\twrapperList.style.height = wrapperListHeight;\n\t\t\tsetTimeout(() => { wrapperList.style.height = 0; }, 0);\n\n\t\t\tDom.addClass(this.container, this.collapseClass);\n\n\t\t\tthis.collapseFreezed = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsCollapse(false);\n\n\t\t\twrapperList.style.height = 0;\n\t\t\twrapperList.style.height = `${wrapperList.scrollHeight}px`;\n\n\t\t\tconst setAutoHeight = () => {\n\t\t\t\twrapperList.style.height = 'auto';\n\t\t\t\tBX.unbind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\t\tthis.collapseFreezed = false;\n\t\t\t};\n\t\t\tBX.bind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\tDom.removeClass(this.container, this.collapseClass);\n\t\t}\n\t}\n\n\ttoggleEmpty()\n\t{\n\t\tDom.toggleClass(this.container, 'tasks-checklist-empty');\n\t}\n\n\thandleCheckListIsComplete()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsComplete = checkList.checkIsComplete();\n\n\t\tcheckList.fields.setIsComplete(checkListIsComplete);\n\n\t\tif (\n\t\t\tcheckListIsComplete\n\t\t\t&& !Dom.hasClass(checkList.container, 'tasks-checklist-collapse')\n\t\t\t&& this.collapseOnCompleteAll()\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleCollapse();\n\t\t}\n\t}\n\n\thandleCheckListIsEmpty()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsEmpty = checkList.getDescendantsCount() === 0;\n\n\t\tif (\n\t\t\t(checkListIsEmpty && !Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t\t|| (!checkListIsEmpty && Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleEmpty();\n\t\t}\n\t}\n\n\thandleCheckListChanges()\n\t{\n\t\tthis.handleCheckListIsComplete();\n\t\tthis.handleCheckListIsEmpty();\n\t}\n\n\tcheckSkipUpdate(e, area)\n\t{\n\t\treturn this.skipUpdateClasses[area]\n\t\t\t&& this.skipUpdateClasses[area].find(item => e.target.closest(item));\n\t}\n\n\tshowCompleteAllButton()\n\t{\n\t\treturn this.optionManager.getShowCompleteAllButton();\n\t}\n\n\tcollapseOnCompleteAll()\n\t{\n\t\treturn this.optionManager.getCollapseOnCompleteAll();\n\t}\n\n\tcheckCanAdd()\n\t{\n\t\treturn this.optionManager.getCanAdd();\n\t}\n\n\tcheckCanAddAccomplice()\n\t{\n\t\treturn this.optionManager.getCanAddAccomplice();\n\t}\n\n\tcheckCanUpdate()\n\t{\n\t\treturn this.action.canUpdate;\n\t}\n\n\tcheckCanRemove()\n\t{\n\t\treturn this.action.canRemove;\n\t}\n\n\tcheckCanToggle()\n\t{\n\t\treturn this.action.canToggle;\n\t}\n\n\tcheckCanDrag()\n\t{\n\t\treturn this.action.canDrag;\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn (this.isCheckList() ? 'tasks-checklist-header-name-text' : 'tasks-checklist-item-description-text');\n\t}\n\n\tgetTitleNodeContainer()\n\t{\n\t\treturn this.container.querySelector(`.${this.getTitleNodeClass()}`);\n\t}\n\n\tgetAttachmentsContainer()\n\t{\n\t\treturn this.container.querySelector(`#attachments_${this.getNodeId()}`);\n\t}\n\n\tgetSubItemsContainer()\n\t{\n\t\treturn this.container.querySelector(`#subItems_${this.getNodeId()}`);\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.tasks-checklist-header-name' : '.tasks-checklist-item-inner');\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this.container;\n\t}\n\n\tmove(item, position = 'bottom', action = 'move')\n\t{\n\t\tif (\n\t\t\tthis.getNodeId() === item.getNodeId()\n\t\t\t|| this.findChild(item.getNodeId()) !== null\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst oldParent = this.getParent();\n\t\tconst newParent = item.getParent();\n\n\t\toldParent.remove(this);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tnewParent.addBefore(this, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.addAfter(this, item);\n\t\t}\n\n\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tDom.insertBefore(this.container, item.container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.insertAfter(this.container, item.container);\n\t\t}\n\n\t\tthis.handleCheckListIsEmpty();\n\t\tthis.handleTaskOptions();\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action});\n\t}\n\n\tmakeChildOf(item, position = 'bottom', action = 'makeChildOf')\n\t{\n\t\tif (item.getDescendantsCount() > 0)\n\t\t{\n\t\t\tconst borderItems = {\n\t\t\t\ttop: item.getFirstDescendant(),\n\t\t\t\tbottom: item.getLastDescendant(),\n\t\t\t};\n\n\t\t\tthis.move(borderItems[position], position, action);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst oldParent = this.getParent();\n\t\t\tconst newParent = item;\n\n\t\t\toldParent.remove(this);\n\t\t\tnewParent.add(this);\n\n\t\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\t\tDom.append(this.container, newParent.getSubItemsContainer());\n\t\t\tDom.addClass(this.container, 'mobile-task-checklist-item-wrapper-animate');\n\n\t\t\tthis.handleCheckListIsEmpty();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action});\n\t\t}\n\t}\n\n\ttabIn()\n\t{\n\t\tif (!this.isFirstDescendant())\n\t\t{\n\t\t\tthis.makeChildOf(this.getLeftSibling(), 'bottom', 'tabIn');\n\t\t}\n\t}\n\n\tonTabInClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabIn();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabIn();\n\t\tthis.retrieveFocus();\n\t}\n\n\ttabOut()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tif (parent.isCheckList())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.move(parent, 'bottom', 'tabOut');\n\t}\n\n\tonTabOutClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabOut();\n\t\t\t}, true);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabOut();\n\t\tthis.retrieveFocus();\n\t}\n\n\taddCheckListItem(item = null, dependsOn = null, position = 'after')\n\t{\n\t\tconst itemGet = item instanceof this.class;\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst newCheckListItem = item || new this.class();\n\t\t\tlet newCheckListItemLayout;\n\n\t\t\tif (dependsOn instanceof this.class)\n\t\t\t{\n\t\t\t\tif (position === 'before')\n\t\t\t\t{\n\t\t\t\t\tthis.addBefore(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertBefore(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t\telse if (position === 'after')\n\t\t\t\t{\n\t\t\t\t\tthis.addAfter(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertAfter(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.add(newCheckListItem);\n\n\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\tDom.append(newCheckListItemLayout, this.getSubItemsContainer());\n\t\t\t}\n\n\t\t\tthis.updateCounts();\n\t\t\tthis.updateIndexes();\n\n\t\t\tif (!this.isTaskRoot())\n\t\t\t{\n\t\t\t\tthis.updateProgress();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tif (!itemGet)\n\t\t\t\t{\n\t\t\t\t\tnewCheckListItem.toggleUpdateMode();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.height = `${newCheckListItemLayout.scrollHeight}px`;\n\t\t\t\tnewCheckListItemLayout.style.opacity = 1;\n\t\t\t}, 1);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.overflow = '';\n\t\t\t\tnewCheckListItemLayout.style.height = '';\n\t\t\t\tnewCheckListItemLayout.style.opacity = '';\n\n\t\t\t\tDom.removeClass(newCheckListItemLayout, this.showClass);\n\n\t\t\t\tif (!this.isTaskRoot() && !itemGet && newCheckListItem.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.class.smoothScroll(newCheckListItem.getContainer());\n\t\t\t\t}\n\n\t\t\t\tresolve(newCheckListItem);\n\t\t\t}, 250);\n\t\t});\n\t}\n\n\tonAddCheckListItemClick()\n\t{\n\t\tif (this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addCheckListItem();\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tNODE_ID: this.getNodeId(),\n\t\t\tPARENT_NODE_ID: this.getParent().getNodeId(),\n\t\t\tID: this.fields.getId(),\n\t\t\tCOPIED_ID: this.fields.getCopiedId(),\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: [],\n\t\t\tATTACHMENTS: {},\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\tconst {nameFormatted, type} = value;\n\t\t\titemRequestData.MEMBERS.push({\n\t\t\t\t[key]: {\n\t\t\t\t\tTYPE: type,\n\t\t\t\t\tNAME: Text.decode(nameFormatted),\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tconst attachments = this.fields.getAttachments();\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\titemRequestData.ATTACHMENTS[id] = attachments[id];\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tgetRequestData(inputData = null)\n\t{\n\t\tconst title = this.fields.getTitle();\n\t\tlet data = inputData || [];\n\n\t\tif (!this.isTaskRoot() && title !== '' && title.length > 0)\n\t\t{\n\t\t\tdata.push(this.getItemRequestData());\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdata = descendant.getRequestData(data);\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tappendRequestLayout()\n\t{\n\t\tif (!this.isTaskRoot())\n\t\t{\n\t\t\tconst nodeId = this.getNodeId();\n\t\t\tconst attachments = this.fields.getAttachments();\n\t\t\tconst prefix = `${this.optionManager.prefix}[${nodeId}]`;\n\n\t\t\tlet membersLayout = '';\n\t\t\tlet attachmentsLayout = '';\n\n\t\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_TYPE_${key}\" name=\"${prefix}[MEMBERS][${key}][TYPE]\" value=\"${value.type}\"/>`;\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_NAME_${key}\" name=\"${prefix}[MEMBERS][${key}][NAME]\" value=\"${value.nameFormatted}\"/>`;\n\t\t\t});\n\n\t\t\tObject.keys(attachments).forEach((id) => {\n\t\t\t\tattachmentsLayout += `<input type=\"hidden\" id=\"ATTACHMENTS_${id}\" name=\"${prefix}[ATTACHMENTS][${id}]\" value=\"${attachments[id]}\"/>`;\n\t\t\t});\n\n\t\t\tconst requestLayout = Tag.render`\n\t\t\t\t<div id=\"request_${nodeId}\">\n\t\t\t\t\t<input type=\"hidden\" id=\"NODE_ID\" name=\"${prefix}[NODE_ID]\" value=\"${nodeId}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_NODE_ID\" name=\"${prefix}[PARENT_NODE_ID]\" value=\"${this.getParent().getNodeId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"ID\" name=\"${prefix}[ID]\" value=\"${this.fields.getId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"COPIED_ID\" name=\"${prefix}[COPIED_ID]\" value=\"${this.fields.getCopiedId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_ID\" name=\"${prefix}[PARENT_ID]\" value=\"${this.fields.getParentId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TITLE\" name=\"${prefix}[TITLE]\" value=\"${this.fields.getTitle()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"SORT_INDEX\" name=\"${prefix}[SORT_INDEX]\" value=\"${this.fields.getSortIndex()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_COMPLETE\" name=\"${prefix}[IS_COMPLETE]\" value=\"${this.fields.getIsComplete()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_IMPORTANT\" name=\"${prefix}[IS_IMPORTANT]\" value=\"${this.fields.getIsImportant()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"MODIFY\" name=\"${prefix}[ACTION][MODIFY]\" value=\"${this.checkCanUpdate()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"REMOVE\" name=\"${prefix}[ACTION][REMOVE]\" value=\"${this.checkCanRemove()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TOGGLE\" name=\"${prefix}[ACTION][TOGGLE]\" value=\"${this.checkCanToggle()}\"/>\n\t\t\t\t\t${membersLayout}\n\t\t\t\t\t${attachmentsLayout}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.remove(this.container.querySelector(`#request_${nodeId}`));\n\t\t\tDom.append(requestLayout, this.container);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.appendRequestLayout();\n\t\t});\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst searchId = this.fields.getId() || this.fields.getCopiedId();\n\t\tconst {optionManager} = this;\n\t\tconst optionAttachments = optionManager.attachments;\n\t\tlet attachmentsLayout = '';\n\n\t\tif (optionAttachments && (searchId in optionAttachments))\n\t\t{\n\t\t\tconst attachments = Tag.render`${optionAttachments[searchId]}`;\n\t\t\tconst stableAttachments = this.getStableAttachments(optionManager.getStableTreeStructure());\n\t\t\tconst attachmentsToDelete = [];\n\n\t\t\tif (!attachments)\n\t\t\t{\n\t\t\t\treturn attachmentsLayout;\n\t\t\t}\n\n\t\t\tattachmentsLayout = attachments;\n\n\t\t\tif (!Array.isArray(attachments))\n\t\t\t{\n\t\t\t\tattachmentsLayout = [attachments];\n\t\t\t}\n\n\t\t\tObject.keys(attachmentsLayout).forEach((key) => {\n\t\t\t\tconst attachment = attachmentsLayout[key];\n\t\t\t\tconst fileId = attachment.getAttribute('data-bx-id');\n\t\t\t\tconst extension = CheckListItem.getFileExtension(attachment.getAttribute('data-bx-extension'));\n\t\t\t\tconst extensionClass = `ui-icon-file-${extension}`;\n\t\t\t\tconst iconContainer = attachment.querySelector(`#disk-attach-file-${fileId}`);\n\t\t\t\tconst deleteButton = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\"\n\t\t\t\t\t\t onclick=\"${this.onDeleteAttachmentClick.bind(this, fileId)}\"></div>\n\t\t\t\t`;\n\t\t\t\tconst has = Object.prototype.hasOwnProperty;\n\n\t\t\t\tif (!has.call(stableAttachments, fileId))\n\t\t\t\t{\n\t\t\t\t\tattachmentsToDelete.push(key);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (iconContainer && !Dom.hasClass(iconContainer, extensionClass))\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(iconContainer, extensionClass);\n\t\t\t\t}\n\n\t\t\t\tif (this.checkCanUpdate())\n\t\t\t\t{\n\t\t\t\t\tDom.append(deleteButton, attachment.querySelector('.tasks-checklist-item-attachment-file-cover'));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tattachmentsToDelete.sort((a, b) => b - a);\n\t\t\tattachmentsToDelete.forEach((id) => {\n\t\t\t\tattachmentsLayout.splice(id, 1);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setAttachments({});\n\t\t}\n\n\t\treturn attachmentsLayout;\n\t}\n\n\tgetStableAttachments(item)\n\t{\n\t\tconst fields = item.FIELDS;\n\t\tconst id = fields.id || fields.copiedId;\n\n\t\tif (id === this.fields.getId() || id === this.fields.getCopiedId())\n\t\t{\n\t\t\treturn fields.attachments;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.getStableAttachments(descendant);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tgetLoadedAttachmentLayout(attachment)\n\t{\n\t\tconst {id, name, viewUrl, size, ext} = attachment;\n\t\tlet img = '';\n\n\t\tif (viewUrl)\n\t\t{\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\" style=\"background-image: url(${viewUrl})\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(this, id)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst extension = CheckListItem.getFileExtension(ext);\n\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\">\n\t\t\t\t\t<div class=\"ui-icon ui-icon-file-${extension}\"><i></i></div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(this, id)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\" data-bx-id=\"${id}\">\n\t\t\t\t${img}\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonAttachmentsLoaderMenuItemClick()\n\t{\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\tgetAttachmentsLoaderLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst {prefix} = this.optionManager;\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t\t<div id=\"diskuf-selectdialog-${nodeId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t\t<div class=\"diskuf-files-block tasks-checklist-loader-files\">\n\t\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t\t<input type=\"hidden\" name=\"${prefix}[${nodeId}][UF_CHECKLIST_FILES][]\" value=\"\"/>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t\t<label for=\"file_loader_${nodeId}\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${nodeId}\" type=\"file\"\n\t\t\t\t\t\t\t\t   multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.OnFileUploadSuccess.bind(this));\n\t\tBX.addCustomEvent(filesChooser, 'DiskDLoadFormControllerInit', (uf) => {\n\t\t\tuf._onUploadProgress = this.onUploadProgress.bind(this);\n\t\t});\n\n\t\treturn filesChooser;\n\t}\n\n\tonUploadProgress(item, progress)\n\t{\n\t\tconst {id, name, size} = item;\n\t\tconst newProgress = Math.min(progress, 98);\n\n\t\tif (!this.filesLoaderProgressBars.has(id))\n\t\t{\n\t\t\tconst myProgress = new BX.UI.ProgressRound({\n\t\t\t\tid: `load_progress_${id}`,\n\t\t\t\tvalue: newProgress,\n\t\t\t\tmaxValue: 100,\n\t\t\t\twidth: 69,\n\t\t\t\tlineSize: 5,\n\t\t\t\tfill: false,\n\t\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t\t\tstatusType: BX.UI.ProgressRound.Status.INCIRCLE,\n\t\t\t});\n\t\t\tconst filePreview = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\">\n\t\t\t\t\t${myProgress.getContainer()}\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.filesLoaderProgressBars.set(id, myProgress);\n\t\t\tDom.append(filePreview, this.getAttachmentsContainer());\n\t\t}\n\n\t\tif (!item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = 5;\n\t\t}\n\n\t\tif (newProgress > item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = Math.ceil(newProgress);\n\t\t\titem.progressBarWidth = item.progressBarWidth > 100 ? 100 : item.progressBarWidth;\n\n\t\t\tif (this.filesLoaderProgressBars.has(id))\n\t\t\t{\n\t\t\t\tthis.filesLoaderProgressBars.get(id).update(item.progressBarWidth);\n\t\t\t}\n\t\t}\n\t}\n\n\tOnFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst attachmentId = fileResult.element_id.toString();\n\t\tconst attachment = {\n\t\t\tid: attachmentId,\n\t\t\tname: fileResult.element_name,\n\t\t\tviewUrl: fileResult.element_url,\n\t\t\tsize: uploaderFile.size,\n\t\t\text: uploaderFile.ext,\n\t\t};\n\n\t\tthis.fields.addAttachments({[attachmentId]: attachmentId});\n\t\tthis.filesLoaderProgressBars.delete(uploaderFile.id);\n\n\t\tconst attachmentProgress = this.getAttachmentsContainer().querySelector(`#disk-attach-${uploaderFile.id}`);\n\t\tconst attachmentLayout = this.getLoadedAttachmentLayout(attachment);\n\n\t\tif (attachmentProgress)\n\t\t{\n\t\t\tDom.replace(attachmentProgress, attachmentLayout);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(attachmentLayout, this.getAttachmentsContainer());\n\t\t}\n\n\t\tconst id = this.fields.getId();\n\t\tconst optionAttachments = this.optionManager.attachments;\n\n\t\tif (optionAttachments)\n\t\t{\n\t\t\tif (id in optionAttachments)\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] += attachmentLayout.outerHTML;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] = attachmentLayout.outerHTML;\n\t\t\t}\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'fileUpload'});\n\t}\n\n\tgetTaskRootLayout(children)\n\t{\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-task-root\">\n\t\t\t\t<div id=\"subItems_${this.getNodeId()}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst value = this.fields.getCompletedCount();\n\t\tconst maxValue = this.fields.getTotalCount();\n\t\tconst layouts = {\n\t\t\tlistActionsPanel: Tag.render`<div class=\"tasks-checklist-items-list-actions droppable\"></div>`,\n\t\t\tcompleteAllButton: Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-action-complete-all-btn\" onclick=\"${this.onCompleteAllButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_COMPLETE_ALL')}\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tgroupButton: '',\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-wrapper-dragndrop\"></div>`,\n\t\t};\n\n\t\tif (this.checkCanAdd())\n\t\t{\n\t\t\tconst addButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-add-btn\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tconst groupButton = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-action-group-btn\" onclick=\"${this.onGroupButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_GROUP_ACTIONS')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.append(addButtonLayout, layouts.listActionsPanel);\n\t\t\tlayouts.groupButton = groupButton;\n\t\t}\n\n\t\tif (this.checkCanRemove())\n\t\t{\n\t\t\tconst removeButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-remove-btn\" onclick=\"${this.onDeleteClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_DELETE_CHECKLIST')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tDom.append(removeButtonLayout, layouts.listActionsPanel);\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tif (!this.showCompleteAllButton())\n\t\t{\n\t\t\tlayouts.completeAllButton = '';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressBar({\n\t\t\tvalue,\n\t\t\tmaxValue,\n\t\t\tsize: BX.UI.ProgressBar.Size.MEDIUM,\n\t\t\ttextAfter: CheckListItem.getProgressText(value, maxValue),\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-wrapper tasks-checklist-item-group-editor-collapse\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-header-wrapper droppable\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-header-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-header-inner\">\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name\"\n\t\t\t\t\t\t\t\t onmousedown=\"${this.onHeaderMouseDown.bind(this)}\"\n\t\t\t\t\t\t\t\t onmouseup=\"${this.onHeaderMouseUp.bind(this)}\">\n\t\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name-edit-btn\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress-block\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-header-actions\">\n\t\t\t\t\t\t${layouts.completeAllButton}\n\t\t\t\t\t\t${layouts.groupButton}\n\t\t\t\t\t\t<div class=\"tasks-checklist-action-collapse-btn collapsed\" onclick=\"${this.onCollapseButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-items-wrapper\">\n\t\t\t\t\t<div class=\"tasks-checklist-items-list\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${layouts.listActionsPanel}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst layouts = {\n\t\t\tdeleteButton: Tag.render`<button class=\"tasks-checklist-item-remove\" onclick=\"${this.onDeleteClick.bind(this)}\"></button>`,\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-item-dragndrop\"></div>`,\n\t\t\tattachments: this.getAttachmentsLayout(),\n\t\t};\n\n\t\tif (!this.checkCanRemove())\n\t\t{\n\t\t\tlayouts.deleteButton = '';\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-item-inner droppable ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\"\n\t\t\t\t\t onmousedown=\"${this.onInnerContainerMouseDown.bind(this)}\" onmouseup=\"${this.onInnerContainerMouseUp.bind(this)}\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"></span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.fields.getIsImportant() ? this.getImportantLayout() : ''}\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-description\">\n\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-additional-block\">\n\t\t\t\t\t\t${layouts.deleteButton}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-actions-block\">\n\t\t\t\t\t\t<input class=\"tasks-checklist-item-group-checkbox\" id=\"select_${nodeId}\" type=\"checkbox\"\n\t\t\t\t\t\t\t   onclick=\"${this.onSelectCheckboxClick.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-list\" id=\"attachments_${nodeId}\">\n\t\t\t\t\t\t${layouts.attachments}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-sublist-items-wrapper\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetLayout()\n\t{\n\t\tconst children = [];\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tchildren.push(descendant.getLayout());\n\t\t});\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\treturn this.getTaskRootLayout(children);\n\t\t}\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tconst checkListLayout = this.getCheckListLayout(children);\n\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\treturn checkListLayout;\n\t\t}\n\n\t\treturn this.getCheckListItemLayout(children);\n\t}\n}\n\nclass MobileCheckListItem extends CheckListItem\n{\n\tclass = MobileCheckListItem;\n\n\tcheckedClass = 'mobile-task-checklist-item-checked';\n\thiddenClass = 'mobile-task-checklist-item-hidden';\n\tcollapseClass = 'mobile-task-checklist-section-collapse';\n\twrapperClass = 'mobile-task-checklist-wrapper';\n\n\tshowClass = 'mobile-checklist-item-show';\n\thideClass = 'mobile-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.mobile-task-checklist-item-checker',\n\t\t\t'.mobile-task-checklist-item-param',\n\t\t\t'.mobile-task-checklist-item-controls',\n\t\t],\n\t};\n\n\tstatic addDangerToElement(element)\n\t{\n\t\tconst dangerClass = 'mobile-task-checklist-error';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: {},\n\t\t\tATTACHMENTS: this.fields.getAttachments() || {},\n\t\t};\n\t\tconst membersTypes = {\n\t\t\taccomplice: 'A',\n\t\t\tauditor: 'U',\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\titemRequestData.MEMBERS[key] = {TYPE: membersTypes[value.type]};\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tonChecklistAjaxError()\n\t{\n\t\tBXMobileApp.Events.postToComponent('onChecklistAjaxError', {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\ttaskGuid: this.optionManager.taskGuid,\n\t\t}, 'tasks.view');\n\t}\n\n\tsendAddAjaxAction()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst fields = this.getItemRequestData();\n\t\t\tconst parent = this.getParent();\n\n\t\t\tfields.PARENT_ID = parent.fields.getId() || (parent.isTaskRoot() ? 0 : null);\n\n\n\t\t\tBX.ajax.runAction('tasks.task.checklist.add', {\n\t\t\t\tdata: {\n\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\tfields,\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tif (response.status === 'success')\n\t\t\t\t{\n\t\t\t\t\tconst {checkListItem} = response.data;\n\t\t\t\t\tthis.fields.setId(checkListItem.id);\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t}).catch(() => {\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\t}\n\n\tsendUpdateAjaxAction(fields, onFailCallback = null)\n\t{\n\t\tconst onFailFunction = onFailCallback || this.onChecklistAjaxError.bind(this);\n\n\t\tBX.ajax.runAction('tasks.task.checklist.update', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tfields,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tonFailFunction();\n\t\t\t}\n\t\t}).catch(() => onFailFunction());\n\t}\n\n\tsendRemoveAjaxAction()\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.delete', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tsendMembersAddAjaxAction(member, focusInput)\n\t{\n\t\tconst map = {\n\t\t\tauditor: {\n\t\t\t\tactionName: 'addAuditors',\n\t\t\t\tparamName: 'auditorsIds',\n\t\t\t\tletter: 'U',\n\t\t\t},\n\t\t\taccomplice: {\n\t\t\t\tactionName: 'addAccomplices',\n\t\t\t\tparamName: 'accomplicesIds',\n\t\t\t\tletter: 'A',\n\t\t\t},\n\t\t};\n\t\tconst currentType = map[member.type];\n\n\t\tconst toChecklistAddAction = 'tasks.task.checklist.addMembers';\n\t\tconst toChecklistAddData = {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\tmembers: {[member.id]: currentType.letter},\n\t\t};\n\n\t\tBX.ajax.runAction(toChecklistAddAction, {data: toChecklistAddData}).then((toChecklistAddResponse) => {\n\t\t\tif (toChecklistAddResponse.status === 'success')\n\t\t\t{\n\t\t\t\tif (focusInput)\n\t\t\t\t{\n\t\t\t\t\tthis.toggleUpdateMode();\n\t\t\t\t}\n\n\t\t\t\tBX.ajax.runAction(`tasks.task.${currentType.actionName}`, {data: {\n\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\t[currentType.paramName]: [member.id],\n\t\t\t\t}});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.fields.removeMember(member.id);\n\t\t\t}\n\t\t}).catch(() => this.fields.removeMember(member.id));\n\t}\n\n\tsendMoveAfterAjaxAction(afterItem)\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.moveAfter', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tafterItemId: afterItem.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tgetPopupMenuItems()\n\t{\n\t\tconst locPrefix = 'TASKS_CHECKLIST_MOBILE_POPUP_MENU_';\n\t\tconst popupMenuItems = [];\n\t\tconst popupMenuItemsBuildMap = {\n\t\t\tchecklist: {\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\trename: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}RENAME`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-rename.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t\tchecklistItem: {\n\t\t\t\taddFile: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_FILE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-file.png',\n\t\t\t\t},\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\ttabIn: {\n\t\t\t\t\tcondition: this.checkCanTabIn.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_IN`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-in.png',\n\t\t\t\t},\n\t\t\t\ttabOut: {\n\t\t\t\t\tcondition: this.checkCanTabOut.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_OUT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-out.png',\n\t\t\t\t},\n\t\t\t\timportant: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}IMPORTANT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-important.png',\n\t\t\t\t},\n\t\t\t\ttoAnotherChecklist: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TO_ANOTHER_CHECKLIST`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-to-another-checklist.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tconst type = (this.isCheckList() ? 'checklist' : 'checklistItem');\n\n\t\tObject.keys(popupMenuItemsBuildMap[type]).forEach((id) => {\n\t\t\tconst {sectionCode, title, iconUrl, condition} = popupMenuItemsBuildMap[type][id];\n\t\t\tpopupMenuItems.push({id, sectionCode, title, iconUrl, disable: !condition()});\n\t\t});\n\n\t\treturn popupMenuItems;\n\t}\n\n\tgetPopupChecklistsList()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\t\tconst popupChecklistsList = [];\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupChecklistsList.push({\n\t\t\t\tid: descendant.getNodeId(),\n\t\t\t\ttitle: Text.decode(descendant.fields.getTitle()),\n\t\t\t\tsectionCode: '0',\n\t\t\t});\n\t\t});\n\t\tpopupChecklistsList.push({\n\t\t\tid: 'newChecklist',\n\t\t\ttitle: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tsectionCode: '0',\n\t\t});\n\n\t\treturn popupChecklistsList;\n\t}\n\n\tonMemberSelectedEvent(eventData)\n\t{\n\t\tconst {nodeId, member, position, focusInput} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst title = node.fields.getTitle();\n\t\tlet newTitle = '';\n\n\t\tmember.nameFormatted = Text.encode(member.nameFormatted);\n\n\t\tif (focusInput)\n\t\t{\n\t\t\tconst start = position || 0;\n\t\t\tconst startSpace = ((start === 0 || start - 1 === 0 || title.charAt(start - 2) === ' ') ? '' : ' ');\n\t\t\tconst endSpace = (title.charAt(start - 1) === ' ' ? '' : ' ');\n\t\t\tconst newInputText = `${title.slice(0, start - 1)}${startSpace}${member.nameFormatted}${endSpace}`;\n\t\t\tnewTitle = `${newInputText}${title.slice(start)}`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst space = (title.slice(-1) === ' ' ? '' : ' ');\n\t\t\tnewTitle = `${title}${space}${member.nameFormatted}`;\n\t\t}\n\n\t\tnode.fields.addMember(member);\n\t\tnode.updateTitle(Text.decode(newTitle));\n\t\tnode.updateTitleNode();\n\n\t\tif (!this.checkEditMode())\n\t\t{\n\t\t\tnode.sendUpdateAjaxAction({TITLE: Text.decode(node.fields.getTitle())});\n\t\t\tnode.sendMembersAddAjaxAction(member, focusInput);\n\t\t}\n\t\telse if (focusInput)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonAddAttachmentEvent(eventData)\n\t{\n\t\tconst {nodeId, attachment} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tconst key = Object.keys(attachment)[0];\n\t\t\tconst value = Object.values(attachment)[0];\n\n\t\t\tnode.fields.addAttachments({[`n${key}`]: value});\n\t\t}\n\t}\n\n\tonRemoveAttachmentEvent(eventData)\n\t{\n\t\tconst {nodeId, attachmentId} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.fields.removeAttachment(attachmentId);\n\t\t\tnode.fields.removeAttachment(`n${attachmentId}`);\n\t\t}\n\t}\n\n\tgetFakeAttachmentsCount(filesToRemove, filesToAdd)\n\t{\n\t\tconst attachmentsIds = Object.keys(this.fields.getAttachments());\n\t\tconst countWithRemovable = attachmentsIds.filter(id => !filesToRemove.includes(id)).length;\n\n\t\treturn countWithRemovable + filesToAdd.length;\n\t}\n\n\tsetLayoutAttachmentsCount(attachmentsCount)\n\t{\n\t\tconst newAttachmentsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(this)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t\tDom.replace(this.getAttachmentsContainer(), newAttachmentsLayout);\n\t}\n\n\tupdateNodeAttachments(filesToRemove, filesToAdd, attachments = null)\n\t{\n\t\tif (attachments)\n\t\t{\n\t\t\tthis.fields.setAttachments(attachments);\n\t\t}\n\n\t\tconst fakeAttachmentsCount = this.getFakeAttachmentsCount(filesToRemove, filesToAdd);\n\t\tthis.setLayoutAttachmentsCount(fakeAttachmentsCount);\n\t}\n\n\tonAttachFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, attachments, checkListItemId} = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonRemoveFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, attachments} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonFakeAttachFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, checkListItemId} = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonFakeRemoveFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonRenameEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonRemoveEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tif (!this.checkEditMode() && node.fields.getId())\n\t\t\t{\n\t\t\t\tnode.sendRemoveAjaxAction();\n\t\t\t}\n\t\t\tnode.deleteAction(false);\n\t\t\tnode.getParent().updateIndexes();\n\t\t\tnode.handleCheckListChanges();\n\t\t}\n\t}\n\n\tonTabInEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabIn())\n\t\t{\n\t\t\tnode.tabIn();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst fields = {\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t};\n\t\t\t\t\tconst onFailCallback = () => { node.tabOut(); };\n\n\t\t\t\t\tnode.sendUpdateAjaxAction(fields, onFailCallback);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonTabOutEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabOut())\n\t\t{\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnode.sendMoveAfterAjaxAction(node.getParent());\n\t\t\t}\n\t\t\tnode.tabOut();\n\t\t}\n\t}\n\n\tonImportantEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleImportant();\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tconst onFailCallback = () => { node.toggleImportant(); };\n\t\t\t\tnode.sendUpdateAjaxAction({IS_IMPORTANT: node.fields.getIsImportant()}, onFailCallback);\n\t\t\t}\n\t\t}\n\t}\n\n\tonToAnotherCheckListEvent(eventData)\n\t{\n\t\tconst {nodeId, checklistId} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (checklistId === 'newChecklist')\n\t\t{\n\t\t\tnode.moveToNewCheckList(this.getDescendantsCount() + 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.makeChildOf(this.findChild(checklistId));\n\t\t\tnode.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnode.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetNativeComponentName()\n\t{\n\t\treturn (this.checkEditMode() ? 'tasks.edit' : 'tasks.view');\n\t}\n\n\tcheckEditMode()\n\t{\n\t\treturn this.optionManager.isEditMode();\n\t}\n\n\tcheckCanTabIn()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.isFirstDescendant();\n\t}\n\n\tcheckCanTabOut()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.getParent().isCheckList();\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\t// no editor panel in mobile version\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn this.isCheckList() ? 'mobile-task-checklist-head-title-text' : 'mobile-task-checklist-item-text';\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.mobile-task-checklist-head-title' : '.mobile-task-checklist-item');\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new MobileCheckListItem({TITLE: title});\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tthis.makeChildOf(newCheckList);\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnewCheckList.sendAddAjaxAction().then(() => {\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: this.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}, () => {});\n\t\t\t}\n\t\t});\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.removeClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.addClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tif (!this.checkEditMode() && this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tthis.sendRemoveAjaxAction();\n\t\t\t\t}\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tMobileCheckListItem.addDangerToElement(input.parentElement);\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tconst itemRequestData = this.getItemRequestData();\n\t\t\t\t\tconst members = itemRequestData.MEMBERS;\n\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tTITLE: itemRequestData.TITLE,\n\t\t\t\t\t\tMEMBERS: (Object.keys(members).length > 0 ? members : ''),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.sendAddAjaxAction().then(() => {}, () => {});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonInputBeforeInput(e)\n\t{\n\t\tconst memberSelectorCallKeys = ['@', '+'];\n\t\tconst position = CheckListItem.getInputSelection(this.input).start;\n\n\t\tif (memberSelectorCallKeys.includes(e.data) && this.checkCanAddAccomplice())\n\t\t{\n\t\t\tconst params = {\n\t\t\t\tposition,\n\t\t\t\tnodeId: this.getNodeId(),\n\t\t\t};\n\t\t\tBXMobileApp.Events.postToComponent(\n\t\t\t\t'onChecklistInputMemberSelectorCall',\n\t\t\t\tparams,\n\t\t\t\tthis.getNativeComponentName()\n\t\t\t);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tonInputKeyPressed(e)\n\t{\n\t\tif (e.keyCode === CheckListItem.keyCodes.enter)\n\t\t{\n\t\t\tthis.toggleUpdateMode(e);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tgetParamsForMobileEvent(type)\n\t{\n\t\tif (!['settings', 'attachments'].includes(type))\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tconst {entityId, entityType, taskGuid, diskOptions, mode} = this.optionManager;\n\t\tconst defaultParams = {\n\t\t\ttaskGuid,\n\t\t\ttaskId: entityId,\n\t\t\tnodeId: this.getNodeId(),\n\t\t\tdisk: diskOptions,\n\t\t\tajaxData: {\n\t\t\t\tentityId,\n\t\t\t\tmode,\n\t\t\t\tcheckListItemId: (this.checkEditMode() ? this.getNodeId() : this.fields.getId()),\n\t\t\t\tentityTypeId: `${entityType.toLowerCase()}Id`,\n\t\t\t},\n\t\t};\n\t\tlet localParams = {};\n\n\t\tif (type === 'settings')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tpopupChecklists: this.getPopupChecklistsList(),\n\t\t\t\tpopupMenuItems: this.getPopupMenuItems(),\n\t\t\t\tpopupMenuSections: [{id: '0', title: Text.decode(this.fields.getTitle())}],\n\t\t\t};\n\t\t}\n\t\telse if (type === 'attachments')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tattachmentsIds: Object.keys(this.fields.getAttachments()),\n\t\t\t\tcanUpdate: this.checkCanUpdate(),\n\t\t\t};\n\t\t}\n\n\t\treturn {...defaultParams, ...localParams};\n\t}\n\n\tonAttachmentsLayoutClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('attachments');\n\t\tBXMobileApp.Events.postToComponent('onChecklistAttachmentsClick', params, this.getNativeComponentName());\n\t}\n\n\tonSettingsClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('settings');\n\t\tBXMobileApp.Events.postToComponent('onChecklistSettingsClick', params, this.getNativeComponentName());\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"mobile-task-checklist-head-title mobile-task-checklist-item-edit-mode\">\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item mobile-task-checklist-item-edit-mode ${this.fields.getIsComplete() ? this.checkedClass : ''}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item-checker\">\n\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst attachmentsCount = Object.keys(this.fields.getAttachments()).length;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(this)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\t\tconst addButtonLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-add-button\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t<div class=\"mobile-task-checklist-add-text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\tstatusType: BX.UI.ProgressRound.Status.COUNTER,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-section\" id=\"${nodeId}\" data-role=\"mobile-task-checklist\">\n\t\t\t\t<div class=\"mobile-task-checklist-head\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-counter\">\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-counter-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-head-title\" onclick=\"${this.onHeaderClickDone.bind(this)}\">\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-visible\"\n\t\t\t\t\t\t\t onclick=\"${this.onCollapseButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-wrapper\">\n\t\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.checkCanAdd() ? addButtonLayout : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-wrapper\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item ${this.fields.getIsComplete() ? this.checkedClass : ''} ${this.fields.getIsImportant() ? 'mobile-task-checklist-item-important' : ''}\"\n\t\t\t\t\t onclick=\"${this.onInnerContainerClickDone.bind(this)}\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-checker\" id=\"progress_${nodeId}\"\n\t\t\t\t\t\t onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.getAttachmentsLayout()}\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n}\n\nexport {CheckListItem, MobileCheckListItem};"],"names":["TreeItem","Math","random","toString","substr","setNodeId","generateUniqueNodeId","setParent","parent","getParent","nodeId","CompositeTreeItem","descendants","item","position","push","splice","after","index","findIndex","descendant","add","before","length","getFirstDescendant","getLastDescendant","isFirstDescendant","parentDescendants","getDescendants","isLastDescendant","getRootNode","leftSiblingThrough","getLeftSibling","getDescendantsCount","getRightSibling","getNodeId","found","forEach","findChild","size","countTreeSize","CheckListItemFields","string","camelCaseString","Type","isString","toLowerCase","replace","match","chr","toUpperCase","snakeCaseString","fields","id","parentId","title","sortIndex","displaySortIndex","isComplete","isImportant","isSelected","isCollapse","completedCount","totalCount","members","Map","attachments","setFields","Object","keys","name","camelCaseName","snakeToCamelCase","indexOf","snakeCaseName","camelToSnakeCase","setMethod","bind","copiedId","Text","encode","types","A","U","clear","NAME","TYPE","set","nameFormatted","type","member","CheckListItem","element","dangerClass","Dom","hasClass","addClass","oldParent","newParent","updateCounts","updateProgress","updateIndexes","completed","total","replaces","progressText","Loc","getMessage","search","ext","fileExtension","input","start","end","normalizedValue","range","textInputRange","len","endRange","selectionStart","selectionEnd","document","selection","createRange","parentElement","value","createTextRange","moveToBookmark","getBookmark","collapse","compareEndPoints","moveStart","slice","split","moveEnd","defaultTitle","itemNumber","node","posFrom","BX","GetWindowScrollPos","scrollTop","posTo","pos","top","round","GetWindowInnerSize","innerHeight","toBottom","distance","abs","speed","step","posCurrent","timer","i","setTimeout","url","messageId","esc","enter","plus","atsign","tab","up","down","backspace","action","header","canUpdate","MODIFY","canRemove","REMOVE","canToggle","TOGGLE","canDrag","DRAG","panel","progress","filesLoaderPopup","filesLoaderProgressBars","updateMode","optionManager","clickEventHandler","isTaskRoot","getId","findById","recursively","getIsComplete","countCompletedCount","countTotalCount","setCompletedCount","setTotalCount","updateCompletedCount","updateTotalCount","getTotalCount","getCompletedCount","setMaxValue","update","isCheckList","updateProgressText","getProgressText","setTextAfter","layout","style","overflow","height","opacity","showClass","scrollHeight","hideClass","remove","setDefaultStyles","container","paddingTop","getSortIndex","addCheckListItem","showBalloon","getTitle","data","getNotificationBalloon","EventEmitter","emit","e","preventDefault","hide","checkSelectedItems","items","getSelectedItems","runForEachSelectedItem","setIsSelected","deleteAction","handleCheckListChanges","actions","content","events","click","event","balloon","close","restore","handleTaskOptions","image","avatar","Tag","render","loadExt","then","UI","Notification","Center","notify","rootNode","moveToNewCheckList","PopupMenuWindow","target","getToAnotherCheckListPopupItems","autoHide","closeByEsc","offsetLeft","offsetWidth","angle","onPopupClose","destroy","show","selectMode","popupMenuItems","toNewCheckListMenuItem","text","message","onclick","getMenuWindow","selectedItem","makeChildOf","unselectAll","delimiter","checkList","getCheckList","checkLists","filter","handleUpdateEnding","number","newCheckList","TITLE","space","newTitle","addMember","updateTitle","decode","updateTitleNode","inputText","mentioned","inputCursorPosition","startSpace","charAt","endSpace","newInputText","retrieveFocus","auditor","userData","prepareUserData","resultAuditor","notificationAction","notificationData","processMemberSelect","accomplice","resultAccomplice","user","customData","getCustomData","entityType","getEntityType","description","get","lastName","email","networkId","crmemail","extranet","network","memberType","checkCanAddAccomplice","typeFunctionMap","onSocNetSelectorAuditorSelected","onSocNetSelectorAccompliceSelected","typeFunction","isSelectorLoading","Runtime","loadExtension","exports","Dialog","dialog","targetNode","enableSearch","multiple","entities","options","inviteGuestLink","inviteEmployeeLink","emailUsers","networkUsers","isNetworkEnabled","extranetUsers","getData","getMemberSelector","prefix","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","PopupWindow","getAttachmentsLoaderLayout","bindElement","setBindElement","Disk","UF","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","querySelector","fileId","removeAttachment","getAttachmentsContainer","membersLayout","onAddAuditorClick","onAddAccompliceClick","attachmentButtonLayout","onUploadAttachmentClick","itemsActionButtonsLayout","onTabInClick","onTabOutClick","getIsImportant","onImportantClick","onToAnotherCheckListClick","onDeleteClick","separator","setTitle","getTitleNodeContainer","getTitleLayout","userPath","escapeRegExp","getDefaultCheckListTitle","getMembers","regExp","RegExp","getMemberLinkLayout","getLinkLayout","getTitleNodeClass","membersToDelete","removeMember","updateSortIndexes","updateDisplaySortIndexes","setSortIndex","parentSortIndex","getDisplaySortIndex","localSortIndex","newSortIndex","setDisplaySortIndex","innerText","userId","showCompleted","showOnlyMine","hideByCondition","hasUserInMembers","has","condition","checkCanHide","canHide","checkActiveUpdateExist","getIsSelected","toggleGroup","disableAllUpdateModes","getInputSelection","focus","setSelectionRange","onInputKeyDown","rememberInputState","clearInput","progressBarLayout","ProgressRound","maxValue","width","lineSize","fill","color","Color","PRIMARY","onCompleteButtonClick","getContainer","nodeToPosition","getPosition","getPanelBodyLayout","left","append","body","isShown","right","viewModeLayout","getInnerContainer","updateModeLayout","getUpdateModeLayout","hiddenClass","insertBefore","Event","onInputBeforeInput","showEditorPanel","currentInner","trim","processMembersFromText","removeClass","nextElementSibling","getAttachments","createNewItem","checkCanDeleteOnUpdateEnding","handleCheckListIsEmpty","addDangerToElement","disableUpdateMode","keyCode","keyCodes","disableAllGroup","enableUpdateMode","toggleUpdateMode","shiftKey","tabOut","tabIn","getLeftSiblingThrough","rightSiblingThrough","getRightSiblingThrough","includes","defaultMemberSelectorType","handleMouseDown","registerClickDoneCallback","onHeaderClickDone","handleMouseUp","checkCanUpdate","checkSkipUpdate","onInnerContainerClickDone","toggleSelect","setIsImportant","getImportantLayout","callback","reverse","selectedItems","toggleImportant","panelImportantButton","closest","toggleClass","completeAll","runAjaxCompleteAll","checkCanToggle","toggleComplete","ajaxActions","entityId","stableTreeStructure","COMPLETE_ALL","ajax","runAction","response","updateStableTreeStructure","runAjax","setIsComplete","checkedClass","runAjaxToggleComplete","actionName","COMPLETE","RENEW","checkListItemId","checkListItem","FIELDS","DESCENDANTS","checkBox","checked","selected","getSelected","getIsCollapse","toggleCollapse","collapseFreezed","wrapperList","wrapperClass","wrapperListHeight","collapseClass","setIsCollapse","setAutoHeight","unbind","checkListIsComplete","checkIsComplete","collapseOnCompleteAll","checkListIsEmpty","toggleEmpty","handleCheckListIsComplete","area","skipUpdateClasses","find","getShowCompleteAllButton","getCollapseOnCompleteAll","getCanAdd","getCanAddAccomplice","addBefore","addAfter","updateParents","insertAfter","borderItems","bottom","move","getSubItemsContainer","dependsOn","itemGet","Promise","resolve","newCheckListItem","newCheckListItemLayout","getLayout","smoothScroll","itemRequestData","NODE_ID","PARENT_NODE_ID","ID","COPIED_ID","getCopiedId","PARENT_ID","getParentId","SORT_INDEX","IS_COMPLETE","IS_IMPORTANT","MEMBERS","ATTACHMENTS","key","inputData","getItemRequestData","getRequestData","attachmentsLayout","requestLayout","checkCanRemove","appendRequestLayout","searchId","optionAttachments","stableAttachments","getStableAttachments","getStableTreeStructure","attachmentsToDelete","Array","isArray","attachment","getAttribute","extension","getFileExtension","extensionClass","iconContainer","deleteButton","onDeleteAttachmentClick","prototype","hasOwnProperty","call","sort","a","b","setAttachments","viewUrl","img","filesChooser","onAttachmentsLoaderMenuItemClick","addCustomEvent","OnFileUploadSuccess","uf","_onUploadProgress","onUploadProgress","newProgress","min","myProgress","statusType","Status","INCIRCLE","filePreview","progressBarWidth","ceil","fileResult","file","uploaderFile","attachmentId","element_id","element_name","element_url","addAttachments","attachmentProgress","attachmentLayout","getLoadedAttachmentLayout","outerHTML","children","layouts","listActionsPanel","completeAllButton","onCompleteAllButtonClick","groupButton","dndButton","checkCanAdd","addButtonLayout","onAddCheckListItemClick","onGroupButtonClick","removeButtonLayout","checkCanDrag","visibility","showCompleteAllButton","ProgressBar","Size","MEDIUM","textAfter","onHeaderMouseDown","onHeaderMouseUp","onCollapseButtonClick","getAttachmentsLayout","onInnerContainerMouseDown","onInnerContainerMouseUp","onSelectCheckboxClick","getTaskRootLayout","checkListLayout","getCheckListLayout","getCheckListItemLayout","MobileCheckListItem","membersTypes","BXMobileApp","Events","postToComponent","taskId","taskGuid","reject","status","setId","onChecklistAjaxError","onFailCallback","onFailFunction","focusInput","map","paramName","letter","currentType","toChecklistAddAction","toChecklistAddData","toChecklistAddResponse","afterItem","afterItemId","locPrefix","popupMenuItemsBuildMap","checklist","addAuditor","sectionCode","iconUrl","addAccomplice","rename","checklistItem","addFile","checkCanTabIn","checkCanTabOut","important","toAnotherChecklist","disable","popupChecklistsList","eventData","checkEditMode","sendUpdateAjaxAction","sendMembersAddAjaxAction","values","filesToRemove","filesToAdd","attachmentsIds","countWithRemovable","attachmentsCount","newAttachmentsLayout","onAttachmentsLayoutClick","fakeAttachmentsCount","getFakeAttachmentsCount","setLayoutAttachmentsCount","updateNodeAttachments","sendRemoveAjaxAction","sendMoveAfterAjaxAction","checklistId","isEditMode","sendAddAjaxAction","memberSelectorCallKeys","params","getNativeComponentName","diskOptions","mode","defaultParams","disk","ajaxData","entityTypeId","localParams","popupChecklists","getPopupChecklistsList","getPopupMenuItems","popupMenuSections","getParamsForMobileEvent","onInputKeyPressed","Mobile","Tasks","CheckList","settingsLayout","onSettingsClick","COUNTER"],"mappings":"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"}