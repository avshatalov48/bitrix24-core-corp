{"version":3,"file":"check-list-item.bundle.js","sources":["../src/tree-item.js","../src/composite-tree-item.js","../src/check-list-item-fields.js","../src/check-list-item.js"],"sourcesContent":["class TreeItem\n{\n\tstatic generateUniqueNodeId()\n\t{\n\t\treturn Math.random().toString(36).substr(2, 9);\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.setNodeId(TreeItem.generateUniqueNodeId());\n\t\tthis.setParent(null);\n\t}\n\n\tgetRootNode()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (parent.getParent() !== null)\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tgetNodeId()\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tsetNodeId(nodeId)\n\t{\n\t\tthis.nodeId = nodeId;\n\t}\n\n\tgetParent()\n\t{\n\t\treturn this.parent;\n\t}\n\n\tsetParent(parent)\n\t{\n\t\tthis.parent = parent;\n\t}\n}\n\nexport {TreeItem};","import {TreeItem} from './tree-item';\n\nclass CompositeTreeItem extends TreeItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.descendants = [];\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\titem.setParent(this);\n\n\t\tif (position === null)\n\t\t{\n\t\t\tthis.descendants.push(item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.descendants.splice(position, 0, item);\n\t\t}\n\t}\n\n\taddAfter(item, after)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === after);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index + 1);\n\t\t}\n\t}\n\n\taddBefore(item, before)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === before);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index);\n\t\t}\n\t}\n\n\tremove(item)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === item);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.descendants.splice(index, 1);\n\t\t}\n\t}\n\n\tgetDescendants()\n\t{\n\t\treturn this.descendants;\n\t}\n\n\tgetDescendantsCount()\n\t{\n\t\treturn this.descendants.length;\n\t}\n\n\tgetFirstDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[0];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetLastDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[this.descendants.length - 1];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tisFirstDescendant()\n\t{\n\t\treturn (this === this.getParent().getFirstDescendant());\n\t}\n\n\tisLastDescendant()\n\t{\n\t\treturn (this === this.getParent().getLastDescendant());\n\t}\n\n\tgetLeftSibling()\n\t{\n\t\tif (this.isFirstDescendant())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index - 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetRightSibling()\n\t{\n\t\tif (this.isLastDescendant())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index + 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetLeftSiblingThrough()\n\t{\n\t\tif (this === this.getRootNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.isFirstDescendant())\n\t\t{\n\t\t\treturn this.getParent();\n\t\t}\n\n\t\tlet leftSiblingThrough = this.getLeftSibling();\n\t\twhile (leftSiblingThrough && leftSiblingThrough.getDescendantsCount() > 0)\n\t\t{\n\t\t\tleftSiblingThrough = leftSiblingThrough.getLastDescendant();\n\t\t}\n\n\t\treturn leftSiblingThrough;\n\t}\n\n\tgetRightSiblingThrough()\n\t{\n\t\tif (this.getDescendantsCount() > 0)\n\t\t{\n\t\t\treturn this.getFirstDescendant();\n\t\t}\n\n\t\tif (!this.isLastDescendant())\n\t\t{\n\t\t\treturn this.getRightSibling();\n\t\t}\n\n\t\tlet parent = this;\n\t\twhile (parent.getParent() !== null && parent.isLastDescendant())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\tif (parent !== this.getRootNode())\n\t\t{\n\t\t\treturn parent.getRightSibling();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindChild(nodeId)\n\t{\n\t\tif (!nodeId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.getNodeId().toString() === nodeId.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findChild(nodeId);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountTreeSize()\n\t{\n\t\tlet size = this.getDescendantsCount();\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tsize += descendant.countTreeSize();\n\t\t});\n\n\t\treturn size;\n\t}\n\n\tgetTreeSize()\n\t{\n\t\treturn this.getRootNode().countTreeSize() + 1;\n\t}\n}\n\nexport {CompositeTreeItem};","import {Text, Type} from 'main.core';\n\nclass CheckListItemFields\n{\n\tstatic snakeToCamelCase(string)\n\t{\n\t\tlet camelCaseString = string;\n\n\t\tif (Type.isString(camelCaseString))\n\t\t{\n\t\t\tcamelCaseString = camelCaseString.toLowerCase();\n\t\t\tcamelCaseString = camelCaseString.replace(/[-_\\s]+(.)?/g, (match, chr) => (chr ? chr.toUpperCase() : ''));\n\n\t\t\treturn camelCaseString.substr(0, 1).toLowerCase() + camelCaseString.substr(1);\n\t\t}\n\n\t\treturn camelCaseString;\n\t}\n\n\tstatic camelToSnakeCase(string)\n\t{\n\t\tlet snakeCaseString = string;\n\n\t\tif (Type.isString(snakeCaseString))\n\t\t{\n\t\t\tsnakeCaseString = snakeCaseString.replace(/(.)([A-Z])/g, '$1_$2').toUpperCase();\n\t\t}\n\n\t\treturn snakeCaseString;\n\t}\n\n\tconstructor(fields)\n\t{\n\t\tthis.fields = [\n\t\t\t'id',\n\t\t\t'copiedId',\n\t\t\t'parentId',\n\t\t\t'title',\n\t\t\t'sortIndex',\n\t\t\t'displaySortIndex',\n\t\t\t'isComplete',\n\t\t\t'isImportant',\n\t\t\t'isSelected',\n\t\t\t'isCollapse',\n\t\t\t'completedCount',\n\t\t\t'totalCount',\n\t\t\t'members',\n\t\t\t'attachments',\n\t\t];\n\n\t\tthis.id = null;\n\t\tthis.parentId = null;\n\t\tthis.title = '';\n\t\tthis.sortIndex = 0;\n\t\tthis.displaySortIndex = '';\n\t\tthis.isComplete = false;\n\t\tthis.isImportant = false;\n\t\tthis.isSelected = false;\n\t\tthis.isCollapse = false;\n\t\tthis.completedCount = 0;\n\t\tthis.totalCount = 0;\n\t\tthis.members = new Map();\n\t\tthis.attachments = {};\n\n\t\tthis.setFields(fields);\n\t}\n\n\tsetFields(fields)\n\t{\n\t\tObject.keys(fields).forEach((name) => {\n\t\t\tconst camelCaseName = CheckListItemFields.snakeToCamelCase(name);\n\n\t\t\tif (this.fields.indexOf(name) !== -1)\n\t\t\t{\n\t\t\t\tconst snakeCaseName = CheckListItemFields.camelToSnakeCase(name);\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${snakeCaseName}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t\telse if (this.fields.indexOf(camelCaseName) !== -1)\n\t\t\t{\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${name}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\tgetCopiedId()\n\t{\n\t\treturn this.copiedId;\n\t}\n\n\tsetCopiedId(copiedId)\n\t{\n\t\tthis.copiedId = copiedId;\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetParentId(parentId)\n\t{\n\t\tthis.parentId = parentId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title)\n\t{\n\t\tthis.title = Text.encode(title);\n\t}\n\n\tgetSortIndex()\n\t{\n\t\treturn this.sortIndex;\n\t}\n\n\tsetSortIndex(sortIndex)\n\t{\n\t\tthis.sortIndex = sortIndex;\n\t}\n\n\tgetDisplaySortIndex()\n\t{\n\t\treturn this.displaySortIndex;\n\t}\n\n\tsetDisplaySortIndex(displaySortIndex)\n\t{\n\t\tthis.displaySortIndex = displaySortIndex;\n\t}\n\n\tgetIsComplete()\n\t{\n\t\treturn this.isComplete;\n\t}\n\n\tsetIsComplete(isComplete)\n\t{\n\t\tthis.isComplete = isComplete;\n\t}\n\n\tgetIsImportant()\n\t{\n\t\treturn this.isImportant;\n\t}\n\n\tsetIsImportant(isImportant)\n\t{\n\t\tthis.isImportant = isImportant;\n\t}\n\n\tgetIsSelected()\n\t{\n\t\treturn this.isSelected;\n\t}\n\n\tsetIsSelected(isSelected)\n\t{\n\t\tthis.isSelected = isSelected;\n\t}\n\n\tgetIsCollapse()\n\t{\n\t\treturn this.isCollapse;\n\t}\n\n\tsetIsCollapse(isCollapse)\n\t{\n\t\tthis.isCollapse = isCollapse;\n\t}\n\n\tgetCompletedCount()\n\t{\n\t\treturn this.completedCount;\n\t}\n\n\tsetCompletedCount(completedCount)\n\t{\n\t\tthis.completedCount = completedCount;\n\t}\n\n\tgetTotalCount()\n\t{\n\t\treturn this.totalCount;\n\t}\n\n\tsetTotalCount(totalCount)\n\t{\n\t\tthis.totalCount = totalCount;\n\t}\n\n\tgetMembers()\n\t{\n\t\treturn this.members;\n\t}\n\n\tsetMembers(members)\n\t{\n\t\tconst types = {\n\t\t\tA: 'accomplice',\n\t\t\tU: 'auditor',\n\t\t};\n\n\t\tthis.members.clear();\n\n\t\tObject.keys(members).forEach((id) => {\n\t\t\tconst { NAME, TYPE, IS_COLLABER } = members[id];\n\t\t\tthis.members.set(id, { id, nameFormatted: Text.encode(NAME), type: types[TYPE], isCollaber: IS_COLLABER });\n\t\t});\n\t}\n\n\taddMember(member)\n\t{\n\t\tthis.members.set(member.id, member);\n\t}\n\n\tremoveMember(id)\n\t{\n\t\tthis.members.delete(id);\n\t}\n\n\tgetAttachments()\n\t{\n\t\treturn this.attachments;\n\t}\n\n\tsetAttachments(attachments)\n\t{\n\t\tthis.attachments = attachments;\n\t}\n\n\taddAttachments(attachments)\n\t{\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\tthis.attachments[id] = attachments[id];\n\t\t});\n\t}\n\n\tremoveAttachment(id)\n\t{\n\t\tdelete this.attachments[id];\n\t}\n}\n\nexport {CheckListItemFields};","import 'ui.design-tokens';\nimport './css/check-list-item.css';\n\nimport { Dom, Event, Loc, Runtime, Tag, Text } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { CompositeTreeItem } from './composite-tree-item';\nimport { CheckListItemFields } from './check-list-item-fields';\n\nclass CheckListItem extends CompositeTreeItem\n{\n\tclass = CheckListItem;\n\n\tcheckedClass = 'tasks-checklist-item-solved';\n\thiddenClass = 'tasks-checklist-item-hidden';\n\tcollapseClass = 'tasks-checklist-collapse';\n\twrapperClass = 'tasks-checklist-items-wrapper';\n\n\tshowClass = 'tasks-checklist-item-show';\n\thideClass = 'tasks-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.tasks-checklist-item-important',\n\t\t\t'.tasks-checklist-item-dragndrop',\n\t\t\t'.tasks-checklist-item-group-checkbox',\n\t\t\t'.tasks-checklist-item-remove',\n\t\t\t'.tasks-checklist-item-flag-block',\n\t\t],\n\t};\n\n\tstatic addDangerToElement(element)\n\t{\n\t\tconst dangerClass = 'ui-ctl-danger';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tstatic updateParents(oldParent, newParent)\n\t{\n\t\tif (oldParent !== newParent)\n\t\t{\n\t\t\toldParent.updateCounts();\n\t\t\tnewParent.updateCounts();\n\n\t\t\toldParent.updateProgress();\n\t\t\tnewParent.updateProgress();\n\n\t\t\toldParent.updateIndexes();\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t}\n\n\tstatic getProgressText(completed, total)\n\t{\n\t\tconst replaces = {\n\t\t\t'#total#': total,\n\t\t\t'#completed#': completed,\n\t\t};\n\t\tlet progressText = Loc.getMessage('TASKS_CHECKLIST_PROGRESS_BAR_PROGRESS_TEXT');\n\n\t\tObject.keys(replaces).forEach((search) => {\n\t\t\tprogressText = progressText.replace(search, replaces[search]);\n\t\t});\n\n\t\treturn progressText;\n\t}\n\n\tstatic getFileExtension(ext)\n\t{\n\t\tlet fileExtension;\n\n\t\tswitch (ext)\n\t\t{\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'swf':\n\t\t\tcase 'wmv':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'txt':\n\t\t\t\tfileExtension = 'txt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'doc':\n\t\t\tcase 'docx':\n\t\t\t\tfileExtension = 'doc';\n\t\t\t\tbreak;\n\n\t\t\tcase 'xls':\n\t\t\tcase 'xlsx':\n\t\t\t\tfileExtension = 'xls';\n\t\t\t\tbreak;\n\n\t\t\tcase 'php':\n\t\t\t\tfileExtension = 'php';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pdf':\n\t\t\t\tfileExtension = 'pdf';\n\t\t\t\tbreak;\n\n\t\t\tcase 'ppt':\n\t\t\tcase 'pptx':\n\t\t\t\tfileExtension = 'ppt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rar':\n\t\t\t\tfileExtension = 'rar';\n\t\t\t\tbreak;\n\n\t\t\tcase 'zip':\n\t\t\t\tfileExtension = 'zip';\n\t\t\t\tbreak;\n\n\t\t\tcase 'set':\n\t\t\t\tfileExtension = 'set';\n\t\t\t\tbreak;\n\n\t\t\tcase 'mov':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'img':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\t\tfileExtension = 'img';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tfileExtension = 'empty';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn fileExtension;\n\t}\n\n\tstatic getInputSelection(input)\n\t{\n\t\tlet start = 0;\n\t\tlet end = 0;\n\t\tlet normalizedValue;\n\t\tlet range;\n\t\tlet textInputRange;\n\t\tlet len;\n\t\tlet endRange;\n\n\t\tif (typeof input.selectionStart === 'number' && typeof input.selectionEnd === 'number')\n\t\t{\n\t\t\tstart = input.selectionStart;\n\t\t\tend = input.selectionEnd;\n\t\t}\n\t\telse\n\t\t{\n\t\t\trange = document.selection.createRange();\n\n\t\t\tif (range && range.parentElement() === input)\n\t\t\t{\n\t\t\t\tlen = input.value.length;\n\t\t\t\tnormalizedValue = input.value.replace(/\\r\\n/g, '\\n');\n\n\t\t\t\t// Create a working TextRange that lives only in the input\n\t\t\t\ttextInputRange = input.createTextRange();\n\t\t\t\ttextInputRange.moveToBookmark(range.getBookmark());\n\n\t\t\t\t// Check if the start and end of the selection are at the very end\n\t\t\t\t// of the input, since moveStart/moveEnd doesn't return what we want\n\t\t\t\t// in those cases\n\t\t\t\tendRange = input.createTextRange();\n\t\t\t\tendRange.collapse(false);\n\n\t\t\t\tif (textInputRange.compareEndPoints('StartToEnd', endRange) > -1)\n\t\t\t\t{\n\t\t\t\t\tstart = len;\n\t\t\t\t\tend = len;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstart = -textInputRange.moveStart('character', -len);\n\t\t\t\t\tstart += normalizedValue.slice(0, start).split('\\n').length - 1;\n\n\t\t\t\t\tif (textInputRange.compareEndPoints('EndToEnd', endRange) > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tend = len;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tend = -textInputRange.moveEnd('character', -len);\n\t\t\t\t\t\tend += normalizedValue.slice(0, end).split('\\n').length - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn { start, end };\n\t}\n\n\tstatic getDefaultCheckListTitle(title)\n\t{\n\t\tlet defaultTitle = title;\n\n\t\tif (title.indexOf('BX_CHECKLIST') === 0)\n\t\t{\n\t\t\tif (title === 'BX_CHECKLIST')\n\t\t\t{\n\t\t\t\tdefaultTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_2');\n\t\t\t}\n\t\t\telse if (title.match(/BX_CHECKLIST_\\d+$/))\n\t\t\t{\n\t\t\t\tconst itemNumber = title.replace('BX_CHECKLIST_', '');\n\t\t\t\tdefaultTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_WITH_NUMBER').replace(\n\t\t\t\t\t'#ITEM_NUMBER#',\n\t\t\t\t\titemNumber,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn defaultTitle;\n\t}\n\n\tstatic smoothScroll(node)\n\t{\n\t\tconst posFrom = BX.GetWindowScrollPos().scrollTop;\n\t\tconst posTo = BX.pos(node).top - Math.round(BX.GetWindowInnerSize().innerHeight / 2);\n\t\tconst toBottom = posFrom < posTo;\n\t\tconst distance = Math.abs(posTo - posFrom);\n\t\tconst speed = (Math.round(distance / 100) > 20 ? 20 : Math.round(distance / 100));\n\t\tconst step = speed / 2;\n\n\t\tif (step <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet posCurrent = (toBottom ? posFrom + step : posFrom - step);\n\t\tlet timer = 0;\n\n\t\tif (toBottom)\n\t\t{\n\t\t\tfor (let i = posFrom; i < posTo; i += step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent += step;\n\t\t\t\tif (posCurrent > posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor (let i = posFrom; i > posTo; i -= step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent -= step;\n\t\t\t\tif (posCurrent < posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getMemberLinkLayout(type, name, url, isCollaber)\n\t{\n\t\tconst messageId = `TASKS_CHECKLIST_${type.toUpperCase()}_ICON_HINT`;\n\t\treturn `\n\t\t\t<span class=\"tasks-checklist-item-auditor\">\n\t\t\t\t<a class=\"tasks-checklist-item-${type}-icon\" title=\"${Loc.getMessage(messageId)}\"></a>\n\t\t\t\t<a href=\"${url}\" class=\"tasks-checklist-item-${type}-link ${isCollaber ? 'tasks-checklist-item-collaber' : ''}\">${name}</a>\n\t\t\t</span> \n\t\t`;\n\t}\n\n\tstatic getLinkLayout(url)\n\t{\n\t\treturn `<a class=\"tasks-checklist-item-link\" href=\"${url}\" target=\"_blank\">${url}</a>`;\n\t}\n\n\tstatic get keyCodes()\n\t{\n\t\treturn {\n\t\t\tesc: 27,\n\t\t\tenter: 13,\n\t\t\tplus: 43,\n\t\t\tatsign: 64,\n\t\t\ttab: 9,\n\t\t\tup: 38,\n\t\t\tdown: 40,\n\t\t\tbackspace: 8,\n\t\t};\n\t}\n\n\tconstructor(fields = {})\n\t{\n\t\tconst { action } = fields;\n\n\t\tsuper();\n\t\tthis.fields = new CheckListItemFields(fields);\n\t\tthis.action = {\n\t\t\tcanUpdate: (action && 'MODIFY' in action) ? action.MODIFY : true,\n\t\t\tcanRemove: (action && 'REMOVE' in action) ? action.REMOVE : true,\n\t\t\tcanToggle: (action && 'TOGGLE' in action) ? action.TOGGLE : true,\n\t\t\tcanDrag: (action && 'DRAG' in action) ? action.DRAG : true,\n\t\t};\n\n\t\tthis.input = null;\n\t\tthis.panel = null;\n\t\tthis.progress = null;\n\t\tthis.filesLoaderPopup = null;\n\t\tthis.filesLoaderProgressBars = new Map();\n\t\tthis.updateMode = false;\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\tsuper.add(item, position);\n\n\t\titem.optionManager = this.optionManager;\n\t\titem.clickEventHandler = this.clickEventHandler;\n\t}\n\n\tisTaskRoot()\n\t{\n\t\treturn this.getNodeId() === 0 && this.getParent() === null;\n\t}\n\n\tisCheckList()\n\t{\n\t\treturn !this.isTaskRoot() && this.getParent().isTaskRoot();\n\t}\n\n\tgetCheckList()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (!parent.getParent().isTaskRoot())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tfindById(id)\n\t{\n\t\tif (!id)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.fields.getId() && this.fields.getId().toString() === id.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findById(id);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountCompletedCount(recursively = false)\n\t{\n\t\tlet completedCount = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsComplete())\n\t\t\t{\n\t\t\t\tcompletedCount += 1;\n\t\t\t}\n\n\t\t\tif (recursively)\n\t\t\t{\n\t\t\t\tcompletedCount += descendant.countCompletedCount(recursively);\n\t\t\t}\n\t\t});\n\n\t\treturn completedCount;\n\t}\n\n\tcountTotalCount(recursively = false)\n\t{\n\t\tlet totalCount = 0;\n\n\t\tif (!recursively)\n\t\t{\n\t\t\ttotalCount = this.getDescendantsCount();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\ttotalCount += 1;\n\t\t\t\ttotalCount += descendant.countTotalCount(recursively);\n\t\t\t});\n\t\t}\n\n\t\treturn totalCount;\n\t}\n\n\tupdateCompletedCount()\n\t{\n\t\tconst completedCount = this.countCompletedCount();\n\t\tthis.fields.setCompletedCount(completedCount);\n\t}\n\n\tupdateTotalCount()\n\t{\n\t\tconst totalCount = this.countTotalCount();\n\t\tthis.fields.setTotalCount(totalCount);\n\t}\n\n\tupdateCounts()\n\t{\n\t\tthis.updateCompletedCount();\n\t\tthis.updateTotalCount();\n\t}\n\n\tupdateProgress()\n\t{\n\t\tif (this.progress === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst total = this.fields.getTotalCount();\n\t\tconst completed = this.fields.getCompletedCount();\n\n\t\tthis.progress.setMaxValue(total);\n\t\tthis.progress.update(completed);\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tthis.updateProgressText(completed, total);\n\t\t}\n\t}\n\n\tupdateProgressText(completed, total)\n\t{\n\t\tconst progressText = CheckListItem.getProgressText(completed, total);\n\t\tthis.progress.setTextAfter(progressText);\n\t}\n\n\tsetDefaultStyles(layout, action = 'add')\n\t{\n\t\tif (action === 'add')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = 0;\n\t\t\tlayout.style.opacity = 0;\n\n\t\t\tDom.addClass(layout, this.showClass);\n\t\t}\n\t\telse if (action === 'delete')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = `${layout.scrollHeight}px`;\n\t\t\tlayout.style.opacity = 1;\n\n\t\t\tDom.addClass(layout, this.hideClass);\n\t\t}\n\t}\n\n\tdelete()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tparent.remove(this);\n\t\tparent.updateCounts();\n\t\tparent.updateProgress();\n\n\t\tthis.setDefaultStyles(this.container, 'delete');\n\n\t\tsetTimeout(() => {\n\t\t\tthis.container.style.height = 0;\n\t\t\tthis.container.style.opacity = 0;\n\t\t\tthis.container.style.paddingTop = 0;\n\t\t}, 1);\n\n\t\tsetTimeout(() => {\n\t\t\tDom.remove(this.container);\n\t\t}, 250);\n\t}\n\n\trestore()\n\t{\n\t\tconst parent = this.getParent();\n\t\tconst position = this.fields.getSortIndex();\n\n\t\tif (position === 0)\n\t\t{\n\t\t\tif (parent.getDescendantsCount() > 0)\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this, parent.getFirstDescendant(), 'before');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparent.addCheckListItem(this, parent.getDescendants()[position - 1]);\n\t\t}\n\t}\n\n\tdeleteAction(showBalloon = true)\n\t{\n\t\tconst title = this.fields.getTitle();\n\n\t\tthis.delete();\n\n\t\tif (showBalloon && title.length > 0 && title !== '')\n\t\t{\n\t\t\tconst action = 'DELETE';\n\t\t\tconst data = {\n\t\t\t\ttype: this.isCheckList() ? 'CHECKLIST' : 'ITEM',\n\t\t\t};\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'delete' });\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tonDeleteClick(e)\n\t{\n\t\te.preventDefault();\n\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tconst items = this.getSelectedItems();\n\t\t\tconst action = 'DELETE_SELECTED';\n\t\t\tconst data = { items };\n\n\t\t\tthis.runForEachSelectedItem((item) => {\n\t\t\t\titem.fields.setIsSelected(false);\n\t\t\t\titem.deleteAction(false);\n\t\t\t});\n\n\t\t\titems.forEach((item) => {\n\t\t\t\titem.getParent().updateIndexes();\n\t\t\t\titem.handleCheckListChanges();\n\t\t\t});\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteAction();\n\t\tthis.getParent().updateIndexes();\n\n\t\tthis.handleCheckListChanges();\n\t}\n\n\tgetNotificationBalloon(action, data)\n\t{\n\t\tconst actions = [];\n\t\tlet content = '';\n\n\t\tswitch (action)\n\t\t{\n\t\t\tcase 'DELETE':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_${data.type}`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) => {\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tthis.restore();\n\t\t\t\t\t\t\tthis.handleCheckListChanges();\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'DELETE_SELECTED':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_ITEMS`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) => {\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tdata.items.forEach((item) => {\n\t\t\t\t\t\t\t\titem.restore();\n\t\t\t\t\t\t\t\titem.handleCheckListChanges();\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'AUDITOR_ADDED':\n\t\t\tcase 'ACCOMPLICE_ADDED':\n\t\t\t{\n\t\t\t\tlet image = '';\n\t\t\t\tif (data.avatar)\n\t\t\t\t{\n\t\t\t\t\timage = Tag.render`\n\t\t\t\t\t\t<img class=\"tasks-checklist-notification-balloon-avatar-img\" src=\"${encodeURI(data.avatar)}\" alt=\"\"/>\n\t\t\t\t\t`;\n\t\t\t\t}\n\t\t\t\tcontent = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-message-container\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-avatar\">\n\t\t\t\t\t\t\t${image}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"tasks-checklist-notification-balloon-message\">\n\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}`)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tBX.loadExt('ui.notification').then(() => {\n\t\t\tBX.UI.Notification.Center.notify({ content, actions });\n\t\t});\n\t}\n\n\tonToAnotherCheckListClick(e)\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (rootNode.getDescendantsCount() === 1)\n\t\t{\n\t\t\tthis.moveToNewCheckList(2);\n\t\t\treturn;\n\t\t}\n\n\t\tnew BX.PopupMenuWindow(\n\t\t\t'to-another-checklist',\n\t\t\te.target,\n\t\t\tthis.getToAnotherCheckListPopupItems(),\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 3,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t).show();\n\t}\n\n\tgetToAnotherCheckListPopupItems()\n\t{\n\t\tconst selectMode = this.checkSelectedItems();\n\t\tconst popupMenuItems = [];\n\t\tconst toNewCheckListMenuItem = {\n\t\t\ttext: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tonclick: (event, item) => {\n\t\t\t\titem.getMenuWindow().close();\n\t\t\t\tthis.moveToNewCheckList(this.getRootNode().getDescendantsCount() + 1);\n\t\t\t},\n\t\t};\n\n\t\tif (selectMode)\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tpopupMenuItems.push({\n\t\t\t\t\ttext: descendant.fields.getTitle(),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\titem.getMenuWindow().close();\n\n\t\t\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\t\t\tselectedItem.makeChildOf(descendant);\n\t\t\t\t\t\t\tdescendant.unselectAll();\n\n\t\t\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tpopupMenuItems.push({ delimiter: true });\n\t\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\t\treturn popupMenuItems;\n\t\t}\n\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupMenuItems.push({\n\t\t\t\ttext: descendant.fields.getTitle(),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\tthis.makeChildOf(descendant);\n\t\t\t\t\tthis.handleUpdateEnding();\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tpopupMenuItems.push({ delimiter: true });\n\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\treturn popupMenuItems;\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new CheckListItem({ TITLE: title });\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tif (this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\tselectedItem.makeChildOf(newCheckList);\n\t\t\t\t\tnewCheckList.unselectAll();\n\n\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.makeChildOf(newCheckList);\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessMemberSelect(member)\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tconst title = selectedItem.fields.getTitle();\n\t\t\t\tconst space = (title.slice(-1) === ' ' ? '' : ' ');\n\t\t\t\tconst newTitle = `${title}${space}${member.nameFormatted}`;\n\n\t\t\t\tselectedItem.fields.addMember(member);\n\t\t\t\tselectedItem.updateTitle(Text.decode(newTitle));\n\t\t\t\tselectedItem.updateTitleNode();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tdebugger;\n\n\t\tconst inputText = this.input.value;\n\t\tconst mentioned = +this.mentioned;\n\t\tconst start = this.inputCursorPosition.start || 0;\n\t\tconst startSpace = (start === 0 || start - mentioned === 0 || inputText.charAt(start - mentioned - 1) === ' ') ? '' : ' ';\n\t\tconst endSpace = (inputText.charAt(start) === ' ' ? '' : ' ');\n\n\t\tthis.fields.addMember(member);\n\n\t\tconst newInputText = `${inputText.slice(\n\t\t\t0,\n\t\t\tstart - mentioned,\n\t\t)}${startSpace}${Text.decode(member.nameFormatted)}${endSpace}`;\n\n\t\tthis.inputCursorPosition.start = newInputText.length;\n\t\tthis.inputCursorPosition.end = newInputText.length;\n\n\t\tthis.input.value = `${newInputText}${inputText.slice(start)}`;\n\t\tthis.mentioned = false;\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tonSocNetSelectorAuditorSelected(auditor)\n\t{\n\t\tconst type = 'auditor';\n\t\tconst userData = this.prepareUserData(auditor);\n\t\tconst resultAuditor = { ...userData, type };\n\n\t\tconst notificationAction = `${type.toUpperCase()}_ADDED`;\n\t\tconst notificationData = { avatar: auditor.avatar };\n\n\t\tthis.processMemberSelect(resultAuditor);\n\t\tthis.getNotificationBalloon(notificationAction, notificationData);\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:auditorAdded', userData);\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'addAuditor' });\n\t}\n\n\tonSocNetSelectorAccompliceSelected(accomplice)\n\t{\n\t\tconst type = 'accomplice';\n\t\tconst userData = this.prepareUserData(accomplice);\n\t\tconst resultAccomplice = { ...userData, type };\n\n\t\tconst notificationAction = `${type.toUpperCase()}_ADDED`;\n\t\tconst notificationData = { avatar: accomplice.avatar };\n\n\t\tthis.processMemberSelect(resultAccomplice);\n\t\tthis.getNotificationBalloon(notificationAction, notificationData);\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:accompliceAdded', userData);\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'addAccomplice' });\n\t}\n\n\tprepareUserData(user)\n\t{\n\t\tconst customData = user.getCustomData();\n\t\tconst entityType = user.getEntityType();\n\n\t\treturn {\n\t\t\tavatar: user.avatar,\n\t\t\tdescription: '',\n\t\t\tentityType: 'U',\n\t\t\tid: user.getId(),\n\t\t\tname: customData.get('name'),\n\t\t\tlastName: customData.get('lastName'),\n\t\t\temail: customData.get('email'),\n\t\t\tnameFormatted: Text.encode(user.getTitle()),\n\t\t\tnetworkId: '',\n\t\t\ttype: {\n\t\t\t\tcrmemail: false,\n\t\t\t\textranet: (entityType === 'extranet'),\n\t\t\t\temail: (entityType === 'email'),\n\t\t\t\tnetwork: (entityType === 'network'),\n\t\t\t},\n\t\t\tisCollaber: (entityType === 'collaber'),\n\t\t};\n\t}\n\n\tgetMemberSelector(e, memberType = 'auditor', mentioned = false)\n\t{\n\t\tif (!this.checkCanAddAccomplice())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst typeFunctionMap = {\n\t\t\tauditor: this.onSocNetSelectorAuditorSelected.bind(this),\n\t\t\taccomplice: this.onSocNetSelectorAccompliceSelected.bind(this),\n\t\t};\n\t\tconst typeFunction = typeFunctionMap[memberType] || typeFunctionMap.auditor;\n\n\t\tthis.isSelectorLoading = true;\n\n\t\tRuntime.loadExtension('ui.entity-selector').then(exports => {\n\t\t\tconst { Dialog } = exports;\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: e.target,\n\t\t\t\tenableSearch: true,\n\t\t\t\tmultiple: false,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\temailUsers: true,\n\t\t\t\t\t\t\tnetworkUsers: this.optionManager.isNetworkEnabled,\n\t\t\t\t\t\t\textranetUsers: true,\n\t\t\t\t\t\t\tanalyticModuleName: 'task',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\t'onLoad': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.isSelectorLoading = false;\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.isSelectorLoading = false;\n\t\t\t\t\t\tthis.mentioned = mentioned;\n\t\t\t\t\t\tthis.retrieveFocus();\n\n\t\t\t\t\t\tconst { item: selectedItem } = event.getData();\n\t\t\t\t\t\ttypeFunction(selectedItem);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\tonAddAuditorClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'auditor');\n\t}\n\n\tonAddAccompliceClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'accomplice');\n\t}\n\n\tonUploadAttachmentClick(e)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst { prefix, diskUrls } = this.optionManager;\n\t\tconst { urlSelect, urlRenameFile, urlDeleteFile, urlUpload } = diskUrls;\n\n\t\tif (this.filesLoaderPopup === null)\n\t\t{\n\t\t\tthis.filesLoaderPopup = new BX.PopupWindow({\n\t\t\t\tcontent: this.getAttachmentsLoaderLayout(),\n\t\t\t\tbindElement: e.target,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 2,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: true,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filesLoaderPopup.setBindElement(e.target);\n\t\t}\n\n\t\tthis.filesLoaderPopup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: nodeId,\n\t\t\tcontrolName: `${prefix}[${nodeId}][UF_CHECKLIST_FILES][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect,\n\t\t\turlRenameFile,\n\t\t\turlDeleteFile,\n\t\t\turlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.filesLoaderPopup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show'],\n\t\t);\n\t}\n\n\tonDeleteAttachmentClick(fileId)\n\t{\n\t\tthis.fields.removeAttachment(fileId);\n\t\tDom.remove(this.getAttachmentsContainer().querySelector(`#disk-attach-${fileId}`));\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'deleteAttachment' });\n\t}\n\n\tgetPanelBodyLayout()\n\t{\n\t\tconst membersLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-auditor\" onclick=\"${this.onAddAuditorClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_AUDITOR'}`}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-accomplice\" onclick=\"${this.onAddAccompliceClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_ACCOMPLICE'}`}</span>\n\t\t\t</div>\n\t\t`;\n\t\tconst attachmentButtonLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-attachment\" onclick=\"${this.onUploadAttachmentClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tconst itemsActionButtonsLayout = Tag.render`\n\t\t\t${this.checkSelectedItems() ? '' : attachmentButtonLayout}\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabin\" onclick=\"${this.onTabInClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabout\" onclick=\"${this.onTabOutClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-important\n\t\t\t\t${this.fields.getIsImportant() ? ' tasks-checklist-item-editor-panel-btn-important-selected' : ''}\" onclick=\"${this.onImportantClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage('TASKS_CHECKLIST_PANEL_IMPORTANT')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-checklist\" onclick=\"${this.onToAnotherCheckListClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage(\n\t\t\t'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-remove\" onclick=\"${this.onDeleteClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tconst separator = Tag.render`<div class=\"tasks-checklist-item-editor-panel-separator\"></div>`;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel ${this.isTaskRoot() || this.isCheckList() ? 'tasks-checklist-item-editor-group-panel' : ''}\">\n\t\t\t\t${this.checkCanAddAccomplice() ? membersLayout : ''}\n\t\t\t\t${this.checkCanAddAccomplice() && !this.isCheckList() ? separator : ''}\n\t\t\t\t${!this.isCheckList() ? itemsActionButtonsLayout : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateTitle(text)\n\t{\n\t\tthis.fields.setTitle(text);\n\t}\n\n\tupdateTitleNode()\n\t{\n\t\tDom.replace(this.getTitleNodeContainer(), this.getTitleLayout());\n\t}\n\n\tgetTitleLayout()\n\t{\n\t\tconst { userPath } = this.optionManager;\n\t\tconst escapeRegExp = (string) => string.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n\t\tlet title = this.fields.getTitle();\n\n\t\ttitle = (this.isCheckList() ? CheckListItem.getDefaultCheckListTitle(title) : title);\n\n\t\tthis.fields.getMembers().forEach(({ id, nameFormatted, type, isCollaber }) => {\n\t\t\tconst regExp = new RegExp(escapeRegExp(nameFormatted), 'g');\n\t\t\tconst url = userPath.replace('#user_id#', id).replace('#USER_ID#', id);\n\t\t\ttitle = title.replace(regExp, CheckListItem.getMemberLinkLayout(type, nameFormatted, url, isCollaber));\n\t\t});\n\n\t\ttitle = title.replace(/(https?:\\/\\/[^\\s]+)/g, url => CheckListItem.getLinkLayout(url));\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${this.getTitleNodeClass()}\">\n\t\t\t\t${title}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tprocessMembersFromText()\n\t{\n\t\tconst membersToDelete = [];\n\n\t\tthis.fields.getMembers().forEach(({ id, nameFormatted }) => {\n\t\t\tif (this.fields.getTitle().indexOf(nameFormatted) === -1)\n\t\t\t{\n\t\t\t\tmembersToDelete.push(id);\n\t\t\t}\n\t\t});\n\n\t\tmembersToDelete.forEach((id) => {\n\t\t\tthis.fields.removeMember(id);\n\t\t});\n\t}\n\n\tupdateIndexes()\n\t{\n\t\tthis.updateSortIndexes();\n\t\tthis.updateDisplaySortIndexes();\n\t}\n\n\tupdateSortIndexes()\n\t{\n\t\tlet sortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.fields.setSortIndex(sortIndex);\n\t\t\tsortIndex += 1;\n\t\t});\n\t}\n\n\tupdateDisplaySortIndexes()\n\t{\n\t\tconst parentSortIndex = (this.isCheckList() || this.isTaskRoot() ? '' : `${this.fields.getDisplaySortIndex()}.`);\n\t\tlet localSortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tlocalSortIndex += 1;\n\t\t\tconst newSortIndex = `${parentSortIndex}${localSortIndex}`;\n\n\t\t\tdescendant.fields.setDisplaySortIndex(newSortIndex);\n\n\t\t\tif (!descendant.isCheckList())\n\t\t\t{\n\t\t\t\tdescendant.container.querySelector('.tasks-checklist-item-number').innerText = newSortIndex;\n\t\t\t}\n\n\t\t\tdescendant.updateDisplaySortIndexes();\n\t\t});\n\t}\n\n\thandleTaskOptions()\n\t{\n\t\tconst { userId, showCompleted, showOnlyMine } = this.optionManager;\n\n\t\tthis.getRootNode().hideByCondition((item) => {\n\t\t\tconst isComplete = item.fields.getIsComplete();\n\t\t\tconst hasUserInMembers = item.fields.getMembers().has(userId.toString());\n\t\t\tlet condition;\n\n\t\t\tif (!showCompleted && showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = isComplete || !hasUserInMembers;\n\t\t\t}\n\t\t\telse if (!showCompleted)\n\t\t\t{\n\t\t\t\tcondition = isComplete;\n\t\t\t}\n\t\t\telse if (showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = !hasUserInMembers;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcondition = false;\n\t\t\t}\n\n\t\t\treturn condition;\n\t\t});\n\t}\n\n\thideByCondition(condition)\n\t{\n\t\tif (this.checkCanHide(condition))\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tdescendant.hideByCondition(condition);\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckCanHide(condition)\n\t{\n\t\tif (\n\t\t\tthis.isTaskRoot()\n\t\t\t|| this.updateMode\n\t\t\t|| Dom.hasClass(this.container, this.showClass)\n\t\t\t|| !condition(this)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet canHide = true;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (!condition(descendant))\n\t\t\t{\n\t\t\t\tcanHide = false;\n\t\t\t}\n\t\t\telse if (canHide)\n\t\t\t{\n\t\t\t\tcanHide = descendant.checkCanHide(condition);\n\t\t\t}\n\t\t});\n\n\t\treturn canHide;\n\t}\n\n\thide()\n\t{\n\t\tDom.hide(this.container);\n\t}\n\n\tshow()\n\t{\n\t\tDom.show(this.container);\n\t}\n\n\tcheckIsComplete()\n\t{\n\t\tlet isComplete;\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\tisComplete = false;\n\t\t}\n\t\telse if (this.isCheckList())\n\t\t{\n\t\t\tconst completedCount = this.countCompletedCount(true);\n\t\t\tconst totalCount = this.countTotalCount(true);\n\n\t\t\tisComplete = (completedCount === totalCount && totalCount > 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tisComplete = this.fields.getIsComplete();\n\t\t}\n\n\t\treturn isComplete;\n\t}\n\n\tcheckActiveUpdateExist()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tlet found = false;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === false)\n\t\t\t{\n\t\t\t\tfound = descendant.checkActiveUpdateExist();\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tdisableAllGroup()\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsSelected())\n\t\t\t{\n\t\t\t\tdescendant.toggleGroup();\n\t\t\t}\n\t\t});\n\t}\n\n\tdisableAllUpdateModes()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tthis.handleUpdateEnding();\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.disableAllUpdateModes();\n\t\t});\n\t}\n\n\trememberInputState()\n\t{\n\t\tthis.input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\t}\n\n\tclearInput(e)\n\t{\n\t\te.preventDefault();\n\n\t\tthis.container.querySelector(`#text_${this.getNodeId()}`).value = '';\n\t\tthis.retrieveFocus();\n\t}\n\n\tretrieveFocus()\n\t{\n\t\tif (this.input !== null && this.inputCursorPosition)\n\t\t{\n\t\t\tconst { start, end } = this.inputCursorPosition;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.setSelectionRange(start, end);\n\t\t\t}, 10);\n\t\t}\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-header-name tasks-checklist-header-name-edit-mode\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-after-icon ui-ctl-xs ui-ctl-no-padding ui-ctl-underline \n\t\t\t\t\t\t\t\ttasks-checklist-header-name-editor\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t\t   onkeydown=\"${this.onInputKeyDown.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.UI.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-inner tasks-checklist-item-new ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\">\n\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\">\n\t\t\t\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"></span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-after-icon ui-ctl-w100\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t\t   onkeydown=\"${this.onInputKeyDown.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\tconst node = nodeToPosition || item.getContainer();\n\t\tconst position = Dom.getPosition(node);\n\n\t\tif (!this.panel)\n\t\t{\n\t\t\tthis.panel = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-editor-panel-container\">\n\t\t\t\t\t${item.getPanelBodyLayout()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\n\t\t\tDom.append(this.panel, document.body);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.replace(this.panel.querySelector('.tasks-checklist-item-editor-panel'), item.getPanelBodyLayout());\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\t\t}\n\n\t\tif (!Dom.isShown(this.panel))\n\t\t{\n\t\t\tDom.show(this.panel);\n\t\t}\n\n\t\tif (\n\t\t\t(Dom.isShown(this.panel) && item.isCheckList() && !item.checkCanAddAccomplice())\n\t\t\t|| (position.left === 0 && position.right === 0 && position.width === 0)\n\t\t)\n\t\t{\n\t\t\tDom.hide(this.panel);\n\t\t}\n\t}\n\n\tenableUpdateMode()\n\t{\n\t\tconst viewModeLayout = this.getInnerContainer();\n\t\tconst updateModeLayout = this.getUpdateModeLayout();\n\n\t\tDom.addClass(viewModeLayout, this.hiddenClass);\n\t\tDom.insertBefore(updateModeLayout, viewModeLayout);\n\n\t\tthis.input = updateModeLayout.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.input.focus();\n\t\tthis.input.setSelectionRange(this.input.value.length, this.input.value.length);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\n\t\tEvent.bind(this.input, 'beforeinput', this.onInputBeforeInput.bind(this));\n\n\t\tif (this.input.value === '' || this.input.value.length === 0)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (Dom.isShown(this.input))\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}, 250);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t}\n\n\t\tthis.updateMode = true;\n\t}\n\n\tdisableUpdateMode()\n\t{\n\t\tconst currentInner = this.getInnerContainer();\n\t\tconst text = currentInner.querySelector(`#text_${this.getNodeId()}`).value.trim();\n\n\t\tthis.updateTitle(text);\n\t\tthis.processMembersFromText();\n\t\tthis.updateTitleNode();\n\n\t\tDom.removeClass(currentInner.nextElementSibling, this.hiddenClass);\n\t\tDom.remove(currentInner);\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tcheckCanDeleteOnUpdateEnding()\n\t{\n\t\treturn this.getDescendantsCount() === 0\n\t\t\t&& Object.keys(this.fields.getAttachments()).length === 0\n\t\t\t&& this.filesLoaderProgressBars.size === 0;\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tCheckListItem.addDangerToElement(input.parentElement);\n\n\t\t\t\tif (this.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\t\t}\n\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\ttoggleUpdateMode(e)\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tif (e.keyCode === CheckListItem.keyCodes.enter || e.keyCode === CheckListItem.keyCodes.tab)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding(!this.isCheckList());\n\t\t\t}\n\t\t\telse if (e.keyCode === CheckListItem.keyCodes.esc)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst rootNode = this.getRootNode();\n\n\t\t\trootNode.disableAllUpdateModes();\n\t\t\trootNode.disableAllGroup();\n\n\t\t\tif (!rootNode.checkActiveUpdateExist())\n\t\t\t{\n\t\t\t\tthis.enableUpdateMode();\n\t\t\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'toggleUpdateMode' });\n\t\t\t}\n\t\t}\n\t}\n\n\tonInputKeyDown(e)\n\t{\n\t\tif (this.isSelectorLoading)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (e.keyCode)\n\t\t{\n\t\t\tcase CheckListItem.keyCodes.esc:\n\t\t\tcase CheckListItem.keyCodes.enter:\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\tsetTimeout(() => this.toggleUpdateMode(e));\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.tab:\n\t\t\t{\n\t\t\t\tif (!this.isCheckList())\n\t\t\t\t{\n\t\t\t\t\t(e.shiftKey ? this.tabOut.bind(this) : this.tabIn.bind(this))();\n\t\t\t\t}\n\t\t\t\tthis.retrieveFocus();\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.up:\n\t\t\t{\n\t\t\t\tconst leftSiblingThrough = this.getLeftSiblingThrough();\n\t\t\t\tif (leftSiblingThrough && leftSiblingThrough !== this.getRootNode())\n\t\t\t\t{\n\t\t\t\t\tleftSiblingThrough.toggleUpdateMode(e);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.down:\n\t\t\t{\n\t\t\t\tconst rightSiblingThrough = this.getRightSiblingThrough();\n\t\t\t\tif (rightSiblingThrough)\n\t\t\t\t{\n\t\t\t\t\trightSiblingThrough.toggleUpdateMode(e);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\t// do nothing\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonInputBeforeInput(e)\n\t{\n\t\tif (this.isSelectorLoading)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (['+', '@'].includes(e.data))\n\t\t{\n\t\t\tthis.getMemberSelector(e, this.optionManager.defaultMemberSelectorType, true);\n\t\t}\n\t}\n\n\tonHeaderMouseDown(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseDown(e);\n\t\tthis.clickEventHandler.registerClickDoneCallback(this.onHeaderClickDone.bind(this, e));\n\t}\n\n\tonHeaderMouseUp(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseUp(e);\n\t}\n\n\tonHeaderClickDone(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'header'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tonInnerContainerMouseDown(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseDown(e);\n\t\tthis.clickEventHandler.registerClickDoneCallback(this.onInnerContainerClickDone.bind(this, e));\n\t}\n\n\tonInnerContainerMouseUp(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseUp(e);\n\t}\n\n\tonInnerContainerClickDone(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'item'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getCheckList().fields.getIsSelected())\n\t\t{\n\t\t\tthis.toggleSelect(e);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tgetImportantLayout()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-important\" onclick=\"${this.onImportantClick.bind(this)}\"></div>\n\t\t`;\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.remove(this.container.querySelector('.tasks-checklist-item-important'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.insertBefore(\n\t\t\t\tthis.getImportantLayout(),\n\t\t\t\tthis.container.querySelector('.tasks-checklist-item-description'),\n\t\t\t);\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'toggleImportant' });\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tcheckSelectedItems()\n\t{\n\t\treturn this.getRootNode().getSelectedItems().length > 0;\n\t}\n\n\trunForEachSelectedItem(callback, reverse = false)\n\t{\n\t\tlet selectedItems = this.getRootNode().getSelectedItems();\n\n\t\tif (reverse)\n\t\t{\n\t\t\tselectedItems = [...selectedItems.reverse()];\n\t\t}\n\n\t\tselectedItems.forEach((item) => {\n\t\t\tcallback(item);\n\t\t});\n\t}\n\n\tonImportantClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.toggleImportant();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleImportant();\n\n\t\tconst panelImportantButton = e.target.closest('.tasks-checklist-item-editor-panel-btn-important');\n\t\tif (panelImportantButton)\n\t\t{\n\t\t\tDom.toggleClass(panelImportantButton, 'tasks-checklist-item-editor-panel-btn-important-selected');\n\t\t}\n\t}\n\n\tonCompleteAllButtonClick()\n\t{\n\t\tif (this.fields.getIsSelected() || this.updateMode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.completeAll();\n\t\tthis.runAjaxCompleteAll();\n\t}\n\n\tcompleteAll(): void\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (\n\t\t\t\tdescendant.checkCanToggle()\n\t\t\t\t&& !descendant.updateMode\n\t\t\t\t&& !descendant.fields.getIsComplete()\n\t\t\t)\n\t\t\t{\n\t\t\t\tdescendant.toggleComplete(false);\n\t\t\t}\n\t\t\tdescendant.completeAll();\n\t\t});\n\t}\n\n\trunAjaxCompleteAll(): void\n\t{\n\t\tconst { ajaxActions, entityId, entityType, stableTreeStructure } = this.optionManager;\n\n\t\tif (!ajaxActions || !ajaxActions.COMPLETE_ALL)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runAction(ajaxActions.COMPLETE_ALL, {\n\t\t\tdata: {\n\t\t\t\t[`${entityType.toLowerCase()}Id`]: entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tresponse.data.forEach(item => {\n\t\t\t\tthis.findById(item.id).updateStableTreeStructure(\n\t\t\t\t\titem.isComplete,\n\t\t\t\t\tstableTreeStructure,\n\t\t\t\t\tstableTreeStructure,\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\t}\n\n\tonCompleteButtonClick()\n\t{\n\t\tif (\n\t\t\tthis.getCheckList().fields.getIsSelected()\n\t\t\t|| this.updateMode\n\t\t\t|| !this.checkCanToggle()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleComplete();\n\t}\n\n\ttoggleComplete(runAjax = true)\n\t{\n\t\tconst isComplete = this.fields.getIsComplete();\n\n\t\tthis.fields.setIsComplete(!isComplete);\n\t\tthis.getParent().updateCounts();\n\t\tthis.getParent().updateProgress();\n\n\t\tDom.toggleClass(this.getInnerContainer(), this.checkedClass);\n\n\t\tthis.handleCheckListChanges();\n\t\tthis.handleTaskOptions();\n\n\t\tif (runAjax)\n\t\t{\n\t\t\tthis.runAjaxToggleComplete();\n\t\t}\n\t}\n\n\trunAjaxToggleComplete()\n\t{\n\t\tconst id = this.fields.getId();\n\n\t\tif (!id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {};\n\t\tconst { ajaxActions, entityId, entityType, stableTreeStructure } = this.optionManager;\n\t\tconst actionName = (this.fields.getIsComplete() ? ajaxActions.COMPLETE : ajaxActions.RENEW);\n\n\t\tdata[`${entityType.toLowerCase()}Id`] = entityId;\n\t\tdata.checkListItemId = id;\n\n\t\tBX.ajax.runAction(actionName, { data }).then((response) => {\n\t\t\tconst { isComplete } = response.data.checkListItem;\n\t\t\tthis.updateStableTreeStructure(isComplete, stableTreeStructure, stableTreeStructure);\n\t\t});\n\t}\n\n\tupdateStableTreeStructure(isComplete, item, parent)\n\t{\n\t\tif (this.fields.getId() === item.FIELDS.id)\n\t\t{\n\t\t\titem.FIELDS.isComplete = isComplete;\n\t\t\tparent.FIELDS.completedCount += (isComplete ? 1 : -1);\n\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.updateStableTreeStructure(isComplete, descendant, item);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tunselectAll()\n\t{\n\t\tconst checkBox = this.container.querySelector(`#select_${this.getNodeId()}`);\n\n\t\tif (checkBox && checkBox.checked === true)\n\t\t{\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tcheckBox.checked = false;\n\t\t\tDom.removeClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.unselectAll();\n\t\t});\n\t}\n\n\tgetSelected()\n\t{\n\t\tlet selected = [];\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tselected.push(this);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tselected = [...selected, ...descendant.getSelected()];\n\t\t});\n\n\t\treturn selected;\n\t}\n\n\tgetSelectedItems()\n\t{\n\t\treturn this.getSelected().filter(item => !item.isCheckList() && !item.isTaskRoot());\n\t}\n\n\tonSelectCheckboxClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\te.target.checked = false;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleSelect();\n\t}\n\n\ttoggleSelect()\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = false;\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(rootNode.panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = true;\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\t\t}\n\n\t\tDom.toggleClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t}\n\n\tonGroupButtonClick()\n\t{\n\t\tif (!this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\tthis.toggleGroup();\n\t\t}\n\t}\n\n\ttoggleGroup()\n\t{\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.unselectAll();\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\tif (this.fields.getIsCollapse())\n\t\t\t{\n\t\t\t\tthis.toggleCollapse();\n\t\t\t}\n\t\t}\n\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-collapse');\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-expand');\n\t}\n\n\tonCollapseButtonClick()\n\t{\n\t\tif (this.collapseFreezed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleCollapse();\n\t}\n\n\ttoggleCollapse()\n\t{\n\t\tthis.collapseFreezed = true;\n\n\t\tconst wrapperList = this.container.querySelector(`.${this.wrapperClass}`);\n\t\tconst wrapperListHeight = `${Dom.getPosition(wrapperList).height}px`;\n\n\t\tif (!Dom.hasClass(this.container, this.collapseClass))\n\t\t{\n\t\t\tthis.fields.setIsCollapse(true);\n\n\t\t\twrapperList.style.overflow = 'hidden';\n\t\t\twrapperList.style.height = wrapperListHeight;\n\t\t\tsetTimeout(() => {\n\t\t\t\twrapperList.style.height = 0;\n\t\t\t}, 0);\n\n\t\t\tDom.addClass(this.container, this.collapseClass);\n\n\t\t\tthis.collapseFreezed = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsCollapse(false);\n\n\t\t\twrapperList.style.height = 0;\n\t\t\twrapperList.style.height = `${wrapperList.scrollHeight}px`;\n\n\t\t\tconst setAutoHeight = () => {\n\t\t\t\twrapperList.style.height = 'auto';\n\t\t\t\tBX.unbind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\t\tthis.collapseFreezed = false;\n\t\t\t};\n\t\t\tBX.bind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\tDom.removeClass(this.container, this.collapseClass);\n\t\t}\n\t}\n\n\ttoggleEmpty()\n\t{\n\t\tDom.toggleClass(this.container, 'tasks-checklist-empty');\n\t}\n\n\thandleCheckListIsComplete()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsComplete = checkList.checkIsComplete();\n\n\t\tcheckList.fields.setIsComplete(checkListIsComplete);\n\n\t\tif (\n\t\t\tcheckListIsComplete\n\t\t\t&& !Dom.hasClass(checkList.container, 'tasks-checklist-collapse')\n\t\t\t&& this.collapseOnCompleteAll()\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleCollapse();\n\t\t}\n\t}\n\n\thandleCheckListIsEmpty()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsEmpty = checkList.getDescendantsCount() === 0;\n\n\t\tif (\n\t\t\t(checkListIsEmpty && !Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t\t|| (!checkListIsEmpty && Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleEmpty();\n\t\t}\n\t}\n\n\thandleCheckListChanges()\n\t{\n\t\tthis.handleCheckListIsComplete();\n\t\tthis.handleCheckListIsEmpty();\n\t}\n\n\tcheckSkipUpdate(e, area)\n\t{\n\t\treturn this.skipUpdateClasses[area]\n\t\t\t&& this.skipUpdateClasses[area].find(item => e.target.closest(item));\n\t}\n\n\tshowCompleteAllButton()\n\t{\n\t\treturn this.optionManager.getShowCompleteAllButton();\n\t}\n\n\tcollapseOnCompleteAll()\n\t{\n\t\treturn this.optionManager.getCollapseOnCompleteAll();\n\t}\n\n\tcheckCanAdd()\n\t{\n\t\treturn this.optionManager.getCanAdd();\n\t}\n\n\tcheckCanAddAccomplice()\n\t{\n\t\treturn this.optionManager.getCanAddAccomplice();\n\t}\n\n\tcheckCanUpdate()\n\t{\n\t\treturn this.action.canUpdate;\n\t}\n\n\tcheckCanRemove()\n\t{\n\t\treturn this.action.canRemove;\n\t}\n\n\tcheckCanToggle()\n\t{\n\t\treturn this.action.canToggle;\n\t}\n\n\tcheckCanDrag()\n\t{\n\t\treturn this.action.canDrag;\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn (this.isCheckList() ? 'tasks-checklist-header-name-text' : 'tasks-checklist-item-description-text');\n\t}\n\n\tgetTitleNodeContainer()\n\t{\n\t\treturn this.container.querySelector(`.${this.getTitleNodeClass()}`);\n\t}\n\n\tgetAttachmentsContainer()\n\t{\n\t\treturn this.container.querySelector(`#attachments_${this.getNodeId()}`);\n\t}\n\n\tgetSubItemsContainer()\n\t{\n\t\treturn this.container.querySelector(`#subItems_${this.getNodeId()}`);\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.tasks-checklist-header-name' : '.tasks-checklist-item-inner');\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this.container;\n\t}\n\n\tmove(item, position = 'bottom', action = 'move')\n\t{\n\t\tif (\n\t\t\tthis.getNodeId() === item.getNodeId()\n\t\t\t|| this.findChild(item.getNodeId()) !== null\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst oldParent = this.getParent();\n\t\tconst newParent = item.getParent();\n\n\t\toldParent.remove(this);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tnewParent.addBefore(this, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.addAfter(this, item);\n\t\t}\n\n\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tDom.insertBefore(this.container, item.container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.insertAfter(this.container, item.container);\n\t\t}\n\n\t\tthis.handleCheckListIsEmpty();\n\t\tthis.handleTaskOptions();\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action });\n\t}\n\n\tmakeChildOf(item, position = 'bottom', action = 'makeChildOf')\n\t{\n\t\tif (item.getDescendantsCount() > 0)\n\t\t{\n\t\t\tconst borderItems = {\n\t\t\t\ttop: item.getFirstDescendant(),\n\t\t\t\tbottom: item.getLastDescendant(),\n\t\t\t};\n\n\t\t\tthis.move(borderItems[position], position, action);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst oldParent = this.getParent();\n\t\t\tconst newParent = item;\n\n\t\t\toldParent.remove(this);\n\t\t\tnewParent.add(this);\n\n\t\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\t\tDom.append(this.container, newParent.getSubItemsContainer());\n\t\t\tDom.addClass(this.container, 'mobile-task-checklist-item-wrapper-animate');\n\n\t\t\tthis.handleCheckListIsEmpty();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action });\n\t\t}\n\t}\n\n\ttabIn()\n\t{\n\t\tif (!this.isFirstDescendant())\n\t\t{\n\t\t\tthis.makeChildOf(this.getLeftSibling(), 'bottom', 'tabIn');\n\t\t}\n\t}\n\n\tonTabInClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabIn();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabIn();\n\t\tthis.retrieveFocus();\n\t}\n\n\ttabOut()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tif (parent.isCheckList())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.move(parent, 'bottom', 'tabOut');\n\t}\n\n\tonTabOutClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabOut();\n\t\t\t}, true);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabOut();\n\t\tthis.retrieveFocus();\n\t}\n\n\taddCheckListItem(item = null, dependsOn = null, position = 'after')\n\t{\n\t\tconst itemGet = item instanceof this.class;\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst newCheckListItem = item || new this.class();\n\t\t\tlet newCheckListItemLayout;\n\n\t\t\tif (dependsOn instanceof this.class)\n\t\t\t{\n\t\t\t\tif (position === 'before')\n\t\t\t\t{\n\t\t\t\t\tthis.addBefore(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertBefore(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t\telse if (position === 'after')\n\t\t\t\t{\n\t\t\t\t\tthis.addAfter(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertAfter(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.add(newCheckListItem);\n\n\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\tDom.append(newCheckListItemLayout, this.getSubItemsContainer());\n\t\t\t}\n\n\t\t\tthis.updateCounts();\n\t\t\tthis.updateIndexes();\n\n\t\t\tif (!this.isTaskRoot())\n\t\t\t{\n\t\t\t\tthis.updateProgress();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tif (!itemGet)\n\t\t\t\t{\n\t\t\t\t\tnewCheckListItem.toggleUpdateMode();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.height = `${newCheckListItemLayout.scrollHeight}px`;\n\t\t\t\tnewCheckListItemLayout.style.opacity = 1;\n\t\t\t}, 1);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.overflow = '';\n\t\t\t\tnewCheckListItemLayout.style.height = '';\n\t\t\t\tnewCheckListItemLayout.style.opacity = '';\n\n\t\t\t\tDom.removeClass(newCheckListItemLayout, this.showClass);\n\n\t\t\t\tif (!this.isTaskRoot() && !itemGet && newCheckListItem.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.class.smoothScroll(newCheckListItem.getContainer());\n\t\t\t\t}\n\n\t\t\t\tresolve(newCheckListItem);\n\t\t\t}, 250);\n\t\t});\n\t}\n\n\tonAddCheckListItemClick()\n\t{\n\t\tif (this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addCheckListItem();\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tNODE_ID: this.getNodeId(),\n\t\t\tPARENT_NODE_ID: this.getParent().getNodeId(),\n\t\t\tID: this.fields.getId(),\n\t\t\tCOPIED_ID: this.fields.getCopiedId(),\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: [],\n\t\t\tATTACHMENTS: {},\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\tconst { nameFormatted, type } = value;\n\t\t\titemRequestData.MEMBERS.push({\n\t\t\t\t[key]: {\n\t\t\t\t\tTYPE: type,\n\t\t\t\t\tNAME: Text.decode(nameFormatted),\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tconst attachments = this.fields.getAttachments();\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\titemRequestData.ATTACHMENTS[id] = attachments[id];\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tgetRequestData(inputData = null)\n\t{\n\t\tconst title = this.fields.getTitle();\n\t\tlet data = inputData || [];\n\n\t\tif (!this.isTaskRoot() && title !== '' && title.length > 0)\n\t\t{\n\t\t\tdata.push(this.getItemRequestData());\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdata = descendant.getRequestData(data);\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tappendRequestLayout()\n\t{\n\t\tif (!this.isTaskRoot())\n\t\t{\n\t\t\tconst nodeId = this.getNodeId();\n\t\t\tconst attachments = this.fields.getAttachments();\n\t\t\tconst prefix = `${this.optionManager.prefix}[${nodeId}]`;\n\n\t\t\tlet membersLayout = '';\n\t\t\tlet attachmentsLayout = '';\n\n\t\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_TYPE_${key}\" name=\"${prefix}[MEMBERS][${key}][TYPE]\" value=\"${value.type}\"/>`;\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_NAME_${key}\" name=\"${prefix}[MEMBERS][${key}][NAME]\" value=\"${value.nameFormatted}\"/>`;\n\t\t\t});\n\n\t\t\tObject.keys(attachments).forEach((id) => {\n\t\t\t\tattachmentsLayout += `<input type=\"hidden\" id=\"ATTACHMENTS_${id}\" name=\"${prefix}[ATTACHMENTS][${id}]\" value=\"${attachments[id]}\"/>`;\n\t\t\t});\n\n\t\t\tconst requestLayout = Tag.render`\n\t\t\t\t<div id=\"request_${nodeId}\">\n\t\t\t\t\t<input type=\"hidden\" id=\"NODE_ID\" name=\"${prefix}[NODE_ID]\" value=\"${nodeId}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_NODE_ID\" name=\"${prefix}[PARENT_NODE_ID]\" value=\"${this.getParent().getNodeId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"ID\" name=\"${prefix}[ID]\" value=\"${this.fields.getId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"COPIED_ID\" name=\"${prefix}[COPIED_ID]\" value=\"${this.fields.getCopiedId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_ID\" name=\"${prefix}[PARENT_ID]\" value=\"${this.fields.getParentId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TITLE\" name=\"${prefix}[TITLE]\" value=\"${this.fields.getTitle()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"SORT_INDEX\" name=\"${prefix}[SORT_INDEX]\" value=\"${this.fields.getSortIndex()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_COMPLETE\" name=\"${prefix}[IS_COMPLETE]\" value=\"${this.fields.getIsComplete()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_IMPORTANT\" name=\"${prefix}[IS_IMPORTANT]\" value=\"${this.fields.getIsImportant()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"MODIFY\" name=\"${prefix}[ACTION][MODIFY]\" value=\"${this.checkCanUpdate()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"REMOVE\" name=\"${prefix}[ACTION][REMOVE]\" value=\"${this.checkCanRemove()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TOGGLE\" name=\"${prefix}[ACTION][TOGGLE]\" value=\"${this.checkCanToggle()}\"/>\n\t\t\t\t\t${membersLayout}\n\t\t\t\t\t${attachmentsLayout}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.remove(this.container.querySelector(`#request_${nodeId}`));\n\t\t\tDom.append(requestLayout, this.container);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.appendRequestLayout();\n\t\t});\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst searchId = this.fields.getId() || this.fields.getCopiedId();\n\t\tconst { optionManager } = this;\n\t\tconst optionAttachments = optionManager.attachments;\n\t\tlet attachmentsLayout = '';\n\n\t\tif (optionAttachments && (searchId in optionAttachments))\n\t\t{\n\t\t\tconst attachments = Tag.render`${optionAttachments[searchId]}`;\n\t\t\tconst stableAttachments = this.getStableAttachments(optionManager.getStableTreeStructure());\n\t\t\tconst attachmentsToDelete = [];\n\n\t\t\tif (!attachments)\n\t\t\t{\n\t\t\t\treturn attachmentsLayout;\n\t\t\t}\n\n\t\t\tattachmentsLayout = attachments;\n\n\t\t\tif (!Array.isArray(attachments))\n\t\t\t{\n\t\t\t\tattachmentsLayout = [attachments];\n\t\t\t}\n\n\t\t\tObject.keys(attachmentsLayout).forEach((key) => {\n\t\t\t\tconst attachment = attachmentsLayout[key];\n\t\t\t\tconst fileId = attachment.getAttribute('data-bx-id');\n\t\t\t\tconst extension = CheckListItem.getFileExtension(attachment.getAttribute('data-bx-extension'));\n\t\t\t\tconst extensionClass = `ui-icon-file-${extension}`;\n\t\t\t\tconst iconContainer = attachment.querySelector(`#disk-attach-file-${fileId}`);\n\t\t\t\tconst deleteButton = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\"\n\t\t\t\t\t\t onclick=\"${this.onDeleteAttachmentClick.bind(this, fileId)}\"></div>\n\t\t\t\t`;\n\t\t\t\tconst has = Object.prototype.hasOwnProperty;\n\n\t\t\t\tif (!has.call(stableAttachments, fileId))\n\t\t\t\t{\n\t\t\t\t\tattachmentsToDelete.push(key);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (iconContainer && !Dom.hasClass(iconContainer, extensionClass))\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(iconContainer, extensionClass);\n\t\t\t\t}\n\n\t\t\t\tif (this.checkCanUpdate())\n\t\t\t\t{\n\t\t\t\t\tDom.append(deleteButton, attachment.querySelector('.tasks-checklist-item-attachment-file-cover'));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tattachmentsToDelete.sort((a, b) => b - a);\n\t\t\tattachmentsToDelete.forEach((id) => {\n\t\t\t\tattachmentsLayout.splice(id, 1);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setAttachments({});\n\t\t}\n\n\t\treturn attachmentsLayout;\n\t}\n\n\tgetStableAttachments(item)\n\t{\n\t\tconst fields = item.FIELDS;\n\t\tconst id = fields.id || fields.copiedId;\n\n\t\tif (id === this.fields.getId() || id === this.fields.getCopiedId())\n\t\t{\n\t\t\treturn fields.attachments;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.getStableAttachments(descendant);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tgetLoadedAttachmentLayout(attachment)\n\t{\n\t\tconst { id, name, viewUrl, size, ext } = attachment;\n\t\tlet img = '';\n\n\t\tif (viewUrl)\n\t\t{\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\" style=\"background-image: url(${viewUrl})\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(\n\t\t\t\tthis,\n\t\t\t\tid,\n\t\t\t)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst extension = CheckListItem.getFileExtension(ext);\n\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\">\n\t\t\t\t\t<div class=\"ui-icon ui-icon-file-${extension}\"><i></i></div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(\n\t\t\t\tthis,\n\t\t\t\tid,\n\t\t\t)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\" data-bx-id=\"${id}\">\n\t\t\t\t${img}\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonAttachmentsLoaderMenuItemClick()\n\t{\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\tgetAttachmentsLoaderLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst { prefix } = this.optionManager;\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t\t<div id=\"diskuf-selectdialog-${nodeId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t\t<div class=\"diskuf-files-block tasks-checklist-loader-files\">\n\t\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t\t<input type=\"hidden\" name=\"${prefix}[${nodeId}][UF_CHECKLIST_FILES][]\" value=\"\"/>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t\t<label for=\"file_loader_${nodeId}\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${nodeId}\" type=\"file\"\n\t\t\t\t\t\t\t\t   multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.OnFileUploadSuccess.bind(this));\n\t\tBX.addCustomEvent(filesChooser, 'DiskDLoadFormControllerInit', (uf) => {\n\t\t\tuf._onUploadProgress = this.onUploadProgress.bind(this);\n\t\t});\n\n\t\treturn filesChooser;\n\t}\n\n\tonUploadProgress(item, progress)\n\t{\n\t\tconst { id, name, size } = item;\n\t\tconst newProgress = Math.min(progress, 98);\n\n\t\tif (!this.filesLoaderProgressBars.has(id))\n\t\t{\n\t\t\tconst myProgress = new BX.UI.ProgressRound({\n\t\t\t\tid: `load_progress_${id}`,\n\t\t\t\tvalue: newProgress,\n\t\t\t\tmaxValue: 100,\n\t\t\t\twidth: 69,\n\t\t\t\tlineSize: 5,\n\t\t\t\tfill: false,\n\t\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t\t\tstatusType: BX.UI.ProgressRound.Status.INCIRCLE,\n\t\t\t});\n\t\t\tconst filePreview = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\">\n\t\t\t\t\t${myProgress.getContainer()}\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.filesLoaderProgressBars.set(id, myProgress);\n\t\t\tDom.append(filePreview, this.getAttachmentsContainer());\n\t\t}\n\n\t\tif (!item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = 5;\n\t\t}\n\n\t\tif (newProgress > item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = Math.ceil(newProgress);\n\t\t\titem.progressBarWidth = item.progressBarWidth > 100 ? 100 : item.progressBarWidth;\n\n\t\t\tif (this.filesLoaderProgressBars.has(id))\n\t\t\t{\n\t\t\t\tthis.filesLoaderProgressBars.get(id).update(item.progressBarWidth);\n\t\t\t}\n\t\t}\n\t}\n\n\tOnFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst attachmentId = fileResult.element_id.toString();\n\t\tconst attachment = {\n\t\t\tid: attachmentId,\n\t\t\tname: fileResult.element_name,\n\t\t\tviewUrl: fileResult.element_url,\n\t\t\tsize: uploaderFile.size,\n\t\t\text: uploaderFile.ext,\n\t\t};\n\n\t\tthis.fields.addAttachments({ [attachmentId]: attachmentId });\n\t\tthis.filesLoaderProgressBars.delete(uploaderFile.id);\n\n\t\tconst attachmentProgress = this.getAttachmentsContainer().querySelector(`#disk-attach-${uploaderFile.id}`);\n\t\tconst attachmentLayout = this.getLoadedAttachmentLayout(attachment);\n\n\t\tif (attachmentProgress)\n\t\t{\n\t\t\tDom.replace(attachmentProgress, attachmentLayout);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(attachmentLayout, this.getAttachmentsContainer());\n\t\t}\n\n\t\tconst id = this.fields.getId();\n\t\tconst optionAttachments = this.optionManager.attachments;\n\n\t\tif (optionAttachments)\n\t\t{\n\t\t\tif (id in optionAttachments)\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] += attachmentLayout.outerHTML;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] = attachmentLayout.outerHTML;\n\t\t\t}\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'fileUpload' });\n\t}\n\n\tgetTaskRootLayout(children)\n\t{\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-task-root\">\n\t\t\t\t<div id=\"subItems_${this.getNodeId()}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst value = this.fields.getCompletedCount();\n\t\tconst maxValue = this.fields.getTotalCount();\n\t\tconst layouts = {\n\t\t\tlistActionsPanel: Tag.render`<div class=\"tasks-checklist-items-list-actions droppable\"></div>`,\n\t\t\tcompleteAllButton: Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-action-complete-all-btn\" onclick=\"${this.onCompleteAllButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_COMPLETE_ALL')}\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tgroupButton: '',\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-wrapper-dragndrop\"></div>`,\n\t\t};\n\n\t\tif (this.checkCanAdd())\n\t\t{\n\t\t\tconst addButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-add-btn\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tconst groupButton = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-action-group-btn\" onclick=\"${this.onGroupButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_GROUP_ACTIONS')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.append(addButtonLayout, layouts.listActionsPanel);\n\t\t\tlayouts.groupButton = groupButton;\n\t\t}\n\n\t\tif (this.checkCanRemove())\n\t\t{\n\t\t\tconst removeButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-remove-btn\" onclick=\"${this.onDeleteClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_DELETE_CHECKLIST')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tDom.append(removeButtonLayout, layouts.listActionsPanel);\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tif (!this.showCompleteAllButton())\n\t\t{\n\t\t\tlayouts.completeAllButton = '';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressBar({\n\t\t\tvalue,\n\t\t\tmaxValue,\n\t\t\tsize: BX.UI.ProgressBar.Size.MEDIUM,\n\t\t\ttextAfter: CheckListItem.getProgressText(value, maxValue),\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-wrapper tasks-checklist-item-group-editor-collapse\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-header-wrapper droppable\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-header-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-header-inner\">\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name\"\n\t\t\t\t\t\t\t\t onmousedown=\"${this.onHeaderMouseDown.bind(this)}\"\n\t\t\t\t\t\t\t\t onmouseup=\"${this.onHeaderMouseUp.bind(this)}\">\n\t\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name-edit-btn\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress-block\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-header-actions\">\n\t\t\t\t\t\t${layouts.completeAllButton}\n\t\t\t\t\t\t${layouts.groupButton}\n\t\t\t\t\t\t<div class=\"tasks-checklist-action-collapse-btn collapsed\" onclick=\"${this.onCollapseButtonClick.bind(\n\t\t\tthis)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-items-wrapper\">\n\t\t\t\t\t<div class=\"tasks-checklist-items-list\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${layouts.listActionsPanel}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst layouts = {\n\t\t\tdeleteButton: Tag.render`<button class=\"tasks-checklist-item-remove\" onclick=\"${this.onDeleteClick.bind(this)}\"></button>`,\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-item-dragndrop\"></div>`,\n\t\t\tattachments: this.getAttachmentsLayout(),\n\t\t};\n\n\t\tif (!this.checkCanRemove())\n\t\t{\n\t\t\tlayouts.deleteButton = '';\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-item-inner droppable ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\"\n\t\t\t\t\t onmousedown=\"${this.onInnerContainerMouseDown.bind(this)}\" onmouseup=\"${this.onInnerContainerMouseUp.bind(\n\t\t\tthis)}\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"></span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.fields.getIsImportant() ? this.getImportantLayout() : ''}\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-description\">\n\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-additional-block\">\n\t\t\t\t\t\t${layouts.deleteButton}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-actions-block\">\n\t\t\t\t\t\t<input class=\"tasks-checklist-item-group-checkbox\" id=\"select_${nodeId}\" type=\"checkbox\"\n\t\t\t\t\t\t\t   onclick=\"${this.onSelectCheckboxClick.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-list\" id=\"attachments_${nodeId}\">\n\t\t\t\t\t\t${layouts.attachments}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-sublist-items-wrapper\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetLayout()\n\t{\n\t\tconst children = [];\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tchildren.push(descendant.getLayout());\n\t\t});\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\treturn this.getTaskRootLayout(children);\n\t\t}\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tconst checkListLayout = this.getCheckListLayout(children);\n\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\treturn checkListLayout;\n\t\t}\n\n\t\treturn this.getCheckListItemLayout(children);\n\t}\n}\n\nclass MobileCheckListItem extends CheckListItem\n{\n\tclass = MobileCheckListItem;\n\n\tcheckedClass = 'mobile-task-checklist-item-checked';\n\thiddenClass = 'mobile-task-checklist-item-hidden';\n\tcollapseClass = 'mobile-task-checklist-section-collapse';\n\twrapperClass = 'mobile-task-checklist-wrapper';\n\n\tshowClass = 'mobile-checklist-item-show';\n\thideClass = 'mobile-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.mobile-task-checklist-item-checker',\n\t\t\t'.mobile-task-checklist-item-param',\n\t\t\t'.mobile-task-checklist-item-controls',\n\t\t],\n\t};\n\n\tstatic addDangerToElement(element)\n\t{\n\t\tconst dangerClass = 'mobile-task-checklist-error';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: {},\n\t\t\tATTACHMENTS: this.fields.getAttachments() || {},\n\t\t};\n\t\tconst membersTypes = {\n\t\t\taccomplice: 'A',\n\t\t\tauditor: 'U',\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\titemRequestData.MEMBERS[key] = { TYPE: membersTypes[value.type] };\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tonChecklistAjaxError()\n\t{\n\t\tBXMobileApp.Events.postToComponent('onChecklistAjaxError', {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\ttaskGuid: this.optionManager.taskGuid,\n\t\t}, 'tasks.view');\n\t}\n\n\tsendAddAjaxAction()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst fields = this.getItemRequestData();\n\t\t\tconst parent = this.getParent();\n\n\t\t\tfields.PARENT_ID = parent.fields.getId() || (parent.isTaskRoot() ? 0 : null);\n\n\t\t\tBX.ajax.runAction('tasks.task.checklist.add', {\n\t\t\t\tdata: {\n\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\tfields,\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tif (response.status === 'success')\n\t\t\t\t{\n\t\t\t\t\tconst { checkListItem } = response.data;\n\t\t\t\t\tthis.fields.setId(checkListItem.id);\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t}).catch(() => {\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\t}\n\n\tsendUpdateAjaxAction(fields, onFailCallback = null)\n\t{\n\t\tconst onFailFunction = onFailCallback || this.onChecklistAjaxError.bind(this);\n\n\t\tBX.ajax.runAction('tasks.task.checklist.update', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tfields,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tonFailFunction();\n\t\t\t}\n\t\t}).catch(() => onFailFunction());\n\t}\n\n\tsendRemoveAjaxAction()\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.delete', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tsendMembersAddAjaxAction(member, focusInput)\n\t{\n\t\tconst map = {\n\t\t\tauditor: {\n\t\t\t\tactionName: 'addAuditors',\n\t\t\t\tparamName: 'auditorsIds',\n\t\t\t\tletter: 'U',\n\t\t\t},\n\t\t\taccomplice: {\n\t\t\t\tactionName: 'addAccomplices',\n\t\t\t\tparamName: 'accomplicesIds',\n\t\t\t\tletter: 'A',\n\t\t\t},\n\t\t};\n\t\tconst currentType = map[member.type];\n\n\t\tconst toChecklistAddAction = 'tasks.task.checklist.addMembers';\n\t\tconst toChecklistAddData = {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\tmembers: { [member.id]: currentType.letter },\n\t\t};\n\n\t\tBX.ajax.runAction(toChecklistAddAction, { data: toChecklistAddData }).then((toChecklistAddResponse) => {\n\t\t\tif (toChecklistAddResponse.status === 'success')\n\t\t\t{\n\t\t\t\tif (focusInput)\n\t\t\t\t{\n\t\t\t\t\tthis.toggleUpdateMode();\n\t\t\t\t}\n\n\t\t\t\tBX.ajax.runAction(`tasks.task.${currentType.actionName}`, {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\t\t[currentType.paramName]: [member.id],\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.fields.removeMember(member.id);\n\t\t\t}\n\t\t}).catch(() => this.fields.removeMember(member.id));\n\t}\n\n\tsendMoveAfterAjaxAction(afterItem)\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.moveAfter', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tafterItemId: afterItem.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tgetPopupMenuItems()\n\t{\n\t\tconst locPrefix = 'TASKS_CHECKLIST_MOBILE_POPUP_MENU_';\n\t\tconst popupMenuItems = [];\n\t\tconst popupMenuItemsBuildMap = {\n\t\t\tchecklist: {\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\trename: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}RENAME`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-rename.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t\tchecklistItem: {\n\t\t\t\taddFile: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_FILE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-file.png',\n\t\t\t\t},\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\ttabIn: {\n\t\t\t\t\tcondition: this.checkCanTabIn.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_IN`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-in.png',\n\t\t\t\t},\n\t\t\t\ttabOut: {\n\t\t\t\t\tcondition: this.checkCanTabOut.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_OUT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-out.png',\n\t\t\t\t},\n\t\t\t\timportant: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}IMPORTANT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-important.png',\n\t\t\t\t},\n\t\t\t\ttoAnotherChecklist: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TO_ANOTHER_CHECKLIST`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-to-another-checklist.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tconst type = (this.isCheckList() ? 'checklist' : 'checklistItem');\n\n\t\tObject.keys(popupMenuItemsBuildMap[type]).forEach((id) => {\n\t\t\tconst { sectionCode, title, iconUrl, condition } = popupMenuItemsBuildMap[type][id];\n\t\t\tpopupMenuItems.push({ id, sectionCode, title, iconUrl, disable: !condition() });\n\t\t});\n\n\t\treturn popupMenuItems;\n\t}\n\n\tgetPopupChecklistsList()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\t\tconst popupChecklistsList = [];\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupChecklistsList.push({\n\t\t\t\tid: descendant.getNodeId(),\n\t\t\t\ttitle: Text.decode(descendant.fields.getTitle()),\n\t\t\t\tsectionCode: '0',\n\t\t\t});\n\t\t});\n\t\tpopupChecklistsList.push({\n\t\t\tid: 'newChecklist',\n\t\t\ttitle: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tsectionCode: '0',\n\t\t});\n\n\t\treturn popupChecklistsList;\n\t}\n\n\tonMemberSelectedEvent(eventData)\n\t{\n\t\tconst { nodeId, member, position, focusInput } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst title = node.fields.getTitle();\n\t\tlet newTitle = '';\n\n\t\tmember.nameFormatted = Text.encode(member.nameFormatted);\n\n\t\tif (focusInput)\n\t\t{\n\t\t\tconst start = position || 0;\n\t\t\tconst startSpace = ((start === 0 || start - 1 === 0 || title.charAt(start - 2) === ' ') ? '' : ' ');\n\t\t\tconst endSpace = (title.charAt(start - 1) === ' ' ? '' : ' ');\n\t\t\tconst newInputText = `${title.slice(0, start - 1)}${startSpace}${member.nameFormatted}${endSpace}`;\n\t\t\tnewTitle = `${newInputText}${title.slice(start)}`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst space = (title.slice(-1) === ' ' ? '' : ' ');\n\t\t\tnewTitle = `${title}${space}${member.nameFormatted}`;\n\t\t}\n\n\t\tnode.fields.addMember(member);\n\t\tnode.updateTitle(Text.decode(newTitle));\n\t\tnode.updateTitleNode();\n\n\t\tif (!this.checkEditMode())\n\t\t{\n\t\t\tnode.sendUpdateAjaxAction({ TITLE: Text.decode(node.fields.getTitle()) });\n\t\t\tnode.sendMembersAddAjaxAction(member, focusInput);\n\t\t}\n\t\telse if (focusInput)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonAddAttachmentEvent(eventData)\n\t{\n\t\tconst { nodeId, attachment } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tconst key = Object.keys(attachment)[0];\n\t\t\tconst value = Object.values(attachment)[0];\n\n\t\t\tnode.fields.addAttachments({ [`n${key}`]: value });\n\t\t}\n\t}\n\n\tonRemoveAttachmentEvent(eventData)\n\t{\n\t\tconst { nodeId, attachmentId } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.fields.removeAttachment(attachmentId);\n\t\t\tnode.fields.removeAttachment(`n${attachmentId}`);\n\t\t}\n\t}\n\n\tgetFakeAttachmentsCount(filesToRemove, filesToAdd)\n\t{\n\t\tconst attachmentsIds = Object.keys(this.fields.getAttachments());\n\t\tconst countWithRemovable = attachmentsIds.filter(id => !filesToRemove.includes(id)).length;\n\n\t\treturn countWithRemovable + filesToAdd.length;\n\t}\n\n\tsetLayoutAttachmentsCount(attachmentsCount)\n\t{\n\t\tconst newAttachmentsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t\tDom.replace(this.getAttachmentsContainer(), newAttachmentsLayout);\n\t}\n\n\tupdateNodeAttachments(filesToRemove, filesToAdd, attachments = null)\n\t{\n\t\tif (attachments)\n\t\t{\n\t\t\tthis.fields.setAttachments(attachments);\n\t\t}\n\n\t\tconst fakeAttachmentsCount = this.getFakeAttachmentsCount(filesToRemove, filesToAdd);\n\t\tthis.setLayoutAttachmentsCount(fakeAttachmentsCount);\n\t}\n\n\tonAttachFilesEvent(eventData)\n\t{\n\t\tconst { nodeId, filesToRemove, filesToAdd, attachments, checkListItemId } = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonRemoveFilesEvent(eventData)\n\t{\n\t\tconst { nodeId, filesToRemove, filesToAdd, attachments } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonFakeAttachFilesEvent(eventData)\n\t{\n\t\tconst { nodeId, filesToRemove, filesToAdd, checkListItemId } = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonFakeRemoveFilesEvent(eventData)\n\t{\n\t\tconst { nodeId, filesToRemove, filesToAdd } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonRenameEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonRemoveEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tif (!this.checkEditMode() && node.fields.getId())\n\t\t\t{\n\t\t\t\tnode.sendRemoveAjaxAction();\n\t\t\t}\n\t\t\tnode.deleteAction(false);\n\t\t\tnode.getParent().updateIndexes();\n\t\t\tnode.handleCheckListChanges();\n\t\t}\n\t}\n\n\tonTabInEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabIn())\n\t\t{\n\t\t\tnode.tabIn();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst fields = {\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t};\n\t\t\t\t\tconst onFailCallback = () => {\n\t\t\t\t\t\tnode.tabOut();\n\t\t\t\t\t};\n\n\t\t\t\t\tnode.sendUpdateAjaxAction(fields, onFailCallback);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonTabOutEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabOut())\n\t\t{\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnode.sendMoveAfterAjaxAction(node.getParent());\n\t\t\t}\n\t\t\tnode.tabOut();\n\t\t}\n\t}\n\n\tonImportantEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleImportant();\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tconst onFailCallback = () => {\n\t\t\t\t\tnode.toggleImportant();\n\t\t\t\t};\n\t\t\t\tnode.sendUpdateAjaxAction({ IS_IMPORTANT: node.fields.getIsImportant() }, onFailCallback);\n\t\t\t}\n\t\t}\n\t}\n\n\tonToAnotherCheckListEvent(eventData)\n\t{\n\t\tconst { nodeId, checklistId } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (checklistId === 'newChecklist')\n\t\t{\n\t\t\tnode.moveToNewCheckList(this.getDescendantsCount() + 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.makeChildOf(this.findChild(checklistId));\n\t\t\tnode.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnode.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetNativeComponentName()\n\t{\n\t\treturn (this.checkEditMode() ? 'tasks.edit' : 'tasks.view');\n\t}\n\n\tcheckEditMode()\n\t{\n\t\treturn this.optionManager.isEditMode();\n\t}\n\n\tcheckCanTabIn()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.isFirstDescendant();\n\t}\n\n\tcheckCanTabOut()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.getParent().isCheckList();\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\t// no editor panel in mobile version\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn this.isCheckList() ? 'mobile-task-checklist-head-title-text' : 'mobile-task-checklist-item-text';\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.mobile-task-checklist-head-title' : '.mobile-task-checklist-item');\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new MobileCheckListItem({ TITLE: title });\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tthis.makeChildOf(newCheckList);\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnewCheckList.sendAddAjaxAction().then(() => {\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: this.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}, () => {\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.removeClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.addClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tif (!this.checkEditMode() && this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tthis.sendRemoveAjaxAction();\n\t\t\t\t}\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tMobileCheckListItem.addDangerToElement(input.parentElement);\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tconst itemRequestData = this.getItemRequestData();\n\t\t\t\t\tconst members = itemRequestData.MEMBERS;\n\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tTITLE: itemRequestData.TITLE,\n\t\t\t\t\t\tMEMBERS: (Object.keys(members).length > 0 ? members : ''),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.sendAddAjaxAction().then(() => {\n\t\t\t\t\t}, () => {\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonInputBeforeInput(e)\n\t{\n\t\tconst memberSelectorCallKeys = ['@', '+'];\n\t\tconst position = CheckListItem.getInputSelection(this.input).start;\n\n\t\tif (memberSelectorCallKeys.includes(e.data) && this.checkCanAddAccomplice())\n\t\t{\n\t\t\tconst params = {\n\t\t\t\tposition,\n\t\t\t\tnodeId: this.getNodeId(),\n\t\t\t};\n\t\t\tBXMobileApp.Events.postToComponent(\n\t\t\t\t'onChecklistInputMemberSelectorCall',\n\t\t\t\tparams,\n\t\t\t\tthis.getNativeComponentName(),\n\t\t\t);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tonInputKeyPressed(e)\n\t{\n\t\tif (e.keyCode === CheckListItem.keyCodes.enter)\n\t\t{\n\t\t\tthis.toggleUpdateMode(e);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tgetParamsForMobileEvent(type)\n\t{\n\t\tif (!['settings', 'attachments'].includes(type))\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tconst { entityId, entityType, taskGuid, diskOptions, mode } = this.optionManager;\n\t\tconst defaultParams = {\n\t\t\ttaskGuid,\n\t\t\ttaskId: entityId,\n\t\t\tnodeId: this.getNodeId(),\n\t\t\tdisk: diskOptions,\n\t\t\tajaxData: {\n\t\t\t\tentityId,\n\t\t\t\tmode,\n\t\t\t\tcheckListItemId: (this.checkEditMode() ? this.getNodeId() : this.fields.getId()),\n\t\t\t\tentityTypeId: `${entityType.toLowerCase()}Id`,\n\t\t\t},\n\t\t};\n\t\tlet localParams = {};\n\n\t\tif (type === 'settings')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tpopupChecklists: this.getPopupChecklistsList(),\n\t\t\t\tpopupMenuItems: this.getPopupMenuItems(),\n\t\t\t\tpopupMenuSections: [{ id: '0', title: Text.decode(this.fields.getTitle()) }],\n\t\t\t};\n\t\t}\n\t\telse if (type === 'attachments')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tattachmentsIds: Object.keys(this.fields.getAttachments()),\n\t\t\t\tcanUpdate: this.checkCanUpdate(),\n\t\t\t};\n\t\t}\n\n\t\treturn { ...defaultParams, ...localParams };\n\t}\n\n\tonAttachmentsLayoutClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('attachments');\n\t\tBXMobileApp.Events.postToComponent('onChecklistAttachmentsClick', params, this.getNativeComponentName());\n\t}\n\n\tonSettingsClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('settings');\n\t\tBXMobileApp.Events.postToComponent('onChecklistSettingsClick', params, this.getNativeComponentName());\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"mobile-task-checklist-head-title mobile-task-checklist-item-edit-mode\">\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item mobile-task-checklist-item-edit-mode ${this.fields.getIsComplete() ? this.checkedClass : ''}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item-checker\">\n\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst attachmentsCount = Object.keys(this.fields.getAttachments()).length;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\t\tconst addButtonLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-add-button\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t<div class=\"mobile-task-checklist-add-text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\tstatusType: BX.UI.ProgressRound.Status.COUNTER,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-section\" id=\"${nodeId}\" data-role=\"mobile-task-checklist\">\n\t\t\t\t<div class=\"mobile-task-checklist-head\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-counter\">\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-counter-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-head-title\" onclick=\"${this.onHeaderClickDone.bind(this)}\">\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-visible\"\n\t\t\t\t\t\t\t onclick=\"${this.onCollapseButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-wrapper\">\n\t\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.checkCanAdd() ? addButtonLayout : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-wrapper\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item ${this.fields.getIsComplete() ? this.checkedClass : ''} ${this.fields.getIsImportant() ? 'mobile-task-checklist-item-important' : ''}\"\n\t\t\t\t\t onclick=\"${this.onInnerContainerClickDone.bind(this)}\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-checker\" id=\"progress_${nodeId}\"\n\t\t\t\t\t\t onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.getAttachmentsLayout()}\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n}\n\nexport { CheckListItem, MobileCheckListItem };"],"names":["TreeItem","Math","random","toString","substr","setNodeId","generateUniqueNodeId","setParent","parent","getParent","nodeId","CompositeTreeItem","descendants","item","position","push","splice","after","index","findIndex","descendant","add","before","length","getFirstDescendant","getLastDescendant","isFirstDescendant","parentDescendants","getDescendants","isLastDescendant","getRootNode","leftSiblingThrough","getLeftSibling","getDescendantsCount","getRightSibling","getNodeId","found","forEach","findChild","size","countTreeSize","CheckListItemFields","string","camelCaseString","Type","isString","toLowerCase","replace","match","chr","toUpperCase","snakeCaseString","fields","id","parentId","title","sortIndex","displaySortIndex","isComplete","isImportant","isSelected","isCollapse","completedCount","totalCount","members","Map","attachments","setFields","Object","keys","name","camelCaseName","snakeToCamelCase","indexOf","snakeCaseName","camelToSnakeCase","setMethod","bind","copiedId","Text","encode","types","A","U","clear","NAME","TYPE","IS_COLLABER","set","nameFormatted","type","isCollaber","member","CheckListItem","element","dangerClass","Dom","hasClass","addClass","oldParent","newParent","updateCounts","updateProgress","updateIndexes","completed","total","replaces","progressText","Loc","getMessage","search","ext","fileExtension","input","start","end","normalizedValue","range","textInputRange","len","endRange","selectionStart","selectionEnd","document","selection","createRange","parentElement","value","createTextRange","moveToBookmark","getBookmark","collapse","compareEndPoints","moveStart","slice","split","moveEnd","defaultTitle","itemNumber","node","posFrom","BX","GetWindowScrollPos","scrollTop","posTo","pos","top","round","GetWindowInnerSize","innerHeight","toBottom","distance","abs","speed","step","posCurrent","timer","i","setTimeout","url","messageId","esc","enter","plus","atsign","tab","up","down","backspace","action","header","canUpdate","MODIFY","canRemove","REMOVE","canToggle","TOGGLE","canDrag","DRAG","panel","progress","filesLoaderPopup","filesLoaderProgressBars","updateMode","optionManager","clickEventHandler","isTaskRoot","getId","findById","recursively","getIsComplete","countCompletedCount","countTotalCount","setCompletedCount","setTotalCount","updateCompletedCount","updateTotalCount","getTotalCount","getCompletedCount","setMaxValue","update","isCheckList","updateProgressText","getProgressText","setTextAfter","layout","style","overflow","height","opacity","showClass","scrollHeight","hideClass","remove","setDefaultStyles","container","paddingTop","getSortIndex","addCheckListItem","showBalloon","getTitle","data","getNotificationBalloon","EventEmitter","emit","e","preventDefault","hide","checkSelectedItems","items","getSelectedItems","runForEachSelectedItem","setIsSelected","deleteAction","handleCheckListChanges","actions","content","events","click","event","balloon","close","restore","handleTaskOptions","image","avatar","Tag","render","encodeURI","loadExt","then","UI","Notification","Center","notify","rootNode","moveToNewCheckList","PopupMenuWindow","target","getToAnotherCheckListPopupItems","autoHide","closeByEsc","offsetLeft","offsetWidth","angle","onPopupClose","destroy","show","selectMode","popupMenuItems","toNewCheckListMenuItem","text","message","onclick","getMenuWindow","selectedItem","makeChildOf","unselectAll","delimiter","checkList","getCheckList","checkLists","filter","handleUpdateEnding","number","newCheckList","TITLE","space","newTitle","addMember","updateTitle","decode","updateTitleNode","inputText","mentioned","inputCursorPosition","startSpace","charAt","endSpace","newInputText","retrieveFocus","auditor","userData","prepareUserData","resultAuditor","notificationAction","notificationData","processMemberSelect","accomplice","resultAccomplice","user","customData","getCustomData","entityType","getEntityType","description","get","lastName","email","networkId","crmemail","extranet","network","memberType","checkCanAddAccomplice","typeFunctionMap","onSocNetSelectorAuditorSelected","onSocNetSelectorAccompliceSelected","typeFunction","isSelectorLoading","Runtime","loadExtension","exports","Dialog","dialog","targetNode","enableSearch","multiple","entities","options","inviteGuestLink","inviteEmployeeLink","emailUsers","networkUsers","isNetworkEnabled","extranetUsers","analyticModuleName","getData","getMemberSelector","prefix","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","PopupWindow","getAttachmentsLoaderLayout","bindElement","setBindElement","Disk","UF","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","querySelector","fileId","removeAttachment","getAttachmentsContainer","membersLayout","onAddAuditorClick","onAddAccompliceClick","attachmentButtonLayout","onUploadAttachmentClick","itemsActionButtonsLayout","onTabInClick","onTabOutClick","getIsImportant","onImportantClick","onToAnotherCheckListClick","onDeleteClick","separator","setTitle","getTitleNodeContainer","getTitleLayout","userPath","escapeRegExp","getDefaultCheckListTitle","getMembers","regExp","RegExp","getMemberLinkLayout","getLinkLayout","getTitleNodeClass","membersToDelete","removeMember","updateSortIndexes","updateDisplaySortIndexes","setSortIndex","parentSortIndex","getDisplaySortIndex","localSortIndex","newSortIndex","setDisplaySortIndex","innerText","userId","showCompleted","showOnlyMine","hideByCondition","hasUserInMembers","has","condition","checkCanHide","canHide","checkActiveUpdateExist","getIsSelected","toggleGroup","disableAllUpdateModes","getInputSelection","focus","setSelectionRange","onInputKeyDown","rememberInputState","clearInput","progressBarLayout","ProgressRound","maxValue","width","lineSize","fill","color","Color","PRIMARY","onCompleteButtonClick","getContainer","nodeToPosition","getPosition","getPanelBodyLayout","left","append","body","isShown","right","viewModeLayout","getInnerContainer","updateModeLayout","getUpdateModeLayout","hiddenClass","insertBefore","Event","onInputBeforeInput","showEditorPanel","currentInner","trim","processMembersFromText","removeClass","nextElementSibling","getAttachments","createNewItem","checkCanDeleteOnUpdateEnding","handleCheckListIsEmpty","addDangerToElement","disableUpdateMode","keyCode","keyCodes","disableAllGroup","enableUpdateMode","toggleUpdateMode","shiftKey","tabOut","tabIn","getLeftSiblingThrough","rightSiblingThrough","getRightSiblingThrough","includes","defaultMemberSelectorType","handleMouseDown","registerClickDoneCallback","onHeaderClickDone","handleMouseUp","checkCanUpdate","checkSkipUpdate","onInnerContainerClickDone","toggleSelect","setIsImportant","getImportantLayout","callback","reverse","selectedItems","toggleImportant","panelImportantButton","closest","toggleClass","completeAll","runAjaxCompleteAll","checkCanToggle","toggleComplete","ajaxActions","entityId","stableTreeStructure","COMPLETE_ALL","ajax","runAction","response","updateStableTreeStructure","runAjax","setIsComplete","checkedClass","runAjaxToggleComplete","actionName","COMPLETE","RENEW","checkListItemId","checkListItem","FIELDS","DESCENDANTS","checkBox","checked","selected","getSelected","getIsCollapse","toggleCollapse","collapseFreezed","wrapperList","wrapperClass","wrapperListHeight","collapseClass","setIsCollapse","setAutoHeight","unbind","checkListIsComplete","checkIsComplete","collapseOnCompleteAll","checkListIsEmpty","toggleEmpty","handleCheckListIsComplete","area","skipUpdateClasses","find","getShowCompleteAllButton","getCollapseOnCompleteAll","getCanAdd","getCanAddAccomplice","addBefore","addAfter","updateParents","insertAfter","borderItems","bottom","move","getSubItemsContainer","dependsOn","itemGet","Promise","resolve","newCheckListItem","newCheckListItemLayout","getLayout","smoothScroll","itemRequestData","NODE_ID","PARENT_NODE_ID","ID","COPIED_ID","getCopiedId","PARENT_ID","getParentId","SORT_INDEX","IS_COMPLETE","IS_IMPORTANT","MEMBERS","ATTACHMENTS","key","inputData","getItemRequestData","getRequestData","attachmentsLayout","requestLayout","checkCanRemove","appendRequestLayout","searchId","optionAttachments","stableAttachments","getStableAttachments","getStableTreeStructure","attachmentsToDelete","Array","isArray","attachment","getAttribute","extension","getFileExtension","extensionClass","iconContainer","deleteButton","onDeleteAttachmentClick","prototype","hasOwnProperty","call","sort","a","b","setAttachments","viewUrl","img","filesChooser","onAttachmentsLoaderMenuItemClick","addCustomEvent","OnFileUploadSuccess","uf","_onUploadProgress","onUploadProgress","newProgress","min","myProgress","statusType","Status","INCIRCLE","filePreview","progressBarWidth","ceil","fileResult","file","uploaderFile","attachmentId","element_id","element_name","element_url","addAttachments","attachmentProgress","attachmentLayout","getLoadedAttachmentLayout","outerHTML","children","layouts","listActionsPanel","completeAllButton","onCompleteAllButtonClick","groupButton","dndButton","checkCanAdd","addButtonLayout","onAddCheckListItemClick","onGroupButtonClick","removeButtonLayout","checkCanDrag","visibility","showCompleteAllButton","ProgressBar","Size","MEDIUM","textAfter","onHeaderMouseDown","onHeaderMouseUp","onCollapseButtonClick","getAttachmentsLayout","onInnerContainerMouseDown","onInnerContainerMouseUp","onSelectCheckboxClick","getTaskRootLayout","checkListLayout","getCheckListLayout","getCheckListItemLayout","MobileCheckListItem","membersTypes","BXMobileApp","Events","postToComponent","taskId","taskGuid","reject","status","setId","onChecklistAjaxError","onFailCallback","onFailFunction","focusInput","map","paramName","letter","currentType","toChecklistAddAction","toChecklistAddData","toChecklistAddResponse","afterItem","afterItemId","locPrefix","popupMenuItemsBuildMap","checklist","addAuditor","sectionCode","iconUrl","addAccomplice","rename","checklistItem","addFile","checkCanTabIn","checkCanTabOut","important","toAnotherChecklist","disable","popupChecklistsList","eventData","checkEditMode","sendUpdateAjaxAction","sendMembersAddAjaxAction","values","filesToRemove","filesToAdd","attachmentsIds","countWithRemovable","attachmentsCount","newAttachmentsLayout","onAttachmentsLayoutClick","fakeAttachmentsCount","getFakeAttachmentsCount","setLayoutAttachmentsCount","updateNodeAttachments","sendRemoveAjaxAction","sendMoveAfterAjaxAction","checklistId","isEditMode","sendAddAjaxAction","memberSelectorCallKeys","params","getNativeComponentName","diskOptions","mode","defaultParams","disk","ajaxData","entityTypeId","localParams","popupChecklists","getPopupChecklistsList","getPopupMenuItems","popupMenuSections","getParamsForMobileEvent","onInputKeyPressed","Mobile","Tasks","CheckList","settingsLayout","onSettingsClick","COUNTER"],"mappings":";;;;;KAAMA,QAAQ;GAAA;KAAA;KAAA,uCAGb;OACC,OAAOC,IAAI,CAACC,MAAM,EAAE,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;;;GAG/C,oBACA;KAAA;KACC,IAAI,CAACC,SAAS,CAACL,QAAQ,CAACM,oBAAoB,EAAE,CAAC;KAC/C,IAAI,CAACC,SAAS,CAAC,IAAI,CAAC;;GACpB;KAAA;KAAA,8BAGD;OACC,IAAIC,MAAM,GAAG,IAAI;OAEjB,OAAOA,MAAM,CAACC,SAAS,EAAE,KAAK,IAAI,EAClC;SACCD,MAAM,GAAGA,MAAM,CAACC,SAAS,EAAE;;OAG5B,OAAOD,MAAM;;;KACb;KAAA,4BAGD;OACC,OAAO,IAAI,CAACE,MAAM;;;KAClB;KAAA,0BAESA,MAAM,EAChB;OACC,IAAI,CAACA,MAAM,GAAGA,MAAM;;;KACpB;KAAA,4BAGD;OACC,OAAO,IAAI,CAACF,MAAM;;;KAClB;KAAA,0BAESA,MAAM,EAChB;OACC,IAAI,CAACA,MAAM,GAAGA,MAAM;;;GACpB;CAAA;;CC3CmC,IAE/BG,iBAAiB;GAAA;GAEtB,6BACA;KAAA;KAAA;KACC;KACA,MAAKC,WAAW,GAAG,EAAE;KAAC;;GACtB;KAAA;KAAA,oBAEGC,IAAI,EACR;OAAA,IADUC,QAAQ,uEAAG,IAAI;OAExBD,IAAI,CAACN,SAAS,CAAC,IAAI,CAAC;OAEpB,IAAIO,QAAQ,KAAK,IAAI,EACrB;SACC,IAAI,CAACF,WAAW,CAACG,IAAI,CAACF,IAAI,CAAC;QAC3B,MAED;SACC,IAAI,CAACD,WAAW,CAACI,MAAM,CAACF,QAAQ,EAAE,CAAC,EAAED,IAAI,CAAC;;;;KAE3C;KAAA,yBAEQA,IAAI,EAAEI,KAAK,EACpB;OACC,IAAMC,KAAK,GAAG,IAAI,CAACN,WAAW,CAACO,SAAS,CAAC,UAAAC,UAAU;SAAA,OAAIA,UAAU,KAAKH,KAAK;SAAC;OAC5E,IAAIC,KAAK,KAAK,CAAC,CAAC,EAChB;SACC,IAAI,CAACG,GAAG,CAACR,IAAI,EAAEK,KAAK,GAAG,CAAC,CAAC;;;;KAE1B;KAAA,0BAESL,IAAI,EAAES,MAAM,EACtB;OACC,IAAMJ,KAAK,GAAG,IAAI,CAACN,WAAW,CAACO,SAAS,CAAC,UAAAC,UAAU;SAAA,OAAIA,UAAU,KAAKE,MAAM;SAAC;OAC7E,IAAIJ,KAAK,KAAK,CAAC,CAAC,EAChB;SACC,IAAI,CAACG,GAAG,CAACR,IAAI,EAAEK,KAAK,CAAC;;;;KAEtB;KAAA,uBAEML,IAAI,EACX;OACC,IAAMK,KAAK,GAAG,IAAI,CAACN,WAAW,CAACO,SAAS,CAAC,UAAAC,UAAU;SAAA,OAAIA,UAAU,KAAKP,IAAI;SAAC;OAC3E,IAAIK,KAAK,KAAK,CAAC,CAAC,EAChB;SACC,IAAI,CAACN,WAAW,CAACI,MAAM,CAACE,KAAK,EAAE,CAAC,CAAC;;;;KAElC;KAAA,iCAGD;OACC,OAAO,IAAI,CAACN,WAAW;;;KACvB;KAAA,sCAGD;OACC,OAAO,IAAI,CAACA,WAAW,CAACW,MAAM;;;KAC9B;KAAA,qCAGD;OACC,IAAI,IAAI,CAACX,WAAW,CAACW,MAAM,GAAG,CAAC,EAC/B;SACC,OAAO,IAAI,CAACX,WAAW,CAAC,CAAC,CAAC;;OAG3B,OAAO,KAAK;;;KACZ;KAAA,oCAGD;OACC,IAAI,IAAI,CAACA,WAAW,CAACW,MAAM,GAAG,CAAC,EAC/B;SACC,OAAO,IAAI,CAACX,WAAW,CAAC,IAAI,CAACA,WAAW,CAACW,MAAM,GAAG,CAAC,CAAC;;OAGrD,OAAO,KAAK;;;KACZ;KAAA,oCAGD;OACC,OAAQ,IAAI,KAAK,IAAI,CAACd,SAAS,EAAE,CAACe,kBAAkB,EAAE;;;KACtD;KAAA,mCAGD;OACC,OAAQ,IAAI,KAAK,IAAI,CAACf,SAAS,EAAE,CAACgB,iBAAiB,EAAE;;;KACrD;KAAA,iCAGD;OAAA;OACC,IAAI,IAAI,CAACC,iBAAiB,EAAE,EAC5B;SACC,OAAO,IAAI;;OAGZ,IAAMC,iBAAiB,GAAG,IAAI,CAAClB,SAAS,EAAE,CAACmB,cAAc,EAAE;OAC3D,IAAMV,KAAK,GAAGS,iBAAiB,CAACR,SAAS,CAAC,UAAAC,UAAU;SAAA,OAAIA,UAAU,KAAK,MAAI;SAAC;OAE5E,IAAIF,KAAK,KAAK,CAAC,CAAC,EAChB;SACC,OAAOS,iBAAiB,CAACT,KAAK,GAAG,CAAC,CAAC;;OAGpC,OAAO,IAAI;;;KACX;KAAA,kCAGD;OAAA;OACC,IAAI,IAAI,CAACW,gBAAgB,EAAE,EAC3B;SACC,OAAO,IAAI;;OAGZ,IAAMF,iBAAiB,GAAG,IAAI,CAAClB,SAAS,EAAE,CAACmB,cAAc,EAAE;OAC3D,IAAMV,KAAK,GAAGS,iBAAiB,CAACR,SAAS,CAAC,UAAAC,UAAU;SAAA,OAAIA,UAAU,KAAK,MAAI;SAAC;OAE5E,IAAIF,KAAK,KAAK,CAAC,CAAC,EAChB;SACC,OAAOS,iBAAiB,CAACT,KAAK,GAAG,CAAC,CAAC;;OAGpC,OAAO,IAAI;;;KACX;KAAA,wCAGD;OACC,IAAI,IAAI,KAAK,IAAI,CAACY,WAAW,EAAE,EAC/B;SACC,OAAO,IAAI;;OAGZ,IAAI,IAAI,CAACJ,iBAAiB,EAAE,EAC5B;SACC,OAAO,IAAI,CAACjB,SAAS,EAAE;;OAGxB,IAAIsB,kBAAkB,GAAG,IAAI,CAACC,cAAc,EAAE;OAC9C,OAAOD,kBAAkB,IAAIA,kBAAkB,CAACE,mBAAmB,EAAE,GAAG,CAAC,EACzE;SACCF,kBAAkB,GAAGA,kBAAkB,CAACN,iBAAiB,EAAE;;OAG5D,OAAOM,kBAAkB;;;KACzB;KAAA,yCAGD;OACC,IAAI,IAAI,CAACE,mBAAmB,EAAE,GAAG,CAAC,EAClC;SACC,OAAO,IAAI,CAACT,kBAAkB,EAAE;;OAGjC,IAAI,CAAC,IAAI,CAACK,gBAAgB,EAAE,EAC5B;SACC,OAAO,IAAI,CAACK,eAAe,EAAE;;OAG9B,IAAI1B,MAAM,GAAG,IAAI;OACjB,OAAOA,MAAM,CAACC,SAAS,EAAE,KAAK,IAAI,IAAID,MAAM,CAACqB,gBAAgB,EAAE,EAC/D;SACCrB,MAAM,GAAGA,MAAM,CAACC,SAAS,EAAE;;OAG5B,IAAID,MAAM,KAAK,IAAI,CAACsB,WAAW,EAAE,EACjC;SACC,OAAOtB,MAAM,CAAC0B,eAAe,EAAE;;OAGhC,OAAO,IAAI;;;KACX;KAAA,0BAESxB,MAAM,EAChB;OACC,IAAI,CAACA,MAAM,EACX;SACC,OAAO,IAAI;;OAGZ,IAAI,IAAI,CAACyB,SAAS,EAAE,CAAChC,QAAQ,EAAE,KAAKO,MAAM,CAACP,QAAQ,EAAE,EACrD;SACC,OAAO,IAAI;;OAGZ,IAAIiC,KAAK,GAAG,IAAI;OAChB,IAAI,CAACxB,WAAW,CAACyB,OAAO,CAAC,UAACjB,UAAU,EAAK;SACxC,IAAIgB,KAAK,KAAK,IAAI,EAClB;WACCA,KAAK,GAAGhB,UAAU,CAACkB,SAAS,CAAC5B,MAAM,CAAC;;QAErC,CAAC;OAEF,OAAO0B,KAAK;;;KACZ;KAAA,gCAGD;OACC,IAAIG,IAAI,GAAG,IAAI,CAACN,mBAAmB,EAAE;OAErC,IAAI,CAACrB,WAAW,CAACyB,OAAO,CAAC,UAACjB,UAAU,EAAK;SACxCmB,IAAI,IAAInB,UAAU,CAACoB,aAAa,EAAE;QAClC,CAAC;OAEF,OAAOD,IAAI;;;KACX;KAAA,8BAGD;OACC,OAAO,IAAI,CAACT,WAAW,EAAE,CAACU,aAAa,EAAE,GAAG,CAAC;;;GAC7C;CAAA,EAjN8BxC,QAAQ;;CCFH,IAE/ByC,mBAAmB;GAAA;KAAA;KAAA,iCAEAC,MAAM,EAC9B;OACC,IAAIC,eAAe,GAAGD,MAAM;OAE5B,IAAIE,cAAI,CAACC,QAAQ,CAACF,eAAe,CAAC,EAClC;SACCA,eAAe,GAAGA,eAAe,CAACG,WAAW,EAAE;SAC/CH,eAAe,GAAGA,eAAe,CAACI,OAAO,CAAC,cAAc,EAAE,UAACC,KAAK,EAAEC,GAAG;WAAA,OAAMA,GAAG,GAAGA,GAAG,CAACC,WAAW,EAAE,GAAG,EAAE;UAAC,CAAC;SAEzG,OAAOP,eAAe,CAACvC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC0C,WAAW,EAAE,GAAGH,eAAe,CAACvC,MAAM,CAAC,CAAC,CAAC;;OAG9E,OAAOuC,eAAe;;;KACtB;KAAA,iCAEuBD,MAAM,EAC9B;OACC,IAAIS,eAAe,GAAGT,MAAM;OAE5B,IAAIE,cAAI,CAACC,QAAQ,CAACM,eAAe,CAAC,EAClC;SACCA,eAAe,GAAGA,eAAe,CAACJ,OAAO,CAAC,aAAa,EAAE,OAAO,CAAC,CAACG,WAAW,EAAE;;OAGhF,OAAOC,eAAe;;;GAGvB,6BAAYC,MAAM,EAClB;KAAA;KACC,IAAI,CAACA,MAAM,GAAG,CACb,IAAI,EACJ,UAAU,EACV,UAAU,EACV,OAAO,EACP,WAAW,EACX,kBAAkB,EAClB,YAAY,EACZ,aAAa,EACb,YAAY,EACZ,YAAY,EACZ,gBAAgB,EAChB,YAAY,EACZ,SAAS,EACT,aAAa,CACb;KAED,IAAI,CAACC,EAAE,GAAG,IAAI;KACd,IAAI,CAACC,QAAQ,GAAG,IAAI;KACpB,IAAI,CAACC,KAAK,GAAG,EAAE;KACf,IAAI,CAACC,SAAS,GAAG,CAAC;KAClB,IAAI,CAACC,gBAAgB,GAAG,EAAE;KAC1B,IAAI,CAACC,UAAU,GAAG,KAAK;KACvB,IAAI,CAACC,WAAW,GAAG,KAAK;KACxB,IAAI,CAACC,UAAU,GAAG,KAAK;KACvB,IAAI,CAACC,UAAU,GAAG,KAAK;KACvB,IAAI,CAACC,cAAc,GAAG,CAAC;KACvB,IAAI,CAACC,UAAU,GAAG,CAAC;KACnB,IAAI,CAACC,OAAO,GAAG,IAAIC,GAAG,EAAE;KACxB,IAAI,CAACC,WAAW,GAAG,EAAE;KAErB,IAAI,CAACC,SAAS,CAACf,MAAM,CAAC;;GACtB;KAAA;KAAA,0BAESA,MAAM,EAChB;OAAA;OACCgB,MAAM,CAACC,IAAI,CAACjB,MAAM,CAAC,CAACf,OAAO,CAAC,UAACiC,IAAI,EAAK;SACrC,IAAMC,aAAa,GAAG9B,mBAAmB,CAAC+B,gBAAgB,CAACF,IAAI,CAAC;SAEhE,IAAI,KAAI,CAAClB,MAAM,CAACqB,OAAO,CAACH,IAAI,CAAC,KAAK,CAAC,CAAC,EACpC;WACC,IAAMI,aAAa,GAAGjC,mBAAmB,CAACkC,gBAAgB,CAACL,IAAI,CAAC;WAChE,IAAMM,SAAS,GAAG,KAAI,CAACnC,mBAAmB,CAAC+B,gBAAgB,eAAQE,aAAa,EAAG,CAAC,CAACG,IAAI,CAAC,KAAI,CAAC;WAC/FD,SAAS,CAACxB,MAAM,CAACkB,IAAI,CAAC,CAAC;UACvB,MACI,IAAI,KAAI,CAAClB,MAAM,CAACqB,OAAO,CAACF,aAAa,CAAC,KAAK,CAAC,CAAC,EAClD;WACC,IAAMK,UAAS,GAAG,KAAI,CAACnC,mBAAmB,CAAC+B,gBAAgB,eAAQF,IAAI,EAAG,CAAC,CAACO,IAAI,CAAC,KAAI,CAAC;WACtFD,UAAS,CAACxB,MAAM,CAACkB,IAAI,CAAC,CAAC;;QAExB,CAAC;;;KACF;KAAA,wBAGD;OACC,OAAO,IAAI,CAACjB,EAAE;;;KACd;KAAA,sBAEKA,EAAE,EACR;OACC,IAAI,CAACA,EAAE,GAAGA,EAAE;;;KACZ;KAAA,8BAGD;OACC,OAAO,IAAI,CAACyB,QAAQ;;;KACpB;KAAA,4BAEWA,QAAQ,EACpB;OACC,IAAI,CAACA,QAAQ,GAAGA,QAAQ;;;KACxB;KAAA,8BAGD;OACC,OAAO,IAAI,CAACxB,QAAQ;;;KACpB;KAAA,4BAEWA,QAAQ,EACpB;OACC,IAAI,CAACA,QAAQ,GAAGA,QAAQ;;;KACxB;KAAA,2BAGD;OACC,OAAO,IAAI,CAACC,KAAK;;;KACjB;KAAA,yBAEQA,KAAK,EACd;OACC,IAAI,CAACA,KAAK,GAAGwB,cAAI,CAACC,MAAM,CAACzB,KAAK,CAAC;;;KAC/B;KAAA,+BAGD;OACC,OAAO,IAAI,CAACC,SAAS;;;KACrB;KAAA,6BAEYA,SAAS,EACtB;OACC,IAAI,CAACA,SAAS,GAAGA,SAAS;;;KAC1B;KAAA,sCAGD;OACC,OAAO,IAAI,CAACC,gBAAgB;;;KAC5B;KAAA,oCAEmBA,gBAAgB,EACpC;OACC,IAAI,CAACA,gBAAgB,GAAGA,gBAAgB;;;KACxC;KAAA,gCAGD;OACC,OAAO,IAAI,CAACC,UAAU;;;KACtB;KAAA,8BAEaA,UAAU,EACxB;OACC,IAAI,CAACA,UAAU,GAAGA,UAAU;;;KAC5B;KAAA,iCAGD;OACC,OAAO,IAAI,CAACC,WAAW;;;KACvB;KAAA,+BAEcA,WAAW,EAC1B;OACC,IAAI,CAACA,WAAW,GAAGA,WAAW;;;KAC9B;KAAA,gCAGD;OACC,OAAO,IAAI,CAACC,UAAU;;;KACtB;KAAA,8BAEaA,UAAU,EACxB;OACC,IAAI,CAACA,UAAU,GAAGA,UAAU;;;KAC5B;KAAA,gCAGD;OACC,OAAO,IAAI,CAACC,UAAU;;;KACtB;KAAA,8BAEaA,UAAU,EACxB;OACC,IAAI,CAACA,UAAU,GAAGA,UAAU;;;KAC5B;KAAA,oCAGD;OACC,OAAO,IAAI,CAACC,cAAc;;;KAC1B;KAAA,kCAEiBA,cAAc,EAChC;OACC,IAAI,CAACA,cAAc,GAAGA,cAAc;;;KACpC;KAAA,gCAGD;OACC,OAAO,IAAI,CAACC,UAAU;;;KACtB;KAAA,8BAEaA,UAAU,EACxB;OACC,IAAI,CAACA,UAAU,GAAGA,UAAU;;;KAC5B;KAAA,6BAGD;OACC,OAAO,IAAI,CAACC,OAAO;;;KACnB;KAAA,2BAEUA,OAAO,EAClB;OAAA;OACC,IAAMiB,KAAK,GAAG;SACbC,CAAC,EAAE,YAAY;SACfC,CAAC,EAAE;QACH;OAED,IAAI,CAACnB,OAAO,CAACoB,KAAK,EAAE;OAEpBhB,MAAM,CAACC,IAAI,CAACL,OAAO,CAAC,CAAC3B,OAAO,CAAC,UAACgB,EAAE,EAAK;SACpC,kBAAoCW,OAAO,CAACX,EAAE,CAAC;WAAvCgC,IAAI,eAAJA,IAAI;WAAEC,IAAI,eAAJA,IAAI;WAAEC,WAAW,eAAXA,WAAW;SAC/B,MAAI,CAACvB,OAAO,CAACwB,GAAG,CAACnC,EAAE,EAAE;WAAEA,EAAE,EAAFA,EAAE;WAAEoC,aAAa,EAAEV,cAAI,CAACC,MAAM,CAACK,IAAI,CAAC;WAAEK,IAAI,EAAET,KAAK,CAACK,IAAI,CAAC;WAAEK,UAAU,EAAEJ;UAAa,CAAC;QAC1G,CAAC;;;KACF;KAAA,0BAESK,MAAM,EAChB;OACC,IAAI,CAAC5B,OAAO,CAACwB,GAAG,CAACI,MAAM,CAACvC,EAAE,EAAEuC,MAAM,CAAC;;;KACnC;KAAA,6BAEYvC,EAAE,EACf;OACC,IAAI,CAACW,OAAO,UAAO,CAACX,EAAE,CAAC;;;KACvB;KAAA,iCAGD;OACC,OAAO,IAAI,CAACa,WAAW;;;KACvB;KAAA,+BAEcA,WAAW,EAC1B;OACC,IAAI,CAACA,WAAW,GAAGA,WAAW;;;KAC9B;KAAA,+BAEcA,WAAW,EAC1B;OAAA;OACCE,MAAM,CAACC,IAAI,CAACH,WAAW,CAAC,CAAC7B,OAAO,CAAC,UAACgB,EAAE,EAAK;SACxC,MAAI,CAACa,WAAW,CAACb,EAAE,CAAC,GAAGa,WAAW,CAACb,EAAE,CAAC;QACtC,CAAC;;;KACF;KAAA,iCAEgBA,EAAE,EACnB;OACC,OAAO,IAAI,CAACa,WAAW,CAACb,EAAE,CAAC;;;GAC3B;CAAA;;;;;AChQF,KASMwC,aAAa;GAAA;GAAA;KAAA;KAAA,mCA8BQC,OAAO,EACjC;OACC,IAAMC,WAAW,GAAG,eAAe;OAEnC,IAAI,CAACC,aAAG,CAACC,QAAQ,CAACH,OAAO,EAAEC,WAAW,CAAC,EACvC;SACCC,aAAG,CAACE,QAAQ,CAACJ,OAAO,EAAEC,WAAW,CAAC;;;;KAEnC;KAAA,8BAEoBI,SAAS,EAAEC,SAAS,EACzC;OACC,IAAID,SAAS,KAAKC,SAAS,EAC3B;SACCD,SAAS,CAACE,YAAY,EAAE;SACxBD,SAAS,CAACC,YAAY,EAAE;SAExBF,SAAS,CAACG,cAAc,EAAE;SAC1BF,SAAS,CAACE,cAAc,EAAE;SAE1BH,SAAS,CAACI,aAAa,EAAE;SACzBH,SAAS,CAACG,aAAa,EAAE;QACzB,MAED;SACCH,SAAS,CAACG,aAAa,EAAE;;;;KAE1B;KAAA,gCAEsBC,SAAS,EAAEC,KAAK,EACvC;OACC,IAAMC,QAAQ,GAAG;SAChB,SAAS,EAAED,KAAK;SAChB,aAAa,EAAED;QACf;OACD,IAAIG,YAAY,GAAGC,aAAG,CAACC,UAAU,CAAC,4CAA4C,CAAC;OAE/EzC,MAAM,CAACC,IAAI,CAACqC,QAAQ,CAAC,CAACrE,OAAO,CAAC,UAACyE,MAAM,EAAK;SACzCH,YAAY,GAAGA,YAAY,CAAC5D,OAAO,CAAC+D,MAAM,EAAEJ,QAAQ,CAACI,MAAM,CAAC,CAAC;QAC7D,CAAC;OAEF,OAAOH,YAAY;;;KACnB;KAAA,iCAEuBI,GAAG,EAC3B;OACC,IAAIC,aAAa;OAEjB,QAAQD,GAAG;SAEV,KAAK,KAAK;SACV,KAAK,KAAK;SACV,KAAK,MAAM;SACX,KAAK,KAAK;SACV,KAAK,KAAK;SACV,KAAK,KAAK;SACV,KAAK,KAAK;SACV,KAAK,KAAK;SACV,KAAK,KAAK;SACV,KAAK,KAAK;WACTC,aAAa,GAAG,KAAK;WACrB;SAED,KAAK,KAAK;WACTA,aAAa,GAAG,KAAK;WACrB;SAED,KAAK,KAAK;SACV,KAAK,MAAM;WACVA,aAAa,GAAG,KAAK;WACrB;SAED,KAAK,KAAK;SACV,KAAK,MAAM;WACVA,aAAa,GAAG,KAAK;WACrB;SAED,KAAK,KAAK;WACTA,aAAa,GAAG,KAAK;WACrB;SAED,KAAK,KAAK;WACTA,aAAa,GAAG,KAAK;WACrB;SAED,KAAK,KAAK;SACV,KAAK,MAAM;WACVA,aAAa,GAAG,KAAK;WACrB;SAED,KAAK,KAAK;WACTA,aAAa,GAAG,KAAK;WACrB;SAED,KAAK,KAAK;WACTA,aAAa,GAAG,KAAK;WACrB;SAED,KAAK,KAAK;WACTA,aAAa,GAAG,KAAK;WACrB;SAED,KAAK,KAAK;WACTA,aAAa,GAAG,KAAK;WACrB;SAED,KAAK,KAAK;SACV,KAAK,KAAK;SACV,KAAK,MAAM;SACX,KAAK,KAAK;WACTA,aAAa,GAAG,KAAK;WACrB;SAED;WACCA,aAAa,GAAG,OAAO;WACvB;;OAGF,OAAOA,aAAa;;;KACpB;KAAA,kCAEwBC,KAAK,EAC9B;OACC,IAAIC,KAAK,GAAG,CAAC;OACb,IAAIC,GAAG,GAAG,CAAC;OACX,IAAIC,eAAe;OACnB,IAAIC,KAAK;OACT,IAAIC,cAAc;OAClB,IAAIC,GAAG;OACP,IAAIC,QAAQ;OAEZ,IAAI,OAAOP,KAAK,CAACQ,cAAc,KAAK,QAAQ,IAAI,OAAOR,KAAK,CAACS,YAAY,KAAK,QAAQ,EACtF;SACCR,KAAK,GAAGD,KAAK,CAACQ,cAAc;SAC5BN,GAAG,GAAGF,KAAK,CAACS,YAAY;QACxB,MAED;SACCL,KAAK,GAAGM,QAAQ,CAACC,SAAS,CAACC,WAAW,EAAE;SAExC,IAAIR,KAAK,IAAIA,KAAK,CAACS,aAAa,EAAE,KAAKb,KAAK,EAC5C;WACCM,GAAG,GAAGN,KAAK,CAACc,KAAK,CAACxG,MAAM;WACxB6F,eAAe,GAAGH,KAAK,CAACc,KAAK,CAAChF,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC;;;WAGpDuE,cAAc,GAAGL,KAAK,CAACe,eAAe,EAAE;WACxCV,cAAc,CAACW,cAAc,CAACZ,KAAK,CAACa,WAAW,EAAE,CAAC;;;;;WAKlDV,QAAQ,GAAGP,KAAK,CAACe,eAAe,EAAE;WAClCR,QAAQ,CAACW,QAAQ,CAAC,KAAK,CAAC;WAExB,IAAIb,cAAc,CAACc,gBAAgB,CAAC,YAAY,EAAEZ,QAAQ,CAAC,GAAG,CAAC,CAAC,EAChE;aACCN,KAAK,GAAGK,GAAG;aACXJ,GAAG,GAAGI,GAAG;YACT,MAED;aACCL,KAAK,GAAG,CAACI,cAAc,CAACe,SAAS,CAAC,WAAW,EAAE,CAACd,GAAG,CAAC;aACpDL,KAAK,IAAIE,eAAe,CAACkB,KAAK,CAAC,CAAC,EAAEpB,KAAK,CAAC,CAACqB,KAAK,CAAC,IAAI,CAAC,CAAChH,MAAM,GAAG,CAAC;aAE/D,IAAI+F,cAAc,CAACc,gBAAgB,CAAC,UAAU,EAAEZ,QAAQ,CAAC,GAAG,CAAC,CAAC,EAC9D;eACCL,GAAG,GAAGI,GAAG;cACT,MAED;eACCJ,GAAG,GAAG,CAACG,cAAc,CAACkB,OAAO,CAAC,WAAW,EAAE,CAACjB,GAAG,CAAC;eAChDJ,GAAG,IAAIC,eAAe,CAACkB,KAAK,CAAC,CAAC,EAAEnB,GAAG,CAAC,CAACoB,KAAK,CAAC,IAAI,CAAC,CAAChH,MAAM,GAAG,CAAC;;;;;OAM/D,OAAO;SAAE2F,KAAK,EAALA,KAAK;SAAEC,GAAG,EAAHA;QAAK;;;KACrB;KAAA,yCAE+B5D,KAAK,EACrC;OACC,IAAIkF,YAAY,GAAGlF,KAAK;OAExB,IAAIA,KAAK,CAACkB,OAAO,CAAC,cAAc,CAAC,KAAK,CAAC,EACvC;SACC,IAAIlB,KAAK,KAAK,cAAc,EAC5B;WACCkF,YAAY,GAAG7B,aAAG,CAACC,UAAU,CAAC,yCAAyC,CAAC;UACxE,MACI,IAAItD,KAAK,CAACP,KAAK,CAAC,mBAAmB,CAAC,EACzC;WACC,IAAM0F,UAAU,GAAGnF,KAAK,CAACR,OAAO,CAAC,eAAe,EAAE,EAAE,CAAC;WACrD0F,YAAY,GAAG7B,aAAG,CAACC,UAAU,CAAC,mDAAmD,CAAC,CAAC9D,OAAO,CACzF,eAAe,EACf2F,UAAU,CACV;;;OAIH,OAAOD,YAAY;;;KACnB;KAAA,6BAEmBE,IAAI,EACxB;OACC,IAAMC,OAAO,GAAGC,EAAE,CAACC,kBAAkB,EAAE,CAACC,SAAS;OACjD,IAAMC,KAAK,GAAGH,EAAE,CAACI,GAAG,CAACN,IAAI,CAAC,CAACO,GAAG,GAAGjJ,IAAI,CAACkJ,KAAK,CAACN,EAAE,CAACO,kBAAkB,EAAE,CAACC,WAAW,GAAG,CAAC,CAAC;OACpF,IAAMC,QAAQ,GAAGV,OAAO,GAAGI,KAAK;OAChC,IAAMO,QAAQ,GAAGtJ,IAAI,CAACuJ,GAAG,CAACR,KAAK,GAAGJ,OAAO,CAAC;OAC1C,IAAMa,KAAK,GAAIxJ,IAAI,CAACkJ,KAAK,CAACI,QAAQ,GAAG,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAGtJ,IAAI,CAACkJ,KAAK,CAACI,QAAQ,GAAG,GAAG,CAAE;OACjF,IAAMG,IAAI,GAAGD,KAAK,GAAG,CAAC;OAEtB,IAAIC,IAAI,IAAI,CAAC,EACb;SACC;;OAGD,IAAIC,UAAU,GAAIL,QAAQ,GAAGV,OAAO,GAAGc,IAAI,GAAGd,OAAO,GAAGc,IAAK;OAC7D,IAAIE,KAAK,GAAG,CAAC;OAEb,IAAIN,QAAQ,EACZ;SACC,KAAK,IAAIO,CAAC,GAAGjB,OAAO,EAAEiB,CAAC,GAAGb,KAAK,EAAEa,CAAC,IAAIH,IAAI,EAC1C;WACCI,UAAU,8BAAuBH,UAAU,QAAKC,KAAK,GAAGH,KAAK,CAAC;WAE9DE,UAAU,IAAID,IAAI;WAClB,IAAIC,UAAU,GAAGX,KAAK,EACtB;aACCW,UAAU,GAAGX,KAAK;;WAEnBY,KAAK,IAAI,CAAC;;QAEX,MAED;SACC,KAAK,IAAIC,EAAC,GAAGjB,OAAO,EAAEiB,EAAC,GAAGb,KAAK,EAAEa,EAAC,IAAIH,IAAI,EAC1C;WACCI,UAAU,8BAAuBH,UAAU,QAAKC,KAAK,GAAGH,KAAK,CAAC;WAE9DE,UAAU,IAAID,IAAI;WAClB,IAAIC,UAAU,GAAGX,KAAK,EACtB;aACCW,UAAU,GAAGX,KAAK;;WAEnBY,KAAK,IAAI,CAAC;;;;;KAGZ;KAAA,oCAE0BlE,IAAI,EAAEpB,IAAI,EAAEyF,GAAG,EAAEpE,UAAU,EACtD;OACC,IAAMqE,SAAS,6BAAsBtE,IAAI,CAACxC,WAAW,EAAE,eAAY;OACnE,gHAEmCwC,IAAI,6BAAiBkB,aAAG,CAACC,UAAU,CAACmD,SAAS,CAAC,wCACpED,GAAG,6CAAiCrE,IAAI,mBAASC,UAAU,GAAG,+BAA+B,GAAG,EAAE,gBAAKrB,IAAI;;;KAGxH;KAAA,8BAEoByF,GAAG,EACxB;OACC,+DAAqDA,GAAG,kCAAqBA,GAAG;;;KAChF;KAAA,oBAGD;OACC,OAAO;SACNE,GAAG,EAAE,EAAE;SACPC,KAAK,EAAE,EAAE;SACTC,IAAI,EAAE,EAAE;SACRC,MAAM,EAAE,EAAE;SACVC,GAAG,EAAE,CAAC;SACNC,EAAE,EAAE,EAAE;SACNC,IAAI,EAAE,EAAE;SACRC,SAAS,EAAE;QACX;;;GAGF,yBACA;KAAA;KAAA,IADYpH,MAAM,uEAAG,EAAE;KAAA;KAEtB,IAAQqH,MAAM,GAAKrH,MAAM,CAAjBqH,MAAM;KAEd;KAAQ,gFAzTD5E,aAAa;KAAA,uFAEN,6BAA6B;KAAA,sFAC9B,6BAA6B;KAAA,wFAC3B,0BAA0B;KAAA,uFAC3B,+BAA+B;KAAA,oFAElC,2BAA2B;KAAA,oFAC3B,2BAA2B;KAAA,4FAEnB;OACnB6E,MAAM,EAAE,CACP,+BAA+B,EAC/B,kCAAkC,EAClC,4BAA4B,CAC5B;OACD7J,IAAI,EAAE,CACL,+BAA+B,EAC/B,kCAAkC,EAClC,4BAA4B,EAC5B,iCAAiC,EACjC,iCAAiC,EACjC,sCAAsC,EACtC,8BAA8B,EAC9B,kCAAkC;MAEnC;KAgSA,MAAKuC,MAAM,GAAG,IAAIX,mBAAmB,CAACW,MAAM,CAAC;KAC7C,MAAKqH,MAAM,GAAG;OACbE,SAAS,EAAGF,MAAM,IAAI,QAAQ,IAAIA,MAAM,GAAIA,MAAM,CAACG,MAAM,GAAG,IAAI;OAChEC,SAAS,EAAGJ,MAAM,IAAI,QAAQ,IAAIA,MAAM,GAAIA,MAAM,CAACK,MAAM,GAAG,IAAI;OAChEC,SAAS,EAAGN,MAAM,IAAI,QAAQ,IAAIA,MAAM,GAAIA,MAAM,CAACO,MAAM,GAAG,IAAI;OAChEC,OAAO,EAAGR,MAAM,IAAI,MAAM,IAAIA,MAAM,GAAIA,MAAM,CAACS,IAAI,GAAG;MACtD;KAED,MAAKjE,KAAK,GAAG,IAAI;KACjB,MAAKkE,KAAK,GAAG,IAAI;KACjB,MAAKC,QAAQ,GAAG,IAAI;KACpB,MAAKC,gBAAgB,GAAG,IAAI;KAC5B,MAAKC,uBAAuB,GAAG,IAAIrH,GAAG,EAAE;KACxC,MAAKsH,UAAU,GAAG,KAAK;KAAC;;GACxB;KAAA;KAAA,oBAEG1K,IAAI,EACR;OAAA,IADUC,QAAQ,uEAAG,IAAI;OAExB,+FAAUD,IAAI,EAAEC,QAAQ;OAExBD,IAAI,CAAC2K,aAAa,GAAG,IAAI,CAACA,aAAa;OACvC3K,IAAI,CAAC4K,iBAAiB,GAAG,IAAI,CAACA,iBAAiB;;;KAC/C;KAAA,6BAGD;OACC,OAAO,IAAI,CAACtJ,SAAS,EAAE,KAAK,CAAC,IAAI,IAAI,CAAC1B,SAAS,EAAE,KAAK,IAAI;;;KAC1D;KAAA,8BAGD;OACC,OAAO,CAAC,IAAI,CAACiL,UAAU,EAAE,IAAI,IAAI,CAACjL,SAAS,EAAE,CAACiL,UAAU,EAAE;;;KAC1D;KAAA,+BAGD;OACC,IAAIlL,MAAM,GAAG,IAAI;OAEjB,OAAO,CAACA,MAAM,CAACC,SAAS,EAAE,CAACiL,UAAU,EAAE,EACvC;SACClL,MAAM,GAAGA,MAAM,CAACC,SAAS,EAAE;;OAG5B,OAAOD,MAAM;;;KACb;KAAA,yBAEQ6C,EAAE,EACX;OACC,IAAI,CAACA,EAAE,EACP;SACC,OAAO,IAAI;;OAGZ,IAAI,IAAI,CAACD,MAAM,CAACuI,KAAK,EAAE,IAAI,IAAI,CAACvI,MAAM,CAACuI,KAAK,EAAE,CAACxL,QAAQ,EAAE,KAAKkD,EAAE,CAAClD,QAAQ,EAAE,EAC3E;SACC,OAAO,IAAI;;OAGZ,IAAIiC,KAAK,GAAG,IAAI;OAChB,IAAI,CAACR,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7C,IAAIgB,KAAK,KAAK,IAAI,EAClB;WACCA,KAAK,GAAGhB,UAAU,CAACwK,QAAQ,CAACvI,EAAE,CAAC;;QAEhC,CAAC;OAEF,OAAOjB,KAAK;;;KACZ;KAAA,sCAGD;OAAA,IADoByJ,WAAW,uEAAG,KAAK;OAEtC,IAAI/H,cAAc,GAAG,CAAC;OAEtB,IAAI,CAAClC,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7C,IAAIA,UAAU,CAACgC,MAAM,CAAC0I,aAAa,EAAE,EACrC;WACChI,cAAc,IAAI,CAAC;;SAGpB,IAAI+H,WAAW,EACf;WACC/H,cAAc,IAAI1C,UAAU,CAAC2K,mBAAmB,CAACF,WAAW,CAAC;;QAE9D,CAAC;OAEF,OAAO/H,cAAc;;;KACrB;KAAA,kCAGD;OAAA,IADgB+H,WAAW,uEAAG,KAAK;OAElC,IAAI9H,UAAU,GAAG,CAAC;OAElB,IAAI,CAAC8H,WAAW,EAChB;SACC9H,UAAU,GAAG,IAAI,CAAC9B,mBAAmB,EAAE;QACvC,MAED;SACC,IAAI,CAACL,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;WAC7C2C,UAAU,IAAI,CAAC;WACfA,UAAU,IAAI3C,UAAU,CAAC4K,eAAe,CAACH,WAAW,CAAC;UACrD,CAAC;;OAGH,OAAO9H,UAAU;;;KACjB;KAAA,uCAGD;OACC,IAAMD,cAAc,GAAG,IAAI,CAACiI,mBAAmB,EAAE;OACjD,IAAI,CAAC3I,MAAM,CAAC6I,iBAAiB,CAACnI,cAAc,CAAC;;;KAC7C;KAAA,mCAGD;OACC,IAAMC,UAAU,GAAG,IAAI,CAACiI,eAAe,EAAE;OACzC,IAAI,CAAC5I,MAAM,CAAC8I,aAAa,CAACnI,UAAU,CAAC;;;KACrC;KAAA,+BAGD;OACC,IAAI,CAACoI,oBAAoB,EAAE;OAC3B,IAAI,CAACC,gBAAgB,EAAE;;;KACvB;KAAA,iCAGD;OACC,IAAI,IAAI,CAAChB,QAAQ,KAAK,IAAI,EAC1B;SACC;;OAGD,IAAM3E,KAAK,GAAG,IAAI,CAACrD,MAAM,CAACiJ,aAAa,EAAE;OACzC,IAAM7F,SAAS,GAAG,IAAI,CAACpD,MAAM,CAACkJ,iBAAiB,EAAE;OAEjD,IAAI,CAAClB,QAAQ,CAACmB,WAAW,CAAC9F,KAAK,CAAC;OAChC,IAAI,CAAC2E,QAAQ,CAACoB,MAAM,CAAChG,SAAS,CAAC;OAE/B,IAAI,IAAI,CAACiG,WAAW,EAAE,EACtB;SACC,IAAI,CAACC,kBAAkB,CAAClG,SAAS,EAAEC,KAAK,CAAC;;;;KAE1C;KAAA,mCAEkBD,SAAS,EAAEC,KAAK,EACnC;OACC,IAAME,YAAY,GAAGd,aAAa,CAAC8G,eAAe,CAACnG,SAAS,EAAEC,KAAK,CAAC;OACpE,IAAI,CAAC2E,QAAQ,CAACwB,YAAY,CAACjG,YAAY,CAAC;;;KACxC;KAAA,iCAEgBkG,MAAM,EACvB;OAAA,IADyBpC,MAAM,uEAAG,KAAK;OAEtC,IAAIA,MAAM,KAAK,KAAK,EACpB;SACCoC,MAAM,CAACC,KAAK,CAACC,QAAQ,GAAG,QAAQ;SAChCF,MAAM,CAACC,KAAK,CAACE,MAAM,GAAG,CAAC;SACvBH,MAAM,CAACC,KAAK,CAACG,OAAO,GAAG,CAAC;SAExBjH,aAAG,CAACE,QAAQ,CAAC2G,MAAM,EAAE,IAAI,CAACK,SAAS,CAAC;QACpC,MACI,IAAIzC,MAAM,KAAK,QAAQ,EAC5B;SACCoC,MAAM,CAACC,KAAK,CAACC,QAAQ,GAAG,QAAQ;SAChCF,MAAM,CAACC,KAAK,CAACE,MAAM,aAAMH,MAAM,CAACM,YAAY,OAAI;SAChDN,MAAM,CAACC,KAAK,CAACG,OAAO,GAAG,CAAC;SAExBjH,aAAG,CAACE,QAAQ,CAAC2G,MAAM,EAAE,IAAI,CAACO,SAAS,CAAC;;;;KAErC;KAAA,0BAGD;OAAA;OACC,IAAM5M,MAAM,GAAG,IAAI,CAACC,SAAS,EAAE;OAE/BD,MAAM,CAAC6M,MAAM,CAAC,IAAI,CAAC;OACnB7M,MAAM,CAAC6F,YAAY,EAAE;OACrB7F,MAAM,CAAC8F,cAAc,EAAE;OAEvB,IAAI,CAACgH,gBAAgB,CAAC,IAAI,CAACC,SAAS,EAAE,QAAQ,CAAC;OAE/CzD,UAAU,CAAC,YAAM;SAChB,MAAI,CAACyD,SAAS,CAACT,KAAK,CAACE,MAAM,GAAG,CAAC;SAC/B,MAAI,CAACO,SAAS,CAACT,KAAK,CAACG,OAAO,GAAG,CAAC;SAChC,MAAI,CAACM,SAAS,CAACT,KAAK,CAACU,UAAU,GAAG,CAAC;QACnC,EAAE,CAAC,CAAC;OAEL1D,UAAU,CAAC,YAAM;SAChB9D,aAAG,CAACqH,MAAM,CAAC,MAAI,CAACE,SAAS,CAAC;QAC1B,EAAE,GAAG,CAAC;;;KACP;KAAA,0BAGD;OACC,IAAM/M,MAAM,GAAG,IAAI,CAACC,SAAS,EAAE;OAC/B,IAAMK,QAAQ,GAAG,IAAI,CAACsC,MAAM,CAACqK,YAAY,EAAE;OAE3C,IAAI3M,QAAQ,KAAK,CAAC,EAClB;SACC,IAAIN,MAAM,CAACyB,mBAAmB,EAAE,GAAG,CAAC,EACpC;WACCzB,MAAM,CAACkN,gBAAgB,CAAC,IAAI,EAAElN,MAAM,CAACgB,kBAAkB,EAAE,EAAE,QAAQ,CAAC;UACpE,MAED;WACChB,MAAM,CAACkN,gBAAgB,CAAC,IAAI,CAAC;;QAE9B,MAED;SACClN,MAAM,CAACkN,gBAAgB,CAAC,IAAI,EAAElN,MAAM,CAACoB,cAAc,EAAE,CAACd,QAAQ,GAAG,CAAC,CAAC,CAAC;;;;KAErE;KAAA,+BAGD;OAAA,IADa6M,WAAW,uEAAG,IAAI;OAE9B,IAAMpK,KAAK,GAAG,IAAI,CAACH,MAAM,CAACwK,QAAQ,EAAE;OAEpC,IAAI,UAAO,EAAE;OAEb,IAAID,WAAW,IAAIpK,KAAK,CAAChC,MAAM,GAAG,CAAC,IAAIgC,KAAK,KAAK,EAAE,EACnD;SACC,IAAMkH,MAAM,GAAG,QAAQ;SACvB,IAAMoD,IAAI,GAAG;WACZnI,IAAI,EAAE,IAAI,CAAC+G,WAAW,EAAE,GAAG,WAAW,GAAG;UACzC;SAED,IAAI,CAACqB,sBAAsB,CAACrD,MAAM,EAAEoD,IAAI,CAAC;;OAG1CE,6BAAY,CAACC,IAAI,CAAC,yCAAyC,EAAE;SAAEvD,MAAM,EAAE;QAAU,CAAC;OAElF,IAAI,CAACxD,KAAK,GAAG,IAAI;OACjB,IAAI,CAACsE,UAAU,GAAG,KAAK;;;KACvB;KAAA,8BAEa0C,CAAC,EACf;OACCA,CAAC,CAACC,cAAc,EAAE;OAElBlI,aAAG,CAACmI,IAAI,CAAC,IAAI,CAACrM,WAAW,EAAE,CAACqJ,KAAK,CAAC;OAElC,IAAI,IAAI,CAACiD,kBAAkB,EAAE,EAC7B;SACC,IAAMC,KAAK,GAAG,IAAI,CAACC,gBAAgB,EAAE;SACrC,IAAM7D,MAAM,GAAG,iBAAiB;SAChC,IAAMoD,IAAI,GAAG;WAAEQ,KAAK,EAALA;UAAO;SAEtB,IAAI,CAACE,sBAAsB,CAAC,UAAC1N,IAAI,EAAK;WACrCA,IAAI,CAACuC,MAAM,CAACoL,aAAa,CAAC,KAAK,CAAC;WAChC3N,IAAI,CAAC4N,YAAY,CAAC,KAAK,CAAC;UACxB,CAAC;SAEFJ,KAAK,CAAChM,OAAO,CAAC,UAACxB,IAAI,EAAK;WACvBA,IAAI,CAACJ,SAAS,EAAE,CAAC8F,aAAa,EAAE;WAChC1F,IAAI,CAAC6N,sBAAsB,EAAE;UAC7B,CAAC;SAEF,IAAI,CAACZ,sBAAsB,CAACrD,MAAM,EAAEoD,IAAI,CAAC;SAEzC;;OAGD,IAAI,CAACY,YAAY,EAAE;OACnB,IAAI,CAAChO,SAAS,EAAE,CAAC8F,aAAa,EAAE;OAEhC,IAAI,CAACmI,sBAAsB,EAAE;;;KAC7B;KAAA,uCAEsBjE,MAAM,EAAEoD,IAAI,EACnC;OAAA;OACC,IAAMc,OAAO,GAAG,EAAE;OAClB,IAAIC,OAAO,GAAG,EAAE;OAEhB,QAAQnE,MAAM;SAEb,KAAK,QAAQ;WACb;aACCmE,OAAO,GAAGhI,aAAG,CAACC,UAAU,uDAAgD4D,MAAM,cAAIoD,IAAI,CAACnI,IAAI,EAAG;aAC9FiJ,OAAO,CAAC5N,IAAI,CAAC;eACZwC,KAAK,EAAEqD,aAAG,CAACC,UAAU,CAAC,6CAA6C,CAAC;eACpEgI,MAAM,EAAE;iBACPC,KAAK,EAAE,eAACC,KAAK,EAAEC,OAAO,EAAK;mBAC1BA,OAAO,CAACC,KAAK,EAAE;mBAEf,MAAI,CAACC,OAAO,EAAE;mBACd,MAAI,CAACR,sBAAsB,EAAE;mBAC7B,MAAI,CAACS,iBAAiB,EAAE;;;cAG1B,CAAC;aACF;;SAGD,KAAK,iBAAiB;WACtB;aACCP,OAAO,GAAGhI,aAAG,CAACC,UAAU,uDAAgD4D,MAAM,YAAS;aACvFkE,OAAO,CAAC5N,IAAI,CAAC;eACZwC,KAAK,EAAEqD,aAAG,CAACC,UAAU,CAAC,6CAA6C,CAAC;eACpEgI,MAAM,EAAE;iBACPC,KAAK,EAAE,eAACC,KAAK,EAAEC,OAAO,EAAK;mBAC1BA,OAAO,CAACC,KAAK,EAAE;mBAEfpB,IAAI,CAACQ,KAAK,CAAChM,OAAO,CAAC,UAACxB,IAAI,EAAK;qBAC5BA,IAAI,CAACqO,OAAO,EAAE;qBACdrO,IAAI,CAAC6N,sBAAsB,EAAE;oBAC7B,CAAC;mBAEF,MAAI,CAACS,iBAAiB,EAAE;;;cAG1B,CAAC;aACF;;SAGD,KAAK,eAAe;SACpB,KAAK,kBAAkB;WACvB;aACC,IAAIC,KAAK,GAAG,EAAE;aACd,IAAIvB,IAAI,CAACwB,MAAM,EACf;eACCD,KAAK,GAAGE,aAAG,CAACC,MAAM,kMACmDC,SAAS,CAAC3B,IAAI,CAACwB,MAAM,CAAC,CAC1F;;aAEFT,OAAO,GAAGU,aAAG,CAACC,MAAM,uaAGfH,KAAK,EAGLxI,aAAG,CAACC,UAAU,uDAAgD4D,MAAM,EAAG,CAG3E;aACD;;SAGD;WACA;aACC;;;OAIF5B,EAAE,CAAC4G,OAAO,CAAC,iBAAiB,CAAC,CAACC,IAAI,CAAC,YAAM;SACxC7G,EAAE,CAAC8G,EAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;WAAElB,OAAO,EAAPA,OAAO;WAAED,OAAO,EAAPA;UAAS,CAAC;QACtD,CAAC;;;KACF;KAAA,0CAEyBV,CAAC,EAC3B;OACC,IAAM8B,QAAQ,GAAG,IAAI,CAACjO,WAAW,EAAE;OAEnC,IAAIiO,QAAQ,CAAC9N,mBAAmB,EAAE,KAAK,CAAC,EACxC;SACC,IAAI,CAAC+N,kBAAkB,CAAC,CAAC,CAAC;SAC1B;;OAGD,IAAInH,EAAE,CAACoH,eAAe,CACrB,sBAAsB,EACtBhC,CAAC,CAACiC,MAAM,EACR,IAAI,CAACC,+BAA+B,EAAE,EACtC;SACCC,QAAQ,EAAE,IAAI;SACdC,UAAU,EAAE,IAAI;SAChBC,UAAU,EAAErC,CAAC,CAACiC,MAAM,CAACK,WAAW,GAAG,CAAC;SACpCC,KAAK,EAAE,IAAI;SACX3B,MAAM,EAAE;WACP4B,YAAY,0BACZ;aACC,IAAI,CAACC,OAAO,EAAE;;;QAGhB,CACD,CAACC,IAAI,EAAE;;;KACR;KAAA,kDAGD;OAAA;OACC,IAAMC,UAAU,GAAG,IAAI,CAACxC,kBAAkB,EAAE;OAC5C,IAAMyC,cAAc,GAAG,EAAE;OACzB,IAAMC,sBAAsB,GAAG;SAC9BC,IAAI,EAAEzB,aAAG,CAAC0B,OAAO,0FAAK,gEAAgE,CAAE;SACxFC,OAAO,EAAE,iBAAClC,KAAK,EAAElO,IAAI,EAAK;WACzBA,IAAI,CAACqQ,aAAa,EAAE,CAACjC,KAAK,EAAE;WAC5B,MAAI,CAACe,kBAAkB,CAAC,MAAI,CAAClO,WAAW,EAAE,CAACG,mBAAmB,EAAE,GAAG,CAAC,CAAC;;QAEtE;OAED,IAAI2O,UAAU,EACd;SACC,IAAI,CAAChP,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;WAC7CyP,cAAc,CAAC9P,IAAI,CAAC;aACnBgQ,IAAI,EAAE3P,UAAU,CAACgC,MAAM,CAACwK,QAAQ,EAAE;aAClCqD,OAAO,EAAE,iBAAClC,KAAK,EAAElO,IAAI,EAAK;eACzBA,IAAI,CAACqQ,aAAa,EAAE,CAACjC,KAAK,EAAE;eAE5B,MAAI,CAACV,sBAAsB,CAAC,UAAC4C,YAAY,EAAK;iBAC7CA,YAAY,CAACC,WAAW,CAAChQ,UAAU,CAAC;iBACpCA,UAAU,CAACiQ,WAAW,EAAE;iBAExB,IAAI,CAAC,MAAI,CAACjD,kBAAkB,EAAE,EAC9B;mBACCpI,aAAG,CAACmI,IAAI,CAAC,MAAI,CAACrM,WAAW,EAAE,CAACqJ,KAAK,CAAC;;gBAEnC,CAAC;;YAEH,CAAC;UACF,CAAC;SAEF0F,cAAc,CAAC9P,IAAI,CAAC;WAAEuQ,SAAS,EAAE;UAAM,CAAC;SACxCT,cAAc,CAAC9P,IAAI,CAAC+P,sBAAsB,CAAC;SAE3C,OAAOD,cAAc;;OAGtB,IAAMU,SAAS,GAAG,IAAI,CAACC,YAAY,EAAE;OACrC,IAAMC,UAAU,GAAG,IAAI,CAAC3P,WAAW,EAAE,CAACF,cAAc,EAAE,CAAC8P,MAAM,CAAC,UAAA7Q,IAAI;SAAA,OAAIA,IAAI,KAAK0Q,SAAS;SAAC;OAEzFE,UAAU,CAACpP,OAAO,CAAC,UAACjB,UAAU,EAAK;SAClCyP,cAAc,CAAC9P,IAAI,CAAC;WACnBgQ,IAAI,EAAE3P,UAAU,CAACgC,MAAM,CAACwK,QAAQ,EAAE;WAClCqD,OAAO,EAAE,iBAAClC,KAAK,EAAElO,IAAI,EAAK;aACzBA,IAAI,CAACqQ,aAAa,EAAE,CAACjC,KAAK,EAAE;aAC5B,MAAI,CAACmC,WAAW,CAAChQ,UAAU,CAAC;aAC5B,MAAI,CAACuQ,kBAAkB,EAAE;;UAE1B,CAAC;QACF,CAAC;OAEFd,cAAc,CAAC9P,IAAI,CAAC;SAAEuQ,SAAS,EAAE;QAAM,CAAC;OACxCT,cAAc,CAAC9P,IAAI,CAAC+P,sBAAsB,CAAC;OAE3C,OAAOD,cAAc;;;KACrB;KAAA,mCAEkBe,MAAM,EACzB;OAAA;OACC,IAAMrO,KAAK,GAAG,UAAGqD,aAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC,EAAG9D,OAAO,CAAC,eAAe,EAAE6O,MAAM,CAAC;OACzG,IAAMC,YAAY,GAAG,IAAIhM,aAAa,CAAC;SAAEiM,KAAK,EAAEvO;QAAO,CAAC;OAExD,IAAI,CAACzB,WAAW,EAAE,CAAC4L,gBAAgB,CAACmE,YAAY,CAAC,CAACnC,IAAI,CAAC,YAAM;SAC5D,IAAI,MAAI,CAACtB,kBAAkB,EAAE,EAC7B;WACC,MAAI,CAACG,sBAAsB,CAAC,UAAC4C,YAAY,EAAK;aAC7CA,YAAY,CAACC,WAAW,CAACS,YAAY,CAAC;aACtCA,YAAY,CAACR,WAAW,EAAE;aAE1B,IAAI,CAAC,MAAI,CAACjD,kBAAkB,EAAE,EAC9B;eACCpI,aAAG,CAACmI,IAAI,CAAC,MAAI,CAACrM,WAAW,EAAE,CAACqJ,KAAK,CAAC;;YAEnC,CAAC;UACF,MAED;WACC,MAAI,CAACiG,WAAW,CAACS,YAAY,CAAC;WAC9B,MAAI,CAACF,kBAAkB,EAAE;;QAE1B,CAAC;;;KACF;KAAA,oCAEmB/L,MAAM,EAC1B;OACC,IAAI,IAAI,CAACwI,kBAAkB,EAAE,EAC7B;SACC,IAAI,CAACG,sBAAsB,CAAC,UAAC4C,YAAY,EAAK;WAC7C,IAAM5N,KAAK,GAAG4N,YAAY,CAAC/N,MAAM,CAACwK,QAAQ,EAAE;WAC5C,IAAMmE,KAAK,GAAIxO,KAAK,CAAC+E,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,GAAG,EAAE,GAAG,GAAI;WAClD,IAAM0J,QAAQ,aAAMzO,KAAK,SAAGwO,KAAK,SAAGnM,MAAM,CAACH,aAAa,CAAE;WAE1D0L,YAAY,CAAC/N,MAAM,CAAC6O,SAAS,CAACrM,MAAM,CAAC;WACrCuL,YAAY,CAACe,WAAW,CAACnN,cAAI,CAACoN,MAAM,CAACH,QAAQ,CAAC,CAAC;WAC/Cb,YAAY,CAACiB,eAAe,EAAE;UAC9B,CAAC;SAEF;;OAGD;OAEA,IAAMC,SAAS,GAAG,IAAI,CAACpL,KAAK,CAACc,KAAK;OAClC,IAAMuK,SAAS,GAAG,CAAC,IAAI,CAACA,SAAS;OACjC,IAAMpL,KAAK,GAAG,IAAI,CAACqL,mBAAmB,CAACrL,KAAK,IAAI,CAAC;OACjD,IAAMsL,UAAU,GAAItL,KAAK,KAAK,CAAC,IAAIA,KAAK,GAAGoL,SAAS,KAAK,CAAC,IAAID,SAAS,CAACI,MAAM,CAACvL,KAAK,GAAGoL,SAAS,GAAG,CAAC,CAAC,KAAK,GAAG,GAAI,EAAE,GAAG,GAAG;OACzH,IAAMI,QAAQ,GAAIL,SAAS,CAACI,MAAM,CAACvL,KAAK,CAAC,KAAK,GAAG,GAAG,EAAE,GAAG,GAAI;OAE7D,IAAI,CAAC9D,MAAM,CAAC6O,SAAS,CAACrM,MAAM,CAAC;OAE7B,IAAM+M,YAAY,aAAMN,SAAS,CAAC/J,KAAK,CACtC,CAAC,EACDpB,KAAK,GAAGoL,SAAS,CACjB,SAAGE,UAAU,SAAGzN,cAAI,CAACoN,MAAM,CAACvM,MAAM,CAACH,aAAa,CAAC,SAAGiN,QAAQ,CAAE;OAE/D,IAAI,CAACH,mBAAmB,CAACrL,KAAK,GAAGyL,YAAY,CAACpR,MAAM;OACpD,IAAI,CAACgR,mBAAmB,CAACpL,GAAG,GAAGwL,YAAY,CAACpR,MAAM;OAElD,IAAI,CAAC0F,KAAK,CAACc,KAAK,aAAM4K,YAAY,SAAGN,SAAS,CAAC/J,KAAK,CAACpB,KAAK,CAAC,CAAE;OAC7D,IAAI,CAACoL,SAAS,GAAG,KAAK;OAEtB,IAAI,CAACM,aAAa,EAAE;;;KACpB;KAAA,gDAE+BC,OAAO,EACvC;OACC,IAAMnN,IAAI,GAAG,SAAS;OACtB,IAAMoN,QAAQ,GAAG,IAAI,CAACC,eAAe,CAACF,OAAO,CAAC;OAC9C,IAAMG,aAAa,mCAAQF,QAAQ;SAAEpN,IAAI,EAAJA;SAAM;OAE3C,IAAMuN,kBAAkB,aAAMvN,IAAI,CAACxC,WAAW,EAAE,WAAQ;OACxD,IAAMgQ,gBAAgB,GAAG;SAAE7D,MAAM,EAAEwD,OAAO,CAACxD;QAAQ;OAEnD,IAAI,CAAC8D,mBAAmB,CAACH,aAAa,CAAC;OACvC,IAAI,CAAClF,sBAAsB,CAACmF,kBAAkB,EAAEC,gBAAgB,CAAC;OAEjEnF,6BAAY,CAACC,IAAI,CAAC,qCAAqC,EAAE8E,QAAQ,CAAC;OAClE/E,6BAAY,CAACC,IAAI,CAAC,yCAAyC,EAAE;SAAEvD,MAAM,EAAE;QAAc,CAAC;;;KACtF;KAAA,mDAEkC2I,UAAU,EAC7C;OACC,IAAM1N,IAAI,GAAG,YAAY;OACzB,IAAMoN,QAAQ,GAAG,IAAI,CAACC,eAAe,CAACK,UAAU,CAAC;OACjD,IAAMC,gBAAgB,mCAAQP,QAAQ;SAAEpN,IAAI,EAAJA;SAAM;OAE9C,IAAMuN,kBAAkB,aAAMvN,IAAI,CAACxC,WAAW,EAAE,WAAQ;OACxD,IAAMgQ,gBAAgB,GAAG;SAAE7D,MAAM,EAAE+D,UAAU,CAAC/D;QAAQ;OAEtD,IAAI,CAAC8D,mBAAmB,CAACE,gBAAgB,CAAC;OAC1C,IAAI,CAACvF,sBAAsB,CAACmF,kBAAkB,EAAEC,gBAAgB,CAAC;OAEjEnF,6BAAY,CAACC,IAAI,CAAC,wCAAwC,EAAE8E,QAAQ,CAAC;OACrE/E,6BAAY,CAACC,IAAI,CAAC,yCAAyC,EAAE;SAAEvD,MAAM,EAAE;QAAiB,CAAC;;;KACzF;KAAA,gCAEe6I,IAAI,EACpB;OACC,IAAMC,UAAU,GAAGD,IAAI,CAACE,aAAa,EAAE;OACvC,IAAMC,UAAU,GAAGH,IAAI,CAACI,aAAa,EAAE;OAEvC,OAAO;SACNrE,MAAM,EAAEiE,IAAI,CAACjE,MAAM;SACnBsE,WAAW,EAAE,EAAE;SACfF,UAAU,EAAE,GAAG;SACfpQ,EAAE,EAAEiQ,IAAI,CAAC3H,KAAK,EAAE;SAChBrH,IAAI,EAAEiP,UAAU,CAACK,GAAG,CAAC,MAAM,CAAC;SAC5BC,QAAQ,EAAEN,UAAU,CAACK,GAAG,CAAC,UAAU,CAAC;SACpCE,KAAK,EAAEP,UAAU,CAACK,GAAG,CAAC,OAAO,CAAC;SAC9BnO,aAAa,EAAEV,cAAI,CAACC,MAAM,CAACsO,IAAI,CAAC1F,QAAQ,EAAE,CAAC;SAC3CmG,SAAS,EAAE,EAAE;SACbrO,IAAI,EAAE;WACLsO,QAAQ,EAAE,KAAK;WACfC,QAAQ,EAAGR,UAAU,KAAK,UAAW;WACrCK,KAAK,EAAGL,UAAU,KAAK,OAAQ;WAC/BS,OAAO,EAAGT,UAAU,KAAK;UACzB;SACD9N,UAAU,EAAG8N,UAAU,KAAK;QAC5B;;;KACD;KAAA,kCAEiBxF,CAAC,EACnB;OAAA;OAAA,IADqBkG,UAAU,uEAAG,SAAS;OAAA,IAAE7B,SAAS,uEAAG,KAAK;OAE7D,IAAI,CAAC,IAAI,CAAC8B,qBAAqB,EAAE,EACjC;SACC;;OAGD,IAAMC,eAAe,GAAG;SACvBxB,OAAO,EAAE,IAAI,CAACyB,+BAA+B,CAACzP,IAAI,CAAC,IAAI,CAAC;SACxDuO,UAAU,EAAE,IAAI,CAACmB,kCAAkC,CAAC1P,IAAI,CAAC,IAAI;QAC7D;OACD,IAAM2P,YAAY,GAAGH,eAAe,CAACF,UAAU,CAAC,IAAIE,eAAe,CAACxB,OAAO;OAE3E,IAAI,CAAC4B,iBAAiB,GAAG,IAAI;OAE7BC,iBAAO,CAACC,aAAa,CAAC,oBAAoB,CAAC,CAACjF,IAAI,CAAC,UAAAkF,OAAO,EAAI;SAC3D,IAAQC,MAAM,GAAKD,OAAO,CAAlBC,MAAM;SACd,IAAMC,MAAM,GAAG,IAAID,MAAM,CAAC;WACzBE,UAAU,EAAE9G,CAAC,CAACiC,MAAM;WACpB8E,YAAY,EAAE,IAAI;WAClBC,QAAQ,EAAE,KAAK;WACfC,QAAQ,EAAE,CACT;aACC7R,EAAE,EAAE,MAAM;aACV8R,OAAO,EAAE;eACRC,eAAe,EAAE,KAAK;eACtBC,kBAAkB,EAAE,KAAK;eACzBC,UAAU,EAAE,IAAI;eAChBC,YAAY,EAAE,MAAI,CAAC/J,aAAa,CAACgK,gBAAgB;eACjDC,aAAa,EAAE,IAAI;eACnBC,kBAAkB,EAAE;;YAErB,CACD;WACD7G,MAAM,EAAE;aACP,QAAQ,EAAE,gBAACE,KAAgB,EAAK;eAC/B,MAAI,CAAC0F,iBAAiB,GAAG,KAAK;cAC9B;aACD,eAAe,EAAE,sBAAC1F,KAAgB,EAAK;eACtC,MAAI,CAAC0F,iBAAiB,GAAG,KAAK;eAC9B,MAAI,CAACnC,SAAS,GAAGA,SAAS;eAC1B,MAAI,CAACM,aAAa,EAAE;eAEpB,qBAA+B7D,KAAK,CAAC4G,OAAO,EAAE;iBAAhCxE,YAAY,kBAAlBtQ,IAAI;eACZ2T,YAAY,CAACrD,YAAY,CAAC;;;UAG5B,CAAC;SACF2D,MAAM,CAACnE,IAAI,EAAE;QACb,CAAC;;;KACF;KAAA,kCAEiB1C,CAAC,EACnB;OACC,IAAI,CAAC2H,iBAAiB,CAAC3H,CAAC,EAAE,SAAS,CAAC;;;KACpC;KAAA,qCAEoBA,CAAC,EACtB;OACC,IAAI,CAAC2H,iBAAiB,CAAC3H,CAAC,EAAE,YAAY,CAAC;;;KACvC;KAAA,wCAEuBA,CAAC,EACzB;OACC,IAAMvN,MAAM,GAAG,IAAI,CAACyB,SAAS,EAAE;OAC/B,0BAA6B,IAAI,CAACqJ,aAAa;SAAvCqK,MAAM,uBAANA,MAAM;SAAEC,QAAQ,uBAARA,QAAQ;OACxB,IAAQC,SAAS,GAA8CD,QAAQ,CAA/DC,SAAS;SAAEC,aAAa,GAA+BF,QAAQ,CAApDE,aAAa;SAAEC,aAAa,GAAgBH,QAAQ,CAArCG,aAAa;SAAEC,SAAS,GAAKJ,QAAQ,CAAtBI,SAAS;OAE1D,IAAI,IAAI,CAAC7K,gBAAgB,KAAK,IAAI,EAClC;SACC,IAAI,CAACA,gBAAgB,GAAG,IAAIxC,EAAE,CAACsN,WAAW,CAAC;WAC1CvH,OAAO,EAAE,IAAI,CAACwH,0BAA0B,EAAE;WAC1CC,WAAW,EAAEpI,CAAC,CAACiC,MAAM;WACrBI,UAAU,EAAErC,CAAC,CAACiC,MAAM,CAACK,WAAW,GAAG,CAAC;WACpCH,QAAQ,EAAE,IAAI;WACdC,UAAU,EAAE,IAAI;WAChBG,KAAK,EAAE;UACP,CAAC;QACF,MAED;SACC,IAAI,CAACnF,gBAAgB,CAACiL,cAAc,CAACrI,CAAC,CAACiC,MAAM,CAAC;;OAG/C,IAAI,CAAC7E,gBAAgB,CAACsF,IAAI,EAAE;OAE5B9H,EAAE,CAAC0N,IAAI,CAACC,EAAE,CAACnV,GAAG,CAAC;SACdoV,GAAG,EAAE/V,MAAM;SACXgW,WAAW,YAAKb,MAAM,cAAInV,MAAM,4BAAyB;SACzDiW,gBAAgB,EAAE,KAAK;SACvBZ,SAAS,EAATA,SAAS;SACTC,aAAa,EAAbA,aAAa;SACbC,aAAa,EAAbA,aAAa;SACbC,SAAS,EAATA;QACA,CAAC;OAEFrN,EAAE,CAAC+N,aAAa,CACf,IAAI,CAACvL,gBAAgB,CAACwL,gBAAgB,CAACC,aAAa,CAAC,gBAAgB,CAAC,EACtE,wBAAwB,EACxB,CAAC,MAAM,CAAC,CACR;;;KACD;KAAA,wCAEuBC,MAAM,EAC9B;OACC,IAAI,CAAC3T,MAAM,CAAC4T,gBAAgB,CAACD,MAAM,CAAC;OACpC/Q,aAAG,CAACqH,MAAM,CAAC,IAAI,CAAC4J,uBAAuB,EAAE,CAACH,aAAa,wBAAiBC,MAAM,EAAG,CAAC;OAClFhJ,6BAAY,CAACC,IAAI,CAAC,yCAAyC,EAAE;SAAEvD,MAAM,EAAE;QAAoB,CAAC;;;KAC5F;KAAA,qCAGD;OACC,IAAMyM,aAAa,GAAG5H,aAAG,CAACC,MAAM,kuBAC6E,IAAI,CAAC4H,iBAAiB,CAACtS,IAAI,CACvI,IAAI,CAAC,EAEmDyK,aAAG,CAAC0B,OAAO,0FAAK,+BAA+B,GAGQ,IAAI,CAACoG,oBAAoB,CAACvS,IAAI,CAC7I,IAAI,CAAC,EAEmDyK,aAAG,CAAC0B,OAAO,0FAAK,kCAAkC,EAE1G;OACD,IAAMqG,sBAAsB,GAAG/H,aAAG,CAACC,MAAM,+SACuE,IAAI,CAAC+H,uBAAuB,CAACzS,IAAI,CAChJ,IAAI,CAAC,CAGL;OACD,IAAM0S,wBAAwB,GAAGjI,aAAG,CAACC,MAAM,igDACxC,IAAI,CAACnB,kBAAkB,EAAE,GAAG,EAAE,GAAGiJ,sBAAsB,EACiD,IAAI,CAACG,YAAY,CAAC3S,IAAI,CAChI,IAAI,CAAC,EAGsG,IAAI,CAAC4S,aAAa,CAAC5S,IAAI,CAClI,IAAI,CAAC,EAKF,IAAI,CAACzB,MAAM,CAACsU,cAAc,EAAE,GAAG,2DAA2D,GAAG,EAAE,EAAc,IAAI,CAACC,gBAAgB,CAAC9S,IAAI,CAC1I,IAAI,CAAC,EAEmD+B,aAAG,CAACC,UAAU,CAAC,iCAAiC,CAAC,EAGK,IAAI,CAAC+Q,yBAAyB,CAAC/S,IAAI,CACjJ,IAAI,CAAC,EAEmD+B,aAAG,CAACC,UAAU,CACtE,4CAA4C,CAAC,EAG8D,IAAI,CAACgR,aAAa,CAAChT,IAAI,CAClI,IAAI,CAAC,CAGL;OACD,IAAMiT,SAAS,GAAGxI,aAAG,CAACC,MAAM,oJAAiE;OAE7F,OAAOD,aAAG,CAACC,MAAM,kNACgC,IAAI,CAAC7D,UAAU,EAAE,IAAI,IAAI,CAACe,WAAW,EAAE,GAAG,yCAAyC,GAAG,EAAE,EACrI,IAAI,CAAC2H,qBAAqB,EAAE,GAAG8C,aAAa,GAAG,EAAE,EACjD,IAAI,CAAC9C,qBAAqB,EAAE,IAAI,CAAC,IAAI,CAAC3H,WAAW,EAAE,GAAGqL,SAAS,GAAG,EAAE,EACpE,CAAC,IAAI,CAACrL,WAAW,EAAE,GAAG8K,wBAAwB,GAAG,EAAE;;;KAGvD;KAAA,4BAEWxG,IAAI,EAChB;OACC,IAAI,CAAC3N,MAAM,CAAC2U,QAAQ,CAAChH,IAAI,CAAC;;;KAC1B;KAAA,kCAGD;OACC/K,aAAG,CAACjD,OAAO,CAAC,IAAI,CAACiV,qBAAqB,EAAE,EAAE,IAAI,CAACC,cAAc,EAAE,CAAC;;;KAChE;KAAA,iCAGD;OACC,IAAQC,QAAQ,GAAK,IAAI,CAAC1M,aAAa,CAA/B0M,QAAQ;OAChB,IAAMC,YAAY,GAAG,SAAfA,YAAY,CAAIzV,MAAM;SAAA,OAAKA,MAAM,CAACK,OAAO,CAAC,wBAAwB,EAAE,MAAM,CAAC;;OACjF,IAAIQ,KAAK,GAAG,IAAI,CAACH,MAAM,CAACwK,QAAQ,EAAE;OAElCrK,KAAK,GAAI,IAAI,CAACkJ,WAAW,EAAE,GAAG5G,aAAa,CAACuS,wBAAwB,CAAC7U,KAAK,CAAC,GAAGA,KAAM;OAEpF,IAAI,CAACH,MAAM,CAACiV,UAAU,EAAE,CAAChW,OAAO,CAAC,gBAA6C;SAAA,IAA1CgB,EAAE,QAAFA,EAAE;WAAEoC,aAAa,QAAbA,aAAa;WAAEC,IAAI,QAAJA,IAAI;WAAEC,UAAU,QAAVA,UAAU;SACtE,IAAM2S,MAAM,GAAG,IAAIC,MAAM,CAACJ,YAAY,CAAC1S,aAAa,CAAC,EAAE,GAAG,CAAC;SAC3D,IAAMsE,GAAG,GAAGmO,QAAQ,CAACnV,OAAO,CAAC,WAAW,EAAEM,EAAE,CAAC,CAACN,OAAO,CAAC,WAAW,EAAEM,EAAE,CAAC;SACtEE,KAAK,GAAGA,KAAK,CAACR,OAAO,CAACuV,MAAM,EAAEzS,aAAa,CAAC2S,mBAAmB,CAAC9S,IAAI,EAAED,aAAa,EAAEsE,GAAG,EAAEpE,UAAU,CAAC,CAAC;QACtG,CAAC;OAEFpC,KAAK,GAAGA,KAAK,CAACR,OAAO,CAAC,sBAAsB,EAAE,UAAAgH,GAAG;SAAA,OAAIlE,aAAa,CAAC4S,aAAa,CAAC1O,GAAG,CAAC;SAAC;OAEtF,OAAOuF,aAAG,CAACC,MAAM,oJACF,IAAI,CAACmJ,iBAAiB,EAAE,EACnCnV,KAAK;;;KAGT;KAAA,yCAGD;OAAA;OACC,IAAMoV,eAAe,GAAG,EAAE;OAE1B,IAAI,CAACvV,MAAM,CAACiV,UAAU,EAAE,CAAChW,OAAO,CAAC,iBAA2B;SAAA,IAAxBgB,EAAE,SAAFA,EAAE;WAAEoC,aAAa,SAAbA,aAAa;SACpD,IAAI,MAAI,CAACrC,MAAM,CAACwK,QAAQ,EAAE,CAACnJ,OAAO,CAACgB,aAAa,CAAC,KAAK,CAAC,CAAC,EACxD;WACCkT,eAAe,CAAC5X,IAAI,CAACsC,EAAE,CAAC;;QAEzB,CAAC;OAEFsV,eAAe,CAACtW,OAAO,CAAC,UAACgB,EAAE,EAAK;SAC/B,MAAI,CAACD,MAAM,CAACwV,YAAY,CAACvV,EAAE,CAAC;QAC5B,CAAC;;;KACF;KAAA,gCAGD;OACC,IAAI,CAACwV,iBAAiB,EAAE;OACxB,IAAI,CAACC,wBAAwB,EAAE;;;KAC/B;KAAA,oCAGD;OACC,IAAItV,SAAS,GAAG,CAAC;OAEjB,IAAI,CAAC5B,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7CA,UAAU,CAACgC,MAAM,CAAC2V,YAAY,CAACvV,SAAS,CAAC;SACzCA,SAAS,IAAI,CAAC;QACd,CAAC;;;KACF;KAAA,2CAGD;OACC,IAAMwV,eAAe,GAAI,IAAI,CAACvM,WAAW,EAAE,IAAI,IAAI,CAACf,UAAU,EAAE,GAAG,EAAE,aAAM,IAAI,CAACtI,MAAM,CAAC6V,mBAAmB,EAAE,MAAI;OAChH,IAAIC,cAAc,GAAG,CAAC;OAEtB,IAAI,CAACtX,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7C8X,cAAc,IAAI,CAAC;SACnB,IAAMC,YAAY,aAAMH,eAAe,SAAGE,cAAc,CAAE;SAE1D9X,UAAU,CAACgC,MAAM,CAACgW,mBAAmB,CAACD,YAAY,CAAC;SAEnD,IAAI,CAAC/X,UAAU,CAACqL,WAAW,EAAE,EAC7B;WACCrL,UAAU,CAACmM,SAAS,CAACuJ,aAAa,CAAC,8BAA8B,CAAC,CAACuC,SAAS,GAAGF,YAAY;;SAG5F/X,UAAU,CAAC0X,wBAAwB,EAAE;QACrC,CAAC;;;KACF;KAAA,oCAGD;OACC,2BAAgD,IAAI,CAACtN,aAAa;SAA1D8N,MAAM,wBAANA,MAAM;SAAEC,aAAa,wBAAbA,aAAa;SAAEC,YAAY,wBAAZA,YAAY;OAE3C,IAAI,CAAC1X,WAAW,EAAE,CAAC2X,eAAe,CAAC,UAAC5Y,IAAI,EAAK;SAC5C,IAAM6C,UAAU,GAAG7C,IAAI,CAACuC,MAAM,CAAC0I,aAAa,EAAE;SAC9C,IAAM4N,gBAAgB,GAAG7Y,IAAI,CAACuC,MAAM,CAACiV,UAAU,EAAE,CAACsB,GAAG,CAACL,MAAM,CAACnZ,QAAQ,EAAE,CAAC;SACxE,IAAIyZ,SAAS;SAEb,IAAI,CAACL,aAAa,IAAIC,YAAY,EAClC;WACCI,SAAS,GAAGlW,UAAU,IAAI,CAACgW,gBAAgB;UAC3C,MACI,IAAI,CAACH,aAAa,EACvB;WACCK,SAAS,GAAGlW,UAAU;UACtB,MACI,IAAI8V,YAAY,EACrB;WACCI,SAAS,GAAG,CAACF,gBAAgB;UAC7B,MAED;WACCE,SAAS,GAAG,KAAK;;SAGlB,OAAOA,SAAS;QAChB,CAAC;;;KACF;KAAA,gCAEeA,SAAS,EACzB;OACC,IAAI,IAAI,CAACC,YAAY,CAACD,SAAS,CAAC,EAChC;SACC,IAAI,CAACzL,IAAI,EAAE;QACX,MAED;SACC,IAAI,CAACwC,IAAI,EAAE;SACX,IAAI,CAAC/O,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;WAC7CA,UAAU,CAACqY,eAAe,CAACG,SAAS,CAAC;UACrC,CAAC;;;;KAEH;KAAA,6BAEYA,SAAS,EACtB;OACC,IACC,IAAI,CAAClO,UAAU,EAAE,IACd,IAAI,CAACH,UAAU,IACfvF,aAAG,CAACC,QAAQ,CAAC,IAAI,CAACsH,SAAS,EAAE,IAAI,CAACL,SAAS,CAAC,IAC5C,CAAC0M,SAAS,CAAC,IAAI,CAAC,EAEpB;SACC,OAAO,KAAK;;OAGb,IAAIE,OAAO,GAAG,IAAI;OAElB,IAAI,CAAClY,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7C,IAAI,CAACwY,SAAS,CAACxY,UAAU,CAAC,EAC1B;WACC0Y,OAAO,GAAG,KAAK;UACf,MACI,IAAIA,OAAO,EAChB;WACCA,OAAO,GAAG1Y,UAAU,CAACyY,YAAY,CAACD,SAAS,CAAC;;QAE7C,CAAC;OAEF,OAAOE,OAAO;;;KACd;KAAA,uBAGD;OACC9T,aAAG,CAACmI,IAAI,CAAC,IAAI,CAACZ,SAAS,CAAC;;;KACxB;KAAA,uBAGD;OACCvH,aAAG,CAAC2K,IAAI,CAAC,IAAI,CAACpD,SAAS,CAAC;;;KACxB;KAAA,kCAGD;OACC,IAAI7J,UAAU;OAEd,IAAI,IAAI,CAACgI,UAAU,EAAE,EACrB;SACChI,UAAU,GAAG,KAAK;QAClB,MACI,IAAI,IAAI,CAAC+I,WAAW,EAAE,EAC3B;SACC,IAAM3I,cAAc,GAAG,IAAI,CAACiI,mBAAmB,CAAC,IAAI,CAAC;SACrD,IAAMhI,UAAU,GAAG,IAAI,CAACiI,eAAe,CAAC,IAAI,CAAC;SAE7CtI,UAAU,GAAII,cAAc,KAAKC,UAAU,IAAIA,UAAU,GAAG,CAAE;QAC9D,MAED;SACCL,UAAU,GAAG,IAAI,CAACN,MAAM,CAAC0I,aAAa,EAAE;;OAGzC,OAAOpI,UAAU;;;KACjB;KAAA,yCAGD;OACC,IAAI,IAAI,CAAC6H,UAAU,EACnB;SACC,OAAO,IAAI;;OAGZ,IAAInJ,KAAK,GAAG,KAAK;OAEjB,IAAI,CAACR,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7C,IAAIgB,KAAK,KAAK,KAAK,EACnB;WACCA,KAAK,GAAGhB,UAAU,CAAC2Y,sBAAsB,EAAE;;QAE5C,CAAC;OAEF,OAAO3X,KAAK;;;KACZ;KAAA,kCAGD;OACC,IAAI,CAACR,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7C,IAAIA,UAAU,CAACgC,MAAM,CAAC4W,aAAa,EAAE,EACrC;WACC5Y,UAAU,CAAC6Y,WAAW,EAAE;;QAEzB,CAAC;;;KACF;KAAA,wCAGD;OACC,IAAI,IAAI,CAAC1O,UAAU,EACnB;SACC,IAAI,CAACoG,kBAAkB,EAAE;;OAG1B,IAAI,CAAC/P,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7CA,UAAU,CAAC8Y,qBAAqB,EAAE;QAClC,CAAC;;;KACF;KAAA,qCAGD;OACC,IAAI,CAACjT,KAAK,GAAG,IAAI,CAACsG,SAAS,CAACuJ,aAAa,iBAAU,IAAI,CAAC3U,SAAS,EAAE,EAAG;OACtE,IAAI,CAACoQ,mBAAmB,GAAG1M,aAAa,CAACsU,iBAAiB,CAAC,IAAI,CAAClT,KAAK,CAAC;;;KACtE;KAAA,2BAEUgH,CAAC,EACZ;OACCA,CAAC,CAACC,cAAc,EAAE;OAElB,IAAI,CAACX,SAAS,CAACuJ,aAAa,iBAAU,IAAI,CAAC3U,SAAS,EAAE,EAAG,CAAC4F,KAAK,GAAG,EAAE;OACpE,IAAI,CAAC6K,aAAa,EAAE;;;KACpB;KAAA,gCAGD;OAAA;OACC,IAAI,IAAI,CAAC3L,KAAK,KAAK,IAAI,IAAI,IAAI,CAACsL,mBAAmB,EACnD;SACC,4BAAuB,IAAI,CAACA,mBAAmB;WAAvCrL,KAAK,yBAALA,KAAK;WAAEC,GAAG,yBAAHA,GAAG;SAElB2C,UAAU,CAAC,YAAM;WAChB,MAAI,CAAC7C,KAAK,CAACmT,KAAK,EAAE;WAClB,MAAI,CAACnT,KAAK,CAACoT,iBAAiB,CAACnT,KAAK,EAAEC,GAAG,CAAC;UACxC,EAAE,EAAE,CAAC;;;;KAEP;KAAA,sCAGD;OACC,IAAMzG,MAAM,GAAG,IAAI,CAACyB,SAAS,EAAE;OAE/B,IAAI,IAAI,CAACsK,WAAW,EAAE,EACtB;SACC,OAAO6C,aAAG,CAACC,MAAM,2pBAIuC7O,MAAM,EAC9C,IAAI,CAAC0C,MAAM,CAACwK,QAAQ,EAAE,EAClB,IAAI,CAAC0M,cAAc,CAACzV,IAAI,CAAC,IAAI,CAAC,EACjC,IAAI,CAAC0V,kBAAkB,CAAC1V,IAAI,CAAC,IAAI,CAAC,EACU,IAAI,CAAC2V,UAAU,CAAC3V,IAAI,CAAC,IAAI,CAAC;;OAMxF,IAAM4V,iBAAiB,GAAG,IAAI5R,EAAE,CAAC8G,EAAE,CAAC+K,aAAa,CAAC;SACjD3S,KAAK,EAAE,IAAI,CAAC3E,MAAM,CAACkJ,iBAAiB,EAAE;SACtCqO,QAAQ,EAAE,IAAI,CAACvX,MAAM,CAACiJ,aAAa,EAAE;SACrCuO,KAAK,EAAE,EAAE;SACTC,QAAQ,EAAE,CAAC;SACXC,IAAI,EAAE,KAAK;SACXC,KAAK,EAAElS,EAAE,CAAC8G,EAAE,CAAC+K,aAAa,CAACM,KAAK,CAACC;QACjC,CAAC;OAEF,OAAO3L,aAAG,CAACC,MAAM,qmCACkD,IAAI,CAACnM,MAAM,CAAC0I,aAAa,EAAE,GAAG,6BAA6B,GAAG,EAAE,EAGnE,IAAI,CAACoP,qBAAqB,CAACrW,IAAI,CAAC,IAAI,CAAC,EAE7F4V,iBAAiB,CAACU,YAAY,EAAE,EAQiBza,MAAM,EACxCkG,aAAG,CAACC,UAAU,CAAC,sCAAsC,CAAC,EAC5D,IAAI,CAACzD,MAAM,CAACwK,QAAQ,EAAE,EAClB,IAAI,CAAC0M,cAAc,CAACzV,IAAI,CAAC,IAAI,CAAC,EACjC,IAAI,CAAC0V,kBAAkB,CAAC1V,IAAI,CAAC,IAAI,CAAC,EACU,IAAI,CAAC2V,UAAU,CAAC3V,IAAI,CAAC,IAAI,CAAC;;;KAKxF;KAAA,gCAEehE,IAAI,EACpB;OAAA,IADsBua,cAAc,uEAAG,IAAI;OAE1C,IAAMzS,IAAI,GAAGyS,cAAc,IAAIva,IAAI,CAACsa,YAAY,EAAE;OAClD,IAAMra,QAAQ,GAAGkF,aAAG,CAACqV,WAAW,CAAC1S,IAAI,CAAC;OAEtC,IAAI,CAAC,IAAI,CAACwC,KAAK,EACf;SACC,IAAI,CAACA,KAAK,GAAGmE,aAAG,CAACC,MAAM,mMAEnB1O,IAAI,CAACya,kBAAkB,EAAE,CAE5B;SAED,IAAI,CAACnQ,KAAK,CAAC2B,KAAK,CAAC5D,GAAG,aAAMpI,QAAQ,CAACoI,GAAG,OAAI;SAC1C,IAAI,CAACiC,KAAK,CAAC2B,KAAK,CAACyO,IAAI,aAAMza,QAAQ,CAACya,IAAI,OAAI;SAC5C,IAAI,CAACpQ,KAAK,CAAC2B,KAAK,CAAC8N,KAAK,aAAM9Z,QAAQ,CAAC8Z,KAAK,OAAI;SAE9C5U,aAAG,CAACwV,MAAM,CAAC,IAAI,CAACrQ,KAAK,EAAExD,QAAQ,CAAC8T,IAAI,CAAC;QACrC,MAED;SACCzV,aAAG,CAACjD,OAAO,CAAC,IAAI,CAACoI,KAAK,CAAC2L,aAAa,CAAC,oCAAoC,CAAC,EAAEjW,IAAI,CAACya,kBAAkB,EAAE,CAAC;SAEtG,IAAI,CAACnQ,KAAK,CAAC2B,KAAK,CAAC5D,GAAG,aAAMpI,QAAQ,CAACoI,GAAG,OAAI;SAC1C,IAAI,CAACiC,KAAK,CAAC2B,KAAK,CAACyO,IAAI,aAAMza,QAAQ,CAACya,IAAI,OAAI;SAC5C,IAAI,CAACpQ,KAAK,CAAC2B,KAAK,CAAC8N,KAAK,aAAM9Z,QAAQ,CAAC8Z,KAAK,OAAI;;OAG/C,IAAI,CAAC5U,aAAG,CAAC0V,OAAO,CAAC,IAAI,CAACvQ,KAAK,CAAC,EAC5B;SACCnF,aAAG,CAAC2K,IAAI,CAAC,IAAI,CAACxF,KAAK,CAAC;;OAGrB,IACEnF,aAAG,CAAC0V,OAAO,CAAC,IAAI,CAACvQ,KAAK,CAAC,IAAItK,IAAI,CAAC4L,WAAW,EAAE,IAAI,CAAC5L,IAAI,CAACuT,qBAAqB,EAAE,IAC3EtT,QAAQ,CAACya,IAAI,KAAK,CAAC,IAAIza,QAAQ,CAAC6a,KAAK,KAAK,CAAC,IAAI7a,QAAQ,CAAC8Z,KAAK,KAAK,CAAE,EAEzE;SACC5U,aAAG,CAACmI,IAAI,CAAC,IAAI,CAAChD,KAAK,CAAC;;;;KAErB;KAAA,mCAGD;OAAA;OACC,IAAMyQ,cAAc,GAAG,IAAI,CAACC,iBAAiB,EAAE;OAC/C,IAAMC,gBAAgB,GAAG,IAAI,CAACC,mBAAmB,EAAE;OAEnD/V,aAAG,CAACE,QAAQ,CAAC0V,cAAc,EAAE,IAAI,CAACI,WAAW,CAAC;OAC9ChW,aAAG,CAACiW,YAAY,CAACH,gBAAgB,EAAEF,cAAc,CAAC;OAElD,IAAI,CAAC3U,KAAK,GAAG6U,gBAAgB,CAAChF,aAAa,iBAAU,IAAI,CAAC3U,SAAS,EAAE,EAAG;OACxE,IAAI,CAAC8E,KAAK,CAACmT,KAAK,EAAE;OAClB,IAAI,CAACnT,KAAK,CAACoT,iBAAiB,CAAC,IAAI,CAACpT,KAAK,CAACc,KAAK,CAACxG,MAAM,EAAE,IAAI,CAAC0F,KAAK,CAACc,KAAK,CAACxG,MAAM,CAAC;OAC9E,IAAI,CAACgR,mBAAmB,GAAG1M,aAAa,CAACsU,iBAAiB,CAAC,IAAI,CAAClT,KAAK,CAAC;OAEtEiV,eAAK,CAACrX,IAAI,CAAC,IAAI,CAACoC,KAAK,EAAE,aAAa,EAAE,IAAI,CAACkV,kBAAkB,CAACtX,IAAI,CAAC,IAAI,CAAC,CAAC;OAEzE,IAAI,IAAI,CAACoC,KAAK,CAACc,KAAK,KAAK,EAAE,IAAI,IAAI,CAACd,KAAK,CAACc,KAAK,CAACxG,MAAM,KAAK,CAAC,EAC5D;SACCuI,UAAU,CAAC,YAAM;WAChB,IAAI9D,aAAG,CAAC0V,OAAO,CAAC,MAAI,CAACzU,KAAK,CAAC,EAC3B;aACC,MAAI,CAACnF,WAAW,EAAE,CAACsa,eAAe,CAAC,MAAI,EAAE,MAAI,CAACnV,KAAK,CAAC;;UAErD,EAAE,GAAG,CAAC;QACP,MAED;SACC,IAAI,CAACnF,WAAW,EAAE,CAACsa,eAAe,CAAC,IAAI,EAAE,IAAI,CAACnV,KAAK,CAAC;;OAGrD,IAAI,CAACsE,UAAU,GAAG,IAAI;;;KACtB;KAAA,oCAGD;OACC,IAAM8Q,YAAY,GAAG,IAAI,CAACR,iBAAiB,EAAE;OAC7C,IAAM9K,IAAI,GAAGsL,YAAY,CAACvF,aAAa,iBAAU,IAAI,CAAC3U,SAAS,EAAE,EAAG,CAAC4F,KAAK,CAACuU,IAAI,EAAE;OAEjF,IAAI,CAACpK,WAAW,CAACnB,IAAI,CAAC;OACtB,IAAI,CAACwL,sBAAsB,EAAE;OAC7B,IAAI,CAACnK,eAAe,EAAE;OAEtBpM,aAAG,CAACwW,WAAW,CAACH,YAAY,CAACI,kBAAkB,EAAE,IAAI,CAACT,WAAW,CAAC;OAClEhW,aAAG,CAACqH,MAAM,CAACgP,YAAY,CAAC;OACxBrW,aAAG,CAACmI,IAAI,CAAC,IAAI,CAACrM,WAAW,EAAE,CAACqJ,KAAK,CAAC;OAElC,IAAI,CAAClE,KAAK,GAAG,IAAI;OACjB,IAAI,CAACsE,UAAU,GAAG,KAAK;;;KACvB;KAAA,+CAGD;OACC,OAAO,IAAI,CAACtJ,mBAAmB,EAAE,KAAK,CAAC,IACnCmC,MAAM,CAACC,IAAI,CAAC,IAAI,CAACjB,MAAM,CAACsZ,cAAc,EAAE,CAAC,CAACnb,MAAM,KAAK,CAAC,IACtD,IAAI,CAAC+J,uBAAuB,CAAC/I,IAAI,KAAK,CAAC;;;KAC3C;KAAA,qCAGD;OAAA,IADmBoa,aAAa,uEAAG,KAAK;OAEvC,IAAM1V,KAAK,GAAG,IAAI,CAACsG,SAAS,CAACuJ,aAAa,iBAAU,IAAI,CAAC3U,SAAS,EAAE,EAAG;OACvE,IAAM4O,IAAI,GAAG9J,KAAK,CAACc,KAAK,CAACuU,IAAI,EAAE;OAE/B,IAAIvL,IAAI,CAACxP,MAAM,KAAK,CAAC,EACrB;SACC,IAAI,IAAI,CAACqb,4BAA4B,EAAE,EACvC;WACC,IAAI,CAACnO,YAAY,CAAC,KAAK,CAAC;WACxB,IAAI,CAAChO,SAAS,EAAE,CAAC8F,aAAa,EAAE;WAChC,IAAI,CAACsW,sBAAsB,EAAE;WAE7B7W,aAAG,CAACmI,IAAI,CAAC,IAAI,CAACrM,WAAW,EAAE,CAACqJ,KAAK,CAAC;UAClC,MAED;WACCtF,aAAa,CAACiX,kBAAkB,CAAC7V,KAAK,CAACa,aAAa,CAAC;WAErD,IAAI,IAAI,CAACb,KAAK,KAAK,IAAI,EACvB;aACC,IAAI,CAACnF,WAAW,EAAE,CAACsa,eAAe,CAAC,IAAI,EAAE,IAAI,CAACnV,KAAK,CAAC;;;QAGtD,MACI,IAAI0V,aAAa,EACtB;SACC,IAAI,CAAClc,SAAS,EAAE,CAACiN,gBAAgB,CAAC,IAAI,EAAE,IAAI,CAAC;QAC7C,MAED;SACC,IAAI,CAACqP,iBAAiB,EAAE;SACxB,IAAI,CAAC5N,iBAAiB,EAAE;;OAGzB,IAAI,IAAI,CAAC9D,gBAAgB,KAAK,IAAI,EAClC;SACC,IAAI,CAACA,gBAAgB,CAAC4D,KAAK,EAAE;;;;KAE9B;KAAA,iCAEgBhB,CAAC,EAClB;OACC,IAAI,IAAI,CAAC1C,UAAU,EACnB;SACC,IAAI0C,CAAC,CAAC+O,OAAO,KAAKnX,aAAa,CAACoX,QAAQ,CAAC/S,KAAK,IAAI+D,CAAC,CAAC+O,OAAO,KAAKnX,aAAa,CAACoX,QAAQ,CAAC5S,GAAG,EAC1F;WACC,IAAI,CAACsH,kBAAkB,CAAC,CAAC,IAAI,CAAClF,WAAW,EAAE,CAAC;UAC5C,MACI,IAAIwB,CAAC,CAAC+O,OAAO,KAAKnX,aAAa,CAACoX,QAAQ,CAAChT,GAAG,EACjD;WACC,IAAI,CAAC0H,kBAAkB,EAAE;;QAE1B,MAED;SACC,IAAM5B,QAAQ,GAAG,IAAI,CAACjO,WAAW,EAAE;SAEnCiO,QAAQ,CAACmK,qBAAqB,EAAE;SAChCnK,QAAQ,CAACmN,eAAe,EAAE;SAE1B,IAAI,CAACnN,QAAQ,CAACgK,sBAAsB,EAAE,EACtC;WACC,IAAI,CAACoD,gBAAgB,EAAE;WACvBpP,6BAAY,CAACC,IAAI,CAAC,yCAAyC,EAAE;aAAEvD,MAAM,EAAE;YAAoB,CAAC;;;;;KAG9F;KAAA,+BAEcwD,CAAC,EAChB;OAAA;OACC,IAAI,IAAI,CAACwG,iBAAiB,EAC1B;SACCxG,CAAC,CAACC,cAAc,EAAE;SAClB;;OAGD,QAAQD,CAAC,CAAC+O,OAAO;SAEhB,KAAKnX,aAAa,CAACoX,QAAQ,CAAChT,GAAG;SAC/B,KAAKpE,aAAa,CAACoX,QAAQ,CAAC/S,KAAK;WACjC;aACC+D,CAAC,CAACC,cAAc,EAAE;aAClBpE,UAAU,CAAC;eAAA,OAAM,OAAI,CAACsT,gBAAgB,CAACnP,CAAC,CAAC;eAAC;aAC1C;;SAGD,KAAKpI,aAAa,CAACoX,QAAQ,CAAC5S,GAAG;WAC/B;aACC,IAAI,CAAC,IAAI,CAACoC,WAAW,EAAE,EACvB;eACC,CAACwB,CAAC,CAACoP,QAAQ,GAAG,IAAI,CAACC,MAAM,CAACzY,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC0Y,KAAK,CAAC1Y,IAAI,CAAC,IAAI,CAAC,GAAG;;aAEhE,IAAI,CAAC+N,aAAa,EAAE;aACpB;;SAGD,KAAK/M,aAAa,CAACoX,QAAQ,CAAC3S,EAAE;WAC9B;aACC,IAAMvI,kBAAkB,GAAG,IAAI,CAACyb,qBAAqB,EAAE;aACvD,IAAIzb,kBAAkB,IAAIA,kBAAkB,KAAK,IAAI,CAACD,WAAW,EAAE,EACnE;eACCC,kBAAkB,CAACqb,gBAAgB,CAACnP,CAAC,CAAC;;aAEvC;;SAGD,KAAKpI,aAAa,CAACoX,QAAQ,CAAC1S,IAAI;WAChC;aACC,IAAMkT,mBAAmB,GAAG,IAAI,CAACC,sBAAsB,EAAE;aACzD,IAAID,mBAAmB,EACvB;eACCA,mBAAmB,CAACL,gBAAgB,CAACnP,CAAC,CAAC;;aAExC;;SAGD;;WAEC;;;;KAEF;KAAA,mCAEkBA,CAAC,EACpB;OACC,IAAI,IAAI,CAACwG,iBAAiB,EAC1B;SACCxG,CAAC,CAACC,cAAc,EAAE;SAClB;;OAGD,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAACyP,QAAQ,CAAC1P,CAAC,CAACJ,IAAI,CAAC,EAC/B;SACC,IAAI,CAAC+H,iBAAiB,CAAC3H,CAAC,EAAE,IAAI,CAACzC,aAAa,CAACoS,yBAAyB,EAAE,IAAI,CAAC;;;;KAE9E;KAAA,kCAEiB3P,CAAC,EACnB;OACC,IAAI,CAACxC,iBAAiB,CAACoS,eAAe,CAAC5P,CAAC,CAAC;OACzC,IAAI,CAACxC,iBAAiB,CAACqS,yBAAyB,CAAC,IAAI,CAACC,iBAAiB,CAAClZ,IAAI,CAAC,IAAI,EAAEoJ,CAAC,CAAC,CAAC;;;KACtF;KAAA,gCAEeA,CAAC,EACjB;OACC,IAAI,CAACxC,iBAAiB,CAACuS,aAAa,CAAC/P,CAAC,CAAC;;;KACvC;KAAA,kCAEiBA,CAAC,EACnB;OACC,IAAI,CAAC,IAAI,CAACgQ,cAAc,EAAE,IAAI,IAAI,CAACC,eAAe,CAACjQ,CAAC,EAAE,QAAQ,CAAC,EAC/D;SACC;;OAGD,IAAI,CAACmP,gBAAgB,CAACnP,CAAC,CAAC;;;KACxB;KAAA,0CAEyBA,CAAC,EAC3B;OACC,IAAI,CAACxC,iBAAiB,CAACoS,eAAe,CAAC5P,CAAC,CAAC;OACzC,IAAI,CAACxC,iBAAiB,CAACqS,yBAAyB,CAAC,IAAI,CAACK,yBAAyB,CAACtZ,IAAI,CAAC,IAAI,EAAEoJ,CAAC,CAAC,CAAC;;;KAC9F;KAAA,wCAEuBA,CAAC,EACzB;OACC,IAAI,CAACxC,iBAAiB,CAACuS,aAAa,CAAC/P,CAAC,CAAC;;;KACvC;KAAA,0CAEyBA,CAAC,EAC3B;OACC,IAAI,CAAC,IAAI,CAACgQ,cAAc,EAAE,IAAI,IAAI,CAACC,eAAe,CAACjQ,CAAC,EAAE,MAAM,CAAC,EAC7D;SACC;;OAGD,IAAI,IAAI,CAACuD,YAAY,EAAE,CAACpO,MAAM,CAAC4W,aAAa,EAAE,EAC9C;SACC,IAAI,CAACoE,YAAY,CAACnQ,CAAC,CAAC;SACpB;;OAGD,IAAI,CAACmP,gBAAgB,CAACnP,CAAC,CAAC;;;KACxB;KAAA,qCAGD;OACC,OAAOqB,aAAG,CAACC,MAAM,yKACuC,IAAI,CAACoI,gBAAgB,CAAC9S,IAAI,CAAC,IAAI,CAAC;;;KAExF;KAAA,kCAGD;OACC,IAAI,IAAI,CAACzB,MAAM,CAACsU,cAAc,EAAE,EAChC;SACC,IAAI,CAACtU,MAAM,CAACib,cAAc,CAAC,KAAK,CAAC;SACjCrY,aAAG,CAACqH,MAAM,CAAC,IAAI,CAACE,SAAS,CAACuJ,aAAa,CAAC,iCAAiC,CAAC,CAAC;QAC3E,MAED;SACC,IAAI,CAAC1T,MAAM,CAACib,cAAc,CAAC,IAAI,CAAC;SAChCrY,aAAG,CAACiW,YAAY,CACf,IAAI,CAACqC,kBAAkB,EAAE,EACzB,IAAI,CAAC/Q,SAAS,CAACuJ,aAAa,CAAC,mCAAmC,CAAC,CACjE;;OAGF/I,6BAAY,CAACC,IAAI,CAAC,yCAAyC,EAAE;SAAEvD,MAAM,EAAE;QAAmB,CAAC;OAE3F,IAAI,CAACmI,aAAa,EAAE;;;KACpB;KAAA,qCAGD;OACC,OAAO,IAAI,CAAC9Q,WAAW,EAAE,CAACwM,gBAAgB,EAAE,CAAC/M,MAAM,GAAG,CAAC;;;KACvD;KAAA,uCAEsBgd,QAAQ,EAC/B;OAAA,IADiCC,OAAO,uEAAG,KAAK;OAE/C,IAAIC,aAAa,GAAG,IAAI,CAAC3c,WAAW,EAAE,CAACwM,gBAAgB,EAAE;OAEzD,IAAIkQ,OAAO,EACX;SACCC,aAAa,kCAAOA,aAAa,CAACD,OAAO,EAAE,CAAC;;OAG7CC,aAAa,CAACpc,OAAO,CAAC,UAACxB,IAAI,EAAK;SAC/B0d,QAAQ,CAAC1d,IAAI,CAAC;QACd,CAAC;;;KACF;KAAA,iCAEgBoN,CAAC,EAClB;OACC,IAAI,CAAC,IAAI,CAACgQ,cAAc,EAAE,EAC1B;SACC;;OAGD,IAAI,IAAI,CAAC7P,kBAAkB,EAAE,EAC7B;SACC,IAAI,CAACG,sBAAsB,CAAC,UAAC4C,YAAY,EAAK;WAC7CA,YAAY,CAACuN,eAAe,EAAE;UAC9B,CAAC;SAEF;;OAGD,IAAI,CAACA,eAAe,EAAE;OAEtB,IAAMC,oBAAoB,GAAG1Q,CAAC,CAACiC,MAAM,CAAC0O,OAAO,CAAC,kDAAkD,CAAC;OACjG,IAAID,oBAAoB,EACxB;SACC3Y,aAAG,CAAC6Y,WAAW,CAACF,oBAAoB,EAAE,0DAA0D,CAAC;;;;KAElG;KAAA,2CAGD;OACC,IAAI,IAAI,CAACvb,MAAM,CAAC4W,aAAa,EAAE,IAAI,IAAI,CAACzO,UAAU,EAClD;SACC;;OAGD,IAAI,CAACuT,WAAW,EAAE;OAClB,IAAI,CAACC,kBAAkB,EAAE;;;KACzB;KAAA,8BAGD;OACC,IAAI,CAACnd,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7C,IACCA,UAAU,CAAC4d,cAAc,EAAE,IACxB,CAAC5d,UAAU,CAACmK,UAAU,IACtB,CAACnK,UAAU,CAACgC,MAAM,CAAC0I,aAAa,EAAE,EAEtC;WACC1K,UAAU,CAAC6d,cAAc,CAAC,KAAK,CAAC;;SAEjC7d,UAAU,CAAC0d,WAAW,EAAE;QACxB,CAAC;;;KACF;KAAA,qCAGD;OAAA;SAAA;OACC,2BAAmE,IAAI,CAACtT,aAAa;SAA7E0T,WAAW,wBAAXA,WAAW;SAAEC,QAAQ,wBAARA,QAAQ;SAAE1L,UAAU,wBAAVA,UAAU;SAAE2L,mBAAmB,wBAAnBA,mBAAmB;OAE9D,IAAI,CAACF,WAAW,IAAI,CAACA,WAAW,CAACG,YAAY,EAC7C;SACC;;OAGDxW,EAAE,CAACyW,IAAI,CAACC,SAAS,CAACL,WAAW,CAACG,YAAY,EAAE;SAC3CxR,IAAI,4DACC4F,UAAU,CAAC3Q,WAAW,EAAE,SAAOqc,QAAQ,yDAC1B,IAAI,CAAC/b,MAAM,CAACuI,KAAK,EAAE;QAErC,CAAC,CAAC+D,IAAI,CAAC,UAAC8P,QAAQ,EAAK;SACrBA,QAAQ,CAAC3R,IAAI,CAACxL,OAAO,CAAC,UAAAxB,IAAI,EAAI;WAC7B,OAAI,CAAC+K,QAAQ,CAAC/K,IAAI,CAACwC,EAAE,CAAC,CAACoc,yBAAyB,CAC/C5e,IAAI,CAAC6C,UAAU,EACf0b,mBAAmB,EACnBA,mBAAmB,CACnB;UACD,CAAC;QACF,CAAC;;;KACF;KAAA,wCAGD;OACC,IACC,IAAI,CAAC5N,YAAY,EAAE,CAACpO,MAAM,CAAC4W,aAAa,EAAE,IACvC,IAAI,CAACzO,UAAU,IACf,CAAC,IAAI,CAACyT,cAAc,EAAE,EAE1B;SACC;;OAGD,IAAI,CAACC,cAAc,EAAE;;;KACrB;KAAA,iCAGD;OAAA,IADeS,OAAO,uEAAG,IAAI;OAE5B,IAAMhc,UAAU,GAAG,IAAI,CAACN,MAAM,CAAC0I,aAAa,EAAE;OAE9C,IAAI,CAAC1I,MAAM,CAACuc,aAAa,CAAC,CAACjc,UAAU,CAAC;OACtC,IAAI,CAACjD,SAAS,EAAE,CAAC4F,YAAY,EAAE;OAC/B,IAAI,CAAC5F,SAAS,EAAE,CAAC6F,cAAc,EAAE;OAEjCN,aAAG,CAAC6Y,WAAW,CAAC,IAAI,CAAChD,iBAAiB,EAAE,EAAE,IAAI,CAAC+D,YAAY,CAAC;OAE5D,IAAI,CAAClR,sBAAsB,EAAE;OAC7B,IAAI,CAACS,iBAAiB,EAAE;OAExB,IAAIuQ,OAAO,EACX;SACC,IAAI,CAACG,qBAAqB,EAAE;;;;KAE7B;KAAA,wCAGD;OAAA;OACC,IAAMxc,EAAE,GAAG,IAAI,CAACD,MAAM,CAACuI,KAAK,EAAE;OAE9B,IAAI,CAACtI,EAAE,EACP;SACC;;OAGD,IAAMwK,IAAI,GAAG,EAAE;OACf,2BAAmE,IAAI,CAACrC,aAAa;SAA7E0T,WAAW,wBAAXA,WAAW;SAAEC,QAAQ,wBAARA,QAAQ;SAAE1L,UAAU,wBAAVA,UAAU;SAAE2L,mBAAmB,wBAAnBA,mBAAmB;OAC9D,IAAMU,UAAU,GAAI,IAAI,CAAC1c,MAAM,CAAC0I,aAAa,EAAE,GAAGoT,WAAW,CAACa,QAAQ,GAAGb,WAAW,CAACc,KAAM;OAE3FnS,IAAI,WAAI4F,UAAU,CAAC3Q,WAAW,EAAE,QAAK,GAAGqc,QAAQ;OAChDtR,IAAI,CAACoS,eAAe,GAAG5c,EAAE;OAEzBwF,EAAE,CAACyW,IAAI,CAACC,SAAS,CAACO,UAAU,EAAE;SAAEjS,IAAI,EAAJA;QAAM,CAAC,CAAC6B,IAAI,CAAC,UAAC8P,QAAQ,EAAK;SAC1D,IAAQ9b,UAAU,GAAK8b,QAAQ,CAAC3R,IAAI,CAACqS,aAAa,CAA1Cxc,UAAU;SAClB,OAAI,CAAC+b,yBAAyB,CAAC/b,UAAU,EAAE0b,mBAAmB,EAAEA,mBAAmB,CAAC;QACpF,CAAC;;;KACF;KAAA,0CAEyB1b,UAAU,EAAE7C,IAAI,EAAEL,MAAM,EAClD;OAAA;OACC,IAAI,IAAI,CAAC4C,MAAM,CAACuI,KAAK,EAAE,KAAK9K,IAAI,CAACsf,MAAM,CAAC9c,EAAE,EAC1C;SACCxC,IAAI,CAACsf,MAAM,CAACzc,UAAU,GAAGA,UAAU;SACnClD,MAAM,CAAC2f,MAAM,CAACrc,cAAc,IAAKJ,UAAU,GAAG,CAAC,GAAG,CAAC,CAAE;SAErD,OAAO,IAAI;;OAGZ,IAAItB,KAAK,GAAG,IAAI;OAChBvB,IAAI,CAACuf,WAAW,CAAC/d,OAAO,CAAC,UAACjB,UAAU,EAAK;SACxC,IAAIgB,KAAK,KAAK,IAAI,EAClB;WACCA,KAAK,GAAG,OAAI,CAACqd,yBAAyB,CAAC/b,UAAU,EAAEtC,UAAU,EAAEP,IAAI,CAAC;;QAErE,CAAC;OAEF,OAAOuB,KAAK;;;KACZ;KAAA,8BAGD;OACC,IAAMie,QAAQ,GAAG,IAAI,CAAC9S,SAAS,CAACuJ,aAAa,mBAAY,IAAI,CAAC3U,SAAS,EAAE,EAAG;OAE5E,IAAIke,QAAQ,IAAIA,QAAQ,CAACC,OAAO,KAAK,IAAI,EACzC;SACC,IAAI,CAACld,MAAM,CAACoL,aAAa,CAAC,KAAK,CAAC;SAEhC6R,QAAQ,CAACC,OAAO,GAAG,KAAK;SACxBta,aAAG,CAACwW,WAAW,CAAC,IAAI,CAACX,iBAAiB,EAAE,EAAE,+BAA+B,CAAC;;OAG3E,IAAI,CAACja,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7CA,UAAU,CAACiQ,WAAW,EAAE;QACxB,CAAC;;;KACF;KAAA,8BAGD;OACC,IAAIkP,QAAQ,GAAG,EAAE;OAEjB,IAAI,IAAI,CAACnd,MAAM,CAAC4W,aAAa,EAAE,EAC/B;SACCuG,QAAQ,CAACxf,IAAI,CAAC,IAAI,CAAC;;OAGpB,IAAI,CAACa,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7Cmf,QAAQ,4CAAOA,QAAQ,kCAAKnf,UAAU,CAACof,WAAW,EAAE,EAAC;QACrD,CAAC;OAEF,OAAOD,QAAQ;;;KACf;KAAA,mCAGD;OACC,OAAO,IAAI,CAACC,WAAW,EAAE,CAAC9O,MAAM,CAAC,UAAA7Q,IAAI;SAAA,OAAI,CAACA,IAAI,CAAC4L,WAAW,EAAE,IAAI,CAAC5L,IAAI,CAAC6K,UAAU,EAAE;SAAC;;;KACnF;KAAA,sCAEqBuC,CAAC,EACvB;OACC,IAAI,CAAC,IAAI,CAACgQ,cAAc,EAAE,EAC1B;SACChQ,CAAC,CAACiC,MAAM,CAACoQ,OAAO,GAAG,KAAK;SACxB;;OAGD,IAAI,CAAClC,YAAY,EAAE;;;KACnB;KAAA,+BAGD;OACC,IAAMrO,QAAQ,GAAG,IAAI,CAACjO,WAAW,EAAE;OAEnC,IAAI,IAAI,CAACsB,MAAM,CAAC4W,aAAa,EAAE,EAC/B;SACC,IAAI,CAACzM,SAAS,CAACuJ,aAAa,mBAAY,IAAI,CAAC3U,SAAS,EAAE,EAAG,CAACme,OAAO,GAAG,KAAK;SAC3E,IAAI,CAACld,MAAM,CAACoL,aAAa,CAAC,KAAK,CAAC;SAEhCuB,QAAQ,CAACqM,eAAe,CAACrM,QAAQ,EAAE,IAAI,CAACxC,SAAS,CAAC;SAElD,IAAI,CAAC,IAAI,CAACa,kBAAkB,EAAE,EAC9B;WACCpI,aAAG,CAACmI,IAAI,CAAC4B,QAAQ,CAAC5E,KAAK,CAAC;;QAEzB,MAED;SACC,IAAI,CAACoC,SAAS,CAACuJ,aAAa,mBAAY,IAAI,CAAC3U,SAAS,EAAE,EAAG,CAACme,OAAO,GAAG,IAAI;SAC1E,IAAI,CAACld,MAAM,CAACoL,aAAa,CAAC,IAAI,CAAC;SAE/BuB,QAAQ,CAACqM,eAAe,CAACrM,QAAQ,EAAE,IAAI,CAACxC,SAAS,CAAC;;OAGnDvH,aAAG,CAAC6Y,WAAW,CAAC,IAAI,CAAChD,iBAAiB,EAAE,EAAE,+BAA+B,CAAC;;;KAC1E;KAAA,qCAGD;OACC,IAAI,CAAC,IAAI,CAAC/Z,WAAW,EAAE,CAACiY,sBAAsB,EAAE,EAChD;SACC,IAAI,CAACE,WAAW,EAAE;;;;KAEnB;KAAA,8BAGD;OACC,IAAI,IAAI,CAAC7W,MAAM,CAAC4W,aAAa,EAAE,EAC/B;SACC,IAAI,CAAC3I,WAAW,EAAE;SAClB,IAAI,CAACjO,MAAM,CAACoL,aAAa,CAAC,KAAK,CAAC;SAEhC,IAAI,CAAC,IAAI,CAACJ,kBAAkB,EAAE,EAC9B;WACCpI,aAAG,CAACmI,IAAI,CAAC,IAAI,CAACrM,WAAW,EAAE,CAACqJ,KAAK,CAAC;;QAEnC,MAED;SACC,IAAI,CAAC/H,MAAM,CAACoL,aAAa,CAAC,IAAI,CAAC;SAE/B,IAAI,IAAI,CAACpL,MAAM,CAACqd,aAAa,EAAE,EAC/B;WACC,IAAI,CAACC,cAAc,EAAE;;;OAIvB1a,aAAG,CAAC6Y,WAAW,CAAC,IAAI,CAACtR,SAAS,EAAE,4CAA4C,CAAC;OAC7EvH,aAAG,CAAC6Y,WAAW,CAAC,IAAI,CAACtR,SAAS,EAAE,0CAA0C,CAAC;;;KAC3E;KAAA,wCAGD;OACC,IAAI,IAAI,CAACoT,eAAe,EACxB;SACC;;OAGD,IAAI,CAACD,cAAc,EAAE;;;KACrB;KAAA,iCAGD;OAAA;OACC,IAAI,CAACC,eAAe,GAAG,IAAI;OAE3B,IAAMC,WAAW,GAAG,IAAI,CAACrT,SAAS,CAACuJ,aAAa,YAAK,IAAI,CAAC+J,YAAY,EAAG;OACzE,IAAMC,iBAAiB,aAAM9a,aAAG,CAACqV,WAAW,CAACuF,WAAW,CAAC,CAAC5T,MAAM,OAAI;OAEpE,IAAI,CAAChH,aAAG,CAACC,QAAQ,CAAC,IAAI,CAACsH,SAAS,EAAE,IAAI,CAACwT,aAAa,CAAC,EACrD;SACC,IAAI,CAAC3d,MAAM,CAAC4d,aAAa,CAAC,IAAI,CAAC;SAE/BJ,WAAW,CAAC9T,KAAK,CAACC,QAAQ,GAAG,QAAQ;SACrC6T,WAAW,CAAC9T,KAAK,CAACE,MAAM,GAAG8T,iBAAiB;SAC5ChX,UAAU,CAAC,YAAM;WAChB8W,WAAW,CAAC9T,KAAK,CAACE,MAAM,GAAG,CAAC;UAC5B,EAAE,CAAC,CAAC;SAELhH,aAAG,CAACE,QAAQ,CAAC,IAAI,CAACqH,SAAS,EAAE,IAAI,CAACwT,aAAa,CAAC;SAEhD,IAAI,CAACJ,eAAe,GAAG,KAAK;QAC5B,MAED;SACC,IAAI,CAACvd,MAAM,CAAC4d,aAAa,CAAC,KAAK,CAAC;SAEhCJ,WAAW,CAAC9T,KAAK,CAACE,MAAM,GAAG,CAAC;SAC5B4T,WAAW,CAAC9T,KAAK,CAACE,MAAM,aAAM4T,WAAW,CAACzT,YAAY,OAAI;SAE1D,IAAM8T,aAAa,GAAG,SAAhBA,aAAa,GAAS;WAC3BL,WAAW,CAAC9T,KAAK,CAACE,MAAM,GAAG,MAAM;WACjCnE,EAAE,CAACqY,MAAM,CAACN,WAAW,EAAE,eAAe,EAAEK,aAAa,CAAC;WAEtD,OAAI,CAACN,eAAe,GAAG,KAAK;UAC5B;SACD9X,EAAE,CAAChE,IAAI,CAAC+b,WAAW,EAAE,eAAe,EAAEK,aAAa,CAAC;SAEpDjb,aAAG,CAACwW,WAAW,CAAC,IAAI,CAACjP,SAAS,EAAE,IAAI,CAACwT,aAAa,CAAC;;;;KAEpD;KAAA,8BAGD;OACC/a,aAAG,CAAC6Y,WAAW,CAAC,IAAI,CAACtR,SAAS,EAAE,uBAAuB,CAAC;;;KACxD;KAAA,4CAGD;OACC,IAAMgE,SAAS,GAAG,IAAI,CAACC,YAAY,EAAE;OACrC,IAAM2P,mBAAmB,GAAG5P,SAAS,CAAC6P,eAAe,EAAE;OAEvD7P,SAAS,CAACnO,MAAM,CAACuc,aAAa,CAACwB,mBAAmB,CAAC;OAEnD,IACCA,mBAAmB,IAChB,CAACnb,aAAG,CAACC,QAAQ,CAACsL,SAAS,CAAChE,SAAS,EAAE,0BAA0B,CAAC,IAC9D,IAAI,CAAC8T,qBAAqB,EAAE,EAEhC;SACC9P,SAAS,CAACmP,cAAc,EAAE;;;;KAE3B;KAAA,yCAGD;OACC,IAAMnP,SAAS,GAAG,IAAI,CAACC,YAAY,EAAE;OACrC,IAAM8P,gBAAgB,GAAG/P,SAAS,CAACtP,mBAAmB,EAAE,KAAK,CAAC;OAE9D,IACEqf,gBAAgB,IAAI,CAACtb,aAAG,CAACC,QAAQ,CAACsL,SAAS,CAAChE,SAAS,EAAE,uBAAuB,CAAC,IAC5E,CAAC+T,gBAAgB,IAAItb,aAAG,CAACC,QAAQ,CAACsL,SAAS,CAAChE,SAAS,EAAE,uBAAuB,CAAE,EAErF;SACCgE,SAAS,CAACgQ,WAAW,EAAE;;;;KAExB;KAAA,yCAGD;OACC,IAAI,CAACC,yBAAyB,EAAE;OAChC,IAAI,CAAC3E,sBAAsB,EAAE;;;KAC7B;KAAA,gCAEe5O,CAAC,EAAEwT,IAAI,EACvB;OACC,OAAO,IAAI,CAACC,iBAAiB,CAACD,IAAI,CAAC,IAC/B,IAAI,CAACC,iBAAiB,CAACD,IAAI,CAAC,CAACE,IAAI,CAAC,UAAA9gB,IAAI;SAAA,OAAIoN,CAAC,CAACiC,MAAM,CAAC0O,OAAO,CAAC/d,IAAI,CAAC;SAAC;;;KACrE;KAAA,wCAGD;OACC,OAAO,IAAI,CAAC2K,aAAa,CAACoW,wBAAwB,EAAE;;;KACpD;KAAA,wCAGD;OACC,OAAO,IAAI,CAACpW,aAAa,CAACqW,wBAAwB,EAAE;;;KACpD;KAAA,8BAGD;OACC,OAAO,IAAI,CAACrW,aAAa,CAACsW,SAAS,EAAE;;;KACrC;KAAA,wCAGD;OACC,OAAO,IAAI,CAACtW,aAAa,CAACuW,mBAAmB,EAAE;;;KAC/C;KAAA,iCAGD;OACC,OAAO,IAAI,CAACtX,MAAM,CAACE,SAAS;;;KAC5B;KAAA,iCAGD;OACC,OAAO,IAAI,CAACF,MAAM,CAACI,SAAS;;;KAC5B;KAAA,iCAGD;OACC,OAAO,IAAI,CAACJ,MAAM,CAACM,SAAS;;;KAC5B;KAAA,+BAGD;OACC,OAAO,IAAI,CAACN,MAAM,CAACQ,OAAO;;;KAC1B;KAAA,oCAGD;OACC,OAAQ,IAAI,CAACwB,WAAW,EAAE,GAAG,kCAAkC,GAAG,uCAAuC;;;KACzG;KAAA,wCAGD;OACC,OAAO,IAAI,CAACc,SAAS,CAACuJ,aAAa,YAAK,IAAI,CAAC4B,iBAAiB,EAAE,EAAG;;;KACnE;KAAA,0CAGD;OACC,OAAO,IAAI,CAACnL,SAAS,CAACuJ,aAAa,wBAAiB,IAAI,CAAC3U,SAAS,EAAE,EAAG;;;KACvE;KAAA,uCAGD;OACC,OAAO,IAAI,CAACoL,SAAS,CAACuJ,aAAa,qBAAc,IAAI,CAAC3U,SAAS,EAAE,EAAG;;;KACpE;KAAA,oCAGD;OACC,OAAO,IAAI,CAACoL,SAAS,CAACuJ,aAAa,CAAC,IAAI,CAACrK,WAAW,EAAE,GAAG,8BAA8B,GAAG,6BAA6B,CAAC;;;KACxH;KAAA,+BAGD;OACC,OAAO,IAAI,CAACc,SAAS;;;KACrB;KAAA,qBAEI1M,IAAI,EACT;OAAA,IADWC,QAAQ,uEAAG,QAAQ;OAAA,IAAE2J,MAAM,uEAAG,MAAM;OAE9C,IACC,IAAI,CAACtI,SAAS,EAAE,KAAKtB,IAAI,CAACsB,SAAS,EAAE,IAClC,IAAI,CAACG,SAAS,CAACzB,IAAI,CAACsB,SAAS,EAAE,CAAC,KAAK,IAAI,EAE7C;SACC;;OAGD,IAAMgE,SAAS,GAAG,IAAI,CAAC1F,SAAS,EAAE;OAClC,IAAM2F,SAAS,GAAGvF,IAAI,CAACJ,SAAS,EAAE;OAElC0F,SAAS,CAACkH,MAAM,CAAC,IAAI,CAAC;OAEtB,IAAIvM,QAAQ,KAAK,KAAK,EACtB;SACCsF,SAAS,CAAC4b,SAAS,CAAC,IAAI,EAAEnhB,IAAI,CAAC;QAC/B,MAED;SACCuF,SAAS,CAAC6b,QAAQ,CAAC,IAAI,EAAEphB,IAAI,CAAC;;OAG/BgF,aAAa,CAACqc,aAAa,CAAC/b,SAAS,EAAEC,SAAS,CAAC;OAEjD,IAAItF,QAAQ,KAAK,KAAK,EACtB;SACCkF,aAAG,CAACiW,YAAY,CAAC,IAAI,CAAC1O,SAAS,EAAE1M,IAAI,CAAC0M,SAAS,CAAC;QAChD,MAED;SACCvH,aAAG,CAACmc,WAAW,CAAC,IAAI,CAAC5U,SAAS,EAAE1M,IAAI,CAAC0M,SAAS,CAAC;;OAGhD,IAAI,CAACsP,sBAAsB,EAAE;OAC7B,IAAI,CAAC1N,iBAAiB,EAAE;OAExBpB,6BAAY,CAACC,IAAI,CAAC,yCAAyC,EAAE;SAAEvD,MAAM,EAANA;QAAQ,CAAC;;;KACxE;KAAA,4BAEW5J,IAAI,EAChB;OAAA,IADkBC,QAAQ,uEAAG,QAAQ;OAAA,IAAE2J,MAAM,uEAAG,aAAa;OAE5D,IAAI5J,IAAI,CAACoB,mBAAmB,EAAE,GAAG,CAAC,EAClC;SACC,IAAMmgB,WAAW,GAAG;WACnBlZ,GAAG,EAAErI,IAAI,CAACW,kBAAkB,EAAE;WAC9B6gB,MAAM,EAAExhB,IAAI,CAACY,iBAAiB;UAC9B;SAED,IAAI,CAAC6gB,IAAI,CAACF,WAAW,CAACthB,QAAQ,CAAC,EAAEA,QAAQ,EAAE2J,MAAM,CAAC;QAClD,MAED;SACC,IAAMtE,SAAS,GAAG,IAAI,CAAC1F,SAAS,EAAE;SAClC,IAAM2F,SAAS,GAAGvF,IAAI;SAEtBsF,SAAS,CAACkH,MAAM,CAAC,IAAI,CAAC;SACtBjH,SAAS,CAAC/E,GAAG,CAAC,IAAI,CAAC;SAEnBwE,aAAa,CAACqc,aAAa,CAAC/b,SAAS,EAAEC,SAAS,CAAC;SAEjDJ,aAAG,CAACwV,MAAM,CAAC,IAAI,CAACjO,SAAS,EAAEnH,SAAS,CAACmc,oBAAoB,EAAE,CAAC;SAC5Dvc,aAAG,CAACE,QAAQ,CAAC,IAAI,CAACqH,SAAS,EAAE,4CAA4C,CAAC;SAE1E,IAAI,CAACsP,sBAAsB,EAAE;SAC7B,IAAI,CAAC1N,iBAAiB,EAAE;SAExBpB,6BAAY,CAACC,IAAI,CAAC,yCAAyC,EAAE;WAAEvD,MAAM,EAANA;UAAQ,CAAC;;;;KAEzE;KAAA,wBAGD;OACC,IAAI,CAAC,IAAI,CAAC/I,iBAAiB,EAAE,EAC7B;SACC,IAAI,CAAC0P,WAAW,CAAC,IAAI,CAACpP,cAAc,EAAE,EAAE,QAAQ,EAAE,OAAO,CAAC;;;;KAE3D;KAAA,+BAGD;OACC,IAAI,IAAI,CAACoM,kBAAkB,EAAE,EAC7B;SACC,IAAI,CAACG,sBAAsB,CAAC,UAAC4C,YAAY,EAAK;WAC7CA,YAAY,CAACoM,KAAK,EAAE;UACpB,CAAC;SAEF;;OAGD,IAAI,CAACA,KAAK,EAAE;OACZ,IAAI,CAAC3K,aAAa,EAAE;;;KACpB;KAAA,yBAGD;OACC,IAAMpS,MAAM,GAAG,IAAI,CAACC,SAAS,EAAE;OAE/B,IAAID,MAAM,CAACiM,WAAW,EAAE,EACxB;SACC;;OAGD,IAAI,CAAC6V,IAAI,CAAC9hB,MAAM,EAAE,QAAQ,EAAE,QAAQ,CAAC;;;KACrC;KAAA,gCAGD;OACC,IAAI,IAAI,CAAC4N,kBAAkB,EAAE,EAC7B;SACC,IAAI,CAACG,sBAAsB,CAAC,UAAC4C,YAAY,EAAK;WAC7CA,YAAY,CAACmM,MAAM,EAAE;UACrB,EAAE,IAAI,CAAC;SAER;;OAGD,IAAI,CAACA,MAAM,EAAE;OACb,IAAI,CAAC1K,aAAa,EAAE;;;KACpB;KAAA,mCAGD;OAAA;OAAA,IADiB/R,IAAI,uEAAG,IAAI;OAAA,IAAE2hB,SAAS,uEAAG,IAAI;OAAA,IAAE1hB,QAAQ,uEAAG,OAAO;OAEjE,IAAM2hB,OAAO,GAAG5hB,IAAI,YAAY,IAAI,SAAM;OAE1C,OAAO,IAAI6hB,OAAO,CAAC,UAACC,OAAO,EAAK;SAC/B,IAAMC,gBAAgB,GAAG/hB,IAAI,IAAI,IAAI,OAAI,SAAM,EAAE;SACjD,IAAIgiB,sBAAsB;SAE1B,IAAIL,SAAS,YAAY,OAAI,SAAM,EACnC;WACC,IAAI1hB,QAAQ,KAAK,QAAQ,EACzB;aACC,OAAI,CAACkhB,SAAS,CAACY,gBAAgB,EAAEJ,SAAS,CAAC;aAE3CK,sBAAsB,GAAGD,gBAAgB,CAACE,SAAS,EAAE;aACrD,OAAI,CAACxV,gBAAgB,CAACuV,sBAAsB,CAAC;aAE7C7c,aAAG,CAACiW,YAAY,CAAC4G,sBAAsB,EAAEL,SAAS,CAACjV,SAAS,CAAC;YAC7D,MACI,IAAIzM,QAAQ,KAAK,OAAO,EAC7B;aACC,OAAI,CAACmhB,QAAQ,CAACW,gBAAgB,EAAEJ,SAAS,CAAC;aAE1CK,sBAAsB,GAAGD,gBAAgB,CAACE,SAAS,EAAE;aACrD,OAAI,CAACxV,gBAAgB,CAACuV,sBAAsB,CAAC;aAE7C7c,aAAG,CAACmc,WAAW,CAACU,sBAAsB,EAAEL,SAAS,CAACjV,SAAS,CAAC;;UAE7D,MAED;WACC,OAAI,CAAClM,GAAG,CAACuhB,gBAAgB,CAAC;WAE1BC,sBAAsB,GAAGD,gBAAgB,CAACE,SAAS,EAAE;WACrD,OAAI,CAACxV,gBAAgB,CAACuV,sBAAsB,CAAC;WAE7C7c,aAAG,CAACwV,MAAM,CAACqH,sBAAsB,EAAE,OAAI,CAACN,oBAAoB,EAAE,CAAC;;SAGhE,OAAI,CAAClc,YAAY,EAAE;SACnB,OAAI,CAACE,aAAa,EAAE;SAEpB,IAAI,CAAC,OAAI,CAACmF,UAAU,EAAE,EACtB;WACC,OAAI,CAACpF,cAAc,EAAE;WACrB,OAAI,CAACuW,sBAAsB,EAAE;WAE7B,IAAI,CAAC4F,OAAO,EACZ;aACCG,gBAAgB,CAACxF,gBAAgB,EAAE;;;SAIrCtT,UAAU,CAAC,YAAM;WAChB+Y,sBAAsB,CAAC/V,KAAK,CAACE,MAAM,aAAM6V,sBAAsB,CAAC1V,YAAY,OAAI;WAChF0V,sBAAsB,CAAC/V,KAAK,CAACG,OAAO,GAAG,CAAC;UACxC,EAAE,CAAC,CAAC;SAELnD,UAAU,CAAC,YAAM;WAChB+Y,sBAAsB,CAAC/V,KAAK,CAACC,QAAQ,GAAG,EAAE;WAC1C8V,sBAAsB,CAAC/V,KAAK,CAACE,MAAM,GAAG,EAAE;WACxC6V,sBAAsB,CAAC/V,KAAK,CAACG,OAAO,GAAG,EAAE;WAEzCjH,aAAG,CAACwW,WAAW,CAACqG,sBAAsB,EAAE,OAAI,CAAC3V,SAAS,CAAC;WAEvD,IAAI,CAAC,OAAI,CAACxB,UAAU,EAAE,IAAI,CAAC+W,OAAO,IAAIG,gBAAgB,CAAC3b,KAAK,KAAK,IAAI,EACrE;aACC,OAAI,SAAM,CAAC8b,YAAY,CAACH,gBAAgB,CAACzH,YAAY,EAAE,CAAC;;WAGzDwH,OAAO,CAACC,gBAAgB,CAAC;UACzB,EAAE,GAAG,CAAC;QACP,CAAC;;;KACF;KAAA,0CAGD;OACC,IAAI,IAAI,CAAC9gB,WAAW,EAAE,CAACiY,sBAAsB,EAAE,EAC/C;SACC;;OAGD,IAAI,CAACrM,gBAAgB,EAAE;;;KACvB;KAAA,qCAGD;OACC,IAAMsV,eAAe,GAAG;SACvBC,OAAO,EAAE,IAAI,CAAC9gB,SAAS,EAAE;SACzB+gB,cAAc,EAAE,IAAI,CAACziB,SAAS,EAAE,CAAC0B,SAAS,EAAE;SAC5CghB,EAAE,EAAE,IAAI,CAAC/f,MAAM,CAACuI,KAAK,EAAE;SACvByX,SAAS,EAAE,IAAI,CAAChgB,MAAM,CAACigB,WAAW,EAAE;SACpCC,SAAS,EAAE,IAAI,CAAClgB,MAAM,CAACmgB,WAAW,EAAE;SACpCzR,KAAK,EAAE/M,cAAI,CAACoN,MAAM,CAAC,IAAI,CAAC/O,MAAM,CAACwK,QAAQ,EAAE,CAAC;SAC1C4V,UAAU,EAAE,IAAI,CAACpgB,MAAM,CAACqK,YAAY,EAAE;SACtCgW,WAAW,EAAE,IAAI,CAACrgB,MAAM,CAAC0I,aAAa,EAAE;SACxC4X,YAAY,EAAE,IAAI,CAACtgB,MAAM,CAACsU,cAAc,EAAE;SAC1CiM,OAAO,EAAE,EAAE;SACXC,WAAW,EAAE;QACb;OAED,IAAI,CAACxgB,MAAM,CAACiV,UAAU,EAAE,CAAChW,OAAO,CAAC,UAAC0F,KAAK,EAAE8b,GAAG,EAAK;SAChD,IAAQpe,aAAa,GAAWsC,KAAK,CAA7BtC,aAAa;WAAEC,IAAI,GAAKqC,KAAK,CAAdrC,IAAI;SAC3Bsd,eAAe,CAACW,OAAO,CAAC5iB,IAAI,iCAC1B8iB,GAAG,EAAG;WACNve,IAAI,EAAEI,IAAI;WACVL,IAAI,EAAEN,cAAI,CAACoN,MAAM,CAAC1M,aAAa;UAC/B,EACA;QACF,CAAC;OAEF,IAAMvB,WAAW,GAAG,IAAI,CAACd,MAAM,CAACsZ,cAAc,EAAE;OAChDtY,MAAM,CAACC,IAAI,CAACH,WAAW,CAAC,CAAC7B,OAAO,CAAC,UAACgB,EAAE,EAAK;SACxC2f,eAAe,CAACY,WAAW,CAACvgB,EAAE,CAAC,GAAGa,WAAW,CAACb,EAAE,CAAC;QACjD,CAAC;OAEF,OAAO2f,eAAe;;;KACtB;KAAA,iCAGD;OAAA,IADec,SAAS,uEAAG,IAAI;OAE9B,IAAMvgB,KAAK,GAAG,IAAI,CAACH,MAAM,CAACwK,QAAQ,EAAE;OACpC,IAAIC,IAAI,GAAGiW,SAAS,IAAI,EAAE;OAE1B,IAAI,CAAC,IAAI,CAACpY,UAAU,EAAE,IAAInI,KAAK,KAAK,EAAE,IAAIA,KAAK,CAAChC,MAAM,GAAG,CAAC,EAC1D;SACCsM,IAAI,CAAC9M,IAAI,CAAC,IAAI,CAACgjB,kBAAkB,EAAE,CAAC;;OAGrC,IAAI,CAACniB,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7CyM,IAAI,GAAGzM,UAAU,CAAC4iB,cAAc,CAACnW,IAAI,CAAC;QACtC,CAAC;OAEF,OAAOA,IAAI;;;KACX;KAAA,sCAGD;OACC,IAAI,CAAC,IAAI,CAACnC,UAAU,EAAE,EACtB;SACC,IAAMhL,MAAM,GAAG,IAAI,CAACyB,SAAS,EAAE;SAC/B,IAAM+B,WAAW,GAAG,IAAI,CAACd,MAAM,CAACsZ,cAAc,EAAE;SAChD,IAAM7G,MAAM,aAAM,IAAI,CAACrK,aAAa,CAACqK,MAAM,cAAInV,MAAM,MAAG;SAExD,IAAIwW,aAAa,GAAG,EAAE;SACtB,IAAI+M,iBAAiB,GAAG,EAAE;SAE1B,IAAI,CAAC7gB,MAAM,CAACiV,UAAU,EAAE,CAAChW,OAAO,CAAC,UAAC0F,KAAK,EAAE8b,GAAG,EAAK;WAChD3M,aAAa,uDAA6C2M,GAAG,uBAAWhO,MAAM,uBAAagO,GAAG,+BAAmB9b,KAAK,CAACrC,IAAI,SAAK;WAChIwR,aAAa,uDAA6C2M,GAAG,uBAAWhO,MAAM,uBAAagO,GAAG,+BAAmB9b,KAAK,CAACtC,aAAa,SAAK;UACzI,CAAC;SAEFrB,MAAM,CAACC,IAAI,CAACH,WAAW,CAAC,CAAC7B,OAAO,CAAC,UAACgB,EAAE,EAAK;WACxC4gB,iBAAiB,sDAA4C5gB,EAAE,uBAAWwS,MAAM,2BAAiBxS,EAAE,yBAAaa,WAAW,CAACb,EAAE,CAAC,SAAK;UACpI,CAAC;SAEF,IAAM6gB,aAAa,GAAG5U,aAAG,CAACC,MAAM,+wCACZ7O,MAAM,EACkBmV,MAAM,EAAqBnV,MAAM,EAC1BmV,MAAM,EAA4B,IAAI,CAACpV,SAAS,EAAE,CAAC0B,SAAS,EAAE,EAC1E0T,MAAM,EAAgB,IAAI,CAACzS,MAAM,CAACuI,KAAK,EAAE,EAClCkK,MAAM,EAAuB,IAAI,CAACzS,MAAM,CAACigB,WAAW,EAAE,EACtDxN,MAAM,EAAuB,IAAI,CAACzS,MAAM,CAACmgB,WAAW,EAAE,EAC1D1N,MAAM,EAAmB,IAAI,CAACzS,MAAM,CAACwK,QAAQ,EAAE,EAC1CiI,MAAM,EAAwB,IAAI,CAACzS,MAAM,CAACqK,YAAY,EAAE,EACvDoI,MAAM,EAAyB,IAAI,CAACzS,MAAM,CAAC0I,aAAa,EAAE,EACzD+J,MAAM,EAA0B,IAAI,CAACzS,MAAM,CAACsU,cAAc,EAAE,EAClE7B,MAAM,EAA4B,IAAI,CAACoI,cAAc,EAAE,EACvDpI,MAAM,EAA4B,IAAI,CAACsO,cAAc,EAAE,EACvDtO,MAAM,EAA4B,IAAI,CAACmJ,cAAc,EAAE,EAC9F9H,aAAa,EACb+M,iBAAiB,CAEpB;SAEDje,aAAG,CAACqH,MAAM,CAAC,IAAI,CAACE,SAAS,CAACuJ,aAAa,oBAAapW,MAAM,EAAG,CAAC;SAC9DsF,aAAG,CAACwV,MAAM,CAAC0I,aAAa,EAAE,IAAI,CAAC3W,SAAS,CAAC;;OAG1C,IAAI,CAAC3L,cAAc,EAAE,CAACS,OAAO,CAAC,UAACjB,UAAU,EAAK;SAC7CA,UAAU,CAACgjB,mBAAmB,EAAE;QAChC,CAAC;;;KACF;KAAA,uCAGD;OAAA;OACC,IAAMC,QAAQ,GAAG,IAAI,CAACjhB,MAAM,CAACuI,KAAK,EAAE,IAAI,IAAI,CAACvI,MAAM,CAACigB,WAAW,EAAE;OACjE,IAAQ7X,aAAa,GAAK,IAAI,CAAtBA,aAAa;OACrB,IAAM8Y,iBAAiB,GAAG9Y,aAAa,CAACtH,WAAW;OACnD,IAAI+f,iBAAiB,GAAG,EAAE;OAE1B,IAAIK,iBAAiB,IAAKD,QAAQ,IAAIC,iBAAkB,EACxD;SACC,IAAMpgB,WAAW,GAAGoL,aAAG,CAACC,MAAM,0FAAG+U,iBAAiB,CAACD,QAAQ,CAAC,CAAE;SAC9D,IAAME,iBAAiB,GAAG,IAAI,CAACC,oBAAoB,CAAChZ,aAAa,CAACiZ,sBAAsB,EAAE,CAAC;SAC3F,IAAMC,mBAAmB,GAAG,EAAE;SAE9B,IAAI,CAACxgB,WAAW,EAChB;WACC,OAAO+f,iBAAiB;;SAGzBA,iBAAiB,GAAG/f,WAAW;SAE/B,IAAI,CAACygB,KAAK,CAACC,OAAO,CAAC1gB,WAAW,CAAC,EAC/B;WACC+f,iBAAiB,GAAG,CAAC/f,WAAW,CAAC;;SAGlCE,MAAM,CAACC,IAAI,CAAC4f,iBAAiB,CAAC,CAAC5hB,OAAO,CAAC,UAACwhB,GAAG,EAAK;WAC/C,IAAMgB,UAAU,GAAGZ,iBAAiB,CAACJ,GAAG,CAAC;WACzC,IAAM9M,MAAM,GAAG8N,UAAU,CAACC,YAAY,CAAC,YAAY,CAAC;WACpD,IAAMC,SAAS,GAAGlf,aAAa,CAACmf,gBAAgB,CAACH,UAAU,CAACC,YAAY,CAAC,mBAAmB,CAAC,CAAC;WAC9F,IAAMG,cAAc,0BAAmBF,SAAS,CAAE;WAClD,IAAMG,aAAa,GAAGL,UAAU,CAAC/N,aAAa,6BAAsBC,MAAM,EAAG;WAC7E,IAAMoO,YAAY,GAAG7V,aAAG,CAACC,MAAM,4MAEjB,OAAI,CAAC6V,uBAAuB,CAACvgB,IAAI,CAAC,OAAI,EAAEkS,MAAM,CAAC,CAC5D;WACD,IAAM4C,GAAG,GAAGvV,MAAM,CAACihB,SAAS,CAACC,cAAc;WAE3C,IAAI,CAAC3L,GAAG,CAAC4L,IAAI,CAAChB,iBAAiB,EAAExN,MAAM,CAAC,EACxC;aACC2N,mBAAmB,CAAC3jB,IAAI,CAAC8iB,GAAG,CAAC;aAC7B;;WAGD,IAAIqB,aAAa,IAAI,CAAClf,aAAG,CAACC,QAAQ,CAACif,aAAa,EAAED,cAAc,CAAC,EACjE;aACCjf,aAAG,CAACE,QAAQ,CAACgf,aAAa,EAAED,cAAc,CAAC;;WAG5C,IAAI,OAAI,CAAChH,cAAc,EAAE,EACzB;aACCjY,aAAG,CAACwV,MAAM,CAAC2J,YAAY,EAAEN,UAAU,CAAC/N,aAAa,CAAC,6CAA6C,CAAC,CAAC;;UAElG,CAAC;SAEF4N,mBAAmB,CAACc,IAAI,CAAC,UAACC,CAAC,EAAEC,CAAC;WAAA,OAAKA,CAAC,GAAGD,CAAC;WAAC;SACzCf,mBAAmB,CAACriB,OAAO,CAAC,UAACgB,EAAE,EAAK;WACnC4gB,iBAAiB,CAACjjB,MAAM,CAACqC,EAAE,EAAE,CAAC,CAAC;UAC/B,CAAC;QACF,MAED;SACC,IAAI,CAACD,MAAM,CAACuiB,cAAc,CAAC,EAAE,CAAC;;OAG/B,OAAO1B,iBAAiB;;;KACxB;KAAA,qCAEoBpjB,IAAI,EACzB;OAAA;OACC,IAAMuC,MAAM,GAAGvC,IAAI,CAACsf,MAAM;OAC1B,IAAM9c,EAAE,GAAGD,MAAM,CAACC,EAAE,IAAID,MAAM,CAAC0B,QAAQ;OAEvC,IAAIzB,EAAE,KAAK,IAAI,CAACD,MAAM,CAACuI,KAAK,EAAE,IAAItI,EAAE,KAAK,IAAI,CAACD,MAAM,CAACigB,WAAW,EAAE,EAClE;SACC,OAAOjgB,MAAM,CAACc,WAAW;;OAG1B,IAAI9B,KAAK,GAAG,IAAI;OAChBvB,IAAI,CAACuf,WAAW,CAAC/d,OAAO,CAAC,UAACjB,UAAU,EAAK;SACxC,IAAIgB,KAAK,KAAK,IAAI,EAClB;WACCA,KAAK,GAAG,OAAI,CAACoiB,oBAAoB,CAACpjB,UAAU,CAAC;;QAE9C,CAAC;OAEF,OAAOgB,KAAK;;;KACZ;KAAA,0CAEyByiB,UAAU,EACpC;OACC,IAAQxhB,EAAE,GAA+BwhB,UAAU,CAA3CxhB,EAAE;SAAEiB,IAAI,GAAyBugB,UAAU,CAAvCvgB,IAAI;SAAEshB,OAAO,GAAgBf,UAAU,CAAjCe,OAAO;SAAErjB,IAAI,GAAUsiB,UAAU,CAAxBtiB,IAAI;SAAEwE,GAAG,GAAK8d,UAAU,CAAlB9d,GAAG;OACpC,IAAI8e,GAAG,GAAG,EAAE;OAEZ,IAAID,OAAO,EACX;SACCC,GAAG,GAAGvW,aAAG,CAACC,MAAM,sTACwEqW,OAAO,EACzB,IAAI,CAACR,uBAAuB,CAACvgB,IAAI,CACtG,IAAI,EACJxB,EAAE,CACF,CAEA;QACD,MAED;SACC,IAAM0hB,SAAS,GAAGlf,aAAa,CAACmf,gBAAgB,CAACje,GAAG,CAAC;SAErD8e,GAAG,GAAGvW,aAAG,CAACC,MAAM,kVAEqBwV,SAAS,EACwB,IAAI,CAACK,uBAAuB,CAACvgB,IAAI,CACtG,IAAI,EACJxB,EAAE,CACF,CAEA;;OAGF,OAAOiM,aAAG,CAACC,MAAM,qkBACoDlM,EAAE,EAAiBA,EAAE,EACtFwiB,GAAG,EAEmEvhB,IAAI,EAAKA,IAAI,EAGpB/B,IAAI;;;KAIvE;KAAA,mDAGD;OACC,IAAI,IAAI,CAAC8I,gBAAgB,KAAK,IAAI,EAClC;SACC,IAAI,CAACA,gBAAgB,CAAC4D,KAAK,EAAE;;;;KAE9B;KAAA,6CAGD;OAAA;OACC,IAAMvO,MAAM,GAAG,IAAI,CAACyB,SAAS,EAAE;OAC/B,IAAQ0T,MAAM,GAAK,IAAI,CAACrK,aAAa,CAA7BqK,MAAM;OACd,IAAMiQ,YAAY,GAAGxW,aAAG,CAACC,MAAM,i+CAEE7O,MAAM,EASNmV,MAAM,EAAInV,MAAM,EAElBA,MAAM,EAAc,IAAI,CAACqlB,gCAAgC,CAAClhB,IAAI,CAC5F,IAAI,CAAC,EACE+B,aAAG,CAACC,UAAU,CAAC,kDAAkD,CAAC,EAEhBnG,MAAM,EAGf,IAAI,CAACqlB,gCAAgC,CAAClhB,IAAI,CAAC,IAAI,CAAC,EAEzF+B,aAAG,CAACC,UAAU,CAAC,6CAA6C,CAAC,EAGpB,IAAI,CAACkf,gCAAgC,CAAClhB,IAAI,CAAC,IAAI,CAAC,EAEnF+B,aAAG,CAACC,UAAU,CAAC,+CAA+C,CAAC,CAM5E;OAEDgC,EAAE,CAACmd,cAAc,CAACF,YAAY,EAAE,qBAAqB,EAAE,IAAI,CAACG,mBAAmB,CAACphB,IAAI,CAAC,IAAI,CAAC,CAAC;OAC3FgE,EAAE,CAACmd,cAAc,CAACF,YAAY,EAAE,6BAA6B,EAAE,UAACI,EAAE,EAAK;SACtEA,EAAE,CAACC,iBAAiB,GAAG,OAAI,CAACC,gBAAgB,CAACvhB,IAAI,CAAC,OAAI,CAAC;QACvD,CAAC;OAEF,OAAOihB,YAAY;;;KACnB;KAAA,iCAEgBjlB,IAAI,EAAEuK,QAAQ,EAC/B;OACC,IAAQ/H,EAAE,GAAiBxC,IAAI,CAAvBwC,EAAE;SAAEiB,IAAI,GAAWzD,IAAI,CAAnByD,IAAI;SAAE/B,IAAI,GAAK1B,IAAI,CAAb0B,IAAI;OACtB,IAAM8jB,WAAW,GAAGpmB,IAAI,CAACqmB,GAAG,CAAClb,QAAQ,EAAE,EAAE,CAAC;OAE1C,IAAI,CAAC,IAAI,CAACE,uBAAuB,CAACqO,GAAG,CAACtW,EAAE,CAAC,EACzC;SACC,IAAMkjB,UAAU,GAAG,IAAI1d,EAAE,CAAC8G,EAAE,CAAC+K,aAAa,CAAC;WAC1CrX,EAAE,0BAAmBA,EAAE,CAAE;WACzB0E,KAAK,EAAEse,WAAW;WAClB1L,QAAQ,EAAE,GAAG;WACbC,KAAK,EAAE,EAAE;WACTC,QAAQ,EAAE,CAAC;WACXC,IAAI,EAAE,KAAK;WACXC,KAAK,EAAElS,EAAE,CAAC8G,EAAE,CAAC+K,aAAa,CAACM,KAAK,CAACC,OAAO;WACxCuL,UAAU,EAAE3d,EAAE,CAAC8G,EAAE,CAAC+K,aAAa,CAAC+L,MAAM,CAACC;UACvC,CAAC;SACF,IAAMC,WAAW,GAAGrX,aAAG,CAACC,MAAM,qkBACuClM,EAAE,EACnEkjB,UAAU,CAACpL,YAAY,EAAE,EAE6C7W,IAAI,EAAKA,IAAI,EAGpB/B,IAAI,CAGtE;SAED,IAAI,CAAC+I,uBAAuB,CAAC9F,GAAG,CAACnC,EAAE,EAAEkjB,UAAU,CAAC;SAChDvgB,aAAG,CAACwV,MAAM,CAACmL,WAAW,EAAE,IAAI,CAAC1P,uBAAuB,EAAE,CAAC;;OAGxD,IAAI,CAACpW,IAAI,CAAC+lB,gBAAgB,EAC1B;SACC/lB,IAAI,CAAC+lB,gBAAgB,GAAG,CAAC;;OAG1B,IAAIP,WAAW,GAAGxlB,IAAI,CAAC+lB,gBAAgB,EACvC;SACC/lB,IAAI,CAAC+lB,gBAAgB,GAAG3mB,IAAI,CAAC4mB,IAAI,CAACR,WAAW,CAAC;SAC9CxlB,IAAI,CAAC+lB,gBAAgB,GAAG/lB,IAAI,CAAC+lB,gBAAgB,GAAG,GAAG,GAAG,GAAG,GAAG/lB,IAAI,CAAC+lB,gBAAgB;SAEjF,IAAI,IAAI,CAACtb,uBAAuB,CAACqO,GAAG,CAACtW,EAAE,CAAC,EACxC;WACC,IAAI,CAACiI,uBAAuB,CAACsI,GAAG,CAACvQ,EAAE,CAAC,CAACmJ,MAAM,CAAC3L,IAAI,CAAC+lB,gBAAgB,CAAC;;;;;KAGpE;KAAA,oCAEmBE,UAAU,EAAEZ,EAAE,EAAEa,IAAI,EAAEC,YAAY,EACtD;OACC,IAAI,OAAOD,IAAI,KAAK,WAAW,IAAI,OAAOC,YAAY,KAAK,WAAW,EACtE;SACC;;OAGD,IAAMC,YAAY,GAAGH,UAAU,CAACI,UAAU,CAAC/mB,QAAQ,EAAE;OACrD,IAAM0kB,UAAU,GAAG;SAClBxhB,EAAE,EAAE4jB,YAAY;SAChB3iB,IAAI,EAAEwiB,UAAU,CAACK,YAAY;SAC7BvB,OAAO,EAAEkB,UAAU,CAACM,WAAW;SAC/B7kB,IAAI,EAAEykB,YAAY,CAACzkB,IAAI;SACvBwE,GAAG,EAAEigB,YAAY,CAACjgB;QAClB;OAED,IAAI,CAAC3D,MAAM,CAACikB,cAAc,iCAAIJ,YAAY,EAAGA,YAAY,EAAG;OAC5D,IAAI,CAAC3b,uBAAuB,UAAO,CAAC0b,YAAY,CAAC3jB,EAAE,CAAC;OAEpD,IAAMikB,kBAAkB,GAAG,IAAI,CAACrQ,uBAAuB,EAAE,CAACH,aAAa,wBAAiBkQ,YAAY,CAAC3jB,EAAE,EAAG;OAC1G,IAAMkkB,gBAAgB,GAAG,IAAI,CAACC,yBAAyB,CAAC3C,UAAU,CAAC;OAEnE,IAAIyC,kBAAkB,EACtB;SACCthB,aAAG,CAACjD,OAAO,CAACukB,kBAAkB,EAAEC,gBAAgB,CAAC;QACjD,MAED;SACCvhB,aAAG,CAACwV,MAAM,CAAC+L,gBAAgB,EAAE,IAAI,CAACtQ,uBAAuB,EAAE,CAAC;;OAG7D,IAAM5T,EAAE,GAAG,IAAI,CAACD,MAAM,CAACuI,KAAK,EAAE;OAC9B,IAAM2Y,iBAAiB,GAAG,IAAI,CAAC9Y,aAAa,CAACtH,WAAW;OAExD,IAAIogB,iBAAiB,EACrB;SACC,IAAIjhB,EAAE,IAAIihB,iBAAiB,EAC3B;WACC,IAAI,CAAC9Y,aAAa,CAACtH,WAAW,CAACb,EAAE,CAAC,IAAIkkB,gBAAgB,CAACE,SAAS;UAChE,MAED;WACC,IAAI,CAACjc,aAAa,CAACtH,WAAW,CAACb,EAAE,CAAC,GAAGkkB,gBAAgB,CAACE,SAAS;;;OAIjE1Z,6BAAY,CAACC,IAAI,CAAC,yCAAyC,EAAE;SAAEvD,MAAM,EAAE;QAAc,CAAC;;;KACtF;KAAA,kCAEiBid,QAAQ,EAC1B;OACC,IAAI,CAACna,SAAS,GAAG+B,aAAG,CAACC,MAAM,+NAEL,IAAI,CAACpN,SAAS,EAAE,EACjCulB,QAAQ,CAGZ;OAED,OAAO,IAAI,CAACna,SAAS;;;KACrB;KAAA,mCAEkBma,QAAQ,EAC3B;OACC,IAAMhnB,MAAM,GAAG,IAAI,CAACyB,SAAS,EAAE;OAC/B,IAAM4F,KAAK,GAAG,IAAI,CAAC3E,MAAM,CAACkJ,iBAAiB,EAAE;OAC7C,IAAMqO,QAAQ,GAAG,IAAI,CAACvX,MAAM,CAACiJ,aAAa,EAAE;OAC5C,IAAMsb,OAAO,GAAG;SACfC,gBAAgB,EAAEtY,aAAG,CAACC,MAAM,uJAAkE;SAC9FsY,iBAAiB,EAAEvY,aAAG,CAACC,MAAM,gNACoC,IAAI,CAACuY,wBAAwB,CAACjjB,IAAI,CAAC,IAAI,CAAC,EACrG+B,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC,CAEjD;SACDkhB,WAAW,EAAE,EAAE;SACfC,SAAS,EAAE1Y,aAAG,CAACC,MAAM;QACrB;OAED,IAAI,IAAI,CAAC0Y,WAAW,EAAE,EACtB;SACC,IAAMC,eAAe,GAAG5Y,aAAG,CAACC,MAAM,iMACkB,IAAI,CAAC4Y,uBAAuB,CAACtjB,IAAI,CAAC,IAAI,CAAC,EACvF+B,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC,CAEjD;SACD,IAAMkhB,WAAW,GAAGzY,aAAG,CAACC,MAAM,yMAC4B,IAAI,CAAC6Y,kBAAkB,CAACvjB,IAAI,CAAC,IAAI,CAAC,EACxF+B,aAAG,CAACC,UAAU,CAAC,+BAA+B,CAAC,CAElD;SAEDb,aAAG,CAACwV,MAAM,CAAC0M,eAAe,EAAEP,OAAO,CAACC,gBAAgB,CAAC;SACrDD,OAAO,CAACI,WAAW,GAAGA,WAAW;;OAGlC,IAAI,IAAI,CAAC5D,cAAc,EAAE,EACzB;SACC,IAAMkE,kBAAkB,GAAG/Y,aAAG,CAACC,MAAM,oMACkB,IAAI,CAACsI,aAAa,CAAChT,IAAI,CAAC,IAAI,CAAC,EAChF+B,aAAG,CAACC,UAAU,CAAC,kCAAkC,CAAC,CAErD;SACDb,aAAG,CAACwV,MAAM,CAAC6M,kBAAkB,EAAEV,OAAO,CAACC,gBAAgB,CAAC;;OAGzD,IAAI,CAAC,IAAI,CAACU,YAAY,EAAE,EACxB;SACCX,OAAO,CAACK,SAAS,CAAClb,KAAK,CAACyb,UAAU,GAAG,QAAQ;;OAG9C,IAAI,CAAC,IAAI,CAACC,qBAAqB,EAAE,EACjC;SACCb,OAAO,CAACE,iBAAiB,GAAG,EAAE;;OAG/B,IAAI,CAACzc,QAAQ,GAAG,IAAIvC,EAAE,CAAC8G,EAAE,CAAC8Y,WAAW,CAAC;SACrC1gB,KAAK,EAALA,KAAK;SACL4S,QAAQ,EAARA,QAAQ;SACRpY,IAAI,EAAEsG,EAAE,CAAC8G,EAAE,CAAC8Y,WAAW,CAACC,IAAI,CAACC,MAAM;SACnCC,SAAS,EAAE/iB,aAAa,CAAC8G,eAAe,CAAC5E,KAAK,EAAE4S,QAAQ;QACxD,CAAC;OAEF,IAAI,CAACpN,SAAS,GAAG+B,aAAG,CAACC,MAAM,k0CAC4D7O,MAAM,EAExFinB,OAAO,CAACK,SAAS,EAIA,IAAI,CAACa,iBAAiB,CAAChkB,IAAI,CAAC,IAAI,CAAC,EACnC,IAAI,CAACikB,eAAe,CAACjkB,IAAI,CAAC,IAAI,CAAC,EAC3C,IAAI,CAACoT,cAAc,EAAE,EAIqCvX,MAAM,EAC/D,IAAI,CAAC0K,QAAQ,CAAC+P,YAAY,EAAE,EAM/BwM,OAAO,CAACE,iBAAiB,EACzBF,OAAO,CAACI,WAAW,EACiD,IAAI,CAACgB,qBAAqB,CAAClkB,IAAI,CACxG,IAAI,CAAC,EAIoDnE,MAAM,EAC1DgnB,QAAQ,EAETC,OAAO,CAACC,gBAAgB,CAG5B;OAED,OAAO,IAAI,CAACra,SAAS;;;KACrB;KAAA,uCAEsBma,QAAQ,EAC/B;OACC,IAAMhnB,MAAM,GAAG,IAAI,CAACyB,SAAS,EAAE;OAC/B,IAAMwlB,OAAO,GAAG;SACfxC,YAAY,EAAE7V,aAAG,CAACC,MAAM,8JAAwD,IAAI,CAACsI,aAAa,CAAChT,IAAI,CAAC,IAAI,CAAC,CAAa;SAC1HmjB,SAAS,EAAE1Y,aAAG,CAACC,MAAM,yIAAoD;SACzErL,WAAW,EAAE,IAAI,CAAC8kB,oBAAoB;QACtC;OAED,IAAI,CAAC,IAAI,CAAC7E,cAAc,EAAE,EAC1B;SACCwD,OAAO,CAACxC,YAAY,GAAG,EAAE;;OAG1B,IAAI,CAAC,IAAI,CAACmD,YAAY,EAAE,EACxB;SACCX,OAAO,CAACK,SAAS,CAAClb,KAAK,CAACyb,UAAU,GAAG,QAAQ;;OAG9C,IAAI,CAACnd,QAAQ,GAAG,IAAIvC,EAAE,CAAC8G,EAAE,CAAC+K,aAAa,CAAC;SACvCrX,EAAE,qBAAc3C,MAAM,CAAE;SACxBqH,KAAK,EAAE,IAAI,CAAC3E,MAAM,CAACkJ,iBAAiB,EAAE;SACtCqO,QAAQ,EAAE,IAAI,CAACvX,MAAM,CAACiJ,aAAa,EAAE;SACrCuO,KAAK,EAAE,EAAE;SACTC,QAAQ,EAAE,CAAC;SACXC,IAAI,EAAE,KAAK;SACXC,KAAK,EAAElS,EAAE,CAAC8G,EAAE,CAAC+K,aAAa,CAACM,KAAK,CAACC;QACjC,CAAC;OAEF,IAAI,CAAC1N,SAAS,GAAG+B,aAAG,CAACC,MAAM,+qDACc7O,MAAM,EACM,IAAI,CAAC0C,MAAM,CAAC0I,aAAa,EAAE,GAAG,6BAA6B,GAAG,EAAE,EAClG,IAAI,CAACmd,yBAAyB,CAACpkB,IAAI,CAAC,IAAI,CAAC,EAAgB,IAAI,CAACqkB,uBAAuB,CAACrkB,IAAI,CAC5G,IAAI,CAAC,EACD8iB,OAAO,CAACK,SAAS,EAG2C,IAAI,CAAC9M,qBAAqB,CAACrW,IAAI,CAC/F,IAAI,CAAC,EAC8EnE,MAAM,EACjF,IAAI,CAAC0K,QAAQ,CAAC+P,YAAY,EAAE,EAOU,IAAI,CAAC/X,MAAM,CAAC6V,mBAAmB,EAAE,EAC1E,IAAI,CAAC7V,MAAM,CAACsU,cAAc,EAAE,GAAG,IAAI,CAAC4G,kBAAkB,EAAE,GAAG,EAAE,EAE5D,IAAI,CAACrG,cAAc,EAAE,EAItB0P,OAAO,CAACxC,YAAY,EAG0CzkB,MAAM,EACvD,IAAI,CAACyoB,qBAAqB,CAACtkB,IAAI,CAAC,IAAI,CAAC,EAIenE,MAAM,EACvEinB,OAAO,CAACzjB,WAAW,EAG2CxD,MAAM,EACrEgnB,QAAQ,CAGZ;OAED,OAAO,IAAI,CAACna,SAAS;;;KACrB;KAAA,4BAGD;OACC,IAAMma,QAAQ,GAAG,EAAE;OAEnB,IAAI,CAAC9mB,WAAW,CAACyB,OAAO,CAAC,UAACjB,UAAU,EAAK;SACxCsmB,QAAQ,CAAC3mB,IAAI,CAACK,UAAU,CAAC0hB,SAAS,EAAE,CAAC;QACrC,CAAC;OAEF,IAAI,IAAI,CAACpX,UAAU,EAAE,EACrB;SACC,OAAO,IAAI,CAAC0d,iBAAiB,CAAC1B,QAAQ,CAAC;;OAGxC,IAAI,IAAI,CAACjb,WAAW,EAAE,EACtB;SACC,IAAM4c,eAAe,GAAG,IAAI,CAACC,kBAAkB,CAAC5B,QAAQ,CAAC;SAEzD,IAAI,CAAChZ,sBAAsB,EAAE;SAE7B,OAAO2a,eAAe;;OAGvB,OAAO,IAAI,CAACE,sBAAsB,CAAC7B,QAAQ,CAAC;;;GAC5C;CAAA,EA32F0B/mB,iBAAiB;AAAA,KA82FvC6oB,mBAAmB;GAAA;GAAA;KAAA;KAAA;KAAA;KAAA;OAAA;;KAAA;KAAA,kFAEhBA,mBAAmB;KAAA,yFAEZ,oCAAoC;KAAA,wFACrC,mCAAmC;KAAA,0FACjC,wCAAwC;KAAA,yFACzC,+BAA+B;KAAA,sFAElC,4BAA4B;KAAA,sFAC5B,4BAA4B;KAAA,8FAEpB;OACnB9e,MAAM,EAAE,CACP,+BAA+B,EAC/B,kCAAkC,EAClC,4BAA4B,CAC5B;OACD7J,IAAI,EAAE,CACL,+BAA+B,EAC/B,kCAAkC,EAClC,4BAA4B,EAC5B,qCAAqC,EACrC,mCAAmC,EACnC,sCAAsC;MAEvC;KAAA;;GAAA;KAAA;KAAA,qCAaD;OACC,IAAMmiB,eAAe,GAAG;SACvBM,SAAS,EAAE,IAAI,CAAClgB,MAAM,CAACmgB,WAAW,EAAE;SACpCzR,KAAK,EAAE/M,cAAI,CAACoN,MAAM,CAAC,IAAI,CAAC/O,MAAM,CAACwK,QAAQ,EAAE,CAAC;SAC1C6V,WAAW,EAAE,IAAI,CAACrgB,MAAM,CAAC0I,aAAa,EAAE;SACxC4X,YAAY,EAAE,IAAI,CAACtgB,MAAM,CAACsU,cAAc,EAAE;SAC1CiM,OAAO,EAAE,EAAE;SACXC,WAAW,EAAE,IAAI,CAACxgB,MAAM,CAACsZ,cAAc,EAAE,IAAI;QAC7C;OACD,IAAM+M,YAAY,GAAG;SACpBrW,UAAU,EAAE,GAAG;SACfP,OAAO,EAAE;QACT;OAED,IAAI,CAACzP,MAAM,CAACiV,UAAU,EAAE,CAAChW,OAAO,CAAC,UAAC0F,KAAK,EAAE8b,GAAG,EAAK;SAChDb,eAAe,CAACW,OAAO,CAACE,GAAG,CAAC,GAAG;WAAEve,IAAI,EAAEmkB,YAAY,CAAC1hB,KAAK,CAACrC,IAAI;UAAG;QACjE,CAAC;OAEF,OAAOsd,eAAe;;;KACtB;KAAA,uCAGD;OACC0G,WAAW,CAACC,MAAM,CAACC,eAAe,CAAC,sBAAsB,EAAE;SAC1DC,MAAM,EAAE,IAAI,CAACre,aAAa,CAAC2T,QAAQ;SACnC2K,QAAQ,EAAE,IAAI,CAACte,aAAa,CAACse;QAC7B,EAAE,YAAY,CAAC;;;KAChB;KAAA,oCAGD;OAAA;OACC,OAAO,IAAIpH,OAAO,CAAC,UAACC,OAAO,EAAEoH,MAAM,EAAK;SACvC,IAAM3mB,MAAM,GAAG,OAAI,CAAC2gB,kBAAkB,EAAE;SACxC,IAAMvjB,MAAM,GAAG,OAAI,CAACC,SAAS,EAAE;SAE/B2C,MAAM,CAACkgB,SAAS,GAAG9iB,MAAM,CAAC4C,MAAM,CAACuI,KAAK,EAAE,KAAKnL,MAAM,CAACkL,UAAU,EAAE,GAAG,CAAC,GAAG,IAAI,CAAC;SAE5E7C,EAAE,CAACyW,IAAI,CAACC,SAAS,CAAC,0BAA0B,EAAE;WAC7C1R,IAAI,EAAE;aACLgc,MAAM,EAAE,OAAI,CAACre,aAAa,CAAC2T,QAAQ;aACnC/b,MAAM,EAANA;;UAED,CAAC,CAACsM,IAAI,CAAC,UAAC8P,QAAQ,EAAK;WACrB,IAAIA,QAAQ,CAACwK,MAAM,KAAK,SAAS,EACjC;aACC,IAAQ9J,aAAa,GAAKV,QAAQ,CAAC3R,IAAI,CAA/BqS,aAAa;aACrB,OAAI,CAAC9c,MAAM,CAAC6mB,KAAK,CAAC/J,aAAa,CAAC7c,EAAE,CAAC;aACnCsf,OAAO,EAAE;YACT,MAED;aACC,OAAI,CAACuH,oBAAoB,EAAE;aAC3BH,MAAM,EAAE;;UAET,CAAC,SAAM,CAAC,YAAM;WACd,OAAI,CAACG,oBAAoB,EAAE;WAC3BH,MAAM,EAAE;UACR,CAAC;QACF,CAAC;;;KACF;KAAA,qCAEoB3mB,MAAM,EAC3B;OAAA,IAD6B+mB,cAAc,uEAAG,IAAI;OAEjD,IAAMC,cAAc,GAAGD,cAAc,IAAI,IAAI,CAACD,oBAAoB,CAACrlB,IAAI,CAAC,IAAI,CAAC;OAE7EgE,EAAE,CAACyW,IAAI,CAACC,SAAS,CAAC,6BAA6B,EAAE;SAChD1R,IAAI,EAAE;WACLgc,MAAM,EAAE,IAAI,CAACre,aAAa,CAAC2T,QAAQ;WACnCc,eAAe,EAAE,IAAI,CAAC7c,MAAM,CAACuI,KAAK,EAAE;WACpCvI,MAAM,EAANA;;QAED,CAAC,CAACsM,IAAI,CAAC,UAAC8P,QAAQ,EAAK;SACrB,IAAIA,QAAQ,CAACwK,MAAM,KAAK,SAAS,EACjC;WACCI,cAAc,EAAE;;QAEjB,CAAC,SAAM,CAAC;SAAA,OAAMA,cAAc,EAAE;SAAC;;;KAChC;KAAA,uCAGD;OAAA;OACCvhB,EAAE,CAACyW,IAAI,CAACC,SAAS,CAAC,6BAA6B,EAAE;SAChD1R,IAAI,EAAE;WACLgc,MAAM,EAAE,IAAI,CAACre,aAAa,CAAC2T,QAAQ;WACnCc,eAAe,EAAE,IAAI,CAAC7c,MAAM,CAACuI,KAAK;;QAEnC,CAAC,CAAC+D,IAAI,CAAC,UAAC8P,QAAQ,EAAK;SACrB,IAAIA,QAAQ,CAACwK,MAAM,KAAK,SAAS,EACjC;WACC,OAAI,CAACE,oBAAoB,EAAE;;QAE5B,CAAC,SAAM,CAAC;SAAA,OAAM,OAAI,CAACA,oBAAoB,EAAE;SAAC;;;KAC3C;KAAA,yCAEwBtkB,MAAM,EAAEykB,UAAU,EAC3C;OAAA;OACC,IAAMC,GAAG,GAAG;SACXzX,OAAO,EAAE;WACRiN,UAAU,EAAE,aAAa;WACzByK,SAAS,EAAE,aAAa;WACxBC,MAAM,EAAE;UACR;SACDpX,UAAU,EAAE;WACX0M,UAAU,EAAE,gBAAgB;WAC5ByK,SAAS,EAAE,gBAAgB;WAC3BC,MAAM,EAAE;;QAET;OACD,IAAMC,WAAW,GAAGH,GAAG,CAAC1kB,MAAM,CAACF,IAAI,CAAC;OAEpC,IAAMglB,oBAAoB,GAAG,iCAAiC;OAC9D,IAAMC,kBAAkB,GAAG;SAC1Bd,MAAM,EAAE,IAAI,CAACre,aAAa,CAAC2T,QAAQ;SACnCc,eAAe,EAAE,IAAI,CAAC7c,MAAM,CAACuI,KAAK,EAAE;SACpC3H,OAAO,kCAAK4B,MAAM,CAACvC,EAAE,EAAGonB,WAAW,CAACD,MAAM;QAC1C;OAED3hB,EAAE,CAACyW,IAAI,CAACC,SAAS,CAACmL,oBAAoB,EAAE;SAAE7c,IAAI,EAAE8c;QAAoB,CAAC,CAACjb,IAAI,CAAC,UAACkb,sBAAsB,EAAK;SACtG,IAAIA,sBAAsB,CAACZ,MAAM,KAAK,SAAS,EAC/C;WACC,IAAIK,UAAU,EACd;aACC,OAAI,CAACjN,gBAAgB,EAAE;;WAGxBvU,EAAE,CAACyW,IAAI,CAACC,SAAS,sBAAekL,WAAW,CAAC3K,UAAU,GAAI;aACzDjS,IAAI;eACHgc,MAAM,EAAE,OAAI,CAACre,aAAa,CAAC2T;gBAC1BsL,WAAW,CAACF,SAAS,EAAG,CAAC3kB,MAAM,CAACvC,EAAE,CAAC;YAErC,CAAC;UACF,MAED;WACC,OAAI,CAACD,MAAM,CAACwV,YAAY,CAAChT,MAAM,CAACvC,EAAE,CAAC;;QAEpC,CAAC,SAAM,CAAC;SAAA,OAAM,OAAI,CAACD,MAAM,CAACwV,YAAY,CAAChT,MAAM,CAACvC,EAAE,CAAC;SAAC;;;KACnD;KAAA,wCAEuBwnB,SAAS,EACjC;OAAA;OACChiB,EAAE,CAACyW,IAAI,CAACC,SAAS,CAAC,gCAAgC,EAAE;SACnD1R,IAAI,EAAE;WACLgc,MAAM,EAAE,IAAI,CAACre,aAAa,CAAC2T,QAAQ;WACnCc,eAAe,EAAE,IAAI,CAAC7c,MAAM,CAACuI,KAAK,EAAE;WACpCmf,WAAW,EAAED,SAAS,CAACznB,MAAM,CAACuI,KAAK;;QAEpC,CAAC,CAAC+D,IAAI,CAAC,UAAC8P,QAAQ,EAAK;SACrB,IAAIA,QAAQ,CAACwK,MAAM,KAAK,SAAS,EACjC;WACC,OAAI,CAACE,oBAAoB,EAAE;;QAE5B,CAAC,SAAM,CAAC;SAAA,OAAM,OAAI,CAACA,oBAAoB,EAAE;SAAC;;;KAC3C;KAAA,oCAGD;OACC,IAAMa,SAAS,GAAG,oCAAoC;OACtD,IAAMla,cAAc,GAAG,EAAE;OACzB,IAAMma,sBAAsB,GAAG;SAC9BC,SAAS,EAAE;WACVC,UAAU,EAAE;aACXtR,SAAS,EAAE,IAAI,CAACxF,qBAAqB,CAACvP,IAAI,CAAC,IAAI,CAAC;aAChDsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,iBAAc;aAChDK,OAAO,EAAE;YACT;WACDC,aAAa,EAAE;aACdzR,SAAS,EAAE,IAAI,CAACxF,qBAAqB,CAACvP,IAAI,CAAC,IAAI,CAAC;aAChDsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,oBAAiB;aACnDK,OAAO,EAAE;YACT;WACDE,MAAM,EAAE;aACP1R,SAAS,EAAE,IAAI,CAACqE,cAAc,CAACpZ,IAAI,CAAC,IAAI,CAAC;aACzCsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,YAAS;aAC3CK,OAAO,EAAE;YACT;WACD/d,MAAM,EAAE;aACPuM,SAAS,EAAE,IAAI,CAACuK,cAAc,CAACtf,IAAI,CAAC,IAAI,CAAC;aACzCsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,YAAS;aAC3CK,OAAO,EAAE;;UAEV;SACDG,aAAa,EAAE;WACdC,OAAO,EAAE;aACR5R,SAAS,EAAE,IAAI,CAACqE,cAAc,CAACpZ,IAAI,CAAC,IAAI,CAAC;aACzCsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,cAAW;aAC7CK,OAAO,EAAE;YACT;WACDF,UAAU,EAAE;aACXtR,SAAS,EAAE,IAAI,CAACxF,qBAAqB,CAACvP,IAAI,CAAC,IAAI,CAAC;aAChDsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,iBAAc;aAChDK,OAAO,EAAE;YACT;WACDC,aAAa,EAAE;aACdzR,SAAS,EAAE,IAAI,CAACxF,qBAAqB,CAACvP,IAAI,CAAC,IAAI,CAAC;aAChDsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,oBAAiB;aACnDK,OAAO,EAAE;YACT;WACD7N,KAAK,EAAE;aACN3D,SAAS,EAAE,IAAI,CAAC6R,aAAa,CAAC5mB,IAAI,CAAC,IAAI,CAAC;aACxCsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,YAAS;aAC3CK,OAAO,EAAE;YACT;WACD9N,MAAM,EAAE;aACP1D,SAAS,EAAE,IAAI,CAAC8R,cAAc,CAAC7mB,IAAI,CAAC,IAAI,CAAC;aACzCsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,aAAU;aAC5CK,OAAO,EAAE;YACT;WACDO,SAAS,EAAE;aACV/R,SAAS,EAAE,IAAI,CAACqE,cAAc,CAACpZ,IAAI,CAAC,IAAI,CAAC;aACzCsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,eAAY;aAC9CK,OAAO,EAAE;YACT;WACDQ,kBAAkB,EAAE;aACnBhS,SAAS,EAAE,IAAI,CAACqE,cAAc,CAACpZ,IAAI,CAAC,IAAI,CAAC;aACzCsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,0BAAuB;aACzDK,OAAO,EAAE;YACT;WACD/d,MAAM,EAAE;aACPuM,SAAS,EAAE,IAAI,CAACuK,cAAc,CAACtf,IAAI,CAAC,IAAI,CAAC;aACzCsmB,WAAW,EAAE,GAAG;aAChB5nB,KAAK,EAAEqD,aAAG,CAACC,UAAU,WAAIkkB,SAAS,YAAS;aAC3CK,OAAO,EAAE;;;QAGX;OACD,IAAM1lB,IAAI,GAAI,IAAI,CAAC+G,WAAW,EAAE,GAAG,WAAW,GAAG,eAAgB;OAEjErI,MAAM,CAACC,IAAI,CAAC2mB,sBAAsB,CAACtlB,IAAI,CAAC,CAAC,CAACrD,OAAO,CAAC,UAACgB,EAAE,EAAK;SACzD,4BAAmD2nB,sBAAsB,CAACtlB,IAAI,CAAC,CAACrC,EAAE,CAAC;WAA3E8nB,WAAW,yBAAXA,WAAW;WAAE5nB,KAAK,yBAALA,KAAK;WAAE6nB,OAAO,yBAAPA,OAAO;WAAExR,SAAS,yBAATA,SAAS;SAC9C/I,cAAc,CAAC9P,IAAI,CAAC;WAAEsC,EAAE,EAAFA,EAAE;WAAE8nB,WAAW,EAAXA,WAAW;WAAE5nB,KAAK,EAALA,KAAK;WAAE6nB,OAAO,EAAPA,OAAO;WAAES,OAAO,EAAE,CAACjS,SAAS;UAAI,CAAC;QAC/E,CAAC;OAEF,OAAO/I,cAAc;;;KACrB;KAAA,yCAGD;OACC,IAAMU,SAAS,GAAG,IAAI,CAACC,YAAY,EAAE;OACrC,IAAMC,UAAU,GAAG,IAAI,CAAC3P,WAAW,EAAE,CAACF,cAAc,EAAE,CAAC8P,MAAM,CAAC,UAAA7Q,IAAI;SAAA,OAAIA,IAAI,KAAK0Q,SAAS;SAAC;OACzF,IAAMua,mBAAmB,GAAG,EAAE;OAE9Bra,UAAU,CAACpP,OAAO,CAAC,UAACjB,UAAU,EAAK;SAClC0qB,mBAAmB,CAAC/qB,IAAI,CAAC;WACxBsC,EAAE,EAAEjC,UAAU,CAACe,SAAS,EAAE;WAC1BoB,KAAK,EAAEwB,cAAI,CAACoN,MAAM,CAAC/Q,UAAU,CAACgC,MAAM,CAACwK,QAAQ,EAAE,CAAC;WAChDud,WAAW,EAAE;UACb,CAAC;QACF,CAAC;OACFW,mBAAmB,CAAC/qB,IAAI,CAAC;SACxBsC,EAAE,EAAE,cAAc;SAClBE,KAAK,EAAE+L,aAAG,CAAC0B,OAAO,4FAAK,gEAAgE,CAAE;SACzFma,WAAW,EAAE;QACb,CAAC;OAEF,OAAOW,mBAAmB;;;KAC1B;KAAA,sCAEqBC,SAAS,EAC/B;OACC,IAAQrrB,MAAM,GAAmCqrB,SAAS,CAAlDrrB,MAAM;SAAEkF,MAAM,GAA2BmmB,SAAS,CAA1CnmB,MAAM;SAAE9E,QAAQ,GAAiBirB,SAAS,CAAlCjrB,QAAQ;SAAEupB,UAAU,GAAK0B,SAAS,CAAxB1B,UAAU;OAC5C,IAAM1hB,IAAI,GAAG,IAAI,CAACrG,SAAS,CAAC5B,MAAM,CAAC;OAEnC,IAAI,CAACiI,IAAI,EACT;SACC;;OAGD,IAAMpF,KAAK,GAAGoF,IAAI,CAACvF,MAAM,CAACwK,QAAQ,EAAE;OACpC,IAAIoE,QAAQ,GAAG,EAAE;OAEjBpM,MAAM,CAACH,aAAa,GAAGV,cAAI,CAACC,MAAM,CAACY,MAAM,CAACH,aAAa,CAAC;OAExD,IAAI4kB,UAAU,EACd;SACC,IAAMnjB,KAAK,GAAGpG,QAAQ,IAAI,CAAC;SAC3B,IAAM0R,UAAU,GAAKtL,KAAK,KAAK,CAAC,IAAIA,KAAK,GAAG,CAAC,KAAK,CAAC,IAAI3D,KAAK,CAACkP,MAAM,CAACvL,KAAK,GAAG,CAAC,CAAC,KAAK,GAAG,GAAI,EAAE,GAAG,GAAI;SACnG,IAAMwL,QAAQ,GAAInP,KAAK,CAACkP,MAAM,CAACvL,KAAK,GAAG,CAAC,CAAC,KAAK,GAAG,GAAG,EAAE,GAAG,GAAI;SAC7D,IAAMyL,YAAY,aAAMpP,KAAK,CAAC+E,KAAK,CAAC,CAAC,EAAEpB,KAAK,GAAG,CAAC,CAAC,SAAGsL,UAAU,SAAG5M,MAAM,CAACH,aAAa,SAAGiN,QAAQ,CAAE;SAClGV,QAAQ,aAAMW,YAAY,SAAGpP,KAAK,CAAC+E,KAAK,CAACpB,KAAK,CAAC,CAAE;QACjD,MAED;SACC,IAAM6K,KAAK,GAAIxO,KAAK,CAAC+E,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,GAAG,EAAE,GAAG,GAAI;SAClD0J,QAAQ,aAAMzO,KAAK,SAAGwO,KAAK,SAAGnM,MAAM,CAACH,aAAa,CAAE;;OAGrDkD,IAAI,CAACvF,MAAM,CAAC6O,SAAS,CAACrM,MAAM,CAAC;OAC7B+C,IAAI,CAACuJ,WAAW,CAACnN,cAAI,CAACoN,MAAM,CAACH,QAAQ,CAAC,CAAC;OACvCrJ,IAAI,CAACyJ,eAAe,EAAE;OAEtB,IAAI,CAAC,IAAI,CAAC4Z,aAAa,EAAE,EACzB;SACCrjB,IAAI,CAACsjB,oBAAoB,CAAC;WAAEna,KAAK,EAAE/M,cAAI,CAACoN,MAAM,CAACxJ,IAAI,CAACvF,MAAM,CAACwK,QAAQ,EAAE;UAAG,CAAC;SACzEjF,IAAI,CAACujB,wBAAwB,CAACtmB,MAAM,EAAEykB,UAAU,CAAC;QACjD,MACI,IAAIA,UAAU,EACnB;SACC1hB,IAAI,CAACyU,gBAAgB,EAAE;;;;KAExB;KAAA,qCAEoB2O,SAAS,EAC9B;OACC,IAAQrrB,MAAM,GAAiBqrB,SAAS,CAAhCrrB,MAAM;SAAEmkB,UAAU,GAAKkH,SAAS,CAAxBlH,UAAU;OAC1B,IAAMlc,IAAI,GAAG,IAAI,CAACrG,SAAS,CAAC5B,MAAM,CAAC;OAEnC,IAAIiI,IAAI,EACR;SACC,IAAMkb,GAAG,GAAGzf,MAAM,CAACC,IAAI,CAACwgB,UAAU,CAAC,CAAC,CAAC,CAAC;SACtC,IAAM9c,KAAK,GAAG3D,MAAM,CAAC+nB,MAAM,CAACtH,UAAU,CAAC,CAAC,CAAC,CAAC;SAE1Clc,IAAI,CAACvF,MAAM,CAACikB,cAAc,4CAAQxD,GAAG,GAAK9b,KAAK,EAAG;;;;KAEnD;KAAA,wCAEuBgkB,SAAS,EACjC;OACC,IAAQrrB,MAAM,GAAmBqrB,SAAS,CAAlCrrB,MAAM;SAAEumB,YAAY,GAAK8E,SAAS,CAA1B9E,YAAY;OAC5B,IAAMte,IAAI,GAAG,IAAI,CAACrG,SAAS,CAAC5B,MAAM,CAAC;OAEnC,IAAIiI,IAAI,EACR;SACCA,IAAI,CAACvF,MAAM,CAAC4T,gBAAgB,CAACiQ,YAAY,CAAC;SAC1Cte,IAAI,CAACvF,MAAM,CAAC4T,gBAAgB,YAAKiQ,YAAY,EAAG;;;;KAEjD;KAAA,wCAEuBmF,aAAa,EAAEC,UAAU,EACjD;OACC,IAAMC,cAAc,GAAGloB,MAAM,CAACC,IAAI,CAAC,IAAI,CAACjB,MAAM,CAACsZ,cAAc,EAAE,CAAC;OAChE,IAAM6P,kBAAkB,GAAGD,cAAc,CAAC5a,MAAM,CAAC,UAAArO,EAAE;SAAA,OAAI,CAAC+oB,aAAa,CAACzO,QAAQ,CAACta,EAAE,CAAC;SAAC,CAAC9B,MAAM;OAE1F,OAAOgrB,kBAAkB,GAAGF,UAAU,CAAC9qB,MAAM;;;KAC7C;KAAA,0CAEyBirB,gBAAgB,EAC1C;OACC,IAAMC,oBAAoB,GAAGnd,aAAG,CAACC,MAAM,yNAC0B,IAAI,CAACpN,SAAS,EAAE,EAAc,IAAI,CAACuqB,wBAAwB,CAAC7nB,IAAI,CAChI,IAAI,CAAC,EACF2nB,gBAAgB,GAAG,CAAC,oEAA2DA,gBAAgB,cAAW,EAAE,CAE/G;OACDxmB,aAAG,CAACjD,OAAO,CAAC,IAAI,CAACkU,uBAAuB,EAAE,EAAEwV,oBAAoB,CAAC;;;KACjE;KAAA,sCAEqBL,aAAa,EAAEC,UAAU,EAC/C;OAAA,IADiDnoB,WAAW,uEAAG,IAAI;OAElE,IAAIA,WAAW,EACf;SACC,IAAI,CAACd,MAAM,CAACuiB,cAAc,CAACzhB,WAAW,CAAC;;OAGxC,IAAMyoB,oBAAoB,GAAG,IAAI,CAACC,uBAAuB,CAACR,aAAa,EAAEC,UAAU,CAAC;OACpF,IAAI,CAACQ,yBAAyB,CAACF,oBAAoB,CAAC;;;KACpD;KAAA,mCAEkBZ,SAAS,EAC5B;OACC,IAAQrrB,MAAM,GAA8DqrB,SAAS,CAA7ErrB,MAAM;SAAE0rB,aAAa,GAA+CL,SAAS,CAArEK,aAAa;SAAEC,UAAU,GAAmCN,SAAS,CAAtDM,UAAU;SAAEnoB,WAAW,GAAsB6nB,SAAS,CAA1C7nB,WAAW;SAAE+b,eAAe,GAAK8L,SAAS,CAA7B9L,eAAe;OACvE,IAAMtX,IAAI,GAAIjI,MAAM,GAAG,IAAI,CAAC4B,SAAS,CAAC5B,MAAM,CAAC,GAAG,IAAI,CAACkL,QAAQ,CAACqU,eAAe,CAAE;OAE/E,IAAItX,IAAI,EACR;SACCA,IAAI,CAACmkB,qBAAqB,CAACV,aAAa,EAAEC,UAAU,EAAEnoB,WAAW,CAAC;;;;KAEnE;KAAA,mCAEkB6nB,SAAS,EAC5B;OACC,IAAQrrB,MAAM,GAA6CqrB,SAAS,CAA5DrrB,MAAM;SAAE0rB,aAAa,GAA8BL,SAAS,CAApDK,aAAa;SAAEC,UAAU,GAAkBN,SAAS,CAArCM,UAAU;SAAEnoB,WAAW,GAAK6nB,SAAS,CAAzB7nB,WAAW;OACtD,IAAMyE,IAAI,GAAG,IAAI,CAACrG,SAAS,CAAC5B,MAAM,CAAC;OAEnC,IAAIiI,IAAI,EACR;SACCA,IAAI,CAACmkB,qBAAqB,CAACV,aAAa,EAAEC,UAAU,EAAEnoB,WAAW,CAAC;;;;KAEnE;KAAA,uCAEsB6nB,SAAS,EAChC;OACC,IAAQrrB,MAAM,GAAiDqrB,SAAS,CAAhErrB,MAAM;SAAE0rB,aAAa,GAAkCL,SAAS,CAAxDK,aAAa;SAAEC,UAAU,GAAsBN,SAAS,CAAzCM,UAAU;SAAEpM,eAAe,GAAK8L,SAAS,CAA7B9L,eAAe;OAC1D,IAAMtX,IAAI,GAAIjI,MAAM,GAAG,IAAI,CAAC4B,SAAS,CAAC5B,MAAM,CAAC,GAAG,IAAI,CAACkL,QAAQ,CAACqU,eAAe,CAAE;OAE/E,IAAItX,IAAI,EACR;SACCA,IAAI,CAACmkB,qBAAqB,CAACV,aAAa,EAAEC,UAAU,CAAC;;;;KAEtD;KAAA,uCAEsBN,SAAS,EAChC;OACC,IAAQrrB,MAAM,GAAgCqrB,SAAS,CAA/CrrB,MAAM;SAAE0rB,aAAa,GAAiBL,SAAS,CAAvCK,aAAa;SAAEC,UAAU,GAAKN,SAAS,CAAxBM,UAAU;OACzC,IAAM1jB,IAAI,GAAG,IAAI,CAACrG,SAAS,CAAC5B,MAAM,CAAC;OAEnC,IAAIiI,IAAI,EACR;SACCA,IAAI,CAACmkB,qBAAqB,CAACV,aAAa,EAAEC,UAAU,CAAC;;;;KAEtD;KAAA,8BAEaN,SAAS,EACvB;OACC,IAAMpjB,IAAI,GAAG,IAAI,CAACrG,SAAS,CAACypB,SAAS,CAACrrB,MAAM,CAAC;OAE7C,IAAIiI,IAAI,EACR;SACCA,IAAI,CAACyU,gBAAgB,EAAE;;;;KAExB;KAAA,8BAEa2O,SAAS,EACvB;OACC,IAAMpjB,IAAI,GAAG,IAAI,CAACrG,SAAS,CAACypB,SAAS,CAACrrB,MAAM,CAAC;OAE7C,IAAIiI,IAAI,EACR;SACC,IAAI,CAAC,IAAI,CAACqjB,aAAa,EAAE,IAAIrjB,IAAI,CAACvF,MAAM,CAACuI,KAAK,EAAE,EAChD;WACChD,IAAI,CAACokB,oBAAoB,EAAE;;SAE5BpkB,IAAI,CAAC8F,YAAY,CAAC,KAAK,CAAC;SACxB9F,IAAI,CAAClI,SAAS,EAAE,CAAC8F,aAAa,EAAE;SAChCoC,IAAI,CAAC+F,sBAAsB,EAAE;;;;KAE9B;KAAA,6BAEYqd,SAAS,EACtB;OACC,IAAMpjB,IAAI,GAAG,IAAI,CAACrG,SAAS,CAACypB,SAAS,CAACrrB,MAAM,CAAC;OAE7C,IAAIiI,IAAI,IAAIA,IAAI,CAAC8iB,aAAa,EAAE,EAChC;SACC9iB,IAAI,CAAC4U,KAAK,EAAE;SAEZ,IAAI,CAAC,IAAI,CAACyO,aAAa,EAAE,EACzB;WACC,IAAIrjB,IAAI,CAAC3G,cAAc,EAAE,EACzB;aACC2G,IAAI,CAACqkB,uBAAuB,CAACrkB,IAAI,CAAC3G,cAAc,EAAE,CAAC;YACnD,MAED;aACC,IAAMoB,MAAM,GAAG;eACdkgB,SAAS,EAAE3a,IAAI,CAAClI,SAAS,EAAE,CAAC2C,MAAM,CAACuI,KAAK,EAAE;eAC1C6X,UAAU,EAAE7a,IAAI,CAACvF,MAAM,CAACqK,YAAY;cACpC;aACD,IAAM0c,cAAc,GAAG,SAAjBA,cAAc,GAAS;eAC5BxhB,IAAI,CAAC2U,MAAM,EAAE;cACb;aAED3U,IAAI,CAACsjB,oBAAoB,CAAC7oB,MAAM,EAAE+mB,cAAc,CAAC;;;;;;KAIpD;KAAA,8BAEa4B,SAAS,EACvB;OACC,IAAMpjB,IAAI,GAAG,IAAI,CAACrG,SAAS,CAACypB,SAAS,CAACrrB,MAAM,CAAC;OAE7C,IAAIiI,IAAI,IAAIA,IAAI,CAAC+iB,cAAc,EAAE,EACjC;SACC,IAAI,CAAC,IAAI,CAACM,aAAa,EAAE,EACzB;WACCrjB,IAAI,CAACqkB,uBAAuB,CAACrkB,IAAI,CAAClI,SAAS,EAAE,CAAC;;SAE/CkI,IAAI,CAAC2U,MAAM,EAAE;;;;KAEd;KAAA,iCAEgByO,SAAS,EAC1B;OACC,IAAMpjB,IAAI,GAAG,IAAI,CAACrG,SAAS,CAACypB,SAAS,CAACrrB,MAAM,CAAC;OAE7C,IAAIiI,IAAI,EACR;SACCA,IAAI,CAAC+V,eAAe,EAAE;SACtB,IAAI,CAAC,IAAI,CAACsN,aAAa,EAAE,EACzB;WACC,IAAM7B,cAAc,GAAG,SAAjBA,cAAc,GAAS;aAC5BxhB,IAAI,CAAC+V,eAAe,EAAE;YACtB;WACD/V,IAAI,CAACsjB,oBAAoB,CAAC;aAAEvI,YAAY,EAAE/a,IAAI,CAACvF,MAAM,CAACsU,cAAc;YAAI,EAAEyS,cAAc,CAAC;;;;;KAG3F;KAAA,0CAEyB4B,SAAS,EACnC;OACC,IAAQrrB,MAAM,GAAkBqrB,SAAS,CAAjCrrB,MAAM;SAAEusB,WAAW,GAAKlB,SAAS,CAAzBkB,WAAW;OAC3B,IAAMtkB,IAAI,GAAG,IAAI,CAACrG,SAAS,CAAC5B,MAAM,CAAC;OAEnC,IAAI,CAACiI,IAAI,EACT;SACC;;OAGD,IAAIskB,WAAW,KAAK,cAAc,EAClC;SACCtkB,IAAI,CAACqH,kBAAkB,CAAC,IAAI,CAAC/N,mBAAmB,EAAE,GAAG,CAAC,CAAC;QACvD,MAED;SACC0G,IAAI,CAACyI,WAAW,CAAC,IAAI,CAAC9O,SAAS,CAAC2qB,WAAW,CAAC,CAAC;SAC7CtkB,IAAI,CAAC+F,sBAAsB,EAAE;SAE7B,IAAI,CAAC,IAAI,CAACsd,aAAa,EAAE,EACzB;WACC,IAAIrjB,IAAI,CAAC3G,cAAc,EAAE,EACzB;aACC2G,IAAI,CAACqkB,uBAAuB,CAACrkB,IAAI,CAAC3G,cAAc,EAAE,CAAC;YACnD,MAED;aACC2G,IAAI,CAACsjB,oBAAoB,CAAC;eACzB3I,SAAS,EAAE3a,IAAI,CAAClI,SAAS,EAAE,CAAC2C,MAAM,CAACuI,KAAK,EAAE;eAC1C6X,UAAU,EAAE7a,IAAI,CAACvF,MAAM,CAACqK,YAAY;cACpC,CAAC;;;;;;KAIL;KAAA,yCAGD;OACC,OAAQ,IAAI,CAACue,aAAa,EAAE,GAAG,YAAY,GAAG,YAAY;;;KAC1D;KAAA,gCAGD;OACC,OAAO,IAAI,CAACxgB,aAAa,CAAC0hB,UAAU,EAAE;;;KACtC;KAAA,gCAGD;OACC,OAAO,CAAC,IAAI,CAACxhB,UAAU,EAAE,IAAI,CAAC,IAAI,CAACe,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC/K,iBAAiB,EAAE;;;KAC7E;KAAA,iCAGD;OACC,OAAO,CAAC,IAAI,CAACgK,UAAU,EAAE,IAAI,CAAC,IAAI,CAACe,WAAW,EAAE,IAAI,CAAC,IAAI,CAAChM,SAAS,EAAE,CAACgM,WAAW,EAAE;;;KACnF;KAAA,gCAEe5L,IAAI,EACpB;MAEC;;KADA;KAAA,oCAID;OACC,OAAO,IAAI,CAAC4L,WAAW,EAAE,GAAG,uCAAuC,GAAG,iCAAiC;;;KACvG;KAAA,oCAGD;OACC,OAAO,IAAI,CAACc,SAAS,CAACuJ,aAAa,CAAC,IAAI,CAACrK,WAAW,EAAE,GAAG,mCAAmC,GAAG,6BAA6B,CAAC;;;KAC7H;KAAA,mCAEkBmF,MAAM,EACzB;OAAA;OACC,IAAMrO,KAAK,GAAG,UAAGqD,aAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC,EAAG9D,OAAO,CAAC,eAAe,EAAE6O,MAAM,CAAC;OACzG,IAAMC,YAAY,GAAG,IAAI2X,mBAAmB,CAAC;SAAE1X,KAAK,EAAEvO;QAAO,CAAC;OAE9D,IAAI,CAACzB,WAAW,EAAE,CAAC4L,gBAAgB,CAACmE,YAAY,CAAC,CAACnC,IAAI,CAAC,YAAM;SAC5D,OAAI,CAAC0B,WAAW,CAACS,YAAY,CAAC;SAC9B,OAAI,CAACnD,sBAAsB,EAAE;SAE7B,IAAI,CAAC,OAAI,CAACsd,aAAa,EAAE,EACzB;WACCna,YAAY,CAACsb,iBAAiB,EAAE,CAACzd,IAAI,CAAC,YAAM;aAC3C,OAAI,CAACuc,oBAAoB,CAAC;eACzB3I,SAAS,EAAE,OAAI,CAAC7iB,SAAS,EAAE,CAAC2C,MAAM,CAACuI,KAAK,EAAE;eAC1C6X,UAAU,EAAE,OAAI,CAACpgB,MAAM,CAACqK,YAAY;cACpC,CAAC;YACF,EAAE,YAAM,EACR,CAAC;;QAEH,CAAC;;;KACF;KAAA,kCAGD;OACC,IAAI,IAAI,CAACrK,MAAM,CAACsU,cAAc,EAAE,EAChC;SACC,IAAI,CAACtU,MAAM,CAACib,cAAc,CAAC,KAAK,CAAC;SACjCrY,aAAG,CAACwW,WAAW,CAAC,IAAI,CAACX,iBAAiB,EAAE,EAAE,sCAAsC,CAAC;QACjF,MAED;SACC,IAAI,CAACzY,MAAM,CAACib,cAAc,CAAC,IAAI,CAAC;SAChCrY,aAAG,CAACE,QAAQ,CAAC,IAAI,CAAC2V,iBAAiB,EAAE,EAAE,sCAAsC,CAAC;;;;KAE/E;KAAA,qCAGD;OAAA,IADmBc,aAAa,uEAAG,KAAK;OAEvC,IAAM1V,KAAK,GAAG,IAAI,CAACsG,SAAS,CAACuJ,aAAa,iBAAU,IAAI,CAAC3U,SAAS,EAAE,EAAG;OACvE,IAAM4O,IAAI,GAAG9J,KAAK,CAACc,KAAK,CAACuU,IAAI,EAAE;OAE/B,IAAIvL,IAAI,CAACxP,MAAM,KAAK,CAAC,EACrB;SACC,IAAI,IAAI,CAACqb,4BAA4B,EAAE,EACvC;WACC,IAAI,CAAC,IAAI,CAACoP,aAAa,EAAE,IAAI,IAAI,CAAC5oB,MAAM,CAACuI,KAAK,EAAE,EAChD;aACC,IAAI,CAACohB,oBAAoB,EAAE;;WAE5B,IAAI,CAACte,YAAY,CAAC,KAAK,CAAC;WACxB,IAAI,CAAChO,SAAS,EAAE,CAAC8F,aAAa,EAAE;WAChC,IAAI,CAACsW,sBAAsB,EAAE;UAC7B,MAED;WACC2M,mBAAmB,CAAC1M,kBAAkB,CAAC7V,KAAK,CAACa,aAAa,CAAC;;QAE5D,MACI,IAAI6U,aAAa,EACtB;SACC,IAAI,CAAClc,SAAS,EAAE,CAACiN,gBAAgB,CAAC,IAAI,EAAE,IAAI,CAAC;QAC7C,MAED;SACC,IAAI,CAACqP,iBAAiB,EAAE;SACxB,IAAI,CAAC5N,iBAAiB,EAAE;SAExB,IAAI,CAAC,IAAI,CAAC6c,aAAa,EAAE,EACzB;WACC,IAAI,IAAI,CAAC5oB,MAAM,CAACuI,KAAK,EAAE,EACvB;aACC,IAAMqX,eAAe,GAAG,IAAI,CAACe,kBAAkB,EAAE;aACjD,IAAM/f,OAAO,GAAGgf,eAAe,CAACW,OAAO;aAEvC,IAAI,CAACsI,oBAAoB,CAAC;eACzBna,KAAK,EAAEkR,eAAe,CAAClR,KAAK;eAC5B6R,OAAO,EAAGvf,MAAM,CAACC,IAAI,CAACL,OAAO,CAAC,CAACzC,MAAM,GAAG,CAAC,GAAGyC,OAAO,GAAG;cACtD,CAAC;YACF,MAED;aACC,IAAI,CAACmpB,iBAAiB,EAAE,CAACzd,IAAI,CAAC,YAAM,EACnC,EAAE,YAAM,EACR,CAAC;;;;;;KAIL;KAAA,mCAEkBzB,CAAC,EACpB;OACC,IAAMmf,sBAAsB,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC;OACzC,IAAMtsB,QAAQ,GAAG+E,aAAa,CAACsU,iBAAiB,CAAC,IAAI,CAAClT,KAAK,CAAC,CAACC,KAAK;OAElE,IAAIkmB,sBAAsB,CAACzP,QAAQ,CAAC1P,CAAC,CAACJ,IAAI,CAAC,IAAI,IAAI,CAACuG,qBAAqB,EAAE,EAC3E;SACC,IAAMiZ,MAAM,GAAG;WACdvsB,QAAQ,EAARA,QAAQ;WACRJ,MAAM,EAAE,IAAI,CAACyB,SAAS;UACtB;SACDunB,WAAW,CAACC,MAAM,CAACC,eAAe,CACjC,oCAAoC,EACpCyD,MAAM,EACN,IAAI,CAACC,sBAAsB,EAAE,CAC7B;SACDrf,CAAC,CAACC,cAAc,EAAE;;;;KAEnB;KAAA,kCAEiBD,CAAC,EACnB;OACC,IAAIA,CAAC,CAAC+O,OAAO,KAAKnX,aAAa,CAACoX,QAAQ,CAAC/S,KAAK,EAC9C;SACC,IAAI,CAACkT,gBAAgB,CAACnP,CAAC,CAAC;SACxBA,CAAC,CAACC,cAAc,EAAE;;;;KAEnB;KAAA,wCAEuBxI,IAAI,EAC5B;OACC,IAAI,CAAC,CAAC,UAAU,EAAE,aAAa,CAAC,CAACiY,QAAQ,CAACjY,IAAI,CAAC,EAC/C;SACC,OAAO,EAAE;;OAGV,2BAA8D,IAAI,CAAC8F,aAAa;SAAxE2T,QAAQ,wBAARA,QAAQ;SAAE1L,UAAU,wBAAVA,UAAU;SAAEqW,QAAQ,wBAARA,QAAQ;SAAEyD,WAAW,wBAAXA,WAAW;SAAEC,IAAI,wBAAJA,IAAI;OACzD,IAAMC,aAAa,GAAG;SACrB3D,QAAQ,EAARA,QAAQ;SACRD,MAAM,EAAE1K,QAAQ;SAChBze,MAAM,EAAE,IAAI,CAACyB,SAAS,EAAE;SACxBurB,IAAI,EAAEH,WAAW;SACjBI,QAAQ,EAAE;WACTxO,QAAQ,EAARA,QAAQ;WACRqO,IAAI,EAAJA,IAAI;WACJvN,eAAe,EAAG,IAAI,CAAC+L,aAAa,EAAE,GAAG,IAAI,CAAC7pB,SAAS,EAAE,GAAG,IAAI,CAACiB,MAAM,CAACuI,KAAK,EAAG;WAChFiiB,YAAY,YAAKna,UAAU,CAAC3Q,WAAW,EAAE;;QAE1C;OACD,IAAI+qB,WAAW,GAAG,EAAE;OAEpB,IAAInoB,IAAI,KAAK,UAAU,EACvB;SACCmoB,WAAW,GAAG;WACbC,eAAe,EAAE,IAAI,CAACC,sBAAsB,EAAE;WAC9Cld,cAAc,EAAE,IAAI,CAACmd,iBAAiB,EAAE;WACxCC,iBAAiB,EAAE,CAAC;aAAE5qB,EAAE,EAAE,GAAG;aAAEE,KAAK,EAAEwB,cAAI,CAACoN,MAAM,CAAC,IAAI,CAAC/O,MAAM,CAACwK,QAAQ,EAAE;YAAG;UAC3E;QACD,MACI,IAAIlI,IAAI,KAAK,aAAa,EAC/B;SACCmoB,WAAW,GAAG;WACbvB,cAAc,EAAEloB,MAAM,CAACC,IAAI,CAAC,IAAI,CAACjB,MAAM,CAACsZ,cAAc,EAAE,CAAC;WACzD/R,SAAS,EAAE,IAAI,CAACsT,cAAc;UAC9B;;OAGF,uCAAYwP,aAAa,GAAKI,WAAW;;;KACzC;KAAA,2CAGD;OACC,IAAMR,MAAM,GAAG,IAAI,CAACa,uBAAuB,CAAC,aAAa,CAAC;OAC1DxE,WAAW,CAACC,MAAM,CAACC,eAAe,CAAC,6BAA6B,EAAEyD,MAAM,EAAE,IAAI,CAACC,sBAAsB,EAAE,CAAC;;;KACxG;KAAA,kCAGD;OACC,IAAMD,MAAM,GAAG,IAAI,CAACa,uBAAuB,CAAC,UAAU,CAAC;OACvDxE,WAAW,CAACC,MAAM,CAACC,eAAe,CAAC,0BAA0B,EAAEyD,MAAM,EAAE,IAAI,CAACC,sBAAsB,EAAE,CAAC;;;KACrG;KAAA,sCAGD;OACC,IAAM5sB,MAAM,GAAG,IAAI,CAACyB,SAAS,EAAE;OAE/B,IAAI,IAAI,CAACsK,WAAW,EAAE,EACtB;SACC,OAAO6C,aAAG,CAACC,MAAM,8YAEwD7O,MAAM,EAChE,IAAI,CAAC0C,MAAM,CAACwK,QAAQ,EAAE,EACjB,IAAI,CAACugB,iBAAiB,CAACtpB,IAAI,CAAC,IAAI,CAAC,EACrC,IAAI,CAAC0V,kBAAkB,CAAC1V,IAAI,CAAC,IAAI,CAAC;;OAKnD,IAAM4V,iBAAiB,GAAG,IAAI5R,EAAE,CAACulB,MAAM,CAACC,KAAK,CAACC,SAAS,CAAC5T,aAAa,CAAC;SACrE3S,KAAK,EAAE,IAAI,CAAC3E,MAAM,CAACkJ,iBAAiB,EAAE;SACtCqO,QAAQ,EAAE,IAAI,CAACvX,MAAM,CAACiJ,aAAa,EAAE;SACrCuO,KAAK,EAAE,EAAE;SACTC,QAAQ,EAAE,CAAC;SACXC,IAAI,EAAE,KAAK;SACXC,KAAK,EAAElS,EAAE,CAAC8G,EAAE,CAAC+K,aAAa,CAACM,KAAK,CAACC;QACjC,CAAC;OAEF,OAAO3L,aAAG,CAACC,MAAM,2qBAC8D,IAAI,CAACnM,MAAM,CAAC0I,aAAa,EAAE,GAAG,IAAI,CAAC8T,YAAY,GAAG,EAAE,EAE9HnF,iBAAiB,CAACU,YAAY,EAAE,EAG+B,IAAI,CAAC/X,MAAM,CAAC6V,mBAAmB,EAAE,EAC3BvY,MAAM,EAC1DkG,aAAG,CAACC,UAAU,CAAC,sCAAsC,CAAC,EAC5D,IAAI,CAACzD,MAAM,CAACwK,QAAQ,EAAE,EACjB,IAAI,CAACugB,iBAAiB,CAACtpB,IAAI,CAAC,IAAI,CAAC,EACrC,IAAI,CAAC0V,kBAAkB,CAAC1V,IAAI,CAAC,IAAI,CAAC;;;KAInD;KAAA,uCAGD;OACC,IAAM2nB,gBAAgB,GAAGpoB,MAAM,CAACC,IAAI,CAAC,IAAI,CAACjB,MAAM,CAACsZ,cAAc,EAAE,CAAC,CAACnb,MAAM;OAEzE,OAAO+N,aAAG,CAACC,MAAM,yNACgD,IAAI,CAACpN,SAAS,EAAE,EAAc,IAAI,CAACuqB,wBAAwB,CAAC7nB,IAAI,CAChI,IAAI,CAAC,EACF2nB,gBAAgB,GAAG,CAAC,oEAA2DA,gBAAgB,cAAW,EAAE;;;KAGhH;KAAA,mCAEkB9E,QAAQ,EAC3B;OACC,IAAMhnB,MAAM,GAAG,IAAI,CAACyB,SAAS,EAAE;OAC/B,IAAMosB,cAAc,GAAGjf,aAAG,CAACC,MAAM,wKACsB,IAAI,CAACif,eAAe,CAAC3pB,IAAI,CAAC,IAAI,CAAC,CACrF;OACD,IAAMqjB,eAAe,GAAG5Y,aAAG,CAACC,MAAM,2QACwB,IAAI,CAAC4Y,uBAAuB,CAACtjB,IAAI,CAAC,IAAI,CAAC,EAE5F+B,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC,CAGlD;OAED,IAAI,CAACuE,QAAQ,GAAG,IAAIvC,EAAE,CAACulB,MAAM,CAACC,KAAK,CAACC,SAAS,CAAC5T,aAAa,CAAC;SAC3DE,KAAK,EAAE,EAAE;SACTC,QAAQ,EAAE,CAAC;SACX9S,KAAK,EAAE,IAAI,CAAC3E,MAAM,CAACkJ,iBAAiB,EAAE;SACtCqO,QAAQ,EAAE,IAAI,CAACvX,MAAM,CAACiJ,aAAa,EAAE;SACrCma,UAAU,EAAE3d,EAAE,CAAC8G,EAAE,CAAC+K,aAAa,CAAC+L,MAAM,CAACgI;QACvC,CAAC;OAEF,IAAI,CAAClhB,SAAS,GAAG+B,aAAG,CAACC,MAAM,i9BACuB7O,MAAM,EAGeA,MAAM,EACtE,IAAI,CAAC0K,QAAQ,CAAC+P,YAAY,EAAE,EAGyB,IAAI,CAAC4C,iBAAiB,CAAClZ,IAAI,CAAC,IAAI,CAAC,EACvF,IAAI,CAACoT,cAAc,EAAE,EAGrB,IAAI,CAACgG,cAAc,EAAE,GAAGsQ,cAAc,GAAG,EAAE,EAEhC,IAAI,CAACxF,qBAAqB,CAAClkB,IAAI,CAAC,IAAI,CAAC,EAIDnE,MAAM,EACrDgnB,QAAQ,EAET,IAAI,CAACO,WAAW,EAAE,GAAGC,eAAe,GAAG,EAAE,CAG7C;OAED,OAAO,IAAI,CAAC3a,SAAS;;;KACrB;KAAA,uCAEsBma,QAAQ,EAC/B;OACC,IAAMhnB,MAAM,GAAG,IAAI,CAACyB,SAAS,EAAE;OAC/B,IAAMosB,cAAc,GAAGjf,aAAG,CAACC,MAAM,6KAC2B,IAAI,CAACif,eAAe,CAAC3pB,IAAI,CAAC,IAAI,CAAC,CAC1F;OAED,IAAI,CAACuG,QAAQ,GAAG,IAAIvC,EAAE,CAACulB,MAAM,CAACC,KAAK,CAACC,SAAS,CAAC5T,aAAa,CAAC;SAC3DrX,EAAE,qBAAc3C,MAAM,CAAE;SACxBqH,KAAK,EAAE,IAAI,CAAC3E,MAAM,CAACkJ,iBAAiB,EAAE;SACtCqO,QAAQ,EAAE,IAAI,CAACvX,MAAM,CAACiJ,aAAa,EAAE;SACrCuO,KAAK,EAAE,EAAE;SACTC,QAAQ,EAAE,CAAC;SACXC,IAAI,EAAE,KAAK;SACXC,KAAK,EAAElS,EAAE,CAAC8G,EAAE,CAAC+K,aAAa,CAACM,KAAK,CAACC;QACjC,CAAC;OAEF,IAAI,CAAC1N,SAAS,GAAG+B,aAAG,CAACC,MAAM,m0BAC4B7O,MAAM,EAClB,IAAI,CAAC0C,MAAM,CAAC0I,aAAa,EAAE,GAAG,IAAI,CAAC8T,YAAY,GAAG,EAAE,EAAI,IAAI,CAACxc,MAAM,CAACsU,cAAc,EAAE,GAAG,sCAAsC,GAAG,EAAE,EAC9J,IAAI,CAACyG,yBAAyB,CAACtZ,IAAI,CAAC,IAAI,CAAC,EACUnE,MAAM,EACxD,IAAI,CAACwa,qBAAqB,CAACrW,IAAI,CAAC,IAAI,CAAC,EAC/C,IAAI,CAACuG,QAAQ,CAAC+P,YAAY,EAAE,EAGmC,IAAI,CAAC/X,MAAM,CAAC6V,mBAAmB,EAAE,EAChG,IAAI,CAAChB,cAAc,EAAE,EAEtB,IAAI,CAAC+Q,oBAAoB,EAAE,EAE1B,IAAI,CAAC/K,cAAc,EAAE,GAAGsQ,cAAc,GAAG,EAAE,EAGG7tB,MAAM,EACrDgnB,QAAQ,CAGZ;OAED,OAAO,IAAI,CAACna,SAAS;;;KACrB;KAAA,mCAn4ByBzH,OAAO,EACjC;OACC,IAAMC,WAAW,GAAG,6BAA6B;OAEjD,IAAI,CAACC,aAAG,CAACC,QAAQ,CAACH,OAAO,EAAEC,WAAW,CAAC,EACvC;SACCC,aAAG,CAACE,QAAQ,CAACJ,OAAO,EAAEC,WAAW,CAAC;;;;GAEnC;CAAA,EApCgCF,aAAa;;;;;;;;;"}