{"version":3,"file":"check-list-item.bundle.js","sources":["../src/tree-item.js","../src/composite-tree-item.js","../src/check-list-item-fields.js","../src/check-list-item.js"],"sourcesContent":["class TreeItem\n{\n\tstatic generateUniqueNodeId()\n\t{\n\t\treturn Math.random().toString(36).substr(2, 9);\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.setNodeId(TreeItem.generateUniqueNodeId());\n\t\tthis.setParent(null);\n\t}\n\n\tgetRootNode()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (parent.getParent() !== null)\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tgetNodeId()\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tsetNodeId(nodeId)\n\t{\n\t\tthis.nodeId = nodeId;\n\t}\n\n\tgetParent()\n\t{\n\t\treturn this.parent;\n\t}\n\n\tsetParent(parent)\n\t{\n\t\tthis.parent = parent;\n\t}\n}\n\nexport {TreeItem};","import {TreeItem} from './tree-item';\n\nclass CompositeTreeItem extends TreeItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.descendants = [];\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\titem.setParent(this);\n\n\t\tif (position === null)\n\t\t{\n\t\t\tthis.descendants.push(item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.descendants.splice(position, 0, item);\n\t\t}\n\t}\n\n\taddAfter(item, after)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === after);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index + 1);\n\t\t}\n\t}\n\n\taddBefore(item, before)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === before);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index);\n\t\t}\n\t}\n\n\tremove(item)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === item);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.descendants.splice(index, 1);\n\t\t}\n\t}\n\n\tgetDescendants()\n\t{\n\t\treturn this.descendants;\n\t}\n\n\tgetDescendantsCount()\n\t{\n\t\treturn this.descendants.length;\n\t}\n\n\tgetFirstDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[0];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetLastDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[this.descendants.length - 1];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tfindChild(nodeId)\n\t{\n\t\tif (this.getNodeId().toString() === nodeId.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findChild(nodeId);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountTreeSize()\n\t{\n\t\tlet size = this.getDescendantsCount();\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tsize += descendant.countTreeSize();\n\t\t});\n\n\t\treturn size;\n\t}\n\n\tgetTreeSize()\n\t{\n\t\treturn this.getRootNode().countTreeSize() + 1;\n\t}\n}\n\nexport {CompositeTreeItem};","import {Text, Type} from 'main.core';\n\nclass CheckListItemFields\n{\n\tstatic snakeToCamelCase(string)\n\t{\n\t\tlet camelCaseString = string;\n\n\t\tif (Type.isString(camelCaseString))\n\t\t{\n\t\t\tcamelCaseString = camelCaseString.toLowerCase();\n\t\t\tcamelCaseString = camelCaseString.replace(/[-_\\s]+(.)?/g, (match, chr) => (chr ? chr.toUpperCase() : ''));\n\n\t\t\treturn camelCaseString.substr(0, 1).toLowerCase() + camelCaseString.substr(1);\n\t\t}\n\n\t\treturn camelCaseString;\n\t}\n\n\tstatic camelToSnakeCase(string)\n\t{\n\t\tlet snakeCaseString = string;\n\n\t\tif (Type.isString(snakeCaseString))\n\t\t{\n\t\t\tsnakeCaseString = snakeCaseString.replace(/(.)([A-Z])/g, '$1_$2').toUpperCase();\n\t\t}\n\n\t\treturn snakeCaseString;\n\t}\n\n\tconstructor(fields)\n\t{\n\t\tthis.fields = [\n\t\t\t'id',\n\t\t\t'copiedId',\n\t\t\t'parentId',\n\t\t\t'title',\n\t\t\t'sortIndex',\n\t\t\t'displayTitle',\n\t\t\t'displaySortIndex',\n\t\t\t'isComplete',\n\t\t\t'isImportant',\n\t\t\t'isSelected',\n\t\t\t'isCollapse',\n\t\t\t'completedCount',\n\t\t\t'totalCount',\n\t\t\t'members',\n\t\t\t'attachments',\n\t\t];\n\n\t\tthis.id = null;\n\t\tthis.parentId = null;\n\t\tthis.title = '';\n\t\tthis.sortIndex = 0;\n\t\tthis.displayTitle = '';\n\t\tthis.displaySortIndex = '';\n\t\tthis.isComplete = false;\n\t\tthis.isImportant = false;\n\t\tthis.isSelected = false;\n\t\tthis.isCollapse = false;\n\t\tthis.completedCount = 0;\n\t\tthis.totalCount = 0;\n\t\tthis.members = new Map();\n\t\tthis.attachments = {};\n\n\t\tthis.setFields(fields);\n\t}\n\n\tsetFields(fields)\n\t{\n\t\tObject.keys(fields).forEach((name) => {\n\t\t\tconst camelCaseName = CheckListItemFields.snakeToCamelCase(name);\n\n\t\t\tif (this.fields.indexOf(name) !== -1)\n\t\t\t{\n\t\t\t\tconst snakeCaseName = CheckListItemFields.camelToSnakeCase(name);\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${snakeCaseName}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t\telse if (this.fields.indexOf(camelCaseName) !== -1)\n\t\t\t{\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${name}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\tgetCopiedId()\n\t{\n\t\treturn this.copiedId;\n\t}\n\n\tsetCopiedId(copiedId)\n\t{\n\t\tthis.copiedId = copiedId;\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetParentId(parentId)\n\t{\n\t\tthis.parentId = parentId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title)\n\t{\n\t\tthis.title = title;\n\t}\n\n\tgetSortIndex()\n\t{\n\t\treturn this.sortIndex;\n\t}\n\n\tsetSortIndex(sortIndex)\n\t{\n\t\tthis.sortIndex = sortIndex;\n\t}\n\n\tgetDisplayTitle()\n\t{\n\t\treturn this.displayTitle;\n\t}\n\n\tsetDisplayTitle(displayTitle)\n\t{\n\t\tthis.displayTitle = displayTitle;\n\t}\n\n\tgetDisplaySortIndex()\n\t{\n\t\treturn this.displaySortIndex;\n\t}\n\n\tsetDisplaySortIndex(displaySortIndex)\n\t{\n\t\tthis.displaySortIndex = displaySortIndex;\n\t}\n\n\tgetIsComplete()\n\t{\n\t\treturn this.isComplete;\n\t}\n\n\tsetIsComplete(isComplete)\n\t{\n\t\tthis.isComplete = isComplete;\n\t}\n\n\tgetIsImportant()\n\t{\n\t\treturn this.isImportant;\n\t}\n\n\tsetIsImportant(isImportant)\n\t{\n\t\tthis.isImportant = isImportant;\n\t}\n\n\tgetIsSelected()\n\t{\n\t\treturn this.isSelected;\n\t}\n\n\tsetIsSelected(isSelected)\n\t{\n\t\tthis.isSelected = isSelected;\n\t}\n\n\tgetIsCollapse()\n\t{\n\t\treturn this.isCollapse;\n\t}\n\n\tsetIsCollapse(isCollapse)\n\t{\n\t\tthis.isCollapse = isCollapse;\n\t}\n\n\tgetCompletedCount()\n\t{\n\t\treturn this.completedCount;\n\t}\n\n\tsetCompletedCount(completedCount)\n\t{\n\t\tthis.completedCount = completedCount;\n\t}\n\n\tgetTotalCount()\n\t{\n\t\treturn this.totalCount;\n\t}\n\n\tsetTotalCount(totalCount)\n\t{\n\t\tthis.totalCount = totalCount;\n\t}\n\n\tgetMembers()\n\t{\n\t\treturn this.members;\n\t}\n\n\tsetMembers(members)\n\t{\n\t\tconst types = {\n\t\t\tA: 'accomplice',\n\t\t\tU: 'auditor',\n\t\t};\n\n\t\tthis.members.clear();\n\n\t\tObject.keys(members).forEach((id) => {\n\t\t\tconst {NAME, TYPE} = members[id];\n\t\t\tthis.members.set(id, {id, nameFormatted: Text.encode(NAME), type: types[TYPE]});\n\t\t});\n\t}\n\n\taddMember(member)\n\t{\n\t\tthis.members.set(member.id, member);\n\t}\n\n\tremoveMember(id)\n\t{\n\t\tthis.members.delete(id);\n\t}\n\n\tgetAttachments()\n\t{\n\t\treturn this.attachments;\n\t}\n\n\tsetAttachments(attachments)\n\t{\n\t\tthis.attachments = attachments;\n\t}\n\n\taddAttachments(attachments)\n\t{\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\tthis.attachments[id] = attachments[id];\n\t\t});\n\t}\n\n\tremoveAttachment(id)\n\t{\n\t\tdelete this.attachments[id];\n\t}\n}\n\nexport {CheckListItemFields};","import './css/check-list-item.css';\n\nimport {Dom, Event, Loc, Tag, Text} from 'main.core';\n\nimport {CompositeTreeItem} from './composite-tree-item';\nimport {CheckListItemFields} from './check-list-item-fields';\n\nclass CheckListItem extends CompositeTreeItem\n{\n\tstatic makeDangerElement(element)\n\t{\n\t\tconst dangerClass = 'ui-ctl-danger';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tstatic updateParents(oldParent, newParent)\n\t{\n\t\tif (oldParent !== newParent)\n\t\t{\n\t\t\toldParent.updateCounts();\n\t\t\tnewParent.updateCounts();\n\n\t\t\toldParent.updateProgress();\n\t\t\tnewParent.updateProgress();\n\n\t\t\toldParent.updateIndexes();\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t}\n\n\tstatic getProgressText(completed, total)\n\t{\n\t\tconst replaces = {\n\t\t\t'#total#': total,\n\t\t\t'#completed#': completed,\n\t\t};\n\t\tlet progressText = Loc.getMessage('TASKS_CHECKLIST_PROGRESS_BAR_PROGRESS_TEXT');\n\n\t\tObject.keys(replaces).forEach((search) => {\n\t\t\tprogressText = progressText.replace(search, replaces[search]);\n\t\t});\n\n\t\treturn progressText;\n\t}\n\n\tstatic getFileExtension(ext)\n\t{\n\t\tlet fileExtension = ext;\n\n\t\tswitch (ext)\n\t\t{\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'swf':\n\t\t\tcase 'wmv':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'txt':\n\t\t\t\tfileExtension = 'txt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'doc':\n\t\t\tcase 'docx':\n\t\t\t\tfileExtension = 'doc';\n\t\t\t\tbreak;\n\n\t\t\tcase 'xls':\n\t\t\tcase 'xlsx':\n\t\t\t\tfileExtension = 'xls';\n\t\t\t\tbreak;\n\n\t\t\tcase 'php':\n\t\t\t\tfileExtension = 'php';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pdf':\n\t\t\t\tfileExtension = 'pdf';\n\t\t\t\tbreak;\n\n\t\t\tcase 'ppt':\n\t\t\tcase 'pptx':\n\t\t\t\tfileExtension = 'ppt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rar':\n\t\t\t\tfileExtension = 'rar';\n\t\t\t\tbreak;\n\n\t\t\tcase 'zip':\n\t\t\t\tfileExtension = 'zip';\n\t\t\t\tbreak;\n\n\t\t\tcase 'set':\n\t\t\t\tfileExtension = 'set';\n\t\t\t\tbreak;\n\n\t\t\tcase 'mov':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'img':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\t\tfileExtension = 'img';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tfileExtension = 'empty';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn fileExtension;\n\t}\n\n\tstatic getInputSelection(input)\n\t{\n\t\tlet start = 0;\n\t\tlet end = 0;\n\t\tlet normalizedValue;\n\t\tlet range;\n\t\tlet textInputRange;\n\t\tlet len;\n\t\tlet endRange;\n\n\t\tif (typeof input.selectionStart === 'number' && typeof input.selectionEnd === 'number')\n\t\t{\n\t\t\tstart = input.selectionStart;\n\t\t\tend = input.selectionEnd;\n\t\t}\n\t\telse\n\t\t{\n\t\t\trange = document.selection.createRange();\n\n\t\t\tif (range && range.parentElement() === input)\n\t\t\t{\n\t\t\t\tlen = input.value.length;\n\t\t\t\tnormalizedValue = input.value.replace(/\\r\\n/g, '\\n');\n\n\t\t\t\t// Create a working TextRange that lives only in the input\n\t\t\t\ttextInputRange = input.createTextRange();\n\t\t\t\ttextInputRange.moveToBookmark(range.getBookmark());\n\n\t\t\t\t// Check if the start and end of the selection are at the very end\n\t\t\t\t// of the input, since moveStart/moveEnd doesn't return what we want\n\t\t\t\t// in those cases\n\t\t\t\tendRange = input.createTextRange();\n\t\t\t\tendRange.collapse(false);\n\n\t\t\t\tif (textInputRange.compareEndPoints('StartToEnd', endRange) > -1)\n\t\t\t\t{\n\t\t\t\t\tstart = len;\n\t\t\t\t\tend = len;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstart = -textInputRange.moveStart('character', -len);\n\t\t\t\t\tstart += normalizedValue.slice(0, start).split('\\n').length - 1;\n\n\t\t\t\t\tif (textInputRange.compareEndPoints('EndToEnd', endRange) > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tend = len;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tend = -textInputRange.moveEnd('character', -len);\n\t\t\t\t\t\tend += normalizedValue.slice(0, end).split('\\n').length - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {start, end};\n\t}\n\n\tstatic setDefaultStyles(layout, action = 'add')\n\t{\n\t\tif (action === 'add')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = 0;\n\t\t\tlayout.style.opacity = 0;\n\n\t\t\tDom.addClass(layout, 'checklist-item-show');\n\t\t}\n\t\telse if (action === 'delete')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = `${layout.scrollHeight}px`;\n\t\t\tlayout.style.opacity = 1;\n\n\t\t\tDom.addClass(layout, 'checklist-item-hide');\n\t\t}\n\t}\n\n\tstatic getDefaultDisplayTitle(title)\n\t{\n\t\tlet defaultDisplayTitle = title;\n\n\t\tif (title.indexOf('BX_CHECKLIST') === 0)\n\t\t{\n\t\t\tif (title.length === 12)\n\t\t\t{\n\t\t\t\tdefaultDisplayTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE');\n\t\t\t}\n\t\t\telse if (title.match(/BX_CHECKLIST_\\d+$/))\n\t\t\t{\n\t\t\t\tdefaultDisplayTitle = title.replace('BX_CHECKLIST_', `${Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE')} `);\n\t\t\t}\n\t\t}\n\n\t\treturn defaultDisplayTitle;\n\t}\n\n\tconstructor(fields = {})\n\t{\n\t\tconst {action} = fields;\n\n\t\tsuper();\n\t\tthis.fields = new CheckListItemFields(fields);\n\t\tthis.action = {\n\t\t\tcanUpdate: (action && 'MODIFY' in action) ? action.MODIFY : true,\n\t\t\tcanRemove: (action && 'REMOVE' in action) ? action.REMOVE : true,\n\t\t\tcanToggle: (action && 'TOGGLE' in action) ? action.TOGGLE : true,\n\t\t\tcanDrag: (action && 'DRAG' in action) ? action.DRAG : true,\n\t\t};\n\n\t\tthis.input = null;\n\t\tthis.panel = null;\n\t\tthis.progress = null;\n\t\tthis.filesLoaderPopup = null;\n\t\tthis.filesLoaderProgressBars = new Map();\n\t\tthis.updateMode = false;\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\tsuper.add(item, position);\n\t\titem.optionManager = this.optionManager;\n\t}\n\n\tisTaskRoot()\n\t{\n\t\treturn this.getNodeId() === 0 && this.getParent() === null;\n\t}\n\n\tisCheckList()\n\t{\n\t\treturn !this.isTaskRoot() && this.getParent().isTaskRoot();\n\t}\n\n\tgetCheckList()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (!parent.getParent().isTaskRoot())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tcountCompletedCount(recursively = false)\n\t{\n\t\tlet completedCount = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsComplete())\n\t\t\t{\n\t\t\t\tcompletedCount += 1;\n\t\t\t}\n\n\t\t\tif (recursively)\n\t\t\t{\n\t\t\t\tcompletedCount += descendant.countCompletedCount(recursively);\n\t\t\t}\n\t\t});\n\n\t\treturn completedCount;\n\t}\n\n\tcountTotalCount(recursively = false)\n\t{\n\t\tlet totalCount = 0;\n\n\t\tif (!recursively)\n\t\t{\n\t\t\ttotalCount = this.getDescendantsCount();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\ttotalCount += 1;\n\t\t\t\ttotalCount += descendant.countTotalCount(recursively);\n\t\t\t});\n\t\t}\n\n\t\treturn totalCount;\n\t}\n\n\tupdateCompletedCount()\n\t{\n\t\tconst completedCount = this.countCompletedCount();\n\t\tthis.fields.setCompletedCount(completedCount);\n\t}\n\n\tupdateTotalCount()\n\t{\n\t\tconst totalCount = this.countTotalCount();\n\t\tthis.fields.setTotalCount(totalCount);\n\t}\n\n\tupdateCounts()\n\t{\n\t\tthis.updateCompletedCount();\n\t\tthis.updateTotalCount();\n\t}\n\n\tupdateProgress()\n\t{\n\t\tif (this.progress === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst total = this.fields.getTotalCount();\n\t\tconst completed = this.fields.getCompletedCount();\n\n\t\tthis.progress.setMaxValue(total);\n\t\tthis.progress.update(completed);\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tthis.updateProgressText(completed, total);\n\t\t}\n\t}\n\n\tupdateProgressText(completed, total)\n\t{\n\t\tconst progressText = CheckListItem.getProgressText(completed, total);\n\t\tthis.progress.setTextAfter(progressText);\n\t}\n\n\tdelete()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tparent.remove(this);\n\t\tparent.updateCounts();\n\t\tparent.updateProgress();\n\n\t\tCheckListItem.setDefaultStyles(this.container, 'delete');\n\n\t\tsetTimeout(() => {\n\t\t\tthis.container.style.height = 0;\n\t\t\tthis.container.style.opacity = 0;\n\t\t\tthis.container.style.paddingTop = 0;\n\t\t}, 1);\n\n\t\tsetTimeout(() => {\n\t\t\tDom.remove(this.container);\n\t\t}, 250);\n\t}\n\n\trestore()\n\t{\n\t\tconst parent = this.getParent();\n\t\tconst position = this.fields.getSortIndex();\n\n\t\tif (position === 0)\n\t\t{\n\t\t\tif (parent.getDescendantsCount() > 0)\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this, parent.getFirstDescendant(), 'before');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparent.addCheckListItem(this, parent.getDescendants()[position - 1]);\n\t\t}\n\t}\n\n\tdeleteAction(showBalloon = true)\n\t{\n\t\tconst title = this.fields.getTitle();\n\n\t\tthis.delete();\n\n\t\tif (showBalloon && title.length > 0 && title !== '')\n\t\t{\n\t\t\tconst action = 'DELETE';\n\t\t\tconst data = {\n\t\t\t\ttype: this.isCheckList() ? 'CHECKLIST' : 'ITEM',\n\t\t\t};\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\t\t}\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged');\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tonDeleteClick(e)\n\t{\n\t\te.preventDefault();\n\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tconst items = this.getSelectedItems();\n\t\t\tconst action = 'DELETE_SELECTED';\n\t\t\tconst data = {items};\n\n\t\t\tthis.runForEachSelectedItem((item) => {\n\t\t\t\titem.fields.setIsSelected(false);\n\t\t\t\titem.deleteAction(false);\n\t\t\t});\n\n\t\t\titems.forEach((item) => {\n\t\t\t\titem.getParent().updateIndexes();\n\t\t\t\titem.handleCheckListChanges();\n\t\t\t});\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteAction();\n\t\tthis.getParent().updateIndexes();\n\n\t\tthis.handleCheckListChanges();\n\t}\n\n\tgetNotificationBalloon(action, data)\n\t{\n\t\tconst actions = [];\n\t\tlet content = '';\n\n\t\tswitch (action)\n\t\t{\n\t\t\tcase 'DELETE':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_${data.type}`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tthis.restore();\n\t\t\t\t\t\t\tthis.handleCheckListChanges();\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'DELETE_SELECTED':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_ITEMS`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tdata.items.forEach((item) => {\n\t\t\t\t\t\t\t\titem.restore();\n\t\t\t\t\t\t\t\titem.handleCheckListChanges();\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'AUDITOR_ADDED':\n\t\t\tcase 'ACCOMPLICE_ADDED':\n\t\t\t{\n\t\t\t\tcontent = Tag.render`\n\t\t\t\t\t<div class=\"checklist-notification-balloon-message-container\">\n\t\t\t\t\t\t<div class=\"checklist-notification-balloon-avatar\">\n\t\t\t\t\t\t\t<img class=\"checklist-notification-balloon-avatar-img\" src=\"${data.avatar}\" alt=\"\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"checklist-notification-balloon-message\">\n\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}`)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tBX.loadExt('ui.notification').then(() => {\n\t\t\tBX.UI.Notification.Center.notify({content, actions});\n\t\t});\n\t}\n\n\tonToAnotherCheckListClick(e)\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (rootNode.getDescendantsCount() === 1)\n\t\t{\n\t\t\tthis.moveToNewCheckList(2);\n\t\t\treturn;\n\t\t}\n\n\t\tnew BX.PopupMenuWindow(\n\t\t\t'to-another-checklist',\n\t\t\te.target,\n\t\t\tthis.getToAnotherCheckListPopupItems(),\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 3,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose() {\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t).show();\n\t}\n\n\tgetToAnotherCheckListPopupItems()\n\t{\n\t\tconst selectMode = this.checkSelectedItems();\n\t\tconst popupMenuItems = [];\n\t\tconst toNewCheckListMenuItem = {\n\t\t\ttext: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tonclick: (event, item) => {\n\t\t\t\titem.getMenuWindow().close();\n\t\t\t\tthis.moveToNewCheckList(this.getRootNode().getDescendantsCount() + 1);\n\t\t\t},\n\t\t};\n\n\t\tif (selectMode)\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tpopupMenuItems.push({\n\t\t\t\t\ttext: descendant.fields.getDisplayTitle(),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\titem.getMenuWindow().close();\n\n\t\t\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\t\t\tselectedItem.makeChildOf(descendant);\n\t\t\t\t\t\t\tdescendant.unselectAll();\n\n\t\t\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tpopupMenuItems.push({delimiter: true});\n\t\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\t\treturn popupMenuItems;\n\t\t}\n\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupMenuItems.push({\n\t\t\t\ttext: descendant.fields.getDisplayTitle(),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\tthis.makeChildOf(descendant);\n\t\t\t\t\tthis.handleUpdateEnding();\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tpopupMenuItems.push({delimiter: true});\n\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\treturn popupMenuItems;\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new CheckListItem({TITLE: title, DISPLAY_TITLE: title});\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tif (this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\tselectedItem.makeChildOf(newCheckList);\n\t\t\t\t\tnewCheckList.unselectAll();\n\n\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.makeChildOf(newCheckList);\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessMemberSelect(member)\n\t{\n\t\tif (this.memberSelector)\n\t\t{\n\t\t\tthis.memberSelector.close();\n\t\t}\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tconst displayTitle = selectedItem.fields.getDisplayTitle();\n\t\t\t\tconst space = displayTitle.slice(-1) === ' ' ? '' : ' ';\n\t\t\t\tconst newTitle = `${displayTitle}${space}${member.nameFormatted}`.substring(0, 255);\n\n\t\t\t\tselectedItem.fields.addMember(member);\n\n\t\t\t\tselectedItem.updateTitle(newTitle);\n\t\t\t\tselectedItem.updateDisplayTitle(newTitle);\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst start = this.inputCursorPosition.start || 0;\n\t\tconst inputText = this.input.value;\n\t\tconst startSpace = (start === 0 || inputText.charAt(start - 1) === ' ') ? '' : ' ';\n\t\tconst endSpace = inputText.charAt(start) === ' ' ? '' : ' ';\n\n\t\tthis.fields.addMember(member);\n\n\t\tconst newInputText = `${inputText.slice(0, start)}${startSpace}${Text.decode(member.nameFormatted)}${endSpace}`;\n\n\t\tthis.inputCursorPosition.start = newInputText.length;\n\t\tthis.inputCursorPosition.end = newInputText.length;\n\n\t\tthis.input.value = `${newInputText}${inputText.slice(start)}`;\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tonSocNetSelectorAuditorSelected(auditor)\n\t{\n\t\tconst type = 'auditor';\n\t\tconst action = `${type.toUpperCase()}_ADDED`;\n\t\tconst data = {avatar: auditor.avatar};\n\t\tconst resultAuditor = {...auditor, type};\n\n\t\tthis.processMemberSelect(resultAuditor);\n\t\tthis.getNotificationBalloon(action, data);\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:auditorAdded', auditor);\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged');\n\t}\n\n\tonSocNetSelectorAccompliceSelected(accomplice)\n\t{\n\t\tconst type = 'accomplice';\n\t\tconst action = `${type.toUpperCase()}_ADDED`;\n\t\tconst data = {avatar: accomplice.avatar};\n\t\tconst resultAccomplice = {...accomplice, type};\n\n\t\tthis.processMemberSelect(resultAccomplice);\n\t\tthis.getNotificationBalloon(action, data);\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:accompliceAdded', accomplice);\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged');\n\t}\n\n\tonAddAuditorClick(e)\n\t{\n\t\tthis.memberSelector = new BX.Tasks.Integration.Socialnetwork.NetworkSelector({\n\t\t\tscope: e.target,\n\t\t\tmode: 'user',\n\t\t\tuseSearch: true,\n\t\t\tuseAdd: false,\n\t\t\tcontrolBind: e.target,\n\t\t\tparent: this,\n\t\t});\n\n\t\tthis.memberSelector.bindEvent('item-selected', this.onSocNetSelectorAuditorSelected.bind(this));\n\t\tthis.memberSelector.open();\n\t}\n\n\tonAddAccompliceClick(e)\n\t{\n\t\tthis.memberSelector = new BX.Tasks.Integration.Socialnetwork.NetworkSelector({\n\t\t\tscope: e.target,\n\t\t\tmode: 'user',\n\t\t\tuseSearch: true,\n\t\t\tuseAdd: false,\n\t\t\tcontrolBind: e.target,\n\t\t\tparent: this,\n\t\t});\n\n\t\tthis.memberSelector.bindEvent('item-selected', this.onSocNetSelectorAccompliceSelected.bind(this));\n\t\tthis.memberSelector.open();\n\t}\n\n\tonUploadAttachmentClick(e)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst {prefix, diskUrls} = this.optionManager;\n\t\tconst {urlSelect, urlRenameFile, urlDeleteFile, urlUpload} = diskUrls;\n\n\t\tif (this.filesLoaderPopup === null)\n\t\t{\n\t\t\tthis.filesLoaderPopup = new BX.PopupWindow({\n\t\t\t\tcontent: this.getAttachmentsLoaderLayout(),\n\t\t\t\tbindElement: e.target,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 2,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: true,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filesLoaderPopup.setBindElement(e.target);\n\t\t}\n\n\t\tthis.filesLoaderPopup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: nodeId,\n\t\t\tcontrolName: `${prefix}[${nodeId}][UF_CHECKLIST_FILES][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect,\n\t\t\turlRenameFile,\n\t\t\turlDeleteFile,\n\t\t\turlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.filesLoaderPopup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show'],\n\t\t);\n\t}\n\n\tonDeleteAttachmentClick(fileId)\n\t{\n\t\tthis.fields.removeAttachment(fileId);\n\t\tDom.remove(this.getAttachmentsContainer().querySelector(`#disk-attach-${fileId}`));\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged');\n\t}\n\n\tgetPanelBodyLayout()\n\t{\n\t\tconst membersLayout = Tag.render`\n\t\t\t<div class=\"checklist-item-editor-panel-btn checklist-item-editor-panel-btn-auditor\" onclick=\"${this.onAddAuditorClick.bind(this)}\">\n\t\t\t\t${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_AUDITOR'}`}\n\t\t\t</div>\n\t\t\t<div class=\"checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"checklist-item-editor-panel-btn checklist-item-editor-panel-btn-accomplice\" onclick=\"${this.onAddAccompliceClick.bind(this)}\">\n\t\t\t\t${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_ACCOMPLICE'}`}\n\t\t\t</div>\n\t\t\t<div class=\"checklist-item-editor-panel-separator\"></div>\n\t\t`;\n\t\tconst attachmentButtonLayout = Tag.render`\n\t\t\t<div class=\"checklist-item-editor-panel-btn checklist-item-editor-panel-btn-attachment\" onclick=\"${this.onUploadAttachmentClick.bind(this)}\"></div>\n\t\t`;\n\n\t\tconst itemsActionButtonsLayout = Tag.render`\n\t\t\t${this.checkSelectedItems() ? '' : attachmentButtonLayout}\n\t\t\t<div class=\"checklist-item-editor-panel-btn checklist-item-editor-panel-btn-tabin\" onclick=\"${this.onTabInClick.bind(this)}\"></div>\n\t\t\t<div class=\"checklist-item-editor-panel-btn checklist-item-editor-panel-btn-tabout\" onclick=\"${this.onTabOutClick.bind(this)}\"></div>\n\t\t\t<div class=\"checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"checklist-item-editor-panel-btn checklist-item-editor-panel-btn-important\n\t\t\t\t${this.fields.getIsImportant() ? ' checklist-item-editor-panel-btn-important-selected' : ''}\" onclick=\"${this.onImportantClick.bind(this)}\">\n\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_PANEL_IMPORTANT')}\n\t\t\t</div>\n\t\t\t<div class=\"checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"checklist-item-editor-panel-btn checklist-item-editor-panel-btn-checklist\" onclick=\"${this.onToAnotherCheckListClick.bind(this)}\">\n\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST')}\n\t\t\t</div>\n\t\t\t<div class=\"checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"checklist-item-editor-panel-btn checklist-item-editor-panel-btn-remove\" onclick=\"${this.onDeleteClick.bind(this)}\"></div>\n\t\t`;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"checklist-item-editor-panel ${this.isTaskRoot() || this.isCheckList() ? 'checklist-item-editor-group-panel' : ''}\">\n\t\t\t\t${this.checkCanAddAccomplice() ? membersLayout : ''}\n\t\t\t\t${!this.isCheckList() ? itemsActionButtonsLayout : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateTitle(text)\n\t{\n\t\tthis.fields.setTitle(text);\n\t}\n\n\tupdateDisplayTitle(text)\n\t{\n\t\tconst oldTitleNode = this.container.querySelector(this.isCheckList() ? '.checklist-header-name-text' : '.checklist-item-description-text');\n\t\tconst newTitleNode = this.getTitleLayout();\n\n\t\tthis.fields.setDisplayTitle(text);\n\n\t\tDom.replace(oldTitleNode, newTitleNode);\n\t}\n\n\tgetTitleLayout()\n\t{\n\t\tconst {userPath} = this.optionManager;\n\t\tlet title = this.fields.getTitle();\n\n\t\ttitle = this.isCheckList() ? CheckListItem.getDefaultDisplayTitle(title) : title;\n\n\t\tthis.fields.setDisplayTitle(title);\n\t\tthis.fields.getMembers().forEach(({id, nameFormatted, type}) => {\n\t\t\tconst regExp = new RegExp(nameFormatted, 'g');\n\t\t\tconst href = userPath.replace('#user_id#', id);\n\n\t\t\ttitle = title.replace(regExp, `<a href=${href} class=\"checklist-item-${type}\">${nameFormatted}</a>`);\n\t\t});\n\n\t\ttitle = title.replace(/(https?:\\/\\/[^\\s]+)/g, url => `<a class=\"checklist-item-link\" href=\"${url}\" target=\"_blank\">${url}</a>`);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${this.isCheckList() ? 'checklist-header-name-text' : 'checklist-item-description-text'}\">\n\t\t\t\t${title}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tprocessMembersFromText(text)\n\t{\n\t\tconst membersToDelete = [];\n\n\t\tthis.fields.getMembers().forEach(({id, nameFormatted}) => {\n\t\t\tif (text.indexOf(nameFormatted) === -1)\n\t\t\t{\n\t\t\t\tmembersToDelete.push(id);\n\t\t\t}\n\t\t});\n\n\t\tmembersToDelete.forEach((id) => {\n\t\t\tthis.fields.removeMember(id);\n\t\t});\n\t}\n\n\tupdateIndexes()\n\t{\n\t\tthis.updateSortIndexes();\n\t\tthis.updateDisplaySortIndexes();\n\t}\n\n\tupdateSortIndexes()\n\t{\n\t\tlet sortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.fields.setSortIndex(sortIndex);\n\t\t\tsortIndex += 1;\n\t\t});\n\t}\n\n\tupdateDisplaySortIndexes()\n\t{\n\t\tconst parentSortIndex = (this.isCheckList() || this.isTaskRoot() ? '' : `${this.fields.getDisplaySortIndex()}.`);\n\t\tlet localSortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tlocalSortIndex += 1;\n\t\t\tconst newSortIndex = `${parentSortIndex}${localSortIndex}`;\n\n\t\t\tdescendant.fields.setDisplaySortIndex(newSortIndex);\n\n\t\t\tif (!descendant.isCheckList())\n\t\t\t{\n\t\t\t\tdescendant.container.querySelector('.checklist-item-number').innerText = newSortIndex;\n\t\t\t}\n\n\t\t\tdescendant.updateDisplaySortIndexes();\n\t\t});\n\t}\n\n\thandleTaskOptions()\n\t{\n\t\tconst {userId, showCompleted, showOnlyMine} = this.optionManager;\n\n\t\tthis.getRootNode().hideByCondition((item) => {\n\t\t\tconst isComplete = item.fields.getIsComplete();\n\t\t\tconst hasUserInMembers = item.fields.getMembers().has(userId.toString());\n\t\t\tlet condition;\n\n\t\t\tif (!showCompleted && showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = isComplete || !hasUserInMembers;\n\t\t\t}\n\t\t\telse if (!showCompleted)\n\t\t\t{\n\t\t\t\tcondition = isComplete;\n\t\t\t}\n\t\t\telse if (showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = !hasUserInMembers;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcondition = false;\n\t\t\t}\n\n\t\t\treturn condition;\n\t\t});\n\t}\n\n\thideByCondition(condition)\n\t{\n\t\tif (this.checkCanHide(condition))\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tdescendant.hideByCondition(condition);\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckCanHide(condition)\n\t{\n\t\tif (\n\t\t\tthis.isTaskRoot()\n\t\t\t|| this.updateMode\n\t\t\t|| Dom.hasClass(this.container, 'checklist-item-show')\n\t\t\t|| !condition(this)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet canHide = true;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (!condition(descendant))\n\t\t\t{\n\t\t\t\tcanHide = false;\n\t\t\t}\n\t\t\telse if (canHide)\n\t\t\t{\n\t\t\t\tcanHide = descendant.checkCanHide(condition);\n\t\t\t}\n\t\t});\n\n\t\treturn canHide;\n\t}\n\n\thide()\n\t{\n\t\tDom.hide(this.container);\n\t}\n\n\tshow()\n\t{\n\t\tDom.show(this.container);\n\t}\n\n\tcheckIsComplete()\n\t{\n\t\tlet isComplete;\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\tisComplete = false;\n\t\t}\n\t\telse if (this.isCheckList())\n\t\t{\n\t\t\tconst completedCount = this.countCompletedCount(true);\n\t\t\tconst totalCount = this.countTotalCount(true);\n\n\t\t\tisComplete = (completedCount === totalCount && totalCount > 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tisComplete = this.fields.getIsComplete();\n\t\t}\n\n\t\treturn isComplete;\n\t}\n\n\tcheckActiveUpdateExist()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tlet found = false;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === false)\n\t\t\t{\n\t\t\t\tfound = descendant.checkActiveUpdateExist();\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tdisableAllGroup()\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsSelected())\n\t\t\t{\n\t\t\t\tdescendant.toggleGroup();\n\t\t\t}\n\t\t});\n\t}\n\n\tdisableAllUpdateModes()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tthis.handleUpdateEnding();\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.disableAllUpdateModes();\n\t\t});\n\t}\n\n\trememberInputState()\n\t{\n\t\tthis.input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\t}\n\n\tclearInput(e)\n\t{\n\t\te.preventDefault();\n\n\t\tthis.container.querySelector(`#text_${this.getNodeId()}`).value = '';\n\t\tthis.retrieveFocus();\n\t}\n\n\tretrieveFocus()\n\t{\n\t\tif (this.input !== null && this.inputCursorPosition)\n\t\t{\n\t\t\tconst {start, end} = this.inputCursorPosition;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.setSelectionRange(start, end);\n\t\t\t}, 10);\n\t\t}\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"checklist-header-name\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-after-icon ui-ctl-xs ui-ctl-no-padding ui-ctl-underline \n\t\t\t\t\t\t\t\tchecklist-header-name-editor\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getDisplayTitle()}\"\n\t\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.UI.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"checklist-item-inner checklist-item-new ${this.fields.getIsComplete() ? 'checklist-item-solved' : ''}\">\n\t\t\t\t<div class=\"checklist-item-flag-block\">\n\t\t\t\t\t<div class=\"checklist-item-flag\">\n\t\t\t\t\t\t<label class=\"checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"checklist-item-flag-sub-checklist-progress\">\n\t\t\t\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"checklist-item-flag-element-decorate\"/>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"checklist-item-content-block\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-after-icon ui-ctl-w100\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getDisplayTitle()}\"\n\t\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\tconst position = BX.pos(nodeToPosition || item.getContainer());\n\n\t\tif (!this.panel)\n\t\t{\n\t\t\tthis.panel = Tag.render`\n\t\t\t\t<div class=\"checklist-item-editor-panel-container\">\n\t\t\t\t\t${item.getPanelBodyLayout()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\n\t\t\tDom.append(this.panel, document.body);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.replace(this.panel.querySelector('.checklist-item-editor-panel'), item.getPanelBodyLayout());\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t}\n\n\t\tif (!Dom.isShown(this.panel))\n\t\t{\n\t\t\tDom.show(this.panel);\n\t\t}\n\n\t\tif (Dom.isShown(this.panel) && item.isCheckList() && !item.checkCanAddAccomplice())\n\t\t{\n\t\t\tDom.hide(this.panel);\n\t\t}\n\t}\n\n\tenableUpdateMode()\n\t{\n\t\tconst viewModeLayout = this.container.querySelector(\n\t\t\tthis.isCheckList() ? '.checklist-header-name' : '.checklist-item-inner',\n\t\t);\n\t\tconst updateModeLayout = this.getUpdateModeLayout();\n\n\t\tDom.addClass(viewModeLayout, 'checklist-item-hidden');\n\t\tDom.insertBefore(updateModeLayout, viewModeLayout);\n\n\t\tthis.input = updateModeLayout.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.input.focus();\n\t\tthis.input.setSelectionRange(this.input.value.length, this.input.value.length);\n\n\t\tif (this.input.value === '' || this.input.value.length === 0)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (Dom.isShown(this.input))\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}, 250);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t}\n\n\t\tthis.updateMode = true;\n\t}\n\n\tdisableUpdateMode()\n\t{\n\t\tconst currentInner = this.container.querySelector(this.isCheckList() ? '.checklist-header-name' : '.checklist-item-inner');\n\t\tconst text = Text.encode(currentInner.querySelector(`#text_${this.getNodeId()}`).value.trim().substring(0, 255));\n\n\t\tthis.processMembersFromText(text);\n\t\tthis.updateTitle(text);\n\t\tthis.updateDisplayTitle(text);\n\n\t\tDom.removeClass(currentInner.nextElementSibling, 'checklist-item-hidden');\n\t\tDom.remove(currentInner);\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tcheckCanDeleteOnUpdateEnding()\n\t{\n\t\treturn this.getDescendantsCount() === 0\n\t\t\t&& Object.keys(this.fields.getAttachments()).length === 0\n\t\t\t&& this.filesLoaderProgressBars.size === 0;\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tCheckListItem.makeDangerElement(input.parentElement);\n\t\t\t\tif (this.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\t\t}\n\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\ttoggleUpdateMode(e)\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tif (e.keyCode === 13)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding(!this.isCheckList());\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst rootNode = this.getRootNode();\n\n\t\t\trootNode.disableAllUpdateModes();\n\t\t\trootNode.disableAllGroup();\n\n\t\t\tif (!rootNode.checkActiveUpdateExist())\n\t\t\t{\n\t\t\t\tthis.enableUpdateMode();\n\t\t\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged');\n\t\t\t}\n\t\t}\n\t}\n\n\tonInputKeyPressed(e)\n\t{\n\t\tif (e.keyCode === 13)\n\t\t{\n\t\t\tthis.toggleUpdateMode(e);\n\t\t\te.preventDefault();\n\t\t}\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged');\n\t}\n\n\tonHeaderNameClick(e)\n\t{\n\t\tif (\n\t\t\t!this.checkCanUpdate()\n\t\t\t|| e.target.closest('.checklist-item-auditor')\n\t\t\t|| e.target.closest('.checklist-item-accomplice')\n\t\t\t|| e.target.closest('.checklist-item-link')\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tonInnerContainerClick(e)\n\t{\n\t\tif (\n\t\t\t!this.checkCanUpdate()\n\t\t\t|| e.target.closest('.checklist-item-auditor')\n\t\t\t|| e.target.closest('.checklist-item-accomplice')\n\t\t\t|| e.target.closest('.checklist-item-link')\n\t\t\t|| e.target.closest('.checklist-item-important')\n\t\t\t|| e.target.closest('.checklist-item-dragndrop')\n\t\t\t|| e.target.closest('.checklist-item-group-checkbox')\n\t\t\t|| e.target.closest('.checklist-item-remove')\n\t\t\t|| e.target.closest('.checklist-item-flag-block')\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getCheckList().fields.getIsSelected())\n\t\t{\n\t\t\tthis.toggleSelect(e);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tgetImportantLayout()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"checklist-item-important\" onclick=\"${this.onImportantClick.bind(this)}\"></div>\n\t\t`;\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.remove(this.container.querySelector('.checklist-item-important'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.insertBefore(this.getImportantLayout(), this.container.querySelector('.checklist-item-description'));\n\t\t}\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged');\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tcheckSelectedItems()\n\t{\n\t\treturn this.getRootNode().getSelectedItems().length > 0;\n\t}\n\n\trunForEachSelectedItem(callback, reverse = false)\n\t{\n\t\tlet selectedItems = this.getRootNode().getSelectedItems();\n\n\t\tif (reverse)\n\t\t{\n\t\t\tselectedItems = [...selectedItems.reverse()];\n\t\t}\n\n\t\tselectedItems.forEach((item) => {\n\t\t\tcallback(item);\n\t\t});\n\t}\n\n\tonImportantClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.toggleImportant();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleImportant();\n\n\t\tconst panelImportantButton = e.target.closest('.checklist-item-editor-panel-btn-important');\n\t\tif (panelImportantButton)\n\t\t{\n\t\t\tDom.toggleClass(panelImportantButton, 'checklist-item-editor-panel-btn-important-selected');\n\t\t}\n\t}\n\n\tonCompleteButtonClick()\n\t{\n\t\tif (\n\t\t\tthis.getCheckList().fields.getIsSelected()\n\t\t\t|| this.updateMode\n\t\t\t|| !this.checkCanToggle()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleComplete();\n\t}\n\n\ttoggleComplete()\n\t{\n\t\tconst isComplete = this.fields.getIsComplete();\n\n\t\tthis.fields.setIsComplete(!isComplete);\n\t\tthis.getParent().updateCounts();\n\t\tthis.getParent().updateProgress();\n\n\t\tDom.toggleClass(this.getInnerContainer(), 'checklist-item-solved');\n\n\t\tthis.handleCheckListChanges();\n\t\tthis.handleTaskOptions();\n\n\t\tthis.runAjaxToggleComplete();\n\t}\n\n\trunAjaxToggleComplete()\n\t{\n\t\tconst id = this.fields.getId();\n\n\t\tif (!id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {};\n\t\tconst {ajaxActions, entityId, entityType, stableTreeStructure} = this.optionManager;\n\t\tconst actionName = this.fields.getIsComplete() ? ajaxActions.COMPLETE : ajaxActions.RENEW;\n\n\t\tdata[`${entityType.toLowerCase()}Id`] = entityId;\n\t\tdata.checkListItemId = id;\n\n\t\tBX.ajax.runAction(actionName, {data}).then((response) => {\n\t\t\tconst isComplete = response.data.checkListItem.isComplete;\n\t\t\tthis.updateStableTreeStructure(isComplete, stableTreeStructure, stableTreeStructure);\n\t\t});\n\t}\n\n\tupdateStableTreeStructure(isComplete, item, parent)\n\t{\n\t\tif (this.fields.getId() === item.FIELDS.id)\n\t\t{\n\t\t\titem.FIELDS.isComplete = isComplete;\n\t\t\tparent.FIELDS.completedCount += (isComplete ? 1 : -1);\n\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.updateStableTreeStructure(isComplete, descendant, item);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tunselectAll()\n\t{\n\t\tconst checkBox = this.container.querySelector(`#select_${this.getNodeId()}`);\n\n\t\tif (checkBox && checkBox.checked === true)\n\t\t{\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tcheckBox.checked = false;\n\t\t\tDom.removeClass(this.getInnerContainer(), 'checklist-item-selected');\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.unselectAll();\n\t\t});\n\t}\n\n\tgetSelected()\n\t{\n\t\tlet selected = [];\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tselected.push(this);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tselected = [...selected, ...descendant.getSelected()];\n\t\t});\n\n\t\treturn selected;\n\t}\n\n\tgetSelectedItems()\n\t{\n\t\treturn this.getSelected().filter(item => !item.isCheckList() && !item.isTaskRoot());\n\t}\n\n\tonSelectCheckboxClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\te.target.checked = false;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleSelect();\n\t}\n\n\ttoggleSelect()\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = false;\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(rootNode.panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = true;\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\t\t}\n\n\t\tDom.toggleClass(this.getInnerContainer(), 'checklist-item-selected');\n\t}\n\n\tonGroupButtonClick()\n\t{\n\t\tif (!this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\tthis.toggleGroup();\n\t\t}\n\t}\n\n\ttoggleGroup()\n\t{\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.unselectAll();\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsSelected(true);\n\t\t}\n\n\t\tDom.toggleClass(this.container, 'checklist-item-group-editor-collapse');\n\t\tDom.toggleClass(this.container, 'checklist-item-group-editor-expand');\n\t}\n\n\tonCollapseButtonClick()\n\t{\n\t\tthis.toggleCollapse();\n\t}\n\n\ttoggleCollapse()\n\t{\n\t\tDom.toggleClass(this.container, 'checklist-collapse');\n\n\t\tconst wrapperList = this.container.querySelector('.checklist-items-wrapper');\n\t\tconst wrapperListHeight = `${BX.pos(wrapperList).height}px`;\n\n\t\tif (Dom.hasClass(this.container, 'checklist-collapse'))\n\t\t{\n\t\t\tthis.fields.setIsCollapse(true);\n\n\t\t\twrapperList.style.overflow = 'hidden';\n\t\t\twrapperList.style.height = wrapperListHeight;\n\t\t\tsetTimeout(() => { wrapperList.style.height = 0; }, 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsCollapse(false);\n\n\t\t\twrapperList.style.height = 0;\n\t\t\tsetTimeout(() => { wrapperList.style.height = `${wrapperList.scrollHeight}px`; }, 0);\n\t\t\tsetTimeout(() => {\n\t\t\t\twrapperList.style.height = '';\n\t\t\t\twrapperList.style.overflow = '';\n\t\t\t}, 250);\n\t\t}\n\t}\n\n\ttoggleEmpty()\n\t{\n\t\tDom.toggleClass(this.container, 'checklist-empty');\n\t}\n\n\thandleCheckListIsComplete()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsComplete = checkList.checkIsComplete();\n\n\t\tcheckList.fields.setIsComplete(checkListIsComplete);\n\n\t\tif (checkListIsComplete && !Dom.hasClass(checkList.container, 'checklist-collapse'))\n\t\t{\n\t\t\tcheckList.toggleCollapse();\n\t\t}\n\t}\n\n\thandleCheckListIsEmpty()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsEmpty = checkList.getDescendantsCount() === 0;\n\n\t\tif (\n\t\t\t(checkListIsEmpty && !Dom.hasClass(checkList.container, 'checklist-empty'))\n\t\t\t|| (!checkListIsEmpty && Dom.hasClass(checkList.container, 'checklist-empty'))\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleEmpty();\n\t\t}\n\t}\n\n\thandleCheckListChanges()\n\t{\n\t\tthis.handleCheckListIsComplete();\n\t\tthis.handleCheckListIsEmpty();\n\t}\n\n\tcheckCanAdd()\n\t{\n\t\treturn this.optionManager.getCanAdd();\n\t}\n\n\tcheckCanAddAccomplice()\n\t{\n\t\treturn this.optionManager.getCanAddAccomplice();\n\t}\n\n\tcheckCanUpdate()\n\t{\n\t\treturn this.action.canUpdate;\n\t}\n\n\tcheckCanRemove()\n\t{\n\t\treturn this.action.canRemove;\n\t}\n\n\tcheckCanToggle()\n\t{\n\t\treturn this.action.canToggle;\n\t}\n\n\tcheckCanDrag()\n\t{\n\t\treturn this.action.canDrag;\n\t}\n\n\tgetAttachmentsContainer()\n\t{\n\t\treturn this.container.querySelector(`#attachments_${this.getNodeId()}`);\n\t}\n\n\tgetSubItemsContainer()\n\t{\n\t\treturn this.container.querySelector(`#subItems_${this.getNodeId()}`);\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector('.checklist-item-inner');\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this.container;\n\t}\n\n\tmove(item, position = 'bottom')\n\t{\n\t\tif (\n\t\t\tthis.getNodeId() === item.getNodeId()\n\t\t\t|| this.findChild(item.getNodeId()) !== null\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst oldParent = this.getParent();\n\t\tconst newParent = item.getParent();\n\n\t\toldParent.remove(this);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tnewParent.addBefore(this, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.addAfter(this, item);\n\t\t}\n\n\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tDom.insertBefore(this.container, item.container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.insertAfter(this.container, item.container);\n\t\t}\n\n\t\tthis.handleCheckListIsEmpty();\n\t\tthis.handleTaskOptions();\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged');\n\t}\n\n\tmakeChildOf(item, position = 'bottom')\n\t{\n\t\tif (item.getDescendantsCount() > 0)\n\t\t{\n\t\t\tconst borderItems = {\n\t\t\t\ttop: item.getFirstDescendant(),\n\t\t\t\tbottom: item.getLastDescendant(),\n\t\t\t};\n\n\t\t\tthis.move(borderItems[position], position);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst oldParent = this.getParent();\n\t\t\tconst newParent = item;\n\n\t\t\toldParent.remove(this);\n\t\t\tnewParent.add(this);\n\n\t\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\t\tDom.append(this.container, newParent.getSubItemsContainer());\n\n\t\t\tthis.handleCheckListIsEmpty();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged');\n\t\t}\n\t}\n\n\ttabIn()\n\t{\n\t\tconst descendants = this.getParent().getDescendants();\n\t\tconst index = descendants.findIndex(item => item === this);\n\n\t\tif (index === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.makeChildOf(descendants[index - 1]);\n\t}\n\n\tonTabInClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabIn();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabIn();\n\t\tthis.retrieveFocus();\n\t}\n\n\ttabOut()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tif (parent.isCheckList())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.move(parent, 'bottom');\n\t}\n\n\tonTabOutClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabOut();\n\t\t\t}, true);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabOut();\n\t\tthis.retrieveFocus();\n\t}\n\n\taddCheckListItem(item = null, dependsOn = null, position = 'after')\n\t{\n\t\tconst itemGet = item instanceof CheckListItem;\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst newCheckListItem = itemGet ? item : new CheckListItem();\n\t\t\tlet newCheckListItemLayout;\n\n\t\t\tif (dependsOn instanceof CheckListItem)\n\t\t\t{\n\t\t\t\tif (position === 'before')\n\t\t\t\t{\n\t\t\t\t\tthis.addBefore(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tCheckListItem.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertBefore(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t\telse if (position === 'after')\n\t\t\t\t{\n\t\t\t\t\tthis.addAfter(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tCheckListItem.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertAfter(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.add(newCheckListItem);\n\n\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\tCheckListItem.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\tDom.append(newCheckListItemLayout, this.getSubItemsContainer());\n\t\t\t}\n\n\t\t\tthis.updateCounts();\n\t\t\tthis.updateIndexes();\n\n\t\t\tif (!this.isTaskRoot())\n\t\t\t{\n\t\t\t\tthis.updateProgress();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tif (!itemGet)\n\t\t\t\t{\n\t\t\t\t\tnewCheckListItem.toggleUpdateMode();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.height = `${newCheckListItemLayout.scrollHeight}px`;\n\t\t\t\tnewCheckListItemLayout.style.opacity = 1;\n\t\t\t}, 1);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.overflow = '';\n\t\t\t\tnewCheckListItemLayout.style.height = '';\n\t\t\t\tnewCheckListItemLayout.style.opacity = '';\n\n\t\t\t\tDom.removeClass(newCheckListItemLayout, 'checklist-item-show');\n\n\t\t\t\tresolve(newCheckListItem);\n\t\t\t}, 250);\n\t\t});\n\t}\n\n\tonAddCheckListItemClick()\n\t{\n\t\tif (this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addCheckListItem();\n\t}\n\n\tgetRequestData(inputData = null)\n\t{\n\t\tconst title = this.fields.getTitle();\n\t\tlet data = inputData || [];\n\n\t\tif (!this.isTaskRoot() && title !== '' && title.length > 0)\n\t\t{\n\t\t\tconst requestData = {\n\t\t\t\tNODE_ID: this.getNodeId(),\n\t\t\t\tPARENT_NODE_ID: this.getParent().getNodeId(),\n\t\t\t\tID: this.fields.getId(),\n\t\t\t\tCOPIED_ID: this.fields.getCopiedId(),\n\t\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\t\tMEMBERS: [],\n\t\t\t\tATTACHMENTS: {},\n\t\t\t};\n\n\t\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\t\tconst {nameFormatted, type} = value;\n\t\t\t\trequestData.MEMBERS.push({\n\t\t\t\t\t[key]: {\n\t\t\t\t\t\tTYPE: type,\n\t\t\t\t\t\tNAME: Text.decode(nameFormatted),\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst attachments = this.fields.getAttachments();\n\t\t\tObject.keys(attachments).forEach((id) => {\n\t\t\t\trequestData.ATTACHMENTS[id] = attachments[id];\n\t\t\t});\n\n\t\t\tdata.push(requestData);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdata = descendant.getRequestData(data);\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tappendRequestLayout()\n\t{\n\t\tif (!this.isTaskRoot())\n\t\t{\n\t\t\tconst nodeId = this.getNodeId();\n\t\t\tconst attachments = this.fields.getAttachments();\n\t\t\tconst prefix = `${this.optionManager.prefix}[${nodeId}]`;\n\n\t\t\tlet membersLayout = '';\n\t\t\tlet attachmentsLayout = '';\n\n\t\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_${key}\" name=\"${prefix}[MEMBERS][${key}][TYPE]\" value=\"${value.type}\"/>`;\n\t\t\t});\n\n\t\t\tObject.keys(attachments).forEach((id) => {\n\t\t\t\tattachmentsLayout += `<input type=\"hidden\" id=\"ATTACHMENTS_${id}\" name=\"${prefix}[ATTACHMENTS][${id}]\" value=\"${attachments[id]}\"/>`;\n\t\t\t});\n\n\t\t\tconst requestLayout = Tag.render`\n\t\t\t\t<div id=\"request_${nodeId}\">\n\t\t\t\t\t<input type=\"hidden\" id=\"NODE_ID\" name=\"${prefix}[NODE_ID]\" value=\"${nodeId}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_NODE_ID\" name=\"${prefix}[PARENT_NODE_ID]\" value=\"${this.getParent().getNodeId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"ID\" name=\"${prefix}[ID]\" value=\"${this.fields.getId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"COPIED_ID\" name=\"${prefix}[COPIED_ID]\" value=\"${this.fields.getCopiedId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_ID\" name=\"${prefix}[PARENT_ID]\" value=\"${this.fields.getParentId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TITLE\" name=\"${prefix}[TITLE]\" value=\"${this.fields.getTitle()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"SORT_INDEX\" name=\"${prefix}[SORT_INDEX]\" value=\"${this.fields.getSortIndex()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_COMPLETE\" name=\"${prefix}[IS_COMPLETE]\" value=\"${this.fields.getIsComplete()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_IMPORTANT\" name=\"${prefix}[IS_IMPORTANT]\" value=\"${this.fields.getIsImportant()}\"/>\n\t\t\t\t\t${membersLayout}\n\t\t\t\t\t${attachmentsLayout}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.remove(this.container.querySelector(`#request_${nodeId}`));\n\t\t\tDom.append(requestLayout, this.container);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.appendRequestLayout();\n\t\t});\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst searchId = this.fields.getId() || this.fields.getCopiedId();\n\t\tconst {optionManager} = this;\n\t\tconst optionAttachments = optionManager.attachments;\n\t\tlet attachmentsLayout = '';\n\n\t\tif (optionAttachments && (searchId in optionAttachments))\n\t\t{\n\t\t\tconst attachments = Tag.render`${optionAttachments[searchId]}`;\n\t\t\tconst stableAttachments = this.getStableAttachments(optionManager.getStableTreeStructure());\n\t\t\tconst attachmentsToDelete = [];\n\n\t\t\tif (!attachments)\n\t\t\t{\n\t\t\t\treturn attachmentsLayout;\n\t\t\t}\n\n\t\t\tattachmentsLayout = attachments;\n\n\t\t\tif (!Array.isArray(attachments))\n\t\t\t{\n\t\t\t\tattachmentsLayout = [attachments];\n\t\t\t}\n\n\t\t\tObject.keys(attachmentsLayout).forEach((key) => {\n\t\t\t\tconst attachment = attachmentsLayout[key];\n\t\t\t\tconst fileId = attachment.getAttribute('data-bx-id');\n\t\t\t\tconst extension = CheckListItem.getFileExtension(attachment.getAttribute('data-bx-extension'));\n\t\t\t\tconst extensionClass = `ui-icon-file-${extension}`;\n\t\t\t\tconst iconContainer = attachment.querySelector(`#disk-attach-file-${fileId}`);\n\t\t\t\tconst deleteButton = Tag.render`\n\t\t\t\t\t<div class=\"checklist-item-attachment-file-remove\"\n\t\t\t\t\t\t onclick=\"${this.onDeleteAttachmentClick.bind(this, fileId)}\"></div>\n\t\t\t\t`;\n\t\t\t\tconst has = Object.prototype.hasOwnProperty;\n\n\t\t\t\tif (!has.call(stableAttachments, fileId))\n\t\t\t\t{\n\t\t\t\t\tattachmentsToDelete.push(key);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (iconContainer && !Dom.hasClass(iconContainer, extensionClass))\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(iconContainer, extensionClass);\n\t\t\t\t}\n\n\t\t\t\tif (this.checkCanUpdate())\n\t\t\t\t{\n\t\t\t\t\tDom.append(deleteButton, attachment.querySelector('.checklist-item-attachment-file-cover'));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tattachmentsToDelete.sort((a, b) => b - a);\n\t\t\tattachmentsToDelete.forEach((id) => {\n\t\t\t\tattachmentsLayout.splice(id, 1);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setAttachments({});\n\t\t}\n\n\t\treturn attachmentsLayout;\n\t}\n\n\tgetStableAttachments(item)\n\t{\n\t\tconst fields = item.FIELDS;\n\t\tconst id = fields.id || fields.copiedId;\n\n\t\tif (id === this.fields.getId() || id === this.fields.getCopiedId())\n\t\t{\n\t\t\treturn fields.attachments;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.getStableAttachments(descendant);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tgetLoadedAttachmentLayout(attachment)\n\t{\n\t\tconst {id, name, viewUrl, size, ext} = attachment;\n\t\tlet img = '';\n\n\t\tif (viewUrl)\n\t\t{\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"checklist-item-attachment-file-cover\" style=\"background-image: url(${viewUrl})\">\n\t\t\t\t\t<div class=\"checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(this, id)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst extension = CheckListItem.getFileExtension(ext);\n\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"checklist-item-attachment-file-cover\">\n\t\t\t\t\t<div class=\"ui-icon ui-icon-file-${extension}\"><i></i></div>\n\t\t\t\t\t<div class=\"checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(this, id)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"checklist-item-attachment-file\" id=\"disk-attach-${id}\" data-bx-id=\"${id}\">\n\t\t\t\t${img}\n\t\t\t\t<div class=\"checklist-item-attachment-file-name\">\n\t\t\t\t\t<label class=\"checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"checklist-item-attachment-file-size\">\n\t\t\t\t\t<label class=\"checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonAttachmentsLoaderMenuItemClick()\n\t{\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\tgetAttachmentsLoaderLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst {prefix} = this.optionManager;\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t\t<div id=\"diskuf-selectdialog-${nodeId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t\t<div class=\"diskuf-files-block checklist-loader-files\">\n\t\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t\t<input type=\"hidden\" name=\"${prefix}[${nodeId}][UF_CHECKLIST_FILES][]\" value=\"\"/>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t\t<label for=\"file_loader_${nodeId}\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${nodeId}\" type=\"file\"\n\t\t\t\t\t\t\t\t   multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.OnFileUploadSuccess.bind(this));\n\t\tBX.addCustomEvent(filesChooser, 'DiskDLoadFormControllerInit', (uf) => {\n\t\t\tuf._onUploadProgress = this.onUploadProgress.bind(this);\n\t\t});\n\n\t\treturn filesChooser;\n\t}\n\n\tonUploadProgress(item, progress)\n\t{\n\t\tconst {id, name, size} = item;\n\t\tconst newProgress = Math.min(progress, 98);\n\n\t\tif (!this.filesLoaderProgressBars.has(id))\n\t\t{\n\t\t\tconst myProgress = new BX.UI.ProgressRound({\n\t\t\t\tid: `load_progress_${id}`,\n\t\t\t\tvalue: newProgress,\n\t\t\t\tmaxValue: 100,\n\t\t\t\twidth: 69,\n\t\t\t\tlineSize: 5,\n\t\t\t\tfill: false,\n\t\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t\t\tstatusType: BX.UI.ProgressRound.Status.INCIRCLE,\n\t\t\t});\n\t\t\tconst filePreview = Tag.render`\n\t\t\t\t<div class=\"checklist-item-attachment-file\" id=\"disk-attach-${id}\">\n\t\t\t\t\t${myProgress.getContainer()}\n\t\t\t\t\t<div class=\"checklist-item-attachment-file-name\">\n\t\t\t\t\t\t<label class=\"checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"checklist-item-attachment-file-size\">\n\t\t\t\t\t\t<label class=\"checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.filesLoaderProgressBars.set(id, myProgress);\n\t\t\tDom.append(filePreview, this.getAttachmentsContainer());\n\t\t}\n\n\t\tif (!item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = 5;\n\t\t}\n\n\t\tif (newProgress > item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = Math.ceil(newProgress);\n\t\t\titem.progressBarWidth = item.progressBarWidth > 100 ? 100 : item.progressBarWidth;\n\n\t\t\tif (this.filesLoaderProgressBars.has(id))\n\t\t\t{\n\t\t\t\tthis.filesLoaderProgressBars.get(id).update(item.progressBarWidth);\n\t\t\t}\n\t\t}\n\t}\n\n\tOnFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst attachmentId = fileResult.element_id.toString();\n\t\tconst attachment = {\n\t\t\tid: attachmentId,\n\t\t\tname: fileResult.element_name,\n\t\t\tviewUrl: fileResult.element_url,\n\t\t\tsize: uploaderFile.size,\n\t\t\text: uploaderFile.ext,\n\t\t};\n\n\t\tthis.fields.addAttachments({[attachmentId]: attachmentId});\n\t\tthis.filesLoaderProgressBars.delete(uploaderFile.id);\n\n\t\tconst attachmentProgress = this.getAttachmentsContainer().querySelector(`#disk-attach-${uploaderFile.id}`);\n\t\tconst attachmentLayout = this.getLoadedAttachmentLayout(attachment);\n\n\t\tif (attachmentProgress)\n\t\t{\n\t\t\tDom.replace(attachmentProgress, attachmentLayout);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(attachmentLayout, this.getAttachmentsContainer());\n\t\t}\n\n\t\tconst id = this.fields.getId();\n\t\tconst optionAttachments = this.optionManager.attachments;\n\n\t\tif (optionAttachments)\n\t\t{\n\t\t\tif (id in optionAttachments)\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] += attachmentLayout.outerHTML;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] = attachmentLayout.outerHTML;\n\t\t\t}\n\t\t}\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged');\n\t}\n\n\tgetTaskRootLayout(children)\n\t{\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"checklist-task-root\">\n\t\t\t\t<div id=\"subItems_${this.getNodeId()}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst value = this.fields.getCompletedCount();\n\t\tconst maxValue = this.fields.getTotalCount();\n\t\tconst layouts = {\n\t\t\tlistActionsPanel: Tag.render`<div class=\"checklist-items-list-actions droppable\"></div>`,\n\t\t\tgroupButton: '',\n\t\t\tdndButton: Tag.render`<div class=\"checklist-wrapper-dragndrop\"></div>`,\n\t\t};\n\n\t\tif (this.checkCanAdd())\n\t\t{\n\t\t\tconst addButtonLayout = Tag.render`\n\t\t\t\t<a class=\"checklist-item-add-btn\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tconst groupButton = Tag.render`\n\t\t\t\t<div class=\"checklist-action-group-btn\" onclick=\"${this.onGroupButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_GROUP_ACTIONS')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.append(addButtonLayout, layouts.listActionsPanel);\n\t\t\tlayouts.groupButton = groupButton;\n\t\t}\n\n\t\tif (this.checkCanRemove())\n\t\t{\n\t\t\tconst removeButtonLayout = Tag.render`\n\t\t\t\t<a class=\"checklist-item-remove-btn\" onclick=\"${this.onDeleteClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_DELETE_CHECKLIST')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tDom.append(removeButtonLayout, layouts.listActionsPanel);\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressBar({\n\t\t\tvalue,\n\t\t\tmaxValue,\n\t\t\tsize: BX.UI.ProgressBar.Size.MEDIUM,\n\t\t\ttextAfter: CheckListItem.getProgressText(value, maxValue),\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"checklist-wrapper checklist-item-group-editor-collapse\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"checklist-header-wrapper droppable\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"checklist-header-block\">\n\t\t\t\t\t\t<div class=\"checklist-header-inner\">\n\t\t\t\t\t\t\t<div class=\"checklist-header-name\" onclick=\"${this.onHeaderNameClick.bind(this)}\">\n\t\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"checklist-header-progress-block\">\n\t\t\t\t\t\t\t\t<div class=\"checklist-header-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"checklist-header-actions\">\n\t\t\t\t\t\t${layouts.groupButton}\n\t\t\t\t\t\t<div class=\"checklist-action-collapse-btn collapsed\" onclick=\"${this.onCollapseButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"checklist-items-wrapper\">\n\t\t\t\t\t<div class=\"checklist-items-list\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${layouts.listActionsPanel}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst layouts = {\n\t\t\tdeleteButton: Tag.render`<button class=\"checklist-item-remove\" onclick=\"${this.onDeleteClick.bind(this)}\"/>`,\n\t\t\tdndButton: Tag.render`<div class=\"checklist-item-dragndrop\"></div>`,\n\t\t\tattachments: this.getAttachmentsLayout(),\n\t\t};\n\n\t\tif (!this.checkCanRemove())\n\t\t{\n\t\t\tlayouts.deleteButton = '';\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"checklist-item\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"checklist-item-inner droppable ${this.fields.getIsComplete() ? 'checklist-item-solved' : ''}\"\n\t\t\t\t\t onclick=\"${this.onInnerContainerClick.bind(this)}\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"checklist-item-flag-block\">\n\t\t\t\t\t\t<div class=\"checklist-item-flag\">\n\t\t\t\t\t\t\t<label class=\"checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t\t<span class=\"checklist-item-flag-sub-checklist-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"checklist-item-flag-element-decorate\"/>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"checklist-item-content-block\">\n\t\t\t\t\t\t<div class=\"checklist-item-number\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.fields.getIsImportant() ? this.getImportantLayout() : ''}\n\t\t\t\t\t\t<div class=\"checklist-item-description\">\n\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"checklist-item-additional-block\">\n\t\t\t\t\t\t${layouts.deleteButton}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"checklist-item-actions-block\">\n\t\t\t\t\t\t<input class=\"checklist-item-group-checkbox\" id=\"select_${nodeId}\" type=\"checkbox\"\n\t\t\t\t\t\t\t   onclick=\"${this.onSelectCheckboxClick.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"checklist-item-attachment\">\n\t\t\t\t\t<div class=\"checklist-item-attachment-list\" id=\"attachments_${nodeId}\">\n\t\t\t\t\t\t${layouts.attachments}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"checklist-sublist-items-wrapper\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetLayout()\n\t{\n\t\tconst children = [];\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tchildren.push(descendant.getLayout());\n\t\t});\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\treturn this.getTaskRootLayout(children);\n\t\t}\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tconst checkListLayout = this.getCheckListLayout(children);\n\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\treturn checkListLayout;\n\t\t}\n\n\t\treturn this.getCheckListItemLayout(children);\n\t}\n}\n\nexport {CheckListItem};"],"names":["TreeItem","Math","random","toString","substr","setNodeId","generateUniqueNodeId","setParent","parent","getParent","nodeId","CompositeTreeItem","descendants","item","position","push","splice","after","index","findIndex","descendant","add","before","length","getNodeId","found","forEach","findChild","size","getDescendantsCount","countTreeSize","getRootNode","CheckListItemFields","string","camelCaseString","Type","isString","toLowerCase","replace","match","chr","toUpperCase","snakeCaseString","fields","id","parentId","title","sortIndex","displayTitle","displaySortIndex","isComplete","isImportant","isSelected","isCollapse","completedCount","totalCount","members","Map","attachments","setFields","Object","keys","name","camelCaseName","snakeToCamelCase","indexOf","snakeCaseName","camelToSnakeCase","setMethod","bind","copiedId","types","A","U","clear","NAME","TYPE","set","nameFormatted","Text","encode","type","member","delete","CheckListItem","element","dangerClass","Dom","hasClass","addClass","oldParent","newParent","updateCounts","updateProgress","updateIndexes","completed","total","replaces","progressText","Loc","getMessage","search","ext","fileExtension","input","start","end","normalizedValue","range","textInputRange","len","endRange","selectionStart","selectionEnd","document","selection","createRange","parentElement","value","createTextRange","moveToBookmark","getBookmark","collapse","compareEndPoints","moveStart","slice","split","moveEnd","layout","action","style","overflow","height","opacity","scrollHeight","defaultDisplayTitle","canUpdate","MODIFY","canRemove","REMOVE","canToggle","TOGGLE","canDrag","DRAG","panel","progress","filesLoaderPopup","filesLoaderProgressBars","updateMode","optionManager","isTaskRoot","recursively","getDescendants","getIsComplete","countCompletedCount","countTotalCount","setCompletedCount","setTotalCount","updateCompletedCount","updateTotalCount","getTotalCount","getCompletedCount","setMaxValue","update","isCheckList","updateProgressText","getProgressText","setTextAfter","remove","setDefaultStyles","container","setTimeout","paddingTop","getSortIndex","addCheckListItem","getFirstDescendant","showBalloon","getTitle","data","getNotificationBalloon","Event","EventEmitter","emit","e","preventDefault","hide","checkSelectedItems","items","getSelectedItems","runForEachSelectedItem","setIsSelected","deleteAction","handleCheckListChanges","actions","content","events","click","event","balloon","close","restore","handleTaskOptions","Tag","render","avatar","BX","loadExt","then","UI","Notification","Center","notify","rootNode","moveToNewCheckList","PopupMenuWindow","target","getToAnotherCheckListPopupItems","autoHide","closeByEsc","offsetLeft","offsetWidth","angle","onPopupClose","destroy","show","selectMode","popupMenuItems","toNewCheckListMenuItem","text","message","onclick","getMenuWindow","getDisplayTitle","selectedItem","makeChildOf","unselectAll","delimiter","checkList","getCheckList","checkLists","filter","handleUpdateEnding","number","newCheckList","TITLE","DISPLAY_TITLE","memberSelector","space","newTitle","substring","addMember","updateTitle","updateDisplayTitle","inputCursorPosition","inputText","startSpace","charAt","endSpace","newInputText","decode","retrieveFocus","auditor","resultAuditor","processMemberSelect","accomplice","resultAccomplice","Tasks","Integration","Socialnetwork","NetworkSelector","scope","mode","useSearch","useAdd","controlBind","bindEvent","onSocNetSelectorAuditorSelected","open","onSocNetSelectorAccompliceSelected","prefix","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","PopupWindow","getAttachmentsLoaderLayout","bindElement","setBindElement","Disk","UF","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","querySelector","fileId","removeAttachment","getAttachmentsContainer","membersLayout","onAddAuditorClick","onAddAccompliceClick","attachmentButtonLayout","onUploadAttachmentClick","itemsActionButtonsLayout","onTabInClick","onTabOutClick","getIsImportant","onImportantClick","onToAnotherCheckListClick","onDeleteClick","checkCanAddAccomplice","setTitle","oldTitleNode","newTitleNode","getTitleLayout","setDisplayTitle","userPath","getDefaultDisplayTitle","getMembers","regExp","RegExp","href","url","membersToDelete","removeMember","updateSortIndexes","updateDisplaySortIndexes","setSortIndex","parentSortIndex","getDisplaySortIndex","localSortIndex","newSortIndex","setDisplaySortIndex","innerText","userId","showCompleted","showOnlyMine","hideByCondition","hasUserInMembers","has","condition","checkCanHide","canHide","checkActiveUpdateExist","getIsSelected","toggleGroup","disableAllUpdateModes","getInputSelection","focus","setSelectionRange","onInputKeyPressed","rememberInputState","clearInput","progressBarLayout","ProgressRound","maxValue","width","lineSize","fill","color","Color","PRIMARY","onCompleteButtonClick","getContainer","nodeToPosition","pos","getPanelBodyLayout","top","left","append","body","isShown","viewModeLayout","updateModeLayout","getUpdateModeLayout","insertBefore","showEditorPanel","currentInner","trim","processMembersFromText","removeClass","nextElementSibling","getAttachments","createNewItem","checkCanDeleteOnUpdateEnding","handleCheckListIsEmpty","makeDangerElement","disableUpdateMode","keyCode","disableAllGroup","enableUpdateMode","toggleUpdateMode","checkCanUpdate","closest","toggleSelect","setIsImportant","getImportantLayout","callback","reverse","selectedItems","toggleImportant","panelImportantButton","toggleClass","checkCanToggle","toggleComplete","setIsComplete","getInnerContainer","runAjaxToggleComplete","getId","ajaxActions","entityId","entityType","stableTreeStructure","actionName","COMPLETE","RENEW","checkListItemId","ajax","runAction","response","checkListItem","updateStableTreeStructure","FIELDS","DESCENDANTS","checkBox","checked","selected","getSelected","toggleCollapse","wrapperList","wrapperListHeight","setIsCollapse","checkListIsComplete","checkIsComplete","checkListIsEmpty","toggleEmpty","handleCheckListIsComplete","getCanAdd","getCanAddAccomplice","addBefore","addAfter","updateParents","insertAfter","borderItems","bottom","getLastDescendant","move","getSubItemsContainer","tabIn","tabOut","dependsOn","itemGet","Promise","resolve","newCheckListItem","newCheckListItemLayout","getLayout","inputData","requestData","NODE_ID","PARENT_NODE_ID","ID","COPIED_ID","getCopiedId","PARENT_ID","getParentId","SORT_INDEX","IS_COMPLETE","IS_IMPORTANT","MEMBERS","ATTACHMENTS","key","getRequestData","attachmentsLayout","requestLayout","appendRequestLayout","searchId","optionAttachments","stableAttachments","getStableAttachments","getStableTreeStructure","attachmentsToDelete","Array","isArray","attachment","getAttribute","extension","getFileExtension","extensionClass","iconContainer","deleteButton","onDeleteAttachmentClick","prototype","hasOwnProperty","call","sort","a","b","setAttachments","viewUrl","img","filesChooser","onAttachmentsLoaderMenuItemClick","addCustomEvent","OnFileUploadSuccess","uf","_onUploadProgress","onUploadProgress","newProgress","min","myProgress","statusType","Status","INCIRCLE","filePreview","progressBarWidth","ceil","get","fileResult","file","uploaderFile","attachmentId","element_id","element_name","element_url","addAttachments","attachmentProgress","attachmentLayout","getLoadedAttachmentLayout","outerHTML","children","layouts","listActionsPanel","groupButton","dndButton","checkCanAdd","addButtonLayout","onAddCheckListItemClick","onGroupButtonClick","checkCanRemove","removeButtonLayout","checkCanDrag","visibility","ProgressBar","Size","MEDIUM","textAfter","onHeaderNameClick","onCollapseButtonClick","getAttachmentsLayout","onInnerContainerClick","onSelectCheckboxClick","getTaskRootLayout","checkListLayout","getCheckListLayout","getCheckListItemLayout"],"mappings":"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"}