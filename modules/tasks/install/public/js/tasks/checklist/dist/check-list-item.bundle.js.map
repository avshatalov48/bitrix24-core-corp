{"version":3,"file":"check-list-item.bundle.js","sources":["../src/tree-item.js","../src/composite-tree-item.js","../src/check-list-item-fields.js","../src/check-list-item.js"],"sourcesContent":["class TreeItem\n{\n\tstatic generateUniqueNodeId()\n\t{\n\t\treturn Math.random().toString(36).substr(2, 9);\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.setNodeId(TreeItem.generateUniqueNodeId());\n\t\tthis.setParent(null);\n\t}\n\n\tgetRootNode()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (parent.getParent() !== null)\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tgetNodeId()\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tsetNodeId(nodeId)\n\t{\n\t\tthis.nodeId = nodeId;\n\t}\n\n\tgetParent()\n\t{\n\t\treturn this.parent;\n\t}\n\n\tsetParent(parent)\n\t{\n\t\tthis.parent = parent;\n\t}\n}\n\nexport {TreeItem};","import {TreeItem} from './tree-item';\n\nclass CompositeTreeItem extends TreeItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.descendants = [];\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\titem.setParent(this);\n\n\t\tif (position === null)\n\t\t{\n\t\t\tthis.descendants.push(item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.descendants.splice(position, 0, item);\n\t\t}\n\t}\n\n\taddAfter(item, after)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === after);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index + 1);\n\t\t}\n\t}\n\n\taddBefore(item, before)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === before);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index);\n\t\t}\n\t}\n\n\tremove(item)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === item);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.descendants.splice(index, 1);\n\t\t}\n\t}\n\n\tgetDescendants()\n\t{\n\t\treturn this.descendants;\n\t}\n\n\tgetDescendantsCount()\n\t{\n\t\treturn this.descendants.length;\n\t}\n\n\tgetFirstDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[0];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetLastDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[this.descendants.length - 1];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tisFirstDescendant()\n\t{\n\t\treturn (this === this.getParent().getFirstDescendant());\n\t}\n\n\tisLastDescendant()\n\t{\n\t\treturn (this === this.getParent().getLastDescendant());\n\t}\n\n\tgetLeftSibling()\n\t{\n\t\tif (this.isFirstDescendant())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index - 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetRightSibling()\n\t{\n\t\tif (this.isLastDescendant())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index + 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetLeftSiblingThrough()\n\t{\n\t\tif (this === this.getRootNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.isFirstDescendant())\n\t\t{\n\t\t\treturn this.getParent();\n\t\t}\n\n\t\tlet leftSiblingThrough = this.getLeftSibling();\n\t\twhile (leftSiblingThrough && leftSiblingThrough.getDescendantsCount() > 0)\n\t\t{\n\t\t\tleftSiblingThrough = leftSiblingThrough.getLastDescendant();\n\t\t}\n\n\t\treturn leftSiblingThrough;\n\t}\n\n\tgetRightSiblingThrough()\n\t{\n\t\tif (this.getDescendantsCount() > 0)\n\t\t{\n\t\t\treturn this.getFirstDescendant();\n\t\t}\n\n\t\tif (!this.isLastDescendant())\n\t\t{\n\t\t\treturn this.getRightSibling();\n\t\t}\n\n\t\tlet parent = this;\n\t\twhile (parent.getParent() !== null && parent.isLastDescendant())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\tif (parent !== this.getRootNode())\n\t\t{\n\t\t\treturn parent.getRightSibling();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindChild(nodeId)\n\t{\n\t\tif (!nodeId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.getNodeId().toString() === nodeId.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findChild(nodeId);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountTreeSize()\n\t{\n\t\tlet size = this.getDescendantsCount();\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tsize += descendant.countTreeSize();\n\t\t});\n\n\t\treturn size;\n\t}\n\n\tgetTreeSize()\n\t{\n\t\treturn this.getRootNode().countTreeSize() + 1;\n\t}\n}\n\nexport {CompositeTreeItem};","import {Text, Type} from 'main.core';\n\nclass CheckListItemFields\n{\n\tstatic snakeToCamelCase(string)\n\t{\n\t\tlet camelCaseString = string;\n\n\t\tif (Type.isString(camelCaseString))\n\t\t{\n\t\t\tcamelCaseString = camelCaseString.toLowerCase();\n\t\t\tcamelCaseString = camelCaseString.replace(/[-_\\s]+(.)?/g, (match, chr) => (chr ? chr.toUpperCase() : ''));\n\n\t\t\treturn camelCaseString.substr(0, 1).toLowerCase() + camelCaseString.substr(1);\n\t\t}\n\n\t\treturn camelCaseString;\n\t}\n\n\tstatic camelToSnakeCase(string)\n\t{\n\t\tlet snakeCaseString = string;\n\n\t\tif (Type.isString(snakeCaseString))\n\t\t{\n\t\t\tsnakeCaseString = snakeCaseString.replace(/(.)([A-Z])/g, '$1_$2').toUpperCase();\n\t\t}\n\n\t\treturn snakeCaseString;\n\t}\n\n\tconstructor(fields)\n\t{\n\t\tthis.fields = [\n\t\t\t'id',\n\t\t\t'copiedId',\n\t\t\t'parentId',\n\t\t\t'title',\n\t\t\t'sortIndex',\n\t\t\t'displaySortIndex',\n\t\t\t'isComplete',\n\t\t\t'isImportant',\n\t\t\t'isSelected',\n\t\t\t'isCollapse',\n\t\t\t'completedCount',\n\t\t\t'totalCount',\n\t\t\t'members',\n\t\t\t'attachments',\n\t\t];\n\n\t\tthis.id = null;\n\t\tthis.parentId = null;\n\t\tthis.title = '';\n\t\tthis.sortIndex = 0;\n\t\tthis.displaySortIndex = '';\n\t\tthis.isComplete = false;\n\t\tthis.isImportant = false;\n\t\tthis.isSelected = false;\n\t\tthis.isCollapse = false;\n\t\tthis.completedCount = 0;\n\t\tthis.totalCount = 0;\n\t\tthis.members = new Map();\n\t\tthis.attachments = {};\n\n\t\tthis.setFields(fields);\n\t}\n\n\tsetFields(fields)\n\t{\n\t\tObject.keys(fields).forEach((name) => {\n\t\t\tconst camelCaseName = CheckListItemFields.snakeToCamelCase(name);\n\n\t\t\tif (this.fields.indexOf(name) !== -1)\n\t\t\t{\n\t\t\t\tconst snakeCaseName = CheckListItemFields.camelToSnakeCase(name);\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${snakeCaseName}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t\telse if (this.fields.indexOf(camelCaseName) !== -1)\n\t\t\t{\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${name}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\tgetCopiedId()\n\t{\n\t\treturn this.copiedId;\n\t}\n\n\tsetCopiedId(copiedId)\n\t{\n\t\tthis.copiedId = copiedId;\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetParentId(parentId)\n\t{\n\t\tthis.parentId = parentId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title)\n\t{\n\t\tthis.title = Text.encode(title);\n\t}\n\n\tgetSortIndex()\n\t{\n\t\treturn this.sortIndex;\n\t}\n\n\tsetSortIndex(sortIndex)\n\t{\n\t\tthis.sortIndex = sortIndex;\n\t}\n\n\tgetDisplaySortIndex()\n\t{\n\t\treturn this.displaySortIndex;\n\t}\n\n\tsetDisplaySortIndex(displaySortIndex)\n\t{\n\t\tthis.displaySortIndex = displaySortIndex;\n\t}\n\n\tgetIsComplete()\n\t{\n\t\treturn this.isComplete;\n\t}\n\n\tsetIsComplete(isComplete)\n\t{\n\t\tthis.isComplete = isComplete;\n\t}\n\n\tgetIsImportant()\n\t{\n\t\treturn this.isImportant;\n\t}\n\n\tsetIsImportant(isImportant)\n\t{\n\t\tthis.isImportant = isImportant;\n\t}\n\n\tgetIsSelected()\n\t{\n\t\treturn this.isSelected;\n\t}\n\n\tsetIsSelected(isSelected)\n\t{\n\t\tthis.isSelected = isSelected;\n\t}\n\n\tgetIsCollapse()\n\t{\n\t\treturn this.isCollapse;\n\t}\n\n\tsetIsCollapse(isCollapse)\n\t{\n\t\tthis.isCollapse = isCollapse;\n\t}\n\n\tgetCompletedCount()\n\t{\n\t\treturn this.completedCount;\n\t}\n\n\tsetCompletedCount(completedCount)\n\t{\n\t\tthis.completedCount = completedCount;\n\t}\n\n\tgetTotalCount()\n\t{\n\t\treturn this.totalCount;\n\t}\n\n\tsetTotalCount(totalCount)\n\t{\n\t\tthis.totalCount = totalCount;\n\t}\n\n\tgetMembers()\n\t{\n\t\treturn this.members;\n\t}\n\n\tsetMembers(members)\n\t{\n\t\tconst types = {\n\t\t\tA: 'accomplice',\n\t\t\tU: 'auditor',\n\t\t};\n\n\t\tthis.members.clear();\n\n\t\tObject.keys(members).forEach((id) => {\n\t\t\tconst {NAME, TYPE} = members[id];\n\t\t\tthis.members.set(id, {id, nameFormatted: Text.encode(NAME), type: types[TYPE]});\n\t\t});\n\t}\n\n\taddMember(member)\n\t{\n\t\tthis.members.set(member.id, member);\n\t}\n\n\tremoveMember(id)\n\t{\n\t\tthis.members.delete(id);\n\t}\n\n\tgetAttachments()\n\t{\n\t\treturn this.attachments;\n\t}\n\n\tsetAttachments(attachments)\n\t{\n\t\tthis.attachments = attachments;\n\t}\n\n\taddAttachments(attachments)\n\t{\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\tthis.attachments[id] = attachments[id];\n\t\t});\n\t}\n\n\tremoveAttachment(id)\n\t{\n\t\tdelete this.attachments[id];\n\t}\n}\n\nexport {CheckListItemFields};","import './css/check-list-item.css';\n\nimport {Dom, Loc, Runtime, Tag, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {CompositeTreeItem} from './composite-tree-item';\nimport {CheckListItemFields} from './check-list-item-fields';\n\nclass CheckListItem extends CompositeTreeItem\n{\n\tclass = CheckListItem;\n\n\tcheckedClass = 'tasks-checklist-item-solved';\n\thiddenClass = 'tasks-checklist-item-hidden';\n\tcollapseClass = 'tasks-checklist-collapse';\n\twrapperClass = 'tasks-checklist-items-wrapper';\n\n\tshowClass = 'tasks-checklist-item-show';\n\thideClass = 'tasks-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.tasks-checklist-item-important',\n\t\t\t'.tasks-checklist-item-dragndrop',\n\t\t\t'.tasks-checklist-item-group-checkbox',\n\t\t\t'.tasks-checklist-item-remove',\n\t\t\t'.tasks-checklist-item-flag-block',\n\t\t],\n\t};\n\n\tstatic makeDangerElement(element)\n\t{\n\t\tconst dangerClass = 'ui-ctl-danger';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tstatic updateParents(oldParent, newParent)\n\t{\n\t\tif (oldParent !== newParent)\n\t\t{\n\t\t\toldParent.updateCounts();\n\t\t\tnewParent.updateCounts();\n\n\t\t\toldParent.updateProgress();\n\t\t\tnewParent.updateProgress();\n\n\t\t\toldParent.updateIndexes();\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t}\n\n\tstatic getProgressText(completed, total)\n\t{\n\t\tconst replaces = {\n\t\t\t'#total#': total,\n\t\t\t'#completed#': completed,\n\t\t};\n\t\tlet progressText = Loc.getMessage('TASKS_CHECKLIST_PROGRESS_BAR_PROGRESS_TEXT');\n\n\t\tObject.keys(replaces).forEach((search) => {\n\t\t\tprogressText = progressText.replace(search, replaces[search]);\n\t\t});\n\n\t\treturn progressText;\n\t}\n\n\tstatic getFileExtension(ext)\n\t{\n\t\tlet fileExtension;\n\n\t\tswitch (ext)\n\t\t{\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'swf':\n\t\t\tcase 'wmv':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'txt':\n\t\t\t\tfileExtension = 'txt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'doc':\n\t\t\tcase 'docx':\n\t\t\t\tfileExtension = 'doc';\n\t\t\t\tbreak;\n\n\t\t\tcase 'xls':\n\t\t\tcase 'xlsx':\n\t\t\t\tfileExtension = 'xls';\n\t\t\t\tbreak;\n\n\t\t\tcase 'php':\n\t\t\t\tfileExtension = 'php';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pdf':\n\t\t\t\tfileExtension = 'pdf';\n\t\t\t\tbreak;\n\n\t\t\tcase 'ppt':\n\t\t\tcase 'pptx':\n\t\t\t\tfileExtension = 'ppt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rar':\n\t\t\t\tfileExtension = 'rar';\n\t\t\t\tbreak;\n\n\t\t\tcase 'zip':\n\t\t\t\tfileExtension = 'zip';\n\t\t\t\tbreak;\n\n\t\t\tcase 'set':\n\t\t\t\tfileExtension = 'set';\n\t\t\t\tbreak;\n\n\t\t\tcase 'mov':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'img':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\t\tfileExtension = 'img';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tfileExtension = 'empty';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn fileExtension;\n\t}\n\n\tstatic getInputSelection(input)\n\t{\n\t\tlet start = 0;\n\t\tlet end = 0;\n\t\tlet normalizedValue;\n\t\tlet range;\n\t\tlet textInputRange;\n\t\tlet len;\n\t\tlet endRange;\n\n\t\tif (typeof input.selectionStart === 'number' && typeof input.selectionEnd === 'number')\n\t\t{\n\t\t\tstart = input.selectionStart;\n\t\t\tend = input.selectionEnd;\n\t\t}\n\t\telse\n\t\t{\n\t\t\trange = document.selection.createRange();\n\n\t\t\tif (range && range.parentElement() === input)\n\t\t\t{\n\t\t\t\tlen = input.value.length;\n\t\t\t\tnormalizedValue = input.value.replace(/\\r\\n/g, '\\n');\n\n\t\t\t\t// Create a working TextRange that lives only in the input\n\t\t\t\ttextInputRange = input.createTextRange();\n\t\t\t\ttextInputRange.moveToBookmark(range.getBookmark());\n\n\t\t\t\t// Check if the start and end of the selection are at the very end\n\t\t\t\t// of the input, since moveStart/moveEnd doesn't return what we want\n\t\t\t\t// in those cases\n\t\t\t\tendRange = input.createTextRange();\n\t\t\t\tendRange.collapse(false);\n\n\t\t\t\tif (textInputRange.compareEndPoints('StartToEnd', endRange) > -1)\n\t\t\t\t{\n\t\t\t\t\tstart = len;\n\t\t\t\t\tend = len;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstart = -textInputRange.moveStart('character', -len);\n\t\t\t\t\tstart += normalizedValue.slice(0, start).split('\\n').length - 1;\n\n\t\t\t\t\tif (textInputRange.compareEndPoints('EndToEnd', endRange) > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tend = len;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tend = -textInputRange.moveEnd('character', -len);\n\t\t\t\t\t\tend += normalizedValue.slice(0, end).split('\\n').length - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {start, end};\n\t}\n\n\tstatic getDefaultCheckListTitle(title)\n\t{\n\t\tlet defaultTitle = title;\n\n\t\tif (title.indexOf('BX_CHECKLIST') === 0)\n\t\t{\n\t\t\tif (title === 'BX_CHECKLIST')\n\t\t\t{\n\t\t\t\tdefaultTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_2');\n\t\t\t}\n\t\t\telse if (title.match(/BX_CHECKLIST_\\d+$/))\n\t\t\t{\n\t\t\t\tconst itemNumber = title.replace('BX_CHECKLIST_', '');\n\t\t\t\tdefaultTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_WITH_NUMBER').replace('#ITEM_NUMBER#', itemNumber);\n\t\t\t}\n\t\t}\n\n\t\treturn defaultTitle;\n\t}\n\n\tstatic smoothScroll(node)\n\t{\n\t\tconst posFrom = BX.GetWindowScrollPos().scrollTop;\n\t\tconst posTo = BX.pos(node).top - Math.round(BX.GetWindowInnerSize().innerHeight / 2);\n\t\tconst toBottom = posFrom < posTo;\n\t\tconst distance = Math.abs(posTo - posFrom);\n\t\tconst speed = (Math.round(distance / 100) > 20 ? 20 : Math.round(distance / 100));\n\t\tconst step = speed / 2;\n\n\t\tif (step <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet posCurrent = (toBottom ? posFrom + step : posFrom - step);\n\t\tlet timer = 0;\n\n\t\tif (toBottom)\n\t\t{\n\t\t\tfor (let i = posFrom; i < posTo; i += step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent += step;\n\t\t\t\tif (posCurrent > posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor (let i = posFrom; i > posTo; i -= step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent -= step;\n\t\t\t\tif (posCurrent < posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getMemberLinkLayout(type, name, url)\n\t{\n\t\tconst messageId = `TASKS_CHECKLIST_${type.toUpperCase()}_ICON_HINT`;\n\t\treturn `\n\t\t\t<span class=\"tasks-checklist-item-auditor\">\n\t\t\t\t<a class=\"tasks-checklist-item-${type}-icon\" title=\"${Loc.getMessage(messageId)}\"></a>\n\t\t\t\t<a href=\"${url}\" class=\"tasks-checklist-item-${type}-link\">${name}</a>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tstatic getLinkLayout(url)\n\t{\n\t\treturn `<a class=\"tasks-checklist-item-link\" href=\"${url}\" target=\"_blank\">${url}</a>`;\n\t}\n\n\tstatic get keyCodes()\n\t{\n\t\treturn {\n\t\t\tesc: 27,\n\t\t\tenter: 13,\n\t\t\tplus: 43,\n\t\t\tatsign: 64,\n\t\t\ttab: 9,\n\t\t\tup: 38,\n\t\t\tdown: 40,\n\t\t};\n\t}\n\n\tconstructor(fields = {})\n\t{\n\t\tconst {action} = fields;\n\n\t\tsuper();\n\t\tthis.fields = new CheckListItemFields(fields);\n\t\tthis.action = {\n\t\t\tcanUpdate: (action && 'MODIFY' in action) ? action.MODIFY : true,\n\t\t\tcanRemove: (action && 'REMOVE' in action) ? action.REMOVE : true,\n\t\t\tcanToggle: (action && 'TOGGLE' in action) ? action.TOGGLE : true,\n\t\t\tcanDrag: (action && 'DRAG' in action) ? action.DRAG : true,\n\t\t};\n\n\t\tthis.input = null;\n\t\tthis.panel = null;\n\t\tthis.progress = null;\n\t\tthis.filesLoaderPopup = null;\n\t\tthis.filesLoaderProgressBars = new Map();\n\t\tthis.updateMode = false;\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\tsuper.add(item, position);\n\n\t\titem.optionManager = this.optionManager;\n\t\titem.clickEventHandler = this.clickEventHandler;\n\t}\n\n\tisTaskRoot()\n\t{\n\t\treturn this.getNodeId() === 0 && this.getParent() === null;\n\t}\n\n\tisCheckList()\n\t{\n\t\treturn !this.isTaskRoot() && this.getParent().isTaskRoot();\n\t}\n\n\tgetCheckList()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (!parent.getParent().isTaskRoot())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tfindById(id)\n\t{\n\t\tif (!id)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.fields.getId() && this.fields.getId().toString() === id.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findById(id);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountCompletedCount(recursively = false)\n\t{\n\t\tlet completedCount = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsComplete())\n\t\t\t{\n\t\t\t\tcompletedCount += 1;\n\t\t\t}\n\n\t\t\tif (recursively)\n\t\t\t{\n\t\t\t\tcompletedCount += descendant.countCompletedCount(recursively);\n\t\t\t}\n\t\t});\n\n\t\treturn completedCount;\n\t}\n\n\tcountTotalCount(recursively = false)\n\t{\n\t\tlet totalCount = 0;\n\n\t\tif (!recursively)\n\t\t{\n\t\t\ttotalCount = this.getDescendantsCount();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\ttotalCount += 1;\n\t\t\t\ttotalCount += descendant.countTotalCount(recursively);\n\t\t\t});\n\t\t}\n\n\t\treturn totalCount;\n\t}\n\n\tupdateCompletedCount()\n\t{\n\t\tconst completedCount = this.countCompletedCount();\n\t\tthis.fields.setCompletedCount(completedCount);\n\t}\n\n\tupdateTotalCount()\n\t{\n\t\tconst totalCount = this.countTotalCount();\n\t\tthis.fields.setTotalCount(totalCount);\n\t}\n\n\tupdateCounts()\n\t{\n\t\tthis.updateCompletedCount();\n\t\tthis.updateTotalCount();\n\t}\n\n\tupdateProgress()\n\t{\n\t\tif (this.progress === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst total = this.fields.getTotalCount();\n\t\tconst completed = this.fields.getCompletedCount();\n\n\t\tthis.progress.setMaxValue(total);\n\t\tthis.progress.update(completed);\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tthis.updateProgressText(completed, total);\n\t\t}\n\t}\n\n\tupdateProgressText(completed, total)\n\t{\n\t\tconst progressText = CheckListItem.getProgressText(completed, total);\n\t\tthis.progress.setTextAfter(progressText);\n\t}\n\n\tsetDefaultStyles(layout, action = 'add')\n\t{\n\t\tif (action === 'add')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = 0;\n\t\t\tlayout.style.opacity = 0;\n\n\t\t\tDom.addClass(layout, this.showClass);\n\t\t}\n\t\telse if (action === 'delete')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = `${layout.scrollHeight}px`;\n\t\t\tlayout.style.opacity = 1;\n\n\t\t\tDom.addClass(layout, this.hideClass);\n\t\t}\n\t}\n\n\tdelete()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tparent.remove(this);\n\t\tparent.updateCounts();\n\t\tparent.updateProgress();\n\n\t\tthis.setDefaultStyles(this.container, 'delete');\n\n\t\tsetTimeout(() => {\n\t\t\tthis.container.style.height = 0;\n\t\t\tthis.container.style.opacity = 0;\n\t\t\tthis.container.style.paddingTop = 0;\n\t\t}, 1);\n\n\t\tsetTimeout(() => {\n\t\t\tDom.remove(this.container);\n\t\t}, 250);\n\t}\n\n\trestore()\n\t{\n\t\tconst parent = this.getParent();\n\t\tconst position = this.fields.getSortIndex();\n\n\t\tif (position === 0)\n\t\t{\n\t\t\tif (parent.getDescendantsCount() > 0)\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this, parent.getFirstDescendant(), 'before');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparent.addCheckListItem(this, parent.getDescendants()[position - 1]);\n\t\t}\n\t}\n\n\tdeleteAction(showBalloon = true)\n\t{\n\t\tconst title = this.fields.getTitle();\n\n\t\tthis.delete();\n\n\t\tif (showBalloon && title.length > 0 && title !== '')\n\t\t{\n\t\t\tconst action = 'DELETE';\n\t\t\tconst data = {\n\t\t\t\ttype: this.isCheckList() ? 'CHECKLIST' : 'ITEM',\n\t\t\t};\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'delete'});\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tonDeleteClick(e)\n\t{\n\t\te.preventDefault();\n\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tconst items = this.getSelectedItems();\n\t\t\tconst action = 'DELETE_SELECTED';\n\t\t\tconst data = {items};\n\n\t\t\tthis.runForEachSelectedItem((item) => {\n\t\t\t\titem.fields.setIsSelected(false);\n\t\t\t\titem.deleteAction(false);\n\t\t\t});\n\n\t\t\titems.forEach((item) => {\n\t\t\t\titem.getParent().updateIndexes();\n\t\t\t\titem.handleCheckListChanges();\n\t\t\t});\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteAction();\n\t\tthis.getParent().updateIndexes();\n\n\t\tthis.handleCheckListChanges();\n\t}\n\n\tgetNotificationBalloon(action, data)\n\t{\n\t\tconst actions = [];\n\t\tlet content = '';\n\n\t\tswitch (action)\n\t\t{\n\t\t\tcase 'DELETE':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_${data.type}`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tthis.restore();\n\t\t\t\t\t\t\tthis.handleCheckListChanges();\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'DELETE_SELECTED':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_ITEMS`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tdata.items.forEach((item) => {\n\t\t\t\t\t\t\t\titem.restore();\n\t\t\t\t\t\t\t\titem.handleCheckListChanges();\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'AUDITOR_ADDED':\n\t\t\tcase 'ACCOMPLICE_ADDED':\n\t\t\t{\n\t\t\t\tlet image = '';\n\t\t\t\tif (data.avatar)\n\t\t\t\t{\n\t\t\t\t\timage = Tag.render`\n\t\t\t\t\t\t<img class=\"tasks-checklist-notification-balloon-avatar-img\" src=\"${data.avatar}\" alt=\"\"/>\n\t\t\t\t\t`;\n\t\t\t\t}\n\t\t\t\tcontent = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-message-container\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-avatar\">\n\t\t\t\t\t\t\t${image}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"tasks-checklist-notification-balloon-message\">\n\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}`)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tBX.loadExt('ui.notification').then(() => {\n\t\t\tBX.UI.Notification.Center.notify({content, actions});\n\t\t});\n\t}\n\n\tonToAnotherCheckListClick(e)\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (rootNode.getDescendantsCount() === 1)\n\t\t{\n\t\t\tthis.moveToNewCheckList(2);\n\t\t\treturn;\n\t\t}\n\n\t\tnew BX.PopupMenuWindow(\n\t\t\t'to-another-checklist',\n\t\t\te.target,\n\t\t\tthis.getToAnotherCheckListPopupItems(),\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 3,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose() {\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t).show();\n\t}\n\n\tgetToAnotherCheckListPopupItems()\n\t{\n\t\tconst selectMode = this.checkSelectedItems();\n\t\tconst popupMenuItems = [];\n\t\tconst toNewCheckListMenuItem = {\n\t\t\ttext: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tonclick: (event, item) => {\n\t\t\t\titem.getMenuWindow().close();\n\t\t\t\tthis.moveToNewCheckList(this.getRootNode().getDescendantsCount() + 1);\n\t\t\t},\n\t\t};\n\n\t\tif (selectMode)\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tpopupMenuItems.push({\n\t\t\t\t\ttext: descendant.fields.getTitle(),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\titem.getMenuWindow().close();\n\n\t\t\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\t\t\tselectedItem.makeChildOf(descendant);\n\t\t\t\t\t\t\tdescendant.unselectAll();\n\n\t\t\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tpopupMenuItems.push({delimiter: true});\n\t\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\t\treturn popupMenuItems;\n\t\t}\n\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupMenuItems.push({\n\t\t\t\ttext: descendant.fields.getTitle(),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\tthis.makeChildOf(descendant);\n\t\t\t\t\tthis.handleUpdateEnding();\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tpopupMenuItems.push({delimiter: true});\n\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\treturn popupMenuItems;\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new CheckListItem({TITLE: title});\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tif (this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\tselectedItem.makeChildOf(newCheckList);\n\t\t\t\t\tnewCheckList.unselectAll();\n\n\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.makeChildOf(newCheckList);\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessMemberSelect(member)\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tconst title = selectedItem.fields.getTitle();\n\t\t\t\tconst space = (title.slice(-1) === ' ' ? '' : ' ');\n\t\t\t\tconst newTitle = `${title}${space}${member.nameFormatted}`.substring(0, 255);\n\n\t\t\t\tselectedItem.fields.addMember(member);\n\t\t\t\tselectedItem.updateTitle(Text.decode(newTitle));\n\t\t\t\tselectedItem.updateTitleNode();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputText = this.input.value;\n\t\tconst mentioned = +this.mentioned;\n\t\tconst start = this.inputCursorPosition.start || 0;\n\t\tconst startSpace = (start === 0 || start - mentioned === 0 || inputText.charAt(start - mentioned - 1) === ' ') ? '' : ' ';\n\t\tconst endSpace = (inputText.charAt(start) === ' ' ? '' : ' ');\n\n\t\tthis.fields.addMember(member);\n\n\t\tconst newInputText = `${inputText.slice(0, start - mentioned)}${startSpace}${Text.decode(member.nameFormatted)}${endSpace}`;\n\n\t\tthis.inputCursorPosition.start = newInputText.length;\n\t\tthis.inputCursorPosition.end = newInputText.length;\n\n\t\tthis.input.value = `${newInputText}${inputText.slice(start)}`;\n\t\tthis.mentioned = false;\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tonSocNetSelectorAuditorSelected(auditor)\n\t{\n\t\tconst type = 'auditor';\n\t\tconst userData = this.prepareUserData(auditor);\n\t\tconst resultAuditor = {...userData, type};\n\n\t\tconst notificationAction = `${type.toUpperCase()}_ADDED`;\n\t\tconst notificationData = {avatar: auditor.avatar};\n\n\t\tthis.processMemberSelect(resultAuditor);\n\t\tthis.getNotificationBalloon(notificationAction, notificationData);\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:auditorAdded', userData);\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'addAuditor'});\n\t}\n\n\tonSocNetSelectorAccompliceSelected(accomplice)\n\t{\n\t\tconst type = 'accomplice';\n\t\tconst userData = this.prepareUserData(accomplice);\n\t\tconst resultAccomplice = {...userData, type};\n\n\t\tconst notificationAction = `${type.toUpperCase()}_ADDED`;\n\t\tconst notificationData = {avatar: accomplice.avatar};\n\n\t\tthis.processMemberSelect(resultAccomplice);\n\t\tthis.getNotificationBalloon(notificationAction, notificationData);\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:accompliceAdded', userData);\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'addAccomplice'});\n\t}\n\n\tprepareUserData(user)\n\t{\n\t\tconst customData = user.getCustomData();\n\t\tconst entityType = user.getEntityType();\n\n\t\treturn {\n\t\t\tavatar: user.avatar,\n\t\t\tdescription: '',\n\t\t\tentityType: 'U',\n\t\t\tid: user.getId(),\n\t\t\tname: customData.get('name'),\n\t\t\tlastName: customData.get('lastName'),\n\t\t\temail: customData.get('email'),\n\t\t\tnameFormatted: Text.encode(user.getTitle()),\n\t\t\tnetworkId: '',\n\t\t\ttype: {\n\t\t\t\tcrmemail: false,\n\t\t\t\textranet: (entityType === 'extranet'),\n\t\t\t\temail: (entityType === 'email'),\n\t\t\t\tnetwork: (entityType === 'network'),\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMemberSelector(e, memberType = 'auditor', mentioned = false)\n\t{\n\t\tif (!this.checkCanAddAccomplice())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst typeFunctionMap = {\n\t\t\tauditor: this.onSocNetSelectorAuditorSelected.bind(this),\n\t\t\taccomplice: this.onSocNetSelectorAccompliceSelected.bind(this),\n\t\t};\n\t\tconst typeFunction = typeFunctionMap[memberType] || typeFunctionMap.auditor;\n\n\t\tthis.isSelectorLoading = true;\n\n\t\tRuntime.loadExtension('ui.entity-selector').then(exports => {\n\t\t\tconst {Dialog} = exports;\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: e.target,\n\t\t\t\tenableSearch: true,\n\t\t\t\tmultiple: false,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\temailUsers: true,\n\t\t\t\t\t\t\tnetworkUsers: true,\n\t\t\t\t\t\t\textranetUsers: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\t'onLoad': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.isSelectorLoading = false;\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.isSelectorLoading = false;\n\t\t\t\t\t\tthis.mentioned = mentioned;\n\t\t\t\t\t\tthis.retrieveFocus();\n\n\t\t\t\t\t\tconst {item: selectedItem} = event.getData();\n\t\t\t\t\t\ttypeFunction(selectedItem);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\tonAddAuditorClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'auditor');\n\t}\n\n\tonAddAccompliceClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'accomplice');\n\t}\n\n\tonUploadAttachmentClick(e)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst {prefix, diskUrls} = this.optionManager;\n\t\tconst {urlSelect, urlRenameFile, urlDeleteFile, urlUpload} = diskUrls;\n\n\t\tif (this.filesLoaderPopup === null)\n\t\t{\n\t\t\tthis.filesLoaderPopup = new BX.PopupWindow({\n\t\t\t\tcontent: this.getAttachmentsLoaderLayout(),\n\t\t\t\tbindElement: e.target,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 2,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: true,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filesLoaderPopup.setBindElement(e.target);\n\t\t}\n\n\t\tthis.filesLoaderPopup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: nodeId,\n\t\t\tcontrolName: `${prefix}[${nodeId}][UF_CHECKLIST_FILES][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect,\n\t\t\turlRenameFile,\n\t\t\turlDeleteFile,\n\t\t\turlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.filesLoaderPopup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show'],\n\t\t);\n\t}\n\n\tonDeleteAttachmentClick(fileId)\n\t{\n\t\tthis.fields.removeAttachment(fileId);\n\t\tDom.remove(this.getAttachmentsContainer().querySelector(`#disk-attach-${fileId}`));\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'deleteAttachment'});\n\t}\n\n\tgetPanelBodyLayout()\n\t{\n\t\tconst membersLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-auditor\" onclick=\"${this.onAddAuditorClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_AUDITOR'}`}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-accomplice\" onclick=\"${this.onAddAccompliceClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_ACCOMPLICE'}`}</span>\n\t\t\t</div>\n\t\t`;\n\t\tconst attachmentButtonLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-attachment\" onclick=\"${this.onUploadAttachmentClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tconst itemsActionButtonsLayout = Tag.render`\n\t\t\t${this.checkSelectedItems() ? '' : attachmentButtonLayout}\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabin\" onclick=\"${this.onTabInClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabout\" onclick=\"${this.onTabOutClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-important\n\t\t\t\t${this.fields.getIsImportant() ? ' tasks-checklist-item-editor-panel-btn-important-selected' : ''}\" onclick=\"${this.onImportantClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage('TASKS_CHECKLIST_PANEL_IMPORTANT')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-checklist\" onclick=\"${this.onToAnotherCheckListClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage('TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-remove\" onclick=\"${this.onDeleteClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tconst separator = Tag.render`<div class=\"tasks-checklist-item-editor-panel-separator\"></div>`;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel ${this.isTaskRoot() || this.isCheckList() ? 'tasks-checklist-item-editor-group-panel' : ''}\">\n\t\t\t\t${this.checkCanAddAccomplice() ? membersLayout : ''}\n\t\t\t\t${this.checkCanAddAccomplice() && !this.isCheckList() ? separator : ''}\n\t\t\t\t${!this.isCheckList() ? itemsActionButtonsLayout : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateTitle(text)\n\t{\n\t\tthis.fields.setTitle(text);\n\t}\n\n\tupdateTitleNode()\n\t{\n\t\tDom.replace(this.getTitleNodeContainer(), this.getTitleLayout());\n\t}\n\n\tgetTitleLayout()\n\t{\n\t\tconst {userPath} = this.optionManager;\n\t\tconst escapeRegExp = (string) => string.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n\t\tlet title = this.fields.getTitle();\n\n\t\ttitle = (this.isCheckList() ? CheckListItem.getDefaultCheckListTitle(title) : title);\n\n\t\tthis.fields.getMembers().forEach(({id, nameFormatted, type}) => {\n\t\t\tconst regExp = new RegExp(escapeRegExp(nameFormatted), 'g');\n\t\t\tconst url = userPath.replace('#user_id#', id).replace('#USER_ID#', id);\n\t\t\ttitle = title.replace(regExp, CheckListItem.getMemberLinkLayout(type, nameFormatted, url));\n\t\t});\n\n\t\ttitle = title.replace(/(https?:\\/\\/[^\\s]+)/g, url => CheckListItem.getLinkLayout(url));\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${this.getTitleNodeClass()}\">\n\t\t\t\t${title}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tprocessMembersFromText()\n\t{\n\t\tconst membersToDelete = [];\n\n\t\tthis.fields.getMembers().forEach(({id, nameFormatted}) => {\n\t\t\tif (this.fields.getTitle().indexOf(nameFormatted) === -1)\n\t\t\t{\n\t\t\t\tmembersToDelete.push(id);\n\t\t\t}\n\t\t});\n\n\t\tmembersToDelete.forEach((id) => {\n\t\t\tthis.fields.removeMember(id);\n\t\t});\n\t}\n\n\tupdateIndexes()\n\t{\n\t\tthis.updateSortIndexes();\n\t\tthis.updateDisplaySortIndexes();\n\t}\n\n\tupdateSortIndexes()\n\t{\n\t\tlet sortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.fields.setSortIndex(sortIndex);\n\t\t\tsortIndex += 1;\n\t\t});\n\t}\n\n\tupdateDisplaySortIndexes()\n\t{\n\t\tconst parentSortIndex = (this.isCheckList() || this.isTaskRoot() ? '' : `${this.fields.getDisplaySortIndex()}.`);\n\t\tlet localSortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tlocalSortIndex += 1;\n\t\t\tconst newSortIndex = `${parentSortIndex}${localSortIndex}`;\n\n\t\t\tdescendant.fields.setDisplaySortIndex(newSortIndex);\n\n\t\t\tif (!descendant.isCheckList())\n\t\t\t{\n\t\t\t\tdescendant.container.querySelector('.tasks-checklist-item-number').innerText = newSortIndex;\n\t\t\t}\n\n\t\t\tdescendant.updateDisplaySortIndexes();\n\t\t});\n\t}\n\n\thandleTaskOptions()\n\t{\n\t\tconst {userId, showCompleted, showOnlyMine} = this.optionManager;\n\n\t\tthis.getRootNode().hideByCondition((item) => {\n\t\t\tconst isComplete = item.fields.getIsComplete();\n\t\t\tconst hasUserInMembers = item.fields.getMembers().has(userId.toString());\n\t\t\tlet condition;\n\n\t\t\tif (!showCompleted && showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = isComplete || !hasUserInMembers;\n\t\t\t}\n\t\t\telse if (!showCompleted)\n\t\t\t{\n\t\t\t\tcondition = isComplete;\n\t\t\t}\n\t\t\telse if (showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = !hasUserInMembers;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcondition = false;\n\t\t\t}\n\n\t\t\treturn condition;\n\t\t});\n\t}\n\n\thideByCondition(condition)\n\t{\n\t\tif (this.checkCanHide(condition))\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tdescendant.hideByCondition(condition);\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckCanHide(condition)\n\t{\n\t\tif (\n\t\t\tthis.isTaskRoot()\n\t\t\t|| this.updateMode\n\t\t\t|| Dom.hasClass(this.container, this.showClass)\n\t\t\t|| !condition(this)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet canHide = true;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (!condition(descendant))\n\t\t\t{\n\t\t\t\tcanHide = false;\n\t\t\t}\n\t\t\telse if (canHide)\n\t\t\t{\n\t\t\t\tcanHide = descendant.checkCanHide(condition);\n\t\t\t}\n\t\t});\n\n\t\treturn canHide;\n\t}\n\n\thide()\n\t{\n\t\tDom.hide(this.container);\n\t}\n\n\tshow()\n\t{\n\t\tDom.show(this.container);\n\t}\n\n\tcheckIsComplete()\n\t{\n\t\tlet isComplete;\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\tisComplete = false;\n\t\t}\n\t\telse if (this.isCheckList())\n\t\t{\n\t\t\tconst completedCount = this.countCompletedCount(true);\n\t\t\tconst totalCount = this.countTotalCount(true);\n\n\t\t\tisComplete = (completedCount === totalCount && totalCount > 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tisComplete = this.fields.getIsComplete();\n\t\t}\n\n\t\treturn isComplete;\n\t}\n\n\tcheckActiveUpdateExist()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tlet found = false;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === false)\n\t\t\t{\n\t\t\t\tfound = descendant.checkActiveUpdateExist();\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tdisableAllGroup()\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsSelected())\n\t\t\t{\n\t\t\t\tdescendant.toggleGroup();\n\t\t\t}\n\t\t});\n\t}\n\n\tdisableAllUpdateModes()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tthis.handleUpdateEnding();\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.disableAllUpdateModes();\n\t\t});\n\t}\n\n\trememberInputState()\n\t{\n\t\tthis.input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\t}\n\n\tclearInput(e)\n\t{\n\t\te.preventDefault();\n\n\t\tthis.container.querySelector(`#text_${this.getNodeId()}`).value = '';\n\t\tthis.retrieveFocus();\n\t}\n\n\tretrieveFocus()\n\t{\n\t\tif (this.input !== null && this.inputCursorPosition)\n\t\t{\n\t\t\tconst {start, end} = this.inputCursorPosition;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.setSelectionRange(start, end);\n\t\t\t}, 10);\n\t\t}\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-header-name tasks-checklist-header-name-edit-mode\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-after-icon ui-ctl-xs ui-ctl-no-padding ui-ctl-underline \n\t\t\t\t\t\t\t\ttasks-checklist-header-name-editor\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t\t   onkeydown=\"${this.onInputKeyDown.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.UI.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-inner tasks-checklist-item-new ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\">\n\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\">\n\t\t\t\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"/>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-after-icon ui-ctl-w100\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t\t   onkeydown=\"${this.onInputKeyDown.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\tconst node = nodeToPosition || item.getContainer();\n\t\tconst position = Dom.getPosition(node);\n\n\t\tif (!this.panel)\n\t\t{\n\t\t\tthis.panel = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-editor-panel-container\">\n\t\t\t\t\t${item.getPanelBodyLayout()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\n\t\t\tDom.append(this.panel, document.body);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.replace(this.panel.querySelector('.tasks-checklist-item-editor-panel'), item.getPanelBodyLayout());\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\t\t}\n\n\t\tif (!Dom.isShown(this.panel))\n\t\t{\n\t\t\tDom.show(this.panel);\n\t\t}\n\n\t\tif (\n\t\t\t(Dom.isShown(this.panel) && item.isCheckList() && !item.checkCanAddAccomplice())\n\t\t\t|| (position.left === 0 && position.right === 0 && position.width === 0)\n\t\t)\n\t\t{\n\t\t\tDom.hide(this.panel);\n\t\t}\n\t}\n\n\tenableUpdateMode()\n\t{\n\t\tconst viewModeLayout = this.getInnerContainer();\n\t\tconst updateModeLayout = this.getUpdateModeLayout();\n\n\t\tDom.addClass(viewModeLayout, this.hiddenClass);\n\t\tDom.insertBefore(updateModeLayout, viewModeLayout);\n\n\t\tthis.input = updateModeLayout.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.input.focus();\n\t\tthis.input.setSelectionRange(this.input.value.length, this.input.value.length);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\n\t\tif (this.input.value === '' || this.input.value.length === 0)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (Dom.isShown(this.input))\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}, 250);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t}\n\n\t\tthis.updateMode = true;\n\t}\n\n\tdisableUpdateMode()\n\t{\n\t\tconst currentInner = this.getInnerContainer();\n\t\tconst text = currentInner.querySelector(`#text_${this.getNodeId()}`).value.trim().substring(0, 255);\n\n\t\tthis.updateTitle(text);\n\t\tthis.processMembersFromText();\n\t\tthis.updateTitleNode();\n\n\t\tDom.removeClass(currentInner.nextElementSibling, this.hiddenClass);\n\t\tDom.remove(currentInner);\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tcheckCanDeleteOnUpdateEnding()\n\t{\n\t\treturn this.getDescendantsCount() === 0\n\t\t\t&& Object.keys(this.fields.getAttachments()).length === 0\n\t\t\t&& this.filesLoaderProgressBars.size === 0;\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tCheckListItem.makeDangerElement(input.parentElement);\n\t\t\t\tif (this.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\t\t}\n\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\ttoggleUpdateMode(e)\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tif (e.keyCode === CheckListItem.keyCodes.enter || e.keyCode === CheckListItem.keyCodes.tab)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding(!this.isCheckList());\n\t\t\t}\n\t\t\telse if (e.keyCode === CheckListItem.keyCodes.esc)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst rootNode = this.getRootNode();\n\n\t\t\trootNode.disableAllUpdateModes();\n\t\t\trootNode.disableAllGroup();\n\n\t\t\tif (!rootNode.checkActiveUpdateExist())\n\t\t\t{\n\t\t\t\tthis.enableUpdateMode();\n\t\t\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'toggleUpdateMode'});\n\t\t\t}\n\t\t}\n\t}\n\n\tonInputKeyPressed(e)\n\t{\n\t\tif (this.isSelectorLoading)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.keyCode === CheckListItem.keyCodes.enter)\n\t\t{\n\t\t\tthis.toggleUpdateMode(e);\n\t\t\te.preventDefault();\n\t\t}\n\t\telse if (\n\t\t\te.keyCode === CheckListItem.keyCodes.plus\n\t\t\t|| (e.shiftKey && e.keyCode === CheckListItem.keyCodes.atsign)\n\t\t)\n\t\t{\n\t\t\tthis.getMemberSelector(e, this.optionManager.defaultMemberSelectorType, true);\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'inputKeyPressed'});\n\t}\n\n\tonInputKeyDown(e)\n\t{\n\t\tif (this.isSelectorLoading)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (e.keyCode)\n\t\t{\n\t\t\tdefault:\n\t\t\t\t// do nothing\n\t\t\t\tbreak;\n\n\t\t\tcase CheckListItem.keyCodes.esc:\n\t\t\t{\n\t\t\t\tsetTimeout(() => this.toggleUpdateMode(e));\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.tab:\n\t\t\t{\n\t\t\t\tif (!this.isCheckList())\n\t\t\t\t{\n\t\t\t\t\t(e.shiftKey ? this.tabOut.bind(this) : this.tabIn.bind(this))();\n\t\t\t\t}\n\t\t\t\tthis.retrieveFocus();\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.up:\n\t\t\t{\n\t\t\t\tconst leftSiblingThrough = this.getLeftSiblingThrough();\n\t\t\t\tif (leftSiblingThrough && leftSiblingThrough !== this.getRootNode())\n\t\t\t\t{\n\t\t\t\t\tleftSiblingThrough.toggleUpdateMode(e);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.down:\n\t\t\t{\n\t\t\t\tconst rightSiblingThrough = this.getRightSiblingThrough();\n\t\t\t\tif (rightSiblingThrough)\n\t\t\t\t{\n\t\t\t\t\trightSiblingThrough.toggleUpdateMode(e);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tonHeaderMouseDown(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseDown(e);\n\t\tthis.clickEventHandler.registerClickDoneCallback(this.onHeaderClickDone.bind(this, e));\n\t}\n\n\tonHeaderMouseUp(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseUp(e);\n\t}\n\n\tonHeaderClickDone(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'header'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tonInnerContainerMouseDown(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseDown(e);\n\t\tthis.clickEventHandler.registerClickDoneCallback(this.onInnerContainerClickDone.bind(this, e));\n\t}\n\n\tonInnerContainerMouseUp(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseUp(e);\n\t}\n\n\tonInnerContainerClickDone(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'item'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getCheckList().fields.getIsSelected())\n\t\t{\n\t\t\tthis.toggleSelect(e);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tgetImportantLayout()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-important\" onclick=\"${this.onImportantClick.bind(this)}\"></div>\n\t\t`;\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.remove(this.container.querySelector('.tasks-checklist-item-important'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.insertBefore(this.getImportantLayout(), this.container.querySelector('.tasks-checklist-item-description'));\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'toggleImportant'});\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tcheckSelectedItems()\n\t{\n\t\treturn this.getRootNode().getSelectedItems().length > 0;\n\t}\n\n\trunForEachSelectedItem(callback, reverse = false)\n\t{\n\t\tlet selectedItems = this.getRootNode().getSelectedItems();\n\n\t\tif (reverse)\n\t\t{\n\t\t\tselectedItems = [...selectedItems.reverse()];\n\t\t}\n\n\t\tselectedItems.forEach((item) => {\n\t\t\tcallback(item);\n\t\t});\n\t}\n\n\tonImportantClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.toggleImportant();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleImportant();\n\n\t\tconst panelImportantButton = e.target.closest('.tasks-checklist-item-editor-panel-btn-important');\n\t\tif (panelImportantButton)\n\t\t{\n\t\t\tDom.toggleClass(panelImportantButton, 'tasks-checklist-item-editor-panel-btn-important-selected');\n\t\t}\n\t}\n\n\tonCompleteAllButtonClick()\n\t{\n\t\tif (this.fields.getIsSelected() || this.updateMode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.completeAll();\n\t\tthis.runAjaxCompleteAll();\n\t}\n\n\tcompleteAll(): void\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (\n\t\t\t\tdescendant.checkCanToggle()\n\t\t\t\t&& !descendant.updateMode\n\t\t\t\t&& !descendant.fields.getIsComplete()\n\t\t\t)\n\t\t\t{\n\t\t\t\tdescendant.toggleComplete(false);\n\t\t\t}\n\t\t\tdescendant.completeAll();\n\t\t});\n\t}\n\n\trunAjaxCompleteAll(): void\n\t{\n\t\tconst {ajaxActions, entityId, entityType, stableTreeStructure} = this.optionManager;\n\n\t\tif (!ajaxActions || !ajaxActions.COMPLETE_ALL)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runAction(ajaxActions.COMPLETE_ALL, {\n\t\t\tdata: {\n\t\t\t\t[`${entityType.toLowerCase()}Id`]: entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tresponse.data.forEach(item => {\n\t\t\t\tthis.findById(item.id).updateStableTreeStructure(item.isComplete, stableTreeStructure, stableTreeStructure);\n\t\t\t});\n\t\t});\n\t}\n\n\tonCompleteButtonClick()\n\t{\n\t\tif (\n\t\t\tthis.getCheckList().fields.getIsSelected()\n\t\t\t|| this.updateMode\n\t\t\t|| !this.checkCanToggle()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleComplete();\n\t}\n\n\ttoggleComplete(runAjax = true)\n\t{\n\t\tconst isComplete = this.fields.getIsComplete();\n\n\t\tthis.fields.setIsComplete(!isComplete);\n\t\tthis.getParent().updateCounts();\n\t\tthis.getParent().updateProgress();\n\n\t\tDom.toggleClass(this.getInnerContainer(), this.checkedClass);\n\n\t\tthis.handleCheckListChanges();\n\t\tthis.handleTaskOptions();\n\n\t\tif (runAjax)\n\t\t{\n\t\t\tthis.runAjaxToggleComplete();\n\t\t}\n\t}\n\n\trunAjaxToggleComplete()\n\t{\n\t\tconst id = this.fields.getId();\n\n\t\tif (!id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {};\n\t\tconst {ajaxActions, entityId, entityType, stableTreeStructure} = this.optionManager;\n\t\tconst actionName = (this.fields.getIsComplete() ? ajaxActions.COMPLETE : ajaxActions.RENEW);\n\n\t\tdata[`${entityType.toLowerCase()}Id`] = entityId;\n\t\tdata.checkListItemId = id;\n\n\t\tBX.ajax.runAction(actionName, {data}).then((response) => {\n\t\t\tconst {isComplete} = response.data.checkListItem;\n\t\t\tthis.updateStableTreeStructure(isComplete, stableTreeStructure, stableTreeStructure);\n\t\t});\n\t}\n\n\tupdateStableTreeStructure(isComplete, item, parent)\n\t{\n\t\tif (this.fields.getId() === item.FIELDS.id)\n\t\t{\n\t\t\titem.FIELDS.isComplete = isComplete;\n\t\t\tparent.FIELDS.completedCount += (isComplete ? 1 : -1);\n\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.updateStableTreeStructure(isComplete, descendant, item);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tunselectAll()\n\t{\n\t\tconst checkBox = this.container.querySelector(`#select_${this.getNodeId()}`);\n\n\t\tif (checkBox && checkBox.checked === true)\n\t\t{\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tcheckBox.checked = false;\n\t\t\tDom.removeClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.unselectAll();\n\t\t});\n\t}\n\n\tgetSelected()\n\t{\n\t\tlet selected = [];\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tselected.push(this);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tselected = [...selected, ...descendant.getSelected()];\n\t\t});\n\n\t\treturn selected;\n\t}\n\n\tgetSelectedItems()\n\t{\n\t\treturn this.getSelected().filter(item => !item.isCheckList() && !item.isTaskRoot());\n\t}\n\n\tonSelectCheckboxClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\te.target.checked = false;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleSelect();\n\t}\n\n\ttoggleSelect()\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = false;\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(rootNode.panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = true;\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\t\t}\n\n\t\tDom.toggleClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t}\n\n\tonGroupButtonClick()\n\t{\n\t\tif (!this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\tthis.toggleGroup();\n\t\t}\n\t}\n\n\ttoggleGroup()\n\t{\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.unselectAll();\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\tif (this.fields.getIsCollapse())\n\t\t\t{\n\t\t\t\tthis.toggleCollapse();\n\t\t\t}\n\t\t}\n\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-collapse');\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-expand');\n\t}\n\n\tonCollapseButtonClick()\n\t{\n\t\tif (this.collapseFreezed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleCollapse();\n\t}\n\n\ttoggleCollapse()\n\t{\n\t\tthis.collapseFreezed = true;\n\n\t\tconst wrapperList = this.container.querySelector(`.${this.wrapperClass}`);\n\t\tconst wrapperListHeight = `${Dom.getPosition(wrapperList).height}px`;\n\n\t\tif (!Dom.hasClass(this.container, this.collapseClass))\n\t\t{\n\t\t\tthis.fields.setIsCollapse(true);\n\n\t\t\twrapperList.style.overflow = 'hidden';\n\t\t\twrapperList.style.height = wrapperListHeight;\n\t\t\tsetTimeout(() => { wrapperList.style.height = 0; }, 0);\n\n\t\t\tDom.addClass(this.container, this.collapseClass);\n\n\t\t\tthis.collapseFreezed = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsCollapse(false);\n\n\t\t\twrapperList.style.height = 0;\n\t\t\twrapperList.style.height = `${wrapperList.scrollHeight}px`;\n\n\t\t\tconst setAutoHeight = () => {\n\t\t\t\twrapperList.style.height = 'auto';\n\t\t\t\tBX.unbind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\t\tthis.collapseFreezed = false;\n\t\t\t};\n\t\t\tBX.bind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\tDom.removeClass(this.container, this.collapseClass);\n\t\t}\n\t}\n\n\ttoggleEmpty()\n\t{\n\t\tDom.toggleClass(this.container, 'tasks-checklist-empty');\n\t}\n\n\thandleCheckListIsComplete()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsComplete = checkList.checkIsComplete();\n\n\t\tcheckList.fields.setIsComplete(checkListIsComplete);\n\n\t\tif (\n\t\t\tcheckListIsComplete\n\t\t\t&& !Dom.hasClass(checkList.container, 'tasks-checklist-collapse')\n\t\t\t&& this.collapseOnCompleteAll()\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleCollapse();\n\t\t}\n\t}\n\n\thandleCheckListIsEmpty()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsEmpty = checkList.getDescendantsCount() === 0;\n\n\t\tif (\n\t\t\t(checkListIsEmpty && !Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t\t|| (!checkListIsEmpty && Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleEmpty();\n\t\t}\n\t}\n\n\thandleCheckListChanges()\n\t{\n\t\tthis.handleCheckListIsComplete();\n\t\tthis.handleCheckListIsEmpty();\n\t}\n\n\tcheckSkipUpdate(e, area)\n\t{\n\t\treturn this.skipUpdateClasses[area]\n\t\t\t&& this.skipUpdateClasses[area].find(item => e.target.closest(item));\n\t}\n\n\tshowCompleteAllButton()\n\t{\n\t\treturn this.optionManager.getShowCompleteAllButton();\n\t}\n\n\tcollapseOnCompleteAll()\n\t{\n\t\treturn this.optionManager.getCollapseOnCompleteAll();\n\t}\n\n\tcheckCanAdd()\n\t{\n\t\treturn this.optionManager.getCanAdd();\n\t}\n\n\tcheckCanAddAccomplice()\n\t{\n\t\treturn this.optionManager.getCanAddAccomplice();\n\t}\n\n\tcheckCanUpdate()\n\t{\n\t\treturn this.action.canUpdate;\n\t}\n\n\tcheckCanRemove()\n\t{\n\t\treturn this.action.canRemove;\n\t}\n\n\tcheckCanToggle()\n\t{\n\t\treturn this.action.canToggle;\n\t}\n\n\tcheckCanDrag()\n\t{\n\t\treturn this.action.canDrag;\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn (this.isCheckList() ? 'tasks-checklist-header-name-text' : 'tasks-checklist-item-description-text');\n\t}\n\n\tgetTitleNodeContainer()\n\t{\n\t\treturn this.container.querySelector(`.${this.getTitleNodeClass()}`);\n\t}\n\n\tgetAttachmentsContainer()\n\t{\n\t\treturn this.container.querySelector(`#attachments_${this.getNodeId()}`);\n\t}\n\n\tgetSubItemsContainer()\n\t{\n\t\treturn this.container.querySelector(`#subItems_${this.getNodeId()}`);\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.tasks-checklist-header-name' : '.tasks-checklist-item-inner');\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this.container;\n\t}\n\n\tmove(item, position = 'bottom', action = 'move')\n\t{\n\t\tif (\n\t\t\tthis.getNodeId() === item.getNodeId()\n\t\t\t|| this.findChild(item.getNodeId()) !== null\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst oldParent = this.getParent();\n\t\tconst newParent = item.getParent();\n\n\t\toldParent.remove(this);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tnewParent.addBefore(this, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.addAfter(this, item);\n\t\t}\n\n\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tDom.insertBefore(this.container, item.container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.insertAfter(this.container, item.container);\n\t\t}\n\n\t\tthis.handleCheckListIsEmpty();\n\t\tthis.handleTaskOptions();\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action});\n\t}\n\n\tmakeChildOf(item, position = 'bottom', action = 'makeChildOf')\n\t{\n\t\tif (item.getDescendantsCount() > 0)\n\t\t{\n\t\t\tconst borderItems = {\n\t\t\t\ttop: item.getFirstDescendant(),\n\t\t\t\tbottom: item.getLastDescendant(),\n\t\t\t};\n\n\t\t\tthis.move(borderItems[position], position, action);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst oldParent = this.getParent();\n\t\t\tconst newParent = item;\n\n\t\t\toldParent.remove(this);\n\t\t\tnewParent.add(this);\n\n\t\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\t\tDom.append(this.container, newParent.getSubItemsContainer());\n\t\t\tDom.addClass(this.container, 'mobile-task-checklist-item-wrapper-animate');\n\n\t\t\tthis.handleCheckListIsEmpty();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action});\n\t\t}\n\t}\n\n\ttabIn()\n\t{\n\t\tif (!this.isFirstDescendant())\n\t\t{\n\t\t\tthis.makeChildOf(this.getLeftSibling(), 'bottom', 'tabIn');\n\t\t}\n\t}\n\n\tonTabInClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabIn();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabIn();\n\t\tthis.retrieveFocus();\n\t}\n\n\ttabOut()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tif (parent.isCheckList())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.move(parent, 'bottom', 'tabOut');\n\t}\n\n\tonTabOutClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabOut();\n\t\t\t}, true);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabOut();\n\t\tthis.retrieveFocus();\n\t}\n\n\taddCheckListItem(item = null, dependsOn = null, position = 'after')\n\t{\n\t\tconst itemGet = item instanceof this.class;\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst newCheckListItem = item || new this.class();\n\t\t\tlet newCheckListItemLayout;\n\n\t\t\tif (dependsOn instanceof this.class)\n\t\t\t{\n\t\t\t\tif (position === 'before')\n\t\t\t\t{\n\t\t\t\t\tthis.addBefore(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertBefore(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t\telse if (position === 'after')\n\t\t\t\t{\n\t\t\t\t\tthis.addAfter(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertAfter(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.add(newCheckListItem);\n\n\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\tDom.append(newCheckListItemLayout, this.getSubItemsContainer());\n\t\t\t}\n\n\t\t\tthis.updateCounts();\n\t\t\tthis.updateIndexes();\n\n\t\t\tif (!this.isTaskRoot())\n\t\t\t{\n\t\t\t\tthis.updateProgress();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tif (!itemGet)\n\t\t\t\t{\n\t\t\t\t\tnewCheckListItem.toggleUpdateMode();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.height = `${newCheckListItemLayout.scrollHeight}px`;\n\t\t\t\tnewCheckListItemLayout.style.opacity = 1;\n\t\t\t}, 1);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.overflow = '';\n\t\t\t\tnewCheckListItemLayout.style.height = '';\n\t\t\t\tnewCheckListItemLayout.style.opacity = '';\n\n\t\t\t\tDom.removeClass(newCheckListItemLayout, this.showClass);\n\n\t\t\t\tif (!this.isTaskRoot() && !itemGet && newCheckListItem.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.class.smoothScroll(newCheckListItem.getContainer());\n\t\t\t\t}\n\n\t\t\t\tresolve(newCheckListItem);\n\t\t\t}, 250);\n\t\t});\n\t}\n\n\tonAddCheckListItemClick()\n\t{\n\t\tif (this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addCheckListItem();\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tNODE_ID: this.getNodeId(),\n\t\t\tPARENT_NODE_ID: this.getParent().getNodeId(),\n\t\t\tID: this.fields.getId(),\n\t\t\tCOPIED_ID: this.fields.getCopiedId(),\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: [],\n\t\t\tATTACHMENTS: {},\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\tconst {nameFormatted, type} = value;\n\t\t\titemRequestData.MEMBERS.push({\n\t\t\t\t[key]: {\n\t\t\t\t\tTYPE: type,\n\t\t\t\t\tNAME: Text.decode(nameFormatted),\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tconst attachments = this.fields.getAttachments();\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\titemRequestData.ATTACHMENTS[id] = attachments[id];\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tgetRequestData(inputData = null)\n\t{\n\t\tconst title = this.fields.getTitle();\n\t\tlet data = inputData || [];\n\n\t\tif (!this.isTaskRoot() && title !== '' && title.length > 0)\n\t\t{\n\t\t\tdata.push(this.getItemRequestData());\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdata = descendant.getRequestData(data);\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tappendRequestLayout()\n\t{\n\t\tif (!this.isTaskRoot())\n\t\t{\n\t\t\tconst nodeId = this.getNodeId();\n\t\t\tconst attachments = this.fields.getAttachments();\n\t\t\tconst prefix = `${this.optionManager.prefix}[${nodeId}]`;\n\n\t\t\tlet membersLayout = '';\n\t\t\tlet attachmentsLayout = '';\n\n\t\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_TYPE_${key}\" name=\"${prefix}[MEMBERS][${key}][TYPE]\" value=\"${value.type}\"/>`;\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_NAME_${key}\" name=\"${prefix}[MEMBERS][${key}][NAME]\" value=\"${value.nameFormatted}\"/>`;\n\t\t\t});\n\n\t\t\tObject.keys(attachments).forEach((id) => {\n\t\t\t\tattachmentsLayout += `<input type=\"hidden\" id=\"ATTACHMENTS_${id}\" name=\"${prefix}[ATTACHMENTS][${id}]\" value=\"${attachments[id]}\"/>`;\n\t\t\t});\n\n\t\t\tconst requestLayout = Tag.render`\n\t\t\t\t<div id=\"request_${nodeId}\">\n\t\t\t\t\t<input type=\"hidden\" id=\"NODE_ID\" name=\"${prefix}[NODE_ID]\" value=\"${nodeId}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_NODE_ID\" name=\"${prefix}[PARENT_NODE_ID]\" value=\"${this.getParent().getNodeId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"ID\" name=\"${prefix}[ID]\" value=\"${this.fields.getId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"COPIED_ID\" name=\"${prefix}[COPIED_ID]\" value=\"${this.fields.getCopiedId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_ID\" name=\"${prefix}[PARENT_ID]\" value=\"${this.fields.getParentId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TITLE\" name=\"${prefix}[TITLE]\" value=\"${this.fields.getTitle()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"SORT_INDEX\" name=\"${prefix}[SORT_INDEX]\" value=\"${this.fields.getSortIndex()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_COMPLETE\" name=\"${prefix}[IS_COMPLETE]\" value=\"${this.fields.getIsComplete()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_IMPORTANT\" name=\"${prefix}[IS_IMPORTANT]\" value=\"${this.fields.getIsImportant()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"MODIFY\" name=\"${prefix}[ACTION][MODIFY]\" value=\"${this.checkCanUpdate()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"REMOVE\" name=\"${prefix}[ACTION][REMOVE]\" value=\"${this.checkCanRemove()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TOGGLE\" name=\"${prefix}[ACTION][TOGGLE]\" value=\"${this.checkCanToggle()}\"/>\n\t\t\t\t\t${membersLayout}\n\t\t\t\t\t${attachmentsLayout}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.remove(this.container.querySelector(`#request_${nodeId}`));\n\t\t\tDom.append(requestLayout, this.container);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.appendRequestLayout();\n\t\t});\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst searchId = this.fields.getId() || this.fields.getCopiedId();\n\t\tconst {optionManager} = this;\n\t\tconst optionAttachments = optionManager.attachments;\n\t\tlet attachmentsLayout = '';\n\n\t\tif (optionAttachments && (searchId in optionAttachments))\n\t\t{\n\t\t\tconst attachments = Tag.render`${optionAttachments[searchId]}`;\n\t\t\tconst stableAttachments = this.getStableAttachments(optionManager.getStableTreeStructure());\n\t\t\tconst attachmentsToDelete = [];\n\n\t\t\tif (!attachments)\n\t\t\t{\n\t\t\t\treturn attachmentsLayout;\n\t\t\t}\n\n\t\t\tattachmentsLayout = attachments;\n\n\t\t\tif (!Array.isArray(attachments))\n\t\t\t{\n\t\t\t\tattachmentsLayout = [attachments];\n\t\t\t}\n\n\t\t\tObject.keys(attachmentsLayout).forEach((key) => {\n\t\t\t\tconst attachment = attachmentsLayout[key];\n\t\t\t\tconst fileId = attachment.getAttribute('data-bx-id');\n\t\t\t\tconst extension = CheckListItem.getFileExtension(attachment.getAttribute('data-bx-extension'));\n\t\t\t\tconst extensionClass = `ui-icon-file-${extension}`;\n\t\t\t\tconst iconContainer = attachment.querySelector(`#disk-attach-file-${fileId}`);\n\t\t\t\tconst deleteButton = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\"\n\t\t\t\t\t\t onclick=\"${this.onDeleteAttachmentClick.bind(this, fileId)}\"></div>\n\t\t\t\t`;\n\t\t\t\tconst has = Object.prototype.hasOwnProperty;\n\n\t\t\t\tif (!has.call(stableAttachments, fileId))\n\t\t\t\t{\n\t\t\t\t\tattachmentsToDelete.push(key);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (iconContainer && !Dom.hasClass(iconContainer, extensionClass))\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(iconContainer, extensionClass);\n\t\t\t\t}\n\n\t\t\t\tif (this.checkCanUpdate())\n\t\t\t\t{\n\t\t\t\t\tDom.append(deleteButton, attachment.querySelector('.tasks-checklist-item-attachment-file-cover'));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tattachmentsToDelete.sort((a, b) => b - a);\n\t\t\tattachmentsToDelete.forEach((id) => {\n\t\t\t\tattachmentsLayout.splice(id, 1);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setAttachments({});\n\t\t}\n\n\t\treturn attachmentsLayout;\n\t}\n\n\tgetStableAttachments(item)\n\t{\n\t\tconst fields = item.FIELDS;\n\t\tconst id = fields.id || fields.copiedId;\n\n\t\tif (id === this.fields.getId() || id === this.fields.getCopiedId())\n\t\t{\n\t\t\treturn fields.attachments;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.getStableAttachments(descendant);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tgetLoadedAttachmentLayout(attachment)\n\t{\n\t\tconst {id, name, viewUrl, size, ext} = attachment;\n\t\tlet img = '';\n\n\t\tif (viewUrl)\n\t\t{\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\" style=\"background-image: url(${viewUrl})\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(this, id)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst extension = CheckListItem.getFileExtension(ext);\n\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\">\n\t\t\t\t\t<div class=\"ui-icon ui-icon-file-${extension}\"><i></i></div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(this, id)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\" data-bx-id=\"${id}\">\n\t\t\t\t${img}\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonAttachmentsLoaderMenuItemClick()\n\t{\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\tgetAttachmentsLoaderLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst {prefix} = this.optionManager;\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t\t<div id=\"diskuf-selectdialog-${nodeId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t\t<div class=\"diskuf-files-block tasks-checklist-loader-files\">\n\t\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t\t<input type=\"hidden\" name=\"${prefix}[${nodeId}][UF_CHECKLIST_FILES][]\" value=\"\"/>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t\t<label for=\"file_loader_${nodeId}\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${nodeId}\" type=\"file\"\n\t\t\t\t\t\t\t\t   multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.OnFileUploadSuccess.bind(this));\n\t\tBX.addCustomEvent(filesChooser, 'DiskDLoadFormControllerInit', (uf) => {\n\t\t\tuf._onUploadProgress = this.onUploadProgress.bind(this);\n\t\t});\n\n\t\treturn filesChooser;\n\t}\n\n\tonUploadProgress(item, progress)\n\t{\n\t\tconst {id, name, size} = item;\n\t\tconst newProgress = Math.min(progress, 98);\n\n\t\tif (!this.filesLoaderProgressBars.has(id))\n\t\t{\n\t\t\tconst myProgress = new BX.UI.ProgressRound({\n\t\t\t\tid: `load_progress_${id}`,\n\t\t\t\tvalue: newProgress,\n\t\t\t\tmaxValue: 100,\n\t\t\t\twidth: 69,\n\t\t\t\tlineSize: 5,\n\t\t\t\tfill: false,\n\t\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t\t\tstatusType: BX.UI.ProgressRound.Status.INCIRCLE,\n\t\t\t});\n\t\t\tconst filePreview = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\">\n\t\t\t\t\t${myProgress.getContainer()}\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.filesLoaderProgressBars.set(id, myProgress);\n\t\t\tDom.append(filePreview, this.getAttachmentsContainer());\n\t\t}\n\n\t\tif (!item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = 5;\n\t\t}\n\n\t\tif (newProgress > item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = Math.ceil(newProgress);\n\t\t\titem.progressBarWidth = item.progressBarWidth > 100 ? 100 : item.progressBarWidth;\n\n\t\t\tif (this.filesLoaderProgressBars.has(id))\n\t\t\t{\n\t\t\t\tthis.filesLoaderProgressBars.get(id).update(item.progressBarWidth);\n\t\t\t}\n\t\t}\n\t}\n\n\tOnFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst attachmentId = fileResult.element_id.toString();\n\t\tconst attachment = {\n\t\t\tid: attachmentId,\n\t\t\tname: fileResult.element_name,\n\t\t\tviewUrl: fileResult.element_url,\n\t\t\tsize: uploaderFile.size,\n\t\t\text: uploaderFile.ext,\n\t\t};\n\n\t\tthis.fields.addAttachments({[attachmentId]: attachmentId});\n\t\tthis.filesLoaderProgressBars.delete(uploaderFile.id);\n\n\t\tconst attachmentProgress = this.getAttachmentsContainer().querySelector(`#disk-attach-${uploaderFile.id}`);\n\t\tconst attachmentLayout = this.getLoadedAttachmentLayout(attachment);\n\n\t\tif (attachmentProgress)\n\t\t{\n\t\t\tDom.replace(attachmentProgress, attachmentLayout);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(attachmentLayout, this.getAttachmentsContainer());\n\t\t}\n\n\t\tconst id = this.fields.getId();\n\t\tconst optionAttachments = this.optionManager.attachments;\n\n\t\tif (optionAttachments)\n\t\t{\n\t\t\tif (id in optionAttachments)\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] += attachmentLayout.outerHTML;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] = attachmentLayout.outerHTML;\n\t\t\t}\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'fileUpload'});\n\t}\n\n\tgetTaskRootLayout(children)\n\t{\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-task-root\">\n\t\t\t\t<div id=\"subItems_${this.getNodeId()}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst value = this.fields.getCompletedCount();\n\t\tconst maxValue = this.fields.getTotalCount();\n\t\tconst layouts = {\n\t\t\tlistActionsPanel: Tag.render`<div class=\"tasks-checklist-items-list-actions droppable\"></div>`,\n\t\t\tcompleteAllButton: Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-action-complete-all-btn\" onclick=\"${this.onCompleteAllButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_COMPLETE_ALL')}\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tgroupButton: '',\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-wrapper-dragndrop\"></div>`,\n\t\t};\n\n\t\tif (this.checkCanAdd())\n\t\t{\n\t\t\tconst addButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-add-btn\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tconst groupButton = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-action-group-btn\" onclick=\"${this.onGroupButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_GROUP_ACTIONS')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.append(addButtonLayout, layouts.listActionsPanel);\n\t\t\tlayouts.groupButton = groupButton;\n\t\t}\n\n\t\tif (this.checkCanRemove())\n\t\t{\n\t\t\tconst removeButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-remove-btn\" onclick=\"${this.onDeleteClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_DELETE_CHECKLIST')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tDom.append(removeButtonLayout, layouts.listActionsPanel);\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tif (!this.showCompleteAllButton())\n\t\t{\n\t\t\tlayouts.completeAllButton = '';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressBar({\n\t\t\tvalue,\n\t\t\tmaxValue,\n\t\t\tsize: BX.UI.ProgressBar.Size.MEDIUM,\n\t\t\ttextAfter: CheckListItem.getProgressText(value, maxValue),\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-wrapper tasks-checklist-item-group-editor-collapse\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-header-wrapper droppable\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-header-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-header-inner\">\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name\"\n\t\t\t\t\t\t\t\t onmousedown=\"${this.onHeaderMouseDown.bind(this)}\"\n\t\t\t\t\t\t\t\t onmouseup=\"${this.onHeaderMouseUp.bind(this)}\">\n\t\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name-edit-btn\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress-block\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-header-actions\">\n\t\t\t\t\t\t${layouts.completeAllButton}\n\t\t\t\t\t\t${layouts.groupButton}\n\t\t\t\t\t\t<div class=\"tasks-checklist-action-collapse-btn collapsed\" onclick=\"${this.onCollapseButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-items-wrapper\">\n\t\t\t\t\t<div class=\"tasks-checklist-items-list\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${layouts.listActionsPanel}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst layouts = {\n\t\t\tdeleteButton: Tag.render`<button class=\"tasks-checklist-item-remove\" onclick=\"${this.onDeleteClick.bind(this)}\"/>`,\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-item-dragndrop\"></div>`,\n\t\t\tattachments: this.getAttachmentsLayout(),\n\t\t};\n\n\t\tif (!this.checkCanRemove())\n\t\t{\n\t\t\tlayouts.deleteButton = '';\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-item-inner droppable ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\"\n\t\t\t\t\t onmousedown=\"${this.onInnerContainerMouseDown.bind(this)}\" onmouseup=\"${this.onInnerContainerMouseUp.bind(this)}\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"/>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.fields.getIsImportant() ? this.getImportantLayout() : ''}\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-description\">\n\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-additional-block\">\n\t\t\t\t\t\t${layouts.deleteButton}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-actions-block\">\n\t\t\t\t\t\t<input class=\"tasks-checklist-item-group-checkbox\" id=\"select_${nodeId}\" type=\"checkbox\"\n\t\t\t\t\t\t\t   onclick=\"${this.onSelectCheckboxClick.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-list\" id=\"attachments_${nodeId}\">\n\t\t\t\t\t\t${layouts.attachments}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-sublist-items-wrapper\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetLayout()\n\t{\n\t\tconst children = [];\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tchildren.push(descendant.getLayout());\n\t\t});\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\treturn this.getTaskRootLayout(children);\n\t\t}\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tconst checkListLayout = this.getCheckListLayout(children);\n\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\treturn checkListLayout;\n\t\t}\n\n\t\treturn this.getCheckListItemLayout(children);\n\t}\n}\n\nclass MobileCheckListItem extends CheckListItem\n{\n\tclass = MobileCheckListItem;\n\n\tcheckedClass = 'mobile-task-checklist-item-checked';\n\thiddenClass = 'mobile-task-checklist-item-hidden';\n\tcollapseClass = 'mobile-task-checklist-section-collapse';\n\twrapperClass = 'mobile-task-checklist-wrapper';\n\n\tshowClass = 'mobile-checklist-item-show';\n\thideClass = 'mobile-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.mobile-task-checklist-item-checker',\n\t\t\t'.mobile-task-checklist-item-param',\n\t\t\t'.mobile-task-checklist-item-controls',\n\t\t],\n\t};\n\n\tstatic makeDangerElement(element)\n\t{\n\t\tconst dangerClass = 'mobile-task-checklist-error';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: {},\n\t\t\tATTACHMENTS: this.fields.getAttachments() || {},\n\t\t};\n\t\tconst membersTypes = {\n\t\t\taccomplice: 'A',\n\t\t\tauditor: 'U',\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\titemRequestData.MEMBERS[key] = {TYPE: membersTypes[value.type]};\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tonChecklistAjaxError()\n\t{\n\t\tBXMobileApp.Events.postToComponent('onChecklistAjaxError', {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\ttaskGuid: this.optionManager.taskGuid,\n\t\t}, 'tasks.view');\n\t}\n\n\tsendAddAjaxAction()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst fields = this.getItemRequestData();\n\t\t\tconst parent = this.getParent();\n\n\t\t\tfields.PARENT_ID = parent.fields.getId() || (parent.isTaskRoot() ? 0 : null);\n\n\n\t\t\tBX.ajax.runAction('tasks.task.checklist.add', {\n\t\t\t\tdata: {\n\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\tfields,\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tif (response.status === 'success')\n\t\t\t\t{\n\t\t\t\t\tconst {checkListItem} = response.data;\n\t\t\t\t\tthis.fields.setId(checkListItem.id);\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t}).catch(() => {\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\t}\n\n\tsendUpdateAjaxAction(fields, onFailCallback = null)\n\t{\n\t\tconst onFailFunction = onFailCallback || this.onChecklistAjaxError.bind(this);\n\n\t\tBX.ajax.runAction('tasks.task.checklist.update', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tfields,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tonFailFunction();\n\t\t\t}\n\t\t}).catch(() => onFailFunction());\n\t}\n\n\tsendRemoveAjaxAction()\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.delete', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tsendMembersAddAjaxAction(member, focusInput)\n\t{\n\t\tconst map = {\n\t\t\tauditor: {\n\t\t\t\tactionName: 'addAuditors',\n\t\t\t\tparamName: 'auditorsIds',\n\t\t\t\tletter: 'U',\n\t\t\t},\n\t\t\taccomplice: {\n\t\t\t\tactionName: 'addAccomplices',\n\t\t\t\tparamName: 'accomplicesIds',\n\t\t\t\tletter: 'A',\n\t\t\t},\n\t\t};\n\t\tconst currentType = map[member.type];\n\n\t\tconst toChecklistAddAction = 'tasks.task.checklist.addMembers';\n\t\tconst toChecklistAddData = {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\tmembers: {[member.id]: currentType.letter},\n\t\t};\n\n\t\tBX.ajax.runAction(toChecklistAddAction, {data: toChecklistAddData}).then((toChecklistAddResponse) => {\n\t\t\tif (toChecklistAddResponse.status === 'success')\n\t\t\t{\n\t\t\t\tif (focusInput)\n\t\t\t\t{\n\t\t\t\t\tthis.toggleUpdateMode();\n\t\t\t\t}\n\n\t\t\t\tBX.ajax.runAction(`tasks.task.${currentType.actionName}`, {data: {\n\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\t[currentType.paramName]: [member.id],\n\t\t\t\t}});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.fields.removeMember(member.id);\n\t\t\t}\n\t\t}).catch(() => this.fields.removeMember(member.id));\n\t}\n\n\tsendMoveAfterAjaxAction(afterItem)\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.moveAfter', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tafterItemId: afterItem.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tgetPopupMenuItems()\n\t{\n\t\tconst locPrefix = 'TASKS_CHECKLIST_MOBILE_POPUP_MENU_';\n\t\tconst popupMenuItems = [];\n\t\tconst popupMenuItemsBuildMap = {\n\t\t\tchecklist: {\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\trename: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}RENAME`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-rename.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t\tchecklistItem: {\n\t\t\t\taddFile: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_FILE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-file.png',\n\t\t\t\t},\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\ttabIn: {\n\t\t\t\t\tcondition: this.checkCanTabIn.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_IN`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-in.png',\n\t\t\t\t},\n\t\t\t\ttabOut: {\n\t\t\t\t\tcondition: this.checkCanTabOut.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_OUT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-out.png',\n\t\t\t\t},\n\t\t\t\timportant: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}IMPORTANT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-important.png',\n\t\t\t\t},\n\t\t\t\ttoAnotherChecklist: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TO_ANOTHER_CHECKLIST`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-to-another-checklist.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tconst type = (this.isCheckList() ? 'checklist' : 'checklistItem');\n\n\t\tObject.keys(popupMenuItemsBuildMap[type]).forEach((id) => {\n\t\t\tconst {sectionCode, title, iconUrl, condition} = popupMenuItemsBuildMap[type][id];\n\t\t\tpopupMenuItems.push({id, sectionCode, title, iconUrl, disable: !condition()});\n\t\t});\n\n\t\treturn popupMenuItems;\n\t}\n\n\tgetPopupChecklistsList()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\t\tconst popupChecklistsList = [];\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupChecklistsList.push({\n\t\t\t\tid: descendant.getNodeId(),\n\t\t\t\ttitle: Text.decode(descendant.fields.getTitle()),\n\t\t\t\tsectionCode: '0',\n\t\t\t});\n\t\t});\n\t\tpopupChecklistsList.push({\n\t\t\tid: 'newChecklist',\n\t\t\ttitle: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tsectionCode: '0',\n\t\t});\n\n\t\treturn popupChecklistsList;\n\t}\n\n\tonMemberSelectedEvent(eventData)\n\t{\n\t\tconst {nodeId, member, position, focusInput} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst title = node.fields.getTitle();\n\t\tlet newTitle = '';\n\n\t\tmember.nameFormatted = Text.encode(member.nameFormatted);\n\n\t\tif (focusInput)\n\t\t{\n\t\t\tconst start = position || 0;\n\t\t\tconst startSpace = ((start === 0 || start - 1 === 0 || title.charAt(start - 2) === ' ') ? '' : ' ');\n\t\t\tconst endSpace = (title.charAt(start - 1) === ' ' ? '' : ' ');\n\t\t\tconst newInputText = `${title.slice(0, start - 1)}${startSpace}${member.nameFormatted}${endSpace}`;\n\t\t\tnewTitle = `${newInputText}${title.slice(start)}`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst space = (title.slice(-1) === ' ' ? '' : ' ');\n\t\t\tnewTitle = `${title}${space}${member.nameFormatted}`.substring(0, 255);\n\t\t}\n\n\t\tnode.fields.addMember(member);\n\t\tnode.updateTitle(Text.decode(newTitle));\n\t\tnode.updateTitleNode();\n\n\t\tif (!this.checkEditMode())\n\t\t{\n\t\t\tnode.sendUpdateAjaxAction({TITLE: Text.decode(node.fields.getTitle())});\n\t\t\tnode.sendMembersAddAjaxAction(member, focusInput);\n\t\t}\n\t\telse if (focusInput)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonAddAttachmentEvent(eventData)\n\t{\n\t\tconst {nodeId, attachment} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tconst key = Object.keys(attachment)[0];\n\t\t\tconst value = Object.values(attachment)[0];\n\n\t\t\tnode.fields.addAttachments({[`n${key}`]: value});\n\t\t}\n\t}\n\n\tonRemoveAttachmentEvent(eventData)\n\t{\n\t\tconst {nodeId, attachmentId} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.fields.removeAttachment(attachmentId);\n\t\t\tnode.fields.removeAttachment(`n${attachmentId}`);\n\t\t}\n\t}\n\n\tgetFakeAttachmentsCount(filesToRemove, filesToAdd)\n\t{\n\t\tconst attachmentsIds = Object.keys(this.fields.getAttachments());\n\t\tconst countWithRemovable = attachmentsIds.filter(id => !filesToRemove.includes(id)).length;\n\n\t\treturn countWithRemovable + filesToAdd.length;\n\t}\n\n\tsetLayoutAttachmentsCount(attachmentsCount)\n\t{\n\t\tconst newAttachmentsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(this)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t\tDom.replace(this.getAttachmentsContainer(), newAttachmentsLayout);\n\t}\n\n\tupdateNodeAttachments(filesToRemove, filesToAdd, attachments = null)\n\t{\n\t\tif (attachments)\n\t\t{\n\t\t\tthis.fields.setAttachments(attachments);\n\t\t}\n\n\t\tconst fakeAttachmentsCount = this.getFakeAttachmentsCount(filesToRemove, filesToAdd);\n\t\tthis.setLayoutAttachmentsCount(fakeAttachmentsCount);\n\t}\n\n\tonAttachFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, attachments, checkListItemId} = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonRemoveFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, attachments} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonFakeAttachFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, checkListItemId} = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonFakeRemoveFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonRenameEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonRemoveEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tif (!this.checkEditMode() && node.fields.getId())\n\t\t\t{\n\t\t\t\tnode.sendRemoveAjaxAction();\n\t\t\t}\n\t\t\tnode.deleteAction(false);\n\t\t\tnode.getParent().updateIndexes();\n\t\t\tnode.handleCheckListChanges();\n\t\t}\n\t}\n\n\tonTabInEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabIn())\n\t\t{\n\t\t\tnode.tabIn();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst fields = {\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t};\n\t\t\t\t\tconst onFailCallback = () => { node.tabOut(); };\n\n\t\t\t\t\tnode.sendUpdateAjaxAction(fields, onFailCallback);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonTabOutEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabOut())\n\t\t{\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnode.sendMoveAfterAjaxAction(node.getParent());\n\t\t\t}\n\t\t\tnode.tabOut();\n\t\t}\n\t}\n\n\tonImportantEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleImportant();\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tconst onFailCallback = () => { node.toggleImportant(); };\n\t\t\t\tnode.sendUpdateAjaxAction({IS_IMPORTANT: node.fields.getIsImportant()}, onFailCallback);\n\t\t\t}\n\t\t}\n\t}\n\n\tonToAnotherCheckListEvent(eventData)\n\t{\n\t\tconst {nodeId, checklistId} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (checklistId === 'newChecklist')\n\t\t{\n\t\t\tnode.moveToNewCheckList(this.getDescendantsCount() + 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.makeChildOf(this.findChild(checklistId));\n\t\t\tnode.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnode.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetNativeComponentName()\n\t{\n\t\treturn (this.checkEditMode() ? 'tasks.edit' : 'tasks.view');\n\t}\n\n\tcheckEditMode()\n\t{\n\t\treturn this.optionManager.isEditMode();\n\t}\n\n\tcheckCanTabIn()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.isFirstDescendant();\n\t}\n\n\tcheckCanTabOut()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.getParent().isCheckList();\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\t// no editor panel in mobile version\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn this.isCheckList() ? 'mobile-task-checklist-head-title-text' : 'mobile-task-checklist-item-text';\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.mobile-task-checklist-head-title' : '.mobile-task-checklist-item');\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new MobileCheckListItem({TITLE: title});\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tthis.makeChildOf(newCheckList);\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnewCheckList.sendAddAjaxAction().then(() => {\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: this.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}, () => {});\n\t\t\t}\n\t\t});\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.removeClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.addClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tif (!this.checkEditMode() && this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tthis.sendRemoveAjaxAction();\n\t\t\t\t}\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tMobileCheckListItem.makeDangerElement(input.parentElement);\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tconst itemRequestData = this.getItemRequestData();\n\t\t\t\t\tconst members = itemRequestData.MEMBERS;\n\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tTITLE: itemRequestData.TITLE,\n\t\t\t\t\t\tMEMBERS: (Object.keys(members).length > 0 ? members : ''),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.sendAddAjaxAction().then(() => {}, () => {});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonInput(e)\n\t{\n\t\tconst memberSelectorCallKeys = ['@', '+'];\n\t\tconst position = CheckListItem.getInputSelection(this.input).start;\n\n\t\tif (memberSelectorCallKeys.includes(e.data) && this.checkCanAddAccomplice())\n\t\t{\n\t\t\tconst params = {\n\t\t\t\tposition,\n\t\t\t\tnodeId: this.getNodeId(),\n\t\t\t};\n\t\t\tBXMobileApp.Events.postToComponent('onChecklistInputMemberSelectorCall', params, this.getNativeComponentName());\n\t\t}\n\t}\n\n\tonInputKeyPressed(e)\n\t{\n\t\tif (e.keyCode === CheckListItem.keyCodes.enter)\n\t\t{\n\t\t\tthis.toggleUpdateMode(e);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tgetParamsForMobileEvent(type)\n\t{\n\t\tif (!['settings', 'attachments'].includes(type))\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tconst {entityId, entityType, taskGuid, diskOptions, mode} = this.optionManager;\n\t\tconst defaultParams = {\n\t\t\ttaskGuid,\n\t\t\ttaskId: entityId,\n\t\t\tnodeId: this.getNodeId(),\n\t\t\tdisk: diskOptions,\n\t\t\tajaxData: {\n\t\t\t\tentityId,\n\t\t\t\tmode,\n\t\t\t\tcheckListItemId: (this.checkEditMode() ? this.getNodeId() : this.fields.getId()),\n\t\t\t\tentityTypeId: `${entityType.toLowerCase()}Id`,\n\t\t\t},\n\t\t};\n\t\tlet localParams = {};\n\n\t\tif (type === 'settings')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tpopupChecklists: this.getPopupChecklistsList(),\n\t\t\t\tpopupMenuItems: this.getPopupMenuItems(),\n\t\t\t\tpopupMenuSections: [{id: '0', title: Text.decode(this.fields.getTitle())}],\n\t\t\t};\n\t\t}\n\t\telse if (type === 'attachments')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tattachmentsIds: Object.keys(this.fields.getAttachments()),\n\t\t\t\tcanUpdate: this.checkCanUpdate(),\n\t\t\t};\n\t\t}\n\n\t\treturn {...defaultParams, ...localParams};\n\t}\n\n\tonAttachmentsLayoutClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('attachments');\n\t\tBXMobileApp.Events.postToComponent('onChecklistAttachmentsClick', params, this.getNativeComponentName());\n\t}\n\n\tonSettingsClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('settings');\n\t\tBXMobileApp.Events.postToComponent('onChecklistSettingsClick', params, this.getNativeComponentName());\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"mobile-task-checklist-head-title mobile-task-checklist-item-edit-mode\">\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t   oninput=\"${this.onInput.bind(this)}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item mobile-task-checklist-item-edit-mode ${this.fields.getIsComplete() ? this.checkedClass : ''}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item-checker\">\n\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t   oninput=\"${this.onInput.bind(this)}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst attachmentsCount = Object.keys(this.fields.getAttachments()).length;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(this)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\t\tconst addButtonLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-add-button\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t<div class=\"mobile-task-checklist-add-text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\tstatusType: BX.UI.ProgressRound.Status.COUNTER,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-section\" id=\"${nodeId}\" data-role=\"mobile-task-checklist\">\n\t\t\t\t<div class=\"mobile-task-checklist-head\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-counter\">\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-counter-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-head-title\" onclick=\"${this.onHeaderClickDone.bind(this)}\">\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-visible\"\n\t\t\t\t\t\t\t onclick=\"${this.onCollapseButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-wrapper\">\n\t\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.checkCanAdd() ? addButtonLayout : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-wrapper\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item ${this.fields.getIsComplete() ? this.checkedClass : ''} ${this.fields.getIsImportant() ? 'mobile-task-checklist-item-important' : ''}\"\n\t\t\t\t\t onclick=\"${this.onInnerContainerClickDone.bind(this)}\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-checker\" id=\"progress_${nodeId}\"\n\t\t\t\t\t\t onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.getAttachmentsLayout()}\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n}\n\nexport {CheckListItem, MobileCheckListItem};"],"names":["TreeItem","Math","random","toString","substr","setNodeId","generateUniqueNodeId","setParent","parent","getParent","nodeId","CompositeTreeItem","descendants","item","position","push","splice","after","index","findIndex","descendant","add","before","length","getFirstDescendant","getLastDescendant","isFirstDescendant","parentDescendants","getDescendants","isLastDescendant","getRootNode","leftSiblingThrough","getLeftSibling","getDescendantsCount","getRightSibling","getNodeId","found","forEach","findChild","size","countTreeSize","CheckListItemFields","string","camelCaseString","Type","isString","toLowerCase","replace","match","chr","toUpperCase","snakeCaseString","fields","id","parentId","title","sortIndex","displaySortIndex","isComplete","isImportant","isSelected","isCollapse","completedCount","totalCount","members","Map","attachments","setFields","Object","keys","name","camelCaseName","snakeToCamelCase","indexOf","snakeCaseName","camelToSnakeCase","setMethod","bind","copiedId","Text","encode","types","A","U","clear","NAME","TYPE","set","nameFormatted","type","member","delete","CheckListItem","element","dangerClass","Dom","hasClass","addClass","oldParent","newParent","updateCounts","updateProgress","updateIndexes","completed","total","replaces","progressText","Loc","getMessage","search","ext","fileExtension","input","start","end","normalizedValue","range","textInputRange","len","endRange","selectionStart","selectionEnd","document","selection","createRange","parentElement","value","createTextRange","moveToBookmark","getBookmark","collapse","compareEndPoints","moveStart","slice","split","moveEnd","defaultTitle","itemNumber","node","posFrom","BX","GetWindowScrollPos","scrollTop","posTo","pos","top","round","GetWindowInnerSize","innerHeight","toBottom","distance","abs","speed","step","posCurrent","timer","i","setTimeout","url","messageId","esc","enter","plus","atsign","tab","up","down","action","header","canUpdate","MODIFY","canRemove","REMOVE","canToggle","TOGGLE","canDrag","DRAG","panel","progress","filesLoaderPopup","filesLoaderProgressBars","updateMode","optionManager","clickEventHandler","isTaskRoot","getId","findById","recursively","getIsComplete","countCompletedCount","countTotalCount","setCompletedCount","setTotalCount","updateCompletedCount","updateTotalCount","getTotalCount","getCompletedCount","setMaxValue","update","isCheckList","updateProgressText","getProgressText","setTextAfter","layout","style","overflow","height","opacity","showClass","scrollHeight","hideClass","remove","setDefaultStyles","container","paddingTop","getSortIndex","addCheckListItem","showBalloon","getTitle","data","getNotificationBalloon","EventEmitter","emit","e","preventDefault","hide","checkSelectedItems","items","getSelectedItems","runForEachSelectedItem","setIsSelected","deleteAction","handleCheckListChanges","actions","content","events","click","event","balloon","close","restore","handleTaskOptions","image","avatar","Tag","render","loadExt","then","UI","Notification","Center","notify","rootNode","moveToNewCheckList","PopupMenuWindow","target","getToAnotherCheckListPopupItems","autoHide","closeByEsc","offsetLeft","offsetWidth","angle","onPopupClose","destroy","show","selectMode","popupMenuItems","toNewCheckListMenuItem","text","message","onclick","getMenuWindow","selectedItem","makeChildOf","unselectAll","delimiter","checkList","getCheckList","checkLists","filter","handleUpdateEnding","number","newCheckList","TITLE","space","newTitle","substring","addMember","updateTitle","decode","updateTitleNode","inputText","mentioned","inputCursorPosition","startSpace","charAt","endSpace","newInputText","retrieveFocus","auditor","userData","prepareUserData","resultAuditor","notificationAction","notificationData","processMemberSelect","accomplice","resultAccomplice","user","customData","getCustomData","entityType","getEntityType","description","get","lastName","email","networkId","crmemail","extranet","network","memberType","checkCanAddAccomplice","typeFunctionMap","onSocNetSelectorAuditorSelected","onSocNetSelectorAccompliceSelected","typeFunction","isSelectorLoading","Runtime","loadExtension","exports","Dialog","dialog","targetNode","enableSearch","multiple","entities","options","inviteGuestLink","inviteEmployeeLink","emailUsers","networkUsers","extranetUsers","getData","getMemberSelector","prefix","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","PopupWindow","getAttachmentsLoaderLayout","bindElement","setBindElement","Disk","UF","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","querySelector","fileId","removeAttachment","getAttachmentsContainer","membersLayout","onAddAuditorClick","onAddAccompliceClick","attachmentButtonLayout","onUploadAttachmentClick","itemsActionButtonsLayout","onTabInClick","onTabOutClick","getIsImportant","onImportantClick","onToAnotherCheckListClick","onDeleteClick","separator","setTitle","getTitleNodeContainer","getTitleLayout","userPath","escapeRegExp","getDefaultCheckListTitle","getMembers","regExp","RegExp","getMemberLinkLayout","getLinkLayout","getTitleNodeClass","membersToDelete","removeMember","updateSortIndexes","updateDisplaySortIndexes","setSortIndex","parentSortIndex","getDisplaySortIndex","localSortIndex","newSortIndex","setDisplaySortIndex","innerText","userId","showCompleted","showOnlyMine","hideByCondition","hasUserInMembers","has","condition","checkCanHide","canHide","checkActiveUpdateExist","getIsSelected","toggleGroup","disableAllUpdateModes","getInputSelection","focus","setSelectionRange","onInputKeyPressed","onInputKeyDown","rememberInputState","clearInput","progressBarLayout","ProgressRound","maxValue","width","lineSize","fill","color","Color","PRIMARY","onCompleteButtonClick","getContainer","nodeToPosition","getPosition","getPanelBodyLayout","left","append","body","isShown","right","viewModeLayout","getInnerContainer","updateModeLayout","getUpdateModeLayout","hiddenClass","insertBefore","showEditorPanel","currentInner","trim","processMembersFromText","removeClass","nextElementSibling","getAttachments","createNewItem","checkCanDeleteOnUpdateEnding","handleCheckListIsEmpty","makeDangerElement","disableUpdateMode","keyCode","keyCodes","disableAllGroup","enableUpdateMode","toggleUpdateMode","shiftKey","defaultMemberSelectorType","tabOut","tabIn","getLeftSiblingThrough","rightSiblingThrough","getRightSiblingThrough","handleMouseDown","registerClickDoneCallback","onHeaderClickDone","handleMouseUp","checkCanUpdate","checkSkipUpdate","onInnerContainerClickDone","toggleSelect","setIsImportant","getImportantLayout","callback","reverse","selectedItems","toggleImportant","panelImportantButton","closest","toggleClass","completeAll","runAjaxCompleteAll","checkCanToggle","toggleComplete","ajaxActions","entityId","stableTreeStructure","COMPLETE_ALL","ajax","runAction","response","updateStableTreeStructure","runAjax","setIsComplete","checkedClass","runAjaxToggleComplete","actionName","COMPLETE","RENEW","checkListItemId","checkListItem","FIELDS","DESCENDANTS","checkBox","checked","selected","getSelected","getIsCollapse","toggleCollapse","collapseFreezed","wrapperList","wrapperClass","wrapperListHeight","collapseClass","setIsCollapse","setAutoHeight","unbind","checkListIsComplete","checkIsComplete","collapseOnCompleteAll","checkListIsEmpty","toggleEmpty","handleCheckListIsComplete","area","skipUpdateClasses","find","getShowCompleteAllButton","getCollapseOnCompleteAll","getCanAdd","getCanAddAccomplice","addBefore","addAfter","updateParents","insertAfter","borderItems","bottom","move","getSubItemsContainer","dependsOn","itemGet","class","Promise","resolve","newCheckListItem","newCheckListItemLayout","getLayout","smoothScroll","itemRequestData","NODE_ID","PARENT_NODE_ID","ID","COPIED_ID","getCopiedId","PARENT_ID","getParentId","SORT_INDEX","IS_COMPLETE","IS_IMPORTANT","MEMBERS","ATTACHMENTS","key","inputData","getItemRequestData","getRequestData","attachmentsLayout","requestLayout","checkCanRemove","appendRequestLayout","searchId","optionAttachments","stableAttachments","getStableAttachments","getStableTreeStructure","attachmentsToDelete","Array","isArray","attachment","getAttribute","extension","getFileExtension","extensionClass","iconContainer","deleteButton","onDeleteAttachmentClick","prototype","hasOwnProperty","call","sort","a","b","setAttachments","viewUrl","img","filesChooser","onAttachmentsLoaderMenuItemClick","addCustomEvent","OnFileUploadSuccess","uf","_onUploadProgress","onUploadProgress","newProgress","min","myProgress","statusType","Status","INCIRCLE","filePreview","progressBarWidth","ceil","fileResult","file","uploaderFile","attachmentId","element_id","element_name","element_url","addAttachments","attachmentProgress","attachmentLayout","getLoadedAttachmentLayout","outerHTML","children","layouts","listActionsPanel","completeAllButton","onCompleteAllButtonClick","groupButton","dndButton","checkCanAdd","addButtonLayout","onAddCheckListItemClick","onGroupButtonClick","removeButtonLayout","checkCanDrag","visibility","showCompleteAllButton","ProgressBar","Size","MEDIUM","textAfter","onHeaderMouseDown","onHeaderMouseUp","onCollapseButtonClick","getAttachmentsLayout","onInnerContainerMouseDown","onInnerContainerMouseUp","onSelectCheckboxClick","getTaskRootLayout","checkListLayout","getCheckListLayout","getCheckListItemLayout","MobileCheckListItem","membersTypes","BXMobileApp","Events","postToComponent","taskId","taskGuid","reject","status","setId","onChecklistAjaxError","catch","onFailCallback","onFailFunction","focusInput","map","paramName","letter","currentType","toChecklistAddAction","toChecklistAddData","toChecklistAddResponse","afterItem","afterItemId","locPrefix","popupMenuItemsBuildMap","checklist","addAuditor","sectionCode","iconUrl","addAccomplice","rename","checklistItem","addFile","checkCanTabIn","checkCanTabOut","important","toAnotherChecklist","disable","popupChecklistsList","eventData","checkEditMode","sendUpdateAjaxAction","sendMembersAddAjaxAction","values","filesToRemove","filesToAdd","attachmentsIds","countWithRemovable","includes","attachmentsCount","newAttachmentsLayout","onAttachmentsLayoutClick","fakeAttachmentsCount","getFakeAttachmentsCount","setLayoutAttachmentsCount","updateNodeAttachments","sendRemoveAjaxAction","sendMoveAfterAjaxAction","checklistId","isEditMode","sendAddAjaxAction","memberSelectorCallKeys","params","getNativeComponentName","diskOptions","mode","defaultParams","disk","ajaxData","entityTypeId","localParams","popupChecklists","getPopupChecklistsList","getPopupMenuItems","popupMenuSections","getParamsForMobileEvent","onInput","Mobile","Tasks","CheckList","settingsLayout","onSettingsClick","COUNTER"],"mappings":"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"}