{"version":3,"file":"check-list-item.bundle.js","sources":["../src/tree-item.js","../src/composite-tree-item.js","../src/check-list-item-fields.js","../src/check-list-item.js"],"sourcesContent":["class TreeItem\n{\n\tstatic generateUniqueNodeId()\n\t{\n\t\treturn Math.random().toString(36).substr(2, 9);\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.setNodeId(TreeItem.generateUniqueNodeId());\n\t\tthis.setParent(null);\n\t}\n\n\tgetRootNode()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (parent.getParent() !== null)\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tgetNodeId()\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tsetNodeId(nodeId)\n\t{\n\t\tthis.nodeId = nodeId;\n\t}\n\n\tgetParent()\n\t{\n\t\treturn this.parent;\n\t}\n\n\tsetParent(parent)\n\t{\n\t\tthis.parent = parent;\n\t}\n}\n\nexport {TreeItem};","import {TreeItem} from './tree-item';\n\nclass CompositeTreeItem extends TreeItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.descendants = [];\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\titem.setParent(this);\n\n\t\tif (position === null)\n\t\t{\n\t\t\tthis.descendants.push(item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.descendants.splice(position, 0, item);\n\t\t}\n\t}\n\n\taddAfter(item, after)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === after);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index + 1);\n\t\t}\n\t}\n\n\taddBefore(item, before)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === before);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index);\n\t\t}\n\t}\n\n\tremove(item)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === item);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.descendants.splice(index, 1);\n\t\t}\n\t}\n\n\tgetDescendants()\n\t{\n\t\treturn this.descendants;\n\t}\n\n\tgetDescendantsCount()\n\t{\n\t\treturn this.descendants.length;\n\t}\n\n\tgetFirstDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[0];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetLastDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[this.descendants.length - 1];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tisFirstDescendant()\n\t{\n\t\treturn (this === this.getParent().getFirstDescendant());\n\t}\n\n\tisLastDescendants()\n\t{\n\t\treturn (this === this.getParent().getLastDescendant());\n\t}\n\n\tgetLeftSibling()\n\t{\n\t\tif (this.isFirstDescendant())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index - 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetRightSibling()\n\t{\n\t\tif (this.isLastDescendants())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index + 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindChild(nodeId)\n\t{\n\t\tif (!nodeId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.getNodeId().toString() === nodeId.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findChild(nodeId);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountTreeSize()\n\t{\n\t\tlet size = this.getDescendantsCount();\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tsize += descendant.countTreeSize();\n\t\t});\n\n\t\treturn size;\n\t}\n\n\tgetTreeSize()\n\t{\n\t\treturn this.getRootNode().countTreeSize() + 1;\n\t}\n}\n\nexport {CompositeTreeItem};","import {Text, Type} from 'main.core';\n\nclass CheckListItemFields\n{\n\tstatic snakeToCamelCase(string)\n\t{\n\t\tlet camelCaseString = string;\n\n\t\tif (Type.isString(camelCaseString))\n\t\t{\n\t\t\tcamelCaseString = camelCaseString.toLowerCase();\n\t\t\tcamelCaseString = camelCaseString.replace(/[-_\\s]+(.)?/g, (match, chr) => (chr ? chr.toUpperCase() : ''));\n\n\t\t\treturn camelCaseString.substr(0, 1).toLowerCase() + camelCaseString.substr(1);\n\t\t}\n\n\t\treturn camelCaseString;\n\t}\n\n\tstatic camelToSnakeCase(string)\n\t{\n\t\tlet snakeCaseString = string;\n\n\t\tif (Type.isString(snakeCaseString))\n\t\t{\n\t\t\tsnakeCaseString = snakeCaseString.replace(/(.)([A-Z])/g, '$1_$2').toUpperCase();\n\t\t}\n\n\t\treturn snakeCaseString;\n\t}\n\n\tconstructor(fields)\n\t{\n\t\tthis.fields = [\n\t\t\t'id',\n\t\t\t'copiedId',\n\t\t\t'parentId',\n\t\t\t'title',\n\t\t\t'sortIndex',\n\t\t\t'displayTitle',\n\t\t\t'displaySortIndex',\n\t\t\t'isComplete',\n\t\t\t'isImportant',\n\t\t\t'isSelected',\n\t\t\t'isCollapse',\n\t\t\t'completedCount',\n\t\t\t'totalCount',\n\t\t\t'members',\n\t\t\t'attachments',\n\t\t];\n\n\t\tthis.id = null;\n\t\tthis.parentId = null;\n\t\tthis.title = '';\n\t\tthis.sortIndex = 0;\n\t\tthis.displayTitle = '';\n\t\tthis.displaySortIndex = '';\n\t\tthis.isComplete = false;\n\t\tthis.isImportant = false;\n\t\tthis.isSelected = false;\n\t\tthis.isCollapse = false;\n\t\tthis.completedCount = 0;\n\t\tthis.totalCount = 0;\n\t\tthis.members = new Map();\n\t\tthis.attachments = {};\n\n\t\tthis.setFields(fields);\n\t}\n\n\tsetFields(fields)\n\t{\n\t\tObject.keys(fields).forEach((name) => {\n\t\t\tconst camelCaseName = CheckListItemFields.snakeToCamelCase(name);\n\n\t\t\tif (this.fields.indexOf(name) !== -1)\n\t\t\t{\n\t\t\t\tconst snakeCaseName = CheckListItemFields.camelToSnakeCase(name);\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${snakeCaseName}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t\telse if (this.fields.indexOf(camelCaseName) !== -1)\n\t\t\t{\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${name}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\tgetCopiedId()\n\t{\n\t\treturn this.copiedId;\n\t}\n\n\tsetCopiedId(copiedId)\n\t{\n\t\tthis.copiedId = copiedId;\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetParentId(parentId)\n\t{\n\t\tthis.parentId = parentId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title)\n\t{\n\t\tthis.title = title;\n\t}\n\n\tgetSortIndex()\n\t{\n\t\treturn this.sortIndex;\n\t}\n\n\tsetSortIndex(sortIndex)\n\t{\n\t\tthis.sortIndex = sortIndex;\n\t}\n\n\tgetDisplayTitle()\n\t{\n\t\treturn this.displayTitle;\n\t}\n\n\tsetDisplayTitle(displayTitle)\n\t{\n\t\tthis.displayTitle = displayTitle;\n\t}\n\n\tgetDisplaySortIndex()\n\t{\n\t\treturn this.displaySortIndex;\n\t}\n\n\tsetDisplaySortIndex(displaySortIndex)\n\t{\n\t\tthis.displaySortIndex = displaySortIndex;\n\t}\n\n\tgetIsComplete()\n\t{\n\t\treturn this.isComplete;\n\t}\n\n\tsetIsComplete(isComplete)\n\t{\n\t\tthis.isComplete = isComplete;\n\t}\n\n\tgetIsImportant()\n\t{\n\t\treturn this.isImportant;\n\t}\n\n\tsetIsImportant(isImportant)\n\t{\n\t\tthis.isImportant = isImportant;\n\t}\n\n\tgetIsSelected()\n\t{\n\t\treturn this.isSelected;\n\t}\n\n\tsetIsSelected(isSelected)\n\t{\n\t\tthis.isSelected = isSelected;\n\t}\n\n\tgetIsCollapse()\n\t{\n\t\treturn this.isCollapse;\n\t}\n\n\tsetIsCollapse(isCollapse)\n\t{\n\t\tthis.isCollapse = isCollapse;\n\t}\n\n\tgetCompletedCount()\n\t{\n\t\treturn this.completedCount;\n\t}\n\n\tsetCompletedCount(completedCount)\n\t{\n\t\tthis.completedCount = completedCount;\n\t}\n\n\tgetTotalCount()\n\t{\n\t\treturn this.totalCount;\n\t}\n\n\tsetTotalCount(totalCount)\n\t{\n\t\tthis.totalCount = totalCount;\n\t}\n\n\tgetMembers()\n\t{\n\t\treturn this.members;\n\t}\n\n\tsetMembers(members)\n\t{\n\t\tconst types = {\n\t\t\tA: 'accomplice',\n\t\t\tU: 'auditor',\n\t\t};\n\n\t\tthis.members.clear();\n\n\t\tObject.keys(members).forEach((id) => {\n\t\t\tconst {NAME, TYPE} = members[id];\n\t\t\tthis.members.set(id, {id, nameFormatted: Text.encode(NAME), type: types[TYPE]});\n\t\t});\n\t}\n\n\taddMember(member)\n\t{\n\t\tthis.members.set(member.id, member);\n\t}\n\n\tremoveMember(id)\n\t{\n\t\tthis.members.delete(id);\n\t}\n\n\tgetAttachments()\n\t{\n\t\treturn this.attachments;\n\t}\n\n\tsetAttachments(attachments)\n\t{\n\t\tthis.attachments = attachments;\n\t}\n\n\taddAttachments(attachments)\n\t{\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\tthis.attachments[id] = attachments[id];\n\t\t});\n\t}\n\n\tremoveAttachment(id)\n\t{\n\t\tdelete this.attachments[id];\n\t}\n}\n\nexport {CheckListItemFields};","import './css/check-list-item.css';\n\nimport {Dom, Event, Loc, Tag, Text} from 'main.core';\n\nimport {CompositeTreeItem} from './composite-tree-item';\nimport {CheckListItemFields} from './check-list-item-fields';\n\nclass CheckListItem extends CompositeTreeItem\n{\n\tclass = CheckListItem;\n\n\tcheckedClass = 'tasks-checklist-item-solved';\n\thiddenClass = 'tasks-checklist-item-hidden';\n\tcollapseClass = 'tasks-checklist-collapse';\n\twrapperClass = 'tasks-checklist-items-wrapper';\n\n\tshowClass = 'tasks-checklist-item-show';\n\thideClass = 'tasks-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.tasks-checklist-item-important',\n\t\t\t'.tasks-checklist-item-dragndrop',\n\t\t\t'.tasks-checklist-item-group-checkbox',\n\t\t\t'.tasks-checklist-item-remove',\n\t\t\t'.tasks-checklist-item-flag-block',\n\t\t],\n\t};\n\n\tstatic makeDangerElement(element)\n\t{\n\t\tconst dangerClass = 'ui-ctl-danger';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tstatic updateParents(oldParent, newParent)\n\t{\n\t\tif (oldParent !== newParent)\n\t\t{\n\t\t\toldParent.updateCounts();\n\t\t\tnewParent.updateCounts();\n\n\t\t\toldParent.updateProgress();\n\t\t\tnewParent.updateProgress();\n\n\t\t\toldParent.updateIndexes();\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t}\n\n\tstatic getProgressText(completed, total)\n\t{\n\t\tconst replaces = {\n\t\t\t'#total#': total,\n\t\t\t'#completed#': completed,\n\t\t};\n\t\tlet progressText = Loc.getMessage('TASKS_CHECKLIST_PROGRESS_BAR_PROGRESS_TEXT');\n\n\t\tObject.keys(replaces).forEach((search) => {\n\t\t\tprogressText = progressText.replace(search, replaces[search]);\n\t\t});\n\n\t\treturn progressText;\n\t}\n\n\tstatic getFileExtension(ext)\n\t{\n\t\tlet fileExtension = ext;\n\n\t\tswitch (ext)\n\t\t{\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'swf':\n\t\t\tcase 'wmv':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'txt':\n\t\t\t\tfileExtension = 'txt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'doc':\n\t\t\tcase 'docx':\n\t\t\t\tfileExtension = 'doc';\n\t\t\t\tbreak;\n\n\t\t\tcase 'xls':\n\t\t\tcase 'xlsx':\n\t\t\t\tfileExtension = 'xls';\n\t\t\t\tbreak;\n\n\t\t\tcase 'php':\n\t\t\t\tfileExtension = 'php';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pdf':\n\t\t\t\tfileExtension = 'pdf';\n\t\t\t\tbreak;\n\n\t\t\tcase 'ppt':\n\t\t\tcase 'pptx':\n\t\t\t\tfileExtension = 'ppt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rar':\n\t\t\t\tfileExtension = 'rar';\n\t\t\t\tbreak;\n\n\t\t\tcase 'zip':\n\t\t\t\tfileExtension = 'zip';\n\t\t\t\tbreak;\n\n\t\t\tcase 'set':\n\t\t\t\tfileExtension = 'set';\n\t\t\t\tbreak;\n\n\t\t\tcase 'mov':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'img':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\t\tfileExtension = 'img';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tfileExtension = 'empty';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn fileExtension;\n\t}\n\n\tstatic getInputSelection(input)\n\t{\n\t\tlet start = 0;\n\t\tlet end = 0;\n\t\tlet normalizedValue;\n\t\tlet range;\n\t\tlet textInputRange;\n\t\tlet len;\n\t\tlet endRange;\n\n\t\tif (typeof input.selectionStart === 'number' && typeof input.selectionEnd === 'number')\n\t\t{\n\t\t\tstart = input.selectionStart;\n\t\t\tend = input.selectionEnd;\n\t\t}\n\t\telse\n\t\t{\n\t\t\trange = document.selection.createRange();\n\n\t\t\tif (range && range.parentElement() === input)\n\t\t\t{\n\t\t\t\tlen = input.value.length;\n\t\t\t\tnormalizedValue = input.value.replace(/\\r\\n/g, '\\n');\n\n\t\t\t\t// Create a working TextRange that lives only in the input\n\t\t\t\ttextInputRange = input.createTextRange();\n\t\t\t\ttextInputRange.moveToBookmark(range.getBookmark());\n\n\t\t\t\t// Check if the start and end of the selection are at the very end\n\t\t\t\t// of the input, since moveStart/moveEnd doesn't return what we want\n\t\t\t\t// in those cases\n\t\t\t\tendRange = input.createTextRange();\n\t\t\t\tendRange.collapse(false);\n\n\t\t\t\tif (textInputRange.compareEndPoints('StartToEnd', endRange) > -1)\n\t\t\t\t{\n\t\t\t\t\tstart = len;\n\t\t\t\t\tend = len;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstart = -textInputRange.moveStart('character', -len);\n\t\t\t\t\tstart += normalizedValue.slice(0, start).split('\\n').length - 1;\n\n\t\t\t\t\tif (textInputRange.compareEndPoints('EndToEnd', endRange) > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tend = len;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tend = -textInputRange.moveEnd('character', -len);\n\t\t\t\t\t\tend += normalizedValue.slice(0, end).split('\\n').length - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {start, end};\n\t}\n\n\tstatic getDefaultDisplayTitle(title)\n\t{\n\t\tlet defaultDisplayTitle = title;\n\n\t\tif (title.indexOf('BX_CHECKLIST') === 0)\n\t\t{\n\t\t\tif (title === 'BX_CHECKLIST')\n\t\t\t{\n\t\t\t\tdefaultDisplayTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_2');\n\t\t\t}\n\t\t\telse if (title.match(/BX_CHECKLIST_\\d+$/))\n\t\t\t{\n\t\t\t\tconst itemNumber = title.replace('BX_CHECKLIST_', '');\n\t\t\t\tdefaultDisplayTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_WITH_NUMBER').replace('#ITEM_NUMBER#', itemNumber);\n\t\t\t}\n\t\t}\n\n\t\treturn defaultDisplayTitle;\n\t}\n\n\tstatic smoothScroll(node)\n\t{\n\t\tconst posFrom = BX.GetWindowScrollPos().scrollTop;\n\t\tconst posTo = BX.pos(node).top - Math.round(BX.GetWindowInnerSize().innerHeight / 2);\n\t\tconst toBottom = posFrom < posTo;\n\t\tconst distance = Math.abs(posTo - posFrom);\n\t\tconst speed = (Math.round(distance / 100) > 20 ? 20 : Math.round(distance / 100));\n\t\tconst step = speed / 2;\n\n\t\tif (step <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet posCurrent = (toBottom ? posFrom + step : posFrom - step);\n\t\tlet timer = 0;\n\n\t\tif (toBottom)\n\t\t{\n\t\t\tfor (let i = posFrom; i < posTo; i += step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent += step;\n\t\t\t\tif (posCurrent > posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor (let i = posFrom; i > posTo; i -= step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent -= step;\n\t\t\t\tif (posCurrent < posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tconstructor(fields = {})\n\t{\n\t\tconst {action} = fields;\n\n\t\tsuper();\n\t\tthis.fields = new CheckListItemFields(fields);\n\t\tthis.action = {\n\t\t\tcanUpdate: (action && 'MODIFY' in action) ? action.MODIFY : true,\n\t\t\tcanRemove: (action && 'REMOVE' in action) ? action.REMOVE : true,\n\t\t\tcanToggle: (action && 'TOGGLE' in action) ? action.TOGGLE : true,\n\t\t\tcanDrag: (action && 'DRAG' in action) ? action.DRAG : true,\n\t\t};\n\n\t\tthis.input = null;\n\t\tthis.panel = null;\n\t\tthis.progress = null;\n\t\tthis.filesLoaderPopup = null;\n\t\tthis.filesLoaderProgressBars = new Map();\n\t\tthis.updateMode = false;\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\tsuper.add(item, position);\n\t\titem.optionManager = this.optionManager;\n\t}\n\n\tisTaskRoot()\n\t{\n\t\treturn this.getNodeId() === 0 && this.getParent() === null;\n\t}\n\n\tisCheckList()\n\t{\n\t\treturn !this.isTaskRoot() && this.getParent().isTaskRoot();\n\t}\n\n\tgetCheckList()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (!parent.getParent().isTaskRoot())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tfindById(id)\n\t{\n\t\tif (!id)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.fields.getId() && this.fields.getId().toString() === id.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findById(id);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountCompletedCount(recursively = false)\n\t{\n\t\tlet completedCount = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsComplete())\n\t\t\t{\n\t\t\t\tcompletedCount += 1;\n\t\t\t}\n\n\t\t\tif (recursively)\n\t\t\t{\n\t\t\t\tcompletedCount += descendant.countCompletedCount(recursively);\n\t\t\t}\n\t\t});\n\n\t\treturn completedCount;\n\t}\n\n\tcountTotalCount(recursively = false)\n\t{\n\t\tlet totalCount = 0;\n\n\t\tif (!recursively)\n\t\t{\n\t\t\ttotalCount = this.getDescendantsCount();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\ttotalCount += 1;\n\t\t\t\ttotalCount += descendant.countTotalCount(recursively);\n\t\t\t});\n\t\t}\n\n\t\treturn totalCount;\n\t}\n\n\tupdateCompletedCount()\n\t{\n\t\tconst completedCount = this.countCompletedCount();\n\t\tthis.fields.setCompletedCount(completedCount);\n\t}\n\n\tupdateTotalCount()\n\t{\n\t\tconst totalCount = this.countTotalCount();\n\t\tthis.fields.setTotalCount(totalCount);\n\t}\n\n\tupdateCounts()\n\t{\n\t\tthis.updateCompletedCount();\n\t\tthis.updateTotalCount();\n\t}\n\n\tupdateProgress()\n\t{\n\t\tif (this.progress === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst total = this.fields.getTotalCount();\n\t\tconst completed = this.fields.getCompletedCount();\n\n\t\tthis.progress.setMaxValue(total);\n\t\tthis.progress.update(completed);\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tthis.updateProgressText(completed, total);\n\t\t}\n\t}\n\n\tupdateProgressText(completed, total)\n\t{\n\t\tconst progressText = CheckListItem.getProgressText(completed, total);\n\t\tthis.progress.setTextAfter(progressText);\n\t}\n\n\tsetDefaultStyles(layout, action = 'add')\n\t{\n\t\tif (action === 'add')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = 0;\n\t\t\tlayout.style.opacity = 0;\n\n\t\t\tDom.addClass(layout, this.showClass);\n\t\t}\n\t\telse if (action === 'delete')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = `${layout.scrollHeight}px`;\n\t\t\tlayout.style.opacity = 1;\n\n\t\t\tDom.addClass(layout, this.hideClass);\n\t\t}\n\t}\n\n\tdelete()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tparent.remove(this);\n\t\tparent.updateCounts();\n\t\tparent.updateProgress();\n\n\t\tthis.setDefaultStyles(this.container, 'delete');\n\n\t\tsetTimeout(() => {\n\t\t\tthis.container.style.height = 0;\n\t\t\tthis.container.style.opacity = 0;\n\t\t\tthis.container.style.paddingTop = 0;\n\t\t}, 1);\n\n\t\tsetTimeout(() => {\n\t\t\tDom.remove(this.container);\n\t\t}, 250);\n\t}\n\n\trestore()\n\t{\n\t\tconst parent = this.getParent();\n\t\tconst position = this.fields.getSortIndex();\n\n\t\tif (position === 0)\n\t\t{\n\t\t\tif (parent.getDescendantsCount() > 0)\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this, parent.getFirstDescendant(), 'before');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparent.addCheckListItem(this, parent.getDescendants()[position - 1]);\n\t\t}\n\t}\n\n\tdeleteAction(showBalloon = true)\n\t{\n\t\tconst title = this.fields.getTitle();\n\n\t\tthis.delete();\n\n\t\tif (showBalloon && title.length > 0 && title !== '')\n\t\t{\n\t\t\tconst action = 'DELETE';\n\t\t\tconst data = {\n\t\t\t\ttype: this.isCheckList() ? 'CHECKLIST' : 'ITEM',\n\t\t\t};\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\t\t}\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'delete'});\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tonDeleteClick(e)\n\t{\n\t\te.preventDefault();\n\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tconst items = this.getSelectedItems();\n\t\t\tconst action = 'DELETE_SELECTED';\n\t\t\tconst data = {items};\n\n\t\t\tthis.runForEachSelectedItem((item) => {\n\t\t\t\titem.fields.setIsSelected(false);\n\t\t\t\titem.deleteAction(false);\n\t\t\t});\n\n\t\t\titems.forEach((item) => {\n\t\t\t\titem.getParent().updateIndexes();\n\t\t\t\titem.handleCheckListChanges();\n\t\t\t});\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteAction();\n\t\tthis.getParent().updateIndexes();\n\n\t\tthis.handleCheckListChanges();\n\t}\n\n\tgetNotificationBalloon(action, data)\n\t{\n\t\tconst actions = [];\n\t\tlet content = '';\n\n\t\tswitch (action)\n\t\t{\n\t\t\tcase 'DELETE':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_${data.type}`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tthis.restore();\n\t\t\t\t\t\t\tthis.handleCheckListChanges();\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'DELETE_SELECTED':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_ITEMS`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tdata.items.forEach((item) => {\n\t\t\t\t\t\t\t\titem.restore();\n\t\t\t\t\t\t\t\titem.handleCheckListChanges();\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'AUDITOR_ADDED':\n\t\t\tcase 'ACCOMPLICE_ADDED':\n\t\t\t{\n\t\t\t\tcontent = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-message-container\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-avatar\">\n\t\t\t\t\t\t\t<img class=\"tasks-checklist-notification-balloon-avatar-img\" src=\"${data.avatar}\" alt=\"\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"tasks-checklist-notification-balloon-message\">\n\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}`)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tBX.loadExt('ui.notification').then(() => {\n\t\t\tBX.UI.Notification.Center.notify({content, actions});\n\t\t});\n\t}\n\n\tonToAnotherCheckListClick(e)\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (rootNode.getDescendantsCount() === 1)\n\t\t{\n\t\t\tthis.moveToNewCheckList(2);\n\t\t\treturn;\n\t\t}\n\n\t\tnew BX.PopupMenuWindow(\n\t\t\t'to-another-checklist',\n\t\t\te.target,\n\t\t\tthis.getToAnotherCheckListPopupItems(),\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 3,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose() {\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t).show();\n\t}\n\n\tgetToAnotherCheckListPopupItems()\n\t{\n\t\tconst selectMode = this.checkSelectedItems();\n\t\tconst popupMenuItems = [];\n\t\tconst toNewCheckListMenuItem = {\n\t\t\ttext: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tonclick: (event, item) => {\n\t\t\t\titem.getMenuWindow().close();\n\t\t\t\tthis.moveToNewCheckList(this.getRootNode().getDescendantsCount() + 1);\n\t\t\t},\n\t\t};\n\n\t\tif (selectMode)\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tpopupMenuItems.push({\n\t\t\t\t\ttext: descendant.fields.getDisplayTitle(),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\titem.getMenuWindow().close();\n\n\t\t\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\t\t\tselectedItem.makeChildOf(descendant);\n\t\t\t\t\t\t\tdescendant.unselectAll();\n\n\t\t\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tpopupMenuItems.push({delimiter: true});\n\t\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\t\treturn popupMenuItems;\n\t\t}\n\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupMenuItems.push({\n\t\t\t\ttext: descendant.fields.getDisplayTitle(),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\tthis.makeChildOf(descendant);\n\t\t\t\t\tthis.handleUpdateEnding();\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tpopupMenuItems.push({delimiter: true});\n\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\treturn popupMenuItems;\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new CheckListItem({TITLE: title, DISPLAY_TITLE: title});\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tif (this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\tselectedItem.makeChildOf(newCheckList);\n\t\t\t\t\tnewCheckList.unselectAll();\n\n\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.makeChildOf(newCheckList);\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessMemberSelect(member)\n\t{\n\t\tif (this.memberSelector)\n\t\t{\n\t\t\tthis.memberSelector.close();\n\t\t}\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tconst displayTitle = selectedItem.fields.getDisplayTitle();\n\t\t\t\tconst space = displayTitle.slice(-1) === ' ' ? '' : ' ';\n\t\t\t\tconst newTitle = `${displayTitle}${space}${member.nameFormatted}`.substring(0, 255);\n\n\t\t\t\tselectedItem.fields.addMember(member);\n\n\t\t\t\tselectedItem.updateTitle(newTitle);\n\t\t\t\tselectedItem.updateDisplayTitle(newTitle);\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputText = this.input.value;\n\t\tconst mentioned = +this.mentioned;\n\t\tconst start = this.inputCursorPosition.start || 0;\n\t\tconst startSpace = (start === 0 || start - mentioned === 0 || inputText.charAt(start - mentioned - 1) === ' ') ? '' : ' ';\n\t\tconst endSpace = (inputText.charAt(start) === ' ' ? '' : ' ');\n\n\t\tthis.fields.addMember(member);\n\n\t\tconst newInputText = `${inputText.slice(0, start - mentioned)}${startSpace}${Text.decode(member.nameFormatted)}${endSpace}`;\n\n\t\tthis.inputCursorPosition.start = newInputText.length;\n\t\tthis.inputCursorPosition.end = newInputText.length;\n\n\t\tthis.input.value = `${newInputText}${inputText.slice(start)}`;\n\t\tthis.mentioned = false;\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tonSocNetSelectorAuditorSelected(auditor)\n\t{\n\t\tconst type = 'auditor';\n\t\tconst action = `${type.toUpperCase()}_ADDED`;\n\t\tconst data = {avatar: auditor.avatar};\n\t\tconst resultAuditor = {...auditor, type};\n\n\t\tthis.processMemberSelect(resultAuditor);\n\t\tthis.getNotificationBalloon(action, data);\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:auditorAdded', auditor);\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'addAuditor'});\n\t}\n\n\tonSocNetSelectorAccompliceSelected(accomplice)\n\t{\n\t\tconst type = 'accomplice';\n\t\tconst action = `${type.toUpperCase()}_ADDED`;\n\t\tconst data = {avatar: accomplice.avatar};\n\t\tconst resultAccomplice = {...accomplice, type};\n\n\t\tthis.processMemberSelect(resultAccomplice);\n\t\tthis.getNotificationBalloon(action, data);\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:accompliceAdded', accomplice);\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'addAccomplice'});\n\t}\n\n\tgetMemberSelector(e, memberType = 'auditor', mentioned = false)\n\t{\n\t\tif (!this.checkCanAddAccomplice())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst typeFunctionMap = {\n\t\t\tauditor: this.onSocNetSelectorAuditorSelected.bind(this),\n\t\t\taccomplice: this.onSocNetSelectorAccompliceSelected.bind(this),\n\t\t};\n\t\tconst typeFunction = typeFunctionMap[memberType] || typeFunctionMap.auditor;\n\n\t\tthis.memberSelector = new BX.Tasks.Integration.Socialnetwork.NetworkSelector({\n\t\t\tscope: e.target,\n\t\t\tmode: 'user',\n\t\t\tuseSearch: true,\n\t\t\tuseAdd: false,\n\t\t\tcontrolBind: e.target,\n\t\t\tparent: this,\n\t\t});\n\t\tthis.memberSelector.bindEvent('initialized', () => {\n\t\t\tthis.isSelectorLoading = false;\n\t\t});\n\t\tthis.memberSelector.bindEvent('close', () => {\n\t\t\tthis.mentioned = mentioned;\n\t\t\tthis.isSelectorLoading = false;\n\t\t\tthis.retrieveFocus();\n\t\t});\n\t\tthis.memberSelector.bindEvent('item-selected', typeFunction);\n\t\tthis.memberSelector.open();\n\t}\n\n\tonAddAuditorClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'auditor');\n\t}\n\n\tonAddAccompliceClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'accomplice');\n\t}\n\n\tonUploadAttachmentClick(e)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst {prefix, diskUrls} = this.optionManager;\n\t\tconst {urlSelect, urlRenameFile, urlDeleteFile, urlUpload} = diskUrls;\n\n\t\tif (this.filesLoaderPopup === null)\n\t\t{\n\t\t\tthis.filesLoaderPopup = new BX.PopupWindow({\n\t\t\t\tcontent: this.getAttachmentsLoaderLayout(),\n\t\t\t\tbindElement: e.target,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 2,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: true,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filesLoaderPopup.setBindElement(e.target);\n\t\t}\n\n\t\tthis.filesLoaderPopup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: nodeId,\n\t\t\tcontrolName: `${prefix}[${nodeId}][UF_CHECKLIST_FILES][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect,\n\t\t\turlRenameFile,\n\t\t\turlDeleteFile,\n\t\t\turlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.filesLoaderPopup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show'],\n\t\t);\n\t}\n\n\tonDeleteAttachmentClick(fileId)\n\t{\n\t\tthis.fields.removeAttachment(fileId);\n\t\tDom.remove(this.getAttachmentsContainer().querySelector(`#disk-attach-${fileId}`));\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'deleteAttachment'});\n\t}\n\n\tgetPanelBodyLayout()\n\t{\n\t\tconst membersLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-auditor\" onclick=\"${this.onAddAuditorClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_AUDITOR'}`}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-accomplice\" onclick=\"${this.onAddAccompliceClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_ACCOMPLICE'}`}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t`;\n\t\tconst attachmentButtonLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-attachment\" onclick=\"${this.onUploadAttachmentClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tconst itemsActionButtonsLayout = Tag.render`\n\t\t\t${this.checkSelectedItems() ? '' : attachmentButtonLayout}\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabin\" onclick=\"${this.onTabInClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabout\" onclick=\"${this.onTabOutClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-important\n\t\t\t\t${this.fields.getIsImportant() ? ' tasks-checklist-item-editor-panel-btn-important-selected' : ''}\" onclick=\"${this.onImportantClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage('TASKS_CHECKLIST_PANEL_IMPORTANT')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-checklist\" onclick=\"${this.onToAnotherCheckListClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage('TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-remove\" onclick=\"${this.onDeleteClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel ${this.isTaskRoot() || this.isCheckList() ? 'tasks-checklist-item-editor-group-panel' : ''}\">\n\t\t\t\t${this.checkCanAddAccomplice() ? membersLayout : ''}\n\t\t\t\t${!this.isCheckList() ? itemsActionButtonsLayout : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateTitle(text)\n\t{\n\t\tthis.fields.setTitle(text);\n\t}\n\n\tupdateDisplayTitle(text)\n\t{\n\t\tconst oldTitleNode = this.getTitleNodeContainer();\n\t\tconst newTitleNode = this.getTitleLayout();\n\n\t\tthis.fields.setDisplayTitle(text);\n\n\t\tDom.replace(oldTitleNode, newTitleNode);\n\t}\n\n\tgetTitleLayout()\n\t{\n\t\tconst {userPath} = this.optionManager;\n\t\tlet title = this.fields.getTitle();\n\n\t\ttitle = this.isCheckList() ? CheckListItem.getDefaultDisplayTitle(title) : title;\n\n\t\tthis.fields.setDisplayTitle(title);\n\t\tthis.fields.getMembers().forEach(({id, nameFormatted, type}) => {\n\t\t\tconst regExp = new RegExp(nameFormatted, 'g');\n\t\t\tconst href = userPath.replace('#user_id#', id).replace('#USER_ID#', id);\n\n\t\t\ttitle = title.replace(regExp, `<a href=${href} class=\"tasks-checklist-item-${type}\">${nameFormatted}</a>`);\n\t\t});\n\n\t\ttitle = title.replace(/(https?:\\/\\/[^\\s]+)/g, url => `<a class=\"tasks-checklist-item-link\" href=\"${url}\" target=\"_blank\">${url}</a>`);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${this.getTitleNodeClass()}\">\n\t\t\t\t${title}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tprocessMembersFromText(text)\n\t{\n\t\tconst membersToDelete = [];\n\n\t\tthis.fields.getMembers().forEach(({id, nameFormatted}) => {\n\t\t\tif (text.indexOf(nameFormatted) === -1)\n\t\t\t{\n\t\t\t\tmembersToDelete.push(id);\n\t\t\t}\n\t\t});\n\n\t\tmembersToDelete.forEach((id) => {\n\t\t\tthis.fields.removeMember(id);\n\t\t});\n\t}\n\n\tupdateIndexes()\n\t{\n\t\tthis.updateSortIndexes();\n\t\tthis.updateDisplaySortIndexes();\n\t}\n\n\tupdateSortIndexes()\n\t{\n\t\tlet sortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.fields.setSortIndex(sortIndex);\n\t\t\tsortIndex += 1;\n\t\t});\n\t}\n\n\tupdateDisplaySortIndexes()\n\t{\n\t\tconst parentSortIndex = (this.isCheckList() || this.isTaskRoot() ? '' : `${this.fields.getDisplaySortIndex()}.`);\n\t\tlet localSortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tlocalSortIndex += 1;\n\t\t\tconst newSortIndex = `${parentSortIndex}${localSortIndex}`;\n\n\t\t\tdescendant.fields.setDisplaySortIndex(newSortIndex);\n\n\t\t\tif (!descendant.isCheckList())\n\t\t\t{\n\t\t\t\tdescendant.container.querySelector('.tasks-checklist-item-number').innerText = newSortIndex;\n\t\t\t}\n\n\t\t\tdescendant.updateDisplaySortIndexes();\n\t\t});\n\t}\n\n\thandleTaskOptions()\n\t{\n\t\tconst {userId, showCompleted, showOnlyMine} = this.optionManager;\n\n\t\tthis.getRootNode().hideByCondition((item) => {\n\t\t\tconst isComplete = item.fields.getIsComplete();\n\t\t\tconst hasUserInMembers = item.fields.getMembers().has(userId.toString());\n\t\t\tlet condition;\n\n\t\t\tif (!showCompleted && showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = isComplete || !hasUserInMembers;\n\t\t\t}\n\t\t\telse if (!showCompleted)\n\t\t\t{\n\t\t\t\tcondition = isComplete;\n\t\t\t}\n\t\t\telse if (showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = !hasUserInMembers;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcondition = false;\n\t\t\t}\n\n\t\t\treturn condition;\n\t\t});\n\t}\n\n\thideByCondition(condition)\n\t{\n\t\tif (this.checkCanHide(condition))\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tdescendant.hideByCondition(condition);\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckCanHide(condition)\n\t{\n\t\tif (\n\t\t\tthis.isTaskRoot()\n\t\t\t|| this.updateMode\n\t\t\t|| Dom.hasClass(this.container, this.showClass)\n\t\t\t|| !condition(this)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet canHide = true;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (!condition(descendant))\n\t\t\t{\n\t\t\t\tcanHide = false;\n\t\t\t}\n\t\t\telse if (canHide)\n\t\t\t{\n\t\t\t\tcanHide = descendant.checkCanHide(condition);\n\t\t\t}\n\t\t});\n\n\t\treturn canHide;\n\t}\n\n\thide()\n\t{\n\t\tDom.hide(this.container);\n\t}\n\n\tshow()\n\t{\n\t\tDom.show(this.container);\n\t}\n\n\tcheckIsComplete()\n\t{\n\t\tlet isComplete;\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\tisComplete = false;\n\t\t}\n\t\telse if (this.isCheckList())\n\t\t{\n\t\t\tconst completedCount = this.countCompletedCount(true);\n\t\t\tconst totalCount = this.countTotalCount(true);\n\n\t\t\tisComplete = (completedCount === totalCount && totalCount > 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tisComplete = this.fields.getIsComplete();\n\t\t}\n\n\t\treturn isComplete;\n\t}\n\n\tcheckActiveUpdateExist()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tlet found = false;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === false)\n\t\t\t{\n\t\t\t\tfound = descendant.checkActiveUpdateExist();\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tdisableAllGroup()\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsSelected())\n\t\t\t{\n\t\t\t\tdescendant.toggleGroup();\n\t\t\t}\n\t\t});\n\t}\n\n\tdisableAllUpdateModes()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tthis.handleUpdateEnding();\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.disableAllUpdateModes();\n\t\t});\n\t}\n\n\trememberInputState()\n\t{\n\t\tthis.input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\t}\n\n\tclearInput(e)\n\t{\n\t\te.preventDefault();\n\n\t\tthis.container.querySelector(`#text_${this.getNodeId()}`).value = '';\n\t\tthis.retrieveFocus();\n\t}\n\n\tretrieveFocus()\n\t{\n\t\tif (this.input !== null && this.inputCursorPosition)\n\t\t{\n\t\t\tconst {start, end} = this.inputCursorPosition;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.setSelectionRange(start, end);\n\t\t\t}, 10);\n\t\t}\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-header-name tasks-checklist-header-name-edit-mode\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-after-icon ui-ctl-xs ui-ctl-no-padding ui-ctl-underline \n\t\t\t\t\t\t\t\ttasks-checklist-header-name-editor\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getDisplayTitle()}\"\n\t\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.UI.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-inner tasks-checklist-item-new ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\">\n\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\">\n\t\t\t\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"/>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-after-icon ui-ctl-w100\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getDisplayTitle()}\"\n\t\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t\t   onkeydown=\"${this.onInputKeyDown.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\tconst node = nodeToPosition || item.getContainer();\n\t\tconst position = Dom.getPosition(node);\n\n\t\tif (!this.panel)\n\t\t{\n\t\t\tthis.panel = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-editor-panel-container\">\n\t\t\t\t\t${item.getPanelBodyLayout()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\n\t\t\tDom.append(this.panel, document.body);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.replace(this.panel.querySelector('.tasks-checklist-item-editor-panel'), item.getPanelBodyLayout());\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\t\t}\n\n\t\tif (!Dom.isShown(this.panel))\n\t\t{\n\t\t\tDom.show(this.panel);\n\t\t}\n\n\t\tif (\n\t\t\t(Dom.isShown(this.panel) && item.isCheckList() && !item.checkCanAddAccomplice())\n\t\t\t|| (position.left === 0 && position.right === 0 && position.width === 0)\n\t\t)\n\t\t{\n\t\t\tDom.hide(this.panel);\n\t\t}\n\t}\n\n\tenableUpdateMode()\n\t{\n\t\tconst viewModeLayout = this.getInnerContainer();\n\t\tconst updateModeLayout = this.getUpdateModeLayout();\n\n\t\tDom.addClass(viewModeLayout, this.hiddenClass);\n\t\tDom.insertBefore(updateModeLayout, viewModeLayout);\n\n\t\tthis.input = updateModeLayout.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.input.focus();\n\t\tthis.input.setSelectionRange(this.input.value.length, this.input.value.length);\n\n\t\tif (this.input.value === '' || this.input.value.length === 0)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (Dom.isShown(this.input))\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}, 250);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t}\n\n\t\tthis.updateMode = true;\n\t}\n\n\tdisableUpdateMode()\n\t{\n\t\tconst currentInner = this.getInnerContainer();\n\t\tconst text = Text.encode(currentInner.querySelector(`#text_${this.getNodeId()}`).value.trim().substring(0, 255));\n\n\t\tthis.processMembersFromText(text);\n\t\tthis.updateTitle(text);\n\t\tthis.updateDisplayTitle(text);\n\n\t\tDom.removeClass(currentInner.nextElementSibling, this.hiddenClass);\n\t\tDom.remove(currentInner);\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tcheckCanDeleteOnUpdateEnding()\n\t{\n\t\treturn this.getDescendantsCount() === 0\n\t\t\t&& Object.keys(this.fields.getAttachments()).length === 0\n\t\t\t&& this.filesLoaderProgressBars.size === 0;\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tCheckListItem.makeDangerElement(input.parentElement);\n\t\t\t\tif (this.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\t\t}\n\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\ttoggleUpdateMode(e)\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tif (e.keyCode === 13 || e.keyCode === 9)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding(!this.isCheckList());\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst rootNode = this.getRootNode();\n\n\t\t\trootNode.disableAllUpdateModes();\n\t\t\trootNode.disableAllGroup();\n\n\t\t\tif (!rootNode.checkActiveUpdateExist())\n\t\t\t{\n\t\t\t\tthis.enableUpdateMode();\n\t\t\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'toggleUpdateMode'});\n\t\t\t}\n\t\t}\n\t}\n\n\tonInputKeyPressed(e)\n\t{\n\t\tif (this.isSelectorLoading)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tconst keys = {\n\t\t\tenter: 13,\n\t\t\tplus: 43,\n\t\t\tatsign: 64,\n\t\t};\n\n\t\tif (e.keyCode === keys.enter)\n\t\t{\n\t\t\tthis.toggleUpdateMode(e);\n\t\t\te.preventDefault();\n\t\t}\n\t\telse if (e.keyCode === keys.plus || (e.shiftKey && e.keyCode === keys.atsign))\n\t\t{\n\t\t\tthis.isSelectorLoading = true;\n\t\t\tthis.getMemberSelector(e, this.optionManager.defaultMemberSelectorType, true);\n\t\t}\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'inputKeyPressed'});\n\t}\n\n\tonInputKeyDown(e)\n\t{\n\t\tif (e.keyCode === 9)\n\t\t{\n\t\t\tthis.toggleUpdateMode(e);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tonHeaderNameClick(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'header'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tonInnerContainerClick(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'item'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getCheckList().fields.getIsSelected())\n\t\t{\n\t\t\tthis.toggleSelect(e);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tgetImportantLayout()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-important\" onclick=\"${this.onImportantClick.bind(this)}\"></div>\n\t\t`;\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.remove(this.container.querySelector('.tasks-checklist-item-important'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.insertBefore(this.getImportantLayout(), this.container.querySelector('.tasks-checklist-item-description'));\n\t\t}\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'toggleImportant'});\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tcheckSelectedItems()\n\t{\n\t\treturn this.getRootNode().getSelectedItems().length > 0;\n\t}\n\n\trunForEachSelectedItem(callback, reverse = false)\n\t{\n\t\tlet selectedItems = this.getRootNode().getSelectedItems();\n\n\t\tif (reverse)\n\t\t{\n\t\t\tselectedItems = [...selectedItems.reverse()];\n\t\t}\n\n\t\tselectedItems.forEach((item) => {\n\t\t\tcallback(item);\n\t\t});\n\t}\n\n\tonImportantClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.toggleImportant();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleImportant();\n\n\t\tconst panelImportantButton = e.target.closest('.tasks-checklist-item-editor-panel-btn-important');\n\t\tif (panelImportantButton)\n\t\t{\n\t\t\tDom.toggleClass(panelImportantButton, 'tasks-checklist-item-editor-panel-btn-important-selected');\n\t\t}\n\t}\n\n\tonCompleteButtonClick()\n\t{\n\t\tif (\n\t\t\tthis.getCheckList().fields.getIsSelected()\n\t\t\t|| this.updateMode\n\t\t\t|| !this.checkCanToggle()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleComplete();\n\t}\n\n\ttoggleComplete()\n\t{\n\t\tconst isComplete = this.fields.getIsComplete();\n\n\t\tthis.fields.setIsComplete(!isComplete);\n\t\tthis.getParent().updateCounts();\n\t\tthis.getParent().updateProgress();\n\n\t\tDom.toggleClass(this.getInnerContainer(), this.checkedClass);\n\n\t\tthis.handleCheckListChanges();\n\t\tthis.handleTaskOptions();\n\n\t\tthis.runAjaxToggleComplete();\n\t}\n\n\trunAjaxToggleComplete()\n\t{\n\t\tconst id = this.fields.getId();\n\n\t\tif (!id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {};\n\t\tconst {ajaxActions, entityId, entityType, stableTreeStructure} = this.optionManager;\n\t\tconst actionName = (this.fields.getIsComplete() ? ajaxActions.COMPLETE : ajaxActions.RENEW);\n\n\t\tdata[`${entityType.toLowerCase()}Id`] = entityId;\n\t\tdata.checkListItemId = id;\n\n\t\tBX.ajax.runAction(actionName, {data}).then((response) => {\n\t\t\tconst {isComplete} = response.data.checkListItem;\n\t\t\tthis.updateStableTreeStructure(isComplete, stableTreeStructure, stableTreeStructure);\n\t\t});\n\t}\n\n\tupdateStableTreeStructure(isComplete, item, parent)\n\t{\n\t\tif (this.fields.getId() === item.FIELDS.id)\n\t\t{\n\t\t\titem.FIELDS.isComplete = isComplete;\n\t\t\tparent.FIELDS.completedCount += (isComplete ? 1 : -1);\n\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.updateStableTreeStructure(isComplete, descendant, item);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tunselectAll()\n\t{\n\t\tconst checkBox = this.container.querySelector(`#select_${this.getNodeId()}`);\n\n\t\tif (checkBox && checkBox.checked === true)\n\t\t{\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tcheckBox.checked = false;\n\t\t\tDom.removeClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.unselectAll();\n\t\t});\n\t}\n\n\tgetSelected()\n\t{\n\t\tlet selected = [];\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tselected.push(this);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tselected = [...selected, ...descendant.getSelected()];\n\t\t});\n\n\t\treturn selected;\n\t}\n\n\tgetSelectedItems()\n\t{\n\t\treturn this.getSelected().filter(item => !item.isCheckList() && !item.isTaskRoot());\n\t}\n\n\tonSelectCheckboxClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\te.target.checked = false;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleSelect();\n\t}\n\n\ttoggleSelect()\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = false;\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(rootNode.panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = true;\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\t\t}\n\n\t\tDom.toggleClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t}\n\n\tonGroupButtonClick()\n\t{\n\t\tif (!this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\tthis.toggleGroup();\n\t\t}\n\t}\n\n\ttoggleGroup()\n\t{\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.unselectAll();\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\tif (this.fields.getIsCollapse())\n\t\t\t{\n\t\t\t\tthis.toggleCollapse();\n\t\t\t}\n\t\t}\n\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-collapse');\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-expand');\n\t}\n\n\tonCollapseButtonClick()\n\t{\n\t\tif (this.collapseFreezed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleCollapse();\n\t}\n\n\ttoggleCollapse()\n\t{\n\t\tthis.collapseFreezed = true;\n\n\t\tconst wrapperList = this.container.querySelector(`.${this.wrapperClass}`);\n\t\tconst wrapperListHeight = `${Dom.getPosition(wrapperList).height}px`;\n\n\t\tif (!Dom.hasClass(this.container, this.collapseClass))\n\t\t{\n\t\t\tthis.fields.setIsCollapse(true);\n\n\t\t\twrapperList.style.overflow = 'hidden';\n\t\t\twrapperList.style.height = wrapperListHeight;\n\t\t\tsetTimeout(() => { wrapperList.style.height = 0; }, 0);\n\n\t\t\tDom.addClass(this.container, this.collapseClass);\n\n\t\t\tthis.collapseFreezed = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsCollapse(false);\n\n\t\t\twrapperList.style.height = 0;\n\t\t\twrapperList.style.height = `${wrapperList.scrollHeight}px`;\n\n\t\t\tconst setAutoHeight = () => {\n\t\t\t\twrapperList.style.height = 'auto';\n\t\t\t\tBX.unbind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\t\tthis.collapseFreezed = false;\n\t\t\t};\n\t\t\tBX.bind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\tDom.removeClass(this.container, this.collapseClass);\n\t\t}\n\t}\n\n\ttoggleEmpty()\n\t{\n\t\tDom.toggleClass(this.container, 'tasks-checklist-empty');\n\t}\n\n\thandleCheckListIsComplete()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsComplete = checkList.checkIsComplete();\n\n\t\tcheckList.fields.setIsComplete(checkListIsComplete);\n\n\t\tif (checkListIsComplete && !Dom.hasClass(checkList.container, 'tasks-checklist-collapse'))\n\t\t{\n\t\t\tcheckList.toggleCollapse();\n\t\t}\n\t}\n\n\thandleCheckListIsEmpty()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsEmpty = checkList.getDescendantsCount() === 0;\n\n\t\tif (\n\t\t\t(checkListIsEmpty && !Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t\t|| (!checkListIsEmpty && Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleEmpty();\n\t\t}\n\t}\n\n\thandleCheckListChanges()\n\t{\n\t\tthis.handleCheckListIsComplete();\n\t\tthis.handleCheckListIsEmpty();\n\t}\n\n\tcheckSkipUpdate(e, area)\n\t{\n\t\treturn this.skipUpdateClasses[area]\n\t\t\t&& this.skipUpdateClasses[area].find(item => e.target.closest(item));\n\t}\n\n\tcheckCanAdd()\n\t{\n\t\treturn this.optionManager.getCanAdd();\n\t}\n\n\tcheckCanAddAccomplice()\n\t{\n\t\treturn this.optionManager.getCanAddAccomplice();\n\t}\n\n\tcheckCanUpdate()\n\t{\n\t\treturn this.action.canUpdate;\n\t}\n\n\tcheckCanRemove()\n\t{\n\t\treturn this.action.canRemove;\n\t}\n\n\tcheckCanToggle()\n\t{\n\t\treturn this.action.canToggle;\n\t}\n\n\tcheckCanDrag()\n\t{\n\t\treturn this.action.canDrag;\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn (this.isCheckList() ? 'tasks-checklist-header-name-text' : 'tasks-checklist-item-description-text');\n\t}\n\n\tgetTitleNodeContainer()\n\t{\n\t\treturn this.container.querySelector(`.${this.getTitleNodeClass()}`);\n\t}\n\n\tgetAttachmentsContainer()\n\t{\n\t\treturn this.container.querySelector(`#attachments_${this.getNodeId()}`);\n\t}\n\n\tgetSubItemsContainer()\n\t{\n\t\treturn this.container.querySelector(`#subItems_${this.getNodeId()}`);\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.tasks-checklist-header-name' : '.tasks-checklist-item-inner');\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this.container;\n\t}\n\n\tmove(item, position = 'bottom', action = 'move')\n\t{\n\t\tif (\n\t\t\tthis.getNodeId() === item.getNodeId()\n\t\t\t|| this.findChild(item.getNodeId()) !== null\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst oldParent = this.getParent();\n\t\tconst newParent = item.getParent();\n\n\t\toldParent.remove(this);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tnewParent.addBefore(this, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.addAfter(this, item);\n\t\t}\n\n\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tDom.insertBefore(this.container, item.container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.insertAfter(this.container, item.container);\n\t\t}\n\n\t\tthis.handleCheckListIsEmpty();\n\t\tthis.handleTaskOptions();\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action});\n\t}\n\n\tmakeChildOf(item, position = 'bottom', action = 'makeChildOf')\n\t{\n\t\tif (item.getDescendantsCount() > 0)\n\t\t{\n\t\t\tconst borderItems = {\n\t\t\t\ttop: item.getFirstDescendant(),\n\t\t\t\tbottom: item.getLastDescendant(),\n\t\t\t};\n\n\t\t\tthis.move(borderItems[position], position, action);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst oldParent = this.getParent();\n\t\t\tconst newParent = item;\n\n\t\t\toldParent.remove(this);\n\t\t\tnewParent.add(this);\n\n\t\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\t\tDom.append(this.container, newParent.getSubItemsContainer());\n\t\t\tDom.addClass(this.container, 'mobile-task-checklist-item-wrapper-animate');\n\n\t\t\tthis.handleCheckListIsEmpty();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action});\n\t\t}\n\t}\n\n\ttabIn()\n\t{\n\t\tif (!this.isFirstDescendant())\n\t\t{\n\t\t\tthis.makeChildOf(this.getLeftSibling(), 'bottom', 'tabIn');\n\t\t}\n\t}\n\n\tonTabInClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabIn();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabIn();\n\t\tthis.retrieveFocus();\n\t}\n\n\ttabOut()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tif (parent.isCheckList())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.move(parent, 'bottom', 'tabOut');\n\t}\n\n\tonTabOutClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabOut();\n\t\t\t}, true);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabOut();\n\t\tthis.retrieveFocus();\n\t}\n\n\taddCheckListItem(item = null, dependsOn = null, position = 'after')\n\t{\n\t\tconst itemGet = item instanceof this.class;\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst newCheckListItem = item || new this.class();\n\t\t\tlet newCheckListItemLayout;\n\n\t\t\tif (dependsOn instanceof this.class)\n\t\t\t{\n\t\t\t\tif (position === 'before')\n\t\t\t\t{\n\t\t\t\t\tthis.addBefore(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertBefore(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t\telse if (position === 'after')\n\t\t\t\t{\n\t\t\t\t\tthis.addAfter(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertAfter(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.add(newCheckListItem);\n\n\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\tDom.append(newCheckListItemLayout, this.getSubItemsContainer());\n\t\t\t}\n\n\t\t\tthis.updateCounts();\n\t\t\tthis.updateIndexes();\n\n\t\t\tif (!this.isTaskRoot())\n\t\t\t{\n\t\t\t\tthis.updateProgress();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tif (!itemGet)\n\t\t\t\t{\n\t\t\t\t\tnewCheckListItem.toggleUpdateMode();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.height = `${newCheckListItemLayout.scrollHeight}px`;\n\t\t\t\tnewCheckListItemLayout.style.opacity = 1;\n\t\t\t}, 1);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.overflow = '';\n\t\t\t\tnewCheckListItemLayout.style.height = '';\n\t\t\t\tnewCheckListItemLayout.style.opacity = '';\n\n\t\t\t\tDom.removeClass(newCheckListItemLayout, this.showClass);\n\n\t\t\t\tif (!this.isTaskRoot() && !itemGet && newCheckListItem.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.class.smoothScroll(newCheckListItem.getContainer());\n\t\t\t\t}\n\n\t\t\t\tresolve(newCheckListItem);\n\t\t\t}, 250);\n\t\t});\n\t}\n\n\tonAddCheckListItemClick()\n\t{\n\t\tif (this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addCheckListItem();\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tNODE_ID: this.getNodeId(),\n\t\t\tPARENT_NODE_ID: this.getParent().getNodeId(),\n\t\t\tID: this.fields.getId(),\n\t\t\tCOPIED_ID: this.fields.getCopiedId(),\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: [],\n\t\t\tATTACHMENTS: {},\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\tconst {nameFormatted, type} = value;\n\t\t\titemRequestData.MEMBERS.push({\n\t\t\t\t[key]: {\n\t\t\t\t\tTYPE: type,\n\t\t\t\t\tNAME: Text.decode(nameFormatted),\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tconst attachments = this.fields.getAttachments();\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\titemRequestData.ATTACHMENTS[id] = attachments[id];\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tgetRequestData(inputData = null)\n\t{\n\t\tconst title = this.fields.getTitle();\n\t\tlet data = inputData || [];\n\n\t\tif (!this.isTaskRoot() && title !== '' && title.length > 0)\n\t\t{\n\t\t\tdata.push(this.getItemRequestData());\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdata = descendant.getRequestData(data);\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tappendRequestLayout()\n\t{\n\t\tif (!this.isTaskRoot())\n\t\t{\n\t\t\tconst nodeId = this.getNodeId();\n\t\t\tconst attachments = this.fields.getAttachments();\n\t\t\tconst prefix = `${this.optionManager.prefix}[${nodeId}]`;\n\n\t\t\tlet membersLayout = '';\n\t\t\tlet attachmentsLayout = '';\n\n\t\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_TYPE_${key}\" name=\"${prefix}[MEMBERS][${key}][TYPE]\" value=\"${value.type}\"/>`;\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_NAME_${key}\" name=\"${prefix}[MEMBERS][${key}][NAME]\" value=\"${value.nameFormatted}\"/>`;\n\t\t\t});\n\n\t\t\tObject.keys(attachments).forEach((id) => {\n\t\t\t\tattachmentsLayout += `<input type=\"hidden\" id=\"ATTACHMENTS_${id}\" name=\"${prefix}[ATTACHMENTS][${id}]\" value=\"${attachments[id]}\"/>`;\n\t\t\t});\n\n\t\t\tconst requestLayout = Tag.render`\n\t\t\t\t<div id=\"request_${nodeId}\">\n\t\t\t\t\t<input type=\"hidden\" id=\"NODE_ID\" name=\"${prefix}[NODE_ID]\" value=\"${nodeId}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_NODE_ID\" name=\"${prefix}[PARENT_NODE_ID]\" value=\"${this.getParent().getNodeId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"ID\" name=\"${prefix}[ID]\" value=\"${this.fields.getId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"COPIED_ID\" name=\"${prefix}[COPIED_ID]\" value=\"${this.fields.getCopiedId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_ID\" name=\"${prefix}[PARENT_ID]\" value=\"${this.fields.getParentId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TITLE\" name=\"${prefix}[TITLE]\" value=\"${this.fields.getTitle()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"SORT_INDEX\" name=\"${prefix}[SORT_INDEX]\" value=\"${this.fields.getSortIndex()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_COMPLETE\" name=\"${prefix}[IS_COMPLETE]\" value=\"${this.fields.getIsComplete()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_IMPORTANT\" name=\"${prefix}[IS_IMPORTANT]\" value=\"${this.fields.getIsImportant()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"MODIFY\" name=\"${prefix}[ACTION][MODIFY]\" value=\"${this.checkCanUpdate()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"REMOVE\" name=\"${prefix}[ACTION][REMOVE]\" value=\"${this.checkCanRemove()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TOGGLE\" name=\"${prefix}[ACTION][TOGGLE]\" value=\"${this.checkCanToggle()}\"/>\n\t\t\t\t\t${membersLayout}\n\t\t\t\t\t${attachmentsLayout}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.remove(this.container.querySelector(`#request_${nodeId}`));\n\t\t\tDom.append(requestLayout, this.container);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.appendRequestLayout();\n\t\t});\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst searchId = this.fields.getId() || this.fields.getCopiedId();\n\t\tconst {optionManager} = this;\n\t\tconst optionAttachments = optionManager.attachments;\n\t\tlet attachmentsLayout = '';\n\n\t\tif (optionAttachments && (searchId in optionAttachments))\n\t\t{\n\t\t\tconst attachments = Tag.render`${optionAttachments[searchId]}`;\n\t\t\tconst stableAttachments = this.getStableAttachments(optionManager.getStableTreeStructure());\n\t\t\tconst attachmentsToDelete = [];\n\n\t\t\tif (!attachments)\n\t\t\t{\n\t\t\t\treturn attachmentsLayout;\n\t\t\t}\n\n\t\t\tattachmentsLayout = attachments;\n\n\t\t\tif (!Array.isArray(attachments))\n\t\t\t{\n\t\t\t\tattachmentsLayout = [attachments];\n\t\t\t}\n\n\t\t\tObject.keys(attachmentsLayout).forEach((key) => {\n\t\t\t\tconst attachment = attachmentsLayout[key];\n\t\t\t\tconst fileId = attachment.getAttribute('data-bx-id');\n\t\t\t\tconst extension = CheckListItem.getFileExtension(attachment.getAttribute('data-bx-extension'));\n\t\t\t\tconst extensionClass = `ui-icon-file-${extension}`;\n\t\t\t\tconst iconContainer = attachment.querySelector(`#disk-attach-file-${fileId}`);\n\t\t\t\tconst deleteButton = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\"\n\t\t\t\t\t\t onclick=\"${this.onDeleteAttachmentClick.bind(this, fileId)}\"></div>\n\t\t\t\t`;\n\t\t\t\tconst has = Object.prototype.hasOwnProperty;\n\n\t\t\t\tif (!has.call(stableAttachments, fileId))\n\t\t\t\t{\n\t\t\t\t\tattachmentsToDelete.push(key);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (iconContainer && !Dom.hasClass(iconContainer, extensionClass))\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(iconContainer, extensionClass);\n\t\t\t\t}\n\n\t\t\t\tif (this.checkCanUpdate())\n\t\t\t\t{\n\t\t\t\t\tDom.append(deleteButton, attachment.querySelector('.tasks-checklist-item-attachment-file-cover'));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tattachmentsToDelete.sort((a, b) => b - a);\n\t\t\tattachmentsToDelete.forEach((id) => {\n\t\t\t\tattachmentsLayout.splice(id, 1);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setAttachments({});\n\t\t}\n\n\t\treturn attachmentsLayout;\n\t}\n\n\tgetStableAttachments(item)\n\t{\n\t\tconst fields = item.FIELDS;\n\t\tconst id = fields.id || fields.copiedId;\n\n\t\tif (id === this.fields.getId() || id === this.fields.getCopiedId())\n\t\t{\n\t\t\treturn fields.attachments;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.getStableAttachments(descendant);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tgetLoadedAttachmentLayout(attachment)\n\t{\n\t\tconst {id, name, viewUrl, size, ext} = attachment;\n\t\tlet img = '';\n\n\t\tif (viewUrl)\n\t\t{\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\" style=\"background-image: url(${viewUrl})\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(this, id)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst extension = CheckListItem.getFileExtension(ext);\n\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\">\n\t\t\t\t\t<div class=\"ui-icon ui-icon-file-${extension}\"><i></i></div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(this, id)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\" data-bx-id=\"${id}\">\n\t\t\t\t${img}\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonAttachmentsLoaderMenuItemClick()\n\t{\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\tgetAttachmentsLoaderLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst {prefix} = this.optionManager;\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t\t<div id=\"diskuf-selectdialog-${nodeId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t\t<div class=\"diskuf-files-block tasks-checklist-loader-files\">\n\t\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t\t<input type=\"hidden\" name=\"${prefix}[${nodeId}][UF_CHECKLIST_FILES][]\" value=\"\"/>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t\t<label for=\"file_loader_${nodeId}\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${nodeId}\" type=\"file\"\n\t\t\t\t\t\t\t\t   multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.OnFileUploadSuccess.bind(this));\n\t\tBX.addCustomEvent(filesChooser, 'DiskDLoadFormControllerInit', (uf) => {\n\t\t\tuf._onUploadProgress = this.onUploadProgress.bind(this);\n\t\t});\n\n\t\treturn filesChooser;\n\t}\n\n\tonUploadProgress(item, progress)\n\t{\n\t\tconst {id, name, size} = item;\n\t\tconst newProgress = Math.min(progress, 98);\n\n\t\tif (!this.filesLoaderProgressBars.has(id))\n\t\t{\n\t\t\tconst myProgress = new BX.UI.ProgressRound({\n\t\t\t\tid: `load_progress_${id}`,\n\t\t\t\tvalue: newProgress,\n\t\t\t\tmaxValue: 100,\n\t\t\t\twidth: 69,\n\t\t\t\tlineSize: 5,\n\t\t\t\tfill: false,\n\t\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t\t\tstatusType: BX.UI.ProgressRound.Status.INCIRCLE,\n\t\t\t});\n\t\t\tconst filePreview = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\">\n\t\t\t\t\t${myProgress.getContainer()}\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.filesLoaderProgressBars.set(id, myProgress);\n\t\t\tDom.append(filePreview, this.getAttachmentsContainer());\n\t\t}\n\n\t\tif (!item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = 5;\n\t\t}\n\n\t\tif (newProgress > item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = Math.ceil(newProgress);\n\t\t\titem.progressBarWidth = item.progressBarWidth > 100 ? 100 : item.progressBarWidth;\n\n\t\t\tif (this.filesLoaderProgressBars.has(id))\n\t\t\t{\n\t\t\t\tthis.filesLoaderProgressBars.get(id).update(item.progressBarWidth);\n\t\t\t}\n\t\t}\n\t}\n\n\tOnFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst attachmentId = fileResult.element_id.toString();\n\t\tconst attachment = {\n\t\t\tid: attachmentId,\n\t\t\tname: fileResult.element_name,\n\t\t\tviewUrl: fileResult.element_url,\n\t\t\tsize: uploaderFile.size,\n\t\t\text: uploaderFile.ext,\n\t\t};\n\n\t\tthis.fields.addAttachments({[attachmentId]: attachmentId});\n\t\tthis.filesLoaderProgressBars.delete(uploaderFile.id);\n\n\t\tconst attachmentProgress = this.getAttachmentsContainer().querySelector(`#disk-attach-${uploaderFile.id}`);\n\t\tconst attachmentLayout = this.getLoadedAttachmentLayout(attachment);\n\n\t\tif (attachmentProgress)\n\t\t{\n\t\t\tDom.replace(attachmentProgress, attachmentLayout);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(attachmentLayout, this.getAttachmentsContainer());\n\t\t}\n\n\t\tconst id = this.fields.getId();\n\t\tconst optionAttachments = this.optionManager.attachments;\n\n\t\tif (optionAttachments)\n\t\t{\n\t\t\tif (id in optionAttachments)\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] += attachmentLayout.outerHTML;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] = attachmentLayout.outerHTML;\n\t\t\t}\n\t\t}\n\n\t\tEvent.EventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'fileUpload'});\n\t}\n\n\tgetTaskRootLayout(children)\n\t{\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-task-root\">\n\t\t\t\t<div id=\"subItems_${this.getNodeId()}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst value = this.fields.getCompletedCount();\n\t\tconst maxValue = this.fields.getTotalCount();\n\t\tconst layouts = {\n\t\t\tlistActionsPanel: Tag.render`<div class=\"tasks-checklist-items-list-actions droppable\"></div>`,\n\t\t\tgroupButton: '',\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-wrapper-dragndrop\"></div>`,\n\t\t};\n\n\t\tif (this.checkCanAdd())\n\t\t{\n\t\t\tconst addButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-add-btn\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tconst groupButton = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-action-group-btn\" onclick=\"${this.onGroupButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_GROUP_ACTIONS')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.append(addButtonLayout, layouts.listActionsPanel);\n\t\t\tlayouts.groupButton = groupButton;\n\t\t}\n\n\t\tif (this.checkCanRemove())\n\t\t{\n\t\t\tconst removeButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-remove-btn\" onclick=\"${this.onDeleteClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_DELETE_CHECKLIST')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tDom.append(removeButtonLayout, layouts.listActionsPanel);\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressBar({\n\t\t\tvalue,\n\t\t\tmaxValue,\n\t\t\tsize: BX.UI.ProgressBar.Size.MEDIUM,\n\t\t\ttextAfter: CheckListItem.getProgressText(value, maxValue),\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-wrapper tasks-checklist-item-group-editor-collapse\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-header-wrapper droppable\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-header-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-header-inner\">\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name\" onclick=\"${this.onHeaderNameClick.bind(this)}\">\n\t\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name-edit-btn\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress-block\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-header-actions\">\n\t\t\t\t\t\t${layouts.groupButton}\n\t\t\t\t\t\t<div class=\"tasks-checklist-action-collapse-btn collapsed\" onclick=\"${this.onCollapseButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-items-wrapper\">\n\t\t\t\t\t<div class=\"tasks-checklist-items-list\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${layouts.listActionsPanel}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst layouts = {\n\t\t\tdeleteButton: Tag.render`<button class=\"tasks-checklist-item-remove\" onclick=\"${this.onDeleteClick.bind(this)}\"/>`,\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-item-dragndrop\"></div>`,\n\t\t\tattachments: this.getAttachmentsLayout(),\n\t\t};\n\n\t\tif (!this.checkCanRemove())\n\t\t{\n\t\t\tlayouts.deleteButton = '';\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-item-inner droppable ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\"\n\t\t\t\t\t onclick=\"${this.onInnerContainerClick.bind(this)}\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"/>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.fields.getIsImportant() ? this.getImportantLayout() : ''}\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-description\">\n\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-additional-block\">\n\t\t\t\t\t\t${layouts.deleteButton}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-actions-block\">\n\t\t\t\t\t\t<input class=\"tasks-checklist-item-group-checkbox\" id=\"select_${nodeId}\" type=\"checkbox\"\n\t\t\t\t\t\t\t   onclick=\"${this.onSelectCheckboxClick.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-list\" id=\"attachments_${nodeId}\">\n\t\t\t\t\t\t${layouts.attachments}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-sublist-items-wrapper\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetLayout()\n\t{\n\t\tconst children = [];\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tchildren.push(descendant.getLayout());\n\t\t});\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\treturn this.getTaskRootLayout(children);\n\t\t}\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tconst checkListLayout = this.getCheckListLayout(children);\n\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\treturn checkListLayout;\n\t\t}\n\n\t\treturn this.getCheckListItemLayout(children);\n\t}\n}\n\nclass MobileCheckListItem extends CheckListItem\n{\n\tclass = MobileCheckListItem;\n\n\tcheckedClass = 'mobile-task-checklist-item-checked';\n\thiddenClass = 'mobile-task-checklist-item-hidden';\n\tcollapseClass = 'mobile-task-checklist-section-collapse';\n\twrapperClass = 'mobile-task-checklist-wrapper';\n\n\tshowClass = 'mobile-checklist-item-show';\n\thideClass = 'mobile-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.mobile-task-checklist-item-checker',\n\t\t\t'.mobile-task-checklist-item-param',\n\t\t\t'.mobile-task-checklist-item-controls',\n\t\t],\n\t};\n\n\tstatic makeDangerElement(element)\n\t{\n\t\tconst dangerClass = 'mobile-task-checklist-error';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: {},\n\t\t\tATTACHMENTS: this.fields.getAttachments() || {},\n\t\t};\n\t\tconst membersTypes = {\n\t\t\taccomplice: 'A',\n\t\t\tauditor: 'U',\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\titemRequestData.MEMBERS[key] = {TYPE: membersTypes[value.type]};\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tonChecklistAjaxError()\n\t{\n\t\tBXMobileApp.Events.postToComponent('onChecklistAjaxError', {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\ttaskGuid: this.optionManager.taskGuid,\n\t\t}, 'tasks.view');\n\t}\n\n\tsendAddAjaxAction()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst fields = this.getItemRequestData();\n\t\t\tconst parent = this.getParent();\n\n\t\t\tfields.PARENT_ID = parent.fields.getId() || (parent.isTaskRoot() ? 0 : null);\n\n\n\t\t\tBX.ajax.runAction('tasks.task.checklist.add', {\n\t\t\t\tdata: {\n\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\tfields,\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tif (response.status === 'success')\n\t\t\t\t{\n\t\t\t\t\tconst {checkListItem} = response.data;\n\t\t\t\t\tthis.fields.setId(checkListItem.id);\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t}).catch(() => {\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\t}\n\n\tsendUpdateAjaxAction(fields, onFailCallback = null)\n\t{\n\t\tconst onFailFunction = onFailCallback || this.onChecklistAjaxError.bind(this);\n\n\t\tBX.ajax.runAction('tasks.task.checklist.update', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tfields,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tonFailFunction();\n\t\t\t}\n\t\t}).catch(() => onFailFunction());\n\t}\n\n\tsendRemoveAjaxAction()\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.delete', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tsendMembersAddAjaxAction(member, focusInput)\n\t{\n\t\tconst map = {\n\t\t\tauditor: {\n\t\t\t\tactionName: 'addAuditors',\n\t\t\t\tparamName: 'auditorsIds',\n\t\t\t\tletter: 'U',\n\t\t\t},\n\t\t\taccomplice: {\n\t\t\t\tactionName: 'addAccomplices',\n\t\t\t\tparamName: 'accomplicesIds',\n\t\t\t\tletter: 'A',\n\t\t\t},\n\t\t};\n\t\tconst currentType = map[member.type];\n\n\t\tconst toChecklistAddAction = 'tasks.task.checklist.addMembers';\n\t\tconst toChecklistAddData = {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\tmembers: {[member.id]: currentType.letter},\n\t\t};\n\n\t\tBX.ajax.runAction(toChecklistAddAction, {data: toChecklistAddData}).then((toChecklistAddResponse) => {\n\t\t\tif (toChecklistAddResponse.status === 'success')\n\t\t\t{\n\t\t\t\tif (focusInput)\n\t\t\t\t{\n\t\t\t\t\tthis.toggleUpdateMode();\n\t\t\t\t}\n\n\t\t\t\tBX.ajax.runAction(`tasks.task.${currentType.actionName}`, {data: {\n\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\t[currentType.paramName]: [member.id],\n\t\t\t\t}});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.fields.removeMember(member.id);\n\t\t\t}\n\t\t}).catch(() => this.fields.removeMember(member.id));\n\t}\n\n\tsendMoveAfterAjaxAction(afterItem)\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.moveAfter', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tafterItemId: afterItem.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tgetPopupMenuItems()\n\t{\n\t\tconst locPrefix = 'TASKS_CHECKLIST_MOBILE_POPUP_MENU_';\n\t\tconst popupMenuItems = [];\n\t\tconst popupMenuItemsBuildMap = {\n\t\t\tchecklist: {\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\trename: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}RENAME`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-rename.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t\tchecklistItem: {\n\t\t\t\taddFile: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_FILE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-file.png',\n\t\t\t\t},\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\ttabIn: {\n\t\t\t\t\tcondition: this.checkCanTabIn.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_IN`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-in.png',\n\t\t\t\t},\n\t\t\t\ttabOut: {\n\t\t\t\t\tcondition: this.checkCanTabOut.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_OUT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-out.png',\n\t\t\t\t},\n\t\t\t\timportant: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}IMPORTANT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-important.png',\n\t\t\t\t},\n\t\t\t\ttoAnotherChecklist: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TO_ANOTHER_CHECKLIST`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-to-another-checklist.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tconst type = (this.isCheckList() ? 'checklist' : 'checklistItem');\n\n\t\tObject.keys(popupMenuItemsBuildMap[type]).forEach((id) => {\n\t\t\tconst {sectionCode, title, iconUrl, condition} = popupMenuItemsBuildMap[type][id];\n\t\t\tpopupMenuItems.push({id, sectionCode, title, iconUrl, disable: !condition()});\n\t\t});\n\n\t\treturn popupMenuItems;\n\t}\n\n\tgetPopupChecklistsList()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\t\tconst popupChecklistsList = [];\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupChecklistsList.push({\n\t\t\t\tid: descendant.getNodeId(),\n\t\t\t\ttitle: descendant.fields.getDisplayTitle(),\n\t\t\t\tsectionCode: '0',\n\t\t\t});\n\t\t});\n\t\tpopupChecklistsList.push({\n\t\t\tid: 'newChecklist',\n\t\t\ttitle: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tsectionCode: '0',\n\t\t});\n\n\t\treturn popupChecklistsList;\n\t}\n\n\tonMemberSelectedEvent(eventData)\n\t{\n\t\tconst {nodeId, member, position, focusInput} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst displayTitle = node.fields.getDisplayTitle();\n\t\tlet newTitle = '';\n\n\t\tmember.nameFormatted = Text.encode(member.nameFormatted);\n\n\t\tif (focusInput)\n\t\t{\n\t\t\tconst start = position || 0;\n\t\t\tconst startSpace = (start === 0 || start - 1 === 0 || displayTitle.charAt(start - 2) === ' ') ? '' : ' ';\n\t\t\tconst endSpace = (displayTitle.charAt(start - 1) === ' ' ? '' : ' ');\n\t\t\tconst newInputText = `${displayTitle.slice(0, start - 1)}${startSpace}${member.nameFormatted}${endSpace}`;\n\t\t\tnewTitle = `${newInputText}${displayTitle.slice(start)}`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst space = (displayTitle.slice(-1) === ' ' ? '' : ' ');\n\t\t\tnewTitle = `${displayTitle}${space}${member.nameFormatted}`.substring(0, 255);\n\t\t}\n\n\t\tnode.fields.addMember(member);\n\t\tnode.updateTitle(newTitle);\n\t\tnode.updateDisplayTitle(newTitle);\n\n\t\tif (!this.checkEditMode())\n\t\t{\n\t\t\tnode.sendUpdateAjaxAction({TITLE: Text.decode(node.fields.getTitle())});\n\t\t\tnode.sendMembersAddAjaxAction(member, focusInput);\n\t\t}\n\t\telse if (focusInput)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonAddAttachmentEvent(eventData)\n\t{\n\t\tconst {nodeId, attachment} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tconst key = Object.keys(attachment)[0];\n\t\t\tconst value = Object.values(attachment)[0];\n\n\t\t\tnode.fields.addAttachments({[`n${key}`]: value});\n\t\t}\n\t}\n\n\tonRemoveAttachmentEvent(eventData)\n\t{\n\t\tconst {nodeId, attachmentId} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.fields.removeAttachment(attachmentId);\n\t\t\tnode.fields.removeAttachment(`n${attachmentId}`);\n\t\t}\n\t}\n\n\tgetFakeAttachmentsCount(filesToRemove, filesToAdd)\n\t{\n\t\tconst attachmentsIds = Object.keys(this.fields.getAttachments());\n\t\tconst countWithRemovable = attachmentsIds.filter(id => !filesToRemove.includes(id)).length;\n\n\t\treturn countWithRemovable + filesToAdd.length;\n\t}\n\n\tsetLayoutAttachmentsCount(attachmentsCount)\n\t{\n\t\tconst newAttachmentsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(this)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t\tDom.replace(this.getAttachmentsContainer(), newAttachmentsLayout);\n\t}\n\n\tupdateNodeAttachments(filesToRemove, filesToAdd, attachments = null)\n\t{\n\t\tif (attachments)\n\t\t{\n\t\t\tthis.fields.setAttachments(attachments);\n\t\t}\n\n\t\tconst fakeAttachmentsCount = this.getFakeAttachmentsCount(filesToRemove, filesToAdd);\n\t\tthis.setLayoutAttachmentsCount(fakeAttachmentsCount);\n\t}\n\n\tonAttachFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, attachments, checkListItemId} = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonRemoveFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, attachments} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonFakeAttachFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, checkListItemId} = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonFakeRemoveFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonRenameEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonRemoveEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tif (!this.checkEditMode() && node.fields.getId())\n\t\t\t{\n\t\t\t\tnode.sendRemoveAjaxAction();\n\t\t\t}\n\t\t\tnode.deleteAction(false);\n\t\t\tnode.getParent().updateIndexes();\n\t\t\tnode.handleCheckListChanges();\n\t\t}\n\t}\n\n\tonTabInEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabIn())\n\t\t{\n\t\t\tnode.tabIn();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst fields = {\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t};\n\t\t\t\t\tconst onFailCallback = () => { node.tabOut(); };\n\n\t\t\t\t\tnode.sendUpdateAjaxAction(fields, onFailCallback);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonTabOutEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabOut())\n\t\t{\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnode.sendMoveAfterAjaxAction(node.getParent());\n\t\t\t}\n\t\t\tnode.tabOut();\n\t\t}\n\t}\n\n\tonImportantEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleImportant();\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tconst onFailCallback = () => { node.toggleImportant(); };\n\t\t\t\tnode.sendUpdateAjaxAction({IS_IMPORTANT: node.fields.getIsImportant()}, onFailCallback);\n\t\t\t}\n\t\t}\n\t}\n\n\tonToAnotherCheckListEvent(eventData)\n\t{\n\t\tconst {nodeId, checklistId} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (checklistId === 'newChecklist')\n\t\t{\n\t\t\tnode.moveToNewCheckList(this.getDescendantsCount() + 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.makeChildOf(this.findChild(checklistId));\n\t\t\tnode.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnode.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetNativeComponentName()\n\t{\n\t\treturn (this.checkEditMode() ? 'tasks.edit' : 'tasks.view');\n\t}\n\n\tcheckEditMode()\n\t{\n\t\treturn this.optionManager.isEditMode();\n\t}\n\n\tcheckCanTabIn()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.isFirstDescendant();\n\t}\n\n\tcheckCanTabOut()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.getParent().isCheckList();\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\t// no editor panel in mobile version\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn this.isCheckList() ? 'mobile-task-checklist-head-title-text' : 'mobile-task-checklist-item-text';\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.mobile-task-checklist-head-title' : '.mobile-task-checklist-item');\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new MobileCheckListItem({TITLE: title, DISPLAY_TITLE: title});\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tthis.makeChildOf(newCheckList);\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnewCheckList.sendAddAjaxAction().then(() => {\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: this.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}, () => {});\n\t\t\t}\n\t\t});\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.removeClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.addClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tif (!this.checkEditMode() && this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tthis.sendRemoveAjaxAction();\n\t\t\t\t}\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tMobileCheckListItem.makeDangerElement(input.parentElement);\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tconst itemRequestData = this.getItemRequestData();\n\t\t\t\t\tconst members = itemRequestData.MEMBERS;\n\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tTITLE: itemRequestData.TITLE,\n\t\t\t\t\t\tMEMBERS: (Object.keys(members).length > 0 ? members : ''),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.sendAddAjaxAction().then(() => {}, () => {});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonInput(e)\n\t{\n\t\tconst memberSelectorCallKeys = ['@', '+'];\n\t\tconst position = CheckListItem.getInputSelection(this.input).start;\n\n\t\tif (memberSelectorCallKeys.includes(e.data) && this.checkCanAddAccomplice())\n\t\t{\n\t\t\tconst params = {\n\t\t\t\tposition,\n\t\t\t\tnodeId: this.getNodeId(),\n\t\t\t};\n\t\t\tBXMobileApp.Events.postToComponent('onChecklistInputMemberSelectorCall', params, this.getNativeComponentName());\n\t\t}\n\t}\n\n\tonInputKeyPressed(e)\n\t{\n\t\tconst keys = {\n\t\t\tenter: 13,\n\t\t};\n\n\t\tif (e.keyCode === keys.enter)\n\t\t{\n\t\t\tthis.toggleUpdateMode(e);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tgetParamsForMobileEvent(type)\n\t{\n\t\tif (!['settings', 'attachments'].includes(type))\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tconst {entityId, entityType, taskGuid, diskOptions, mode} = this.optionManager;\n\t\tconst defaultParams = {\n\t\t\ttaskGuid,\n\t\t\ttaskId: entityId,\n\t\t\tnodeId: this.getNodeId(),\n\t\t\tdisk: diskOptions,\n\t\t\tajaxData: {\n\t\t\t\tentityId,\n\t\t\t\tmode,\n\t\t\t\tcheckListItemId: (this.checkEditMode() ? this.getNodeId() : this.fields.getId()),\n\t\t\t\tentityTypeId: `${entityType.toLowerCase()}Id`,\n\t\t\t},\n\t\t};\n\t\tlet localParams = {};\n\n\t\tif (type === 'settings')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tpopupChecklists: this.getPopupChecklistsList(),\n\t\t\t\tpopupMenuItems: this.getPopupMenuItems(),\n\t\t\t\tpopupMenuSections: [{id: '0', title: Text.decode(this.fields.getDisplayTitle())}],\n\t\t\t};\n\t\t}\n\t\telse if (type === 'attachments')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tattachmentsIds: Object.keys(this.fields.getAttachments()),\n\t\t\t\tcanUpdate: this.checkCanUpdate(),\n\t\t\t};\n\t\t}\n\n\t\treturn {...defaultParams, ...localParams};\n\t}\n\n\tonAttachmentsLayoutClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('attachments');\n\t\tBXMobileApp.Events.postToComponent('onChecklistAttachmentsClick', params, this.getNativeComponentName());\n\t}\n\n\tonSettingsClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('settings');\n\t\tBXMobileApp.Events.postToComponent('onChecklistSettingsClick', params, this.getNativeComponentName());\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"mobile-task-checklist-head-title mobile-task-checklist-item-edit-mode\">\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   value=\"${this.fields.getDisplayTitle()}\"\n\t\t\t\t\t\t   oninput=\"${this.onInput.bind(this)}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item mobile-task-checklist-item-edit-mode ${this.fields.getIsComplete() ? this.checkedClass : ''}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item-checker\">\n\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t   value=\"${this.fields.getDisplayTitle()}\"\n\t\t\t\t\t\t   oninput=\"${this.onInput.bind(this)}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst attachmentsCount = Object.keys(this.fields.getAttachments()).length;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(this)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\t\tconst addButtonLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-add-button\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t<div class=\"mobile-task-checklist-add-text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\tstatusType: BX.UI.ProgressRound.Status.COUNTER,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-section\" id=\"${nodeId}\" data-role=\"mobile-task-checklist\">\n\t\t\t\t<div class=\"mobile-task-checklist-head\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-counter\">\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-counter-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-head-title\" onclick=\"${this.onHeaderNameClick.bind(this)}\">\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-visible\"\n\t\t\t\t\t\t\t onclick=\"${this.onCollapseButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-wrapper\">\n\t\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.checkCanAdd() ? addButtonLayout : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-wrapper\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item ${this.fields.getIsComplete() ? this.checkedClass : ''} ${this.fields.getIsImportant() ? 'mobile-task-checklist-item-important' : ''}\"\n\t\t\t\t\t onclick=\"${this.onInnerContainerClick.bind(this)}\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-checker\" id=\"progress_${nodeId}\"\n\t\t\t\t\t\t onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.getAttachmentsLayout()}\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n}\n\nexport {CheckListItem, MobileCheckListItem};"],"names":["TreeItem","Math","random","toString","substr","setNodeId","generateUniqueNodeId","setParent","parent","getParent","nodeId","CompositeTreeItem","descendants","item","position","push","splice","after","index","findIndex","descendant","add","before","length","getFirstDescendant","getLastDescendant","isFirstDescendant","parentDescendants","getDescendants","isLastDescendants","getNodeId","found","forEach","findChild","size","getDescendantsCount","countTreeSize","getRootNode","CheckListItemFields","string","camelCaseString","Type","isString","toLowerCase","replace","match","chr","toUpperCase","snakeCaseString","fields","id","parentId","title","sortIndex","displayTitle","displaySortIndex","isComplete","isImportant","isSelected","isCollapse","completedCount","totalCount","members","Map","attachments","setFields","Object","keys","name","camelCaseName","snakeToCamelCase","indexOf","snakeCaseName","camelToSnakeCase","setMethod","bind","copiedId","types","A","U","clear","NAME","TYPE","set","nameFormatted","Text","encode","type","member","delete","CheckListItem","element","dangerClass","Dom","hasClass","addClass","oldParent","newParent","updateCounts","updateProgress","updateIndexes","completed","total","replaces","progressText","Loc","getMessage","search","ext","fileExtension","input","start","end","normalizedValue","range","textInputRange","len","endRange","selectionStart","selectionEnd","document","selection","createRange","parentElement","value","createTextRange","moveToBookmark","getBookmark","collapse","compareEndPoints","moveStart","slice","split","moveEnd","defaultDisplayTitle","itemNumber","node","posFrom","BX","GetWindowScrollPos","scrollTop","posTo","pos","top","round","GetWindowInnerSize","innerHeight","toBottom","distance","abs","speed","step","posCurrent","timer","i","setTimeout","action","header","canUpdate","MODIFY","canRemove","REMOVE","canToggle","TOGGLE","canDrag","DRAG","panel","progress","filesLoaderPopup","filesLoaderProgressBars","updateMode","optionManager","isTaskRoot","getId","findById","recursively","getIsComplete","countCompletedCount","countTotalCount","setCompletedCount","setTotalCount","updateCompletedCount","updateTotalCount","getTotalCount","getCompletedCount","setMaxValue","update","isCheckList","updateProgressText","getProgressText","setTextAfter","layout","style","overflow","height","opacity","showClass","scrollHeight","hideClass","remove","setDefaultStyles","container","paddingTop","getSortIndex","addCheckListItem","showBalloon","getTitle","data","getNotificationBalloon","Event","EventEmitter","emit","e","preventDefault","hide","checkSelectedItems","items","getSelectedItems","runForEachSelectedItem","setIsSelected","deleteAction","handleCheckListChanges","actions","content","events","click","event","balloon","close","restore","handleTaskOptions","Tag","render","avatar","loadExt","then","UI","Notification","Center","notify","rootNode","moveToNewCheckList","PopupMenuWindow","target","getToAnotherCheckListPopupItems","autoHide","closeByEsc","offsetLeft","offsetWidth","angle","onPopupClose","destroy","show","selectMode","popupMenuItems","toNewCheckListMenuItem","text","message","onclick","getMenuWindow","getDisplayTitle","selectedItem","makeChildOf","unselectAll","delimiter","checkList","getCheckList","checkLists","filter","handleUpdateEnding","number","newCheckList","TITLE","DISPLAY_TITLE","memberSelector","space","newTitle","substring","addMember","updateTitle","updateDisplayTitle","inputText","mentioned","inputCursorPosition","startSpace","charAt","endSpace","newInputText","decode","retrieveFocus","auditor","resultAuditor","processMemberSelect","accomplice","resultAccomplice","memberType","checkCanAddAccomplice","typeFunctionMap","onSocNetSelectorAuditorSelected","onSocNetSelectorAccompliceSelected","typeFunction","Tasks","Integration","Socialnetwork","NetworkSelector","scope","mode","useSearch","useAdd","controlBind","bindEvent","isSelectorLoading","open","getMemberSelector","prefix","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","PopupWindow","getAttachmentsLoaderLayout","bindElement","setBindElement","Disk","UF","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","querySelector","fileId","removeAttachment","getAttachmentsContainer","membersLayout","onAddAuditorClick","onAddAccompliceClick","attachmentButtonLayout","onUploadAttachmentClick","itemsActionButtonsLayout","onTabInClick","onTabOutClick","getIsImportant","onImportantClick","onToAnotherCheckListClick","onDeleteClick","setTitle","oldTitleNode","getTitleNodeContainer","newTitleNode","getTitleLayout","setDisplayTitle","userPath","getDefaultDisplayTitle","getMembers","regExp","RegExp","href","url","getTitleNodeClass","membersToDelete","removeMember","updateSortIndexes","updateDisplaySortIndexes","setSortIndex","parentSortIndex","getDisplaySortIndex","localSortIndex","newSortIndex","setDisplaySortIndex","innerText","userId","showCompleted","showOnlyMine","hideByCondition","hasUserInMembers","has","condition","checkCanHide","canHide","checkActiveUpdateExist","getIsSelected","toggleGroup","disableAllUpdateModes","getInputSelection","focus","setSelectionRange","onInputKeyPressed","rememberInputState","clearInput","progressBarLayout","ProgressRound","maxValue","width","lineSize","fill","color","Color","PRIMARY","onCompleteButtonClick","getContainer","onInputKeyDown","nodeToPosition","getPosition","getPanelBodyLayout","left","append","body","isShown","right","viewModeLayout","getInnerContainer","updateModeLayout","getUpdateModeLayout","hiddenClass","insertBefore","showEditorPanel","currentInner","trim","processMembersFromText","removeClass","nextElementSibling","getAttachments","createNewItem","checkCanDeleteOnUpdateEnding","handleCheckListIsEmpty","makeDangerElement","disableUpdateMode","keyCode","disableAllGroup","enableUpdateMode","enter","plus","atsign","toggleUpdateMode","shiftKey","defaultMemberSelectorType","checkCanUpdate","checkSkipUpdate","toggleSelect","setIsImportant","getImportantLayout","callback","reverse","selectedItems","toggleImportant","panelImportantButton","closest","toggleClass","checkCanToggle","toggleComplete","setIsComplete","checkedClass","runAjaxToggleComplete","ajaxActions","entityId","entityType","stableTreeStructure","actionName","COMPLETE","RENEW","checkListItemId","ajax","runAction","response","checkListItem","updateStableTreeStructure","FIELDS","DESCENDANTS","checkBox","checked","selected","getSelected","getIsCollapse","toggleCollapse","collapseFreezed","wrapperList","wrapperClass","wrapperListHeight","collapseClass","setIsCollapse","setAutoHeight","unbind","checkListIsComplete","checkIsComplete","checkListIsEmpty","toggleEmpty","handleCheckListIsComplete","area","skipUpdateClasses","find","getCanAdd","getCanAddAccomplice","addBefore","addAfter","updateParents","insertAfter","borderItems","bottom","move","getSubItemsContainer","getLeftSibling","tabIn","tabOut","dependsOn","itemGet","class","Promise","resolve","newCheckListItem","newCheckListItemLayout","getLayout","smoothScroll","itemRequestData","NODE_ID","PARENT_NODE_ID","ID","COPIED_ID","getCopiedId","PARENT_ID","getParentId","SORT_INDEX","IS_COMPLETE","IS_IMPORTANT","MEMBERS","ATTACHMENTS","key","inputData","getItemRequestData","getRequestData","attachmentsLayout","requestLayout","checkCanRemove","appendRequestLayout","searchId","optionAttachments","stableAttachments","getStableAttachments","getStableTreeStructure","attachmentsToDelete","Array","isArray","attachment","getAttribute","extension","getFileExtension","extensionClass","iconContainer","deleteButton","onDeleteAttachmentClick","prototype","hasOwnProperty","call","sort","a","b","setAttachments","viewUrl","img","filesChooser","onAttachmentsLoaderMenuItemClick","addCustomEvent","OnFileUploadSuccess","uf","_onUploadProgress","onUploadProgress","newProgress","min","myProgress","statusType","Status","INCIRCLE","filePreview","progressBarWidth","ceil","get","fileResult","file","uploaderFile","attachmentId","element_id","element_name","element_url","addAttachments","attachmentProgress","attachmentLayout","getLoadedAttachmentLayout","outerHTML","children","layouts","listActionsPanel","groupButton","dndButton","checkCanAdd","addButtonLayout","onAddCheckListItemClick","onGroupButtonClick","removeButtonLayout","checkCanDrag","visibility","ProgressBar","Size","MEDIUM","textAfter","onHeaderNameClick","onCollapseButtonClick","getAttachmentsLayout","onInnerContainerClick","onSelectCheckboxClick","getTaskRootLayout","checkListLayout","getCheckListLayout","getCheckListItemLayout","MobileCheckListItem","membersTypes","BXMobileApp","Events","postToComponent","taskId","taskGuid","reject","status","setId","onChecklistAjaxError","catch","onFailCallback","onFailFunction","focusInput","map","paramName","letter","currentType","toChecklistAddAction","toChecklistAddData","toChecklistAddResponse","afterItem","afterItemId","locPrefix","popupMenuItemsBuildMap","checklist","addAuditor","sectionCode","iconUrl","addAccomplice","rename","checklistItem","addFile","checkCanTabIn","checkCanTabOut","important","toAnotherChecklist","disable","popupChecklistsList","eventData","checkEditMode","sendUpdateAjaxAction","sendMembersAddAjaxAction","values","filesToRemove","filesToAdd","attachmentsIds","countWithRemovable","includes","attachmentsCount","newAttachmentsLayout","onAttachmentsLayoutClick","fakeAttachmentsCount","getFakeAttachmentsCount","setLayoutAttachmentsCount","updateNodeAttachments","sendRemoveAjaxAction","sendMoveAfterAjaxAction","checklistId","isEditMode","sendAddAjaxAction","memberSelectorCallKeys","params","getNativeComponentName","diskOptions","defaultParams","disk","ajaxData","entityTypeId","localParams","popupChecklists","getPopupChecklistsList","getPopupMenuItems","popupMenuSections","getParamsForMobileEvent","onInput","Mobile","CheckList","settingsLayout","onSettingsClick","COUNTER"],"mappings":";;;;KAAMA;;;;;4CAGL;CACC,aAAOC,IAAI,CAACC,MAAL,GAAcC,QAAd,CAAuB,EAAvB,EAA2BC,MAA3B,CAAkC,CAAlC,EAAqC,CAArC,CAAP;CACA;;;CAED,sBACA;CAAA;CACC,SAAKC,SAAL,CAAeL,QAAQ,CAACM,oBAAT,EAAf;CACA,SAAKC,SAAL,CAAe,IAAf;CACA;;;;mCAGD;CACC,UAAIC,MAAM,GAAG,IAAb;;CAEA,aAAOA,MAAM,CAACC,SAAP,OAAuB,IAA9B,EACA;CACCD,QAAAA,MAAM,GAAGA,MAAM,CAACC,SAAP,EAAT;CACA;;CAED,aAAOD,MAAP;CACA;;;iCAGD;CACC,aAAO,KAAKE,MAAZ;CACA;;;+BAESA,QACV;CACC,WAAKA,MAAL,GAAcA,MAAd;CACA;;;iCAGD;CACC,aAAO,KAAKF,MAAZ;CACA;;;+BAESA,QACV;CACC,WAAKA,MAAL,GAAcA,MAAd;CACA;;;;;KCzCIG;;;;;CAEL,+BACA;CAAA;;CAAA;CACC;CACA,UAAKC,WAAL,GAAmB,EAAnB;CAFD;CAGC;;;;yBAEGC,MACJ;CAAA,UADUC,QACV,uEADqB,IACrB;CACCD,MAAAA,IAAI,CAACN,SAAL,CAAe,IAAf;;CAEA,UAAIO,QAAQ,KAAK,IAAjB,EACA;CACC,aAAKF,WAAL,CAAiBG,IAAjB,CAAsBF,IAAtB;CACA,OAHD,MAKA;CACC,aAAKD,WAAL,CAAiBI,MAAjB,CAAwBF,QAAxB,EAAkC,CAAlC,EAAqCD,IAArC;CACA;CACD;;;8BAEQA,MAAMI,OACf;CACC,UAAMC,KAAK,GAAG,KAAKN,WAAL,CAAiBO,SAAjB,CAA2B,UAAAC,UAAU;CAAA,eAAIA,UAAU,KAAKH,KAAnB;CAAA,OAArC,CAAd;;CACA,UAAIC,KAAK,KAAK,CAAC,CAAf,EACA;CACC,aAAKG,GAAL,CAASR,IAAT,EAAeK,KAAK,GAAG,CAAvB;CACA;CACD;;;+BAESL,MAAMS,QAChB;CACC,UAAMJ,KAAK,GAAG,KAAKN,WAAL,CAAiBO,SAAjB,CAA2B,UAAAC,UAAU;CAAA,eAAIA,UAAU,KAAKE,MAAnB;CAAA,OAArC,CAAd;;CACA,UAAIJ,KAAK,KAAK,CAAC,CAAf,EACA;CACC,aAAKG,GAAL,CAASR,IAAT,EAAeK,KAAf;CACA;CACD;;;4BAEML,MACP;CACC,UAAMK,KAAK,GAAG,KAAKN,WAAL,CAAiBO,SAAjB,CAA2B,UAAAC,UAAU;CAAA,eAAIA,UAAU,KAAKP,IAAnB;CAAA,OAArC,CAAd;;CACA,UAAIK,KAAK,KAAK,CAAC,CAAf,EACA;CACC,aAAKN,WAAL,CAAiBI,MAAjB,CAAwBE,KAAxB,EAA+B,CAA/B;CACA;CACD;;;sCAGD;CACC,aAAO,KAAKN,WAAZ;CACA;;;2CAGD;CACC,aAAO,KAAKA,WAAL,CAAiBW,MAAxB;CACA;;;0CAGD;CACC,UAAI,KAAKX,WAAL,CAAiBW,MAAjB,GAA0B,CAA9B,EACA;CACC,eAAO,KAAKX,WAAL,CAAiB,CAAjB,CAAP;CACA;;CAED,aAAO,KAAP;CACA;;;yCAGD;CACC,UAAI,KAAKA,WAAL,CAAiBW,MAAjB,GAA0B,CAA9B,EACA;CACC,eAAO,KAAKX,WAAL,CAAiB,KAAKA,WAAL,CAAiBW,MAAjB,GAA0B,CAA3C,CAAP;CACA;;CAED,aAAO,KAAP;CACA;;;yCAGD;CACC,aAAQ,SAAS,KAAKd,SAAL,GAAiBe,kBAAjB,EAAjB;CACA;;;yCAGD;CACC,aAAQ,SAAS,KAAKf,SAAL,GAAiBgB,iBAAjB,EAAjB;CACA;;;sCAGD;CAAA;;CACC,UAAI,KAAKC,iBAAL,EAAJ,EACA;CACC,eAAO,IAAP;CACA;;CAED,UAAMC,iBAAiB,GAAG,KAAKlB,SAAL,GAAiBmB,cAAjB,EAA1B;CACA,UAAMV,KAAK,GAAGS,iBAAiB,CAACR,SAAlB,CAA4B,UAAAC,UAAU;CAAA,eAAIA,UAAU,KAAK,MAAnB;CAAA,OAAtC,CAAd;;CAEA,UAAIF,KAAK,KAAK,CAAC,CAAf,EACA;CACC,eAAOS,iBAAiB,CAACT,KAAK,GAAG,CAAT,CAAxB;CACA;;CAED,aAAO,IAAP;CACA;;;uCAGD;CAAA;;CACC,UAAI,KAAKW,iBAAL,EAAJ,EACA;CACC,eAAO,IAAP;CACA;;CAED,UAAMF,iBAAiB,GAAG,KAAKlB,SAAL,GAAiBmB,cAAjB,EAA1B;CACA,UAAMV,KAAK,GAAGS,iBAAiB,CAACR,SAAlB,CAA4B,UAAAC,UAAU;CAAA,eAAIA,UAAU,KAAK,MAAnB;CAAA,OAAtC,CAAd;;CAEA,UAAIF,KAAK,KAAK,CAAC,CAAf,EACA;CACC,eAAOS,iBAAiB,CAACT,KAAK,GAAG,CAAT,CAAxB;CACA;;CAED,aAAO,IAAP;CACA;;;+BAESR,QACV;CACC,UAAI,CAACA,MAAL,EACA;CACC,eAAO,IAAP;CACA;;CAED,UAAI,KAAKoB,SAAL,GAAiB3B,QAAjB,OAAgCO,MAAM,CAACP,QAAP,EAApC,EACA;CACC,eAAO,IAAP;CACA;;CAED,UAAI4B,KAAK,GAAG,IAAZ;CACA,WAAKnB,WAAL,CAAiBoB,OAAjB,CAAyB,UAACZ,UAAD,EAAgB;CACxC,YAAIW,KAAK,KAAK,IAAd,EACA;CACCA,UAAAA,KAAK,GAAGX,UAAU,CAACa,SAAX,CAAqBvB,MAArB,CAAR;CACA;CACD,OALD;CAOA,aAAOqB,KAAP;CACA;;;qCAGD;CACC,UAAIG,IAAI,GAAG,KAAKC,mBAAL,EAAX;CAEA,WAAKvB,WAAL,CAAiBoB,OAAjB,CAAyB,UAACZ,UAAD,EAAgB;CACxCc,QAAAA,IAAI,IAAId,UAAU,CAACgB,aAAX,EAAR;CACA,OAFD;CAIA,aAAOF,IAAP;CACA;;;mCAGD;CACC,aAAO,KAAKG,WAAL,GAAmBD,aAAnB,KAAqC,CAA5C;CACA;;;GAlK8BpC;;KCA1BsC;;;;;sCAEmBC,QACxB;CACC,UAAIC,eAAe,GAAGD,MAAtB;;CAEA,UAAIE,cAAI,CAACC,QAAL,CAAcF,eAAd,CAAJ,EACA;CACCA,QAAAA,eAAe,GAAGA,eAAe,CAACG,WAAhB,EAAlB;CACAH,QAAAA,eAAe,GAAGA,eAAe,CAACI,OAAhB,CAAwB,cAAxB,EAAwC,UAACC,KAAD,EAAQC,GAAR;CAAA,iBAAiBA,GAAG,GAAGA,GAAG,CAACC,WAAJ,EAAH,GAAuB,EAA3C;CAAA,SAAxC,CAAlB;CAEA,eAAOP,eAAe,CAACpC,MAAhB,CAAuB,CAAvB,EAA0B,CAA1B,EAA6BuC,WAA7B,KAA6CH,eAAe,CAACpC,MAAhB,CAAuB,CAAvB,CAApD;CACA;;CAED,aAAOoC,eAAP;CACA;;;sCAEuBD,QACxB;CACC,UAAIS,eAAe,GAAGT,MAAtB;;CAEA,UAAIE,cAAI,CAACC,QAAL,CAAcM,eAAd,CAAJ,EACA;CACCA,QAAAA,eAAe,GAAGA,eAAe,CAACJ,OAAhB,CAAwB,aAAxB,EAAuC,OAAvC,EAAgDG,WAAhD,EAAlB;CACA;;CAED,aAAOC,eAAP;CACA;;;CAED,+BAAYC,MAAZ,EACA;CAAA;CACC,SAAKA,MAAL,GAAc,CACb,IADa,EAEb,UAFa,EAGb,UAHa,EAIb,OAJa,EAKb,WALa,EAMb,cANa,EAOb,kBAPa,EAQb,YARa,EASb,aATa,EAUb,YAVa,EAWb,YAXa,EAYb,gBAZa,EAab,YAba,EAcb,SAda,EAeb,aAfa,CAAd;CAkBA,SAAKC,EAAL,GAAU,IAAV;CACA,SAAKC,QAAL,GAAgB,IAAhB;CACA,SAAKC,KAAL,GAAa,EAAb;CACA,SAAKC,SAAL,GAAiB,CAAjB;CACA,SAAKC,YAAL,GAAoB,EAApB;CACA,SAAKC,gBAAL,GAAwB,EAAxB;CACA,SAAKC,UAAL,GAAkB,KAAlB;CACA,SAAKC,WAAL,GAAmB,KAAnB;CACA,SAAKC,UAAL,GAAkB,KAAlB;CACA,SAAKC,UAAL,GAAkB,KAAlB;CACA,SAAKC,cAAL,GAAsB,CAAtB;CACA,SAAKC,UAAL,GAAkB,CAAlB;CACA,SAAKC,OAAL,GAAe,IAAIC,GAAJ,EAAf;CACA,SAAKC,WAAL,GAAmB,EAAnB;CAEA,SAAKC,SAAL,CAAehB,MAAf;CACA;;;;+BAESA,QACV;CAAA;;CACCiB,MAAAA,MAAM,CAACC,IAAP,CAAYlB,MAAZ,EAAoBjB,OAApB,CAA4B,UAACoC,IAAD,EAAU;CACrC,YAAMC,aAAa,GAAG/B,mBAAmB,CAACgC,gBAApB,CAAqCF,IAArC,CAAtB;;CAEA,YAAI,KAAI,CAACnB,MAAL,CAAYsB,OAAZ,CAAoBH,IAApB,MAA8B,CAAC,CAAnC,EACA;CACC,cAAMI,aAAa,GAAGlC,mBAAmB,CAACmC,gBAApB,CAAqCL,IAArC,CAAtB;;CACA,cAAMM,SAAS,GAAG,KAAI,CAACpC,mBAAmB,CAACgC,gBAApB,eAA4CE,aAA5C,EAAD,CAAJ,CAAmEG,IAAnE,CAAwE,KAAxE,CAAlB;;CACAD,UAAAA,SAAS,CAACzB,MAAM,CAACmB,IAAD,CAAP,CAAT;CACA,SALD,MAMK,IAAI,KAAI,CAACnB,MAAL,CAAYsB,OAAZ,CAAoBF,aAApB,MAAuC,CAAC,CAA5C,EACL;CACC,cAAMK,UAAS,GAAG,KAAI,CAACpC,mBAAmB,CAACgC,gBAApB,eAA4CF,IAA5C,EAAD,CAAJ,CAA0DO,IAA1D,CAA+D,KAA/D,CAAlB;;CACAD,UAAAA,UAAS,CAACzB,MAAM,CAACmB,IAAD,CAAP,CAAT;CACA;CACD,OAdD;CAeA;;;6BAGD;CACC,aAAO,KAAKlB,EAAZ;CACA;;;2BAEKA,IACN;CACC,WAAKA,EAAL,GAAUA,EAAV;CACA;;;mCAGD;CACC,aAAO,KAAK0B,QAAZ;CACA;;;iCAEWA,UACZ;CACC,WAAKA,QAAL,GAAgBA,QAAhB;CACA;;;mCAGD;CACC,aAAO,KAAKzB,QAAZ;CACA;;;iCAEWA,UACZ;CACC,WAAKA,QAAL,GAAgBA,QAAhB;CACA;;;gCAGD;CACC,aAAO,KAAKC,KAAZ;CACA;;;8BAEQA,OACT;CACC,WAAKA,KAAL,GAAaA,KAAb;CACA;;;oCAGD;CACC,aAAO,KAAKC,SAAZ;CACA;;;kCAEYA,WACb;CACC,WAAKA,SAAL,GAAiBA,SAAjB;CACA;;;uCAGD;CACC,aAAO,KAAKC,YAAZ;CACA;;;qCAEeA,cAChB;CACC,WAAKA,YAAL,GAAoBA,YAApB;CACA;;;2CAGD;CACC,aAAO,KAAKC,gBAAZ;CACA;;;yCAEmBA,kBACpB;CACC,WAAKA,gBAAL,GAAwBA,gBAAxB;CACA;;;qCAGD;CACC,aAAO,KAAKC,UAAZ;CACA;;;mCAEaA,YACd;CACC,WAAKA,UAAL,GAAkBA,UAAlB;CACA;;;sCAGD;CACC,aAAO,KAAKC,WAAZ;CACA;;;oCAEcA,aACf;CACC,WAAKA,WAAL,GAAmBA,WAAnB;CACA;;;qCAGD;CACC,aAAO,KAAKC,UAAZ;CACA;;;mCAEaA,YACd;CACC,WAAKA,UAAL,GAAkBA,UAAlB;CACA;;;qCAGD;CACC,aAAO,KAAKC,UAAZ;CACA;;;mCAEaA,YACd;CACC,WAAKA,UAAL,GAAkBA,UAAlB;CACA;;;yCAGD;CACC,aAAO,KAAKC,cAAZ;CACA;;;uCAEiBA,gBAClB;CACC,WAAKA,cAAL,GAAsBA,cAAtB;CACA;;;qCAGD;CACC,aAAO,KAAKC,UAAZ;CACA;;;mCAEaA,YACd;CACC,WAAKA,UAAL,GAAkBA,UAAlB;CACA;;;kCAGD;CACC,aAAO,KAAKC,OAAZ;CACA;;;gCAEUA,SACX;CAAA;;CACC,UAAMe,KAAK,GAAG;CACbC,QAAAA,CAAC,EAAE,YADU;CAEbC,QAAAA,CAAC,EAAE;CAFU,OAAd;CAKA,WAAKjB,OAAL,CAAakB,KAAb;CAEAd,MAAAA,MAAM,CAACC,IAAP,CAAYL,OAAZ,EAAqB9B,OAArB,CAA6B,UAACkB,EAAD,EAAQ;CAAA,0BACfY,OAAO,CAACZ,EAAD,CADQ;CAAA,YAC7B+B,IAD6B,eAC7BA,IAD6B;CAAA,YACvBC,IADuB,eACvBA,IADuB;;CAEpC,QAAA,MAAI,CAACpB,OAAL,CAAaqB,GAAb,CAAiBjC,EAAjB,EAAqB;CAACA,UAAAA,EAAE,EAAFA,EAAD;CAAKkC,UAAAA,aAAa,EAAEC,cAAI,CAACC,MAAL,CAAYL,IAAZ,CAApB;CAAuCM,UAAAA,IAAI,EAAEV,KAAK,CAACK,IAAD;CAAlD,SAArB;CACA,OAHD;CAIA;;;+BAESM,QACV;CACC,WAAK1B,OAAL,CAAaqB,GAAb,CAAiBK,MAAM,CAACtC,EAAxB,EAA4BsC,MAA5B;CACA;;;kCAEYtC,IACb;CACC,WAAKY,OAAL,CAAa2B,MAAb,CAAoBvC,EAApB;CACA;;;sCAGD;CACC,aAAO,KAAKc,WAAZ;CACA;;;oCAEcA,aACf;CACC,WAAKA,WAAL,GAAmBA,WAAnB;CACA;;;oCAEcA,aACf;CAAA;;CACCE,MAAAA,MAAM,CAACC,IAAP,CAAYH,WAAZ,EAAyBhC,OAAzB,CAAiC,UAACkB,EAAD,EAAQ;CACxC,QAAA,MAAI,CAACc,WAAL,CAAiBd,EAAjB,IAAuBc,WAAW,CAACd,EAAD,CAAlC;CACA,OAFD;CAGA;;;sCAEgBA,IACjB;CACC,aAAO,KAAKc,WAAL,CAAiBd,EAAjB,CAAP;CACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KCrQIwC;;;;;;uCA8BoBC,SACzB;CACC,UAAMC,WAAW,GAAG,eAApB;;CAEA,UAAI,CAACC,aAAG,CAACC,QAAJ,CAAaH,OAAb,EAAsBC,WAAtB,CAAL,EACA;CACCC,QAAAA,aAAG,CAACE,QAAJ,CAAaJ,OAAb,EAAsBC,WAAtB;CACA;CACD;;;mCAEoBI,WAAWC,WAChC;CACC,UAAID,SAAS,KAAKC,SAAlB,EACA;CACCD,QAAAA,SAAS,CAACE,YAAV;CACAD,QAAAA,SAAS,CAACC,YAAV;CAEAF,QAAAA,SAAS,CAACG,cAAV;CACAF,QAAAA,SAAS,CAACE,cAAV;CAEAH,QAAAA,SAAS,CAACI,aAAV;CACAH,QAAAA,SAAS,CAACG,aAAV;CACA,OAVD,MAYA;CACCH,QAAAA,SAAS,CAACG,aAAV;CACA;CACD;;;qCAEsBC,WAAWC,OAClC;CACC,UAAMC,QAAQ,GAAG;CAChB,mBAAWD,KADK;CAEhB,uBAAeD;CAFC,OAAjB;CAIA,UAAIG,YAAY,GAAGC,aAAG,CAACC,UAAJ,CAAe,4CAAf,CAAnB;CAEAxC,MAAAA,MAAM,CAACC,IAAP,CAAYoC,QAAZ,EAAsBvE,OAAtB,CAA8B,UAAC2E,MAAD,EAAY;CACzCH,QAAAA,YAAY,GAAGA,YAAY,CAAC5D,OAAb,CAAqB+D,MAArB,EAA6BJ,QAAQ,CAACI,MAAD,CAArC,CAAf;CACA,OAFD;CAIA,aAAOH,YAAP;CACA;;;sCAEuBI,KACxB;CACC,UAAIC,aAAa,GAAGD,GAApB;;CAEA,cAAQA,GAAR;CAEC,aAAK,KAAL;CACA,aAAK,KAAL;CACA,aAAK,MAAL;CACA,aAAK,KAAL;CACA,aAAK,KAAL;CACA,aAAK,KAAL;CACA,aAAK,KAAL;CACA,aAAK,KAAL;CACA,aAAK,KAAL;CACA,aAAK,KAAL;CACCC,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED,aAAK,KAAL;CACCA,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED,aAAK,KAAL;CACA,aAAK,MAAL;CACCA,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED,aAAK,KAAL;CACA,aAAK,MAAL;CACCA,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED,aAAK,KAAL;CACCA,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED,aAAK,KAAL;CACCA,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED,aAAK,KAAL;CACA,aAAK,MAAL;CACCA,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED,aAAK,KAAL;CACCA,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED,aAAK,KAAL;CACCA,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED,aAAK,KAAL;CACCA,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED,aAAK,KAAL;CACCA,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED,aAAK,KAAL;CACA,aAAK,KAAL;CACA,aAAK,MAAL;CACA,aAAK,KAAL;CACCA,UAAAA,aAAa,GAAG,KAAhB;CACA;;CAED;CACCA,UAAAA,aAAa,GAAG,OAAhB;CACA;CAnEF;;CAsEA,aAAOA,aAAP;CACA;;;uCAEwBC,OACzB;CACC,UAAIC,KAAK,GAAG,CAAZ;CACA,UAAIC,GAAG,GAAG,CAAV;CACA,UAAIC,eAAJ;CACA,UAAIC,KAAJ;CACA,UAAIC,cAAJ;CACA,UAAIC,GAAJ;CACA,UAAIC,QAAJ;;CAEA,UAAI,OAAOP,KAAK,CAACQ,cAAb,KAAgC,QAAhC,IAA4C,OAAOR,KAAK,CAACS,YAAb,KAA8B,QAA9E,EACA;CACCR,QAAAA,KAAK,GAAGD,KAAK,CAACQ,cAAd;CACAN,QAAAA,GAAG,GAAGF,KAAK,CAACS,YAAZ;CACA,OAJD,MAMA;CACCL,QAAAA,KAAK,GAAGM,QAAQ,CAACC,SAAT,CAAmBC,WAAnB,EAAR;;CAEA,YAAIR,KAAK,IAAIA,KAAK,CAACS,aAAN,OAA0Bb,KAAvC,EACA;CACCM,UAAAA,GAAG,GAAGN,KAAK,CAACc,KAAN,CAAYrG,MAAlB;CACA0F,UAAAA,eAAe,GAAGH,KAAK,CAACc,KAAN,CAAYhF,OAAZ,CAAoB,OAApB,EAA6B,IAA7B,CAAlB,CAFD;;CAKCuE,UAAAA,cAAc,GAAGL,KAAK,CAACe,eAAN,EAAjB;CACAV,UAAAA,cAAc,CAACW,cAAf,CAA8BZ,KAAK,CAACa,WAAN,EAA9B,EAND;CASC;CACA;;CACAV,UAAAA,QAAQ,GAAGP,KAAK,CAACe,eAAN,EAAX;CACAR,UAAAA,QAAQ,CAACW,QAAT,CAAkB,KAAlB;;CAEA,cAAIb,cAAc,CAACc,gBAAf,CAAgC,YAAhC,EAA8CZ,QAA9C,IAA0D,CAAC,CAA/D,EACA;CACCN,YAAAA,KAAK,GAAGK,GAAR;CACAJ,YAAAA,GAAG,GAAGI,GAAN;CACA,WAJD,MAMA;CACCL,YAAAA,KAAK,GAAG,CAACI,cAAc,CAACe,SAAf,CAAyB,WAAzB,EAAsC,CAACd,GAAvC,CAAT;CACAL,YAAAA,KAAK,IAAIE,eAAe,CAACkB,KAAhB,CAAsB,CAAtB,EAAyBpB,KAAzB,EAAgCqB,KAAhC,CAAsC,IAAtC,EAA4C7G,MAA5C,GAAqD,CAA9D;;CAEA,gBAAI4F,cAAc,CAACc,gBAAf,CAAgC,UAAhC,EAA4CZ,QAA5C,IAAwD,CAAC,CAA7D,EACA;CACCL,cAAAA,GAAG,GAAGI,GAAN;CACA,aAHD,MAKA;CACCJ,cAAAA,GAAG,GAAG,CAACG,cAAc,CAACkB,OAAf,CAAuB,WAAvB,EAAoC,CAACjB,GAArC,CAAP;CACAJ,cAAAA,GAAG,IAAIC,eAAe,CAACkB,KAAhB,CAAsB,CAAtB,EAAyBnB,GAAzB,EAA8BoB,KAA9B,CAAoC,IAApC,EAA0C7G,MAA1C,GAAmD,CAA1D;CACA;CACD;CACD;CACD;;CAED,aAAO;CAACwF,QAAAA,KAAK,EAALA,KAAD;CAAQC,QAAAA,GAAG,EAAHA;CAAR,OAAP;CACA;;;4CAE6B5D,OAC9B;CACC,UAAIkF,mBAAmB,GAAGlF,KAA1B;;CAEA,UAAIA,KAAK,CAACmB,OAAN,CAAc,cAAd,MAAkC,CAAtC,EACA;CACC,YAAInB,KAAK,KAAK,cAAd,EACA;CACCkF,UAAAA,mBAAmB,GAAG7B,aAAG,CAACC,UAAJ,CAAe,yCAAf,CAAtB;CACA,SAHD,MAIK,IAAItD,KAAK,CAACP,KAAN,CAAY,mBAAZ,CAAJ,EACL;CACC,cAAM0F,UAAU,GAAGnF,KAAK,CAACR,OAAN,CAAc,eAAd,EAA+B,EAA/B,CAAnB;CACA0F,UAAAA,mBAAmB,GAAG7B,aAAG,CAACC,UAAJ,CAAe,mDAAf,EAAoE9D,OAApE,CAA4E,eAA5E,EAA6F2F,UAA7F,CAAtB;CACA;CACD;;CAED,aAAOD,mBAAP;CACA;;;kCAEmBE,MACpB;CACC,UAAMC,OAAO,GAAGC,EAAE,CAACC,kBAAH,GAAwBC,SAAxC;CACA,UAAMC,KAAK,GAAGH,EAAE,CAACI,GAAH,CAAON,IAAP,EAAaO,GAAb,GAAmB9I,IAAI,CAAC+I,KAAL,CAAWN,EAAE,CAACO,kBAAH,GAAwBC,WAAxB,GAAsC,CAAjD,CAAjC;CACA,UAAMC,QAAQ,GAAGV,OAAO,GAAGI,KAA3B;CACA,UAAMO,QAAQ,GAAGnJ,IAAI,CAACoJ,GAAL,CAASR,KAAK,GAAGJ,OAAjB,CAAjB;CACA,UAAMa,KAAK,GAAIrJ,IAAI,CAAC+I,KAAL,CAAWI,QAAQ,GAAG,GAAtB,IAA6B,EAA7B,GAAkC,EAAlC,GAAuCnJ,IAAI,CAAC+I,KAAL,CAAWI,QAAQ,GAAG,GAAtB,CAAtD;CACA,UAAMG,IAAI,GAAGD,KAAK,GAAG,CAArB;;CAEA,UAAIC,IAAI,IAAI,CAAZ,EACA;CACC;CACA;;CAED,UAAIC,UAAU,GAAIL,QAAQ,GAAGV,OAAO,GAAGc,IAAb,GAAoBd,OAAO,GAAGc,IAAxD;CACA,UAAIE,KAAK,GAAG,CAAZ;;CAEA,UAAIN,QAAJ,EACA;CACC,aAAK,IAAIO,CAAC,GAAGjB,OAAb,EAAsBiB,CAAC,GAAGb,KAA1B,EAAiCa,CAAC,IAAIH,IAAtC,EACA;CACCI,UAAAA,UAAU,8BAAuBH,UAAvB,QAAsCC,KAAK,GAAGH,KAA9C,CAAV;CAEAE,UAAAA,UAAU,IAAID,IAAd;;CACA,cAAIC,UAAU,GAAGX,KAAjB,EACA;CACCW,YAAAA,UAAU,GAAGX,KAAb;CACA;;CACDY,UAAAA,KAAK,IAAI,CAAT;CACA;CACD,OAbD,MAeA;CACC,aAAK,IAAIC,EAAC,GAAGjB,OAAb,EAAsBiB,EAAC,GAAGb,KAA1B,EAAiCa,EAAC,IAAIH,IAAtC,EACA;CACCI,UAAAA,UAAU,8BAAuBH,UAAvB,QAAsCC,KAAK,GAAGH,KAA9C,CAAV;CAEAE,UAAAA,UAAU,IAAID,IAAd;;CACA,cAAIC,UAAU,GAAGX,KAAjB,EACA;CACCW,YAAAA,UAAU,GAAGX,KAAb;CACA;;CACDY,UAAAA,KAAK,IAAI,CAAT;CACA;CACD;CACD;;;CAED,2BACA;CAAA;;CAAA,QADYxG,MACZ,uEADqB,EACrB;CAAA;CAAA,QACQ2G,MADR,GACkB3G,MADlB,CACQ2G,MADR;CAGC;CAHD,oFArRQlE,aAqRR;CAAA,2FAnRe,6BAmRf;CAAA,0FAlRc,6BAkRd;CAAA,4FAjRgB,0BAiRhB;CAAA,2FAhRe,+BAgRf;CAAA,wFA9QY,2BA8QZ;CAAA,wFA7QY,2BA6QZ;CAAA,gGA3QoB;CACnBmE,MAAAA,MAAM,EAAE,CACP,+BADO,EAEP,kCAFO,EAGP,4BAHO,CADW;CAMnBhJ,MAAAA,IAAI,EAAE,CACL,+BADK,EAEL,kCAFK,EAGL,4BAHK,EAIL,iCAJK,EAKL,iCALK,EAML,sCANK,EAOL,8BAPK,EAQL,kCARK;CANa,KA2QpB;CAIC,UAAKoC,MAAL,GAAc,IAAIX,mBAAJ,CAAwBW,MAAxB,CAAd;CACA,UAAK2G,MAAL,GAAc;CACbE,MAAAA,SAAS,EAAGF,MAAM,IAAI,YAAYA,MAAvB,GAAiCA,MAAM,CAACG,MAAxC,GAAiD,IAD/C;CAEbC,MAAAA,SAAS,EAAGJ,MAAM,IAAI,YAAYA,MAAvB,GAAiCA,MAAM,CAACK,MAAxC,GAAiD,IAF/C;CAGbC,MAAAA,SAAS,EAAGN,MAAM,IAAI,YAAYA,MAAvB,GAAiCA,MAAM,CAACO,MAAxC,GAAiD,IAH/C;CAIbC,MAAAA,OAAO,EAAGR,MAAM,IAAI,UAAUA,MAArB,GAA+BA,MAAM,CAACS,IAAtC,GAA6C;CAJzC,KAAd;CAOA,UAAKvD,KAAL,GAAa,IAAb;CACA,UAAKwD,KAAL,GAAa,IAAb;CACA,UAAKC,QAAL,GAAgB,IAAhB;CACA,UAAKC,gBAAL,GAAwB,IAAxB;CACA,UAAKC,uBAAL,GAA+B,IAAI1G,GAAJ,EAA/B;CACA,UAAK2G,UAAL,GAAkB,KAAlB;CAjBD;CAkBC;;;;yBAEG7J,MACJ;CAAA,UADUC,QACV,uEADqB,IACrB;CACC,qGAAUD,IAAV,EAAgBC,QAAhB;CACAD,MAAAA,IAAI,CAAC8J,aAAL,GAAqB,KAAKA,aAA1B;CACA;;;kCAGD;CACC,aAAO,KAAK7I,SAAL,OAAqB,CAArB,IAA0B,KAAKrB,SAAL,OAAqB,IAAtD;CACA;;;mCAGD;CACC,aAAO,CAAC,KAAKmK,UAAL,EAAD,IAAsB,KAAKnK,SAAL,GAAiBmK,UAAjB,EAA7B;CACA;;;oCAGD;CACC,UAAIpK,MAAM,GAAG,IAAb;;CAEA,aAAO,CAACA,MAAM,CAACC,SAAP,GAAmBmK,UAAnB,EAAR,EACA;CACCpK,QAAAA,MAAM,GAAGA,MAAM,CAACC,SAAP,EAAT;CACA;;CAED,aAAOD,MAAP;CACA;;;8BAEQ0C,IACT;CACC,UAAI,CAACA,EAAL,EACA;CACC,eAAO,IAAP;CACA;;CAED,UAAI,KAAKD,MAAL,CAAY4H,KAAZ,MAAuB,KAAK5H,MAAL,CAAY4H,KAAZ,GAAoB1K,QAApB,OAAmC+C,EAAE,CAAC/C,QAAH,EAA9D,EACA;CACC,eAAO,IAAP;CACA;;CAED,UAAI4B,KAAK,GAAG,IAAZ;CACA,WAAKH,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7C,YAAIW,KAAK,KAAK,IAAd,EACA;CACCA,UAAAA,KAAK,GAAGX,UAAU,CAAC0J,QAAX,CAAoB5H,EAApB,CAAR;CACA;CACD,OALD;CAOA,aAAOnB,KAAP;CACA;;;2CAGD;CAAA,UADoBgJ,WACpB,uEADkC,KAClC;CACC,UAAInH,cAAc,GAAG,CAArB;CAEA,WAAKhC,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7C,YAAIA,UAAU,CAAC6B,MAAX,CAAkB+H,aAAlB,EAAJ,EACA;CACCpH,UAAAA,cAAc,IAAI,CAAlB;CACA;;CAED,YAAImH,WAAJ,EACA;CACCnH,UAAAA,cAAc,IAAIxC,UAAU,CAAC6J,mBAAX,CAA+BF,WAA/B,CAAlB;CACA;CACD,OAVD;CAYA,aAAOnH,cAAP;CACA;;;uCAGD;CAAA,UADgBmH,WAChB,uEAD8B,KAC9B;CACC,UAAIlH,UAAU,GAAG,CAAjB;;CAEA,UAAI,CAACkH,WAAL,EACA;CACClH,QAAAA,UAAU,GAAG,KAAK1B,mBAAL,EAAb;CACA,OAHD,MAKA;CACC,aAAKP,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7CyC,UAAAA,UAAU,IAAI,CAAd;CACAA,UAAAA,UAAU,IAAIzC,UAAU,CAAC8J,eAAX,CAA2BH,WAA3B,CAAd;CACA,SAHD;CAIA;;CAED,aAAOlH,UAAP;CACA;;;4CAGD;CACC,UAAMD,cAAc,GAAG,KAAKqH,mBAAL,EAAvB;CACA,WAAKhI,MAAL,CAAYkI,iBAAZ,CAA8BvH,cAA9B;CACA;;;wCAGD;CACC,UAAMC,UAAU,GAAG,KAAKqH,eAAL,EAAnB;CACA,WAAKjI,MAAL,CAAYmI,aAAZ,CAA0BvH,UAA1B;CACA;;;oCAGD;CACC,WAAKwH,oBAAL;CACA,WAAKC,gBAAL;CACA;;;sCAGD;CACC,UAAI,KAAKf,QAAL,KAAkB,IAAtB,EACA;CACC;CACA;;CAED,UAAMjE,KAAK,GAAG,KAAKrD,MAAL,CAAYsI,aAAZ,EAAd;CACA,UAAMlF,SAAS,GAAG,KAAKpD,MAAL,CAAYuI,iBAAZ,EAAlB;CAEA,WAAKjB,QAAL,CAAckB,WAAd,CAA0BnF,KAA1B;CACA,WAAKiE,QAAL,CAAcmB,MAAd,CAAqBrF,SAArB;;CAEA,UAAI,KAAKsF,WAAL,EAAJ,EACA;CACC,aAAKC,kBAAL,CAAwBvF,SAAxB,EAAmCC,KAAnC;CACA;CACD;;;wCAEkBD,WAAWC,OAC9B;CACC,UAAME,YAAY,GAAGd,aAAa,CAACmG,eAAd,CAA8BxF,SAA9B,EAAyCC,KAAzC,CAArB;CACA,WAAKiE,QAAL,CAAcuB,YAAd,CAA2BtF,YAA3B;CACA;;;sCAEgBuF,QACjB;CAAA,UADyBnC,MACzB,uEADkC,KAClC;;CACC,UAAIA,MAAM,KAAK,KAAf,EACA;CACCmC,QAAAA,MAAM,CAACC,KAAP,CAAaC,QAAb,GAAwB,QAAxB;CACAF,QAAAA,MAAM,CAACC,KAAP,CAAaE,MAAb,GAAsB,CAAtB;CACAH,QAAAA,MAAM,CAACC,KAAP,CAAaG,OAAb,GAAuB,CAAvB;CAEAtG,QAAAA,aAAG,CAACE,QAAJ,CAAagG,MAAb,EAAqB,KAAKK,SAA1B;CACA,OAPD,MAQK,IAAIxC,MAAM,KAAK,QAAf,EACL;CACCmC,QAAAA,MAAM,CAACC,KAAP,CAAaC,QAAb,GAAwB,QAAxB;CACAF,QAAAA,MAAM,CAACC,KAAP,CAAaE,MAAb,aAAyBH,MAAM,CAACM,YAAhC;CACAN,QAAAA,MAAM,CAACC,KAAP,CAAaG,OAAb,GAAuB,CAAvB;CAEAtG,QAAAA,aAAG,CAACE,QAAJ,CAAagG,MAAb,EAAqB,KAAKO,SAA1B;CACA;CACD;;;+BAGD;CAAA;;CACC,UAAM9L,MAAM,GAAG,KAAKC,SAAL,EAAf;CAEAD,MAAAA,MAAM,CAAC+L,MAAP,CAAc,IAAd;CACA/L,MAAAA,MAAM,CAAC0F,YAAP;CACA1F,MAAAA,MAAM,CAAC2F,cAAP;CAEA,WAAKqG,gBAAL,CAAsB,KAAKC,SAA3B,EAAsC,QAAtC;CAEA9C,MAAAA,UAAU,CAAC,YAAM;CAChB,QAAA,MAAI,CAAC8C,SAAL,CAAeT,KAAf,CAAqBE,MAArB,GAA8B,CAA9B;CACA,QAAA,MAAI,CAACO,SAAL,CAAeT,KAAf,CAAqBG,OAArB,GAA+B,CAA/B;CACA,QAAA,MAAI,CAACM,SAAL,CAAeT,KAAf,CAAqBU,UAArB,GAAkC,CAAlC;CACA,OAJS,EAIP,CAJO,CAAV;CAMA/C,MAAAA,UAAU,CAAC,YAAM;CAChB9D,QAAAA,aAAG,CAAC0G,MAAJ,CAAW,MAAI,CAACE,SAAhB;CACA,OAFS,EAEP,GAFO,CAAV;CAGA;;;+BAGD;CACC,UAAMjM,MAAM,GAAG,KAAKC,SAAL,EAAf;CACA,UAAMK,QAAQ,GAAG,KAAKmC,MAAL,CAAY0J,YAAZ,EAAjB;;CAEA,UAAI7L,QAAQ,KAAK,CAAjB,EACA;CACC,YAAIN,MAAM,CAAC2B,mBAAP,KAA+B,CAAnC,EACA;CACC3B,UAAAA,MAAM,CAACoM,gBAAP,CAAwB,IAAxB,EAA8BpM,MAAM,CAACgB,kBAAP,EAA9B,EAA2D,QAA3D;CACA,SAHD,MAKA;CACChB,UAAAA,MAAM,CAACoM,gBAAP,CAAwB,IAAxB;CACA;CACD,OAVD,MAYA;CACCpM,QAAAA,MAAM,CAACoM,gBAAP,CAAwB,IAAxB,EAA8BpM,MAAM,CAACoB,cAAP,GAAwBd,QAAQ,GAAG,CAAnC,CAA9B;CACA;CACD;;;oCAGD;CAAA,UADa+L,WACb,uEAD2B,IAC3B;CACC,UAAMzJ,KAAK,GAAG,KAAKH,MAAL,CAAY6J,QAAZ,EAAd;CAEA,WAAKrH,MAAL;;CAEA,UAAIoH,WAAW,IAAIzJ,KAAK,CAAC7B,MAAN,GAAe,CAA9B,IAAmC6B,KAAK,KAAK,EAAjD,EACA;CACC,YAAMwG,MAAM,GAAG,QAAf;CACA,YAAMmD,IAAI,GAAG;CACZxH,UAAAA,IAAI,EAAE,KAAKoG,WAAL,KAAqB,WAArB,GAAmC;CAD7B,SAAb;CAIA,aAAKqB,sBAAL,CAA4BpD,MAA5B,EAAoCmD,IAApC;CACA;;CAEDE,MAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,yCAAxB,EAAmE;CAACvD,QAAAA,MAAM,EAAE;CAAT,OAAnE;CAEA,WAAK9C,KAAL,GAAa,IAAb;CACA,WAAK4D,UAAL,GAAkB,KAAlB;CACA;;;mCAEa0C,GACd;CACCA,MAAAA,CAAC,CAACC,cAAF;CAEAxH,MAAAA,aAAG,CAACyH,IAAJ,CAAS,KAAKjL,WAAL,GAAmBiI,KAA5B;;CAEA,UAAI,KAAKiD,kBAAL,EAAJ,EACA;CACC,YAAMC,KAAK,GAAG,KAAKC,gBAAL,EAAd;CACA,YAAM7D,MAAM,GAAG,iBAAf;CACA,YAAMmD,IAAI,GAAG;CAACS,UAAAA,KAAK,EAALA;CAAD,SAAb;CAEA,aAAKE,sBAAL,CAA4B,UAAC7M,IAAD,EAAU;CACrCA,UAAAA,IAAI,CAACoC,MAAL,CAAY0K,aAAZ,CAA0B,KAA1B;CACA9M,UAAAA,IAAI,CAAC+M,YAAL,CAAkB,KAAlB;CACA,SAHD;CAKAJ,QAAAA,KAAK,CAACxL,OAAN,CAAc,UAACnB,IAAD,EAAU;CACvBA,UAAAA,IAAI,CAACJ,SAAL,GAAiB2F,aAAjB;CACAvF,UAAAA,IAAI,CAACgN,sBAAL;CACA,SAHD;CAKA,aAAKb,sBAAL,CAA4BpD,MAA5B,EAAoCmD,IAApC;CAEA;CACA;;CAED,WAAKa,YAAL;CACA,WAAKnN,SAAL,GAAiB2F,aAAjB;CAEA,WAAKyH,sBAAL;CACA;;;4CAEsBjE,QAAQmD,MAC/B;CAAA;;CACC,UAAMe,OAAO,GAAG,EAAhB;CACA,UAAIC,OAAO,GAAG,EAAd;;CAEA,cAAQnE,MAAR;CAEC,aAAK,QAAL;CACA;CACCmE,YAAAA,OAAO,GAAGtH,aAAG,CAACC,UAAJ,uDAA8DkD,MAA9D,cAAwEmD,IAAI,CAACxH,IAA7E,EAAV;CACAuI,YAAAA,OAAO,CAAC/M,IAAR,CAAa;CACZqC,cAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,CAAe,6CAAf,CADK;CAEZsH,cAAAA,MAAM,EAAE;CACPC,gBAAAA,KAAK,EAAE,eAACC,KAAD,EAAQC,OAAR,EACP;CACCA,kBAAAA,OAAO,CAACC,KAAR;;CAEA,kBAAA,MAAI,CAACC,OAAL;;CACA,kBAAA,MAAI,CAACR,sBAAL;;CACA,kBAAA,MAAI,CAACS,iBAAL;CACA;CARM;CAFI,aAAb;CAaA;CACA;;CAED,aAAK,iBAAL;CACA;CACCP,YAAAA,OAAO,GAAGtH,aAAG,CAACC,UAAJ,uDAA8DkD,MAA9D,YAAV;CACAkE,YAAAA,OAAO,CAAC/M,IAAR,CAAa;CACZqC,cAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,CAAe,6CAAf,CADK;CAEZsH,cAAAA,MAAM,EAAE;CACPC,gBAAAA,KAAK,EAAE,eAACC,KAAD,EAAQC,OAAR,EACP;CACCA,kBAAAA,OAAO,CAACC,KAAR;CAEArB,kBAAAA,IAAI,CAACS,KAAL,CAAWxL,OAAX,CAAmB,UAACnB,IAAD,EAAU;CAC5BA,oBAAAA,IAAI,CAACwN,OAAL;CACAxN,oBAAAA,IAAI,CAACgN,sBAAL;CACA,mBAHD;;CAKA,kBAAA,MAAI,CAACS,iBAAL;CACA;CAXM;CAFI,aAAb;CAgBA;CACA;;CAED,aAAK,eAAL;CACA,aAAK,kBAAL;CACA;CACCP,YAAAA,OAAO,GAAGQ,aAAG,CAACC,MAAP,oBAGgEzB,IAAI,CAAC0B,MAHrE,EAMFhI,aAAG,CAACC,UAAJ,uDAA8DkD,MAA9D,EANE,CAAP;CAUA;CACA;;CAED;CACA;CACC;CACA;CA9DF;;CAiEAlB,MAAAA,EAAE,CAACgG,OAAH,CAAW,iBAAX,EAA8BC,IAA9B,CAAmC,YAAM;CACxCjG,QAAAA,EAAE,CAACkG,EAAH,CAAMC,YAAN,CAAmBC,MAAnB,CAA0BC,MAA1B,CAAiC;CAAChB,UAAAA,OAAO,EAAPA,OAAD;CAAUD,UAAAA,OAAO,EAAPA;CAAV,SAAjC;CACA,OAFD;CAGA;;;+CAEyBV,GAC1B;CACC,UAAM4B,QAAQ,GAAG,KAAK3M,WAAL,EAAjB;;CAEA,UAAI2M,QAAQ,CAAC7M,mBAAT,OAAmC,CAAvC,EACA;CACC,aAAK8M,kBAAL,CAAwB,CAAxB;CACA;CACA;;CAED,UAAIvG,EAAE,CAACwG,eAAP,CACC,sBADD,EAEC9B,CAAC,CAAC+B,MAFH,EAGC,KAAKC,+BAAL,EAHD,EAIC;CACCC,QAAAA,QAAQ,EAAE,IADX;CAECC,QAAAA,UAAU,EAAE,IAFb;CAGCC,QAAAA,UAAU,EAAEnC,CAAC,CAAC+B,MAAF,CAASK,WAAT,GAAuB,CAHpC;CAICC,QAAAA,KAAK,EAAE,IAJR;CAKCzB,QAAAA,MAAM,EAAE;CACP0B,UAAAA,YADO,0BACQ;CACd,iBAAKC,OAAL;CACA;CAHM;CALT,OAJD,EAeEC,IAfF;CAgBA;;;uDAGD;CAAA;;CACC,UAAMC,UAAU,GAAG,KAAKtC,kBAAL,EAAnB;CACA,UAAMuC,cAAc,GAAG,EAAvB;CACA,UAAMC,sBAAsB,GAAG;CAC9BC,QAAAA,IAAI,EAAEzB,aAAG,CAAC0B,OAAN,qBAAkB,gEAAlB,CAD0B;CAE9BC,QAAAA,OAAO,EAAE,iBAAChC,KAAD,EAAQrN,IAAR,EAAiB;CACzBA,UAAAA,IAAI,CAACsP,aAAL,GAAqB/B,KAArB;;CACA,UAAA,MAAI,CAACa,kBAAL,CAAwB,MAAI,CAAC5M,WAAL,GAAmBF,mBAAnB,KAA2C,CAAnE;CACA;CAL6B,OAA/B;;CAQA,UAAI0N,UAAJ,EACA;CACC,aAAKjO,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7C0O,UAAAA,cAAc,CAAC/O,IAAf,CAAoB;CACnBiP,YAAAA,IAAI,EAAE5O,UAAU,CAAC6B,MAAX,CAAkBmN,eAAlB,EADa;CAEnBF,YAAAA,OAAO,EAAE,iBAAChC,KAAD,EAAQrN,IAAR,EAAiB;CACzBA,cAAAA,IAAI,CAACsP,aAAL,GAAqB/B,KAArB;;CAEA,cAAA,MAAI,CAACV,sBAAL,CAA4B,UAAC2C,YAAD,EAAkB;CAC7CA,gBAAAA,YAAY,CAACC,WAAb,CAAyBlP,UAAzB;CACAA,gBAAAA,UAAU,CAACmP,WAAX;;CAEA,oBAAI,CAAC,MAAI,CAAChD,kBAAL,EAAL,EACA;CACC1H,kBAAAA,aAAG,CAACyH,IAAJ,CAAS,MAAI,CAACjL,WAAL,GAAmBiI,KAA5B;CACA;CACD,eARD;CASA;CAdkB,WAApB;CAgBA,SAjBD;CAmBAwF,QAAAA,cAAc,CAAC/O,IAAf,CAAoB;CAACyP,UAAAA,SAAS,EAAE;CAAZ,SAApB;CACAV,QAAAA,cAAc,CAAC/O,IAAf,CAAoBgP,sBAApB;CAEA,eAAOD,cAAP;CACA;;CAED,UAAMW,SAAS,GAAG,KAAKC,YAAL,EAAlB;CACA,UAAMC,UAAU,GAAG,KAAKtO,WAAL,GAAmBT,cAAnB,GAAoCgP,MAApC,CAA2C,UAAA/P,IAAI;CAAA,eAAIA,IAAI,KAAK4P,SAAb;CAAA,OAA/C,CAAnB;CAEAE,MAAAA,UAAU,CAAC3O,OAAX,CAAmB,UAACZ,UAAD,EAAgB;CAClC0O,QAAAA,cAAc,CAAC/O,IAAf,CAAoB;CACnBiP,UAAAA,IAAI,EAAE5O,UAAU,CAAC6B,MAAX,CAAkBmN,eAAlB,EADa;CAEnBF,UAAAA,OAAO,EAAE,iBAAChC,KAAD,EAAQrN,IAAR,EAAiB;CACzBA,YAAAA,IAAI,CAACsP,aAAL,GAAqB/B,KAArB;;CACA,YAAA,MAAI,CAACkC,WAAL,CAAiBlP,UAAjB;;CACA,YAAA,MAAI,CAACyP,kBAAL;CACA;CANkB,SAApB;CAQA,OATD;CAWAf,MAAAA,cAAc,CAAC/O,IAAf,CAAoB;CAACyP,QAAAA,SAAS,EAAE;CAAZ,OAApB;CACAV,MAAAA,cAAc,CAAC/O,IAAf,CAAoBgP,sBAApB;CAEA,aAAOD,cAAP;CACA;;;wCAEkBgB,QACnB;CAAA;;CACC,UAAM1N,KAAK,GAAG,UAAGqD,aAAG,CAACC,UAAJ,CAAe,qCAAf,CAAH,EAA2D9D,OAA3D,CAAmE,eAAnE,EAAoFkO,MAApF,CAAd;CACA,UAAMC,YAAY,GAAG,IAAIrL,aAAJ,CAAkB;CAACsL,QAAAA,KAAK,EAAE5N,KAAR;CAAe6N,QAAAA,aAAa,EAAE7N;CAA9B,OAAlB,CAArB;CAEA,WAAKf,WAAL,GAAmBuK,gBAAnB,CAAoCmE,YAApC,EAAkDpC,IAAlD,CAAuD,YAAM;CAC5D,YAAI,MAAI,CAACpB,kBAAL,EAAJ,EACA;CACC,UAAA,MAAI,CAACG,sBAAL,CAA4B,UAAC2C,YAAD,EAAkB;CAC7CA,YAAAA,YAAY,CAACC,WAAb,CAAyBS,YAAzB;CACAA,YAAAA,YAAY,CAACR,WAAb;;CAEA,gBAAI,CAAC,MAAI,CAAChD,kBAAL,EAAL,EACA;CACC1H,cAAAA,aAAG,CAACyH,IAAJ,CAAS,MAAI,CAACjL,WAAL,GAAmBiI,KAA5B;CACA;CACD,WARD;CASA,SAXD,MAaA;CACC,UAAA,MAAI,CAACgG,WAAL,CAAiBS,YAAjB;;CACA,UAAA,MAAI,CAACF,kBAAL;CACA;CACD,OAlBD;CAmBA;;;yCAEmBrL,QACpB;CACC,UAAI,KAAK0L,cAAT,EACA;CACC,aAAKA,cAAL,CAAoB9C,KAApB;CACA;;CAED,UAAI,KAAKb,kBAAL,EAAJ,EACA;CACC,aAAKG,sBAAL,CAA4B,UAAC2C,YAAD,EAAkB;CAC7C,cAAM/M,YAAY,GAAG+M,YAAY,CAACpN,MAAb,CAAoBmN,eAApB,EAArB;CACA,cAAMe,KAAK,GAAG7N,YAAY,CAAC6E,KAAb,CAAmB,CAAC,CAApB,MAA2B,GAA3B,GAAiC,EAAjC,GAAsC,GAApD;CACA,cAAMiJ,QAAQ,GAAG,UAAG9N,YAAH,SAAkB6N,KAAlB,SAA0B3L,MAAM,CAACJ,aAAjC,EAAiDiM,SAAjD,CAA2D,CAA3D,EAA8D,GAA9D,CAAjB;CAEAhB,UAAAA,YAAY,CAACpN,MAAb,CAAoBqO,SAApB,CAA8B9L,MAA9B;CAEA6K,UAAAA,YAAY,CAACkB,WAAb,CAAyBH,QAAzB;CACAf,UAAAA,YAAY,CAACmB,kBAAb,CAAgCJ,QAAhC;CACA,SATD;CAWA;CACA;;CAED,UAAMK,SAAS,GAAG,KAAK3K,KAAL,CAAWc,KAA7B;CACA,UAAM8J,SAAS,GAAG,CAAC,KAAKA,SAAxB;CACA,UAAM3K,KAAK,GAAG,KAAK4K,mBAAL,CAAyB5K,KAAzB,IAAkC,CAAhD;CACA,UAAM6K,UAAU,GAAI7K,KAAK,KAAK,CAAV,IAAeA,KAAK,GAAG2K,SAAR,KAAsB,CAArC,IAA0CD,SAAS,CAACI,MAAV,CAAiB9K,KAAK,GAAG2K,SAAR,GAAoB,CAArC,MAA4C,GAAvF,GAA8F,EAA9F,GAAmG,GAAtH;CACA,UAAMI,QAAQ,GAAIL,SAAS,CAACI,MAAV,CAAiB9K,KAAjB,MAA4B,GAA5B,GAAkC,EAAlC,GAAuC,GAAzD;CAEA,WAAK9D,MAAL,CAAYqO,SAAZ,CAAsB9L,MAAtB;CAEA,UAAMuM,YAAY,aAAMN,SAAS,CAACtJ,KAAV,CAAgB,CAAhB,EAAmBpB,KAAK,GAAG2K,SAA3B,CAAN,SAA8CE,UAA9C,SAA2DvM,cAAI,CAAC2M,MAAL,CAAYxM,MAAM,CAACJ,aAAnB,CAA3D,SAA+F0M,QAA/F,CAAlB;CAEA,WAAKH,mBAAL,CAAyB5K,KAAzB,GAAiCgL,YAAY,CAACxQ,MAA9C;CACA,WAAKoQ,mBAAL,CAAyB3K,GAAzB,GAA+B+K,YAAY,CAACxQ,MAA5C;CAEA,WAAKuF,KAAL,CAAWc,KAAX,aAAsBmK,YAAtB,SAAqCN,SAAS,CAACtJ,KAAV,CAAgBpB,KAAhB,CAArC;CACA,WAAK2K,SAAL,GAAiB,KAAjB;CAEA,WAAKO,aAAL;CACA;;;qDAE+BC,SAChC;CACC,UAAM3M,IAAI,GAAG,SAAb;CACA,UAAMqE,MAAM,aAAMrE,IAAI,CAACxC,WAAL,EAAN,WAAZ;CACA,UAAMgK,IAAI,GAAG;CAAC0B,QAAAA,MAAM,EAAEyD,OAAO,CAACzD;CAAjB,OAAb;CACA,UAAM0D,aAAa,iCAAOD,OAAP;CAAgB3M,QAAAA,IAAI,EAAJA;CAAhB,QAAnB;CAEA,WAAK6M,mBAAL,CAAyBD,aAAzB;CACA,WAAKnF,sBAAL,CAA4BpD,MAA5B,EAAoCmD,IAApC;CAEAE,MAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,qCAAxB,EAA+D+E,OAA/D;CACAjF,MAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,yCAAxB,EAAmE;CAACvD,QAAAA,MAAM,EAAE;CAAT,OAAnE;CACA;;;wDAEkCyI,YACnC;CACC,UAAM9M,IAAI,GAAG,YAAb;CACA,UAAMqE,MAAM,aAAMrE,IAAI,CAACxC,WAAL,EAAN,WAAZ;CACA,UAAMgK,IAAI,GAAG;CAAC0B,QAAAA,MAAM,EAAE4D,UAAU,CAAC5D;CAApB,OAAb;CACA,UAAM6D,gBAAgB,iCAAOD,UAAP;CAAmB9M,QAAAA,IAAI,EAAJA;CAAnB,QAAtB;CAEA,WAAK6M,mBAAL,CAAyBE,gBAAzB;CACA,WAAKtF,sBAAL,CAA4BpD,MAA5B,EAAoCmD,IAApC;CAEAE,MAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,wCAAxB,EAAkEkF,UAAlE;CACApF,MAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,yCAAxB,EAAmE;CAACvD,QAAAA,MAAM,EAAE;CAAT,OAAnE;CACA;;;uCAEiBwD,GAClB;CAAA;;CAAA,UADqBmF,UACrB,uEADkC,SAClC;CAAA,UAD6Cb,SAC7C,uEADyD,KACzD;;CACC,UAAI,CAAC,KAAKc,qBAAL,EAAL,EACA;CACC;CACA;;CAED,UAAMC,eAAe,GAAG;CACvBP,QAAAA,OAAO,EAAE,KAAKQ,+BAAL,CAAqC/N,IAArC,CAA0C,IAA1C,CADc;CAEvB0N,QAAAA,UAAU,EAAE,KAAKM,kCAAL,CAAwChO,IAAxC,CAA6C,IAA7C;CAFW,OAAxB;CAIA,UAAMiO,YAAY,GAAGH,eAAe,CAACF,UAAD,CAAf,IAA+BE,eAAe,CAACP,OAApE;CAEA,WAAKhB,cAAL,GAAsB,IAAIxI,EAAE,CAACmK,KAAH,CAASC,WAAT,CAAqBC,aAArB,CAAmCC,eAAvC,CAAuD;CAC5EC,QAAAA,KAAK,EAAE7F,CAAC,CAAC+B,MADmE;CAE5E+D,QAAAA,IAAI,EAAE,MAFsE;CAG5EC,QAAAA,SAAS,EAAE,IAHiE;CAI5EC,QAAAA,MAAM,EAAE,KAJoE;CAK5EC,QAAAA,WAAW,EAAEjG,CAAC,CAAC+B,MAL6D;CAM5E3O,QAAAA,MAAM,EAAE;CANoE,OAAvD,CAAtB;CAQA,WAAK0Q,cAAL,CAAoBoC,SAApB,CAA8B,aAA9B,EAA6C,YAAM;CAClD,QAAA,MAAI,CAACC,iBAAL,GAAyB,KAAzB;CACA,OAFD;CAGA,WAAKrC,cAAL,CAAoBoC,SAApB,CAA8B,OAA9B,EAAuC,YAAM;CAC5C,QAAA,MAAI,CAAC5B,SAAL,GAAiBA,SAAjB;CACA,QAAA,MAAI,CAAC6B,iBAAL,GAAyB,KAAzB;;CACA,QAAA,MAAI,CAACtB,aAAL;CACA,OAJD;CAKA,WAAKf,cAAL,CAAoBoC,SAApB,CAA8B,eAA9B,EAA+CV,YAA/C;CACA,WAAK1B,cAAL,CAAoBsC,IAApB;CACA;;;uCAEiBpG,GAClB;CACC,WAAKqG,iBAAL,CAAuBrG,CAAvB,EAA0B,SAA1B;CACA;;;0CAEoBA,GACrB;CACC,WAAKqG,iBAAL,CAAuBrG,CAAvB,EAA0B,YAA1B;CACA;;;6CAEuBA,GACxB;CACC,UAAM1M,MAAM,GAAG,KAAKoB,SAAL,EAAf;CADD,gCAE4B,KAAK6I,aAFjC;CAAA,UAEQ+I,MAFR,uBAEQA,MAFR;CAAA,UAEgBC,QAFhB,uBAEgBA,QAFhB;CAAA,UAGQC,SAHR,GAG8DD,QAH9D,CAGQC,SAHR;CAAA,UAGmBC,aAHnB,GAG8DF,QAH9D,CAGmBE,aAHnB;CAAA,UAGkCC,aAHlC,GAG8DH,QAH9D,CAGkCG,aAHlC;CAAA,UAGiDC,SAHjD,GAG8DJ,QAH9D,CAGiDI,SAHjD;;CAKC,UAAI,KAAKvJ,gBAAL,KAA0B,IAA9B,EACA;CACC,aAAKA,gBAAL,GAAwB,IAAI9B,EAAE,CAACsL,WAAP,CAAmB;CAC1CjG,UAAAA,OAAO,EAAE,KAAKkG,0BAAL,EADiC;CAE1CC,UAAAA,WAAW,EAAE9G,CAAC,CAAC+B,MAF2B;CAG1CI,UAAAA,UAAU,EAAEnC,CAAC,CAAC+B,MAAF,CAASK,WAAT,GAAuB,CAHO;CAI1CH,UAAAA,QAAQ,EAAE,IAJgC;CAK1CC,UAAAA,UAAU,EAAE,IAL8B;CAM1CG,UAAAA,KAAK,EAAE;CANmC,SAAnB,CAAxB;CAQA,OAVD,MAYA;CACC,aAAKjF,gBAAL,CAAsB2J,cAAtB,CAAqC/G,CAAC,CAAC+B,MAAvC;CACA;;CAED,WAAK3E,gBAAL,CAAsBoF,IAAtB;CAEAlH,MAAAA,EAAE,CAAC0L,IAAH,CAAQC,EAAR,CAAWhT,GAAX,CAAe;CACdiT,QAAAA,GAAG,EAAE5T,MADS;CAEd6T,QAAAA,WAAW,YAAKb,MAAL,cAAehT,MAAf,4BAFG;CAGd8T,QAAAA,gBAAgB,EAAE,KAHJ;CAIdZ,QAAAA,SAAS,EAATA,SAJc;CAKdC,QAAAA,aAAa,EAAbA,aALc;CAMdC,QAAAA,aAAa,EAAbA,aANc;CAOdC,QAAAA,SAAS,EAATA;CAPc,OAAf;CAUArL,MAAAA,EAAE,CAAC+L,aAAH,CACC,KAAKjK,gBAAL,CAAsBkK,gBAAtB,CAAuCC,aAAvC,CAAqD,gBAArD,CADD,EAEC,wBAFD,EAGC,CAAC,MAAD,CAHD;CAKA;;;6CAEuBC,QACxB;CACC,WAAK3R,MAAL,CAAY4R,gBAAZ,CAA6BD,MAA7B;CACA/O,MAAAA,aAAG,CAAC0G,MAAJ,CAAW,KAAKuI,uBAAL,GAA+BH,aAA/B,wBAA6DC,MAA7D,EAAX;CACA3H,MAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,yCAAxB,EAAmE;CAACvD,QAAAA,MAAM,EAAE;CAAT,OAAnE;CACA;;;0CAGD;CACC,UAAMmL,aAAa,GAAGxG,aAAG,CAACC,MAAP,qBAC0F,KAAKwG,iBAAL,CAAuBrQ,IAAvB,CAA4B,IAA5B,CAD1F,EAGsC4J,aAAG,CAAC0B,OAH1C,qBAGsD,+BAHtD,GAM6F,KAAKgF,oBAAL,CAA0BtQ,IAA1B,CAA+B,IAA/B,CAN7F,EAQsC4J,aAAG,CAAC0B,OAR1C,qBAQsD,kCARtD,EAAnB;CAYA,UAAMiF,sBAAsB,GAAG3G,aAAG,CAACC,MAAP,qBACoF,KAAK2G,uBAAL,CAA6BxQ,IAA7B,CAAkC,IAAlC,CADpF,CAA5B;CAKA,UAAMyQ,wBAAwB,GAAG7G,aAAG,CAACC,MAAP,qBAC3B,KAAKjB,kBAAL,KAA4B,EAA5B,GAAiC2H,sBADN,EAE6E,KAAKG,YAAL,CAAkB1Q,IAAlB,CAAuB,IAAvB,CAF7E,EAK8E,KAAK2Q,aAAL,CAAmB3Q,IAAnB,CAAwB,IAAxB,CAL9E,EAU1B,KAAK1B,MAAL,CAAYsS,cAAZ,KAA+B,2DAA/B,GAA6F,EAVnE,EAUmF,KAAKC,gBAAL,CAAsB7Q,IAAtB,CAA2B,IAA3B,CAVnF,EAY2B8B,aAAG,CAACC,UAAJ,CAAe,iCAAf,CAZ3B,EAeiF,KAAK+O,yBAAL,CAA+B9Q,IAA/B,CAAoC,IAApC,CAfjF,EAiB2B8B,aAAG,CAACC,UAAJ,CAAe,4CAAf,CAjB3B,EAoB8E,KAAKgP,aAAL,CAAmB/Q,IAAnB,CAAwB,IAAxB,CApB9E,CAA9B;CAyBA,aAAO4J,aAAG,CAACC,MAAX,qBACiD,KAAK5D,UAAL,MAAqB,KAAKe,WAAL,EAArB,GAA0C,yCAA1C,GAAsF,EADvI,EAEI,KAAK6G,qBAAL,KAA+BuC,aAA/B,GAA+C,EAFnD,EAGI,CAAC,KAAKpJ,WAAL,EAAD,GAAsByJ,wBAAtB,GAAiD,EAHrD;CAMA;;;iCAEWpF,MACZ;CACC,WAAK/M,MAAL,CAAY0S,QAAZ,CAAqB3F,IAArB;CACA;;;wCAEkBA,MACnB;CACC,UAAM4F,YAAY,GAAG,KAAKC,qBAAL,EAArB;CACA,UAAMC,YAAY,GAAG,KAAKC,cAAL,EAArB;CAEA,WAAK9S,MAAL,CAAY+S,eAAZ,CAA4BhG,IAA5B;CAEAnK,MAAAA,aAAG,CAACjD,OAAJ,CAAYgT,YAAZ,EAA0BE,YAA1B;CACA;;;sCAGD;CAAA,UACQG,QADR,GACoB,KAAKtL,aADzB,CACQsL,QADR;CAEC,UAAI7S,KAAK,GAAG,KAAKH,MAAL,CAAY6J,QAAZ,EAAZ;CAEA1J,MAAAA,KAAK,GAAG,KAAKuI,WAAL,KAAqBjG,aAAa,CAACwQ,sBAAd,CAAqC9S,KAArC,CAArB,GAAmEA,KAA3E;CAEA,WAAKH,MAAL,CAAY+S,eAAZ,CAA4B5S,KAA5B;CACA,WAAKH,MAAL,CAAYkT,UAAZ,GAAyBnU,OAAzB,CAAiC,gBAA+B;CAAA,YAA7BkB,EAA6B,QAA7BA,EAA6B;CAAA,YAAzBkC,aAAyB,QAAzBA,aAAyB;CAAA,YAAVG,IAAU,QAAVA,IAAU;CAC/D,YAAM6Q,MAAM,GAAG,IAAIC,MAAJ,CAAWjR,aAAX,EAA0B,GAA1B,CAAf;CACA,YAAMkR,IAAI,GAAGL,QAAQ,CAACrT,OAAT,CAAiB,WAAjB,EAA8BM,EAA9B,EAAkCN,OAAlC,CAA0C,WAA1C,EAAuDM,EAAvD,CAAb;CAEAE,QAAAA,KAAK,GAAGA,KAAK,CAACR,OAAN,CAAcwT,MAAd,oBAAiCE,IAAjC,2CAAqE/Q,IAArE,gBAA8EH,aAA9E,UAAR;CACA,OALD;CAOAhC,MAAAA,KAAK,GAAGA,KAAK,CAACR,OAAN,CAAc,sBAAd,EAAsC,UAAA2T,GAAG;CAAA,uEAAkDA,GAAlD,kCAA0EA,GAA1E;CAAA,OAAzC,CAAR;CAEA,aAAOhI,aAAG,CAACC,MAAX,qBACe,KAAKgI,iBAAL,EADf,EAEIpT,KAFJ;CAKA;;;4CAEsB4M,MACvB;CAAA;;CACC,UAAMyG,eAAe,GAAG,EAAxB;CAEA,WAAKxT,MAAL,CAAYkT,UAAZ,GAAyBnU,OAAzB,CAAiC,iBAAyB;CAAA,YAAvBkB,EAAuB,SAAvBA,EAAuB;CAAA,YAAnBkC,aAAmB,SAAnBA,aAAmB;;CACzD,YAAI4K,IAAI,CAACzL,OAAL,CAAaa,aAAb,MAAgC,CAAC,CAArC,EACA;CACCqR,UAAAA,eAAe,CAAC1V,IAAhB,CAAqBmC,EAArB;CACA;CACD,OALD;CAOAuT,MAAAA,eAAe,CAACzU,OAAhB,CAAwB,UAACkB,EAAD,EAAQ;CAC/B,QAAA,MAAI,CAACD,MAAL,CAAYyT,YAAZ,CAAyBxT,EAAzB;CACA,OAFD;CAGA;;;qCAGD;CACC,WAAKyT,iBAAL;CACA,WAAKC,wBAAL;CACA;;;yCAGD;CACC,UAAIvT,SAAS,GAAG,CAAhB;CAEA,WAAKzB,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7CA,QAAAA,UAAU,CAAC6B,MAAX,CAAkB4T,YAAlB,CAA+BxT,SAA/B;CACAA,QAAAA,SAAS,IAAI,CAAb;CACA,OAHD;CAIA;;;gDAGD;CACC,UAAMyT,eAAe,GAAI,KAAKnL,WAAL,MAAsB,KAAKf,UAAL,EAAtB,GAA0C,EAA1C,aAAkD,KAAK3H,MAAL,CAAY8T,mBAAZ,EAAlD,MAAzB;CACA,UAAIC,cAAc,GAAG,CAArB;CAEA,WAAKpV,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7C4V,QAAAA,cAAc,IAAI,CAAlB;CACA,YAAMC,YAAY,aAAMH,eAAN,SAAwBE,cAAxB,CAAlB;CAEA5V,QAAAA,UAAU,CAAC6B,MAAX,CAAkBiU,mBAAlB,CAAsCD,YAAtC;;CAEA,YAAI,CAAC7V,UAAU,CAACuK,WAAX,EAAL,EACA;CACCvK,UAAAA,UAAU,CAACqL,SAAX,CAAqBkI,aAArB,CAAmC,8BAAnC,EAAmEwC,SAAnE,GAA+EF,YAA/E;CACA;;CAED7V,QAAAA,UAAU,CAACwV,wBAAX;CACA,OAZD;CAaA;;;yCAGD;CAAA,iCAC+C,KAAKjM,aADpD;CAAA,UACQyM,MADR,wBACQA,MADR;CAAA,UACgBC,aADhB,wBACgBA,aADhB;CAAA,UAC+BC,YAD/B,wBAC+BA,YAD/B;CAGC,WAAKjV,WAAL,GAAmBkV,eAAnB,CAAmC,UAAC1W,IAAD,EAAU;CAC5C,YAAM2C,UAAU,GAAG3C,IAAI,CAACoC,MAAL,CAAY+H,aAAZ,EAAnB;CACA,YAAMwM,gBAAgB,GAAG3W,IAAI,CAACoC,MAAL,CAAYkT,UAAZ,GAAyBsB,GAAzB,CAA6BL,MAAM,CAACjX,QAAP,EAA7B,CAAzB;CACA,YAAIuX,SAAJ;;CAEA,YAAI,CAACL,aAAD,IAAkBC,YAAtB,EACA;CACCI,UAAAA,SAAS,GAAGlU,UAAU,IAAI,CAACgU,gBAA3B;CACA,SAHD,MAIK,IAAI,CAACH,aAAL,EACL;CACCK,UAAAA,SAAS,GAAGlU,UAAZ;CACA,SAHI,MAIA,IAAI8T,YAAJ,EACL;CACCI,UAAAA,SAAS,GAAG,CAACF,gBAAb;CACA,SAHI,MAKL;CACCE,UAAAA,SAAS,GAAG,KAAZ;CACA;;CAED,eAAOA,SAAP;CACA,OAvBD;CAwBA;;;qCAEeA,WAChB;CACC,UAAI,KAAKC,YAAL,CAAkBD,SAAlB,CAAJ,EACA;CACC,aAAKpK,IAAL;CACA,OAHD,MAKA;CACC,aAAKsC,IAAL;CACA,aAAKhO,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7CA,UAAAA,UAAU,CAACmW,eAAX,CAA2BG,SAA3B;CACA,SAFD;CAGA;CACD;;;kCAEYA,WACb;CACC,UACC,KAAK9M,UAAL,MACG,KAAKF,UADR,IAEG7E,aAAG,CAACC,QAAJ,CAAa,KAAK2G,SAAlB,EAA6B,KAAKL,SAAlC,CAFH,IAGG,CAACsL,SAAS,CAAC,IAAD,CAJd,EAMA;CACC,eAAO,KAAP;CACA;;CAED,UAAIE,OAAO,GAAG,IAAd;CAEA,WAAKhW,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7C,YAAI,CAACsW,SAAS,CAACtW,UAAD,CAAd,EACA;CACCwW,UAAAA,OAAO,GAAG,KAAV;CACA,SAHD,MAIK,IAAIA,OAAJ,EACL;CACCA,UAAAA,OAAO,GAAGxW,UAAU,CAACuW,YAAX,CAAwBD,SAAxB,CAAV;CACA;CACD,OATD;CAWA,aAAOE,OAAP;CACA;;;4BAGD;CACC/R,MAAAA,aAAG,CAACyH,IAAJ,CAAS,KAAKb,SAAd;CACA;;;4BAGD;CACC5G,MAAAA,aAAG,CAAC+J,IAAJ,CAAS,KAAKnD,SAAd;CACA;;;uCAGD;CACC,UAAIjJ,UAAJ;;CAEA,UAAI,KAAKoH,UAAL,EAAJ,EACA;CACCpH,QAAAA,UAAU,GAAG,KAAb;CACA,OAHD,MAIK,IAAI,KAAKmI,WAAL,EAAJ,EACL;CACC,YAAM/H,cAAc,GAAG,KAAKqH,mBAAL,CAAyB,IAAzB,CAAvB;CACA,YAAMpH,UAAU,GAAG,KAAKqH,eAAL,CAAqB,IAArB,CAAnB;CAEA1H,QAAAA,UAAU,GAAII,cAAc,KAAKC,UAAnB,IAAiCA,UAAU,GAAG,CAA5D;CACA,OANI,MAQL;CACCL,QAAAA,UAAU,GAAG,KAAKP,MAAL,CAAY+H,aAAZ,EAAb;CACA;;CAED,aAAOxH,UAAP;CACA;;;8CAGD;CACC,UAAI,KAAKkH,UAAT,EACA;CACC,eAAO,IAAP;CACA;;CAED,UAAI3I,KAAK,GAAG,KAAZ;CAEA,WAAKH,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7C,YAAIW,KAAK,KAAK,KAAd,EACA;CACCA,UAAAA,KAAK,GAAGX,UAAU,CAACyW,sBAAX,EAAR;CACA;CACD,OALD;CAOA,aAAO9V,KAAP;CACA;;;uCAGD;CACC,WAAKH,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7C,YAAIA,UAAU,CAAC6B,MAAX,CAAkB6U,aAAlB,EAAJ,EACA;CACC1W,UAAAA,UAAU,CAAC2W,WAAX;CACA;CACD,OALD;CAMA;;;6CAGD;CACC,UAAI,KAAKrN,UAAT,EACA;CACC,aAAKmG,kBAAL;CACA;;CAED,WAAKjP,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7CA,QAAAA,UAAU,CAAC4W,qBAAX;CACA,OAFD;CAGA;;;0CAGD;CACC,WAAKlR,KAAL,GAAa,KAAK2F,SAAL,CAAekI,aAAf,iBAAsC,KAAK7S,SAAL,EAAtC,EAAb;CACA,WAAK6P,mBAAL,GAA2BjM,aAAa,CAACuS,iBAAd,CAAgC,KAAKnR,KAArC,CAA3B;CACA;;;gCAEUsG,GACX;CACCA,MAAAA,CAAC,CAACC,cAAF;CAEA,WAAKZ,SAAL,CAAekI,aAAf,iBAAsC,KAAK7S,SAAL,EAAtC,GAA0D8F,KAA1D,GAAkE,EAAlE;CACA,WAAKqK,aAAL;CACA;;;qCAGD;CAAA;;CACC,UAAI,KAAKnL,KAAL,KAAe,IAAf,IAAuB,KAAK6K,mBAAhC,EACA;CAAA,oCACsB,KAAKA,mBAD3B;CAAA,YACQ5K,KADR,yBACQA,KADR;CAAA,YACeC,GADf,yBACeA,GADf;CAGC2C,QAAAA,UAAU,CAAC,YAAM;CAChB,UAAA,MAAI,CAAC7C,KAAL,CAAWoR,KAAX;;CACA,UAAA,MAAI,CAACpR,KAAL,CAAWqR,iBAAX,CAA6BpR,KAA7B,EAAoCC,GAApC;CACA,SAHS,EAGP,EAHO,CAAV;CAIA;CACD;;;2CAGD;CACC,UAAMtG,MAAM,GAAG,KAAKoB,SAAL,EAAf;;CAEA,UAAI,KAAK6J,WAAL,EAAJ,EACA;CACC,eAAO4C,aAAG,CAACC,MAAX,sBAIwD9N,MAJxD,EAKgB,KAAKuC,MAAL,CAAYmN,eAAZ,EALhB,EAMqB,KAAKgI,iBAAL,CAAuBzT,IAAvB,CAA4B,IAA5B,CANrB,EAOiB,KAAK0T,kBAAL,CAAwB1T,IAAxB,CAA6B,IAA7B,CAPjB,EAQ6D,KAAK2T,UAAL,CAAgB3T,IAAhB,CAAqB,IAArB,CAR7D;CAYA;;CAED,UAAM4T,iBAAiB,GAAG,IAAI7P,EAAE,CAACkG,EAAH,CAAM4J,aAAV,CAAwB;CACjD5Q,QAAAA,KAAK,EAAE,KAAK3E,MAAL,CAAYuI,iBAAZ,EAD0C;CAEjDiN,QAAAA,QAAQ,EAAE,KAAKxV,MAAL,CAAYsI,aAAZ,EAFuC;CAGjDmN,QAAAA,KAAK,EAAE,EAH0C;CAIjDC,QAAAA,QAAQ,EAAE,CAJuC;CAKjDC,QAAAA,IAAI,EAAE,KAL2C;CAMjDC,QAAAA,KAAK,EAAEnQ,EAAE,CAACkG,EAAH,CAAM4J,aAAN,CAAoBM,KAApB,CAA0BC;CANgB,OAAxB,CAA1B;CASA,aAAOxK,aAAG,CAACC,MAAX,sBACmE,KAAKvL,MAAL,CAAY+H,aAAZ,KAA8B,6BAA9B,GAA8D,EADjI,EAIgE,KAAKgO,qBAAL,CAA2BrU,IAA3B,CAAgC,IAAhC,CAJhE,EAMQ4T,iBAAiB,CAACU,YAAlB,EANR,EAcyDvY,MAdzD,EAeuB+F,aAAG,CAACC,UAAJ,CAAe,sCAAf,CAfvB,EAgBiB,KAAKzD,MAAL,CAAYmN,eAAZ,EAhBjB,EAiBsB,KAAKgI,iBAAL,CAAuBzT,IAAvB,CAA4B,IAA5B,CAjBtB,EAkBqB,KAAKuU,cAAL,CAAoBvU,IAApB,CAAyB,IAAzB,CAlBrB,EAmBkB,KAAK0T,kBAAL,CAAwB1T,IAAxB,CAA6B,IAA7B,CAnBlB,EAoB8D,KAAK2T,UAAL,CAAgB3T,IAAhB,CAAqB,IAArB,CApB9D;CAyBA;;;qCAEe9D,MAChB;CAAA,UADsBsY,cACtB,uEADuC,IACvC;CACC,UAAM3Q,IAAI,GAAG2Q,cAAc,IAAItY,IAAI,CAACoY,YAAL,EAA/B;CACA,UAAMnY,QAAQ,GAAG+E,aAAG,CAACuT,WAAJ,CAAgB5Q,IAAhB,CAAjB;;CAEA,UAAI,CAAC,KAAK8B,KAAV,EACA;CACC,aAAKA,KAAL,GAAaiE,aAAG,CAACC,MAAjB,sBAEI3N,IAAI,CAACwY,kBAAL,EAFJ;CAMA,aAAK/O,KAAL,CAAW0B,KAAX,CAAiBjD,GAAjB,aAA0BjI,QAAQ,CAACiI,GAAnC;CACA,aAAKuB,KAAL,CAAW0B,KAAX,CAAiBsN,IAAjB,aAA2BxY,QAAQ,CAACwY,IAApC;CACA,aAAKhP,KAAL,CAAW0B,KAAX,CAAiB0M,KAAjB,aAA4B5X,QAAQ,CAAC4X,KAArC;CAEA7S,QAAAA,aAAG,CAAC0T,MAAJ,CAAW,KAAKjP,KAAhB,EAAuB9C,QAAQ,CAACgS,IAAhC;CACA,OAbD,MAeA;CACC3T,QAAAA,aAAG,CAACjD,OAAJ,CAAY,KAAK0H,KAAL,CAAWqK,aAAX,CAAyB,oCAAzB,CAAZ,EAA4E9T,IAAI,CAACwY,kBAAL,EAA5E;CAEA,aAAK/O,KAAL,CAAW0B,KAAX,CAAiBjD,GAAjB,aAA0BjI,QAAQ,CAACiI,GAAnC;CACA,aAAKuB,KAAL,CAAW0B,KAAX,CAAiBsN,IAAjB,aAA2BxY,QAAQ,CAACwY,IAApC;CACA,aAAKhP,KAAL,CAAW0B,KAAX,CAAiB0M,KAAjB,aAA4B5X,QAAQ,CAAC4X,KAArC;CACA;;CAED,UAAI,CAAC7S,aAAG,CAAC4T,OAAJ,CAAY,KAAKnP,KAAjB,CAAL,EACA;CACCzE,QAAAA,aAAG,CAAC+J,IAAJ,CAAS,KAAKtF,KAAd;CACA;;CAED,UACEzE,aAAG,CAAC4T,OAAJ,CAAY,KAAKnP,KAAjB,KAA2BzJ,IAAI,CAAC8K,WAAL,EAA3B,IAAiD,CAAC9K,IAAI,CAAC2R,qBAAL,EAAnD,IACI1R,QAAQ,CAACwY,IAAT,KAAkB,CAAlB,IAAuBxY,QAAQ,CAAC4Y,KAAT,KAAmB,CAA1C,IAA+C5Y,QAAQ,CAAC4X,KAAT,KAAmB,CAFvE,EAIA;CACC7S,QAAAA,aAAG,CAACyH,IAAJ,CAAS,KAAKhD,KAAd;CACA;CACD;;;wCAGD;CAAA;;CACC,UAAMqP,cAAc,GAAG,KAAKC,iBAAL,EAAvB;CACA,UAAMC,gBAAgB,GAAG,KAAKC,mBAAL,EAAzB;CAEAjU,MAAAA,aAAG,CAACE,QAAJ,CAAa4T,cAAb,EAA6B,KAAKI,WAAlC;CACAlU,MAAAA,aAAG,CAACmU,YAAJ,CAAiBH,gBAAjB,EAAmCF,cAAnC;CAEA,WAAK7S,KAAL,GAAa+S,gBAAgB,CAAClF,aAAjB,iBAAwC,KAAK7S,SAAL,EAAxC,EAAb;CACA,WAAKgF,KAAL,CAAWoR,KAAX;CACA,WAAKpR,KAAL,CAAWqR,iBAAX,CAA6B,KAAKrR,KAAL,CAAWc,KAAX,CAAiBrG,MAA9C,EAAsD,KAAKuF,KAAL,CAAWc,KAAX,CAAiBrG,MAAvE;;CAEA,UAAI,KAAKuF,KAAL,CAAWc,KAAX,KAAqB,EAArB,IAA2B,KAAKd,KAAL,CAAWc,KAAX,CAAiBrG,MAAjB,KAA4B,CAA3D,EACA;CACCoI,QAAAA,UAAU,CAAC,YAAM;CAChB,cAAI9D,aAAG,CAAC4T,OAAJ,CAAY,MAAI,CAAC3S,KAAjB,CAAJ,EACA;CACC,YAAA,MAAI,CAACzE,WAAL,GAAmB4X,eAAnB,CAAmC,MAAnC,EAAyC,MAAI,CAACnT,KAA9C;CACA;CACD,SALS,EAKP,GALO,CAAV;CAMA,OARD,MAUA;CACC,aAAKzE,WAAL,GAAmB4X,eAAnB,CAAmC,IAAnC,EAAyC,KAAKnT,KAA9C;CACA;;CAED,WAAK4D,UAAL,GAAkB,IAAlB;CACA;;;yCAGD;CACC,UAAMwP,YAAY,GAAG,KAAKN,iBAAL,EAArB;CACA,UAAM5J,IAAI,GAAG3K,cAAI,CAACC,MAAL,CAAY4U,YAAY,CAACvF,aAAb,iBAAoC,KAAK7S,SAAL,EAApC,GAAwD8F,KAAxD,CAA8DuS,IAA9D,GAAqE9I,SAArE,CAA+E,CAA/E,EAAkF,GAAlF,CAAZ,CAAb;CAEA,WAAK+I,sBAAL,CAA4BpK,IAA5B;CACA,WAAKuB,WAAL,CAAiBvB,IAAjB;CACA,WAAKwB,kBAAL,CAAwBxB,IAAxB;CAEAnK,MAAAA,aAAG,CAACwU,WAAJ,CAAgBH,YAAY,CAACI,kBAA7B,EAAiD,KAAKP,WAAtD;CACAlU,MAAAA,aAAG,CAAC0G,MAAJ,CAAW2N,YAAX;CACArU,MAAAA,aAAG,CAACyH,IAAJ,CAAS,KAAKjL,WAAL,GAAmBiI,KAA5B;CAEA,WAAKxD,KAAL,GAAa,IAAb;CACA,WAAK4D,UAAL,GAAkB,KAAlB;CACA;;;oDAGD;CACC,aAAO,KAAKvI,mBAAL,OAA+B,CAA/B,IACH+B,MAAM,CAACC,IAAP,CAAY,KAAKlB,MAAL,CAAYsX,cAAZ,EAAZ,EAA0ChZ,MAA1C,KAAqD,CADlD,IAEH,KAAKkJ,uBAAL,CAA6BvI,IAA7B,KAAsC,CAF1C;CAGA;;;0CAGD;CAAA,UADmBsY,aACnB,uEADmC,KACnC;CACC,UAAM1T,KAAK,GAAG,KAAK2F,SAAL,CAAekI,aAAf,iBAAsC,KAAK7S,SAAL,EAAtC,EAAd;CACA,UAAMkO,IAAI,GAAGlJ,KAAK,CAACc,KAAN,CAAYuS,IAAZ,EAAb;;CAEA,UAAInK,IAAI,CAACzO,MAAL,KAAgB,CAApB,EACA;CACC,YAAI,KAAKkZ,4BAAL,EAAJ,EACA;CACC,eAAK7M,YAAL,CAAkB,KAAlB;CACA,eAAKnN,SAAL,GAAiB2F,aAAjB;CACA,eAAKsU,sBAAL;CAEA7U,UAAAA,aAAG,CAACyH,IAAJ,CAAS,KAAKjL,WAAL,GAAmBiI,KAA5B;CACA,SAPD,MASA;CACC5E,UAAAA,aAAa,CAACiV,iBAAd,CAAgC7T,KAAK,CAACa,aAAtC;;CACA,cAAI,KAAKb,KAAL,KAAe,IAAnB,EACA;CACC,iBAAKzE,WAAL,GAAmB4X,eAAnB,CAAmC,IAAnC,EAAyC,KAAKnT,KAA9C;CACA;CACD;CACD,OAlBD,MAmBK,IAAI0T,aAAJ,EACL;CACC,aAAK/Z,SAAL,GAAiBmM,gBAAjB,CAAkC,IAAlC,EAAwC,IAAxC;CACA,OAHI,MAKL;CACC,aAAKgO,iBAAL;CACA,aAAKtM,iBAAL;CACA;;CAED,UAAI,KAAK9D,gBAAL,KAA0B,IAA9B,EACA;CACC,aAAKA,gBAAL,CAAsB4D,KAAtB;CACA;CACD;;;sCAEgBhB,GACjB;CACC,UAAI,KAAK1C,UAAT,EACA;CACC,YAAI0C,CAAC,CAACyN,OAAF,KAAc,EAAd,IAAoBzN,CAAC,CAACyN,OAAF,KAAc,CAAtC,EACA;CACC,eAAKhK,kBAAL,CAAwB,CAAC,KAAKlF,WAAL,EAAzB;CACA;CACD,OAND,MAQA;CACC,YAAMqD,QAAQ,GAAG,KAAK3M,WAAL,EAAjB;CAEA2M,QAAAA,QAAQ,CAACgJ,qBAAT;CACAhJ,QAAAA,QAAQ,CAAC8L,eAAT;;CAEA,YAAI,CAAC9L,QAAQ,CAAC6I,sBAAT,EAAL,EACA;CACC,eAAKkD,gBAAL;CACA9N,UAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,yCAAxB,EAAmE;CAACvD,YAAAA,MAAM,EAAE;CAAT,WAAnE;CACA;CACD;CACD;;;uCAEiBwD,GAClB;CACC,UAAI,KAAKmG,iBAAT,EACA;CACCnG,QAAAA,CAAC,CAACC,cAAF;CACA;CACA;;CAED,UAAMlJ,IAAI,GAAG;CACZ6W,QAAAA,KAAK,EAAE,EADK;CAEZC,QAAAA,IAAI,EAAE,EAFM;CAGZC,QAAAA,MAAM,EAAE;CAHI,OAAb;;CAMA,UAAI9N,CAAC,CAACyN,OAAF,KAAc1W,IAAI,CAAC6W,KAAvB,EACA;CACC,aAAKG,gBAAL,CAAsB/N,CAAtB;CACAA,QAAAA,CAAC,CAACC,cAAF;CACA,OAJD,MAKK,IAAID,CAAC,CAACyN,OAAF,KAAc1W,IAAI,CAAC8W,IAAnB,IAA4B7N,CAAC,CAACgO,QAAF,IAAchO,CAAC,CAACyN,OAAF,KAAc1W,IAAI,CAAC+W,MAAjE,EACL;CACC,aAAK3H,iBAAL,GAAyB,IAAzB;CACA,aAAKE,iBAAL,CAAuBrG,CAAvB,EAA0B,KAAKzC,aAAL,CAAmB0Q,yBAA7C,EAAwE,IAAxE;CACA;;CAEDpO,MAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,yCAAxB,EAAmE;CAACvD,QAAAA,MAAM,EAAE;CAAT,OAAnE;CACA;;;oCAEcwD,GACf;CACC,UAAIA,CAAC,CAACyN,OAAF,KAAc,CAAlB,EACA;CACC,aAAKM,gBAAL,CAAsB/N,CAAtB;CACAA,QAAAA,CAAC,CAACC,cAAF;CACA;CACD;;;uCAEiBD,GAClB;CACC,UAAI,CAAC,KAAKkO,cAAL,EAAD,IAA0B,KAAKC,eAAL,CAAqBnO,CAArB,EAAwB,QAAxB,CAA9B,EACA;CACC;CACA;;CAED,WAAK+N,gBAAL,CAAsB/N,CAAtB;CACA;;;2CAEqBA,GACtB;CACC,UAAI,CAAC,KAAKkO,cAAL,EAAD,IAA0B,KAAKC,eAAL,CAAqBnO,CAArB,EAAwB,MAAxB,CAA9B,EACA;CACC;CACA;;CAED,UAAI,KAAKsD,YAAL,GAAoBzN,MAApB,CAA2B6U,aAA3B,EAAJ,EACA;CACC,aAAK0D,YAAL,CAAkBpO,CAAlB;CACA;CACA;;CAED,WAAK+N,gBAAL,CAAsB/N,CAAtB;CACA;;;0CAGD;CACC,aAAOmB,aAAG,CAACC,MAAX,sBACwD,KAAKgH,gBAAL,CAAsB7Q,IAAtB,CAA2B,IAA3B,CADxD;CAGA;;;uCAGD;CACC,UAAI,KAAK1B,MAAL,CAAYsS,cAAZ,EAAJ,EACA;CACC,aAAKtS,MAAL,CAAYwY,cAAZ,CAA2B,KAA3B;CACA5V,QAAAA,aAAG,CAAC0G,MAAJ,CAAW,KAAKE,SAAL,CAAekI,aAAf,CAA6B,iCAA7B,CAAX;CACA,OAJD,MAMA;CACC,aAAK1R,MAAL,CAAYwY,cAAZ,CAA2B,IAA3B;CACA5V,QAAAA,aAAG,CAACmU,YAAJ,CAAiB,KAAK0B,kBAAL,EAAjB,EAA4C,KAAKjP,SAAL,CAAekI,aAAf,CAA6B,mCAA7B,CAA5C;CACA;;CAED1H,MAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,yCAAxB,EAAmE;CAACvD,QAAAA,MAAM,EAAE;CAAT,OAAnE;CAEA,WAAKqI,aAAL;CACA;;;0CAGD;CACC,aAAO,KAAK5P,WAAL,GAAmBoL,gBAAnB,GAAsClM,MAAtC,GAA+C,CAAtD;CACA;;;4CAEsBoa,UACvB;CAAA,UADiCC,OACjC,uEAD2C,KAC3C;CACC,UAAIC,aAAa,GAAG,KAAKxZ,WAAL,GAAmBoL,gBAAnB,EAApB;;CAEA,UAAImO,OAAJ,EACA;CACCC,QAAAA,aAAa,kCAAOA,aAAa,CAACD,OAAd,EAAP,CAAb;CACA;;CAEDC,MAAAA,aAAa,CAAC7Z,OAAd,CAAsB,UAACnB,IAAD,EAAU;CAC/B8a,QAAAA,QAAQ,CAAC9a,IAAD,CAAR;CACA,OAFD;CAGA;;;sCAEgBuM,GACjB;CACC,UAAI,CAAC,KAAKkO,cAAL,EAAL,EACA;CACC;CACA;;CAED,UAAI,KAAK/N,kBAAL,EAAJ,EACA;CACC,aAAKG,sBAAL,CAA4B,UAAC2C,YAAD,EAAkB;CAC7CA,UAAAA,YAAY,CAACyL,eAAb;CACA,SAFD;CAIA;CACA;;CAED,WAAKA,eAAL;CAEA,UAAMC,oBAAoB,GAAG3O,CAAC,CAAC+B,MAAF,CAAS6M,OAAT,CAAiB,kDAAjB,CAA7B;;CACA,UAAID,oBAAJ,EACA;CACClW,QAAAA,aAAG,CAACoW,WAAJ,CAAgBF,oBAAhB,EAAsC,0DAAtC;CACA;CACD;;;6CAGD;CACC,UACC,KAAKrL,YAAL,GAAoBzN,MAApB,CAA2B6U,aAA3B,MACG,KAAKpN,UADR,IAEG,CAAC,KAAKwR,cAAL,EAHL,EAKA;CACC;CACA;;CAED,WAAKC,cAAL;CACA;;;sCAGD;CACC,UAAM3Y,UAAU,GAAG,KAAKP,MAAL,CAAY+H,aAAZ,EAAnB;CAEA,WAAK/H,MAAL,CAAYmZ,aAAZ,CAA0B,CAAC5Y,UAA3B;CACA,WAAK/C,SAAL,GAAiByF,YAAjB;CACA,WAAKzF,SAAL,GAAiB0F,cAAjB;CAEAN,MAAAA,aAAG,CAACoW,WAAJ,CAAgB,KAAKrC,iBAAL,EAAhB,EAA0C,KAAKyC,YAA/C;CAEA,WAAKxO,sBAAL;CACA,WAAKS,iBAAL;CAEA,WAAKgO,qBAAL;CACA;;;6CAGD;CAAA;;CACC,UAAMpZ,EAAE,GAAG,KAAKD,MAAL,CAAY4H,KAAZ,EAAX;;CAEA,UAAI,CAAC3H,EAAL,EACA;CACC;CACA;;CAED,UAAM6J,IAAI,GAAG,EAAb;CARD,iCASkE,KAAKpC,aATvE;CAAA,UASQ4R,WATR,wBASQA,WATR;CAAA,UASqBC,QATrB,wBASqBA,QATrB;CAAA,UAS+BC,UAT/B,wBAS+BA,UAT/B;CAAA,UAS2CC,mBAT3C,wBAS2CA,mBAT3C;CAUC,UAAMC,UAAU,GAAI,KAAK1Z,MAAL,CAAY+H,aAAZ,KAA8BuR,WAAW,CAACK,QAA1C,GAAqDL,WAAW,CAACM,KAArF;CAEA9P,MAAAA,IAAI,WAAI0P,UAAU,CAAC9Z,WAAX,EAAJ,QAAJ,GAAwC6Z,QAAxC;CACAzP,MAAAA,IAAI,CAAC+P,eAAL,GAAuB5Z,EAAvB;CAEAwF,MAAAA,EAAE,CAACqU,IAAH,CAAQC,SAAR,CAAkBL,UAAlB,EAA8B;CAAC5P,QAAAA,IAAI,EAAJA;CAAD,OAA9B,EAAsC4B,IAAtC,CAA2C,UAACsO,QAAD,EAAc;CAAA,YACjDzZ,UADiD,GACnCyZ,QAAQ,CAAClQ,IAAT,CAAcmQ,aADqB,CACjD1Z,UADiD;;CAExD,QAAA,OAAI,CAAC2Z,yBAAL,CAA+B3Z,UAA/B,EAA2CkZ,mBAA3C,EAAgEA,mBAAhE;CACA,OAHD;CAIA;;;+CAEyBlZ,YAAY3C,MAAML,QAC5C;CAAA;;CACC,UAAI,KAAKyC,MAAL,CAAY4H,KAAZ,OAAwBhK,IAAI,CAACuc,MAAL,CAAYla,EAAxC,EACA;CACCrC,QAAAA,IAAI,CAACuc,MAAL,CAAY5Z,UAAZ,GAAyBA,UAAzB;CACAhD,QAAAA,MAAM,CAAC4c,MAAP,CAAcxZ,cAAd,IAAiCJ,UAAU,GAAG,CAAH,GAAO,CAAC,CAAnD;CAEA,eAAO,IAAP;CACA;;CAED,UAAIzB,KAAK,GAAG,IAAZ;CACAlB,MAAAA,IAAI,CAACwc,WAAL,CAAiBrb,OAAjB,CAAyB,UAACZ,UAAD,EAAgB;CACxC,YAAIW,KAAK,KAAK,IAAd,EACA;CACCA,UAAAA,KAAK,GAAG,OAAI,CAACob,yBAAL,CAA+B3Z,UAA/B,EAA2CpC,UAA3C,EAAuDP,IAAvD,CAAR;CACA;CACD,OALD;CAOA,aAAOkB,KAAP;CACA;;;mCAGD;CACC,UAAMub,QAAQ,GAAG,KAAK7Q,SAAL,CAAekI,aAAf,mBAAwC,KAAK7S,SAAL,EAAxC,EAAjB;;CAEA,UAAIwb,QAAQ,IAAIA,QAAQ,CAACC,OAAT,KAAqB,IAArC,EACA;CACC,aAAKta,MAAL,CAAY0K,aAAZ,CAA0B,KAA1B;CAEA2P,QAAAA,QAAQ,CAACC,OAAT,GAAmB,KAAnB;CACA1X,QAAAA,aAAG,CAACwU,WAAJ,CAAgB,KAAKT,iBAAL,EAAhB,EAA0C,+BAA1C;CACA;;CAED,WAAKhY,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7CA,QAAAA,UAAU,CAACmP,WAAX;CACA,OAFD;CAGA;;;mCAGD;CACC,UAAIiN,QAAQ,GAAG,EAAf;;CAEA,UAAI,KAAKva,MAAL,CAAY6U,aAAZ,EAAJ,EACA;CACC0F,QAAAA,QAAQ,CAACzc,IAAT,CAAc,IAAd;CACA;;CAED,WAAKa,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7Coc,QAAAA,QAAQ,4CAAOA,QAAP,kCAAoBpc,UAAU,CAACqc,WAAX,EAApB,EAAR;CACA,OAFD;CAIA,aAAOD,QAAP;CACA;;;wCAGD;CACC,aAAO,KAAKC,WAAL,GAAmB7M,MAAnB,CAA0B,UAAA/P,IAAI;CAAA,eAAI,CAACA,IAAI,CAAC8K,WAAL,EAAD,IAAuB,CAAC9K,IAAI,CAAC+J,UAAL,EAA5B;CAAA,OAA9B,CAAP;CACA;;;2CAEqBwC,GACtB;CACC,UAAI,CAAC,KAAKkO,cAAL,EAAL,EACA;CACClO,QAAAA,CAAC,CAAC+B,MAAF,CAASoO,OAAT,GAAmB,KAAnB;CACA;CACA;;CAED,WAAK/B,YAAL;CACA;;;oCAGD;CACC,UAAMxM,QAAQ,GAAG,KAAK3M,WAAL,EAAjB;;CAEA,UAAI,KAAKY,MAAL,CAAY6U,aAAZ,EAAJ,EACA;CACC,aAAKrL,SAAL,CAAekI,aAAf,mBAAwC,KAAK7S,SAAL,EAAxC,GAA4Dyb,OAA5D,GAAsE,KAAtE;CACA,aAAKta,MAAL,CAAY0K,aAAZ,CAA0B,KAA1B;CAEAqB,QAAAA,QAAQ,CAACiL,eAAT,CAAyBjL,QAAzB,EAAmC,KAAKvC,SAAxC;;CAEA,YAAI,CAAC,KAAKc,kBAAL,EAAL,EACA;CACC1H,UAAAA,aAAG,CAACyH,IAAJ,CAAS0B,QAAQ,CAAC1E,KAAlB;CACA;CACD,OAXD,MAaA;CACC,aAAKmC,SAAL,CAAekI,aAAf,mBAAwC,KAAK7S,SAAL,EAAxC,GAA4Dyb,OAA5D,GAAsE,IAAtE;CACA,aAAKta,MAAL,CAAY0K,aAAZ,CAA0B,IAA1B;CAEAqB,QAAAA,QAAQ,CAACiL,eAAT,CAAyBjL,QAAzB,EAAmC,KAAKvC,SAAxC;CACA;;CAED5G,MAAAA,aAAG,CAACoW,WAAJ,CAAgB,KAAKrC,iBAAL,EAAhB,EAA0C,+BAA1C;CACA;;;0CAGD;CACC,UAAI,CAAC,KAAKvX,WAAL,GAAmBwV,sBAAnB,EAAL,EACA;CACC,aAAKE,WAAL;CACA;CACD;;;mCAGD;CACC,UAAI,KAAK9U,MAAL,CAAY6U,aAAZ,EAAJ,EACA;CACC,aAAKvH,WAAL;CACA,aAAKtN,MAAL,CAAY0K,aAAZ,CAA0B,KAA1B;;CAEA,YAAI,CAAC,KAAKJ,kBAAL,EAAL,EACA;CACC1H,UAAAA,aAAG,CAACyH,IAAJ,CAAS,KAAKjL,WAAL,GAAmBiI,KAA5B;CACA;CACD,OATD,MAWA;CACC,aAAKrH,MAAL,CAAY0K,aAAZ,CAA0B,IAA1B;;CAEA,YAAI,KAAK1K,MAAL,CAAYya,aAAZ,EAAJ,EACA;CACC,eAAKC,cAAL;CACA;CACD;;CAED9X,MAAAA,aAAG,CAACoW,WAAJ,CAAgB,KAAKxP,SAArB,EAAgC,4CAAhC;CACA5G,MAAAA,aAAG,CAACoW,WAAJ,CAAgB,KAAKxP,SAArB,EAAgC,0CAAhC;CACA;;;6CAGD;CACC,UAAI,KAAKmR,eAAT,EACA;CACC;CACA;;CAED,WAAKD,cAAL;CACA;;;sCAGD;CAAA;;CACC,WAAKC,eAAL,GAAuB,IAAvB;CAEA,UAAMC,WAAW,GAAG,KAAKpR,SAAL,CAAekI,aAAf,YAAiC,KAAKmJ,YAAtC,EAApB;CACA,UAAMC,iBAAiB,aAAMlY,aAAG,CAACuT,WAAJ,CAAgByE,WAAhB,EAA6B3R,MAAnC,OAAvB;;CAEA,UAAI,CAACrG,aAAG,CAACC,QAAJ,CAAa,KAAK2G,SAAlB,EAA6B,KAAKuR,aAAlC,CAAL,EACA;CACC,aAAK/a,MAAL,CAAYgb,aAAZ,CAA0B,IAA1B;CAEAJ,QAAAA,WAAW,CAAC7R,KAAZ,CAAkBC,QAAlB,GAA6B,QAA7B;CACA4R,QAAAA,WAAW,CAAC7R,KAAZ,CAAkBE,MAAlB,GAA2B6R,iBAA3B;CACApU,QAAAA,UAAU,CAAC,YAAM;CAAEkU,UAAAA,WAAW,CAAC7R,KAAZ,CAAkBE,MAAlB,GAA2B,CAA3B;CAA+B,SAAxC,EAA0C,CAA1C,CAAV;CAEArG,QAAAA,aAAG,CAACE,QAAJ,CAAa,KAAK0G,SAAlB,EAA6B,KAAKuR,aAAlC;CAEA,aAAKJ,eAAL,GAAuB,KAAvB;CACA,OAXD,MAaA;CACC,aAAK3a,MAAL,CAAYgb,aAAZ,CAA0B,KAA1B;CAEAJ,QAAAA,WAAW,CAAC7R,KAAZ,CAAkBE,MAAlB,GAA2B,CAA3B;CACA2R,QAAAA,WAAW,CAAC7R,KAAZ,CAAkBE,MAAlB,aAA8B2R,WAAW,CAACxR,YAA1C;;CAEA,YAAM6R,aAAa,GAAG,SAAhBA,aAAgB,GAAM;CAC3BL,UAAAA,WAAW,CAAC7R,KAAZ,CAAkBE,MAAlB,GAA2B,MAA3B;CACAxD,UAAAA,EAAE,CAACyV,MAAH,CAAUN,WAAV,EAAuB,eAAvB,EAAwCK,aAAxC;CAEA,UAAA,OAAI,CAACN,eAAL,GAAuB,KAAvB;CACA,SALD;;CAMAlV,QAAAA,EAAE,CAAC/D,IAAH,CAAQkZ,WAAR,EAAqB,eAArB,EAAsCK,aAAtC;CAEArY,QAAAA,aAAG,CAACwU,WAAJ,CAAgB,KAAK5N,SAArB,EAAgC,KAAKuR,aAArC;CACA;CACD;;;mCAGD;CACCnY,MAAAA,aAAG,CAACoW,WAAJ,CAAgB,KAAKxP,SAArB,EAAgC,uBAAhC;CACA;;;iDAGD;CACC,UAAMgE,SAAS,GAAG,KAAKC,YAAL,EAAlB;CACA,UAAM0N,mBAAmB,GAAG3N,SAAS,CAAC4N,eAAV,EAA5B;CAEA5N,MAAAA,SAAS,CAACxN,MAAV,CAAiBmZ,aAAjB,CAA+BgC,mBAA/B;;CAEA,UAAIA,mBAAmB,IAAI,CAACvY,aAAG,CAACC,QAAJ,CAAa2K,SAAS,CAAChE,SAAvB,EAAkC,0BAAlC,CAA5B,EACA;CACCgE,QAAAA,SAAS,CAACkN,cAAV;CACA;CACD;;;8CAGD;CACC,UAAMlN,SAAS,GAAG,KAAKC,YAAL,EAAlB;CACA,UAAM4N,gBAAgB,GAAG7N,SAAS,CAACtO,mBAAV,OAAoC,CAA7D;;CAEA,UACEmc,gBAAgB,IAAI,CAACzY,aAAG,CAACC,QAAJ,CAAa2K,SAAS,CAAChE,SAAvB,EAAkC,uBAAlC,CAAtB,IACI,CAAC6R,gBAAD,IAAqBzY,aAAG,CAACC,QAAJ,CAAa2K,SAAS,CAAChE,SAAvB,EAAkC,uBAAlC,CAF1B,EAIA;CACCgE,QAAAA,SAAS,CAAC8N,WAAV;CACA;CACD;;;8CAGD;CACC,WAAKC,yBAAL;CACA,WAAK9D,sBAAL;CACA;;;qCAEetN,GAAGqR,MACnB;CACC,aAAO,KAAKC,iBAAL,CAAuBD,IAAvB,KACH,KAAKC,iBAAL,CAAuBD,IAAvB,EAA6BE,IAA7B,CAAkC,UAAA9d,IAAI;CAAA,eAAIuM,CAAC,CAAC+B,MAAF,CAAS6M,OAAT,CAAiBnb,IAAjB,CAAJ;CAAA,OAAtC,CADJ;CAEA;;;mCAGD;CACC,aAAO,KAAK8J,aAAL,CAAmBiU,SAAnB,EAAP;CACA;;;6CAGD;CACC,aAAO,KAAKjU,aAAL,CAAmBkU,mBAAnB,EAAP;CACA;;;sCAGD;CACC,aAAO,KAAKjV,MAAL,CAAYE,SAAnB;CACA;;;sCAGD;CACC,aAAO,KAAKF,MAAL,CAAYI,SAAnB;CACA;;;sCAGD;CACC,aAAO,KAAKJ,MAAL,CAAYM,SAAnB;CACA;;;oCAGD;CACC,aAAO,KAAKN,MAAL,CAAYQ,OAAnB;CACA;;;yCAGD;CACC,aAAQ,KAAKuB,WAAL,KAAqB,kCAArB,GAA0D,uCAAlE;CACA;;;6CAGD;CACC,aAAO,KAAKc,SAAL,CAAekI,aAAf,YAAiC,KAAK6B,iBAAL,EAAjC,EAAP;CACA;;;+CAGD;CACC,aAAO,KAAK/J,SAAL,CAAekI,aAAf,wBAA6C,KAAK7S,SAAL,EAA7C,EAAP;CACA;;;4CAGD;CACC,aAAO,KAAK2K,SAAL,CAAekI,aAAf,qBAA0C,KAAK7S,SAAL,EAA1C,EAAP;CACA;;;yCAGD;CACC,aAAO,KAAK2K,SAAL,CAAekI,aAAf,CAA6B,KAAKhJ,WAAL,KAAqB,8BAArB,GAAsD,6BAAnF,CAAP;CACA;;;oCAGD;CACC,aAAO,KAAKc,SAAZ;CACA;;;0BAEI5L,MACL;CAAA,UADWC,QACX,uEADsB,QACtB;CAAA,UADgC8I,MAChC,uEADyC,MACzC;;CACC,UACC,KAAK9H,SAAL,OAAqBjB,IAAI,CAACiB,SAAL,EAArB,IACG,KAAKG,SAAL,CAAepB,IAAI,CAACiB,SAAL,EAAf,MAAqC,IAFzC,EAIA;CACC;CACA;;CAED,UAAMkE,SAAS,GAAG,KAAKvF,SAAL,EAAlB;CACA,UAAMwF,SAAS,GAAGpF,IAAI,CAACJ,SAAL,EAAlB;CAEAuF,MAAAA,SAAS,CAACuG,MAAV,CAAiB,IAAjB;;CAEA,UAAIzL,QAAQ,KAAK,KAAjB,EACA;CACCmF,QAAAA,SAAS,CAAC6Y,SAAV,CAAoB,IAApB,EAA0Bje,IAA1B;CACA,OAHD,MAKA;CACCoF,QAAAA,SAAS,CAAC8Y,QAAV,CAAmB,IAAnB,EAAyBle,IAAzB;CACA;;CAED6E,MAAAA,aAAa,CAACsZ,aAAd,CAA4BhZ,SAA5B,EAAuCC,SAAvC;;CAEA,UAAInF,QAAQ,KAAK,KAAjB,EACA;CACC+E,QAAAA,aAAG,CAACmU,YAAJ,CAAiB,KAAKvN,SAAtB,EAAiC5L,IAAI,CAAC4L,SAAtC;CACA,OAHD,MAKA;CACC5G,QAAAA,aAAG,CAACoZ,WAAJ,CAAgB,KAAKxS,SAArB,EAAgC5L,IAAI,CAAC4L,SAArC;CACA;;CAED,WAAKiO,sBAAL;CACA,WAAKpM,iBAAL;CAEArB,MAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,yCAAxB,EAAmE;CAACvD,QAAAA,MAAM,EAANA;CAAD,OAAnE;CACA;;;iCAEW/I,MACZ;CAAA,UADkBC,QAClB,uEAD6B,QAC7B;CAAA,UADuC8I,MACvC,uEADgD,aAChD;;CACC,UAAI/I,IAAI,CAACsB,mBAAL,KAA6B,CAAjC,EACA;CACC,YAAM+c,WAAW,GAAG;CACnBnW,UAAAA,GAAG,EAAElI,IAAI,CAACW,kBAAL,EADc;CAEnB2d,UAAAA,MAAM,EAAEte,IAAI,CAACY,iBAAL;CAFW,SAApB;CAKA,aAAK2d,IAAL,CAAUF,WAAW,CAACpe,QAAD,CAArB,EAAiCA,QAAjC,EAA2C8I,MAA3C;CACA,OARD,MAUA;CACC,YAAM5D,SAAS,GAAG,KAAKvF,SAAL,EAAlB;CACA,YAAMwF,SAAS,GAAGpF,IAAlB;CAEAmF,QAAAA,SAAS,CAACuG,MAAV,CAAiB,IAAjB;CACAtG,QAAAA,SAAS,CAAC5E,GAAV,CAAc,IAAd;CAEAqE,QAAAA,aAAa,CAACsZ,aAAd,CAA4BhZ,SAA5B,EAAuCC,SAAvC;CAEAJ,QAAAA,aAAG,CAAC0T,MAAJ,CAAW,KAAK9M,SAAhB,EAA2BxG,SAAS,CAACoZ,oBAAV,EAA3B;CACAxZ,QAAAA,aAAG,CAACE,QAAJ,CAAa,KAAK0G,SAAlB,EAA6B,4CAA7B;CAEA,aAAKiO,sBAAL;CACA,aAAKpM,iBAAL;CAEArB,QAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,yCAAxB,EAAmE;CAACvD,UAAAA,MAAM,EAANA;CAAD,SAAnE;CACA;CACD;;;6BAGD;CACC,UAAI,CAAC,KAAKlI,iBAAL,EAAL,EACA;CACC,aAAK4O,WAAL,CAAiB,KAAKgP,cAAL,EAAjB,EAAwC,QAAxC,EAAkD,OAAlD;CACA;CACD;;;oCAGD;CACC,UAAI,KAAK/R,kBAAL,EAAJ,EACA;CACC,aAAKG,sBAAL,CAA4B,UAAC2C,YAAD,EAAkB;CAC7CA,UAAAA,YAAY,CAACkP,KAAb;CACA,SAFD;CAIA;CACA;;CAED,WAAKA,KAAL;CACA,WAAKtN,aAAL;CACA;;;8BAGD;CACC,UAAMzR,MAAM,GAAG,KAAKC,SAAL,EAAf;;CAEA,UAAID,MAAM,CAACmL,WAAP,EAAJ,EACA;CACC;CACA;;CAED,WAAKyT,IAAL,CAAU5e,MAAV,EAAkB,QAAlB,EAA4B,QAA5B;CACA;;;qCAGD;CACC,UAAI,KAAK+M,kBAAL,EAAJ,EACA;CACC,aAAKG,sBAAL,CAA4B,UAAC2C,YAAD,EAAkB;CAC7CA,UAAAA,YAAY,CAACmP,MAAb;CACA,SAFD,EAEG,IAFH;CAIA;CACA;;CAED,WAAKA,MAAL;CACA,WAAKvN,aAAL;CACA;;;wCAGD;CAAA;;CAAA,UADiBpR,IACjB,uEADwB,IACxB;CAAA,UAD8B4e,SAC9B,uEAD0C,IAC1C;CAAA,UADgD3e,QAChD,uEAD2D,OAC3D;CACC,UAAM4e,OAAO,GAAG7e,IAAI,YAAY,KAAK8e,KAArC;CAEA,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;CAC/B,YAAMC,gBAAgB,GAAGjf,IAAI,IAAI,IAAI,OAAI,CAAC8e,KAAT,EAAjC;CACA,YAAII,sBAAJ;;CAEA,YAAIN,SAAS,YAAY,OAAI,CAACE,KAA9B,EACA;CACC,cAAI7e,QAAQ,KAAK,QAAjB,EACA;CACC,YAAA,OAAI,CAACge,SAAL,CAAegB,gBAAf,EAAiCL,SAAjC;;CAEAM,YAAAA,sBAAsB,GAAGD,gBAAgB,CAACE,SAAjB,EAAzB;;CACA,YAAA,OAAI,CAACxT,gBAAL,CAAsBuT,sBAAtB;;CAEAla,YAAAA,aAAG,CAACmU,YAAJ,CAAiB+F,sBAAjB,EAAyCN,SAAS,CAAChT,SAAnD;CACA,WARD,MASK,IAAI3L,QAAQ,KAAK,OAAjB,EACL;CACC,YAAA,OAAI,CAACie,QAAL,CAAce,gBAAd,EAAgCL,SAAhC;;CAEAM,YAAAA,sBAAsB,GAAGD,gBAAgB,CAACE,SAAjB,EAAzB;;CACA,YAAA,OAAI,CAACxT,gBAAL,CAAsBuT,sBAAtB;;CAEAla,YAAAA,aAAG,CAACoZ,WAAJ,CAAgBc,sBAAhB,EAAwCN,SAAS,CAAChT,SAAlD;CACA;CACD,SApBD,MAsBA;CACC,UAAA,OAAI,CAACpL,GAAL,CAASye,gBAAT;;CAEAC,UAAAA,sBAAsB,GAAGD,gBAAgB,CAACE,SAAjB,EAAzB;;CACA,UAAA,OAAI,CAACxT,gBAAL,CAAsBuT,sBAAtB;;CAEAla,UAAAA,aAAG,CAAC0T,MAAJ,CAAWwG,sBAAX,EAAmC,OAAI,CAACV,oBAAL,EAAnC;CACA;;CAED,QAAA,OAAI,CAACnZ,YAAL;;CACA,QAAA,OAAI,CAACE,aAAL;;CAEA,YAAI,CAAC,OAAI,CAACwE,UAAL,EAAL,EACA;CACC,UAAA,OAAI,CAACzE,cAAL;;CACA,UAAA,OAAI,CAACuU,sBAAL;;CAEA,cAAI,CAACgF,OAAL,EACA;CACCI,YAAAA,gBAAgB,CAAC3E,gBAAjB;CACA;CACD;;CAEDxR,QAAAA,UAAU,CAAC,YAAM;CAChBoW,UAAAA,sBAAsB,CAAC/T,KAAvB,CAA6BE,MAA7B,aAAyC6T,sBAAsB,CAAC1T,YAAhE;CACA0T,UAAAA,sBAAsB,CAAC/T,KAAvB,CAA6BG,OAA7B,GAAuC,CAAvC;CACA,SAHS,EAGP,CAHO,CAAV;CAKAxC,QAAAA,UAAU,CAAC,YAAM;CAChBoW,UAAAA,sBAAsB,CAAC/T,KAAvB,CAA6BC,QAA7B,GAAwC,EAAxC;CACA8T,UAAAA,sBAAsB,CAAC/T,KAAvB,CAA6BE,MAA7B,GAAsC,EAAtC;CACA6T,UAAAA,sBAAsB,CAAC/T,KAAvB,CAA6BG,OAA7B,GAAuC,EAAvC;CAEAtG,UAAAA,aAAG,CAACwU,WAAJ,CAAgB0F,sBAAhB,EAAwC,OAAI,CAAC3T,SAA7C;;CAEA,cAAI,CAAC,OAAI,CAACxB,UAAL,EAAD,IAAsB,CAAC8U,OAAvB,IAAkCI,gBAAgB,CAAChZ,KAAjB,KAA2B,IAAjE,EACA;CACC,YAAA,OAAI,CAAC6Y,KAAL,CAAWM,YAAX,CAAwBH,gBAAgB,CAAC7G,YAAjB,EAAxB;CACA;;CAED4G,UAAAA,OAAO,CAACC,gBAAD,CAAP;CACA,SAbS,EAaP,GAbO,CAAV;CAcA,OApEM,CAAP;CAqEA;;;+CAGD;CACC,UAAI,KAAKzd,WAAL,GAAmBwV,sBAAnB,EAAJ,EACA;CACC;CACA;;CAED,WAAKjL,gBAAL;CACA;;;0CAGD;CACC,UAAMsT,eAAe,GAAG;CACvBC,QAAAA,OAAO,EAAE,KAAKre,SAAL,EADc;CAEvBse,QAAAA,cAAc,EAAE,KAAK3f,SAAL,GAAiBqB,SAAjB,EAFO;CAGvBue,QAAAA,EAAE,EAAE,KAAKpd,MAAL,CAAY4H,KAAZ,EAHmB;CAIvByV,QAAAA,SAAS,EAAE,KAAKrd,MAAL,CAAYsd,WAAZ,EAJY;CAKvBC,QAAAA,SAAS,EAAE,KAAKvd,MAAL,CAAYwd,WAAZ,EALY;CAMvBzP,QAAAA,KAAK,EAAE3L,cAAI,CAAC2M,MAAL,CAAY,KAAK/O,MAAL,CAAY6J,QAAZ,EAAZ,CANgB;CAOvB4T,QAAAA,UAAU,EAAE,KAAKzd,MAAL,CAAY0J,YAAZ,EAPW;CAQvBgU,QAAAA,WAAW,EAAE,KAAK1d,MAAL,CAAY+H,aAAZ,EARU;CASvB4V,QAAAA,YAAY,EAAE,KAAK3d,MAAL,CAAYsS,cAAZ,EATS;CAUvBsL,QAAAA,OAAO,EAAE,EAVc;CAWvBC,QAAAA,WAAW,EAAE;CAXU,OAAxB;CAcA,WAAK7d,MAAL,CAAYkT,UAAZ,GAAyBnU,OAAzB,CAAiC,UAAC4F,KAAD,EAAQmZ,GAAR,EAAgB;CAAA,YACzC3b,aADyC,GAClBwC,KADkB,CACzCxC,aADyC;CAAA,YAC1BG,IAD0B,GAClBqC,KADkB,CAC1BrC,IAD0B;CAEhD2a,QAAAA,eAAe,CAACW,OAAhB,CAAwB9f,IAAxB,iCACEggB,GADF,EACQ;CACN7b,UAAAA,IAAI,EAAEK,IADA;CAENN,UAAAA,IAAI,EAAEI,cAAI,CAAC2M,MAAL,CAAY5M,aAAZ;CAFA,SADR;CAMA,OARD;CAUA,UAAMpB,WAAW,GAAG,KAAKf,MAAL,CAAYsX,cAAZ,EAApB;CACArW,MAAAA,MAAM,CAACC,IAAP,CAAYH,WAAZ,EAAyBhC,OAAzB,CAAiC,UAACkB,EAAD,EAAQ;CACxCgd,QAAAA,eAAe,CAACY,WAAhB,CAA4B5d,EAA5B,IAAkCc,WAAW,CAACd,EAAD,CAA7C;CACA,OAFD;CAIA,aAAOgd,eAAP;CACA;;;sCAGD;CAAA,UADec,SACf,uEAD2B,IAC3B;CACC,UAAM5d,KAAK,GAAG,KAAKH,MAAL,CAAY6J,QAAZ,EAAd;CACA,UAAIC,IAAI,GAAGiU,SAAS,IAAI,EAAxB;;CAEA,UAAI,CAAC,KAAKpW,UAAL,EAAD,IAAsBxH,KAAK,KAAK,EAAhC,IAAsCA,KAAK,CAAC7B,MAAN,GAAe,CAAzD,EACA;CACCwL,QAAAA,IAAI,CAAChM,IAAL,CAAU,KAAKkgB,kBAAL,EAAV;CACA;;CAED,WAAKrf,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7C2L,QAAAA,IAAI,GAAG3L,UAAU,CAAC8f,cAAX,CAA0BnU,IAA1B,CAAP;CACA,OAFD;CAIA,aAAOA,IAAP;CACA;;;2CAGD;CACC,UAAI,CAAC,KAAKnC,UAAL,EAAL,EACA;CACC,YAAMlK,MAAM,GAAG,KAAKoB,SAAL,EAAf;CACA,YAAMkC,WAAW,GAAG,KAAKf,MAAL,CAAYsX,cAAZ,EAApB;CACA,YAAM7G,MAAM,aAAM,KAAK/I,aAAL,CAAmB+I,MAAzB,cAAmChT,MAAnC,MAAZ;CAEA,YAAIqU,aAAa,GAAG,EAApB;CACA,YAAIoM,iBAAiB,GAAG,EAAxB;CAEA,aAAKle,MAAL,CAAYkT,UAAZ,GAAyBnU,OAAzB,CAAiC,UAAC4F,KAAD,EAAQmZ,GAAR,EAAgB;CAChDhM,UAAAA,aAAa,uDAA6CgM,GAA7C,uBAA2DrN,MAA3D,uBAA8EqN,GAA9E,+BAAoGnZ,KAAK,CAACrC,IAA1G,SAAb;CACAwP,UAAAA,aAAa,uDAA6CgM,GAA7C,uBAA2DrN,MAA3D,uBAA8EqN,GAA9E,+BAAoGnZ,KAAK,CAACxC,aAA1G,SAAb;CACA,SAHD;CAKAlB,QAAAA,MAAM,CAACC,IAAP,CAAYH,WAAZ,EAAyBhC,OAAzB,CAAiC,UAACkB,EAAD,EAAQ;CACxCie,UAAAA,iBAAiB,sDAA4Cje,EAA5C,uBAAyDwQ,MAAzD,2BAAgFxQ,EAAhF,yBAA+Fc,WAAW,CAACd,EAAD,CAA1G,SAAjB;CACA,SAFD;CAIA,YAAMke,aAAa,GAAG7S,aAAG,CAACC,MAAP,sBACC9N,MADD,EAEyBgT,MAFzB,EAEoDhT,MAFpD,EAGgCgT,MAHhC,EAGkE,KAAKjT,SAAL,GAAiBqB,SAAjB,EAHlE,EAIoB4R,MAJpB,EAI0C,KAAKzQ,MAAL,CAAY4H,KAAZ,EAJ1C,EAK2B6I,MAL3B,EAKwD,KAAKzQ,MAAL,CAAYsd,WAAZ,EALxD,EAM2B7M,MAN3B,EAMwD,KAAKzQ,MAAL,CAAYwd,WAAZ,EANxD,EAOuB/M,MAPvB,EAOgD,KAAKzQ,MAAL,CAAY6J,QAAZ,EAPhD,EAQ4B4G,MAR5B,EAQ0D,KAAKzQ,MAAL,CAAY0J,YAAZ,EAR1D,EAS6B+G,MAT7B,EAS4D,KAAKzQ,MAAL,CAAY+H,aAAZ,EAT5D,EAU8B0I,MAV9B,EAU8D,KAAKzQ,MAAL,CAAYsS,cAAZ,EAV9D,EAWwB7B,MAXxB,EAW0D,KAAK4H,cAAL,EAX1D,EAYwB5H,MAZxB,EAY0D,KAAK2N,cAAL,EAZ1D,EAawB3N,MAbxB,EAa0D,KAAKwI,cAAL,EAb1D,EAcfnH,aAde,EAefoM,iBAfe,CAAnB;CAmBAtb,QAAAA,aAAG,CAAC0G,MAAJ,CAAW,KAAKE,SAAL,CAAekI,aAAf,oBAAyCjU,MAAzC,EAAX;CACAmF,QAAAA,aAAG,CAAC0T,MAAJ,CAAW6H,aAAX,EAA0B,KAAK3U,SAA/B;CACA;;CAED,WAAK7K,cAAL,GAAsBI,OAAtB,CAA8B,UAACZ,UAAD,EAAgB;CAC7CA,QAAAA,UAAU,CAACkgB,mBAAX;CACA,OAFD;CAGA;;;4CAGD;CAAA;;CACC,UAAMC,QAAQ,GAAG,KAAKte,MAAL,CAAY4H,KAAZ,MAAuB,KAAK5H,MAAL,CAAYsd,WAAZ,EAAxC;CADD,UAEQ5V,aAFR,GAEyB,IAFzB,CAEQA,aAFR;CAGC,UAAM6W,iBAAiB,GAAG7W,aAAa,CAAC3G,WAAxC;CACA,UAAImd,iBAAiB,GAAG,EAAxB;;CAEA,UAAIK,iBAAiB,IAAKD,QAAQ,IAAIC,iBAAtC,EACA;CACC,YAAMxd,WAAW,GAAGuK,aAAG,CAACC,MAAP,sBAAgBgT,iBAAiB,CAACD,QAAD,CAAjC,CAAjB;CACA,YAAME,iBAAiB,GAAG,KAAKC,oBAAL,CAA0B/W,aAAa,CAACgX,sBAAd,EAA1B,CAA1B;CACA,YAAMC,mBAAmB,GAAG,EAA5B;;CAEA,YAAI,CAAC5d,WAAL,EACA;CACC,iBAAOmd,iBAAP;CACA;;CAEDA,QAAAA,iBAAiB,GAAGnd,WAApB;;CAEA,YAAI,CAAC6d,KAAK,CAACC,OAAN,CAAc9d,WAAd,CAAL,EACA;CACCmd,UAAAA,iBAAiB,GAAG,CAACnd,WAAD,CAApB;CACA;;CAEDE,QAAAA,MAAM,CAACC,IAAP,CAAYgd,iBAAZ,EAA+Bnf,OAA/B,CAAuC,UAAC+e,GAAD,EAAS;CAC/C,cAAMgB,UAAU,GAAGZ,iBAAiB,CAACJ,GAAD,CAApC;CACA,cAAMnM,MAAM,GAAGmN,UAAU,CAACC,YAAX,CAAwB,YAAxB,CAAf;CACA,cAAMC,SAAS,GAAGvc,aAAa,CAACwc,gBAAd,CAA+BH,UAAU,CAACC,YAAX,CAAwB,mBAAxB,CAA/B,CAAlB;CACA,cAAMG,cAAc,0BAAmBF,SAAnB,CAApB;CACA,cAAMG,aAAa,GAAGL,UAAU,CAACpN,aAAX,6BAA8CC,MAA9C,EAAtB;CACA,cAAMyN,YAAY,GAAG9T,aAAG,CAACC,MAAP,sBAEJ,OAAI,CAAC8T,uBAAL,CAA6B3d,IAA7B,CAAkC,OAAlC,EAAwCiQ,MAAxC,CAFI,CAAlB;CAIA,cAAM6C,GAAG,GAAGvT,MAAM,CAACqe,SAAP,CAAiBC,cAA7B;;CAEA,cAAI,CAAC/K,GAAG,CAACgL,IAAJ,CAAShB,iBAAT,EAA4B7M,MAA5B,CAAL,EACA;CACCgN,YAAAA,mBAAmB,CAAC7gB,IAApB,CAAyBggB,GAAzB;CACA;CACA;;CAED,cAAIqB,aAAa,IAAI,CAACvc,aAAG,CAACC,QAAJ,CAAasc,aAAb,EAA4BD,cAA5B,CAAtB,EACA;CACCtc,YAAAA,aAAG,CAACE,QAAJ,CAAaqc,aAAb,EAA4BD,cAA5B;CACA;;CAED,cAAI,OAAI,CAAC7G,cAAL,EAAJ,EACA;CACCzV,YAAAA,aAAG,CAAC0T,MAAJ,CAAW8I,YAAX,EAAyBN,UAAU,CAACpN,aAAX,CAAyB,6CAAzB,CAAzB;CACA;CACD,SA3BD;CA6BAiN,QAAAA,mBAAmB,CAACc,IAApB,CAAyB,UAACC,CAAD,EAAIC,CAAJ;CAAA,iBAAUA,CAAC,GAAGD,CAAd;CAAA,SAAzB;CACAf,QAAAA,mBAAmB,CAAC5f,OAApB,CAA4B,UAACkB,EAAD,EAAQ;CACnCie,UAAAA,iBAAiB,CAACngB,MAAlB,CAAyBkC,EAAzB,EAA6B,CAA7B;CACA,SAFD;CAGA,OAnDD,MAqDA;CACC,aAAKD,MAAL,CAAY4f,cAAZ,CAA2B,EAA3B;CACA;;CAED,aAAO1B,iBAAP;CACA;;;0CAEoBtgB,MACrB;CAAA;;CACC,UAAMoC,MAAM,GAAGpC,IAAI,CAACuc,MAApB;CACA,UAAMla,EAAE,GAAGD,MAAM,CAACC,EAAP,IAAaD,MAAM,CAAC2B,QAA/B;;CAEA,UAAI1B,EAAE,KAAK,KAAKD,MAAL,CAAY4H,KAAZ,EAAP,IAA8B3H,EAAE,KAAK,KAAKD,MAAL,CAAYsd,WAAZ,EAAzC,EACA;CACC,eAAOtd,MAAM,CAACe,WAAd;CACA;;CAED,UAAIjC,KAAK,GAAG,IAAZ;CACAlB,MAAAA,IAAI,CAACwc,WAAL,CAAiBrb,OAAjB,CAAyB,UAACZ,UAAD,EAAgB;CACxC,YAAIW,KAAK,KAAK,IAAd,EACA;CACCA,UAAAA,KAAK,GAAG,OAAI,CAAC2f,oBAAL,CAA0BtgB,UAA1B,CAAR;CACA;CACD,OALD;CAOA,aAAOW,KAAP;CACA;;;+CAEyBggB,YAC1B;CAAA,UACQ7e,EADR,GACwC6e,UADxC,CACQ7e,EADR;CAAA,UACYkB,IADZ,GACwC2d,UADxC,CACY3d,IADZ;CAAA,UACkB0e,OADlB,GACwCf,UADxC,CACkBe,OADlB;CAAA,UAC2B5gB,IAD3B,GACwC6f,UADxC,CAC2B7f,IAD3B;CAAA,UACiC0E,GADjC,GACwCmb,UADxC,CACiCnb,GADjC;CAEC,UAAImc,GAAG,GAAG,EAAV;;CAEA,UAAID,OAAJ,EACA;CACCC,QAAAA,GAAG,GAAGxU,aAAG,CAACC,MAAP,sBACqFsU,OADrF,EAEmE,KAAKR,uBAAL,CAA6B3d,IAA7B,CAAkC,IAAlC,EAAwCzB,EAAxC,CAFnE,CAAH;CAKA,OAPD,MASA;CACC,YAAM+e,SAAS,GAAGvc,aAAa,CAACwc,gBAAd,CAA+Btb,GAA/B,CAAlB;CAEAmc,QAAAA,GAAG,GAAGxU,aAAG,CAACC,MAAP,sBAEkCyT,SAFlC,EAGmE,KAAKK,uBAAL,CAA6B3d,IAA7B,CAAkC,IAAlC,EAAwCzB,EAAxC,CAHnE,CAAH;CAMA;;CAED,aAAOqL,aAAG,CAACC,MAAX,sBACqEtL,EADrE,EACwFA,EADxF,EAEI6f,GAFJ,EAI0E3e,IAJ1E,EAImFA,IAJnF,EAOmElC,IAPnE;CAWA;;;wDAGD;CACC,UAAI,KAAKsI,gBAAL,KAA0B,IAA9B,EACA;CACC,aAAKA,gBAAL,CAAsB4D,KAAtB;CACA;CACD;;;kDAGD;CAAA;;CACC,UAAM1N,MAAM,GAAG,KAAKoB,SAAL,EAAf;CADD,UAEQ4R,MAFR,GAEkB,KAAK/I,aAFvB,CAEQ+I,MAFR;CAGC,UAAMsP,YAAY,GAAGzU,aAAG,CAACC,MAAP,sBAEe9N,MAFf,EAWegT,MAXf,EAWyBhT,MAXzB,EAaaA,MAbb,EAaiC,KAAKuiB,gCAAL,CAAsCte,IAAtC,CAA2C,IAA3C,CAbjC,EAcV8B,aAAG,CAACC,UAAJ,CAAe,kDAAf,CAdU,EAgBwChG,MAhBxC,EAmB+B,KAAKuiB,gCAAL,CAAsCte,IAAtC,CAA2C,IAA3C,CAnB/B,EAqBV8B,aAAG,CAACC,UAAJ,CAAe,6CAAf,CArBU,EAwB+B,KAAKuc,gCAAL,CAAsCte,IAAtC,CAA2C,IAA3C,CAxB/B,EA0BJ8B,aAAG,CAACC,UAAJ,CAAe,+CAAf,CA1BI,CAAlB;CAkCAgC,MAAAA,EAAE,CAACwa,cAAH,CAAkBF,YAAlB,EAAgC,qBAAhC,EAAuD,KAAKG,mBAAL,CAAyBxe,IAAzB,CAA8B,IAA9B,CAAvD;CACA+D,MAAAA,EAAE,CAACwa,cAAH,CAAkBF,YAAlB,EAAgC,6BAAhC,EAA+D,UAACI,EAAD,EAAQ;CACtEA,QAAAA,EAAE,CAACC,iBAAH,GAAuB,OAAI,CAACC,gBAAL,CAAsB3e,IAAtB,CAA2B,OAA3B,CAAvB;CACA,OAFD;CAIA,aAAOqe,YAAP;CACA;;;sCAEgBniB,MAAM0J,UACvB;CAAA,UACQrH,EADR,GAC0BrC,IAD1B,CACQqC,EADR;CAAA,UACYkB,IADZ,GAC0BvD,IAD1B,CACYuD,IADZ;CAAA,UACkBlC,IADlB,GAC0BrB,IAD1B,CACkBqB,IADlB;CAEC,UAAMqhB,WAAW,GAAGtjB,IAAI,CAACujB,GAAL,CAASjZ,QAAT,EAAmB,EAAnB,CAApB;;CAEA,UAAI,CAAC,KAAKE,uBAAL,CAA6BgN,GAA7B,CAAiCvU,EAAjC,CAAL,EACA;CACC,YAAMugB,UAAU,GAAG,IAAI/a,EAAE,CAACkG,EAAH,CAAM4J,aAAV,CAAwB;CAC1CtV,UAAAA,EAAE,0BAAmBA,EAAnB,CADwC;CAE1C0E,UAAAA,KAAK,EAAE2b,WAFmC;CAG1C9K,UAAAA,QAAQ,EAAE,GAHgC;CAI1CC,UAAAA,KAAK,EAAE,EAJmC;CAK1CC,UAAAA,QAAQ,EAAE,CALgC;CAM1CC,UAAAA,IAAI,EAAE,KANoC;CAO1CC,UAAAA,KAAK,EAAEnQ,EAAE,CAACkG,EAAH,CAAM4J,aAAN,CAAoBM,KAApB,CAA0BC,OAPS;CAQ1C2K,UAAAA,UAAU,EAAEhb,EAAE,CAACkG,EAAH,CAAM4J,aAAN,CAAoBmL,MAApB,CAA2BC;CARG,SAAxB,CAAnB;CAUA,YAAMC,WAAW,GAAGtV,aAAG,CAACC,MAAP,sBACoDtL,EADpD,EAEbugB,UAAU,CAACxK,YAAX,EAFa,EAIyD7U,IAJzD,EAIkEA,IAJlE,EAOkDlC,IAPlD,CAAjB;CAYA,aAAKuI,uBAAL,CAA6BtF,GAA7B,CAAiCjC,EAAjC,EAAqCugB,UAArC;CACA5d,QAAAA,aAAG,CAAC0T,MAAJ,CAAWsK,WAAX,EAAwB,KAAK/O,uBAAL,EAAxB;CACA;;CAED,UAAI,CAACjU,IAAI,CAACijB,gBAAV,EACA;CACCjjB,QAAAA,IAAI,CAACijB,gBAAL,GAAwB,CAAxB;CACA;;CAED,UAAIP,WAAW,GAAG1iB,IAAI,CAACijB,gBAAvB,EACA;CACCjjB,QAAAA,IAAI,CAACijB,gBAAL,GAAwB7jB,IAAI,CAAC8jB,IAAL,CAAUR,WAAV,CAAxB;CACA1iB,QAAAA,IAAI,CAACijB,gBAAL,GAAwBjjB,IAAI,CAACijB,gBAAL,GAAwB,GAAxB,GAA8B,GAA9B,GAAoCjjB,IAAI,CAACijB,gBAAjE;;CAEA,YAAI,KAAKrZ,uBAAL,CAA6BgN,GAA7B,CAAiCvU,EAAjC,CAAJ,EACA;CACC,eAAKuH,uBAAL,CAA6BuZ,GAA7B,CAAiC9gB,EAAjC,EAAqCwI,MAArC,CAA4C7K,IAAI,CAACijB,gBAAjD;CACA;CACD;CACD;;;yCAEmBG,YAAYb,IAAIc,MAAMC,cAC1C;CACC,UAAI,OAAOD,IAAP,KAAgB,WAAhB,IAA+B,OAAOC,YAAP,KAAwB,WAA3D,EACA;CACC;CACA;;CAED,UAAMC,YAAY,GAAGH,UAAU,CAACI,UAAX,CAAsBlkB,QAAtB,EAArB;CACA,UAAM4hB,UAAU,GAAG;CAClB7e,QAAAA,EAAE,EAAEkhB,YADc;CAElBhgB,QAAAA,IAAI,EAAE6f,UAAU,CAACK,YAFC;CAGlBxB,QAAAA,OAAO,EAAEmB,UAAU,CAACM,WAHF;CAIlBriB,QAAAA,IAAI,EAAEiiB,YAAY,CAACjiB,IAJD;CAKlB0E,QAAAA,GAAG,EAAEud,YAAY,CAACvd;CALA,OAAnB;CAQA,WAAK3D,MAAL,CAAYuhB,cAAZ,iCAA6BJ,YAA7B,EAA4CA,YAA5C;CACA,WAAK3Z,uBAAL,CAA6BhF,MAA7B,CAAoC0e,YAAY,CAACjhB,EAAjD;CAEA,UAAMuhB,kBAAkB,GAAG,KAAK3P,uBAAL,GAA+BH,aAA/B,wBAA6DwP,YAAY,CAACjhB,EAA1E,EAA3B;CACA,UAAMwhB,gBAAgB,GAAG,KAAKC,yBAAL,CAA+B5C,UAA/B,CAAzB;;CAEA,UAAI0C,kBAAJ,EACA;CACC5e,QAAAA,aAAG,CAACjD,OAAJ,CAAY6hB,kBAAZ,EAAgCC,gBAAhC;CACA,OAHD,MAKA;CACC7e,QAAAA,aAAG,CAAC0T,MAAJ,CAAWmL,gBAAX,EAA6B,KAAK5P,uBAAL,EAA7B;CACA;;CAED,UAAM5R,EAAE,GAAG,KAAKD,MAAL,CAAY4H,KAAZ,EAAX;CACA,UAAM2W,iBAAiB,GAAG,KAAK7W,aAAL,CAAmB3G,WAA7C;;CAEA,UAAIwd,iBAAJ,EACA;CACC,YAAIte,EAAE,IAAIse,iBAAV,EACA;CACC,eAAK7W,aAAL,CAAmB3G,WAAnB,CAA+Bd,EAA/B,KAAsCwhB,gBAAgB,CAACE,SAAvD;CACA,SAHD,MAKA;CACC,eAAKja,aAAL,CAAmB3G,WAAnB,CAA+Bd,EAA/B,IAAqCwhB,gBAAgB,CAACE,SAAtD;CACA;CACD;;CAED3X,MAAAA,eAAK,CAACC,YAAN,CAAmBC,IAAnB,CAAwB,yCAAxB,EAAmE;CAACvD,QAAAA,MAAM,EAAE;CAAT,OAAnE;CACA;;;uCAEiBib,UAClB;CACC,WAAKpY,SAAL,GAAiB8B,aAAG,CAACC,MAArB,sBAEsB,KAAK1M,SAAL,EAFtB,EAGK+iB,QAHL;CAQA,aAAO,KAAKpY,SAAZ;CACA;;;wCAEkBoY,UACnB;CACC,UAAMnkB,MAAM,GAAG,KAAKoB,SAAL,EAAf;CACA,UAAM8F,KAAK,GAAG,KAAK3E,MAAL,CAAYuI,iBAAZ,EAAd;CACA,UAAMiN,QAAQ,GAAG,KAAKxV,MAAL,CAAYsI,aAAZ,EAAjB;CACA,UAAMuZ,OAAO,GAAG;CACfC,QAAAA,gBAAgB,EAAExW,aAAG,CAACC,MAAN,qBADD;CAEfwW,QAAAA,WAAW,EAAE,EAFE;CAGfC,QAAAA,SAAS,EAAE1W,aAAG,CAACC,MAAN;CAHM,OAAhB;;CAMA,UAAI,KAAK0W,WAAL,EAAJ,EACA;CACC,YAAMC,eAAe,GAAG5W,aAAG,CAACC,MAAP,sBAC+B,KAAK4W,uBAAL,CAA6BzgB,IAA7B,CAAkC,IAAlC,CAD/B,EAEjB8B,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAFiB,CAArB;CAKA,YAAMse,WAAW,GAAGzW,aAAG,CAACC,MAAP,sBACyC,KAAK6W,kBAAL,CAAwB1gB,IAAxB,CAA6B,IAA7B,CADzC,EAEb8B,aAAG,CAACC,UAAJ,CAAe,+BAAf,CAFa,CAAjB;CAMAb,QAAAA,aAAG,CAAC0T,MAAJ,CAAW4L,eAAX,EAA4BL,OAAO,CAACC,gBAApC;CACAD,QAAAA,OAAO,CAACE,WAAR,GAAsBA,WAAtB;CACA;;CAED,UAAI,KAAK3D,cAAL,EAAJ,EACA;CACC,YAAMiE,kBAAkB,GAAG/W,aAAG,CAACC,MAAP,sBAC+B,KAAKkH,aAAL,CAAmB/Q,IAAnB,CAAwB,IAAxB,CAD/B,EAEpB8B,aAAG,CAACC,UAAJ,CAAe,kCAAf,CAFoB,CAAxB;CAKAb,QAAAA,aAAG,CAAC0T,MAAJ,CAAW+L,kBAAX,EAA+BR,OAAO,CAACC,gBAAvC;CACA;;CAED,UAAI,CAAC,KAAKQ,YAAL,EAAL,EACA;CACCT,QAAAA,OAAO,CAACG,SAAR,CAAkBjZ,KAAlB,CAAwBwZ,UAAxB,GAAqC,QAArC;CACA;;CAED,WAAKjb,QAAL,GAAgB,IAAI7B,EAAE,CAACkG,EAAH,CAAM6W,WAAV,CAAsB;CACrC7d,QAAAA,KAAK,EAALA,KADqC;CAErC6Q,QAAAA,QAAQ,EAARA,QAFqC;CAGrCvW,QAAAA,IAAI,EAAEwG,EAAE,CAACkG,EAAH,CAAM6W,WAAN,CAAkBC,IAAlB,CAAuBC,MAHQ;CAIrCC,QAAAA,SAAS,EAAElgB,aAAa,CAACmG,eAAd,CAA8BjE,KAA9B,EAAqC6Q,QAArC;CAJ0B,OAAtB,CAAhB;CAOA,WAAKhM,SAAL,GAAiB8B,aAAG,CAACC,MAArB,sBACuF9N,MADvF,EAGKokB,OAAO,CAACG,SAHb,EAMyD,KAAKY,iBAAL,CAAuBlhB,IAAvB,CAA4B,IAA5B,CANzD,EAOQ,KAAKoR,cAAL,EAPR,EAWkErV,MAXlE,EAYS,KAAK6J,QAAL,CAAc0O,YAAd,EAZT,EAkBM6L,OAAO,CAACE,WAlBd,EAmB0E,KAAKc,qBAAL,CAA2BnhB,IAA3B,CAAgC,IAAhC,CAnB1E,EAuB0DjE,MAvB1D,EAwBMmkB,QAxBN,EA0BKC,OAAO,CAACC,gBA1Bb;CA+BA,aAAO,KAAKtY,SAAZ;CACA;;;4CAEsBoY,UACvB;CACC,UAAMnkB,MAAM,GAAG,KAAKoB,SAAL,EAAf;CACA,UAAMgjB,OAAO,GAAG;CACfzC,QAAAA,YAAY,EAAE9T,aAAG,CAACC,MAAN,sBAAoE,KAAKkH,aAAL,CAAmB/Q,IAAnB,CAAwB,IAAxB,CAApE,CADG;CAEfsgB,QAAAA,SAAS,EAAE1W,aAAG,CAACC,MAAN,qBAFM;CAGfxK,QAAAA,WAAW,EAAE,KAAK+hB,oBAAL;CAHE,OAAhB;;CAMA,UAAI,CAAC,KAAK1E,cAAL,EAAL,EACA;CACCyD,QAAAA,OAAO,CAACzC,YAAR,GAAuB,EAAvB;CACA;;CAED,UAAI,CAAC,KAAKkD,YAAL,EAAL,EACA;CACCT,QAAAA,OAAO,CAACG,SAAR,CAAkBjZ,KAAlB,CAAwBwZ,UAAxB,GAAqC,QAArC;CACA;;CAED,WAAKjb,QAAL,GAAgB,IAAI7B,EAAE,CAACkG,EAAH,CAAM4J,aAAV,CAAwB;CACvCtV,QAAAA,EAAE,qBAAcxC,MAAd,CADqC;CAEvCkH,QAAAA,KAAK,EAAE,KAAK3E,MAAL,CAAYuI,iBAAZ,EAFgC;CAGvCiN,QAAAA,QAAQ,EAAE,KAAKxV,MAAL,CAAYsI,aAAZ,EAH6B;CAIvCmN,QAAAA,KAAK,EAAE,EAJgC;CAKvCC,QAAAA,QAAQ,EAAE,CAL6B;CAMvCC,QAAAA,IAAI,EAAE,KANiC;CAOvCC,QAAAA,KAAK,EAAEnQ,EAAE,CAACkG,EAAH,CAAM4J,aAAN,CAAoBM,KAApB,CAA0BC;CAPM,OAAxB,CAAhB;CAUA,WAAKtM,SAAL,GAAiB8B,aAAG,CAACC,MAArB,sBACyC9N,MADzC,EAEqD,KAAKuC,MAAL,CAAY+H,aAAZ,KAA8B,6BAA9B,GAA8D,EAFnH,EAGe,KAAKgb,qBAAL,CAA2BrhB,IAA3B,CAAgC,IAAhC,CAHf,EAIKmgB,OAAO,CAACG,SAJb,EAOiE,KAAKjM,qBAAL,CAA2BrU,IAA3B,CAAgC,IAAhC,CAPjE,EAQoFjE,MARpF,EASS,KAAK6J,QAAL,CAAc0O,YAAd,EATT,EAgB+C,KAAKhW,MAAL,CAAY8T,mBAAZ,EAhB/C,EAiBM,KAAK9T,MAAL,CAAYsS,cAAZ,KAA+B,KAAKmG,kBAAL,EAA/B,GAA2D,EAjBjE,EAmBO,KAAK3F,cAAL,EAnBP,EAuBM+O,OAAO,CAACzC,YAvBd,EA0BoE3hB,MA1BpE,EA2BmB,KAAKulB,qBAAL,CAA2BthB,IAA3B,CAAgC,IAAhC,CA3BnB,EA+BuEjE,MA/BvE,EAgCMokB,OAAO,CAAC9gB,WAhCd,EAmCoEtD,MAnCpE,EAoCKmkB,QApCL;CAyCA,aAAO,KAAKpY,SAAZ;CACA;;;iCAGD;CACC,UAAMoY,QAAQ,GAAG,EAAjB;CAEA,WAAKjkB,WAAL,CAAiBoB,OAAjB,CAAyB,UAACZ,UAAD,EAAgB;CACxCyjB,QAAAA,QAAQ,CAAC9jB,IAAT,CAAcK,UAAU,CAAC4e,SAAX,EAAd;CACA,OAFD;;CAIA,UAAI,KAAKpV,UAAL,EAAJ,EACA;CACC,eAAO,KAAKsb,iBAAL,CAAuBrB,QAAvB,CAAP;CACA;;CAED,UAAI,KAAKlZ,WAAL,EAAJ,EACA;CACC,YAAMwa,eAAe,GAAG,KAAKC,kBAAL,CAAwBvB,QAAxB,CAAxB;CAEA,aAAKhX,sBAAL;CAEA,eAAOsY,eAAP;CACA;;CAED,aAAO,KAAKE,sBAAL,CAA4BxB,QAA5B,CAAP;CACA;;;GAnnF0BlkB;;KAsnFtB2lB;;;;;;;;;;;;;;;;;uFAEGA;8FAEO;6FACD;+FACE;8FACD;2FAEH;2FACA;mGAEQ;CACnBzc,MAAAA,MAAM,EAAE,CACP,+BADO,EAEP,kCAFO,EAGP,4BAHO,CADW;CAMnBhJ,MAAAA,IAAI,EAAE,CACL,+BADK,EAEL,kCAFK,EAGL,4BAHK,EAIL,qCAJK,EAKL,mCALK,EAML,sCANK;CANa;;;;;;0CA2BpB;CACC,UAAMqf,eAAe,GAAG;CACvBM,QAAAA,SAAS,EAAE,KAAKvd,MAAL,CAAYwd,WAAZ,EADY;CAEvBzP,QAAAA,KAAK,EAAE3L,cAAI,CAAC2M,MAAL,CAAY,KAAK/O,MAAL,CAAY6J,QAAZ,EAAZ,CAFgB;CAGvB6T,QAAAA,WAAW,EAAE,KAAK1d,MAAL,CAAY+H,aAAZ,EAHU;CAIvB4V,QAAAA,YAAY,EAAE,KAAK3d,MAAL,CAAYsS,cAAZ,EAJS;CAKvBsL,QAAAA,OAAO,EAAE,EALc;CAMvBC,QAAAA,WAAW,EAAE,KAAK7d,MAAL,CAAYsX,cAAZ,MAAgC;CANtB,OAAxB;CAQA,UAAMgM,YAAY,GAAG;CACpBlU,QAAAA,UAAU,EAAE,GADQ;CAEpBH,QAAAA,OAAO,EAAE;CAFW,OAArB;CAKA,WAAKjP,MAAL,CAAYkT,UAAZ,GAAyBnU,OAAzB,CAAiC,UAAC4F,KAAD,EAAQmZ,GAAR,EAAgB;CAChDb,QAAAA,eAAe,CAACW,OAAhB,CAAwBE,GAAxB,IAA+B;CAAC7b,UAAAA,IAAI,EAAEqhB,YAAY,CAAC3e,KAAK,CAACrC,IAAP;CAAnB,SAA/B;CACA,OAFD;CAIA,aAAO2a,eAAP;CACA;;;4CAGD;CACCsG,MAAAA,WAAW,CAACC,MAAZ,CAAmBC,eAAnB,CAAmC,sBAAnC,EAA2D;CAC1DC,QAAAA,MAAM,EAAE,KAAKhc,aAAL,CAAmB6R,QAD+B;CAE1DoK,QAAAA,QAAQ,EAAE,KAAKjc,aAAL,CAAmBic;CAF6B,OAA3D,EAGG,YAHH;CAIA;;;yCAGD;CAAA;;CACC,aAAO,IAAIhH,OAAJ,CAAY,UAACC,OAAD,EAAUgH,MAAV,EAAqB;CACvC,YAAM5jB,MAAM,GAAG,OAAI,CAACge,kBAAL,EAAf;;CACA,YAAMzgB,MAAM,GAAG,OAAI,CAACC,SAAL,EAAf;;CAEAwC,QAAAA,MAAM,CAACud,SAAP,GAAmBhgB,MAAM,CAACyC,MAAP,CAAc4H,KAAd,OAA0BrK,MAAM,CAACoK,UAAP,KAAsB,CAAtB,GAA0B,IAApD,CAAnB;CAGAlC,QAAAA,EAAE,CAACqU,IAAH,CAAQC,SAAR,CAAkB,0BAAlB,EAA8C;CAC7CjQ,UAAAA,IAAI,EAAE;CACL4Z,YAAAA,MAAM,EAAE,OAAI,CAAChc,aAAL,CAAmB6R,QADtB;CAELvZ,YAAAA,MAAM,EAANA;CAFK;CADuC,SAA9C,EAKG0L,IALH,CAKQ,UAACsO,QAAD,EAAc;CACrB,cAAIA,QAAQ,CAAC6J,MAAT,KAAoB,SAAxB,EACA;CAAA,gBACQ5J,aADR,GACyBD,QAAQ,CAAClQ,IADlC,CACQmQ,aADR;;CAEC,YAAA,OAAI,CAACja,MAAL,CAAY8jB,KAAZ,CAAkB7J,aAAa,CAACha,EAAhC;;CACA2c,YAAAA,OAAO;CACP,WALD,MAOA;CACC,YAAA,OAAI,CAACmH,oBAAL;;CACAH,YAAAA,MAAM;CACN;CACD,SAjBD,EAiBGI,KAjBH,CAiBS,YAAM;CACd,UAAA,OAAI,CAACD,oBAAL;;CACAH,UAAAA,MAAM;CACN,SApBD;CAqBA,OA5BM,CAAP;CA6BA;;;0CAEoB5jB,QACrB;CAAA,UAD6BikB,cAC7B,uEAD8C,IAC9C;CACC,UAAMC,cAAc,GAAGD,cAAc,IAAI,KAAKF,oBAAL,CAA0BriB,IAA1B,CAA+B,IAA/B,CAAzC;CAEA+D,MAAAA,EAAE,CAACqU,IAAH,CAAQC,SAAR,CAAkB,6BAAlB,EAAiD;CAChDjQ,QAAAA,IAAI,EAAE;CACL4Z,UAAAA,MAAM,EAAE,KAAKhc,aAAL,CAAmB6R,QADtB;CAELM,UAAAA,eAAe,EAAE,KAAK7Z,MAAL,CAAY4H,KAAZ,EAFZ;CAGL5H,UAAAA,MAAM,EAANA;CAHK;CAD0C,OAAjD,EAMG0L,IANH,CAMQ,UAACsO,QAAD,EAAc;CACrB,YAAIA,QAAQ,CAAC6J,MAAT,KAAoB,SAAxB,EACA;CACCK,UAAAA,cAAc;CACd;CACD,OAXD,EAWGF,KAXH,CAWS;CAAA,eAAME,cAAc,EAApB;CAAA,OAXT;CAYA;;;4CAGD;CAAA;;CACCze,MAAAA,EAAE,CAACqU,IAAH,CAAQC,SAAR,CAAkB,6BAAlB,EAAiD;CAChDjQ,QAAAA,IAAI,EAAE;CACL4Z,UAAAA,MAAM,EAAE,KAAKhc,aAAL,CAAmB6R,QADtB;CAELM,UAAAA,eAAe,EAAE,KAAK7Z,MAAL,CAAY4H,KAAZ;CAFZ;CAD0C,OAAjD,EAKG8D,IALH,CAKQ,UAACsO,QAAD,EAAc;CACrB,YAAIA,QAAQ,CAAC6J,MAAT,KAAoB,SAAxB,EACA;CACC,UAAA,OAAI,CAACE,oBAAL;CACA;CACD,OAVD,EAUGC,KAVH,CAUS;CAAA,eAAM,OAAI,CAACD,oBAAL,EAAN;CAAA,OAVT;CAWA;;;8CAEwBxhB,QAAQ4hB,YACjC;CAAA;;CACC,UAAMC,GAAG,GAAG;CACXnV,QAAAA,OAAO,EAAE;CACRyK,UAAAA,UAAU,EAAE,aADJ;CAER2K,UAAAA,SAAS,EAAE,aAFH;CAGRC,UAAAA,MAAM,EAAE;CAHA,SADE;CAMXlV,QAAAA,UAAU,EAAE;CACXsK,UAAAA,UAAU,EAAE,gBADD;CAEX2K,UAAAA,SAAS,EAAE,gBAFA;CAGXC,UAAAA,MAAM,EAAE;CAHG;CAND,OAAZ;CAYA,UAAMC,WAAW,GAAGH,GAAG,CAAC7hB,MAAM,CAACD,IAAR,CAAvB;CAEA,UAAMkiB,oBAAoB,GAAG,iCAA7B;CACA,UAAMC,kBAAkB,GAAG;CAC1Bf,QAAAA,MAAM,EAAE,KAAKhc,aAAL,CAAmB6R,QADD;CAE1BM,QAAAA,eAAe,EAAE,KAAK7Z,MAAL,CAAY4H,KAAZ,EAFS;CAG1B/G,QAAAA,OAAO,kCAAI0B,MAAM,CAACtC,EAAX,EAAgBskB,WAAW,CAACD,MAA5B;CAHmB,OAA3B;CAMA7e,MAAAA,EAAE,CAACqU,IAAH,CAAQC,SAAR,CAAkByK,oBAAlB,EAAwC;CAAC1a,QAAAA,IAAI,EAAE2a;CAAP,OAAxC,EAAoE/Y,IAApE,CAAyE,UAACgZ,sBAAD,EAA4B;CACpG,YAAIA,sBAAsB,CAACb,MAAvB,KAAkC,SAAtC,EACA;CACC,cAAIM,UAAJ,EACA;CACC,YAAA,OAAI,CAACjM,gBAAL;CACA;;CAEDzS,UAAAA,EAAE,CAACqU,IAAH,CAAQC,SAAR,sBAAgCwK,WAAW,CAAC7K,UAA5C,GAA0D;CAAC5P,YAAAA,IAAI;CAC9D4Z,cAAAA,MAAM,EAAE,OAAI,CAAChc,aAAL,CAAmB6R;CADmC,eAE7DgL,WAAW,CAACF,SAFiD,EAErC,CAAC9hB,MAAM,CAACtC,EAAR,CAFqC;CAAL,WAA1D;CAIA,SAXD,MAaA;CACC,UAAA,OAAI,CAACD,MAAL,CAAYyT,YAAZ,CAAyBlR,MAAM,CAACtC,EAAhC;CACA;CACD,OAjBD,EAiBG+jB,KAjBH,CAiBS;CAAA,eAAM,OAAI,CAAChkB,MAAL,CAAYyT,YAAZ,CAAyBlR,MAAM,CAACtC,EAAhC,CAAN;CAAA,OAjBT;CAkBA;;;6CAEuB0kB,WACxB;CAAA;;CACClf,MAAAA,EAAE,CAACqU,IAAH,CAAQC,SAAR,CAAkB,gCAAlB,EAAoD;CACnDjQ,QAAAA,IAAI,EAAE;CACL4Z,UAAAA,MAAM,EAAE,KAAKhc,aAAL,CAAmB6R,QADtB;CAELM,UAAAA,eAAe,EAAE,KAAK7Z,MAAL,CAAY4H,KAAZ,EAFZ;CAGLgd,UAAAA,WAAW,EAAED,SAAS,CAAC3kB,MAAV,CAAiB4H,KAAjB;CAHR;CAD6C,OAApD,EAMG8D,IANH,CAMQ,UAACsO,QAAD,EAAc;CACrB,YAAIA,QAAQ,CAAC6J,MAAT,KAAoB,SAAxB,EACA;CACC,UAAA,OAAI,CAACE,oBAAL;CACA;CACD,OAXD,EAWGC,KAXH,CAWS;CAAA,eAAM,OAAI,CAACD,oBAAL,EAAN;CAAA,OAXT;CAYA;;;yCAGD;CACC,UAAMc,SAAS,GAAG,oCAAlB;CACA,UAAMhY,cAAc,GAAG,EAAvB;CACA,UAAMiY,sBAAsB,GAAG;CAC9BC,QAAAA,SAAS,EAAE;CACVC,UAAAA,UAAU,EAAE;CACXvQ,YAAAA,SAAS,EAAE,KAAKlF,qBAAL,CAA2B7N,IAA3B,CAAgC,IAAhC,CADA;CAEXujB,YAAAA,WAAW,EAAE,GAFF;CAGX9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,iBAHI;CAIXK,YAAAA,OAAO,EAAE;CAJE,WADF;CAOVC,UAAAA,aAAa,EAAE;CACd1Q,YAAAA,SAAS,EAAE,KAAKlF,qBAAL,CAA2B7N,IAA3B,CAAgC,IAAhC,CADG;CAEdujB,YAAAA,WAAW,EAAE,GAFC;CAGd9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,oBAHO;CAIdK,YAAAA,OAAO,EAAE;CAJK,WAPL;CAaVE,UAAAA,MAAM,EAAE;CACP3Q,YAAAA,SAAS,EAAE,KAAK4D,cAAL,CAAoB3W,IAApB,CAAyB,IAAzB,CADJ;CAEPujB,YAAAA,WAAW,EAAE,GAFN;CAGP9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,YAHA;CAIPK,YAAAA,OAAO,EAAE;CAJF,WAbE;CAmBV5b,UAAAA,MAAM,EAAE;CACPmL,YAAAA,SAAS,EAAE,KAAK2J,cAAL,CAAoB1c,IAApB,CAAyB,IAAzB,CADJ;CAEPujB,YAAAA,WAAW,EAAE,GAFN;CAGP9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,YAHA;CAIPK,YAAAA,OAAO,EAAE;CAJF;CAnBE,SADmB;CA2B9BG,QAAAA,aAAa,EAAE;CACdC,UAAAA,OAAO,EAAE;CACR7Q,YAAAA,SAAS,EAAE,KAAK4D,cAAL,CAAoB3W,IAApB,CAAyB,IAAzB,CADH;CAERujB,YAAAA,WAAW,EAAE,GAFL;CAGR9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,cAHC;CAIRK,YAAAA,OAAO,EAAE;CAJD,WADK;CAOdF,UAAAA,UAAU,EAAE;CACXvQ,YAAAA,SAAS,EAAE,KAAKlF,qBAAL,CAA2B7N,IAA3B,CAAgC,IAAhC,CADA;CAEXujB,YAAAA,WAAW,EAAE,GAFF;CAGX9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,iBAHI;CAIXK,YAAAA,OAAO,EAAE;CAJE,WAPE;CAadC,UAAAA,aAAa,EAAE;CACd1Q,YAAAA,SAAS,EAAE,KAAKlF,qBAAL,CAA2B7N,IAA3B,CAAgC,IAAhC,CADG;CAEdujB,YAAAA,WAAW,EAAE,GAFC;CAGd9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,oBAHO;CAIdK,YAAAA,OAAO,EAAE;CAJK,WAbD;CAmBd5I,UAAAA,KAAK,EAAE;CACN7H,YAAAA,SAAS,EAAE,KAAK8Q,aAAL,CAAmB7jB,IAAnB,CAAwB,IAAxB,CADL;CAENujB,YAAAA,WAAW,EAAE,GAFP;CAGN9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,YAHD;CAINK,YAAAA,OAAO,EAAE;CAJH,WAnBO;CAyBd3I,UAAAA,MAAM,EAAE;CACP9H,YAAAA,SAAS,EAAE,KAAK+Q,cAAL,CAAoB9jB,IAApB,CAAyB,IAAzB,CADJ;CAEPujB,YAAAA,WAAW,EAAE,GAFN;CAGP9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,aAHA;CAIPK,YAAAA,OAAO,EAAE;CAJF,WAzBM;CA+BdO,UAAAA,SAAS,EAAE;CACVhR,YAAAA,SAAS,EAAE,KAAK4D,cAAL,CAAoB3W,IAApB,CAAyB,IAAzB,CADD;CAEVujB,YAAAA,WAAW,EAAE,GAFH;CAGV9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,eAHG;CAIVK,YAAAA,OAAO,EAAE;CAJC,WA/BG;CAqCdQ,UAAAA,kBAAkB,EAAE;CACnBjR,YAAAA,SAAS,EAAE,KAAK4D,cAAL,CAAoB3W,IAApB,CAAyB,IAAzB,CADQ;CAEnBujB,YAAAA,WAAW,EAAE,GAFM;CAGnB9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,0BAHY;CAInBK,YAAAA,OAAO,EAAE;CAJU,WArCN;CA2Cd5b,UAAAA,MAAM,EAAE;CACPmL,YAAAA,SAAS,EAAE,KAAK2J,cAAL,CAAoB1c,IAApB,CAAyB,IAAzB,CADJ;CAEPujB,YAAAA,WAAW,EAAE,GAFN;CAGP9kB,YAAAA,KAAK,EAAEqD,aAAG,CAACC,UAAJ,WAAkBohB,SAAlB,YAHA;CAIPK,YAAAA,OAAO,EAAE;CAJF;CA3CM;CA3Be,OAA/B;CA8EA,UAAM5iB,IAAI,GAAI,KAAKoG,WAAL,KAAqB,WAArB,GAAmC,eAAjD;CAEAzH,MAAAA,MAAM,CAACC,IAAP,CAAY4jB,sBAAsB,CAACxiB,IAAD,CAAlC,EAA0CvD,OAA1C,CAAkD,UAACkB,EAAD,EAAQ;CAAA,oCACR6kB,sBAAsB,CAACxiB,IAAD,CAAtB,CAA6BrC,EAA7B,CADQ;CAAA,YAClDglB,WADkD,yBAClDA,WADkD;CAAA,YACrC9kB,KADqC,yBACrCA,KADqC;CAAA,YAC9B+kB,OAD8B,yBAC9BA,OAD8B;CAAA,YACrBzQ,SADqB,yBACrBA,SADqB;CAEzD5H,QAAAA,cAAc,CAAC/O,IAAf,CAAoB;CAACmC,UAAAA,EAAE,EAAFA,EAAD;CAAKglB,UAAAA,WAAW,EAAXA,WAAL;CAAkB9kB,UAAAA,KAAK,EAALA,KAAlB;CAAyB+kB,UAAAA,OAAO,EAAPA,OAAzB;CAAkCS,UAAAA,OAAO,EAAE,CAAClR,SAAS;CAArD,SAApB;CACA,OAHD;CAKA,aAAO5H,cAAP;CACA;;;8CAGD;CACC,UAAMW,SAAS,GAAG,KAAKC,YAAL,EAAlB;CACA,UAAMC,UAAU,GAAG,KAAKtO,WAAL,GAAmBT,cAAnB,GAAoCgP,MAApC,CAA2C,UAAA/P,IAAI;CAAA,eAAIA,IAAI,KAAK4P,SAAb;CAAA,OAA/C,CAAnB;CACA,UAAMoY,mBAAmB,GAAG,EAA5B;CAEAlY,MAAAA,UAAU,CAAC3O,OAAX,CAAmB,UAACZ,UAAD,EAAgB;CAClCynB,QAAAA,mBAAmB,CAAC9nB,IAApB,CAAyB;CACxBmC,UAAAA,EAAE,EAAE9B,UAAU,CAACU,SAAX,EADoB;CAExBsB,UAAAA,KAAK,EAAEhC,UAAU,CAAC6B,MAAX,CAAkBmN,eAAlB,EAFiB;CAGxB8X,UAAAA,WAAW,EAAE;CAHW,SAAzB;CAKA,OAND;CAOAW,MAAAA,mBAAmB,CAAC9nB,IAApB,CAAyB;CACxBmC,QAAAA,EAAE,EAAE,cADoB;CAExBE,QAAAA,KAAK,EAAEmL,aAAG,CAAC0B,OAAN,sBAAkB,gEAAlB,CAFmB;CAGxBiY,QAAAA,WAAW,EAAE;CAHW,OAAzB;CAMA,aAAOW,mBAAP;CACA;;;2CAEqBC,WACtB;CAAA,UACQpoB,MADR,GACgDooB,SADhD,CACQpoB,MADR;CAAA,UACgB8E,MADhB,GACgDsjB,SADhD,CACgBtjB,MADhB;CAAA,UACwB1E,QADxB,GACgDgoB,SADhD,CACwBhoB,QADxB;CAAA,UACkCsmB,UADlC,GACgD0B,SADhD,CACkC1B,UADlC;CAEC,UAAM5e,IAAI,GAAG,KAAKvG,SAAL,CAAevB,MAAf,CAAb;;CAEA,UAAI,CAAC8H,IAAL,EACA;CACC;CACA;;CAED,UAAMlF,YAAY,GAAGkF,IAAI,CAACvF,MAAL,CAAYmN,eAAZ,EAArB;CACA,UAAIgB,QAAQ,GAAG,EAAf;CAEA5L,MAAAA,MAAM,CAACJ,aAAP,GAAuBC,cAAI,CAACC,MAAL,CAAYE,MAAM,CAACJ,aAAnB,CAAvB;;CAEA,UAAIgiB,UAAJ,EACA;CACC,YAAMrgB,KAAK,GAAGjG,QAAQ,IAAI,CAA1B;CACA,YAAM8Q,UAAU,GAAI7K,KAAK,KAAK,CAAV,IAAeA,KAAK,GAAG,CAAR,KAAc,CAA7B,IAAkCzD,YAAY,CAACuO,MAAb,CAAoB9K,KAAK,GAAG,CAA5B,MAAmC,GAAtE,GAA6E,EAA7E,GAAkF,GAArG;CACA,YAAM+K,QAAQ,GAAIxO,YAAY,CAACuO,MAAb,CAAoB9K,KAAK,GAAG,CAA5B,MAAmC,GAAnC,GAAyC,EAAzC,GAA8C,GAAhE;CACA,YAAMgL,YAAY,aAAMzO,YAAY,CAAC6E,KAAb,CAAmB,CAAnB,EAAsBpB,KAAK,GAAG,CAA9B,CAAN,SAAyC6K,UAAzC,SAAsDpM,MAAM,CAACJ,aAA7D,SAA6E0M,QAA7E,CAAlB;CACAV,QAAAA,QAAQ,aAAMW,YAAN,SAAqBzO,YAAY,CAAC6E,KAAb,CAAmBpB,KAAnB,CAArB,CAAR;CACA,OAPD,MASA;CACC,YAAMoK,KAAK,GAAI7N,YAAY,CAAC6E,KAAb,CAAmB,CAAC,CAApB,MAA2B,GAA3B,GAAiC,EAAjC,GAAsC,GAArD;CACAiJ,QAAAA,QAAQ,GAAG,UAAG9N,YAAH,SAAkB6N,KAAlB,SAA0B3L,MAAM,CAACJ,aAAjC,EAAiDiM,SAAjD,CAA2D,CAA3D,EAA8D,GAA9D,CAAX;CACA;;CAED7I,MAAAA,IAAI,CAACvF,MAAL,CAAYqO,SAAZ,CAAsB9L,MAAtB;CACAgD,MAAAA,IAAI,CAAC+I,WAAL,CAAiBH,QAAjB;CACA5I,MAAAA,IAAI,CAACgJ,kBAAL,CAAwBJ,QAAxB;;CAEA,UAAI,CAAC,KAAK2X,aAAL,EAAL,EACA;CACCvgB,QAAAA,IAAI,CAACwgB,oBAAL,CAA0B;CAAChY,UAAAA,KAAK,EAAE3L,cAAI,CAAC2M,MAAL,CAAYxJ,IAAI,CAACvF,MAAL,CAAY6J,QAAZ,EAAZ;CAAR,SAA1B;CACAtE,QAAAA,IAAI,CAACygB,wBAAL,CAA8BzjB,MAA9B,EAAsC4hB,UAAtC;CACA,OAJD,MAKK,IAAIA,UAAJ,EACL;CACC5e,QAAAA,IAAI,CAAC2S,gBAAL;CACA;CACD;;;0CAEoB2N,WACrB;CAAA,UACQpoB,MADR,GAC8BooB,SAD9B,CACQpoB,MADR;CAAA,UACgBqhB,UADhB,GAC8B+G,SAD9B,CACgB/G,UADhB;CAEC,UAAMvZ,IAAI,GAAG,KAAKvG,SAAL,CAAevB,MAAf,CAAb;;CAEA,UAAI8H,IAAJ,EACA;CACC,YAAMuY,GAAG,GAAG7c,MAAM,CAACC,IAAP,CAAY4d,UAAZ,EAAwB,CAAxB,CAAZ;CACA,YAAMna,KAAK,GAAG1D,MAAM,CAACglB,MAAP,CAAcnH,UAAd,EAA0B,CAA1B,CAAd;CAEAvZ,QAAAA,IAAI,CAACvF,MAAL,CAAYuhB,cAAZ,4CAAiCzD,GAAjC,GAAyCnZ,KAAzC;CACA;CACD;;;6CAEuBkhB,WACxB;CAAA,UACQpoB,MADR,GACgCooB,SADhC,CACQpoB,MADR;CAAA,UACgB0jB,YADhB,GACgC0E,SADhC,CACgB1E,YADhB;CAEC,UAAM5b,IAAI,GAAG,KAAKvG,SAAL,CAAevB,MAAf,CAAb;;CAEA,UAAI8H,IAAJ,EACA;CACCA,QAAAA,IAAI,CAACvF,MAAL,CAAY4R,gBAAZ,CAA6BuP,YAA7B;CACA5b,QAAAA,IAAI,CAACvF,MAAL,CAAY4R,gBAAZ,YAAiCuP,YAAjC;CACA;CACD;;;6CAEuB+E,eAAeC,YACvC;CACC,UAAMC,cAAc,GAAGnlB,MAAM,CAACC,IAAP,CAAY,KAAKlB,MAAL,CAAYsX,cAAZ,EAAZ,CAAvB;CACA,UAAM+O,kBAAkB,GAAGD,cAAc,CAACzY,MAAf,CAAsB,UAAA1N,EAAE;CAAA,eAAI,CAACimB,aAAa,CAACI,QAAd,CAAuBrmB,EAAvB,CAAL;CAAA,OAAxB,EAAyD3B,MAApF;CAEA,aAAO+nB,kBAAkB,GAAGF,UAAU,CAAC7nB,MAAvC;CACA;;;+CAEyBioB,kBAC1B;CACC,UAAMC,oBAAoB,GAAGlb,aAAG,CAACC,MAAP,sBACuC,KAAK1M,SAAL,EADvC,EACqE,KAAK4nB,wBAAL,CAA8B/kB,IAA9B,CAAmC,IAAnC,CADrE,EAEtB6kB,gBAAgB,GAAG,CAAnB,oEAA+EA,gBAA/E,cAA0G,EAFpF,CAA1B;CAKA3jB,MAAAA,aAAG,CAACjD,OAAJ,CAAY,KAAKkS,uBAAL,EAAZ,EAA4C2U,oBAA5C;CACA;;;2CAEqBN,eAAeC,YACrC;CAAA,UADiDplB,WACjD,uEAD+D,IAC/D;;CACC,UAAIA,WAAJ,EACA;CACC,aAAKf,MAAL,CAAY4f,cAAZ,CAA2B7e,WAA3B;CACA;;CAED,UAAM2lB,oBAAoB,GAAG,KAAKC,uBAAL,CAA6BT,aAA7B,EAA4CC,UAA5C,CAA7B;CACA,WAAKS,yBAAL,CAA+BF,oBAA/B;CACA;;;wCAEkBb,WACnB;CAAA,UACQpoB,MADR,GAC2EooB,SAD3E,CACQpoB,MADR;CAAA,UACgByoB,aADhB,GAC2EL,SAD3E,CACgBK,aADhB;CAAA,UAC+BC,UAD/B,GAC2EN,SAD3E,CAC+BM,UAD/B;CAAA,UAC2CplB,WAD3C,GAC2E8kB,SAD3E,CAC2C9kB,WAD3C;CAAA,UACwD8Y,eADxD,GAC2EgM,SAD3E,CACwDhM,eADxD;CAEC,UAAMtU,IAAI,GAAI9H,MAAM,GAAG,KAAKuB,SAAL,CAAevB,MAAf,CAAH,GAA4B,KAAKoK,QAAL,CAAcgS,eAAd,CAAhD;;CAEA,UAAItU,IAAJ,EACA;CACCA,QAAAA,IAAI,CAACshB,qBAAL,CAA2BX,aAA3B,EAA0CC,UAA1C,EAAsDplB,WAAtD;CACA;CACD;;;wCAEkB8kB,WACnB;CAAA,UACQpoB,MADR,GAC0DooB,SAD1D,CACQpoB,MADR;CAAA,UACgByoB,aADhB,GAC0DL,SAD1D,CACgBK,aADhB;CAAA,UAC+BC,UAD/B,GAC0DN,SAD1D,CAC+BM,UAD/B;CAAA,UAC2CplB,WAD3C,GAC0D8kB,SAD1D,CAC2C9kB,WAD3C;CAEC,UAAMwE,IAAI,GAAG,KAAKvG,SAAL,CAAevB,MAAf,CAAb;;CAEA,UAAI8H,IAAJ,EACA;CACCA,QAAAA,IAAI,CAACshB,qBAAL,CAA2BX,aAA3B,EAA0CC,UAA1C,EAAsDplB,WAAtD;CACA;CACD;;;4CAEsB8kB,WACvB;CAAA,UACQpoB,MADR,GAC8DooB,SAD9D,CACQpoB,MADR;CAAA,UACgByoB,aADhB,GAC8DL,SAD9D,CACgBK,aADhB;CAAA,UAC+BC,UAD/B,GAC8DN,SAD9D,CAC+BM,UAD/B;CAAA,UAC2CtM,eAD3C,GAC8DgM,SAD9D,CAC2ChM,eAD3C;CAEC,UAAMtU,IAAI,GAAI9H,MAAM,GAAG,KAAKuB,SAAL,CAAevB,MAAf,CAAH,GAA4B,KAAKoK,QAAL,CAAcgS,eAAd,CAAhD;;CAEA,UAAItU,IAAJ,EACA;CACCA,QAAAA,IAAI,CAACshB,qBAAL,CAA2BX,aAA3B,EAA0CC,UAA1C;CACA;CACD;;;4CAEsBN,WACvB;CAAA,UACQpoB,MADR,GAC6CooB,SAD7C,CACQpoB,MADR;CAAA,UACgByoB,aADhB,GAC6CL,SAD7C,CACgBK,aADhB;CAAA,UAC+BC,UAD/B,GAC6CN,SAD7C,CAC+BM,UAD/B;CAEC,UAAM5gB,IAAI,GAAG,KAAKvG,SAAL,CAAevB,MAAf,CAAb;;CAEA,UAAI8H,IAAJ,EACA;CACCA,QAAAA,IAAI,CAACshB,qBAAL,CAA2BX,aAA3B,EAA0CC,UAA1C;CACA;CACD;;;mCAEaN,WACd;CACC,UAAMtgB,IAAI,GAAG,KAAKvG,SAAL,CAAe6mB,SAAS,CAACpoB,MAAzB,CAAb;;CAEA,UAAI8H,IAAJ,EACA;CACCA,QAAAA,IAAI,CAAC2S,gBAAL;CACA;CACD;;;mCAEa2N,WACd;CACC,UAAMtgB,IAAI,GAAG,KAAKvG,SAAL,CAAe6mB,SAAS,CAACpoB,MAAzB,CAAb;;CAEA,UAAI8H,IAAJ,EACA;CACC,YAAI,CAAC,KAAKugB,aAAL,EAAD,IAAyBvgB,IAAI,CAACvF,MAAL,CAAY4H,KAAZ,EAA7B,EACA;CACCrC,UAAAA,IAAI,CAACuhB,oBAAL;CACA;;CACDvhB,QAAAA,IAAI,CAACoF,YAAL,CAAkB,KAAlB;CACApF,QAAAA,IAAI,CAAC/H,SAAL,GAAiB2F,aAAjB;CACAoC,QAAAA,IAAI,CAACqF,sBAAL;CACA;CACD;;;kCAEYib,WACb;CACC,UAAMtgB,IAAI,GAAG,KAAKvG,SAAL,CAAe6mB,SAAS,CAACpoB,MAAzB,CAAb;;CAEA,UAAI8H,IAAI,IAAIA,IAAI,CAACggB,aAAL,EAAZ,EACA;CACChgB,QAAAA,IAAI,CAAC+W,KAAL;;CAEA,YAAI,CAAC,KAAKwJ,aAAL,EAAL,EACA;CACC,cAAIvgB,IAAI,CAAC8W,cAAL,EAAJ,EACA;CACC9W,YAAAA,IAAI,CAACwhB,uBAAL,CAA6BxhB,IAAI,CAAC8W,cAAL,EAA7B;CACA,WAHD,MAKA;CACC,gBAAMrc,MAAM,GAAG;CACdud,cAAAA,SAAS,EAAEhY,IAAI,CAAC/H,SAAL,GAAiBwC,MAAjB,CAAwB4H,KAAxB,EADG;CAEd6V,cAAAA,UAAU,EAAElY,IAAI,CAACvF,MAAL,CAAY0J,YAAZ;CAFE,aAAf;;CAIA,gBAAMua,cAAc,GAAG,SAAjBA,cAAiB,GAAM;CAAE1e,cAAAA,IAAI,CAACgX,MAAL;CAAgB,aAA/C;;CAEAhX,YAAAA,IAAI,CAACwgB,oBAAL,CAA0B/lB,MAA1B,EAAkCikB,cAAlC;CACA;CACD;CACD;CACD;;;mCAEa4B,WACd;CACC,UAAMtgB,IAAI,GAAG,KAAKvG,SAAL,CAAe6mB,SAAS,CAACpoB,MAAzB,CAAb;;CAEA,UAAI8H,IAAI,IAAIA,IAAI,CAACigB,cAAL,EAAZ,EACA;CACC,YAAI,CAAC,KAAKM,aAAL,EAAL,EACA;CACCvgB,UAAAA,IAAI,CAACwhB,uBAAL,CAA6BxhB,IAAI,CAAC/H,SAAL,EAA7B;CACA;;CACD+H,QAAAA,IAAI,CAACgX,MAAL;CACA;CACD;;;sCAEgBsJ,WACjB;CACC,UAAMtgB,IAAI,GAAG,KAAKvG,SAAL,CAAe6mB,SAAS,CAACpoB,MAAzB,CAAb;;CAEA,UAAI8H,IAAJ,EACA;CACCA,QAAAA,IAAI,CAACsT,eAAL;;CACA,YAAI,CAAC,KAAKiN,aAAL,EAAL,EACA;CACC,cAAM7B,cAAc,GAAG,SAAjBA,cAAiB,GAAM;CAAE1e,YAAAA,IAAI,CAACsT,eAAL;CAAyB,WAAxD;;CACAtT,UAAAA,IAAI,CAACwgB,oBAAL,CAA0B;CAACpI,YAAAA,YAAY,EAAEpY,IAAI,CAACvF,MAAL,CAAYsS,cAAZ;CAAf,WAA1B,EAAwE2R,cAAxE;CACA;CACD;CACD;;;+CAEyB4B,WAC1B;CAAA,UACQpoB,MADR,GAC+BooB,SAD/B,CACQpoB,MADR;CAAA,UACgBupB,WADhB,GAC+BnB,SAD/B,CACgBmB,WADhB;CAEC,UAAMzhB,IAAI,GAAG,KAAKvG,SAAL,CAAevB,MAAf,CAAb;;CAEA,UAAI,CAAC8H,IAAL,EACA;CACC;CACA;;CAED,UAAIyhB,WAAW,KAAK,cAApB,EACA;CACCzhB,QAAAA,IAAI,CAACyG,kBAAL,CAAwB,KAAK9M,mBAAL,KAA6B,CAArD;CACA,OAHD,MAKA;CACCqG,QAAAA,IAAI,CAAC8H,WAAL,CAAiB,KAAKrO,SAAL,CAAegoB,WAAf,CAAjB;CACAzhB,QAAAA,IAAI,CAACqF,sBAAL;;CAEA,YAAI,CAAC,KAAKkb,aAAL,EAAL,EACA;CACC,cAAIvgB,IAAI,CAAC8W,cAAL,EAAJ,EACA;CACC9W,YAAAA,IAAI,CAACwhB,uBAAL,CAA6BxhB,IAAI,CAAC8W,cAAL,EAA7B;CACA,WAHD,MAKA;CACC9W,YAAAA,IAAI,CAACwgB,oBAAL,CAA0B;CACzBxI,cAAAA,SAAS,EAAEhY,IAAI,CAAC/H,SAAL,GAAiBwC,MAAjB,CAAwB4H,KAAxB,EADc;CAEzB6V,cAAAA,UAAU,EAAElY,IAAI,CAACvF,MAAL,CAAY0J,YAAZ;CAFa,aAA1B;CAIA;CACD;CACD;CACD;;;8CAGD;CACC,aAAQ,KAAKoc,aAAL,KAAuB,YAAvB,GAAsC,YAA9C;CACA;;;qCAGD;CACC,aAAO,KAAKpe,aAAL,CAAmBuf,UAAnB,EAAP;CACA;;;qCAGD;CACC,aAAO,CAAC,KAAKtf,UAAL,EAAD,IAAsB,CAAC,KAAKe,WAAL,EAAvB,IAA6C,CAAC,KAAKjK,iBAAL,EAArD;CACA;;;sCAGD;CACC,aAAO,CAAC,KAAKkJ,UAAL,EAAD,IAAsB,CAAC,KAAKe,WAAL,EAAvB,IAA6C,CAAC,KAAKlL,SAAL,GAAiBkL,WAAjB,EAArD;CACA;;;qCAEe9K,MAChB;CAEC;;;yCAGD;CACC,aAAO,KAAK8K,WAAL,KAAqB,uCAArB,GAA+D,iCAAtE;CACA;;;yCAGD;CACC,aAAO,KAAKc,SAAL,CAAekI,aAAf,CAA6B,KAAKhJ,WAAL,KAAqB,mCAArB,GAA2D,6BAAxF,CAAP;CACA;;;wCAEkBmF,QACnB;CAAA;;CACC,UAAM1N,KAAK,GAAG,UAAGqD,aAAG,CAACC,UAAJ,CAAe,qCAAf,CAAH,EAA2D9D,OAA3D,CAAmE,eAAnE,EAAoFkO,MAApF,CAAd;CACA,UAAMC,YAAY,GAAG,IAAIuV,mBAAJ,CAAwB;CAACtV,QAAAA,KAAK,EAAE5N,KAAR;CAAe6N,QAAAA,aAAa,EAAE7N;CAA9B,OAAxB,CAArB;CAEA,WAAKf,WAAL,GAAmBuK,gBAAnB,CAAoCmE,YAApC,EAAkDpC,IAAlD,CAAuD,YAAM;CAC5D,QAAA,OAAI,CAAC2B,WAAL,CAAiBS,YAAjB;;CACA,QAAA,OAAI,CAAClD,sBAAL;;CAEA,YAAI,CAAC,OAAI,CAACkb,aAAL,EAAL,EACA;CACChY,UAAAA,YAAY,CAACoZ,iBAAb,GAAiCxb,IAAjC,CAAsC,YAAM;CAC3C,YAAA,OAAI,CAACqa,oBAAL,CAA0B;CACzBxI,cAAAA,SAAS,EAAE,OAAI,CAAC/f,SAAL,GAAiBwC,MAAjB,CAAwB4H,KAAxB,EADc;CAEzB6V,cAAAA,UAAU,EAAE,OAAI,CAACzd,MAAL,CAAY0J,YAAZ;CAFa,aAA1B;CAIA,WALD,EAKG,YAAM,EALT;CAMA;CACD,OAbD;CAcA;;;uCAGD;CACC,UAAI,KAAK1J,MAAL,CAAYsS,cAAZ,EAAJ,EACA;CACC,aAAKtS,MAAL,CAAYwY,cAAZ,CAA2B,KAA3B;CACA5V,QAAAA,aAAG,CAACwU,WAAJ,CAAgB,KAAKT,iBAAL,EAAhB,EAA0C,sCAA1C;CACA,OAJD,MAMA;CACC,aAAK3W,MAAL,CAAYwY,cAAZ,CAA2B,IAA3B;CACA5V,QAAAA,aAAG,CAACE,QAAJ,CAAa,KAAK6T,iBAAL,EAAb,EAAuC,sCAAvC;CACA;CACD;;;0CAGD;CAAA,UADmBY,aACnB,uEADmC,KACnC;CACC,UAAM1T,KAAK,GAAG,KAAK2F,SAAL,CAAekI,aAAf,iBAAsC,KAAK7S,SAAL,EAAtC,EAAd;CACA,UAAMkO,IAAI,GAAGlJ,KAAK,CAACc,KAAN,CAAYuS,IAAZ,EAAb;;CAEA,UAAInK,IAAI,CAACzO,MAAL,KAAgB,CAApB,EACA;CACC,YAAI,KAAKkZ,4BAAL,EAAJ,EACA;CACC,cAAI,CAAC,KAAKsO,aAAL,EAAD,IAAyB,KAAK9lB,MAAL,CAAY4H,KAAZ,EAA7B,EACA;CACC,iBAAKkf,oBAAL;CACA;;CACD,eAAKnc,YAAL,CAAkB,KAAlB;CACA,eAAKnN,SAAL,GAAiB2F,aAAjB;CACA,eAAKsU,sBAAL;CACA,SATD,MAWA;CACC4L,UAAAA,mBAAmB,CAAC3L,iBAApB,CAAsC7T,KAAK,CAACa,aAA5C;CACA;CACD,OAhBD,MAiBK,IAAI6S,aAAJ,EACL;CACC,aAAK/Z,SAAL,GAAiBmM,gBAAjB,CAAkC,IAAlC,EAAwC,IAAxC;CACA,OAHI,MAKL;CACC,aAAKgO,iBAAL;CACA,aAAKtM,iBAAL;;CAEA,YAAI,CAAC,KAAKya,aAAL,EAAL,EACA;CACC,cAAI,KAAK9lB,MAAL,CAAY4H,KAAZ,EAAJ,EACA;CACC,gBAAMqV,eAAe,GAAG,KAAKe,kBAAL,EAAxB;CACA,gBAAMnd,OAAO,GAAGoc,eAAe,CAACW,OAAhC;CAEA,iBAAKmI,oBAAL,CAA0B;CACzBhY,cAAAA,KAAK,EAAEkP,eAAe,CAAClP,KADE;CAEzB6P,cAAAA,OAAO,EAAG3c,MAAM,CAACC,IAAP,CAAYL,OAAZ,EAAqBvC,MAArB,GAA8B,CAA9B,GAAkCuC,OAAlC,GAA4C;CAF7B,aAA1B;CAIA,WATD,MAWA;CACC,iBAAKqmB,iBAAL,GAAyBxb,IAAzB,CAA8B,YAAM,EAApC,EAAwC,YAAM,EAA9C;CACA;CACD;CACD;CACD;;;6BAEOvB,GACR;CACC,UAAMgd,sBAAsB,GAAG,CAAC,GAAD,EAAM,GAAN,CAA/B;CACA,UAAMtpB,QAAQ,GAAG4E,aAAa,CAACuS,iBAAd,CAAgC,KAAKnR,KAArC,EAA4CC,KAA7D;;CAEA,UAAIqjB,sBAAsB,CAACb,QAAvB,CAAgCnc,CAAC,CAACL,IAAlC,KAA2C,KAAKyF,qBAAL,EAA/C,EACA;CACC,YAAM6X,MAAM,GAAG;CACdvpB,UAAAA,QAAQ,EAARA,QADc;CAEdJ,UAAAA,MAAM,EAAE,KAAKoB,SAAL;CAFM,SAAf;CAIA0kB,QAAAA,WAAW,CAACC,MAAZ,CAAmBC,eAAnB,CAAmC,oCAAnC,EAAyE2D,MAAzE,EAAiF,KAAKC,sBAAL,EAAjF;CACA;CACD;;;uCAEiBld,GAClB;CACC,UAAMjJ,IAAI,GAAG;CACZ6W,QAAAA,KAAK,EAAE;CADK,OAAb;;CAIA,UAAI5N,CAAC,CAACyN,OAAF,KAAc1W,IAAI,CAAC6W,KAAvB,EACA;CACC,aAAKG,gBAAL,CAAsB/N,CAAtB;CACAA,QAAAA,CAAC,CAACC,cAAF;CACA;CACD;;;6CAEuB9H,MACxB;CACC,UAAI,CAAC,CAAC,UAAD,EAAa,aAAb,EAA4BgkB,QAA5B,CAAqChkB,IAArC,CAAL,EACA;CACC,eAAO,EAAP;CACA;;CAJF,iCAM6D,KAAKoF,aANlE;CAAA,UAMQ6R,QANR,wBAMQA,QANR;CAAA,UAMkBC,UANlB,wBAMkBA,UANlB;CAAA,UAM8BmK,QAN9B,wBAM8BA,QAN9B;CAAA,UAMwC2D,WANxC,wBAMwCA,WANxC;CAAA,UAMqDrX,IANrD,wBAMqDA,IANrD;CAOC,UAAMsX,aAAa,GAAG;CACrB5D,QAAAA,QAAQ,EAARA,QADqB;CAErBD,QAAAA,MAAM,EAAEnK,QAFa;CAGrB9b,QAAAA,MAAM,EAAE,KAAKoB,SAAL,EAHa;CAIrB2oB,QAAAA,IAAI,EAAEF,WAJe;CAKrBG,QAAAA,QAAQ,EAAE;CACTlO,UAAAA,QAAQ,EAARA,QADS;CAETtJ,UAAAA,IAAI,EAAJA,IAFS;CAGT4J,UAAAA,eAAe,EAAG,KAAKiM,aAAL,KAAuB,KAAKjnB,SAAL,EAAvB,GAA0C,KAAKmB,MAAL,CAAY4H,KAAZ,EAHnD;CAIT8f,UAAAA,YAAY,YAAKlO,UAAU,CAAC9Z,WAAX,EAAL;CAJH;CALW,OAAtB;CAYA,UAAIioB,WAAW,GAAG,EAAlB;;CAEA,UAAIrlB,IAAI,KAAK,UAAb,EACA;CACCqlB,QAAAA,WAAW,GAAG;CACbC,UAAAA,eAAe,EAAE,KAAKC,sBAAL,EADJ;CAEbhb,UAAAA,cAAc,EAAE,KAAKib,iBAAL,EAFH;CAGbC,UAAAA,iBAAiB,EAAE,CAAC;CAAC9nB,YAAAA,EAAE,EAAE,GAAL;CAAUE,YAAAA,KAAK,EAAEiC,cAAI,CAAC2M,MAAL,CAAY,KAAK/O,MAAL,CAAYmN,eAAZ,EAAZ;CAAjB,WAAD;CAHN,SAAd;CAKA,OAPD,MAQK,IAAI7K,IAAI,KAAK,aAAb,EACL;CACCqlB,QAAAA,WAAW,GAAG;CACbvB,UAAAA,cAAc,EAAEnlB,MAAM,CAACC,IAAP,CAAY,KAAKlB,MAAL,CAAYsX,cAAZ,EAAZ,CADH;CAEbzQ,UAAAA,SAAS,EAAE,KAAKwR,cAAL;CAFE,SAAd;CAIA;;CAED,2CAAWkP,aAAX,EAA6BI,WAA7B;CACA;;;gDAGD;CACC,UAAMP,MAAM,GAAG,KAAKY,uBAAL,CAA6B,aAA7B,CAAf;CACAzE,MAAAA,WAAW,CAACC,MAAZ,CAAmBC,eAAnB,CAAmC,6BAAnC,EAAkE2D,MAAlE,EAA0E,KAAKC,sBAAL,EAA1E;CACA;;;uCAGD;CACC,UAAMD,MAAM,GAAG,KAAKY,uBAAL,CAA6B,UAA7B,CAAf;CACAzE,MAAAA,WAAW,CAACC,MAAZ,CAAmBC,eAAnB,CAAmC,0BAAnC,EAA+D2D,MAA/D,EAAuE,KAAKC,sBAAL,EAAvE;CACA;;;2CAGD;CACC,UAAM5pB,MAAM,GAAG,KAAKoB,SAAL,EAAf;;CAEA,UAAI,KAAK6J,WAAL,EAAJ,EACA;CACC,eAAO4C,aAAG,CAACC,MAAX,sBAEyE9N,MAFzE,EAGe,KAAKuC,MAAL,CAAYmN,eAAZ,EAHf,EAIiB,KAAK8a,OAAL,CAAavmB,IAAb,CAAkB,IAAlB,CAJjB,EAKoB,KAAKyT,iBAAL,CAAuBzT,IAAvB,CAA4B,IAA5B,CALpB,EAMgB,KAAK0T,kBAAL,CAAwB1T,IAAxB,CAA6B,IAA7B,CANhB;CASA;;CAED,UAAM4T,iBAAiB,GAAG,IAAI7P,EAAE,CAACyiB,MAAH,CAAUtY,KAAV,CAAgBuY,SAAhB,CAA0B5S,aAA9B,CAA4C;CACrE5Q,QAAAA,KAAK,EAAE,KAAK3E,MAAL,CAAYuI,iBAAZ,EAD8D;CAErEiN,QAAAA,QAAQ,EAAE,KAAKxV,MAAL,CAAYsI,aAAZ,EAF2D;CAGrEmN,QAAAA,KAAK,EAAE,EAH8D;CAIrEC,QAAAA,QAAQ,EAAE,CAJ2D;CAKrEC,QAAAA,IAAI,EAAE,KAL+D;CAMrEC,QAAAA,KAAK,EAAEnQ,EAAE,CAACkG,EAAH,CAAM4J,aAAN,CAAoBM,KAApB,CAA0BC;CANoC,OAA5C,CAA1B;CASA,aAAOxK,aAAG,CAACC,MAAX,sBAC+E,KAAKvL,MAAL,CAAY+H,aAAZ,KAA8B,KAAKqR,YAAnC,GAAkD,EADjI,EAGK9D,iBAAiB,CAACU,YAAlB,EAHL,EAMoE,KAAKhW,MAAL,CAAY8T,mBAAZ,EANpE,EAO0ErW,MAP1E,EAQsB+F,aAAG,CAACC,UAAJ,CAAe,sCAAf,CARtB,EASgB,KAAKzD,MAAL,CAAYmN,eAAZ,EAThB,EAUkB,KAAK8a,OAAL,CAAavmB,IAAb,CAAkB,IAAlB,CAVlB,EAWqB,KAAKyT,iBAAL,CAAuBzT,IAAvB,CAA4B,IAA5B,CAXrB,EAYiB,KAAK0T,kBAAL,CAAwB1T,IAAxB,CAA6B,IAA7B,CAZjB;CAgBA;;;4CAGD;CACC,UAAM6kB,gBAAgB,GAAGtlB,MAAM,CAACC,IAAP,CAAY,KAAKlB,MAAL,CAAYsX,cAAZ,EAAZ,EAA0ChZ,MAAnE;CAEA,aAAOgN,aAAG,CAACC,MAAX,sBACiE,KAAK1M,SAAL,EADjE,EAC+F,KAAK4nB,wBAAL,CAA8B/kB,IAA9B,CAAmC,IAAnC,CAD/F,EAEI6kB,gBAAgB,GAAG,CAAnB,oEAA+EA,gBAA/E,cAA0G,EAF9G;CAKA;;;wCAEkB3E,UACnB;CACC,UAAMnkB,MAAM,GAAG,KAAKoB,SAAL,EAAf;CACA,UAAMupB,cAAc,GAAG9c,aAAG,CAACC,MAAP,sBACmC,KAAK8c,eAAL,CAAqB3mB,IAArB,CAA0B,IAA1B,CADnC,CAApB;CAGA,UAAMwgB,eAAe,GAAG5W,aAAG,CAACC,MAAP,sBACqC,KAAK4W,uBAAL,CAA6BzgB,IAA7B,CAAkC,IAAlC,CADrC,EAGhB8B,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAHgB,CAArB;CAQA,WAAK6D,QAAL,GAAgB,IAAI7B,EAAE,CAACyiB,MAAH,CAAUtY,KAAV,CAAgBuY,SAAhB,CAA0B5S,aAA9B,CAA4C;CAC3DE,QAAAA,KAAK,EAAE,EADoD;CAE3DC,QAAAA,QAAQ,EAAE,CAFiD;CAG3D/Q,QAAAA,KAAK,EAAE,KAAK3E,MAAL,CAAYuI,iBAAZ,EAHoD;CAI3DiN,QAAAA,QAAQ,EAAE,KAAKxV,MAAL,CAAYsI,aAAZ,EAJiD;CAK3DmY,QAAAA,UAAU,EAAEhb,EAAE,CAACkG,EAAH,CAAM4J,aAAN,CAAoBmL,MAApB,CAA2B4H;CALoB,OAA5C,CAAhB;CAQA,WAAK9e,SAAL,GAAiB8B,aAAG,CAACC,MAArB,sBACkD9N,MADlD,EAIuEA,MAJvE,EAKO,KAAK6J,QAAL,CAAc0O,YAAd,EALP,EAQ4D,KAAK4M,iBAAL,CAAuBlhB,IAAvB,CAA4B,IAA5B,CAR5D,EASM,KAAKoR,cAAL,EATN,EAYM,KAAKuF,cAAL,KAAwB+P,cAAxB,GAAyC,EAZ/C,EAciB,KAAKvF,qBAAL,CAA2BnhB,IAA3B,CAAgC,IAAhC,CAdjB,EAkBqDjE,MAlBrD,EAmBMmkB,QAnBN,EAqBK,KAAKK,WAAL,KAAqBC,eAArB,GAAuC,EArB5C;CA0BA,aAAO,KAAK1Y,SAAZ;CACA;;;4CAEsBoY,UACvB;CACC,UAAMnkB,MAAM,GAAG,KAAKoB,SAAL,EAAf;CACA,UAAMupB,cAAc,GAAG9c,aAAG,CAACC,MAAP,sBACwC,KAAK8c,eAAL,CAAqB3mB,IAArB,CAA0B,IAA1B,CADxC,CAApB;CAIA,WAAK4F,QAAL,GAAgB,IAAI7B,EAAE,CAACyiB,MAAH,CAAUtY,KAAV,CAAgBuY,SAAhB,CAA0B5S,aAA9B,CAA4C;CAC3DtV,QAAAA,EAAE,qBAAcxC,MAAd,CADyD;CAE3DkH,QAAAA,KAAK,EAAE,KAAK3E,MAAL,CAAYuI,iBAAZ,EAFoD;CAG3DiN,QAAAA,QAAQ,EAAE,KAAKxV,MAAL,CAAYsI,aAAZ,EAHiD;CAI3DmN,QAAAA,KAAK,EAAE,EAJoD;CAK3DC,QAAAA,QAAQ,EAAE,CALiD;CAM3DC,QAAAA,IAAI,EAAE,KANqD;CAO3DC,QAAAA,KAAK,EAAEnQ,EAAE,CAACkG,EAAH,CAAM4J,aAAN,CAAoBM,KAApB,CAA0BC;CAP0B,OAA5C,CAAhB;CAUA,WAAKtM,SAAL,GAAiB8B,aAAG,CAACC,MAArB,sBACuD9N,MADvD,EAE2C,KAAKuC,MAAL,CAAY+H,aAAZ,KAA8B,KAAKqR,YAAnC,GAAkD,EAF7F,EAEmG,KAAKpZ,MAAL,CAAYsS,cAAZ,KAA+B,sCAA/B,GAAwE,EAF3K,EAGe,KAAKyQ,qBAAL,CAA2BrhB,IAA3B,CAAgC,IAAhC,CAHf,EAIkEjE,MAJlE,EAKgB,KAAKsY,qBAAL,CAA2BrU,IAA3B,CAAgC,IAAhC,CALhB,EAMM,KAAK4F,QAAL,CAAc0O,YAAd,EANN,EASqE,KAAKhW,MAAL,CAAY8T,mBAAZ,EATrE,EAUM,KAAKhB,cAAL,EAVN,EAYK,KAAKgQ,oBAAL,EAZL,EAcM,KAAKzK,cAAL,KAAwB+P,cAAxB,GAAyC,EAd/C,EAiBoD3qB,MAjBpD,EAkBKmkB,QAlBL;CAuBA,aAAO,KAAKpY,SAAZ;CACA;;;uCA13BwB9G,SACzB;CACC,UAAMC,WAAW,GAAG,6BAApB;;CAEA,UAAI,CAACC,aAAG,CAACC,QAAJ,CAAaH,OAAb,EAAsBC,WAAtB,CAAL,EACA;CACCC,QAAAA,aAAG,CAACE,QAAJ,CAAaJ,OAAb,EAAsBC,WAAtB;CACA;CACD;;;GApCgCF;;;;;;;;;"}