{"version":3,"file":"check-list-item.bundle.js","sources":["../src/tree-item.js","../src/composite-tree-item.js","../src/check-list-item-fields.js","../src/check-list-item.js"],"sourcesContent":["class TreeItem\n{\n\tstatic generateUniqueNodeId()\n\t{\n\t\treturn Math.random().toString(36).substr(2, 9);\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.setNodeId(TreeItem.generateUniqueNodeId());\n\t\tthis.setParent(null);\n\t}\n\n\tgetRootNode()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (parent.getParent() !== null)\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tgetNodeId()\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tsetNodeId(nodeId)\n\t{\n\t\tthis.nodeId = nodeId;\n\t}\n\n\tgetParent()\n\t{\n\t\treturn this.parent;\n\t}\n\n\tsetParent(parent)\n\t{\n\t\tthis.parent = parent;\n\t}\n}\n\nexport {TreeItem};","import {TreeItem} from './tree-item';\n\nclass CompositeTreeItem extends TreeItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.descendants = [];\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\titem.setParent(this);\n\n\t\tif (position === null)\n\t\t{\n\t\t\tthis.descendants.push(item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.descendants.splice(position, 0, item);\n\t\t}\n\t}\n\n\taddAfter(item, after)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === after);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index + 1);\n\t\t}\n\t}\n\n\taddBefore(item, before)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === before);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index);\n\t\t}\n\t}\n\n\tremove(item)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === item);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.descendants.splice(index, 1);\n\t\t}\n\t}\n\n\tgetDescendants()\n\t{\n\t\treturn this.descendants;\n\t}\n\n\tgetDescendantsCount()\n\t{\n\t\treturn this.descendants.length;\n\t}\n\n\tgetFirstDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[0];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetLastDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[this.descendants.length - 1];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tisFirstDescendant()\n\t{\n\t\treturn (this === this.getParent().getFirstDescendant());\n\t}\n\n\tisLastDescendant()\n\t{\n\t\treturn (this === this.getParent().getLastDescendant());\n\t}\n\n\tgetLeftSibling()\n\t{\n\t\tif (this.isFirstDescendant())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index - 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetRightSibling()\n\t{\n\t\tif (this.isLastDescendant())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index + 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetLeftSiblingThrough()\n\t{\n\t\tif (this === this.getRootNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.isFirstDescendant())\n\t\t{\n\t\t\treturn this.getParent();\n\t\t}\n\n\t\tlet leftSiblingThrough = this.getLeftSibling();\n\t\twhile (leftSiblingThrough && leftSiblingThrough.getDescendantsCount() > 0)\n\t\t{\n\t\t\tleftSiblingThrough = leftSiblingThrough.getLastDescendant();\n\t\t}\n\n\t\treturn leftSiblingThrough;\n\t}\n\n\tgetRightSiblingThrough()\n\t{\n\t\tif (this.getDescendantsCount() > 0)\n\t\t{\n\t\t\treturn this.getFirstDescendant();\n\t\t}\n\n\t\tif (!this.isLastDescendant())\n\t\t{\n\t\t\treturn this.getRightSibling();\n\t\t}\n\n\t\tlet parent = this;\n\t\twhile (parent.getParent() !== null && parent.isLastDescendant())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\tif (parent !== this.getRootNode())\n\t\t{\n\t\t\treturn parent.getRightSibling();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindChild(nodeId)\n\t{\n\t\tif (!nodeId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.getNodeId().toString() === nodeId.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findChild(nodeId);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountTreeSize()\n\t{\n\t\tlet size = this.getDescendantsCount();\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tsize += descendant.countTreeSize();\n\t\t});\n\n\t\treturn size;\n\t}\n\n\tgetTreeSize()\n\t{\n\t\treturn this.getRootNode().countTreeSize() + 1;\n\t}\n}\n\nexport {CompositeTreeItem};","import {Text, Type} from 'main.core';\n\nclass CheckListItemFields\n{\n\tstatic snakeToCamelCase(string)\n\t{\n\t\tlet camelCaseString = string;\n\n\t\tif (Type.isString(camelCaseString))\n\t\t{\n\t\t\tcamelCaseString = camelCaseString.toLowerCase();\n\t\t\tcamelCaseString = camelCaseString.replace(/[-_\\s]+(.)?/g, (match, chr) => (chr ? chr.toUpperCase() : ''));\n\n\t\t\treturn camelCaseString.substr(0, 1).toLowerCase() + camelCaseString.substr(1);\n\t\t}\n\n\t\treturn camelCaseString;\n\t}\n\n\tstatic camelToSnakeCase(string)\n\t{\n\t\tlet snakeCaseString = string;\n\n\t\tif (Type.isString(snakeCaseString))\n\t\t{\n\t\t\tsnakeCaseString = snakeCaseString.replace(/(.)([A-Z])/g, '$1_$2').toUpperCase();\n\t\t}\n\n\t\treturn snakeCaseString;\n\t}\n\n\tconstructor(fields)\n\t{\n\t\tthis.fields = [\n\t\t\t'id',\n\t\t\t'copiedId',\n\t\t\t'parentId',\n\t\t\t'title',\n\t\t\t'sortIndex',\n\t\t\t'displaySortIndex',\n\t\t\t'isComplete',\n\t\t\t'isImportant',\n\t\t\t'isSelected',\n\t\t\t'isCollapse',\n\t\t\t'completedCount',\n\t\t\t'totalCount',\n\t\t\t'members',\n\t\t\t'attachments',\n\t\t];\n\n\t\tthis.id = null;\n\t\tthis.parentId = null;\n\t\tthis.title = '';\n\t\tthis.sortIndex = 0;\n\t\tthis.displaySortIndex = '';\n\t\tthis.isComplete = false;\n\t\tthis.isImportant = false;\n\t\tthis.isSelected = false;\n\t\tthis.isCollapse = false;\n\t\tthis.completedCount = 0;\n\t\tthis.totalCount = 0;\n\t\tthis.members = new Map();\n\t\tthis.attachments = {};\n\n\t\tthis.setFields(fields);\n\t}\n\n\tsetFields(fields)\n\t{\n\t\tObject.keys(fields).forEach((name) => {\n\t\t\tconst camelCaseName = CheckListItemFields.snakeToCamelCase(name);\n\n\t\t\tif (this.fields.indexOf(name) !== -1)\n\t\t\t{\n\t\t\t\tconst snakeCaseName = CheckListItemFields.camelToSnakeCase(name);\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${snakeCaseName}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t\telse if (this.fields.indexOf(camelCaseName) !== -1)\n\t\t\t{\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${name}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\tgetCopiedId()\n\t{\n\t\treturn this.copiedId;\n\t}\n\n\tsetCopiedId(copiedId)\n\t{\n\t\tthis.copiedId = copiedId;\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetParentId(parentId)\n\t{\n\t\tthis.parentId = parentId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title)\n\t{\n\t\tthis.title = Text.encode(title);\n\t}\n\n\tgetSortIndex()\n\t{\n\t\treturn this.sortIndex;\n\t}\n\n\tsetSortIndex(sortIndex)\n\t{\n\t\tthis.sortIndex = sortIndex;\n\t}\n\n\tgetDisplaySortIndex()\n\t{\n\t\treturn this.displaySortIndex;\n\t}\n\n\tsetDisplaySortIndex(displaySortIndex)\n\t{\n\t\tthis.displaySortIndex = displaySortIndex;\n\t}\n\n\tgetIsComplete()\n\t{\n\t\treturn this.isComplete;\n\t}\n\n\tsetIsComplete(isComplete)\n\t{\n\t\tthis.isComplete = isComplete;\n\t}\n\n\tgetIsImportant()\n\t{\n\t\treturn this.isImportant;\n\t}\n\n\tsetIsImportant(isImportant)\n\t{\n\t\tthis.isImportant = isImportant;\n\t}\n\n\tgetIsSelected()\n\t{\n\t\treturn this.isSelected;\n\t}\n\n\tsetIsSelected(isSelected)\n\t{\n\t\tthis.isSelected = isSelected;\n\t}\n\n\tgetIsCollapse()\n\t{\n\t\treturn this.isCollapse;\n\t}\n\n\tsetIsCollapse(isCollapse)\n\t{\n\t\tthis.isCollapse = isCollapse;\n\t}\n\n\tgetCompletedCount()\n\t{\n\t\treturn this.completedCount;\n\t}\n\n\tsetCompletedCount(completedCount)\n\t{\n\t\tthis.completedCount = completedCount;\n\t}\n\n\tgetTotalCount()\n\t{\n\t\treturn this.totalCount;\n\t}\n\n\tsetTotalCount(totalCount)\n\t{\n\t\tthis.totalCount = totalCount;\n\t}\n\n\tgetMembers()\n\t{\n\t\treturn this.members;\n\t}\n\n\tsetMembers(members)\n\t{\n\t\tconst types = {\n\t\t\tA: 'accomplice',\n\t\t\tU: 'auditor',\n\t\t};\n\n\t\tthis.members.clear();\n\n\t\tObject.keys(members).forEach((id) => {\n\t\t\tconst {NAME, TYPE} = members[id];\n\t\t\tthis.members.set(id, {id, nameFormatted: Text.encode(NAME), type: types[TYPE]});\n\t\t});\n\t}\n\n\taddMember(member)\n\t{\n\t\tthis.members.set(member.id, member);\n\t}\n\n\tremoveMember(id)\n\t{\n\t\tthis.members.delete(id);\n\t}\n\n\tgetAttachments()\n\t{\n\t\treturn this.attachments;\n\t}\n\n\tsetAttachments(attachments)\n\t{\n\t\tthis.attachments = attachments;\n\t}\n\n\taddAttachments(attachments)\n\t{\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\tthis.attachments[id] = attachments[id];\n\t\t});\n\t}\n\n\tremoveAttachment(id)\n\t{\n\t\tdelete this.attachments[id];\n\t}\n}\n\nexport {CheckListItemFields};","import 'ui.design-tokens';\nimport './css/check-list-item.css';\n\nimport {Dom, Event, Loc, Runtime, Tag, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {CompositeTreeItem} from './composite-tree-item';\nimport {CheckListItemFields} from './check-list-item-fields';\n\nclass CheckListItem extends CompositeTreeItem\n{\n\tclass = CheckListItem;\n\n\tcheckedClass = 'tasks-checklist-item-solved';\n\thiddenClass = 'tasks-checklist-item-hidden';\n\tcollapseClass = 'tasks-checklist-collapse';\n\twrapperClass = 'tasks-checklist-items-wrapper';\n\n\tshowClass = 'tasks-checklist-item-show';\n\thideClass = 'tasks-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.tasks-checklist-item-important',\n\t\t\t'.tasks-checklist-item-dragndrop',\n\t\t\t'.tasks-checklist-item-group-checkbox',\n\t\t\t'.tasks-checklist-item-remove',\n\t\t\t'.tasks-checklist-item-flag-block',\n\t\t],\n\t};\n\n\tstatic addDangerToElement(element)\n\t{\n\t\tconst dangerClass = 'ui-ctl-danger';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tstatic updateParents(oldParent, newParent)\n\t{\n\t\tif (oldParent !== newParent)\n\t\t{\n\t\t\toldParent.updateCounts();\n\t\t\tnewParent.updateCounts();\n\n\t\t\toldParent.updateProgress();\n\t\t\tnewParent.updateProgress();\n\n\t\t\toldParent.updateIndexes();\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t}\n\n\tstatic getProgressText(completed, total)\n\t{\n\t\tconst replaces = {\n\t\t\t'#total#': total,\n\t\t\t'#completed#': completed,\n\t\t};\n\t\tlet progressText = Loc.getMessage('TASKS_CHECKLIST_PROGRESS_BAR_PROGRESS_TEXT');\n\n\t\tObject.keys(replaces).forEach((search) => {\n\t\t\tprogressText = progressText.replace(search, replaces[search]);\n\t\t});\n\n\t\treturn progressText;\n\t}\n\n\tstatic getFileExtension(ext)\n\t{\n\t\tlet fileExtension;\n\n\t\tswitch (ext)\n\t\t{\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'swf':\n\t\t\tcase 'wmv':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'txt':\n\t\t\t\tfileExtension = 'txt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'doc':\n\t\t\tcase 'docx':\n\t\t\t\tfileExtension = 'doc';\n\t\t\t\tbreak;\n\n\t\t\tcase 'xls':\n\t\t\tcase 'xlsx':\n\t\t\t\tfileExtension = 'xls';\n\t\t\t\tbreak;\n\n\t\t\tcase 'php':\n\t\t\t\tfileExtension = 'php';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pdf':\n\t\t\t\tfileExtension = 'pdf';\n\t\t\t\tbreak;\n\n\t\t\tcase 'ppt':\n\t\t\tcase 'pptx':\n\t\t\t\tfileExtension = 'ppt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rar':\n\t\t\t\tfileExtension = 'rar';\n\t\t\t\tbreak;\n\n\t\t\tcase 'zip':\n\t\t\t\tfileExtension = 'zip';\n\t\t\t\tbreak;\n\n\t\t\tcase 'set':\n\t\t\t\tfileExtension = 'set';\n\t\t\t\tbreak;\n\n\t\t\tcase 'mov':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'img':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\t\tfileExtension = 'img';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tfileExtension = 'empty';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn fileExtension;\n\t}\n\n\tstatic getInputSelection(input)\n\t{\n\t\tlet start = 0;\n\t\tlet end = 0;\n\t\tlet normalizedValue;\n\t\tlet range;\n\t\tlet textInputRange;\n\t\tlet len;\n\t\tlet endRange;\n\n\t\tif (typeof input.selectionStart === 'number' && typeof input.selectionEnd === 'number')\n\t\t{\n\t\t\tstart = input.selectionStart;\n\t\t\tend = input.selectionEnd;\n\t\t}\n\t\telse\n\t\t{\n\t\t\trange = document.selection.createRange();\n\n\t\t\tif (range && range.parentElement() === input)\n\t\t\t{\n\t\t\t\tlen = input.value.length;\n\t\t\t\tnormalizedValue = input.value.replace(/\\r\\n/g, '\\n');\n\n\t\t\t\t// Create a working TextRange that lives only in the input\n\t\t\t\ttextInputRange = input.createTextRange();\n\t\t\t\ttextInputRange.moveToBookmark(range.getBookmark());\n\n\t\t\t\t// Check if the start and end of the selection are at the very end\n\t\t\t\t// of the input, since moveStart/moveEnd doesn't return what we want\n\t\t\t\t// in those cases\n\t\t\t\tendRange = input.createTextRange();\n\t\t\t\tendRange.collapse(false);\n\n\t\t\t\tif (textInputRange.compareEndPoints('StartToEnd', endRange) > -1)\n\t\t\t\t{\n\t\t\t\t\tstart = len;\n\t\t\t\t\tend = len;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstart = -textInputRange.moveStart('character', -len);\n\t\t\t\t\tstart += normalizedValue.slice(0, start).split('\\n').length - 1;\n\n\t\t\t\t\tif (textInputRange.compareEndPoints('EndToEnd', endRange) > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tend = len;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tend = -textInputRange.moveEnd('character', -len);\n\t\t\t\t\t\tend += normalizedValue.slice(0, end).split('\\n').length - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {start, end};\n\t}\n\n\tstatic getDefaultCheckListTitle(title)\n\t{\n\t\tlet defaultTitle = title;\n\n\t\tif (title.indexOf('BX_CHECKLIST') === 0)\n\t\t{\n\t\t\tif (title === 'BX_CHECKLIST')\n\t\t\t{\n\t\t\t\tdefaultTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_2');\n\t\t\t}\n\t\t\telse if (title.match(/BX_CHECKLIST_\\d+$/))\n\t\t\t{\n\t\t\t\tconst itemNumber = title.replace('BX_CHECKLIST_', '');\n\t\t\t\tdefaultTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_WITH_NUMBER').replace('#ITEM_NUMBER#', itemNumber);\n\t\t\t}\n\t\t}\n\n\t\treturn defaultTitle;\n\t}\n\n\tstatic smoothScroll(node)\n\t{\n\t\tconst posFrom = BX.GetWindowScrollPos().scrollTop;\n\t\tconst posTo = BX.pos(node).top - Math.round(BX.GetWindowInnerSize().innerHeight / 2);\n\t\tconst toBottom = posFrom < posTo;\n\t\tconst distance = Math.abs(posTo - posFrom);\n\t\tconst speed = (Math.round(distance / 100) > 20 ? 20 : Math.round(distance / 100));\n\t\tconst step = speed / 2;\n\n\t\tif (step <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet posCurrent = (toBottom ? posFrom + step : posFrom - step);\n\t\tlet timer = 0;\n\n\t\tif (toBottom)\n\t\t{\n\t\t\tfor (let i = posFrom; i < posTo; i += step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent += step;\n\t\t\t\tif (posCurrent > posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor (let i = posFrom; i > posTo; i -= step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent -= step;\n\t\t\t\tif (posCurrent < posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getMemberLinkLayout(type, name, url)\n\t{\n\t\tconst messageId = `TASKS_CHECKLIST_${type.toUpperCase()}_ICON_HINT`;\n\t\treturn `\n\t\t\t<span class=\"tasks-checklist-item-auditor\">\n\t\t\t\t<a class=\"tasks-checklist-item-${type}-icon\" title=\"${Loc.getMessage(messageId)}\"></a>\n\t\t\t\t<a href=\"${url}\" class=\"tasks-checklist-item-${type}-link\">${name}</a>\n\t\t\t</span> \n\t\t`;\n\t}\n\n\tstatic getLinkLayout(url)\n\t{\n\t\treturn `<a class=\"tasks-checklist-item-link\" href=\"${url}\" target=\"_blank\">${url}</a>`;\n\t}\n\n\tstatic get keyCodes()\n\t{\n\t\treturn {\n\t\t\tesc: 27,\n\t\t\tenter: 13,\n\t\t\tplus: 43,\n\t\t\tatsign: 64,\n\t\t\ttab: 9,\n\t\t\tup: 38,\n\t\t\tdown: 40,\n\t\t\tbackspace: 8,\n\t\t};\n\t}\n\n\tconstructor(fields = {})\n\t{\n\t\tconst {action} = fields;\n\n\t\tsuper();\n\t\tthis.fields = new CheckListItemFields(fields);\n\t\tthis.action = {\n\t\t\tcanUpdate: (action && 'MODIFY' in action) ? action.MODIFY : true,\n\t\t\tcanRemove: (action && 'REMOVE' in action) ? action.REMOVE : true,\n\t\t\tcanToggle: (action && 'TOGGLE' in action) ? action.TOGGLE : true,\n\t\t\tcanDrag: (action && 'DRAG' in action) ? action.DRAG : true,\n\t\t};\n\n\t\tthis.input = null;\n\t\tthis.panel = null;\n\t\tthis.progress = null;\n\t\tthis.filesLoaderPopup = null;\n\t\tthis.filesLoaderProgressBars = new Map();\n\t\tthis.updateMode = false;\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\tsuper.add(item, position);\n\n\t\titem.optionManager = this.optionManager;\n\t\titem.clickEventHandler = this.clickEventHandler;\n\t}\n\n\tisTaskRoot()\n\t{\n\t\treturn this.getNodeId() === 0 && this.getParent() === null;\n\t}\n\n\tisCheckList()\n\t{\n\t\treturn !this.isTaskRoot() && this.getParent().isTaskRoot();\n\t}\n\n\tgetCheckList()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (!parent.getParent().isTaskRoot())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tfindById(id)\n\t{\n\t\tif (!id)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.fields.getId() && this.fields.getId().toString() === id.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findById(id);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountCompletedCount(recursively = false)\n\t{\n\t\tlet completedCount = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsComplete())\n\t\t\t{\n\t\t\t\tcompletedCount += 1;\n\t\t\t}\n\n\t\t\tif (recursively)\n\t\t\t{\n\t\t\t\tcompletedCount += descendant.countCompletedCount(recursively);\n\t\t\t}\n\t\t});\n\n\t\treturn completedCount;\n\t}\n\n\tcountTotalCount(recursively = false)\n\t{\n\t\tlet totalCount = 0;\n\n\t\tif (!recursively)\n\t\t{\n\t\t\ttotalCount = this.getDescendantsCount();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\ttotalCount += 1;\n\t\t\t\ttotalCount += descendant.countTotalCount(recursively);\n\t\t\t});\n\t\t}\n\n\t\treturn totalCount;\n\t}\n\n\tupdateCompletedCount()\n\t{\n\t\tconst completedCount = this.countCompletedCount();\n\t\tthis.fields.setCompletedCount(completedCount);\n\t}\n\n\tupdateTotalCount()\n\t{\n\t\tconst totalCount = this.countTotalCount();\n\t\tthis.fields.setTotalCount(totalCount);\n\t}\n\n\tupdateCounts()\n\t{\n\t\tthis.updateCompletedCount();\n\t\tthis.updateTotalCount();\n\t}\n\n\tupdateProgress()\n\t{\n\t\tif (this.progress === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst total = this.fields.getTotalCount();\n\t\tconst completed = this.fields.getCompletedCount();\n\n\t\tthis.progress.setMaxValue(total);\n\t\tthis.progress.update(completed);\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tthis.updateProgressText(completed, total);\n\t\t}\n\t}\n\n\tupdateProgressText(completed, total)\n\t{\n\t\tconst progressText = CheckListItem.getProgressText(completed, total);\n\t\tthis.progress.setTextAfter(progressText);\n\t}\n\n\tsetDefaultStyles(layout, action = 'add')\n\t{\n\t\tif (action === 'add')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = 0;\n\t\t\tlayout.style.opacity = 0;\n\n\t\t\tDom.addClass(layout, this.showClass);\n\t\t}\n\t\telse if (action === 'delete')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = `${layout.scrollHeight}px`;\n\t\t\tlayout.style.opacity = 1;\n\n\t\t\tDom.addClass(layout, this.hideClass);\n\t\t}\n\t}\n\n\tdelete()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tparent.remove(this);\n\t\tparent.updateCounts();\n\t\tparent.updateProgress();\n\n\t\tthis.setDefaultStyles(this.container, 'delete');\n\n\t\tsetTimeout(() => {\n\t\t\tthis.container.style.height = 0;\n\t\t\tthis.container.style.opacity = 0;\n\t\t\tthis.container.style.paddingTop = 0;\n\t\t}, 1);\n\n\t\tsetTimeout(() => {\n\t\t\tDom.remove(this.container);\n\t\t}, 250);\n\t}\n\n\trestore()\n\t{\n\t\tconst parent = this.getParent();\n\t\tconst position = this.fields.getSortIndex();\n\n\t\tif (position === 0)\n\t\t{\n\t\t\tif (parent.getDescendantsCount() > 0)\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this, parent.getFirstDescendant(), 'before');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparent.addCheckListItem(this, parent.getDescendants()[position - 1]);\n\t\t}\n\t}\n\n\tdeleteAction(showBalloon = true)\n\t{\n\t\tconst title = this.fields.getTitle();\n\n\t\tthis.delete();\n\n\t\tif (showBalloon && title.length > 0 && title !== '')\n\t\t{\n\t\t\tconst action = 'DELETE';\n\t\t\tconst data = {\n\t\t\t\ttype: this.isCheckList() ? 'CHECKLIST' : 'ITEM',\n\t\t\t};\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'delete'});\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tonDeleteClick(e)\n\t{\n\t\te.preventDefault();\n\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tconst items = this.getSelectedItems();\n\t\t\tconst action = 'DELETE_SELECTED';\n\t\t\tconst data = {items};\n\n\t\t\tthis.runForEachSelectedItem((item) => {\n\t\t\t\titem.fields.setIsSelected(false);\n\t\t\t\titem.deleteAction(false);\n\t\t\t});\n\n\t\t\titems.forEach((item) => {\n\t\t\t\titem.getParent().updateIndexes();\n\t\t\t\titem.handleCheckListChanges();\n\t\t\t});\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteAction();\n\t\tthis.getParent().updateIndexes();\n\n\t\tthis.handleCheckListChanges();\n\t}\n\n\tgetNotificationBalloon(action, data)\n\t{\n\t\tconst actions = [];\n\t\tlet content = '';\n\n\t\tswitch (action)\n\t\t{\n\t\t\tcase 'DELETE':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_${data.type}`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tthis.restore();\n\t\t\t\t\t\t\tthis.handleCheckListChanges();\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'DELETE_SELECTED':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_ITEMS`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tdata.items.forEach((item) => {\n\t\t\t\t\t\t\t\titem.restore();\n\t\t\t\t\t\t\t\titem.handleCheckListChanges();\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'AUDITOR_ADDED':\n\t\t\tcase 'ACCOMPLICE_ADDED':\n\t\t\t{\n\t\t\t\tlet image = '';\n\t\t\t\tif (data.avatar)\n\t\t\t\t{\n\t\t\t\t\timage = Tag.render`\n\t\t\t\t\t\t<img class=\"tasks-checklist-notification-balloon-avatar-img\" src=\"${data.avatar}\" alt=\"\"/>\n\t\t\t\t\t`;\n\t\t\t\t}\n\t\t\t\tcontent = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-message-container\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-avatar\">\n\t\t\t\t\t\t\t${image}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"tasks-checklist-notification-balloon-message\">\n\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}`)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tBX.loadExt('ui.notification').then(() => {\n\t\t\tBX.UI.Notification.Center.notify({content, actions});\n\t\t});\n\t}\n\n\tonToAnotherCheckListClick(e)\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (rootNode.getDescendantsCount() === 1)\n\t\t{\n\t\t\tthis.moveToNewCheckList(2);\n\t\t\treturn;\n\t\t}\n\n\t\tnew BX.PopupMenuWindow(\n\t\t\t'to-another-checklist',\n\t\t\te.target,\n\t\t\tthis.getToAnotherCheckListPopupItems(),\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 3,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose() {\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t).show();\n\t}\n\n\tgetToAnotherCheckListPopupItems()\n\t{\n\t\tconst selectMode = this.checkSelectedItems();\n\t\tconst popupMenuItems = [];\n\t\tconst toNewCheckListMenuItem = {\n\t\t\ttext: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tonclick: (event, item) => {\n\t\t\t\titem.getMenuWindow().close();\n\t\t\t\tthis.moveToNewCheckList(this.getRootNode().getDescendantsCount() + 1);\n\t\t\t},\n\t\t};\n\n\t\tif (selectMode)\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tpopupMenuItems.push({\n\t\t\t\t\ttext: descendant.fields.getTitle(),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\titem.getMenuWindow().close();\n\n\t\t\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\t\t\tselectedItem.makeChildOf(descendant);\n\t\t\t\t\t\t\tdescendant.unselectAll();\n\n\t\t\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tpopupMenuItems.push({delimiter: true});\n\t\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\t\treturn popupMenuItems;\n\t\t}\n\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupMenuItems.push({\n\t\t\t\ttext: descendant.fields.getTitle(),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\tthis.makeChildOf(descendant);\n\t\t\t\t\tthis.handleUpdateEnding();\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tpopupMenuItems.push({delimiter: true});\n\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\treturn popupMenuItems;\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new CheckListItem({TITLE: title});\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tif (this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\tselectedItem.makeChildOf(newCheckList);\n\t\t\t\t\tnewCheckList.unselectAll();\n\n\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.makeChildOf(newCheckList);\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessMemberSelect(member)\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tconst title = selectedItem.fields.getTitle();\n\t\t\t\tconst space = (title.slice(-1) === ' ' ? '' : ' ');\n\t\t\t\tconst newTitle = `${title}${space}${member.nameFormatted}`;\n\n\t\t\t\tselectedItem.fields.addMember(member);\n\t\t\t\tselectedItem.updateTitle(Text.decode(newTitle));\n\t\t\t\tselectedItem.updateTitleNode();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputText = this.input.value;\n\t\tconst mentioned = +this.mentioned;\n\t\tconst start = this.inputCursorPosition.start || 0;\n\t\tconst startSpace = (start === 0 || start - mentioned === 0 || inputText.charAt(start - mentioned - 1) === ' ') ? '' : ' ';\n\t\tconst endSpace = (inputText.charAt(start) === ' ' ? '' : ' ');\n\n\t\tthis.fields.addMember(member);\n\n\t\tconst newInputText = `${inputText.slice(0, start - mentioned)}${startSpace}${Text.decode(member.nameFormatted)}${endSpace}`;\n\n\t\tthis.inputCursorPosition.start = newInputText.length;\n\t\tthis.inputCursorPosition.end = newInputText.length;\n\n\t\tthis.input.value = `${newInputText}${inputText.slice(start)}`;\n\t\tthis.mentioned = false;\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tonSocNetSelectorAuditorSelected(auditor)\n\t{\n\t\tconst type = 'auditor';\n\t\tconst userData = this.prepareUserData(auditor);\n\t\tconst resultAuditor = {...userData, type};\n\n\t\tconst notificationAction = `${type.toUpperCase()}_ADDED`;\n\t\tconst notificationData = {avatar: auditor.avatar};\n\n\t\tthis.processMemberSelect(resultAuditor);\n\t\tthis.getNotificationBalloon(notificationAction, notificationData);\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:auditorAdded', userData);\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'addAuditor'});\n\t}\n\n\tonSocNetSelectorAccompliceSelected(accomplice)\n\t{\n\t\tconst type = 'accomplice';\n\t\tconst userData = this.prepareUserData(accomplice);\n\t\tconst resultAccomplice = {...userData, type};\n\n\t\tconst notificationAction = `${type.toUpperCase()}_ADDED`;\n\t\tconst notificationData = {avatar: accomplice.avatar};\n\n\t\tthis.processMemberSelect(resultAccomplice);\n\t\tthis.getNotificationBalloon(notificationAction, notificationData);\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:accompliceAdded', userData);\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'addAccomplice'});\n\t}\n\n\tprepareUserData(user)\n\t{\n\t\tconst customData = user.getCustomData();\n\t\tconst entityType = user.getEntityType();\n\n\t\treturn {\n\t\t\tavatar: user.avatar,\n\t\t\tdescription: '',\n\t\t\tentityType: 'U',\n\t\t\tid: user.getId(),\n\t\t\tname: customData.get('name'),\n\t\t\tlastName: customData.get('lastName'),\n\t\t\temail: customData.get('email'),\n\t\t\tnameFormatted: Text.encode(user.getTitle()),\n\t\t\tnetworkId: '',\n\t\t\ttype: {\n\t\t\t\tcrmemail: false,\n\t\t\t\textranet: (entityType === 'extranet'),\n\t\t\t\temail: (entityType === 'email'),\n\t\t\t\tnetwork: (entityType === 'network'),\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMemberSelector(e, memberType = 'auditor', mentioned = false)\n\t{\n\t\tif (!this.checkCanAddAccomplice())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst typeFunctionMap = {\n\t\t\tauditor: this.onSocNetSelectorAuditorSelected.bind(this),\n\t\t\taccomplice: this.onSocNetSelectorAccompliceSelected.bind(this),\n\t\t};\n\t\tconst typeFunction = typeFunctionMap[memberType] || typeFunctionMap.auditor;\n\n\t\tthis.isSelectorLoading = true;\n\n\t\tRuntime.loadExtension('ui.entity-selector').then(exports => {\n\t\t\tconst {Dialog} = exports;\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: e.target,\n\t\t\t\tenableSearch: true,\n\t\t\t\tmultiple: false,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\temailUsers: true,\n\t\t\t\t\t\t\tnetworkUsers: this.optionManager.isNetworkEnabled,\n\t\t\t\t\t\t\textranetUsers: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\t'onLoad': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.isSelectorLoading = false;\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.isSelectorLoading = false;\n\t\t\t\t\t\tthis.mentioned = mentioned;\n\t\t\t\t\t\tthis.retrieveFocus();\n\n\t\t\t\t\t\tconst {item: selectedItem} = event.getData();\n\t\t\t\t\t\ttypeFunction(selectedItem);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\tonAddAuditorClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'auditor');\n\t}\n\n\tonAddAccompliceClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'accomplice');\n\t}\n\n\tonUploadAttachmentClick(e)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst {prefix, diskUrls} = this.optionManager;\n\t\tconst {urlSelect, urlRenameFile, urlDeleteFile, urlUpload} = diskUrls;\n\n\t\tif (this.filesLoaderPopup === null)\n\t\t{\n\t\t\tthis.filesLoaderPopup = new BX.PopupWindow({\n\t\t\t\tcontent: this.getAttachmentsLoaderLayout(),\n\t\t\t\tbindElement: e.target,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 2,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: true,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filesLoaderPopup.setBindElement(e.target);\n\t\t}\n\n\t\tthis.filesLoaderPopup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: nodeId,\n\t\t\tcontrolName: `${prefix}[${nodeId}][UF_CHECKLIST_FILES][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect,\n\t\t\turlRenameFile,\n\t\t\turlDeleteFile,\n\t\t\turlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.filesLoaderPopup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show'],\n\t\t);\n\t}\n\n\tonDeleteAttachmentClick(fileId)\n\t{\n\t\tthis.fields.removeAttachment(fileId);\n\t\tDom.remove(this.getAttachmentsContainer().querySelector(`#disk-attach-${fileId}`));\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'deleteAttachment'});\n\t}\n\n\tgetPanelBodyLayout()\n\t{\n\t\tconst membersLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-auditor\" onclick=\"${this.onAddAuditorClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_AUDITOR'}`}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-accomplice\" onclick=\"${this.onAddAccompliceClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_ACCOMPLICE'}`}</span>\n\t\t\t</div>\n\t\t`;\n\t\tconst attachmentButtonLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-attachment\" onclick=\"${this.onUploadAttachmentClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tconst itemsActionButtonsLayout = Tag.render`\n\t\t\t${this.checkSelectedItems() ? '' : attachmentButtonLayout}\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabin\" onclick=\"${this.onTabInClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabout\" onclick=\"${this.onTabOutClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-important\n\t\t\t\t${this.fields.getIsImportant() ? ' tasks-checklist-item-editor-panel-btn-important-selected' : ''}\" onclick=\"${this.onImportantClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage('TASKS_CHECKLIST_PANEL_IMPORTANT')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-checklist\" onclick=\"${this.onToAnotherCheckListClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage('TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-remove\" onclick=\"${this.onDeleteClick.bind(this)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tconst separator = Tag.render`<div class=\"tasks-checklist-item-editor-panel-separator\"></div>`;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel ${this.isTaskRoot() || this.isCheckList() ? 'tasks-checklist-item-editor-group-panel' : ''}\">\n\t\t\t\t${this.checkCanAddAccomplice() ? membersLayout : ''}\n\t\t\t\t${this.checkCanAddAccomplice() && !this.isCheckList() ? separator : ''}\n\t\t\t\t${!this.isCheckList() ? itemsActionButtonsLayout : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateTitle(text)\n\t{\n\t\tthis.fields.setTitle(text);\n\t}\n\n\tupdateTitleNode()\n\t{\n\t\tDom.replace(this.getTitleNodeContainer(), this.getTitleLayout());\n\t}\n\n\tgetTitleLayout()\n\t{\n\t\tconst {userPath} = this.optionManager;\n\t\tconst escapeRegExp = (string) => string.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n\t\tlet title = this.fields.getTitle();\n\n\t\ttitle = (this.isCheckList() ? CheckListItem.getDefaultCheckListTitle(title) : title);\n\n\t\tthis.fields.getMembers().forEach(({id, nameFormatted, type}) => {\n\t\t\tconst regExp = new RegExp(escapeRegExp(nameFormatted), 'g');\n\t\t\tconst url = userPath.replace('#user_id#', id).replace('#USER_ID#', id);\n\t\t\ttitle = title.replace(regExp, CheckListItem.getMemberLinkLayout(type, nameFormatted, url));\n\t\t});\n\n\t\ttitle = title.replace(/(https?:\\/\\/[^\\s]+)/g, url => CheckListItem.getLinkLayout(url));\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${this.getTitleNodeClass()}\">\n\t\t\t\t${title}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tprocessMembersFromText()\n\t{\n\t\tconst membersToDelete = [];\n\n\t\tthis.fields.getMembers().forEach(({id, nameFormatted}) => {\n\t\t\tif (this.fields.getTitle().indexOf(nameFormatted) === -1)\n\t\t\t{\n\t\t\t\tmembersToDelete.push(id);\n\t\t\t}\n\t\t});\n\n\t\tmembersToDelete.forEach((id) => {\n\t\t\tthis.fields.removeMember(id);\n\t\t});\n\t}\n\n\tupdateIndexes()\n\t{\n\t\tthis.updateSortIndexes();\n\t\tthis.updateDisplaySortIndexes();\n\t}\n\n\tupdateSortIndexes()\n\t{\n\t\tlet sortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.fields.setSortIndex(sortIndex);\n\t\t\tsortIndex += 1;\n\t\t});\n\t}\n\n\tupdateDisplaySortIndexes()\n\t{\n\t\tconst parentSortIndex = (this.isCheckList() || this.isTaskRoot() ? '' : `${this.fields.getDisplaySortIndex()}.`);\n\t\tlet localSortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tlocalSortIndex += 1;\n\t\t\tconst newSortIndex = `${parentSortIndex}${localSortIndex}`;\n\n\t\t\tdescendant.fields.setDisplaySortIndex(newSortIndex);\n\n\t\t\tif (!descendant.isCheckList())\n\t\t\t{\n\t\t\t\tdescendant.container.querySelector('.tasks-checklist-item-number').innerText = newSortIndex;\n\t\t\t}\n\n\t\t\tdescendant.updateDisplaySortIndexes();\n\t\t});\n\t}\n\n\thandleTaskOptions()\n\t{\n\t\tconst {userId, showCompleted, showOnlyMine} = this.optionManager;\n\n\t\tthis.getRootNode().hideByCondition((item) => {\n\t\t\tconst isComplete = item.fields.getIsComplete();\n\t\t\tconst hasUserInMembers = item.fields.getMembers().has(userId.toString());\n\t\t\tlet condition;\n\n\t\t\tif (!showCompleted && showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = isComplete || !hasUserInMembers;\n\t\t\t}\n\t\t\telse if (!showCompleted)\n\t\t\t{\n\t\t\t\tcondition = isComplete;\n\t\t\t}\n\t\t\telse if (showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = !hasUserInMembers;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcondition = false;\n\t\t\t}\n\n\t\t\treturn condition;\n\t\t});\n\t}\n\n\thideByCondition(condition)\n\t{\n\t\tif (this.checkCanHide(condition))\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tdescendant.hideByCondition(condition);\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckCanHide(condition)\n\t{\n\t\tif (\n\t\t\tthis.isTaskRoot()\n\t\t\t|| this.updateMode\n\t\t\t|| Dom.hasClass(this.container, this.showClass)\n\t\t\t|| !condition(this)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet canHide = true;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (!condition(descendant))\n\t\t\t{\n\t\t\t\tcanHide = false;\n\t\t\t}\n\t\t\telse if (canHide)\n\t\t\t{\n\t\t\t\tcanHide = descendant.checkCanHide(condition);\n\t\t\t}\n\t\t});\n\n\t\treturn canHide;\n\t}\n\n\thide()\n\t{\n\t\tDom.hide(this.container);\n\t}\n\n\tshow()\n\t{\n\t\tDom.show(this.container);\n\t}\n\n\tcheckIsComplete()\n\t{\n\t\tlet isComplete;\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\tisComplete = false;\n\t\t}\n\t\telse if (this.isCheckList())\n\t\t{\n\t\t\tconst completedCount = this.countCompletedCount(true);\n\t\t\tconst totalCount = this.countTotalCount(true);\n\n\t\t\tisComplete = (completedCount === totalCount && totalCount > 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tisComplete = this.fields.getIsComplete();\n\t\t}\n\n\t\treturn isComplete;\n\t}\n\n\tcheckActiveUpdateExist()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tlet found = false;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === false)\n\t\t\t{\n\t\t\t\tfound = descendant.checkActiveUpdateExist();\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tdisableAllGroup()\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsSelected())\n\t\t\t{\n\t\t\t\tdescendant.toggleGroup();\n\t\t\t}\n\t\t});\n\t}\n\n\tdisableAllUpdateModes()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tthis.handleUpdateEnding();\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.disableAllUpdateModes();\n\t\t});\n\t}\n\n\trememberInputState()\n\t{\n\t\tthis.input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\t}\n\n\tclearInput(e)\n\t{\n\t\te.preventDefault();\n\n\t\tthis.container.querySelector(`#text_${this.getNodeId()}`).value = '';\n\t\tthis.retrieveFocus();\n\t}\n\n\tretrieveFocus()\n\t{\n\t\tif (this.input !== null && this.inputCursorPosition)\n\t\t{\n\t\t\tconst {start, end} = this.inputCursorPosition;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.setSelectionRange(start, end);\n\t\t\t}, 10);\n\t\t}\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-header-name tasks-checklist-header-name-edit-mode\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-after-icon ui-ctl-xs ui-ctl-no-padding ui-ctl-underline \n\t\t\t\t\t\t\t\ttasks-checklist-header-name-editor\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t\t   onkeydown=\"${this.onInputKeyDown.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.UI.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-inner tasks-checklist-item-new ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\">\n\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\">\n\t\t\t\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"></span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-after-icon ui-ctl-w100\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t\t   onkeydown=\"${this.onInputKeyDown.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\tconst node = nodeToPosition || item.getContainer();\n\t\tconst position = Dom.getPosition(node);\n\n\t\tif (!this.panel)\n\t\t{\n\t\t\tthis.panel = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-editor-panel-container\">\n\t\t\t\t\t${item.getPanelBodyLayout()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\n\t\t\tDom.append(this.panel, document.body);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.replace(this.panel.querySelector('.tasks-checklist-item-editor-panel'), item.getPanelBodyLayout());\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\t\t}\n\n\t\tif (!Dom.isShown(this.panel))\n\t\t{\n\t\t\tDom.show(this.panel);\n\t\t}\n\n\t\tif (\n\t\t\t(Dom.isShown(this.panel) && item.isCheckList() && !item.checkCanAddAccomplice())\n\t\t\t|| (position.left === 0 && position.right === 0 && position.width === 0)\n\t\t)\n\t\t{\n\t\t\tDom.hide(this.panel);\n\t\t}\n\t}\n\n\tenableUpdateMode()\n\t{\n\t\tconst viewModeLayout = this.getInnerContainer();\n\t\tconst updateModeLayout = this.getUpdateModeLayout();\n\n\t\tDom.addClass(viewModeLayout, this.hiddenClass);\n\t\tDom.insertBefore(updateModeLayout, viewModeLayout);\n\n\t\tthis.input = updateModeLayout.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.input.focus();\n\t\tthis.input.setSelectionRange(this.input.value.length, this.input.value.length);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\n\t\tEvent.bind(this.input, 'beforeinput', this.onInputBeforeInput.bind(this));\n\n\t\tif (this.input.value === '' || this.input.value.length === 0)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (Dom.isShown(this.input))\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}, 250);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t}\n\n\t\tthis.updateMode = true;\n\t}\n\n\tdisableUpdateMode()\n\t{\n\t\tconst currentInner = this.getInnerContainer();\n\t\tconst text = currentInner.querySelector(`#text_${this.getNodeId()}`).value.trim();\n\n\t\tthis.updateTitle(text);\n\t\tthis.processMembersFromText();\n\t\tthis.updateTitleNode();\n\n\t\tDom.removeClass(currentInner.nextElementSibling, this.hiddenClass);\n\t\tDom.remove(currentInner);\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tcheckCanDeleteOnUpdateEnding()\n\t{\n\t\treturn this.getDescendantsCount() === 0\n\t\t\t&& Object.keys(this.fields.getAttachments()).length === 0\n\t\t\t&& this.filesLoaderProgressBars.size === 0;\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tCheckListItem.addDangerToElement(input.parentElement);\n\n\t\t\t\tif (this.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\t\t}\n\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\ttoggleUpdateMode(e)\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tif (e.keyCode === CheckListItem.keyCodes.enter || e.keyCode === CheckListItem.keyCodes.tab)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding(!this.isCheckList());\n\t\t\t}\n\t\t\telse if (e.keyCode === CheckListItem.keyCodes.esc)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst rootNode = this.getRootNode();\n\n\t\t\trootNode.disableAllUpdateModes();\n\t\t\trootNode.disableAllGroup();\n\n\t\t\tif (!rootNode.checkActiveUpdateExist())\n\t\t\t{\n\t\t\t\tthis.enableUpdateMode();\n\t\t\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'toggleUpdateMode'});\n\t\t\t}\n\t\t}\n\t}\n\n\tonInputKeyDown(e)\n\t{\n\t\tif (this.isSelectorLoading)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (e.keyCode)\n\t\t{\n\t\t\tcase CheckListItem.keyCodes.esc:\n\t\t\tcase CheckListItem.keyCodes.enter:\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\tsetTimeout(() => this.toggleUpdateMode(e));\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.tab:\n\t\t\t{\n\t\t\t\tif (!this.isCheckList())\n\t\t\t\t{\n\t\t\t\t\t(e.shiftKey ? this.tabOut.bind(this) : this.tabIn.bind(this))();\n\t\t\t\t}\n\t\t\t\tthis.retrieveFocus();\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.up:\n\t\t\t{\n\t\t\t\tconst leftSiblingThrough = this.getLeftSiblingThrough();\n\t\t\t\tif (leftSiblingThrough && leftSiblingThrough !== this.getRootNode())\n\t\t\t\t{\n\t\t\t\t\tleftSiblingThrough.toggleUpdateMode(e);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.down:\n\t\t\t{\n\t\t\t\tconst rightSiblingThrough = this.getRightSiblingThrough();\n\t\t\t\tif (rightSiblingThrough)\n\t\t\t\t{\n\t\t\t\t\trightSiblingThrough.toggleUpdateMode(e);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\t// do nothing\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonInputBeforeInput(e)\n\t{\n\t\tif (this.isSelectorLoading)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (['+', '@'].includes(e.data))\n\t\t{\n\t\t\tthis.getMemberSelector(e, this.optionManager.defaultMemberSelectorType, true);\n\t\t}\n\t}\n\n\tonHeaderMouseDown(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseDown(e);\n\t\tthis.clickEventHandler.registerClickDoneCallback(this.onHeaderClickDone.bind(this, e));\n\t}\n\n\tonHeaderMouseUp(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseUp(e);\n\t}\n\n\tonHeaderClickDone(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'header'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tonInnerContainerMouseDown(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseDown(e);\n\t\tthis.clickEventHandler.registerClickDoneCallback(this.onInnerContainerClickDone.bind(this, e));\n\t}\n\n\tonInnerContainerMouseUp(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseUp(e);\n\t}\n\n\tonInnerContainerClickDone(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'item'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getCheckList().fields.getIsSelected())\n\t\t{\n\t\t\tthis.toggleSelect(e);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tgetImportantLayout()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-important\" onclick=\"${this.onImportantClick.bind(this)}\"></div>\n\t\t`;\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.remove(this.container.querySelector('.tasks-checklist-item-important'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.insertBefore(this.getImportantLayout(), this.container.querySelector('.tasks-checklist-item-description'));\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'toggleImportant'});\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tcheckSelectedItems()\n\t{\n\t\treturn this.getRootNode().getSelectedItems().length > 0;\n\t}\n\n\trunForEachSelectedItem(callback, reverse = false)\n\t{\n\t\tlet selectedItems = this.getRootNode().getSelectedItems();\n\n\t\tif (reverse)\n\t\t{\n\t\t\tselectedItems = [...selectedItems.reverse()];\n\t\t}\n\n\t\tselectedItems.forEach((item) => {\n\t\t\tcallback(item);\n\t\t});\n\t}\n\n\tonImportantClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.toggleImportant();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleImportant();\n\n\t\tconst panelImportantButton = e.target.closest('.tasks-checklist-item-editor-panel-btn-important');\n\t\tif (panelImportantButton)\n\t\t{\n\t\t\tDom.toggleClass(panelImportantButton, 'tasks-checklist-item-editor-panel-btn-important-selected');\n\t\t}\n\t}\n\n\tonCompleteAllButtonClick()\n\t{\n\t\tif (this.fields.getIsSelected() || this.updateMode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.completeAll();\n\t\tthis.runAjaxCompleteAll();\n\t}\n\n\tcompleteAll(): void\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (\n\t\t\t\tdescendant.checkCanToggle()\n\t\t\t\t&& !descendant.updateMode\n\t\t\t\t&& !descendant.fields.getIsComplete()\n\t\t\t)\n\t\t\t{\n\t\t\t\tdescendant.toggleComplete(false);\n\t\t\t}\n\t\t\tdescendant.completeAll();\n\t\t});\n\t}\n\n\trunAjaxCompleteAll(): void\n\t{\n\t\tconst {ajaxActions, entityId, entityType, stableTreeStructure} = this.optionManager;\n\n\t\tif (!ajaxActions || !ajaxActions.COMPLETE_ALL)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runAction(ajaxActions.COMPLETE_ALL, {\n\t\t\tdata: {\n\t\t\t\t[`${entityType.toLowerCase()}Id`]: entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tresponse.data.forEach(item => {\n\t\t\t\tthis.findById(item.id).updateStableTreeStructure(item.isComplete, stableTreeStructure, stableTreeStructure);\n\t\t\t});\n\t\t});\n\t}\n\n\tonCompleteButtonClick()\n\t{\n\t\tif (\n\t\t\tthis.getCheckList().fields.getIsSelected()\n\t\t\t|| this.updateMode\n\t\t\t|| !this.checkCanToggle()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleComplete();\n\t}\n\n\ttoggleComplete(runAjax = true)\n\t{\n\t\tconst isComplete = this.fields.getIsComplete();\n\n\t\tthis.fields.setIsComplete(!isComplete);\n\t\tthis.getParent().updateCounts();\n\t\tthis.getParent().updateProgress();\n\n\t\tDom.toggleClass(this.getInnerContainer(), this.checkedClass);\n\n\t\tthis.handleCheckListChanges();\n\t\tthis.handleTaskOptions();\n\n\t\tif (runAjax)\n\t\t{\n\t\t\tthis.runAjaxToggleComplete();\n\t\t}\n\t}\n\n\trunAjaxToggleComplete()\n\t{\n\t\tconst id = this.fields.getId();\n\n\t\tif (!id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {};\n\t\tconst {ajaxActions, entityId, entityType, stableTreeStructure} = this.optionManager;\n\t\tconst actionName = (this.fields.getIsComplete() ? ajaxActions.COMPLETE : ajaxActions.RENEW);\n\n\t\tdata[`${entityType.toLowerCase()}Id`] = entityId;\n\t\tdata.checkListItemId = id;\n\n\t\tBX.ajax.runAction(actionName, {data}).then((response) => {\n\t\t\tconst {isComplete} = response.data.checkListItem;\n\t\t\tthis.updateStableTreeStructure(isComplete, stableTreeStructure, stableTreeStructure);\n\t\t});\n\t}\n\n\tupdateStableTreeStructure(isComplete, item, parent)\n\t{\n\t\tif (this.fields.getId() === item.FIELDS.id)\n\t\t{\n\t\t\titem.FIELDS.isComplete = isComplete;\n\t\t\tparent.FIELDS.completedCount += (isComplete ? 1 : -1);\n\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.updateStableTreeStructure(isComplete, descendant, item);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tunselectAll()\n\t{\n\t\tconst checkBox = this.container.querySelector(`#select_${this.getNodeId()}`);\n\n\t\tif (checkBox && checkBox.checked === true)\n\t\t{\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tcheckBox.checked = false;\n\t\t\tDom.removeClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.unselectAll();\n\t\t});\n\t}\n\n\tgetSelected()\n\t{\n\t\tlet selected = [];\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tselected.push(this);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tselected = [...selected, ...descendant.getSelected()];\n\t\t});\n\n\t\treturn selected;\n\t}\n\n\tgetSelectedItems()\n\t{\n\t\treturn this.getSelected().filter(item => !item.isCheckList() && !item.isTaskRoot());\n\t}\n\n\tonSelectCheckboxClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\te.target.checked = false;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleSelect();\n\t}\n\n\ttoggleSelect()\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = false;\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(rootNode.panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = true;\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\t\t}\n\n\t\tDom.toggleClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t}\n\n\tonGroupButtonClick()\n\t{\n\t\tif (!this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\tthis.toggleGroup();\n\t\t}\n\t}\n\n\ttoggleGroup()\n\t{\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.unselectAll();\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\tif (this.fields.getIsCollapse())\n\t\t\t{\n\t\t\t\tthis.toggleCollapse();\n\t\t\t}\n\t\t}\n\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-collapse');\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-expand');\n\t}\n\n\tonCollapseButtonClick()\n\t{\n\t\tif (this.collapseFreezed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleCollapse();\n\t}\n\n\ttoggleCollapse()\n\t{\n\t\tthis.collapseFreezed = true;\n\n\t\tconst wrapperList = this.container.querySelector(`.${this.wrapperClass}`);\n\t\tconst wrapperListHeight = `${Dom.getPosition(wrapperList).height}px`;\n\n\t\tif (!Dom.hasClass(this.container, this.collapseClass))\n\t\t{\n\t\t\tthis.fields.setIsCollapse(true);\n\n\t\t\twrapperList.style.overflow = 'hidden';\n\t\t\twrapperList.style.height = wrapperListHeight;\n\t\t\tsetTimeout(() => { wrapperList.style.height = 0; }, 0);\n\n\t\t\tDom.addClass(this.container, this.collapseClass);\n\n\t\t\tthis.collapseFreezed = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsCollapse(false);\n\n\t\t\twrapperList.style.height = 0;\n\t\t\twrapperList.style.height = `${wrapperList.scrollHeight}px`;\n\n\t\t\tconst setAutoHeight = () => {\n\t\t\t\twrapperList.style.height = 'auto';\n\t\t\t\tBX.unbind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\t\tthis.collapseFreezed = false;\n\t\t\t};\n\t\t\tBX.bind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\tDom.removeClass(this.container, this.collapseClass);\n\t\t}\n\t}\n\n\ttoggleEmpty()\n\t{\n\t\tDom.toggleClass(this.container, 'tasks-checklist-empty');\n\t}\n\n\thandleCheckListIsComplete()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsComplete = checkList.checkIsComplete();\n\n\t\tcheckList.fields.setIsComplete(checkListIsComplete);\n\n\t\tif (\n\t\t\tcheckListIsComplete\n\t\t\t&& !Dom.hasClass(checkList.container, 'tasks-checklist-collapse')\n\t\t\t&& this.collapseOnCompleteAll()\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleCollapse();\n\t\t}\n\t}\n\n\thandleCheckListIsEmpty()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsEmpty = checkList.getDescendantsCount() === 0;\n\n\t\tif (\n\t\t\t(checkListIsEmpty && !Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t\t|| (!checkListIsEmpty && Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleEmpty();\n\t\t}\n\t}\n\n\thandleCheckListChanges()\n\t{\n\t\tthis.handleCheckListIsComplete();\n\t\tthis.handleCheckListIsEmpty();\n\t}\n\n\tcheckSkipUpdate(e, area)\n\t{\n\t\treturn this.skipUpdateClasses[area]\n\t\t\t&& this.skipUpdateClasses[area].find(item => e.target.closest(item));\n\t}\n\n\tshowCompleteAllButton()\n\t{\n\t\treturn this.optionManager.getShowCompleteAllButton();\n\t}\n\n\tcollapseOnCompleteAll()\n\t{\n\t\treturn this.optionManager.getCollapseOnCompleteAll();\n\t}\n\n\tcheckCanAdd()\n\t{\n\t\treturn this.optionManager.getCanAdd();\n\t}\n\n\tcheckCanAddAccomplice()\n\t{\n\t\treturn this.optionManager.getCanAddAccomplice();\n\t}\n\n\tcheckCanUpdate()\n\t{\n\t\treturn this.action.canUpdate;\n\t}\n\n\tcheckCanRemove()\n\t{\n\t\treturn this.action.canRemove;\n\t}\n\n\tcheckCanToggle()\n\t{\n\t\treturn this.action.canToggle;\n\t}\n\n\tcheckCanDrag()\n\t{\n\t\treturn this.action.canDrag;\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn (this.isCheckList() ? 'tasks-checklist-header-name-text' : 'tasks-checklist-item-description-text');\n\t}\n\n\tgetTitleNodeContainer()\n\t{\n\t\treturn this.container.querySelector(`.${this.getTitleNodeClass()}`);\n\t}\n\n\tgetAttachmentsContainer()\n\t{\n\t\treturn this.container.querySelector(`#attachments_${this.getNodeId()}`);\n\t}\n\n\tgetSubItemsContainer()\n\t{\n\t\treturn this.container.querySelector(`#subItems_${this.getNodeId()}`);\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.tasks-checklist-header-name' : '.tasks-checklist-item-inner');\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this.container;\n\t}\n\n\tmove(item, position = 'bottom', action = 'move')\n\t{\n\t\tif (\n\t\t\tthis.getNodeId() === item.getNodeId()\n\t\t\t|| this.findChild(item.getNodeId()) !== null\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst oldParent = this.getParent();\n\t\tconst newParent = item.getParent();\n\n\t\toldParent.remove(this);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tnewParent.addBefore(this, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.addAfter(this, item);\n\t\t}\n\n\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tDom.insertBefore(this.container, item.container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.insertAfter(this.container, item.container);\n\t\t}\n\n\t\tthis.handleCheckListIsEmpty();\n\t\tthis.handleTaskOptions();\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action});\n\t}\n\n\tmakeChildOf(item, position = 'bottom', action = 'makeChildOf')\n\t{\n\t\tif (item.getDescendantsCount() > 0)\n\t\t{\n\t\t\tconst borderItems = {\n\t\t\t\ttop: item.getFirstDescendant(),\n\t\t\t\tbottom: item.getLastDescendant(),\n\t\t\t};\n\n\t\t\tthis.move(borderItems[position], position, action);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst oldParent = this.getParent();\n\t\t\tconst newParent = item;\n\n\t\t\toldParent.remove(this);\n\t\t\tnewParent.add(this);\n\n\t\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\t\tDom.append(this.container, newParent.getSubItemsContainer());\n\t\t\tDom.addClass(this.container, 'mobile-task-checklist-item-wrapper-animate');\n\n\t\t\tthis.handleCheckListIsEmpty();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action});\n\t\t}\n\t}\n\n\ttabIn()\n\t{\n\t\tif (!this.isFirstDescendant())\n\t\t{\n\t\t\tthis.makeChildOf(this.getLeftSibling(), 'bottom', 'tabIn');\n\t\t}\n\t}\n\n\tonTabInClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabIn();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabIn();\n\t\tthis.retrieveFocus();\n\t}\n\n\ttabOut()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tif (parent.isCheckList())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.move(parent, 'bottom', 'tabOut');\n\t}\n\n\tonTabOutClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabOut();\n\t\t\t}, true);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabOut();\n\t\tthis.retrieveFocus();\n\t}\n\n\taddCheckListItem(item = null, dependsOn = null, position = 'after')\n\t{\n\t\tconst itemGet = item instanceof this.class;\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst newCheckListItem = item || new this.class();\n\t\t\tlet newCheckListItemLayout;\n\n\t\t\tif (dependsOn instanceof this.class)\n\t\t\t{\n\t\t\t\tif (position === 'before')\n\t\t\t\t{\n\t\t\t\t\tthis.addBefore(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertBefore(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t\telse if (position === 'after')\n\t\t\t\t{\n\t\t\t\t\tthis.addAfter(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertAfter(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.add(newCheckListItem);\n\n\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\tDom.append(newCheckListItemLayout, this.getSubItemsContainer());\n\t\t\t}\n\n\t\t\tthis.updateCounts();\n\t\t\tthis.updateIndexes();\n\n\t\t\tif (!this.isTaskRoot())\n\t\t\t{\n\t\t\t\tthis.updateProgress();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tif (!itemGet)\n\t\t\t\t{\n\t\t\t\t\tnewCheckListItem.toggleUpdateMode();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.height = `${newCheckListItemLayout.scrollHeight}px`;\n\t\t\t\tnewCheckListItemLayout.style.opacity = 1;\n\t\t\t}, 1);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.overflow = '';\n\t\t\t\tnewCheckListItemLayout.style.height = '';\n\t\t\t\tnewCheckListItemLayout.style.opacity = '';\n\n\t\t\t\tDom.removeClass(newCheckListItemLayout, this.showClass);\n\n\t\t\t\tif (!this.isTaskRoot() && !itemGet && newCheckListItem.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.class.smoothScroll(newCheckListItem.getContainer());\n\t\t\t\t}\n\n\t\t\t\tresolve(newCheckListItem);\n\t\t\t}, 250);\n\t\t});\n\t}\n\n\tonAddCheckListItemClick()\n\t{\n\t\tif (this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addCheckListItem();\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tNODE_ID: this.getNodeId(),\n\t\t\tPARENT_NODE_ID: this.getParent().getNodeId(),\n\t\t\tID: this.fields.getId(),\n\t\t\tCOPIED_ID: this.fields.getCopiedId(),\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: [],\n\t\t\tATTACHMENTS: {},\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\tconst {nameFormatted, type} = value;\n\t\t\titemRequestData.MEMBERS.push({\n\t\t\t\t[key]: {\n\t\t\t\t\tTYPE: type,\n\t\t\t\t\tNAME: Text.decode(nameFormatted),\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tconst attachments = this.fields.getAttachments();\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\titemRequestData.ATTACHMENTS[id] = attachments[id];\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tgetRequestData(inputData = null)\n\t{\n\t\tconst title = this.fields.getTitle();\n\t\tlet data = inputData || [];\n\n\t\tif (!this.isTaskRoot() && title !== '' && title.length > 0)\n\t\t{\n\t\t\tdata.push(this.getItemRequestData());\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdata = descendant.getRequestData(data);\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tappendRequestLayout()\n\t{\n\t\tif (!this.isTaskRoot())\n\t\t{\n\t\t\tconst nodeId = this.getNodeId();\n\t\t\tconst attachments = this.fields.getAttachments();\n\t\t\tconst prefix = `${this.optionManager.prefix}[${nodeId}]`;\n\n\t\t\tlet membersLayout = '';\n\t\t\tlet attachmentsLayout = '';\n\n\t\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_TYPE_${key}\" name=\"${prefix}[MEMBERS][${key}][TYPE]\" value=\"${value.type}\"/>`;\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_NAME_${key}\" name=\"${prefix}[MEMBERS][${key}][NAME]\" value=\"${value.nameFormatted}\"/>`;\n\t\t\t});\n\n\t\t\tObject.keys(attachments).forEach((id) => {\n\t\t\t\tattachmentsLayout += `<input type=\"hidden\" id=\"ATTACHMENTS_${id}\" name=\"${prefix}[ATTACHMENTS][${id}]\" value=\"${attachments[id]}\"/>`;\n\t\t\t});\n\n\t\t\tconst requestLayout = Tag.render`\n\t\t\t\t<div id=\"request_${nodeId}\">\n\t\t\t\t\t<input type=\"hidden\" id=\"NODE_ID\" name=\"${prefix}[NODE_ID]\" value=\"${nodeId}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_NODE_ID\" name=\"${prefix}[PARENT_NODE_ID]\" value=\"${this.getParent().getNodeId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"ID\" name=\"${prefix}[ID]\" value=\"${this.fields.getId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"COPIED_ID\" name=\"${prefix}[COPIED_ID]\" value=\"${this.fields.getCopiedId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_ID\" name=\"${prefix}[PARENT_ID]\" value=\"${this.fields.getParentId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TITLE\" name=\"${prefix}[TITLE]\" value=\"${this.fields.getTitle()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"SORT_INDEX\" name=\"${prefix}[SORT_INDEX]\" value=\"${this.fields.getSortIndex()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_COMPLETE\" name=\"${prefix}[IS_COMPLETE]\" value=\"${this.fields.getIsComplete()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_IMPORTANT\" name=\"${prefix}[IS_IMPORTANT]\" value=\"${this.fields.getIsImportant()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"MODIFY\" name=\"${prefix}[ACTION][MODIFY]\" value=\"${this.checkCanUpdate()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"REMOVE\" name=\"${prefix}[ACTION][REMOVE]\" value=\"${this.checkCanRemove()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TOGGLE\" name=\"${prefix}[ACTION][TOGGLE]\" value=\"${this.checkCanToggle()}\"/>\n\t\t\t\t\t${membersLayout}\n\t\t\t\t\t${attachmentsLayout}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.remove(this.container.querySelector(`#request_${nodeId}`));\n\t\t\tDom.append(requestLayout, this.container);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.appendRequestLayout();\n\t\t});\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst searchId = this.fields.getId() || this.fields.getCopiedId();\n\t\tconst {optionManager} = this;\n\t\tconst optionAttachments = optionManager.attachments;\n\t\tlet attachmentsLayout = '';\n\n\t\tif (optionAttachments && (searchId in optionAttachments))\n\t\t{\n\t\t\tconst attachments = Tag.render`${optionAttachments[searchId]}`;\n\t\t\tconst stableAttachments = this.getStableAttachments(optionManager.getStableTreeStructure());\n\t\t\tconst attachmentsToDelete = [];\n\n\t\t\tif (!attachments)\n\t\t\t{\n\t\t\t\treturn attachmentsLayout;\n\t\t\t}\n\n\t\t\tattachmentsLayout = attachments;\n\n\t\t\tif (!Array.isArray(attachments))\n\t\t\t{\n\t\t\t\tattachmentsLayout = [attachments];\n\t\t\t}\n\n\t\t\tObject.keys(attachmentsLayout).forEach((key) => {\n\t\t\t\tconst attachment = attachmentsLayout[key];\n\t\t\t\tconst fileId = attachment.getAttribute('data-bx-id');\n\t\t\t\tconst extension = CheckListItem.getFileExtension(attachment.getAttribute('data-bx-extension'));\n\t\t\t\tconst extensionClass = `ui-icon-file-${extension}`;\n\t\t\t\tconst iconContainer = attachment.querySelector(`#disk-attach-file-${fileId}`);\n\t\t\t\tconst deleteButton = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\"\n\t\t\t\t\t\t onclick=\"${this.onDeleteAttachmentClick.bind(this, fileId)}\"></div>\n\t\t\t\t`;\n\t\t\t\tconst has = Object.prototype.hasOwnProperty;\n\n\t\t\t\tif (!has.call(stableAttachments, fileId))\n\t\t\t\t{\n\t\t\t\t\tattachmentsToDelete.push(key);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (iconContainer && !Dom.hasClass(iconContainer, extensionClass))\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(iconContainer, extensionClass);\n\t\t\t\t}\n\n\t\t\t\tif (this.checkCanUpdate())\n\t\t\t\t{\n\t\t\t\t\tDom.append(deleteButton, attachment.querySelector('.tasks-checklist-item-attachment-file-cover'));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tattachmentsToDelete.sort((a, b) => b - a);\n\t\t\tattachmentsToDelete.forEach((id) => {\n\t\t\t\tattachmentsLayout.splice(id, 1);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setAttachments({});\n\t\t}\n\n\t\treturn attachmentsLayout;\n\t}\n\n\tgetStableAttachments(item)\n\t{\n\t\tconst fields = item.FIELDS;\n\t\tconst id = fields.id || fields.copiedId;\n\n\t\tif (id === this.fields.getId() || id === this.fields.getCopiedId())\n\t\t{\n\t\t\treturn fields.attachments;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.getStableAttachments(descendant);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tgetLoadedAttachmentLayout(attachment)\n\t{\n\t\tconst {id, name, viewUrl, size, ext} = attachment;\n\t\tlet img = '';\n\n\t\tif (viewUrl)\n\t\t{\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\" style=\"background-image: url(${viewUrl})\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(this, id)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst extension = CheckListItem.getFileExtension(ext);\n\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\">\n\t\t\t\t\t<div class=\"ui-icon ui-icon-file-${extension}\"><i></i></div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(this, id)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\" data-bx-id=\"${id}\">\n\t\t\t\t${img}\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonAttachmentsLoaderMenuItemClick()\n\t{\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\tgetAttachmentsLoaderLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst {prefix} = this.optionManager;\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t\t<div id=\"diskuf-selectdialog-${nodeId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t\t<div class=\"diskuf-files-block tasks-checklist-loader-files\">\n\t\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t\t<input type=\"hidden\" name=\"${prefix}[${nodeId}][UF_CHECKLIST_FILES][]\" value=\"\"/>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t\t<label for=\"file_loader_${nodeId}\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${nodeId}\" type=\"file\"\n\t\t\t\t\t\t\t\t   multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.OnFileUploadSuccess.bind(this));\n\t\tBX.addCustomEvent(filesChooser, 'DiskDLoadFormControllerInit', (uf) => {\n\t\t\tuf._onUploadProgress = this.onUploadProgress.bind(this);\n\t\t});\n\n\t\treturn filesChooser;\n\t}\n\n\tonUploadProgress(item, progress)\n\t{\n\t\tconst {id, name, size} = item;\n\t\tconst newProgress = Math.min(progress, 98);\n\n\t\tif (!this.filesLoaderProgressBars.has(id))\n\t\t{\n\t\t\tconst myProgress = new BX.UI.ProgressRound({\n\t\t\t\tid: `load_progress_${id}`,\n\t\t\t\tvalue: newProgress,\n\t\t\t\tmaxValue: 100,\n\t\t\t\twidth: 69,\n\t\t\t\tlineSize: 5,\n\t\t\t\tfill: false,\n\t\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t\t\tstatusType: BX.UI.ProgressRound.Status.INCIRCLE,\n\t\t\t});\n\t\t\tconst filePreview = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\">\n\t\t\t\t\t${myProgress.getContainer()}\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.filesLoaderProgressBars.set(id, myProgress);\n\t\t\tDom.append(filePreview, this.getAttachmentsContainer());\n\t\t}\n\n\t\tif (!item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = 5;\n\t\t}\n\n\t\tif (newProgress > item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = Math.ceil(newProgress);\n\t\t\titem.progressBarWidth = item.progressBarWidth > 100 ? 100 : item.progressBarWidth;\n\n\t\t\tif (this.filesLoaderProgressBars.has(id))\n\t\t\t{\n\t\t\t\tthis.filesLoaderProgressBars.get(id).update(item.progressBarWidth);\n\t\t\t}\n\t\t}\n\t}\n\n\tOnFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst attachmentId = fileResult.element_id.toString();\n\t\tconst attachment = {\n\t\t\tid: attachmentId,\n\t\t\tname: fileResult.element_name,\n\t\t\tviewUrl: fileResult.element_url,\n\t\t\tsize: uploaderFile.size,\n\t\t\text: uploaderFile.ext,\n\t\t};\n\n\t\tthis.fields.addAttachments({[attachmentId]: attachmentId});\n\t\tthis.filesLoaderProgressBars.delete(uploaderFile.id);\n\n\t\tconst attachmentProgress = this.getAttachmentsContainer().querySelector(`#disk-attach-${uploaderFile.id}`);\n\t\tconst attachmentLayout = this.getLoadedAttachmentLayout(attachment);\n\n\t\tif (attachmentProgress)\n\t\t{\n\t\t\tDom.replace(attachmentProgress, attachmentLayout);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(attachmentLayout, this.getAttachmentsContainer());\n\t\t}\n\n\t\tconst id = this.fields.getId();\n\t\tconst optionAttachments = this.optionManager.attachments;\n\n\t\tif (optionAttachments)\n\t\t{\n\t\t\tif (id in optionAttachments)\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] += attachmentLayout.outerHTML;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] = attachmentLayout.outerHTML;\n\t\t\t}\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', {action: 'fileUpload'});\n\t}\n\n\tgetTaskRootLayout(children)\n\t{\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-task-root\">\n\t\t\t\t<div id=\"subItems_${this.getNodeId()}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst value = this.fields.getCompletedCount();\n\t\tconst maxValue = this.fields.getTotalCount();\n\t\tconst layouts = {\n\t\t\tlistActionsPanel: Tag.render`<div class=\"tasks-checklist-items-list-actions droppable\"></div>`,\n\t\t\tcompleteAllButton: Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-action-complete-all-btn\" onclick=\"${this.onCompleteAllButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_COMPLETE_ALL')}\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tgroupButton: '',\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-wrapper-dragndrop\"></div>`,\n\t\t};\n\n\t\tif (this.checkCanAdd())\n\t\t{\n\t\t\tconst addButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-add-btn\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tconst groupButton = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-action-group-btn\" onclick=\"${this.onGroupButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_GROUP_ACTIONS')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.append(addButtonLayout, layouts.listActionsPanel);\n\t\t\tlayouts.groupButton = groupButton;\n\t\t}\n\n\t\tif (this.checkCanRemove())\n\t\t{\n\t\t\tconst removeButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-remove-btn\" onclick=\"${this.onDeleteClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_DELETE_CHECKLIST')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tDom.append(removeButtonLayout, layouts.listActionsPanel);\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tif (!this.showCompleteAllButton())\n\t\t{\n\t\t\tlayouts.completeAllButton = '';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressBar({\n\t\t\tvalue,\n\t\t\tmaxValue,\n\t\t\tsize: BX.UI.ProgressBar.Size.MEDIUM,\n\t\t\ttextAfter: CheckListItem.getProgressText(value, maxValue),\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-wrapper tasks-checklist-item-group-editor-collapse\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-header-wrapper droppable\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-header-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-header-inner\">\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name\"\n\t\t\t\t\t\t\t\t onmousedown=\"${this.onHeaderMouseDown.bind(this)}\"\n\t\t\t\t\t\t\t\t onmouseup=\"${this.onHeaderMouseUp.bind(this)}\">\n\t\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name-edit-btn\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress-block\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-header-actions\">\n\t\t\t\t\t\t${layouts.completeAllButton}\n\t\t\t\t\t\t${layouts.groupButton}\n\t\t\t\t\t\t<div class=\"tasks-checklist-action-collapse-btn collapsed\" onclick=\"${this.onCollapseButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-items-wrapper\">\n\t\t\t\t\t<div class=\"tasks-checklist-items-list\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${layouts.listActionsPanel}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst layouts = {\n\t\t\tdeleteButton: Tag.render`<button class=\"tasks-checklist-item-remove\" onclick=\"${this.onDeleteClick.bind(this)}\"></button>`,\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-item-dragndrop\"></div>`,\n\t\t\tattachments: this.getAttachmentsLayout(),\n\t\t};\n\n\t\tif (!this.checkCanRemove())\n\t\t{\n\t\t\tlayouts.deleteButton = '';\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-item-inner droppable ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\"\n\t\t\t\t\t onmousedown=\"${this.onInnerContainerMouseDown.bind(this)}\" onmouseup=\"${this.onInnerContainerMouseUp.bind(this)}\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"></span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.fields.getIsImportant() ? this.getImportantLayout() : ''}\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-description\">\n\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-additional-block\">\n\t\t\t\t\t\t${layouts.deleteButton}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-actions-block\">\n\t\t\t\t\t\t<input class=\"tasks-checklist-item-group-checkbox\" id=\"select_${nodeId}\" type=\"checkbox\"\n\t\t\t\t\t\t\t   onclick=\"${this.onSelectCheckboxClick.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-list\" id=\"attachments_${nodeId}\">\n\t\t\t\t\t\t${layouts.attachments}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-sublist-items-wrapper\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetLayout()\n\t{\n\t\tconst children = [];\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tchildren.push(descendant.getLayout());\n\t\t});\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\treturn this.getTaskRootLayout(children);\n\t\t}\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tconst checkListLayout = this.getCheckListLayout(children);\n\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\treturn checkListLayout;\n\t\t}\n\n\t\treturn this.getCheckListItemLayout(children);\n\t}\n}\n\nclass MobileCheckListItem extends CheckListItem\n{\n\tclass = MobileCheckListItem;\n\n\tcheckedClass = 'mobile-task-checklist-item-checked';\n\thiddenClass = 'mobile-task-checklist-item-hidden';\n\tcollapseClass = 'mobile-task-checklist-section-collapse';\n\twrapperClass = 'mobile-task-checklist-wrapper';\n\n\tshowClass = 'mobile-checklist-item-show';\n\thideClass = 'mobile-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.mobile-task-checklist-item-checker',\n\t\t\t'.mobile-task-checklist-item-param',\n\t\t\t'.mobile-task-checklist-item-controls',\n\t\t],\n\t};\n\n\tstatic addDangerToElement(element)\n\t{\n\t\tconst dangerClass = 'mobile-task-checklist-error';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: {},\n\t\t\tATTACHMENTS: this.fields.getAttachments() || {},\n\t\t};\n\t\tconst membersTypes = {\n\t\t\taccomplice: 'A',\n\t\t\tauditor: 'U',\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\titemRequestData.MEMBERS[key] = {TYPE: membersTypes[value.type]};\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tonChecklistAjaxError()\n\t{\n\t\tBXMobileApp.Events.postToComponent('onChecklistAjaxError', {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\ttaskGuid: this.optionManager.taskGuid,\n\t\t}, 'tasks.view');\n\t}\n\n\tsendAddAjaxAction()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst fields = this.getItemRequestData();\n\t\t\tconst parent = this.getParent();\n\n\t\t\tfields.PARENT_ID = parent.fields.getId() || (parent.isTaskRoot() ? 0 : null);\n\n\n\t\t\tBX.ajax.runAction('tasks.task.checklist.add', {\n\t\t\t\tdata: {\n\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\tfields,\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tif (response.status === 'success')\n\t\t\t\t{\n\t\t\t\t\tconst {checkListItem} = response.data;\n\t\t\t\t\tthis.fields.setId(checkListItem.id);\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t}).catch(() => {\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\t}\n\n\tsendUpdateAjaxAction(fields, onFailCallback = null)\n\t{\n\t\tconst onFailFunction = onFailCallback || this.onChecklistAjaxError.bind(this);\n\n\t\tBX.ajax.runAction('tasks.task.checklist.update', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tfields,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tonFailFunction();\n\t\t\t}\n\t\t}).catch(() => onFailFunction());\n\t}\n\n\tsendRemoveAjaxAction()\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.delete', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tsendMembersAddAjaxAction(member, focusInput)\n\t{\n\t\tconst map = {\n\t\t\tauditor: {\n\t\t\t\tactionName: 'addAuditors',\n\t\t\t\tparamName: 'auditorsIds',\n\t\t\t\tletter: 'U',\n\t\t\t},\n\t\t\taccomplice: {\n\t\t\t\tactionName: 'addAccomplices',\n\t\t\t\tparamName: 'accomplicesIds',\n\t\t\t\tletter: 'A',\n\t\t\t},\n\t\t};\n\t\tconst currentType = map[member.type];\n\n\t\tconst toChecklistAddAction = 'tasks.task.checklist.addMembers';\n\t\tconst toChecklistAddData = {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\tmembers: {[member.id]: currentType.letter},\n\t\t};\n\n\t\tBX.ajax.runAction(toChecklistAddAction, {data: toChecklistAddData}).then((toChecklistAddResponse) => {\n\t\t\tif (toChecklistAddResponse.status === 'success')\n\t\t\t{\n\t\t\t\tif (focusInput)\n\t\t\t\t{\n\t\t\t\t\tthis.toggleUpdateMode();\n\t\t\t\t}\n\n\t\t\t\tBX.ajax.runAction(`tasks.task.${currentType.actionName}`, {data: {\n\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\t[currentType.paramName]: [member.id],\n\t\t\t\t}});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.fields.removeMember(member.id);\n\t\t\t}\n\t\t}).catch(() => this.fields.removeMember(member.id));\n\t}\n\n\tsendMoveAfterAjaxAction(afterItem)\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.moveAfter', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tafterItemId: afterItem.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tgetPopupMenuItems()\n\t{\n\t\tconst locPrefix = 'TASKS_CHECKLIST_MOBILE_POPUP_MENU_';\n\t\tconst popupMenuItems = [];\n\t\tconst popupMenuItemsBuildMap = {\n\t\t\tchecklist: {\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\trename: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}RENAME`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-rename.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t\tchecklistItem: {\n\t\t\t\taddFile: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_FILE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-file.png',\n\t\t\t\t},\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\ttabIn: {\n\t\t\t\t\tcondition: this.checkCanTabIn.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_IN`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-in.png',\n\t\t\t\t},\n\t\t\t\ttabOut: {\n\t\t\t\t\tcondition: this.checkCanTabOut.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_OUT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-out.png',\n\t\t\t\t},\n\t\t\t\timportant: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}IMPORTANT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-important.png',\n\t\t\t\t},\n\t\t\t\ttoAnotherChecklist: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TO_ANOTHER_CHECKLIST`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-to-another-checklist.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tconst type = (this.isCheckList() ? 'checklist' : 'checklistItem');\n\n\t\tObject.keys(popupMenuItemsBuildMap[type]).forEach((id) => {\n\t\t\tconst {sectionCode, title, iconUrl, condition} = popupMenuItemsBuildMap[type][id];\n\t\t\tpopupMenuItems.push({id, sectionCode, title, iconUrl, disable: !condition()});\n\t\t});\n\n\t\treturn popupMenuItems;\n\t}\n\n\tgetPopupChecklistsList()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\t\tconst popupChecklistsList = [];\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupChecklistsList.push({\n\t\t\t\tid: descendant.getNodeId(),\n\t\t\t\ttitle: Text.decode(descendant.fields.getTitle()),\n\t\t\t\tsectionCode: '0',\n\t\t\t});\n\t\t});\n\t\tpopupChecklistsList.push({\n\t\t\tid: 'newChecklist',\n\t\t\ttitle: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tsectionCode: '0',\n\t\t});\n\n\t\treturn popupChecklistsList;\n\t}\n\n\tonMemberSelectedEvent(eventData)\n\t{\n\t\tconst {nodeId, member, position, focusInput} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst title = node.fields.getTitle();\n\t\tlet newTitle = '';\n\n\t\tmember.nameFormatted = Text.encode(member.nameFormatted);\n\n\t\tif (focusInput)\n\t\t{\n\t\t\tconst start = position || 0;\n\t\t\tconst startSpace = ((start === 0 || start - 1 === 0 || title.charAt(start - 2) === ' ') ? '' : ' ');\n\t\t\tconst endSpace = (title.charAt(start - 1) === ' ' ? '' : ' ');\n\t\t\tconst newInputText = `${title.slice(0, start - 1)}${startSpace}${member.nameFormatted}${endSpace}`;\n\t\t\tnewTitle = `${newInputText}${title.slice(start)}`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst space = (title.slice(-1) === ' ' ? '' : ' ');\n\t\t\tnewTitle = `${title}${space}${member.nameFormatted}`;\n\t\t}\n\n\t\tnode.fields.addMember(member);\n\t\tnode.updateTitle(Text.decode(newTitle));\n\t\tnode.updateTitleNode();\n\n\t\tif (!this.checkEditMode())\n\t\t{\n\t\t\tnode.sendUpdateAjaxAction({TITLE: Text.decode(node.fields.getTitle())});\n\t\t\tnode.sendMembersAddAjaxAction(member, focusInput);\n\t\t}\n\t\telse if (focusInput)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonAddAttachmentEvent(eventData)\n\t{\n\t\tconst {nodeId, attachment} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tconst key = Object.keys(attachment)[0];\n\t\t\tconst value = Object.values(attachment)[0];\n\n\t\t\tnode.fields.addAttachments({[`n${key}`]: value});\n\t\t}\n\t}\n\n\tonRemoveAttachmentEvent(eventData)\n\t{\n\t\tconst {nodeId, attachmentId} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.fields.removeAttachment(attachmentId);\n\t\t\tnode.fields.removeAttachment(`n${attachmentId}`);\n\t\t}\n\t}\n\n\tgetFakeAttachmentsCount(filesToRemove, filesToAdd)\n\t{\n\t\tconst attachmentsIds = Object.keys(this.fields.getAttachments());\n\t\tconst countWithRemovable = attachmentsIds.filter(id => !filesToRemove.includes(id)).length;\n\n\t\treturn countWithRemovable + filesToAdd.length;\n\t}\n\n\tsetLayoutAttachmentsCount(attachmentsCount)\n\t{\n\t\tconst newAttachmentsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(this)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t\tDom.replace(this.getAttachmentsContainer(), newAttachmentsLayout);\n\t}\n\n\tupdateNodeAttachments(filesToRemove, filesToAdd, attachments = null)\n\t{\n\t\tif (attachments)\n\t\t{\n\t\t\tthis.fields.setAttachments(attachments);\n\t\t}\n\n\t\tconst fakeAttachmentsCount = this.getFakeAttachmentsCount(filesToRemove, filesToAdd);\n\t\tthis.setLayoutAttachmentsCount(fakeAttachmentsCount);\n\t}\n\n\tonAttachFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, attachments, checkListItemId} = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonRemoveFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, attachments} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonFakeAttachFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd, checkListItemId} = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonFakeRemoveFilesEvent(eventData)\n\t{\n\t\tconst {nodeId, filesToRemove, filesToAdd} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonRenameEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonRemoveEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tif (!this.checkEditMode() && node.fields.getId())\n\t\t\t{\n\t\t\t\tnode.sendRemoveAjaxAction();\n\t\t\t}\n\t\t\tnode.deleteAction(false);\n\t\t\tnode.getParent().updateIndexes();\n\t\t\tnode.handleCheckListChanges();\n\t\t}\n\t}\n\n\tonTabInEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabIn())\n\t\t{\n\t\t\tnode.tabIn();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst fields = {\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t};\n\t\t\t\t\tconst onFailCallback = () => { node.tabOut(); };\n\n\t\t\t\t\tnode.sendUpdateAjaxAction(fields, onFailCallback);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonTabOutEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabOut())\n\t\t{\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnode.sendMoveAfterAjaxAction(node.getParent());\n\t\t\t}\n\t\t\tnode.tabOut();\n\t\t}\n\t}\n\n\tonImportantEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleImportant();\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tconst onFailCallback = () => { node.toggleImportant(); };\n\t\t\t\tnode.sendUpdateAjaxAction({IS_IMPORTANT: node.fields.getIsImportant()}, onFailCallback);\n\t\t\t}\n\t\t}\n\t}\n\n\tonToAnotherCheckListEvent(eventData)\n\t{\n\t\tconst {nodeId, checklistId} = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (checklistId === 'newChecklist')\n\t\t{\n\t\t\tnode.moveToNewCheckList(this.getDescendantsCount() + 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.makeChildOf(this.findChild(checklistId));\n\t\t\tnode.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnode.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetNativeComponentName()\n\t{\n\t\treturn (this.checkEditMode() ? 'tasks.edit' : 'tasks.view');\n\t}\n\n\tcheckEditMode()\n\t{\n\t\treturn this.optionManager.isEditMode();\n\t}\n\n\tcheckCanTabIn()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.isFirstDescendant();\n\t}\n\n\tcheckCanTabOut()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.getParent().isCheckList();\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\t// no editor panel in mobile version\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn this.isCheckList() ? 'mobile-task-checklist-head-title-text' : 'mobile-task-checklist-item-text';\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.mobile-task-checklist-head-title' : '.mobile-task-checklist-item');\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new MobileCheckListItem({TITLE: title});\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tthis.makeChildOf(newCheckList);\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnewCheckList.sendAddAjaxAction().then(() => {\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: this.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}, () => {});\n\t\t\t}\n\t\t});\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.removeClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.addClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tif (!this.checkEditMode() && this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tthis.sendRemoveAjaxAction();\n\t\t\t\t}\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tMobileCheckListItem.addDangerToElement(input.parentElement);\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tconst itemRequestData = this.getItemRequestData();\n\t\t\t\t\tconst members = itemRequestData.MEMBERS;\n\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tTITLE: itemRequestData.TITLE,\n\t\t\t\t\t\tMEMBERS: (Object.keys(members).length > 0 ? members : ''),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.sendAddAjaxAction().then(() => {}, () => {});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonInputBeforeInput(e)\n\t{\n\t\tconst memberSelectorCallKeys = ['@', '+'];\n\t\tconst position = CheckListItem.getInputSelection(this.input).start;\n\n\t\tif (memberSelectorCallKeys.includes(e.data) && this.checkCanAddAccomplice())\n\t\t{\n\t\t\tconst params = {\n\t\t\t\tposition,\n\t\t\t\tnodeId: this.getNodeId(),\n\t\t\t};\n\t\t\tBXMobileApp.Events.postToComponent(\n\t\t\t\t'onChecklistInputMemberSelectorCall',\n\t\t\t\tparams,\n\t\t\t\tthis.getNativeComponentName()\n\t\t\t);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tonInputKeyPressed(e)\n\t{\n\t\tif (e.keyCode === CheckListItem.keyCodes.enter)\n\t\t{\n\t\t\tthis.toggleUpdateMode(e);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tgetParamsForMobileEvent(type)\n\t{\n\t\tif (!['settings', 'attachments'].includes(type))\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tconst {entityId, entityType, taskGuid, diskOptions, mode} = this.optionManager;\n\t\tconst defaultParams = {\n\t\t\ttaskGuid,\n\t\t\ttaskId: entityId,\n\t\t\tnodeId: this.getNodeId(),\n\t\t\tdisk: diskOptions,\n\t\t\tajaxData: {\n\t\t\t\tentityId,\n\t\t\t\tmode,\n\t\t\t\tcheckListItemId: (this.checkEditMode() ? this.getNodeId() : this.fields.getId()),\n\t\t\t\tentityTypeId: `${entityType.toLowerCase()}Id`,\n\t\t\t},\n\t\t};\n\t\tlet localParams = {};\n\n\t\tif (type === 'settings')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tpopupChecklists: this.getPopupChecklistsList(),\n\t\t\t\tpopupMenuItems: this.getPopupMenuItems(),\n\t\t\t\tpopupMenuSections: [{id: '0', title: Text.decode(this.fields.getTitle())}],\n\t\t\t};\n\t\t}\n\t\telse if (type === 'attachments')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tattachmentsIds: Object.keys(this.fields.getAttachments()),\n\t\t\t\tcanUpdate: this.checkCanUpdate(),\n\t\t\t};\n\t\t}\n\n\t\treturn {...defaultParams, ...localParams};\n\t}\n\n\tonAttachmentsLayoutClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('attachments');\n\t\tBXMobileApp.Events.postToComponent('onChecklistAttachmentsClick', params, this.getNativeComponentName());\n\t}\n\n\tonSettingsClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('settings');\n\t\tBXMobileApp.Events.postToComponent('onChecklistSettingsClick', params, this.getNativeComponentName());\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"mobile-task-checklist-head-title mobile-task-checklist-item-edit-mode\">\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item mobile-task-checklist-item-edit-mode ${this.fields.getIsComplete() ? this.checkedClass : ''}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item-checker\">\n\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst attachmentsCount = Object.keys(this.fields.getAttachments()).length;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(this)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\t\tconst addButtonLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-add-button\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t<div class=\"mobile-task-checklist-add-text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\tstatusType: BX.UI.ProgressRound.Status.COUNTER,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-section\" id=\"${nodeId}\" data-role=\"mobile-task-checklist\">\n\t\t\t\t<div class=\"mobile-task-checklist-head\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-counter\">\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-counter-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-head-title\" onclick=\"${this.onHeaderClickDone.bind(this)}\">\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-visible\"\n\t\t\t\t\t\t\t onclick=\"${this.onCollapseButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-wrapper\">\n\t\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.checkCanAdd() ? addButtonLayout : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-wrapper\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item ${this.fields.getIsComplete() ? this.checkedClass : ''} ${this.fields.getIsImportant() ? 'mobile-task-checklist-item-important' : ''}\"\n\t\t\t\t\t onclick=\"${this.onInnerContainerClickDone.bind(this)}\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-checker\" id=\"progress_${nodeId}\"\n\t\t\t\t\t\t onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.getAttachmentsLayout()}\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n}\n\nexport {CheckListItem, MobileCheckListItem};"],"names":["TreeItem","Math","random","toString","substr","setNodeId","generateUniqueNodeId","setParent","parent","getParent","nodeId","CompositeTreeItem","descendants","item","position","push","splice","after","index","findIndex","descendant","add","before","length","getFirstDescendant","getLastDescendant","isFirstDescendant","parentDescendants","getDescendants","isLastDescendant","getRootNode","leftSiblingThrough","getLeftSibling","getDescendantsCount","getRightSibling","getNodeId","found","forEach","findChild","size","countTreeSize","CheckListItemFields","string","camelCaseString","Type","isString","toLowerCase","replace","match","chr","toUpperCase","snakeCaseString","fields","id","parentId","title","sortIndex","displaySortIndex","isComplete","isImportant","isSelected","isCollapse","completedCount","totalCount","members","Map","attachments","setFields","Object","keys","name","camelCaseName","snakeToCamelCase","indexOf","snakeCaseName","camelToSnakeCase","setMethod","bind","copiedId","Text","encode","types","A","U","clear","NAME","TYPE","set","nameFormatted","type","member","CheckListItem","element","dangerClass","Dom","hasClass","addClass","oldParent","newParent","updateCounts","updateProgress","updateIndexes","completed","total","replaces","progressText","Loc","getMessage","search","ext","fileExtension","input","start","end","normalizedValue","range","textInputRange","len","endRange","selectionStart","selectionEnd","document","selection","createRange","parentElement","value","createTextRange","moveToBookmark","getBookmark","collapse","compareEndPoints","moveStart","slice","split","moveEnd","defaultTitle","itemNumber","node","posFrom","BX","GetWindowScrollPos","scrollTop","posTo","pos","top","round","GetWindowInnerSize","innerHeight","toBottom","distance","abs","speed","step","posCurrent","timer","i","setTimeout","url","messageId","esc","enter","plus","atsign","tab","up","down","backspace","action","header","canUpdate","MODIFY","canRemove","REMOVE","canToggle","TOGGLE","canDrag","DRAG","panel","progress","filesLoaderPopup","filesLoaderProgressBars","updateMode","optionManager","clickEventHandler","isTaskRoot","getId","findById","recursively","getIsComplete","countCompletedCount","countTotalCount","setCompletedCount","setTotalCount","updateCompletedCount","updateTotalCount","getTotalCount","getCompletedCount","setMaxValue","update","isCheckList","updateProgressText","getProgressText","setTextAfter","layout","style","overflow","height","opacity","showClass","scrollHeight","hideClass","remove","setDefaultStyles","container","paddingTop","getSortIndex","addCheckListItem","showBalloon","getTitle","data","getNotificationBalloon","EventEmitter","emit","e","preventDefault","hide","checkSelectedItems","items","getSelectedItems","runForEachSelectedItem","setIsSelected","deleteAction","handleCheckListChanges","actions","content","events","click","event","balloon","close","restore","handleTaskOptions","image","avatar","Tag","render","loadExt","then","UI","Notification","Center","notify","rootNode","moveToNewCheckList","PopupMenuWindow","target","getToAnotherCheckListPopupItems","autoHide","closeByEsc","offsetLeft","offsetWidth","angle","onPopupClose","destroy","show","selectMode","popupMenuItems","toNewCheckListMenuItem","text","message","onclick","getMenuWindow","selectedItem","makeChildOf","unselectAll","delimiter","checkList","getCheckList","checkLists","filter","handleUpdateEnding","number","newCheckList","TITLE","space","newTitle","addMember","updateTitle","decode","updateTitleNode","inputText","mentioned","inputCursorPosition","startSpace","charAt","endSpace","newInputText","retrieveFocus","auditor","userData","prepareUserData","resultAuditor","notificationAction","notificationData","processMemberSelect","accomplice","resultAccomplice","user","customData","getCustomData","entityType","getEntityType","description","get","lastName","email","networkId","crmemail","extranet","network","memberType","checkCanAddAccomplice","typeFunctionMap","onSocNetSelectorAuditorSelected","onSocNetSelectorAccompliceSelected","typeFunction","isSelectorLoading","Runtime","loadExtension","exports","Dialog","dialog","targetNode","enableSearch","multiple","entities","options","inviteGuestLink","inviteEmployeeLink","emailUsers","networkUsers","isNetworkEnabled","extranetUsers","getData","getMemberSelector","prefix","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","PopupWindow","getAttachmentsLoaderLayout","bindElement","setBindElement","Disk","UF","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","querySelector","fileId","removeAttachment","getAttachmentsContainer","membersLayout","onAddAuditorClick","onAddAccompliceClick","attachmentButtonLayout","onUploadAttachmentClick","itemsActionButtonsLayout","onTabInClick","onTabOutClick","getIsImportant","onImportantClick","onToAnotherCheckListClick","onDeleteClick","separator","setTitle","getTitleNodeContainer","getTitleLayout","userPath","escapeRegExp","getDefaultCheckListTitle","getMembers","regExp","RegExp","getMemberLinkLayout","getLinkLayout","getTitleNodeClass","membersToDelete","removeMember","updateSortIndexes","updateDisplaySortIndexes","setSortIndex","parentSortIndex","getDisplaySortIndex","localSortIndex","newSortIndex","setDisplaySortIndex","innerText","userId","showCompleted","showOnlyMine","hideByCondition","hasUserInMembers","has","condition","checkCanHide","canHide","checkActiveUpdateExist","getIsSelected","toggleGroup","disableAllUpdateModes","getInputSelection","focus","setSelectionRange","onInputKeyDown","rememberInputState","clearInput","progressBarLayout","ProgressRound","maxValue","width","lineSize","fill","color","Color","PRIMARY","onCompleteButtonClick","getContainer","nodeToPosition","getPosition","getPanelBodyLayout","left","append","body","isShown","right","viewModeLayout","getInnerContainer","updateModeLayout","getUpdateModeLayout","hiddenClass","insertBefore","Event","onInputBeforeInput","showEditorPanel","currentInner","trim","processMembersFromText","removeClass","nextElementSibling","getAttachments","createNewItem","checkCanDeleteOnUpdateEnding","handleCheckListIsEmpty","addDangerToElement","disableUpdateMode","keyCode","keyCodes","disableAllGroup","enableUpdateMode","toggleUpdateMode","shiftKey","tabOut","tabIn","getLeftSiblingThrough","rightSiblingThrough","getRightSiblingThrough","includes","defaultMemberSelectorType","handleMouseDown","registerClickDoneCallback","onHeaderClickDone","handleMouseUp","checkCanUpdate","checkSkipUpdate","onInnerContainerClickDone","toggleSelect","setIsImportant","getImportantLayout","callback","reverse","selectedItems","toggleImportant","panelImportantButton","closest","toggleClass","completeAll","runAjaxCompleteAll","checkCanToggle","toggleComplete","ajaxActions","entityId","stableTreeStructure","COMPLETE_ALL","ajax","runAction","response","updateStableTreeStructure","runAjax","setIsComplete","checkedClass","runAjaxToggleComplete","actionName","COMPLETE","RENEW","checkListItemId","checkListItem","FIELDS","DESCENDANTS","checkBox","checked","selected","getSelected","getIsCollapse","toggleCollapse","collapseFreezed","wrapperList","wrapperClass","wrapperListHeight","collapseClass","setIsCollapse","setAutoHeight","unbind","checkListIsComplete","checkIsComplete","collapseOnCompleteAll","checkListIsEmpty","toggleEmpty","handleCheckListIsComplete","area","skipUpdateClasses","find","getShowCompleteAllButton","getCollapseOnCompleteAll","getCanAdd","getCanAddAccomplice","addBefore","addAfter","updateParents","insertAfter","borderItems","bottom","move","getSubItemsContainer","dependsOn","itemGet","Promise","resolve","newCheckListItem","newCheckListItemLayout","getLayout","smoothScroll","itemRequestData","NODE_ID","PARENT_NODE_ID","ID","COPIED_ID","getCopiedId","PARENT_ID","getParentId","SORT_INDEX","IS_COMPLETE","IS_IMPORTANT","MEMBERS","ATTACHMENTS","key","inputData","getItemRequestData","getRequestData","attachmentsLayout","requestLayout","checkCanRemove","appendRequestLayout","searchId","optionAttachments","stableAttachments","getStableAttachments","getStableTreeStructure","attachmentsToDelete","Array","isArray","attachment","getAttribute","extension","getFileExtension","extensionClass","iconContainer","deleteButton","onDeleteAttachmentClick","prototype","hasOwnProperty","call","sort","a","b","setAttachments","viewUrl","img","filesChooser","onAttachmentsLoaderMenuItemClick","addCustomEvent","OnFileUploadSuccess","uf","_onUploadProgress","onUploadProgress","newProgress","min","myProgress","statusType","Status","INCIRCLE","filePreview","progressBarWidth","ceil","fileResult","file","uploaderFile","attachmentId","element_id","element_name","element_url","addAttachments","attachmentProgress","attachmentLayout","getLoadedAttachmentLayout","outerHTML","children","layouts","listActionsPanel","completeAllButton","onCompleteAllButtonClick","groupButton","dndButton","checkCanAdd","addButtonLayout","onAddCheckListItemClick","onGroupButtonClick","removeButtonLayout","checkCanDrag","visibility","showCompleteAllButton","ProgressBar","Size","MEDIUM","textAfter","onHeaderMouseDown","onHeaderMouseUp","onCollapseButtonClick","getAttachmentsLayout","onInnerContainerMouseDown","onInnerContainerMouseUp","onSelectCheckboxClick","getTaskRootLayout","checkListLayout","getCheckListLayout","getCheckListItemLayout","MobileCheckListItem","membersTypes","BXMobileApp","Events","postToComponent","taskId","taskGuid","reject","status","setId","onChecklistAjaxError","onFailCallback","onFailFunction","focusInput","map","paramName","letter","currentType","toChecklistAddAction","toChecklistAddData","toChecklistAddResponse","afterItem","afterItemId","locPrefix","popupMenuItemsBuildMap","checklist","addAuditor","sectionCode","iconUrl","addAccomplice","rename","checklistItem","addFile","checkCanTabIn","checkCanTabOut","important","toAnotherChecklist","disable","popupChecklistsList","eventData","checkEditMode","sendUpdateAjaxAction","sendMembersAddAjaxAction","values","filesToRemove","filesToAdd","attachmentsIds","countWithRemovable","attachmentsCount","newAttachmentsLayout","onAttachmentsLayoutClick","fakeAttachmentsCount","getFakeAttachmentsCount","setLayoutAttachmentsCount","updateNodeAttachments","sendRemoveAjaxAction","sendMoveAfterAjaxAction","checklistId","isEditMode","sendAddAjaxAction","memberSelectorCallKeys","params","getNativeComponentName","diskOptions","mode","defaultParams","disk","ajaxData","entityTypeId","localParams","popupChecklists","getPopupChecklistsList","getPopupMenuItems","popupMenuSections","getParamsForMobileEvent","onInputKeyPressed","Mobile","Tasks","CheckList","settingsLayout","onSettingsClick","COUNTER"],"mappings":"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"}