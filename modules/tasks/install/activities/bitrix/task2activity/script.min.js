(function(e,t,a,r,i,l){"use strict";var n,s,o,c,d;function u(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */u=function t(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,r=Object.defineProperty||function(e,t,a){e[t]=a.value},i="function"==typeof Symbol?Symbol:{},l=i.iterator||"@@iterator",n=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function o(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function e(t,a,r){return t[a]=r}}function c(e,t,a,i){var l=t&&t.prototype instanceof h?t:h,n=Object.create(l.prototype),s=new G(i||[]);return r(n,"_invoke",{value:F(e,a,s)}),n}function d(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var v={};function h(){}function p(){}function f(){}var b={};o(b,l,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(E([])));y&&y!==t&&a.call(y,l)&&(b=y);var m=f.prototype=h.prototype=Object.create(b);function w(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function i(r,l,n,s){var o=d(e[r],e,l);if("throw"!==o.type){var c=o.arg,u=c.value;return u&&"object"==babelHelpers["typeof"](u)&&a.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,n,s)}),(function(e){i("throw",e,n,s)})):t.resolve(u).then((function(e){c.value=e,n(c)}),(function(e){return i("throw",e,n,s)}))}s(o.arg)}var l;r(this,"_invoke",{value:function e(a,r){function n(){return new t((function(e,t){i(a,r,e,t)}))}return l=l?l.then(n,n):n()}})}function F(e,t,a){var r="suspendedStart";return function(i,l){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw l;return k()}for(a.method=i,a.arg=l;;){var n=a.delegate;if(n){var s=H(n,a);if(s){if(s===v)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===r)throw r="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r="executing";var o=d(e,t,a);if("normal"===o.type){if(r=a.done?"completed":"suspendedYield",o.arg===v)continue;return{value:o.arg,done:a.done}}"throw"===o.type&&(r="completed",a.method="throw",a.arg=o.arg)}}}function H(e,t){var a=t.method,r=e.iterator[a];if(undefined===r)return t.delegate=null,"throw"===a&&e.iterator["return"]&&(t.method="return",t.arg=undefined,H(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),v;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,v;var l=i.arg;return l?l.done?(t[e.resultName]=l.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,v):l:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function G(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function E(e){if(e){var t=e[l];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=undefined,t.done=!0,t};return i.next=i}}return{next:k}}function k(){return{value:undefined,done:!0}}return p.prototype=f,r(m,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:p,configurable:!0}),p.displayName=o(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,o(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},w(P.prototype),o(P.prototype,n,(function(){return this})),e.AsyncIterator=P,e.async=function(t,a,r,i,l){void 0===l&&(l=Promise);var n=new P(c(t,a,r,i),l);return e.isGeneratorFunction(a)?n:n.next().then((function(e){return e.done?e.value:n.next()}))},w(m),o(m,s,"Generator"),o(m,l,(function(){return this})),o(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var r in t)a.push(r);return a.reverse(),function e(){for(;a.length;){var r=a.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=E,G.prototype={constructor:G,reset:function e(t){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=undefined)},stop:function e(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function e(t){if(this.done)throw t;var r=this;function i(e,a){return s.type="throw",s.arg=t,r.next=e,a&&(r.method="next",r.arg=undefined),!!a}for(var l=this.tryEntries.length-1;l>=0;--l){var n=this.tryEntries[l],s=n.completion;if("root"===n.tryLoc)return i("end");if(n.tryLoc<=this.prev){var o=a.call(n,"catchLoc"),c=a.call(n,"finallyLoc");if(o&&c){if(this.prev<n.catchLoc)return i(n.catchLoc,!0);if(this.prev<n.finallyLoc)return i(n.finallyLoc)}else if(o){if(this.prev<n.catchLoc)return i(n.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return i(n.finallyLoc)}}}},abrupt:function e(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var l=this.tryEntries[i];if(l.tryLoc<=this.prev&&a.call(l,"finallyLoc")&&this.prev<l.finallyLoc){var n=l;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=r&&r<=n.finallyLoc&&(n=null);var s=n?n.completion:{};return s.type=t,s.arg=r,n?(this.method="next",this.next=n.finallyLoc,v):this.complete(s)},complete:function e(t,a){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&a&&(this.next=a),v},finish:function e(t){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),v}},catch:function e(t){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var l=i.arg;T(r)}return l}}throw new Error("illegal catch attempt")},delegateYield:function e(t,a,r){return this.delegate={iterator:E(t),resultName:a,nextLoc:r},"next"===this.method&&(this.arg=undefined),v}},e}function v(e,t){var a=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=h(e))||t&&e&&typeof e.length==="number"){if(a)e=a;var r=0;var i=function e(){};return{s:i,n:function t(){if(r>=e.length)return{done:true};return{done:false,value:e[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=true,n=false,s;return{s:function t(){a=a.call(e)},n:function e(){var t=a.next();l=t.done;return t},e:function e(t){n=true;s=t},f:function e(){try{if(!l&&a["return"]!=null)a["return"]()}finally{if(n)throw s}}}}function h(e,t){if(!e)return;if(typeof e==="string")return p(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor)a=e.constructor.name;if(a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return p(e,t)}function p(e,t){if(t==null||t>e.length)t=e.length;for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function f(e,t){g(e,t);t.add(e)}function b(e,t,a){g(e,t);t.set(e,a)}function g(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function y(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var m=a.Reflection.namespace("BX.Tasks.Automation.Activity");var w={EXPRESSION:"expression",NEW:"new",SIMPLE:"simple"};var P=new WeakMap;var F=new WeakMap;var H=new WeakMap;var S=new WeakMap;var T=new WeakMap;var G=new WeakMap;var E=new WeakMap;var k=new WeakMap;var I=new WeakMap;var L=new WeakMap;var D=new WeakMap;var O=new WeakMap;var x=new WeakMap;var W=new WeakMap;var _=new WeakMap;var M=new WeakMap;var A=new WeakMap;var N=new WeakMap;var R=new WeakSet;var j=new WeakSet;var B=new WeakSet;var C=new WeakSet;var U=new WeakSet;var X=new WeakSet;var q=new WeakSet;var z=new WeakSet;var V=new WeakSet;var K=new WeakSet;var Y=new WeakSet;var $=new WeakSet;var J=new WeakSet;var Q=new WeakSet;var Z=new WeakSet;var ee=new WeakSet;var te=new WeakSet;var ae=new WeakSet;var re=new WeakSet;var ie=new WeakSet;var le=new WeakSet;var ne=new WeakSet;var se=new WeakSet;var oe=new WeakSet;var ce=function(){function e(t){var r=this;babelHelpers.classCallCheck(this,e);f(this,oe);f(this,se);f(this,ne);f(this,le);f(this,ie);f(this,re);f(this,ae);f(this,te);f(this,ee);f(this,Z);f(this,Q);f(this,J);f(this,$);f(this,Y);f(this,K);f(this,V);f(this,z);f(this,q);f(this,X);f(this,U);f(this,C);f(this,B);f(this,j);f(this,R);b(this,P,{writable:true,value:void 0});b(this,F,{writable:true,value:void 0});b(this,H,{writable:true,value:void 0});b(this,S,{writable:true,value:void 0});b(this,T,{writable:true,value:void 0});b(this,G,{writable:true,value:new Map});b(this,E,{writable:true,value:new Set});b(this,k,{writable:true,value:new Set});b(this,I,{writable:true,value:void 0});b(this,L,{writable:true,value:void 0});b(this,D,{writable:true,value:void 0});b(this,O,{writable:true,value:void 0});b(this,x,{writable:true,value:[]});b(this,W,{writable:true,value:void 0});b(this,_,{writable:true,value:void 0});b(this,M,{writable:true,value:void 0});b(this,A,{writable:true,value:void 0});b(this,N,{writable:true,value:[]});if(t.isRobot){babelHelpers.classPrivateFieldSet(this,P,document.forms.namedItem(t.formName));if(!a.Type.isDomNode(babelHelpers.classPrivateFieldGet(this,P).GROUP_ID)){a.Dom.append(a.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['<select name="GROUP_ID" hidden="true"></select>']))),babelHelpers.classPrivateFieldGet(this,P))}if(!a.Type.isDomNode(babelHelpers.classPrivateFieldGet(this,P).FLOW_ID)){a.Dom.append(a.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['<select name="FLOW_ID" hidden="true"></select>']))),babelHelpers.classPrivateFieldGet(this,P))}babelHelpers.classPrivateFieldSet(this,F,t.selectedGroupId);babelHelpers.classPrivateFieldSet(this,S,t.selectedFlowId);y(this,R,de).call(this,t.controlledByFlowFields);t.selectedTags.forEach((function(e){if(e.type===w.EXPRESSION){babelHelpers.classPrivateFieldGet(r,E).add(e.name)}else if(e.type===w.SIMPLE&&a.Type.isNumber(e.id)){babelHelpers.classPrivateFieldGet(r,G).set(e.id,e.name)}else if(e.type===w.NEW){babelHelpers.classPrivateFieldGet(r,k).add(e.name)}}));babelHelpers.classPrivateFieldSet(this,D,new Set(t.dependsOn))}else{babelHelpers.classPrivateFieldSet(this,O,[]);var i=v(t.controlledByFlowFields),l;try{for(i.s();!(l=i.n()).done;){var o;var c=l.value;var d=(o=document.querySelector('[name="'.concat(c,'"]')))===null||o===void 0?void 0:o.closest('td[width="60%"]');if(d){babelHelpers.classPrivateFieldGet(this,O).push(d)}}}catch(e){i.e(e)}finally{i.f()}babelHelpers.classPrivateFieldSet(this,W,document.querySelector('[name="FLOW_ID"]'));babelHelpers.classPrivateFieldSet(this,_,document.querySelector('[name="FLOW_ID_text"]'));a.Event.bind(babelHelpers.classPrivateFieldGet(this,W),"change",y(this,ee,Ie).bind(this));a.Event.bind(babelHelpers.classPrivateFieldGet(this,_),"blur",y(this,ee,Ie).bind(this));y(this,ee,Ie).call(this)}}babelHelpers.createClass(e,[{key:"render",value:function e(){this.watchAllowTimeTracking();this.renderGroupId();this.renderTags();this.renderDependsOn();y(this,B,ve).call(this)}},{key:"watchAllowTimeTracking",value:function e(){var t=babelHelpers.classPrivateFieldGet(this,P).ALLOW_TIME_TRACKING[1];var a=[babelHelpers.classPrivateFieldGet(this,P).TIME_ESTIMATE_H,babelHelpers.classPrivateFieldGet(this,P).TIME_ESTIMATE_M];var r=a.map((function(e){return e.parentElement.parentElement}));if(t){var i=function e(){if(t.checked){r.forEach((function(e){e.style.display=""}))}else{r.forEach((function(e){e.style.display="none"}))}};i();t.onchange=i}}},{key:"renderGroupId",value:function e(){var a=this;var r=document.getElementById("bizproc-task2activity-group-id");if(r){var i=t.SelectorManager.getSelectorByTarget(r);if(i){i.subscribe("Field:Selected",(function(e){if(y(a,j,ue).call(a).isLocked()){return}var t=e.getData(),r=t.field;babelHelpers.classPrivateFieldSet(a,F,r.Expression);y(a,j,ue).call(a).addTag({id:r.Expression,title:r.Expression,entityId:"project"});y(a,U,pe).call(a)}))}y(this,j,ue).call(this).renderTo(r)}}},{key:"renderTags",value:function e(){var a=this;var r=document.getElementById("bizproc-task2activity-tags");if(r){var i=t.SelectorManager.getSelectorByTarget(r);if(i){i.subscribe("Field:Selected",(function(e){var t=e.getData(),r=t.field;y(a,q,ye).call(a).addTag({id:r.Expression,title:r.Expression,entityId:"task-tag",customData:{type:w.EXPRESSION}})}))}y(this,q,ye).call(this).renderTo(r)}}},{key:"renderDependsOn",value:function e(){var a=this;var r=document.getElementById("bizproc-task2activity-depends-on");if(r){var i=t.SelectorManager.getSelectorByTarget(r);if(i){i.subscribe("Field:Selected",(function(e){var t=e.getData(),r=t.field;y(a,J,Ge).call(a).addTag({id:r.Expression,title:r.Expression,entityId:"task"})}))}y(this,J,Ge).call(this).renderTo(r)}}}]);return e}();function de(e){var a=[];var r=[];var i=v(e),l;try{for(i.s();!(l=i.n()).done;){var n,s,o;var c=l.value;var d=(n=document.getElementById("id_".concat(c)))!==null&&n!==void 0?n:document.querySelector('[name="'.concat(c,'"]:not([type="hidden"])'));if(!d){continue}var u=(s=t.SelectorManager.getSelectorByTarget(d))===null||s===void 0?void 0:(o=s.userSelector)===null||o===void 0?void 0:o.tagSelector;if(u){u.setTagMaxWidth(240);a.push(u)}else{var h;r.push((h=u===null||u===void 0?void 0:u.target)!==null&&h!==void 0?h:d)}}}catch(e){i.e(e)}finally{i.f()}babelHelpers.classPrivateFieldSet(this,M,a);babelHelpers.classPrivateFieldSet(this,A,r)}function ue(){if(a.Type.isNil(babelHelpers.classPrivateFieldGet(this,H))){var e=this;babelHelpers.classPrivateFieldSet(this,H,new i.TagSelector({multiple:false,events:{onTagAdd:function t(r){var i=r.getData(),l=i.tag;a.Dom.clean(babelHelpers.classPrivateFieldGet(e,P).GROUP_ID);babelHelpers.classPrivateFieldSet(e,F,l.id);babelHelpers.classPrivateFieldGet(e,P).GROUP_ID.append(new Option(l.getTitle(),l.getId(),true,true));y(e,U,pe).call(e)},onTagRemove:function t(){a.Dom.clean(babelHelpers.classPrivateFieldGet(e,P).GROUP_ID);babelHelpers.classPrivateFieldSet(e,F,undefined);y(e,U,pe).call(e)}},dialogOptions:{preselectedItems:a.Type.isNumber(babelHelpers.classPrivateFieldGet(this,F))?[["project",babelHelpers.classPrivateFieldGet(this,F)]]:undefined,entities:[{id:"project"}],preload:true}}));if(a.Type.isString(babelHelpers.classPrivateFieldGet(this,F))){babelHelpers.classPrivateFieldGet(this,H).addTag({id:babelHelpers.classPrivateFieldGet(this,F),entityId:"project",title:babelHelpers.classPrivateFieldGet(this,F)})}babelHelpers.classPrivateFieldGet(this,H).setTagMaxWidth(240)}return babelHelpers.classPrivateFieldGet(this,H)}function ve(){var e=this;var a=document.getElementById("bizproc-task2activity-flow-id");if(a){var r=t.SelectorManager.getSelectorByTarget(a);if(r){r.subscribe("Field:Selected",(function(t){var a=t.getData(),r=a.field;babelHelpers.classPrivateFieldSet(e,S,r.Expression);y(e,C,he).call(e).addTag({id:r.Expression,title:r.Expression,entityId:"flow"})}))}y(this,C,he).call(this).renderTo(a)}}function he(){var e=this;if(a.Type.isNil(babelHelpers.classPrivateFieldGet(this,T))){babelHelpers.classPrivateFieldSet(this,T,new i.TagSelector({multiple:false,events:{onTagAdd:function t(r){var i=r.getData(),l=i.tag;a.Dom.clean(babelHelpers.classPrivateFieldGet(e,P).FLOW_ID);babelHelpers.classPrivateFieldGet(e,P).FLOW_ID.append(new Option(l.getTitle(),l.getId(),true,true));y(e,ne,_e).call(e,y(e,oe,Ae).call(e,r.target.getDialog(),l));y(e,re,Oe).call(e)},onTagRemove:function t(){a.Dom.clean(babelHelpers.classPrivateFieldGet(e,P).FLOW_ID);babelHelpers.classPrivateFieldSet(e,S,undefined);y(e,ie,xe).call(e)}},dialogOptions:{preselectedItems:a.Type.isNumber(babelHelpers.classPrivateFieldGet(this,S))?[["flow",babelHelpers.classPrivateFieldGet(this,S)]]:undefined,entities:[{id:"flow",options:{onlyActive:true}}],preload:true}}));if(a.Type.isStringFilled(babelHelpers.classPrivateFieldGet(this,S))){babelHelpers.classPrivateFieldGet(this,T).addTag({id:babelHelpers.classPrivateFieldGet(this,S),entityId:"flow",title:babelHelpers.classPrivateFieldGet(this,S)})}}return babelHelpers.classPrivateFieldGet(this,T)}function pe(){return fe.apply(this,arguments)}function fe(){fe=babelHelpers.asyncToGenerator(u().mark((function e(){return u().wrap((function e(t){while(1)switch(t.prev=t.next){case 0:t.next=2;return y(this,X,be).call(this);case 2:if(a.Type.isNil(babelHelpers.classPrivateFieldGet(this,I))){t.next=8;break}t.next=5;return new Promise((function(e,t){return setTimeout(400,e)}));case 5:babelHelpers.classPrivateFieldGet(this,I).getDialog().destroy();a.Dom.remove(babelHelpers.classPrivateFieldGet(this,I).getOuterContainer());babelHelpers.classPrivateFieldSet(this,I,null);case 8:babelHelpers.classPrivateFieldGet(this,P).querySelectorAll('input[name="TAG_NAMES[]"]').forEach((function(e){return a.Dom.remove(e)}));this.renderTags();case 10:case"end":return t.stop()}}),e,this)})));return fe.apply(this,arguments)}function be(){return ge.apply(this,arguments)}function ge(){ge=babelHelpers.asyncToGenerator(u().mark((function e(){return u().wrap((function e(t){while(1)switch(t.prev=t.next){case 0:if(!babelHelpers.classPrivateFieldGet(this,I).getDialog().isLoading()){t.next=3;break}t.next=3;return y(this,K,Fe).call(this);case 3:case"end":return t.stop()}}),e,this)})));return ge.apply(this,arguments)}function ye(){if(a.Type.isNil(babelHelpers.classPrivateFieldGet(this,I))){var e=this;var t=a.Type.isString(babelHelpers.classPrivateFieldGet(this,F))?undefined:babelHelpers.classPrivateFieldGet(this,F);babelHelpers.classPrivateFieldSet(this,I,new i.TagSelector({multiple:true,events:{onTagAdd:function t(a){var r;var i=a.getData(),l=i.tag;var n=(r=l.getCustomData().get("type"))!==null&&r!==void 0?r:w.SIMPLE;y(e,Y,Se).call(e,n,l.getId(),l.getTitle())},onTagRemove:function t(a){var r=a.getData(),i=r.tag;y(e,$,Te).call(e,i.getId())}},dialogOptions:{width:400,height:300,dropdownMode:true,enableSearch:true,compactView:true,searchOptions:{allowCreateItem:false},footer:l.Footer,footerOptions:{groupId:t},offsetTop:12,entities:[{id:"task-tag",options:{groupId:t}}]}}));y(this,z,me).call(this)}return babelHelpers.classPrivateFieldGet(this,I)}function me(){var e=this;y(this,V,we).call(this).then((function(t){var a=t.newTags,r=t.newSelectedTags;var i=babelHelpers.classPrivateFieldGet(e,E);babelHelpers.classPrivateFieldSet(e,E,new Set);var l=v(r.entries()),n;try{for(l.s();!(n=l.n()).done;){var s=babelHelpers.slicedToArray(n.value,2),o=s[0],c=s[1];babelHelpers.classPrivateFieldGet(e,I).addTag({id:o,title:c,entityId:"task-tag",customData:{type:w.SIMPLE}})}}catch(e){l.e(e)}finally{l.f()}var d=v(a.values()),u;try{for(d.s();!(u=d.n()).done;){var h=u.value;babelHelpers.classPrivateFieldGet(e,I).addTag({id:String(Math.random()),title:h,entityId:"task-tag",customData:{type:w.NEW}})}}catch(e){d.e(e)}finally{d.f()}var p=v(i.values()),f;try{for(p.s();!(f=p.n()).done;){var b=f.value;babelHelpers.classPrivateFieldGet(e,I).addTag({id:b,title:b,entityId:"task-tag",customData:{type:w.EXPRESSION}})}}catch(e){p.e(e)}finally{p.f()}}))}function we(){return Pe.apply(this,arguments)}function Pe(){Pe=babelHelpers.asyncToGenerator(u().mark((function e(){var t,a,r,i,l,n,s,o,c,d,h,p,f,b,g;return u().wrap((function e(u){while(1)switch(u.prev=u.next){case 0:u.next=2;return y(this,K,Fe).call(this);case 2:t=new Set;a=new Map;r=v(babelHelpers.classPrivateFieldGet(this,I).getDialog().getItems());try{for(r.s();!(i=r.n()).done;){l=i.value;t.add(l.getId());a.set(l.getTitle(),l.getId())}}catch(e){r.e(e)}finally{r.f()}n=new Map;s=new Set;o=v(babelHelpers.classPrivateFieldGet(this,G).entries());try{for(o.s();!(c=o.n()).done;){d=babelHelpers.slicedToArray(c.value,2),h=d[0],p=d[1];if(t.has(h)){n.set(h,p)}else{s.add(p)}}}catch(e){o.e(e)}finally{o.f()}f=v(babelHelpers.classPrivateFieldGet(this,k).values());try{for(f.s();!(b=f.n()).done;){g=b.value;if(a.has(g)){n.set(a.get(g),g)}else{s.add(g)}}}catch(e){f.e(e)}finally{f.f()}return u.abrupt("return",{newSelectedTags:n,newTags:s});case 13:case"end":return u.stop()}}),e,this)})));return Pe.apply(this,arguments)}function Fe(){return He.apply(this,arguments)}function He(){He=babelHelpers.asyncToGenerator(u().mark((function e(){var t;return u().wrap((function e(a){while(1)switch(a.prev=a.next){case 0:t=babelHelpers.classPrivateFieldGet(this,I).getDialog();if(t.isLoaded()){a.next=4;break}a.next=4;return new Promise((function(e,a){var r=function a(){t.unsubscribe("onLoadError",i);e()};var i=function e(){t.unsubscribe("onLoad",r);a()};t.subscribeOnce("onLoad",r);t.subscribeOnce("onLoadError",i);t.load()}));case 4:case"end":return a.stop()}}),e,this)})));return He.apply(this,arguments)}function Se(e,t,r){switch(e){case w.SIMPLE:{babelHelpers.classPrivateFieldGet(this,G).set(t,r);break}case w.EXPRESSION:{babelHelpers.classPrivateFieldGet(this,E).add(r);break}case w.NEW:{babelHelpers.classPrivateFieldGet(this,k).add(r);break}default:{return}}a.Dom.append(a.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['<input name="TAG_NAMES[]" value="','" hidden/>'])),a.Text.encode(r)),babelHelpers.classPrivateFieldGet(this,P))}function Te(e){var t=null;if(babelHelpers.classPrivateFieldGet(this,E).has(e)){t=e;babelHelpers.classPrivateFieldGet(this,E)["delete"](e)}else if(babelHelpers.classPrivateFieldGet(this,G).has(e)){t=babelHelpers.classPrivateFieldGet(this,G).get(e);babelHelpers.classPrivateFieldGet(this,G)["delete"](e)}else if(babelHelpers.classPrivateFieldGet(this,k).has(e)){t=e;babelHelpers.classPrivateFieldGet(this,k)["delete"](e)}var r=babelHelpers.classPrivateFieldGet(this,P).querySelector('input[name="TAG_NAMES[]"][value="'.concat(a.Text.encode(t),'"]'));if(r){a.Dom.remove(r)}}function Ge(){if(a.Type.isNil(babelHelpers.classPrivateFieldGet(this,L))){var e=this;babelHelpers.classPrivateFieldSet(this,L,new i.TagSelector({multiple:true,events:{onTagAdd:function t(a){var r=a.getData(),i=r.tag;y(e,Q,Ee).call(e,i.getId())},onTagRemove:function t(a){var r=a.getData(),i=r.tag;y(e,Z,ke).call(e,i.getId())}},dialogOptions:{width:400,height:300,dropdownMode:true,compactView:true,enableSearch:true,searchOptions:{allowCreateItem:false},offsetTop:12,entities:[{id:"task"}],preselectedItems:babelHelpers.toConsumableArray(babelHelpers.classPrivateFieldGet(this,D)).filter((function(e){return a.Type.isNumber(e)})).map((function(e){return["task",e]}))}}));var t=v(babelHelpers.classPrivateFieldGet(this,D).values()),r;try{for(t.s();!(r=t.n()).done;){var l=r.value;if(a.Type.isString(l)){babelHelpers.classPrivateFieldGet(this,L).addTag({id:l,title:l,entityId:"task"})}}}catch(e){t.e(e)}finally{t.f()}}return babelHelpers.classPrivateFieldGet(this,L)}function Ee(e){babelHelpers.classPrivateFieldGet(this,D).add(e);a.Dom.append(a.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(['<input name="DEPENDS_ON[]" value="','" hidden/>'])),a.Text.encode(e)),babelHelpers.classPrivateFieldGet(this,P))}function ke(e){babelHelpers.classPrivateFieldGet(this,D)["delete"](e);var t=babelHelpers.classPrivateFieldGet(this,P).querySelector('input[name="DEPENDS_ON[]"][value="'.concat(a.Text.encode(e),'"]'));if(t){a.Dom.remove(t)}}function Ie(){if(!babelHelpers.classPrivateFieldGet(this,W).value&&!babelHelpers.classPrivateFieldGet(this,_).value){y(this,ae,De).call(this)}else{y(this,te,Le).call(this)}}function Le(){var e=[];var t=v(babelHelpers.classPrivateFieldGet(this,O).entries()),r;try{for(t.s();!(r=t.n()).done;){var i=babelHelpers.slicedToArray(r.value,2),l=i[0],n=i[1];n.hidden=true;if(babelHelpers.classPrivateFieldGet(this,x)[l]){babelHelpers.classPrivateFieldGet(this,x)[l].hidden=false}else{var s=a.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['<td class="adm-detail-content-cell-r">',"</td>"])),a.Loc.getMessage("TASKS_BP_FLOW_CONTROLLED_VALUE"));a.Dom.append(s,n.parentNode);e[l]=s}}}catch(e){t.e(e)}finally{t.f()}if(!a.Type.isArrayFilled(babelHelpers.classPrivateFieldGet(this,x))){babelHelpers.classPrivateFieldSet(this,x,e)}}function De(){var e=v(babelHelpers.classPrivateFieldGet(this,O).entries()),t;try{for(e.s();!(t=e.n()).done;){var a=babelHelpers.slicedToArray(t.value,2),r=a[0],i=a[1];i.hidden=false;if(babelHelpers.classPrivateFieldGet(this,x)[r]){babelHelpers.classPrivateFieldGet(this,x)[r].hidden=true}}}catch(t){e.e(t)}finally{e.f()}}function Oe(){y(this,j,ue).call(this).lock();var e=v(babelHelpers.classPrivateFieldGet(this,M)),t;try{for(e.s();!(t=e.n()).done;){var r=t.value;r.lock()}}catch(t){e.e(t)}finally{e.f()}var i=v(babelHelpers.classPrivateFieldGet(this,A).entries()),l;try{for(i.s();!(l=i.n()).done;){var n=babelHelpers.slicedToArray(l.value,2),s=n[0],o=n[1];o.disabled=true;var c=o.cloneNode(true);c.value=a.Loc.getMessage("TASKS_BP_RPD_FLOW_CONTROLLED_SHORT_VALUE");a.Dom.replace(o,c);babelHelpers.classPrivateFieldGet(this,N)[s]=c}}catch(e){i.e(e)}finally{i.f()}}function xe(){y(this,le,We).call(this,y(this,j,ue).call(this));var e=v(babelHelpers.classPrivateFieldGet(this,M)),t;try{for(e.s();!(t=e.n()).done;){var r=t.value;y(this,le,We).call(this,r)}}catch(t){e.e(t)}finally{e.f()}var i=v(babelHelpers.classPrivateFieldGet(this,A).entries()),l;try{for(i.s();!(l=i.n()).done;){var n=babelHelpers.slicedToArray(l.value,2),s=n[0],o=n[1];o.disabled=false;if(babelHelpers.classPrivateFieldGet(this,N)[s]){var c=babelHelpers.classPrivateFieldGet(this,N)[s];a.Dom.replace(c,o)}}}catch(e){i.e(e)}finally{i.f()}}function We(e){e.removeTags();e.unlock()}function _e(e){var t,r;y(this,j,ue).call(this).addTag({id:(t=e===null||e===void 0?void 0:e.id)!==null&&t!==void 0?t:a.Text.getRandom(),title:(r=e===null||e===void 0?void 0:e.getTitleNode().text)!==null&&r!==void 0?r:a.Loc.getMessage("TASKS_BP_RPD_FLOW_CONTROLLED_VALUE"),entityId:"project",avatar:e===null||e===void 0?void 0:e.getAvatar()});var i=v(babelHelpers.classPrivateFieldGet(this,M)),l;try{for(i.s();!(l=i.n()).done;){var n=l.value;n.addTag({id:a.Text.getRandom(),title:a.Loc.getMessage("TASKS_BP_RPD_FLOW_CONTROLLED_VALUE"),entityId:"employee"})}}catch(e){i.e(e)}finally{i.f()}var s=v(babelHelpers.classPrivateFieldGet(this,A)),o;try{for(s.s();!(o=s.n()).done;){var c=o.value;y(this,se,Me).call(this,c)}}catch(e){s.e(e)}finally{s.f()}}function Me(e){if(e.type==="checkbox"){e.checked=false}else{e.value=""}}function Ae(e,t){var a,r,i,l,n,s;var o=e===null||e===void 0?void 0:(a=e.items)===null||a===void 0?void 0:(r=a.get("flow"))===null||r===void 0?void 0:(i=r.get(String(t.id)))===null||i===void 0?void 0:(l=i.customData)===null||l===void 0?void 0:l.get("groupId");return(n=y(this,j,ue).call(this).getDialog().items)===null||n===void 0?void 0:(s=n.get("project"))===null||s===void 0?void 0:s.get(String(o))}m.Task2Activity=ce})(this.window=this.window||{},BX.Bizproc.Automation,BX,BX.Event,BX.UI.EntitySelector,BX.Tasks.EntitySelector);
//# sourceMappingURL=script.map.js