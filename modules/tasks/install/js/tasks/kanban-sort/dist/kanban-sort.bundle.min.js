this.BX=this.BX||{};(function(e,t,a){"use strict";var s=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(s,"ASC","asc");babelHelpers.defineProperty(s,"DESC","desc");function i(e,t,a){l(e,t);t.set(e,a)}function l(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var r=new WeakMap;var n=new WeakMap;var o=function(){function e(t){babelHelpers.classCallCheck(this,e);i(this,r,{writable:true,value:void 0});i(this,n,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,n,t);babelHelpers.classPrivateFieldSet(this,r,babelHelpers.classPrivateFieldGet(this,n).getMenuWindow())}babelHelpers.createClass(e,[{key:"select",value:function a(s){t.Dom.removeClass(s.layout.item,e.DESELECTED);t.Dom.addClass(s.layout.item,e.SELECTED)}},{key:"deselect",value:function a(s){t.Dom.removeClass(s.layout.item,e.SELECTED);t.Dom.addClass(s.layout.item,e.DESELECTED)}},{key:"deselectAll",value:function e(){var t=this;this.getItems().forEach((function(e){t.deselect(e)}))}},{key:"deselectSubItems",value:function e(){var t=this;this.getSubItems().forEach((function(e){t.deselect(e)}))}},{key:"isCustomSortEnabled",value:function e(){var t=this.getItems();var a=t.find((function(e){var t,a;return((t=e.params)===null||t===void 0?void 0:t.type)==="sub"&&((a=e.params)===null||a===void 0?void 0:a.order)===s.ASC}));var i=t.find((function(e){var t,a;return((t=e.params)===null||t===void 0?void 0:t.type)==="sub"&&((a=e.params)===null||a===void 0?void 0:a.order)===s.DESC}));return Boolean(a)&&Boolean(i)}},{key:"addItemsFromItemParams",value:function e(t){var a=this;babelHelpers.classPrivateFieldGet(this,n).params.forEach((function(e){var s;e.params=BX.parseJSON(e.params);if((s=e.params)!==null&&s!==void 0&&s.order){e.onclick=t}babelHelpers.classPrivateFieldGet(a,r).addMenuItem(e)}))}},{key:"removeSubItems",value:function e(){var t=this;this.getSubItems().forEach((function(e){babelHelpers.classPrivateFieldGet(t,r).removeMenuItem(e.getId())}))}},{key:"getSubItems",value:function e(){return this.getItems().filter((function(e){var t;return((t=e.params)===null||t===void 0?void 0:t.type)==="sub"}))}},{key:"getItems",value:function e(){return babelHelpers.classPrivateFieldGet(this,r).getMenuItems()}},{key:"find",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";return this.getItems().find((function(e){var a;return((a=e.params)===null||a===void 0?void 0:a.order)===t}))}}]);return e}();babelHelpers.defineProperty(o,"SELECTED","menu-popup-item-accept");babelHelpers.defineProperty(o,"DESELECTED","menu-popup-item-none");function u(e,t,a){c(e,t);t.set(e,a)}function c(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var d=new WeakMap;var b=new WeakMap;var v=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);u(this,d,{writable:true,value:void 0});u(this,b,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,d,t===null||t===void 0?void 0:t.ajaxComponentPath);babelHelpers.classPrivateFieldSet(this,b,t===null||t===void 0?void 0:t.ajaxComponentParams)}babelHelpers.createClass(e,[{key:"getPath",value:function e(){return babelHelpers.classPrivateFieldGet(this,d)}},{key:"getParams",value:function e(){return babelHelpers.classPrivateFieldGet(this,b)}}]);return e}();function h(e,t){m(e,t);t.add(e)}function p(e,t,a){m(e,t);t.set(e,a)}function m(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function f(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var C=new WeakMap;var H=new WeakSet;var P=function(){function e(){babelHelpers.classCallCheck(this,e);h(this,H);p(this,C,{writable:true,value:void 0});f(this,H,S).call(this)}babelHelpers.createClass(e,[{key:"setOrder",value:function e(){var t=this;var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";BX.ajax.runComponentAction("bitrix:tasks.kanban","setNewTaskOrder",{mode:"class",data:{order:a,params:babelHelpers.classPrivateFieldGet(this,C).getParams()}}).then((function(e){var a=e.data;BX.onCustomEvent(t,"onTaskSortChanged",[a])}))}}]);return e}();function S(){babelHelpers.classPrivateFieldSet(this,C,BX.Tasks.KanbanAjaxComponent.Parameters)}function w(e,t){E(e,t);t.add(e)}function k(e,t,a){E(e,t);t.set(e,a)}function E(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function F(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var y=new WeakMap;var G=new WeakMap;var g=new WeakSet;var I=new WeakSet;var T=function(){function e(){babelHelpers.classCallCheck(this,e);w(this,I);w(this,g);k(this,y,{writable:true,value:void 0});k(this,G,{writable:true,value:void 0});F(this,g,D).call(this)}babelHelpers.createClass(e,[{key:"enableCustomSort",value:function e(t,a){babelHelpers.classPrivateFieldSet(this,G,new P);babelHelpers.classPrivateFieldSet(this,y,new o(a));if(babelHelpers.classPrivateFieldGet(this,y).isCustomSortEnabled()){return}babelHelpers.classPrivateFieldGet(this,y).addItemsFromItemParams(this.selectCustomOrder.bind(this));babelHelpers.classPrivateFieldGet(this,y).deselectAll();babelHelpers.classPrivateFieldGet(this,y).select(a);var i=babelHelpers.classPrivateFieldGet(this,y).find(s.DESC);babelHelpers.classPrivateFieldGet(this,y).select(i);F(this,I,B).call(this,i)}},{key:"disableCustomSort",value:function e(t,a){babelHelpers.classPrivateFieldSet(this,G,new P);babelHelpers.classPrivateFieldSet(this,y,new o(a));if(!babelHelpers.classPrivateFieldGet(this,y).isCustomSortEnabled()){return}babelHelpers.classPrivateFieldGet(this,y).removeSubItems();babelHelpers.classPrivateFieldGet(this,y).deselectAll();babelHelpers.classPrivateFieldGet(this,y).select(a);F(this,I,B).call(this,a)}},{key:"selectCustomOrder",value:function e(t,a){babelHelpers.classPrivateFieldSet(this,G,new P);babelHelpers.classPrivateFieldSet(this,y,new o(a));if(!babelHelpers.classPrivateFieldGet(this,y).isCustomSortEnabled()){return}babelHelpers.classPrivateFieldGet(this,y).deselectSubItems();babelHelpers.classPrivateFieldGet(this,y).select(a);F(this,I,B).call(this,a)}}],[{key:"getInstance",value:function e(){return new this}}]);return e}();function D(){this.enableCustomSort=this.enableCustomSort.bind(this);this.disableCustomSort=this.disableCustomSort.bind(this);this.selectCustomOrder=this.selectCustomOrder.bind(this)}function B(e){var t;var a=(e===null||e===void 0?void 0:(t=e.params)===null||t===void 0?void 0:t.order)||"";babelHelpers.classPrivateFieldGet(this,G).setOrder(a)}e.KanbanSort=T;e.KanbanAjaxComponent=v})(this.BX.Tasks=this.BX.Tasks||{},BX,BX.Main);
//# sourceMappingURL=kanban-sort.bundle.map.js