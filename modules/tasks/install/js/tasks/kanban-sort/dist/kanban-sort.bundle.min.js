this.BX=this.BX||{};(function(e,t,a){"use strict";var s=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(s,"ASC","asc");babelHelpers.defineProperty(s,"DESC","desc");function i(e,t,a){l(e,t);t.set(e,a)}function l(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var r=new WeakMap;var n=new WeakMap;var o=function(){function e(t){babelHelpers.classCallCheck(this,e);i(this,r,{writable:true,value:void 0});i(this,n,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,n,t);babelHelpers.classPrivateFieldSet(this,r,babelHelpers.classPrivateFieldGet(this,n).getMenuWindow())}babelHelpers.createClass(e,[{key:"select",value:function t(s){a.Dom.removeClass(s.layout.item,e.DESELECTED);a.Dom.addClass(s.layout.item,e.SELECTED)}},{key:"deselect",value:function t(s){a.Dom.removeClass(s.layout.item,e.SELECTED);a.Dom.addClass(s.layout.item,e.DESELECTED)}},{key:"deselectAll",value:function e(){var t=this;this.getItems().forEach((function(e){t.deselect(e)}))}},{key:"deselectSubItems",value:function e(){var t=this;this.getSubItems().forEach((function(e){t.deselect(e)}))}},{key:"isCustomSortEnabled",value:function e(){var t=this.getItems();var a=t.find((function(e){var t,a;return((t=e.params)===null||t===void 0?void 0:t.type)==="sub"&&((a=e.params)===null||a===void 0?void 0:a.order)===s.ASC}));var i=t.find((function(e){var t,a;return((t=e.params)===null||t===void 0?void 0:t.type)==="sub"&&((a=e.params)===null||a===void 0?void 0:a.order)===s.DESC}));return Boolean(a)&&Boolean(i)}},{key:"addItemsFromItemParams",value:function e(t){var a=this;babelHelpers.classPrivateFieldGet(this,n).params.forEach((function(e){var s;e.params=BX.parseJSON(e.params);if((s=e.params)!==null&&s!==void 0&&s.order){e.onclick=t}babelHelpers.classPrivateFieldGet(a,r).addMenuItem(e)}))}},{key:"removeSubItems",value:function e(){var t=this;this.getSubItems().forEach((function(e){babelHelpers.classPrivateFieldGet(t,r).removeMenuItem(e.getId())}))}},{key:"getSubItems",value:function e(){return this.getItems().filter((function(e){var t;return((t=e.params)===null||t===void 0?void 0:t.type)==="sub"}))}},{key:"getItems",value:function e(){return babelHelpers.classPrivateFieldGet(this,r).getMenuItems()}},{key:"find",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";return this.getItems().find((function(e){var a;return((a=e.params)===null||a===void 0?void 0:a.order)===t}))}}]);return e}();babelHelpers.defineProperty(o,"SELECTED","menu-popup-item-accept");babelHelpers.defineProperty(o,"DESELECTED","menu-popup-item-none");function u(e,t,a){c(e,t);t.set(e,a)}function c(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var d=new WeakMap;var v=new WeakMap;var b=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);u(this,d,{writable:true,value:void 0});u(this,v,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,d,t===null||t===void 0?void 0:t.ajaxComponentPath);babelHelpers.classPrivateFieldSet(this,v,t===null||t===void 0?void 0:t.ajaxComponentParams)}babelHelpers.createClass(e,[{key:"getPath",value:function e(){return babelHelpers.classPrivateFieldGet(this,d)}},{key:"getParams",value:function e(){return babelHelpers.classPrivateFieldGet(this,v)}}]);return e}();function h(e,t){f(e,t);t.add(e)}function p(e,t,a){f(e,t);t.set(e,a)}function f(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function m(e,t,a){P(e,t);C(a,"get");return w(e,a)}function C(e,t){if(e===undefined){throw new TypeError("attempted to "+t+" private static field before its declaration")}}function P(e,t){if(e!==t){throw new TypeError("Private static access of wrong provenance")}}function w(e,t){if(t.get){return t.get.call(e)}return t.value}function H(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var S=new WeakMap;var E=new WeakSet;var k=function(){function e(){babelHelpers.classCallCheck(this,e);h(this,E);p(this,S,{writable:true,value:void 0});H(this,E,y).call(this)}babelHelpers.createClass(e,[{key:"setOrder",value:function t(){var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";a.ajax({method:"POST",dataType:"json",url:babelHelpers.classPrivateFieldGet(this,S).getPath(),data:{action:m(e,e,F),order:s,params:babelHelpers.classPrivateFieldGet(this,S).getParams(),sessid:BX.bitrix_sessid()},onsuccess:function e(t){BX.onCustomEvent(this,"onTaskSortChanged",[t])}})}}]);return e}();function y(){babelHelpers.classPrivateFieldSet(this,S,BX.Tasks.KanbanAjaxComponent.Parameters)}var F={writable:true,value:"setNewTaskOrder"};function g(e,t){I(e,t);t.add(e)}function G(e,t,a){I(e,t);t.set(e,a)}function I(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function T(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var D=new WeakMap;var B=new WeakMap;var M=new WeakSet;var W=new WeakSet;var j=function(){function e(){babelHelpers.classCallCheck(this,e);g(this,W);g(this,M);G(this,D,{writable:true,value:void 0});G(this,B,{writable:true,value:void 0});T(this,M,X).call(this)}babelHelpers.createClass(e,[{key:"enableCustomSort",value:function e(t,a){babelHelpers.classPrivateFieldSet(this,B,new k);babelHelpers.classPrivateFieldSet(this,D,new o(a));if(babelHelpers.classPrivateFieldGet(this,D).isCustomSortEnabled()){return}babelHelpers.classPrivateFieldGet(this,D).addItemsFromItemParams(this.selectCustomOrder.bind(this));babelHelpers.classPrivateFieldGet(this,D).deselectAll();babelHelpers.classPrivateFieldGet(this,D).select(a);var i=babelHelpers.classPrivateFieldGet(this,D).find(s.DESC);babelHelpers.classPrivateFieldGet(this,D).select(i);T(this,W,O).call(this,i)}},{key:"disableCustomSort",value:function e(t,a){babelHelpers.classPrivateFieldSet(this,B,new k);babelHelpers.classPrivateFieldSet(this,D,new o(a));if(!babelHelpers.classPrivateFieldGet(this,D).isCustomSortEnabled()){return}babelHelpers.classPrivateFieldGet(this,D).removeSubItems();babelHelpers.classPrivateFieldGet(this,D).deselectAll();babelHelpers.classPrivateFieldGet(this,D).select(a);T(this,W,O).call(this,a)}},{key:"selectCustomOrder",value:function e(t,a){babelHelpers.classPrivateFieldSet(this,B,new k);babelHelpers.classPrivateFieldSet(this,D,new o(a));if(!babelHelpers.classPrivateFieldGet(this,D).isCustomSortEnabled()){return}babelHelpers.classPrivateFieldGet(this,D).deselectSubItems();babelHelpers.classPrivateFieldGet(this,D).select(a);T(this,W,O).call(this,a)}}],[{key:"getInstance",value:function e(){return new this}}]);return e}();function X(){this.enableCustomSort=this.enableCustomSort.bind(this);this.disableCustomSort=this.disableCustomSort.bind(this);this.selectCustomOrder=this.selectCustomOrder.bind(this)}function O(e){var t;var a=(e===null||e===void 0?void 0:(t=e.params)===null||t===void 0?void 0:t.order)||"";babelHelpers.classPrivateFieldGet(this,B).setOrder(a)}e.KanbanSort=j;e.KanbanAjaxComponent=b})(this.BX.Tasks=this.BX.Tasks||{},BX.Main,BX);
//# sourceMappingURL=kanban-sort.bundle.map.js