{"version":3,"file":"epic.bundle.js","sources":["../src/request.sender.js","../src/epic.js"],"sourcesContent":["import {Loc, Type, ajax} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.error(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TSE_ERROR_POPUP_TITLE'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {ajax, Dom, Event, Loc, Runtime, Tag, Text, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Layout} from 'ui.sidepanel.layout';\nimport {Label} from 'ui.label';\nimport {UI} from 'ui.notification';\n\nimport {RequestSender} from './request.sender';\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport '../css/base.css';\n\ntype Params = {\n\tview: 'list' | 'add' | 'view' | 'edit',\n\tgroupId: number,\n\tepicId?: number,\n\tgridId?: string\n}\n\ntype ResponseAfter = {\n\tdata: EpicType\n}\n\ntype EpicType = {\n\tid: number,\n\tgroupId: number,\n\tname: string,\n\tdescription: string,\n\tcreatedBy: number,\n\tmodifiedBy: number,\n\tcolor: string\n}\n\nexport class Epic extends EventEmitter\n{\n\tconstructor(params: Params = {})\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Epic');\n\n\t\tthis.view = Type.isString(params.view) ? params.view : '';\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.epicId = Type.isUndefined(params.epicId) ? 0 : parseInt(params.epicId, 10);\n\t\tthis.gridId = Type.isUndefined(params.gridId) ? '' : params.gridId;\n\n\t\tthis.pathToTask = Type.isString(params.pathToTask) ? params.pathToTask : '';\n\n\t\tthis.requestSender = new RequestSender();\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\t\tthis.sidePanel = null;\n\n\t\tthis.id = null;\n\n\t\tthis.form = null;\n\t\tthis.formData = null;\n\n\t\tthis.listData = null;\n\n\t\tthis.editorHandler = null;\n\n\t\tthis.colorPickers = new Map();\n\t\tthis.defaultColor = '#69dafc';\n\t\tthis.selectedColor = '';\n\t}\n\n\tshow()\n\t{\n\t\tswitch(this.view)\n\t\t{\n\t\t\tcase 'add':\n\t\t\t\tthis.showAddForm();\n\t\t\t\tbreak;\n\t\t\tcase 'list':\n\t\t\t\tthis.showList();\n\t\t\t\tbreak;\n\t\t\tcase 'view':\n\t\t\t\tthis.showViewForm();\n\t\t\t\tbreak;\n\t\t\tcase 'edit':\n\t\t\t\tthis.showEditForm();\n\t\t\t\tbreak;\n\t\t\tcase 'tasks':\n\t\t\t\tthis.showTasksList();\n\t\t\t\tbreak;\n\t\t\tcase 'completedTasks':\n\t\t\t\tthis.showTasksList(true);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tstatic showView(groupId: number, epicId: number)\n\t{\n\t\tconst epic = new Epic({\n\t\t\tview: 'view',\n\t\t\tgroupId: groupId,\n\t\t\tepicId: epicId\n\t\t});\n\n\t\tepic.show();\n\t}\n\n\tstatic showEdit(groupId: number, epicId: number)\n\t{\n\t\tconst epic = new Epic({\n\t\t\tview: 'edit',\n\t\t\tgroupId: groupId,\n\t\t\tepicId: epicId\n\t\t});\n\n\t\tepic.show();\n\t}\n\n\tstatic removeEpic(groupId: number, epicId: number, gridId?: string)\n\t{\n\t\tconst epic = new Epic({\n\t\t\tview: 'edit',\n\t\t\tgroupId: groupId,\n\t\t\tgridId: gridId,\n\t\t\tepicId: epicId\n\t\t});\n\n\t\tepic.removeEpic()\n\t\t\t.then(() => {\n\t\t\t\tepic.reloadGrid();\n\t\t\t})\n\t\t;\n\t}\n\n\tstatic showTasks(groupId: number, epicId: number)\n\t{\n\t\tconst epic = new Epic({\n\t\t\tview: 'tasks',\n\t\t\tgroupId: groupId,\n\t\t\tepicId: epicId\n\t\t});\n\n\t\tepic.show();\n\t}\n\n\tstatic showCompletedTasks(groupId: number, epicId: number)\n\t{\n\t\tconst epic = new Epic({\n\t\t\tview: 'completedTasks',\n\t\t\tgroupId: groupId,\n\t\t\tepicId: epicId\n\t\t});\n\n\t\tepic.show();\n\t}\n\n\tstatic showTask(taskId: number)\n\t{\n\t\tconst sidePanelManager = BX.SidePanel.Instance;\n\n\t\tsidePanelManager.getOpenSliders()\n\t\t\t.forEach((openSlider) => {\n\t\t\t\tconst frameWindow = openSlider.getWindow();\n\t\t\t\tif (\n\t\t\t\t\t!Type.isNil(frameWindow)\n\t\t\t\t\t&& !Type.isNil(frameWindow.BX.Tasks.Scrum.EpicInstance)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tframeWindow.BX.Tasks.Scrum.EpicInstance.showTask(taskId);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\tshowAddForm()\n\t{\n\t\tthis.id = Text.getRandom();\n\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-epic-add-form-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 800,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.epic'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_ADD_EPIC_FORM_TITLE'),\n\t\t\t\t\t\tcontent: this.createAddContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\t\tonclick: this.onSaveAddForm.bind(this)\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadAddForm.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tshowList()\n\t{\n\t\tthis.id = Text.getRandom();\n\n\t\tthis.gridId = 'EntityEpicsGrid_' + this.groupId;\n\n\t\tconst sidePanelId = 'tasks-scrum-epic-list-side-panel';\n\n\t\tthis.subscribeListToEvents(sidePanelId);\n\n\t\tthis.sidePanelManager.open(\n\t\t\tsidePanelId,\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.epic'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TITLE'),\n\t\t\t\t\t\ttoolbar: ({Button}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TOOLBAR_BUTTON'),\n\t\t\t\t\t\t\t\t\tcolor: Button.Color.PRIMARY,\n\t\t\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\t\t\tthis.showAddForm();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcontent: this.createListContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: []\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadList.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tshowTasksList(completed: boolean = false)\n\t{\n\t\tthis.id = Text.getRandom();\n\n\t\tthis.gridId = 'EpicTasksGrid_' + this.groupId;\n\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-epic-tasks-list-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.epic'],\n\t\t\t\t\t\ttitle: completed ?\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_COMPLETED_TASKS_LIST_TITLE')\n\t\t\t\t\t\t\t: Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_TASKS_LIST_TITLE')\n\t\t\t\t\t\t,\n\t\t\t\t\t\tcontent: this.createTasksListContent.bind(this, completed),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: []\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadTasksList.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tshowViewForm()\n\t{\n\t\tthis.id = Text.getRandom();\n\n\t\tthis.subscribeViewToEvents();\n\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-epic-view-form-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 800,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\t\tthis.getEpic().then((response) => {\n\t\t\t\t\t\t\tconst epic: EpicType = response.data;\n\t\t\t\t\t\t\tresolve(Layout.createContent({\n\t\t\t\t\t\t\t\textensions: ['tasks.scrum.epic'],\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_VIEW_EPIC_FORM_TITLE'),\n\t\t\t\t\t\t\t\tcontent: this.createViewContent.bind(this, epic),\n\t\t\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_EPIC_EDIT_BUTTON'),\n\t\t\t\t\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.sidePanel.close(false, () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.getEventNamespace() + ':' + 'openEdit',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tepic.id\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadViewForm.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tshowEditForm()\n\t{\n\t\tthis.id = Text.getRandom();\n\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-epic-edit-form-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 800,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.epic'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_EDIT_EPIC_FORM_TITLE'),\n\t\t\t\t\t\tcontent: this.createEditContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\t\tonclick: this.onSaveEditForm.bind(this)\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadEditForm.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tremoveEpic(): Promise\n\t{\n\t\treturn ajax.runAction(\n\t\t\t'bitrix:tasks.scrum.epic.removeEpic',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\tepicId: this.epicId\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then((response) => {\n\t\t\t\tEventEmitter.emit(this.getEventNamespace() + ':' + 'afterRemove', response.data);\n\n\t\t\t\treturn true;\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tshowTask(taskId: number)\n\t{\n\t\tif (this.pathToTask)\n\t\t{\n\t\t\tthis.sidePanelManager.open(\n\t\t\t\tthis.pathToTask\n\t\t\t\t\t.replace('#action#', 'view')\n\t\t\t\t\t.replace('#task_id#', parseInt(taskId, 10))\n\t\t\t);\n\t\t}\n\t}\n\n\tsubscribeListToEvents(sidePanelId: string)\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\tthis.getEventNamespace() + ':' + 'afterAdd',\n\t\t\t() => this.reloadGrid())\n\t\t;\n\t\tEventEmitter.subscribe(\n\t\t\tthis.getEventNamespace() + ':' + 'afterEdit',\n\t\t\t() => this.reloadGrid())\n\t\t;\n\t}\n\n\tsubscribeViewToEvents()\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\tthis.getEventNamespace() + ':' + 'openEdit',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tEpic.showEdit(this.groupId, baseEvent.getData());\n\t\t\t})\n\t\t;\n\t}\n\n\treloadSidePanel(sidePanelId?: string)\n\t{\n\t\tif (Type.isUndefined(sidePanelId))\n\t\t{\n\t\t\tthis.sidePanelManager.reload();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst openSliders = this.sidePanelManager.getOpenSliders();\n\t\t\tif (openSliders.length > 0)\n\t\t\t{\n\t\t\t\topenSliders.forEach((slider) => {\n\t\t\t\t\tif (slider.getUrl() === sidePanelId)\n\t\t\t\t\t{\n\t\t\t\t\t\tslider.reload();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateAddContent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.epic.getDescriptionEditor',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\teditorId: this.id\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.formData = response.data;\n\t\t\t\t\tresolve(this.renderAddForm());\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tcreateListContent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.epic.getList',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\tgridId: this.gridId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.listData = response.data;\n\t\t\t\t\tresolve(this.renderList());\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tcreateTasksListContent(completed: boolean): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.epic.getTasksList',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\tepicId: this.epicId,\n\t\t\t\t\t\tgridId: this.gridId,\n\t\t\t\t\t\tcompleted: completed ? 'Y' : 'N'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.listData = response.data;\n\t\t\t\t\tresolve(this.renderTasksList());\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tcreateViewContent(epic: EpicType): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.epic.getEpicFiles',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\tepicId: epic.id\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.epicFiles = Type.isUndefined(response.data.html) ? '' : response.data.html;\n\t\t\t\t\tresolve(this.renderViewForm(epic));\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tcreateEditContent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.getEpic().then((response) => {\n\t\t\t\tconst epic: EpicType = response.data;\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'bitrix:tasks.scrum.epic.getDescriptionEditor',\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\t\teditorId: this.id,\n\t\t\t\t\t\t\tepicId: epic.id,\n\t\t\t\t\t\t\ttext: epic.description\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.currentEpic = epic;\n\t\t\t\t\t\tthis.formData = response.data;\n\t\t\t\t\t\tresolve(this.renderEditForm(epic));\n\t\t\t\t\t})\n\t\t\t\t\t.catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t});\n\t\t});\n\t}\n\n\tgetEpic(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.epic.getEpic',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\tepicId: this.epicId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tonLoadAddForm(event)\n\t{\n\t\tthis.sidePanel = event.getSlider();\n\n\t\tthis.form = this.sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\n\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\n\t\tif (Type.isUndefined(this.formData.html))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.renderEditor(descriptionContainer);\n\t}\n\n\tonSaveAddForm()\n\t{\n\t\tajax.runAction(\n\t\t\t'bitrix:tasks.scrum.epic.createEpic',\n\t\t\t{\n\t\t\t\tdata: this.getRequestData()\n\t\t\t}\n\t\t)\n\t\t\t.then((response: ResponseAfter) => {\n\t\t\t\tthis.sidePanel.close(false, () => {\n\t\t\t\t\tEventEmitter.emit(this.getEventNamespace() + ':' + 'afterAdd', response.data);\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('TASKS_SCRUM_ADD_EPIC_NOTIFY')\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonLoadList(event)\n\t{\n\t\tthis.sidePanel = event.getSlider();\n\n\t\tconst listContainer = this.sidePanel.getContainer().querySelector('.tasks-scrum-epic-list');\n\n\t\tif (Type.isUndefined(this.listData.html))\n\t\t{\n\t\t\tDom.append(this.renderListBlank(), listContainer);\n\n\t\t\tEvent.bind(\n\t\t\t\tlistContainer.querySelector('.tasks-scrum-epics-empty-button'),\n\t\t\t\t'click',\n\t\t\t\tthis.showAddForm.bind(this)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tRuntime.html(listContainer, this.listData.html)\n\t\t\t\t.then(() => {\n\t\t\t\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequest.bind(this));\n\t\t\t\t\tthis.prepareTagsList(listContainer);\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\tonLoadTasksList(event)\n\t{\n\t\tthis.sidePanel = event.getSlider();\n\n\t\tconst listContainer = this.sidePanel.getContainer().querySelector('.tasks-scrum-epic-tasks-list');\n\n\t\tRuntime.html(listContainer, this.listData.html)\n\t\t\t.then(() => {\n\t\t\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequest.bind(this));\n\t\t\t})\n\t\t;\n\t}\n\n\tonLoadViewForm(event)\n\t{\n\t\tthis.sidePanel = event.getSlider();\n\n\t\tif (this.epicFiles)\n\t\t{\n\t\t\tconst filesContainer = this.sidePanel.getContainer().querySelector('.tasks-scrum-epic-form-files');\n\n\t\t\tRuntime.html(filesContainer, this.epicFiles);\n\t\t}\n\t}\n\n\tonLoadEditForm(event)\n\t{\n\t\tthis.sidePanel = event.getSlider();\n\n\t\tthis.form = this.sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\n\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\n\t\tif (Type.isUndefined(this.formData.html))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.renderEditor(descriptionContainer);\n\t}\n\n\tonSaveEditForm()\n\t{\n\t\tajax.runAction(\n\t\t\t'bitrix:tasks.scrum.epic.editEpic',\n\t\t\t{\n\t\t\t\tdata: this.getRequestData()\n\t\t\t}\n\t\t)\n\t\t\t.then((response: ResponseAfter) => {\n\t\t\t\tthis.sidePanel.close(false, () => {\n\t\t\t\t\tEventEmitter.emit(this.getEventNamespace() + ':' + 'afterEdit', response.data);\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [gridObject, eventArgs] = event.getCompatData();\n\n\t\t/* eslint-disable */\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\t/* eslint-enable */\n\n\t\teventArgs.method = 'POST';\n\n\t\tif (!eventArgs.url)\n\t\t{\n\t\t\teventArgs.url = this.getListUrl();\n\t\t}\n\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t\tgroupId: this.groupId,\n\t\t\tgridId: this.gridId,\n\t\t\tepicId: this.epicId\n\t\t};\n\t}\n\n\tgetListUrl(): string\n\t{\n\t\treturn '/bitrix/services/main/ajax.php?action=bitrix:tasks.scrum.epic.getList';\n\t}\n\n\trenderAddForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.renderNameField(0, '', this.defaultColor)}\n\t\t\t\t\t${this.renderDescriptionField()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderList(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"tasks-scrum-epic-list\"></div>`;\n\t}\n\n\trenderTasksList(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"tasks-scrum-epic-tasks-list\"></div>`;\n\t}\n\n\trenderViewForm(epic: EpicType): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t\t\t${Text.encode(epic.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"tasks-scrum-epic-header-color-current\"\n\t\t\t\t\t\t\t\tstyle=\"background-color: ${Text.encode(epic.color)};\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\">\n\t\t\t\t\t\t\t${epic.description}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-files\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEditForm(epic: EpicType): HTMLElement\n\t{\n\t\tthis.selectedColor = epic.color;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.renderNameField(epic.id, epic.name, this.selectedColor)}\n\t\t\t\t\t${this.renderDescriptionField()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderNameField(epicId: number, name: string, color: string): HTMLElement\n\t{\n\t\tconst nameField = Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\tvalue=\"${Text.encode(name)}\"\n\t\t\t\t\t\tclass=\"tasks-scrum-epic-form-header-title-control\"\n\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_NAME_PLACEHOLDER')}\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tdata-epic-id=\"${parseInt(epicId, 10)}\"\n\t\t\t\t\t\tclass=\"tasks-scrum-epic-header-color-current\"\n\t\t\t\t\t\tstyle=\"background-color: ${Text.encode(color)};\"\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst pickerContainer = nameField.querySelector('.tasks-scrum-epic-header-color');\n\n\t\tEvent.bind(pickerContainer, 'click', () => {\n\t\t\tconst colorNode = pickerContainer.querySelector('.tasks-scrum-epic-header-color-current');\n\t\t\tconst picker = this.getColorPicker(colorNode);\n\t\t\tpicker.open();\n\t\t});\n\n\t\treturn nameField;\n\t}\n\n\trenderDescriptionField(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-description --editing\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEditor(container: HTMLElement)\n\t{\n\t\tsetTimeout(() => {\n\t\t\tRuntime.html(container, this.formData.html)\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (window.LHEPostForm)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.editorHandler = window.LHEPostForm.getHandler(this.id);\n\n\t\t\t\t\t\tEventEmitter.emit(this.editorHandler.eventNode, 'OnShowLHE', [true]);\n\t\t\t\t\t}\n\t\t\t\t\tthis.focusToName();\n\t\t\t\t})\n\t\t\t;\n\t\t}, 300);\n\t}\n\n\trenderListBlank(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epics-empty\">\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-first-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_FIRST_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-image\">\n\t\t\t\t\t<svg width=\"124px\" height=\"123px\" viewBox=\"0 0 124 123\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t\t<g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" opacity=\"0.28\">\n\t\t\t\t\t\t\t<path d=\"M83,105 L83,81.4375 L105,81.4375 L105,18 L17,18 L17,81.4375 L39,81.4375 L39,105 L83,105 Z M10.9411765,0 L113.058824,0 C119.101468,0 124,4.85902727 124,10.8529412 L124,112.147059 C124,118.140973 119.101468,123 113.058824,123 L10.9411765,123 C4.89853156,123 0,118.140973 0,112.147059 L0,10.8529412 C0,4.85902727 4.89853156,0 10.9411765,0 Z M44.0142862,47.0500004 L54.2142857,57.4416671 L79.7142857,32 L87,42.75 L54.2142857,75 L36,57.0833333 L44.0142862,47.0500004 Z\" fill=\"#A8ADB4\" />\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-second-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_SECOND_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-button\">\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-lg\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TOOLBAR_BUTTON')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\treturn BX.Main.gridManager.getById(this.gridId);\n\t\t}\n\t\t/* eslint-enable */\n\n\t\treturn null;\n\t}\n\n\treloadGrid()\n\t{\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\tBX.Main.gridManager.reload(this.gridId);\n\t\t}\n\t}\n\n\tprepareTagsList(container: HTMLElement)\n\t{\n\t\tconst tagsContainers = container.querySelectorAll('.tasks-scrum-epic-grid-tags');\n\n\t\ttagsContainers.forEach((tagsContainer) => {\n\t\t\tconst tags = this.getTagsFromNode(tagsContainer);\n\t\t\tDom.clean(tagsContainer);\n\t\t\ttags.forEach((tag) => {\n\t\t\t\tDom.append(this.getTagNode(tag), tagsContainer);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTagsFromNode(node: HTMLElement): Array\n\t{\n\t\tconst tags = [];\n\n\t\tnode.childNodes.forEach((childNode) => {\n\t\t\ttags.push(childNode.textContent.trim());\n\t\t});\n\n\t\treturn tags;\n\t}\n\n\tgetTagNode(tag: string): HTMLElement\n\t{\n\t\tconst tagLabel = new Label({\n\t\t\ttext: tag,\n\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\tfill: true,\n\t\t\tsize: Label.Size.SM,\n\t\t\tcustomClass: ''\n\t\t});\n\n\t\treturn tagLabel.getContainer();\n\t}\n\n\tgetColorPicker(colorNode): Object\n\t{\n\t\tconst epicId = Dom.attr(colorNode, 'data-epic-id');\n\n\t\tif (!this.colorPickers.has(epicId))\n\t\t{\n\t\t\t/* eslint-disable */\n\t\t\tconst picker =  new BX.ColorPicker({\n\t\t\t\tbindElement: colorNode,\n\t\t\t\tdefaultColor: this.defaultColor,\n\t\t\t\tselectedColor: this.selectedColor ? this.selectedColor : this.defaultColor,\n\t\t\t\tonColorSelected: (color, picker) => {\n\t\t\t\t\tthis.selectedColor = color;\n\t\t\t\t\tcolorNode.style.backgroundColor = color;\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t\toffset: 33\n\t\t\t\t\t},\n\t\t\t\t\tclassName: 'tasks-scrum-epic-color-popup'\n\t\t\t\t},\n\t\t\t\tallowCustomColor: false,\n\t\t\t\tcolors: [\n\t\t\t\t\t['#aae9fc', '#bbecf1', '#98e1dc', '#e3f299', '#ffee95', '#ffdd93', '#dfd3b6', '#e3c6bb'],\n\t\t\t\t\t['#ffad97', '#ffbdbb', '#ffcbd8', '#ffc4e4', '#c4baed', '#dbdde0', '#bfc5cd', '#a2a8b0']\n\t\t\t\t]\n\t\t\t});\n\n\t\t\tthis.colorPickers.set(epicId, picker);\n\t\t\t/* eslint-enable */\n\t\t}\n\n\t\treturn this.colorPickers.get(epicId);\n\t}\n\n\tfocusToName()\n\t{\n\t\tsetTimeout(() => {\n\t\t\tthis.form.querySelector('.tasks-scrum-epic-form-header-title-control').focus();\n\t\t}, 50);\n\t}\n\n\tgetRequestData()\n\t{\n\t\tconst requestData = {};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t}\n\n\t\trequestData.groupId = this.groupId;\n\t\trequestData.name = (this.form.querySelector('[name=name]').value).trim();\n\t\trequestData.description = this.editorHandler.getEditor().GetContent();\n\t\trequestData.color = this.selectedColor ? this.selectedColor : this.defaultColor;\n\t\trequestData.files = this.getAttachmentsFiles();\n\n\t\treturn requestData;\n\t}\n\n\tgetAttachmentsFiles(): Array\n\t{\n\t\tconst files = [];\n\n\t\tif (\n\t\t\t!this.editorHandler\n\t\t\t|| !Type.isPlainObject(this.editorHandler.arFiles)\n\t\t\t|| !Type.isPlainObject(this.editorHandler.controllers)\n\t\t)\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\tconst fileControllers = [];\n\t\tObject.values(this.editorHandler.arFiles)\n\t\t\t.forEach((controller) => {\n\t\t\t\tif(!fileControllers.includes(controller))\n\t\t\t\t{\n\t\t\t\t\tfileControllers.push(controller);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tfileControllers.forEach((fileController) => {\n\t\t\tif (\n\t\t\t\tthis.editorHandler.controllers[fileController]\n\t\t\t\t&& Type.isPlainObject(this.editorHandler.controllers[fileController].values)\n\t\t\t)\n\t\t\t{\n\t\t\t\tObject.keys(this.editorHandler.controllers[fileController].values)\n\t\t\t\t\t.forEach((fileId) => {\n\t\t\t\t\t\tif (!files.includes(fileId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfiles.push(fileId);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t}\n\t\t});\n\n\t\treturn files;\n\t}\n}"],"names":["RequestSender","controller","action","data","Promise","resolve","reject","ajax","runAction","then","response","alertTitle","Type","isUndefined","errors","console","error","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","Epic","params","setEventNamespace","view","isString","groupId","parseInt","epicId","gridId","pathToTask","requestSender","sidePanelManager","BX","SidePanel","Instance","sidePanel","id","form","formData","listData","editorHandler","colorPickers","Map","defaultColor","selectedColor","showAddForm","showList","showViewForm","showEditForm","showTasksList","Text","getRandom","open","cacheable","width","contentCallback","Layout","createContent","extensions","content","createAddContent","bind","design","section","buttons","cancelButton","SaveButton","onclick","onSaveAddForm","events","onLoad","onLoadAddForm","sidePanelId","subscribeListToEvents","toolbar","Button","text","color","Color","PRIMARY","createListContent","onLoadList","completed","createTasksListContent","onLoadTasksList","subscribeViewToEvents","getEpic","epic","createViewContent","close","EventEmitter","emit","getEventNamespace","onLoadViewForm","createEditContent","onSaveEditForm","onLoadEditForm","showErrorAlert","taskId","replace","subscribe","reloadGrid","baseEvent","showEdit","getData","reload","openSliders","getOpenSliders","forEach","slider","getUrl","editorId","renderAddForm","renderList","renderTasksList","epicFiles","html","renderViewForm","description","currentEpic","renderEditForm","event","getSlider","getContainer","querySelector","descriptionContainer","renderEditor","getRequestData","UI","Notification","Center","notify","listContainer","Dom","append","renderListBlank","Event","Runtime","onBeforeGridRequest","prepareTagsList","filesContainer","getCompatData","gridObject","eventArgs","sessid","bitrix_sessid","method","url","getListUrl","Tag","render","renderNameField","renderDescriptionField","encode","name","nameField","pickerContainer","colorNode","picker","getColorPicker","container","setTimeout","window","LHEPostForm","getHandler","eventNode","focusToName","Main","gridManager","getById","tagsContainers","querySelectorAll","tagsContainer","tags","getTagsFromNode","clean","tag","getTagNode","node","childNodes","childNode","push","textContent","trim","tagLabel","Label","TAG_LIGHT","fill","size","Size","SM","customClass","attr","has","ColorPicker","bindElement","onColorSelected","style","backgroundColor","popupOptions","angle","position","offset","className","allowCustomColor","colors","set","get","focus","requestData","value","getEditor","GetContent","files","getAttachmentsFiles","isPlainObject","arFiles","controllers","fileControllers","Object","values","includes","fileController","keys","fileId","show","removeEpic","openSlider","frameWindow","getWindow","isNil","Tasks","Scrum","EpicInstance","showTask"],"mappings":"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"}