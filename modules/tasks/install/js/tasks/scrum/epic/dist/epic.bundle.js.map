{"version":3,"file":"epic.bundle.js","sources":["../src/request.sender.js","../src/epic.js"],"sourcesContent":["import {Loc, Type} from 'main.core';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\ttop.BX.ajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.log(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TSE_ERROR_POPUP_TITLE'));\n\n\t\t\t\ttop.BX.UI.Dialogs.MessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {ajax, Dom, Event, Loc, Runtime, Tag, Text, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Layout} from 'ui.sidepanel.layout';\nimport {Label} from 'ui.label';\n\nimport {RequestSender} from './request.sender';\n\nimport '../css/base.css';\n\ntype Params = {\n\tview: 'list' | 'add' | 'view' | 'edit',\n\tgroupId: number,\n\tepicId?: number\n}\n\ntype ResponseAfter = {\n\tdata: EpicType\n}\n\ntype EpicType = {\n\tid: number,\n\tgroupId: number,\n\tname: string,\n\tdescription: string,\n\tcreatedBy: number,\n\tmodifiedBy: number,\n\tcolor: string\n}\n\nexport class Epic extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Epic');\n\n\t\tthis.view = params.view ? params.view : '';\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.epicId = parseInt(params.epicId, 10);\n\n\t\tthis.requestSender = new RequestSender();\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\t\tthis.sidePanel = null;\n\n\t\tthis.id = Text.getRandom();\n\n\t\tthis.form = null;\n\t\tthis.formData = null;\n\n\t\tthis.listData = null;\n\n\t\tthis.editorHandler = null;\n\n\t\tthis.defaultColor = '#69dafc';\n\t\tthis.selectedColor = '';\n\t}\n\n\tshow()\n\t{\n\t\tswitch(this.view)\n\t\t{\n\t\t\tcase 'add':\n\t\t\t\tthis.showAddForm();\n\t\t\t\tbreak;\n\t\t\tcase 'list':\n\t\t\t\tthis.showList();\n\t\t\t\tbreak;\n\t\t\tcase 'view':\n\t\t\t\tthis.showViewForm();\n\t\t\t\tbreak;\n\t\t\tcase 'edit':\n\t\t\t\tthis.showEditForm();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tstatic showView(groupId: number, epicId: number)\n\t{\n\t\tconst epic = new Epic({\n\t\t\tview: 'view',\n\t\t\tgroupId: groupId,\n\t\t\tepicId: epicId\n\t\t});\n\n\t\tepic.show();\n\t}\n\n\tstatic showEdit(groupId: number, epicId: number)\n\t{\n\t\tconst epic = new Epic({\n\t\t\tview: 'edit',\n\t\t\tgroupId: groupId,\n\t\t\tepicId: epicId\n\t\t});\n\n\t\tepic.show();\n\t}\n\n\tstatic removeEpic(groupId: number, epicId: number)\n\t{\n\t\tconst epic = new Epic({\n\t\t\tview: 'edit',\n\t\t\tgroupId: groupId,\n\t\t\tepicId: epicId\n\t\t});\n\n\t\tepic.removeEpic()\n\t\t\t.then(() => {\n\t\t\t\tepic.reloadSidePanel();\n\t\t\t})\n\t\t;\n\t}\n\n\tshowAddForm()\n\t{\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-epic-add-form-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 800,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.epic'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_ADD_EPIC_FORM_TITLE'),\n\t\t\t\t\t\tcontent: this.createAddContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\t\tonclick: this.onSaveAddForm.bind(this)\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadAddForm.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tshowList()\n\t{\n\t\tthis.gridId = 'EntityEpicsGrid_' + this.groupId;\n\n\t\tconst sidePanelId = 'tasks-scrum-epic-list-side-panel';\n\n\t\tthis.subscribeListToEvents(sidePanelId);\n\n\t\tthis.sidePanelManager.open(\n\t\t\tsidePanelId,\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.epic'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TITLE'),\n\t\t\t\t\t\ttoolbar: ({Button}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TOOLBAR_BUTTON'),\n\t\t\t\t\t\t\t\t\tcolor: Button.Color.PRIMARY,\n\t\t\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\t\t\tthis.showAddForm();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcontent: this.createListContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: []\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadList.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tshowViewForm()\n\t{\n\t\tthis.subscribeViewToEvents();\n\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-epic-view-form-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 800,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\t\tthis.getEpic().then((response) => {\n\t\t\t\t\t\t\tconst epic: EpicType = response.data;\n\t\t\t\t\t\t\tresolve(Layout.createContent({\n\t\t\t\t\t\t\t\textensions: ['tasks.scrum.epic'],\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_VIEW_EPIC_FORM_TITLE'),\n\t\t\t\t\t\t\t\tcontent: this.createViewContent.bind(this, epic),\n\t\t\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_EPIC_EDIT_BUTTON'),\n\t\t\t\t\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.sidePanel.close(false, () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.getEventNamespace() + ':' + 'openEdit',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tepic.id\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadViewForm.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tshowEditForm()\n\t{\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-epic-edit-form-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 800,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.epic'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_EDIT_EPIC_FORM_TITLE'),\n\t\t\t\t\t\tcontent: this.createEditContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\t\tonclick: this.onSaveEditForm.bind(this)\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadEditForm.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tremoveEpic(): Promise\n\t{\n\t\treturn ajax.runAction(\n\t\t\t'bitrix:tasks.scrum.epic.removeEpic',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\tepicId: this.epicId\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then((response) => {\n\t\t\t\tEventEmitter.emit(this.getEventNamespace() + ':' + 'afterRemove', response.data);\n\n\t\t\t\treturn true;\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tsubscribeListToEvents(sidePanelId: string)\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\tthis.getEventNamespace() + ':' + 'afterAdd',\n\t\t\t() => {\n\t\t\t\tthis.reloadSidePanel(sidePanelId);\n\t\t\t})\n\t\t;\n\t\ttop.BX.Event.EventEmitter.subscribe(\n\t\t\tthis.getEventNamespace() + ':' + 'afterEdit',\n\t\t\t() => {\n\t\t\t\tthis.reloadSidePanel(sidePanelId);\n\t\t\t})\n\t\t;\n\t}\n\n\tsubscribeViewToEvents()\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\tthis.getEventNamespace() + ':' + 'openEdit',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tEpic.showEdit(this.groupId, baseEvent.getData());\n\t\t\t})\n\t\t;\n\t}\n\n\treloadSidePanel(sidePanelId?: string)\n\t{\n\t\tif (Type.isUndefined(sidePanelId))\n\t\t{\n\t\t\tthis.sidePanelManager.reload();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst openSliders = this.sidePanelManager.getOpenSliders();\n\t\t\tif (openSliders.length > 0)\n\t\t\t{\n\t\t\t\topenSliders.forEach((slider) => {\n\t\t\t\t\tif (slider.getUrl() === sidePanelId)\n\t\t\t\t\t{\n\t\t\t\t\t\tslider.reload();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateAddContent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\ttop.BX.ajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.epic.getDescriptionEditor',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\teditorId: this.id\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.formData = response.data;\n\t\t\t\t\tresolve(this.renderAddForm());\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tcreateListContent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\ttop.BX.ajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.epic.getList',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\tgridId: this.gridId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.listData = response.data;\n\t\t\t\t\tresolve(this.renderList());\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tcreateViewContent(epic: EpicType)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\ttop.BX.ajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.epic.getEpicFiles',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\tepicId: epic.id\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.epicFiles = Type.isUndefined(response.data.html) ? '' : response.data.html;\n\t\t\t\t\tresolve(this.renderViewForm(epic));\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tcreateEditContent()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.getEpic().then((response) => {\n\t\t\t\tconst epic: EpicType = response.data;\n\t\t\t\ttop.BX.ajax.runAction(\n\t\t\t\t\t'bitrix:tasks.scrum.epic.getDescriptionEditor',\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\t\teditorId: this.id,\n\t\t\t\t\t\t\tepicId: epic.id,\n\t\t\t\t\t\t\ttext: epic.description\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.currentEpic = epic;\n\t\t\t\t\t\tthis.formData = response.data;\n\t\t\t\t\t\tresolve(this.renderEditForm(epic));\n\t\t\t\t\t})\n\t\t\t\t\t.catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t});\n\t\t});\n\t}\n\n\tgetEpic(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.epic.getEpic',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\tepicId: this.epicId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tonLoadAddForm(event)\n\t{\n\t\tthis.sidePanel = event.getSlider();\n\n\t\tthis.form = this.sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\n\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\n\t\tif (Type.isUndefined(this.formData.html))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.renderEditor(descriptionContainer);\n\t}\n\n\tonSaveAddForm()\n\t{\n\t\tajax.runAction(\n\t\t\t'bitrix:tasks.scrum.epic.createEpic',\n\t\t\t{\n\t\t\t\tdata: this.getRequestData()\n\t\t\t}\n\t\t)\n\t\t\t.then((response: ResponseAfter) => {\n\t\t\t\tthis.sidePanel.close(false, () => {\n\t\t\t\t\tEventEmitter.emit(this.getEventNamespace() + ':' + 'afterAdd', response.data);\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonLoadList(event)\n\t{\n\t\tthis.sidePanel = event.getSlider();\n\n\t\tconst listContainer = this.sidePanel.getContainer().querySelector('.tasks-scrum-epic-list');\n\n\t\tif (Type.isUndefined(this.listData.html))\n\t\t{\n\t\t\tDom.append(this.renderListBlank(), listContainer);\n\n\t\t\tEvent.bind(\n\t\t\t\tlistContainer.querySelector('.tasks-scrum-epics-empty-button'),\n\t\t\t\t'click',\n\t\t\t\tthis.showAddForm.bind(this)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttop.BX.Runtime.html(listContainer, this.listData.html)\n\t\t\t\t.then(() => {\n\t\t\t\t\ttop.BX.addCustomEvent(\n\t\t\t\t\t\t'Grid::beforeRequest',\n\t\t\t\t\t\tthis.onBeforeGridRequest.bind(this)\n\t\t\t\t\t);\n\t\t\t\t\tthis.prepareTagsList(listContainer);\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\tonLoadViewForm(event)\n\t{\n\t\tthis.sidePanel = event.getSlider();\n\n\t\tif (this.epicFiles)\n\t\t{\n\t\t\tconst filesContainer = this.sidePanel.getContainer().querySelector('.tasks-scrum-epic-form-files');\n\n\t\t\tRuntime.html(filesContainer, this.epicFiles);\n\t\t}\n\t}\n\n\tonLoadEditForm(event)\n\t{\n\t\tthis.sidePanel = event.getSlider();\n\n\t\tthis.form = this.sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\n\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\n\t\tif (Type.isUndefined(this.formData.html))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.renderEditor(descriptionContainer);\n\t}\n\n\tonSaveEditForm()\n\t{\n\t\tajax.runAction(\n\t\t\t'bitrix:tasks.scrum.epic.editEpic',\n\t\t\t{\n\t\t\t\tdata: this.getRequestData()\n\t\t\t}\n\t\t)\n\t\t\t.then((response: ResponseAfter) => {\n\t\t\t\tthis.sidePanel.close(false, () => {\n\t\t\t\t\ttop.BX.Event.EventEmitter.emit(this.getEventNamespace() + ':' + 'afterEdit', response.data);\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonBeforeGridRequest(gridObject, eventArgs)\n\t{\n\t\t/* eslint-disable */\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\t/* eslint-enable */\n\n\t\teventArgs.method = 'POST';\n\n\t\tif (!eventArgs.url)\n\t\t{\n\t\t\teventArgs.url = this.getListUrl();\n\t\t}\n\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t\tgroupId: this.groupId,\n\t\t\tgridId: this.gridId\n\t\t};\n\t}\n\n\tgetListUrl(): string\n\t{\n\t\treturn '/bitrix/services/main/ajax.php?action=bitrix:tasks.scrum.epic.getList';\n\t}\n\n\trenderAddForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.renderNameField('', this.defaultColor)}\n\t\t\t\t\t${this.renderDescriptionField()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderList(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"tasks-scrum-epic-list\"></div>`;\n\t}\n\n\trenderViewForm(epic: EpicType): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t\t\t${Text.encode(epic.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\t\t\"background-color: ${Text.encode(epic.color)};\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\">\n\t\t\t\t\t\t\t${epic.description}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-files\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEditForm(epic: EpicType): HTMLElement\n\t{\n\t\tthis.selectedColor = epic.color;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.renderNameField(epic.name, this.selectedColor)}\n\t\t\t\t\t${this.renderDescriptionField()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderNameField(name: String, color: String): HTMLElement\n\t{\n\t\tconst nameField = Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t<input type=\"text\" name=\"name\" value=\"${Text.encode(name)}\" class=\n\t\t\t\t\t\t\"tasks-scrum-epic-form-header-title-control\" placeholder=\n\t\t\t\t\t\t\"${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_NAME_PLACEHOLDER')}\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\"background-color: ${Text.encode(color)};\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst pickerContainer = nameField.querySelector('.tasks-scrum-epic-header-color');\n\n\t\tEvent.bind(pickerContainer, 'click', () => {\n\t\t\tconst colorNode = pickerContainer.querySelector('.tasks-scrum-epic-header-color-current');\n\t\t\tconst picker = this.getColorPicker(colorNode);\n\t\t\tpicker.open();\n\t\t});\n\n\t\treturn nameField;\n\t}\n\n\trenderDescriptionField(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-description --editing\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEditor(container: HTMLElement)\n\t{\n\t\tsetTimeout(() => {\n\t\t\ttop.BX.Runtime.html(container, this.formData.html)\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (window.top.LHEPostForm)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.editorHandler = window.top.LHEPostForm.getHandler(this.id);\n\n\t\t\t\t\t\tEventEmitter.emit(this.editorHandler.eventNode, 'OnShowLHE', [true]);\n\n\t\t\t\t\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\t\t\t\t}\n\t\t\t\t\tthis.focusToName();\n\t\t\t\t})\n\t\t\t;\n\t\t}, 300);\n\t}\n\n\trenderListBlank(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epics-empty\">\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-first-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_FIRST_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-image\">\n\t\t\t\t\t<svg width=\"124px\" height=\"123px\" viewBox=\"0 0 124 123\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t\t<g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" opacity=\"0.28\">\n\t\t\t\t\t\t\t<path d=\"M83,105 L83,81.4375 L105,81.4375 L105,18 L17,18 L17,81.4375 L39,81.4375 L39,105 L83,105 Z M10.9411765,0 L113.058824,0 C119.101468,0 124,4.85902727 124,10.8529412 L124,112.147059 C124,118.140973 119.101468,123 113.058824,123 L10.9411765,123 C4.89853156,123 0,118.140973 0,112.147059 L0,10.8529412 C0,4.85902727 4.89853156,0 10.9411765,0 Z M44.0142862,47.0500004 L54.2142857,57.4416671 L79.7142857,32 L87,42.75 L54.2142857,75 L36,57.0833333 L44.0142862,47.0500004 Z\" fill=\"#A8ADB4\" />\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-second-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_SECOND_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-button\">\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-lg\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TOOLBAR_BUTTON')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (top.BX && top.BX.Main && top.BX.Main.gridManager)\n\t\t{\n\t\t\treturn top.BX.Main.gridManager.getById(this.gridId);\n\t\t}\n\t\t/* eslint-enable */\n\n\t\treturn null;\n\t}\n\n\tprepareTagsList(container: HTMLElement)\n\t{\n\t\tconst tagsContainers = container.querySelectorAll('.tasks-scrum-epic-grid-tags');\n\n\t\ttagsContainers.forEach((tagsContainer) => {\n\t\t\tconst tags = this.getTagsFromNode(tagsContainer);\n\t\t\tDom.clean(tagsContainer);\n\t\t\ttags.forEach((tag) => {\n\t\t\t\tDom.append(this.getTagNode(tag), tagsContainer);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTagsFromNode(node: HTMLElement): Array\n\t{\n\t\tconst tags = [];\n\n\t\tnode.childNodes.forEach((childNode) => {\n\t\t\ttags.push(childNode.textContent.trim());\n\t\t});\n\n\t\treturn tags;\n\t}\n\n\tgetTagNode(tag: string): HTMLElement\n\t{\n\t\tconst tagLabel = new Label({\n\t\t\ttext: tag,\n\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\tfill: true,\n\t\t\tsize: Label.Size.SM,\n\t\t\tcustomClass: ''\n\t\t});\n\t\tconst container = tagLabel.getContainer();\n\n\t\tEvent.bind(container, 'click', () => {\n\t\t\tthis.sidePanel.close(false, () => {\n\t\t\t\tEventEmitter.emit(this.getEventNamespace() + ':' + 'filterByTag', tag);\n\t\t\t});\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tgetColorPicker(colorNode)\n\t{\n\t\t/* eslint-disable */\n\t\treturn new top.BX.ColorPicker({\n\t\t\tbindElement: colorNode,\n\t\t\tdefaultColor: this.defaultColor,\n\t\t\tselectedColor: this.selectedColor ? this.selectedColor : this.defaultColor,\n\t\t\tonColorSelected: (color, picker) => {\n\t\t\t\tthis.selectedColor = color;\n\t\t\t\tcolorNode.style.backgroundColor = color;\n\t\t\t},\n\t\t\tpopupOptions: {\n\t\t\t\tclassName: 'tasks-scrum-epic-color-popup'\n\t\t\t},\n\t\t\tallowCustomColor: false,\n\t\t\tcolors: [\n\t\t\t\t['#aae9fc', '#bbecf1', '#98e1dc', '#e3f299', '#ffee95', '#ffdd93', '#dfd3b6', '#e3c6bb'],\n\t\t\t\t['#ffad97', '#ffbdbb', '#ffcbd8', '#ffc4e4', '#c4baed', '#dbdde0', '#bfc5cd', '#a2a8b0']\n\t\t\t]\n\t\t});\n\t\t/* eslint-enable */\n\t}\n\n\tfocusToName()\n\t{\n\t\tsetTimeout(() => {\n\t\t\tthis.form.querySelector('.tasks-scrum-epic-form-header-title-control').focus();\n\t\t}, 50);\n\t}\n\n\tgetRequestData()\n\t{\n\t\tconst requestData = {};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t}\n\n\t\trequestData.groupId = this.groupId;\n\t\trequestData.name = (this.form.querySelector('[name=name]').value).trim();\n\t\trequestData.description = this.editorHandler.getEditor().GetContent();\n\t\trequestData.color = this.selectedColor ? this.selectedColor : this.defaultColor;\n\t\trequestData.files = this.getAttachmentsFiles();\n\n\t\treturn requestData;\n\t}\n\n\tgetAttachmentsFiles(): Array\n\t{\n\t\tconst files = [];\n\n\t\tif (\n\t\t\t!this.editorHandler\n\t\t\t|| !Type.isPlainObject(this.editorHandler.arFiles)\n\t\t\t|| !Type.isPlainObject(this.editorHandler.controllers)\n\t\t)\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\tconst fileControllers = [];\n\t\tObject.values(this.editorHandler.arFiles)\n\t\t\t.forEach((controller) => {\n\t\t\t\tif(!fileControllers.includes(controller))\n\t\t\t\t{\n\t\t\t\t\tfileControllers.push(controller);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tfileControllers.forEach((fileController) => {\n\t\t\tif (\n\t\t\t\tthis.editorHandler.controllers[fileController]\n\t\t\t\t&& Type.isPlainObject(this.editorHandler.controllers[fileController].values)\n\t\t\t)\n\t\t\t{\n\t\t\t\tObject.keys(this.editorHandler.controllers[fileController].values)\n\t\t\t\t\t.forEach((fileId) => {\n\t\t\t\t\t\tif (!files.includes(fileId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfiles.push(fileId);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t}\n\t\t});\n\n\t\treturn files;\n\t}\n}"],"names":["RequestSender","controller","action","data","Promise","resolve","reject","top","BX","ajax","runAction","then","response","alertTitle","Type","isUndefined","errors","console","log","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","UI","Dialogs","MessageBox","alert","Epic","params","setEventNamespace","view","groupId","parseInt","epicId","requestSender","sidePanelManager","SidePanel","Instance","sidePanel","id","Text","getRandom","form","formData","listData","editorHandler","defaultColor","selectedColor","showAddForm","showList","showViewForm","showEditForm","open","cacheable","width","contentCallback","Layout","createContent","extensions","content","createAddContent","bind","design","section","buttons","cancelButton","SaveButton","onclick","onSaveAddForm","events","onLoad","onLoadAddForm","gridId","sidePanelId","subscribeListToEvents","toolbar","Button","text","color","Color","PRIMARY","createListContent","onLoadList","subscribeViewToEvents","getEpic","epic","createViewContent","close","EventEmitter","emit","getEventNamespace","onLoadViewForm","createEditContent","onSaveEditForm","onLoadEditForm","catch","showErrorAlert","subscribe","reloadSidePanel","Event","baseEvent","showEdit","getData","reload","openSliders","getOpenSliders","forEach","slider","getUrl","editorId","renderAddForm","renderList","epicFiles","html","renderViewForm","description","currentEpic","renderEditForm","event","getSlider","getContainer","querySelector","descriptionContainer","renderEditor","getRequestData","listContainer","Dom","append","renderListBlank","Runtime","addCustomEvent","onBeforeGridRequest","prepareTagsList","filesContainer","gridObject","eventArgs","sessid","bitrix_sessid","method","url","getListUrl","Tag","render","renderNameField","renderDescriptionField","encode","name","nameField","pickerContainer","colorNode","picker","getColorPicker","container","setTimeout","window","LHEPostForm","getHandler","eventNode","focusToName","Main","gridManager","getById","tagsContainers","querySelectorAll","tagsContainer","tags","getTagsFromNode","clean","tag","getTagNode","node","childNodes","childNode","push","textContent","trim","tagLabel","Label","TAG_LIGHT","fill","size","Size","SM","customClass","ColorPicker","bindElement","onColorSelected","style","backgroundColor","popupOptions","className","allowCustomColor","colors","focus","requestData","value","getEditor","GetContent","files","getAttachmentsFiles","isPlainObject","arFiles","controllers","fileControllers","Object","values","includes","fileController","keys","fileId","show","removeEpic"],"mappings":";;;;;KAQaA,aAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,gCAEaC,UAFb,EAEiCC,MAFjC,EAGC;CAAA,UADgDC,IAChD,uEADuD,EACvD;CACC,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvCC,QAAAA,GAAG,CAACC,EAAJ,CAAOC,IAAP,CAAYC,SAAZ,CACC,wBAAwBT,UAAxB,GAAqC,GAArC,GAA2CC,MAD5C,EAEC;CACCC,UAAAA,IAAI,EAAEA;CADP,SAFD,EAKEQ,IALF,CAKON,OALP,EAKgBC,MALhB;CAMA,OAPM,CAAP;CAQA;CAZF;CAAA;CAAA,mCAcgBM,QAdhB,EAcyCC,UAdzC,EAeC;CACC,UAAIC,cAAI,CAACC,WAAL,CAAiBH,QAAQ,CAACI,MAA1B,CAAJ,EACA;CACCC,QAAAA,OAAO,CAACC,GAAR,CAAYN,QAAZ;CAEA;CACA;;CAED,UAAIA,QAAQ,CAACI,MAAT,CAAgBG,MAApB,EACA;CACC,YAAMC,UAAU,GAAGR,QAAQ,CAACI,MAAT,CAAgBK,KAAhB,EAAnB;;CACA,YAAID,UAAJ,EACA;CACC,cAAME,SAAS,GAAIF,UAAU,CAACG,IAAX,GAAkBH,UAAU,CAACG,IAA7B,GAAoC,EAAvD;CAEA,cAAMC,OAAO,GAAGJ,UAAU,CAACI,OAAX,GAAqB,GAArB,GAA2BF,SAA3C;CACA,cAAMG,KAAK,GAAIZ,UAAU,GAAGA,UAAH,GAAgBa,aAAG,CAACC,UAAJ,CAAe,uBAAf,CAAzC;CAEApB,UAAAA,GAAG,CAACC,EAAJ,CAAOoB,EAAP,CAAUC,OAAV,CAAkBC,UAAlB,CAA6BC,KAA7B,CAAmCP,OAAnC,EAA4CC,KAA5C;CACA;CACD;CACD;CApCF;CAAA;CAAA;;;KCsBaO,IAAb;CAAA;;CAEC,gBAAYC,MAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,MAAN;;CAEA,UAAKC,iBAAL,CAAuB,qBAAvB;;CAEA,UAAKC,IAAL,GAAYF,MAAM,CAACE,IAAP,GAAcF,MAAM,CAACE,IAArB,GAA4B,EAAxC;CAEA,UAAKC,OAAL,GAAeC,QAAQ,CAACJ,MAAM,CAACG,OAAR,EAAiB,EAAjB,CAAvB;CACA,UAAKE,MAAL,GAAcD,QAAQ,CAACJ,MAAM,CAACK,MAAR,EAAgB,EAAhB,CAAtB;CAEA,UAAKC,aAAL,GAAqB,IAAIvC,aAAJ,EAArB;CAEA;;CACA,UAAKwC,gBAAL,GAAwBhC,EAAE,CAACiC,SAAH,CAAaC,QAArC;CACA;;CACA,UAAKC,SAAL,GAAiB,IAAjB;CAEA,UAAKC,EAAL,GAAUC,cAAI,CAACC,SAAL,EAAV;CAEA,UAAKC,IAAL,GAAY,IAAZ;CACA,UAAKC,QAAL,GAAgB,IAAhB;CAEA,UAAKC,QAAL,GAAgB,IAAhB;CAEA,UAAKC,aAAL,GAAqB,IAArB;CAEA,UAAKC,YAAL,GAAoB,SAApB;CACA,UAAKC,aAAL,GAAqB,EAArB;CA3BD;CA4BC;;CA/BF;CAAA;CAAA,2BAkCC;CACC,cAAO,KAAKjB,IAAZ;CAEC,aAAK,KAAL;CACC,eAAKkB,WAAL;CACA;;CACD,aAAK,MAAL;CACC,eAAKC,QAAL;CACA;;CACD,aAAK,MAAL;CACC,eAAKC,YAAL;CACA;;CACD,aAAK,MAAL;CACC,eAAKC,YAAL;CACA;CAbF;CAeA;CAlDF;CAAA;CAAA,kCA0FC;CAAA;;CACC,WAAKhB,gBAAL,CAAsBiB,IAAtB,CACC,sCADD,EAEC;CACCC,QAAAA,SAAS,EAAE,KADZ;CAECC,QAAAA,KAAK,EAAE,GAFR;CAGCC,QAAAA,eAAe,EAAE,2BAAM;CACtB,iBAAOC,0BAAM,CAACC,aAAP,CAAqB;CAC3BC,YAAAA,UAAU,EAAE,CAAC,kBAAD,CADe;CAE3BtC,YAAAA,KAAK,EAAEC,aAAG,CAACC,UAAJ,CAAe,iCAAf,CAFoB;CAG3BqC,YAAAA,OAAO,EAAE,MAAI,CAACC,gBAAL,CAAsBC,IAAtB,CAA2B,MAA3B,CAHkB;CAI3BC,YAAAA,MAAM,EAAE;CACPC,cAAAA,OAAO,EAAE;CADF,aAJmB;CAO3BC,YAAAA,OAAO,EAAE,uBAAgC;CAAA,kBAA9BC,YAA8B,QAA9BA,YAA8B;CAAA,kBAAhBC,UAAgB,QAAhBA,UAAgB;CACxC,qBAAO,CACN,IAAIA,UAAJ,CAAe;CACdC,gBAAAA,OAAO,EAAE,MAAI,CAACC,aAAL,CAAmBP,IAAnB,CAAwB,MAAxB;CADK,eAAf,CADM,EAINI,YAJM,CAAP;CAMA;CAd0B,WAArB,CAAP;CAgBA,SApBF;CAqBCI,QAAAA,MAAM,EAAE;CACPC,UAAAA,MAAM,EAAE,KAAKC,aAAL,CAAmBV,IAAnB,CAAwB,IAAxB;CADD;CArBT,OAFD;CA4BA;CAvHF;CAAA;CAAA,+BA0HC;CAAA;;CACC,WAAKW,MAAL,GAAc,qBAAqB,KAAKzC,OAAxC;CAEA,UAAM0C,WAAW,GAAG,kCAApB;CAEA,WAAKC,qBAAL,CAA2BD,WAA3B;CAEA,WAAKtC,gBAAL,CAAsBiB,IAAtB,CACCqB,WADD,EAEC;CACCpB,QAAAA,SAAS,EAAE,KADZ;CAECE,QAAAA,eAAe,EAAE,2BAAM;CACtB,iBAAOC,0BAAM,CAACC,aAAP,CAAqB;CAC3BC,YAAAA,UAAU,EAAE,CAAC,kBAAD,CADe;CAE3BtC,YAAAA,KAAK,EAAEC,aAAG,CAACC,UAAJ,CAAe,wCAAf,CAFoB;CAG3BqD,YAAAA,OAAO,EAAE,wBAAc;CAAA,kBAAZC,MAAY,SAAZA,MAAY;CACtB,qBAAO,CACN,IAAIA,MAAJ,CAAW;CACVC,gBAAAA,IAAI,EAAExD,aAAG,CAACC,UAAJ,CAAe,iDAAf,CADI;CAEVwD,gBAAAA,KAAK,EAAEF,MAAM,CAACG,KAAP,CAAaC,OAFV;CAGVb,gBAAAA,OAAO,EAAE,mBAAM;CACd,kBAAA,MAAI,CAACnB,WAAL;CACA;CALS,eAAX,CADM,CAAP;CASA,aAb0B;CAc3BW,YAAAA,OAAO,EAAE,MAAI,CAACsB,iBAAL,CAAuBpB,IAAvB,CAA4B,MAA5B,CAdkB;CAe3BC,YAAAA,MAAM,EAAE;CACPC,cAAAA,OAAO,EAAE;CADF,aAfmB;CAkB3BC,YAAAA,OAAO,EAAE;CAlBkB,WAArB,CAAP;CAoBA,SAvBF;CAwBCK,QAAAA,MAAM,EAAE;CACPC,UAAAA,MAAM,EAAE,KAAKY,UAAL,CAAgBrB,IAAhB,CAAqB,IAArB;CADD;CAxBT,OAFD;CA+BA;CAhKF;CAAA;CAAA,mCAmKC;CAAA;;CACC,WAAKsB,qBAAL;CAEA,WAAKhD,gBAAL,CAAsBiB,IAAtB,CACC,uCADD,EAEC;CACCC,QAAAA,SAAS,EAAE,KADZ;CAECC,QAAAA,KAAK,EAAE,GAFR;CAGCC,QAAAA,eAAe,EAAE,2BAAM;CACtB,iBAAO,IAAIxD,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvC,YAAA,MAAI,CAACmF,OAAL,GAAe9E,IAAf,CAAoB,UAACC,QAAD,EAAc;CACjC,kBAAM8E,IAAc,GAAG9E,QAAQ,CAACT,IAAhC;CACAE,cAAAA,OAAO,CAACwD,0BAAM,CAACC,aAAP,CAAqB;CAC5BC,gBAAAA,UAAU,EAAE,CAAC,kBAAD,CADgB;CAE5BtC,gBAAAA,KAAK,EAAEC,aAAG,CAACC,UAAJ,CAAe,kCAAf,CAFqB;CAG5BqC,gBAAAA,OAAO,EAAE,MAAI,CAAC2B,iBAAL,CAAuBzB,IAAvB,CAA4B,MAA5B,EAAkCwB,IAAlC,CAHmB;CAI5BvB,gBAAAA,MAAM,EAAE;CACPC,kBAAAA,OAAO,EAAE;CADF,iBAJoB;CAO5BC,gBAAAA,OAAO,EAAE,wBAAgC;CAAA,sBAA9BC,YAA8B,SAA9BA,YAA8B;CAAA,sBAAhBC,UAAgB,SAAhBA,UAAgB;CACxC,yBAAO,CACN,IAAIA,UAAJ,CAAe;CACdW,oBAAAA,IAAI,EAAExD,aAAG,CAACC,UAAJ,CAAe,8BAAf,CADQ;CAEd6C,oBAAAA,OAAO,EAAE,mBAAM;CACd,sBAAA,MAAI,CAAC7B,SAAL,CAAeiD,KAAf,CAAqB,KAArB,EAA4B,YAAM;CACjCC,wBAAAA,6BAAY,CAACC,IAAb,CACC,MAAI,CAACC,iBAAL,KAA2B,GAA3B,GAAiC,UADlC,EAECL,IAAI,CAAC9C,EAFN;CAIA,uBALD;CAMA;CATa,mBAAf,CADM,EAYN0B,YAZM,CAAP;CAcA;CAtB2B,eAArB,CAAD,CAAP;CAwBA,aA1BD;CA2BA,WA5BM,CAAP;CA6BA,SAjCF;CAkCCI,QAAAA,MAAM,EAAE;CACPC,UAAAA,MAAM,EAAE,KAAKqB,cAAL,CAAoB9B,IAApB,CAAyB,IAAzB;CADD;CAlCT,OAFD;CAyCA;CA/MF;CAAA;CAAA,mCAkNC;CAAA;;CACC,WAAK1B,gBAAL,CAAsBiB,IAAtB,CACC,uCADD,EAEC;CACCC,QAAAA,SAAS,EAAE,KADZ;CAECC,QAAAA,KAAK,EAAE,GAFR;CAGCC,QAAAA,eAAe,EAAE,2BAAM;CACtB,iBAAOC,0BAAM,CAACC,aAAP,CAAqB;CAC3BC,YAAAA,UAAU,EAAE,CAAC,kBAAD,CADe;CAE3BtC,YAAAA,KAAK,EAAEC,aAAG,CAACC,UAAJ,CAAe,kCAAf,CAFoB;CAG3BqC,YAAAA,OAAO,EAAE,MAAI,CAACiC,iBAAL,CAAuB/B,IAAvB,CAA4B,MAA5B,CAHkB;CAI3BC,YAAAA,MAAM,EAAE;CACPC,cAAAA,OAAO,EAAE;CADF,aAJmB;CAO3BC,YAAAA,OAAO,EAAE,wBAAgC;CAAA,kBAA9BC,YAA8B,SAA9BA,YAA8B;CAAA,kBAAhBC,UAAgB,SAAhBA,UAAgB;CACxC,qBAAO,CACN,IAAIA,UAAJ,CAAe;CACdC,gBAAAA,OAAO,EAAE,MAAI,CAAC0B,cAAL,CAAoBhC,IAApB,CAAyB,MAAzB;CADK,eAAf,CADM,EAINI,YAJM,CAAP;CAMA;CAd0B,WAArB,CAAP;CAgBA,SApBF;CAqBCI,QAAAA,MAAM,EAAE;CACPC,UAAAA,MAAM,EAAE,KAAKwB,cAAL,CAAoBjC,IAApB,CAAyB,IAAzB;CADD;CArBT,OAFD;CA4BA;CA/OF;CAAA;CAAA,iCAkPC;CAAA;;CACC,aAAOzD,cAAI,CAACC,SAAL,CACN,oCADM,EAEN;CACCP,QAAAA,IAAI,EAAE;CACLiC,UAAAA,OAAO,EAAE,KAAKA,OADT;CAELE,UAAAA,MAAM,EAAE,KAAKA;CAFR;CADP,OAFM,EASL3B,IATK,CASA,UAACC,QAAD,EAAc;CACnBiF,QAAAA,6BAAY,CAACC,IAAb,CAAkB,MAAI,CAACC,iBAAL,KAA2B,GAA3B,GAAiC,aAAnD,EAAkEnF,QAAQ,CAACT,IAA3E;CAEA,eAAO,IAAP;CACA,OAbK,EAcLiG,KAdK,CAcC,UAACxF,QAAD,EAAc;CACpB,QAAA,MAAI,CAAC2B,aAAL,CAAmB8D,cAAnB,CAAkCzF,QAAlC;CACA,OAhBK,CAAP;CAkBA;CArQF;CAAA;CAAA,0CAuQuBkE,WAvQvB,EAwQC;CAAA;;CACCe,MAAAA,6BAAY,CAACS,SAAb,CACC,KAAKP,iBAAL,KAA2B,GAA3B,GAAiC,UADlC,EAEC,YAAM;CACL,QAAA,MAAI,CAACQ,eAAL,CAAqBzB,WAArB;CACA,OAJF;CAMAvE,MAAAA,GAAG,CAACC,EAAJ,CAAOgG,KAAP,CAAaX,YAAb,CAA0BS,SAA1B,CACC,KAAKP,iBAAL,KAA2B,GAA3B,GAAiC,WADlC,EAEC,YAAM;CACL,QAAA,MAAI,CAACQ,eAAL,CAAqBzB,WAArB;CACA,OAJF;CAMA;CArRF;CAAA;CAAA,4CAwRC;CAAA;;CACCe,MAAAA,6BAAY,CAACS,SAAb,CACC,KAAKP,iBAAL,KAA2B,GAA3B,GAAiC,UADlC,EAEC,UAACU,SAAD,EAA0B;CACzBzE,QAAAA,IAAI,CAAC0E,QAAL,CAAc,MAAI,CAACtE,OAAnB,EAA4BqE,SAAS,CAACE,OAAV,EAA5B;CACA,OAJF;CAMA;CA/RF;CAAA;CAAA,oCAiSiB7B,WAjSjB,EAkSC;CACC,UAAIhE,cAAI,CAACC,WAAL,CAAiB+D,WAAjB,CAAJ,EACA;CACC,aAAKtC,gBAAL,CAAsBoE,MAAtB;CACA,OAHD,MAKA;CACC,YAAMC,WAAW,GAAG,KAAKrE,gBAAL,CAAsBsE,cAAtB,EAApB;;CACA,YAAID,WAAW,CAAC1F,MAAZ,GAAqB,CAAzB,EACA;CACC0F,UAAAA,WAAW,CAACE,OAAZ,CAAoB,UAACC,MAAD,EAAY;CAC/B,gBAAIA,MAAM,CAACC,MAAP,OAAoBnC,WAAxB,EACA;CACCkC,cAAAA,MAAM,CAACJ,MAAP;CACA;CACD,WALD;CAMA;CACD;CACD;CApTF;CAAA;CAAA,uCAuTC;CAAA;;CACC,aAAO,IAAIxG,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvCC,QAAAA,GAAG,CAACC,EAAJ,CAAOC,IAAP,CAAYC,SAAZ,CACC,8CADD,EAEC;CACCP,UAAAA,IAAI,EAAE;CACLiC,YAAAA,OAAO,EAAE,MAAI,CAACA,OADT;CAEL8E,YAAAA,QAAQ,EAAE,MAAI,CAACtE;CAFV;CADP,SAFD,EASEjC,IATF,CASO,UAACC,QAAD,EAAc;CACnB,UAAA,MAAI,CAACoC,QAAL,GAAgBpC,QAAQ,CAACT,IAAzB;CACAE,UAAAA,OAAO,CAAC,MAAI,CAAC8G,aAAL,EAAD,CAAP;CACA,SAZF,EAaEf,KAbF,CAaQ,UAACxF,QAAD,EAAc;CACpB,UAAA,MAAI,CAAC2B,aAAL,CAAmB8D,cAAnB,CAAkCzF,QAAlC;CACA,SAfF;CAiBA,OAlBM,CAAP;CAmBA;CA3UF;CAAA;CAAA,wCA8UC;CAAA;;CACC,aAAO,IAAIR,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvCC,QAAAA,GAAG,CAACC,EAAJ,CAAOC,IAAP,CAAYC,SAAZ,CACC,iCADD,EAEC;CACCP,UAAAA,IAAI,EAAE;CACLiC,YAAAA,OAAO,EAAE,OAAI,CAACA,OADT;CAELyC,YAAAA,MAAM,EAAE,OAAI,CAACA;CAFR;CADP,SAFD,EASElE,IATF,CASO,UAACC,QAAD,EAAc;CACnB,UAAA,OAAI,CAACqC,QAAL,GAAgBrC,QAAQ,CAACT,IAAzB;CACAE,UAAAA,OAAO,CAAC,OAAI,CAAC+G,UAAL,EAAD,CAAP;CACA,SAZF,EAaEhB,KAbF,CAaQ,UAACxF,QAAD,EAAc;CACpB,UAAA,OAAI,CAAC2B,aAAL,CAAmB8D,cAAnB,CAAkCzF,QAAlC;CACA,SAfF;CAiBA,OAlBM,CAAP;CAmBA;CAlWF;CAAA;CAAA,sCAoWmB8E,IApWnB,EAqWC;CAAA;;CACC,aAAO,IAAItF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvCC,QAAAA,GAAG,CAACC,EAAJ,CAAOC,IAAP,CAAYC,SAAZ,CACC,sCADD,EAEC;CACCP,UAAAA,IAAI,EAAE;CACLiC,YAAAA,OAAO,EAAE,OAAI,CAACA,OADT;CAELE,YAAAA,MAAM,EAAEoD,IAAI,CAAC9C;CAFR;CADP,SAFD,EASEjC,IATF,CASO,UAACC,QAAD,EAAc;CACnB,UAAA,OAAI,CAACyG,SAAL,GAAiBvG,cAAI,CAACC,WAAL,CAAiBH,QAAQ,CAACT,IAAT,CAAcmH,IAA/B,IAAuC,EAAvC,GAA4C1G,QAAQ,CAACT,IAAT,CAAcmH,IAA3E;CACAjH,UAAAA,OAAO,CAAC,OAAI,CAACkH,cAAL,CAAoB7B,IAApB,CAAD,CAAP;CACA,SAZF,EAaEU,KAbF,CAaQ,UAACxF,QAAD,EAAc;CACpB,UAAA,OAAI,CAAC2B,aAAL,CAAmB8D,cAAnB,CAAkCzF,QAAlC;CACA,SAfF;CAiBA,OAlBM,CAAP;CAmBA;CAzXF;CAAA;CAAA,wCA4XC;CAAA;;CACC,aAAO,IAAIR,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvC,QAAA,OAAI,CAACmF,OAAL,GAAe9E,IAAf,CAAoB,UAACC,QAAD,EAAc;CACjC,cAAM8E,IAAc,GAAG9E,QAAQ,CAACT,IAAhC;CACAI,UAAAA,GAAG,CAACC,EAAJ,CAAOC,IAAP,CAAYC,SAAZ,CACC,8CADD,EAEC;CACCP,YAAAA,IAAI,EAAE;CACLiC,cAAAA,OAAO,EAAE,OAAI,CAACA,OADT;CAEL8E,cAAAA,QAAQ,EAAE,OAAI,CAACtE,EAFV;CAGLN,cAAAA,MAAM,EAAEoD,IAAI,CAAC9C,EAHR;CAILsC,cAAAA,IAAI,EAAEQ,IAAI,CAAC8B;CAJN;CADP,WAFD,EAWE7G,IAXF,CAWO,UAACC,QAAD,EAAc;CACnB,YAAA,OAAI,CAAC6G,WAAL,GAAmB/B,IAAnB;CACA,YAAA,OAAI,CAAC1C,QAAL,GAAgBpC,QAAQ,CAACT,IAAzB;CACAE,YAAAA,OAAO,CAAC,OAAI,CAACqH,cAAL,CAAoBhC,IAApB,CAAD,CAAP;CACA,WAfF,EAgBEU,KAhBF,CAgBQ,UAACxF,QAAD,EAAc;CACpB,YAAA,OAAI,CAAC2B,aAAL,CAAmB8D,cAAnB,CAAkCzF,QAAlC;CACA,WAlBF;CAoBA,SAtBD;CAuBA,OAxBM,CAAP;CAyBA;CAtZF;CAAA;CAAA,8BAyZC;CAAA;;CACC,aAAO,IAAIR,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvCG,QAAAA,cAAI,CAACC,SAAL,CACC,iCADD,EAEC;CACCP,UAAAA,IAAI,EAAE;CACLiC,YAAAA,OAAO,EAAE,OAAI,CAACA,OADT;CAELE,YAAAA,MAAM,EAAE,OAAI,CAACA;CAFR;CADP,SAFD,EAQE3B,IARF,CAQON,OARP,EAQgBC,MARhB;CASA,OAVM,CAAP;CAWA;CAraF;CAAA;CAAA,kCAuaeqH,KAvaf,EAwaC;CACC,WAAKhF,SAAL,GAAiBgF,KAAK,CAACC,SAAN,EAAjB;CAEA,WAAK7E,IAAL,GAAY,KAAKJ,SAAL,CAAekF,YAAf,GAA8BC,aAA9B,CAA4C,wBAA5C,CAAZ;CAEA,UAAMC,oBAAoB,GAAG,KAAKhF,IAAL,CAAU+E,aAAV,CAAwB,oCAAxB,CAA7B;;CAEA,UAAIhH,cAAI,CAACC,WAAL,CAAiB,KAAKiC,QAAL,CAAcsE,IAA/B,CAAJ,EACA;CACC;CACA;;CAED,WAAKU,YAAL,CAAkBD,oBAAlB;CACA;CArbF;CAAA;CAAA,oCAwbC;CAAA;;CACCtH,MAAAA,cAAI,CAACC,SAAL,CACC,oCADD,EAEC;CACCP,QAAAA,IAAI,EAAE,KAAK8H,cAAL;CADP,OAFD,EAMEtH,IANF,CAMO,UAACC,QAAD,EAA6B;CAClC,QAAA,OAAI,CAAC+B,SAAL,CAAeiD,KAAf,CAAqB,KAArB,EAA4B,YAAM;CACjCC,UAAAA,6BAAY,CAACC,IAAb,CAAkB,OAAI,CAACC,iBAAL,KAA2B,GAA3B,GAAiC,UAAnD,EAA+DnF,QAAQ,CAACT,IAAxE;CACA,SAFD;CAGA,OAVF,EAWEiG,KAXF,CAWQ,UAACxF,QAAD,EAAc;CACpB,QAAA,OAAI,CAAC2B,aAAL,CAAmB8D,cAAnB,CAAkCzF,QAAlC;CACA,OAbF;CAeA;CAxcF;CAAA;CAAA,+BA0cY+G,KA1cZ,EA2cC;CAAA;;CACC,WAAKhF,SAAL,GAAiBgF,KAAK,CAACC,SAAN,EAAjB;CAEA,UAAMM,aAAa,GAAG,KAAKvF,SAAL,CAAekF,YAAf,GAA8BC,aAA9B,CAA4C,wBAA5C,CAAtB;;CAEA,UAAIhH,cAAI,CAACC,WAAL,CAAiB,KAAKkC,QAAL,CAAcqE,IAA/B,CAAJ,EACA;CACCa,QAAAA,aAAG,CAACC,MAAJ,CAAW,KAAKC,eAAL,EAAX,EAAmCH,aAAnC;CAEA1B,QAAAA,eAAK,CAACtC,IAAN,CACCgE,aAAa,CAACJ,aAAd,CAA4B,iCAA5B,CADD,EAEC,OAFD,EAGC,KAAKzE,WAAL,CAAiBa,IAAjB,CAAsB,IAAtB,CAHD;CAKA,OATD,MAWA;CACC3D,QAAAA,GAAG,CAACC,EAAJ,CAAO8H,OAAP,CAAehB,IAAf,CAAoBY,aAApB,EAAmC,KAAKjF,QAAL,CAAcqE,IAAjD,EACE3G,IADF,CACO,YAAM;CACXJ,UAAAA,GAAG,CAACC,EAAJ,CAAO+H,cAAP,CACC,qBADD,EAEC,OAAI,CAACC,mBAAL,CAAyBtE,IAAzB,CAA8B,OAA9B,CAFD;;CAIA,UAAA,OAAI,CAACuE,eAAL,CAAqBP,aAArB;CACA,SAPF;CASA;CACD;CAteF;CAAA;CAAA,mCAwegBP,KAxehB,EAyeC;CACC,WAAKhF,SAAL,GAAiBgF,KAAK,CAACC,SAAN,EAAjB;;CAEA,UAAI,KAAKP,SAAT,EACA;CACC,YAAMqB,cAAc,GAAG,KAAK/F,SAAL,CAAekF,YAAf,GAA8BC,aAA9B,CAA4C,8BAA5C,CAAvB;CAEAQ,QAAAA,iBAAO,CAAChB,IAAR,CAAaoB,cAAb,EAA6B,KAAKrB,SAAlC;CACA;CACD;CAlfF;CAAA;CAAA,mCAofgBM,KApfhB,EAqfC;CACC,WAAKhF,SAAL,GAAiBgF,KAAK,CAACC,SAAN,EAAjB;CAEA,WAAK7E,IAAL,GAAY,KAAKJ,SAAL,CAAekF,YAAf,GAA8BC,aAA9B,CAA4C,wBAA5C,CAAZ;CAEA,UAAMC,oBAAoB,GAAG,KAAKhF,IAAL,CAAU+E,aAAV,CAAwB,oCAAxB,CAA7B;;CAEA,UAAIhH,cAAI,CAACC,WAAL,CAAiB,KAAKiC,QAAL,CAAcsE,IAA/B,CAAJ,EACA;CACC;CACA;;CAED,WAAKU,YAAL,CAAkBD,oBAAlB;CACA;CAlgBF;CAAA;CAAA,qCAqgBC;CAAA;;CACCtH,MAAAA,cAAI,CAACC,SAAL,CACC,kCADD,EAEC;CACCP,QAAAA,IAAI,EAAE,KAAK8H,cAAL;CADP,OAFD,EAMEtH,IANF,CAMO,UAACC,QAAD,EAA6B;CAClC,QAAA,OAAI,CAAC+B,SAAL,CAAeiD,KAAf,CAAqB,KAArB,EAA4B,YAAM;CACjCrF,UAAAA,GAAG,CAACC,EAAJ,CAAOgG,KAAP,CAAaX,YAAb,CAA0BC,IAA1B,CAA+B,OAAI,CAACC,iBAAL,KAA2B,GAA3B,GAAiC,WAAhE,EAA6EnF,QAAQ,CAACT,IAAtF;CACA,SAFD;CAGA,OAVF,EAWEiG,KAXF,CAWQ,UAACxF,QAAD,EAAc;CACpB,QAAA,OAAI,CAAC2B,aAAL,CAAmB8D,cAAnB,CAAkCzF,QAAlC;CACA,OAbF;CAeA;CArhBF;CAAA;CAAA,wCAuhBqB+H,UAvhBrB,EAuhBiCC,SAvhBjC,EAwhBC;CACC;CACAA,MAAAA,SAAS,CAACC,MAAV,GAAmBrI,EAAE,CAACsI,aAAH,EAAnB;CACA;;CAEAF,MAAAA,SAAS,CAACG,MAAV,GAAmB,MAAnB;;CAEA,UAAI,CAACH,SAAS,CAACI,GAAf,EACA;CACCJ,QAAAA,SAAS,CAACI,GAAV,GAAgB,KAAKC,UAAL,EAAhB;CACA;;CAEDL,MAAAA,SAAS,CAACzI,IAAV,iCACIyI,SAAS,CAACzI,IADd;CAECiC,QAAAA,OAAO,EAAE,KAAKA,OAFf;CAGCyC,QAAAA,MAAM,EAAE,KAAKA;CAHd;CAKA;CAziBF;CAAA;CAAA,iCA4iBC;CACC,aAAO,uEAAP;CACA;CA9iBF;CAAA;CAAA,oCAijBC;CACC,aAAOqE,aAAG,CAACC,MAAX,4PAGK,KAAKC,eAAL,CAAqB,EAArB,EAAyB,KAAKjG,YAA9B,CAHL,EAIK,KAAKkG,sBAAL,EAJL;CAQA;CA1jBF;CAAA;CAAA,iCA6jBC;CACC,aAAOH,aAAG,CAACC,MAAX;CACA;CA/jBF;CAAA;CAAA,mCAikBgBzD,IAjkBhB,EAkkBC;CACC,aAAOwD,aAAG,CAACC,MAAX,q6BAKOtG,cAAI,CAACyG,MAAL,CAAY5D,IAAI,CAAC6D,IAAjB,CALP,EAU2B1G,cAAI,CAACyG,MAAL,CAAY5D,IAAI,CAACP,KAAjB,CAV3B,EAgBOO,IAAI,CAAC8B,WAhBZ;CAuBA;CA1lBF;CAAA;CAAA,mCA4lBgB9B,IA5lBhB,EA6lBC;CACC,WAAKtC,aAAL,GAAqBsC,IAAI,CAACP,KAA1B;CAEA,aAAO+D,aAAG,CAACC,MAAX,8PAGK,KAAKC,eAAL,CAAqB1D,IAAI,CAAC6D,IAA1B,EAAgC,KAAKnG,aAArC,CAHL,EAIK,KAAKiG,sBAAL,EAJL;CAQA;CAxmBF;CAAA;CAAA,oCA0mBiBE,IA1mBjB,EA0mB+BpE,KA1mB/B,EA2mBC;CAAA;;CACC,UAAMqE,SAAS,GAAGN,aAAG,CAACC,MAAP,ouBAG4BtG,cAAI,CAACyG,MAAL,CAAYC,IAAZ,CAH5B,EAKR7H,aAAG,CAACC,UAAJ,CAAe,8CAAf,CALQ,EAUUkB,cAAI,CAACyG,MAAL,CAAYnE,KAAZ,CAVV,CAAf;CAiBA,UAAMsE,eAAe,GAAGD,SAAS,CAAC1B,aAAV,CAAwB,gCAAxB,CAAxB;CAEAtB,MAAAA,eAAK,CAACtC,IAAN,CAAWuF,eAAX,EAA4B,OAA5B,EAAqC,YAAM;CAC1C,YAAMC,SAAS,GAAGD,eAAe,CAAC3B,aAAhB,CAA8B,wCAA9B,CAAlB;;CACA,YAAM6B,MAAM,GAAG,OAAI,CAACC,cAAL,CAAoBF,SAApB,CAAf;;CACAC,QAAAA,MAAM,CAAClG,IAAP;CACA,OAJD;CAMA,aAAO+F,SAAP;CACA;CAtoBF;CAAA;CAAA,6CAyoBC;CACC,aAAON,aAAG,CAACC,MAAX;CAKA;CA/oBF;CAAA;CAAA,iCAipBcU,SAjpBd,EAkpBC;CAAA;;CACCC,MAAAA,UAAU,CAAC,YAAM;CAChBvJ,QAAAA,GAAG,CAACC,EAAJ,CAAO8H,OAAP,CAAehB,IAAf,CAAoBuC,SAApB,EAA+B,OAAI,CAAC7G,QAAL,CAAcsE,IAA7C,EACE3G,IADF,CACO,YAAM;CACX,cAAIoJ,MAAM,CAACxJ,GAAP,CAAWyJ,WAAf,EACA;CACC,YAAA,OAAI,CAAC9G,aAAL,GAAqB6G,MAAM,CAACxJ,GAAP,CAAWyJ,WAAX,CAAuBC,UAAvB,CAAkC,OAAI,CAACrH,EAAvC,CAArB;CAEAiD,YAAAA,6BAAY,CAACC,IAAb,CAAkB,OAAI,CAAC5C,aAAL,CAAmBgH,SAArC,EAAgD,WAAhD,EAA6D,CAAC,IAAD,CAA7D;;CAEA,gBAAMnC,oBAAoB,GAAG,OAAI,CAAChF,IAAL,CAAU+E,aAAV,CAAwB,oCAAxB,CAA7B;CACA;;CACD,UAAA,OAAI,CAACqC,WAAL;CACA,SAXF;CAaA,OAdS,EAcP,GAdO,CAAV;CAeA;CAlqBF;CAAA;CAAA,sCAqqBC;CACC,aAAOjB,aAAG,CAACC,MAAX,83CAGKzH,aAAG,CAACC,UAAJ,CAAe,qCAAf,CAHL,EAaKD,aAAG,CAACC,UAAJ,CAAe,sCAAf,CAbL,EAiBMD,aAAG,CAACC,UAAJ,CAAe,iDAAf,CAjBN;CAsBA;CA5rBF;CAAA;CAAA,8BA+rBC;CACC;CACA,UAAIpB,GAAG,CAACC,EAAJ,IAAUD,GAAG,CAACC,EAAJ,CAAO4J,IAAjB,IAAyB7J,GAAG,CAACC,EAAJ,CAAO4J,IAAP,CAAYC,WAAzC,EACA;CACC,eAAO9J,GAAG,CAACC,EAAJ,CAAO4J,IAAP,CAAYC,WAAZ,CAAwBC,OAAxB,CAAgC,KAAKzF,MAArC,CAAP;CACA;CACD;;;CAEA,aAAO,IAAP;CACA;CAxsBF;CAAA;CAAA,oCA0sBiBgF,SA1sBjB,EA2sBC;CAAA;;CACC,UAAMU,cAAc,GAAGV,SAAS,CAACW,gBAAV,CAA2B,6BAA3B,CAAvB;CAEAD,MAAAA,cAAc,CAACxD,OAAf,CAAuB,UAAC0D,aAAD,EAAmB;CACzC,YAAMC,IAAI,GAAG,OAAI,CAACC,eAAL,CAAqBF,aAArB,CAAb;;CACAtC,QAAAA,aAAG,CAACyC,KAAJ,CAAUH,aAAV;CACAC,QAAAA,IAAI,CAAC3D,OAAL,CAAa,UAAC8D,GAAD,EAAS;CACrB1C,UAAAA,aAAG,CAACC,MAAJ,CAAW,OAAI,CAAC0C,UAAL,CAAgBD,GAAhB,CAAX,EAAiCJ,aAAjC;CACA,SAFD;CAGA,OAND;CAOA;CArtBF;CAAA;CAAA,oCAutBiBM,IAvtBjB,EAwtBC;CACC,UAAML,IAAI,GAAG,EAAb;CAEAK,MAAAA,IAAI,CAACC,UAAL,CAAgBjE,OAAhB,CAAwB,UAACkE,SAAD,EAAe;CACtCP,QAAAA,IAAI,CAACQ,IAAL,CAAUD,SAAS,CAACE,WAAV,CAAsBC,IAAtB,EAAV;CACA,OAFD;CAIA,aAAOV,IAAP;CACA;CAhuBF;CAAA;CAAA,+BAkuBYG,GAluBZ,EAmuBC;CAAA;;CACC,UAAMQ,QAAQ,GAAG,IAAIC,cAAJ,CAAU;CAC1BpG,QAAAA,IAAI,EAAE2F,GADoB;CAE1B1F,QAAAA,KAAK,EAAEmG,cAAK,CAAClG,KAAN,CAAYmG,SAFO;CAG1BC,QAAAA,IAAI,EAAE,IAHoB;CAI1BC,QAAAA,IAAI,EAAEH,cAAK,CAACI,IAAN,CAAWC,EAJS;CAK1BC,QAAAA,WAAW,EAAE;CALa,OAAV,CAAjB;CAOA,UAAM/B,SAAS,GAAGwB,QAAQ,CAACxD,YAAT,EAAlB;CAEArB,MAAAA,eAAK,CAACtC,IAAN,CAAW2F,SAAX,EAAsB,OAAtB,EAA+B,YAAM;CACpC,QAAA,OAAI,CAAClH,SAAL,CAAeiD,KAAf,CAAqB,KAArB,EAA4B,YAAM;CACjCC,UAAAA,6BAAY,CAACC,IAAb,CAAkB,OAAI,CAACC,iBAAL,KAA2B,GAA3B,GAAiC,aAAnD,EAAkE8E,GAAlE;CACA,SAFD;CAGA,OAJD;CAMA,aAAOhB,SAAP;CACA;CApvBF;CAAA;CAAA,mCAsvBgBH,SAtvBhB,EAuvBC;CAAA;;CACC;CACA,aAAO,IAAInJ,GAAG,CAACC,EAAJ,CAAOqL,WAAX,CAAuB;CAC7BC,QAAAA,WAAW,EAAEpC,SADgB;CAE7BvG,QAAAA,YAAY,EAAE,KAAKA,YAFU;CAG7BC,QAAAA,aAAa,EAAE,KAAKA,aAAL,GAAqB,KAAKA,aAA1B,GAA0C,KAAKD,YAHjC;CAI7B4I,QAAAA,eAAe,EAAE,yBAAC5G,KAAD,EAAQwE,MAAR,EAAmB;CACnC,UAAA,OAAI,CAACvG,aAAL,GAAqB+B,KAArB;CACAuE,UAAAA,SAAS,CAACsC,KAAV,CAAgBC,eAAhB,GAAkC9G,KAAlC;CACA,SAP4B;CAQ7B+G,QAAAA,YAAY,EAAE;CACbC,UAAAA,SAAS,EAAE;CADE,SARe;CAW7BC,QAAAA,gBAAgB,EAAE,KAXW;CAY7BC,QAAAA,MAAM,EAAE,CACP,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,EAAwD,SAAxD,EAAmE,SAAnE,EAA8E,SAA9E,CADO,EAEP,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,EAAwD,SAAxD,EAAmE,SAAnE,EAA8E,SAA9E,CAFO;CAZqB,OAAvB,CAAP;CAiBA;CACA;CA3wBF;CAAA;CAAA,kCA8wBC;CAAA;;CACCvC,MAAAA,UAAU,CAAC,YAAM;CAChB,QAAA,OAAI,CAAC/G,IAAL,CAAU+E,aAAV,CAAwB,6CAAxB,EAAuEwE,KAAvE;CACA,OAFS,EAEP,EAFO,CAAV;CAGA;CAlxBF;CAAA;CAAA,qCAqxBC;CACC,UAAMC,WAAW,GAAG,EAApB;;CAEA,UAAI,KAAK9E,WAAT,EACA;CACC8E,QAAAA,WAAW,CAACjK,MAAZ,GAAqB,KAAKmF,WAAL,CAAiB7E,EAAtC;CACA;;CAED2J,MAAAA,WAAW,CAACnK,OAAZ,GAAsB,KAAKA,OAA3B;CACAmK,MAAAA,WAAW,CAAChD,IAAZ,GAAoB,KAAKxG,IAAL,CAAU+E,aAAV,CAAwB,aAAxB,EAAuC0E,KAAxC,CAA+CpB,IAA/C,EAAnB;CACAmB,MAAAA,WAAW,CAAC/E,WAAZ,GAA0B,KAAKtE,aAAL,CAAmBuJ,SAAnB,GAA+BC,UAA/B,EAA1B;CACAH,MAAAA,WAAW,CAACpH,KAAZ,GAAoB,KAAK/B,aAAL,GAAqB,KAAKA,aAA1B,GAA0C,KAAKD,YAAnE;CACAoJ,MAAAA,WAAW,CAACI,KAAZ,GAAoB,KAAKC,mBAAL,EAApB;CAEA,aAAOL,WAAP;CACA;CApyBF;CAAA;CAAA,0CAuyBC;CAAA;;CACC,UAAMI,KAAK,GAAG,EAAd;;CAEA,UACC,CAAC,KAAKzJ,aAAN,IACG,CAACpC,cAAI,CAAC+L,aAAL,CAAmB,KAAK3J,aAAL,CAAmB4J,OAAtC,CADJ,IAEG,CAAChM,cAAI,CAAC+L,aAAL,CAAmB,KAAK3J,aAAL,CAAmB6J,WAAtC,CAHL,EAKA;CACC,eAAOJ,KAAP;CACA;;CAED,UAAMK,eAAe,GAAG,EAAxB;CACAC,MAAAA,MAAM,CAACC,MAAP,CAAc,KAAKhK,aAAL,CAAmB4J,OAAjC,EACE/F,OADF,CACU,UAAC9G,UAAD,EAAgB;CACxB,YAAG,CAAC+M,eAAe,CAACG,QAAhB,CAAyBlN,UAAzB,CAAJ,EACA;CACC+M,UAAAA,eAAe,CAAC9B,IAAhB,CAAqBjL,UAArB;CACA;CACD,OANF;CASA+M,MAAAA,eAAe,CAACjG,OAAhB,CAAwB,UAACqG,cAAD,EAAoB;CAC3C,YACC,OAAI,CAAClK,aAAL,CAAmB6J,WAAnB,CAA+BK,cAA/B,KACGtM,cAAI,CAAC+L,aAAL,CAAmB,OAAI,CAAC3J,aAAL,CAAmB6J,WAAnB,CAA+BK,cAA/B,EAA+CF,MAAlE,CAFJ,EAIA;CACCD,UAAAA,MAAM,CAACI,IAAP,CAAY,OAAI,CAACnK,aAAL,CAAmB6J,WAAnB,CAA+BK,cAA/B,EAA+CF,MAA3D,EACEnG,OADF,CACU,UAACuG,MAAD,EAAY;CACpB,gBAAI,CAACX,KAAK,CAACQ,QAAN,CAAeG,MAAf,CAAL,EACA;CACCX,cAAAA,KAAK,CAACzB,IAAN,CAAWoC,MAAX;CACA;CACD,WANF;CAQA;CACD,OAfD;CAiBA,aAAOX,KAAP;CACA;CA/0BF;CAAA;CAAA,6BAoDiBvK,OApDjB,EAoDkCE,MApDlC,EAqDC;CACC,UAAMoD,IAAI,GAAG,IAAI1D,IAAJ,CAAS;CACrBG,QAAAA,IAAI,EAAE,MADe;CAErBC,QAAAA,OAAO,EAAEA,OAFY;CAGrBE,QAAAA,MAAM,EAAEA;CAHa,OAAT,CAAb;CAMAoD,MAAAA,IAAI,CAAC6H,IAAL;CACA;CA7DF;CAAA;CAAA,6BA+DiBnL,OA/DjB,EA+DkCE,MA/DlC,EAgEC;CACC,UAAMoD,IAAI,GAAG,IAAI1D,IAAJ,CAAS;CACrBG,QAAAA,IAAI,EAAE,MADe;CAErBC,QAAAA,OAAO,EAAEA,OAFY;CAGrBE,QAAAA,MAAM,EAAEA;CAHa,OAAT,CAAb;CAMAoD,MAAAA,IAAI,CAAC6H,IAAL;CACA;CAxEF;CAAA;CAAA,+BA0EmBnL,OA1EnB,EA0EoCE,MA1EpC,EA2EC;CACC,UAAMoD,IAAI,GAAG,IAAI1D,IAAJ,CAAS;CACrBG,QAAAA,IAAI,EAAE,MADe;CAErBC,QAAAA,OAAO,EAAEA,OAFY;CAGrBE,QAAAA,MAAM,EAAEA;CAHa,OAAT,CAAb;CAMAoD,MAAAA,IAAI,CAAC8H,UAAL,GACE7M,IADF,CACO,YAAM;CACX+E,QAAAA,IAAI,CAACa,eAAL;CACA,OAHF;CAKA;CAvFF;CAAA;CAAA,EAA0BV,6BAA1B;;;;;;;;"}