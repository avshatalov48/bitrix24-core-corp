{"version":3,"file":"task.status.bundle.js","sources":["../src/request.sender.js","../src/task.status.js"],"sourcesContent":["import {Loc, Type, ajax} from 'main.core';\n\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tneedUpdateTask(data): Promise\n\t{\n\t\treturn this.sendRequest('task', 'needUpdateTaskStatus', data);\n\t}\n\n\tgetTasks(data): Promise\n\t{\n\t\treturn this.sendRequest('task', 'getTasks', data);\n\t}\n\n\tcompleteTask(data): Promise\n\t{\n\t\treturn this.sendRequest('task', 'completeTask', data);\n\t}\n\n\trenewTask(data): Promise\n\t{\n\t\treturn this.sendRequest('task', 'renewTask', data);\n\t}\n\n\tproceedParentTask(data): Promise\n\t{\n\t\treturn this.sendRequest('task', 'proceedParentTask', data);\n\t}\n\n\tisParentScrumTask(data): Promise\n\t{\n\t\treturn this.sendRequest('task', 'isParentScrumTask', data);\n\t}\n\n\tgetData(data): Promise\n\t{\n\t\treturn this.sendRequest('task', 'getData', data);\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.error(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TST_ERROR_POPUP_TITLE'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Type, Loc, Text} from 'main.core';\n\nimport {MessageBox, MessageBoxButtons} from 'ui.dialogs.messagebox';\nimport {UI} from 'ui.notification';\n\nimport {Dod} from 'tasks.scrum.dod';\n\nimport {RequestSender} from './request.sender';\n\ntype State = {\n\ttaskId: number,\n\taction: 'complete' | 'renew',\n\tgroupId?: number,\n\tparentTaskId?: number,\n\tperformActionOnParentTask?: boolean\n}\n\ntype Task = {\n\tname: string\n}\n\nexport class TaskStatus\n{\n\tstatic actions = {\n\t\tcomplete: 'complete',\n\t\trenew: 'renew',\n\t\tproceed: 'proceed',\n\t\tskip: 'skip'\n\t};\n\n\tconstructor(state: State)\n\t{\n\t\tthis.setState(state);\n\n\t\tthis.requestSender = new RequestSender();\n\t}\n\n\tsetState(state: State)\n\t{\n\t\tthis.taskId = parseInt(state.taskId, 10);\n\t\tthis.action = (\n\t\t\tstate.action === TaskStatus.actions.complete\n\t\t\t\t? TaskStatus.actions.complete\n\t\t\t\t: TaskStatus.actions.renew\n\t\t);\n\t\tthis.groupId = Type.isUndefined(state.groupId) ? 0 : parseInt(state.groupId, 10);\n\t\tthis.parentTaskId = Type.isUndefined(state.parentTaskId) ? 0 : parseInt(state.parentTaskId, 10);\n\t\tthis.performActionOnParentTask = (\n\t\t\tType.isUndefined(state.performActionOnParentTask)\n\t\t\t\t? false\n\t\t\t\t: state.performActionOnParentTask\n\t\t);\n\t}\n\n\tupdateState(): Promise\n\t{\n\t\treturn this.requestSender.getData({\n\t\t\ttaskId: this.taskId\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tthis.setState(\n\t\t\t\t\t{\n\t\t\t\t\t\t...{\n\t\t\t\t\t\t\taction: this.action,\n\t\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\t\tparentTaskId: this.parentTaskId,\n\t\t\t\t\t\t\tperformActionOnParentTask: this.performActionOnParentTask\n\t\t\t\t\t\t},\n\t\t\t\t\t\t...response.data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\t}\n\n\tupdate(): Promise\n\t{\n\t\treturn this.requestSender.needUpdateTask({\n\t\t\ttaskId: this.parentTaskId,\n\t\t\taction: this.action\n\t\t})\n\t\t\t.then((response) => response.data === true)\n\t\t\t.then((needUpdate: boolean) => {\n\t\t\t\tif (needUpdate)\n\t\t\t\t{\n\t\t\t\t\treturn this.requestSender.getTasks({\n\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\ttaskIds: [this.parentTaskId, this.taskId]\n\t\t\t\t\t})\n\t\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t\tconst tasks = response.data;\n\n\t\t\t\t\t\t\treturn this.showMessage(\n\t\t\t\t\t\t\t\ttasks[this.parentTaskId],\n\t\t\t\t\t\t\t\ttasks[this.taskId]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn TaskStatus.actions.skip;\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tif (this.performActionOnParentTask)\n\t\t\t\t{\n\t\t\t\t\tswitch (response)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase TaskStatus.actions.complete:\n\t\t\t\t\t\t\treturn this.completeTask(this.parentTaskId)\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\t\t\tcontent: Loc.getMessage('TST_PARENT_COMPLETE_NOTIFY')\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\treturn response;\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\tcase TaskStatus.actions.renew:\n\t\t\t\t\t\t\treturn this.renewTask(this.parentTaskId)\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\t\t\tcontent: Loc.getMessage('TST_PARENT_RENEW_NOTIFY')\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\treturn response;\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\tcase TaskStatus.actions.proceed:\n\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: Loc.getMessage('TST_PARENT_PROCEED_NOTIFY')\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn response;\n\t\t\t\t\t\tcase TaskStatus.actions.skip:\n\t\t\t\t\t\t\treturn response;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn response;\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => this.requestSender.showErrorAlert(response))\n\t\t;\n\t}\n\n\tisParentScrumTask(taskId?: number): Promise\n\t{\n\t\ttaskId = Type.isUndefined(taskId) ? this.parentTaskId : taskId;\n\t\tif (!taskId)\n\t\t{\n\t\t\treturn new Promise((resolve) => resolve(false));\n\t\t}\n\n\t\treturn this.requestSender.isParentScrumTask({\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: taskId\n\t\t})\n\t\t\t.then((response) => response.data === true)\n\t\t;\n\t}\n\n\tshowMessage(parentTask: Task, task: Task): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst isCompleteAction = (this.action === TaskStatus.actions.complete);\n\n\t\t\t(new MessageBox({\n\t\t\t\tminWidth: 300,\n\t\t\t\tmessage: isCompleteAction\n\t\t\t\t\t? Loc.getMessage('TST_PARENT_COMPLETE_MESSAGE')\n\t\t\t\t\t\t.replace(/#name#/g, Text.encode(parentTask.name))\n\t\t\t\t\t: Loc.getMessage('TST_PARENT_RENEW_MESSAGE')\n\t\t\t\t\t\t.replace(\"#name#\", Text.encode(parentTask.name))\n\t\t\t\t\t\t.replace(\"#sub-name#\", Text.encode(task.name))\n\t\t\t\t,\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\tokCaption: isCompleteAction\n\t\t\t\t\t? Loc.getMessage('TST_PARENT_COMPLETE_OK_CAPTION')\n\t\t\t\t\t: Loc.getMessage('TST_PARENT_RENEW_OK_CAPTION')\n\t\t\t\t,\n\t\t\t\tcancelCaption: isCompleteAction\n\t\t\t\t\t? Loc.getMessage('TST_PARENT_PROCEED_CAPTION')\n\t\t\t\t\t: Loc.getMessage('TST_PARENT_RENEW_CANCEL_CAPTION')\n\t\t\t\t,\n\t\t\t\tonOk: (messageBox) => {\n\t\t\t\t\tif (isCompleteAction)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showDod(this.parentTaskId)\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tmessageBox.close();\n\n\t\t\t\t\t\t\t\tresolve(TaskStatus.actions.complete);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t\t\tmessageBox.getOkButton().setDisabled(false);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tmessageBox.close();\n\n\t\t\t\t\t\tresolve(TaskStatus.actions.renew);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonCancel: (messageBox) => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t\tif (isCompleteAction)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.proceedParentTask(this.parentTaskId)\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tresolve(TaskStatus.actions.proceed);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve(TaskStatus.actions.skip);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t})).show();\n\t\t});\n\t}\n\n\tshowDod(taskId: number): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst dod = new Dod({\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\ttaskId: taskId\n\t\t\t})\n\n\t\t\tdod.subscribe('resolve', () => resolve());\n\t\t\tdod.subscribe('reject', () => reject());\n\n\t\t\tdod.isNecessary()\n\t\t\t\t.then((isNecessary) => {\n\t\t\t\t\tif (isNecessary)\n\t\t\t\t\t{\n\t\t\t\t\t\tdod.showList();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tcompleteTask(taskId: number): Promise\n\t{\n\t\treturn this.requestSender.completeTask({\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: taskId\n\t\t});\n\t}\n\n\trenewTask(taskId: number): Promise\n\t{\n\t\treturn this.requestSender.renewTask({\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: taskId\n\t\t});\n\t}\n\n\tproceedParentTask(taskId: number): Promise\n\t{\n\t\treturn this.requestSender.proceedParentTask({\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: taskId\n\t\t});\n\t}\n}"],"names":["RequestSender","controller","action","data","Promise","resolve","reject","ajax","runAction","then","sendRequest","response","alertTitle","Type","isUndefined","errors","console","error","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","TaskStatus","state","setState","requestSender","taskId","parseInt","actions","complete","renew","groupId","parentTaskId","performActionOnParentTask","getData","needUpdateTask","needUpdate","getTasks","taskIds","tasks","showMessage","skip","completeTask","UI","Notification","Center","notify","content","renewTask","proceed","showErrorAlert","isParentScrumTask","parentTask","task","isCompleteAction","minWidth","replace","Text","encode","name","buttons","MessageBoxButtons","OK_CANCEL","okCaption","cancelCaption","onOk","messageBox","showDod","close","getOkButton","setDisabled","onCancel","proceedParentTask","show","dod","Dod","subscribe","isNecessary","showList"],"mappings":"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"}