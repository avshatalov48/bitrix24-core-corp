{"version":3,"file":"dod.bundle.js","sources":["../src/item.type.js","../src/type.storage.js","../src/tabs.js","../src/request.sender.js","../src/settings.js","../src/list.js","../src/dod.js"],"sourcesContent":["import {Text, Type} from 'main.core';\n\nexport type ItemTypeParams = {\n\tid?: number | string,\n\tname?: string,\n\tsort?: number,\n\tdodRequired?: 'Y' | 'N',\n\tparticipants: Array<Participant>\n}\n\nexport type Participant = {\n\tid: number | string,\n\tentityId: string\n}\n\nexport class ItemType\n{\n\tconstructor(params: ItemTypeParams = {})\n\t{\n\t\tthis.setId(params.id);\n\t\tthis.setName(params.name);\n\t\tthis.setSort(params.sort);\n\t\tthis.setDodRequired(params.dodRequired);\n\t\tthis.setParticipants(params.participants);\n\t}\n\n\tsetId(id: number)\n\t{\n\t\tthis.id = (\n\t\t\tType.isInteger(id)\n\t\t\t\t? parseInt(id, 10)\n\t\t\t\t: (Type.isString(id) && id) ? id : Text.getRandom()\n\t\t);\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetName(name: string)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : '');\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetSort(sort: number)\n\t{\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\t}\n\n\tgetSort(): number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetDodRequired(value: string)\n\t{\n\t\tthis.dodRequired = (value === 'Y');\n\t}\n\n\tisDodRequired(): boolean\n\t{\n\t\treturn this.dodRequired;\n\t}\n\n\tsetParticipants(participants: Array<Participant>)\n\t{\n\t\tthis.participants = [];\n\n\t\tif (!Type.isArray(participants))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparticipants\n\t\t\t.forEach((participant: Participant) => {\n\t\t\t\tthis.participants.push([participant.entityId, participant.id])\n\t\t\t})\n\t\t;\n\t}\n\n\tgetParticipants(): Array<Participant>\n\t{\n\t\treturn this.participants;\n\t}\n}","import {ItemType} from './item.type';\n\nexport class TypeStorage\n{\n\tsetTypes(types: Map<number, ItemType>)\n\t{\n\t\tthis.types = types;\n\t}\n\n\tgetNextType(): ItemType\n\t{\n\t\treturn this.types.values().next().value;\n\t}\n\n\tgetTypes(): Map<number, ItemType>\n\t{\n\t\treturn this.types;\n\t}\n\n\taddType(type: ItemType)\n\t{\n\t\tthis.types.set(type.getId(), type);\n\t}\n\n\tgetType(typeId: number): ?ItemType\n\t{\n\t\treturn this.types.get(typeId);\n\t}\n\n\tremoveType(type: ItemType)\n\t{\n\t\tthis.types.delete(type.getId());\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {MessageBox, MessageBoxButtons} from 'ui.dialogs.messagebox';\n\nimport {ItemType} from './item.type';\nimport {TypeStorage} from './type.storage';\n\nexport class Tabs extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Dod.Tabs');\n\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\n\t\tthis.tabNodes = new Map();\n\n\t\tthis.activeType = null;\n\t\tthis.previousType = null;\n\t}\n\n\tsetTypeStorage(typeStorage: TypeStorage)\n\t{\n\t\tthis.typeStorage = typeStorage;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst sidebarClass = 'tasks-scrum-dod-settings-container-sidebar'\n\t\t\t+ ' tasks-scrum-dod-settings-container-sidebar-settings';\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"${sidebarClass}\">\n\t\t\t\t${[...this.typeStorage.getTypes().values()].map((type: ItemType) => this.renderTab(type))}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.tabNodes.size === 0;\n\t}\n\n\trenderTab(type: ItemType): HTMLElement\n\t{\n\t\tif (this.isEmptyType(type))\n\t\t{\n\t\t\tconst addNode = Tag.render`\n\t\t\t\t<div class=\"sidebar-tab-link\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-name\">\n\t\t\t\t\t\t+ ${Loc.getMessage('TASKS_SCRUM_CREATE_TYPE')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(addNode, 'click', this.createType.bind(this));\n\n\t\t\treturn addNode;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst tabClass = this.isActiveType(type) ? 'sidebar-tab sidebar-tab-active' : 'sidebar-tab';\n\n\t\t\tconst tabNode = Tag.render`\n\t\t\t\t<div class=\"${tabClass}\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-name\">\n\t\t\t\t\t\t${Text.encode(type.getName())}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-edit\"></div>\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-remove\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.tabNodes.set(type.getId(), tabNode);\n\n\t\t\tEvent.bind(tabNode, 'click', (event) => {\n\t\t\t\tconst edit = Dom.hasClass(event.target, 'tasks-scrum-dod-settings-type-edit');\n\t\t\t\tconst remove = Dom.hasClass(event.target, 'tasks-scrum-dod-settings-type-remove');\n\t\t\t\tif (!this.isActiveType(type))\n\t\t\t\t{\n\t\t\t\t\tthis.switchType(type, tabNode);\n\t\t\t\t}\n\t\t\t\tif (edit)\n\t\t\t\t{\n\t\t\t\t\tthis.changeTypeName(type, tabNode);\n\t\t\t\t}\n\t\t\t\tif (remove)\n\t\t\t\t{\n\t\t\t\t\tthis.removeType(type, tabNode);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn tabNode;\n\t\t}\n\t}\n\n\taddType(newType: ItemType, tmpType?: ItemType)\n\t{\n\t\tif (tmpType)\n\t\t{\n\t\t\tDom.remove(this.tabNodes.get(tmpType.getId()));\n\t\t\tthis.tabNodes.delete(tmpType.getId());\n\t\t}\n\n\t\tconst node = this.renderTab(newType);\n\n\t\tDom.insertBefore(node, this.node.lastElementChild);\n\n\t\tthis.switchType(newType, node);\n\t}\n\n\tswitchType(type: ItemType, typeNode: HTMLElement, savePrevious: boolean = true)\n\t{\n\t\tthis.tabNodes.forEach((node: HTMLElement) => {\n\t\t\tDom.removeClass(node, 'sidebar-tab-active');\n\t\t});\n\n\t\tDom.addClass(typeNode, 'sidebar-tab-active');\n\n\t\tif (savePrevious && !this.isEmpty())\n\t\t{\n\t\t\tthis.setPreviousType(this.getActiveType());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.setPreviousType(null);\n\t\t}\n\n\t\tthis.setActiveType(type);\n\n\t\tthis.emit('switchType', type);\n\t}\n\n\tcreateType()\n\t{\n\t\tconst type = new ItemType();\n\t\ttype.setSort(this.typeStorage.getTypes().size);\n\n\t\tthis.tabNodes.forEach((node: HTMLElement) => {\n\t\t\tDom.removeClass(node, 'sidebar-tab-active');\n\t\t});\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"sidebar-tab sidebar-tab-active\">\n\t\t\t\t<input type=\"text\" class=\"tasks-scrum-dod-settings-type-name-input\">\n\t\t\t</div>\n\t\t`;\n\t\tconst nameNode = Tag.render`<div class=\"tasks-scrum-dod-settings-type-name\"></div>`;\n\n\t\tDom.insertBefore(node, this.node.lastElementChild);\n\n\t\tconst input = node.querySelector('input');\n\n\t\tEvent.bind(input, 'change', (event) => {\n\t\t\ttype.setName(event.target['value']);\n\t\t\tthis.emit('createType', type);\n\t\t\tnameNode.textContent = Text.encode(type.getName());\n\t\t\tDom.replace(input, nameNode);\n\t\t}, true);\n\n\t\tEvent.bind(input, 'blur', (event) => {\n\t\t\tif (event.target['value'].trim() === '')\n\t\t\t{\n\t\t\t\tDom.remove(node);\n\t\t\t}\n\t\t}, true);\n\n\t\tEvent.bind(input, 'keydown', (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t{\n\t\t\t\tinput.blur();\n\t\t\t}\n\t\t});\n\n\t\tinput.focus();\n\n\t\tthis.tabNodes.set(type.getId(), node);\n\t}\n\n\tchangeTypeName(type: ItemType, typeNode: HTMLElement)\n\t{\n\t\tconst inputNode = Tag.render`\n\t\t\t<input type=\"text\" class=\"tasks-scrum-dod-settings-type-name-input\" value=\"${Text.encode(type.getName())}\">\n\t\t`;\n\t\tconst nameNode = typeNode.querySelector('.tasks-scrum-dod-settings-type-name');\n\n\t\tEvent.bind(inputNode, 'change', (event) => {\n\t\t\ttype.setName(event.target['value'])\n\t\t\tthis.emit('changeTypeName', type);\n\t\t\tinputNode.blur();\n\t\t}, true);\n\n\t\tEvent.bind(inputNode, 'blur', () => {\n\t\t\tnameNode.textContent = Text.encode(type.getName());\n\t\t\tDom.replace(inputNode, nameNode);\n\t\t}, true);\n\n\t\tEvent.bind(inputNode, 'keydown', (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t{\n\t\t\t\tinputNode.blur();\n\t\t\t}\n\t\t});\n\n\t\tDom.replace(nameNode, inputNode);\n\n\t\tinputNode.focus();\n\t\tinputNode.setSelectionRange(type.getName().length, type.getName().length);\n\t}\n\n\tremoveType(type: ItemType, typeNode: HTMLElement)\n\t{\n\t\tconst popupOptions = {};\n\t\tconst currentSlider = this.sidePanelManager.getTopSlider();\n\t\tif (currentSlider)\n\t\t{\n\t\t\tpopupOptions.targetContainer = currentSlider.getContainer();\n\t\t}\n\n\t\t(new MessageBox({\n\t\t\tmessage: Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TYPE'),\n\t\t\tpopupOptions: popupOptions,\n\t\t\tokCaption: Loc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\tonOk: (messageBox) => {\n\t\t\t\tthis.tabNodes.delete(type.getId());\n\t\t\t\tif (this.isActiveType(type))\n\t\t\t\t{\n\t\t\t\t\tthis.setActiveType(null);\n\t\t\t\t}\n\t\t\t\tthis.setPreviousType(null);\n\t\t\t\tDom.remove(typeNode);\n\t\t\t\tthis.emit('removeType', type);\n\t\t\t\tmessageBox.close();\n\t\t\t}\n\t\t})).show();\n\t}\n\n\tsetActiveType(type: ?ItemType)\n\t{\n\t\tthis.activeType = type;\n\t}\n\n\tgetActiveType(): ?ItemType\n\t{\n\t\treturn this.activeType;\n\t}\n\n\tsetPreviousType(type: ?ItemType)\n\t{\n\t\tthis.previousType = type;\n\t}\n\n\tgetPreviousType(): ?ItemType\n\t{\n\t\treturn this.previousType;\n\t}\n\n\tisActiveType(type: ItemType): boolean\n\t{\n\t\treturn (\n\t\t\tthis.activeType\n\t\t\t&& this.activeType.getId() === type.getId()\n\t\t);\n\t}\n\n\tsetEmptyType(type: ItemType)\n\t{\n\t\tthis.emptyType = type;\n\t}\n\n\tisEmptyType(type: ItemType): boolean\n\t{\n\t\treturn type.getId() === this.emptyType.getId();\n\t}\n\n\tswitchToType(type: ItemType)\n\t{\n\t\tthis.switchType(type, this.tabNodes.get(type.getId()), false);\n\t}\n}","import {Loc, Type, ajax} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype RequestParams = {\n\tgroupId: number,\n\ttaskId: number,\n\ttypeId?: number\n}\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tisNecessary(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'isNecessary', data);\n\t}\n\n\tgetSettings(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'getSettings', data);\n\t}\n\n\tgetChecklist(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'getChecklist', data);\n\t}\n\n\tsaveSettings(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'saveSettings', data);\n\t}\n\n\tgetList(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'getList', data);\n\t}\n\n\tsaveList(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'saveList', data);\n\t}\n\n\tcreateType(data): Promise\n\t{\n\t\treturn this.sendRequest('type', 'createType', data);\n\t}\n\n\tchangeTypeName(data): Promise\n\t{\n\t\treturn this.sendRequest('type', 'changeTypeName', data);\n\t}\n\n\tremoveType(data): Promise\n\t{\n\t\treturn this.sendRequest('type', 'removeType', data);\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.error(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TSD_ERROR_POPUP_TITLE'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Dom, Tag, Type, Loc, Event, Runtime} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {TagSelector} from 'ui.entity-selector';\n\nimport {ItemType, ItemTypeParams} from './item.type';\nimport {TypeStorage} from './type.storage';\nimport {Tabs} from './tabs';\n\nimport {RequestSender} from './request.sender';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tgroupId: number,\n\ttaskId?: number\n}\n\nexport class Settings\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.taskId = parseInt(params.taskId, 10);\n\n\t\tthis.typeStorage = new TypeStorage();\n\t\tthis.tabs = new Tabs();\n\n\t\tthis.tabs.subscribe('switchType', this.onSwitchType.bind(this));\n\t\tthis.tabs.subscribe('createType', this.onCreateType.bind(this));\n\t\tthis.tabs.subscribe('changeTypeName', this.onChangeTypeName.bind(this));\n\t\tthis.tabs.subscribe('removeType', this.onRemoveType.bind(this));\n\n\t\tthis.changed = false;\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Tasks.CheckListItem:CheckListChanged',\n\t\t\t() => {\n\t\t\t\tthis.setChanged();\n\t\t\t}\n\t\t);\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.tabs.isEmpty();\n\t}\n\n\tisChanged(): boolean\n\t{\n\t\treturn this.changed;\n\t}\n\n\tsetChanged(): void\n\t{\n\t\tthis.changed = true;\n\t}\n\n\trenderContent(): Promise\n\t{\n\t\treturn this.requestSender.getSettings({\n\t\t\tgroupId: this.groupId\n\t\t})\n\t\t\t.then((response) => {\n\n\t\t\t\tconst types = Type.isArray(response.data.types) ? response.data.types : [];\n\n\t\t\t\tconst itemTypes = new Map();\n\n\t\t\t\ttypes.forEach((typeData: ItemTypeParams) => {\n\t\t\t\t\tconst itemType = new ItemType(typeData);\n\t\t\t\t\titemTypes.set(itemType.getId(), itemType);\n\t\t\t\t});\n\n\t\t\t\tthis.typeStorage.setTypes(itemTypes);\n\n\t\t\t\tthis.tabs.setTypeStorage(this.typeStorage);\n\t\t\t\tthis.tabs.setActiveType(this.typeStorage.getNextType());\n\n\t\t\t\tthis.addEmptyCreationType();\n\n\t\t\t\treturn this.render();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst currentType: ItemType = this.typeStorage.getNextType();\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-dod-settings\">\n\t\t\t\t<div class=\"tasks-scrum-dod-settings-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-wrap\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-shell\">\n\t\t\t\t\t\t\t${this.tabs.render()}\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-sidebar-wrapper\">\n\t\t\t\t\t\t\t\t${this.renderContainer(currentType)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\trenderContainer(type: ItemType): HTMLElement\n\t{\n\t\tif (this.tabs.isEmpty())\n\t\t{\n\t\t\treturn this.renderEmptyForm();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.renderEditingForm(type);\n\t\t}\n\t}\n\n\trenderEditingForm(type: ItemType): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t${this.renderRequiredOption(type)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t${this.renderParticipantsSelector()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content ui-form-content-dod-list\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEmptyForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_CREATE_TYPE_PROMPT')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderRequiredOption(type: ItemType): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox\">\n\t\t\t\t\t<input type=\"checkbox\" class=\"ui-ctl-element ui-form-content-required-option\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_OPTIONS_REQUIRED_LABEL')}\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst checkbox = node.querySelector('.ui-form-content-required-option');\n\t\tcheckbox.checked = type.isDodRequired();\n\n\t\tEvent.bind(checkbox, 'click', () => {\n\t\t\tthis.setChanged();\n\t\t\tthis.updateActiveType();\n\t\t});\n\n\t\treturn node;\n\t}\n\n\trenderParticipantsSelector(): ?HTMLElement\n\t{\n\t\treturn ''; //todo tmp\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_LABEL_USER_SELECTOR')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-user-selector\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tinitParticipantsSelector(type: ItemType)\n\t{\n\t\tconst participantsSelectorContainer = this.node.querySelector('.tasks-scrum-dod-settings-user-selector');\n\n\t\tif (Type.isNil(participantsSelectorContainer))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst selectorId = 'tasks-scrum-dod-settings-participants-selector-' + type.getId();\n\n\t\t// todo change to scrum-user provider\n\t\tthis.participantsSelector = new TagSelector({\n\t\t\tid: selectorId,\n\t\t\tdialogOptions: {\n\t\t\t\tid: selectorId,\n\t\t\t\tcontext: 'TASKS',\n\t\t\t\tpreselectedItems: this.tabs.getActiveType().getParticipants(),\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteEmployeeLink: false\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project-roles',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tprojectId: this.groupId\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdynamicLoad: true\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t}\n\t\t});\n\n\t\tthis.participantsSelector.renderTo(participantsSelectorContainer);\n\t}\n\n\tbuildEditingForm(type: ItemType)\n\t{\n\t\tconst container = this.cleanTypeForm();\n\n\t\tDom.append(this.renderEditingForm(type), container);\n\n\t\tthis.initParticipantsSelector(type);\n\n\t\tconst listContainer = this.node.querySelector('.ui-form-content-dod-list');\n\n\t\tconst loader = this.showLoader(listContainer);\n\n\t\tthis.requestSender.getChecklist({\n\t\t\tgroupId: this.groupId,\n\t\t\ttypeId: type.getId()\n\t\t})\n\t\t.then((response) => {\n\t\t\tloader.hide();\n\t\t\tRuntime.html(listContainer, response.data.html);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tbuildEmptyForm()\n\t{\n\t\tconst container = this.cleanTypeForm();\n\n\t\tDom.append(this.renderEmptyForm(), container);\n\t}\n\n\tonSwitchType(baseEvent: BaseEvent)\n\t{\n\t\tconst type: ItemType = baseEvent.getData();\n\t\tconst previousType: ?ItemType = this.tabs.getPreviousType();\n\n\t\tif (previousType)\n\t\t{\n\t\t\tthis.saveSettings(previousType)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconst updatedType: ItemTypeParams = response.data.type;\n\n\t\t\t\t\tpreviousType.setDodRequired(updatedType.dodRequired);\n\t\t\t\t\tpreviousType.setParticipants(updatedType.participants);\n\n\t\t\t\t\tthis.buildEditingForm(type);\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buildEditingForm(type);\n\t\t}\n\t}\n\n\tonCreateType(baseEvent: BaseEvent)\n\t{\n\t\tconst container = this.node.querySelector('.tasks-scrum-dod-settings-container-sidebar-wrapper');\n\n\t\tconst loader = this.showLoader(container);\n\n\t\tconst tmpType = baseEvent.getData();\n\n\t\tthis.requestSender.createType({\n\t\t\tgroupId: this.groupId,\n\t\t\tname: tmpType.getName(),\n\t\t\tsort: tmpType.getSort()\n\t\t})\n\t\t.then((response) => {\n\t\t\tthis.setChanged();\n\t\t\tloader.hide();\n\t\t\tconst createdType = new ItemType(response.data);\n\t\t\tthis.typeStorage.addType(createdType);\n\t\t\tthis.tabs.addType(createdType, tmpType);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeTypeName(baseEvent: BaseEvent)\n\t{\n\t\tconst type = baseEvent.getData();\n\n\t\tthis.requestSender.changeTypeName({\n\t\t\tgroupId: this.groupId,\n\t\t\tid: type.getId(),\n\t\t\tname: type.getName()\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.setChanged();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonRemoveType(baseEvent: BaseEvent)\n\t{\n\t\tconst type = baseEvent.getData();\n\n\t\tthis.requestSender.removeType({\n\t\t\tgroupId: this.groupId,\n\t\t\tid: type.getId()\n\t\t})\n\t\t.then(() => {\n\t\t\tthis.setChanged();\n\t\t\tthis.typeStorage.removeType(type);\n\t\t\tif (this.tabs.isEmpty())\n\t\t\t{\n\t\t\t\tthis.buildEmptyForm();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst nextType = [...this.typeStorage.getTypes().values()]\n\t\t\t\t\t.find((type: ItemType) => !this.tabs.isEmptyType(type))\n\t\t\t\t;\n\t\t\t\tthis.tabs.switchToType(nextType);\n\t\t\t}\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tsaveSettings(inputType?: ItemType): Promise\n\t{\n\t\tif (this.tabs.isEmpty())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst type = inputType ? inputType : this.tabs.getActiveType();\n\n\t\tif (!(type instanceof ItemType))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn this.requestSender.saveSettings({\n\t\t\tgroupId: this.groupId,\n\t\t\ttypeId: type.getId(),\n\t\t\trequiredOption: this.getRequiredOptionValue(),\n\t\t\titems: this.getChecklistItems(),\n\t\t\tparticipants: this.getSelectedParticipants()\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tgetChecklistItems(): Array\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst treeStructure = BX.Tasks.CheckListInstance.getTreeStructure();\n\n\t\treturn treeStructure.getRequestData();\n\t\t/* eslint-enable */\n\t}\n\n\tgetSelectedParticipants(): Array\n\t{\n\t\tif (Type.isNil(this.participantsSelector))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst selectedParticipants = [];\n\n\t\tthis.participantsSelector.getTags()\n\t\t\t.forEach((tag) => {\n\t\t\t\tselectedParticipants.push({\n\t\t\t\t\tid: tag.getId(),\n\t\t\t\t\tentityId: tag.getEntityId()\n\t\t\t\t});\n\t\t\t})\n\t\t;\n\n\t\treturn selectedParticipants;\n\t}\n\n\tgetRequiredOptionValue(): string\n\t{\n\t\tconst requiredOption = this.node.querySelector('.ui-form-content-required-option');\n\n\t\treturn (requiredOption.checked === true ? 'Y' : 'N');\n\t}\n\n\tshowLoader(container: HTMLElement): Loader\n\t{\n\t\tconst listPosition = Dom.getPosition(container);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: container,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n\n\tgetActiveType(): ?ItemType\n\t{\n\t\treturn this.tabs.getActiveType();\n\t}\n\n\tupdateActiveType()\n\t{\n\t\tconst type = this.tabs.getActiveType();\n\n\t\ttype.setDodRequired(this.getRequiredOptionValue());\n\t}\n\n\tcleanTypeForm(): HTMLElement\n\t{\n\t\tconst container = this.node.querySelector('.tasks-scrum-dod-settings-container-sidebar-wrapper');\n\n\t\tDom.clean(container);\n\n\t\treturn container;\n\t}\n\n\taddEmptyCreationType()\n\t{\n\t\tconst itemType = new ItemType();\n\n\t\tthis.tabs.setEmptyType(itemType);\n\n\t\tthis.typeStorage.addType(itemType);\n\t}\n}","import {Loc, Tag, Text, Type, Event, Dom, Runtime} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {MessageBox, MessageBoxButtons} from 'ui.dialogs.messagebox';\nimport {Button} from 'ui.buttons';\n\nimport {RequestSender} from './request.sender';\nimport {TypeStorage} from './type.storage';\nimport {Tabs} from './tabs';\nimport {ItemType, ItemTypeParams} from './item.type';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tgroupId: number,\n\ttaskId?: number,\n\tskipNotifications?: boolean\n}\n\ntype SettingsResponse = {\n\tdata: {\n\t\ttypes: Array<ItemTypeParams>,\n\t\tactiveTypeId: number\n\t}\n}\n\nexport class List extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Dod.List');\n\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\n\t\tthis.requestSender = params.requestSender;\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.taskId = parseInt(params.taskId, 10);\n\n\t\tthis.skipNotifications = Type.isBoolean(params.skipNotifications) ? params.skipNotifications : false;\n\n\t\tthis.typeStorage = new TypeStorage();\n\t\tthis.tabs = new Tabs();\n\n\t\tthis.empty = true;\n\n\t\tthis.node = null;\n\t}\n\n\trenderContent(): Promise\n\t{\n\t\treturn this.requestSender.getSettings({\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: this.taskId,\n\t\t\tsaveRequest: this.isSkipNotifications() ? 'Y' : 'N'\n\t\t})\n\t\t\t.then((response: SettingsResponse) => {\n\t\t\t\tconst types = Type.isArray(response.data.types) ? response.data.types : [];\n\t\t\t\tconst activeTypeId = (\n\t\t\t\t\tType.isInteger(response.data.activeTypeId)\n\t\t\t\t\t\t? parseInt(response.data.activeTypeId, 10)\n\t\t\t\t\t\t: 0\n\t\t\t\t);\n\n\t\t\t\tthis.empty = (types.length === 0);\n\n\t\t\t\tconst itemTypes = new Map();\n\n\t\t\t\ttypes.forEach((typeData: ItemTypeParams) => {\n\t\t\t\t\tconst itemType = new ItemType(typeData);\n\t\t\t\t\titemTypes.set(itemType.getId(), itemType);\n\t\t\t\t});\n\n\t\t\t\tthis.typeStorage.setTypes(itemTypes);\n\n\t\t\t\tthis.tabs.setTypeStorage(this.typeStorage);\n\n\t\t\t\tconst activeType = itemTypes.get(activeTypeId);\n\t\t\t\tif (Type.isUndefined(activeType))\n\t\t\t\t{\n\t\t\t\t\tthis.tabs.setActiveType(this.typeStorage.getNextType());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.tabs.setActiveType(activeType);\n\t\t\t\t}\n\n\t\t\t\tif (this.isEmpty())\n\t\t\t\t{\n\t\t\t\t\tif (!this.isSkipNotifications())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.emit('resolve');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.renderEmpty();\n\t\t\t\t}\n\n\t\t\t\treturn this.render();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trenderList()\n\t{\n\t\tconst listNode = this.node.querySelector('.tasks-scrum-dod-checklist');\n\n\t\tDom.clean(listNode);\n\n\t\tconst loader = this.showLoader(listNode);\n\n\t\tthis.requestSender.getList({\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: this.taskId,\n\t\t\ttypeId: this.getActiveType().getId()\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\tRuntime.html(listNode, response.data.html);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trenderEmpty(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t\t<div class=\"ui-form ui-form-line tasks-scrum-dod-form\">\n\t\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_LABEL_EMPTY')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\tEvent.bind(node.querySelector('span'), 'click', () => this.emit('showSettings'));\n\n\t\treturn node;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst activeType = this.getActiveType();\n\n\t\tconst renderOption = (typeData: ItemTypeParams) => {\n\t\t\tconst selected = activeType.getId() === typeData.id ? 'selected' : '';\n\n\t\t\treturn `<option value=\"${parseInt(typeData.id, 10)}\" ${selected}>${Text.encode(typeData.name)}</option>`;\n\t\t};\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"ui-form ui-form-line tasks-scrum-dod-form\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_LABEL_TYPES')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t<select class=\"ui-ctl-element tasks-scrum-dod-types\">\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\t[...this.typeStorage.getTypes().values()]\n\t\t\t\t\t\t\t\t\t\t.map((typeData: ItemTypeParams) => renderOption(typeData)).join('')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content tasks-scrum-dod-checklist\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst typeSelector = this.node.querySelector('.tasks-scrum-dod-types');\n\n\t\tEvent.bind(typeSelector, 'change', (event) => {\n\t\t\tconst typeId = parseInt(event.target.value, 10);\n\t\t\tthis.tabs.setActiveType(this.typeStorage.getType(typeId));\n\t\t\tthis.renderList();\n\t\t});\n\n\t\treturn this.node;\n\t}\n\n\tsave(): Promise\n\t{\n\t\tconst activeType = this.getActiveType();\n\n\t\treturn this.requestSender.saveList({\n\t\t\ttypeId: activeType.getId(),\n\t\t\ttaskId: this.taskId,\n\t\t\tgroupId: this.groupId,\n\t\t\titems: this.getListItems()\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tif (this.isSkipNotifications())\n\t\t\t\t{\n\t\t\t\t\treturn this.solve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (this.isListRequired(this.getActiveType()))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isAllToggled())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn 'resolve';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.showInfoPopup();\n\n\t\t\t\t\t\t\treturn 'wait';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isAllToggled())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn 'resolve';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.showConfirmPopup();\n\n\t\t\t\t\t\t\treturn 'wait';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tisSkipNotifications(): boolean\n\t{\n\t\treturn this.skipNotifications;\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.empty;\n\t}\n\n\tgetActiveType(): ?ItemType\n\t{\n\t\treturn this.tabs.getActiveType();\n\t}\n\n\tisListRequired(type: ItemType): boolean\n\t{\n\t\treturn type.isDodRequired();\n\t}\n\n\tsolve(): string\n\t{\n\t\tif (this.isListRequired(this.getActiveType()))\n\t\t{\n\t\t\tif (this.isAllToggled())\n\t\t\t{\n\t\t\t\treturn 'resolve';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn 'reject';\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn 'resolve';\n\t\t}\n\t}\n\n\tgetListItems(): Array\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst treeStructure = BX.Tasks.CheckListInstance.getTreeStructure();\n\n\t\treturn treeStructure.getRequestData();\n\t\t/* eslint-enable */\n\t}\n\n\tisAllToggled(): boolean\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet isAllToggled = true;\n\n\t\tconst treeStructure = BX.Tasks.CheckListInstance.getTreeStructure();\n\n\t\ttreeStructure.getDescendants()\n\t\t\t.forEach((checkList) => {\n\t\t\t\tif (checkList.countTotalCount() > 0 && !checkList.checkIsComplete())\n\t\t\t\t{\n\t\t\t\t\tisAllToggled = false;\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\treturn isAllToggled;\n\t\t/* eslint-enable */\n\t}\n\n\tshowInfoPopup()\n\t{\n\t\tconst popupOptions = {};\n\t\tconst currentSlider = this.sidePanelManager.getTopSlider();\n\t\tif (currentSlider)\n\t\t{\n\t\t\tpopupOptions.targetContainer = currentSlider.getContainer();\n\t\t}\n\n\t\t(new MessageBox({\n\t\t\tmessage: Loc.getMessage('TASKS_SCRUM_DOD_INFO_TEXT'),\n\t\t\tpopupOptions: popupOptions,\n\t\t\tbuttons: MessageBoxButtons.OK\n\t\t})).show();\n\t}\n\n\tshowConfirmPopup()\n\t{\n\t\tconst popupOptions = {};\n\t\tconst currentSlider = this.sidePanelManager.getTopSlider();\n\t\tif (currentSlider)\n\t\t{\n\t\t\tpopupOptions.targetContainer = currentSlider.getContainer();\n\t\t}\n\n\t\tconst messageBox = new MessageBox({\n\t\t\tpopupOptions: popupOptions,\n\t\t\tmessage: Loc.getMessage('TASKS_SCRUM_DOD_CONFIRM_TEXT_COMPLETE'),\n\t\t\tmodal: true,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_DOD_CONFIRM_COMPLETE_BUTTON_TEXT'),\n\t\t\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tthis.emit('resolve');\n\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_DOD_CONFIRM_SAVE_BUTTON_TEXT'),\n\t\t\t\t\tcolor: Button.Color.LINK,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tthis.emit('reject');\n\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\tmessageBox.show();\n\t}\n\n\tshowLoader(container: HTMLElement): Loader\n\t{\n\t\tconst listPosition = Dom.getPosition(container);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: container,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n}","import {Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Layout} from 'ui.sidepanel.layout';\nimport {CancelButton} from 'ui.buttons';\nimport {UI} from 'ui.notification';\n\nimport 'ui.layout-form';\nimport 'ui.forms';\n\nimport {Settings} from './settings';\nimport {List} from './list';\nimport {RequestSender} from './request.sender';\n\nimport '../css/base.css';\n\ntype Params = {\n\tview: 'settings' | 'list',\n\tgroupId: number,\n\ttaskId?: number,\n\tskipNotifications?: boolean\n}\n\nexport class Dod extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Dod');\n\n\t\tthis.view = params.view;\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.taskId = parseInt(params.taskId, 10);\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.requestSender = new RequestSender();\n\n\t\tthis.settings = new Settings({\n\t\t\trequestSender: this.requestSender,\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: this.taskId\n\t\t});\n\n\t\tthis.list = new List({\n\t\t\trequestSender: this.requestSender,\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: this.taskId,\n\t\t\tskipNotifications: params.skipNotifications\n\t\t});\n\n\t\tthis.list.subscribe('resolve', () => {\n\t\t\tthis.emit('resolve');\n\t\t\tthis.sidePanelManager.close(false);\n\t\t});\n\t\tthis.list.subscribe('reject', () => {\n\t\t\tthis.emit('reject');\n\t\t\tthis.sidePanelManager.close(false);\n\t\t});\n\t\tthis.list.subscribe('showSettings', () => {\n\t\t\tthis.sidePanelManager.close(false, () => this.showSettings());\n\t\t});\n\t}\n\n\tisNecessary(): Promise\n\t{\n\t\treturn this.requestSender.isNecessary({\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: this.taskId\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\treturn response.data;\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tshow()\n\t{\n\t\tswitch(this.view)\n\t\t{\n\t\t\tcase 'settings':\n\t\t\t\tthis.showSettings();\n\t\t\t\tbreak;\n\t\t\tcase 'list':\n\t\t\t\tthis.showList();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tshowSettings()\n\t{\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-dod-settings-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 1000,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.dod', 'ui.entity-selector', 'tasks'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_DOD_TITLE'),\n\t\t\t\t\t\tcontent: this.createSettingsContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: []\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadSettings.bind(this),\n\t\t\t\t\tonClose: this.onCloseSettings.bind(this),\n\t\t\t\t\tonCloseComplete: this.onCloseSettingsComplete.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tshowList()\n\t{\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-dod-list-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 800,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.dod', 'tasks'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_DOD_TITLE'),\n\t\t\t\t\t\tcontent: this.createListContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttoolbar: ({Button}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\t\t\tcolor: Button.Color.LIGHT_BORDER,\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_DOD_TOOLBAR_SETTINGS'),\n\t\t\t\t\t\t\t\t\tonclick: this.showSettings.bind(this),\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\t\ttext: this.getListButtonText(),\n\t\t\t\t\t\t\t\t\tonclick: this.onSaveList.bind(this)\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tnew CancelButton({\n\t\t\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\t\t\tthis.emit('reject')\n\t\t\t\t\t\t\t\t\t\tthis.sidePanelManager.close(false);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadList.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateSettingsContent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.settings.renderContent()\n\t\t\t\t.then((content: HTMLElement) => {\n\t\t\t\t\tresolve(content);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tcreateListContent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.list.renderContent()\n\t\t\t\t.then((content: HTMLElement) => {\n\t\t\t\t\tresolve(content);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tonLoadSettings()\n\t{\n\t\tif (!this.settings.isEmpty())\n\t\t{\n\t\t\tthis.settings.buildEditingForm(this.settings.getActiveType());\n\t\t}\n\t}\n\n\tonLoadList()\n\t{\n\t\tif (this.list.isEmpty())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.list.renderList();\n\t}\n\n\tonCloseSettings()\n\t{\n\t\tif (this.settings.isChanged())\n\t\t{\n\t\t\tthis.settings.saveSettings()\n\t\t\t\t.then(() => {\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tautoHideDelay: 1000,\n\t\t\t\t\t\tcontent: Loc.getMessage('TASKS_SCRUM_DOD_SAVE_SETTINGS_NOTIFY')\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(() => {})\n\t\t\t;\n\t\t}\n\t}\n\n\tonCloseSettingsComplete()\n\t{\n\t\tconst currentSlider = this.sidePanelManager.getTopSlider();\n\t\tif (currentSlider)\n\t\t{\n\t\t\tif (\n\t\t\t\tcurrentSlider.getUrl() === 'tasks-scrum-dod-list-side-panel'\n\t\t\t\t&& this.settings.isChanged()\n\t\t\t)\n\t\t\t{\n\t\t\t\tcurrentSlider.reload();\n\t\t\t}\n\t\t}\n\t}\n\n\tonSaveList()\n\t{\n\t\tif (this.list.isEmpty())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.list.save()\n\t\t\t.then((decision: string) => {\n\t\t\t\tif (decision === 'resolve')\n\t\t\t\t{\n\t\t\t\t\tthis.emit('resolve');\n\t\t\t\t\tthis.sidePanelManager.close(false);\n\t\t\t\t}\n\t\t\t\telse if (decision === 'reject')\n\t\t\t\t{\n\t\t\t\t\tthis.emit('reject');\n\t\t\t\t\tthis.sidePanelManager.close(false);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\tgetListButtonText(): string\n\t{\n\t\tif (this.list.isSkipNotifications())\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_DOD_CONFIRM_SAVE_BUTTON_TEXT')\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_DOD_CONFIRM_COMPLETE_BUTTON_TEXT')\n\t\t}\n\t}\n}"],"names":["ItemType","params","setId","id","setName","name","setSort","sort","setDodRequired","dodRequired","setParticipants","participants","Type","isInteger","parseInt","isString","Text","getRandom","value","isArray","forEach","participant","push","entityId","TypeStorage","types","values","next","type","set","getId","typeId","get","Tabs","setEventNamespace","sidePanelManager","BX","SidePanel","Instance","tabNodes","Map","activeType","previousType","typeStorage","sidebarClass","node","Tag","render","getTypes","map","renderTab","size","isEmptyType","addNode","Loc","getMessage","Event","bind","createType","tabClass","isActiveType","tabNode","encode","getName","event","edit","Dom","hasClass","target","remove","switchType","changeTypeName","removeType","newType","tmpType","insertBefore","lastElementChild","typeNode","savePrevious","removeClass","addClass","isEmpty","setPreviousType","getActiveType","setActiveType","emit","nameNode","input","querySelector","textContent","replace","trim","isComposing","keyCode","blur","focus","inputNode","setSelectionRange","length","popupOptions","currentSlider","getTopSlider","targetContainer","getContainer","MessageBox","message","okCaption","buttons","MessageBoxButtons","OK_CANCEL","onOk","messageBox","close","show","emptyType","EventEmitter","RequestSender","controller","action","data","Promise","resolve","reject","ajax","runAction","then","sendRequest","response","alertTitle","isUndefined","errors","console","error","firstError","shift","errorCode","code","title","alert","Settings","requestSender","groupId","taskId","tabs","subscribe","onSwitchType","onCreateType","onChangeTypeName","onRemoveType","changed","setChanged","getSettings","itemTypes","typeData","itemType","setTypes","setTypeStorage","getNextType","addEmptyCreationType","showErrorAlert","currentType","renderContainer","renderEmptyForm","renderEditingForm","renderRequiredOption","renderParticipantsSelector","checkbox","checked","isDodRequired","updateActiveType","participantsSelectorContainer","isNil","selectorId","participantsSelector","TagSelector","dialogOptions","context","preselectedItems","getParticipants","entities","options","inviteEmployeeLink","projectId","dynamicLoad","renderTo","container","cleanTypeForm","append","initParticipantsSelector","listContainer","loader","showLoader","getChecklist","hide","Runtime","html","baseEvent","getData","getPreviousType","saveSettings","updatedType","buildEditingForm","getSort","createdType","addType","buildEmptyForm","nextType","find","switchToType","inputType","requiredOption","getRequiredOptionValue","items","getChecklistItems","getSelectedParticipants","Tasks","CheckListInstance","treeStructure","getTreeStructure","getRequestData","selectedParticipants","getTags","tag","getEntityId","listPosition","getPosition","Loader","mode","color","offset","left","width","clean","setEmptyType","List","skipNotifications","isBoolean","empty","saveRequest","isSkipNotifications","activeTypeId","renderEmpty","listNode","getList","renderOption","selected","join","typeSelector","getType","renderList","saveList","getListItems","solve","isListRequired","isAllToggled","showInfoPopup","showConfirmPopup","getDescendants","checkList","countTotalCount","checkIsComplete","OK","modal","Button","text","Color","SUCCESS","events","click","LINK","Dod","view","settings","list","showSettings","isNecessary","showList","open","cacheable","contentCallback","Layout","createContent","extensions","content","createSettingsContent","design","section","onLoad","onLoadSettings","onClose","onCloseSettings","onCloseComplete","onCloseSettingsComplete","createListContent","toolbar","LIGHT_BORDER","onclick","cancelButton","SaveButton","getListButtonText","onSaveList","CancelButton","onLoadList","renderContent","isChanged","UI","Notification","Center","notify","autoHideDelay","getUrl","reload","save","decision"],"mappings":"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"}