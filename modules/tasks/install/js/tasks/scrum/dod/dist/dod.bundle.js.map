{"version":3,"file":"dod.bundle.js","sources":["../src/item.type.js","../src/type.storage.js","../src/tabs.js","../src/request.sender.js","../src/settings.js","../src/list.js","../src/dod.js"],"sourcesContent":["import {Text, Type} from 'main.core';\n\nexport type ItemTypeParams = {\n\tid?: number|string,\n\tname?: string,\n\tsort?: number,\n\tdodRequired?: 'Y' | 'N'\n}\n\nexport class ItemType\n{\n\tconstructor(params: ItemTypeParams = {})\n\t{\n\t\tthis.setId(params.id);\n\t\tthis.setName(params.name);\n\t\tthis.setSort(params.sort);\n\t\tthis.setDodRequired(params.dodRequired);\n\t}\n\n\tsetId(id: number)\n\t{\n\t\tthis.id = (\n\t\t\tType.isInteger(id)\n\t\t\t\t? parseInt(id, 10)\n\t\t\t\t: (Type.isString(id) && id) ? id : Text.getRandom()\n\t\t);\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetName(name: string)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : '');\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetSort(sort: number)\n\t{\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\t}\n\n\tgetSort(): number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetDodRequired(value: string)\n\t{\n\t\tthis.dodRequired = (value === 'Y');\n\t}\n\n\tisDodRequired(): boolean\n\t{\n\t\treturn this.dodRequired;\n\t}\n}","import {ItemType} from './item.type';\n\nexport class TypeStorage\n{\n\tsetTypes(types: Map<number, ItemType>)\n\t{\n\t\tthis.types = types;\n\t}\n\n\tgetNextType(): ItemType\n\t{\n\t\treturn this.types.values().next().value;\n\t}\n\n\tgetTypes(): Map<number, ItemType>\n\t{\n\t\treturn this.types;\n\t}\n\n\taddType(type: ItemType)\n\t{\n\t\tthis.types.set(type.getId(), type);\n\t}\n\n\tgetType(typeId: number): ?ItemType\n\t{\n\t\treturn this.types.get(typeId);\n\t}\n\n\tremoveType(type: ItemType)\n\t{\n\t\tthis.types.delete(type.getId());\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {ItemType} from './item.type';\nimport {TypeStorage} from './type.storage';\n\nexport class Tabs extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Dod.Tabs');\n\n\t\tthis.tabNodes = new Map();\n\n\t\tthis.activeType = null;\n\t\tthis.previousType = null;\n\t}\n\n\tsetTypeStorage(typeStorage: TypeStorage)\n\t{\n\t\tthis.typeStorage = typeStorage;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst sidebarClass = 'tasks-scrum-dod-settings-container-sidebar'\n\t\t\t+ ' tasks-scrum-dod-settings-container-sidebar-settings';\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"${sidebarClass}\">\n\t\t\t\t${[...this.typeStorage.getTypes().values()].map((type: ItemType) => this.renderTab(type))}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.tabNodes.size === 0;\n\t}\n\n\trenderTab(type: ItemType): HTMLElement\n\t{\n\t\tif (this.isEmptyType(type))\n\t\t{\n\t\t\tconst addNode = Tag.render`\n\t\t\t\t<div class=\"sidebar-tab-link\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-name\">\n\t\t\t\t\t\t+ ${Loc.getMessage('TASKS_SCRUM_CREATE_TYPE')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(addNode, 'click', this.createType.bind(this));\n\n\t\t\treturn addNode;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst tabClass = this.isActiveType(type) ? 'sidebar-tab sidebar-tab-active' : 'sidebar-tab';\n\n\t\t\tconst tabNode = Tag.render`\n\t\t\t\t<div class=\"${tabClass}\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-name\">\n\t\t\t\t\t\t${Text.encode(type.getName())}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-edit\"></div>\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-remove\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.tabNodes.set(type.getId(), tabNode);\n\n\t\t\tEvent.bind(tabNode, 'click', (event) => {\n\t\t\t\tconst edit = event.target.classList.contains('tasks-scrum-dod-settings-type-edit');\n\t\t\t\tconst remove = event.target.classList.contains('tasks-scrum-dod-settings-type-remove');\n\t\t\t\tif (!this.isActiveType(type))\n\t\t\t\t{\n\t\t\t\t\tthis.switchType(type, tabNode);\n\t\t\t\t}\n\t\t\t\tif (edit)\n\t\t\t\t{\n\t\t\t\t\tthis.changeTypeName(type, tabNode);\n\t\t\t\t}\n\t\t\t\tif (remove)\n\t\t\t\t{\n\t\t\t\t\tthis.removeType(type, tabNode);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn tabNode;\n\t\t}\n\t}\n\n\taddType(newType: ItemType, tmpType?: ItemType)\n\t{\n\t\tif (tmpType)\n\t\t{\n\t\t\tDom.remove(this.tabNodes.get(tmpType.getId()));\n\t\t\tthis.tabNodes.delete(tmpType.getId());\n\t\t}\n\n\t\tconst node = this.renderTab(newType);\n\n\t\tDom.insertBefore(node, this.node.lastElementChild);\n\n\t\tthis.switchType(newType, node);\n\t}\n\n\tswitchType(type: ItemType, typeNode: HTMLElement, savePrevious: boolean = true)\n\t{\n\t\tthis.tabNodes.forEach((node: HTMLElement) => {\n\t\t\tDom.removeClass(node, 'sidebar-tab-active');\n\t\t});\n\n\t\tDom.addClass(typeNode, 'sidebar-tab-active');\n\n\t\tif (savePrevious && !this.isEmpty())\n\t\t{\n\t\t\tthis.setPreviousType(this.getActiveType());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.setPreviousType(null);\n\t\t}\n\n\t\tthis.setActiveType(type);\n\n\t\tthis.emit('switchType', type);\n\t}\n\n\tcreateType()\n\t{\n\t\tconst type = new ItemType();\n\t\ttype.setSort(this.typeStorage.getTypes().size);\n\n\t\tthis.tabNodes.forEach((node: HTMLElement) => {\n\t\t\tDom.removeClass(node, 'sidebar-tab-active');\n\t\t});\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"sidebar-tab sidebar-tab-active\">\n\t\t\t\t<input type=\"text\" class=\"tasks-scrum-dod-settings-type-name-input\">\n\t\t\t</div>\n\t\t`;\n\t\tconst nameNode = Tag.render`<div class=\"tasks-scrum-dod-settings-type-name\"></div>`;\n\n\t\tDom.insertBefore(node, this.node.lastElementChild);\n\n\t\tconst input = node.querySelector('input');\n\n\t\tEvent.bind(input, 'change', (event) => {\n\t\t\ttype.setName(event.target['value']);\n\t\t\tthis.emit('createType', type);\n\t\t\tnameNode.textContent = Text.encode(type.getName());\n\t\t\tDom.replace(input, nameNode);\n\t\t}, true);\n\n\t\tEvent.bind(input, 'blur', (event) => {\n\t\t\tif (event.target['value'].trim() === '')\n\t\t\t{\n\t\t\t\tDom.remove(node);\n\t\t\t}\n\t\t}, true);\n\n\t\tEvent.bind(input, 'keydown', (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t{\n\t\t\t\tinput.blur();\n\t\t\t}\n\t\t});\n\n\t\tinput.focus();\n\n\t\tthis.tabNodes.set(type.getId(), node);\n\t}\n\n\tchangeTypeName(type: ItemType, typeNode: HTMLElement)\n\t{\n\t\tconst inputNode = Tag.render`\n\t\t\t<input type=\"text\" class=\"tasks-scrum-dod-settings-type-name-input\" value=\"${Text.encode(type.getName())}\">\n\t\t`;\n\t\tconst nameNode = typeNode.querySelector('.tasks-scrum-dod-settings-type-name');\n\n\t\tEvent.bind(inputNode, 'change', (event) => {\n\t\t\ttype.setName(event.target['value'])\n\t\t\tthis.emit('changeTypeName', type);\n\t\t\tinputNode.blur();\n\t\t}, true);\n\n\t\tEvent.bind(inputNode, 'blur', () => {\n\t\t\tnameNode.textContent = Text.encode(type.getName());\n\t\t\tDom.replace(inputNode, nameNode);\n\t\t}, true);\n\n\t\tEvent.bind(inputNode, 'keydown', (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t{\n\t\t\t\tinputNode.blur();\n\t\t\t}\n\t\t});\n\n\t\tDom.replace(nameNode, inputNode);\n\n\t\tinputNode.focus();\n\t\tinputNode.setSelectionRange(type.getName().length, type.getName().length);\n\t}\n\n\tremoveType(type: ItemType, typeNode: HTMLElement)\n\t{\n\t\ttop.BX.UI.Dialogs.MessageBox.confirm(\n\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TYPE'),\n\t\t\t(messageBox) => {\n\t\t\t\tthis.tabNodes.delete(type.getId());\n\t\t\t\tif (this.isActiveType(type))\n\t\t\t\t{\n\t\t\t\t\tthis.setActiveType(null);\n\t\t\t\t}\n\t\t\t\tthis.setPreviousType(null);\n\t\t\t\tDom.remove(typeNode);\n\t\t\t\tthis.emit('removeType', type);\n\t\t\t\tmessageBox.close();\n\t\t\t},\n\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t);\n\t}\n\n\tsetActiveType(type: ?ItemType)\n\t{\n\t\tthis.activeType = type;\n\t}\n\n\tgetActiveType(): ?ItemType\n\t{\n\t\treturn this.activeType;\n\t}\n\n\tsetPreviousType(type: ?ItemType)\n\t{\n\t\tthis.previousType = type;\n\t}\n\n\tgetPreviousType(): ?ItemType\n\t{\n\t\treturn this.previousType;\n\t}\n\n\tisActiveType(type: ItemType): boolean\n\t{\n\t\treturn (\n\t\t\tthis.activeType\n\t\t\t&& this.activeType.getId() === type.getId()\n\t\t);\n\t}\n\n\tsetEmptyType(type: ItemType)\n\t{\n\t\tthis.emptyType = type;\n\t}\n\n\tisEmptyType(type: ItemType): boolean\n\t{\n\t\treturn type.getId() === this.emptyType.getId();\n\t}\n\n\tswitchToType(type: ItemType)\n\t{\n\t\tthis.switchType(type, this.tabNodes.get(type.getId()), false);\n\t}\n}","import {Loc, Type} from 'main.core';\n\ntype RequestParams = {\n\tgroupId: number,\n\ttaskId: number,\n\ttypeId?: number\n}\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\ttop.BX.ajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tisNecessary(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'isNecessary', data);\n\t}\n\n\tgetSettings(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'getSettings', data);\n\t}\n\n\tgetChecklist(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'getChecklist', data);\n\t}\n\n\tsaveSettings(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'saveSettings', data);\n\t}\n\n\tgetList(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'getList', data);\n\t}\n\n\tsaveList(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('doD', 'saveList', data);\n\t}\n\n\tcreateType(data): Promise\n\t{\n\t\treturn this.sendRequest('type', 'createType', data);\n\t}\n\n\tchangeTypeName(data): Promise\n\t{\n\t\treturn this.sendRequest('type', 'changeTypeName', data);\n\t}\n\n\tremoveType(data): Promise\n\t{\n\t\treturn this.sendRequest('type', 'removeType', data);\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.log(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TSD_ERROR_POPUP_TITLE'));\n\n\t\t\t\ttop.BX.UI.Dialogs.MessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Dom, Tag, Type, Loc, Event} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {ItemType} from './item.type';\nimport {TypeStorage} from './type.storage';\nimport {Tabs} from './tabs';\n\nimport {RequestSender} from './request.sender';\n\nimport type {ItemTypeParams} from './item.type';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tgroupId: number,\n\ttaskId?: number\n}\n\nexport class Settings\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.taskId = parseInt(params.taskId, 10);\n\n\t\tthis.typeStorage = new TypeStorage();\n\t\tthis.tabs = new Tabs();\n\n\t\tthis.tabs.subscribe('switchType', this.onSwitchType.bind(this));\n\t\tthis.tabs.subscribe('createType', this.onCreateType.bind(this));\n\t\tthis.tabs.subscribe('changeTypeName', this.onChangeTypeName.bind(this));\n\t\tthis.tabs.subscribe('removeType', this.onRemoveType.bind(this));\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.tabs.isEmpty();\n\t}\n\n\trenderContent(): Promise\n\t{\n\t\treturn this.requestSender.getSettings({\n\t\t\tgroupId: this.groupId\n\t\t})\n\t\t\t.then((response) => {\n\n\t\t\t\tconst types = Type.isArray(response.data.types) ? response.data.types : [];\n\n\t\t\t\tconst itemTypes = new Map();\n\n\t\t\t\ttypes.forEach((typeData: ItemTypeParams) => {\n\t\t\t\t\tconst itemType = new ItemType(typeData);\n\t\t\t\t\titemTypes.set(itemType.getId(), itemType);\n\t\t\t\t});\n\n\t\t\t\tthis.typeStorage.setTypes(itemTypes);\n\n\t\t\t\tthis.tabs.setTypeStorage(this.typeStorage);\n\t\t\t\tthis.tabs.setActiveType(this.typeStorage.getNextType());\n\n\t\t\t\tthis.addEmptyCreationType();\n\n\t\t\t\treturn this.render();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-dod-settings\">\n\t\t\t\t<div class=\"tasks-scrum-dod-settings-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-wrap\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-shell\">\n\t\t\t\t\t\t\t${this.tabs.render()}\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-sidebar-wrapper\">\n\t\t\t\t\t\t\t\t${this.renderContainer()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\trenderContainer(): HTMLElement\n\t{\n\t\tif (this.tabs.isEmpty())\n\t\t{\n\t\t\treturn this.renderEmptyForm();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.renderEditingForm(this.typeStorage.getNextType());\n\t\t}\n\t}\n\n\trenderEditingForm(type: ItemType): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t${this.renderRequiredOption(type)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content ui-form-content-dod-list\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEmptyForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_CREATE_TYPE_PROMPT')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderRequiredOption(type: ItemType): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox\">\n\t\t\t\t\t<input type=\"checkbox\" class=\"ui-ctl-element ui-form-content-required-option\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_OPTIONS_REQUIRED_LABEL')}\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst checkbox = node.querySelector('.ui-form-content-required-option');\n\t\tcheckbox.checked = type.isDodRequired();\n\n\t\tEvent.bind(checkbox, 'click', () => {\n\t\t\tthis.updateActiveType();\n\t\t});\n\n\t\treturn node;\n\t}\n\n\tbuildEditingForm(type: ItemType)\n\t{\n\t\tconst container = this.cleanTypeForm();\n\n\t\tDom.append(this.renderEditingForm(type), container);\n\n\t\tconst listContainer = this.node.querySelector('.ui-form-content-dod-list');\n\n\t\tconst loader = this.showLoader(listContainer);\n\n\t\tthis.requestSender.getChecklist({\n\t\t\tgroupId: this.groupId,\n\t\t\ttypeId: type.getId()\n\t\t})\n\t\t.then((response) => {\n\t\t\tloader.hide();\n\t\t\ttop.BX.Runtime.html(listContainer, response.data.html);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tbuildEmptyForm()\n\t{\n\t\tconst container = this.cleanTypeForm();\n\n\t\tDom.append(this.renderEmptyForm(), container);\n\t}\n\n\tonSwitchType(baseEvent: BaseEvent)\n\t{\n\t\tconst type = baseEvent.getData();\n\t\tconst previousType = this.tabs.getPreviousType();\n\n\t\tif (previousType)\n\t\t{\n\t\t\tthis.saveSettings(previousType)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.buildEditingForm(type);\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buildEditingForm(type);\n\t\t}\n\t}\n\n\tonCreateType(baseEvent: BaseEvent)\n\t{\n\t\tconst container = this.node.querySelector('.tasks-scrum-dod-settings-container-sidebar-wrapper');\n\n\t\tconst loader = this.showLoader(container);\n\n\t\tconst tmpType = baseEvent.getData();\n\n\t\tthis.requestSender.createType({\n\t\t\tgroupId: this.groupId,\n\t\t\tname: tmpType.getName(),\n\t\t\tsort: tmpType.getSort()\n\t\t})\n\t\t.then((response) => {\n\t\t\tloader.hide();\n\t\t\tconst createdType = new ItemType(response.data);\n\t\t\tthis.typeStorage.addType(createdType);\n\t\t\tthis.tabs.addType(createdType, tmpType);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeTypeName(baseEvent: BaseEvent)\n\t{\n\t\tconst type = baseEvent.getData();\n\n\t\tthis.requestSender.changeTypeName({\n\t\t\tgroupId: this.groupId,\n\t\t\tid: type.getId(),\n\t\t\tname: type.getName()\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonRemoveType(baseEvent: BaseEvent)\n\t{\n\t\tconst type = baseEvent.getData();\n\n\t\tthis.requestSender.removeType({\n\t\t\tgroupId: this.groupId,\n\t\t\tid: type.getId()\n\t\t})\n\t\t.then(() => {\n\t\t\tthis.typeStorage.removeType(type);\n\t\t\tif (this.tabs.isEmpty())\n\t\t\t{\n\t\t\t\tthis.buildEmptyForm();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst nextType = [...this.typeStorage.getTypes().values()]\n\t\t\t\t\t.find((type: ItemType) => !this.tabs.isEmptyType(type))\n\t\t\t\t;\n\t\t\t\tthis.tabs.switchToType(nextType);\n\t\t\t}\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tsaveSettings(inputType?: ItemType): Promise\n\t{\n\t\tif (this.tabs.isEmpty())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst type = inputType? inputType : this.tabs.getActiveType();\n\n\t\tif (!(type instanceof ItemType))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn this.requestSender.saveSettings({\n\t\t\tgroupId: this.groupId,\n\t\t\ttypeId: type.getId(),\n\t\t\trequiredOption: this.getRequiredOptionValue(),\n\t\t\titems: this.getChecklistItems()\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tgetChecklistItems(): Array\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof top.BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst treeStructure = top.BX.Tasks.CheckListInstance.getTreeStructure();\n\n\t\treturn treeStructure.getRequestData();\n\t\t/* eslint-enable */\n\t}\n\n\tgetRequiredOptionValue(): string\n\t{\n\t\tconst requiredOption = this.node.querySelector('.ui-form-content-required-option');\n\n\t\treturn (requiredOption.checked === true ? 'Y' : 'N');\n\t}\n\n\tshowLoader(container: HTMLElement): Loader\n\t{\n\t\tconst listPosition = Dom.getPosition(container);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: container,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n\n\tgetActiveType(): ?ItemType\n\t{\n\t\treturn this.tabs.getActiveType();\n\t}\n\n\tupdateActiveType()\n\t{\n\t\tconst type = this.tabs.getActiveType();\n\n\t\ttype.setDodRequired(this.getRequiredOptionValue());\n\t}\n\n\tcleanTypeForm(): HTMLElement\n\t{\n\t\tconst container = this.node.querySelector('.tasks-scrum-dod-settings-container-sidebar-wrapper');\n\n\t\tDom.clean(container);\n\n\t\treturn container;\n\t}\n\n\taddEmptyCreationType()\n\t{\n\t\tconst itemType = new ItemType();\n\n\t\tthis.tabs.setEmptyType(itemType);\n\n\t\tthis.typeStorage.addType(itemType);\n\t}\n}","import {Loc, Tag, Text, Type, Event, Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nimport {Button} from 'ui.buttons';\n\nimport {RequestSender} from './request.sender';\nimport {TypeStorage} from './type.storage';\nimport {Tabs} from './tabs';\nimport {ItemType} from './item.type';\n\nimport type {ItemTypeParams} from './item.type';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tgroupId: number,\n\ttaskId?: number,\n\tskipNotifications?: boolean\n}\n\ntype SettingsResponse = {\n\tdata: {\n\t\ttypes: Array<ItemTypeParams>,\n\t\tactiveTypeId: number\n\t}\n}\n\nexport class List extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Dod.List');\n\n\t\tthis.requestSender = params.requestSender;\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.taskId = parseInt(params.taskId, 10);\n\n\t\tthis.skipNotifications = Type.isBoolean(params.skipNotifications) ? params.skipNotifications : false;\n\n\t\tthis.typeStorage = new TypeStorage();\n\t\tthis.tabs = new Tabs();\n\n\t\tthis.empty = true;\n\t\tthis.activeTypeData = null;\n\n\t\tthis.node = null;\n\t}\n\n\trenderContent(): Promise\n\t{\n\t\treturn this.requestSender.getSettings({\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: this.taskId\n\t\t})\n\t\t\t.then((response: SettingsResponse) => {\n\t\t\t\tconst types = Type.isArray(response.data.types) ? response.data.types : [];\n\t\t\t\tconst activeTypeId = (\n\t\t\t\t\tType.isInteger(response.data.activeTypeId)\n\t\t\t\t\t\t? parseInt(response.data.activeTypeId, 10)\n\t\t\t\t\t\t: 0\n\t\t\t\t);\n\n\t\t\t\tthis.empty = (types.length === 0);\n\n\t\t\t\tconst itemTypes = new Map();\n\n\t\t\t\ttypes.forEach((typeData: ItemTypeParams) => {\n\t\t\t\t\tconst itemType = new ItemType(typeData);\n\t\t\t\t\titemTypes.set(itemType.getId(), itemType);\n\t\t\t\t});\n\n\t\t\t\tthis.typeStorage.setTypes(itemTypes);\n\n\t\t\t\tthis.tabs.setTypeStorage(this.typeStorage);\n\n\t\t\t\tconst activeType = itemTypes.get(activeTypeId);\n\t\t\t\tif (Type.isUndefined(activeType))\n\t\t\t\t{\n\t\t\t\t\tthis.tabs.setActiveType(this.typeStorage.getNextType());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.tabs.setActiveType(activeType);\n\t\t\t\t}\n\n\t\t\t\tif (this.isEmpty())\n\t\t\t\t{\n\t\t\t\t\tif (!this.isSkipNotifications())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.emit('resolve');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.renderEmpty();\n\t\t\t\t}\n\n\t\t\t\treturn this.render();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trenderList()\n\t{\n\t\tconst listNode = this.node.querySelector('.tasks-scrum-dod-checklist');\n\n\t\tDom.clean(listNode);\n\n\t\tconst loader = this.showLoader(listNode);\n\n\t\tthis.requestSender.getList({\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: this.taskId,\n\t\t\ttypeId: this.getActiveType().getId()\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\ttop.BX.Runtime.html(listNode, response.data.html);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trenderEmpty(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t\t<div class=\"ui-form ui-form-line tasks-scrum-dod-form\">\n\t\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_LABEL_EMPTY')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\tEvent.bind(node.querySelector('span'), 'click', () => this.emit('showSettings'));\n\n\t\treturn node;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst activeType = this.getActiveType();\n\n\t\tconst renderOption = (typeData: ItemTypeParams) => {\n\t\t\tconst selected = activeType.getId() === typeData.id ? 'selected' : '';\n\n\t\t\treturn `<option value=\"${parseInt(typeData.id, 10)}\" ${selected}>${Text.encode(typeData.name)}</option>`;\n\t\t};\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"ui-form ui-form-line tasks-scrum-dod-form\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_LABEL_TYPES')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t<select class=\"ui-ctl-element tasks-scrum-dod-types\">\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\t[...this.typeStorage.getTypes().values()]\n\t\t\t\t\t\t\t\t\t\t.map((typeData: ItemTypeParams) => renderOption(typeData)).join('')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content tasks-scrum-dod-checklist\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst typeSelector = this.node.querySelector('.tasks-scrum-dod-types');\n\n\t\tEvent.bind(typeSelector, 'change', (event) => {\n\t\t\tconst typeId = parseInt(event.target.value, 10);\n\t\t\tthis.tabs.setActiveType(this.typeStorage.getType(typeId));\n\t\t\tthis.renderList();\n\t\t});\n\n\t\treturn this.node;\n\t}\n\n\tsave()\n\t{\n\t\tconst activeType = this.getActiveType();\n\n\t\tthis.requestSender.saveList({\n\t\t\ttypeId: activeType.getId(),\n\t\t\ttaskId: this.taskId,\n\t\t\tgroupId: this.groupId,\n\t\t\titems: this.getListItems()\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tif (this.isSkipNotifications())\n\t\t\t\t{\n\t\t\t\t\tthis.solve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (this.isListRequired(this.getActiveType()))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isAllToggled())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('resolve');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('reject');\n\n\t\t\t\t\t\t\tthis.showInfoPopup();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isAllToggled())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('resolve');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.showConfirmPopup();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tisSkipNotifications(): boolean\n\t{\n\t\treturn this.skipNotifications;\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.empty;\n\t}\n\n\tgetActiveType(): ?ItemType\n\t{\n\t\treturn this.tabs.getActiveType();\n\t}\n\n\tisListRequired(type: ItemType): boolean\n\t{\n\t\treturn type.isDodRequired();\n\t}\n\n\tsolve()\n\t{\n\t\tif (this.isListRequired(this.getActiveType()))\n\t\t{\n\t\t\tif (this.isAllToggled())\n\t\t\t{\n\t\t\t\tthis.emit('resolve');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emit('reject');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('resolve');\n\t\t}\n\t}\n\n\tgetListItems(): Array\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof top.BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst treeStructure = top.BX.Tasks.CheckListInstance.getTreeStructure();\n\n\t\treturn treeStructure.getRequestData();\n\t\t/* eslint-enable */\n\t}\n\n\tisAllToggled(): boolean\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof top.BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet isAllToggled = true;\n\n\t\tconst treeStructure = top.BX.Tasks.CheckListInstance.getTreeStructure();\n\n\t\ttreeStructure.getDescendants()\n\t\t\t.forEach((checkList) => {\n\t\t\t\tif (checkList.countTotalCount() > 0 && !checkList.checkIsComplete())\n\t\t\t\t{\n\t\t\t\t\tisAllToggled = false;\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\treturn isAllToggled;\n\t\t/* eslint-enable */\n\t}\n\n\tshowInfoPopup()\n\t{\n\t\tMessageBox.alert(Loc.getMessage('TASKS_SCRUM_DOD_INFO_TEXT'));\n\t}\n\n\tshowConfirmPopup()\n\t{\n\t\tconst messageBox = new MessageBox({\n\t\t\tmessage: Loc.getMessage('TASKS_SCRUM_DOD_CONFIRM_TEXT_COMPLETE'),\n\t\t\tmodal: true,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_DOD_CONFIRM_COMPLETE_BUTTON_TEXT'),\n\t\t\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tthis.emit('resolve');\n\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_DOD_CONFIRM_SAVE_BUTTON_TEXT'),\n\t\t\t\t\tcolor: Button.Color.LINK,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tthis.emit('reject');\n\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\tmessageBox.show();\n\t}\n\n\tshowLoader(container: HTMLElement): Loader\n\t{\n\t\tconst listPosition = Dom.getPosition(container);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: container,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n}","import {Loc, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Layout} from 'ui.sidepanel.layout';\n\nimport 'ui.layout-form';\nimport 'ui.forms';\n\nimport {Settings} from './settings';\nimport {List} from './list';\nimport {RequestSender} from './request.sender';\n\nimport '../css/base.css';\n\ntype Params = {\n\tview: 'settings' | 'list',\n\tgroupId: number,\n\ttaskId?: number,\n\tskipNotifications?: boolean\n}\n\nexport class Dod extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Dod');\n\n\t\tthis.view = params.view;\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.taskId = parseInt(params.taskId, 10);\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.requestSender = new RequestSender();\n\n\t\tthis.settings = new Settings({\n\t\t\trequestSender: this.requestSender,\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: this.taskId\n\t\t});\n\n\t\tthis.list = new List({\n\t\t\trequestSender: this.requestSender,\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: this.taskId,\n\t\t\tskipNotifications: params.skipNotifications\n\t\t});\n\n\t\tthis.list.subscribe('resolve', () => this.emit('resolve'));\n\t\tthis.list.subscribe('reject', () => this.emit('reject'));\n\t\tthis.list.subscribe('showSettings', () => {\n\t\t\tthis.sidePanelManager.close(false, () => this.showSettings());\n\t\t});\n\t}\n\n\tisNecessary(): Promise\n\t{\n\t\treturn this.requestSender.isNecessary({\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: this.taskId\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\treturn response.data;\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tshow()\n\t{\n\t\tswitch(this.view)\n\t\t{\n\t\t\tcase 'settings':\n\t\t\t\tthis.showSettings();\n\t\t\t\tbreak;\n\t\t\tcase 'list':\n\t\t\t\tthis.showList();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tshowSettings()\n\t{\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-dod-settings-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 1000,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.dod'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_DOD_TITLE'),\n\t\t\t\t\t\tcontent: this.createSettingsContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: []\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadSettings.bind(this),\n\t\t\t\t\tonClose: this.onCloseSettings.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tshowList()\n\t{\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-dod-list-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 800,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.dod'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_DOD_TITLE'),\n\t\t\t\t\t\tcontent: this.createListContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\t\ttext: this.getListButtonText(),\n\t\t\t\t\t\t\t\t\tonclick: this.onSaveList.bind(this)\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoadList.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateSettingsContent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.settings.renderContent()\n\t\t\t\t.then((content: HTMLElement) => {\n\t\t\t\t\tresolve(content);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tcreateListContent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.list.renderContent()\n\t\t\t\t.then((content: HTMLElement) => {\n\t\t\t\t\tresolve(content);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tonLoadSettings()\n\t{\n\t\tif (!this.settings.isEmpty())\n\t\t{\n\t\t\tthis.settings.buildEditingForm(this.settings.getActiveType());\n\t\t}\n\t}\n\n\tonLoadList()\n\t{\n\t\tif (this.list.isEmpty())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.list.renderList();\n\t}\n\n\tonCloseSettings()\n\t{\n\t\tthis.settings.saveSettings()\n\t\t\t.then(() => {})\n\t\t\t.catch(() => {})\n\t\t;\n\t}\n\n\tonSaveList()\n\t{\n\t\tif (this.list.isEmpty())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.list.save();\n\n\t\tthis.sidePanelManager.close(false);\n\t}\n\n\tgetListButtonText(): string\n\t{\n\t\tif (this.list.isSkipNotifications())\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_DOD_CONFIRM_SAVE_BUTTON_TEXT')\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_DOD_CONFIRM_COMPLETE_BUTTON_TEXT')\n\t\t}\n\t}\n}"],"names":["ItemType","params","setId","id","setName","name","setSort","sort","setDodRequired","dodRequired","Type","isInteger","parseInt","isString","Text","getRandom","value","TypeStorage","types","values","next","type","set","getId","typeId","get","delete","Tabs","setEventNamespace","tabNodes","Map","activeType","previousType","typeStorage","sidebarClass","node","Tag","render","getTypes","map","renderTab","size","isEmptyType","addNode","Loc","getMessage","Event","bind","createType","tabClass","isActiveType","tabNode","encode","getName","event","edit","target","classList","contains","remove","switchType","changeTypeName","removeType","newType","tmpType","Dom","insertBefore","lastElementChild","typeNode","savePrevious","forEach","removeClass","addClass","isEmpty","setPreviousType","getActiveType","setActiveType","emit","nameNode","input","querySelector","textContent","replace","trim","isComposing","keyCode","blur","focus","inputNode","setSelectionRange","length","top","BX","UI","Dialogs","MessageBox","confirm","messageBox","close","emptyType","EventEmitter","RequestSender","controller","action","data","Promise","resolve","reject","ajax","runAction","then","sendRequest","response","alertTitle","isUndefined","errors","console","log","firstError","shift","errorCode","code","message","title","alert","Settings","requestSender","groupId","taskId","tabs","subscribe","onSwitchType","onCreateType","onChangeTypeName","onRemoveType","getSettings","isArray","itemTypes","typeData","itemType","setTypes","setTypeStorage","getNextType","addEmptyCreationType","catch","showErrorAlert","renderContainer","renderEmptyForm","renderEditingForm","renderRequiredOption","checkbox","checked","isDodRequired","updateActiveType","container","cleanTypeForm","append","listContainer","loader","showLoader","getChecklist","hide","Runtime","html","baseEvent","getData","getPreviousType","saveSettings","buildEditingForm","getSort","createdType","addType","buildEmptyForm","nextType","find","switchToType","inputType","requiredOption","getRequiredOptionValue","items","getChecklistItems","Tasks","CheckListInstance","treeStructure","getTreeStructure","getRequestData","listPosition","getPosition","Loader","mode","color","offset","left","width","show","clean","setEmptyType","List","skipNotifications","isBoolean","empty","activeTypeData","activeTypeId","isSkipNotifications","renderEmpty","listNode","getList","renderOption","selected","join","typeSelector","getType","renderList","saveList","getListItems","solve","isListRequired","isAllToggled","showInfoPopup","showConfirmPopup","getDescendants","checkList","countTotalCount","checkIsComplete","modal","buttons","Button","text","Color","SUCCESS","events","click","LINK","Dod","view","sidePanelManager","SidePanel","Instance","settings","list","showSettings","isNecessary","showList","open","cacheable","contentCallback","Layout","createContent","extensions","content","createSettingsContent","design","section","onLoad","onLoadSettings","onClose","onCloseSettings","createListContent","cancelButton","SaveButton","getListButtonText","onclick","onSaveList","onLoadList","renderContent","save"],"mappings":"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"}