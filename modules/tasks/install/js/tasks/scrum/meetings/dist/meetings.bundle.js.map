{"version":3,"file":"meetings.bundle.js","sources":["../src/culture.js","../src/created.event.js","../src/list.events.js","../src/request.sender.js","../src/meetings.js"],"sourcesContent":["export type CultureData = {\n\tdayMonthFormat: string,\n\tlongDateFormat: string,\n\tshortTimeFormat: string\n}\n\nexport class Culture\n{\n\tstatic #instance;\n\n\tstatic getInstance()\n\t{\n\t\tif (!Culture.#instance)\n\t\t{\n\t\t\tCulture.#instance = new Culture();\n\t\t}\n\n\t\treturn Culture.#instance;\n\t}\n\n\tsetData(data: CultureData)\n\t{\n\t\tthis.data = data;\n\t}\n\n\tgetDayMonthFormat(): string\n\t{\n\t\treturn this.data.dayMonthFormat;\n\t}\n\n\tgetLongDateFormat(): string\n\t{\n\t\treturn this.data.longDateFormat;\n\t}\n\n\tgetShortTimeFormat(): string\n\t{\n\t\treturn this.data.shortTimeFormat;\n\t}\n}","import {Loc, Tag, Event, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Culture} from './culture';\n\nexport type CreatedEventType = {\n\tid: number,\n\tname: string,\n\tcolor: string,\n\tfrom: number,\n\tto: number,\n\trepeatable: boolean\n}\n\nexport class CreatedEvent extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.CreatedEvent');\n\n\t\tthis.node = null;\n\t}\n\n\trender(event: ?CreatedEventType): ?HTMLElement\n\t{\n\t\tif (event === null)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tevent.color = (event.color === '' ? '#86b100' : event.color);\n\n\t\tconst colorBorder = this.convertHexToRGBA(event.color, 0.5);\n\t\tconst colorBackground = this.convertHexToRGBA(event.color, 0.15);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-scrum__widget-meetings--timetable-content\"\n\t\t\t\tstyle=\"background: ${colorBackground}; --meetings-border-color: ${colorBorder};\"\n\t\t\t>\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-navigation\">\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-time\">\n\t\t\t\t\t\t${this.getFormattedTime(event.from, event.to)}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderVideoCallButton()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-name\">${Text.encode(event.name)}</div>\n\t\t\t\t${event.repeatable ? this.renderRepetition() : ''}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.openViewCalendarSidePanel.bind(this, event));\n\n\t\treturn this.node;\n\t}\n\n\topenViewCalendarSidePanel(event: CreatedEventType)\n\t{\n\t\tnew window.top.BX.Calendar.SliderLoader(\n\t\t\tevent.id,\n\t\t\t{\n\t\t\t\tentryDateFrom: new Date(event.from * 1000)\n\t\t\t}\n\t\t).show();\n\n\t\tthis.emit('showView');\n\t}\n\n\trenderVideoCallButton(): ?HTMLElement\n\t{\n\t\treturn '';\n\n\t\tconst videoCallUiClasses = 'ui-btn-split ui-btn-light-border ui-btn-xs ui-btn-light ui-btn-no-caps';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-video-call ${videoCallUiClasses}\">\n\t\t\t\t<button class=\"ui-btn-main\">\n\t\t\t\t\t${Loc.getMessage('TSM_VIDEO_CALL_BUTTON')}\n\t\t\t\t</button>\n\t\t\t\t<div class=\"ui-btn-menu\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderRepetition(): ?HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-repetition\">\n\t\t\t\t<i class=\"tasks-scrum__widget-meetings--timetable-repetition-icon\"></i>\n\t\t\t\t<span>${Loc.getMessage('TSM_REPETITION_TITLE')}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tconvertHexToRGBA(hexCode, opacity)\n\t{\n\t\tlet hex = hexCode.replace('#', '');\n\n\t\tif (hex.length === 3)\n\t\t{\n\t\t\thex = `${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;\n\t\t}\n\n\t\tconst r = parseInt(hex.substring(0, 2), 16);\n\t\tconst g = parseInt(hex.substring(2, 4), 16);\n\t\tconst b = parseInt(hex.substring(4, 6), 16);\n\n\t\treturn `rgba(${r},${g},${b},${opacity})`;\n\t}\n\n\tgetFormattedTime(from: number, to: number): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn `${BX.date.format(Culture.getInstance().getShortTimeFormat(), from, null, true)\n\t\t\t} - ${BX.date.format(Culture.getInstance().getShortTimeFormat(), to, null, true)}`\n\t\t;\n\t\t/* eslint-enable */\n\t}\n}","import {Loc, Tag, Event, Dom, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {CreatedEvent, CreatedEventType} from './created.event';\nimport {Culture} from './culture';\n\nexport class ListEvents extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ListEvents');\n\n\t\tthis.listIsShown = false;\n\n\t\tthis.todayEvent = null;\n\n\t\tthis.node = null;\n\t\tthis.listNode = null;\n\t\tthis.buttonNode = null;\n\t}\n\n\tsetTodayEvent(todayEvent: ?CreatedEventType)\n\t{\n\t\tthis.todayEvent = todayEvent;\n\t}\n\n\texistsTodayEvent(): boolean\n\t{\n\t\treturn this.todayEvent !== null;\n\t}\n\n\trender(listEvents: Array<CreatedEventType>): HTMLElement\n\t{\n\t\tconst visibility = listEvents.length === 0 ? '' : '--visible';\n\n\t\tthis.listIsShown = listEvents.length > 0 && !this.existsTodayEvent();\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--plan-content  ${visibility}\">\n\t\t\t\t${this.renderList(listEvents)}\n\t\t\t\t${this.renderButton()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\trenderList(listEvents: Array<CreatedEventType>)\n\t{\n\t\tconst list = new Map();\n\t\tconst groupedList = new Map();\n\t\tconst sort = new Map();\n\n\t\tlistEvents.forEach((event: CreatedEventType) => {\n\t\t\tconst key = this.getFormattedDate(event.from);\n\t\t\tconst group = groupedList.has(key) ? groupedList.get(key) : new Set();\n\t\t\tgroup.add(event);\n\t\t\tsort.set(key, event.from);\n\t\t\tgroupedList.set(key, group);\n\t\t});\n\t\tconst sortedMap = new Map([...sort.entries()].sort((first, second) => first[1] - second[1]));\n\t\t[...sortedMap.keys()]\n\t\t\t.forEach((key: string) => {\n\t\t\t\tlist.set(key, groupedList.get(key));\n\t\t\t})\n\t\t;\n\n\t\tconst visibility = this.existsTodayEvent() ? '' : '--visible';\n\n\t\tthis.listNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--plan ${visibility}\">\n\t\t\t\t${this.renderSeparator()}\n\t\t\t\t${this.renderEvents(list)}\n\t\t\t</div>\n\t\t\t\n\t\t`;\n\n\t\tEvent.bind(this.listNode, 'transitionend', this.onTransitionEnd.bind(this));\n\n\t\treturn this.listNode;\n\t}\n\n\trenderSeparator(): ?HTMLElement\n\t{\n\t\tif (!this.existsTodayEvent())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--header-separator\">\n\t\t\t\t<span>${Loc.getMessage('TSM_PLANNING_EVENTS_TITLE')}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEvents(list: Map<string, Set<CreatedEventType>>): ?HTMLElement\n\t{\n\t\tif (list.size === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-wrapper\">\n\t\t\t\t${\n\t\t\t\t\t[...list.values()].map((group: Set<CreatedEventType>, index: number) => {\n\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-day\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-title\">\n\t\t\t\t\t\t\t\t\t${Text.encode([...list.keys()][index])}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\t[...group.values()]\n\t\t\t\t\t\t\t\t\t\t.map((event: CreatedEventType) => {\n\t\t\t\t\t\t\t\t\t\t\tconst createdEvent = new CreatedEvent();\n\t\t\t\t\t\t\t\t\t\t\tcreatedEvent.subscribe('showView', () => this.emit('showView'))\n\t\t\t\t\t\t\t\t\t\t\treturn createdEvent.render(event)\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`;\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderButton(): ?HTMLElement\n\t{\n\t\tthis.buttonNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings-btn-box-center \">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"tasks-scrum__widget-meetings--plan-btn ui-qr-popupcomponentmaker__btn --border --visible\"\n\t\t\t\t\tdata-role=\"toggle-list-events\"\n\t\t\t\t>\n\t\t\t\t\t${this.getButtonText()}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.buttonNode, 'click', () => {\n\t\t\tthis.listIsShown = !this.listIsShown;\n\t\t\tif (this.listIsShown)\n\t\t\t{\n\t\t\t\tthis.showList();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideList();\n\t\t\t}\n\t\t\tthis.buttonNode.querySelector('button').textContent = this.getButtonText();\n\t\t});\n\n\t\treturn this.buttonNode;\n\t}\n\n\tshowList()\n\t{\n\t\tthis.listNode.style.height = `${ this.listNode.scrollHeight }px`\n\n\t\tDom.addClass(this.listNode, '--visible');\n\t}\n\n\thideList()\n\t{\n\t\tthis.listNode.style.height = `${ this.listNode.scrollHeight }px`;\n\t\tthis.listNode.clientHeight;\n\t\tthis.listNode.style.height = '0';\n\n\t\tDom.removeClass(this.listNode, '--visible');\n\t}\n\n\tonTransitionEnd()\n\t{\n\t\tif (this.listNode.style.height !== '0px')\n\t\t{\n\t\t\tthis.listNode.style.height = 'auto'\n\t\t}\n\t}\n\n\tgetButtonText(): string\n\t{\n\t\tif (this.listIsShown)\n\t\t{\n\t\t\treturn Loc.getMessage('TSM_MEETINGS_SCHEDULED_BUTTON_HIDE');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Loc.getMessage('TSM_MEETINGS_SCHEDULED_BUTTON');\n\t\t}\n\t}\n\n\tgetFormattedDate(ts: number): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format(Culture.getInstance().getDayMonthFormat(), ts, null, true);\n\t\t/* eslint-enable */\n\t}\n}","import {Loc, Type, ajax} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype RequestParams = {\n\tgroupId: number,\n\ttaskId: number,\n\ttypeId?: number\n}\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tgetMeetings(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('calendar', 'getMeetings', data);\n\t}\n\n\tgetChat(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('calendar', 'getChat', data);\n\t}\n\n\tsaveEventInfo(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('calendar', 'saveEventInfo', data);\n\t}\n\n\tcloseTemplates(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('calendar', 'closeTemplates', data);\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.error(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TSM_MEETINGS_ERROR_POPUP_TITLE'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Event, Loc, Tag, Text, Type, Dom, ajax} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Loader} from 'main.loader';\nimport {Menu} from 'main.popup';\n\nimport {PopupComponentsMaker} from 'ui.popupcomponentsmaker';\n\nimport {CreatedEvent, CreatedEventType} from './created.event';\nimport {ListEvents} from './list.events';\nimport {RequestSender} from './request.sender';\nimport {Culture, CultureData} from './culture';\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport 'ui.hint';\nimport 'ui.icons.b24';\nimport 'ui.icons.service';\n\nimport '../css/base.css';\n\ntype Params = {\n\tgroupId: number\n}\n\ntype MeetingsResponse = {\n\tdata: {\n\t\tlistEvents: Array<CreatedEventType>,\n\t\tmapCreatedEvents: ?MapCreatedEvents,\n\t\ttodayEvent: ?CreatedEventType,\n\t\tisTemplatesClosed: boolean,\n\t\tdefaultSprintDuration: number,\n\t\tcalendarSettings: CalendarSettings,\n\t\tculture: CultureData\n\t}\n}\n\ntype CalendarSettings = {\n\tworkTimeStart: number,\n\tweekDays: Object,\n\tweekStart: Object,\n\tinterval: number\n}\n\ntype ChatsResponse = {\n\tdata: {\n\t\tchats: Array<Chat>\n\t}\n}\n\ntype MapCreatedEvents = {\n\tdaily?: number,\n\tplanning?: number,\n\treview?: number,\n\tretrospective?: number\n}\n\ntype Chat = {\n\tid: number,\n\ttype: string,\n\ticon: string,\n\tname: string,\n\tusers: Array<ChatUser>\n}\n\ntype ChatUser = {\n\tid: number,\n\tphoto: {\n\t\tsrc: string,\n\t},\n\tname: string,\n\tpathToUser: string\n}\n\ntype EventTemplate = {\n\tid: string,\n\tentityId: string,\n\tname: string,\n\tdesc: string,\n\tfrom: Date,\n\tto: Date,\n\trrule: Rrule,\n\troles: Array<EntityList>,\n\tuiClass: string,\n\tcolor: string,\n\thint: string\n}\n\ntype EntityList = {\n\tid: string,\n\tentityId: string\n}\n\ntype Rrule = {\n\tFREQ: string,\n\tINTERVAL: number,\n\tBYDAY: {\n\t\tWE: string,\n\t\tFR: string\n\t}\n}\n\nexport class Meetings\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\tthis.requestSender = new RequestSender();\n\n\t\tthis.todayEvent = new CreatedEvent();\n\t\tthis.listEvents = new ListEvents();\n\t\tthis.listEvents.subscribe('showView', this.onShowView.bind(this))\n\n\t\tthis.menu = null;\n\t\tthis.eventTemplatesMenu = null;\n\t}\n\n\tshowMenu(targetNode: HTMLElement)\n\t{\n\t\tif (this.menu)\n\t\t{\n\t\t\tif (this.menu.isShown())\n\t\t\t{\n\t\t\t\tthis.menu.close();\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst response = this.requestSender.getMeetings({\n\t\t\tgroupId: this.groupId\n\t\t}).then((response: MeetingsResponse) => {\n\t\t\tCulture.getInstance().setData(response.data.culture);\n\n\t\t\treturn response;\n\t\t});\n\n\t\tthis.menu = new PopupComponentsMaker({\n\t\t\tid: 'tasks-scrum-meetings-widget',\n\t\t\ttarget: targetNode,\n\t\t\tcacheable: false,\n\t\t\tcontent: [\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.renderMeetings(response),\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.renderChats(response),\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t]\n\t\t});\n\n\t\tthis.menu.show();\n\t}\n\n\trenderMeetings(response: Promise): Promise\n\t{\n\t\treturn response\n\t\t\t.then((response: MeetingsResponse) => {\n\t\t\t\tthis.meetingsNode = Tag.render`\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings tasks-scrum__widget-meetings--scope\">\n\t\t\t\t\t\t${this.renderMeetingsHeader(response)}\n\t\t\t\t\t\t${this.renderEventTemplates(response)}\n\t\t\t\t\t\t${this.renderScheduledMeetings(response)}\n\t\t\t\t\t</div>`\n\t\t\t\t;\n\n\t\t\t\treturn this.meetingsNode;\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trenderChats(response: Promise): HTMLElement\n\t{\n\t\treturn response\n\t\t\t.then((response: ChatsResponse) => {\n\t\t\t\tconst chats = response.data.chats;\n\t\t\t\tconst node = Tag.render`\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings tasks-scrum__widget-meetings--scope\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--header\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"ui-icon ui-icon-service-livechat tasks-scrum__widget-meetings--icon-chats\"\n\t\t\t\t\t\t\t><i></i></div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--header-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TSM_CHATS_HEADER_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.renderChatsList(chats)}\n\t\t\t\t\t\t${this.renderChatsEmpty(chats)}\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\t\treturn node;\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trenderChatsList(chats: Array<Chat>): HTMLElement\n\t{\n\t\tconst visibility = chats.length > 0 ? '--visible' : '';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--chat-content ${visibility}\">\n\t\t\t\t${\n\t\t\t\t\tchats.map((chat: Chat) => {\n\t\t\t\t\t\tconst chatIconClass = chat.icon === '' ? 'default' : '';\n\t\t\t\t\t\tconst chatIconStyle = chat.icon !== '' ? `background-image: url('${chat.icon}');` : '';\n\t\t\t\t\t\tconst chatNode = Tag.render`\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--chat-container\">\n\t\t\t\t\t\t\t\t<div class=\"ui-icon ui-icon-common-company tasks-scrum__widget-meetings--chat-icon\">\n\t\t\t\t\t\t\t\t\t<i\n\t\t\t\t\t\t\t\t\tclass=\"chat-icon ${chatIconClass}\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"${chatIconStyle}\"\n\t\t\t\t\t\t\t\t\t></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--chat-info\">\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--chat-name\">\n\t\t\t\t\t\t\t\t\t\t${chat.name}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"users-icon tasks-scrum__widget-meetings--chat-users\">\n\t\t\t\t\t\t\t\t\t\t${this.renderChatUser(chat.users)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`;\n\n\t\t\t\t\t\tEvent.bind(chatNode, 'click', this.openChat.bind(this, chat, chatNode));\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn chatNode;\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\topenChat(chat: Chat, chatNode: HTMLElement)\n\t{\n\t\tconst loader = new Loader({\n\t\t\ttarget: chatNode,\n\t\t\tsize: 34,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t});\n\n\t\tloader.show();\n\n\t\tthis.requestSender.getChat({\n\t\t\tgroupId: this.groupId,\n\t\t\tchatId: chat.id\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tif (top.window.BXIM)\n\t\t\t\t{\n\t\t\t\t\ttop.BXIM.openMessenger('chat' + parseInt(chat.id));\n\n\t\t\t\t\tthis.menu.close();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trenderChatUser(users: Array<ChatUser>): HTMLElement\n\t{\n\t\tconst uiIconClasses = 'tasks-scrum__widget-meetings--chat-icon-user ui-icon ui-icon-common-user';\n\n\t\treturn Tag.render`\n\t\t\t${\n\t\t\t\tusers.map((user: ChatUser) => {\n\t\t\t\t\tconst src = user.photo ? encodeURI(Text.encode(user.photo.src)) : null;\n\t\t\t\t\tconst photoStyle = src ? `background-image: url('${src}');` : '';\n\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t<div class=\"user-icon ${uiIconClasses}\" title=\"${Text.encode(user.name)}\">\n\t\t\t\t\t\t\t<i style=\"${photoStyle}\"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\t\t\t\t})\n\t\t\t}\n\t\t`\n\t}\n\n\trenderChatsEmpty(chats: Array<Chat>): HTMLElement\n\t{\n\t\tconst visibility = chats.length > 0 ? '' : '--visible';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--content\">\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-chats ${visibility}\">\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-name\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_CHATS_EMPTY_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-text\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_CHATS_EMPTY_TEXT')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderMeetingsHeader(response: MeetingsResponse): HTMLElement\n\t{\n\t\tconst calendarSettings = response.data.calendarSettings;\n\n\t\tconst uiClasses = 'ui-btn-split ui-btn-light-border ui-btn-xs ui-btn-light ui-btn-no-caps ui-btn-round';\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--header\">\n\n\t\t\t\t<div class=\"ui-icon ui-icon-service-calendar tasks-scrum__widget-meetings--icon-calendar\">\n\t\t\t\t\t<i></i>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--header-title\">\n\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_HEADER_TITLE')}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--btn-create ${uiClasses}\">\n\t\t\t\t\t<button class=\"ui-btn-main\" data-role=\"create-default-event\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_CREATE_BUTTON')}\n\t\t\t\t\t</button>\n\t\t\t\t\t<div class=\"ui-btn-menu\" data-role=\"show-menu-event-templates\"></div>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t`;\n\n\t\tconst button = node.querySelector('button');\n\t\tconst menu = node.querySelector('.ui-btn-menu');\n\n\t\tEvent.bind(button, 'click', this.showEventSidePanel.bind(this));\n\t\tEvent.bind(menu, 'click', this.showMenuWithEventTemplates.bind(this, button, calendarSettings));\n\n\t\treturn node;\n\t}\n\n\trenderEventTemplates(response: MeetingsResponse): HTMLElement\n\t{\n\t\tconst mapCreatedEvents = response.data.mapCreatedEvents;\n\t\tconst listEvents = response.data.listEvents;\n\t\tconst isTemplatesClosed = response.data.isTemplatesClosed;\n\t\tconst calendarSettings = response.data.calendarSettings;\n\n\t\tconst templateVisibility = (\n\t\t\tisTemplatesClosed\n\t\t\t|| this.isAllEventsCreated(mapCreatedEvents)\n\t\t\t\t? ''\n\t\t\t\t: '--visible'\n\t\t);\n\t\tconst emptyVisibility = (isTemplatesClosed && listEvents.length === 0 ? '--visible' : '');\n\n\t\tconst contentVisibilityClass = emptyVisibility === '' && templateVisibility === '' ? '--content-hidden' : '';\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--content ${contentVisibilityClass}\">\n\t\t\t\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--creation-block ${templateVisibility}\">\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"tasks-scrum__widget-meetings--creation-close-btn\"\n\t\t\t\t\t\tdata-role=\"close-event-templates\"\n\t\t\t\t\t></span>\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--create-element-info\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATES_INFO')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${\n\t\t\t\t\t\t[...this.getEventTemplates(calendarSettings).values()]\n\t\t\t\t\t\t\t.map((eventTemplate: EventTemplate) => {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tType.isArray(mapCreatedEvents)\n\t\t\t\t\t\t\t\t\t|| Type.isUndefined(mapCreatedEvents[eventTemplate.id])\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn this.renderEventTemplate(eventTemplate);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-meetings ${emptyVisibility}\">\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-name\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_EMPTY_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-text\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_EMPTY_TEXT')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class=\"tasks-scrum__widget-meetings--one-click-btn ui-qr-popupcomponentmaker__btn\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_CREATE_ONE_CLICK')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst closeButton = node.querySelector('.tasks-scrum__widget-meetings--creation-close-btn');\n\t\tconst oneClickButton = node.querySelector('.tasks-scrum__widget-meetings--one-click-btn');\n\n\t\tconst templatesNode = node.querySelector('.tasks-scrum__widget-meetings--creation-block');\n\t\tconst emptyNode = node.querySelector('.tasks-scrum__widget-meetings--empty-meetings');\n\n\t\tEvent.bind(closeButton, 'click', () => {\n\t\t\tDom.removeClass(templatesNode, '--visible');\n\t\t\tconst isExistsEvent = listEvents.length;\n\t\t\tif (!isExistsEvent)\n\t\t\t{\n\t\t\t\tDom.addClass(emptyNode, '--visible');\n\t\t\t}\n\t\t\tthis.requestSender.closeTemplates({\n\t\t\t\tgroupId: this.groupId\n\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t\tEvent.bind(oneClickButton, 'click', () => {\n\t\t\tDom.addClass(templatesNode, '--visible');\n\t\t\tDom.removeClass(emptyNode, '--visible');\n\t\t});\n\n\t\treturn node;\n\t}\n\n\trenderScheduledMeetings(response: MeetingsResponse): HTMLElement\n\t{\n\t\tconst todayEvent = response.data.todayEvent;\n\t\tconst listEvents = response.data.listEvents;\n\n\t\tconst todayEventVisibility = (Type.isNull(todayEvent)? '' : '--visible');\n\n\t\tthis.listEvents.setTodayEvent(todayEvent);\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable\">\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-container ${todayEventVisibility}\">\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-title\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_TODAY_EVENT_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.todayEvent.render(todayEvent)}\n\t\t\t\t</div>\n\t\t\t\t${this.listEvents.render(listEvents, todayEvent)}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn node;\n\t}\n\n\trenderEventTemplate(eventTemplate: EventTemplate): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--create-element ${Text.encode(eventTemplate.uiClass)}\">\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--create-element-title\">\n\t\t\t\t\t<span class=\"tasks-scrum__widget-meetings--create-element-name\">\n\t\t\t\t\t\t${Text.encode(eventTemplate.name)}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"ui-hint\">\n\t\t\t\t\t\t<i\n\t\t\t\t\t\t\tclass=\"ui-hint-icon\"\n\t\t\t\t\t\t\tdata-hint=\"${eventTemplate.hint}\"\n\t\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t\t\tdata-hint-html\n\t\t\t\t\t\t></i>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--create-btn\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"ui-qr-popupcomponentmaker__btn\"\n\t\t\t\t\t\tdata-role=\"create-event-template-${eventTemplate.id}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_CREATE_BUTTON')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst createButton = node.querySelector('.tasks-scrum__widget-meetings--create-btn');\n\n\t\tEvent.bind(createButton, 'click', this.openCalendarSidePanel.bind(this, eventTemplate));\n\n\t\tthis.initHints(node);\n\n\t\treturn node;\n\t}\n\n\tonShowView()\n\t{\n\t\tthis.menu.close();\n\t}\n\n\tshowEventSidePanel()\n\t{\n\t\tthis.openCalendarSidePanel();\n\t}\n\n\tshowMenuWithEventTemplates(targetNode: HTMLElement, calendarSettings: CalendarSettings)\n\t{\n\t\tif (this.eventTemplatesMenu)\n\t\t{\n\t\t\tif (this.eventTemplatesMenu.getPopupWindow().isShown())\n\t\t\t{\n\t\t\t\tthis.eventTemplatesMenu.close();\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.eventTemplatesMenu = new Menu({\n\t\t\tid: 'tsm-event-templates-menu',\n\t\t\tbindElement: targetNode,\n\t\t\tcloseByEsc : true\n\t\t});\n\n\t\tthis.eventTemplatesMenu.addMenuItem({\n\t\t\ttext: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_BLANK'),\n\t\t\tdelimiter: true\n\t\t});\n\n\t\tthis.getEventTemplates(calendarSettings)\n\t\t\t.forEach((eventTemplate: EventTemplate) => {\n\t\t\t\tthis.eventTemplatesMenu.addMenuItem({\n\t\t\t\t\ttext: eventTemplate.name,\n\t\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\t\tthis.openCalendarSidePanel(eventTemplate);\n\t\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t;\n\n\t\tthis.eventTemplatesMenu.getPopupWindow()\n\t\t\t.subscribe('onClose', () => {\n\t\t\t\tthis.eventTemplatesMenu.destroy();\n\t\t\t})\n\t\t;\n\n\t\tthis.eventTemplatesMenu.show();\n\t}\n\n\topenCalendarSidePanel(eventTemplate?: EventTemplate)\n\t{\n\t\tconst participantsEntityList = eventTemplate ? eventTemplate.roles: [];\n\n\t\tconst formData = eventTemplate\n\t\t\t? {\n\t\t\t\tname: eventTemplate.name,\n\t\t\t\tdescription: eventTemplate.desc,\n\t\t\t\tfrom: eventTemplate.from,\n\t\t\t\tto: eventTemplate.to,\n\t\t\t\tcolor: eventTemplate.color,\n\t\t\t\trrule: eventTemplate.rrule\n\t\t\t}\n\t\t\t: {\n\t\t\t\tname: '',\n\t\t\t\tdescription: '',\n\t\t\t\tcolor: '#86b100'\n\t\t\t}\n\t\t;\n\n\t\tconst sliderId = Text.getRandom();\n\n\t\tnew window.top.BX.Calendar.SliderLoader(\n\t\t\t0,\n\t\t\t{\n\t\t\t\tsliderId: sliderId,\n\t\t\t\tparticipantsSelectorEntityList: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project-roles',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tprojectId: this.groupId\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdynamicLoad: true\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tformDataValue: formData,\n\t\t\t\tparticipantsEntityList: participantsEntityList,\n\t\t\t\ttype: 'group',\n\t\t\t\townerId: this.groupId\n\t\t\t}\n\t\t).show();\n\n\t\tEventEmitter.subscribeOnce(\n\t\t\t'BX.Calendar:onEntrySave',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tconst data = baseEvent.getData();\n\t\t\t\tif (sliderId === data.sliderId)\n\t\t\t\t{\n\t\t\t\t\tif (eventTemplate)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.requestSender.saveEventInfo({\n\t\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\t\ttemplateId: eventTemplate.id,\n\t\t\t\t\t\t\teventId: data.responseData.entryId\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t// todo maybe update widget or repeat request if error\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch((response) => {\n\t\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\n\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t'bitrix:tasks.scrum.info.saveAnalyticsLabel',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\t\t\tscrum: 'Y',\n\t\t\t\t\t\t\t\taction: 'create_meet',\n\t\t\t\t\t\t\t\ttemplate: eventTemplate ? eventTemplate.id : 'custom'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis.menu.close();\n\t}\n\n\tgetEventTemplates(calendarSettings: CalendarSettings): Set<EventTemplate>\n\t{\n\t\tconst eventTemplates = new Set();\n\n\t\tconst daysNumberMap = {\n\t\t\tMO: 1,\n\t\t\tTU: 2,\n\t\t\tWE: 3,\n\t\t\tTH: 4,\n\t\t\tFR: 5,\n\t\t\tSA: 6,\n\t\t\tSU: 7\n\t\t}\n\n\t\tconst weekStartDay = calendarSettings.weekStart[Object.keys(calendarSettings.weekStart)[0]];\n\t\tconst weekStartDayNumber = daysNumberMap[weekStartDay];\n\n\t\teventTemplates.add({\n\t\t\tid: 'daily',\n\t\t\tentityId: 'project-roles',\n\t\t\tname: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_NAME_DAILY'),\n\t\t\tdesc: '',\n\t\t\tfrom: new Date((new Date()).setHours(calendarSettings.workTimeStart, 0, 0)),\n\t\t\tto: new Date((new Date()).setHours(calendarSettings.workTimeStart, 15, 0)),\n\t\t\trrule: {\n\t\t\t\tFREQ: 'WEEKLY',\n\t\t\t\tINTERVAL: 1,\n\t\t\t\tBYDAY: calendarSettings.weekDays\n\t\t\t},\n\t\t\troles: [\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_M',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_E',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t}\n\t\t\t],\n\t\t\tuiClass: 'widget-meetings__sprint-daily',\n\t\t\tcolor: '#2FC6F6',\n\t\t\thint: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_HINT_DAILY')\n\t\t});\n\n\t\teventTemplates.add({\n\t\t\tid: 'planning',\n\t\t\tentityId: 'project-roles',\n\t\t\tname: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_NAME_PLANNING'),\n\t\t\tdesc: '',\n\t\t\tfrom: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart, 0, 0)\n\t\t\t),\n\t\t\tto: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart + 1, 0, 0)\n\t\t\t),\n\t\t\trrule: {\n\t\t\t\tFREQ: 'WEEKLY',\n\t\t\t\tINTERVAL: calendarSettings.interval,\n\t\t\t\tBYDAY: calendarSettings.weekStart\n\t\t\t},\n\t\t\troles: [\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_A',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_M',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_E',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t}\n\t\t\t],\n\t\t\tuiClass: 'widget-meetings__sprint-planning',\n\t\t\tcolor: '#DA51D4',\n\t\t\thint: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_HINT_PLANNING')\n\t\t});\n\n\t\teventTemplates.add({\n\t\t\tid: 'review',\n\t\t\tentityId: 'project-roles',\n\t\t\tname: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_NAME_REVIEW'),\n\t\t\tdesc: '',\n\t\t\tfrom: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart, 0, 0)\n\t\t\t),\n\t\t\tto: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart + 1, 0, 0)\n\t\t\t),\n\t\t\trrule: {\n\t\t\t\tFREQ: 'WEEKLY',\n\t\t\t\tINTERVAL: calendarSettings.interval,\n\t\t\t\tBYDAY: calendarSettings.weekStart\n\t\t\t},\n\t\t\troles: [\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_A',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_M',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_E',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t}\n\t\t\t],\n\t\t\tuiClass: 'widget-meetings__sprint-review',\n\t\t\tcolor: '#FF5752',\n\t\t\thint: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_HINT_REVIEW')\n\t\t});\n\n\t\teventTemplates.add({\n\t\t\tid: 'retrospective',\n\t\t\tentityId: 'project-roles',\n\t\t\tname: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_NAME_RETROSPECTIVE'),\n\t\t\tdesc: '',\n\t\t\tfrom: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart, 0, 0)\n\t\t\t),\n\t\t\tto: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart + 1, 0, 0)\n\t\t\t),\n\t\t\trrule: {\n\t\t\t\tFREQ: 'WEEKLY',\n\t\t\t\tINTERVAL: calendarSettings.interval,\n\t\t\t\tBYDAY: calendarSettings.weekStart\n\t\t\t},\n\t\t\troles: [\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_M',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_E',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t}\n\t\t\t],\n\t\t\tuiClass: 'widget-meetings__sprint-retrospective',\n\t\t\tcolor: '#FF5752',\n\t\t\thint: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_HINT_RETROSPECTIVE')\n\t\t});\n\n\t\treturn eventTemplates;\n\t}\n\n\tisAllEventsCreated(mapCreatedEvents: ?MapCreatedEvents): boolean\n\t{\n\t\tif (Type.isArray(mapCreatedEvents))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn (\n\t\t\tType.isInteger(mapCreatedEvents.daily)\n\t\t\t&& Type.isInteger(mapCreatedEvents.planning)\n\t\t\t&& Type.isInteger(mapCreatedEvents.review)\n\t\t\t&& Type.isInteger(mapCreatedEvents.retrospective)\n\t\t);\n\t}\n\n\tgetNextWeekStartDate(weekStartDayNumber: number): Date\n\t{\n\t\tconst date = new Date();\n\t\tconst targetDate = new Date();\n\n\t\tconst delta = weekStartDayNumber - date.getDay();\n\n\t\tif (delta >= 0)\n\t\t{\n\t\t\ttargetDate.setDate(date.getDate() + delta)\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttargetDate.setDate(date.getDate() + 7 + delta)\n\t\t}\n\n\t\treturn targetDate;\n\t}\n\n\tinitHints(node: HTMLElement)\n\t{\n\t\tBX.UI.Hint.init(node);\n\t}\n}\n"],"names":["Culture","data","dayMonthFormat","longDateFormat","shortTimeFormat","CreatedEvent","setEventNamespace","node","event","color","colorBorder","convertHexToRGBA","colorBackground","Tag","render","getFormattedTime","from","to","renderVideoCallButton","Text","encode","name","repeatable","renderRepetition","Event","bind","openViewCalendarSidePanel","window","top","BX","Calendar","SliderLoader","id","entryDateFrom","Date","show","emit","videoCallUiClasses","Loc","getMessage","hexCode","opacity","hex","replace","length","r","parseInt","substring","g","b","date","format","getInstance","getShortTimeFormat","EventEmitter","ListEvents","listIsShown","todayEvent","listNode","buttonNode","listEvents","visibility","existsTodayEvent","renderList","renderButton","list","Map","groupedList","sort","forEach","key","getFormattedDate","group","has","get","Set","add","set","sortedMap","entries","first","second","keys","renderSeparator","renderEvents","onTransitionEnd","size","values","map","index","createdEvent","subscribe","getButtonText","showList","hideList","querySelector","textContent","style","height","scrollHeight","Dom","addClass","clientHeight","removeClass","ts","getDayMonthFormat","RequestSender","controller","action","Promise","resolve","reject","ajax","runAction","then","sendRequest","response","alertTitle","Type","isUndefined","errors","console","error","firstError","shift","errorCode","code","message","title","MessageBox","alert","Meetings","params","groupId","requestSender","onShowView","menu","eventTemplatesMenu","targetNode","isShown","close","getMeetings","setData","culture","PopupComponentsMaker","target","cacheable","content","html","renderMeetings","renderChats","meetingsNode","renderMeetingsHeader","renderEventTemplates","renderScheduledMeetings","showErrorAlert","chats","renderChatsList","renderChatsEmpty","chat","chatIconClass","icon","chatIconStyle","chatNode","renderChatUser","users","openChat","loader","Loader","mode","getChat","chatId","BXIM","openMessenger","uiIconClasses","user","src","photo","encodeURI","photoStyle","calendarSettings","uiClasses","button","showEventSidePanel","showMenuWithEventTemplates","mapCreatedEvents","isTemplatesClosed","templateVisibility","isAllEventsCreated","emptyVisibility","contentVisibilityClass","getEventTemplates","eventTemplate","isArray","renderEventTemplate","closeButton","oneClickButton","templatesNode","emptyNode","isExistsEvent","closeTemplates","todayEventVisibility","isNull","setTodayEvent","uiClass","hint","createButton","openCalendarSidePanel","initHints","getPopupWindow","Menu","bindElement","closeByEsc","addMenuItem","text","delimiter","onclick","menuItem","getMenuWindow","destroy","participantsEntityList","roles","formData","description","desc","rrule","sliderId","getRandom","participantsSelectorEntityList","options","projectId","dynamicLoad","formDataValue","type","ownerId","subscribeOnce","baseEvent","getData","saveEventInfo","templateId","eventId","responseData","entryId","analyticsLabel","scrum","template","eventTemplates","daysNumberMap","MO","TU","WE","TH","FR","SA","SU","weekStartDay","weekStart","Object","weekStartDayNumber","entityId","setHours","workTimeStart","FREQ","INTERVAL","BYDAY","weekDays","getNextWeekStartDate","interval","isInteger","daily","planning","review","retrospective","targetDate","delta","getDay","setDate","getDate","UI","Hint","init"],"mappings":"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"}