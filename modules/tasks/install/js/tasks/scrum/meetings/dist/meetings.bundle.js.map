{"version":3,"file":"meetings.bundle.js","sources":["../src/culture.js","../src/created.event.js","../src/list.events.js","../src/request.sender.js","../src/meetings.js"],"sourcesContent":["export type CultureData = {\n\tdayMonthFormat: string,\n\tlongDateFormat: string,\n\tshortTimeFormat: string\n}\n\nexport class Culture\n{\n\tstatic #instance;\n\n\tstatic getInstance()\n\t{\n\t\tif (!Culture.#instance)\n\t\t{\n\t\t\tCulture.#instance = new Culture();\n\t\t}\n\n\t\treturn Culture.#instance;\n\t}\n\n\tsetData(data: CultureData)\n\t{\n\t\tthis.data = data;\n\t}\n\n\tgetDayMonthFormat(): string\n\t{\n\t\treturn this.data.dayMonthFormat;\n\t}\n\n\tgetLongDateFormat(): string\n\t{\n\t\treturn this.data.longDateFormat;\n\t}\n\n\tgetShortTimeFormat(): string\n\t{\n\t\treturn this.data.shortTimeFormat;\n\t}\n}","import {Loc, Tag, Event, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Culture} from './culture';\n\nexport type CreatedEventType = {\n\tid: number,\n\tname: string,\n\tcolor: string,\n\tfrom: number,\n\tto: number,\n\trepeatable: boolean\n}\n\nexport class CreatedEvent extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.CreatedEvent');\n\n\t\tthis.node = null;\n\t}\n\n\trender(event: ?CreatedEventType): ?HTMLElement\n\t{\n\t\tif (event === null)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tevent.color = (event.color === '' ? '#86b100' : event.color);\n\n\t\tconst colorBorder = this.convertHexToRGBA(event.color, 0.5);\n\t\tconst colorBackground = this.convertHexToRGBA(event.color, 0.15);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-scrum__widget-meetings--timetable-content\"\n\t\t\t\tstyle=\"background: ${colorBackground}; --meetings-border-color: ${colorBorder};\"\n\t\t\t>\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-navigation\">\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-time\">\n\t\t\t\t\t\t${this.getFormattedTime(event.from, event.to)}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderVideoCallButton()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-name\">${Text.encode(event.name)}</div>\n\t\t\t\t${event.repeatable ? this.renderRepetition() : ''}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.openViewCalendarSidePanel.bind(this, event));\n\n\t\treturn this.node;\n\t}\n\n\topenViewCalendarSidePanel(event: CreatedEventType)\n\t{\n\t\tnew window.top.BX.Calendar.SliderLoader(\n\t\t\tevent.id,\n\t\t\t{\n\t\t\t\tentryDateFrom: new Date(event.from * 1000)\n\t\t\t}\n\t\t).show();\n\n\t\tthis.emit('showView');\n\t}\n\n\trenderVideoCallButton(): ?HTMLElement\n\t{\n\t\treturn '';\n\n\t\tconst videoCallUiClasses = 'ui-btn-split ui-btn-light-border ui-btn-xs ui-btn-light ui-btn-no-caps';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-video-call ${videoCallUiClasses}\">\n\t\t\t\t<button class=\"ui-btn-main\">\n\t\t\t\t\t${Loc.getMessage('TSM_VIDEO_CALL_BUTTON')}\n\t\t\t\t</button>\n\t\t\t\t<div class=\"ui-btn-menu\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderRepetition(): ?HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-repetition\">\n\t\t\t\t<i class=\"tasks-scrum__widget-meetings--timetable-repetition-icon\"></i>\n\t\t\t\t<span>${Loc.getMessage('TSM_REPETITION_TITLE')}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tconvertHexToRGBA(hexCode, opacity)\n\t{\n\t\tlet hex = hexCode.replace('#', '');\n\n\t\tif (hex.length === 3)\n\t\t{\n\t\t\thex = `${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;\n\t\t}\n\n\t\tconst r = parseInt(hex.substring(0, 2), 16);\n\t\tconst g = parseInt(hex.substring(2, 4), 16);\n\t\tconst b = parseInt(hex.substring(4, 6), 16);\n\n\t\treturn `rgba(${r},${g},${b},${opacity})`;\n\t}\n\n\tgetFormattedTime(from: number, to: number): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn `${BX.date.format(Culture.getInstance().getShortTimeFormat(), from, null, true)\n\t\t\t} - ${BX.date.format(Culture.getInstance().getShortTimeFormat(), to, null, true)}`\n\t\t;\n\t\t/* eslint-enable */\n\t}\n}","import {Loc, Tag, Event, Dom, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {CreatedEvent, CreatedEventType} from './created.event';\nimport {Culture} from './culture';\n\nexport class ListEvents extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ListEvents');\n\n\t\tthis.listIsShown = false;\n\n\t\tthis.todayEvent = null;\n\n\t\tthis.node = null;\n\t\tthis.listNode = null;\n\t\tthis.buttonNode = null;\n\t}\n\n\tsetTodayEvent(todayEvent: ?CreatedEventType)\n\t{\n\t\tthis.todayEvent = todayEvent;\n\t}\n\n\texistsTodayEvent(): boolean\n\t{\n\t\treturn this.todayEvent !== null;\n\t}\n\n\trender(listEvents: Array<CreatedEventType>): HTMLElement\n\t{\n\t\tconst visibility = listEvents.length === 0 ? '' : '--visible';\n\n\t\tthis.listIsShown = listEvents.length > 0 && !this.existsTodayEvent();\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--plan-content  ${visibility}\">\n\t\t\t\t${this.renderList(listEvents)}\n\t\t\t\t${this.renderButton()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\trenderList(listEvents: Array<CreatedEventType>)\n\t{\n\t\tconst list = new Map();\n\t\tconst groupedList = new Map();\n\t\tconst sort = new Map();\n\n\t\tlistEvents.forEach((event: CreatedEventType) => {\n\t\t\tconst key = this.getFormattedDate(event.from);\n\t\t\tconst group = groupedList.has(key) ? groupedList.get(key) : new Set();\n\t\t\tgroup.add(event);\n\t\t\tsort.set(key, event.from);\n\t\t\tgroupedList.set(key, group);\n\t\t});\n\t\tconst sortedMap = new Map([...sort.entries()].sort((first, second) => first[1] - second[1]));\n\t\t[...sortedMap.keys()]\n\t\t\t.forEach((key: string) => {\n\t\t\t\tlist.set(key, groupedList.get(key));\n\t\t\t})\n\t\t;\n\n\t\tconst visibility = this.existsTodayEvent() ? '' : '--visible';\n\n\t\tthis.listNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--plan ${visibility}\">\n\t\t\t\t${this.renderSeparator()}\n\t\t\t\t${this.renderEvents(list)}\n\t\t\t</div>\n\t\t\t\n\t\t`;\n\n\t\tEvent.bind(this.listNode, 'transitionend', this.onTransitionEnd.bind(this));\n\n\t\treturn this.listNode;\n\t}\n\n\trenderSeparator(): ?HTMLElement\n\t{\n\t\tif (!this.existsTodayEvent())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--header-separator\">\n\t\t\t\t<span>${Loc.getMessage('TSM_PLANNING_EVENTS_TITLE')}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEvents(list: Map<string, Set<CreatedEventType>>): ?HTMLElement\n\t{\n\t\tif (list.size === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-wrapper\">\n\t\t\t\t${\n\t\t\t\t\t[...list.values()].map((group: Set<CreatedEventType>, index: number) => {\n\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-day\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-title\">\n\t\t\t\t\t\t\t\t\t${Text.encode([...list.keys()][index])}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\t[...group.values()]\n\t\t\t\t\t\t\t\t\t\t.map((event: CreatedEventType) => {\n\t\t\t\t\t\t\t\t\t\t\tconst createdEvent = new CreatedEvent();\n\t\t\t\t\t\t\t\t\t\t\tcreatedEvent.subscribe('showView', () => this.emit('showView'))\n\t\t\t\t\t\t\t\t\t\t\treturn createdEvent.render(event)\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`;\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderButton(): ?HTMLElement\n\t{\n\t\tthis.buttonNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings-btn-box-center \">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"tasks-scrum__widget-meetings--plan-btn ui-qr-popupcomponentmaker__btn --border --visible\"\n\t\t\t\t\tdata-role=\"toggle-list-events\"\n\t\t\t\t>\n\t\t\t\t\t${this.getButtonText()}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.buttonNode, 'click', () => {\n\t\t\tthis.listIsShown = !this.listIsShown;\n\t\t\tif (this.listIsShown)\n\t\t\t{\n\t\t\t\tthis.showList();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideList();\n\t\t\t}\n\t\t\tthis.buttonNode.querySelector('button').textContent = this.getButtonText();\n\t\t});\n\n\t\treturn this.buttonNode;\n\t}\n\n\tshowList()\n\t{\n\t\tthis.listNode.style.height = `${ this.listNode.scrollHeight }px`\n\n\t\tDom.addClass(this.listNode, '--visible');\n\t}\n\n\thideList()\n\t{\n\t\tthis.listNode.style.height = `${ this.listNode.scrollHeight }px`;\n\t\tthis.listNode.clientHeight;\n\t\tthis.listNode.style.height = '0';\n\n\t\tDom.removeClass(this.listNode, '--visible');\n\t}\n\n\tonTransitionEnd()\n\t{\n\t\tif (this.listNode.style.height !== '0px')\n\t\t{\n\t\t\tthis.listNode.style.height = 'auto'\n\t\t}\n\t}\n\n\tgetButtonText(): string\n\t{\n\t\tif (this.listIsShown)\n\t\t{\n\t\t\treturn Loc.getMessage('TSM_MEETINGS_SCHEDULED_BUTTON_HIDE');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Loc.getMessage('TSM_MEETINGS_SCHEDULED_BUTTON');\n\t\t}\n\t}\n\n\tgetFormattedDate(ts: number): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format(Culture.getInstance().getDayMonthFormat(), ts, null, true);\n\t\t/* eslint-enable */\n\t}\n}","import {Loc, Type, ajax} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype RequestParams = {\n\tgroupId: number,\n\ttaskId: number,\n\ttypeId?: number\n}\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tgetMeetings(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('calendar', 'getMeetings', data);\n\t}\n\n\tgetChat(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('calendar', 'getChat', data);\n\t}\n\n\tsaveEventInfo(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('calendar', 'saveEventInfo', data);\n\t}\n\n\tcloseTemplates(data: RequestParams): Promise\n\t{\n\t\treturn this.sendRequest('calendar', 'closeTemplates', data);\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.error(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TSM_MEETINGS_ERROR_POPUP_TITLE'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Event, Loc, Tag, Text, Type, Dom, ajax} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Loader} from 'main.loader';\nimport {Menu} from 'main.popup';\n\nimport {PopupComponentsMaker} from 'ui.popupcomponentsmaker';\n\nimport {CreatedEvent, CreatedEventType} from './created.event';\nimport {ListEvents} from './list.events';\nimport {RequestSender} from './request.sender';\nimport {Culture, CultureData} from './culture';\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport 'ui.hint';\nimport 'ui.icons.b24';\nimport 'ui.icons.service';\n\nimport '../css/base.css';\n\ntype Params = {\n\tgroupId: number\n}\n\ntype MeetingsResponse = {\n\tdata: {\n\t\tlistEvents: Array<CreatedEventType>,\n\t\tmapCreatedEvents: ?MapCreatedEvents,\n\t\ttodayEvent: ?CreatedEventType,\n\t\tisTemplatesClosed: boolean,\n\t\tdefaultSprintDuration: number,\n\t\tcalendarSettings: CalendarSettings,\n\t\tculture: CultureData\n\t}\n}\n\ntype CalendarSettings = {\n\tworkTimeStart: number,\n\tweekDays: Object,\n\tweekStart: Object,\n\tinterval: number\n}\n\ntype ChatsResponse = {\n\tdata: {\n\t\tchats: Array<Chat>\n\t}\n}\n\ntype MapCreatedEvents = {\n\tdaily?: number,\n\tplanning?: number,\n\treview?: number,\n\tretrospective?: number\n}\n\ntype Chat = {\n\tid: number,\n\ttype: string,\n\ticon: string,\n\tname: string,\n\tusers: Array<ChatUser>\n}\n\ntype ChatUser = {\n\tid: number,\n\tphoto: {\n\t\tsrc: string,\n\t},\n\tname: string,\n\tpathToUser: string\n}\n\ntype EventTemplate = {\n\tid: string,\n\tentityId: string,\n\tname: string,\n\tdesc: string,\n\tfrom: Date,\n\tto: Date,\n\trrule: Rrule,\n\troles: Array<EntityList>,\n\tuiClass: string,\n\tcolor: string,\n\thint: string\n}\n\ntype EntityList = {\n\tid: string,\n\tentityId: string\n}\n\ntype Rrule = {\n\tFREQ: string,\n\tINTERVAL: number,\n\tBYDAY: {\n\t\tWE: string,\n\t\tFR: string\n\t}\n}\n\nexport class Meetings\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\tthis.requestSender = new RequestSender();\n\n\t\tthis.todayEvent = new CreatedEvent();\n\t\tthis.listEvents = new ListEvents();\n\t\tthis.listEvents.subscribe('showView', this.onShowView.bind(this))\n\n\t\tthis.menu = null;\n\t\tthis.eventTemplatesMenu = null;\n\t}\n\n\tshowMenu(targetNode: HTMLElement)\n\t{\n\t\tif (this.menu)\n\t\t{\n\t\t\tif (this.menu.isShown())\n\t\t\t{\n\t\t\t\tthis.menu.close();\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst response = this.requestSender.getMeetings({\n\t\t\tgroupId: this.groupId\n\t\t}).then((response: MeetingsResponse) => {\n\t\t\tCulture.getInstance().setData(response.data.culture);\n\n\t\t\treturn response;\n\t\t});\n\n\t\tthis.menu = new PopupComponentsMaker({\n\t\t\tid: 'tasks-scrum-meetings-widget',\n\t\t\ttarget: targetNode,\n\t\t\tcacheable: false,\n\t\t\tcontent: [\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.renderMeetings(response),\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.renderChats(response),\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t]\n\t\t});\n\n\t\tthis.menu.show();\n\t}\n\n\trenderMeetings(response: Promise): Promise\n\t{\n\t\treturn response\n\t\t\t.then((response: MeetingsResponse) => {\n\t\t\t\tthis.meetingsNode = Tag.render`\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings tasks-scrum__widget-meetings--scope\">\n\t\t\t\t\t\t${this.renderMeetingsHeader(response)}\n\t\t\t\t\t\t${this.renderEventTemplates(response)}\n\t\t\t\t\t\t${this.renderScheduledMeetings(response)}\n\t\t\t\t\t</div>`\n\t\t\t\t;\n\n\t\t\t\treturn this.meetingsNode;\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trenderChats(response: Promise): HTMLElement\n\t{\n\t\treturn response\n\t\t\t.then((response: ChatsResponse) => {\n\t\t\t\tconst chats = response.data.chats;\n\t\t\t\tconst node = Tag.render`\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings tasks-scrum__widget-meetings--scope\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--header\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"ui-icon ui-icon-service-livechat tasks-scrum__widget-meetings--icon-chats\"\n\t\t\t\t\t\t\t><i></i></div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--header-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TSM_CHATS_HEADER_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.renderChatsList(chats)}\n\t\t\t\t\t\t${this.renderChatsEmpty(chats)}\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\t\treturn node;\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trenderChatsList(chats: Array<Chat>): HTMLElement\n\t{\n\t\tconst visibility = chats.length > 0 ? '--visible' : '';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--chat-content ${visibility}\">\n\t\t\t\t${\n\t\t\t\t\tchats.map((chat: Chat) => {\n\t\t\t\t\t\tconst chatIconClass = chat.icon === '' ? 'default' : '';\n\t\t\t\t\t\tconst chatIconStyle = chat.icon !== '' ? `background-image: url('${chat.icon}');` : '';\n\t\t\t\t\t\tconst chatNode = Tag.render`\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--chat-container\">\n\t\t\t\t\t\t\t\t<div class=\"ui-icon ui-icon-common-company tasks-scrum__widget-meetings--chat-icon\">\n\t\t\t\t\t\t\t\t\t<i\n\t\t\t\t\t\t\t\t\tclass=\"chat-icon ${chatIconClass}\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"${chatIconStyle}\"\n\t\t\t\t\t\t\t\t\t></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--chat-info\">\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--chat-name\">\n\t\t\t\t\t\t\t\t\t\t${chat.name}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"users-icon tasks-scrum__widget-meetings--chat-users\">\n\t\t\t\t\t\t\t\t\t\t${this.renderChatUser(chat.users)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`;\n\n\t\t\t\t\t\tEvent.bind(chatNode, 'click', this.openChat.bind(this, chat, chatNode));\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn chatNode;\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\topenChat(chat: Chat, chatNode: HTMLElement)\n\t{\n\t\tconst loader = new Loader({\n\t\t\ttarget: chatNode,\n\t\t\tsize: 34,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t});\n\n\t\tloader.show();\n\n\t\tthis.requestSender.getChat({\n\t\t\tgroupId: this.groupId,\n\t\t\tchatId: chat.id\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tif (top.window.BXIM)\n\t\t\t\t{\n\t\t\t\t\ttop.BXIM.openMessenger('chat' + parseInt(chat.id));\n\n\t\t\t\t\tthis.menu.close();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\trenderChatUser(users: Array<ChatUser>): HTMLElement\n\t{\n\t\tconst uiIconClasses = 'tasks-scrum__widget-meetings--chat-icon-user ui-icon ui-icon-common-user';\n\n\t\treturn Tag.render`\n\t\t\t${\n\t\t\t\tusers.map((user: ChatUser) => {\n\t\t\t\t\tconst src = user.photo ? encodeURI(Text.encode(user.photo.src)) : null;\n\t\t\t\t\tconst photoStyle = src ? `background-image: url('${src}');` : '';\n\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t<div class=\"user-icon ${uiIconClasses}\" title=\"${Text.encode(user.name)}\">\n\t\t\t\t\t\t\t<i style=\"${photoStyle}\"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\t\t\t\t})\n\t\t\t}\n\t\t`\n\t}\n\n\trenderChatsEmpty(chats: Array<Chat>): HTMLElement\n\t{\n\t\tconst visibility = chats.length > 0 ? '' : '--visible';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--content\">\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-chats ${visibility}\">\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-name\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_CHATS_EMPTY_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-text\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_CHATS_EMPTY_TEXT')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderMeetingsHeader(response: MeetingsResponse): HTMLElement\n\t{\n\t\tconst calendarSettings = response.data.calendarSettings;\n\n\t\tconst uiClasses = 'ui-btn-split ui-btn-light-border ui-btn-xs ui-btn-light ui-btn-no-caps ui-btn-round';\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--header\">\n\n\t\t\t\t<div class=\"ui-icon ui-icon-service-calendar tasks-scrum__widget-meetings--icon-calendar\">\n\t\t\t\t\t<i></i>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--header-title\">\n\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_HEADER_TITLE')}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--btn-create ${uiClasses}\">\n\t\t\t\t\t<button class=\"ui-btn-main\" data-role=\"create-default-event\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_CREATE_BUTTON')}\n\t\t\t\t\t</button>\n\t\t\t\t\t<div class=\"ui-btn-menu\" data-role=\"show-menu-event-templates\"></div>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t`;\n\n\t\tconst button = node.querySelector('button');\n\t\tconst menu = node.querySelector('.ui-btn-menu');\n\n\t\tEvent.bind(button, 'click', this.showEventSidePanel.bind(this));\n\t\tEvent.bind(menu, 'click', this.showMenuWithEventTemplates.bind(this, button, calendarSettings));\n\n\t\treturn node;\n\t}\n\n\trenderEventTemplates(response: MeetingsResponse): HTMLElement\n\t{\n\t\tconst mapCreatedEvents = response.data.mapCreatedEvents;\n\t\tconst listEvents = response.data.listEvents;\n\t\tconst isTemplatesClosed = response.data.isTemplatesClosed;\n\t\tconst calendarSettings = response.data.calendarSettings;\n\n\t\tconst templateVisibility = (\n\t\t\tisTemplatesClosed\n\t\t\t|| this.isAllEventsCreated(mapCreatedEvents)\n\t\t\t\t? ''\n\t\t\t\t: '--visible'\n\t\t);\n\t\tconst emptyVisibility = (isTemplatesClosed && listEvents.length === 0 ? '--visible' : '');\n\n\t\tconst contentVisibilityClass = emptyVisibility === '' && templateVisibility === '' ? '--content-hidden' : '';\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--content ${contentVisibilityClass}\">\n\t\t\t\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--creation-block ${templateVisibility}\">\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"tasks-scrum__widget-meetings--creation-close-btn\"\n\t\t\t\t\t\tdata-role=\"close-event-templates\"\n\t\t\t\t\t></span>\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--create-element-info\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATES_INFO')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${\n\t\t\t\t\t\t[...this.getEventTemplates(calendarSettings).values()]\n\t\t\t\t\t\t\t.map((eventTemplate: EventTemplate) => {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tType.isArray(mapCreatedEvents)\n\t\t\t\t\t\t\t\t\t|| Type.isUndefined(mapCreatedEvents[eventTemplate.id])\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn this.renderEventTemplate(eventTemplate);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-meetings ${emptyVisibility}\">\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-name\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_EMPTY_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--empty-text\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_EMPTY_TEXT')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class=\"tasks-scrum__widget-meetings--one-click-btn ui-qr-popupcomponentmaker__btn\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_CREATE_ONE_CLICK')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst closeButton = node.querySelector('.tasks-scrum__widget-meetings--creation-close-btn');\n\t\tconst oneClickButton = node.querySelector('.tasks-scrum__widget-meetings--one-click-btn');\n\n\t\tconst templatesNode = node.querySelector('.tasks-scrum__widget-meetings--creation-block');\n\t\tconst emptyNode = node.querySelector('.tasks-scrum__widget-meetings--empty-meetings');\n\n\t\tEvent.bind(closeButton, 'click', () => {\n\t\t\tDom.removeClass(templatesNode, '--visible');\n\t\t\tconst isExistsEvent = listEvents.length;\n\t\t\tif (!isExistsEvent)\n\t\t\t{\n\t\t\t\tDom.addClass(emptyNode, '--visible');\n\t\t\t}\n\t\t\tthis.requestSender.closeTemplates({\n\t\t\t\tgroupId: this.groupId\n\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t\tEvent.bind(oneClickButton, 'click', () => {\n\t\t\tDom.addClass(templatesNode, '--visible');\n\t\t\tDom.removeClass(emptyNode, '--visible');\n\t\t});\n\n\t\treturn node;\n\t}\n\n\trenderScheduledMeetings(response: MeetingsResponse): HTMLElement\n\t{\n\t\tconst todayEvent = response.data.todayEvent;\n\t\tconst listEvents = response.data.listEvents;\n\n\t\tconst todayEventVisibility = (Type.isNull(todayEvent)? '' : '--visible');\n\n\t\tthis.listEvents.setTodayEvent(todayEvent);\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable\">\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-container ${todayEventVisibility}\">\n\t\t\t\t\t<div class=\"tasks-scrum__widget-meetings--timetable-title\">\n\t\t\t\t\t\t${Loc.getMessage('TSM_TODAY_EVENT_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.todayEvent.render(todayEvent)}\n\t\t\t\t</div>\n\t\t\t\t${this.listEvents.render(listEvents, todayEvent)}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn node;\n\t}\n\n\trenderEventTemplate(eventTemplate: EventTemplate): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__widget-meetings--create-element ${Text.encode(eventTemplate.uiClass)}\">\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--create-element-title\">\n\t\t\t\t\t<span class=\"tasks-scrum__widget-meetings--create-element-name\">\n\t\t\t\t\t\t${Text.encode(eventTemplate.name)}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"ui-hint\">\n\t\t\t\t\t\t<i\n\t\t\t\t\t\t\tclass=\"ui-hint-icon\"\n\t\t\t\t\t\t\tdata-hint=\"${eventTemplate.hint}\"\n\t\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t\t\tdata-hint-html\n\t\t\t\t\t\t></i>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__widget-meetings--create-btn\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"ui-qr-popupcomponentmaker__btn\"\n\t\t\t\t\t\tdata-role=\"create-event-template-${eventTemplate.id}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('TSM_MEETINGS_CREATE_BUTTON')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst createButton = node.querySelector('.tasks-scrum__widget-meetings--create-btn');\n\n\t\tEvent.bind(createButton, 'click', this.openCalendarSidePanel.bind(this, eventTemplate));\n\n\t\tthis.initHints(node);\n\n\t\treturn node;\n\t}\n\n\tonShowView()\n\t{\n\t\tthis.menu.close();\n\t}\n\n\tshowEventSidePanel()\n\t{\n\t\tthis.openCalendarSidePanel();\n\t}\n\n\tshowMenuWithEventTemplates(targetNode: HTMLElement, calendarSettings: CalendarSettings)\n\t{\n\t\tif (this.eventTemplatesMenu)\n\t\t{\n\t\t\tif (this.eventTemplatesMenu.getPopupWindow().isShown())\n\t\t\t{\n\t\t\t\tthis.eventTemplatesMenu.close();\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.eventTemplatesMenu = new Menu({\n\t\t\tid: 'tsm-event-templates-menu',\n\t\t\tbindElement: targetNode,\n\t\t\tcloseByEsc : true\n\t\t});\n\n\t\tthis.eventTemplatesMenu.addMenuItem({\n\t\t\ttext: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_BLANK'),\n\t\t\tdelimiter: true\n\t\t});\n\n\t\tthis.getEventTemplates(calendarSettings)\n\t\t\t.forEach((eventTemplate: EventTemplate) => {\n\t\t\t\tthis.eventTemplatesMenu.addMenuItem({\n\t\t\t\t\ttext: eventTemplate.name,\n\t\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\t\tthis.openCalendarSidePanel(eventTemplate);\n\t\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t;\n\n\t\tthis.eventTemplatesMenu.getPopupWindow()\n\t\t\t.subscribe('onClose', () => {\n\t\t\t\tthis.eventTemplatesMenu.destroy();\n\t\t\t})\n\t\t;\n\n\t\tthis.eventTemplatesMenu.show();\n\t}\n\n\topenCalendarSidePanel(eventTemplate?: EventTemplate)\n\t{\n\t\tconst participantsEntityList = eventTemplate ? eventTemplate.roles: [];\n\n\t\tconst formData = eventTemplate\n\t\t\t? {\n\t\t\t\tname: eventTemplate.name,\n\t\t\t\tdescription: eventTemplate.desc,\n\t\t\t\tfrom: eventTemplate.from,\n\t\t\t\tto: eventTemplate.to,\n\t\t\t\tcolor: eventTemplate.color,\n\t\t\t\trrule: eventTemplate.rrule\n\t\t\t}\n\t\t\t: {\n\t\t\t\tname: '',\n\t\t\t\tdescription: '',\n\t\t\t\tcolor: '#86b100'\n\t\t\t}\n\t\t;\n\n\t\tconst sliderId = Text.getRandom();\n\n\t\tnew window.top.BX.Calendar.SliderLoader(\n\t\t\t0,\n\t\t\t{\n\t\t\t\tsliderId: sliderId,\n\t\t\t\tparticipantsSelectorEntityList: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project-roles',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tprojectId: this.groupId\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdynamicLoad: true\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tformDataValue: formData,\n\t\t\t\tparticipantsEntityList: participantsEntityList,\n\t\t\t\ttype: 'group',\n\t\t\t\townerId: this.groupId\n\t\t\t}\n\t\t).show();\n\n\t\ttop.BX.Event.EventEmitter.subscribe('SidePanel.Slider:onLoad', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tif (sliderId === sliderEvent.getSlider().getUrl().toString())\n\t\t\t{\n\t\t\t\ttop.BX.Event.EventEmitter.subscribeOnce(\n\t\t\t\t\t'BX.Calendar:onEntrySave',\n\t\t\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\t\t\tconst data = baseEvent.getData();\n\t\t\t\t\t\tif (sliderId === data.sliderId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (eventTemplate)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.requestSender.saveEventInfo({\n\t\t\t\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\t\t\t\ttemplateId: eventTemplate.id,\n\t\t\t\t\t\t\t\t\teventId: data.responseData.entryId\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\tthis.menu.close();\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.catch((response) => {\n\t\t\t\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t\t\t'bitrix:tasks.scrum.info.saveAnalyticsLabel',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\t\t\t\t\tscrum: 'Y',\n\t\t\t\t\t\t\t\t\t\taction: 'create_meet',\n\t\t\t\t\t\t\t\t\t\ttemplate: eventTemplate ? eventTemplate.id : 'custom'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetEventTemplates(calendarSettings: CalendarSettings): Set<EventTemplate>\n\t{\n\t\tconst eventTemplates = new Set();\n\n\t\tconst daysNumberMap = {\n\t\t\tMO: 1,\n\t\t\tTU: 2,\n\t\t\tWE: 3,\n\t\t\tTH: 4,\n\t\t\tFR: 5,\n\t\t\tSA: 6,\n\t\t\tSU: 7\n\t\t}\n\n\t\tconst weekStartDay = calendarSettings.weekStart[Object.keys(calendarSettings.weekStart)[0]];\n\t\tconst weekStartDayNumber = daysNumberMap[weekStartDay];\n\n\t\teventTemplates.add({\n\t\t\tid: 'daily',\n\t\t\tentityId: 'project-roles',\n\t\t\tname: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_NAME_DAILY'),\n\t\t\tdesc: '',\n\t\t\tfrom: new Date((new Date()).setHours(calendarSettings.workTimeStart, 0, 0)),\n\t\t\tto: new Date((new Date()).setHours(calendarSettings.workTimeStart, 15, 0)),\n\t\t\trrule: {\n\t\t\t\tFREQ: 'WEEKLY',\n\t\t\t\tINTERVAL: 1,\n\t\t\t\tBYDAY: calendarSettings.weekDays\n\t\t\t},\n\t\t\troles: [\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_M',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_E',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t}\n\t\t\t],\n\t\t\tuiClass: 'widget-meetings__sprint-daily',\n\t\t\tcolor: '#2FC6F6',\n\t\t\thint: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_HINT_DAILY')\n\t\t});\n\n\t\teventTemplates.add({\n\t\t\tid: 'planning',\n\t\t\tentityId: 'project-roles',\n\t\t\tname: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_NAME_PLANNING'),\n\t\t\tdesc: '',\n\t\t\tfrom: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart, 0, 0)\n\t\t\t),\n\t\t\tto: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart + 1, 0, 0)\n\t\t\t),\n\t\t\trrule: {\n\t\t\t\tFREQ: 'WEEKLY',\n\t\t\t\tINTERVAL: calendarSettings.interval,\n\t\t\t\tBYDAY: calendarSettings.weekStart\n\t\t\t},\n\t\t\troles: [\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_A',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_M',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_E',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t}\n\t\t\t],\n\t\t\tuiClass: 'widget-meetings__sprint-planning',\n\t\t\tcolor: '#DA51D4',\n\t\t\thint: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_HINT_PLANNING')\n\t\t});\n\n\t\teventTemplates.add({\n\t\t\tid: 'review',\n\t\t\tentityId: 'project-roles',\n\t\t\tname: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_NAME_REVIEW'),\n\t\t\tdesc: '',\n\t\t\tfrom: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart, 0, 0)\n\t\t\t),\n\t\t\tto: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart + 1, 0, 0)\n\t\t\t),\n\t\t\trrule: {\n\t\t\t\tFREQ: 'WEEKLY',\n\t\t\t\tINTERVAL: calendarSettings.interval,\n\t\t\t\tBYDAY: calendarSettings.weekStart\n\t\t\t},\n\t\t\troles: [\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_A',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_M',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_E',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t}\n\t\t\t],\n\t\t\tuiClass: 'widget-meetings__sprint-review',\n\t\t\tcolor: '#FF5752',\n\t\t\thint: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_HINT_REVIEW')\n\t\t});\n\n\t\teventTemplates.add({\n\t\t\tid: 'retrospective',\n\t\t\tentityId: 'project-roles',\n\t\t\tname: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_NAME_RETROSPECTIVE'),\n\t\t\tdesc: '',\n\t\t\tfrom: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart, 0, 0)\n\t\t\t),\n\t\t\tto: new Date(\n\t\t\t\tthis.getNextWeekStartDate(weekStartDayNumber)\n\t\t\t\t\t.setHours(calendarSettings.workTimeStart + 1, 0, 0)\n\t\t\t),\n\t\t\trrule: {\n\t\t\t\tFREQ: 'WEEKLY',\n\t\t\t\tINTERVAL: calendarSettings.interval,\n\t\t\t\tBYDAY: calendarSettings.weekStart\n\t\t\t},\n\t\t\troles: [\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_M',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: this.groupId + '_E',\n\t\t\t\t\tentityId: 'project-roles'\n\t\t\t\t}\n\t\t\t],\n\t\t\tuiClass: 'widget-meetings__sprint-retrospective',\n\t\t\tcolor: '#FF5752',\n\t\t\thint: Loc.getMessage('TSM_MEETINGS_EVENT_TEMPLATE_HINT_RETROSPECTIVE')\n\t\t});\n\n\t\treturn eventTemplates;\n\t}\n\n\tisAllEventsCreated(mapCreatedEvents: ?MapCreatedEvents): boolean\n\t{\n\t\tif (Type.isArray(mapCreatedEvents))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn (\n\t\t\tType.isInteger(mapCreatedEvents.daily)\n\t\t\t&& Type.isInteger(mapCreatedEvents.planning)\n\t\t\t&& Type.isInteger(mapCreatedEvents.review)\n\t\t\t&& Type.isInteger(mapCreatedEvents.retrospective)\n\t\t);\n\t}\n\n\tgetNextWeekStartDate(weekStartDayNumber: number): Date\n\t{\n\t\tconst date = new Date();\n\t\tconst targetDate = new Date();\n\n\t\tconst delta = weekStartDayNumber - date.getDay();\n\n\t\tif (delta >= 0)\n\t\t{\n\t\t\ttargetDate.setDate(date.getDate() + delta)\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttargetDate.setDate(date.getDate() + 7 + delta)\n\t\t}\n\n\t\treturn targetDate;\n\t}\n\n\tinitHints(node: HTMLElement)\n\t{\n\t\tBX.UI.Hint.init(node);\n\t}\n}\n"],"names":["Culture","data","dayMonthFormat","longDateFormat","shortTimeFormat","CreatedEvent","setEventNamespace","node","event","color","colorBorder","convertHexToRGBA","colorBackground","Tag","render","getFormattedTime","from","to","renderVideoCallButton","Text","encode","name","repeatable","renderRepetition","Event","bind","openViewCalendarSidePanel","window","top","BX","Calendar","SliderLoader","id","entryDateFrom","Date","show","emit","videoCallUiClasses","Loc","getMessage","hexCode","opacity","hex","replace","length","r","parseInt","substring","g","b","date","format","getInstance","getShortTimeFormat","EventEmitter","ListEvents","listIsShown","todayEvent","listNode","buttonNode","listEvents","visibility","existsTodayEvent","renderList","renderButton","list","Map","groupedList","sort","forEach","key","getFormattedDate","group","has","get","Set","add","set","sortedMap","entries","first","second","keys","renderSeparator","renderEvents","onTransitionEnd","size","values","map","index","createdEvent","subscribe","getButtonText","showList","hideList","querySelector","textContent","style","height","scrollHeight","Dom","addClass","clientHeight","removeClass","ts","getDayMonthFormat","RequestSender","controller","action","Promise","resolve","reject","ajax","runAction","then","sendRequest","response","alertTitle","Type","isUndefined","errors","console","error","firstError","shift","errorCode","code","message","title","MessageBox","alert","Meetings","params","groupId","requestSender","onShowView","menu","eventTemplatesMenu","targetNode","isShown","close","getMeetings","setData","culture","PopupComponentsMaker","target","cacheable","content","html","renderMeetings","renderChats","meetingsNode","renderMeetingsHeader","renderEventTemplates","renderScheduledMeetings","showErrorAlert","chats","renderChatsList","renderChatsEmpty","chat","chatIconClass","icon","chatIconStyle","chatNode","renderChatUser","users","openChat","loader","Loader","mode","getChat","chatId","BXIM","openMessenger","uiIconClasses","user","src","photo","encodeURI","photoStyle","calendarSettings","uiClasses","button","showEventSidePanel","showMenuWithEventTemplates","mapCreatedEvents","isTemplatesClosed","templateVisibility","isAllEventsCreated","emptyVisibility","contentVisibilityClass","getEventTemplates","eventTemplate","isArray","renderEventTemplate","closeButton","oneClickButton","templatesNode","emptyNode","isExistsEvent","closeTemplates","todayEventVisibility","isNull","setTodayEvent","uiClass","hint","createButton","openCalendarSidePanel","initHints","getPopupWindow","Menu","bindElement","closeByEsc","addMenuItem","text","delimiter","onclick","menuItem","getMenuWindow","destroy","participantsEntityList","roles","formData","description","desc","rrule","sliderId","getRandom","participantsSelectorEntityList","options","projectId","dynamicLoad","formDataValue","type","ownerId","getCompatData","sliderEvent","getSlider","getUrl","toString","subscribeOnce","baseEvent","getData","saveEventInfo","templateId","eventId","responseData","entryId","analyticsLabel","scrum","template","eventTemplates","daysNumberMap","MO","TU","WE","TH","FR","SA","SU","weekStartDay","weekStart","Object","weekStartDayNumber","entityId","setHours","workTimeStart","FREQ","INTERVAL","BYDAY","weekDays","getNextWeekStartDate","interval","isInteger","daily","planning","review","retrospective","targetDate","delta","getDay","setDate","getDate","UI","Hint","init"],"mappings":"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"}