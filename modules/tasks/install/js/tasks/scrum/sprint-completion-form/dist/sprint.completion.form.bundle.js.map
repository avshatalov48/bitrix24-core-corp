{"version":3,"file":"sprint.completion.form.bundle.js","sources":["../src/request.sender.js","../src/culture.js","../src/sprint.completion.form.js"],"sourcesContent":["import {Loc, Type, ajax} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}, analyticsLabel = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data,\n\t\t\t\t\tanalyticsLabel: analyticsLabel\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tgetDataForSprintCompletionForm(data): Promise\n\t{\n\t\treturn this.sendRequest('sprint', 'getDataForSprintCompletionForm', data);\n\t}\n\n\tcompleteSprint(data): Promise\n\t{\n\t\treturn this.sendRequest(\n\t\t\t'sprint',\n\t\t\t'completeSprint',\n\t\t\tdata,\n\t\t\t{\n\t\t\t\tscrum: 'Y',\n\t\t\t\taction: 'finish_sprint',\n\t\t\t}\n\t\t);\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.error(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","export type CultureData = {\n\tdayMonthFormat: string,\n\tlongDateFormat: string,\n\tshortTimeFormat: string\n}\n\nexport class Culture\n{\n\tstatic #instance;\n\n\tstatic getInstance()\n\t{\n\t\tif (!Culture.#instance)\n\t\t{\n\t\t\tCulture.#instance = new Culture();\n\t\t}\n\n\t\treturn Culture.#instance;\n\t}\n\n\tsetData(data: CultureData)\n\t{\n\t\tthis.data = data;\n\t}\n\n\tgetDayMonthFormat(): string\n\t{\n\t\treturn this.data.dayMonthFormat;\n\t}\n\n\tgetLongDateFormat(): string\n\t{\n\t\treturn this.data.longDateFormat;\n\t}\n\n\tgetShortTimeFormat(): string\n\t{\n\t\treturn this.data.shortTimeFormat;\n\t}\n}","import {Event, Loc, Tag, Text, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Layout} from 'ui.sidepanel.layout';\nimport {Confetti} from 'ui.confetti';\n\nimport {RequestSender} from './request.sender';\nimport {Culture, CultureData} from './culture';\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport 'ui.hint';\n\nimport '../css/base.css';\nimport '../css/item.css';\n\ntype Params = {\n\tgroupId: number\n}\n\ntype SprintData = {\n\tid: number,\n\tname: string,\n\tinfo: {\n\t\tsprintGoal: string\n\t},\n\tepics: Array<EpicType>,\n\tdateStart: string,\n\tdateEnd: string,\n\texistsLastSprint: boolean,\n\tstoryPoints: number,\n\tcompletedStoryPoints: number,\n\tlastStoryPoints: number,\n\tlastCompletedStoryPoints: number,\n\tplannedSprints: Array<PlannedSprint>,\n\tuncompletedTasks: Array<Item>,\n\tculture: CultureData\n}\n\ntype PlannedSprint = {\n\tid: number,\n\tname: string\n}\n\ntype Item = {\n\tid: number,\n\tname: string,\n\tresponsible: {\n\t\tid: number,\n\t\tname: string,\n\t\tpathToUser: string,\n\t\tphoto?: {\n\t\t\tsrc: string\n\t\t}\n\t},\n\tepic: ?EpicType,\n\ttags: Array<string>,\n\tsourceId: number,\n\tstoryPoints: string\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tcolor: string\n}\n\ntype Response = {\n\tstatus: string,\n\tdata: SprintData,\n\terrors: Array\n}\n\nexport class SprintCompletionForm extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintCompletionForm');\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-completion-form-side-panel';\n\n\t\tthis.requestSender = new RequestSender();\n\n\t\tthis.node = null;\n\n\t\tthis.completeButton = null;\n\t}\n\n\tshow()\n\t{\n\t\tthis.sidePanelManager.open(\n\t\t\tthis.sidePanelId,\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 700,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.sprint-completion-form'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_TITLE'),\n\t\t\t\t\t\tcontent: this.createContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tthis.completeButton = new SaveButton({\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_BUTTON'),\n\t\t\t\t\t\t\t\t\tonclick: this.onComplete.bind(this)\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tonComplete()\n\t{\n\t\tlet direction = 'backlog';\n\n\t\tlet directionSelector = this.node.querySelector('.tasks-scrum__side-panel-completion--info-select');\n\t\tif (directionSelector)\n\t\t{\n\t\t\tdirectionSelector = directionSelector.querySelector('select');\n\t\t\tdirection = directionSelector.value;\n\t\t}\n\n\t\tthis.completeButton.setWaiting();\n\n\t\tthis.requestSender.completeSprint({\n\t\t\tgroupId: this.groupId,\n\t\t\tdirection: direction\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tif (Confetti)\n\t\t\t\t{\n\t\t\t\t\tConfetti.fire({\n\t\t\t\t\t\tparticleCount: 400,\n\t\t\t\t\t\tspread: 80,\n\t\t\t\t\t\torigin: {\n\t\t\t\t\t\t\tx: 0.7,\n\t\t\t\t\t\t\ty: 0.2\n\t\t\t\t\t\t},\n\t\t\t\t\t\tzIndex: (this.sidePanelManager.getTopSlider().getZindex() + 1)\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tthis.closeSidePanel();\n\t\t\t\t\t\tthis.emit('afterComplete');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.closeSidePanel();\n\t\t\t\t\tthis.emit('afterComplete');\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.completeButton.setWaiting(false);\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\t}\n\n\tcloseSidePanel()\n\t{\n\t\tconst openSliders = this.sidePanelManager.getOpenSliders();\n\t\tif (openSliders.length > 0)\n\t\t{\n\t\t\topenSliders.forEach((slider) => {\n\t\t\t\tif (slider.getUrl() === this.sidePanelId)\n\t\t\t\t{\n\t\t\t\t\tslider.close(false);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateContent()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getDataForSprintCompletionForm({\n\t\t\t\tgroupId: this.groupId\n\t\t\t})\n\t\t\t\t.then((response: Response) => {\n\t\t\t\t\tCulture.getInstance().setData(response.data.culture);\n\t\t\t\t\tresolve(this.render(response.data));\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\treject();\n\t\t\t\t\tthis.sidePanelManager.close(false, () => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\trender(sprintData: SprintData): HTMLElement\n\t{\n\t\tconst storyPoints = (sprintData.storyPoints === '' ? 0 : sprintData.storyPoints);\n\n\t\tconst periodDays = this.getPeriodDays(sprintData.dateStart);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div id=\"${Text.getRandom()}\" class=\"tasks-scrum__scope--side-panel-completion\">\n\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--block\">\n\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic\">\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-block\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-title\">\n\t\t\t\t\t\t\t${Text.encode(sprintData.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderGoal(sprintData.info.sprintGoal)}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-additional\">\n\n\t\t\t\t\t${this.renderEpics(sprintData.epics)}\n\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-row\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_TIME_ROW_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-content tasks-scrum__side-panel-completion--sprint-timing\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--date-name-block\">\n\t\t\t\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_DATE_START_LABEL')}</div>\n\t\t\t\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_DATE_END_LABEL')}</div>\n\t\t\t\t\t\t\t\t${this.renderLabelPeriodDays(periodDays)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--date-result-block\">\n\t\t\t\t\t\t\t\t<div>${this.getFormattedDateStart(sprintData.dateStart)}</div>\n\t\t\t\t\t\t\t\t<div>${this.getFormattedDateStart(sprintData.dateEnd)}</div>\n\t\t\t\t\t\t\t\t${this.renderPeriodDays(periodDays)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-row\">\n\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_PLAN_ROW_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-content\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block\">\n\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--sprint-plans\">\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-number --percent\">\n\t\t\t\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\t\t\t\tclass=\"tasks-scrum__side-panel-completion--plan-block-number-date\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"${Text.encode(storyPoints)}\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t${Text.encode(storyPoints)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name-text\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_PLAN_SP')}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-hint-icon\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('TSS_START_STORY_POINTS_HINT')}\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--sprint-plans\">\n\t\t\t\t\t\t\t\t\t${this.renderWheelCompletedStoryPoints(sprintData)}\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name-text\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_DONE_SP')}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-hint-icon\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('TSS_START_STORY_POINTS_HINT')}\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t${this.renderUncompletedTasks(sprintData)}\n\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.initHints(this.node);\n\n\t\treturn this.node;\n\t}\n\n\trenderLabelPeriodDays(periodDays: ?string): ?HTMLElement\n\t{\n\t\tif (Type.isNull(periodDays))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`<div>${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_PERIOD_LABEL')}</div>`;\n\t}\n\n\trenderPeriodDays(periodDays: ?string): ?HTMLElement\n\t{\n\t\tif (Type.isNull(periodDays))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`<div>${Text.encode(periodDays)}</div>`;\n\t}\n\n\trenderGoal(goal: string): ?HTMLElement\n\t{\n\t\tif (goal === '')\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-block\">\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-description\">\n\t\t\t\t\t${Text.encode(goal)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEpics(epics: Array<EpicType>): ?HTMLElement\n\t{\n\t\tif (!epics.length)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-row\">\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_EPICS_ROW_LABEL')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-content\">\n\t\t\t\t\t${\n\t\t\t\t\t\tepics.map((epic: EpicType) => {\n\t\t\t\t\t\t\tconst colorBorder = this.convertHexToRGBA(epic.color, 0.7);\n\t\t\t\t\t\t\tconst colorBackground = this.convertHexToRGBA(epic.color, 0.3);\n\n\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclass=\"tasks-scrum__epic-label\"\n\t\t\t\t\t\t\t\t\tstyle=\"background: ${colorBackground}; border-color: ${colorBorder};\"\n\t\t\t\t\t\t\t\t>${Text.encode(epic.name)}</span>`\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderWheelCompletedStoryPoints(sprintData: SprintData): HTMLElement\n\t{\n\t\tlet differencePercentage = 0;\n\n\t\tconst currentPercentage = this.calculatePercentage(\n\t\t\tsprintData.storyPoints,\n\t\t\tsprintData.completedStoryPoints\n\t\t);\n\n\t\tif (sprintData.existsLastSprint)\n\t\t{\n\t\t\tconst lastPercentage = this.calculatePercentage(\n\t\t\t\tsprintData.lastStoryPoints,\n\t\t\t\tsprintData.lastCompletedStoryPoints\n\t\t\t);\n\n\t\t\tdifferencePercentage = parseFloat(currentPercentage) - parseFloat(lastPercentage);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdifferencePercentage = currentPercentage;\n\t\t}\n\n\t\tlet wheelClass = '';\n\n\t\tif (differencePercentage > 0)\n\t\t{\n\t\t\twheelClass = `tasks-scrum__side-panel-completion--plan-block-number --arrow-up --percent --success`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twheelClass = `tasks-scrum__side-panel-completion--plan-block-number --arrow-down --percent --warning`;\n\t\t}\n\n\t\tconst absoluteValue = Math.abs(differencePercentage);\n\n\t\tconst renderProgress = (percent: number) => {\n\t\t\tif (percent === 0)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--progress\">\n\t\t\t\t\t<span class=\"tasks-scrum__side-panel-completion--progress-number\">${percent}</span>\n\t\t\t\t\t<span class=\"tasks-scrum__side-panel-completion--progress-percent\">%</span></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${wheelClass}\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"tasks-scrum__side-panel-completion--plan-block-number-date\"\n\t\t\t\t\ttitle=\"${Text.encode(sprintData.completedStoryPoints)}\"\n\t\t\t\t>\n\t\t\t\t\t${Text.encode(sprintData.completedStoryPoints)}\n\t\t\t\t</div>\n\t\t\t\t${renderProgress(absoluteValue)}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderUncompletedTasks(sprintData: SprintData): HTMLElement\n\t{\n\t\tif (sprintData.uncompletedTasks.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--block\">\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic\">\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-block\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-title-icon\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_ACTION_ROW_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-description\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_ACTION_MOVE_LABEL')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderMoveSelect(sprintData.plannedSprints)}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-items\">\n\t\t\t\t\t${sprintData.uncompletedTasks.map((item: Item) => this.renderItem(item))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderMoveSelect(plannedSprints: Array<PlannedSprint>): HTMLElement\n\t{\n\t\tconst uiClasses = 'ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100';\n\n\t\tlet sprintsOptions = '';\n\n\t\tplannedSprints.forEach((sprint: PlannedSprint) => {\n\t\t\tsprintsOptions += `<option value=\"${sprint.id}\">${Text.encode(sprint.name)}</option>`;\n\t\t})\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-select ${uiClasses}\">\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t<select class=\"ui-ctl-element\">\n\t\t\t\t\t<option value=\"backlog\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_SELECTOR_BACKLOG')}\n\t\t\t\t\t</option>\n\t\t\t\t\t<option value=\"0\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_SELECTOR_SPRINT')}\n\t\t\t\t\t</option>\n\t\t\t\t\t${sprintsOptions}\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderItem(item: Item): HTMLElement\n\t{\n\t\tconst src = item.responsible.photo ? Text.encode(item.responsible.photo.src) : null;\n\t\tconst photoStyle = src ? `background-image: url('${encodeURI(src)}');` : '';\n\n\t\tconst storyPointsClass = (item.storyPoints === '' ? '--empty' : '');\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__item-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--info\">\n\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--main-info\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--title\">\n\t\t\t\t\t\t\t${Text.encode(item.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--tags\">\n\t\t\t\t\t\t\t${this.renderEpic(item.epic)}\n\t\t\t\t\t\t\t${this.renderTags(item.tags)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--responsible\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"tasks-scrum__item-side-panel--responsible-photo ui-icon ui-icon-common-user\"\n\t\t\t\t\t\ttitle=\"${Text.encode(item.responsible.name)}\"\n\t\t\t\t\t><i style=\"${photoStyle}\"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span>${Text.encode(item.responsible.name)}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--story-points ${storyPointsClass}\">\n\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--story-points-content\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--story-points-element\">\n\t\t\t\t\t\t\t${item.storyPoints === '' ? '-' : Text.encode(item.storyPoints)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', () => this.emit('taskClick', item.sourceId))\n\n\t\treturn node;\n\t}\n\n\trenderEpic(epic: ?EpicType): ?HTMLElement\n\t{\n\t\tif (Type.isArray(epic) || Type.isUndefined(epic))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__item-side-panel--epic --visible\">\n\t\t\t\t<i\n\t\t\t\t\tclass=\"tasks-scrum__item-side-panel--epic-point\"\n\t\t\t\t\tstyle=\"${`background-color: ${epic.color}`}\"\n\t\t\t\t></i>\n\t\t\t\t<span>${Text.encode(epic.name)}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderTags(tags: Array<string>): ?HTMLElement\n\t{\n\t\tif (tags.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t${tags.map((tag) => Tag.render`\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--hashtag --visible\">#${Text.encode(tag)}</div>\n\t\t\t`)}\n\t\t`;\n\t}\n\n\tgetFormattedDateStart(dateStart: number): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format(Culture.getInstance().getLongDateFormat(), dateStart);\n\t\t/* eslint-enable */\n\t}\n\n\tgetFormattedDateEnd(dateEnd: number): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format(Culture.getInstance().getLongDateFormat(), dateEnd);\n\t\t/* eslint-enable */\n\t}\n\n\tgetPeriodDays(dateStartTime: number): ?string\n\t{\n\t\tconst dateWithWeekendOffset = new Date();\n\n\t\tdateWithWeekendOffset.setSeconds(dateWithWeekendOffset.getSeconds());\n\t\tdateWithWeekendOffset.setHours(0, 0, 0, 0);\n\n\t\tconst dateStart = new Date(dateStartTime * 1000);\n\n\t\tconst date = new Date();\n\t\tif (dateStart >= date)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn BX.date.format('ddiff', dateStart, dateWithWeekendOffset);\n\t};\n\n\tcalculatePercentage(first: number, second: number): number\n\t{\n\t\tif (first === 0)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst result = Math.round(second * 100 / first);\n\n\t\treturn (isNaN(result) ? 0 : result);\n\t}\n\n\tconvertHexToRGBA(hexCode, opacity)\n\t{\n\t\tlet hex = hexCode.replace('#', '');\n\n\t\tif (hex.length === 3)\n\t\t{\n\t\t\thex = `${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;\n\t\t}\n\n\t\tconst r = parseInt(hex.substring(0, 2), 16);\n\t\tconst g = parseInt(hex.substring(2, 4), 16);\n\t\tconst b = parseInt(hex.substring(4, 6), 16);\n\n\t\treturn `rgba(${r},${g},${b},${opacity})`;\n\t}\n\n\tinitHints(node: HTMLElement)\n\t{\n\t\t// todo wtf hint\n\t\tBX.UI.Hint.popup = null;\n\t\tBX.UI.Hint.id = 'ui-hint-popup-' + (+new Date());\n\t\tBX.UI.Hint.init(node);\n\t}\n}"],"names":["RequestSender","controller","action","data","analyticsLabel","Promise","resolve","reject","ajax","runAction","then","sendRequest","scrum","response","alertTitle","Type","isUndefined","errors","console","error","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","Culture","dayMonthFormat","longDateFormat","shortTimeFormat","SprintCompletionForm","params","setEventNamespace","groupId","parseInt","sidePanelManager","BX","SidePanel","Instance","sidePanelId","requestSender","node","completeButton","open","cacheable","width","contentCallback","Layout","createContent","extensions","content","bind","design","section","buttons","cancelButton","SaveButton","text","onclick","onComplete","direction","directionSelector","querySelector","value","setWaiting","completeSprint","Confetti","fire","particleCount","spread","origin","x","y","zIndex","getTopSlider","getZindex","closeSidePanel","emit","showErrorAlert","openSliders","getOpenSliders","forEach","slider","getUrl","close","getDataForSprintCompletionForm","getInstance","setData","culture","render","sprintData","storyPoints","periodDays","getPeriodDays","dateStart","Tag","Text","getRandom","encode","name","renderGoal","info","sprintGoal","renderEpics","epics","renderLabelPeriodDays","getFormattedDateStart","dateEnd","renderPeriodDays","renderWheelCompletedStoryPoints","renderUncompletedTasks","initHints","isNull","goal","map","epic","colorBorder","convertHexToRGBA","color","colorBackground","differencePercentage","currentPercentage","calculatePercentage","completedStoryPoints","existsLastSprint","lastPercentage","lastStoryPoints","lastCompletedStoryPoints","parseFloat","wheelClass","absoluteValue","Math","abs","renderProgress","percent","uncompletedTasks","renderMoveSelect","plannedSprints","item","renderItem","uiClasses","sprintsOptions","sprint","id","src","responsible","photo","photoStyle","encodeURI","storyPointsClass","renderEpic","renderTags","tags","Event","sourceId","isArray","tag","date","format","getLongDateFormat","dateStartTime","dateWithWeekendOffset","Date","setSeconds","getSeconds","setHours","first","second","result","round","isNaN","hexCode","opacity","hex","replace","r","substring","g","b","UI","Hint","popup","init","EventEmitter"],"mappings":"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"}