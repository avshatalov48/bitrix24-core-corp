{"version":3,"file":"sprint.completion.form.bundle.js","sources":["../src/request.sender.js","../src/culture.js","../src/sprint.completion.form.js"],"sourcesContent":["import {Loc, Type, ajax} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}, analyticsLabel = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data,\n\t\t\t\t\tanalyticsLabel: analyticsLabel\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tgetDataForSprintCompletionForm(data): Promise\n\t{\n\t\treturn this.sendRequest('sprint', 'getDataForSprintCompletionForm', data);\n\t}\n\n\tcompleteSprint(data): Promise\n\t{\n\t\treturn this.sendRequest(\n\t\t\t'sprint',\n\t\t\t'completeSprint',\n\t\t\tdata,\n\t\t\t{\n\t\t\t\tscrum: 'Y',\n\t\t\t\taction: 'finish_sprint',\n\t\t\t}\n\t\t);\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.error(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","export type CultureData = {\n\tdayMonthFormat: string,\n\tlongDateFormat: string,\n\tshortTimeFormat: string\n}\n\nexport class Culture\n{\n\tstatic #instance;\n\n\tstatic getInstance()\n\t{\n\t\tif (!Culture.#instance)\n\t\t{\n\t\t\tCulture.#instance = new Culture();\n\t\t}\n\n\t\treturn Culture.#instance;\n\t}\n\n\tsetData(data: CultureData)\n\t{\n\t\tthis.data = data;\n\t}\n\n\tgetDayMonthFormat(): string\n\t{\n\t\treturn this.data.dayMonthFormat;\n\t}\n\n\tgetLongDateFormat(): string\n\t{\n\t\treturn this.data.longDateFormat;\n\t}\n\n\tgetShortTimeFormat(): string\n\t{\n\t\treturn this.data.shortTimeFormat;\n\t}\n}","import {Event, Loc, Tag, Text, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Layout} from 'ui.sidepanel.layout';\nimport {Confetti} from 'ui.confetti';\n\nimport {RequestSender} from './request.sender';\nimport {Culture, CultureData} from './culture';\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport 'ui.hint';\n\nimport '../css/base.css';\nimport '../css/item.css';\n\ntype Params = {\n\tgroupId: number\n}\n\ntype SprintData = {\n\tid: number,\n\tname: string,\n\tinfo: {\n\t\tsprintGoal: string\n\t},\n\tepics: Array<EpicType>,\n\tdateStart: string,\n\tdateEnd: string,\n\texistsLastSprint: boolean,\n\tstoryPoints: number,\n\tcompletedStoryPoints: number,\n\tlastStoryPoints: number,\n\tlastCompletedStoryPoints: number,\n\tplannedSprints: Array<PlannedSprint>,\n\tuncompletedTasks: Array<Item>,\n\tculture: CultureData\n}\n\ntype PlannedSprint = {\n\tid: number,\n\tname: string\n}\n\ntype Item = {\n\tid: number,\n\tname: string,\n\tresponsible: {\n\t\tid: number,\n\t\tname: string,\n\t\tpathToUser: string,\n\t\tphoto?: {\n\t\t\tsrc: string\n\t\t}\n\t},\n\tepic: ?EpicType,\n\ttags: Array<string>,\n\tsourceId: number,\n\tstoryPoints: string\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tcolor: string\n}\n\ntype Response = {\n\tstatus: string,\n\tdata: SprintData,\n\terrors: Array\n}\n\nexport class SprintCompletionForm extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintCompletionForm');\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-completion-form-side-panel';\n\n\t\tthis.requestSender = new RequestSender();\n\n\t\tthis.node = null;\n\n\t\tthis.completeButton = null;\n\t}\n\n\tshow()\n\t{\n\t\tthis.sidePanelManager.open(\n\t\t\tthis.sidePanelId,\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 700,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['tasks.scrum.sprint-completion-form'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_TITLE'),\n\t\t\t\t\t\tcontent: this.createContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tthis.completeButton = new SaveButton({\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_BUTTON'),\n\t\t\t\t\t\t\t\t\tonclick: this.onComplete.bind(this)\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tonComplete()\n\t{\n\t\tlet direction = 'backlog';\n\n\t\tlet directionSelector = this.node.querySelector('.tasks-scrum__side-panel-completion--info-select');\n\t\tif (directionSelector)\n\t\t{\n\t\t\tdirectionSelector = directionSelector.querySelector('select');\n\t\t\tdirection = directionSelector.value;\n\t\t}\n\n\t\tthis.completeButton.setWaiting();\n\n\t\tthis.requestSender.completeSprint({\n\t\t\tgroupId: this.groupId,\n\t\t\tdirection: direction\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tif (Confetti)\n\t\t\t\t{\n\t\t\t\t\tConfetti.fire({\n\t\t\t\t\t\tparticleCount: 400,\n\t\t\t\t\t\tspread: 80,\n\t\t\t\t\t\torigin: {\n\t\t\t\t\t\t\tx: 0.7,\n\t\t\t\t\t\t\ty: 0.2\n\t\t\t\t\t\t},\n\t\t\t\t\t\tzIndex: (this.sidePanelManager.getTopSlider().getZindex() + 1)\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tthis.closeSidePanel();\n\t\t\t\t\t\tthis.emit('afterComplete');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.closeSidePanel();\n\t\t\t\t\tthis.emit('afterComplete');\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.completeButton.setWaiting(false);\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\t}\n\n\tcloseSidePanel()\n\t{\n\t\tconst openSliders = this.sidePanelManager.getOpenSliders();\n\t\tif (openSliders.length > 0)\n\t\t{\n\t\t\topenSliders.forEach((slider) => {\n\t\t\t\tif (slider.getUrl() === this.sidePanelId)\n\t\t\t\t{\n\t\t\t\t\tslider.close(false);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateContent()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getDataForSprintCompletionForm({\n\t\t\t\tgroupId: this.groupId\n\t\t\t})\n\t\t\t\t.then((response: Response) => {\n\t\t\t\t\tCulture.getInstance().setData(response.data.culture);\n\t\t\t\t\tresolve(this.render(response.data));\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\treject();\n\t\t\t\t\tthis.sidePanelManager.close(false, () => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\trender(sprintData: SprintData): HTMLElement\n\t{\n\t\tconst storyPoints = (sprintData.storyPoints === '' ? 0 : sprintData.storyPoints);\n\n\t\tconst periodDays = this.getPeriodDays(sprintData.dateStart);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div id=\"${Text.getRandom()}\" class=\"tasks-scrum__scope--side-panel-completion\">\n\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--block\">\n\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic\">\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-block\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-title\">\n\t\t\t\t\t\t\t${Text.encode(sprintData.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderGoal(sprintData.info.sprintGoal)}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-additional\">\n\n\t\t\t\t\t${this.renderEpics(sprintData.epics)}\n\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-row\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_TIME_ROW_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-content tasks-scrum__side-panel-completion--sprint-timing\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--date-name-block\">\n\t\t\t\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_DATE_START_LABEL')}</div>\n\t\t\t\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_DATE_END_LABEL')}</div>\n\t\t\t\t\t\t\t\t${this.renderLabelPeriodDays(periodDays)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--date-result-block\">\n\t\t\t\t\t\t\t\t<div>${this.getFormattedDateStart(sprintData.dateStart)}</div>\n\t\t\t\t\t\t\t\t<div>${this.getFormattedDateStart(sprintData.dateEnd)}</div>\n\t\t\t\t\t\t\t\t${this.renderPeriodDays(periodDays)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-row\">\n\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_PLAN_ROW_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-content\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block\">\n\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--sprint-plans\">\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-number --percent\">\n\t\t\t\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\t\t\t\tclass=\"tasks-scrum__side-panel-completion--plan-block-number-date\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"${Text.encode(storyPoints)}\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t${Text.encode(storyPoints)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name-text\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_PLAN_SP')}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-hint-icon\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('TSS_START_STORY_POINTS_HINT')}\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--sprint-plans\">\n\t\t\t\t\t\t\t\t\t${this.renderWheelCompletedStoryPoints(sprintData)}\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name-text\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_DONE_SP')}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-hint-icon\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('TSS_START_STORY_POINTS_HINT')}\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t${this.renderUncompletedTasks(sprintData)}\n\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.initHints(this.node);\n\n\t\treturn this.node;\n\t}\n\n\trenderLabelPeriodDays(periodDays: ?string): ?HTMLElement\n\t{\n\t\tif (Type.isNull(periodDays))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`<div>${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_PERIOD_LABEL')}</div>`;\n\t}\n\n\trenderPeriodDays(periodDays: ?string): ?HTMLElement\n\t{\n\t\tif (Type.isNull(periodDays))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`<div>${Text.encode(periodDays)}</div>`;\n\t}\n\n\trenderGoal(goal: string): ?HTMLElement\n\t{\n\t\tif (goal === '')\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-block\">\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-description\">\n\t\t\t\t\t${Text.encode(goal)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEpics(epics: Array<EpicType>): ?HTMLElement\n\t{\n\t\tif (!epics.length)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-row\">\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_EPICS_ROW_LABEL')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-content\">\n\t\t\t\t\t${\n\t\t\t\t\t\tepics.map((epic: EpicType) => {\n\t\t\t\t\t\t\tconst colorBorder = this.convertHexToRGBA(epic.color, 0.7);\n\t\t\t\t\t\t\tconst colorBackground = this.convertHexToRGBA(epic.color, 0.3);\n\n\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclass=\"tasks-scrum__epic-label\"\n\t\t\t\t\t\t\t\t\tstyle=\"background: ${colorBackground}; border-color: ${colorBorder};\"\n\t\t\t\t\t\t\t\t>${Text.encode(epic.name)}</span>`\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderWheelCompletedStoryPoints(sprintData: SprintData): HTMLElement\n\t{\n\t\tlet differencePercentage = 0;\n\n\t\tconst currentPercentage = this.calculatePercentage(\n\t\t\tsprintData.storyPoints,\n\t\t\tsprintData.completedStoryPoints\n\t\t);\n\n\t\tif (sprintData.existsLastSprint)\n\t\t{\n\t\t\tconst lastPercentage = this.calculatePercentage(\n\t\t\t\tsprintData.lastStoryPoints,\n\t\t\t\tsprintData.lastCompletedStoryPoints\n\t\t\t);\n\n\t\t\tdifferencePercentage = parseFloat(currentPercentage) - parseFloat(lastPercentage);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdifferencePercentage = currentPercentage;\n\t\t}\n\n\t\tlet wheelClass = '';\n\n\t\tif (differencePercentage > 0)\n\t\t{\n\t\t\twheelClass = `tasks-scrum__side-panel-completion--plan-block-number --arrow-up --percent --success`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twheelClass = `tasks-scrum__side-panel-completion--plan-block-number --arrow-down --percent --warning`;\n\t\t}\n\n\t\tconst absoluteValue = Math.abs(differencePercentage);\n\n\t\tconst renderProgress = (percent: number) => {\n\t\t\tif (percent === 0)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--progress\">\n\t\t\t\t\t<span class=\"tasks-scrum__side-panel-completion--progress-number\">${percent}</span>\n\t\t\t\t\t<span class=\"tasks-scrum__side-panel-completion--progress-percent\">%</span></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${wheelClass}\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"tasks-scrum__side-panel-completion--plan-block-number-date\"\n\t\t\t\t\ttitle=\"${Text.encode(sprintData.completedStoryPoints)}\"\n\t\t\t\t>\n\t\t\t\t\t${Text.encode(sprintData.completedStoryPoints)}\n\t\t\t\t</div>\n\t\t\t\t${renderProgress(absoluteValue)}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderUncompletedTasks(sprintData: SprintData): HTMLElement\n\t{\n\t\tif (sprintData.uncompletedTasks.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--block\">\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic\">\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-block\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-title-icon\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_ACTION_ROW_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-description\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_ACTION_MOVE_LABEL')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderMoveSelect(sprintData.plannedSprints)}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-items\">\n\t\t\t\t\t${sprintData.uncompletedTasks.map((item: Item) => this.renderItem(item))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderMoveSelect(plannedSprints: Array<PlannedSprint>): HTMLElement\n\t{\n\t\tconst uiClasses = 'ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100';\n\n\t\tlet sprintsOptions = '';\n\n\t\tplannedSprints.forEach((sprint: PlannedSprint) => {\n\t\t\tsprintsOptions += `<option value=\"${sprint.id}\">${Text.encode(sprint.name)}</option>`;\n\t\t})\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-select ${uiClasses}\">\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t<select class=\"ui-ctl-element\">\n\t\t\t\t\t<option value=\"backlog\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_SELECTOR_BACKLOG')}\n\t\t\t\t\t</option>\n\t\t\t\t\t<option value=\"0\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_SELECTOR_SPRINT')}\n\t\t\t\t\t</option>\n\t\t\t\t\t${sprintsOptions}\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderItem(item: Item): HTMLElement\n\t{\n\t\tconst src = item.responsible.photo ? Text.encode(item.responsible.photo.src) : null;\n\t\tconst photoStyle = src ? `background-image: url('${encodeURI(src)}');` : '';\n\n\t\tconst storyPointsClass = (item.storyPoints === '' ? '--empty' : '');\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__item-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--info\">\n\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--main-info\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--title\">\n\t\t\t\t\t\t\t${Text.encode(item.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--tags\">\n\t\t\t\t\t\t\t${this.renderEpic(item.epic)}\n\t\t\t\t\t\t\t${this.renderTags(item.tags)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--responsible\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"tasks-scrum__item-side-panel--responsible-photo ui-icon ui-icon-common-user\"\n\t\t\t\t\t\ttitle=\"${Text.encode(item.responsible.name)}\"\n\t\t\t\t\t><i style=\"${photoStyle}\"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span>${Text.encode(item.responsible.name)}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--story-points ${storyPointsClass}\">\n\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--story-points-content\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--story-points-element\">\n\t\t\t\t\t\t\t${item.storyPoints === '' ? '-' : Text.encode(item.storyPoints)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', () => this.emit('taskClick', item.sourceId))\n\n\t\treturn node;\n\t}\n\n\trenderEpic(epic: ?EpicType): ?HTMLElement\n\t{\n\t\tif (Type.isArray(epic) || Type.isUndefined(epic))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__item-side-panel--epic --visible\">\n\t\t\t\t<i\n\t\t\t\t\tclass=\"tasks-scrum__item-side-panel--epic-point\"\n\t\t\t\t\tstyle=\"${`background-color: ${epic.color}`}\"\n\t\t\t\t></i>\n\t\t\t\t<span>${Text.encode(epic.name)}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderTags(tags: Array<string>): ?HTMLElement\n\t{\n\t\tif (tags.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t${tags.map((tag) => Tag.render`\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--hashtag --visible\">#${Text.encode(tag)}</div>\n\t\t\t`)}\n\t\t`;\n\t}\n\n\tgetFormattedDateStart(dateStart: number): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format(Culture.getInstance().getLongDateFormat(), dateStart);\n\t\t/* eslint-enable */\n\t}\n\n\tgetFormattedDateEnd(dateEnd: number): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format(Culture.getInstance().getLongDateFormat(), dateEnd);\n\t\t/* eslint-enable */\n\t}\n\n\tgetPeriodDays(dateStartTime: number): ?string\n\t{\n\t\tconst dateWithWeekendOffset = new Date();\n\n\t\tdateWithWeekendOffset.setSeconds(dateWithWeekendOffset.getSeconds());\n\t\tdateWithWeekendOffset.setHours(0, 0, 0, 0);\n\n\t\tconst dateStart = new Date(dateStartTime * 1000);\n\n\t\tconst date = new Date();\n\t\tif (dateStart >= date)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn BX.date.format('ddiff', dateStart, dateWithWeekendOffset);\n\t};\n\n\tcalculatePercentage(first: number, second: number): number\n\t{\n\t\tif (first === 0)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst result = Math.round(second * 100 / first);\n\n\t\treturn (isNaN(result) ? 0 : result);\n\t}\n\n\tconvertHexToRGBA(hexCode, opacity)\n\t{\n\t\tlet hex = hexCode.replace('#', '');\n\n\t\tif (hex.length === 3)\n\t\t{\n\t\t\thex = `${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;\n\t\t}\n\n\t\tconst r = parseInt(hex.substring(0, 2), 16);\n\t\tconst g = parseInt(hex.substring(2, 4), 16);\n\t\tconst b = parseInt(hex.substring(4, 6), 16);\n\n\t\treturn `rgba(${r},${g},${b},${opacity})`;\n\t}\n\n\tinitHints(node: HTMLElement)\n\t{\n\t\t// todo wtf hint\n\t\tBX.UI.Hint.popup = null;\n\t\tBX.UI.Hint.id = 'ui-hint-popup-' + (+new Date());\n\t\tBX.UI.Hint.init(node);\n\t}\n}"],"names":["RequestSender","controller","action","data","analyticsLabel","Promise","resolve","reject","ajax","runAction","then","sendRequest","scrum","response","alertTitle","Type","isUndefined","errors","console","error","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","Culture","dayMonthFormat","longDateFormat","shortTimeFormat","SprintCompletionForm","params","setEventNamespace","groupId","parseInt","sidePanelManager","BX","SidePanel","Instance","sidePanelId","requestSender","node","completeButton","open","cacheable","width","contentCallback","Layout","createContent","extensions","content","bind","design","section","buttons","cancelButton","SaveButton","text","onclick","onComplete","direction","directionSelector","querySelector","value","setWaiting","completeSprint","Confetti","fire","particleCount","spread","origin","x","y","zIndex","getTopSlider","getZindex","closeSidePanel","emit","showErrorAlert","openSliders","getOpenSliders","forEach","slider","getUrl","close","getDataForSprintCompletionForm","getInstance","setData","culture","render","sprintData","storyPoints","periodDays","getPeriodDays","dateStart","Tag","Text","getRandom","encode","name","renderGoal","info","sprintGoal","renderEpics","epics","renderLabelPeriodDays","getFormattedDateStart","dateEnd","renderPeriodDays","renderWheelCompletedStoryPoints","renderUncompletedTasks","initHints","isNull","goal","map","epic","colorBorder","convertHexToRGBA","color","colorBackground","differencePercentage","currentPercentage","calculatePercentage","completedStoryPoints","existsLastSprint","lastPercentage","lastStoryPoints","lastCompletedStoryPoints","parseFloat","wheelClass","absoluteValue","Math","abs","renderProgress","percent","uncompletedTasks","renderMoveSelect","plannedSprints","item","renderItem","uiClasses","sprintsOptions","sprint","id","src","responsible","photo","photoStyle","encodeURI","storyPointsClass","renderEpic","renderTags","tags","Event","sourceId","isArray","tag","date","format","getLongDateFormat","dateStartTime","dateWithWeekendOffset","Date","setSeconds","getSeconds","setHours","first","second","result","round","isNaN","hexCode","opacity","hex","replace","r","substring","g","b","UI","Hint","popup","init","EventEmitter"],"mappings":"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"}