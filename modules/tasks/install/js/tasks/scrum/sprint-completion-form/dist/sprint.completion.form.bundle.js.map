{"version":3,"file":"sprint.completion.form.bundle.js","sources":["../src/request.sender.js","../src/sprint.completion.form.js"],"sourcesContent":["import {Loc, Type} from 'main.core';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}, analyticsLabel = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\ttop.BX.ajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data,\n\t\t\t\t\tanalyticsLabel: analyticsLabel\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tgetDataForSprintCompletionForm(data): Promise\n\t{\n\t\treturn this.sendRequest('sprint', 'getDataForSprintCompletionForm', data);\n\t}\n\n\tcompleteSprint(data): Promise\n\t{\n\t\treturn this.sendRequest(\n\t\t\t'sprint',\n\t\t\t'completeSprint',\n\t\t\tdata,\n\t\t\t{\n\t\t\t\tscrum: 'Y',\n\t\t\t\taction: 'finish_sprint',\n\t\t\t}\n\t\t);\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.log(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\ttop.BX.UI.Dialogs.MessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Event, Loc, Tag, Text, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Layout} from 'ui.sidepanel.layout';\n\nimport {RequestSender} from './request.sender';\n\nimport 'ui.hint';\n\nimport '../css/base.css';\nimport '../css/item.css';\n\ntype Params = {\n\tgroupId: number\n}\n\ntype SprintData = {\n\tid: number,\n\tname: string,\n\tinfo: {\n\t\tsprintGoal: string\n\t},\n\tepics: Array<EpicType>,\n\tdateStart: string,\n\tdateEnd: string,\n\texistsLastSprint: boolean,\n\tstoryPoints: number,\n\tcompletedStoryPoints: number,\n\tlastStoryPoints: number,\n\tlastCompletedStoryPoints: number,\n\tplannedSprints: Array<PlannedSprint>,\n\tuncompletedTasks: Array<Item>\n}\n\ntype PlannedSprint = {\n\tid: number,\n\tname: string\n}\n\ntype Item = {\n\tid: number,\n\tname: string,\n\tresponsible: {\n\t\tid: number,\n\t\tname: string,\n\t\tpathToUser: string,\n\t\tphoto?: {\n\t\t\tsrc: string\n\t\t}\n\t},\n\tepic: ?EpicType,\n\ttags: Array<string>,\n\tsourceId: number,\n\tstoryPoints: string\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tcolor: string\n}\n\ntype Response = {\n\tstatus: string,\n\tdata: SprintData,\n\terrors: Array\n}\n\nexport class SprintCompletionForm extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintCompletionForm');\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-completion-form-side-panel';\n\n\t\tthis.requestSender = new RequestSender();\n\n\t\tthis.node = null;\n\n\t\tthis.completeButton = null;\n\t}\n\n\tshow()\n\t{\n\t\tthis.sidePanelManager.open(\n\t\t\tthis.sidePanelId,\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 700,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['ui.dialogs.messagebox', 'ui.confetti', 'tasks.scrum.sprint-completion-form'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_TITLE'),\n\t\t\t\t\t\tcontent: this.createContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tthis.completeButton = new SaveButton({\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_BUTTON'),\n\t\t\t\t\t\t\t\t\tonclick: this.onComplete.bind(this)\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tonComplete()\n\t{\n\t\tlet direction = 'backlog';\n\n\t\tlet directionSelector = this.node.querySelector('.tasks-scrum__side-panel-completion--info-select');\n\t\tif (directionSelector)\n\t\t{\n\t\t\tdirectionSelector = directionSelector.querySelector('select');\n\t\t\tdirection = directionSelector.value;\n\t\t}\n\n\t\tthis.completeButton.setWaiting();\n\n\t\tthis.requestSender.completeSprint({\n\t\t\tgroupId: this.groupId,\n\t\t\tdirection: direction\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tif (top.BX.UI.Confetti)\n\t\t\t\t{\n\t\t\t\t\ttop.BX.UI.Confetti.fire({\n\t\t\t\t\t\tparticleCount: 400,\n\t\t\t\t\t\tspread: 80,\n\t\t\t\t\t\torigin: {\n\t\t\t\t\t\t\tx: 0.7,\n\t\t\t\t\t\t\ty: 0.2\n\t\t\t\t\t\t},\n\t\t\t\t\t\tzIndex: (this.sidePanelManager.getTopSlider().getZindex() + 1)\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tthis.closeSidePanel();\n\t\t\t\t\t\tthis.emit('afterComplete');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.closeSidePanel();\n\t\t\t\t\tthis.emit('afterComplete');\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\t}\n\n\tcloseSidePanel()\n\t{\n\t\tconst openSliders = this.sidePanelManager.getOpenSliders();\n\t\tif (openSliders.length > 0)\n\t\t{\n\t\t\topenSliders.forEach((slider) => {\n\t\t\t\tif (slider.getUrl() === this.sidePanelId)\n\t\t\t\t{\n\t\t\t\t\tslider.close(false);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateContent()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getDataForSprintCompletionForm({\n\t\t\t\tgroupId: this.groupId\n\t\t\t})\n\t\t\t\t.then((response: Response) => {\n\t\t\t\t\tresolve(this.render(response.data));\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\treject();\n\t\t\t\t\tthis.sidePanelManager.close(false, () => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\trender(sprintData: SprintData): HTMLElement\n\t{\n\t\tconst storyPoints = (sprintData.storyPoints === '' ? 0 : sprintData.storyPoints);\n\n\t\tconst periodDays = this.getPeriodDays(sprintData.dateStart);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div id=\"${Text.getRandom()}\" class=\"tasks-scrum__scope--side-panel-completion\">\n\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--block\">\n\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic\">\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-block\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-title\">\n\t\t\t\t\t\t\t${Text.encode(sprintData.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderGoal(sprintData.info.sprintGoal)}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-additional\">\n\n\t\t\t\t\t${this.renderEpics(sprintData.epics)}\n\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-row\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_TIME_ROW_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-content tasks-scrum__side-panel-completion--sprint-timing\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--date-name-block\">\n\t\t\t\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_DATE_START_LABEL')}</div>\n\t\t\t\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_DATE_END_LABEL')}</div>\n\t\t\t\t\t\t\t\t${this.renderLabelPeriodDays(periodDays)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--date-result-block\">\n\t\t\t\t\t\t\t\t<div>${this.getFormattedDateStart(sprintData.dateStart)}</div>\n\t\t\t\t\t\t\t\t<div>${this.getFormattedDateStart(sprintData.dateEnd)}</div>\n\t\t\t\t\t\t\t\t${this.renderPeriodDays(periodDays)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-row\">\n\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_PLAN_ROW_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-content\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block\">\n\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--sprint-plans\">\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-number --percent\">\n\t\t\t\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\t\t\t\tclass=\"tasks-scrum__side-panel-completion--plan-block-number-date\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"${Text.encode(storyPoints)}\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t${Text.encode(storyPoints)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name-text\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_PLAN_SP')}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-hint-icon\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('TSS_START_STORY_POINTS_HINT')}\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--sprint-plans\">\n\t\t\t\t\t\t\t\t\t${this.renderWheelCompletedStoryPoints(sprintData)}\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--plan-block-name-text\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_DONE_SP')}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-hint-icon\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('TSS_START_STORY_POINTS_HINT')}\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t${this.renderUncompletedTasks(sprintData)}\n\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.initHints(this.node);\n\n\t\treturn this.node;\n\t}\n\n\trenderLabelPeriodDays(periodDays: ?string): ?HTMLElement\n\t{\n\t\tif (Type.isNull(periodDays))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`<div>${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_PERIOD_LABEL')}</div>`;\n\t}\n\n\trenderPeriodDays(periodDays: ?string): ?HTMLElement\n\t{\n\t\tif (Type.isNull(periodDays))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`<div>${Text.encode(periodDays)}</div>`;\n\t}\n\n\trenderGoal(goal: string): ?HTMLElement\n\t{\n\t\tif (goal === '')\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-block\">\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-description\">\n\t\t\t\t\t${Text.encode(goal)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEpics(epics: Array<EpicType>): ?HTMLElement\n\t{\n\t\tif (!epics.length)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-row\">\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_EPICS_ROW_LABEL')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-content\">\n\t\t\t\t\t${\n\t\t\t\t\t\tepics.map((epic: EpicType) => {\n\t\t\t\t\t\t\tconst colorBorder = this.convertHexToRGBA(epic.color, 0.7);\n\t\t\t\t\t\t\tconst colorBackground = this.convertHexToRGBA(epic.color, 0.3);\n\n\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclass=\"tasks-scrum__epic-label\"\n\t\t\t\t\t\t\t\t\tstyle=\"background: ${colorBackground}; border-color: ${colorBorder};\"\n\t\t\t\t\t\t\t\t>${Text.encode(epic.name)}</span>`\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderWheelCompletedStoryPoints(sprintData: SprintData): HTMLElement\n\t{\n\t\tlet differencePercentage = 0;\n\n\t\tconst currentPercentage = this.calculatePercentage(\n\t\t\tsprintData.storyPoints,\n\t\t\tsprintData.completedStoryPoints\n\t\t);\n\n\t\tif (sprintData.existsLastSprint)\n\t\t{\n\t\t\tconst lastPercentage = this.calculatePercentage(\n\t\t\t\tsprintData.lastStoryPoints,\n\t\t\t\tsprintData.lastCompletedStoryPoints\n\t\t\t);\n\n\t\t\tdifferencePercentage = parseFloat(currentPercentage) - parseFloat(lastPercentage);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdifferencePercentage = currentPercentage;\n\t\t}\n\n\t\tlet wheelClass = '';\n\n\t\tif (differencePercentage > 0)\n\t\t{\n\t\t\twheelClass = `tasks-scrum__side-panel-completion--plan-block-number --arrow-up --percent --success`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twheelClass = `tasks-scrum__side-panel-completion--plan-block-number --arrow-down --percent --warning`;\n\t\t}\n\n\t\tconst absoluteValue = Math.abs(differencePercentage);\n\n\t\tconst renderProgress = (percent: number) => {\n\t\t\tif (percent === 0)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--progress\">\n\t\t\t\t\t<span class=\"tasks-scrum__side-panel-completion--progress-number\">${percent}</span>\n\t\t\t\t\t<span class=\"tasks-scrum__side-panel-completion--progress-percent\">%</span></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${wheelClass}\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"tasks-scrum__side-panel-completion--plan-block-number-date\"\n\t\t\t\t\ttitle=\"${Text.encode(sprintData.completedStoryPoints)}\"\n\t\t\t\t>\n\t\t\t\t\t${Text.encode(sprintData.completedStoryPoints)}\n\t\t\t\t</div>\n\t\t\t\t${renderProgress(absoluteValue)}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderUncompletedTasks(sprintData: SprintData): HTMLElement\n\t{\n\t\tif (sprintData.uncompletedTasks.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--block\">\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic\">\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-block\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-title-icon\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_ACTION_ROW_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-basic-description\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_ACTION_MOVE_LABEL')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderMoveSelect(sprintData.plannedSprints)}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-items\">\n\t\t\t\t\t${sprintData.uncompletedTasks.map((item: Item) => this.renderItem(item))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderMoveSelect(plannedSprints: Array<PlannedSprint>): HTMLElement\n\t{\n\t\tconst uiClasses = 'ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100';\n\n\t\tlet sprintsOptions = '';\n\n\t\tplannedSprints.forEach((sprint: PlannedSprint) => {\n\t\t\tsprintsOptions += `<option value=\"${sprint.id}\">${Text.encode(sprint.name)}</option>`;\n\t\t})\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-completion--info-select ${uiClasses}\">\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t<select class=\"ui-ctl-element\">\n\t\t\t\t\t<option value=\"backlog\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_SELECTOR_BACKLOG')}\n\t\t\t\t\t</option>\n\t\t\t\t\t<option value=\"0\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETION_FORM_SELECTOR_SPRINT')}\n\t\t\t\t\t</option>\n\t\t\t\t\t${sprintsOptions}\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderItem(item: Item): HTMLElement\n\t{\n\t\tconst src = item.responsible.photo ? Text.encode(item.responsible.photo.src) : null;\n\t\tconst photoStyle = src ? `background-image: url('${src}');` : '';\n\n\t\tconst storyPointsClass = (item.storyPoints === '' ? '--empty' : '');\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__item-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--info\">\n\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--main-info\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--title\">\n\t\t\t\t\t\t\t${Text.encode(item.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--tags\">\n\t\t\t\t\t\t\t${this.renderEpic(item.epic)}\n\t\t\t\t\t\t\t${this.renderTags(item.tags)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--responsible\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"tasks-scrum__item-side-panel--responsible-photo ui-icon ui-icon-common-user\"\n\t\t\t\t\t\ttitle=\"${Text.encode(item.responsible.name)}\"\n\t\t\t\t\t><i style=\"${photoStyle}\"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span>${Text.encode(item.responsible.name)}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--story-points ${storyPointsClass}\">\n\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--story-points-content\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__item-side-panel--story-points-element\">\n\t\t\t\t\t\t\t${item.storyPoints === '' ? '-' : Text.encode(item.storyPoints)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', () => this.emit('taskClick', item.sourceId))\n\n\t\treturn node;\n\t}\n\n\trenderEpic(epic: ?EpicType): ?HTMLElement\n\t{\n\t\tif (Type.isArray(epic) || Type.isUndefined(epic))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__item-side-panel--epic --visible\">\n\t\t\t\t<i\n\t\t\t\t\tclass=\"tasks-scrum__item-side-panel--epic-point\"\n\t\t\t\t\tstyle=\"${`background-color: ${epic.color}`}\"\n\t\t\t\t></i>\n\t\t\t\t<span>${Text.encode(epic.name)}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderTags(tags: Array<string>): ?HTMLElement\n\t{\n\t\tif (tags.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t${tags.map((tag) => Tag.render`\n\t\t\t\t<div class=\"tasks-scrum__item-side-panel--hashtag --visible\">#${Text.encode(tag)}</div>\n\t\t\t`)}\n\t\t`;\n\t}\n\n\tgetFormattedDateStart(dateStart: number): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format('j F Y', dateStart);\n\t\t/* eslint-enable */\n\t}\n\n\tgetFormattedDateEnd(dateEnd: number): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format('j F Y', dateEnd);\n\t\t/* eslint-enable */\n\t}\n\n\tgetPeriodDays(dateStartTime: number): ?string\n\t{\n\t\tconst dateWithWeekendOffset = new Date();\n\n\t\tdateWithWeekendOffset.setSeconds(dateWithWeekendOffset.getSeconds());\n\t\tdateWithWeekendOffset.setHours(0, 0, 0, 0);\n\n\t\tconst dateStart = new Date(dateStartTime * 1000);\n\n\t\tconst date = new Date();\n\t\tif (dateStart >= date)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn BX.date.format('ddiff', dateStart, dateWithWeekendOffset);\n\t};\n\n\tcalculatePercentage(first: number, second: number): number\n\t{\n\t\tif (first === 0)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst result = Math.round(second * 100 / first);\n\n\t\treturn (isNaN(result) ? 0 : result);\n\t}\n\n\tconvertHexToRGBA(hexCode, opacity)\n\t{\n\t\tlet hex = hexCode.replace('#', '');\n\n\t\tif (hex.length === 3)\n\t\t{\n\t\t\thex = `${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;\n\t\t}\n\n\t\tconst r = parseInt(hex.substring(0, 2), 16);\n\t\tconst g = parseInt(hex.substring(2, 4), 16);\n\t\tconst b = parseInt(hex.substring(4, 6), 16);\n\n\t\treturn `rgba(${r},${g},${b},${opacity})`;\n\t}\n\n\tinitHints(node: HTMLElement)\n\t{\n\t\t// todo wtf hint\n\t\ttop.BX.UI.Hint.popup = null;\n\t\ttop.BX.UI.Hint.id = 'ui-hint-popup-' + (+new Date());\n\t\ttop.BX.UI.Hint.init(node);\n\t}\n}"],"names":["RequestSender","controller","action","data","analyticsLabel","Promise","resolve","reject","top","BX","ajax","runAction","then","sendRequest","scrum","response","alertTitle","Type","isUndefined","errors","console","log","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","UI","Dialogs","MessageBox","alert","SprintCompletionForm","params","setEventNamespace","groupId","parseInt","sidePanelManager","SidePanel","Instance","sidePanelId","requestSender","node","completeButton","open","cacheable","width","contentCallback","Layout","createContent","extensions","content","bind","design","section","buttons","cancelButton","SaveButton","text","onclick","onComplete","direction","directionSelector","querySelector","value","setWaiting","completeSprint","Confetti","fire","particleCount","spread","origin","x","y","zIndex","getTopSlider","getZindex","closeSidePanel","emit","showErrorAlert","openSliders","getOpenSliders","forEach","slider","getUrl","close","getDataForSprintCompletionForm","render","sprintData","storyPoints","periodDays","getPeriodDays","dateStart","Tag","Text","getRandom","encode","name","renderGoal","info","sprintGoal","renderEpics","epics","renderLabelPeriodDays","getFormattedDateStart","dateEnd","renderPeriodDays","renderWheelCompletedStoryPoints","renderUncompletedTasks","initHints","isNull","goal","map","epic","colorBorder","convertHexToRGBA","color","colorBackground","differencePercentage","currentPercentage","calculatePercentage","completedStoryPoints","existsLastSprint","lastPercentage","lastStoryPoints","lastCompletedStoryPoints","parseFloat","wheelClass","absoluteValue","Math","abs","renderProgress","percent","uncompletedTasks","renderMoveSelect","plannedSprints","item","renderItem","uiClasses","sprintsOptions","sprint","id","src","responsible","photo","photoStyle","storyPointsClass","renderEpic","renderTags","tags","Event","sourceId","isArray","tag","date","format","dateStartTime","dateWithWeekendOffset","Date","setSeconds","getSeconds","setHours","first","second","result","round","isNaN","hexCode","opacity","hex","replace","r","substring","g","b","Hint","popup","init","EventEmitter"],"mappings":"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"}