{"version":3,"file":"sprint.start.form.bundle.js","sources":["../src/request.sender.js","../src/sprint.start.form.js"],"sourcesContent":["import {Loc, Type, ajax} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}, analyticsLabel = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data,\n\t\t\t\t\tanalyticsLabel: analyticsLabel\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tgetDataForSprintStartForm(data): Promise\n\t{\n\t\treturn this.sendRequest('sprint', 'getDataForSprintStartForm', data);\n\t}\n\n\tstartSprint(data): Promise\n\t{\n\t\treturn this.sendRequest(\n\t\t\t'sprint',\n\t\t\t'startSprint',\n\t\t\tdata,\n\t\t\t{\n\t\t\t\tscrum: 'Y',\n\t\t\t\taction: 'sprint_start',\n\t\t\t}\n\t\t);\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.error(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Layout} from 'ui.sidepanel.layout';\n\nimport {RequestSender} from './request.sender';\n\nimport 'ui.hint';\nimport 'ui.fonts.opensans';\n\nimport '../css/base.css';\n\ntype Params = {\n\tgroupId: number,\n\tsprintId: number\n}\n\ntype SprintData = {\n\tid: number,\n\tname: string,\n\tepics: Array<EpicType>,\n\tdateStart: string,\n\tdateEnd: string,\n\tnumberTasks: number,\n\tstoryPoints: number,\n\tdifferenceStoryPoints: string,\n\tdifferenceMarker: boolean,\n\tnumberUnevaluatedTasks: number\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tcolor: string\n}\n\ntype Response = {\n\tstatus: string,\n\tdata: SprintData,\n\terrors: Array\n}\n\nexport class SprintStartForm extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintStartForm');\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.sprintId = parseInt(params.sprintId, 10);\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.requestSender = new RequestSender();\n\n\t\tthis.node = null;\n\n\t\tthis.startButton = null;\n\t}\n\n\tshow()\n\t{\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-sprint-start-form-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 700,\n\t\t\t\tlabel: {\n\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_SIDE_PANEL_LABEL'),\n\t\t\t\t},\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['ui.dialogs.messagebox', 'tasks.scrum.sprint-start-form'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_TITLE'),\n\t\t\t\t\t\tcontent: this.createContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tthis.startButton = new SaveButton({\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_BUTTON'),\n\t\t\t\t\t\t\t\t\tonclick: this.onStart.bind(this)\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tonStart()\n\t{\n\t\tthis.startButton.setWaiting();\n\n\t\tconst baseContainer = this.node.querySelector('.tasks-scrum__side-panel-start--info-basic');\n\n\t\tconst timeContainer = this.node.querySelector('.tasks-scrum__side-panel-start--timing');\n\t\tconst dateInputs = timeContainer.querySelectorAll('.ui-ctl-date');\n\n\t\tconst dateStartValue = dateInputs.item(0).querySelector('input').value;\n\t\tconst dateEndValue = dateInputs.item(1).querySelector('input').value;\n\n\t\tthis.requestSender.startSprint({\n\t\t\tgroupId: this.groupId,\n\t\t\tsprintId: this.sprintId,\n\t\t\tname: baseContainer.querySelector('input').value,\n\t\t\tsprintGoal: baseContainer.querySelector('textarea').value,\n\t\t\tdateStart: Math.floor(BX.parseDate(dateStartValue).getTime() / 1000),\n\t\t\tdateEnd: Math.floor(BX.parseDate(dateEndValue).getTime() / 1000)\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tthis.sidePanelManager.close(false, () => {\n\t\t\t\t\tthis.emit('afterStart');\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.startButton.setWaiting(false);\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\t}\n\n\tcreateContent()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getDataForSprintStartForm({\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\tsprintId: this.sprintId\n\t\t\t})\n\t\t\t\t.then((response: Response) => {\n\t\t\t\t\tresolve(this.render(response.data));\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\treject();\n\t\t\t\t\tthis.sidePanelManager.close(false, () => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\trender(sprintData: SprintData): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-start tasks-scrum__scope--side-panel-start\">\n\n\t\t\t\t<div class=\"tasks-scrum__side-panel-start--block\">\n\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-basic\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-basic-block\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_NAME_PLACEHOLDER')}\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"tasks-scrum__side-panel-start--info-basic-input\"\n\t\t\t\t\t\t\t\tvalue=\"${Text.encode(sprintData.name)}\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-basic-block\">\n\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_DESC_PLACEHOLDER')}\"\n\t\t\t\t\t\t\t\trows=\"7\"\n\t\t\t\t\t\t\t\tclass=\"tasks-scrum__side-panel-start--info-basic-textarea\"\n\t\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-additional\">\n\n\t\t\t\t\t\t${this.renderEpics(sprintData.epics)}\n\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-row tasks-scrum__side-panel-start--timing\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_TIME_ROW_LABEL')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-content\">\n\t\t\t\t\t\t\t\t<label class=\"tasks-scrum__side-panel-start--date\">\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--date-name\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_DATE_START_LABEL')}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-date\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-calendar\"></div>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\t\t\tvalue=\"${sprintData.dateStart}\"\n\t\t\t\t\t\t\t\t\t\t\treadonly=\"readonly\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<label class=\"tasks-scrum__side-panel-start--date\">\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--date-name\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_DATE_END_LABEL')}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-date\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-calendar\"></div>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\t\t\tvalue=\"${sprintData.dateEnd}\"\n\t\t\t\t\t\t\t\t\t\t\treadonly=\"readonly\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-row\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_PLAN_ROW_LABEL')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-content\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block\">\n\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--sprint-plans\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block-number\">\n\t\t\t\t\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tasks-scrum__side-panel-start--plan-block-number-date\" \n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"${sprintData.numberTasks}\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t${sprintData.numberTasks}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block-name\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block-name-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_TASK_COUNT_LABEL')}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--sprint-plans\">\n\t\t\t\t\t\t\t\t\t${this.renderWheelStoryPoints(sprintData)}\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block-name\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block-name-text\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_STORY_POINTS_LABEL')}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-hint-icon\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('TSS_START_STORY_POINTS_HINT')}\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderWarning(sprintData.numberUnevaluatedTasks)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst timeContainer = this.node.querySelector('.tasks-scrum__side-panel-start--timing');\n\t\ttimeContainer.querySelectorAll('.ui-ctl-date')\n\t\t\t.forEach((inputContainer: HTMLElement) => {\n\t\t\t\tEvent.bind(\n\t\t\t\t\tinputContainer,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.showCalendar.bind(this, inputContainer)\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\n\t\tthis.initHints(this.node);\n\n\t\treturn this.node;\n\t}\n\n\trenderEpics(epics: Array<EpicType>): ?HTMLElement\n\t{\n\t\tif (!epics.length)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-start--info-row\">\n\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_EPICS_ROW_LABEL')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-content\">\n\t\t\t\t\t${\n\t\t\t\t\t\tepics.map((epic: EpicType) => {\n\t\t\t\t\t\t\tconst colorBorder = this.convertHexToRGBA(epic.color, 0.7);\n\t\t\t\t\t\t\tconst colorBackground = this.convertHexToRGBA(epic.color, 0.3);\n\n\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclass=\"tasks-scrum__epic-label\"\n\t\t\t\t\t\t\t\t\tstyle=\"background: ${colorBackground}; border-color: ${colorBorder};\"\n\t\t\t\t\t\t\t\t>${Text.encode(epic.name)}</span>`\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderWarning(count: number): ?HTMLElement\n\t{\n\t\tif (count === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-alert ui-alert-icon-danger ui-alert-warning\">\n\t\t\t\t<span class=\"ui-alert-message\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_WARN_TEXT').replace('#count#', count)}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderWheelStoryPoints(sprintData: SprintData): string\n\t{\n\t\tlet numberClass = '';\n\n\t\tif (sprintData.differenceMarker)\n\t\t{\n\t\t\tconst arrowClass = sprintData.storyPoints === '' ? '' : '--arrow-up';\n\n\t\t\tnumberClass = `tasks-scrum__side-panel-start--plan-block-number ${arrowClass} --success`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst arrowClass = sprintData.storyPoints === '' ? '' : '--arrow-down';\n\n\t\t\tnumberClass = `tasks-scrum__side-panel-start--plan-block-number ${arrowClass} --warning`;\n\t\t}\n\n\t\tconst renderProgress = (differenceStoryPoints) => {\n\t\t\tif (parseInt(differenceStoryPoints, 10) === 0)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum__side-panel-start--progress\">\n\t\t\t\t\t<span class=\"tasks-scrum__side-panel-start--progress-number\">${differenceStoryPoints}</span>\n\t\t\t\t\t<span class=\"tasks-scrum__side-panel-start--progress-percent\">%</span></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${numberClass}\">\n\t\t\t<div \n\t\t\t\tclass=\"tasks-scrum__side-panel-start--plan-block-number-date\"\n\t\t\t\ttitle=\"${sprintData.storyPoints === '' ? 0 : sprintData.storyPoints}\"\n\t\t\t>\n\t\t\t\t${sprintData.storyPoints === '' ? 0 : sprintData.storyPoints}\n\t\t\t</div>\n\t\t\t${renderProgress(sprintData.differenceStoryPoints)}\n\t\t`;\n\t}\n\n\tshowCalendar(inputContainer: HTMLElement)\n\t{\n\t\t/* eslint-disable */\n\t\tnew BX.JCCalendar().Show({\n\t\t\tnode: inputContainer,\n\t\t\tfield: inputContainer.querySelector('input'),\n\t\t\tbTime: false,\n\t\t\tbSetFocus: false,\n\t\t\tbHideTime: false\n\t\t})\n\t\t/* eslint-enable */\n\t}\n\n\tconvertHexToRGBA(hexCode, opacity)\n\t{\n\t\tlet hex = hexCode.replace('#', '');\n\n\t\tif (hex.length === 3)\n\t\t{\n\t\t\thex = `${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;\n\t\t}\n\n\t\tconst r = parseInt(hex.substring(0, 2), 16);\n\t\tconst g = parseInt(hex.substring(2, 4), 16);\n\t\tconst b = parseInt(hex.substring(4, 6), 16);\n\n\t\treturn `rgba(${r},${g},${b},${opacity})`;\n\t}\n\n\tinitHints(node: HTMLElement)\n\t{\n\t\t// todo wtf hint\n\t\tBX.UI.Hint.popup = null;\n\t\tBX.UI.Hint.id = 'ui-hint-popup-' + (+new Date());\n\t\tBX.UI.Hint.init(node);\n\t}\n}"],"names":["RequestSender","controller","action","data","analyticsLabel","Promise","resolve","reject","ajax","runAction","then","sendRequest","scrum","response","alertTitle","Type","isUndefined","errors","console","error","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","SprintStartForm","params","setEventNamespace","groupId","parseInt","sprintId","sidePanelManager","BX","SidePanel","Instance","requestSender","node","startButton","open","cacheable","width","label","text","contentCallback","Layout","createContent","extensions","content","bind","design","section","buttons","cancelButton","SaveButton","onclick","onStart","setWaiting","baseContainer","querySelector","timeContainer","dateInputs","querySelectorAll","dateStartValue","item","value","dateEndValue","startSprint","name","sprintGoal","dateStart","Math","floor","parseDate","getTime","dateEnd","close","emit","showErrorAlert","getDataForSprintStartForm","render","sprintData","Tag","Text","encode","renderEpics","epics","numberTasks","renderWheelStoryPoints","renderWarning","numberUnevaluatedTasks","forEach","inputContainer","Event","showCalendar","initHints","map","epic","colorBorder","convertHexToRGBA","color","colorBackground","count","replace","numberClass","differenceMarker","arrowClass","storyPoints","renderProgress","differenceStoryPoints","JCCalendar","Show","field","bTime","bSetFocus","bHideTime","hexCode","opacity","hex","r","substring","g","b","UI","Hint","popup","id","Date","init","EventEmitter"],"mappings":";;;;;KASaA,aAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,gCAEaC,UAFb,EAEiCC,MAFjC,EAGC;CAAA,UADgDC,IAChD,uEADuD,EACvD;CAAA,UAD2DC,cAC3D,uEAD4E,EAC5E;CACC,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvCC,QAAAA,cAAI,CAACC,SAAL,CACC,wBAAwBR,UAAxB,GAAqC,GAArC,GAA2CC,MAD5C,EAEC;CACCC,UAAAA,IAAI,EAAEA,IADP;CAECC,UAAAA,cAAc,EAAEA;CAFjB,SAFD,EAMEM,IANF,CAMOJ,OANP,EAMgBC,MANhB;CAOA,OARM,CAAP;CASA;CAbF;CAAA;CAAA,8CAe2BJ,IAf3B,EAgBC;CACC,aAAO,KAAKQ,WAAL,CAAiB,QAAjB,EAA2B,2BAA3B,EAAwDR,IAAxD,CAAP;CACA;CAlBF;CAAA;CAAA,gCAoBaA,IApBb,EAqBC;CACC,aAAO,KAAKQ,WAAL,CACN,QADM,EAEN,aAFM,EAGNR,IAHM,EAIN;CACCS,QAAAA,KAAK,EAAE,GADR;CAECV,QAAAA,MAAM,EAAE;CAFT,OAJM,CAAP;CASA;CA/BF;CAAA;CAAA,mCAiCgBW,QAjChB,EAiCyCC,UAjCzC,EAkCC;CACC,UAAIC,cAAI,CAACC,WAAL,CAAiBH,QAAQ,CAACI,MAA1B,CAAJ,EACA;CACCC,QAAAA,OAAO,CAACC,KAAR,CAAcN,QAAd;CAEA;CACA;;CAED,UAAIA,QAAQ,CAACI,MAAT,CAAgBG,MAApB,EACA;CACC,YAAMC,UAAU,GAAGR,QAAQ,CAACI,MAAT,CAAgBK,KAAhB,EAAnB;;CACA,YAAID,UAAJ,EACA;CACC,cAAME,SAAS,GAAIF,UAAU,CAACG,IAAX,GAAkBH,UAAU,CAACG,IAA7B,GAAoC,EAAvD;CAEA,cAAMC,OAAO,GAAGJ,UAAU,CAACI,OAAX,GAAqB,GAArB,GAA2BF,SAA3C;CACA,cAAMG,KAAK,GAAIZ,UAAU,GAAGA,UAAH,GAAgBa,aAAG,CAACC,UAAJ,CAAe,+BAAf,CAAzC;CAEAC,UAAAA,gCAAU,CAACC,KAAX,CAAiBL,OAAjB,EAA0BC,KAA1B;CACA;CACD;CACD;CAvDF;CAAA;CAAA;;;KCkCaK,eAAb;CAAA;;CAEC,2BAAYC,MAAZ,EACA;CAAA;;CAAA;CACC,iHAAMA,MAAN;;CAEA,UAAKC,iBAAL,CAAuB,gCAAvB;;CAEA,UAAKC,OAAL,GAAeC,QAAQ,CAACH,MAAM,CAACE,OAAR,EAAiB,EAAjB,CAAvB;CACA,UAAKE,QAAL,GAAgBD,QAAQ,CAACH,MAAM,CAACI,QAAR,EAAkB,EAAlB,CAAxB;CAEA;;CACA,UAAKC,gBAAL,GAAwBC,EAAE,CAACC,SAAH,CAAaC,QAArC;CACA;;CAEA,UAAKC,aAAL,GAAqB,IAAIzC,aAAJ,EAArB;CAEA,UAAK0C,IAAL,GAAY,IAAZ;CAEA,UAAKC,WAAL,GAAmB,IAAnB;CAhBD;CAiBC;;CApBF;CAAA;CAAA,2BAuBC;CAAA;;CACC,WAAKN,gBAAL,CAAsBO,IAAtB,CACC,0CADD,EAEC;CACCC,QAAAA,SAAS,EAAE,KADZ;CAECC,QAAAA,KAAK,EAAE,GAFR;CAGCC,QAAAA,KAAK,EAAE;CACNC,UAAAA,IAAI,EAAErB,aAAG,CAACC,UAAJ,CAAe,qCAAf;CADA,SAHR;CAMCqB,QAAAA,eAAe,EAAE,2BAAM;CACtB,iBAAOC,0BAAM,CAACC,aAAP,CAAqB;CAC3BC,YAAAA,UAAU,EAAE,CAAC,uBAAD,EAA0B,+BAA1B,CADe;CAE3B1B,YAAAA,KAAK,EAAEC,aAAG,CAACC,UAAJ,CAAe,qCAAf,CAFoB;CAG3ByB,YAAAA,OAAO,EAAE,MAAI,CAACF,aAAL,CAAmBG,IAAnB,CAAwB,MAAxB,CAHkB;CAI3BC,YAAAA,MAAM,EAAE;CACPC,cAAAA,OAAO,EAAE;CADF,aAJmB;CAO3BC,YAAAA,OAAO,EAAE,uBAAgC;CAAA,kBAA9BC,YAA8B,QAA9BA,YAA8B;CAAA,kBAAhBC,UAAgB,QAAhBA,UAAgB;CACxC,qBAAO,CACN,MAAI,CAAChB,WAAL,GAAmB,IAAIgB,UAAJ,CAAe;CACjCX,gBAAAA,IAAI,EAAErB,aAAG,CAACC,UAAJ,CAAe,sCAAf,CAD2B;CAEjCgC,gBAAAA,OAAO,EAAE,MAAI,CAACC,OAAL,CAAaP,IAAb,CAAkB,MAAlB;CAFwB,eAAf,CADb,EAKNI,YALM,CAAP;CAOA;CAf0B,WAArB,CAAP;CAiBA;CAxBF,OAFD;CA6BA;CArDF;CAAA;CAAA,8BAwDC;CAAA;;CACC,WAAKf,WAAL,CAAiBmB,UAAjB;CAEA,UAAMC,aAAa,GAAG,KAAKrB,IAAL,CAAUsB,aAAV,CAAwB,4CAAxB,CAAtB;CAEA,UAAMC,aAAa,GAAG,KAAKvB,IAAL,CAAUsB,aAAV,CAAwB,wCAAxB,CAAtB;CACA,UAAME,UAAU,GAAGD,aAAa,CAACE,gBAAd,CAA+B,cAA/B,CAAnB;CAEA,UAAMC,cAAc,GAAGF,UAAU,CAACG,IAAX,CAAgB,CAAhB,EAAmBL,aAAnB,CAAiC,OAAjC,EAA0CM,KAAjE;CACA,UAAMC,YAAY,GAAGL,UAAU,CAACG,IAAX,CAAgB,CAAhB,EAAmBL,aAAnB,CAAiC,OAAjC,EAA0CM,KAA/D;CAEA,WAAK7B,aAAL,CAAmB+B,WAAnB,CAA+B;CAC9BtC,QAAAA,OAAO,EAAE,KAAKA,OADgB;CAE9BE,QAAAA,QAAQ,EAAE,KAAKA,QAFe;CAG9BqC,QAAAA,IAAI,EAAEV,aAAa,CAACC,aAAd,CAA4B,OAA5B,EAAqCM,KAHb;CAI9BI,QAAAA,UAAU,EAAEX,aAAa,CAACC,aAAd,CAA4B,UAA5B,EAAwCM,KAJtB;CAK9BK,QAAAA,SAAS,EAAEC,IAAI,CAACC,KAAL,CAAWvC,EAAE,CAACwC,SAAH,CAAaV,cAAb,EAA6BW,OAA7B,KAAyC,IAApD,CALmB;CAM9BC,QAAAA,OAAO,EAAEJ,IAAI,CAACC,KAAL,CAAWvC,EAAE,CAACwC,SAAH,CAAaP,YAAb,EAA2BQ,OAA3B,KAAuC,IAAlD;CANqB,OAA/B,EAQErE,IARF,CAQO,UAACG,QAAD,EAAc;CACnB,QAAA,MAAI,CAACwB,gBAAL,CAAsB4C,KAAtB,CAA4B,KAA5B,EAAmC,YAAM;CACxC,UAAA,MAAI,CAACC,IAAL,CAAU,YAAV;CACA,SAFD;CAGA,OAZF,WAaQ,UAACrE,QAAD,EAAc;CACpB,QAAA,MAAI,CAAC8B,WAAL,CAAiBmB,UAAjB,CAA4B,KAA5B;;CACA,QAAA,MAAI,CAACrB,aAAL,CAAmB0C,cAAnB,CACCtE,QADD,EAECc,aAAG,CAACC,UAAJ,CAAe,4CAAf,CAFD;CAIA,OAnBF;CAqBA;CAxFF;CAAA;CAAA,oCA2FC;CAAA;;CACC,aAAO,IAAIvB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvC,QAAA,MAAI,CAACkC,aAAL,CAAmB2C,yBAAnB,CAA6C;CAC5ClD,UAAAA,OAAO,EAAE,MAAI,CAACA,OAD8B;CAE5CE,UAAAA,QAAQ,EAAE,MAAI,CAACA;CAF6B,SAA7C,EAIE1B,IAJF,CAIO,UAACG,QAAD,EAAwB;CAC7BP,UAAAA,OAAO,CAAC,MAAI,CAAC+E,MAAL,CAAYxE,QAAQ,CAACV,IAArB,CAAD,CAAP;CACA,SANF,WAOQ,UAACU,QAAD,EAAc;CACpBN,UAAAA,MAAM;;CACN,UAAA,MAAI,CAAC8B,gBAAL,CAAsB4C,KAAtB,CAA4B,KAA5B,EAAmC,YAAM;CACxC,YAAA,MAAI,CAACxC,aAAL,CAAmB0C,cAAnB,CAAkCtE,QAAlC;CACA,WAFD;CAGA,SAZF;CAcA,OAfM,CAAP;CAgBA;CA5GF;CAAA;CAAA,2BA8GQyE,UA9GR,EA+GC;CAAA;;CACC,WAAK5C,IAAL,GAAY6C,aAAG,CAACF,MAAhB,62IAQqB1D,aAAG,CAACC,UAAJ,CAAe,gDAAf,CARrB,EAWe4D,cAAI,CAACC,MAAL,CAAYH,UAAU,CAACb,IAAvB,CAXf,EAgBqB9C,aAAG,CAACC,UAAJ,CAAe,gDAAf,CAhBrB,EAyBM,KAAK8D,WAAL,CAAiBJ,UAAU,CAACK,KAA5B,CAzBN,EA6BQhE,aAAG,CAACC,UAAJ,CAAe,8CAAf,CA7BR,EAkCUD,aAAG,CAACC,UAAJ,CAAe,gDAAf,CAlCV,EAyCkB0D,UAAU,CAACX,SAzC7B,EAgDUhD,aAAG,CAACC,UAAJ,CAAe,8CAAf,CAhDV,EAuDkB0D,UAAU,CAACN,OAvD7B,EAiEQrD,aAAG,CAACC,UAAJ,CAAe,8CAAf,CAjER,EA0EmB0D,UAAU,CAACM,WA1E9B,EA4EYN,UAAU,CAACM,WA5EvB,EAiFYjE,aAAG,CAACC,UAAJ,CAAe,gDAAf,CAjFZ,EAuFS,KAAKiE,sBAAL,CAA4BP,UAA5B,CAvFT,EA0FW3D,aAAG,CAACC,UAAJ,CAAe,kDAAf,CA1FX,EA+FuBD,aAAG,CAACC,UAAJ,CAAe,6BAAf,CA/FvB,EA0GK,KAAKkE,aAAL,CAAmBR,UAAU,CAACS,sBAA9B,CA1GL;CA+GA,UAAM9B,aAAa,GAAG,KAAKvB,IAAL,CAAUsB,aAAV,CAAwB,wCAAxB,CAAtB;CACAC,MAAAA,aAAa,CAACE,gBAAd,CAA+B,cAA/B,EACE6B,OADF,CACU,UAACC,cAAD,EAAiC;CACzCC,QAAAA,eAAK,CAAC5C,IAAN,CACC2C,cADD,EAEC,OAFD,EAGC,MAAI,CAACE,YAAL,CAAkB7C,IAAlB,CAAuB,MAAvB,EAA6B2C,cAA7B,CAHD;CAKA,OAPF;CAUA,WAAKG,SAAL,CAAe,KAAK1D,IAApB;CAEA,aAAO,KAAKA,IAAZ;CACA;CA7OF;CAAA;CAAA,gCA+OaiD,KA/Ob,EAgPC;CAAA;;CACC,UAAI,CAACA,KAAK,CAACvE,MAAX,EACA;CACC,eAAO,EAAP;CACA;;CAED,aAAOmE,aAAG,CAACF,MAAX,+WAGK1D,aAAG,CAACC,UAAJ,CAAe,+CAAf,CAHL,EAOI+D,KAAK,CAACU,GAAN,CAAU,UAACC,IAAD,EAAoB;CAC7B,YAAMC,WAAW,GAAG,MAAI,CAACC,gBAAL,CAAsBF,IAAI,CAACG,KAA3B,EAAkC,GAAlC,CAApB;;CACA,YAAMC,eAAe,GAAG,MAAI,CAACF,gBAAL,CAAsBF,IAAI,CAACG,KAA3B,EAAkC,GAAlC,CAAxB;;CAEA,eAAOlB,aAAG,CAACF,MAAX,iQAGuBqB,eAHvB,EAGyDH,WAHzD,EAIIf,cAAI,CAACC,MAAL,CAAYa,IAAI,CAAC7B,IAAjB,CAJJ;CAKA,OATD,CAPJ;CAqBA;CA3QF;CAAA;CAAA,kCA6QekC,KA7Qf,EA8QC;CACC,UAAIA,KAAK,KAAK,CAAd,EACA;CACC,eAAO,EAAP;CACA;;CAED,aAAOpB,aAAG,CAACF,MAAX,0PAGK1D,aAAG,CAACC,UAAJ,CAAe,yCAAf,EAA0DgF,OAA1D,CAAkE,SAAlE,EAA6ED,KAA7E,CAHL;CAOA;CA3RF;CAAA;CAAA,2CA6RwBrB,UA7RxB,EA8RC;CACC,UAAIuB,WAAW,GAAG,EAAlB;;CAEA,UAAIvB,UAAU,CAACwB,gBAAf,EACA;CACC,YAAMC,UAAU,GAAGzB,UAAU,CAAC0B,WAAX,KAA2B,EAA3B,GAAgC,EAAhC,GAAqC,YAAxD;CAEAH,QAAAA,WAAW,8DAAuDE,UAAvD,eAAX;CACA,OALD,MAOA;CACC,YAAMA,WAAU,GAAGzB,UAAU,CAAC0B,WAAX,KAA2B,EAA3B,GAAgC,EAAhC,GAAqC,cAAxD;;CAEAH,QAAAA,WAAW,8DAAuDE,WAAvD,eAAX;CACA;;CAED,UAAME,cAAc,GAAG,SAAjBA,cAAiB,CAACC,qBAAD,EAA2B;CACjD,YAAI/E,QAAQ,CAAC+E,qBAAD,EAAwB,EAAxB,CAAR,KAAwC,CAA5C,EACA;CACC,iBAAO,EAAP;CACA;;CAED,eAAO3B,aAAG,CAACF,MAAX,6VAEiE6B,qBAFjE;CAMA,OAZD;;CAcA,aAAO3B,aAAG,CAACF,MAAX,qRACewB,WADf,EAIWvB,UAAU,CAAC0B,WAAX,KAA2B,EAA3B,GAAgC,CAAhC,GAAoC1B,UAAU,CAAC0B,WAJ1D,EAMI1B,UAAU,CAAC0B,WAAX,KAA2B,EAA3B,GAAgC,CAAhC,GAAoC1B,UAAU,CAAC0B,WANnD,EAQGC,cAAc,CAAC3B,UAAU,CAAC4B,qBAAZ,CARjB;CAUA;CAtUF;CAAA;CAAA,iCAwUcjB,cAxUd,EAyUC;CACC;CACA,UAAI3D,EAAE,CAAC6E,UAAP,GAAoBC,IAApB,CAAyB;CACxB1E,QAAAA,IAAI,EAAEuD,cADkB;CAExBoB,QAAAA,KAAK,EAAEpB,cAAc,CAACjC,aAAf,CAA6B,OAA7B,CAFiB;CAGxBsD,QAAAA,KAAK,EAAE,KAHiB;CAIxBC,QAAAA,SAAS,EAAE,KAJa;CAKxBC,QAAAA,SAAS,EAAE;CALa,OAAzB;CAOA;CACA;CAnVF;CAAA;CAAA,qCAqVkBC,OArVlB,EAqV2BC,OArV3B,EAsVC;CACC,UAAIC,GAAG,GAAGF,OAAO,CAACb,OAAR,CAAgB,GAAhB,EAAqB,EAArB,CAAV;;CAEA,UAAIe,GAAG,CAACvG,MAAJ,KAAe,CAAnB,EACA;CACCuG,QAAAA,GAAG,aAAMA,GAAG,CAAC,CAAD,CAAT,SAAeA,GAAG,CAAC,CAAD,CAAlB,SAAwBA,GAAG,CAAC,CAAD,CAA3B,SAAiCA,GAAG,CAAC,CAAD,CAApC,SAA0CA,GAAG,CAAC,CAAD,CAA7C,SAAmDA,GAAG,CAAC,CAAD,CAAtD,CAAH;CACA;;CAED,UAAMC,CAAC,GAAGzF,QAAQ,CAACwF,GAAG,CAACE,SAAJ,CAAc,CAAd,EAAiB,CAAjB,CAAD,EAAsB,EAAtB,CAAlB;CACA,UAAMC,CAAC,GAAG3F,QAAQ,CAACwF,GAAG,CAACE,SAAJ,CAAc,CAAd,EAAiB,CAAjB,CAAD,EAAsB,EAAtB,CAAlB;CACA,UAAME,CAAC,GAAG5F,QAAQ,CAACwF,GAAG,CAACE,SAAJ,CAAc,CAAd,EAAiB,CAAjB,CAAD,EAAsB,EAAtB,CAAlB;CAEA,4BAAeD,CAAf,cAAoBE,CAApB,cAAyBC,CAAzB,cAA8BL,OAA9B;CACA;CAnWF;CAAA;CAAA,8BAqWWhF,IArWX,EAsWC;CACC;CACAJ,MAAAA,EAAE,CAAC0F,EAAH,CAAMC,IAAN,CAAWC,KAAX,GAAmB,IAAnB;CACA5F,MAAAA,EAAE,CAAC0F,EAAH,CAAMC,IAAN,CAAWE,EAAX,GAAgB,mBAAoB,CAAC,IAAIC,IAAJ,EAArC;CACA9F,MAAAA,EAAE,CAAC0F,EAAH,CAAMC,IAAN,CAAWI,IAAX,CAAgB3F,IAAhB;CACA;CA3WF;CAAA;CAAA,EAAqC4F,6BAArC;;;;;;;;"}