{"version":3,"file":"sprint.start.form.bundle.js","sources":["../src/request.sender.js","../src/sprint.start.form.js"],"sourcesContent":["import {Loc, Type, ajax} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tsendRequest(controller: string, action: string, data = {}, analyticsLabel = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.' + controller + '.' + action,\n\t\t\t\t{\n\t\t\t\t\tdata: data,\n\t\t\t\t\tanalyticsLabel: analyticsLabel\n\t\t\t\t}\n\t\t\t).then(resolve, reject);\n\t\t});\n\t}\n\n\tgetDataForSprintStartForm(data): Promise\n\t{\n\t\treturn this.sendRequest('sprint', 'getDataForSprintStartForm', data);\n\t}\n\n\tstartSprint(data): Promise\n\t{\n\t\treturn this.sendRequest(\n\t\t\t'sprint',\n\t\t\t'startSprint',\n\t\t\tdata,\n\t\t\t{\n\t\t\t\tscrum: 'Y',\n\t\t\t\taction: 'sprint_start',\n\t\t\t}\n\t\t);\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.error(response);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Layout} from 'ui.sidepanel.layout';\n\nimport {RequestSender} from './request.sender';\n\nimport 'ui.hint';\nimport 'ui.fonts.opensans';\n\nimport '../css/base.css';\n\ntype Params = {\n\tgroupId: number,\n\tsprintId: number\n}\n\ntype SprintData = {\n\tid: number,\n\tname: string,\n\tepics: Array<EpicType>,\n\tdateStart: string,\n\tdateEnd: string,\n\tnumberTasks: number,\n\tstoryPoints: number,\n\tdifferenceStoryPoints: string,\n\tdifferenceMarker: boolean,\n\tnumberUnevaluatedTasks: number\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tcolor: string\n}\n\ntype Response = {\n\tstatus: string,\n\tdata: SprintData,\n\terrors: Array\n}\n\nexport class SprintStartForm extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintStartForm');\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.sprintId = parseInt(params.sprintId, 10);\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.requestSender = new RequestSender();\n\n\t\tthis.node = null;\n\n\t\tthis.startButton = null;\n\t}\n\n\tshow()\n\t{\n\t\tthis.sidePanelManager.open(\n\t\t\t'tasks-scrum-sprint-start-form-side-panel',\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 700,\n\t\t\t\tlabel: {\n\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_SIDE_PANEL_LABEL'),\n\t\t\t\t},\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['ui.dialogs.messagebox', 'tasks.scrum.sprint-start-form'],\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_TITLE'),\n\t\t\t\t\t\tcontent: this.createContent.bind(this),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tthis.startButton = new SaveButton({\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_BUTTON'),\n\t\t\t\t\t\t\t\t\tonclick: this.onStart.bind(this)\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcancelButton\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tonStart()\n\t{\n\t\tthis.startButton.setWaiting();\n\n\t\tconst baseContainer = this.node.querySelector('.tasks-scrum__side-panel-start--info-basic');\n\n\t\tconst timeContainer = this.node.querySelector('.tasks-scrum__side-panel-start--timing');\n\t\tconst dateInputs = timeContainer.querySelectorAll('.ui-ctl-date');\n\n\t\tconst dateStartValue = dateInputs.item(0).querySelector('input').value;\n\t\tconst dateEndValue = dateInputs.item(1).querySelector('input').value;\n\n\t\tthis.requestSender.startSprint({\n\t\t\tgroupId: this.groupId,\n\t\t\tsprintId: this.sprintId,\n\t\t\tname: baseContainer.querySelector('input').value,\n\t\t\tsprintGoal: baseContainer.querySelector('textarea').value,\n\t\t\tdateStart: Math.floor(BX.parseDate(dateStartValue).getTime() / 1000),\n\t\t\tdateEnd: Math.floor(BX.parseDate(dateEndValue).getTime() / 1000)\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tthis.sidePanelManager.close(false, () => {\n\t\t\t\t\tthis.emit('afterStart');\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.startButton.setWaiting(false);\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\t}\n\n\tcreateContent()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getDataForSprintStartForm({\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\tsprintId: this.sprintId\n\t\t\t})\n\t\t\t\t.then((response: Response) => {\n\t\t\t\t\tresolve(this.render(response.data));\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\treject();\n\t\t\t\t\tthis.sidePanelManager.close(false, () => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\trender(sprintData: SprintData): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-start tasks-scrum__scope--side-panel-start\">\n\n\t\t\t\t<div class=\"tasks-scrum__side-panel-start--block\">\n\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-basic\">\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-basic-block\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_NAME_PLACEHOLDER')}\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"tasks-scrum__side-panel-start--info-basic-input\"\n\t\t\t\t\t\t\t\tvalue=\"${Text.encode(sprintData.name)}\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-basic-block\">\n\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_DESC_PLACEHOLDER')}\"\n\t\t\t\t\t\t\t\trows=\"7\"\n\t\t\t\t\t\t\t\tclass=\"tasks-scrum__side-panel-start--info-basic-textarea\"\n\t\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-additional\">\n\n\t\t\t\t\t\t${this.renderEpics(sprintData.epics)}\n\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-row tasks-scrum__side-panel-start--timing\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_TIME_ROW_LABEL')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-content\">\n\t\t\t\t\t\t\t\t<label class=\"tasks-scrum__side-panel-start--date\">\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--date-name\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_DATE_START_LABEL')}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-date\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-calendar\"></div>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\t\t\tvalue=\"${sprintData.dateStart}\"\n\t\t\t\t\t\t\t\t\t\t\treadonly=\"readonly\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<label class=\"tasks-scrum__side-panel-start--date\">\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--date-name\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_DATE_END_LABEL')}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-date\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-calendar\"></div>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\t\t\tvalue=\"${sprintData.dateEnd}\"\n\t\t\t\t\t\t\t\t\t\t\treadonly=\"readonly\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-row\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_PLAN_ROW_LABEL')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-content\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block\">\n\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--sprint-plans\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block-number\">\n\t\t\t\t\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tasks-scrum__side-panel-start--plan-block-number-date\" \n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"${sprintData.numberTasks}\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t${sprintData.numberTasks}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block-name\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block-name-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_TASK_COUNT_LABEL')}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--sprint-plans\">\n\t\t\t\t\t\t\t\t\t${this.renderWheelStoryPoints(sprintData)}\n\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block-name\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"tasks-scrum__side-panel-start--plan-block-name-text\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_STORY_POINTS_LABEL')}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-hint\">\n\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-hint-icon\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('TSS_START_STORY_POINTS_HINT')}\"\n\t\t\t\t\t\t\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderWarning(sprintData.numberUnevaluatedTasks)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst timeContainer = this.node.querySelector('.tasks-scrum__side-panel-start--timing');\n\t\ttimeContainer.querySelectorAll('.ui-ctl-date')\n\t\t\t.forEach((inputContainer: HTMLElement) => {\n\t\t\t\tEvent.bind(\n\t\t\t\t\tinputContainer,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.showCalendar.bind(this, inputContainer)\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\n\t\tthis.initHints(this.node);\n\n\t\treturn this.node;\n\t}\n\n\trenderEpics(epics: Array<EpicType>): ?HTMLElement\n\t{\n\t\tif (!epics.length)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__side-panel-start--info-row\">\n\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_EPICS_ROW_LABEL')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__side-panel-start--info-content\">\n\t\t\t\t\t${\n\t\t\t\t\t\tepics.map((epic: EpicType) => {\n\t\t\t\t\t\t\tconst colorBorder = this.convertHexToRGBA(epic.color, 0.7);\n\t\t\t\t\t\t\tconst colorBackground = this.convertHexToRGBA(epic.color, 0.3);\n\n\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclass=\"tasks-scrum__epic-label\"\n\t\t\t\t\t\t\t\t\tstyle=\"background: ${colorBackground}; border-color: ${colorBorder};\"\n\t\t\t\t\t\t\t\t>${Text.encode(epic.name)}</span>`\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderWarning(count: number): ?HTMLElement\n\t{\n\t\tif (count === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-alert ui-alert-icon-danger ui-alert-warning\">\n\t\t\t\t<span class=\"ui-alert-message\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_FORM_WARN_TEXT').replace('#count#', count)}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderWheelStoryPoints(sprintData: SprintData): string\n\t{\n\t\tlet numberClass = '';\n\n\t\tif (sprintData.differenceMarker)\n\t\t{\n\t\t\tconst arrowClass = sprintData.storyPoints === '' ? '' : '--arrow-up';\n\n\t\t\tnumberClass = `tasks-scrum__side-panel-start--plan-block-number ${arrowClass} --success`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst arrowClass = sprintData.storyPoints === '' ? '' : '--arrow-down';\n\n\t\t\tnumberClass = `tasks-scrum__side-panel-start--plan-block-number ${arrowClass} --warning`;\n\t\t}\n\n\t\tconst renderProgress = (differenceStoryPoints) => {\n\t\t\tif (parseInt(differenceStoryPoints, 10) === 0)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum__side-panel-start--progress\">\n\t\t\t\t\t<span class=\"tasks-scrum__side-panel-start--progress-number\">${differenceStoryPoints}</span>\n\t\t\t\t\t<span class=\"tasks-scrum__side-panel-start--progress-percent\">%</span></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${numberClass}\">\n\t\t\t<div \n\t\t\t\tclass=\"tasks-scrum__side-panel-start--plan-block-number-date\"\n\t\t\t\ttitle=\"${sprintData.storyPoints === '' ? 0 : sprintData.storyPoints}\"\n\t\t\t>\n\t\t\t\t${sprintData.storyPoints === '' ? 0 : sprintData.storyPoints}\n\t\t\t</div>\n\t\t\t${renderProgress(sprintData.differenceStoryPoints)}\n\t\t`;\n\t}\n\n\tshowCalendar(inputContainer: HTMLElement)\n\t{\n\t\t/* eslint-disable */\n\t\tnew BX.JCCalendar().Show({\n\t\t\tnode: inputContainer,\n\t\t\tfield: inputContainer.querySelector('input'),\n\t\t\tbTime: false,\n\t\t\tbSetFocus: false,\n\t\t\tbHideTime: false\n\t\t})\n\t\t/* eslint-enable */\n\t}\n\n\tconvertHexToRGBA(hexCode, opacity)\n\t{\n\t\tlet hex = hexCode.replace('#', '');\n\n\t\tif (hex.length === 3)\n\t\t{\n\t\t\thex = `${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;\n\t\t}\n\n\t\tconst r = parseInt(hex.substring(0, 2), 16);\n\t\tconst g = parseInt(hex.substring(2, 4), 16);\n\t\tconst b = parseInt(hex.substring(4, 6), 16);\n\n\t\treturn `rgba(${r},${g},${b},${opacity})`;\n\t}\n\n\tinitHints(node: HTMLElement)\n\t{\n\t\t// todo wtf hint\n\t\tBX.UI.Hint.popup = null;\n\t\tBX.UI.Hint.id = 'ui-hint-popup-' + (+new Date());\n\t\tBX.UI.Hint.init(node);\n\t}\n}"],"names":["RequestSender","controller","action","data","analyticsLabel","Promise","resolve","reject","ajax","runAction","then","sendRequest","scrum","response","alertTitle","Type","isUndefined","errors","console","error","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","SprintStartForm","params","setEventNamespace","groupId","parseInt","sprintId","sidePanelManager","BX","SidePanel","Instance","requestSender","node","startButton","open","cacheable","width","label","text","contentCallback","Layout","createContent","extensions","content","bind","design","section","buttons","cancelButton","SaveButton","onclick","onStart","setWaiting","baseContainer","querySelector","timeContainer","dateInputs","querySelectorAll","dateStartValue","item","value","dateEndValue","startSprint","name","sprintGoal","dateStart","Math","floor","parseDate","getTime","dateEnd","close","emit","showErrorAlert","getDataForSprintStartForm","render","sprintData","Tag","Text","encode","renderEpics","epics","numberTasks","renderWheelStoryPoints","renderWarning","numberUnevaluatedTasks","forEach","inputContainer","Event","showCalendar","initHints","map","epic","colorBorder","convertHexToRGBA","color","colorBackground","count","replace","numberClass","differenceMarker","arrowClass","storyPoints","renderProgress","differenceStoryPoints","JCCalendar","Show","field","bTime","bSetFocus","bHideTime","hexCode","opacity","hex","r","substring","g","b","UI","Hint","popup","id","Date","init","EventEmitter"],"mappings":"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"}