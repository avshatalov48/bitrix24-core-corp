this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,t,a,r,n){"use strict";var s,i;var o=function(){function e(t){babelHelpers.classCallCheck(this,e);this.groupId=parseInt(t.groupId,10);this.sprintId=parseInt(t.sprintId,10);this.sidePanelManager=BX.SidePanel.Instance;this.chart=null;this.sprintData=null;this.chartData=null}babelHelpers.createClass(e,[{key:"show",value:function e(){var a=this;this.sidePanelManager.open("tasks-scrum-sprint-burn-down-chart-side-panel",{cacheable:false,events:{onLoad:this.onSidePanelLoad.bind(this),onCloseComplete:this.onSidePanelAfterClose.bind(this)},contentCallback:function e(){return n.Layout.createContent({extensions:["tasks.scrum.burn-down-chart"],title:t.Loc.getMessage("TASKS_SCRUM_SPRINT_BURN_DOWN_CHART_TITLE"),content:a.createContent.bind(a),design:{section:false},buttons:[]})}})}},{key:"onSidePanelLoad",value:function e(){var a=this;setTimeout(function(){a.createChart(a.node,a.chartData);t.Dom.insertBefore(a.renderInfo(a.sprintData),a.node)},300)}},{key:"onSidePanelAfterClose",value:function e(){this.destroyChart()}},{key:"createContent",value:function e(){var a=this;return new Promise(function(e,r){t.ajax.runAction("bitrix:tasks.scrum.sprint.getBurnDownChartData",{data:{groupId:a.groupId,sprintId:a.sprintId}}).then(function(t){a.sprintData=t.data.sprint;a.chartData=t.data.chart;e(a.renderChart())})})}},{key:"renderChart",value:function e(){this.node=t.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['<div class="tasks-scrum-sprint-burn-down-chart"></div>'])));return this.node}},{key:"renderInfo",value:function e(a){return t.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="tasks-scrum-sprint-burn-down-info">\n\t\t\t\t<div class="tasks-scrum-sprint-burn-down-info-name">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),t.Text.encode(a.name))}},{key:"createChart",value:function e(t,a){window.am4core.useTheme(r);this.chart=window.am4core.create(t,am4charts.XYChart);this.chart.data=a;this.chart.paddingRight=40;this.createAxises();this.createIdealLine();this.createRemainLine();this.createLegend()}},{key:"createAxises",value:function e(){var t=this.chart.xAxes.push(new am4charts.CategoryAxis);t.renderer.grid.template.location=0;t.dataFields.category="day";t.renderer.minGridDistance=60;var a=this.chart.yAxes.push(new am4charts.ValueAxis);a.min=-.1}},{key:"createIdealLine",value:function e(){var a=this.chart.series.push(new am4charts.LineSeries);a.name=t.Loc.getMessage("TASKS_SCRUM_SPRINT_IDEAL_BURN_DOWN_CHART_LINE_LABEL");a.stroke=window.am4core.color("#2882b3");a.strokeWidth=2;a.dataFields.categoryX="day";a.dataFields.valueY="idealValue";var r="#2882b3";var n=new am4charts.CircleBullet;n.circle.radius=4;n.circle.fill=window.am4core.color(r);n.circle.stroke=window.am4core.color(r);a.bullets.push(n);var s=a.segments.template;var i=s.states.create("hover");i.properties.strokeWidth=4}},{key:"createRemainLine",value:function e(){var a=this.chart.series.push(new am4charts.LineSeries);a.name=t.Loc.getMessage("TASKS_SCRUM_SPRINT_REMAIN_BURN_DOWN_CHART_LINE_LABEL");a.stroke=window.am4core.color("#9c1f1f");a.strokeWidth=2;a.dataFields.categoryX="day";a.dataFields.valueY="remainValue";var r="#9c1f1f";var n=new am4charts.CircleBullet;n.circle.radius=4;n.circle.fill=window.am4core.color(r);n.circle.stroke=window.am4core.color(r);a.bullets.push(n);var s=a.segments.template;var i=s.states.create("hover");i.properties.strokeWidth=4}},{key:"createLegend",value:function e(){var t=this;this.chart.legend=new am4charts.Legend;this.chart.legend.itemContainers.template.clickable=false;this.chart.legend.position="bottom";this.chart.legend.itemContainers.template.events.on("over",function(e){t.processOver(e.target.dataItem.dataContext)});this.chart.legend.itemContainers.template.events.on("out",function(){return t.processOut()})}},{key:"processOver",value:function e(t){t.toFront();t.segments.each(function(e){return e.setState("hover")})}},{key:"processOut",value:function e(){this.chart.series.each(function(e){e.segments.each(function(e){return e.setState("default")});e.bulletsContainer.setState("default")})}},{key:"destroyChart",value:function e(){if(this.chart){this.chart.dispose()}}}]);return e}();e.BurnDownChart=o})(this.BX.Tasks.Scrum=this.BX.Tasks.Scrum||{},BX,BX,BX,BX.UI.SidePanel);
//# sourceMappingURL=burn.down.chart.bundle.map.js