this.BX=this.BX||{};(function(e,t,a,n){"use strict";var s=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"create",value:function e(){return{tabId:c.MENU_ID,delimiter:true}}}]);return e}();var r=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"create",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";return{tabId:c.MENU_ID,text:n.Loc.getMessage("TASKS_CREATION_MENU_CREATE_TASK"),href:t,onclick:function e(t,a){a.getMenuWindow().close()}}}}]);return e}();var l=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"create",value:function t(){return{id:e.ID,text:n.Loc.getMessage("TASKS_CREATION_MENU_LOAD_TEMPLATE_LIST")}}}]);return e}();babelHelpers.defineProperty(l,"ID","loading");var i=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,[{key:"getTemplates",value:function e(){return n.ajax.runComponentAction("bitrix:tasks.templates.list","getList",{mode:"class",data:{select:["ID","TITLE"],order:{ID:"DESC"},filter:{ZOMBIE:"N"}}})}},{key:"addSubItems",value:function e(t,a,s){if(a.data.length>0){a.data.forEach((function(e){t.getSubMenu().addMenuItem({text:BX.util.htmlspecialchars(e.TITLE),href:s+"&TEMPLATE="+e.ID,onclick:function e(){t.getMenuWindow().close()}})}))}else{t.getSubMenu().addMenuItem({text:n.Loc.getMessage("TASKS_CREATION_MENU_EMPTY_TEMPLATE_LIST")})}this.removeLoading(t)}},{key:"addError",value:function e(t){t.getSubMenu().addMenuItem({text:n.Loc.getMessage("TASKS_CREATION_MENU_ERROR_LOAD_TEMPLATE_LIST")});this.removeLoading(t)}},{key:"removeLoading",value:function e(t){t.getSubMenu().removeMenuItem(l.ID)}}],[{key:"create",value:function t(){var a=this;var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";return{tabId:c.MENU_ID,text:n.Loc.getMessage("TASKS_CREATION_MENU_CREATE_TASK_BY_TEMPLATE"),cacheable:true,items:[l.create()],events:{onSubMenuShow:function t(n){var r=new e;r.getTemplates().then((function(e){if(a.isTemplateListLoaded){return}a.isTemplateListLoaded=true;r.addSubItems(n.getTarget(),e,s)}),(function(){a.isTemplateListLoaded=true;r.addError(n.getTarget())}))}}}}}]);return e}();var u=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"create",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";return{tabId:c.MENU_ID,text:n.Loc.getMessage("TASKS_CREATION_MENU_TEMPLATE_LIST"),href:t,target:"_top"}}}]);return e}();var c=function(){babelHelpers.createClass(e,null,[{key:"toggle",value:function a(n){var s=t.MenuManager.getMenuById(e.MENU_ID);if(s){s.toggle()}else{new this(n).createMenu().toggle()}}}]);function e(t){babelHelpers.classCallCheck(this,e);this.bindElement=t.bindElement;this.createTaskLink=t.createTaskLink;this.templatesListLink=t.templatesListLink}babelHelpers.createClass(e,[{key:"createMenu",value:function a(){this.menu=t.MenuManager.create({id:e.MENU_ID,bindElement:this.bindElement,closeByEsc:true,items:this.getCreationItems()});return this.menu}},{key:"getCreationItems",value:function e(){var t=n.Uri.addParam(this.createTaskLink,{ta_sec:"space",ta_el:"create_button"});return[r.create(t),i.create(t),s.create(),u.create(this.templatesListLink)]}}]);return e}();babelHelpers.defineProperty(c,"MENU_ID","tasks-creation-menu");e.CreationMenu=c})(this.BX.Tasks=this.BX.Tasks||{},BX.Main,BX.UI.Analytics,BX);
//# sourceMappingURL=creation-menu.bundle.map.js