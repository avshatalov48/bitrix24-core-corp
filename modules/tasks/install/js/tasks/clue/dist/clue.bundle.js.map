{"version":3,"file":"clue.bundle.js","sources":["../src/spot/spot.js","../src/spot/flow-copilot-advice.js","../src/spot/my-tasks.js","../src/spot/task-start.js","../src/clue.js"],"sourcesContent":["import 'spotlight';\n\nexport class Spot\n{\n\tstatic WIDTH = 380;\n\tstatic PATH_TO_IMAGES = '/bitrix/js/tasks/clue/images/spot/';\n\n\t#targetElement: HTMLElement;\n\t#spotlight: ?BX.SpotLight = null;\n\n\tconstructor()\n\t{\n\t\tif (new.target === Spot)\n\t\t{\n\t\t\tthrow new Error('This class is abstract and cannot be instantiated directly');\n\t\t}\n\t}\n\n\tgetWidth(): number\n\t{\n\t\treturn Spot.WIDTH;\n\t}\n\n\tgetAngleOffset(): number\n\t{\n\t\treturn this.#targetElement.offsetWidth / 2;\n\t}\n\n\tisAutoHide(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tsetTargetElement(targetElement: HTMLElement): void\n\t{\n\t\tthis.#targetElement = targetElement;\n\t}\n\n\tshowLight(): void\n\t{\n\t\tthis.#spotlight = new BX.SpotLight(\n\t\t\t{\n\t\t\t\ttargetElement: this.#targetElement,\n\t\t\t\ttargetVertex: 'middle-center',\n\t\t\t\tcolor: this.getSpotlightColor(),\n\t\t\t},\n\t\t);\n\n\t\tthis.#spotlight.show();\n\t}\n\n\tclose()\n\t{\n\t\tthis.#spotlight.close();\n\t}\n\n\tgetIconSrc(): ?string\n\t{\n\t\treturn null;\n\t}\n\n\tgetSpotlightColor(): ?string\n\t{\n\t\treturn null;\n\t}\n\n\tgetConditionColor(): string\n\t{\n\t\treturn 'primary';\n\t}\n\n\tgetTitle(): string {}\n\n\tgetText(): string {}\n}\n","import { Loc } from 'main.core';\nimport { Spot } from './spot';\n\nexport class FlowCopilotAdvice extends Spot\n{\n\tgetWidth(): number\n\t{\n\t\treturn 340;\n\t}\n\n\tgetIconSrc(): ?string\n\t{\n\t\treturn null;\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_CLUE_FLASH_COPILOT_ADVICE_TITLE');\n\t}\n\n\tgetText(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_CLUE_FLASH_COPILOT_ADVICE_TEXT');\n\t}\n\n\tgetSpotlightColor(): ?string\n\t{\n\t\treturn '#8e52ec';\n\t}\n\n\tgetConditionColor(): string\n\t{\n\t\treturn 'copilot';\n\t}\n}\n","import { Loc } from 'main.core';\nimport { Spot } from './spot';\n\nexport class MyTasks extends Spot\n{\n\tgetIconSrc(): string\n\t{\n\t\treturn `${Spot.PATH_TO_IMAGES}my-tasks.svg`;\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_CLUE_FLASH_MY_TASKS_TITLE');\n\t}\n\n\tgetText(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_CLUE_FLASH_MY_TASKS_TEXT');\n\t}\n}\n","import { Loc } from 'main.core';\nimport { Spot } from './spot';\n\nexport class TaskStart extends Spot\n{\n\tgetIconSrc(): string\n\t{\n\t\treturn `${Spot.PATH_TO_IMAGES}task-start.svg`;\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_CLUE_FLASH_TASK_START_TITLE');\n\t}\n\n\tgetText(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_CLUE_FLASH_TASK_START_TEXT');\n\t}\n}\n","import { Guide } from 'ui.tour';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\nimport { FlowCopilotAdvice } from './spot/flow-copilot-advice';\n\nimport { Spot } from './spot/spot';\nimport { MyTasks } from './spot/my-tasks';\nimport { TaskStart } from './spot/task-start';\n\ntype Params = {\n\tid: number,\n\tautoSave: boolean,\n\toverlay: boolean,\n};\n\nexport class Clue\n{\n\tstatic SPOT = Object.freeze({\n\t\tMY_TASKS: new MyTasks(),\n\t\tTASK_START: new TaskStart(),\n\t\tFLOW_COPILOT_ADVICE: new FlowCopilotAdvice(),\n\t});\n\n\t#params: Params;\n\n\t#spot: ?Spot = null;\n\t#guide: ?Guide = null;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\t}\n\n\tshow(spot: Spot, bindElement: HTMLElement): void\n\t{\n\t\tthis.#spot = spot;\n\t\tthis.#spot.setTargetElement(bindElement);\n\n\t\tthis.#guide = new Guide({\n\t\t\tid: this.#params.id,\n\t\t\tautoSave: this.#params.autoSave === true,\n\t\t\toverlay: this.#params.overlay === true,\n\t\t\tsimpleMode: true,\n\t\t\tonEvents: true,\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: bindElement,\n\t\t\t\t\ticonSrc: this.#spot.getIconSrc(),\n\t\t\t\t\ttitle: this.#spot.getTitle(),\n\t\t\t\t\ttext: this.#spot.getText(),\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: this.#spot.getConditionColor(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\tBannerDispatcher.normal.toQueue((onDone) => {\n\t\t\tconst guidePopup = this.#guide.getPopup();\n\n\t\t\tconst onClose = () => {\n\t\t\t\tthis.#spot.close();\n\t\t\t\tonDone();\n\t\t\t};\n\n\t\t\tguidePopup.setWidth(this.#spot.getWidth());\n\t\t\tguidePopup.setAngle({ offset: this.#spot.getAngleOffset() });\n\t\t\tguidePopup.setAutoHide(this.#spot.isAutoHide());\n\n\t\t\tguidePopup.subscribe('onClose', onClose);\n\t\t\tguidePopup.subscribe('onDestroy', onClose);\n\n\t\t\tthis.#spot.showLight();\n\t\t\tthis.#guide.start();\n\t\t});\n\t}\n\n\tisShown(): boolean\n\t{\n\t\tif (this.#guide === null)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.#guide.getPopup().isShown();\n\t}\n\n\tclose(): void\n\t{\n\t\tif (this.#guide)\n\t\t{\n\t\t\tthis.#guide.close();\n\t\t}\n\n\t\tif (this.#spot)\n\t\t{\n\t\t\tthis.#spot.close();\n\t\t}\n\t}\n\n\tadjustPosition(bindElement: HTMLElement): void\n\t{\n\t\tif (this.#guide)\n\t\t{\n\t\t\tthis.#guide.getPopup().setBindElement(bindElement);\n\t\t\tthis.#guide.getPopup().adjustPosition();\n\t\t}\n\n\t\tif (this.#spot)\n\t\t{\n\t\t\tthis.#spot.setTargetElement(bindElement);\n\t\t\tthis.#spot.showLight();\n\t\t}\n\t}\n}\n"],"names":["Spot","constructor","new","target","Error","getWidth","WIDTH","getAngleOffset","offsetWidth","isAutoHide","setTargetElement","targetElement","showLight","BX","SpotLight","targetVertex","color","getSpotlightColor","show","close","getIconSrc","getConditionColor","getTitle","getText","PATH_TO_IMAGES","FlowCopilotAdvice","Loc","getMessage","MyTasks","TaskStart","Clue","params","spot","bindElement","Guide","id","autoSave","overlay","simpleMode","onEvents","steps","iconSrc","title","text","position","condition","top","bottom","BannerDispatcher","normal","toQueue","onDone","guidePopup","getPopup","onClose","setWidth","setAngle","offset","setAutoHide","subscribe","start","isShown","adjustPosition","setBindElement","SPOT","Object","freeze","MY_TASKS","TASK_START","FLOW_COPILOT_ADVICE"],"mappings":"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"}