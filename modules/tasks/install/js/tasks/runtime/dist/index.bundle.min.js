this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,s,t){"use strict";var a=babelHelpers.classPrivateFieldLooseKey("items");class i{constructor(){Object.defineProperty(this,a,{writable:true,value:[]})}add(e,s){babelHelpers.classPrivateFieldLooseBase(this,a)[a].push({[e]:{fields:s}})}getItems(){return babelHelpers.classPrivateFieldLooseBase(this,a)[a]}clean(){babelHelpers.classPrivateFieldLooseBase(this,a)[a]=[]}count(){return babelHelpers.classPrivateFieldLooseBase(this,a)[a].length}isEmpty(){return babelHelpers.classPrivateFieldLooseBase(this,a)[a].length===0}}const l=Object.freeze({RUN:"run",NONE:"none"});var r=babelHelpers.classPrivateFieldLooseKey("status");var o=babelHelpers.classPrivateFieldLooseKey("timeout");var b=babelHelpers.classPrivateFieldLooseKey("pool");var c=babelHelpers.classPrivateFieldLooseKey("debounce");class n extends s.EventEmitter{constructor(e={}){var s;super();Object.defineProperty(this,r,{writable:true,value:l.NONE});Object.defineProperty(this,o,{writable:true,value:0});Object.defineProperty(this,b,{writable:true,value:new i});Object.defineProperty(this,c,{writable:true,value:null});this.setEventNamespace("BX.Tasks.DebounceQueue");e=t.Type.isPlainObject(e)?e:{};this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,o)[o]=(s=e.timeout)!=null?s:1e3;babelHelpers.classPrivateFieldLooseBase(this,c)[c]=t.Runtime.debounce((()=>{babelHelpers.classPrivateFieldLooseBase(this,r)[r]=l.RUN;this.commit().then((()=>babelHelpers.classPrivateFieldLooseBase(this,r)[r]=l.NONE))}),babelHelpers.classPrivateFieldLooseBase(this,o)[o])}push(e,s="default"){babelHelpers.classPrivateFieldLooseBase(this,b)[b].add(s,e);this.commitWithDebounce()}commit(){return new Promise(((e,s)=>{if(babelHelpers.classPrivateFieldLooseBase(this,b)[b].isEmpty()===false){const s=babelHelpers.classPrivateFieldLooseBase(this,b)[b].getItems();babelHelpers.classPrivateFieldLooseBase(this,b)[b].clean();this.emitAsync("onCommitAsync",{poolItems:s}).then((()=>this.commit().then((()=>e())))).catch()}else{e()}}))}commitWithDebounce(){if(babelHelpers.classPrivateFieldLooseBase(this,r)[r]===l.NONE){babelHelpers.classPrivateFieldLooseBase(this,c)[c]()}}}e.Pool=i;e.DebouncedQueue=n;e.Status=l})(this.BX.Tasks.Runtime=this.BX.Tasks.Runtime||{},BX.Event,BX);
//# sourceMappingURL=index.bundle.map.js