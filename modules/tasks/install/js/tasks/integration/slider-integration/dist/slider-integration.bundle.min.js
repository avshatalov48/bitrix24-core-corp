this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,s,i){"use strict";var t=babelHelpers.classPrivateFieldLooseKey("popup");var l=babelHelpers.classPrivateFieldLooseKey("sliders");var a=babelHelpers.classPrivateFieldLooseKey("frozen");var r=babelHelpers.classPrivateFieldLooseKey("frozenProps");class o{constructor(e){Object.defineProperty(this,t,{writable:true,value:void 0});Object.defineProperty(this,l,{writable:true,value:new Set});Object.defineProperty(this,a,{writable:true,value:false});Object.defineProperty(this,r,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,t)[t]=e;babelHelpers.classPrivateFieldLooseBase(this,t)[t].subscribe("onShow",this.handlePopupShow.bind(this));babelHelpers.classPrivateFieldLooseBase(this,t)[t].subscribe("onClose",this.handlePopupClose.bind(this));babelHelpers.classPrivateFieldLooseBase(this,t)[t].subscribe("onDestroy",this.handlePopupClose.bind(this));this.handleSliderOpen=this.handleSliderOpen.bind(this);this.handleSliderClose=this.handleSliderClose.bind(this);this.handleSliderDestroy=this.handleSliderDestroy.bind(this)}handlePopupShow(){this.bindEvents()}handlePopupClose(){babelHelpers.classPrivateFieldLooseBase(this,l)[l].clear();this.unbindEvents();this.unfreeze()}bindEvents(){this.unbindEvents();if(top.BX){top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onOpen",this.handleSliderOpen);top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onCloseComplete",this.handleSliderClose);top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onDestroy",this.handleSliderDestroy)}}unbindEvents(){if(top.BX){top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onOpen",this.handleSliderOpen);top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onCloseComplete",this.handleSliderClose);top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onDestroy",this.handleSliderDestroy)}}handleSliderOpen(e){const[s]=e.getData();const i=s.getSlider();if(!this.isPopupInSlider(i)){babelHelpers.classPrivateFieldLooseBase(this,l)[l].add(i);this.freeze()}}handleSliderClose(e){const[s]=e.getData();const i=s.getSlider();babelHelpers.classPrivateFieldLooseBase(this,l)[l].delete(i);if(babelHelpers.classPrivateFieldLooseBase(this,l)[l].size===0){this.unfreeze()}}handleSliderDestroy(e){const[s]=e.getData();const i=s.getSlider();if(this.isPopupInSlider(i)){this.unbindEvents();babelHelpers.classPrivateFieldLooseBase(this,t)[t].destroy()}else{babelHelpers.classPrivateFieldLooseBase(this,l)[l].delete(i);if(babelHelpers.classPrivateFieldLooseBase(this,l)[l].size===0){this.unfreeze()}}}isPopupInSlider(e){if(e.getFrameWindow()){return e.getFrameWindow().document.contains(babelHelpers.classPrivateFieldLooseBase(this,t)[t].getPopupContainer())}else{return e.getContainer().contains(babelHelpers.classPrivateFieldLooseBase(this,t)[t].getPopupContainer())}}freeze(){if(babelHelpers.classPrivateFieldLooseBase(this,a)[a]){return}babelHelpers.classPrivateFieldLooseBase(this,r)[r]={autoHide:babelHelpers.classPrivateFieldLooseBase(this,t)[t].autoHide,closeByEsc:babelHelpers.classPrivateFieldLooseBase(this,t)[t].closeByEsc};babelHelpers.classPrivateFieldLooseBase(this,t)[t].setAutoHide(false);babelHelpers.classPrivateFieldLooseBase(this,t)[t].setClosingByEsc(false);s.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,t)[t].getPopupContainer(),"pointer-events","none");babelHelpers.classPrivateFieldLooseBase(this,a)[a]=true}unfreeze(){if(!babelHelpers.classPrivateFieldLooseBase(this,a)[a]){return}babelHelpers.classPrivateFieldLooseBase(this,t)[t].setAutoHide(babelHelpers.classPrivateFieldLooseBase(this,r)[r].autoHide!==false);babelHelpers.classPrivateFieldLooseBase(this,t)[t].setClosingByEsc(babelHelpers.classPrivateFieldLooseBase(this,r)[r].closeByEsc!==false);s.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,t)[t].getPopupContainer(),"pointer-events","");babelHelpers.classPrivateFieldLooseBase(this,a)[a]=false}}e.SliderIntegration=o})(this.BX.Tasks.Integration=this.BX.Tasks.Integration||{},BX,BX.Main);
//# sourceMappingURL=slider-integration.bundle.map.js