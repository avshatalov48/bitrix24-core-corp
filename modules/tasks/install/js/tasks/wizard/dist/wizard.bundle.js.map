{"version":3,"file":"wizard.bundle.js","sources":["../src/wizard.js"],"sourcesContent":["import { Dom, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Button, ButtonState } from 'ui.buttons';\nimport 'main.polyfill.intersectionobserver';\nimport 'ui.icon-set.main';\nimport './style.css';\n\ntype Step = {\n\tid: string,\n\ttitle: string,\n\tcontent: HTMLElement,\n\tselected: ?boolean,\n\tisFilled: ?Function,\n\ttitleNode: ?HTMLElement,\n\tnode: ?HTMLElement,\n\tfadeTop: ?HTMLElement,\n\tfadeBottom: ?HTMLElement,\n\thintManager?: BX.UI.Hint.Manager,\n};\n\ntype Params = {\n\tsteps: Step[],\n\tonCancel: Function,\n\tfinishButton: Button,\n\tsaveChangesButton: ?Button,\n\tarticle: ?number,\n\tonDisabledContinueButtonClick: ?Function,\n\tonContinueHandler: ?Function,\n};\n\nexport class Wizard\n{\n\t#params: Params;\n\t#layout: {\n\t\tbackButton: Button,\n\t\tcancelButton: Button,\n\t\tcontinueButton: Button,\n\t\tfinishButton: Button,\n\t\tsaveChangesButton: Button,\n\t};\n\n\t#steps: Step[];\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\t\tthis.#steps = params.steps;\n\t\tthis.#layout = {};\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst wrap = Tag.render`\n\t\t\t<div class=\"tasks-wizard__container tasks-wizard__scope\">\n\t\t\t\t${this.#renderStepHeader(this.#steps)}\n\t\t\t\t${this.#renderStepContainer(this.#steps)}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#openStep(this.#steps[0]);\n\n\t\treturn wrap;\n\t}\n\n\tgetCurrentStep(): Step\n\t{\n\t\treturn this.#steps[this.#getCurrentStepIndex()];\n\t}\n\n\tupdate(): void\n\t{\n\t\tthis.#updateStepsAvailability();\n\t}\n\n\tinitHints(): void\n\t{\n\t\tthis.#steps.forEach((step: Step) => {\n\t\t\tstep.hintManager = top.BX.UI.Hint.createInstance({\n\t\t\t\tid: `tasks-flow-edit-form-${step.id}-${Text.getRandom()}`,\n\t\t\t\tclassName: 'skipInitByClassName',\n\t\t\t\tpopupParameters: {\n\t\t\t\t\ttargetContainer: step.node,\n\t\t\t\t},\n\t\t\t});\n\t\t\tstep.hintManager.init(step.node);\n\t\t});\n\t}\n\n\thideHints(): void\n\t{\n\t\tthis.#steps.forEach((step: Step) => {\n\t\t\tstep.hintManager?.hide();\n\t\t});\n\t}\n\n\t#getPreviousStep(): Step\n\t{\n\t\treturn this.#steps[this.#getCurrentStepIndex() - 1];\n\t}\n\n\t#updateStepsAvailability(): void\n\t{\n\t\tlet isAvailable = true;\n\n\t\tfor (const step of this.#steps)\n\t\t{\n\t\t\tif (isAvailable)\n\t\t\t{\n\t\t\t\tDom.removeClass(step.titleNode, '--unavailable');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(step.titleNode, '--unavailable');\n\t\t\t}\n\n\t\t\tconst isStepUnavailable = Type.isFunction(step.isFilled) && !step.isFilled();\n\t\t\tisAvailable = isAvailable && !isStepUnavailable;\n\n\t\t\tif (step.selected)\n\t\t\t{\n\t\t\t\tthis.#layout.continueButton.setState(isAvailable ? null : ButtonState.DISABLED);\n\t\t\t}\n\t\t}\n\n\t\tthis.#layout.finishButton.setState(isAvailable ? null : ButtonState.DISABLED);\n\n\t\tif (this.#layout.saveChangesButton)\n\t\t{\n\t\t\tthis.#layout.saveChangesButton.setState(isAvailable ? null : ButtonState.DISABLED);\n\t\t}\n\t}\n\n\t#getCurrentStepIndex(): number\n\t{\n\t\tfor (const [index, step] of this.#steps.entries())\n\t\t{\n\t\t\tif (step.selected)\n\t\t\t{\n\t\t\t\treturn index;\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t#renderStepHeader(steps: Step[]): HTMLElement\n\t{\n\t\tconst firstSteps = steps.slice(0, -1);\n\t\tconst lastStep = steps.slice(-1)[0];\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-wizard__step_header\">\n\t\t\t\t${firstSteps.map((step: Step) => this.#renderStepTitle(step, false))}\n\t\t\t\t${this.#renderStepTitle(lastStep, true)}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderStepTitle(step: Step, isLast: boolean): HTMLElement\n\t{\n\t\tconst arrow = isLast ? null : Tag.render`\n\t\t\t<div class=\"ui-icon-set --chevron-right\" style=\"--ui-icon-set__icon-size: 15px;\"></div>\n\t\t`;\n\n\t\tstep.titleNode = Tag.render`\n\t\t\t<span\n\t\t\t\tclass=\"tasks-wizard__step_name ${step.selected ? '--selected' : ''}\"\n\t\t\t\tdata-id=\"tasks-wizard-step-${step.id}\"\n\t\t\t>${step.title}</span>\n\t\t`;\n\n\t\tEvent.bind(step.titleNode, 'click', () => this.#openStep(step));\n\n\t\treturn Tag.render`\n\t\t\t<span class=\"tasks-wizard__step_name-container\">\n\t\t\t\t${step.titleNode}\n\t\t\t\t${arrow}\n\t\t\t</span>\n\t\t`;\n\t}\n\n\t#renderStepContainer(steps: Step[]): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-wizard__step_container\">\n\t\t\t\t${steps.map((step: Step) => this.#renderStep(step))}\n\t\t\t\t${this.#renderButtonsContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderButtonsContainer(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-wizard__step_buttons-container\">\n\t\t\t\t${this.#renderBackButton()}\n\t\t\t\t${this.#renderCancelButton()}\n\t\t\t\t${this.#renderContinueButton()}\n\t\t\t\t${this.#renderFinishButton()}\n\t\t\t\t${this.#renderSaveChangesButton()}\n\t\t\t\t${this.#renderArticle()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderArticle(): HTMLElement | string\n\t{\n\t\tif (!Type.isNumber(this.#params.article))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst article = Tag.render`\n\t\t\t<div class=\"tasks-wizard__article\">\n\t\t\t\t<span class=\"ui-icon-set --help\"></span>\n\t\t\t\t${Loc.getMessage('TASKS_WIZARD_HELP')}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(article, 'click', this.#openHelpDesk.bind(this));\n\n\t\treturn article;\n\t}\n\n\t#openHelpDesk(): void\n\t{\n\t\ttop.BX.Helper.show(`redirect=detail&code=${this.#params.article}`);\n\t}\n\n\t#renderStep(step: Step): HTMLElement\n\t{\n\t\tconst fadeTop = Tag.render`\n\t\t\t<div class=\"tasks-wizard__step_fade --top\"></div>\n\t\t`;\n\n\t\tconst fadeBottom = Tag.render`\n\t\t\t<div class=\"tasks-wizard__step_fade\"></div>\n\t\t`;\n\n\t\tstep.node = Tag.render`\n\t\t\t<div class=\"tasks-wizard__step ${step.selected ? '--selected' : ''}\">\n\t\t\t\t${fadeTop}\n\t\t\t\t${step.content}\n\t\t\t\t${fadeBottom}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst observer = new IntersectionObserver(() => {\n\t\t\tif (step.node.offsetWidth > 0)\n\t\t\t{\n\t\t\t\tthis.#updateFade(step.node, fadeTop, fadeBottom);\n\n\t\t\t\tobserver.disconnect();\n\t\t\t}\n\t\t});\n\t\tobserver.observe(step.node);\n\n\t\tEvent.bind(step.node, 'scroll', () => this.#updateFade(step.node, fadeTop, fadeBottom));\n\n\t\tthis.#subscribeToPopupInit(step.node);\n\n\t\treturn step.node;\n\t}\n\n\t#subscribeToPopupInit(stepContainer: HTMLElement): void\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Popup:onInit', (event) => {\n\t\t\tconst data = event.getCompatData();\n\n\t\t\tconst bindElement = data[1];\n\t\t\tconst params = data[2];\n\n\t\t\tif (\n\t\t\t\tType.isDomNode(bindElement)\n\t\t\t\t&& stepContainer.contains(bindElement)\n\t\t\t)\n\t\t\t{\n\t\t\t\tparams.targetContainer = stepContainer;\n\t\t\t}\n\t\t});\n\t}\n\n\t#updateFade(container, fadeTop, fadeBottom): void\n\t{\n\t\tconst scrollTop = container.scrollTop;\n\t\tconst maxScroll = container.scrollHeight - container.offsetHeight;\n\t\tconst scrolledToBottom = Math.abs(scrollTop - maxScroll) < 1;\n\n\t\tif (scrollTop === 0)\n\t\t{\n\t\t\tDom.removeClass(fadeTop, '--show');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(fadeTop, '--show');\n\t\t}\n\n\t\tif (scrolledToBottom)\n\t\t{\n\t\t\tDom.removeClass(fadeBottom, '--show');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(fadeBottom, '--show');\n\t\t}\n\t}\n\n\t#renderBackButton(): HTMLElement\n\t{\n\t\tthis.#layout.backButton = new Button({\n\t\t\ttext: Loc.getMessage('TASKS_FLOW_EDIT_FORM_BACK'),\n\t\t\tcolor: Button.Color.LIGHT_BORDER,\n\t\t\tround: true,\n\t\t\tsize: BX.UI.Button.Size.LARGE,\n\t\t\tonclick: () => {\n\t\t\t\tthis.#openStep(this.#getPreviousStep());\n\t\t\t},\n\t\t});\n\n\t\tthis.#layout.backButton.setDataSet({\n\t\t\tid: 'tasks-wizard-flow-back',\n\t\t});\n\n\t\treturn this.#layout.backButton.render();\n\t}\n\n\t#renderCancelButton(): HTMLElement\n\t{\n\t\tthis.#layout.cancelButton = new Button({\n\t\t\ttext: Loc.getMessage('TASKS_FLOW_EDIT_FORM_CANCEL'),\n\t\t\tcolor: Button.Color.LIGHT_BORDER,\n\t\t\tround: true,\n\t\t\tsize: BX.UI.Button.Size.LARGE,\n\t\t\tonclick: () => this.#params.onCancel(),\n\t\t});\n\n\t\tthis.#layout.cancelButton.setDataSet({\n\t\t\tid: 'tasks-wizard-flow-cancel',\n\t\t});\n\n\t\treturn this.#layout.cancelButton.render();\n\t}\n\n\t#renderContinueButton(): HTMLElement\n\t{\n\t\tthis.#layout.continueButton = new Button({\n\t\t\ttext: Loc.getMessage('TASKS_FLOW_EDIT_FORM_CONTINUE'),\n\t\t\tcolor: Button.Color.LIGHT_BORDER,\n\t\t\tround: true,\n\t\t\tsize: BX.UI.Button.Size.LARGE,\n\t\t\tonclick: this.#onContinueButtonClickHandler.bind(this),\n\t\t});\n\n\t\tthis.#layout.continueButton.setDataSet({\n\t\t\tid: 'tasks-wizard-flow-continue',\n\t\t});\n\n\t\treturn this.#layout.continueButton.render();\n\t}\n\n\tasync #onContinueButtonClickHandler(): void\n\t{\n\t\tif (this.#layout.continueButton.getState() === ButtonState.DISABLED)\n\t\t{\n\t\t\tthis.#params.onDisabledContinueButtonClick?.();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isFunction(this.#params.onContinueHandler) && this.#layout.continueButton.getState() === null)\n\t\t{\n\t\t\tconst canContinue = await this.#params.onContinueHandler();\n\t\t\tif (!canContinue)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst currentStep = this.#getCurrentStepIndex();\n\t\tconst nextStep = currentStep + 1;\n\n\t\tthis.#openStep(this.#steps[nextStep]);\n\t}\n\n\t#renderFinishButton(): HTMLElement\n\t{\n\t\tthis.#layout.finishButton = this.#params.finishButton;\n\n\t\tthis.#layout.finishButton?.setDataSet({\n\t\t\tid: 'tasks-wizard-flow-finish',\n\t\t});\n\n\t\treturn this.#layout.finishButton.render();\n\t}\n\n\t#renderSaveChangesButton(): ?HTMLElement\n\t{\n\t\tthis.#layout.saveChangesButton = this.#params.saveChangesButton;\n\n\t\tthis.#layout.saveChangesButton?.setDataSet({\n\t\t\tid: 'tasks-wizard-flow-save',\n\t\t});\n\n\t\treturn this.#layout.saveChangesButton?.render();\n\t}\n\n\t#openStep(currentStep: Step): void\n\t{\n\t\tconst index = this.#steps.findIndex((step: Step) => step.id === currentStep.id);\n\n\t\tthis.#steps.forEach((step: Step) => {\n\t\t\tstep.selected = false;\n\t\t\tDom.removeClass(step.titleNode, '--selected');\n\t\t\tDom.removeClass(step.node, '--selected');\n\t\t});\n\n\t\tcurrentStep.selected = true;\n\t\tDom.addClass(currentStep.titleNode, '--selected');\n\t\tDom.addClass(currentStep.node, '--selected');\n\n\t\tDom.style(this.#layout.finishButton.getContainer(), 'display', 'none');\n\t\tDom.style(this.#layout.continueButton.getContainer(), 'display', '');\n\n\t\tif (this.#layout.saveChangesButton)\n\t\t{\n\t\t\tDom.style(this.#layout.saveChangesButton.getContainer(), 'display', '');\n\t\t}\n\n\t\tif (index === this.#steps.length - 1)\n\t\t{\n\t\t\tDom.style(this.#layout.finishButton.getContainer(), 'display', '');\n\t\t\tDom.style(this.#layout.continueButton.getContainer(), 'display', 'none');\n\n\t\t\tif (this.#layout.saveChangesButton)\n\t\t\t{\n\t\t\t\tDom.style(this.#layout.saveChangesButton.getContainer(), 'display', 'none');\n\t\t\t}\n\t\t}\n\n\t\tif (index > 0)\n\t\t{\n\t\t\tDom.style(this.#layout.backButton.getContainer(), 'display', '');\n\t\t\tDom.style(this.#layout.cancelButton.getContainer(), 'display', 'none');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.#layout.backButton.getContainer(), 'display', 'none');\n\t\t\tDom.style(this.#layout.cancelButton.getContainer(), 'display', '');\n\t\t}\n\n\t\tthis.#updateStepsAvailability();\n\t}\n}\n"],"names":["Wizard","constructor","params","steps","render","wrap","Tag","getCurrentStep","update","initHints","forEach","step","hintManager","top","BX","UI","Hint","createInstance","id","Text","getRandom","className","popupParameters","targetContainer","node","init","hideHints","hide","isAvailable","Dom","removeClass","titleNode","addClass","isStepUnavailable","Type","isFunction","isFilled","selected","continueButton","setState","ButtonState","DISABLED","finishButton","saveChangesButton","index","entries","firstSteps","slice","lastStep","map","isLast","arrow","title","Event","bind","isNumber","article","Loc","getMessage","Helper","show","fadeTop","fadeBottom","content","observer","IntersectionObserver","offsetWidth","disconnect","observe","stepContainer","EventEmitter","subscribe","event","data","getCompatData","bindElement","isDomNode","contains","container","scrollTop","maxScroll","scrollHeight","offsetHeight","scrolledToBottom","Math","abs","backButton","Button","text","color","Color","LIGHT_BORDER","round","size","Size","LARGE","onclick","setDataSet","cancelButton","onCancel","getState","onDisabledContinueButtonClick","onContinueHandler","canContinue","currentStep","nextStep","findIndex","style","getContainer","length"],"mappings":"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"}