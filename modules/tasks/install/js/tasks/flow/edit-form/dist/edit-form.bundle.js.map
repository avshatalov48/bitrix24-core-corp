{"version":3,"file":"edit-form.bundle.js","sources":["../src/pages/form-page.js","../src/value-checker.js","../src/bind-filter-number-input.js","../src/pages/about-page.js","../src/pull-requests.js","../src/pages/settings-page.js","../src/pages/control-page.js","../src/edit-form.js"],"sourcesContent":["import type { Flow } from '../edit-form';\n\nexport class FormPage\n{\n\tgetId(): string {}\n\tgetTitle(): string {}\n\tsetFlow(flow: Flow): void {}\n\trender(): HTMLElement {}\n\tgetFields(flowData: Flow): any {}\n\tgetRequiredData(): string[] { return []; }\n\tupdate(): void { this.cleanErrors(); }\n\tcleanErrors(): void {}\n\tshowErrors(incorrectData: string[]): void {}\n\tonContinueClick(flowData: Flow = {}): Promise<boolean> {\n\t\treturn Promise.resolve(true);\n\t}\n}\n","import { Dom, Event, Loc, Tag } from 'main.core';\nimport { Dialog } from 'ui.entity-selector';\nimport { Checker } from 'ui.form-elements.view';\n\ntype Params = {\n\tid: string,\n\ttitle: string,\n\tplaceholder: ?string,\n\tvalue: ?string,\n\tentitySelector: ?Dialog,\n\tunit: ?string,\n\tsize: ?string,\n};\n\nexport class ValueChecker\n{\n\t#params: Params;\n\n\t#layout: {\n\t\twrap: HTMLElement,\n\t\tchecker: Checker,\n\t\tcheckerValue: ?HTMLInputElement,\n\t\tdisabledValue: ?HTMLElement,\n\t\tentitySelector: ?HTMLElement,\n\t};\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\n\t\tif (this.#params.entitySelector)\n\t\t{\n\t\t\tthis.#params.value = this.#params.entitySelector.getPreselectedItems()[0]?.[1];\n\t\t}\n\t}\n\n\tisChecked(): boolean\n\t{\n\t\treturn this.#layout.checker.isChecked();\n\t}\n\n\tgetValue(): string\n\t{\n\t\tconst entitySelectorValue = this.#getSelectedItem()?.id;\n\n\t\treturn this.#layout.checkerValue?.value || entitySelectorValue || this.#params.placeholder;\n\t}\n\n\tsetErrors(errors: string[])\n\t{\n\t\tthis.#layout.checker?.setErrors(errors);\n\t}\n\n\tcleanError()\n\t{\n\t\tthis.#layout.checker?.cleanError();\n\t}\n\n\tgetInputNode(): HTMLInputElement\n\t{\n\t\treturn this.#renderInput();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.wrap = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-flow__create-value-checker ${this.#params.value ? '' : '--off'}\"\n\t\t\t\tdata-id=\"tasks-flow-value-checker-${this.#params.id}\"\n\t\t\t>\n\t\t\t\t${this.#renderChecker()}\n\t\t\t\t${this.#renderValue()}\n\t\t\t\t${this.#renderEntitySelectorValue()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.update();\n\n\t\tconst observer = new IntersectionObserver(() => {\n\t\t\tif (this.#layout.wrap.offsetWidth > 0)\n\t\t\t{\n\t\t\t\tthis.update();\n\n\t\t\t\tobserver.disconnect();\n\t\t\t}\n\t\t});\n\t\tobserver.observe(this.#layout.wrap);\n\n\t\treturn this.#layout.wrap;\n\t}\n\n\t#renderChecker(): HTMLElement\n\t{\n\t\tthis.#layout.checker = new Checker({\n\t\t\tchecked: !!this.#params.value,\n\t\t\ttitle: this.#params.title,\n\t\t\thideSeparator: true,\n\t\t\tsize: this.#params.size ?? 'small',\n\t\t});\n\n\t\tthis.#layout.checker.subscribe('change', (baseEvent: BaseEvent) => {\n\t\t\tconst isChecked = baseEvent.getData();\n\n\t\t\tthis.update();\n\n\t\t\tif (isChecked && this.#layout.checkerValue)\n\t\t\t{\n\t\t\t\tconst length = this.#layout.checkerValue.value.length;\n\n\t\t\t\tthis.#layout.checkerValue.focus();\n\t\t\t\tthis.#layout.checkerValue.setSelectionRange(length, length);\n\t\t\t}\n\t\t});\n\n\t\treturn this.#layout.checker.render();\n\t}\n\n\t#renderValue(): HTMLElement|string\n\t{\n\t\tif (!this.#params.placeholder)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.disabledValue = Tag.render`\n\t\t\t<span class=\"tasks-flow__create-value-checker_text\">${this.getValue()}</span>\n\t\t`;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create-value-checker_input\">\n\t\t\t\t${this.#renderInput()}\n\t\t\t\t<span>${this.#params.unit ?? ''}</span>\n\t\t\t\t${this.#layout.disabledValue}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderInput(): HTMLElement\n\t{\n\t\tif (this.#layout.checkerValue)\n\t\t{\n\t\t\treturn this.#layout.checkerValue;\n\t\t}\n\n\t\tthis.#layout.checkerValue = Tag.render`\n\t\t\t<input class=\"ui-ctl-element\" placeholder=\"${this.#params.placeholder}\" value=\"${this.#params.value ?? this.#params.placeholder}\">\n\t\t`;\n\n\t\tEvent.bind(this.#layout.checkerValue, 'input', () => this.update());\n\n\t\treturn this.#layout.checkerValue;\n\t}\n\n\t#renderEntitySelectorValue(): HTMLElement|string\n\t{\n\t\tif (!this.#params.entitySelector)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.entitySelector = Tag.render`\n\t\t\t<div class=\"tasks-flow-template-selector\">\n\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_SELECT')}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#params.entitySelector.subscribe('Item:onSelect', this.#onEntitySelectorItemSelectedHandler.bind(this));\n\t\tthis.#params.entitySelector.subscribe('Item:onDeselect', () => this.update());\n\t\tthis.#params.entitySelector.subscribe('onLoad', () => this.update());\n\t\tthis.#params.entitySelector.setTargetNode(this.#layout.entitySelector);\n\n\t\tEvent.bind(this.#layout.entitySelector, 'click', () => {\n\t\t\tif (this.isChecked())\n\t\t\t{\n\t\t\t\tthis.#params.entitySelector.show();\n\t\t\t}\n\t\t});\n\n\t\treturn this.#layout.entitySelector;\n\t}\n\n\t#onEntitySelectorItemSelectedHandler()\n\t{\n\t\tthis.update();\n\t\tthis.#params.entitySelector.hide();\n\t}\n\n\tupdate(): void\n\t{\n\t\tthis.#layout.wrap.closest('form')?.dispatchEvent(new window.Event('change'));\n\n\t\tDom.addClass(this.#layout.wrap, '--off');\n\t\tif (this.isChecked())\n\t\t{\n\t\t\tDom.removeClass(this.#layout.wrap, '--off');\n\t\t}\n\n\t\tif (this.#params.entitySelector)\n\t\t{\n\t\t\tthis.#layout.entitySelector.innerText = this.#getSelectedItem()?.title.text ?? Loc.getMessage('TASKS_FLOW_EDIT_FORM_SELECT');\n\t\t}\n\n\t\tif (!this.#params.placeholder)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#layout.disabledValue.innerText = this.getValue();\n\t\tDom.style(this.#layout.disabledValue, 'display', '');\n\t\tthis.#layout.checkerValue.style.width = `${this.#layout.disabledValue.offsetWidth + 7}px`;\n\t\tconst checkerField = this.#layout.wrap.querySelector('.ui-section__field');\n\t\tthis.#layout.checkerValue.style.height = `${checkerField.offsetHeight}px`;\n\t}\n\n\t#getSelectedItem(): any\n\t{\n\t\treturn this.#params.entitySelector?.getSelectedItems()[0];\n\t}\n}","type Params = {\n\tinput: HTMLInputElement,\n\tmin: ?number,\n\tmax: ?number,\n};\n\nclass BindFilterNumberInput\n{\n\t#params: Params;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\n\t\tthis.#bind(params.input);\n\t}\n\n\t#bind(input: HTMLInputElement): void\n\t{\n\t\tlet dispatchedProgrammatically = false;\n\t\tinput.addEventListener('input', () => {\n\t\t\tif (dispatchedProgrammatically)\n\t\t\t{\n\t\t\t\tdispatchedProgrammatically = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst textBeforeCursor = this.#getTextBeforeCursor(input);\n\n\t\t\tinput.value = this.#normalizeNumber(input.value) || '';\n\n\t\t\tthis.#setCursorToFormattedPosition(input, textBeforeCursor);\n\n\t\t\tdispatchedProgrammatically = true;\n\t\t\tinput.dispatchEvent(new Event('input'));\n\t\t});\n\t}\n\n\t#getTextBeforeCursor(input: HTMLInputElement): string\n\t{\n\t\tconst selectionStart = input.selectionStart;\n\t\tconst text = input.value.slice(0, selectionStart);\n\n\t\treturn this.#normalizeNumber(text);\n\t}\n\n\t#normalizeNumber(value: string): string\n\t{\n\t\tlet normalizedValue = value.replace(/\\D/g, '');\n\t\tnormalizedValue = parseInt(normalizedValue, 10);\n\t\tnormalizedValue = Math.max(this.#params.min ?? 1, normalizedValue);\n\t\tnormalizedValue = Math.min(this.#params.max ?? 9999, normalizedValue);\n\n\t\treturn `${normalizedValue || ''}`;\n\t}\n\n\t#setCursorToFormattedPosition(input: HTMLInputElement, textBeforeCursor: string): void\n\t{\n\t\tconst firstPart = textBeforeCursor.slice(0, -1);\n\t\tconst lastCharacter = textBeforeCursor.slice(-1);\n\t\tconst matches = input.value.match(`${firstPart}.*?${lastCharacter}`);\n\t\tif (!matches)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst match = matches[0];\n\t\tconst formattedPosition = input.value.indexOf(match) + match.length;\n\t\tinput.setSelectionRange(formattedPosition, formattedPosition);\n\t}\n}\n\nconst bindFilterNumberInput = (params: Params) => new BindFilterNumberInput(params);\n\nexport { bindFilterNumberInput };","import { ajax, Event, Loc, Tag, Type } from 'main.core';\nimport { TextInput, TextArea, UserSelector } from 'ui.form-elements.view';\nimport { IntervalSelector } from 'tasks.interval-selector';\nimport { FormPage } from './form-page';\nimport { ValueChecker } from '../value-checker';\nimport { bindFilterNumberInput } from '../bind-filter-number-input';\n\nimport type { Flow } from '../edit-form';\n\ntype Params = {\n\tonChangeHandler: Function,\n};\n\nexport class AboutPage extends FormPage\n{\n\t#params: Params;\n\n\t#layout: {\n\t\taboutPageForm: HTMLFormElement,\n\n\t\tflowName: TextInput,\n\t\tflowDescription: TextInput,\n\t\ttaskCreatorsSelector: UserSelector,\n\t\tplannedCompletionTime: TextInput,\n\t\tplannedCompletionTimeIntervalSelector: IntervalSelector,\n\t\tskipWeekends: ValueChecker,\n\t};\n\n\t#flow: Flow;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flow = {};\n\t}\n\n\tsetFlow(flow: Flow): void\n\t{\n\t\tthis.#flow = flow;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'about-flow';\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_FLOW_EDIT_FORM_ABOUT_FLOW');\n\t}\n\n\tgetRequiredData(): string[]\n\t{\n\t\treturn ['name', 'plannedCompletionTime', 'taskCreators'];\n\t}\n\n\tshowErrors(incorrectData: string[]): void\n\t{\n\t\tif (incorrectData.includes('name'))\n\t\t{\n\t\t\tthis.#layout.flowName.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_NAME_ERROR')]);\n\t\t}\n\n\t\tif (incorrectData.includes('plannedCompletionTime'))\n\t\t{\n\t\t\tthis.#layout.plannedCompletionTime.setErrors(\n\t\t\t\t[Loc.getMessage('TASKS_FLOW_EDIT_FORM_PLANNED_COMPLETION_TIME_ERROR')],\n\t\t\t);\n\t\t}\n\n\t\tif (incorrectData.includes('taskCreators'))\n\t\t{\n\t\t\tthis.#layout.taskCreatorsSelector.setErrors(\n\t\t\t\t[Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASKS_CREATORS_ERROR')],\n\t\t\t);\n\t\t}\n\t}\n\n\tcleanErrors(): void\n\t{\n\t\tthis.#layout.flowName.cleanError();\n\t\tthis.#layout.plannedCompletionTime.cleanError();\n\t\tthis.#layout.taskCreatorsSelector.cleanError();\n\t}\n\n\tgetFields(flowData: Flow = {}): Flow\n\t{\n\t\tconst plannedCompletionTimeValue = parseInt(this.#layout.plannedCompletionTime?.getValue(), 10);\n\t\tconst intervalDuration = this.#layout.plannedCompletionTimeIntervalSelector?.getDuration();\n\n\t\treturn {\n\t\t\tname: flowData.name ?? this.#layout.flowName?.getValue().trim(),\n\t\t\tdescription: flowData.description ?? this.#layout.flowDescription?.getValue(),\n\t\t\ttaskCreators: (flowData.taskCreators ?? this.#getTasksCreatorsFromSelector()),\n\t\t\tplannedCompletionTime: (\n\t\t\t\tflowData.plannedCompletionTime\n\t\t\t\t\t?? (plannedCompletionTimeValue * intervalDuration || 0)\n\t\t\t),\n\t\t\tmatchWorkTime: flowData.matchWorkTime ?? (this.#layout.skipWeekends?.isChecked() ?? true),\n\t\t};\n\t}\n\n\t#getTasksCreatorsFromSelector()\n\t{\n\t\tlet taskCreators = this.#layout.taskCreatorsSelector\n\t\t\t?.getSelector()\n\t\t\t.getTags()\n\t\t\t.map((tag) => [tag.entityId, tag.id])\n\t\t;\n\n\t\tif (Type.isUndefined(taskCreators) || taskCreators.length === 0)\n\t\t{\n\t\t\ttaskCreators = this.#layout.taskCreatorsSelector\n\t\t\t\t?.getSelector()\n\t\t\t\t?.getDialog()\n\t\t\t\t.getPreselectedItems()\n\t\t\t;\n\t\t}\n\n\t\treturn taskCreators;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.flowName = new TextInput({\n\t\t\tid: 'tasks-flow-edit-form-field-name',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_NAME'),\n\t\t\tplaceholder: Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_NAME_EXAMPLE'),\n\t\t\tvalue: this.#flow.name,\n\t\t});\n\n\t\tthis.#layout.flowDescription = new TextArea({\n\t\t\tid: 'tasks-flow-edit-form-field-description',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_DESCRIPTION'),\n\t\t\tplaceholder: Loc.getMessage('TASKS_FLOW_EDIT_FORM_DESCRIPTION_EXAMPLE'),\n\t\t\tvalue: this.#flow.description,\n\t\t\tresizeOnlyY: true,\n\t\t});\n\n\t\tthis.#layout.taskCreatorsSelector = new UserSelector({\n\t\t\tid: 'tasks-flow-edit-form-field-creators',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_WHO_CAN_ADD_TASKS'),\n\t\t\tenableDepartments: true,\n\t\t\tvalues: this.#flow.taskCreators,\n\t\t});\n\n\t\tthis.#layout.aboutPageForm = Tag.render`\n\t\t\t<form class=\"tasks-flow__create-about\">\n\t\t\t\t${this.#layout.flowName.render()}\n\t\t\t\t${this.#layout.flowDescription.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#layout.taskCreatorsSelector.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#renderPlannedCompletionTime()}\n\t\t\t</form>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.aboutPageForm, 'change', this.#params.onChangeHandler);\n\n\t\treturn this.#layout.aboutPageForm;\n\t}\n\n\tfocusToEmptyName()\n\t{\n\t\tconst isEmpty = this.#layout.flowName.getValue().trim().length === 0;\n\n\t\tif (isEmpty)\n\t\t{\n\t\t\tthis.#layout.flowName.getInputNode().focus();\n\t\t}\n\t}\n\n\t#renderPlannedCompletionTime(): HTMLElement\n\t{\n\t\tconst value = this.#flow.plannedCompletionTime;\n\t\tthis.#layout.plannedCompletionTimeIntervalSelector = new IntervalSelector({ value });\n\t\tconst duration = this.#layout.plannedCompletionTimeIntervalSelector.getDuration();\n\n\t\tconst plannedCompletionTimeLabel = `\n\t\t\t<div class=\"tasks-flow__create-title-with-hint\">\n\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_PLANNED_COMPLETION_TIME')}\n\t\t\t\t<span\n\t\t\t\t\tdata-id=\"plannedCompletionTimeHint\"\n\t\t\t\t\tclass=\"ui-hint\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_FLOW_EDIT_FORM_PLANNED_COMPLETION_TIME_HINT')}\" \n\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"ui-hint-icon\"></span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.plannedCompletionTime = new TextInput({\n\t\t\tlabel: plannedCompletionTimeLabel,\n\t\t\tplaceholder: '0',\n\t\t\tinputDefaultWidth: true,\n\t\t\tvalue: String(value / duration || ''),\n\t\t});\n\n\t\tconst maxInt = (2 ** 32) / 2 - 1;\n\t\tconst monthDuration = 60 * 60 * 24 * 31;\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.plannedCompletionTime.getInputNode(),\n\t\t\tmax: Math.floor(maxInt / monthDuration),\n\t\t});\n\n\t\tthis.#layout.skipWeekends = new ValueChecker({\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_SKIP_WEEKENDS'),\n\t\t\tvalue: this.#flow.id === 0 || this.#flow.matchWorkTime,\n\t\t\tsize: 'extra-small',\n\t\t});\n\n\t\tconst root = Tag.render`\n\t\t\t<div data-id=\"tasks-flow-edit-form-field-planned-time\">\n\t\t\t\t<div class=\"tasks-flow__create-planned_completion-time\">\n\t\t\t\t\t${this.#layout.plannedCompletionTime.render()}\n\t\t\t\t\t<div class=\"tasks-flow__create-planned_completion-time-interval\">\n\t\t\t\t\t\t${this.#layout.plannedCompletionTimeIntervalSelector.render()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#layout.skipWeekends.render()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn root;\n\t}\n\n\tasync onContinueClick(flowData: Flow = {}): Promise<boolean>\n\t{\n\t\tconst { data: response } = await ajax.runAction('tasks.flow.Flow.isExists', {\n\t\t\tdata: {\n\t\t\t\tflowData: flowData,\n\t\t\t},\n\t\t});\n\n\t\tif (response.exists)\n\t\t{\n\t\t\tthis.#layout.flowName.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_DUPLICATE_ERROR')]);\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n}\n","import { EventEmitter } from 'main.core.events';\n\nexport class PullRequests extends EventEmitter\n{\n\t#userId: number;\n\n\tconstructor(userId: number)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Flow.EditForm.PullRequests');\n\n\t\tthis.#userId = parseInt(userId, 10);\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap(): Object\n\t{\n\t\treturn {\n\t\t\ttemplate_add: this.#onTemplateAdded.bind(this),\n\t\t\ttemplate_update: this.#onTemplateUpdated.bind(this),\n\t\t};\n\t}\n\n\t#onTemplateAdded(data): void\n\t{\n\t\tthis.emit('templateAdded', {\n\t\t\ttemplate: {\n\t\t\t\tid: data.TEMPLATE_ID,\n\t\t\t\ttitle: data.TEMPLATE_TITLE,\n\t\t\t},\n\t\t});\n\t}\n\n\t#onTemplateUpdated(data): void\n\t{\n\t\tthis.emit('templateUpdated', {\n\t\t\ttemplate: {\n\t\t\t\tid: data.TEMPLATE_ID,\n\t\t\t\ttitle: data.TEMPLATE_TITLE,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { Dom, Event, Extension, Loc, Tag, Type } from 'main.core';\nimport { PULL as Pull } from 'pull.client';\nimport { Dialog } from 'ui.entity-selector';\nimport { UserSelector } from 'ui.form-elements.view';\nimport { PullRequests } from '../pull-requests';\nimport { FormPage } from './form-page';\nimport { ValueChecker } from '../value-checker';\n\nimport type { Flow } from '../edit-form';\n\ntype Params = {\n\tonChangeHandler: Function,\n};\n\nexport class SettingsPage extends FormPage\n{\n\t#params: Params;\n\n\t#layout: {\n\t\tsettingsPageForm: HTMLFormElement,\n\n\t\tqueueDistribution: HTMLElement,\n\t\tqueueRadio: HTMLInputElement,\n\t\tresponsiblesSelector: UserSelector,\n\t\tmanuallyDistribution: HTMLElement,\n\t\tmanuallyRadio: HTMLInputElement,\n\t\thimselfDistribution: HTMLElement,\n\t\thimselfRadio: HTMLInputElement,\n\t\tmoderatorSelector: UserSelector,\n\t\tresponsibleCanChangeDeadline: ValueChecker,\n\t\tnotifyAtHalfTime: ValueChecker,\n\t\ttaskControl: ValueChecker,\n\t\tprojectSelector: UserSelector,\n\t\ttaskTemplate: ValueChecker,\n\t\ttaskTemplateDialog: Dialog,\n\t};\n\n\t#flow: Flow;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flow = {};\n\n\t\tthis.#init();\n\t}\n\n\tget #currentUser(): number\n\t{\n\t\tconst settings = Extension.getSettings('tasks.flow.edit-form');\n\n\t\treturn settings.currentUser;\n\t}\n\n\t#init()\n\t{\n\t\tthis.#subscribeToPull();\n\t}\n\n\t#subscribeToPull(): void\n\t{\n\t\tconst pullRequests = new PullRequests(this.#currentUser);\n\t\tpullRequests.subscribe('templateAdded', this.#onTemplateAddedHandler.bind(this));\n\t\tpullRequests.subscribe('templateUpdated', this.#onTemplateUpdatedHandler.bind(this));\n\n\t\tPull.subscribe(pullRequests);\n\t}\n\n\t#onTemplateAddedHandler({ data })\n\t{\n\t\tconst template = data.template;\n\t\tconst templateItem = {\n\t\t\tid: template.id,\n\t\t\tentityId: 'task-template',\n\t\t\ttitle: template.title,\n\t\t\ttabs: 'recents',\n\t\t};\n\n\t\tthis.#layout.taskTemplateDialog.addItem(templateItem);\n\n\t\tthis.#layout.taskTemplateDialog.getItems().find((item) => item.id === templateItem.id).select();\n\t}\n\n\t#onTemplateUpdatedHandler({ data })\n\t{\n\t\tconst template = data.template;\n\t\tconst templateItem = this.#layout.taskTemplateDialog.getItem({ id: template.id, entityId: 'task-template' });\n\n\t\tif (Type.isStringFilled(template.title))\n\t\t{\n\t\t\ttemplateItem?.setTitle(template.title);\n\t\t\tthis.#layout.taskTemplate?.update();\n\t\t}\n\n\t\tif (!Type.isArrayFilled(this.#layout.taskTemplateDialog.getSelectedItems()))\n\t\t{\n\t\t\ttemplateItem?.select();\n\t\t}\n\t}\n\n\tsetFlow(flow: Flow): void\n\t{\n\t\tthis.#flow = flow;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'settings';\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_FLOW_EDIT_FORM_SETTINGS');\n\t}\n\n\tgetRequiredData(): string[]\n\t{\n\t\tconst requiredData = [\n\t\t\t'groupId',\n\t\t\tthis.getFields().distributionType === 'manually' ? 'manualDistributorId' : 'responsibleQueue',\n\t\t];\n\n\t\tif (this.#layout.taskTemplate.isChecked())\n\t\t{\n\t\t\trequiredData.push('templateId');\n\t\t}\n\n\t\treturn requiredData;\n\t}\n\n\tupdate(): void\n\t{\n\t\tsuper.update();\n\n\t\tDom.removeClass(this.#layout.queueDistribution, '--active');\n\t\tDom.removeClass(this.#layout.manuallyDistribution, '--active');\n\t\tDom.removeClass(this.#layout.himselfDistribution, '--active');\n\n\t\tif (this.#layout.queueRadio.checked)\n\t\t{\n\t\t\tDom.addClass(this.#layout.queueDistribution, '--active');\n\t\t}\n\n\t\tif (this.#layout.manuallyRadio.checked)\n\t\t{\n\t\t\tDom.addClass(this.#layout.manuallyDistribution, '--active');\n\t\t}\n\t}\n\n\tshowErrors(incorrectData: string[]): void\n\t{\n\t\tif (incorrectData.includes('responsibleQueue'))\n\t\t{\n\t\t\tthis.#layout.responsiblesSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASKS_RESPONSIBLES_ERROR')]);\n\t\t}\n\n\t\tif (incorrectData.includes('manualDistributorId'))\n\t\t{\n\t\t\tthis.#layout.moderatorSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASKS_MODERATOR_ERROR')]);\n\t\t}\n\n\t\tif (incorrectData.includes('groupId'))\n\t\t{\n\t\t\tthis.#layout.projectSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_PROJECT_FOR_TASKS_ERROR')]);\n\t\t}\n\n\t\tif (incorrectData.includes('templateId'))\n\t\t{\n\t\t\tthis.#layout.taskTemplate.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_TEMPLATE_FOR_TASKS_ERROR')]);\n\t\t}\n\t}\n\n\tcleanErrors(): void\n\t{\n\t\tthis.#layout.projectSelector.cleanError();\n\t\tthis.#layout.responsiblesSelector.cleanError();\n\t\tthis.#layout.moderatorSelector.cleanError();\n\t\tthis.#layout.taskTemplate.cleanError();\n\t}\n\n\tgetFields(flowData: Flow = {}): Flow\n\t{\n\t\tlet responsibleQueue = this.#flow.responsibleQueue;\n\t\tif (this.#layout.responsiblesSelector?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\tresponsibleQueue = this.#layout.responsiblesSelector?.getSelector().getTags().map((tag) => tag.id);\n\t\t}\n\n\t\tlet manualDistributorId = this.#flow.manualDistributorId;\n\t\tif (this.#layout.moderatorSelector?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\tmanualDistributorId = this.#layout.moderatorSelector.getSelector().getTags()[0]?.id;\n\t\t}\n\n\t\tlet groupId = this.#flow.groupId;\n\t\tif (this.#layout.projectSelector?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\tgroupId = this.#layout.projectSelector.getSelector().getTags()[0]?.id;\n\t\t}\n\n\t\treturn {\n\t\t\tdistributionType: flowData.distributionType ?? (new FormData(this.#layout.settingsPageForm).get('distribution') || 'queue'),\n\t\t\tresponsibleQueue: flowData.responsibleQueue ?? responsibleQueue,\n\t\t\tmanualDistributorId: flowData.manualDistributorId ?? (manualDistributorId || 0),\n\t\t\tresponsibleCanChangeDeadline: flowData.responsibleCanChangeDeadline ?? (this.#layout.responsibleCanChangeDeadline?.isChecked() ?? false),\n\t\t\tnotifyAtHalfTime: flowData.notifyAtHalfTime ?? (this.#layout.notifyAtHalfTime?.isChecked() ?? false),\n\t\t\ttaskControl: flowData.taskControl ?? (this.#layout.taskControl?.isChecked() ?? false),\n\t\t\tgroupId: flowData.groupId ?? (groupId || 0),\n\t\t\ttemplateId: flowData.templateId ?? (this.#layout.taskTemplate?.isChecked() ? this.#layout.taskTemplate.getValue() : 0),\n\t\t};\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.responsibleCanChangeDeadline = new ValueChecker({\n\t\t\tid: 'responsible-can-change-deadline',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_RESPONSIBLE_CAN_CHANGE_DEADLINE'),\n\t\t\tvalue: this.#flow.responsibleCanChangeDeadline,\n\t\t});\n\n\t\tconst notifyAtHalfTimeTitle = `\n\t\t\t<div class=\"tasks-flow__create-title-with-hint\">\n\t\t\t\t<span>${Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_AT_HALF_TIME')}</span>\n\t\t\t\t<span\n\t\t\t\t\tdata-id=\"notifyAtHalfTimeHint\"\n\t\t\t\t\tclass=\"ui-hint ui-hint-flow-value-checker\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_AT_HALF_TIME_HINT')}\" \n\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"ui-hint-icon ui-hint-icon-flow-value-checker\"></span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.notifyAtHalfTime = new ValueChecker({\n\t\t\tid: 'notify-at-half-time',\n\t\t\ttitle: notifyAtHalfTimeTitle,\n\t\t\tvalue: this.#flow.notifyAtHalfTime,\n\t\t});\n\n\t\tthis.#layout.taskControl = new ValueChecker({\n\t\t\tid: 'task-control',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASK_CONTROL'),\n\t\t\tvalue: this.#flow.taskControl,\n\t\t});\n\n\t\tthis.#layout.projectSelector = new UserSelector({\n\t\t\tlabel: this.#getProjectLabel(),\n\t\t\tenableUsers: false,\n\t\t\tenableDepartments: false,\n\t\t\tmultiple: false,\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'project',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tfeatures: {\n\t\t\t\t\t\t\ttasks: [],\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcheckFeatureForCreate: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tvalues: this.#flow.groupId ? [['project', this.#flow.groupId]] : [],\n\t\t});\n\n\t\tthis.#layout.taskTemplate = new ValueChecker({\n\t\t\tid: 'task-template',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_ACCEPT_TASKS_BY_TEMPLATE_TITLE'),\n\t\t\tentitySelector: this.#getTaskTemplateDialog(),\n\t\t});\n\n\t\tthis.#layout.settingsPageForm = Tag.render`\n\t\t\t<form class=\"tasks-flow__create-settings\">\n\t\t\t\t${this.#renderDistribution()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#layout.responsibleCanChangeDeadline.render()}\n\t\t\t\t${this.#layout.notifyAtHalfTime.render()}\n\t\t\t\t${this.#layout.taskControl.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator\"></div>\n\t\t\t\t${this.#layout.projectSelector.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#layout.taskTemplate.render()}\n\t\t\t</form>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.settingsPageForm, 'change', this.#params.onChangeHandler);\n\n\t\treturn this.#layout.settingsPageForm;\n\t}\n\n\t#renderDistribution(): HTMLElement\n\t{\n\t\tthis.#layout.responsiblesSelector = new UserSelector({\n\t\t\tenableAll: false,\n\t\t\tenableDepartments: false,\n\t\t\tvalues: this.#flow.responsibleQueue?.map((responsibleId) => ['user', responsibleId]),\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_DISTRIBUTION_QUEUE_SELECTOR_LABEL'),\n\t\t});\n\n\t\tthis.#layout.moderatorSelector = new UserSelector({\n\t\t\tenableAll: false,\n\t\t\tenableDepartments: false,\n\t\t\tmultiple: false,\n\t\t\tvalues: [['user', this.#flow.manualDistributorId || this.#currentUser]],\n\t\t});\n\n\t\tconst { root: queueDistribution, radio: queueRadio } = this.#renderDistributionType({\n\t\t\ttype: 'queue',\n\t\t\tselector: this.#layout.responsiblesSelector,\n\t\t});\n\t\tthis.#layout.queueDistribution = queueDistribution;\n\t\tthis.#layout.queueRadio = queueRadio;\n\n\t\tconst { root: manuallyDistribution, radio: manuallyRadio } = this.#renderDistributionType({\n\t\t\ttype: 'manually',\n\t\t\tselector: this.#layout.moderatorSelector,\n\t\t});\n\t\tthis.#layout.manuallyDistribution = manuallyDistribution;\n\t\tthis.#layout.manuallyRadio = manuallyRadio;\n\n\t\tconst { root: himselfDistribution, radio: himselfRadio } = this.#renderDistributionType({\n\t\t\ttype: 'himself',\n\t\t});\n\t\tthis.#layout.himselfDistribution = himselfDistribution;\n\t\tthis.#layout.himselfRadio = himselfRadio;\n\n\t\tthis.#layout.queueRadio.checked = this.#flow.distributionType === 'queue';\n\t\tthis.#layout.manuallyRadio.checked = this.#flow.distributionType === 'manually';\n\t\tthis.update();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-section__field-container\">\n\t\t\t\t<div class=\"ui-section__field-label_box\">\n\t\t\t\t\t<label class=\"ui-section__field-label\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DISTRIBUTION_TYPE')}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t${this.#layout.queueDistribution}\n\t\t\t\t${this.#layout.manuallyDistribution}\n\t\t\t\t${this.#layout.himselfDistribution}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderDistributionType({ type, selector }): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create-distribution-type --${type}\" data-id=\"tasks-flow-distribution-${type}\">\n\t\t\t\t<label class=\"ui-ctl ui-ctl-radio ui-ctl-wa\">\n\t\t\t\t\t<input type=\"radio\" name=\"distribution\" value=\"${type}\" class=\"ui-ctl-element\" ref=\"radio\">\n\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_title-container\">\n\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_content\">\n\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_title\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_title-text\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_FLOW_EDIT_FORM_DISTRIBUTION_${type.toUpperCase()}`)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span class=\"tasks-flow__create-distribution-type_label ui-label ui-label-primary ui-label-fill\">\n\t\t\t\t\t\t\t\t\t<span class=\"ui-label-inner\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_STUB_BUTTON')}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_hint\">\n\t\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_FLOW_EDIT_FORM_DISTRIBUTION_${type.toUpperCase()}_HINT`)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_icon --${type}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\t\t\t\t<div class=\"tasks-flow__create-distribution-type_selector\">\n\t\t\t\t\t${selector?.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getTaskTemplateDialog(): Dialog\n\t{\n\t\tthis.#layout.taskTemplateDialog = new Dialog({\n\t\t\twidth: 500,\n\t\t\tcontext: 'flow',\n\t\t\tpreselectedItems: this.#flow.templateId ? [['task-template', this.#flow.templateId]] : '',\n\t\t\tenableSearch: true,\n\t\t\tmultiple: false,\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'task-template',\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\treturn this.#layout.taskTemplateDialog;\n\t}\n\n\t#getProjectLabel(): string\n\t{\n\t\tconst notifyEmptyProject = `\n\t\t\t<span\n\t\t\t\tdata-id=\"notifyEmptyProjectHint\"\n\t\t\t\tclass=\"ui-hint ui-hint-flow-value-checker\"\n\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_EMPTY_PROJECT_HINT')}\" \n\t\t\t\tdata-hint-no-icon\n\t\t\t>\n\t\t\t\t<span class=\"ui-hint-icon ui-hint-icon-flow-value-checker\"></span>\n\t\t\t</span>\n\t\t`;\n\n\t\treturn `\n\t\t\t<div class=\"tasks-flow-field-label-container\">\n\t\t\t\t<span>${Loc.getMessage('TASKS_FLOW_EDIT_FORM_PROJECT_FOR_TASKS')}</span>\n\t\t\t\t${this.#flow.id ? '' : notifyEmptyProject}\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { Event, Extension, Loc, Tag } from 'main.core';\nimport { UserSelector } from 'ui.form-elements.view';\nimport { FormPage } from './form-page';\nimport { ValueChecker } from '../value-checker';\nimport { bindFilterNumberInput } from '../bind-filter-number-input';\n\nimport type { Flow } from '../edit-form';\n\ntype Params = {\n\tonChangeHandler: Function,\n};\n\nexport class ControlPage extends FormPage\n{\n\t#params: Params;\n\n\t#layout: {\n\t\tcontrolPageForm: HTMLFormElement,\n\n\t\tflowOwnerSelector: UserSelector,\n\t\tnotifyOnQueueOverflow: ValueChecker,\n\t\tnotifyOnTasksInProgressOverflow: ValueChecker,\n\t\tnotifyWhenEfficiencyDecreases: ValueChecker,\n\t\tanalyticsPermissionsSelector: UserSelector,\n\t};\n\n\t#flow: Flow;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flow = {};\n\t}\n\n\tget #currentUser(): number\n\t{\n\t\tconst settings = Extension.getSettings('tasks.flow.edit-form');\n\n\t\treturn settings.currentUser;\n\t}\n\n\tsetFlow(flow: Flow): void\n\t{\n\t\tthis.#flow = flow;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'control';\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_FLOW_EDIT_FORM_CONTROL');\n\t}\n\n\tgetRequiredData(): string[]\n\t{\n\t\treturn this.#getCheckerValues().filter((checker) => this.#layout[checker].isChecked());\n\t}\n\n\tshowErrors(incorrectData: string[]): void\n\t{\n\t\tif (incorrectData.includes('ownerId'))\n\t\t{\n\t\t\tthis.#layout.flowOwnerSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_OWNER_ERROR')]);\n\t\t}\n\n\t\tthis.#getCheckerValues().forEach((checker) => {\n\t\t\tif (incorrectData.includes(checker))\n\t\t\t{\n\t\t\t\tthis.#layout[checker].setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_VALUE_ERROR')]);\n\t\t\t}\n\t\t});\n\t}\n\n\tcleanErrors(): void\n\t{\n\t\tthis.#layout.flowOwnerSelector.cleanError();\n\t\tthis.#getCheckerValues().forEach((checker) => this.#layout[checker].cleanError());\n\t}\n\n\t#getCheckerValues(): string[]\n\t{\n\t\treturn ['notifyOnQueueOverflow', 'notifyOnTasksInProgressOverflow', 'notifyWhenEfficiencyDecreases'];\n\t}\n\n\tgetFields(flowData: Flow = {}): Flow\n\t{\n\t\tlet ownerId = this.#currentUser;\n\t\tif (this.#layout.flowOwnerSelector?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\townerId = this.#layout.flowOwnerSelector.getSelector().getTags()[0]?.id;\n\t\t}\n\n\t\treturn {\n\t\t\townerId: flowData.ownerId || (ownerId || 0),\n\n\t\t\tnotifyOnQueueOverflow: flowData.notifyOnQueueOverflow ?? this.#getCheckerNumericValue(this.#layout.notifyOnQueueOverflow),\n\t\t\tnotifyOnTasksInProgressOverflow: flowData.notifyOnTasksInProgressOverflow ?? this.#getCheckerNumericValue(this.#layout.notifyOnTasksInProgressOverflow),\n\t\t\tnotifyWhenEfficiencyDecreases: flowData.notifyWhenEfficiencyDecreases ?? this.#getCheckerNumericValue(this.#layout.notifyWhenEfficiencyDecreases),\n\t\t}\n\t}\n\n\t#getCheckerNumericValue(checker: ?ValueChecker)\n\t{\n\t\treturn checker?.isChecked() ? this.#getInteger(checker.getValue()) : null;\n\t}\n\n\t#getInteger(value: string): boolean\n\t{\n\t\treturn /^\\d+$/.test(value) ? parseInt(value, 10) : 0;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst flowOwnerLabel = `\n\t\t\t<div class=\"tasks-flow__create-title-with-hint\">\n\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_OWNER')}\n\t\t\t\t<span\n\t\t\t\t\tdata-id=\"flowOwnerHint\"\n\t\t\t\t\tclass=\"ui-hint\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_OWNER_HINT')}\" \n\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t><span class=\"ui-hint-icon\"></span></span>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.flowOwnerSelector = new UserSelector({\n\t\t\tid: 'tasks-flow-edit-form-field-owner',\n\t\t\tlabel: flowOwnerLabel,\n\t\t\tenableAll: false,\n\t\t\tenableDepartments: false,\n\t\t\tmultiple: false,\n\t\t\tvalues: [['user', this.#flow.ownerId]],\n\t\t});\n\n\t\tthis.#layout.notifyOnQueueOverflow = new ValueChecker({\n\t\t\tid: 'notify-on-queue-overflow',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_ON_QUEUE_OVERFLOW'),\n\t\t\tplaceholder: 50,\n\t\t\tvalue: this.#flow.notifyOnQueueOverflow,\n\t\t\tsize: 'extra-small',\n\t\t});\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.notifyOnQueueOverflow.getInputNode(),\n\t\t\tmax: 99999,\n\t\t});\n\n\t\tthis.#layout.notifyOnTasksInProgressOverflow = new ValueChecker({\n\t\t\tid: 'notify-on-tasks-in-progress-overflow',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_ON_TASKS_IN_PROGRESS_OVERFLOW'),\n\t\t\tplaceholder: 50,\n\t\t\tvalue: this.#flow.notifyOnTasksInProgressOverflow,\n\t\t\tsize: 'extra-small',\n\t\t});\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.notifyOnTasksInProgressOverflow.getInputNode(),\n\t\t\tmax: 99999,\n\t\t});\n\n\t\tthis.#layout.notifyWhenEfficiencyDecreases = new ValueChecker({\n\t\t\tid: 'notify-when-efficiency-decreases',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_WHEN_EFFICIENCY_DECREASES'),\n\t\t\tplaceholder: 70,\n\t\t\tunit: '%',\n\t\t\tvalue: this.#flow.notifyWhenEfficiencyDecreases,\n\t\t\tsize: 'extra-small',\n\t\t});\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.notifyWhenEfficiencyDecreases.getInputNode(),\n\t\t\tmax: 100,\n\t\t});\n\n\t\tthis.#layout.analyticsPermissionsSelector = new UserSelector({\n\t\t\tid: 'tasks-flow-edit-form-field-analytics',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_PERMISSIONS'),\n\t\t\tenableAll: true,\n\t\t\tenableDepartments: true,\n\t\t\tclassName: '',\n\t\t});\n\n\t\tthis.#layout.controlPageForm = Tag.render`\n\t\t\t<form class=\"tasks-flow__create-control\">\n\t\t\t\t${this.#layout.flowOwnerSelector.render()}\n\t\t\t\t${this.#layout.notifyOnQueueOverflow.render()}\n\t\t\t\t${this.#layout.notifyOnTasksInProgressOverflow.render()}\n\t\t\t\t${this.#layout.notifyWhenEfficiencyDecreases.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator\"></div>\n\t\t\t\t${this.#renderAnalyticsStub()}\n\t\t\t</form>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.controlPageForm, 'change', this.#params.onChangeHandler);\n\n\t\treturn this.#layout.controlPageForm;\n\t}\n\n\t#renderAnalyticsStub(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create_analytics-stub\">\n\t\t\t\t<span>${Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_STUB_LABEL')}</span>\n\t\t\t\t<span class=\"tasks-flow__create_analytics-stub-label ui-label ui-label-primary ui-label-fill\">\n\t\t\t\t\t<span class=\"ui-label-inner\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_STUB_BUTTON')}\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { ajax, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { Button, ButtonState } from 'ui.buttons';\nimport { Wizard } from 'tasks.wizard';\nimport { Layout } from 'ui.sidepanel.layout';\nimport { FormPage } from './pages/form-page';\nimport { AboutPage } from './pages/about-page';\nimport { SettingsPage } from './pages/settings-page';\nimport { ControlPage } from './pages/control-page';\nimport { Lottie } from 'ui.lottie';\nimport flowfLottieIconInfo from '../lottie/tasks-flow-info-icon.json';\nimport 'ui.sidepanel-content';\nimport 'ui.forms';\nimport 'ui.hint';\nimport './style.css';\n\ntype Params = {\n\tflowId?: number,\n\tflowName?: string,\n\tdemoFlow?: 'Y' | 'N',\n\tguideFlow?: 'Y' | 'N',\n};\n\ntype DistributionType = 'manually' | 'queue' | 'by_workload';\n\nexport type Flow = {\n\tid: ?number,\n\tname: string,\n\tdescription: string,\n\ttaskCreators: string[],\n\tplannedCompletionTime: number,\n\tmatchWorkTime: boolean,\n\ttemplateId: number,\n\tresponsibleQueue: number[],\n\tresponsibleCanChangeDeadline: boolean,\n\tdistributionType: DistributionType,\n\tgroupId: number,\n\townerId: number,\n\tmanualDistributorId: number,\n\tdemo: boolean,\n\tnotifyOnQueueOverflow: ?number,\n\tnotifyOnTasksInProgressOverflow: ?number,\n\tnotifyWhenEfficiencyDecreases: ?number,\n\tnotifyAtHalfTime: boolean,\n\ttaskControl: boolean,\n\ttrialFeatureEnabled: boolean;\n};\n\nconst SLIDER_WIDTH = 692;\nconst HELPDESK_ARTICLE = 21272066;\n\nexport class EditForm extends EventEmitter\n{\n\t#params: Params;\n\n\t#layout: {};\n\n\t#wizard: Wizard;\n\t#pages: FormPage[];\n\t#finishButton: Button;\n\t#saveChangesButton: Button;\n\n\t#flow: Flow;\n\n\t#flowLottieAnimation: any = null;\n\t#lottieIconContainer: HTMLElement;\n\n\t#pageChanging: boolean = false;\n\n\t#hintManager = null;\n\n\tconstructor(params: Params = {})\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Flow.EditForm');\n\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flowLottieAnimation = null;\n\t\tthis.#lottieIconContainer = null;\n\n\t\tconst onChangeHandler = this.#onChangeHandler.bind(this);\n\t\tthis.#pages = [\n\t\t\tnew AboutPage({ onChangeHandler }),\n\t\t\tnew SettingsPage({ onChangeHandler }),\n\t\t\tnew ControlPage({ onChangeHandler }),\n\t\t];\n\n\t\tconst initFlowData = {\n\t\t\tnotifyAtHalfTime: true,\n\t\t\tresponsibleCanChangeDeadline: true,\n\t\t\ttaskControl: true,\n\t\t\tnotifyOnQueueOverflow: 50,\n\t\t\tnotifyOnTasksInProgressOverflow: 50,\n\t\t\tnotifyWhenEfficiencyDecreases: 70,\n\t\t\ttaskCreators: [\n\t\t\t\t['meta-user', 'all-users'],\n\t\t\t],\n\t\t};\n\t\tif (this.#params.flowName)\n\t\t{\n\t\t\tinitFlowData.name = this.#params.flowName;\n\t\t}\n\n\t\tthis.#flow = this.#getFlow(initFlowData);\n\t}\n\n\tstatic createInstance(params: Params = {}): EditForm\n\t{\n\t\tconst instance = new EditForm(params);\n\t\tinstance.openInSlider();\n\n\t\treturn instance;\n\t}\n\n\topenInSlider()\n\t{\n\t\tconst sidePanelId = `tasks-flow-create-slider-${Text.getRandom()}`;\n\n\t\tBX.SidePanel.Instance.open(sidePanelId, {\n\t\t\tcacheable: true,\n\t\t\tcontentCallback: (slider) => {\n\t\t\t\treturn Layout.createContent({\n\t\t\t\t\textensions: ['tasks.flow.edit-form'],\n\t\t\t\t\tdesign: { section: false },\n\t\t\t\t\tcontent: async () => {\n\t\t\t\t\t\tthis.slider = slider;\n\n\t\t\t\t\t\tconst {data: noAccess} = await ajax.runAction('tasks.flow.View.Access.check', {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tflowId: this.#flow.id > 0 ? this.#flow.id : 0,\n\t\t\t\t\t\t\t\tcontext: 'edit-form',\n\t\t\t\t\t\t\t\tdemoFlow: this.#params.demoFlow,\n\t\t\t\t\t\t\t\tguideFlow: this.#params.guideFlow,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (noAccess !== null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn Tag.render`${noAccess.html}`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.#flow.id > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst { data: flowData, error } = await ajax.runAction('tasks.flow.Flow.get', {\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tflowId: this.#flow.id,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.#flow = this.#getFlow(flowData);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.#pages.forEach((page) => page.setFlow(this.#flow));\n\n\t\t\t\t\t\treturn this.#render();\n\t\t\t\t\t},\n\t\t\t\t\tbuttons: [],\n\t\t\t\t});\n\t\t\t},\n\t\t\twidth: SLIDER_WIDTH,\n\t\t\tevents: {\n\t\t\t\tonLoad: (event) => {\n\t\t\t\t\tconst aboutPage = this.#pages\n\t\t\t\t\t\t.find((page) => page.getId() === 'about-flow')\n\t\t\t\t\t;\n\t\t\t\t\taboutPage.focusToEmptyName();\n\n\t\t\t\t\tthis.#hintManager = top.BX.UI.Hint.createInstance({\n\t\t\t\t\t\tid: sidePanelId,\n\t\t\t\t\t\tpopupParameters: {\n\t\t\t\t\t\t\ttargetContainer: window.top.document.body,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tthis.#hintManager.init(event.slider.getContainer());\n\t\t\t\t},\n\t\t\t\tonClose: () => {\n\t\t\t\t\tthis.#hintManager.hide();\n\t\t\t\t\tthis.emit('afterClose');\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#render()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create\">\n\t\t\t\t${this.#renderHeader()}\n\t\t\t\t${this.#renderWizard()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderHeader(): HTMLElement\n\t{\n\t\tconst title = (\n\t\t\tLoc.getMessage(this.#flow.id\n\t\t\t\t? 'TASKS_FLOW_EDIT_FORM_HEADER_TITLE_EDIT'\n\t\t\t\t: 'TASKS_FLOW_EDIT_FORM_HEADER_TITLE')\n\t\t);\n\n\t\tconst subTitle = (\n\t\t\tLoc.getMessage(this.#flow.id\n\t\t\t\t? 'TASKS_FLOW_EDIT_FORM_HEADER_SUBTITLE'\n\t\t\t\t: 'TASKS_FLOW_EDIT_FORM_HEADER_SUBTITLE_CREATE')\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-slider-section ui-slider-section-icon-center --rounding --icon-sm\">\n\t\t\t\t<span class=\"tasks-flow__create-header_icon ui-icon ui-slider-icon\"></span>\n\t\t\t\t<div class=\"ui-slider-content-box\">\n\t\t\t\t\t<div class=\"ui-slider-heading-2\">${title}</div>\n\t\t\t\t\t<div class=\"ui-slider-inner-box\">\n\t\t\t\t\t\t<p class=\"ui-slider-paragraph-2\">\n\t\t\t\t\t\t\t${subTitle}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderWizard(): HTMLElement\n\t{\n\t\tthis.#wizard = new Wizard({\n\t\t\tsteps: this.#pages.map((page) => ({\n\t\t\t\tid: page.getId(),\n\t\t\t\ttitle: page.getTitle(),\n\t\t\t\tcontent: page.render(),\n\t\t\t\tisFilled: () => !this.#hasIncorrectData(page.getRequiredData()),\n\t\t\t})),\n\t\t\tonCancel: () => this.slider.close(false, () => this.slider.destroy()),\n\t\t\tonDisabledContinueButtonClick: this.#showErrors.bind(this),\n\t\t\tonContinueHandler: this.#onContinueHandler.bind(this),\n\t\t\tfinishButton: this.#getFinishButton(),\n\t\t\tsaveChangesButton: this.#getSaveChangesButton(),\n\t\t\tarticle: HELPDESK_ARTICLE,\n\t\t});\n\n\t\treturn this.#wizard.render();\n\t}\n\n\t#saveChangesAction(): ?Function\n\t{\n\t\tconst isEdit = this.#flow.id > 0;\n\n\t\tif (!isEdit || this.#flow.demo)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#saveFlowAction();\n\t}\n\n\t#getFinishButton(): Button\n\t{\n\t\tthis.#finishButton ??= new Button({\n\t\t\ttext: Loc.getMessage(this.#flow.id ? 'TASKS_FLOW_EDIT_FORM_SAVE_FLOW' : 'TASKS_FLOW_EDIT_FORM_CREATE_FLOW'),\n\t\t\tcolor: Button.Color.PRIMARY,\n\t\t\tround: true,\n\t\t\tsize: Button.Size.LARGE,\n\t\t\tonclick: () => this.#saveFlowAction(),\n\t\t});\n\n\t\treturn this.#finishButton;\n\t}\n\n\t#getSaveChangesButton(): ?Button\n\t{\n\t\tif (!this.#flow.id || this.#flow.demo)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.#saveChangesButton ??= new Button({\n\t\t\ttext: Loc.getMessage('TASKS_FLOW_EDIT_FORM_SAVE_CHANGES'),\n\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\tround: true,\n\t\t\tsize: BX.UI.Button.Size.LARGE,\n\t\t\tonclick: () => this.#saveChangesAction(),\n\t\t});\n\n\t\treturn this.#saveChangesButton;\n\t}\n\n\t#onChangeHandler(): void\n\t{\n\t\tthis.#flow = this.#getFlow();\n\t\tthis.#pages.forEach((page) => page.update());\n\t\tthis.#wizard.update();\n\t}\n\n\t#saveFlowAction(): void\n\t{\n\t\tif (this.#hasIncorrectData())\n\t\t{\n\t\t\tthis.#showErrors();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#saveChangesButton?.isDisabled() || this.#finishButton?.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#saveChangesButton?.setState(ButtonState.DISABLED);\n\t\tthis.#finishButton?.setState(ButtonState.DISABLED);\n\n\t\tconst flowData = Object.fromEntries(Object.entries(this.#getFlow()).map(([key, value]) => [\n\t\t\tkey,\n\t\t\tType.isBoolean(value) ? (value ? 1 : 0) : value,\n\t\t]));\n\n\t\tconst action = flowData.id ? 'update' : 'create';\n\t\tconst textNotification = flowData.id ? 'TASKS_FLOW_EDIT_FORM_FLOW_UPDATE' : 'TASKS_FLOW_EDIT_FORM_FLOW_CREATE';\n\n\t\tajax.runAction(\n\t\t\t`tasks.flow.Flow.${flowData.demo ? 'activateDemo' : action}`,\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tflowData,\n\t\t\t\t\tguideFlow: this.#params.guideFlow,\n\t\t\t\t},\n\t\t\t},\n\t\t).then((response) => {\n\t\t\tif (response.status === 'success')\n\t\t\t{\n\t\t\t\tconst flowData: Flow = response.data;\n\n\t\t\t\tthis.emit('afterSave', flowData);\n\n\t\t\t\tthis.slider.close(false, () => {\n\t\t\t\t\tif (flowData.trialFeatureEnabled)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#showDemoInfo();\n\t\t\t\t\t}\n\t\t\t\t\tthis.slider.destroy();\n\t\t\t\t});\n\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage(textNotification),\n\t\t\t\t\twidth: 'auto',\n\t\t\t\t});\n\t\t\t}\n\t\t}, (error) => {\n\t\t\t\tthis.#saveChangesButton?.setState(null);\n\t\t\t\tthis.#finishButton?.setState(null);\n\t\t\t\talert(error.errors.map((e) => e.message).join('\\n'))\n\t\t\t}\n\t\t);\n\t}\n\n\t#showErrors(): void\n\t{\n\t\tconst incorrectData = this.#getIncorrectData();\n\t\tthis.#pages.forEach((page) => page.showErrors(incorrectData));\n\t}\n\n\t#showDemoInfo(): void\n\t{\n\t\tconst popup: Popup = new Popup({\n\t\t\tid: 'tasks-flow-task-demo-info',\n\t\t\tclassName: 'tasks-flow__task-demo-info',\n\t\t\twidth: 620,\n\t\t\toverlay: true,\n\t\t\tpadding: 48,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: this.#renderDemoInfoContent(),\n\t\t\tevents: {\n\t\t\t\tonFirstShow: (baseEvent: BaseEvent) => {\n\t\t\t\t\tthis.#bindStartWorkBtn(baseEvent.getTarget());\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\t#renderDemoInfoContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__task-demo-info_wrapper\">\n\t\t\t\t<div class=\"tasks-flow__task-demo-info_content\">\n\t\t\t\t\t<div class=\"tasks-flow__task-demo-info_title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-flow__task-demo-info_text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_TEXT')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-flow__task-demo-info_text-trial\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_TEXT_TRIAL')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-primary ui-btn-round ui-btn-no-caps\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_BTN')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#getLottieIconContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getLottieIconContainer(): HTMLElement\n\t{\n\t\tif (!this.#lottieIconContainer)\n\t\t{\n\t\t\tthis.#lottieIconContainer = Tag.render`\n\t\t\t\t<div class=\"tasks-flow__task-demo-info_image\"></div>\n\t\t\t`;\n\n\t\t\tthis.#flowLottieAnimation = Lottie.loadAnimation({\n\t\t\t\tcontainer: this.#lottieIconContainer,\n\t\t\t\trenderer: 'svg',\n\t\t\t\tloop: false,\n\t\t\t\tanimationData: flowfLottieIconInfo,\n\t\t\t});\n\t\t}\n\n\t\treturn this.#lottieIconContainer;\n\t}\n\n\t#bindStartWorkBtn(popup: Popup)\n\t{\n\t\tconst popupContainer = popup.getContentContainer();\n\t\tif (Type.isDomNode(popupContainer))\n\t\t{\n\t\t\tconst btnNode = popup.getContentContainer().querySelector('.ui-btn');\n\t\t\tif (Type.isDomNode(popupContainer))\n\t\t\t{\n\t\t\t\tEvent.bind(btnNode, 'click', () => popup.close());\n\t\t\t}\n\t\t}\n\t}\n\n\t#hasIncorrectData(fields: string[] = []): boolean\n\t{\n\t\tconst incorrectData = this.#getIncorrectData();\n\n\t\tfor (const field of fields)\n\t\t{\n\t\t\tif (incorrectData.includes(field))\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn !Type.isArrayFilled(fields) && Type.isArrayFilled(incorrectData);\n\t}\n\n\t#getIncorrectData(): string[]\n\t{\n\t\tconst flowData = this.#flow;\n\n\t\tconst incorrectData = [];\n\t\tif (!Type.isStringFilled(flowData.name))\n\t\t{\n\t\t\tincorrectData.push('name');\n\t\t}\n\n\t\tif (flowData.plannedCompletionTime <= 0)\n\t\t{\n\t\t\tincorrectData.push('plannedCompletionTime');\n\t\t}\n\n\t\tif (!Type.isArrayFilled(flowData.taskCreators))\n\t\t{\n\t\t\tincorrectData.push('taskCreators');\n\t\t}\n\n\t\tif (flowData.distributionType === 'manually' && flowData.manualDistributorId <= 0)\n\t\t{\n\t\t\tincorrectData.push('manualDistributorId');\n\t\t}\n\n\t\tif (flowData.distributionType === 'queue' && !Type.isArrayFilled(flowData.responsibleQueue))\n\t\t{\n\t\t\tincorrectData.push('responsibleQueue');\n\t\t}\n\n\t\tif (flowData.id > 0 && flowData.groupId <= 0 && flowData.demo === false)\n\t\t{\n\t\t\tincorrectData.push('groupId');\n\t\t}\n\n\t\tif (!Type.isNumber(flowData.templateId))\n\t\t{\n\t\t\tincorrectData.push('templateId');\n\t\t}\n\n\t\tif (flowData.id > 0 && flowData.ownerId <= 0 && flowData.demo === false)\n\t\t{\n\t\t\tincorrectData.push('ownerId');\n\t\t}\n\n\t\tif (Type.isNumber(flowData.notifyOnQueueOverflow) && flowData.notifyOnQueueOverflow <= 0)\n\t\t{\n\t\t\tincorrectData.push('notifyOnQueueOverflow');\n\t\t}\n\n\t\tif (Type.isNumber(flowData.notifyOnTasksInProgressOverflow) && flowData.notifyOnTasksInProgressOverflow <= 0)\n\t\t{\n\t\t\tincorrectData.push('notifyOnTasksInProgressOverflow');\n\t\t}\n\n\t\tif (\n\t\t\tType.isNumber(flowData.notifyWhenEfficiencyDecreases)\n\t\t\t&& (\n\t\t\t\tflowData.notifyWhenEfficiencyDecreases <= 0\n\t\t\t\t|| flowData.notifyWhenEfficiencyDecreases > 100\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tincorrectData.push('notifyWhenEfficiencyDecreases');\n\t\t}\n\n\t\treturn incorrectData;\n\t}\n\n\t#getFlow(flowData: Flow = {}): Flow\n\t{\n\t\treturn {\n\t\t\tid: this.#params.flowId,\n\t\t\tdemo: ('demo' in flowData) ? flowData.demo === true : this.#flow?.demo === true,\n\t\t\t...this.#pages.reduce((fields, page) => ({ ...fields, ...page.getFields(flowData) }), {}),\n\t\t};\n\t}\n\n\t#onContinueHandler(): Promise<boolean>\n\t{\n\t\tif (this.#pageChanging === true)\n\t\t{\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\tthis.#pageChanging = true;\n\n\t\tconst stepId = this.#wizard.getCurrentStep().id;\n\t\tconst currentPage = this.#pages.find((page) => page.getId() === stepId);\n\n\t\treturn currentPage?.onContinueClick(this.#flow)\n\t\t\t.then((canContinue: Boolean) => {\n\t\t\t\tthis.#pageChanging = false;\n\n\t\t\t\treturn canContinue;\n\t\t\t})\n\t\t;\n\t}\n}\n"],"names":["FormPage","getId","getTitle","setFlow","flow","render","getFields","flowData","getRequiredData","update","cleanErrors","showErrors","incorrectData","onContinueClick","Promise","resolve","ValueChecker","constructor","params","entitySelector","value","getPreselectedItems","isChecked","checker","getValue","entitySelectorValue","id","checkerValue","placeholder","setErrors","errors","cleanError","getInputNode","wrap","Tag","observer","IntersectionObserver","offsetWidth","disconnect","observe","closest","dispatchEvent","window","Event","Dom","addClass","removeClass","innerText","title","text","Loc","getMessage","disabledValue","style","width","checkerField","querySelector","height","offsetHeight","Checker","checked","hideSeparator","size","subscribe","baseEvent","getData","length","focus","setSelectionRange","unit","bind","setTargetNode","show","hide","getSelectedItems","BindFilterNumberInput","input","dispatchedProgrammatically","addEventListener","textBeforeCursor","selectionStart","slice","normalizedValue","replace","parseInt","Math","max","min","firstPart","lastCharacter","matches","match","formattedPosition","indexOf","bindFilterNumberInput","AboutPage","includes","flowName","plannedCompletionTime","taskCreatorsSelector","plannedCompletionTimeValue","intervalDuration","plannedCompletionTimeIntervalSelector","getDuration","name","trim","description","flowDescription","taskCreators","matchWorkTime","skipWeekends","TextInput","label","TextArea","resizeOnlyY","UserSelector","enableDepartments","values","aboutPageForm","onChangeHandler","focusToEmptyName","isEmpty","data","response","ajax","runAction","exists","getSelector","getTags","map","tag","entityId","Type","isUndefined","getDialog","IntervalSelector","duration","plannedCompletionTimeLabel","inputDefaultWidth","String","maxInt","monthDuration","floor","root","PullRequests","EventEmitter","userId","setEventNamespace","getModuleId","getMap","template_add","template_update","emit","template","TEMPLATE_ID","TEMPLATE_TITLE","SettingsPage","requiredData","distributionType","taskTemplate","push","queueDistribution","manuallyDistribution","himselfDistribution","queueRadio","manuallyRadio","responsiblesSelector","moderatorSelector","projectSelector","responsibleQueue","isLoaded","manualDistributorId","groupId","FormData","settingsPageForm","get","responsibleCanChangeDeadline","notifyAtHalfTime","taskControl","templateId","notifyAtHalfTimeTitle","enableUsers","multiple","entities","options","features","tasks","checkFeatureForCreate","settings","Extension","getSettings","currentUser","pullRequests","Pull","templateItem","tabs","taskTemplateDialog","addItem","getItems","find","item","select","getItem","isStringFilled","setTitle","isArrayFilled","enableAll","responsibleId","radio","type","selector","himselfRadio","toUpperCase","Dialog","context","preselectedItems","enableSearch","notifyEmptyProject","ControlPage","filter","flowOwnerSelector","forEach","ownerId","notifyOnQueueOverflow","notifyOnTasksInProgressOverflow","notifyWhenEfficiencyDecreases","flowOwnerLabel","analyticsPermissionsSelector","className","controlPageForm","test","SLIDER_WIDTH","HELPDESK_ARTICLE","EditForm","initFlowData","createInstance","instance","openInSlider","sidePanelId","Text","getRandom","BX","SidePanel","Instance","open","cacheable","contentCallback","slider","Layout","createContent","extensions","design","section","content","noAccess","flowId","demoFlow","guideFlow","html","error","page","buttons","events","onLoad","event","aboutPage","top","UI","Hint","popupParameters","targetContainer","document","body","init","getContainer","onClose","subTitle","Wizard","steps","isFilled","onCancel","close","destroy","onDisabledContinueButtonClick","onContinueHandler","finishButton","saveChangesButton","article","isEdit","demo","Button","color","Color","PRIMARY","round","Size","LARGE","onclick","SUCCESS","isDisabled","setState","ButtonState","DISABLED","Object","fromEntries","entries","key","isBoolean","action","textNotification","then","status","trialFeatureEnabled","Notification","Center","notify","alert","e","message","join","popup","Popup","overlay","padding","closeIcon","onFirstShow","getTarget","Lottie","loadAnimation","container","renderer","loop","animationData","flowfLottieIconInfo","popupContainer","getContentContainer","isDomNode","btnNode","fields","field","isNumber","reduce","stepId","getCurrentStep","currentPage","canContinue"],"mappings":"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"}