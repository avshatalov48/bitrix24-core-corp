this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,s,a,l,t){"use strict";var i=babelHelpers.classPrivateFieldLooseKey("flowId");var r=babelHelpers.classPrivateFieldLooseKey("pageSize");var o=babelHelpers.classPrivateFieldLooseKey("pageNum");var b=babelHelpers.classPrivateFieldLooseKey("pages");var p=babelHelpers.classPrivateFieldLooseKey("consoleError");class d{constructor(e){Object.defineProperty(this,p,{value:c});Object.defineProperty(this,i,{writable:true,value:void 0});Object.defineProperty(this,r,{writable:true,value:10});Object.defineProperty(this,o,{writable:true,value:1});Object.defineProperty(this,b,{writable:true,value:{}});babelHelpers.classPrivateFieldLooseBase(this,i)[i]=e}async get(){if(babelHelpers.classPrivateFieldLooseBase(this,b)[b][babelHelpers.classPrivateFieldLooseBase(this,o)[o]]){return{page:[],members:Object.values(babelHelpers.classPrivateFieldLooseBase(this,b)[b]).flat()}}const{data:e,error:s}=await t.ajax.runAction("tasks.flow.Assignee.list",{data:{flowData:{id:babelHelpers.classPrivateFieldLooseBase(this,i)[i]}},navigation:{page:babelHelpers.classPrivateFieldLooseBase(this,o)[o],size:babelHelpers.classPrivateFieldLooseBase(this,r)[r]}}).catch((e=>({data:[],error:e.errors[0]})));if(s){babelHelpers.classPrivateFieldLooseBase(this,p)[p]("getList",s)}const a=e;babelHelpers.classPrivateFieldLooseBase(this,b)[b][babelHelpers.classPrivateFieldLooseBase(this,o)[o]]=a;if(a.length>=babelHelpers.classPrivateFieldLooseBase(this,r)[r]){babelHelpers.classPrivateFieldLooseBase(this,o)[o]++}return{page:a,members:Object.values(babelHelpers.classPrivateFieldLooseBase(this,b)[b]).flat()}}}function c(e,s){console.error(`TeamPopup: ${e} error`,s)}let n=e=>e,v,P,h;var u=babelHelpers.classPrivateFieldLooseKey("data");var L=babelHelpers.classPrivateFieldLooseKey("renderIcon");var F=babelHelpers.classPrivateFieldLooseKey("renderWorkPosition");class H{constructor(e){Object.defineProperty(this,F,{value:B});Object.defineProperty(this,L,{value:m});Object.defineProperty(this,u,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,u)[u]=e}render(){return t.Tag.render(v||(v=n`
			<div class="tasks-flow__team-popup_member" data-id="tasks-flow-team-popup-member-${0}">
				${0}
				<div class="tasks-flow__team-popup_member-name-content">
					<a class="tasks-flow__team-popup_member-name" href="${0}">
						${0}
					</a>
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,u)[u].id,babelHelpers.classPrivateFieldLooseBase(this,L)[L](),t.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,u)[u].pathToProfile),t.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,u)[u].name),babelHelpers.classPrivateFieldLooseBase(this,F)[F]())}}function m(){let e="<i></i>";if(t.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,u)[u].avatar)){e=`<i style="background-image: url('${encodeURI(babelHelpers.classPrivateFieldLooseBase(this,u)[u].avatar)}')"></i>`}return t.Tag.render(P||(P=n`
			<a href="${0}">
				<div class="tasks-flow__team-popup_member-avatar ui-icon ui-icon-common-user">
					${0}
				</div>
			</a>
		`),t.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,u)[u].pathToProfile),e)}function B(){if(!t.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,u)[u].workPosition)){return""}return t.Tag.render(h||(h=n`
			<span class="tasks-flow__team-popup_member-position">
				${0}
			</span>
		`),t.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,u)[u].workPosition))}let f=e=>e,w,y;var _=babelHelpers.classPrivateFieldLooseKey("params");var g=babelHelpers.classPrivateFieldLooseKey("layout");var k=babelHelpers.classPrivateFieldLooseKey("teamAjax");var T=babelHelpers.classPrivateFieldLooseKey("members");var j=babelHelpers.classPrivateFieldLooseKey("load");var O=babelHelpers.classPrivateFieldLooseKey("render");var K=babelHelpers.classPrivateFieldLooseKey("renderMembers");var $=babelHelpers.classPrivateFieldLooseKey("showLoader");var I=babelHelpers.classPrivateFieldLooseKey("destroyLoader");class X{constructor(e){Object.defineProperty(this,I,{value:A});Object.defineProperty(this,$,{value:S});Object.defineProperty(this,K,{value:M});Object.defineProperty(this,O,{value:E});Object.defineProperty(this,j,{value:x});Object.defineProperty(this,_,{writable:true,value:void 0});Object.defineProperty(this,g,{writable:true,value:void 0});Object.defineProperty(this,k,{writable:true,value:void 0});Object.defineProperty(this,T,{writable:true,value:[]});babelHelpers.classPrivateFieldLooseBase(this,_)[_]=e;babelHelpers.classPrivateFieldLooseBase(this,g)[g]={};babelHelpers.classPrivateFieldLooseBase(this,k)[k]=new d(babelHelpers.classPrivateFieldLooseBase(this,_)[_].flowId);void babelHelpers.classPrivateFieldLooseBase(this,j)[j]()}static showInstance(e){this.getInstance(e).show(e.bindElement)}static getInstance(e){var s,a,l;(l=(s=this.instances)[a=e.flowId])!=null?l:s[a]=new this(e);return this.instances[e.flowId]}show(e){const s=this.getPopup();s.setContent(babelHelpers.classPrivateFieldLooseBase(this,O)[O]());s.setBindElement(e);s.show()}getPopup(){const e=`tasks-flow-team-popup-${babelHelpers.classPrivateFieldLooseBase(this,_)[_].flowId}`;if(a.PopupManager.getPopupById(e)){return a.PopupManager.getPopupById(e)}const s=new a.Popup({id:e,className:"tasks-flow__team-popup",width:200,padding:2,autoHide:true,closeByEsc:true,events:{onShow:()=>{if(babelHelpers.classPrivateFieldLooseBase(this,g)[g].loader){babelHelpers.classPrivateFieldLooseBase(this,$)[$]()}}}});new l.SidePanelIntegration(s);return s}}async function x(){if(babelHelpers.classPrivateFieldLooseBase(this,g)[g].loader){return}babelHelpers.classPrivateFieldLooseBase(this,$)[$]();const{members:e,page:s}=await babelHelpers.classPrivateFieldLooseBase(this,k)[k].get();babelHelpers.classPrivateFieldLooseBase(this,T)[T]=e;s.forEach((e=>t.Dom.append(new H(e).render(),babelHelpers.classPrivateFieldLooseBase(this,g)[g].members)));babelHelpers.classPrivateFieldLooseBase(this,I)[I]()}function E(){babelHelpers.classPrivateFieldLooseBase(this,g)[g].wrap=t.Tag.render(w||(w=f`
			<div class="tasks-flow__team-popup_container">
				<div class="tasks-flow__team-popup_content">
					<div class="tasks-flow__team-popup_content-box">
						<span class="tasks-flow__team-popup_label">
							<span class="tasks-flow__team-popup_label-text">
								${0}
							</span>
						</span>
						${0}
					</div>
				</div>
			</div>
		`),t.Loc.getMessage("TASKS_FLOW_TEAM_POPUP_LABEL"),babelHelpers.classPrivateFieldLooseBase(this,K)[K]());return babelHelpers.classPrivateFieldLooseBase(this,g)[g].wrap}function M(){babelHelpers.classPrivateFieldLooseBase(this,g)[g].members=t.Tag.render(y||(y=f`
			<div class="tasks-flow__team-popup_members">
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,T)[T].map((e=>new H(e).render())));t.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,g)[g].members,"scroll",(()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,g)[g].members.scrollTop;const s=babelHelpers.classPrivateFieldLooseBase(this,g)[g].members.scrollHeight-babelHelpers.classPrivateFieldLooseBase(this,g)[g].members.offsetHeight;if(Math.abs(e-s)<1){void babelHelpers.classPrivateFieldLooseBase(this,j)[j]()}}));return babelHelpers.classPrivateFieldLooseBase(this,g)[g].members}function S(){babelHelpers.classPrivateFieldLooseBase(this,I)[I]();const e=t.Dom.getPosition(babelHelpers.classPrivateFieldLooseBase(this,g)[g].members);const a=40;babelHelpers.classPrivateFieldLooseBase(this,g)[g].loader=new s.Loader({target:babelHelpers.classPrivateFieldLooseBase(this,g)[g].members,size:a,mode:"inline",offset:{left:`${e.width/2-a/2}px`}});void babelHelpers.classPrivateFieldLooseBase(this,g)[g].loader.show()}function A(){var e;(e=babelHelpers.classPrivateFieldLooseBase(this,g)[g].loader)==null?void 0:e.destroy();babelHelpers.classPrivateFieldLooseBase(this,g)[g].loader=null}X.instances={};e.TeamPopup=X})(this.BX.Tasks.Flow=this.BX.Tasks.Flow||{},BX,BX.Main,BX.Tasks,BX);
//# sourceMappingURL=team-popup.bundle.map.js