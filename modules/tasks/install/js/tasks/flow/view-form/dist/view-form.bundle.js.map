{"version":3,"file":"view-form.bundle.js","sources":["../src/layout/segment-button.js","../src/view-ajax.js","../src/similar-flows.js","../src/view-form.js"],"sourcesContent":["import { Dom, Event, Tag } from 'main.core';\n\ntype Segment = {\n\tid: string,\n\ttitle: string,\n\tisActive: boolean,\n\tnode: HTMLElement,\n};\n\ntype Params = {\n\tsegments: Segment[],\n\tonSegmentSelected: function,\n};\n\nexport class SegmentButton\n{\n\t#params: Params;\n\t#segments: Segment[];\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\n\t\tthis.#segments = params.segments;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__segment-button\">\n\t\t\t\t${this.#segments.map((segment) => this.#renderSegment(segment))}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderSegment(segment: Segment): HTMLElement\n\t{\n\t\tsegment.node = Tag.render`\n\t\t\t<div class=\"tasks-flow__segment-button-segment ${segment.isActive ? '--active' : ''}\">\n\t\t\t\t${segment.title}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(segment.node, 'click', () => this.#selectSegment(segment));\n\n\t\treturn segment.node;\n\t}\n\n\t#selectSegment(selectedSegment: Segment)\n\t{\n\t\tthis.#segments.forEach((segment) => {\n\t\t\tDom.removeClass(segment.node, '--active');\n\n\t\t\tif (segment.id === selectedSegment.id)\n\t\t\t{\n\t\t\t\tDom.addClass(segment.node, '--active');\n\t\t\t}\n\t\t});\n\n\t\tthis.#params.onSegmentSelected(selectedSegment);\n\t}\n}","import { ajax } from 'main.core';\n\nexport type Entity = {\n\tname: string,\n\tavatar: string,\n\turl: string,\n};\n\nexport type FlowFormData = {\n\tflow: {\n\t\tname: string,\n\t\tdescription: string,\n\t\tefficiency: number,\n\t\tdemo: boolean,\n\t},\n\tteam: Entity[],\n\tteamCount: number,\n\tcreator: Entity,\n\towner: Entity,\n\tproject: Entity,\n};\n\nexport type SimilarFlow = {\n\tid: number,\n\tname: string,\n\tcreateTaskUri: string,\n};\n\nexport class ViewAjax\n{\n\t#flowId: number;\n\t#pageSize: number = 7;\n\t#pageNum: number = 1;\n\t#pages: { [key: number]: SimilarFlow[] } = {};\n\n\tconstructor(flowId: number)\n\t{\n\t\tthis.#flowId = flowId;\n\t}\n\n\tasync getViewFormData(): Promise\n\t{\n\t\tconst { data } = await ajax.runAction('tasks.flow.View.Flow.get', {\n\t\t\tdata: {\n\t\t\t\tflowId: this.#flowId,\n\t\t\t},\n\t\t});\n\n\t\treturn {\n\t\t\tflow: data.flow,\n\t\t\tteam: data.team.map((member) => this.#convertUserToEntity(member)),\n\t\t\tteamCount: data.teamCount,\n\t\t\towner: this.#convertUserToEntity(data.owner),\n\t\t\tcreator: this.#convertUserToEntity(data.creator),\n\t\t\tproject: data.project,\n\t\t};\n\t}\n\n\t#convertUserToEntity(user: any): Entity\n\t{\n\t\treturn {\n\t\t\tname: user.name,\n\t\t\tavatar: user.avatar,\n\t\t\turl: user.pathToProfile,\n\t\t};\n\t}\n\n\tasync getSimilarFlows(): Promise<SimilarFlow[]>\n\t{\n\t\tif (this.#pages[this.#pageNum])\n\t\t{\n\t\t\treturn {\n\t\t\t\tpage: [],\n\t\t\t\tsimilarFlows: Object.values(this.#pages).flat(),\n\t\t\t};\n\t\t}\n\n\t\tconst { data: page } = await ajax.runAction('tasks.flow.View.SimilarFlow.list', {\n\t\t\tdata: {\n\t\t\t\tflowId: this.#flowId,\n\t\t\t},\n\t\t\tnavigation: {\n\t\t\t\tpage: this.#pageNum,\n\t\t\t\tsize: this.#pageSize,\n\t\t\t},\n\t\t});\n\n\t\tthis.#pages[this.#pageNum] = page;\n\n\t\tif (page.length >= this.#pageSize)\n\t\t{\n\t\t\tthis.#pageNum++;\n\t\t}\n\n\t\treturn {\n\t\t\tpage,\n\t\t\tsimilarFlows: Object.values(this.#pages).flat(),\n\t\t};\n\t}\n}","import { Dom, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { Loader } from 'main.loader';\nimport { Button } from 'ui.buttons';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { ViewAjax } from './view-ajax';\nimport type { SimilarFlow } from './view-ajax';\n\ntype Params = {\n\tflowId: number,\n\tcreateTaskButtonClickHandler: ?Function,\n\tisFeatureEnabled: boolean,\n};\n\nexport class SimilarFlows\n{\n\t#flowId: number;\n\t#viewAjax: ViewAjax;\n\t#createTaskButtonClickHandler: Function;\n\t#similarFlows: SimilarFlow[] = [];\n\t#layout: {\n\t\twrap: HTMLElement,\n\t\temptyState: HTMLElement,\n\t};\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#flowId = params.flowId;\n\t\tthis.#layout = {};\n\n\t\tthis.isFeatureEnabled = params.isFeatureEnabled;\n\n\t\tthis.#viewAjax = new ViewAjax(params.flowId);\n\t\tthis.#createTaskButtonClickHandler = params.createTaskButtonClickHandler ?? null;\n\t}\n\n\tasync #load(): Promise\n\t{\n\t\tthis.#layout.emptyState?.remove();\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.#layout.wrap,\n\t\t\tsize: 60,\n\t\t});\n\n\t\tvoid loader.show();\n\n\t\tconst { page, similarFlows } = await this.#viewAjax.getSimilarFlows();\n\n\t\tconst isFirstPageLoaded = !Type.isArrayFilled(this.#similarFlows) && Type.isArrayFilled(similarFlows);\n\t\tif (isFirstPageLoaded)\n\t\t{\n\t\t\tDom.append(this.#renderSimilarFlowsListTitle(), this.#layout.wrap);\n\t\t}\n\n\t\tthis.#similarFlows = similarFlows;\n\n\t\tpage.forEach((data: SimilarFlow) => Dom.append(this.#renderSimilarFlow(data), this.#layout.wrap));\n\n\t\tif (!Type.isArrayFilled(this.#similarFlows))\n\t\t{\n\t\t\tDom.append(this.#renderEmptyState(), this.#layout.wrap);\n\t\t}\n\n\t\tloader.destroy();\n\t}\n\n\tshow()\n\t{\n\t\tDom.style(this.#layout.wrap, 'display', '');\n\n\t\tif (!Type.isArrayFilled(this.#similarFlows))\n\t\t{\n\t\t\tDom.style(this.#layout.wrap, 'overflow', 'hidden');\n\t\t\tthis.#load().then(() => Dom.style(this.#layout.wrap, 'overflow', ''));\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tDom.style(this.#layout.wrap, 'display', 'none');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.wrap = Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form_similar-flows\">\n\t\t\t\t${this.#similarFlows.map((flow: SimilarFlow) => this.#renderSimilarFlow(flow))}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.wrap, 'scroll', () => {\n\t\t\tconst scrollTop = this.#layout.wrap.scrollTop;\n\t\t\tconst maxScroll = this.#layout.wrap.scrollHeight - this.#layout.wrap.offsetHeight;\n\n\t\t\tif (Math.abs(scrollTop - maxScroll) < 1)\n\t\t\t{\n\t\t\t\tvoid this.#load();\n\t\t\t}\n\t\t});\n\n\t\treturn this.#layout.wrap;\n\t}\n\n\t#renderSimilarFlowsListTitle(): ?HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form_similar-flows-title\">\n\t\t\t\t${Loc.getMessage('TASKS_FLOW_VIEW_FORM_SIMILAR_FLOWS_TITLE')}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderSimilarFlow(flow: SimilarFlow): HTMLElement\n\t{\n\t\tconst button = new Button({\n\t\t\tcolor: Button.Color.SECONDARY_LIGHT,\n\t\t\tsize: Button.Size.EXTRA_SMALL,\n\t\t\tround: true,\n\t\t\ttext: Loc.getMessage('TASKS_FLOW_VIEW_FORM_CREATE_TASK'),\n\t\t\tnoCaps: true,\n\t\t\tonclick: () => {\n\t\t\t\tthis.#createTaskButtonClickHandler?.();\n\t\t\t\tif (this.isFeatureEnabled)\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.open(flow.createTaskUri);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tFeaturePromotersRegistry.getPromoter({ code: 'limit_tasks_flows' }).show();\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form_similar-flow\">\n\t\t\t\t<div class=\"tasks-flow__view-form_similar-flow-name\" title=\"${Text.encode(flow.name)}\">\n\t\t\t\t\t${Text.encode(flow.name)}\n\t\t\t\t</div>\n\t\t\t\t${button.render()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderEmptyState()\n\t{\n\t\tthis.#layout.emptyState = Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form_similar-flows-empty-state\">\n\t\t\t\t<div class=\"tasks-flow__view-form_similar-flows-empty-state-icon\"></div>\n\t\t\t\t<div class=\"tasks-flow__view-form_similar-flows-empty-state-text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_VIEW_FORM_NO_SIMILAR_FLOWS')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.emptyState;\n\t}\n}\n","import { Dom, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Loader } from 'main.loader';\nimport { Popup, PopupManager } from 'main.popup';\nimport { TeamPopup } from 'tasks.flow.team-popup';\nimport { SidePanelIntegration } from 'tasks.side-panel-integration';\nimport { Label, LabelColor, LabelSize } from 'ui.label';\nimport { SegmentButton } from './layout/segment-button';\nimport { ViewAjax } from './view-ajax';\nimport { SimilarFlows } from './similar-flows';\nimport type { Entity, FlowFormData } from './view-ajax';\nimport 'ui.notification';\n\nimport './style.css';\n\ntype Params = {\n\tflowId: number,\n\tbindElement: HTMLElement,\n\tisFeatureEnabled: 'Y' | 'N',\n\tflowUrl: string,\n};\n\nexport class ViewForm\n{\n\tstatic instances = {};\n\n\t#params: Params;\n\t#layout: {\n\t\tpopup: Popup,\n\t\tteamPopup: Popup,\n\t\tdetails: HTMLElement,\n\t\tteamNode: HTMLElement,\n\t\tshowTeamButton: HTMLElement,\n\t\tsimilarFlows: SimilarFlows,\n\t};\n\n\t#notificationList: Set = new Set();\n\n\t#viewAjax: ViewAjax;\n\n\t#selectedSegment: string;\n\n\t#viewFormData: FlowFormData;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\n\t\tthis.#viewAjax = new ViewAjax(this.#params.flowId);\n\n\t\tthis.isFeatureEnabled = params.isFeatureEnabled === 'Y';\n\t\tthis.flowUrl = params.flowUrl;\n\n\t\tvoid this.#load();\n\t\tthis.#subscribeEvents();\n\t}\n\n\tstatic showInstance(params: Params): void\n\t{\n\t\tthis.getInstance(params).show(params.bindElement);\n\t}\n\n\tstatic getInstance(params: Params): this\n\t{\n\t\tthis.instances[params.flowId] ??= new this(params);\n\n\t\treturn this.instances[params.flowId];\n\t}\n\n\tstatic removeInstance(flowId: number): void\n\t{\n\t\tif (Object.hasOwn(this.instances, flowId))\n\t\t{\n\t\t\tdelete this.instances[flowId];\n\t\t}\n\t}\n\n\t#subscribeEvents(): void\n\t{\n\t\tEventEmitter.subscribe('BX.Tasks.Flow.EditForm:afterSave', (event) => {\n\t\t\tconst flowId = event.data?.id ?? 0;\n\n\t\t\tViewForm.removeInstance(flowId);\n\t\t});\n\t}\n\n\tasync #load(): Promise\n\t{\n\t\tthis.#viewFormData = await this.#viewAjax.getViewFormData();\n\n\t\tthis.#layout.popup.setContent(this.#render());\n\t}\n\n\tshow(bindElement: HTMLElement): void\n\t{\n\t\tthis.#layout.popup = this.getPopup();\n\n\t\tthis.#layout.popup.setContent(this.#render());\n\t\tthis.#layout.popup.setBindElement(bindElement);\n\n\t\tthis.#layout.popup.show();\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\tconst id = `tasks-flow-view-popup-${this.#params.flowId}`;\n\n\t\tif (PopupManager.getPopupById(id))\n\t\t{\n\t\t\treturn PopupManager.getPopupById(id);\n\t\t}\n\n\t\tconst popup = new Popup({\n\t\t\tid,\n\t\t\tclassName: 'tasks-flow__view-popup',\n\t\t\tanimation: 'fading-slide',\n\t\t\tminWidth: 347,\n\t\t\tmaxWidth: 347,\n\t\t\tpadding: 0,\n\t\t\tborderRadius: 12,\n\t\t\tautoHide: true,\n\t\t\toverlay: true,\n\t\t\tcloseByEsc: true,\n\t\t\tautoHideHandler: ({ target }) => {\n\t\t\t\tconst isSelf = popup.getPopupContainer().contains(target);\n\t\t\t\tconst isTeam = this.#layout.teamPopup?.getPopup().getPopupContainer().contains(target);\n\n\t\t\t\treturn !isSelf && !isTeam;\n\t\t\t},\n\t\t});\n\n\t\tnew SidePanelIntegration(popup);\n\n\t\treturn popup;\n\t}\n\n\t#render(): HTMLElement\n\t{\n\t\tif (!this.#viewFormData)\n\t\t{\n\t\t\treturn this.#renderLoader();\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form\">\n\t\t\t\t${this.#renderHeader()}\n\t\t\t\t${this.#renderContent()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderLoader(): HTMLElement\n\t{\n\t\tconst loaderContainer = Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form-loader\" style=\"width: 347px; height: 300px;\">\n\t\t\t</div>\n\t\t`;\n\n\t\tvoid new Loader({ target: loaderContainer }).show();\n\n\t\treturn loaderContainer;\n\t}\n\n\t#renderHeader(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form_header\">\n\t\t\t\t<div class=\"tasks-flow__view-form_header-title\">\n\t\t\t\t\t${this.#renderTitle()}\n\t\t\t\t\t<div class=\"tasks-flow__view-form-header_title-efficiency\">\n\t\t\t\t\t\t${this.#renderEfficiencyLabel(this.#viewFormData.flow.efficiency)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-flow__view-form-header_description\">\n\t\t\t\t\t${this.#renderDescription(this.#viewFormData.flow.description)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderDescription(description: string): HTMLElement\n\t{\n\t\tconst descriptionNode = Tag.render`\n\t\t\t<div \n\t\t\t\tclass=\"tasks-flow__view-form_header-description\" \n\t\t\t\ttitle=\"${Text.encode(description)}\"\n\t\t\t></div>\n\t\t`;\n\n\t\tdescriptionNode.innerText = description;\n\n\t\treturn descriptionNode;\n\t}\n\n\t#renderEfficiencyLabel(efficiency: number): HTMLElement\n\t{\n\t\treturn new Label({\n\t\t\ttext: `${efficiency}%`,\n\t\t\tcolor: efficiency < 60 ? LabelColor.DANGER : LabelColor.SUCCESS,\n\t\t\tsize: LabelSize.SM,\n\t\t\tfill: true,\n\t\t}).render();\n\t}\n\n\t#renderTitle(): HTMLElement\n\t{\n\t\tconst title = Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form-header_title-link\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"tasks-flow__view-form-header_title-text\"\n\t\t\t\t\ttitle=\"${Text.encode(this.#viewFormData.flow.name)}\"\n\t\t\t\t>\n\t\t\t\t\t${Text.encode(this.#viewFormData.flow.name)}\n\t\t\t\t</div>\n\t\t\t\t<div \n\t\t\t\t\tclass=\"tasks-flow__view-form-header_title-link-icon ui-icon-set --link-3\"\n\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 16px;\"\n\t\t\t\t\ttitle=\"${Loc.getMessage('TASKS_FLOW_VIEW_FORM_LINK_TITLE')}\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(title, 'click', () => {\n\t\t\tconst notificationId = 'copy-link';\n\n\t\t\tif (!this.#notificationList.has(notificationId))\n\t\t\t{\n\t\t\t\tconst flowURL = window.location.protocol + this.flowUrl;\n\t\t\t\tBX.clipboard.copy(flowURL);\n\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tid: notificationId,\n\t\t\t\t\tcontent: Loc.getMessage('TASKS_FLOW_VIEW_FORM_TITLE_COPY_LINK'),\n\t\t\t\t});\n\n\t\t\t\tthis.#notificationList.add(notificationId);\n\n\t\t\t\tEventEmitter.subscribeOnce(\n\t\t\t\t\t'UI.Notification.Balloon:onClose',\n\t\t\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\t\t\tconst closingBalloon = baseEvent.getTarget();\n\t\t\t\t\t\tif (closingBalloon.getId() === notificationId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#notificationList.delete(notificationId);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\treturn title;\n\t}\n\n\t#renderContent(): HTMLElement\n\t{\n\t\tconst content = Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form-content\">\n\t\t\t\t${this.#renderSegmentButton()}\n\t\t\t\t${this.#renderDetails()}\n\t\t\t\t${this.#renderSimilarFlows()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#updateSegmentsVisibility();\n\n\t\treturn content;\n\t}\n\n\t#renderSegmentButton(): HTMLElement\n\t{\n\t\tthis.#selectedSegment = 'details';\n\n\t\treturn new SegmentButton({\n\t\t\tsegments: [\n\t\t\t\t{\n\t\t\t\t\tid: 'details',\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_FLOW_VIEW_FORM_DETAILS'),\n\t\t\t\t\tisActive: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'similarFlows',\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_FLOW_VIEW_FORM_SIMILAR_FLOWS'),\n\t\t\t\t},\n\t\t\t],\n\t\t\tonSegmentSelected: (segment) => {\n\t\t\t\tif (this.#selectedSegment !== segment.id)\n\t\t\t\t{\n\t\t\t\t\tthis.#selectedSegment = segment.id;\n\t\t\t\t\tthis.#updateSegmentsVisibility();\n\t\t\t\t}\n\t\t\t},\n\t\t}).render();\n\t}\n\n\t#updateSegmentsVisibility(): void\n\t{\n\t\tDom.style(this.#layout.details, 'display', 'none');\n\t\tthis.#layout.similarFlows.hide();\n\n\t\tif (this.#selectedSegment === 'details')\n\t\t{\n\t\t\tDom.style(this.#layout.details, 'display', '');\n\t\t}\n\n\t\tif (this.#selectedSegment === 'similarFlows')\n\t\t{\n\t\t\tthis.#layout.similarFlows.show();\n\t\t}\n\t}\n\n\t#renderDetails(): HTMLElement\n\t{\n\t\tthis.#layout.details = Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form-details\">\n\t\t\t\t${this.#renderField(Loc.getMessage('TASKS_FLOW_VIEW_FORM_CREATOR'), this.#renderEntity(this.#viewFormData.creator))}\n\t\t\t\t${this.#renderField(Loc.getMessage('TASKS_FLOW_VIEW_FORM_ADMINISTRATOR'), this.#renderEntity(this.#viewFormData.owner))}\n\t\t\t\t${this.#renderField(Loc.getMessage('TASKS_FLOW_VIEW_FORM_TEAM'), this.#renderTeam())}\n\t\t\t\t${this.#renderProjectField()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.details;\n\t}\n\n\t#renderProjectField(): HTMLElement | string\n\t{\n\t\tif (!this.#viewFormData.project)\n\t\t{\n\t\t\tconst content = (\n\t\t\t\tthis.#viewFormData.flow.demo === true\n\t\t\t\t\t? Loc.getMessage('TASKS_FLOW_VIEW_FORM_PROJECT_DEMO')\n\t\t\t\t\t: Loc.getMessage('TASKS_FLOW_VIEW_FORM_PROJECT_HIDDEN')\n\t\t\t);\n\n\t\t\treturn this.#renderField(\n\t\t\t\tLoc.getMessage('TASKS_FLOW_VIEW_FORM_PROJECT'),\n\t\t\t\tcontent,\n\t\t\t);\n\t\t}\n\n\t\treturn this.#renderField(\n\t\t\tLoc.getMessage('TASKS_FLOW_VIEW_FORM_PROJECT'),\n\t\t\tthis.#renderEntity(this.#viewFormData.project),\n\t\t);\n\t}\n\n\t#renderField(title, content): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form_field-name\">\n\t\t\t\t${title}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-flow__view-form_field-value\">\n\t\t\t\t${content}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderEntity(entity: Entity): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<a class=\"tasks-flow__view-form_entity\" href=\"${encodeURI(entity.url)}\">\n\t\t\t\t${this.#renderAvatar(entity)}\n\t\t\t\t<div class=\"tasks-flow__view-form_entity-name\" title=\"${Text.encode(entity.name)}\">\n\t\t\t\t\t${Text.encode(entity.name)}\n\t\t\t\t</div>\n\t\t\t</a>\n\t\t`;\n\t}\n\n\t#renderTeam(): ?HTMLElement\n\t{\n\t\tif (this.#viewFormData.flow.demo === true)\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_FLOW_VIEW_FORM_PROJECT_DEMO');\n\t\t}\n\n\t\tif (this.#viewFormData.team.length === 1)\n\t\t{\n\t\t\treturn this.#renderEntity(this.#viewFormData.team[0]);\n\t\t}\n\n\t\tthis.#layout.teamNode = Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form_line-avatars\">\n\t\t\t\t${this.#viewFormData.team.map((entity) => this.#renderAvatar(entity))}\n\t\t\t\t${this.#renderShowTeamButton()}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.#viewFormData.teamCount === this.#viewFormData.team.length)\n\t\t{\n\t\t\tEvent.bind(this.#layout.teamNode, 'click', this.#onShowTeamButtonClickHandler.bind(this));\n\t\t}\n\n\t\treturn this.#layout.teamNode;\n\t}\n\n\t#renderAvatar(entity: Entity): HTMLElement\n\t{\n\t\tconst style = this.#isAvatar(entity.avatar) ? `background-image: url('${encodeURI(entity.avatar)}');` : '';\n\n\t\treturn Tag.render`\n\t\t\t<span class=\"ui-icon ui-icon-common-user tasks-flow__view-form_avatar\" title=\"${Text.encode(entity.name)}\">\n\t\t\t\t<i style=\"${style}\"></i>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\t#isAvatar(avatar: string): boolean\n\t{\n\t\treturn Type.isStringFilled(avatar);\n\t}\n\n\t#renderShowTeamButton(): HTMLElement | string\n\t{\n\t\tif (this.#viewFormData.teamCount === this.#viewFormData.team.length)\n\t\t{\n\t\t\tthis.#layout.showTeamButton?.remove();\n\t\t\tthis.#layout.showTeamButton = null;\n\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.showTeamButton = Tag.render`\n\t\t\t<div class=\"tasks-flow__view-form_show-team-button\">\n\t\t\t\t${this.#getShowTeamButtonText()}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.showTeamButton, 'click', this.#onShowTeamButtonClickHandler.bind(this));\n\n\t\treturn this.#layout.showTeamButton;\n\t}\n\n\t#getShowTeamButtonText(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_FLOW_VIEW_FORM_ALL_N', {\n\t\t\t'#NUM#': this.#viewFormData.teamCount,\n\t\t});\n\t}\n\n\t#onShowTeamButtonClickHandler(): void\n\t{\n\t\tconst flowId = this.#params.flowId;\n\t\tconst bindElement = this.#layout.showTeamButton ?? this.#layout.teamNode;\n\t\tthis.#layout.teamPopup ??= TeamPopup.getInstance({ flowId });\n\t\tthis.#layout.teamPopup.show(bindElement);\n\t}\n\n\t#renderSimilarFlows(): HTMLElement\n\t{\n\t\tthis.#layout.similarFlows ??= new SimilarFlows({\n\t\t\tflowId: this.#params.flowId,\n\t\t\tisFeatureEnabled: this.isFeatureEnabled,\n\t\t\tcreateTaskButtonClickHandler: () => this.#layout.popup?.destroy(),\n\t\t});\n\n\t\treturn this.#layout.similarFlows.render();\n\t}\n}\n"],"names":["SegmentButton","constructor","params","segments","render","Tag","map","segment","node","isActive","title","Event","bind","selectedSegment","forEach","Dom","removeClass","id","addClass","onSegmentSelected","ViewAjax","flowId","getViewFormData","data","ajax","runAction","flow","team","member","teamCount","owner","creator","project","getSimilarFlows","page","similarFlows","Object","values","flat","navigation","size","length","user","name","avatar","url","pathToProfile","SimilarFlows","isFeatureEnabled","createTaskButtonClickHandler","show","style","wrap","Type","isArrayFilled","then","hide","scrollTop","maxScroll","scrollHeight","offsetHeight","Math","abs","emptyState","remove","loader","Loader","target","isFirstPageLoaded","append","destroy","Loc","getMessage","button","Button","color","Color","SECONDARY_LIGHT","Size","EXTRA_SMALL","round","text","noCaps","onclick","BX","SidePanel","Instance","open","createTaskUri","FeaturePromotersRegistry","getPromoter","code","Text","encode","ViewForm","Set","flowUrl","showInstance","getInstance","bindElement","instances","removeInstance","hasOwn","popup","getPopup","setContent","setBindElement","PopupManager","getPopupById","Popup","className","animation","minWidth","maxWidth","padding","borderRadius","autoHide","overlay","closeByEsc","autoHideHandler","isSelf","getPopupContainer","contains","isTeam","teamPopup","SidePanelIntegration","EventEmitter","subscribe","event","loaderContainer","efficiency","description","descriptionNode","innerText","Label","LabelColor","DANGER","SUCCESS","LabelSize","SM","fill","notificationId","has","flowURL","window","location","protocol","clipboard","copy","UI","Notification","Center","notify","content","add","subscribeOnce","baseEvent","closingBalloon","getTarget","getId","delete","details","demo","entity","encodeURI","teamNode","isStringFilled","showTeamButton","TeamPopup"],"mappings":"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"}