{"version":3,"file":"tour.bundle.js","sources":["../src/first.project.js","../src/first.scrum.js","../src/tour.js"],"sourcesContent":["import {Uri, ajax} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Guide, Step} from 'ui.tour';\n\nimport type {PopupData} from './tour';\n\ntype Params = {\n\ttargetNodeId: string,\n\tpopupData: Array<PopupData>,\n}\n\nexport class FirstProject extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Tour.FirstProject');\n\n\t\tthis.popupData = params.popupData;\n\n\t\tthis.targetNode = document.getElementById(params.targetNodeId);\n\n\t\tthis.guide = new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.targetNode,\n\t\t\t\t\ttitle: this.popupData[0].title,\n\t\t\t\t\ttext: this.popupData[0].text,\n\t\t\t\t\tarticle: this.popupData[0].article,\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true\n\t\t});\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('UI.Tour.Guide:onFinish', this.onGuideFinish.bind(this));\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onProjectSliderMessage.bind(this));\n\t}\n\n\tonGuideFinish(event: BaseEvent)\n\t{\n\t\tconst {guide} = event.getData();\n\n\t\tif (guide === this.guide)\n\t\t{\n\t\t\tthis.targetNode.href = Uri.removeParam(this.targetNode.href, ['PROJECT_OPTIONS']);\n\t\t}\n\t}\n\n\tonProjectSliderMessage(event: BaseEvent)\n\t{\n\t\tconst [sliderEvent] = event.getData();\n\t\tif (sliderEvent.getEventId() !== 'sonetGroupEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sliderEventData = sliderEvent.getData();\n\t\tif (\n\t\t\tsliderEventData.code !== 'afterCreate'\n\t\t\t|| sliderEventData.data.projectOptions.tourId !== this.guide.getId()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst projectId = sliderEventData.data.group.ID;\n\n\t\tthis.emit('afterProjectCreated', projectId);\n\t}\n\n\tshowFinalStep(target: HTMLElement)\n\t{\n\t\tthis.guide.steps.push(new Step({\n\t\t\ttarget,\n\t\t\tcursorMode: true,\n\t\t\ttargetEvent: () => {\n\t\t\t\tBX.SidePanel.Instance.open(target.href);\n\t\t\t\tsetTimeout(() => this.guide.close(), 1000);\n\t\t\t},\n\t\t}));\n\t\tthis.finish();\n\t\tthis.showNextStep();\n\t}\n\n\tstart()\n\t{\n\t\tthis.targetNode.href = Uri.addParam(this.targetNode.href, {\n\t\t\tPROJECT_OPTIONS: {\n\t\t\t\ttourId: this.guide.getId(),\n\t\t\t},\n\t\t});\n\t\tthis.showNextStep();\n\t}\n\n\tfinish()\n\t{\n\t\tajax.runAction('tasks.tourguide.firstprojectcreation.finish');\n\t}\n\n\tshowNextStep()\n\t{\n\t\tsetTimeout(() => this.guide.showNextStep(), 1000);\n\t}\n}","import {Uri, ajax} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Guide, Step} from 'ui.tour';\n\nimport type {PopupData} from './tour';\n\ntype Params = {\n\ttargetNodeId: string,\n\tpopupData: Array<PopupData>,\n}\n\nexport class FirstScrum extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Tour.FirstScrum');\n\n\t\tthis.popupData = params.popupData;\n\n\t\tthis.targetNode = document.getElementById(params.targetNodeId);\n\n\t\tthis.guide = new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.targetNode,\n\t\t\t\t\ttitle: this.popupData[0].title,\n\t\t\t\t\ttext: this.popupData[0].text,\n\t\t\t\t\tarticle: null\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true\n\t\t});\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('UI.Tour.Guide:onFinish', this.onGuideFinish.bind(this));\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onProjectSliderMessage.bind(this));\n\t}\n\n\tonGuideFinish(event: BaseEvent)\n\t{\n\t\tconst {guide} = event.getData();\n\n\t\tif (guide === this.guide)\n\t\t{\n\t\t\tthis.targetNode.href = Uri.removeParam(this.targetNode.href, ['PROJECT_OPTIONS']);\n\t\t}\n\t}\n\n\tonProjectSliderMessage(event: BaseEvent)\n\t{\n\t\tconst [sliderEvent] = event.getData();\n\t\tif (sliderEvent.getEventId() !== 'sonetGroupEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sliderEventData = sliderEvent.getData();\n\t\tif (\n\t\t\tsliderEventData.code !== 'afterCreate'\n\t\t\t|| sliderEventData.data.projectOptions.tourId !== this.guide.getId()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst projectId = sliderEventData.data.group.ID;\n\n\t\tthis.emit('afterProjectCreated', projectId);\n\t}\n\n\tshowFinalStep(target: HTMLElement)\n\t{\n\t\tthis.guide.steps.push(new Step({\n\t\t\ttarget,\n\t\t\tcursorMode: true,\n\t\t\ttargetEvent: () => {\n\t\t\t\tBX.SidePanel.Instance.open(target.href);\n\t\t\t\tsetTimeout(() => this.guide.close(), 1000);\n\t\t\t},\n\t\t}));\n\t\tthis.finish();\n\t\tthis.showNextStep();\n\t}\n\n\tstart()\n\t{\n\t\tthis.targetNode.href = Uri.addParam(this.targetNode.href, {\n\t\t\tPROJECT_OPTIONS: {\n\t\t\t\ttourId: this.guide.getId(),\n\t\t\t},\n\t\t});\n\t\tthis.showNextStep();\n\t}\n\n\tfinish()\n\t{\n\t\tajax.runAction('tasks.tourguide.firstscrumcreation.finish');\n\t}\n\n\tshowNextStep()\n\t{\n\t\tsetTimeout(() => this.guide.showNextStep(), 1000);\n\t}\n}","import {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {FirstProject} from './first.project';\nimport {FirstScrum} from './first.scrum';\n\nexport type PopupData = {\n\tarticle: number,\n\ttext: string,\n\ttitle: string,\n}\n\ntype TourData = {\n\ttargetNodeId: string,\n\tpopupData: Array<PopupData>,\n\tshow: boolean,\n}\n\ntype Params = {\n\ttours: {\n\t\tfirstProjectCreation?: TourData,\n\t\tfirstScrumCreation?: TourData,\n\t}\n}\n\nexport class Tour extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Tour');\n\n\t\tconst tours = params.tours;\n\n\t\tconst firstProjectData = tours.firstProjectCreation ?? {};\n\t\tconst firstScrumData = tours.firstScrumCreation ?? {};\n\n\t\tif (firstProjectData.show)\n\t\t{\n\t\t\tthis.firstProject = new FirstProject({\n\t\t\t\ttargetNodeId: firstProjectData.targetNodeId,\n\t\t\t\tpopupData: firstProjectData.popupData\n\t\t\t});\n\n\t\t\tthis.firstProject.subscribe('afterProjectCreated', (baseEvent: BaseEvent) => {\n\t\t\t\tthis.emit('FirstProject:afterProjectCreated', baseEvent.getData());\n\t\t\t});\n\n\t\t\tthis.firstProject.start();\n\t\t}\n\n\t\tif (firstScrumData.show)\n\t\t{\n\t\t\tthis.firstScrum = new FirstScrum({\n\t\t\t\ttargetNodeId: firstScrumData.targetNodeId,\n\t\t\t\tpopupData: firstScrumData.popupData\n\t\t\t});\n\n\t\t\tthis.firstScrum.subscribe('afterProjectCreated', (baseEvent: BaseEvent) => {\n\t\t\t\tthis.emit('FirstScrum:afterScrumCreated', baseEvent.getData());\n\t\t\t});\n\n\t\t\tthis.firstScrum.start();\n\t\t}\n\t}\n\n\tshowFinalStep(target: HTMLElement)\n\t{\n\t\tif (this.firstProject)\n\t\t{\n\t\t\tthis.firstProject.showFinalStep(target);\n\t\t}\n\n\t\tif (this.firstScrum)\n\t\t{\n\t\t\tthis.firstScrum.showFinalStep(target);\n\t\t}\n\t}\n}"],"names":["FirstProject","params","setEventNamespace","popupData","targetNode","document","getElementById","targetNodeId","guide","Guide","steps","target","title","text","article","onEvents","bindEvents","EventEmitter","subscribe","onGuideFinish","bind","onProjectSliderMessage","event","getData","href","Uri","removeParam","sliderEvent","getEventId","sliderEventData","code","data","projectOptions","tourId","getId","projectId","group","ID","emit","push","Step","cursorMode","targetEvent","BX","SidePanel","Instance","open","setTimeout","close","finish","showNextStep","addParam","PROJECT_OPTIONS","ajax","runAction","FirstScrum","Tour","tours","firstProjectData","firstProjectCreation","firstScrumData","firstScrumCreation","show","firstProject","baseEvent","start","firstScrum","showFinalStep"],"mappings":"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"}