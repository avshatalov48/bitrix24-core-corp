var tasksListNS={approveTask:function(t){ganttChart.updateTask(t,{status:"completed",dateCompleted:new Date});SetServerStatus(t,"approve",{bGannt:true})},disapproveTask:function(t){ganttChart.updateTask(t,{status:"new",dateCompleted:null});SetServerStatus(t,"disapprove",{bGannt:true})}};function SetServerCloseStatus(t,e,a){var s=null;var n={mode:e,sessid:BX.message("bitrix_sessid"),path_to_task:BX.message("TASKS_PATH_TO_TASK"),id:t};if(typeof tasksListNS!=="undefined"&&tasksListNS.getColumnsOrder){s=tasksListNS.getColumnsOrder();n["columnsOrder"]=s}if(a){for(var r in a){n[r]=a[r]}}BX.ajax({method:"POST",dataType:"json",url:tasksListAjaxUrl+"&_CODE="+e+"&viewType=VIEW_MODE_GANTT",data:n,processData:true,onsuccess:function(t){return function(e){if(e.status==="failure"&&e.message){BX.UI.Notification.Center.notify({content:e.message});return}if(e.status!="success")return;ganttChart.updateTask(t,{status:"completed",dateCompleted:new Date});var a=BX.parseJSON(e.tasksRenderJSON);quickInfoData[t].menuItems=a.menuItems;quickInfoData[t].realStatus=a.realStatus;tasksMenuPopup[t]=a.menuItems;if(typeof ganttChart!="undefined"){ganttChart.getTaskById(t).setMenuItems(__FilterMenuByStatus(quickInfoData[t]));var s=ganttChart.getTaskById(t);if(s){ganttChart.updateTask(s.id,a)}}if(BX.TasksTimerManager)BX.TasksTimerManager.reLoadInitTimerDataFromServer();if(window.BX.TasksIFrameInst)window.BX.TasksIFrameInst.onTaskChanged(a,null,null,null,a.html)}}(t)});__InvalidateMenus([t,"c"+t])}function CloseTask(t){SetServerCloseStatus(t,"close",{bGannt:true})}function StartTask(t){ganttChart.updateTask(t,{status:"in-progress",dateCompleted:null});SetServerStatus(t,"start",{bGannt:true})}function AcceptTask(t){ganttChart.updateTask(t,{status:"accepted",dateCompleted:null});SetServerStatus(t,"accept",{bGannt:true})}function PauseTask(t){ganttChart.updateTask(t,{status:"accepted",dateCompleted:null});SetServerStatus(t,"pause",{bGannt:true})}function RenewTask(t){ganttChart.updateTask(t,{status:"new",dateCompleted:null});SetServerStatus(t,"renew",{bGannt:true})}function DeferTask(t){ganttChart.updateTask(t,{status:"delayed"});SetServerStatus(t,"defer",{bGannt:true})}function AddToFavorite(t,e){var a={mode:"favorite",add:1,sessid:BX.message("bitrix_sessid"),id:t,bGannt:true};BX.ajax({method:"POST",dataType:"html",url:tasksListAjaxUrl,data:a,processData:false,onsuccess:function(t){return function(t){}}(t)})}function DeleteFavorite(t,e){var a={mode:"favorite",sessid:BX.message("bitrix_sessid"),id:t,bGannt:true};BX.ajax({method:"POST",dataType:"html",url:tasksListAjaxUrl,data:a,processData:false,onsuccess:function(t){if(e.rowDelete){return function(a){TASKS_table_view_onDeleteClick_onSuccess(t,a,e)}}}(t)})}function DeleteTask(t){var e={mode:"delete",sessid:BX.message("bitrix_sessid"),id:t,bGannt:true};BX.ajax({method:"POST",dataType:"html",url:tasksListAjaxUrl,data:e,processData:false,onsuccess:function(t){return function(e){TASKS_table_view_onDeleteClick_onSuccess(t,e)}}(t)})}function TASKS_table_view_onDeleteClick_onSuccess(t,e){e=e.toString().trim();if(e&&e.length>0){}else{ganttChart.removeTask(t);BX.onCustomEvent("onTaskListTaskDelete",[t]);BX.UI.Notification.Center.notify({content:BX.message("TASKS_DELETE_SUCCESS")})}}function onPopupTaskChanged(t){__RenewMenuItems(t);__InvalidateMenus([t.id,"c"+t.id]);if(t.parentTaskId){var e=ganttChart.getTaskById(t.parentTaskId);if(e){if(e.hasChildren){e.expand();ganttChart.updateTask(t.id,t)}else{ganttChart.updateTask(t.id,t);e.expand()}}else{ganttChart.updateTask(t.id,t)}}else if(t.projectId&&!ganttChart.getProjectById(t.projectId)){var a=ganttChart.addProjectFromJSON({id:t.projectId,name:t.projectName,opened:true,canCreateTasks:t.projectCanCreateTasks,canEditTasks:t.projectCanEditTasks});ganttChart.updateTask(t.id,t)}else{ganttChart.updateTask(t.id,t)}}function onPopupTaskAdded(t){BX.onCustomEvent("onTaskListTaskAdd",[t]);__RenewMenuItems(t);if(t.projectId&&!ganttChart.getProjectById(t.projectId)){ganttChart.addProjectFromJSON({id:t.projectId,name:t.projectName,opened:true,canCreateTasks:t.projectCanCreateTasks,canEditTasks:t.projectCanEditTasks})}ganttChart.addTaskFromJSON(t);if(t.parentTaskId){var e=ganttChart.getTaskById(t.parentTaskId);if(e){e.expand()}}}function onPopupTaskDeleted(t){ganttChart.removeTask(t)}var lastScroll;function onBeforeShow(){if(BX.browser.IsOpera()){lastScroll=ganttChart.layout.timeline.scrollLeft}}function onAfterShow(){if(typeof lastScroll!="undefined"&&BX.browser.IsOpera()){ganttChart.layout.timeline.scrollLeft=lastScroll}}function onBeforeHide(){if(BX.browser.IsOpera()){lastScroll=ganttChart.layout.timeline.scrollLeft}}function onAfterHide(){if(typeof lastScroll!="undefined"&&BX.browser.IsOpera()){ganttChart.layout.timeline.scrollLeft=lastScroll}}function __RenewMenuItems(t){if(!t){return}quickInfoData[t.id]=BX.clone(t,true);t.menuItems=__FilterMenuByStatus(t)}
//# sourceMappingURL=gantt-view.map.js