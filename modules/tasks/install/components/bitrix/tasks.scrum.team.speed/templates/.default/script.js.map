{"version":3,"file":"script.js","sources":["src/chart.js","src/stats.js","src/index.js"],"sourcesContent":["import {Loc, Type} from 'main.core';\n\nexport type ChartData = {\n\tsprintName: string,\n\tplan: number,\n\tdone: number\n}\n\nexport class Chart\n{\n\tconstructor(data: Array<ChartData>)\n\t{\n\t\tthis.data = data;\n\n\t\tthis.chart = null;\n\t\tthis.loader = null;\n\t}\n\n\trenderTo(chartDiv: HTMLElement)\n\t{\n\t\tsetTimeout(() => this.create(chartDiv), 300);\n\t}\n\n\tcreate(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\t\tthis.chart.responsive.enabled = true;\n\n\t\tthis.createAxises();\n\n\t\tthis.createColumn('plan', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_PLAN_COLUMN'), '#2882b3');\n\t\tthis.createColumn('done', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_DONE_COLUMN'), '#9c1f1f');\n\n\t\tthis.createLegend();\n\n\t\tif (this.data.length === 0)\n\t\t{\n\t\t\tthis.showLoader(true);\n\t\t}\n\t}\n\n\trender(data: Array<ChartData>)\n\t{\n\t\tif (!this.chart)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.data = data;\n\n\t\tthis.chart.data = this.data;\n\n\t\tif (this.data.length > 0)\n\t\t{\n\t\t\tthis.removeLoader();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showLoader(true);\n\t\t}\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst xAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\txAxis.dataFields.category = 'sprintName';\n\t\txAxis.renderer.grid.template.location = 0;\n\t\txAxis.renderer.labels.template.adapter\n\t\t\t.add('textOutput', (text) => Type.isNil(text) ? text : text.replace(/ \\(.*/, ''))\n\t\t;\n\n\t\tconst label = xAxis.renderer.labels.template;\n\t\tlabel.wrap = true;\n\t\tlabel.maxWidth = 120;\n\n\t\tconst yAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tyAxis.min = 0;\n\t}\n\n\tcreateColumn(valueY: string, name: string, color: string): Object\n\t{\n\t\tconst series = this.chart.series.push(new am4charts.ColumnSeries());\n\t\tseries.dataFields.valueY = valueY;\n\t\tseries.dataFields.categoryX = 'sprintName';\n\t\tseries.name = name;\n\t\tseries.stroke = am4core.color(color);\n\t\tseries.fill = am4core.color(color);\n\t\tseries.columns.template.tooltipText = '{name}: [bold]{valueY}[/]';\n\n\t\treturn series;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.paddingBottom = 20;\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t}\n\n\tshowLoader(notData: boolean = false)\n\t{\n\t\tthis.removeLoader();\n\n\t\tthis.loader = this.chart.tooltipContainer.createChild(am4core.Container);\n\n\t\tthis.loader.background.fill = am4core.color('#fff');\n\t\tthis.loader.background.fillOpacity = 0.8;\n\t\tthis.loader.width = am4core.percent(100);\n\t\tthis.loader.height = am4core.percent(100);\n\n\t\tif (notData)\n\t\t{\n\t\t\tconst loaderLabel = this.loader.createChild(am4core.Label);\n\n\t\t\tloaderLabel.text = Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_NOT_DATA_LABEL');\n\t\t\tloaderLabel.align = 'center';\n\t\t\tloaderLabel.valign = 'middle';\n\t\t\tloaderLabel.fontSize = 20;\n\t\t}\n\t}\n\n\tremoveLoader()\n\t{\n\t\tif (this.loader !== null)\n\t\t{\n\t\t\tthis.loader.dispose();\n\t\t}\n\t}\n}","import {Tag, Loc, Text, Dom, Type} from 'main.core';\n\nexport type StatsData = {\n\taverage: number,\n\tmaximum: number,\n\tminimum: number\n}\n\nexport class Stats\n{\n\tconstructor(data: StatsData)\n\t{\n\t\tthis.data = data;\n\n\t\tthis.node = null;\n\t}\n\n\trenderTo(rootNode: HTMLElement)\n\t{\n\t\tthis.node = this.build();\n\n\t\tDom.append(this.node, rootNode);\n\t}\n\n\trender(data?: StatsData): HTMLElement\n\t{\n\t\tif (!Type.isUndefined(data))\n\t\t{\n\t\t\tthis.data = data;\n\t\t}\n\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.sync(this.build(), this.node);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.node = this.build();\n\t\t}\n\n\t\treturn this.node;\n\t}\n\n\tbuild(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-team-speed-stats-container\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-team-speed-stats-row\">\n\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_STATS_AVERAGE_LABEL')}</div>\n\t\t\t\t\t<div>${Text.encode(this.data.average)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-team-speed-stats-row\">\n\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_STATS_MAX_LABEL')}</div>\n\t\t\t\t\t<div>${Text.encode(this.data.maximum)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-team-speed-stats-row\">\n\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_STATS_MIN_LABEL')}</div>\n\t\t\t\t\t<div>${Text.encode(this.data.minimum)}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowLoader()\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tDom.addClass(this.node, '--loader');\n\t\t}\n\t}\n\n\t// todo move it to Dom library\n\tsync (virtualNode: HTMLElement, realNode: HTMLElement)\n\t{\n\t\tif (virtualNode.attributes)\n\t\t{\n\t\t\tArray.from(virtualNode.attributes)\n\t\t\t\t.forEach((attr) => {\n\t\t\t\t\tif (realNode.getAttribute(attr.name) !== attr.value)\n\t\t\t\t\t{\n\t\t\t\t\t\trealNode.setAttribute(attr.name, attr.value);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\n\t\tif (virtualNode.nodeValue !== realNode.nodeValue)\n\t\t{\n\t\t\trealNode.nodeValue = virtualNode.nodeValue;\n\t\t}\n\n\t\t// Sync child nodes\n\t\tconst virtualChildren = virtualNode.childNodes;\n\t\tconst realChildren = realNode.childNodes;\n\n\t\tfor (let k = 0; k < virtualChildren.length || k < realChildren.length; k++)\n\t\t{\n\t\t\tconst virtual = virtualChildren[k];\n\t\t\tconst real = realChildren[k];\n\n\t\t\t// Remove\n\t\t\tif (\n\t\t\t\tvirtual === undefined\n\t\t\t\t&& real !== undefined\n\t\t\t)\n\t\t\t{\n\t\t\t\trealNode.remove(real);\n\t\t\t}\n\t\t\t// Update\n\t\t\tif (\n\t\t\t\tvirtual !== undefined\n\t\t\t\t&& real !== undefined\n\t\t\t\t&& virtual.tagName === real.tagName\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.sync(virtual, real);\n\t\t\t}\n\t\t\t// Replace\n\t\t\tif (\n\t\t\t\tvirtual !== undefined\n\t\t\t\t&& real !== undefined\n\t\t\t\t&& virtual.tagName !== real.tagName\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst newReal = this.createRealNodeByVirtual(virtual);\n\n\t\t\t\tthis.sync(virtual, newReal);\n\n\t\t\t\tDom.replace(real, newReal);\n\t\t\t}\n\t\t\t// Add\n\t\t\tif (\n\t\t\t\tvirtual !== undefined\n\t\t\t\t&& real === undefined\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst newReal = this.createRealNodeByVirtual(virtual);\n\n\t\t\t\tthis.sync(virtual, newReal);\n\n\t\t\t\tDom.append(newReal, realNode);\n\t\t\t}\n\t\t}\n\t}\n\n\t// todo move it to Dom library\n\tcreateRealNodeByVirtual(virtual: HTMLElement): HTMLElement\n\t{\n\t\tif (virtual.nodeType === Node.TEXT_NODE)\n\t\t{\n\t\t\treturn document.createTextNode('');\n\t\t}\n\n\t\treturn document.createElement(virtual.tagName);\n\t}\n\n}","import {ajax} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Chart, ChartData} from './chart';\nimport {Stats, StatsData} from './stats';\n\nimport '../css/base.css';\n\ntype Params = {\n\tfilterId: string,\n\tsignedParameters: string,\n\tchartData: Array<ChartData>,\n\tstatsData: StatsData\n}\n\nexport class TeamSpeed\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.filterId = params.filterId;\n\t\tthis.signedParameters = params.signedParameters;\n\n\t\tthis.chart = new Chart(params.chartData);\n\t\tthis.stats = new Stats(params.statsData);\n\n\t\t/* eslint-disable */\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t}\n\n\trenderTo(chartRoot: HTMLElement, statsRoot: HTMLElement)\n\t{\n\t\tthis.chart.renderTo(chartRoot);\n\t\tthis.stats.renderTo(statsRoot);\n\t}\n\n\tonFilterApply(event: BaseEvent)\n\t{\n\t\tconst [filterId, values, filterInstance, promise, params] = event.getCompatData();\n\n\t\tif (this.filterId !== filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.chart.showLoader();\n\t\tthis.stats.showLoader();\n\n\t\tajax.runComponentAction(\n\t\t\t'bitrix:tasks.scrum.team.speed',\n\t\t\t'applyFilter',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: {}\n\t\t\t}\n\t\t)\n\t\t\t.then((response) => {\n\t\t\t\tconst chartData: Array<ChartData> = response.data.chartData;\n\t\t\t\tconst statsData: StatsData = response.data.statsData;\n\n\t\t\t\tthis.chart.render(chartData);\n\t\t\t\tthis.stats.render(statsData);\n\t\t\t})\n\t\t;\n\t}\n}"],"names":["Chart","data","chart","loader","chartDiv","setTimeout","create","am4core","useTheme","am4themes_animated","am4charts","XYChart","paddingRight","responsive","enabled","createAxises","createColumn","Loc","getMessage","createLegend","length","showLoader","removeLoader","xAxis","xAxes","push","CategoryAxis","dataFields","category","renderer","grid","template","location","labels","adapter","add","text","Type","isNil","replace","label","wrap","maxWidth","yAxis","yAxes","ValueAxis","min","valueY","name","color","series","ColumnSeries","categoryX","stroke","fill","columns","tooltipText","legend","Legend","position","paddingBottom","itemContainers","clickable","notData","tooltipContainer","createChild","Container","background","fillOpacity","width","percent","height","loaderLabel","Label","align","valign","fontSize","dispose","Stats","node","rootNode","build","Dom","append","isUndefined","sync","Tag","render","Text","encode","average","maximum","minimum","addClass","virtualNode","realNode","attributes","Array","from","forEach","attr","getAttribute","value","setAttribute","nodeValue","virtualChildren","childNodes","realChildren","k","virtual","real","undefined","remove","tagName","newReal","createRealNodeByVirtual","nodeType","Node","TEXT_NODE","document","createTextNode","createElement","TeamSpeed","params","filterId","signedParameters","chartData","stats","statsData","filterManager","BX","Main","getById","sidePanelManager","SidePanel","Instance","bindEvents","EventEmitter","subscribe","onFilterApply","bind","chartRoot","statsRoot","renderTo","event","getCompatData","values","filterInstance","promise","ajax","runComponentAction","mode","then","response"],"mappings":";;;;;KAQaA,KAAb;CAEC,iBAAYC,IAAZ,EACA;CAAA;CACC,SAAKA,IAAL,GAAYA,IAAZ;CAEA,SAAKC,KAAL,GAAa,IAAb;CACA,SAAKC,MAAL,GAAc,IAAd;CACA;;CARF;CAAA;CAAA,6BAUUC,QAVV,EAWC;CAAA;;CACCC,MAAAA,UAAU,CAAC;CAAA,eAAM,KAAI,CAACC,MAAL,CAAYF,QAAZ,CAAN;CAAA,OAAD,EAA8B,GAA9B,CAAV;CACA;CAbF;CAAA;CAAA,2BAeQA,QAfR,EAgBC;CACCG,MAAAA,OAAO,CAACC,QAAR,CAAiBC,kBAAjB;CAEA,WAAKP,KAAL,GAAaK,OAAO,CAACD,MAAR,CAAeF,QAAf,EAAyBM,SAAS,CAACC,OAAnC,CAAb;CACA,WAAKT,KAAL,CAAWD,IAAX,GAAkB,KAAKA,IAAvB;CACA,WAAKC,KAAL,CAAWU,YAAX,GAA0B,EAA1B;CACA,WAAKV,KAAL,CAAWW,UAAX,CAAsBC,OAAtB,GAAgC,IAAhC;CAEA,WAAKC,YAAL;CAEA,WAAKC,YAAL,CAAkB,MAAlB,EAA0BC,aAAG,CAACC,UAAJ,CAAe,0CAAf,CAA1B,EAAsF,SAAtF;CACA,WAAKF,YAAL,CAAkB,MAAlB,EAA0BC,aAAG,CAACC,UAAJ,CAAe,0CAAf,CAA1B,EAAsF,SAAtF;CAEA,WAAKC,YAAL;;CAEA,UAAI,KAAKlB,IAAL,CAAUmB,MAAV,KAAqB,CAAzB,EACA;CACC,aAAKC,UAAL,CAAgB,IAAhB;CACA;CACD;CAnCF;CAAA;CAAA,2BAqCQpB,IArCR,EAsCC;CACC,UAAI,CAAC,KAAKC,KAAV,EACA;CACC;CACA;;CAED,WAAKD,IAAL,GAAYA,IAAZ;CAEA,WAAKC,KAAL,CAAWD,IAAX,GAAkB,KAAKA,IAAvB;;CAEA,UAAI,KAAKA,IAAL,CAAUmB,MAAV,GAAmB,CAAvB,EACA;CACC,aAAKE,YAAL;CACA,OAHD,MAKA;CACC,aAAKD,UAAL,CAAgB,IAAhB;CACA;CACD;CAxDF;CAAA;CAAA,mCA2DC;CACC,UAAME,KAAK,GAAG,KAAKrB,KAAL,CAAWsB,KAAX,CAAiBC,IAAjB,CAAsB,IAAIf,SAAS,CAACgB,YAAd,EAAtB,CAAd;CACAH,MAAAA,KAAK,CAACI,UAAN,CAAiBC,QAAjB,GAA4B,YAA5B;CACAL,MAAAA,KAAK,CAACM,QAAN,CAAeC,IAAf,CAAoBC,QAApB,CAA6BC,QAA7B,GAAwC,CAAxC;CACAT,MAAAA,KAAK,CAACM,QAAN,CAAeI,MAAf,CAAsBF,QAAtB,CAA+BG,OAA/B,CACEC,GADF,CACM,YADN,EACoB,UAACC,IAAD;CAAA,eAAUC,cAAI,CAACC,KAAL,CAAWF,IAAX,IAAmBA,IAAnB,GAA0BA,IAAI,CAACG,OAAL,CAAa,OAAb,EAAsB,EAAtB,CAApC;CAAA,OADpB;CAIA,UAAMC,KAAK,GAAGjB,KAAK,CAACM,QAAN,CAAeI,MAAf,CAAsBF,QAApC;CACAS,MAAAA,KAAK,CAACC,IAAN,GAAa,IAAb;CACAD,MAAAA,KAAK,CAACE,QAAN,GAAiB,GAAjB;CAEA,UAAMC,KAAK,GAAG,KAAKzC,KAAL,CAAW0C,KAAX,CAAiBnB,IAAjB,CAAsB,IAAIf,SAAS,CAACmC,SAAd,EAAtB,CAAd;CACAF,MAAAA,KAAK,CAACG,GAAN,GAAY,CAAZ;CACA;CAzEF;CAAA;CAAA,iCA2EcC,MA3Ed,EA2E8BC,IA3E9B,EA2E4CC,KA3E5C,EA4EC;CACC,UAAMC,MAAM,GAAG,KAAKhD,KAAL,CAAWgD,MAAX,CAAkBzB,IAAlB,CAAuB,IAAIf,SAAS,CAACyC,YAAd,EAAvB,CAAf;CACAD,MAAAA,MAAM,CAACvB,UAAP,CAAkBoB,MAAlB,GAA2BA,MAA3B;CACAG,MAAAA,MAAM,CAACvB,UAAP,CAAkByB,SAAlB,GAA8B,YAA9B;CACAF,MAAAA,MAAM,CAACF,IAAP,GAAcA,IAAd;CACAE,MAAAA,MAAM,CAACG,MAAP,GAAgB9C,OAAO,CAAC0C,KAAR,CAAcA,KAAd,CAAhB;CACAC,MAAAA,MAAM,CAACI,IAAP,GAAc/C,OAAO,CAAC0C,KAAR,CAAcA,KAAd,CAAd;CACAC,MAAAA,MAAM,CAACK,OAAP,CAAexB,QAAf,CAAwByB,WAAxB,GAAsC,2BAAtC;CAEA,aAAON,MAAP;CACA;CAtFF;CAAA;CAAA,mCAyFC;CACC,WAAKhD,KAAL,CAAWuD,MAAX,GAAoB,IAAI/C,SAAS,CAACgD,MAAd,EAApB;CACA,WAAKxD,KAAL,CAAWuD,MAAX,CAAkBE,QAAlB,GAA6B,QAA7B;CACA,WAAKzD,KAAL,CAAWuD,MAAX,CAAkBG,aAAlB,GAAkC,EAAlC;CACA,WAAK1D,KAAL,CAAWuD,MAAX,CAAkBI,cAAlB,CAAiC9B,QAAjC,CAA0C+B,SAA1C,GAAsD,KAAtD;CACA;CA9FF;CAAA;CAAA,iCAiGC;CAAA,UADWC,OACX,uEAD8B,KAC9B;CACC,WAAKzC,YAAL;CAEA,WAAKnB,MAAL,GAAc,KAAKD,KAAL,CAAW8D,gBAAX,CAA4BC,WAA5B,CAAwC1D,OAAO,CAAC2D,SAAhD,CAAd;CAEA,WAAK/D,MAAL,CAAYgE,UAAZ,CAAuBb,IAAvB,GAA8B/C,OAAO,CAAC0C,KAAR,CAAc,MAAd,CAA9B;CACA,WAAK9C,MAAL,CAAYgE,UAAZ,CAAuBC,WAAvB,GAAqC,GAArC;CACA,WAAKjE,MAAL,CAAYkE,KAAZ,GAAoB9D,OAAO,CAAC+D,OAAR,CAAgB,GAAhB,CAApB;CACA,WAAKnE,MAAL,CAAYoE,MAAZ,GAAqBhE,OAAO,CAAC+D,OAAR,CAAgB,GAAhB,CAArB;;CAEA,UAAIP,OAAJ,EACA;CACC,YAAMS,WAAW,GAAG,KAAKrE,MAAL,CAAY8D,WAAZ,CAAwB1D,OAAO,CAACkE,KAAhC,CAApB;CAEAD,QAAAA,WAAW,CAACpC,IAAZ,GAAmBnB,aAAG,CAACC,UAAJ,CAAe,6CAAf,CAAnB;CACAsD,QAAAA,WAAW,CAACE,KAAZ,GAAoB,QAApB;CACAF,QAAAA,WAAW,CAACG,MAAZ,GAAqB,QAArB;CACAH,QAAAA,WAAW,CAACI,QAAZ,GAAuB,EAAvB;CACA;CACD;CApHF;CAAA;CAAA,mCAuHC;CACC,UAAI,KAAKzE,MAAL,KAAgB,IAApB,EACA;CACC,aAAKA,MAAL,CAAY0E,OAAZ;CACA;CACD;CA5HF;CAAA;CAAA;;;KCAaC,KAAb;CAEC,iBAAY7E,IAAZ,EACA;CAAA;CACC,SAAKA,IAAL,GAAYA,IAAZ;CAEA,SAAK8E,IAAL,GAAY,IAAZ;CACA;;CAPF;CAAA;CAAA,6BASUC,QATV,EAUC;CACC,WAAKD,IAAL,GAAY,KAAKE,KAAL,EAAZ;CAEAC,MAAAA,aAAG,CAACC,MAAJ,CAAW,KAAKJ,IAAhB,EAAsBC,QAAtB;CACA;CAdF;CAAA;CAAA,2BAgBQ/E,IAhBR,EAiBC;CACC,UAAI,CAACoC,cAAI,CAAC+C,WAAL,CAAiBnF,IAAjB,CAAL,EACA;CACC,aAAKA,IAAL,GAAYA,IAAZ;CACA;;CAED,UAAI,KAAK8E,IAAT,EACA;CACC,aAAKM,IAAL,CAAU,KAAKJ,KAAL,EAAV,EAAwB,KAAKF,IAA7B;CACA,OAHD,MAKA;CACC,aAAKA,IAAL,GAAY,KAAKE,KAAL,EAAZ;CACA;;CAED,aAAO,KAAKF,IAAZ;CACA;CAjCF;CAAA;CAAA,4BAoCC;CACC,aAAOO,aAAG,CAACC,MAAX,gkBAGUtE,aAAG,CAACC,UAAJ,CAAe,4CAAf,CAHV,EAIUsE,cAAI,CAACC,MAAL,CAAY,KAAKxF,IAAL,CAAUyF,OAAtB,CAJV,EAOUzE,aAAG,CAACC,UAAJ,CAAe,wCAAf,CAPV,EAQUsE,cAAI,CAACC,MAAL,CAAY,KAAKxF,IAAL,CAAU0F,OAAtB,CARV,EAWU1E,aAAG,CAACC,UAAJ,CAAe,wCAAf,CAXV,EAYUsE,cAAI,CAACC,MAAL,CAAY,KAAKxF,IAAL,CAAU2F,OAAtB,CAZV;CAgBA;CArDF;CAAA;CAAA,iCAwDC;CACC,UAAI,KAAKb,IAAT,EACA;CACCG,QAAAA,aAAG,CAACW,QAAJ,CAAa,KAAKd,IAAlB,EAAwB,UAAxB;CACA;CACD,KA7DF;;CAAA;CAAA;CAAA,yBAgEOe,WAhEP,EAgEiCC,QAhEjC,EAiEC;CACC,UAAID,WAAW,CAACE,UAAhB,EACA;CACCC,QAAAA,KAAK,CAACC,IAAN,CAAWJ,WAAW,CAACE,UAAvB,EACEG,OADF,CACU,UAACC,IAAD,EAAU;CAClB,cAAIL,QAAQ,CAACM,YAAT,CAAsBD,IAAI,CAACpD,IAA3B,MAAqCoD,IAAI,CAACE,KAA9C,EACA;CACCP,YAAAA,QAAQ,CAACQ,YAAT,CAAsBH,IAAI,CAACpD,IAA3B,EAAiCoD,IAAI,CAACE,KAAtC;CACA;CACD,SANF;CAQA;;CAED,UAAIR,WAAW,CAACU,SAAZ,KAA0BT,QAAQ,CAACS,SAAvC,EACA;CACCT,QAAAA,QAAQ,CAACS,SAAT,GAAqBV,WAAW,CAACU,SAAjC;CACA,OAhBF;;;CAmBC,UAAMC,eAAe,GAAGX,WAAW,CAACY,UAApC;CACA,UAAMC,YAAY,GAAGZ,QAAQ,CAACW,UAA9B;;CAEA,WAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,eAAe,CAACrF,MAApB,IAA8BwF,CAAC,GAAGD,YAAY,CAACvF,MAA/D,EAAuEwF,CAAC,EAAxE,EACA;CACC,YAAMC,OAAO,GAAGJ,eAAe,CAACG,CAAD,CAA/B;CACA,YAAME,IAAI,GAAGH,YAAY,CAACC,CAAD,CAAzB,CAFD;;CAKC,YACCC,OAAO,KAAKE,SAAZ,IACGD,IAAI,KAAKC,SAFb,EAIA;CACChB,UAAAA,QAAQ,CAACiB,MAAT,CAAgBF,IAAhB;CACA,SAXF;;;CAaC,YACCD,OAAO,KAAKE,SAAZ,IACGD,IAAI,KAAKC,SADZ,IAEGF,OAAO,CAACI,OAAR,KAAoBH,IAAI,CAACG,OAH7B,EAKA;CACC,eAAK5B,IAAL,CAAUwB,OAAV,EAAmBC,IAAnB;CACA,SApBF;;;CAsBC,YACCD,OAAO,KAAKE,SAAZ,IACGD,IAAI,KAAKC,SADZ,IAEGF,OAAO,CAACI,OAAR,KAAoBH,IAAI,CAACG,OAH7B,EAKA;CACC,cAAMC,OAAO,GAAG,KAAKC,uBAAL,CAA6BN,OAA7B,CAAhB;CAEA,eAAKxB,IAAL,CAAUwB,OAAV,EAAmBK,OAAnB;CAEAhC,UAAAA,aAAG,CAAC3C,OAAJ,CAAYuE,IAAZ,EAAkBI,OAAlB;CACA,SAjCF;;;CAmCC,YACCL,OAAO,KAAKE,SAAZ,IACGD,IAAI,KAAKC,SAFb,EAIA;CACC,cAAMG,QAAO,GAAG,KAAKC,uBAAL,CAA6BN,OAA7B,CAAhB;;CAEA,eAAKxB,IAAL,CAAUwB,OAAV,EAAmBK,QAAnB;CAEAhC,UAAAA,aAAG,CAACC,MAAJ,CAAW+B,QAAX,EAAoBnB,QAApB;CACA;CACD;CACD,KAvIF;;CAAA;CAAA;CAAA,4CA0IyBc,OA1IzB,EA2IC;CACC,UAAIA,OAAO,CAACO,QAAR,KAAqBC,IAAI,CAACC,SAA9B,EACA;CACC,eAAOC,QAAQ,CAACC,cAAT,CAAwB,EAAxB,CAAP;CACA;;CAED,aAAOD,QAAQ,CAACE,aAAT,CAAuBZ,OAAO,CAACI,OAA/B,CAAP;CACA;CAlJF;CAAA;CAAA;;KCOaS,SAAb;CAEC,qBAAYC,MAAZ,EACA;CAAA;CACC,SAAKC,QAAL,GAAgBD,MAAM,CAACC,QAAvB;CACA,SAAKC,gBAAL,GAAwBF,MAAM,CAACE,gBAA/B;CAEA,SAAK3H,KAAL,GAAa,IAAIF,KAAJ,CAAU2H,MAAM,CAACG,SAAjB,CAAb;CACA,SAAKC,KAAL,GAAa,IAAIjD,KAAJ,CAAU6C,MAAM,CAACK,SAAjB,CAAb;CAEA;;CACA,SAAKC,aAAL,GAAqBC,EAAE,CAACC,IAAH,CAAQF,aAAR,CAAsBG,OAAtB,CAA8B,KAAKR,QAAnC,CAArB;CACA,SAAKS,gBAAL,GAAwBH,EAAE,CAACI,SAAH,CAAaC,QAArC;CACA;;CAEA,SAAKC,UAAL;CACA;;CAhBF;CAAA;CAAA,iCAmBC;CACCC,MAAAA,6BAAY,CAACC,SAAb,CAAuB,sBAAvB,EAA+C,KAAKC,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAA/C;CACA;CArBF;CAAA;CAAA,6BAuBUC,SAvBV,EAuBkCC,SAvBlC,EAwBC;CACC,WAAK5I,KAAL,CAAW6I,QAAX,CAAoBF,SAApB;CACA,WAAKd,KAAL,CAAWgB,QAAX,CAAoBD,SAApB;CACA;CA3BF;CAAA;CAAA,kCA6BeE,KA7Bf,EA8BC;CAAA;;CACC,iCAA4DA,KAAK,CAACC,aAAN,EAA5D;CAAA;CAAA,UAAOrB,QAAP;CAAA,UAAiBsB,MAAjB;CAAA,UAAyBC,cAAzB;CAAA,UAAyCC,OAAzC;CAAA,UAAkDzB,MAAlD;;CAEA,UAAI,KAAKC,QAAL,KAAkBA,QAAtB,EACA;CACC;CACA;;CAED,WAAK1H,KAAL,CAAWmB,UAAX;CACA,WAAK0G,KAAL,CAAW1G,UAAX;CAEAgI,MAAAA,cAAI,CAACC,kBAAL,CACC,+BADD,EAEC,aAFD,EAGC;CACCC,QAAAA,IAAI,EAAE,OADP;CAEC1B,QAAAA,gBAAgB,EAAE,KAAKA,gBAFxB;CAGC5H,QAAAA,IAAI,EAAE;CAHP,OAHD,EASEuJ,IATF,CASO,UAACC,QAAD,EAAc;CACnB,YAAM3B,SAA2B,GAAG2B,QAAQ,CAACxJ,IAAT,CAAc6H,SAAlD;CACA,YAAME,SAAoB,GAAGyB,QAAQ,CAACxJ,IAAT,CAAc+H,SAA3C;;CAEA,QAAA,KAAI,CAAC9H,KAAL,CAAWqF,MAAX,CAAkBuC,SAAlB;;CACA,QAAA,KAAI,CAACC,KAAL,CAAWxC,MAAX,CAAkByC,SAAlB;CACA,OAfF;CAiBA;CA1DF;CAAA;CAAA;;;;;;;;"}