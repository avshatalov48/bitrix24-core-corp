{"version":3,"file":"script.js","sources":["src/chart.js","src/stats.js","src/index.js"],"sourcesContent":["import {Loc, Type} from 'main.core';\n\nexport type ChartData = {\n\tsprintName: string,\n\tplan: number,\n\tdone: number\n}\n\nexport class Chart\n{\n\tconstructor(data: Array<ChartData>)\n\t{\n\t\tthis.data = data;\n\n\t\tthis.chart = null;\n\t\tthis.loader = null;\n\t}\n\n\trenderTo(chartDiv: HTMLElement)\n\t{\n\t\tsetTimeout(() => this.create(chartDiv), 300);\n\t}\n\n\tcreate(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\t\tthis.chart.responsive.enabled = true;\n\n\t\tthis.createAxises();\n\n\t\tthis.createColumn('plan', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_PLAN_COLUMN'), '#2882b3');\n\t\tthis.createColumn('done', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_DONE_COLUMN'), '#9c1f1f');\n\n\t\tthis.createLegend();\n\n\t\tif (this.data.length === 0)\n\t\t{\n\t\t\tthis.showLoader(true);\n\t\t}\n\t}\n\n\trender(data: Array<ChartData>)\n\t{\n\t\tif (!this.chart)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.data = data;\n\n\t\tthis.chart.data = this.data;\n\n\t\tif (this.data.length > 0)\n\t\t{\n\t\t\tthis.removeLoader();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showLoader(true);\n\t\t}\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst xAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\txAxis.dataFields.category = 'sprintName';\n\t\txAxis.renderer.grid.template.location = 0;\n\t\txAxis.renderer.labels.template.adapter\n\t\t\t.add('textOutput', (text) => Type.isNil(text) ? text : text.replace(/ \\(.*/, ''))\n\t\t;\n\n\t\tconst label = xAxis.renderer.labels.template;\n\t\tlabel.wrap = true;\n\t\tlabel.maxWidth = 120;\n\n\t\tconst yAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tyAxis.min = 0;\n\t}\n\n\tcreateColumn(valueY: string, name: string, color: string): Object\n\t{\n\t\tconst series = this.chart.series.push(new am4charts.ColumnSeries());\n\t\tseries.dataFields.valueY = valueY;\n\t\tseries.dataFields.categoryX = 'sprintName';\n\t\tseries.name = name;\n\t\tseries.stroke = am4core.color(color);\n\t\tseries.fill = am4core.color(color);\n\t\tseries.columns.template.tooltipText = '{name}: [bold]{valueY}[/]';\n\n\t\treturn series;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.paddingBottom = 20;\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t}\n\n\tshowLoader(notData: boolean = false)\n\t{\n\t\tthis.removeLoader();\n\n\t\tthis.loader = this.chart.tooltipContainer.createChild(am4core.Container);\n\n\t\tthis.loader.background.fill = am4core.color('#fff');\n\t\tthis.loader.background.fillOpacity = 0.8;\n\t\tthis.loader.width = am4core.percent(100);\n\t\tthis.loader.height = am4core.percent(100);\n\n\t\tif (notData)\n\t\t{\n\t\t\tconst loaderLabel = this.loader.createChild(am4core.Label);\n\n\t\t\tloaderLabel.text = Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_NOT_DATA_LABEL');\n\t\t\tloaderLabel.align = 'center';\n\t\t\tloaderLabel.valign = 'middle';\n\t\t\tloaderLabel.fontSize = 20;\n\t\t}\n\t}\n\n\tremoveLoader()\n\t{\n\t\tif (this.loader !== null)\n\t\t{\n\t\t\tthis.loader.dispose();\n\t\t}\n\t}\n}","import {Tag, Loc, Text, Dom, Type} from 'main.core';\n\nexport type StatsData = {\n\taverage: number,\n\tmaximum: number,\n\tminimum: number\n}\n\nexport class Stats\n{\n\tconstructor(data: StatsData)\n\t{\n\t\tthis.data = data;\n\n\t\tthis.node = null;\n\t}\n\n\trenderTo(rootNode: HTMLElement)\n\t{\n\t\tthis.node = this.build();\n\n\t\tDom.append(this.node, rootNode);\n\t}\n\n\trender(data?: StatsData): HTMLElement\n\t{\n\t\tif (!Type.isUndefined(data))\n\t\t{\n\t\t\tthis.data = data;\n\t\t}\n\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.sync(this.build(), this.node);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.node = this.build();\n\t\t}\n\n\t\treturn this.node;\n\t}\n\n\tbuild(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-team-speed-stats-container\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-team-speed-stats-row\">\n\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_STATS_AVERAGE_LABEL')}</div>\n\t\t\t\t\t<div>${Text.encode(this.data.average)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-team-speed-stats-row\">\n\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_STATS_MAX_LABEL')}</div>\n\t\t\t\t\t<div>${Text.encode(this.data.maximum)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-team-speed-stats-row\">\n\t\t\t\t\t<div>${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_STATS_MIN_LABEL')}</div>\n\t\t\t\t\t<div>${Text.encode(this.data.minimum)}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowLoader()\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tDom.addClass(this.node, '--loader');\n\t\t}\n\t}\n\n\t// todo move it to Dom library\n\tsync (virtualNode: HTMLElement, realNode: HTMLElement)\n\t{\n\t\tif (virtualNode.attributes)\n\t\t{\n\t\t\tArray.from(virtualNode.attributes)\n\t\t\t\t.forEach((attr) => {\n\t\t\t\t\tif (realNode.getAttribute(attr.name) !== attr.value)\n\t\t\t\t\t{\n\t\t\t\t\t\trealNode.setAttribute(attr.name, attr.value);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\n\t\tif (virtualNode.nodeValue !== realNode.nodeValue)\n\t\t{\n\t\t\trealNode.nodeValue = virtualNode.nodeValue;\n\t\t}\n\n\t\t// Sync child nodes\n\t\tconst virtualChildren = virtualNode.childNodes;\n\t\tconst realChildren = realNode.childNodes;\n\n\t\tfor (let k = 0; k < virtualChildren.length || k < realChildren.length; k++)\n\t\t{\n\t\t\tconst virtual = virtualChildren[k];\n\t\t\tconst real = realChildren[k];\n\n\t\t\t// Remove\n\t\t\tif (\n\t\t\t\tvirtual === undefined\n\t\t\t\t&& real !== undefined\n\t\t\t)\n\t\t\t{\n\t\t\t\trealNode.remove(real);\n\t\t\t}\n\t\t\t// Update\n\t\t\tif (\n\t\t\t\tvirtual !== undefined\n\t\t\t\t&& real !== undefined\n\t\t\t\t&& virtual.tagName === real.tagName\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.sync(virtual, real);\n\t\t\t}\n\t\t\t// Replace\n\t\t\tif (\n\t\t\t\tvirtual !== undefined\n\t\t\t\t&& real !== undefined\n\t\t\t\t&& virtual.tagName !== real.tagName\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst newReal = this.createRealNodeByVirtual(virtual);\n\n\t\t\t\tthis.sync(virtual, newReal);\n\n\t\t\t\tDom.replace(real, newReal);\n\t\t\t}\n\t\t\t// Add\n\t\t\tif (\n\t\t\t\tvirtual !== undefined\n\t\t\t\t&& real === undefined\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst newReal = this.createRealNodeByVirtual(virtual);\n\n\t\t\t\tthis.sync(virtual, newReal);\n\n\t\t\t\tDom.append(newReal, realNode);\n\t\t\t}\n\t\t}\n\t}\n\n\t// todo move it to Dom library\n\tcreateRealNodeByVirtual(virtual: HTMLElement): HTMLElement\n\t{\n\t\tif (virtual.nodeType === Node.TEXT_NODE)\n\t\t{\n\t\t\treturn document.createTextNode('');\n\t\t}\n\n\t\treturn document.createElement(virtual.tagName);\n\t}\n\n}","import {ajax} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Chart, ChartData} from './chart';\nimport {Stats, StatsData} from './stats';\n\nimport '../css/base.css';\n\ntype Params = {\n\tfilterId: string,\n\tsignedParameters: string,\n\tchartData: Array<ChartData>,\n\tstatsData: StatsData\n}\n\nexport class TeamSpeed\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.filterId = params.filterId;\n\t\tthis.signedParameters = params.signedParameters;\n\n\t\tthis.chart = new Chart(params.chartData);\n\t\tthis.stats = new Stats(params.statsData);\n\n\t\t/* eslint-disable */\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t}\n\n\trenderTo(chartRoot: HTMLElement, statsRoot: HTMLElement)\n\t{\n\t\tthis.chart.renderTo(chartRoot);\n\t\tthis.stats.renderTo(statsRoot);\n\t}\n\n\tonFilterApply(event: BaseEvent)\n\t{\n\t\tconst [filterId, values, filterInstance, promise, params] = event.getCompatData();\n\n\t\tif (this.filterId !== filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.chart.showLoader();\n\t\tthis.stats.showLoader();\n\n\t\tajax.runComponentAction(\n\t\t\t'bitrix:tasks.scrum.team.speed',\n\t\t\t'applyFilter',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: {}\n\t\t\t}\n\t\t)\n\t\t\t.then((response) => {\n\t\t\t\tconst chartData: Array<ChartData> = response.data.chartData;\n\t\t\t\tconst statsData: StatsData = response.data.statsData;\n\n\t\t\t\tthis.chart.render(chartData);\n\t\t\t\tthis.stats.render(statsData);\n\t\t\t})\n\t\t;\n\t}\n}"],"names":["Chart","data","chart","loader","chartDiv","setTimeout","create","am4core","useTheme","am4themes_animated","am4charts","XYChart","paddingRight","responsive","enabled","createAxises","createColumn","Loc","getMessage","createLegend","length","showLoader","removeLoader","xAxis","xAxes","push","CategoryAxis","dataFields","category","renderer","grid","template","location","labels","adapter","add","text","Type","isNil","replace","label","wrap","maxWidth","yAxis","yAxes","ValueAxis","min","valueY","name","color","series","ColumnSeries","categoryX","stroke","fill","columns","tooltipText","legend","Legend","position","paddingBottom","itemContainers","clickable","notData","tooltipContainer","createChild","Container","background","fillOpacity","width","percent","height","loaderLabel","Label","align","valign","fontSize","dispose","Stats","node","rootNode","build","Dom","append","isUndefined","sync","Tag","render","Text","encode","average","maximum","minimum","addClass","virtualNode","realNode","attributes","Array","from","forEach","attr","getAttribute","value","setAttribute","nodeValue","virtualChildren","childNodes","realChildren","k","virtual","real","undefined","remove","tagName","newReal","createRealNodeByVirtual","nodeType","Node","TEXT_NODE","document","createTextNode","createElement","TeamSpeed","params","filterId","signedParameters","chartData","stats","statsData","filterManager","BX","Main","getById","sidePanelManager","SidePanel","Instance","bindEvents","EventEmitter","subscribe","onFilterApply","bind","chartRoot","statsRoot","renderTo","event","getCompatData","values","filterInstance","promise","ajax","runComponentAction","mode","then","response"],"mappings":"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"}