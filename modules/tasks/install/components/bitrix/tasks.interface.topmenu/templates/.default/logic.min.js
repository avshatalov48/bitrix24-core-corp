"use strict";BX.namespace("Tasks.Component");(function(){if(typeof BX.Tasks.Component.TopMenu!="undefined"){return}BX.Tasks.Component.TopMenu=BX.Tasks.Component.extend({sys:{code:"topmenu"},methodsStatic:{instances:{},getInstance:function(t){return BX.Tasks.Component.TopMenu.instances[t]},addInstance:function(t,n){BX.Tasks.Component.TopMenu.instances[t]=n}},methods:{construct:function(){this.callConstruct(BX.Tasks.Component);BX.Tasks.Component.TopMenu.addInstance(this.sys.code,this);this.userId=Number(this.option("userId"));this.ownerId=Number(this.option("ownerId"));this.groupId=Number(this.option("groupId"));this.sliderInit()},bindEvents:function(){try{var t=this.option("use_ajax_filter")?this.scope().getElementsByClassName("tasks_role_link"):{};if(t.length){for(var n=0;n<t.length;n++){BX.bind(t[n],"click",function(t){t.preventDefault();var n=t.target.className;var e=this.dataset.id=="view_all"?"":this.dataset.id;var s=this.dataset.url;if(n==="main-buttons-item-sublink "&&e===""||n==="main-buttons-item-edit-button"){return}BX.onCustomEvent("Tasks.TopMenu:onItem",[e,s]);var i=this.parentElement.getElementsByClassName("tasks_role_link");if(i.length){for(var o=0;o<i.length;o++){BX.removeClass(i[o],"main-buttons-item-active")}}BX.addClass(this,"main-buttons-item-active")})}}}catch(t){}BX.addCustomEvent("onPullEvent-tasks",function(t,n){if(t==="user_counter"){this.onUserCounter(n)}}.bind(this));BX.addCustomEvent("BX.Main.Filter:apply",function(t,n,e){this.onFilterApply(t,n,e)}.bind(this))},isMyList:function(){return this.userId===this.ownerId},onUserCounter:function(t){var n=Number(t.userId);delete t.userId;if(!this.isMyList()||this.userId!==n){return}Object.keys(t).forEach(function(n){var e=BX("tasks_panel_menu_"+(this.groupId?"group_":"")+n);if(e){e.querySelector(".main-buttons-item-counter").innerText=t[n].total||""}}.bind(this))},onFilterApply:function(t,n,e){try{var s=e.getFilterFieldsValues().ROLEID;var i=BX.Tasks.Component.TopMenu.getInstance("topmenu").scope();var o=i.querySelectorAll(".tasks_role_link");for(var a=0;a<o.length;a++){BX.removeClass(o[a],"main-buttons-item-active")}if(typeof s!=="undefined"){if(!s){s="view_all"}BX.addClass(BX("tasks_panel_menu_"+s),"main-buttons-item-active");var r=BX.Tasks.Component.TasksToolbar.getInstance();if(r){r.rerender(s)}}}catch(t){}},sliderInit:function(){if(window===window.top){top.BX.SidePanel.Instance.bindAnchors({rules:[{condition:["/tasks/config/permissions/"],loader:"default-loader",options:{cacheable:false,events:{onClose:function(){},onOpen:function(){var t=BX.Main.interfaceButtonsManager;for(var n in t.data){t.data[n].closeSubmenu()}}}}}]})}}}})}).call(this);
//# sourceMappingURL=logic.map.js