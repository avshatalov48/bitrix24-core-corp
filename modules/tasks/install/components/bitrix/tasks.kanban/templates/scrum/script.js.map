{"version":3,"file":"script.js","sources":["src/pull.item.js","src/kanban.component.js","src/kanban.manager.js"],"sourcesContent":["import {EventEmitter} from 'main.core.events';\n\nexport type UpdateParams = {\n\tid: number,\n\tgroupId: number,\n\tsourceId: number,\n\ttmpId?: string\n}\n\nexport class PullItem extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.KanbanManager.PullItem');\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap(): Object\n\t{\n\t\treturn {\n\t\t\titemUpdated: this.onItemUpdated.bind(this),\n\t\t};\n\t}\n\n\tonItemUpdated(params: UpdateParams)\n\t{\n\t\tthis.emit('itemUpdated', params);\n\t}\n}","import {ajax, Dom} from 'main.core';\n\nexport type AjaxComponentParams = {\n\tUSER_ID: number,\n\tGROUP_ID: number,\n\tGROUP_ID_FORCED: number,\n\tSPRINT_ID: number,\n\tPERSONAL: string,\n\tTIMELINE_MODE: string\n}\n\ntype Params = {\n\tfilterId: string,\n\tdefaultPresetId: string,\n\tajaxComponentPath: string,\n\tajaxComponentParams: AjaxComponentParams\n}\n\nexport class KanbanComponent\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.filterId = params.filterId;\n\t\tthis.defaultPresetId = params.defaultPresetId;\n\t\tthis.ajaxComponentPath = params.ajaxComponentPath;\n\t\tthis.ajaxComponentParams = params.ajaxComponentParams;\n\t}\n\n\tonClickSort(item: HTMLElement, order?: string)\n\t{\n\t\tif (!Dom.hasClass(item, 'menu-popup-item-accept'))\n\t\t{\n\t\t\tthis.refreshIcons(item);\n\t\t\tthis.saveSelection(order);\n\t\t}\n\t}\n\n\trefreshIcons(item: HTMLElement)\n\t{\n\t\titem.parentElement.childNodes.forEach((element) => {\n\t\t\tDom.removeClass(element, 'menu-popup-item-accept');\n\t\t})\n\n\t\tDom.addClass(item, 'menu-popup-item-accept');\n\t}\n\n\tsaveSelection(order?: string)\n\t{\n\t\tajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: this.ajaxComponentPath,\n\t\t\tdata: {\n\t\t\t\taction: 'setNewTaskOrder',\n\t\t\t\torder: (order ? order : 'desc'),\n\t\t\t\tparams: this.ajaxComponentParams,\n\t\t\t\tsessid: BX.bitrix_sessid()\n\t\t\t},\n\t\t\tonsuccess: function(data) {\n\t\t\t\tBX.onCustomEvent(this, 'onTaskSortChanged', [data]);\n\t\t\t}\n\t\t});\n\t}\n}","import {Loc, Dom, Tag, Type, Text, Event, Runtime} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {PULL as Pull} from 'pull.client';\n\nimport {PullItem, UpdateParams} from './pull.item';\n\nimport {KanbanComponent, AjaxComponentParams} from './kanban.component';\n\nimport './css/base.css';\n\ntype Column = {\n\tid: number,\n\tname: string,\n\tsort: number,\n\tcolor: string,\n\ttotal: number,\n\ttype: string\n}\n\ntype Item = {\n\tid: number,\n\tparentId: number,\n\tcolumnId: number\n}\n\ntype ParentTask = {\n\tid: number,\n\tname: string,\n\tcompleted: 'Y' | 'N',\n\tstoryPoints: string,\n\tisVisibilitySubtasks: 'Y' | 'N',\n\tparentId: number,\n\tcolumnId: number,\n\tcolumns: Array<Column>,\n\titems: Array<Item>\n}\n\ntype Params = {\n\tsignedParameters: string,\n\tfilterId: string,\n\tdefaultPresetId: string,\n\tajaxComponentPath: string,\n\tajaxComponentParams: AjaxComponentParams,\n\tsiteTemplateId: string,\n\tsprintSelected: boolean,\n\tisActiveSprint: boolean,\n\tparentTasks: {\n\t\t[id: number]: ParentTask\n\t}\n}\n\ntype KanbanParams = {\n\tcolumns: Object,\n\titems: Object,\n\tpathToTask: string,\n\tpathToTaskCreate: string,\n\tpathToUser: string,\n\taddItemInSlider: boolean,\n\tnewTaskOrder: string,\n\tsetClientDate: boolean,\n\tadmins: Object,\n\townerId: number,\n\tgroupId: number,\n\tkanbanHeader: boolean,\n\tparentTaskId?: number,\n\tparentTaskName?: string,\n\tparentTaskCompleted?: boolean\n}\n\ntype Response = {\n\tcolumns: Object,\n\titems: Object,\n\tparentTasks: {\n\t\t[id: number]: ParentTask\n\t}\n}\n\nexport class KanbanManager\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.filterId = params.filterId;\n\t\tthis.siteTemplateId = params.siteTemplateId;\n\t\tthis.ajaxComponentPath = params.ajaxComponentPath;\n\t\tthis.ajaxComponentParams = params.ajaxComponentParams;\n\t\tthis.sprintSelected = params.sprintSelected;\n\t\tthis.isActiveSprint = params.isActiveSprint;\n\n\t\tthis.kanbanHeader = null;\n\t\tthis.kanban = null;\n\t\tthis.kanbanGroupedByParentTasks = new Map();\n\n\t\tthis.parentTasks = params.parentTasks;\n\n\t\tthis.kanbanComponent = new KanbanComponent({\n\t\t\tfilterId: params.filterId,\n\t\t\tdefaultPresetId: params.defaultPresetId,\n\t\t\tajaxComponentPath: params.ajaxComponentPath,\n\t\t\tajaxComponentParams: params.ajaxComponentParams\n\t\t});\n\n\t\tthis.pullItem = new PullItem({\n\t\t\tgroupId: this.groupId\n\t\t});\n\t\tthis.pullItem.subscribe('itemUpdated', this.onItemUpdated.bind(this));\n\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', (event: BaseEvent) => {\n\t\t\tconst [filterId, values, filterInstance, promise, params] = event.getCompatData();\n\t\t\tthis.onApplyFilter(filterId, values, filterInstance, promise, params);\n\t\t});\n\n\t\tEventEmitter.subscribe('onTasksGroupSelectorChange', this.onChangeSprint.bind(this));\n\n\t\tPull.subscribe(this.pullItem);\n\t}\n\n\tdrawKanban(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tif (!this.sprintSelected)\n\t\t{\n\t\t\tthis.showNotSprintMessage(renderTo);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.inputRenderTo = renderTo;\n\t\tthis.inputKanbanParams = params;\n\n\t\tthis.drawKanbanHeader(renderTo, params);\n\t\tthis.drawKanbanWithoutGrouping(renderTo, params);\n\t\tthis.drawKanbanInGroupingMode(renderTo, params);\n\t\tthis.fillNeighborKanbans();\n\t\tthis.updateHeaderColumns();\n\n\t\tthis.adjustGroupHeadersWidth();\n\t\tEventEmitter.subscribe(this.kanbanHeader, 'Kanban.Grid:onColumnAddedAsync', () => {\n\t\t\tthis.adjustGroupHeadersWidth();\n\t\t});\n\t\tEventEmitter.subscribe(this.kanbanHeader, 'Kanban.Grid:onColumnRemovedAsync', () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.adjustGroupHeadersWidth();\n\t\t\t}, 200);\n\t\t});\n\t}\n\n\tgetKanbanHeader()\n\t{\n\t\treturn this.kanbanHeader;\n\t}\n\n\tgetKanban()\n\t{\n\t\treturn this.kanban;\n\t}\n\n\tgetKanbansGroupedByParentTasks(): Map\n\t{\n\t\treturn this.kanbanGroupedByParentTasks;\n\t}\n\n\tdrawKanbanInGroupingMode(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tDom.addClass(renderTo, 'tasks-scrum-kanban');\n\n\t\tif (this.isParentTaskGrouping())\n\t\t{\n\t\t\tfor (const parentTaskId in this.parentTasks)\n\t\t\t{\n\t\t\t\tif (this.parentTasks[parentTaskId]['isVisibilitySubtasks'] === 'N')\n\t\t\t\t{\n\t\t\t\t\tdelete this.parentTasks[parentTaskId];\n\n\t\t\t\t\tif (!this.kanban.getItem(parentTaskId))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.kanban.refreshTask(parentTaskId);\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst kanbanNode = this.createParentTaskKanbanNode(this.parentTasks[parentTaskId]);\n\t\t\t\tconst parentTaskCompleted = (this.parentTasks[parentTaskId]['completed'] === 'Y');\n\t\t\t\tif (parentTaskCompleted)\n\t\t\t\t{\n\t\t\t\t\tthis.setTextDecorationToParentTaskName(kanbanNode);\n\t\t\t\t}\n\t\t\t\tDom.append(kanbanNode, renderTo);\n\n\t\t\t\tconst tickButtonNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\t\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\t\t\tthis.toggleGroupingVisibility(kanbanNode);\n\t\t\t\t});\n\n\t\t\t\tconst container = kanbanNode.querySelector('.tasks-scrum-kanban-container');\n\t\t\t\tthis.drawKanbanGroupedByParentTasks(this.parentTasks[parentTaskId], container, params);\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawKanbanHeader(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tconst headerParams = Runtime.clone(params);\n\n\t\theaderParams.kanbanHeader = true;\n\t\theaderParams.items = [];\n\n\t\tthis.kanbanHeader = new BX.Tasks.Kanban.Grid(this.getKanbanParams(renderTo, headerParams));\n\n\t\tthis.kanbanHeader.draw();\n\t}\n\n\tdrawKanbanWithoutGrouping(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tthis.kanban = new BX.Tasks.Kanban.Grid(this.getKanbanParams(renderTo, params));\n\n\t\tEventEmitter.subscribe(\n\t\t\tthis.kanban,\n\t\t\t'Kanban.Grid:onAddParentTask',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tconst parentTask: ParentTask = baseEvent.getData();\n\t\t\t\tthis.createParentTaskKanban(parentTask);\n\t\t\t\tthis.fillNeighborKanbans();\n\t\t\t\tthis.adjustGroupHeadersWidth();\n\t\t\t\tthis.kanban.addItemsFromQueue();\n\t\t\t}\n\t\t);\n\n\t\tthis.kanban.draw();\n\t}\n\n\tdrawKanbanGroupedByParentTasks(parentTask: ParentTask, renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tconst parentTaskId = parseInt(parentTask.id, 10);\n\n\t\tconst headerParams = Runtime.clone(params);\n\n\t\theaderParams.columns = parentTask.columns;\n\t\theaderParams.items = parentTask.items;\n\t\theaderParams.parentTaskId = parentTaskId;\n\t\theaderParams.parentTaskName = parentTask.name;\n\t\theaderParams.parentTaskCompleted = (parentTask.completed === 'Y');\n\n\t\tconst kanban = new BX.Tasks.Kanban.Grid(this.getKanbanParams(renderTo, headerParams));\n\n\t\tkanban.draw();\n\n\t\tif (headerParams.parentTaskCompleted && !kanban.hasItemInProgress())\n\t\t{\n\t\t\tconst container = kanban.getRenderToContainer().closest('.tasks-scrum-parent-task-kanban');\n\t\t\tthis.downGroupingVisibility(container);\n\t\t}\n\n\t\tEventEmitter.subscribe(\n\t\t\tkanban,\n\t\t\t'Kanban.Grid:onCompleteParentTask',\n\t\t\t() => {\n\t\t\t\tthis.onCompleteParentTask(kanban);\n\t\t\t}\n\t\t);\n\n\t\tEventEmitter.subscribe(\n\t\t\tkanban,\n\t\t\t'Kanban.Grid:onRenewParentTask',\n\t\t\t() => {\n\t\t\t\tthis.onRenewParentTask(kanban);\n\t\t\t}\n\t\t);\n\n\t\tEventEmitter.subscribe(\n\t\t\tkanban,\n\t\t\t'Kanban.Grid:onProceedParentTask',\n\t\t\t() => {\n\t\t\t\tthis.onProceedParentTask(kanban);\n\t\t\t}\n\t\t);\n\n\t\tEventEmitter.subscribe(\n\t\t\tkanban,\n\t\t\t'Kanban.Grid:onAddItemInProgress',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tconst container = kanban.getRenderToContainer().closest('.tasks-scrum-parent-task-kanban');\n\t\t\t\tthis.upGroupingVisibility(container);\n\t\t\t}\n\t\t);\n\n\t\tthis.kanbanGroupedByParentTasks.set(parentTaskId, kanban);\n\t}\n\n\tfillNeighborKanbans()\n\t{\n\t\tthis.addNeighborKanban(this.kanbanHeader);\n\n\t\tthis.addNeighborKanban(this.kanban);\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tthis.addNeighborKanban(parentTaskKanban);\n\t\t});\n\t}\n\n\tcleanNeighborKanbans()\n\t{\n\t\tthis.kanbanHeader.cleanNeighborGrids();\n\n\t\tthis.kanban.cleanNeighborGrids();\n\n\t\tthis.kanbanGroupedByParentTasks\n\t\t\t.forEach((parentTaskKanban) => {\n\t\t\t\tthis.removeParentTaskKanban(parentTaskKanban);\n\t\t\t\tparentTaskKanban.cleanNeighborGrids();\n\t\t\t})\n\t\t;\n\n\t\tthis.kanbanGroupedByParentTasks.clear();\n\t}\n\n\tupdateHeaderColumns()\n\t{\n\t\tthis.kanbanHeader.updateTotals();\n\t}\n\n\taddNeighborKanban(kanban)\n\t{\n\t\tthis.kanbanHeader.addNeighborGrid(kanban);\n\n\t\tthis.kanban.addNeighborGrid(kanban);\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tparentTaskKanban.addNeighborGrid(kanban);\n\t\t});\n\t}\n\n\tgetKanbanParams(renderTo: HTMLElement, params: KanbanParams): Object\n\t{\n\t\treturn {\n\t\t\tisGroupingMode: true,\n\t\t\tgridHeader: params.kanbanHeader,\n\t\t\tparentTaskId: (params.parentTaskId ? params.parentTaskId : 0),\n\t\t\tparentTaskName: (params.parentTaskName ? params.parentTaskName : ''),\n\t\t\tparentTaskCompleted: (params.parentTaskCompleted ? params.parentTaskCompleted : false),\n\t\t\trenderTo: renderTo,\n\t\t\titemType: 'BX.Tasks.Kanban.Item',\n\t\t\tcolumnType: 'BX.Tasks.Kanban.Column',\n\t\t\tcanAddColumn: this.isActiveSprint,\n\t\t\tcanEditColumn: this.isActiveSprint,\n\t\t\tcanRemoveColumn: this.isActiveSprint,\n\t\t\tcanSortColumn: this.isActiveSprint,\n\t\t\tcanAddItem: (!params.addItemInSlider && this.isActiveSprint),\n\t\t\tcanSortItem: this.isActiveSprint,\n\t\t\tbgColor: this.siteTemplateId,\n\t\t\tcolumns: params.columns,\n\t\t\titems: params.items,\n\t\t\taddItemTitleText: Loc.getMessage('KANBAN_QUICK_TASK'),\n\t\t\taddDraftItemInfo: Loc.getMessage('KANBAN_QUICK_TASK_ITEM_INFO'),\n\t\t\tdata: {\n\t\t\t\tkanbanType: 'K',\n\t\t\t\tajaxHandlerPath: this.ajaxComponentPath,\n\t\t\t\tpathToTask: params.pathToTask,\n\t\t\t\tpathToTaskCreate: params.pathToTaskCreate,\n\t\t\t\tpathToUser: params.pathToUser,\n\t\t\t\taddItemInSlider: params.addItemInSlider,\n\t\t\t\tparams: this.ajaxComponentParams,\n\t\t\t\tgridId: this.filterId,\n\t\t\t\tnewTaskOrder: params.newTaskOrder,\n\t\t\t\tsetClientDate: params.setClientDate,\n\t\t\t\tclientDate: BX.date.format(BX.date.convertBitrixFormat(Loc.getMessage('FORMAT_DATE'))),\n\t\t\t\tclientTime: BX.date.format(BX.date.convertBitrixFormat(Loc.getMessage('FORMAT_DATETIME'))),\n\t\t\t\trights: {\n\t\t\t\t\tcanAddColumn: this.isActiveSprint,\n\t\t\t\t\tcanEditColumn: this.isActiveSprint,\n\t\t\t\t\tcanRemoveColumn: this.isActiveSprint,\n\t\t\t\t\tcanSortColumn: this.isActiveSprint,\n\t\t\t\t\tcanAddItem: this.isActiveSprint,\n\t\t\t\t\tcanSortItem: this.isActiveSprint\n\t\t\t\t},\n\t\t\t\tadmins: params.admins\n\t\t\t},\n\t\t\tmessages: {\n\t\t\t\tITEM_TITLE_PLACEHOLDER: Loc.getMessage('KANBAN_ITEM_TITLE_PLACEHOLDER'),\n\t\t\t\tCOLUMN_TITLE_PLACEHOLDER: Loc.getMessage('KANBAN_COLUMN_TITLE_PLACEHOLDER')\n\t\t\t},\n\t\t\townerId: params.ownerId,\n\t\t\tgroupId: params.groupId,\n\t\t\tisSprintView: 'Y'\n\t\t};\n\t}\n\n\tonClickSort(item: HTMLElement, order?: string)\n\t{\n\t\tthis.kanbanComponent.onClickSort(item, order);\n\t}\n\n\tonApplyFilter(filterId, values, filterInstance, promise, params)\n\t{\n\t\tthis.fadeOutKanbans();\n\n\t\tthis.kanban.ajax({\n\t\t\taction: 'applyFilter'\n\t\t}, (data: Response) => {\n\t\t\tthis.refreshKanban(this.kanban, data);\n\t\t\tthis.cleanNeighborKanbans();\n\t\t\tif (this.existsTasksGroupedBySubTasks(data))\n\t\t\t{\n\t\t\t\tObject.entries(data.parentTasks)\n\t\t\t\t\t.forEach((parentTask) => {\n\t\t\t\t\t\tconst [, parentTaskData] = parentTask;\n\t\t\t\t\t\tthis.createParentTaskKanban(parentTaskData);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t}\n\t\t\tthis.fillNeighborKanbans();\n\t\t\tthis.adjustGroupHeadersWidth();\n\t\t\tthis.fadeInKanbans();\n\t\t}, (error) => {\n\t\t\tthis.fadeInKanbans();\n\t\t});\n\t}\n\n\tonChangeSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst [currentGroup] = baseEvent.getCompatData();\n\n\t\tconst gridData = this.kanban.getData();\n\t\tgridData.params.SPRINT_ID = currentGroup.sprintId;\n\n\t\tthis.kanban.setData(gridData);\n\n\t\tthis.kanban.ajax({\n\t\t\taction: 'changeSprint'\n\t\t}, (data: Response) => {\n\t\t\tthis.cleanNeighborKanbans();\n\t\t\tthis.kanbanHeader.getColumns().forEach((column) => this.kanbanHeader.removeColumn(column));\n\t\t\tthis.kanban.getColumns().forEach((column) => this.kanban.removeColumn(column));\n\n\t\t\tthis.refreshKanban(this.kanbanHeader, data);\n\t\t\tthis.refreshKanban(this.kanban, data);\n\n\t\t\tif (this.existsTasksGroupedBySubTasks(data))\n\t\t\t{\n\t\t\t\tObject.entries(data.parentTasks)\n\t\t\t\t\t.forEach((parentTask) => {\n\t\t\t\t\t\tconst [, parentTaskData] = parentTask;\n\t\t\t\t\t\tthis.createParentTaskKanban(parentTaskData);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t}\n\t\t\tthis.fillNeighborKanbans();\n\t\t\tthis.adjustGroupHeadersWidth();\n\t\t}, (error) => {});\n\t}\n\n\tonItemUpdated(baseEvent: BaseEvent)\n\t{\n\t\tconst data: UpdateParams = baseEvent.getData();\n\n\t\tif (this.groupId !== data.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst taskId = data.sourceId;\n\n\t\tif (this.kanban.hasItem(taskId))\n\t\t{\n\t\t\tthis.kanban.refreshTask(taskId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.kanbanGroupedByParentTasks.forEach(\n\t\t\t\t(parentTaskKanban) => {\n\t\t\t\t\tif (parentTaskKanban.hasItem(taskId))\n\t\t\t\t\t{\n\t\t\t\t\t\tparentTaskKanban.refreshTask(taskId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\trefreshKanban(kanban, data)\n\t{\n\t\tkanban.resetPaginationPage();\n\t\tkanban.removeItems();\n\t\tkanban.loadData(data);\n\t}\n\n\trefreshParentTasksKanbans(data: Response)\n\t{\n\t\tconst parentTasksToRefresh = [];\n\t\tconst parentTasksToCreate = [];\n\n\t\tObject.entries(data.parentTasks).forEach((parentTask) => {\n\t\t\tconst [parentTaskId, parentTaskData] = parentTask;\n\t\t\tif (this.kanbanGroupedByParentTasks.has(parseInt(parentTaskId, 10)))\n\t\t\t{\n\t\t\t\tparentTasksToRefresh.push(parentTaskData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparentTasksToCreate.push(parentTaskData);\n\t\t\t}\n\t\t});\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban, parentTaskId) => {\n\t\t\tif (!data.parentTasks[parentTaskId])\n\t\t\t{\n\t\t\t\tthis.hideParentTaskKanban(parentTaskKanban);\n\t\t\t}\n\t\t});\n\n\t\tparentTasksToRefresh.forEach((parentTaskData: ParentTask) => {\n\t\t\tconst parentTaskKanban = this.kanbanGroupedByParentTasks.get(parseInt(parentTaskData.id, 10));\n\t\t\tthis.refreshParentTaskKanban(parentTaskKanban, parentTaskData);\n\t\t});\n\n\t\tparentTasksToCreate.forEach((parentTaskData: ParentTask) => {\n\t\t\tthis.createParentTaskKanban(parentTaskData);\n\t\t});\n\t}\n\n\trefreshParentTaskKanban(kanban, data: ParentTask)\n\t{\n\t\tkanban.resetPaginationPage();\n\t\tkanban.removeItems();\n\n\t\tconst container = kanban.getInnerContainer().closest('.tasks-scrum-parent-task-kanban');\n\t\tthis.showElement(container);\n\t\tthis.upGroupingVisibility(container);\n\n\t\tkanban.loadData(data);\n\n\t\tif (data['completed'] === 'Y')\n\t\t{\n\t\t\tthis.downGroupingVisibility(container);\n\t\t}\n\t}\n\n\tcreateParentTaskKanban(parentTaskData: ParentTask)\n\t{\n\t\tif (parentTaskData.isVisibilitySubtasks === 'N')\n\t\t{\n\t\t\tif (!this.kanban.getItem(parentTaskData.id))\n\t\t\t{\n\t\t\t\tthis.kanban.refreshTask(parentTaskData.id);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.parentTasks[parentTaskData.id] = parentTaskData;\n\n\t\tconst kanbanNode = this.createParentTaskKanbanNode(parentTaskData);\n\t\tconst parentTaskCompleted = (parentTaskData['completed'] === 'Y');\n\t\tif (parentTaskCompleted)\n\t\t{\n\t\t\tthis.setTextDecorationToParentTaskName(kanbanNode);\n\t\t}\n\t\tDom.append(kanbanNode, this.inputRenderTo);\n\n\t\tconst tickButtonNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\tthis.toggleGroupingVisibility(kanbanNode);\n\t\t});\n\n\t\tconst container = kanbanNode.querySelector('.tasks-scrum-kanban-container');\n\t\tthis.drawKanbanGroupedByParentTasks(parentTaskData, container, this.inputKanbanParams);\n\t}\n\n\thideParentTaskKanban(kanban)\n\t{\n\t\tkanban.removeItems();\n\n\t\tconst container = kanban.getInnerContainer().closest('.tasks-scrum-parent-task-kanban');\n\n\t\tthis.hideElement(container);\n\t}\n\n\tremoveParentTaskKanban(kanban)\n\t{\n\t\tDom.remove(kanban.getInnerContainer().closest('.tasks-scrum-parent-task-kanban'));\n\t}\n\n\tfadeOutKanbans()\n\t{\n\t\tthis.kanban.fadeOut();\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tparentTaskKanban.fadeOut();\n\t\t});\n\t}\n\n\tfadeInKanbans()\n\t{\n\t\tthis.kanban.fadeIn();\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tparentTaskKanban.fadeIn();\n\t\t});\n\t}\n\n\tshowNotSprintMessage(renderTo: HTMLElement)\n\t{\n\t\tconst message = this.isActiveSprint\n\t\t\t? Loc.getMessage('KANBAN_NO_ACTIVE_SPRINT')\n\t\t\t: Loc.getMessage('KANBAN_NO_COMPLETED_SPRINT')\n\t\t;\n\n\t\tDom.append(Tag.render`\n\t\t\t<div class=\"tasks-kanban__start\">\n\t\t\t\t\t${message}\n\t\t\t</div>\n\t\t`, renderTo);\n\t}\n\n\tisParentTaskGrouping(): boolean\n\t{\n\t\treturn (!Type.isArray(this.parentTasks));\n\t}\n\n\texistsTasksGroupedBySubTasks(response: Response): boolean\n\t{\n\t\treturn (!Type.isArray(response.parentTasks));\n\t}\n\n\tshowElement(element: HTMLElement)\n\t{\n\t\tDom.style(element, 'display', 'block');\n\t}\n\n\thideElement(element: HTMLElement)\n\t{\n\t\tDom.style(element, 'display', 'none');\n\t}\n\n\tcreateParentTaskKanbanNode(parentTaskData: ParentTask): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-parent-task-kanban\">\n\t\t\t\t<div class=\"tasks-scrum-kanban-group-header\" style=\"background-color: #eaeaea;\">\n\t\t\t\t\t<div class=\"tasks-scrum-kanban-group-header-tick\">\n\t\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ui-btn-icon-angle-up\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-kanban-group-header-name\">\n\t\t\t\t\t\t<a href=\"${this.getTaskUrl(parentTaskData.id)}\">${Text.encode(parentTaskData.name)}</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-kanban-group-header-story-points\" title=\"Story Points\">\n\t\t\t\t\t\t${Text.encode(parentTaskData.storyPoints)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-kanban-container\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tadjustGroupHeadersWidth()\n\t{\n\t\tconst groupHeaders = this.inputRenderTo.querySelectorAll('.tasks-scrum-kanban-group-header');\n\t\tgroupHeaders.forEach((groupHeader) => {\n\t\t\tDom.style(groupHeader, 'width', this.kanbanHeader.getColumnsWidth());\n\t\t});\n\t}\n\n\tupGroupingVisibility(baseContainer: HTMLElement)\n\t{\n\t\tconst tickButtonNode = baseContainer.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tconst container = baseContainer.querySelector('.tasks-scrum-kanban-container');\n\n\t\tDom.removeClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\t\tDom.addClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\n\t\tthis.showElement(container);\n\t}\n\n\tdownGroupingVisibility(baseContainer: HTMLElement)\n\t{\n\t\tconst tickButtonNode = baseContainer.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tconst container = baseContainer.querySelector('.tasks-scrum-kanban-container');\n\n\t\tDom.removeClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\t\tDom.addClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\n\t\tthis.hideElement(container);\n\t}\n\n\ttoggleGroupingVisibility(baseContainer: HTMLElement)\n\t{\n\t\tconst tickButtonNode = baseContainer.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tconst container = baseContainer.querySelector('.tasks-scrum-kanban-container');\n\n\t\tDom.toggleClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\t\tDom.toggleClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\n\t\tif (Dom.style(container, 'display') !== 'none')\n\t\t{\n\t\t\tthis.hideElement(container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showElement(container);\n\t\t}\n\n\t\tconst gridContainer = baseContainer.querySelector('.main-kanban-grid');\n\t\tgridContainer.scrollLeft = this.kanban.getGridContainer().scrollLeft;\n\t}\n\n\tonCompleteParentTask(kanban)\n\t{\n\t\tconst container = kanban.getRenderToContainer().closest('.tasks-scrum-parent-task-kanban');\n\n\t\tthis.setTextDecorationToParentTaskName(container);\n\t}\n\n\tonRenewParentTask(kanban)\n\t{\n\t\tconst container = kanban.getRenderToContainer().closest('.tasks-scrum-parent-task-kanban');\n\n\t\tthis.unsetTextDecorationToParentTaskName(container);\n\t}\n\n\tonProceedParentTask(kanban)\n\t{\n\t\tif (this.kanbanGroupedByParentTasks.has(kanban.getParentTaskId()))\n\t\t{\n\t\t\tthis.removeParentTaskKanban(kanban);\n\n\t\t\tthis.kanbanGroupedByParentTasks.delete(kanban.getParentTaskId());\n\t\t}\n\t}\n\n\tsetTextDecorationToParentTaskName(kanbanNode: HTMLElement)\n\t{\n\t\tconst parentTaskNameNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-name');\n\t\tDom.style(parentTaskNameNode, 'text-decoration', 'line-through');\n\t}\n\n\tunsetTextDecorationToParentTaskName(kanbanNode: HTMLElement)\n\t{\n\t\tconst parentTaskNameNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-name');\n\t\tDom.style(parentTaskNameNode, 'text-decoration', null);\n\t}\n\n\tgetTaskUrl(taskId: number): string\n\t{\n\t\treturn this.inputKanbanParams.pathToTask.replace('#task_id#', taskId);\n\t}\n}\n"],"names":["PullItem","setEventNamespace","itemUpdated","onItemUpdated","bind","params","emit","EventEmitter","KanbanComponent","filterId","defaultPresetId","ajaxComponentPath","ajaxComponentParams","item","order","Dom","hasClass","refreshIcons","saveSelection","parentElement","childNodes","forEach","element","removeClass","addClass","ajax","method","dataType","url","data","action","sessid","BX","bitrix_sessid","onsuccess","onCustomEvent","KanbanManager","groupId","parseInt","siteTemplateId","sprintSelected","isActiveSprint","kanbanHeader","kanban","kanbanGroupedByParentTasks","Map","parentTasks","kanbanComponent","pullItem","subscribe","event","getCompatData","values","filterInstance","promise","onApplyFilter","onChangeSprint","Pull","renderTo","showNotSprintMessage","inputRenderTo","inputKanbanParams","drawKanbanHeader","drawKanbanWithoutGrouping","drawKanbanInGroupingMode","fillNeighborKanbans","updateHeaderColumns","adjustGroupHeadersWidth","setTimeout","isParentTaskGrouping","parentTaskId","getItem","refreshTask","kanbanNode","createParentTaskKanbanNode","parentTaskCompleted","setTextDecorationToParentTaskName","append","tickButtonNode","querySelector","Event","toggleGroupingVisibility","container","drawKanbanGroupedByParentTasks","headerParams","Runtime","clone","items","Tasks","Kanban","Grid","getKanbanParams","draw","baseEvent","parentTask","getData","createParentTaskKanban","addItemsFromQueue","id","columns","parentTaskName","name","completed","hasItemInProgress","getRenderToContainer","closest","downGroupingVisibility","onCompleteParentTask","onRenewParentTask","onProceedParentTask","upGroupingVisibility","set","addNeighborKanban","parentTaskKanban","cleanNeighborGrids","removeParentTaskKanban","clear","updateTotals","addNeighborGrid","isGroupingMode","gridHeader","itemType","columnType","canAddColumn","canEditColumn","canRemoveColumn","canSortColumn","canAddItem","addItemInSlider","canSortItem","bgColor","addItemTitleText","Loc","getMessage","addDraftItemInfo","kanbanType","ajaxHandlerPath","pathToTask","pathToTaskCreate","pathToUser","gridId","newTaskOrder","setClientDate","clientDate","date","format","convertBitrixFormat","clientTime","rights","admins","messages","ITEM_TITLE_PLACEHOLDER","COLUMN_TITLE_PLACEHOLDER","ownerId","isSprintView","onClickSort","fadeOutKanbans","refreshKanban","cleanNeighborKanbans","existsTasksGroupedBySubTasks","Object","entries","parentTaskData","fadeInKanbans","error","currentGroup","gridData","SPRINT_ID","sprintId","setData","getColumns","column","removeColumn","taskId","sourceId","hasItem","resetPaginationPage","removeItems","loadData","parentTasksToRefresh","parentTasksToCreate","has","push","hideParentTaskKanban","get","refreshParentTaskKanban","getInnerContainer","showElement","isVisibilitySubtasks","hideElement","remove","fadeOut","fadeIn","message","Tag","render","Type","isArray","response","style","getTaskUrl","Text","encode","storyPoints","groupHeaders","querySelectorAll","groupHeader","getColumnsWidth","baseContainer","firstElementChild","toggleClass","gridContainer","scrollLeft","getGridContainer","unsetTextDecorationToParentTaskName","getParentTaskId","parentTaskNameNode","replace"],"mappings":"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"}