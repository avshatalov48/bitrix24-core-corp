{"version":3,"file":"script.js","sources":["src/kanban.component.js","src/kanban.manager.js"],"sourcesContent":["import {ajax, Dom} from 'main.core';\n\nexport type AjaxComponentParams = {\n\tUSER_ID: number,\n\tGROUP_ID: number,\n\tGROUP_ID_FORCED: number,\n\tSPRINT_ID: number,\n\tPERSONAL: string,\n\tTIMELINE_MODE: string\n}\n\ntype Params = {\n\tfilterId: string,\n\tdefaultPresetId: string,\n\tajaxComponentPath: string,\n\tajaxComponentParams: AjaxComponentParams\n}\n\nexport class KanbanComponent\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.filterId = params.filterId;\n\t\tthis.defaultPresetId = params.defaultPresetId;\n\t\tthis.ajaxComponentPath = params.ajaxComponentPath;\n\t\tthis.ajaxComponentParams = params.ajaxComponentParams;\n\t}\n\n\tonClickSort(item: HTMLElement, order?: string)\n\t{\n\t\tif (!Dom.hasClass(item, 'menu-popup-item-accept'))\n\t\t{\n\t\t\tthis.refreshIcons(item);\n\t\t\tthis.saveSelection(order);\n\t\t}\n\t}\n\n\trefreshIcons(item: HTMLElement)\n\t{\n\t\titem.parentElement.childNodes.forEach((element) => {\n\t\t\tDom.removeClass(element, 'menu-popup-item-accept');\n\t\t})\n\n\t\tDom.addClass(item, 'menu-popup-item-accept');\n\t}\n\n\tsaveSelection(order?: string)\n\t{\n\t\tajax({\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: this.ajaxComponentPath,\n\t\t\tdata: {\n\t\t\t\taction: 'setNewTaskOrder',\n\t\t\t\torder: (order ? order : 'desc'),\n\t\t\t\tparams: this.ajaxComponentParams,\n\t\t\t\tsessid: BX.bitrix_sessid()\n\t\t\t},\n\t\t\tonsuccess: function(data) {\n\t\t\t\tBX.onCustomEvent(this, 'onTaskSortChanged', [data]);\n\t\t\t}\n\t\t});\n\t}\n}","import {Loc, Dom, Tag, Type, Text, Event, Runtime} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {KanbanComponent} from './kanban.component';\nimport type {AjaxComponentParams} from './kanban.component';\n\nimport './css/base.css';\n\ntype Column = {\n\tid: number,\n\tname: string,\n\tsort: number,\n\tcolor: string,\n\ttotal: number,\n\ttype: string\n}\n\ntype Item = {\n\tid: number,\n\tparentId: number,\n\tcolumnId: number\n}\n\ntype ParentTask = {\n\tid: number,\n\tname: string,\n\tcompleted: 'Y' | 'N',\n\tstoryPoints: string,\n\tparentId: number,\n\tcolumnId: number,\n\tcolumns: Array<Column>,\n\titems: Array<Item>\n}\n\ntype Params = {\n\tsignedParameters: string,\n\tfilterId: string,\n\tdefaultPresetId: string,\n\tajaxComponentPath: string,\n\tajaxComponentParams: AjaxComponentParams,\n\tsiteTemplateId: string,\n\tsprintSelected: boolean,\n\tisActiveSprint: boolean,\n\tparentTasks: {\n\t\t[id: number]: ParentTask\n\t}\n}\n\ntype KanbanParams = {\n\tcolumns: Object,\n\titems: Object,\n\tpathToTask: string,\n\tpathToTaskCreate: string,\n\tpathToUser: string,\n\taddItemInSlider: boolean,\n\tnewTaskOrder: string,\n\tsetClientDate: boolean,\n\tadmins: Object,\n\townerId: number,\n\tgroupId: number,\n\tkanbanHeader: boolean,\n\tparentTaskId?: number,\n\tparentTaskCompleted?: boolean\n}\n\ntype ApplyFilterResponse = {\n\tcolumns: Object,\n\titems: Object,\n\tparentTasks: {\n\t\t[id: number]: ParentTask\n\t}\n}\n\nexport class KanbanManager\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.filterId = params.filterId;\n\t\tthis.siteTemplateId = params.siteTemplateId;\n\t\tthis.ajaxComponentPath = params.ajaxComponentPath;\n\t\tthis.ajaxComponentParams = params.ajaxComponentParams;\n\t\tthis.sprintSelected = params.sprintSelected;\n\t\tthis.isActiveSprint = params.isActiveSprint;\n\n\t\tthis.kanbanHeader = null;\n\t\tthis.kanban = null;\n\t\tthis.kanbanGroupedByParentTasks = new Map();\n\n\t\tthis.parentTasks = params.parentTasks;\n\n\t\tthis.kanbanComponent = new KanbanComponent({\n\t\t\tfilterId: params.filterId,\n\t\t\tdefaultPresetId: params.defaultPresetId,\n\t\t\tajaxComponentPath: params.ajaxComponentPath,\n\t\t\tajaxComponentParams: params.ajaxComponentParams\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', (event: BaseEvent) => {\n\t\t\tconst [filterId, values, filterInstance, promise, params] = event.getCompatData();\n\t\t\tthis.onApplyFilter(filterId, values, filterInstance, promise, params);\n\t\t});\n\t}\n\n\tdrawKanban(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tif (!this.sprintSelected)\n\t\t{\n\t\t\tthis.showNotSprintMessage(renderTo);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.inputRenderTo = renderTo;\n\t\tthis.inputKanbanParams = params;\n\n\t\tthis.drawKanbanHeader(renderTo, params);\n\t\tthis.drawKanbanWithoutGrouping(renderTo, params);\n\t\tthis.drawKanbanInGroupingMode(renderTo, params);\n\t\tthis.fillNeighborKanbans();\n\n\t\tthis.adjustGroupHeadersWidth();\n\t\tEventEmitter.subscribe(this.kanban, 'Kanban.Grid:onColumnAddedAsync', () => {\n\t\t\tthis.adjustGroupHeadersWidth();\n\t\t});\n\t\tEventEmitter.subscribe(this.kanban, 'Kanban.Grid:onColumnRemovedAsync', () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.adjustGroupHeadersWidth();\n\t\t\t}, 200);\n\t\t});\n\t}\n\n\tgetKanbanHeader()\n\t{\n\t\treturn this.kanbanHeader;\n\t}\n\n\tgetKanban()\n\t{\n\t\treturn this.kanban;\n\t}\n\n\tgetKanbansGroupedByParentTasks(): Map\n\t{\n\t\treturn this.kanbanGroupedByParentTasks;\n\t}\n\n\tdrawKanbanInGroupingMode(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tDom.addClass(renderTo, 'tasks-scrum-kanban');\n\n\t\tif (this.isParentTaskGrouping())\n\t\t{\n\t\t\tfor (const parentTaskId in this.parentTasks)\n\t\t\t{\n\t\t\t\tconst kanbanNode = this.createParentTaskKanbanNode(this.parentTasks[parentTaskId]);\n\t\t\t\tconst parentTaskCompleted = (this.parentTasks[parentTaskId]['completed'] === 'Y');\n\t\t\t\tif (parentTaskCompleted)\n\t\t\t\t{\n\t\t\t\t\tthis.setTextDecorationToParentTaskName(kanbanNode);\n\t\t\t\t}\n\t\t\t\tDom.append(kanbanNode, renderTo);\n\n\t\t\t\tconst tickButtonNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\t\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\t\t\tthis.toggleGroupingVisibility(kanbanNode);\n\t\t\t\t});\n\n\t\t\t\tconst container = kanbanNode.querySelector('.tasks-scrum-kanban-container');\n\t\t\t\tthis.drawKanbanGroupedByParentTasks(parentTaskId, container, params);\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawKanbanHeader(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tconst headerParams = Runtime.clone(params);\n\n\t\theaderParams.kanbanHeader = true;\n\t\theaderParams.items = [];\n\n\t\tthis.kanbanHeader = new BX.Tasks.Kanban.Grid(this.getKanbanParams(renderTo, headerParams));\n\n\t\tthis.kanbanHeader.draw();\n\t}\n\n\tdrawKanbanWithoutGrouping(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tthis.kanban = new BX.Tasks.Kanban.Grid(this.getKanbanParams(renderTo, params));\n\n\t\tthis.kanban.draw();\n\t}\n\n\tdrawKanbanGroupedByParentTasks(parentTaskId: number, renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tparentTaskId = parseInt(parentTaskId, 10);\n\n\t\tconst headerParams = Runtime.clone(params);\n\n\t\theaderParams.columns = this.parentTasks[parentTaskId]['columns'];\n\t\theaderParams.items = this.parentTasks[parentTaskId]['items'];\n\t\theaderParams.parentTaskId = parentTaskId;\n\t\theaderParams.parentTaskCompleted = (this.parentTasks[parentTaskId]['completed'] === 'Y');\n\n\t\tconst kanban = new BX.Tasks.Kanban.Grid(this.getKanbanParams(renderTo, headerParams));\n\n\t\tkanban.draw();\n\n\t\tif (headerParams.parentTaskCompleted)\n\t\t{\n\t\t\tconst container = kanban.getRenderToContainer().closest('.tasks-scrum-parent-task-kanban');\n\t\t\tthis.downGroupingVisibility(container);\n\t\t}\n\n\t\t// todo handle task complete push\n\t\tEventEmitter.subscribe(kanban, 'Kanban.Grid:onCompleteParentTask', () => {\n\t\t\tthis.onCompleteParentTask(kanban);\n\t\t});\n\n\t\tEventEmitter.subscribe(kanban, 'Kanban.Grid:onRenewParentTask', () => {\n\t\t\tthis.onRenewParentTask(kanban);\n\t\t});\n\n\t\tthis.kanbanGroupedByParentTasks.set(parentTaskId, kanban);\n\t}\n\n\tfillNeighborKanbans()\n\t{\n\t\tthis.addNeighborKanban(this.kanbanHeader);\n\n\t\tthis.addNeighborKanban(this.kanban);\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tthis.addNeighborKanban(parentTaskKanban);\n\t\t});\n\t}\n\n\taddNeighborKanban(kanban)\n\t{\n\t\tthis.kanbanHeader.addNeighborGrid(kanban);\n\n\t\tthis.kanban.addNeighborGrid(kanban);\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tparentTaskKanban.addNeighborGrid(kanban);\n\t\t});\n\t}\n\n\tgetKanbanParams(renderTo: HTMLElement, params: KanbanParams): Object\n\t{\n\t\treturn {\n\t\t\tisGroupingMode: true,\n\t\t\tgridHeader: params.kanbanHeader,\n\t\t\tparentTaskId: (params.parentTaskId ? params.parentTaskId : 0),\n\t\t\tparentTaskCompleted: (params.parentTaskCompleted ? params.parentTaskCompleted : false),\n\t\t\trenderTo: renderTo,\n\t\t\titemType: 'BX.Tasks.Kanban.Item',\n\t\t\tcolumnType: 'BX.Tasks.Kanban.Column',\n\t\t\tcanAddColumn: true,\n\t\t\tcanEditColumn: true,\n\t\t\tcanRemoveColumn: true,\n\t\t\tcanSortColumn: true,\n\t\t\tcanAddItem: true,\n\t\t\tcanSortItem: true,\n\t\t\tbgColor: this.siteTemplateId,\n\t\t\tcolumns: params.columns,\n\t\t\titems: params.items,\n\t\t\tdata: {\n\t\t\t\tkanbanType: 'K',\n\t\t\t\tajaxHandlerPath: this.ajaxComponentPath,\n\t\t\t\tpathToTask: params.pathToTask,\n\t\t\t\tpathToTaskCreate: params.pathToTaskCreate,\n\t\t\t\tpathToUser: params.pathToUser,\n\t\t\t\taddItemInSlider: params.addItemInSlider,\n\t\t\t\tparams: this.ajaxComponentParams,\n\t\t\t\tgridId: this.filterId,\n\t\t\t\tnewTaskOrder: params.newTaskOrder,\n\t\t\t\tsetClientDate: params.setClientDate,\n\t\t\t\tclientDate: BX.date.format(BX.date.convertBitrixFormat(Loc.getMessage('FORMAT_DATE'))),\n\t\t\t\tclientTime: BX.date.format(BX.date.convertBitrixFormat(Loc.getMessage('FORMAT_DATETIME'))),\n\t\t\t\trights: {\n\t\t\t\t\tcanAddColumn: true,\n\t\t\t\t\tcanEditColumn: true,\n\t\t\t\t\tcanRemoveColumn: true,\n\t\t\t\t\tcanSortColumn: true,\n\t\t\t\t\tcanAddItem: true,\n\t\t\t\t\tcanSortItem: true\n\t\t\t\t},\n\t\t\t\tadmins: params.admins\n\t\t\t},\n\t\t\tmessages: {\n\t\t\t\tITEM_TITLE_PLACEHOLDER: Loc.getMessage('KANBAN_ITEM_TITLE_PLACEHOLDER'),\n\t\t\t\tCOLUMN_TITLE_PLACEHOLDER: Loc.getMessage('KANBAN_COLUMN_TITLE_PLACEHOLDER')\n\t\t\t},\n\t\t\townerId: params.ownerId,\n\t\t\tgroupId: params.groupId,\n\t\t\tisSprintView: 'Y'\n\t\t};\n\t}\n\n\tonClickGroup(item: HTMLElement, mode: string)\n\t{\n\t\tthis.kanbanComponent.onClickGroup(item, mode);\n\t}\n\n\tonClickSort(item: HTMLElement, order?: string)\n\t{\n\t\tthis.kanbanComponent.onClickSort(item, order);\n\t}\n\n\tonApplyFilter(filterId, values, filterInstance, promise, params)\n\t{\n\t\tthis.fadeOutKanbans();\n\n\t\tthis.kanban.ajax({\n\t\t\taction: 'applyFilter'\n\t\t}, (data: ApplyFilterResponse) => {\n\t\t\tthis.refreshKanban(this.kanban, data);\n\t\t\tif (this.existsTasksGroupedBySubTasks(data))\n\t\t\t{\n\t\t\t\tthis.refreshParentTasksKanbans(data);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\t\t\tthis.hideParentTaskKanban(parentTaskKanban);\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.adjustGroupHeadersWidth();\n\t\t\tthis.fadeInKanbans();\n\t\t}, (error) => {\n\t\t\tthis.fadeInKanbans();\n\t\t});\n\t}\n\n\trefreshKanban(kanban, data)\n\t{\n\t\tkanban.removeItems();\n\t\tkanban.loadData(data);\n\t}\n\n\trefreshParentTasksKanbans(data: ApplyFilterResponse)\n\t{\n\t\tconst parentTasksToRefresh = [];\n\t\tconst parentTasksToCreate = [];\n\n\t\tObject.entries(data.parentTasks).forEach((parentTask) => {\n\t\t\tconst [parentTaskId, parentTaskData] = parentTask;\n\t\t\tif (this.kanbanGroupedByParentTasks.has(parseInt(parentTaskId, 10)))\n\t\t\t{\n\t\t\t\tparentTasksToRefresh.push(parentTaskData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparentTasksToCreate.push(parentTaskData);\n\t\t\t}\n\t\t});\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban, parentTaskId) => {\n\t\t\tif (!data.parentTasks[parentTaskId])\n\t\t\t{\n\t\t\t\tthis.hideParentTaskKanban(parentTaskKanban);\n\t\t\t}\n\t\t});\n\n\t\tparentTasksToRefresh.forEach((parentTaskData: ParentTask) => {\n\t\t\tconst parentTaskKanban = this.kanbanGroupedByParentTasks.get(parseInt(parentTaskData.id, 10));\n\t\t\tthis.refreshParentTaskKanban(parentTaskKanban, parentTaskData);\n\t\t});\n\n\t\tparentTasksToCreate.forEach((parentTaskData: ParentTask) => {\n\t\t\tthis.createParentTaskKanban(parentTaskData);\n\t\t});\n\t}\n\n\trefreshParentTaskKanban(kanban, data: ParentTask)\n\t{\n\t\tkanban.removeItems();\n\n\t\tconst container = kanban.getInnerContainer().closest('.tasks-scrum-parent-task-kanban');\n\t\tthis.showElement(container);\n\t\tthis.upGroupingVisibility(container);\n\n\t\tkanban.loadData(data);\n\n\t\tif (data['completed'] === 'Y')\n\t\t{\n\t\t\tthis.downGroupingVisibility(container);\n\t\t}\n\t}\n\n\tcreateParentTaskKanban(parentTaskData: ParentTask)\n\t{\n\t\tthis.parentTasks[parentTaskData.id] = parentTaskData;\n\n\t\tconst kanbanNode = this.createParentTaskKanbanNode(parentTaskData);\n\t\tconst parentTaskCompleted = (parentTaskData['completed'] === 'Y');\n\t\tif (parentTaskCompleted)\n\t\t{\n\t\t\tthis.setTextDecorationToParentTaskName(kanbanNode);\n\t\t}\n\t\tDom.append(kanbanNode, this.inputRenderTo);\n\n\t\tconst tickButtonNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\tthis.toggleGroupingVisibility(kanbanNode);\n\t\t});\n\n\t\tconst container = kanbanNode.querySelector('.tasks-scrum-kanban-container');\n\t\tthis.drawKanbanGroupedByParentTasks(parentTaskData.id, container, this.inputKanbanParams);\n\t}\n\n\thideParentTaskKanban(kanban)\n\t{\n\t\tkanban.removeItems();\n\n\t\tconst container = kanban.getInnerContainer().closest('.tasks-scrum-parent-task-kanban');\n\n\t\tthis.hideElement(container);\n\t}\n\n\tfadeOutKanbans()\n\t{\n\t\tthis.kanban.fadeOut();\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tparentTaskKanban.fadeOut();\n\t\t});\n\t}\n\n\tfadeInKanbans()\n\t{\n\t\tthis.kanban.fadeIn();\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tparentTaskKanban.fadeIn();\n\t\t});\n\t}\n\n\tshowNotSprintMessage(renderTo: HTMLElement)\n\t{\n\t\tconst message = this.isActiveSprint\n\t\t\t? Loc.getMessage('KANBAN_NO_ACTIVE_SPRINT')\n\t\t\t: Loc.getMessage('KANBAN_NO_COMPLETED_SPRINT')\n\t\t;\n\n\t\tDom.append(Tag.render`\n\t\t\t<div class=\"tasks-kanban-start\">\n\t\t\t\t<div class=\"tasks-kanban-start-title-sm\">\n\t\t\t\t\t${message}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`, renderTo);\n\t}\n\n\tisParentTaskGrouping(): boolean\n\t{\n\t\treturn (!Type.isArray(this.parentTasks));\n\t}\n\n\texistsTasksGroupedBySubTasks(response: ApplyFilterResponse): boolean\n\t{\n\t\treturn (!Type.isArray(response.parentTasks));\n\t}\n\n\tshowElement(element: HTMLElement)\n\t{\n\t\telement.style.display = 'block';\n\t}\n\n\thideElement(element: HTMLElement)\n\t{\n\t\telement.style.display = 'none';\n\t}\n\n\tcreateParentTaskKanbanNode(parentTaskData: ParentTask): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-parent-task-kanban\">\n\t\t\t\t<div class=\"tasks-scrum-kanban-group-header\" style=\"background-color: #eaeaea;\">\n\t\t\t\t\t<div class=\"tasks-scrum-kanban-group-header-tick\">\n\t\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ui-btn-icon-angle-up\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-kanban-group-header-name\">\n\t\t\t\t\t\t<a href=\"${this.getTaskUrl(parentTaskData.id)}\">${Text.encode(parentTaskData.name)}</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-kanban-group-header-story-points\" title=\"Story Points\">\n\t\t\t\t\t\t${Text.encode(parentTaskData.storyPoints)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-kanban-container\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tadjustGroupHeadersWidth()\n\t{\n\t\tconst groupHeaders = this.inputRenderTo.querySelectorAll('.tasks-scrum-kanban-group-header');\n\t\tgroupHeaders.forEach((groupHeader) => {\n\t\t\tgroupHeader.style.width = this.kanban.getColumnsWidth();\n\t\t});\n\t}\n\n\tupGroupingVisibility(baseContainer: HTMLElement)\n\t{\n\t\tconst tickButtonNode = baseContainer.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tconst container = baseContainer.querySelector('.tasks-scrum-kanban-container');\n\n\t\tDom.removeClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\t\tDom.addClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\n\t\tthis.showElement(container);\n\t}\n\n\tdownGroupingVisibility(baseContainer: HTMLElement)\n\t{\n\t\tconst tickButtonNode = baseContainer.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tconst container = baseContainer.querySelector('.tasks-scrum-kanban-container');\n\n\t\tDom.removeClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\t\tDom.addClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\n\t\tthis.hideElement(container);\n\t}\n\n\ttoggleGroupingVisibility(baseContainer: HTMLElement)\n\t{\n\t\tconst tickButtonNode = baseContainer.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tconst container = baseContainer.querySelector('.tasks-scrum-kanban-container');\n\n\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-up');\n\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-down');\n\n\t\tif (container.style.display !== 'none')\n\t\t{\n\t\t\tthis.hideElement(container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showElement(container);\n\t\t}\n\n\t\tconst gridContainer = baseContainer.querySelector('.main-kanban-grid');\n\t\tgridContainer.scrollLeft = this.kanban.getGridContainer().scrollLeft;\n\t}\n\n\tonCompleteParentTask(kanban)\n\t{\n\t\tconst container = kanban.getRenderToContainer().closest('.tasks-scrum-parent-task-kanban');\n\n\t\tthis.setTextDecorationToParentTaskName(container);\n\t}\n\n\tonRenewParentTask(kanban)\n\t{\n\t\tconst container = kanban.getRenderToContainer().closest('.tasks-scrum-parent-task-kanban');\n\n\t\tthis.unsetTextDecorationToParentTaskName(container);\n\t}\n\n\tsetTextDecorationToParentTaskName(kanbanNode: HTMLElement)\n\t{\n\t\tconst parentTaskNameNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-name');\n\t\tDom.style(parentTaskNameNode, 'text-decoration', 'line-through');\n\t}\n\n\tunsetTextDecorationToParentTaskName(kanbanNode: HTMLElement)\n\t{\n\t\tconst parentTaskNameNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-name');\n\t\tDom.style(parentTaskNameNode, 'text-decoration', null);\n\t}\n\n\tgetTaskUrl(taskId: number)\n\t{\n\t\treturn this.inputKanbanParams.pathToTask.replace('#task_id#', taskId);\n\t}\n}\n"],"names":["KanbanComponent","params","filterId","defaultPresetId","ajaxComponentPath","ajaxComponentParams","item","order","Dom","hasClass","refreshIcons","saveSelection","parentElement","childNodes","forEach","element","removeClass","addClass","ajax","method","dataType","url","data","action","sessid","BX","bitrix_sessid","onsuccess","onCustomEvent","KanbanManager","siteTemplateId","sprintSelected","isActiveSprint","kanbanHeader","kanban","kanbanGroupedByParentTasks","Map","parentTasks","kanbanComponent","EventEmitter","subscribe","event","getCompatData","values","filterInstance","promise","onApplyFilter","renderTo","showNotSprintMessage","inputRenderTo","inputKanbanParams","drawKanbanHeader","drawKanbanWithoutGrouping","drawKanbanInGroupingMode","fillNeighborKanbans","adjustGroupHeadersWidth","setTimeout","isParentTaskGrouping","parentTaskId","kanbanNode","createParentTaskKanbanNode","parentTaskCompleted","setTextDecorationToParentTaskName","append","tickButtonNode","querySelector","Event","bind","toggleGroupingVisibility","container","drawKanbanGroupedByParentTasks","headerParams","Runtime","clone","items","Tasks","Kanban","Grid","getKanbanParams","draw","parseInt","columns","getRenderToContainer","closest","downGroupingVisibility","onCompleteParentTask","onRenewParentTask","set","addNeighborKanban","parentTaskKanban","addNeighborGrid","isGroupingMode","gridHeader","itemType","columnType","canAddColumn","canEditColumn","canRemoveColumn","canSortColumn","canAddItem","canSortItem","bgColor","kanbanType","ajaxHandlerPath","pathToTask","pathToTaskCreate","pathToUser","addItemInSlider","gridId","newTaskOrder","setClientDate","clientDate","date","format","convertBitrixFormat","Loc","getMessage","clientTime","rights","admins","messages","ITEM_TITLE_PLACEHOLDER","COLUMN_TITLE_PLACEHOLDER","ownerId","groupId","isSprintView","mode","onClickGroup","onClickSort","fadeOutKanbans","refreshKanban","existsTasksGroupedBySubTasks","refreshParentTasksKanbans","hideParentTaskKanban","fadeInKanbans","error","removeItems","loadData","parentTasksToRefresh","parentTasksToCreate","Object","entries","parentTask","parentTaskData","has","push","get","id","refreshParentTaskKanban","createParentTaskKanban","getInnerContainer","showElement","upGroupingVisibility","hideElement","fadeOut","fadeIn","message","Tag","render","Type","isArray","response","style","display","getTaskUrl","Text","encode","name","storyPoints","groupHeaders","querySelectorAll","groupHeader","width","getColumnsWidth","baseContainer","firstElementChild","classList","toggle","gridContainer","scrollLeft","getGridContainer","unsetTextDecorationToParentTaskName","parentTaskNameNode","taskId","replace"],"mappings":"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"}