BX.namespace("Tasks.KanbanComponent");BX.Tasks.KanbanComponent.ClickSort=function(e,a){var t="desc";if(typeof a.params!=="undefined"&&typeof a.params.order!=="undefined"){t=a.params.order}if(!BX.hasClass(BX(a.layout.item),"menu-popup-item-accept")){var n=a.menuWindow.menuItems;for(var s=0,o=n.length;s<o;s++){BX.removeClass(BX(n[s].layout.item),"menu-popup-item-accept")}BX.addClass(BX(a.layout.item),"menu-popup-item-accept");BX.ajax({method:"POST",dataType:"json",url:ajaxHandlerPath,data:{action:"setNewTaskOrder",order:t,sessid:BX.bitrix_sessid(),params:ajaxParams},onsuccess:function(e){BX.onCustomEvent(this,"onTaskSortChanged",[e])}})}};BX.Tasks.KanbanComponent.filterId={};BX.Tasks.KanbanComponent.defaultPresetId={};BX.Tasks.KanbanComponent.onReady=function(){BX.bind(BX("tasks-popupMenuOptions"),"click",BX.delegate(function(){if(BX.data(BX("tasks-popupMenuOptions"),"disabled")===true){var e=new BX.PopupWindow("popupMenuOptionsDisabled",BX("tasks-popupMenuOptions"),{closeByEsc:true,angle:true,offsetLeft:5,darkMode:true,autoHide:true,zIndex:1e3,content:BX.message("TASKS_KANBAN_DIABLE_SORT_TOOLTIP")});e.show()}}));BX.addCustomEvent("Tasks.TopMenu:onItem",function(e,a){var t=BX.Main.filterManager.getById(BX.Tasks.KanbanComponent.filterId);if(!t){alert("BX.Main.filterManager not initialised");return}var n={preset_id:BX.Tasks.KanbanComponent.defaultPresetId,additional:{ROLEID:e==="view_all"?0:e}};var s=t.getApi();s.setFilter(n);window.history.pushState(null,null,a)});BX.addCustomEvent("Tasks.Toolbar:onItem",function(e){var a=BX.Main.filterManager.getById(BX.Tasks.KanbanComponent.filterId);if(!a){alert("BX.Main.filterManager not initialised");return}var t=a.getApi();var n=a.getFilterFieldsValues();if(Number(e)===12582912||Number(e)===6291456){var s={ROLEID:n.hasOwnProperty("ROLEID")?n.ROLEID:0,PROBLEM:e};t.setFields(s);t.apply()}else{s={preset_id:BX.Tasks.KanbanComponent.defaultPresetId,additional:{PROBLEM:e}};if(n.hasOwnProperty("ROLEID")){s.additional.ROLEID=n.ROLEID}t.setFilter(s)}})};BX.addCustomEvent("SidePanel.Slider:onCloseByEsc",function(e){var a=/tasks\/task\/edit/;var t=e.getSlider().getUrl();if(a.test(t)&&!confirm(BX.message("TASKS_CLOSE_PAGE_CONFIRM"))){e.denyAction()}});
//# sourceMappingURL=script.map.js