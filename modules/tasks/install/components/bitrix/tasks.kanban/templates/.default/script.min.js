BX.namespace("Tasks.KanbanComponent");BX.Tasks.KanbanComponent.ClickSort=function(e,a){var n="desc";if(typeof a.params!=="undefined"&&typeof a.params.order!=="undefined"){n=a.params.order}if(!BX.hasClass(BX(a.layout.item),"menu-popup-item-accept")){var t=a.menuWindow.menuItems;for(var s=0,o=t.length;s<o;s++){BX.removeClass(BX(t[s].layout.item),"menu-popup-item-accept")}BX.addClass(BX(a.layout.item),"menu-popup-item-accept");BX.ajax({method:"POST",dataType:"json",url:ajaxHandlerPath,data:{action:"setNewTaskOrder",order:n,sessid:BX.bitrix_sessid(),params:ajaxParams},onsuccess:function(e){BX.onCustomEvent(this,"onTaskSortChanged",[e])}})}};BX.Tasks.KanbanComponent.filterId={};BX.Tasks.KanbanComponent.defaultPresetId={};BX.Tasks.KanbanComponent.onReady=function(){BX.bind(BX("tasks-popupMenuOptions"),"click",BX.delegate(function(){if(BX.data(BX("tasks-popupMenuOptions"),"disabled")===true){var e=new BX.PopupWindow("popupMenuOptionsDisabled",BX("tasks-popupMenuOptions"),{closeByEsc:true,angle:true,offsetLeft:5,darkMode:true,autoHide:true,zIndex:1e3,content:BX.message("TASKS_KANBAN_DIABLE_SORT_TOOLTIP")});e.show()}}));BX.addCustomEvent("onKanbanChanged",BX.delegate(function(e){var a="view_all";var n=BX.Main.filterManager.getById(BX.Tasks.KanbanComponent.filterId);if(n){var t=n.getFilterFieldsValues();a=t.ROLEID||a}BX.onCustomEvent("Tasks.Toolbar.reload",[a])}));BX.addCustomEvent("Tasks.TopMenu:onItem",function(e,a){var n=BX.Main.filterManager.getById(BX.Tasks.KanbanComponent.filterId);if(!n){alert("BX.Main.filterManager not initialised");return}var t={preset_id:BX.Tasks.KanbanComponent.defaultPresetId,additional:{ROLEID:e==="view_all"?0:e}};var s=n.getApi();s.setFilter(t);window.history.pushState(null,null,a)});BX.addCustomEvent("Tasks.Toolbar:onItem",function(e){var a=BX.Main.filterManager.getById(BX.Tasks.KanbanComponent.filterId);if(!a){alert("BX.Main.filterManager not initialised");return}var n=a.getApi();var t=a.getFilterFieldsValues();if(Number(e)===12582912||Number(e)===6291456){var s={ROLEID:t.hasOwnProperty("ROLEID")?t.ROLEID:0,PROBLEM:e};n.setFields(s);n.apply()}else{s={preset_id:BX.Tasks.KanbanComponent.defaultPresetId,additional:{PROBLEM:e}};if(t.hasOwnProperty("ROLEID")){s.additional.ROLEID=t.ROLEID}n.setFilter(s)}})};BX.addCustomEvent("SidePanel.Slider:onCloseByEsc",function(e){var a=/tasks\/task\/edit/;var n=e.getSlider().getUrl();if(a.test(n)&&!confirm(BX.message("TASKS_CLOSE_PAGE_CONFIRM"))){e.denyAction()}});
//# sourceMappingURL=script.map.js