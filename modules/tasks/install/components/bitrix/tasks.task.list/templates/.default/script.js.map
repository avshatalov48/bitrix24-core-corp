{"version":3,"sources":["src/legacy.js","src/controller-task-action.js","src/controller-task-event.js","src/controller-task-repository.js","src/controller-task.js"],"names":["Action","Object","freeze","COMMENT_ADD","TASK_ADD","TASK_UPDATE","TASK_VIEW","TASK_REMOVE","USER_OPTION_CHANGED","ControllerTaskEvent","options","Type","isPlainObject","timeout","cmd","params","inx","Error","Promise","resolve","reject","items","values","tm","setInterval","length","clearTimeout","item","shift","poolItem","repository","hasOwnProperty","result","includes","TASK_ID","taskId","value","types","param","keys","command","fields","EventEmitter","emit","ControllerTaskRepository","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","collectionNear","Map","collectionGrid","collection","TaskCollection","collectionSiftThroughFilter","sets","BX","rest","callBatch","forEach","type","set","isNull","answer","_classPrivateMethodGet","get","filter","id","returnAccess","siftThroughFilter","userId","groupId","arParams","navigation","internalize","taskIds","isArrayFilled","isUndefined","init","tasks","row","Text","toNumber","ControllerTask","context","taskRepository","getValuesId","callByFilter","ownerId","pageNumber","getPageNumber","pageSize","getPageSize","then","eventLib","prepareByPoolToEmit","batchEmitByParams","push","e","poolItems","key","sort","l","r","action","sortedItems","sortedById","getItemsByType"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","file":"script.js.map","sourcesContent":[null,"export const Action = Object.freeze({\n\tCOMMENT_ADD: 'comment_add',\n\tTASK_ADD: 'task_add',\n\tTASK_UPDATE: 'task_update',\n\tTASK_VIEW: 'task_view',\n\tTASK_REMOVE: 'task_remove',\n\tUSER_OPTION_CHANGED: 'user_option_changed',\n});","import {EventEmitter} from \"main.core.events\";\nimport {Type} from \"main.core\";\n\nimport {Action} from \"./controller-task-action\";\n\n\nclass ControllerTaskEvent\n{\n\t#timeout = 0;\n\n\tconstructor(options = {})\n\t{\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\tthis.#timeout = options.timeout ?? 100;\n\t}\n\n\tresolveIdByParam(cmd, params)\n\t{\n\t\tif (this.#isDefinedAction(cmd))\n\t\t{\n\t\t\tconst inx = this.#resolveIndexByEvent(cmd, params)\n\t\t\tif (inx > 0 )\n\t\t\t{\n\t\t\t\treturn inx;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthrow new Error(\"Index is not resolved for command: \" + cmd);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// console.log('cmd is undefined', cmd);\n\t\t}\n\t}\n\n\t#resolveIndexByEvent(cmd, params)\n\t{\n\t\tlet result = '';\n\n\t\tif ([Action.TASK_ADD, Action.TASK_UPDATE, Action.TASK_REMOVE, Action.TASK_VIEW, Action.USER_OPTION_CHANGED].includes(cmd))\n\t\t{\n\t\t\tresult = params.TASK_ID\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = params.taskId;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#isDefinedAction(value)\n\t{\n\t\tconst types = Object.values(Action);\n\t\treturn types.includes(value);\n\t}\n\n\tintervalEmitByParams(params)\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tconst items = Object.values(params);\n\n\t\t\tconst tm = setInterval(() => {\n\t\t\t\tif (items.length === 0)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(tm);\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst item = items.shift();\n\t\t\t\tconst {poolItem, repository} = item;\n\n\t\t\t\t// console.log('poolItemsShift', items);\n\t\t\t\tthis.#emit(poolItem, repository);\n\n\t\t\t}, this.#timeout);\n\t\t})\n\t}\n\n\tbatchEmitByParams(params)\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tconst items = Object.values(params);\n\t\t\t// console.log('poolItemsShift', items);\n\t\t\tfor (let inx in items)\n\t\t\t{\n\t\t\t\tif (!items.hasOwnProperty(inx))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst item = items[inx];\n\t\t\t\tconst {poolItem, repository} = item;\n\n\t\t\t\tthis.#emit(poolItem, repository);\n\t\t\t}\n\n\t\t\tresolve();\n\t\t})\n\t}\n\n\t#emit(item, repository)\n\t{\n\t\tlet [param] = Object.values(item);\n\t\tlet [command] = Object.keys(item);\n\n\t\tlet params = param.fields.params;\n\t\t// console.log('repository', repository);\n\t\tEventEmitter.emit('BX.Tasks.Event:onEmit', {command, params, repository});\n\t}\n}\n\nexport\n{\n\tControllerTaskEvent\n}","import {Text, Type} from \"main.core\";\nimport {TaskCollection} from \"tasks.task-model\";\n\nclass ControllerTaskRepository\n{\n\t#repository = {\n\t\tcollectionNear: new Map(),\n\t\tcollectionGrid: new Map(),\n\t\tcollection: new TaskCollection(),\n\t\tcollectionSiftThroughFilter: new TaskCollection(),\n\t};\n\n\t#internalize(fields, params)\n\t{\n\t\tconst result = {};\n\n\t\tconst items = {\n\t\t\tcollectionSiftThroughFilter: {\n\t\t\t\tcmd: 'tasks.task.list',\n\t\t\t\tfilter: {\n\t\t\t\t\tid: fields.id,\n\t\t\t\t\treturnAccess: fields.returnAccess,\n\t\t\t\t\tsiftThroughFilter: {\n\t\t\t\t\t\tuserId: fields.siftThroughFilter.userId,\n\t\t\t\t\t\tgroupId: fields.siftThroughFilter.groupId,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tcollection: {\n\t\t\t\tcmd: 'tasks.task.list',\n\t\t\t\tfilter: {\n\t\t\t\t\tid: fields.id,\n\t\t\t\t\treturnAccess: fields.returnAccess,\n\t\t\t\t}\n\t\t\t},\n\t\t\tcollectionGrid: {\n\t\t\t\tcmd: 'tasks.task.getGridRows',\n\t\t\t\tfilter: {\n\t\t\t\t\tid: fields.id,\n\t\t\t\t},\n\t\t\t\tparams: params.arParams\n\t\t\t},\n\t\t\tcollectionNear: {\n\t\t\t\tcmd: 'tasks.task.getNearTasks',\n\t\t\t\tfilter: {\n\t\t\t\t\tid: fields.id,\n\t\t\t\t},\n\t\t\t\tnavigation: params.navigation,\n\t\t\t\tparams: params.arParams,\n\t\t\t}\n\t\t};\n\n\t\tObject.keys(items).forEach((type) => {\n\t\t\tconst item = items[type];\n\t\t\tswitch (type)\n\t\t\t{\n\t\t\t\tcase 'collection':\n\t\t\t\tcase 'collectionSiftThroughFilter':\n\t\t\t\t\tresult[type] = {\n\t\t\t\t\t\tcmd: item.cmd,\n\t\t\t\t\t\tparam: TaskCollection.internalize(item.filter),\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'collectionGrid':\n\t\t\t\tcase 'collectionNear':\n\t\t\t\t\tresult[type] = {\n\t\t\t\t\t\tcmd: item.cmd,\n\t\t\t\t\t\tparam: {\n\t\t\t\t\t\t\ttaskIds: Type.isArrayFilled(item.filter.id) ? item.filter.id : [item.filter.id],\n\t\t\t\t\t\t\tnavigation: Type.isUndefined(item?.navigation) ? null : item.navigation,\n\t\t\t\t\t\t\tarParams: item.params\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#buildQuery(items)\n\t{\n\t\tconst result = {};\n\n\t\tObject.keys(items).forEach((inx) => {\n\t\t\tconst item = items[inx];\n\t\t\tresult[inx] = [item.cmd, item.param];\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#init(type, items)\n\t{\n\t\tif (Object.keys(this.#repository).includes(type))\n\t\t{\n\t\t\tswitch (type)\n\t\t\t{\n\t\t\t\tcase 'collection':\n\t\t\t\tcase 'collectionSiftThroughFilter':\n\t\t\t\t\tthis.#repository[type].init(items.tasks)\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'collectionNear':\n\t\t\t\tcase 'collectionGrid':\n\t\t\t\t\tObject.keys(items).forEach((id) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tif (id > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst row = {};\n\t\t\t\t\t\t\trow[id] = items[id];\n\n\t\t\t\t\t\t\tthis.#repository[type].set(\n\t\t\t\t\t\t\t\tText.toNumber(id),\n\t\t\t\t\t\t\t\trow\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tcallByFilter(fields, params): Promise\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tconst items = this.#internalize(fields, params);\n\t\t\tconst sets = this.#buildQuery(items);\n\n\t\t\tif(Object.keys(sets).length > 0)\n\t\t\t{\n\t\t\t\tBX.rest.callBatch(\n\t\t\t\t\tsets,\n\t\t\t\t\t(result) => {\n\t\t\t\t\t\tObject.keys(sets).forEach((type) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet set = result[type] ?? null;\n\t\t\t\t\t\t\tif (Type.isNull(set) === false)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlet items = set.answer.result\n\t\t\t\t\t\t\t\tthis.#init(type, items);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\n\t\t\t\t\t\tresolve(this.get());\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t};\n\n\tget()\n\t{\n\t\treturn this.#repository;\n\t}\n}\n\nexport\n{\n\tControllerTaskRepository\n}","import {EventEmitter} from \"main.core.events\";\n\nimport {ControllerTaskEvent} from \"./controller-task-event\"\nimport {ControllerTaskRepository} from \"./controller-task-repository\"\nimport {Action} from \"./controller-task-action\";\n\nclass ControllerTask\n{\n\tstatic getRepositoryByCollectionPushEventsAsync(items, context)\n\t{\n\t\tconst taskRepository = new ControllerTaskRepository();\n\n\t\tconst id = ControllerTask.getValuesId(items);\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\ttaskRepository.callByFilter(\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\treturnAccess: 'Y',\n\t\t\t\t\tsiftThroughFilter: {\n\t\t\t\t\t\tuserId: context.ownerId,\n\t\t\t\t\t\tgroupId: context.groupId\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tarParams: context.arParams,\n\t\t\t\t\tnavigation: {\n\t\t\t\t\t\tpageNumber: context.getPageNumber(),\n\t\t\t\t\t\tpageSize: context.getPageSize(),\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then(() =>\n\t\t\t\t{\n\t\t\t\t\tconst repository = taskRepository.get();\n\n\t\t\t\t\tEventEmitter.emit('BX.Tasks.ControllerTask:onGetRepository', {\n\t\t\t\t\t\tparams: { items, repository }\n\t\t\t\t\t});\n\n\t\t\t\t\tresolve();\n\t\t\t\t})\n\t\t})\n\t}\n\n\tstatic emitByCollectionEventImitterEventsAsync(items)\n\t{\n\t\tconst eventLib = new ControllerTaskEvent();\n\n\t\tconst params = ControllerTask.prepareByPoolToEmit(items);\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\teventLib.batchEmitByParams(params)\n\t\t\t\t.then(() => resolve())\n\t\t})\n\t}\n\n\tstatic getValuesId(collection): ?Array\n\t{\n\t\tconst result = [];\n\n\t\ttry\n\t\t{\n\t\t\tfor (let inx in collection)\n\t\t\t{\n\t\t\t\tif (!collection.hasOwnProperty(inx))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet [cmd] = Object.keys(collection[inx]);\n\t\t\t\tlet [params] = Object.values(collection[inx]);\n\n\t\t\t\tlet id = params.fields.id;\n\t\t\t\tif (result.includes(id) === false)\n\t\t\t\t{\n\t\t\t\t\tresult.push(id)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (e) {}\n\n\t\treturn result;\n\t}\n\n\tstatic getItemsByType(poolItems, type)\n\t{\n\t\tconst result = [];\n\n\t\tObject.keys(poolItems).forEach((key) => {\n\t\t\tconst poolItem = poolItems[key];\n\n\t\t\tif (Object.keys(poolItem)[0] === type)\n\t\t\t{\n\t\t\t\tresult.push(poolItem[type].fields)\n\t\t\t}\n\t\t})\n\n\t\treturn result;\n\t}\n\n\tstatic sortedById(items)\n\t{\n\t\titems.sort((l,r) => l.id > r.id\n\t\t\t? 1\n\t\t\t: (r.id < r.id\n\t\t\t\t? -1\n\t\t\t\t: 0)\n\t\t);\n\t\t\n\t\treturn items;\n\t}\n\n\tstatic prepareByPoolToEmit(items)\n\t{\n\t\tconst result = [];\n\t\tconst action = Action.USER_OPTION_CHANGED;\n\n\t\tObject.keys(items).forEach((key) => {\n\t\t\tconst item = items[key];\n\n\t\t\tconst poolItems = item['default'].fields.params.items;\n\t\t\tconst repository = item['default'].fields.params.repository;\n\n\t\t\tlet poolItem = {};\n\t\t\tconst sortedItems = ControllerTask.sortedById(\n\t\t\t\tControllerTask.getItemsByType(poolItems, action));\n\n\t\t\tObject.keys(poolItems).forEach((key) => {\n\n\t\t\t\tif (Object.keys(poolItems[key])[0] === action)\n\t\t\t\t{\n\t\t\t\t\t// ORDER actions user_option_changed BY ASC\n\t\t\t\t\tpoolItem = {[action]: {fields: sortedItems.shift()}}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpoolItem = poolItems[key];\n\t\t\t\t}\n\n\t\t\t\tresult.push({poolItem, repository})\n\t\t\t})\n\t\t})\n\t\t// console.log('collection', result);\n\t\treturn result;\n\t}\n}\n\nexport\n{\n\tControllerTask\n}"]}