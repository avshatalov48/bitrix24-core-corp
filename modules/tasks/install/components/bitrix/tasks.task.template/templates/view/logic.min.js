"use strict";BX.namespace("Tasks.Component");(function(){if(typeof BX.Tasks.Component.TasksTaskTemplate!="undefined"){return}BX.Tasks.Component.TasksTaskTemplate=BX.Tasks.Component.extend({sys:{code:"task-template-view"},methods:{construct:function(){this.callConstruct(BX.Tasks.Component);this.initFileView()},bindEvents:function(){BX.Tasks.Util.Dispatcher.bindEvent(this.id()+"-buttons","button-click",this.onButtonClick.bind(this));if(this.option("can").edit){BX.addCustomEvent("onTaskTagSelect",BX.proxy(this.syncTags,this));this.bindControl("importance-switch","click",BX.Tasks.passCtx(this.onImportantButtonClick,this))}BX.addCustomEvent("TaskAjaxError",function(t){BX.Tasks.alert(t).then(function(){BX.reload()})})},onImportantButtonClick:function(t){var n=this.option("data").PRIORITY;var i=n==2?1:2;this.callRemote("task.template.update",{id:this.option("data").ID,data:{PRIORITY:i}}).then(function(n){if(n.isSuccess()){this.option("can").PRIORITY=i;BX.toggleClass(t,"no")}}.bind(this))},syncTags:function(t){t=t||[];if(t.length){var n=[];BX.Tasks.each(t,function(t){n.push({NAME:t.name})});t=n}this.callRemote("task.template.update",{id:this.option("data").ID,data:{SE_TAG:t}})},onButtonClick:function(t){if(t=="DELETE"){this.callRemote("task.template.delete",{id:this.option("data").ID},{},function(){BX.UI.Notification.Center.notify({content:BX.message("TASKS_NOTIFY_TASK_DELETED")});window.location=this.option("backUrl")})}},initFileView:function(){if(!this.option("publicMode")){BX.Tasks.each(this.controlAll("file-area"),function(t){top.BX.viewElementBind(t,{},function(t){return BX.type.isElementNode(t)&&(t.getAttribute("data-bx-viewer")||t.getAttribute("data-bx-image"))})})}}}})}).call(this);