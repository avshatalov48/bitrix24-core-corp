BX.namespace("Tasks.Component");(function(){TagPreItem=function(t,e){t.ID=BX.util.hashCode(t.NAME);if(typeof t.CHECKED=="undefined"){t.CHECKED=true}t.CHECKED_ATTR=t.CHECKED?"checked":"";this.data=t;this.scope=e.getNodeByTemplate("item",this.data)[0];this.ctrls={btnDelete:e.control("item-delete",this.scope),btnToggle:e.control("item-btn-toggle",this.scope)};BX.data(this.scope,"item-value",t.VALUE);for(var s in this.ctrls){if(this.ctrls[s]!=null){BX.data(this.ctrls[s],"item-value",t.VALUE)}}};BX.merge(TagPreItem.prototype,{value:function(){return this.data.VALUE},display:function(){return this.data.DISPLAY},checked:function(t){if(typeof t=="undefined"){return this.data.CHECKED}this.data.CHECKED=!!t;this.redraw()},destruct:function(){var t=this.value();BX.remove(this.scope);this.scope=null;this.ctrls=null;this.data=null;return t},redraw:function(){this.ctrls.btnToggle.checked=this.data.CHECKED},bindEvent:function(){}});BX.Tasks.Component.TaskTagsSelector=BX.Tasks.UI.ItemSet.extend({options:{registerDispatcher:true},sys:{code:"tag-item-set-pre"},methods:{construct:function(){this.vars.checked={};this.ctrls.staticItemsCheckBoxes={}},bindEvents:function(){this.callMethod(BX.Tasks.UI.ItemSet,"bindEvents");this.bindDelegateControl("click","item-btn-toggle",this.passCtx(this.setItemToggle));this.bindDelegateControl("click","item-add",this.passCtx(this.addNewItem));this.bindDelegateControl("keydown","form-item-name",BX.delegate(this.itemNameKeydown,this))},createItem:function(t){return new TagPreItem(t,this)},focusAndClear:function(){var t=this.control("form-item-name");if(BX.type.isElementNode(t)){t.value="";setTimeout(function(){t.focus()},50)}},setItemToggle:function(t){var e=BX.data(t,"item-value");var s=t.checked;if(BX.type.isNotEmptyString(e)){if(this.hasItem(e)){this.vars.items[e].checked(s)}if(typeof this.ctrls.staticItemsCheckBoxes[e]!="undefined"){this.ctrls.staticItemsCheckBoxes[e].checked=s}this.updateCheckedIndex();this.fireOnChange()}},itemNameKeydown:function(t){if(this.isEnter(t)){this.addNewItem()}},addNewItem:function(){var t=this.control("form-item-name");if(BX.type.isElementNode(t)){if(t.value.toString().length>1){var e=t.value.toString();this.addItem({NAME:e});t.value="";this.redraw();this.updateCheckedIndex();this.fireOnChange()}}},redraw:function(){var t=this.control("left-list");var e=this.control("right-list");var s=BX.create("div");var i=BX.create("div");var a=0;for(var n in this.vars.order){var c=this.vars.order[n];BX.append(this.vars.items[c].scope,!(a%2)?s:i);a++}this.moveNodePool(s,t);this.moveNodePool(i,e)},load:function(t){this.callMethod(BX.Tasks.UI.ItemSet,"load",[t]);if(typeof this.ctrls.staticItemsCheckBoxes=="undefined"){this.ctrls.staticItemsCheckBoxes={}}this.readStatic();this.updateCheckedIndex()},updateCheckedIndex:function(){this.vars.checked={};for(var t in this.vars.items){if(this.vars.items[t].checked()){this.vars.checked[t]=true}}for(var t in this.ctrls.staticItemsCheckBoxes){if(this.ctrls.staticItemsCheckBoxes[t].checked){this.vars.checked[t]=true}}},fireOnChange:function(){var t={};for(var e in this.vars.checked){t[e]={NAME:e,VALUE:e}}this.fireEvent("on-change",[t])},readStatic:function(){var t=this.control("static");if(BX.type.isElementNode(t)){var e=this.controlAll("item-btn-toggle",t);for(var s=0;s<e.length;s++){var i=BX.data(e[s],"item-value");if(BX.type.isNotEmptyString(i)){this.ctrls.staticItemsCheckBoxes[i]=e[s]}}}},setSelected:function(t){for(var e in this.vars.items){this.vars.items[e].checked(typeof t[e]!="undefined")}for(var e in this.ctrls.staticItemsCheckBoxes){this.ctrls.staticItemsCheckBoxes[e].checked=typeof t[e]!="undefined"}this.updateCheckedIndex()},unselect:function(t){this.vars.checked[t]=false;if(typeof this.vars.items[t]!="undefined"){this.vars.items[t].checked(false)}if(typeof this.ctrls.staticItemsCheckBoxes[t]!="undefined"){this.ctrls.staticItemsCheckBoxes[t].checked=false}},getDisplay:function(t){return t.NAME},getValue:function(t){return t.NAME}}})})();
//# sourceMappingURL=logic.map.js