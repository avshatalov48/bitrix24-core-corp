{"version":3,"file":"script.js","sources":["src/utility/request.sender.js","src/service/filter.js","src/counters/pull.counters.js","src/counters/counters.js","src/view/header/tabs.js","src/view/view.js","src/view/header/team.speed.button.js","src/service/disk.manager.js","src/item/task/actions.panel.js","src/item/task/taskcounts.js","src/utility/story.points.js","src/item/item.js","src/entity/group.actions.button.js","src/entity/list.items.js","src/utility/tag.searcher.js","src/utility/input.js","src/entity/entity.js","src/entity/backlog/header.js","src/entity/backlog/epic.creation.button.js","src/entity/backlog/backlog.js","src/entity/sprint/sprint.date.js","src/utility/stats.calculator.js","src/entity/sprint/stats.header.js","src/entity/sprint/completed.stats.header.js","src/entity/sprint/expired.stats.header.js","src/entity/sprint/active.stats.header.js","src/entity/sprint/stats.header.builder.js","src/entity/sprint/sprint.header.js","src/entity/sprint/events.header.js","src/entity/sprint/story.points.header.js","src/entity/sprint/sprint.js","src/service/side.panel.js","src/utility/burn.down.chart.js","src/entity/sprint/sprint.side.panel.js","src/utility/entity.storage.js","src/utility/item.style.designer.js","src/utility/dom.builder.js","src/utility/subtasks.manager.js","src/item/task/decomposition.js","src/dod/item.type.js","src/dod/type.storage.js","src/dod/tabs.js","src/dod/settings.js","src/dod/side.panel.js","src/team.speed/chart.js","src/team.speed/side.panel.js","src/utility/entity.counters.js","src/utility/filter.handler.js","src/utility/epic.js","src/pull/pull.sprint.js","src/utility/item.mover.js","src/pull/pull.item.js","src/pull/pull.epic.js","src/utility/sprint.mover.js","src/view/plan.js","src/view/header/active.sprint.action.button.js","src/view/header/robot.button.js","src/view/active.sprint.js","src/view/header/burn.down.button.js","src/view/completed.sprint.js","src/entry.js"],"sourcesContent":["import {ajax, Loc, Type} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tconstructor(options = {})\n\t{\n\t\tthis.signedParameters = (options.signedParameters ? options.signedParameters : '');\n\t\tthis.debugMode = options.debugMode;\n\t}\n\n\tgetSignedParameters(): string\n\t{\n\t\treturn this.signedParameters;\n\t}\n\n\tsendRequest(action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(action, {\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tsendRequestToComponent(data = {}, action): Promise\n\t{\n\t\tdata.debugMode = this.debugMode;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runComponentAction('bitrix:tasks.scrum', action, {\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tbatchUpdateItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchUpdateItem');\n\t}\n\n\tbatchRemoveItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchRemoveItem');\n\t}\n\n\tupdateItemSort(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItemSort');\n\t}\n\n\tupdateSprintSort(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateSprintSort');\n\t}\n\n\tcreateSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createSprint');\n\t}\n\n\tstartSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'startSprint');\n\t}\n\n\tcompleteSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'completeSprint');\n\t}\n\n\tcreateTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createTask');\n\t}\n\n\tupdateItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItem');\n\t}\n\n\tremoveItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeItem');\n\t}\n\n\tchangeTaskResponsible(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeTaskResponsible');\n\t}\n\n\tgetCurrentState(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getCurrentState');\n\t}\n\n\thasTaskInFilter(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'hasTaskInFilter');\n\t}\n\n\tremoveSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeSprint');\n\t}\n\n\tchangeSprintName(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeSprintName');\n\t}\n\n\tchangeSprintDeadline(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeSprintDeadline');\n\t}\n\n\tgetSprintCompletedItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintCompletedItems');\n\t}\n\n\tgetCompletedSprints(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getCompletedSprints');\n\t}\n\n\tgetItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getItems');\n\t}\n\n\tgetEntityCounters(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEntityCounters');\n\t}\n\n\tgetEpicDescriptionEditor(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicDescriptionEditor');\n\t}\n\n\tgetEpicDescription(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicDescription');\n\t}\n\n\tgetEpicFiles(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicFiles');\n\t}\n\n\tgetAddEpicFormButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getAddEpicFormButtons');\n\t}\n\n\tgetViewEpicFormButtonsAction(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getViewEpicFormButtons');\n\t}\n\n\tcreateEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createEpic');\n\t}\n\n\tgetEpicsList(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicsList');\n\t}\n\n\tgetEpicListUrl(): string\n\t{\n\t\treturn '/bitrix/services/main/ajax.php?mode=class&c=bitrix:tasks.scrum&action=getEpicsList';\n\t}\n\n\tattachFilesToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'attachFilesToTask');\n\t}\n\n\tattachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'attachTagToTask');\n\t}\n\n\tbatchAttachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchAttachTagToTask');\n\t}\n\n\tdeAttachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'deAttachTagToTask');\n\t}\n\n\tbatchDeattachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchDeattachTagToTask');\n\t}\n\n\tupdateItemEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItemEpic');\n\t}\n\n\tbatchUpdateItemEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchUpdateItemEpic');\n\t}\n\n\tgetEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpic');\n\t}\n\n\teditEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'editEpic');\n\t}\n\n\tremoveEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeEpic');\n\t}\n\n\tapplyFilter(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'applyFilter');\n\t}\n\n\tgetSprintStartButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintStartButtons');\n\t}\n\n\tgetSprintCompleteButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintCompleteButtons');\n\t}\n\n\tgetBurnDownChartData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getBurnDownChartData');\n\t}\n\n\tgetTeamSpeedChartData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getTeamSpeedChartData');\n\t}\n\n\tgetDodSettings(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getDodSettings');\n\t}\n\n\tgetDodChecklist(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getDodChecklist');\n\t}\n\n\tsaveDodSettings(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'saveDodSettings');\n\t}\n\n\tupdateBorderColorToLinkedItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateBorderColorToLinkedItems');\n\t}\n\n\tgetAllUsedItemBorderColors(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getAllUsedItemBorderColors');\n\t}\n\n\tgetSubTaskItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSubTaskItems');\n\t}\n\n\tcreateType(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createType');\n\t}\n\n\tchangeTypeName(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeTypeName');\n\t}\n\n\tremoveType(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeType');\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.log(response);\n\t\t\treturn;\n\t\t}\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {RequestSender} from '../utility/request.sender';\n\ntype ListTypeItem = {\n\tNAME: string,\n\tVALUE: string\n}\n\ntype ValueTypeField = {\n\tname: string,\n\tvalue: string\n}\n\ntype Params = {\n\tfilterId: string,\n\trequestSender?: RequestSender\n}\n\nexport class Filter extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Filter');\n\n\t\tthis.filterId = params.filterId;\n\t\tthis.requestSender = params.requestSender;\n\n\t\tthis.searchFieldApplied = false;\n\n\t\tthis.initUiFilterManager();\n\t\tthis.bindHandlers();\n\t}\n\n\tinitUiFilterManager()\n\t{\n\t\t/* eslint-disable */\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\t\t/* eslint-enable */\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onApplyFilter.bind(this));\n\t}\n\n\tisSearchFieldApplied(): boolean\n\t{\n\t\treturn this.searchFieldApplied;\n\t}\n\n\tgetSearchContainer(): HTMLElement\n\t{\n\t\treturn this.filterManager.getSearch().getContainer();\n\t}\n\n\tgetFilterManager()\n\t{\n\t\treturn this.filterManager;\n\t}\n\n\tscrollToSearchContainer()\n\t{\n\t\tconst filterSearchContainer = this.getSearchContainer();\n\t\tif (!this.isNodeInViewport(filterSearchContainer))\n\t\t{\n\t\t\tfilterSearchContainer.scrollIntoView(true);\n\t\t}\n\t}\n\n\tonApplyFilter(event: BaseEvent)\n\t{\n\t\tconst [filterId, values, filterInstance, promise, params] = event.getCompatData();\n\n\t\tif (filterInstance.getSearch().getSearchString())\n\t\t{\n\t\t\tthis.searchFieldApplied = true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.searchFieldApplied = false;\n\t\t}\n\n\t\tif (this.filterId !== filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams.autoResolve = false;\n\n\t\tthis.emit('applyFilter', {\n\t\t\tpromise: promise\n\t\t});\n\t}\n\n\taddItemToListTypeField(name: string, item: ListTypeItem)\n\t{\n\t\t//todo set item to list after epic crud actions\n\n\t\tconst fieldInstances = this.filterManager.getField(name);\n\t\tconst fieldOptions = this.filterManager.getFieldByName(name);\n\n\t\tif (!fieldInstances || !fieldOptions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfieldInstances.options.ITEMS.push(item);\n\t\tfieldOptions.ITEMS.push(item);\n\n\t\tconst itemsNode = fieldInstances.node.querySelector('[data-name='+name+']');\n\n\t\tconst items = Dom.attr(itemsNode, 'data-items');\n\t\titems.push(item);\n\t\tDom.attr(itemsNode, 'data-items', items);\n\t}\n\n\tsetValueToField(value: ValueTypeField)\n\t{\n\t\tconst filterApi = this.filterManager.getApi();\n\t\tconst filterFieldsValues = this.filterManager.getFilterFieldsValues();\n\n\t\tfilterFieldsValues[value.name] = value.value;\n\n\t\tfilterApi.setFields(filterFieldsValues);\n\t\tfilterApi.apply();\n\t}\n\n\tsetValuesToField(values: ValueTypeField[], resetFields = false)\n\t{\n\t\tconst filterApi = this.filterManager.getApi();\n\n\t\tlet filterFieldsValues = {};\n\t\tif (!resetFields)\n\t\t{\n\t\t\tfilterFieldsValues = this.filterManager.getFilterFieldsValues();\n\t\t}\n\n\t\tvalues.forEach((value) => {\n\t\t\tfilterFieldsValues[value.name] = value.value;\n\t\t});\n\n\t\tfilterApi.setFields(filterFieldsValues);\n\t\tfilterApi.apply();\n\t}\n\n\tgetValueFromField(value: ValueTypeField): string\n\t{\n\t\tconst filterFieldsValues = this.filterManager.getFilterFieldsValues();\n\t\treturn filterFieldsValues[value.name];\n\t}\n\n\tresetFilter()\n\t{\n\t\tthis.filterManager.resetFilter();\n\t}\n\n\tapplyFilter()\n\t{\n\t\tthis.filterManager.applyFilter();\n\t}\n\n\tisNodeInViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\t\treturn (\n\t\t\trect.top >= 0 &&\n\t\t\trect.left >= 0 &&\n\t\t\trect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n\t\t\trect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t);\n\t}\n}","import {Filter} from '../service/filter';\n\ntype Params = {\n\tfilterService: Filter,\n\tuserId: number,\n\tgroupId: number\n}\n\nexport class PullCounters\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.filterService = params.filterService;\n\t\tthis.userId = params.userId;\n\t\tthis.groupId = params.groupId;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tcomment_read_all: this.onCommentsReadAll.bind(this)\n\t\t};\n\t}\n\n\tonCommentsReadAll(data)\n\t{\n\t\tconst groupId = data.GROUP_ID;\n\n\t\tconsole.log(data);\n\t\tconsole.log(groupId && groupId === this.groupId);\n\t\tif (groupId && groupId === this.groupId)\n\t\t{\n\t\t\tthis.filterService.applyFilter();\n\t\t}\n\t}\n}","import {Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {PULL as Pull} from 'pull.client';\n\nimport {Filter} from '../service/filter';\n\nimport {PullCounters} from './pull.counters';\n\ntype Params = {\n\tfilter: Filter,\n\tisOwnerCurrentUser: boolean,\n\tuserId: number,\n\tgroupId: number\n}\n\nexport class Counters\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.filterService = params.filter;\n\n\t\tthis.isOwnerCurrentUser = params.isOwnerCurrentUser;\n\n\t\tthis.userId = parseInt(params.userId, 10);\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\tthis.filter = this.filterService.getFilterManager();\n\n\t\tthis.updateFields();\n\t\tthis.bindEvents();\n\t\tthis.subscribeToPull();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t\tEventEmitter.subscribe('Tasks.Toolbar:onItem', this.onCounterClick.bind(this));\n\t}\n\n\tsubscribeToPull()\n\t{\n\t\tPull.subscribe(new PullCounters({\n\t\t\tfilterService: this.filterService,\n\t\t\tuserId: this.userId,\n\t\t\tgroupId: this.groupId\n\t\t}));\n\t}\n\n\tonFilterApply()\n\t{\n\t\tthis.updateFields();\n\t}\n\n\tupdateFields()\n\t{\n\t\tthis.fields = this.filter.getFilterFieldsValues();\n\t}\n\n\tonCounterClick(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\n\t\tif (data.counter && data.counter.filter)\n\t\t{\n\t\t\tthis.toggleByField({[data.counter.filterField]: data.counter.filterValue});\n\t\t}\n\t}\n\n\tisFilteredByField(field)\n\t{\n\t\tif (!Object.keys(this.fields).includes(field))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Type.isArray(this.fields[field]))\n\t\t{\n\t\t\treturn this.fields[field].length > 0;\n\t\t}\n\n\t\treturn this.fields[field] !== '';\n\t}\n\n\tisFilteredByFieldValue(field, value)\n\t{\n\t\treturn this.isFilteredByField(field) && this.fields[field] === value;\n\t}\n\n\ttoggleByField(field)\n\t{\n\t\tconst name = Object.keys(field)[0];\n\t\tconst value = field[name];\n\n\t\tif (!this.isFilteredByFieldValue(name, value))\n\t\t{\n\t\t\tthis.filter.getApi().extendFilter({[name]: value});\n\t\t\treturn;\n\t\t}\n\n\t\tthis.filter.getFilterFields().forEach((field) => {\n\t\t\tif (field.getAttribute('data-name') === name)\n\t\t\t{\n\t\t\t\tthis.filter.getFields().deleteField(field);\n\t\t\t}\n\t\t});\n\n\t\tthis.filter.getSearch().apply();\n\t}\n}","import {Tag, Text} from 'main.core';\n\nimport type {Views} from '../view';\n\ntype Params = {\n\tviews: Views\n}\n\nexport class Tabs\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.views = params.views;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst planTabActiveClass = (\n\t\t\tthis.views['plan'].active\n\t\t\t? 'tasks-view-switcher--item --active'\n\t\t\t: ''\n\t\t);\n\t\tconst activeTabActiveClass = (\n\t\t\tthis.views['activeSprint'].active\n\t\t\t? 'tasks-view-switcher--item --active'\n\t\t\t: ''\n\t\t);\n\t\tconst completedTabActiveClass = (\n\t\t\tthis.views['completedSprint'].active\n\t\t\t? 'tasks-view-switcher--item --active'\n\t\t\t: ''\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-view-switcher\">\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['plan'].url}\"\n\t\t\t\t\tclass=\"tasks-view-switcher--item ${planTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['plan'].name)}</a>\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['activeSprint'].url}\"\n\t\t\t\t\tclass=\"tasks-view-switcher--item ${activeTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['activeSprint'].name)}</a>\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['completedSprint'].url}\"\n\t\t\t\t\tclass=\"tasks-view-switcher--item ${completedTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['completedSprint'].name)}</a>\n\t\t\t</div>\n\t\t`;\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Filter} from '../service/filter';\n\nimport {RequestSender} from '../utility/request.sender';\nimport {Counters} from '../counters/counters';\n\nimport {Tabs} from './header/tabs';\n\nimport '../css/base.css';\n\nexport type ViewInfo = {\n\tname: string,\n\turl: string,\n\tactive: boolean\n}\n\nexport type Views = {\n\tplan: ViewInfo,\n\tactiveSprint: ViewInfo,\n\tcompletedSprint: ViewInfo\n}\n\ntype Params = {\n\tsignedParameters: string,\n\tdebugMode: string,\n\tisOwnerCurrentUser: 'Y' | 'N',\n\tuserId: number,\n\tgroupId: number,\n\tfilterId: string\n}\n\nexport class View extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.View');\n\n\t\tthis.isOwnerCurrentUser = (params.isOwnerCurrentUser === 'Y');\n\n\t\tthis.requestSender = new RequestSender({\n\t\t\tsignedParameters: params.signedParameters,\n\t\t\tdebugMode: params.debugMode\n\t\t});\n\n\t\tthis.filter = new Filter({\n\t\t\tfilterId: params.filterId,\n\t\t\tscrumManager: this,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\n\t\tthis.userId = parseInt(params.userId, 10);\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for scrum not found');\n\t\t}\n\t}\n\n\trenderTabsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for tabs not found');\n\t\t}\n\n\t\tconst tabs = new Tabs({\n\t\t\tviews: this.views\n\t\t});\n\n\t\tDom.append(tabs.render(), container);\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for Sprint stats not found');\n\t\t}\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for buttons not found');\n\t\t}\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn this.userId;\n\t}\n\n\tgetCurrentGroupId(): number\n\t{\n\t\treturn this.groupId;\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class TeamSpeedButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.TeamSpeedButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-themes ui-btn-round ui-btn-xs\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Loc, Tag, Text} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\n\nimport '../css/disk.manager.css';\n\nexport class DiskManager extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DiskManager');\n\n\t\tthis.diskUrls = {\n\t\t\turlSelect: '/bitrix/tools/disk/uf.php?action=selectFile&SITE_ID=' + Loc.getMessage('SITE_ID'),\n\t\t\turlRenameFile: '/bitrix/tools/disk/uf.php?action=renameFile',\n\t\t\turlDeleteFile: '/bitrix/tools/disk/uf.php?action=deleteFile',\n\t\t\turlUpload: '/bitrix/tools/disk/uf.php?action=uploadFile&ncc=1'\n\t\t};\n\n\t\tthis.attachedIds = [];\n\t}\n\n\tshowAttachmentMenu(node)\n\t{\n\t\tconst controlId = Text.getRandom();\n\n\t\tthis.popup = new Popup(\n\t\t\t`disk-manager-attachment-menu-${Text.getRandom()}`,\n\t\t\tnode,\n\t\t\t{\n\t\t\t\tcontent: this.getAttachmentsLoaderContent(controlId),\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: false,\n\t\t\t});\n\n\t\tthis.popup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: controlId,\n\t\t\tcontrolName: `[${controlId}][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect: this.diskUrls.urlSelect,\n\t\t\turlRenameFile: this.diskUrls.urlRenameFile,\n\t\t\turlDeleteFile: this.diskUrls.urlDeleteFile,\n\t\t\turlUpload: this.diskUrls.urlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.popup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show']\n\t\t);\n\n\t\tEventEmitter.subscribe('onFinish', () => {\n\t\t\tthis.popup.close();\n\t\t\tthis.emit('onFinish', this.attachedIds);\n\t\t});\n\t}\n\n\tgetAttachmentsLoaderContent(controlId)\n\t{\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t<div id=\"diskuf-selectdialog-${controlId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t<div class=\"diskuf-files-block\">\n\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t<input type=\"hidden\" name=\"[${controlId}][]\" value=\"\"/>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<label for=\"file_loader_${controlId}\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${controlId}\" type=\n\t\t\t\t\t\t\t\"file\" multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.onFileUploadSuccess.bind(this));\n\t\t//todo show loader\n\n\t\treturn filesChooser;\n\t}\n\n\tonFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.attachedIds.push(fileResult.element_id.toString());\n\t}\n}","import {Dom, Event, Loc, Tag} from 'main.core';\n\nimport '../../css/actions-panel.css';\n\nexport class ActionsPanel\n{\n\tconstructor(options)\n\t{\n\t\tthis.actionPanelNodeId = 'tasks-scrum-actions-panel';\n\n\t\tthis.bindElement = options.bindElement;\n\n\t\tthis.itemList = {...{\n\t\t\ttask: {activity: false},\n\t\t\tattachment: {activity: false},\n\t\t\tdod: {activity: false},\n\t\t\tmove: {activity: false},\n\t\t\tsprint: {activity: false},\n\t\t\tbacklog: {activity: false},\n\t\t\ttags: {activity: false},\n\t\t\tepic: {activity: false},\n\t\t\tdecomposition: {activity: false},\n\t\t\tremove: {activity: false},\n\t\t}, ...options.itemList};\n\n\t\tthis.listBlockBlurNodes = new Set();\n\t}\n\n\tshowPanel()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\n\t\tconst actionsPanelContainer = this.calculatePanelPosition(this.createActionPanel());\n\n\t\tthis.setBlockBlurNode(actionsPanelContainer);\n\n\t\tDom.append(actionsPanelContainer, document.body);\n\n\t\tconst customBlur = (event) => {\n\t\t\tlet hasNode = false;\n\t\t\tthis.listBlockBlurNodes.forEach((blockBlurNode) => {\n\t\t\t\tif (blockBlurNode.contains(event.target))\n\t\t\t\t{\n\t\t\t\t\thasNode = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!hasNode)\n\t\t\t{\n\t\t\t\tDom.remove(actionsPanelContainer);\n\t\t\t\tEvent.unbind(document, 'click', customBlur);\n\t\t\t}\n\t\t};\n\t\tEvent.bind(document, 'click', customBlur);\n\n\t\tthis.bindItems();\n\n\t\tconst actionsPanel =  actionsPanelContainer.querySelector('.tasks-scrum-actions-panel');\n\t\tif (Dom.hasClass(actionsPanel.lastElementChild, 'tasks-scrum-actions-panel-separator'))\n\t\t{\n\t\t\tDom.remove(actionsPanel.lastElementChild);\n\t\t}\n\t}\n\n\tsetBlockBlurNode(node)\n\t{\n\t\tthis.listBlockBlurNodes.add(node);\n\t}\n\n\tisShown(): Boolean\n\t{\n\t\treturn Boolean(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tcreateActionPanel()\n\t{\n\t\tlet task = '';\n\t\tlet attachment = '';\n\t\tlet dod = '';\n\t\tlet move = '';\n\t\tlet sprint = '';\n\t\tlet backlog = '';\n\t\tlet tags = '';\n\t\tlet epic = '';\n\t\tlet decomposition = '';\n\t\tlet remove = '';\n\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tthis.showTaskActionButtonNodeId = 'tasks-scrum-actions-panel-btn-task';\n\t\t\ttask = Tag.render`\n\t\t\t\t<div id=\"${this.showTaskActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-task\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TASK')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tthis.showAttachmentActionButtonNodeId = 'tasks-scrum-actions-panel-btn-attachment';\n\t\t\tattachment = Tag.render`\n\t\t\t\t<div id=\"${this.showAttachmentActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-attachment\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.dod.activity)\n\t\t{\n\t\t\tthis.showDodActionButtonNodeId = 'tasks-scrum-actions-panel-btn-dod';\n\t\t\tdod = Tag.render`\n\t\t\t\t<div id=\"${this.showDodActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-dod\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tthis.showMoveActionButtonNodeId = 'tasks-scrum-actions-panel-btn-move';\n\t\t\tmove = Tag.render`\n\t\t\t\t<div id=\"${this.showMoveActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-move\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tthis.sprintActionButtonNodeId = 'tasks-scrum-actions-panel-btn-sprint';\n\t\t\tsprint = Tag.render`\n\t\t\t\t<div id=\"${this.sprintActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-sprint\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_SPRINT')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tthis.backlogActionButtonNodeId = 'tasks-scrum-actions-panel-btn-backlog';\n\t\t\tbacklog = Tag.render`\n\t\t\t\t<div id=\"${this.backlogActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-backlog\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_BACKLOG')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tthis.tagsActionButtonNodeId = 'tasks-scrum-actions-panel-btn-tags';\n\t\t\ttags = Tag.render`\n\t\t\t\t<div  id=\"${this.tagsActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TAGS')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tthis.epicActionButtonNodeId = 'tasks-scrum-actions-panel-btn-epic';\n\t\t\tepic = Tag.render`\n\t\t\t\t<div  id=\"${this.epicActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_EPIC')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tthis.decompositionActionButtonNodeId = 'tasks-scrum-actions-panel-btn-decomposition';\n\t\t\tdecomposition = Tag.render`\n\t\t\t\t<div  id=\"${this.decompositionActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-decomposition\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tthis.removeActionButtonNodeId = 'tasks-scrum-actions-panel-btn-remove';\n\t\t\tremove = Tag.render`\n\t\t\t\t<div  id=\"${this.removeActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-remove\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.actionPanelNodeId}\" class=\"tasks-scrum-actions-panel-container\">\n\t\t\t\t<div class=\"tasks-scrum-actions-panel\">\n\t\t\t\t\t${task}\n\t\t\t\t\t${attachment}\n\t\t\t\t\t${dod}\n\t\t\t\t\t${move}\n\t\t\t\t\t${sprint}\n\t\t\t\t\t${backlog}\n\t\t\t\t\t${tags}\n\t\t\t\t\t${epic}\n\t\t\t\t\t${decomposition}\n\t\t\t\t\t${remove}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tbindItems()\n\t{\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showTaskActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.task.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showAttachmentActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.attachment.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.dod.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showDodActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.dod.callback\n\t\t\t);\n\t\t}s\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showMoveActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.move.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.sprintActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.sprint.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.backlogActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.backlog.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.tagsActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.tags.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.epicActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.epic.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.removeActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.remove.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.decompositionActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.decomposition.callback\n\t\t\t);\n\t\t}\n\t}\n\n\tcalculatePanelPosition(panel: HTMLElement)\n\t{\n\t\tconst position = Dom.getPosition(this.bindElement);\n\n\t\tconst top = `${position.top}px`;\n\t\tlet left = `${position.left}px`;\n\n\t\tconst fakePanel = panel.cloneNode(true);\n\t\tfakePanel.style.visibility = 'hidden';\n\t\tfakePanel.style.top = `${position.top}px`;\n\t\tfakePanel.style.left = `${position.left}px`;\n\n\t\tDom.append(fakePanel, document.body);\n\t\tif (this.isPanelWiderThanViewport(fakePanel))\n\t\t{\n\t\t\tconst fakePanelRect = fakePanel.getBoundingClientRect();\n\t\t\tconst windowWidth = (window.innerWidth || document.documentElement.clientWidth);\n\t\t\tleft = `${fakePanelRect.left - (fakePanelRect.right - windowWidth + 40)}px`;\n\t\t}\n\t\tDom.remove(fakePanel);\n\n\t\tpanel.style.top = top;\n\t\tpanel.style.left = left;\n\t\tpanel.style.zIndex = 1100;\n\n\t\treturn panel;\n\t}\n\n\tisPanelWiderThanViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\t\tconst windowWidth = (window.innerWidth || document.documentElement.clientWidth);\n\n\t\treturn (rect.right > windowWidth);\n\t}\n}","import {Dom, Tag, Text, Type} from 'main.core';\n\ntype TaskCounter = {\n\tcolor: string,\n\tvalue: number\n}\n\ntype Params = {\n\titemId: number|string,\n\tattachedFilesCount: number,\n\tcheckListComplete: number,\n\tcheckListAll: number,\n\ttaskCounters: TaskCounter\n}\n\nexport class TaskCounts\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.setItemId(params.itemId);\n\t\tthis.setAttachedFilesCount(params.attachedFilesCount);\n\t\tthis.setCheckListComplete(params.checkListComplete);\n\t\tthis.setCheckListAll(params.checkListAll);\n\t\tthis.setTaskCounters(params.taskCounters);\n\t}\n\n\tsetItemId(itemId: number|string)\n\t{\n\t\tthis.itemId = (\n\t\t\tType.isInteger(itemId) ? parseInt(itemId, 10) :\n\t\t\t\t(Type.isString(itemId) && itemId) ? itemId : Text.getRandom()\n\t\t);\n\t}\n\n\tsetAttachedFilesCount(count: number)\n\t{\n\t\tthis.attachedFilesCount = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetAttachedFilesCount(): number\n\t{\n\t\treturn this.attachedFilesCount;\n\t}\n\n\tsetCheckListComplete(count: number)\n\t{\n\t\tthis.checkListComplete = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetCheckListComplete(): number\n\t{\n\t\treturn this.checkListComplete;\n\t}\n\n\tsetCheckListAll(count: number)\n\t{\n\t\tthis.checkListAll = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetCheckListAll(): number\n\t{\n\t\treturn this.checkListAll;\n\t}\n\n\tsetTaskCounters(taskCounter: TaskCounter)\n\t{\n\t\tif (Type.isUndefined(taskCounter))\n\t\t{\n\t\t\ttaskCounter = {\n\t\t\t\tcolor: '',\n\t\t\t\tvalue: 0\n\t\t\t};\n\t\t}\n\n\t\tthis.taskCounter = taskCounter;\n\t}\n\n\tgetTaskCounters(): TaskCounter\n\t{\n\t\treturn this.taskCounter;\n\t}\n\n\trenderIndicators(): ?HTMLElement|string\n\t{\n\t\tthis.indicatorsNodeId = 'tasks-scrum-item-indicators-' + this.itemId;\n\n\t\treturn Tag.render`\n\t\t\t<span id=\"${this.indicatorsNodeId}\" class=\"task-title-indicators\">\n\t\t\t\t<div class=\"task-attachment-counter ui-label ui-label-sm ui-label-light\">\n\t\t\t\t\t<span class=\"ui-label-inner\">${this.attachedFilesCount}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-checklist-counter ui-label ui-label-sm ui-label-light'>\n\t\t\t\t\t<span class='ui-label-inner'>${this.checkListComplete}/${this.checkListAll}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-comments-counter'>\n\t\t\t\t\t<div class='ui-counter ${this.taskCounter.color}'>\n\t\t\t\t\t\t<div class='ui-counter-inner'>${this.taskCounter.value}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.indicatorsNode = document.getElementById(this.indicatorsNodeId);\n\n\t\tthis.attachmentNode = this.indicatorsNode.querySelector('.task-attachment-counter');\n\t\tthis.checklistNode = this.indicatorsNode.querySelector('.task-checklist-counter');\n\t\tthis.commentsNode = this.indicatorsNode.querySelector('.task-comments-counter');\n\n\t\tthis.updateVisibility();\n\t}\n\n\t//todo update all object data and render\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (!this.indicatorsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.attachedFilesCount)\n\t\t{\n\t\t\tthis.attachedFilesCount = parseInt(data.attachedFilesCount, 10);\n\t\t\tthis.attachmentNode.firstElementChild.textContent = this.attachedFilesCount;\n\t\t}\n\t\tif (data.checkListComplete)\n\t\t{\n\t\t\tthis.checkListComplete = parseInt(data.checkListComplete, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\t\tif (data.checkListAll)\n\t\t{\n\t\t\tthis.checkListAll = parseInt(data.checkListAll, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\n\t\tif (data.taskCounter)\n\t\t{\n\t\t\tthis.setTaskCounters(data.taskCounter);\n\n\t\t\tconst commentCounter = this.commentsNode.querySelector('.ui-counter');\n\t\t\tconst innerCommentCounter = this.commentsNode.querySelector('.ui-counter-inner');\n\n\t\t\tcommentCounter.className = `ui-counter ${Text.encode(this.taskCounter.color)}`;\n\t\t\tinnerCommentCounter.textContent = parseInt(this.taskCounter.value, 10);\n\t\t}\n\n\t\tthis.updateVisibility();\n\t}\n\n\tupdateVisibility()\n\t{\n\t\tif (this.attachedFilesCount > 0)\n\t\t{\n\t\t\tthis.showNode(this.attachmentNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.attachmentNode);\n\t\t}\n\n\t\tif (this.checkListAll > 0)\n\t\t{\n\t\t\tthis.showNode(this.checklistNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.checklistNode);\n\t\t}\n\n\t\tif (this.taskCounter.value > 0)\n\t\t{\n\t\t\tthis.showNode(this.commentsNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.commentsNode);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'inline-flex');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}","import {Type} from 'main.core';\n\nexport class StoryPoints\n{\n\tconstructor()\n\t{\n\t\tthis.clearPoints();\n\n\t\tthis.differencePoints = 0;\n\t}\n\n\tsetPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.saveDifferencePoints((this.storyPoints ? this.storyPoints : 0), storyPoints);\n\n\t\tthis.storyPoints = String(storyPoints);\n\t}\n\n\tgetPoints(): string\n\t{\n\t\treturn String(this.storyPoints);\n\t}\n\n\taddPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStoryPoints = (this.storyPoints !== '' ? parseFloat(this.storyPoints) : 0);\n\t\tconst inputStoryPoints = parseFloat(storyPoints);\n\n\t\tlet result = (currentStoryPoints + inputStoryPoints);\n\n\t\tif (Type.isFloat(result))\n\t\t{\n\t\t\tresult = result.toFixed(1);\n\t\t}\n\n\t\tthis.storyPoints = String(result);\n\t}\n\n\tsubtractPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStoryPoints = (this.storyPoints !== '' ? parseFloat(this.storyPoints) : 0);\n\t\tconst inputStoryPoints = parseFloat(storyPoints);\n\n\t\tlet result = (currentStoryPoints - inputStoryPoints);\n\n\t\tif (Type.isFloat(result))\n\t\t{\n\t\t\tresult = result.toFixed(1);\n\t\t}\n\n\t\tthis.storyPoints = String(result);\n\t}\n\n\tclearPoints()\n\t{\n\t\tthis.storyPoints = '';\n\t}\n\n\tsaveDifferencePoints(firstPoints: string, secondPoints: string)\n\t{\n\t\tthis.differencePoints = 0;\n\n\t\tif (Type.isUndefined(firstPoints) || isNaN(parseFloat(firstPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isUndefined(secondPoints) || isNaN(parseFloat(secondPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfirstPoints = parseFloat(firstPoints);\n\t\tsecondPoints = parseFloat(secondPoints);\n\n\t\tthis.differencePoints = (secondPoints - firstPoints);\n\t}\n\n\tgetDifferencePoints(): number\n\t{\n\t\treturn this.differencePoints;\n\t}\n}","import {Type, Dom, Event, Tag, Text, Loc, Runtime} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Label} from 'ui.label';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {Dialog} from 'ui.entity-selector';\n\nimport {DiskManager} from '../service/disk.manager';\n\nimport {ActionsPanel} from './task/actions.panel';\nimport {TaskCounts} from './task/taskcounts';\n\nimport {StoryPoints} from '../utility/story.points';\n\nimport '../css/item.css';\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\nexport type EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tinfo: EpicInfoType\n}\n\ntype AllowedActions = {\n\ttask_edit: boolean,\n\ttask_remove: boolean,\n}\n\nexport type Responsible = {\n\tid: number,\n\tname: string,\n\tpathToUser: string,\n\tphoto: {\n\t\tsrc: string\n\t}\n}\n\ntype ItemInfo = {\n\tcolor?: string,\n\tborderColor?: string\n}\n\ntype SubTaskInfo = {\n\tsourceId: number,\n\tcompleted: 'Y' | 'N',\n\tstoryPoints: string | StoryPoints\n}\n\ntype SubTasksInfo = {\n\t[sourceId: number]: SubTaskInfo\n}\n\nexport type ItemParams = {\n\titemId: number|string,\n\ttmpId: string,\n\tname: string,\n\titemType?: string,\n\tsort?: number,\n\tinfo?: ItemInfo,\n\tentityId?: number,\n\tentityType?: string,\n\tparentId?: number,\n\tsourceId?: number,\n\tresponsible?: Responsible,\n\tstoryPoints?: string,\n\tcompleted?: 'Y' | 'N',\n\tallowedActions?: AllowedActions,\n\tepic?: EpicType,\n\ttags?: Array,\n\tisParentTask?: 'Y' | 'N',\n\tsubTasksCount?: number,\n\tsubTasksInfo?: SubTasksInfo,\n\tisLinkedTask?: 'Y' | 'N',\n\tparentTaskId?: number,\n\tisSubTask?: 'Y' | 'N'\n};\n\n//todo single responsibility principle\nexport class Item extends EventEmitter\n{\n\tconstructor(params: ItemParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item');\n\n\t\tthis.setItemParams(params);\n\n\t\tthis.groupMode = false;\n\t\tthis.previewMode = false;\n\t}\n\n\tsetItemParams(params: ItemParams)\n\t{\n\t\tthis.setItemNode();\n\n\t\tthis.setItemId(params.itemId);\n\t\tthis.setTmpId(params.tmpId);\n\t\tthis.setName(params.name);\n\t\tthis.setItemType(params.itemType);\n\t\tthis.setSort(params.sort);\n\t\tthis.setEntityId(params.entityId);\n\t\tthis.setEntityType(params.entityType);\n\t\tthis.setParentId(params.parentId);\n\t\tthis.setSourceId(params.sourceId);\n\t\tthis.setInfo(params.info);\n\n\t\tthis.setParentTask(params.isParentTask);\n\t\tthis.setSubTasksCount(params.subTasksCount);\n\t\tthis.setLinkedTask(params.isLinkedTask);\n\t\tthis.setParentTaskId(params.parentTaskId);\n\t\tthis.setSubTask(params.isSubTask);\n\t\tthis.setSubTasksInfo(params.subTasksInfo);\n\t\tthis.setResponsible(params.responsible);\n\t\tthis.setCompleted(params.completed);\n\t\tthis.setDisableStatus(this.isCompleted());\n\t\tthis.setAllowedActions(params.allowedActions);\n\t\tthis.setEpic(params.epic);\n\t\tthis.setTags(params.tags);\n\t\tthis.setTaskCounts(params);\n\n\t\tthis.setStoryPoints(params.storyPoints);\n\t}\n\n\tstatic buildItem(params: ItemParams): Item\n\t{\n\t\treturn new Item(params);\n\t}\n\n\tsetItemId(itemId: number|string)\n\t{\n\t\tthis.itemId = (\n\t\t\tType.isInteger(itemId) ? parseInt(itemId, 10) :\n\t\t\t\t(Type.isString(itemId) && itemId) ? itemId : Text.getRandom()\n\t\t);\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.getItemNode().dataset.itemId = this.itemId;\n\t\t}\n\t}\n\n\tgetItemId()\n\t{\n\t\treturn this.itemId;\n\t}\n\n\tsetTmpId(tmpId: string)\n\t{\n\t\tthis.tmpId = (Type.isString(tmpId) ? tmpId : '');\n\t}\n\n\tgetTmpId(): string\n\t{\n\t\treturn this.tmpId;\n\t}\n\n\tsetName(name: string)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : 'Name');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name-field');\n\t\t\tnameNode.querySelector('.ui-ctl-element').textContent = Text.encode(this.name);\n\t\t}\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetItemType(type: string)\n\t{\n\t\tthis.itemType = (Type.isString(type) ? type : 'task');\n\t}\n\n\tgetItemType()\n\t{\n\t\treturn this.itemType;\n\t}\n\n\tsetSort(sort: number)\n\t{\n\t\tthis.setPreviousSort(this.sort);\n\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tDom.attr(this.getItemNode(), 'data-sort', this.sort);\n\t\t}\n\t}\n\n\tgetSort(): number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetPreviousSort(sort: number)\n\t{\n\t\tthis.previousSort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\t}\n\n\tgetPreviousSort(): number\n\t{\n\t\treturn this.previousSort;\n\t}\n\n\tsetEntityId(entityId: number)\n\t{\n\t\tthis.entityId = (Type.isInteger(entityId) ? parseInt(entityId, 10) : 0);\n\t}\n\n\tgetEntityId(): number\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tsetEntityType(entityType: string)\n\t{\n\t\tthis.entityType = (new Set(['backlog', 'sprint']).has(entityType) ? entityType : 'backlog');\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.entityType;\n\t}\n\n\tsetParentId(parentId: number)\n\t{\n\t\tthis.parentId = (Type.isInteger(parentId) ? parseInt(parentId, 10) : 0);\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetSourceId(sourceId: number)\n\t{\n\t\tthis.sourceId = (Type.isInteger(sourceId) ? parseInt(sourceId, 10) : 0);\n\t}\n\n\tgetSourceId()\n\t{\n\t\treturn this.sourceId;\n\t}\n\n\tsetResponsible(responsible: Responsible)\n\t{\n\t\tthis.responsible = (Type.isPlainObject(responsible) ? responsible : null);\n\n\t\tif (this.responsible && this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateResponsible();\n\t\t}\n\t}\n\n\tgetResponsible(): Responsible\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.storyPoints)\n\t\t{\n\t\t\tthis.storyPoints = new StoryPoints();\n\t\t}\n\n\t\tthis.storyPoints.setPoints(storyPoints);\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\tif (this.isParentTask())\n\t\t{\n\t\t\tconst storyPoints = new StoryPoints();\n\n\t\t\tObject.values(this.getSubTasksInfo()).map((subTaskInfo: SubTaskInfo) => {\n\t\t\t\tif (subTaskInfo.storyPoints instanceof StoryPoints)\n\t\t\t\t{\n\t\t\t\t\tstoryPoints.addPoints(subTaskInfo.storyPoints.getPoints());\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn storyPoints;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.storyPoints;\n\t\t}\n\t}\n\n\tupdateStoryPointsNode()\n\t{\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tconst storyPointsNode = this.getItemNode().querySelector('.tasks-scrum-item-story-points');\n\t\t\tstoryPointsNode.querySelector('.ui-ctl-element').textContent = Text.encode(\n\t\t\t\tthis.getStoryPoints().getPoints()\n\t\t\t);\n\n\t\t\tthis.sendEventToUpdateStoryPoints();\n\t\t}\n\t}\n\n\tsetSubTasksInfo(subTasksInfo: SubTasksInfo)\n\t{\n\t\tif (Type.isUndefined(subTasksInfo))\n\t\t{\n\t\t\tthis.subTasksInfo = [];\n\n\t\t\treturn;\n\t\t}\n\n\t\tObject.values(subTasksInfo).map((subTaskInfo: SubTaskInfo) => {\n\t\t\tconst storyPoints = new StoryPoints();\n\t\t\tif (Type.isString(subTaskInfo.storyPoints))\n\t\t\t{\n\t\t\t\tstoryPoints.setPoints(subTaskInfo.storyPoints);\n\t\t\t}\n\t\t\tsubTaskInfo.storyPoints = storyPoints;\n\t\t});\n\n\t\tthis.subTasksInfo = subTasksInfo;\n\t}\n\n\tgetSubTasksInfo(): SubTasksInfo\n\t{\n\t\treturn this.subTasksInfo;\n\t}\n\n\tupdateSubTasksPoints(sourceId: number, storyPoints: StoryPoints)\n\t{\n\t\tlet newSubTasksInfo = this.getSubTasksInfo();\n\t\tif (Type.isArray(newSubTasksInfo))\n\t\t{\n\t\t\tnewSubTasksInfo = {};\n\t\t\tnewSubTasksInfo[sourceId] = {\n\t\t\t\tsourceId: sourceId,\n\t\t\t\tcompleted: 'N',\n\t\t\t\tstoryPoints: storyPoints.getPoints()\n\t\t\t};\n\t\t\tthis.setSubTasksInfo(newSubTasksInfo);\n\n\t\t\tthis.updateStoryPointsNode();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst subTasksInfo = this.getSubTasksInfo();\n\n\t\tif (subTasksInfo.hasOwnProperty(sourceId))\n\t\t{\n\t\t\tsubTasksInfo[sourceId].storyPoints = storyPoints;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsubTasksInfo[sourceId] = {\n\t\t\t\tsourceId: sourceId,\n\t\t\t\tcompleted: 'N',\n\t\t\t\tstoryPoints: storyPoints\n\t\t\t};\n\t\t}\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetCompletedSubTasksStoryPoints(): StoryPoints\n\t{\n\t\tconst storyPoints = new StoryPoints();\n\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tstoryPoints.setPoints(this.storyPoints.getPoints());\n\t\t}\n\n\t\tObject.values(this.getSubTasksInfo()).map((subTaskInfo: SubTaskInfo) => {\n\t\t\tif (subTaskInfo.completed === 'Y')\n\t\t\t{\n\t\t\t\tif (subTaskInfo.storyPoints instanceof StoryPoints)\n\t\t\t\t{\n\t\t\t\t\tstoryPoints.addPoints(subTaskInfo.storyPoints.getPoints());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn storyPoints;\n\t}\n\n\tgetUncompletedSubTasksStoryPoints(): StoryPoints\n\t{\n\t\tconst storyPoints = new StoryPoints();\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tstoryPoints.setPoints(this.storyPoints.getPoints());\n\t\t}\n\n\t\tObject.values(this.getSubTasksInfo()).map((subTaskInfo: SubTaskInfo) => {\n\t\t\tif (subTaskInfo.completed === 'N')\n\t\t\t{\n\t\t\t\tif (subTaskInfo.storyPoints instanceof StoryPoints)\n\t\t\t\t{\n\t\t\t\t\tstoryPoints.addPoints(subTaskInfo.storyPoints.getPoints());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn storyPoints;\n\t}\n\n\tsetCompleted(value: string)\n\t{\n\t\tthis.completed = (value === 'Y');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateCompletedStatus();\n\t\t}\n\t}\n\n\tsetAllowedActions(allowedActions: AllowedActions)\n\t{\n\t\tthis.allowedActions = (Type.isPlainObject(allowedActions) ? allowedActions : {});\n\t}\n\n\tsetEpic(epic: EpicType)\n\t{\n\t\tthis.epic = (Type.isPlainObject(epic) ? epic : null);\n\t}\n\n\tgetEpic(): EpicType\n\t{\n\t\treturn this.epic;\n\t}\n\n\tsetTags(tags)\n\t{\n\t\tthis.tags = (Type.isArray(tags) ? tags : []);\n\t}\n\n\tgetTags(): Array\n\t{\n\t\treturn this.tags;\n\t}\n\n\tsetParentTask(value: string)\n\t{\n\t\tthis.parentTask = (value === 'Y');\n\t}\n\n\tisParentTask(): boolean\n\t{\n\t\treturn this.parentTask;\n\t}\n\n\tsetSubTasksCount(count: number)\n\t{\n\t\tthis.subTasksCount = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetSubTasksCount(): number\n\t{\n\t\treturn this.subTasksCount;\n\t}\n\n\tsetLinkedTask(value: string)\n\t{\n\t\tthis.linkedTask = (value === 'Y');\n\t}\n\n\tisLinkedTask(): boolean\n\t{\n\t\treturn this.linkedTask;\n\t}\n\n\tsetParentTaskId(id: number)\n\t{\n\t\tthis.parentTaskId = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\t}\n\n\tgetParentTaskId(): number\n\t{\n\t\treturn this.parentTaskId;\n\t}\n\n\tsetSubTask(value: string)\n\t{\n\t\tthis.subTask = (value === 'Y');\n\t}\n\n\tisSubTask(): boolean\n\t{\n\t\treturn this.subTask;\n\t}\n\n\tsetTaskCounts(params: ItemParams)\n\t{\n\t\tthis.taskCounts = (this.itemType === 'task' ? new TaskCounts(params) : null);\n\t}\n\n\tgetTaskCounts(): TaskCounts|null\n\t{\n\t\treturn this.taskCounts;\n\t}\n\n\tcleanTaskCounts()\n\t{\n\t\tthis.taskCounts = null;\n\t}\n\n\tsetInfo(info: ?ItemInfo)\n\t{\n\t\tif (Type.isUndefined(info))\n\t\t{\n\t\t\tthis.info = {\n\t\t\t\tcolor: '',\n\t\t\t\tborderColor: ''\n\t\t\t};\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.info = info;\n\n\t\tthis.setBorderColor(this.info.borderColor);\n\t}\n\n\tgetInfo(): ?ItemInfo\n\t{\n\t\treturn this.info;\n\t}\n\n\tsetBorderColor(color: string)\n\t{\n\t\tthis.info.borderColor = (Type.isString(color) ? color : '');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tif (this.getBorderColor())\n\t\t\t{\n\t\t\t\tDom.style(this.getItemNode(), 'border', '2px solid ' + this.getBorderColor());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.style(this.getItemNode(), 'border', null);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetBorderColor(): string\n\t{\n\t\treturn (Type.isString(this.info.borderColor) ? this.info.borderColor : '');\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn this.completed;\n\t}\n\n\tupdateCompletedStatus()\n\t{\n\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name');\n\t\tconst nameTextNode = nameNode.querySelector('.ui-ctl-element');\n\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tDom.style(nameTextNode, 'textDecoration', 'line-through');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(nameTextNode, 'textDecoration', null);\n\t\t}\n\n\t\tthis.sendEventToUpdateStoryPoints();\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn this.disableStatus;\n\t}\n\n\tsetMoveActivity(value: boolean)\n\t{\n\t\tthis.moveActivity = Boolean(value);\n\t}\n\n\tisMovable(): boolean\n\t{\n\t\treturn this.moveActivity;\n\t}\n\n\tsetDisableStatus(status: boolean)\n\t{\n\t\tthis.disableStatus = Boolean(status);\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (status)\n\t\t{\n\t\t\tthis.hideNode(this.getItemNode().querySelector('.tasks-scrum-dragndrop'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showNode(this.getItemNode().querySelector('.tasks-scrum-dragndrop'));\n\t\t}\n\t}\n\n\tactivateGroupMode()\n\t{\n\t\tthis.groupMode = true;\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\tconst groupModeCheckbox = groupModeContainer.querySelector('input');\n\t\tgroupModeCheckbox.checked = false;\n\n\t\tEvent.bind(groupModeCheckbox, 'change', (event) => {\n\t\t\tDom.toggleClass(this.getItemNode(), 'tasks-scrum-item-group-mode');\n\t\t\tif (this.getItemNode().classList.contains('tasks-scrum-item-group-mode'))\n\t\t\t{\n\t\t\t\tthis.emit('addItemToGroupMode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emit('removeItemFromGroupMode');\n\t\t\t}\n\t\t\tthis.showActionsPanel(event);\n\t\t});\n\n\t\tthis.showNode(groupModeContainer);\n\n\t\tthis.deactivateDragNDrop();\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getItemNode(), 'tasks-scrum-item-group-mode');\n\n\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\tthis.hideNode(groupModeContainer);\n\n\t\tEvent.unbindAll(groupModeContainer.querySelector('input'));\n\n\t\tthis.groupMode = false;\n\n\t\tthis.activateDragNDrop();\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\tactivatePreviewMode()\n\t{\n\t\tthis.previewMode = true;\n\t}\n\n\tisPreviewMode(): boolean\n\t{\n\t\treturn this.previewMode;\n\t}\n\n\tgetPreviewVersion(): Item\n\t{\n\t\tconst previewItem = Runtime.clone(this);\n\n\t\tpreviewItem.setItemId();\n\t\tpreviewItem.itemNode = null;\n\t\tpreviewItem.activatePreviewMode();\n\t\tpreviewItem.taskCounts = null\n\n\t\treturn previewItem;\n\t}\n\n\tactivateDecompositionMode(color: string)\n\t{\n\t\tthis.decompositionMode = true;\n\n\t\tif (this.getBorderColor() === '')\n\t\t{\n\t\t\tthis.setBorderColor(color);\n\t\t}\n\n\t\tif (this.getBorderColor())\n\t\t{\n\t\t\tDom.style(this.getItemNode(), 'border', '2px solid ' + this.getBorderColor());\n\t\t}\n\n\t\tthis.deactivateDragNDrop();\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.decompositionMode = false;\n\n\t\tif (this.getBorderColor() === '')\n\t\t{\n\t\t\tthis.setBorderColor();\n\t\t\tDom.style(this.getItemNode(), 'border', null);\n\t\t}\n\n\t\tthis.activateDragNDrop();\n\t}\n\n\tactivateDragNDrop()\n\t{\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tif (!this.getItemNode().classList.contains('tasks-scrum-item-drag'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.getItemNode(), 'tasks-scrum-item-drag');\n\t\t\t}\n\t\t}\n\t}\n\n\tdeactivateDragNDrop()\n\t{\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tDom.removeClass(this.getItemNode(), 'tasks-scrum-item-drag');\n\t\t}\n\t}\n\n\tisDecompositionMode(): boolean\n\t{\n\t\treturn this.decompositionMode;\n\t}\n\n\tsetItemNode(node?: HTMLElement)\n\t{\n\t\ttry\n\t\t{\n\t\t\tthis.itemNode = ((node instanceof HTMLElement) ? node : null);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tthis.itemNode = null;\n\t\t}\n\t}\n\n\tgetItemNode(): HTMLElement|null\n\t{\n\t\treturn this.itemNode;\n\t}\n\n\tisNodeCreated(): boolean\n\t{\n\t\treturn (this.itemNode !== null);\n\t}\n\n\tsetParentEntity(entityId: number, entityType: string)\n\t{\n\t\tthis.setEntityId(entityId);\n\t\tthis.setEntityType(entityType);\n\t}\n\n\tisEditAllowed(): boolean\n\t{\n\t\treturn Boolean(this.allowedActions['task_edit']);\n\t}\n\n\tisRemoveAllowed(): boolean\n\t{\n\t\treturn Boolean(this.allowedActions['task_remove']);\n\t}\n\n\tupdateYourself(tmpItem: Item)\n\t{\n\t\tif (tmpItem.getName() !== this.getName())\n\t\t{\n\t\t\tthis.setName(tmpItem.getName());\n\t\t}\n\t\tif (tmpItem.getEntityId() !== this.getEntityId())\n\t\t{\n\t\t\tthis.setEntityId(tmpItem.getEntityId());\n\t\t}\n\t\tif (tmpItem.getResponsible().id !== this.getResponsible().id)\n\t\t{\n\t\t\tthis.setResponsible(tmpItem.getResponsible());\n\t\t}\n\t\tif (tmpItem.getStoryPoints().getPoints() !== this.getStoryPoints().getPoints())\n\t\t{\n\t\t\tthis.setStoryPoints(tmpItem.getStoryPoints().getPoints());\n\t\t}\n\t\tif (this.getTaskCounts() && tmpItem.getTaskCounts())\n\t\t{\n\t\t\tthis.getTaskCounts().updateIndicators({\n\t\t\t\tattachedFilesCount: tmpItem.getTaskCounts().getAttachedFilesCount(),\n\t\t\t\tcheckListComplete: tmpItem.getTaskCounts().getCheckListComplete(),\n\t\t\t\tcheckListAll: tmpItem.getTaskCounts().getCheckListAll(),\n\t\t\t\ttaskCounter: tmpItem.getTaskCounts().getTaskCounters(),\n\t\t\t});\n\t\t}\n\t\tif (tmpItem.isCompleted() !== this.isCompleted())\n\t\t{\n\t\t\tthis.setCompleted(tmpItem.isCompleted() ? 'Y' : 'N')\n\t\t}\n\n\t\tthis.setParentId(tmpItem.getParentId());\n\t\tthis.setEpicAndTags(tmpItem.getEpic(), tmpItem.getTags());\n\t\tthis.setInfo(tmpItem.getInfo());\n\n\t\tthis.setParentTask(tmpItem.isParentTask() ? 'Y' : 'N');\n\t\tthis.setSubTasksCount(tmpItem.getSubTasksCount());\n\t\tthis.setLinkedTask(tmpItem.isLinkedTask() ? 'Y' : 'N');\n\t\tthis.setParentTaskId(tmpItem.getParentTaskId());\n\t\tthis.setSubTask(tmpItem.isSubTask() ? 'Y' : 'N');\n\n\t\tthis.setSubTasksInfo(tmpItem.getSubTasksInfo());\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateParentTaskNodes();\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.getItemNode());\n\t\tthis.setItemNode();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet itemClassName = 'tasks-scrum-item';\n\t\tif (this.isSubTask())\n\t\t{\n\t\t\titemClassName += ' tasks-scrum-subtask-item'\n\t\t}\n\n\t\tthis.itemNode = Tag.render`\n\t\t\t<div data-item-id=\"${Text.encode(this.itemId)}\" data-sort=\n\t\t\t\t\"${Text.encode(this.sort)}\" class=\"${itemClassName}\">\n\t\t\t\t<div class=\"tasks-scrum-item-inner\">\n\t\t\t\t\t<div class=\"tasks-scrum-item-group-mode-container\">\n\t\t\t\t\t\t<input type=\"checkbox\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-item-name\">\n\t\t\t\t\t\t${this.renderName()}\n\t\t\t\t\t\t${(this.taskCounts && this.itemType === 'task' ? this.taskCounts.renderIndicators() : '')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-item-params\">\n\t\t\t\t\t\t${this.renderSubTasksCounter()}\n\t\t\t\t\t\t${this.renderResponsible()}\n\t\t\t\t\t\t${this.renderStoryPoints()}\n\t\t\t\t\t\t${this.renderSubTasksTick()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.renderTags()}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.isNodeCreated() && this.getBorderColor())\n\t\t{\n\t\t\tDom.style(this.itemNode, 'border', '2px solid ' + this.getBorderColor());\n\t\t}\n\n\t\treturn this.itemNode;\n\t}\n\n\trenderName(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-name-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-no-border\">\n\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t${Text.encode(this.name)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderResponsible(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"ui-icon ui-icon-common-user tasks-scrum-item-responsible\"><i></i></div>`;\n\t}\n\n\trenderStoryPoints(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-story-points\">\n\t\t\t\t<div class=\"tasks-scrum-item-story-points-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-auto ui-ctl-no-border\">\n\t\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t\t${Text.encode(this.getStoryPoints().getPoints())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderSubTasksCounter(): HTMLElement\n\t{\n\t\tif (!this.isParentTask())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst subTasksCounter = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-subtasks-btn\">\n\t\t\t\t<span class=\"tasks-scrum-item-subtasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-item-subtasks-count\">\n\t\t\t\t\t${this.getSubTasksCount()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(subTasksCounter, 'click', () => {\n\t\t\tthis.emit('showTask');\n\t\t});\n\n\t\treturn subTasksCounter;\n\t}\n\n\trenderSubTasksTick(): HTMLElement\n\t{\n\t\tif (!this.isParentTask() || this.isPreviewMode())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tif (this.getEntityType() === 'backlog')\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst subTasksTick = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-subtasks-tick\">\n\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ui-btn-icon-angle-down\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(subTasksTick, 'click', () => {\n\t\t\tif (!this.isDecompositionMode())\n\t\t\t{\n\t\t\t\tthis.emit('toggleSubTasks');\n\t\t\t}\n\t\t});\n\n\t\treturn subTasksTick;\n\t}\n\n\ttoggleSubTasksTick()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst subTasksTick = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\n\t\tif (subTasksTick)\n\t\t{\n\t\t\tsubTasksTick.firstElementChild.classList.toggle('ui-btn-icon-angle-up');\n\t\t\tsubTasksTick.firstElementChild.classList.toggle('ui-btn-icon-angle-down');\n\t\t}\n\t}\n\n\tupSubTasksTick()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst subTasksTick = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\n\t\tif (subTasksTick)\n\t\t{\n\t\t\tDom.removeClass(subTasksTick.firstElementChild, 'ui-btn-icon-angle-down');\n\t\t\tDom.addClass(subTasksTick.firstElementChild, 'ui-btn-icon-angle-up');\n\t\t}\n\t}\n\n\tdownSubTasksTick()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst subTasksTick = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\n\t\tif (subTasksTick)\n\t\t{\n\t\t\tDom.removeClass(subTasksTick.firstElementChild, 'ui-btn-icon-angle-up');\n\t\t\tDom.addClass(subTasksTick.firstElementChild, 'ui-btn-icon-angle-down');\n\t\t}\n\t}\n\n\trenderTags(): ?HTMLElement|string\n\t{\n\t\tif (this.epic === null && this.tags.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEpicTag(): ?HTMLElement\n\t{\n\t\tif (this.epic === null)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst getContrastYIQ = (hexcolor) => {\n\t\t\tif (!hexcolor)\n\t\t\t{\n\t\t\t\thexcolor = Label.Color.DEFAULT;\n\t\t\t}\n\t\t\thexcolor = hexcolor.replace('#', '');\n\t\t\tconst r = parseInt(hexcolor.substr(0, 2), 16);\n\t\t\tconst g = parseInt(hexcolor.substr(2, 2), 16);\n\t\t\tconst b = parseInt(hexcolor.substr(4, 2), 16);\n\t\t\tconst yiq = ((r * 299 ) + (g* 587 ) + (b * 114)) / 1000;\n\t\t\treturn (yiq >= 128) ? 'black' : 'white';\n\t\t};\n\n\t\tconst epicLabel = new Label({\n\t\t\ttext: this.epic.name,\n\t\t\tcolor: Label.Color.DEFAULT,\n\t\t\tsize: Label.Size.MD,\n\t\t\tcustomClass: 'tasks-scrum-item-epic-label'\n\t\t});\n\t\tconst container = epicLabel.getContainer();\n\t\tconst innerLabel = container.querySelector('.ui-label-inner');\n\n\t\tconst contrast = getContrastYIQ(this.epic.info.color);\n\t\tif (contrast === 'white')\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#ffffff');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#525c69');\n\t\t}\n\t\tDom.style(container, 'backgroundColor', this.epic.info.color);\n\n\t\tEvent.bind(container, 'click', (event) => {\n\t\t\tif (this.isGroupMode())\n\t\t\t{\n\t\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\t\tthis.showActionsPanel(event);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emit('filterByEpic', this.epic.id);\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tgetListTagNodes(): HTMLElement\n\t{\n\t\treturn this.tags.map((tag) => {\n\t\t\tconst tagLabel = new Label({\n\t\t\t\ttext: tag,\n\t\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\t\tfill: true,\n\t\t\t\tsize: Label.Size.SM,\n\t\t\t\tcustomClass: ''\n\t\t\t});\n\t\t\tconst container = tagLabel.getContainer();\n\t\t\tEvent.bind(container, 'click', (event) => {\n\t\t\t\tif (this.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\t\t\tthis.showActionsPanel(event);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.emit('filterByTag', tag);\n\t\t\t});\n\t\t\treturn container;\n\t\t});\n\t}\n\n\t// todo remove all method\n\tonAfterAppend(container)\n\t{\n\t\tthis.setItemNode(container.querySelector('[data-item-id=\"'+this.itemId+'\"]'));\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.onAfterAppend();\n\t\t}\n\n\t\tthis.updateResponsible();\n\n\t\tif (this.isPreviewMode())\n\t\t{\n\t\t\tEvent.bind(this.getItemNode(), 'click', () => this.emit('showTask'));\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isDecompositionMode())\n\t\t{\n\t\t\tthis.activateDragNDrop();\n\t\t}\n\n\t\tif (this.isSubTask())\n\t\t{\n\t\t\tthis.deactivateDragNDrop();\n\t\t}\n\n\t\tEvent.unbindAll(this.getItemNode());\n\t\tEvent.bind(this.getItemNode(), 'click', this.onItemClick.bind(this));\n\n\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name');\n\t\tEvent.unbindAll(nameNode);\n\t\tEvent.bind(nameNode, 'click', this.onNameClick.bind(this));\n\n\t\tconst responsibleNode = this.getItemNode().querySelector('.tasks-scrum-item-responsible');\n\t\tEvent.unbindAll(responsibleNode);\n\t\tEvent.bind(responsibleNode, 'click', this.onResponsibleClick.bind(this));\n\n\t\tconst storyPointsNode = this.getItemNode().querySelector('.tasks-scrum-item-story-points');\n\t\tEvent.unbindAll(storyPointsNode);\n\t\tEvent.bind(storyPointsNode, 'click', this.onStoryPointsClick.bind(this));\n\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tconst nameTextNode = nameNode.querySelector('.ui-ctl-element');\n\t\t\tDom.style(nameTextNode, 'textDecoration', 'line-through');\n\t\t}\n\n\t\tthis.updateParentTaskNodes();\n\t}\n\n\tisShowIndicators(): Boolean\n\t{\n\t\treturn Boolean(this.attachedFilesCount || this.checkListAll || this.newCommentsCount);\n\t}\n\n\tupdateParentTaskNodes()\n\t{\n\t\tif (this.isParentTask())\n\t\t{\n\t\t\tconst subTasksCounterNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-btn');\n\t\t\tif (subTasksCounterNode)\n\t\t\t{\n\t\t\t\tDom.replace(subTasksCounterNode, this.renderSubTasksCounter());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst paramsNode = this.getItemNode().querySelector('.tasks-scrum-item-params');\n\t\t\t\tconst subTasksCounterNode = this.renderSubTasksCounter();\n\t\t\t\tDom.insertBefore(subTasksCounterNode, paramsNode.firstElementChild);\n\t\t\t}\n\n\t\t\tconst subTasksTickNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\t\t\tif (subTasksTickNode)\n\t\t\t{\n\t\t\t\tconst newSubTasksTickNode = this.renderSubTasksTick();\n\t\t\t\tif (newSubTasksTickNode)\n\t\t\t\t{\n\t\t\t\t\tDom.replace(subTasksTickNode, newSubTasksTickNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.remove(subTasksTickNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst paramsNode = this.getItemNode().querySelector('.tasks-scrum-item-params');\n\t\t\t\tconst newSubTasksTickNode = this.renderSubTasksTick();\n\t\t\t\tDom.append(newSubTasksTickNode, paramsNode);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst subTasksCounterNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-btn');\n\t\t\tif (subTasksCounterNode)\n\t\t\t{\n\t\t\t\tDom.remove(subTasksCounterNode);\n\t\t\t}\n\t\t\tconst subTasksTickNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\t\t\tif (subTasksTickNode)\n\t\t\t{\n\t\t\t\tDom.remove(subTasksTickNode);\n\t\t\t}\n\t\t}\n\t}\n\n\tonItemClick(event)\n\t{\n\t\tif (this.isClickOnEditableName(event) && !this.isGroupMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst ignoreTagList = new Set(['I', 'SPAN', 'INPUT']);\n\t\tif (ignoreTagList.has(event.target.tagName))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.target.closest('.tasks-scrum-item-subtasks-tick'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clickToGroupModeCheckbox();\n\n\t\tthis.showActionsPanel(event);\n\t}\n\n\tisClickOnEditableName(event): boolean\n\t{\n\t\treturn (event.target.classList.contains('ui-ctl-element'));\n\t}\n\n\tonNameClick(event)\n\t{\n\t\tif (this.isClickOnEditableName(event) && !this.isGroupMode())\n\t\t{\n\t\t\tthis.emit('showTask');\n\t\t}\n\t}\n\n\tclickToGroupModeCheckbox()\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\t\tconst groupModeCheckbox = groupModeContainer.querySelector('input');\n\t\t\tgroupModeCheckbox.click();\n\t\t}\n\t}\n\n\tonResponsibleClick(event)\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst responsibleNode = event.currentTarget;\n\n\t\tconst dialog = new Dialog({\n\t\t\ttargetNode: responsibleNode,\n\t\t\tenableSearch: true,\n\t\t\tcontext: 'TASKS',\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tthis.responsible = {\n\t\t\t\t\t\tid: selectedItem.getId(),\n\t\t\t\t\t\tname: selectedItem.getTitle(),\n\t\t\t\t\t\tphoto: {\n\t\t\t\t\t\t\tsrc: selectedItem.getAvatar()\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tthis.updateResponsible();\n\t\t\t\t\tthis.emit('changeTaskResponsible');\n\n\t\t\t\t},\n\t\t\t},\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'user',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tinviteEmployeeLink: false\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'department'\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\n\t\tdialog.show();\n\t}\n\n\tonStoryPointsClick(event)\n\t{\n\t\tif (this.isGroupMode() || this.isDisabled() || this.isCompleted() || this.isParentTask())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tconst storyPointsNode = event.currentTarget;\n\t\tconst borderNode = storyPointsNode.querySelector('.ui-ctl');\n\t\tconst valueNode = storyPointsNode.querySelector('.ui-ctl-element');\n\t\tvalueNode.textContent = valueNode.textContent.trim();\n\t\tconst oldValue = valueNode.textContent.trim();\n\n\t\tif (valueNode.contentEditable === 'true')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\tvalueNode.contentEditable = 'true';\n\n\t\tthis.placeCursorAtEnd(valueNode);\n\n\t\tEvent.bind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\tEvent.bindOnce(valueNode, 'blur', () => {\n\t\t\tEvent.unbind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\t\tvalueNode.contentEditable = 'false';\n\n\t\t\tconst newValue = valueNode.textContent.trim();\n\t\t\tif (newValue && oldValue === newValue)\n\t\t\t{\n\t\t\t\tvalueNode.textContent = oldValue;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.emit('updateItem', {\n\t\t\t\titemId: this.getItemId(),\n\t\t\t\tentityId: this.getEntityId(),\n\t\t\t\titemType: this.getItemType(),\n\t\t\t\tstoryPoints: newValue\n\t\t\t});\n\n\t\t\tthis.setStoryPoints(newValue);\n\t\t}, true);\n\t}\n\n\tsendEventToUpdateStoryPoints()\n\t{\n\t\tthis.emit('updateStoryPoints');\n\t}\n\n\tblockEnterInput(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.blur();\n\t\t\treturn;\n\t\t}\n\t};\n\n\tshowActionsPanel(event)\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown() && !this.isGroupMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t}\n\n\t\tthis.actionsPanel = new ActionsPanel({\n\t\t\tbindElement: this.getItemNode(),\n\t\t\titemList: {\n\t\t\t\ttask: {\n\t\t\t\t\tactivity: (this.itemType === 'task' && !this.isGroupMode()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('showTask');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tattachment: {\n\t\t\t\t\tactivity: (!this.isDisabled() && this.isEditAllowed() && !this.isGroupMode()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tconst diskManager = new DiskManager({\n\t\t\t\t\t\t\tufDiskFilesFieldName: 'UF_TASK_WEBDAV_FILES'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.subscribeOnce('onFinish', (baseEvent) => {\n\t\t\t\t\t\t\tthis.emit('attachFilesToTask', baseEvent.getData());\n\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.showAttachmentMenu(event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdod: {\n\t\t\t\t\tactivity: (!this.decompositionMode && !this.isGroupMode()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('dod');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tactivity: (!this.decompositionMode && this.isMovable() && !this.isSubTask()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('move', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tsprint: {\n\t\t\t\t\tactivity: (!this.isDisabled() && !this.decompositionMode && !this.isSubTask()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('moveToSprint', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbacklog: {\n\t\t\t\t\tactivity: (this.entityType === 'sprint' && !this.decompositionMode && !this.isSubTask()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('moveToBacklog');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ttags: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showTagSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tepic: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showEpicSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdecomposition: {\n\t\t\t\t\tactivity: (\n\t\t\t\t\t\t!this.isDisabled()\n\t\t\t\t\t\t&& !this.decompositionMode\n\t\t\t\t\t\t&& !this.isGroupMode()\n\t\t\t\t\t\t&& !this.isSubTask()\n\t\t\t\t\t),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('startDecomposition');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tactivity: this.isRemoveAllowed(),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tconst message = (this.isGroupMode() ? Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASKS') :\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASK'));\n\t\t\t\t\t\tMessageBox.confirm(\n\t\t\t\t\t\t\tmessage,\n\t\t\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\t\t\tthis.emit('remove');\n\t\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.actionsPanel.showPanel();\n\t}\n\n\tgetCurrentActionsPanel(): ?ActionsPanel\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown())\n\t\t{\n\t\t\treturn this.actionsPanel;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null\n\t\t}\n\t}\n\n\tsetEpicAndTags(epic, tags: Array)\n\t{\n\t\tthis.epic = (Type.isPlainObject(epic) || epic === null ? epic : this.epic);\n\t\tthis.tags = (Type.isArray(tags) ? tags : this.tags);\n\n\t\tif (this.epic === null && this.tags.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateTagsContainer();\n\t}\n\n\tupdateTagsContainer()\n\t{\n\t\tif (!this.getItemNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newContainer = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst tagsContainerNode = this.getItemNode().querySelector('.tasks-scrum-item-tags-container');\n\t\tif (tagsContainerNode)\n\t\t{\n\t\t\tDom.replace(tagsContainerNode, newContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newContainer, this.getItemNode());\n\t\t}\n\t}\n\n\tupdateResponsible()\n\t{\n\t\tif (!this.getItemNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst responsibleNode = this.getItemNode().querySelector('.tasks-scrum-item-responsible');\n\n\t\tif (!responsibleNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.attr(responsibleNode, 'title', this.responsible.name);\n\t\tif (this.responsible.photo && this.responsible.photo.src)\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', 'url(\"'+this.responsible.photo.src+'\")');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', null);\n\t\t}\n\t}\n\n\tplaceCursorAtEnd(node)\n\t{\n\t\tnode.focus();\n\t\tconst selection = window.getSelection();\n\t\tconst range = document.createRange();\n\t\trange.selectNodeContents(node);\n\t\trange.collapse(false);\n\t\tselection.removeAllRanges();\n\t\tselection.addRange(range);\n\t};\n\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.updateIndicators(data);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'block');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}\n","import {Dom, Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class GroupActionsButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.GroupActionsButton');\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-group-actions\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_GROUP')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(this.element, 'click', this.onClick.bind(this, this.element));\n\n\t\treturn this.element;\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tif (this.element && this.element.classList.contains('tasks-scrum-group-actions-active'))\n\t\t{\n\t\t\tDom.toggleClass(this.element, 'tasks-scrum-group-actions');\n\t\t\tDom.toggleClass(this.element, 'tasks-scrum-group-actions-active');\n\t\t\tDom.toggleClass(this.element, 'ui-link-secondary');\n\t\t\tDom.toggleClass(this.element, 'ui-link-dashed');\n\n\t\t\tthis.emit('deactivateGroupMode');\n\t\t}\n\t}\n\n\tonClick(element: HTMLElement)\n\t{\n\t\tDom.toggleClass(element, 'tasks-scrum-group-actions');\n\t\tDom.toggleClass(element, 'tasks-scrum-group-actions-active');\n\t\tDom.toggleClass(element, 'ui-link-secondary');\n\t\tDom.toggleClass(element, 'ui-link-dashed');\n\t\tif (element.classList.contains('tasks-scrum-group-actions-active'))\n\t\t{\n\t\t\tthis.emit('activateGroupMode');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('deactivateGroupMode');\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.element);\n\t\tthis.element = null;\n\t}\n}","import {Tag} from 'main.core';\nimport {Entity} from './entity';\nimport {Item} from '../item/item';\n\nexport class ListItems\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tthis.entity = entity;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-items-list\" data-entity-id=\"${this.entity.getId()}\">\n\t\t\t\t${this.entity.isCompleted() ? '' : this.entity.getInput().render()}\n\t\t\t\t${[...this.entity.getItems().values()].map((item: Item) => {\n\t\t\t\t\titem.setEntityType(this.entity.getEntityType());\n\t\t\t\t\treturn item.render();\n\t\t\t\t})}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.node;\n\t}\n\n\tgetNode(): HTMLElement|null\n\t{\n\t\treturn this.node;\n\t}\n\n\tsetEntityId(entityId: number)\n\t{\n\t\tthis.node.dataset.entityId = parseInt(entityId, 10);\n\t}\n}","import {Dialog} from 'ui.entity-selector';\nimport {Loc, Tag, Text} from 'main.core';\nimport {Input} from './input';\nimport {EventEmitter} from 'main.core.events';\n\nimport type {EpicType} from '../item/item';\n\nexport class TagSearcher extends EventEmitter\n{\n\tstatic tagRegExp = '#[^#@](?:[^#@]*[^\\s#@])?';\n\tstatic epicRegExp = '@[^#@](?:[^#@]*[^\\s#@])?';\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.TagSearcher');\n\n\t\tthis.allTags = new Map();\n\t}\n\n\taddTagToSearcher(tagName)\n\t{\n\t\ttagName = tagName.trim();\n\t\tthis.allTags.set('tag_' + tagName, {\n\t\t\tid: tagName,\n\t\t\tentityId: 'tag',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: tagName,\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag.svg'\n\t\t});\n\t}\n\n\taddEpicToSearcher(epic: EpicType)\n\t{\n\t\tconst epicName = epic.name.trim();\n\t\tthis.allTags.set('epic_' + epicName, {\n\t\t\tid: epic.id,\n\t\t\tentityId: 'epic',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: epicName.trim(),\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag-green.svg',\n\t\t\tname: epicName.trim(),\n\t\t\tdescription: epic.description,\n\t\t\tinfo: epic.info\n\t\t});\n\t}\n\n\tgetTagFromSearcher(name: String): Object\n\t{\n\t\treturn this.allTags.get(name);\n\t}\n\n\tremoveEpicFromSearcher(epic: Object)\n\t{\n\t\tthis.allTags.delete('epic_' + epic.name);\n\t}\n\n\tgetAllList(): Array\n\t{\n\t\treturn [...this.allTags.values()];\n\t}\n\n\tgetTagsList(): Array\n\t{\n\t\tconst tagsList = [];\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'tag')\n\t\t\t{\n\t\t\t\ttagsList.push(tag);\n\t\t\t}\n\t\t});\n\t\treturn tagsList;\n\t}\n\n\tgetEpicList(): Array\n\t{\n\t\tconst epicList = [];\n\t\t[...this.allTags.values()].forEach((epic) => {\n\t\t\tif (epic.entityId === 'epic')\n\t\t\t{\n\t\t\t\tepicList.push(epic);\n\t\t\t}\n\t\t});\n\t\treturn epicList;\n\t}\n\n\tgetEpicByName(epicName: string): EpicType|null\n\t{\n\t\tlet epic = null;\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'epic' && tag.name === epicName)\n\t\t\t{\n\t\t\t\tepic = tag;\n\t\t\t}\n\t\t});\n\t\treturn epic;\n\t}\n\n\tshowTagsDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentTags = item.getTags();\n\n\t\tconst selectedItems = [];\n\t\tcurrentTags.forEach((tag) => {\n\t\t\tconst currentTag = this.allTags.get(('tag_' + tag).trim());\n\t\t\tif (currentTag)\n\t\t\t{\n\t\t\t\tselectedItems.push(currentTag);\n\t\t\t}\n\t\t});\n\n\t\tconst createTag = () => {\n\t\t\tconst tagName = this.tagDialog.getTagSelector().getTextBoxValue();\n\t\t\tif (!tagName)\n\t\t\t{\n\t\t\t\tthis.tagDialog.focusSearch();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.addTagToSearcher(tagName);\n\t\t\tconst newTag = this.getTagFromSearcher('tag_' + tagName);\n\t\t\tconst item = this.tagDialog.addItem(newTag);\n\t\t\titem.select();\n\t\t\tthis.tagDialog.getTagSelector().clearTextBox();\n\t\t\tthis.tagDialog.focusSearch();\n\t\t\tthis.tagDialog.selectFirstTab();\n\t\t\tconst label = this.tagDialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\tlabel.textContent = '';\n\t\t};\n\n\t\tlet choiceWasMade = false;\n\n\t\tthis.tagDialog = new Dialog({\n\t\t\tid: item.getItemId(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: true,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getTagsList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst tag = selectedItem.getTitle();\n\t\t\t\t\tthis.emit('attachTagToTask', tag);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst deselectedItem = event.getData().item;\n\t\t\t\t\tconst tag = deselectedItem.getTitle();\n\t\t\t\t\tthis.emit('deAttachTagToTask', tag);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonInput: (event) => {\n\t\t\t\t\t\tconst selector = event.getData().selector;\n\t\t\t\t\t\tif (selector)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst dialog = selector.getDialog();\n\t\t\t\t\t\t\tconst label = dialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\t\t\t\t\tlabel.textContent = Text.encode(selector.getTextBoxValue());\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tfooter: [\n\t\t\t\tTag.render`\n\t\t\t\t\t<span onclick=\"${createTag}\" class=\"ui-selector-footer-link ui-selector-footer-link-add\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SEARCHER_ACTIONS_TAG_ADD')}\n\t\t\t\t\t</span>\n\t\t\t\t`,\n\t\t\t\tTag.render`<span class=\"ui-selector-footer-conjunction\"></span>`\n\t\t\t],\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(this.tagDialog.getContainer());\n\t\tthis.tagDialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t\tthis.emit('hideTagDialog');\n\t\t\t}\n\t\t});\n\n\t\tthis.tagDialog.show();\n\t}\n\n\tshowEpicDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentEpic = item.getEpic();\n\n\t\tconst selectedItems = [];\n\t\tif (currentEpic)\n\t\t{\n\t\t\tconst currentEpicInfo = this.allTags.get(('epic_' + currentEpic.name).trim());\n\t\t\tif (currentEpicInfo)\n\t\t\t{\n\t\t\t\tselectedItems.push(currentEpicInfo);\n\t\t\t}\n\t\t}\n\n\t\tlet choiceWasMade = false;\n\n\t\tconst dialog = new Dialog({\n\t\t\tid: item.getItemId(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getEpicList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst epicId = selectedItem.getId();\n\t\t\t\t\tthis.emit('updateItemEpic', epicId);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\t\tif (dialog.getSelectedItems().length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('updateItemEpic', 0);\n\t\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 50);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tplaceholder: Loc.getMessage('TASKS_SCRUM_ITEM_EPIC_SEARCHER_PLACEHOLDER')\n\t\t\t}\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(dialog.getContainer());\n\t\tdialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t}\n\t\t});\n\t\tdialog.show();\n\t}\n\n\tshowTagsSearchDialog(inputObject: Input, enteredHashTagName: string): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.tagsDialog && this.tagsDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.tagsDialog = null;\n\t\t}\n\n\t\tif (!this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getTagsList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashTag = '#' + selectedItem.getTitle();\n\t\t\t\t\t\tconst hashTags = TagSearcher.getHashTagNamesFromText(input.value);\n\t\t\t\t\t\tconst enteredHashTag = (hashTags.length > 0 ? hashTags.pop() : '');\n\t\t\t\t\t\tinput.value = input.value.replace(\n\t\t\t\t\t\t\tnew RegExp('#' + enteredHashTag, 'g'),\n\t\t\t\t\t\t\tselectedHashTag\n\t\t\t\t\t\t);\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.tagsDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setTagsSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setTagsSearchMode(true);\n\n\t\tthis.tagsDialog.show();\n\n\t\tthis.tagsDialog.search(enteredHashTagName);\n\t}\n\n\tcloseTagsSearchDialog()\n\t{\n\t\tif (this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog.hide();\n\t\t}\n\t}\n\n\tshowEpicSearchDialog(inputObject: Input, enteredHashEpicName: String): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.epicDialog && this.epicDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.epicDialog = null;\n\t\t}\n\n\t\tif (!this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getEpicList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashEpic = '@' + selectedItem.getTitle();\n\t\t\t\t\t\tinput.value = input.value.replace(new RegExp(TagSearcher.epicRegExp,'g'),'');\n\t\t\t\t\t\tinput.value = input.value + ' ' + selectedHashEpic\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t\tinputObject.setEpicId(selectedItem.getId());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.epicDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setEpicSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setEpicSearchMode(true);\n\n\t\tthis.epicDialog.show();\n\t\tthis.epicDialog.search(enteredHashEpicName);\n\t}\n\n\tcloseEpicSearchDialog()\n\t{\n\t\tif (this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog.hide();\n\t\t}\n\t}\n\n\tstatic getHashTagNamesFromText(inputText: string): Array\n\t{\n\t\tconst regex = new RegExp(TagSearcher.tagRegExp, 'g');\n\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0].substring(1));\n\t\t}\n\n\t\treturn matches;\n\t}\n\n\tstatic getHashEpicNamesFromText(inputText: string): Array\n\t{\n\t\tconst regex = new RegExp(TagSearcher.epicRegExp, 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0].substring(1));\n\t\t}\n\n\t\treturn matches;\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {TagSearcher} from './tag.searcher';\nimport {EventEmitter} from 'main.core.events';\n\nimport '../css/input.css';\n\nexport class Input extends EventEmitter\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Input');\n\n\t\tthis.nodeId = Text.getRandom();\n\t\tthis.placeholder = Loc.getMessage('TASKS_SCRUM_TASK_ADD_INPUT_TASK_PLACEHOLDER');\n\n\t\tthis.epicId = 0;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${Text.encode(this.nodeId)}\" class=\"tasks-scrum-input\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox\">\n\t\t\t\t\t<input type=\"text\" class=\"ui-ctl-element\" placeholder=\n\t\t\t\t\t\t\"${Text.encode(this.placeholder)}\" autocomplete=\"off\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdisable()\n\t{\n\t\tthis.node.querySelector('input').disabled = true;\n\t}\n\n\tunDisable()\n\t{\n\t\tthis.node.querySelector('input').disabled = false;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.setNode();\n\n\t\tEvent.bind(this.getInputNode(), 'input', (event) => {\n\t\t\tthis.onTagSearch(event);\n\t\t\tthis.onEpicSearch(event);\n\t\t});\n\t\tEvent.bind(this.getInputNode(), 'keydown', this.onKeydown.bind(this));\n\t}\n\n\tsetNode()\n\t{\n\t\tthis.node = document.getElementById(this.nodeId);\n\t}\n\n\tsetPlaceholder(placeholder: String)\n\t{\n\t\tthis.placeholder = placeholder;\n\t}\n\n\tsetEpicId(parentId)\n\t{\n\t\tthis.epicId = parseInt(parentId, 10);\n\t}\n\n\tgetNode(): HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetNodeId(): String\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tgetInputNode(): HTMLElement\n\t{\n\t\treturn this.node.querySelector('input');\n\t}\n\n\tgetEpicId()\n\t{\n\t\treturn this.epicId;\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t}\n\n\tsetTagsSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-tag-disabled', value);\n\t}\n\n\tisTagsSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-tag-disabled');\n\t}\n\n\tsetEpicSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-epic-disabled', value);\n\t}\n\n\tisEpicSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-epic-disabled');\n\t}\n\n\tonTagSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashTags = TagSearcher.getHashTagNamesFromText(inputNode.value);\n\t\tif (event.data === '#')\n\t\t{\n\t\t\tthis.setEpicSearchMode(false);\n\t\t\tthis.setTagsSearchMode(true);\n\t\t}\n\t\tif (enteredHashTags.length > 0 && this.isTagsSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashTags.pop();\n\t\t\tthis.emit('tagsSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('tagsSearchClose');\n\t\t}\n\t}\n\n\tonEpicSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashEpics = TagSearcher.getHashEpicNamesFromText(inputNode.value);\n\t\tif (event.data === '@')\n\t\t{\n\t\t\tthis.setTagsSearchMode(false);\n\t\t\tthis.setEpicSearchMode(true);\n\t\t}\n\t\tif (enteredHashEpics.length > 0 && this.isEpicSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashEpics.pop();\n\t\t\tthis.emit('epicSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('epicSearchClose');\n\t\t}\n\t}\n\n\tonCreateTaskItem()\n\t{\n\t\tif (!this.isTagsSearchMode() && !this.isEpicSearchMode())\n\t\t{\n\t\t\tconst input = this.getInputNode();\n\t\t\tif (input.value)\n\t\t\t{\n\t\t\t\tthis.emit('createTaskItem', input.value);\n\t\t\t\tinput.value = '';\n\t\t\t\tinput.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tonKeydown(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.onCreateTaskItem();\n\t\t}\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {Item} from '../item/item';\nimport {GroupActionsButton} from './group.actions.button';\nimport {ListItems} from './list.items';\n\nimport {Input} from '../utility/input';\nimport {StoryPoints} from '../utility/story.points';\n\nimport type {Views} from '../view/view';\n\nimport '../css/entity.css';\n\ntype EntityParams = {\n\tid: number,\n\tviews?: Views,\n\tnumberTasks?: number,\n\tisExactSearchApplied: 'Y' | 'N',\n\tstoryPoints?: string,\n\tpageNumberItems: number\n};\n\nexport class Entity extends EventEmitter\n{\n\tconstructor(params: EntityParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Entity');\n\n\t\tthis.setEntityParams(params);\n\n\t\tthis.items = new Map();\n\n\t\tthis.groupMode = false;\n\t\tthis.groupModeItems = new Map();\n\n\t\tthis.node = null;\n\t\tthis.groupActionsButton = null;\n\t\tthis.listItems = null;\n\n\t\tthis.input = new Input();\n\t}\n\n\tsetEntityParams(params: EntityParams)\n\t{\n\t\tthis.setId(params.id);\n\t\tthis.setViews(params.views);\n\t\tthis.setNumberTasks(params.numberTasks);\n\t\tthis.setStoryPoints(params.storyPoints);\n\n\t\tthis.exactSearchApplied = (params.isExactSearchApplied === 'Y');\n\n\t\tthis.pageNumberItems = parseInt(params.pageNumberItems, 10);\n\t}\n\n\taddGroupActionsButton(groupActionsButton: GroupActionsButton)\n\t{\n\t\tthis.groupActionsButton = groupActionsButton;\n\t\tthis.groupActionsButton.subscribe('activateGroupMode', this.onActivateGroupMode.bind(this));\n\t\tthis.groupActionsButton.subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t}\n\n\taddListItems(listItems: ListItems)\n\t{\n\t\tthis.listItems = listItems;\n\t}\n\n\tgetListItems(): ListItems|null\n\t{\n\t\treturn this.listItems;\n\t}\n\n\tgetNode(): HTMLElement|null\n\t{\n\t\treturn this.node;\n\t}\n\n\tsetId(id: number)\n\t{\n\t\tthis.id = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\n\t\tif (this.listItems)\n\t\t{\n\t\t\tthis.listItems.setEntityId(this.id);\n\t\t}\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetViews(views)\n\t{\n\t\tthis.views = (Type.isPlainObject(views) ? views : {});\n\t}\n\n\tgetViews()\n\t{\n\t\treturn this.views;\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'entity';\n\t}\n\n\tisActive()\n\t{\n\t\treturn false;\n\t}\n\n\tisCompleted()\n\t{\n\t\treturn false;\n\t}\n\n\tgetListItemsNode(): HTMLElement|null\n\t{\n\t\treturn (this.listItems ? this.listItems.getNode() : null);\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn (this.items.size === 0);\n\t}\n\n\tgetItems(): Map\n\t{\n\t\treturn this.items;\n\t}\n\n\tgetPageNumberItems(): number\n\t{\n\t\treturn this.pageNumberItems;\n\t}\n\n\tincrementPageNumberItems()\n\t{\n\t\tthis.pageNumberItems++;\n\t}\n\n\trecalculateItemsSort()\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tif (!listItemsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet sort = 1;\n\t\tlistItemsNode.querySelectorAll('.tasks-scrum-item').forEach((node: HTMLElement) => {\n\t\t\tconst item = this.getItems().get(parseInt(node.dataset.itemId, 10));\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.setSort(sort);\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\t}\n\n\tgetInput(): Input\n\t{\n\t\treturn this.input;\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tthis.items.set(newItem.getItemId(), newItem);\n\t\tthis.subscribeToItem(newItem);\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\t}\n\n\tsetItemMoveActivity(item: Item)\n\t{\n\t\titem.setMoveActivity(this.items.size > 2);\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tif (this.items.has(item.getItemId()))\n\t\t{\n\t\t\tthis.items.delete(item.getItemId());\n\t\t\titem.unsubscribeAll();\n\t\t\t[...this.items.values()].map((item) => {\n\t\t\t\tthis.setItemMoveActivity(item);\n\t\t\t});\n\t\t}\n\t}\n\n\tisNodeCreated(): boolean\n\t{\n\t\treturn (this.node !== null);\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tthis.numberTasks = (Type.isInteger(numberTasks) ? parseInt(numberTasks, 10) : 0);\n\t}\n\n\tgetNumberTasks(): number\n\t{\n\t\treturn (this.numberTasks ? this.numberTasks : this.getItems().size);\n\t}\n\n\thasInput(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tsetExactSearchApplied(value: boolean)\n\t{\n\t\tthis.exactSearchApplied = Boolean(value);\n\t}\n\n\tisExactSearchApplied(): boolean\n\t{\n\t\treturn this.exactSearchApplied;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.subscribeToItem(item);\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.input.onAfterAppend();\n\t\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t\t\tthis.input.subscribe('epicSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('epicSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashEpicName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('epicSearchClose', () => this.emit('epicSearchClose'));\n\t\t\tthis.input.subscribe('createTaskItem', (baseEvent) => {\n\t\t\t\tthis.emit('createTaskItem', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tvalue: baseEvent.getData()\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tsubscribeToItem(item: Item)\n\t{\n\t\tif (!this.getListItemsNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.onAfterAppend(this.getListItemsNode());\n\n\t\titem.setEntityType(this.getEntityType());\n\n\t\titem.subscribe('updateItem', (baseEvent) => {\n\t\t\tthis.emit('updateItem', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('updateStoryPoints', () => {\n\t\t\tif (item.isSubTask())\n\t\t\t{\n\t\t\t\tconst parentItem = this.getItemBySourceId(item.getParentTaskId());\n\t\t\t\tif (parentItem)\n\t\t\t\t{\n\t\t\t\t\tparentItem.updateSubTasksPoints(item.getSourceId(), item.getStoryPoints());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\titem.subscribe('showTask', (baseEvent) => this.emit('showTask', baseEvent.getTarget()));\n\n\t\titem.subscribe('move', (baseEvent) => {\n\t\t\tthis.emit('moveItem', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('moveToSprint', (baseEvent) => {\n\t\t\tthis.emit('moveToSprint', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('attachFilesToTask', (baseEvent) => {\n\t\t\tthis.emit('attachFilesToTask', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tattachedIds: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('dod', (baseEvent) => {\n\t\t\tthis.emit('showDod', baseEvent.getTarget())\n\t\t});\n\n\t\titem.subscribe('showTagSearcher', (baseEvent) => {\n\t\t\tthis.emit('showTagSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\titem.subscribe('showEpicSearcher', (baseEvent) => {\n\t\t\tthis.emit('showEpicSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('startDecomposition', (baseEvent) => {\n\t\t\tthis.emit('startDecomposition', baseEvent.getTarget())\n\t\t});\n\n\t\titem.subscribe('remove', (baseEvent) => {\n\t\t\tif (this.isGroupMode())\n\t\t\t{\n\t\t\t\tthis.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\tthis.removeItem(groupModeItem);\n\t\t\t\t\tgroupModeItem.removeYourself();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst item = baseEvent.getTarget();\n\t\t\t\tthis.removeItem(item);\n\t\t\t\titem.removeYourself();\n\t\t\t}\n\t\t\tthis.emit('removeItem', item);\n\t\t});\n\n\t\titem.subscribe('changeTaskResponsible', (baseEvent) => {\n\t\t\tconst item = baseEvent.getTarget();\n\t\t\tthis.emit('changeTaskResponsible', item);\n\t\t});\n\n\t\titem.subscribe('filterByEpic', (baseEvent) => {\n\t\t\tthis.emit('filterByEpic', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('filterByTag', (baseEvent) => {\n\t\t\tthis.emit('filterByTag', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('addItemToGroupMode', (baseEvent) => {\n\t\t\tthis.addItemToGroupMode(baseEvent.getTarget());\n\t\t});\n\n\t\titem.subscribe('removeItemFromGroupMode', (baseEvent) => {\n\t\t\tthis.removeItemFromGroupMode(baseEvent.getTarget());\n\t\t});\n\t}\n\n\tgetItemByItemId(itemId: number|string): Item|undefined\n\t{\n\t\treturn this.items.get((Type.isInteger(itemId) ? parseInt(itemId, 10) : itemId));\n\t}\n\n\tgetItemBySourceId(sourceId: number): Item|undefined\n\t{\n\t\treturn [...this.items.values()].find((item: Item) => item.getSourceId() === sourceId);\n\t}\n\n\tgetItemsByParentTaskId(parentTaskId: number): Map<number, Item>\n\t{\n\t\tconst items = new Map();\n\n\t\t[...this.items.values()].map((item: Item) => {\n\t\t\tif (item.getParentTaskId() === parentTaskId)\n\t\t\t{\n\t\t\t\titems.set(item.getItemId(), item);\n\t\t\t}\n\t\t});\n\n\t\treturn items;\n\t}\n\n\tsetStoryPoints(storyPoints)\n\t{\n\t\tthis.storyPoints = new StoryPoints();\n\n\t\tthis.storyPoints.addPoints(storyPoints);\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tisFirstItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\tconst firstElementChild = (\n\t\t\tthis.hasInput() ? listItemsNode.firstElementChild.nextElementSibling : listItemsNode.firstElementChild\n\t\t)\n\t\treturn firstElementChild.isEqualNode(itemNode);\n\t}\n\n\tisLastItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\treturn listItemsNode.lastElementChild.isEqualNode(itemNode);\n\t}\n\n\tfadeOut()\n\t{\n\t\tthis.getListItemsNode().classList.add('tasks-scrum-entity-items-faded');\n\t}\n\n\tfadeIn()\n\t{\n\t\tthis.getListItemsNode().classList.remove('tasks-scrum-entity-items-faded');\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tthis.groupActionsButton.deactivateGroupMode();\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tthis.groupMode = true;\n\n\t\tthis.input.disable();\n\n\t\tthis.emit('activateGroupMode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tthis.groupMode = false;\n\n\t\tthis.input.unDisable();\n\n\t\tthis.groupModeItems.forEach((item: Item) => {\n\t\t\titem.deactivateGroupMode();\n\t\t});\n\t\tthis.groupModeItems.clear();\n\n\t\tthis.emit('deactivateGroupMode');\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\taddItemToGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.set(item.getItemId(), item);\n\t}\n\n\tgetGroupModeItems(): Map\n\t{\n\t\treturn this.groupModeItems;\n\t}\n\n\tremoveItemFromGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.delete(item.getItemId());\n\t}\n\n\tbindItemsLoader(loader: HTMLElement)\n\t{\n\t\tthis.setActiveLoadItems(false);\n\n\t\tif (typeof IntersectionObserver === `undefined`)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst observer = new IntersectionObserver((entries) =>\n\t\t\t{\n\t\t\t\tif(entries[0].isIntersecting === true)\n\t\t\t\t{\n\t\t\t\t\tif (!this.isActiveLoadItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.emit('loadItems');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tthreshold: [0]\n\t\t\t}\n\t\t);\n\n\t\tobserver.observe(loader);\n\t}\n\n\tsetActiveLoadItems(value: boolean)\n\t{\n\t\tthis.activeLoadItems = Boolean(value);\n\t}\n\n\tisActiveLoadItems(): boolean\n\t{\n\t\treturn this.activeLoadItems;\n\t}\n\n\tshowItemsLoader()\n\t{\n\t\tconst listPosition = Dom.getPosition(this.itemsLoaderNode);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.itemsLoaderNode,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n\n\tupdateStoryPointsNode() {}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Entity} from '../entity';\n\nexport class Header extends EventEmitter\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tsuper(entity);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.BacklogHeader');\n\n\t\tthis.entity = entity;\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<div class=\"tasks-scrum-backlog-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-epics-title ui-btn ui-btn-xs ui-btn-secondary\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_EPICS_TITLE')}\n\t\t\t</div>\n\t\t\t<div title=\"Definition of Done\" class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-dod\">\n\t\t\t\t<span class=\"tasks-scrum-entity-dod-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-title-spacer\"></div>\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-task\">\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-title\">\n\t\t\t\t\t${this.entity.getNumberTasks()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-story-point-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE_STORY_POINTS')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-story-point\">\n\t\t\t\t${Text.encode(this.entity.getStoryPoints().getPoints())}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.getElementByClassName(this.element, 'tasks-scrum-backlog-epics-title'), 'click', () => {\n\t\t\tthis.emit('openListEpicGrid');\n\t\t});\n\n\t\tEvent.bind(this.getElementByClassName(this.element, 'tasks-scrum-entity-title-btn-dod'), 'click', () => {\n\t\t\tthis.emit('openDefinitionOfDone');\n\t\t});\n\n\t\treturn this.element;\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tthis.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-backlog-story-point'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tupdateNumberTasks()\n\t{\n\t\tconst parentNode = this.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-entity-title-btn-task'\n\t\t);\n\t\tparentNode.querySelector('.tasks-scrum-entity-tasks-title').textContent = this.entity.getNumberTasks();\n\t}\n\n\tgetElementByClassName(elements: HTMLElement[], className: string): HTMLElement\n\t{\n\t\tlet element = null;\n\t\telements.forEach((elem) => {\n\t\t\tif (elem.classList.contains(className))\n\t\t\t{\n\t\t\t\telement = elem;\n\t\t\t}\n\t\t});\n\t\treturn element;\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class EpicCreationButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.EpicCreationButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst element = Tag.render`\n\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-action-epic\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(element, 'click', this.onClick.bind(this));\n\n\t\treturn element;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('openAddEpicForm')\n\t}\n}","import {Dom, Tag} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Entity} from '../entity';\nimport {Header} from './header';\nimport {EpicCreationButton} from './epic.creation.button';\nimport {GroupActionsButton} from '../group.actions.button';\nimport {ListItems} from '../list.items';\nimport {Item} from '../../item/item';\n\nimport type {ItemParams} from '../../item/item';\n\nimport '../../css/backlog.css';\n\nexport type BacklogParams = {\n\tid: number,\n\titems?: Array<ItemParams>\n};\n\nexport class Backlog extends Entity\n{\n\tconstructor(params: BacklogParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Backlog');\n\n\t\tthis.setBacklogParams(params);\n\n\t\tthis.header = null;\n\t\tthis.epicCreationButton = null;\n\t}\n\n\tsetBacklogParams(params: BacklogParams)\n\t{\n\t\tparams.items.forEach((itemData) => {\n\t\t\tconst item = new Item(itemData);\n\t\t\tthis.items.set(item.itemId, item);\n\t\t});\n\t}\n\n\tstatic buildBacklog(backlogData: BacklogParams): Backlog\n\t{\n\t\tconst backlog = new Backlog(backlogData);\n\t\tbacklog.addHeader(new Header(backlog));\n\t\tbacklog.addEpicCreationButton(new EpicCreationButton());\n\t\tbacklog.addGroupActionsButton(new GroupActionsButton());\n\t\tbacklog.addListItems(new ListItems(backlog));\n\t\treturn backlog;\n\t}\n\n\taddHeader(header: Header)\n\t{\n\t\tthis.header = header;\n\t\tthis.header.subscribe('openListEpicGrid', () => this.emit('openListEpicGrid'));\n\t\tthis.header.subscribe('openDefinitionOfDone', () => this.emit('openDefinitionOfDone'));\n\t}\n\n\taddEpicCreationButton(epicCreationButton: EpicCreationButton)\n\t{\n\t\tthis.epicCreationButton = epicCreationButton;\n\t\tthis.epicCreationButton.subscribe('openAddEpicForm', () => this.emit('openAddEpicForm'));\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'backlog';\n\t}\n\n\tisDisabled()\n\t{\n\t\treturn false;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-backlog\">\n\t\t\t\t<div class=\"tasks-scrum-backlog-header\">\n\t\t\t\t\t${this.header ? this.header.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-backlog-actions\">\n\t\t\t\t\t${this.epicCreationButton ? this.epicCreationButton.render() : ''}\n\t\t\t\t\t${this.groupActionsButton ? this.groupActionsButton.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-backlog-items\">\n\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-entity-items-loader\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.itemsLoaderNode = this.node.querySelector('.tasks-scrum-entity-items-loader');\n\t\tthis.bindItemsLoader(this.itemsLoaderNode);\n\n\t\treturn this.node;\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tsuper.setNumberTasks(numberTasks);\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.updateNumberTasks();\n\t\t}\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onActivateGroupMode(baseEvent);\n\n\t\tDom.addClass(this.node.querySelector('.tasks-scrum-backlog-items'), 'tasks-scrum-backlog-items-group-mode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onDeactivateGroupMode(baseEvent);\n\n\t\tDom.removeClass(this.node.querySelector('.tasks-scrum-backlog-items'), 'tasks-scrum-backlog-items-group-mode');\n\t}\n\n\tupdateStoryPointsNode()\n\t{\n\t\tsuper.updateStoryPointsNode();\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.setStoryPoints(this.getStoryPoints().getPoints());\n\t\t}\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\n\nexport class SprintDate extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintDate');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.nodeId = 'tasks-scrum-sprint-header-date-' + Text.getRandom();\n\t\tthis.defaultSprintDuration = sprint.getDefaultSprintDuration();\n\t}\n\n\tcreateDate()\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn this.renderNode(this.nodeId, this.getFormattedDateStart(), this.getFormattedDateEnd());\n\t}\n\n\trenderNode(nodeId: string, dateStart: string, dateEnd: string): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${nodeId}\" class=\"tasks-scrum-sprint-date\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-start\">${dateStart}</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-separator\">-</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-end\">${dateEnd}</div>\n\t\t\t\t<input type=\"hidden\" name=\"dateStart\">\n\t\t\t\t<input type=\"hidden\" name=\"dateEnd\">\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\t\tdateStartNode.textContent = BX.date.format('j F', timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\t\tdateEndNode.textContent = BX.date.format('j F', timestamp);\n\t\t}\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.node = document.getElementById(this.nodeId);\n\t\tconst parentPopup = this.node.closest('.popup-window');\n\n\t\tconst customBlur = () => {\n\t\t\tBX.calendar.get().popup.close();\n\t\t};\n\n\t\tconst showCalendar = (node, field) => {\n\t\t\t/* eslint-disable */\n\t\t\tBX.calendar({\n\t\t\t\tnode: node,\n\t\t\t\tfield: field,\n\t\t\t\tbTime: false,\n\t\t\t\tbSetFocus: false,\n\t\t\t\tbHideTime: false\n\t\t\t});\n\t\t\t/* eslint-enable */\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.bindOnce(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t};\n\n\t\tconst updateDateNode = (node, value) => {\n\t\t\t/* eslint-disable */\n\t\t\tnode.textContent = BX.date.format('j F', Math.floor(BX.parseDate(value).getTime() / 1000));\n\t\t\t/* eslint-enable */\n\t\t};\n\t\tconst sendRequest = (data) => {\n\t\t\tthis.emit('changeSprintDeadline', data);\n\t\t};\n\n\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\tconst dateStartInput = this.node.querySelector('input[name=\"dateStart\"]');\n\t\tconst dateEndInput = this.node.querySelector('input[name=\"dateEnd\"]');\n\n\t\tEvent.bind(this.node, 'click', (event) => {\n\t\t\tconst target = event.target;\n\t\t\tif (target.classList.contains('tasks-scrum-sprint-date-start'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateStartInput);\n\t\t\t}\n\t\t\telse if (target.classList.contains('tasks-scrum-sprint-date-end'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateEndInput);\n\t\t\t}\n\t\t\tevent.stopPropagation();\n\t\t});\n\t\tEvent.bind(dateStartInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateStartNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateStart: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t\tEvent.bind(dateEndInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateEndNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateEnd: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetWeeks()\n\t{\n\t\tconst weekCount = (parseInt(this.defaultSprintDuration, 10) / 604800);\n\t\tif (weekCount > 5)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_3');\n\t\t}\n\t\telse if (weekCount === 1)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_2');\n\t\t}\n\t}\n\n\tgetFormattedTitleDatePeriod(): string\n\t{\n\t\treturn this.getFormattedDateStart() + ' - ' + this.getFormattedDateEnd();\n\t}\n\n\tgetFormattedDateStart(): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format('j F', this.sprint.getDateStart());\n\t\t/* eslint-enable */\n\t}\n\n\tgetFormattedDateEnd(): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format('j F', this.sprint.getDateEnd());\n\t\t/* eslint-enable */\n\t}\n}","export class StatsCalculator\n{\n\tcalculatePercentage(first: number, second: number): number\n\t{\n\t\tif (first === 0)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst result = Math.round(second * 100 / first);\n\n\t\treturn (isNaN(result) ? 0 : result);\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\nimport {StatsCalculator} from '../../utility/stats.calculator';\nimport {SprintDate} from \"./sprint.date\";\n\nexport class StatsHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.StatsHeader');\n\n\t\tthis.setSprintData(sprint);\n\n\t\tthis.statsCalculator = new StatsCalculator();\n\n\t\tthis.weekendDaysTime = sprint.getWeekendDaysTime();\n\n\t\tthis.headerNode = null;\n\t\tthis.headerClass = 'tasks-scrum-sprint-header-stats';\n\n\t\tthis.kanbanMode = false;\n\t}\n\n\tsetKanbanStyle()\n\t{\n\t\tthis.kanbanMode = true;\n\t\tthis.headerClass = 'tasks-scrum-sprint-header-stats-kanban';\n\t}\n\n\tisKanbanMode(): boolean\n\t{\n\t\treturn this.kanbanMode;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn '';\n\t}\n\n\tupdateStats(sprint: Sprint)\n\t{\n\t\tthis.setSprintData(sprint);\n\n\t\tDom.replace(this.headerNode, this.render());\n\t}\n\n\tsetSprintData(sprint: Sprint)\n\t{\n\t\tthis.setSprintDate(sprint);\n\t\tthis.setStoryPoints(sprint.getStoryPoints().getPoints());\n\t\tthis.setCompletedStoryPoints(sprint.getCompletedStoryPoints().getPoints());\n\t\tthis.setUncompletedStoryPoints(sprint.getUncompletedStoryPoints().getPoints());\n\t\tthis.setEndDate(sprint.getDateEnd());\n\t}\n\n\tsetSprintDate(sprint: Sprint)\n\t{\n\t\tthis.sprintDate = new SprintDate(sprint);\n\t}\n\n\tgetSprintDate(): SprintDate\n\t{\n\t\treturn this.sprintDate;\n\t}\n\n\tsetStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.storyPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.storyPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetStoryPoints(): number\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tsetCompletedStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.completedStoryPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.completedStoryPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetCompletedStoryPoints(): number\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetUncompletedStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.uncompletedStoryPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.uncompletedStoryPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetUncompletedStoryPoints(): number\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetEndDate(endDate)\n\t{\n\t\tif (Type.isUndefined(endDate) || isNaN(parseInt(endDate, 10)))\n\t\t{\n\t\t\tthis.endDate = (Date.now() / 1000);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.endDate = parseInt(endDate, 10);\n\t\t}\n\t}\n\n\tgetEndDate(): number\n\t{\n\t\treturn this.endDate;\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class CompletedStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tconst completedDate = this.getCompletedDate(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_COMPLETED_LABEL')\n\t\t\t.replace('#percent#', percentage)\n\t\t\t.replace('#date#', completedDate)\n\t\t;\n\n\t\tconst title = this.getSprintDate().getFormattedTitleDatePeriod();\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\" title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetCompletedDate(endDate: number): string\n\t{\n\t\treturn BX.date.format('j F Y', endDate);\n\t};\n}","import {Loc, Tag} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class ExpiredStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\t\tconst expiredDay = this.getExpiredDay(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_EXPIRED_LABEL')\n\t\t\t.replace('#percent#', percentage)\n\t\t\t.replace('#date#', expiredDay)\n\t\t;\n\n\t\tconst title = this.getSprintDate().getFormattedTitleDatePeriod();\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\" title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetExpiredDay(endDate: number): string\n\t{\n\t\treturn BX.date.format('j F Y', endDate);\n\t};\n}","import {Loc, Tag, Type} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class ActiveStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst remainingDays = this.getRemainingDays(this.getEndDate());\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tlet label = '';\n\t\tif (Type.isInteger(remainingDays) && remainingDays <= 1)\n\t\t{\n\t\t\tlabel = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LAST_LABEL')\n\t\t\t\t.replace('#percent#', percentage)\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabel = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LABEL')\n\t\t\t\t.replace('#days#', remainingDays)\n\t\t\t\t.replace('#percent#', percentage)\n\t\t\t;\n\t\t}\n\n\t\tconst title = this.getSprintDate().getFormattedTitleDatePeriod();\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\" title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetRemainingDays(endDate: number): string|number\n\t{\n\t\tconst dateWithWeekendOffset = new Date();\n\t\tdateWithWeekendOffset.setSeconds(dateWithWeekendOffset.getSeconds() + this.weekendDaysTime);\n\t\tdateWithWeekendOffset.setHours(0, 0, 0, 0);\n\n\t\tconst dateEnd = new Date(endDate * 1000);\n\n\t\tconst msPerMinute = 60 * 1000;\n\t\tconst msPerHour = msPerMinute * 60;\n\t\tconst msPerDay = msPerHour * 24;\n\n\t\tconst daysRemaining = Math.round((dateEnd - dateWithWeekendOffset) / msPerDay);\n\n\t\tif (daysRemaining <= 1)\n\t\t{\n\t\t\treturn daysRemaining;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.date.format('ddiff', dateWithWeekendOffset, dateEnd);\n\t\t}\n\t};\n}","import {Sprint} from './sprint';\nimport {StatsHeader} from './stats.header';\nimport {CompletedStatsHeader} from './completed.stats.header';\nimport {ExpiredStatsHeader} from './expired.stats.header';\nimport {ActiveStatsHeader} from './active.stats.header';\n\nexport class StatsHeaderBuilder\n{\n\tstatic build(sprint: Sprint): StatsHeader\n\t{\n\t\tif (sprint.isCompleted())\n\t\t{\n\t\t\treturn new CompletedStatsHeader(sprint);\n\t\t}\n\t\telse if (sprint.isExpired())\n\t\t{\n\t\t\treturn new ExpiredStatsHeader(sprint);\n\t\t}\n\t\telse if (sprint.isActive())\n\t\t{\n\t\t\treturn new ActiveStatsHeader(sprint);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn new StatsHeader(sprint);\n\t\t}\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {SprintDate} from './sprint.date';\nimport {Sprint} from './sprint';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {StatsHeaderBuilder} from './stats.header.builder';\nimport {StatsHeader} from './stats.header';\n\nexport class SprintHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintHeader');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\n\t\tthis.statsHeader = null;\n\t\tthis.sprintDate = null;\n\t}\n\n\tstatic buildHeader(sprint: Sprint): SprintHeader\n\t{\n\t\tconst sprintHeader = new SprintHeader(sprint);\n\t\tsprintHeader.addHeaderStats(StatsHeaderBuilder.build(sprint));\n\t\tsprintHeader.addHeaderDate(new SprintDate(sprint));\n\t\treturn sprintHeader;\n\t}\n\n\taddHeaderStats(statsHeader: StatsHeader)\n\t{\n\t\tthis.statsHeader = statsHeader;\n\t}\n\n\taddHeaderDate(sprintDate: SprintDate)\n\t{\n\t\tthis.sprintDate = sprintDate;\n\t\tthis.sprintDate.subscribe('changeSprintDeadline', (baseEvent) => {\n\t\t\tthis.emit('changeSprintDeadline', baseEvent.getData());\n\t\t});\n\t}\n\n\tinitStyle(sprint: Sprint)\n\t{\n\t\tthis.sprint = sprint;\n\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-active';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-success ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_COMPLETE_BUTTON');\n\t\t}\n\t\telse if (this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-completed';\n\t\t\tDom.remove(this.buttonNode);\n\t\t\tthis.sprint.hideContent();\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-planned';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-primary ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_START_BUTTON');\n\t\t}\n\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.addHeaderStats(StatsHeaderBuilder.build(this.sprint));\n\t\t\tthis.addHeaderDate(new SprintDate(this.sprint));\n\n\t\t\tif (this.sprint.isDisabled())\n\t\t\t{\n\t\t\t\tDom.remove(this.node.querySelector('.tasks-scrum-sprint-header-remove'));\n\t\t\t}\n\n\t\t\tthis.node.className = '';\n\t\t\tDom.addClass(this.node, 'tasks-scrum-sprint-header ' + this.headerClass);\n\n\t\t\tconst button = this.buttonNode.querySelector('button');\n\t\t\tbutton.className = '';\n\t\t\tDom.addClass(button, this.buttonClass);\n\t\t\tbutton.firstChild.replaceWith(this.buttonText);\n\n\t\t\tDom.replace(this.node.querySelector('.tasks-scrum-sprint-header-params'), this.renderParams());\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header ${this.headerClass}\">\n\t\t\t\t${this.renderDragnDrop()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-name-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-name\">\n\t\t\t\t\t\t${Text.encode(this.sprint.getName())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-edit\"></div>\n\t\t\t\t${this.renderRemove()}\n\t\t\t\t${this.renderParams()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t};\n\n\trenderParams(): HTMLElement\n\t{\n\t\tconst tickAngleClass = (this.sprint.isCompleted() ? 'ui-btn-icon-angle-down' : 'ui-btn-icon-angle-up');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header-params\">\n\t\t\t\t${this.renderStatsHeader()}\n\t\t\t\t${this.sprintDate ? this.sprintDate.createDate() : ''}\n\t\t\t\t${this.createButton()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-tick\">\n\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ${tickAngleClass}\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetStatsHeader(): StatsHeader\n\t{\n\t\treturn this.statsHeader;\n\t}\n\n\trenderDragnDrop(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-dragndrop\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-header-empty\"></div>`;\n\t\t}\n\t}\n\n\trenderRemove(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-header-remove\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t}\n\n\trenderStatsHeader(): HTMLElement\n\t{\n\t\treturn (this.statsHeader ? this.statsHeader.render() : '');\n\t}\n\n\tupdateNameNode(name: string)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.node.querySelector('.tasks-scrum-sprint-header-name').textContent = Text.encode(name);\n\t\t}\n\t}\n\n\tupdateStatsHeader()\n\t{\n\t\tthis.statsHeader.updateStats(this.sprint);\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.updateDateStartNode(timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.updateDateEndNode(timestamp);\n\t\t}\n\t}\n\n\tcreateButton()\n\t{\n\t\tif (this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buttonNodeId = 'tasks-scrum-sprint-header-button-' + this.sprint.getId();\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.buttonNodeId}\" class=\"tasks-scrum-sprint-header-button\">\n\t\t\t\t\t<button class=\"${this.buttonClass}\">${this.buttonText}</button>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t};\n\n\tonAfterAppend()\n\t{\n\t\tif (!this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.buttonNode = document.getElementById(this.buttonNodeId);\n\t\t\tEvent.bind(this.buttonNode, 'click', this.onButtonClick.bind(this));\n\t\t}\n\n\t\tconst nameNode = this.node.querySelector('.tasks-scrum-sprint-header-name-container');\n\t\tconst editButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-edit');\n\t\tEvent.bind(editButtonNode, 'click', () => this.emit('changeName', nameNode));\n\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\tconst removeNode = this.node.querySelector('.tasks-scrum-sprint-header-remove');\n\t\t\tEvent.bind(removeNode, 'click', () => {\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_SPRINT'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tthis.emit('removeSprint');\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\tconst tickButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-tick');\n\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-up');\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-down');\n\t\t\tthis.emit('toggleVisibilityContent');\n\t\t});\n\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.onAfterAppend();\n\t\t}\n\t}\n\n\tupTick()\n\t{\n\t\tif (!this.node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tickButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-tick');\n\n\t\tDom.removeClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\t\tDom.addClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\t}\n\n\tdownTick()\n\t{\n\t\tif (!this.node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tickButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-tick');\n\n\t\tDom.removeClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\t\tDom.addClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\t}\n\n\tonButtonClick()\n\t{\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.emit('completeSprint');\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.emit('startSprint');\n\t\t}\n\t}\n}","import {Loc, Tag} from 'main.core';\n\nexport class EventsHeader\n{\n\tconstructor()\n\t{\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<a class=\"ui-link\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_EVENT')}\n\t\t\t</a>\n\t\t`;\n\n\t\treturn this.element;\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\n\nexport class StoryPointsHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.StoryPointsHeader');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.storyPointsNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point\">\n\t\t\t\t${this.sprint.getStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.inWorkStoryPointsNode = (this.sprint.isActive() ? Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-in-work-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_IN_WORK')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-in-work\">\n\t\t\t\t${this.sprint.getUncompletedStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t` : '');\n\n\t\tthis.doneStoryPointsNode = (this.sprint.isPlanned() ? '' : Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-done-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_DONE')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-done\">\n\t\t\t\t${this.sprint.getCompletedStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t`);\n\n\t\tthis.element = Tag.render`\n\t\t\t${this.renderBurnDownChartIcon()}\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-task\">\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-title\">\n\t\t\t\t\t${this.sprint.getNumberTasks()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t${this.storyPointsNode}\n\t\t\t${this.inWorkStoryPointsNode}\n\t\t\t${this.doneStoryPointsNode}\n\t\t`;\n\n\t\tEvent.bind(this.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-entity-title-btn-burn-down-chart'\n\t\t), 'click', () => this.emit('showSprintBurnDownChart'));\n\n\t\treturn this.element;\n\t}\n\n\trenderBurnDownChartIcon(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-burn-down-chart\">\n\t\t\t\t<span class=\"tasks-scrum-entity-burn-down-chart-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateNumberTasks()\n\t{\n\t\tconst parentNode = this.getElementByClassName(this.element, 'tasks-scrum-entity-title-btn-task');\n\t\tparentNode.querySelector('.tasks-scrum-entity-tasks-title').textContent = this.sprint.getNumberTasks();\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.storyPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.storyPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tsetCompletedStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.doneStoryPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.doneStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point-done'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tsetUncompletedStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.inWorkStoryPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.inWorkStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point-in-work'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tgetElementByClassName(elements: HTMLElement[], className: string): HTMLElement\n\t{\n\t\tlet element = null;\n\t\telements.forEach((elem) => {\n\t\t\tif (elem.classList.contains(className))\n\t\t\t{\n\t\t\t\telement = elem;\n\t\t\t}\n\t\t});\n\t\treturn element;\n\t}\n}","import {Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Entity} from '../entity';\nimport {Item} from '../../item/item';\nimport {SprintHeader} from './sprint.header';\nimport {EventsHeader} from './events.header';\nimport {GroupActionsButton} from '../group.actions.button';\nimport {ListItems} from '../list.items';\nimport {StoryPointsHeader} from './story.points.header';\nimport {StoryPoints} from '../../utility/story.points';\n\nimport type {EpicType, ItemParams} from '../../item/item';\nimport type {Views} from '../../view/view';\n\nimport '../../css/sprint.css';\n\ntype SprintInfo = {\n\tsprintGoal?: string\n}\n\nexport type SprintParams = {\n\tid: number,\n\ttmpId: string,\n\tname: string,\n\tsort: number,\n\tdateStart?: number,\n\tdateEnd?: number,\n\tweekendDaysTime?: number,\n\tdefaultSprintDuration: number,\n\tstoryPoints?: string,\n\tcompletedStoryPoints?: string,\n\tuncompletedStoryPoints?: string,\n\tcompletedTasks?: number,\n\tuncompletedTasks?: number,\n\tstatus?: string,\n\tnumberTasks?: number,\n\titems?: Array<ItemParams>,\n\tinfo?: SprintInfo,\n\tviews: Views\n};\n\nexport class Sprint extends Entity\n{\n\tconstructor(params: SprintParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint');\n\n\t\tthis.setSprintParams(params);\n\n\t\tthis.sprintHeader = null;\n\t\tthis.eventsHeader = null;\n\t\tthis.storyPointsHeader = null;\n\t}\n\n\tsetSprintParams(params: SprintParams)\n\t{\n\t\tthis.setTmpId(params.tmpId);\n\t\tthis.setName(params.name);\n\t\tthis.setSort(params.sort);\n\t\tthis.setDateStart(params.dateStart);\n\t\tthis.setDateEnd(params.dateEnd);\n\t\tthis.setWeekendDaysTime(params.weekendDaysTime);\n\t\tthis.setDefaultSprintDuration(params.defaultSprintDuration);\n\t\tthis.setStatus(params.status);\n\t\tthis.setCompletedStoryPoints(params.completedStoryPoints);\n\t\tthis.setUncompletedStoryPoints(params.uncompletedStoryPoints);\n\t\tthis.setCompletedTasks(params.completedTasks);\n\t\tthis.setUncompletedTasks(params.uncompletedTasks);\n\t\tthis.setItems(params.items);\n\t\tthis.setInfo(params.info);\n\t}\n\n\tstatic buildSprint(sprintData: SprintParams = {}): Sprint\n\t{\n\t\tconst sprint = new Sprint(sprintData);\n\t\tsprint.addSprintHeader(SprintHeader.buildHeader(sprint));\n\t\tsprint.addEventsHeader(new EventsHeader());\n\t\tsprint.addStoryPointsHeader(new StoryPointsHeader(sprint));\n\t\tsprint.addGroupActionsButton(new GroupActionsButton());\n\t\tsprint.addListItems(new ListItems(sprint));\n\t\treturn sprint;\n\t}\n\n\taddSprintHeader(sprintHeader: SprintHeader)\n\t{\n\t\tthis.sprintHeader = sprintHeader;\n\t\tthis.sprintHeader.initStyle(this);\n\n\t\tthis.sprintHeader.subscribe('changeName', this.onChangeName.bind(this));\n\t\tthis.sprintHeader.subscribe('removeSprint', this.onRemoveSprint.bind(this));\n\t\tthis.sprintHeader.subscribe('completeSprint', () => this.emit('completeSprint'));\n\t\tthis.sprintHeader.subscribe('startSprint', () => this.emit('startSprint'));\n\t\tthis.sprintHeader.subscribe('changeSprintDeadline', this.onChangeSprintDeadline.bind(this));\n\t\tthis.sprintHeader.subscribe('toggleVisibilityContent', this.toggleVisibilityContent.bind(this));\n\t}\n\n\taddStoryPointsHeader(storyPointsHeader: StoryPointsHeader)\n\t{\n\t\tthis.storyPointsHeader = storyPointsHeader;\n\n\t\tthis.storyPointsHeader.subscribe('showSprintBurnDownChart', () => this.emit('showSprintBurnDownChart'));\n\t}\n\n\taddEventsHeader(eventsHeader: EventsHeader)\n\t{\n\t\tthis.eventsHeader = eventsHeader;\n\t}\n\n\tinitStyle()\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.initStyle(this);\n\t\t}\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn (this.getStatus() === 'active');\n\t}\n\n\tisPlanned(): boolean\n\t{\n\t\treturn (this.getStatus() === 'planned');\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn (this.getStatus() === 'completed');\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn (this.isCompleted());\n\t}\n\n\tisExpired(): boolean\n\t{\n\t\tconst sprintEnd = new Date(this.dateEnd * 1000);\n\t\treturn (this.isActive() && (sprintEnd.getTime() < (new Date()).getTime()));\n\t}\n\n\thasInput(): boolean\n\t{\n\t\treturn !this.isDisabled();\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'sprint';\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tsuper.setItem(newItem);\n\n\t\tnewItem.setDisableStatus(this.isDisabled());\n\t}\n\n\tsetName(name)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : '');\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateNameNode(this.name);\n\t\t}\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetTmpId(tmpId: string)\n\t{\n\t\tthis.tmpId = (Type.isString(tmpId) ? tmpId : '');\n\t}\n\n\tgetTmpId(): string\n\t{\n\t\treturn this.tmpId;\n\t}\n\n\tsetSort(sort)\n\t{\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 1);\n\t}\n\n\tgetSort()\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetDateStart(dateStart)\n\t{\n\t\tthis.dateStart = (Type.isInteger(dateStart) ? parseInt(dateStart, 10) : 0);\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateStartNode(this.dateStart);\n\t\t}\n\t}\n\n\tgetDateStart(): number\n\t{\n\t\treturn parseInt(this.dateStart, 10);\n\t}\n\n\tsetDateEnd(dateEnd)\n\t{\n\t\tthis.dateEnd = (Type.isInteger(dateEnd) ? parseInt(dateEnd, 10) : 0);\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateEndNode(this.dateEnd);\n\t\t}\n\t}\n\n\tgetDateEnd(): number\n\t{\n\t\treturn parseInt(this.dateEnd, 10);\n\t}\n\n\tsetWeekendDaysTime(weekendDaysTime)\n\t{\n\t\tthis.weekendDaysTime = (Type.isInteger(weekendDaysTime) ? parseInt(weekendDaysTime, 10) : 0);\n\t}\n\n\tgetWeekendDaysTime(): number\n\t{\n\t\treturn this.weekendDaysTime;\n\t}\n\n\tsetCompletedStoryPoints(completedStoryPoints)\n\t{\n\t\tthis.completedStoryPoints = new StoryPoints();\n\n\t\tthis.completedStoryPoints.addPoints(completedStoryPoints);\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetCompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetUncompletedStoryPoints(uncompletedStoryPoints)\n\t{\n\t\tthis.uncompletedStoryPoints = new StoryPoints();\n\n\t\tthis.uncompletedStoryPoints.addPoints(uncompletedStoryPoints);\n\n\t\tthis.updateStoryPointsNode();\n\t}\n\n\tgetUncompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.uncompletedStoryPoints;\n\t}\n\n\tsetItems(items)\n\t{\n\t\tif (!Type.isArray(items))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titems.forEach((itemParams: ItemParams) => {\n\t\t\tconst item = new Item(itemParams);\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t\tthis.items.set(item.itemId, item);\n\t\t});\n\t}\n\n\tsetInfo(info: SprintInfo)\n\t{\n\t\tthis.info = (Type.isPlainObject(info) ? info : {sprintGoal: ''});\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tsuper.setNumberTasks(numberTasks);\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.updateNumberTasks();\n\t\t}\n\t}\n\n\tsetCompletedTasks(completedTasks)\n\t{\n\t\tthis.completedTasks = (Type.isInteger(completedTasks) ? parseInt(completedTasks, 10) : 0);\n\t}\n\n\tgetCompletedTasks(): number\n\t{\n\t\treturn this.completedTasks;\n\t}\n\n\tsetUncompletedTasks(uncompletedTasks)\n\t{\n\t\tthis.uncompletedTasks = (Type.isInteger(uncompletedTasks) ? parseInt(uncompletedTasks, 10) : 0);\n\t}\n\n\tgetUncompletedTasks(): number\n\t{\n\t\treturn this.uncompletedTasks;\n\t}\n\n\tsetDefaultSprintDuration(defaultSprintDuration)\n\t{\n\t\tthis.defaultSprintDuration = (Type.isInteger(defaultSprintDuration) ? parseInt(defaultSprintDuration, 10) : 0);\n\t}\n\n\tgetDefaultSprintDuration()\n\t{\n\t\treturn this.defaultSprintDuration;\n\t}\n\n\tgetInfo(): SprintInfo\n\t{\n\t\treturn this.info;\n\t}\n\n\tgetEpics(): Map<number, EpicType>\n\t{\n\t\tconst epics = new Map();\n\t\tthis.items.forEach((item: Item) => {\n\t\t\t//todo wtf, why did not Set work?\n\t\t\tif (item.getEpic())\n\t\t\t{\n\t\t\t\tepics.set(item.getEpic().id, item.getEpic());\n\t\t\t}\n\t\t});\n\t\treturn epics;\n\t}\n\n\tgetUncompletedItems(): Map<string, Item>\n\t{\n\t\tconst items = new Map();\n\t\tthis.items.forEach((item: Item) => {\n\t\t\tif (!item.isCompleted())\n\t\t\t{\n\t\t\t\titems.set(item.getItemId(), item);\n\t\t\t}\n\t\t});\n\t\treturn items;\n\t}\n\n\tsetStatus(status)\n\t{\n\t\tconst availableStatus = new Set([\n\t\t\t'planned',\n\t\t\t'active',\n\t\t\t'completed'\n\t\t]);\n\n\t\tthis.status = (availableStatus.has(status) ? status : 'planned');\n\n\t\tthis.initStyle();\n\n\t\tthis.items.forEach((item) => {\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t});\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\tif (this.input)\n\t\t\t{\n\t\t\t\tthis.input.removeYourself();\n\t\t\t}\n\t\t\tif (this.groupActionsButton)\n\t\t\t{\n\t\t\t\tthis.groupActionsButton.removeYourself();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetStatus(): string\n\t{\n\t\treturn this.status;\n\t}\n\n\tupdateYourself(tmpSprint: Sprint)\n\t{\n\t\tif (tmpSprint.getName() !== this.getName())\n\t\t{\n\t\t\tthis.setName(tmpSprint.getName());\n\t\t}\n\t\tif (tmpSprint.getDateStart() !== this.getDateStart())\n\t\t{\n\t\t\tthis.setDateStart(tmpSprint.getDateStart());\n\t\t}\n\t\tif (tmpSprint.getDateEnd() !== this.getDateEnd())\n\t\t{\n\t\t\tthis.setDateEnd(tmpSprint.getDateEnd());\n\t\t}\n\n\t\tthis.setStoryPoints(tmpSprint.getStoryPoints().getPoints());\n\t\tthis.setCompletedStoryPoints(tmpSprint.getCompletedStoryPoints().getPoints());\n\t\tthis.setUncompletedStoryPoints(tmpSprint.getUncompletedStoryPoints().getPoints());\n\n\t\tif (tmpSprint.getStatus() !== this.getStatus())\n\t\t{\n\t\t\tthis.setStatus(tmpSprint.getStatus());\n\t\t}\n\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.addStoryPointsHeader(new StoryPointsHeader(this));\n\t\t\tDom.replace(this.node.querySelector('.tasks-scrum-sprint-header-event-params'), this.renderParams());\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t\tthis.emit('removeSprint');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint\" data-sprint-sort=\"${this.sort}\" data-sprint-id=\"${this.getId()}\">\n\t\t\t\t${this.sprintHeader ? this.sprintHeader.render() : ''}\n\t\t\t\t<div class=\"tasks-scrum-sprint-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sub-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-event\">\n\t\t\t\t\t\t\t${this.eventsHeader ? '' : ''/*todo*/}\n\t\t\t\t\t\t\t${this.isCompleted() ? this.renderLinkToCompletedSprint() : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.renderParams()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-actions\">\n\t\t\t\t\t\t${this.groupActionsButton  && !this.isDisabled() ? this.groupActionsButton.render() : ''}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-items\">\n\t\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-entity-items-loader\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.itemsLoaderNode = this.node.querySelector('.tasks-scrum-entity-items-loader');\n\t\tthis.bindItemsLoader(this.itemsLoaderNode);\n\n\t\treturn this.node;\n\t}\n\n\trenderParams(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header-event-params\">\n\t\t\t\t${this.storyPointsHeader ? this.storyPointsHeader.render() : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderLinkToCompletedSprint(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<a href=\"${Text.encode(this.getViews().completedSprint.url)}\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_COMPLETED_SPRINT_LINK')}\n\t\t\t</a>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.updateVisibility();\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.onAfterAppend();\n\t\t}\n\n\t\tsuper.onAfterAppend();\n\t}\n\n\tsubscribeToItem(item)\n\t{\n\t\tsuper.subscribeToItem(item);\n\n\t\titem.subscribe('moveToBacklog', (baseEvent) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: baseEvent.getTarget()\n\t\t\t});\n\t\t});\n\n\t\titem.subscribe('updateCompletedStatus', (baseEvent: BaseEvent) => {\n\t\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\t\tif (item.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tthis.setCompletedTasks(this.getCompletedTasks() + 1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.setUncompletedTasks(this.getUncompletedTasks() - 1);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\titem.subscribe('toggleSubTasks', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('toggleSubTasks', baseEvent.getTarget());\n\t\t})\n\t}\n\n\tonChangeName (baseEvent)\n\t{\n\t\tconst createInput = (value) => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input type=\"text\" class=\"tasks-scrum-sprint-header-name\" value=\"${Text.encode(value)}\">\n\t\t\t`;\n\t\t};\n\n\t\tconst inputNode = createInput(this.name);\n\t\tconst nameNode = baseEvent.getData().querySelector('.tasks-scrum-sprint-header-name');\n\n\t\tEvent.bind(inputNode, 'change', (event) => {\n\t\t\tconst newValue = event.target['value'];\n\t\t\tthis.emit('changeSprintName', {\n\t\t\t\tsprintId: this.getId(),\n\t\t\t\tname: newValue\n\t\t\t});\n\t\t\tthis.name = newValue;\n\t\t\tinputNode.blur();\n\t\t}, true);\n\n\t\tconst blockEnterInput = (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t\tinputNode.blur();\n\t\t};\n\n\t\tEvent.bind(inputNode, 'keydown', blockEnterInput);\n\t\tEvent.bindOnce(inputNode, 'blur', () => {\n\t\t\tEvent.unbind(inputNode, 'keydown', blockEnterInput);\n\t\t\tnameNode.textContent = Text.encode(this.name);\n\t\t\tDom.replace(inputNode, nameNode);\n\t\t}, true);\n\n\t\tDom.replace(nameNode, inputNode);\n\n\t\tinputNode.focus();\n\t\tinputNode.setSelectionRange(this.name.length, this.name.length);\n\t}\n\n\tonRemoveSprint()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: item\n\t\t\t});\n\t\t});\n\t\tthis.removeYourself();\n\t}\n\n\tremoveSprint()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: item\n\t\t\t});\n\t\t});\n\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t}\n\n\tonChangeSprintDeadline(baseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.emit('changeSprintDeadline', requestData);\n\t\tif (requestData.hasOwnProperty('dateStart'))\n\t\t{\n\t\t\tthis.dateStart = parseInt(requestData.dateStart, 10);\n\t\t}\n\t\telse if (requestData.hasOwnProperty('dateEnd'))\n\t\t{\n\t\t\tthis.dateEnd = parseInt(requestData.dateEnd, 10);\n\t\t}\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateStartNode(timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateEndNode(timestamp);\n\t\t}\n\t}\n\n\ttoggleVisibilityContent()\n\t{\n\t\tif (this.getContentNode().style.display === 'block')\n\t\t{\n\t\t\tthis.hideContent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showContent();\n\t\t\tif (this.isCompleted() && this.getItems().size === 0)\n\t\t\t{\n\t\t\t\tthis.emit('getSprintCompletedItems');\n\t\t\t}\n\t\t}\n\t}\n\n\tshowContent()\n\t{\n\t\tif (this.getContentNode())\n\t\t{\n\t\t\tthis.getContentNode().style.display = 'block';\n\t\t}\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.upTick();\n\t\t}\n\t}\n\n\thideContent()\n\t{\n\t\tif (this.getContentNode())\n\t\t{\n\t\t\tthis.getContentNode().style.display = 'none';\n\t\t}\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.downTick();\n\t\t}\n\t}\n\n\tupdateVisibility()\n\t{\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tif (this.isEmpty())\n\t\t\t{\n\t\t\t\tthis.hideContent();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showContent();\n\t\t\t}\n\n\t\t\tthis.showSprint();\n\n\t\t\tif (this.isExactSearchApplied())\n\t\t\t{\n\t\t\t\tif (this.isEmpty())\n\t\t\t\t{\n\t\t\t\t\tthis.hideSprint();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showContent();\n\n\t\t\tif (this.isExactSearchApplied())\n\t\t\t{\n\t\t\t\tif (this.isEmpty())\n\t\t\t\t{\n\t\t\t\t\tthis.hideSprint();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showSprint();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showSprint();\n\t\t\t}\n\t\t}\n\t}\n\n\tshowSprint()\n\t{\n\t\tthis.node.style.display = 'block';\n\t}\n\n\thideSprint()\n\t{\n\t\tthis.node.style.display = 'none';\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onActivateGroupMode(baseEvent);\n\n\t\tDom.addClass(this.node.querySelector('.tasks-scrum-sprint-items'), 'tasks-scrum-sprint-items-group-mode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onDeactivateGroupMode(baseEvent);\n\n\t\tDom.removeClass(this.node.querySelector('.tasks-scrum-sprint-items'), 'tasks-scrum-sprint-items-group-mode');\n\t}\n\n\tgetContentNode(): HTMLElement\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\treturn this.node.querySelector('.tasks-scrum-sprint-content');\n\t\t}\n\t}\n\n\tupdateStoryPointsNode()\n\t{\n\t\tsuper.updateStoryPointsNode();\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.setStoryPoints(this.getStoryPoints().getPoints());\n\t\t\tthis.storyPointsHeader.setCompletedStoryPoints(this.getCompletedStoryPoints().getPoints());\n\t\t\tthis.storyPointsHeader.setUncompletedStoryPoints(this.getUncompletedStoryPoints().getPoints());\n\t\t}\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateStatsHeader();\n\t\t}\n\t}\n}","import {Dom} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\n\nexport class SidePanel extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SidePanel');\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\tthis.contentSidePanelManager = new BX.SidePanel.Manager({});\n\t\t/* eslint-enable */\n\n\t\tthis.contentSidePanels = new Set();\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onLoad', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tsidePanel.setCacheable(false);\n\t\t\tthis.emit('onLoadSidePanel', sidePanel);\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tthis.emit('onCloseSidePanel', sidePanel);\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseComplete', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tif (this.contentSidePanels.has(sidePanel.getUrl()))\n\t\t\t{\n\t\t\t\tthis.contentSidePanels.delete(sidePanel.getUrl());\n\t\t\t\tif (!this.contentSidePanels.size)\n\t\t\t\t{\n\t\t\t\t\tthis.resetBodyWidthHack();\n\t\t\t\t\tthis.addEscapePressHandler();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tisPreviousSidePanelExist(currentSidePanel): Boolean\n\t{\n\t\tconst manager = this.contentSidePanels.has(currentSidePanel.getUrl())\n\t\t\t? this.contentSidePanelManager\n\t\t\t: this.sidePanelManager\n\t\t;\n\n\t\treturn Boolean(manager.getPreviousSlider(currentSidePanel));\n\t}\n\n\treloadTopSidePanel(contentSidePanel: boolean = false)\n\t{\n\t\tconst manager = contentSidePanel ? this.contentSidePanelManager : this.sidePanelManager;\n\n\t\tif (manager.getTopSlider())\n\t\t{\n\t\t\tmanager.getTopSlider().reload();\n\t\t}\n\t}\n\n\tcloseTopSidePanel(contentSidePanel: boolean = false)\n\t{\n\t\tconst manager = contentSidePanel ? this.contentSidePanelManager : this.sidePanelManager;\n\n\t\tif (manager.getTopSlider())\n\t\t{\n\t\t\tmanager.getTopSlider().close();\n\t\t}\n\t}\n\n\treloadPreviousSidePanel(currentSidePanel)\n\t{\n\t\tconst manager = this.contentSidePanels.has(currentSidePanel.getUrl())\n\t\t\t? this.contentSidePanelManager\n\t\t\t: this.sidePanelManager\n\t\t;\n\t\tconst previousSidePanel = manager.getPreviousSlider(currentSidePanel);\n\n\t\tpreviousSidePanel.reload();\n\t}\n\n\topenSidePanelByUrl(url)\n\t{\n\t\tthis.sidePanelManager.open(url);\n\t}\n\n\topenSidePanel(id, options)\n\t{\n\t\tthis.applyBodyWidthHack();\n\t\tthis.removeEscapePressHandler();\n\n\t\tthis.contentSidePanelManager.open(id, options);\n\n\t\tthis.contentSidePanels.add(id);\n\t}\n\n\texistFrameTopSlider(): boolean\n\t{\n\t\treturn Boolean(this.sidePanelManager.getTopSlider());\n\t}\n\n\taddEscapePressHandler()\n\t{\n\t\tconst sidePanel = this.sidePanelManager.getTopSlider();\n\t\tif (sidePanel)\n\t\t{\n\t\t\tconst frameWindow = sidePanel.getFrameWindow();\n\t\t\tframeWindow.addEventListener('keydown', sidePanel.handleFrameKeyDown);\n\t\t}\n\t}\n\n\tremoveEscapePressHandler()\n\t{\n\t\tconst sidePanel = this.sidePanelManager.getTopSlider();\n\t\tif (sidePanel)\n\t\t{\n\t\t\tconst frameWindow = sidePanel.getFrameWindow();\n\t\t\tframeWindow.removeEventListener('keydown', sidePanel.handleFrameKeyDown);\n\t\t}\n\t}\n\n\tapplyBodyWidthHack()\n\t{\n\t\tif (this.existFrameTopSlider())\n\t\t{\n\t\t\tDom.addClass(document.body, 'tasks-scrum-side-panel-padding');\n\t\t}\n\t}\n\n\tresetBodyWidthHack()\n\t{\n\t\tif (this.existFrameTopSlider())\n\t\t{\n\t\t\tDom.removeClass(document.body, 'tasks-scrum-side-panel-padding');\n\t\t}\n\t}\n}","import {Loc} from 'main.core';\n\ntype Data = {\n\tday: number,\n\tidealValue: number,\n\tremainValue: number\n}\n\n//todo import amchart4 like es6\nexport class BurnDownChart\n{\n\tconstructor(data: Data)\n\t{\n\t\tthis.data = data;\n\t}\n\n\tcreateChart(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\n\t\tthis.createAxises();\n\n\t\tthis.createIdealLine();\n\t\tthis.createRemainLine();\n\n\t\tthis.createLegend();\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst categoryAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\tcategoryAxis.renderer.grid.template.location = 0;\n\t\tcategoryAxis.dataFields.category = 'day';\n\t\tcategoryAxis.renderer.minGridDistance = 60;\n\n\t\tconst valueAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tvalueAxis.min = -0.1;\n\t}\n\n\tcreateIdealLine()\n\t{\n\t\tconst lineSeries = this.chart.series.push(new am4charts.LineSeries());\n\t\tlineSeries.name = Loc.getMessage('TASKS_SCRUM_SPRINT_IDEAL_BURN_DOWN_CHART_LINE_TITLE'); //todo move from class\n\t\tlineSeries.stroke = am4core.color('#2882b3');\n\t\tlineSeries.strokeWidth = 2;\n\n\t\tlineSeries.dataFields.categoryX = 'day';\n\t\tlineSeries.dataFields.valueY = 'idealValue';\n\n\t\tconst circleColor = '#2882b3';\n\t\tconst circleBullet = new am4charts.CircleBullet();\n\t\tcircleBullet.circle.radius = 4;\n\t\tcircleBullet.circle.fill = am4core.color(circleColor);\n\t\tcircleBullet.circle.stroke = am4core.color(circleColor);\n\n\t\tlineSeries.bullets.push(circleBullet);\n\n\t\tconst segment = lineSeries.segments.template;\n\t\tconst hoverState = segment.states.create('hover');\n\t\thoverState.properties.strokeWidth = 4;\n\t}\n\n\tcreateRemainLine()\n\t{\n\t\tconst lineSeries = this.chart.series.push(new am4charts.LineSeries());\n\t\tlineSeries.name = Loc.getMessage('TASKS_SCRUM_SPRINT_REMAIN_BURN_DOWN_CHART_LINE_TITLE'); //todo move from class\n\t\tlineSeries.stroke = am4core.color('#9c1f1f');\n\t\tlineSeries.strokeWidth = 2;\n\n\t\tlineSeries.dataFields.categoryX = 'day';\n\t\tlineSeries.dataFields.valueY = 'remainValue';\n\n\t\tconst circleColor = '#9c1f1f';\n\t\tconst circleBullet = new am4charts.CircleBullet();\n\t\tcircleBullet.circle.radius = 4;\n\t\tcircleBullet.circle.fill = am4core.color(circleColor);\n\t\tcircleBullet.circle.stroke = am4core.color(circleColor);\n\n\t\tlineSeries.bullets.push(circleBullet);\n\n\t\tconst segment = lineSeries.segments.template;\n\t\tconst hoverState = segment.states.create('hover');\n\t\thoverState.properties.strokeWidth = 4;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.itemContainers.template.events.on('over', (event) => {\n\t\t\tthis.processOver(event.target.dataItem.dataContext);\n\t\t});\n\t\tthis.chart.legend.itemContainers.template.events.on('out', () => this.processOut());\n\t}\n\n\tprocessOver(hoveredLine)\n\t{\n\t\thoveredLine.toFront();\n\t\thoveredLine.segments.each((segment) => segment.setState('hover'));\n\t};\n\n\tprocessOut()\n\t{\n\t\tthis.chart.series.each((series) => {\n\t\t\tseries.segments.each((segment) => segment.setState('default'));\n\t\t\tseries.bulletsContainer.setState('default');\n\t\t});\n\t};\n\n\tdestroyBurnDownChart()\n\t{\n\t\tthis.chart.dispose();\n\t}\n}","import {Event, Loc, Runtime, Tag, Text, Dom, Type} from 'main.core';\nimport {Sprint} from './sprint';\nimport {SidePanel} from '../../service/side.panel';\nimport {RequestSender} from '../../utility/request.sender';\nimport {BaseEvent} from 'main.core.events';\nimport {Confetti} from 'ui.confetti';\nimport {StatsCalculator} from '../../utility/stats.calculator';\nimport {BurnDownChart} from '../../utility/burn.down.chart';\n\nimport '../../css/sprint.side.panel.css';\n\ntype Params = {\n\tsprints?: Map,\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender,\n\tviews: {\n\t\tplan: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tactiveSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tcompletedSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t}\n\t}\n};\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tinfo: EpicInfoType\n}\n\ntype RequestDataToStartSprint = {\n\tsprintId: number,\n\tsprintGoal: string\n}\n\ntype RequestDataToCompleteSprint = {\n\tsprintId: number,\n\tdirection: number|string\n}\n\ntype RequestDataToGetBurnDownChartData = {\n\tsprintId: number\n}\n\nexport class SprintSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sprints = params.sprints ? params.sprints : new Map();\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.views = params.views;\n\n\t\tthis.currentSprint = null;\n\t\tthis.uncompletedItems = new Map();\n\n\t\tthis.lastCompletedSprint = this.getLastCompletedSprint(this.sprints);\n\t}\n\n\tshowStartSidePanel(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-start-side-panel';\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadStartPanel.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildStartPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000,\n\t\t\twidth: 600\n\t\t});\n\t}\n\n\tshowCompleteSidePanel(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-complete-side-panel';\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadCompletePanel.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildCompletePanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000,\n\t\t\twidth: 600\n\t\t});\n\t}\n\n\tshowBurnDownChart(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-sprint-burn-down-chart';\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadSprintBurnDownPanel.bind(this));\n\t\tthis.sidePanel.subscribe('onCloseSidePanel', this.onCloseBurnDownChart.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildBurnDownPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildStartPanel(): HTMLElement\n\t{\n\t\tlet differenceStoryPoints = this.currentSprint.getStoryPoints().getPoints();\n\t\tdifferenceStoryPoints = (differenceStoryPoints > 0 ? '+' + differenceStoryPoints : differenceStoryPoints);\n\t\tif (this.lastCompletedSprint)\n\t\t{\n\t\t\tdifferenceStoryPoints = this.getDifferenceStoryPointsBetweenSprints(\n\t\t\t\tthis.currentSprint,\n\t\t\t\tthis.lastCompletedSprint\n\t\t\t);\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_TASK_COUNT_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t\t${parseInt(this.currentSprint.getNumberTasks())}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box tasks-scrum-sprint-sidepanel-info-box-story\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_STORY_POINTS_COUNT_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t\t${Text.encode(this.currentSprint.getStoryPoints().getPoints())}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-extra\">\n\t\t\t\t\t\t\t\t\t${differenceStoryPoints}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_EPICS_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic-list\">\n\t\t\t\t\t\t\t\t${[...this.currentSprint.getEpics().values()].map((epic: EpicType) => {\n\t\t\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-epic-item\" style=\"background: ${Text.encode(epic.info.color)};\">\n\t\t\t\t\t\t\t\t\t\t\t${Text.encode(epic.name)}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_GOAL_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea ui-ctl-resize-y\">\n\t\t\t\t\t\t\t<textarea class=\"ui-ctl-element\"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadStartPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\n\t\tthis.onLoadStartButtons().then((buttonsContainer: HTMLElement) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', this.onStartSprint.bind(this));\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tbuildCompletePanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t${this.buildSprintGoal()}\n\t\t\t\t${this.buildSprintActions()}\n\t\t\t\t${this.buildSprintPlan()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildBurnDownPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_IDEAL_BURN_DOWN_CHART_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-chart\"></div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintGoal(): HTMLElement|string\n\t{\n\t\tconst sprintInfo = this.currentSprint.getInfo();\n\t\tconst sprintGoal = sprintInfo.sprintGoal;\n\t\tif (!sprintGoal)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_GOAL_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-text\">\n\t\t\t\t\t\t${Text.encode(sprintGoal)}\n\t\t\t\t\t </div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintActions(): HTMLElement|string\n\t{\n\t\tconst uncompletedTasks = this.currentSprint.getUncompletedTasks();\n\t\tif (uncompletedTasks === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tlet listSprintsOptions = '';\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tif (sprint.isPlanned())\n\t\t\t{\n\t\t\t\tlistSprintsOptions += `<option value=\"${sprint.getId()}\">${Text.encode(sprint.getName())}</option>`;\n\t\t\t}\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title tasks-scrum-sprint-sidepanel-title-icon\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-field\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-label\">\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_SELECT')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t<select class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t\t<option value=\"backlog\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_MOVE_SELECTOR_BACKLOG')}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t<option value=\"0\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_NEW_SPRINT')}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t${listSprintsOptions}\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-uncompleted\">\n\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-subtitle\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_ITEM_LIST')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-uncompleted-list\">\n\t\t\t\t\t\t\t${[...this.currentSprint.getUncompletedItems().values()].map((item: Item) => {\n\t\t\t\t\t\t\t\tif (!item.isSubTask())\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst previewItem = item.getPreviewVersion();\n\t\t\t\t\t\t\t\t\tthis.uncompletedItems.set(previewItem.getItemId(), previewItem);\n\t\t\t\t\t\t\t\t\treturn previewItem.render();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintPlan(): HTMLElement\n\t{\n\t\tconst statsCalculator = new StatsCalculator();\n\t\tconst percentage = statsCalculator.calculatePercentage(\n\t\t\tthis.currentSprint.getStoryPoints().getPoints(),\n\t\t\tthis.currentSprint.getCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\tlet differencePercentage = statsCalculator.calculatePercentage(\n\t\t\tthis.currentSprint.getStoryPoints().getPoints(),\n\t\t\tthis.currentSprint.getCompletedStoryPoints().getPoints()\n\t\t);\n\t\tif (this.lastCompletedSprint)\n\t\t{\n\t\t\tdifferencePercentage = this.getDifferencePercentageBetweenSprints(\n\t\t\t\tthis.currentSprint,\n\t\t\t\tthis.lastCompletedSprint\n\t\t\t);\n\t\t}\n\n\t\tconst percentageNodeClass = (differencePercentage > 0 ? '' : 'tasks-scrum-sprint-sidepanel-info-dif-min');\n\t\tconst absoluteValue = Math.abs(differencePercentage);\n\t\tconst speedInfoMessage = (differencePercentage > 0 ?\n\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED_UP').replace('#value#', absoluteValue) :\n\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED_DOWN').replace('#value#', absoluteValue)\n\t\t);\n\n\t\tconst renderSpeed = (speedInfoMessage) => {\n\t\t\treturn ''; //todo chart\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-speed\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-subtitle\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED')}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-result\">${speedInfoMessage}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-graph\"></div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_PLAN_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box tasks-scrum-sprint-sidepanel-info-box-w100\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_PLAN_DONE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t${percentage}%\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif ${percentageNodeClass}\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-arrow\"></span>\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-dif-block\">\n\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-val\">${absoluteValue}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-icon\">%</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${renderSpeed()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadCompletePanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\t\tconst itemsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-uncompleted-list');\n\n\t\t[...this.uncompletedItems.values()].map((previewItem: Item) => {\n\t\t\tpreviewItem.onAfterAppend(itemsContainer);\n\t\t\tpreviewItem.subscribe('showTask', () => {\n\t\t\t\tthis.currentSprint.emit('showTask', previewItem);\n\t\t\t});\n\t\t});\n\n\t\tthis.onLoadCompleteButtons().then((buttonsContainer: HTMLElement) => {\n\t\t\tEvent.bind(\n\t\t\t\tbuttonsContainer.querySelector('[name=save]'),\n\t\t\t\t'click',\n\t\t\t\tthis.onCompleteSprint.bind(this, sidePanel)\n\t\t\t);\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tonLoadSprintBurnDownPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\n\t\tthis.getBurnDownChartData().then((data) => {\n\n\t\t\tsidePanel.closeLoader();\n\t\t\t\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.burnDownChart = new BurnDownChart(data);\n\t\t\t\tthis.burnDownChart.createChart(this.form.querySelector('.tasks-scrum-sprint-sidepanel-chart'));\n\t\t\t}, 300);\n\n\t\t});\n\t}\n\n\tonCloseBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tif (this.sidePanelId === sidePanel.getUrl())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.burnDownChart)\n\t\t\t\t{\n\t\t\t\t\tthis.burnDownChart.destroyBurnDownChart();\n\t\t\t\t\tthis.burnDownChart = null;\n\t\t\t\t}\n\t\t\t}, 300);\n\t\t}\n\t}\n\n\tgetTasksCountLabel(count)\n\t{\n\t\tif (count > 5)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_3');\n\t\t}\n\t\telse if (count === 1)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_2');\n\t\t}\n\t}\n\n\tgetLastCompletedSprint(sprints: Map): Sprint\n\t{\n\t\treturn [...sprints.values()].find((sprint) => sprint.isCompleted() === true);\n\t}\n\n\tgetDifferenceStoryPointsBetweenSprints(firstSprint: Sprint, secondSprint: Sprint): string\n\t{\n\t\tlet difference = parseFloat(\n\t\t\tfirstSprint.getStoryPoints().getPoints() - secondSprint.getStoryPoints().getPoints()\n\t\t);\n\n\t\tif (Type.isFloat(difference))\n\t\t{\n\t\t\tdifference = difference.toFixed(1);\n\t\t}\n\n\t\tif (difference === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn (difference > 0 ? '+' + difference : difference);\n\t\t}\n\t}\n\n\tgetDifferencePercentageBetweenSprints(firstSprint: Sprint, secondSprint: Sprint): number\n\t{\n\t\tconst statsCalculator = new StatsCalculator();\n\n\t\tconst firstPercentage = statsCalculator.calculatePercentage(\n\t\t\tfirstSprint.getStoryPoints().getPoints(),\n\t\t\tfirstSprint.getCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\tconst secondPercentage = statsCalculator.calculatePercentage(\n\t\t\tsecondSprint.getStoryPoints().getPoints(),\n\t\t\tsecondSprint.getCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\treturn parseFloat(firstPercentage) - parseFloat(secondPercentage);\n\t}\n\n\tgetStartButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getSprintStartButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetCompleteButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getSprintCompleteButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetBurnDownChartData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getBurnDownChartData(this.getRequestDataToGetBurnDownChartData()).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t})\n\t\t});\n\t}\n\n\tonLoadStartButtons(): Promise\n\t{\n\t\treturn this.getStartButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadCompleteButtons(): Promise\n\t{\n\t\treturn this.getCompleteButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonStartSprint()\n\t{\n\t\tthis.requestSender.startSprint(this.getRequestDataToStartSprint()).then((response) => {\n\t\t\tthis.currentSprint.setStatus('active');\n\t\t\tlocation.href = this.views['activeSprint'].url;\n\t\t}).catch((response) => {\n\t\t\tthis.removeClockIconFromButton();\n\t\t\tthis.requestSender.showErrorAlert(response, Loc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP'));\n\t\t});\n\t}\n\n\tonCompleteSprint(sidePanel)\n\t{\n\t\tthis.requestSender.completeSprint(this.getRequestDataToCompleteSprint()).then((response) => {\n\t\t\tif (Confetti)\n\t\t\t{\n\t\t\t\tConfetti.fire({\n\t\t\t\t\tparticleCount: 400,\n\t\t\t\t\tspread: 80,\n\t\t\t\t\torigin: {\n\t\t\t\t\t\tx: 0.7,\n\t\t\t\t\t\ty: 0.2\n\t\t\t\t\t},\n\t\t\t\t\tzIndex: (sidePanel.getZindex() + 1)\n\t\t\t\t}).then(() => {\n\t\t\t\t\tlocation.href = this.views['plan'].url;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlocation.href = this.views['plan'].url;\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.removeClockIconFromButton();\n\t\t\tthis.requestSender.showErrorAlert(response, Loc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP'));\n\t\t});\n\t}\n\n\tgetRequestDataToStartSprint(): RequestDataToStartSprint\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\t\trequestData.sprintGoal = this.form.querySelector('textarea').value;\n\n\t\treturn requestData;\n\t}\n\n\tgetRequestDataToCompleteSprint(): RequestDataToCompleteSprint\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\t\tconst directionSelectNode = this.form.querySelector('select');\n\t\trequestData.direction = (directionSelectNode ? directionSelectNode.value : 'backlog');\n\n\t\treturn requestData;\n\t}\n\n\tgetRequestDataToGetBurnDownChartData(): RequestDataToGetBurnDownChartData\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\n\t\treturn requestData;\n\t}\n\n\tremoveClockIconFromButton()\n\t{\n\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\tif (buttonsContainer)\n\t\t{\n\t\t\tDom.removeClass(buttonsContainer.querySelector('[name=save]'), 'ui-btn-wait');\n\t\t}\n\t}\n}","import {Entity} from '../entity/entity';\nimport {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\n\nexport class EntityStorage\n{\n\tconstructor()\n\t{\n\t\tthis.backlog = null;\n\t\tthis.sprints = new Map();\n\t}\n\n\taddBacklog(backlog: Backlog)\n\t{\n\t\tif (!(backlog instanceof Backlog))\n\t\t{\n\t\t\tthrow new Error('EntityStorage: Backlog is in wrong format');\n\t\t}\n\n\t\tthis.backlog = backlog;\n\t}\n\n\taddSprint(sprint: Sprint)\n\t{\n\t\tthis.sprints.set(sprint.getId(), sprint);\n\t}\n\n\tremoveSprint(sprintId: number)\n\t{\n\t\tthis.sprints.delete(sprintId);\n\t}\n\n\tgetBacklog(): Backlog\n\t{\n\t\tif (this.backlog === null)\n\t\t{\n\t\t\tthrow new Error('EntityStorage: Backlog not found');\n\t\t}\n\n\t\treturn this.backlog;\n\t}\n\n\tgetSprints(): Map<number, Sprint>\n\t{\n\t\treturn this.sprints;\n\t}\n\n\tgetSprintsAvailableForFilling(entityFrom: Entity): Set<Sprint>\n\t{\n\t\tconst sprints = new Set();\n\n\t\tthis.sprints.forEach((sprint: Sprint) => {\n\t\t\tif (!sprint.isCompleted() && entityFrom.getId() !== sprint.getId())\n\t\t\t{\n\t\t\t\tsprints.add(sprint);\n\t\t\t}\n\t\t});\n\n\t\treturn sprints;\n\t}\n\n\tgetAllEntities(): Map<number, Entity>\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(this.backlog.getId(), this.backlog);\n\n\t\t[...this.sprints.values()].map((sprint) => entities.set(sprint.getId(), sprint));\n\n\t\treturn entities;\n\t}\n\n\tgetAllItems(): Map<number, Item>\n\t{\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\t[...this.sprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn items;\n\t}\n\n\trecalculateItemsSort()\n\t{\n\t\tthis.backlog.recalculateItemsSort();\n\t\tthis.sprints.forEach((sprint) => sprint.recalculateItemsSort());\n\t}\n\n\tfindEntityByEntityId(entityId: number): Entity\n\t{\n\t\tentityId = parseInt(entityId, 10);\n\n\t\tif (this.backlog.getId() === entityId)\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === entityId);\n\t}\n\n\tfindItemByItemId(itemId: number): Item\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn backlogItems.get(itemId);\n\t\t}\n\n\t\tconst sprint = [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t\tif (sprint)\n\t\t{\n\t\t\treturn sprint.getItems().get(itemId);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindItemBySourceId(sourceId: number): Item\n\t{\n\t\tsourceId = parseInt(sourceId, 10);\n\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\t[...this.sprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn [...items.values()].find((item: Item) => item.getSourceId() === sourceId);\n\t}\n\n\tfindEntityByItemId(itemId: number): Entity\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t}\n}","import {Entity} from '../entity/entity';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage\n}\n\nexport class ItemStyleDesigner\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.listAllUsedColors = new Set();\n\n\t\tthis.updateBorderColorForLinkedItems();\n\t}\n\n\tupdateBorderColorForLinkedItems()\n\t{\n\t\tconst itemIdsToUpdateColor = new Set();\n\t\tthis.entityStorage.getAllItems().forEach((item: Item) => {\n\t\t\tif (item.isLinkedTask() && !item.getBorderColor())\n\t\t\t{\n\t\t\t\titemIdsToUpdateColor.add(item.getItemId());\n\t\t\t}\n\t\t});\n\n\t\tif (itemIdsToUpdateColor.size)\n\t\t{\n\t\t\tthis.getAllUsedColors().then(() => {\n\t\t\t\tconst items = new Map();\n\t\t\t\titemIdsToUpdateColor.forEach((itemId: number) => {\n\t\t\t\t\titems.set(itemId, this.getRandomColor(this.getAllColors()));\n\t\t\t\t});\n\t\t\t\tthis.requestSender.updateBorderColorToLinkedItems({\n\t\t\t\t\titems: Object.fromEntries(items)\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tconst updatedItems = response.data;\n\t\t\t\t\tObject.keys(updatedItems).forEach((itemId: number) => {\n\t\t\t\t\t\tconst borderColor = updatedItems[itemId];\n\t\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\t\titem.setBorderColor(borderColor);\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tgetRandomColorForItemBorder(): Promise\n\t{\n\t\treturn this.getAllUsedColors().then(() => {\n\t\t\treturn this.getRandomColor(this.getAllColors());\n\t\t});\n\t}\n\n\tgetAllColors(): Array\n\t{\n\t\tconst colorPicker = this.getColorPicker();\n\t\tlet allColors = [];\n\t\tcolorPicker.getDefaultColors().forEach((defaultColors) => {\n\t\t\tallColors = [...allColors, ...defaultColors];\n\t\t});\n\n\t\treturn allColors;\n\t}\n\n\tgetRandomColor(allColors: Array): string\n\t{\n\t\tconst randomColor = allColors[Math.floor(Math.random() * allColors.length)];\n\t\tif (this.isThisBorderColorAlreadyUse(randomColor))\n\t\t{\n\t\t\treturn this.getRandomColor(allColors);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn randomColor;\n\t\t}\n\t}\n\n\tisThisBorderColorAlreadyUse(color: string): boolean\n\t{\n\t\tlet isAlreadyUse = false;\n\n\t\tthis.listAllUsedColors.forEach((usedColor: string) => {\n\t\t\tif (usedColor === color)\n\t\t\t{\n\t\t\t\tisAlreadyUse = true;\n\t\t\t}\n\t\t});\n\n\t\treturn isAlreadyUse;\n\t}\n\n\tgetAllUsedColors(): Promise\n\t{\n\t\tconst entityIds = new Set();\n\t\tthis.entityStorage.getAllEntities().forEach((entity: Entity) => {\n\t\t\tif (!entity.isCompleted())\n\t\t\t{\n\t\t\t\tentityIds.add(entity.getId());\n\t\t\t}\n\t\t});\n\n\t\treturn this.requestSender.getAllUsedItemBorderColors({\n\t\t\tentityIds: [...entityIds.values()]\n\t\t}).then((response) => {\n\t\t\tthis.listAllUsedColors = new Set([response.data]);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tgetColorPicker()\n\t{\n\t\t/* eslint-disable */\n\t\treturn new BX.ColorPicker();\n\t\t/* eslint-enable */\n\t}\n}","import {Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {EventEmitter} from 'main.core.events';\nimport {Draggable} from 'ui.draganddrop.draggable';\n\nimport {Sprint} from '../entity/sprint/sprint';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tdefaultSprintDuration: number,\n\tpageNumberToCompletedSprints: number\n}\n\nexport class DomBuilder extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DomBuilder');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.defaultSprintDuration = params.defaultSprintDuration;\n\t\tthis.pageNumberToCompletedSprints = parseInt(params.pageNumberToCompletedSprints, 10);\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tthis.scrumContainer = container;\n\n\t\tthis.append(this.entityStorage.getBacklog().render(), this.scrumContainer);\n\t\tthis.entityStorage.getBacklog().onAfterAppend();\n\n\t\tthis.append(this.renderSprintsContainer(), this.scrumContainer);\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tsprint.onAfterAppend();\n\t\t});\n\n\t\tthis.sprintCreatingButtonNode = document.getElementById(this.sprintCreatingButtonNodeId);\n\t\tthis.sprintCreatingDropZoneNode = document.getElementById(this.sprintCreatingDropZoneNodeId);\n\t\tthis.sprintListNode = document.getElementById(this.sprintListNodeId);\n\n\t\tEvent.bind(this.sprintCreatingButtonNode, 'click', this.createSprint.bind(this));\n\n\t\tthis.setDraggable();\n\t}\n\n\tgetSprintCreatingDropZoneNode(): HTMLElement\n\t{\n\t\treturn this.sprintCreatingDropZoneNode;\n\t}\n\n\tgetSprintPlannedListNode(): HTMLElement\n\t{\n\t\treturn this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\t}\n\n\tsetDraggable()\n\t{\n\t\tconst itemContainers = [];\n\t\titemContainers.push(this.entityStorage.getBacklog().getListItemsNode());\n\t\tif (this.sprintCreatingDropZoneNode)\n\t\t{\n\t\t\titemContainers.push(this.sprintCreatingDropZoneNode);\n\t\t}\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (!sprint.isDisabled())\n\t\t\t{\n\t\t\t\titemContainers.push(sprint.getListItemsNode());\n\t\t\t}\n\t\t});\n\t\tthis.draggableItems = new Draggable({\n\t\t\tcontainer: itemContainers,\n\t\t\tdraggable: '.tasks-scrum-item-drag',\n\t\t\tdragElement: '.tasks-scrum-item',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t\tdelay: 260\n\t\t});\n\t\tthis.draggableItems.subscribe('start', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('itemMoveStart', dragEndEvent);\n\t\t\tthis.showDropZoneForSprintCreating(dragEndEvent);\n\t\t});\n\t\tthis.draggableItems.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('itemMoveEnd', dragEndEvent);\n\t\t\tthis.hideDropZoneForSprintCreating(dragEndEvent);\n\t\t});\n\n\t\tthis.draggableSprints = new Draggable({\n\t\t\tcontainer: this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list'),\n\t\t\tdraggable: '.tasks-scrum-sprint',\n\t\t\tdragElement: '.tasks-scrum-sprint-dragndrop',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t});\n\t\tthis.draggableSprints.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('sprintMove', dragEndEvent);\n\t\t});\n\t}\n\n\trenderSprintsContainer(): HTMLElement\n\t{\n\t\tconst createCreatingButton = () => {\n\t\t\tthis.sprintCreatingButtonNodeId = 'tasks-scrum-sprint-creating-button';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-sprint-create ui-btn ui-btn-md ui-btn-themes ui-btn-light-border ui-btn-icon-add\">\n\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD')}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createCreatingDropZone = () => {\n\t\t\tthis.sprintCreatingDropZoneNodeId = 'tasks-scrum-sprint-creating-drop-zone';\n\n\t\t\tconst className = this.entityStorage.getSprints().size\n\t\t\t\t? 'tasks-scrum-sprint-sprint-drop-hide'\n\t\t\t\t: 'tasks-scrum-sprint-sprint-drop'\n\t\t\t;\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingDropZoneNodeId}\" class=\"${className}\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-file-drop tasks-scrum-sprint-sprint-add-drop\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t<small>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_DROP')}</small>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createSprintsList = () => {\n\t\t\tthis.sprintListNodeId = 'tasks-scrum-sprint-list';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintListNodeId}\" class=\"tasks-scrum-sprint-list\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-active-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isActive())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-planned-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isPlanned())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-completed-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isCompleted())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-completed-loader\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst sprintsNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprints\">\n\t\t\t\t${createCreatingButton()}\n\t\t\t\t${createCreatingDropZone()}\n\t\t\t\t${createSprintsList()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.completedSprintLoader = sprintsNode.querySelector('.tasks-scrum-sprint-completed-loader');\n\t\tthis.bindLoadCompletedSprints(this.completedSprintLoader);\n\n\t\treturn sprintsNode;\n\t}\n\n\tshowDropZoneForSprintCreating(dragEndEvent)\n\t{\n\t\tif (this.isSprintSourceEntity(dragEndEvent))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dropZoneNode = this.getSprintCreatingDropZoneNode();\n\t\tif (!dropZoneNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdropZoneNode.className = 'tasks-scrum-sprint-sprint-drop';\n\t}\n\n\thideDropZoneForSprintCreating(dragEndEvent)\n\t{\n\t\tif (this.isSprintSourceEntity(dragEndEvent))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dropZoneNode = this.getSprintCreatingDropZoneNode();\n\t\tif (!dropZoneNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdropZoneNode.className = 'tasks-scrum-sprint-sprint-drop-hide';\n\t}\n\n\tisSprintSourceEntity(dragEndEvent)\n\t{\n\t\tif (dragEndEvent && dragEndEvent.sourceContainer)\n\t\t{\n\t\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\n\t\t\tif (sourceEntity && sourceEntity.getEntityType() === 'sprint')\n\t\t\t{\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tbindLoadCompletedSprints(loader: HTMLElement)\n\t{\n\t\tconst observer = new IntersectionObserver((entries) =>\n\t\t\t{\n\t\t\t\tif(entries[0].isIntersecting === true)\n\t\t\t\t{\n\t\t\t\t\tif (!this.isActiveLoadCompletedSprints)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onLoadCompletedSprints();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tthreshold: [0]\n\t\t\t}\n\t\t);\n\n\t\tobserver.observe(loader);\n\t}\n\n\tonLoadCompletedSprints()\n\t{\n\t\tthis.isActiveLoadCompletedSprints = true;\n\n\t\tconst loader = this.showLoader(this.completedSprintLoader);\n\n\t\tconst requestData = {\n\t\t\tpageNumber: this.pageNumberToCompletedSprints + 1\n\t\t};\n\n\t\tthis.requestSender.getCompletedSprints(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tconst data = response.data;\n\t\t\t\tif (Type.isArray(data) && data.length)\n\t\t\t\t{\n\t\t\t\t\tthis.pageNumberToCompletedSprints++;\n\t\t\t\t\tthis.isActiveLoadCompletedSprints = false;\n\n\t\t\t\t\tthis.createSprints(data);\n\t\t\t\t}\n\t\t\t\tloader.hide();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\tthis.isActiveLoadCompletedSprints = false;\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tcreateSprints(sprints: Array)\n\t{\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-completed-list');\n\n\t\tsprints.forEach((sprintData: SprintParams) => {\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tif (!this.entityStorage.findEntityByEntityId(sprint.getId()))\n\t\t\t{\n\t\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t\t\tthis.append(sprint.render(), sprintListNode);\n\t\t\t\tsprint.onAfterAppend();\n\t\t\t\tthis.emit('createSprint', sprint);\n\t\t\t}\n\t\t});\n\t}\n\n\tshowLoader(container: HTMLElement): Loader\n\t{\n\t\tconst listPosition = this.getPosition(container);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: container,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n\n\tcreateSprint(): Promise\n\t{\n\t\tthis.hideDropZoneForSprintCreating();\n\n\t\tconst countSprints = this.entityStorage.getSprints().size;\n\t\tconst title = Loc.getMessage('TASKS_SCRUM_SPRINT_NAME').replace('%s', countSprints + 1);\n\t\tconst storyPoints = 0;\n\t\tconst dateStart = Math.floor(Date.now() / 1000);\n\t\tconst dateEnd = (Math.floor(Date.now() / 1000) + parseInt(this.defaultSprintDuration, 10));\n\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\t\tconst sort = (sprintListNode.children.length ? sprintListNode.children.length + 1 : 1);\n\n\t\tconst sprint = Sprint.buildSprint({\n\t\t\tname: title,\n\t\t\tsort: sort,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd,\n\t\t\tstoryPoints: storyPoints\n\t\t});\n\t\tthis.append(sprint.render(), sprintListNode);\n\n\t\tconst requestData = {\n\t\t\ttmpId: Text.getRandom(),\n\t\t\tname: title,\n\t\t\tsort: sort,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd\n\t\t};\n\n\t\tthis.emit('beforeCreateSprint', requestData);\n\n\t\treturn this.requestSender.createSprint(requestData).then((response) => {\n\t\t\tsprint.setId(response.data.sprintId);\n\t\t\tsprint.onAfterAppend();\n\t\t\tsprint.getNode().scrollIntoView(true);\n\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\t\t\tthis.emit('createSprint', sprint);\n\t\t\treturn sprint;\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tcreateSprintNode(sprint: Sprint)\n\t{\n\t\tthis.remove(this.sprintCreatingDropZoneNode);\n\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\n\t\tthis.append(sprint.render(), sprintListNode);\n\n\t\tsprint.onAfterAppend();\n\n\t\tthis.entityStorage.addSprint(sprint);\n\n\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\n\t\tthis.emit('createSprintNode', sprint);\n\t}\n\n\tmoveSprintToActiveListNode(sprint: Sprint)\n\t{\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-active-list');\n\n\t\tthis.append(sprint.getNode(), sprintListNode);\n\t}\n\n\tmoveSprintToCompletedListNode(sprint: Sprint)\n\t{\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-completed-list');\n\n\t\tif (sprintListNode.firstElementChild)\n\t\t{\n\t\t\tthis.insertBefore(sprint.getNode(), sprintListNode.firstElementChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.append(sprint.getNode(), sprintListNode);\n\t\t}\n\t}\n\n\tappend(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tDom.append(current, target);\n\t}\n\n\tinsertBefore(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tDom.insertBefore(current, target);\n\t}\n\n\tremove(element: ?HTMLElement)\n\t{\n\t\tDom.remove(element);\n\t}\n\n\tgetPosition(element: HTMLElement): DOMRect\n\t{\n\t\treturn Dom.getPosition(element);\n\t}\n\n\tappendItemAfterItem(newItemNode: HTMLElement, bindItemNode: HTMLElement)\n\t{\n\t\tif (bindItemNode.nextElementSibling)\n\t\t{\n\t\t\tDom.insertBefore(newItemNode, bindItemNode.nextElementSibling);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newItemNode, bindItemNode.parentElement);\n\t\t}\n\t}\n}","import {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\n\nimport type {ItemParams} from '../item/item';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder\n}\n\nexport class SubTasksManager\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\n\t\tthis.listSubTasks = new Map();\n\t\tthis.visibilityList = new Set();\n\t}\n\n\ttoggleSubTasks(sprint: Sprint, item: Item): Promise\n\t{\n\t\tif (this.listSubTasks.has(item.getItemId()))\n\t\t{\n\t\t\tif (this.isShown(item))\n\t\t\t{\n\t\t\t\tthis.hideSubTaskItems(sprint, item);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showSubTaskItems(sprint, item);\n\t\t\t}\n\n\t\t\titem.toggleSubTasksTick();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.requestSender.getSubTaskItems({\n\t\t\t\tentityId: sprint.getId(),\n\t\t\t\ttaskId: item.getSourceId()\n\t\t\t}).then((response) => {\n\t\t\t\tconst listItemParams = response.data;\n\t\t\t\tconst listSubTaskItems = new Map();\n\t\t\t\tlistItemParams.forEach((itemParams: ItemParams) => {\n\t\t\t\t\tconst subTaskItem = this.buildSubTaskItem(itemParams);\n\t\t\t\t\tlistSubTaskItems.set(subTaskItem.getItemId(), subTaskItem);\n\t\t\t\t});\n\t\t\t\tthis.listSubTasks.set(item.getItemId(), listSubTaskItems);\n\t\t\t\tif (this.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tthis.hideSubTaskItems(sprint, item);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showSubTaskItems(sprint, item);\n\t\t\t\t}\n\t\t\t\titem.toggleSubTasksTick();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t}\n\t}\n\n\tbuildSubTaskItem(itemParams: ItemParams): Item\n\t{\n\t\treturn new Item(itemParams);\n\t}\n\n\tshowSubTaskItems(sprint: Sprint, parentItem: Item)\n\t{\n\t\tconst parentItemNode = parentItem.getItemNode();\n\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\tif (!listSubTasks)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlistSubTasks.forEach((subTaskItem: Item) => {\n\t\t\tsprint.setItem(subTaskItem);\n\t\t\tthis.domBuilder.appendItemAfterItem(subTaskItem.render(), parentItemNode);\n\t\t\tsubTaskItem.onAfterAppend(sprint.getListItemsNode());\n\t\t});\n\n\t\tthis.setVisibility(parentItem);\n\t}\n\n\thideSubTaskItems(sprint: Sprint, parentItem: Item)\n\t{\n\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\tif (!listSubTasks)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlistSubTasks.forEach((subTaskItem: Item) => {\n\t\t\tif (subTaskItem.isParentTask())\n\t\t\t{\n\t\t\t\tthis.hideSubTaskItems(sprint, subTaskItem);\n\t\t\t}\n\t\t\tsprint.removeItem(subTaskItem);\n\t\t\tsubTaskItem.removeYourself();\n\t\t});\n\n\t\tthis.cleanVisibility(parentItem);\n\t}\n\n\taddSubTask(parentItem: Item, item: Item)\n\t{\n\t\tif (this.listSubTasks.has(parentItem.getItemId()))\n\t\t{\n\t\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\t\tlistSubTasks.set(item.getItemId(), item);\n\t\t\tthis.listSubTasks.set(parentItem.getItemId(), listSubTasks);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst listSubTasks = new Map();\n\t\t\tlistSubTasks.set(item.getItemId(), item);\n\t\t\treturn this.listSubTasks.set(parentItem.getItemId(), listSubTasks);\n\t\t}\n\t}\n\n\tgetSubTasks(parentItem: Item): Map<number, Item>\n\t{\n\t\treturn this.listSubTasks.get(parentItem.getItemId());\n\t}\n\n\tisShown(item: Item)\n\t{\n\t\treturn this.visibilityList.has(item.getItemId());\n\t}\n\n\tsetVisibility(item: Item)\n\t{\n\t\tthis.visibilityList.add(item.getItemId());\n\t}\n\n\tcleanVisibility(item: Item)\n\t{\n\t\tthis.visibilityList.delete(item.getItemId());\n\t}\n\n\tcleanSubTasks(item: Item)\n\t{\n\t\tthis.listSubTasks.delete(item.getItemId());\n\t}\n}","import {Tag, Dom, Loc, Event, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Entity} from '../../entity/entity';\nimport {Responsible, Item} from '../item';\n\nimport {ItemStyleDesigner} from '../../utility/item.style.designer';\nimport {SubTasksManager} from '../../utility/subtasks.manager';\nimport {Input} from '../../utility/input';\n\nimport '../../css/decomposition.css';\n\ntype Params = {\n\tentity: Entity,\n\titemStyleDesigner: ItemStyleDesigner,\n\tsubTasksCreator: SubTasksManager\n}\n\nexport class Decomposition extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.entity = params.entity;\n\t\tthis.itemStyleDesigner = params.itemStyleDesigner;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Decomposition');\n\n\t\tthis.items = new Set();\n\n\t\tthis.input = new Input();\n\t\tthis.input.setPlaceholder(Loc.getMessage('TASKS_SCRUM_TASK_ADD_DECOMPOSITION_INPUT_PLACEHOLDER'));\n\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t}\n\n\tdecomposeItem(item: Item)\n\t{\n\t\tthis.addDecomposedItem(item);\n\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tthis.onDecomposeItem(item, item.getItemNode());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!this.subTasksCreator.isShown(item))\n\t\t\t{\n\t\t\t\tthis.subTasksCreator.toggleSubTasks(this.entity, item).then(() => {\n\t\t\t\t\tconst lastSubTask = this.getSubTasks(item)[0];\n\t\t\t\t\tconst targetItemNode = (lastSubTask ? lastSubTask.getItemNode() : item.getItemNode());\n\t\t\t\t\tthis.onDecomposeItem(item, targetItemNode);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst lastSubTask = this.getSubTasks(item)[0];\n\t\t\t\tthis.onDecomposeItem(item, lastSubTask.getItemNode());\n\t\t\t}\n\t\t}\n\t}\n\n\tonDecomposeItem(item: Item, targetItemNode)\n\t{\n\t\tDom.insertAfter(this.input.render(), targetItemNode);\n\t\tthis.input.setNode();\n\n\t\tconst inputNode = this.input.getInputNode();\n\t\tEvent.bind(inputNode, 'input', this.input.onTagSearch.bind(this.input));\n\t\tEvent.bind(inputNode, 'keydown', this.onCreateItem.bind(this));\n\t\tinputNode.focus();\n\n\t\tconst button = this.createButton();\n\t\tDom.insertAfter(button, this.input.getNode());\n\n\t\tEvent.bind(button.querySelector('button'), 'click', () => {\n\t\t\tif (this.isBacklogDecomposition() && this.isFirstDecomposition() && !item.isLinkedTask())\n\t\t\t{\n\t\t\t\titem.setBorderColor();\n\t\t\t}\n\t\t\tif (!this.isBacklogDecomposition())\n\t\t\t{\n\t\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tthis.subTasksCreator.hideSubTaskItems(this.entity, item);\n\t\t\t\t}\n\t\t\t\tthis.subTasksCreator.cleanSubTasks(item);\n\t\t\t}\n\t\t\tthis.deactivateDecompositionMode();\n\t\t\tthis.input.removeYourself()\n\t\t\tDom.remove(button);\n\t\t});\n\n\t\tthis.setResponsible(item.getResponsible());\n\t}\n\n\tgetSubTasks(parentItem: Item): Array\n\t{\n\t\treturn Array.from(this.subTasksCreator.getSubTasks(parentItem).values());\n\t}\n\n\tgetLastDecomposedItemNode(parentItem: Item): HTMLElement\n\t{\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tconst decomposedItems = this.getDecomposedItems();\n\t\t\tconst lastDecomposedItem = Array.from(decomposedItems).pop();\n\n\t\t\treturn lastDecomposedItem.getItemNode();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst subTasks = this.getSubTasks(parentItem);\n\t\t\tif (subTasks.length)\n\t\t\t{\n\t\t\t\tconst lastSubTask = (this.isFirstDecomposition() ? subTasks[0] : subTasks.pop());\n\n\t\t\t\treturn lastSubTask.getItemNode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn parentItem.getItemNode();\n\t\t\t}\n\t\t}\n\t}\n\n\tisBacklogDecomposition(): boolean\n\t{\n\t\treturn this.entity.getEntityType() === 'backlog';\n\t}\n\n\taddDecomposedItem(item: Item)\n\t{\n\t\tthis.activateDecompositionMode(item);\n\n\t\titem.subscribe('changeTaskResponsible', this.saveSelectedResponsible.bind(this));\n\n\t\tthis.items.add(item);\n\t}\n\n\tgetDecomposedItems(): Set\n\t{\n\t\treturn this.items;\n\t}\n\n\tactivateDecompositionMode(item: Item)\n\t{\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tthis.itemStyleDesigner.getRandomColorForItemBorder().then((randomColor: string) => {\n\t\t\t\titem.activateDecompositionMode(randomColor);\n\t\t\t\tthis.setBorderColor(item.getBorderColor());\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\titem.activateDecompositionMode();\n\t\t}\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.items.forEach((item) => {\n\t\t\titem.deactivateDecompositionMode();\n\t\t});\n\t\tthis.items.clear();\n\t}\n\n\tcreateButton(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-decomposition-structure\">\n\t\t\t\t<button class=\"ui-btn ui-btn-sm ui-btn-primary\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DECOMPOSITION_BUTTON')}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonCreateItem(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tif (!this.input.isTagsSearchMode())\n\t\t\t{\n\t\t\t\tconst inputNode = event.target;\n\t\t\t\tif (inputNode.value)\n\t\t\t\t{\n\t\t\t\t\tconst parentItem = this.getParentItem();\n\t\t\t\t\tif (this.isBacklogDecomposition())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isFirstDecomposition() && !parentItem.isLinkedTask())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('updateParentItem', {\n\t\t\t\t\t\t\t\titemId: parentItem.getItemId(),\n\t\t\t\t\t\t\t\tentityId: parentItem.getEntityId(),\n\t\t\t\t\t\t\t\titemType: parentItem.getItemType(),\n\t\t\t\t\t\t\t\tinfo: parentItem.getInfo()\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.emit('createItem', inputNode.value);\n\t\t\t\t\tinputNode.value = '';\n\t\t\t\t\tinputNode.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisFirstDecomposition(): boolean\n\t{\n\t\treturn (this.items.size === 1);\n\t}\n\n\tgetParentItem(): Item\n\t{\n\t\tconst iterator = this.items.values();\n\t\treturn iterator.next().value;\n\t}\n\n\tsaveSelectedResponsible(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getTarget();\n\t\tthis.setResponsible(item.getResponsible());\n\t}\n\n\tgetResponsible(): Responsible\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tsetResponsible(responsible: Responsible)\n\t{\n\t\tthis.responsible = responsible;\n\t}\n\n\tsetBorderColor(color: string)\n\t{\n\t\tthis.borderColor = (Type.isString(color) ? color : '');\n\t}\n\n\tgetBorderColor(): string\n\t{\n\t\treturn this.borderColor;\n\t}\n}","import {Text, Type} from 'main.core';\n\nexport type ItemTypeParams = {\n\tid?: number|string,\n\tname?: string,\n\tsort?: number,\n\tdodRequired?: 'Y' | 'N'\n}\n\nexport class ItemType\n{\n\tconstructor(params: ItemTypeParams = {})\n\t{\n\t\tthis.setId(params.id);\n\t\tthis.setName(params.name);\n\t\tthis.setSort(params.sort);\n\t\tthis.setDodRequired(params.dodRequired);\n\t}\n\n\tsetId(id: number)\n\t{\n\t\tthis.id = (\n\t\t\tType.isInteger(id)\n\t\t\t\t? parseInt(id, 10)\n\t\t\t\t: (Type.isString(id) && id) ? id : Text.getRandom()\n\t\t);\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetName(name: string)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : '');\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetSort(sort: number)\n\t{\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\t}\n\n\tgetSort(): number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetDodRequired(value: string)\n\t{\n\t\tthis.dodRequired = (value === 'Y');\n\t}\n\n\tisDodRequired(): boolean\n\t{\n\t\treturn this.dodRequired;\n\t}\n}","import {ItemType} from './item.type';\n\ntype Params = {\n\ttypes: Map<number, ItemType>\n}\n\nexport class TypeStorage\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.types = params.types;\n\t}\n\n\tgetNextType(): ItemType\n\t{\n\t\treturn this.types.values().next().value;\n\t}\n\n\tgetTypes(): Map<number, ItemType>\n\t{\n\t\treturn this.types;\n\t}\n\n\taddType(type: ItemType)\n\t{\n\t\tthis.types.set(type.getId(), type);\n\t}\n\n\tremoveType(type: ItemType)\n\t{\n\t\tthis.types.delete(type.getId());\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nimport {ItemType} from './item.type';\nimport {TypeStorage} from './type.storage';\n\ntype Params = {\n\ttypeStorage: TypeStorage\n}\n\nexport class Tabs extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Dod.Tabs');\n\n\t\tthis.typeStorage = params.typeStorage;\n\n\t\tthis.tabNodes = new Map();\n\n\t\tthis.activeType = null;\n\t\tthis.previousType = null;\n\n\t\tthis.setActiveType(this.typeStorage.getNextType());\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst sidebarClass = 'tasks-scrum-dod-settings-container-sidebar'\n\t\t\t+ ' tasks-scrum-dod-settings-container-sidebar-settings';\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"${sidebarClass}\">\n\t\t\t\t${[...this.typeStorage.getTypes().values()].map((type: ItemType) => this.renderTab(type))}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.tabNodes.size === 0;\n\t}\n\n\trenderTab(type: ItemType): HTMLElement\n\t{\n\t\tif (this.isEmptyType(type))\n\t\t{\n\t\t\tconst addNode = Tag.render`\n\t\t\t\t<div class=\"sidebar-tab-link\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-name\">\n\t\t\t\t\t\t+ ${Loc.getMessage('TASKS_SCRUM_CREATE_TYPE')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(addNode, 'click', this.createType.bind(this));\n\n\t\t\treturn addNode;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst tabClass = this.isActiveType(type) ? 'sidebar-tab sidebar-tab-active' : 'sidebar-tab';\n\n\t\t\tconst tabNode = Tag.render`\n\t\t\t\t<div class=\"${tabClass}\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-name\">\n\t\t\t\t\t\t${Text.encode(type.getName())}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-edit\"></div>\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-type-remove\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.tabNodes.set(type.getId(), tabNode);\n\n\t\t\tEvent.bind(tabNode, 'click', (event) => {\n\t\t\t\tconst edit = event.target.classList.contains('tasks-scrum-dod-settings-type-edit');\n\t\t\t\tconst remove = event.target.classList.contains('tasks-scrum-dod-settings-type-remove');\n\t\t\t\tif (!this.isActiveType(type))\n\t\t\t\t{\n\t\t\t\t\tthis.switchType(type, tabNode);\n\t\t\t\t}\n\t\t\t\tif (edit)\n\t\t\t\t{\n\t\t\t\t\tthis.changeTypeName(type, tabNode);\n\t\t\t\t}\n\t\t\t\tif (remove)\n\t\t\t\t{\n\t\t\t\t\tthis.removeType(type, tabNode);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn tabNode;\n\t\t}\n\t}\n\n\taddType(newType: ItemType, tmpType?: ItemType)\n\t{\n\t\tif (tmpType)\n\t\t{\n\t\t\tDom.remove(this.tabNodes.get(tmpType.getId()));\n\t\t\tthis.tabNodes.delete(tmpType.getId());\n\t\t}\n\n\t\tconst node = this.renderTab(newType);\n\n\t\tDom.insertBefore(node, this.node.lastElementChild);\n\n\t\tthis.switchType(newType, node);\n\t}\n\n\tswitchType(type: ItemType, typeNode: HTMLElement, savePrevious: boolean = true)\n\t{\n\t\tthis.tabNodes.forEach((node: HTMLElement) => {\n\t\t\tDom.removeClass(node, 'sidebar-tab-active');\n\t\t});\n\n\t\tDom.addClass(typeNode, 'sidebar-tab-active');\n\n\t\tif (savePrevious && !this.isEmpty())\n\t\t{\n\t\t\tthis.setPreviousType(this.getActiveType());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.setPreviousType(null);\n\t\t}\n\n\t\tthis.setActiveType(type);\n\n\t\tthis.emit('switchType', type);\n\t}\n\n\tcreateType()\n\t{\n\t\tconst type = new ItemType();\n\t\ttype.setSort(this.typeStorage.getTypes().size);\n\n\t\tthis.tabNodes.forEach((node: HTMLElement) => {\n\t\t\tDom.removeClass(node, 'sidebar-tab-active');\n\t\t});\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"sidebar-tab sidebar-tab-active\">\n\t\t\t\t<input type=\"text\" class=\"tasks-scrum-dod-settings-type-name-input\">\n\t\t\t</div>\n\t\t`;\n\t\tconst nameNode = Tag.render`<div class=\"tasks-scrum-dod-settings-type-name\"></div>`;\n\n\t\tDom.insertBefore(node, this.node.lastElementChild);\n\n\t\tconst input = node.querySelector('input');\n\n\t\tEvent.bind(input, 'change', (event) => {\n\t\t\ttype.setName(event.target['value']);\n\t\t\tthis.emit('createType', type);\n\t\t\tnameNode.textContent = Text.encode(type.getName());\n\t\t\tDom.replace(input, nameNode);\n\t\t}, true);\n\n\t\tEvent.bind(input, 'blur', (event) => {\n\t\t\tif (event.target['value'].trim() === '')\n\t\t\t{\n\t\t\t\tDom.remove(node);\n\t\t\t}\n\t\t}, true);\n\n\t\tEvent.bind(input, 'keydown', (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t{\n\t\t\t\tinput.blur();\n\t\t\t}\n\t\t});\n\n\t\tinput.focus();\n\n\t\tthis.tabNodes.set(type.getId(), node);\n\t}\n\n\tchangeTypeName(type: ItemType, typeNode: HTMLElement)\n\t{\n\t\tconst inputNode = Tag.render`\n\t\t\t<input type=\"text\" class=\"tasks-scrum-dod-settings-type-name-input\" value=\"${Text.encode(type.getName())}\">\n\t\t`;\n\t\tconst nameNode = typeNode.querySelector('.tasks-scrum-dod-settings-type-name');\n\n\t\tEvent.bind(inputNode, 'change', (event) => {\n\t\t\ttype.setName(event.target['value'])\n\t\t\tthis.emit('changeTypeName', type);\n\t\t\tinputNode.blur();\n\t\t}, true);\n\n\t\tEvent.bind(inputNode, 'blur', () => {\n\t\t\tnameNode.textContent = Text.encode(type.getName());\n\t\t\tDom.replace(inputNode, nameNode);\n\t\t}, true);\n\n\t\tEvent.bind(inputNode, 'keydown', (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t{\n\t\t\t\tinputNode.blur();\n\t\t\t}\n\t\t});\n\n\t\tDom.replace(nameNode, inputNode);\n\n\t\tinputNode.focus();\n\t\tinputNode.setSelectionRange(type.getName().length, type.getName().length);\n\t}\n\n\tremoveType(type: ItemType, typeNode: HTMLElement)\n\t{\n\t\tMessageBox.confirm(\n\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TYPE'),\n\t\t\t(messageBox) => {\n\t\t\t\tthis.tabNodes.delete(type.getId());\n\t\t\t\tif (this.isActiveType(type))\n\t\t\t\t{\n\t\t\t\t\tthis.setActiveType(null);\n\t\t\t\t}\n\t\t\t\tthis.setPreviousType(null);\n\t\t\t\tDom.remove(typeNode);\n\t\t\t\tthis.emit('removeType', type);\n\t\t\t\tmessageBox.close();\n\t\t\t},\n\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t);\n\t}\n\n\tsetActiveType(type: ItemType|null)\n\t{\n\t\tthis.activeType = type;\n\t}\n\n\tgetActiveType(): ItemType|null\n\t{\n\t\treturn this.activeType;\n\t}\n\n\tsetPreviousType(type: ItemType|null)\n\t{\n\t\tthis.previousType = type;\n\t}\n\n\tgetPreviousType(): ItemType|null\n\t{\n\t\treturn this.previousType;\n\t}\n\n\tisActiveType(type: ItemType): boolean\n\t{\n\t\treturn (\n\t\t\tthis.activeType\n\t\t\t&& this.activeType.getId() === type.getId()\n\t\t);\n\t}\n\n\tsetEmptyType(type: ItemType)\n\t{\n\t\tthis.emptyType = type;\n\t}\n\n\tisEmptyType(type: ItemType): boolean\n\t{\n\t\treturn type.getId() === this.emptyType.getId();\n\t}\n\n\tswitchToType(type: ItemType)\n\t{\n\t\tthis.switchType(type, this.tabNodes.get(type.getId()), false);\n\t}\n}","import {Dom, Tag, Type, Loc, Runtime, Event} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {ItemType} from './item.type';\nimport {TypeStorage} from './type.storage';\nimport {Tabs} from './tabs';\n\nimport {RequestSender} from '../utility/request.sender';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityId: number,\n\ttypes: Map<number, ItemType>\n}\n\nimport '../css/dod.css';\n\nexport class Settings\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityId = params.entityId;\n\t\tthis.types = params.types;\n\n\t\tthis.typeStorage = new TypeStorage({\n\t\t\ttypes: this.types\n\t\t});\n\n\t\tthis.tabs = new Tabs({\n\t\t\ttypeStorage: this.typeStorage\n\t\t});\n\t\tthis.tabs.subscribe('switchType', this.onSwitchType.bind(this));\n\t\tthis.tabs.subscribe('createType', this.onCreateType.bind(this));\n\t\tthis.tabs.subscribe('changeTypeName', this.onChangeTypeName.bind(this));\n\t\tthis.tabs.subscribe('removeType', this.onRemoveType.bind(this));\n\n\t\tthis.addEmptyCreationType();\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('DoD Settings: HTMLElement for dod settings not found');\n\t\t}\n\n\t\tDom.append(this.render(), container);\n\n\t\tif (this.tabs.isEmpty())\n\t\t{\n\t\t\tthis.buildEmptyForm();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buildEditingForm(this.typeStorage.getNextType());\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-dod-settings\">\n\t\t\t\t<div class=\"tasks-scrum-dod-settings-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-wrap\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-shell\">\n\t\t\t\t\t\t\t${this.tabs.render()}\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-dod-settings-container-sidebar-wrapper\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\trenderEditingForm(type: ItemType): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t${this.renderRequiredOption(type)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content ui-form-content-dod-list\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEmptyForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_CREATE_TYPE_PROMPT')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderRequiredOption(type: ItemType): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox\">\n\t\t\t\t\t<input type=\"checkbox\" class=\"ui-ctl-element ui-form-content-required-option\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_OPTIONS_REQUIRED_LABEL')}\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst checkbox = node.querySelector('.ui-form-content-required-option');\n\t\tcheckbox.checked = type.isDodRequired();\n\n\t\tEvent.bind(checkbox, 'click', () => {\n\t\t\tthis.updateActiveType();\n\t\t});\n\n\t\treturn node;\n\t}\n\n\tbuildEditingForm(type: ItemType)\n\t{\n\t\tconst container =this.cleanTypeForm();\n\n\t\tDom.append(this.renderEditingForm(type), container);\n\n\t\tconst listContainer = this.node.querySelector('.ui-form-content-dod-list');\n\n\t\tconst loader = this.showLoader(listContainer);\n\n\t\tthis.requestSender.getDodChecklist({\n\t\t\tentityId: type.getId()\n\t\t})\n\t\t.then((response) => {\n\t\t\tloader.hide();\n\t\t\tRuntime.html(listContainer, response.data.html);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tbuildEmptyForm()\n\t{\n\t\tconst container = this.cleanTypeForm();\n\n\t\tDom.append(this.renderEmptyForm(), container);\n\t}\n\n\tonSwitchType(baseEvent: BaseEvent)\n\t{\n\t\tconst type = baseEvent.getData();\n\t\tconst previousType = this.tabs.getPreviousType();\n\n\t\tif (previousType)\n\t\t{\n\t\t\tthis.saveSettings(previousType)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.buildEditingForm(type);\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buildEditingForm(type);\n\t\t}\n\t}\n\n\tonCreateType(baseEvent: BaseEvent)\n\t{\n\t\tconst container = this.node.querySelector('.tasks-scrum-dod-settings-container-sidebar-wrapper');\n\n\t\tconst loader = this.showLoader(container);\n\n\t\tconst tmpType = baseEvent.getData();\n\n\t\tthis.requestSender.createType({\n\t\t\tentityId: this.entityId,\n\t\t\tname: tmpType.getName(),\n\t\t\tsort: tmpType.getSort()\n\t\t})\n\t\t.then((response) => {\n\t\t\tloader.hide();\n\t\t\tconst createdType = new ItemType(response.data);\n\t\t\tthis.typeStorage.addType(createdType);\n\t\t\tthis.tabs.addType(createdType, tmpType);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeTypeName(baseEvent: BaseEvent)\n\t{\n\t\tconst type = baseEvent.getData();\n\n\t\tthis.requestSender.changeTypeName({\n\t\t\tid: type.getId(),\n\t\t\tname: type.getName()\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonRemoveType(baseEvent: BaseEvent)\n\t{\n\t\tconst type = baseEvent.getData();\n\n\t\tthis.requestSender.removeType({\n\t\t\tid: type.getId()\n\t\t})\n\t\t.then(() => {\n\t\t\tthis.typeStorage.removeType(type);\n\t\t\tif (this.tabs.isEmpty())\n\t\t\t{\n\t\t\t\tthis.buildEmptyForm();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst nextType = [...this.typeStorage.getTypes().values()]\n\t\t\t\t\t.find((type: ItemType) => !this.tabs.isEmptyType(type))\n\t\t\t\t;\n\t\t\t\tthis.tabs.switchToType(nextType);\n\t\t\t}\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tsaveSettings(inputType?: ItemType): Promise\n\t{\n\t\tif (this.tabs.isEmpty())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst type = inputType? inputType : this.tabs.getActiveType();\n\n\t\treturn this.requestSender.saveDodSettings({\n\t\t\tentityId: type.getId(),\n\t\t\trequiredOption: this.getRequiredOptionValue(),\n\t\t\titems: this.getChecklistItems()\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tgetChecklistItems(): Array\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst treeStructure = BX.Tasks.CheckListInstance.getTreeStructure();\n\n\t\treturn treeStructure.getRequestData();\n\t\t/* eslint-enable */\n\t}\n\n\tgetRequiredOptionValue(): string\n\t{\n\t\tconst requiredOption = this.node.querySelector('.ui-form-content-required-option');\n\n\t\treturn (requiredOption.checked === true ? 'Y' : 'N');\n\t}\n\n\tshowLoader(container: HTMLElement): Loader\n\t{\n\t\tconst listPosition = Dom.getPosition(container);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: container,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n\n\tupdateActiveType()\n\t{\n\t\tconst type = this.tabs.getActiveType();\n\n\t\ttype.setDodRequired(this.getRequiredOptionValue());\n\t}\n\n\tcleanTypeForm(): HTMLElement\n\t{\n\t\tconst container = this.node.querySelector('.tasks-scrum-dod-settings-container-sidebar-wrapper');\n\n\t\tDom.clean(container);\n\n\t\treturn container;\n\t}\n\n\taddEmptyCreationType()\n\t{\n\t\tconst itemType = new ItemType();\n\n\t\tthis.tabs.setEmptyType(itemType);\n\n\t\tthis.typeStorage.addType(itemType);\n\t}\n}","import {Event, Loc, Runtime, Tag, Type, Dom} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {Settings} from './settings';\nimport {Entity} from '../entity/entity';\nimport {ItemType, ItemTypeParams} from './item.type';\n\nimport {RequestSender} from '../utility/request.sender';\n\ntype Params = {\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender\n};\n\nimport '../css/dod.css';\n\nexport class DodSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t}\n\n\tshowSettingsPanel(entity: Entity)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-dod-side-panel';\n\n\t\tthis.entity = entity;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadSettingsPanel.bind(this));\n\t\tthis.sidePanel.subscribeOnce('onCloseSidePanel', this.onCloseSettingsPanel.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildSettingsPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildSettingsPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-dod-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum-dod-side-panel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-dod-side-panel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-dod-side-panel-container\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadSettingsPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tconst container = sidePanel.getContainer().querySelector('.tasks-scrum-dod-side-panel-container');\n\n\t\tconst dodSettingsRequest = {\n\t\t\tentityId: this.entity.getId()\n\t\t};\n\n\t\tthis.requestSender.getDodSettings(dodSettingsRequest)\n\t\t\t.then((response) => {\n\n\t\t\t\tsidePanel.closeLoader();\n\n\t\t\t\tconst types = Type.isArray(response.data.types) ? response.data.types : [];\n\n\t\t\t\tconst itemTypes = new Map();\n\n\t\t\t\ttypes.forEach((typeData: ItemTypeParams) => {\n\t\t\t\t\tconst itemType = new ItemType(typeData);\n\t\t\t\t\titemTypes.set(itemType.getId(), itemType);\n\t\t\t\t});\n\n\t\t\t\tthis.settings = new Settings({\n\t\t\t\t\trequestSender: this.requestSender,\n\t\t\t\t\tentityId: this.entity.getId(),\n\t\t\t\t\ttypes: itemTypes\n\t\t\t\t});\n\n\t\t\t\tthis.settings.renderTo(container);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\t}\n\n\tonCloseSettingsPanel(baseEvent: BaseEvent)\n\t{\n\t\tif (this.settings)\n\t\t{\n\t\t\tthis.settings.saveSettings()\n\t\t\t\t.then(() => {})\n\t\t\t\t.catch(() => {})\n\t\t\t;\n\t\t}\n\t}\n}","import {Loc} from 'main.core';\n\ntype Data = {\n\tsprintName: string,\n\tplan: number,\n\tdone: number\n}\n\n//todo import amchart4 like es6\nexport class Chart\n{\n\tconstructor(data: Data)\n\t{\n\t\tthis.data = data;\n\n\t\tthis.chart = null;\n\t}\n\n\tcreateChart(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\n\t\tthis.chart.scrollbarX = new am4core.Scrollbar();\n\t\tthis.chart.scrollbarX.parent = this.chart.bottomAxesContainer;\n\n\t\tthis.createAxises();\n\n\t\tthis.createColumn('plan', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_PLAN_COLUMN'), '#2882b3');\n\t\tthis.createColumn('done', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_DONE_COLUMN'), '#9c1f1f');\n\n\t\tthis.createLegend();\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst xAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\txAxis.dataFields.category = 'sprintName';\n\t\txAxis.renderer.grid.template.location = 0;\n\n\t\tconst label = xAxis.renderer.labels.template;\n\t\tlabel.wrap = true;\n\t\tlabel.maxWidth = 120;\n\n\t\tconst yAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tyAxis.min = 0;\n\t}\n\n\tcreateColumn(valueY: string, name: string, color: string)\n\t{\n\t\tconst series = this.chart.series.push(new am4charts.ColumnSeries());\n\t\tseries.dataFields.valueY = valueY;\n\t\tseries.dataFields.categoryX = 'sprintName';\n\t\tseries.name = name;\n\t\tseries.stroke = am4core.color(color);\n\t\tseries.fill = am4core.color(color);\n\n\t\t// const bullet = series.bullets.push(new am4charts.LabelBullet())\n\t\t// bullet.dy = 10;\n\t\t// bullet.label.text = '{valueY}';\n\t\t// bullet.label.fill = am4core.color('#ffffff');\n\n\t\treturn series;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.paddingBottom = 20;\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t}\n\n\tdestroyChart()\n\t{\n\t\tthis.chart.dispose();\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {SidePanel} from '../service/side.panel';\nimport {RequestSender} from '../utility/request.sender';\nimport {Chart} from './chart';\n\ntype Params = {\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender\n};\n\nexport class TeamSpeedSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t}\n\n\tshowTeamSpeedChart()\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-team-speed-chart';\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadTeamSpeedChartPanel.bind(this));\n\n\t\tthis.sidePanel.subscribe('onCloseSidePanel', this.onCloseTeamSpeedChart.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildTeamSpeedPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildTeamSpeedPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-project-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-project-side-panel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-chart\"></div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadTeamSpeedChartPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-project-side-panel');\n\n\t\tthis.getTeamSpeedChartData().then((data) => {\n\n\t\t\tsidePanel.closeLoader();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.teamSpeedChart = new Chart(data);\n\t\t\t\tthis.teamSpeedChart.createChart(this.form.querySelector('.tasks-scrum-project-side-panel-chart'));\n\t\t\t}, 300);\n\n\t\t});\n\t}\n\n\tonCloseTeamSpeedChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tif (this.sidePanelId === sidePanel.getUrl())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.teamSpeedChart)\n\t\t\t\t{\n\t\t\t\t\tthis.teamSpeedChart.destroyChart();\n\t\t\t\t\tthis.teamSpeedChart = null;\n\t\t\t\t}\n\t\t\t}, 300);\n\t\t}\n\t}\n\n\tgetTeamSpeedChartData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getTeamSpeedChartData().then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t});\n\t\t});\n\t}\n}","import {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage\n}\n\nexport class EntityCounters\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t}\n\n\tupdateCounters(entities: Map<number, Backlog|Sprint>)\n\t{\n\t\tconst requestData = {\n\t\t\tentityIds: [...entities.keys()]\n\t\t};\n\n\t\tthis.requestSender.getEntityCounters(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tObject.keys(response.data).forEach((entityId: number) => {\n\t\t\t\t\tentityId = parseInt(entityId, 10);\n\t\t\t\t\tconst entity = entities.get(entityId);\n\t\t\t\t\tconst counters = response.data[entityId];\n\t\t\t\t\tentity.setStoryPoints(counters.storyPoints);\n\t\t\t\t\tentity.setNumberTasks(counters.numberTasks);\n\t\t\t\t\tif (entity.isActive())\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.setCompletedStoryPoints(counters.completedStoryPoints);\n\t\t\t\t\t\tentity.setUncompletedStoryPoints(counters.uncompletedStoryPoints);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n}","import {Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Filter} from '../service/filter';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\nimport {SubTasksManager} from './subtasks.manager';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\ntype Params = {\n\tfilter: Filter,\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tsubTasksCreator: SubTasksManager\n}\n\nexport class FilterHandler extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.filter = params.filter;\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\n\t\tthis.filter.subscribe('applyFilter', this.onApplyFilter.bind(this));\n\t}\n\n\tonApplyFilter(baseEvent: BaseEvent)\n\t{\n\t\tthis.fadeOutAll();\n\n\t\tconst filterInfo = baseEvent.getData();\n\n\t\tthis.updateExactSearchStatusToEntities();\n\n\t\tthis.requestSender.applyFilter().then((response) => {\n\t\t\tfilterInfo.promise.fulfill();\n\n\t\t\tconst filteredItemsData = response.data;\n\n\t\t\tthis.entityStorage.getAllItems().forEach((item: Item) => {\n\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\tif (item.isParentTask())\n\t\t\t\t{\n\t\t\t\t\tthis.subTasksCreator.cleanVisibility(item);\n\t\t\t\t\tthis.subTasksCreator.cleanSubTasks(item);\n\t\t\t\t}\n\t\t\t\tentity.removeItem(item);\n\t\t\t\titem.removeYourself();\n\t\t\t});\n\n\t\t\tfilteredItemsData.forEach((itemData) => {\n\t\t\t\tconst item = Item.buildItem(itemData);\n\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\tDom.append(item.render(), entity.getListItemsNode());\n\t\t\t\tentity.setItem(item);\n\t\t\t\titem.onAfterAppend(entity.getListItemsNode());\n\t\t\t\tif (item.isParentTask())\n\t\t\t\t{\n\t\t\t\t\titem.downSubTasksTick();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.updateVisibilityToEntities();\n\n\t\t\tthis.fadeInAll();\n\t\t}).catch((response) => {\n\t\t\tfilterInfo.promise.reject();\n\n\t\t\tthis.fadeInAll();\n\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tupdateExactSearchStatusToEntities()\n\t{\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.setExactSearchApplied(this.filter.isSearchFieldApplied());\n\t\t});\n\t}\n\n\tupdateVisibilityToEntities()\n\t{\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.updateVisibility();\n\t\t});\n\t}\n\n\tfadeOutAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeOut();\n\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.fadeOut();\n\t\t});\n\t}\n\n\tfadeInAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeIn();\n\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.fadeIn();\n\t\t});\n\t}\n}","import {Event, Runtime, Tag, Text, Loc, Type, Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Label} from 'ui.label';\n\nimport {Filter} from '../service/filter';\nimport {SidePanel} from '../service/side.panel';\n\nimport {Entity} from '../entity/entity';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\nimport {TagSearcher} from './tag.searcher';\n\nimport type {EpicType} from '../item/item';\n\nimport '../css/epic.css';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tsidePanel: SidePanel,\n\tentity: Entity,\n\tfilter: Filter,\n\ttagSearcher: TagSearcher,\n}\n\nexport class Epic extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Epic');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.entity = params.entity;\n\t\tthis.filter = params.filter;\n\t\tthis.tagSearcher = params.tagSearcher;\n\n\t\tthis.form = null;\n\n\t\tthis.defaultColor = '#69dafc';\n\t\tthis.selectedColor = '';\n\n\t\tthis.currentEpic = null;\n\t}\n\n\tgetCurrentEpic(): ?Object\n\t{\n\t\treturn this.currentEpic;\n\t}\n\n\topenAddForm()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadAddForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildAddForm());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenEditForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadEditForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\t\tresolve(this.buildEditForm());\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenViewForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadViewForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\t\tresolve(this.buildViewForm());\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenEpicsList()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequest.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\tthis.sidePanel.unsubscribeAll('onLoadSidePanel');\n\t\t\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadListGrid.bind(this));\n\t\t\t\tthis.sidePanel.subscribeOnce('onCloseSidePanel', this.destroyGrid.bind(this));\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(Tag.render`\n\t\t\t\t\t<div class=\"tasks-scrum-epics-list\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-add-button\">\n\t\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-sm\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epics-list-grid\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tonLoadAddForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.currentEpic = null;\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadAddButtons().then((buttonsContainer) => {\n\t\t\tsidePanel.closeLoader();\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.createEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.onAfterCreateEpic(response.data);\n\t\t\t\t\tif (this.sidePanel.isPreviousSidePanelExist(sidePanel))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sidePanel.reloadPreviousSidePanel(sidePanel);\n\t\t\t\t\t\tsidePanel.close();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\t\tthis.openEpicsList();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\t\tresponse,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_CREATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t\tsidePanel.close();\n\t\t\t\t});\n\t\t\t});\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tonLoadViewForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadDescription();\n\t\tthis.onLoadFiles();\n\t\tthis.onLoadViewButtons().then((buttonsContainer) => {\n\t\t\tsidePanel.closeLoader();\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\tthis.openEditForm(this.currentEpic.id);\n\t\t\t\t});\n\t\t\t});\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\tonLoadEditForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadEditButtons().then((buttonsContainer) => {\n\t\t\tsidePanel.closeLoader();\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.editEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.emit('onAfterEditEpic', response);\n\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\tthis.reloadGrid();\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.removeClockIconFromButton();\n\t\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\t\tresponse,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_UPDATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=cancel]'), 'click', () => sidePanel.close());\n\t\t});\n\t}\n\n\treloadGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\tconst gridManager = BX.Main.gridManager.getById(this.gridId);\n\t\t\tif (gridManager)\n\t\t\t{\n\t\t\t\tgridManager.instance.reload();\n\t\t\t}\n\t\t}\n\t\t/* eslint-enable */\n\t}\n\n\tdestroyGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\tconst gridManager = BX.Main.gridManager.getById(this.gridId);\n\t\t\tif (gridManager)\n\t\t\t{\n\t\t\t\tgridManager.instance.destroy();\n\t\t\t}\n\t\t}\n\t\t/* eslint-enable */\n\t}\n\n\tonLoadEditor()\n\t{\n\t\tthis.getDescriptionEditor().then((editorHtml) => {\n\t\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\t\tRuntime.html(descriptionContainer, editorHtml).then(() => {\n\t\t\t\tthis.editor = window.LHEPostForm.getHandler(this.id);\n\t\t\t\twindow.BXHtmlEditor.Get(this.id);\n\t\t\t\tEventEmitter.emit(this.editor.eventNode, 'OnShowLHE', [true]);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.form.querySelector('.tasks-scrum-epic-form-header-title-control').focus();\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadDescription()\n\t{\n\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\tthis.requestSender.getEpicDescription({\n\t\t\tepicId: this.currentEpic.id,\n\t\t\ttext: this.currentEpic.description\n\t\t}).then(response => {\n\t\t\tRuntime.html(descriptionContainer, response.data);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonLoadFiles()\n\t{\n\t\tconst filesContainer = this.form.querySelector('.tasks-scrum-epic-form-files');\n\t\tthis.requestSender.getEpicFiles({\n\t\t\tepicId: this.currentEpic.id\n\t\t}).then(response => {\n\t\t\tRuntime.html(filesContainer, response.data.html);\n\t\t});\n\t}\n\n\tonLoadColorPicker()\n\t{\n\t\tthis.selectedColor = (this.currentEpic ? this.currentEpic.info.color : this.defaultColor);\n\t\tconst colorBlockNode = this.form.querySelector('.tasks-scrum-epic-header-color');\n\t\tEvent.bind(colorBlockNode, 'click', () => {\n\t\t\tconst colorNode = colorBlockNode.querySelector('.tasks-scrum-epic-header-color-current');\n\t\t\tconst picker = this.getColorPicker(colorNode);\n\t\t\tpicker.open();\n\t\t});\n\t}\n\n\tonLoadAddButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadViewButtons(): Promise\n\t{\n\t\treturn this.getViewEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadEditButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadListGrid(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tconst form = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list');\n\t\tconst list = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list-grid');\n\n\t\tsidePanel.showLoader();\n\n\t\tthis.getEpicsList().then((responseData) => {\n\t\t\tsidePanel.closeLoader();\n\t\t\tif (responseData.html)\n\t\t\t{\n\t\t\t\tRuntime.html(list, responseData.html);\n\n\t\t\t\tthis.prepareTagsList(list);\n\n\t\t\t\tconst buttonNode = form.querySelector('.tasks-scrum-epic-header-add-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.remove(form.querySelector('.tasks-scrum-epic-header-add-button'));\n\t\t\t\tDom.append(this.getEmptyEpicListForm(), list);\n\t\t\t\tconst buttonNode = list.querySelector('.tasks-scrum-epics-empty-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [, eventArgs] = event.getCompatData();\n\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\teventArgs.method = 'POST';\n\n\t\tif (!eventArgs.url)\n\t\t{\n\t\t\teventArgs.url = this.requestSender.getEpicListUrl();\n\t\t}\n\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t\tentityId: this.entity.getId(),\n\t\t\tgridId: this.gridId,\n\t\t\tsignedParameters: this.requestSender.getSignedParameters()\n\t\t};\n\t}\n\n\tgetEpicsList() : Promise\n\t{\n\t\tthis.gridId = 'EntityEpicsGrid_' + this.entity.getId();\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicsList({\n\t\t\t\tentityId: this.entity.getId(),\n\t\t\t\tgridId: this.gridId\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetEpic(id: Number): Promise\n\t{\n\t\treturn this.requestSender.getEpic({id: id});\n\t}\n\n\tbuildAddForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader('', '#69dafc')}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildViewForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_VIEW_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t\t\t${Text.encode(this.currentEpic.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\t\t\"background-color: ${Text.encode(this.currentEpic.info.color)};\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\" style=\"padding: 15px 10px 15px 10px;\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-files\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildEditForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_EDIT_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader(this.currentEpic.name, this.currentEpic.info.color)}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEmptyEpicListForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epics-empty\">\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-first-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_FIRST_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-image\">\n\t\t\t\t\t<svg width=\"124px\" height=\"123px\" viewBox=\"0 0 124 123\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t\t<g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" opacity=\"0.28\">\n\t\t\t\t\t\t\t<path d=\"M83,105 L83,81.4375 L105,81.4375 L105,18 L17,18 L17,81.4375 L39,81.4375 L39,105 L83,105 Z M10.9411765,0 L113.058824,0 C119.101468,0 124,4.85902727 124,10.8529412 L124,112.147059 C124,118.140973 119.101468,123 113.058824,123 L10.9411765,123 C4.89853156,123 0,118.140973 0,112.147059 L0,10.8529412 C0,4.85902727 4.89853156,0 10.9411765,0 Z M44.0142862,47.0500004 L54.2142857,57.4416671 L79.7142857,32 L87,42.75 L54.2142857,75 L36,57.0833333 L44.0142862,47.0500004 Z\" fill=\"#A8ADB4\" />\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-second-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_SECOND_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-button\">\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-lg\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormHeader(title: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t${title}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormContainerHeader(name: String, color: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t<input type=\"text\" name=\"name\" value=\"${Text.encode(name)}\" class=\n\t\t\t\t\t\t\"tasks-scrum-epic-form-header-title-control\" placeholder=\n\t\t\t\t\t\t\"${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_NAME_PLACEHOLDER')}\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\"background-color: ${Text.encode(color)};\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetDescriptionEditor(): Promise\n\t{\n\t\tconst requestData = {\n\t\t\teditorId: this.id\n\t\t};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t\trequestData.text = this.currentEpic.description;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicDescriptionEditor(requestData).then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetAddEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getAddEpicFormButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetViewEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getViewEpicFormButtonsAction().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetColorPicker(colorNode)\n\t{\n\t\t/* eslint-disable */\n\t\treturn new BX.ColorPicker({\n\t\t\tbindElement: colorNode,\n\t\t\tdefaultColor: this.selectedColor,\n\t\t\tonColorSelected: (color, picker) => {\n\t\t\t\tthis.selectedColor = color;\n\t\t\t\tcolorNode.style.backgroundColor = color;\n\t\t\t},\n\t\t\tpopupOptions: {\n\t\t\t\tzIndex: 1100,\n\t\t\t\tclassName: 'tasks-scrum-epic-color-popup'\n\n\t\t\t},\n\t\t\tcolors: [\n\t\t\t\t[\"#aae9fc\", \"#bbecf1\", \"#98e1dc\", \"#e3f299\", \"#ffee95\", \"#ffdd93\", \"#dfd3b6\", \"#e3c6bb\"],\n\t\t\t\t[\"#ffad97\", \"#ffbdbb\", \"#ffcbd8\", \"#ffc4e4\", \"#c4baed\", \"#dbdde0\", \"#bfc5cd\", \"#a2a8b0\"]\n\t\t\t]\n\t\t});\n\t\t/* eslint-enable */\n\t}\n\n\tgetRequestData()\n\t{\n\t\tconst requestData = {};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t}\n\n\t\trequestData.entityId = this.entity.getId();\n\t\trequestData.name = (this.form.querySelector('[name=name]').value).trim();\n\t\trequestData.description = this.editor.oEditor.GetContent();\n\t\trequestData.color = this.selectedColor;\n\t\trequestData.files = this.getAttachmentsFiles();\n\n\t\treturn requestData;\n\t}\n\n\tgetAttachmentsFiles(): Array\n\t{\n\t\tconst files = [];\n\n\t\tif (!this.editor || !Type.isPlainObject(this.editor.arFiles) || !Type.isPlainObject(this.editor.controllers))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\tconst fileControllers = [];\n\t\tObject.values(this.editor.arFiles).forEach((controller) => {\n\t\t\tif(!fileControllers.includes(controller))\n\t\t\t{\n\t\t\t\tfileControllers.push(controller);\n\t\t\t}\n\t\t});\n\n\t\tfileControllers.forEach((fileController) => {\n\t\t\tif (\n\t\t\t\tthis.editor.controllers[fileController] &&\n\t\t\t\tType.isPlainObject(this.editor.controllers[fileController].values)\n\t\t\t)\n\t\t\t{\n\t\t\t\tObject.keys(this.editor.controllers[fileController].values).forEach((fileId) => {\n\t\t\t\t\tif (!files.includes(fileId))\n\t\t\t\t\t{\n\t\t\t\t\t\tfiles.push(fileId);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\n\t\treturn files;\n\t}\n\n\tprepareTagsList(container: HTMLElement)\n\t{\n\t\tconst tagsContainers = container.querySelectorAll('.tasks-scrum-epic-grid-tags');\n\t\ttagsContainers.forEach((tagsContainer) => {\n\t\t\tconst tags = this.getTagsFromNode(tagsContainer);\n\t\t\tDom.clean(tagsContainer);\n\t\t\ttags.forEach((tag) => {\n\t\t\t\tDom.append(this.getTagNode(tag), tagsContainer);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTagsFromNode(node: HTMLElement): Array\n\t{\n\t\tconst tags = [];\n\t\tnode.childNodes.forEach((childNode) => {\n\t\t\ttags.push(childNode.textContent.trim());\n\t\t});\n\t\treturn tags;\n\t}\n\n\tgetTagNode(tag: string): HTMLElement\n\t{\n\t\tconst tagLabel = new Label({\n\t\t\ttext: tag,\n\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\tfill: true,\n\t\t\tsize: Label.Size.SM,\n\t\t\tcustomClass: ''\n\t\t});\n\t\tconst container = tagLabel.getContainer();\n\t\tEvent.bind(container, 'click', () => {\n\t\t\tthis.emit('filterByTag', tag);\n\t\t\tthis.sidePanel.closeTopSidePanel(true);\n\t\t});\n\t\treturn container;\n\t}\n\n\tremoveClockIconFromButton()\n\t{\n\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\tif (buttonsContainer)\n\t\t{\n\t\t\tDom.removeClass(buttonsContainer.querySelector('[name=save]'), 'ui-btn-wait');\n\t\t}\n\t}\n\n\tonAfterCreateEpic(epic: EpicType)\n\t{\n\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\tthis.filter.addItemToListTypeField('EPIC', {\n\t\t\tNAME: epic.name.trim(),\n\t\t\tVALUE: String(epic.id)\n\t\t});\n\t}\n\n\tonAfterUpdateEpic(epic: EpicType)\n\t{\n\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\tconst itemEpic = item.getEpic();\n\t\t\tif (itemEpic && itemEpic.id === epic.id)\n\t\t\t{\n\t\t\t\titem.setEpicAndTags(epic);\n\t\t\t}\n\t\t});\n\n\t\tconst oldEpicInfo = this.getCurrentEpic();\n\t\tif (oldEpicInfo)\n\t\t{\n\t\t\tthis.tagSearcher.removeEpicFromSearcher(oldEpicInfo);\n\t\t}\n\n\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t}\n\n\tonAfterRemoveEpic(epic: EpicType)\n\t{\n\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\tconst itemEpic = item.getEpic();\n\t\t\tif (itemEpic && itemEpic.id === epic.id)\n\t\t\t{\n\t\t\t\titem.setEpicAndTags(null);\n\t\t\t}\n\t\t});\n\t\tthis.tagSearcher.removeEpicFromSearcher(epic);\n\t\tthis.sidePanel.reloadTopSidePanel(true);\n\t}\n}","import {Sprint} from '../entity/sprint/sprint';\n\nimport {RequestSender} from '../utility/request.sender';\nimport {DomBuilder} from '../utility/dom.builder';\nimport {EntityStorage} from '../utility/entity.storage';\n\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tgroupId: number\n}\n\ntype RemoveParams = {\n\tsprintId: number\n}\n\nexport class PullSprint\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tsprintAdded: this.onSprintAdded.bind(this),\n\t\t\tsprintUpdated: this.onSprintUpdated.bind(this),\n\t\t\tsprintRemoved: this.onSprintRemoved.bind(this)\n\t\t};\n\t}\n\n\tonSprintAdded(params: SprintParams)\n\t{\n\t\tif (this.groupId !== params.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = Sprint.buildSprint(params);\n\n\t\tif (this.needSkipAdd(sprint))\n\t\t{\n\t\t\tthis.cleanSkipAdd(sprint);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.domBuilder.createSprintNode(sprint);\n\t}\n\n\tonSprintUpdated(params: SprintParams)\n\t{\n\t\tconst tmpSprint = Sprint.buildSprint(params);\n\n\t\tif (this.needSkipUpdate(tmpSprint))\n\t\t{\n\t\t\tthis.cleanSkipUpdate(tmpSprint);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = this.entityStorage.findEntityByEntityId(tmpSprint.getId());\n\t\tif (sprint)\n\t\t{\n\t\t\tif (tmpSprint.getStatus() !== sprint.getStatus())\n\t\t\t{\n\t\t\t\tif (tmpSprint.getStatus() === 'active')\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.moveSprintToActiveListNode(sprint);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.moveSprintToCompletedListNode(sprint);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsprint.updateYourself(tmpSprint);\n\t\t}\n\t}\n\n\tonSprintRemoved(params: RemoveParams)\n\t{\n\t\tif (this.needSkipRemove(params.sprintId))\n\t\t{\n\t\t\tthis.cleanSkipRemove(params.sprintId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = this.entityStorage.findEntityByEntityId(params.sprintId);\n\t\tif (sprint)\n\t\t{\n\t\t\tsprint.removeSprint();\n\t\t\tthis.entityStorage.removeSprint(sprint.getId());\n\t\t}\n\t}\n\n\taddTmpIdToSkipAdding(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.add(tmpId);\n\t}\n\n\taddIdToSkipUpdating(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipUpdating.add(sprintId);\n\t}\n\n\taddIdToSkipRemoving(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.add(sprintId);\n\t}\n\n\tneedSkipAdd(sprint: Sprint): boolean\n\t{\n\t\treturn this.listIdsToSkipAdding.has(sprint.getTmpId());\n\t}\n\n\tcleanSkipAdd(sprint: Sprint)\n\t{\n\t\tthis.listIdsToSkipAdding.delete(sprint.getTmpId());\n\t}\n\n\tneedSkipUpdate(sprint: Sprint): boolean\n\t{\n\t\treturn this.listIdsToSkipUpdating.has(sprint.getId());\n\t}\n\n\tcleanSkipUpdate(sprint: Sprint)\n\t{\n\t\tthis.listIdsToSkipUpdating.delete(sprint.getId());\n\t}\n\n\tneedSkipRemove(sprintId: number): boolean\n\t{\n\t\treturn this.listIdsToSkipRemoving.has(sprintId);\n\t}\n\n\tcleanSkipRemove(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.delete(sprintId);\n\t}\n}","import {Loc, Type, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Menu} from 'main.popup';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nimport {Entity} from '../entity/entity';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\nimport {EntityCounters} from './entity.counters';\nimport {SubTasksManager} from './subtasks.manager';\n\nexport type ItemsSortInfo = {\n\t[id: number]: {\n\t\tsort: number,\n\t\tentityId?: number,\n\t\tupdatedItemId?: number\n\t}\n}\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tentityCounters: EntityCounters,\n\tsubTasksCreator: SubTasksManager\n}\n\nexport class ItemMover extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ItemMover');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.entityCounters = params.entityCounters;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\n\t\tthis.bindHandlers();\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.domBuilder.subscribe('itemMoveStart', (baseEvent: BaseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\t\tthis.hideSubTasks(sourceEntity, item);\n\t\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\t\tif (actionsPanel)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t}\n\t\t});\n\t\tthis.domBuilder.subscribe('itemMoveEnd', (baseEvent: BaseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tconst endContainer = dragEndEvent.endContainer;\n\t\t\tif (!endContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\n\t\t\tif (sourceEntityId === endEntityId)\n\t\t\t{\n\t\t\t\tthis.onItemMove(dragEndEvent);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(sourceEntity, message).then(() => {\n\t\t\t\t\tthis.onItemMove(dragEndEvent);\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\tconst itemNodeAfterSourceItem = sourceEntity.getListItemsNode().children[item.getSort()];\n\t\t\t\t\tthis.domBuilder.insertBefore(itemNode, itemNodeAfterSourceItem);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tmoveItem(item: Item, button)\n\t{\n\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\n\t\tconst listToMove = [];\n\n\t\tif (!entity.isFirstItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_UP'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\t\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst sortedItemsIds = new Set();\n\t\t\t\t\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\t\t\t\t\tthis.hideSubTasks(entity, groupModeItem);\n\t\t\t\t\t\t\tthis.moveItemToUp(groupModeItem, entity.getListItemsNode(), entity.hasInput(), false);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode(), sortedItemsIds)\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideSubTasks(entity, item);\n\t\t\t\t\t\tthis.moveItemToUp(item, entity.getListItemsNode(), entity.hasInput());\n\t\t\t\t\t}\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (!entity.isLastItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_DOWN'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\t\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst sortedItemsIds = new Set();\n\t\t\t\t\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\t\t\t\t\tthis.hideSubTasks(entity, groupModeItem);\n\t\t\t\t\t\t\tthis.moveItemToDown(groupModeItem, entity.getListItemsNode(), false);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode(), sortedItemsIds)\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideSubTasks(entity, item);\n\t\t\t\t\t\tthis.moveItemToDown(item, entity.getListItemsNode());\n\t\t\t\t\t}\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.showMoveItemMenu(item, button, listToMove);\n\t}\n\n\tmoveItemToUp(item: Item, listItemsNode, entityWithInput = true, updateSort = true)\n\t{\n\t\tif (entityWithInput)\n\t\t{\n\t\t\tthis.domBuilder.appendItemAfterItem(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.domBuilder.insertBefore(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tmoveItemToDown(item, listItemsNode, updateSort = true)\n\t{\n\t\tthis.domBuilder.append(item.getItemNode(), listItemsNode);\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tupdateItemsSort(item: Item, listItemsNode: HTMLElement)\n\t{\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(listItemsNode, new Set([item.getItemId()]))\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonItemMove(dragEndEvent)\n\t{\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\tconst endContainer = dragEndEvent.endContainer;\n\n\t\tif (endContainer === this.domBuilder.getSprintCreatingDropZoneNode())\n\t\t{\n\t\t\tconst createNewSprintAndMoveItem = () => {\n\t\t\t\tthis.domBuilder.createSprint().then((sprint) => {\n\t\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\tthis.moveTo(this.entityStorage.getBacklog(), sprint, item);\n\t\t\t\t});\n\t\t\t};\n\t\t\tcreateNewSprintAndMoveItem();\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\n\t\tif (sourceEntityId === endEntityId)\n\t\t{\n\t\t\tconst moveInCurrentContainer = () => {\n\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\tconst itemId = parseInt(itemNode.dataset.itemId, 10);\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tsortInfo: this.calculateSort(sourceContainer, new Set([itemId]))\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInCurrentContainer();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst moveInAnotherContainer = () => {\n\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\t\t\tconst endEntity = this.entityStorage.findEntityByEntityId(endEntityId);\n\t\t\t\tthis.moveItemFromEntityToEntity(item, sourceEntity, endEntity);\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tentityId: endEntity.getId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\titemType: item.getItemType(),\n\t\t\t\t\tsourceEntityId: sourceEntity.getId(),\n\t\t\t\t\tfromActiveSprint: ((sourceEntity.getEntityType() === 'sprint' && sourceEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\ttoActiveSprint: ((endEntity.getEntityType() === 'sprint' && endEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\tsortInfo: this.calculateSort(endContainer, new Set([item.getItemId()]), true)\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.updateEntityCounters(sourceEntity, endEntity);\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInAnotherContainer();\n\t\t}\n\t}\n\n\tupdateEntityCounters(sourceEntity: Entity, endEntity?: Entity)\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(sourceEntity.getId(), sourceEntity);\n\t\tif (endEntity)\n\t\t{\n\t\t\tentities.set(endEntity.getId(), endEntity);\n\t\t}\n\n\t\tthis.entityCounters.updateCounters(entities);\n\t}\n\n\tcalculateSort(container, updatedItemsIds?: Set, moveToAnotherEntity = false): ItemsSortInfo\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst items = [...container.querySelectorAll('[data-sort]')];\n\t\tlet sort = 1;\n\t\titems.forEach((itemNode) => {\n\t\t\tconst itemId = parseInt(itemNode.dataset.itemId, 10);\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tif (item && !item.isSubTask())\n\t\t\t{\n\t\t\t\tconst tmpId = Text.getRandom();\n\t\t\t\tlet isSortUpdated = (sort !== item.getSort());\n\t\t\t\titem.setSort(sort);\n\t\t\t\tlistSortInfo[itemId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tif (moveToAnotherEntity)\n\t\t\t\t{\n\t\t\t\t\tlistSortInfo[itemId].entityId = container.dataset.entityId;\n\t\t\t\t\tisSortUpdated = true;\n\t\t\t\t}\n\t\t\t\tif (isSortUpdated && updatedItemsIds && updatedItemsIds.has(itemId))\n\t\t\t\t{\n\t\t\t\t\tlistSortInfo[itemId].tmpId = tmpId;\n\t\t\t\t\tlistSortInfo[itemId].updatedItemId = itemId;\n\t\t\t\t}\n\t\t\t\titemNode.dataset.sort = sort;\n\t\t\t}\n\t\t\tsort++;\n\t\t});\n\n\t\tthis.emit('calculateSort', listSortInfo);\n\n\t\treturn listSortInfo;\n\t}\n\n\tmoveToAnotherEntity(entityFrom: Entity, item: Item, targetEntity: ?Entity, bindButton?: HTMLElement)\n\t{\n\t\tconst isMoveToSprint = (Type.isNull(targetEntity));\n\n\t\tconst sprints = (isMoveToSprint ? this.entityStorage.getSprintsAvailableForFilling(entityFrom) : null);\n\n\t\tif (entityFrom.isGroupMode())\n\t\t{\n\t\t\tif (isMoveToSprint)\n\t\t\t{\n\t\t\t\tif (sprints.size > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.showListSprintsToMove(entityFrom, item, bindButton);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (sprints.size === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.domBuilder.createSprint().then((sprint: Sprint) => {\n\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(entityFrom, message)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, targetEntity, item, false, false);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {})\n\t\t\t\t;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (isMoveToSprint)\n\t\t\t{\n\t\t\t\tif (sprints.size > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.showListSprintsToMove(entityFrom, item, bindButton);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\t\tthis.onMoveConfirm(entityFrom, message)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tif (sprints.size === 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.domBuilder.createSprint().then((sprint: Sprint) => {\n\t\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => {})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(entityFrom, message)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.moveTo(entityFrom, targetEntity, item, false);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {})\n\t\t\t\t;\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveToWithGroupMode(entityFrom: Entity, entityTo: Entity, item: Item, after = true, update = true)\n\t{\n\t\tconst groupModeItems = entityFrom.getGroupModeItems();\n\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\tif (after)\n\t\t\t{\n\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t}\n\t\t});\n\t\tconst sortedItemsIds = new Set();\n\t\tconst items = [];\n\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\tthis.moveTo(entityFrom, entityTo, groupModeItem, after, update);\n\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\titems.push({\n\t\t\t\titemId: groupModeItem.getItemId(),\n\t\t\t\titemType: groupModeItem.getItemType(),\n\t\t\t\tentityId: entityTo.getId(),\n\t\t\t\tsourceEntityId: entityFrom.getId(),\n\t\t\t\tfromActiveSprint: ((entityFrom.getEntityType() === 'sprint' && entityFrom.isActive()) ? 'Y' : 'N'),\n\t\t\t\ttoActiveSprint: ((entityTo.getEntityType() === 'sprint' && entityTo.isActive()) ? 'Y' : 'N')\n\t\t\t});\n\t\t});\n\t\tthis.requestSender.batchUpdateItem({\n\t\t\titems: items,\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), sortedItemsIds, true),\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), new Set(), true)\n\t\t\t}\n\t\t}).then(() => {\n\t\t\tthis.updateEntityCounters(entityFrom, entityTo);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t\tentityFrom.deactivateGroupMode();\n\t}\n\n\thideSubTasks(entity: Entity, item: Item)\n\t{\n\t\tif (item && item.isParentTask())\n\t\t{\n\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t{\n\t\t\t\tthis.subTasksCreator.toggleSubTasks(entity, item);\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveTo(entityFrom: Entity, entityTo: Entity, item: Item, after = true, update = true)\n\t{\n\t\tthis.hideSubTasks(entityFrom, item);\n\n\t\tconst itemNode = item.getItemNode();\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\t\tif (after)\n\t\t{\n\t\t\tthis.domBuilder.append(itemNode, entityListNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.domBuilder.appendItemAfterItem(itemNode, entityListNode.firstElementChild);\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\n\t\tif (update)\n\t\t{\n\t\t\tthis.onMoveItemUpdate(entityFrom, entityTo, item);\n\t\t}\n\t}\n\n\tmoveToPosition(entityFrom: Entity, entityTo: Entity, item: Item)\n\t{\n\t\tthis.hideSubTasks(entityFrom, item);\n\n\t\tconst itemNode = item.getItemNode();\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\t\tconst bindItemNode = entityListNode.children[item.getSort()];\n\t\tif (Type.isUndefined(bindItemNode))\n\t\t{\n\t\t\tthis.domBuilder.append(itemNode, entityListNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst bindItemSort = parseInt(bindItemNode.dataset.sort, 10);\n\t\t\tconst isMoveFromAnotherEntity = (entityFrom.getId() !== entityTo.getId())\n\n\t\t\tif (bindItemSort >= item.getPreviousSort())\n\t\t\t{\n\t\t\t\tif (isMoveFromAnotherEntity)\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.insertBefore(itemNode, bindItemNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.appendItemAfterItem(itemNode, bindItemNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.domBuilder.insertBefore(itemNode, bindItemNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\n\t\tthis.updateEntityCounters(entityFrom, entityTo);\n\t}\n\n\tonMoveItemUpdate(entityFrom: Entity, entityTo: Entity, item: Item)\n\t{\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\titemType: item.getItemType(),\n\t\t\tentityId: entityTo.getId(),\n\t\t\tsourceEntityId: entityFrom.getId(),\n\t\t\tfromActiveSprint: ((entityFrom.getEntityType() === 'sprint' && entityFrom.isActive()) ? 'Y' : 'N'),\n\t\t\ttoActiveSprint: ((entityTo.getEntityType() === 'sprint' && entityTo.isActive()) ? 'Y' : 'N'),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), new Set([item.getItemId()]), true),\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), new Set(), true)\n\t\t\t}\n\t\t}).then(() => {\n\t\t\tthis.updateEntityCounters(entityFrom, entityTo);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tmoveItemFromEntityToEntity(item: Item, entityFrom: Entity, entityTo: Entity)\n\t{\n\t\tentityFrom.removeItem(item);\n\t\titem.setParentEntity(entityTo.getId(), entityTo.getEntityType());\n\t\titem.setDisableStatus(false);\n\t\tentityTo.setItem(item);\n\t}\n\n\tshowListSprintsToMove(entityFrom: Entity, item: Item, button: HTMLElement)\n\t{\n\t\tconst id = `item-sprint-action-${entityFrom.getEntityType() + entityFrom.getId() + item.itemId}`;\n\n\t\tif (this.moveToSprintMenu)\n\t\t{\n\t\t\tif (this.moveToSprintMenu.getPopupWindow().getId() === id)\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.getPopupWindow().setBindElement(button);\n\t\t\t\tthis.moveToSprintMenu.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.moveToSprintMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveToSprintMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (!sprint.isCompleted() && !this.isSameSprint(entityFrom, sprint))\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.addMenuItem({\n\t\t\t\t\ttext: sprint.getName(),\n\t\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\t\tlet message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\t\t\tif (entityFrom.isGroupMode())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmessage = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.onMoveConfirm(entityFrom, message)\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tif (entityFrom.isGroupMode())\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(() => {})\n\t\t\t\t\t\t;\n\t\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.moveToSprintMenu.show();\n\t}\n\n\tisSameSprint(first: Sprint, second: Sprint): boolean\n\t{\n\t\treturn (first.getEntityType() === 'sprint' && first.getId() === second.getId());\n\t}\n\n\tonMoveConfirm(entity: Entity, message: string): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (entity.isActive())\n\t\t\t{\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tmessage,\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_MOVE'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\treject();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tshowMoveItemMenu(item, button, listToMove)\n\t{\n\t\tconst id = `item-move-${item.itemId}`;\n\n\t\tif (this.moveItemMenu)\n\t\t{\n\t\t\tthis.moveItemMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveItemMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tlistToMove.forEach((item) => {\n\t\t\tthis.moveItemMenu.addMenuItem(item);\n\t\t});\n\n\t\tthis.moveItemMenu.show();\n\t}\n}","import {Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {Item} from '../item/item';\n\nimport {RequestSender} from '../utility/request.sender';\nimport {DomBuilder} from '../utility/dom.builder';\nimport {EntityStorage} from '../utility/entity.storage';\nimport {EntityCounters} from '../utility/entity.counters';\nimport {TagSearcher} from '../utility/tag.searcher';\nimport {ItemMover} from '../utility/item.mover';\nimport {SubTasksManager} from '../utility/subtasks.manager';\n\nimport {Entity} from '../entity/entity';\n\nimport type {ItemParams} from '../item/item';\nimport type {ItemsSortInfo} from '../utility/item.mover';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tentityCounters: EntityCounters,\n\ttagSearcher: TagSearcher,\n\titemMover: ItemMover,\n\tsubTasksCreator: SubTasksManager,\n\tcurrentUserId: number\n}\n\ntype RemoveParams = {\n\titemId: number\n}\n\nexport class PullItem\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.entityCounters = params.entityCounters;\n\t\tthis.tagSearcher = params.tagSearcher;\n\t\tthis.itemMover = params.itemMover;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\t\tthis.currentUserId = params.currentUserId;\n\n\t\tthis.listToAddAfterUpdate = new Map();\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t\tthis.listIdsToSkipSorting = new Set();\n\n\t\tthis.itemMover.subscribe('calculateSort', this.onCalculateSort.bind(this))\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\titemAdded: this.onItemAdded.bind(this),\n\t\t\titemUpdated: this.onItemUpdated.bind(this),\n\t\t\titemRemoved: this.onItemRemoved.bind(this),\n\t\t\titemSortUpdated: this.onItemSortUpdated.bind(this),\n\t\t\tcomment_add: this.onCommentAdd.bind(this)\n\t\t};\n\t}\n\n\tonItemAdded(itemData: ItemParams)\n\t{\n\t\tconst item = new Item(itemData);\n\n\t\titem.cleanTaskCounts();\n\n\t\tthis.setDelayedAdd(item);\n\n\t\tthis.externalAdd(item)\n\t\t\t.finally(() => this.cleanDelayedAdd(item))\n\t\t\t.then(() => this.addItemToEntity(item))\n\t\t\t.catch(() => {})\n\t\t;\n\t}\n\n\tonItemUpdated(itemData: ItemParams)\n\t{\n\t\tconst item = new Item(itemData);\n\n\t\titem.cleanTaskCounts();\n\n\t\tif (this.isDelayedAdd(item))\n\t\t{\n\t\t\tthis.cleanDelayedAdd(item);\n\n\t\t\tif (this.needSkipAdd(item))\n\t\t\t{\n\t\t\t\tthis.cleanSkipAdd(item);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.addItemToEntity(item);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.needSkipUpdate(item))\n\t\t{\n\t\t\tthis.cleanSkipUpdate(item);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateItem(item);\n\t}\n\n\tonItemRemoved(params: RemoveParams)\n\t{\n\t\tif (this.needSkipRemove(params.itemId))\n\t\t{\n\t\t\tthis.cleanSkipRemove(params.itemId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = this.entityStorage.findItemByItemId(params.itemId);\n\t\tif (item)\n\t\t{\n\t\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\t\t\tentity.removeItem(item);\n\t\t\titem.removeYourself();\n\t\t}\n\t}\n\n\tonItemSortUpdated(itemsSortInfo : ItemsSortInfo)\n\t{\n\t\tconst itemsToSort = new Map();\n\t\tconst itemsInfoToSort = new Map();\n\t\tObject.entries(itemsSortInfo).forEach(([itemId, info]) => {\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tif (!this.needSkipSort(info.tmpId))\n\t\t\t\t{\n\t\t\t\t\titemsToSort.set(item.getItemId(), item);\n\t\t\t\t\titemsInfoToSort.set(item.getItemId(), info);\n\t\t\t\t}\n\t\t\t\tthis.cleanSkipRemove(info.tmpId);\n\t\t\t}\n\t\t});\n\n\t\titemsToSort.forEach((item: Item) => {\n\t\t\tconst itemInfoToSort = itemsInfoToSort.get(item.getItemId());\n\t\t\titem.setSort(itemInfoToSort.sort);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\tif (sourceEntity)\n\t\t\t{\n\t\t\t\tconst targetEntityId = (\n\t\t\t\t\tType.isUndefined(itemInfoToSort.entityId)\n\t\t\t\t\t\t? item.getEntityId()\n\t\t\t\t\t\t: itemInfoToSort.entityId\n\t\t\t\t);\n\t\t\t\tlet targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\t\t\t\tif (!targetEntity || sourceEntity.getId() === targetEntity.getId())\n\t\t\t\t{\n\t\t\t\t\ttargetEntity = sourceEntity;\n\t\t\t\t}\n\t\t\t\tthis.itemMover.moveToPosition(sourceEntity, targetEntity, item);\n\t\t\t\tthis.entityStorage.recalculateItemsSort();\n\t\t\t}\n\t\t});\n\t}\n\n\tonCommentAdd(params)\n\t{\n\t\tconst participants = Type.isArray(params.participants) ? params.participants : [];\n\n\t\tif (participants.includes(this.currentUserId.toString()))\n\t\t{\n\t\t\tconst xmlId = params.entityXmlId.split('_');\n\t\t\tif (xmlId)\n\t\t\t{\n\t\t\t\tconst entityType = xmlId[0];\n\t\t\t\tconst taskId = xmlId[1];\n\t\t\t\tconst item = this.entityStorage.findItemBySourceId(taskId);\n\t\t\t\tif (entityType === 'TASK' && item)\n\t\t\t\t{\n\t\t\t\t\tthis.requestSender.getCurrentState({\n\t\t\t\t\t\ttaskId: item.getSourceId()\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tconst tmpItem = new Item(response.data.itemData);\n\t\t\t\t\t\tthis.updateItem(tmpItem, item);\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddItemToEntity(item: Item)\n\t{\n\t\tif (item.isSubTask())\n\t\t{\n\t\t\tthis.updateParentItem(item);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.hasTaskInFilter({\n\t\t\ttaskId: item.getSourceId()\n\t\t}).then((response) => {\n\t\t\tif (!response.data.has)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\tif (!entity)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst bindItemNode = entity.getListItemsNode().children[item.getSort()];\n\n\t\t\tif (bindItemNode)\n\t\t\t{\n\t\t\t\tthis.domBuilder.insertBefore(item.render(), bindItemNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.domBuilder.append(item.render(), entity.getListItemsNode());\n\t\t\t}\n\n\t\t\tentity.setItem(item);\n\n\t\t\tthis.updateEntityCounters(entity);\n\n\t\t\titem.getTags().forEach((tag) => {\n\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t});\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tupdateItem(tmpItem: Item, item?: Item)\n\t{\n\t\tif (!item)\n\t\t{\n\t\t\titem = this.entityStorage.findItemByItemId(tmpItem.getItemId());\n\t\t}\n\n\t\tif (item)\n\t\t{\n\t\t\tif (item.isParentTask())\n\t\t\t{\n\t\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\t\tthis.subTasksCreator.hideSubTaskItems(entity, item);\n\t\t\t\t}\n\t\t\t\tthis.subTasksCreator.cleanSubTasks(item);\n\t\t\t}\n\n\t\t\tconst isParentChangeAction = tmpItem.isSubTask() !== item.isSubTask();\n\t\t\tif (isParentChangeAction)\n\t\t\t{\n\t\t\t\tif (tmpItem.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\t\t\t\t\tentity.removeItem(item);\n\t\t\t\t\titem.removeYourself();\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst targetEntityId = tmpItem.getEntityId();\n\t\t\tconst sourceEntityId = item.getEntityId();\n\t\t\tconst targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\n\t\t\tif (tmpItem.getEntityId() !== item.getEntityId())\n\t\t\t{\n\t\t\t\tif (targetEntity && sourceEntity)\n\t\t\t\t{\n\t\t\t\t\tthis.itemMover.moveToPosition(sourceEntity, targetEntity, item);\n\t\t\t\t\tthis.entityStorage.recalculateItemsSort();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.updateEntityCounters(targetEntity);\n\t\t\t}\n\n\t\t\titem.updateYourself(tmpItem);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (tmpItem.isSubTask())\n\t\t\t{\n\t\t\t\tthis.updateParentItem(tmpItem);\n\n\t\t\t\tconst targetEntityId = tmpItem.getEntityId();\n\t\t\t\tconst targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\n\t\t\t\tthis.updateEntityCounters(targetEntity);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.addItemToEntity(tmpItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateParentItem(item: Item)\n\t{\n\t\tconst parentItem = this.entityStorage.findItemBySourceId(item.getParentTaskId());\n\n\t\tif (parentItem)\n\t\t{\n\t\t\tparentItem.updateSubTasksPoints(item.getSourceId(), item.getStoryPoints());\n\t\t}\n\t}\n\n\tupdateEntityCounters(sourceEntity: Entity, endEntity?: Entity)\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(sourceEntity.getId(), sourceEntity);\n\t\tif (endEntity)\n\t\t{\n\t\t\tentities.set(endEntity.getId(), endEntity);\n\t\t}\n\n\t\tthis.entityCounters.updateCounters(entities);\n\t}\n\n\tonCalculateSort(baseEvent: BaseEvent)\n\t{\n\t\tconst listSortInfo = baseEvent.getData();\n\n\t\tObject.entries(listSortInfo).forEach(([itemId, info]) => {\n\t\t\tif (Object.prototype.hasOwnProperty.call(info, 'tmpId'))\n\t\t\t{\n\t\t\t\tthis.addTmpIdToSkipSorting(info.tmpId);\n\t\t\t}\n\t\t});\n\t}\n\n\taddTmpIdsToSkipAdding(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.add(tmpId);\n\t}\n\n\taddIdToSkipUpdating(itemId: string)\n\t{\n\t\tthis.listIdsToSkipUpdating.add(itemId);\n\t}\n\n\taddIdToSkipRemoving(itemId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.add(itemId);\n\t}\n\n\taddTmpIdToSkipSorting(itemId: number)\n\t{\n\t\tthis.listIdsToSkipSorting.add(itemId);\n\t}\n\n\texternalAdd(item: Item): boolean\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tsetTimeout(() => (this.isDelayedAdd(item) ? resolve() : reject()), 3000);\n\t\t});\n\t}\n\n\tisDelayedAdd(item: Item): boolean\n\t{\n\t\treturn this.listToAddAfterUpdate.has(item.getItemId());\n\t}\n\n\tsetDelayedAdd(item: Item)\n\t{\n\t\tthis.listToAddAfterUpdate.set(item.getItemId(), item);\n\t}\n\n\tcleanDelayedAdd(item: Item)\n\t{\n\t\tthis.listToAddAfterUpdate.delete(item.getItemId());\n\t}\n\n\tneedSkipAdd(item: Item): boolean\n\t{\n\t\treturn this.listIdsToSkipAdding.has(item.getTmpId());\n\t}\n\n\tcleanSkipAdd(item: Item)\n\t{\n\t\tthis.listIdsToSkipAdding.delete(item.getTmpId());\n\t}\n\n\tneedSkipUpdate(item: Item): boolean\n\t{\n\t\treturn this.listIdsToSkipUpdating.has(item.getItemId());\n\t}\n\n\tcleanSkipUpdate(item: Item)\n\t{\n\t\tthis.listIdsToSkipUpdating.delete(item.getItemId());\n\t}\n\n\tneedSkipRemove(itemId: number): boolean\n\t{\n\t\treturn this.listIdsToSkipRemoving.has(itemId);\n\t}\n\n\tcleanSkipRemove(itemId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.delete(itemId);\n\t}\n\n\tneedSkipSort(tmpId: string): boolean\n\t{\n\t\treturn this.listIdsToSkipSorting.has(tmpId);\n\t}\n\n\tcleanSkipSort(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipSorting.delete(tmpId);\n\t}\n}","import {RequestSender} from '../utility/request.sender';\nimport {DomBuilder} from '../utility/dom.builder';\nimport {EntityStorage} from '../utility/entity.storage';\nimport {Epic} from '../utility/epic';\n\nimport type {EpicType} from '../item/item';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tepic: Epic\n}\n\nexport class PullEpic\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.epic = params.epic;\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tepicAdded: this.onEpicAdded.bind(this),\n\t\t\tepicUpdated: this.onEpicUpdated.bind(this),\n\t\t\tepicRemoved: this.onEpicRemoved.bind(this)\n\t\t};\n\t}\n\n\tonEpicAdded(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterCreateEpic(epicData);\n\t}\n\n\tonEpicUpdated(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterUpdateEpic(epicData);\n\t}\n\n\tonEpicRemoved(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterRemoveEpic(epicData);\n\t}\n}","import {BaseEvent} from 'main.core.events';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage\n}\n\nexport class SprintMover\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.bindHandlers();\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.domBuilder.subscribe('sprintMove', this.onSprintMove.bind(this))\n\t}\n\n\tonSprintMove(baseEvent: BaseEvent)\n\t{\n\t\tconst dragEndEvent = baseEvent.getData();\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.updateSprintSort({\n\t\t\tsortInfo: this.calculateSprintSort()\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tcalculateSprintSort(increment = 0)\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst container = this.domBuilder.getSprintPlannedListNode();\n\n\t\tconst sprints = [...container.querySelectorAll('[data-sprint-sort]')];\n\t\tlet sort = 1 + increment;\n\t\tsprints.forEach((sprintNode) => {\n\t\t\tconst sprintId = sprintNode.dataset.sprintId;\n\t\t\tconst sprint = this.entityStorage.findEntityByEntityId(sprintId);\n\t\t\tif (sprint)\n\t\t\t{\n\t\t\t\tsprint.setSort(sort);\n\t\t\t\tlistSortInfo[sprintId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tsprintNode.dataset.sprintSort = sort;\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\n\t\treturn listSortInfo;\n\t}\n}","import {Type, Dom} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {ScrumDod} from 'tasks.scrum.dod';\n\nimport {View} from './view';\nimport {TeamSpeedButton} from './header/team.speed.button';\n\nimport {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\nimport {Entity} from '../entity/entity';\nimport {Item} from '../item/item';\nimport {Decomposition} from '../item/task/decomposition';\nimport {DodSidePanel} from '../dod/side.panel';\nimport {TeamSpeedSidePanel} from '../team.speed/side.panel';\n\nimport {SidePanel} from '../service/side.panel';\nimport {PULL as Pull} from 'pull.client';\n\nimport {DomBuilder} from '../utility/dom.builder';\nimport {EntityStorage} from '../utility/entity.storage';\nimport {EntityCounters} from '../utility/entity.counters';\nimport {FilterHandler} from '../utility/filter.handler';\nimport {Epic} from '../utility/epic';\nimport {TagSearcher} from '../utility/tag.searcher';\nimport {PullSprint} from '../pull/pull.sprint';\nimport {PullItem} from '../pull/pull.item';\nimport {PullEpic} from '../pull/pull.epic';\nimport {SprintMover} from '../utility/sprint.mover';\nimport {ItemMover} from '../utility/item.mover';\nimport {ItemStyleDesigner} from '../utility/item.style.designer';\nimport {SubTasksManager} from '../utility/subtasks.manager';\n\nimport type {BacklogParams} from '../entity/backlog/backlog';\nimport type {SprintParams} from '../entity/sprint/sprint';\nimport type {EpicType, ItemParams} from '../item/item';\nimport type {Views} from './view';\nimport {Counters} from \"../counters/counters\";\n\ntype Responsible = {\n\tname: string,\n\tpathToUser: string,\n\tphoto: {\n\t\tsrc: string\n\t}\n}\n\ntype Params = {\n\tpathToTask: string,\n\tdefaultSprintDuration: number,\n\tactiveSprintId: number,\n\tbacklog: BacklogParams,\n\tsprints: Array<SprintParams>,\n\tviews: Views,\n\ttags: {\n\t\tepic: EpicType,\n\t\ttask: Array\n\t},\n\tdefaultResponsible: Responsible\n}\n\nexport class Plan extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Plan');\n\n\t\tthis.pathToTask = params.pathToTask;\n\t\tthis.defaultResponsible = params.defaultResponsible;\n\t\tthis.activeSprintId = parseInt(params.activeSprintId, 10);\n\t\tthis.views = params.views;\n\n\t\tthis.entityStorage = new EntityStorage();\n\t\tthis.entityStorage.addBacklog(Backlog.buildBacklog(params.backlog));\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tsprintData.defaultSprintDuration = params.defaultSprintDuration;\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t});\n\n\t\tthis.entityCounters = new EntityCounters({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.counters = new Counters({\n\t\t\tfilter: this.filter,\n\t\t\tuserId: params.userId,\n\t\t\tgroupId: params.groupId,\n\t\t\tisOwnerCurrentUser: params.isOwnerCurrentUser\n\t\t});\n\n\t\tthis.tagSearcher = new TagSearcher();\n\t\tObject.values(params.tags.epic).forEach((epic) => {\n\t\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\t});\n\t\tObject.values(params.tags.task).forEach((tagName) => {\n\t\t\tthis.tagSearcher.addTagToSearcher(tagName);\n\t\t});\n\n\t\tthis.domBuilder = new DomBuilder({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tdefaultSprintDuration: params.defaultSprintDuration,\n\t\t\tpageNumberToCompletedSprints: params.pageNumberToCompletedSprints\n\t\t});\n\t\tthis.domBuilder.subscribe('beforeCreateSprint', (baseEvent: BaseEvent) => {\n\t\t\tconst requestData = baseEvent.getData();\n\t\t\tthis.pullSprint.addTmpIdToSkipAdding(requestData.tmpId);\n\t\t});\n\t\tthis.domBuilder.subscribe(\n\t\t\t'createSprint',\n\t\t\t(baseEvent: BaseEvent) => this.subscribeToSprint(baseEvent.getData())\n\t\t);\n\t\tthis.domBuilder.subscribe(\n\t\t\t'createSprintNode',\n\t\t\t(baseEvent: BaseEvent) => this.subscribeToSprint(baseEvent.getData())\n\t\t);\n\n\t\tthis.sprintMover = new SprintMover({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.subTasksCreator = new SubTasksManager({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder\n\t\t});\n\n\t\tthis.filterHandler = new FilterHandler({\n\t\t\tfilter: this.filter,\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tsubTasksCreator: this.subTasksCreator\n\t\t});\n\n\t\tthis.itemMover = new ItemMover({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tentityCounters: this.entityCounters,\n\t\t\tsubTasksCreator: this.subTasksCreator\n\t\t});\n\n\t\tthis.itemStyleDesigner = new ItemStyleDesigner({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.epic = new Epic({\n\t\t\tentity: this.entityStorage.getBacklog(),\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tfilter: this.filter,\n\t\t\ttagSearcher: this.tagSearcher\n\t\t});\n\n\t\tthis.pullSprint = new PullSprint({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tgroupId: this.getCurrentGroupId()\n\t\t});\n\t\tthis.pullItem = new PullItem({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tentityCounters: this.entityCounters,\n\t\t\ttagSearcher: this.tagSearcher,\n\t\t\titemMover: this.itemMover,\n\t\t\tsubTasksCreator: this.subTasksCreator,\n\t\t\tcounters: this.counters,\n\t\t\tcurrentUserId: this.getCurrentUserId()\n\t\t});\n\t\tthis.pullEpic = new PullEpic({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tepic: this.epic,\n\t\t});\n\n\t\tthis.itemDod = new ScrumDod({\n\t\t\tgroupId: this.groupId\n\t\t});\n\n\t\tthis.bindHandlers();\n\n\t\tthis.subscribeToPull();\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tsuper.renderTo(container);\n\n\t\tthis.domBuilder.renderTo(container);\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderButtonsTo(container);\n\n\t\tconst teamSpeedButton = new TeamSpeedButton();\n\t\tteamSpeedButton.subscribe('click', this.onShowTeamSpeedChart.bind(this));\n\n\t\tDom.append(teamSpeedButton.render(), container);\n\t}\n\n\tsubscribeToPull()\n\t{\n\t\tPull.subscribe(this.pullSprint);\n\t\tPull.subscribe(this.pullItem);\n\t\tPull.subscribe(this.pullEpic);\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.entityStorage.getBacklog().subscribe('createTaskItem', this.onCreateTaskItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('updateItem', this.onUpdateItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showTask', this.onShowTask.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('moveItem', this.onMoveItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('moveToSprint', this.onMoveToSprint.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('removeItem', this.onRemoveItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('changeTaskResponsible', this.onChangeTaskResponsible.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('openAddEpicForm', this.onOpenAddEpicForm.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('openListEpicGrid', this.onOpenListEpicGrid.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('openDefinitionOfDone', this.onOpenDefinitionOfDone.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('attachFilesToTask', this.onAttachFilesToTask.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showDod', this.onShowDod.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showTagSearcher', this.onShowTagSearcher.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showEpicSearcher', this.onShowEpicSearcher.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('startDecomposition', this.onStartDecomposition.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('epicSearchOpen', this.onEpicSearchOpen.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('epicSearchClose', this.onEpicSearchClose.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('filterByEpic', this.onFilterByEpic.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('filterByTag', this.onFilterByTag.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('activateGroupMode', this.onActivateGroupMode.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('loadItems', this.onLoadItems.bind(this));\n\n\t\tthis.entityStorage.getSprints().forEach((sprint) => this.subscribeToSprint(sprint));\n\n\t\tthis.epic.subscribe('filterByTag', this.onFilterByTag.bind(this));\n\t}\n\n\tsubscribeToSprint(sprint: Sprint)\n\t{\n\t\tsprint.subscribe('createTaskItem', this.onCreateTaskItem.bind(this));\n\t\tsprint.subscribe('updateItem', this.onUpdateItem.bind(this));\n\t\tsprint.subscribe('showTask', this.onShowTask.bind(this));\n\t\tsprint.subscribe('moveItem', this.onMoveItem.bind(this));\n\t\tsprint.subscribe('moveToSprint', this.onMoveToSprint.bind(this));\n\t\tsprint.subscribe('moveToBacklog', this.onMoveToBacklog.bind(this));\n\t\tsprint.subscribe('removeItem', this.onRemoveItem.bind(this));\n\t\tsprint.subscribe('startSprint', this.onStartSprint.bind(this));\n\t\tsprint.subscribe('completeSprint', this.onCompleteSprint.bind(this));\n\t\tsprint.subscribe('changeTaskResponsible', this.onChangeTaskResponsible.bind(this));\n\t\tsprint.subscribe('removeSprint', this.onRemoveSprint.bind(this));\n\t\tsprint.subscribe('changeSprintName', this.onChangeSprintName.bind(this));\n\t\tsprint.subscribe('changeSprintDeadline', this.onChangeSprintDeadline.bind(this));\n\t\tsprint.subscribe('attachFilesToTask', this.onAttachFilesToTask.bind(this));\n\t\tsprint.subscribe('showDod', this.onShowDod.bind(this));\n\t\tsprint.subscribe('showTagSearcher', this.onShowTagSearcher.bind(this));\n\t\tsprint.subscribe('showEpicSearcher', this.onShowEpicSearcher.bind(this));\n\t\tsprint.subscribe('startDecomposition', this.onStartDecomposition.bind(this));\n\t\tsprint.subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tsprint.subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tsprint.subscribe('epicSearchOpen', this.onEpicSearchOpen.bind(this));\n\t\tsprint.subscribe('epicSearchClose', this.onEpicSearchClose.bind(this));\n\t\tsprint.subscribe('filterByEpic', this.onFilterByEpic.bind(this));\n\t\tsprint.subscribe('filterByTag', this.onFilterByTag.bind(this));\n\t\tsprint.subscribe('activateGroupMode', this.onActivateGroupMode.bind(this));\n\t\tsprint.subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t\tsprint.subscribe('getSprintCompletedItems', this.onGetSprintCompletedItems.bind(this));\n\t\tsprint.subscribe('showSprintBurnDownChart', this.onShowSprintBurnDownChart.bind(this));\n\t\tsprint.subscribe('toggleSubTasks', this.onToggleSubTasks.bind(this));\n\t\tsprint.subscribe('loadItems', this.onLoadItems.bind(this));\n\t}\n\n\tonCreateTaskItem(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst inputObject = data.inputObject;\n\t\tconst inputValue = data.value;\n\n\t\tconst newItem = this.createItem('task', inputValue);\n\n\t\tthis.pullItem.addTmpIdsToSkipAdding(newItem.getItemId());\n\n\t\tthis.fillItemBeforeCreation(entity, newItem, inputValue);\n\n\t\tthis.domBuilder.appendItemAfterItem(newItem.render(), inputObject.getNode());\n\t\tnewItem.onAfterAppend(entity.getListItemsNode());\n\n\t\tnewItem.setParentId(inputObject.getEpicId());\n\t\tinputObject.setEpicId(0);\n\n\t\tthis.sendRequestToCreateTask(entity, newItem).then((response) => {\n\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t});\n\t\t\tentity.setItem(newItem);\n\t\t\tthis.updateEntityCounters(entity);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonUpdateItem(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst updateData = baseEvent.getData();\n\n\t\tthis.pullItem.addIdToSkipUpdating(updateData.itemId);\n\n\t\tthis.requestSender.updateItem(baseEvent.getData())\n\t\t\t.then(() => {\n\t\t\t\tconst isStoryPointsUpdated = (!Type.isUndefined(updateData.storyPoints));\n\t\t\t\tif (isStoryPointsUpdated)\n\t\t\t\t{\n\t\t\t\t\tthis.updateEntityCounters(entity);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonRemoveItem(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tif (entity.isGroupMode())\n\t\t{\n\t\t\tconst items = [];\n\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\titems.push({\n\t\t\t\t\titemId: groupModeItem.getItemId(),\n\t\t\t\t\tentityId: groupModeItem.getEntityId(),\n\t\t\t\t\titemType: groupModeItem.getItemType(),\n\t\t\t\t\tsourceId: groupModeItem.getSourceId()\n\t\t\t\t});\n\t\t\t\tthis.pullItem.addIdToSkipRemoving(groupModeItem.getItemId());\n\t\t\t});\n\t\t\tthis.requestSender.batchRemoveItem({\n\t\t\t\titems: items,\n\t\t\t\tsortInfo: this.itemMover.calculateSort(entity.getListItemsNode())\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t\tentity.deactivateGroupMode();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pullItem.addIdToSkipRemoving(baseEvent.getData().getItemId());\n\t\t\tthis.requestSender.removeItem({\n\t\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\t\tentityId: baseEvent.getData().getEntityId(),\n\t\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\t\tsortInfo: this.itemMover.calculateSort(entity.getListItemsNode())\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t}\n\t}\n\n\tonMoveItem(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tthis.itemMover.moveItem(data.item, data.button);\n\t}\n\n\tonMoveToSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst entityFrom = baseEvent.getTarget();\n\t\tthis.itemMover.moveToAnotherEntity(entityFrom, data.item, null, data.button);\n\t\tif (this.entityStorage.getSprintsAvailableForFilling(entityFrom).size <= 1)\n\t\t{\n\t\t\tthis.domBuilder.remove(data.button.parentNode);\n\t\t}\n\t}\n\n\tonMoveToBacklog(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tthis.itemMover.moveToAnotherEntity(data.sprint, data.item, this.entityStorage.getBacklog());\n\t}\n\n\tonChangeTaskResponsible(baseEvent: BaseEvent)\n\t{\n\t\tthis.pullItem.addIdToSkipUpdating(baseEvent.getData().getItemId());\n\t\tthis.requestSender.changeTaskResponsible({\n\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\tresponsible: baseEvent.getData().getResponsible(),\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonStartSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showStartSidePanel(sprint);\n\t}\n\n\tonCompleteSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showCompleteSidePanel(sprint);\n\t}\n\n\tonRemoveSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tthis.pullSprint.addIdToSkipRemoving(sprint.getId());\n\t\tthis.requestSender.removeSprint({\n\t\t\tsprintId: sprint.getId(),\n\t\t\tsortInfo: this.sprintMover.calculateSprintSort()\n\t\t}).then((response) => {\n\t\t\tthis.entityStorage.removeSprint(sprint.getId());\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeSprintName(baseEvent: BaseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.pullSprint.addIdToSkipUpdating(requestData.sprintId);\n\t\tthis.requestSender.changeSprintName(requestData).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeSprintDeadline(baseEvent: BaseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.pullSprint.addIdToSkipUpdating(requestData.sprintId);\n\t\tthis.requestSender.changeSprintDeadline(requestData).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonGetSprintCompletedItems(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst listItemsNode = sprint.getListItemsNode();\n\t\tconst listPosition = this.domBuilder.getPosition(listItemsNode);\n\t\tconst loader = new Loader({\n\t\t\ttarget: listItemsNode,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: '#eaeaea',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\t\tloader.show();\n\t\tthis.requestSender.getSprintCompletedItems({\n\t\t\tsprintId: sprint.getId()\n\t\t}).then((response) => {\n\t\t\tconst itemsData = response.data;\n\t\t\titemsData.forEach((itemData) => {\n\t\t\t\tconst item = new Item(itemData);\n\t\t\t\titem.setDisableStatus(sprint.isDisabled());\n\t\t\t\tthis.domBuilder.append(item.render(), listItemsNode);\n\t\t\t\tsprint.setItem(item);\n\t\t\t});\n\t\t\tloader.hide();\n\t\t}).catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonShowSprintBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(sprint);\n\t}\n\n\tonShowTask(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getData();\n\t\tthis.sidePanel.openSidePanelByUrl(this.pathToTask.replace('#task_id#', item.getSourceId()));\n\t}\n\n\tonAttachFilesToTask(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tthis.pullItem.addIdToSkipUpdating(data.item.getItemId());\n\t\tthis.requestSender.attachFilesToTask({\n\t\t\ttaskId: data.item.getSourceId(),\n\t\t\titemId: data.item.getItemId(),\n\t\t\tentityId: data.item.getEntityId(),\n\t\t\tattachedIds: data.attachedIds,\n\t\t}).then((response) => {\n\t\t\tdata.item.updateIndicators(response.data);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonShowDod(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getData();\n\n\t\tthis.itemDod.skipNotificationPopups();\n\n\t\tthis.itemDod.showList(item.getSourceId())\n\t\t\t.then(() => {})\n\t\t\t.catch(() => {})\n\t\t;\n\t}\n\n\tonToggleSubTasks(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst item = baseEvent.getData();\n\n\t\tthis.subTasksCreator.toggleSubTasks(sprint, item);\n\t}\n\n\tonShowTagSearcher(baseEvent: BaseEvent)\n\t{\n\t\t//todo refactor and test\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst data = baseEvent.getData();\n\t\tconst item = data.item;\n\t\tconst actionsPanelButton = data.button;\n\t\tthis.tagSearcher.showTagsDialog(item, actionsPanelButton);\n\t\tthis.tagSearcher.unsubscribeAll('attachTagToTask');\n\t\tthis.tagSearcher.subscribe('attachTagToTask', (innerBaseEvent) => {\n\t\t\tconst tag = innerBaseEvent.getData();\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tconst tasks = [];\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\ttasks.push({\n\t\t\t\t\t\ttaskId: groupModeItem.getSourceId(),\n\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.requestSender.batchAttachTagToTask({\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tconst currentTags = groupModeItem.getTags();\n\t\t\t\t\t\tcurrentTags.push(tag);\n\t\t\t\t\t\tgroupModeItem.setEpicAndTags(groupModeItem.getEpic(), currentTags);\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst currentTags = item.getTags();\n\t\t\t\tthis.requestSender.attachTagToTask({\n\t\t\t\t\ttaskId: item.getSourceId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tcurrentTags.push(tag);\n\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.tagSearcher.unsubscribeAll('deAttachTagToTask');\n\t\tthis.tagSearcher.subscribe('deAttachTagToTask', (innerBaseEvent) => {\n\t\t\tconst tag = innerBaseEvent.getData();\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tconst tasks = [];\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\ttasks.push({\n\t\t\t\t\t\ttaskId: groupModeItem.getSourceId(),\n\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.requestSender.batchDeattachTagToTask({\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tconst currentTags = groupModeItem.getTags();\n\t\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(tag), 1);\n\t\t\t\t\t\tgroupModeItem.setEpicAndTags(groupModeItem.getEpic(), currentTags);\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst currentTags = item.getTags();\n\t\t\t\tthis.requestSender.deAttachTagToTask({\n\t\t\t\t\ttaskId: item.getSourceId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttag: tag\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(tag), 1);\n\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.tagSearcher.unsubscribeAll('hideTagDialog');\n\t\tthis.tagSearcher.subscribe('hideTagDialog', (innerBaseEvent) => {\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tentity.deactivateGroupMode();\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowEpicSearcher(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst data = baseEvent.getData();\n\t\tconst item = data.item;\n\t\tconst actionsPanelButton = data.button;\n\t\tthis.tagSearcher.showEpicDialog(item, actionsPanelButton);\n\t\tthis.tagSearcher.unsubscribeAll('updateItemEpic');\n\t\tthis.tagSearcher.subscribe('updateItemEpic', (innerBaseEvent) => {\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tconst items = [];\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t});\n\t\t\t\t\tthis.pullItem.addIdToSkipUpdating(groupModeItem.getItemId());\n\t\t\t\t});\n\t\t\t\tthis.requestSender.batchUpdateItemEpic({\n\t\t\t\t\titems: items,\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\tepicId: innerBaseEvent.getData()\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tif (Type.isArray(response.data.epic))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgroupModeItem.setParentId(0);\n\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(null, null);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgroupModeItem.setParentId(response.data.epic.id);\n\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(response.data.epic, groupModeItem.getTags());\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.pullItem.addIdToSkipUpdating(item.getItemId());\n\t\t\t\tthis.requestSender.updateItemEpic({\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\tepicId: innerBaseEvent.getData()\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tif (Type.isArray(response.data.epic))\n\t\t\t\t\t{\n\t\t\t\t\t\titem.setParentId(0);\n\t\t\t\t\t\titem.setEpicAndTags(null, null);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titem.setParentId(response.data.epic.id);\n\t\t\t\t\t\titem.setEpicAndTags(response.data.epic, item.getTags());\n\t\t\t\t\t}\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonStartDecomposition(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst parentItem = baseEvent.getData();\n\n\t\tconst decomposition = new Decomposition({\n\t\t\tentity: entity,\n\t\t\titemStyleDesigner: this.itemStyleDesigner,\n\t\t\tsubTasksCreator: this.subTasksCreator\n\t\t});\n\t\tdecomposition.subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tdecomposition.subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tdecomposition.subscribe('createItem', (innerBaseEvent) => {\n\t\t\tconst inputValue = innerBaseEvent.getData();\n\t\t\tconst decomposedItems = decomposition.getDecomposedItems();\n\t\t\tconst lastDecomposedItem = Array.from(decomposedItems).pop();\n\n\t\t\tconst newItem = this.createItem(parentItem.getItemType(), inputValue);\n\n\t\t\tthis.pullItem.addTmpIdsToSkipAdding(newItem.getItemId());\n\t\t\tthis.pullItem.addIdToSkipUpdating(parentItem.getItemId());\n\n\t\t\tnewItem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\t\tnewItem.setParentId(parentItem.getParentId());\n\t\t\tnewItem.setParentTaskId(parentItem.getSourceId());\n\t\t\tnewItem.setEpic(parentItem.getEpic());\n\t\t\tnewItem.setTags(parentItem.getTags());\n\t\t\tnewItem.setResponsible(decomposition.getResponsible());\n\t\t\tif (decomposition.isBacklogDecomposition())\n\t\t\t{\n\t\t\t\tparentItem.setLinkedTask('Y');\n\n\t\t\t\tnewItem.setSort(lastDecomposedItem.getSort() + 1);\n\t\t\t\tnewItem.setInfo({\n\t\t\t\t\tborderColor: decomposition.getBorderColor()\n\t\t\t\t});\n\t\t\t\tnewItem.setLinkedTask('Y');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnewItem.setSort(decomposition.getSubTasks(parentItem).length + 1);\n\t\t\t\tnewItem.setSubTask('Y');\n\t\t\t\tnewItem.setParentTaskId(parentItem.getSourceId());\n\t\t\t\tnewItem.setParentTask('N');\n\n\t\t\t\tif (decomposition.isFirstDecomposition())\n\t\t\t\t{\n\t\t\t\t\tnewItem.setStoryPoints(parentItem.getStoryPoints().getPoints());\n\t\t\t\t}\n\n\t\t\t\tparentItem.setParentTask('Y');\n\t\t\t\tparentItem.setSubTasksCount(parentItem.getSubTasksCount() + 1);\n\t\t\t\tparentItem.updateParentTaskNodes();\n\t\t\t}\n\n\t\t\tthis.domBuilder.appendItemAfterItem(\n\t\t\t\tnewItem.render(),\n\t\t\t\tdecomposition.getLastDecomposedItemNode(parentItem)\n\t\t\t);\n\t\t\tnewItem.onAfterAppend(entity.getListItemsNode());\n\n\t\t\tdecomposition.addDecomposedItem(newItem);\n\n\t\t\tthis.sendRequestToCreateTask(entity, newItem).then((response) => {\n\t\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t\t});\n\t\t\t\tentity.setItem(newItem);\n\t\t\t\tthis.updateEntityCounters(entity);\n\t\t\t\tif (!decomposition.isBacklogDecomposition())\n\t\t\t\t{\n\t\t\t\t\tif (lastDecomposedItem.getItemId() === parentItem.getItemId())\n\t\t\t\t\t{\n\t\t\t\t\t\tparentItem.updateSubTasksPoints(newItem.getSourceId(), newItem.getStoryPoints());\n\t\t\t\t\t\tparentItem.setStoryPoints('');\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.subTasksCreator.addSubTask(parentItem, newItem);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tdecomposition.subscribe('updateParentItem', this.onUpdateItem.bind(this));\n\n\t\tdecomposition.decomposeItem(parentItem);\n\t}\n\n\tonTagsSearchOpen(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst inputObject = data.inputObject;\n\t\tconst enteredHashTagName = data.enteredHashTagName;\n\t\tthis.tagSearcher.showTagsSearchDialog(inputObject, enteredHashTagName);\n\t}\n\n\tonTagsSearchClose()\n\t{\n\t\tthis.tagSearcher.closeTagsSearchDialog();\n\t}\n\n\tonFilterByTag(baseEvent: BaseEvent)\n\t{\n\t\tconst tag = baseEvent.getData();\n\t\tconst currentValue = this.filter.getValueFromField({name: 'TAG', value: ''});\n\t\tif (String(tag) === String(currentValue))\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'TAG', value: ''});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'TAG', value: String(tag)});\n\t\t}\n\t\tthis.filter.scrollToSearchContainer();\n\t}\n\n\tonEpicSearchOpen(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tconst inputObject = data.inputObject;\n\t\tconst enteredHashEpicName = data.enteredHashEpicName;\n\t\tthis.tagSearcher.showEpicSearchDialog(inputObject, enteredHashEpicName);\n\t}\n\n\tonEpicSearchClose()\n\t{\n\t\tthis.tagSearcher.closeEpicSearchDialog();\n\t}\n\n\tonFilterByEpic(baseEvent: BaseEvent)\n\t{\n\t\tconst epicId = baseEvent.getData();\n\t\tconst currentValue = this.filter.getValueFromField({name: 'EPIC', value: ''});\n\t\tif (String(epicId) === String(currentValue))\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'EPIC', value: ''});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'EPIC', value: String(epicId)});\n\t\t}\n\t\tthis.filter.scrollToSearchContainer();\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tif (entity.getId() !== this.entityStorage.getBacklog().getId())\n\t\t{\n\t\t\tthis.entityStorage.getBacklog().deactivateGroupMode();\n\t\t}\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (entity.getId() !== sprint.getId())\n\t\t\t{\n\t\t\t\tsprint.deactivateGroupMode();\n\t\t\t}\n\t\t});\n\t\tentity.getItems().forEach((item: Item) => {\n\t\t\titem.activateGroupMode();\n\t\t});\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tentity.getItems().forEach((item: Item) => {\n\t\t\titem.deactivateGroupMode();\n\t\t});\n\t}\n\n\tonLoadItems(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\n\t\tentity.setActiveLoadItems(true);\n\n\t\tconst loader = entity.showItemsLoader();\n\n\t\tconst requestData = {\n\t\t\tentityId: entity.getId(),\n\t\t\tpageNumber: entity.getPageNumberItems() + 1\n\t\t};\n\n\t\tthis.requestSender.getItems(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tconst items = response.data;\n\t\t\t\tif (Type.isArray(items) && items.length)\n\t\t\t\t{\n\t\t\t\t\tentity.incrementPageNumberItems();\n\t\t\t\t\tentity.setActiveLoadItems(false);\n\n\t\t\t\t\tthis.createItemsInEntity(entity, items);\n\t\t\t\t}\n\t\t\t\tloader.hide();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\tentity.setActiveLoadItems(false);\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tcreateItemsInEntity(entity: Entity, items: Array)\n\t{\n\t\titems.forEach((itemData: ItemParams) => {\n\t\t\tconst item = new Item(itemData);\n\t\t\titem.setEntityType(entity.getEntityType());\n\t\t\tif (!this.entityStorage.findItemByItemId(item.getItemId()))\n\t\t\t{\n\t\t\t\tthis.domBuilder.append(item.render(), entity.getListItemsNode());\n\t\t\t\titem.onAfterAppend(entity.getListItemsNode());\n\t\t\t\tentity.setItem(item);\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowTeamSpeedChart(baseEvent: BaseEvent)\n\t{\n\t\tconst teamSpeedSidePanel = new TeamSpeedSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\t\tteamSpeedSidePanel.showTeamSpeedChart();\n\t}\n\n\tonOpenAddEpicForm(baseEvent: BaseEvent)\n\t{\n\t\tthis.epic.openAddForm();\n\t}\n\n\tonOpenListEpicGrid(baseEvent: BaseEvent)\n\t{\n\t\tthis.epic.openEpicsList();\n\t\tthis.epic.subscribe('onAfterEditEpic', (innerBaseEvent) => {\n\t\t\tconst response = innerBaseEvent.getData();\n\t\t\tconst updatedEpicInfo = response.data;\n\t\t\tthis.epic.onAfterUpdateEpic(updatedEpicInfo);\n\t\t});\n\t}\n\n\tonOpenDefinitionOfDone(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\n\t\tconst sidePanel = new DodSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\n\t\tsidePanel.showSettingsPanel(entity);\n\t}\n\n\tcreateItem(itemType: string, value: string): Item\n\t{\n\t\tconst valueWithoutTags = value\n\t\t\t.replace(new RegExp(TagSearcher.tagRegExp,'g'), '')\n\t\t\t.replace(new RegExp(TagSearcher.epicRegExp,'g'), '');\n\n\t\treturn new Item({\n\t\t\t'itemId': '',\n\t\t\t'itemType': itemType,\n\t\t\t'name': valueWithoutTags\n\t\t});\n\t}\n\n\tsendRequestToCreateTask(entity: Entity, item: Item): Promise\n\t{\n\t\tconst requestData = {\n\t\t\t'tmpId': item.getItemId(),\n\t\t\t'itemType': item.getItemType(),\n\t\t\t'name': item.getName(),\n\t\t\t'entityId': item.getEntityId(),\n\t\t\t'entityType': entity.getEntityType(),\n\t\t\t'parentId': item.getParentId(),\n\t\t\t'sort': item.getSort(),\n\t\t\t'storyPoints': item.getStoryPoints().getPoints(),\n\t\t\t'tags': item.getTags(),\n\t\t\t'epic': item.getEpic(),\n\t\t\t'parentTaskId': item.getParentTaskId(),\n\t\t\t'responsible': item.getResponsible(),\n\t\t\t'info': item.getInfo(),\n\t\t\t'sortInfo': this.itemMover.calculateSort(entity.getListItemsNode()),\n\t\t\t'isActiveSprint': ((entity.getEntityType() === 'sprint' && entity.isActive()) ? 'Y' : 'N')\n\t\t};\n\t\treturn this.requestSender.createTask(requestData);\n\t}\n\n\tfillItemBeforeCreation(entity: Entity, item: Item, value: string)\n\t{\n\t\titem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\titem.setSort(1);\n\t\titem.setResponsible(this.defaultResponsible);\n\n\t\tconst tags = TagSearcher.getHashTagNamesFromText(value);\n\t\tconst epicName = TagSearcher.getHashEpicNamesFromText(value).pop();\n\n\t\tlet inputEpic = null;\n\t\tif (epicName)\n\t\t{\n\t\t\tinputEpic = this.tagSearcher.getEpicByName(epicName.trim());\n\t\t}\n\n\t\tif (inputEpic || tags.length > 0)\n\t\t{\n\t\t\titem.setEpicAndTags(inputEpic, tags);\n\t\t}\n\t}\n\n\tfillItemAfterCreation(item: Item, responseData: Object): Item\n\t{\n\t\t//todo test\n\n\t\titem.setItemId(responseData.itemId);\n\t\tif (!Type.isArray(responseData.epic) || responseData.tags.length > 0)\n\t\t{\n\t\t\titem.setEpicAndTags(responseData.epic, responseData.tags);\n\t\t}\n\t\titem.setResponsible(responseData.responsible);\n\t\titem.setSourceId(responseData.sourceId);\n\t\titem.setAllowedActions(responseData.allowedActions);\n\t}\n\n\topenEpicEditForm(epicId)\n\t{\n\t\tthis.epic.openEditForm(epicId);\n\t}\n\n\topenEpicViewForm(epicId)\n\t{\n\t\tthis.epic.openViewForm(epicId);\n\t}\n\n\tremoveEpic(epicId)\n\t{\n\t\tthis.requestSender.removeItem({\n\t\t\titemId: epicId,\n\t\t\titemType: 'epic'\n\t\t}).then((response) => {\n\t\t\tconst epicInfo = response.data;\n\t\t\tthis.epic.onAfterRemoveEpic(epicInfo);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tupdateEntityCounters(sourceEntity: Entity, endEntity?: Entity)\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(sourceEntity.getId(), sourceEntity);\n\t\tif (endEntity)\n\t\t{\n\t\t\tentities.set(endEntity.getId(), endEntity);\n\t\t}\n\n\t\tthis.entityCounters.updateCounters(entities);\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Menu} from 'main.popup';\n\nexport class ActiveSprintActionButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ActiveSprintButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"ui-btn-split ui-btn-primary ui-btn-xs\"> \n\t\t\t\t<button class=\"ui-btn-main\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ACTIONS_COMPLETE_SPRINT')}\n\t\t\t\t</button> \n\t\t\t\t<button class=\"ui-btn-menu\"></button> \n\t\t\t</div>\n\t\t`;\n\n\t\tconst completeSprintButtonNode = node.querySelector('.ui-btn-main');\n\t\tconst menuButtonNode = node.querySelector('.ui-btn-menu');\n\n\t\tEvent.bind(completeSprintButtonNode, 'click', this.onCompleteSprintClick.bind(this));\n\t\tEvent.bind(menuButtonNode, 'click', this.onMenuClick.bind(this, completeSprintButtonNode));\n\n\t\treturn node;\n\t}\n\n\tonCompleteSprintClick()\n\t{\n\t\tthis.emit('completeSprint');\n\t}\n\n\tonMenuClick(bindElement: HTMLElement)\n\t{\n\t\tconst menu = new Menu({\n\t\t\tid: `active-sprint-actions-menu-${Text.getRandom()}`,\n\t\t\tbindElement: bindElement\n\t\t});\n\n\t\tmenu.addMenuItem({\n\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ACTIVE_SPRINT_BUTTON'),\n\t\t\tonclick: (event, menuItem) => {\n\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\tthis.emit('showBurnDownChart');\n\t\t\t}\n\t\t});\n\n\t\tmenu.show();\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../../service/side.panel';\n\nimport '../../css/robot.button.css';\n\ntype Params = {\n\tsidePanel: SidePanel,\n\tgroupId: number,\n\tisTaskLimitsExceeded: boolean,\n\tcanUseAutomation: boolean\n}\n\nexport class RobotButton extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.isTaskLimitsExceeded = params.isTaskLimitsExceeded;\n\t\tthis.canUseAutomation = params.canUseAutomation;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.RobotButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet className = 'tasks-scrum-robot-btn ui-btn ui-btn-light-border ui-btn-no-caps ui-btn-themes ui-btn-round';\n\t\tif (this.isShowLimitSidePanel())\n\t\t{\n\t\t\tclassName += ' ui-btn-icon-lock';\n\t\t}\n\n\t\tconst node = Tag.render`\n\t\t\t<button class=\"${className}\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ROBOTS_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonClick()\n\t{\n\t\tif (this.isShowLimitSidePanel())\n\t\t{\n\t\t\t// eslint-disable-next-line\n\t\t\tBX.UI.InfoHelper.show('limit_tasks_robots');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst url = '/bitrix/components/bitrix/tasks.automation/slider.php?site_id='\n\t\t\t\t+ Loc.getMessage('SITE_ID') + '&project_id=' + this.groupId;\n\n\t\t\tthis.sidePanel.openSidePanelByUrl(url);\n\t\t}\n\t}\n\n\tisShowLimitSidePanel(): boolean\n\t{\n\t\treturn (this.isTaskLimitsExceeded && !this.canUseAutomation);\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {View} from './view';\nimport {ActiveSprintActionButton} from './header/active.sprint.action.button';\nimport {RobotButton} from './header/robot.button';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\nimport {StatsHeaderBuilder} from '../entity/sprint/stats.header.builder';\nimport {Item} from '../item/item';\n\nimport type {SprintParams} from '../entity/sprint/sprint';\nimport type {Views} from './view';\n\ntype Params = {\n\tpathToTask: string,\n\tviews: Views,\n\tactiveSprint: SprintParams,\n\tsprints: Array<SprintParams>,\n\ttaskLimitExceeded: 'Y' | 'N',\n\tcanUseAutomation: 'Y' | 'N'\n}\n\nexport class ActiveSprint extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ActiveSprint');\n\n\t\tthis.setParams(params);\n\n\t\tif (this.existActiveSprint())\n\t\t{\n\t\t\tthis.finishStatus = this.getActiveSprintParams().finishStatus;\n\n\t\t\tthis.sprint = new Sprint(this.getActiveSprintParams());\n\n\t\t\tthis.itemsInFinishStage = new Map();\n\n\t\t\tthis.bindHandlers();\n\t\t}\n\n\t\tthis.sidePanel = new SidePanel();\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderSprintStatsTo(container);\n\n\t\tthis.statsHeader = StatsHeaderBuilder.build(this.sprint);\n\t\tthis.statsHeader.setKanbanStyle();\n\n\t\tDom.append(this.statsHeader.render(), container);\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderButtonsTo(container);\n\n\t\tif (!this.existActiveSprint())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst robotButton = new RobotButton({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tgroupId: this.getCurrentGroupId(),\n\t\t\tisTaskLimitsExceeded: this.isTaskLimitsExceeded(),\n\t\t\tcanUseAutomation: this.isCanUseAutomation()\n\t\t});\n\n\t\tconst activeSprintActionButton = new ActiveSprintActionButton();\n\t\tactiveSprintActionButton.subscribe('completeSprint', this.onCompleteSprint.bind(this));\n\t\tactiveSprintActionButton.subscribe('showBurnDownChart', this.onShowSprintBurnDownChart.bind(this));\n\n\t\tDom.append(robotButton.render(), container);\n\t\tDom.append(activeSprintActionButton.render(), container);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.setPathToTask(params.pathToTask);\n\t\tthis.setActiveSprintParams(params.activeSprint);\n\t\tthis.setTaskLimitsExceeded(params.taskLimitExceeded);\n\t\tthis.setCanUseAutomation(params.canUseAutomation);\n\n\t\tthis.sprints = new Map();\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tconst sprint = new Sprint(sprintData);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t});\n\n\t\tthis.views = params.views;\n\t}\n\n\tsetPathToTask(pathToTask: string)\n\t{\n\t\tthis.pathToTask = (Type.isString(pathToTask) ? pathToTask : '');\n\t}\n\n\tgetPathToTask(): string\n\t{\n\t\treturn this.pathToTask;\n\t}\n\n\tsetActiveSprintParams(params: SprintParams)\n\t{\n\t\tthis.activeSprint = (Type.isPlainObject(params) ? params : null);\n\t}\n\n\tgetActiveSprintParams(): SprintParams\n\t{\n\t\treturn this.activeSprint;\n\t}\n\n\tsetTaskLimitsExceeded(limitExceeded: string)\n\t{\n\t\tthis.limitExceeded = (limitExceeded === 'Y');\n\t}\n\n\tisTaskLimitsExceeded(): boolean\n\t{\n\t\treturn this.limitExceeded;\n\t}\n\n\tsetCanUseAutomation(canUseAutomation: string)\n\t{\n\t\tthis.canUseAutomation = (canUseAutomation === 'Y');\n\t}\n\n\tisCanUseAutomation(): boolean\n\t{\n\t\treturn this.canUseAutomation;\n\t}\n\n\texistActiveSprint(): boolean\n\t{\n\t\treturn (this.activeSprint !== null);\n\t}\n\n\tbindHandlers()\n\t{\n\t\t// eslint-disable-next-line\n\t\tconst kanbanManager = BX.Tasks.Scrum.Kanban;\n\t\tif (kanbanManager)\n\t\t{\n\t\t\tthis.bindKanbanHandlers(kanbanManager.getKanban());\n\t\t\tkanbanManager.getKanbansGroupedByParentTasks().forEach((kanban) => {\n\t\t\t\tthis.bindKanbanHandlers(kanban);\n\t\t\t});\n\t\t}\n\t}\n\n\tbindKanbanHandlers(kanban)\n\t{\n\t\tthis.onKanbanRender(kanban);\n\n\t\tEventEmitter.subscribe(kanban, 'Kanban.Grid:onItemMoved', (event: BaseEvent) => {\n\t\t\tconst [kanbanItem, targetColumn, beforeItem] = event.getCompatData();\n\t\t\tthis.onItemMoved(kanbanItem, targetColumn, beforeItem);\n\t\t});\n\t}\n\n\tonCompleteSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.sprints,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showCompleteSidePanel(this.sprint);\n\n\t\tthis.sprint.subscribe('showTask', (innerBaseEvent: BaseEvent) => {\n\t\t\tconst item = innerBaseEvent.getData();\n\t\t\tthis.sidePanel.openSidePanelByUrl(this.getPathToTask().replace('#task_id#', item.getSourceId()));\n\t\t});\n\t}\n\n\t/**\n\t * Handles Kanban render.\n\t * @param {BX.Tasks.Kanban.Grid} kanbanGrid\n\t * @returns {void}\n\t */\n\tonKanbanRender(kanbanGrid)\n\t{\n\t\tconst items = kanbanGrid.getItems();\n\t\tconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\t\tfor (let itemId in kanbanGrid.getItems())\n\t\t{\n\t\t\tif (hasOwnProperty.call(items, itemId))\n\t\t\t{\n\t\t\t\tconst item = items[itemId];\n\t\t\t\tif (item.getColumn().getType() === this.finishStatus)\n\t\t\t\t{\n\t\t\t\t\tthis.itemsInFinishStage.set(itemId, '');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Hook on item moved.\n\t * @param {BX.Tasks.Kanban.Item} kanbanItem\n\t * @param {BX.Tasks.Kanban.Column} targetColumn\n\t * @param {BX.Tasks.Kanban.Item} [beforeItem]\n\t * @returns {void}\n\t */\n\tonItemMoved(kanbanItem, targetColumn, beforeItem)\n\t{\n\t\tif (targetColumn.type === this.finishStatus)\n\t\t{\n\t\t\tif (!this.itemsInFinishStage.has(kanbanItem.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedToFinish(kanbanItem, this.sprint);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.itemsInFinishStage.has(kanbanItem.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedFromFinish(kanbanItem, this.sprint);\n\t\t\t}\n\t\t}\n\n\t\tthis.statsHeader.updateStats(this.sprint);\n\t}\n\n\tupdateStatsAfterMovedToFinish(kanbanItem, sprint: Sprint)\n\t{\n\t\tthis.itemsInFinishStage.set(kanbanItem.getId(), kanbanItem.getStoryPoints());\n\n\t\tsprint.getCompletedStoryPoints().addPoints(kanbanItem.getStoryPoints());\n\t\tsprint.getUncompletedStoryPoints().subtractPoints(kanbanItem.getStoryPoints());\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() + 1);\n\t\tsprint.setUncompletedTasks(sprint.getUncompletedTasks() - 1);\n\n\t\tsprint.getItems().forEach((scrumItem: Item) => {\n\t\t\tif (scrumItem.getSourceId() === parseInt(kanbanItem.getId(), 10))\n\t\t\t{\n\t\t\t\tscrumItem.setCompleted('Y');\n\n\t\t\t\tif (scrumItem.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tconst parentItem = sprint.getItemBySourceId(scrumItem.getParentTaskId());\n\t\t\t\t\tif (parentItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst subTasksItems = sprint.getItemsByParentTaskId(parentItem.getSourceId());\n\t\t\t\t\t\tconst unCompletedItem = [...subTasksItems.values()].find((item: Item) => !item.isCompleted());\n\t\t\t\t\t\tif (!unCompletedItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparentItem.setCompleted('Y');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateStatsAfterMovedFromFinish(kanbanItem, sprint: Sprint)\n\t{\n\t\tthis.itemsInFinishStage.delete(kanbanItem.getId());\n\n\t\tsprint.getCompletedStoryPoints().subtractPoints(kanbanItem.getStoryPoints());\n\t\tsprint.getUncompletedStoryPoints().addPoints(kanbanItem.getStoryPoints());\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() - 1);\n\t\tsprint.setUncompletedTasks(sprint.getUncompletedTasks() + 1);\n\n\t\tsprint.getItems().forEach((scrumItem: Item) => {\n\t\t\tif (scrumItem.getSourceId() === parseInt(kanbanItem.getId(), 10))\n\t\t\t{\n\t\t\t\tscrumItem.setCompleted('N');\n\n\t\t\t\tif (scrumItem.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tconst parentItem = sprint.getItemBySourceId(scrumItem.getParentTaskId());\n\t\t\t\t\tif (parentItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst subTasksItems = sprint.getItemsByParentTaskId(parentItem.getSourceId());\n\t\t\t\t\t\tconst unCompletedItem = [...subTasksItems.values()].find((item: Item) => !item.isCompleted());\n\t\t\t\t\t\tif (unCompletedItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparentItem.setCompleted('N');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowSprintBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(this.sprint);\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class BurnDownButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.BurnDownButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-xs\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ACTIVE_SPRINT_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Dom, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\n\nimport {View} from './view';\nimport {BurnDownButton} from './header/burn.down.button';\n\nimport type {Views} from './view';\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\tviews: Views,\n\tcompletedSprint: SprintParams,\n\tsprints: Array<SprintParams>\n}\n\nexport class CompletedSprint extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.CompletedSprint');\n\n\t\tthis.setParams(params);\n\n\t\tthis.bindHandlers();\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderSprintStatsTo(container);\n\n\t\tthis.titleContainer = container;\n\t\tthis.titleContainer.textContent = Text.encode(this.completedSprint.getName());\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderButtonsTo(container);\n\n\t\tconst burnDownButton = new BurnDownButton();\n\t\tburnDownButton.subscribe('click', this.onShowSprintBurnDownChart.bind(this));\n\n\t\tDom.append(burnDownButton.render(), container);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.completedSprint = new Sprint(params.completedSprint);\n\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.sprints = new Map();\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t});\n\t\tthis.views = params.views;\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEventEmitter.subscribe('onTasksGroupSelectorChange', this.onSprintSelectorChange.bind(this));\n\t}\n\n\tonSprintSelectorChange(event: BaseEvent)\n\t{\n\t\tconst [currentSprint] = event.getCompatData()\n\n\t\tthis.completedSprint = this.findSprintBySprintId(currentSprint.sprintId);\n\n\t\tthis.titleContainer.textContent = Text.encode(currentSprint.name);\n\t}\n\n\tonShowSprintBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(this.completedSprint);\n\t}\n\n\tfindSprintBySprintId(sprintId: number): Sprint\n\t{\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === parseInt(sprintId, 10));\n\t}\n}","import {View} from './view/view';\nimport {Plan} from './view/plan';\nimport {ActiveSprint} from './view/active.sprint';\nimport {CompletedSprint} from './view/completed.sprint';\n\ntype Params = {\n\tviewName: string\n}\n\nexport class Entry\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.setParams(params);\n\n\t\tthis.buildView(params);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.setViewName(params.viewName);\n\t}\n\n\tsetViewName(viewName: string)\n\t{\n\t\tconst availableViews = new Set([\n\t\t\t'plan',\n\t\t\t'activeSprint',\n\t\t\t'completedSprint'\n\t\t]);\n\n\t\tif (!availableViews.has(viewName))\n\t\t{\n\t\t\tthrow Error('Invalid value to activeView parameter');\n\t\t}\n\n\t\tthis.viewName = viewName;\n\t}\n\n\tgetViewName(): string\n\t{\n\t\treturn this.viewName;\n\t}\n\n\tsetView(view: View)\n\t{\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.view = view;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.view = null;\n\t\t}\n\t}\n\n\tgetView(): View\n\t{\n\t\treturn this.view;\n\t}\n\n\tbuildView(params: Params)\n\t{\n\t\tconst viewName = this.getViewName();\n\n\t\tif (viewName === 'plan')\n\t\t{\n\t\t\tthis.setView(new Plan(params));\n\t\t}\n\t\telse if (viewName === 'activeSprint')\n\t\t{\n\t\t\tthis.setView(new ActiveSprint(params));\n\t\t}\n\t\telse if (viewName === 'completedSprint')\n\t\t{\n\t\t\tthis.setView(new CompletedSprint(params));\n\t\t}\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderTo(container);\n\t\t}\n\t}\n\n\trenderTabsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderTabsTo(container);\n\t\t}\n\t}\n\n\trenderCountersTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderCountersTo(container);\n\t\t}\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderSprintStatsTo(container);\n\t\t}\n\t}\n\n\trenderButtonsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderButtonsTo(container);\n\t\t}\n\t}\n\n\topenEpicEditForm(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.openEpicEditForm(epicId);\n\t\t}\n\t}\n\n\topenEpicViewForm(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.openEpicViewForm(epicId);\n\t\t}\n\t}\n\n\tremoveEpic(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.removeEpic(epicId);\n\t\t}\n\t}\n}"],"names":["RequestSender","options","signedParameters","debugMode","action","data","Promise","resolve","reject","ajax","runAction","then","runComponentAction","mode","sendRequestToComponent","response","alertTitle","Type","isUndefined","errors","console","log","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","Filter","params","setEventNamespace","filterId","requestSender","searchFieldApplied","initUiFilterManager","bindHandlers","filterManager","BX","Main","getById","EventEmitter","subscribe","onApplyFilter","bind","getSearch","getContainer","filterSearchContainer","getSearchContainer","isNodeInViewport","scrollIntoView","event","getCompatData","values","filterInstance","promise","getSearchString","autoResolve","emit","name","item","fieldInstances","getField","fieldOptions","getFieldByName","ITEMS","push","itemsNode","node","querySelector","items","Dom","attr","value","filterApi","getApi","filterFieldsValues","getFilterFieldsValues","setFields","apply","resetFields","forEach","resetFilter","applyFilter","element","rect","getBoundingClientRect","top","left","bottom","window","innerHeight","document","documentElement","clientHeight","right","innerWidth","clientWidth","PullCounters","filterService","userId","groupId","comment_read_all","onCommentsReadAll","GROUP_ID","Counters","filter","isOwnerCurrentUser","parseInt","getFilterManager","updateFields","bindEvents","subscribeToPull","onFilterApply","onCounterClick","Pull","fields","baseEvent","getData","counter","toggleByField","filterField","filterValue","field","Object","keys","includes","isArray","isFilteredByField","isFilteredByFieldValue","extendFilter","getFilterFields","getAttribute","getFields","deleteField","Tabs","views","planTabActiveClass","active","activeTabActiveClass","completedTabActiveClass","Tag","render","url","Text","encode","View","scrumManager","container","isDomNode","Error","tabs","append","TeamSpeedButton","Event","onClick","DiskManager","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","attachedIds","controlId","getRandom","popup","Popup","content","getAttachmentsLoaderContent","autoHide","closeByEsc","angle","show","Disk","UF","add","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","close","filesChooser","addCustomEvent","onFileUploadSuccess","fileResult","uf","file","uploaderFile","element_id","toString","ActionsPanel","actionPanelNodeId","bindElement","itemList","task","activity","attachment","dod","move","sprint","backlog","tags","epic","decomposition","remove","listBlockBlurNodes","Set","getElementById","actionsPanelContainer","calculatePanelPosition","createActionPanel","setBlockBlurNode","body","customBlur","hasNode","blockBlurNode","contains","target","unbind","bindItems","actionsPanel","hasClass","lastElementChild","Boolean","showTaskActionButtonNodeId","showAttachmentActionButtonNodeId","showDodActionButtonNodeId","showMoveActionButtonNodeId","sprintActionButtonNodeId","backlogActionButtonNodeId","tagsActionButtonNodeId","epicActionButtonNodeId","decompositionActionButtonNodeId","removeActionButtonNodeId","callback","panel","position","getPosition","fakePanel","cloneNode","style","visibility","isPanelWiderThanViewport","fakePanelRect","windowWidth","zIndex","TaskCounts","setItemId","itemId","setAttachedFilesCount","attachedFilesCount","setCheckListComplete","checkListComplete","setCheckListAll","checkListAll","setTaskCounters","taskCounters","isInteger","isString","count","taskCounter","color","indicatorsNodeId","indicatorsNode","attachmentNode","checklistNode","commentsNode","updateVisibility","firstElementChild","textContent","commentCounter","innerCommentCounter","className","showNode","hideNode","StoryPoints","clearPoints","differencePoints","storyPoints","saveDifferencePoints","String","isNaN","parseFloat","currentStoryPoints","inputStoryPoints","result","isFloat","toFixed","firstPoints","secondPoints","Item","setItemParams","groupMode","previewMode","setItemNode","setTmpId","tmpId","setName","setItemType","itemType","setSort","sort","setEntityId","entityId","setEntityType","entityType","setParentId","parentId","setSourceId","sourceId","setInfo","info","setParentTask","isParentTask","setSubTasksCount","subTasksCount","setLinkedTask","isLinkedTask","setParentTaskId","parentTaskId","setSubTask","isSubTask","setSubTasksInfo","subTasksInfo","setResponsible","responsible","setCompleted","completed","setDisableStatus","isCompleted","setAllowedActions","allowedActions","setEpic","setTags","setTaskCounts","setStoryPoints","isNodeCreated","getItemNode","dataset","nameNode","type","setPreviousSort","previousSort","has","isPlainObject","updateResponsible","setPoints","updateStoryPointsNode","getSubTasksInfo","map","subTaskInfo","addPoints","getPoints","storyPointsNode","getStoryPoints","sendEventToUpdateStoryPoints","newSubTasksInfo","hasOwnProperty","updateCompletedStatus","parentTask","linkedTask","id","subTask","taskCounts","borderColor","setBorderColor","getBorderColor","nameTextNode","disableStatus","moveActivity","status","groupModeContainer","groupModeCheckbox","checked","toggleClass","classList","showActionsPanel","deactivateDragNDrop","removeClass","unbindAll","activateDragNDrop","previewItem","Runtime","clone","itemNode","activatePreviewMode","decompositionMode","addClass","HTMLElement","e","tmpItem","getName","getEntityId","getResponsible","getTaskCounts","updateIndicators","getAttachedFilesCount","getCheckListComplete","getCheckListAll","getTaskCounters","getParentId","setEpicAndTags","getEpic","getTags","getInfo","getSubTasksCount","getParentTaskId","updateParentTaskNodes","itemClassName","renderName","renderIndicators","renderSubTasksCounter","renderResponsible","renderStoryPoints","renderSubTasksTick","renderTags","subTasksCounter","isPreviewMode","getEntityType","subTasksTick","isDecompositionMode","toggle","getEpicTag","getListTagNodes","getContrastYIQ","hexcolor","Label","Color","DEFAULT","replace","r","substr","g","b","yiq","epicLabel","text","size","Size","MD","customClass","innerLabel","contrast","isGroupMode","clickToGroupModeCheckbox","tag","tagLabel","TAG_LIGHT","fill","SM","onAfterAppend","onItemClick","onNameClick","responsibleNode","onResponsibleClick","onStoryPointsClick","newCommentsCount","subTasksCounterNode","paramsNode","insertBefore","subTasksTickNode","newSubTasksTickNode","isClickOnEditableName","ignoreTagList","tagName","closest","click","isDisabled","currentTarget","dialog","Dialog","targetNode","enableSearch","context","events","hide","selectedItem","getId","getTitle","photo","src","getAvatar","entities","inviteEmployeeLink","borderNode","valueNode","trim","oldValue","contentEditable","placeCursorAtEnd","blockEnterInput","bindOnce","newValue","getItemId","getItemType","isComposing","keyCode","blur","isShown","stopPropagation","destroy","isEditAllowed","diskManager","ufDiskFilesFieldName","subscribeOnce","showAttachmentMenu","isMovable","isRemoveAllowed","confirm","messageBox","showPanel","updateTagsContainer","newContainer","tagsContainerNode","focus","selection","getSelection","range","createRange","selectNodeContents","collapse","removeAllRanges","addRange","GroupActionsButton","ListItems","entity","getInput","getItems","TagSearcher","allTags","Map","set","avatar","epicName","description","get","delete","tagsList","epicList","getCurrentActionsPanel","currentTags","selectedItems","currentTag","createTag","tagDialog","getTagSelector","getTextBoxValue","focusSearch","addTagToSearcher","newTag","getTagFromSearcher","addItem","select","clearTextBox","selectFirstTab","label","choiceWasMade","width","height","multiple","dropdownMode","getTagsList","deselectedItem","tagSelectorOptions","onInput","selector","getDialog","footer","currentEpic","currentEpicInfo","getEpicList","epicId","setTimeout","getSelectedItems","placeholder","inputObject","enteredHashTagName","input","getInputNode","tagsDialog","getNodeId","getNode","offsetWidth","selectedHashTag","hashTags","getHashTagNamesFromText","enteredHashTag","pop","RegExp","deselect","setTagsSearchMode","search","enteredHashEpicName","epicDialog","selectedHashEpic","epicRegExp","setEpicId","setEpicSearchMode","inputText","regex","tagRegExp","matches","match","exec","substring","Input","nodeId","disabled","setNode","onTagSearch","onEpicSearch","onKeydown","inputNode","enteredHashTags","isTagsSearchMode","enteredHashEpics","getHashEpicNamesFromText","isEpicSearchMode","onCreateTaskItem","Entity","setEntityParams","groupModeItems","groupActionsButton","listItems","setId","setViews","setNumberTasks","numberTasks","exactSearchApplied","isExactSearchApplied","pageNumberItems","onActivateGroupMode","onDeactivateGroupMode","listItemsNode","getListItemsNode","querySelectorAll","newItem","subscribeToItem","setItemMoveActivity","setMoveActivity","unsubscribeAll","getTarget","parentItem","getItemBySourceId","updateSubTasksPoints","getSourceId","button","getGroupModeItems","groupModeItem","removeItem","removeYourself","addItemToGroupMode","removeItemFromGroupMode","find","hasInput","nextElementSibling","isEqualNode","deactivateGroupMode","disable","unDisable","clear","loader","setActiveLoadItems","IntersectionObserver","observer","entries","isIntersecting","isActiveLoadItems","threshold","observe","activeLoadItems","listPosition","itemsLoaderNode","Loader","offset","Header","getNumberTasks","getElementByClassName","parentNode","elements","elem","EpicCreationButton","Backlog","setBacklogParams","header","epicCreationButton","itemData","bindItemsLoader","updateNumberTasks","backlogData","addHeader","addEpicCreationButton","addGroupActionsButton","addListItems","SprintDate","defaultSprintDuration","getDefaultSprintDuration","isActive","renderNode","getFormattedDateStart","getFormattedDateEnd","dateStart","dateEnd","timestamp","dateStartNode","date","format","dateEndNode","parentPopup","calendar","showCalendar","bTime","bSetFocus","bHideTime","updateDateNode","Math","floor","parseDate","getTime","sendRequest","dateStartInput","dateEndInput","sprintId","weekCount","getDateStart","getDateEnd","StatsCalculator","first","second","round","StatsHeader","setSprintData","statsCalculator","weekendDaysTime","getWeekendDaysTime","headerNode","headerClass","kanbanMode","setSprintDate","setCompletedStoryPoints","getCompletedStoryPoints","setUncompletedStoryPoints","getUncompletedStoryPoints","setEndDate","sprintDate","completedStoryPoints","uncompletedStoryPoints","endDate","Date","now","CompletedStatsHeader","percentage","calculatePercentage","completedDate","getCompletedDate","getEndDate","getSprintDate","getFormattedTitleDatePeriod","ExpiredStatsHeader","expiredDay","getExpiredDay","ActiveStatsHeader","remainingDays","getRemainingDays","dateWithWeekendOffset","setSeconds","getSeconds","setHours","msPerMinute","msPerHour","msPerDay","daysRemaining","StatsHeaderBuilder","isExpired","SprintHeader","statsHeader","buttonClass","buttonText","buttonNode","hideContent","isPlanned","addHeaderStats","build","addHeaderDate","firstChild","replaceWith","renderParams","renderDragnDrop","renderRemove","tickAngleClass","renderStatsHeader","createDate","createButton","updateStats","updateDateStartNode","updateDateEndNode","buttonNodeId","onButtonClick","editButtonNode","removeNode","tickButtonNode","sprintHeader","EventsHeader","StoryPointsHeader","inWorkStoryPointsNode","doneStoryPointsNode","renderBurnDownChartIcon","Sprint","setSprintParams","eventsHeader","storyPointsHeader","setDateStart","setDateEnd","setWeekendDaysTime","setDefaultSprintDuration","setStatus","setCompletedTasks","completedTasks","setUncompletedTasks","uncompletedTasks","setItems","initStyle","onChangeName","onRemoveSprint","onChangeSprintDeadline","toggleVisibilityContent","getStatus","sprintEnd","updateNameNode","itemParams","sprintGoal","epics","availableStatus","tmpSprint","addStoryPointsHeader","renderLinkToCompletedSprint","getViews","completedSprint","getCompletedTasks","getUncompletedTasks","createInput","setSelectionRange","requestData","getContentNode","display","showContent","upTick","downTick","isEmpty","showSprint","hideSprint","updateStatsHeader","sprintData","addSprintHeader","buildHeader","addEventsHeader","SidePanel","sidePanelManager","Instance","contentSidePanelManager","Manager","contentSidePanels","sliderEvent","sidePanel","getSlider","setCacheable","getUrl","resetBodyWidthHack","addEscapePressHandler","currentSidePanel","manager","getPreviousSlider","contentSidePanel","getTopSlider","reload","previousSidePanel","open","applyBodyWidthHack","removeEscapePressHandler","frameWindow","getFrameWindow","addEventListener","handleFrameKeyDown","removeEventListener","existFrameTopSlider","BurnDownChart","chartDiv","am4core","useTheme","am4themes_animated","chart","create","am4charts","XYChart","paddingRight","createAxises","createIdealLine","createRemainLine","createLegend","categoryAxis","xAxes","CategoryAxis","renderer","grid","template","location","dataFields","category","minGridDistance","valueAxis","yAxes","ValueAxis","min","lineSeries","series","LineSeries","stroke","strokeWidth","categoryX","valueY","circleColor","circleBullet","CircleBullet","circle","radius","bullets","segment","segments","hoverState","states","properties","legend","Legend","itemContainers","clickable","on","processOver","dataItem","dataContext","processOut","hoveredLine","toFront","each","setState","bulletsContainer","dispose","SprintSidePanel","sprints","currentSprint","uncompletedItems","lastCompletedSprint","getLastCompletedSprint","sidePanelId","onLoadStartPanel","openSidePanel","contentCallback","buildStartPanel","onLoadCompletePanel","buildCompletePanel","onLoadSprintBurnDownPanel","onCloseBurnDownChart","buildBurnDownPanel","differenceStoryPoints","getDifferenceStoryPointsBetweenSprints","getEpics","form","onLoadStartButtons","buttonsContainer","onStartSprint","buildSprintGoal","buildSprintActions","buildSprintPlan","sprintInfo","listSprintsOptions","getUncompletedItems","getPreviewVersion","differencePercentage","getDifferencePercentageBetweenSprints","percentageNodeClass","absoluteValue","abs","speedInfoMessage","renderSpeed","itemsContainer","onLoadCompleteButtons","onCompleteSprint","showLoader","getBurnDownChartData","closeLoader","burnDownChart","createChart","destroyBurnDownChart","firstSprint","secondSprint","difference","firstPercentage","secondPercentage","getSprintStartButtons","html","getSprintCompleteButtons","getRequestDataToGetBurnDownChartData","getStartButtons","buttonsHtml","getCompleteButtons","startSprint","getRequestDataToStartSprint","href","catch","removeClockIconFromButton","showErrorAlert","completeSprint","getRequestDataToCompleteSprint","Confetti","fire","particleCount","spread","origin","x","y","getZindex","directionSelectNode","direction","EntityStorage","entityFrom","recalculateItemsSort","backlogItems","ItemStyleDesigner","entityStorage","listAllUsedColors","updateBorderColorForLinkedItems","itemIdsToUpdateColor","getAllItems","getAllUsedColors","getRandomColor","getAllColors","updateBorderColorToLinkedItems","fromEntries","updatedItems","findItemByItemId","colorPicker","getColorPicker","allColors","getDefaultColors","defaultColors","randomColor","random","isThisBorderColorAlreadyUse","isAlreadyUse","usedColor","entityIds","getAllEntities","getAllUsedItemBorderColors","ColorPicker","DomBuilder","pageNumberToCompletedSprints","scrumContainer","getBacklog","renderSprintsContainer","getSprints","sprintCreatingButtonNode","sprintCreatingButtonNodeId","sprintCreatingDropZoneNode","sprintCreatingDropZoneNodeId","sprintListNode","sprintListNodeId","createSprint","setDraggable","draggableItems","Draggable","draggable","dragElement","DROP_PREVIEW","delay","dragEndEvent","showDropZoneForSprintCreating","hideDropZoneForSprintCreating","draggableSprints","createCreatingButton","createCreatingDropZone","createSprintsList","sprintsNode","completedSprintLoader","bindLoadCompletedSprints","isSprintSourceEntity","dropZoneNode","getSprintCreatingDropZoneNode","sourceContainer","sourceEntityId","sourceEntity","findEntityByEntityId","isActiveLoadCompletedSprints","onLoadCompletedSprints","pageNumber","getCompletedSprints","createSprints","buildSprint","addSprint","countSprints","children","addContainer","current","newItemNode","bindItemNode","parentElement","SubTasksManager","domBuilder","listSubTasks","visibilityList","hideSubTaskItems","showSubTaskItems","toggleSubTasksTick","getSubTaskItems","taskId","listItemParams","listSubTaskItems","subTaskItem","buildSubTaskItem","parentItemNode","setItem","appendItemAfterItem","setVisibility","cleanVisibility","Decomposition","itemStyleDesigner","subTasksCreator","setPlaceholder","addDecomposedItem","isBacklogDecomposition","onDecomposeItem","toggleSubTasks","lastSubTask","getSubTasks","targetItemNode","insertAfter","onCreateItem","isFirstDecomposition","cleanSubTasks","deactivateDecompositionMode","Array","from","decomposedItems","getDecomposedItems","lastDecomposedItem","subTasks","activateDecompositionMode","saveSelectedResponsible","getRandomColorForItemBorder","getParentItem","iterator","next","ItemType","setDodRequired","dodRequired","TypeStorage","types","typeStorage","tabNodes","activeType","previousType","setActiveType","getNextType","sidebarClass","getTypes","renderTab","isEmptyType","addNode","createType","tabClass","isActiveType","tabNode","edit","switchType","changeTypeName","removeType","newType","tmpType","typeNode","savePrevious","setPreviousType","getActiveType","emptyType","Settings","onSwitchType","onCreateType","onChangeTypeName","onRemoveType","addEmptyCreationType","buildEmptyForm","buildEditingForm","renderRequiredOption","checkbox","isDodRequired","updateActiveType","cleanTypeForm","renderEditingForm","listContainer","getDodChecklist","renderEmptyForm","getPreviousType","saveSettings","getSort","createdType","addType","nextType","switchToType","inputType","saveDodSettings","requiredOption","getRequiredOptionValue","getChecklistItems","Tasks","CheckListInstance","treeStructure","getTreeStructure","getRequestData","clean","setEmptyType","DodSidePanel","onLoadSettingsPanel","onCloseSettingsPanel","buildSettingsPanel","dodSettingsRequest","getDodSettings","itemTypes","typeData","settings","renderTo","Chart","scrollbarX","Scrollbar","parent","bottomAxesContainer","createColumn","xAxis","labels","wrap","maxWidth","yAxis","ColumnSeries","paddingBottom","TeamSpeedSidePanel","onLoadTeamSpeedChartPanel","onCloseTeamSpeedChart","buildTeamSpeedPanel","getTeamSpeedChartData","teamSpeedChart","destroyChart","EntityCounters","getEntityCounters","counters","FilterHandler","fadeOutAll","filterInfo","updateExactSearchStatusToEntities","fulfill","filteredItemsData","buildItem","downSubTasksTick","updateVisibilityToEntities","fadeInAll","setExactSearchApplied","isSearchFieldApplied","fadeOut","fadeIn","Epic","tagSearcher","defaultColor","selectedColor","onLoadAddForm","buildAddForm","onLoadEditForm","buildEditForm","onLoadViewForm","buildViewForm","onBeforeGridRequest","onLoadListGrid","destroyGrid","onLoadEditor","onLoadColorPicker","onLoadAddButtons","createEpic","onAfterCreateEpic","isPreviousSidePanelExist","reloadPreviousSidePanel","openEpicsList","onLoadDescription","onLoadFiles","onLoadViewButtons","openEditForm","onLoadEditButtons","editEpic","reloadGrid","gridManager","gridId","instance","getDescriptionEditor","editorHtml","descriptionContainer","editor","LHEPostForm","getHandler","BXHtmlEditor","Get","eventNode","getEpicDescription","filesContainer","getEpicFiles","colorBlockNode","colorNode","picker","getAddEpicFormButtons","getViewEpicFormButtons","list","getEpicsList","responseData","prepareTagsList","openAddForm","getEmptyEpicListForm","eventArgs","sessid","bitrix_sessid","method","getEpicListUrl","getSignedParameters","buildFormHeader","buildFormContainerHeader","editorId","getEpicDescriptionEditor","getViewEpicFormButtonsAction","onColorSelected","backgroundColor","popupOptions","colors","oEditor","GetContent","files","getAttachmentsFiles","arFiles","controllers","fileControllers","controller","fileController","fileId","tagsContainers","tagsContainer","getTagsFromNode","getTagNode","childNodes","childNode","closeTopSidePanel","addEpicToSearcher","addItemToListTypeField","NAME","VALUE","itemEpic","oldEpicInfo","getCurrentEpic","removeEpicFromSearcher","reloadTopSidePanel","PullSprint","listIdsToSkipAdding","listIdsToSkipUpdating","listIdsToSkipRemoving","sprintAdded","onSprintAdded","sprintUpdated","onSprintUpdated","sprintRemoved","onSprintRemoved","needSkipAdd","cleanSkipAdd","createSprintNode","needSkipUpdate","cleanSkipUpdate","moveSprintToActiveListNode","moveSprintToCompletedListNode","updateYourself","needSkipRemove","cleanSkipRemove","removeSprint","getTmpId","ItemMover","entityCounters","source","hideSubTasks","endContainer","endEntityId","onItemMove","onMoveConfirm","itemNodeAfterSourceItem","findEntityByItemId","listToMove","isFirstItem","onclick","menuItem","sortedItems","sortedItemsIds","moveItemToUp","updateItemSort","sortInfo","calculateSort","getMenuWindow","isLastItem","moveItemToDown","showMoveItemMenu","entityWithInput","updateSort","updateItemsSort","updateItem","createNewSprintAndMoveItem","moveTo","moveInCurrentContainer","moveInAnotherContainer","endEntity","moveItemFromEntityToEntity","fromActiveSprint","toActiveSprint","updateEntityCounters","updateCounters","updatedItemsIds","moveToAnotherEntity","listSortInfo","isSortUpdated","updatedItemId","targetEntity","bindButton","isMoveToSprint","isNull","getSprintsAvailableForFilling","showListSprintsToMove","moveToWithGroupMode","entityTo","after","update","batchUpdateItem","entityListNode","onMoveItemUpdate","bindItemSort","isMoveFromAnotherEntity","getPreviousSort","setParentEntity","moveToSprintMenu","getPopupWindow","setBindElement","Menu","isSameSprint","addMenuItem","moveItemMenu","PullItem","itemMover","currentUserId","listToAddAfterUpdate","listIdsToSkipSorting","onCalculateSort","itemAdded","onItemAdded","itemUpdated","onItemUpdated","itemRemoved","onItemRemoved","itemSortUpdated","onItemSortUpdated","comment_add","onCommentAdd","cleanTaskCounts","setDelayedAdd","externalAdd","finally","cleanDelayedAdd","addItemToEntity","isDelayedAdd","itemsSortInfo","itemsToSort","itemsInfoToSort","needSkipSort","itemInfoToSort","targetEntityId","moveToPosition","participants","xmlId","entityXmlId","split","findItemBySourceId","getCurrentState","updateParentItem","hasTaskInFilter","isParentChangeAction","prototype","call","addTmpIdToSkipSorting","PullEpic","epicAdded","onEpicAdded","epicUpdated","onEpicUpdated","epicRemoved","onEpicRemoved","epicData","onAfterUpdateEpic","onAfterRemoveEpic","SprintMover","onSprintMove","updateSprintSort","calculateSprintSort","increment","getSprintPlannedListNode","sprintNode","sprintSort","Plan","pathToTask","defaultResponsible","activeSprintId","addBacklog","buildBacklog","pullSprint","addTmpIdToSkipAdding","subscribeToSprint","sprintMover","filterHandler","getCurrentGroupId","pullItem","getCurrentUserId","pullEpic","itemDod","ScrumDod","teamSpeedButton","onShowTeamSpeedChart","onUpdateItem","onShowTask","onMoveItem","onMoveToSprint","onRemoveItem","onChangeTaskResponsible","onOpenAddEpicForm","onOpenListEpicGrid","onOpenDefinitionOfDone","onAttachFilesToTask","onShowDod","onShowTagSearcher","onShowEpicSearcher","onStartDecomposition","onTagsSearchOpen","onTagsSearchClose","onEpicSearchOpen","onEpicSearchClose","onFilterByEpic","onFilterByTag","onLoadItems","onMoveToBacklog","onChangeSprintName","onGetSprintCompletedItems","onShowSprintBurnDownChart","onToggleSubTasks","inputValue","createItem","addTmpIdsToSkipAdding","fillItemBeforeCreation","getEpicId","sendRequestToCreateTask","fillItemAfterCreation","updateData","addIdToSkipUpdating","isStoryPointsUpdated","addIdToSkipRemoving","batchRemoveItem","moveItem","changeTaskResponsible","sprintSidePanel","showStartSidePanel","showCompleteSidePanel","changeSprintName","changeSprintDeadline","getSprintCompletedItems","itemsData","showBurnDownChart","openSidePanelByUrl","attachFilesToTask","skipNotificationPopups","showList","actionsPanelButton","showTagsDialog","innerBaseEvent","tasks","batchAttachTagToTask","attachTagToTask","batchDeattachTagToTask","splice","indexOf","deAttachTagToTask","showEpicDialog","batchUpdateItemEpic","updateItemEpic","getLastDecomposedItemNode","addSubTask","decomposeItem","showTagsSearchDialog","closeTagsSearchDialog","currentValue","getValueFromField","setValueToField","scrollToSearchContainer","showEpicSearchDialog","closeEpicSearchDialog","activateGroupMode","showItemsLoader","getPageNumberItems","incrementPageNumberItems","createItemsInEntity","teamSpeedSidePanel","showTeamSpeedChart","updatedEpicInfo","showSettingsPanel","valueWithoutTags","createTask","inputEpic","getEpicByName","openViewForm","epicInfo","ActiveSprintActionButton","completeSprintButtonNode","menuButtonNode","onCompleteSprintClick","onMenuClick","menu","RobotButton","isTaskLimitsExceeded","canUseAutomation","isShowLimitSidePanel","UI","InfoHelper","ActiveSprint","setParams","existActiveSprint","finishStatus","getActiveSprintParams","itemsInFinishStage","setKanbanStyle","robotButton","isCanUseAutomation","activeSprintActionButton","setPathToTask","setActiveSprintParams","activeSprint","setTaskLimitsExceeded","taskLimitExceeded","setCanUseAutomation","limitExceeded","kanbanManager","Scrum","Kanban","bindKanbanHandlers","getKanban","getKanbansGroupedByParentTasks","kanban","onKanbanRender","kanbanItem","targetColumn","beforeItem","onItemMoved","getPathToTask","kanbanGrid","getColumn","getType","updateStatsAfterMovedToFinish","updateStatsAfterMovedFromFinish","subtractPoints","scrumItem","subTasksItems","getItemsByParentTaskId","unCompletedItem","BurnDownButton","CompletedSprint","titleContainer","burnDownButton","onSprintSelectorChange","findSprintBySprintId","Entry","buildView","setViewName","viewName","availableViews","view","getViewName","setView","getView","renderTabsTo","renderCountersTo","renderSprintStatsTo","renderButtonsTo","openEpicEditForm","openEpicViewForm","removeEpic"],"mappings":"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"}