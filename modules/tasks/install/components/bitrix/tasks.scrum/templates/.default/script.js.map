{"version":3,"file":"script.js","sources":["src/utility/request.sender.js","src/item/task/actions.panel.js","src/service/disk.manager.js","src/item/task/taskcounts.js","src/utility/story.points.js","src/item/item.js","src/utility/tag.searcher.js","src/utility/input.js","src/entity/group.actions.button.js","src/entity/list.items.js","src/entity/entity.js","src/entity/sprint/sprint.date.js","src/utility/stats.calculator.js","src/entity/sprint/stats.header.js","src/entity/sprint/completed.stats.header.js","src/entity/sprint/expired.stats.header.js","src/entity/sprint/active.stats.header.js","src/entity/sprint/stats.header.builder.js","src/entity/sprint/sprint.header.js","src/entity/sprint/events.header.js","src/entity/sprint/story.points.header.js","src/entity/sprint/sprint.js","src/service/side.panel.js","src/utility/burn.down.chart.js","src/entity/sprint/sprint.side.panel.js","src/view/active.sprint.js","src/entity/backlog/header.js","src/entity/backlog/epic.creation.button.js","src/entity/backlog/backlog.js","src/item/epic/epic.js","src/item/task/decomposition.js","src/service/filter.js","src/utility/team.speed.chart.js","src/utility/project.side.panel.js","src/view/plan.js","src/view/completed.sprint.js","src/entry.js"],"sourcesContent":["import {ajax, Loc, Type} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tconstructor(options = {})\n\t{\n\t\tthis.signedParameters = (options.signedParameters ? options.signedParameters : '');\n\t\tthis.debugMode = options.debugMode;\n\t}\n\n\tgetSignedParameters(): string\n\t{\n\t\treturn this.signedParameters;\n\t}\n\n\tsendRequest(data = {}, action): Promise\n\t{\n\t\tdata.debugMode = this.debugMode;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runComponentAction('bitrix:tasks.scrum', action, {\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tbatchUpdateItem(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'batchUpdateItem');\n\t}\n\n\tbatchRemoveItem(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'batchRemoveItem');\n\t}\n\n\tupdateItemSort(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'updateItemSort');\n\t}\n\n\tupdateSprintSort(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'updateSprintSort');\n\t}\n\n\tcreateSprint(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'createSprint');\n\t}\n\n\tstartSprint(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'startSprint');\n\t}\n\n\tcompleteSprint(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'completeSprint');\n\t}\n\n\tcreateTask(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'createTask');\n\t}\n\n\tupdateItem(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'updateItem');\n\t}\n\n\tremoveItem(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'removeItem');\n\t}\n\n\tchangeTaskResponsible(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'changeTaskResponsible');\n\t}\n\n\tremoveSprint(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'removeSprint');\n\t}\n\n\tchangeSprintName(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'changeSprintName');\n\t}\n\n\tchangeSprintDeadline(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'changeSprintDeadline');\n\t}\n\n\tgetSprintCompletedItems(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getSprintCompletedItems');\n\t}\n\n\tgetEpicDescriptionEditor(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getEpicDescriptionEditor');\n\t}\n\n\tgetEpicDescription(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getEpicDescription');\n\t}\n\n\tgetEpicFiles(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getEpicFiles');\n\t}\n\n\tgetAddEpicFormButtons(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getAddEpicFormButtons');\n\t}\n\n\tgetViewEpicFormButtonsAction(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getViewEpicFormButtons');\n\t}\n\n\tcreateEpic(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'createEpic');\n\t}\n\n\tgetEpicsList(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getEpicsList');\n\t}\n\n\tgetEpicListUrl(): string\n\t{\n\t\treturn '/bitrix/services/main/ajax.php?mode=class&c=bitrix:tasks.scrum&action=getEpicsList';\n\t}\n\n\tattachFilesToTask(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'attachFilesToTask');\n\t}\n\n\tattachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'attachTagToTask');\n\t}\n\n\tbatchAttachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'batchAttachTagToTask');\n\t}\n\n\tdeAttachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'deAttachTagToTask');\n\t}\n\n\tbatchDeattachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'batchDeattachTagToTask');\n\t}\n\n\tupdateItemEpic(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'updateItemEpic');\n\t}\n\n\tbatchUpdateItemEpic(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'batchUpdateItemEpic');\n\t}\n\n\tgetEpic(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getEpic');\n\t}\n\n\teditEpic(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'editEpic');\n\t}\n\n\tremoveEpic(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'removeEpic');\n\t}\n\n\tapplyFilter(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'applyFilter');\n\t}\n\n\tgetSprintStartButtons(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getSprintStartButtons');\n\t}\n\n\tgetSprintCompleteButtons(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getSprintCompleteButtons');\n\t}\n\n\tgetBurnDownChartData(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getBurnDownChartData');\n\t}\n\n\tgetTeamSpeedChartData(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getTeamSpeedChartData');\n\t}\n\n\tgetDodPanelData(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getDodPanelData');\n\t}\n\n\tgetDodComponent(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getDodComponent');\n\t}\n\n\tgetDodButtons(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'getDodButtons');\n\t}\n\n\tsaveDod(data): Promise\n\t{\n\t\treturn this.sendRequest(data, 'saveDod');\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.log(response);\n\t\t\treturn;\n\t\t}\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Dom, Event, Loc, Tag} from 'main.core';\n\nimport '../../css/actions-panel.css';\n\nexport class ActionsPanel\n{\n\tconstructor(options)\n\t{\n\t\tthis.actionPanelNodeId = 'tasks-scrum-actions-panel';\n\n\t\tthis.bindElement = options.bindElement;\n\n\t\tthis.itemList = {...{\n\t\t\ttask: {activity: false},\n\t\t\tattachment: {activity: false},\n\t\t\tmove: {activity: false},\n\t\t\tsprint: {activity: false},\n\t\t\tbacklog: {activity: false},\n\t\t\ttags: {activity: false},\n\t\t\tepic: {activity: false},\n\t\t\tdecomposition: {activity: false},\n\t\t\tremove: {activity: false},\n\t\t}, ...options.itemList};\n\n\t\tthis.listBlockBlurNodes = new Set();\n\t}\n\n\tshowPanel()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\n\t\tconst actionsPanelContainer = this.createActionPanel();\n\t\tthis.setBlockBlurNode(actionsPanelContainer);\n\n\t\tconst position = Dom.getPosition(this.bindElement);\n\n\t\tactionsPanelContainer.style.top = `${position.top}px`;\n\t\tactionsPanelContainer.style.left = `${position.left}px`;\n\t\tactionsPanelContainer.style.width = `${position.width}px`;\n\n\t\tactionsPanelContainer.style.zIndex = 1100;\n\n\t\tDom.append(actionsPanelContainer, document.body);\n\n\t\tconst customBlur = (event) => {\n\t\t\tlet hasNode = false;\n\t\t\tthis.listBlockBlurNodes.forEach((blockBlurNode) => {\n\t\t\t\tif (blockBlurNode.contains(event.target))\n\t\t\t\t{\n\t\t\t\t\thasNode = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!hasNode)\n\t\t\t{\n\t\t\t\tDom.remove(actionsPanelContainer);\n\t\t\t\tEvent.unbind(document, 'click', customBlur);\n\t\t\t}\n\t\t};\n\t\tEvent.bind(document, 'click', customBlur);\n\n\t\tthis.bindItems();\n\n\t\tconst actionsPanel =  actionsPanelContainer.querySelector('.tasks-scrum-actions-panel');\n\t\tif (Dom.hasClass(actionsPanel.lastElementChild, 'tasks-scrum-actions-panel-separator'))\n\t\t{\n\t\t\tDom.remove(actionsPanel.lastElementChild);\n\t\t}\n\t}\n\n\tsetBlockBlurNode(node)\n\t{\n\t\tthis.listBlockBlurNodes.add(node);\n\t}\n\n\tisShown(): Boolean\n\t{\n\t\treturn Boolean(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tcreateActionPanel()\n\t{\n\t\tlet task = '';\n\t\tlet attachment = '';\n\t\tlet move = '';\n\t\tlet sprint = '';\n\t\tlet backlog = '';\n\t\tlet tags = '';\n\t\tlet epic = '';\n\t\tlet decomposition = '';\n\t\tlet remove = '';\n\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tthis.showTaskActionButtonNodeId = 'tasks-scrum-actions-panel-btn-task';\n\t\t\ttask = Tag.render`\n\t\t\t\t<div id=\"${this.showTaskActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-task\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TASK')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tthis.showAttachmentActionButtonNodeId = 'tasks-scrum-actions-panel-btn-attachment';\n\t\t\tattachment = Tag.render`\n\t\t\t\t<div id=\"${this.showAttachmentActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-attachment\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tthis.showMoveActionButtonNodeId = 'tasks-scrum-actions-panel-btn-move';\n\t\t\tmove = Tag.render`\n\t\t\t\t<div id=\"${this.showMoveActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-move\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tthis.sprintActionButtonNodeId = 'tasks-scrum-actions-panel-btn-sprint';\n\t\t\tsprint = Tag.render`\n\t\t\t\t<div id=\"${this.sprintActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-sprint\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_SPRINT')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tthis.backlogActionButtonNodeId = 'tasks-scrum-actions-panel-btn-backlog';\n\t\t\tbacklog = Tag.render`\n\t\t\t\t<div id=\"${this.backlogActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-backlog\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_BACKLOG')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tthis.tagsActionButtonNodeId = 'tasks-scrum-actions-panel-btn-tags';\n\t\t\ttags = Tag.render`\n\t\t\t\t<div  id=\"${this.tagsActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TAGS')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tthis.epicActionButtonNodeId = 'tasks-scrum-actions-panel-btn-epic';\n\t\t\tepic = Tag.render`\n\t\t\t\t<div  id=\"${this.epicActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_EPIC')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tthis.decompositionActionButtonNodeId = 'tasks-scrum-actions-panel-btn-decomposition';\n\t\t\tdecomposition = Tag.render`\n\t\t\t\t<div  id=\"${this.decompositionActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-decomposition\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tthis.removeActionButtonNodeId = 'tasks-scrum-actions-panel-btn-remove';\n\t\t\tremove = Tag.render`\n\t\t\t\t<div  id=\"${this.removeActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-remove\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.actionPanelNodeId}\" class=\"tasks-scrum-actions-panel-container\">\n\t\t\t\t<div class=\"tasks-scrum-actions-panel\">\n\t\t\t\t\t${task}\n\t\t\t\t\t${attachment}\n\t\t\t\t\t${move}\n\t\t\t\t\t${sprint}\n\t\t\t\t\t${backlog}\n\t\t\t\t\t${tags}\n\t\t\t\t\t${epic}\n\t\t\t\t\t${decomposition}\n\t\t\t\t\t${remove}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tbindItems()\n\t{\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showTaskActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.task.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showAttachmentActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.attachment.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showMoveActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.move.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.sprintActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.sprint.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.backlogActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.backlog.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.tagsActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.tags.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.epicActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.epic.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.removeActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.remove.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.decompositionActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.decomposition.callback\n\t\t\t);\n\t\t}\n\t}\n}","import {Loc, Tag, Text} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\n\nimport '../css/disk.manager.css';\n\nexport class DiskManager extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DiskManager');\n\n\t\tthis.diskUrls = {\n\t\t\turlSelect: '/bitrix/tools/disk/uf.php?action=selectFile&SITE_ID=' + Loc.getMessage('SITE_ID'),\n\t\t\turlRenameFile: '/bitrix/tools/disk/uf.php?action=renameFile',\n\t\t\turlDeleteFile: '/bitrix/tools/disk/uf.php?action=deleteFile',\n\t\t\turlUpload: '/bitrix/tools/disk/uf.php?action=uploadFile&ncc=1'\n\t\t};\n\n\t\tthis.attachedIds = [];\n\t}\n\n\tshowAttachmentMenu(node)\n\t{\n\t\tconst controlId = Text.getRandom();\n\n\t\tthis.popup = new Popup(\n\t\t\t`disk-manager-attachment-menu-${Text.getRandom()}`,\n\t\t\tnode,\n\t\t\t{\n\t\t\t\tcontent: this.getAttachmentsLoaderContent(controlId),\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: false,\n\t\t\t});\n\n\t\tthis.popup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: controlId,\n\t\t\tcontrolName: `[${controlId}][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect: this.diskUrls.urlSelect,\n\t\t\turlRenameFile: this.diskUrls.urlRenameFile,\n\t\t\turlDeleteFile: this.diskUrls.urlDeleteFile,\n\t\t\turlUpload: this.diskUrls.urlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.popup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show']\n\t\t);\n\n\t\tEventEmitter.subscribe('onFinish', () => {\n\t\t\tthis.popup.close();\n\t\t\tthis.emit('onFinish', this.attachedIds);\n\t\t});\n\t}\n\n\tgetAttachmentsLoaderContent(controlId)\n\t{\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t<div id=\"diskuf-selectdialog-${controlId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t<div class=\"diskuf-files-block\">\n\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t<input type=\"hidden\" name=\"[${controlId}][]\" value=\"\"/>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<label for=\"file_loader_${controlId}\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${controlId}\" type=\n\t\t\t\t\t\t\t\"file\" multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.onFileUploadSuccess.bind(this));\n\t\t//todo show loader\n\n\t\treturn filesChooser;\n\t}\n\n\tonFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.attachedIds.push(fileResult.element_id.toString());\n\t}\n}","import {Dom, Tag, Text} from \"main.core\";\n\nexport class TaskCounts\n{\n\tconstructor(options)\n\t{\n\t\tthis.itemId = (options.itemId ? options.itemId : Text.getRandom());\n\n\t\tthis.attachedFilesCount = (options.attachedFilesCount ? parseInt(options.attachedFilesCount, 10) : 0);\n\t\tthis.checkListComplete = (options.checkListComplete ? parseInt(options.checkListComplete, 10) : 0);\n\t\tthis.checkListAll = (options.checkListAll ? parseInt(options.checkListAll, 10) : 0);\n\t\tthis.newCommentsCount = (options.newCommentsCount ? parseInt(options.newCommentsCount, 10) : 0);\n\t}\n\n\trenderIndicators(): ?HTMLElement|string\n\t{\n\t\tthis.indicatorsNodeId = 'tasks-scrum-item-indicators-' + this.itemId;\n\t\treturn Tag.render`\n\t\t\t<span id=\"${this.indicatorsNodeId}\" class=\"task-title-indicators\">\n\t\t\t\t<div class=\"task-attachment-counter ui-label ui-label-sm ui-label-light\">\n\t\t\t\t\t<span class=\"ui-label-inner\">${this.attachedFilesCount}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-checklist-counter ui-label ui-label-sm ui-label-light'>\n\t\t\t\t\t<span class='ui-label-inner'>${this.checkListComplete}/${this.checkListAll}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-comments-counter'>\n\t\t\t\t\t<div class='ui-counter ui-counter-success'>\n\t\t\t\t\t\t<div class='ui-counter-inner'>${this.newCommentsCount}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.indicatorsNode = document.getElementById(this.indicatorsNodeId);\n\n\t\tthis.attachmentNode = this.indicatorsNode.querySelector('.task-attachment-counter');\n\t\tthis.checklistNode = this.indicatorsNode.querySelector('.task-checklist-counter');\n\t\tthis.commentsNode = this.indicatorsNode.querySelector('.task-comments-counter');\n\n\t\tthis.updateVisibility();\n\t}\n\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (!this.indicatorsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.attachedFilesCount)\n\t\t{\n\t\t\tthis.attachedFilesCount = parseInt(data.attachedFilesCount, 10);\n\t\t\tthis.attachmentNode.firstElementChild.textContent = this.attachedFilesCount;\n\t\t}\n\t\tif (data.checkListComplete)\n\t\t{\n\t\t\tthis.checkListComplete = parseInt(data.checkListComplete, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\t\tif (data.checkListAll)\n\t\t{\n\t\t\tthis.checkListAll = parseInt(data.checkListAll, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\t\tif (data.newCommentsCount)\n\t\t{\n\t\t\tthis.newCommentsCount = parseInt(data.newCommentsCount, 10);\n\t\t\tconst innerCommentCounter = this.commentsNode.querySelector('.ui-counter-inner');\n\t\t\tinnerCommentCounter.textContent = this.newCommentsCount;\n\t\t}\n\n\t\tthis.updateVisibility();\n\t}\n\n\tupdateVisibility()\n\t{\n\t\tif (this.attachedFilesCount > 0)\n\t\t{\n\t\t\tthis.showNode(this.attachmentNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.attachmentNode);\n\t\t}\n\n\t\tif (this.checkListAll > 0)\n\t\t{\n\t\t\tthis.showNode(this.checklistNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.checklistNode);\n\t\t}\n\n\t\tif (this.newCommentsCount > 0)\n\t\t{\n\t\t\tthis.showNode(this.commentsNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.commentsNode);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'inline-flex');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}","import {Type} from 'main.core';\n\nexport class StoryPoints\n{\n\tconstructor()\n\t{\n\t\tthis.clearPoints();\n\n\t\tthis.differencePoints = 0;\n\t}\n\n\tsetPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.saveDifferencePoints((this.storyPoints ? this.storyPoints : 0), storyPoints);\n\n\t\tthis.storyPoints = String(storyPoints);\n\t}\n\n\tgetPoints(): string\n\t{\n\t\treturn String(this.storyPoints);\n\t}\n\n\taddPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStoryPoints = (this.storyPoints !== '' ? parseFloat(this.storyPoints) : 0);\n\t\tconst inputStoryPoints = parseFloat(storyPoints);\n\n\t\tthis.storyPoints = String((currentStoryPoints + inputStoryPoints));\n\t}\n\n\tsubtractPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStoryPoints = (this.storyPoints !== '' ? parseFloat(this.storyPoints) : 0);\n\t\tconst inputStoryPoints = parseFloat(storyPoints);\n\n\t\tthis.storyPoints = String((currentStoryPoints - inputStoryPoints));\n\t}\n\n\tclearPoints()\n\t{\n\t\tthis.storyPoints = '';\n\t}\n\n\tsaveDifferencePoints(firstPoints: string, secondPoints: string)\n\t{\n\t\tthis.differencePoints = 0;\n\n\t\tif (Type.isUndefined(firstPoints) || isNaN(parseFloat(firstPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isUndefined(secondPoints) || isNaN(parseFloat(secondPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfirstPoints = parseFloat(firstPoints);\n\t\tsecondPoints = parseFloat(secondPoints);\n\n\t\tthis.differencePoints = (secondPoints - firstPoints);\n\t}\n\n\tgetDifferencePoints(): number\n\t{\n\t\treturn this.differencePoints;\n\t}\n}","import {Type, Dom, Event, Tag, Text, Loc, Runtime} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {ActionsPanel} from './task/actions.panel';\nimport {Label} from 'ui.label';\nimport {DiskManager} from '../service/disk.manager';\nimport {TaskCounts} from './task/taskcounts';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {StoryPoints} from '../utility/story.points';\n\nimport '../css/item.css';\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tinfo: EpicInfoType\n}\n\ntype AllowedActions = {\n\ttask_edit: string,\n\ttask_remove: string,\n}\n\ntype Responsible = {\n\tname: string,\n\tpathToUser: string,\n\tphoto: {\n\t\tsrc: string\n\t}\n}\n\ntype itemParams = {\n\titemId: number|string,\n\tname: string,\n\titemType?: string,\n\tsort?: number,\n\tentityId?: number,\n\tentityType?: string,\n\tparentId?: number,\n\tsourceId?: number,\n\tparentSourceId?: number,\n\tstoryPoints?: string,\n\tresponsible?: Responsible,\n\tcompleted?: string,\n\tallowedActions?: AllowedActions,\n\tepic?: EpicType,\n\ttags?: Array\n};\n\n//todo single responsibility principle\nexport class Item extends EventEmitter\n{\n\tconstructor(item: itemParams = {})\n\t{\n\t\tsuper(item);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item');\n\n\t\tthis.itemId = (item.itemId ? item.itemId : Text.getRandom());\n\t\tthis.name = item.name;\n\t\tthis.itemType = item.itemType;\n\t\tthis.sort = Type.isInteger(item.sort) ? parseInt(item.sort, 10) : 0;\n\t\tthis.entityId = Type.isInteger(item.entityId) ? parseInt(item.entityId, 10) : 0;\n\t\tthis.entityType = item.entityType;\n\t\tthis.parentId = Type.isInteger(item.parentId) ? parseInt(item.parentId, 10) : 0;\n\t\tthis.sourceId = Type.isInteger(item.sourceId) ? parseInt(item.sourceId, 10) : 0;\n\t\tthis.parentSourceId = Type.isInteger(item.parentSourceId) ? parseInt(item.parentSourceId, 10) : 0;\n\n\t\tthis.storyPoints = new StoryPoints();\n\t\tthis.storyPoints.setPoints(item.storyPoints);\n\n\t\tthis.responsible = (Type.isPlainObject(item.responsible) ? item.responsible : {});\n\t\tthis.completed = (item.completed === 'Y');\n\n\t\tthis.epic = (Type.isPlainObject(item.epic) ? item.epic : null);\n\t\tthis.tags = (Type.isArray(item.tags) ? item.tags : []);\n\n\t\tthis.actionsMap = {\n\t\t\ttaskEdit: 'task_edit',\n\t\t\ttaskRemove: 'task_remove'\n\t\t};\n\t\tthis.setAllowedActions(item.allowedActions);\n\n\t\tthis.taskCounts = (this.itemType === 'task' ? new TaskCounts(item) : null); //todo create taskChild\n\n\t\tthis.itemNode = null;\n\n\t\tthis.groupMode = false;\n\t\tthis.previewMode = false;\n\t}\n\n\tsetDisableStatus(status: Boolean)\n\t{\n\t\tthis.disableStatus = status;\n\t\tif (this.itemNode)\n\t\t{\n\t\t\tif (status)\n\t\t\t{\n\t\t\t\tthis.hideNode(this.itemNode.querySelector('.tasks-scrum-dragndrop'));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showNode(this.itemNode.querySelector('.tasks-scrum-dragndrop'));\n\t\t\t}\n\t\t}\n\t}\n\n\tactivateGroupMode()\n\t{\n\t\tconst groupModeContainer = this.itemNode.querySelector('.tasks-scrum-item-group-mode-container');\n\t\tconst groupModeCheckbox = groupModeContainer.querySelector('input');\n\t\tgroupModeCheckbox.checked = false;\n\n\t\tEvent.bind(groupModeCheckbox, 'change', (event) => {\n\t\t\tDom.toggleClass(this.itemNode, 'tasks-scrum-item-group-mode');\n\t\t\tif (this.itemNode.classList.contains('tasks-scrum-item-group-mode'))\n\t\t\t{\n\t\t\t\tthis.emit('addItemToGroupMode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emit('removeItemFromGroupMode');\n\t\t\t}\n\t\t\tthis.showActionsPanel(event);\n\t\t});\n\n\t\tthis.showNode(groupModeContainer);\n\n\t\tthis.groupMode = true;\n\n\t\t// todo tmp block drag\n\t\tDom.removeClass(this.itemNode, 'tasks-scrum-item-drag');\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tif (!this.itemNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.itemNode, 'tasks-scrum-item-group-mode');\n\n\t\tconst groupModeContainer = this.itemNode.querySelector('.tasks-scrum-item-group-mode-container');\n\t\tthis.hideNode(groupModeContainer);\n\n\t\tEvent.unbindAll(groupModeContainer.querySelector('input'));\n\n\t\tthis.groupMode = false;\n\n\t\t// todo tmp block drag\n\t\tif (!this.itemNode.classList.contains('tasks-scrum-item-drag'))\n\t\t{\n\t\t\tDom.addClass(this.itemNode, 'tasks-scrum-item-drag');\n\t\t}\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\tactivatePreviewMode()\n\t{\n\t\tthis.previewMode = true;\n\t}\n\n\tisPreviewMode(): boolean\n\t{\n\t\treturn this.previewMode;\n\t}\n\n\tgetPreviewVersion(): Item\n\t{\n\t\tconst previewItem = Runtime.clone(this);\n\t\tpreviewItem.setItemId();\n\t\tpreviewItem.itemNode = null;\n\t\tif (previewItem.taskCounts)\n\t\t{\n\t\t\tpreviewItem.taskCounts = new TaskCounts(previewItem);\n\t\t}\n\t\tpreviewItem.activatePreviewMode();\n\t\treturn previewItem;\n\t}\n\n\tsetCompleted(value: boolean)\n\t{\n\t\tthis.completed = Boolean(value);\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn this.completed;\n\t}\n\n\tsetMoveActivity(value: boolean)\n\t{\n\t\tthis.moveActivity = value;\n\t}\n\n\tactivateDecompositionMode()\n\t{\n\t\tthis.decompositionMode = true;\n\t\tDom.addClass(this.itemNode, 'tasks-scrum-item-decomposition-mode');\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.decompositionMode = false;\n\t\tDom.removeClass(this.itemNode, 'tasks-scrum-item-decomposition-mode');\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn Boolean(this.disableStatus);\n\t}\n\n\tgetItemId()\n\t{\n\t\treturn this.itemId;\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tgetItemType()\n\t{\n\t\treturn this.itemType;\n\t}\n\n\tgetItemNode(): HTMLElement|null\n\t{\n\t\treturn this.itemNode;\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tthis.storyPoints.setPoints(storyPoints);\n\t}\n\n\tgetSort()\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetSort(sort)\n\t{\n\t\tthis.sort = parseInt(sort, 10);\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetParentId(parentId)\n\t{\n\t\tthis.parentId = parseInt(parentId, 10);\n\t}\n\n\tgetSourceId()\n\t{\n\t\treturn this.sourceId;\n\t}\n\n\tsetSourceId(sourceId)\n\t{\n\t\tthis.sourceId = parseInt(sourceId, 10);\n\t}\n\n\tgetParentSourceId(): Number\n\t{\n\t\treturn this.parentSourceId;\n\t}\n\n\tsetParentSourceId(sourceId)\n\t{\n\t\tthis.parentSourceId = parseInt(sourceId, 10);\n\t}\n\n\tsetParentEntity(entityId, entityType)\n\t{\n\t\tthis.entityId = entityId;\n\t\tthis.entityType = entityType;\n\t}\n\n\tgetEntityId(): Number\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tsetAllowedActions(allowedActions: AllowedActions)\n\t{\n\t\tthis.allowedActions = (Type.isPlainObject(allowedActions) ? allowedActions : {});\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.itemNode);\n\t\tthis.itemNode = null\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t<div data-item-id=\"${Text.encode(this.itemId)}\" data-sort=\"${Text.encode(this.sort)}\" class=\"tasks-scrum-item\">\n\t\t\t<div class=\"tasks-scrum-item-inner\">\n\t\t\t\t<div class=\"tasks-scrum-item-group-mode-container\">\n\t\t\t\t\t<input type=\"checkbox\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-item-name\">\n\t\t\t\t\t${this.renderName()}\n\t\t\t\t\t${(this.taskCounts && this.itemType === 'task' ? this.taskCounts.renderIndicators() : '')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-item-params\">\n\t\t\t\t\t${this.renderResponsible()}\n\t\t\t\t\t${this.renderStoryPoints()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t${this.renderTags()}\n\t\t</div>\n\t\t`;\n\t}\n\n\trenderName(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-name-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-no-border\">\n\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t${Text.encode(this.name)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderResponsible(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"ui-icon ui-icon-common-user tasks-scrum-item-responsible\"><i></i></div>`;\n\t}\n\n\trenderStoryPoints(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-story-points\">\n\t\t\t\t<div class=\"tasks-scrum-item-story-points-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-auto ui-ctl-no-border\">\n\t\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t\t${Text.encode(this.getStoryPoints().getPoints())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderTags(): ?HTMLElement|string\n\t{\n\t\tif (this.epic === null && this.tags.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEpicTag(): ?HTMLElement\n\t{\n\t\tif (this.epic === null)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst getContrastYIQ = (hexcolor) => {\n\t\t\tif (!hexcolor)\n\t\t\t{\n\t\t\t\thexcolor = Label.Color.DEFAULT;\n\t\t\t}\n\t\t\thexcolor = hexcolor.replace('#', '');\n\t\t\tconst r = parseInt(hexcolor.substr(0, 2), 16);\n\t\t\tconst g = parseInt(hexcolor.substr(2, 2), 16);\n\t\t\tconst b = parseInt(hexcolor.substr(4, 2), 16);\n\t\t\tconst yiq = ((r * 299 ) + (g* 587 ) + (b * 114)) / 1000;\n\t\t\treturn (yiq >= 128) ? 'black' : 'white';\n\t\t};\n\n\t\tconst epicLabel = new Label({\n\t\t\ttext: this.epic.name,\n\t\t\tcolor: Label.Color.DEFAULT,\n\t\t\tsize: Label.Size.MD,\n\t\t\tcustomClass: 'tasks-scrum-item-epic-label'\n\t\t});\n\t\tconst container = epicLabel.getContainer();\n\t\tconst innerLabel = container.querySelector('.ui-label-inner');\n\n\t\tconst contrast = getContrastYIQ(this.epic.info.color);\n\t\tif (contrast === 'white')\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#ffffff');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#525c69');\n\t\t}\n\t\tDom.style(container, 'backgroundColor', this.epic.info.color);\n\n\t\tEvent.bind(container, 'click', (event) => {\n\t\t\tif (this.isGroupMode())\n\t\t\t{\n\t\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\t\tthis.showActionsPanel(event);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emit('filterByEpic', this.epic.id);\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tgetListTagNodes(): HTMLElement\n\t{\n\t\treturn this.tags.map((tag) => {\n\t\t\tconst tagLabel = new Label({\n\t\t\t\ttext: tag,\n\t\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\t\tfill: true,\n\t\t\t\tsize: Label.Size.SM,\n\t\t\t\tcustomClass: ''\n\t\t\t});\n\t\t\tconst container = tagLabel.getContainer();\n\t\t\tEvent.bind(container, 'click', (event) => {\n\t\t\t\tif (this.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\t\t\tthis.showActionsPanel(event);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.emit('filterByTag', tag);\n\t\t\t});\n\t\t\treturn container;\n\t\t});\n\t}\n\n\tonAfterAppend(container)\n\t{\n\t\tthis.itemNode = container.querySelector('[data-item-id=\"'+this.itemId+'\"]');\n\t\tif (!this.itemNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.onAfterAppend();\n\t\t}\n\n\t\tthis.updateResponsible();\n\n\t\tif (this.isPreviewMode())\n\t\t{\n\t\t\tEvent.bind(this.itemNode, 'click', () => this.emit('showTask'));\n\t\t\treturn;\n\t\t}\n\n\t\t// todo tmp block drag\n\t\tif (!this.itemNode.classList.contains('tasks-scrum-item-drag'))\n\t\t{\n\t\t\tDom.addClass(this.itemNode, 'tasks-scrum-item-drag');\n\t\t}\n\n\t\tEvent.unbindAll(this.itemNode);\n\t\tEvent.bind(this.itemNode, 'click', this.onItemClick.bind(this));\n\n\t\tconst nameNode = this.itemNode.querySelector('.tasks-scrum-item-name');\n\t\tEvent.unbindAll(nameNode);\n\t\tEvent.bind(nameNode, 'click', this.onNameClick.bind(this));\n\n\t\tconst responsibleNode = this.itemNode.querySelector('.tasks-scrum-item-responsible');\n\t\tEvent.unbindAll(responsibleNode);\n\t\tEvent.bind(responsibleNode, 'click', this.onResponsibleClick.bind(this));\n\n\t\tconst storyPointsNode = this.itemNode.querySelector('.tasks-scrum-item-story-points');\n\t\tEvent.unbindAll(storyPointsNode);\n\t\tEvent.bind(storyPointsNode, 'click', this.onStoryPointsClick.bind(this));\n\n\t\tif (this.completed)\n\t\t{\n\t\t\tconst nameTextNode = nameNode.querySelector('.ui-ctl-element');\n\t\t\tDom.style(nameTextNode, 'textDecoration', 'line-through');\n\t\t\tthis.setDisableStatus(true);\n\t\t}\n\t}\n\n\tisShowIndicators(): Boolean\n\t{\n\t\treturn Boolean(this.attachedFilesCount || this.checkListAll || this.newCommentsCount);\n\t}\n\n\tonItemClick(event)\n\t{\n\t\tif (this.isClickOnEditableName(event))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst ignoreTagList = new Set(['I', 'SPAN', 'INPUT']);\n\t\tif (ignoreTagList.has(event.target.tagName))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clickToGroupModeCheckbox();\n\n\t\tthis.showActionsPanel(event);\n\t}\n\n\tisClickOnEditableName(event): boolean\n\t{\n\t\treturn (event.target.classList.contains('ui-ctl-element') && this.allowedActions[this.actionsMap.taskEdit]);\n\t}\n\n\tonNameClick(event)\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.allowedActions[this.actionsMap.taskEdit])\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst targetNode = event.target;\n\t\tif (Dom.hasClass(targetNode, 'ui-ctl-element') && targetNode.contentEditable === 'true')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Dom.hasClass(targetNode, 'ui-ctl-element') || this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst nameNode = event.currentTarget;\n\t\tconst borderNode = nameNode.querySelector('.ui-ctl');\n\t\tconst valueNode = nameNode.querySelector('.ui-ctl-element');\n\t\tvalueNode.textContent = valueNode.textContent.trim();\n\t\tconst oldValue = valueNode.textContent;\n\n\t\tDom.addClass(this.itemNode, 'tasks-scrum-item-edit-mode');\n\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\tvalueNode.contentEditable = 'true';\n\n\t\tthis.placeCursorAtEnd(valueNode);\n\n\t\tEvent.bind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\tEvent.bindOnce(valueNode, 'blur', () => {\n\t\t\tEvent.unbind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\t\tDom.removeClass(this.itemNode, 'tasks-scrum-item-edit-mode');\n\t\t\tDom.addClass(borderNode, 'ui-ctl-no-border');\n\t\t\tvalueNode.contentEditable = 'false';\n\n\t\t\tconst newValue = valueNode.textContent.trim();\n\t\t\tif (oldValue === newValue)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emit('updateItem', {\n\t\t\t\titemId: this.itemId,\n\t\t\t\titemType: this.itemType,\n\t\t\t\tname: newValue\n\t\t\t});\n\t\t\tthis.name = newValue;\n\t\t}, true);\n\t}\n\n\tclickToGroupModeCheckbox()\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tconst groupModeContainer = this.itemNode.querySelector('.tasks-scrum-item-group-mode-container');\n\t\t\tconst groupModeCheckbox = groupModeContainer.querySelector('input');\n\t\t\tgroupModeCheckbox.click();\n\t\t}\n\t}\n\n\tonResponsibleClick(event)\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst responsibleNode = event.currentTarget;\n\n\t\tconst selector = new BX.Tasks.Integration.Socialnetwork.NetworkSelector({\n\t\t\tscope: responsibleNode,\n\t\t\tid: 'tasks-scrum-change-responsible-' + this.itemId,\n\t\t\tmode: 'user',\n\t\t\tquery: false,\n\t\t\tuseSearch: true,\n\t\t\tuseAdd: false,\n\t\t\tparent: this,\n\t\t\tpopupOffsetLeft: 10\n\t\t});\n\t\tselector.bindEvent('item-selected', (data) => {\n\t\t\tthis.responsible = {\n\t\t\t\tid: data.id,\n\t\t\t\tname: data.nameFormatted,\n\t\t\t\tphoto: {\n\t\t\t\t\tsrc: data.avatar\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.updateResponsible();\n\t\t\tselector.close();\n\t\t\tthis.emit('changeTaskResponsible');\n\t\t});\n\n\t\tselector.open();\n\t}\n\n\tonStoryPointsClick(event)\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst storyPointsNode = event.currentTarget;\n\t\tconst borderNode = storyPointsNode.querySelector('.ui-ctl');\n\t\tconst valueNode = storyPointsNode.querySelector('.ui-ctl-element');\n\t\tvalueNode.textContent = valueNode.textContent.trim();\n\t\tconst oldValue = valueNode.textContent.trim();\n\n\t\tif (valueNode.contentEditable === 'true')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\tvalueNode.contentEditable = 'true';\n\n\t\tthis.placeCursorAtEnd(valueNode);\n\n\t\tEvent.bind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\tEvent.bindOnce(valueNode, 'blur', () => {\n\t\t\tEvent.unbind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\t\tvalueNode.contentEditable = 'false';\n\n\t\t\tconst newValue = valueNode.textContent.trim();\n\t\t\tif (newValue && oldValue === newValue)\n\t\t\t{\n\t\t\t\tvalueNode.textContent = oldValue;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setStoryPoints(newValue);\n\n\t\t\tthis.emit('updateItem', {\n\t\t\t\titemId: this.itemId,\n\t\t\t\titemType: this.itemType,\n\t\t\t\tstoryPoints: newValue\n\t\t\t});\n\t\t\tthis.emit('updateStoryPoints');\n\t\t\tthis.emit('updateActiveSprintStoryPoints');\n\t\t}, true);\n\t}\n\n\tblockEnterInput(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.blur();\n\t\t\treturn;\n\t\t}\n\t};\n\n\tshowActionsPanel(event)\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown() && !this.isGroupMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t}\n\n\t\tthis.actionsPanel = new ActionsPanel({\n\t\t\tbindElement: this.itemNode,\n\t\t\titemList: {\n\t\t\t\ttask: {\n\t\t\t\t\tactivity: (this.itemType === 'task' && !this.isGroupMode()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('showTask');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tattachment: {\n\t\t\t\t\tactivity: (\n\t\t\t\t\t\t!this.disableStatus &&\n\t\t\t\t\t\tthis.allowedActions[this.actionsMap.taskEdit] &&\n\t\t\t\t\t\t!this.isGroupMode()\n\t\t\t\t\t),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tconst diskManager = new DiskManager({\n\t\t\t\t\t\t\tufDiskFilesFieldName: 'UF_TASK_WEBDAV_FILES'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.subscribeOnce('onFinish', (baseEvent) => {\n\t\t\t\t\t\t\tthis.emit('attachFilesToTask', baseEvent.getData());\n\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.showAttachmentMenu(event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tactivity: (!this.decompositionMode && this.moveActivity),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('move', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tsprint: {\n\t\t\t\t\tactivity: (!this.disableStatus && !this.decompositionMode),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('moveToSprint', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbacklog: {\n\t\t\t\t\tactivity: (this.entityType === 'sprint' && !this.decompositionMode),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('moveToBacklog');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ttags: {\n\t\t\t\t\tactivity: (!this.disableStatus && !this.decompositionMode),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showTagSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tepic: {\n\t\t\t\t\tactivity: (!this.disableStatus && !this.decompositionMode),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showEpicSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdecomposition: {\n\t\t\t\t\tactivity: (!this.disableStatus && !this.decompositionMode && !this.isGroupMode()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('startDecomposition');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tactivity: (!this.decompositionMode && this.allowedActions[this.actionsMap.taskRemove]),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tconst message = (this.isGroupMode() ? Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASKS') :\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASK'));\n\t\t\t\t\t\tMessageBox.confirm(\n\t\t\t\t\t\t\tmessage,\n\t\t\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\t\t\tthis.emit('remove');\n\t\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.actionsPanel.showPanel();\n\t}\n\n\tgetCurrentActionsPanel(): ?ActionsPanel\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown())\n\t\t{\n\t\t\treturn this.actionsPanel;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null\n\t\t}\n\t}\n\n\tsetItemId(itemId: number|string)\n\t{\n\t\tthis.itemId = (\n\t\t\tType.isInteger(itemId) ? parseInt(itemId, 10) :\n\t\t\tType.isString(itemId) ? itemId : Text.getRandom()\n\t\t);\n\t\tif (this.itemNode)\n\t\t{\n\t\t\tthis.itemNode.dataset.itemId = this.itemId;\n\t\t}\n\t}\n\n\tsetEpicAndTags(epic, tags: Array)\n\t{\n\t\tthis.epic = (Type.isPlainObject(epic) || epic === null ? epic : this.epic);\n\t\tthis.tags = (Type.isArray(tags) ? tags : this.tags);\n\n\t\tthis.updateTagsContainer();\n\t}\n\n\tsetTags(tags)\n\t{\n\t\tthis.tags = (Type.isArray(tags) ? tags : []);\n\t}\n\n\tgetTags()\n\t{\n\t\treturn this.tags;\n\t}\n\n\tgetEpic(): EpicType\n\t{\n\t\treturn this.epic;\n\t}\n\n\tgerResponsible()\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tsetResponsible(responsible: Responsible)\n\t{\n\t\tthis.responsible = responsible;\n\t\tthis.updateResponsible();\n\t}\n\n\tupdateTagsContainer()\n\t{\n\t\tconst newContainer = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst tagsContainerNode = this.itemNode.querySelector('.tasks-scrum-item-tags-container');\n\t\tif (tagsContainerNode)\n\t\t{\n\t\t\tDom.replace(tagsContainerNode, newContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newContainer, this.itemNode);\n\t\t}\n\t}\n\n\tupdateResponsible()\n\t{\n\t\tconst responsibleNode = this.itemNode.querySelector('.tasks-scrum-item-responsible');\n\n\t\tif (!responsibleNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.attr(responsibleNode, 'title', this.responsible.name);\n\t\tif (this.responsible.photo && this.responsible.photo.src)\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', 'url(\"'+this.responsible.photo.src+'\")');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', null);\n\t\t}\n\t}\n\n\tplaceCursorAtEnd(node)\n\t{\n\t\tnode.focus();\n\t\tconst selection = window.getSelection();\n\t\tconst range = document.createRange();\n\t\trange.selectNodeContents(node);\n\t\trange.collapse(false);\n\t\tselection.removeAllRanges();\n\t\tselection.addRange(range);\n\t};\n\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.updateIndicators(data);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'block');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}\n","import {Dialog} from 'ui.entity-selector';\nimport {Loc, Tag, Text, Type} from 'main.core';\nimport {Input} from './input';\nimport {EventEmitter} from 'main.core.events';\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription?: string,\n\tinfo?: EpicInfoType\n}\n\nexport class TagSearcher extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.TagSearcher');\n\n\t\tthis.allTags = new Map();\n\t}\n\n\taddTagToSearcher(tagName)\n\t{\n\t\ttagName = tagName.trim();\n\t\tthis.allTags.set('tag_' + tagName, {\n\t\t\tid: tagName,\n\t\t\tentityId: 'tag',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: tagName,\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag.svg'\n\t\t});\n\t}\n\n\taddEpicToSearcher(epic: EpicType)\n\t{\n\t\tconst epicName = epic.name.trim();\n\t\tthis.allTags.set('epic_' + epicName, {\n\t\t\tid: epic.id,\n\t\t\tentityId: 'epic',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: epicName.trim(),\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag-green.svg',\n\t\t\tname: epicName.trim(),\n\t\t\tdescription: epic.description,\n\t\t\tinfo: epic.info\n\t\t});\n\t}\n\n\tgetTagFromSearcher(name: String): Object\n\t{\n\t\treturn this.allTags.get(name);\n\t}\n\n\tremoveEpicFromSearcher(epic: Object)\n\t{\n\t\tthis.allTags.delete('epic_' + epic.name);\n\t}\n\n\tgetAllList(): Array\n\t{\n\t\treturn [...this.allTags.values()];\n\t}\n\n\tgetTagsList(): Array\n\t{\n\t\tconst tagsList = [];\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'tag')\n\t\t\t{\n\t\t\t\ttagsList.push(tag);\n\t\t\t}\n\t\t});\n\t\treturn tagsList;\n\t}\n\n\tgetEpicList(): Array\n\t{\n\t\tconst epicList = [];\n\t\t[...this.allTags.values()].forEach((epic) => {\n\t\t\tif (epic.entityId === 'epic')\n\t\t\t{\n\t\t\t\tepicList.push(epic);\n\t\t\t}\n\t\t});\n\t\treturn epicList;\n\t}\n\n\tgetEpicByName(epicName: string): EpicType|null\n\t{\n\t\tlet epic = null;\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'epic' && tag.name === epicName)\n\t\t\t{\n\t\t\t\tepic = tag;\n\t\t\t}\n\t\t});\n\t\treturn epic;\n\t}\n\n\tshowTagsDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentTags = item.getTags();\n\n\t\tconst selectedItems = [];\n\t\tcurrentTags.forEach((tag) => {\n\t\t\tconst currentTag = this.allTags.get(('tag_' + tag).trim());\n\t\t\tif (currentTag)\n\t\t\t{\n\t\t\t\tselectedItems.push(currentTag);\n\t\t\t}\n\t\t});\n\n\t\tconst createTag = () => {\n\t\t\tconst tagName = this.tagDialog.getTagSelector().getTextBoxValue();\n\t\t\tif (!tagName)\n\t\t\t{\n\t\t\t\tthis.tagDialog.focusSearch();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.addTagToSearcher(tagName);\n\t\t\tconst newTag = this.getTagFromSearcher('tag_' + tagName);\n\t\t\tconst item = this.tagDialog.addItem(newTag);\n\t\t\titem.select();\n\t\t\tthis.tagDialog.getTagSelector().clearTextBox();\n\t\t\tthis.tagDialog.focusSearch();\n\t\t\tthis.tagDialog.selectFirstTab();\n\t\t\tconst label = this.tagDialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\tlabel.textContent = '';\n\t\t};\n\n\t\tlet choiceWasMade = false;\n\n\t\tthis.tagDialog = new Dialog({\n\t\t\tid: item.getItemId(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: true,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getTagsList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst tag = selectedItem.title;\n\t\t\t\t\tthis.emit('attachTagToTask', tag);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst deselectedItem = event.getData().item;\n\t\t\t\t\tconst tag = deselectedItem.title;\n\t\t\t\t\tthis.emit('deAttachTagToTask', tag);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonInput: (event) => {\n\t\t\t\t\t\tconst selector = event.getData().selector;\n\t\t\t\t\t\tconst dialog = selector.getDialog();\n\t\t\t\t\t\tconst label = dialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\t\t\t\tlabel.textContent = Text.encode(selector.getTextBoxValue());\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tfooter: [\n\t\t\t\tTag.render`\n\t\t\t\t\t<span onclick=\"${createTag}\" class=\"ui-selector-footer-link ui-selector-footer-link-add\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SEARCHER_ACTIONS_TAG_ADD')}\n\t\t\t\t\t</span>\n\t\t\t\t`,\n\t\t\t\tTag.render`<span class=\"ui-selector-footer-conjunction\"></span>`\n\t\t\t],\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(this.tagDialog.getContainer());\n\t\tthis.tagDialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t\tthis.emit('hideTagDialog');\n\t\t\t}\n\t\t});\n\n\t\tthis.tagDialog.show();\n\t}\n\n\tshowEpicDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentEpic = item.getEpic();\n\n\t\tconst selectedItems = [];\n\t\tif (currentEpic)\n\t\t{\n\t\t\tconst currentEpicInfo = this.allTags.get(('epic_' + currentEpic.name).trim());\n\t\t\tif (currentEpicInfo)\n\t\t\t{\n\t\t\t\tselectedItems.push(currentEpicInfo);\n\t\t\t}\n\t\t}\n\n\t\tlet choiceWasMade = false;\n\n\t\tconst dialog = new Dialog({\n\t\t\tid: item.getItemId(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getEpicList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst epicId = selectedItem.id;\n\t\t\t\t\tthis.emit('updateItemEpic', epicId);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\t\tif (dialog.getSelectedItems().length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('updateItemEpic', 0);\n\t\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 50);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tplaceholder: Loc.getMessage('TASKS_SCRUM_ITEM_EPIC_SEARCHER_PLACEHOLDER')\n\t\t\t}\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(dialog.getContainer());\n\t\tdialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t}\n\t\t});\n\t\tdialog.show();\n\t}\n\n\tshowTagsSearchDialog(inputObject: Input, enteredHashTagName: String): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.tagsDialog && this.tagsDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.tagsDialog = null;\n\t\t}\n\n\t\tif (!this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getTagsList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashTag = '#' + selectedItem.title;\n\t\t\t\t\t\tconst hashTags = TagSearcher.getHashTagsFromText(input.value);\n\t\t\t\t\t\tconst enteredHashTag = (hashTags.length > 0 ? hashTags.pop().trim() : '');\n\t\t\t\t\t\tinput.value = input.value.replace(\n\t\t\t\t\t\t\tnew RegExp('#(['+enteredHashTag+']+|)(?:$)', 'g'),\n\t\t\t\t\t\t\tselectedHashTag\n\t\t\t\t\t\t);\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.tagsDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setTagsSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setTagsSearchMode(true);\n\n\t\tthis.tagsDialog.show();\n\t\tthis.tagsDialog.search(enteredHashTagName);\n\t}\n\n\tcloseTagsSearchDialog()\n\t{\n\t\tif (this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog.hide();\n\t\t}\n\t}\n\n\tshowEpicSearchDialog(inputObject: Input, enteredHashEpicName: String): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.epicDialog && this.epicDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.epicDialog = null;\n\t\t}\n\n\t\tif (!this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getEpicList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashEpic = '@' + selectedItem.title;\n\t\t\t\t\t\tinput.value = input.value.replace(new RegExp('(?:^|\\\\s)(?:@)([^\\\\s]*)','g'),'');\n\t\t\t\t\t\tinput.value = input.value + ' ' + selectedHashEpic\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t\tinputObject.setEpicId(selectedItem.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.epicDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setEpicSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setEpicSearchMode(true);\n\n\t\tthis.epicDialog.show();\n\t\tthis.epicDialog.search(enteredHashEpicName);\n\t}\n\n\tcloseEpicSearchDialog()\n\t{\n\t\tif (this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog.hide();\n\t\t}\n\t}\n\n\tcleanEpicTagsInText(inputText: String): String\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:@)(\\\\S+)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashTagsFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:#)(\\\\S+)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashEpicFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:@)(\\\\S+)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashTagNamesFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:#)(\\\\S+|)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[1]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashEpicNamesFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:@)(\\\\S+|)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[1]);\n\t\t}\n\t\treturn matches;\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {TagSearcher} from './tag.searcher';\nimport {EventEmitter} from 'main.core.events';\n\nimport '../css/input.css';\n\nexport class Input extends EventEmitter\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Input');\n\n\t\tthis.nodeId = Text.getRandom();\n\t\tthis.placeholder = Loc.getMessage('TASKS_SCRUM_TASK_ADD_INPUT_TASK_PLACEHOLDER');\n\n\t\tthis.epicId = 0;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${Text.encode(this.nodeId)}\" class=\"tasks-scrum-input\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox\">\n\t\t\t\t\t<input type=\"text\" class=\"ui-ctl-element\" placeholder=\n\t\t\t\t\t\t\"${Text.encode(this.placeholder)}\" autocomplete=\"off\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdisable()\n\t{\n\t\tthis.node.querySelector('input').disabled = true;\n\t}\n\n\tunDisable()\n\t{\n\t\tthis.node.querySelector('input').disabled = false;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.setNode();\n\n\t\tEvent.bind(this.getInputNode(), 'input', (event) => {\n\t\t\tthis.onTagSearch(event);\n\t\t\tthis.onEpicSearch(event);\n\t\t});\n\t\tEvent.bind(this.getInputNode(), 'keydown', this.onKeydown.bind(this));\n\t}\n\n\tsetNode()\n\t{\n\t\tthis.node = document.getElementById(this.nodeId);\n\t}\n\n\tsetPlaceholder(placeholder: String)\n\t{\n\t\tthis.placeholder = placeholder;\n\t}\n\n\tsetEpicId(parentId)\n\t{\n\t\tthis.epicId = parseInt(parentId, 10);\n\t}\n\n\tgetNode(): HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetNodeId(): String\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tgetInputNode(): HTMLElement\n\t{\n\t\treturn this.node.querySelector('input');\n\t}\n\n\tgetEpicId()\n\t{\n\t\treturn this.epicId;\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t}\n\n\tsetTagsSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-tag-disabled', value);\n\t}\n\n\tisTagsSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-tag-disabled');\n\t}\n\n\tsetEpicSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-epic-disabled', value);\n\t}\n\n\tisEpicSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-epic-disabled');\n\t}\n\n\tonTagSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashTags = TagSearcher.getHashTagNamesFromText(inputNode.value);\n\t\tif (event.data === '#')\n\t\t{\n\t\t\tthis.setEpicSearchMode(false);\n\t\t\tthis.setTagsSearchMode(true);\n\t\t}\n\t\tif (enteredHashTags.length > 0 && this.isTagsSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashTags.pop().trim();\n\t\t\tthis.emit('tagsSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('tagsSearchClose');\n\t\t}\n\t}\n\n\tonEpicSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashEpics = TagSearcher.getHashEpicNamesFromText(inputNode.value);\n\t\tif (event.data === '@')\n\t\t{\n\t\t\tthis.setTagsSearchMode(false);\n\t\t\tthis.setEpicSearchMode(true);\n\t\t}\n\t\tif (enteredHashEpics.length > 0 && this.isEpicSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashEpics.pop().trim();\n\t\t\tthis.emit('epicSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('epicSearchClose');\n\t\t}\n\t}\n\n\tonCreateTaskItem()\n\t{\n\t\tif (!this.isTagsSearchMode() && !this.isEpicSearchMode())\n\t\t{\n\t\t\tconst input = this.getInputNode();\n\t\t\tif (input.value)\n\t\t\t{\n\t\t\t\tthis.emit('createTaskItem', input.value);\n\t\t\t\tinput.value = '';\n\t\t\t\tinput.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tonKeydown(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.onCreateTaskItem();\n\t\t}\n\t}\n}","import {Dom, Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class GroupActionsButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.GroupActionsButton');\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-group-actions\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_GROUP')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(this.element, 'click', this.onClick.bind(this, this.element));\n\n\t\treturn this.element;\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tif (this.element && this.element.classList.contains('tasks-scrum-group-actions-active'))\n\t\t{\n\t\t\tDom.toggleClass(this.element, 'tasks-scrum-group-actions');\n\t\t\tDom.toggleClass(this.element, 'tasks-scrum-group-actions-active');\n\t\t\tDom.toggleClass(this.element, 'ui-link-secondary');\n\t\t\tDom.toggleClass(this.element, 'ui-link-dashed');\n\n\t\t\tthis.emit('deactivateGroupMode');\n\t\t}\n\t}\n\n\tonClick(element: HTMLElement)\n\t{\n\t\tDom.toggleClass(element, 'tasks-scrum-group-actions');\n\t\tDom.toggleClass(element, 'tasks-scrum-group-actions-active');\n\t\tDom.toggleClass(element, 'ui-link-secondary');\n\t\tDom.toggleClass(element, 'ui-link-dashed');\n\t\tif (element.classList.contains('tasks-scrum-group-actions-active'))\n\t\t{\n\t\t\tthis.emit('activateGroupMode');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('deactivateGroupMode');\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.element);\n\t\tthis.element = null;\n\t}\n}","import {Tag} from 'main.core';\nimport {Entity} from './entity';\n\nexport class ListItems\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tthis.entity = entity;\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<div class=\"tasks-scrum-items-list\" data-entity-id=\"${this.entity.getId()}\">\n\t\t\t\t${this.entity.isCompleted() ? '' : this.entity.getInput().render()}\n\t\t\t\t${[...this.entity.getItems().values()].map((item) => item.render())}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.element;\n\t}\n\n\tgetElement(): HTMLElement|null\n\t{\n\t\treturn this.element;\n\t}\n\n\tsetEntityId(entityId: number)\n\t{\n\t\tthis.element.dataset.entityId = parseInt(entityId, 10);\n\t}\n}","import {Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Item} from '../item/item';\nimport {Input} from '../utility/input';\nimport {StoryPoints} from '../utility/story.points';\nimport {GroupActionsButton} from './group.actions.button';\nimport {ListItems} from './list.items';\n\nimport '../css/entity.css';\n\ntype entityParams = {\n\tid: number,\n\tviews: {\n\t\tplan: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tactiveSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tcompletedSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t}\n\t},\n\tnumberTasks?: number,\n};\n\nexport class Entity extends EventEmitter\n{\n\tconstructor(entityData: entityParams = {})\n\t{\n\t\tsuper(entityData);\n\n\t\tthis.id = (Type.isInteger(entityData.id) ? parseInt(entityData.id, 10) : 0);\n\n\t\tthis.views = entityData.views;\n\n\t\tthis.numberTasks = (Type.isInteger(entityData.numberTasks) ? parseInt(entityData.numberTasks, 10) : 0);\n\n\t\tthis.items = new Map();\n\n\t\tthis.groupMode = false;\n\t\tthis.groupModeItems = new Map();\n\n\t\tthis.node = null;\n\n\t\tthis.groupActionsButton = null;\n\t\tthis.listItems = null;\n\n\t\tthis.storyPoints = new StoryPoints();\n\n\t\tthis.input = new Input();\n\t}\n\n\taddGroupActionsButton(groupActionsButton: GroupActionsButton)\n\t{\n\t\tthis.groupActionsButton = groupActionsButton;\n\t\tthis.groupActionsButton.subscribe('activateGroupMode', this.onActivateGroupMode.bind(this));\n\t\tthis.groupActionsButton.subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t}\n\n\taddListItems(listItems: ListItems)\n\t{\n\t\tthis.listItems = listItems;\n\t}\n\n\tgetNode(): HTMLElement|null\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id: number)\n\t{\n\t\tthis.id = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\n\t\tif (this.listItems)\n\t\t{\n\t\t\tthis.listItems.setEntityId(this.id);\n\t\t}\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'entity';\n\t}\n\n\tisActive()\n\t{\n\t\treturn false;\n\t}\n\n\tisCompleted()\n\t{\n\t\treturn false;\n\t}\n\n\tgetListItemsNode(): HTMLElement|null\n\t{\n\t\treturn (this.listItems ? this.listItems.getElement() : null);\n\t}\n\n\tgetItems(): Map\n\t{\n\t\treturn this.items;\n\t}\n\n\tgetInput(): Input\n\t{\n\t\treturn this.input;\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tthis.items.set(newItem.getItemId(), newItem);\n\t\tthis.subscribeToItem(newItem);\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\n\t\tthis.addNumberTasks(1);\n\t}\n\n\tsetItemMoveActivity(item: Item)\n\t{\n\t\titem.setMoveActivity(this.items.size > 2);\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tif (this.items.has(item.getItemId()))\n\t\t{\n\t\t\tthis.items.delete(item.getItemId());\n\t\t\titem.unsubscribeAll();\n\t\t\t[...this.items.values()].map((item) => {\n\t\t\t\tthis.setItemMoveActivity(item);\n\t\t\t});\n\n\t\t\tthis.subtractNumberTasks(1);\n\t\t}\n\t}\n\n\tgetNumberTasks(): number\n\t{\n\t\treturn (this.numberTasks ? this.numberTasks : this.getItems().size);\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tthis.numberTasks = (Type.isInteger(numberTasks) ? parseInt(numberTasks, 10) : 0);\n\t}\n\n\taddNumberTasks(value: number)\n\t{\n\t\tif (!Type.isUndefined(value) && !isNaN(parseInt(value, 10)))\n\t\t{\n\t\t\tthis.numberTasks = (this.numberTasks + parseInt(value, 10));\n\t\t}\n\t}\n\n\tsubtractNumberTasks(value: number)\n\t{\n\t\tif (!Type.isUndefined(value) && !isNaN(parseInt(value, 10)))\n\t\t{\n\t\t\tthis.numberTasks = (this.numberTasks - parseInt(value, 10));\n\t\t}\n\t}\n\n\thasInput(): Boolean\n\t{\n\t\treturn true;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.subscribeToItem(item);\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.input.onAfterAppend();\n\t\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t\t\tthis.input.subscribe('epicSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('epicSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashEpicName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('epicSearchClose', () => this.emit('epicSearchClose'));\n\t\t\tthis.input.subscribe('createTaskItem', (baseEvent) => {\n\t\t\t\tthis.emit('createTaskItem', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tvalue: baseEvent.getData()\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.updateStoryPoints();\n\t}\n\n\tsubscribeToItem(item: Item)\n\t{\n\t\tif (!this.getListItemsNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.onAfterAppend(this.getListItemsNode());\n\n\t\titem.subscribe('updateItem', (baseEvent) => {\n\t\t\tthis.emit('updateItem', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('updateStoryPoints', () => this.updateStoryPoints());\n\n\t\titem.subscribe('showTask', (baseEvent) => this.emit('showTask', baseEvent.getTarget()));\n\n\t\titem.subscribe('move', (baseEvent) => {\n\t\t\tthis.emit('moveItem', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('moveToSprint', (baseEvent) => {\n\t\t\tthis.emit('moveToSprint', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('attachFilesToTask', (baseEvent) => {\n\t\t\tthis.emit('attachFilesToTask', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tattachedIds: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('showTagSearcher', (baseEvent) => {\n\t\t\tthis.emit('showTagSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\titem.subscribe('showEpicSearcher', (baseEvent) => {\n\t\t\tthis.emit('showEpicSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('startDecomposition', (baseEvent) => {\n\t\t\tthis.emit('startDecomposition', baseEvent.getTarget())\n\t\t});\n\n\t\titem.subscribe('remove', (baseEvent) => {\n\t\t\tif (this.isGroupMode())\n\t\t\t{\n\t\t\t\tthis.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\tthis.removeItem(groupModeItem);\n\t\t\t\t\tgroupModeItem.removeYourself();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst item = baseEvent.getTarget();\n\t\t\t\tthis.removeItem(item);\n\t\t\t\titem.removeYourself();\n\t\t\t}\n\t\t\tthis.emit('removeItem', item);\n\t\t});\n\n\t\titem.subscribe('changeTaskResponsible', (baseEvent) => {\n\t\t\tconst item = baseEvent.getTarget();\n\t\t\tthis.emit('changeTaskResponsible', item);\n\t\t});\n\n\t\titem.subscribe('filterByEpic', (baseEvent) => {\n\t\t\tthis.emit('filterByEpic', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('filterByTag', (baseEvent) => {\n\t\t\tthis.emit('filterByTag', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('addItemToGroupMode', (baseEvent) => {\n\t\t\tthis.addItemToGroupMode(baseEvent.getTarget());\n\t\t});\n\n\t\titem.subscribe('removeItemFromGroupMode', (baseEvent) => {\n\t\t\tthis.removeItemFromGroupMode(baseEvent.getTarget());\n\t\t});\n\t}\n\n\tupdateStoryPoints()\n\t{\n\t\tthis.storyPoints.clearPoints();\n\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\tthis.storyPoints.addPoints(item.getStoryPoints().getPoints());\n\t\t});\n\t}\n\n\taddTotalStoryPoints(item: Item) {}\n\n\tsubtractTotalStoryPoints(item: Item) {}\n\n\tgetItemByItemId(itemId)\n\t{\n\t\treturn this.items.get(parseInt(itemId, 10));\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tisFirstItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\tconst firstElementChild = (\n\t\t\tthis.hasInput() ? listItemsNode.firstElementChild.nextElementSibling : listItemsNode.firstElementChild\n\t\t)\n\t\treturn firstElementChild.isEqualNode(itemNode);\n\t}\n\n\tisLastItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\treturn listItemsNode.lastElementChild.isEqualNode(itemNode);\n\t}\n\n\tfadeOut()\n\t{\n\t\tthis.getListItemsNode().classList.add('tasks-scrum-entity-items-faded');\n\t}\n\n\tfadeIn()\n\t{\n\t\tthis.getListItemsNode().classList.remove('tasks-scrum-entity-items-faded');\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tthis.groupActionsButton.deactivateGroupMode();\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tthis.groupMode = true;\n\n\t\tthis.input.disable();\n\n\t\tthis.emit('activateGroupMode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tthis.groupMode = false;\n\n\t\tthis.input.unDisable();\n\n\t\tthis.groupModeItems.forEach((item: Item) => {\n\t\t\titem.deactivateGroupMode();\n\t\t});\n\t\tthis.groupModeItems.clear();\n\n\t\tthis.emit('deactivateGroupMode');\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\taddItemToGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.set(item.getItemId(), item);\n\t}\n\n\tgetGroupModeItems(): Map\n\t{\n\t\treturn this.groupModeItems;\n\t}\n\n\tremoveItemFromGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.delete(item.getItemId());\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\n\nexport class SprintDate extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintDate');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.nodeId = 'tasks-scrum-sprint-header-date-' + Text.getRandom();\n\t\tthis.defaultSprintDuration = sprint.getDefaultSprintDuration();\n\t}\n\n\tcreateDate(startTimestamp, endTimestamp)\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\t/* eslint-disable */\n\t\tconst dateStart = BX.date.format('j F', startTimestamp);\n\t\tconst dateEnd = BX.date.format('j F', endTimestamp);\n\t\t/* eslint-enable */\n\n\t\treturn this.renderNode(this.nodeId, dateStart, dateEnd);\n\t}\n\n\trenderNode(nodeId: string, dateStart: string, dateEnd: string): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${nodeId}\" class=\"tasks-scrum-sprint-date\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-start\">${dateStart}</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-separator\">-</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-end\">${dateEnd}</div>\n\t\t\t\t<input type=\"hidden\" name=\"dateStart\">\n\t\t\t\t<input type=\"hidden\" name=\"dateEnd\">\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\tdateStartNode.textContent = BX.date.format('j F', timestamp);\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\tdateEndNode.textContent = BX.date.format('j F', timestamp);\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.node = document.getElementById(this.nodeId);\n\t\tconst parentPopup = this.node.closest('.popup-window');\n\n\t\tconst customBlur = () => {\n\t\t\tBX.calendar.get().popup.close();\n\t\t};\n\n\t\tconst showCalendar = (node, field) => {\n\t\t\t/* eslint-disable */\n\t\t\tBX.calendar({\n\t\t\t\tnode: node,\n\t\t\t\tfield: field,\n\t\t\t\tbTime: false,\n\t\t\t\tbSetFocus: false,\n\t\t\t\tbHideTime: false\n\t\t\t});\n\t\t\t/* eslint-enable */\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.bindOnce(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t};\n\n\t\tconst updateDateNode = (node, value) => {\n\t\t\t/* eslint-disable */\n\t\t\tnode.textContent = BX.date.format('j F', Math.floor(BX.parseDate(value).getTime() / 1000));\n\t\t\t/* eslint-enable */\n\t\t};\n\t\tconst sendRequest = (data) => {\n\t\t\tthis.emit('changeSprintDeadline', data);\n\t\t};\n\n\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\tconst dateStartInput = this.node.querySelector('input[name=\"dateStart\"]');\n\t\tconst dateEndInput = this.node.querySelector('input[name=\"dateEnd\"]');\n\n\t\tEvent.bind(this.node, 'click', (event) => {\n\t\t\tconst target = event.target;\n\t\t\tif (target.classList.contains('tasks-scrum-sprint-date-start'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateStartInput);\n\t\t\t}\n\t\t\telse if (target.classList.contains('tasks-scrum-sprint-date-end'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateEndInput);\n\t\t\t}\n\t\t\tevent.stopPropagation();\n\t\t});\n\t\tEvent.bind(dateStartInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateStartNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateStart: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t\tEvent.bind(dateEndInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateEndNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateEnd: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetWeeks()\n\t{\n\t\tconst weekCount = (parseInt(this.defaultSprintDuration, 10) / 604800);\n\t\tif (weekCount > 5)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_3');\n\t\t}\n\t\telse if (weekCount === 1)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_2');\n\t\t}\n\t}\n}","export class StatsCalculator\n{\n\tcalculatePercentage(first: number, second: number): number\n\t{\n\t\tconst result = Math.round(second * 100 / first);\n\t\treturn (isNaN(result) ? 0 : result);\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\nimport {StatsCalculator} from '../../utility/stats.calculator';\n\nexport class StatsHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.StatsHeader');\n\n\t\tthis.setSprintData(sprint);\n\n\t\tthis.statsCalculator = new StatsCalculator();\n\n\t\tthis.headerNode = null;\n\t\tthis.headerClass = 'tasks-scrum-sprint-header-stats';\n\n\t\tthis.kanbanMode = false;\n\t}\n\n\tsetKanbanStyle()\n\t{\n\t\tthis.kanbanMode = true;\n\t\tthis.headerClass = 'tasks-scrum-sprint-header-stats-kanban';\n\t}\n\n\tisKanbanMode(): boolean\n\t{\n\t\treturn this.kanbanMode;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn '';\n\t}\n\n\tupdateStats(sprint: Sprint)\n\t{\n\t\tthis.setSprintData(sprint);\n\n\t\tDom.replace(this.headerNode, this.render());\n\t}\n\n\tsetSprintData(sprint: Sprint)\n\t{\n\t\tthis.setStoryPoints(sprint.getTotalStoryPoints().getPoints());\n\t\tthis.setCompletedStoryPoints(sprint.getTotalCompletedStoryPoints().getPoints());\n\t\tthis.setEndDate(sprint.getDateEnd());\n\t}\n\n\tsetStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.storyPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.storyPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetStoryPoints(): number\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tsetCompletedStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.completedStoryPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.completedStoryPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetCompletedStoryPoints(): number\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetEndDate(endDate)\n\t{\n\t\tif (Type.isUndefined(endDate) || isNaN(parseInt(endDate, 10)))\n\t\t{\n\t\t\tthis.endDate = (Date.now() / 1000);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.endDate = parseInt(endDate, 10);\n\t\t}\n\t}\n\n\tgetEndDate(): number\n\t{\n\t\treturn this.endDate;\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class CompletedStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tconst completedDate = this.getCompletedDate(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_COMPLETED_LABEL').\n\t\t\treplace('#percent#', '<b>' + percentage + '%</b>').\n\t\t\treplace('#date#', completedDate);\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetCompletedDate(endDate: number): string\n\t{\n\t\treturn BX.date.format('j F Y', endDate);\n\t};\n}","import {Loc, Tag} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class ExpiredStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\t\tconst expiredDay = this.getExpiredDay(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_EXPIRED_LABEL').\n\t\t\treplace('#percent#', '<b>' + percentage + '%</b>').\n\t\t\treplace('#date#', expiredDay);\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetExpiredDay(endDate: number): string\n\t{\n\t\treturn BX.date.format('j F Y', endDate);\n\t};\n}","import {Loc, Tag} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class ActiveStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst remainingDays = this.getRemainingDays(this.getEndDate());\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LABEL').\n\t\t\treplace('#days#', '<b>' + remainingDays + '</b>').\n\t\t\treplace('#percent#', '<b>' + percentage + '%</b>');\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetRemainingDays(endDate: number): string\n\t{\n\t\treturn BX.date.format('ddiff', new Date(), endDate);\n\t};\n}","import {Sprint} from './sprint';\nimport {StatsHeader} from './stats.header';\nimport {CompletedStatsHeader} from './completed.stats.header';\nimport {ExpiredStatsHeader} from './expired.stats.header';\nimport {ActiveStatsHeader} from './active.stats.header';\n\nexport class StatsHeaderBuilder\n{\n\tstatic build(sprint: Sprint): StatsHeader\n\t{\n\t\tif (sprint.isCompleted())\n\t\t{\n\t\t\treturn new CompletedStatsHeader(sprint);\n\t\t}\n\t\telse if (sprint.isExpired())\n\t\t{\n\t\t\treturn new ExpiredStatsHeader(sprint);\n\t\t}\n\t\telse if (sprint.isActive())\n\t\t{\n\t\t\treturn new ActiveStatsHeader(sprint);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn new StatsHeader(sprint);\n\t\t}\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {SprintDate} from './sprint.date';\nimport {Sprint} from './sprint';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {StatsHeaderBuilder} from './stats.header.builder';\nimport {StatsHeader} from './stats.header';\n\nexport class SprintHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintHeader');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.statsHeader = null;\n\t\tthis.sprintDate = null;\n\t}\n\n\tstatic buildHeader(sprint: Sprint): SprintHeader\n\t{\n\t\tconst sprintHeader = new SprintHeader(sprint);\n\t\tsprintHeader.addHeaderStats(StatsHeaderBuilder.build(sprint));\n\t\tsprintHeader.addHeaderDate(new SprintDate(sprint));\n\t\treturn sprintHeader;\n\t}\n\n\taddHeaderStats(statsHeader: StatsHeader)\n\t{\n\t\tthis.statsHeader = statsHeader;\n\t}\n\n\taddHeaderDate(sprintDate: SprintDate)\n\t{\n\t\tthis.sprintDate = sprintDate;\n\t\tthis.sprintDate.subscribe('changeSprintDeadline', (baseEvent) => {\n\t\t\tthis.emit('changeSprintDeadline', baseEvent.getData());\n\t\t});\n\t}\n\n\tinitStyle()\n\t{\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-active';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-success ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_COMPLETE_BUTTON');\n\t\t}\n\t\telse if (this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-completed';\n\t\t\tDom.remove(this.buttonNode);\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-planned';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-primary ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_START_BUTTON');\n\t\t}\n\n\t\tif (this.headerNode)\n\t\t{\n\t\t\tif (this.sprint.isDisabled())\n\t\t\t{\n\t\t\t\tDom.remove(this.headerNode.querySelector('.tasks-scrum-sprint-header-remove'));\n\t\t\t}\n\n\t\t\tthis.headerNode.className = '';\n\t\t\tDom.addClass(this.headerNode, 'tasks-scrum-sprint-header ' + this.headerClass);\n\n\t\t\tconst button = this.buttonNode.querySelector('button');\n\t\t\tbutton.className = '';\n\t\t\tDom.addClass(button, this.buttonClass);\n\t\t\tbutton.firstChild.replaceWith(this.buttonText);\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.headerNodeId = 'tasks-scrum-sprint-header-' + this.sprint.getId();\n\n\t\tconst tickAngleClass = (this.sprint.isCompleted() ? 'ui-btn-icon-angle-down' : 'ui-btn-icon-angle-up');\n\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.headerNodeId}\" class=\"tasks-scrum-sprint-header ${this.headerClass}\">\n\t\t\t\t${this.renderDragnDrop()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-name-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-name\">\n\t\t\t\t\t\t${Text.encode(this.sprint.getName())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-edit\"></div>\n\t\t\t\t${this.renderRemove()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-params\">\n\t\t\t\t\t${this.renderStatsHeader()}\n\t\t\t\t\t${this.sprintDate ? this.sprintDate.createDate(\n\t\t\t\t\t\tthis.sprint.getDateStart(), this.sprint.getDateEnd()) : ''}\n\t\t\t\t\t${this.createButton()}\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-tick\">\n\t\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ${tickAngleClass}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t};\n\n\tgetStatsHeader(): StatsHeader\n\t{\n\t\treturn this.statsHeader;\n\t}\n\n\trenderDragnDrop(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-dragndrop\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-header-empty\"></div>`;\n\t\t}\n\t}\n\n\trenderRemove(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-header-remove\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t}\n\n\trenderStatsHeader(): HTMLElement\n\t{\n\t\treturn (this.statsHeader ? this.statsHeader.render() : '');\n\t}\n\n\tupdateStatsHeader()\n\t{\n\t\tthis.statsHeader.updateStats(this.sprint);\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.updateDateStartNode(timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.updateDateEndNode(timestamp);\n\t\t}\n\t}\n\n\tcreateButton()\n\t{\n\t\tif (this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buttonNodeId = 'tasks-scrum-sprint-header-button-' + this.sprint.getId();\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.buttonNodeId}\" class=\"tasks-scrum-sprint-header-button\">\n\t\t\t\t\t<button class=\"${this.buttonClass}\">${this.buttonText}</button>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t};\n\n\tonAfterAppend()\n\t{\n\t\tthis.headerNode = document.getElementById(this.headerNodeId);\n\n\t\tif (!this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.buttonNode = document.getElementById(this.buttonNodeId);\n\t\t\tEvent.bind(this.buttonNode, 'click', this.onButtonClick.bind(this));\n\t\t}\n\n\t\tconst nameNode = this.headerNode.querySelector('.tasks-scrum-sprint-header-name-container');\n\t\tconst editButtonNode = this.headerNode.querySelector('.tasks-scrum-sprint-header-edit');\n\t\tEvent.bind(editButtonNode, 'click', () => this.emit('changeName', nameNode));\n\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\tconst removeNode = this.headerNode.querySelector('.tasks-scrum-sprint-header-remove');\n\t\t\tEvent.bind(removeNode, 'click', () => {\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_SPRINT'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tthis.emit('removeSprint');\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\tconst tickButtonNode = this.headerNode.querySelector('.tasks-scrum-sprint-header-tick');\n\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-up');\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-down');\n\t\t\tthis.emit('toggleVisibilityContent');\n\t\t});\n\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.onAfterAppend();\n\t\t}\n\t}\n\n\tonButtonClick()\n\t{\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.emit('completeSprint');\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.emit('startSprint');\n\t\t}\n\t}\n}","import {Loc, Tag} from 'main.core';\n\nexport class EventsHeader\n{\n\tconstructor()\n\t{\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<a class=\"ui-link\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_EVENT')}\n\t\t\t</a>\n\t\t`;\n\n\t\treturn this.element;\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\n\nexport class StoryPointsHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.StoryPointsHeader');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.totalStoryPointsNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point\">\n\t\t\t\t${this.sprint.getStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.inWorkStoryPointsNode = (this.sprint.isActive() ? Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-in-work-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_IN_WORK')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-in-work\">\n\t\t\t\t${this.sprint.getUncompletedStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t` : '');\n\n\t\tthis.doneStoryPointsNode = (this.sprint.isPlanned() ? '' : Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-done-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_DONE')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-done\">\n\t\t\t\t${this.sprint.getCompletedStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t`);\n\n\t\tthis.element = Tag.render`\n\t\t\t${this.renderBurnDownChartIcon()}\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-task\">\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-title\">\n\t\t\t\t\t${this.sprint.getNumberTasks()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t${this.totalStoryPointsNode}\n\t\t\t${this.inWorkStoryPointsNode}\n\t\t\t${this.doneStoryPointsNode}\n\t\t`;\n\n\t\tEvent.bind(this.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-entity-title-btn-burn-down-chart'\n\t\t), 'click', () => this.emit('showSprintBurnDownChart'));\n\n\t\treturn this.element;\n\t}\n\n\trenderBurnDownChartIcon(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-burn-down-chart\">\n\t\t\t\t<span class=\"tasks-scrum-entity-burn-down-chart-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateNumberTasks()\n\t{\n\t\tconst parentNode = this.getElementByClassName(this.element, 'tasks-scrum-entity-title-btn-task');\n\t\tparentNode.querySelector('.tasks-scrum-entity-tasks-title').textContent = this.sprint.getNumberTasks();\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tthis.getElementByClassName(\n\t\t\tthis.totalStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tsetCompletedStoryPoints(storyPoints: string)\n\t{\n\t\tthis.getElementByClassName(\n\t\t\tthis.doneStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point-done'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tsetUncompletedStoryPoints(storyPoints: string)\n\t{\n\t\tthis.getElementByClassName(\n\t\t\tthis.inWorkStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point-in-work'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tgetElementByClassName(elements: HTMLElement[], className: string): HTMLElement\n\t{\n\t\tlet element = null;\n\t\telements.forEach((elem) => {\n\t\t\tif (elem.classList.contains(className))\n\t\t\t{\n\t\t\t\telement = elem;\n\t\t\t}\n\t\t});\n\t\treturn element;\n\t}\n}","import {Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Entity} from '../entity';\nimport {Item} from '../../item/item';\nimport {SprintHeader} from './sprint.header';\nimport {EventsHeader} from './events.header';\nimport {GroupActionsButton} from '../group.actions.button';\nimport {ListItems} from '../list.items';\nimport {StoryPointsHeader} from './story.points.header';\nimport {StoryPoints} from '../../utility/story.points';\n\nimport '../../css/sprint.css';\n\ntype SprintInfo = {\n\tsprintGoal?: string\n}\n\ntype SprintParams = {\n\tid: number,\n\tname?: string,\n\tsort: number,\n\tdateStart?: number,\n\tdateEnd?: number,\n\tdefaultSprintDuration: number,\n\ttotalStoryPoints?: string,\n\ttotalCompletedStoryPoints?: string,\n\ttotalUncompletedStoryPoints?: string,\n\tnumberTasks?: number,\n\tcompletedTasks?: number,\n\tunCompletedTasks?: number,\n\tstatus?: string,\n\titems?: Array,\n\tinfo?: SprintInfo\n};\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tinfo: EpicInfoType\n}\n\nexport class Sprint extends Entity\n{\n\tconstructor(sprintData: SprintParams = {})\n\t{\n\t\tsuper(sprintData);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint');\n\n\t\tthis.name = sprintData.name;\n\t\tthis.dateStart = (Type.isInteger(sprintData.dateStart) ? parseInt(sprintData.dateStart, 10) : 0);\n\t\tthis.dateEnd = (Type.isInteger(sprintData.dateEnd) ? parseInt(sprintData.dateEnd, 10) : 0);\n\t\tthis.status = (sprintData.status ? sprintData.status : 'planned');\n\t\tthis.sort = (Type.isInteger(sprintData.sort) ? parseInt(sprintData.sort, 10) : 1);\n\n\t\tthis.totalStoryPoints = new StoryPoints();\n\t\tthis.totalStoryPoints.addPoints(sprintData.totalStoryPoints);\n\t\tthis.totalCompletedStoryPoints = new StoryPoints();\n\t\tthis.totalCompletedStoryPoints.addPoints(sprintData.totalCompletedStoryPoints);\n\t\tthis.totalUncompletedStoryPoints = new StoryPoints();\n\t\tthis.totalUncompletedStoryPoints.addPoints(sprintData.totalUncompletedStoryPoints);\n\n\t\tthis.completedStoryPoints = new StoryPoints();\n\t\tthis.uncompletedStoryPoints = new StoryPoints();\n\n\t\tthis.completedTasks = (Type.isInteger(sprintData.completedTasks) ? parseInt(sprintData.completedTasks, 10) : 0);\n\t\tthis.unCompletedTasks = Type.isInteger(sprintData.unCompletedTasks) ?\n\t\t\tparseInt(sprintData.unCompletedTasks, 10) : 0;\n\n\t\tthis.defaultSprintDuration = Type.isInteger(sprintData.defaultSprintDuration) ?\n\t\t\tparseInt(sprintData.defaultSprintDuration, 10) : 0;\n\n\t\tif (sprintData.items)\n\t\t{\n\t\t\tsprintData.items.forEach((itemData) => {\n\t\t\t\tconst item = new Item(itemData);\n\t\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t\t\tthis.items.set(item.itemId, item);\n\t\t\t});\n\t\t}\n\n\t\tthis.info = sprintData.info;\n\n\t\tthis.sprintHeader = null;\n\t\tthis.eventsHeader = null;\n\t\tthis.storyPointsHeader = null;\n\t}\n\n\tstatic buildSprint(sprintData: SprintParams = {}): Sprint\n\t{\n\t\tconst sprint = new Sprint(sprintData);\n\t\tsprint.addSprintHeader(SprintHeader.buildHeader(sprint));\n\t\tsprint.addEventsHeader(new EventsHeader());\n\t\tsprint.addStoryPointsHeader(new StoryPointsHeader(sprint));\n\t\tsprint.addGroupActionsButton(new GroupActionsButton());\n\t\tsprint.addListItems(new ListItems(sprint));\n\t\treturn sprint;\n\t}\n\n\taddSprintHeader(sprintHeader: SprintHeader)\n\t{\n\t\tthis.sprintHeader = sprintHeader;\n\t\tthis.sprintHeader.initStyle();\n\n\t\tthis.sprintHeader.subscribe('changeName', this.onChangeName.bind(this));\n\t\tthis.sprintHeader.subscribe('removeSprint', this.onRemoveSprint.bind(this));\n\t\tthis.sprintHeader.subscribe('completeSprint', () => this.emit('completeSprint'));\n\t\tthis.sprintHeader.subscribe('startSprint', () => this.emit('startSprint'));\n\t\tthis.sprintHeader.subscribe('changeSprintDeadline', this.onChangeSprintDeadline.bind(this));\n\t\tthis.sprintHeader.subscribe('toggleVisibilityContent', this.toggleVisibilityContent.bind(this));\n\t}\n\n\taddStoryPointsHeader(storyPointsHeader: StoryPointsHeader)\n\t{\n\t\tthis.storyPointsHeader = storyPointsHeader;\n\n\t\tthis.storyPointsHeader.subscribe('showSprintBurnDownChart', () => this.emit('showSprintBurnDownChart'));\n\t}\n\n\taddEventsHeader(eventsHeader: EventsHeader)\n\t{\n\t\tthis.eventsHeader = eventsHeader;\n\t}\n\n\tinitStyle()\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.initStyle();\n\t\t}\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn (this.status === 'active');\n\t}\n\n\tisPlanned(): boolean\n\t{\n\t\treturn (this.status === 'planned');\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn (this.status === 'completed');\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn (this.isCompleted());\n\t}\n\n\tisExpired(): boolean\n\t{\n\t\tconst sprintEndTime = new Date(this.dateEnd * 1000).getTime();\n\n\t\tconst currentTime = new Date();\n\t\tcurrentTime.setHours(currentTime.getHours() + 8);\n\n\t\treturn (this.isActive() && (sprintEndTime < currentTime.getTime()));\n\t}\n\n\thasInput(): boolean\n\t{\n\t\treturn !this.isDisabled();\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tsuper.setItem(newItem);\n\t\tnewItem.setDisableStatus(this.isDisabled());\n\t\tthis.updateStoryPoints();\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tsuper.removeItem(item);\n\t\tthis.updateStoryPoints();\n\t}\n\n\tgetSort()\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetSort(sort)\n\t{\n\t\tthis.sort = parseInt(sort, 10);\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.name;\n\t}\n\n\tgetDateStart(): number\n\t{\n\t\treturn parseInt(this.dateStart, 10);\n\t}\n\n\tgetDateEnd(): number\n\t{\n\t\treturn parseInt(this.dateEnd, 10);\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'sprint';\n\t}\n\n\tgetTotalStoryPoints(): StoryPoints\n\t{\n\t\treturn this.totalStoryPoints;\n\t}\n\n\tgetTotalCompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.totalCompletedStoryPoints;\n\t}\n\n\tgetTotalUncompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.totalUncompletedStoryPoints;\n\t}\n\n\tgetCompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tgetUncompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.uncompletedStoryPoints;\n\t}\n\n\taddNumberTasks(value: number)\n\t{\n\t\tsuper.addNumberTasks(value);\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.updateNumberTasks();\n\t\t}\n\t}\n\n\tsubtractNumberTasks(value: number)\n\t{\n\t\tsuper.subtractNumberTasks(value);\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.updateNumberTasks();\n\t\t}\n\t}\n\n\tsetCompletedTasks(completedTasks)\n\t{\n\t\tthis.completedTasks = parseInt(completedTasks, 10);\n\t}\n\n\tgetCompletedTasks(): number\n\t{\n\t\treturn this.completedTasks;\n\t}\n\n\tsetUnCompletedTasks(unCompletedTasks)\n\t{\n\t\tthis.unCompletedTasks = parseInt(unCompletedTasks, 10);\n\t}\n\n\tgetUnCompletedTasks(): number\n\t{\n\t\treturn this.unCompletedTasks;\n\t}\n\n\tgetDefaultSprintDuration()\n\t{\n\t\treturn this.defaultSprintDuration;\n\t}\n\n\tgetInfo(): SprintInfo\n\t{\n\t\treturn this.info;\n\t}\n\n\tgetEpics(): Map<number, EpicType>\n\t{\n\t\tconst epics = new Map();\n\t\tthis.items.forEach((item: Item) => {\n\t\t\t//todo wtf, why did not Set work?\n\t\t\tif (item.getEpic())\n\t\t\t{\n\t\t\t\tepics.set(item.getEpic().id, item.getEpic());\n\t\t\t}\n\t\t});\n\t\treturn epics;\n\t}\n\n\tgetUncompletedItems(): Map<string, Item>\n\t{\n\t\tconst items = new Map();\n\t\tthis.items.forEach((item: Item) => {\n\t\t\tif (!item.isCompleted())\n\t\t\t{\n\t\t\t\titems.set(item.getItemId(), item);\n\t\t\t}\n\t\t});\n\t\treturn items;\n\t}\n\n\tsetStatus(status)\n\t{\n\t\tthis.status = status;\n\t\tthis.initStyle();\n\n\t\tthis.items.forEach((item) => {\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t});\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\tthis.input.removeYourself();\n\t\t\tthis.groupActionsButton.removeYourself();\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t\tthis.emit('removeSprint');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint\" data-sprint-sort=\"${this.sort}\" data-sprint-id=\"${this.getId()}\">\n\t\t\t\t${this.sprintHeader ? this.sprintHeader.render() : ''}\n\t\t\t\t<div class=\"tasks-scrum-sprint-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sub-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-event\">\n\t\t\t\t\t\t\t${this.eventsHeader ? '' : ''/*todo*/}\n\t\t\t\t\t\t\t${this.isCompleted() ? this.renderLinkToCompletedSprint() : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-event-params\">\n\t\t\t\t\t\t\t${this.storyPointsHeader ? this.storyPointsHeader.render() : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-actions\">\n\t\t\t\t\t\t${this.groupActionsButton  && !this.isDisabled() ? this.groupActionsButton.render() : ''}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-items\">\n\t\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\trenderLinkToCompletedSprint(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<a href=\"${Text.encode(this.views.completedSprint.url)}\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_COMPLETED_SPRINT_LINK')}\n\t\t\t</a>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.contentNode = this.node.querySelector('.tasks-scrum-sprint-content');\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.showContent();\n\t\t}\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.onAfterAppend();\n\t\t}\n\n\t\tsuper.onAfterAppend();\n\t}\n\n\tupdateStoryPoints()\n\t{\n\t\tsuper.updateStoryPoints();\n\n\t\tthis.completedStoryPoints.clearPoints();\n\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\tif (item.isCompleted())\n\t\t\t{\n\t\t\t\tthis.completedStoryPoints.addPoints(item.getStoryPoints().getPoints());\n\t\t\t}\n\t\t});\n\n\t\tthis.uncompletedStoryPoints.clearPoints();\n\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\tif (!item.isCompleted())\n\t\t\t{\n\t\t\t\tthis.uncompletedStoryPoints.addPoints(item.getStoryPoints().getPoints());\n\t\t\t}\n\t\t});\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tif (this.isActive())\n\t\t\t{\n\t\t\t\tthis.updateActiveSprintStoryPointsHeader();\n\t\t\t}\n\t\t\telse if (this.isCompleted())\n\t\t\t{\n\t\t\t\tthis.storyPointsHeader.setStoryPoints(this.getTotalStoryPoints().getPoints());\n\t\t\t\tthis.storyPointsHeader.setCompletedStoryPoints(this.getTotalCompletedStoryPoints().getPoints());\n\t\t\t}\n\t\t\telse if (this.isPlanned())\n\t\t\t{\n\t\t\t\tthis.storyPointsHeader.setStoryPoints(this.storyPoints.getPoints());\n\t\t\t}\n\t\t}\n\n\t\tif (this.isPlanned())\n\t\t{\n\t\t\tthis.getTotalStoryPoints().setPoints(this.storyPoints.getPoints());\n\t\t\tthis.getTotalCompletedStoryPoints().setPoints(this.completedStoryPoints.getPoints());\n\t\t}\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateStatsHeader();\n\t\t}\n\t}\n\n\tupdateTotalStoryPoints(item: Item)\n\t{\n\t\tif (!this.isActive())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst differencePoints = item.getStoryPoints().getDifferencePoints();\n\t\tif (differencePoints > 0)\n\t\t{\n\t\t\tthis.addTotalStoryPoints(item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.subtractTotalStoryPoints(item);\n\t\t}\n\n\t\tthis.updateActiveSprintStoryPointsHeader();\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateStatsHeader();\n\t\t}\n\t}\n\n\taddTotalStoryPoints(item: Item)\n\t{\n\t\tconst itemStoryPoints = item.getStoryPoints().getPoints();\n\n\t\tthis.getTotalStoryPoints().addPoints(itemStoryPoints);\n\t\tif (item.isCompleted())\n\t\t{\n\t\t\tthis.getTotalCompletedStoryPoints().addPoints(itemStoryPoints);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTotalUncompletedStoryPoints().addPoints(itemStoryPoints);\n\t\t}\n\t}\n\n\tsubtractTotalStoryPoints(item: Item)\n\t{\n\t\tconst itemStoryPoints = item.getStoryPoints().getPoints();\n\n\t\tthis.getTotalStoryPoints().subtractPoints(itemStoryPoints);\n\t\tif (item.isCompleted())\n\t\t{\n\t\t\tthis.getTotalCompletedStoryPoints().subtractPoints(itemStoryPoints);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTotalUncompletedStoryPoints().subtractPoints(itemStoryPoints);\n\t\t}\n\t}\n\n\tupdateActiveSprintStoryPointsHeader()\n\t{\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.setStoryPoints(this.getTotalStoryPoints().getPoints());\n\t\t\tthis.storyPointsHeader.setCompletedStoryPoints(this.getTotalCompletedStoryPoints().getPoints());\n\t\t\tthis.storyPointsHeader.setUncompletedStoryPoints(this.getTotalUncompletedStoryPoints().getPoints());\n\t\t}\n\t}\n\n\tsubscribeToItem(item)\n\t{\n\t\tsuper.subscribeToItem(item);\n\n\t\titem.subscribe('moveToBacklog', (baseEvent) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: baseEvent.getTarget()\n\t\t\t});\n\t\t});\n\n\t\titem.subscribe('updateActiveSprintStoryPoints', (baseEvent: BaseEvent) => {\n\t\t\tthis.updateTotalStoryPoints(baseEvent.getTarget())\n\t\t});\n\t}\n\n\tonChangeName (baseEvent)\n\t{\n\t\tconst createInput = (value) => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input type=\"text\" class=\"tasks-scrum-sprint-header-name\" value=\"${Text.encode(value)}\">\n\t\t\t`;\n\t\t};\n\n\t\tconst inputNode = createInput(this.name);\n\t\tconst nameNode = baseEvent.getData().querySelector('.tasks-scrum-sprint-header-name');\n\n\t\tEvent.bind(inputNode, 'change', (event) => {\n\t\t\tconst newValue = event.target['value'];\n\t\t\tthis.emit('changeSprintName', {\n\t\t\t\tsprintId: this.getId(),\n\t\t\t\tname: newValue\n\t\t\t});\n\t\t\tthis.name = newValue;\n\t\t\tinputNode.blur();\n\t\t}, true);\n\n\t\tconst blockEnterInput = (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t\tinputNode.blur();\n\t\t};\n\n\t\tEvent.bind(inputNode, 'keydown', blockEnterInput);\n\t\tEvent.bindOnce(inputNode, 'blur', () => {\n\t\t\tEvent.unbind(inputNode, 'keydown', blockEnterInput);\n\t\t\tnameNode.textContent = Text.encode(this.name);\n\t\t\tDom.replace(inputNode, nameNode);\n\t\t}, true);\n\n\t\tDom.replace(nameNode, inputNode);\n\n\t\tinputNode.focus();\n\t\tinputNode.setSelectionRange(this.name.length, this.name.length);\n\t}\n\n\tonRemoveSprint()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: item\n\t\t\t});\n\t\t});\n\t\tthis.removeYourself();\n\t}\n\n\tonChangeSprintDeadline(baseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.emit('changeSprintDeadline', requestData);\n\t\tif (requestData.hasOwnProperty('dateStart'))\n\t\t{\n\t\t\tthis.dateStart = parseInt(requestData.dateStart, 10);\n\t\t}\n\t\telse if (requestData.hasOwnProperty('dateEnd'))\n\t\t{\n\t\t\tthis.dateEnd = parseInt(requestData.dateEnd, 10);\n\t\t}\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateStartNode(timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateEndNode(timestamp);\n\t\t}\n\t}\n\n\ttoggleVisibilityContent()\n\t{\n\t\tif (this.contentNode.style.display === 'block')\n\t\t{\n\t\t\tthis.hideContent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showContent();\n\t\t\tif (this.isCompleted() && this.getItems().size === 0)\n\t\t\t{\n\t\t\t\tthis.emit('getSprintCompletedItems');\n\t\t\t}\n\t\t}\n\t}\n\n\tshowContent()\n\t{\n\t\tthis.contentNode.style.display = 'block';\n\t}\n\n\thideContent()\n\t{\n\t\tthis.contentNode.style.display = 'none';\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onActivateGroupMode(baseEvent);\n\n\t\tDom.addClass(this.node.querySelector('.tasks-scrum-sprint-items'), 'tasks-scrum-sprint-items-group-mode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onDeactivateGroupMode(baseEvent);\n\n\t\tDom.removeClass(this.node.querySelector('.tasks-scrum-sprint-items'), 'tasks-scrum-sprint-items-group-mode');\n\t}\n}","import {Dom} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\n\nexport class SidePanel extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SidePanel');\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onLoad', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tsidePanel.setCacheable(false);\n\t\t\tthis.emit('onLoadSidePanel', sidePanel);\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tthis.emit('onCloseSidePanel', sidePanel);\n\t\t});\n\n\t\t/* eslint-disable */\n\t\tBX.addCustomEvent(window, 'onAfterPopupShow', (popupWindow) => {\n\t\t\tconst topSlider = this.sidePanelManager.getTopSlider();\n\t\t\tconst topSidePanelZIndex = (topSlider ? topSlider.getZindex() : 1000);\n\t\t\tconst popupWindowZIndex = popupWindow.getZindex();\n\t\t\tconst zIndex = (topSidePanelZIndex > popupWindowZIndex ? topSidePanelZIndex + 1 : popupWindowZIndex + 1);\n\t\t\tDom.style(popupWindow.getPopupContainer(), 'zIndex', zIndex);\n\t\t});\n\t\t/* eslint-enable */\n\t}\n\n\tisPreviousSidePanelExist(currentSidePanel): Boolean\n\t{\n\t\treturn Boolean(this.sidePanelManager.getPreviousSlider(currentSidePanel));\n\t}\n\n\treloadTopSidePanel()\n\t{\n\t\tthis.sidePanelManager.getTopSlider().reload();\n\t}\n\n\tcloseTopSidePanel()\n\t{\n\t\tthis.sidePanelManager.getTopSlider().close();\n\t}\n\n\treloadPreviousSidePanel(currentSidePanel)\n\t{\n\t\tconst previousSidePanel = this.sidePanelManager.getPreviousSlider(currentSidePanel);\n\t\tpreviousSidePanel.reload();\n\t}\n\n\topenSidePanelByUrl(url)\n\t{\n\t\tthis.sidePanelManager.open(url);\n\t}\n\n\topenSidePanel(id, options)\n\t{\n\t\tthis.sidePanelManager.open(id, options);\n\t}\n}","import {Loc} from 'main.core';\n\ntype Data = {\n\tday: number,\n\tidealValue: number,\n\tremainValue: number\n}\n\n//todo import amchart4 like es6\nexport class BurnDownChart\n{\n\tconstructor(data: Data)\n\t{\n\t\tthis.data = data;\n\t}\n\n\tcreateChart(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\n\t\tthis.createAxises();\n\n\t\tthis.createIdealLine();\n\t\tthis.createRemainLine();\n\n\t\tthis.createLegend();\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst categoryAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\tcategoryAxis.renderer.grid.template.location = 0;\n\t\tcategoryAxis.dataFields.category = 'day';\n\t\tcategoryAxis.renderer.minGridDistance = 60;\n\n\t\tconst valueAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tvalueAxis.min = -0.1;\n\t}\n\n\tcreateIdealLine()\n\t{\n\t\tconst lineSeries = this.chart.series.push(new am4charts.LineSeries());\n\t\tlineSeries.name = Loc.getMessage('TASKS_SCRUM_SPRINT_IDEAL_BURN_DOWN_CHART_LINE_TITLE'); //todo move from class\n\t\tlineSeries.stroke = am4core.color('#2882b3');\n\t\tlineSeries.strokeWidth = 2;\n\n\t\tlineSeries.dataFields.categoryX = 'day';\n\t\tlineSeries.dataFields.valueY = 'idealValue';\n\n\t\tconst circleColor = '#2882b3';\n\t\tconst circleBullet = new am4charts.CircleBullet();\n\t\tcircleBullet.circle.radius = 4;\n\t\tcircleBullet.circle.fill = am4core.color(circleColor);\n\t\tcircleBullet.circle.stroke = am4core.color(circleColor);\n\n\t\tlineSeries.bullets.push(circleBullet);\n\n\t\tconst segment = lineSeries.segments.template;\n\t\tconst hoverState = segment.states.create('hover');\n\t\thoverState.properties.strokeWidth = 4;\n\t}\n\n\tcreateRemainLine()\n\t{\n\t\tconst lineSeries = this.chart.series.push(new am4charts.LineSeries());\n\t\tlineSeries.name = Loc.getMessage('TASKS_SCRUM_SPRINT_REMAIN_BURN_DOWN_CHART_LINE_TITLE'); //todo move from class\n\t\tlineSeries.stroke = am4core.color('#9c1f1f');\n\t\tlineSeries.strokeWidth = 2;\n\n\t\tlineSeries.dataFields.categoryX = 'day';\n\t\tlineSeries.dataFields.valueY = 'remainValue';\n\n\t\tconst circleColor = '#9c1f1f';\n\t\tconst circleBullet = new am4charts.CircleBullet();\n\t\tcircleBullet.circle.radius = 4;\n\t\tcircleBullet.circle.fill = am4core.color(circleColor);\n\t\tcircleBullet.circle.stroke = am4core.color(circleColor);\n\n\t\tlineSeries.bullets.push(circleBullet);\n\n\t\tconst segment = lineSeries.segments.template;\n\t\tconst hoverState = segment.states.create('hover');\n\t\thoverState.properties.strokeWidth = 4;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.itemContainers.template.events.on('over', (event) => {\n\t\t\tthis.processOver(event.target.dataItem.dataContext);\n\t\t});\n\t\tthis.chart.legend.itemContainers.template.events.on('out', () => this.processOut());\n\t}\n\n\tprocessOver(hoveredLine)\n\t{\n\t\thoveredLine.toFront();\n\t\thoveredLine.segments.each((segment) => segment.setState('hover'));\n\t};\n\n\tprocessOut()\n\t{\n\t\tthis.chart.series.each((series) => {\n\t\t\tseries.segments.each((segment) => segment.setState('default'));\n\t\t\tseries.bulletsContainer.setState('default');\n\t\t});\n\t};\n\n\tdestroyBurnDownChart()\n\t{\n\t\tthis.chart.dispose();\n\t}\n}","import {Event, Loc, Runtime, Tag, Text, Dom} from 'main.core';\nimport {Sprint} from './sprint';\nimport {SidePanel} from '../../service/side.panel';\nimport {RequestSender} from '../../utility/request.sender';\nimport {BaseEvent} from 'main.core.events';\nimport {Confetti} from 'ui.confetti';\nimport {StatsCalculator} from '../../utility/stats.calculator';\nimport {BurnDownChart} from '../../utility/burn.down.chart';\n\nimport '../../css/sprint.side.panel.css';\n\ntype Params = {\n\tsprints?: Map,\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender,\n\tviews: {\n\t\tplan: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tactiveSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tcompletedSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t}\n\t}\n};\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tinfo: EpicInfoType\n}\n\ntype RequestDataToStartSprint = {\n\tsprintId: number,\n\tsprintGoal: string\n}\n\ntype RequestDataToCompleteSprint = {\n\tsprintId: number,\n\tdirection: number|string\n}\n\ntype RequestDataToGetBurnDownChartData = {\n\tsprintId: number\n}\n\nexport class SprintSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sprints = params.sprints ? params.sprints : new Map();\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.views = params.views;\n\n\t\tthis.currentSprint = null;\n\t\tthis.uncompletedItems = new Map();\n\n\t\tthis.lastCompletedSprint = this.getLastCompletedSprint(this.sprints);\n\t}\n\n\tshowStartSidePanel(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-start-' + Text.getRandom();\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadStartPanel.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildStartPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000,\n\t\t\twidth: 600\n\t\t});\n\t}\n\n\tshowCompleteSidePanel(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-start-' + Text.getRandom();\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadCompletePanel.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildCompletePanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000,\n\t\t\twidth: 600\n\t\t});\n\t}\n\n\tshowBurnDownChart(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-burn-down-chart-' + Text.getRandom();\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadSprintBurnDownPanel.bind(this));\n\t\tthis.sidePanel.subscribe('onCloseSidePanel', this.onCloseBurnDownChart.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildBurnDownPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildStartPanel(): HTMLElement\n\t{\n\t\tlet differenceStoryPoints = this.currentSprint.getTotalStoryPoints().getPoints();\n\t\tdifferenceStoryPoints = (differenceStoryPoints > 0 ? '+' + differenceStoryPoints : differenceStoryPoints);\n\t\tif (this.lastCompletedSprint)\n\t\t{\n\t\t\tdifferenceStoryPoints = this.getDifferenceStoryPointsBetweenSprints(\n\t\t\t\tthis.currentSprint,\n\t\t\t\tthis.lastCompletedSprint\n\t\t\t);\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_TASK_COUNT_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t\t${parseInt(this.currentSprint.getNumberTasks())}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box tasks-scrum-sprint-sidepanel-info-box-story\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_STORY_POINTS_COUNT_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t\t${Text.encode(this.currentSprint.getTotalStoryPoints().getPoints())}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-extra\">\n\t\t\t\t\t\t\t\t\t${differenceStoryPoints}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_EPICS_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic-list\">\n\t\t\t\t\t\t\t\t${[...this.currentSprint.getEpics().values()].map((epic: EpicType) => {\n\t\t\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-epic-item\" style=\"background: ${Text.encode(epic.info.color)};\">\n\t\t\t\t\t\t\t\t\t\t\t${Text.encode(epic.name)}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_GOAL_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea ui-ctl-resize-y\">\n\t\t\t\t\t\t\t<textarea class=\"ui-ctl-element\"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadStartPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\n\t\tthis.onLoadStartButtons().then((buttonsContainer: HTMLElement) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', this.onStartSprint.bind(this));\n\t\t});\n\t}\n\n\tbuildCompletePanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t${this.buildSprintGoal()}\n\t\t\t\t${this.buildSprintActions()}\n\t\t\t\t${this.buildSprintPlan()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildBurnDownPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_IDEAL_BURN_DOWN_CHART_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-chart\"></div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintGoal(): HTMLElement|string\n\t{\n\t\tconst sprintInfo = this.currentSprint.getInfo();\n\t\tconst sprintGoal = sprintInfo.sprintGoal;\n\t\tif (!sprintGoal)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_GOAL_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-text\">\n\t\t\t\t\t\t${Text.encode(sprintGoal)}\n\t\t\t\t\t </div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintActions(): HTMLElement|string\n\t{\n\t\tconst uncompletedTasks = this.currentSprint.getUnCompletedTasks();\n\t\tif (uncompletedTasks === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tlet listSprintsOptions = '';\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tif (sprint.isPlanned())\n\t\t\t{\n\t\t\t\tlistSprintsOptions += `<option value=\"${sprint.getId()}\">${Text.encode(sprint.getName())}</option>`;\n\t\t\t}\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title tasks-scrum-sprint-sidepanel-title-icon\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-field\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-label\">\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_SELECT')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t<select class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t\t<option value=\"backlog\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_MOVE_SELECTOR_BACKLOG')}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t<option value=\"0\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_NEW_SPRINT')}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t${listSprintsOptions}\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-uncompleted\">\n\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-subtitle\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_ITEM_LIST')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-uncompleted-list\">\n\t\t\t\t\t\t\t${[...this.currentSprint.getUncompletedItems().values()].map((item: Item) => {\n\t\t\t\t\t\t\t\tconst previewItem = item.getPreviewVersion();\n\t\t\t\t\t\t\t\tthis.uncompletedItems.set(previewItem.getItemId(), previewItem);\n\t\t\t\t\t\t\t\treturn previewItem.render();\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintPlan(): HTMLElement\n\t{\n\t\tconst statsCalculator = new StatsCalculator();\n\t\tconst percentage = statsCalculator.calculatePercentage(\n\t\t\tthis.currentSprint.getTotalStoryPoints().getPoints(),\n\t\t\tthis.currentSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\tlet differencePercentage = statsCalculator.calculatePercentage(\n\t\t\tthis.currentSprint.getTotalStoryPoints().getPoints(),\n\t\t\tthis.currentSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\t\tif (this.lastCompletedSprint)\n\t\t{\n\t\t\tdifferencePercentage = this.getDifferencePercentageBetweenSprints(\n\t\t\t\tthis.currentSprint,\n\t\t\t\tthis.lastCompletedSprint\n\t\t\t);\n\t\t}\n\n\t\tconst percentageNodeClass = (differencePercentage > 0 ? '' : 'tasks-scrum-sprint-sidepanel-info-dif-min');\n\t\tconst absoluteValue = Math.abs(differencePercentage);\n\t\tconst speedInfoMessage = (differencePercentage > 0 ?\n\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED_UP').replace('#value#', absoluteValue) :\n\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED_DOWN').replace('#value#', absoluteValue)\n\t\t);\n\n\t\tconst renderSpeed = (speedInfoMessage) => {\n\t\t\treturn ''; //todo chart\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-speed\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-subtitle\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED')}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-result\">${speedInfoMessage}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-graph\"></div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_PLAN_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box tasks-scrum-sprint-sidepanel-info-box-w100\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_PLAN_DONE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t${percentage}%\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif ${percentageNodeClass}\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-arrow\"></span>\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-dif-block\">\n\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-val\">${absoluteValue}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-icon\">%</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${renderSpeed()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadCompletePanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\t\tconst itemsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-uncompleted-list');\n\n\t\t[...this.uncompletedItems.values()].map((previewItem: Item) => {\n\t\t\tpreviewItem.onAfterAppend(itemsContainer);\n\t\t\tpreviewItem.subscribe('showTask', () => {\n\t\t\t\tthis.currentSprint.emit('showTask', previewItem);\n\t\t\t});\n\t\t});\n\n\t\tthis.onLoadCompleteButtons().then((buttonsContainer: HTMLElement) => {\n\t\t\tEvent.bind(\n\t\t\t\tbuttonsContainer.querySelector('[name=save]'),\n\t\t\t\t'click',\n\t\t\t\tthis.onCompleteSprint.bind(this, sidePanel)\n\t\t\t);\n\t\t});\n\t}\n\n\tonLoadSprintBurnDownPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\n\t\tthis.getBurnDownChartData().then((data) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.burnDownChart = new BurnDownChart(data);\n\t\t\t\tthis.burnDownChart.createChart(this.form.querySelector('.tasks-scrum-sprint-sidepanel-chart'));\n\t\t\t}, 300);\n\t\t});\n\t}\n\n\tonCloseBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tif (this.sidePanelId === sidePanel.getUrl())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.burnDownChart.destroyBurnDownChart();\n\t\t\t\tthis.burnDownChart = null;\n\t\t\t}, 300);\n\t\t}\n\t}\n\n\tgetTasksCountLabel(count)\n\t{\n\t\tif (count > 5)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_3');\n\t\t}\n\t\telse if (count === 1)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_2');\n\t\t}\n\t}\n\n\tgetLastCompletedSprint(sprints: Map): Sprint\n\t{\n\t\treturn [...sprints.values()].find((sprint) => sprint.isCompleted() === true);\n\t}\n\n\tgetDifferenceStoryPointsBetweenSprints(firstSprint: Sprint, secondSprint: Sprint): string\n\t{\n\t\tconst difference = parseFloat(\n\t\t\tfirstSprint.getTotalStoryPoints().getPoints() - secondSprint.getTotalStoryPoints().getPoints()\n\t\t);\n\n\t\tif (difference === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn (difference > 0 ? '+' + difference : difference);\n\t\t}\n\t}\n\n\tgetDifferencePercentageBetweenSprints(firstSprint: Sprint, secondSprint: Sprint): number\n\t{\n\t\tconst statsCalculator = new StatsCalculator();\n\n\t\tconst firstPercentage = statsCalculator.calculatePercentage(\n\t\t\tfirstSprint.getTotalStoryPoints().getPoints(),\n\t\t\tfirstSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\tconst secondPercentage = statsCalculator.calculatePercentage(\n\t\t\tsecondSprint.getTotalStoryPoints().getPoints(),\n\t\t\tsecondSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\treturn parseFloat(firstPercentage) - parseFloat(secondPercentage);\n\t}\n\n\tgetStartButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getSprintStartButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetCompleteButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getSprintCompleteButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetBurnDownChartData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getBurnDownChartData(this.getRequestDataToGetBurnDownChartData()).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t})\n\t\t});\n\t}\n\n\tonLoadStartButtons(): Promise\n\t{\n\t\treturn this.getStartButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadCompleteButtons(): Promise\n\t{\n\t\treturn this.getCompleteButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonStartSprint()\n\t{\n\t\tthis.requestSender.startSprint(this.getRequestDataToStartSprint()).then((response) => {\n\t\t\tthis.currentSprint.setStatus('active');\n\t\t\tlocation.href = this.views['activeSprint'].url;\n\t\t}).catch((response) => {\n\t\t\tthis.removeClockIconFromButton();\n\t\t\tthis.requestSender.showErrorAlert(response, Loc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP'));\n\t\t});\n\t}\n\n\tonCompleteSprint(sidePanel)\n\t{\n\t\tthis.requestSender.completeSprint(this.getRequestDataToCompleteSprint()).then((response) => {\n\t\t\tif (Confetti)\n\t\t\t{\n\t\t\t\tConfetti.fire({\n\t\t\t\t\tparticleCount: 400,\n\t\t\t\t\tspread: 80,\n\t\t\t\t\torigin: {\n\t\t\t\t\t\tx: 0.7,\n\t\t\t\t\t\ty: 0.2\n\t\t\t\t\t},\n\t\t\t\t\tzIndex: (sidePanel.getZindex() + 1)\n\t\t\t\t}).then(() => {\n\t\t\t\t\tlocation.href = this.views['plan'].url;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlocation.href = this.views['plan'].url;\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.removeClockIconFromButton();\n\t\t\tthis.requestSender.showErrorAlert(response, Loc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP'));\n\t\t});\n\t}\n\n\tgetRequestDataToStartSprint(): RequestDataToStartSprint\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\t\trequestData.sprintGoal = this.form.querySelector('textarea').value;\n\n\t\treturn requestData;\n\t}\n\n\tgetRequestDataToCompleteSprint(): RequestDataToCompleteSprint\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\t\tconst directionSelectNode = this.form.querySelector('select');\n\t\trequestData.direction = (directionSelectNode ? directionSelectNode.value : 'backlog');\n\n\t\treturn requestData;\n\t}\n\n\tgetRequestDataToGetBurnDownChartData(): RequestDataToGetBurnDownChartData\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\n\t\treturn requestData;\n\t}\n\n\tremoveClockIconFromButton()\n\t{\n\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\tif (buttonsContainer)\n\t\t{\n\t\t\tDom.removeClass(buttonsContainer.querySelector('[name=save]'), 'ui-btn-wait');\n\t\t}\n\t}\n}","import {RequestSender} from '../utility/request.sender';\nimport {Event, Dom, Type} from 'main.core';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\nimport {SidePanel} from '../service/side.panel';\nimport {Item} from '../item/item';\nimport {StatsHeaderBuilder} from '../entity/sprint/stats.header.builder';\n\nexport class ActiveSprint\n{\n\tconstructor(options)\n\t{\n\t\tthis.pathToTask = options.pathToTask;\n\n\t\tthis.activeSprintData = (Type.isPlainObject(options.activeSprintData) ? options.activeSprintData : null);\n\t\tif (this.activeSprintData)\n\t\t{\n\t\t\tthis.requestSender = new RequestSender({\n\t\t\t\tsignedParameters: options.signedParameters,\n\t\t\t});\n\n\t\t\tthis.finishStatus = this.activeSprintData.finishStatus;\n\n\t\t\tthis.sprint = new Sprint(this.activeSprintData);\n\n\t\t\tthis.sprints = new Map();\n\t\t\toptions.sprints.forEach((sprintData) => {\n\t\t\t\tconst sprint = new Sprint(sprintData);\n\t\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t\t});\n\n\t\t\tthis.views = options.views;\n\n\t\t\tthis.itemsInFinishStage = new Map();\n\n\t\t\tthis.initDomNodes();\n\t\t\tthis.createSprintStats();\n\t\t\tthis.bindHandlers();\n\t\t}\n\n\t\tthis.sidePanel = new SidePanel();\n\t}\n\n\tinitDomNodes()\n\t{\n\t\tthis.sprintStatsContainer = document.getElementById('tasks-scrum-active-sprint-stats');\n\t\tconst buttonsContainer = document.getElementById('tasks-scrum-actions-complete-sprint');\n\t\tthis.chartSprintButtonNode = buttonsContainer.firstElementChild;\n\t\tthis.completeSprintButtonNode = buttonsContainer.lastElementChild;\n\t}\n\n\tcreateSprintStats()\n\t{\n\t\tthis.statsHeader = StatsHeaderBuilder.build(this.sprint);\n\t\tthis.statsHeader.setKanbanStyle();\n\t\tDom.append(this.statsHeader.render(), this.sprintStatsContainer);\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEvent.bind(this.chartSprintButtonNode, 'click', this.onShowSprintBurnDownChart.bind(this));\n\t\tEvent.bind(this.completeSprintButtonNode, 'click', this.onCompleteSprint.bind(this));\n\n\t\tif (window.Kanban)\n\t\t{\n\t\t\tthis.onKanbanRender(window.Kanban);\n\t\t\tBX.addCustomEvent(window.Kanban, 'Kanban.Grid:onItemMoved', this.onItemMoved.bind(this));\n\t\t}\n\t}\n\n\tonCompleteSprint()\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.sprints,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showCompleteSidePanel(this.sprint);\n\n\t\tthis.sprint.subscribe('showTask', (baseEvent) => {\n\t\t\tconst item = baseEvent.getData();\n\t\t\tthis.sidePanel.openSidePanelByUrl(this.pathToTask.replace('#task_id#', item.getSourceId()));\n\t\t});\n\t}\n\n\t/**\n\t * Handles Kanban render.\n\t * @param {BX.Tasks.Kanban.Grid} kanbanGrid\n\t * @returns {void}\n\t */\n\tonKanbanRender(kanbanGrid)\n\t{\n\t\tconst items = kanbanGrid.getItems();\n\t\tconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\t\tfor (let itemId in kanbanGrid.getItems())\n\t\t{\n\t\t\tif (hasOwnProperty.call(items, itemId))\n\t\t\t{\n\t\t\t\tconst item = items[itemId];\n\t\t\t\tif (item.getColumn().getType() === this.finishStatus)\n\t\t\t\t{\n\t\t\t\t\tthis.itemsInFinishStage.set(itemId, '');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Hook on item moved.\n\t * @param {BX.Tasks.Kanban.Item} kanbanItem\n\t * @param {BX.Tasks.Kanban.Column} targetColumn\n\t * @param {BX.Tasks.Kanban.Item} [beforeItem]\n\t * @returns {void}\n\t */\n\tonItemMoved(kanbanItem, targetColumn, beforeItem)\n\t{\n\t\tif (targetColumn.type === this.finishStatus)\n\t\t{\n\t\t\tif (!this.itemsInFinishStage.has(kanbanItem.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedToFinish(kanbanItem, this.sprint);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.itemsInFinishStage.has(kanbanItem.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedFromFinish(kanbanItem, this.sprint);\n\t\t\t}\n\t\t}\n\n\t\tthis.statsHeader.updateStats(this.sprint);\n\t}\n\n\tupdateStatsAfterMovedToFinish(kanbanItem, sprint: Sprint)\n\t{\n\t\tthis.itemsInFinishStage.set(kanbanItem.getId(), kanbanItem.getStoryPoints());\n\n\t\tsprint.getTotalCompletedStoryPoints().addPoints(kanbanItem.getStoryPoints());\n\t\tsprint.getTotalUncompletedStoryPoints().subtractPoints(kanbanItem.getStoryPoints());\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() + 1);\n\t\tsprint.setUnCompletedTasks(sprint.getUnCompletedTasks() - 1);\n\n\t\tsprint.getItems().forEach((scrumItem: Item) => {\n\t\t\tif (scrumItem.getSourceId() === parseInt(kanbanItem.getId(), 10))\n\t\t\t{\n\t\t\t\tscrumItem.setCompleted(true);\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateStatsAfterMovedFromFinish(kanbanItem, sprint: Sprint)\n\t{\n\t\tthis.itemsInFinishStage.delete(kanbanItem.getId());\n\n\t\tsprint.getTotalCompletedStoryPoints().subtractPoints(kanbanItem.getStoryPoints());\n\t\tsprint.getTotalUncompletedStoryPoints().addPoints(kanbanItem.getStoryPoints());\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() - 1);\n\t\tsprint.setUnCompletedTasks(sprint.getUnCompletedTasks() + 1);\n\n\t\tsprint.getItems().forEach((scrumItem: Item) => {\n\t\t\tif (scrumItem.getSourceId() === parseInt(kanbanItem.getId(), 10))\n\t\t\t{\n\t\t\t\tscrumItem.setCompleted(false);\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowSprintBurnDownChart()\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(this.sprint);\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Entity} from '../entity';\n\nexport class Header extends EventEmitter\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tsuper(entity);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.BacklogHeader');\n\n\t\tthis.entity = entity;\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<div class=\"tasks-scrum-backlog-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-epics-title ui-btn ui-btn-xs ui-btn-secondary\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_EPICS_TITLE')}\n\t\t\t</div>\n\t\t\t<div title=\"Definition of Done\" class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-dod\">\n\t\t\t\t<span class=\"tasks-scrum-entity-dod-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-title-spacer\"></div>\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-task\">\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-title\">\n\t\t\t\t\t${this.entity.getNumberTasks()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-story-point-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE_STORY_POINTS')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-story-point\">\n\t\t\t\t${Text.encode(this.entity.getStoryPoints().getPoints())}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.getElementByClassName(this.element, 'tasks-scrum-backlog-epics-title'), 'click', () => {\n\t\t\tthis.emit('openListEpicGrid');\n\t\t});\n\n\t\tEvent.bind(this.getElementByClassName(this.element, 'tasks-scrum-entity-title-btn-dod'), 'click', () => {\n\t\t\tthis.emit('openDefinitionOfDone');\n\t\t});\n\n\t\treturn this.element;\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tthis.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-backlog-story-point'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tupdateNumberTasks()\n\t{\n\t\tconst parentNode = this.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-entity-title-btn-task'\n\t\t);\n\t\tparentNode.querySelector('.tasks-scrum-entity-tasks-title').textContent = this.entity.getNumberTasks();\n\t}\n\n\tgetElementByClassName(elements: HTMLElement[], className: string): HTMLElement\n\t{\n\t\tlet element = null;\n\t\telements.forEach((elem) => {\n\t\t\tif (elem.classList.contains(className))\n\t\t\t{\n\t\t\t\telement = elem;\n\t\t\t}\n\t\t});\n\t\treturn element;\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class EpicCreationButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.EpicCreationButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst element = Tag.render`\n\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-action-epic\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(element, 'click', this.onClick.bind(this));\n\n\t\treturn element;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('openAddEpicForm')\n\t}\n}","import {Dom, Tag, Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Entity} from '../entity';\nimport {Header} from './header';\nimport {EpicCreationButton} from './epic.creation.button';\nimport {GroupActionsButton} from '../group.actions.button';\nimport {ListItems} from '../list.items';\nimport {Item} from '../../item/item';\n\nimport '../../css/backlog.css';\n\ntype backlogParams = {\n\titems?: Array\n};\n\nexport class Backlog extends Entity\n{\n\tconstructor(backlogData: backlogParams = {})\n\t{\n\t\tsuper(backlogData);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Backlog');\n\n\t\tbacklogData.items.forEach((itemData) => {\n\t\t\tconst item = new Item(itemData);\n\t\t\tthis.items.set(item.itemId, item);\n\t\t});\n\n\t\tthis.header = null;\n\t\tthis.epicCreationButton = null;\n\t}\n\n\tstatic buildBacklog(backlogData: backlogParams = {}): Backlog\n\t{\n\t\tconst backlog = new Backlog(backlogData);\n\t\tbacklog.addHeader(new Header(backlog));\n\t\tbacklog.addEpicCreationButton(new EpicCreationButton());\n\t\tbacklog.addGroupActionsButton(new GroupActionsButton());\n\t\tbacklog.addListItems(new ListItems(backlog));\n\t\treturn backlog;\n\t}\n\n\taddHeader(header: Header)\n\t{\n\t\tthis.header = header;\n\t\tthis.header.subscribe('openListEpicGrid', () => this.emit('openListEpicGrid'));\n\t\tthis.header.subscribe('openDefinitionOfDone', () => this.emit('openDefinitionOfDone'));\n\t}\n\n\taddEpicCreationButton(epicCreationButton: EpicCreationButton)\n\t{\n\t\tthis.epicCreationButton = epicCreationButton;\n\t\tthis.epicCreationButton.subscribe('openAddEpicForm', () => this.emit('openAddEpicForm'));\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'backlog';\n\t}\n\n\tisDisabled()\n\t{\n\t\treturn false;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-backlog\">\n\t\t\t\t<div class=\"tasks-scrum-backlog-header\">\n\t\t\t\t\t${this.header ? this.header.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-backlog-actions\">\n\t\t\t\t\t${this.epicCreationButton ? this.epicCreationButton.render() : ''}\n\t\t\t\t\t${this.groupActionsButton ? this.groupActionsButton.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-backlog-items\">\n\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\treturn this.node;\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tsuper.setItem(newItem);\n\n\t\tthis.updateStoryPoints();\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tsuper.removeItem(item);\n\n\t\tthis.updateStoryPoints();\n\t}\n\n\taddNumberTasks(value: number)\n\t{\n\t\tsuper.addNumberTasks(value);\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.updateNumberTasks();\n\t\t}\n\t}\n\n\tsubtractNumberTasks(value: number)\n\t{\n\t\tsuper.subtractNumberTasks(value);\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.updateNumberTasks();\n\t\t}\n\t}\n\n\tupdateStoryPoints()\n\t{\n\t\tsuper.updateStoryPoints();\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.setStoryPoints(this.getStoryPoints().getPoints());\n\t\t}\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onActivateGroupMode(baseEvent);\n\n\t\tDom.addClass(this.node.querySelector('.tasks-scrum-backlog-items'), 'tasks-scrum-backlog-items-group-mode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onDeactivateGroupMode(baseEvent);\n\n\t\tDom.removeClass(this.node.querySelector('.tasks-scrum-backlog-items'), 'tasks-scrum-backlog-items-group-mode');\n\t}\n}","import {Event, Runtime, Tag, Text, Loc, Type, Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Label} from 'ui.label';\n\nimport '../../css/epic.css';\n\nexport class Epic extends EventEmitter\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Epic');\n\n\t\tthis.requestSender = options.requestSender;\n\t\tthis.sidePanel = options.sidePanel;\n\t\tthis.entity = options.entity;\n\n\t\tthis.form = null;\n\n\t\tthis.defaultColor = '#69dafc';\n\t\tthis.selectedColor = '';\n\n\t\tthis.currentEpic = null;\n\t}\n\n\tgetCurrentEpic(): ?Object\n\t{\n\t\treturn this.currentEpic;\n\t}\n\n\topenAddForm()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadAddForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildAddForm());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenEditForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadEditForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\t\tresolve(this.buildEditForm());\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenViewForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadViewForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\t\tresolve(this.buildViewForm());\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenEpicsList()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequest.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadListGrid.bind(this));\n\t\t\t\tthis.sidePanel.subscribeOnce('onCloseSidePanel', this.destroyGrid.bind(this));\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(Tag.render`\n\t\t\t\t\t<div class=\"tasks-scrum-epics-list\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-add-button\">\n\t\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-sm\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epics-list-grid\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tonLoadAddForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.currentEpic = null;\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadAddButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.createEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.emit('onAfterCreateEpic', response);\n\t\t\t\t\tif (this.sidePanel.isPreviousSidePanelExist(sidePanel))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sidePanel.reloadPreviousSidePanel(sidePanel);\n\t\t\t\t\t\tsidePanel.close();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\t\tthis.openEpicsList();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\t\tresponse,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_CREATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t\tsidePanel.close();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadViewForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadDescription();\n\t\tthis.onLoadFiles();\n\t\tthis.onLoadViewButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\tthis.openEditForm(this.currentEpic.id);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadEditForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadEditButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.editEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.emit('onAfterEditEpic', response);\n\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\tthis.reloadGrid();\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.removeClockIconFromButton();\n\t\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\t\tresponse,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_UPDATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\treloadGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\tconst gridManager = BX.Main.gridManager.getById(this.gridId);\n\t\t\tif (gridManager)\n\t\t\t{\n\t\t\t\tgridManager.instance.reload();\n\t\t\t}\n\t\t}\n\t\t/* eslint-enable */\n\t}\n\n\tdestroyGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\tconst gridManager = BX.Main.gridManager.getById(this.gridId);\n\t\t\tif (gridManager)\n\t\t\t{\n\t\t\t\tgridManager.instance.destroy();\n\t\t\t}\n\t\t}\n\t\t/* eslint-enable */\n\t}\n\n\tonLoadEditor()\n\t{\n\t\tthis.getDescriptionEditor().then((editorHtml) => {\n\t\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\t\tRuntime.html(descriptionContainer, editorHtml).then(() => {\n\t\t\t\tthis.editor = window.LHEPostForm.getHandler(this.id);\n\t\t\t\twindow.BXHtmlEditor.Get(this.id);\n\t\t\t\tEventEmitter.emit(this.editor.eventNode, 'OnShowLHE', [true]);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.form.querySelector('.tasks-scrum-epic-form-header-title-control').focus();\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadDescription()\n\t{\n\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\tthis.requestSender.getEpicDescription({\n\t\t\tepicId: this.currentEpic.id,\n\t\t\ttext: this.currentEpic.description\n\t\t}).then(response => {\n\t\t\tRuntime.html(descriptionContainer, response.data);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonLoadFiles()\n\t{\n\t\tconst filesContainer = this.form.querySelector('.tasks-scrum-epic-form-files');\n\t\tthis.requestSender.getEpicFiles({\n\t\t\tepicId: this.currentEpic.id\n\t\t}).then(response => {\n\t\t\tRuntime.html(filesContainer, response.data.html);\n\t\t});\n\t}\n\n\tonLoadColorPicker()\n\t{\n\t\tthis.selectedColor = (this.currentEpic ? this.currentEpic.info.color : this.defaultColor);\n\t\tconst colorBlockNode = this.form.querySelector('.tasks-scrum-epic-header-color');\n\t\tEvent.bind(colorBlockNode, 'click', () => {\n\t\t\tconst colorNode = colorBlockNode.querySelector('.tasks-scrum-epic-header-color-current');\n\t\t\tconst picker = this.getColorPicker(colorNode);\n\t\t\tpicker.open();\n\t\t});\n\t}\n\n\tonLoadAddButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadViewButtons(): Promise\n\t{\n\t\treturn this.getViewEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadEditButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadListGrid(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tconst form = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list');\n\t\tconst list = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list-grid');\n\n\t\tthis.getEpicsList().then((responseData) => {\n\t\t\tif (responseData.html)\n\t\t\t{\n\t\t\t\tRuntime.html(list, responseData.html);\n\n\t\t\t\tthis.prepareTagsList(list);\n\n\t\t\t\tconst buttonNode = form.querySelector('.tasks-scrum-epic-header-add-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.remove(form.querySelector('.tasks-scrum-epic-header-add-button'));\n\t\t\t\tDom.append(this.getEmptyEpicListForm(), list);\n\t\t\t\tconst buttonNode = list.querySelector('.tasks-scrum-epics-empty-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [, eventArgs] = event.getCompatData();\n\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\teventArgs.method = 'POST';\n\n\t\tif (!eventArgs.url)\n\t\t{\n\t\t\teventArgs.url = this.requestSender.getEpicListUrl();\n\t\t}\n\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t\tentityId: this.entity.getId(),\n\t\t\tgridId: this.gridId,\n\t\t\tsignedParameters: this.requestSender.getSignedParameters()\n\t\t};\n\t}\n\n\tgetEpicsList() : Promise\n\t{\n\t\tthis.gridId = 'EntityEpicsGrid_' + this.entity.getId();\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicsList({\n\t\t\t\tentityId: this.entity.getId(),\n\t\t\t\tgridId: this.gridId\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetEpic(id: Number): Promise\n\t{\n\t\treturn this.requestSender.getEpic({id: id});\n\t}\n\n\tbuildAddForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader('', '#69dafc')}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildViewForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_VIEW_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t\t\t${Text.encode(this.currentEpic.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\t\t\"background-color: ${Text.encode(this.currentEpic.info.color)};\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\" style=\"padding: 15px 10px 15px 10px;\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-files\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildEditForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_EDIT_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader(this.currentEpic.name, this.currentEpic.info.color)}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEmptyEpicListForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epics-empty\">\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-first-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_FIRST_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-image\">\n\t\t\t\t\t<svg width=\"124px\" height=\"123px\" viewBox=\"0 0 124 123\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t\t<g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" opacity=\"0.28\">\n\t\t\t\t\t\t\t<path d=\"M83,105 L83,81.4375 L105,81.4375 L105,18 L17,18 L17,81.4375 L39,81.4375 L39,105 L83,105 Z M10.9411765,0 L113.058824,0 C119.101468,0 124,4.85902727 124,10.8529412 L124,112.147059 C124,118.140973 119.101468,123 113.058824,123 L10.9411765,123 C4.89853156,123 0,118.140973 0,112.147059 L0,10.8529412 C0,4.85902727 4.89853156,0 10.9411765,0 Z M44.0142862,47.0500004 L54.2142857,57.4416671 L79.7142857,32 L87,42.75 L54.2142857,75 L36,57.0833333 L44.0142862,47.0500004 Z\" fill=\"#A8ADB4\" />\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-second-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_SECOND_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-button\">\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-lg\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormHeader(title: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t${title}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormContainerHeader(name: String, color: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t<input type=\"text\" name=\"name\" value=\"${Text.encode(name)}\" class=\n\t\t\t\t\t\t\"tasks-scrum-epic-form-header-title-control\" placeholder=\n\t\t\t\t\t\t\"${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_NAME_PLACEHOLDER')}\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\"background-color: ${Text.encode(color)};\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetDescriptionEditor(): Promise\n\t{\n\t\tconst requestData = {\n\t\t\teditorId: this.id\n\t\t};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t\trequestData.text = this.currentEpic.description;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicDescriptionEditor(requestData).then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetAddEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getAddEpicFormButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetViewEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getViewEpicFormButtonsAction().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetColorPicker(colorNode)\n\t{\n\t\t/* eslint-disable */\n\t\treturn new BX.ColorPicker({\n\t\t\tbindElement: colorNode,\n\t\t\tdefaultColor: this.selectedColor,\n\t\t\tonColorSelected: (color, picker) => {\n\t\t\t\tthis.selectedColor = color;\n\t\t\t\tcolorNode.style.backgroundColor = color;\n\t\t\t},\n\t\t\tpopupOptions: {\n\t\t\t\tzIndex: 1100,\n\t\t\t\tclassName: 'tasks-scrum-epic-color-popup'\n\n\t\t\t},\n\t\t\tcolors: [\n\t\t\t\t[\"#aae9fc\", \"#bbecf1\", \"#98e1dc\", \"#e3f299\", \"#ffee95\", \"#ffdd93\", \"#dfd3b6\", \"#e3c6bb\"],\n\t\t\t\t[\"#ffad97\", \"#ffbdbb\", \"#ffcbd8\", \"#ffc4e4\", \"#c4baed\", \"#dbdde0\", \"#bfc5cd\", \"#a2a8b0\"]\n\t\t\t]\n\t\t});\n\t\t/* eslint-enable */\n\t}\n\n\tgetRequestData()\n\t{\n\t\tconst requestData = {};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t}\n\n\t\trequestData.entityId = this.entity.getId();\n\t\trequestData.name = (this.form.querySelector('[name=name]').value).trim();\n\t\trequestData.description = this.editor.oEditor.GetContent();\n\t\trequestData.color = this.selectedColor;\n\t\trequestData.files = this.getAttachmentsFiles();\n\n\t\treturn requestData;\n\t}\n\n\tgetAttachmentsFiles(): Array\n\t{\n\t\tconst files = [];\n\n\t\tif (!this.editor || !Type.isPlainObject(this.editor.arFiles) || !Type.isPlainObject(this.editor.controllers))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\tconst fileControllers = [];\n\t\tObject.values(this.editor.arFiles).forEach((controller) => {\n\t\t\tif(!fileControllers.includes(controller))\n\t\t\t{\n\t\t\t\tfileControllers.push(controller);\n\t\t\t}\n\t\t});\n\n\t\tfileControllers.forEach((fileController) => {\n\t\t\tif (\n\t\t\t\tthis.editor.controllers[fileController] &&\n\t\t\t\tType.isPlainObject(this.editor.controllers[fileController].values)\n\t\t\t)\n\t\t\t{\n\t\t\t\tObject.keys(this.editor.controllers[fileController].values).forEach((fileId) => {\n\t\t\t\t\tif (!files.includes(fileId))\n\t\t\t\t\t{\n\t\t\t\t\t\tfiles.push(fileId);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\n\t\treturn files;\n\t}\n\n\tprepareTagsList(container: HTMLElement)\n\t{\n\t\tconst tagsContainers = container.querySelectorAll('.tasks-scrum-epic-grid-tags');\n\t\ttagsContainers.forEach((tagsContainer) => {\n\t\t\tconst tags = this.getTagsFromNode(tagsContainer);\n\t\t\tDom.clean(tagsContainer);\n\t\t\ttags.forEach((tag) => {\n\t\t\t\tDom.append(this.getTagNode(tag), tagsContainer);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTagsFromNode(node: HTMLElement): Array\n\t{\n\t\tconst tags = [];\n\t\tnode.childNodes.forEach((childNode) => {\n\t\t\ttags.push(childNode.textContent.trim());\n\t\t});\n\t\treturn tags;\n\t}\n\n\tgetTagNode(tag: string): HTMLElement\n\t{\n\t\tconst tagLabel = new Label({\n\t\t\ttext: tag,\n\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\tfill: true,\n\t\t\tsize: Label.Size.SM,\n\t\t\tcustomClass: ''\n\t\t});\n\t\tconst container = tagLabel.getContainer();\n\t\tEvent.bind(container, 'click', () => {\n\t\t\tthis.emit('filterByTag', tag);\n\t\t\tthis.sidePanel.closeTopSidePanel();\n\t\t});\n\t\treturn container;\n\t}\n\n\tremoveClockIconFromButton()\n\t{\n\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\tif (buttonsContainer)\n\t\t{\n\t\t\tDom.removeClass(buttonsContainer.querySelector('[name=save]'), 'ui-btn-wait');\n\t\t}\n\t}\n}","import {Tag, Dom, Loc, Event} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Input} from '../../utility/input';\n\nimport '../../css/decomposition.css';\n\nexport class Decomposition extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Decomposition');\n\n\t\tthis.items = new Set();\n\n\t\tthis.input = new Input();\n\t\tthis.input.setPlaceholder(Loc.getMessage('TASKS_SCRUM_TASK_ADD_DECOMPOSITION_INPUT_PLACEHOLDER'));\n\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t}\n\n\tdecomposeItem(item: Item)\n\t{\n\t\tthis.addDecomposedItem(item);\n\n\t\tDom.insertAfter(this.input.render(), item.getItemNode());\n\t\tthis.input.setNode();\n\n\t\tconst inputNode = this.input.getInputNode();\n\t\tEvent.bind(inputNode, 'input', this.input.onTagSearch.bind(this.input));\n\t\tEvent.bind(inputNode, 'keydown', this.onCreateItem.bind(this));\n\t\tinputNode.focus();\n\n\t\tconst button = this.createButton();\n\t\tDom.insertAfter(button, this.input.getNode());\n\n\t\tEvent.bind(button.querySelector('button'), 'click', () => {\n\t\t\tthis.deactivateDecompositionMode();\n\t\t\tthis.input.removeYourself()\n\t\t\tDom.remove(button);\n\t\t});\n\t}\n\n\taddDecomposedItem(item: Item)\n\t{\n\t\titem.activateDecompositionMode();\n\n\t\tthis.items.add(item);\n\t}\n\n\tgetDecomposedItems(): Set\n\t{\n\t\treturn this.items;\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.items.forEach((item) => {\n\t\t\titem.deactivateDecompositionMode();\n\t\t});\n\t\tthis.items.clear();\n\t}\n\n\tcreateButton(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-decomposition-structure\">\n\t\t\t\t<button class=\"ui-btn ui-btn-sm ui-btn-primary\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DECOMPOSITION_BUTTON')}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonCreateItem(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tif (!this.input.isTagsSearchMode())\n\t\t\t{\n\t\t\t\tconst inputNode = event.target;\n\t\t\t\tif (inputNode.value)\n\t\t\t\t{\n\t\t\t\t\tthis.emit('createItem', inputNode.value);\n\t\t\t\t\tinputNode.value = '';\n\t\t\t\t\tinputNode.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import {Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Plan} from '../view/plan';\nimport {RequestSender} from '../utility/request.sender';\nimport {Sprint} from '../entity/sprint/sprint';\n\ntype ListTypeItem = {\n\tNAME: string,\n\tVALUE: string\n}\n\ntype ValueTypeField = {\n\tname: string,\n\tvalue: string\n}\n\ntype Params = {\n\tfilterId: string,\n\tscrumManager?: Plan,\n\trequestSender?: RequestSender\n}\n\nexport class Filter extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Filter');\n\n\t\tthis.filterId = params.filterId;\n\t\tthis.scrumManager = params.scrumManager;\n\t\tthis.requestSender = params.requestSender;\n\n\t\tthis.initUiFilterManager();\n\t\tthis.bindHandlers();\n\t}\n\n\tinitUiFilterManager()\n\t{\n\t\t/* eslint-disable */\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\t\t/* eslint-enable */\n\t}\n\n\tbindHandlers()\n\t{\n\t\t/* eslint-disable */\n\t\tBX.addCustomEvent('BX.Main.Filter:apply', this.onApplyFilter.bind(this));\n\t\t/* eslint-enable */\n\t}\n\n\tgetSearchContainer(): HTMLElement\n\t{\n\t\treturn this.filterManager.getSearch().getContainer();\n\t}\n\n\tscrollToSearchContainer()\n\t{\n\t\tconst filterSearchContainer = this.getSearchContainer();\n\t\tif (!this.isNodeInViewport(filterSearchContainer))\n\t\t{\n\t\t\tfilterSearchContainer.scrollIntoView(true);\n\t\t}\n\t}\n\n\tonApplyFilter(filterId, values, filterInstance, promise, params)\n\t{\n\t\tif (this.filterId !== filterId || !this.scrumManager)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams.autoResolve = false;\n\n\t\tthis.emit('applyFilter', {\n\t\t\tpromise: promise\n\t\t});\n\t}\n\n\taddItemToListTypeField(name: string, item: ListTypeItem)\n\t{\n\t\t//todo set item to list after epic crud actions\n\n\t\tconst fieldInstances = this.filterManager.getField(name);\n\t\tconst fieldOptions = this.filterManager.getFieldByName(name);\n\n\t\tfieldInstances.options.ITEMS.push(item);\n\t\tfieldOptions.ITEMS.push(item);\n\n\t\tconst itemsNode = fieldInstances.node.querySelector('[data-name='+name+']');\n\n\t\tconst items = Dom.attr(itemsNode, 'data-items');\n\t\titems.push(item);\n\t\tDom.attr(itemsNode, 'data-items', items);\n\t}\n\n\tsetValueToField(value: ValueTypeField)\n\t{\n\t\tconst filterApi = this.filterManager.getApi();\n\t\tconst filterFieldsValues = this.filterManager.getFilterFieldsValues();\n\n\t\tfilterFieldsValues[value.name] = value.value;\n\n\t\tfilterApi.setFields(filterFieldsValues);\n\t\tfilterApi.apply();\n\t}\n\n\tgetValueFromField(value: ValueTypeField): string\n\t{\n\t\tconst filterFieldsValues = this.filterManager.getFilterFieldsValues();\n\t\treturn filterFieldsValues[value.name];\n\t}\n\n\tresetFilter()\n\t{\n\t\tthis.filterManager.resetFilter();\n\t}\n\n\tisNodeInViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\t\treturn (\n\t\t\trect.top >= 0 &&\n\t\t\trect.left >= 0 &&\n\t\t\trect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n\t\t\trect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t);\n\t}\n}","import {Loc} from 'main.core';\n\ntype Data = {\n\tsprintName: string,\n\tplan: number,\n\tdone: number\n}\n\n//todo import amchart4 like es6\nexport class TeamSpeedChart\n{\n\tconstructor(data: Data)\n\t{\n\t\tthis.data = data;\n\n\t\tthis.chart = null;\n\t}\n\n\tcreateChart(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\n\t\tthis.chart.scrollbarX = new am4core.Scrollbar();\n\t\tthis.chart.scrollbarX.parent = this.chart.bottomAxesContainer;\n\n\t\tthis.createAxises();\n\n\t\tthis.createColumn('plan', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_PLAN_COLUMN'), '#2882b3');\n\t\tthis.createColumn('done', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_DONE_COLUMN'), '#9c1f1f');\n\n\t\tthis.createLegend();\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst xAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\txAxis.dataFields.category = 'sprintName';\n\t\txAxis.renderer.grid.template.location = 0;\n\n\t\tconst yAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tyAxis.min = 0;\n\t}\n\n\tcreateColumn(valueY: string, name: string, color: string)\n\t{\n\t\tconst series = this.chart.series.push(new am4charts.ColumnSeries());\n\t\tseries.dataFields.valueY = valueY;\n\t\tseries.dataFields.categoryX = 'sprintName';\n\t\tseries.name = name;\n\t\tseries.stroke = am4core.color(color);\n\t\tseries.fill = am4core.color(color);\n\n\t\t// const bullet = series.bullets.push(new am4charts.LabelBullet())\n\t\t// bullet.dy = 10;\n\t\t// bullet.label.text = '{valueY}';\n\t\t// bullet.label.fill = am4core.color('#ffffff');\n\n\t\treturn series;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.paddingBottom = 20;\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t}\n\n\tdestroyChart()\n\t{\n\t\tthis.chart.dispose();\n\t}\n}","import {Event, Loc, Runtime, Tag, Text} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {SidePanel} from '../service/side.panel';\nimport {RequestSender} from './request.sender';\nimport {TeamSpeedChart} from './team.speed.chart';\nimport {Entity} from '../entity/entity';\n\ntype Params = {\n\tsprints?: Map,\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender\n};\n\nexport class ProjectSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sprints = params.sprints ? params.sprints : new Map();\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t}\n\n\tshowTeamSpeedChart()\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-start-' + Text.getRandom();\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadTeamSpeedChartPanel.bind(this));\n\t\tthis.sidePanel.subscribe('onCloseSidePanel', this.onCloseTeamSpeedChart.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildTeamSpeedPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tshowDefinitionOfDone(entity: Entity)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-dod-' + Text.getRandom();\n\n\t\tthis.entity = entity;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadDodPanel.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildDodPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildTeamSpeedPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-project-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-project-side-panel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-chart\"></div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildDodPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-project-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-project-side-panel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-dod-panel\"></div>\n\t\t\t\t<div class=\"tasks-scrum-project-dod-options\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox\">\n\t\t\t\t\t\t<input type=\"checkbox\" class=\"ui-ctl-element dod-items-required\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_OPTIONS_REQUIRED_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadTeamSpeedChartPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-project-side-panel');\n\n\t\tthis.getTeamSpeedChartData().then((data) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.teamSpeedChart = new TeamSpeedChart(data);\n\t\t\t\tthis.teamSpeedChart.createChart(this.form.querySelector('.tasks-scrum-project-side-panel-chart'));\n\t\t\t}, 300);\n\t\t});\n\t}\n\n\tonCloseTeamSpeedChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tif (this.sidePanelId === sidePanel.getUrl())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.teamSpeedChart.destroyChart();\n\t\t\t\tthis.teamSpeedChart = null;\n\t\t\t}, 300);\n\t\t}\n\t}\n\n\tonLoadDodPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-project-side-panel');\n\n\t\tthis.getDodComponent().then((data) => {\n\t\t\tconst dodContainer = this.form.querySelector('.tasks-scrum-project-dod-panel');\n\t\t\tRuntime.html(dodContainer, data.html);\n\t\t}).then(() => {\n\t\t\tthis.getDodPanelData().then((data) => {\n\t\t\t\tthis.prepareDodOptionsContainer(data);\n\t\t\t});\n\t\t}).then(() => {\n\t\t\tthis.requestSender.getDodButtons().then(response => {\n\t\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-project-side-panel-buttons');\n\t\t\t\tRuntime.html(buttonsContainer, response.data.html).then(() => {\n\t\t\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\t\t\tthis.requestSender.saveDod(this.getRequestDataForSaveList())\n\t\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\tsidePanel.close();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTeamSpeedChartData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getTeamSpeedChartData().then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDodComponent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getDodComponent({\n\t\t\t\tentityId: this.entity.getId()\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDodPanelData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getDodPanelData({\n\t\t\t\tentityId: this.entity.getId()\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetRequestDataForSaveList()\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.entityId = this.entity.getId();\n\t\trequestData.items = this.getEntityChecklistItems();\n\t\trequestData.required = this.getDodItemsRequired();\n\n\t\treturn requestData;\n\t}\n\n\tgetEntityChecklistItems(): Array\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst treeStructure = BX.Tasks.CheckListInstance.getTreeStructure();\n\t\treturn treeStructure.getRequestData();\n\t\t/* eslint-enable */\n\t}\n\n\tgetDodItemsRequired(): string\n\t{\n\t\tconst optionsContainer = this.form.querySelector('.tasks-scrum-project-dod-options');\n\t\tconst option = optionsContainer.querySelector('.dod-items-required');\n\n\t\treturn (option.checked === true ? 'Y' : 'N');\n\t}\n\n\tprepareDodOptionsContainer(data)\n\t{\n\t\tif (data['dodItemsRequired'])\n\t\t{\n\t\t\tconst optionsContainer = this.form.querySelector('.tasks-scrum-project-dod-options');\n\t\t\tconst option = optionsContainer.querySelector('.dod-items-required');\n\t\t\toption.checked = (data['dodItemsRequired'] === 'Y');\n\t\t}\n\t}\n}","import {Loc, Dom, Tag, Type, Event} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loader} from 'main.loader';\nimport {RequestSender} from '../utility/request.sender';\nimport {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {Entity} from '../entity/entity';\nimport {Item} from '../item/item';\nimport {Menu} from 'main.popup';\nimport {Draggable} from 'ui.draganddrop.draggable';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\nimport {SidePanel} from '../service/side.panel';\nimport {Epic} from '../item/epic/epic';\nimport {TagSearcher} from '../utility/tag.searcher';\nimport {Decomposition} from '../item/task/decomposition';\nimport {Filter} from '../service/filter';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {ProjectSidePanel} from '../utility/project.side.panel';\n\nimport '../css/base.css';\n\ntype Responsible = {\n\tname: string,\n\tpathToUser: string,\n\tphoto: {\n\t\tsrc: string\n\t}\n}\n\ntype Params = {\n\tsignedParameters: string,\n\tdebugMode: string,\n\tviews: {\n\t\tplan: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tactiveSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tcompletedSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t}\n\t},\n\tdefaultResponsible: Responsible\n}\n\n//todo single responsibility principle\n//todo add ItemMover, ItemSorter\nexport class Plan\n{\n\tconstructor(options: Params)\n\t{\n\t\tthis.defaultSprintDuration = options.defaultSprintDuration;\n\t\tthis.pathToTask = options.pathToTask;\n\n\t\tthis.requestSender = new RequestSender({\n\t\t\tsignedParameters: options.signedParameters,\n\t\t\tdebugMode: options.debugMode\n\t\t});\n\n\t\tthis.activeSprintId = parseInt(options.activeSprintId, 10);\n\t\tthis.views = options.views;\n\n\t\tthis.backlog = Backlog.buildBacklog(options.backlog);\n\n\t\tthis.sprints = new Map();\n\t\toptions.sprints.forEach((sprintData) => {\n\t\t\tsprintData.defaultSprintDuration = this.defaultSprintDuration;\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t});\n\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.tagSearcher = new TagSearcher();\n\t\tObject.values(options.tags.epic).forEach((epic) => {\n\t\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\t});\n\t\tObject.values(options.tags.task).forEach((tagName) => {\n\t\t\tthis.tagSearcher.addTagToSearcher(tagName);\n\t\t});\n\n\t\tthis.epic = new Epic({\n\t\t\tentity: this.backlog,\n\t\t\trequestSender: this.requestSender,\n\t\t\tsidePanel: this.sidePanel\n\t\t});\n\t\tthis.epic.subscribe('onAfterCreateEpic', (baseEvent) => {\n\t\t\tconst response = baseEvent.getData();\n\t\t\tconst epic = response.data;\n\t\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\t\tthis.filter.addItemToListTypeField('EPIC', {\n\t\t\t\tNAME: epic.name.trim(),\n\t\t\t\tVALUE: String(epic.id)\n\t\t\t});\n\t\t});\n\n\t\tthis.filter = new Filter({\n\t\t\tfilterId: options.filterId,\n\t\t\tscrumManager: this,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\t\tthis.filter.subscribe('applyFilter', this.onApplyFilter.bind(this));\n\n\t\tthis.defaultResponsible = options.defaultResponsible;\n\n\t\tthis.bindHandlers();\n\t}\n\n\trenderTo(container)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for Scrum not found');\n\t\t}\n\n\t\tthis.scrumContainer = container;\n\n\t\tDom.append(this.backlog.render(), this.scrumContainer);\n\t\tthis.backlog.onAfterAppend();\n\n\t\tDom.append(this.renderSprintsContainer(), this.scrumContainer);\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tsprint.onAfterAppend();\n\t\t});\n\n\t\tthis.sprintCreatingButtonNode = document.getElementById(this.sprintCreatingButtonNodeId);\n\t\tthis.sprintCreatingDropZoneNode = document.getElementById(this.sprintCreatingDropZoneNodeId);\n\t\tthis.sprintListNode = document.getElementById(this.sprintListNodeId);\n\n\t\tEvent.bind(this.sprintCreatingButtonNode, 'click', this.createSprint.bind(this));\n\n\t\tthis.setDraggable();\n\t}\n\n\tsetDraggable()\n\t{\n\t\tconst itemContainers = [];\n\t\titemContainers.push(this.backlog.getListItemsNode());\n\t\tif (this.sprintCreatingDropZoneNode)\n\t\t{\n\t\t\titemContainers.push(this.sprintCreatingDropZoneNode);\n\t\t}\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tif (!sprint.isDisabled())\n\t\t\t{\n\t\t\t\titemContainers.push(sprint.getListItemsNode());\n\t\t\t}\n\t\t});\n\t\tthis.draggableItems = new Draggable({\n\t\t\tcontainer: itemContainers,\n\t\t\tdraggable: '.tasks-scrum-item-drag', // todo add tmp class\n\t\t\tdragElement: '.tasks-scrum-item',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t\tdelay: 200\n\t\t});\n\t\tthis.draggableItems.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.findEntityByEntityId(sourceEntityId);\n\t\t\tconst endContainer = dragEndEvent.endContainer;\n\t\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\t\t\tif (sourceEntityId === endEntityId)\n\t\t\t{\n\t\t\t\tthis.onItemMove(dragEndEvent);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(sourceEntity, message).then(() => {\n\t\t\t\t\tthis.onItemMove(dragEndEvent);\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\t\tconst item = this.findItemByItemId(itemId);\n\t\t\t\t\tconst itemNodeAfterSourceItem = sourceEntity.getListItemsNode().children[item.getSort()];\n\t\t\t\t\tDom.insertBefore(itemNode, itemNodeAfterSourceItem);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.draggableSprints = new Draggable({\n\t\t\tcontainer: this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list'),\n\t\t\tdraggable: '.tasks-scrum-sprint',\n\t\t\tdragElement: '.tasks-scrum-sprint-dragndrop',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t});\n\t\tthis.draggableSprints.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.onSprintMove(dragEndEvent);\n\t\t});\n\t}\n\n\tbindHandlers(newSprint)\n\t{\n\t\tthis.teamSpeedChartButtonContainerNode = document.getElementById('tasks-scrum-team-speed-button-container');\n\t\tEvent.bind(this.teamSpeedChartButtonContainerNode, 'click', this.onShowTeamSpeedChart.bind(this));\n\n\t\tconst createTaskItem = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst inputObject = data.inputObject;\n\t\t\tconst inputValue = data.value;\n\n\t\t\tconst newItem = this.createItem('task', inputValue);\n\t\t\tnewItem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\t\tnewItem.setSort(1);\n\n\t\t\tthis.appendItem(newItem, entity.getListItemsNode(), inputObject.getNode());\n\n\t\t\tthis.fillItemBeforeCreation(newItem, inputValue);\n\n\t\t\tnewItem.setParentId(inputObject.getEpicId());\n\n\t\t\tthis.sendRequestToCreateTask(entity, newItem, inputValue).then((response) => {\n\t\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t\t});\n\t\t\t\tentity.setItem(newItem);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onUpdateItem = (baseEvent: BaseEvent) => {\n\t\t\tthis.requestSender.updateItem(baseEvent.getData()).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onShowTask = (baseEvent: BaseEvent) => {\n\t\t\tconst item = baseEvent.getData();\n\t\t\tthis.sidePanel.openSidePanelByUrl(this.pathToTask.replace('#task_id#', item.getSourceId()));\n\t\t};\n\t\tconst onMoveItem = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tthis.moveItem(data.item, data.button);\n\t\t};\n\t\tconst onMoveToSprint = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tthis.moveToAnotherEntity(baseEvent.getTarget(), data.item, null, data.button);\n\t\t\tif (this.sprints.size <= 1)\n\t\t\t{\n\t\t\t\tDom.remove(data.button.parentNode);\n\t\t\t}\n\t\t};\n\t\tconst onMoveToBacklog = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tthis.moveToAnotherEntity(data.sprint, data.item, this.backlog);\n\t\t};\n\t\tconst onAttachFilesToTask = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tthis.requestSender.attachFilesToTask({\n\t\t\t\ttaskId: data.item.getSourceId(),\n\t\t\t\tattachedIds: data.attachedIds,\n\t\t\t}).then((response) => {\n\t\t\t\tdata.item.updateIndicators(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onRemoveItem = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tconst items = [];\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\titemId: groupModeItem.getItemId(),\n\t\t\t\t\t\titemType: groupModeItem.getItemType(),\n\t\t\t\t\t\tsourceId: groupModeItem.getSourceId()\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.requestSender.batchRemoveItem({\n\t\t\t\t\titems: items,\n\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode())\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t\tentity.deactivateGroupMode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.requestSender.removeItem({\n\t\t\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode())\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tconst onStartSprint = (baseEvent: BaseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\t\tsprints: this.sprints,\n\t\t\t\tsidePanel: this.sidePanel,\n\t\t\t\trequestSender: this.requestSender,\n\t\t\t\tviews: this.views\n\t\t\t});\n\t\t\tsprintSidePanel.showStartSidePanel(sprint);\n\t\t};\n\t\tconst onCompleteSprint = (baseEvent: BaseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\t\tsprints: this.sprints,\n\t\t\t\tsidePanel: this.sidePanel,\n\t\t\t\trequestSender: this.requestSender,\n\t\t\t\tviews: this.views\n\t\t\t});\n\t\t\tsprintSidePanel.showCompleteSidePanel(sprint);\n\t\t};\n\t\tconst onShowSprintBurnDownChart = (baseEvent: BaseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\t\tsprints: this.sprints,\n\t\t\t\tsidePanel: this.sidePanel,\n\t\t\t\trequestSender: this.requestSender,\n\t\t\t\tviews: this.views\n\t\t\t});\n\t\t\tsprintSidePanel.showBurnDownChart(sprint);\n\t\t};\n\t\tconst onChangeTaskResponsible = (baseEvent: BaseEvent) => {\n\t\t\tthis.requestSender.changeTaskResponsible({\n\t\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\t\tresponsible: baseEvent.getData().gerResponsible(),\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onRemoveSprint = (baseEvent: BaseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tthis.sprints.delete(sprint.getId());\n\t\t\tthis.requestSender.removeSprint({\n\t\t\t\tsprintId: sprint.getId(),\n\t\t\t\tsortInfo: this.calculateSprintSort()\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onChangeSprintName = (baseEvent: BaseEvent) => {\n\t\t\tthis.requestSender.changeSprintName(baseEvent.getData()).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onChangeSprintDeadline = (baseEvent: BaseEvent) => {\n\t\t\tthis.requestSender.changeSprintDeadline(baseEvent.getData()).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onOpenAddEpicForm = (baseEvent: BaseEvent) => {\n\t\t\tthis.epic.openAddForm();\n\t\t};\n\t\tconst onOpenListEpicGrid = (baseEvent: BaseEvent) => {\n\t\t\tthis.epic.openEpicsList();\n\t\t\tthis.epic.subscribe('onAfterEditEpic', (innerBaseEvent) => {\n\t\t\t\tconst response = innerBaseEvent.getData();\n\t\t\t\tconst updatedEpicInfo = response.data;\n\t\t\t\tconst oldEpicInfo = this.epic.getCurrentEpic();\n\t\t\t\tthis.getAllItems().forEach((item) => {\n\t\t\t\t\tconst itemEpic = item.getEpic();\n\t\t\t\t\tif (itemEpic && itemEpic.name === oldEpicInfo.name)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.setEpicAndTags(updatedEpicInfo);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.tagSearcher.removeEpicFromSearcher(oldEpicInfo);\n\t\t\t\tthis.tagSearcher.addEpicToSearcher(updatedEpicInfo);\n\t\t\t});\n\t\t};\n\t\tconst onOpenDefinitionOfDone = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst projectSidePanel = new ProjectSidePanel({\n\t\t\t\tsidePanel: this.sidePanel,\n\t\t\t\trequestSender: this.requestSender\n\t\t\t});\n\t\t\tprojectSidePanel.showDefinitionOfDone(entity);\n\t\t};\n\t\tconst onShowTagSearcher = (baseEvent: BaseEvent) => {\n\t\t\t//todo refactor and test\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst item = data.item;\n\t\t\tconst actionsPanelButton = data.button;\n\t\t\tthis.tagSearcher.showTagsDialog(item, actionsPanelButton);\n\t\t\tthis.tagSearcher.unsubscribeAll('attachTagToTask');\n\t\t\tthis.tagSearcher.subscribe('attachTagToTask', (innerBaseEvent) => {\n\t\t\t\tconst tag = innerBaseEvent.getData();\n\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tconst tasks = [];\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\ttasks.push({\n\t\t\t\t\t\t\ttaskId: groupModeItem.getSourceId()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tthis.requestSender.batchAttachTagToTask({\n\t\t\t\t\t\ttasks: tasks,\n\t\t\t\t\t\ttag: tag\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tconst currentTags = groupModeItem.getTags();\n\t\t\t\t\t\t\tcurrentTags.push(tag);\n\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(groupModeItem.getEpic(), currentTags);\n\t\t\t\t\t\t});\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst currentTags = item.getTags();\n\t\t\t\t\tthis.requestSender.attachTagToTask({\n\t\t\t\t\t\ttaskId: item.getSourceId(),\n\t\t\t\t\t\ttag: tag\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tcurrentTags.push(tag);\n\t\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.tagSearcher.unsubscribeAll('deAttachTagToTask');\n\t\t\tthis.tagSearcher.subscribe('deAttachTagToTask', (innerBaseEvent) => {\n\t\t\t\tconst tag = innerBaseEvent.getData();\n\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tconst tasks = [];\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\ttasks.push({\n\t\t\t\t\t\t\ttaskId: groupModeItem.getSourceId()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tthis.requestSender.batchDeattachTagToTask({\n\t\t\t\t\t\ttasks: tasks,\n\t\t\t\t\t\ttag: tag\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tconst currentTags = groupModeItem.getTags();\n\t\t\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(tag), 1);\n\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(groupModeItem.getEpic(), currentTags);\n\t\t\t\t\t\t});\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst currentTags = item.getTags();\n\t\t\t\t\tthis.requestSender.deAttachTagToTask({\n\t\t\t\t\t\ttaskId: item.getSourceId(),\n\t\t\t\t\t\ttag: tag\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(tag), 1);\n\t\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.tagSearcher.unsubscribeAll('hideTagDialog');\n\t\t\tthis.tagSearcher.subscribe('hideTagDialog', (innerBaseEvent) => {\n\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tconst onShowEpicSearcher = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst item = data.item;\n\t\t\tconst actionsPanelButton = data.button;\n\t\t\tthis.tagSearcher.showEpicDialog(item, actionsPanelButton);\n\t\t\tthis.tagSearcher.unsubscribeAll('updateItemEpic');\n\t\t\tthis.tagSearcher.subscribe('updateItemEpic', (innerBaseEvent) => {\n\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tconst items = [];\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tthis.requestSender.batchUpdateItemEpic({\n\t\t\t\t\t\titems: items,\n\t\t\t\t\t\tepicId: innerBaseEvent.getData()\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tif (Type.isArray(response.data.epic))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tgroupModeItem.setParentId(0);\n\t\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(null, null);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tgroupModeItem.setParentId(response.data.epic.id);\n\t\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(response.data.epic, groupModeItem.getTags());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.requestSender.updateItemEpic({\n\t\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\t\tepicId: innerBaseEvent.getData()\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tif (Type.isArray(response.data.epic))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.setParentId(0);\n\t\t\t\t\t\t\titem.setEpicAndTags(null, null);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.setParentId(response.data.epic.id);\n\t\t\t\t\t\t\titem.setEpicAndTags(response.data.epic, item.getTags());\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tconst onStartDecomposition = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst parentItem = baseEvent.getData();\n\n\t\t\tconst decomposition = new Decomposition();\n\t\t\tdecomposition.subscribe('tagsSearchOpen', onTagsSearchOpen);\n\t\t\tdecomposition.subscribe('tagsSearchClose', onTagsSearchClose);\n\t\t\tdecomposition.subscribe('createItem', (innerBaseEvent) => {\n\t\t\t\tconst inputValue = innerBaseEvent.getData();\n\t\t\t\tconst decomposedItems = decomposition.getDecomposedItems();\n\t\t\t\tconst lastDecomposedItem = Array.from(decomposedItems).pop();\n\n\t\t\t\tconst newItem = this.createItem(parentItem.getItemType(), inputValue);\n\t\t\t\tnewItem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\t\t\tnewItem.setParentId(parentItem.getParentId());\n\t\t\t\tnewItem.setParentSourceId(parentItem.getSourceId());\n\t\t\t\tnewItem.setSort(lastDecomposedItem.getSort() + 1);\n\t\t\t\tnewItem.setTags(parentItem.getTags());\n\n\t\t\t\tthis.appendItem(newItem, entity.getListItemsNode(), lastDecomposedItem.getItemNode());\n\n\t\t\t\tdecomposition.addDecomposedItem(newItem);\n\n\t\t\t\tthis.sendRequestToCreateTask(entity, newItem, inputValue).then((response) => {\n\t\t\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t\t\t});\n\t\t\t\t\tentity.setItem(newItem);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tdecomposition.decomposeItem(parentItem);\n\t\t};\n\t\tconst onTagsSearchOpen = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst inputObject = data.inputObject;\n\t\t\tconst enteredHashTagName = data.enteredHashTagName;\n\t\t\tthis.tagSearcher.showTagsSearchDialog(inputObject, enteredHashTagName);\n\t\t};\n\t\tconst onTagsSearchClose = () => {\n\t\t\tthis.tagSearcher.closeTagsSearchDialog();\n\t\t};\n\t\tconst onEpicSearchOpen = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst inputObject = data.inputObject;\n\t\t\tconst enteredHashEpicName = data.enteredHashEpicName;\n\t\t\tthis.tagSearcher.showEpicSearchDialog(inputObject, enteredHashEpicName);\n\t\t};\n\t\tconst onEpicSearchClose = () => {\n\t\t\tthis.tagSearcher.closeEpicSearchDialog();\n\t\t};\n\t\tconst onFilterByEpic = (baseEvent: BaseEvent) => {\n\t\t\tconst epicId = baseEvent.getData();\n\t\t\tconst currentValue = this.filter.getValueFromField({name: 'EPIC', value: ''});\n\t\t\tif (String(epicId) === String(currentValue))\n\t\t\t{\n\t\t\t\tthis.filter.setValueToField({name: 'EPIC', value: ''});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.filter.setValueToField({name: 'EPIC', value: String(epicId)});\n\t\t\t}\n\t\t\tthis.filter.scrollToSearchContainer();\n\t\t};\n\t\tconst onFilterByTag = (baseEvent: BaseEvent) => {\n\t\t\tconst tag = baseEvent.getData();\n\t\t\tconst currentValue = this.filter.getValueFromField({name: 'TAG', value: ''});\n\t\t\tif (String(tag) === String(currentValue))\n\t\t\t{\n\t\t\t\tthis.filter.setValueToField({name: 'TAG', value: ''});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.filter.setValueToField({name: 'TAG', value: String(tag)});\n\t\t\t}\n\t\t\tthis.filter.scrollToSearchContainer();\n\t\t};\n\t\tconst onActivateGroupMode = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tif (entity.getId() !== this.backlog.getId())\n\t\t\t{\n\t\t\t\tthis.backlog.deactivateGroupMode();\n\t\t\t}\n\t\t\tthis.sprints.forEach((sprint) => {\n\t\t\t\tif (entity.getId() !== sprint.getId())\n\t\t\t\t{\n\t\t\t\t\tsprint.deactivateGroupMode();\n\t\t\t\t}\n\t\t\t});\n\t\t\tentity.getItems().forEach((item: Item) => {\n\t\t\t\titem.activateGroupMode();\n\t\t\t});\n\t\t};\n\t\tconst onDeactivateGroupMode = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tentity.getItems().forEach((item: Item) => {\n\t\t\t\titem.deactivateGroupMode();\n\t\t\t});\n\t\t};\n\t\tconst onGetSprintCompletedItems = (baseEvent: BaseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tconst listItemsNode = sprint.getListItemsNode();\n\t\t\tconst listPosition = Dom.getPosition(listItemsNode);\n\t\t\tconst loader = new Loader({\n\t\t\t\ttarget: listItemsNode,\n\t\t\t\tsize: 60,\n\t\t\t\tmode: 'inline',\n\t\t\t\tcolor: '#eaeaea',\n\t\t\t\toffset: {\n\t\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t\t}\n\t\t\t});\n\t\t\tloader.show();\n\t\t\tthis.requestSender.getSprintCompletedItems({\n\t\t\t\tsprintId: sprint.getId()\n\t\t\t}).then((response) => {\n\t\t\t\tconst itemsData = response.data;\n\t\t\t\titemsData.forEach((itemData) => {\n\t\t\t\t\tconst item = new Item(itemData);\n\t\t\t\t\titem.setDisableStatus(sprint.isDisabled());\n\t\t\t\t\tDom.append(item.render(), listItemsNode);\n\t\t\t\t\tsprint.setItem(item);\n\t\t\t\t});\n\t\t\t\tloader.hide();\n\t\t\t}).catch((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\n\t\tconst subscribeToSprint = (sprint) => {\n\t\t\tsprint.subscribe('createTaskItem', createTaskItem);\n\t\t\tsprint.subscribe('updateItem', onUpdateItem);\n\t\t\tsprint.subscribe('showTask', onShowTask);\n\t\t\tsprint.subscribe('moveItem', onMoveItem);\n\t\t\tsprint.subscribe('moveToSprint', onMoveToSprint);\n\t\t\tsprint.subscribe('moveToBacklog', onMoveToBacklog);\n\t\t\tsprint.subscribe('removeItem', onRemoveItem);\n\t\t\tsprint.subscribe('startSprint', onStartSprint);\n\t\t\tsprint.subscribe('completeSprint', onCompleteSprint);\n\t\t\tsprint.subscribe('changeTaskResponsible', onChangeTaskResponsible);\n\t\t\tsprint.subscribe('removeSprint', onRemoveSprint);\n\t\t\tsprint.subscribe('changeSprintName', onChangeSprintName);\n\t\t\tsprint.subscribe('changeSprintDeadline', onChangeSprintDeadline);\n\t\t\tsprint.subscribe('attachFilesToTask', onAttachFilesToTask);\n\t\t\tsprint.subscribe('showTagSearcher', onShowTagSearcher);\n\t\t\tsprint.subscribe('showEpicSearcher', onShowEpicSearcher);\n\t\t\tsprint.subscribe('startDecomposition', onStartDecomposition);\n\t\t\tsprint.subscribe('tagsSearchOpen', onTagsSearchOpen);\n\t\t\tsprint.subscribe('tagsSearchClose', onTagsSearchClose);\n\t\t\tsprint.subscribe('epicSearchOpen', onEpicSearchOpen);\n\t\t\tsprint.subscribe('epicSearchClose', onEpicSearchClose);\n\t\t\tsprint.subscribe('filterByEpic', onFilterByEpic);\n\t\t\tsprint.subscribe('filterByTag', onFilterByTag);\n\t\t\tsprint.subscribe('activateGroupMode', onActivateGroupMode);\n\t\t\tsprint.subscribe('deactivateGroupMode', onDeactivateGroupMode);\n\t\t\tsprint.subscribe('getSprintCompletedItems', onGetSprintCompletedItems);\n\t\t\tsprint.subscribe('showSprintBurnDownChart', onShowSprintBurnDownChart);\n\t\t};\n\n\t\tif (newSprint)\n\t\t{\n\t\t\tsubscribeToSprint(newSprint);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.backlog.subscribe('createTaskItem', createTaskItem);\n\t\tthis.backlog.subscribe('updateItem', onUpdateItem);\n\t\tthis.backlog.subscribe('showTask', onShowTask);\n\t\tthis.backlog.subscribe('moveItem', onMoveItem);\n\t\tthis.backlog.subscribe('moveToSprint', onMoveToSprint);\n\t\tthis.backlog.subscribe('removeItem', onRemoveItem);\n\t\tthis.backlog.subscribe('changeTaskResponsible', onChangeTaskResponsible);\n\t\tthis.backlog.subscribe('openAddEpicForm', onOpenAddEpicForm);\n\t\tthis.backlog.subscribe('openListEpicGrid', onOpenListEpicGrid);\n\t\tthis.backlog.subscribe('openDefinitionOfDone', onOpenDefinitionOfDone);\n\t\tthis.backlog.subscribe('attachFilesToTask', onAttachFilesToTask);\n\t\tthis.backlog.subscribe('showTagSearcher', onShowTagSearcher);\n\t\tthis.backlog.subscribe('showEpicSearcher', onShowEpicSearcher);\n\t\tthis.backlog.subscribe('startDecomposition', onStartDecomposition);\n\t\tthis.backlog.subscribe('tagsSearchOpen', onTagsSearchOpen);\n\t\tthis.backlog.subscribe('tagsSearchClose', onTagsSearchClose);\n\t\tthis.backlog.subscribe('epicSearchOpen', onEpicSearchOpen);\n\t\tthis.backlog.subscribe('epicSearchClose', onEpicSearchClose);\n\t\tthis.backlog.subscribe('filterByEpic', onFilterByEpic);\n\t\tthis.backlog.subscribe('filterByTag', onFilterByTag);\n\t\tthis.backlog.subscribe('activateGroupMode', onActivateGroupMode);\n\t\tthis.backlog.subscribe('deactivateGroupMode', onDeactivateGroupMode);\n\n\t\tthis.epic.subscribe('filterByTag', onFilterByTag);\n\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tsubscribeToSprint(sprint);\n\t\t});\n\t}\n\n\trenderSprintsContainer(): HTMLElement\n\t{\n\t\tconst createCreatingButton = () => {\n\t\t\tthis.sprintCreatingButtonNodeId = 'tasks-scrum-sprint-creating-button';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingButtonNodeId}\" class=\"tasks-scrum-sprint-create ui-btn ui-btn-md ui-btn-themes ui-btn-light-border ui-btn-icon-add\">\n\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD')}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createCreatingDropZone = () => {\n\t\t\tif (this.sprints.size)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tthis.sprintCreatingDropZoneNodeId = 'tasks-scrum-sprint-creating-drop-zone';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingDropZoneNodeId}\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-file-drop tasks-scrum-sprint-sprint-add-drop\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t<small>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_DROP')}</small>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createSprintsList = () => {\n\t\t\tthis.sprintListNodeId = 'tasks-scrum-sprint-list';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintListNodeId}\" class=\"tasks-scrum-sprint-list\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-active-list\">\n\t\t\t\t\t\t${[...this.sprints.values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isActive())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-planned-list\">\n\t\t\t\t\t\t${[...this.sprints.values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isPlanned())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-completed-list\">\n\t\t\t\t\t\t${[...this.sprints.values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isCompleted())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprints\">\n\t\t\t\t${createCreatingButton()}\n\t\t\t\t${createCreatingDropZone()}\n\t\t\t\t${createSprintsList()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateSprint(): Promise\n\t{\n\t\tDom.remove(this.sprintCreatingDropZoneNode);\n\n\t\tconst countSprints = this.sprints.size;\n\t\tconst title = Loc.getMessage('TASKS_SCRUM_SPRINT_NAME').replace('%s', countSprints + 1);\n\t\tconst storyPoints = 0;\n\t\tconst dateStart = Math.floor(Date.now() / 1000);\n\t\tconst dateEnd = (Math.floor(Date.now() / 1000) + parseInt(this.defaultSprintDuration, 10));\n\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\t\tconst sort = (sprintListNode.children.length ? sprintListNode.children.length + 1 : 1);\n\n\t\tconst sprint = Sprint.buildSprint({\n\t\t\tname: title,\n\t\t\tsort: sort,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd,\n\t\t\tstoryPoints: storyPoints\n\t\t});\n\t\tDom.append(sprint.render(), sprintListNode);\n\n\t\tconst requestData = {\n\t\t\tname: title,\n\t\t\tsort: sort,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd,\n\t\t\tsortInfo: this.calculateSprintSort()\n\t\t};\n\n\t\treturn this.requestSender.createSprint(requestData).then((response) => {\n\t\t\tsprint.setId(response.data.sprintId);\n\t\t\tsprint.onAfterAppend();\n\t\t\tsprint.getNode().scrollIntoView(true);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t\tthis.bindHandlers(sprint);\n\t\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\t\t\treturn sprint;\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tcreateItem(itemType: String, value: String): Item\n\t{\n\t\t//todo test\n\n\t\tconst valueWithoutTags = value\n\t\t\t.replace(new RegExp('#([^\\\\s]*)','g'), '')\n\t\t\t.replace(new RegExp('@([^\\\\s]*)','g'),'');\n\n\t\treturn new Item({\n\t\t\t'itemId': '',\n\t\t\t'itemType': itemType,\n\t\t\t'name': valueWithoutTags\n\t\t});\n\t}\n\n\tappendItem(item: Item, entityListNode: HTMLElement, bindItemNode: HTMLElement)\n\t{\n\t\tthis.appendItemAfterItem(item.render(), bindItemNode);\n\t\titem.onAfterAppend(entityListNode);\n\t}\n\n\tsendRequestToCreateTask(entity: Entity, item: Item, value: String): Promise\n\t{\n\t\tconst requestData = {\n\t\t\t'itemType': item.getItemType(),\n\t\t\t'name': value,\n\t\t\t'entityId': item.getEntityId(),\n\t\t\t'entityType': entity.getEntityType(),\n\t\t\t'parentId': item.getParentId(),\n\t\t\t'sort': item.getSort(),\n\t\t\t'storyPoints': item.getStoryPoints().getPoints(),\n\t\t\t'tags': item.getTags(),\n\t\t\t'epic': item.getEpic(),\n\t\t\t'parentSourceId': item.getParentSourceId(),\n\t\t\t'sortInfo': this.calculateSort(entity.getListItemsNode()),\n\t\t\t'isActiveSprint': ((entity.getEntityType() === 'sprint' && entity.isActive()) ? 'Y' : 'N')\n\t\t};\n\t\treturn this.requestSender.createTask(requestData);\n\t}\n\n\tfillItemBeforeCreation(item: Item, value: string)\n\t{\n\t\tconst tags = TagSearcher.getHashTagNamesFromText(value);\n\t\tconst epicName = TagSearcher.getHashEpicNamesFromText(value).pop();\n\t\tlet inputEpic = null;\n\t\tif (epicName)\n\t\t{\n\t\t\tinputEpic = this.tagSearcher.getEpicByName(epicName.trim());\n\t\t}\n\t\tif (inputEpic || tags.length > 0)\n\t\t{\n\t\t\titem.setEpicAndTags(inputEpic, tags);\n\t\t}\n\t\titem.setResponsible(this.defaultResponsible);\n\t}\n\n\tfillItemAfterCreation(item: Item, responseData: Object): Item\n\t{\n\t\t//todo test\n\n\t\titem.setItemId(responseData.itemId);\n\t\tif (!Type.isArray(responseData.epic) || responseData.tags.length > 0)\n\t\t{\n\t\t\titem.setEpicAndTags(responseData.epic, responseData.tags);\n\t\t}\n\t\titem.setResponsible(responseData.responsible);\n\t\titem.setSourceId(responseData.sourceId);\n\t\titem.setAllowedActions(responseData.allowedActions);\n\t}\n\n\tmoveToAnotherEntity(entityFrom: Entity, item: Item, targetEntity: ?Entity, bindButton?: HTMLElement)\n\t{\n\t\tconst isMoveToSprint = (Type.isNull(targetEntity));\n\n\t\tconst sprints = (isMoveToSprint ? this.getAvailableSprintsToMove() : null);\n\n\t\tif (entityFrom.isGroupMode())\n\t\t{\n\t\t\tif (isMoveToSprint)\n\t\t\t{\n\t\t\t\tif (sprints.size > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.showListSprintsToMove(entityFrom, item, bindButton);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (sprints.size === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.createSprint().then((sprint: Sprint) => {\n\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, targetEntity, item, false, false);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (isMoveToSprint)\n\t\t\t{\n\t\t\t\tif (sprints.size > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.showListSprintsToMove(entityFrom, item, bindButton);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\t\tif (sprints.size === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.createSprint().then((sprint: Sprint) => {\n\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\tthis.moveTo(entityFrom, targetEntity, item, false);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAvailableSprintsToMove(): Set<Sprint>\n\t{\n\t\tconst sprints = new Set();\n\t\tthis.sprints.forEach((sprint: Sprint) => {\n\t\t\tif (!sprint.isCompleted())\n\t\t\t{\n\t\t\t\tsprints.add(sprint);\n\t\t\t}\n\t\t});\n\t\treturn sprints;\n\t}\n\n\tmoveToWithGroupMode(entityFrom: Entity, entityTo: Entity, item: Item, after = true, update = true)\n\t{\n\t\t//todo test\n\t\tconst groupModeItems = entityFrom.getGroupModeItems();\n\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\tif (after)\n\t\t\t{\n\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t}\n\t\t});\n\t\tconst items = [];\n\t\tsortedItems.forEach((groupModeItem) => {\n\t\t\tthis.moveTo(entityFrom, entityTo, groupModeItem, after, update);\n\t\t\titems.push({\n\t\t\t\titemId: groupModeItem.getItemId(),\n\t\t\t\titemType: groupModeItem.getItemType(),\n\t\t\t\tentityId: entityTo.getId(),\n\t\t\t\tfromActiveSprint: ((entityFrom.getEntityType() === 'sprint' && entityFrom.isActive()) ? 'Y' : 'N'),\n\t\t\t\ttoActiveSprint: ((entityTo.getEntityType() === 'sprint' && entityTo.isActive()) ? 'Y' : 'N')\n\t\t\t});\n\t\t});\n\t\tthis.requestSender.batchUpdateItem({\n\t\t\titems: items,\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), true),\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), true)\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t\tentityFrom.deactivateGroupMode();\n\t}\n\n\tmoveTo(entityFrom: Entity, entityTo: Entity, item: Item, after = true, update = true)\n\t{\n\t\tconst itemNode = item.getItemNode();\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\t\tif (after)\n\t\t{\n\t\t\tDom.append(itemNode, entityListNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.appendItemAfterItem(itemNode, entityListNode.firstElementChild);\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\n\t\tif (update)\n\t\t{\n\t\t\tthis.onMoveItemUpdate(entityFrom, entityTo, item);\n\t\t}\n\t}\n\n\tonMoveItemUpdate(entityFrom: Entity, entityTo: Entity, item: Item)\n\t{\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\titemType: item.getItemType(),\n\t\t\tentityId: entityTo.getId(),\n\t\t\tfromActiveSprint: ((entityFrom.getEntityType() === 'sprint' && entityFrom.isActive()) ? 'Y' : 'N'),\n\t\t\ttoActiveSprint: ((entityTo.getEntityType() === 'sprint' && entityTo.isActive()) ? 'Y' : 'N'),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), true),\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), true)\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tmoveItemFromEntityToEntity(item: Item, entityFrom: Entity, entityTo: Entity)\n\t{\n\t\tif (entityFrom.isActive())\n\t\t{\n\t\t\tentityFrom.subtractTotalStoryPoints(item);\n\t\t}\n\n\t\tif (entityTo.isActive())\n\t\t{\n\t\t\tentityTo.addTotalStoryPoints(item);\n\t\t}\n\n\t\tentityFrom.removeItem(item);\n\t\titem.setParentEntity(entityTo.getId(), entityTo.getEntityType());\n\t\titem.setDisableStatus(false);\n\t\tentityTo.setItem(item);\n\t}\n\n\tshowListSprintsToMove(entityFrom: Entity, item: Item, button: HTMLElement)\n\t{\n\t\tconst id = `item-sprint-action-${entityFrom.getEntityType() + entityFrom.getId() + item.itemId}`;\n\n\t\tif (this.moveToSprintMenu)\n\t\t{\n\t\t\tif (this.moveToSprintMenu.getPopupWindow().getId() === id)\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.getPopupWindow().setBindElement(button);\n\t\t\t\tthis.moveToSprintMenu.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.moveToSprintMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveToSprintMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tif (!sprint.isCompleted() && !this.isSameSprint(entityFrom, sprint))\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.addMenuItem({\n\t\t\t\t\ttext: sprint.getName(),\n\t\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\t\tlet message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\t\t\tif (entityFrom.isGroupMode())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmessage = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\t\t\tif (entityFrom.isGroupMode())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\t\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.moveToSprintMenu.show();\n\t}\n\n\tisSameSprint(first: Sprint, second: Sprint): boolean\n\t{\n\t\treturn (first.getEntityType() === 'sprint' && first.getId() === second.getId());\n\t}\n\n\tcalculateSort(container, moveToAnotherEntity = false)\n\t{\n\t\t//todo test\n\n\t\tconst listSortInfo = {};\n\n\t\tconst items = [...container.querySelectorAll('[data-sort]')];\n\t\tlet sort = 1;\n\t\titems.forEach((itemNode) => {\n\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\tconst item = this.findItemByItemId(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.setSort(sort);\n\t\t\t\tlistSortInfo[itemId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tif (moveToAnotherEntity)\n\t\t\t\t{\n\t\t\t\t\tlistSortInfo[itemId].entityId = container.dataset.entityId;\n\t\t\t\t}\n\t\t\t\titemNode.dataset.sort = sort;\n\t\t\t}\n\t\t\tsort++;\n\t\t});\n\n\t\treturn listSortInfo;\n\t}\n\n\tcalculateSprintSort(increment = 0)\n\t{\n\t\t//todo test\n\n\t\tconst listSortInfo = {};\n\n\t\tconst container = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\n\t\tconst sprints = [...container.querySelectorAll('[data-sprint-sort]')];\n\t\tlet sort = 1 + increment;\n\t\tsprints.forEach((sprintNode) => {\n\t\t\tconst sprintId = sprintNode.dataset.sprintId;\n\t\t\tconst sprint = this.findEntityByEntityId(sprintId);\n\t\t\tif (sprint)\n\t\t\t{\n\t\t\t\tsprint.setSort(sort);\n\t\t\t\tlistSortInfo[sprintId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tsprintNode.dataset.sprintSort = sort;\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\n\t\treturn listSortInfo;\n\t}\n\n\tappendItemAfterItem (newNode, item)\n\t{\n\t\tif (item.nextElementSibling)\n\t\t{\n\t\t\tDom.insertBefore(newNode, item.nextElementSibling);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newNode, item.parentElement);\n\t\t}\n\t};\n\n\tonItemMove(dragEndEvent)\n\t{\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\tconst endContainer = dragEndEvent.endContainer;\n\n\t\tif (endContainer === this.sprintCreatingDropZoneNode)\n\t\t{\n\t\t\tconst createNewSprintAndMoveItem = () => {\n\t\t\t\tthis.createSprint().then((sprint) => {\n\t\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\t\tconst item = this.findItemByItemId(itemId);\n\t\t\t\t\tthis.moveTo(this.backlog, sprint, item);\n\t\t\t\t});\n\t\t\t};\n\t\t\tcreateNewSprintAndMoveItem();\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\n\t\tif (sourceEntityId === endEntityId)\n\t\t{\n\t\t\tconst moveInCurrentContainer = () => {\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tsortInfo: this.calculateSort(sourceContainer)\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInCurrentContainer();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst moveInAnotherContainer = () => {\n\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\tconst item = this.findItemByItemId(itemId);\n\t\t\t\tconst sourceEntity = this.findEntityByEntityId(sourceEntityId);\n\t\t\t\tconst endEntity = this.findEntityByEntityId(endEntityId);\n\t\t\t\tthis.moveItemFromEntityToEntity(item, sourceEntity, endEntity);\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tentityId: endEntity.getId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\titemType: item.getItemType(),\n\t\t\t\t\tfromActiveSprint: ((sourceEntity.getEntityType() === 'sprint' && sourceEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\ttoActiveSprint: ((endEntity.getEntityType() === 'sprint' && endEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\tsortInfo: this.calculateSort(endContainer, true)\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInAnotherContainer();\n\t\t}\n\t}\n\n\tonMoveConfirm(entity: Entity, message: string): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (entity.isActive())\n\t\t\t{\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tmessage,\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_MOVE'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\treject();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tonSprintMove(dragEndEvent)\n\t{\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.updateSprintSort({\n\t\t\tsortInfo: this.calculateSprintSort()\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tfindItemByItemId(itemId)\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn backlogItems.get(itemId);\n\t\t}\n\n\t\tconst sprint = [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t\tif (sprint)\n\t\t{\n\t\t\treturn sprint.getItems().get(itemId);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindEntityByItemId(itemId)\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t}\n\n\tfindEntityByEntityId(entityId): Entity\n\t{\n\t\tentityId = parseInt(entityId, 10);\n\n\t\tif (this.backlog.getId() === entityId)\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === entityId);\n\t}\n\n\tmoveItem(item: Item, button)\n\t{\n\t\t//todo test\n\n\t\tconst entity = this.findEntityByItemId(item.getItemId());\n\n\t\tconst listToMove = [];\n\n\t\tif (!entity.isFirstItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_UP'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\t\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsortedItems.forEach((groupModeItem) => {\n\t\t\t\t\t\t\tthis.moveItemToUp(groupModeItem, entity.getListItemsNode(), entity.hasInput(), false);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode())\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.moveItemToUp(item, entity.getListItemsNode(), entity.hasInput());\n\t\t\t\t\t}\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (!entity.isLastItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_DOWN'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\t\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsortedItems.forEach((groupModeItem) => {\n\t\t\t\t\t\t\tthis.moveItemToDown(groupModeItem, entity.getListItemsNode(), false);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode())\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.moveItemToDown(item, entity.getListItemsNode());\n\t\t\t\t\t}\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.showMoveItemMenu(item, button, listToMove);\n\t}\n\n\tshowMoveItemMenu(item, button, listToMove)\n\t{\n\t\tconst id = `item-move-${item.itemId}`;\n\n\t\tif (this.moveItemMenu)\n\t\t{\n\t\t\tthis.moveItemMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveItemMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tlistToMove.forEach((item) => {\n\t\t\tthis.moveItemMenu.addMenuItem(item);\n\t\t});\n\n\t\tthis.moveItemMenu.show();\n\t}\n\n\tmoveItemToUp(item, listItemsNode, entityWithInput = true, updateSort = true)\n\t{\n\t\tif (entityWithInput)\n\t\t{\n\t\t\tthis.appendItemAfterItem(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.insertBefore(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tmoveItemToDown(item, listItemsNode, updateSort = true)\n\t{\n\t\tDom.append(item.getItemNode(), listItemsNode);\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tupdateItemsSort(item: Item, listItemsNode: HTMLElement)\n\t{\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(listItemsNode)\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tgetBacklog(): Backlog\n\t{\n\t\treturn this.backlog;\n\t}\n\n\tgetSprints(): Map\n\t{\n\t\treturn this.sprints;\n\t}\n\n\tgetAllItems(): Map\n\t{\n\t\t//todo test\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\t[...this.sprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn items;\n\t}\n\n\topenEpicEditForm(epicId)\n\t{\n\t\tthis.epic.openEditForm(epicId);\n\t}\n\n\topenEpicViewForm(epicId)\n\t{\n\t\tthis.epic.openViewForm(epicId);\n\t}\n\n\tremoveEpic(epicId)\n\t{\n\t\tthis.requestSender.removeItem({\n\t\t\titemId: epicId,\n\t\t\titemType: 'epic'\n\t\t}).then((response) => {\n\t\t\tconst epicInfo = response.data;\n\t\t\tthis.getAllItems().forEach((item) => {\n\t\t\t\tconst itemEpic = item.getEpic();\n\t\t\t\tif (itemEpic && itemEpic.name === epicInfo.name)\n\t\t\t\t{\n\t\t\t\t\titem.setEpicAndTags(null);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.tagSearcher.removeEpicFromSearcher(epicInfo);\n\t\t\tthis.sidePanel.reloadTopSidePanel();\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tfadeOutAll()\n\t{\n\t\tthis.backlog.fadeOut();\n\t\tthis.sprints.forEach((sprint: Sprint) => {\n\t\t\tif (!sprint.isCompleted())\n\t\t\t{\n\t\t\t\tsprint.fadeOut();\n\t\t\t}\n\t\t});\n\t}\n\n\tfadeInAll()\n\t{\n\t\tthis.backlog.fadeIn();\n\t\tthis.sprints.forEach((sprint: Sprint) => {\n\t\t\tif (!sprint.isCompleted())\n\t\t\t{\n\t\t\t\tsprint.fadeIn();\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateTaskItemByItemData(itemData: Object): Item\n\t{\n\t\treturn new Item({\n\t\t\titemId: itemData.itemId,\n\t\t\titemType: itemData.itemType,\n\t\t\tname: itemData.name,\n\t\t\tentityId: itemData.entityId,\n\t\t\tentityType: itemData.entityType,\n\t\t\tparentId: itemData.parentId,\n\t\t\tsort: itemData.sort,\n\t\t\tstoryPoints: itemData.storyPoints,\n\t\t\tsourceId: itemData.sourceId,\n\t\t\tcompleted: itemData.completed,\n\t\t\tresponsible: itemData.responsible,\n\t\t\tattachedFilesCount: itemData.attachedFilesCount,\n\t\t\tcheckListComplete: itemData.checkListComplete,\n\t\t\tcheckListAll: itemData.checkListAll,\n\t\t\tnewCommentsCount: itemData.newCommentsCount,\n\t\t\tepic: itemData.epic,\n\t\t\ttags: itemData.tags,\n\t\t\tallowedActions: itemData.allowedActions\n\t\t});\n\t}\n\n\tonApplyFilter(baseEvent: BaseEvent)\n\t{\n\t\tconst filterInfo = baseEvent.getData();\n\n\t\tthis.fadeOutAll();\n\n\t\tthis.requestSender.applyFilter().then(response => {\n\t\t\tconst filteredItemsData = response.data;\n\t\t\tthis.getAllItems().forEach((item) => {\n\t\t\t\tconst entity = this.findEntityByEntityId(item.getEntityId());\n\t\t\t\tif (!entity.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tentity.removeItem(item);\n\t\t\t\t\titem.removeYourself();\n\t\t\t\t}\n\t\t\t});\n\t\t\tfilteredItemsData.forEach((itemData) => {\n\t\t\t\tconst item = this.createTaskItemByItemData(itemData);\n\t\t\t\tconst entity = this.findEntityByEntityId(item.getEntityId());\n\t\t\t\tif (!entity.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tDom.append(item.render(), entity.getListItemsNode());\n\t\t\t\t\tentity.setItem(item);\n\t\t\t\t\titem.onAfterAppend(entity.getListItemsNode());\n\t\t\t\t}\n\t\t\t});\n\t\t\tfilterInfo.promise.fulfill();\n\t\t\tthis.fadeInAll();\n\t\t\tthis.getBacklog().updateStoryPoints();\n\t\t\tthis.getSprints().forEach((sprint: Sprint) => {\n\t\t\t\tif (!sprint.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tsprint.updateStoryPoints();\n\t\t\t\t}\n\t\t\t});\n\t\t}).catch((response) => {\n\t\t\tfilterInfo.promise.reject();\n\t\t\tthis.fadeInAll();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonShowTeamSpeedChart()\n\t{\n\t\tconst projectSidePanel = new ProjectSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\t\tprojectSidePanel.showTeamSpeedChart();\n\t}\n}","import {Event, Text} from 'main.core';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\nimport {SidePanel} from '../service/side.panel';\nimport {RequestSender} from '../utility/request.sender';\n\ntype CurrentSprint = {\n\tsprintId: number,\n\tname: string\n}\n\ntype Params = {\n\tcompletedSprint: Sprint,\n\tsignedParameters: string,\n\tviews: {\n\t\tplan: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tactiveSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tcompletedSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t}\n\t},\n\tsprints: Array\n}\n\nexport class CompletedSprint\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.completedSprint = params.completedSprint;\n\n\t\tthis.requestSender = new RequestSender({\n\t\t\tsignedParameters: params.signedParameters,\n\t\t});\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.sprints = new Map();\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t});\n\t\tthis.views = params.views;\n\n\t\tthis.initDomNodes();\n\t\tthis.bindHandlers();\n\t\tthis.createTitle();\n\t}\n\n\tinitDomNodes()\n\t{\n\t\tthis.chartSprintButtonNode = document.getElementById('tasks-scrum-completed-sprint-chart');\n\t}\n\n\tbindHandlers()\n\t{\n\t\t/* eslint-disable */\n\t\tBX.addCustomEvent('onTasksGroupSelectorChange', this.onSprintSelectorChange.bind(this));\n\t\t/* eslint-enable */\n\n\t\tEvent.bind(this.chartSprintButtonNode, 'click', this.onShowSprintBurnDownChart.bind(this));\n\t}\n\n\tcreateTitle()\n\t{\n\t\tthis.titleContainer = document.getElementById('tasks-scrum-completed-sprint-title');\n\t\tthis.titleContainer.textContent = Text.encode(this.completedSprint.getName());\n\t}\n\n\tonSprintSelectorChange(currentSprint: CurrentSprint)\n\t{\n\t\tthis.completedSprint = this.findSprintBySprintId(currentSprint.sprintId);\n\n\t\tthis.titleContainer.textContent = Text.encode(currentSprint.name);\n\t}\n\n\tonShowSprintBurnDownChart()\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(this.completedSprint);\n\t}\n\n\tfindSprintBySprintId(sprintId: number): Sprint\n\t{\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === parseInt(sprintId, 10));\n\t}\n}","import {ActiveSprint} from './view/active.sprint';\nimport {Plan} from './view/plan';\nimport {CompletedSprint} from './view/completed.sprint';\nimport {Sprint} from './entity/sprint/sprint';\n\ntype View = {\n\tname: string,\n\turl: string\n}\n\ntype Responsible = {\n\tname: string,\n\tpathToUser: string,\n\tphoto: {\n\t\tsrc: string\n\t}\n}\n\ntype Params = {\n\tsignedParameters: string,\n\tdebugMode: string,\n\tviews: {\n\t\tplan: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tactiveSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tcompletedSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t}\n\t},\n\tactiveView: string,\n\tactiveSprintId: number,\n\tfilterId: string,\n\tsprints: Array, // todo\n\tpathToTask?: string,\n\tbacklog?: Object, // todo\n\tactiveSprintData?: Object, //todo\n\ttags?: Object, //todo split to epic object and tags array\n\tdefaultSprintDuration?: number,\n\tcompletedSprint?: Object, //todo\n\tdefaultResponsible: Responsible\n}\n\nexport class Entry\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.activeView = params.activeView;\n\n\t\tthis.scrumView = null;\n\n\t\tswitch (this.activeView)\n\t\t{\n\t\t\tcase 'plan':\n\t\t\t\tthis.scrumView = new Plan(params);\n\t\t\t\tbreak;\n\t\t\tcase 'activeSprint':\n\t\t\t\tthis.scrumView = new ActiveSprint(params);\n\t\t\t\tbreak;\n\t\t\tcase 'completedSprint':\n\t\t\t\tthis.scrumView = new CompletedSprint({\n\t\t\t\t\tcompletedSprint: new Sprint(params.completedSprint),\n\t\t\t\t\tsignedParameters: params.signedParameters,\n\t\t\t\t\tsprints: params.sprints,\n\t\t\t\t\tviews: params.views\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tthis.scrumView.renderTo(container);\n\t}\n\n\topenEpicEditForm(epicId: number)\n\t{\n\t\tthis.scrumView.openEpicEditForm(epicId);\n\t}\n\n\topenEpicViewForm(epicId: number)\n\t{\n\t\tthis.scrumView.openEpicViewForm(epicId);\n\t}\n\n\tremoveEpic(epicId: number)\n\t{\n\t\tthis.scrumView.removeEpic(epicId);\n\t}\n}"],"names":["RequestSender","options","signedParameters","debugMode","data","action","Promise","resolve","reject","ajax","runComponentAction","mode","then","sendRequest","response","alertTitle","Type","isUndefined","errors","console","log","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","ActionsPanel","actionPanelNodeId","bindElement","itemList","task","activity","attachment","move","sprint","backlog","tags","epic","decomposition","remove","listBlockBlurNodes","Set","Dom","document","getElementById","actionsPanelContainer","createActionPanel","setBlockBlurNode","position","getPosition","style","top","left","width","zIndex","append","body","customBlur","event","hasNode","forEach","blockBlurNode","contains","target","Event","unbind","bind","bindItems","actionsPanel","querySelector","hasClass","lastElementChild","node","add","Boolean","showTaskActionButtonNodeId","Tag","render","showAttachmentActionButtonNodeId","showMoveActionButtonNodeId","sprintActionButtonNodeId","backlogActionButtonNodeId","tagsActionButtonNodeId","epicActionButtonNodeId","decompositionActionButtonNodeId","removeActionButtonNodeId","callback","DiskManager","setEventNamespace","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","attachedIds","controlId","Text","getRandom","popup","Popup","content","getAttachmentsLoaderContent","autoHide","closeByEsc","angle","show","BX","Disk","UF","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","EventEmitter","subscribe","close","emit","filesChooser","addCustomEvent","onFileUploadSuccess","fileResult","uf","file","uploaderFile","push","element_id","toString","TaskCounts","itemId","attachedFilesCount","parseInt","checkListComplete","checkListAll","newCommentsCount","indicatorsNodeId","indicatorsNode","attachmentNode","checklistNode","commentsNode","updateVisibility","firstElementChild","textContent","innerCommentCounter","showNode","hideNode","StoryPoints","clearPoints","differencePoints","storyPoints","saveDifferencePoints","String","isNaN","parseFloat","currentStoryPoints","inputStoryPoints","firstPoints","secondPoints","Item","item","name","itemType","sort","isInteger","entityId","entityType","parentId","sourceId","parentSourceId","setPoints","responsible","isPlainObject","completed","isArray","actionsMap","taskEdit","taskRemove","setAllowedActions","allowedActions","taskCounts","itemNode","groupMode","previewMode","status","disableStatus","groupModeContainer","groupModeCheckbox","checked","toggleClass","classList","showActionsPanel","removeClass","unbindAll","addClass","previewItem","Runtime","clone","setItemId","activatePreviewMode","value","moveActivity","decompositionMode","encode","renderName","renderIndicators","renderResponsible","renderStoryPoints","renderTags","getStoryPoints","getPoints","getEpicTag","getListTagNodes","getContrastYIQ","hexcolor","Label","Color","DEFAULT","replace","r","substr","g","b","yiq","epicLabel","text","color","size","Size","MD","customClass","container","getContainer","innerLabel","contrast","info","isGroupMode","clickToGroupModeCheckbox","id","map","tag","tagLabel","TAG_LIGHT","fill","SM","onAfterAppend","updateResponsible","isPreviewMode","onItemClick","nameNode","onNameClick","responsibleNode","onResponsibleClick","storyPointsNode","onStoryPointsClick","nameTextNode","setDisableStatus","isClickOnEditableName","ignoreTagList","has","tagName","targetNode","contentEditable","isDisabled","currentTarget","borderNode","valueNode","trim","oldValue","placeCursorAtEnd","blockEnterInput","bindOnce","newValue","click","selector","Tasks","Integration","Socialnetwork","NetworkSelector","scope","query","useSearch","useAdd","parent","popupOffsetLeft","bindEvent","nameFormatted","photo","src","avatar","open","setStoryPoints","isComposing","keyCode","blur","isShown","stopPropagation","destroy","diskManager","ufDiskFilesFieldName","subscribeOnce","baseEvent","getData","showAttachmentMenu","confirm","messageBox","showPanel","isString","dataset","updateTagsContainer","newContainer","tagsContainerNode","attr","focus","selection","window","getSelection","range","createRange","selectNodeContents","collapse","removeAllRanges","addRange","updateIndicators","TagSearcher","allTags","Map","set","tabs","epicName","description","get","delete","values","tagsList","epicList","getCurrentActionsPanel","currentTags","getTags","selectedItems","currentTag","createTag","tagDialog","getTagSelector","getTextBoxValue","focusSearch","addTagToSearcher","newTag","getTagFromSearcher","addItem","select","clearTextBox","selectFirstTab","label","choiceWasMade","Dialog","getItemId","height","multiple","dropdownMode","enableSearch","items","getTagsList","events","selectedItem","deselectedItem","tagSelectorOptions","onInput","dialog","getDialog","footer","currentEpic","getEpic","currentEpicInfo","getEpicList","epicId","setTimeout","getSelectedItems","hide","placeholder","inputObject","enteredHashTagName","input","getInputNode","tagsDialog","getId","getNodeId","getNode","offsetWidth","selectedHashTag","hashTags","getHashTagsFromText","enteredHashTag","pop","RegExp","deselect","setTagsSearchMode","search","enteredHashEpicName","epicDialog","selectedHashEpic","setEpicId","setEpicSearchMode","inputText","regex","matches","match","exec","Input","nodeId","disabled","setNode","onTagSearch","onEpicSearch","onKeydown","inputNode","enteredHashTags","getHashTagNamesFromText","isTagsSearchMode","enteredHashEpics","getHashEpicNamesFromText","isEpicSearchMode","onCreateTaskItem","GroupActionsButton","element","onClick","ListItems","entity","isCompleted","getInput","getItems","Entity","entityData","views","numberTasks","groupModeItems","groupActionsButton","listItems","onActivateGroupMode","onDeactivateGroupMode","setEntityId","getElement","newItem","subscribeToItem","setItemMoveActivity","addNumberTasks","setMoveActivity","unsubscribeAll","subtractNumberTasks","getTarget","updateStoryPoints","getListItemsNode","button","getGroupModeItems","groupModeItem","removeItem","removeYourself","addItemToGroupMode","removeItemFromGroupMode","addPoints","listItemsNode","getItemNode","hasInput","nextElementSibling","isEqualNode","deactivateGroupMode","disable","unDisable","clear","SprintDate","defaultSprintDuration","getDefaultSprintDuration","startTimestamp","endTimestamp","isActive","dateStart","date","format","dateEnd","renderNode","timestamp","dateStartNode","dateEndNode","parentPopup","closest","calendar","showCalendar","field","bTime","bSetFocus","bHideTime","updateDateNode","Math","floor","parseDate","getTime","dateStartInput","dateEndInput","sprintId","weekCount","StatsCalculator","first","second","result","round","StatsHeader","setSprintData","statsCalculator","headerNode","headerClass","kanbanMode","getTotalStoryPoints","setCompletedStoryPoints","getTotalCompletedStoryPoints","setEndDate","getDateEnd","completedStoryPoints","endDate","Date","now","CompletedStatsHeader","percentage","calculatePercentage","getCompletedStoryPoints","completedDate","getCompletedDate","getEndDate","ExpiredStatsHeader","expiredDay","getExpiredDay","ActiveStatsHeader","remainingDays","getRemainingDays","StatsHeaderBuilder","isExpired","SprintHeader","statsHeader","sprintDate","buttonClass","buttonText","buttonNode","isPlanned","className","firstChild","replaceWith","headerNodeId","tickAngleClass","renderDragnDrop","getName","renderRemove","renderStatsHeader","createDate","getDateStart","createButton","updateStats","updateDateStartNode","updateDateEndNode","buttonNodeId","onButtonClick","editButtonNode","removeNode","tickButtonNode","toggle","sprintHeader","addHeaderStats","build","addHeaderDate","EventsHeader","StoryPointsHeader","totalStoryPointsNode","inWorkStoryPointsNode","getUncompletedStoryPoints","doneStoryPointsNode","renderBurnDownChartIcon","getNumberTasks","getElementByClassName","parentNode","elements","elem","Sprint","sprintData","totalStoryPoints","totalCompletedStoryPoints","totalUncompletedStoryPoints","uncompletedStoryPoints","completedTasks","unCompletedTasks","itemData","eventsHeader","storyPointsHeader","initStyle","onChangeName","onRemoveSprint","onChangeSprintDeadline","toggleVisibilityContent","sprintEndTime","currentTime","setHours","getHours","updateNumberTasks","epics","renderLinkToCompletedSprint","completedSprint","url","contentNode","showContent","updateActiveSprintStoryPointsHeader","updateStatsHeader","getDifferencePoints","addTotalStoryPoints","subtractTotalStoryPoints","itemStoryPoints","getTotalUncompletedStoryPoints","subtractPoints","setUncompletedStoryPoints","updateTotalStoryPoints","createInput","setSelectionRange","requestData","hasOwnProperty","display","hideContent","addSprintHeader","buildHeader","addEventsHeader","addStoryPointsHeader","addGroupActionsButton","addListItems","SidePanel","sidePanelManager","Instance","bindEvents","getCompatData","sliderEvent","sidePanel","getSlider","setCacheable","popupWindow","topSlider","getTopSlider","topSidePanelZIndex","getZindex","popupWindowZIndex","getPopupContainer","currentSidePanel","getPreviousSlider","reload","previousSidePanel","BurnDownChart","chartDiv","am4core","useTheme","am4themes_animated","chart","create","am4charts","XYChart","paddingRight","createAxises","createIdealLine","createRemainLine","createLegend","categoryAxis","xAxes","CategoryAxis","renderer","grid","template","location","dataFields","category","minGridDistance","valueAxis","yAxes","ValueAxis","min","lineSeries","series","LineSeries","stroke","strokeWidth","categoryX","valueY","circleColor","circleBullet","CircleBullet","circle","radius","bullets","segment","segments","hoverState","states","properties","legend","Legend","itemContainers","clickable","on","processOver","dataItem","dataContext","processOut","hoveredLine","toFront","each","setState","bulletsContainer","dispose","SprintSidePanel","params","sprints","requestSender","currentSprint","uncompletedItems","lastCompletedSprint","getLastCompletedSprint","sidePanelId","onLoadStartPanel","openSidePanel","contentCallback","buildStartPanel","onLoadCompletePanel","buildCompletePanel","onLoadSprintBurnDownPanel","onCloseBurnDownChart","buildBurnDownPanel","differenceStoryPoints","getDifferenceStoryPointsBetweenSprints","getEpics","form","onLoadStartButtons","buttonsContainer","onStartSprint","buildSprintGoal","buildSprintActions","buildSprintPlan","sprintInfo","getInfo","sprintGoal","uncompletedTasks","getUnCompletedTasks","listSprintsOptions","getUncompletedItems","getPreviewVersion","differencePercentage","getDifferencePercentageBetweenSprints","percentageNodeClass","absoluteValue","abs","speedInfoMessage","renderSpeed","itemsContainer","onLoadCompleteButtons","onCompleteSprint","getBurnDownChartData","burnDownChart","createChart","getUrl","destroyBurnDownChart","count","find","firstSprint","secondSprint","difference","firstPercentage","secondPercentage","getSprintStartButtons","html","getSprintCompleteButtons","getRequestDataToGetBurnDownChartData","getStartButtons","buttonsHtml","getCompleteButtons","startSprint","getRequestDataToStartSprint","setStatus","href","catch","removeClockIconFromButton","showErrorAlert","completeSprint","getRequestDataToCompleteSprint","Confetti","fire","particleCount","spread","origin","x","y","directionSelectNode","direction","ActiveSprint","pathToTask","activeSprintData","finishStatus","itemsInFinishStage","initDomNodes","createSprintStats","bindHandlers","sprintStatsContainer","chartSprintButtonNode","completeSprintButtonNode","setKanbanStyle","onShowSprintBurnDownChart","Kanban","onKanbanRender","onItemMoved","sprintSidePanel","showCompleteSidePanel","openSidePanelByUrl","getSourceId","kanbanGrid","Object","prototype","call","getColumn","getType","kanbanItem","targetColumn","beforeItem","type","updateStatsAfterMovedToFinish","updateStatsAfterMovedFromFinish","setCompletedTasks","getCompletedTasks","setUnCompletedTasks","scrumItem","setCompleted","showBurnDownChart","Header","EpicCreationButton","Backlog","backlogData","header","epicCreationButton","addHeader","addEpicCreationButton","Epic","defaultColor","selectedColor","onLoadAddForm","buildAddForm","onLoadEditForm","buildEditForm","onLoadViewForm","buildViewForm","onBeforeGridRequest","onLoadListGrid","destroyGrid","onLoadEditor","onLoadColorPicker","onLoadAddButtons","createEpic","getRequestData","isPreviousSidePanelExist","reloadPreviousSidePanel","openEpicsList","onLoadDescription","onLoadFiles","onLoadViewButtons","openEditForm","onLoadEditButtons","editEpic","reloadGrid","Main","gridManager","getById","gridId","instance","getDescriptionEditor","editorHtml","descriptionContainer","editor","LHEPostForm","getHandler","BXHtmlEditor","Get","eventNode","getEpicDescription","filesContainer","getEpicFiles","colorBlockNode","colorNode","picker","getColorPicker","getAddEpicFormButtons","getViewEpicFormButtons","list","getEpicsList","responseData","prepareTagsList","openAddForm","getEmptyEpicListForm","eventArgs","sessid","bitrix_sessid","method","getEpicListUrl","getSignedParameters","buildFormHeader","buildFormContainerHeader","editorId","getEpicDescriptionEditor","getViewEpicFormButtonsAction","ColorPicker","onColorSelected","backgroundColor","popupOptions","colors","oEditor","GetContent","files","getAttachmentsFiles","arFiles","controllers","fileControllers","controller","includes","fileController","keys","fileId","tagsContainers","querySelectorAll","tagsContainer","getTagsFromNode","clean","getTagNode","childNodes","childNode","closeTopSidePanel","Decomposition","setPlaceholder","addDecomposedItem","insertAfter","onCreateItem","deactivateDecompositionMode","activateDecompositionMode","Filter","filterId","scrumManager","initUiFilterManager","filterManager","onApplyFilter","getSearch","filterSearchContainer","getSearchContainer","isNodeInViewport","scrollIntoView","filterInstance","promise","autoResolve","fieldInstances","getField","fieldOptions","getFieldByName","ITEMS","itemsNode","filterApi","getApi","filterFieldsValues","getFilterFieldsValues","setFields","apply","resetFilter","rect","getBoundingClientRect","bottom","innerHeight","documentElement","clientHeight","right","innerWidth","clientWidth","TeamSpeedChart","scrollbarX","Scrollbar","bottomAxesContainer","createColumn","xAxis","yAxis","ColumnSeries","paddingBottom","ProjectSidePanel","onLoadTeamSpeedChartPanel","onCloseTeamSpeedChart","buildTeamSpeedPanel","onLoadDodPanel","buildDodPanel","getTeamSpeedChartData","teamSpeedChart","destroyChart","getDodComponent","dodContainer","getDodPanelData","prepareDodOptionsContainer","getDodButtons","saveDod","getRequestDataForSaveList","getEntityChecklistItems","required","getDodItemsRequired","CheckListInstance","treeStructure","getTreeStructure","optionsContainer","option","Plan","activeSprintId","buildBacklog","buildSprint","tagSearcher","addEpicToSearcher","filter","addItemToListTypeField","NAME","VALUE","defaultResponsible","isDomNode","Error","scrumContainer","renderSprintsContainer","sprintCreatingButtonNode","sprintCreatingButtonNodeId","sprintCreatingDropZoneNode","sprintCreatingDropZoneNodeId","sprintListNode","sprintListNodeId","createSprint","setDraggable","draggableItems","Draggable","draggable","dragElement","DROP_PREVIEW","delay","dragEndEvent","sourceContainer","sourceEntityId","sourceEntity","findEntityByEntityId","endContainer","endEntityId","onItemMove","onMoveConfirm","source","findItemByItemId","itemNodeAfterSourceItem","children","getSort","insertBefore","draggableSprints","onSprintMove","newSprint","teamSpeedChartButtonContainerNode","onShowTeamSpeedChart","createTaskItem","inputValue","createItem","setParentEntity","getEntityType","setSort","appendItem","fillItemBeforeCreation","setParentId","getEpicId","sendRequestToCreateTask","fillItemAfterCreation","setItem","onUpdateItem","updateItem","onShowTask","onMoveItem","moveItem","onMoveToSprint","moveToAnotherEntity","onMoveToBacklog","onAttachFilesToTask","attachFilesToTask","taskId","onRemoveItem","getItemType","batchRemoveItem","sortInfo","calculateSort","showStartSidePanel","onChangeTaskResponsible","changeTaskResponsible","gerResponsible","removeSprint","calculateSprintSort","onChangeSprintName","changeSprintName","changeSprintDeadline","onOpenAddEpicForm","onOpenListEpicGrid","innerBaseEvent","updatedEpicInfo","oldEpicInfo","getCurrentEpic","getAllItems","itemEpic","setEpicAndTags","removeEpicFromSearcher","onOpenDefinitionOfDone","projectSidePanel","showDefinitionOfDone","onShowTagSearcher","actionsPanelButton","showTagsDialog","tasks","batchAttachTagToTask","attachTagToTask","batchDeattachTagToTask","splice","indexOf","deAttachTagToTask","onShowEpicSearcher","showEpicDialog","batchUpdateItemEpic","updateItemEpic","onStartDecomposition","parentItem","onTagsSearchOpen","onTagsSearchClose","decomposedItems","getDecomposedItems","lastDecomposedItem","Array","from","getParentId","setParentSourceId","setTags","decomposeItem","showTagsSearchDialog","closeTagsSearchDialog","onEpicSearchOpen","showEpicSearchDialog","onEpicSearchClose","closeEpicSearchDialog","onFilterByEpic","currentValue","getValueFromField","setValueToField","scrollToSearchContainer","onFilterByTag","activateGroupMode","onGetSprintCompletedItems","listPosition","loader","Loader","offset","getSprintCompletedItems","itemsData","subscribeToSprint","createCreatingButton","createCreatingDropZone","createSprintsList","countSprints","setId","addContainer","valueWithoutTags","entityListNode","bindItemNode","appendItemAfterItem","getEntityId","getParentSourceId","createTask","inputEpic","getEpicByName","setResponsible","setSourceId","entityFrom","targetEntity","bindButton","isMoveToSprint","isNull","getAvailableSprintsToMove","showListSprintsToMove","moveToWithGroupMode","moveTo","entityTo","after","update","sortedItems","fromActiveSprint","toActiveSprint","batchUpdateItem","moveItemFromEntityToEntity","onMoveItemUpdate","moveToSprintMenu","getPopupWindow","setBindElement","Menu","isSameSprint","addMenuItem","onclick","menuItem","getMenuWindow","listSortInfo","increment","sprintNode","sprintSort","newNode","parentElement","createNewSprintAndMoveItem","moveInCurrentContainer","updateItemSort","moveInAnotherContainer","endEntity","updateSprintSort","backlogItems","findEntityByItemId","listToMove","isFirstItem","moveItemToUp","isLastItem","moveItemToDown","showMoveItemMenu","moveItemMenu","entityWithInput","updateSort","updateItemsSort","openViewForm","epicInfo","reloadTopSidePanel","fadeOut","fadeIn","filterInfo","fadeOutAll","applyFilter","filteredItemsData","createTaskItemByItemData","fulfill","fadeInAll","getBacklog","getSprints","showTeamSpeedChart","CompletedSprint","createTitle","onSprintSelectorChange","titleContainer","findSprintBySprintId","Entry","activeView","scrumView","renderTo","openEpicEditForm","openEpicViewForm","removeEpic"],"mappings":"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"}