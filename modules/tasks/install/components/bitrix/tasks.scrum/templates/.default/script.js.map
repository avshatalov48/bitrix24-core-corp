{"version":3,"file":"script.js","sources":["src/request.sender.js","src/actions.header.js","src/actions.panel.js","src/disk.manager.js","src/taskcounts.js","src/item.js","src/tag.searcher.js","src/input.js","src/entity.js","src/backlog.js","src/sprint.stats.js","src/sprint.date.js","src/sprint.header.js","src/sprint.js","src/sprint.popup.js","src/kanban.js","src/side.panel.js","src/epic.js","src/decomposition.js","src/filter.js","src/scrum.js"],"sourcesContent":["import {ajax} from 'main.core';\n\nexport class RequestSender\n{\n\tconstructor(options = {})\n\t{\n\t\tthis.signedParameters = (options.signedParameters ? options.signedParameters : '');\n\t\tthis.debugMode = options.debugMode;\n\t}\n\n\tgetSignedParameters()\n\t{\n\t\treturn this.signedParameters;\n\t}\n\n\tsendRequest(data = {}, action)\n\t{\n\t\tdata.debugMode = this.debugMode;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runComponentAction('bitrix:tasks.scrum', action, {\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tupdateItemSort(data)\n\t{\n\t\treturn this.sendRequest(data, 'updateItemSort');\n\t}\n\n\tupdateSprintSort(data)\n\t{\n\t\treturn this.sendRequest(data, 'updateSprintSort');\n\t}\n\n\tcreateSprint(data)\n\t{\n\t\treturn this.sendRequest(data, 'createSprint');\n\t}\n\n\tstartSprint(data)\n\t{\n\t\treturn this.sendRequest(data, 'startSprint');\n\t}\n\n\tcompleteSprint(data)\n\t{\n\t\treturn this.sendRequest(data, 'completeSprint');\n\t}\n\n\tcreateTask(data)\n\t{\n\t\treturn this.sendRequest(data, 'createTask');\n\t}\n\n\tupdateItem(data)\n\t{\n\t\treturn this.sendRequest(data, 'updateItem');\n\t}\n\n\tremoveItem(data)\n\t{\n\t\treturn this.sendRequest(data, 'removeItem');\n\t}\n\n\tchangeTaskResponsible(data)\n\t{\n\t\treturn this.sendRequest(data, 'changeTaskResponsible');\n\t}\n\n\tremoveSprint(data)\n\t{\n\t\treturn this.sendRequest(data, 'removeSprint');\n\t}\n\n\tchangeSprintName(data)\n\t{\n\t\treturn this.sendRequest(data, 'changeSprintName');\n\t}\n\n\tchangeSprintDeadline(data)\n\t{\n\t\treturn this.sendRequest(data, 'changeSprintDeadline');\n\t}\n\n\tgetEpicDescriptionEditor(data)\n\t{\n\t\treturn this.sendRequest(data, 'getEpicDescriptionEditor');\n\t}\n\n\tgetEpicDescription(data)\n\t{\n\t\treturn this.sendRequest(data, 'getEpicDescription');\n\t}\n\n\tgetEpicFiles(data)\n\t{\n\t\treturn this.sendRequest(data, 'getEpicFiles');\n\t}\n\n\tgetAddEpicFormButtons(data)\n\t{\n\t\treturn this.sendRequest(data, 'getAddEpicFormButtons');\n\t}\n\n\tgetViewEpicFormButtonsAction(data)\n\t{\n\t\treturn this.sendRequest(data, 'getViewEpicFormButtons');\n\t}\n\n\tcreateEpic(data)\n\t{\n\t\treturn this.sendRequest(data, 'createEpic');\n\t}\n\n\tgetEpicsList(data)\n\t{\n\t\treturn this.sendRequest(data, 'getEpicsList');\n\t}\n\n\tgetEpicListUrl()\n\t{\n\t\treturn '/bitrix/services/main/ajax.php?mode=class&c=bitrix:tasks.scrum&action=getEpicsList';\n\t}\n\n\tattachFilesToTask(data)\n\t{\n\t\treturn this.sendRequest(data, 'attachFilesToTask');\n\t}\n\n\tattachTagToTask(data)\n\t{\n\t\treturn this.sendRequest(data, 'attachTagToTask');\n\t}\n\n\tdeAttachTagToTask(data)\n\t{\n\t\treturn this.sendRequest(data, 'deAttachTagToTask');\n\t}\n\n\tattachEpicToItem(data)\n\t{\n\t\treturn this.sendRequest(data, 'attachEpicToItem');\n\t}\n\n\tdeAttachEpicToItem(data)\n\t{\n\t\treturn this.sendRequest(data, 'deAttachEpicToItem');\n\t}\n\n\tgetEpic(data)\n\t{\n\t\treturn this.sendRequest(data, 'getEpic');\n\t}\n\n\teditEpic(data)\n\t{\n\t\treturn this.sendRequest(data, 'editEpic');\n\t}\n\n\tremoveEpic(data)\n\t{\n\t\treturn this.sendRequest(data, 'removeEpic');\n\t}\n\n\tapplyFilter(data)\n\t{\n\t\treturn this.sendRequest(data, 'applyFilter');\n\t}\n}","import {EventEmitter} from 'main.core.events';\nimport {Dom, Event, Loc, Tag} from 'main.core';\n\nexport class ActionsHeader extends EventEmitter\n{\n\tconstructor(entity)\n\t{\n\t\tsuper(entity);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ActionsHeader');\n\n\t\tthis.entity = entity;\n\t\tthis.headerId = this.entity.getEntityType() + '-' + this.entity.getId();\n\t}\n\n\tcreateActionsHeader(): ?HTMLElement\n\t{\n\t\tif (this.entity.getEntityType() === 'sprint')\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.nodeId = 'tasks-scrum-actions-header-' + this.headerId;\n\t\t\n\t\tconst getAddEpicActionNode = () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-action-epic\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t};\n\n\t\tconst getGroupActions = () => {\n\t\t\treturn '';\n\t\t\treturn Tag.render`\n\t\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-action-group\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_GROUP')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.nodeId}\" class=\"tasks-scrum-actions-header\">\n\t\t\t\t<div class=\"tasks-scrum-actions\">\n\t\t\t\t\t${getAddEpicActionNode()}\n\t\t\t\t\t${getGroupActions()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tif (this.entity.isDisabled() || this.entity.getEntityType() === 'sprint')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.node = document.getElementById(this.nodeId);\n\n\t\tconst addEpicNode = this.node.querySelector('.tasks-scrum-action-epic');\n\t\tEvent.bind(addEpicNode, 'click', () => this.emit('openAddEpicForm'));\n\t}\n}","import {Dom, Event, Loc, Tag} from 'main.core';\n\nimport './css/actions-panel.css';\n\nexport class ActionsPanel\n{\n\tconstructor(options)\n\t{\n\t\tthis.actionPanelNodeId = 'tasks-scrum-actions-panel';\n\n\t\tthis.bindElement = options.bindElement;\n\n\t\tthis.itemList = {...{\n\t\t\ttask: {activity: false},\n\t\t\tattachment: {activity: false},\n\t\t\tmove: {activity: false},\n\t\t\tsprint: {activity: false},\n\t\t\tbacklog: {activity: false},\n\t\t\ttags: {activity: false},\n\t\t\tepic: {activity: false},\n\t\t\tdecomposition: {activity: false},\n\t\t\tremove: {activity: false},\n\t\t}, ...options.itemList};\n\n\t\tthis.listBlockBlurNodes = new Set();\n\t}\n\n\tshowPanel()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\n\t\tconst actionsPanelContainer = this.createActionPanel();\n\t\tthis.setBlockBlurNode(actionsPanelContainer);\n\n\t\tconst position = Dom.getPosition(this.bindElement);\n\n\t\tactionsPanelContainer.style.top = `${position.top}px`;\n\t\tactionsPanelContainer.style.left = `${position.left}px`;\n\t\tactionsPanelContainer.style.width = `${position.width}px`;\n\n\t\tDom.append(actionsPanelContainer, document.body);\n\n\t\tconst customBlur = (event) => {\n\t\t\tlet hasNode = false;\n\t\t\tthis.listBlockBlurNodes.forEach((blockBlurNode) => {\n\t\t\t\tif (blockBlurNode.contains(event.target))\n\t\t\t\t{\n\t\t\t\t\thasNode = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!hasNode)\n\t\t\t{\n\t\t\t\tDom.remove(actionsPanelContainer);\n\t\t\t\tEvent.unbind(document, 'click', customBlur);\n\t\t\t}\n\t\t};\n\t\tEvent.bind(document, 'click', customBlur);\n\n\t\tthis.bindItems();\n\n\t\tconst actionsPanel =  actionsPanelContainer.querySelector('.tasks-scrum-actions-panel');\n\t\tif (Dom.hasClass(actionsPanel.lastElementChild, 'tasks-scrum-actions-panel-separator'))\n\t\t{\n\t\t\tDom.remove(actionsPanel.lastElementChild);\n\t\t}\n\t}\n\n\tsetBlockBlurNode(node)\n\t{\n\t\tthis.listBlockBlurNodes.add(node);\n\t}\n\n\tisShown(): Boolean\n\t{\n\t\treturn Boolean(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tcreateActionPanel()\n\t{\n\t\tlet task = '';\n\t\tlet attachment = '';\n\t\tlet move = '';\n\t\tlet sprint = '';\n\t\tlet backlog = '';\n\t\tlet tags = '';\n\t\tlet epic = '';\n\t\tlet decomposition = '';\n\t\tlet remove = '';\n\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tthis.showTaskActionButtonNodeId = 'tasks-scrum-actions-panel-btn-task';\n\t\t\ttask = Tag.render`\n\t\t\t\t<div id=\"${this.showTaskActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-task\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TASK')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tthis.showAttachmentActionButtonNodeId = 'tasks-scrum-actions-panel-btn-attachment';\n\t\t\tattachment = Tag.render`\n\t\t\t\t<div id=\"${this.showAttachmentActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-attachment\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tthis.showMoveActionButtonNodeId = 'tasks-scrum-actions-panel-btn-move';\n\t\t\tmove = Tag.render`\n\t\t\t\t<div id=\"${this.showMoveActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-move\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tthis.sprintActionButtonNodeId = 'tasks-scrum-actions-panel-btn-sprint';\n\t\t\tsprint = Tag.render`\n\t\t\t\t<div id=\"${this.sprintActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-sprint\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_SPRINT')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tthis.backlogActionButtonNodeId = 'tasks-scrum-actions-panel-btn-backlog';\n\t\t\tbacklog = Tag.render`\n\t\t\t\t<div id=\"${this.backlogActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-backlog\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_BACKLOG')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tthis.tagsActionButtonNodeId = 'tasks-scrum-actions-panel-btn-tags';\n\t\t\ttags = Tag.render`\n\t\t\t\t<div  id=\"${this.tagsActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TAGS')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tthis.epicActionButtonNodeId = 'tasks-scrum-actions-panel-btn-epic';\n\t\t\tepic = Tag.render`\n\t\t\t\t<div  id=\"${this.epicActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_EPIC')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tthis.decompositionActionButtonNodeId = 'tasks-scrum-actions-panel-btn-decomposition';\n\t\t\tdecomposition = Tag.render`\n\t\t\t\t<div  id=\"${this.decompositionActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-decomposition\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tthis.removeActionButtonNodeId = 'tasks-scrum-actions-panel-btn-remove';\n\t\t\tremove = Tag.render`\n\t\t\t\t<div  id=\"${this.removeActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-remove\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.actionPanelNodeId}\" class=\"tasks-scrum-actions-panel-container\">\n\t\t\t\t<div class=\"tasks-scrum-actions-panel\">\n\t\t\t\t\t${task}\n\t\t\t\t\t${attachment}\n\t\t\t\t\t${move}\n\t\t\t\t\t${sprint}\n\t\t\t\t\t${backlog}\n\t\t\t\t\t${tags}\n\t\t\t\t\t${epic}\n\t\t\t\t\t${decomposition}\n\t\t\t\t\t${remove}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tbindItems()\n\t{\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showTaskActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.task.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showAttachmentActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.attachment.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showMoveActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.move.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.sprintActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.sprint.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.backlogActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.backlog.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.tagsActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.tags.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.epicActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.epic.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.removeActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.remove.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.decompositionActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.decomposition.callback\n\t\t\t);\n\t\t}\n\t}\n}","import {Loc, Tag, Text} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\n\nimport './css/disk.manager.css';\n\nexport class DiskManager extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DiskManager');\n\n\t\tthis.diskUrls = {\n\t\t\turlSelect: '/bitrix/tools/disk/uf.php?action=selectFile&SITE_ID=' + Loc.getMessage('SITE_ID'),\n\t\t\turlRenameFile: '/bitrix/tools/disk/uf.php?action=renameFile',\n\t\t\turlDeleteFile: '/bitrix/tools/disk/uf.php?action=deleteFile',\n\t\t\turlUpload: '/bitrix/tools/disk/uf.php?action=uploadFile&ncc=1'\n\t\t};\n\n\t\tthis.attachedIds = [];\n\t}\n\n\tshowAttachmentMenu(node)\n\t{\n\t\tconst controlId = Text.getRandom();\n\n\t\tthis.popup = new Popup(\n\t\t\t`disk-manager-attachment-menu-${Text.getRandom()}`,\n\t\t\tnode,\n\t\t\t{\n\t\t\t\tcontent: this.getAttachmentsLoaderContent(controlId),\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: false,\n\t\t\t});\n\n\t\tthis.popup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: controlId,\n\t\t\tcontrolName: `[${controlId}][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect: this.diskUrls.urlSelect,\n\t\t\turlRenameFile: this.diskUrls.urlRenameFile,\n\t\t\turlDeleteFile: this.diskUrls.urlDeleteFile,\n\t\t\turlUpload: this.diskUrls.urlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.popup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show']\n\t\t);\n\n\t\tEventEmitter.subscribe('onFinish', () => {\n\t\t\tthis.popup.close();\n\t\t\tthis.emit('onFinish', this.attachedIds);\n\t\t});\n\t}\n\n\tgetAttachmentsLoaderContent(controlId)\n\t{\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t<div id=\"diskuf-selectdialog-${controlId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t<div class=\"diskuf-files-block\">\n\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t<input type=\"hidden\" name=\"[${controlId}][]\" value=\"\"/>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<label for=\"file_loader_${controlId}\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${controlId}\" type=\n\t\t\t\t\t\t\t\"file\" multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.onFileUploadSuccess.bind(this));\n\t\t//todo show loader\n\n\t\treturn filesChooser;\n\t}\n\n\tonFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.attachedIds.push(fileResult.element_id.toString());\n\t}\n}","import {Dom, Tag, Text} from \"main.core\";\n\nexport class TaskCounts\n{\n\tconstructor(options)\n\t{\n\t\tthis.itemId = (options.itemId ? options.itemId : Text.getRandom());\n\n\t\tthis.attachedFilesCount = (options.attachedFilesCount ? parseInt(options.attachedFilesCount, 10) : 0);\n\t\tthis.checkListComplete = (options.checkListComplete ? parseInt(options.checkListComplete, 10) : 0);\n\t\tthis.checkListAll = (options.checkListAll ? parseInt(options.checkListAll, 10) : 0);\n\t\tthis.newCommentsCount = (options.newCommentsCount ? parseInt(options.newCommentsCount, 10) : 0);\n\t}\n\n\tcreateIndicators(): ?HTMLElement\n\t{\n\t\tthis.indicatorsNodeId = 'tasks-scrum-item-indicators-' + this.itemId;\n\t\treturn Tag.render`\n\t\t\t<span id=\"${this.indicatorsNodeId}\" class=\"task-title-indicators\">\n\t\t\t\t<div class=\"task-attachment-counter ui-label ui-label-sm ui-label-light\">\n\t\t\t\t\t<span class=\"ui-label-inner\">${this.attachedFilesCount}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-checklist-counter ui-label ui-label-sm ui-label-light'>\n\t\t\t\t\t<span class='ui-label-inner'>${this.checkListComplete}/${this.checkListAll}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-comments-counter'>\n\t\t\t\t\t<div class='ui-counter ui-counter-success'>\n\t\t\t\t\t\t<div class='ui-counter-inner'>${this.newCommentsCount}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.indicatorsNode = document.getElementById(this.indicatorsNodeId);\n\n\t\tthis.attachmentNode = this.indicatorsNode.querySelector('.task-attachment-counter');\n\t\tthis.checklistNode = this.indicatorsNode.querySelector('.task-checklist-counter');\n\t\tthis.commentsNode = this.indicatorsNode.querySelector('.task-comments-counter');\n\n\t\tthis.updateVisibility();\n\t}\n\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (!this.indicatorsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.attachedFilesCount)\n\t\t{\n\t\t\tthis.attachedFilesCount = parseInt(data.attachedFilesCount, 10);\n\t\t\tthis.attachmentNode.firstElementChild.textContent = this.attachedFilesCount;\n\t\t}\n\t\tif (data.checkListComplete)\n\t\t{\n\t\t\tthis.checkListComplete = parseInt(data.checkListComplete, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\t\tif (data.checkListAll)\n\t\t{\n\t\t\tthis.checkListAll = parseInt(data.checkListAll, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\t\tif (data.newCommentsCount)\n\t\t{\n\t\t\tthis.newCommentsCount = parseInt(data.newCommentsCount, 10);\n\t\t\tconst innerCommentCounter = this.commentsNode.querySelector('.ui-counter-inner');\n\t\t\tinnerCommentCounter.textContent = this.newCommentsCount;\n\t\t}\n\n\t\tthis.updateVisibility();\n\t}\n\n\tupdateVisibility()\n\t{\n\t\tif (this.attachedFilesCount > 0)\n\t\t{\n\t\t\tthis.showNode(this.attachmentNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.attachmentNode);\n\t\t}\n\n\t\tif (this.checkListAll > 0)\n\t\t{\n\t\t\tthis.showNode(this.checklistNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.checklistNode);\n\t\t}\n\n\t\tif (this.newCommentsCount > 0)\n\t\t{\n\t\t\tthis.showNode(this.commentsNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.commentsNode);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'inline-flex');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}","import {Type, Dom, Event, Tag, Text, Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {ActionsPanel} from './actions.panel';\nimport {Label} from 'ui.label';\nimport {DiskManager} from './disk.manager';\nimport {TaskCounts} from './taskcounts';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nimport './css/item.css';\n\nexport class Item extends EventEmitter\n{\n\tconstructor(item)\n\t{\n\t\tsuper(item);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item');\n\n\t\tthis.itemNode = null;\n\n\t\tthis.itemId = (item.itemId ? item.itemId : Text.getRandom());\n\t\tthis.itemType = item.itemType;\n\t\tthis.name = item.name;\n\t\tthis.responsible = (item.responsible ? item.responsible : '');\n\t\tthis.entityId = item.entityId;\n\t\tthis.entityType = item.entityType;\n\t\tthis.parentId = (item.parentId ? item.parentId : 0);\n\t\tthis.sort = item.sort;\n\t\tthis.storyPoints = (Type.isUndefined(item.storyPoints) ? '' : item.storyPoints);\n\t\tthis.sourceId = (item.sourceId ? item.sourceId : 0);\n\t\tthis.parentSourceId = (item.parentSourceId ? item.parentSourceId : 0);\n\n\t\tif (this.itemType === 'task')\n\t\t{\n\t\t\tthis.taskCounts = new TaskCounts(item);\n\t\t}\n\n\t\tthis.completed = (item.completed === 'Y');\n\n\t\tthis.epic = (Type.isPlainObject(item.epic) ? item.epic : null);\n\t\tthis.tags = (Type.isArray(item.tags) ? item.tags : []);\n\t}\n\n\tsetDisableStatus(status: Boolean)\n\t{\n\t\tthis.disableStatus = status;\n\t\tif (this.itemNode)\n\t\t{\n\t\t\tif (status)\n\t\t\t{\n\t\t\t\tthis.hideNode(this.itemNode.querySelector('.tasks-scrum-dragndrop'));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showNode(this.itemNode.querySelector('.tasks-scrum-dragndrop'));\n\t\t\t}\n\t\t}\n\t}\n\n\tsetMoveActivity(value: Boolean)\n\t{\n\t\tthis.moveActivity = value;\n\t}\n\n\tactivateDecompositionMode()\n\t{\n\t\tthis.decompositionMode = true;\n\t\tDom.addClass(this.itemNode, 'tasks-scrum-item-decomposition-mode');\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.decompositionMode = false;\n\t\tDom.removeClass(this.itemNode, 'tasks-scrum-item-decomposition-mode');\n\t}\n\n\tisDisabled()\n\t{\n\t\treturn Boolean(this.disableStatus);\n\t}\n\n\tgetItemId()\n\t{\n\t\treturn this.itemId;\n\t}\n\n\tgetItemType()\n\t{\n\t\treturn this.itemType;\n\t}\n\n\tgetItemNode()\n\t{\n\t\treturn this.itemNode;\n\t}\n\n\tgetStoryPoints()\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tgetSort()\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetSort(sort)\n\t{\n\t\tthis.sort = parseInt(sort, 10);\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetParentId(parentId)\n\t{\n\t\tthis.parentId = parseInt(parentId, 10);\n\t}\n\n\tgetSourceId()\n\t{\n\t\treturn this.sourceId;\n\t}\n\n\tsetSourceId(sourceId)\n\t{\n\t\tthis.sourceId = parseInt(sourceId, 10);\n\t}\n\n\tgetParentSourceId(): Number\n\t{\n\t\treturn this.parentSourceId;\n\t}\n\n\tsetParentSourceId(sourceId)\n\t{\n\t\tthis.parentSourceId = parseInt(sourceId, 10);\n\t}\n\n\tsetParentEntity(entityId, entityType)\n\t{\n\t\tthis.entityId = entityId;\n\t\tthis.entityType = entityType;\n\t}\n\n\tgetEntityId(): Number\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.itemNode);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst dragnDropNode = (this.isDisabled() ? '' : '<div class=\"tasks-scrum-dragndrop\"></div>');\n\t\treturn Tag.render`\n\t\t\t<div data-item-id=\"${Text.encode(this.itemId)}\" data-sort=\n\t\t\t\t\"${Text.encode(this.sort)}\" class=\"tasks-scrum-item\">\n\t\t\t\t${dragnDropNode}\n\t\t\t\t<div class=\"tasks-scrum-item-inner\">\n\t\t\t\t\t<div class=\"tasks-scrum-item-name\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-item-name-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-no-border\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t\t\t\t${Text.encode(this.name)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.taskCounts.createIndicators()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-item-params\">\n\t\t\t\t\t\t<div class=\"ui-icon ui-icon-common-user tasks-scrum-item-responsible\"><i></i></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-item-story-points\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-item-story-points-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-auto ui-ctl-no-border\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t\t\t\t\t${Text.encode(this.storyPoints)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.getTagsContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEpicTag(): ?HTMLElement\n\t{\n\t\tif (this.epic === null)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst getContrastYIQ = (hexcolor) => {\n\t\t\tif (!hexcolor)\n\t\t\t{\n\t\t\t\thexcolor = Label.Color.DEFAULT;\n\t\t\t}\n\t\t\thexcolor = hexcolor.replace('#', '');\n\t\t\tconst r = parseInt(hexcolor.substr(0, 2), 16);\n\t\t\tconst g = parseInt(hexcolor.substr(2, 2), 16);\n\t\t\tconst b = parseInt(hexcolor.substr(4, 2), 16);\n\t\t\tconst yiq = ((r * 299 ) + (g* 587 ) + (b * 114)) / 1000;\n\t\t\treturn (yiq >= 128) ? 'black' : 'white';\n\t\t};\n\n\t\tconst epicLabel = new Label({\n\t\t\ttext: this.epic.name,\n\t\t\tcolor: Label.Color.DEFAULT,\n\t\t\tsize: Label.Size.SM,\n\t\t\tcustomClass: 'tasks-scrum-item-epic-label'\n\t\t});\n\t\tconst container = epicLabel.getContainer();\n\t\tconst innerLabel = container.querySelector('.ui-label-inner');\n\n\t\tconst contrast = getContrastYIQ(this.epic.info.color);\n\t\tif (contrast === 'white')\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#ffffff');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#525c69');\n\t\t}\n\t\tDom.style(container, 'backgroundColor', this.epic.info.color);\n\n\t\treturn container;\n\t}\n\n\tgetListTagNodes(): HTMLElement\n\t{\n\t\treturn this.tags.map((tag) => {\n\t\t\tconst tagLabel = new Label({\n\t\t\t\ttext: tag,\n\t\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\t\tfill: true,\n\t\t\t\tsize: Label.Size.SM,\n\t\t\t\tcustomClass: ''\n\t\t\t});\n\t\t\treturn tagLabel.getContainer();\n\t\t});\n\t}\n\n\tgetTagsContainer(): ?HTMLElement\n\t{\n\t\tif (this.epic === null && this.tags.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonAfterAppend(container)\n\t{\n\t\tthis.itemNode = container.querySelector('[data-item-id=\"'+this.itemId+'\"]');\n\n\t\tconst nameNode = this.itemNode.querySelector('.tasks-scrum-item-name');\n\t\tEvent.bind(nameNode, 'click', this.onNameClick.bind(this));\n\n\t\tconst tagsNode = this.itemNode.querySelector('.tasks-scrum-item-tags-container');\n\t\tEvent.bind(tagsNode, 'click', this.onTagsClick.bind(this));\n\n\t\tconst responsibleNode = this.itemNode.querySelector('.tasks-scrum-item-responsible');\n\t\tEvent.bind(responsibleNode, 'click', this.onResponsibleClick.bind(this));\n\n\t\tconst storyPointsNode = this.itemNode.querySelector('.tasks-scrum-item-story-points');\n\t\tEvent.bind(storyPointsNode, 'click', this.onStoryPointsClick.bind(this));\n\n\t\tif (this.completed)\n\t\t{\n\t\t\tconst nameTextNode = nameNode.querySelector('.ui-ctl-element');\n\t\t\tDom.style(nameTextNode, 'textDecoration', 'line-through');\n\t\t\tthis.setDisableStatus(true);\n\t\t}\n\n\t\tthis.updateResponsible();\n\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.onAfterAppend();\n\t\t}\n\t}\n\n\tisShowIndicators(): Boolean\n\t{\n\t\treturn this.attachedFilesCount || this.checkListAll || this.newCommentsCount;\n\t}\n\n\tonNameClick(event)\n\t{\n\t\tconst targetNode = event.target;\n\t\tif (Dom.hasClass(targetNode, 'ui-ctl-element') && targetNode.contentEditable === 'true')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.showActionsPanel(event);\n\n\t\tif (!Dom.hasClass(targetNode, 'ui-ctl-element') || this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst nameNode = event.currentTarget;\n\t\tconst borderNode = nameNode.querySelector('.ui-ctl');\n\t\tconst valueNode = nameNode.querySelector('.ui-ctl-element');\n\t\tvalueNode.textContent = valueNode.textContent.trim();\n\t\tconst oldValue = valueNode.textContent;\n\n\t\tDom.addClass(this.itemNode, 'tasks-scrum-item-edit-mode');\n\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\tvalueNode.contentEditable = 'true';\n\n\t\tthis.placeCursorAtEnd(valueNode);\n\n\t\tEvent.bind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\tEvent.bindOnce(valueNode, 'blur', () => {\n\t\t\tEvent.unbind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\t\tDom.removeClass(this.itemNode, 'tasks-scrum-item-edit-mode');\n\t\t\tDom.addClass(borderNode, 'ui-ctl-no-border');\n\t\t\tvalueNode.contentEditable = 'false';\n\n\t\t\tconst newValue = valueNode.textContent.trim();\n\t\t\tif (oldValue === newValue)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emit('updateItem', {\n\t\t\t\titemId: this.itemId,\n\t\t\t\titemType: this.itemType,\n\t\t\t\tname: newValue\n\t\t\t});\n\t\t\tthis.name = newValue;\n\t\t}, true);\n\t}\n\n\tonTagsClick(event)\n\t{\n\t\tthis.showActionsPanel(event);\n\t}\n\n\tonResponsibleClick(event)\n\t{\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst responsibleNode = event.currentTarget;\n\n\t\tconst selector = new BX.Tasks.Integration.Socialnetwork.NetworkSelector({\n\t\t\tscope: responsibleNode,\n\t\t\tid: 'tasks-scrum-change-responsible-' + this.itemId,\n\t\t\tmode: 'user',\n\t\t\tquery: false,\n\t\t\tuseSearch: true,\n\t\t\tuseAdd: false,\n\t\t\tparent: this,\n\t\t\tpopupOffsetLeft: 10\n\t\t});\n\t\tselector.bindEvent('item-selected', (data) => {\n\t\t\tthis.responsible = {\n\t\t\t\tid: data.id,\n\t\t\t\tname: data.nameFormatted,\n\t\t\t\tphoto: {\n\t\t\t\t\tsrc: data.avatar\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.updateResponsible();\n\t\t\tselector.close();\n\t\t\tthis.emit('changeTaskResponsible');\n\t\t});\n\n\t\tselector.open();\n\t}\n\n\tonStoryPointsClick(event)\n\t{\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst storyPointsNode = event.currentTarget;\n\t\tconst borderNode = storyPointsNode.querySelector('.ui-ctl');\n\t\tconst valueNode = storyPointsNode.querySelector('.ui-ctl-element');\n\t\tvalueNode.textContent = valueNode.textContent.trim();\n\t\tconst oldValue = valueNode.textContent.trim();\n\n\t\tif (valueNode.contentEditable === 'true')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\tvalueNode.contentEditable = 'true';\n\n\t\tthis.placeCursorAtEnd(valueNode);\n\n\t\tEvent.bind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\tEvent.bindOnce(valueNode, 'blur', () => {\n\t\t\tEvent.unbind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\t\tvalueNode.contentEditable = 'false';\n\n\t\t\tconst newValue = valueNode.textContent.trim();\n\t\t\tif (newValue && oldValue === newValue)\n\t\t\t{\n\t\t\t\tvalueNode.textContent = oldValue;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emit('updateItem', {\n\t\t\t\titemId: this.itemId,\n\t\t\t\titemType: this.itemType,\n\t\t\t\tstoryPoints: newValue\n\t\t\t});\n\t\t\tthis.emit('updateStoryPoints', {\n\t\t\t\toldValue: this.storyPoints,\n\t\t\t\tnewValue: newValue\n\t\t\t});\n\t\t\tthis.storyPoints = newValue;\n\t\t}, true);\n\t}\n\n\tblockEnterInput(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.blur();\n\t\t\treturn;\n\t\t}\n\t};\n\n\tshowActionsPanel(event)\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tevent.stopPropagation();\n\n\t\tthis.actionsPanel = new ActionsPanel({\n\t\t\tbindElement: this.itemNode,\n\t\t\titemList: {\n\t\t\t\ttask: {\n\t\t\t\t\tactivity: (this.itemType === 'task'),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('showTask');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tattachment: {\n\t\t\t\t\tactivity: (this.itemType === 'task' && !this.disableStatus),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tconst diskManager = new DiskManager({\n\t\t\t\t\t\t\tufDiskFilesFieldName: 'UF_TASK_WEBDAV_FILES'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.subscribeOnce('onFinish', (baseEvent) => {\n\t\t\t\t\t\t\tthis.emit('attachFilesToTask', baseEvent.getData());\n\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.showAttachmentMenu(event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tactivity: (!this.decompositionMode && this.moveActivity),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('move', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tsprint: {\n\t\t\t\t\tactivity: (this.entityType === 'backlog' && !this.disableStatus && !this.decompositionMode),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('moveToSprint', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbacklog: {\n\t\t\t\t\tactivity: (this.entityType === 'sprint' && !this.disableStatus && !this.decompositionMode),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('moveToBacklog');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ttags: {\n\t\t\t\t\tactivity: (!this.disableStatus && !this.decompositionMode),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showTagSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tepic: {\n\t\t\t\t\tactivity: (!this.disableStatus && !this.decompositionMode),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showEpicSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdecomposition: {\n\t\t\t\t\tactivity: (!this.disableStatus && !this.decompositionMode),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('startDecomposition');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tactivity: (!this.decompositionMode),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tMessageBox.confirm(\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASK'),\n\t\t\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\t\t\tthis.emit('remove');\n\t\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.actionsPanel.showPanel();\n\t}\n\n\tgetCurrentActionsPanel(): ?ActionsPanel\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown())\n\t\t{\n\t\t\treturn this.actionsPanel;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null\n\t\t}\n\t}\n\n\tsetItemId(itemId)\n\t{\n\t\tthis.itemId = (Type.isInteger(itemId) ? parseInt(itemId, 10) : 0);\n\t\tthis.itemNode.dataset.itemId = this.itemId;\n\t}\n\n\tsetEpicAndTags(epic, tags)\n\t{\n\t\tthis.epic = (Type.isPlainObject(epic) || epic === null ? epic : this.epic);\n\t\tthis.tags = (Type.isArray(tags) ? tags : this.tags);\n\n\t\tthis.updateTagsContainer();\n\t}\n\n\tsetTags(tags)\n\t{\n\t\tthis.tags = (Type.isArray(tags) ? tags : []);\n\t}\n\n\tgetTags()\n\t{\n\t\treturn this.tags;\n\t}\n\n\tgetEpic()\n\t{\n\t\treturn this.epic;\n\t}\n\n\tgerResponsible()\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tsetResponsible(responsible)\n\t{\n\t\tthis.responsible = responsible;\n\t\tthis.updateResponsible();\n\t}\n\n\tupdateTagsContainer()\n\t{\n\t\tconst newContainer = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst tagsContainerNode = this.itemNode.querySelector('.tasks-scrum-item-tags-container');\n\t\tif (tagsContainerNode)\n\t\t{\n\t\t\tDom.replace(tagsContainerNode, newContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newContainer, this.itemNode);\n\t\t}\n\n\t\tEvent.bind(newContainer, 'click', this.onTagsClick.bind(this));\n\t}\n\n\tupdateResponsible()\n\t{\n\t\tconst responsibleNode = this.itemNode.querySelector('.tasks-scrum-item-responsible');\n\n\t\tif (!responsibleNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.entityType === 'backlog')\n\t\t{\n\t\t\tresponsibleNode.style.display = 'none';\n\t\t}\n\t\telse if (this.entityType === 'sprint')\n\t\t{\n\t\t\tresponsibleNode.style.display = 'block';\n\t\t}\n\n\t\tDom.attr(responsibleNode, 'title', this.responsible.name);\n\t\tif (this.responsible.photo && this.responsible.photo.src)\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', 'url('+this.responsible.photo.src+')');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', null);\n\t\t}\n\t}\n\n\tplaceCursorAtEnd(node)\n\t{\n\t\tnode.focus();\n\t\tconst selection = window.getSelection();\n\t\tconst range = document.createRange();\n\t\trange.selectNodeContents(node);\n\t\trange.collapse(false);\n\t\tselection.removeAllRanges();\n\t\tselection.addRange(range);\n\t};\n\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.updateIndicators(data);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'block');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}\n","import {Dialog} from 'ui.entity-selector';\nimport {Loc, Tag, Text} from 'main.core';\nimport {Input} from './input';\n\nexport class TagSearcher\n{\n\tconstructor(options)\n\t{\n\t\tthis.requestSender = options.requestSender;\n\n\t\tthis.allTags = new Map();\n\t}\n\n\taddTagToSearcher(tagName)\n\t{\n\t\ttagName = tagName.trim();\n\t\tthis.allTags.set('tag_' + tagName, {\n\t\t\tid: tagName,\n\t\t\tentityId: 'tag',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: tagName,\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag.svg'\n\t\t});\n\t}\n\n\taddEpicToSearcher(epic: Object)\n\t{\n\t\tconst epicName = epic.name.trim();\n\t\tthis.allTags.set('epic_' + epicName, {\n\t\t\tid: epic.id,\n\t\t\tentityId: 'epic',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: epicName,\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag-green.svg'\n\t\t});\n\t}\n\n\tgetTagFromSearcher(name: String): Object\n\t{\n\t\treturn this.allTags.get(name);\n\t}\n\n\tremoveEpicFromSearcher(epic: Object)\n\t{\n\t\tthis.allTags.delete('epic_' + epic.name);\n\t}\n\n\tgetAllList(): Array\n\t{\n\t\treturn [...this.allTags.values()];\n\t}\n\n\tgetTagsList(): Array\n\t{\n\t\tconst tagsList = [];\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'tag')\n\t\t\t{\n\t\t\t\ttagsList.push(tag);\n\t\t\t}\n\t\t});\n\t\treturn tagsList;\n\t}\n\n\tgetEpicList(): Array\n\t{\n\t\tconst epicList = [];\n\t\t[...this.allTags.values()].forEach((epic) => {\n\t\t\tif (epic.entityId === 'epic')\n\t\t\t{\n\t\t\t\tepicList.push(epic);\n\t\t\t}\n\t\t});\n\t\treturn epicList;\n\t}\n\n\tshowTagsDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentTags = item.getTags();\n\t\tconst requestData = {};\n\n\t\tconst selectedItems = [];\n\t\tcurrentTags.forEach((tag) => {\n\t\t\tselectedItems.push(this.allTags.get('tag_' + tag));\n\t\t});\n\n\t\tconst createTag = () => {\n\t\t\tconst tagName = this.tagDialog.getTagSelector().getTextBoxValue();\n\t\t\tif (!tagName)\n\t\t\t{\n\t\t\t\tthis.tagDialog.focusSearch();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.addTagToSearcher(tagName);\n\t\t\tconst newTag = this.getTagFromSearcher('tag_' + tagName);\n\t\t\tconst item = this.tagDialog.addItem(newTag);\n\t\t\titem.select();\n\t\t\tthis.tagDialog.getTagSelector().clearTextBox();\n\t\t\tthis.tagDialog.focusSearch();\n\t\t\tthis.tagDialog.selectFirstTab();\n\t\t\tconst label = this.tagDialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\tlabel.textContent = '';\n\t\t};\n\n\t\tthis.tagDialog = new Dialog({\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: true,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getTagsList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\trequestData.taskId = item.getSourceId();\n\t\t\t\t\trequestData.tag = selectedItem.title;\n\t\t\t\t\tthis.requestSender.attachTagToTask(requestData).then((response) => {\n\t\t\t\t\t\tcurrentTags.push(requestData.tag);\n\t\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t\t}).catch((response) => {});\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tconst deselectedItem = event.getData().item;\n\t\t\t\t\trequestData.taskId = item.getSourceId();\n\t\t\t\t\trequestData.tag = deselectedItem.title;\n\t\t\t\t\tthis.requestSender.deAttachTagToTask(requestData).then((response) => {\n\t\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(requestData.tag), 1);\n\t\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t\t}).catch((response) => {});\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonInput: (event) => {\n\t\t\t\t\t\tconst selector = event.getData().selector;\n\t\t\t\t\t\tconst dialog = selector.getDialog();\n\t\t\t\t\t\tconst label = dialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\t\t\t\tlabel.textContent = Text.encode(selector.getTextBoxValue());\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tfooter: [\n\t\t\t\tTag.render`\n\t\t\t\t\t<span onclick=\"${createTag}\" class=\"ui-selector-footer-link ui-selector-footer-link-add\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SEARCHER_ACTIONS_TAG_ADD')}\n\t\t\t\t\t</span>\n\t\t\t\t`,\n\t\t\t\tTag.render`<span class=\"ui-selector-footer-conjunction\"></span>`\n\t\t\t],\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(this.tagDialog.getContainer());\n\t\tthis.tagDialog.subscribe('onHide', () => {\n\t\t\tactionsPanel.destroy();\n\t\t});\n\n\t\tthis.tagDialog.show();\n\t}\n\n\tshowEpicDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentEpic = item.getEpic();\n\t\tconst requestData = {};\n\n\t\tconst selectedItems = [];\n\t\tif (currentEpic)\n\t\t{\n\t\t\tselectedItems.push(this.allTags.get('epic_' + currentEpic.name));\n\t\t}\n\n\t\tconst dialog =new Dialog({\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getEpicList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\trequestData.itemId = item.getItemId();\n\t\t\t\t\trequestData.epicId = selectedItem.id;\n\t\t\t\t\tthis.requestSender.attachEpicToItem(requestData).then((response) => {\n\t\t\t\t\t\titem.setParentId(response.data.epic.id);\n\t\t\t\t\t\titem.setEpicAndTags(response.data.epic, item.getTags());\n\t\t\t\t\t}).catch((response) => {});\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\trequestData.itemId = item.getItemId();\n\t\t\t\t\tthis.requestSender.deAttachEpicToItem(requestData).then((response) => {\n\t\t\t\t\t\titem.setParentId(0);\n\t\t\t\t\t\titem.setEpicAndTags(null, null);\n\t\t\t\t\t}).catch((response) => {});\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tplaceholder: Loc.getMessage('TASKS_SCRUM_ITEM_EPIC_SEARCHER_PLACEHOLDER')\n\t\t\t}\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(dialog.getContainer());\n\t\tdialog.subscribe('onHide', () => {\n\t\t\tactionsPanel.destroy();\n\t\t});\n\t\tdialog.show();\n\t}\n\n\tshowTagsSearchDialog(inputObject: Input, enteredHashTagName: String): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.tagsDialog && this.tagsDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.tagsDialog = null;\n\t\t}\n\n\t\tif (!this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getTagsList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashTag = '#' + selectedItem.title;\n\t\t\t\t\t\tconst hashTags = TagSearcher.getHashTagsFromText(input.value);\n\t\t\t\t\t\tconst enteredHashTag = (hashTags.length > 0 ? hashTags.pop().trim() : '');\n\t\t\t\t\t\tinput.value = input.value.replace(\n\t\t\t\t\t\t\tnew RegExp('#(['+enteredHashTag+']+|)(?:$)', 'g'),\n\t\t\t\t\t\t\tselectedHashTag\n\t\t\t\t\t\t);\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.tagsDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setTagsSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setTagsSearchMode(true);\n\n\t\tthis.tagsDialog.show();\n\t\tthis.tagsDialog.search(enteredHashTagName);\n\t}\n\n\tcloseTagsSearchDialog()\n\t{\n\t\tif (this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog.hide();\n\t\t}\n\t}\n\n\tshowEpicSearchDialog(inputObject: Input, enteredHashEpicName: String): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.epicDialog && this.epicDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.epicDialog = null;\n\t\t}\n\n\t\tif (!this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getEpicList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashEpic = '@' + selectedItem.title;\n\t\t\t\t\t\tinput.value = input.value.replace(new RegExp('(?:^|\\\\s)(?:@)([^\\\\s]*)','g'),'');\n\t\t\t\t\t\tinput.value = input.value + ' ' + selectedHashEpic\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t\tinputObject.setEpicId(selectedItem.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.epicDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setEpicSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setEpicSearchMode(true);\n\n\t\tthis.epicDialog.show();\n\t\tthis.epicDialog.search(enteredHashEpicName);\n\t}\n\n\tcloseEpicSearchDialog()\n\t{\n\t\tif (this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog.hide();\n\t\t}\n\t}\n\n\tcleanEpicTagsInText(inputText: String): String\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:@)(\\\\S+)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashTagsFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:#)(\\\\S+)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashEpicFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:@)(\\\\S+)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashTagNamesFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:#)(\\\\S+|)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[1]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashEpicNamesFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:@)(\\\\S+|)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[1]);\n\t\t}\n\t\treturn matches;\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {TagSearcher} from './tag.searcher';\nimport {EventEmitter} from 'main.core.events';\n\nimport './css/input.css';\n\nexport class Input extends EventEmitter\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Input');\n\n\t\tthis.nodeId = Text.getRandom();\n\t\tthis.placeholder = Loc.getMessage('TASKS_SCRUM_TASK_ADD_INPUT_PLACEHOLDER');\n\n\t\tthis.epicId = 0;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${Text.encode(this.nodeId)}\" class=\"tasks-scrum-input\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox\">\n\t\t\t\t\t<input type=\"text\" class=\"ui-ctl-element\" placeholder=\n\t\t\t\t\t\t\"${Text.encode(this.placeholder)}\" autocomplete=\"off\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.setNode();\n\n\t\tEvent.bind(this.getInputNode(), 'input', (event) => {\n\t\t\tthis.onTagSearch(event);\n\t\t\tthis.onEpicSearch(event);\n\t\t});\n\t\tEvent.bind(this.getInputNode(), 'keydown', this.onKeydown.bind(this));\n\t}\n\n\tsetNode()\n\t{\n\t\tthis.node = document.getElementById(this.nodeId);\n\t}\n\n\tsetPlaceholder(placeholder: String)\n\t{\n\t\tthis.placeholder = placeholder;\n\t}\n\n\tsetEpicId(parentId)\n\t{\n\t\tthis.epicId = parseInt(parentId, 10);\n\t}\n\n\tgetNode(): HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetNodeId(): String\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tgetInputNode(): HTMLElement\n\t{\n\t\treturn this.node.querySelector('input');\n\t}\n\n\tgetEpicId()\n\t{\n\t\treturn this.epicId;\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t}\n\n\tsetTagsSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-tag-disabled', value);\n\t}\n\n\tisTagsSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-tag-disabled');\n\t}\n\n\tsetEpicSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-epic-disabled', value);\n\t}\n\n\tisEpicSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-epic-disabled');\n\t}\n\n\tonTagSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashTags = TagSearcher.getHashTagNamesFromText(inputNode.value);\n\t\tif (event.data === '#')\n\t\t{\n\t\t\tthis.setEpicSearchMode(false);\n\t\t\tthis.setTagsSearchMode(true);\n\t\t}\n\t\tif (enteredHashTags.length > 0 && this.isTagsSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashTags.pop().trim();\n\t\t\tthis.emit('tagsSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('tagsSearchClose');\n\t\t}\n\t}\n\n\tonEpicSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashEpics = TagSearcher.getHashEpicNamesFromText(inputNode.value);\n\t\tif (event.data === '@')\n\t\t{\n\t\t\tthis.setTagsSearchMode(false);\n\t\t\tthis.setEpicSearchMode(true);\n\t\t}\n\t\tif (enteredHashEpics.length > 0 && this.isEpicSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashEpics.pop().trim();\n\t\t\tthis.emit('epicSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('epicSearchClose');\n\t\t}\n\t}\n\n\tonCreateTaskItem()\n\t{\n\t\tif (!this.isTagsSearchMode() && !this.isEpicSearchMode())\n\t\t{\n\t\t\tconst input = this.getInputNode();\n\t\t\tif (input.value)\n\t\t\t{\n\t\t\t\tthis.emit('createTaskItem', input.value);\n\t\t\t\tinput.value = '';\n\t\t\t\tinput.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tonKeydown(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.onCreateTaskItem();\n\t\t}\n\t}\n}","import {Type, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {ActionsHeader} from './actions.header';\nimport {Item} from './item';\nimport {Input} from './input';\n\ntype entityParams = {\n\tid: number,\n\tstoryPoints?: string\n};\n\nexport class Entity extends EventEmitter\n{\n\tconstructor(entityData: entityParams = {})\n\t{\n\t\tsuper(entityData);\n\n\t\tthis.listItemsNode = null;\n\t\tthis.storyPointsNode = null;\n\n\t\tthis.id = (Type.isInteger(entityData.id) ? parseInt(entityData.id, 10) : 0);\n\n\t\tthis.setStoryPoints(entityData.storyPoints ? entityData.storyPoints : '');\n\t\tthis.items = new Map();\n\n\t\tthis.actionsHeader = new ActionsHeader(this);\n\t\tthis.input = new Input();\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'entity';\n\t}\n\n\tisActive()\n\t{\n\t\treturn false;\n\t}\n\n\tisCompleted()\n\t{\n\t\treturn false;\n\t}\n\n\tgetListItemsNode()\n\t{\n\t\treturn this.listItemsNode;\n\t}\n\n\tgetItems()\n\t{\n\t\treturn this.items;\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tthis.items.set(newItem.getItemId(), newItem);\n\t\tthis.subscribeToItem(newItem);\n\t\tthis.updateStoryPoints(newItem.getStoryPoints());\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\t}\n\n\tsetItemMoveActivity(item: Item)\n\t{\n\t\titem.setMoveActivity(this.items.size > 2);\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tif (this.items.has(item.getItemId()))\n\t\t{\n\t\t\tthis.items.delete(item.getItemId());\n\t\t\tthis.updateStoryPoints(item.getStoryPoints(), false);\n\t\t\titem.unsubscribeAll();\n\t\t\t[...this.items.values()].map((item) => {\n\t\t\t\tthis.setItemMoveActivity(item);\n\t\t\t});\n\t\t}\n\t}\n\n\thasInput(): Boolean\n\t{\n\t\treturn true;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.subscribeToItem(item);\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\n\t\tthis.actionsHeader.onAfterAppend();\n\t\tthis.actionsHeader.subscribe('openAddEpicForm', () => this.emit('openAddEpicForm'));\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.input.onAfterAppend();\n\t\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t\t\tthis.input.subscribe('epicSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('epicSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashEpicName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('epicSearchClose', () => this.emit('epicSearchClose'));\n\t\t\tthis.input.subscribe('createTaskItem', (baseEvent) => {\n\t\t\t\tthis.emit('createTaskItem', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tvalue: baseEvent.getData()\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tsubscribeToItem(item: Item)\n\t{\n\t\titem.onAfterAppend(this.listItemsNode);\n\n\t\titem.subscribe('updateItem', (baseEvent) => {\n\t\t\tthis.emit('updateItem', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('updateStoryPoints', (baseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst newValue = (data.newValue ? String(data.newValue).trim() : '');\n\t\t\tconst oldValue = (data.oldValue ? String(data.oldValue).trim() : '');\n\t\t\tif (!newValue)\n\t\t\t{\n\t\t\t\tthis.updateStoryPoints(oldValue, false);\n\t\t\t}\n\t\t\telse if (newValue > oldValue)\n\t\t\t{\n\t\t\t\tthis.updateStoryPoints(newValue - oldValue);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.updateStoryPoints(oldValue - newValue, false);\n\t\t\t}\n\t\t});\n\n\t\titem.subscribe('showTask', (baseEvent) => this.emit('showTask', baseEvent.getTarget()));\n\n\t\titem.subscribe('move', (baseEvent) => {\n\t\t\tthis.emit('moveItem', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('moveToSprint', (baseEvent) => {\n\t\t\tthis.emit('moveToSprint', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('attachFilesToTask', (baseEvent) => {\n\t\t\tthis.emit('attachFilesToTask', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tattachedIds: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('showTagSearcher', (baseEvent) => {\n\t\t\tthis.emit('showTagSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\titem.subscribe('showEpicSearcher', (baseEvent) => {\n\t\t\tthis.emit('showEpicSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('startDecomposition', (baseEvent) => {\n\t\t\tthis.emit('startDecomposition', baseEvent.getTarget())\n\t\t});\n\n\t\titem.subscribe('remove', (baseEvent) => {\n\t\t\tconst item = baseEvent.getTarget();\n\t\t\tthis.removeItem(item);\n\t\t\titem.removeYourself();\n\t\t\tthis.emit('removeItem', item);\n\t\t});\n\n\t\titem.subscribe('changeTaskResponsible', (baseEvent) => {\n\t\t\tconst item = baseEvent.getTarget();\n\t\t\tthis.emit('changeTaskResponsible', item);\n\t\t});\n\t}\n\n\tupdateStoryPoints(inputStoryPoints, increment = true)\n\t{\n\t\tinputStoryPoints = (inputStoryPoints ? parseFloat(inputStoryPoints) : '');\n\t\tconst currentStoryPoints = (this.storyPoints ? parseFloat(this.storyPoints) : '');\n\n\t\tconst storyPoints = (increment ?\n\t\t\t(currentStoryPoints + inputStoryPoints) :\n\t\t\t(currentStoryPoints - inputStoryPoints));\n\n\t\tthis.setStoryPoints(storyPoints);\n\t}\n\n\tgetItemByItemId(itemId)\n\t{\n\t\treturn this.items.get(parseInt(itemId, 10));\n\t}\n\n\tgetStoryPoints()\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tsetStoryPoints(storyPoints)\n\t{\n\t\tthis.storyPoints = (Type.isFloat(storyPoints) ? storyPoints.toFixed(1) : storyPoints);\n\t\tif (this.storyPoints === 0)\n\t\t{\n\t\t\tthis.storyPoints = '';\n\t\t}\n\t\tif (this.storyPointsNode)\n\t\t{\n\t\t\tthis.storyPointsNode.textContent = Text.encode(this.storyPoints);\n\t\t}\n\t}\n\n\tisFirstItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\tconst firstElementChild = (\n\t\t\tthis.hasInput() ? listItemsNode.firstElementChild.nextElementSibling : listItemsNode.firstElementChild\n\t\t)\n\t\treturn firstElementChild.isEqualNode(itemNode);\n\t}\n\n\tisLastItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\treturn listItemsNode.lastElementChild.isEqualNode(itemNode);\n\t}\n\n\tfadeOut()\n\t{\n\t\tthis.getListItemsNode().classList.add('tasks-scrum-entity-items-faded');\n\t}\n\n\tfadeIn()\n\t{\n\t\tthis.getListItemsNode().classList.remove('tasks-scrum-entity-items-faded');\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {Entity} from './entity';\nimport {Item} from './item';\n\nimport './css/backlog.css';\n\ntype backlogParams = {\n\titems?: Array\n};\n\nexport class Backlog extends Entity\n{\n\tconstructor(backlogData: backlogParams = {})\n\t{\n\t\tsuper(backlogData);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Backlog');\n\n\t\tbacklogData.items.forEach((itemData) => {\n\t\t\tconst item = new Item(itemData);\n\t\t\tthis.items.set(item.itemId, item);\n\t\t});\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'backlog';\n\t}\n\n\tisDisabled()\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t * @returns {HTMLElement}\n\t */\n\trender()\n\t{\n\t\tconst createBacklog = (title, actions, items) => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-backlog\">\n\t\t\t\t\t${title}\n\t\t\t\t\t${actions}\n\t\t\t\t\t${items}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createBacklogTitle = () => {\n\t\t\tthis.headerNodeId = 'tasks-scrum-backlog-story-points';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.headerNodeId}\" class=\"tasks-scrum-backlog-header\">\n\t\t\t\t\t<div class=\"tasks-scrum-backlog-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-backlog-epics-title ui-btn ui-btn-xs ui-btn-secondary\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_EPICS_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-backlog-title-spacer\"></div>\n\t\t\t\t\t<div class=\"tasks-scrum-backlog-story-point-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE_STORY_POINTS')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-backlog-story-point\">\n\t\t\t\t\t\t${Text.encode(this.storyPoints)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createBacklogItems = () => {\n\t\t\tthis.backlogItemsNodeId = 'tasks-scrum-backlog-items';\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-backlog-items\">\n\t\t\t\t\t<div id=\"${this.backlogItemsNodeId}\" class=\n\t\t\t\t\t\t\"tasks-scrum-backlog-items-list\" data-entity-id=\"${this.getId()}\">\n\t\t\t\t\t\t${this.input.render()}\n\t\t\t\t\t\t${[...this.items.values()].map((item) => item.render())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\treturn createBacklog(\n\t\t\tcreateBacklogTitle(),\n\t\t\tthis.actionsHeader.createActionsHeader(),\n\t\t\tcreateBacklogItems()\n\t\t)\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.listItemsNode = document.getElementById(this.backlogItemsNodeId);\n\n\t\tthis.headerNode = document.getElementById(this.headerNodeId);\n\t\tthis.storyPointsNode = this.headerNode.querySelector('.tasks-scrum-backlog-story-point');\n\n\t\tconst listEpicNode = this.headerNode.querySelector('.tasks-scrum-backlog-epics-title');\n\t\tEvent.bind(listEpicNode, 'click', () => this.emit('openListEpicGrid'));\n\n\t\tsuper.onAfterAppend();\n\t}\n}","import {Loc, Tag, Dom} from 'main.core';\nimport {Sprint} from './sprint';\n\nexport class SprintStats\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tthis.sprint = sprint;\n\n\t\tthis.dateEnd = this.sprint.getDateEnd()\n\t\tthis.storyPoints = this.sprint.getStoryPoints();\n\t\tthis.completedStoryPoints = this.sprint.getCompletedStoryPoints();\n\n\t\tthis.kanbanMode = false;\n\t}\n\n\tsetKanbanMode()\n\t{\n\t\tthis.kanbanMode = true;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.activeStatsNode = document.getElementById(this.activeStatsNodeId);\n\t}\n\n\tcreateStats()\n\t{\n\t\tif (this.sprint.isCompleted())\n\t\t{\n\t\t\treturn this.createCompletedStatsInfo();\n\t\t}\n\t\telse if (this.sprint.isActive() && this.sprint.isExpired())\n\t\t{\n\t\t\treturn this.createExpiredStatsInfo();\n\t\t}\n\t\telse if (this.sprint.isActive())\n\t\t{\n\t\t\treturn this.createActiveStatsInfo();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tcreateActiveStatsInfo(): HTMLElement\n\t{\n\t\tthis.activeStatsNodeId = 'tasks-scrum-sprint-header-stats';\n\n\t\tthis.activeStatsClasses = (this.kanbanMode ?\n\t\t\t'tasks-scrum-sprint-header-stats-kanban' : 'tasks-scrum-sprint-header-stats');\n\n\t\treturn this.createActiveStatsNode(\n\t\t\tthis.getRemainingDays(),\n\t\t\tthis.getPercentageCompletedStoryPoints()\n\t\t);\n\t}\n\n\tcreateCompletedStatsInfo()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header-stats\">\n\t\t\t\t${\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_STATS_COMPLETED_LABEL')\n\t\t\t\t\t\t.replace('#percent#', this.getPercentageCompletedStoryPoints())\n\t\t\t\t\t\t.replace('#date#', BX.date.format('j F Y', this.dateEnd))\n\t\t\t\t}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateExpiredStatsInfo(): HTMLElement\n\t{\n\t\tthis.expiredStatsNodeId = 'tasks-scrum-sprint-expired-stats';\n\t\tconst statsClass = (this.kanbanMode ?\n\t\t\t'tasks-scrum-sprint-header-stats-kanban' : 'tasks-scrum-sprint-header-stats');\n\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.expiredStatsNodeId}\" class=\"${statsClass}\">\n\t\t\t\t${\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_STATS_EXPIRED_LABEL')\n\t\t\t\t\t\t.replace('#percent#', this.getPercentageCompletedStoryPoints())\n\t\t\t\t\t\t.replace('#date#', BX.date.format('j F Y', this.dateEnd))\n\t\t\t\t}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateActiveStats(inputStoryPoints: String, increment: Boolean = true)\n\t{\n\t\tinputStoryPoints = (inputStoryPoints ? parseFloat(inputStoryPoints) : '');\n\n\t\tthis.completedStoryPoints = (increment ?\n\t\t\t(this.completedStoryPoints + inputStoryPoints) :\n\t\t\t(this.completedStoryPoints - inputStoryPoints));\n\n\t\tif (this.sprint.isExpired())\n\t\t{\n\t\t\tDom.replace(document.getElementById(this.expiredStatsNodeId), this.createExpiredStatsInfo());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!this.activeStatsNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst newActiveStatsNode = this.createActiveStatsNode(\n\t\t\t\tthis.getRemainingDays(),\n\t\t\t\tthis.getPercentageCompletedStoryPoints()\n\t\t\t);\n\n\t\t\tDom.replace(this.activeStatsNode, newActiveStatsNode);\n\t\t\tthis.activeStatsNode = document.getElementById(this.activeStatsNodeId);\n\t\t}\n\t}\n\n\tgetPercentageCompletedStoryPoints(): String\n\t{\n\t\tconst percentage = (this.storyPoints > 0  ? Math.round(this.completedStoryPoints * 100 / this.storyPoints) : 0);\n\t\treturn `<b>${percentage}%</b>`;\n\t}\n\n\tgetRemainingDays(): String\n\t{\n\t\treturn `<b>${BX.date.format('ddiff', new Date(), this.dateEnd)}</b>`;\n\t};\n\n\tcreateActiveStatsNode(remainingDays: String, percentageCompletedStoryPoints: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.activeStatsNodeId}\" class=\"${this.activeStatsClasses}\">\n\t\t\t\t${\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LABEL')\n\t\t\t\t\t\t.replace('#days#', remainingDays)\n\t\t\t\t\t\t.replace('#percent#', percentageCompletedStoryPoints)\n\t\t\t\t}\n\t\t\t</div>\n\t\t`;\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\n\nexport class SprintDate extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintDate');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.nodeId = 'tasks-scrum-sprint-header-date-' + Text.getRandom();\n\t\tthis.defaultSprintDuration = sprint.getDefaultSprintDuration();\n\t}\n\n\tcreateDate(startTimestamp, endTimestamp)\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\t/* eslint-disable */\n\t\tconst dateStart = BX.date.format('j F', startTimestamp);\n\t\tconst dateEnd = BX.date.format('j F', endTimestamp);\n\t\t/* eslint-enable */\n\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.nodeId}\" class=\"tasks-scrum-sprint-date\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-start\">${dateStart}</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-separator\">-</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-end\">${dateEnd}</div>\n\t\t\t\t<input type=\"hidden\" name=\"dateStart\">\n\t\t\t\t<input type=\"hidden\" name=\"dateEnd\">\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\tdateStartNode.textContent = BX.date.format('j F', timestamp);\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\tdateEndNode.textContent = BX.date.format('j F', timestamp);\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.node = document.getElementById(this.nodeId);\n\t\tconst parentPopup = this.node.closest('.popup-window');\n\n\t\tconst customBlur = () => {\n\t\t\tBX.calendar.get().popup.close();\n\t\t};\n\n\t\tconst showCalendar = (node, field) => {\n\t\t\t/* eslint-disable */\n\t\t\tBX.calendar({\n\t\t\t\tnode: node,\n\t\t\t\tfield: field,\n\t\t\t\tbTime: false,\n\t\t\t\tbSetFocus: false,\n\t\t\t\tbHideTime: false\n\t\t\t});\n\t\t\t/* eslint-enable */\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.bindOnce(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t};\n\n\t\tconst updateDateNode = (node, value) => {\n\t\t\t/* eslint-disable */\n\t\t\tnode.textContent = BX.date.format('j F', Math.floor(BX.parseDate(value).getTime() / 1000));\n\t\t\t/* eslint-enable */\n\t\t};\n\t\tconst sendRequest = (data) => {\n\t\t\tthis.emit('changeSprintDeadline', data);\n\t\t};\n\n\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\tconst dateStartInput = this.node.querySelector('input[name=\"dateStart\"]');\n\t\tconst dateEndInput = this.node.querySelector('input[name=\"dateEnd\"]');\n\n\t\tEvent.bind(this.node, 'click', (event) => {\n\t\t\tconst target = event.target;\n\t\t\tif (target.classList.contains('tasks-scrum-sprint-date-start'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateStartInput);\n\t\t\t}\n\t\t\telse if (target.classList.contains('tasks-scrum-sprint-date-end'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateEndInput);\n\t\t\t}\n\t\t\tevent.stopPropagation();\n\t\t});\n\t\tEvent.bind(dateStartInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateStartNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateStart: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t\tEvent.bind(dateEndInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateEndNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateEnd: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetWeeks()\n\t{\n\t\tconst weekCount = (parseInt(this.defaultSprintDuration, 10) / 604800);\n\t\tif (weekCount > 5)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_3');\n\t\t}\n\t\telse if (weekCount === 1)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_2');\n\t\t}\n\t}\n}","import {SprintStats} from './sprint.stats';\nimport {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {SprintDate} from './sprint.date';\nimport {Sprint} from './sprint';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nexport class SprintHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintHeader');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.sprintStats = new SprintStats(this.sprint);\n\n\t\tthis.sprintDate = new SprintDate(this.sprint);\n\t\tthis.sprintDate.subscribe('changeSprintDeadline', (baseEvent) => {\n\t\t\tthis.emit('changeSprintDeadline', baseEvent.getData());\n\t\t});\n\t}\n\n\tinitStyle()\n\t{\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-active';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-success ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_COMPLETE_BUTTON');\n\t\t}\n\t\telse if (this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-completed';\n\t\t\tDom.remove(this.buttonNode);\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-planned';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-primary ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_START_BUTTON');\n\t\t}\n\n\t\tif (this.headerNode)\n\t\t{\n\t\t\tif (this.sprint.isDisabled())\n\t\t\t{\n\t\t\t\tDom.remove(this.headerNode.querySelector('.tasks-scrum-sprint-header-remove'));\n\t\t\t}\n\n\t\t\tthis.headerNode.className = '';\n\t\t\tDom.addClass(this.headerNode, 'tasks-scrum-sprint-header ' + this.headerClass);\n\n\t\t\tconst button = this.buttonNode.querySelector('button');\n\t\t\tbutton.className = '';\n\t\t\tDom.addClass(button, this.buttonClass);\n\t\t\tbutton.firstChild.replaceWith(this.buttonText);\n\t\t}\n\t}\n\n\tcreateHeader()\n\t{\n\t\tthis.headerNodeId = 'tasks-scrum-sprint-header-' + this.sprint.getId();\n\t\tconst dragndropNode = (this.sprint.isPlanned() ?\n\t\t\t'<div class=\"tasks-scrum-sprint-dragndrop\"></div>' : '<div class=\"tasks-scrum-sprint-header-empty\"></div>');\n\t\tconst removeNode = (this.sprint.isPlanned() ? '<div class=\"tasks-scrum-sprint-header-remove\"></div>' : '');\n\t\tconst tickAngleClass = (this.sprint.isCompleted() ? 'ui-btn-icon-angle-down' : 'ui-btn-icon-angle-up');\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.headerNodeId}\" class=\"tasks-scrum-sprint-header ${this.headerClass}\">\n\t\t\t\t${dragndropNode}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-name-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-name\">\n\t\t\t\t\t\t${Text.encode(this.sprint.getName())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-edit\"></div>\n\t\t\t\t${removeNode}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-params\">\n\t\t\t\t\t${this.sprintStats.createStats()}\n\t\t\t\t\t${this.sprintDate.createDate(this.sprint.getDateStart(), this.sprint.getDateEnd())}\n\t\t\t\t\t${this.createButton()}\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-tick\">\n\t\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ${tickAngleClass}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t};\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tthis.sprintDate.updateDateStartNode(timestamp);\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tthis.sprintDate.updateDateEndNode(timestamp);\n\t}\n\n\tcreateButton()\n\t{\n\t\tif (this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buttonNodeId = 'tasks-scrum-sprint-header-button-' + this.sprint.getId();\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.buttonNodeId}\" class=\"tasks-scrum-sprint-header-button\">\n\t\t\t\t\t<button class=\"${this.buttonClass}\">${this.buttonText}</button>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t};\n\n\tonAfterAppend()\n\t{\n\t\tthis.headerNode = document.getElementById(this.headerNodeId);\n\n\t\tif (!this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.buttonNode = document.getElementById(this.buttonNodeId);\n\t\t\tEvent.bind(this.buttonNode, 'click', this.onButtonClick.bind(this));\n\t\t}\n\n\t\tconst nameNode = this.headerNode.querySelector('.tasks-scrum-sprint-header-name-container');\n\t\tconst editButtonNode = this.headerNode.querySelector('.tasks-scrum-sprint-header-edit');\n\t\tEvent.bind(editButtonNode, 'click', () => this.emit('changeName', nameNode));\n\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\tconst removeNode = this.headerNode.querySelector('.tasks-scrum-sprint-header-remove');\n\t\t\tEvent.bind(removeNode, 'click', () => {\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_SPRINT'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tthis.emit('removeSprint');\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\tconst tickButtonNode = this.headerNode.querySelector('.tasks-scrum-sprint-header-tick');\n\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-up');\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-down');\n\t\t\tthis.emit('toggleVisibilityContent');\n\t\t});\n\n\t\tthis.sprintDate.onAfterAppend();\n\n\t\tthis.sprintStats.onAfterAppend();\n\t}\n\n\tonButtonClick()\n\t{\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.emit('completeSprint');\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.emit('startSprint');\n\t\t}\n\t}\n}","import {Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {Entity} from './entity';\nimport {Item} from './item';\nimport {SprintHeader} from './sprint.header';\n\nimport './css/sprint.css';\n\ntype sprintParams = {\n\tid: number,\n\tname?: string,\n\tsort: number,\n\tdateStart?: number,\n\tdateEnd?: number,\n\tdefaultSprintDuration: number,\n\tstoryPoints?: string,\n\tcompletedStoryPoints?: string,\n\tunCompletedStoryPoints?: string,\n\tcompletedTasks?: number,\n\tunCompletedTasks?: number,\n\tstatus?: string,\n\titems?: Array\n};\n\nexport class Sprint extends Entity\n{\n\tconstructor(sprintData: sprintParams = {})\n\t{\n\t\tsuper(sprintData);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint');\n\n\t\tthis.name = sprintData.name;\n\t\tthis.dateStart = Type.isInteger(sprintData.dateStart) ?\n\t\t\tparseInt(sprintData.dateStart, 10) : 0;\n\t\tthis.dateEnd = Type.isInteger(sprintData.dateEnd) ?\n\t\t\tparseInt(sprintData.dateEnd, 10) : 0;\n\t\tthis.status = (sprintData.status ? sprintData.status : 'planned');\n\t\tthis.sort = Type.isInteger(sprintData.sort) ?\n\t\t\tparseInt(sprintData.sort, 10) : 1;\n\n\t\tthis.completedStoryPoints = Type.isNumber(sprintData.completedStoryPoints) ?\n\t\t\tparseFloat(sprintData.completedStoryPoints) : '';\n\t\tthis.unCompletedStoryPoints = Type.isNumber(sprintData.unCompletedStoryPoints) ?\n\t\t\tparseFloat(sprintData.unCompletedStoryPoints) : '';\n\t\tthis.completedTasks = Type.isInteger(sprintData.completedTasks) ?\n\t\t\tparseInt(sprintData.completedTasks, 10) : 0;\n\t\tthis.unCompletedTasks = Type.isInteger(sprintData.unCompletedTasks) ?\n\t\t\tparseInt(sprintData.unCompletedTasks, 10) : 0;\n\n\t\tthis.defaultSprintDuration = Type.isInteger(sprintData.defaultSprintDuration) ?\n\t\t\tparseInt(sprintData.defaultSprintDuration, 10) : 0;\n\n\t\tif (sprintData.items)\n\t\t{\n\t\t\tsprintData.items.forEach((itemData) => {\n\t\t\t\tconst item = new Item(itemData);\n\t\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t\t\tthis.items.set(item.itemId, item);\n\t\t\t});\n\t\t}\n\n\t\tthis.sprintHeader = new SprintHeader(this);\n\n\t\tthis.initStyle();\n\t}\n\n\tinitStyle()\n\t{\n\t\tthis.sprintHeader.initStyle();\n\t}\n\n\tisActive(): Boolean\n\t{\n\t\treturn (this.status === 'active');\n\t}\n\n\tisPlanned(): Boolean\n\t{\n\t\treturn (this.status === 'planned');\n\t}\n\n\tisCompleted(): Boolean\n\t{\n\t\treturn (this.status === 'completed');\n\t}\n\n\tisDisabled(): Boolean\n\t{\n\t\treturn (this.isCompleted());\n\t}\n\n\tisExpired(): Boolean\n\t{\n\t\treturn (new Date(this.dateEnd * 1000).getTime() < Date.now());\n\t}\n\n\thasInput(): Boolean\n\t{\n\t\treturn !this.isDisabled();\n\t}\n\n\tsetItem(newItem)\n\t{\n\t\tsuper.setItem(newItem);\n\t\tnewItem.setDisableStatus(this.isDisabled());\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.sprintId = parseInt(id, 10);\n\t}\n\n\tgetSort()\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetSort(sort)\n\t{\n\t\tthis.sort = parseInt(sort, 10);\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.name;\n\t}\n\n\tgetDateStart()\n\t{\n\t\treturn parseInt(this.dateStart, 10);\n\t}\n\n\tgetDateEnd()\n\t{\n\t\treturn parseInt(this.dateEnd, 10);\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'sprint';\n\t}\n\n\tsetCompletedStoryPoints(completedStoryPoints)\n\t{\n\t\tthis.completedStoryPoints = parseFloat(completedStoryPoints);\n\t}\n\n\tgetCompletedStoryPoints()\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetUnCompletedStoryPoints(unCompletedStoryPoints)\n\t{\n\t\tthis.unCompletedStoryPoints = parseFloat(unCompletedStoryPoints);\n\t}\n\n\tgetUnCompletedStoryPoints()\n\t{\n\t\treturn this.unCompletedStoryPoints;\n\t}\n\n\tsetCompletedTasks(completedTasks)\n\t{\n\t\tthis.completedTasks = parseInt(completedTasks, 10);\n\t}\n\n\tgetCompletedTasks()\n\t{\n\t\treturn this.completedTasks;\n\t}\n\n\tsetUnCompletedTasks(unCompletedTasks)\n\t{\n\t\tthis.unCompletedTasks = parseInt(unCompletedTasks, 10);\n\t}\n\n\tgetUnCompletedTasks()\n\t{\n\t\treturn this.unCompletedTasks;\n\t}\n\n\tgetDefaultSprintDuration()\n\t{\n\t\treturn this.defaultSprintDuration;\n\t}\n\n\tsetStatus(status)\n\t{\n\t\tthis.status = status;\n\t\tthis.initStyle();\n\n\t\tthis.items.forEach((item) => {\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t});\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\tthis.input.removeYourself();\n\t\t}\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\tthis.actionsHeader.removeYourself();\n\t\t}\n\t}\n\n\tgetSprintNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst getStartEventsButton = () => {\n\t\t\treturn '';\n\t\t\treturn Tag.render`\n\t\t\t\t<a class=\"ui-link\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_EVENT')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t};\n\n\t\tconst getTotalPoints = () => {\n\t\t\tthis.storyPointsNodeId = 'tasks-scrum-sprint-story-points-' + this.getId();\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-sprint-story-point-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS')}\n\t\t\t\t</div>\n\t\t\t\t<div id=\"${this.storyPointsNodeId}\" class=\"tasks-scrum-sprint-story-point\">\n\t\t\t\t\t${this.storyPoints}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst getInWorkPoints = () => {\n\t\t\tif (!this.isActive())\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-sprint-story-point-in-work-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_IN_WORK')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-in-work\">\n\t\t\t\t\t${this.unCompletedStoryPoints}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst getDonePoints = () => {\n\t\t\tif (this.isPlanned())\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-sprint-story-point-done-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_DONE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-done\">\n\t\t\t\t\t${this.completedStoryPoints}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\t\t\n\t\tconst createEvents = () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-events\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-event\">\n\t\t\t\t\t\t${getStartEventsButton()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-event-params\">\n\t\t\t\t\t\t${getTotalPoints()}\n\t\t\t\t\t\t${getInWorkPoints()}\n\t\t\t\t\t\t${getDonePoints()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createItems = () => {\n\t\t\tthis.itemsNodeId = 'tasks-scrum-sprint-items-' + this.getId();\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-sprint-items\">\n\t\t\t\t\t<div id=\"${this.itemsNodeId}\" class=\"tasks-scrum-sprint-items-list\" data-entity-id=\n\t\t\t\t\t\t\"${this.getId()}\">\n\t\t\t\t\t\t${this.isCompleted() ? '' : this.input.render()}\n\t\t\t\t\t\t${[...this.items.values()].map((item) => item.render())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tthis.nodeId = 'tasks-scrum-sprint-' + this.getId();\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.nodeId}\" class=\"tasks-scrum-sprint\" data-sprint-sort=\n\t\t\t\t\"${this.sort}\" data-sprint-id=\"${this.getId()}\">\n\t\t\t\t${this.sprintHeader.createHeader()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-content\">\n\t\t\t\t\t${createEvents()}\n\t\t\t\t\t${this.actionsHeader.createActionsHeader()}\n\t\t\t\t\t${createItems()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.node = document.getElementById(this.nodeId);\n\t\tthis.contentNode = this.node.querySelector('.tasks-scrum-sprint-content');\n\t\tthis.listItemsNode = document.getElementById(this.itemsNodeId);\n\t\tthis.storyPointsNode = document.getElementById(this.storyPointsNodeId);\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.showContent();\n\t\t}\n\n\t\tthis.sprintHeader.onAfterAppend();\n\t\tthis.sprintHeader.subscribe('changeName', this.onChangeName.bind(this));\n\t\tthis.sprintHeader.subscribe('removeSprint', this.onRemoveSprint.bind(this));\n\t\tthis.sprintHeader.subscribe('completeSprint', () => this.emit('completeSprint'));\n\t\tthis.sprintHeader.subscribe('startSprint', () => this.emit('startSprint'));\n\t\tthis.sprintHeader.subscribe('changeSprintDeadline', this.onChangeSprintDeadline.bind(this));\n\t\tthis.sprintHeader.subscribe('toggleVisibilityContent', this.toggleVisibilityContent.bind(this));\n\n\t\tsuper.onAfterAppend();\n\t}\n\n\tsubscribeToItem(item)\n\t{\n\t\tsuper.subscribeToItem(item);\n\n\t\titem.subscribe('moveToBacklog', (baseEvent) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: baseEvent.getTarget()\n\t\t\t});\n\t\t});\n\t}\n\n\tonChangeName (baseEvent)\n\t{\n\t\tconst createInput = (value) => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input type=\"text\" class=\"tasks-scrum-sprint-header-name\" value=\"${Text.encode(value)}\">\n\t\t\t`;\n\t\t};\n\n\t\tconst inputNode = createInput(this.name);\n\t\tconst nameNode = baseEvent.getData().querySelector('.tasks-scrum-sprint-header-name');\n\n\t\tEvent.bind(inputNode, 'change', (event) => {\n\t\t\tconst newValue = event.target['value'];\n\t\t\tthis.emit('changeSprintName', {\n\t\t\t\tsprintId: this.getId(),\n\t\t\t\tname: newValue\n\t\t\t});\n\t\t\tthis.name = newValue;\n\t\t\tinputNode.blur();\n\t\t}, true);\n\n\t\tconst blockEnterInput = (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t\tinputNode.blur();\n\t\t};\n\n\t\tEvent.bind(inputNode, 'keydown', blockEnterInput);\n\t\tEvent.bindOnce(inputNode, 'blur', () => {\n\t\t\tEvent.unbind(inputNode, 'keydown', blockEnterInput);\n\t\t\tnameNode.textContent = Text.encode(this.name);\n\t\t\tDom.replace(inputNode, nameNode);\n\t\t}, true);\n\n\t\tDom.replace(nameNode, inputNode);\n\n\t\tinputNode.focus();\n\t\tinputNode.setSelectionRange(this.name.length, this.name.length);\n\t}\n\n\tonRemoveSprint()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: item\n\t\t\t});\n\t\t});\n\t\tthis.removeYourself();\n\t\tthis.emit('removeSprint');\n\t}\n\n\tonChangeSprintDeadline(baseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.emit('changeSprintDeadline', requestData);\n\t\tif (requestData.hasOwnProperty('dateStart'))\n\t\t{\n\t\t\tthis.dateStart = parseInt(requestData.dateStart, 10);\n\t\t}\n\t\telse if (requestData.hasOwnProperty('dateEnd'))\n\t\t{\n\t\t\tthis.dateEnd = parseInt(requestData.dateEnd, 10);\n\t\t}\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tthis.sprintHeader.updateDateStartNode(timestamp);\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tthis.sprintHeader.updateDateEndNode(timestamp);\n\t}\n\n\ttoggleVisibilityContent()\n\t{\n\t\tif (this.contentNode.style.display === 'block')\n\t\t{\n\t\t\tthis.hideContent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showContent();\n\t\t}\n\t}\n\n\tshowContent()\n\t{\n\t\tthis.contentNode.style.display = 'block';\n\t}\n\n\thideContent()\n\t{\n\t\tthis.contentNode.style.display = 'none';\n\t}\n}","import {Popup} from 'main.popup';\nimport {Event, Loc, Tag, Text} from 'main.core';\nimport {Button} from 'ui.buttons';\n\nexport class SprintPopup\n{\n\tconstructor(options)\n\t{\n\t\tthis.sprints = options.sprints;\n\t}\n\n\tshowCompletePopup(sprint)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tconst popupId = 'tasks-scrum-complete-sprint' + Text.getRandom();\n\n\t\t\tconst moveSelectId = 'tasks-scrum-sprint-complete-popup-move-select';\n\n\t\t\tconst moveSprintsBlockId = 'tasks-scrum-sprint-complete-popup-move-sprints-block';\n\t\t\tconst moveSprintSelectId = 'tasks-scrum-sprint-complete-popup-move-sprint-select';\n\n\t\t\tconst getPopupContent = () => {\n\t\t\t\tconst moveSprint = () => {\n\t\t\t\t\tlet listSprintsOptions = '';\n\t\t\t\t\tthis.sprints.forEach((sprint) => {\n\t\t\t\t\t\tif (sprint.isPlanned())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlistSprintsOptions += `<option value=\"${sprint.getId()}\">${sprint.getName()}</option>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t<div id=\"${moveSprintsBlockId}\" class=\"tasks-scrum-sprint-complete-popup-move-sprint\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t\t<select id=\"${moveSprintSelectId}\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t\t\t<option value=\"0\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_NEW_SPRINT')}\n\t\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t\t${listSprintsOptions}\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\t\t\t\t};\n\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-complete-popup\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-complete-popup-result\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-complete-popup-result-header\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_RESULT_HEADER')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-complete-popup-result-completed\">\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_RESULT_COMPLETED')\n\t\t\t\t\t\t\t\t\t\t.replace('#tasks#', this.getTasksCountLabel(sprint.getCompletedTasks()))\n\t\t\t\t\t\t\t\t\t\t.replace('#storyPoints#', sprint.getCompletedStoryPoints())\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-complete-popup-result-uncompleted\">\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_RESULT_UNCOMPLETED')\n\t\t\t\t\t\t\t\t\t\t.replace('#tasks#', this.getTasksCountLabel(sprint.getUnCompletedTasks()))\n\t\t\t\t\t\t\t\t\t\t.replace('#storyPoints#', sprint.getUnCompletedStoryPoints())\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-complete-popup-actions\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-complete-popup-move-header\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_MOVE_HEADER')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-complete-popup-move-select\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown\">\n\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t\t\t<select id=\"${moveSelectId}\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t\t\t\t<option value=\"backlog\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_MOVE_SELECTOR_BACKLOG')}\n\t\t\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"sprint\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_MOVE_SELECTOR_SPRINT')}\n\t\t\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${moveSprint()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t};\n\n\t\t\tconst popup = new Popup(popupId,\n\t\t\t\tnull,\n\t\t\t\t{\n\t\t\t\t\twidth: 360,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\tdraggable: true,\n\t\t\t\t\tresizable: false,\n\t\t\t\t\tlightShadow: true,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\ttitleBar: Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TITLE_POPUP').\n\t\t\t\t\t\treplace('#name#', sprint.getName()),\n\t\t\t\t\tcontent: getPopupContent(),\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_COMPLETE_BUTTON'),\n\t\t\t\t\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\tconst moveSelect = document.getElementById(moveSelectId);\n\t\t\t\t\t\t\t\t\tconst moveSprintSelect = document.getElementById(moveSprintSelectId);\n\t\t\t\t\t\t\t\t\tresolve({\n\t\t\t\t\t\t\t\t\t\tsprintId: sprint.getId(),\n\t\t\t\t\t\t\t\t\t\tdirection: moveSelect.value,\n\t\t\t\t\t\t\t\t\t\ttargetSprint: moveSprintSelect.value\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_START_BUTTON_CANCEL_POPUP'),\n\t\t\t\t\t\t\tcolor: Button.Color.LINK,\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: () => popup.close()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t});\n\n\t\t\tpopup.show();\n\n\t\t\tEvent.bind(document.getElementById(moveSelectId), 'change', (event) => {\n\t\t\t\tif (event.target.value === 'sprint')\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById(moveSprintsBlockId).style.display = 'block';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById(moveSprintsBlockId).style.display = 'none';\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTasksCountLabel(count)\n\t{\n\t\tif (count > 5)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_3');\n\t\t}\n\t\telse if (count === 1)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_2');\n\t\t}\n\t}\n}","import {RequestSender} from './request.sender';\nimport {Event, Dom, Type} from 'main.core';\nimport {SprintStats} from './sprint.stats';\nimport {Sprint} from './sprint';\nimport {SprintPopup} from './sprint.popup';\n\nexport class Kanban\n{\n\tconstructor(options)\n\t{\n\t\tthis.activeSprintData = (Type.isPlainObject(options.activeSprintData) ? options.activeSprintData : null);\n\t\tif (this.activeSprintData)\n\t\t{\n\t\t\tthis.requestSender = new RequestSender({\n\t\t\t\tsignedParameters: options.signedParameters,\n\t\t\t});\n\n\t\t\tthis.finishStatus = this.activeSprintData.finishStatus;\n\n\t\t\tthis.sprint = new Sprint(this.activeSprintData);\n\n\t\t\tthis.sprints = new Map();\n\t\t\toptions.sprints.forEach((sprintData) => {\n\t\t\t\tconst sprint = new Sprint(sprintData);\n\t\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t\t});\n\n\t\t\tthis.tabs = options.tabs;\n\n\t\t\tthis.itemsInFinishStage = new Map();\n\n\t\t\tthis.initDomNodes();\n\t\t\tthis.createSprintStats();\n\t\t\tthis.bindHandlers();\n\t\t}\n\t}\n\n\tinitDomNodes()\n\t{\n\t\tthis.sprintStatsContainer = document.getElementById('tasks-scrum-active-sprint-stats');\n\t\tthis.completeSprintButtonNode = document.getElementById('tasks-scrum-actions-complete-sprint');\n\t}\n\n\tcreateSprintStats()\n\t{\n\t\tthis.sprintStats = new SprintStats(this.sprint);\n\t\tthis.sprintStats.setKanbanMode();\n\t\tDom.append(this.sprintStats.createStats(), this.sprintStatsContainer);\n\t\tthis.sprintStats.onAfterAppend();\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEvent.bind(this.completeSprintButtonNode, 'click', this.onCompleteSprint.bind(this));\n\n\t\tif (window.Kanban)\n\t\t{\n\t\t\tthis.onKanbanRender(window.Kanban);\n\t\t\tBX.addCustomEvent(window.Kanban, 'Kanban.Grid:onItemMoved', this.onItemMoved.bind(this));\n\t\t}\n\t}\n\n\tonCompleteSprint()\n\t{\n\t\tconst sprintPopup = new SprintPopup({\n\t\t\tsprints: this.sprints\n\t\t});\n\n\t\tsprintPopup.showCompletePopup(this.sprint).then((requestData) => {\n\t\t\tthis.requestSender.completeSprint(requestData).then((response) => {\n\t\t\t\tlocation.href = this.tabs['planning'].url;\n\t\t\t}).catch((response) => {});\n\t\t});\n\t}\n\n\t/**\n\t * Handles Kanban render.\n\t * @param {BX.Tasks.Kanban.Grid} kanbanGrid\n\t * @returns {void}\n\t */\n\tonKanbanRender(kanbanGrid)\n\t{\n\t\tconst items = kanbanGrid.getItems();\n\t\tconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\t\tfor (let itemId in kanbanGrid.getItems())\n\t\t{\n\t\t\tif (hasOwnProperty.call(items, itemId))\n\t\t\t{\n\t\t\t\tconst item = items[itemId];\n\t\t\t\tif (item.getColumn().getType() === this.finishStatus)\n\t\t\t\t{\n\t\t\t\t\tthis.itemsInFinishStage.set(itemId, '');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Hook on item moved.\n\t * @param {BX.Tasks.Kanban.Item} item\n\t * @param {BX.Tasks.Kanban.Column} targetColumn\n\t * @param {BX.Tasks.Kanban.Item} [beforeItem]\n\t * @returns {void}\n\t */\n\tonItemMoved(item, targetColumn, beforeItem)\n\t{\n\t\tif (targetColumn.type === this.finishStatus)\n\t\t{\n\t\t\tif (!this.itemsInFinishStage.has(item.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedToFinish(item, this.sprint);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.itemsInFinishStage.has(item.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedFromFinish(item, this.sprint);\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateStatsAfterMovedToFinish(item, sprint)\n\t{\n\t\tthis.itemsInFinishStage.set(item.getId(), item.getStoryPoints());\n\t\tthis.sprintStats.updateActiveStats(item.getStoryPoints());\n\n\t\tsprint.setCompletedStoryPoints(sprint.getCompletedStoryPoints() + parseFloat(item.getStoryPoints()));\n\t\tsprint.setUnCompletedStoryPoints(sprint.getUnCompletedStoryPoints() - parseFloat(item.getStoryPoints()));\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() + 1);\n\t\tsprint.setUnCompletedTasks(sprint.getUnCompletedTasks() - 1);\n\t}\n\n\tupdateStatsAfterMovedFromFinish(item, sprint)\n\t{\n\t\tthis.itemsInFinishStage.delete(item.getId());\n\t\tthis.sprintStats.updateActiveStats(item.getStoryPoints(), false);\n\n\t\tsprint.setCompletedStoryPoints(sprint.getCompletedStoryPoints() - parseFloat(item.getStoryPoints()));\n\t\tsprint.setUnCompletedStoryPoints(sprint.getUnCompletedStoryPoints() + parseFloat(item.getStoryPoints()));\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() - 1);\n\t\tsprint.setUnCompletedTasks(sprint.getUnCompletedTasks() + 1);\n\t}\n}","import {Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class SidePanel extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SidePanel');\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\t/* eslint-disable */\n\t\tBX.addCustomEvent(window, 'SidePanel.Slider:onLoad', (event) => {\n\t\t\tconst sidePanel = event.getSlider();\n\t\t\tsidePanel.setCacheable(false);\n\t\t\tthis.emit('onLoadSidePanel', sidePanel);\n\t\t});\n\t\tBX.addCustomEvent(window, 'SidePanel.Slider:onClose', (event) => {\n\t\t\tconst sidePanel = event.getSlider();\n\t\t\tthis.emit('onCloseSidePanel', sidePanel);\n\t\t});\n\t\tBX.addCustomEvent(window, 'onAfterPopupShow', (popupWindow) => {\n\t\t\tconst topSlider = this.sidePanelManager.getTopSlider();\n\t\t\tconst topSidePanelZIndex = (topSlider ? topSlider.getZindex() : 1000);\n\t\t\tconst popupWindowZIndex = popupWindow.getZindex();\n\t\t\tconst zIndex = (topSidePanelZIndex > popupWindowZIndex ? topSidePanelZIndex + 1 : popupWindowZIndex + 1);\n\t\t\tDom.style(popupWindow.getPopupContainer(), 'zIndex', zIndex);\n\t\t});\n\t\t/* eslint-enable */\n\t}\n\n\tisPreviousSidePanelExist(currentSidePanel): Boolean\n\t{\n\t\treturn Boolean(this.sidePanelManager.getPreviousSlider(currentSidePanel));\n\t}\n\n\treloadTopSidePanel()\n\t{\n\t\tthis.sidePanelManager.getTopSlider().reload();\n\t}\n\n\treloadPreviousSidePanel(currentSidePanel)\n\t{\n\t\tconst previousSidePanel = this.sidePanelManager.getPreviousSlider(currentSidePanel);\n\t\tpreviousSidePanel.reload();\n\t}\n\n\topenSidePanelByUrl(url)\n\t{\n\t\tthis.sidePanelManager.open(url);\n\t}\n\n\topenSidePanel(id, contentCallback)\n\t{\n\t\tthis.sidePanelManager.open(id, {\n\t\t\tcontentCallback: contentCallback,\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n}","import {Event, Runtime, Tag, Text, Loc, Type, Dom} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport './css/epic.css';\n\nexport class Epic extends EventEmitter\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.requestSender = options.requestSender;\n\t\tthis.sidePanel = options.sidePanel;\n\t\tthis.entity = options.entity;\n\n\t\tthis.form = null;\n\n\t\tthis.defaultColor = '#69dafc';\n\t\tthis.selectedColor = '';\n\n\t\tthis.currentEpic = null;\n\t}\n\n\tgetCurrentEpic(): ?Object\n\t{\n\t\treturn this.currentEpic;\n\t}\n\n\topenAddForm()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadAddForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, () => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tresolve(this.buildAddForm());\n\t\t\t});\n\t\t});\n\t}\n\n\topenEditForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadEditForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, () => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\tresolve(this.buildEditForm());\n\t\t\t\t}).catch((response) => {});\n\t\t\t});\n\t\t});\n\t}\n\n\topenViewForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadViewForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, () => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\tresolve(this.buildViewForm());\n\t\t\t\t}).catch((response) => {});\n\t\t\t});\n\t\t});\n\t}\n\n\topenEpicsList()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequest.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, () => {\n\t\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadListGrid.bind(this));\n\t\t\tthis.sidePanel.subscribeOnce('onCloseSidePanel', this.destroyGrid.bind(this));\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tresolve(Tag.render`\n\t\t\t\t\t<div class=\"tasks-scrum-epics-list\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-add-button\">\n\t\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-sm\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epics-list-grid\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadAddForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.currentEpic = null;\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadAddButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.createEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.emit('onAfterCreateEpic', response);\n\t\t\t\t\tif (this.sidePanel.isPreviousSidePanelExist(sidePanel))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sidePanel.reloadPreviousSidePanel(sidePanel);\n\t\t\t\t\t\tsidePanel.close();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\t\tthis.openEpicsList();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tMessageBox.alert(\n\t\t\t\t\t\tresponse.errors.shift().message,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_CREATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadViewForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadDescription();\n\t\tthis.onLoadFiles();\n\t\tthis.onLoadViewButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\tthis.openEditForm(this.currentEpic.id);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadEditForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadEditButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.editEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.emit('onAfterEditEpic', response);\n\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\tthis.reloadGrid();\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tMessageBox.alert(\n\t\t\t\t\t\tresponse.errors.shift().message,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_UPDATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\treloadGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tBX.Main.gridManager.getById(this.gridId).instance.reload();\n\t\t/* eslint-enable */\n\t}\n\n\tdestroyGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tBX.Main.gridManager.getById(this.gridId).instance.destroy();\n\t\t/* eslint-enable */\n\t}\n\n\tonLoadEditor()\n\t{\n\t\tthis.getDescriptionEditor().then((editorHtml) => {\n\t\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\t\tRuntime.html(descriptionContainer, editorHtml).then(() => {\n\t\t\t\tthis.editor = window.LHEPostForm.getHandler(this.id);\n\t\t\t\twindow.BXHtmlEditor.Get(this.id);\n\t\t\t\tEventEmitter.emit(this.editor.eventNode, 'OnShowLHE', [true]);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.form.querySelector('.tasks-scrum-epic-form-header-title-control').focus();\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadDescription()\n\t{\n\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\tthis.requestSender.getEpicDescription({\n\t\t\tepicId: this.currentEpic.id,\n\t\t\ttext: this.currentEpic.description\n\t\t}).then(response => {\n\t\t\tRuntime.html(descriptionContainer, response.data);\n\t\t});\n\t}\n\n\tonLoadFiles()\n\t{\n\t\tconst filesContainer = this.form.querySelector('.tasks-scrum-epic-form-files');\n\t\tthis.requestSender.getEpicFiles({\n\t\t\tepicId: this.currentEpic.id\n\t\t}).then(response => {\n\t\t\tRuntime.html(filesContainer, response.data.html);\n\t\t});\n\t}\n\n\tonLoadColorPicker()\n\t{\n\t\tthis.selectedColor = (this.currentEpic ? this.currentEpic.info.color : this.defaultColor);\n\t\tconst colorBlockNode = this.form.querySelector('.tasks-scrum-epic-header-color');\n\t\tEvent.bind(colorBlockNode, 'click', () => {\n\t\t\tconst colorNode = colorBlockNode.querySelector('.tasks-scrum-epic-header-color-current');\n\t\t\tconst picker = this.getColorPicker(colorNode);\n\t\t\tpicker.open();\n\t\t});\n\t}\n\n\tonLoadAddButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadViewButtons(): Promise\n\t{\n\t\treturn this.getViewEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadEditButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadListGrid(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tconst form = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list');\n\t\tconst list = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list-grid');\n\n\t\tthis.getEpicsList().then((responseData) => {\n\t\t\tif (responseData.html)\n\t\t\t{\n\t\t\t\tRuntime.html(list, responseData.html);\n\t\t\t\tconst buttonNode = form.querySelector('.tasks-scrum-epic-header-add-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.remove(form.querySelector('.tasks-scrum-epic-header-add-button'));\n\t\t\t\tDom.append(this.getEmptyEpicListForm(), list);\n\t\t\t\tconst buttonNode = list.querySelector('.tasks-scrum-epics-empty-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [, eventArgs] = event.getCompatData();\n\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\teventArgs.method = 'POST';\n\n\t\tif (!eventArgs.url)\n\t\t{\n\t\t\teventArgs.url = this.requestSender.getEpicListUrl();\n\t\t}\n\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t\tentityId: this.entity.getId(),\n\t\t\tgridId: this.gridId,\n\t\t\tsignedParameters: this.requestSender.getSignedParameters()\n\t\t};\n\t}\n\n\tgetEpicsList() : Promise\n\t{\n\t\tthis.gridId = 'EpicsGrid' + Text.getRandom();\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicsList({\n\t\t\t\tentityId: this.entity.getId(),\n\t\t\t\tgridId: this.gridId\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetEpic(id: Number): Promise\n\t{\n\t\treturn this.requestSender.getEpic({id: id});\n\t}\n\n\tbuildAddForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader('', '#69dafc')}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildViewForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_VIEW_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t\t\t${Text.encode(this.currentEpic.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\t\t\"background-color: ${Text.encode(this.currentEpic.info.color)};\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\" style=\"padding: 15px 10px 15px 10px;\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-files\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildEditForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_EDIT_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader(this.currentEpic.name, this.currentEpic.info.color)}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEmptyEpicListForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epics-empty\">\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-first-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_FIRST_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-image\">\n\t\t\t\t\t<svg width=\"124px\" height=\"123px\" viewBox=\"0 0 124 123\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t\t<g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" opacity=\"0.28\">\n\t\t\t\t\t\t\t<path d=\"M83,105 L83,81.4375 L105,81.4375 L105,18 L17,18 L17,81.4375 L39,81.4375 L39,105 L83,105 Z M10.9411765,0 L113.058824,0 C119.101468,0 124,4.85902727 124,10.8529412 L124,112.147059 C124,118.140973 119.101468,123 113.058824,123 L10.9411765,123 C4.89853156,123 0,118.140973 0,112.147059 L0,10.8529412 C0,4.85902727 4.89853156,0 10.9411765,0 Z M44.0142862,47.0500004 L54.2142857,57.4416671 L79.7142857,32 L87,42.75 L54.2142857,75 L36,57.0833333 L44.0142862,47.0500004 Z\" fill=\"#A8ADB4\" />\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-second-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_SECOND_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-button\">\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-lg\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormHeader(title: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t${title}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormContainerHeader(name: String, color: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t<input type=\"text\" name=\"name\" value=\"${Text.encode(name)}\" class=\n\t\t\t\t\t\t\"tasks-scrum-epic-form-header-title-control\" placeholder=\n\t\t\t\t\t\t\"${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_NAME_PLACEHOLDER')}\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\"background-color: ${Text.encode(color)};\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetDescriptionEditor(): Promise\n\t{\n\t\tconst requestData = {\n\t\t\teditorId: this.id\n\t\t};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t\trequestData.text = this.currentEpic.description;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicDescriptionEditor(requestData).then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetAddEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getAddEpicFormButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetViewEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getViewEpicFormButtonsAction().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetColorPicker(colorNode)\n\t{\n\t\t/* eslint-disable */\n\t\treturn new BX.ColorPicker({\n\t\t\tbindElement: colorNode,\n\t\t\tdefaultColor: this.selectedColor,\n\t\t\tonColorSelected: (color, picker) => {\n\t\t\t\tthis.selectedColor = color;\n\t\t\t\tcolorNode.style.backgroundColor = color;\n\t\t\t},\n\t\t\tpopupOptions: {\n\t\t\t\tzIndex: 1100\n\t\t\t}\n\t\t});\n\t\t/* eslint-enable */\n\t}\n\n\tgetRequestData()\n\t{\n\t\tconst requestData = {};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t}\n\n\t\trequestData.entityId = this.entity.getId();\n\t\trequestData.name = this.form.querySelector('[name=name]').value;\n\t\trequestData.description = this.editor.oEditor.GetContent();\n\t\trequestData.color = this.selectedColor;\n\t\trequestData.files = this.getAttachmentsFiles();\n\n\t\treturn requestData;\n\t}\n\n\tgetAttachmentsFiles(): Array\n\t{\n\t\tconst files = [];\n\n\t\tif (!this.editor || !Type.isPlainObject(this.editor.arFiles) || !Type.isPlainObject(this.editor.controllers))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\tconst fileControllers = [];\n\t\tObject.values(this.editor.arFiles).forEach((controller) => {\n\t\t\tif(!fileControllers.includes(controller))\n\t\t\t{\n\t\t\t\tfileControllers.push(controller);\n\t\t\t}\n\t\t});\n\n\t\tfileControllers.forEach((fileController) => {\n\t\t\tif (\n\t\t\t\tthis.editor.controllers[fileController] &&\n\t\t\t\tType.isPlainObject(this.editor.controllers[fileController].values)\n\t\t\t)\n\t\t\t{\n\t\t\t\tObject.keys(this.editor.controllers[fileController].values).forEach((fileId) => {\n\t\t\t\t\tif (!files.includes(fileId))\n\t\t\t\t\t{\n\t\t\t\t\t\tfiles.push(fileId);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\n\t\treturn files;\n\t}\n}","import {Tag, Dom, Loc, Event} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Input} from './input';\n\nimport './css/decomposition.css';\n\nexport class Decomposition extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Decomposition');\n\n\t\tthis.items = new Set();\n\n\t\tthis.input = new Input();\n\t\tthis.input.setPlaceholder(Loc.getMessage('TASKS_SCRUM_TASK_ADD_DECOMPOSITION_INPUT_PLACEHOLDER'));\n\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t}\n\n\tdecomposeItem(item: Item)\n\t{\n\t\tthis.addDecomposedItem(item);\n\n\t\tDom.insertAfter(this.input.render(), item.getItemNode());\n\t\tthis.input.setNode();\n\n\t\tconst inputNode = this.input.getInputNode();\n\t\tEvent.bind(inputNode, 'input', this.input.onTagSearch.bind(this.input));\n\t\tEvent.bind(inputNode, 'keydown', this.onCreateItem.bind(this));\n\t\tinputNode.focus();\n\n\t\tconst button = this.createButton();\n\t\tDom.insertAfter(button, this.input.getNode());\n\n\t\tEvent.bind(button.querySelector('button'), 'click', () => {\n\t\t\tthis.deactivateDecompositionMode();\n\t\t\tthis.input.removeYourself()\n\t\t\tDom.remove(button);\n\t\t});\n\t}\n\n\taddDecomposedItem(item: Item)\n\t{\n\t\titem.activateDecompositionMode();\n\n\t\tthis.items.add(item);\n\t}\n\n\tgetDecomposedItems(): Set\n\t{\n\t\treturn this.items;\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.items.forEach((item) => {\n\t\t\titem.deactivateDecompositionMode();\n\t\t});\n\t\tthis.items.clear();\n\t}\n\n\tcreateButton(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-decomposition-structure\">\n\t\t\t\t<button class=\"ui-btn ui-btn-sm ui-btn-primary\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DECOMPOSITION_BUTTON')}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonCreateItem(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tif (!this.input.isTagsSearchMode())\n\t\t\t{\n\t\t\t\tconst inputNode = event.target;\n\t\t\t\tif (inputNode.value)\n\t\t\t\t{\n\t\t\t\t\tthis.emit('createItem', inputNode.value);\n\t\t\t\t\tinputNode.value = '';\n\t\t\t\t\tinputNode.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","export class Filter\n{\n\tconstructor(options)\n\t{\n\t\tthis.filterId = options.filterId;\n\t\tthis.scrumManager = options.scrumManager;\n\t\tthis.requestSender = options.requestSender;\n\n\t\tthis.initUiFilterManager();\n\t\tthis.bindHandlers();\n\t}\n\n\tinitUiFilterManager()\n\t{\n\t\t/* eslint-disable */\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\t\t/* eslint-enable */\n\t}\n\n\tbindHandlers()\n\t{\n\t\t/* eslint-disable */\n\t\tBX.addCustomEvent('BX.Main.Filter:apply', this.onApplyFilter.bind(this));\n\t\t/* eslint-enable */\n\t}\n\n\tonApplyFilter(filterId, values, filterInstance, promise, params)\n\t{\n\t\tif (this.filterId !== filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.scrumManager.fadeOutAll();\n\n\t\tparams.autoResolve = false;\n\n\t\tthis.requestSender.applyFilter()\n\t\t\t.then(response => {\n\t\t\t\tconst filteredItemsData = response.data;\n\t\t\t\tthis.scrumManager.getAllItems().forEach((item) => {\n\t\t\t\t\tthis.scrumManager.removeItemFromEntities(item);\n\t\t\t\t});\n\t\t\t\tfilteredItemsData.forEach((itemData) => {\n\t\t\t\t\tthis.scrumManager.appendNewItemToEntity(this.scrumManager.createTaskItemByItemData(itemData));\n\t\t\t\t});\n\t\t\t\tpromise.fulfill();\n\t\t\t\tthis.scrumManager.fadeInAll();\n\t\t\t}).catch((response) => {\n\t\t\t\tpromise.reject();\n\t\t\tthis.scrumManager.fadeInAll();\n\t\t\t});\n\t}\n}","import {Loc, Dom, Tag, Type, Event, Text} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {RequestSender} from './request.sender';\nimport {Backlog} from './backlog';\nimport {Sprint} from './sprint';\nimport {Entity} from './entity';\nimport {Item} from './item';\nimport {Kanban} from './kanban';\nimport {Popup, Menu} from 'main.popup';\nimport {Button} from 'ui.buttons';\nimport {Draggable} from 'ui.draganddrop.draggable';\nimport {SprintDate} from './sprint.date';\nimport {SprintPopup} from './sprint.popup';\nimport {SidePanel} from './side.panel';\nimport {Epic} from './epic';\nimport {TagSearcher} from './tag.searcher';\nimport {Decomposition} from './decomposition';\nimport {Filter} from './filter';\n\nimport './css/base.css';\n\nexport class Scrum\n{\n\tconstructor(options)\n\t{\n\t\tthis.defaultSprintDuration = options.defaultSprintDuration;\n\t\tthis.pathToTask = options.pathToTask;\n\n\t\tthis.requestSender = new RequestSender({\n\t\t\tsignedParameters: options.signedParameters,\n\t\t\tdebugMode: options.debugMode\n\t\t});\n\n\t\tthis.activeSprintId = parseInt(options.activeSprintId, 10);\n\t\tthis.tabs = options.tabs;\n\t\tthis.activeTab = options.activeTab;\n\n\t\tif (this.activeTab === 'activeSprint')\n\t\t{\n\t\t\tthis.kanban = new Kanban(options);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.backlog = new Backlog(options.backlog);\n\n\t\t\tthis.sprints = new Map();\n\t\t\toptions.sprints.forEach((sprintData) => {\n\t\t\t\tsprintData.defaultSprintDuration = this.defaultSprintDuration;\n\t\t\t\tconst sprint = new Sprint(sprintData);\n\t\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t\t});\n\n\t\t\tthis.sidePanel = new SidePanel();\n\n\t\t\tthis.tagSearcher = new TagSearcher({\n\t\t\t\trequestSender: this.requestSender\n\t\t\t});\n\t\t\tObject.values(options.tags.epic).forEach((epic) => {\n\t\t\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\t\t});\n\t\t\tObject.values(options.tags.task).forEach((tagName) => {\n\t\t\t\tthis.tagSearcher.addTagToSearcher(tagName);\n\t\t\t});\n\n\t\t\tthis.epic = new Epic({\n\t\t\t\tentity: this.backlog,\n\t\t\t\trequestSender: this.requestSender,\n\t\t\t\tsidePanel: this.sidePanel\n\t\t\t});\n\t\t\tthis.epic.subscribe('onAfterCreateEpic', (baseEvent) => {\n\t\t\t\tconst response = baseEvent.getData();\n\t\t\t\tthis.tagSearcher.addEpicToSearcher(response.data);\n\t\t\t});\n\n\t\t\tthis.filter = new Filter({\n\t\t\t\tfilterId: options.filterId,\n\t\t\t\tscrumManager: this,\n\t\t\t\trequestSender: this.requestSender\n\t\t\t});\n\n\t\t\tthis.bindHandlers();\n\t\t}\n\t}\n\n\trenderTo(container)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for Scrum not found');\n\t\t}\n\n\t\tthis.scrumContainer = container;\n\n\t\tDom.append(this.backlog.render(), this.scrumContainer);\n\t\tthis.backlog.onAfterAppend();\n\n\t\tDom.append(this.renderSprintsContainer(), this.scrumContainer);\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tsprint.onAfterAppend();\n\t\t});\n\n\t\tthis.sprintCreatingButtonNode = document.getElementById(this.sprintCreatingButtonNodeId);\n\t\tthis.sprintCreatingDropZoneNode = document.getElementById(this.sprintCreatingDropZoneNodeId);\n\t\tthis.sprintListNode = document.getElementById(this.sprintListNodeId);\n\n\t\tEvent.bind(this.sprintCreatingButtonNode, 'click', this.createSprint.bind(this));\n\n\t\tthis.setDraggable();\n\t}\n\n\tsetDraggable()\n\t{\n\t\tconst itemContainers = [];\n\t\titemContainers.push(this.backlog.getListItemsNode());\n\t\tif (this.sprintCreatingDropZoneNode)\n\t\t{\n\t\t\titemContainers.push(this.sprintCreatingDropZoneNode);\n\t\t}\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tif (!sprint.isDisabled())\n\t\t\t{\n\t\t\t\titemContainers.push(sprint.getListItemsNode());\n\t\t\t}\n\t\t});\n\t\tthis.draggableItems = new Draggable({\n\t\t\tcontainer: itemContainers,\n\t\t\tdraggable: '.tasks-scrum-item',\n\t\t\tdragElement: '.tasks-scrum-dragndrop',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t});\n\t\tthis.draggableItems.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.onItemMove(dragEndEvent);\n\t\t});\n\n\t\tthis.draggableSprints = new Draggable({\n\t\t\tcontainer: this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list'),\n\t\t\tdraggable: '.tasks-scrum-sprint',\n\t\t\tdragElement: '.tasks-scrum-sprint-dragndrop',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t});\n\t\tthis.draggableSprints.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.onSprintMove(dragEndEvent);\n\t\t});\n\t}\n\n\tbindHandlers(newSprint)\n\t{\n\t\tconst createTaskItem = (baseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst inputObject = data.inputObject;\n\t\t\tconst inputValue = data.value;\n\n\t\t\tconst newItem = this.createItem('task', inputValue);\n\t\t\tnewItem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\t\tnewItem.setSort(1);\n\n\t\t\tthis.appendItem(newItem, entity.getListItemsNode(), inputObject.getNode());\n\n\t\t\tnewItem.setParentId(inputObject.getEpicId());\n\n\t\t\tthis.sendRequestToCreateTask(entity, newItem, inputValue).then((response) => {\n\t\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t\t});\n\t\t\t\tentity.setItem(newItem);\n\t\t\t});\n\t\t};\n\t\tconst onUpdateItem = (baseEvent) => {\n\t\t\tthis.requestSender.updateItem(baseEvent.getData());\n\t\t};\n\t\tconst onShowTask = (baseEvent) => {\n\t\t\tconst item = baseEvent.getData();\n\t\t\tthis.sidePanel.openSidePanelByUrl(this.pathToTask.replace('#task_id#', item.sourceId));\n\t\t};\n\t\tconst onMoveItem = (baseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tthis.moveItem(data.item, data.button);\n\t\t};\n\t\tconst onMoveToSprint = (baseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tthis.moveToSprint(data.item, data.button);\n\t\t};\n\t\tconst onMoveToBacklog = (baseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tthis.moveToBacklog(data.sprint, data.item);\n\t\t};\n\t\tconst onAttachFilesToTask = (baseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tthis.requestSender.attachFilesToTask({\n\t\t\t\ttaskId: data.item.getSourceId(),\n\t\t\t\tattachedIds: data.attachedIds,\n\t\t\t}).then((response) => {\n\t\t\t\tdata.item.updateIndicators(response.data);\n\t\t\t});\n\t\t};\n\t\tconst onRemoveItem = (baseEvent) => {\n\t\t\tthis.requestSender.removeItem({\n\t\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\t\tsortInfo: this.calculateSort(baseEvent.getTarget().getListItemsNode())\n\t\t\t});\n\t\t};\n\t\tconst onStartSprint = (baseEvent) => {\n\t\t\tthis.showStartSprintPopup(baseEvent.getTarget());\n\t\t};\n\t\tconst onCompleteSprint = (baseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tconst sprintPopup = new SprintPopup({\n\t\t\t\tsprints: this.sprints\n\t\t\t});\n\t\t\tsprintPopup.showCompletePopup(sprint).then((requestData) => {\n\t\t\t\tthis.requestSender.completeSprint(requestData).then((response) => {\n\t\t\t\t\tlocation.reload();\n\t\t\t\t}).catch((response) => {});\n\t\t\t});\n\t\t};\n\t\tconst onChangeTaskResponsible = (baseEvent) => {\n\t\t\tthis.requestSender.changeTaskResponsible({\n\t\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\t\tresponsible: baseEvent.getData().gerResponsible(),\n\t\t\t});\n\t\t};\n\t\tconst onRemoveSprint = (baseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tthis.sprints.delete(sprint.getId());\n\t\t\tthis.requestSender.removeSprint({\n\t\t\t\tsprintId: sprint.getId(),\n\t\t\t\tsortInfo: this.calculateSprintSort()\n\t\t\t});\n\t\t};\n\t\tconst onChangeSprintName = (baseEvent) => {\n\t\t\tthis.requestSender.changeSprintName(baseEvent.getData());\n\t\t};\n\t\tconst onChangeSprintDeadline = (baseEvent) => {\n\t\t\tthis.requestSender.changeSprintDeadline(baseEvent.getData());\n\t\t};\n\t\tconst onOpenAddEpicForm = (baseEvent) => {\n\t\t\tthis.epic.openAddForm();\n\t\t};\n\t\tconst onOpenListEpicGrid = (baseEvent) => {\n\t\t\tthis.epic.openEpicsList();\n\t\t\tthis.epic.subscribe('onAfterEditEpic', (innerBaseEvent) => {\n\t\t\t\tconst response = innerBaseEvent.getData();\n\t\t\t\tconst updatedEpicInfo = response.data;\n\t\t\t\tconst oldEpicInfo = this.epic.getCurrentEpic();\n\t\t\t\tthis.getAllItems().forEach((item) => {\n\t\t\t\t\tconst itemEpic = item.getEpic();\n\t\t\t\t\tif (itemEpic && itemEpic.name === oldEpicInfo.name)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.setEpicAndTags(updatedEpicInfo);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.tagSearcher.removeEpicFromSearcher(oldEpicInfo);\n\t\t\t\tthis.tagSearcher.addEpicToSearcher(updatedEpicInfo);\n\t\t\t});\n\t\t};\n\t\tconst onShowTagSearcher = (baseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst item = data.item;\n\t\t\tconst actionsPanelButton = data.button;\n\t\t\tthis.tagSearcher.showTagsDialog(item, actionsPanelButton);\n\t\t};\n\t\tconst onShowEpicSearcher = (baseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst item = data.item;\n\t\t\tconst actionsPanelButton = data.button;\n\t\t\tthis.tagSearcher.showEpicDialog(item, actionsPanelButton);\n\t\t};\n\t\tconst onStartDecomposition = (baseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst parentItem = baseEvent.getData();\n\n\t\t\tconst decomposition = new Decomposition();\n\t\t\tdecomposition.subscribe('tagsSearchOpen', onTagsSearchOpen);\n\t\t\tdecomposition.subscribe('tagsSearchClose', onTagsSearchClose);\n\t\t\tdecomposition.subscribe('createItem', (innerBaseEvent) => {\n\t\t\t\tconst inputValue = innerBaseEvent.getData();\n\t\t\t\tconst decomposedItems = decomposition.getDecomposedItems();\n\t\t\t\tconst lastDecomposedItem = Array.from(decomposedItems).pop();\n\n\t\t\t\tconst newItem = this.createItem(parentItem.getItemType(), inputValue);\n\t\t\t\tnewItem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\t\t\tnewItem.setParentId(parentItem.getParentId());\n\t\t\t\tnewItem.setParentSourceId(parentItem.getSourceId());\n\t\t\t\tnewItem.setSort(lastDecomposedItem.getSort() + 1);\n\t\t\t\tnewItem.setTags(parentItem.getTags());\n\n\t\t\t\tthis.appendItem(newItem, entity.getListItemsNode(), lastDecomposedItem.getItemNode());\n\n\t\t\t\tdecomposition.addDecomposedItem(newItem);\n\n\t\t\t\tthis.sendRequestToCreateTask(entity, newItem, inputValue).then((response) => {\n\t\t\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t\t\t});\n\t\t\t\t\tentity.setItem(newItem);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tdecomposition.decomposeItem(parentItem);\n\t\t};\n\t\tconst onTagsSearchOpen = (baseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst inputObject = data.inputObject;\n\t\t\tconst enteredHashTagName = data.enteredHashTagName;\n\t\t\tthis.tagSearcher.showTagsSearchDialog(inputObject, enteredHashTagName);\n\t\t};\n\t\tconst onTagsSearchClose = () => {\n\t\t\tthis.tagSearcher.closeTagsSearchDialog();\n\t\t};\n\t\tconst onEpicSearchOpen = (baseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst inputObject = data.inputObject;\n\t\t\tconst enteredHashEpicName = data.enteredHashEpicName;\n\t\t\tthis.tagSearcher.showEpicSearchDialog(inputObject, enteredHashEpicName);\n\t\t};\n\t\tconst onEpicSearchClose = () => {\n\t\t\tthis.tagSearcher.closeEpicSearchDialog();\n\t\t};\n\n\t\tconst subscribeToSprint = (sprint) => {\n\t\t\tsprint.subscribe('createTaskItem', createTaskItem);\n\t\t\tsprint.subscribe('updateItem', onUpdateItem);\n\t\t\tsprint.subscribe('showTask', onShowTask);\n\t\t\tsprint.subscribe('moveItem', onMoveItem);\n\t\t\tsprint.subscribe('moveToBacklog', onMoveToBacklog);\n\t\t\tsprint.subscribe('removeItem', onRemoveItem);\n\t\t\tsprint.subscribe('startSprint', onStartSprint);\n\t\t\tsprint.subscribe('completeSprint', onCompleteSprint);\n\t\t\tsprint.subscribe('changeTaskResponsible', onChangeTaskResponsible);\n\t\t\tsprint.subscribe('removeSprint', onRemoveSprint);\n\t\t\tsprint.subscribe('changeSprintName', onChangeSprintName);\n\t\t\tsprint.subscribe('changeSprintDeadline', onChangeSprintDeadline);\n\t\t\tsprint.subscribe('attachFilesToTask', onAttachFilesToTask);\n\t\t\tsprint.subscribe('showTagSearcher', onShowTagSearcher);\n\t\t\tsprint.subscribe('showEpicSearcher', onShowEpicSearcher);\n\t\t\tsprint.subscribe('startDecomposition', onStartDecomposition);\n\t\t\tsprint.subscribe('tagsSearchOpen', onTagsSearchOpen);\n\t\t\tsprint.subscribe('tagsSearchClose', onTagsSearchClose);\n\t\t\tsprint.subscribe('epicSearchOpen', onEpicSearchOpen);\n\t\t\tsprint.subscribe('epicSearchClose', onEpicSearchClose);\n\t\t};\n\n\t\tif (newSprint)\n\t\t{\n\t\t\tsubscribeToSprint(newSprint);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.backlog.subscribe('createTaskItem', createTaskItem);\n\t\tthis.backlog.subscribe('updateItem', onUpdateItem);\n\t\tthis.backlog.subscribe('showTask', onShowTask);\n\t\tthis.backlog.subscribe('moveItem', onMoveItem);\n\t\tthis.backlog.subscribe('moveToSprint', onMoveToSprint);\n\t\tthis.backlog.subscribe('removeItem', onRemoveItem);\n\t\tthis.backlog.subscribe('changeTaskResponsible', onChangeTaskResponsible);\n\t\tthis.backlog.subscribe('openAddEpicForm', onOpenAddEpicForm);\n\t\tthis.backlog.subscribe('openListEpicGrid', onOpenListEpicGrid);\n\t\tthis.backlog.subscribe('attachFilesToTask', onAttachFilesToTask);\n\t\tthis.backlog.subscribe('showTagSearcher', onShowTagSearcher);\n\t\tthis.backlog.subscribe('showEpicSearcher', onShowEpicSearcher);\n\t\tthis.backlog.subscribe('startDecomposition', onStartDecomposition);\n\t\tthis.backlog.subscribe('tagsSearchOpen', onTagsSearchOpen);\n\t\tthis.backlog.subscribe('tagsSearchClose', onTagsSearchClose);\n\t\tthis.backlog.subscribe('epicSearchOpen', onEpicSearchOpen);\n\t\tthis.backlog.subscribe('epicSearchClose', onEpicSearchClose);\n\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tsubscribeToSprint(sprint);\n\t\t});\n\t}\n\n\t/**\n\t * @returns {HTMLElement}\n\t */\n\trenderSprintsContainer()\n\t{\n\t\tconst createCreatingButton = () => {\n\t\t\tthis.sprintCreatingButtonNodeId = 'tasks-scrum-sprint-creating-button';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingButtonNodeId}\" class=\"tasks-scrum-sprint-create ui-btn ui-btn-md ui-btn-themes ui-btn-light-border ui-btn-icon-add\">\n\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD')}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createCreatingDropZone = () => {\n\t\t\tif (this.sprints.size)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tthis.sprintCreatingDropZoneNodeId = 'tasks-scrum-sprint-creating-drop-zone';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingDropZoneNodeId}\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-file-drop tasks-scrum-sprint-sprint-add-drop\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t<small>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_DROP')}</small>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createSprintsList = () => {\n\t\t\tthis.sprintListNodeId = 'tasks-scrum-sprint-list';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintListNodeId}\" class=\"tasks-scrum-sprint-list\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-active-list\">\n\t\t\t\t\t\t${[...this.sprints.values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isActive())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-planned-list\">\n\t\t\t\t\t\t${[...this.sprints.values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isPlanned())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-completed-list\">\n\t\t\t\t\t\t${[...this.sprints.values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isCompleted())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprints\">\n\t\t\t\t${createCreatingButton()}\n\t\t\t\t${createCreatingDropZone()}\n\t\t\t\t${createSprintsList()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateSprint()\n\t{\n\t\tDom.remove(this.sprintCreatingDropZoneNode);\n\n\t\tconst countSprints = this.sprints.size;\n\t\tconst title = Loc.getMessage('TASKS_SCRUM_SPRINT_NAME').replace('%s', countSprints + 1);\n\t\tconst storyPoints = 0;\n\t\tconst dateStart = Math.floor(Date.now() / 1000);\n\t\tconst dateEnd = (Math.floor(Date.now() / 1000) + parseInt(this.defaultSprintDuration, 10));\n\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\n\t\tconst data = {\n\t\t\tname: title,\n\t\t\tsort: 1,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd,\n\t\t\tsortInfo: this.calculateSprintSort(1)\n\t\t};\n\n\t\treturn this.requestSender.createSprint(data)\n\t\t\t.then((response) => {\n\t\t\t\tconst sprint = new Sprint({\n\t\t\t\t\tid: response.data.sprintId,\n\t\t\t\t\tname: title,\n\t\t\t\t\tsort: 1,\n\t\t\t\t\tdateStart: dateStart,\n\t\t\t\t\tdateEnd: dateEnd,\n\t\t\t\t\tstoryPoints: storyPoints\n\t\t\t\t});\n\t\t\t\tif (sprintListNode.children.length)\n\t\t\t\t{\n\t\t\t\t\tDom.insertBefore(sprint.render(), sprintListNode.firstElementChild);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.insertBefore(sprint.render(), sprintListNode);\n\t\t\t\t}\n\t\t\t\tsprint.onAfterAppend();\n\t\t\t\tsprint.getSprintNode().scrollIntoView(true);\n\t\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t\t\tthis.bindHandlers(sprint);\n\t\t\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\t\t\t\treturn sprint;\n\t\t\t}).catch((response) => {});\n\t}\n\n\tcreateItem(itemType: String, value: String): Item\n\t{\n\t\tconst valueWithoutTags = value\n\t\t\t.replace(new RegExp('#([^\\\\s]*)','g'), '')\n\t\t\t.replace(new RegExp('@([^\\\\s]*)','g'),'');\n\n\t\treturn new Item({\n\t\t\t'itemId': '',\n\t\t\t'itemType': itemType,\n\t\t\t'name': valueWithoutTags\n\t\t});\n\t}\n\n\tappendItem(item: Item, entityListNode: HTMLElement, bindItemNode: HTMLElement)\n\t{\n\t\tthis.appendItemAfterItem(item.render(), bindItemNode);\n\t\titem.onAfterAppend(entityListNode);\n\t}\n\n\tsendRequestToCreateTask(entity: Entity, item: Item, value: String): Promise\n\t{\n\t\tconst requestData = {\n\t\t\t'itemType': item.getItemType(),\n\t\t\t'name': value,\n\t\t\t'entityId': item.getEntityId(),\n\t\t\t'entityType': entity.getEntityType(),\n\t\t\t'parentId': item.getParentId(),\n\t\t\t'sort': item.getSort(),\n\t\t\t'storyPoints': item.getStoryPoints(),\n\t\t\t'tags': item.getTags(),\n\t\t\t'epic': item.getEpic(),\n\t\t\t'parentSourceId': item.getParentSourceId(),\n\t\t\t'sortInfo': this.calculateSort(entity.getListItemsNode()),\n\t\t\t'isActiveSprint': ((entity.getEntityType() === 'sprint' && entity.isActive()) ? 'Y' : 'N')\n\t\t};\n\t\treturn this.requestSender.createTask(requestData);\n\t}\n\n\tfillItemAfterCreation(item: Item, responseData: Object): Item\n\t{\n\t\titem.setItemId(responseData.itemId);\n\t\titem.setEpicAndTags(responseData.epic, responseData.tags);\n\t\titem.setResponsible(responseData.responsible);\n\t\titem.setSourceId(responseData.sourceId);\n\t}\n\n\tmoveToSprint(item, button)\n\t{\n\t\tconst getAvailableSprintsToMove = () => {\n\t\t\tconst sprints = new Set();\n\t\t\tthis.sprints.forEach((sprint) => {\n\t\t\t\tif (!sprint.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tsprints.add(sprint);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn sprints;\n\t\t};\n\n\t\tconst sprints = getAvailableSprintsToMove();\n\n\t\tif (sprints.size > 1)\n\t\t{\n\t\t\tthis.showMoveToSprintMenu(item, button);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst moveToNewSprint = () => {\n\t\t\t\tthis.createSprint().then((sprint) => {\n\t\t\t\t\tthis.moveTo(this.backlog, sprint, item);\n\t\t\t\t});\n\t\t\t};\n\t\t\tif (sprints.size === 0)\n\t\t\t{\n\t\t\t\tmoveToNewSprint();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsprints.forEach((sprint) => {\n\t\t\t\t\tthis.moveTo(this.backlog, sprint, item);\n\t\t\t\t});\n\t\t\t}\n\t\t\tDom.remove(button.parentNode);\n\t\t}\n\t}\n\n\tmoveToBacklog(sprint, item)\n\t{\n\t\tthis.moveTo(sprint, this.backlog, item, false);\n\t}\n\n\tmoveTo(entityFrom, entityTo, item, after = true)\n\t{\n\t\tconst itemNode = item.getItemNode();\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\t\tif (after)\n\t\t{\n\t\t\tDom.append(itemNode, entityListNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.appendItemAfterItem(itemNode, entityListNode.firstElementChild);\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\titemType: item.getItemType(),\n\t\t\tentityId: entityTo.getId(),\n\t\t\tfromActiveSprint: ((entityFrom.getEntityType() === 'sprint' && entityFrom.isActive()) ? 'Y' : 'N'),\n\t\t\ttoActiveSprint: ((entityTo.getEntityType() === 'sprint' && entityTo.isActive()) ? 'Y' : 'N'),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode()),\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode())\n\t\t\t}\n\t\t});\n\t}\n\n\tmoveItemFromEntityToEntity(item, entityFrom, entityTo)\n\t{\n\t\tentityFrom.removeItem(item);\n\t\titem.setParentEntity(entityTo.getId(), entityTo.getEntityType());\n\t\titem.setDisableStatus(false);\n\t\tentityTo.setItem(item);\n\t}\n\n\tshowMoveToSprintMenu(item, button)\n\t{\n\t\tconst id = `item-sprint-action-${item.itemId}`;\n\n\t\tif (this.moveToSprintMenu)\n\t\t{\n\t\t\tif (this.moveToSprintMenu.getPopupWindow().getId() === id)\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.getPopupWindow().setBindElement(button);\n\t\t\t\tthis.moveToSprintMenu.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.moveToSprintMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveToSprintMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tif (!sprint.isCompleted())\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.addMenuItem({\n\t\t\t\t\ttext: sprint.getName(),\n\t\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\t\tthis.moveTo(this.backlog, sprint, item);\n\t\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.moveToSprintMenu.show();\n\t}\n\n\tcalculateSort(container)\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst items = [...container.querySelectorAll('[data-sort]')];\n\t\tlet sort = 1;\n\t\titems.forEach((itemNode) => {\n\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\tconst item = this.findItemByItemId(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.setSort(sort);\n\t\t\t\tlistSortInfo[itemId] = {\n\t\t\t\t\tentityId: container.dataset.entityId,\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\titemNode.dataset.sort = sort;\n\t\t\t}\n\t\t\tsort++;\n\t\t});\n\n\t\treturn listSortInfo;\n\t}\n\n\tcalculateSprintSort(increment = 0)\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst container = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\n\t\tconst sprints = [...container.querySelectorAll('[data-sprint-sort]')];\n\t\tlet sort = 1 + increment;\n\t\tsprints.forEach((sprintNode) => {\n\t\t\tconst sprintId = sprintNode.dataset.sprintId;\n\t\t\tconst sprint = this.findEntityByEntityId(sprintId);\n\t\t\tif (sprint)\n\t\t\t{\n\t\t\t\tsprint.setSort(sort);\n\t\t\t\tlistSortInfo[sprintId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tsprintNode.dataset.sprintSort = sort;\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\n\t\treturn listSortInfo;\n\t}\n\n\tappendItemAfterItem (newNode, item)\n\t{\n\t\tif (item.nextElementSibling)\n\t\t{\n\t\t\tDom.insertBefore(newNode, item.nextElementSibling);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newNode, item.parentElement);\n\t\t}\n\t};\n\n\tshowStartSprintPopup(sprint)\n\t{\n\t\t//todo move to sprint.popup\n\t\tthis.popupId = 'tasks-scrum-start-sprint' + Text.getRandom();\n\n\t\tconst sprintDate = new SprintDate(sprint);\n\t\tsprintDate.subscribe('changeSprintDeadline', (baseEvent) => {\n\t\t\tconst requestData = baseEvent.getData();\n\t\t\tthis.requestSender.changeSprintDeadline(baseEvent.getData()).then((response) => {\n\t\t\t\tif (requestData.hasOwnProperty('dateStart'))\n\t\t\t\t{\n\t\t\t\t\tsprint.updateDateStartNode(requestData.dateStart);\n\t\t\t\t}\n\t\t\t\telse if (requestData.hasOwnProperty('dateEnd'))\n\t\t\t\t{\n\t\t\t\t\tsprint.updateDateEndNode(requestData.dateEnd);\n\t\t\t\t}\n\t\t\t}).catch((response) => {});\n\t\t});\n\n\t\tconst getPopupContent = () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-sprint-start-popup\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-start-popup-duration\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-start-popup-content-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_POPUP_CONTENT_DURATION')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-start-popup-content-info\">\n\t\t\t\t\t\t\t${Text.encode(sprintDate.createDate(sprint.getDateStart(), sprint.getDateEnd()))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-start-popup-taken\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-start-popup-content-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_POPUP_CONTENT_TAKEN')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-start-popup-content-info\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_POPUP_CONTENT_TAKEN_VALUE')\n\t\t\t\t\t\t\t\t.replace('#storyPoints#', sprint.getStoryPoints())}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst startSprint = () => {\n\t\t\tthis.requestSender.startSprint({\n\t\t\t\tsprintId: sprint.getId()\n\t\t\t}).then((response) => {\n\t\t\t\tsprint.setStatus('active');\n\t\t\t\tthis.popup.close();\n\t\t\t\tlocation.href = this.tabs['activeSprint'].url;\n\t\t\t}).catch((response) => {\n\t\t\t\tMessageBox.alert(\n\t\t\t\t\tresponse.errors.shift().message,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t});\n\t\t};\n\n\t\tthis.popup = new Popup(this.popupId,\n\t\t\tnull,\n\t\t\t{\n\t\t\t\twidth: 360,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcacheable: false,\n\t\t\t\ttitleBar: Loc.getMessage('TASKS_SCRUM_SPRINT_START_TITLE_POPUP').replace('#name#', sprint.getName()),\n\t\t\t\tcontent: getPopupContent(),\n\t\t\t\tbuttons: [\n\t\t\t\t\tnew Button({\n\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_START_BUTTON_START_POPUP'),\n\t\t\t\t\t\tcolor: Button.Color.PRIMARY,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: () => startSprint()\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tnew Button({\n\t\t\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_SPRINT_START_BUTTON_CANCEL_POPUP'),\n\t\t\t\t\t\tcolor: Button.Color.LINK,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: () => this.popup.close()\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t]\n\t\t\t});\n\n\t\tthis.popup.show();\n\n\t\tsprintDate.onAfterAppend();\n\t}\n\n\tonItemMove(dragEndEvent)\n\t{\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\tconst endContainer = dragEndEvent.endContainer;\n\n\t\tif (endContainer === this.sprintCreatingDropZoneNode)\n\t\t{\n\t\t\tconst createNewSprintAndMoveItem = () => {\n\t\t\t\tthis.createSprint().then((sprint) => {\n\t\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\t\tconst item = this.findItemByItemId(itemId);\n\t\t\t\t\tthis.moveTo(this.backlog, sprint, item);\n\t\t\t\t});\n\t\t\t};\n\t\t\tcreateNewSprintAndMoveItem();\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\n\t\tif (sourceEntityId === endEntityId)\n\t\t{\n\t\t\tconst moveInCurrentContainer = () => {\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tsortInfo: this.calculateSort(sourceContainer)\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInCurrentContainer();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst moveInAnotherContainer = () => {\n\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\tconst item = this.findItemByItemId(itemId);\n\t\t\t\tconst sourceEntity = this.findEntityByEntityId(sourceEntityId);\n\t\t\t\tconst endEntity = this.findEntityByEntityId(endEntityId);\n\t\t\t\tthis.moveItemFromEntityToEntity(item, sourceEntity, endEntity);\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tentityId: endEntity.getId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\titemType: item.getItemType(),\n\t\t\t\t\tfromActiveSprint: ((sourceEntity.getEntityType() === 'sprint' && sourceEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\ttoActiveSprint: ((endEntity.getEntityType() === 'sprint' && endEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\tsortInfo: this.calculateSort(endContainer)\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInAnotherContainer();\n\t\t}\n\t}\n\n\tonSprintMove(dragEndEvent)\n\t{\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.updateSprintSort({\n\t\t\tsortInfo: this.calculateSprintSort()\n\t\t});\n\t}\n\n\tfindItemByItemId(itemId)\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn backlogItems.get(itemId);\n\t\t}\n\n\t\tconst sprint = [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t\tif (sprint)\n\t\t{\n\t\t\treturn sprint.getItems().get(itemId);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindEntityByItemId(itemId)\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t}\n\n\tfindEntityByEntityId(entityId)\n\t{\n\t\tentityId = parseInt(entityId, 10);\n\n\t\tif (this.backlog.getId() === entityId)\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === entityId);\n\t}\n\n\tmoveItem(item: Item, button)\n\t{\n\t\tconst entity = this.findEntityByItemId(item.getItemId());\n\n\t\tconst listToMove = [];\n\n\t\tif (!entity.isFirstItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_UP'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tthis.moveItemToUp(item, entity.getListItemsNode(), entity.hasInput());\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (!entity.isLastItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_DOWN'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tthis.moveItemToDown(item, entity.getListItemsNode());\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.showMoveItemMenu(item, button, listToMove);\n\t}\n\n\tshowMoveItemMenu(item, button, listToMove)\n\t{\n\t\tconst id = `item-move-${item.itemId}`;\n\n\t\tif (this.moveItemMenu)\n\t\t{\n\t\t\tthis.moveItemMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveItemMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tlistToMove.forEach((item) => {\n\t\t\tthis.moveItemMenu.addMenuItem(item);\n\t\t});\n\n\t\tthis.moveItemMenu.show();\n\t}\n\n\tmoveItemToUp(item, listItemsNode, entityWithInput = true)\n\t{\n\t\tif (entityWithInput)\n\t\t{\n\t\t\tthis.appendItemAfterItem(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.insertBefore(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(listItemsNode)\n\t\t\t}\n\t\t});\n\n\t}\n\n\tmoveItemToDown(item, listItemsNode)\n\t{\n\t\tDom.append(item.getItemNode(), listItemsNode);\n\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(listItemsNode)\n\t\t\t}\n\t\t});\n\t}\n\n\tgetAllItems(): Map\n\t{\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\t[...this.sprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn items;\n\t}\n\n\topenEpicEditForm(epicId)\n\t{\n\t\tthis.epic.openEditForm(epicId);\n\t}\n\n\topenEpicViewForm(epicId)\n\t{\n\t\tthis.epic.openViewForm(epicId);\n\t}\n\n\tremoveEpic(epicId)\n\t{\n\t\tthis.requestSender.removeItem({\n\t\t\titemId: epicId,\n\t\t\titemType: 'epic'\n\t\t}).then((response) => {\n\t\t\tconst epicInfo = response.data;\n\t\t\tthis.getAllItems().forEach((item) => {\n\t\t\t\tconst itemEpic = item.getEpic();\n\t\t\t\tif (itemEpic && itemEpic.name === epicInfo.name)\n\t\t\t\t{\n\t\t\t\t\titem.setEpicAndTags(null);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.tagSearcher.removeEpicFromSearcher(epicInfo);\n\t\t\tthis.sidePanel.reloadTopSidePanel();\n\t\t});\n\t}\n\n\tfadeOutAll()\n\t{\n\t\tthis.backlog.fadeOut();\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tsprint.fadeOut();\n\t\t});\n\t}\n\n\tfadeInAll()\n\t{\n\t\tthis.backlog.fadeIn();\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tsprint.fadeIn();\n\t\t});\n\t}\n\n\tremoveItemFromEntities(item: Item)\n\t{\n\t\tthis.backlog.removeItem(item);\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tsprint.removeItem(item);\n\t\t});\n\t\titem.removeYourself();\n\t}\n\n\tcreateTaskItemByItemData(itemData: Object): Item\n\t{\n\t\treturn new Item({\n\t\t\titemId: itemData.itemId,\n\t\t\titemType: itemData.itemType,\n\t\t\tname: itemData.name,\n\t\t\tentityId: itemData.entityId,\n\t\t\tentityType: itemData.entityType,\n\t\t\tparentId: itemData.parentId,\n\t\t\tsort: itemData.sort,\n\t\t\tstoryPoints: itemData.storyPoints,\n\t\t\tsourceId: itemData.sourceId,\n\t\t\tcompleted: itemData.completed,\n\t\t\tresponsible: itemData.responsible,\n\t\t\tattachedFilesCount: itemData.attachedFilesCount,\n\t\t\tcheckListComplete: itemData.checkListComplete,\n\t\t\tcheckListAll: itemData.checkListAll,\n\t\t\tnewCommentsCount: itemData.newCommentsCount,\n\t\t\tepic: itemData.epic,\n\t\t\ttags: itemData.tags\n\t\t});\n\t}\n\n\tappendNewItemToEntity(newItem: Item)\n\t{\n\t\tconst entity = this.findEntityByEntityId(newItem.getEntityId());\n\t\tDom.append(newItem.render(), entity.getListItemsNode());\n\t\tentity.setItem(newItem);\n\t\tnewItem.onAfterAppend(entity.getListItemsNode());\n\t}\n}"],"names":["RequestSender","options","signedParameters","debugMode","data","action","Promise","resolve","reject","ajax","runComponentAction","mode","then","sendRequest","ActionsHeader","entity","setEventNamespace","headerId","getEntityType","getId","nodeId","getAddEpicActionNode","Tag","render","Loc","getMessage","getGroupActions","Dom","remove","node","isDisabled","document","getElementById","addEpicNode","querySelector","Event","bind","emit","EventEmitter","ActionsPanel","actionPanelNodeId","bindElement","itemList","task","activity","attachment","move","sprint","backlog","tags","epic","decomposition","listBlockBlurNodes","Set","actionsPanelContainer","createActionPanel","setBlockBlurNode","position","getPosition","style","top","left","width","append","body","customBlur","event","hasNode","forEach","blockBlurNode","contains","target","unbind","bindItems","actionsPanel","hasClass","lastElementChild","add","Boolean","showTaskActionButtonNodeId","showAttachmentActionButtonNodeId","showMoveActionButtonNodeId","sprintActionButtonNodeId","backlogActionButtonNodeId","tagsActionButtonNodeId","epicActionButtonNodeId","decompositionActionButtonNodeId","removeActionButtonNodeId","callback","DiskManager","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","attachedIds","controlId","Text","getRandom","popup","Popup","content","getAttachmentsLoaderContent","autoHide","closeByEsc","angle","show","BX","Disk","UF","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","subscribe","close","filesChooser","addCustomEvent","onFileUploadSuccess","fileResult","uf","file","uploaderFile","push","element_id","toString","TaskCounts","itemId","attachedFilesCount","parseInt","checkListComplete","checkListAll","newCommentsCount","indicatorsNodeId","indicatorsNode","attachmentNode","checklistNode","commentsNode","updateVisibility","firstElementChild","textContent","innerCommentCounter","showNode","hideNode","Item","item","itemNode","itemType","name","responsible","entityId","entityType","parentId","sort","storyPoints","Type","isUndefined","sourceId","parentSourceId","taskCounts","completed","isPlainObject","isArray","status","disableStatus","value","moveActivity","decompositionMode","addClass","removeClass","dragnDropNode","encode","createIndicators","getTagsContainer","getContrastYIQ","hexcolor","Label","Color","DEFAULT","replace","r","substr","g","b","yiq","epicLabel","text","color","size","Size","SM","customClass","container","getContainer","innerLabel","contrast","info","map","tag","tagLabel","TAG_LIGHT","fill","length","getEpicTag","getListTagNodes","nameNode","onNameClick","tagsNode","onTagsClick","responsibleNode","onResponsibleClick","storyPointsNode","onStoryPointsClick","nameTextNode","setDisableStatus","updateResponsible","onAfterAppend","targetNode","contentEditable","showActionsPanel","currentTarget","borderNode","valueNode","trim","oldValue","toggleClass","placeCursorAtEnd","blockEnterInput","bindOnce","newValue","selector","Tasks","Integration","Socialnetwork","NetworkSelector","scope","id","query","useSearch","useAdd","parent","popupOffsetLeft","bindEvent","nameFormatted","photo","src","avatar","open","isComposing","keyCode","blur","isShown","stopPropagation","destroy","diskManager","ufDiskFilesFieldName","subscribeOnce","baseEvent","getData","showAttachmentMenu","MessageBox","confirm","messageBox","showPanel","isInteger","dataset","updateTagsContainer","newContainer","tagsContainerNode","display","attr","focus","selection","window","getSelection","range","createRange","selectNodeContents","collapse","removeAllRanges","addRange","updateIndicators","TagSearcher","requestSender","allTags","Map","tagName","set","tabs","title","epicName","get","delete","values","tagsList","epicList","getCurrentActionsPanel","currentTags","getTags","requestData","selectedItems","createTag","tagDialog","getTagSelector","getTextBoxValue","focusSearch","addTagToSearcher","newTag","getTagFromSearcher","addItem","select","clearTextBox","selectFirstTab","label","Dialog","height","multiple","dropdownMode","enableSearch","items","getTagsList","events","selectedItem","taskId","getSourceId","attachTagToTask","response","setEpicAndTags","getEpic","catch","deselectedItem","deAttachTagToTask","splice","indexOf","tagSelectorOptions","onInput","dialog","getDialog","footer","currentEpic","getEpicList","getItemId","epicId","attachEpicToItem","setParentId","deAttachEpicToItem","placeholder","inputObject","enteredHashTagName","input","getInputNode","tagsDialog","getNodeId","getNode","offsetWidth","selectedHashTag","hashTags","getHashTagsFromText","enteredHashTag","pop","RegExp","deselect","setTagsSearchMode","search","hide","enteredHashEpicName","epicDialog","selectedHashEpic","setEpicId","setEpicSearchMode","inputText","regex","matches","match","exec","Input","setNode","onTagSearch","onEpicSearch","onKeydown","inputNode","enteredHashTags","getHashTagNamesFromText","isTagsSearchMode","enteredHashEpics","getHashEpicNamesFromText","isEpicSearchMode","onCreateTaskItem","Entity","entityData","listItemsNode","setStoryPoints","actionsHeader","newItem","subscribeToItem","updateStoryPoints","getStoryPoints","setItemMoveActivity","setMoveActivity","has","unsubscribeAll","isCompleted","getTarget","String","button","removeItem","removeYourself","inputStoryPoints","increment","parseFloat","currentStoryPoints","isFloat","toFixed","getListItemsNode","getItemNode","hasInput","nextElementSibling","isEqualNode","classList","Backlog","backlogData","itemData","createBacklog","actions","createBacklogTitle","headerNodeId","createBacklogItems","backlogItemsNodeId","createActionsHeader","headerNode","listEpicNode","SprintStats","dateEnd","getDateEnd","completedStoryPoints","getCompletedStoryPoints","kanbanMode","activeStatsNode","activeStatsNodeId","createCompletedStatsInfo","isActive","isExpired","createExpiredStatsInfo","createActiveStatsInfo","activeStatsClasses","createActiveStatsNode","getRemainingDays","getPercentageCompletedStoryPoints","date","format","expiredStatsNodeId","statsClass","newActiveStatsNode","percentage","Math","round","Date","remainingDays","percentageCompletedStoryPoints","SprintDate","defaultSprintDuration","getDefaultSprintDuration","startTimestamp","endTimestamp","dateStart","timestamp","dateStartNode","dateEndNode","parentPopup","closest","calendar","showCalendar","field","bTime","bSetFocus","bHideTime","updateDateNode","floor","parseDate","getTime","dateStartInput","dateEndInput","sprintId","weekCount","SprintHeader","sprintStats","sprintDate","headerClass","buttonClass","buttonText","buttonNode","isPlanned","className","firstChild","replaceWith","dragndropNode","removeNode","tickAngleClass","getName","createStats","createDate","getDateStart","createButton","updateDateStartNode","updateDateEndNode","buttonNodeId","onButtonClick","editButtonNode","tickButtonNode","toggle","Sprint","sprintData","isNumber","unCompletedStoryPoints","completedTasks","unCompletedTasks","sprintHeader","initStyle","now","getStartEventsButton","getTotalPoints","storyPointsNodeId","getInWorkPoints","getDonePoints","createEvents","createItems","itemsNodeId","createHeader","contentNode","showContent","onChangeName","onRemoveSprint","onChangeSprintDeadline","toggleVisibilityContent","createInput","setSelectionRange","hasOwnProperty","hideContent","SprintPopup","sprints","popupId","moveSelectId","moveSprintsBlockId","moveSprintSelectId","getPopupContent","moveSprint","listSprintsOptions","getTasksCountLabel","getCompletedTasks","getUnCompletedTasks","getUnCompletedStoryPoints","offsetTop","offsetLeft","closeIcon","draggable","resizable","lightShadow","cacheable","titleBar","buttons","Button","SUCCESS","click","moveSelect","moveSprintSelect","direction","targetSprint","LINK","count","Kanban","activeSprintData","finishStatus","itemsInFinishStage","initDomNodes","createSprintStats","bindHandlers","sprintStatsContainer","completeSprintButtonNode","setKanbanMode","onCompleteSprint","onKanbanRender","onItemMoved","sprintPopup","showCompletePopup","completeSprint","location","href","url","kanbanGrid","getItems","Object","prototype","call","getColumn","getType","targetColumn","beforeItem","type","updateStatsAfterMovedToFinish","updateStatsAfterMovedFromFinish","updateActiveStats","setCompletedStoryPoints","setUnCompletedStoryPoints","setCompletedTasks","setUnCompletedTasks","SidePanel","sidePanelManager","Instance","bindEvents","sidePanel","getSlider","setCacheable","popupWindow","topSlider","getTopSlider","topSidePanelZIndex","getZindex","popupWindowZIndex","zIndex","getPopupContainer","currentSidePanel","getPreviousSlider","reload","previousSidePanel","contentCallback","Epic","form","defaultColor","selectedColor","sidePanelId","onLoadAddForm","openSidePanel","buildAddForm","onLoadEditForm","buildEditForm","onLoadViewForm","buildViewForm","onBeforeGridRequest","onLoadListGrid","destroyGrid","onLoadEditor","onLoadColorPicker","onLoadAddButtons","buttonsContainer","createEpic","getRequestData","isPreviousSidePanelExist","reloadPreviousSidePanel","openEpicsList","alert","errors","shift","message","onLoadDescription","onLoadFiles","onLoadViewButtons","openEditForm","onLoadEditButtons","editEpic","reloadGrid","Main","gridManager","getById","gridId","instance","getDescriptionEditor","editorHtml","descriptionContainer","Runtime","html","editor","LHEPostForm","getHandler","BXHtmlEditor","Get","eventNode","setTimeout","getEpicDescription","description","filesContainer","getEpicFiles","colorBlockNode","colorNode","picker","getColorPicker","getAddEpicFormButtons","buttonsHtml","getViewEpicFormButtons","list","getEpicsList","responseData","openAddForm","getEmptyEpicListForm","getCompatData","eventArgs","sessid","bitrix_sessid","method","getEpicListUrl","getSignedParameters","buildFormHeader","buildFormContainerHeader","editorId","getEpicDescriptionEditor","getViewEpicFormButtonsAction","ColorPicker","onColorSelected","backgroundColor","popupOptions","oEditor","GetContent","files","getAttachmentsFiles","arFiles","controllers","fileControllers","controller","includes","fileController","keys","fileId","Decomposition","setPlaceholder","addDecomposedItem","insertAfter","onCreateItem","deactivateDecompositionMode","activateDecompositionMode","clear","Filter","filterId","scrumManager","initUiFilterManager","filterManager","onApplyFilter","filterInstance","promise","params","fadeOutAll","autoResolve","applyFilter","filteredItemsData","getAllItems","removeItemFromEntities","appendNewItemToEntity","createTaskItemByItemData","fulfill","fadeInAll","Scrum","pathToTask","activeSprintId","activeTab","kanban","tagSearcher","addEpicToSearcher","filter","isDomNode","Error","scrumContainer","renderSprintsContainer","sprintCreatingButtonNode","sprintCreatingButtonNodeId","sprintCreatingDropZoneNode","sprintCreatingDropZoneNodeId","sprintListNode","sprintListNodeId","createSprint","setDraggable","itemContainers","draggableItems","Draggable","dragElement","DROP_PREVIEW","dragEndEvent","onItemMove","draggableSprints","onSprintMove","newSprint","createTaskItem","inputValue","createItem","setParentEntity","setSort","appendItem","getEpicId","sendRequestToCreateTask","fillItemAfterCreation","setItem","onUpdateItem","updateItem","onShowTask","openSidePanelByUrl","onMoveItem","moveItem","onMoveToSprint","moveToSprint","onMoveToBacklog","moveToBacklog","onAttachFilesToTask","attachFilesToTask","onRemoveItem","getItemType","sortInfo","calculateSort","onStartSprint","showStartSprintPopup","onChangeTaskResponsible","changeTaskResponsible","gerResponsible","removeSprint","calculateSprintSort","onChangeSprintName","changeSprintName","changeSprintDeadline","onOpenAddEpicForm","onOpenListEpicGrid","innerBaseEvent","updatedEpicInfo","oldEpicInfo","getCurrentEpic","itemEpic","removeEpicFromSearcher","onShowTagSearcher","actionsPanelButton","showTagsDialog","onShowEpicSearcher","showEpicDialog","onStartDecomposition","parentItem","onTagsSearchOpen","onTagsSearchClose","decomposedItems","getDecomposedItems","lastDecomposedItem","Array","from","getParentId","setParentSourceId","getSort","setTags","decomposeItem","showTagsSearchDialog","closeTagsSearchDialog","onEpicSearchOpen","showEpicSearchDialog","onEpicSearchClose","closeEpicSearchDialog","subscribeToSprint","createCreatingButton","createCreatingDropZone","createSprintsList","countSprints","children","insertBefore","getSprintNode","scrollIntoView","addContainer","valueWithoutTags","entityListNode","bindItemNode","appendItemAfterItem","getEntityId","getParentSourceId","createTask","setItemId","setResponsible","setSourceId","getAvailableSprintsToMove","showMoveToSprintMenu","moveToNewSprint","moveTo","parentNode","entityFrom","entityTo","after","moveItemFromEntityToEntity","fromActiveSprint","toActiveSprint","moveToSprintMenu","getPopupWindow","setBindElement","Menu","addMenuItem","onclick","menuItem","getMenuWindow","listSortInfo","querySelectorAll","findItemByItemId","sprintNode","findEntityByEntityId","sprintSort","newNode","parentElement","startSprint","setStatus","PRIMARY","endContainer","sourceContainer","createNewSprintAndMoveItem","source","sourceEntityId","endEntityId","moveInCurrentContainer","updateItemSort","moveInAnotherContainer","sourceEntity","endEntity","updateSprintSort","backlogItems","find","findEntityByItemId","listToMove","isFirstItem","moveItemToUp","isLastItem","moveItemToDown","showMoveItemMenu","moveItemMenu","entityWithInput","openViewForm","epicInfo","reloadTopSidePanel","fadeOut","fadeIn"],"mappings":"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"}