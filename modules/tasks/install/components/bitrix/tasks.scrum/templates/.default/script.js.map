{"version":3,"file":"script.js","sources":["src/utility/request.sender.js","src/service/filter.js","src/utility/counters.js","src/view/view.js","src/service/disk.manager.js","src/item/task/actions.panel.js","src/item/task/taskcounts.js","src/utility/story.points.js","src/item/item.js","src/entity/group.actions.button.js","src/entity/list.items.js","src/utility/tag.searcher.js","src/utility/input.js","src/entity/entity.js","src/entity/backlog/header.js","src/entity/backlog/epic.creation.button.js","src/entity/backlog/backlog.js","src/entity/sprint/sprint.date.js","src/utility/stats.calculator.js","src/entity/sprint/stats.header.js","src/entity/sprint/completed.stats.header.js","src/entity/sprint/expired.stats.header.js","src/entity/sprint/active.stats.header.js","src/entity/sprint/stats.header.builder.js","src/entity/sprint/sprint.header.js","src/entity/sprint/events.header.js","src/entity/sprint/story.points.header.js","src/entity/sprint/sprint.js","src/service/side.panel.js","src/utility/burn.down.chart.js","src/entity/sprint/sprint.side.panel.js","src/utility/entity.storage.js","src/utility/item.style.designer.js","src/utility/dom.builder.js","src/utility/subtasks.manager.js","src/item/task/decomposition.js","src/utility/filter.handler.js","src/utility/epic.js","src/utility/team.speed.chart.js","src/utility/project.side.panel.js","src/utility/pull.sprint.js","src/utility/item.mover.js","src/utility/pull.item.js","src/utility/pull.epic.js","src/utility/sprint.mover.js","src/view/plan.js","src/view/active.sprint.js","src/view/completed.sprint.js","src/entry.js"],"sourcesContent":["import {ajax, Loc, Type} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tconstructor(options = {})\n\t{\n\t\tthis.signedParameters = (options.signedParameters ? options.signedParameters : '');\n\t\tthis.debugMode = options.debugMode;\n\t}\n\n\tgetSignedParameters(): string\n\t{\n\t\treturn this.signedParameters;\n\t}\n\n\tsendRequest(action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(action, {\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tsendRequestToComponent(data = {}, action): Promise\n\t{\n\t\tdata.debugMode = this.debugMode;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runComponentAction('bitrix:tasks.scrum', action, {\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tbatchUpdateItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchUpdateItem');\n\t}\n\n\tbatchRemoveItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchRemoveItem');\n\t}\n\n\tupdateItemSort(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItemSort');\n\t}\n\n\tupdateSprintSort(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateSprintSort');\n\t}\n\n\tcreateSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createSprint');\n\t}\n\n\tstartSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'startSprint');\n\t}\n\n\tcompleteSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'completeSprint');\n\t}\n\n\tcreateTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createTask');\n\t}\n\n\tupdateItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItem');\n\t}\n\n\tremoveItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeItem');\n\t}\n\n\tchangeTaskResponsible(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeTaskResponsible');\n\t}\n\n\tgetCurrentState(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getCurrentState');\n\t}\n\n\tremoveSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeSprint');\n\t}\n\n\tchangeSprintName(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeSprintName');\n\t}\n\n\tchangeSprintDeadline(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeSprintDeadline');\n\t}\n\n\tgetSprintCompletedItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintCompletedItems');\n\t}\n\n\tgetEpicDescriptionEditor(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicDescriptionEditor');\n\t}\n\n\tgetEpicDescription(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicDescription');\n\t}\n\n\tgetEpicFiles(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicFiles');\n\t}\n\n\tgetAddEpicFormButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getAddEpicFormButtons');\n\t}\n\n\tgetViewEpicFormButtonsAction(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getViewEpicFormButtons');\n\t}\n\n\tcreateEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createEpic');\n\t}\n\n\tgetEpicsList(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpicsList');\n\t}\n\n\tgetEpicListUrl(): string\n\t{\n\t\treturn '/bitrix/services/main/ajax.php?mode=class&c=bitrix:tasks.scrum&action=getEpicsList';\n\t}\n\n\tattachFilesToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'attachFilesToTask');\n\t}\n\n\tattachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'attachTagToTask');\n\t}\n\n\tbatchAttachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchAttachTagToTask');\n\t}\n\n\tdeAttachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'deAttachTagToTask');\n\t}\n\n\tbatchDeattachTagToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchDeattachTagToTask');\n\t}\n\n\tupdateItemEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItemEpic');\n\t}\n\n\tbatchUpdateItemEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'batchUpdateItemEpic');\n\t}\n\n\tgetEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEpic');\n\t}\n\n\teditEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'editEpic');\n\t}\n\n\tremoveEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeEpic');\n\t}\n\n\tapplyFilter(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'applyFilter');\n\t}\n\n\tgetSprintStartButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintStartButtons');\n\t}\n\n\tgetSprintCompleteButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintCompleteButtons');\n\t}\n\n\tgetBurnDownChartData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getBurnDownChartData');\n\t}\n\n\tgetTeamSpeedChartData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getTeamSpeedChartData');\n\t}\n\n\tgetDodPanelData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getDodPanelData');\n\t}\n\n\tgetDodComponent(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getDodComponent');\n\t}\n\n\tgetDodButtons(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getDodButtons');\n\t}\n\n\tsaveDod(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'saveDod');\n\t}\n\n\treadAllTasksComment(data): Promise\n\t{\n\t\treturn this.sendRequest('tasks.task.comment.readAll', data);\n\t}\n\n\tupdateBorderColorToLinkedItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateBorderColorToLinkedItems');\n\t}\n\n\tgetAllUsedItemBorderColors(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getAllUsedItemBorderColors');\n\t}\n\n\tgetSubTaskItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSubTaskItems');\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\tconsole.log(response);\n\t\t\treturn;\n\t\t}\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}","import {Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {RequestSender} from '../utility/request.sender';\n\ntype ListTypeItem = {\n\tNAME: string,\n\tVALUE: string\n}\n\ntype ValueTypeField = {\n\tname: string,\n\tvalue: string\n}\n\ntype Params = {\n\tfilterId: string,\n\trequestSender?: RequestSender\n}\n\nexport class Filter extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Filter');\n\n\t\tthis.filterId = params.filterId;\n\t\tthis.requestSender = params.requestSender;\n\n\t\tthis.searchFieldApplied = false;\n\n\t\tthis.initUiFilterManager();\n\t\tthis.bindHandlers();\n\t}\n\n\tinitUiFilterManager()\n\t{\n\t\t/* eslint-disable */\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\t\t/* eslint-enable */\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onApplyFilter.bind(this));\n\t}\n\n\tisSearchFieldApplied(): boolean\n\t{\n\t\treturn this.searchFieldApplied;\n\t}\n\n\tgetSearchContainer(): HTMLElement\n\t{\n\t\treturn this.filterManager.getSearch().getContainer();\n\t}\n\n\tscrollToSearchContainer()\n\t{\n\t\tconst filterSearchContainer = this.getSearchContainer();\n\t\tif (!this.isNodeInViewport(filterSearchContainer))\n\t\t{\n\t\t\tfilterSearchContainer.scrollIntoView(true);\n\t\t}\n\t}\n\n\tonApplyFilter(event: BaseEvent)\n\t{\n\t\tconst [filterId, values, filterInstance, promise, params] = event.getCompatData();\n\n\t\tif (filterInstance.getSearch().getSearchString())\n\t\t{\n\t\t\tthis.searchFieldApplied = true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.searchFieldApplied = false;\n\t\t}\n\n\t\tif (this.filterId !== filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams.autoResolve = false;\n\n\t\tthis.emit('applyFilter', {\n\t\t\tpromise: promise\n\t\t});\n\t}\n\n\taddItemToListTypeField(name: string, item: ListTypeItem)\n\t{\n\t\t//todo set item to list after epic crud actions\n\n\t\tconst fieldInstances = this.filterManager.getField(name);\n\t\tconst fieldOptions = this.filterManager.getFieldByName(name);\n\n\t\tif (!fieldInstances || !fieldOptions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfieldInstances.options.ITEMS.push(item);\n\t\tfieldOptions.ITEMS.push(item);\n\n\t\tconst itemsNode = fieldInstances.node.querySelector('[data-name='+name+']');\n\n\t\tconst items = Dom.attr(itemsNode, 'data-items');\n\t\titems.push(item);\n\t\tDom.attr(itemsNode, 'data-items', items);\n\t}\n\n\tsetValueToField(value: ValueTypeField)\n\t{\n\t\tconst filterApi = this.filterManager.getApi();\n\t\tconst filterFieldsValues = this.filterManager.getFilterFieldsValues();\n\n\t\tfilterFieldsValues[value.name] = value.value;\n\n\t\tfilterApi.setFields(filterFieldsValues);\n\t\tfilterApi.apply();\n\t}\n\n\tsetValuesToField(values: ValueTypeField[], resetFields = false)\n\t{\n\t\tconst filterApi = this.filterManager.getApi();\n\n\t\tlet filterFieldsValues = {};\n\t\tif (!resetFields)\n\t\t{\n\t\t\tfilterFieldsValues = this.filterManager.getFilterFieldsValues();\n\t\t}\n\n\t\tvalues.forEach((value) => {\n\t\t\tfilterFieldsValues[value.name] = value.value;\n\t\t});\n\n\t\tfilterApi.setFields(filterFieldsValues);\n\t\tfilterApi.apply();\n\t}\n\n\tgetValueFromField(value: ValueTypeField): string\n\t{\n\t\tconst filterFieldsValues = this.filterManager.getFilterFieldsValues();\n\t\treturn filterFieldsValues[value.name];\n\t}\n\n\tresetFilter()\n\t{\n\t\tthis.filterManager.resetFilter();\n\t}\n\n\tapplyFilter()\n\t{\n\t\tthis.filterManager.applyFilter();\n\t}\n\n\tisNodeInViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\t\treturn (\n\t\t\trect.top >= 0 &&\n\t\t\trect.left >= 0 &&\n\t\t\trect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n\t\t\trect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t);\n\t}\n}","import {Dom, Event, Loc, Tag, Type} from 'main.core';\n\nimport {RequestSender} from './request.sender';\nimport {Filter} from '../service/filter';\n\nimport '../css/counters.css';\n\nexport type CountersData = {\n\ttotal: {\n\t\tcounter: number,\n\t\tcode: number\n\t},\n\texpired: {\n\t\tcounter: number,\n\t\tcode: number\n\t},\n\tnew_comments: {\n\t\tcounter: number,\n\t\tcode: number\n\t}\n}\n\ntype Params = {\n\trequestSender: RequestSender,\n\tfilter: Filter,\n\tcounters: ?CountersData,\n\tisOwnerCurrentUser: boolean,\n\tuserId: number,\n\tgroupId: number\n}\n\nexport class Counters\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.filter = params.filter;\n\t\tthis.counters = (params.counters ? params.counters : null);\n\t\tthis.isOwnerCurrentUser = params.isOwnerCurrentUser;\n\t\tthis.userId = params.userId;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.container = null;\n\t\tthis.node = null;\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Counters: HTMLElement for Counters not found');\n\t\t}\n\n\t\tthis.container = container;\n\n\t\tif (!this.isEmptyCounters())\n\t\t{\n\t\t\tDom.append(this.renderCounters(), this.container);\n\t\t}\n\t}\n\n\tupdateState(counters: ?CountersData)\n\t{\n\t\tthis.counters = counters;\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.destroy();\n\t\t\tif (!this.isEmptyCounters())\n\t\t\t{\n\t\t\t\tDom.append(this.renderCounters(), this.container);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!this.isEmptyCounters())\n\t\t\t{\n\t\t\t\tDom.append(this.renderCounters(), this.container);\n\t\t\t}\n\t\t}\n\t}\n\n\trenderTitle(): HTMLElement\n\t{\n\t\tconst className = this.isEmptyCounters() ? 'tasks-page-name' : 'tasks-counter-page-name';\n\t\tconst text = (\n\t\t\tthis.isOwnerCurrentUser\n\t\t\t\t? Loc.getMessage('TASKS_SCRUM_COUNTER_TOTAL')\n\t\t\t\t: Loc.getMessage('TASKS_SCRUM_COUNTER_TOTAL_EMPL')\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<span class=\"${className}\">${text}</span>\n\t\t`;\n\t}\n\n\trenderCounters(): HTMLElement\n\t{\n\t\tconst newCommentsInfo = this.counters['new_comments'];\n\t\tconst commentsNumber = parseInt(newCommentsInfo.counter, 10);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-counter-container\">\n\t\t\t\t${this.renderTitle()}\n\t\t\t\t<span class=\"tasks-counter-counters\">\n\t\t\t\t\t<span class=\"tasks-comment-icon ui-counter ui-counter-success\">\n\t\t\t\t\t\t<span class=\"ui-counter-inner\">${commentsNumber}</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"tasks-comment-text\">${this.getCommentsLabel(commentsNumber)}</span>\n\t\t\t\t</span>\n\t\t\t\t${this.renderReadAllButton()}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst commentIcon = this.node.querySelector('.tasks-comment-icon');\n\t\tconst commentText = this.node.querySelector('.tasks-comment-text');\n\n\t\tconst onMouseEnter = () => Dom.addClass(commentText, 'tasks-comment-text-hover');\n\t\tconst onMouseLeave = () => Dom.removeClass(commentText, 'tasks-comment-text-hover');\n\n\t\tEvent.bind(commentIcon, 'mouseenter', onMouseEnter);\n\t\tEvent.bind(commentIcon, 'mouseleave', onMouseLeave);\n\t\tEvent.bind(commentText, 'mouseenter', onMouseEnter);\n\t\tEvent.bind(commentText, 'mouseleave', onMouseLeave);\n\n\t\tEvent.bind(commentIcon, 'click', this.applyFilterRequiringAttentionToComments.bind(this));\n\t\tEvent.bind(commentText, 'click', this.applyFilterRequiringAttentionToComments.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\trenderReadAllButton(): HTMLElement\n\t{\n\t\tconst title = Loc.getMessage('TASKS_SCRUM_NEW_COMMENTS_READ_ALL_TITLE');\n\n\t\tconst readAllButton = Tag.render`\n\t\t\t<span class=\"tasks-counter-counter-button\">\n\t\t\t\t<span class=\"tasks-counter-counter-button-icon\"></span>\n\t\t\t\t<span class=\"tasks-counter-counter-button-text\">${title}</span>\n\t\t\t</span>\n\t\t`;\n\n\t\tEvent.bind(readAllButton, 'click', this.onClickReadAll.bind(this));\n\n\t\treturn readAllButton;\n\t}\n\n\tisEmptyCounters(): boolean\n\t{\n\t\treturn !(this.counters && this.counters['new_comments'].counter > 0);\n\t}\n\n\tonClickReadAll()\n\t{\n\t\tthis.requestSender.readAllTasksComment({\n\t\t\tgroupId: this.groupId,\n\t\t\tuserId: this.userId\n\t\t}).then((response) => {\n\t\t\tDom.clean(this.container);\n\t\t\tthis.filter.applyFilter();\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tisNodeCreated(): boolean\n\t{\n\t\treturn (this.node !== null);\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t}\n\n\tgetCommentsLabel(count: number): string\n\t{\n\t\tif (count > 5)\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_COUNTER_NEW_COMMENTS_PLURAL_2');\n\t\t}\n\t\telse if (count === 1)\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_COUNTER_NEW_COMMENTS_PLURAL_0');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_COUNTER_NEW_COMMENTS_PLURAL_1');\n\t\t}\n\t}\n\n\tapplyFilterRequiringAttentionToComments()\n\t{\n\t\tthis.filter.setValuesToField([\n\t\t\t{\n\t\t\t\tname: 'COUNTER_TYPE',\n\t\t\t\tvalue: 'TASKS_COUNTER_TYPE_12582912'\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'PROBLEM',\n\t\t\t\tvalue: '12582912'\n\t\t\t},\n\t\t], true);\n\t}\n}","import {Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Filter} from '../service/filter';\n\nimport {RequestSender} from '../utility/request.sender';\nimport {Counters} from '../utility/counters';\n\nimport type {CountersData} from '../utility/counters';\n\nexport type ViewInfo = {\n\tname: string,\n\turl: string,\n\tactive: boolean\n}\n\nexport type Views = {\n\tplan: ViewInfo,\n\tactiveSprint: ViewInfo,\n\tcompletedSprint: ViewInfo\n}\n\ntype Params = {\n\tsignedParameters: string,\n\tdebugMode: string,\n\tisOwnerCurrentUser: 'Y' | 'N',\n\tuserId: number,\n\tgroupId: number,\n\tcounters?: ?CountersData,\n\tfilterId: string\n}\n\nexport class View extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.View');\n\n\t\tthis.isOwnerCurrentUser = (params.isOwnerCurrentUser === 'Y');\n\n\t\tthis.requestSender = new RequestSender({\n\t\t\tsignedParameters: params.signedParameters,\n\t\t\tdebugMode: params.debugMode\n\t\t});\n\n\t\tthis.filter = new Filter({\n\t\t\tfilterId: params.filterId,\n\t\t\tscrumManager: this,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\n\t\tthis.counters = new Counters({\n\t\t\trequestSender: this.requestSender,\n\t\t\tfilter: this.filter,\n\t\t\tcounters: params.counters,\n\t\t\tuserId: params.userId,\n\t\t\tgroupId: params.groupId,\n\t\t\tisOwnerCurrentUser: params.isOwnerCurrentUser\n\t\t});\n\n\t\tthis.userId = parseInt(params.userId, 10);\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for scrum not found');\n\t\t}\n\t}\n\n\trenderCountersTo(container: HTMLElement)\n\t{\n\t\tthis.counters.renderTo(container);\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn this.userId;\n\t}\n}","import {Loc, Tag, Text} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\n\nimport '../css/disk.manager.css';\n\nexport class DiskManager extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DiskManager');\n\n\t\tthis.diskUrls = {\n\t\t\turlSelect: '/bitrix/tools/disk/uf.php?action=selectFile&SITE_ID=' + Loc.getMessage('SITE_ID'),\n\t\t\turlRenameFile: '/bitrix/tools/disk/uf.php?action=renameFile',\n\t\t\turlDeleteFile: '/bitrix/tools/disk/uf.php?action=deleteFile',\n\t\t\turlUpload: '/bitrix/tools/disk/uf.php?action=uploadFile&ncc=1'\n\t\t};\n\n\t\tthis.attachedIds = [];\n\t}\n\n\tshowAttachmentMenu(node)\n\t{\n\t\tconst controlId = Text.getRandom();\n\n\t\tthis.popup = new Popup(\n\t\t\t`disk-manager-attachment-menu-${Text.getRandom()}`,\n\t\t\tnode,\n\t\t\t{\n\t\t\t\tcontent: this.getAttachmentsLoaderContent(controlId),\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: false,\n\t\t\t});\n\n\t\tthis.popup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: controlId,\n\t\t\tcontrolName: `[${controlId}][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect: this.diskUrls.urlSelect,\n\t\t\turlRenameFile: this.diskUrls.urlRenameFile,\n\t\t\turlDeleteFile: this.diskUrls.urlDeleteFile,\n\t\t\turlUpload: this.diskUrls.urlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.popup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show']\n\t\t);\n\n\t\tEventEmitter.subscribe('onFinish', () => {\n\t\t\tthis.popup.close();\n\t\t\tthis.emit('onFinish', this.attachedIds);\n\t\t});\n\t}\n\n\tgetAttachmentsLoaderContent(controlId)\n\t{\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t<div id=\"diskuf-selectdialog-${controlId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t<div class=\"diskuf-files-block\">\n\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t<input type=\"hidden\" name=\"[${controlId}][]\" value=\"\"/>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<label for=\"file_loader_${controlId}\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${controlId}\" type=\n\t\t\t\t\t\t\t\"file\" multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.onFileUploadSuccess.bind(this));\n\t\t//todo show loader\n\n\t\treturn filesChooser;\n\t}\n\n\tonFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.attachedIds.push(fileResult.element_id.toString());\n\t}\n}","import {Dom, Event, Loc, Tag} from 'main.core';\n\nimport '../../css/actions-panel.css';\n\nexport class ActionsPanel\n{\n\tconstructor(options)\n\t{\n\t\tthis.actionPanelNodeId = 'tasks-scrum-actions-panel';\n\n\t\tthis.bindElement = options.bindElement;\n\n\t\tthis.itemList = {...{\n\t\t\ttask: {activity: false},\n\t\t\tattachment: {activity: false},\n\t\t\tmove: {activity: false},\n\t\t\tsprint: {activity: false},\n\t\t\tbacklog: {activity: false},\n\t\t\ttags: {activity: false},\n\t\t\tepic: {activity: false},\n\t\t\tdecomposition: {activity: false},\n\t\t\tremove: {activity: false},\n\t\t}, ...options.itemList};\n\n\t\tthis.listBlockBlurNodes = new Set();\n\t}\n\n\tshowPanel()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\n\t\tconst actionsPanelContainer = this.calculatePanelPosition(this.createActionPanel());\n\n\t\tthis.setBlockBlurNode(actionsPanelContainer);\n\n\t\tDom.append(actionsPanelContainer, document.body);\n\n\t\tconst customBlur = (event) => {\n\t\t\tlet hasNode = false;\n\t\t\tthis.listBlockBlurNodes.forEach((blockBlurNode) => {\n\t\t\t\tif (blockBlurNode.contains(event.target))\n\t\t\t\t{\n\t\t\t\t\thasNode = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!hasNode)\n\t\t\t{\n\t\t\t\tDom.remove(actionsPanelContainer);\n\t\t\t\tEvent.unbind(document, 'click', customBlur);\n\t\t\t}\n\t\t};\n\t\tEvent.bind(document, 'click', customBlur);\n\n\t\tthis.bindItems();\n\n\t\tconst actionsPanel =  actionsPanelContainer.querySelector('.tasks-scrum-actions-panel');\n\t\tif (Dom.hasClass(actionsPanel.lastElementChild, 'tasks-scrum-actions-panel-separator'))\n\t\t{\n\t\t\tDom.remove(actionsPanel.lastElementChild);\n\t\t}\n\t}\n\n\tsetBlockBlurNode(node)\n\t{\n\t\tthis.listBlockBlurNodes.add(node);\n\t}\n\n\tisShown(): Boolean\n\t{\n\t\treturn Boolean(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tcreateActionPanel()\n\t{\n\t\tlet task = '';\n\t\tlet attachment = '';\n\t\tlet move = '';\n\t\tlet sprint = '';\n\t\tlet backlog = '';\n\t\tlet tags = '';\n\t\tlet epic = '';\n\t\tlet decomposition = '';\n\t\tlet remove = '';\n\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tthis.showTaskActionButtonNodeId = 'tasks-scrum-actions-panel-btn-task';\n\t\t\ttask = Tag.render`\n\t\t\t\t<div id=\"${this.showTaskActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-task\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TASK')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tthis.showAttachmentActionButtonNodeId = 'tasks-scrum-actions-panel-btn-attachment';\n\t\t\tattachment = Tag.render`\n\t\t\t\t<div id=\"${this.showAttachmentActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-attachment\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tthis.showMoveActionButtonNodeId = 'tasks-scrum-actions-panel-btn-move';\n\t\t\tmove = Tag.render`\n\t\t\t\t<div id=\"${this.showMoveActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-move\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tthis.sprintActionButtonNodeId = 'tasks-scrum-actions-panel-btn-sprint';\n\t\t\tsprint = Tag.render`\n\t\t\t\t<div id=\"${this.sprintActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-sprint\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_SPRINT')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tthis.backlogActionButtonNodeId = 'tasks-scrum-actions-panel-btn-backlog';\n\t\t\tbacklog = Tag.render`\n\t\t\t\t<div id=\"${this.backlogActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-backlog\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_BACKLOG')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tthis.tagsActionButtonNodeId = 'tasks-scrum-actions-panel-btn-tags';\n\t\t\ttags = Tag.render`\n\t\t\t\t<div  id=\"${this.tagsActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TAGS')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tthis.epicActionButtonNodeId = 'tasks-scrum-actions-panel-btn-epic';\n\t\t\tepic = Tag.render`\n\t\t\t\t<div  id=\"${this.epicActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-tags\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_EPIC')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tthis.decompositionActionButtonNodeId = 'tasks-scrum-actions-panel-btn-decomposition';\n\t\t\tdecomposition = Tag.render`\n\t\t\t\t<div  id=\"${this.decompositionActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-decomposition\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-actions-panel-separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tthis.removeActionButtonNodeId = 'tasks-scrum-actions-panel-btn-remove';\n\t\t\tremove = Tag.render`\n\t\t\t\t<div  id=\"${this.removeActionButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-actions-panel-btn tasks-scrum-actions-panel-btn-remove\">\n\t\t\t\t\t<span class=\"tasks-scrum-actions-panel-icon\"></span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.actionPanelNodeId}\" class=\"tasks-scrum-actions-panel-container\">\n\t\t\t\t<div class=\"tasks-scrum-actions-panel\">\n\t\t\t\t\t${task}\n\t\t\t\t\t${attachment}\n\t\t\t\t\t${move}\n\t\t\t\t\t${sprint}\n\t\t\t\t\t${backlog}\n\t\t\t\t\t${tags}\n\t\t\t\t\t${epic}\n\t\t\t\t\t${decomposition}\n\t\t\t\t\t${remove}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(document.getElementById(this.actionPanelNodeId));\n\t}\n\n\tbindItems()\n\t{\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showTaskActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.task.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showAttachmentActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.attachment.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.showMoveActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.move.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.sprintActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.sprint.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.backlogActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.backlog.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.tagsActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.tags.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.epicActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.epic.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.removeActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.remove.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tdocument.getElementById(this.decompositionActionButtonNodeId),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.decomposition.callback\n\t\t\t);\n\t\t}\n\t}\n\n\tcalculatePanelPosition(panel: HTMLElement)\n\t{\n\t\tconst position = Dom.getPosition(this.bindElement);\n\n\t\tconst top = `${position.top}px`;\n\t\tlet left = `${position.left}px`;\n\n\t\tconst fakePanel = panel.cloneNode(true);\n\t\tfakePanel.style.visibility = 'hidden';\n\t\tfakePanel.style.top = `${position.top}px`;\n\t\tfakePanel.style.left = `${position.left}px`;\n\n\t\tDom.append(fakePanel, document.body);\n\t\tif (this.isPanelWiderThanViewport(fakePanel))\n\t\t{\n\t\t\tconst fakePanelRect = fakePanel.getBoundingClientRect();\n\t\t\tconst windowWidth = (window.innerWidth || document.documentElement.clientWidth);\n\t\t\tleft = `${fakePanelRect.left - (fakePanelRect.right - windowWidth + 40)}px`;\n\t\t}\n\t\tDom.remove(fakePanel);\n\n\t\tpanel.style.top = top;\n\t\tpanel.style.left = left;\n\t\tpanel.style.zIndex = 1100;\n\n\t\treturn panel;\n\t}\n\n\tisPanelWiderThanViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\t\tconst windowWidth = (window.innerWidth || document.documentElement.clientWidth);\n\n\t\treturn (rect.right > windowWidth);\n\t}\n}","import {Dom, Tag, Text, Type} from 'main.core';\n\ntype Params = {\n\titemId: number|string,\n\tattachedFilesCount: number,\n\tcheckListComplete: number,\n\tcheckListAll: number,\n\tnewCommentsCount: number\n}\n\nexport class TaskCounts\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.setItemId(params.itemId);\n\t\tthis.setAttachedFilesCount(params.attachedFilesCount);\n\t\tthis.setCheckListComplete(params.checkListComplete);\n\t\tthis.setCheckListAll(params.checkListAll);\n\t\tthis.setNewCommentsCount(params.newCommentsCount);\n\t}\n\n\tsetItemId(itemId: number|string)\n\t{\n\t\tthis.itemId = (\n\t\t\tType.isInteger(itemId) ? parseInt(itemId, 10) :\n\t\t\t\t(Type.isString(itemId) && itemId) ? itemId : Text.getRandom()\n\t\t);\n\t}\n\n\tsetAttachedFilesCount(count: number)\n\t{\n\t\tthis.attachedFilesCount = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetAttachedFilesCount(): number\n\t{\n\t\treturn this.attachedFilesCount;\n\t}\n\n\tsetCheckListComplete(count: number)\n\t{\n\t\tthis.checkListComplete = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetCheckListComplete(): number\n\t{\n\t\treturn this.checkListComplete;\n\t}\n\n\tsetCheckListAll(count: number)\n\t{\n\t\tthis.checkListAll = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetCheckListAll(): number\n\t{\n\t\treturn this.checkListAll;\n\t}\n\n\tsetNewCommentsCount(count: number)\n\t{\n\t\tthis.newCommentsCount = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetNewCommentsCount(): number\n\t{\n\t\treturn this.newCommentsCount;\n\t}\n\n\trenderIndicators(): ?HTMLElement|string\n\t{\n\t\tthis.indicatorsNodeId = 'tasks-scrum-item-indicators-' + this.itemId;\n\t\treturn Tag.render`\n\t\t\t<span id=\"${this.indicatorsNodeId}\" class=\"task-title-indicators\">\n\t\t\t\t<div class=\"task-attachment-counter ui-label ui-label-sm ui-label-light\">\n\t\t\t\t\t<span class=\"ui-label-inner\">${this.attachedFilesCount}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-checklist-counter ui-label ui-label-sm ui-label-light'>\n\t\t\t\t\t<span class='ui-label-inner'>${this.checkListComplete}/${this.checkListAll}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class='task-comments-counter'>\n\t\t\t\t\t<div class='ui-counter ui-counter-success'>\n\t\t\t\t\t\t<div class='ui-counter-inner'>${this.newCommentsCount}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.indicatorsNode = document.getElementById(this.indicatorsNodeId);\n\n\t\tthis.attachmentNode = this.indicatorsNode.querySelector('.task-attachment-counter');\n\t\tthis.checklistNode = this.indicatorsNode.querySelector('.task-checklist-counter');\n\t\tthis.commentsNode = this.indicatorsNode.querySelector('.task-comments-counter');\n\n\t\tthis.updateVisibility();\n\t}\n\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (!this.indicatorsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.attachedFilesCount)\n\t\t{\n\t\t\tthis.attachedFilesCount = parseInt(data.attachedFilesCount, 10);\n\t\t\tthis.attachmentNode.firstElementChild.textContent = this.attachedFilesCount;\n\t\t}\n\t\tif (data.checkListComplete)\n\t\t{\n\t\t\tthis.checkListComplete = parseInt(data.checkListComplete, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\t\tif (data.checkListAll)\n\t\t{\n\t\t\tthis.checkListAll = parseInt(data.checkListAll, 10);\n\t\t\tthis.checklistNode.firstElementChild.textContent = this.checkListComplete + '/' + this.checkListAll;\n\t\t}\n\t\tif (data.newCommentsCount)\n\t\t{\n\t\t\tthis.newCommentsCount = parseInt(data.newCommentsCount, 10);\n\t\t\tconst innerCommentCounter = this.commentsNode.querySelector('.ui-counter-inner');\n\t\t\tinnerCommentCounter.textContent = this.newCommentsCount;\n\t\t}\n\n\t\tthis.updateVisibility();\n\t}\n\n\tupdateVisibility()\n\t{\n\t\tif (this.attachedFilesCount > 0)\n\t\t{\n\t\t\tthis.showNode(this.attachmentNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.attachmentNode);\n\t\t}\n\n\t\tif (this.checkListAll > 0)\n\t\t{\n\t\t\tthis.showNode(this.checklistNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.checklistNode);\n\t\t}\n\n\t\tif (this.newCommentsCount > 0)\n\t\t{\n\t\t\tthis.showNode(this.commentsNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this.commentsNode);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'inline-flex');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}","import {Type} from 'main.core';\n\nexport class StoryPoints\n{\n\tconstructor()\n\t{\n\t\tthis.clearPoints();\n\n\t\tthis.differencePoints = 0;\n\t}\n\n\tsetPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.saveDifferencePoints((this.storyPoints ? this.storyPoints : 0), storyPoints);\n\n\t\tthis.storyPoints = String(storyPoints);\n\t}\n\n\tgetPoints(): string\n\t{\n\t\treturn String(this.storyPoints);\n\t}\n\n\taddPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStoryPoints = (this.storyPoints !== '' ? parseFloat(this.storyPoints) : 0);\n\t\tconst inputStoryPoints = parseFloat(storyPoints);\n\n\t\tlet result = (currentStoryPoints + inputStoryPoints);\n\n\t\tif (Type.isFloat(result))\n\t\t{\n\t\t\tresult = result.toFixed(1);\n\t\t}\n\n\t\tthis.storyPoints = String(result);\n\t}\n\n\tsubtractPoints(storyPoints: string)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStoryPoints = (this.storyPoints !== '' ? parseFloat(this.storyPoints) : 0);\n\t\tconst inputStoryPoints = parseFloat(storyPoints);\n\n\t\tlet result = (currentStoryPoints - inputStoryPoints);\n\n\t\tif (Type.isFloat(result))\n\t\t{\n\t\t\tresult = result.toFixed(1);\n\t\t}\n\n\t\tthis.storyPoints = String(result);\n\t}\n\n\tclearPoints()\n\t{\n\t\tthis.storyPoints = '';\n\t}\n\n\tsaveDifferencePoints(firstPoints: string, secondPoints: string)\n\t{\n\t\tthis.differencePoints = 0;\n\n\t\tif (Type.isUndefined(firstPoints) || isNaN(parseFloat(firstPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isUndefined(secondPoints) || isNaN(parseFloat(secondPoints)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfirstPoints = parseFloat(firstPoints);\n\t\tsecondPoints = parseFloat(secondPoints);\n\n\t\tthis.differencePoints = (secondPoints - firstPoints);\n\t}\n\n\tgetDifferencePoints(): number\n\t{\n\t\treturn this.differencePoints;\n\t}\n}","import {Type, Dom, Event, Tag, Text, Loc, Runtime} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Label} from 'ui.label';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {Dialog} from 'ui.entity-selector';\n\nimport {DiskManager} from '../service/disk.manager';\n\nimport {ActionsPanel} from './task/actions.panel';\nimport {TaskCounts} from './task/taskcounts';\n\nimport {StoryPoints} from '../utility/story.points';\n\nimport '../css/item.css';\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\nexport type EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tinfo: EpicInfoType\n}\n\ntype AllowedActions = {\n\ttask_edit: boolean,\n\ttask_remove: boolean,\n}\n\nexport type Responsible = {\n\tid: number,\n\tname: string,\n\tpathToUser: string,\n\tphoto: {\n\t\tsrc: string\n\t}\n}\n\ntype ItemInfo = {\n\tcolor?: string,\n\tborderColor?: string\n}\n\nexport type ItemParams = {\n\titemId: number|string,\n\ttmpId: string,\n\tname: string,\n\titemType?: string,\n\tsort?: number,\n\tinfo?: ItemInfo,\n\tentityId?: number,\n\tentityType?: string,\n\tparentId?: number,\n\tsourceId?: number,\n\tparentSourceId?: number,\n\tresponsible?: Responsible,\n\tstoryPoints?: string,\n\tcompleted?: 'Y' | 'N',\n\tallowedActions?: AllowedActions,\n\tepic?: EpicType,\n\ttags?: Array,\n\tisParentTask?: 'Y' | 'N',\n\tsubTasksCount?: number,\n\tisLinkedTask?: 'Y' | 'N',\n\tparentTaskId?: number,\n\tisSubTask?: 'Y' | 'N'\n};\n\n//todo single responsibility principle\nexport class Item extends EventEmitter\n{\n\tconstructor(params: ItemParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item');\n\n\t\tthis.setItemParams(params);\n\n\t\tthis.groupMode = false;\n\t\tthis.previewMode = false;\n\t}\n\n\tsetItemParams(params: ItemParams)\n\t{\n\t\tthis.setItemNode();\n\n\t\tthis.setItemId(params.itemId);\n\t\tthis.setTmpId(params.tmpId);\n\t\tthis.setName(params.name);\n\t\tthis.setItemType(params.itemType);\n\t\tthis.setSort(params.sort);\n\t\tthis.setEntityId(params.entityId);\n\t\tthis.setEntityType(params.entityType);\n\t\tthis.setParentId(params.parentId);\n\t\tthis.setSourceId(params.sourceId);\n\t\tthis.setParentSourceId(params.parentSourceId);\n\t\tthis.setResponsible(params.responsible);\n\t\tthis.setStoryPoints(params.storyPoints);\n\t\tthis.setInfo(params.info);\n\n\t\tthis.setCompleted(params.completed);\n\t\tthis.setDisableStatus(this.isCompleted());\n\n\t\tthis.setAllowedActions(params.allowedActions);\n\t\tthis.setEpic(params.epic);\n\t\tthis.setTags(params.tags);\n\n\t\tthis.setParentTask(params.isParentTask);\n\t\tthis.setSubTasksCount(params.subTasksCount);\n\t\tthis.setLinkedTask(params.isLinkedTask);\n\t\tthis.setParentTaskId(params.parentTaskId);\n\t\tthis.setSubTask(params.isSubTask);\n\n\t\tthis.setTaskCounts(params);\n\t}\n\n\tstatic buildItem(params: ItemParams): Item\n\t{\n\t\treturn new Item(params);\n\t}\n\n\tsetItemId(itemId: number|string)\n\t{\n\t\tthis.itemId = (\n\t\t\tType.isInteger(itemId) ? parseInt(itemId, 10) :\n\t\t\t\t(Type.isString(itemId) && itemId) ? itemId : Text.getRandom()\n\t\t);\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.getItemNode().dataset.itemId = this.itemId;\n\t\t}\n\t}\n\n\tgetItemId()\n\t{\n\t\treturn this.itemId;\n\t}\n\n\tsetTmpId(tmpId: string)\n\t{\n\t\tthis.tmpId = (Type.isString(tmpId) ? tmpId : '');\n\t}\n\n\tgetTmpId(): string\n\t{\n\t\treturn this.tmpId;\n\t}\n\n\tsetName(name: string)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : 'Name');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name-field');\n\t\t\tnameNode.querySelector('.ui-ctl-element').textContent = Text.encode(this.name);\n\t\t}\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetItemType(type: string)\n\t{\n\t\tthis.itemType = (Type.isString(type) ? type : 'task');\n\t}\n\n\tgetItemType()\n\t{\n\t\treturn this.itemType;\n\t}\n\n\tsetSort(sort: number)\n\t{\n\t\tthis.setPreviousSort(this.sort);\n\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tDom.attr(this.getItemNode(), 'data-sort', this.sort);\n\t\t}\n\t}\n\n\tgetSort(): number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetPreviousSort(sort: number)\n\t{\n\t\tthis.previousSort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\t}\n\n\tgetPreviousSort(): number\n\t{\n\t\treturn this.previousSort;\n\t}\n\n\tsetEntityId(entityId: number)\n\t{\n\t\tthis.entityId = (Type.isInteger(entityId) ? parseInt(entityId, 10) : 0);\n\t}\n\n\tgetEntityId(): number\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tsetEntityType(entityType: string)\n\t{\n\t\tthis.entityType = (new Set(['backlog', 'sprint']).has(entityType) ? entityType : 'backlog');\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.entityType;\n\t}\n\n\tsetParentId(parentId: number)\n\t{\n\t\tthis.parentId = (Type.isInteger(parentId) ? parseInt(parentId, 10) : 0);\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetSourceId(sourceId: number)\n\t{\n\t\tthis.sourceId = (Type.isInteger(sourceId) ? parseInt(sourceId, 10) : 0);\n\t}\n\n\tgetSourceId()\n\t{\n\t\treturn this.sourceId;\n\t}\n\n\tsetParentSourceId(sourceId: number)\n\t{\n\t\tthis.parentSourceId = (Type.isInteger(sourceId) ? parseInt(sourceId, 10) : 0);\n\t}\n\n\tgetParentSourceId(): number\n\t{\n\t\treturn this.parentSourceId;\n\t}\n\n\tsetResponsible(responsible: Responsible)\n\t{\n\t\tthis.responsible = (Type.isPlainObject(responsible) ? responsible : null);\n\n\t\tif (this.responsible && this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateResponsible();\n\t\t}\n\t}\n\n\tgetResponsible(): Responsible\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.storyPoints)\n\t\t{\n\t\t\tthis.storyPoints = new StoryPoints();\n\t\t}\n\n\t\tthis.storyPoints.setPoints(storyPoints);\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tconst storyPointsNode = this.getItemNode().querySelector('.tasks-scrum-item-story-points');\n\t\t\tstoryPointsNode.querySelector('.ui-ctl-element').textContent = Text.encode(\n\t\t\t\tthis.getStoryPoints().getPoints()\n\t\t\t);\n\n\t\t\tthis.sendEventToUpdateStoryPoints();\n\t\t}\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tsetCompleted(value: string)\n\t{\n\t\tthis.completed = (value === 'Y');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateCompletedStatus();\n\t\t}\n\t}\n\n\tsetAllowedActions(allowedActions: AllowedActions)\n\t{\n\t\tthis.allowedActions = (Type.isPlainObject(allowedActions) ? allowedActions : {});\n\t}\n\n\tsetEpic(epic: EpicType)\n\t{\n\t\tthis.epic = (Type.isPlainObject(epic) ? epic : null);\n\t}\n\n\tgetEpic(): EpicType\n\t{\n\t\treturn this.epic;\n\t}\n\n\tsetTags(tags)\n\t{\n\t\tthis.tags = (Type.isArray(tags) ? tags : []);\n\t}\n\n\tgetTags(): Array\n\t{\n\t\treturn this.tags;\n\t}\n\n\tsetParentTask(value: string)\n\t{\n\t\tthis.parentTask = (value === 'Y');\n\t}\n\n\tisParentTask(): boolean\n\t{\n\t\treturn this.parentTask;\n\t}\n\n\tsetSubTasksCount(count: number)\n\t{\n\t\tthis.subTasksCount = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\t}\n\n\tgetSubTasksCount(): number\n\t{\n\t\treturn this.subTasksCount;\n\t}\n\n\tsetLinkedTask(value: string)\n\t{\n\t\tthis.linkedTask = (value === 'Y');\n\t}\n\n\tisLinkedTask(): boolean\n\t{\n\t\treturn this.linkedTask;\n\t}\n\n\tsetParentTaskId(id: number)\n\t{\n\t\tthis.parentTaskId = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\t}\n\n\tgetParentTaskId(): number\n\t{\n\t\treturn this.parentTaskId;\n\t}\n\n\tsetSubTask(value: string)\n\t{\n\t\tthis.subTask = (value === 'Y');\n\t}\n\n\tisSubTask(): boolean\n\t{\n\t\treturn this.subTask;\n\t}\n\n\tsetTaskCounts(params: ItemParams)\n\t{\n\t\tthis.taskCounts = (this.itemType === 'task' ? new TaskCounts(params) : null);\n\t}\n\n\tgetTaskCounts(): TaskCounts|null\n\t{\n\t\treturn this.taskCounts;\n\t}\n\n\tsetInfo(info: ?ItemInfo)\n\t{\n\t\tif (Type.isUndefined(info))\n\t\t{\n\t\t\tthis.info = {\n\t\t\t\tcolor: '',\n\t\t\t\tborderColor: ''\n\t\t\t};\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.info = info;\n\n\t\tthis.setBorderColor(this.info.borderColor);\n\t}\n\n\tgetInfo(): ?ItemInfo\n\t{\n\t\treturn this.info;\n\t}\n\n\tsetBorderColor(color: string)\n\t{\n\t\tthis.info.borderColor = (Type.isString(color) ? color : '');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tif (this.getBorderColor())\n\t\t\t{\n\t\t\t\tDom.style(this.getItemNode(), 'border', '2px solid ' + this.getBorderColor());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.style(this.getItemNode(), 'border', null);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetBorderColor(): string\n\t{\n\t\treturn (Type.isString(this.info.borderColor) ? this.info.borderColor : '');\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn this.completed;\n\t}\n\n\tupdateCompletedStatus()\n\t{\n\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name');\n\t\tconst nameTextNode = nameNode.querySelector('.ui-ctl-element');\n\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tDom.style(nameTextNode, 'textDecoration', 'line-through');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(nameTextNode, 'textDecoration', null);\n\t\t}\n\n\t\tthis.sendEventToUpdateStoryPoints();\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn this.disableStatus;\n\t}\n\n\tsetMoveActivity(value: boolean)\n\t{\n\t\tthis.moveActivity = Boolean(value);\n\t}\n\n\tisMovable(): boolean\n\t{\n\t\treturn this.moveActivity;\n\t}\n\n\tsetDisableStatus(status: boolean)\n\t{\n\t\tthis.disableStatus = Boolean(status);\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (status)\n\t\t{\n\t\t\tthis.hideNode(this.getItemNode().querySelector('.tasks-scrum-dragndrop'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showNode(this.getItemNode().querySelector('.tasks-scrum-dragndrop'));\n\t\t}\n\t}\n\n\tactivateGroupMode()\n\t{\n\t\tthis.groupMode = true;\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\tconst groupModeCheckbox = groupModeContainer.querySelector('input');\n\t\tgroupModeCheckbox.checked = false;\n\n\t\tEvent.bind(groupModeCheckbox, 'change', (event) => {\n\t\t\tDom.toggleClass(this.getItemNode(), 'tasks-scrum-item-group-mode');\n\t\t\tif (this.getItemNode().classList.contains('tasks-scrum-item-group-mode'))\n\t\t\t{\n\t\t\t\tthis.emit('addItemToGroupMode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emit('removeItemFromGroupMode');\n\t\t\t}\n\t\t\tthis.showActionsPanel(event);\n\t\t});\n\n\t\tthis.showNode(groupModeContainer);\n\n\t\tthis.deactivateDragNDrop();\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getItemNode(), 'tasks-scrum-item-group-mode');\n\n\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\tthis.hideNode(groupModeContainer);\n\n\t\tEvent.unbindAll(groupModeContainer.querySelector('input'));\n\n\t\tthis.groupMode = false;\n\n\t\tthis.activateDragNDrop();\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\tactivatePreviewMode()\n\t{\n\t\tthis.previewMode = true;\n\t}\n\n\tisPreviewMode(): boolean\n\t{\n\t\treturn this.previewMode;\n\t}\n\n\tgetPreviewVersion(): Item\n\t{\n\t\tconst previewItem = Runtime.clone(this);\n\t\tpreviewItem.setItemId();\n\t\tpreviewItem.itemNode = null;\n\t\tif (previewItem.taskCounts)\n\t\t{\n\t\t\tpreviewItem.taskCounts = new TaskCounts(previewItem);\n\t\t}\n\t\tpreviewItem.activatePreviewMode();\n\t\treturn previewItem;\n\t}\n\n\tactivateDecompositionMode(color: string)\n\t{\n\t\tthis.decompositionMode = true;\n\n\t\tif (this.getBorderColor() === '')\n\t\t{\n\t\t\tthis.setBorderColor(color);\n\t\t}\n\n\t\tif (this.getBorderColor())\n\t\t{\n\t\t\tDom.style(this.getItemNode(), 'border', '2px solid ' + this.getBorderColor());\n\t\t}\n\n\t\tthis.deactivateDragNDrop();\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.decompositionMode = false;\n\n\t\tif (this.getBorderColor() === '')\n\t\t{\n\t\t\tthis.setBorderColor();\n\t\t\tDom.style(this.getItemNode(), 'border', null);\n\t\t}\n\n\t\tthis.activateDragNDrop();\n\t}\n\n\tactivateDragNDrop()\n\t{\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tif (!this.getItemNode().classList.contains('tasks-scrum-item-drag'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.getItemNode(), 'tasks-scrum-item-drag');\n\t\t\t}\n\t\t}\n\t}\n\n\tdeactivateDragNDrop()\n\t{\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tDom.removeClass(this.getItemNode(), 'tasks-scrum-item-drag');\n\t\t}\n\t}\n\n\tisDecompositionMode(): boolean\n\t{\n\t\treturn this.decompositionMode;\n\t}\n\n\tsetItemNode(node?: HTMLElement)\n\t{\n\t\ttry\n\t\t{\n\t\t\tthis.itemNode = ((node instanceof HTMLElement) ? node : null);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tthis.itemNode = null;\n\t\t}\n\t}\n\n\tgetItemNode(): HTMLElement|null\n\t{\n\t\treturn this.itemNode;\n\t}\n\n\tisNodeCreated(): boolean\n\t{\n\t\treturn (this.itemNode !== null);\n\t}\n\n\tsetParentEntity(entityId: number, entityType: string)\n\t{\n\t\tthis.setEntityId(entityId);\n\t\tthis.setEntityType(entityType);\n\t}\n\n\tisEditAllowed(): boolean\n\t{\n\t\treturn Boolean(this.allowedActions['task_edit']);\n\t}\n\n\tisRemoveAllowed(): boolean\n\t{\n\t\treturn Boolean(this.allowedActions['task_remove']);\n\t}\n\n\tupdateYourself(tmpItem: Item)\n\t{\n\t\tif (tmpItem.getName() !== this.getName())\n\t\t{\n\t\t\tthis.setName(tmpItem.getName());\n\t\t}\n\t\tif (tmpItem.getEntityId() !== this.getEntityId())\n\t\t{\n\t\t\tthis.setEntityId(tmpItem.getEntityId());\n\t\t}\n\t\tif (tmpItem.getResponsible().id !== this.getResponsible().id)\n\t\t{\n\t\t\tthis.setResponsible(tmpItem.getResponsible());\n\t\t}\n\t\tif (tmpItem.getStoryPoints().getPoints() !== this.getStoryPoints().getPoints())\n\t\t{\n\t\t\tthis.setStoryPoints(tmpItem.getStoryPoints().getPoints());\n\t\t}\n\t\tif (this.getTaskCounts() && tmpItem.getTaskCounts())\n\t\t{\n\t\t\tthis.getTaskCounts().updateIndicators({\n\t\t\t\tattachedFilesCount: tmpItem.getTaskCounts().getAttachedFilesCount(),\n\t\t\t\tcheckListComplete: tmpItem.getTaskCounts().getCheckListComplete(),\n\t\t\t\tcheckListAll: tmpItem.getTaskCounts().getCheckListAll(),\n\t\t\t\tnewCommentsCount: tmpItem.getTaskCounts().getNewCommentsCount(),\n\t\t\t});\n\t\t}\n\t\tif (tmpItem.isCompleted() !== this.isCompleted())\n\t\t{\n\t\t\tthis.setCompleted(tmpItem.isCompleted() ? 'Y' : 'N')\n\t\t}\n\n\t\tthis.setParentId(tmpItem.getParentId());\n\t\tthis.setEpicAndTags(tmpItem.getEpic(), tmpItem.getTags());\n\t\tthis.setInfo(tmpItem.getInfo());\n\n\t\tthis.setParentTask(tmpItem.isParentTask() ? 'Y' : 'N');\n\t\tthis.setSubTasksCount(tmpItem.getSubTasksCount());\n\t\tthis.setLinkedTask(tmpItem.isLinkedTask() ? 'Y' : 'N');\n\t\tthis.setParentTaskId(tmpItem.getParentTaskId());\n\t\tthis.setSubTask(tmpItem.isSubTask() ? 'Y' : 'N');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.updateParentTaskNodes();\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.getItemNode());\n\t\tthis.setItemNode();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet itemClassName = 'tasks-scrum-item';\n\t\tif (this.isSubTask())\n\t\t{\n\t\t\titemClassName += ' tasks-scrum-subtask-item'\n\t\t}\n\n\t\tthis.itemNode = Tag.render`\n\t\t\t<div data-item-id=\"${Text.encode(this.itemId)}\" data-sort=\n\t\t\t\t\"${Text.encode(this.sort)}\" class=\"${itemClassName}\">\n\t\t\t\t<div class=\"tasks-scrum-item-inner\">\n\t\t\t\t\t<div class=\"tasks-scrum-item-group-mode-container\">\n\t\t\t\t\t\t<input type=\"checkbox\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-item-name\">\n\t\t\t\t\t\t${this.renderName()}\n\t\t\t\t\t\t${(this.taskCounts && this.itemType === 'task' ? this.taskCounts.renderIndicators() : '')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-item-params\">\n\t\t\t\t\t\t${this.renderSubTasksCounter()}\n\t\t\t\t\t\t${this.renderResponsible()}\n\t\t\t\t\t\t${this.renderStoryPoints()}\n\t\t\t\t\t\t${this.renderSubTasksTick()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.renderTags()}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.isNodeCreated() && this.getBorderColor())\n\t\t{\n\t\t\tDom.style(this.itemNode, 'border', '2px solid ' + this.getBorderColor());\n\t\t}\n\n\t\treturn this.itemNode;\n\t}\n\n\trenderName(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-name-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-no-border\">\n\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t${Text.encode(this.name)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderResponsible(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"ui-icon ui-icon-common-user tasks-scrum-item-responsible\"><i></i></div>`;\n\t}\n\n\trenderStoryPoints(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-story-points\">\n\t\t\t\t<div class=\"tasks-scrum-item-story-points-field ui-ctl ui-ctl-xs ui-ctl-textbox ui-ctl-auto ui-ctl-no-border\">\n\t\t\t\t\t<div class=\"ui-ctl-element\" contenteditable=\"false\">\n\t\t\t\t\t\t${Text.encode(this.getStoryPoints().getPoints())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderSubTasksCounter(): HTMLElement\n\t{\n\t\tif (!this.isParentTask())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst subTasksCounter = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-subtasks-btn\">\n\t\t\t\t<span class=\"tasks-scrum-item-subtasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-item-subtasks-count\">\n\t\t\t\t\t${this.getSubTasksCount()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(subTasksCounter, 'click', () => {\n\t\t\tthis.emit('showTask');\n\t\t});\n\n\t\treturn subTasksCounter;\n\t}\n\n\trenderSubTasksTick(): HTMLElement\n\t{\n\t\tif (!this.isParentTask())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tif (this.getEntityType() === 'backlog')\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst subTasksTick = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-subtasks-tick\">\n\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ui-btn-icon-angle-down\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(subTasksTick, 'click', () => {\n\t\t\tif (!this.isDecompositionMode())\n\t\t\t{\n\t\t\t\tthis.emit('toggleSubTasks');\n\t\t\t}\n\t\t});\n\n\t\treturn subTasksTick;\n\t}\n\n\ttoggleSubTasksTick()\n\t{\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst subTasksTick = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\n\t\tif (subTasksTick)\n\t\t{\n\t\t\tsubTasksTick.firstElementChild.classList.toggle('ui-btn-icon-angle-up');\n\t\t\tsubTasksTick.firstElementChild.classList.toggle('ui-btn-icon-angle-down');\n\t\t}\n\t}\n\n\trenderTags(): ?HTMLElement|string\n\t{\n\t\tif (this.epic === null && this.tags.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEpicTag(): ?HTMLElement\n\t{\n\t\tif (this.epic === null)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst getContrastYIQ = (hexcolor) => {\n\t\t\tif (!hexcolor)\n\t\t\t{\n\t\t\t\thexcolor = Label.Color.DEFAULT;\n\t\t\t}\n\t\t\thexcolor = hexcolor.replace('#', '');\n\t\t\tconst r = parseInt(hexcolor.substr(0, 2), 16);\n\t\t\tconst g = parseInt(hexcolor.substr(2, 2), 16);\n\t\t\tconst b = parseInt(hexcolor.substr(4, 2), 16);\n\t\t\tconst yiq = ((r * 299 ) + (g* 587 ) + (b * 114)) / 1000;\n\t\t\treturn (yiq >= 128) ? 'black' : 'white';\n\t\t};\n\n\t\tconst epicLabel = new Label({\n\t\t\ttext: this.epic.name,\n\t\t\tcolor: Label.Color.DEFAULT,\n\t\t\tsize: Label.Size.MD,\n\t\t\tcustomClass: 'tasks-scrum-item-epic-label'\n\t\t});\n\t\tconst container = epicLabel.getContainer();\n\t\tconst innerLabel = container.querySelector('.ui-label-inner');\n\n\t\tconst contrast = getContrastYIQ(this.epic.info.color);\n\t\tif (contrast === 'white')\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#ffffff');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(innerLabel, 'color', '#525c69');\n\t\t}\n\t\tDom.style(container, 'backgroundColor', this.epic.info.color);\n\n\t\tEvent.bind(container, 'click', (event) => {\n\t\t\tif (this.isGroupMode())\n\t\t\t{\n\t\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\t\tthis.showActionsPanel(event);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emit('filterByEpic', this.epic.id);\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tgetListTagNodes(): HTMLElement\n\t{\n\t\treturn this.tags.map((tag) => {\n\t\t\tconst tagLabel = new Label({\n\t\t\t\ttext: tag,\n\t\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\t\tfill: true,\n\t\t\t\tsize: Label.Size.SM,\n\t\t\t\tcustomClass: ''\n\t\t\t});\n\t\t\tconst container = tagLabel.getContainer();\n\t\t\tEvent.bind(container, 'click', (event) => {\n\t\t\t\tif (this.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\t\t\tthis.showActionsPanel(event);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.emit('filterByTag', tag);\n\t\t\t});\n\t\t\treturn container;\n\t\t});\n\t}\n\n\t// todo remove all method\n\tonAfterAppend(container)\n\t{\n\t\tthis.setItemNode(container.querySelector('[data-item-id=\"'+this.itemId+'\"]'));\n\n\t\tif (!this.isNodeCreated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.onAfterAppend();\n\t\t}\n\n\t\tthis.updateResponsible();\n\n\t\tif (this.isPreviewMode())\n\t\t{\n\t\t\tEvent.bind(this.getItemNode(), 'click', () => this.emit('showTask'));\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isDecompositionMode())\n\t\t{\n\t\t\tthis.activateDragNDrop();\n\t\t}\n\n\t\tif (this.isSubTask())\n\t\t{\n\t\t\tthis.deactivateDragNDrop();\n\t\t}\n\n\t\tEvent.unbindAll(this.getItemNode());\n\t\tEvent.bind(this.getItemNode(), 'click', this.onItemClick.bind(this));\n\n\t\tconst nameNode = this.getItemNode().querySelector('.tasks-scrum-item-name');\n\t\tEvent.unbindAll(nameNode);\n\t\tEvent.bind(nameNode, 'click', this.onNameClick.bind(this));\n\n\t\tconst responsibleNode = this.getItemNode().querySelector('.tasks-scrum-item-responsible');\n\t\tEvent.unbindAll(responsibleNode);\n\t\tEvent.bind(responsibleNode, 'click', this.onResponsibleClick.bind(this));\n\n\t\tconst storyPointsNode = this.getItemNode().querySelector('.tasks-scrum-item-story-points');\n\t\tEvent.unbindAll(storyPointsNode);\n\t\tEvent.bind(storyPointsNode, 'click', this.onStoryPointsClick.bind(this));\n\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tconst nameTextNode = nameNode.querySelector('.ui-ctl-element');\n\t\t\tDom.style(nameTextNode, 'textDecoration', 'line-through');\n\t\t}\n\n\t\tthis.updateParentTaskNodes();\n\t}\n\n\tisShowIndicators(): Boolean\n\t{\n\t\treturn Boolean(this.attachedFilesCount || this.checkListAll || this.newCommentsCount);\n\t}\n\n\tupdateParentTaskNodes()\n\t{\n\t\tif (this.isParentTask())\n\t\t{\n\t\t\tconst subTasksCounterNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-btn');\n\t\t\tif (subTasksCounterNode)\n\t\t\t{\n\t\t\t\tDom.replace(subTasksCounterNode, this.renderSubTasksCounter());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst paramsNode = this.getItemNode().querySelector('.tasks-scrum-item-params');\n\t\t\t\tconst subTasksCounterNode = this.renderSubTasksCounter();\n\t\t\t\tDom.insertBefore(subTasksCounterNode, paramsNode.firstElementChild);\n\t\t\t}\n\n\t\t\tconst subTasksTickNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\t\t\tif (subTasksTickNode)\n\t\t\t{\n\t\t\t\tconst newSubTasksTickNode = this.renderSubTasksTick();\n\t\t\t\tif (newSubTasksTickNode)\n\t\t\t\t{\n\t\t\t\t\tDom.replace(subTasksTickNode, newSubTasksTickNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.remove(subTasksTickNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst paramsNode = this.getItemNode().querySelector('.tasks-scrum-item-params');\n\t\t\t\tconst newSubTasksTickNode = this.renderSubTasksTick();\n\t\t\t\tDom.append(newSubTasksTickNode, paramsNode);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst subTasksCounterNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-btn');\n\t\t\tif (subTasksCounterNode)\n\t\t\t{\n\t\t\t\tDom.remove(subTasksCounterNode);\n\t\t\t}\n\t\t\tconst subTasksTickNode = this.getItemNode().querySelector('.tasks-scrum-item-subtasks-tick');\n\t\t\tif (subTasksTickNode)\n\t\t\t{\n\t\t\t\tDom.remove(subTasksTickNode);\n\t\t\t}\n\t\t}\n\t}\n\n\tonItemClick(event)\n\t{\n\t\tif (this.isClickOnEditableName(event))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst ignoreTagList = new Set(['I', 'SPAN', 'INPUT']);\n\t\tif (ignoreTagList.has(event.target.tagName))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.target.closest('.tasks-scrum-item-subtasks-tick'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clickToGroupModeCheckbox();\n\n\t\tthis.showActionsPanel(event);\n\t}\n\n\tisClickOnEditableName(event): boolean\n\t{\n\t\treturn (this.isEditAllowed() && event.target.classList.contains('ui-ctl-element'));\n\t}\n\n\tonNameClick(event)\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isEditAllowed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst targetNode = event.target;\n\t\tif (Dom.hasClass(targetNode, 'ui-ctl-element') && targetNode.contentEditable === 'true')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Dom.hasClass(targetNode, 'ui-ctl-element') || this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst nameNode = event.currentTarget;\n\t\tconst borderNode = nameNode.querySelector('.ui-ctl');\n\t\tconst valueNode = nameNode.querySelector('.ui-ctl-element');\n\t\tvalueNode.textContent = valueNode.textContent.trim();\n\t\tconst oldValue = valueNode.textContent;\n\n\t\tDom.addClass(this.getItemNode(), 'tasks-scrum-item-edit-mode');\n\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\tvalueNode.contentEditable = 'true';\n\n\t\tthis.deactivateDragNDrop();\n\n\t\tthis.placeCursorAtEnd(valueNode);\n\n\t\tEvent.bind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\tEvent.bindOnce(valueNode, 'blur', () => {\n\t\t\tEvent.unbind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\t\tDom.removeClass(this.getItemNode(), 'tasks-scrum-item-edit-mode');\n\t\t\tDom.addClass(borderNode, 'ui-ctl-no-border');\n\t\t\tvalueNode.contentEditable = 'false';\n\n\t\t\tthis.activateDragNDrop();\n\n\t\t\tconst newValue = valueNode.textContent.trim();\n\t\t\tif (oldValue === newValue)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emit('updateItem', {\n\t\t\t\titemId: this.getItemId(),\n\t\t\t\tentityId: this.getEntityId(),\n\t\t\t\titemType: this.getItemType(),\n\t\t\t\tname: newValue\n\t\t\t});\n\t\t\tthis.name = newValue;\n\t\t}, true);\n\t}\n\n\tclickToGroupModeCheckbox()\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tconst groupModeContainer = this.getItemNode().querySelector('.tasks-scrum-item-group-mode-container');\n\t\t\tconst groupModeCheckbox = groupModeContainer.querySelector('input');\n\t\t\tgroupModeCheckbox.click();\n\t\t}\n\t}\n\n\tonResponsibleClick(event)\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst responsibleNode = event.currentTarget;\n\n\t\tconst dialog = new Dialog({\n\t\t\ttargetNode: responsibleNode,\n\t\t\tenableSearch: true,\n\t\t\tcontext: 'TASKS',\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tthis.responsible = {\n\t\t\t\t\t\tid: selectedItem.getId(),\n\t\t\t\t\t\tname: selectedItem.getTitle(),\n\t\t\t\t\t\tphoto: {\n\t\t\t\t\t\t\tsrc: selectedItem.getAvatar()\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tthis.updateResponsible();\n\t\t\t\t\tthis.emit('changeTaskResponsible');\n\n\t\t\t\t},\n\t\t\t},\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'user',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tinviteEmployeeLink: false\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'department'\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\n\t\tdialog.show();\n\t}\n\n\tonStoryPointsClick(event)\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\tthis.clickToGroupModeCheckbox();\n\t\t\tthis.showActionsPanel(event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst storyPointsNode = event.currentTarget;\n\t\tconst borderNode = storyPointsNode.querySelector('.ui-ctl');\n\t\tconst valueNode = storyPointsNode.querySelector('.ui-ctl-element');\n\t\tvalueNode.textContent = valueNode.textContent.trim();\n\t\tconst oldValue = valueNode.textContent.trim();\n\n\t\tif (valueNode.contentEditable === 'true')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\tvalueNode.contentEditable = 'true';\n\n\t\tthis.placeCursorAtEnd(valueNode);\n\n\t\tEvent.bind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\tEvent.bindOnce(valueNode, 'blur', () => {\n\t\t\tEvent.unbind(valueNode, 'keydown', this.blockEnterInput.bind(valueNode));\n\n\t\t\tDom.toggleClass(borderNode, 'ui-ctl-no-border');\n\t\t\tvalueNode.contentEditable = 'false';\n\n\t\t\tconst newValue = valueNode.textContent.trim();\n\t\t\tif (newValue && oldValue === newValue)\n\t\t\t{\n\t\t\t\tvalueNode.textContent = oldValue;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setStoryPoints(newValue);\n\n\t\t\tthis.emit('updateItem', {\n\t\t\t\titemId: this.getItemId(),\n\t\t\t\tentityId: this.getEntityId(),\n\t\t\t\titemType: this.getItemType(),\n\t\t\t\tstoryPoints: newValue\n\t\t\t});\n\t\t\tthis.sendEventToUpdateStoryPoints();\n\t\t}, true);\n\t}\n\n\tsendEventToUpdateStoryPoints()\n\t{\n\t\tthis.emit('updateStoryPoints');\n\t}\n\n\tblockEnterInput(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.blur();\n\t\t\treturn;\n\t\t}\n\t};\n\n\tshowActionsPanel(event)\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown() && !this.isGroupMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t}\n\n\t\tthis.actionsPanel = new ActionsPanel({\n\t\t\tbindElement: this.getItemNode(),\n\t\t\titemList: {\n\t\t\t\ttask: {\n\t\t\t\t\tactivity: (this.itemType === 'task' && !this.isGroupMode()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('showTask');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tattachment: {\n\t\t\t\t\tactivity: (!this.isDisabled() && this.isEditAllowed() && !this.isGroupMode()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tconst diskManager = new DiskManager({\n\t\t\t\t\t\t\tufDiskFilesFieldName: 'UF_TASK_WEBDAV_FILES'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.subscribeOnce('onFinish', (baseEvent) => {\n\t\t\t\t\t\t\tthis.emit('attachFilesToTask', baseEvent.getData());\n\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdiskManager.showAttachmentMenu(event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tactivity: (!this.decompositionMode && this.isMovable() && !this.isSubTask()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('move', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tsprint: {\n\t\t\t\t\tactivity: (!this.isDisabled() && !this.decompositionMode && !this.isSubTask()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('moveToSprint', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbacklog: {\n\t\t\t\t\tactivity: (this.entityType === 'sprint' && !this.decompositionMode && !this.isSubTask()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.emit('moveToBacklog');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ttags: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showTagSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tepic: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('showEpicSearcher', event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdecomposition: {\n\t\t\t\t\tactivity: (\n\t\t\t\t\t\t!this.isDisabled()\n\t\t\t\t\t\t&& !this.decompositionMode\n\t\t\t\t\t\t&& !this.isGroupMode()\n\t\t\t\t\t\t&& !this.isSubTask()\n\t\t\t\t\t),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.emit('startDecomposition');\n\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tactivity: this.isRemoveAllowed(),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tconst message = (this.isGroupMode() ? Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASKS') :\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASK'));\n\t\t\t\t\t\tMessageBox.confirm(\n\t\t\t\t\t\t\tmessage,\n\t\t\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\t\t\tthis.emit('remove');\n\t\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t\t\tthis.actionsPanel.destroy();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.actionsPanel.showPanel();\n\t}\n\n\tgetCurrentActionsPanel(): ?ActionsPanel\n\t{\n\t\tif (this.actionsPanel && this.actionsPanel.isShown())\n\t\t{\n\t\t\treturn this.actionsPanel;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null\n\t\t}\n\t}\n\n\tsetEpicAndTags(epic, tags: Array)\n\t{\n\t\tthis.epic = (Type.isPlainObject(epic) || epic === null ? epic : this.epic);\n\t\tthis.tags = (Type.isArray(tags) ? tags : this.tags);\n\n\t\tthis.updateTagsContainer();\n\t}\n\n\tupdateTagsContainer()\n\t{\n\t\tif (!this.getItemNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newContainer = Tag.render`\n\t\t\t<div class=\"tasks-scrum-item-tags-container\">\n\t\t\t\t${this.getEpicTag()}\n\t\t\t\t${this.getListTagNodes()}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst tagsContainerNode = this.getItemNode().querySelector('.tasks-scrum-item-tags-container');\n\t\tif (tagsContainerNode)\n\t\t{\n\t\t\tDom.replace(tagsContainerNode, newContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newContainer, this.getItemNode());\n\t\t}\n\t}\n\n\tupdateResponsible()\n\t{\n\t\tconst responsibleNode = this.getItemNode().querySelector('.tasks-scrum-item-responsible');\n\n\t\tif (!responsibleNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.attr(responsibleNode, 'title', this.responsible.name);\n\t\tif (this.responsible.photo && this.responsible.photo.src)\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', 'url(\"'+this.responsible.photo.src+'\")');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(responsibleNode.firstElementChild, 'backgroundImage', null);\n\t\t}\n\t}\n\n\tplaceCursorAtEnd(node)\n\t{\n\t\tnode.focus();\n\t\tconst selection = window.getSelection();\n\t\tconst range = document.createRange();\n\t\trange.selectNodeContents(node);\n\t\trange.collapse(false);\n\t\tselection.removeAllRanges();\n\t\tselection.addRange(range);\n\t};\n\n\tupdateIndicators(data: Object)\n\t{\n\t\tif (this.taskCounts)\n\t\t{\n\t\t\tthis.taskCounts.updateIndicators(data);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tDom.style(node, 'display', 'block');\n\t}\n\n\thideNode(node)\n\t{\n\t\tDom.style(node, 'display', 'none');\n\t}\n}\n","import {Dom, Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class GroupActionsButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.GroupActionsButton');\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-group-actions\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_GROUP')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(this.element, 'click', this.onClick.bind(this, this.element));\n\n\t\treturn this.element;\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tif (this.element && this.element.classList.contains('tasks-scrum-group-actions-active'))\n\t\t{\n\t\t\tDom.toggleClass(this.element, 'tasks-scrum-group-actions');\n\t\t\tDom.toggleClass(this.element, 'tasks-scrum-group-actions-active');\n\t\t\tDom.toggleClass(this.element, 'ui-link-secondary');\n\t\t\tDom.toggleClass(this.element, 'ui-link-dashed');\n\n\t\t\tthis.emit('deactivateGroupMode');\n\t\t}\n\t}\n\n\tonClick(element: HTMLElement)\n\t{\n\t\tDom.toggleClass(element, 'tasks-scrum-group-actions');\n\t\tDom.toggleClass(element, 'tasks-scrum-group-actions-active');\n\t\tDom.toggleClass(element, 'ui-link-secondary');\n\t\tDom.toggleClass(element, 'ui-link-dashed');\n\t\tif (element.classList.contains('tasks-scrum-group-actions-active'))\n\t\t{\n\t\t\tthis.emit('activateGroupMode');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('deactivateGroupMode');\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.element);\n\t\tthis.element = null;\n\t}\n}","import {Tag} from 'main.core';\nimport {Entity} from './entity';\nimport {Item} from '../item/item';\n\nexport class ListItems\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tthis.entity = entity;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-items-list\" data-entity-id=\"${this.entity.getId()}\">\n\t\t\t\t${this.entity.isCompleted() ? '' : this.entity.getInput().render()}\n\t\t\t\t${[...this.entity.getItems().values()].map((item: Item) => {\n\t\t\t\t\titem.setEntityType(this.entity.getEntityType());\n\t\t\t\t\treturn item.render();\n\t\t\t\t})}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.node;\n\t}\n\n\tgetNode(): HTMLElement|null\n\t{\n\t\treturn this.node;\n\t}\n\n\tsetEntityId(entityId: number)\n\t{\n\t\tthis.node.dataset.entityId = parseInt(entityId, 10);\n\t}\n}","import {Dialog} from 'ui.entity-selector';\nimport {Loc, Tag, Text} from 'main.core';\nimport {Input} from './input';\nimport {EventEmitter} from 'main.core.events';\n\nimport type {EpicType} from '../item/item';\n\nexport class TagSearcher extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.TagSearcher');\n\n\t\tthis.allTags = new Map();\n\t}\n\n\taddTagToSearcher(tagName)\n\t{\n\t\ttagName = tagName.trim();\n\t\tthis.allTags.set('tag_' + tagName, {\n\t\t\tid: tagName,\n\t\t\tentityId: 'tag',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: tagName,\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag.svg'\n\t\t});\n\t}\n\n\taddEpicToSearcher(epic: EpicType)\n\t{\n\t\tconst epicName = epic.name.trim();\n\t\tthis.allTags.set('epic_' + epicName, {\n\t\t\tid: epic.id,\n\t\t\tentityId: 'epic',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: epicName.trim(),\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag-green.svg',\n\t\t\tname: epicName.trim(),\n\t\t\tdescription: epic.description,\n\t\t\tinfo: epic.info\n\t\t});\n\t}\n\n\tgetTagFromSearcher(name: String): Object\n\t{\n\t\treturn this.allTags.get(name);\n\t}\n\n\tremoveEpicFromSearcher(epic: Object)\n\t{\n\t\tthis.allTags.delete('epic_' + epic.name);\n\t}\n\n\tgetAllList(): Array\n\t{\n\t\treturn [...this.allTags.values()];\n\t}\n\n\tgetTagsList(): Array\n\t{\n\t\tconst tagsList = [];\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'tag')\n\t\t\t{\n\t\t\t\ttagsList.push(tag);\n\t\t\t}\n\t\t});\n\t\treturn tagsList;\n\t}\n\n\tgetEpicList(): Array\n\t{\n\t\tconst epicList = [];\n\t\t[...this.allTags.values()].forEach((epic) => {\n\t\t\tif (epic.entityId === 'epic')\n\t\t\t{\n\t\t\t\tepicList.push(epic);\n\t\t\t}\n\t\t});\n\t\treturn epicList;\n\t}\n\n\tgetEpicByName(epicName: string): EpicType|null\n\t{\n\t\tlet epic = null;\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'epic' && tag.name === epicName)\n\t\t\t{\n\t\t\t\tepic = tag;\n\t\t\t}\n\t\t});\n\t\treturn epic;\n\t}\n\n\tshowTagsDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentTags = item.getTags();\n\n\t\tconst selectedItems = [];\n\t\tcurrentTags.forEach((tag) => {\n\t\t\tconst currentTag = this.allTags.get(('tag_' + tag).trim());\n\t\t\tif (currentTag)\n\t\t\t{\n\t\t\t\tselectedItems.push(currentTag);\n\t\t\t}\n\t\t});\n\n\t\tconst createTag = () => {\n\t\t\tconst tagName = this.tagDialog.getTagSelector().getTextBoxValue();\n\t\t\tif (!tagName)\n\t\t\t{\n\t\t\t\tthis.tagDialog.focusSearch();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.addTagToSearcher(tagName);\n\t\t\tconst newTag = this.getTagFromSearcher('tag_' + tagName);\n\t\t\tconst item = this.tagDialog.addItem(newTag);\n\t\t\titem.select();\n\t\t\tthis.tagDialog.getTagSelector().clearTextBox();\n\t\t\tthis.tagDialog.focusSearch();\n\t\t\tthis.tagDialog.selectFirstTab();\n\t\t\tconst label = this.tagDialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\tlabel.textContent = '';\n\t\t};\n\n\t\tlet choiceWasMade = false;\n\n\t\tthis.tagDialog = new Dialog({\n\t\t\tid: item.getItemId(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: true,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getTagsList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst tag = selectedItem.getTitle();\n\t\t\t\t\tthis.emit('attachTagToTask', tag);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst deselectedItem = event.getData().item;\n\t\t\t\t\tconst tag = deselectedItem.getTitle();\n\t\t\t\t\tthis.emit('deAttachTagToTask', tag);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonInput: (event) => {\n\t\t\t\t\t\tconst selector = event.getData().selector;\n\t\t\t\t\t\tif (selector)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst dialog = selector.getDialog();\n\t\t\t\t\t\t\tconst label = dialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\t\t\t\t\tlabel.textContent = Text.encode(selector.getTextBoxValue());\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tfooter: [\n\t\t\t\tTag.render`\n\t\t\t\t\t<span onclick=\"${createTag}\" class=\"ui-selector-footer-link ui-selector-footer-link-add\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SEARCHER_ACTIONS_TAG_ADD')}\n\t\t\t\t\t</span>\n\t\t\t\t`,\n\t\t\t\tTag.render`<span class=\"ui-selector-footer-conjunction\"></span>`\n\t\t\t],\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(this.tagDialog.getContainer());\n\t\tthis.tagDialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t\tthis.emit('hideTagDialog');\n\t\t\t}\n\t\t});\n\n\t\tthis.tagDialog.show();\n\t}\n\n\tshowEpicDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst actionsPanel = item.getCurrentActionsPanel();\n\t\tconst currentEpic = item.getEpic();\n\n\t\tconst selectedItems = [];\n\t\tif (currentEpic)\n\t\t{\n\t\t\tconst currentEpicInfo = this.allTags.get(('epic_' + currentEpic.name).trim());\n\t\t\tif (currentEpicInfo)\n\t\t\t{\n\t\t\t\tselectedItems.push(currentEpicInfo);\n\t\t\t}\n\t\t}\n\n\t\tlet choiceWasMade = false;\n\n\t\tconst dialog = new Dialog({\n\t\t\tid: item.getItemId(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getEpicList(),\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst epicId = selectedItem.getId();\n\t\t\t\t\tthis.emit('updateItemEpic', epicId);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\t\tif (dialog.getSelectedItems().length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('updateItemEpic', 0);\n\t\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 50);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tplaceholder: Loc.getMessage('TASKS_SCRUM_ITEM_EPIC_SEARCHER_PLACEHOLDER')\n\t\t\t}\n\t\t});\n\n\t\tactionsPanel.setBlockBlurNode(dialog.getContainer());\n\t\tdialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tactionsPanel.destroy();\n\t\t\t}\n\t\t});\n\t\tdialog.show();\n\t}\n\n\tshowTagsSearchDialog(inputObject: Input, enteredHashTagName: String): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.tagsDialog && this.tagsDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.tagsDialog = null;\n\t\t}\n\n\t\tif (!this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getTagsList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashTag = '#' + selectedItem.getTitle();\n\t\t\t\t\t\tconst hashTags = TagSearcher.getHashTagsFromText(input.value);\n\t\t\t\t\t\tconst enteredHashTag = (hashTags.length > 0 ? hashTags.pop().trim() : '');\n\t\t\t\t\t\tinput.value = input.value.replace(\n\t\t\t\t\t\t\tnew RegExp('#(['+enteredHashTag+']+|)(?:$)', 'g'),\n\t\t\t\t\t\t\tselectedHashTag\n\t\t\t\t\t\t);\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.tagsDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setTagsSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setTagsSearchMode(true);\n\n\t\tthis.tagsDialog.show();\n\t\tthis.tagsDialog.search(enteredHashTagName);\n\t}\n\n\tcloseTagsSearchDialog()\n\t{\n\t\tif (this.tagsDialog)\n\t\t{\n\t\t\tthis.tagsDialog.hide();\n\t\t}\n\t}\n\n\tshowEpicSearchDialog(inputObject: Input, enteredHashEpicName: String): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.epicDialog && this.epicDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.epicDialog = null;\n\t\t}\n\n\t\tif (!this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\titems: this.getEpicList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst selectedHashEpic = '@' + selectedItem.getTitle();\n\t\t\t\t\t\tinput.value = input.value.replace(new RegExp('(?:^|\\\\s)(?:@)([^\\\\s]*)','g'),'');\n\t\t\t\t\t\tinput.value = input.value + ' ' + selectedHashEpic\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t\tinputObject.setEpicId(selectedItem.getId());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.epicDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setEpicSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setEpicSearchMode(true);\n\n\t\tthis.epicDialog.show();\n\t\tthis.epicDialog.search(enteredHashEpicName);\n\t}\n\n\tcloseEpicSearchDialog()\n\t{\n\t\tif (this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog.hide();\n\t\t}\n\t}\n\n\tcleanEpicTagsInText(inputText: String): String\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:@)(\\\\S+)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashTagsFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:#)(\\\\S+)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashEpicFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:@)(\\\\S+)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashTagNamesFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:#)(\\\\S+|)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[1]);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tstatic getHashEpicNamesFromText(inputText: String): Array\n\t{\n\t\tconst regex = new RegExp('(?:^|\\\\s)(?:@)(\\\\S+|)', 'g');\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[1]);\n\t\t}\n\t\treturn matches;\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {TagSearcher} from './tag.searcher';\nimport {EventEmitter} from 'main.core.events';\n\nimport '../css/input.css';\n\nexport class Input extends EventEmitter\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Input');\n\n\t\tthis.nodeId = Text.getRandom();\n\t\tthis.placeholder = Loc.getMessage('TASKS_SCRUM_TASK_ADD_INPUT_TASK_PLACEHOLDER');\n\n\t\tthis.epicId = 0;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${Text.encode(this.nodeId)}\" class=\"tasks-scrum-input\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox\">\n\t\t\t\t\t<input type=\"text\" class=\"ui-ctl-element\" placeholder=\n\t\t\t\t\t\t\"${Text.encode(this.placeholder)}\" autocomplete=\"off\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdisable()\n\t{\n\t\tthis.node.querySelector('input').disabled = true;\n\t}\n\n\tunDisable()\n\t{\n\t\tthis.node.querySelector('input').disabled = false;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.setNode();\n\n\t\tEvent.bind(this.getInputNode(), 'input', (event) => {\n\t\t\tthis.onTagSearch(event);\n\t\t\tthis.onEpicSearch(event);\n\t\t});\n\t\tEvent.bind(this.getInputNode(), 'keydown', this.onKeydown.bind(this));\n\t}\n\n\tsetNode()\n\t{\n\t\tthis.node = document.getElementById(this.nodeId);\n\t}\n\n\tsetPlaceholder(placeholder: String)\n\t{\n\t\tthis.placeholder = placeholder;\n\t}\n\n\tsetEpicId(parentId)\n\t{\n\t\tthis.epicId = parseInt(parentId, 10);\n\t}\n\n\tgetNode(): HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetNodeId(): String\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tgetInputNode(): HTMLElement\n\t{\n\t\treturn this.node.querySelector('input');\n\t}\n\n\tgetEpicId()\n\t{\n\t\treturn this.epicId;\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t}\n\n\tsetTagsSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-tag-disabled', value);\n\t}\n\n\tisTagsSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-tag-disabled');\n\t}\n\n\tsetEpicSearchMode(value: Boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-epic-disabled', value);\n\t}\n\n\tisEpicSearchMode(): Boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-epic-disabled');\n\t}\n\n\tonTagSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashTags = TagSearcher.getHashTagNamesFromText(inputNode.value);\n\t\tif (event.data === '#')\n\t\t{\n\t\t\tthis.setEpicSearchMode(false);\n\t\t\tthis.setTagsSearchMode(true);\n\t\t}\n\t\tif (enteredHashTags.length > 0 && this.isTagsSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashTags.pop().trim();\n\t\t\tthis.emit('tagsSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('tagsSearchClose');\n\t\t}\n\t}\n\n\tonEpicSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashEpics = TagSearcher.getHashEpicNamesFromText(inputNode.value);\n\t\tif (event.data === '@')\n\t\t{\n\t\t\tthis.setTagsSearchMode(false);\n\t\t\tthis.setEpicSearchMode(true);\n\t\t}\n\t\tif (enteredHashEpics.length > 0 && this.isEpicSearchMode())\n\t\t{\n\t\t\tconst enteredHashTagName = enteredHashEpics.pop().trim();\n\t\t\tthis.emit('epicSearchOpen', enteredHashTagName);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('epicSearchClose');\n\t\t}\n\t}\n\n\tonCreateTaskItem()\n\t{\n\t\tif (!this.isTagsSearchMode() && !this.isEpicSearchMode())\n\t\t{\n\t\t\tconst input = this.getInputNode();\n\t\t\tif (input.value)\n\t\t\t{\n\t\t\t\tthis.emit('createTaskItem', input.value);\n\t\t\t\tinput.value = '';\n\t\t\t\tinput.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tonKeydown(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tthis.onCreateTaskItem();\n\t\t}\n\t}\n}","import {Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Item} from '../item/item';\nimport {GroupActionsButton} from './group.actions.button';\nimport {ListItems} from './list.items';\n\nimport {Input} from '../utility/input';\nimport {StoryPoints} from '../utility/story.points';\n\nimport type {Views} from '../view/view';\n\nimport '../css/entity.css';\n\ntype EntityParams = {\n\tid: number,\n\tviews?: Views,\n\tnumberTasks?: number,\n\tisExactSearchApplied: 'Y' | 'N'\n};\n\nexport class Entity extends EventEmitter\n{\n\tconstructor(params: EntityParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Entity');\n\n\t\tthis.setEntityParams(params);\n\n\t\tthis.storyPoints = new StoryPoints();\n\n\t\tthis.items = new Map();\n\n\t\tthis.groupMode = false;\n\t\tthis.groupModeItems = new Map();\n\n\t\tthis.node = null;\n\t\tthis.groupActionsButton = null;\n\t\tthis.listItems = null;\n\n\t\tthis.input = new Input();\n\t}\n\n\tsetEntityParams(params: EntityParams)\n\t{\n\t\tthis.setId(params.id);\n\t\tthis.setViews(params.views);\n\t\tthis.setNumberTasks(params.numberTasks);\n\n\t\tthis.exactSearchApplied = (params.isExactSearchApplied === 'Y');\n\t}\n\n\taddGroupActionsButton(groupActionsButton: GroupActionsButton)\n\t{\n\t\tthis.groupActionsButton = groupActionsButton;\n\t\tthis.groupActionsButton.subscribe('activateGroupMode', this.onActivateGroupMode.bind(this));\n\t\tthis.groupActionsButton.subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t}\n\n\taddListItems(listItems: ListItems)\n\t{\n\t\tthis.listItems = listItems;\n\t}\n\n\tgetListItems(): ListItems|null\n\t{\n\t\treturn this.listItems;\n\t}\n\n\tgetNode(): HTMLElement|null\n\t{\n\t\treturn this.node;\n\t}\n\n\tsetId(id: number)\n\t{\n\t\tthis.id = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\n\t\tif (this.listItems)\n\t\t{\n\t\t\tthis.listItems.setEntityId(this.id);\n\t\t}\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetViews(views)\n\t{\n\t\tthis.views = (Type.isPlainObject(views) ? views : {});\n\t}\n\n\tgetViews()\n\t{\n\t\treturn this.views;\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'entity';\n\t}\n\n\tisActive()\n\t{\n\t\treturn false;\n\t}\n\n\tisCompleted()\n\t{\n\t\treturn false;\n\t}\n\n\tgetListItemsNode(): HTMLElement|null\n\t{\n\t\treturn (this.listItems ? this.listItems.getNode() : null);\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn (this.items.size === 0);\n\t}\n\n\tgetItems(): Map\n\t{\n\t\treturn this.items;\n\t}\n\n\trecalculateItemsSort()\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tif (!listItemsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet sort = 1;\n\t\tlistItemsNode.querySelectorAll('.tasks-scrum-item').forEach((node: HTMLElement) => {\n\t\t\tconst item = this.getItems().get(parseInt(node.dataset.itemId, 10));\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.setSort(sort);\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\t}\n\n\tgetInput(): Input\n\t{\n\t\treturn this.input;\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tthis.items.set(newItem.getItemId(), newItem);\n\t\tthis.subscribeToItem(newItem);\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\n\t\tthis.addNumberTasks(1);\n\t}\n\n\tsetItemMoveActivity(item: Item)\n\t{\n\t\titem.setMoveActivity(this.items.size > 2);\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tif (this.items.has(item.getItemId()))\n\t\t{\n\t\t\tthis.items.delete(item.getItemId());\n\t\t\titem.unsubscribeAll();\n\t\t\t[...this.items.values()].map((item) => {\n\t\t\t\tthis.setItemMoveActivity(item);\n\t\t\t});\n\n\t\t\tthis.subtractNumberTasks(1);\n\t\t}\n\t}\n\n\tisNodeCreated(): boolean\n\t{\n\t\treturn (this.node !== null);\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tthis.numberTasks = (Type.isInteger(numberTasks) ? parseInt(numberTasks, 10) : 0);\n\t}\n\n\tgetNumberTasks(): number\n\t{\n\t\treturn (this.numberTasks ? this.numberTasks : this.getItems().size);\n\t}\n\n\taddNumberTasks(value: number)\n\t{\n\t\tif (!Type.isUndefined(value) && !isNaN(parseInt(value, 10)))\n\t\t{\n\t\t\tthis.numberTasks = (this.numberTasks + parseInt(value, 10));\n\t\t}\n\t}\n\n\tsubtractNumberTasks(value: number)\n\t{\n\t\tif (!Type.isUndefined(value) && !isNaN(parseInt(value, 10)))\n\t\t{\n\t\t\tthis.numberTasks = (this.numberTasks - parseInt(value, 10));\n\t\t}\n\t}\n\n\thasInput(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tsetExactSearchApplied(value: boolean)\n\t{\n\t\tthis.exactSearchApplied = Boolean(value);\n\t}\n\n\tisExactSearchApplied(): boolean\n\t{\n\t\treturn this.exactSearchApplied;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.subscribeToItem(item);\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.input.onAfterAppend();\n\t\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t\t\tthis.input.subscribe('epicSearchOpen', (baseEvent) => {\n\t\t\t\tthis.emit('epicSearchOpen', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tenteredHashEpicName: baseEvent.getData()\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.input.subscribe('epicSearchClose', () => this.emit('epicSearchClose'));\n\t\t\tthis.input.subscribe('createTaskItem', (baseEvent) => {\n\t\t\t\tthis.emit('createTaskItem', {\n\t\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\t\tvalue: baseEvent.getData()\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.updateStoryPoints();\n\t}\n\n\tsubscribeToItem(item: Item)\n\t{\n\t\tif (!this.getListItemsNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.onAfterAppend(this.getListItemsNode());\n\n\t\titem.setEntityType(this.getEntityType());\n\n\t\titem.subscribe('updateItem', (baseEvent) => {\n\t\t\tthis.emit('updateItem', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('updateStoryPoints', () => this.updateStoryPoints());\n\n\t\titem.subscribe('showTask', (baseEvent) => this.emit('showTask', baseEvent.getTarget()));\n\n\t\titem.subscribe('move', (baseEvent) => {\n\t\t\tthis.emit('moveItem', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('moveToSprint', (baseEvent) => {\n\t\t\tthis.emit('moveToSprint', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('attachFilesToTask', (baseEvent) => {\n\t\t\tthis.emit('attachFilesToTask', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tattachedIds: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('showTagSearcher', (baseEvent) => {\n\t\t\tthis.emit('showTagSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\titem.subscribe('showEpicSearcher', (baseEvent) => {\n\t\t\tthis.emit('showEpicSearcher', {\n\t\t\t\titem: baseEvent.getTarget(),\n\t\t\t\tbutton: baseEvent.getData()\n\t\t\t})\n\t\t});\n\n\t\titem.subscribe('startDecomposition', (baseEvent) => {\n\t\t\tthis.emit('startDecomposition', baseEvent.getTarget())\n\t\t});\n\n\t\titem.subscribe('remove', (baseEvent) => {\n\t\t\tif (this.isGroupMode())\n\t\t\t{\n\t\t\t\tthis.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\tthis.removeItem(groupModeItem);\n\t\t\t\t\tgroupModeItem.removeYourself();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst item = baseEvent.getTarget();\n\t\t\t\tthis.removeItem(item);\n\t\t\t\titem.removeYourself();\n\t\t\t}\n\t\t\tthis.emit('removeItem', item);\n\t\t});\n\n\t\titem.subscribe('changeTaskResponsible', (baseEvent) => {\n\t\t\tconst item = baseEvent.getTarget();\n\t\t\tthis.emit('changeTaskResponsible', item);\n\t\t});\n\n\t\titem.subscribe('filterByEpic', (baseEvent) => {\n\t\t\tthis.emit('filterByEpic', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('filterByTag', (baseEvent) => {\n\t\t\tthis.emit('filterByTag', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('addItemToGroupMode', (baseEvent) => {\n\t\t\tthis.addItemToGroupMode(baseEvent.getTarget());\n\t\t});\n\n\t\titem.subscribe('removeItemFromGroupMode', (baseEvent) => {\n\t\t\tthis.removeItemFromGroupMode(baseEvent.getTarget());\n\t\t});\n\t}\n\n\tupdateStoryPoints()\n\t{\n\t\tthis.storyPoints.clearPoints();\n\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\tthis.storyPoints.addPoints(item.getStoryPoints().getPoints());\n\t\t});\n\t}\n\n\taddTotalStoryPoints(item: Item) {}\n\n\tsubtractTotalStoryPoints(item: Item) {}\n\n\tgetItemByItemId(itemId: number|string): Item|undefined\n\t{\n\t\treturn this.items.get((Type.isInteger(itemId) ? parseInt(itemId, 10) : itemId));\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tisFirstItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\tconst firstElementChild = (\n\t\t\tthis.hasInput() ? listItemsNode.firstElementChild.nextElementSibling : listItemsNode.firstElementChild\n\t\t)\n\t\treturn firstElementChild.isEqualNode(itemNode);\n\t}\n\n\tisLastItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getItemNode();\n\t\treturn listItemsNode.lastElementChild.isEqualNode(itemNode);\n\t}\n\n\tfadeOut()\n\t{\n\t\tthis.getListItemsNode().classList.add('tasks-scrum-entity-items-faded');\n\t}\n\n\tfadeIn()\n\t{\n\t\tthis.getListItemsNode().classList.remove('tasks-scrum-entity-items-faded');\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tthis.groupActionsButton.deactivateGroupMode();\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tthis.groupMode = true;\n\n\t\tthis.input.disable();\n\n\t\tthis.emit('activateGroupMode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tthis.groupMode = false;\n\n\t\tthis.input.unDisable();\n\n\t\tthis.groupModeItems.forEach((item: Item) => {\n\t\t\titem.deactivateGroupMode();\n\t\t});\n\t\tthis.groupModeItems.clear();\n\n\t\tthis.emit('deactivateGroupMode');\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\taddItemToGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.set(item.getItemId(), item);\n\t}\n\n\tgetGroupModeItems(): Map\n\t{\n\t\treturn this.groupModeItems;\n\t}\n\n\tremoveItemFromGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.delete(item.getItemId());\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Entity} from '../entity';\n\nexport class Header extends EventEmitter\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tsuper(entity);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.BacklogHeader');\n\n\t\tthis.entity = entity;\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<div class=\"tasks-scrum-backlog-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-epics-title ui-btn ui-btn-xs ui-btn-secondary\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_EPICS_TITLE')}\n\t\t\t</div>\n\t\t\t<div title=\"Definition of Done\" class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-dod\">\n\t\t\t\t<span class=\"tasks-scrum-entity-dod-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-title-spacer\"></div>\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-task\">\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-title\">\n\t\t\t\t\t${this.entity.getNumberTasks()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-story-point-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE_STORY_POINTS')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-backlog-story-point\">\n\t\t\t\t${Text.encode(this.entity.getStoryPoints().getPoints())}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.getElementByClassName(this.element, 'tasks-scrum-backlog-epics-title'), 'click', () => {\n\t\t\tthis.emit('openListEpicGrid');\n\t\t});\n\n\t\tEvent.bind(this.getElementByClassName(this.element, 'tasks-scrum-entity-title-btn-dod'), 'click', () => {\n\t\t\tthis.emit('openDefinitionOfDone');\n\t\t});\n\n\t\treturn this.element;\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tthis.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-backlog-story-point'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tupdateNumberTasks()\n\t{\n\t\tconst parentNode = this.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-entity-title-btn-task'\n\t\t);\n\t\tparentNode.querySelector('.tasks-scrum-entity-tasks-title').textContent = this.entity.getNumberTasks();\n\t}\n\n\tgetElementByClassName(elements: HTMLElement[], className: string): HTMLElement\n\t{\n\t\tlet element = null;\n\t\telements.forEach((elem) => {\n\t\t\tif (elem.classList.contains(className))\n\t\t\t{\n\t\t\t\telement = elem;\n\t\t\t}\n\t\t});\n\t\treturn element;\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class EpicCreationButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.EpicCreationButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst element = Tag.render`\n\t\t\t<a class=\"ui-link ui-link-dashed ui-link-secondary tasks-scrum-action-epic\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(element, 'click', this.onClick.bind(this));\n\n\t\treturn element;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('openAddEpicForm')\n\t}\n}","import {Dom, Tag} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Entity} from '../entity';\nimport {Header} from './header';\nimport {EpicCreationButton} from './epic.creation.button';\nimport {GroupActionsButton} from '../group.actions.button';\nimport {ListItems} from '../list.items';\nimport {Item} from '../../item/item';\n\nimport type {ItemParams} from '../../item/item';\n\nimport '../../css/backlog.css';\n\nexport type BacklogParams = {\n\tid: number,\n\titems?: Array<ItemParams>\n};\n\nexport class Backlog extends Entity\n{\n\tconstructor(params: BacklogParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Backlog');\n\n\t\tthis.setBacklogParams(params);\n\n\t\tthis.header = null;\n\t\tthis.epicCreationButton = null;\n\t}\n\n\tsetBacklogParams(params: BacklogParams)\n\t{\n\t\tparams.items.forEach((itemData) => {\n\t\t\tconst item = new Item(itemData);\n\t\t\tthis.items.set(item.itemId, item);\n\t\t});\n\t}\n\n\tstatic buildBacklog(backlogData: BacklogParams): Backlog\n\t{\n\t\tconst backlog = new Backlog(backlogData);\n\t\tbacklog.addHeader(new Header(backlog));\n\t\tbacklog.addEpicCreationButton(new EpicCreationButton());\n\t\tbacklog.addGroupActionsButton(new GroupActionsButton());\n\t\tbacklog.addListItems(new ListItems(backlog));\n\t\treturn backlog;\n\t}\n\n\taddHeader(header: Header)\n\t{\n\t\tthis.header = header;\n\t\tthis.header.subscribe('openListEpicGrid', () => this.emit('openListEpicGrid'));\n\t\tthis.header.subscribe('openDefinitionOfDone', () => this.emit('openDefinitionOfDone'));\n\t}\n\n\taddEpicCreationButton(epicCreationButton: EpicCreationButton)\n\t{\n\t\tthis.epicCreationButton = epicCreationButton;\n\t\tthis.epicCreationButton.subscribe('openAddEpicForm', () => this.emit('openAddEpicForm'));\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'backlog';\n\t}\n\n\tisDisabled()\n\t{\n\t\treturn false;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-backlog\">\n\t\t\t\t<div class=\"tasks-scrum-backlog-header\">\n\t\t\t\t\t${this.header ? this.header.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-backlog-actions\">\n\t\t\t\t\t${this.epicCreationButton ? this.epicCreationButton.render() : ''}\n\t\t\t\t\t${this.groupActionsButton ? this.groupActionsButton.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-backlog-items\">\n\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\treturn this.node;\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tsuper.setItem(newItem);\n\n\t\tthis.updateStoryPoints();\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tsuper.removeItem(item);\n\n\t\tthis.updateStoryPoints();\n\t}\n\n\taddNumberTasks(value: number)\n\t{\n\t\tsuper.addNumberTasks(value);\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.updateNumberTasks();\n\t\t}\n\t}\n\n\tsubtractNumberTasks(value: number)\n\t{\n\t\tsuper.subtractNumberTasks(value);\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.updateNumberTasks();\n\t\t}\n\t}\n\n\tupdateStoryPoints()\n\t{\n\t\tsuper.updateStoryPoints();\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.setStoryPoints(this.getStoryPoints().getPoints());\n\t\t}\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onActivateGroupMode(baseEvent);\n\n\t\tDom.addClass(this.node.querySelector('.tasks-scrum-backlog-items'), 'tasks-scrum-backlog-items-group-mode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onDeactivateGroupMode(baseEvent);\n\n\t\tDom.removeClass(this.node.querySelector('.tasks-scrum-backlog-items'), 'tasks-scrum-backlog-items-group-mode');\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\n\nexport class SprintDate extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintDate');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.nodeId = 'tasks-scrum-sprint-header-date-' + Text.getRandom();\n\t\tthis.defaultSprintDuration = sprint.getDefaultSprintDuration();\n\t}\n\n\tcreateDate(startTimestamp, endTimestamp)\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\t/* eslint-disable */\n\t\tconst dateStart = BX.date.format('j F', startTimestamp);\n\t\tconst dateEnd = BX.date.format('j F', endTimestamp);\n\t\t/* eslint-enable */\n\n\t\treturn this.renderNode(this.nodeId, dateStart, dateEnd);\n\t}\n\n\trenderNode(nodeId: string, dateStart: string, dateEnd: string): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"${nodeId}\" class=\"tasks-scrum-sprint-date\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-start\">${dateStart}</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-separator\">-</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-date-end\">${dateEnd}</div>\n\t\t\t\t<input type=\"hidden\" name=\"dateStart\">\n\t\t\t\t<input type=\"hidden\" name=\"dateEnd\">\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\t\tdateStartNode.textContent = BX.date.format('j F', timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\t\tdateEndNode.textContent = BX.date.format('j F', timestamp);\n\t\t}\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.node = document.getElementById(this.nodeId);\n\t\tconst parentPopup = this.node.closest('.popup-window');\n\n\t\tconst customBlur = () => {\n\t\t\tBX.calendar.get().popup.close();\n\t\t};\n\n\t\tconst showCalendar = (node, field) => {\n\t\t\t/* eslint-disable */\n\t\t\tBX.calendar({\n\t\t\t\tnode: node,\n\t\t\t\tfield: field,\n\t\t\t\tbTime: false,\n\t\t\t\tbSetFocus: false,\n\t\t\t\tbHideTime: false\n\t\t\t});\n\t\t\t/* eslint-enable */\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.bindOnce(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t};\n\n\t\tconst updateDateNode = (node, value) => {\n\t\t\t/* eslint-disable */\n\t\t\tnode.textContent = BX.date.format('j F', Math.floor(BX.parseDate(value).getTime() / 1000));\n\t\t\t/* eslint-enable */\n\t\t};\n\t\tconst sendRequest = (data) => {\n\t\t\tthis.emit('changeSprintDeadline', data);\n\t\t};\n\n\t\tconst dateStartNode = this.node.querySelector('.tasks-scrum-sprint-date-start');\n\t\tconst dateEndNode = this.node.querySelector('.tasks-scrum-sprint-date-end');\n\t\tconst dateStartInput = this.node.querySelector('input[name=\"dateStart\"]');\n\t\tconst dateEndInput = this.node.querySelector('input[name=\"dateEnd\"]');\n\n\t\tEvent.bind(this.node, 'click', (event) => {\n\t\t\tconst target = event.target;\n\t\t\tif (target.classList.contains('tasks-scrum-sprint-date-start'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateStartInput);\n\t\t\t}\n\t\t\telse if (target.classList.contains('tasks-scrum-sprint-date-end'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateEndInput);\n\t\t\t}\n\t\t\tevent.stopPropagation();\n\t\t});\n\t\tEvent.bind(dateStartInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateStartNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateStart: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t\tEvent.bind(dateEndInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateEndNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateEnd: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetWeeks()\n\t{\n\t\tconst weekCount = (parseInt(this.defaultSprintDuration, 10) / 604800);\n\t\tif (weekCount > 5)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_3');\n\t\t}\n\t\telse if (weekCount === 1)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_2');\n\t\t}\n\t}\n}","export class StatsCalculator\n{\n\tcalculatePercentage(first: number, second: number): number\n\t{\n\t\tconst result = Math.round(second * 100 / first);\n\t\treturn (isNaN(result) ? 0 : result);\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\nimport {StatsCalculator} from '../../utility/stats.calculator';\n\nexport class StatsHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.StatsHeader');\n\n\t\tthis.setSprintData(sprint);\n\n\t\tthis.statsCalculator = new StatsCalculator();\n\n\t\tthis.weekendDaysTime = sprint.getWeekendDaysTime();\n\n\t\tthis.headerNode = null;\n\t\tthis.headerClass = 'tasks-scrum-sprint-header-stats';\n\n\t\tthis.kanbanMode = false;\n\t}\n\n\tsetKanbanStyle()\n\t{\n\t\tthis.kanbanMode = true;\n\t\tthis.headerClass = 'tasks-scrum-sprint-header-stats-kanban';\n\t}\n\n\tisKanbanMode(): boolean\n\t{\n\t\treturn this.kanbanMode;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn '';\n\t}\n\n\tupdateStats(sprint: Sprint)\n\t{\n\t\tthis.setSprintData(sprint);\n\n\t\tDom.replace(this.headerNode, this.render());\n\t}\n\n\tsetSprintData(sprint: Sprint)\n\t{\n\t\tthis.setStoryPoints(sprint.getTotalStoryPoints().getPoints());\n\t\tthis.setCompletedStoryPoints(sprint.getTotalCompletedStoryPoints().getPoints());\n\t\tthis.setUncompletedStoryPoints(sprint.getTotalUncompletedStoryPoints().getPoints());\n\t\tthis.setEndDate(sprint.getDateEnd());\n\t}\n\n\tsetStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.storyPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.storyPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetStoryPoints(): number\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tsetCompletedStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.completedStoryPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.completedStoryPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetCompletedStoryPoints(): number\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetUncompletedStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.uncompletedStoryPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.uncompletedStoryPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetUncompletedStoryPoints(): number\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetEndDate(endDate)\n\t{\n\t\tif (Type.isUndefined(endDate) || isNaN(parseInt(endDate, 10)))\n\t\t{\n\t\t\tthis.endDate = (Date.now() / 1000);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.endDate = parseInt(endDate, 10);\n\t\t}\n\t}\n\n\tgetEndDate(): number\n\t{\n\t\treturn this.endDate;\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class CompletedStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tconst completedDate = this.getCompletedDate(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_COMPLETED_LABEL').\n\t\t\treplace('#percent#', '<b>' + percentage + '%</b>').\n\t\t\treplace('#date#', completedDate);\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetCompletedDate(endDate: number): string\n\t{\n\t\treturn BX.date.format('j F Y', endDate);\n\t};\n}","import {Loc, Tag} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class ExpiredStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\t\tconst expiredDay = this.getExpiredDay(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_EXPIRED_LABEL').\n\t\t\treplace('#percent#', '<b>' + percentage + '%</b>').\n\t\t\treplace('#date#', expiredDay);\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetExpiredDay(endDate: number): string\n\t{\n\t\treturn BX.date.format('j F Y', endDate);\n\t};\n}","import {Loc, Tag, Type} from 'main.core';\nimport {StatsHeader} from './stats.header';\n\nexport class ActiveStatsHeader extends StatsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\tconst remainingDays = this.getRemainingDays(this.getEndDate());\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tlet label = '';\n\t\tif (Type.isInteger(remainingDays) && remainingDays <= 1)\n\t\t{\n\t\t\tlabel = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LAST_LABEL')\n\t\t\t\t.replace('#percent#', '<b>' + percentage + '%</b>')\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabel = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LABEL')\n\t\t\t\t.replace('#days#', '<b>' + remainingDays + '</b>')\n\t\t\t\t.replace('#percent#', '<b>' + percentage + '%</b>')\n\t\t\t;\n\t\t}\n\n\t\tthis.headerNode = Tag.render`\n\t\t\t<div class=\"${this.headerClass}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.headerNode;\n\t}\n\n\tgetRemainingDays(endDate: number): string|number\n\t{\n\t\tconst dateWithWeekendOffset = new Date();\n\t\tdateWithWeekendOffset.setSeconds(dateWithWeekendOffset.getSeconds() + this.weekendDaysTime);\n\n\t\tconst dateEnd = new Date(endDate * 1000);\n\n\t\tconst msPerMinute = 60 * 1000;\n\t\tconst msPerHour = msPerMinute * 60;\n\t\tconst msPerDay = msPerHour * 24;\n\n\t\tconst daysRemaining = Math.round((dateEnd - dateWithWeekendOffset) / msPerDay);\n\n\t\tif (daysRemaining <= 1)\n\t\t{\n\t\t\treturn daysRemaining;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.date.format('ddiff', dateWithWeekendOffset, dateEnd);\n\t\t}\n\t};\n}","import {Sprint} from './sprint';\nimport {StatsHeader} from './stats.header';\nimport {CompletedStatsHeader} from './completed.stats.header';\nimport {ExpiredStatsHeader} from './expired.stats.header';\nimport {ActiveStatsHeader} from './active.stats.header';\n\nexport class StatsHeaderBuilder\n{\n\tstatic build(sprint: Sprint): StatsHeader\n\t{\n\t\tif (sprint.isCompleted())\n\t\t{\n\t\t\treturn new CompletedStatsHeader(sprint);\n\t\t}\n\t\telse if (sprint.isExpired())\n\t\t{\n\t\t\treturn new ExpiredStatsHeader(sprint);\n\t\t}\n\t\telse if (sprint.isActive())\n\t\t{\n\t\t\treturn new ActiveStatsHeader(sprint);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn new StatsHeader(sprint);\n\t\t}\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {SprintDate} from './sprint.date';\nimport {Sprint} from './sprint';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {StatsHeaderBuilder} from './stats.header.builder';\nimport {StatsHeader} from './stats.header';\n\nexport class SprintHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SprintHeader');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\n\t\tthis.statsHeader = null;\n\t\tthis.sprintDate = null;\n\t}\n\n\tstatic buildHeader(sprint: Sprint): SprintHeader\n\t{\n\t\tconst sprintHeader = new SprintHeader(sprint);\n\t\tsprintHeader.addHeaderStats(StatsHeaderBuilder.build(sprint));\n\t\tsprintHeader.addHeaderDate(new SprintDate(sprint));\n\t\treturn sprintHeader;\n\t}\n\n\taddHeaderStats(statsHeader: StatsHeader)\n\t{\n\t\tthis.statsHeader = statsHeader;\n\t}\n\n\taddHeaderDate(sprintDate: SprintDate)\n\t{\n\t\tthis.sprintDate = sprintDate;\n\t\tthis.sprintDate.subscribe('changeSprintDeadline', (baseEvent) => {\n\t\t\tthis.emit('changeSprintDeadline', baseEvent.getData());\n\t\t});\n\t}\n\n\tinitStyle(sprint: Sprint)\n\t{\n\t\tthis.sprint = sprint;\n\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-active';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-success ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_COMPLETE_BUTTON');\n\t\t}\n\t\telse if (this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-completed';\n\t\t\tDom.remove(this.buttonNode);\n\t\t\tthis.sprint.hideContent();\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.headerClass = 'tasks-scrum-sprint-header-planned';\n\t\t\tthis.buttonClass = 'ui-btn ui-btn-primary ui-btn-xs';\n\t\t\tthis.buttonText = Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_START_BUTTON');\n\t\t}\n\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.addHeaderStats(StatsHeaderBuilder.build(this.sprint));\n\t\t\tthis.addHeaderDate(new SprintDate(this.sprint));\n\n\t\t\tif (this.sprint.isDisabled())\n\t\t\t{\n\t\t\t\tDom.remove(this.node.querySelector('.tasks-scrum-sprint-header-remove'));\n\t\t\t}\n\n\t\t\tthis.node.className = '';\n\t\t\tDom.addClass(this.node, 'tasks-scrum-sprint-header ' + this.headerClass);\n\n\t\t\tconst button = this.buttonNode.querySelector('button');\n\t\t\tbutton.className = '';\n\t\t\tDom.addClass(button, this.buttonClass);\n\t\t\tbutton.firstChild.replaceWith(this.buttonText);\n\n\t\t\tDom.replace(this.node.querySelector('.tasks-scrum-sprint-header-params'), this.renderParams());\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header ${this.headerClass}\">\n\t\t\t\t${this.renderDragnDrop()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-name-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-name\">\n\t\t\t\t\t\t${Text.encode(this.sprint.getName())}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-edit\"></div>\n\t\t\t\t${this.renderRemove()}\n\t\t\t\t${this.renderParams()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t};\n\n\trenderParams(): HTMLElement\n\t{\n\t\tconst tickAngleClass = (this.sprint.isCompleted() ? 'ui-btn-icon-angle-down' : 'ui-btn-icon-angle-up');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header-params\">\n\t\t\t\t${this.renderStatsHeader()}\n\t\t\t\t${this.sprintDate ? this.sprintDate.createDate(\n\t\t\t\tthis.sprint.getDateStart(), this.sprint.getDateEnd()) : ''}\n\t\t\t\t${this.createButton()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-header-tick\">\n\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ${tickAngleClass}\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetStatsHeader(): StatsHeader\n\t{\n\t\treturn this.statsHeader;\n\t}\n\n\trenderDragnDrop(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-dragndrop\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-header-empty\"></div>`;\n\t\t}\n\t}\n\n\trenderRemove(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum-sprint-header-remove\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t}\n\n\trenderStatsHeader(): HTMLElement\n\t{\n\t\treturn (this.statsHeader ? this.statsHeader.render() : '');\n\t}\n\n\tupdateNameNode(name: string)\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.node.querySelector('.tasks-scrum-sprint-header-name').textContent = Text.encode(name);\n\t\t}\n\t}\n\n\tupdateStatsHeader()\n\t{\n\t\tthis.statsHeader.updateStats(this.sprint);\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.updateDateStartNode(timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.updateDateEndNode(timestamp);\n\t\t}\n\t}\n\n\tcreateButton()\n\t{\n\t\tif (this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buttonNodeId = 'tasks-scrum-sprint-header-button-' + this.sprint.getId();\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.buttonNodeId}\" class=\"tasks-scrum-sprint-header-button\">\n\t\t\t\t\t<button class=\"${this.buttonClass}\">${this.buttonText}</button>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t};\n\n\tonAfterAppend()\n\t{\n\t\tif (!this.sprint.isCompleted())\n\t\t{\n\t\t\tthis.buttonNode = document.getElementById(this.buttonNodeId);\n\t\t\tEvent.bind(this.buttonNode, 'click', this.onButtonClick.bind(this));\n\t\t}\n\n\t\tconst nameNode = this.node.querySelector('.tasks-scrum-sprint-header-name-container');\n\t\tconst editButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-edit');\n\t\tEvent.bind(editButtonNode, 'click', () => this.emit('changeName', nameNode));\n\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\tconst removeNode = this.node.querySelector('.tasks-scrum-sprint-header-remove');\n\t\t\tEvent.bind(removeNode, 'click', () => {\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_SPRINT'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tthis.emit('removeSprint');\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\tconst tickButtonNode = this.node.querySelector('.tasks-scrum-sprint-header-tick');\n\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-up');\n\t\t\ttickButtonNode.firstElementChild.classList.toggle('ui-btn-icon-angle-down');\n\t\t\tthis.emit('toggleVisibilityContent');\n\t\t});\n\n\t\tif (this.sprintDate)\n\t\t{\n\t\t\tthis.sprintDate.onAfterAppend();\n\t\t}\n\t}\n\n\tonButtonClick()\n\t{\n\t\tif (this.sprint.isActive())\n\t\t{\n\t\t\tthis.emit('completeSprint');\n\t\t}\n\t\telse if (this.sprint.isPlanned())\n\t\t{\n\t\t\tthis.emit('startSprint');\n\t\t}\n\t}\n}","import {Loc, Tag} from 'main.core';\n\nexport class EventsHeader\n{\n\tconstructor()\n\t{\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.element = Tag.render`\n\t\t\t<a class=\"ui-link\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_EVENT')}\n\t\t\t</a>\n\t\t`;\n\n\t\treturn this.element;\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from './sprint';\n\nexport class StoryPointsHeader extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.StoryPointsHeader');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.element = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.totalStoryPointsNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point\">\n\t\t\t\t${this.sprint.getTotalStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.inWorkStoryPointsNode = (this.sprint.isActive() ? Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-in-work-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_IN_WORK')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-in-work\">\n\t\t\t\t${this.sprint.getTotalUncompletedStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t` : '');\n\n\t\tthis.doneStoryPointsNode = (this.sprint.isPlanned() ? '' : Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-story-point-done-title\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_TITLE_STORY_POINTS_DONE')}\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum-sprint-story-point tasks-scrum-sprint-story-point-done\">\n\t\t\t\t${this.sprint.getTotalCompletedStoryPoints().getPoints()}\n\t\t\t</div>\n\t\t`);\n\n\t\tthis.element = Tag.render`\n\t\t\t${this.renderBurnDownChartIcon()}\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-task\">\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-icon\"></span>\n\t\t\t\t<span class=\"tasks-scrum-entity-tasks-title\">\n\t\t\t\t\t${this.sprint.getNumberTasks()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t${this.totalStoryPointsNode}\n\t\t\t${this.inWorkStoryPointsNode}\n\t\t\t${this.doneStoryPointsNode}\n\t\t`;\n\n\t\tEvent.bind(this.getElementByClassName(\n\t\t\tthis.element,\n\t\t\t'tasks-scrum-entity-title-btn-burn-down-chart'\n\t\t), 'click', () => this.emit('showSprintBurnDownChart'));\n\n\t\treturn this.element;\n\t}\n\n\trenderBurnDownChartIcon(): HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-entity-title-btn tasks-scrum-entity-title-btn-burn-down-chart\">\n\t\t\t\t<span class=\"tasks-scrum-entity-burn-down-chart-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateNumberTasks()\n\t{\n\t\tconst parentNode = this.getElementByClassName(this.element, 'tasks-scrum-entity-title-btn-task');\n\t\tparentNode.querySelector('.tasks-scrum-entity-tasks-title').textContent = this.sprint.getNumberTasks();\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.totalStoryPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.totalStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tsetCompletedStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.doneStoryPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.doneStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point-done'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tsetUncompletedStoryPoints(storyPoints: string)\n\t{\n\t\tif (!this.inWorkStoryPointsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getElementByClassName(\n\t\t\tthis.inWorkStoryPointsNode,\n\t\t\t'tasks-scrum-sprint-story-point-in-work'\n\t\t).textContent = Text.encode(storyPoints);\n\t}\n\n\tgetElementByClassName(elements: HTMLElement[], className: string): HTMLElement\n\t{\n\t\tlet element = null;\n\t\telements.forEach((elem) => {\n\t\t\tif (elem.classList.contains(className))\n\t\t\t{\n\t\t\t\telement = elem;\n\t\t\t}\n\t\t});\n\t\treturn element;\n\t}\n}","import {Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Entity} from '../entity';\nimport {Item} from '../../item/item';\nimport {SprintHeader} from './sprint.header';\nimport {EventsHeader} from './events.header';\nimport {GroupActionsButton} from '../group.actions.button';\nimport {ListItems} from '../list.items';\nimport {StoryPointsHeader} from './story.points.header';\nimport {StoryPoints} from '../../utility/story.points';\n\nimport type {EpicType, ItemParams} from '../../item/item';\nimport type {Views} from '../../view/view';\n\nimport '../../css/sprint.css';\n\ntype SprintInfo = {\n\tsprintGoal?: string\n}\n\nexport type SprintParams = {\n\tid: number,\n\ttmpId: string,\n\tname: string,\n\tsort: number,\n\tdateStart?: number,\n\tdateEnd?: number,\n\tweekendDaysTime?: number,\n\tdefaultSprintDuration: number,\n\ttotalStoryPoints?: string,\n\ttotalCompletedStoryPoints?: string,\n\ttotalUncompletedStoryPoints?: string,\n\tcompletedTasks?: number,\n\tuncompletedTasks?: number,\n\tstatus?: string,\n\tnumberTasks?: number,\n\titems?: Array<ItemParams>,\n\tinfo?: SprintInfo,\n\tviews: Views\n};\n\nexport class Sprint extends Entity\n{\n\tconstructor(params: SprintParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint');\n\n\t\tthis.setSprintParams(params);\n\n\t\tthis.sprintHeader = null;\n\t\tthis.eventsHeader = null;\n\t\tthis.storyPointsHeader = null;\n\t}\n\n\tsetSprintParams(params: SprintParams)\n\t{\n\t\tthis.setTmpId(params.tmpId);\n\t\tthis.setName(params.name);\n\t\tthis.setSort(params.sort);\n\t\tthis.setDateStart(params.dateStart);\n\t\tthis.setDateEnd(params.dateEnd);\n\t\tthis.setWeekendDaysTime(params.weekendDaysTime);\n\t\tthis.setDefaultSprintDuration(params.defaultSprintDuration);\n\t\tthis.setStatus(params.status);\n\t\tthis.setTotalStoryPoints(params.totalStoryPoints);\n\t\tthis.setTotalCompletedStoryPoints(params.totalCompletedStoryPoints);\n\t\tthis.setTotalUncompletedStoryPoints(params.totalUncompletedStoryPoints);\n\t\tthis.setCompletedTasks(params.completedTasks);\n\t\tthis.setUncompletedTasks(params.uncompletedTasks);\n\t\tthis.setItems(params.items);\n\t\tthis.setInfo(params.info);\n\t}\n\n\tstatic buildSprint(sprintData: SprintParams = {}): Sprint\n\t{\n\t\tconst sprint = new Sprint(sprintData);\n\t\tsprint.addSprintHeader(SprintHeader.buildHeader(sprint));\n\t\tsprint.addEventsHeader(new EventsHeader());\n\t\tsprint.addStoryPointsHeader(new StoryPointsHeader(sprint));\n\t\tsprint.addGroupActionsButton(new GroupActionsButton());\n\t\tsprint.addListItems(new ListItems(sprint));\n\t\treturn sprint;\n\t}\n\n\taddSprintHeader(sprintHeader: SprintHeader)\n\t{\n\t\tthis.sprintHeader = sprintHeader;\n\t\tthis.sprintHeader.initStyle(this);\n\n\t\tthis.sprintHeader.subscribe('changeName', this.onChangeName.bind(this));\n\t\tthis.sprintHeader.subscribe('removeSprint', this.onRemoveSprint.bind(this));\n\t\tthis.sprintHeader.subscribe('completeSprint', () => this.emit('completeSprint'));\n\t\tthis.sprintHeader.subscribe('startSprint', () => this.emit('startSprint'));\n\t\tthis.sprintHeader.subscribe('changeSprintDeadline', this.onChangeSprintDeadline.bind(this));\n\t\tthis.sprintHeader.subscribe('toggleVisibilityContent', this.toggleVisibilityContent.bind(this));\n\t}\n\n\taddStoryPointsHeader(storyPointsHeader: StoryPointsHeader)\n\t{\n\t\tthis.storyPointsHeader = storyPointsHeader;\n\n\t\tthis.storyPointsHeader.subscribe('showSprintBurnDownChart', () => this.emit('showSprintBurnDownChart'));\n\t}\n\n\taddEventsHeader(eventsHeader: EventsHeader)\n\t{\n\t\tthis.eventsHeader = eventsHeader;\n\t}\n\n\tinitStyle()\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.initStyle(this);\n\t\t}\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn (this.getStatus() === 'active');\n\t}\n\n\tisPlanned(): boolean\n\t{\n\t\treturn (this.getStatus() === 'planned');\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn (this.getStatus() === 'completed');\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn (this.isCompleted());\n\t}\n\n\tisExpired(): boolean\n\t{\n\t\tconst sprintEnd = new Date(this.dateEnd * 1000);\n\t\treturn (this.isActive() && (sprintEnd.getTime() < (new Date()).getTime()));\n\t}\n\n\thasInput(): boolean\n\t{\n\t\treturn !this.isDisabled();\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'sprint';\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tsuper.setItem(newItem);\n\t\tnewItem.setDisableStatus(this.isDisabled());\n\t\tthis.updateStoryPoints();\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tsuper.removeItem(item);\n\t\tthis.updateStoryPoints();\n\t}\n\n\tsetName(name)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : '');\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateNameNode(this.name);\n\t\t}\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetTmpId(tmpId: string)\n\t{\n\t\tthis.tmpId = (Type.isString(tmpId) ? tmpId : '');\n\t}\n\n\tgetTmpId(): string\n\t{\n\t\treturn this.tmpId;\n\t}\n\n\tsetSort(sort)\n\t{\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 1);\n\t}\n\n\tgetSort()\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetDateStart(dateStart)\n\t{\n\t\tthis.dateStart = (Type.isInteger(dateStart) ? parseInt(dateStart, 10) : 0);\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateStartNode(this.dateStart);\n\t\t}\n\t}\n\n\tgetDateStart(): number\n\t{\n\t\treturn parseInt(this.dateStart, 10);\n\t}\n\n\tsetDateEnd(dateEnd)\n\t{\n\t\tthis.dateEnd = (Type.isInteger(dateEnd) ? parseInt(dateEnd, 10) : 0);\n\n\t\tif (this.isNodeCreated() && this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateEndNode(this.dateEnd);\n\t\t}\n\t}\n\n\tgetDateEnd(): number\n\t{\n\t\treturn parseInt(this.dateEnd, 10);\n\t}\n\n\tsetWeekendDaysTime(weekendDaysTime)\n\t{\n\t\tthis.weekendDaysTime = (Type.isInteger(weekendDaysTime) ? parseInt(weekendDaysTime, 10) : 0);\n\t}\n\n\tgetWeekendDaysTime(): number\n\t{\n\t\treturn this.weekendDaysTime;\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\treturn this.totalStoryPoints;\n\t}\n\n\tsetTotalStoryPoints(totalStoryPoints)\n\t{\n\t\tthis.totalStoryPoints = new StoryPoints();\n\t\tthis.totalStoryPoints.addPoints(totalStoryPoints);\n\t}\n\n\tgetTotalStoryPoints(): StoryPoints\n\t{\n\t\treturn this.totalStoryPoints;\n\t}\n\n\tsetTotalCompletedStoryPoints(totalCompletedStoryPoints)\n\t{\n\t\tthis.totalCompletedStoryPoints = new StoryPoints();\n\t\tthis.totalCompletedStoryPoints.addPoints(totalCompletedStoryPoints);\n\t}\n\n\tgetTotalCompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.totalCompletedStoryPoints;\n\t}\n\n\tsetTotalUncompletedStoryPoints(totalUncompletedStoryPoints)\n\t{\n\t\tthis.totalUncompletedStoryPoints = new StoryPoints();\n\t\tthis.totalUncompletedStoryPoints.addPoints(totalUncompletedStoryPoints);\n\t}\n\n\tgetTotalUncompletedStoryPoints(): StoryPoints\n\t{\n\t\treturn this.totalUncompletedStoryPoints;\n\t}\n\n\tsetItems(items)\n\t{\n\t\tif (!Type.isArray(items))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titems.forEach((itemParams: ItemParams) => {\n\t\t\tconst item = new Item(itemParams);\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t\tthis.items.set(item.itemId, item);\n\t\t});\n\t}\n\n\tsetInfo(info: SprintInfo)\n\t{\n\t\tthis.info = (Type.isPlainObject(info) ? info : {sprintGoal: ''});\n\t}\n\n\taddNumberTasks(value: number)\n\t{\n\t\tsuper.addNumberTasks(value);\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.updateNumberTasks();\n\t\t}\n\t}\n\n\tsubtractNumberTasks(value: number)\n\t{\n\t\tsuper.subtractNumberTasks(value);\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.updateNumberTasks();\n\t\t}\n\t}\n\n\tsetCompletedTasks(completedTasks)\n\t{\n\t\tthis.completedTasks = (Type.isInteger(completedTasks) ? parseInt(completedTasks, 10) : 0);\n\t}\n\n\tgetCompletedTasks(): number\n\t{\n\t\treturn this.completedTasks;\n\t}\n\n\tsetUncompletedTasks(uncompletedTasks)\n\t{\n\t\tthis.uncompletedTasks = (Type.isInteger(uncompletedTasks) ? parseInt(uncompletedTasks, 10) : 0);\n\t}\n\n\tgetUncompletedTasks(): number\n\t{\n\t\treturn this.uncompletedTasks;\n\t}\n\n\tsetDefaultSprintDuration(defaultSprintDuration)\n\t{\n\t\tthis.defaultSprintDuration = (Type.isInteger(defaultSprintDuration) ? parseInt(defaultSprintDuration, 10) : 0);\n\t}\n\n\tgetDefaultSprintDuration()\n\t{\n\t\treturn this.defaultSprintDuration;\n\t}\n\n\tgetInfo(): SprintInfo\n\t{\n\t\treturn this.info;\n\t}\n\n\tgetEpics(): Map<number, EpicType>\n\t{\n\t\tconst epics = new Map();\n\t\tthis.items.forEach((item: Item) => {\n\t\t\t//todo wtf, why did not Set work?\n\t\t\tif (item.getEpic())\n\t\t\t{\n\t\t\t\tepics.set(item.getEpic().id, item.getEpic());\n\t\t\t}\n\t\t});\n\t\treturn epics;\n\t}\n\n\tgetUncompletedItems(): Map<string, Item>\n\t{\n\t\tconst items = new Map();\n\t\tthis.items.forEach((item: Item) => {\n\t\t\tif (!item.isCompleted())\n\t\t\t{\n\t\t\t\titems.set(item.getItemId(), item);\n\t\t\t}\n\t\t});\n\t\treturn items;\n\t}\n\n\tsetStatus(status)\n\t{\n\t\tconst availableStatus = new Set([\n\t\t\t'planned',\n\t\t\t'active',\n\t\t\t'completed'\n\t\t]);\n\n\t\tthis.status = (availableStatus.has(status) ? status : 'planned');\n\n\t\tthis.initStyle();\n\n\t\tthis.items.forEach((item) => {\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t});\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\tif (this.input)\n\t\t\t{\n\t\t\t\tthis.input.removeYourself();\n\t\t\t}\n\t\t\tif (this.groupActionsButton)\n\t\t\t{\n\t\t\t\tthis.groupActionsButton.removeYourself();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetStatus(): string\n\t{\n\t\treturn this.status;\n\t}\n\n\tupdateYourself(tmpSprint: Sprint)\n\t{\n\t\tif (tmpSprint.getName() !== this.getName())\n\t\t{\n\t\t\tthis.setName(tmpSprint.getName());\n\t\t}\n\t\tif (tmpSprint.getDateStart() !== this.getDateStart())\n\t\t{\n\t\t\tthis.setDateStart(tmpSprint.getDateStart());\n\t\t}\n\t\tif (tmpSprint.getDateEnd() !== this.getDateEnd())\n\t\t{\n\t\t\tthis.setDateEnd(tmpSprint.getDateEnd());\n\t\t}\n\n\t\tthis.setTotalStoryPoints(tmpSprint.getTotalStoryPoints().getPoints());\n\t\tthis.setTotalCompletedStoryPoints(tmpSprint.getTotalCompletedStoryPoints().getPoints());\n\t\tthis.setTotalUncompletedStoryPoints(tmpSprint.getTotalUncompletedStoryPoints().getPoints());\n\n\t\tif (tmpSprint.getStatus() !== this.getStatus())\n\t\t{\n\t\t\tthis.setStatus(tmpSprint.getStatus());\n\t\t}\n\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.addStoryPointsHeader(new StoryPointsHeader(this));\n\t\t\tDom.replace(this.node.querySelector('.tasks-scrum-sprint-header-event-params'), this.renderParams());\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t\tthis.emit('removeSprint');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint\" data-sprint-sort=\"${this.sort}\" data-sprint-id=\"${this.getId()}\">\n\t\t\t\t${this.sprintHeader ? this.sprintHeader.render() : ''}\n\t\t\t\t<div class=\"tasks-scrum-sprint-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sub-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-header-event\">\n\t\t\t\t\t\t\t${this.eventsHeader ? '' : ''/*todo*/}\n\t\t\t\t\t\t\t${this.isCompleted() ? this.renderLinkToCompletedSprint() : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.renderParams()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-actions\">\n\t\t\t\t\t\t${this.groupActionsButton  && !this.isDisabled() ? this.groupActionsButton.render() : ''}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-items\">\n\t\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\trenderParams(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-header-event-params\">\n\t\t\t\t${this.storyPointsHeader ? this.storyPointsHeader.render() : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderLinkToCompletedSprint(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<a href=\"${Text.encode(this.getViews().completedSprint.url)}\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_COMPLETED_SPRINT_LINK')}\n\t\t\t</a>\n\t\t`;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tthis.updateVisibility();\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.onAfterAppend();\n\t\t}\n\n\t\tsuper.onAfterAppend();\n\t}\n\n\tupdateStoryPoints()\n\t{\n\t\tsuper.updateStoryPoints();\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.totalStoryPoints.clearPoints();\n\t\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\t\tthis.totalStoryPoints.addPoints(item.getStoryPoints().getPoints());\n\t\t\t});\n\t\t\tthis.totalCompletedStoryPoints.clearPoints();\n\t\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\t\tif (item.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tthis.totalCompletedStoryPoints.addPoints(item.getStoryPoints().getPoints());\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.totalUncompletedStoryPoints.clearPoints();\n\t\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\t\tif (!item.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tthis.totalUncompletedStoryPoints.addPoints(item.getStoryPoints().getPoints());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tif (this.isActive())\n\t\t\t{\n\t\t\t\tthis.updateActiveSprintStoryPointsHeader();\n\t\t\t}\n\t\t\telse if (this.isCompleted())\n\t\t\t{\n\t\t\t\tthis.storyPointsHeader.setStoryPoints(this.getTotalStoryPoints().getPoints());\n\t\t\t\tthis.storyPointsHeader.setCompletedStoryPoints(this.getTotalCompletedStoryPoints().getPoints());\n\t\t\t}\n\t\t\telse if (this.isPlanned())\n\t\t\t{\n\t\t\t\tthis.storyPointsHeader.setStoryPoints(this.storyPoints.getPoints());\n\t\t\t}\n\t\t}\n\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateStatsHeader();\n\t\t}\n\t}\n\n\taddTotalStoryPoints(item: Item)\n\t{\n\t\tconst itemStoryPoints = item.getStoryPoints().getPoints();\n\n\t\tthis.getTotalStoryPoints().addPoints(itemStoryPoints);\n\t\tif (item.isCompleted())\n\t\t{\n\t\t\tthis.getTotalCompletedStoryPoints().addPoints(itemStoryPoints);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTotalUncompletedStoryPoints().addPoints(itemStoryPoints);\n\t\t}\n\t}\n\n\tsubtractTotalStoryPoints(item: Item)\n\t{\n\t\tconst itemStoryPoints = item.getStoryPoints().getPoints();\n\n\t\tthis.getTotalStoryPoints().subtractPoints(itemStoryPoints);\n\t\tif (item.isCompleted())\n\t\t{\n\t\t\tthis.getTotalCompletedStoryPoints().subtractPoints(itemStoryPoints);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTotalUncompletedStoryPoints().subtractPoints(itemStoryPoints);\n\t\t}\n\t}\n\n\tupdateActiveSprintStoryPointsHeader()\n\t{\n\t\tif (this.storyPointsHeader)\n\t\t{\n\t\t\tthis.storyPointsHeader.setStoryPoints(this.getTotalStoryPoints().getPoints());\n\t\t\tthis.storyPointsHeader.setCompletedStoryPoints(this.getTotalCompletedStoryPoints().getPoints());\n\t\t\tthis.storyPointsHeader.setUncompletedStoryPoints(this.getTotalUncompletedStoryPoints().getPoints());\n\t\t}\n\t}\n\n\tsubscribeToItem(item)\n\t{\n\t\tsuper.subscribeToItem(item);\n\n\t\titem.subscribe('moveToBacklog', (baseEvent) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: baseEvent.getTarget()\n\t\t\t});\n\t\t});\n\n\t\titem.subscribe('updateCompletedStatus', (baseEvent: BaseEvent) => {\n\t\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\t\tif (item.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tthis.setCompletedTasks(this.getCompletedTasks() + 1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.setUncompletedTasks(this.getUncompletedTasks() - 1);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\titem.subscribe('toggleSubTasks', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('toggleSubTasks', baseEvent.getTarget());\n\t\t})\n\t}\n\n\tonChangeName (baseEvent)\n\t{\n\t\tconst createInput = (value) => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input type=\"text\" class=\"tasks-scrum-sprint-header-name\" value=\"${Text.encode(value)}\">\n\t\t\t`;\n\t\t};\n\n\t\tconst inputNode = createInput(this.name);\n\t\tconst nameNode = baseEvent.getData().querySelector('.tasks-scrum-sprint-header-name');\n\n\t\tEvent.bind(inputNode, 'change', (event) => {\n\t\t\tconst newValue = event.target['value'];\n\t\t\tthis.emit('changeSprintName', {\n\t\t\t\tsprintId: this.getId(),\n\t\t\t\tname: newValue\n\t\t\t});\n\t\t\tthis.name = newValue;\n\t\t\tinputNode.blur();\n\t\t}, true);\n\n\t\tconst blockEnterInput = (event) => {\n\t\t\tif (event.isComposing || event.keyCode === 13)\n\t\t\t\tinputNode.blur();\n\t\t};\n\n\t\tEvent.bind(inputNode, 'keydown', blockEnterInput);\n\t\tEvent.bindOnce(inputNode, 'blur', () => {\n\t\t\tEvent.unbind(inputNode, 'keydown', blockEnterInput);\n\t\t\tnameNode.textContent = Text.encode(this.name);\n\t\t\tDom.replace(inputNode, nameNode);\n\t\t}, true);\n\n\t\tDom.replace(nameNode, inputNode);\n\n\t\tinputNode.focus();\n\t\tinputNode.setSelectionRange(this.name.length, this.name.length);\n\t}\n\n\tonRemoveSprint()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: item\n\t\t\t});\n\t\t});\n\t\tthis.removeYourself();\n\t}\n\n\tremoveSprint()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.emit('moveToBacklog', {\n\t\t\t\tsprint: this,\n\t\t\t\titem: item\n\t\t\t});\n\t\t});\n\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t}\n\n\tonChangeSprintDeadline(baseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.emit('changeSprintDeadline', requestData);\n\t\tif (requestData.hasOwnProperty('dateStart'))\n\t\t{\n\t\t\tthis.dateStart = parseInt(requestData.dateStart, 10);\n\t\t}\n\t\telse if (requestData.hasOwnProperty('dateEnd'))\n\t\t{\n\t\t\tthis.dateEnd = parseInt(requestData.dateEnd, 10);\n\t\t}\n\t}\n\n\tupdateDateStartNode(timestamp)\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateStartNode(timestamp);\n\t\t}\n\t}\n\n\tupdateDateEndNode(timestamp)\n\t{\n\t\tif (this.sprintHeader)\n\t\t{\n\t\t\tthis.sprintHeader.updateDateEndNode(timestamp);\n\t\t}\n\t}\n\n\ttoggleVisibilityContent()\n\t{\n\t\tif (this.getContentNode().style.display === 'block')\n\t\t{\n\t\t\tthis.hideContent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showContent();\n\t\t\tif (this.isCompleted() && this.getItems().size === 0)\n\t\t\t{\n\t\t\t\tthis.emit('getSprintCompletedItems');\n\t\t\t}\n\t\t}\n\t}\n\n\tshowContent()\n\t{\n\t\tif (this.getContentNode())\n\t\t{\n\t\t\tthis.getContentNode().style.display = 'block';\n\t\t}\n\t}\n\n\thideContent()\n\t{\n\t\tif (this.getContentNode())\n\t\t{\n\t\t\tthis.getContentNode().style.display = 'none';\n\t\t}\n\t}\n\n\tupdateVisibility()\n\t{\n\t\tif (this.isCompleted())\n\t\t{\n\t\t\tif (this.isEmpty())\n\t\t\t{\n\t\t\t\tthis.hideContent();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showContent();\n\t\t\t}\n\n\t\t\tthis.showSprint();\n\n\t\t\tif (this.isExactSearchApplied())\n\t\t\t{\n\t\t\t\tif (this.isEmpty())\n\t\t\t\t{\n\t\t\t\t\tthis.hideSprint();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showContent();\n\n\t\t\tif (this.isExactSearchApplied())\n\t\t\t{\n\t\t\t\tif (this.isEmpty())\n\t\t\t\t{\n\t\t\t\t\tthis.hideSprint();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showSprint();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showSprint();\n\t\t\t}\n\t\t}\n\t}\n\n\tshowSprint()\n\t{\n\t\tthis.node.style.display = 'block';\n\t}\n\n\thideSprint()\n\t{\n\t\tthis.node.style.display = 'none';\n\t}\n\n\tonActivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onActivateGroupMode(baseEvent);\n\n\t\tDom.addClass(this.node.querySelector('.tasks-scrum-sprint-items'), 'tasks-scrum-sprint-items-group-mode');\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tsuper.onDeactivateGroupMode(baseEvent);\n\n\t\tDom.removeClass(this.node.querySelector('.tasks-scrum-sprint-items'), 'tasks-scrum-sprint-items-group-mode');\n\t}\n\n\tgetContentNode(): HTMLElement\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\treturn this.node.querySelector('.tasks-scrum-sprint-content');\n\t\t}\n\t}\n}","import {EventEmitter, BaseEvent} from 'main.core.events';\n\nexport class SidePanel extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SidePanel');\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onLoad', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tsidePanel.setCacheable(false);\n\t\t\tthis.emit('onLoadSidePanel', sidePanel);\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tthis.emit('onCloseSidePanel', sidePanel);\n\t\t});\n\t}\n\n\tisPreviousSidePanelExist(currentSidePanel): Boolean\n\t{\n\t\treturn Boolean(this.sidePanelManager.getPreviousSlider(currentSidePanel));\n\t}\n\n\treloadTopSidePanel()\n\t{\n\t\tif (this.sidePanelManager.getTopSlider())\n\t\t{\n\t\t\tthis.sidePanelManager.getTopSlider().reload();\n\t\t}\n\t}\n\n\tcloseTopSidePanel()\n\t{\n\t\tif (this.sidePanelManager.getTopSlider())\n\t\t{\n\t\t\tthis.sidePanelManager.getTopSlider().close();\n\t\t}\n\t}\n\n\treloadPreviousSidePanel(currentSidePanel)\n\t{\n\t\tconst previousSidePanel = this.sidePanelManager.getPreviousSlider(currentSidePanel);\n\t\tpreviousSidePanel.reload();\n\t}\n\n\topenSidePanelByUrl(url)\n\t{\n\t\tthis.sidePanelManager.open(url);\n\t}\n\n\topenSidePanel(id, options)\n\t{\n\t\tthis.sidePanelManager.open(id, options);\n\t}\n}","import {Loc} from 'main.core';\n\ntype Data = {\n\tday: number,\n\tidealValue: number,\n\tremainValue: number\n}\n\n//todo import amchart4 like es6\nexport class BurnDownChart\n{\n\tconstructor(data: Data)\n\t{\n\t\tthis.data = data;\n\t}\n\n\tcreateChart(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\n\t\tthis.createAxises();\n\n\t\tthis.createIdealLine();\n\t\tthis.createRemainLine();\n\n\t\tthis.createLegend();\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst categoryAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\tcategoryAxis.renderer.grid.template.location = 0;\n\t\tcategoryAxis.dataFields.category = 'day';\n\t\tcategoryAxis.renderer.minGridDistance = 60;\n\n\t\tconst valueAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tvalueAxis.min = -0.1;\n\t}\n\n\tcreateIdealLine()\n\t{\n\t\tconst lineSeries = this.chart.series.push(new am4charts.LineSeries());\n\t\tlineSeries.name = Loc.getMessage('TASKS_SCRUM_SPRINT_IDEAL_BURN_DOWN_CHART_LINE_TITLE'); //todo move from class\n\t\tlineSeries.stroke = am4core.color('#2882b3');\n\t\tlineSeries.strokeWidth = 2;\n\n\t\tlineSeries.dataFields.categoryX = 'day';\n\t\tlineSeries.dataFields.valueY = 'idealValue';\n\n\t\tconst circleColor = '#2882b3';\n\t\tconst circleBullet = new am4charts.CircleBullet();\n\t\tcircleBullet.circle.radius = 4;\n\t\tcircleBullet.circle.fill = am4core.color(circleColor);\n\t\tcircleBullet.circle.stroke = am4core.color(circleColor);\n\n\t\tlineSeries.bullets.push(circleBullet);\n\n\t\tconst segment = lineSeries.segments.template;\n\t\tconst hoverState = segment.states.create('hover');\n\t\thoverState.properties.strokeWidth = 4;\n\t}\n\n\tcreateRemainLine()\n\t{\n\t\tconst lineSeries = this.chart.series.push(new am4charts.LineSeries());\n\t\tlineSeries.name = Loc.getMessage('TASKS_SCRUM_SPRINT_REMAIN_BURN_DOWN_CHART_LINE_TITLE'); //todo move from class\n\t\tlineSeries.stroke = am4core.color('#9c1f1f');\n\t\tlineSeries.strokeWidth = 2;\n\n\t\tlineSeries.dataFields.categoryX = 'day';\n\t\tlineSeries.dataFields.valueY = 'remainValue';\n\n\t\tconst circleColor = '#9c1f1f';\n\t\tconst circleBullet = new am4charts.CircleBullet();\n\t\tcircleBullet.circle.radius = 4;\n\t\tcircleBullet.circle.fill = am4core.color(circleColor);\n\t\tcircleBullet.circle.stroke = am4core.color(circleColor);\n\n\t\tlineSeries.bullets.push(circleBullet);\n\n\t\tconst segment = lineSeries.segments.template;\n\t\tconst hoverState = segment.states.create('hover');\n\t\thoverState.properties.strokeWidth = 4;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.itemContainers.template.events.on('over', (event) => {\n\t\t\tthis.processOver(event.target.dataItem.dataContext);\n\t\t});\n\t\tthis.chart.legend.itemContainers.template.events.on('out', () => this.processOut());\n\t}\n\n\tprocessOver(hoveredLine)\n\t{\n\t\thoveredLine.toFront();\n\t\thoveredLine.segments.each((segment) => segment.setState('hover'));\n\t};\n\n\tprocessOut()\n\t{\n\t\tthis.chart.series.each((series) => {\n\t\t\tseries.segments.each((segment) => segment.setState('default'));\n\t\t\tseries.bulletsContainer.setState('default');\n\t\t});\n\t};\n\n\tdestroyBurnDownChart()\n\t{\n\t\tthis.chart.dispose();\n\t}\n}","import {Event, Loc, Runtime, Tag, Text, Dom, Type} from 'main.core';\nimport {Sprint} from './sprint';\nimport {SidePanel} from '../../service/side.panel';\nimport {RequestSender} from '../../utility/request.sender';\nimport {BaseEvent} from 'main.core.events';\nimport {Confetti} from 'ui.confetti';\nimport {StatsCalculator} from '../../utility/stats.calculator';\nimport {BurnDownChart} from '../../utility/burn.down.chart';\n\nimport '../../css/sprint.side.panel.css';\n\ntype Params = {\n\tsprints?: Map,\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender,\n\tviews: {\n\t\tplan: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tactiveSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tcompletedSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t}\n\t}\n};\n\ntype EpicInfoType = {\n\tcolor: string\n}\n\ntype EpicType = {\n\tid: number,\n\tname: string,\n\tdescription: string,\n\tinfo: EpicInfoType\n}\n\ntype RequestDataToStartSprint = {\n\tsprintId: number,\n\tsprintGoal: string\n}\n\ntype RequestDataToCompleteSprint = {\n\tsprintId: number,\n\tdirection: number|string\n}\n\ntype RequestDataToGetBurnDownChartData = {\n\tsprintId: number\n}\n\nexport class SprintSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sprints = params.sprints ? params.sprints : new Map();\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.views = params.views;\n\n\t\tthis.currentSprint = null;\n\t\tthis.uncompletedItems = new Map();\n\n\t\tthis.lastCompletedSprint = this.getLastCompletedSprint(this.sprints);\n\t}\n\n\tshowStartSidePanel(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-start-' + Text.getRandom();\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadStartPanel.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildStartPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000,\n\t\t\twidth: 600\n\t\t});\n\t}\n\n\tshowCompleteSidePanel(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-start-' + Text.getRandom();\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadCompletePanel.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildCompletePanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000,\n\t\t\twidth: 600\n\t\t});\n\t}\n\n\tshowBurnDownChart(sprint: Sprint)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-burn-down-chart-' + Text.getRandom();\n\n\t\tthis.currentSprint = sprint;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadSprintBurnDownPanel.bind(this));\n\t\tthis.sidePanel.subscribe('onCloseSidePanel', this.onCloseBurnDownChart.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildBurnDownPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildStartPanel(): HTMLElement\n\t{\n\t\tlet differenceStoryPoints = this.currentSprint.getTotalStoryPoints().getPoints();\n\t\tdifferenceStoryPoints = (differenceStoryPoints > 0 ? '+' + differenceStoryPoints : differenceStoryPoints);\n\t\tif (this.lastCompletedSprint)\n\t\t{\n\t\t\tdifferenceStoryPoints = this.getDifferenceStoryPointsBetweenSprints(\n\t\t\t\tthis.currentSprint,\n\t\t\t\tthis.lastCompletedSprint\n\t\t\t);\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_TASK_COUNT_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t\t${parseInt(this.currentSprint.getNumberTasks())}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box tasks-scrum-sprint-sidepanel-info-box-story\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_STORY_POINTS_COUNT_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t\t${Text.encode(this.currentSprint.getTotalStoryPoints().getPoints())}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-extra\">\n\t\t\t\t\t\t\t\t\t${differenceStoryPoints}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_START_EPICS_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-epic-list\">\n\t\t\t\t\t\t\t\t${[...this.currentSprint.getEpics().values()].map((epic: EpicType) => {\n\t\t\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-epic-item\" style=\"background: ${Text.encode(epic.info.color)};\">\n\t\t\t\t\t\t\t\t\t\t\t${Text.encode(epic.name)}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_GOAL_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea ui-ctl-resize-y\">\n\t\t\t\t\t\t\t<textarea class=\"ui-ctl-element\"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadStartPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\n\t\tthis.onLoadStartButtons().then((buttonsContainer: HTMLElement) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', this.onStartSprint.bind(this));\n\t\t});\n\t}\n\n\tbuildCompletePanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t${this.buildSprintGoal()}\n\t\t\t\t${this.buildSprintActions()}\n\t\t\t\t${this.buildSprintPlan()}\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildBurnDownPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_IDEAL_BURN_DOWN_CHART_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-chart\"></div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintGoal(): HTMLElement|string\n\t{\n\t\tconst sprintInfo = this.currentSprint.getInfo();\n\t\tconst sprintGoal = sprintInfo.sprintGoal;\n\t\tif (!sprintGoal)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_GOAL_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-text\">\n\t\t\t\t\t\t${Text.encode(sprintGoal)}\n\t\t\t\t\t </div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintActions(): HTMLElement|string\n\t{\n\t\tconst uncompletedTasks = this.currentSprint.getUncompletedTasks();\n\t\tif (uncompletedTasks === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tlet listSprintsOptions = '';\n\t\tthis.sprints.forEach((sprint) => {\n\t\t\tif (sprint.isPlanned())\n\t\t\t{\n\t\t\t\tlistSprintsOptions += `<option value=\"${sprint.getId()}\">${Text.encode(sprint.getName())}</option>`;\n\t\t\t}\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title tasks-scrum-sprint-sidepanel-title-icon\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-field\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-label\">\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_SELECT')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t<select class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t\t<option value=\"backlog\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_MOVE_SELECTOR_BACKLOG')}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t<option value=\"0\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_POPUP_NEW_SPRINT')}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t${listSprintsOptions}\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-uncompleted\">\n\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-subtitle\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_ACTIONS_ITEM_LIST')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-uncompleted-list\">\n\t\t\t\t\t\t\t${[...this.currentSprint.getUncompletedItems().values()].map((item: Item) => {\n\t\t\t\t\t\t\t\tconst previewItem = item.getPreviewVersion();\n\t\t\t\t\t\t\t\tthis.uncompletedItems.set(previewItem.getItemId(), previewItem);\n\t\t\t\t\t\t\t\treturn previewItem.render();\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildSprintPlan(): HTMLElement\n\t{\n\t\tconst statsCalculator = new StatsCalculator();\n\t\tconst percentage = statsCalculator.calculatePercentage(\n\t\t\tthis.currentSprint.getTotalStoryPoints().getPoints(),\n\t\t\tthis.currentSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\tlet differencePercentage = statsCalculator.calculatePercentage(\n\t\t\tthis.currentSprint.getTotalStoryPoints().getPoints(),\n\t\t\tthis.currentSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\t\tif (this.lastCompletedSprint)\n\t\t{\n\t\t\tdifferencePercentage = this.getDifferencePercentageBetweenSprints(\n\t\t\t\tthis.currentSprint,\n\t\t\t\tthis.lastCompletedSprint\n\t\t\t);\n\t\t}\n\n\t\tconst percentageNodeClass = (differencePercentage > 0 ? '' : 'tasks-scrum-sprint-sidepanel-info-dif-min');\n\t\tconst absoluteValue = Math.abs(differencePercentage);\n\t\tconst speedInfoMessage = (differencePercentage > 0 ?\n\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED_UP').replace('#value#', absoluteValue) :\n\t\t\tLoc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED_DOWN').replace('#value#', absoluteValue)\n\t\t);\n\n\t\tconst renderSpeed = (speedInfoMessage) => {\n\t\t\treturn ''; //todo chart\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-speed\">\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-subtitle\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_TEAM_SPEED')}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-result\">${speedInfoMessage}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-graph\"></div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-block\">\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_PLAN_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-content\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-box tasks-scrum-sprint-sidepanel-info-box-w100\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_COMPLETE_PLAN_DONE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-content\">\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-value\">\n\t\t\t\t\t\t\t\t${percentage}%\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif ${percentageNodeClass}\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-arrow\"></span>\n\t\t\t\t\t\t\t\t<div class=\"tasks-scrum-sprint-sidepanel-info-dif-block\">\n\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-val\">${absoluteValue}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"tasks-scrum-sprint-sidepanel-info-dif-icon\">%</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${renderSpeed()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadCompletePanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\t\tconst itemsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-uncompleted-list');\n\n\t\t[...this.uncompletedItems.values()].map((previewItem: Item) => {\n\t\t\tpreviewItem.onAfterAppend(itemsContainer);\n\t\t\tpreviewItem.subscribe('showTask', () => {\n\t\t\t\tthis.currentSprint.emit('showTask', previewItem);\n\t\t\t});\n\t\t});\n\n\t\tthis.onLoadCompleteButtons().then((buttonsContainer: HTMLElement) => {\n\t\t\tEvent.bind(\n\t\t\t\tbuttonsContainer.querySelector('[name=save]'),\n\t\t\t\t'click',\n\t\t\t\tthis.onCompleteSprint.bind(this, sidePanel)\n\t\t\t);\n\t\t});\n\t}\n\n\tonLoadSprintBurnDownPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-sprint-sidepanel');\n\n\t\tthis.getBurnDownChartData().then((data) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.burnDownChart = new BurnDownChart(data);\n\t\t\t\tthis.burnDownChart.createChart(this.form.querySelector('.tasks-scrum-sprint-sidepanel-chart'));\n\t\t\t}, 300);\n\t\t});\n\t}\n\n\tonCloseBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tif (this.sidePanelId === sidePanel.getUrl())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.burnDownChart.destroyBurnDownChart();\n\t\t\t\tthis.burnDownChart = null;\n\t\t\t}, 300);\n\t\t}\n\t}\n\n\tgetTasksCountLabel(count)\n\t{\n\t\tif (count > 5)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_3');\n\t\t}\n\t\telse if (count === 1)\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn count + ' ' + Loc.getMessage('TASKS_SCRUM_TASK_LABEL_2');\n\t\t}\n\t}\n\n\tgetLastCompletedSprint(sprints: Map): Sprint\n\t{\n\t\treturn [...sprints.values()].find((sprint) => sprint.isCompleted() === true);\n\t}\n\n\tgetDifferenceStoryPointsBetweenSprints(firstSprint: Sprint, secondSprint: Sprint): string\n\t{\n\t\tlet difference = parseFloat(\n\t\t\tfirstSprint.getTotalStoryPoints().getPoints() - secondSprint.getTotalStoryPoints().getPoints()\n\t\t);\n\n\t\tif (Type.isFloat(difference))\n\t\t{\n\t\t\tdifference = difference.toFixed(1);\n\t\t}\n\n\t\tif (difference === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn (difference > 0 ? '+' + difference : difference);\n\t\t}\n\t}\n\n\tgetDifferencePercentageBetweenSprints(firstSprint: Sprint, secondSprint: Sprint): number\n\t{\n\t\tconst statsCalculator = new StatsCalculator();\n\n\t\tconst firstPercentage = statsCalculator.calculatePercentage(\n\t\t\tfirstSprint.getTotalStoryPoints().getPoints(),\n\t\t\tfirstSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\tconst secondPercentage = statsCalculator.calculatePercentage(\n\t\t\tsecondSprint.getTotalStoryPoints().getPoints(),\n\t\t\tsecondSprint.getTotalCompletedStoryPoints().getPoints()\n\t\t);\n\n\t\treturn parseFloat(firstPercentage) - parseFloat(secondPercentage);\n\t}\n\n\tgetStartButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getSprintStartButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetCompleteButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getSprintCompleteButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetBurnDownChartData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getBurnDownChartData(this.getRequestDataToGetBurnDownChartData()).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t})\n\t\t});\n\t}\n\n\tonLoadStartButtons(): Promise\n\t{\n\t\treturn this.getStartButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadCompleteButtons(): Promise\n\t{\n\t\treturn this.getCompleteButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonStartSprint()\n\t{\n\t\tthis.requestSender.startSprint(this.getRequestDataToStartSprint()).then((response) => {\n\t\t\tthis.currentSprint.setStatus('active');\n\t\t\tlocation.href = this.views['activeSprint'].url;\n\t\t}).catch((response) => {\n\t\t\tthis.removeClockIconFromButton();\n\t\t\tthis.requestSender.showErrorAlert(response, Loc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP'));\n\t\t});\n\t}\n\n\tonCompleteSprint(sidePanel)\n\t{\n\t\tthis.requestSender.completeSprint(this.getRequestDataToCompleteSprint()).then((response) => {\n\t\t\tif (Confetti)\n\t\t\t{\n\t\t\t\tConfetti.fire({\n\t\t\t\t\tparticleCount: 400,\n\t\t\t\t\tspread: 80,\n\t\t\t\t\torigin: {\n\t\t\t\t\t\tx: 0.7,\n\t\t\t\t\t\ty: 0.2\n\t\t\t\t\t},\n\t\t\t\t\tzIndex: (sidePanel.getZindex() + 1)\n\t\t\t\t}).then(() => {\n\t\t\t\t\tlocation.href = this.views['plan'].url;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlocation.href = this.views['plan'].url;\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.removeClockIconFromButton();\n\t\t\tthis.requestSender.showErrorAlert(response, Loc.getMessage('TASKS_SCRUM_SPRINT_START_ERROR_TITLE_POPUP'));\n\t\t});\n\t}\n\n\tgetRequestDataToStartSprint(): RequestDataToStartSprint\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\t\trequestData.sprintGoal = this.form.querySelector('textarea').value;\n\n\t\treturn requestData;\n\t}\n\n\tgetRequestDataToCompleteSprint(): RequestDataToCompleteSprint\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\t\tconst directionSelectNode = this.form.querySelector('select');\n\t\trequestData.direction = (directionSelectNode ? directionSelectNode.value : 'backlog');\n\n\t\treturn requestData;\n\t}\n\n\tgetRequestDataToGetBurnDownChartData(): RequestDataToGetBurnDownChartData\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.sprintId = this.currentSprint.getId();\n\n\t\treturn requestData;\n\t}\n\n\tremoveClockIconFromButton()\n\t{\n\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-sprint-sidepanel-buttons');\n\t\tif (buttonsContainer)\n\t\t{\n\t\t\tDom.removeClass(buttonsContainer.querySelector('[name=save]'), 'ui-btn-wait');\n\t\t}\n\t}\n}","import {Entity} from '../entity/entity';\nimport {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\n\nexport class EntityStorage\n{\n\tconstructor()\n\t{\n\t\tthis.backlog = null;\n\t\tthis.sprints = new Map();\n\t}\n\n\taddBacklog(backlog: Backlog)\n\t{\n\t\tif (!(backlog instanceof Backlog))\n\t\t{\n\t\t\tthrow new Error('EntityStorage: Backlog is in wrong format');\n\t\t}\n\n\t\tthis.backlog = backlog;\n\t}\n\n\taddSprint(sprint: Sprint)\n\t{\n\t\tthis.sprints.set(sprint.getId(), sprint);\n\t}\n\n\tremoveSprint(sprintId: number)\n\t{\n\t\tthis.sprints.delete(sprintId);\n\t}\n\n\tgetBacklog(): Backlog\n\t{\n\t\tif (this.backlog === null)\n\t\t{\n\t\t\tthrow new Error('EntityStorage: Backlog not found');\n\t\t}\n\n\t\treturn this.backlog;\n\t}\n\n\tgetSprints(): Map<number, Sprint>\n\t{\n\t\treturn this.sprints;\n\t}\n\n\tgetSprintsAvailableForFilling(entityFrom: Entity): Set<Sprint>\n\t{\n\t\tconst sprints = new Set();\n\n\t\tthis.sprints.forEach((sprint: Sprint) => {\n\t\t\tif (!sprint.isCompleted() && entityFrom.getId() !== sprint.getId())\n\t\t\t{\n\t\t\t\tsprints.add(sprint);\n\t\t\t}\n\t\t});\n\n\t\treturn sprints;\n\t}\n\n\tgetAllEntities(): Map<number, Entity>\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(this.backlog.getId(), this.backlog);\n\n\t\t[...this.sprints.values()].map((sprint) => entities.set(sprint.getId(), sprint));\n\n\t\treturn entities;\n\t}\n\n\tgetAllItems(): Map<number, Item>\n\t{\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\t[...this.sprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn items;\n\t}\n\n\trecalculateItemsSort()\n\t{\n\t\tthis.backlog.recalculateItemsSort();\n\t\tthis.sprints.forEach((sprint) => sprint.recalculateItemsSort());\n\t}\n\n\tfindEntityByEntityId(entityId: number): Entity\n\t{\n\t\tentityId = parseInt(entityId, 10);\n\n\t\tif (this.backlog.getId() === entityId)\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === entityId);\n\t}\n\n\tfindItemByItemId(itemId: number): Item\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn backlogItems.get(itemId);\n\t\t}\n\n\t\tconst sprint = [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t\tif (sprint)\n\t\t{\n\t\t\treturn sprint.getItems().get(itemId);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindItemBySourceId(sourceId: number): Item\n\t{\n\t\tsourceId = parseInt(sourceId, 10);\n\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\t[...this.sprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn [...items.values()].find((item: Item) => item.getSourceId() === sourceId);\n\t}\n\n\tfindEntityByItemId(itemId: number): Entity\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t}\n}","import {Entity} from '../entity/entity';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage\n}\n\nexport class ItemStyleDesigner\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.listAllUsedColors = new Set();\n\n\t\tthis.updateBorderColorForLinkedItems();\n\t}\n\n\tupdateBorderColorForLinkedItems()\n\t{\n\t\tconst itemIdsToUpdateColor = new Set();\n\t\tthis.entityStorage.getAllItems().forEach((item: Item) => {\n\t\t\tif (item.isLinkedTask() && !item.getBorderColor())\n\t\t\t{\n\t\t\t\titemIdsToUpdateColor.add(item.getItemId());\n\t\t\t}\n\t\t});\n\n\t\tif (itemIdsToUpdateColor.size)\n\t\t{\n\t\t\tthis.getAllUsedColors().then(() => {\n\t\t\t\tconst items = new Map();\n\t\t\t\titemIdsToUpdateColor.forEach((itemId: number) => {\n\t\t\t\t\titems.set(itemId, this.getRandomColor(this.getAllColors()));\n\t\t\t\t});\n\t\t\t\tthis.requestSender.updateBorderColorToLinkedItems({\n\t\t\t\t\titems: Object.fromEntries(items)\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tconst updatedItems = response.data;\n\t\t\t\t\tObject.keys(updatedItems).forEach((itemId: number) => {\n\t\t\t\t\t\tconst borderColor = updatedItems[itemId];\n\t\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\t\titem.setBorderColor(borderColor);\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tgetRandomColorForItemBorder(): Promise\n\t{\n\t\treturn this.getAllUsedColors().then(() => {\n\t\t\treturn this.getRandomColor(this.getAllColors());\n\t\t});\n\t}\n\n\tgetAllColors(): Array\n\t{\n\t\tconst colorPicker = this.getColorPicker();\n\t\tlet allColors = [];\n\t\tcolorPicker.getDefaultColors().forEach((defaultColors) => {\n\t\t\tallColors = [...allColors, ...defaultColors];\n\t\t});\n\n\t\treturn allColors;\n\t}\n\n\tgetRandomColor(allColors: Array): string\n\t{\n\t\tconst randomColor = allColors[Math.floor(Math.random() * allColors.length)];\n\t\tif (this.isThisBorderColorAlreadyUse(randomColor))\n\t\t{\n\t\t\treturn this.getRandomColor(allColors);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn randomColor;\n\t\t}\n\t}\n\n\tisThisBorderColorAlreadyUse(color: string): boolean\n\t{\n\t\tlet isAlreadyUse = false;\n\n\t\tthis.listAllUsedColors.forEach((usedColor: string) => {\n\t\t\tif (usedColor === color)\n\t\t\t{\n\t\t\t\tisAlreadyUse = true;\n\t\t\t}\n\t\t});\n\n\t\treturn isAlreadyUse;\n\t}\n\n\tgetAllUsedColors(): Promise\n\t{\n\t\tconst entityIds = new Set();\n\t\tthis.entityStorage.getAllEntities().forEach((entity: Entity) => {\n\t\t\tif (!entity.isCompleted())\n\t\t\t{\n\t\t\t\tentityIds.add(entity.getId());\n\t\t\t}\n\t\t});\n\n\t\treturn this.requestSender.getAllUsedItemBorderColors({\n\t\t\tentityIds: [...entityIds.values()]\n\t\t}).then((response) => {\n\t\t\tthis.listAllUsedColors = new Set([response.data]);\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tgetColorPicker()\n\t{\n\t\t/* eslint-disable */\n\t\treturn new BX.ColorPicker();\n\t\t/* eslint-enable */\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Draggable} from 'ui.draganddrop.draggable';\n\nimport {Sprint} from '../entity/sprint/sprint';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tdefaultSprintDuration: number\n}\n\nexport class DomBuilder extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DomBuilder');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.defaultSprintDuration = params.defaultSprintDuration;\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tthis.scrumContainer = container;\n\n\t\tthis.append(this.entityStorage.getBacklog().render(), this.scrumContainer);\n\t\tthis.entityStorage.getBacklog().onAfterAppend();\n\n\t\tthis.append(this.renderSprintsContainer(), this.scrumContainer);\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tsprint.onAfterAppend();\n\t\t});\n\n\t\tthis.sprintCreatingButtonNode = document.getElementById(this.sprintCreatingButtonNodeId);\n\t\tthis.sprintCreatingDropZoneNode = document.getElementById(this.sprintCreatingDropZoneNodeId);\n\t\tthis.sprintListNode = document.getElementById(this.sprintListNodeId);\n\n\t\tEvent.bind(this.sprintCreatingButtonNode, 'click', this.createSprint.bind(this));\n\n\t\tthis.setDraggable();\n\t}\n\n\tgetSprintCreatingDropZoneNode(): HTMLElement\n\t{\n\t\treturn this.sprintCreatingDropZoneNode;\n\t}\n\n\tgetSprintPlannedListNode(): HTMLElement\n\t{\n\t\treturn this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\t}\n\n\tsetDraggable()\n\t{\n\t\tconst itemContainers = [];\n\t\titemContainers.push(this.entityStorage.getBacklog().getListItemsNode());\n\t\tif (this.sprintCreatingDropZoneNode)\n\t\t{\n\t\t\titemContainers.push(this.sprintCreatingDropZoneNode);\n\t\t}\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (!sprint.isDisabled())\n\t\t\t{\n\t\t\t\titemContainers.push(sprint.getListItemsNode());\n\t\t\t}\n\t\t});\n\t\tthis.draggableItems = new Draggable({\n\t\t\tcontainer: itemContainers,\n\t\t\tdraggable: '.tasks-scrum-item-drag', // todo add tmp class\n\t\t\tdragElement: '.tasks-scrum-item',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t\tdelay: 200\n\t\t});\n\t\tthis.draggableItems.subscribe('start', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('itemMoveStart', dragEndEvent);\n\t\t});\n\t\tthis.draggableItems.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('itemMoveEnd', dragEndEvent);\n\t\t});\n\n\t\tthis.draggableSprints = new Draggable({\n\t\t\tcontainer: this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list'),\n\t\t\tdraggable: '.tasks-scrum-sprint',\n\t\t\tdragElement: '.tasks-scrum-sprint-dragndrop',\n\t\t\ttype: Draggable.DROP_PREVIEW,\n\t\t});\n\t\tthis.draggableSprints.subscribe('end', (baseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tthis.emit('sprintMove', dragEndEvent);\n\t\t});\n\t}\n\n\trenderSprintsContainer(): HTMLElement\n\t{\n\t\tconst createCreatingButton = () => {\n\t\t\tthis.sprintCreatingButtonNodeId = 'tasks-scrum-sprint-creating-button';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingButtonNodeId}\" class=\n\t\t\t\t\t\"tasks-scrum-sprint-create ui-btn ui-btn-md ui-btn-themes ui-btn-light-border ui-btn-icon-add\">\n\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD')}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createCreatingDropZone = () => {\n\t\t\tif (this.entityStorage.getSprints().size)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tthis.sprintCreatingDropZoneNodeId = 'tasks-scrum-sprint-creating-drop-zone';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintCreatingDropZoneNodeId}\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-file-drop tasks-scrum-sprint-sprint-add-drop\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t<small>${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_DROP')}</small>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst createSprintsList = () => {\n\t\t\tthis.sprintListNodeId = 'tasks-scrum-sprint-list';\n\t\t\treturn Tag.render`\n\t\t\t\t<div id=\"${this.sprintListNodeId}\" class=\"tasks-scrum-sprint-list\">\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-active-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isActive())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-planned-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isPlanned())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-sprint-completed-list\">\n\t\t\t\t\t\t${[...this.entityStorage.getSprints().values()].map((sprint) => {\n\t\t\t\t\t\t\tif (sprint.isCompleted())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn sprint.render();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-sprints\">\n\t\t\t\t${createCreatingButton()}\n\t\t\t\t${createCreatingDropZone()}\n\t\t\t\t${createSprintsList()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateSprint(): Promise\n\t{\n\t\tthis.remove(this.sprintCreatingDropZoneNode);\n\n\t\tconst countSprints = this.entityStorage.getSprints().size;\n\t\tconst title = Loc.getMessage('TASKS_SCRUM_SPRINT_NAME').replace('%s', countSprints + 1);\n\t\tconst storyPoints = 0;\n\t\tconst dateStart = Math.floor(Date.now() / 1000);\n\t\tconst dateEnd = (Math.floor(Date.now() / 1000) + parseInt(this.defaultSprintDuration, 10));\n\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\t\tconst sort = (sprintListNode.children.length ? sprintListNode.children.length + 1 : 1);\n\n\t\tconst sprint = Sprint.buildSprint({\n\t\t\tname: title,\n\t\t\tsort: sort,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd,\n\t\t\tstoryPoints: storyPoints\n\t\t});\n\t\tthis.append(sprint.render(), sprintListNode);\n\n\t\tconst requestData = {\n\t\t\ttmpId: Text.getRandom(),\n\t\t\tname: title,\n\t\t\tsort: sort,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd\n\t\t};\n\n\t\tthis.emit('beforeCreateSprint', requestData);\n\n\t\treturn this.requestSender.createSprint(requestData).then((response) => {\n\t\t\tsprint.setId(response.data.sprintId);\n\t\t\tsprint.onAfterAppend();\n\t\t\tsprint.getNode().scrollIntoView(true);\n\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\t\t\tthis.emit('createSprint', sprint); //todo move handlers to new classes\n\t\t\treturn sprint;\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tcreateSprintNode(sprint: Sprint)\n\t{\n\t\tthis.remove(this.sprintCreatingDropZoneNode);\n\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-planned-list');\n\n\t\tthis.append(sprint.render(), sprintListNode);\n\n\t\tsprint.onAfterAppend();\n\n\t\tthis.entityStorage.addSprint(sprint);\n\n\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\n\t\tthis.emit('createSprintNode', sprint);\n\t}\n\n\tmoveSprintToActiveListNode(sprint: Sprint)\n\t{\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-active-list');\n\n\t\tthis.append(sprint.getNode(), sprintListNode);\n\t}\n\n\tmoveSprintToCompletedListNode(sprint: Sprint)\n\t{\n\t\tconst sprintListNode = this.sprintListNode.querySelector('.tasks-scrum-sprint-completed-list');\n\n\t\tif (sprintListNode.firstElementChild)\n\t\t{\n\t\t\tthis.insertBefore(sprint.getNode(), sprintListNode.firstElementChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.append(sprint.getNode(), sprintListNode);\n\t\t}\n\t}\n\n\tappend(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tDom.append(current, target);\n\t}\n\n\tinsertBefore(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tDom.insertBefore(current, target);\n\t}\n\n\tremove(element: ?HTMLElement)\n\t{\n\t\tDom.remove(element);\n\t}\n\n\tgetPosition(element: HTMLElement): DOMRect\n\t{\n\t\treturn Dom.getPosition(element);\n\t}\n\n\tappendItemAfterItem(newItemNode: HTMLElement, bindItemNode: HTMLElement)\n\t{\n\t\tif (bindItemNode.nextElementSibling)\n\t\t{\n\t\t\tDom.insertBefore(newItemNode, bindItemNode.nextElementSibling);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newItemNode, bindItemNode.parentElement);\n\t\t}\n\t};\n}","import {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\n\nimport type {ItemParams} from '../item/item';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder\n}\n\nexport class SubTasksManager\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\n\t\tthis.listSubTasks = new Map();\n\t\tthis.visibilityList = new Set();\n\t}\n\n\ttoggleSubTasks(sprint: Sprint, item: Item): Promise\n\t{\n\t\tif (this.listSubTasks.has(item.getItemId()))\n\t\t{\n\t\t\tif (this.isShown(item))\n\t\t\t{\n\t\t\t\tthis.hideSubTaskItems(sprint, item);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showSubTaskItems(sprint, item);\n\t\t\t}\n\n\t\t\titem.toggleSubTasksTick();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.requestSender.getSubTaskItems({\n\t\t\t\tentityId: sprint.getId(),\n\t\t\t\ttaskId: item.getSourceId()\n\t\t\t}).then((response) => {\n\t\t\t\tconst listItemParams = response.data;\n\t\t\t\tconst listSubTaskItems = new Map();\n\t\t\t\tlistItemParams.forEach((itemParams: ItemParams) => {\n\t\t\t\t\tconst subTaskItem = this.buildSubTaskItem(itemParams);\n\t\t\t\t\tlistSubTaskItems.set(subTaskItem.getItemId(), subTaskItem);\n\t\t\t\t});\n\t\t\t\tthis.listSubTasks.set(item.getItemId(), listSubTaskItems);\n\t\t\t\tif (this.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tthis.hideSubTaskItems(sprint, item);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showSubTaskItems(sprint, item);\n\t\t\t\t}\n\t\t\t\titem.toggleSubTasksTick();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t}\n\t}\n\n\tbuildSubTaskItem(itemParams: ItemParams): Item\n\t{\n\t\treturn new Item(itemParams);\n\t}\n\n\tshowSubTaskItems(sprint: Sprint, parentItem: Item)\n\t{\n\t\tconst parentItemNode = parentItem.getItemNode();\n\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\tif (!listSubTasks)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlistSubTasks.forEach((subTaskItem: Item) => {\n\t\t\tsprint.setItem(subTaskItem);\n\t\t\tthis.domBuilder.appendItemAfterItem(subTaskItem.render(), parentItemNode);\n\t\t\tsubTaskItem.onAfterAppend(sprint.getListItemsNode());\n\n\t\t});\n\n\t\tthis.setVisibility(parentItem);\n\t}\n\n\thideSubTaskItems(sprint: Sprint, parentItem: Item)\n\t{\n\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\tif (!listSubTasks)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlistSubTasks.forEach((subTaskItem: Item) => {\n\t\t\tif (subTaskItem.isParentTask())\n\t\t\t{\n\t\t\t\tthis.hideSubTaskItems(sprint, subTaskItem);\n\t\t\t}\n\t\t\tsprint.removeItem(subTaskItem);\n\t\t\tsubTaskItem.removeYourself();\n\t\t});\n\n\t\tthis.cleanVisibility(parentItem);\n\t}\n\n\taddSubTask(parentItem: Item, item: Item)\n\t{\n\t\tif (this.listSubTasks.has(parentItem.getItemId()))\n\t\t{\n\t\t\tconst listSubTasks = this.listSubTasks.get(parentItem.getItemId());\n\t\t\tlistSubTasks.set(item.getItemId(), item);\n\t\t\tthis.listSubTasks.set(parentItem.getItemId(), listSubTasks);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst listSubTasks = new Map();\n\t\t\tlistSubTasks.set(item.getItemId(), item);\n\t\t\treturn this.listSubTasks.set(parentItem.getItemId(), listSubTasks);\n\t\t}\n\t}\n\n\tgetSubTasks(parentItem: Item): Map<number, Item>\n\t{\n\t\treturn this.listSubTasks.get(parentItem.getItemId());\n\t}\n\n\tisShown(item: Item)\n\t{\n\t\treturn this.visibilityList.has(item.getItemId());\n\t}\n\n\tsetVisibility(item: Item)\n\t{\n\t\tthis.visibilityList.add(item.getItemId());\n\t}\n\n\tcleanVisibility(item: Item)\n\t{\n\t\tthis.visibilityList.delete(item.getItemId());\n\t}\n\n\tcleanSubTasks(item: Item)\n\t{\n\t\tthis.listSubTasks.delete(item.getItemId());\n\t}\n}","import {Tag, Dom, Loc, Event, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Entity} from '../../entity/entity';\nimport {Responsible, Item} from '../item';\n\nimport {ItemStyleDesigner} from '../../utility/item.style.designer';\nimport {SubTasksManager} from '../../utility/subtasks.manager';\nimport {Input} from '../../utility/input';\n\nimport '../../css/decomposition.css';\n\ntype Params = {\n\tentity: Entity,\n\titemStyleDesigner: ItemStyleDesigner,\n\tsubTasksCreator: SubTasksManager\n}\n\nexport class Decomposition extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.entity = params.entity;\n\t\tthis.itemStyleDesigner = params.itemStyleDesigner;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Decomposition');\n\n\t\tthis.items = new Set();\n\n\t\tthis.input = new Input();\n\t\tthis.input.setPlaceholder(Loc.getMessage('TASKS_SCRUM_TASK_ADD_DECOMPOSITION_INPUT_PLACEHOLDER'));\n\t\tthis.input.subscribe('tagsSearchOpen', (baseEvent) => {\n\t\t\tthis.emit('tagsSearchOpen', {\n\t\t\t\tinputObject: baseEvent.getTarget(),\n\t\t\t\tenteredHashTagName: baseEvent.getData()\n\t\t\t})\n\t\t});\n\t\tthis.input.subscribe('tagsSearchClose', () => this.emit('tagsSearchClose'));\n\t}\n\n\tdecomposeItem(item: Item)\n\t{\n\t\tthis.addDecomposedItem(item);\n\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tthis.onDecomposeItem(item, item.getItemNode());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!this.subTasksCreator.isShown(item))\n\t\t\t{\n\t\t\t\tthis.subTasksCreator.toggleSubTasks(this.entity, item).then(() => {\n\t\t\t\t\tconst lastSubTask = this.getSubTasks(item)[0];\n\t\t\t\t\tconst targetItemNode = (lastSubTask ? lastSubTask.getItemNode() : item.getItemNode());\n\t\t\t\t\tthis.onDecomposeItem(item, targetItemNode);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst lastSubTask = this.getSubTasks(item)[0];\n\t\t\t\tthis.onDecomposeItem(item, lastSubTask.getItemNode());\n\t\t\t}\n\t\t}\n\t}\n\n\tonDecomposeItem(item: Item, targetItemNode)\n\t{\n\t\tDom.insertAfter(this.input.render(), targetItemNode);\n\t\tthis.input.setNode();\n\n\t\tconst inputNode = this.input.getInputNode();\n\t\tEvent.bind(inputNode, 'input', this.input.onTagSearch.bind(this.input));\n\t\tEvent.bind(inputNode, 'keydown', this.onCreateItem.bind(this));\n\t\tinputNode.focus();\n\n\t\tconst button = this.createButton();\n\t\tDom.insertAfter(button, this.input.getNode());\n\n\t\tEvent.bind(button.querySelector('button'), 'click', () => {\n\t\t\tif (this.isBacklogDecomposition() && this.firstDecomposition() && !item.isLinkedTask())\n\t\t\t{\n\t\t\t\titem.setBorderColor();\n\t\t\t}\n\t\t\tif (!this.isBacklogDecomposition())\n\t\t\t{\n\t\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tthis.subTasksCreator.hideSubTaskItems(this.entity, item);\n\t\t\t\t}\n\t\t\t\tthis.subTasksCreator.cleanSubTasks(item);\n\t\t\t}\n\t\t\tthis.deactivateDecompositionMode();\n\t\t\tthis.input.removeYourself()\n\t\t\tDom.remove(button);\n\t\t});\n\n\t\tthis.setResponsible(item.getResponsible());\n\t}\n\n\tgetSubTasks(parentItem: Item): Array\n\t{\n\t\treturn Array.from(this.subTasksCreator.getSubTasks(parentItem).values());\n\t}\n\n\tgetLastDecomposedItemNode(parentItem: Item): HTMLElement\n\t{\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tconst decomposedItems = this.getDecomposedItems();\n\t\t\tconst lastDecomposedItem = Array.from(decomposedItems).pop();\n\n\t\t\treturn lastDecomposedItem.getItemNode();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst subTasks = this.getSubTasks(parentItem);\n\t\t\tif (subTasks.length)\n\t\t\t{\n\t\t\t\tconst lastSubTask = (this.firstDecomposition() ? subTasks[0] : subTasks.pop());\n\n\t\t\t\treturn lastSubTask.getItemNode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn parentItem.getItemNode();\n\t\t\t}\n\t\t}\n\t}\n\n\tisBacklogDecomposition(): boolean\n\t{\n\t\treturn this.entity.getEntityType() === 'backlog';\n\t}\n\n\taddDecomposedItem(item: Item)\n\t{\n\t\tthis.activateDecompositionMode(item);\n\n\t\titem.subscribe('changeTaskResponsible', this.saveSelectedResponsible.bind(this));\n\n\t\tthis.items.add(item);\n\t}\n\n\tgetDecomposedItems(): Set\n\t{\n\t\treturn this.items;\n\t}\n\n\tactivateDecompositionMode(item: Item)\n\t{\n\t\tif (this.isBacklogDecomposition())\n\t\t{\n\t\t\tthis.itemStyleDesigner.getRandomColorForItemBorder().then((randomColor: string) => {\n\t\t\t\titem.activateDecompositionMode(randomColor);\n\t\t\t\tthis.setBorderColor(item.getBorderColor());\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\titem.activateDecompositionMode();\n\t\t}\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.items.forEach((item) => {\n\t\t\titem.deactivateDecompositionMode();\n\t\t});\n\t\tthis.items.clear();\n\t}\n\n\tcreateButton(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-decomposition-structure\">\n\t\t\t\t<button class=\"ui-btn ui-btn-sm ui-btn-primary\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DECOMPOSITION_BUTTON')}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonCreateItem(event)\n\t{\n\t\tif (event.isComposing || event.keyCode === 13)\n\t\t{\n\t\t\tif (!this.input.isTagsSearchMode())\n\t\t\t{\n\t\t\t\tconst inputNode = event.target;\n\t\t\t\tif (inputNode.value)\n\t\t\t\t{\n\t\t\t\t\tconst parentItem = this.getParentItem();\n\t\t\t\t\tif (this.isBacklogDecomposition())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.firstDecomposition() && !parentItem.isLinkedTask())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('updateParentItem', {\n\t\t\t\t\t\t\t\titemId: parentItem.getItemId(),\n\t\t\t\t\t\t\t\tentityId: parentItem.getEntityId(),\n\t\t\t\t\t\t\t\titemType: parentItem.getItemType(),\n\t\t\t\t\t\t\t\tinfo: parentItem.getInfo()\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.emit('createItem', inputNode.value);\n\t\t\t\t\tinputNode.value = '';\n\t\t\t\t\tinputNode.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfirstDecomposition(): boolean\n\t{\n\t\treturn (this.items.size === 1);\n\t}\n\n\tgetParentItem(): Item\n\t{\n\t\tconst iterator = this.items.values();\n\t\treturn iterator.next().value;\n\t}\n\n\tsaveSelectedResponsible(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getTarget();\n\t\tthis.setResponsible(item.getResponsible());\n\t}\n\n\tgetResponsible(): Responsible\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tsetResponsible(responsible: Responsible)\n\t{\n\t\tthis.responsible = responsible;\n\t}\n\n\tsetBorderColor(color: string)\n\t{\n\t\tthis.borderColor = (Type.isString(color) ? color : '');\n\t}\n\n\tgetBorderColor(): string\n\t{\n\t\treturn this.borderColor;\n\t}\n}","import {Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Filter} from '../service/filter';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\ntype Params = {\n\tfilter: Filter,\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage\n}\n\nexport class FilterHandler extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.filter = params.filter;\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.filter.subscribe('applyFilter', this.onApplyFilter.bind(this));\n\t}\n\n\tonApplyFilter(baseEvent: BaseEvent)\n\t{\n\t\tthis.fadeOutAll();\n\n\t\tconst filterInfo = baseEvent.getData();\n\n\t\tthis.updateExactSearchStatusToEntities();\n\n\t\tthis.requestSender.applyFilter().then(response => {\n\t\t\tfilterInfo.promise.fulfill();\n\n\t\t\tconst filteredItemsData = response.data;\n\n\t\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\tentity.removeItem(item);\n\t\t\t\titem.removeYourself();\n\t\t\t});\n\n\t\t\tfilteredItemsData.forEach((itemData) => {\n\t\t\t\tconst item = Item.buildItem(itemData);\n\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\tDom.append(item.render(), entity.getListItemsNode());\n\t\t\t\tentity.setItem(item);\n\t\t\t\titem.onAfterAppend(entity.getListItemsNode());\n\t\t\t});\n\n\t\t\tthis.entityStorage.getBacklog().updateStoryPoints();\n\t\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\t\tif (!sprint.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tsprint.updateStoryPoints();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.updateVisibilityToEntities();\n\n\t\t\tthis.fadeInAll();\n\t\t}).catch((response) => {\n\t\t\tfilterInfo.promise.reject();\n\n\t\t\tthis.fadeInAll();\n\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tupdateExactSearchStatusToEntities()\n\t{\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.setExactSearchApplied(this.filter.isSearchFieldApplied());\n\t\t});\n\t}\n\n\tupdateVisibilityToEntities()\n\t{\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.updateVisibility();\n\t\t});\n\t}\n\n\tfadeOutAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeOut();\n\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.fadeOut();\n\t\t});\n\t}\n\n\tfadeInAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeIn();\n\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tsprint.fadeIn();\n\t\t});\n\t}\n}","import {Event, Runtime, Tag, Text, Loc, Type, Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Label} from 'ui.label';\n\nimport {Filter} from '../service/filter';\nimport {SidePanel} from '../service/side.panel';\n\nimport {Entity} from '../entity/entity';\n\nimport {RequestSender} from './request.sender';\nimport {EntityStorage} from './entity.storage';\nimport {TagSearcher} from './tag.searcher';\n\nimport type {EpicType} from '../item/item';\n\nimport '../css/epic.css';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tsidePanel: SidePanel,\n\tentity: Entity,\n\tfilter: Filter,\n\ttagSearcher: TagSearcher,\n}\n\nexport class Epic extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Epic');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.entity = params.entity;\n\t\tthis.filter = params.filter;\n\t\tthis.tagSearcher = params.tagSearcher;\n\n\t\tthis.form = null;\n\n\t\tthis.defaultColor = '#69dafc';\n\t\tthis.selectedColor = '';\n\n\t\tthis.currentEpic = null;\n\t}\n\n\tgetCurrentEpic(): ?Object\n\t{\n\t\treturn this.currentEpic;\n\t}\n\n\topenAddForm()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadAddForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildAddForm());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenEditForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadEditForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\t\tresolve(this.buildEditForm());\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenViewForm(epicId: Number)\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadViewForm.bind(this));\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.getEpic(epicId).then((response) => {\n\t\t\t\t\t\tthis.currentEpic = response.data;\n\t\t\t\t\t\tresolve(this.buildViewForm());\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\topenEpicsList()\n\t{\n\t\tthis.id = Text.getRandom();\n\t\tthis.sidePanelId = 'tasks-scrum-epic-' + this.id;\n\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequest.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadListGrid.bind(this));\n\t\t\t\tthis.sidePanel.subscribeOnce('onCloseSidePanel', this.destroyGrid.bind(this));\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(Tag.render`\n\t\t\t\t\t<div class=\"tasks-scrum-epics-list\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-add-button\">\n\t\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-sm\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epics-list-grid\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tonLoadAddForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.currentEpic = null;\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadAddButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.createEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.onAfterCreateEpic(response.data);\n\t\t\t\t\tif (this.sidePanel.isPreviousSidePanelExist(sidePanel))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sidePanel.reloadPreviousSidePanel(sidePanel);\n\t\t\t\t\t\tsidePanel.close();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\t\tthis.openEpicsList();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\t\tresponse,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_CREATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t\tsidePanel.close();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadViewForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadDescription();\n\t\tthis.onLoadFiles();\n\t\tthis.onLoadViewButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\tthis.openEditForm(this.currentEpic.id);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadEditForm(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-epic-form');\n\t\tthis.onLoadEditor();\n\t\tthis.onLoadColorPicker();\n\t\tthis.onLoadEditButtons().then((buttonsContainer) => {\n\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\tthis.requestSender.editEpic(this.getRequestData()).then((response) => {\n\t\t\t\t\tthis.emit('onAfterEditEpic', response);\n\t\t\t\t\tsidePanel.close(false, () => {\n\t\t\t\t\t\tthis.reloadGrid();\n\t\t\t\t\t});\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.removeClockIconFromButton();\n\t\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\t\tresponse,\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_EPIC_UPDATE_ERROR_TITLE_POPUP')\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\treloadGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\tconst gridManager = BX.Main.gridManager.getById(this.gridId);\n\t\t\tif (gridManager)\n\t\t\t{\n\t\t\t\tgridManager.instance.reload();\n\t\t\t}\n\t\t}\n\t\t/* eslint-enable */\n\t}\n\n\tdestroyGrid()\n\t{\n\t\t/* eslint-disable */\n\t\tif (BX && BX.Main && BX.Main.gridManager)\n\t\t{\n\t\t\tconst gridManager = BX.Main.gridManager.getById(this.gridId);\n\t\t\tif (gridManager)\n\t\t\t{\n\t\t\t\tgridManager.instance.destroy();\n\t\t\t}\n\t\t}\n\t\t/* eslint-enable */\n\t}\n\n\tonLoadEditor()\n\t{\n\t\tthis.getDescriptionEditor().then((editorHtml) => {\n\t\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\t\tRuntime.html(descriptionContainer, editorHtml).then(() => {\n\t\t\t\tthis.editor = window.LHEPostForm.getHandler(this.id);\n\t\t\t\twindow.BXHtmlEditor.Get(this.id);\n\t\t\t\tEventEmitter.emit(this.editor.eventNode, 'OnShowLHE', [true]);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.form.querySelector('.tasks-scrum-epic-form-header-title-control').focus();\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t});\n\t}\n\n\tonLoadDescription()\n\t{\n\t\tconst descriptionContainer = this.form.querySelector('.tasks-scrum-epic-form-description');\n\t\tthis.requestSender.getEpicDescription({\n\t\t\tepicId: this.currentEpic.id,\n\t\t\ttext: this.currentEpic.description\n\t\t}).then(response => {\n\t\t\tRuntime.html(descriptionContainer, response.data);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonLoadFiles()\n\t{\n\t\tconst filesContainer = this.form.querySelector('.tasks-scrum-epic-form-files');\n\t\tthis.requestSender.getEpicFiles({\n\t\t\tepicId: this.currentEpic.id\n\t\t}).then(response => {\n\t\t\tRuntime.html(filesContainer, response.data.html);\n\t\t});\n\t}\n\n\tonLoadColorPicker()\n\t{\n\t\tthis.selectedColor = (this.currentEpic ? this.currentEpic.info.color : this.defaultColor);\n\t\tconst colorBlockNode = this.form.querySelector('.tasks-scrum-epic-header-color');\n\t\tEvent.bind(colorBlockNode, 'click', () => {\n\t\t\tconst colorNode = colorBlockNode.querySelector('.tasks-scrum-epic-header-color-current');\n\t\t\tconst picker = this.getColorPicker(colorNode);\n\t\t\tpicker.open();\n\t\t});\n\t}\n\n\tonLoadAddButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadViewButtons(): Promise\n\t{\n\t\treturn this.getViewEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadEditButtons(): Promise\n\t{\n\t\treturn this.getAddEpicFormButtons().then((buttonsHtml) => {\n\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\t\treturn Runtime.html(buttonsContainer, buttonsHtml).then(() => buttonsContainer);\n\t\t});\n\t}\n\n\tonLoadListGrid(baseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\t\tconst form = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list');\n\t\tconst list = sidePanel.getContainer().querySelector('.tasks-scrum-epics-list-grid');\n\n\t\tthis.getEpicsList().then((responseData) => {\n\t\t\tif (responseData.html)\n\t\t\t{\n\t\t\t\tRuntime.html(list, responseData.html);\n\n\t\t\t\tthis.prepareTagsList(list);\n\n\t\t\t\tconst buttonNode = form.querySelector('.tasks-scrum-epic-header-add-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.remove(form.querySelector('.tasks-scrum-epic-header-add-button'));\n\t\t\t\tDom.append(this.getEmptyEpicListForm(), list);\n\t\t\t\tconst buttonNode = list.querySelector('.tasks-scrum-epics-empty-button');\n\t\t\t\tEvent.bind(buttonNode, 'click', () => {\n\t\t\t\t\tthis.openAddForm();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [, eventArgs] = event.getCompatData();\n\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\teventArgs.method = 'POST';\n\n\t\tif (!eventArgs.url)\n\t\t{\n\t\t\teventArgs.url = this.requestSender.getEpicListUrl();\n\t\t}\n\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t\tentityId: this.entity.getId(),\n\t\t\tgridId: this.gridId,\n\t\t\tsignedParameters: this.requestSender.getSignedParameters()\n\t\t};\n\t}\n\n\tgetEpicsList() : Promise\n\t{\n\t\tthis.gridId = 'EntityEpicsGrid_' + this.entity.getId();\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicsList({\n\t\t\t\tentityId: this.entity.getId(),\n\t\t\t\tgridId: this.gridId\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetEpic(id: Number): Promise\n\t{\n\t\treturn this.requestSender.getEpic({id: id});\n\t}\n\n\tbuildAddForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader('', '#69dafc')}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildViewForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_VIEW_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t\t\t${Text.encode(this.currentEpic.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\t\t\"background-color: ${Text.encode(this.currentEpic.info.color)};\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\" style=\"padding: 15px 10px 15px 10px;\"></div>\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-files\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildEditForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form\">\n\t\t\t\t${this.buildFormHeader(Loc.getMessage('TASKS_SCRUM_SPRINT_EDIT_EPIC_FORM_TITLE'))}\n\t\t\t\t<div class=\"tasks-scrum-epic-form-container\">\n\t\t\t\t\t${this.buildFormContainerHeader(this.currentEpic.name, this.currentEpic.info.color)}\n\t\t\t\t\t<div class=\"tasks-scrum-epic-form-body\">\n\t\t\t\t\t\t<div class=\"tasks-scrum-epic-form-description\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEmptyEpicListForm(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epics-empty\">\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-first-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_FIRST_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-image\">\n\t\t\t\t\t<svg width=\"124px\" height=\"123px\" viewBox=\"0 0 124 123\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t\t<g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" opacity=\"0.28\">\n\t\t\t\t\t\t\t<path d=\"M83,105 L83,81.4375 L105,81.4375 L105,18 L17,18 L17,81.4375 L39,81.4375 L39,105 L83,105 Z M10.9411765,0 L113.058824,0 C119.101468,0 124,4.85902727 124,10.8529412 L124,112.147059 C124,118.140973 119.101468,123 113.058824,123 L10.9411765,123 C4.89853156,123 0,118.140973 0,112.147059 L0,10.8529412 C0,4.85902727 4.89853156,0 10.9411765,0 Z M44.0142862,47.0500004 L54.2142857,57.4416671 L79.7142857,32 L87,42.75 L54.2142857,75 L36,57.0833333 L44.0142862,47.0500004 Z\" fill=\"#A8ADB4\" />\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-second-title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EPICS_EMPTY_SECOND_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epics-empty-button\">\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-lg\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_LIST_ACTIONS_EPIC_ADD')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormHeader(title: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-header-title\">\n\t\t\t\t\t${title}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildFormContainerHeader(name: String, color: String): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-epic-form-header\">\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-title\">\n\t\t\t\t\t<input type=\"text\" name=\"name\" value=\"${Text.encode(name)}\" class=\n\t\t\t\t\t\t\"tasks-scrum-epic-form-header-title-control\" placeholder=\n\t\t\t\t\t\t\"${Loc.getMessage('TASKS_SCRUM_SPRINT_ADD_EPIC_NAME_PLACEHOLDER')}\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-epic-form-header-separate\"></div>\n\t\t\t\t<div class=\"tasks-scrum-epic-header-color\">\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-current\" style=\n\t\t\t\t\t\t\"background-color: ${Text.encode(color)};\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-epic-header-color-btn-angle\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetDescriptionEditor(): Promise\n\t{\n\t\tconst requestData = {\n\t\t\teditorId: this.id\n\t\t};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t\trequestData.text = this.currentEpic.description;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getEpicDescriptionEditor(requestData).then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetAddEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getAddEpicFormButtons().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetViewEpicFormButtons(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getViewEpicFormButtonsAction().then(response => {\n\t\t\t\tresolve(response.data.html);\n\t\t\t})\n\t\t});\n\t}\n\n\tgetColorPicker(colorNode)\n\t{\n\t\t/* eslint-disable */\n\t\treturn new BX.ColorPicker({\n\t\t\tbindElement: colorNode,\n\t\t\tdefaultColor: this.selectedColor,\n\t\t\tonColorSelected: (color, picker) => {\n\t\t\t\tthis.selectedColor = color;\n\t\t\t\tcolorNode.style.backgroundColor = color;\n\t\t\t},\n\t\t\tpopupOptions: {\n\t\t\t\tzIndex: 1100,\n\t\t\t\tclassName: 'tasks-scrum-epic-color-popup'\n\n\t\t\t},\n\t\t\tcolors: [\n\t\t\t\t[\"#aae9fc\", \"#bbecf1\", \"#98e1dc\", \"#e3f299\", \"#ffee95\", \"#ffdd93\", \"#dfd3b6\", \"#e3c6bb\"],\n\t\t\t\t[\"#ffad97\", \"#ffbdbb\", \"#ffcbd8\", \"#ffc4e4\", \"#c4baed\", \"#dbdde0\", \"#bfc5cd\", \"#a2a8b0\"]\n\t\t\t]\n\t\t});\n\t\t/* eslint-enable */\n\t}\n\n\tgetRequestData()\n\t{\n\t\tconst requestData = {};\n\n\t\tif (this.currentEpic)\n\t\t{\n\t\t\trequestData.epicId = this.currentEpic.id;\n\t\t}\n\n\t\trequestData.entityId = this.entity.getId();\n\t\trequestData.name = (this.form.querySelector('[name=name]').value).trim();\n\t\trequestData.description = this.editor.oEditor.GetContent();\n\t\trequestData.color = this.selectedColor;\n\t\trequestData.files = this.getAttachmentsFiles();\n\n\t\treturn requestData;\n\t}\n\n\tgetAttachmentsFiles(): Array\n\t{\n\t\tconst files = [];\n\n\t\tif (!this.editor || !Type.isPlainObject(this.editor.arFiles) || !Type.isPlainObject(this.editor.controllers))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\tconst fileControllers = [];\n\t\tObject.values(this.editor.arFiles).forEach((controller) => {\n\t\t\tif(!fileControllers.includes(controller))\n\t\t\t{\n\t\t\t\tfileControllers.push(controller);\n\t\t\t}\n\t\t});\n\n\t\tfileControllers.forEach((fileController) => {\n\t\t\tif (\n\t\t\t\tthis.editor.controllers[fileController] &&\n\t\t\t\tType.isPlainObject(this.editor.controllers[fileController].values)\n\t\t\t)\n\t\t\t{\n\t\t\t\tObject.keys(this.editor.controllers[fileController].values).forEach((fileId) => {\n\t\t\t\t\tif (!files.includes(fileId))\n\t\t\t\t\t{\n\t\t\t\t\t\tfiles.push(fileId);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\n\t\treturn files;\n\t}\n\n\tprepareTagsList(container: HTMLElement)\n\t{\n\t\tconst tagsContainers = container.querySelectorAll('.tasks-scrum-epic-grid-tags');\n\t\ttagsContainers.forEach((tagsContainer) => {\n\t\t\tconst tags = this.getTagsFromNode(tagsContainer);\n\t\t\tDom.clean(tagsContainer);\n\t\t\ttags.forEach((tag) => {\n\t\t\t\tDom.append(this.getTagNode(tag), tagsContainer);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTagsFromNode(node: HTMLElement): Array\n\t{\n\t\tconst tags = [];\n\t\tnode.childNodes.forEach((childNode) => {\n\t\t\ttags.push(childNode.textContent.trim());\n\t\t});\n\t\treturn tags;\n\t}\n\n\tgetTagNode(tag: string): HTMLElement\n\t{\n\t\tconst tagLabel = new Label({\n\t\t\ttext: tag,\n\t\t\tcolor: Label.Color.TAG_LIGHT,\n\t\t\tfill: true,\n\t\t\tsize: Label.Size.SM,\n\t\t\tcustomClass: ''\n\t\t});\n\t\tconst container = tagLabel.getContainer();\n\t\tEvent.bind(container, 'click', () => {\n\t\t\tthis.emit('filterByTag', tag);\n\t\t\tthis.sidePanel.closeTopSidePanel();\n\t\t});\n\t\treturn container;\n\t}\n\n\tremoveClockIconFromButton()\n\t{\n\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-epic-form-buttons');\n\t\tif (buttonsContainer)\n\t\t{\n\t\t\tDom.removeClass(buttonsContainer.querySelector('[name=save]'), 'ui-btn-wait');\n\t\t}\n\t}\n\n\tonAfterCreateEpic(epic: EpicType)\n\t{\n\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\tthis.filter.addItemToListTypeField('EPIC', {\n\t\t\tNAME: epic.name.trim(),\n\t\t\tVALUE: String(epic.id)\n\t\t});\n\t}\n\n\tonAfterUpdateEpic(epic: EpicType)\n\t{\n\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\tconst itemEpic = item.getEpic();\n\t\t\tif (itemEpic && itemEpic.id === epic.id)\n\t\t\t{\n\t\t\t\titem.setEpicAndTags(epic);\n\t\t\t}\n\t\t});\n\n\t\tconst oldEpicInfo = this.getCurrentEpic();\n\t\tif (oldEpicInfo)\n\t\t{\n\t\t\tthis.tagSearcher.removeEpicFromSearcher(oldEpicInfo);\n\t\t}\n\n\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t}\n\n\tonAfterRemoveEpic(epic: EpicType)\n\t{\n\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\tconst itemEpic = item.getEpic();\n\t\t\tif (itemEpic && itemEpic.id === epic.id)\n\t\t\t{\n\t\t\t\titem.setEpicAndTags(null);\n\t\t\t}\n\t\t});\n\t\tthis.tagSearcher.removeEpicFromSearcher(epic);\n\t\tthis.sidePanel.reloadTopSidePanel();\n\t}\n}","import {Loc} from 'main.core';\n\ntype Data = {\n\tsprintName: string,\n\tplan: number,\n\tdone: number\n}\n\n//todo import amchart4 like es6\nexport class TeamSpeedChart\n{\n\tconstructor(data: Data)\n\t{\n\t\tthis.data = data;\n\n\t\tthis.chart = null;\n\t}\n\n\tcreateChart(chartDiv: HTMLElement)\n\t{\n\t\tam4core.useTheme(am4themes_animated);\n\n\t\tthis.chart = am4core.create(chartDiv, am4charts.XYChart);\n\t\tthis.chart.data = this.data;\n\t\tthis.chart.paddingRight = 40;\n\n\t\tthis.chart.scrollbarX = new am4core.Scrollbar();\n\t\tthis.chart.scrollbarX.parent = this.chart.bottomAxesContainer;\n\n\t\tthis.createAxises();\n\n\t\tthis.createColumn('plan', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_PLAN_COLUMN'), '#2882b3');\n\t\tthis.createColumn('done', Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_DONE_COLUMN'), '#9c1f1f');\n\n\t\tthis.createLegend();\n\t}\n\n\tcreateAxises()\n\t{\n\t\tconst xAxis = this.chart.xAxes.push(new am4charts.CategoryAxis());\n\t\txAxis.dataFields.category = 'sprintName';\n\t\txAxis.renderer.grid.template.location = 0;\n\n\t\tconst label = xAxis.renderer.labels.template;\n\t\tlabel.wrap = true;\n\t\tlabel.maxWidth = 120;\n\n\t\tconst yAxis = this.chart.yAxes.push(new am4charts.ValueAxis());\n\t\tyAxis.min = 0;\n\t}\n\n\tcreateColumn(valueY: string, name: string, color: string)\n\t{\n\t\tconst series = this.chart.series.push(new am4charts.ColumnSeries());\n\t\tseries.dataFields.valueY = valueY;\n\t\tseries.dataFields.categoryX = 'sprintName';\n\t\tseries.name = name;\n\t\tseries.stroke = am4core.color(color);\n\t\tseries.fill = am4core.color(color);\n\n\t\t// const bullet = series.bullets.push(new am4charts.LabelBullet())\n\t\t// bullet.dy = 10;\n\t\t// bullet.label.text = '{valueY}';\n\t\t// bullet.label.fill = am4core.color('#ffffff');\n\n\t\treturn series;\n\t}\n\n\tcreateLegend()\n\t{\n\t\tthis.chart.legend = new am4charts.Legend();\n\t\tthis.chart.legend.position = 'bottom';\n\t\tthis.chart.legend.paddingBottom = 20;\n\t\tthis.chart.legend.itemContainers.template.clickable = false;\n\t}\n\n\tdestroyChart()\n\t{\n\t\tthis.chart.dispose();\n\t}\n}","import {Event, Loc, Runtime, Tag, Text} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {SidePanel} from '../service/side.panel';\nimport {RequestSender} from './request.sender';\nimport {TeamSpeedChart} from './team.speed.chart';\nimport {Entity} from '../entity/entity';\n\ntype Params = {\n\tsprints?: Map,\n\tsidePanel: SidePanel,\n\trequestSender: RequestSender\n};\n\nexport class ProjectSidePanel\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sprints = params.sprints ? params.sprints : new Map();\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.requestSender = params.requestSender;\n\t}\n\n\tshowTeamSpeedChart()\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-start-' + Text.getRandom();\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadTeamSpeedChartPanel.bind(this));\n\t\tthis.sidePanel.subscribe('onCloseSidePanel', this.onCloseTeamSpeedChart.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildTeamSpeedPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tshowDefinitionOfDone(entity: Entity)\n\t{\n\t\tthis.sidePanelId = 'tasks-scrum-dod-' + Text.getRandom();\n\n\t\tthis.entity = entity;\n\n\t\tthis.sidePanel.subscribeOnce('onLoadSidePanel', this.onLoadDodPanel.bind(this));\n\n\t\tthis.sidePanel.openSidePanel(this.sidePanelId, {\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(this.buildDodPanel());\n\t\t\t\t});\n\t\t\t},\n\t\t\tzIndex: 1000\n\t\t});\n\t}\n\n\tbuildTeamSpeedPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-project-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-project-side-panel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_TEAM_SPEED_CHART_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-chart\"></div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbuildDodPanel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-project-side-panel\">\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-header\">\n\t\t\t\t\t<span class=\"tasks-scrum-project-side-panel-header-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_HEADER')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-dod-panel\"></div>\n\t\t\t\t<div class=\"tasks-scrum-project-dod-options\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox\">\n\t\t\t\t\t\t<input type=\"checkbox\" class=\"ui-ctl-element dod-items-required\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_DOD_OPTIONS_REQUIRED_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-project-side-panel-buttons\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonLoadTeamSpeedChartPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-project-side-panel');\n\n\t\tthis.getTeamSpeedChartData().then((data) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.teamSpeedChart = new TeamSpeedChart(data);\n\t\t\t\tthis.teamSpeedChart.createChart(this.form.querySelector('.tasks-scrum-project-side-panel-chart'));\n\t\t\t}, 300);\n\t\t});\n\t}\n\n\tonCloseTeamSpeedChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tif (this.sidePanelId === sidePanel.getUrl())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.teamSpeedChart.destroyChart();\n\t\t\t\tthis.teamSpeedChart = null;\n\t\t\t}, 300);\n\t\t}\n\t}\n\n\tonLoadDodPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst sidePanel = baseEvent.getData();\n\n\t\tthis.form = sidePanel.getContainer().querySelector('.tasks-scrum-project-side-panel');\n\n\t\tthis.getDodComponent().then((data) => {\n\t\t\tconst dodContainer = this.form.querySelector('.tasks-scrum-project-dod-panel');\n\t\t\tRuntime.html(dodContainer, data.html);\n\t\t}).then(() => {\n\t\t\tthis.getDodPanelData().then((data) => {\n\t\t\t\tthis.prepareDodOptionsContainer(data);\n\t\t\t});\n\t\t}).then(() => {\n\t\t\tthis.requestSender.getDodButtons().then(response => {\n\t\t\t\tconst buttonsContainer = this.form.querySelector('.tasks-scrum-project-side-panel-buttons');\n\t\t\t\tRuntime.html(buttonsContainer, response.data.html).then(() => {\n\t\t\t\t\tEvent.bind(buttonsContainer.querySelector('[name=save]'), 'click', () => {\n\t\t\t\t\t\tthis.requestSender.saveDod(this.getRequestDataForSaveList())\n\t\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\tsidePanel.close();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTeamSpeedChartData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getTeamSpeedChartData().then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDodComponent(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getDodComponent({\n\t\t\t\tentityId: this.entity.getId()\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDodPanelData(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.requestSender.getDodPanelData({\n\t\t\t\tentityId: this.entity.getId()\n\t\t\t}).then(response => {\n\t\t\t\tresolve(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(\n\t\t\t\t\tresponse,\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP')\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetRequestDataForSaveList()\n\t{\n\t\tconst requestData = {};\n\n\t\trequestData.entityId = this.entity.getId();\n\t\trequestData.items = this.getEntityChecklistItems();\n\t\trequestData.required = this.getDodItemsRequired();\n\n\t\treturn requestData;\n\t}\n\n\tgetEntityChecklistItems(): Array\n\t{\n\t\t/* eslint-disable */\n\t\tif (typeof BX.Tasks.CheckListInstance === 'undefined')\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst treeStructure = BX.Tasks.CheckListInstance.getTreeStructure();\n\t\treturn treeStructure.getRequestData();\n\t\t/* eslint-enable */\n\t}\n\n\tgetDodItemsRequired(): string\n\t{\n\t\tconst optionsContainer = this.form.querySelector('.tasks-scrum-project-dod-options');\n\t\tconst option = optionsContainer.querySelector('.dod-items-required');\n\n\t\treturn (option.checked === true ? 'Y' : 'N');\n\t}\n\n\tprepareDodOptionsContainer(data)\n\t{\n\t\tif (data['dodItemsRequired'])\n\t\t{\n\t\t\tconst optionsContainer = this.form.querySelector('.tasks-scrum-project-dod-options');\n\t\t\tconst option = optionsContainer.querySelector('.dod-items-required');\n\t\t\toption.checked = (data['dodItemsRequired'] === 'Y');\n\t\t}\n\t}\n}","import {Sprint} from '../entity/sprint/sprint';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\n\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tgroupId: number\n}\n\ntype RemoveParams = {\n\tsprintId: number\n}\n\nexport class PullSprint\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tsprintAdded: this.onSprintAdded.bind(this),\n\t\t\tsprintUpdated: this.onSprintUpdated.bind(this),\n\t\t\tsprintRemoved: this.onSprintRemoved.bind(this)\n\t\t};\n\t}\n\n\tonSprintAdded(params: SprintParams)\n\t{\n\t\tif (this.groupId !== params.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = Sprint.buildSprint(params);\n\n\t\tif (this.needSkipAdd(sprint))\n\t\t{\n\t\t\tthis.cleanSkipAdd(sprint);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.domBuilder.createSprintNode(sprint);\n\t}\n\n\tonSprintUpdated(params: SprintParams)\n\t{\n\t\tconst tmpSprint = Sprint.buildSprint(params);\n\n\t\tif (this.needSkipUpdate(tmpSprint))\n\t\t{\n\t\t\tthis.cleanSkipUpdate(tmpSprint);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = this.entityStorage.findEntityByEntityId(tmpSprint.getId());\n\t\tif (sprint)\n\t\t{\n\t\t\tif (tmpSprint.getStatus() !== sprint.getStatus())\n\t\t\t{\n\t\t\t\tif (tmpSprint.getStatus() === 'active')\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.moveSprintToActiveListNode(sprint);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.moveSprintToCompletedListNode(sprint);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsprint.updateYourself(tmpSprint);\n\t\t}\n\t}\n\n\tonSprintRemoved(params: RemoveParams)\n\t{\n\t\tif (this.needSkipRemove(params.sprintId))\n\t\t{\n\t\t\tthis.cleanSkipRemove(params.sprintId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = this.entityStorage.findEntityByEntityId(params.sprintId);\n\t\tif (sprint)\n\t\t{\n\t\t\tsprint.removeSprint();\n\t\t\tthis.entityStorage.removeSprint(sprint.getId());\n\t\t}\n\t}\n\n\taddTmpIdToSkipAdding(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.add(tmpId);\n\t}\n\n\taddIdToSkipUpdating(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipUpdating.add(sprintId);\n\t}\n\n\taddIdToSkipRemoving(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.add(sprintId);\n\t}\n\n\tneedSkipAdd(sprint: Sprint): boolean\n\t{\n\t\treturn this.listIdsToSkipAdding.has(sprint.getTmpId());\n\t}\n\n\tcleanSkipAdd(sprint: Sprint)\n\t{\n\t\tthis.listIdsToSkipAdding.delete(sprint.getTmpId());\n\t}\n\n\tneedSkipUpdate(sprint: Sprint): boolean\n\t{\n\t\treturn this.listIdsToSkipUpdating.has(sprint.getId());\n\t}\n\n\tcleanSkipUpdate(sprint: Sprint)\n\t{\n\t\tthis.listIdsToSkipUpdating.delete(sprint.getId());\n\t}\n\n\tneedSkipRemove(sprintId: number): boolean\n\t{\n\t\treturn this.listIdsToSkipRemoving.has(sprintId);\n\t}\n\n\tcleanSkipRemove(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.delete(sprintId);\n\t}\n}","import {Loc, Type, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Menu} from 'main.popup';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nimport {Entity} from '../entity/entity';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\nimport {SubTasksManager} from './subtasks.manager';\n\nexport type ItemsSortInfo = {\n\t[id: number]: {\n\t\tsort: number,\n\t\tentityId?: number,\n\t\tupdatedItemId?: number\n\t}\n}\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tsubTasksCreator: SubTasksManager\n}\n\nexport class ItemMover extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\n\t\tthis.bindHandlers();\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.domBuilder.subscribe('itemMoveStart', (baseEvent: BaseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\t\tthis.hideSubTasks(sourceEntity, item);\n\t\t});\n\t\tthis.domBuilder.subscribe('itemMoveEnd', (baseEvent: BaseEvent) => {\n\t\t\tconst dragEndEvent = baseEvent.getData();\n\t\t\tconst endContainer = dragEndEvent.endContainer;\n\t\t\tif (!endContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\n\t\t\tif (sourceEntityId === endEntityId)\n\t\t\t{\n\t\t\t\tthis.onItemMove(dragEndEvent);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(sourceEntity, message).then(() => {\n\t\t\t\t\tthis.onItemMove(dragEndEvent);\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\tconst itemNodeAfterSourceItem = sourceEntity.getListItemsNode().children[item.getSort()];\n\t\t\t\t\tthis.domBuilder.insertBefore(itemNode, itemNodeAfterSourceItem);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tmoveItem(item: Item, button)\n\t{\n\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\n\t\tconst listToMove = [];\n\n\t\tif (!entity.isFirstItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_UP'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\t\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst sortedItemsIds = new Set();\n\t\t\t\t\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\t\t\t\t\tthis.hideSubTasks(entity, groupModeItem);\n\t\t\t\t\t\t\tthis.moveItemToUp(groupModeItem, entity.getListItemsNode(), entity.hasInput(), false);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode(), sortedItemsIds)\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideSubTasks(entity, item);\n\t\t\t\t\t\tthis.moveItemToUp(item, entity.getListItemsNode(), entity.hasInput());\n\t\t\t\t\t}\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (!entity.isLastItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_DOWN'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\t\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst sortedItemsIds = new Set();\n\t\t\t\t\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\t\t\t\t\tthis.hideSubTasks(entity, groupModeItem);\n\t\t\t\t\t\t\tthis.moveItemToDown(groupModeItem, entity.getListItemsNode(), false);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode(), sortedItemsIds)\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideSubTasks(entity, item);\n\t\t\t\t\t\tthis.moveItemToDown(item, entity.getListItemsNode());\n\t\t\t\t\t}\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.showMoveItemMenu(item, button, listToMove);\n\t}\n\n\tmoveItemToUp(item: Item, listItemsNode, entityWithInput = true, updateSort = true)\n\t{\n\t\tthis.hideSubTasks(entity, item);\n\n\t\tif (entityWithInput)\n\t\t{\n\t\t\tthis.domBuilder.appendItemAfterItem(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.domBuilder.insertBefore(item.getItemNode(), listItemsNode.firstElementChild);\n\t\t}\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tmoveItemToDown(item, listItemsNode, updateSort = true)\n\t{\n\t\tthis.domBuilder.append(item.getItemNode(), listItemsNode);\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tupdateItemsSort(item: Item, listItemsNode: HTMLElement)\n\t{\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(listItemsNode, new Set([item.getItemId()]))\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonItemMove(dragEndEvent)\n\t{\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\tconst endContainer = dragEndEvent.endContainer;\n\n\t\tif (endContainer === this.domBuilder.getSprintCreatingDropZoneNode())\n\t\t{\n\t\t\tconst createNewSprintAndMoveItem = () => {\n\t\t\t\tthis.domBuilder.createSprint().then((sprint) => {\n\t\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\tthis.moveTo(this.entityStorage.getBacklog(), sprint, item);\n\t\t\t\t});\n\t\t\t};\n\t\t\tcreateNewSprintAndMoveItem();\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\n\t\tif (sourceEntityId === endEntityId)\n\t\t{\n\t\t\tconst moveInCurrentContainer = () => {\n\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\tconst itemId = parseInt(itemNode.dataset.itemId, 10);\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tsortInfo: this.calculateSort(sourceContainer, new Set([itemId]))\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInCurrentContainer();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst moveInAnotherContainer = () => {\n\t\t\t\tconst itemNode = dragEndEvent.source;\n\t\t\t\tconst itemId = itemNode.dataset.itemId;\n\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\t\t\tconst endEntity = this.entityStorage.findEntityByEntityId(endEntityId);\n\t\t\t\tthis.moveItemFromEntityToEntity(item, sourceEntity, endEntity);\n\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\tentityId: endEntity.getId(),\n\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\titemType: item.getItemType(),\n\t\t\t\t\tsourceEntityId: sourceEntity.getId(),\n\t\t\t\t\tfromActiveSprint: ((sourceEntity.getEntityType() === 'sprint' && sourceEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\ttoActiveSprint: ((endEntity.getEntityType() === 'sprint' && endEntity.isActive()) ? 'Y' : 'N'),\n\t\t\t\t\tsortInfo: this.calculateSort(endContainer, new Set([item.getItemId()]), true)\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t};\n\t\t\tmoveInAnotherContainer();\n\t\t}\n\t}\n\n\tcalculateSort(container, updatedItemsIds?: Set, moveToAnotherEntity = false): ItemsSortInfo\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst items = [...container.querySelectorAll('[data-sort]')];\n\t\tlet sort = 1;\n\t\titems.forEach((itemNode) => {\n\t\t\tconst itemId = parseInt(itemNode.dataset.itemId, 10);\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tif (item && !item.isSubTask())\n\t\t\t{\n\t\t\t\tconst tmpId = Text.getRandom();\n\t\t\t\tlet isSortUpdated = (sort !== item.getSort());\n\t\t\t\titem.setSort(sort);\n\t\t\t\tlistSortInfo[itemId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tif (moveToAnotherEntity)\n\t\t\t\t{\n\t\t\t\t\tlistSortInfo[itemId].entityId = container.dataset.entityId;\n\t\t\t\t\tisSortUpdated = true;\n\t\t\t\t}\n\t\t\t\tif (isSortUpdated && updatedItemsIds && updatedItemsIds.has(itemId))\n\t\t\t\t{\n\t\t\t\t\tlistSortInfo[itemId].tmpId = tmpId;\n\t\t\t\t\tlistSortInfo[itemId].updatedItemId = itemId;\n\t\t\t\t}\n\t\t\t\titemNode.dataset.sort = sort;\n\t\t\t}\n\t\t\tsort++;\n\t\t});\n\n\t\tthis.emit('calculateSort', listSortInfo);\n\n\t\treturn listSortInfo;\n\t}\n\n\tmoveToAnotherEntity(entityFrom: Entity, item: Item, targetEntity: ?Entity, bindButton?: HTMLElement)\n\t{\n\t\tconst isMoveToSprint = (Type.isNull(targetEntity));\n\n\t\tconst sprints = (isMoveToSprint ? this.entityStorage.getSprintsAvailableForFilling(entityFrom) : null);\n\n\t\tif (entityFrom.isGroupMode())\n\t\t{\n\t\t\tif (isMoveToSprint)\n\t\t\t{\n\t\t\t\tif (sprints.size > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.showListSprintsToMove(entityFrom, item, bindButton);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (sprints.size === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.domBuilder.createSprint().then((sprint: Sprint) => {\n\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, targetEntity, item, false, false);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (isMoveToSprint)\n\t\t\t{\n\t\t\t\tif (sprints.size > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.showListSprintsToMove(entityFrom, item, bindButton);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\t\tif (sprints.size === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.domBuilder.createSprint().then((sprint: Sprint) => {\n\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\tthis.moveTo(entityFrom, targetEntity, item, false);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveToWithGroupMode(entityFrom: Entity, entityTo: Entity, item: Item, after = true, update = true)\n\t{\n\t\tconst groupModeItems = entityFrom.getGroupModeItems();\n\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\tif (after)\n\t\t\t{\n\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t}\n\t\t});\n\t\tconst sortedItemsIds = new Set();\n\t\tconst items = [];\n\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\tthis.moveTo(entityFrom, entityTo, groupModeItem, after, update);\n\t\t\tsortedItemsIds.add(groupModeItem.getItemId());\n\t\t\titems.push({\n\t\t\t\titemId: groupModeItem.getItemId(),\n\t\t\t\titemType: groupModeItem.getItemType(),\n\t\t\t\tentityId: entityTo.getId(),\n\t\t\t\tsourceEntityId: entityFrom.getId(),\n\t\t\t\tfromActiveSprint: ((entityFrom.getEntityType() === 'sprint' && entityFrom.isActive()) ? 'Y' : 'N'),\n\t\t\t\ttoActiveSprint: ((entityTo.getEntityType() === 'sprint' && entityTo.isActive()) ? 'Y' : 'N')\n\t\t\t});\n\t\t});\n\t\tthis.requestSender.batchUpdateItem({\n\t\t\titems: items,\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), sortedItemsIds, true),\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), new Set(), true)\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t\tentityFrom.deactivateGroupMode();\n\t}\n\n\thideSubTasks(entity: Entity, item: Item)\n\t{\n\t\tif (item && item.isParentTask())\n\t\t{\n\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t{\n\t\t\t\tthis.subTasksCreator.toggleSubTasks(entity, item);\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveTo(entityFrom: Entity, entityTo: Entity, item: Item, after = true, update = true)\n\t{\n\t\tthis.hideSubTasks(entityFrom, item);\n\n\t\tconst itemNode = item.getItemNode();\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\t\tif (after)\n\t\t{\n\t\t\tthis.domBuilder.append(itemNode, entityListNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.domBuilder.appendItemAfterItem(itemNode, entityListNode.firstElementChild);\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\n\t\tif (update)\n\t\t{\n\t\t\tthis.onMoveItemUpdate(entityFrom, entityTo, item);\n\t\t}\n\t}\n\n\tmoveToPosition(entityFrom: Entity, entityTo: Entity, item: Item)\n\t{\n\t\tthis.hideSubTasks(entityFrom, item);\n\n\t\tconst itemNode = item.getItemNode();\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\t\tconst bindItemNode = entityListNode.children[item.getSort()];\n\t\tif (Type.isUndefined(bindItemNode))\n\t\t{\n\t\t\tthis.domBuilder.append(itemNode, entityListNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst bindItemSort = parseInt(bindItemNode.dataset.sort, 10);\n\t\t\tconst isMoveFromAnotherEntity = (entityFrom.getId() !== entityTo.getId())\n\n\t\t\tif (bindItemSort >= item.getPreviousSort())\n\t\t\t{\n\t\t\t\tif (isMoveFromAnotherEntity)\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.insertBefore(itemNode, bindItemNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.domBuilder.appendItemAfterItem(itemNode, bindItemNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.domBuilder.insertBefore(itemNode, bindItemNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\t}\n\n\tonMoveItemUpdate(entityFrom: Entity, entityTo: Entity, item: Item)\n\t{\n\t\tthis.requestSender.updateItem({\n\t\t\titemId: item.getItemId(),\n\t\t\titemType: item.getItemType(),\n\t\t\tentityId: entityTo.getId(),\n\t\t\tsourceEntityId: entityFrom.getId(),\n\t\t\tfromActiveSprint: ((entityFrom.getEntityType() === 'sprint' && entityFrom.isActive()) ? 'Y' : 'N'),\n\t\t\ttoActiveSprint: ((entityTo.getEntityType() === 'sprint' && entityTo.isActive()) ? 'Y' : 'N'),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), new Set([item.getItemId()]), true),\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), new Set(), true)\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tmoveItemFromEntityToEntity(item: Item, entityFrom: Entity, entityTo: Entity)\n\t{\n\t\tif (entityFrom.isActive())\n\t\t{\n\t\t\tentityFrom.subtractTotalStoryPoints(item);\n\t\t}\n\n\t\tif (entityTo.isActive())\n\t\t{\n\t\t\tentityTo.addTotalStoryPoints(item);\n\t\t}\n\n\t\tentityFrom.removeItem(item);\n\t\titem.setParentEntity(entityTo.getId(), entityTo.getEntityType());\n\t\titem.setDisableStatus(false);\n\t\tentityTo.setItem(item);\n\t}\n\n\tshowListSprintsToMove(entityFrom: Entity, item: Item, button: HTMLElement)\n\t{\n\t\tconst id = `item-sprint-action-${entityFrom.getEntityType() + entityFrom.getId() + item.itemId}`;\n\n\t\tif (this.moveToSprintMenu)\n\t\t{\n\t\t\tif (this.moveToSprintMenu.getPopupWindow().getId() === id)\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.getPopupWindow().setBindElement(button);\n\t\t\t\tthis.moveToSprintMenu.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.moveToSprintMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveToSprintMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (!sprint.isCompleted() && !this.isSameSprint(entityFrom, sprint))\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.addMenuItem({\n\t\t\t\t\ttext: sprint.getName(),\n\t\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\t\tlet message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\t\t\tif (entityFrom.isGroupMode())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmessage = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.onMoveConfirm(entityFrom, message).then(() => {\n\t\t\t\t\t\t\tif (entityFrom.isGroupMode())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.moveTo(entityFrom, sprint, item);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\t\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.moveToSprintMenu.show();\n\t}\n\n\tisSameSprint(first: Sprint, second: Sprint): boolean\n\t{\n\t\treturn (first.getEntityType() === 'sprint' && first.getId() === second.getId());\n\t}\n\n\tonMoveConfirm(entity: Entity, message: string): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (entity.isActive())\n\t\t\t{\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tmessage,\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_MOVE'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\treject();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tshowMoveItemMenu(item, button, listToMove)\n\t{\n\t\tconst id = `item-move-${item.itemId}`;\n\n\t\tif (this.moveItemMenu)\n\t\t{\n\t\t\tthis.moveItemMenu.getPopupWindow().destroy();\n\t\t}\n\n\t\tthis.moveItemMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button\n\t\t});\n\n\t\tlistToMove.forEach((item) => {\n\t\t\tthis.moveItemMenu.addMenuItem(item);\n\t\t});\n\n\t\tthis.moveItemMenu.show();\n\t}\n}","import {Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {Item} from '../item/item';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\nimport {TagSearcher} from './tag.searcher';\nimport {ItemMover} from './item.mover';\nimport {SubTasksManager} from './subtasks.manager';\nimport {Counters} from './counters';\n\nimport type {ItemParams} from '../item/item';\nimport type {ItemsSortInfo} from './item.mover';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\ttagSearcher: TagSearcher,\n\titemMover: ItemMover,\n\tsubTasksCreator: SubTasksManager,\n\tcounters: Counters,\n\tcurrentUserId: number\n}\n\ntype RemoveParams = {\n\titemId: number\n}\n\nexport class PullItem\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.tagSearcher = params.tagSearcher;\n\t\tthis.itemMover = params.itemMover;\n\t\tthis.subTasksCreator = params.subTasksCreator;\n\t\tthis.counters = params.counters;\n\t\tthis.currentUserId = params.currentUserId;\n\n\t\tthis.listToAddAfterUpdate = new Map();\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t\tthis.listIdsToSkipSorting = new Set();\n\n\t\tthis.itemMover.subscribe('calculateSort', this.onCalculateSort.bind(this))\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\titemAdded: this.onItemAdded.bind(this),\n\t\t\titemUpdated: this.onItemUpdated.bind(this),\n\t\t\titemRemoved: this.onItemRemoved.bind(this),\n\t\t\titemSortUpdated: this.onItemSortUpdated.bind(this),\n\t\t\tcomment_add: this.onCommentAdd.bind(this)\n\t\t};\n\t}\n\n\tonItemAdded(itemData: ItemParams)\n\t{\n\t\tconst item = new Item(itemData);\n\n\t\tthis.setDelayedAdd(item);\n\n\t\tthis.externalAdd(item)\n\t\t\t.finally(() => this.cleanDelayedAdd(item))\n\t\t\t.then(() => this.addItemToEntity(item))\n\t\t\t.catch(() => {})\n\t\t;\n\t}\n\n\tonItemUpdated(itemData: ItemParams)\n\t{\n\t\tconst item = new Item(itemData);\n\n\t\tif (this.isDelayedAdd(item))\n\t\t{\n\t\t\tthis.cleanDelayedAdd(item);\n\n\t\t\tif (this.needSkipAdd(item))\n\t\t\t{\n\t\t\t\tthis.cleanSkipAdd(item);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.addItemToEntity(item);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.needSkipUpdate(item))\n\t\t{\n\t\t\tthis.cleanSkipUpdate(item);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateItem(item);\n\t}\n\n\tonItemRemoved(params: RemoveParams)\n\t{\n\t\tif (this.needSkipRemove(params.itemId))\n\t\t{\n\t\t\tthis.cleanSkipRemove(params.itemId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = this.entityStorage.findItemByItemId(params.itemId);\n\t\tif (item)\n\t\t{\n\t\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\t\t\tentity.removeItem(item);\n\t\t\titem.removeYourself();\n\t\t}\n\t}\n\n\tonItemSortUpdated(itemsSortInfo : ItemsSortInfo)\n\t{\n\t\tconst itemsToSort = new Map();\n\t\tconst itemsInfoToSort = new Map();\n\t\tObject.entries(itemsSortInfo).forEach(([itemId, info]) => {\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tif (!this.needSkipSort(info.tmpId))\n\t\t\t\t{\n\t\t\t\t\titemsToSort.set(item.getItemId(), item);\n\t\t\t\t\titemsInfoToSort.set(item.getItemId(), info);\n\t\t\t\t}\n\t\t\t\tthis.cleanSkipRemove(info.tmpId);\n\t\t\t}\n\t\t});\n\n\t\titemsToSort.forEach((item: Item) => {\n\t\t\tconst itemInfoToSort = itemsInfoToSort.get(item.getItemId());\n\t\t\titem.setSort(itemInfoToSort.sort);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\tif (sourceEntity)\n\t\t\t{\n\t\t\t\tconst targetEntityId = (\n\t\t\t\t\tType.isUndefined(itemInfoToSort.entityId)\n\t\t\t\t\t\t? item.getEntityId()\n\t\t\t\t\t\t: itemInfoToSort.entityId\n\t\t\t\t);\n\t\t\t\tlet targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\t\t\t\tif (!targetEntity || sourceEntity.getId() === targetEntity.getId())\n\t\t\t\t{\n\t\t\t\t\ttargetEntity = sourceEntity;\n\t\t\t\t}\n\t\t\t\tthis.itemMover.moveToPosition(sourceEntity, targetEntity, item);\n\t\t\t\tthis.entityStorage.recalculateItemsSort();\n\t\t\t}\n\t\t});\n\t}\n\n\tonCommentAdd(params)\n\t{\n\t\tconst participants = Type.isArray(params.participants) ? params.participants : [];\n\n\t\tif (participants.includes(this.currentUserId.toString()))\n\t\t{\n\t\t\tconst xmlId = params.entityXmlId.split('_');\n\t\t\tif (xmlId)\n\t\t\t{\n\t\t\t\tconst entityType = xmlId[0];\n\t\t\t\tconst taskId = xmlId[1];\n\t\t\t\tconst item = this.entityStorage.findItemBySourceId(taskId);\n\t\t\t\tif (entityType === 'TASK' && item)\n\t\t\t\t{\n\t\t\t\t\tthis.requestSender.getCurrentState({\n\t\t\t\t\t\ttaskId: item.getSourceId()\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tconst tmpItem = new Item(response.data.itemData);\n\t\t\t\t\t\tthis.updateItem(tmpItem, item);\n\t\t\t\t\t\tthis.counters.updateState(response.data.counters);\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddItemToEntity(item: Item)\n\t{\n\t\tif (item.isSubTask())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\tif (!entity)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst bindItemNode = entity.getListItemsNode().children[1];\n\n\t\tif (bindItemNode)\n\t\t{\n\t\t\tthis.domBuilder.insertBefore(item.render(), bindItemNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.domBuilder.append(item.render(), entity.getListItemsNode());\n\t\t}\n\n\t\titem.onAfterAppend(entity.getListItemsNode());\n\t\tentity.setItem(item);\n\n\t\titem.getTags().forEach((tag) => {\n\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t});\n\t}\n\n\tupdateItem(tmpItem: Item, item?: Item)\n\t{\n\t\tif (!item)\n\t\t{\n\t\t\titem = this.entityStorage.findItemByItemId(tmpItem.getItemId());\n\t\t}\n\t\tif (item)\n\t\t{\n\t\t\tif (item.isParentTask())\n\t\t\t{\n\t\t\t\tif (this.subTasksCreator.isShown(item))\n\t\t\t\t{\n\t\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\t\tthis.subTasksCreator.hideSubTaskItems(entity, item);\n\t\t\t\t}\n\t\t\t\tthis.subTasksCreator.cleanSubTasks(item);\n\t\t\t}\n\n\t\t\tconst isParentChangeAction = tmpItem.isSubTask() !== item.isSubTask();\n\t\t\tif (isParentChangeAction)\n\t\t\t{\n\t\t\t\tif (tmpItem.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tconst entity = this.entityStorage.findEntityByItemId(item.getItemId());\n\t\t\t\t\tentity.removeItem(item);\n\t\t\t\t\titem.removeYourself();\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (tmpItem.getEntityId() !== item.getEntityId())\n\t\t\t{\n\t\t\t\tconst targetEntityId = tmpItem.getEntityId();\n\t\t\t\tconst sourceEntityId = item.getEntityId();\n\t\t\t\tconst targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\t\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\t\t\tif (targetEntity && sourceEntity)\n\t\t\t\t{\n\t\t\t\t\tthis.itemMover.moveToPosition(sourceEntity, targetEntity, item);\n\t\t\t\t\tthis.entityStorage.recalculateItemsSort();\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.updateYourself(tmpItem);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addItemToEntity(tmpItem);\n\t\t}\n\t}\n\n\tonCalculateSort(baseEvent: BaseEvent)\n\t{\n\t\tconst listSortInfo = baseEvent.getData();\n\n\t\tObject.entries(listSortInfo).forEach(([itemId, info]) => {\n\t\t\tif (Object.prototype.hasOwnProperty.call(info, 'tmpId'))\n\t\t\t{\n\t\t\t\tthis.addTmpIdToSkipSorting(info.tmpId);\n\t\t\t}\n\t\t});\n\t}\n\n\taddTmpIdsToSkipAdding(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.add(tmpId);\n\t}\n\n\taddIdToSkipUpdating(itemId: string)\n\t{\n\t\tthis.listIdsToSkipUpdating.add(itemId);\n\t}\n\n\taddIdToSkipRemoving(itemId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.add(itemId);\n\t}\n\n\taddTmpIdToSkipSorting(itemId: number)\n\t{\n\t\tthis.listIdsToSkipSorting.add(itemId);\n\t}\n\n\texternalAdd(item: Item): boolean\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tsetTimeout(() => (this.isDelayedAdd(item) ? resolve() : reject()), 3000);\n\t\t});\n\t}\n\n\tisDelayedAdd(item: Item): boolean\n\t{\n\t\treturn this.listToAddAfterUpdate.has(item.getItemId());\n\t}\n\n\tsetDelayedAdd(item: Item)\n\t{\n\t\tthis.listToAddAfterUpdate.set(item.getItemId(), item);\n\t}\n\n\tcleanDelayedAdd(item: Item)\n\t{\n\t\tthis.listToAddAfterUpdate.delete(item.getItemId());\n\t}\n\n\tneedSkipAdd(item: Item): boolean\n\t{\n\t\treturn this.listIdsToSkipAdding.has(item.getTmpId());\n\t}\n\n\tcleanSkipAdd(item: Item)\n\t{\n\t\tthis.listIdsToSkipAdding.delete(item.getTmpId());\n\t}\n\n\tneedSkipUpdate(item: Item): boolean\n\t{\n\t\treturn this.listIdsToSkipUpdating.has(item.getItemId());\n\t}\n\n\tcleanSkipUpdate(item: Item)\n\t{\n\t\tthis.listIdsToSkipUpdating.delete(item.getItemId());\n\t}\n\n\tneedSkipRemove(itemId: number): boolean\n\t{\n\t\treturn this.listIdsToSkipRemoving.has(itemId);\n\t}\n\n\tcleanSkipRemove(itemId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.delete(itemId);\n\t}\n\n\tneedSkipSort(tmpId: string): boolean\n\t{\n\t\treturn this.listIdsToSkipSorting.has(tmpId);\n\t}\n\n\tcleanSkipSort(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipSorting.delete(tmpId);\n\t}\n}","import {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\nimport {Epic} from './epic';\n\nimport type {EpicType} from '../item/item';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage,\n\tepic: Epic\n}\n\nexport class PullEpic\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.epic = params.epic;\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tepicAdded: this.onEpicAdded.bind(this),\n\t\t\tepicUpdated: this.onEpicUpdated.bind(this),\n\t\t\tepicRemoved: this.onEpicRemoved.bind(this)\n\t\t};\n\t}\n\n\tonEpicAdded(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterCreateEpic(epicData);\n\t}\n\n\tonEpicUpdated(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterUpdateEpic(epicData);\n\t}\n\n\tonEpicRemoved(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterRemoveEpic(epicData);\n\t}\n}","import {BaseEvent} from 'main.core.events';\n\nimport {RequestSender} from './request.sender';\nimport {DomBuilder} from './dom.builder';\nimport {EntityStorage} from './entity.storage';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tdomBuilder: DomBuilder,\n\tentityStorage: EntityStorage\n}\n\nexport class SprintMover\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.domBuilder = params.domBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.bindHandlers();\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.domBuilder.subscribe('sprintMove', this.onSprintMove.bind(this))\n\t}\n\n\tonSprintMove(baseEvent: BaseEvent)\n\t{\n\t\tconst dragEndEvent = baseEvent.getData();\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.updateSprintSort({\n\t\t\tsortInfo: this.calculateSprintSort()\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tcalculateSprintSort(increment = 0)\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst container = this.domBuilder.getSprintPlannedListNode();\n\n\t\tconst sprints = [...container.querySelectorAll('[data-sprint-sort]')];\n\t\tlet sort = 1 + increment;\n\t\tsprints.forEach((sprintNode) => {\n\t\t\tconst sprintId = sprintNode.dataset.sprintId;\n\t\t\tconst sprint = this.entityStorage.findEntityByEntityId(sprintId);\n\t\t\tif (sprint)\n\t\t\t{\n\t\t\t\tsprint.setSort(sort);\n\t\t\t\tlistSortInfo[sprintId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tsprintNode.dataset.sprintSort = sort;\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\n\t\treturn listSortInfo;\n\t}\n}","import {Type, Event} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {View} from './view';\n\nimport {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\nimport {Entity} from '../entity/entity';\nimport {Item} from '../item/item';\nimport {Decomposition} from '../item/task/decomposition';\n\nimport {SidePanel} from '../service/side.panel';\nimport {PULL as Pull} from 'pull.client';\n\nimport {DomBuilder} from '../utility/dom.builder';\nimport {EntityStorage} from '../utility/entity.storage';\nimport {FilterHandler} from '../utility/filter.handler';\nimport {Epic} from '../utility/epic';\nimport {TagSearcher} from '../utility/tag.searcher';\nimport {ProjectSidePanel} from '../utility/project.side.panel';\nimport {PullSprint} from '../utility/pull.sprint';\nimport {PullItem} from '../utility/pull.item';\nimport {PullEpic} from '../utility/pull.epic';\nimport {SprintMover} from '../utility/sprint.mover';\nimport {ItemMover} from '../utility/item.mover';\nimport {ItemStyleDesigner} from '../utility/item.style.designer';\nimport {SubTasksManager} from '../utility/subtasks.manager';\n\nimport type {BacklogParams} from '../entity/backlog/backlog';\nimport type {SprintParams} from '../entity/sprint/sprint';\nimport type {EpicType} from '../item/item';\nimport type {Views} from './view';\n\nimport '../css/base.css';\n\ntype Responsible = {\n\tname: string,\n\tpathToUser: string,\n\tphoto: {\n\t\tsrc: string\n\t}\n}\n\ntype Params = {\n\tpathToTask: string,\n\tdefaultSprintDuration: number,\n\tactiveSprintId: number,\n\tbacklog: BacklogParams,\n\tsprints: Array<SprintParams>,\n\tviews: Views,\n\ttags: {\n\t\tepic: EpicType,\n\t\ttask: Array\n\t},\n\tdefaultResponsible: Responsible\n}\n\nexport class Plan extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Plan');\n\n\t\tthis.pathToTask = params.pathToTask;\n\t\tthis.defaultResponsible = params.defaultResponsible;\n\t\tthis.activeSprintId = parseInt(params.activeSprintId, 10);\n\t\tthis.views = params.views;\n\n\t\tthis.entityStorage = new EntityStorage();\n\t\tthis.entityStorage.addBacklog(Backlog.buildBacklog(params.backlog));\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tsprintData.defaultSprintDuration = params.defaultSprintDuration;\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t});\n\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.filterHandler = new FilterHandler({\n\t\t\tfilter: this.filter,\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.tagSearcher = new TagSearcher();\n\t\tObject.values(params.tags.epic).forEach((epic) => {\n\t\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\t});\n\t\tObject.values(params.tags.task).forEach((tagName) => {\n\t\t\tthis.tagSearcher.addTagToSearcher(tagName);\n\t\t});\n\n\t\tthis.domBuilder = new DomBuilder({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tdefaultSprintDuration: params.defaultSprintDuration\n\t\t});\n\t\tthis.domBuilder.subscribe('beforeCreateSprint', (baseEvent: BaseEvent) => {\n\t\t\tconst requestData = baseEvent.getData();\n\t\t\tthis.pullSprint.addTmpIdToSkipAdding(requestData.tmpId);\n\t\t});\n\t\tthis.domBuilder.subscribe('createSprint', (baseEvent: BaseEvent) => {\n\t\t\tthis.bindHandlers(baseEvent.getData());\n\t\t});\n\t\tthis.domBuilder.subscribe('createSprintNode', (baseEvent: BaseEvent) => {\n\t\t\tthis.bindHandlers(baseEvent.getData());\n\t\t});\n\n\t\tthis.sprintMover = new SprintMover({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.subTasksCreator = new SubTasksManager({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder\n\t\t});\n\n\t\tthis.itemMover = new ItemMover({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tsubTasksCreator: this.subTasksCreator\n\t\t});\n\n\t\tthis.itemStyleDesigner = new ItemStyleDesigner({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.epic = new Epic({\n\t\t\tentity: this.entityStorage.getBacklog(),\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tfilter: this.filter,\n\t\t\ttagSearcher: this.tagSearcher\n\t\t});\n\n\t\tthis.pullSprint = new PullSprint({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tgroupId: this.groupId\n\t\t});\n\t\tthis.pullItem = new PullItem({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\ttagSearcher: this.tagSearcher,\n\t\t\titemMover: this.itemMover,\n\t\t\tsubTasksCreator: this.subTasksCreator,\n\t\t\tcounters: this.counters,\n\t\t\tcurrentUserId: this.getCurrentUserId()\n\t\t});\n\t\tthis.pullEpic = new PullEpic({\n\t\t\trequestSender: this.requestSender,\n\t\t\tdomBuilder: this.domBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tepic: this.epic,\n\t\t});\n\n\t\tthis.bindHandlers();\n\n\t\tthis.subscribeToPull();\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tsuper.renderTo(container);\n\n\t\tthis.domBuilder.renderTo(container);\n\t}\n\n\tsubscribeToPull()\n\t{\n\t\tPull.subscribe(this.pullSprint);\n\t\tPull.subscribe(this.pullItem);\n\t\tPull.subscribe(this.pullEpic);\n\t}\n\n\tbindHandlers(newSprint)\n\t{\n\t\tthis.teamSpeedChartButtonContainerNode = document.getElementById('tasks-scrum-team-speed-button-container');\n\t\tEvent.bind(this.teamSpeedChartButtonContainerNode, 'click', this.onShowTeamSpeedChart.bind(this));\n\n\t\tconst createTaskItem = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst inputObject = data.inputObject;\n\t\t\tconst inputValue = data.value;\n\n\t\t\tconst newItem = this.createItem('task', inputValue);\n\n\t\t\tthis.pullItem.addTmpIdsToSkipAdding(newItem.getItemId());\n\n\t\t\tthis.fillItemBeforeCreation(entity, newItem, inputValue);\n\n\t\t\tthis.domBuilder.appendItemAfterItem(newItem.render(), inputObject.getNode());\n\t\t\tnewItem.onAfterAppend(entity.getListItemsNode());\n\n\t\t\tnewItem.setParentId(inputObject.getEpicId());\n\t\t\tinputObject.setEpicId(0);\n\n\t\t\tthis.sendRequestToCreateTask(entity, newItem, inputValue).then((response) => {\n\t\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t\t});\n\t\t\t\tentity.setItem(newItem);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onUpdateItem = (baseEvent: BaseEvent) => {\n\t\t\tconst updateData = baseEvent.getData();\n\t\t\tthis.pullItem.addIdToSkipUpdating(updateData.itemId);\n\t\t\tthis.requestSender.updateItem(baseEvent.getData()).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onShowTask = (baseEvent: BaseEvent) => {\n\t\t\tconst item = baseEvent.getData();\n\t\t\tthis.sidePanel.openSidePanelByUrl(this.pathToTask.replace('#task_id#', item.getSourceId()));\n\t\t};\n\t\tconst onMoveItem = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tthis.itemMover.moveItem(data.item, data.button);\n\t\t};\n\t\tconst onMoveToSprint = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst entityFrom = baseEvent.getTarget();\n\t\t\tthis.itemMover.moveToAnotherEntity(entityFrom, data.item, null, data.button);\n\t\t\tif (this.entityStorage.getSprintsAvailableForFilling(entityFrom).size <= 1)\n\t\t\t{\n\t\t\t\tthis.domBuilder.remove(data.button.parentNode);\n\t\t\t}\n\t\t};\n\t\tconst onMoveToBacklog = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tthis.itemMover.moveToAnotherEntity(data.sprint, data.item, this.entityStorage.getBacklog());\n\t\t};\n\t\tconst onAttachFilesToTask = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tthis.pullItem.addIdToSkipUpdating(data.item.getItemId());\n\t\t\tthis.requestSender.attachFilesToTask({\n\t\t\t\ttaskId: data.item.getSourceId(),\n\t\t\t\titemId: data.item.getItemId(),\n\t\t\t\tentityId: data.item.getEntityId(),\n\t\t\t\tattachedIds: data.attachedIds,\n\t\t\t}).then((response) => {\n\t\t\t\tdata.item.updateIndicators(response.data);\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onRemoveItem = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tif (entity.isGroupMode())\n\t\t\t{\n\t\t\t\tconst items = [];\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\titemId: groupModeItem.getItemId(),\n\t\t\t\t\t\tentityId: groupModeItem.getEntityId(),\n\t\t\t\t\t\titemType: groupModeItem.getItemType(),\n\t\t\t\t\t\tsourceId: groupModeItem.getSourceId()\n\t\t\t\t\t});\n\t\t\t\t\tthis.pullItem.addIdToSkipRemoving(groupModeItem.getItemId());\n\t\t\t\t});\n\t\t\t\tthis.requestSender.batchRemoveItem({\n\t\t\t\t\titems: items,\n\t\t\t\t\tsortInfo: this.itemMover.calculateSort(entity.getListItemsNode())\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t\tentity.deactivateGroupMode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.pullItem.addIdToSkipRemoving(baseEvent.getData().getItemId());\n\t\t\t\tthis.requestSender.removeItem({\n\t\t\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\t\t\tentityId: baseEvent.getData().getEntityId(),\n\t\t\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\t\t\tsortInfo: this.itemMover.calculateSort(entity.getListItemsNode())\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tconst onStartSprint = (baseEvent: BaseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\t\tsidePanel: this.sidePanel,\n\t\t\t\trequestSender: this.requestSender,\n\t\t\t\tviews: this.views\n\t\t\t});\n\t\t\tsprintSidePanel.showStartSidePanel(sprint);\n\t\t};\n\t\tconst onCompleteSprint = (baseEvent: BaseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\t\tsidePanel: this.sidePanel,\n\t\t\t\trequestSender: this.requestSender,\n\t\t\t\tviews: this.views\n\t\t\t});\n\t\t\tsprintSidePanel.showCompleteSidePanel(sprint);\n\t\t};\n\t\tconst onShowSprintBurnDownChart = (baseEvent: BaseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\t\tsprints: this.entityStorage.getSprints(),\n\t\t\t\tsidePanel: this.sidePanel,\n\t\t\t\trequestSender: this.requestSender,\n\t\t\t\tviews: this.views\n\t\t\t});\n\t\t\tsprintSidePanel.showBurnDownChart(sprint);\n\t\t};\n\t\tconst onChangeTaskResponsible = (baseEvent: BaseEvent) => {\n\t\t\tthis.pullItem.addIdToSkipUpdating(baseEvent.getData().getItemId());\n\t\t\tthis.requestSender.changeTaskResponsible({\n\t\t\t\titemId: baseEvent.getData().getItemId(),\n\t\t\t\titemType: baseEvent.getData().getItemType(),\n\t\t\t\tsourceId: baseEvent.getData().getSourceId(),\n\t\t\t\tresponsible: baseEvent.getData().getResponsible(),\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onRemoveSprint = (baseEvent: BaseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tthis.pullSprint.addIdToSkipRemoving(sprint.getId());\n\t\t\tthis.requestSender.removeSprint({\n\t\t\t\tsprintId: sprint.getId(),\n\t\t\t\tsortInfo: this.sprintMover.calculateSprintSort()\n\t\t\t}).then((response) => {\n\t\t\t\tthis.entityStorage.removeSprint(sprint.getId());\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onChangeSprintName = (baseEvent: BaseEvent) => {\n\t\t\tconst requestData = baseEvent.getData();\n\t\t\tthis.pullSprint.addIdToSkipUpdating(requestData.sprintId);\n\t\t\tthis.requestSender.changeSprintName(requestData).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onChangeSprintDeadline = (baseEvent: BaseEvent) => {\n\t\t\tconst requestData = baseEvent.getData();\n\t\t\tthis.pullSprint.addIdToSkipUpdating(requestData.sprintId);\n\t\t\tthis.requestSender.changeSprintDeadline(requestData).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\t\tconst onOpenAddEpicForm = (baseEvent: BaseEvent) => {\n\t\t\tthis.epic.openAddForm();\n\t\t};\n\t\tconst onOpenListEpicGrid = (baseEvent: BaseEvent) => {\n\t\t\tthis.epic.openEpicsList();\n\t\t\tthis.epic.subscribe('onAfterEditEpic', (innerBaseEvent) => {\n\t\t\t\tconst response = innerBaseEvent.getData();\n\t\t\t\tconst updatedEpicInfo = response.data;\n\t\t\t\tthis.epic.onAfterUpdateEpic(updatedEpicInfo);\n\t\t\t});\n\t\t};\n\t\tconst onOpenDefinitionOfDone = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst projectSidePanel = new ProjectSidePanel({\n\t\t\t\tsidePanel: this.sidePanel,\n\t\t\t\trequestSender: this.requestSender\n\t\t\t});\n\t\t\tprojectSidePanel.showDefinitionOfDone(entity);\n\t\t};\n\t\tconst onShowTagSearcher = (baseEvent: BaseEvent) => {\n\t\t\t//todo refactor and test\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst item = data.item;\n\t\t\tconst actionsPanelButton = data.button;\n\t\t\tthis.tagSearcher.showTagsDialog(item, actionsPanelButton);\n\t\t\tthis.tagSearcher.unsubscribeAll('attachTagToTask');\n\t\t\tthis.tagSearcher.subscribe('attachTagToTask', (innerBaseEvent) => {\n\t\t\t\tconst tag = innerBaseEvent.getData();\n\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tconst tasks = [];\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\ttasks.push({\n\t\t\t\t\t\t\ttaskId: groupModeItem.getSourceId(),\n\t\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tthis.requestSender.batchAttachTagToTask({\n\t\t\t\t\t\ttasks: tasks,\n\t\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\t\ttag: tag\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tconst currentTags = groupModeItem.getTags();\n\t\t\t\t\t\t\tcurrentTags.push(tag);\n\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(groupModeItem.getEpic(), currentTags);\n\t\t\t\t\t\t});\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst currentTags = item.getTags();\n\t\t\t\t\tthis.requestSender.attachTagToTask({\n\t\t\t\t\t\ttaskId: item.getSourceId(),\n\t\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\t\ttag: tag\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tcurrentTags.push(tag);\n\t\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.tagSearcher.unsubscribeAll('deAttachTagToTask');\n\t\t\tthis.tagSearcher.subscribe('deAttachTagToTask', (innerBaseEvent) => {\n\t\t\t\tconst tag = innerBaseEvent.getData();\n\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tconst tasks = [];\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\ttasks.push({\n\t\t\t\t\t\t\ttaskId: groupModeItem.getSourceId(),\n\t\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tthis.requestSender.batchDeattachTagToTask({\n\t\t\t\t\t\ttasks: tasks,\n\t\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\t\ttag: tag\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tconst currentTags = groupModeItem.getTags();\n\t\t\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(tag), 1);\n\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(groupModeItem.getEpic(), currentTags);\n\t\t\t\t\t\t});\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst currentTags = item.getTags();\n\t\t\t\t\tthis.requestSender.deAttachTagToTask({\n\t\t\t\t\t\ttaskId: item.getSourceId(),\n\t\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\t\ttag: tag\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(tag), 1);\n\t\t\t\t\t\titem.setEpicAndTags(item.getEpic(), currentTags);\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.tagSearcher.unsubscribeAll('hideTagDialog');\n\t\t\tthis.tagSearcher.subscribe('hideTagDialog', (innerBaseEvent) => {\n\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tconst onShowEpicSearcher = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst item = data.item;\n\t\t\tconst actionsPanelButton = data.button;\n\t\t\tthis.tagSearcher.showEpicDialog(item, actionsPanelButton);\n\t\t\tthis.tagSearcher.unsubscribeAll('updateItemEpic');\n\t\t\tthis.tagSearcher.subscribe('updateItemEpic', (innerBaseEvent) => {\n\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t{\n\t\t\t\t\tconst items = [];\n\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\titemId: groupModeItem.getItemId()\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.pullItem.addIdToSkipUpdating(groupModeItem.getItemId());\n\t\t\t\t\t});\n\t\t\t\t\tthis.requestSender.batchUpdateItemEpic({\n\t\t\t\t\t\titems: items,\n\t\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\t\tepicId: innerBaseEvent.getData()\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\tif (Type.isArray(response.data.epic))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tgroupModeItem.setParentId(0);\n\t\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(null, null);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tgroupModeItem.setParentId(response.data.epic.id);\n\t\t\t\t\t\t\t\tgroupModeItem.setEpicAndTags(response.data.epic, groupModeItem.getTags());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.pullItem.addIdToSkipUpdating(item.getItemId());\n\t\t\t\t\tthis.requestSender.updateItemEpic({\n\t\t\t\t\t\titemId: item.getItemId(),\n\t\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\t\tepicId: innerBaseEvent.getData()\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tif (Type.isArray(response.data.epic))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.setParentId(0);\n\t\t\t\t\t\t\titem.setEpicAndTags(null, null);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.setParentId(response.data.epic.id);\n\t\t\t\t\t\t\titem.setEpicAndTags(response.data.epic, item.getTags());\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tconst onStartDecomposition = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tconst parentItem = baseEvent.getData();\n\n\t\t\tconst decomposition = new Decomposition({\n\t\t\t\tentity: entity,\n\t\t\t\titemStyleDesigner: this.itemStyleDesigner,\n\t\t\t\tsubTasksCreator: this.subTasksCreator\n\t\t\t});\n\t\t\tdecomposition.subscribe('tagsSearchOpen', onTagsSearchOpen);\n\t\t\tdecomposition.subscribe('tagsSearchClose', onTagsSearchClose);\n\t\t\tdecomposition.subscribe('createItem', (innerBaseEvent) => {\n\t\t\t\tconst inputValue = innerBaseEvent.getData();\n\t\t\t\tconst decomposedItems = decomposition.getDecomposedItems();\n\t\t\t\tconst lastDecomposedItem = Array.from(decomposedItems).pop();\n\n\t\t\t\tconst newItem = this.createItem(parentItem.getItemType(), inputValue);\n\n\t\t\t\tthis.pullItem.addTmpIdsToSkipAdding(newItem.getItemId());\n\t\t\t\tthis.pullItem.addIdToSkipUpdating(parentItem.getItemId());\n\n\t\t\t\tnewItem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\t\t\tnewItem.setParentId(parentItem.getParentId());\n\t\t\t\tnewItem.setParentSourceId(parentItem.getSourceId());\n\t\t\t\tnewItem.setEpic(parentItem.getEpic());\n\t\t\t\tnewItem.setTags(parentItem.getTags());\n\t\t\t\tnewItem.setResponsible(decomposition.getResponsible());\n\t\t\t\tif (decomposition.isBacklogDecomposition())\n\t\t\t\t{\n\t\t\t\t\tparentItem.setLinkedTask('Y');\n\n\t\t\t\t\tnewItem.setSort(lastDecomposedItem.getSort() + 1);\n\t\t\t\t\tnewItem.setInfo({\n\t\t\t\t\t\tborderColor: decomposition.getBorderColor()\n\t\t\t\t\t});\n\t\t\t\t\tnewItem.setLinkedTask('Y');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tparentItem.setParentTask('Y');\n\t\t\t\t\tparentItem.setSubTasksCount(parentItem.getSubTasksCount() + 1);\n\t\t\t\t\tparentItem.updateParentTaskNodes();\n\n\t\t\t\t\tnewItem.setSort(decomposition.getSubTasks(parentItem).length + 1);\n\t\t\t\t\tnewItem.setSubTask('Y');\n\t\t\t\t\tnewItem.setParentTaskId(parentItem.getSourceId());\n\t\t\t\t\tnewItem.setParentTask('N');\n\t\t\t\t}\n\n\t\t\t\tthis.domBuilder.appendItemAfterItem(\n\t\t\t\t\tnewItem.render(),\n\t\t\t\t\tdecomposition.getLastDecomposedItemNode(parentItem)\n\t\t\t\t);\n\t\t\t\tnewItem.onAfterAppend(entity.getListItemsNode());\n\n\t\t\t\tdecomposition.addDecomposedItem(newItem);\n\n\t\t\t\tthis.sendRequestToCreateTask(entity, newItem, inputValue).then((response) => {\n\t\t\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\t\t\t\t\tresponse.data.tags.forEach((tag) => {\n\t\t\t\t\t\tthis.tagSearcher.addTagToSearcher(tag);\n\t\t\t\t\t});\n\t\t\t\t\tentity.setItem(newItem);\n\t\t\t\t\tif (!decomposition.isBacklogDecomposition())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.subTasksCreator.addSubTask(parentItem, newItem);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tdecomposition.subscribe('updateParentItem', onUpdateItem);\n\n\t\t\tdecomposition.decomposeItem(parentItem);\n\t\t};\n\t\tconst onTagsSearchOpen = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst inputObject = data.inputObject;\n\t\t\tconst enteredHashTagName = data.enteredHashTagName;\n\t\t\tthis.tagSearcher.showTagsSearchDialog(inputObject, enteredHashTagName);\n\t\t};\n\t\tconst onTagsSearchClose = () => {\n\t\t\tthis.tagSearcher.closeTagsSearchDialog();\n\t\t};\n\t\tconst onEpicSearchOpen = (baseEvent: BaseEvent) => {\n\t\t\tconst data = baseEvent.getData();\n\t\t\tconst inputObject = data.inputObject;\n\t\t\tconst enteredHashEpicName = data.enteredHashEpicName;\n\t\t\tthis.tagSearcher.showEpicSearchDialog(inputObject, enteredHashEpicName);\n\t\t};\n\t\tconst onEpicSearchClose = () => {\n\t\t\tthis.tagSearcher.closeEpicSearchDialog();\n\t\t};\n\t\tconst onFilterByEpic = (baseEvent: BaseEvent) => {\n\t\t\tconst epicId = baseEvent.getData();\n\t\t\tconst currentValue = this.filter.getValueFromField({name: 'EPIC', value: ''});\n\t\t\tif (String(epicId) === String(currentValue))\n\t\t\t{\n\t\t\t\tthis.filter.setValueToField({name: 'EPIC', value: ''});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.filter.setValueToField({name: 'EPIC', value: String(epicId)});\n\t\t\t}\n\t\t\tthis.filter.scrollToSearchContainer();\n\t\t};\n\t\tconst onFilterByTag = (baseEvent: BaseEvent) => {\n\t\t\tconst tag = baseEvent.getData();\n\t\t\tconst currentValue = this.filter.getValueFromField({name: 'TAG', value: ''});\n\t\t\tif (String(tag) === String(currentValue))\n\t\t\t{\n\t\t\t\tthis.filter.setValueToField({name: 'TAG', value: ''});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.filter.setValueToField({name: 'TAG', value: String(tag)});\n\t\t\t}\n\t\t\tthis.filter.scrollToSearchContainer();\n\t\t};\n\t\tconst onActivateGroupMode = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tif (entity.getId() !== this.entityStorage.getBacklog().getId())\n\t\t\t{\n\t\t\t\tthis.entityStorage.getBacklog().deactivateGroupMode();\n\t\t\t}\n\t\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\t\tif (entity.getId() !== sprint.getId())\n\t\t\t\t{\n\t\t\t\t\tsprint.deactivateGroupMode();\n\t\t\t\t}\n\t\t\t});\n\t\t\tentity.getItems().forEach((item: Item) => {\n\t\t\t\titem.activateGroupMode();\n\t\t\t});\n\t\t};\n\t\tconst onDeactivateGroupMode = (baseEvent: BaseEvent) => {\n\t\t\tconst entity = baseEvent.getTarget();\n\t\t\tentity.getItems().forEach((item: Item) => {\n\t\t\t\titem.deactivateGroupMode();\n\t\t\t});\n\t\t};\n\t\tconst onGetSprintCompletedItems = (baseEvent: BaseEvent) => {\n\t\t\tconst sprint = baseEvent.getTarget();\n\t\t\tconst listItemsNode = sprint.getListItemsNode();\n\t\t\tconst listPosition = this.domBuilder.getPosition(listItemsNode);\n\t\t\tconst loader = new Loader({\n\t\t\t\ttarget: listItemsNode,\n\t\t\t\tsize: 60,\n\t\t\t\tmode: 'inline',\n\t\t\t\tcolor: '#eaeaea',\n\t\t\t\toffset: {\n\t\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t\t}\n\t\t\t});\n\t\t\tloader.show();\n\t\t\tthis.requestSender.getSprintCompletedItems({\n\t\t\t\tsprintId: sprint.getId()\n\t\t\t}).then((response) => {\n\t\t\t\tconst itemsData = response.data;\n\t\t\t\titemsData.forEach((itemData) => {\n\t\t\t\t\tconst item = new Item(itemData);\n\t\t\t\t\titem.setDisableStatus(sprint.isDisabled());\n\t\t\t\t\tthis.domBuilder.append(item.render(), listItemsNode);\n\t\t\t\t\tsprint.setItem(item);\n\t\t\t\t});\n\t\t\t\tloader.hide();\n\t\t\t}).catch((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t};\n\n\t\tconst subscribeToSprint = (sprint) => {\n\t\t\tsprint.subscribe('createTaskItem', createTaskItem);\n\t\t\tsprint.subscribe('updateItem', onUpdateItem);\n\t\t\tsprint.subscribe('showTask', onShowTask);\n\t\t\tsprint.subscribe('moveItem', onMoveItem);\n\t\t\tsprint.subscribe('moveToSprint', onMoveToSprint);\n\t\t\tsprint.subscribe('moveToBacklog', onMoveToBacklog);\n\t\t\tsprint.subscribe('removeItem', onRemoveItem);\n\t\t\tsprint.subscribe('startSprint', onStartSprint);\n\t\t\tsprint.subscribe('completeSprint', onCompleteSprint);\n\t\t\tsprint.subscribe('changeTaskResponsible', onChangeTaskResponsible);\n\t\t\tsprint.subscribe('removeSprint', onRemoveSprint);\n\t\t\tsprint.subscribe('changeSprintName', onChangeSprintName);\n\t\t\tsprint.subscribe('changeSprintDeadline', onChangeSprintDeadline);\n\t\t\tsprint.subscribe('attachFilesToTask', onAttachFilesToTask);\n\t\t\tsprint.subscribe('showTagSearcher', onShowTagSearcher);\n\t\t\tsprint.subscribe('showEpicSearcher', onShowEpicSearcher);\n\t\t\tsprint.subscribe('startDecomposition', onStartDecomposition);\n\t\t\tsprint.subscribe('tagsSearchOpen', onTagsSearchOpen);\n\t\t\tsprint.subscribe('tagsSearchClose', onTagsSearchClose);\n\t\t\tsprint.subscribe('epicSearchOpen', onEpicSearchOpen);\n\t\t\tsprint.subscribe('epicSearchClose', onEpicSearchClose);\n\t\t\tsprint.subscribe('filterByEpic', onFilterByEpic);\n\t\t\tsprint.subscribe('filterByTag', onFilterByTag);\n\t\t\tsprint.subscribe('activateGroupMode', onActivateGroupMode);\n\t\t\tsprint.subscribe('deactivateGroupMode', onDeactivateGroupMode);\n\t\t\tsprint.subscribe('getSprintCompletedItems', onGetSprintCompletedItems);\n\t\t\tsprint.subscribe('showSprintBurnDownChart', onShowSprintBurnDownChart);\n\t\t\tsprint.subscribe('toggleSubTasks', this.onToggleSubTasks.bind(this));\n\t\t};\n\n\t\tif (newSprint)\n\t\t{\n\t\t\tsubscribeToSprint(newSprint);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.entityStorage.getBacklog().subscribe('createTaskItem', createTaskItem);\n\t\tthis.entityStorage.getBacklog().subscribe('updateItem', onUpdateItem);\n\t\tthis.entityStorage.getBacklog().subscribe('showTask', onShowTask);\n\t\tthis.entityStorage.getBacklog().subscribe('moveItem', onMoveItem);\n\t\tthis.entityStorage.getBacklog().subscribe('moveToSprint', onMoveToSprint);\n\t\tthis.entityStorage.getBacklog().subscribe('removeItem', onRemoveItem);\n\t\tthis.entityStorage.getBacklog().subscribe('changeTaskResponsible', onChangeTaskResponsible);\n\t\tthis.entityStorage.getBacklog().subscribe('openAddEpicForm', onOpenAddEpicForm);\n\t\tthis.entityStorage.getBacklog().subscribe('openListEpicGrid', onOpenListEpicGrid);\n\t\tthis.entityStorage.getBacklog().subscribe('openDefinitionOfDone', onOpenDefinitionOfDone);\n\t\tthis.entityStorage.getBacklog().subscribe('attachFilesToTask', onAttachFilesToTask);\n\t\tthis.entityStorage.getBacklog().subscribe('showTagSearcher', onShowTagSearcher);\n\t\tthis.entityStorage.getBacklog().subscribe('showEpicSearcher', onShowEpicSearcher);\n\t\tthis.entityStorage.getBacklog().subscribe('startDecomposition', onStartDecomposition);\n\t\tthis.entityStorage.getBacklog().subscribe('tagsSearchOpen', onTagsSearchOpen);\n\t\tthis.entityStorage.getBacklog().subscribe('tagsSearchClose', onTagsSearchClose);\n\t\tthis.entityStorage.getBacklog().subscribe('epicSearchOpen', onEpicSearchOpen);\n\t\tthis.entityStorage.getBacklog().subscribe('epicSearchClose', onEpicSearchClose);\n\t\tthis.entityStorage.getBacklog().subscribe('filterByEpic', onFilterByEpic);\n\t\tthis.entityStorage.getBacklog().subscribe('filterByTag', onFilterByTag);\n\t\tthis.entityStorage.getBacklog().subscribe('activateGroupMode', onActivateGroupMode);\n\t\tthis.entityStorage.getBacklog().subscribe('deactivateGroupMode', onDeactivateGroupMode);\n\n\t\tthis.epic.subscribe('filterByTag', onFilterByTag);\n\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tsubscribeToSprint(sprint);\n\t\t});\n\t}\n\n\tcreateItem(itemType: String, value: String): Item\n\t{\n\t\t//todo test\n\n\t\tconst valueWithoutTags = value\n\t\t\t.replace(new RegExp('#([^\\\\s]*)','g'), '')\n\t\t\t.replace(new RegExp('@([^\\\\s]*)','g'),'');\n\n\t\treturn new Item({\n\t\t\t'itemId': '',\n\t\t\t'itemType': itemType,\n\t\t\t'name': valueWithoutTags\n\t\t});\n\t}\n\n\tsendRequestToCreateTask(entity: Entity, item: Item, value: String): Promise\n\t{\n\t\tconst requestData = {\n\t\t\t'tmpId': item.getItemId(),\n\t\t\t'itemType': item.getItemType(),\n\t\t\t'name': value,\n\t\t\t'entityId': item.getEntityId(),\n\t\t\t'entityType': entity.getEntityType(),\n\t\t\t'parentId': item.getParentId(),\n\t\t\t'sort': item.getSort(),\n\t\t\t'storyPoints': item.getStoryPoints().getPoints(),\n\t\t\t'tags': item.getTags(),\n\t\t\t'epic': item.getEpic(),\n\t\t\t'parentSourceId': item.getParentSourceId(),\n\t\t\t'responsible': item.getResponsible(),\n\t\t\t'info': item.getInfo(),\n\t\t\t'sortInfo': this.itemMover.calculateSort(entity.getListItemsNode()),\n\t\t\t'isActiveSprint': ((entity.getEntityType() === 'sprint' && entity.isActive()) ? 'Y' : 'N')\n\t\t};\n\t\treturn this.requestSender.createTask(requestData);\n\t}\n\n\tfillItemBeforeCreation(entity: Entity, item: Item, value: string)\n\t{\n\t\titem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\titem.setSort(1);\n\t\titem.setResponsible(this.defaultResponsible);\n\n\t\tconst tags = TagSearcher.getHashTagNamesFromText(value);\n\t\tconst epicName = TagSearcher.getHashEpicNamesFromText(value).pop();\n\n\t\tlet inputEpic = null;\n\t\tif (epicName)\n\t\t{\n\t\t\tinputEpic = this.tagSearcher.getEpicByName(epicName.trim());\n\t\t}\n\n\t\tif (inputEpic || tags.length > 0)\n\t\t{\n\t\t\titem.setEpicAndTags(inputEpic, tags);\n\t\t}\n\t}\n\n\tfillItemAfterCreation(item: Item, responseData: Object): Item\n\t{\n\t\t//todo test\n\n\t\titem.setItemId(responseData.itemId);\n\t\tif (!Type.isArray(responseData.epic) || responseData.tags.length > 0)\n\t\t{\n\t\t\titem.setEpicAndTags(responseData.epic, responseData.tags);\n\t\t}\n\t\titem.setResponsible(responseData.responsible);\n\t\titem.setSourceId(responseData.sourceId);\n\t\titem.setAllowedActions(responseData.allowedActions);\n\t}\n\n\tonToggleSubTasks(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst item = baseEvent.getData();\n\n\t\tthis.subTasksCreator.toggleSubTasks(sprint, item);\n\t}\n\n\topenEpicEditForm(epicId)\n\t{\n\t\tthis.epic.openEditForm(epicId);\n\t}\n\n\topenEpicViewForm(epicId)\n\t{\n\t\tthis.epic.openViewForm(epicId);\n\t}\n\n\tremoveEpic(epicId)\n\t{\n\t\tthis.requestSender.removeItem({\n\t\t\titemId: epicId,\n\t\t\titemType: 'epic'\n\t\t}).then((response) => {\n\t\t\tconst epicInfo = response.data;\n\t\t\tthis.epic.onAfterRemoveEpic(epicInfo);\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonShowTeamSpeedChart() //todo move to class\n\t{\n\t\tconst projectSidePanel = new ProjectSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\t\tprojectSidePanel.showTeamSpeedChart();\n\t}\n}","import {Event, Dom, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {View} from './view';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\nimport {StatsHeaderBuilder} from '../entity/sprint/stats.header.builder';\nimport {Item} from '../item/item';\n\nimport type {SprintParams} from '../entity/sprint/sprint';\nimport type {Views} from './view';\n\ntype Params = {\n\tpathToTask: string,\n\tviews: Views,\n\tactiveSprint: SprintParams,\n\tsprints: Array<SprintParams>\n}\n\nexport class ActiveSprint extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ActiveSprint');\n\n\t\tthis.setParams(params);\n\n\t\tif (this.existActiveSprint())\n\t\t{\n\t\t\tthis.finishStatus = this.getActiveSprintParams().finishStatus;\n\n\t\t\tthis.sprint = new Sprint(this.getActiveSprintParams());\n\n\t\t\tthis.itemsInFinishStage = new Map();\n\n\t\t\tthis.initDomNodes();\n\t\t\tthis.createSprintStats();\n\t\t\tthis.bindHandlers();\n\t\t}\n\n\t\tthis.sidePanel = new SidePanel();\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.setPathToTask(params.pathToTask);\n\t\tthis.setActiveSprintParams(params.activeSprint);\n\n\t\tthis.sprints = new Map();\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tconst sprint = new Sprint(sprintData);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t});\n\n\t\tthis.views = params.views;\n\t}\n\n\tsetPathToTask(pathToTask: string)\n\t{\n\t\tthis.pathToTask = (Type.isString(pathToTask) ? pathToTask : '');\n\t}\n\n\tgetPathToTask(): string\n\t{\n\t\treturn this.pathToTask;\n\t}\n\n\tsetActiveSprintParams(params: SprintParams)\n\t{\n\t\tthis.activeSprint = (Type.isPlainObject(params) ? params : null);\n\t}\n\n\tgetActiveSprintParams(): SprintParams\n\t{\n\t\treturn this.activeSprint;\n\t}\n\n\texistActiveSprint(): boolean\n\t{\n\t\treturn (this.activeSprint !== null);\n\t}\n\n\tinitDomNodes()\n\t{\n\t\tthis.sprintStatsContainer = document.getElementById('tasks-scrum-active-sprint-stats');\n\t\tconst buttonsContainer = document.getElementById('tasks-scrum-actions-complete-sprint');\n\t\tthis.chartSprintButtonNode = buttonsContainer.firstElementChild;\n\t\tthis.completeSprintButtonNode = buttonsContainer.lastElementChild;\n\t}\n\n\tcreateSprintStats()\n\t{\n\t\tthis.statsHeader = StatsHeaderBuilder.build(this.sprint);\n\t\tthis.statsHeader.setKanbanStyle();\n\t\tDom.append(this.statsHeader.render(), this.sprintStatsContainer);\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEvent.bind(this.chartSprintButtonNode, 'click', this.onShowSprintBurnDownChart.bind(this));\n\t\tEvent.bind(this.completeSprintButtonNode, 'click', this.onCompleteSprint.bind(this));\n\n\t\t// eslint-disable-next-line\n\t\tconst kanbanManager = BX.Tasks.Scrum.Kanban;\n\t\tif (kanbanManager)\n\t\t{\n\t\t\tthis.bindKanbanHandlers(kanbanManager.getKanban());\n\t\t\tkanbanManager.getKanbansGroupedByParentTasks().forEach((kanban) => {\n\t\t\t\tthis.bindKanbanHandlers(kanban);\n\t\t\t});\n\t\t}\n\t}\n\n\tbindKanbanHandlers(kanban)\n\t{\n\t\tthis.onKanbanRender(kanban);\n\n\t\tEventEmitter.subscribe(kanban, 'Kanban.Grid:onItemMoved', (event: BaseEvent) => {\n\t\t\tconst [kanbanItem, targetColumn, beforeItem] = event.getCompatData();\n\t\t\tthis.onItemMoved(kanbanItem, targetColumn, beforeItem);\n\t\t});\n\t}\n\n\tonCompleteSprint()\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsprints: this.sprints,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showCompleteSidePanel(this.sprint);\n\n\t\tthis.sprint.subscribe('showTask', (baseEvent) => {\n\t\t\tconst item = baseEvent.getData();\n\t\t\tthis.sidePanel.openSidePanelByUrl(this.getPathToTask().replace('#task_id#', item.getSourceId()));\n\t\t});\n\t}\n\n\t/**\n\t * Handles Kanban render.\n\t * @param {BX.Tasks.Kanban.Grid} kanbanGrid\n\t * @returns {void}\n\t */\n\tonKanbanRender(kanbanGrid)\n\t{\n\t\tconst items = kanbanGrid.getItems();\n\t\tconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\t\tfor (let itemId in kanbanGrid.getItems())\n\t\t{\n\t\t\tif (hasOwnProperty.call(items, itemId))\n\t\t\t{\n\t\t\t\tconst item = items[itemId];\n\t\t\t\tif (item.getColumn().getType() === this.finishStatus)\n\t\t\t\t{\n\t\t\t\t\tthis.itemsInFinishStage.set(itemId, '');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Hook on item moved.\n\t * @param {BX.Tasks.Kanban.Item} kanbanItem\n\t * @param {BX.Tasks.Kanban.Column} targetColumn\n\t * @param {BX.Tasks.Kanban.Item} [beforeItem]\n\t * @returns {void}\n\t */\n\tonItemMoved(kanbanItem, targetColumn, beforeItem)\n\t{\n\t\tif (targetColumn.type === this.finishStatus)\n\t\t{\n\t\t\tif (!this.itemsInFinishStage.has(kanbanItem.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedToFinish(kanbanItem, this.sprint);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.itemsInFinishStage.has(kanbanItem.getId()))\n\t\t\t{\n\t\t\t\tthis.updateStatsAfterMovedFromFinish(kanbanItem, this.sprint);\n\t\t\t}\n\t\t}\n\n\t\tthis.statsHeader.updateStats(this.sprint);\n\t}\n\n\tupdateStatsAfterMovedToFinish(kanbanItem, sprint: Sprint)\n\t{\n\t\tthis.itemsInFinishStage.set(kanbanItem.getId(), kanbanItem.getStoryPoints());\n\n\t\tsprint.getTotalCompletedStoryPoints().addPoints(kanbanItem.getStoryPoints());\n\t\tsprint.getTotalUncompletedStoryPoints().subtractPoints(kanbanItem.getStoryPoints());\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() + 1);\n\t\tsprint.setUncompletedTasks(sprint.getUncompletedTasks() - 1);\n\n\t\tsprint.getItems().forEach((scrumItem: Item) => {\n\t\t\tif (scrumItem.getSourceId() === parseInt(kanbanItem.getId(), 10))\n\t\t\t{\n\t\t\t\tscrumItem.setCompleted('Y');\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateStatsAfterMovedFromFinish(kanbanItem, sprint: Sprint)\n\t{\n\t\tthis.itemsInFinishStage.delete(kanbanItem.getId());\n\n\t\tsprint.getTotalCompletedStoryPoints().subtractPoints(kanbanItem.getStoryPoints());\n\t\tsprint.getTotalUncompletedStoryPoints().addPoints(kanbanItem.getStoryPoints());\n\n\t\tsprint.setCompletedTasks(sprint.getCompletedTasks() - 1);\n\t\tsprint.setUncompletedTasks(sprint.getUncompletedTasks() + 1);\n\n\t\tsprint.getItems().forEach((scrumItem: Item) => {\n\t\t\tif (scrumItem.getSourceId() === parseInt(kanbanItem.getId(), 10))\n\t\t\t{\n\t\t\t\tscrumItem.setCompleted('N');\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowSprintBurnDownChart()\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(this.sprint);\n\t}\n}","import {Event, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\n\nimport {View} from './view';\n\nimport type {Views} from './view';\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\tviews: Views,\n\tcompletedSprint: SprintParams,\n\tsprints: Array<SprintParams>\n}\n\nexport class CompletedSprint extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.CompletedSprint');\n\n\t\tthis.setParams(params);\n\n\t\tthis.initDomNodes();\n\t\tthis.bindHandlers();\n\t\tthis.createTitle();\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.completedSprint = new Sprint(params.completedSprint);\n\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.sprints = new Map();\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t});\n\t\tthis.views = params.views;\n\t}\n\n\tinitDomNodes()\n\t{\n\t\tthis.chartSprintButtonNode = document.getElementById('tasks-scrum-completed-sprint-chart');\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEventEmitter.subscribe('onTasksGroupSelectorChange', this.onSprintSelectorChange.bind(this));\n\n\t\tEvent.bind(this.chartSprintButtonNode, 'click', this.onShowSprintBurnDownChart.bind(this));\n\t}\n\n\tcreateTitle()\n\t{\n\t\tthis.titleContainer = document.getElementById('tasks-scrum-completed-sprint-title');\n\t\tthis.titleContainer.textContent = Text.encode(this.completedSprint.getName());\n\t}\n\n\tonSprintSelectorChange(event: BaseEvent)\n\t{\n\t\tconst [currentSprint] = event.getCompatData()\n\n\t\tthis.completedSprint = this.findSprintBySprintId(currentSprint.sprintId);\n\n\t\tthis.titleContainer.textContent = Text.encode(currentSprint.name);\n\t}\n\n\tonShowSprintBurnDownChart()\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\trequestSender: this.requestSender,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(this.completedSprint);\n\t}\n\n\tfindSprintBySprintId(sprintId: number): Sprint\n\t{\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === parseInt(sprintId, 10));\n\t}\n}","import {View} from './view/view';\nimport {Plan} from './view/plan';\nimport {ActiveSprint} from './view/active.sprint';\nimport {CompletedSprint} from './view/completed.sprint';\n\ntype Params = {\n\tviewName: string\n}\n\nexport class Entry\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.setParams(params);\n\n\t\tthis.buildView(params);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.setViewName(params.viewName);\n\t}\n\n\tsetViewName(viewName: string)\n\t{\n\t\tconst availableViews = new Set([\n\t\t\t'plan',\n\t\t\t'activeSprint',\n\t\t\t'completedSprint'\n\t\t]);\n\n\t\tif (!availableViews.has(viewName))\n\t\t{\n\t\t\tthrow Error('Invalid value to activeView parameter');\n\t\t}\n\n\t\tthis.viewName = viewName;\n\t}\n\n\tgetViewName(): string\n\t{\n\t\treturn this.viewName;\n\t}\n\n\tsetView(view: View)\n\t{\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.view = view;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.view = null;\n\t\t}\n\t}\n\n\tgetView(): View\n\t{\n\t\treturn this.view;\n\t}\n\n\tbuildView(params: Params)\n\t{\n\t\tconst viewName = this.getViewName();\n\n\t\tif (viewName === 'plan')\n\t\t{\n\t\t\tthis.setView(new Plan(params));\n\t\t}\n\t\telse if (viewName === 'activeSprint')\n\t\t{\n\t\t\tthis.setView(new ActiveSprint(params));\n\t\t}\n\t\telse if (viewName === 'completedSprint')\n\t\t{\n\t\t\tthis.setView(new CompletedSprint(params));\n\t\t}\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderTo(container);\n\t\t}\n\t}\n\n\trenderCountersTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderCountersTo(container);\n\t\t}\n\t}\n\n\topenEpicEditForm(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.openEpicEditForm(epicId);\n\t\t}\n\t}\n\n\topenEpicViewForm(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.openEpicViewForm(epicId);\n\t\t}\n\t}\n\n\tremoveEpic(epicId: number)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof Plan)\n\t\t{\n\t\t\tview.removeEpic(epicId);\n\t\t}\n\t}\n}"],"names":["RequestSender","options","signedParameters","debugMode","action","data","Promise","resolve","reject","ajax","runAction","then","runComponentAction","mode","sendRequestToComponent","sendRequest","response","alertTitle","Type","isUndefined","errors","console","log","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","Filter","params","setEventNamespace","filterId","requestSender","searchFieldApplied","initUiFilterManager","bindHandlers","filterManager","BX","Main","getById","EventEmitter","subscribe","onApplyFilter","bind","getSearch","getContainer","filterSearchContainer","getSearchContainer","isNodeInViewport","scrollIntoView","event","getCompatData","values","filterInstance","promise","getSearchString","autoResolve","emit","name","item","fieldInstances","getField","fieldOptions","getFieldByName","ITEMS","push","itemsNode","node","querySelector","items","Dom","attr","value","filterApi","getApi","filterFieldsValues","getFilterFieldsValues","setFields","apply","resetFields","forEach","resetFilter","applyFilter","element","rect","getBoundingClientRect","top","left","bottom","window","innerHeight","document","documentElement","clientHeight","right","innerWidth","clientWidth","Counters","filter","counters","isOwnerCurrentUser","userId","groupId","container","isDomNode","Error","isEmptyCounters","append","renderCounters","isNodeCreated","destroy","className","text","Tag","render","newCommentsInfo","commentsNumber","parseInt","counter","renderTitle","getCommentsLabel","renderReadAllButton","commentIcon","commentText","onMouseEnter","addClass","onMouseLeave","removeClass","Event","applyFilterRequiringAttentionToComments","readAllButton","onClickReadAll","readAllTasksComment","clean","catch","showErrorAlert","remove","count","setValuesToField","View","scrumManager","renderTo","DiskManager","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","attachedIds","controlId","Text","getRandom","popup","Popup","content","getAttachmentsLoaderContent","autoHide","closeByEsc","angle","show","Disk","UF","add","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","close","filesChooser","addCustomEvent","onFileUploadSuccess","fileResult","uf","file","uploaderFile","element_id","toString","ActionsPanel","actionPanelNodeId","bindElement","itemList","task","activity","attachment","move","sprint","backlog","tags","epic","decomposition","listBlockBlurNodes","Set","getElementById","actionsPanelContainer","calculatePanelPosition","createActionPanel","setBlockBlurNode","body","customBlur","hasNode","blockBlurNode","contains","target","unbind","bindItems","actionsPanel","hasClass","lastElementChild","Boolean","showTaskActionButtonNodeId","showAttachmentActionButtonNodeId","showMoveActionButtonNodeId","sprintActionButtonNodeId","backlogActionButtonNodeId","tagsActionButtonNodeId","epicActionButtonNodeId","decompositionActionButtonNodeId","removeActionButtonNodeId","callback","panel","position","getPosition","fakePanel","cloneNode","style","visibility","isPanelWiderThanViewport","fakePanelRect","windowWidth","zIndex","TaskCounts","setItemId","itemId","setAttachedFilesCount","attachedFilesCount","setCheckListComplete","checkListComplete","setCheckListAll","checkListAll","setNewCommentsCount","newCommentsCount","isInteger","isString","indicatorsNodeId","indicatorsNode","attachmentNode","checklistNode","commentsNode","updateVisibility","firstElementChild","textContent","innerCommentCounter","showNode","hideNode","StoryPoints","clearPoints","differencePoints","storyPoints","saveDifferencePoints","String","isNaN","parseFloat","currentStoryPoints","inputStoryPoints","result","isFloat","toFixed","firstPoints","secondPoints","Item","setItemParams","groupMode","previewMode","setItemNode","setTmpId","tmpId","setName","setItemType","itemType","setSort","sort","setEntityId","entityId","setEntityType","entityType","setParentId","parentId","setSourceId","sourceId","setParentSourceId","parentSourceId","setResponsible","responsible","setStoryPoints","setInfo","info","setCompleted","completed","setDisableStatus","isCompleted","setAllowedActions","allowedActions","setEpic","setTags","setParentTask","isParentTask","setSubTasksCount","subTasksCount","setLinkedTask","isLinkedTask","setParentTaskId","parentTaskId","setSubTask","isSubTask","setTaskCounts","getItemNode","dataset","nameNode","encode","type","setPreviousSort","previousSort","has","isPlainObject","updateResponsible","setPoints","storyPointsNode","getStoryPoints","getPoints","sendEventToUpdateStoryPoints","updateCompletedStatus","isArray","parentTask","linkedTask","id","subTask","taskCounts","color","borderColor","setBorderColor","getBorderColor","nameTextNode","disableStatus","moveActivity","status","groupModeContainer","groupModeCheckbox","checked","toggleClass","classList","showActionsPanel","deactivateDragNDrop","unbindAll","activateDragNDrop","previewItem","Runtime","clone","itemNode","activatePreviewMode","decompositionMode","HTMLElement","e","tmpItem","getName","getEntityId","getResponsible","getTaskCounts","updateIndicators","getAttachedFilesCount","getCheckListComplete","getCheckListAll","getNewCommentsCount","getParentId","setEpicAndTags","getEpic","getTags","getInfo","getSubTasksCount","getParentTaskId","updateParentTaskNodes","itemClassName","renderName","renderIndicators","renderSubTasksCounter","renderResponsible","renderStoryPoints","renderSubTasksTick","renderTags","subTasksCounter","getEntityType","subTasksTick","isDecompositionMode","toggle","getEpicTag","getListTagNodes","getContrastYIQ","hexcolor","Label","Color","DEFAULT","replace","r","substr","g","b","yiq","epicLabel","size","Size","MD","customClass","innerLabel","contrast","isGroupMode","clickToGroupModeCheckbox","map","tag","tagLabel","TAG_LIGHT","fill","SM","onAfterAppend","isPreviewMode","onItemClick","onNameClick","responsibleNode","onResponsibleClick","onStoryPointsClick","subTasksCounterNode","paramsNode","insertBefore","subTasksTickNode","newSubTasksTickNode","isClickOnEditableName","ignoreTagList","tagName","closest","isEditAllowed","targetNode","contentEditable","isDisabled","currentTarget","borderNode","valueNode","trim","oldValue","placeCursorAtEnd","blockEnterInput","bindOnce","newValue","getItemId","getItemType","click","dialog","Dialog","enableSearch","context","events","hide","selectedItem","getData","getId","getTitle","photo","src","getAvatar","entities","inviteEmployeeLink","isComposing","keyCode","blur","isShown","stopPropagation","diskManager","ufDiskFilesFieldName","subscribeOnce","baseEvent","showAttachmentMenu","isMovable","isRemoveAllowed","confirm","messageBox","showPanel","updateTagsContainer","newContainer","tagsContainerNode","focus","selection","getSelection","range","createRange","selectNodeContents","collapse","removeAllRanges","addRange","GroupActionsButton","onClick","ListItems","entity","getInput","getItems","TagSearcher","allTags","Map","set","tabs","avatar","epicName","description","get","delete","tagsList","epicList","getCurrentActionsPanel","currentTags","selectedItems","currentTag","createTag","tagDialog","getTagSelector","getTextBoxValue","focusSearch","addTagToSearcher","newTag","getTagFromSearcher","addItem","select","clearTextBox","selectFirstTab","label","choiceWasMade","width","height","multiple","dropdownMode","getTagsList","deselectedItem","tagSelectorOptions","onInput","selector","getDialog","footer","currentEpic","currentEpicInfo","getEpicList","epicId","setTimeout","getSelectedItems","placeholder","inputObject","enteredHashTagName","input","getInputNode","tagsDialog","getNodeId","getNode","offsetWidth","selectedHashTag","hashTags","getHashTagsFromText","enteredHashTag","pop","RegExp","deselect","setTagsSearchMode","search","enteredHashEpicName","epicDialog","selectedHashEpic","setEpicId","setEpicSearchMode","inputText","regex","matches","match","exec","Input","nodeId","disabled","setNode","onTagSearch","onEpicSearch","onKeydown","inputNode","enteredHashTags","getHashTagNamesFromText","isTagsSearchMode","enteredHashEpics","getHashEpicNamesFromText","isEpicSearchMode","onCreateTaskItem","Entity","setEntityParams","groupModeItems","groupActionsButton","listItems","setId","setViews","views","setNumberTasks","numberTasks","exactSearchApplied","isExactSearchApplied","onActivateGroupMode","onDeactivateGroupMode","listItemsNode","getListItemsNode","querySelectorAll","newItem","subscribeToItem","setItemMoveActivity","addNumberTasks","setMoveActivity","unsubscribeAll","subtractNumberTasks","getTarget","updateStoryPoints","button","getGroupModeItems","groupModeItem","removeItem","removeYourself","addItemToGroupMode","removeItemFromGroupMode","addPoints","hasInput","nextElementSibling","isEqualNode","deactivateGroupMode","disable","unDisable","clear","Header","getNumberTasks","getElementByClassName","parentNode","elements","elem","EpicCreationButton","Backlog","setBacklogParams","header","epicCreationButton","itemData","updateNumberTasks","backlogData","addHeader","addEpicCreationButton","addGroupActionsButton","addListItems","SprintDate","defaultSprintDuration","getDefaultSprintDuration","startTimestamp","endTimestamp","isActive","dateStart","date","format","dateEnd","renderNode","timestamp","dateStartNode","dateEndNode","parentPopup","calendar","showCalendar","field","bTime","bSetFocus","bHideTime","updateDateNode","Math","floor","parseDate","getTime","dateStartInput","dateEndInput","sprintId","weekCount","StatsCalculator","first","second","round","StatsHeader","setSprintData","statsCalculator","weekendDaysTime","getWeekendDaysTime","headerNode","headerClass","kanbanMode","getTotalStoryPoints","setCompletedStoryPoints","getTotalCompletedStoryPoints","setUncompletedStoryPoints","getTotalUncompletedStoryPoints","setEndDate","getDateEnd","completedStoryPoints","uncompletedStoryPoints","endDate","Date","now","CompletedStatsHeader","percentage","calculatePercentage","getCompletedStoryPoints","completedDate","getCompletedDate","getEndDate","ExpiredStatsHeader","expiredDay","getExpiredDay","ActiveStatsHeader","remainingDays","getRemainingDays","dateWithWeekendOffset","setSeconds","getSeconds","msPerMinute","msPerHour","msPerDay","daysRemaining","StatsHeaderBuilder","isExpired","SprintHeader","statsHeader","sprintDate","buttonClass","buttonText","buttonNode","hideContent","isPlanned","addHeaderStats","build","addHeaderDate","firstChild","replaceWith","renderParams","renderDragnDrop","renderRemove","tickAngleClass","renderStatsHeader","createDate","getDateStart","createButton","updateStats","updateDateStartNode","updateDateEndNode","buttonNodeId","onButtonClick","editButtonNode","removeNode","tickButtonNode","sprintHeader","EventsHeader","StoryPointsHeader","totalStoryPointsNode","inWorkStoryPointsNode","doneStoryPointsNode","renderBurnDownChartIcon","Sprint","setSprintParams","eventsHeader","storyPointsHeader","setDateStart","setDateEnd","setWeekendDaysTime","setDefaultSprintDuration","setStatus","setTotalStoryPoints","totalStoryPoints","setTotalCompletedStoryPoints","totalCompletedStoryPoints","setTotalUncompletedStoryPoints","totalUncompletedStoryPoints","setCompletedTasks","completedTasks","setUncompletedTasks","uncompletedTasks","setItems","initStyle","onChangeName","onRemoveSprint","onChangeSprintDeadline","toggleVisibilityContent","getStatus","sprintEnd","updateNameNode","itemParams","sprintGoal","epics","availableStatus","tmpSprint","addStoryPointsHeader","renderLinkToCompletedSprint","getViews","completedSprint","url","updateActiveSprintStoryPointsHeader","updateStatsHeader","itemStoryPoints","subtractPoints","getCompletedTasks","getUncompletedTasks","createInput","setSelectionRange","requestData","hasOwnProperty","getContentNode","display","showContent","isEmpty","showSprint","hideSprint","sprintData","addSprintHeader","buildHeader","addEventsHeader","SidePanel","sidePanelManager","Instance","bindEvents","sliderEvent","sidePanel","getSlider","setCacheable","currentSidePanel","getPreviousSlider","getTopSlider","reload","previousSidePanel","open","BurnDownChart","chartDiv","am4core","useTheme","am4themes_animated","chart","create","am4charts","XYChart","paddingRight","createAxises","createIdealLine","createRemainLine","createLegend","categoryAxis","xAxes","CategoryAxis","renderer","grid","template","location","dataFields","category","minGridDistance","valueAxis","yAxes","ValueAxis","min","lineSeries","series","LineSeries","stroke","strokeWidth","categoryX","valueY","circleColor","circleBullet","CircleBullet","circle","radius","bullets","segment","segments","hoverState","states","properties","legend","Legend","itemContainers","clickable","on","processOver","dataItem","dataContext","processOut","hoveredLine","toFront","each","setState","bulletsContainer","dispose","SprintSidePanel","sprints","currentSprint","uncompletedItems","lastCompletedSprint","getLastCompletedSprint","sidePanelId","onLoadStartPanel","openSidePanel","contentCallback","buildStartPanel","onLoadCompletePanel","buildCompletePanel","onLoadSprintBurnDownPanel","onCloseBurnDownChart","buildBurnDownPanel","differenceStoryPoints","getDifferenceStoryPointsBetweenSprints","getEpics","form","onLoadStartButtons","buttonsContainer","onStartSprint","buildSprintGoal","buildSprintActions","buildSprintPlan","sprintInfo","listSprintsOptions","getUncompletedItems","getPreviewVersion","differencePercentage","getDifferencePercentageBetweenSprints","percentageNodeClass","absoluteValue","abs","speedInfoMessage","renderSpeed","itemsContainer","onLoadCompleteButtons","onCompleteSprint","getBurnDownChartData","burnDownChart","createChart","getUrl","destroyBurnDownChart","find","firstSprint","secondSprint","difference","firstPercentage","secondPercentage","getSprintStartButtons","html","getSprintCompleteButtons","getRequestDataToGetBurnDownChartData","getStartButtons","buttonsHtml","getCompleteButtons","startSprint","getRequestDataToStartSprint","href","removeClockIconFromButton","completeSprint","getRequestDataToCompleteSprint","Confetti","fire","particleCount","spread","origin","x","y","getZindex","directionSelectNode","direction","EntityStorage","entityFrom","recalculateItemsSort","backlogItems","getSourceId","ItemStyleDesigner","entityStorage","listAllUsedColors","updateBorderColorForLinkedItems","itemIdsToUpdateColor","getAllItems","getAllUsedColors","getRandomColor","getAllColors","updateBorderColorToLinkedItems","Object","fromEntries","updatedItems","keys","findItemByItemId","colorPicker","getColorPicker","allColors","getDefaultColors","defaultColors","randomColor","random","isThisBorderColorAlreadyUse","isAlreadyUse","usedColor","entityIds","getAllEntities","getAllUsedItemBorderColors","ColorPicker","DomBuilder","scrumContainer","getBacklog","renderSprintsContainer","getSprints","sprintCreatingButtonNode","sprintCreatingButtonNodeId","sprintCreatingDropZoneNode","sprintCreatingDropZoneNodeId","sprintListNode","sprintListNodeId","createSprint","setDraggable","draggableItems","Draggable","draggable","dragElement","DROP_PREVIEW","delay","dragEndEvent","draggableSprints","createCreatingButton","createCreatingDropZone","createSprintsList","countSprints","children","buildSprint","addSprint","addContainer","current","newItemNode","bindItemNode","parentElement","SubTasksManager","domBuilder","listSubTasks","visibilityList","hideSubTaskItems","showSubTaskItems","toggleSubTasksTick","getSubTaskItems","taskId","listItemParams","listSubTaskItems","subTaskItem","buildSubTaskItem","parentItem","parentItemNode","setItem","appendItemAfterItem","setVisibility","cleanVisibility","Decomposition","itemStyleDesigner","subTasksCreator","setPlaceholder","addDecomposedItem","isBacklogDecomposition","onDecomposeItem","toggleSubTasks","lastSubTask","getSubTasks","targetItemNode","insertAfter","onCreateItem","firstDecomposition","cleanSubTasks","deactivateDecompositionMode","Array","from","decomposedItems","getDecomposedItems","lastDecomposedItem","subTasks","activateDecompositionMode","saveSelectedResponsible","getRandomColorForItemBorder","getParentItem","iterator","next","FilterHandler","fadeOutAll","filterInfo","updateExactSearchStatusToEntities","fulfill","filteredItemsData","findEntityByEntityId","buildItem","updateVisibilityToEntities","fadeInAll","setExactSearchApplied","isSearchFieldApplied","fadeOut","fadeIn","Epic","tagSearcher","defaultColor","selectedColor","onLoadAddForm","buildAddForm","onLoadEditForm","buildEditForm","onLoadViewForm","buildViewForm","onBeforeGridRequest","onLoadListGrid","destroyGrid","onLoadEditor","onLoadColorPicker","onLoadAddButtons","createEpic","getRequestData","onAfterCreateEpic","isPreviousSidePanelExist","reloadPreviousSidePanel","openEpicsList","onLoadDescription","onLoadFiles","onLoadViewButtons","openEditForm","onLoadEditButtons","editEpic","reloadGrid","gridManager","gridId","instance","getDescriptionEditor","editorHtml","descriptionContainer","editor","LHEPostForm","getHandler","BXHtmlEditor","Get","eventNode","getEpicDescription","filesContainer","getEpicFiles","colorBlockNode","colorNode","picker","getAddEpicFormButtons","getViewEpicFormButtons","list","getEpicsList","responseData","prepareTagsList","openAddForm","getEmptyEpicListForm","eventArgs","sessid","bitrix_sessid","method","getEpicListUrl","getSignedParameters","buildFormHeader","buildFormContainerHeader","editorId","getEpicDescriptionEditor","getViewEpicFormButtonsAction","onColorSelected","backgroundColor","popupOptions","colors","oEditor","GetContent","files","getAttachmentsFiles","arFiles","controllers","fileControllers","controller","includes","fileController","fileId","tagsContainers","tagsContainer","getTagsFromNode","getTagNode","childNodes","childNode","closeTopSidePanel","addEpicToSearcher","addItemToListTypeField","NAME","VALUE","itemEpic","oldEpicInfo","getCurrentEpic","removeEpicFromSearcher","reloadTopSidePanel","TeamSpeedChart","scrollbarX","Scrollbar","parent","bottomAxesContainer","createColumn","xAxis","labels","wrap","maxWidth","yAxis","ColumnSeries","paddingBottom","ProjectSidePanel","onLoadTeamSpeedChartPanel","onCloseTeamSpeedChart","buildTeamSpeedPanel","onLoadDodPanel","buildDodPanel","getTeamSpeedChartData","teamSpeedChart","destroyChart","getDodComponent","dodContainer","getDodPanelData","prepareDodOptionsContainer","getDodButtons","saveDod","getRequestDataForSaveList","getEntityChecklistItems","required","getDodItemsRequired","Tasks","CheckListInstance","treeStructure","getTreeStructure","optionsContainer","option","PullSprint","listIdsToSkipAdding","listIdsToSkipUpdating","listIdsToSkipRemoving","sprintAdded","onSprintAdded","sprintUpdated","onSprintUpdated","sprintRemoved","onSprintRemoved","needSkipAdd","cleanSkipAdd","createSprintNode","needSkipUpdate","cleanSkipUpdate","moveSprintToActiveListNode","moveSprintToCompletedListNode","updateYourself","needSkipRemove","cleanSkipRemove","removeSprint","getTmpId","ItemMover","source","sourceContainer","sourceEntityId","sourceEntity","hideSubTasks","endContainer","endEntityId","onItemMove","onMoveConfirm","itemNodeAfterSourceItem","getSort","findEntityByItemId","listToMove","isFirstItem","onclick","menuItem","sortedItems","sortedItemsIds","moveItemToUp","updateItemSort","sortInfo","calculateSort","getMenuWindow","isLastItem","moveItemToDown","showMoveItemMenu","entityWithInput","updateSort","updateItemsSort","updateItem","getSprintCreatingDropZoneNode","createNewSprintAndMoveItem","moveTo","moveInCurrentContainer","moveInAnotherContainer","endEntity","moveItemFromEntityToEntity","fromActiveSprint","toActiveSprint","updatedItemsIds","moveToAnotherEntity","listSortInfo","isSortUpdated","updatedItemId","targetEntity","bindButton","isMoveToSprint","isNull","getSprintsAvailableForFilling","showListSprintsToMove","moveToWithGroupMode","entityTo","after","update","batchUpdateItem","entityListNode","onMoveItemUpdate","bindItemSort","isMoveFromAnotherEntity","getPreviousSort","subtractTotalStoryPoints","addTotalStoryPoints","setParentEntity","moveToSprintMenu","getPopupWindow","setBindElement","Menu","isSameSprint","addMenuItem","moveItemMenu","PullItem","itemMover","currentUserId","listToAddAfterUpdate","listIdsToSkipSorting","onCalculateSort","itemAdded","onItemAdded","itemUpdated","onItemUpdated","itemRemoved","onItemRemoved","itemSortUpdated","onItemSortUpdated","comment_add","onCommentAdd","setDelayedAdd","externalAdd","finally","cleanDelayedAdd","addItemToEntity","isDelayedAdd","itemsSortInfo","itemsToSort","itemsInfoToSort","entries","needSkipSort","itemInfoToSort","targetEntityId","moveToPosition","participants","xmlId","entityXmlId","split","findItemBySourceId","getCurrentState","updateState","isParentChangeAction","prototype","call","addTmpIdToSkipSorting","PullEpic","epicAdded","onEpicAdded","epicUpdated","onEpicUpdated","epicRemoved","onEpicRemoved","epicData","onAfterUpdateEpic","onAfterRemoveEpic","SprintMover","onSprintMove","updateSprintSort","calculateSprintSort","increment","getSprintPlannedListNode","sprintNode","sprintSort","Plan","pathToTask","defaultResponsible","activeSprintId","addBacklog","buildBacklog","filterHandler","pullSprint","addTmpIdToSkipAdding","sprintMover","pullItem","getCurrentUserId","pullEpic","subscribeToPull","Pull","newSprint","teamSpeedChartButtonContainerNode","onShowTeamSpeedChart","createTaskItem","inputValue","createItem","addTmpIdsToSkipAdding","fillItemBeforeCreation","getEpicId","sendRequestToCreateTask","fillItemAfterCreation","onUpdateItem","updateData","addIdToSkipUpdating","onShowTask","openSidePanelByUrl","onMoveItem","moveItem","onMoveToSprint","onMoveToBacklog","onAttachFilesToTask","attachFilesToTask","onRemoveItem","addIdToSkipRemoving","batchRemoveItem","sprintSidePanel","showStartSidePanel","showCompleteSidePanel","onShowSprintBurnDownChart","showBurnDownChart","onChangeTaskResponsible","changeTaskResponsible","onChangeSprintName","changeSprintName","changeSprintDeadline","onOpenAddEpicForm","onOpenListEpicGrid","innerBaseEvent","updatedEpicInfo","onOpenDefinitionOfDone","projectSidePanel","showDefinitionOfDone","onShowTagSearcher","actionsPanelButton","showTagsDialog","tasks","batchAttachTagToTask","attachTagToTask","batchDeattachTagToTask","splice","indexOf","deAttachTagToTask","onShowEpicSearcher","showEpicDialog","batchUpdateItemEpic","updateItemEpic","onStartDecomposition","onTagsSearchOpen","onTagsSearchClose","getLastDecomposedItemNode","addSubTask","decomposeItem","showTagsSearchDialog","closeTagsSearchDialog","onEpicSearchOpen","showEpicSearchDialog","onEpicSearchClose","closeEpicSearchDialog","onFilterByEpic","currentValue","getValueFromField","setValueToField","scrollToSearchContainer","onFilterByTag","activateGroupMode","onGetSprintCompletedItems","listPosition","loader","Loader","offset","getSprintCompletedItems","itemsData","subscribeToSprint","onToggleSubTasks","valueWithoutTags","getParentSourceId","createTask","inputEpic","getEpicByName","openViewForm","epicInfo","showTeamSpeedChart","ActiveSprint","setParams","existActiveSprint","finishStatus","getActiveSprintParams","itemsInFinishStage","initDomNodes","createSprintStats","setPathToTask","setActiveSprintParams","activeSprint","sprintStatsContainer","chartSprintButtonNode","completeSprintButtonNode","setKanbanStyle","kanbanManager","Scrum","Kanban","bindKanbanHandlers","getKanban","getKanbansGroupedByParentTasks","kanban","onKanbanRender","kanbanItem","targetColumn","beforeItem","onItemMoved","getPathToTask","kanbanGrid","getColumn","getType","updateStatsAfterMovedToFinish","updateStatsAfterMovedFromFinish","scrumItem","CompletedSprint","createTitle","onSprintSelectorChange","titleContainer","findSprintBySprintId","Entry","buildView","setViewName","viewName","availableViews","view","getViewName","setView","getView","renderCountersTo","openEpicEditForm","openEpicViewForm","removeEpic"],"mappings":"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"}