{"version":3,"file":"script.js","sources":["src/service/side.panel.js","src/utility/request.sender.js","src/service/filter.js","src/view/header/tabs.js","src/view/view.js","src/service/disk.manager.js","src/item/task/toggle.js","src/utility/tool.js","src/item/task/name.js","src/item/task/checklist.js","src/item/task/files.js","src/item/task/comments.js","src/item/task/epic.js","src/item/task/tags.js","src/item/task/responsible.js","src/utility/story.points.storage.js","src/item/task/story.points.js","src/item/task/sub.tasks.js","src/item/item.js","src/entity/list.items.js","src/utility/tag.searcher.js","src/utility/input.js","src/entity/entity.js","src/entity/backlog/header.js","src/entity/blank.js","src/entity/dropzone.js","src/entity/empty.search.stub.js","src/entity/backlog/backlog.js","src/utility/culture.js","src/entity/sprint/header/date.js","src/entity/sprint/stats/stats.calculator.js","src/entity/sprint/stats/stats.js","src/entity/sprint/stats/completed.stats.js","src/entity/sprint/stats/expired.stats.js","src/entity/sprint/stats/active.stats.js","src/entity/sprint/stats/stats.builder.js","src/entity/sprint/header/stats.js","src/entity/sprint/header/name.js","src/entity/sprint/header/info/chart.icon.js","src/entity/sprint/header/info/counters.js","src/entity/sprint/header/info/button.js","src/entity/sprint/header/info/info.js","src/entity/sprint/header/button.js","src/entity/sprint/header/tick.js","src/entity/sprint/header/header.js","src/entity/sprint/sprint.js","src/entity/entity.storage.js","src/utility/scroller.js","src/view/plan/completed.sprints.js","src/view/plan/plan.builder.js","src/entity/action.panel.js","src/entity/search.arrows.js","src/entity/search.items.js","src/entity/sprint/sprint.mover.js","src/entity/sprint/sprint.side.panel.js","src/counters/entity.counters.js","src/item/item.mover.js","src/item/item.designer.js","src/epic/epic.js","src/pull/pull.sprint.js","src/pull/pull.item.js","src/pull/pull.epic.js","src/pull/pull.counters.js","src/counters/task.counters.js","src/utility/filter.handler.js","src/utility/decomposition.js","src/pull/pull.tag.js","src/view/plan/plan.js","src/view/header/complete.sprint.button.js","src/view/header/robot.button.js","src/view/active.sprint.js","src/view/header/burn.down.button.js","src/view/completed.sprint.js","src/entry.js"],"sourcesContent":["import {EventEmitter, BaseEvent} from 'main.core.events';\n\nexport class SidePanel extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SidePanel');\n\n\t\t/* eslint-disable */\n\t\tthis.sidePanelManager = BX.SidePanel.Instance;\n\t\t/* eslint-enable */\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onLoad', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tsidePanel.setCacheable(false);\n\t\t\tthis.emit('onLoadSidePanel', sidePanel);\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\t\t\tconst sidePanel = sliderEvent.getSlider();\n\t\t\tthis.emit('onCloseSidePanel', sidePanel);\n\t\t});\n\t}\n\n\tisPreviousSidePanelExist(currentSidePanel): Boolean\n\t{\n\t\treturn Boolean(this.sidePanelManager.getPreviousSlider(currentSidePanel));\n\t}\n\n\tgetTopSidePanel()\n\t{\n\t\tconst topSidePanel = this.sidePanelManager.getTopSlider();\n\n\t\treturn topSidePanel ? topSidePanel : null;\n\t}\n\n\treloadTopSidePanel()\n\t{\n\t\tif (this.sidePanelManager.getTopSlider())\n\t\t{\n\t\t\tthis.sidePanelManager.getTopSlider().reload();\n\t\t}\n\t}\n\n\tcloseTopSidePanel()\n\t{\n\t\tif (this.sidePanelManager.getTopSlider())\n\t\t{\n\t\t\tthis.sidePanelManager.getTopSlider().close();\n\t\t}\n\t}\n\n\treloadPreviousSidePanel(currentSidePanel)\n\t{\n\t\tconst previousSidePanel = this.sidePanelManager.getPreviousSlider(currentSidePanel);\n\n\t\tpreviousSidePanel.reload();\n\t}\n\n\topenSidePanelByUrl(url)\n\t{\n\t\tthis.sidePanelManager.open(url);\n\t}\n\n\topenSidePanel(id, options)\n\t{\n\t\tthis.sidePanelManager.open(id, options);\n\t}\n\n\tshowByExtension(name: string, params: Object): Promise\n\t{\n\t\tconst extensionName = 'tasks.scrum.' + name.toLowerCase();\n\n\t\treturn top.BX.Runtime.loadExtension(extensionName)\n\t\t\t.then((exports) => {\n\n\t\t\t\tname = name.replaceAll('-', '');\n\n\t\t\t\tif (exports && exports[name])\n\t\t\t\t{\n\t\t\t\t\tconst extension = new exports[name](params);\n\n\t\t\t\t\textension.show();\n\n\t\t\t\t\treturn extension;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n}","import {ajax, Loc, Type} from 'main.core';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\ntype ErrorResponse = {\n\tdata: string,\n\terrors: Array,\n\tstatus: string\n}\n\nexport class RequestSender\n{\n\tconstructor(options = {})\n\t{\n\t\tthis.signedParameters = (options.signedParameters ? options.signedParameters : '');\n\t\tthis.debugMode = options.debugMode;\n\t}\n\n\tgetSignedParameters(): string\n\t{\n\t\treturn this.signedParameters;\n\t}\n\n\tsendRequest(action: string, data = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(action, {\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tsendRequestToComponent(data = {}, action, analyticsLabel = {}): Promise\n\t{\n\t\tdata.debugMode = this.debugMode;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runComponentAction('bitrix:tasks.scrum', action, {\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\tdata: data,\n\t\t\t\tanalyticsLabel: analyticsLabel\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tremoveItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeItems');\n\t}\n\n\tupdateItemSort(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItemSort');\n\t}\n\n\taddTag(data): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runComponentAction('bitrix:tasks.tag.list', 'addTag', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: data,\n\t\t\t}).then(resolve, reject);\n\t\t});\n\t}\n\n\tupdateSprintSort(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateSprintSort');\n\t}\n\n\tcreateSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'createSprint');\n\t}\n\n\tstartSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'startSprint');\n\t}\n\n\tcompleteSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'completeSprint');\n\t}\n\n\tcreateTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(\n\t\t\tdata,\n\t\t\t'createTask',\n\t\t\t{\n\t\t\t\tscrum: 'Y',\n\t\t\t\taction: 'create_task',\n\t\t\t}\n\t\t);\n\t}\n\n\tupdateItem(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItem');\n\t}\n\n\tchangeTaskResponsible(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeTaskResponsible');\n\t}\n\n\tgetCurrentState(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getCurrentState');\n\t}\n\n\thasTaskInFilter(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'hasTaskInFilter');\n\t}\n\n\tremoveSprint(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeSprint');\n\t}\n\n\tchangeSprintName(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeSprintName');\n\t}\n\n\tchangeSprintDeadline(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'changeSprintDeadline');\n\t}\n\n\tgetSprintCompletedItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintCompletedItems');\n\t}\n\n\tgetCompletedSprints(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getCompletedSprints');\n\t}\n\n\tgetCompletedSprintsStats(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getCompletedSprintsStats');\n\t}\n\n\tgetItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getItems');\n\t}\n\n\tsaveShortView(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'saveShortView');\n\t}\n\n\tsaveDisplayPriority(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'saveDisplayPriority');\n\t}\n\n\tgetEntityCounters(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getEntityCounters');\n\t}\n\n\tattachFilesToTask(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'attachFilesToTask');\n\t}\n\n\tupdateTaskTags(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateTaskTags');\n\t}\n\n\tremoveTaskTags(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeTaskTags');\n\t}\n\n\tupdateItemEpics(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateItemEpics');\n\t}\n\n\tupdateBorderColorToLinkedItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'updateBorderColorToLinkedItems');\n\t}\n\n\teditEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'editEpic');\n\t}\n\n\tremoveEpic(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'removeEpic');\n\t}\n\n\tapplyFilter(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'applyFilter');\n\t}\n\n\tshowLinkedTasks(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'showLinkedTasks');\n\t}\n\n\tgetAllUsedItemBorderColors(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getAllUsedItemBorderColors');\n\t}\n\n\tgetSubTaskItems(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSubTaskItems');\n\t}\n\n\tcreateEpic(data): Promise\n\t{\n\t\treturn this.sendRequest('bitrix:tasks.scrum.epic.createEpic', data);\n\t}\n\n\tgetItemData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getItemData');\n\t}\n\n\tgetSprintData(data): Promise\n\t{\n\t\treturn this.sendRequestToComponent(data, 'getSprintData');\n\t}\n\n\tshowErrorAlert(response: ErrorResponse, alertTitle?: string)\n\t{\n\t\tif (Type.isUndefined(response.errors))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tconst firstError = response.errors.shift();\n\t\t\tif (firstError)\n\t\t\t{\n\t\t\t\tconst errorCode = (firstError.code ? firstError.code : '');\n\n\t\t\t\tconst message = firstError.message + ' ' + errorCode;\n\t\t\t\tconst title = (alertTitle ? alertTitle : Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\n\t\t\t\tMessageBox.alert(message, title);\n\t\t\t}\n\t\t}\n\t}\n}\n","import {Dom, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {RequestSender} from '../utility/request.sender';\n\ntype ListTypeItem = {\n\tNAME: string,\n\tVALUE: string\n}\n\ntype ValueTypeField = {\n\tname: string,\n\tvalue: string\n}\n\ntype Params = {\n\tfilterId: string,\n\trequestSender?: RequestSender\n}\n\nexport class Filter extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Filter');\n\n\t\tthis.filterId = params.filterId;\n\t\tthis.requestSender = params.requestSender;\n\n\t\tthis.searchFieldApplied = false;\n\n\t\tthis.initUiFilterManager();\n\t\tthis.bindHandlers();\n\t}\n\n\tinitUiFilterManager()\n\t{\n\t\t/* eslint-disable */\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\t\t/* eslint-enable */\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onApplyFilter.bind(this));\n\t}\n\n\tisSearchFieldApplied(): boolean\n\t{\n\t\treturn this.searchFieldApplied;\n\t}\n\n\tgetSearchContainer(): HTMLElement\n\t{\n\t\treturn this.filterManager.getSearch().getContainer();\n\t}\n\n\tgetFilterManager()\n\t{\n\t\treturn this.filterManager;\n\t}\n\n\tscrollToSearchContainer()\n\t{\n\t\tconst filterSearchContainer = this.getSearchContainer();\n\n\t\tif (!this.isNodeInViewport(filterSearchContainer))\n\t\t{\n\t\t\tfilterSearchContainer.scrollIntoView(true);\n\t\t}\n\t}\n\n\tonApplyFilter(event: BaseEvent)\n\t{\n\t\tconst [filterId, values, filterInstance, promise, params] = event.getCompatData();\n\n\t\tif (filterInstance.getSearch().getSearchString())\n\t\t{\n\t\t\tthis.searchFieldApplied = true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.searchFieldApplied = false;\n\t\t}\n\n\t\tif (this.filterId !== filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams.autoResolve = true;\n\n\t\tthis.emit('applyFilter', {\n\t\t\tpromise: promise\n\t\t});\n\t}\n\n\taddItemToListTypeField(name: string, item: ListTypeItem)\n\t{\n\t\t//todo set item to list after epic crud actions\n\n\t\tconst fieldInstances = this.filterManager.getField(name);\n\t\tconst fieldOptions = this.filterManager.getFieldByName(name);\n\n\t\tif (!fieldInstances || !fieldOptions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst found = fieldInstances.options.ITEMS.find((listItem) => listItem.NAME === item.NAME);\n\t\tif (!Type.isUndefined(found))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfieldInstances.options.ITEMS.push(item);\n\t\tfieldOptions.ITEMS.push(item);\n\n\t\tconst itemsNode = fieldInstances.node.querySelector('[data-name='+name+']');\n\n\t\tconst items = Dom.attr(itemsNode, 'data-items');\n\t\titems.push(item);\n\t\tDom.attr(itemsNode, 'data-items', items);\n\t}\n\n\tsetValueToField(value: ValueTypeField)\n\t{\n\t\tthis.filterManager.getApi().extendFilter({[value.name]: value.value});\n\t}\n\n\tsetValuesToField(values: ValueTypeField[])\n\t{\n\t\tthis.filterManager.getApi().extendFilter(\n\t\t\tvalues.reduce((res, value) => ({ ...res, [value.name]: value.value}), {})\n\t\t);\n\t}\n\n\tgetValueFromField(value: ValueTypeField): string\n\t{\n\t\tconst filterFieldsValues = this.filterManager.getFilterFieldsValues();\n\t\treturn filterFieldsValues[value.name];\n\t}\n\n\tresetFilter()\n\t{\n\t\tthis.filterManager.resetFilter();\n\t}\n\n\tapplyFilter()\n\t{\n\t\tthis.filterManager.applyFilter();\n\t}\n\n\tisNodeInViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\t\treturn (\n\t\t\trect.top >= 0 &&\n\t\t\trect.left >= 0 &&\n\t\t\trect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n\t\t\trect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t);\n\t}\n}","import {Event, Tag, Text} from 'main.core';\n\nimport {SidePanel} from '../../service/side.panel';\n\nimport type {Views} from '../view';\n\ntype Params = {\n\tsidePanel: SidePanel,\n\tviews: Views\n}\n\nexport class Tabs\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.views = params.views;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst planTabActiveClass = (\n\t\t\tthis.views['plan'].active\n\t\t\t? 'tasks-view-switcher--item --active'\n\t\t\t: ''\n\t\t);\n\t\tconst activeTabActiveClass = (\n\t\t\tthis.views['activeSprint'].active\n\t\t\t? 'tasks-view-switcher--item --active'\n\t\t\t: ''\n\t\t);\n\t\tconst completedTabActiveClass = (\n\t\t\tthis.views['completedSprint'].active\n\t\t\t? 'tasks-view-switcher--item --active'\n\t\t\t: ''\n\t\t);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-view-switcher\">\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['plan'].url}\"\n\t\t\t\t\tclass=\"tasks-view-switcher--item ${planTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['plan'].name)}</a>\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['activeSprint'].url}\"\n\t\t\t\t\tclass=\"tasks-view-switcher--item ${activeTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['activeSprint'].name)}</a>\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.views['completedSprint'].url}\"\n\t\t\t\t\tclass=\"tasks-view-switcher--item ${completedTabActiveClass}\"\n\t\t\t\t>${Text.encode(this.views['completedSprint'].name)}</a>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.node.querySelectorAll('a').forEach((tab: HTMLElement) => {\n\t\t\tEvent.bind(tab, 'click', () => {\n\t\t\t\tconst topSidePanel = this.sidePanel.getTopSidePanel()\n\t\t\t\tif (topSidePanel !== null)\n\t\t\t\t{\n\t\t\t\t\ttopSidePanel.showLoader();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn this.node;\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\nimport {Filter} from '../service/filter';\n\nimport {RequestSender} from '../utility/request.sender';\n\nimport {Tabs} from './header/tabs';\n\nimport '../css/base.css';\n\nexport type ViewInfo = {\n\tname: string,\n\turl: string,\n\tactive: boolean\n}\n\nexport type Views = {\n\tplan: ViewInfo,\n\tactiveSprint: ViewInfo,\n\tcompletedSprint: ViewInfo\n}\n\ntype Params = {\n\tsignedParameters: string,\n\tdebugMode: string,\n\tisOwnerCurrentUser: 'Y' | 'N',\n\tuserId: number,\n\tgroupId: number,\n\tfilterId: string,\n\tpathToTask: string\n}\n\nexport class View extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.View');\n\n\t\tthis.isOwnerCurrentUser = (params.isOwnerCurrentUser === 'Y');\n\n\t\tthis.loadItemsRepeatCounter = new Map();\n\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.requestSender = new RequestSender({\n\t\t\tsignedParameters: params.signedParameters,\n\t\t\tdebugMode: params.debugMode\n\t\t});\n\n\t\tthis.filter = new Filter({\n\t\t\tfilterId: params.filterId,\n\t\t\tscrumManager: this,\n\t\t\trequestSender: this.requestSender\n\t\t});\n\t\tthis.filter.subscribe('applyFilter', this.onApplyFilter.bind(this));\n\n\t\tthis.userId = parseInt(params.userId, 10);\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\tthis.pathToTask = (Type.isString(params.pathToTask) ? params.pathToTask : '');\n\t}\n\n\tonApplyFilter(baseEvent: BaseEvent)\n\t{\n\t\tthis.loadItemsRepeatCounter.clear();\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for scrum not found');\n\t\t}\n\t}\n\n\trenderTabsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for tabs not found');\n\t\t}\n\n\t\tconst tabs = new Tabs({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tviews: this.views\n\t\t});\n\n\t\tDom.append(tabs.render(), container);\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for Sprint stats not found');\n\t\t}\n\t}\n\n\trenderRightElementsTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('Scrum: HTMLElement for buttons not found');\n\t\t}\n\t}\n\n\tsetDisplayPriority(value: string)\n\t{\n\t\tconst availableValues = new Set([\n\t\t\t'backlog',\n\t\t\t'sprint',\n\t\t]);\n\n\t\tif (!availableValues.has(value))\n\t\t{\n\t\t\tthrow Error('Invalid parameter to set display priority');\n\t\t}\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn this.userId;\n\t}\n\n\tgetCurrentGroupId(): number\n\t{\n\t\treturn this.groupId;\n\t}\n\n\tgetPathToTask(): string\n\t{\n\t\treturn this.pathToTask;\n\t}\n}","import {Loc, Tag, Text, Type} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\n\nimport '../css/disk.manager.css';\n\ntype Params = {\n\ttargetElement: HTMLElement\n}\n\nexport class DiskManager extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DiskManager');\n\n\t\tthis.targetElement = params.targetElement;\n\n\t\tthis.diskUrls = {\n\t\t\turlSelect: '/bitrix/tools/disk/uf.php?action=selectFile&SITE_ID=' + Loc.getMessage('SITE_ID'),\n\t\t\turlRenameFile: '/bitrix/tools/disk/uf.php?action=renameFile',\n\t\t\turlDeleteFile: '/bitrix/tools/disk/uf.php?action=deleteFile',\n\t\t\turlUpload: '/bitrix/tools/disk/uf.php?action=uploadFile&ncc=1'\n\t\t};\n\n\t\tthis.attachedIds = [];\n\t}\n\n\tshowAttachmentMenu(node)\n\t{\n\t\tconst controlId = Text.getRandom();\n\n\t\tthis.popup = new Popup(\n\t\t\t`disk-manager-attachment-menu-${Text.getRandom()}`,\n\t\t\tnode,\n\t\t\t{\n\t\t\t\tcontent: this.getAttachmentsLoaderContent(controlId),\n\t\t\t\tautoHide: false,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: false,\n\t\t\t\toffsetTop: 12,\n\t\t\t\toffsetLeft: -32\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.subscribe('onShow', () => {\n\t\t\tBX.Disk.UF.add({\n\t\t\t\tUID: controlId,\n\t\t\t\tcontrolName: `[${controlId}][]`,\n\t\t\t\thideSelectDialog: false,\n\t\t\t\turlSelect: this.diskUrls.urlSelect,\n\t\t\t\turlRenameFile: this.diskUrls.urlRenameFile,\n\t\t\t\turlDeleteFile: this.diskUrls.urlDeleteFile,\n\t\t\t\turlUpload: this.diskUrls.urlUpload,\n\t\t\t});\n\n\t\t\tconst filesChooser = this.popup.contentContainer.querySelector('#files_chooser');\n\n\t\t\t/* eslint-disable */\n\t\t\tBX.onCustomEvent(filesChooser, 'DiskLoadFormController', ['show']);\n\t\t\t/* eslint-enable */\n\n\t\t\tif (BX.DiskFileDialog)\n\t\t\t{\n\t\t\t\tEventEmitter.subscribe(BX.DiskFileDialog, 'loadItemsDone', this.openDiskFileDialog.bind(this));\n\t\t\t}\n\t\t});\n\n\t\tthis.popup.subscribe('onClose', () => {\n\t\t\tthis.emit('onFinish', this.attachedIds);\n\t\t});\n\n\t\tEventEmitter.subscribe('onFinish', () => this.popup.close());\n\n\t\tthis.popup.show();\n\t}\n\n\tcloseAttachmentMenu()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\t}\n\n\tisClickInside(node: HTMLElement): boolean\n\t{\n\t\tlet isClickInside = false;\n\n\t\tif (this.targetElement.contains(node))\n\t\t{\n\t\t\tisClickInside = true;\n\t\t}\n\n\t\tif (this.popup && this.popup.getPopupContainer().contains(node))\n\t\t{\n\t\t\tisClickInside = true;\n\t\t}\n\n\t\tif (\n\t\t\tBX.DiskFileDialog\n\t\t\t&& BX.DiskFileDialog.popupWindow !== null\n\t\t\t&& BX.DiskFileDialog.popupWindow.getPopupContainer().contains(node)\n\t\t)\n\t\t{\n\t\t\tisClickInside = true;\n\t\t}\n\n\t\treturn isClickInside;\n\t}\n\n\topenDiskFileDialog()\n\t{\n\t\tif (BX.DiskFileDialog.popupWindow !== null)\n\t\t{\n\t\t\tBX.DiskFileDialog.popupWindow.subscribe('onClose', () => this.popup.close());\n\t\t}\n\t}\n\n\tgetAttachmentsLoaderContent(controlId): HTMLElement\n\t{\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t<div id=\"diskuf-selectdialog-${controlId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t<div class=\"diskuf-files-block\">\n\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t<input type=\"hidden\" name=\"[${controlId}][]\" value=\"\"/>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<label for=\"file_loader_${controlId}\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclass=\"diskuf-fileUploader\"\n\t\t\t\t\t\t\tid=\"file_loader_${controlId}\"\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\tmultiple=\"multiple\"\n\t\t\t\t\t\t\tsize=\"1\"\n\t\t\t\t\t\t\tstyle=\"display: none\"\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_SCRUM_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\t/* eslint-disable */\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.onFileUploadSuccess.bind(this));\n\t\t/* eslint-enable */\n\n\t\treturn filesChooser;\n\t}\n\n\tonFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (Type.isUndefined(file) || Type.isUndefined(uploaderFile))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.attachedIds.push(fileResult.element_id.toString());\n\t}\n}","import {Event, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\ntype Params = {\n\tvisible: boolean\n}\n\nexport class Toggle extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item.Toggle');\n\n\t\tthis.visible = params.visible;\n\n\t\tthis.shown = false;\n\t\tthis.disabled = false;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__item--btn-toggle-tasks ${this.visible ? '--visible' : ''}\"></div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tonClick()\n\t{\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.disable();\n\n\t\tif (this.isShown())\n\t\t{\n\t\t\tthis.emit('hide');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('show');\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tthis.shown = true;\n\n\t\tthis.unDisable();\n\t}\n\n\thide()\n\t{\n\t\tthis.shown = false;\n\n\t\tthis.unDisable();\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.shown;\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn this.disabled;\n\t}\n\n\tdisable()\n\t{\n\t\tthis.disabled = true;\n\t}\n\n\tunDisable()\n\t{\n\t\tthis.disabled = false;\n\t}\n}","export class Tool\n{\n\tstatic escapeRegex(string: string): string\n\t{\n\t\treturn string.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n\t}\n}","import {Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Tool} from '../../utility/tool';\n\ntype Params = {\n\tname: string,\n\tisCompleted: boolean,\n\tisImportant: boolean,\n\tpathToTask: string,\n\tsourceId: number,\n}\n\nexport class Name extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item.Name');\n\n\t\tthis.value = ((Type.isString(params.name) && params.name) ? params.name.trim() : '');\n\t\tthis.important = params.isImportant;\n\t\tthis.completed = params.isCompleted;\n\t\tthis.sourceId = params.sourceId;\n\n\t\tthis.pathToTask = this.sourceId ? params.pathToTask.replace('#task_id#', this.sourceId) : null;\n\n\t\tif (!this.value)\n\t\t{\n\t\t\tthrow new Error(Loc.getMessage('TASKS_SCRUM_TASK_ADD_NAME_ERROR'));\n\t\t}\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet visualClasses = this.completed ? '--completed' : '';\n\t\tvisualClasses += this.important ? ' --important' : '';\n\n\t\tlet value = Text.encode(this.value);\n\t\tif (this.important)\n\t\t{\n\t\t\tconst words = this.value.split(' ');\n\t\t\tconst lastWord = words[words.length - 1];\n\t\t\tvalue = value.replace(new RegExp(Tool.escapeRegex(lastWord) + '$'), `<span>${lastWord}</span>`);\n\t\t}\n\n\t\tif (this.pathToTask)\n\t\t{\n\t\t\tthis.node = Tag.render`\n\t\t\t\t<a\n\t\t\t\t\thref=\"${Text.encode(this.pathToTask)}\"\n\t\t\t\t\tclass=\"tasks-scrum__item--title ${visualClasses}\"\n\t\t\t\t>\n\t\t\t\t\t${value}\n\t\t\t\t</a>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.node, 'click', () => {\n\t\t\t\tthis.emit('urlClick');\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.node = Tag.render`\n\t\t\t\t<div class=\"tasks-scrum__item--title ${visualClasses}\">\n\t\t\t\t\t${value}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\t\t}\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetValue(): string\n\t{\n\t\treturn this.value;\n\t}\n\n\tsetCompleted(value: boolean)\n\t{\n\t\tthis.completed = value;\n\t}\n\n\tstrikeOut()\n\t{\n\t\tDom.addClass(this.node, '--completed');\n\t}\n\n\tunStrikeOut()\n\t{\n\t\tDom.removeClass(this.node, '--completed');\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Event, Tag, Type} from 'main.core';\nimport {EventEmitter} from \"main.core.events\";\n\ntype Params = {\n\tcomplete: number,\n\tall: number\n}\n\nexport class Checklist extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item.Checklist');\n\n\t\tthis.complete = (Type.isInteger(params.complete) ? parseInt(params.complete, 10) : 0);\n\t\tthis.all = (Type.isInteger(params.all) ? parseInt(params.all, 10) : 0);\n\n\t\tthis.value = `${this.complete}/${this.all}`;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst uiClasses = 'ui-label ui-label-sm ui-label-light';\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__item--entity-tasks ${this.all ? '--visible' : ''} ${uiClasses}\">\n\t\t\t\t${this.value}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetValue(): string\n\t{\n\t\treturn this.value;\n\t}\n\n\tgetComplete(): number\n\t{\n\t\treturn this.complete;\n\t}\n\n\tgetAll(): number\n\t{\n\t\treturn this.all;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Event, Tag, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class Files extends EventEmitter\n{\n\tconstructor(count: number)\n\t{\n\t\tsuper(count);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item.Files');\n\n\t\tthis.value = (Type.isInteger(count) ? parseInt(count, 10) : 0);\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst uiClasses = 'ui-label ui-label-sm ui-label-light';\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__item--attachment-counter ${this.value ? '--visible' : ''} ${uiClasses}\">\n\t\t\t\t${this.value}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetValue(): string\n\t{\n\t\treturn this.value;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Event, Tag, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport type TaskCounter = {\n\tcolor: string,\n\tvalue: number\n}\n\nexport class Comments extends EventEmitter\n{\n\tconstructor(taskCounter?: TaskCounter)\n\t{\n\t\tsuper(taskCounter);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item.Comments');\n\n\t\tif (Type.isUndefined(taskCounter) || Type.isNull(taskCounter))\n\t\t{\n\t\t\ttaskCounter = {\n\t\t\t\tcolor: '',\n\t\t\t\tvalue: 0\n\t\t\t};\n\t\t}\n\n\t\tthis.taskCounter = taskCounter;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__item--comment-counter ${this.taskCounter.value ? '--visible' : ''}\">\n\t\t\t\t<div class='ui-counter ${this.taskCounter.color}'>\n\t\t\t\t\t<div class='ui-counter-inner'>${parseInt(this.taskCounter.value, 10)}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetValue(): TaskCounter\n\t{\n\t\treturn this.taskCounter;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Event, Tag, Type, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport type EpicType = {\n\tid: number,\n\tgroupId: number,\n\tname: string,\n\tdescription: string,\n\tcreatedBy: number,\n\tmodifiedBy: number,\n\tcolor: string\n}\n\nexport class Epic extends EventEmitter\n{\n\tconstructor(epic: EpicType)\n\t{\n\t\tsuper(epic);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item.Epic');\n\n\t\tif (Type.isUndefined(epic) || Type.isArray(epic) || Type.isNull(epic))\n\t\t{\n\t\t\tepic = {\n\t\t\t\tid: 0,\n\t\t\t\tgroupId: 0,\n\t\t\t\tname: '',\n\t\t\t\tdescription: '',\n\t\t\t\tcreatedBy: 0,\n\t\t\t\tmodifiedBy: 0,\n\t\t\t\tcolor: ''\n\t\t\t};\n\t\t}\n\n\t\tthis.epic = epic;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__item--epic ${this.epic.id ? '--visible' : ''}\">\n\t\t\t\t<i\n\t\t\t\t\tclass=\"tasks-scrum__item--epic-point\"\n\t\t\t\t\tstyle=\"${`background-color: ${this.epic.color}`}\"\n\t\t\t\t></i>\n\t\t\t\t<span>${Text.encode(this.epic.name)}</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\trenderFullView()\n\t{\n\t\tconst colorBorder = this.convertHexToRGBA(this.epic.color, 0.7);\n\t\tconst colorBackground = this.convertHexToRGBA(this.epic.color, 0.3);\n\n\t\tconst visibility = this.epic.id > 0 ? '--visible' : '';\n\n\t\tthis.node = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-scrum__item--epic-full-view ${visibility}\"\n\t\t\t\tstyle=\"background: ${colorBackground}; border-color: ${colorBorder};\"\n\t\t\t>${Text.encode(this.epic.name)}</div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetValue(): EpicType\n\t{\n\t\treturn this.epic;\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.epic.id;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n\n\tconvertHexToRGBA(hexCode, opacity)\n\t{\n\t\tlet hex = hexCode.replace('#', '');\n\n\t\tif (hex.length === 3)\n\t\t{\n\t\t\thex = `${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;\n\t\t}\n\n\t\tconst r = parseInt(hex.substring(0, 2), 16);\n\t\tconst g = parseInt(hex.substring(2, 4), 16);\n\t\tconst b = parseInt(hex.substring(4, 6), 16);\n\n\t\treturn `rgba(${r},${g},${b},${opacity})`;\n\t}\n}","import {Event, Tag, Text, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class Tags extends EventEmitter\n{\n\tconstructor(tags?: Array<string>)\n\t{\n\t\tsuper(tags);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item.Tags');\n\n\t\tthis.tags = (Type.isArray(tags) ? tags : []);\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement|Array<HTMLElement>\n\t{\n\t\tif (this.tags.length)\n\t\t{\n\t\t\tthis.node = Tag.render`\n\t\t\t\t${this.tags.map((tag) => {\n\t\t\t\t\treturn Tag.render`<div class=\"tasks-scrum__item--hashtag --visible\">#${Text.encode(tag)}</div>`;\n\t\t\t\t})}\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.node = Tag.render`<div class=\"tasks-scrum__item--hashtag\"></div>`\n\t\t}\n\n\t\tif (Type.isArray(this.node))\n\t\t{\n\t\t\tthis.node.forEach((node: HTMLElement) => {\n\t\t\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\t\t}\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement|?Array\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetValue(): Array<string>\n\t{\n\t\treturn this.tags;\n\t}\n\n\tonClick(event)\n\t{\n\t\tthis.emit('click', event.target.textContent.substring(1));\n\t}\n\n\tisEqualTags(tags: Tags): boolean\n\t{\n\t\treturn JSON.stringify(this.getValue()) === JSON.stringify(tags.getValue());\n\t}\n}","import {Tag, Type, Text, Event, Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport type ResponsibleType = {\n\tid: number,\n\tname: string,\n\tpathToUser: string,\n\tphoto?: {\n\t\tsrc: string\n\t}\n}\n\nexport class Responsible  extends EventEmitter\n{\n\tconstructor(responsible: ResponsibleType)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item.Responsible');\n\n\t\tthis.responsible = (Type.isPlainObject(responsible) ? responsible : null);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst uiClasses = 'ui-icon ui-icon-common-user';\n\n\t\tconst name = Text.encode(this.responsible.name);\n\n\t\tconst src = this.responsible.photo ? Text.encode(this.responsible.photo.src) : null;\n\t\tconst photoStyle = src ? `background-image: url('${encodeURI(src)}');` : '';\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__item--responsible\">\n\t\t\t\t<div class=\"tasks-scrum__item--responsible-photo ${uiClasses}\" title=\"${name}\">\n\t\t\t\t\t<i style=\"${photoStyle}\"></i>\n\t\t\t\t</div>\n\t\t\t\t<span>${name}</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.node.querySelector('div'), 'click', this.onClick.bind(this));\n\t\tEvent.bind(this.node.querySelector('span'), 'click', this.onClick.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetValue(): ResponsibleType\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Type} from 'main.core';\n\nexport class StoryPointsStorage\n{\n\tconstructor()\n\t{\n\t\tthis.storyPoints = '';\n\t}\n\n\tsetPoints(storyPoints: string)\n\t{\n\t\tif (storyPoints === '')\n\t\t{\n\t\t\tthis.storyPoints = '';\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tType.isUndefined(storyPoints)\n\t\t\t|| (Type.isFloat(storyPoints) && isNaN(parseFloat(storyPoints)))\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isFloat(storyPoints))\n\t\t{\n\t\t\tstoryPoints = parseFloat(storyPoints).toFixed(1);\n\t\t}\n\n\t\tthis.storyPoints = String(storyPoints);\n\t}\n\n\tgetPoints(): string\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tclearPoints()\n\t{\n\t\tthis.storyPoints = '';\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.storyPoints === '';\n\t}\n}","import {Event, Tag, Text, Dom, Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {StoryPointsStorage} from '../../utility/story.points.storage';\n\nexport class StoryPoints  extends EventEmitter\n{\n\tconstructor(storyPoints: string)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item.StoryPoints');\n\n\t\tthis.storyPointsStorage = new StoryPointsStorage();\n\n\t\tthis.storyPointsStorage.setPoints(storyPoints);\n\n\t\tthis.disableStatus = false;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst value = Text.encode(this.storyPointsStorage.getPoints());\n\n\t\tthis.node = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-scrum__item--story-points ${this.storyPointsStorage.isEmpty() ? '--empty' : ''}\"\n\t\t\t\ttitle=\"${Loc.getMessage('TASKS_SCRUM_SPRINT_HEADER_STORY_POINTS')}\"\n\t\t\t>\n\t\t\t\t<div class=\"tasks-scrum__item--story-points-content\">\n\t\t\t\t\t<div class=\"tasks-scrum__item--story-points-element\">\n\t\t\t\t\t\t${this.storyPointsStorage.isEmpty() ? '-' : value}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__item--story-points-input-container\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tclass=\"tasks-scrum__item--story-points-input\"\n\t\t\t\t\t\t\tvalue=\"${value}\"\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(\n\t\t\tthis.node.querySelector('.tasks-scrum__item--story-points-element'),\n\t\t\t'click',\n\t\t\tthis.onClick.bind(this)\n\t\t);\n\n\t\tconst input = this.node.querySelector('.tasks-scrum__item--story-points-input');\n\n\t\tEvent.bind(input, 'blur', this.onBlur.bind(this));\n\t\tEvent.bind(input, 'keydown', this.onKeyDown.bind(input));\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetValue(): StoryPointsStorage\n\t{\n\t\treturn this.storyPointsStorage;\n\t}\n\n\tisDisable(): boolean\n\t{\n\t\treturn this.disableStatus;\n\t}\n\n\tdisable()\n\t{\n\t\tthis.disableStatus = true;\n\t}\n\n\tunDisable()\n\t{\n\t\tthis.disableStatus = false;\n\t}\n\n\tonClick()\n\t{\n\t\tif (this.isDisable())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputContainer = this.node.querySelector('.tasks-scrum__item--story-points-input-container');\n\t\tconst input = inputContainer.firstElementChild;\n\t\tconst value = this.storyPointsStorage.getPoints();\n\n\t\tDom.addClass(inputContainer, '--active');\n\n\t\tinput.focus();\n\t\tinput.setSelectionRange(value.length, value.length);\n\t}\n\n\tonBlur()\n\t{\n\t\tconst inputContainer = this.node.querySelector('.tasks-scrum__item--story-points-input-container');\n\t\tconst input = inputContainer.firstElementChild;\n\n\t\tconst value = input.value.trim();\n\n\t\tconst currentValue = this.storyPointsStorage.getPoints();\n\n\t\tif (currentValue !== value)\n\t\t{\n\t\t\tthis.emit('setStoryPoints', value);\n\t\t}\n\n\t\tDom.removeClass(inputContainer, '--active');\n\t}\n\n\tonKeyDown(event)\n\t{\n\t\tif (event.isComposing || event.key === 'Escape' || event.key === 'Enter')\n\t\t{\n\t\t\tthis.blur();\n\t\t}\n\t}\n}\n","import {Dom, Event, Tag, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport {Item} from '../item';\n\nexport class SubTasks extends EventEmitter\n{\n\tconstructor(parentItem: Item)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SubTasks');\n\n\t\tthis.parentItem = parentItem;\n\n\t\tthis.list = new Map();\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.removeYourself();\n\n\t\tthis.node = Tag.render`<div class=\"tasks-scrum__item-sub-tasks\"></div>`;\n\n\t\tEvent.bind(this.node, 'transitionend', this.onTransitionEnd.bind(this, this.node));\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tremoveYourself()\n\t{\n\t\tif (Type.isNull(this.getNode()))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.remove(this.node);\n\n\t\tthis.node = null;\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.list.size === 0;\n\t}\n\n\tgetParentItem(): Item\n\t{\n\t\treturn this.parentItem;\n\t}\n\n\taddTask(item: Item)\n\t{\n\t\tthis.list.set(item.getId(), item);\n\t}\n\n\tgetList(): Map<number, Item>\n\t{\n\t\treturn this.list;\n\t}\n\n\tcleanTasks()\n\t{\n\t\tthis.list.forEach((item: Item) => {\n\t\t\tDom.remove(item.getNode());\n\t\t});\n\n\t\tthis.list.clear();\n\t}\n\n\tshow(): Promise\n\t{\n\t\treturn new Promise(\n\t\t\t(resolve) => {\n\t\t\t\tthis.resolve = resolve;\n\n\t\t\t\tif (Type.isNull(this.getNode()))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.list.size)\n\t\t\t\t{\n\t\t\t\t\tthis.hideLoader();\n\n\t\t\t\t\tthis.renderSubTasks();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showLoader();\n\t\t\t\t}\n\n\t\t\t\tDom.style(this.getNode(), 'height', `${ this.getNode().scrollHeight }px`);\n\t\t\t})\n\t\t;\n\t}\n\n\thide(): Promise\n\t{\n\t\treturn new Promise(\n\t\t\t(resolve) => {\n\t\t\t\tthis.resolve = resolve;\n\n\t\t\t\tif (Type.isNull(this.getNode()))\n\t\t\t\t{\n\t\t\t\t\tthis.resolve();\n\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tthis.hideLoader();\n\n\t\t\t\t/* eslint-disable */\n\t\t\t\tthis.getNode().style.height = `${ this.getNode().scrollHeight }px`;\n\t\t\t\tthis.getNode().clientHeight;\n\t\t\t\tthis.getNode().style.height = '0';\n\t\t\t\t/* eslint-enable */\n\t\t\t})\n\t\t;\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn !Type.isNull(this.node);\n\t}\n\n\trenderSubTasks()\n\t{\n\t\tthis.node.innerHTML = '';\n\n\t\tthis.list.forEach((item: Item) => {\n\t\t\tDom.append(item.render(), this.getNode());\n\t\t});\n\t}\n\n\tshowLoader()\n\t{\n\t\tif (this.loader)\n\t\t{\n\t\t\tthis.loader.show();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst listPosition = Dom.getPosition(this.getNode());\n\n\t\tthis.loader = new Loader({\n\t\t\ttarget: this.getNode(),\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: 'rgba(82, 92, 105, 0.9)',\n\t\t\toffset: {\n\t\t\t\ttop: `12px`,\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tthis.loader.show();\n\t}\n\n\thideLoader()\n\t{\n\t\tif (this.loader)\n\t\t{\n\t\t\tthis.loader.hide();\n\t\t}\n\t}\n\n\tonTransitionEnd(node: HTMLElement)\n\t{\n\t\tconst isHide = (Dom.style(node, 'height') === '0px');\n\n\t\tif (isHide)\n\t\t{\n\t\t\tthis.removeYourself();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(node, 'height', 'auto');\n\t\t}\n\n\t\tthis.resolve();\n\t}\n}\n","import {Type, Dom, Event, Tag, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Dialog} from 'ui.entity-selector';\n\nimport {Toggle} from './task/toggle';\nimport {Name} from './task/name';\nimport {Checklist} from './task/checklist';\nimport {Files} from './task/files';\nimport {Comments, TaskCounter} from './task/comments';\nimport {Epic, EpicType} from './task/epic';\nimport {Tags} from './task/tags';\nimport {Responsible, ResponsibleType} from './task/responsible';\nimport {StoryPoints} from './task/story.points';\nimport {SubTasks} from './task/sub.tasks';\n\nimport 'main.polyfill.intersectionobserver';\n\nimport '../css/item.css';\n\ntype AllowedActions = {\n\ttask_edit: boolean,\n\ttask_remove: boolean\n}\n\ntype ItemInfo = {\n\tcolor?: string,\n\tborderColor?: string\n}\ntype SubTaskInfo = {\n\tsourceId: number,\n\tcompleted: 'Y' | 'N',\n\tstoryPoints: string\n}\n\ntype SubTasksInfo = {\n\t[sourceId: number]: SubTaskInfo\n}\n\nexport type ItemParams = {\n\tid: number | string,\n\ttmpId: string,\n\tname: string,\n\tgroupId: number,\n\tcheckListComplete: number,\n\tcheckListAll: number,\n\tattachedFilesCount: number,\n\ttaskCounter: TaskCounter,\n\tepic?: EpicType,\n\ttags?: Array<string>,\n\tresponsible?: ResponsibleType,\n\tstoryPoints?: string,\n\tentityId?: number,\n\tentityType?: string,\n\tparentId?: number,\n\tsourceId?: number,\n\tcompleted?: 'Y' | 'N',\n\tsort?: number,\n\tallowedActions?: AllowedActions,\n\tinfo?: ItemInfo,\n\tisParentTask?: 'Y' | 'N',\n\tisLinkedTask?: 'Y' | 'N',\n\tparentTaskId?: number,\n\tisSubTask?: 'Y' | 'N',\n\tsubTasksInfo?: SubTasksInfo,\n\tisImportant?: 'Y' | 'N',\n\tpathToTask: string\n};\n\nexport class Item extends EventEmitter\n{\n\tconstructor(params: ItemParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Item');\n\n\t\tthis.groupMode = false;\n\t\tthis.decompositionMode = false;\n\n\t\tthis.node = null;\n\n\t\tthis.toggle = null;\n\t\tthis.name = null;\n\t\tthis.checklist = null;\n\t\tthis.files = null;\n\t\tthis.comments = null;\n\t\tthis.epic = null;\n\t\tthis.tags = null;\n\t\tthis.responsible = null;\n\t\tthis.storyPoints = null;\n\t\tthis.subTasks = null;\n\n\t\tthis.setItemParams(params);\n\n\t\tthis.shortView = 'Y';\n\t}\n\n\tsetItemParams(params: ItemParams)\n\t{\n\t\tthis.setId(params.id);\n\t\tthis.setGroupId(params.groupId);\n\t\tthis.setTmpId(params.tmpId);\n\t\tthis.setSort(params.sort);\n\t\tthis.setEntityId(params.entityId);\n\t\tthis.setEntityType(params.entityType);\n\t\tthis.setSourceId(params.sourceId);\n\t\tthis.setInfo(params.info);\n\n\t\tthis.setSubTasksInfo(params.subTasksInfo);\n\t\tthis.setParentTask(params.isParentTask);\n\t\tthis.setLinkedTask(params.isLinkedTask);\n\t\tthis.setParentTaskId(params.parentTaskId);\n\t\tthis.setSubTask(params.isSubTask);\n\t\tthis.setCompleted(params.completed);\n\t\tthis.setDisableStatus(false);\n\t\tthis.setAllowedActions(params.allowedActions);\n\t\tthis.setImportant(params.isImportant);\n\n\t\tthis.pathToTask = params.pathToTask;\n\t}\n\n\tstatic buildItem(params: ItemParams): Item\n\t{\n\t\tconst item = new Item(params);\n\n\t\titem.setToggle(item.isParentTask());\n\t\titem.setName(params.name);\n\t\titem.setChecklist(\n\t\t\tparams.checkListComplete,\n\t\t\tparams.checkListAll\n\t\t);\n\t\titem.setFiles(params.attachedFilesCount);\n\t\titem.setComments(params.taskCounter);\n\t\titem.setEpic(params.epic);\n\t\titem.setTags(params.tags);\n\t\titem.setResponsible(params.responsible);\n\n\t\tif (!item.isSubTask())\n\t\t{\n\t\t\titem.setStoryPoints(params.storyPoints);\n\t\t}\n\n\t\titem.setSubTasks();\n\n\t\treturn item;\n\t}\n\n\tsetToggle(visible: boolean)\n\t{\n\t\tconst toggle = new Toggle({ visible });\n\n\t\tif (this.toggle)\n\t\t{\n\t\t\tDom.replace(this.toggle.getNode(), toggle.render());\n\t\t}\n\n\t\tthis.toggle = toggle;\n\n\t\tthis.toggle.subscribe('show', this.onShowToggle.bind(this));\n\t\tthis.toggle.subscribe('hide', this.onHideToggle.bind(this));\n\t}\n\n\tgetToggle(): Toggle\n\t{\n\t\treturn this.toggle;\n\t}\n\n\tsetName(inputName: string)\n\t{\n\t\tconst name = new Name({\n\t\t\tname: inputName,\n\t\t\tisCompleted: this.isCompleted(),\n\t\t\tisImportant: this.isImportant(),\n\t\t\tpathToTask: this.pathToTask,\n\t\t\tsourceId: this.getSourceId()\n\t\t});\n\n\t\tif (this.name)\n\t\t{\n\t\t\tDom.replace(this.name.getNode(), name.render());\n\t\t}\n\n\t\tthis.name = name;\n\n\t\tthis.name.subscribe('click', () => this.emit('showTask'));\n\t\tthis.name.subscribe('urlClick', () => this.emit('destroyActionPanel'));\n\t}\n\n\tgetName(): Name\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetChecklist(complete: number, all: number)\n\t{\n\t\tconst checklist = new Checklist({ complete, all });\n\n\t\tif (this.checklist)\n\t\t{\n\t\t\tDom.replace(this.checklist.getNode(), checklist.render());\n\t\t}\n\n\t\tthis.checklist = checklist;\n\n\t\tthis.checklist.subscribe('click', () => this.emit('showTask'));\n\t}\n\n\tgetChecklist(): Checklist\n\t{\n\t\treturn this.checklist;\n\t}\n\n\tsetFiles(count: number)\n\t{\n\t\tconst files = new Files(count);\n\n\t\tif (this.files)\n\t\t{\n\t\t\tDom.replace(this.files.getNode(), files.render());\n\t\t}\n\n\t\tthis.files = files;\n\n\t\tthis.files.subscribe('click', () => this.emit('showTask'));\n\t}\n\n\tgetFiles(): Checklist\n\t{\n\t\treturn this.files;\n\t}\n\n\tsetComments(taskCounter: TaskCounter)\n\t{\n\t\tconst comments = new Comments(taskCounter);\n\n\t\tif (this.comments)\n\t\t{\n\t\t\tDom.replace(this.comments.getNode(), comments.render());\n\t\t}\n\n\t\tthis.comments = comments;\n\n\t\tthis.comments.subscribe('click', () => this.emit('showTask'));\n\t}\n\n\tgetComments(): Comments\n\t{\n\t\treturn this.comments;\n\t}\n\n\tsetEpic(inputEpic?: EpicType)\n\t{\n\t\tconst epic = new Epic(inputEpic);\n\n\t\tif (this.epic)\n\t\t{\n\t\t\tDom.replace(this.epic.getNode(), this.isShortView() ? epic.render() : epic.renderFullView());\n\t\t}\n\n\t\tthis.epic = epic;\n\n\t\tthis.updateTagsVisibility();\n\n\t\tthis.epic.subscribe('click', () => this.emit('filterByEpic', this.epic.getId()));\n\t}\n\n\tgetEpic(): Epic\n\t{\n\t\treturn this.epic;\n\t}\n\n\tsetTags(inputTags?: Array<string>)\n\t{\n\t\tconst tags = new Tags(inputTags);\n\n\t\tif (this.tags)\n\t\t{\n\t\t\tif (this.getNode()) //todo\n\t\t\t{\n\t\t\t\tthis.replaceTags(tags);\n\t\t\t}\n\t\t}\n\n\t\tthis.tags = tags;\n\n\t\tthis.updateTagsVisibility();\n\n\t\tthis.tags.subscribe('click', (baseEvent: BaseEvent) => this.emit('filterByTag', baseEvent.getData()));\n\t}\n\n\tgetTags(): Tags\n\t{\n\t\treturn this.tags;\n\t}\n\n\tsetShortView(value: string)\n\t{\n\t\tthis.shortView = (value === 'Y' ? 'Y' : 'N');\n\n\t\tif (this.getNode())\n\t\t{\n\t\t\tDom.replace(this.getNode(), this.render());\n\t\t}\n\t}\n\n\tgetShortView(): 'Y' | 'N'\n\t{\n\t\treturn this.shortView;\n\t}\n\n\tisShortView(): boolean\n\t{\n\t\treturn this.shortView === 'Y';\n\t}\n\n\tsetResponsible(inputResponsible: ResponsibleType)\n\t{\n\t\tconst responsible = new Responsible(inputResponsible);\n\n\t\tif (this.responsible)\n\t\t{\n\t\t\tDom.replace(this.responsible.getNode(), responsible.render());\n\t\t}\n\n\t\tthis.responsible = responsible;\n\n\t\tthis.responsible.subscribe('click', this.onResponsibleClick.bind(this));\n\t}\n\n\tgetResponsible(): Responsible\n\t{\n\t\treturn this.responsible;\n\t}\n\n\tsetStoryPoints(inputStoryPoints: string)\n\t{\n\t\tconst storyPoints = new StoryPoints(inputStoryPoints);\n\n\t\tif (this.storyPoints)\n\t\t{\n\t\t\tDom.replace(this.storyPoints.getNode(), storyPoints.render());\n\t\t}\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\tstoryPoints.disable();\n\t\t}\n\n\t\tthis.storyPoints = storyPoints;\n\n\t\tthis.storyPoints.subscribe('setStoryPoints', this.onSetStoryPoints.bind(this));\n\t}\n\n\tgetStoryPoints(): StoryPoints\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tsetSubTasks()\n\t{\n\t\tthis.subTasks = new SubTasks(this);\n\n\t\tthis.subTasks.subscribe('click', () => this.emit('showTask'));\n\t}\n\n\tgetSubTasks(): ?SubTasks\n\t{\n\t\treturn this.subTasks;\n\t}\n\n\tsetId(id: number | string)\n\t{\n\t\tthis.id = (\n\t\t\tType.isInteger(id) ? parseInt(id, 10) :\n\t\t\t\t(Type.isString(id) && id) ? id : Text.getRandom()\n\t\t);\n\n\t\tif (this.getNode())\n\t\t{\n\t\t\tthis.getNode().dataset.id = this.id;\n\t\t}\n\t}\n\n\tgetId(): number | string\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetGroupId(id: number)\n\t{\n\t\tthis.groupId = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\t}\n\n\tgetGroupId(): number\n\t{\n\t\treturn this.groupId;\n\t}\n\n\tsetTmpId(tmpId: string)\n\t{\n\t\tthis.tmpId = (Type.isString(tmpId) ? tmpId : '');\n\t}\n\n\tgetTmpId(): string\n\t{\n\t\treturn this.tmpId;\n\t}\n\n\tsetSort(sort: number)\n\t{\n\t\tthis.setPreviousSort(this.sort);\n\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\n\t\tif (this.getNode())\n\t\t{\n\t\t\tDom.attr(this.getNode(), 'data-sort', this.sort);\n\t\t}\n\t}\n\n\tgetSort(): number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetPreviousSort(sort: number)\n\t{\n\t\tthis.previousSort = (Type.isInteger(sort) ? parseInt(sort, 10) : 0);\n\t}\n\n\tgetPreviousSort(): number\n\t{\n\t\treturn this.previousSort;\n\t}\n\n\tsetEntityId(entityId: number)\n\t{\n\t\tthis.entityId = (Type.isInteger(entityId) ? parseInt(entityId, 10) : 0);\n\t}\n\n\tgetEntityId(): number\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tsetEntityType(entityType: string)\n\t{\n\t\tthis.entityType = (new Set(['backlog', 'sprint']).has(entityType) ? entityType : 'backlog');\n\n\t\tthis.updateBorderColor();\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.entityType;\n\t}\n\n\tsetSourceId(sourceId: number)\n\t{\n\t\tthis.sourceId = (Type.isInteger(sourceId) ? parseInt(sourceId, 10) : 0);\n\t}\n\n\tgetSourceId(): number\n\t{\n\t\treturn this.sourceId;\n\t}\n\n\tsetCompleted(value: string)\n\t{\n\t\tconst completed = (value === 'Y');\n\n\t\tif (this.name)\n\t\t{\n\t\t\tthis.name.setCompleted(completed);\n\n\t\t\tif (completed)\n\t\t\t{\n\t\t\t\tthis.name.strikeOut();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.name.unStrikeOut();\n\t\t\t}\n\t\t}\n\n\t\tthis.completed = completed;\n\t}\n\n\tsetAllowedActions(allowedActions: AllowedActions)\n\t{\n\t\tthis.allowedActions = (Type.isPlainObject(allowedActions) ? allowedActions : {});\n\t}\n\n\tsetImportant(isImportant: 'Y' | 'N')\n\t{\n\t\tthis.important = (isImportant === 'Y');\n\t}\n\n\tisImportant(): boolean\n\t{\n\t\treturn this.important;\n\t}\n\n\tsetSubTasksInfo(subTasksInfo: ?SubTasksInfo)\n\t{\n\t\tthis.subTasksInfo = subTasksInfo;\n\t}\n\n\tgetSubTasksInfo(): ?SubTasksInfo\n\t{\n\t\treturn this.subTasksInfo;\n\t}\n\n\tgetSubTasksCount(): number\n\t{\n\t\tif (!this.getSubTasksInfo())\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn Object.keys(this.getSubTasksInfo()).length;\n\t}\n\n\tsetParentTask(value: string)\n\t{\n\t\tthis.parentTask = (value === 'Y');\n\n\t\tif (this.getNode())\n\t\t{\n\t\t\tthis.setToggle(this.isParentTask());\n\n\t\t\tif (this.isParentTask())\n\t\t\t{\n\t\t\t\tDom.addClass(this.getNode(), '--parent-tasks');\n\n\t\t\t\tif (this.getSubTasksCount() > 1)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.getNode(), '--many');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.getNode(), '--many');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getNode(), '--parent-tasks');\n\t\t\t}\n\t\t}\n\t}\n\n\tisParentTask(): boolean\n\t{\n\t\treturn this.parentTask;\n\t}\n\n\tsetLinkedTask(value: string)\n\t{\n\t\tthis.linkedTask = (value === 'Y');\n\n\t\tif (this.getNode())\n\t\t{\n\t\t\tif (this.isLinkedTask() && !this.isSubTask())\n\t\t\t{\n\t\t\t\tDom.addClass(this.getNode(), '--linked');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getNode(), '--linked');\n\t\t\t}\n\t\t}\n\t}\n\n\tisLinkedTask(): boolean\n\t{\n\t\treturn this.linkedTask;\n\t}\n\n\tsetParentTaskId(id: number)\n\t{\n\t\tthis.parentTaskId = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\t}\n\n\tgetParentTaskId(): number\n\t{\n\t\treturn this.parentTaskId;\n\t}\n\n\tsetSubTask(value: string)\n\t{\n\t\tthis.subTask = (value === 'Y');\n\n\t\tif (this.getNode())\n\t\t{\n\t\t\tif (this.isSubTask())\n\t\t\t{\n\t\t\t\tDom.addClass(this.getNode(), '--subtasks');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getNode(), '--subtasks');\n\t\t\t}\n\t\t}\n\t}\n\n\tisSubTask(): boolean\n\t{\n\t\treturn this.subTask;\n\t}\n\n\tsetInfo(info: ?ItemInfo)\n\t{\n\t\tif (Type.isUndefined(info))\n\t\t{\n\t\t\tthis.info = {\n\t\t\t\tcolor: '',\n\t\t\t\tborderColor: ''\n\t\t\t};\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.info = info;\n\t}\n\n\tgetInfo(): ?ItemInfo\n\t{\n\t\treturn this.info;\n\t}\n\n\tsetBorderColor(color: string)\n\t{\n\t\tthis.info.borderColor = (Type.isString(color) ? color : '');\n\n\t\tthis.updateBorderColor();\n\t}\n\n\tgetBorderColor(): string\n\t{\n\t\treturn (Type.isString(this.info.borderColor) ? this.info.borderColor : '');\n\t}\n\n\tupdateBorderColor()\n\t{\n\t\tif (this.isLinkedTask() && !this.isSubTask() && this.getNode() && this.getBorderColor() !== '')\n\t\t{\n\t\t\tconst colorNode = this.getNode().querySelector('.tasks-scrum__item--link');\n\n\t\t\tDom.style(colorNode, 'backgroundColor', this.getBorderColor());\n\n\t\t\tswitch (this.getEntityType())\n\t\t\t{\n\t\t\t\tcase 'backlog':\n\t\t\t\t\tDom.style(this.getNode().querySelector('.tasks-scrum__item--bg'), 'backgroundColor', this.getBorderColor());\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'sprint':\n\t\t\t\t\tDom.style(this.getNode(), 'borderLeft', null);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn this.completed;\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn this.disableStatus;\n\t}\n\n\tsetMoveActivity(value: boolean)\n\t{\n\t\tthis.moveActivity = Boolean(value);\n\t}\n\n\tisMovable(): boolean\n\t{\n\t\treturn this.moveActivity;\n\t}\n\n\tsetDisableStatus(status: boolean)\n\t{\n\t\tthis.disableStatus = Boolean(status);\n\n\t\tif (this.storyPoints)\n\t\t{\n\t\t\tif (this.isDisabled())\n\t\t\t{\n\t\t\t\tthis.storyPoints.disable();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.storyPoints.unDisable();\n\t\t\t}\n\t\t}\n\t}\n\n\tactivateGroupMode()\n\t{\n\t\tDom.addClass(this.getNode(), '--checked');\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tDom.removeClass(this.getNode(), '--checked');\n\t}\n\n\tactivateLinkedMode()\n\t{\n\t\tDom.addClass(this.getNode(), '--linked-mode');\n\t}\n\n\tdeactivateLinkedMode()\n\t{\n\t\tDom.removeClass(this.getNode(), '--linked-mode');\n\t\tDom.removeClass(this.getNode(), '--linked-mode-current');\n\t}\n\n\tactivateCurrentLinkedMode()\n\t{\n\t\tDom.addClass(this.getNode(), '--linked-mode-current');\n\t}\n\n\tdeactivateCurrentLinkedMode()\n\t{\n\t\tDom.removeClass(this.getNode(), '--linked-mode-current');\n\t}\n\n\taddItemToGroupMode()\n\t{\n\t\tthis.groupMode = true;\n\n\t\tDom.addClass(this.getNode(), ['--group-mode']);\n\n\t\tthis.getNode().querySelector('.tasks-scrum__item--group-mode-input').checked = true;\n\t}\n\n\tremoveItemFromGroupMode()\n\t{\n\t\tthis.groupMode = false;\n\n\t\tDom.removeClass(this.getNode(), ['--group-mode']);\n\n\t\tthis.getNode().querySelector('.tasks-scrum__item--group-mode-input').checked = false;\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tshowSubTasks()\n\t{\n\t\tDom.addClass(this.getNode(), '--open');\n\n\t\tthis.getSubTasks()\n\t\t\t.show()\n\t\t\t.then(() => {\n\t\t\t\tthis.toggle.show();\n\t\t\t})\n\t\t;\n\t}\n\n\thideSubTasks()\n\t{\n\t\tDom.removeClass(this.getNode(), '--open');\n\n\t\tthis.getSubTasks()\n\t\t\t.hide()\n\t\t\t.then(() => {\n\t\t\t\tthis.toggle.hide();\n\t\t\t})\n\t\t;\n\t}\n\n\tcleanSubTasks()\n\t{\n\t\tthis.getSubTasks().cleanTasks();\n\t}\n\n\tisShownSubTasks(): boolean\n\t{\n\t\treturn this.getSubTasks().isShown();\n\t}\n\n\tactivateDecompositionMode()\n\t{\n\t\tthis.decompositionMode = true;\n\t}\n\n\tdeactivateDecompositionMode()\n\t{\n\t\tthis.decompositionMode = false;\n\t}\n\n\tisDecompositionMode(): boolean\n\t{\n\t\treturn this.decompositionMode;\n\t}\n\n\tsetParentEntity(entityId: number, entityType: string)\n\t{\n\t\tthis.setEntityId(entityId);\n\t\tthis.setEntityType(entityType);\n\t}\n\n\tisEditAllowed(): boolean\n\t{\n\t\treturn Boolean(this.allowedActions['task_edit']);\n\t}\n\n\tisRemoveAllowed(): boolean\n\t{\n\t\treturn Boolean(this.allowedActions['task_remove']);\n\t}\n\n\tupdateYourself(tmpItem: Item)\n\t{\n\t\tthis.setToggle(tmpItem.isParentTask());\n\n\t\tif (this.getName().getValue() !== tmpItem.getName().getValue())\n\t\t{\n\t\t\tthis.setName(tmpItem.getName().getValue());\n\t\t}\n\t\tif (this.getChecklist().getValue() !== tmpItem.getChecklist().getValue())\n\t\t{\n\t\t\tthis.setChecklist(\n\t\t\t\ttmpItem.getChecklist().getComplete(),\n\t\t\t\ttmpItem.getChecklist().getAll()\n\t\t\t);\n\t\t}\n\t\tif (this.getFiles().getValue() !== tmpItem.getFiles().getValue())\n\t\t{\n\t\t\tthis.setFiles(tmpItem.getFiles().getValue());\n\t\t}\n\t\tif (this.getComments().getValue() !== tmpItem.getComments().getValue())\n\t\t{\n\t\t\tthis.setComments(tmpItem.getComments().getValue());\n\t\t}\n\t\tif (this.getEpic().getValue() !== tmpItem.getEpic().getValue())\n\t\t{\n\t\t\tthis.setEpic(tmpItem.getEpic().getValue());\n\t\t}\n\t\tif (!this.getTags().isEqualTags(tmpItem.getTags()))\n\t\t{\n\t\t\tthis.setTags(tmpItem.getTags().getValue());\n\t\t}\n\t\tif (this.getResponsible().getValue() !== tmpItem.getResponsible().getValue())\n\t\t{\n\t\t\tthis.setResponsible(tmpItem.getResponsible().getValue());\n\t\t}\n\t\tif (\n\t\t\t!this.isSubTask()\n\t\t\t&& this.getStoryPoints().getValue().getPoints() !== tmpItem.getStoryPoints().getValue().getPoints()\n\t\t)\n\t\t{\n\t\t\tthis.setStoryPoints(tmpItem.getStoryPoints().getValue().getPoints());\n\t\t}\n\t\tthis.setEntityId(tmpItem.getEntityId());\n\t\tif (this.isCompleted() !== tmpItem.isCompleted())\n\t\t{\n\t\t\tthis.setCompleted(tmpItem.isCompleted() ? 'Y' : 'N');\n\t\t}\n\t\tif (this.isImportant() !== tmpItem.isImportant())\n\t\t{\n\t\t\tthis.setImportant(tmpItem.isImportant() ? 'Y' : 'N');\n\t\t\tthis.setName(tmpItem.getName().getValue());\n\t\t}\n\n\t\tthis.setParentTask(tmpItem.isParentTask() ? 'Y' : 'N');\n\t\tthis.setLinkedTask(tmpItem.isLinkedTask() ? 'Y' : 'N');\n\t\tthis.setParentTaskId(tmpItem.getParentTaskId());\n\t\tthis.setSubTask(tmpItem.isSubTask() ? 'Y' : 'N');\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.isShortView())\n\t\t{\n\t\t\treturn this.renderShortView();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.renderFullView();\n\t\t}\n\t}\n\n\trenderShortView(): HTMLElement\n\t{\n\t\tconst typeClass = (this.isParentTask() ? ' --parent-tasks ' : ' ') + (this.isSubTask() ? ' --subtasks ' : '');\n\t\tconst subClass = this.getSubTasksCount() > 1 ? ' --many ' : '';\n\t\tconst linkedClass = this.isLinkedTask() && !this.isSubTask() ? ' --linked ' : '';\n\t\tconst entityClass = '--item-' + this.getEntityType();\n\n\t\tthis.node = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-scrum__item${typeClass}${subClass}${linkedClass}tasks-scrum__item--drag --short-view ${entityClass}\"\n\t\t\t\tdata-id=\"${Text.encode(this.getId())}\"\n\t\t\t\tdata-sort=\"${Text.encode(this.getSort())}\"\n\t\t\t>\n\t\t\t<div class=\"tasks-scrum__item--bg\"></div>\n\t\t\t\t<div class=\"tasks-scrum__item--link\"></div>\n\t\t\t\t<div class=\"tasks-scrum__item--info\">\n\t\t\t\t\t${this.toggle ? this.toggle.render() : ''}\n\t\t\t\t\t<div class=\"tasks-scrum__item--main-info\">\n\t\t\t\t\t\t${this.name ? this.name.render() : ''}\n\t\t\t\t\t\t<div class=\"tasks-scrum__item--tags\">\n\t\t\t\t\t\t\t${this.epic ? this.epic.render() : ''}\n\t\t\t\t\t\t\t${this.tags ? this.tags.render() : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__item--entity-content\">\n\t\t\t\t\t\t${this.comments ? this.comments.render() : ''}\n\t\t\t\t\t\t<div class=\"tasks-scrum__item--counter-container\">\n\t\t\t\t\t\t\t${this.files ? this.files.render() : ''}\n\t\t\t\t\t\t\t${this.checklist ? this.checklist.render() : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.responsible ? this.responsible.render() : ''}\n\t\t\t\t${!this.isSubTask() && this.storyPoints ? this.storyPoints.render() : ''}\n\t\t\t\t<div class=\"tasks-scrum__item--group-mode\">\n\t\t\t\t\t<input type=\"checkbox\" class=\"tasks-scrum__item--group-mode-input\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__item--substrate\"></div>\n\t\t\t\t<div class=\"tasks-scrum__item--dragstrate\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.onItemClick.bind(this));\n\n\t\tthis.updateBorderColor();\n\n\t\treturn this.node;\n\t}\n\n\trenderFullView(): HTMLElement\n\t{\n\t\tconst typeClass = (this.isParentTask() ? ' --parent-tasks ' : ' ') + (this.isSubTask() ? ' --subtasks ' : '');\n\t\tconst subClass = this.getSubTasksCount() > 1 ? ' --many ' : '';\n\t\tconst linkedClass = this.isLinkedTask() && !this.isSubTask() ? ' --linked ' : '';\n\t\tconst entityClass = '--item-' + this.getEntityType();\n\n\t\tthis.node = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-scrum__item${typeClass}${subClass}${linkedClass}tasks-scrum__item--drag --full-view ${entityClass}\"\n\t\t\t\tdata-id=\"${Text.encode(this.getId())}\"\n\t\t\t\tdata-sort=\"${Text.encode(this.getSort())}\"\n\t\t\t>\n\t\t\t<div class=\"tasks-scrum__item--bg\"></div>\n\t\t\t<div class=\"tasks-scrum__item--info-task--basic\">\n\t\t\t\t<div class=\"tasks-scrum__item--link\"></div>\n\t\t\t\t<div class=\"tasks-scrum__item--info\">\n\t\t\t\t\t${this.toggle ? this.toggle.render() : ''}\n\t\t\t\t\t<div class=\"tasks-scrum__item--main-info\">\n\t\t\t\t\t\t${this.name ? this.name.render() : ''}\n\t\t\t\t\t\t<div class=\"tasks-scrum__item--tags\">\n\t\t\t\t\t\t\t${this.epic ? this.epic.renderFullView() : ''}\n\t\t\t\t\t\t\t${this.tags ? this.tags.render() : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.comments ? this.comments.render() : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum__item--info-task--details\">\n\t\t\t\t${this.responsible ? this.responsible.render() : ''}\n\n\t\t\t\t\t<div class=\"tasks-scrum__item--counter-container\">\n\t\t\t\t\t\t${this.files ? this.files.render() : ''}\n\t\t\t\t\t\t${this.checklist ? this.checklist.render() : ''}\n\t\t\t\t\t</div>\n\n\t\t\t\t${!this.isSubTask() && this.storyPoints ? this.storyPoints.render() : ''}\n\t\t\t</div>\n\n\t\t\t\t<div class=\"tasks-scrum__item--group-mode\">\n\t\t\t\t\t<input type=\"checkbox\" class=\"tasks-scrum__item--group-mode-input\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__item--substrate\"></div>\n\t\t\t\t<div class=\"tasks-scrum__item--dragstrate\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.updateTagsVisibility();\n\n\t\tEvent.bind(this.node, 'click', this.onItemClick.bind(this));\n\n\t\tthis.updateBorderColor();\n\n\t\treturn this.node;\n\t}\n\n\tupdateTagsVisibility()\n\t{\n\t\tif (!this.getNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.epic.getValue().id > 0 || this.tags.getValue().length > 0)\n\t\t{\n\t\t\tDom.addClass(this.getNode().querySelector('.tasks-scrum__item--tags'), '--visible');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.getNode().querySelector('.tasks-scrum__item--tags'), '--visible');\n\t\t}\n\t}\n\n\treplaceTags(tags: Tags)\n\t{\n\t\tconst tagsContainer = this.getNode().querySelector('.tasks-scrum__item--tags');\n\t\tconst tagsNode = tagsContainer.querySelectorAll('.tasks-scrum__item--hashtag');\n\n\t\ttagsNode.forEach((tagNode: HTMLElement) => Dom.remove(tagNode));\n\n\t\tconst tagList = tags.render();\n\n\t\tif (Type.isArray(tagList))\n\t\t{\n\t\t\ttagList.forEach((tagNode: HTMLElement) => Dom.append(tagNode, tagsContainer));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(tagList, tagsContainer);\n\t\t}\n\t}\n\n\tonItemClick(event)\n\t{\n\t\tconst target = event.target;\n\n\t\tif (Dom.hasClass(target, 'tasks-scrum__item--link'))\n\t\t{\n\t\t\tthis.emit('showLinked');\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.toggle && this.hasNode(this.toggle.getNode(), target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.name && this.hasNode(this.name.getNode(), target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.checklist && this.hasNode(this.checklist.getNode(), target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.files && this.hasNode(this.files.getNode(), target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.comments && this.hasNode(this.comments.getNode(), target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.epic && this.hasNode(this.epic.getNode(), target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.tags && this.hasNode(this.tags.getNode(), target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.responsible && this.hasNode(this.responsible.getNode(), target, true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.isSubTask())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.storyPoints && this.hasNode(this.storyPoints.getNode(), target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('toggleActionPanel');\n\t}\n\n\tonResponsibleClick()\n\t{\n\t\tif (this.isGroupMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.responsibleDialog && this.responsibleDialog.isOpen())\n\t\t{\n\t\t\tthis.responsibleDialog.hide();\n\t\t\tthis.responsibleDialog = null;\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst responsible = this.getResponsible().getValue();\n\t\tconst preselectedItems = responsible ? [['user' , responsible.id]] : [];\n\n\t\tthis.responsibleDialog = new Dialog({\n\t\t\ttargetNode: this.responsible.getNode(),\n\t\t\tenableSearch: true,\n\t\t\tcontext: 'TASKS',\n\t\t\tdropdownMode: true,\n\t\t\tpreselectedItems: preselectedItems,\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tthis.responsibleDialog.hide();\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tthis.setResponsible({\n\t\t\t\t\t\tid: selectedItem.getId(),\n\t\t\t\t\t\tname: selectedItem.getTitle(),\n\t\t\t\t\t\tphoto: {\n\t\t\t\t\t\t\tsrc: selectedItem.getAvatar()\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.emit('changeTaskResponsible');\n\t\t\t\t},\n\t\t\t},\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'scrum-user',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tgroupId: this.getGroupId()\n\t\t\t\t\t},\n\t\t\t\t\tdynamicLoad: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'department'\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\n\t\tthis.emit('onShowResponsibleDialog', this.responsibleDialog);\n\n\t\tthis.responsibleDialog.show();\n\t}\n\n\tonSetStoryPoints(baseEvent: BaseEvent)\n\t{\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('updateItem', {\n\t\t\titemId: this.getId(),\n\t\t\tentityId: this.getEntityId(),\n\t\t\tstoryPoints: baseEvent.getData()\n\t\t});\n\n\t\tthis.setStoryPoints(baseEvent.getData());\n\t}\n\n\tonShowToggle()\n\t{\n\t\tthis.emit('showSubTasks', this.getSubTasks());\n\t}\n\n\tonHideToggle()\n\t{\n\t\tthis.hideSubTasks();\n\t}\n\n\thasNode(parentNode: HTMLElement | Array<HTMLElement>, searchNode: HTMLElement, skipParent = false): boolean\n\t{\n\t\tif (Type.isArray(parentNode))\n\t\t{\n\t\t\tconst result = parentNode\n\t\t\t\t.map((node: HTMLElement) => this.hasNode(node, searchNode, skipParent))\n\t\t\t\t.find((result) => result === true)\n\t\t\t;\n\n\t\t\treturn !Type.isUndefined(result);\n\t\t}\n\n\t\tif (!skipParent && searchNode.isEqualNode(parentNode))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst nodes = parentNode.getElementsByTagName('*');\n\n\t\tfor (let k = 0; k < nodes.length; k++)\n\t\t{\n\t\t\tif (searchNode.isEqualNode(nodes[k]))\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tactivateBlinking()\n\t{\n\t\tif (!this.getNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isUndefined(IntersectionObserver))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst observer = new IntersectionObserver((entries) =>\n\t\t\t{\n\t\t\t\tif (entries[0].isIntersecting === true)\n\t\t\t\t{\n\t\t\t\t\tthis.blink();\n\n\t\t\t\t\tobserver.disconnect();\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tthreshold: [0]\n\t\t\t}\n\t\t);\n\n\t\tobserver.observe(this.getNode());\n\t}\n\n\tblink()\n\t{\n\t\tif (!this.getNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getNode(), '--blink');\n\t\tsetTimeout(() => {\n\t\t\tDom.removeClass(this.getNode(), '--blink');\n\t\t}, 300);\n\t}\n}\n","import {Dom, Tag} from 'main.core';\n\nimport {Entity} from './entity';\nimport {Item} from '../item/item';\n\nexport class ListItems\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tthis.entity = entity;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__content-items\" data-entity-id=\"${this.entity.getId()}\">\n\t\t\t\t${[...this.entity.getItems().values()].map((item: Item) => {\n\t\t\t\t\titem.setEntityType(this.entity.getEntityType());\n\t\t\t\t\treturn item.render();\n\t\t\t\t})}\n\t\t\t\t${this.renderLoader()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\trenderLoader(): ?HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"tasks-scrum-entity-items-loader\"></div>`;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetListNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tsetEntityId(entityId: number)\n\t{\n\t\tthis.node.dataset.entityId = parseInt(entityId, 10);\n\t}\n\n\taddScrollbar()\n\t{\n\t\tDom.addClass(this.getNode(), '--scrollbar');\n\t}\n\n\tremoveScrollbar()\n\t{\n\t\tDom.removeClass(this.getNode(), '--scrollbar');\n\t}\n}\n","import { Loc, Type, Text, Dom } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { Dialog } from 'ui.entity-selector';\n\nimport { Filter } from '../service/filter';\n\nimport { RequestSender } from './request.sender';\nimport { Input } from './input';\n\nimport type { EpicType } from '../item/task/epic';\n\nimport { UI } from 'ui.notification';\nimport {MessageBox, MessageBoxButtons} from 'ui.dialogs.messagebox';\n\n\n\ntype Params = {\n\trequestSender: RequestSender,\n\tfilter: Filter,\n\tgroupId: number,\n\ttagsAreConverting: number,\n}\n\nexport class TagSearcher extends EventEmitter\n{\n\tstatic tagRegExp = '#([^\\\\s,\\\\[\\\\]<>]+)';\n\tstatic epicRegExp = '@[^#@](?:[^#@]*[^\\s#@])?';\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.TagSearcher');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.filterService = params.filter;\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.tagsAreConverting = params.tagsAreConverting;\n\t\tthis.allTags = new Map();\n\n\t\tthis.messageViewed = false;\n\t}\n\n\taddEpicToSearcher(epic: EpicType)\n\t{\n\t\tconst epicName = epic.name.trim();\n\n\t\tthis.allTags.set('epic_' + epic.id, {\n\t\t\tid: epic.id,\n\t\t\tentityId: 'epic',\n\t\t\ttabs: 'recents',\n\t\t\ttitle: epicName,\n\t\t\tavatar: '/bitrix/components/bitrix/tasks.scrum/templates/.default/images/search-hashtag-green.svg',\n\t\t\tname: epicName,\n\t\t\tdescription: epic.description,\n\t\t\tcolor: epic.color,\n\t\t\tgroupId: epic.groupId,\n\t\t\tcreatedBy: epic.createdBy,\n\t\t\tmodifiedBy: epic.modifiedBy,\n\t\t});\n\t}\n\n\tremoveEpicFromSearcher(epic: EpicType)\n\t{\n\t\tthis.allTags.delete('epic_' + epic.id);\n\t}\n\n\tgetAllList(): Array\n\t{\n\t\treturn [...this.allTags.values()];\n\t}\n\n\tgetTagsList(): Array\n\t{\n\t\tconst tagsList = [];\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'tag')\n\t\t\t{\n\t\t\t\ttagsList.push(tag);\n\t\t\t}\n\t\t});\n\t\treturn tagsList;\n\t}\n\n\tgetEpicList(): Array\n\t{\n\t\tconst epicList = [];\n\n\t\t[...this.allTags.values()].forEach((epic) => {\n\t\t\tif (epic.entityId === 'epic')\n\t\t\t{\n\t\t\t\tepicList.push(epic);\n\t\t\t}\n\t\t});\n\n\t\treturn epicList;\n\t}\n\n\tgetEpicByName(epicName: string): ?EpicType\n\t{\n\t\tlet epic = null;\n\n\t\t[...this.allTags.values()].forEach((tag) => {\n\t\t\tif (tag.entityId === 'epic' && tag.name === epicName)\n\t\t\t{\n\t\t\t\tepic = tag;\n\t\t\t}\n\t\t});\n\n\t\treturn epic;\n\t}\n\n\tgetEpicById(epicId: number): ?EpicType\n\t{\n\t\treturn [...this.allTags.values()]\n\t\t\t.find((epic) => (epic.entityId === 'epic' && epic.id === epicId))\n\t\t\t;\n\t}\n\t// widget on scrum (ex task)\n\tshowTagsDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tif (this.tagsAreConverting)\n\t\t{\n\t\t\tthis.showConvertingMessage();\n\t\t\treturn;\n\t\t}\n\t\tlet choiceWasMade = false;\n\t\tlet groupId = this.groupId;\n\t\tlet statusSuccess = { status: false };\n\t\tthis.tagDialog = new Dialog({\n\t\t\tid: item.getId().toString(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: true,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\tcompactView: true,\n\t\t\tsearchOptions: {\n\t\t\t\tallowCreateItem: false,\n\t\t\t},\n\t\t\tfooter: BX.Tasks.EntitySelector.Footer,\n\t\t\tfooterOptions: {\n\t\t\t\tuserId: this.userId,\n\t\t\t\tgroupId: groupId,\n\t\t\t},\n\t\t\toffsetTop: 12,\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'task-tag',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\ttaskId: item.getSourceId(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tclearUnavailableItems: true,\n\t\t\tevents: {\n\t\t\t\t'onLoad': (baseEvent: BaseEvent) => {\n\t\t\t\t\tbaseEvent.getTarget().getFooterContainer().style.zIndex = 1;\n\t\t\t\t\tthis.onShowTaskEditCallback(baseEvent, statusSuccess, item);\n\t\t\t\t\tthis.hideDialogLabel(baseEvent.getTarget());\n\t\t\t\t},\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst tag = selectedItem.getTitle();\n\t\t\t\t\tthis.emit('attachTagToTask', tag);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst deselectedItem = event.getData().item;\n\t\t\t\t\tconst tag = deselectedItem.getTitle();\n\t\t\t\t\tthis.emit('deAttachTagToTask', tag);\n\t\t\t\t},\n\t\t\t\t'onSearch': event => {\n\t\t\t\t\tthis.onSearchCallback(event);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonInput: (event) => {\n\t\t\t\t\t\tconst selector = event.getData().selector;\n\t\t\t\t\t\tif (selector)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst dialog = selector.getDialog();\n\t\t\t\t\t\t\tconst label = dialog.getContainer().querySelector('.ui-selector-footer-conjunction');\n\t\t\t\t\t\t\tlabel.textContent = Text.encode(selector.getTextBoxValue());\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tthis.tagDialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tthis.emit('hideTagDialog');\n\t\t\t}\n\t\t\tthis.tagDialog = null;\n\t\t});\n\n\t\tthis.tagDialog.show();\n\t}\n\n\tshowEpicDialog(item: Item, targetNode: HTMLElement): Dialog\n\t{\n\t\tconst currentEpic = item.getEpic().getValue();\n\n\t\tconst selectedItems = [];\n\t\tif (currentEpic)\n\t\t{\n\t\t\tconst currentEpicInfo = this.allTags.get('epic_' + currentEpic.id);\n\t\t\tif (currentEpicInfo)\n\t\t\t{\n\t\t\t\tselectedItems.push(currentEpicInfo);\n\t\t\t}\n\t\t}\n\n\t\tlet choiceWasMade = false;\n\n\t\tthis.epicDialog = new Dialog({\n\t\t\tid: item.getId(),\n\t\t\ttargetNode: targetNode,\n\t\t\twidth: 400,\n\t\t\theight: 300,\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tenableSearch: true,\n\t\t\toffsetTop: 12,\n\t\t\tselectedItems: selectedItems,\n\t\t\titems: this.getEpicList(),\n\t\t\tsearchOptions: {\n\t\t\t\tallowCreateItem: true,\n\t\t\t\tfooterOptions: {\n\t\t\t\t\tlabel: Loc.getMessage('TASKS_SCRUM_SEARCHER_ACTIONS_EPIC_ADD'),\n\t\t\t\t},\n\t\t\t},\n\t\t\thideOnDeselect: true,\n\t\t\tevents: {\n\t\t\t\t'Search:onItemCreateAsync': (event) => {\n\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\tconst { searchQuery } = event.getData();\n\t\t\t\t\t\tconst dialog = event.getTarget();\n\t\t\t\t\t\tconst epicName = searchQuery.getQuery();\n\t\t\t\t\t\tthis.createEpic(epicName)\n\t\t\t\t\t\t\t.then((epic: EpicType) => {\n\t\t\t\t\t\t\t\tthis.addEpicToSearcher(epic);\n\t\t\t\t\t\t\t\tthis.filterService.addItemToListTypeField('EPIC', {\n\t\t\t\t\t\t\t\t\tNAME: epic.name.trim(),\n\t\t\t\t\t\t\t\t\tVALUE: String(epic.id),\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tconst epicDialogItem = this.getEpicById(epic.id);\n\t\t\t\t\t\t\t\tepicDialogItem.selected = true;\n\t\t\t\t\t\t\t\tepicDialogItem.sort = 1;\n\t\t\t\t\t\t\t\tdialog.addItem(epicDialogItem);\n\t\t\t\t\t\t\t\tthis.emit('updateItemEpic', epic.id);\n\t\t\t\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\t\t\t\tthis.epicDialog.hide();\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t;\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\tconst epicId = selectedItem.getId();\n\t\t\t\t\tthis.emit('updateItemEpic', epicId);\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': () => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tchoiceWasMade = true;\n\t\t\t\t\t\tif (this.epicDialog.getSelectedItems().length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.emit('updateItemEpic', 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 50);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttagSelectorOptions: {\n\t\t\t\ttextBoxWidth: 340,\n\t\t\t\tplaceholder: Loc.getMessage('TASKS_SCRUM_ITEM_EPIC_SEARCHER_PLACEHOLDER'),\n\t\t\t},\n\t\t});\n\n\t\tthis.epicDialog.subscribe('onHide', () => {\n\t\t\tif (choiceWasMade)\n\t\t\t{\n\t\t\t\tthis.emit('hideEpicDialog');\n\t\t\t}\n\t\t\tthis.epicDialog = null;\n\t\t});\n\n\t\tthis.epicDialog.show();\n\t}\n\n\tisEpicDialogShown(): boolean\n\t{\n\t\treturn this.epicDialog && this.epicDialog.isOpen();\n\t}\n\n\thasActionPanelDialog(): boolean\n\t{\n\t\treturn (this.epicDialog || this.tagDialog);\n\t}\n\n\tcloseActionPanelDialogs()\n\t{\n\t\tif (this.epicDialog)\n\t\t{\n\t\t\tthis.epicDialog.hide();\n\t\t}\n\n\t\tif (this.tagDialog)\n\t\t{\n\t\t\tthis.tagDialog.hide();\n\t\t}\n\t}\n\n\t//widget on scrum (new task)\n\tshowTagsSearchDialog(inputObject: Input, enteredQuery: string): Dialog\n\t{\n\t\tif (this.tagsAreConverting)\n\t\t{\n\t\t\tinputObject.setTagsSearchMode(false);\n\t\t\treturn;\n\t\t}\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.tagSearchDialog && this.tagSearchDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.tagSearchDialog = null;\n\t\t}\n\t\tlet groupId = this.groupId;\n\t\tif (!this.tagSearchDialog)\n\t\t{\n\t\t\tthis.tagSearchDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tcompactView: true,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'task-tag',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttabOptions: {\n\t\t\t\t\tvisible: false,\n\t\t\t\t},\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t},\n\t\t\t\tfooter: BX.Tasks.EntitySelector.Footer,\n\t\t\t\tfooterOptions: {\n\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\tgroupId: groupId,\n\t\t\t\t},\n\t\t\t\tclearUnavailableItems: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'onLoad': (event) => {\n\t\t\t\t\t\tevent.getTarget().getFooterContainer().style.zIndex = 1;\n\t\t\t\t\t\tthis.onLoadTaskQuickCreateCallback(event, inputObject);\n\t\t\t\t\t},\n\t\t\t\t\t'onSearch': event => {\n\t\t\t\t\t\tthis.onSearchCallback(event);\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tlet newValue = '';\n\t\t\t\t\t\tconst regex = new RegExp('\\\\s|#$', 'm');\n\t\t\t\t\t\tconst currentPiece = input.value.split(regex).pop();\n\t\t\t\t\t\tinput.value.split(regex)\n\t\t\t\t\t\t\t.forEach((pieceOfValue: string) => {\n\t\t\t\t\t\t\t\tif (currentPiece !== pieceOfValue)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tnewValue = newValue + ' ' + pieceOfValue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t;\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tnewValue = newValue + ' #' + selectedItem.getTitle();\n\t\t\t\t\t\tinput.value = newValue.trim();\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.tagSearchDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setTagsSearchMode(false);\n\t\t\t});\n\t\t}\n\n\t\tinputObject.subscribe('onEnter', event => {\n\t\t\tif (Type.isNil(this.tagSearchDialog))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst searchTab = this.tagSearchDialog.getSearchTab();\n\t\t\tif (Type.isNil(searchTab))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (searchTab.isEmptyResult())\n\t\t\t{\n\t\t\t\tthis.tagSearchDialog.hide();\n\t\t\t\tthis.tagSearchDialog = null;\n\t\t\t\tinput.focus();\n\t\t\t}\n\t\t});\n\n\t\tinputObject.setTagsSearchMode(true);\n\t\tthis.tagSearchDialog.show();\n\t\tthis.tagSearchDialog.search(enteredQuery);\n\t}\n\n\tcloseTagsSearchDialog()\n\t{\n\t\tif (this.tagSearchDialog)\n\t\t{\n\t\t\tthis.tagSearchDialog.hide();\n\t\t}\n\t}\n\n\tshowEpicSearchDialog(inputObject: Input, enteredQuery: string): Dialog\n\t{\n\t\tconst input = inputObject.getInputNode();\n\n\t\tif (this.epicSearchDialog && this.epicSearchDialog.getId() !== inputObject.getNodeId())\n\t\t{\n\t\t\tthis.epicSearchDialog = null;\n\t\t}\n\n\t\tthis.epicEnteredQuery = enteredQuery;\n\n\t\tif (!this.epicSearchDialog)\n\t\t{\n\t\t\tthis.epicSearchDialog = new Dialog({\n\t\t\t\tid: inputObject.getNodeId(),\n\t\t\t\ttargetNode: inputObject.getNode(),\n\t\t\t\twidth: inputObject.getNode().offsetWidth,\n\t\t\t\theight: 210,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: true,\n\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\tlabel: Loc.getMessage('TASKS_SCRUM_SEARCHER_ACTIONS_EPIC_ADD'),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\titems: this.getEpicList(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Search:onItemCreateAsync': (event) => {\n\t\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\t\tconst { searchQuery } = event.getData();\n\t\t\t\t\t\t\tconst epicName = searchQuery.getQuery();\n\n\t\t\t\t\t\t\tinputObject.disable();\n\n\t\t\t\t\t\t\tinputObject.setSelectedEpicLength([...epicName].length);\n\t\t\t\t\t\t\tinput.focus();\n\n\t\t\t\t\t\t\tthis.createEpic(epicName)\n\t\t\t\t\t\t\t\t.then((epic: ?EpicType) => {\n\n\t\t\t\t\t\t\t\t\tthis.addEpicToSearcher(epic);\n\n\t\t\t\t\t\t\t\t\tthis.filterService.addItemToListTypeField('EPIC', {\n\t\t\t\t\t\t\t\t\t\tNAME: epic.name.trim(),\n\t\t\t\t\t\t\t\t\t\tVALUE: String(epic.id),\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tinputObject.unDisable();\n\t\t\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\t\t\tinputObject.setEpic(epic);\n\n\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t;\n\n\t\t\t\t\t\t\tthis.epicSearchDialog.hide();\n\t\t\t\t\t\t\tthis.epicSearchDialog = null;\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\tconst selectedItem = event.getData().item;\n\t\t\t\t\t\tconst epicName = selectedItem.getTitle();\n\t\t\t\t\t\tinput.value = input.value.replace('@' + this.epicEnteredQuery, '').replace('@', '');\n\t\t\t\t\t\tinput.value = input.value + '@' + epicName;\n\t\t\t\t\t\tinputObject.setSelectedEpicLength([...epicName].length);\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tselectedItem.deselect();\n\t\t\t\t\t\tinputObject.setEpic(this.getEpicByName(selectedItem.getTitle()));\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.epicSearchDialog.subscribe('onHide', () => {\n\t\t\t\tinputObject.setEpicSearchMode(false);\n\t\t\t});\n\n\t\t\tinputObject.subscribe('onMetaEnter', () => {\n\t\t\t\tif (Type.isNil(this.epicSearchDialog))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst searchTab = this.epicSearchDialog.getSearchTab();\n\t\t\t\tif (Type.isNil(searchTab))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst lastSearchQuery = searchTab.getLastSearchQuery();\n\t\t\t\tif (Type.isNil(lastSearchQuery))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst epicName = lastSearchQuery.getQuery();\n\n\t\t\t\tinputObject.disable();\n\n\t\t\t\tinputObject.setSelectedEpicLength([...epicName].length);\n\t\t\t\tinput.focus();\n\n\t\t\t\tthis.createEpic(epicName)\n\t\t\t\t\t.then((epic: ?EpicType) => {\n\n\t\t\t\t\t\tthis.addEpicToSearcher(epic);\n\n\t\t\t\t\t\tthis.filterService.addItemToListTypeField('EPIC', {\n\t\t\t\t\t\t\tNAME: epic.name.trim(),\n\t\t\t\t\t\t\tVALUE: String(epic.id),\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tinputObject.unDisable();\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tinputObject.setEpic(epic);\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tthis.epicSearchDialog.hide();\n\t\t\t\tthis.epicSearchDialog = null;\n\t\t\t});\n\t\t}\n\n\t\tinputObject.setEpicSearchMode(true);\n\n\t\tthis.epicSearchDialog.show();\n\t\tthis.epicSearchDialog.search(this.epicEnteredQuery);\n\t}\n\n\tcloseEpicSearchDialog()\n\t{\n\t\tif (this.epicSearchDialog)\n\t\t{\n\t\t\tthis.epicSearchDialog.hide();\n\t\t}\n\t}\n\n\tcreateEpic(epicName: string): Promise\n\t{\n\t\treturn this.requestSender.createEpic(\n\t\t\t\t{\n\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\tname: epicName,\n\t\t\t\t},\n\t\t\t)\n\t\t\t.then((response) => {\n\t\t\t\treturn response.data;\n\t\t\t})\n\t\t\t;\n\t}\n\n\tstatic getHashTagNamesFromText(inputText: string): Array\n\t{\n\t\tconst regex = new RegExp(TagSearcher.tagRegExp, 'g');\n\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0].substring(1));\n\t\t}\n\n\t\treturn matches;\n\t}\n\n\tstatic getHashEpicNamesFromText(inputText: string): Array\n\t{\n\t\tconst regex = new RegExp(TagSearcher.epicRegExp, 'g');\n\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile (match = regex.exec(inputText))\n\t\t{\n\t\t\tmatches.push(match[0].substring(1));\n\t\t}\n\n\t\treturn matches;\n\t}\n\n\thideDialogLabel(dialog: Dialog)\n\t{\n\t\t//todo tmp, remove after update selector\n\t\tdialog\n\t\t\t.getContainer()\n\t\t\t.querySelectorAll('.ui-selector-tab-label')\n\t\t\t.forEach((label: HTMLElement) => {\n\t\t\t\tDom.addClass(label, 'ui-selector-tab-label-hidden');\n\t\t\t})\n\t\t;\n\t}\n\n\tonSearchCallback(event)\n\t{\n\t\tlet dialog = event.getTarget();\n\t\tlet query = event.getData().query;\n\t\tif (query.trim() !== '')\n\t\t{\n\t\t\tdialog.getFooterContainer().querySelector('#tags-widget-custom-footer-add-new').hidden = false;\n\t\t\tdialog.getFooterContainer().querySelector('#tags-widget-custom-footer-conjunction').hidden = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdialog.getFooterContainer().querySelector('#tags-widget-custom-footer-add-new').hidden = true;\n\t\t\tdialog.getFooterContainer().querySelector('#tags-widget-custom-footer-conjunction').hidden = true;\n\t\t}\n\t}\n\n\tonLoadTaskQuickCreateCallback(event, inputObject)\n\t{\n\t\tlet dialog = event.getTarget();\n\t\tthis.hideDialogLabel(dialog);\n\t\tlet input = inputObject.getInputNode();\n\n\t\tinputObject.subscribe('onMetaEnter', (event) => {\n\t\t\tconst regex = new RegExp('\\\\s|#$', 'm');\n\t\t\tconst currentPiece = input.value.split(regex).pop();\n\t\t\tconst tagName = currentPiece.replace('#', '').trim();\n\t\t\tlet data = {\n\t\t\t\tnewTag: tagName,\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\ttaskId: 0,\n\t\t\t\taction: 'add',\n\t\t\t};\n\t\t\tif (tagName === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.requestSender.addTag(data).then(response => {\n\t\t\t\tif (!response.data.success)\n\t\t\t\t{\n\t\t\t\t\tlet alertClass = 'tasks-scrum-tag-already-exists-alert';\n\t\t\t\t\tthis.showAlert(dialog.getId(), alertClass, response.data.error);\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.removeAlert(dialog, alertClass);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t2000);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdialog.search(tagName);\n\t\t\t});\n\t\t});\n\n\t\tdialog.getFooterContainer().querySelector('#tags-widget-custom-footer-add-new')\n\t\t\t.addEventListener('click', event => {\n\t\t\t\tconst regex = new RegExp('\\\\s|#$', 'm');\n\t\t\t\tconst currentPiece = input.value.split(regex).pop();\n\t\t\t\tconst tagName = currentPiece.replace('#', '').trim();\n\t\t\t\tlet data = {\n\t\t\t\t\tnewTag: tagName,\n\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\ttaskId: 0,\n\t\t\t\t\taction: 'add',\n\t\t\t\t};\n\t\t\t\tif (tagName === '')\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.requestSender.addTag(data).then(response => {\n\t\t\t\t\tif (!response.data.success)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet alertClass = 'tasks-scrum-tag-already-exists-alert';\n\t\t\t\t\t\tthis.showAlert(dialog.getId(), alertClass, response.data.error);\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tthis.removeAlert(dialog, alertClass);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t2000);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tdialog.search(tagName);\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tonShowTaskEditCallback(event, statusSuccess, item)\n\t{\n\t\tlet dialog = event.getTarget();\n\t\tconst events = ['click', 'keydown'];\n\n\t\tconst handler = event => {\n\t\t\tif (event.type === 'keydown')\n\t\t\t{\n\t\t\t\tif (!((event.ctrlKey || event.metaKey) && event.keyCode === 13))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst tag = dialog.getTagSelectorQuery();\n\t\t\tif (tag.trim() === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst data = {\n\t\t\t\ttag: tag,\n\t\t\t\titemIds: [item.getId()],\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\taction: 'add',\n\t\t\t};\n\t\t\tthis.requestSender.updateTaskTags(data).then(response => {\n\t\t\t\tif (response.data.success)\n\t\t\t\t{\n\t\t\t\t\tstatusSuccess.status = true;\n\t\t\t\t\tlet item = dialog.addItem({\n\t\t\t\t\t\tid: tag,\n\t\t\t\t\t\tentityId: 'task-tag',\n\t\t\t\t\t\ttitle: tag,\n\t\t\t\t\t\ttabs: 'all',\n\t\t\t\t\t});\n\n\t\t\t\t\titem.select();\n\t\t\t\t\titem.setBadges([{ title: response.data.group }]);\n\t\t\t\t\tdialog.getTagSelector().clearTextBox();\n\t\t\t\t\tdialog.focusSearch();\n\t\t\t\t\tdialog.selectFirstTab();\n\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet alertClass = 'tasks-scrum-tag-already-exists-alert';\n\t\t\t\t\tthis.showAlert(dialog.getId(), alertClass, response.data.error);\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.removeAlert(dialog, alertClass);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t3000);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tevents.forEach(function(ev) {\n\t\t\tif (ev === 'click')\n\t\t\t{\n\t\t\t\tdialog.getFooterContainer().querySelector('#tags-widget-custom-footer-add-new')\n\t\t\t\t\t.addEventListener(ev, handler);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdialog.getContainer().addEventListener(ev, handler);\n\t\t\t}\n\t\t});\n\t}\n\n\tshowAlert(dialogId: string, className: string, error: string, messageType = 'ui-alert ui-alert-xs ui-alert-danger')\n\t{\n\t\tlet dialog = BX.UI.EntitySelector.Dialog.getById(dialogId);\n\n\t\tif (dialog.getContainer().querySelector(`div.${className}`))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet alert = document.createElement('div');\n\t\talert.className = className;\n\t\talert.innerHTML = `\n\t\t\t\t\t\t<div class='${messageType}'  \n\t\t\t\t\t\t\t<span class='ui-alert-message'>\n\t\t\t\t\t\t\t\t${error}\n\t\t\t\t\t\t\t</span> \n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\t\tdialog.getFooterContainer().before(alert);\n\t};\n\n\tremoveAlert(dialog: Dialog, className: string)\n\t{\n\t\tlet notification = dialog.getContainer().querySelector(`div.${className}`);\n\t\tnotification && notification.remove();\n\t}\n\n\tshowConvertingMessage()\n\t{\n\t\tconst message = new MessageBox({\n\t\t\ttitle: Loc.getMessage('TASKS_SCRUM_TAG_SELECTOR_TAGS_ARE_CONVERTING_TITLE'),\n\t\t\tmessage: Loc.getMessage('TASKS_SCRUM_TAG_SELECTOR_TAGS_ARE_CONVERTING_TEXT'),\n\t\t\tbuttons: MessageBoxButtons.OK,\n\t\t\tokCaption: Loc.getMessage('TASKS_SCRUM_TAG_SELECTOR_TAGS_ARE_CONVERTING_COME_BACK_LATER'),\n\t\t\tonOk: function(){\n\t\t\t\tmessage.close();\n\t\t\t}\n\t\t});\n\t\tmessage.show();\n\t}\n}","import {Browser, Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Entity} from '../entity/entity';\n\nimport {TagSearcher} from './tag.searcher';\n\nimport '../css/input.css';\n\nimport type {EpicType} from '../item/task/epic';\n\nexport class Input extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Input');\n\n\t\tthis.entity = null;\n\t\tthis.bindNode = null;\n\n\t\tthis.node = null;\n\n\t\tthis.value = '';\n\t\tthis.epic = null;\n\t\tthis.taskCreated = false;\n\n\t\tthis.selectedEpicLength = 0;\n\t}\n\n\tsetEntity(entity: Entity)\n\t{\n\t\tthis.entity = entity;\n\t}\n\n\tgetEntity(): ?Entity\n\t{\n\t\treturn this.entity;\n\t}\n\n\thasEntity(entity: Entity): boolean\n\t{\n\t\treturn this.entity && this.entity.getId() === entity.getId();\n\t}\n\n\tsetBindNode(node: HTMLElement)\n\t{\n\t\tthis.bindNode = node;\n\t}\n\n\tgetBindNode(): ?HTMLElement\n\t{\n\t\treturn this.bindNode;\n\t}\n\n\tcleanBindNode()\n\t{\n\t\tthis.bindNode = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.nodeId = Text.getRandom();\n\n\t\tthis.node = Tag.render`\n\t\t\t<div id=\"${Text.encode(this.nodeId)}\" class=\"tasks-scrum__input --add-block\">\n\t\t\t\t<textarea\n\t\t\t\t\tplaceholder=\"${Loc.getMessage('TASKS_SCRUM_TASK_ADD_INPUT_TASK_PLACEHOLDER')}\"\n\t\t\t\t\tclass=\"tasks-scrum__input--textarea\"\n\t\t\t\t>${Text.encode(this.value)}</textarea>\n\t\t\t\t<div class=\"tasks-scrum__input--textarea-help\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_TASK_ADD_INPUT_TASK_PLACEHOLDER_HELPER')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.getInputNode(), 'input', (event) => {\n\t\t\tthis.onTagSearch(event);\n\t\t\tthis.onEpicSearch(event);\n\t\t});\n\t\tEvent.bind(this.getInputNode(), 'keydown', this.onKeydown.bind(this));\n\t\tEvent.bind(this.getInputNode(), 'blur', this.onBlur.bind(this));\n\n\t\tthis.emit('render');\n\n\t\tthis.taskCreated = false;\n\n\t\treturn this.node;\n\t}\n\n\tonKeydown(event: KeyboardEvent)\n\t{\n\t\tif (event.key === 'Escape' || event.key === 'Enter')\n\t\t{\n\t\t\tif (!this.isTagsSearchMode() && !this.isEpicSearchMode())\n\t\t\t{\n\t\t\t\tthis.submit();\n\n\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tevent.key === 'Enter'\n\t\t\t\t&& !((Browser.isMac() && event.metaKey) || event.ctrlKey)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.emit('onEnter', { event });\n\t\t\t}\n\t\t\tif (\n\t\t\t\tevent.key === 'Enter'\n\t\t\t\t&& ((Browser.isMac() && event.metaKey) || event.ctrlKey)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.emit('onMetaEnter', { event });\n\t\t\t}\n\t\t}\n\t}\n\n\tonBlur()\n\t{\n\t\tconst input = this.getInputNode();\n\n\t\tif (input.value === '')\n\t\t{\n\t\t\tthis.removeYourself();\n\t\t}\n\t}\n\n\tonTagSearch(event)\n\t{\n\t\tconst currentPieceOfName = event.target.value.split(' ').pop();\n\t\tconst enteredHashTags = TagSearcher.getHashTagNamesFromText(currentPieceOfName);\n\n\t\tconst query = enteredHashTags.length ? enteredHashTags.pop() : '';\n\n\t\tif (query || event.data === '#')\n\t\t{\n\t\t\tthis.setEpicSearchMode(false);\n\t\t\tthis.setTagsSearchMode(true);\n\n\t\t\tthis.emit('tagsSearchOpen', query);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('tagsSearchClose');\n\t\t}\n\t}\n\n\tsubmit()\n\t{\n\t\tthis.disable();\n\n\t\tif (this.isEmpty())\n\t\t{\n\t\t\tthis.removeYourself();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.createTaskItem();\n\t\t}\n\t}\n\n\tonEpicSearch(event)\n\t{\n\t\tconst inputNode = event.target;\n\t\tconst enteredHashEpics = TagSearcher.getHashEpicNamesFromText(inputNode.value);\n\n\t\tconst query = enteredHashEpics.length ? enteredHashEpics.pop() : '';\n\n\t\tif (\n\t\t\tthis.selectedEpicLength > 0\n\t\t\t&& this.selectedEpicLength <= [...query].length\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.selectedEpicLength = 0;\n\n\t\tif (query || event.data === '@')\n\t\t{\n\t\t\tthis.setTagsSearchMode(false);\n\t\t\tthis.setEpicSearchMode(true);\n\n\t\t\tthis.emit('epicSearchOpen', query);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('epicSearchClose');\n\t\t}\n\t}\n\n\tfocus()\n\t{\n\t\tconst input = this.getInputNode();\n\n\t\tconst length = input.value.length;\n\n\t\tinput.focus();\n\t\tinput.setSelectionRange(length, length);\n\t}\n\n\tdisable()\n\t{\n\t\tDom.addClass(this.node, '--disabled');\n\n\t\tthis.getInputNode().disabled = true;\n\t}\n\n\tunDisable()\n\t{\n\t\tDom.removeClass(this.node, '--disabled');\n\n\t\tthis.getInputNode().disabled = false;\n\n\t\tthis.emit('unDisable');\n\t}\n\n\tisExists(): boolean\n\t{\n\t\treturn !Type.isNull(this.node);\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\tif (!this.isExists())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst input = this.getInputNode();\n\n\t\treturn input.value === '';\n\t}\n\n\tisTaskCreated(): boolean\n\t{\n\t\treturn this.taskCreated;\n\t}\n\n\tsetEpic(epic: ?EpicType)\n\t{\n\t\tthis.epic = epic;\n\t}\n\n\tgetNode(): HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetNodeId(): String\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tgetInputNode(): HTMLTextAreaElement\n\t{\n\t\treturn this.node.querySelector('textarea');\n\t}\n\n\tgetEpic(): ?EpicType\n\t{\n\t\treturn this.epic;\n\t}\n\n\tremoveYourself()\n\t{\n\t\tDom.remove(this.node);\n\n\t\tthis.node = null;\n\n\t\tthis.emit('remove');\n\t}\n\n\tsetTagsSearchMode(value: boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-tag-disabled', value);\n\t}\n\n\tisTagsSearchMode(): boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-tag-disabled');\n\t}\n\n\tsetEpicSearchMode(value: boolean)\n\t{\n\t\tDom.attr(this.getInputNode(), 'data-epic-disabled', value);\n\t}\n\n\tisEpicSearchMode(): boolean\n\t{\n\t\treturn Dom.attr(this.getInputNode(), 'data-epic-disabled');\n\t}\n\n\tsetSelectedEpicLength(length: number)\n\t{\n\t\tthis.selectedEpicLength = parseInt(length, 10);\n\t}\n\n\tcreateTaskItem()\n\t{\n\t\tconst input = this.getInputNode();\n\n\t\tif (input.value)\n\t\t{\n\t\t\tthis.emit('createTaskItem', input.value);\n\n\t\t\tthis.taskCreated = true;\n\n\t\t\tinput.value = '';\n\t\t}\n\t}\n}\n","import {Dom, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nimport 'main.polyfill.intersectionobserver';\n\nimport {Item} from '../item/item';\nimport {ListItems} from './list.items';\n\nimport {Input} from '../utility/input';\nimport {StoryPointsStorage} from '../utility/story.points.storage';\n\nimport type {Views} from '../view/view';\n\ntype EntityParams = {\n\tid: number,\n\tviews?: Views,\n\tnumberTasks?: number,\n\tisExactSearchApplied: 'Y' | 'N',\n\tstoryPoints?: string,\n\tpageSize: number,\n\tpageNumberItems: number,\n\tisShortView: 'Y' | 'N',\n\tmandatoryExists: 'Y' | 'N'\n};\n\nexport class Entity extends EventEmitter\n{\n\tconstructor(params: EntityParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Entity');\n\n\t\tthis.storyPoints = new StoryPointsStorage();\n\n\t\tthis.items = new Map();\n\n\t\tthis.groupMode = false;\n\t\tthis.groupModeItems = new Map();\n\n\t\tthis.setEntityParams(params);\n\n\t\tthis.observerLoadItems = null;\n\n\t\tthis.node = null;\n\t\tthis.listItems = null;\n\n\t\tthis.itemLoader = null;\n\t\tthis.itemsLoaderNode = null;\n\n\t\tthis.blank = null;\n\t\tthis.dropzone = null;\n\t\tthis.emptySearchStub = null;\n\t}\n\n\tsetEntityParams(params: EntityParams)\n\t{\n\t\tthis.setId(params.id);\n\t\tthis.setViews(params.views);\n\t\tthis.setNumberTasks(params.numberTasks);\n\t\tthis.setStoryPoints(params.storyPoints);\n\t\tthis.setShortView(params.isShortView);\n\t\tthis.setMandatory(params.mandatoryExists);\n\t\tthis.setExactSearchApplied(params.isExactSearchApplied);\n\n\t\tthis.pageSize = parseInt(params.pageSize, 10);\n\t\tthis.setPageNumberItems(params.pageNumberItems);\n\t}\n\n\tsetListItems(entity: Entity)\n\t{\n\t\tthis.listItems = new ListItems(entity);\n\t}\n\n\tgetListItems(): ?ListItems\n\t{\n\t\treturn this.listItems;\n\t}\n\n\tsetShortView(value: string)\n\t{\n\t\tthis.shortView = (value === 'Y' ? 'Y' : 'N');\n\n\t\tthis.getItems()\n\t\t\t.forEach((item: Item) => {\n\t\t\t\tif (item.isParentTask() && item.isShownSubTasks())\n\t\t\t\t{\n\t\t\t\t\titem.hideSubTasks();\n\t\t\t\t}\n\t\t\t\titem.setShortView(this.shortView);\n\t\t\t})\n\t\t;\n\t}\n\n\tgetShortView(): 'Y' | 'N'\n\t{\n\t\treturn this.shortView;\n\t}\n\n\tisShortView(): boolean\n\t{\n\t\treturn this.shortView === 'Y';\n\t}\n\n\tsetMandatory(value: 'Y' | 'N')\n\t{\n\t\tthis.mandatoryExists = value === 'Y';\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tsetId(id: number)\n\t{\n\t\tthis.id = (Type.isInteger(id) ? parseInt(id, 10) : 0);\n\n\t\tif (this.listItems)\n\t\t{\n\t\t\tthis.listItems.setEntityId(this.id);\n\t\t}\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetViews(views)\n\t{\n\t\tthis.views = (Type.isPlainObject(views) ? views : {});\n\t}\n\n\tgetViews()\n\t{\n\t\treturn this.views;\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'entity';\n\t}\n\n\tisBacklog(): boolean\n\t{\n\t\treturn this.getEntityType() === 'backlog';\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tgetListItemsNode(): ?HTMLElement\n\t{\n\t\treturn (this.listItems ? this.listItems.getListNode() : null);\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn (this.items.size === 0);\n\t}\n\n\tgetNumberItems(): number\n\t{\n\t\treturn this.items.size;\n\t}\n\n\tgetItems(): Map\n\t{\n\t\treturn this.items;\n\t}\n\n\thasItem(item: Item): boolean\n\t{\n\t\treturn this.items.has(item.getId());\n\t}\n\n\tgetPageSize(): number\n\t{\n\t\treturn this.pageSize;\n\t}\n\n\tgetPageNumberItems(): number\n\t{\n\t\treturn this.pageNumberItems;\n\t}\n\n\tsetPageNumberItems(pageNumberItems: number)\n\t{\n\t\tif (Type.isInteger(pageNumberItems))\n\t\t{\n\t\t\tpageNumberItems = parseInt(pageNumberItems, 10);\n\t\t}\n\n\t\tthis.pageNumberItems = pageNumberItems ? pageNumberItems : 1;\n\t}\n\n\tincrementPageNumberItems()\n\t{\n\t\tthis.pageNumberItems++;\n\t}\n\n\tdecrementPageNumberItems()\n\t{\n\t\tthis.pageNumberItems--;\n\t}\n\n\trecalculateItemsSort()\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tif (!listItemsNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet sort = 1;\n\t\tlistItemsNode.querySelectorAll('.tasks-scrum-item').forEach((node: HTMLElement) => {\n\t\t\tconst item = this.getItems().get(parseInt(node.dataset.id, 10));\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.setSort(sort);\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tthis.items.set(newItem.getId(), newItem);\n\n\t\tthis.subscribeToItem(newItem);\n\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\n\t\tnewItem.setEntityType(this.getEntityType());\n\t\tnewItem.setShortView(this.getShortView());\n\n\t\tthis.hideBlank();\n\t\tthis.hideDropzone();\n\t\tthis.hideEmptySearchStub();\n\n\t\tthis.adjustListItemsWidth();\n\t}\n\n\tsetItemMoveActivity(item: Item)\n\t{\n\t\titem.setMoveActivity(this.items.size > 2);\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tif (this.items.has(item.getId()))\n\t\t{\n\t\t\tthis.items.delete(item.getId());\n\n\t\t\titem.unsubscribeAll();\n\n\t\t\t[...this.items.values()].map((item) => {\n\t\t\t\tthis.setItemMoveActivity(item);\n\t\t\t});\n\n\t\t\tif (item.isParentTask())\n\t\t\t{\n\t\t\t\titem.getSubTasks().getList().forEach((item: Item) => {\n\t\t\t\t\tthis.removeItem(item);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.pageNumberItems = 1;\n\n\t\t\tthis.adjustListItemsWidth();\n\t\t}\n\t}\n\n\tappendItemToList(item: Item)\n\t{\n\t\tDom.insertBefore(item.render(), this.getListItemsNode().lastElementChild);\n\n\t\tthis.adjustListItemsWidth();\n\t}\n\n\tisNodeCreated(): boolean\n\t{\n\t\treturn !Type.isNull(this.node);\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tthis.numberTasks = (Type.isInteger(numberTasks) ? parseInt(numberTasks, 10) : 0);\n\t}\n\n\tgetNumberTasks(): number\n\t{\n\t\treturn (this.numberTasks ? this.numberTasks : this.getItems().size);\n\t}\n\n\tsetExactSearchApplied(value: 'Y' | 'N')\n\t{\n\t\tthis.exactSearchApplied = value === 'Y';\n\t}\n\n\tisExactSearchApplied(): boolean\n\t{\n\t\treturn this.exactSearchApplied;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\t[...this.items.values()].map((item) => {\n\t\t\tthis.subscribeToItem(item);\n\t\t\tthis.setItemMoveActivity(item);\n\t\t});\n\n\t\tthis.setStats();\n\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.itemsLoaderNode = this.getNode().querySelector('.tasks-scrum-entity-items-loader');\n\t\t\tthis.bindItemsLoader(this.itemsLoaderNode);\n\t\t}\n\n\t\tthis.adjustListItemsWidth();\n\t}\n\n\tsubscribeToItem(item: Item)\n\t{\n\t\tif (!this.getListItemsNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.setEntityType(this.getEntityType());\n\n\t\titem.subscribe('updateItem', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('updateItem', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('showTask', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('showTask', baseEvent.getTarget());\n\t\t});\n\n\t\titem.subscribe('destroyActionPanel', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('destroyActionPanel', baseEvent.getTarget());\n\t\t});\n\n\t\titem.subscribe('changeTaskResponsible', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('changeTaskResponsible', baseEvent.getTarget());\n\t\t});\n\n\t\titem.subscribe('onShowResponsibleDialog', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('onShowResponsibleDialog', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('filterByEpic', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('filterByEpic', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('filterByTag', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('filterByTag', baseEvent.getData());\n\t\t});\n\n\t\titem.subscribe('toggleActionPanel', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('toggleActionPanel', baseEvent.getTarget());\n\t\t});\n\n\t\titem.subscribe('showLinked', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('showLinked', baseEvent.getTarget());\n\t\t});\n\t}\n\n\tgetItemByItemId(itemId: number | string): ?Item\n\t{\n\t\treturn this.items.get((Type.isInteger(itemId) ? parseInt(itemId, 10) : itemId));\n\t}\n\n\tgetItemBySourceId(sourceId: number): ?Item\n\t{\n\t\treturn [...this.items.values()].find((item: Item) => item.getSourceId() === sourceId);\n\t}\n\n\tgetItemsByParentTaskId(parentTaskId: number): Map<number, Item>\n\t{\n\t\tconst items = new Map();\n\n\t\t[...this.items.values()].map((item: Item) => {\n\t\t\tif (item.getParentTaskId() === parentTaskId)\n\t\t\t{\n\t\t\t\titems.set(item.getId(), item);\n\t\t\t}\n\t\t});\n\n\t\treturn items;\n\t}\n\n\tsetStoryPoints(storyPoints: string)\n\t{\n\t\tthis.storyPoints.setPoints(storyPoints);\n\n\t\tthis.setStats();\n\t}\n\n\tgetStoryPoints(): StoryPointsStorage\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tisFirstItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getNode();\n\t\tconst firstElementChild = listItemsNode.firstElementChild;\n\n\t\treturn firstElementChild.isEqualNode(itemNode);\n\t}\n\n\tisLastItem(item: Item): boolean\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\t\tconst itemNode = item.getNode();\n\n\t\treturn listItemsNode.lastElementChild.isEqualNode(itemNode);\n\t}\n\n\tgetFirstItemNode(input?: Input): ?HTMLElement\n\t{\n\t\tconst listItemsNode = this.getListItemsNode();\n\n\t\tconst fistNode = listItemsNode.firstElementChild;\n\n\t\tif (input && fistNode.isEqualNode(input.getNode()))\n\t\t{\n\t\t\treturn fistNode.nextElementSibling;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn fistNode;\n\t\t}\n\t}\n\n\tgetLoaderNode(): ?HTMLElement\n\t{\n\t\treturn this.itemsLoaderNode ? this.itemsLoaderNode : null;\n\t}\n\n\tfadeOut()\n\t{\n\t\tDom.addClass(this.getListItemsNode(), 'tasks-scrum__entity-items-faded');\n\t}\n\n\tfadeIn()\n\t{\n\t\tDom.removeClass(this.getListItemsNode(), 'tasks-scrum__entity-items-faded');\n\t}\n\n\tactivateGroupMode()\n\t{\n\t\tthis.groupMode = true;\n\n\t\tthis.getItems().forEach((item: Item) => {\n\t\t\titem.activateGroupMode();\n\t\t});\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tthis.groupMode = false;\n\n\t\tthis.getItems().forEach((item: Item) => {\n\t\t\titem.deactivateGroupMode();\n\t\t});\n\n\t\tthis.groupModeItems.forEach((item: Item) => {\n\t\t\titem.removeItemFromGroupMode();\n\t\t});\n\t\tthis.groupModeItems.clear();\n\n\t\tthis.emit('deactivateGroupMode');\n\t}\n\n\tisGroupMode(): boolean\n\t{\n\t\treturn this.groupMode;\n\t}\n\n\taddItemToGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.set(item.getId(), item);\n\n\t\titem.addItemToGroupMode();\n\t}\n\n\tremoveItemFromGroupMode(item: Item)\n\t{\n\t\tthis.groupModeItems.delete(item.getId());\n\n\t\titem.removeItemFromGroupMode();\n\t}\n\n\thasItemInGroupMode(item: Item): boolean\n\t{\n\t\treturn this.groupModeItems.has(item.getId());\n\t}\n\n\tgetGroupModeItems(): Map\n\t{\n\t\treturn this.groupModeItems;\n\t}\n\n\tbindItemsLoader(loaderNode?: HTMLElement)\n\t{\n\t\tif (!loaderNode)\n\t\t{\n\t\t\tif (this.itemsLoaderNode)\n\t\t\t{\n\t\t\t\tloaderNode = this.itemsLoaderNode;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this.getNumberItems() >= this.pageSize)\n\t\t{\n\t\t\tDom.addClass(loaderNode, '--waiting');\n\t\t}\n\n\t\tif (Type.isUndefined(IntersectionObserver))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.observerLoadItems)\n\t\t{\n\t\t\tthis.observerLoadItems.disconnect();\n\t\t}\n\n\t\tthis.observerLoadItems = new IntersectionObserver((entries) =>\n\t\t\t{\n\t\t\t\tif (entries[0].isIntersecting === true)\n\t\t\t\t{\n\t\t\t\t\tif (!this.isActiveLoadItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.emit('loadItems');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tthreshold: [0]\n\t\t\t}\n\t\t);\n\n\t\tthis.observerLoadItems.observe(loaderNode);\n\t}\n\n\tunbindItemsLoader()\n\t{\n\t\tif (this.observerLoadItems)\n\t\t{\n\t\t\tthis.observerLoadItems.disconnect();\n\t\t}\n\n\t\tif (this.itemsLoaderNode)\n\t\t{\n\t\t\tDom.removeClass(this.itemsLoaderNode, '--waiting')\n\t\t}\n\t}\n\n\tsetActiveLoadItems(value: boolean)\n\t{\n\t\tthis.activeLoadItems = Boolean(value);\n\t}\n\n\tisActiveLoadItems(): boolean\n\t{\n\t\treturn this.activeLoadItems === true;\n\t}\n\n\tshowItemsLoader(): Loader\n\t{\n\t\tconst listPosition = Dom.getPosition(this.itemsLoaderNode);\n\n\t\tif (this.itemLoader)\n\t\t{\n\t\t\tthis.itemLoader.destroy();\n\t\t}\n\n\t\tthis.itemLoader = new Loader({\n\t\t\ttarget: this.itemsLoaderNode,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\toffset: {\n\t\t\t\ttop: '7px',\n\t\t\t\tleft: `${((listPosition.width / 2) - 45)}px`\n\t\t\t}\n\t\t});\n\n\t\tif (this.getNumberItems() >= this.pageSize)\n\t\t{\n\t\t\tthis.itemLoader.show();\n\t\t}\n\n\t\treturn this.itemLoader;\n\t}\n\n\tsetStats() {}\n\n\tshowBlank()\n\t{\n\t\tif (this.blank)\n\t\t{\n\t\t\tDom.addClass(this.blank.getNode(), '--open');\n\t\t}\n\t}\n\n\thideBlank()\n\t{\n\t\tif (this.blank)\n\t\t{\n\t\t\tDom.removeClass(this.blank.getNode(), '--open');\n\t\t}\n\t}\n\n\tshowDropzone()\n\t{\n\t\tif (this.dropzone)\n\t\t{\n\t\t\tDom.addClass(this.dropzone.getNode(), '--open');\n\t\t}\n\t}\n\n\thideDropzone()\n\t{\n\t\tif (this.dropzone)\n\t\t{\n\t\t\tDom.removeClass(this.dropzone.getNode(), '--open');\n\t\t}\n\t}\n\n\tshowEmptySearchStub()\n\t{\n\t\tif (this.emptySearchStub)\n\t\t{\n\t\t\tDom.addClass(this.emptySearchStub.getNode(), '--open');\n\t\t}\n\t}\n\n\thideEmptySearchStub()\n\t{\n\t\tif (this.emptySearchStub)\n\t\t{\n\t\t\tDom.removeClass(this.emptySearchStub.getNode(), '--open');\n\t\t}\n\t}\n\n\tgetDropzone(): ?HTMLElement\n\t{\n\t\treturn this.dropzone ? this.dropzone.getNode() : null;\n\t}\n\n\tappendNodeAfterItem(newItemNode: HTMLElement, bindItemNode: HTMLElement)\n\t{\n\t\tif (bindItemNode.nextElementSibling)\n\t\t{\n\t\t\tDom.insertBefore(newItemNode, bindItemNode.nextElementSibling);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getLoaderNode())\n\t\t\t{\n\t\t\t\tDom.append(newItemNode, this.getLoaderNode());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.append(newItemNode, this.getListItemsNode());\n\t\t\t}\n\t\t}\n\t}\n\n\tadjustListItemsWidth()\n\t{\n\t\tif (Type.isNull(this.getListItemsNode()))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst hasListItemsScroll = this.getListItemsNode().scrollHeight > this.getListItemsNode().clientHeight;\n\n\t\tif (hasListItemsScroll)\n\t\t{\n\t\t\tthis.getListItems().addScrollbar();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getListItems().removeScrollbar();\n\t\t}\n\t}\n}\n","import {Event, Loc, Tag, Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Backlog} from './backlog';\n\nexport class Header extends EventEmitter\n{\n\tconstructor(backlog: Backlog)\n\t{\n\t\tsuper(backlog);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.BacklogHeader');\n\n\t\tthis.backlog = backlog;\n\n\t\tthis.epicButtonLocked = false;\n\t\tthis.taskButtonLocked = false;\n\n\t\tthis.node = null;\n\n\t\tthis.epicButton = null;\n\t\tthis.taskButton = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst uiEpicClasses = 'ui-btn ui-btn-sm ui-btn-light-border ui-btn-themes ui-btn-round ui-btn-no-caps';\n\t\tconst uiTaskClasses = 'ui-btn ui-btn-sm ui-btn-success ui-btn-round ui-btn-no-caps ';\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__content-header\">\n\n\t\t\t\t<div class=\"tasks-scrum__name-container\">\n\t\t\t\t\t<div class=\"tasks-scrum__title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderTaskCounterLabel(this.backlog.getNumberTasks())}\n\t\t\t\t</div>\n\n\t\t\t\t<button class=\"tasks-scrum__backlog-btn ${uiEpicClasses} ui-btn-icon-add\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_HEADER_EPIC')}\n\t\t\t\t</button>\n\t\t\t\t<button class=\"tasks-scrum__backlog-btn ${uiTaskClasses} ui-btn-icon-add\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_HEADER_TASK')}\n\t\t\t\t</button>\n\n\t\t\t</div>\n\t\t`;\n\n\t\tconst buttons = this.node.querySelectorAll('button');\n\n\t\tthis.epicButton = buttons.item(0);\n\t\tthis.taskButton = buttons.item(1);\n\n\t\tEvent.bind(buttons.item(0), 'click', this.onEpicClick.bind(this));\n\t\tEvent.bind(buttons.item(1), 'click', this.onTaskClick.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tupdateTaskCounter(value: string)\n\t{\n\t\tDom.replace(\n\t\t\tthis.node.querySelector('.tasks-scrum__backlog-tasks'),\n\t\t\tthis.renderTaskCounterLabel(value)\n\t\t);\n\t}\n\n\trenderTaskCounterLabel(value: string)\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__backlog-tasks\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_HEADER_TASK_COUNTER').replace('#value#', value)}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tunLockEpicButton()\n\t{\n\t\tthis.epicButtonLocked = false;\n\n\t\tDom.removeClass(this.epicButton, 'ui-btn-wait');\n\t}\n\n\tlockEpicButton()\n\t{\n\t\tthis.epicButtonLocked = true;\n\n\t\tDom.addClass(this.epicButton, 'ui-btn-wait');\n\t}\n\n\tunLockTaskButton()\n\t{\n\t\tthis.taskButtonLocked = false;\n\n\t\tDom.removeClass(this.taskButton, 'ui-btn-wait');\n\t}\n\n\tlockTaskButton()\n\t{\n\t\tthis.taskButtonLocked = true;\n\n\t\tDom.addClass(this.taskButton, 'ui-btn-wait');\n\t}\n\n\tonEpicClick()\n\t{\n\t\tif (this.epicButtonLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.lockEpicButton();\n\n\t\tthis.emit('epicClick');\n\t}\n\n\tonTaskClick()\n\t{\n\t\tif (this.taskButtonLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.lockTaskButton();\n\n\t\tthis.emit('taskClick');\n\t}\n}\n","import {Dom, Tag, Loc} from 'main.core';\n\nimport {Entity} from './entity';\n\nexport class Blank\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tthis.entity = entity;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.entity.isBacklog())\n\t\t{\n\t\t\treturn this.renderBacklog();\n\t\t}\n\t\telse if (this.entity.isCompleted())\n\t\t{\n\t\t\treturn this.renderCompletedSprint();\n\t\t}\n\t}\n\n\trenderBacklog(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__backlog-empty\">\n\t\t\t\t<div class=\"tasks-scrum__backlog-empty--icon\"></div>\n\t\t\t\t<div class=\"tasks-scrum__backlog-empty--title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_BLANK_1')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__backlog-empty--subtitle\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_BLANK_2')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__backlog-empty--text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_BLANK_3')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__backlog-empty--text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_BLANK_4')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\trenderCompletedSprint(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__sprints--completed-empty\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_COMPLETED_SPRINT_EMPTY')}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tremoveNode()\n\t{\n\t\tDom.remove(this.node);\n\n\t\tthis.node = null;\n\t}\n}","import {Event, Dom, Tag, Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Entity} from './entity';\n\nexport class Dropzone extends EventEmitter\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tsuper(entity);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Dropzone');\n\n\t\tthis.entity = entity;\n\n\t\tthis.mandatoryExists = false;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.entity.isBacklog())\n\t\t{\n\t\t\treturn this.renderBacklog();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.renderSprint();\n\t\t}\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tremoveNode()\n\t{\n\t\tDom.remove(this.node);\n\n\t\tthis.node = null;\n\t}\n\n\trenderBacklog(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__content-empty --empty-backlog\" data-entity-id=\"${this.entity.getId()}\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_BACKLOG_DROPZONE_1')}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(\n\t\t\tthis.node,\n\t\t\t'click',\n\t\t\t() => this.emit('createTask')\n\t\t);\n\n\t\treturn this.node;\n\t}\n\n\trenderSprint(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__content-empty\" data-entity-id=\"${this.entity.getId()}\">\n\t\t\t\t<div class=\"tasks-scrum__content-empty--title\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_BLANK_1')}\n\t\t\t\t</div>\n\t\t\t\t${this.renderSprintEmptyText()}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (!this.mandatoryExists)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tthis.node.querySelector('.tasks-scrum__content-empty--btn-create'),\n\t\t\t\t'click',\n\t\t\t\t() => this.emit('createTask')\n\t\t\t);\n\t\t}\n\n\t\treturn this.node;\n\t}\n\n\trenderSprintEmptyText(): HTMLElement\n\t{\n\t\tif (this.mandatoryExists)\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum__content-empty--text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_BLANK_4')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-scrum__content-empty--text\">\n\t\t\t\t\t<span class=\"tasks-scrum__content-empty--btn-create\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_BLANK_2')}\n\t\t\t\t\t</span> ${Loc.getMessage('TASKS_SCRUM_SPRINT_BLANK_3')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t}\n\n\tsetMandatory()\n\t{\n\t\tthis.mandatoryExists = true;\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {Entity} from './entity';\n\nexport class EmptySearchStub\n{\n\tconstructor(entity: Entity)\n\t{\n\t\tthis.entity = entity;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__content-empty --no-results\">\n\t\t\t\t${this.getStubText()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetStubText(): string\n\t{\n\t\tif (this.entity.isBacklog())\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_EMPTY_SEARCH_STUB_BACKLOG');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_SCRUM_EMPTY_SEARCH_STUB_SPRINT');\n\t\t}\n\t}\n}","import {Event, Dom, Tag} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {Header} from './header';\nimport {Blank} from '../blank';\nimport {Dropzone} from '../dropzone';\nimport {EmptySearchStub} from '../empty.search.stub';\n\nimport {Entity} from '../entity';\nimport {Item, ItemParams} from '../../item/item';\n\nimport '../../css/backlog.css';\n\nexport type BacklogParams = {\n\tid: number,\n\titems?: Array<ItemParams>\n};\n\nexport class Backlog extends Entity\n{\n\tconstructor(params: BacklogParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Backlog');\n\n\t\tthis.setBacklogParams(params);\n\n\t\tthis.header = null;\n\t}\n\n\tsetBacklogParams(params: BacklogParams)\n\t{\n\t\tparams.items.forEach((itemData) => {\n\t\t\tconst item = Item.buildItem(itemData);\n\t\t\titem.setShortView(this.getShortView());\n\t\t\tthis.items.set(item.getId(), item);\n\t\t});\n\t}\n\n\tstatic buildBacklog(backlogData: BacklogParams): Backlog\n\t{\n\t\tconst backlog = new Backlog(backlogData);\n\n\t\tbacklog.setHeader(backlog);\n\t\tbacklog.setBlank(backlog);\n\t\tbacklog.setDropzone(backlog);\n\t\tbacklog.setEmptySearchStub(backlog);\n\t\tbacklog.setListItems(backlog);\n\n\t\treturn backlog;\n\t}\n\n\tsetHeader(backlog: Backlog)\n\t{\n\t\tthis.header = new Header(backlog);\n\n\t\tthis.header.subscribe('epicClick', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('openAddEpicForm', baseEvent.getTarget())\n\t\t});\n\n\t\tthis.header.subscribe('taskClick', (baseEvent: BaseEvent) => {\n\t\t\tif (this.mandatoryExists)\n\t\t\t{\n\t\t\t\tthis.emit('openAddTaskForm');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emit('showInput', baseEvent.getTarget());\n\t\t\t}\n\t\t});\n\t}\n\n\tsetBlank(backlog: Backlog)\n\t{\n\t\tthis.blank = new Blank(backlog);\n\t}\n\n\tsetDropzone(backlog: Backlog)\n\t{\n\t\tthis.dropzone = new Dropzone(backlog);\n\n\t\tthis.dropzone.subscribe('createTask', () => {\n\t\t\tif (this.mandatoryExists)\n\t\t\t{\n\t\t\t\tthis.emit('openAddTaskForm');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emit('showInput');\n\t\t\t}\n\t\t});\n\t}\n\n\tsetEmptySearchStub(backlog: Backlog)\n\t{\n\t\tthis.emptySearchStub = new EmptySearchStub(backlog);\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tsuper.setNumberTasks(numberTasks);\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.updateTaskCounter(this.getNumberTasks());\n\t\t}\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn 'backlog';\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__backlog\">\n\t\t\t\t<div class=\"tasks-scrum__content --with-header --open\">\n\t\t\t\t\t${this.header ? this.header.render() : ''}\n\t\t\t\t\t${this.blank ? this.blank.render() : ''}\n\t\t\t\t\t${this.dropzone ? this.dropzone.render() : ''}\n\t\t\t\t\t${this.emptySearchStub ? this.emptySearchStub.render() : ''}\n\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.node.querySelector('.tasks-scrum__content-items'), 'scroll', this.onItemsScroll.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tsuper.setItem(newItem);\n\n\t\tif (newItem.getNode())\n\t\t{\n\t\t\tDom.addClass(newItem.getNode(), '--item-backlog');\n\t\t}\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tsuper.removeItem(item);\n\n\t\tif (this.isEmpty())\n\t\t{\n\t\t\tthis.emit('showBlank');\n\t\t}\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tsuper.onAfterAppend();\n\n\t\tif (this.isEmpty())\n\t\t{\n\t\t\tthis.emit('showBlank');\n\t\t}\n\t}\n\n\tonItemsScroll()\n\t{\n\t\tthis.emit('itemsScroll');\n\t}\n}\n","export type CultureData = {\n\tdayMonthFormat: string,\n\tlongDateFormat: string,\n\tshortTimeFormat: string\n}\n\nexport class Culture\n{\n\tstatic #instance;\n\n\tstatic getInstance()\n\t{\n\t\tif (!Culture.#instance)\n\t\t{\n\t\t\tCulture.#instance = new Culture();\n\t\t}\n\n\t\treturn Culture.#instance;\n\t}\n\n\tsetData(data: CultureData)\n\t{\n\t\tthis.data = data;\n\t}\n\n\tgetDayMonthFormat(): string\n\t{\n\t\treturn this.data.dayMonthFormat;\n\t}\n\n\tgetLongDateFormat(): string\n\t{\n\t\treturn this.data.longDateFormat;\n\t}\n\n\tgetShortTimeFormat(): string\n\t{\n\t\treturn this.data.shortTimeFormat;\n\t}\n}","import {Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Sprint} from '../sprint';\nimport {Culture} from '../../../utility/culture';\n\nexport class Date extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint.Header.Date');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): ?HTMLElement\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__sprint--date-container\">\n\t\t\t\t<div class=\"tasks-scrum__sprint--date --start\">${Date.getFormattedDateStart(this.sprint)}</div>\n\t\t\t\t<div class=\"tasks-scrum__sprint--date-separator\"> - </div>\n\t\t\t\t<div class=\"tasks-scrum__sprint--date --end\">${Date.getFormattedDateEnd(this.sprint)}</div>\n\t\t\t\t<input type=\"hidden\" name=\"dateStart\" value=\"${Text.encode(this.sprint.getDateStartFormatted())})\">\n\t\t\t\t<input type=\"hidden\" name=\"dateEnd\" value=\"${Text.encode(this.sprint.getDateEndFormatted())}\">\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.bindEvents();\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tbindEvents()\n\t{\n\t\tif (this.sprint.isActive() || this.sprint.isCompleted())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst parentPopup = this.node.closest('.popup-window');\n\n\t\tconst customBlur = () => {\n\t\t\tBX.calendar.get().popup.close();\n\t\t};\n\n\t\tconst showCalendar = (node, field) => {\n\t\t\t/* eslint-disable */\n\t\t\tBX.calendar({\n\t\t\t\tnode: node,\n\t\t\t\tfield: field,\n\t\t\t\tbTime: false,\n\t\t\t\tbSetFocus: false,\n\t\t\t\tbHideTime: false\n\t\t\t});\n\t\t\t/* eslint-enable */\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.bindOnce(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t};\n\n\t\tconst updateDateNode = (node, value) => {\n\t\t\t/* eslint-disable */\n\t\t\tnode.textContent = BX.date.format(\n\t\t\t\tCulture.getInstance().getDayMonthFormat(),\n\t\t\t\tMath.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t);\n\t\t\t/* eslint-enable */\n\t\t};\n\t\tconst sendRequest = (data) => {\n\t\t\tthis.emit('changeSprintDeadline', data);\n\t\t};\n\n\t\tconst dateStartNode = this.node.querySelector('.--start');\n\t\tconst dateEndNode = this.node.querySelector('.--end');\n\t\tconst dateStartInput = this.node.querySelector('input[name=\"dateStart\"]');\n\t\tconst dateEndInput = this.node.querySelector('input[name=\"dateEnd\"]');\n\n\t\tEvent.bind(this.node, 'click', (event) => {\n\t\t\tconst target = event.target;\n\t\t\tif (target.classList.contains('--start'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateStartInput);\n\t\t\t}\n\t\t\telse if (target.classList.contains('--end'))\n\t\t\t{\n\t\t\t\tshowCalendar(target, dateEndInput);\n\t\t\t}\n\t\t\tevent.stopPropagation();\n\t\t});\n\t\tEvent.bind(dateStartInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateStartNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateStart: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t\tEvent.bind(dateEndInput, 'change', (event) => {\n\t\t\tconst value = event.target.value;\n\t\t\tupdateDateNode(dateEndNode, value);\n\t\t\tsendRequest({\n\t\t\t\tsprintId: this.sprint.getId(),\n\t\t\t\tdateEnd: Math.floor(BX.parseDate(value).getTime() / 1000)\n\t\t\t});\n\t\t\tif (parentPopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(parentPopup, 'click', customBlur);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetWeeks()\n\t{\n\t\tconst weekCount = (parseInt(this.sprint.getDefaultSprintDuration(), 10) / 604800);\n\n\t\tif (weekCount > 5)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_3');\n\t\t}\n\t\telse if (weekCount === 1)\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn weekCount + ' ' + Loc.getMessage('TASKS_SCRUM_DATE_WEEK_NAME_2');\n\t\t}\n\t}\n\n\tstatic getFormattedTitleDatePeriod(sprint: Sprint): string\n\t{\n\t\treturn Date.getFormattedDateStart(sprint) + ' - ' + Date.getFormattedDateEnd(sprint);\n\t}\n\n\tstatic getFormattedDateStart(sprint: Sprint): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format(Culture.getInstance().getDayMonthFormat(), sprint.getDateStart(), null, true);\n\t\t/* eslint-enable */\n\t}\n\n\tstatic getFormattedDateEnd(sprint: Sprint): string\n\t{\n\t\t/* eslint-disable */\n\t\treturn BX.date.format(Culture.getInstance().getDayMonthFormat(), sprint.getDateEnd(), null, true);\n\t\t/* eslint-enable */\n\t}\n}","export class StatsCalculator\n{\n\tcalculatePercentage(first: number, second: number): number\n\t{\n\t\tif (first === 0)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (first === '')\n\t\t{\n\t\t\treturn 100;\n\t\t}\n\n\t\tconst result = Math.round(second * 100 / first);\n\n\t\treturn (isNaN(result) ? 0 : result);\n\t}\n}","import {Dom, Tag, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Sprint} from '../sprint';\n\nimport {StatsCalculator} from './stats.calculator';\n\nexport class Stats extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint.Stats');\n\n\t\tthis.setSprintData(sprint);\n\n\t\tthis.statsCalculator = new StatsCalculator();\n\n\t\tthis.node = null;\n\n\t\tthis.kanbanMode = false;\n\t}\n\n\tsetKanbanStyle()\n\t{\n\t\tthis.kanbanMode = true;\n\t}\n\n\tisKanbanMode(): boolean\n\t{\n\t\treturn this.kanbanMode;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`<div></div>`;\n\n\t\treturn this.node;\n\t}\n\n\tsetSprintData(sprint: Sprint)\n\t{\n\t\tthis.sprint = sprint;\n\n\t\tthis.setStoryPoints(sprint.getStoryPoints().getPoints());\n\t\tthis.setCompletedStoryPoints(sprint.getCompletedStoryPoints().getPoints());\n\t\tthis.setUncompletedStoryPoints(sprint.getUncompletedStoryPoints().getPoints());\n\t\tthis.setEndDate(sprint.getDateEnd());\n\n\t\tthis.weekendDaysTime = sprint.getWeekendDaysTime();\n\n\t\tif (this.node)\n\t\t{\n\t\t\tDom.replace(this.node, this.render());\n\t\t}\n\t}\n\n\tsetStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.storyPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.storyPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetStoryPoints(): number\n\t{\n\t\treturn this.storyPoints;\n\t}\n\n\tsetCompletedStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.completedStoryPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.completedStoryPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetCompletedStoryPoints(): number\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetUncompletedStoryPoints(storyPoints)\n\t{\n\t\tif (Type.isUndefined(storyPoints) || isNaN(parseFloat(storyPoints)))\n\t\t{\n\t\t\tthis.uncompletedStoryPoints = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.uncompletedStoryPoints = parseFloat(storyPoints);\n\t\t}\n\t}\n\n\tgetUncompletedStoryPoints(): number\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetEndDate(endDate)\n\t{\n\t\tif (Type.isUndefined(endDate) || isNaN(parseInt(endDate, 10)))\n\t\t{\n\t\t\tthis.endDate = (Date.now() / 1000);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.endDate = parseInt(endDate, 10);\n\t\t}\n\t}\n\n\tgetEndDate(): number\n\t{\n\t\treturn this.endDate;\n\t}\n}","import {Loc, Tag} from 'main.core';\n\nimport {Stats} from './stats';\nimport {Date as HeaderDate} from '../header/date';\nimport {Culture} from '../../../utility/culture';\n\nexport class CompletedStats extends Stats\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tconst completedDate = this.getCompletedDate(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_COMPLETED_LABEL')\n\t\t\t.replace('#percent#', percentage)\n\t\t\t.replace('#date#', completedDate)\n\t\t;\n\n\t\tconst title = HeaderDate.getFormattedTitleDatePeriod(this.sprint);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\tgetCompletedDate(endDate: number): string\n\t{\n\t\treturn BX.date.format(Culture.getInstance().getLongDateFormat(), endDate);\n\t};\n}\n","import {Loc, Tag} from 'main.core';\n\nimport {Stats} from './stats';\nimport {Date as HeaderDate} from '../header/date';\nimport {Culture} from '../../../utility/culture';\n\nexport class ExpiredStats extends Stats\n{\n\trender(): HTMLElement\n\t{\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\t\tconst expiredDay = this.getExpiredDay(this.getEndDate());\n\n\t\tconst label = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_EXPIRED_LABEL')\n\t\t\t.replace('#percent#', percentage)\n\t\t\t.replace('#date#', expiredDay)\n\t\t;\n\n\t\tconst title = HeaderDate.getFormattedTitleDatePeriod(this.sprint);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\tgetExpiredDay(endDate: number): string\n\t{\n\t\treturn BX.date.format(Culture.getInstance().getLongDateFormat(), endDate);\n\t};\n}\n","import {Loc, Tag, Type} from 'main.core';\n\nimport {Stats} from './stats';\nimport {Date as HeaderDate} from '../header/date';\n\nexport class ActiveStats extends Stats\n{\n\trender(): HTMLElement\n\t{\n\t\tconst remainingDays = this.getRemainingDays(this.getEndDate());\n\t\tconst percentage = this.statsCalculator.calculatePercentage(\n\t\t\tthis.getStoryPoints(),\n\t\t\tthis.getCompletedStoryPoints()\n\t\t);\n\n\t\tlet label = '';\n\t\tif (Type.isInteger(remainingDays) && remainingDays <= 1)\n\t\t{\n\t\t\tlabel = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LAST_LABEL')\n\t\t\t\t.replace('#percent#', percentage)\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabel = Loc.getMessage('TASKS_SCRUM_SPRINT_STATS_ACTIVE_LABEL')\n\t\t\t\t.replace('#days#', remainingDays)\n\t\t\t\t.replace('#percent#', percentage)\n\t\t\t;\n\t\t}\n\n\t\tconst title = HeaderDate.getFormattedTitleDatePeriod(this.sprint);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div title=\"${title}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\tgetRemainingDays(endDate: number): string|number\n\t{\n\t\tconst dateWithWeekendOffset = new Date();\n\t\tdateWithWeekendOffset.setSeconds(dateWithWeekendOffset.getSeconds() + this.weekendDaysTime);\n\t\tdateWithWeekendOffset.setHours(0, 0, 0, 0);\n\n\t\tconst dateEnd = new Date(endDate * 1000);\n\n\t\tconst msPerMinute = 60 * 1000;\n\t\tconst msPerHour = msPerMinute * 60;\n\t\tconst msPerDay = msPerHour * 24;\n\n\t\tconst daysRemaining = Math.round((dateEnd - dateWithWeekendOffset) / msPerDay);\n\n\t\tif (daysRemaining <= 1)\n\t\t{\n\t\t\treturn daysRemaining;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.date.format('ddiff', dateWithWeekendOffset, dateEnd);\n\t\t}\n\t};\n}\n","import {Sprint} from '../sprint';\n\nimport {Stats} from './stats';\nimport {CompletedStats} from './completed.stats';\nimport {ExpiredStats} from './expired.stats';\nimport {ActiveStats} from './active.stats';\n\nexport class StatsBuilder\n{\n\tstatic build(sprint: Sprint): Stats\n\t{\n\t\tif (sprint.isCompleted())\n\t\t{\n\t\t\treturn new CompletedStats(sprint);\n\t\t}\n\t\telse if (sprint.isExpired())\n\t\t{\n\t\t\treturn new ExpiredStats(sprint);\n\t\t}\n\t\telse if (sprint.isActive())\n\t\t{\n\t\t\treturn new ActiveStats(sprint);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn new Stats(sprint);\n\t\t}\n\t}\n}","import {Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Sprint} from '../sprint';\nimport {StatsBuilder} from '../stats/stats.builder';\n\nexport class Stats extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint.Header.Stats');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst stats = StatsBuilder.build(this.sprint);\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__content--event-params\">\n\t\t\t\t${stats.render()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n}","import {Dom, Event, Loc, Tag, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nimport {Sprint} from '../sprint';\n\nimport {Date} from './date';\nimport {Stats} from './stats';\n\nexport class Name extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint.Header.Name');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.date = null;\n\t\tthis.stats = null;\n\n\t\tthis.node = null;\n\t}\n\n\tsetDate(sprint: Sprint)\n\t{\n\t\tconst date = new Date(sprint);\n\n\t\tif (this.date)\n\t\t{\n\t\t\tDom.replace(this.date.getNode(), date.render());\n\t\t}\n\n\t\tthis.date = date;\n\n\t\tthis.date.subscribe('changeSprintDeadline', (baseEvent) => {\n\t\t\tthis.emit('changeSprintDeadline', baseEvent.getData());\n\t\t});\n\t}\n\n\tgetDate(): ?Date\n\t{\n\t\treturn this.date;\n\t}\n\n\tsetStats(sprint: Sprint)\n\t{\n\t\tconst stats = new Stats(sprint);\n\n\t\tif (this.stats)\n\t\t{\n\t\t\tDom.replace(this.stats.getNode(), stats.render());\n\t\t}\n\n\t\tthis.stats = stats;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__name-container\">\n\t\t\t\t${this.renderEditInput()}\n\t\t\t\t<div class=\"tasks-scrum__title\">\n\t\t\t\t\t${Text.encode(this.sprint.getName())}\n\t\t\t\t</div>\n\t\t\t\t${this.renderEdit()}\n\t\t\t\t${this.renderRemove()}\n\t\t\t\t${this.date ? this.date.render() : ''}\n\t\t\t\t${this.stats ? this.stats.render() : ''}\n\t\t`;\n\n\t\tconst titleNode = this.node.querySelector('.tasks-scrum__title');\n\t\tconst editNode = this.node.querySelector('.tasks-scrum__sprint--edit');\n\n\t\tEvent.bind(titleNode, 'click', () => {\n\t\t\tthis.emit('editClick', this.node.querySelector('.tasks-scrum__title-editing-input'))\n\t\t});\n\t\tEvent.bind(editNode, 'click', () => {\n\t\t\tthis.emit('editClick', this.node.querySelector('.tasks-scrum__title-editing-input'))\n\t\t});\n\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\tconst removeNode = this.node.querySelector('.tasks-scrum__sprint--remove');\n\n\t\t\tEvent.bind(removeNode, 'click', () => {\n\t\t\t\tif (this.sprint.isEmpty())\n\t\t\t\t{\n\t\t\t\t\tthis.emit('removeSprint');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tMessageBox.confirm(\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_SPRINT'),\n\t\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\t\tthis.emit('removeSprint');\n\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\trenderEditInput(): HTMLElement\n\t{\n\t\tconst uiClasses = 'ui-ctl ui-ctl-sm ui-ctl-textbox ui-ctl-underline ui-ctl-no-padding';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__title-editing ${uiClasses}\">\n\t\t\t\t<input\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclass=\"tasks-scrum__title-editing-input ui-ctl-element\"\n\t\t\t\t\tvalue=\"${Text.encode(this.sprint.getName())}\"\n\t\t\t\t>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderEdit(): ?HTMLElement\n\t{\n\t\tif (!this.sprint.isCompleted())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum__sprint--edit\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t}\n\n\trenderRemove(): ?HTMLElement\n\t{\n\t\tif (this.sprint.isPlanned())\n\t\t{\n\t\t\treturn Tag.render`<div class=\"tasks-scrum__sprint--remove\"></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t}\n}\n","import {Event, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Sprint} from '../../sprint';\n\nexport class ChartIcon extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint.Header.Info.ChartIcon');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst uiChartStyles = 'ui-btn ui-btn-xs ui-btn-light ui-btn-round';\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__sprint--btn-burn-down-chart\">\n\t\t\t\t<div class=\"tasks-scrum__sprint--icon-burn-down-chart ${uiChartStyles}\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Tag, Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Sprint} from '../../sprint';\n\nimport 'ui.hint';\n\nexport class Counters extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint.Header.Info.Counters');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__sprint--event-content\">\n\t\t\t\t<div class=\"tasks-scrum__sprint--event-container\">\n\t\t\t\t\t<div class=\"tasks-scrum__sprint--subtitle\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_TASK_LABEL')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"tasks-scrum__sprint--point\"\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_TASK_LABEL')}\" data-hint-no-icon\n\t\t\t\t\t>\n\t\t\t\t\t\t${parseInt(this.sprint.getNumberTasks(), 10)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__sprint--event-container\">\n\t\t\t\t\t<div class=\"tasks-scrum__sprint--subtitle\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_SPRINT_HEADER_STORY_POINTS')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"tasks-scrum__sprint--point\"\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_SPRINT_HEADER_STORY_POINTS')}\" data-hint-no-icon\n\t\t\t\t\t>\n\t\t\t\t\t\t${this.sprint.getStoryPoints().isEmpty() ? '-' : this.sprint.getStoryPoints().getPoints()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderAverageNumberStoryPoints()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.UI.Hint.createInstance({\n\t\t\tpopupParameters: {\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tanimation: null\n\t\t\t}\n\t\t}).init(this.node);\n\n\t\treturn this.node;\n\t}\n\n\trenderAverageNumberStoryPoints(): ?HTMLElement\n\t{\n\t\tif (\n\t\t\t!this.sprint.isPlanned()\n\t\t\t|| !this.sprint.getAverageNumberStoryPoints()\n\t\t)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div \n\t\t\t\tclass=\"tasks-scrum__sprint--point --completed\"\n\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_AVERAGE_NUMBER_STORY_POINTS')}\" data-hint-no-icon\n\t\t\t>\n\t\t\t\t${this.sprint.getAverageNumberStoryPoints()}\n\t\t\t</div>\n\t\t`;\n\t}\n}","import {Event, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Sprint} from '../../sprint';\n\nexport class Button extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint.Header.Info.Button');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst uiBtnStyles = 'ui-btn ui-btn-xs ui-btn-light ui-btn-round ui-btn-icon-add';\n\n\t\tthis.node = Tag.render`\n\t\t\t<button class=\"tasks-scrum__sprint--btn-add ${uiBtnStyles}\"></button>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Tag} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Sprint} from '../../sprint';\n\nimport {ChartIcon} from './chart.icon';\nimport {Counters} from './counters';\nimport {Button} from './button';\n\nexport class Info extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint.Header.Info');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\n\t\tthis.chartIcon = new ChartIcon(sprint);\n\t\tthis.counters = new Counters(sprint);\n\t\tthis.button = new Button(sprint);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__sprint--info\">\n\t\t\t\t${this.chartIcon.render()}\n\t\t\t\t${this.counters.render()}\n\t\t\t\t${this.button.render()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.chartIcon.subscribe('click', () => this.emit('showBurnDownChart'));\n\t\tthis.button.subscribe(\n\t\t\t'click',\n\t\t\t(baseEvent: BaseEvent) => this.emit('showCreateMenu', baseEvent.getTarget())\n\t\t);\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Event, Loc, Tag, Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Sprint} from '../sprint';\n\nexport class Button extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint.Header.Button');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.disabled = false;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.sprint.isCompleted())\n\t\t{\n\t\t\treturn this.node;\n\t\t}\n\n\t\tconst disableUiClass = (this.isAccessDenied() ? 'ui-btn-disabled' : '');\n\n\t\tthis.node = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-scrum__sprint--btn-run ${this.getUiClasses()} ${disableUiClass}\"\n\t\t\t\ttitle=\"${this.getButtonText()}\"\n\t\t\t>\n\t\t\t\t<span class=\"tasks-scrum__sprint--btn-run-text\">${this.getButtonText()}</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tonClick()\n\t{\n\t\tif (this.disabled || this.isAccessDenied())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('click');\n\t}\n\n\tgetUiClasses(): string\n\t{\n\t\treturn 'ui-btn ui-btn-sm ui-btn-primary ui-btn-round ui-btn-no-caps';\n\t}\n\n\tgetButtonText(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_SCRUM_SPRINT_HEADER_BUTTON_' + this.sprint.getStatus().toUpperCase());\n\t}\n\n\tdisable()\n\t{\n\t\tthis.disabled = true;\n\n\t\tif (this.node)\n\t\t{\n\t\t\tDom.addClass(this.node, 'ui-btn-disabled');\n\t\t}\n\t}\n\n\tunDisable()\n\t{\n\t\tthis.disabled = false;\n\n\t\tif (this.node && !this.isAccessDenied())\n\t\t{\n\t\t\tDom.removeClass(this.node, 'ui-btn-disabled');\n\t\t}\n\t}\n\n\tisAccessDenied(): boolean\n\t{\n\t\treturn (\n\t\t\tthis.sprint.isActive() && !this.sprint.canComplete()\n\t\t\t|| this.sprint.isPlanned() && !this.sprint.canStart()\n\t\t);\n\t}\n}\n","import {Dom, Event, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Sprint} from '../sprint';\n\nexport class Tick extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint.Header.Tick');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__sprint--btn-dropdown ui-btn ui-btn-sm ui-btn-icon-angle-down --up\"></div>\n\t\t`;\n\n\t\tEvent.bind(this.node, 'click', this.onClick.bind(this));\n\n\t\tif (this.sprint.isCompleted())\n\t\t{\n\t\t\tDom.removeClass(this.node, '--up');\n\t\t}\n\n\t\treturn this.node;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n\n\tupTick()\n\t{\n\t\tif (!this.node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.node, '--up');\n\t}\n\n\tdownTick()\n\t{\n\t\tif (!this.node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.node, '--up');\n\t}\n}\n","import {Tag, Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Sprint} from '../sprint';\n\nimport {Name} from './name';\nimport {Stats} from './stats';\nimport {Info} from './info/info';\nimport {Button} from './button';\nimport {Tick} from './tick';\n\nexport class Header extends EventEmitter\n{\n\tconstructor(sprint: Sprint)\n\t{\n\t\tsuper(sprint);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint.Header');\n\n\t\tthis.sprint = sprint;\n\n\t\tthis.node = null;\n\n\t\tthis.name = null;\n\t\tthis.stats = null;\n\t\tthis.info = null;\n\t\tthis.button = null;\n\t\tthis.tick = null;\n\t}\n\n\tstatic buildHeader(sprint: Sprint): Header\n\t{\n\t\tconst header = new Header(sprint);\n\n\t\theader.setName(sprint);\n\n\t\tif (sprint.isCompleted())\n\t\t{\n\t\t\theader.setStats(sprint);\n\t\t}\n\t\telse\n\t\t{\n\t\t\theader.setInfo(sprint);\n\t\t\theader.setButton(sprint);\n\t\t}\n\n\t\theader.setTick(sprint);\n\n\t\treturn header;\n\t}\n\n\tsetName(sprint: Sprint)\n\t{\n\t\tconst name = new Name(sprint);\n\n\t\tif (sprint.isPlanned())\n\t\t{\n\t\t\tname.setDate(sprint);\n\t\t}\n\n\t\tif (sprint.isActive())\n\t\t{\n\t\t\tname.setStats(sprint);\n\t\t}\n\n\t\tif (this.name)\n\t\t{\n\t\t\tDom.replace(this.name.getNode(), name.render());\n\t\t}\n\n\t\tthis.name = name;\n\n\t\tthis.name.subscribe('editClick', (baseEvent) => {\n\t\t\tthis.emit('changeName', baseEvent.getData());\n\t\t});\n\t\tthis.name.subscribe('removeSprint', () => this.emit('removeSprint'));\n\t\tthis.name.subscribe('changeSprintDeadline', (baseEvent) => {\n\t\t\tthis.emit('changeSprintDeadline', baseEvent.getData());\n\t\t});\n\t}\n\n\tgetName(): Name\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetStats(sprint: Sprint)\n\t{\n\t\tif (!sprint.isCompleted())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst stats = new Stats(sprint);\n\n\t\tif (this.stats)\n\t\t{\n\t\t\tDom.replace(this.stats.getNode(), stats.render());\n\t\t}\n\n\t\tthis.stats = stats;\n\t}\n\n\tsetInfo(sprint: Sprint)\n\t{\n\t\tconst info = new Info(sprint);\n\n\t\tif (this.info)\n\t\t{\n\t\t\tDom.replace(this.info.getNode(), info.render());\n\t\t}\n\n\t\tthis.info = info;\n\n\t\tthis.info.subscribe('showBurnDownChart', () => this.emit('showBurnDownChart'));\n\t\tthis.info.subscribe(\n\t\t\t'showCreateMenu',\n\t\t\t(baseEvent: BaseEvent) => this.emit('showCreateMenu', baseEvent.getData())\n\t\t);\n\t}\n\n\tsetButton(sprint: Sprint)\n\t{\n\t\tconst button = new Button(sprint);\n\n\t\tif (this.button)\n\t\t{\n\t\t\tDom.replace(this.button.getNode(), button.render());\n\t\t}\n\n\t\tthis.button = button;\n\n\t\tthis.button.subscribe('click', () => {\n\t\t\tif (this.sprint.isActive())\n\t\t\t{\n\t\t\t\tthis.emit('completeSprint');\n\t\t\t}\n\t\t\telse if (this.sprint.isPlanned())\n\t\t\t{\n\t\t\t\tthis.emit('startSprint');\n\t\t\t}\n\t\t});\n\t}\n\n\tsetTick(sprint: Sprint)\n\t{\n\t\tthis.tick = new Tick(sprint);\n\n\t\tthis.tick.subscribe('click', () => {\n\t\t\tthis.emit('toggleVisibilityContent');\n\t\t});\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__content-header ${this.getHeaderClass()}\">\n\t\t\t\t${this.name ? this.name.render() : ''}\n\t\t\t\t${this.stats ? this.stats.render() : ''}\n\t\t\t\t${this.info ? this.info.render() : ''}\n\t\t\t\t${this.button ? this.button.render() : ''}\n\t\t\t\t${this.tick ? this.tick.render(): ''}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.node;\n\t};\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetHeaderClass(): string\n\t{\n\t\treturn 'tasks-scrum__content-header --' + this.sprint.getStatus();\n\t}\n\n\tactivateEditMode()\n\t{\n\t\tDom.addClass(this.getNode(), '--editing');\n\t}\n\n\tdeactivateEditMode()\n\t{\n\t\tDom.removeClass(this.getNode(), '--editing');\n\t}\n\n\tupTick()\n\t{\n\t\tif (!this.tick)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tick.upTick();\n\t}\n\n\tdownTick()\n\t{\n\t\tif (!this.tick)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tick.downTick();\n\t}\n\n\tdisableButton()\n\t{\n\t\tif (this.button)\n\t\t{\n\t\t\tthis.button.disable();\n\t\t}\n\t}\n\n\tunDisableButton()\n\t{\n\t\tif (this.button)\n\t\t{\n\t\t\tthis.button.unDisable();\n\t\t}\n\t}\n}\n","import {Dom, Event, Tag, Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {Entity} from '../entity';\nimport {Blank} from '../blank';\nimport {Dropzone} from '../dropzone';\nimport {EmptySearchStub} from '../empty.search.stub';\n\nimport {Item, ItemParams} from '../../item/item';\nimport {SubTasks} from '../../item/task/sub.tasks';\n\nimport {Header} from './header/header';\n\nimport {StoryPointsStorage} from '../../utility/story.points.storage';\n\nimport type {Views} from '../../view/view';\n\nimport '../../css/sprint.css';\n\ntype SprintInfo = {\n\tsprintGoal?: string\n}\n\nexport type SprintParams = {\n\tid: number,\n\ttmpId: string,\n\tname: string,\n\tsort: number,\n\tdateStart?: number,\n\tdateEnd?: number,\n\tdateStartFormatted?: string,\n\tdateEndFormatted?: string,\n\tweekendDaysTime?: number,\n\tdefaultSprintDuration: number,\n\taverageNumberStoryPoints?: number,\n\tstoryPoints?: string,\n\tcompletedStoryPoints?: string,\n\tuncompletedStoryPoints?: string,\n\tcompletedTasks?: number,\n\tuncompletedTasks?: number,\n\tstatus?: string,\n\tnumberTasks?: number,\n\titems?: Array<ItemParams>,\n\tinfo?: SprintInfo,\n\tviews?: Views,\n\tallowedActions?: AllowedActions\n};\n\ntype AllowedActions = {\n\tstart: boolean,\n\tcomplete: boolean\n}\n\nexport class Sprint extends Entity\n{\n\tconstructor(params: SprintParams)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Sprint');\n\n\t\tthis.completedStoryPoints = new StoryPointsStorage();\n\t\tthis.uncompletedStoryPoints = new StoryPointsStorage();\n\n\t\tthis.setSprintParams(params);\n\n\t\tthis.hideCont = this.isCompleted();\n\t}\n\n\tsetSprintParams(params: SprintParams)\n\t{\n\t\tthis.setTmpId(params.tmpId);\n\t\tthis.setName(params.name);\n\t\tthis.setSort(params.sort);\n\t\tthis.setDateStart(params.dateStart);\n\t\tthis.setDateEnd(params.dateEnd);\n\t\tthis.setDateStartFormatted(params.dateStartFormatted);\n\t\tthis.setDateEndFormatted(params.dateEndFormatted);\n\t\tthis.setWeekendDaysTime(params.weekendDaysTime);\n\t\tthis.setDefaultSprintDuration(params.defaultSprintDuration);\n\t\tthis.setAverageNumberStoryPoints(params.averageNumberStoryPoints);\n\t\tthis.setStatus(params.status);\n\t\tthis.setCompletedStoryPoints(params.completedStoryPoints);\n\t\tthis.setUncompletedStoryPoints(params.uncompletedStoryPoints);\n\t\tthis.setCompletedTasks(params.completedTasks);\n\t\tthis.setUncompletedTasks(params.uncompletedTasks);\n\t\tthis.setItems(params.items);\n\t\tthis.setInfo(params.info);\n\t\tthis.setAllowedActions(params.allowedActions);\n\t}\n\n\tstatic buildSprint(params: SprintParams): Sprint\n\t{\n\t\tconst sprint = new Sprint(params);\n\n\t\tsprint.setHeader(sprint);\n\t\tif (sprint.isCompleted())\n\t\t{\n\t\t\tsprint.setBlank(sprint);\n\t\t}\n\t\tsprint.setDropzone(sprint);\n\t\tsprint.setEmptySearchStub(sprint);\n\t\tsprint.setListItems(sprint);\n\n\t\treturn sprint;\n\t}\n\n\tsetHeader(sprint: Sprint)\n\t{\n\t\tconst header = Header.buildHeader(sprint);\n\n\t\tif (this.header)\n\t\t{\n\t\t\tDom.replace(this.header.getNode(), header.render());\n\t\t}\n\n\t\tthis.header = header;\n\n\t\tthis.header.subscribe('changeName', this.onChangeName.bind(this));\n\t\tthis.header.subscribe('removeSprint', () => this.emit('removeSprint'));\n\t\tthis.header.subscribe('completeSprint', () => this.emit('completeSprint'));\n\t\tthis.header.subscribe('startSprint', () => this.emit('startSprint'));\n\t\tthis.header.subscribe('changeSprintDeadline', this.onChangeSprintDeadline.bind(this));\n\t\tthis.header.subscribe('toggleVisibilityContent', () => {\n\t\t\tthis.toggleVisibilityContent(this.getContentContainer());\n\t\t});\n\t\tthis.header.subscribe('showBurnDownChart', () => this.emit('showSprintBurnDownChart'));\n\t\tthis.header.subscribe(\n\t\t\t'showCreateMenu',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tif (this.mandatoryExists)\n\t\t\t\t{\n\t\t\t\t\tthis.emit('createSprint');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.emit('showSprintCreateMenu', baseEvent.getData());\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tsetBlank(sprint: Sprint)\n\t{\n\t\tthis.blank = new Blank(sprint);\n\t}\n\n\tsetDropzone(sprint: Sprint)\n\t{\n\t\tthis.dropzone = new Dropzone(sprint);\n\n\t\tif (this.mandatoryExists)\n\t\t{\n\t\t\tthis.dropzone.setMandatory();\n\t\t}\n\n\t\tthis.dropzone.subscribe('createTask', () => this.emit('showInput'));\n\t}\n\n\tsetEmptySearchStub(sprint: Sprint)\n\t{\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tthis.emptySearchStub = new EmptySearchStub(sprint);\n\t\t}\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn (this.getStatus() === 'active');\n\t}\n\n\tisPlanned(): boolean\n\t{\n\t\treturn (this.getStatus() === 'planned');\n\t}\n\n\tisCompleted(): boolean\n\t{\n\t\treturn (this.getStatus() === 'completed');\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn (this.isCompleted());\n\t}\n\n\tisExpired(): boolean\n\t{\n\t\tconst sprintEnd = new Date(this.dateEnd * 1000);\n\t\treturn (this.isActive() && (sprintEnd.getTime() < (new Date()).getTime()));\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn 'sprint';\n\t}\n\n\tsetItem(newItem: Item)\n\t{\n\t\tsuper.setItem(newItem);\n\n\t\tnewItem.setDisableStatus(this.isDisabled());\n\n\t\tif (newItem.getNode())\n\t\t{\n\t\t\tDom.addClass(newItem.getNode(), '--item-sprint');\n\t\t}\n\t}\n\n\tremoveItem(item: Item)\n\t{\n\t\tsuper.removeItem(item);\n\n\t\tif (this.isEmpty())\n\t\t{\n\t\t\tthis.emit('showDropzone');\n\t\t}\n\t}\n\n\tsetName(name)\n\t{\n\t\tthis.name = (Type.isString(name) ? name : '');\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.header.setName(this);\n\t\t}\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.name;\n\t}\n\n\tsetTmpId(tmpId: string)\n\t{\n\t\tthis.tmpId = (Type.isString(tmpId) ? tmpId : '');\n\t}\n\n\tgetTmpId(): string\n\t{\n\t\treturn this.tmpId;\n\t}\n\n\tsetSort(sort)\n\t{\n\t\tthis.sort = (Type.isInteger(sort) ? parseInt(sort, 10) : 1);\n\n\t\tif (this.getNode())\n\t\t{\n\t\t\tthis.getNode().dataset.sprintSort = this.sort;\n\t\t}\n\t}\n\n\tgetSort()\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetDateStart(dateStart)\n\t{\n\t\tthis.dateStart = (Type.isInteger(dateStart) ? parseInt(dateStart, 10) : 0);\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.header.setName(this);\n\t\t}\n\t}\n\n\tgetDateStart(): number\n\t{\n\t\treturn parseInt(this.dateStart, 10);\n\t}\n\n\tsetDateEnd(dateEnd)\n\t{\n\t\tthis.dateEnd = (Type.isInteger(dateEnd) ? parseInt(dateEnd, 10) : 0);\n\n\t\tif (this.isNodeCreated())\n\t\t{\n\t\t\tthis.header.setName(this);\n\t\t}\n\t}\n\n\tgetDateEnd(): number\n\t{\n\t\treturn parseInt(this.dateEnd, 10);\n\t}\n\n\tsetDateStartFormatted(dateStart)\n\t{\n\t\tthis.dateStartFormatted = (Type.isString(dateStart) ? dateStart : '');\n\t}\n\n\tgetDateStartFormatted(): string\n\t{\n\t\treturn this.dateStartFormatted;\n\t}\n\n\tsetDateEndFormatted(dateEnd)\n\t{\n\t\tthis.dateEndFormatted = (Type.isString(dateEnd) ? dateEnd : '');\n\t}\n\n\tgetDateEndFormatted(): string\n\t{\n\t\treturn this.dateEndFormatted;\n\t}\n\n\tsetWeekendDaysTime(weekendDaysTime)\n\t{\n\t\tthis.weekendDaysTime = (Type.isInteger(weekendDaysTime) ? parseInt(weekendDaysTime, 10) : 0);\n\t}\n\n\tgetWeekendDaysTime(): number\n\t{\n\t\treturn this.weekendDaysTime;\n\t}\n\n\tsetCompletedStoryPoints(completedStoryPoints)\n\t{\n\t\tthis.completedStoryPoints.setPoints(completedStoryPoints);\n\n\t\tthis.setStats();\n\t}\n\n\tgetCompletedStoryPoints(): StoryPointsStorage\n\t{\n\t\treturn this.completedStoryPoints;\n\t}\n\n\tsetUncompletedStoryPoints(uncompletedStoryPoints)\n\t{\n\t\tthis.uncompletedStoryPoints.setPoints(uncompletedStoryPoints);\n\n\t\tthis.setStats();\n\t}\n\n\tgetUncompletedStoryPoints(): StoryPointsStorage\n\t{\n\t\treturn this.uncompletedStoryPoints;\n\t}\n\n\tsetStats()\n\t{\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.setStats(this);\n\t\t\tthis.header.setName(this);\n\t\t\tthis.header.setInfo(this);\n\t\t}\n\t}\n\n\tsetItems(items)\n\t{\n\t\tif (!Type.isArray(items))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titems.forEach((itemParams: ItemParams) => {\n\t\t\tconst item = Item.buildItem(itemParams);\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t\titem.setShortView(this.getShortView());\n\t\t\tthis.items.set(item.getId(), item);\n\t\t});\n\t}\n\n\tsetInfo(info: SprintInfo)\n\t{\n\t\tthis.info = (Type.isPlainObject(info) ? info : {sprintGoal: ''});\n\t}\n\n\tsetAllowedActions(allowedActions: AllowedActions)\n\t{\n\t\tthis.allowedActions = {\n\t\t\tstart: false,\n\t\t\tcomplete: false\n\t\t};\n\n\t\tif (Type.isPlainObject(allowedActions))\n\t\t{\n\t\t\tthis.allowedActions.start = allowedActions.start === true;\n\t\t\tthis.allowedActions.complete = allowedActions.complete === true;\n\t\t}\n\t}\n\n\tcanStart(): boolean\n\t{\n\t\treturn this.allowedActions.start === true;\n\t}\n\n\tcanComplete(): boolean\n\t{\n\t\treturn this.allowedActions.complete === true;\n\t}\n\n\tsetNumberTasks(numberTasks: number)\n\t{\n\t\tsuper.setNumberTasks(numberTasks);\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.setInfo(this);\n\t\t}\n\t}\n\n\tsetCompletedTasks(completedTasks)\n\t{\n\t\tthis.completedTasks = (Type.isInteger(completedTasks) ? parseInt(completedTasks, 10) : 0);\n\t}\n\n\tgetCompletedTasks(): number\n\t{\n\t\treturn this.completedTasks;\n\t}\n\n\tsetUncompletedTasks(uncompletedTasks)\n\t{\n\t\tthis.uncompletedTasks = (Type.isInteger(uncompletedTasks) ? parseInt(uncompletedTasks, 10) : 0);\n\t}\n\n\tgetUncompletedTasks(): number\n\t{\n\t\treturn this.uncompletedTasks;\n\t}\n\n\tsetDefaultSprintDuration(defaultSprintDuration: number)\n\t{\n\t\tthis.defaultSprintDuration = (Type.isInteger(defaultSprintDuration)\n\t\t\t? parseInt(defaultSprintDuration, 10)\n\t\t\t: 0\n\t\t);\n\t}\n\n\tgetDefaultSprintDuration(): number\n\t{\n\t\treturn this.defaultSprintDuration;\n\t}\n\n\tsetAverageNumberStoryPoints(averageNumberStoryPoints: number)\n\t{\n\t\tthis.averageNumberStoryPoints = (Type.isNumber(averageNumberStoryPoints)\n\t\t\t? parseFloat(averageNumberStoryPoints)\n\t\t\t: 0\n\t\t);\n\t}\n\n\tgetAverageNumberStoryPoints(): number\n\t{\n\t\treturn this.averageNumberStoryPoints;\n\t}\n\n\tgetInfo(): SprintInfo\n\t{\n\t\treturn this.info;\n\t}\n\n\tgetUncompletedItems(): Map<string, Item>\n\t{\n\t\tconst items = new Map();\n\n\t\tthis.items.forEach((item: Item) => {\n\t\t\tif (!item.isCompleted())\n\t\t\t{\n\t\t\t\titems.set(item.getId(), item);\n\t\t\t}\n\t\t});\n\n\t\treturn items;\n\t}\n\n\tsetStatus(status)\n\t{\n\t\tconst availableStatus = new Set([\n\t\t\t'planned',\n\t\t\t'active',\n\t\t\t'completed'\n\t\t]);\n\n\t\tthis.status = (availableStatus.has(status) ? status : 'planned');\n\n\t\tthis.setHeader(this);\n\n\t\tthis.items.forEach((item) => {\n\t\t\titem.setDisableStatus(this.isDisabled());\n\t\t});\n\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\tif (this.input)\n\t\t\t{\n\t\t\t\tthis.input.removeYourself();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetStatus(): string\n\t{\n\t\treturn this.status;\n\t}\n\n\tdisableHeaderButton()\n\t{\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.disableButton();\n\t\t}\n\t}\n\n\tunDisableHeaderButton()\n\t{\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.unDisableButton();\n\t\t}\n\t}\n\n\tupdateYourself(tmpSprint: Sprint)\n\t{\n\t\tif (tmpSprint.getName() !== this.getName())\n\t\t{\n\t\t\tthis.setName(tmpSprint.getName());\n\t\t}\n\t\tif (tmpSprint.getDateStart() !== this.getDateStart())\n\t\t{\n\t\t\tthis.setDateStart(tmpSprint.getDateStart());\n\t\t}\n\t\tif (tmpSprint.getDateEnd() !== this.getDateEnd())\n\t\t{\n\t\t\tthis.setDateEnd(tmpSprint.getDateEnd());\n\t\t}\n\n\t\tthis.setStoryPoints(tmpSprint.getStoryPoints().getPoints());\n\t\tthis.setCompletedStoryPoints(tmpSprint.getCompletedStoryPoints().getPoints());\n\t\tthis.setUncompletedStoryPoints(tmpSprint.getUncompletedStoryPoints().getPoints());\n\n\t\tif (tmpSprint.getStatus() !== this.getStatus())\n\t\t{\n\t\t\tthis.setStatus(tmpSprint.getStatus());\n\t\t}\n\n\t\tif (this.node && this.header)\n\t\t{\n\t\t\tthis.setHeader(this);\n\t\t}\n\t}\n\n\tremoveYourself()\n\t{\n\t\tEvent.bind(this.node, 'transitionend', this.removeNode.bind(this));\n\n\t\t/* eslint-disable */\n\t\tthis.node.style.height = `${ this.node.scrollHeight }px`;\n\t\tthis.node.clientHeight;\n\t\tthis.node.style.height = '0';\n\t\t/* eslint-enable */\n\t}\n\n\tremoveNode()\n\t{\n\t\tDom.remove(this.node);\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst openClass = this.isCompleted() ? '' : '--open';\n\n\t\tthis.node = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-scrum__content --with-header ${openClass}\"\n\t\t\t\tdata-sprint-sort=\"${this.sort}\"\n\t\t\t\tdata-sprint-id=\"${this.getId()}\"\n\t\t\t>\n\t\t\t\t${this.header ? this.header.render() : ''}\n\t\t\t\t<div class=\"tasks-scrum__content-container\">\n\t\t\t\t\t${this.blank ? this.blank.render() : ''}\n\t\t\t\t\t${this.dropzone ? this.dropzone.render() : ''}\n\t\t\t\t\t${this.emptySearchStub ? this.emptySearchStub.render() : ''}\n\t\t\t\t\t${this.listItems ? this.listItems.render() : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(\n\t\t\tthis.getContentContainer(),\n\t\t\t'transitionend',\n\t\t\tthis.onTransitionEnd.bind(this, this.getContentContainer())\n\t\t);\n\n\t\treturn this.node;\n\t}\n\n\tonAfterAppend()\n\t{\n\t\tsuper.onAfterAppend();\n\n\t\tif (this.isEmpty() && !this.isCompleted())\n\t\t{\n\t\t\tif (this.getNumberTasks() > 0 && this.isExactSearchApplied())\n\t\t\t{\n\t\t\t\tthis.showEmptySearchStub();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showDropzone();\n\t\t\t}\n\t\t}\n\t}\n\n\tsubscribeToItem(item)\n\t{\n\t\tsuper.subscribeToItem(item);\n\n\t\titem.subscribe('showSubTasks', (baseEvent: BaseEvent) => {\n\t\t\tconst parentItem: Item = baseEvent.getTarget();\n\t\t\tconst subTasks: SubTasks = baseEvent.getData();\n\n\t\t\tif (this.isSubTaskLoadingActive())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (subTasks.isEmpty())\n\t\t\t{\n\t\t\t\tthis.subTaskLoadingActive = true;\n\n\t\t\t\tthis.emit('getSubTasks', subTasks);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.appendNodeAfterItem(subTasks.render(), parentItem.getNode());\n\n\t\t\t\tparentItem.showSubTasks();\n\t\t\t}\n\t\t});\n\n\t\titem.subscribe('updateCompletedStatus', (baseEvent: BaseEvent) => {\n\t\t\t[...this.getItems().values()].map((item: Item) => {\n\t\t\t\tif (item.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tthis.setCompletedTasks(this.getCompletedTasks() + 1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.setUncompletedTasks(this.getUncompletedTasks() - 1);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\titem.subscribe('toggleSubTasks', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('toggleSubTasks', baseEvent.getTarget());\n\t\t})\n\t}\n\n\tonChangeName(baseEvent: BaseEvent)\n\t{\n\t\tconst header: Header = baseEvent.getTarget();\n\t\tconst input: HTMLInputElement = baseEvent.getData();\n\n\t\theader.activateEditMode();\n\n\t\tconst length = input.value.length;\n\n\t\tinput.focus();\n\t\tinput.setSelectionRange(length, length);\n\n\t\tEvent.bind(input, 'keydown', (event: KeyboardEvent) => {\n\t\t\tif (event.isComposing || event.key === 'Escape' || event.key === 'Enter')\n\t\t\t{\n\t\t\t\tinput.blur();\n\n\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t}\n\t\t});\n\n\t\tEvent.bindOnce(input, 'blur', () => {\n\t\t\tif (this.getName() !== input.value)\n\t\t\t{\n\t\t\t\tthis.setName(input.value);\n\n\t\t\t\tthis.emit('changeSprintName', {\n\t\t\t\t\tsprintId: this.getId(),\n\t\t\t\t\tname: this.getName()\n\t\t\t\t});\n\t\t\t}\n\n\t\t\theader.deactivateEditMode();\n\t\t});\n\t}\n\n\tonChangeSprintDeadline(baseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\n\t\tthis.emit('changeSprintDeadline', requestData);\n\n\t\tif (requestData.hasOwnProperty('dateStart'))\n\t\t{\n\t\t\tthis.dateStart = parseInt(requestData.dateStart, 10);\n\t\t}\n\t\telse if (requestData.hasOwnProperty('dateEnd'))\n\t\t{\n\t\t\tthis.dateEnd = parseInt(requestData.dateEnd, 10);\n\t\t}\n\t}\n\n\tonTransitionEnd(node: HTMLElement)\n\t{\n\t\tif (Dom.style(node, 'height') !== '0px')\n\t\t{\n\t\t\tDom.style(node, 'height', 'auto');\n\t\t}\n\n\t\tthis.emit('toggleVisibilityContent');\n\t}\n\n\ttoggleVisibilityContent(node: HTMLElement)\n\t{\n\t\tif (this.isHideContent())\n\t\t{\n\t\t\tthis.showContent(node);\n\n\t\t\tDom.addClass(this.node, '--open');\n\n\t\t\tif (this.isCompleted())\n\t\t\t{\n\t\t\t\tif (this.getItems().size === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.emit('getSprintCompletedItems');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideContent(node);\n\n\t\t\tDom.removeClass(this.node, '--open');\n\t\t}\n\t}\n\n\tshowContent(node: HTMLElement)\n\t{\n\t\tthis.hideCont = false;\n\n\t\tif (node)\n\t\t{\n\t\t\tDom.style(node, 'height', `${ node.scrollHeight }px`);\n\t\t}\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.upTick();\n\t\t}\n\t}\n\n\thideContent(node?: HTMLElement)\n\t{\n\t\tthis.hideCont = true;\n\n\t\tif (node)\n\t\t{\n\t\t\t/* eslint-disable */\n\t\t\tnode.style.height = `${ node.scrollHeight }px`;\n\t\t\tnode.clientHeight;\n\t\t\tnode.style.height = '0';\n\t\t\t/* eslint-enable */\n\t\t}\n\n\t\tif (this.header)\n\t\t{\n\t\t\tthis.header.downTick();\n\t\t}\n\t}\n\n\tisHideContent(): boolean\n\t{\n\t\treturn this.hideCont;\n\t}\n\n\tshowSprint()\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tDom.style(this.node, 'display', 'block');\n\t\t}\n\t}\n\n\thideSprint()\n\t{\n\t\tif (this.node)\n\t\t{\n\t\t\tDom.style(this.node, 'display', 'none');\n\t\t}\n\t}\n\n\tgetContentContainer(): HTMLElement\n\t{\n\t\treturn this.node.querySelector('.tasks-scrum__content-container');\n\t}\n\n\tfadeOut()\n\t{\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tsuper.fadeOut();\n\t\t}\n\t}\n\n\tfadeIn()\n\t{\n\t\tif (!this.isCompleted())\n\t\t{\n\t\t\tsuper.fadeIn();\n\t\t}\n\t}\n\n\tdeactivateSubTaskLoading(item: Item)\n\t{\n\t\tthis.subTaskLoadingActive = false;\n\n\t\titem.unDisableToggle();\n\t}\n\n\tisSubTaskLoadingActive(): boolean\n\t{\n\t\treturn this.subTaskLoadingActive === true;\n\t}\n}\n\n","import {Type} from 'main.core';\n\nimport {Entity} from './entity';\nimport {Backlog} from './backlog/backlog';\nimport {Sprint} from './sprint/sprint';\n\nexport class EntityStorage\n{\n\tconstructor()\n\t{\n\t\tthis.backlog = null;\n\t\tthis.sprints = new Map();\n\t\tthis.filteredCompletedSprints = new Map();\n\t}\n\n\taddBacklog(backlog: Backlog)\n\t{\n\t\tif (!(backlog instanceof Backlog))\n\t\t{\n\t\t\tthrow new Error('EntityStorage: Backlog is in wrong format');\n\t\t}\n\n\t\tthis.backlog = backlog;\n\t}\n\n\taddSprint(sprint: Sprint)\n\t{\n\t\tthis.sprints.set(sprint.getId(), sprint);\n\t}\n\n\taddFilteredCompletedSprint(sprint: Sprint)\n\t{\n\t\tthis.filteredCompletedSprints.set(sprint.getId(), sprint);\n\t}\n\n\tclearFilteredCompletedSprints()\n\t{\n\t\tthis.filteredCompletedSprints.clear();\n\t}\n\n\tremoveSprint(sprintId: number)\n\t{\n\t\tthis.sprints.delete(sprintId);\n\t}\n\n\tgetBacklog(): Backlog\n\t{\n\t\tif (this.backlog === null)\n\t\t{\n\t\t\tthrow new Error('EntityStorage: Backlog not found');\n\t\t}\n\n\t\treturn this.backlog;\n\t}\n\n\tgetSprints(): Map<number, Sprint>\n\t{\n\t\treturn this.sprints;\n\t}\n\n\tgetActiveSprint(): ?Sprint\n\t{\n\t\treturn [...this.sprints.values()].find((sprint: Sprint) => sprint.isActive());\n\t}\n\n\tgetPlannedSprints(): Set<Sprint>\n\t{\n\t\tconst sprints = new Set();\n\n\t\tthis.sprints.forEach((sprint: Sprint) => {\n\t\t\tif (sprint.isPlanned())\n\t\t\t{\n\t\t\t\tsprints.add(sprint);\n\t\t\t}\n\t\t});\n\n\t\treturn sprints;\n\t}\n\n\tgetFilteredCompletedSprints(): Set<Sprint>\n\t{\n\t\tconst sprints = new Set();\n\n\t\tthis.sprints.forEach((sprint: Sprint) => {\n\t\t\tif (sprint.isCompleted() && !sprint.isEmpty())\n\t\t\t{\n\t\t\t\tsprints.add(sprint);\n\t\t\t}\n\t\t});\n\n\t\treturn sprints;\n\t}\n\n\tgetSprintsAvailableForFilling(entityFrom: Entity): Set<Sprint>\n\t{\n\t\tconst sprints = new Set();\n\n\t\tthis.sprints.forEach((sprint: Sprint) => {\n\t\t\tif (!sprint.isCompleted() && entityFrom.getId() !== sprint.getId())\n\t\t\t{\n\t\t\t\tsprints.add(sprint);\n\t\t\t}\n\t\t});\n\n\t\treturn sprints;\n\t}\n\n\texistCompletedSprint(): boolean\n\t{\n\t\treturn !Type.isUndefined([...this.sprints.values()].find((sprint) => sprint.isCompleted()));\n\t}\n\n\tgetAllEntities(): Map<number, Entity>\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(this.backlog.getId(), this.backlog);\n\n\t\t[...this.sprints.values()].map((sprint) => entities.set(sprint.getId(), sprint));\n\n\t\treturn entities;\n\t}\n\n\tgetAllItems(): Map<number, Item>\n\t{\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\tconst activeSprint = this.getActiveSprint();\n\n\t\tif (activeSprint)\n\t\t{\n\t\t\titems = new Map([...items, ...activeSprint.getItems()]);\n\t\t}\n\n\t\t[...this.getPlannedSprints().values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn items;\n\t}\n\n\texistsAtLeastOneItem(): boolean\n\t{\n\t\tif (this.backlog.getNumberTasks() > 0)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst filledSprint = [...this.sprints.values()].find((sprint: Sprint) => sprint.getNumberTasks() > 0);\n\n\t\treturn !Type.isUndefined(filledSprint);\n\t}\n\n\trecalculateItemsSort()\n\t{\n\t\tthis.backlog.recalculateItemsSort();\n\t\tthis.sprints.forEach((sprint) => sprint.recalculateItemsSort());\n\t}\n\n\tfindEntityByEntityId(entityId: number): ?Entity\n\t{\n\t\tentityId = parseInt(entityId, 10);\n\n\t\tif (this.backlog.getId() === entityId)\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === entityId);\n\t}\n\n\tfindItemByItemId(itemId: number): ?Item\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn backlogItems.get(itemId);\n\t\t}\n\n\t\tconst sprint = [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t\tif (sprint)\n\t\t{\n\t\t\treturn sprint.getItems().get(itemId);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindItemBySourceId(sourceId: number): ?Item\n\t{\n\t\tsourceId = parseInt(sourceId, 10);\n\n\t\tlet items = new Map(this.backlog.getItems());\n\n\t\t[...this.sprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn [...items.values()].find((item: Item) => item.getSourceId() === sourceId);\n\t}\n\n\tfindItemBySourceInFilteredCompletedSprints(sourceId: number): ?Item\n\t{\n\t\tlet items = new Map();\n\n\t\t[...this.filteredCompletedSprints.values()].map((sprint) => items = new Map([...items, ...sprint.getItems()]));\n\n\t\treturn [...items.values()].find((item: Item) => item.getSourceId() === sourceId);\n\t}\n\n\tfindEntityByItemId(itemId: number): Entity\n\t{\n\t\titemId = parseInt(itemId, 10);\n\n\t\tconst backlogItems = this.backlog.getItems();\n\t\tif (backlogItems.has(itemId))\n\t\t{\n\t\t\treturn this.backlog;\n\t\t}\n\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getItems().has(itemId));\n\t}\n}","import {Dom} from 'main.core';\n\nimport {PlanBuilder} from '../view/plan/plan.builder';\n\nimport {EntityStorage} from '../entity/entity.storage';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\ntype Params = {\n\tplanBuilder: PlanBuilder,\n\tentityStorage: EntityStorage\n}\n\nexport class Scroller\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.planBuilder = params.planBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t}\n\n\tscrollToItem(item: Item)\n\t{\n\t\tif (this.isItemInViewport(item))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst offset = 112;\n\n\t\tif (this.isBacklogItem(item))\n\t\t{\n\t\t\tconst scrollContainer = this.entityStorage.getBacklog().getListItemsNode();\n\n\t\t\tconst itemTopPosition = Dom.getRelativePosition(item.getNode(), scrollContainer).top;\n\n\t\t\tscrollContainer.scrollTo({\n\t\t\t\ttop: scrollContainer.scrollTop + itemTopPosition - offset,\n\t\t\t\tbehavior: 'smooth'\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst sprintsContainer = this.planBuilder.getSprintsContainer()\n\n\t\t\tconst itemTopPosition = Dom.getRelativePosition(item.getNode(), sprintsContainer).top;\n\n\t\t\tsprintsContainer.scrollTo({\n\t\t\t\ttop: sprintsContainer.scrollTop + itemTopPosition - offset,\n\t\t\t\tbehavior: 'smooth'\n\t\t\t});\n\t\t}\n\t}\n\n\tscrollToSprint(sprint: Sprint)\n\t{\n\t\twindow.scrollTo({ top: 240, behavior: 'smooth' });\n\n\t\t// todo dynamic focus to sprint node (loadItems)\n\n\t\tconst offset = 80;\n\n\t\tconst sprintsContainer = this.planBuilder.getSprintsContainer();\n\t\tconst position = Dom.getRelativePosition(sprint.getNode(), sprintsContainer).top;\n\n\t\tsprintsContainer.scrollTo({\n\t\t\ttop: sprintsContainer.scrollTop + position - offset,\n\t\t\tbehavior: 'smooth'\n\t\t});\n\t}\n\n\tisItemInViewport(item: Item): boolean\n\t{\n\t\tconst rect = item.getNode().getBoundingClientRect();\n\n\t\treturn (\n\t\t\trect.top >= 0\n\t\t\t&& rect.left >= 0\n\t\t\t&& rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)\n\t\t\t&& rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t);\n\t}\n\n\tisBacklogItem(item: Item): boolean\n\t{\n\t\treturn this.entityStorage.getBacklog().hasItem(item);\n\t}\n}","import {Event, Loc, Tag, Type, Dom} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {EventEmitter} from 'main.core.events';\n\nimport 'main.polyfill.intersectionobserver';\n\nimport {EntityStorage} from '../../entity/entity.storage';\nimport {Sprint, SprintParams} from '../../entity/sprint/sprint';\n\nimport {RequestSender} from '../../utility/request.sender';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tpageNumber: number,\n\tisShortView: 'Y' | 'N'\n}\n\ntype Stats = {\n\tnumberSprints: number,\n\taverageNumberTasks: number,\n\taverageNumberStoryPoints: number,\n\taveragePercentageCompletion: number\n}\n\nimport '../../css/completed.sprints.css';\n\nexport class CompletedSprints extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.CompletedSprints');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.pageNumber = parseInt(params.pageNumber, 10);\n\t\tthis.isShortView = params.isShortView;\n\n\t\tthis.statsUploaded = false;\n\t\tthis.sprintsUploaded = false;\n\n\t\tthis.loader = null;\n\n\t\tthis.isActiveLoad = false;\n\n\t\tthis.node = null;\n\t\tthis.header = null;\n\t\tthis.filteredSprintsNode = null;\n\t\tthis.listNode = null;\n\t\tthis.emptySearchStub = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__content\">\n\t\t\t\t<div class=\"tasks-scrum__sprints--completed\">\n\t\t\t\t\t<div class=\"tasks-scrum__sprints--completed-title\">\n\t\t\t\t\t\t<span class=\"tasks-scrum__sprints--completed-title-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_COMPLETED_SPRINTS_TITLE')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__content-empty --no-results\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_EMPTY_SEARCH_STUB_COMPLETED')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__sprints--filtered-sprints\"></div>\n\t\t\t\t\t${this.renderHeader()}\n\t\t\t\t\t${this.renderList()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.filteredSprintsNode = this.node.querySelector('.tasks-scrum__sprints--filtered-sprints');\n\t\tthis.listNode = this.node.querySelector('.tasks-scrum__sprints--completed-list');\n\n\t\tthis.emptySearchStub = this.node.querySelector('.tasks-scrum__content-empty');\n\n\t\tEvent.bind(this.listNode, 'transitionend', this.onTransitionEnd.bind(this));\n\n\t\tconst observerTargetNode = this.listNode.querySelector('.tasks-scrum-completed-sprints-observer-target');\n\n\t\tthis.bindLoad(observerTargetNode);\n\n\t\treturn this.node;\n\t}\n\n\tshowEmptySearchStub(): void\n\t{\n\t\tDom.addClass(this.emptySearchStub, '--open');\n\n\t\tthis.hideFilteredHeader();\n\t}\n\n\thideEmptySearchStub(): void\n\t{\n\t\tDom.removeClass(this.emptySearchStub, '--open');\n\n\t\tthis.showHeader();\n\t}\n\n\trenderHeader(): HTMLElement\n\t{\n\t\tconst btnStyles = 'tasks-scrum__sprint--btn-dropdown ui-btn ui-btn-sm ui-btn-icon-angle-down';\n\n\t\tthis.header = Tag.render`\n\t\t\t<div class=\"tasks-scrum__sprints--completed-header\">\n\t\t\t\t<div class=\"tasks-scrum__sprints--completed-name\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_COMPLETED_SPRINTS_NAME')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__sprints--completed-stats\"></div>\n\t\t\t\t<div class=\"tasks-scrum__sprints--completed-btn ${btnStyles}\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst btnNode = this.header.querySelector('.tasks-scrum__sprints--completed-btn');\n\t\tEvent.bind(btnNode, 'click', this.onBtnClick.bind(this));\n\n\t\treturn this.header;\n\t}\n\n\tonBtnClick(event)\n\t{\n\t\tconst node = event.currentTarget;\n\n\t\tconst isShown = Dom.hasClass(node, '--up');\n\n\t\tif (isShown)\n\t\t{\n\t\t\tDom.removeClass(node, '--up');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(node, '--up');\n\n\t\t\tDom.addClass(this.listNode, '--visible');\n\n\t\t\tif (!this.isSprintsUploaded() && Type.isNull(this.loader))\n\t\t\t{\n\t\t\t\tthis.loader = this.showLoader();\n\t\t\t}\n\t\t}\n\n\t\tif (isShown)\n\t\t{\n\t\t\tthis.hideList();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showList();\n\t\t}\n\n\t\tthis.onLoadStats();\n\t}\n\n\trenderList(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__sprints--completed-list\">\n\t\t\t\t${this.renderObserverTarget()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderObserverTarget(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class=\"tasks-scrum-completed-sprints-observer-target\"></div>`;\n\t}\n\n\trenderStats(stats: Stats): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_COMPLETED_SPRINTS_STATS')\n\t\t\t\t\t.replace('#tasks#', parseInt(stats.averageNumberTasks, 10))\n\t\t\t\t\t.replace('#storypoints#', parseInt(stats.averageNumberStoryPoints, 10))\n\t\t\t\t\t.replace('#percent#', parseInt(stats.averagePercentageCompletion, 10))\n\t\t\t\t}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tisSprintsUploaded(): boolean\n\t{\n\t\treturn this.sprintsUploaded;\n\t}\n\n\tbindLoad(loader: HTMLElement)\n\t{\n\t\tif (Type.isUndefined(IntersectionObserver))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst observer = new IntersectionObserver((entries) =>\n\t\t\t{\n\t\t\t\tif(entries[0].isIntersecting === true)\n\t\t\t\t{\n\t\t\t\t\tif (!this.isActiveLoad)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onLoadCompletedSprints();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tthreshold: [0]\n\t\t\t}\n\t\t);\n\n\t\tobserver.observe(loader);\n\t}\n\n\tonLoadStats()\n\t{\n\t\tif (this.statsUploaded)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.statsUploaded = true;\n\n\t\tthis.requestSender.getCompletedSprintsStats()\n\t\t\t.then((response) => {\n\t\t\t\tthis.updateStats(response.data);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.statsUploaded = false;\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonLoadCompletedSprints()\n\t{\n\t\tthis.isActiveLoad = true;\n\n\t\tif (this.isSprintsUploaded() && Type.isNull(this.loader))\n\t\t{\n\t\t\tthis.loader = this.showLoader();\n\t\t}\n\n\t\tconst requestData = {\n\t\t\tpageNumber: this.pageNumber\n\t\t};\n\n\t\tthis.requestSender.getCompletedSprints(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tconst data = response.data;\n\t\t\t\tif (Type.isArray(data) && data.length)\n\t\t\t\t{\n\t\t\t\t\tthis.pageNumber++;\n\n\t\t\t\t\tthis.createSprints(data);\n\n\t\t\t\t\tthis.isActiveLoad = false;\n\n\t\t\t\t\tthis.showList();\n\t\t\t\t}\n\t\t\t\tthis.sprintsUploaded = true;\n\t\t\t\tif (this.loader)\n\t\t\t\t{\n\t\t\t\t\tthis.loader.hide();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tif (this.loader)\n\t\t\t\t{\n\t\t\t\t\tthis.loader.hide();\n\t\t\t\t}\n\t\t\t\tthis.isActiveLoad = false;\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tshowLoader(): Loader\n\t{\n\t\tconst listPosition = Dom.getPosition(this.listNode);\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.listNode,\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\treturn loader;\n\t}\n\n\tupdateStats(stats: Stats)\n\t{\n\t\tconst nameNode = this.node.querySelector('.tasks-scrum__sprints--completed-name');\n\t\tconst statsHeaderNode = this.node.querySelector('.tasks-scrum__sprints--completed-stats');\n\n\t\tnameNode.textContent = nameNode.textContent + '- ' + parseInt(stats.numberSprints, 10);\n\n\t\tDom.append(this.renderStats(stats), statsHeaderNode);\n\t}\n\n\tcreateSprints(sprints: Array)\n\t{\n\t\tsprints.forEach((sprintData: SprintParams) => {\n\t\t\tsprintData.isShortView = 'Y';\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\n\t\t\tthis.entityStorage.addSprint(sprint);\n\n\t\t\tDom.insertBefore(\n\t\t\t\tsprint.render(),\n\t\t\t\tthis.listNode.querySelector('.tasks-scrum-completed-sprints-observer-target')\n\t\t\t);\n\t\t\tsprint.onAfterAppend();\n\n\t\t\tthis.emit('createSprint', sprint);\n\t\t});\n\t}\n\n\taddSprint(sprint: Sprint)\n\t{\n\t\tthis.entityStorage.addSprint(sprint);\n\n\t\tDom.insertBefore(sprint.render(), this.listNode.firstElementChild);\n\n\t\tsprint.onAfterAppend();\n\n\t\tthis.emit('createSprint', sprint);\n\t}\n\n\tshowFilteredSprints(completedSprints: Map<Sprint>)\n\t{\n\t\tif (Type.isNull(this.filteredSprintsNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this.filteredSprintsNode);\n\n\t\tcompletedSprints\n\t\t\t.forEach((sprint: Sprint) => {\n\t\t\t\tDom.append(sprint.render(), this.filteredSprintsNode);\n\t\t\t\tsprint.onAfterAppend();\n\t\t\t\tthis.emit('createSprint', sprint);\n\t\t\t\tthis.entityStorage.addFilteredCompletedSprint(sprint);\n\t\t\t\tsetTimeout(() => sprint.toggleVisibilityContent(sprint.getContentContainer()), 100);\n\t\t\t})\n\t\t;\n\n\t\tthis.hideFilteredHeader();\n\t}\n\n\thideFilteredSprints()\n\t{\n\t\tDom.clean(this.filteredSprintsNode);\n\n\t\tthis.entityStorage.clearFilteredCompletedSprints();\n\n\t\tthis.showHeader();\n\t}\n\n\thideFilteredHeader()\n\t{\n\t\tthis.hideHeader();\n\t\tthis.hideList();\n\n\t\tDom.removeClass(this.header.querySelector('.tasks-scrum__sprints--completed-btn'), '--up');\n\t}\n\n\tshowHeader()\n\t{\n\t\tif (Type.isNull(this.header))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.header, '--hide');\n\t}\n\n\thideHeader()\n\t{\n\t\tif (Type.isNull(this.header))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.header, '--hide');\n\t}\n\n\tshowList()\n\t{\n\t\tconst parentNode = this.node.querySelector('.tasks-scrum__sprints--completed');\n\n\t\tDom.addClass(parentNode, '--open');\n\n\t\tDom.style(this.listNode, 'height', `${ this.listNode.scrollHeight }px`);\n\n\t\tthis.emit('adjustWidth');\n\t}\n\n\thideList()\n\t{\n\t\tconst parentNode = this.node.querySelector('.tasks-scrum__sprints--completed');\n\n\t\tDom.removeClass(parentNode, '--open');\n\n\t\t/* eslint-disable */\n\t\tthis.listNode.style.height = `${ this.listNode.scrollHeight }px`;\n\t\tthis.listNode.clientHeight;\n\t\tthis.listNode.style.height = '0';\n\t\t/* eslint-enable */\n\t}\n\n\tonTransitionEnd()\n\t{\n\t\tconst isHide = (Dom.style(this.listNode, 'height') === '0px');\n\n\t\tif (isHide)\n\t\t{\n\t\t\tDom.removeClass(this.listNode, '--visible');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.listNode, 'height', 'auto');\n\t\t}\n\n\t\tthis.emit('adjustWidth');\n\t}\n}","import {Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {EntityStorage} from '../../entity/entity.storage';\nimport {Sprint, SprintParams} from '../../entity/sprint/sprint';\n\nimport {RequestSender} from '../../utility/request.sender';\nimport {Scroller} from '../../utility/scroller';\n\nimport {CompletedSprints} from './completed.sprints';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tdefaultSprintDuration: number,\n\tpageNumberToCompletedSprints: number,\n\tdisplayPriority: string,\n\tisShortView: 'Y' | 'N',\n\tmandatoryExists: 'Y' | 'N',\n\tisExactSearchApplied: 'Y' | 'N'\n}\n\nexport class PlanBuilder extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.DomBuilder');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.defaultSprintDuration = params.defaultSprintDuration;\n\t\tthis.pageNumberToCompletedSprints = params.pageNumberToCompletedSprints;\n\t\tthis.displayPriority = params.displayPriority;\n\t\tthis.isShortView = params.isShortView;\n\t\tthis.mandatoryExists = params.mandatoryExists;\n\t\tthis.isExactSearchApplied = params.isExactSearchApplied === 'Y';\n\n\t\tthis.scroller = new Scroller({\n\t\t\tplanBuilder: this,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tthis.scrumContainer = container;\n\n\t\tthis.setWidthPriority(this.displayPriority);\n\n\t\tDom.append(this.entityStorage.getBacklog().render(), this.scrumContainer);\n\t\tthis.entityStorage.getBacklog().onAfterAppend();\n\n\t\tDom.append(this.renderSprintsContainer(), this.scrumContainer);\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tif (!sprint.isCompleted())\n\t\t\t{\n\t\t\t\tsprint.onAfterAppend();\n\t\t\t}\n\t\t});\n\n\t\tthis.emit('setDraggable');\n\n\t\tthis.adjustSprintListWidth();\n\t}\n\n\trenderSprintsContainer(): HTMLElement\n\t{\n\t\tthis.completedSprints = new CompletedSprints({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tpageNumber: this.pageNumberToCompletedSprints,\n\t\t\tisShortView: this.isShortView\n\t\t});\n\t\tthis.completedSprints.subscribe('createSprint', (baseEvent: BaseEvent) => {\n\t\t\tthis.emit('createSprint', baseEvent.getData());\n\t\t});\n\t\tthis.completedSprints.subscribe('adjustWidth', () => this.adjustSprintListWidth());\n\n\t\tconst activeSprint = this.entityStorage.getActiveSprint();\n\t\tconst plannedSprints = this.entityStorage.getPlannedSprints();\n\n\t\tthis.sprintsNode = Tag.render`\n\t\t\t<div class=\"tasks-scrum__sprints --scrollbar\">\n\t\t\t\t<div class=\"tasks-scrum__sprints--active ${activeSprint ? '' : '--empty'}\">\n\t\t\t\t\t${activeSprint ? activeSprint.render() : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__sprints--planned ${plannedSprints.size ? '' : '--empty'}\">\n\t\t\t\t\t${[...plannedSprints.values()].map((sprint) => sprint.render())}\n\t\t\t\t</div>\n\t\t\t\t${this.renderSprintDropzone()}\n\t\t\t\t${this.entityStorage.existCompletedSprint() ? this.completedSprints.render() : ''}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.updatePlannedSprints(plannedSprints, !Type.isUndefined(activeSprint));\n\n\t\tif (this.isExactSearchApplied)\n\t\t{\n\t\t\tconst filteredCompletedSprints = this.entityStorage.getFilteredCompletedSprints();\n\t\t\tif (filteredCompletedSprints.size)\n\t\t\t{\n\t\t\t\tthis.showFilteredCompletedSprints(filteredCompletedSprints);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showEmptySearchStub();\n\t\t\t}\n\t\t}\n\n\t\tEvent.bind(this.sprintsNode, 'scroll', this.onSprintsScroll.bind(this));\n\n\t\treturn this.sprintsNode;\n\t}\n\n\trenderSprintDropzone(): HTMLElement\n\t{\n\t\tthis.sprintDropzone = Tag.render`\n\t\t\t<div class=\"tasks-scrum__content\">\n\t\t\t\t<div class=\"tasks-scrum__sprints--new-sprint\">\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_PLAN_SPRINT_DROPZONE')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.sprintDropzone, 'click', this.createSprint.bind(this));\n\n\t\treturn this.sprintDropzone;\n\t}\n\n\tsetWidthPriority(value: string)\n\t{\n\t\tif (value === 'backlog')\n\t\t{\n\t\t\tDom.addClass(this.scrumContainer, '--width-priority-backlog');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.scrumContainer, '--width-priority-backlog');\n\t\t}\n\t}\n\n\tsetShortView(value: 'Y' | 'N')\n\t{\n\t\tthis.isShortView = value;\n\t}\n\n\tgetSprintsContainer(): HTMLElement\n\t{\n\t\treturn this.sprintsNode;\n\t}\n\n\tgetSprintDropzone(): HTMLElement\n\t{\n\t\treturn this.sprintDropzone;\n\t}\n\n\tisSprintDropzone(container: HTMLElement): boolean\n\t{\n\t\tif (container.firstElementChild)\n\t\t{\n\t\t\treturn Dom.hasClass(container.firstElementChild, 'tasks-scrum__sprints--new-sprint');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tcreateSprint(): Promise\n\t{\n\t\tconst dateStart = Math.floor(Date.now() / 1000);\n\t\tconst dateEnd = (Math.floor(Date.now() / 1000) + parseInt(this.defaultSprintDuration, 10));\n\t\tconst sort = this.entityStorage.getPlannedSprints().size + 1;\n\n\t\tconst requestData = {\n\t\t\ttmpId: Text.getRandom(),\n\t\t\tsort: sort + 1,\n\t\t\tdateStart: dateStart,\n\t\t\tdateEnd: dateEnd\n\t\t};\n\n\t\tthis.emit('beforeCreateSprint', requestData);\n\n\t\treturn this.requestSender.createSprint(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tconst sprintParams: SprintParams = response.data;\n\t\t\t\tsprintParams.isShortView = this.isShortView;\n\t\t\t\tsprintParams.mandatoryExists = this.mandatoryExists;\n\t\t\t\tsprintParams.isExactSearchApplied = this.isExactSearchApplied ? 'Y' : 'N';\n\n\t\t\t\tconst sprint = Sprint.buildSprint(sprintParams);\n\n\t\t\t\tthis.entityStorage.addSprint(sprint);\n\n\t\t\t\tthis.appendToPlannedContainer(sprint);\n\n\t\t\t\tthis.scroller.scrollToSprint(sprint);\n\n\t\t\t\tthis.emit('createSprint', sprint);\n\n\t\t\t\treturn sprint;\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tcreateSprintNode(sprint: Sprint)\n\t{\n\t\tsprint.setShortView(this.isShortView);\n\t\tsprint.setMandatory(this.mandatoryExists);\n\n\t\tthis.entityStorage.addSprint(sprint);\n\n\t\tthis.appendToPlannedContainer(sprint);\n\n\t\tthis.emit('createSprintNode', sprint);\n\t}\n\n\tappendToPlannedContainer(sprint: Sprint)\n\t{\n\t\tconst container = this.getSprintsContainer().querySelector('.tasks-scrum__sprints--planned');\n\n\t\tDom.append(sprint.render(), container);\n\n\t\tDom.removeClass(container, '--empty');\n\n\t\tsprint.onAfterAppend();\n\n\t\tthis.adjustSprintListWidth();\n\n\t\tthis.updatePlannedSprints(\n\t\t\tthis.entityStorage.getPlannedSprints(),\n\t\t\t!Type.isUndefined(this.entityStorage.getActiveSprint())\n\t\t);\n\t}\n\n\tmoveSprintToActiveListNode(sprint: Sprint)\n\t{\n\t\tconst container = this.getSprintsContainer().querySelector('.tasks-scrum__sprints--active');\n\n\t\tDom.append(sprint.getNode(), container);\n\n\t\tDom.removeClass(container, '--empty');\n\t}\n\n\tmoveSprintToCompletedListNode(sprint: Sprint)\n\t{\n\t\tsprint.removeNode();\n\n\t\tthis.entityStorage.removeSprint(sprint.getId());\n\n\t\tif (this.completedSprints.isSprintsUploaded())\n\t\t{\n\t\t\tthis.completedSprints.addSprint(sprint);\n\t\t}\n\n\t\tthis.adjustSprintListWidth();\n\t}\n\n\tappendItemAfterItem(newItemNode: HTMLElement, bindItemNode: HTMLElement)\n\t{\n\t\tif (bindItemNode.nextElementSibling)\n\t\t{\n\t\t\tDom.insertBefore(newItemNode, bindItemNode.nextElementSibling);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(newItemNode, bindItemNode.parentElement);\n\t\t}\n\t}\n\n\tonSprintsScroll()\n\t{\n\t\tthis.emit('sprintsScroll');\n\t}\n\n\tadjustSprintListWidth()\n\t{\n\t\tthis.updateSprintContainers();\n\n\t\tconst hasScroll = this.getSprintsContainer().scrollHeight > this.getSprintsContainer().clientHeight;\n\n\t\tif (hasScroll)\n\t\t{\n\t\t\tDom.addClass(this.getSprintsContainer(), '--scrollbar');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.getSprintsContainer(), '--scrollbar');\n\t\t}\n\t}\n\n\tupdateSprintContainers()\n\t{\n\t\tconst activeSprint = this.entityStorage.getActiveSprint();\n\t\tconst activeContainer = this.getSprintsContainer().querySelector('.tasks-scrum__sprints--active');\n\t\tif (activeSprint)\n\t\t{\n\t\t\tDom.removeClass(activeContainer, '--empty');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(activeContainer, '--empty');\n\t\t}\n\n\t\tconst plannedSprints = this.entityStorage.getPlannedSprints();\n\t\tconst plannedContainer = this.getSprintsContainer().querySelector('.tasks-scrum__sprints--planned');\n\t\tif (plannedSprints.size)\n\t\t{\n\t\t\tDom.removeClass(plannedContainer, '--empty');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(plannedContainer, '--empty');\n\t\t}\n\t}\n\n\tupdatePlannedSprints(plannedSprints: Set<Sprint>, existActiveSprint: boolean)\n\t{\n\t\tif (existActiveSprint)\n\t\t{\n\t\t\tplannedSprints.forEach((plannedSprint: Sprint) => {\n\t\t\t\tplannedSprint.disableHeaderButton();\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tplannedSprints.forEach((plannedSprint: Sprint) => {\n\t\t\t\tplannedSprint.unDisableHeaderButton();\n\t\t\t});\n\t\t}\n\t}\n\n\tgetScrumContainer(): HTMLElement\n\t{\n\t\treturn this.scrumContainer;\n\t}\n\n\tblockScrumContainerSelect()\n\t{\n\t\tDom.addClass(this.scrumContainer, '--select-none');\n\t}\n\n\tunblockScrumContainerSelect()\n\t{\n\t\tsetTimeout(() => {\n\t\t\tDom.removeClass(this.scrumContainer, '--select-none');\n\t\t}, 500);\n\t}\n\n\tshowEmptySearchStub()\n\t{\n\t\tif (this.entityStorage.existCompletedSprint())\n\t\t{\n\t\t\tthis.completedSprints.showEmptySearchStub();\n\t\t}\n\t}\n\n\thideEmptySearchStub()\n\t{\n\t\tif (this.entityStorage.existCompletedSprint())\n\t\t{\n\t\t\tthis.completedSprints.hideEmptySearchStub();\n\t\t}\n\t}\n\n\tshowFilteredCompletedSprints(completedSprints: Map<Sprint>)\n\t{\n\t\tif (this.entityStorage.existCompletedSprint())\n\t\t{\n\t\t\tthis.completedSprints.showFilteredSprints(completedSprints);\n\t\t}\n\t}\n\n\thideFilteredCompletedSprints()\n\t{\n\t\tif (this.entityStorage.existCompletedSprint())\n\t\t{\n\t\t\tthis.completedSprints.hideFilteredSprints();\n\t\t}\n\t}\n}\n","import {Dom, Event, Loc, Tag, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Entity} from './entity';\nimport {Item} from '../item/item';\n\nimport 'ui.hint';\nimport 'main.polyfill.intersectionobserver';\n\nimport '../css/action-panel.css';\n\ntype Params = {\n\tentity: Entity,\n\titem: Item,\n\tbindElement: HTMLElement,\n\titemList: Object\n}\n\nexport class ActionPanel extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ActionPanel');\n\n\t\tthis.entity = params.entity;\n\t\tthis.item = params.item;\n\n\t\tthis.bindElement = this.item.getNode();\n\n\t\tthis.itemList = {...{\n\t\t\ttask: {activity: false},\n\t\t\tattachment: {activity: false},\n\t\t\tdod: {activity: false},\n\t\t\tmove: {activity: false},\n\t\t\tsprint: {activity: false},\n\t\t\tbacklog: {activity: false},\n\t\t\ttags: {activity: false},\n\t\t\tepic: {activity: false},\n\t\t\tdecomposition: {activity: false},\n\t\t\tremove: {activity: false},\n\t\t}, ...params.itemList};\n\n\t\tthis.node = null;\n\n\t\tthis.isBlockBlur = false;\n\n\t\tthis.hintManager = null;\n\n\t\tthis.observeBindElement();\n\t}\n\n\tshow()\n\t{\n\t\tthis.node = this.calculatePanelPosition(this.createActionPanel());\n\t\tthis.bindItems();\n\n\t\tthis.hintManager = BX.UI.Hint.createInstance({\n\t\t\tpopupParameters: {\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tanimation: null\n\t\t\t}\n\t\t});\n\n\t\tthis.hintManager.init(this.node);\n\n\t\tDom.append(this.node, document.body);\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(this.node);\n\n\t\tthis.node = null;\n\n\t\tif (this.observer)\n\t\t{\n\t\t\tthis.observer.disconnect();\n\t\t}\n\n\t\tthis.hideHint();\n\n\t\tthis.emit('onDestroy');\n\t}\n\n\thideHint()\n\t{\n\t\tif (this.hintManager)\n\t\t{\n\t\t\tthis.hintManager.hide();\n\t\t}\n\t}\n\n\tgetNode(): HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetItem(): Item\n\t{\n\t\treturn this.item;\n\t}\n\n\tcreateActionPanel(): HTMLElement\n\t{\n\t\tlet task = '';\n\t\tlet attachment = '';\n\t\tlet dod = '';\n\t\tlet move = '';\n\t\tlet sprint = '';\n\t\tlet backlog = '';\n\t\tlet tags = '';\n\t\tlet epic = '';\n\t\tlet decomposition = '';\n\t\tlet remove = '';\n\n\t\tconst baseBtnClass = 'tasks-scrum__action-panel--btn';\n\t\tconst arrowClass = 'tasks-scrum__action-panel--btn-with-arrow';\n\n\t\tconst selected = Tag.render`\n\t\t\t<div class=\"tasks-scrum__action-panel--selected-btn tasks-scrum__action-panel--btn-selected\">\n\t\t\t\t<span class=\"tasks-scrum__action-panel--text\">\n\t\t\t\t\t${this.getSelectedText(this.entity.getGroupModeItems().size)}\n\t\t\t\t</span>\n\t\t\t\t<span class=\"tasks-scrum__action-panel--icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-scrum__action-panel--separator\"></div>\n\t\t`;\n\n\t\tif (this.itemList.task.activity)\n\t\t{\n\t\t\tconst disableClass = this.itemList.task.disable === true ? '--disabled' : '';\n\n\t\t\ttask = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"${baseBtnClass} tasks-scrum__action-panel--btn-task ${disableClass}\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TASK_HINT')}\" data-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"tasks-scrum__action-panel--icon\"></span>\n\t\t\t\t\t<span class=\"tasks-scrum__action-panel--text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TASK')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__action-panel--separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.attachment.activity)\n\t\t{\n\t\t\tconst disableClass = this.itemList.attachment.disable === true ? '--disabled' : '';\n\n\t\t\tattachment = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"${baseBtnClass} tasks-scrum__action-panel--btn-attachment ${disableClass}\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_FILE_HINT')}\" data-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"tasks-scrum__action-panel--icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__action-panel--separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.dod.activity)\n\t\t{\n\t\t\tconst disableClass = this.itemList.dod.disable === true ? '--disabled' : '';\n\n\t\t\tdod = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"${baseBtnClass} tasks-scrum__action-panel--btn-dod ${disableClass}\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_DOD_HINT_NEW')}\" data-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"tasks-scrum__action-panel--text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_DOD')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__action-panel--separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.move.activity)\n\t\t{\n\t\t\tconst disableClass = this.itemList.move.disable === true ? '--disabled' : '';\n\n\t\t\tmove = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"${baseBtnClass} tasks-scrum__action-panel--btn-move ${arrowClass} ${disableClass}\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_HINT')}\" data-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"tasks-scrum__action-panel--text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__action-panel--separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.sprint.activity)\n\t\t{\n\t\t\tconst disableClass = this.itemList.sprint.disable === true ? '--disabled' : '';\n\t\t\tconst sprintArrowClass = this.itemList.sprint.multiple === true ? arrowClass : '';\n\n\t\t\tsprint = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"${baseBtnClass} tasks-scrum__action-panel--btn-sprint ${sprintArrowClass} ${disableClass}\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_SPRINT_HINT')}\" data-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"tasks-scrum__action-panel--text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_SPRINT')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__action-panel--separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.backlog.activity)\n\t\t{\n\t\t\tconst disableClass = this.itemList.backlog.disable === true ? '--disabled' : '';\n\n\t\t\tbacklog = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"${baseBtnClass} tasks-scrum__action-panel--btn-backlog ${disableClass}\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_BACKLOG_HINT')}\" data-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"tasks-scrum__action-panel--text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_BACKLOG')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__action-panel--separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.tags.activity)\n\t\t{\n\t\t\tconst disableClass = this.itemList.tags.disable === true ? '--disabled' : '';\n\n\t\t\ttags = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"${baseBtnClass} tasks-scrum__action-panel--btn-tags ${arrowClass} ${disableClass}\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TAG_HINT')}\" data-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"tasks-scrum__action-panel--text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_TAGS')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__action-panel--separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.epic.activity)\n\t\t{\n\t\t\tconst disableClass = this.itemList.epic.disable === true ? '--disabled' : '';\n\n\t\t\tepic = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"${baseBtnClass} tasks-scrum__action-panel--btn-epics ${arrowClass} ${disableClass}\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_EPIC_HINT')}\" data-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"tasks-scrum__action-panel--text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_EPIC')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__action-panel--separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity)\n\t\t{\n\t\t\tconst disableClass = this.itemList.decomposition.disable === true ? '--disabled' : '';\n\t\t\tconst decClass = this.entity.isBacklog()\n\t\t\t\t? 'tasks-scrum__action-panel--btn-decomposition-backlog'\n\t\t\t\t: 'tasks-scrum__action-panel--btn-decomposition-sprint'\n\t\t\t;\n\t\t\tconst hintText = this.entity.isBacklog()\n\t\t\t\t? Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_DEC_BACKLOG_HINT')\n\t\t\t\t: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_DEC_SPRINT_HINT')\n\t\t\t;\n\n\t\t\tdecomposition = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"${baseBtnClass} ${decClass} ${disableClass}\"\n\t\t\t\t\tdata-hint=\"${hintText}\" data-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"tasks-scrum__action-panel--icon\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum__action-panel--separator\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.itemList.remove.activity)\n\t\t{\n\t\t\tconst disableClass = this.itemList.remove.disable === true ? '--disabled' : '';\n\n\t\t\tremove = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"${baseBtnClass} tasks-scrum__action-panel--btn-remove ${disableClass}\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_REMOVE_HINT')}\" data-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"tasks-scrum__action-panel--icon\"></span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum__action-panel--container tasks-scrum__action-panel--scope\" tabindex=\"1\">\n\t\t\t\t<div class=\"tasks-scrum__action-panel\">\n\t\t\t\t\t${selected}\n\t\t\t\t\t${task}\n\t\t\t\t\t${attachment}\n\t\t\t\t\t${dod}\n\t\t\t\t\t${move}\n\t\t\t\t\t${sprint}\n\t\t\t\t\t${backlog}\n\t\t\t\t\t${tags}\n\t\t\t\t\t${epic}\n\t\t\t\t\t${decomposition}\n\t\t\t\t\t${remove}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tbindItems()\n\t{\n\t\tconst selectedBtn = this.node.querySelector('.tasks-scrum__action-panel--btn-selected')\n\t\tEvent.bind(\n\t\t\tselectedBtn.querySelector('.tasks-scrum__action-panel--icon'),\n\t\t\t'click',\n\t\t\t() => this.emit('unSelect')\n\t\t);\n\n\t\tif (this.itemList.task.activity && this.itemList.task.disable !== true)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tthis.node.querySelector('.tasks-scrum__action-panel--btn-task'),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.task.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.attachment.activity && this.itemList.attachment.disable !== true)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tthis.node.querySelector('.tasks-scrum__action-panel--btn-attachment'),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.attachment.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.dod.activity && this.itemList.dod.disable !== true)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tthis.node.querySelector('.tasks-scrum__action-panel--btn-dod'),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.dod.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.move.activity && this.itemList.move.disable !== true)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tthis.node.querySelector('.tasks-scrum__action-panel--btn-move'),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.move.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.sprint.activity && this.itemList.sprint.disable !== true)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tthis.node.querySelector('.tasks-scrum__action-panel--btn-sprint'),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.sprint.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.backlog.activity && this.itemList.backlog.disable !== true)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tthis.node.querySelector('.tasks-scrum__action-panel--btn-backlog'),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.backlog.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.tags.activity && this.itemList.tags.disable !== true)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tthis.node.querySelector('.tasks-scrum__action-panel--btn-tags'),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.tags.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.epic.activity && this.itemList.epic.disable !== true)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tthis.node.querySelector('.tasks-scrum__action-panel--btn-epics'),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.epic.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.decomposition.activity && this.itemList.decomposition.disable !== true)\n\t\t{\n\t\t\tconst decClass = this.entity.isBacklog()\n\t\t\t\t? 'tasks-scrum__action-panel--btn-decomposition-backlog'\n\t\t\t\t: 'tasks-scrum__action-panel--btn-decomposition-sprint'\n\t\t\t;\n\n\t\t\tEvent.bind(\n\t\t\t\tthis.node.querySelector('.' + decClass),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.decomposition.callback\n\t\t\t);\n\t\t}\n\n\t\tif (this.itemList.remove.activity && this.itemList.remove.disable !== true)\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tthis.node.querySelector('.tasks-scrum__action-panel--btn-remove'),\n\t\t\t\t'click',\n\t\t\t\tthis.itemList.remove.callback\n\t\t\t);\n\t\t}\n\t}\n\n\tgetSelectedText(number: number): string\n\t{\n\t\treturn Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_SELECTED') + parseInt(number, 10);\n\t}\n\n\tobserveBindElement()\n\t{\n\t\tif (Type.isUndefined(IntersectionObserver))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.observer = new IntersectionObserver((entries) =>\n\t\t\t{\n\t\t\t\tif (entries[0].isIntersecting === true)\n\t\t\t\t{\n\t\t\t\t\tthis.displayPanel();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.hidePanel();\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tthreshold: [0]\n\t\t\t}\n\t\t);\n\n\t\tthis.observer.observe(this.bindElement);\n\t}\n\n\tdisplayPanel()\n\t{\n\t\tif (!Dom.isShown(this.getNode()))\n\t\t{\n\t\t\tDom.style(this.getNode(), 'display', 'block');\n\t\t}\n\t}\n\n\thidePanel()\n\t{\n\t\tif (Dom.isShown(this.getNode()))\n\t\t{\n\t\t\tDom.style(this.getNode(), 'display', 'none');\n\t\t}\n\t}\n\n\tcalculatePanelPosition(panel: HTMLElement)\n\t{\n\t\tconst position = Dom.getPosition(this.bindElement);\n\n\t\tconst top = `${position.top}px`;\n\t\tlet left = `${position.left}px`;\n\n\t\tconst fakePanel = panel.cloneNode(true);\n\t\tDom.style(fakePanel, 'visibility', 'hidden');\n\t\tDom.style(fakePanel, 'top', `${position.top}px`);\n\t\tDom.style(fakePanel, 'left', `${position.left}px`);\n\n\t\tDom.append(fakePanel, document.body);\n\t\tif (this.isPanelWiderThanViewport(fakePanel))\n\t\t{\n\t\t\tconst fakePanelRect = fakePanel.getBoundingClientRect();\n\t\t\tconst windowWidth = (window.innerWidth || document.documentElement.clientWidth);\n\t\t\tleft = `${fakePanelRect.left - (fakePanelRect.right - windowWidth + 40)}px`;\n\t\t}\n\t\tDom.remove(fakePanel);\n\n\t\tDom.style(panel, 'top', top);\n\t\tDom.style(panel, 'left', left);\n\t\tDom.style(panel, 'zIndex', 1100);\n\n\t\tthis.removeLastSeparator(panel);\n\n\t\treturn panel;\n\t}\n\n\tisPanelWiderThanViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\t\tconst windowWidth = (window.innerWidth || document.documentElement.clientWidth);\n\n\t\treturn (rect.right > windowWidth);\n\t}\n\n\tcalculatePanelTopPosition()\n\t{\n\t\tif (!this.getNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst position = Dom.getPosition(this.bindElement);\n\n\t\tDom.style(this.getNode(), 'top', `${position.top}px`);\n\t}\n\n\tremoveLastSeparator(panel: HTMLElement)\n\t{\n\t\tconst actionPanel =  panel.querySelector('.tasks-scrum__action-panel');\n\t\tif (Dom.hasClass(actionPanel.lastElementChild, 'tasks-scrum__action-panel--separator'))\n\t\t{\n\t\t\tDom.remove(actionPanel.lastElementChild);\n\t\t}\n\t}\n}","import {Dom, Tag, Event} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Item} from '../item/item';\n\nimport '../css/search.arrows.css';\n\ntype Params = {\n\tcurrentPosition: number,\n\tlist: Set<Item>\n}\n\nexport class SearchArrows extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SearchArrows');\n\n\t\tthis.list = params.list;\n\n\t\tthis.currentPosition = parseInt(params.currentPosition, 10);\n\n\t\tthis.node = null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.node = Tag.render`\n\t\t\t<div class=\"tasks-scrum__item--nav-linked tasks-scrum__scope\">\n\t\t\t\t<div class=\"tasks-scrum__item--nav-linked-close\"></div>\n\t\t\t\t<div class=\"tasks-scrum__item--nav-linked-block\">\n\t\t\t\t\t<div class=\"tasks-scrum__item--nav-linked-prev\"></div>\n\t\t\t\t\t<div class=\"tasks-scrum__item--nav-linked-num-container --visible\">\n\t\t\t\t\t<div class=\"tasks-scrum__item--nav-linked-num\">${this.currentPosition}/${this.list.size}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum__item--nav-linked-next\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst closeBtn = this.node.querySelector('.tasks-scrum__item--nav-linked-close');\n\t\tconst prevBtn = this.node.querySelector('.tasks-scrum__item--nav-linked-prev');\n\t\tconst nextBtn = this.node.querySelector('.tasks-scrum__item--nav-linked-next');\n\n\t\tEvent.bind(closeBtn, 'click', this.onClose.bind(this));\n\t\tEvent.bind(prevBtn, 'click', this.onPrev.bind(this));\n\t\tEvent.bind(nextBtn, 'click', this.onNext.bind(this));\n\n\t\treturn this.node;\n\t}\n\n\tgetNode(): HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tupdateCurrentPosition(value: number)\n\t{\n\t\tthis.currentPosition = parseInt(value, 10);\n\n\t\tif (this.node)\n\t\t{\n\t\t\tthis.node.querySelector('.tasks-scrum__item--nav-linked-num')\n\t\t\t\t.textContent = `${this.currentPosition}/${this.list.size}`\n\t\t\t;\n\t\t}\n\t}\n\n\tremove()\n\t{\n\t\tDom.remove(this.node);\n\n\t\tthis.node = null;\n\t}\n\n\tonClose()\n\t{\n\t\tthis.emit('close');\n\t}\n\n\tonPrev()\n\t{\n\t\tthis.emit('prev');\n\t}\n\n\tonNext()\n\t{\n\t\tthis.emit('next');\n\t}\n}\n","import {Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {PlanBuilder} from '../view/plan/plan.builder';\n\nimport {Sprint} from './sprint/sprint';\nimport {EntityStorage} from './entity.storage';\nimport {SearchArrows} from './search.arrows';\n\nimport {Item} from '../item/item';\n\nimport {Scroller} from '../utility/scroller';\n\ntype Params = {\n\tplanBuilder: PlanBuilder,\n\tentityStorage: EntityStorage\n}\n\nexport class SearchItems extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.SearchItems');\n\n\t\tthis.planBuilder = params.planBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.scroller = new Scroller({\n\t\t\tplanBuilder: this.planBuilder,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.active = false;\n\n\t\tthis.list = new Set();\n\n\t\tthis.currentIndex = 0;\n\n\t\tthis.arrows = null;\n\t}\n\n\tstart(startItem: Item, linkedItemIds: Array<number>)\n\t{\n\t\tthis.active = true;\n\n\t\tthis.setList(linkedItemIds);\n\n\t\tthis.fadeOutAll();\n\n\t\tif (!this.isBacklogItem(startItem))\n\t\t{\n\t\t\tthis.scroller.scrollToItem(this.getCurrent());\n\t\t}\n\n\t\tif (!startItem.isDisabled())\n\t\t{\n\t\t\tthis.updateCurrentIndexByItem(startItem);\n\n\t\t\tthis.activateCurrent(startItem);\n\t\t}\n\n\t\tthis.list.forEach((item: Item) => {\n\t\t\titem.activateLinkedMode();\n\t\t});\n\n\t\tthis.showArrows();\n\t}\n\n\tstop()\n\t{\n\t\tthis.active = false;\n\n\t\tthis.currentIndex = 0;\n\n\t\tthis.fadeInAll();\n\n\t\tthis.cleanList();\n\t\tthis.removeArrows();\n\t}\n\n\tsetList(linkedItemIds: Array<number>)\n\t{\n\t\tthis.list = new Set();\n\n\t\tconst items = this.entityStorage.getAllItems();\n\n\t\tlinkedItemIds.forEach((itemId: number) => {\n\t\t\tif (items.has(itemId))\n\t\t\t{\n\t\t\t\tthis.list.add(items.get(itemId));\n\t\t\t}\n\t\t});\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn this.active;\n\t}\n\n\tisBacklogItem(item: Item): boolean\n\t{\n\t\treturn this.entityStorage.getBacklog().hasItem(item);\n\t}\n\n\tgetCurrent(): Item\n\t{\n\t\treturn [...this.list.values()][this.currentIndex];\n\t}\n\n\tupdateCurrentIndexByItem(inputItem: Item)\n\t{\n\t\tthis.deactivateCurrent(this.getCurrent());\n\n\t\t[...this.list.values()].forEach((item: Item, index: number) => {\n\t\t\tif (inputItem.getId() === item.getId())\n\t\t\t{\n\t\t\t\tthis.currentIndex = index;\n\t\t\t}\n\t\t});\n\n\t\tthis.updateArrows();\n\t}\n\n\tmoveToPrev()\n\t{\n\t\tthis.deactivateCurrent(this.getCurrent());\n\n\t\tthis.currentIndex--;\n\n\t\tif (this.currentIndex < 0)\n\t\t{\n\t\t\tthis.currentIndex = (this.list.size - 1);\n\t\t}\n\n\t\tthis.updateArrows();\n\n\t\tconst currentItem = this.getCurrent();\n\n\t\tthis.scroller.scrollToItem(currentItem);\n\n\t\tthis.activateCurrent(currentItem);\n\t}\n\n\tmoveToNext()\n\t{\n\t\tthis.deactivateCurrent(this.getCurrent());\n\n\t\tthis.currentIndex++;\n\n\t\tif (this.currentIndex === this.list.size)\n\t\t{\n\t\t\tthis.currentIndex = 0;\n\t\t}\n\n\t\tthis.updateArrows();\n\n\t\tconst currentItem = this.getCurrent();\n\n\t\tthis.scroller.scrollToItem(currentItem);\n\n\t\tthis.activateCurrent(currentItem);\n\t}\n\n\tactivateCurrent(item: Item)\n\t{\n\t\titem.activateCurrentLinkedMode(item);\n\t}\n\n\tdeactivateCurrent()\n\t{\n\t\tthis.list.forEach((item: Item) => {\n\t\t\titem.deactivateCurrentLinkedMode();\n\t\t});\n\t}\n\n\tfadeOutAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeOut();\n\t\tthis.entityStorage.getBacklog().setActiveLoadItems(true);\n\n\t\tconst activeSprint = this.entityStorage.getActiveSprint();\n\t\tif (activeSprint)\n\t\t{\n\t\t\tactiveSprint.fadeOut();\n\t\t\tactiveSprint.setActiveLoadItems(true);\n\n\t\t\tif (activeSprint.isHideContent())\n\t\t\t{\n\t\t\t\tactiveSprint.toggleVisibilityContent(activeSprint.getContentContainer());\n\t\t\t}\n\t\t}\n\n\t\tthis.entityStorage.getPlannedSprints()\n\t\t\t.forEach((sprint: Sprint) => {\n\t\t\t\tsprint.fadeOut();\n\t\t\t\tsprint.setActiveLoadItems(true);\n\t\t\t\tif (sprint.isHideContent())\n\t\t\t\t{\n\t\t\t\t\tsprint.toggleVisibilityContent(sprint.getContentContainer());\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\tfadeInAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeIn();\n\n\t\tconst activeSprint = this.entityStorage.getActiveSprint();\n\t\tif (activeSprint)\n\t\t{\n\t\t\tactiveSprint.fadeIn();\n\t\t}\n\n\t\tthis.entityStorage.getPlannedSprints()\n\t\t\t.forEach((sprint: Sprint) => {\n\t\t\t\tsprint.fadeIn();\n\t\t\t})\n\t\t;\n\t}\n\n\tdeactivateGroupMode()\n\t{\n\t\tthis.entityStorage.getBacklog().deactivateGroupMode();\n\n\t\tconst activeSprint = this.entityStorage.getActiveSprint();\n\t\tif (activeSprint)\n\t\t{\n\t\t\tactiveSprint.deactivateGroupMode();\n\t\t}\n\n\t\tthis.entityStorage.getPlannedSprints()\n\t\t\t.forEach((sprint: Sprint) => {\n\t\t\t\tsprint.deactivateGroupMode();\n\t\t\t})\n\t\t;\n\t}\n\n\tshowArrows()\n\t{\n\t\tthis.arrows = new SearchArrows({\n\t\t\tcurrentPosition: this.currentIndex + 1,\n\t\t\tlist: this.list\n\t\t});\n\n\t\tthis.arrows.subscribe('close', this.stop.bind(this));\n\t\tthis.arrows.subscribe('prev', this.moveToPrev.bind(this));\n\t\tthis.arrows.subscribe('next', this.moveToNext.bind(this));\n\n\t\tDom.append(this.arrows.render(), document.body);\n\n\t\tthis.adjustArrowsPosition();\n\t}\n\n\tupdateArrows()\n\t{\n\t\tif (this.arrows)\n\t\t{\n\t\t\tthis.arrows.updateCurrentPosition(this.currentIndex + 1);\n\t\t}\n\t}\n\n\tadjustArrowsPosition()\n\t{\n\t\tconst arrowsRect = Dom.getPosition(this.arrows.getNode());\n\t\tconst backlogRect = Dom.getPosition(this.entityStorage.getBacklog().getNode());\n\n\t\tthis.arrows.getNode().style.top = `${(backlogRect.height / 2) + (backlogRect.top - arrowsRect.height)}px`;\n\t\tthis.arrows.getNode().style.left = `${backlogRect.left - ((arrowsRect.width / 2) + 16)}px`;\n\t}\n\n\tcleanList()\n\t{\n\t\tthis.list.forEach((item: Item) => item.deactivateLinkedMode());\n\n\t\tthis.list = new Set();\n\t}\n\n\tremoveArrows()\n\t{\n\t\tthis.arrows.remove();\n\t}\n\n\tisClickInside(node: HTMLElement): boolean\n\t{\n\t\tlet isClickInside = false;\n\n\t\tconst backlog = this.entityStorage.getBacklog();\n\n\t\tif (backlog.getNode().contains(node))\n\t\t{\n\t\t\tisClickInside = true;\n\t\t}\n\n\t\tconst activeSprint = this.entityStorage.getActiveSprint();\n\t\tif (activeSprint && activeSprint.getNode().contains(node))\n\t\t{\n\t\t\tisClickInside = true;\n\t\t}\n\n\t\tif (this.arrows && this.arrows.getNode().contains(node))\n\t\t{\n\t\t\tisClickInside = true;\n\t\t}\n\n\t\tthis.entityStorage.getPlannedSprints()\n\t\t\t.forEach((sprint: Sprint) => {\n\t\t\t\tif (sprint.getNode().contains(node))\n\t\t\t\t{\n\t\t\t\t\tisClickInside = true;\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\treturn isClickInside;\n\t}\n}","import {BaseEvent} from 'main.core.events';\n\nimport {PlanBuilder} from '../../view/plan/plan.builder';\n\nimport {EntityStorage} from '../entity.storage';\nimport {Sprint} from './sprint';\n\nimport {RequestSender} from '../../utility/request.sender';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tplanBuilder: PlanBuilder,\n\tentityStorage: EntityStorage\n}\n\nexport class SprintMover\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.planBuilder = params.planBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.bindHandlers();\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.planBuilder.subscribe('setDraggable', this.onSetDraggable.bind(this));\n\n\t\t//this.planBuilder.subscribe('sprintMove', this.onSprintMove.bind(this))\n\t}\n\n\tonSetDraggable(baseEvent: BaseEvent)\n\t{\n\t\t// this.draggableSprints = new Draggable({\n\t\t// \tcontainer: this.sprintsNode.querySelector('.tasks-scrum__sprints--planned'),\n\t\t// \tdraggable: '.tasks-scrum-sprint',\n\t\t// \tdragElement: '.tasks-scrum-sprint-dragndrop',\n\t\t// \ttype: Draggable.DROP_PREVIEW,\n\t\t// });\n\t\t// this.draggableSprints.subscribe('end', (baseEvent) => {\n\t\t// \tconst dragEndEvent = baseEvent.getData();\n\t\t// \tthis.emit('sprintMove', dragEndEvent);\n\t\t// });\n\t}\n\n\tonSprintMove(baseEvent: BaseEvent)\n\t{\n\t\tconst dragEndEvent = baseEvent.getData();\n\t\tif (!dragEndEvent.endContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.updateSprintSort({\n\t\t\tsortInfo: this.calculateSprintSort()\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tcalculateSprintSort(increment = 0)\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst sprints = this.entityStorage.getPlannedSprints();\n\n\t\tlet sort = 1 + increment;\n\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\tsprint.setSort(sort);\n\t\t\tlistSortInfo[sprint.getId()] = {\n\t\t\t\tsort: sort\n\t\t\t};\n\t\t\tsort++;\n\t\t});\n\n\t\treturn listSortInfo;\n\t}\n}","import {SidePanel} from '../../service/side.panel';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Sprint} from './sprint';\n\ntype Params = {\n\tgroupId: number,\n\tsidePanel: SidePanel,\n\tviews: {\n\t\tplan: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tactiveSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t},\n\t\tcompletedSprint: {\n\t\t\tname: string,\n\t\t\turl: string,\n\t\t\tactive: boolean\n\t\t}\n\t},\n\tpathToBurnDown: string\n};\n\nexport class SprintSidePanel extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.views = params.views;\n\t\tthis.pathToBurnDown = params.pathToBurnDown ? params.pathToBurnDown : '';\n\t}\n\n\tshowStartForm(sprint: Sprint)\n\t{\n\t\tthis.sidePanel.showByExtension(\n\t\t\t'Sprint-Start-Form',\n\t\t\t{\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\tsprintId: sprint.getId()\n\t\t\t}\n\t\t)\n\t\t\t.then((extension) => {\n\t\t\t\tif (extension)\n\t\t\t\t{\n\t\t\t\t\textension.subscribe('afterStart', (baseEvent: BaseEvent) => {\n\t\t\t\t\t\tlocation.href = this.views['activeSprint'].url;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\tshowCompletionForm()\n\t{\n\t\tthis.sidePanel.showByExtension(\n\t\t\t'Sprint-Completion-Form',\n\t\t\t{ groupId: this.groupId }\n\t\t)\n\t\t\t.then((extension) => {\n\t\t\t\tif (extension)\n\t\t\t\t{\n\t\t\t\t\textension.subscribe('afterComplete', (baseEvent: BaseEvent) => {\n\t\t\t\t\t\tlocation.href = this.views['plan'].url;\n\t\t\t\t\t});\n\t\t\t\t\textension.subscribe('taskClick', (baseEvent: BaseEvent) => {\n\t\t\t\t\t\tthis.emit('showTask', baseEvent.getData());\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\tshowBurnDownChart(sprint: Sprint)\n\t{\n\t\tif (this.pathToBurnDown)\n\t\t{\n\t\t\tthis.sidePanel.openSidePanel(this.pathToBurnDown.replace('#sprint_id#', sprint.getId()));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new Error('Could not find a page to display the chart.');\n\t\t}\n\t}\n}\n","import {EntityStorage} from '../entity/entity.storage';\n\nimport {Backlog} from '../entity/backlog/backlog';\nimport {Sprint} from '../entity/sprint/sprint';\n\nimport {RequestSender} from '../utility/request.sender';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage\n}\n\nexport class EntityCounters\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t}\n\n\tupdateCounters(entities: Map<number, Backlog | Sprint>)\n\t{\n\t\tconst requestData = {\n\t\t\tentityIds: [...entities.keys()]\n\t\t};\n\n\t\tthis.requestSender.getEntityCounters(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tObject.keys(response.data).forEach((entityId: number) => {\n\t\t\t\t\tentityId = parseInt(entityId, 10);\n\t\t\t\t\tconst entity = entities.get(entityId);\n\t\t\t\t\tconst counters = response.data[entityId];\n\t\t\t\t\tentity.setStoryPoints(counters.storyPoints);\n\t\t\t\t\tentity.setNumberTasks(counters.numberTasks);\n\t\t\t\t\tif (entity.isActive())\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.setCompletedStoryPoints(counters.completedStoryPoints);\n\t\t\t\t\t\tentity.setUncompletedStoryPoints(counters.uncompletedStoryPoints);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n}","import {Loc, Type, Text, Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Menu} from 'main.popup';\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {Draggable} from 'ui.draganddrop.draggable';\n\nimport {PlanBuilder} from '../view/plan/plan.builder';\n\nimport {EntityStorage} from '../entity/entity.storage';\nimport {Entity} from '../entity/entity';\nimport {Sprint} from '../entity/sprint/sprint';\n\nimport {Item} from './item';\n\nimport {EntityCounters} from '../counters/entity.counters';\n\nimport {RequestSender} from '../utility/request.sender';\nimport {Scroller} from \"../utility/scroller\";\n\nexport type ItemsSortInfo = {\n\t[id: number]: {\n\t\tsort: number,\n\t\tentityId?: number,\n\t\ttmpId?: string,\n\t\tupdatedItemId?: number\n\t}\n}\n\ntype Params = {\n\trequestSender: RequestSender,\n\tplanBuilder: PlanBuilder,\n\tentityStorage: EntityStorage,\n\tentityCounters: EntityCounters\n}\n\nexport class ItemMover extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ItemMover');\n\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.planBuilder = params.planBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.entityCounters = params.entityCounters;\n\n\t\tthis.scroller = new Scroller({\n\t\t\tplanBuilder: this.planBuilder,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.dragItems = new Set();\n\n\t\tthis.lastOutContainer = null;\n\n\t\tthis.bindHandlers();\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.planBuilder.subscribe('setDraggable', this.onSetDraggable.bind(this));\n\t\tthis.planBuilder.subscribe('createSprintNode', (baseEvent: BaseEvent) => {\n\t\t\tconst sprint = baseEvent.getData();\n\t\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\t\t\tthis.draggableItems.addDropzone(sprint.getDropzone());\n\t\t});\n\t}\n\n\tonSetDraggable(baseEvent: BaseEvent)\n\t{\n\t\tconst backlog = this.entityStorage.getBacklog();\n\n\t\tconst containers = [\n\t\t\tbacklog.getListItemsNode()\n\t\t];\n\t\tconst dropZones = [\n\t\t\tbacklog.getDropzone(),\n\t\t\tthis.planBuilder.getSprintDropzone()\n\t\t];\n\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (!sprint.isDisabled())\n\t\t\t{\n\t\t\t\tcontainers.push(sprint.getListItemsNode());\n\n\t\t\t\tif (sprint.getDropzone())\n\t\t\t\t{\n\t\t\t\t\tdropZones.push(sprint.getDropzone());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.draggableItems = new Draggable({\n\t\t\tcontainer: containers,\n\t\t\tdropzone: dropZones,\n\t\t\tdraggable: '.tasks-scrum__item--drag',\n\t\t\tdragElement: '.tasks-scrum__item',\n\t\t\ttype: Draggable.CLONE,\n\t\t\tdelay: 200\n\t\t});\n\n\t\tthis.draggableItems.subscribe('beforeStart', this.onBeforeDragStart.bind(this));\n\t\tthis.draggableItems.subscribe('start', this.onDragStart.bind(this));\n\t\tthis.draggableItems.subscribe('end', this.onDragEnd.bind(this));\n\n\t\tthis.draggableItems.subscribe('drop', this.onDropEnd.bind(this));\n\t\tthis.draggableItems.subscribe('dropzone:enter', this.onDropZoneEnter.bind(this));\n\t\tthis.draggableItems.subscribe('dropzone:out', this.onDropZoneOut.bind(this));\n\t}\n\n\tonBeforeDragStart(baseEvent: BaseEvent)\n\t{\n\t\tconst dragBeforeStartEvent = baseEvent.getData();\n\n\t\tif (!dragBeforeStartEvent.source)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemId = parseInt(dragBeforeStartEvent.source.dataset.id, 10);\n\n\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\n\t\tif (!item || item.isSubTask() || item.isDisabled())\n\t\t{\n\t\t\tbaseEvent.preventDefault();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (item.isShownSubTasks())\n\t\t\t{\n\t\t\t\titem.hideSubTasks();\n\t\t\t}\n\n\t\t\tconst sourceContainer = dragBeforeStartEvent.sourceContainer;\n\t\t\tif (Type.isUndefined(sourceContainer))\n\t\t\t{\n\t\t\t\tbaseEvent.preventDefault();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\t\tif (!sourceEntity)\n\t\t\t{\n\t\t\t\tbaseEvent.preventDefault();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.dragItems.clear();\n\n\t\t\tsourceEntity.getGroupModeItems()\n\t\t\t\t.forEach((selectedItem: Item) => {\n\t\t\t\t\tif (selectedItem.getId() !== item.getId())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.dragItems.add(selectedItem);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\n\t\t\tconst isMultipleDrag = (this.dragItems.size > 0);\n\t\t\tif (isMultipleDrag)\n\t\t\t{\n\t\t\t\tthis.addMultipleMode(item, this.dragItems);\n\t\t\t}\n\n\t\t\tthis.entityStorage.getAllEntities()\n\t\t\t\t.forEach((entity: Entity) => {\n\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\tentity.getItems()\n\t\t\t\t\t\t.forEach((entityItem: Item) => {\n\t\t\t\t\t\t\tif (entityItem.isShownSubTasks())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tentityItem.hideSubTasks();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t})\n\t\t\t;\n\n\t\t\tthis.emit('dragStart');\n\t\t}\n\t}\n\n\tonDragStart(baseEvent: BaseEvent)\n\t{\n\t\tthis.planBuilder.blockScrumContainerSelect();\n\n\t\tconst dragStartEvent = baseEvent.getData();\n\n\t\tconst sourceContainer = dragStartEvent.sourceContainer;\n\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\n\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\n\t\tthis.entityStorage\n\t\t\t.getAllEntities()\n\t\t\t.forEach((entity: Entity) => {\n\t\t\t\tif (!entity.isCompleted() && sourceEntity.getId() !== entity.getId())\n\t\t\t\t{\n\t\t\t\t\tif (entity.isEmpty())\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.showDropzone();\n\t\t\t\t\t\tentity.hideEmptySearchStub();\n\t\t\t\t\t\tentity.hideBlank();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\tonDragEnd(baseEvent: BaseEvent)\n\t{\n\t\tconst dragEndEvent = baseEvent.getData();\n\n\t\tconst itemNode = dragEndEvent.source;\n\t\tconst itemId = parseInt(itemNode.dataset.id, 10);\n\n\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\n\t\tif (!item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst isMultipleDrag = (this.dragItems.size > 0);\n\t\tif (isMultipleDrag)\n\t\t{\n\t\t\tthis.removeMultipleMode(item, this.dragItems);\n\t\t}\n\n\t\tthis.planBuilder.unblockScrumContainerSelect();\n\n\t\tconst sourceContainer = dragEndEvent.sourceContainer;\n\t\tlet endContainer = dragEndEvent.endContainer;\n\t\tif (!endContainer)\n\t\t{\n\t\t\tif (this.isDropToZone)\n\t\t\t{\n\t\t\t\tthis.isDropToZone = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tendContainer = this.lastOutContainer;\n\t\t\t}\n\t\t}\n\n\t\tthis.lastOutContainer = null;\n\n\t\tif (!endContainer)\n\t\t{\n\t\t\tbaseEvent.preventDefault();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\tconst endEntityId = parseInt(endContainer.dataset.entityId, 10);\n\n\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\tconst endEntity = this.entityStorage.findEntityByEntityId(endEntityId);\n\n\t\tif (sourceEntity && endEntity)\n\t\t{\n\t\t\tthis.onItemMove(item, sourceEntity, endEntity)\n\t\t\t\t.then(() => {\n\t\t\t\t\tconst isMultipleDrag = (this.dragItems.size > 0);\n\t\t\t\t\tif (isMultipleDrag)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.dragGroupItems(item, this.dragItems, sourceEntity, endEntity);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\n\t\t\tsourceEntity.adjustListItemsWidth();\n\t\t\tendEntity.adjustListItemsWidth();\n\t\t}\n\n\t\tif (sourceEntity)\n\t\t{\n\t\t\tthis.entityStorage\n\t\t\t\t.getAllEntities()\n\t\t\t\t.forEach((entity: Entity) => {\n\t\t\t\t\tif (!entity.isCompleted() && sourceEntity.getId() !== entity.getId())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (entity.isEmpty())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (entity.getNumberTasks() > 0 && entity.isExactSearchApplied())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tentity.showEmptySearchStub();\n\t\t\t\t\t\t\t\tentity.hideDropzone();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tentity.showDropzone();\n\t\t\t\t\t\t\t\tentity.hideEmptySearchStub();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\n\t\tthis.planBuilder.adjustSprintListWidth();\n\t}\n\n\tonDropEnd(baseEvent: BaseEvent)\n\t{\n\t\tconst dragDropEvent = baseEvent.getData();\n\n\t\tconst dropzone = dragDropEvent.dropzone;\n\n\t\tconst sourceContainer = dragDropEvent.sourceContainer;\n\n\t\tconst sourceEntityId = parseInt(sourceContainer.dataset.entityId, 10);\n\t\tconst endEntityId = parseInt(dropzone.dataset.entityId, 10);\n\n\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\t\tconst endEntity = this.entityStorage.findEntityByEntityId(endEntityId);\n\n\t\tconst itemNode = dragDropEvent.source;\n\t\tconst itemId = parseInt(itemNode.dataset.id, 10);\n\n\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\n\t\tif (this.planBuilder.isSprintDropzone(dropzone))\n\t\t{\n\t\t\tthis.planBuilder.createSprint()\n\t\t\t\t.then((sprint: Sprint) => {\n\t\t\t\t\tthis.addSprintContainers(sprint);\n\t\t\t\t\tthis.moveTo(sourceEntity, sprint, item);\n\t\t\t\t\tconst isMultipleDrag = (this.dragItems.size > 0);\n\t\t\t\t\tif (isMultipleDrag)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.dragGroupItems(item, this.dragItems, sourceEntity, sprint);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (sourceEntity && endEntity)\n\t\t\t{\n\t\t\t\tconst itemNode = dragDropEvent.source;\n\t\t\t\tconst itemId = parseInt(itemNode.dataset.id, 10);\n\n\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tthis.onItemMove(item, sourceEntity, endEntity, true)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tconst isMultipleDrag = (this.dragItems.size > 0);\n\t\t\t\t\t\t\tif (isMultipleDrag)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.dragGroupItems(item, this.dragItems, sourceEntity, endEntity);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tsourceEntity.adjustListItemsWidth();\n\t\t\t\t\t\t\tendEntity.adjustListItemsWidth();\n\n\t\t\t\t\t\t\tthis.planBuilder.adjustSprintListWidth();\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.entityStorage\n\t\t\t.getAllEntities()\n\t\t\t.forEach((entity: Entity) => {\n\t\t\t\tif (!entity.isCompleted() && sourceEntity.getId() !== entity.getId())\n\t\t\t\t{\n\t\t\t\t\tif (entity.isEmpty())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (entity.getNumberTasks() > 0 && entity.isExactSearchApplied())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentity.showEmptySearchStub();\n\t\t\t\t\t\t\tentity.hideDropzone();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentity.showDropzone();\n\t\t\t\t\t\t\tentity.hideEmptySearchStub();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\tonDropZoneEnter()\n\t{\n\t\tthis.isDropToZone = true;\n\t}\n\n\tonDropZoneOut()\n\t{\n\t\tthis.isDropToZone = false;\n\t}\n\n\tonItemMove(item: Item, sourceEntity: Entity, endEntity: Entity, insertDom: false): Promise\n\t{\n\t\tif (sourceEntity.getId() === endEntity.getId())\n\t\t{\n\t\t\treturn this.moveInCurrentContainer(new Set([item.getId()]), sourceEntity);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\n\t\t\treturn this.onMoveConfirm(sourceEntity, message)\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (insertDom)\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.insertBefore(item.getNode(), endEntity.getLoaderNode());\n\t\t\t\t\t}\n\t\t\t\t\tthis.moveItemFromEntityToEntity(item, sourceEntity, endEntity);\n\t\t\t\t\tthis.moveInAnotherContainer(new Set([item.getId()]), sourceEntity, endEntity);\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tDom.insertBefore(\n\t\t\t\t\t\titem.getNode(),\n\t\t\t\t\t\tsourceEntity.getListItemsNode().children[item.getSort() - 1]\n\t\t\t\t\t);\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\tonMoveItemUpdate(entityFrom: Entity, entityTo: Entity, item: Item)\n\t{\n\t\tthis.requestSender.updateItemSort({\n\t\t\tentityId: entityTo.getId(),\n\t\t\titemIds: [item.getId()],\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), new Set([item.getId()]), true),\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), new Set(), true)\n\t\t\t}\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.updateEntityCounters(entityFrom, entityTo);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonMoveConfirm(entity: Entity, message: string): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (entity.isActive())\n\t\t\t{\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tmessage,\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_MOVE'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\treject();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tdragGroupItems(dragItem: Item, dragItems: Set<Item>, entityFrom: Entity, entityTo: Entity)\n\t{\n\t\tconst isMoveInCurrentContainer = (entityFrom.getId() === entityTo.getId());\n\n\t\tconst sortedDragItems = [...dragItems.values()]\n\t\t\t.sort((first: Item, second: Item) => {\n\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t})\n\t\t;\n\n\t\tconst dragItemIds = new Set();\n\t\tsortedDragItems\n\t\t\t.forEach((groupedItem: Item) => {\n\t\t\t\tdragItemIds.add(groupedItem.getId());\n\t\t\t\tentityTo.appendNodeAfterItem(groupedItem.getNode(), dragItem.getNode());\n\t\t\t\tif (!isMoveInCurrentContainer)\n\t\t\t\t{\n\t\t\t\t\tthis.moveItemFromEntityToEntity(groupedItem, entityFrom, entityTo);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tif (isMoveInCurrentContainer)\n\t\t{\n\t\t\tthis.moveInCurrentContainer(dragItemIds, entityFrom);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.moveInAnotherContainer(dragItemIds, entityFrom, entityTo);\n\t\t}\n\t}\n\n\taddMultipleMode(item: Item, dragItems: Set<Item>)\n\t{\n\n\t\tDom.addClass(item.getNode(), (dragItems.size > 1 ? '--multiple-drag-many' : '--multiple-drag'));\n\n\t\tdragItems\n\t\t\t.forEach((dragItem: Item) => {\n\t\t\t\tDom.addClass(dragItem.getNode(), '--multiple-drag-shadow');\n\t\t\t})\n\t\t;\n\t}\n\n\tremoveMultipleMode(item: Item, dragItems: Set<Item>)\n\t{\n\n\t\tDom.removeClass(item.getNode(), '--multiple-drag');\n\t\tDom.removeClass(item.getNode(), '--multiple-drag-many');\n\n\t\tdragItems\n\t\t\t.forEach((dragItem: Item) => {\n\t\t\t\tDom.removeClass(dragItem.getNode(), '--multiple-drag-shadow');\n\t\t\t})\n\t\t;\n\t}\n\n\taddSprintContainers(sprint: Sprint)\n\t{\n\t\tif (!sprint.isDisabled())\n\t\t{\n\t\t\tthis.draggableItems.addContainer(sprint.getListItemsNode());\n\t\t\tthis.draggableItems.addDropzone(sprint.getDropzone());\n\t\t}\n\t}\n\n\tmoveItem(item: Item, button)\n\t{\n\t\tconst entity = this.entityStorage.findEntityByItemId(item.getId());\n\n\t\tconst listToMove = [];\n\n\t\tif (!entity.isFirstItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_UP'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\n\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t\t\t});\n\t\t\t\t\tconst sortedItemsIds = new Set();\n\n\t\t\t\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tsortedItemsIds.add(groupModeItem.getId());\n\t\t\t\t\t\tif (groupModeItem.isParentTask() && groupModeItem.isShownSubTasks())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgroupModeItem.hideSubTasks();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.moveItemToUp(groupModeItem, entity.getListItemsNode(), false);\n\t\t\t\t\t\tgroupModeItem.activateBlinking();\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.scroller.scrollToItem(sortedItems.values().next().value);\n\n\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode(), sortedItemsIds)\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\n\t\t\t\t\tentity.deactivateGroupMode();\n\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (!entity.isLastItem(item))\n\t\t{\n\t\t\tlistToMove.push({\n\t\t\t\ttext: Loc.getMessage('TASKS_SCRUM_ITEM_ACTIONS_MOVE_DOWN'),\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tconst groupModeItems = entity.getGroupModeItems();\n\n\t\t\t\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t\t\t});\n\n\t\t\t\t\tconst sortedItemsIds = new Set();\n\t\t\t\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tsortedItemsIds.add(groupModeItem.getId());\n\t\t\t\t\t\tif (groupModeItem.isParentTask() && groupModeItem.isShownSubTasks())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgroupModeItem.hideSubTasks();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.moveItemToDown(groupModeItem, entity.getListItemsNode(), false);\n\t\t\t\t\t\tgroupModeItem.activateBlinking();\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.scroller.scrollToItem(sortedItems.values().next().value);\n\n\t\t\t\t\tthis.requestSender.updateItemSort({\n\t\t\t\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode(), sortedItemsIds)\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\n\t\t\t\t\tentity.deactivateGroupMode();\n\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.showMoveItemMenu(item, button, listToMove);\n\t}\n\n\tmoveItemToUp(item: Item, listItemsNode, updateSort = true)\n\t{\n\t\tDom.insertBefore(item.getNode(), listItemsNode.firstElementChild);\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tmoveItemToDown(item, listItemsNode, updateSort = true)\n\t{\n\t\tDom.insertBefore(item.getNode(), listItemsNode.lastElementChild);\n\n\t\tif (updateSort)\n\t\t{\n\t\t\tthis.updateItemsSort(item, listItemsNode);\n\t\t}\n\t}\n\n\tupdateItemsSort(item: Item, listItemsNode: HTMLElement)\n\t{\n\t\tthis.requestSender.updateItemSort({\n\t\t\titemIds: [item.getId()],\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(listItemsNode, new Set([item.getId()]))\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tmoveInCurrentContainer(itemIds: Set<Item>, entity: Entity)\n\t{\n\t\treturn this.requestSender.updateItemSort({\n\t\t\tsortInfo: this.calculateSort(entity.getListItemsNode(), itemIds)\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tmoveInAnotherContainer(itemIds: Set<Item>, sourceEntity: Entity, endEntity: Entity)\n\t{\n\t\tthis.requestSender.updateItemSort({\n\t\t\tentityId: endEntity.getId(),\n\t\t\titemIds: Array.from(itemIds),\n\t\t\tsortInfo: this.calculateSort(endEntity.getListItemsNode(), itemIds, true)\n\t\t})\n\t\t\t.then(() => this.updateEntityCounters(sourceEntity, endEntity))\n\t\t\t.catch((response) => this.requestSender.showErrorAlert(response))\n\t\t;\n\t}\n\n\tupdateEntityCounters(sourceEntity: Entity, endEntity?: Entity)\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(sourceEntity.getId(), sourceEntity);\n\t\tif (endEntity)\n\t\t{\n\t\t\tentities.set(endEntity.getId(), endEntity);\n\t\t}\n\n\t\tthis.entityCounters.updateCounters(entities);\n\t}\n\n\tcalculateSort(container, updatedItemsIds?: Set, moveToAnotherEntity = false): ItemsSortInfo\n\t{\n\t\tconst listSortInfo = {};\n\n\t\tconst items = [...container.querySelectorAll('[data-sort]')];\n\t\tlet sort = 1;\n\t\titems.forEach((itemNode) => {\n\t\t\tconst itemId = parseInt(itemNode.dataset.id, 10);\n\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\tif (item && !item.isSubTask())\n\t\t\t{\n\t\t\t\tconst tmpId = Text.getRandom();\n\t\t\t\tlet isSortUpdated = (sort !== item.getSort());\n\t\t\t\titem.setSort(sort);\n\t\t\t\tlistSortInfo[itemId] = {\n\t\t\t\t\tsort: sort\n\t\t\t\t};\n\t\t\t\tif (moveToAnotherEntity)\n\t\t\t\t{\n\t\t\t\t\tlistSortInfo[itemId].entityId = container.dataset.entityId;\n\t\t\t\t\tisSortUpdated = true;\n\t\t\t\t}\n\t\t\t\tif (isSortUpdated && updatedItemsIds && updatedItemsIds.has(itemId))\n\t\t\t\t{\n\t\t\t\t\tlistSortInfo[itemId].tmpId = tmpId;\n\t\t\t\t\tlistSortInfo[itemId].updatedItemId = itemId;\n\t\t\t\t}\n\t\t\t\titemNode.dataset.sort = sort;\n\n\t\t\t\tsort++;\n\t\t\t}\n\t\t});\n\n\t\tthis.emit('calculateSort', listSortInfo);\n\n\t\treturn listSortInfo;\n\t}\n\n\tresortItems(entity: Entity)\n\t{\n\t\tlet sort = 1;\n\t\t[...entity.getListItemsNode().querySelectorAll('[data-sort]')]\n\t\t\t.forEach((itemNode: HTMLElement) => {\n\t\t\t\tconst itemId = parseInt(itemNode.dataset.id, 10);\n\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\tif (item && !item.isSubTask())\n\t\t\t\t{\n\t\t\t\t\titem.setSort(sort);\n\t\t\t\t\tsort++;\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\tmoveToAnotherEntity(entityFrom: Entity, item: Item, targetEntity: ?Entity, bindButton?: HTMLElement)\n\t{\n\t\tconst isMoveToSprint = (Type.isNull(targetEntity));\n\n\t\tconst sprints = (isMoveToSprint ? this.entityStorage.getSprintsAvailableForFilling(entityFrom) : null);\n\n\t\tif (isMoveToSprint)\n\t\t{\n\t\t\tif (sprints.size > 1)\n\t\t\t{\n\t\t\t\tthis.showListSprintsToMove(entityFrom, item, bindButton);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (sprints.size === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.planBuilder.createSprint().then((sprint: Sprint) => {\n\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tsprints.forEach((sprint: Sprint) => {\n\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\n\t\t\tthis.onMoveConfirm(entityFrom, message)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, targetEntity, item, false, false);\n\t\t\t\t})\n\t\t\t\t.catch(() => {})\n\t\t\t;\n\t\t}\n\t}\n\n\tmoveToWithGroupMode(entityFrom: Entity, entityTo: Entity, item?: Item, after = true, update = true)\n\t{\n\t\tconst groupModeItems = entityFrom.getGroupModeItems();\n\n\t\tif (item && !groupModeItems.has(item.getId()))\n\t\t{\n\t\t\tgroupModeItems.set(item.getId(), item);\n\t\t}\n\n\t\tconst sortedItems = [...groupModeItems.values()].sort((first: Item, second: Item) => {\n\t\t\tif (after)\n\t\t\t{\n\t\t\t\tif (first.getSort() > second.getSort()) return 1;\n\t\t\t\tif (first.getSort() < second.getSort()) return -1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (first.getSort() < second.getSort()) return 1;\n\t\t\t\tif (first.getSort() > second.getSort()) return -1;\n\t\t\t}\n\t\t});\n\n\t\tconst sortedItemsIds = new Set();\n\n\t\tsortedItems.forEach((groupModeItem: Item) => {\n\t\t\tthis.moveTo(entityFrom, entityTo, groupModeItem, after, update);\n\t\t\tsortedItemsIds.add(groupModeItem.getId());\n\t\t\tgroupModeItem.activateBlinking();\n\t\t});\n\n\t\tthis.scroller.scrollToItem(sortedItems.values().next().value);\n\n\t\tthis.requestSender.updateItemSort({\n\t\t\tentityId: entityTo.getId(),\n\t\t\titemIds: Array.from(sortedItemsIds),\n\t\t\tsortInfo: {\n\t\t\t\t...this.calculateSort(entityTo.getListItemsNode(), sortedItemsIds, true),\n\t\t\t\t...this.calculateSort(entityFrom.getListItemsNode(), new Set(), true)\n\t\t\t}\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.updateEntityCounters(entityFrom, entityTo);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\n\t\tentityFrom.deactivateGroupMode();\n\t\tentityTo.deactivateGroupMode();\n\t}\n\n\tmoveTo(entityFrom: Entity, entityTo: Entity, item: Item, after = true, update = true)\n\t{\n\t\tconst itemNode = item.getNode();\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\n\t\tif (item.isParentTask() && item.isShownSubTasks())\n\t\t{\n\t\t\titem.hideSubTasks();\n\t\t}\n\n\t\tif (after)\n\t\t{\n\t\t\tDom.insertBefore(itemNode, entityListNode.lastElementChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.insertBefore(itemNode, entityListNode.firstElementChild);\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\n\t\tif (update)\n\t\t{\n\t\t\tthis.onMoveItemUpdate(entityFrom, entityTo, item);\n\t\t}\n\t}\n\n\tmoveToPosition(entityFrom: Entity, entityTo: Entity, item: Item)\n\t{\n\t\tconst isMoveFromAnotherEntity = (entityFrom.getId() !== entityTo.getId());\n\n\t\tconst itemNode = item.getNode() ? item.getNode() : item.render();\n\t\tconst itemSort = item.getSort();\n\t\tconst itemPreviousSortSort = item.getPreviousSort();\n\n\t\tconst entityListNode = entityTo.getListItemsNode();\n\t\tconst bindItemNode = entityListNode.children[itemSort - 1];\n\n\t\tif (Dom.hasClass(bindItemNode, 'tasks-scrum__item'))\n\t\t{\n\t\t\tconst bindItemSort = parseInt(bindItemNode.dataset.sort, 10);\n\n\t\t\tconst bindItem = this.entityStorage.findItemByItemId(parseInt(bindItemNode.dataset.id, 10));\n\t\t\tif (bindItem.isParentTask() && bindItem.isShownSubTasks())\n\t\t\t{\n\t\t\t\tbindItem.hideSubTasks();\n\t\t\t}\n\n\t\t\tif (itemPreviousSortSort > 0 && bindItemSort >= itemPreviousSortSort)\n\t\t\t{\n\t\t\t\tif (isMoveFromAnotherEntity)\n\t\t\t\t{\n\t\t\t\t\tDom.insertBefore(itemNode, bindItemNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.planBuilder.appendItemAfterItem(itemNode, bindItemNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.insertBefore(itemNode, bindItemNode);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (entityTo.isEmpty())\n\t\t\t{\n\t\t\t\tDom.insertBefore(itemNode, entityTo.getLoaderNode());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (entityTo.isBacklog())\n\t\t\t\t{\n\t\t\t\t\tDom.insertBefore(itemNode, entityTo.getFirstItemNode());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.insertBefore(itemNode, entityTo.getLoaderNode());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.moveItemFromEntityToEntity(item, entityFrom, entityTo);\n\n\t\tthis.updateEntityCounters(entityFrom, entityTo);\n\n\t\tif (isMoveFromAnotherEntity)\n\t\t{\n\t\t\tthis.resortItems(entityFrom);\n\t\t}\n\t\tthis.resortItems(entityTo);\n\t}\n\n\tmoveItemFromEntityToEntity(item: Item, entityFrom: Entity, entityTo: Entity)\n\t{\n\t\tentityFrom.removeItem(item);\n\n\t\titem.setParentEntity(entityTo.getId(), entityTo.getEntityType());\n\n\t\tentityTo.setItem(item);\n\t}\n\n\tshowListSprintsToMove(entityFrom: Entity, item: Item, button: HTMLElement)\n\t{\n\t\tconst id = `item-sprint-action-${entityFrom.getEntityType() + entityFrom.getId() + item.getId()}`;\n\n\t\tif (this.moveToSprintMenu)\n\t\t{\n\t\t\tthis.moveToSprintMenu.getPopupWindow().close();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.moveToSprintMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button,\n\t\t\toffsetTop: 12,\n\t\t\toffsetLeft: -32\n\t\t});\n\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (!sprint.isCompleted() && !this.isSameSprint(entityFrom, sprint))\n\t\t\t{\n\t\t\t\tthis.moveToSprintMenu.addMenuItem({\n\t\t\t\t\ttext: sprint.getName(),\n\t\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\t\tlet message = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASK_FROM_ACTIVE');\n\t\t\t\t\t\tif (entityFrom.isGroupMode())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmessage = Loc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_MOVE_TASKS_FROM_ACTIVE');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.onMoveConfirm(entityFrom, message)\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tthis.moveToWithGroupMode(entityFrom, sprint, item, true, false);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(() => {})\n\t\t\t\t\t\t;\n\t\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.moveToSprintMenu.getPopupWindow().subscribe('onClose', () => {\n\t\t\tthis.moveToSprintMenu.destroy();\n\t\t\tthis.moveToSprintMenu = null;\n\t\t\tthis.emit('moveToSprintMenuClose');\n\t\t});\n\n\t\tthis.moveToSprintMenu.show();\n\t}\n\n\tisSameSprint(first: Sprint, second: Sprint): boolean\n\t{\n\t\treturn (first.getEntityType() === 'sprint' && first.getId() === second.getId());\n\t}\n\n\tshowMoveItemMenu(item, button, listToMove)\n\t{\n\t\tconst id = `item-move-${item.getId()}`;\n\n\t\tif (this.moveItemMenu)\n\t\t{\n\t\t\tthis.moveItemMenu.getPopupWindow().close();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.moveItemMenu = new Menu({\n\t\t\tid: id,\n\t\t\tbindElement: button,\n\t\t\toffsetTop: 12,\n\t\t\toffsetLeft: -28\n\t\t});\n\n\t\tlistToMove.forEach((item) => {\n\t\t\tthis.moveItemMenu.addMenuItem(item);\n\t\t});\n\n\t\tthis.moveItemMenu.getPopupWindow().subscribe('onClose', () => {\n\t\t\tthis.moveItemMenu.destroy();\n\t\t\tthis.moveItemMenu = null;\n\t\t\tthis.emit('moveMenuClose');\n\t\t});\n\n\t\tthis.moveItemMenu.show();\n\t}\n\n\thasActionPanelDialog(): boolean\n\t{\n\t\treturn (this.moveItemMenu || this.moveToSprintMenu)\n\t}\n\n\tcloseActionPanelDialogs()\n\t{\n\t\tif (this.moveItemMenu)\n\t\t{\n\t\t\tthis.moveItemMenu.getPopupWindow().close();\n\t\t}\n\n\t\tif (this.moveToSprintMenu)\n\t\t{\n\t\t\tthis.moveToSprintMenu.getPopupWindow().close();\n\t\t}\n\t}\n}\n","import {Item} from './item';\n\nimport {Entity} from '../entity/entity';\nimport {EntityStorage} from '../entity/entity.storage';\n\nimport {RequestSender} from '../utility/request.sender';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage\n}\n\nexport class ItemDesigner\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\n\t\tthis.listAllUsedColors = new Set();\n\n\t\tthis.randomColorCount = 0;\n\t\tthis.defaultColor = '#2ECEFF';\n\t}\n\n\tgetRandomColorForItemBorder(): Promise\n\t{\n\t\tthis.randomColorCount = 0;\n\n\t\treturn this.getAllUsedColors().then(() => {\n\t\t\treturn this.getRandomColor(this.getAllColors());\n\t\t});\n\t}\n\n\tgetAllColors(): Array\n\t{\n\t\treturn [\n\t\t\t'#2ECEFF', '#10E5FC', '#A5DE00', '#EEC202',\n\t\t\t'#AD8F47', '#FF5B55', '#EF3001', '#F968B6',\n\t\t\t'#6B52CC', '#07BAB1', '#5CD1DF', '#A1A6AC',\n\t\t\t'#949DA9', '#01A64C', '#B02FB0', '#EF008B',\n\t\t\t'#0202FF', '#555555', '#C4C4C4', '#AAAAAA',\n\t\t\t'#F89675', '#C5E099', '#7ECB9C', '#78CDCA',\n\t\t\t'#887FC0', '#BD8AC0', '#F6989C', '#F26A47',\n\t\t\t'#ABD46B', '#00BBB4', '#3FB2CD', '#5471B9',\n\t\t\t'#3E8BCD', '#A861AB', '#F26A7B', '#9E0402',\n\t\t\t'#A46200', '#578520', '#01736A', '#0175A6',\n\t\t\t'#033172', '#460763', '#630260', '#9F0137',\n\t\t\t'#B7EB81', '#FFA900', '#F7A700', '#333333',\n\t\t\t'#EDEEF0', '#E1F3F9'\n\t\t];\n\t}\n\n\tgetRandomColor(allColors: Array): string\n\t{\n\t\tthis.randomColorCount++;\n\n\t\tif (this.randomColorCount >= allColors.length)\n\t\t{\n\t\t\treturn this.defaultColor;\n\t\t}\n\n\t\tconst randomColor = allColors[Math.floor(Math.random() * allColors.length)];\n\n\t\tif (this.isThisBorderColorAlreadyUse(randomColor))\n\t\t{\n\t\t\treturn this.getRandomColor(allColors);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn randomColor;\n\t\t}\n\t}\n\n\tisThisBorderColorAlreadyUse(color: string): boolean\n\t{\n\t\tlet isAlreadyUse = false;\n\n\t\tthis.listAllUsedColors\n\t\t\t.forEach((usedColor: string) => {\n\t\t\t\tif (usedColor === color)\n\t\t\t\t{\n\t\t\t\t\tisAlreadyUse = true;\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\treturn isAlreadyUse;\n\t}\n\n\tgetAllUsedColors(): Promise\n\t{\n\t\tconst entityIds = new Set();\n\t\tthis.entityStorage.getAllEntities()\n\t\t\t.forEach((entity: Entity) => {\n\t\t\t\tif (!entity.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tentityIds.add(entity.getId());\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\treturn this.requestSender.getAllUsedItemBorderColors({\n\t\t\tentityIds: [...entityIds.values()]\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tthis.listAllUsedColors = new Set(response.data);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tupdateBorderColor(items: Set<Item>)\n\t{\n\t\tconst itemIdsToUpdateColor = new Set();\n\n\t\titems.forEach((item: Item) => {\n\t\t\tif (item.isLinkedTask() && !item.getBorderColor())\n\t\t\t{\n\t\t\t\titemIdsToUpdateColor.add(item.getId());\n\t\t\t}\n\t\t});\n\n\t\tif (itemIdsToUpdateColor.size)\n\t\t{\n\t\t\tthis.getAllUsedColors().then(() => {\n\t\t\t\tconst items = new Map();\n\t\t\t\titemIdsToUpdateColor.forEach((itemId: number) => {\n\t\t\t\t\titems.set(itemId, this.getRandomColor(this.getAllColors()));\n\t\t\t\t});\n\n\t\t\t\tthis.requestSender.updateBorderColorToLinkedItems({\n\t\t\t\t\titems: Object.fromEntries(items)\n\t\t\t\t})\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tconst updatedItems = response.data;\n\t\t\t\t\t\tObject.keys(updatedItems).forEach((itemId: number) => {\n\t\t\t\t\t\t\tconst borderColor = updatedItems[itemId];\n\t\t\t\t\t\t\tconst item = this.entityStorage.findItemByItemId(itemId);\n\t\t\t\t\t\t\titem.setBorderColor(borderColor);\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t});\n\t\t}\n\t}\n}","import {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Filter} from '../service/filter';\nimport {SidePanel} from '../service/side.panel';\n\nimport {EntityStorage} from '../entity/entity.storage';\n\nimport {TagSearcher} from '../utility/tag.searcher';\n\nimport type {EpicType} from '../item/task/epic';\n\ntype Params = {\n\tgroupId: number,\n\tentityStorage: EntityStorage,\n\tsidePanel: SidePanel,\n\tfilter: Filter,\n\ttagSearcher: TagSearcher,\n}\n\nexport class Epic extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Epic.Helper');\n\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.filter = params.filter;\n\t\tthis.tagSearcher = params.tagSearcher;\n\n\t\tthis.subscribeToExtension();\n\t}\n\n\tsubscribeToExtension()\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Tasks.Scrum.Epic:afterAdd',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tthis.onAfterAdd(baseEvent);\n\t\t\t})\n\t\t;\n\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Tasks.Scrum.Epic:afterEdit',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tthis.onAfterEdit(baseEvent);\n\t\t\t})\n\t\t;\n\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Tasks.Scrum.Epic:filterByTag',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tthis.emit('filterByTag', baseEvent.getData())\n\t\t\t})\n\t\t;\n\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Tasks.Scrum.Epic:afterRemove',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tthis.onAfterRemove(baseEvent);\n\t\t\t})\n\t\t;\n\t}\n\n\topenAddForm(): Promise\n\t{\n\t\treturn this.sidePanel.showByExtension(\n\t\t\t'Epic',\n\t\t\t{\n\t\t\t\tview: 'add',\n\t\t\t\tgroupId: this.groupId\n\t\t\t}\n\t\t);\n\t}\n\n\tonAfterAdd(baseEvent: BaseEvent)\n\t{\n\t\tconst epic: EpicType = baseEvent.getData();\n\n\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\n\t\tthis.filter.addItemToListTypeField('EPIC', {\n\t\t\tNAME: epic.name.trim(),\n\t\t\tVALUE: String(epic.id)\n\t\t});\n\t}\n\n\tonAfterEdit(baseEvent: BaseEvent)\n\t{\n\t\tconst epic: EpicType = baseEvent.getData();\n\n\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\tconst itemEpic = item.getEpic().getValue();\n\t\t\tif (itemEpic && itemEpic.id === epic.id)\n\t\t\t{\n\t\t\t\titem.setEpic(epic);\n\t\t\t}\n\t\t});\n\n\t\tthis.tagSearcher.removeEpicFromSearcher(epic);\n\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t}\n\n\tonAfterRemove(baseEvent: BaseEvent)\n\t{\n\t\tconst epic: EpicType = baseEvent.getData();\n\n\t\tthis.entityStorage.getAllItems().forEach((item) => {\n\t\t\tconst itemEpic = item.getEpic().getValue();\n\t\t\tif (itemEpic && itemEpic.id === epic.id)\n\t\t\t{\n\t\t\t\titem.setEpic();\n\t\t\t}\n\t\t});\n\n\t\tthis.tagSearcher.removeEpicFromSearcher(epic);\n\t}\n}","import {Type} from 'main.core';\n\nimport {PlanBuilder} from '../view/plan/plan.builder';\n\nimport {EntityStorage} from '../entity/entity.storage';\nimport {Sprint} from '../entity/sprint/sprint';\nimport {Item} from '../item/item';\n\nimport {RequestSender} from '../utility/request.sender';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tplanBuilder: PlanBuilder,\n\tentityStorage: EntityStorage,\n\tgroupId: number,\n\tcanStartSprint: boolean,\n\tcanCompleteSprint: boolean\n}\n\ntype PushParams = {\n\tid: number,\n\tgroupId: number,\n\ttmpId?: string\n}\n\nexport class PullSprint\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.planBuilder = params.planBuilder;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tsprintAdded: this.onSprintAdded.bind(this),\n\t\t\tsprintUpdated: this.onSprintUpdated.bind(this),\n\t\t\tsprintRemoved: this.onSprintRemoved.bind(this)\n\t\t};\n\t}\n\n\tonSprintAdded(params: PushParams)\n\t{\n\t\tif (this.groupId !== params.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.needSkipAdd(params.tmpId))\n\t\t{\n\t\t\tthis.cleanSkipAdd(params.tmpId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.getSprintData({\n\t\t\tsprintId: params.id\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tresponse.data.items = [];\n\t\t\t\tconst sprint = Sprint.buildSprint(response.data);\n\t\t\t\tthis.planBuilder.createSprintNode(sprint);\n\t\t\t})\n\t\t\t.catch((response) => {})\n\t\t;\n\t}\n\n\tonSprintUpdated(params: PushParams)\n\t{\n\t\tif (this.groupId !== params.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.needSkipUpdate(params.id))\n\t\t{\n\t\t\tthis.cleanSkipUpdate(params.id);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.getSprintData({\n\t\t\tsprintId: params.id\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tresponse.data.items = [];\n\t\t\t\tconst tmpSprint = Sprint.buildSprint(response.data);\n\t\t\t\tconst sprint: Sprint = this.entityStorage.findEntityByEntityId(tmpSprint.getId());\n\t\t\t\tif (sprint)\n\t\t\t\t{\n\t\t\t\t\tconst currentStatus = sprint.getStatus();\n\n\t\t\t\t\tsprint.updateYourself(tmpSprint);\n\n\t\t\t\t\tif (tmpSprint.getStatus() !== currentStatus)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (tmpSprint.getStatus() === 'active')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.planBuilder.moveSprintToActiveListNode(sprint);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (tmpSprint.getStatus() === 'completed')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsprint.getItems()\n\t\t\t\t\t\t\t\t.forEach((item: Item) => {\n\t\t\t\t\t\t\t\t\tif (item.isShownSubTasks())\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\titem.hideSubTasks();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tsprint.removeItem(item);\n\t\t\t\t\t\t\t\t\titem.removeYourself();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\tsprint.setBlank(sprint);\n\t\t\t\t\t\t\tsprint.hideContent();\n\n\t\t\t\t\t\t\tthis.planBuilder.moveSprintToCompletedListNode(sprint);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.planBuilder.updatePlannedSprints(\n\t\t\t\t\t\tthis.entityStorage.getPlannedSprints(),\n\t\t\t\t\t\t(!Type.isUndefined(this.entityStorage.getActiveSprint()))\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.planBuilder.updateSprintContainers();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {})\n\t\t;\n\t}\n\n\tonSprintRemoved(params: PushParams)\n\t{\n\t\tif (this.groupId !== params.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.needSkipRemove(params.id))\n\t\t{\n\t\t\tthis.cleanSkipRemove(params.id);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst sprint = this.entityStorage.findEntityByEntityId(params.id);\n\t\tif (sprint)\n\t\t{\n\t\t\tsprint.removeYourself();\n\n\t\t\tthis.entityStorage.removeSprint(sprint.getId());\n\t\t}\n\t}\n\n\taddTmpIdToSkipAdding(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.add(tmpId);\n\t}\n\n\taddIdToSkipUpdating(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipUpdating.add(sprintId);\n\t}\n\n\taddIdToSkipRemoving(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.add(sprintId);\n\t}\n\n\tneedSkipAdd(tmpId: string): boolean\n\t{\n\t\treturn this.listIdsToSkipAdding.has(tmpId);\n\t}\n\n\tcleanSkipAdd(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.delete(tmpId);\n\t}\n\n\tneedSkipUpdate(sprintId: number): boolean\n\t{\n\t\treturn this.listIdsToSkipUpdating.has(sprintId);\n\t}\n\n\tcleanSkipUpdate(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipUpdating.delete(sprintId);\n\t}\n\n\tneedSkipRemove(sprintId: number): boolean\n\t{\n\t\treturn this.listIdsToSkipRemoving.has(sprintId);\n\t}\n\n\tcleanSkipRemove(sprintId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.delete(sprintId);\n\t}\n}","import {Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {EntityStorage} from '../entity/entity.storage';\n\nimport {Item, ItemParams} from '../item/item';\nimport {ItemMover, ItemsSortInfo} from '../item/item.mover';\n\nimport {EntityCounters} from '../counters/entity.counters';\n\nimport {RequestSender} from '../utility/request.sender';\nimport {TagSearcher} from '../utility/tag.searcher';\n\nimport {Entity} from '../entity/entity';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tentityCounters: EntityCounters,\n\ttagSearcher: TagSearcher,\n\titemMover: ItemMover,\n\tcurrentUserId: number,\n\tgroupId: number\n}\n\ntype PushParams = {\n\tid: number,\n\tgroupId: number,\n\ttmpId?: string\n}\n\nexport class PullItem\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.entityCounters = params.entityCounters;\n\t\tthis.tagSearcher = params.tagSearcher;\n\t\tthis.itemMover = params.itemMover;\n\t\tthis.currentUserId = params.currentUserId;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.listToAddAfterUpdate = new Set();\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t\tthis.listIdsToSkipSorting = new Set();\n\n\t\tthis.itemMover.subscribe('calculateSort', this.onCalculateSort.bind(this));\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap(): Object\n\t{\n\t\treturn {\n\t\t\titemAdded: this.onItemAdded.bind(this),\n\t\t\titemUpdated: this.onItemUpdated.bind(this),\n\t\t\titemRemoved: this.onItemRemoved.bind(this),\n\t\t\titemSortUpdated: this.onItemSortUpdated.bind(this),\n\t\t\tcomment_add: this.onCommentAdd.bind(this)\n\t\t};\n\t}\n\n\tonItemAdded(params: PushParams)\n\t{\n\t\tif (this.groupId !== params.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setDelayedAdd(params.id);\n\n\t\tthis.externalAdd(params.id)\n\t\t\t.finally(() => this.cleanDelayedAdd(params.id))\n\t\t\t.then(() => {\n\t\t\t\tthis.requestSender.getItemData({\n\t\t\t\t\titemIds: [params.id]\n\t\t\t\t})\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tconst itemData = response.data\n\t\t\t\t\t\t\t.find((itemData: ItemParams) => itemData.id === params.id)\n\t\t\t\t\t\t;\n\t\t\t\t\t\tconst item = Item.buildItem(itemData);\n\t\t\t\t\t\tthis.addItemToEntity(item);\n\t\t\t\t\t})\n\t\t\t\t\t.catch((response) => {})\n\t\t\t\t;\n\t\t\t})\n\t\t\t.catch(() => {})\n\t\t;\n\t}\n\n\tonItemUpdated(params: PushParams)\n\t{\n\t\tif (this.groupId !== params.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.getItemData({\n\t\t\titemIds: [params.id]\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tconst itemData = response.data\n\t\t\t\t\t.find((itemData: ItemParams) => itemData.id === params.id)\n\t\t\t\t;\n\t\t\t\tconst item = Item.buildItem(itemData);\n\n\t\t\t\tif (this.isDelayedAdd(item.getId()))\n\t\t\t\t{\n\t\t\t\t\tthis.cleanDelayedAdd(item.getId());\n\n\t\t\t\t\tif (this.needSkipAdd(params.tmpId))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.cleanSkipAdd(params.tmpId);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.addItemToEntity(item);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.needSkipUpdate(item))\n\t\t\t\t{\n\t\t\t\t\tthis.cleanSkipUpdate(item);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.updateItem(item);\n\t\t\t})\n\t\t\t.catch((response) => {})\n\t\t;\n\t}\n\n\tonItemRemoved(params: PushParams)\n\t{\n\t\tif (this.groupId !== params.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.needSkipRemove(params.id))\n\t\t{\n\t\t\tthis.cleanSkipRemove(params.id);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = this.entityStorage.findItemByItemId(params.id);\n\t\tif (item)\n\t\t{\n\t\t\tconst entity = this.entityStorage.findEntityByItemId(item.getId());\n\t\t\tentity.removeItem(item);\n\t\t\titem.removeYourself();\n\n\t\t\tthis.updateEntityCounters(entity);\n\t\t}\n\t}\n\n\tonItemSortUpdated(itemsSortInfo: ItemsSortInfo)\n\t{\n\t\tconst itemsInfoToSort = new Map();\n\n\t\tObject.entries(itemsSortInfo).forEach(([itemId, info]) => {\n\t\t\tif (!this.needSkipSort(info.tmpId))\n\t\t\t{\n\t\t\t\titemsInfoToSort.set(parseInt(itemId, 10), info);\n\t\t\t}\n\t\t\tthis.cleanSkipRemove(info.tmpId);\n\t\t});\n\n\t\tif (itemsInfoToSort.size === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.getItemData({\n\t\t\titemIds: [...itemsInfoToSort.keys()]\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tconst itemsToSort = new Map();\n\t\t\t\tconst newItems = new Set();\n\t\t\t\tresponse.data\n\t\t\t\t\t.forEach((itemData: ItemParams) => {\n\t\t\t\t\t\tlet item = this.entityStorage.findItemByItemId(itemData.id);\n\t\t\t\t\t\tif (!item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem = Item.buildItem(itemData);\n\t\t\t\t\t\t\tnewItems.add(item.getId());\n\t\t\t\t\t\t}\n\t\t\t\t\t\titemsToSort.set(item.getId(), item);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t\titemsToSort.forEach((item: Item) => {\n\t\t\t\t\tconst itemInfoToSort = itemsInfoToSort.get(item.getId());\n\t\t\t\t\tif (item.isParentTask() && item.isShownSubTasks())\n\t\t\t\t\t{\n\t\t\t\t\t\titem.hideSubTasks();\n\t\t\t\t\t}\n\t\t\t\t\titem.setSort(itemInfoToSort.sort);\n\t\t\t\t\tif (newItems.has(item.getId()))\n\t\t\t\t\t{\n\t\t\t\t\t\titem.setPreviousSort(0);\n\t\t\t\t\t}\n\t\t\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\t\tif (sourceEntity)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst targetEntityId = (\n\t\t\t\t\t\t\tType.isUndefined(itemInfoToSort.entityId)\n\t\t\t\t\t\t\t\t? item.getEntityId()\n\t\t\t\t\t\t\t\t: itemInfoToSort.entityId\n\t\t\t\t\t\t);\n\t\t\t\t\t\tlet targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\t\t\t\t\t\tif (!targetEntity || sourceEntity.getId() === targetEntity.getId())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttargetEntity = sourceEntity;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.itemMover.moveToPosition(sourceEntity, targetEntity, item);\n\t\t\t\t\t\tthis.entityStorage.recalculateItemsSort();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((response) => {})\n\t\t;\n\t}\n\n\tonCommentAdd(params)\n\t{\n\t\tconst participants = Type.isArray(params.participants) ? params.participants : [];\n\n\t\tif (participants.includes(this.currentUserId.toString()))\n\t\t{\n\t\t\tconst xmlId = params.entityXmlId.split('_');\n\t\t\tif (xmlId)\n\t\t\t{\n\t\t\t\tconst entityType = xmlId[0];\n\t\t\t\tconst taskId = xmlId[1];\n\t\t\t\tconst item = this.entityStorage.findItemBySourceId(taskId);\n\t\t\t\tif (entityType === 'TASK' && item)\n\t\t\t\t{\n\t\t\t\t\tthis.requestSender.getCurrentState({\n\t\t\t\t\t\ttaskId: item.getSourceId()\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tconst tmpItem = Item.buildItem(response.data.itemData);\n\t\t\t\t\t\tthis.updateItem(tmpItem, item);\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddItemToEntity(item: Item)\n\t{\n\t\tif (item.isSubTask())\n\t\t{\n\t\t\tconst parentItem = this.entityStorage.findItemBySourceId(item.getParentTaskId());\n\n\t\t\tif (parentItem && !parentItem.isDecompositionMode())\n\t\t\t{\n\t\t\t\tparentItem.hideSubTasks();\n\t\t\t\tparentItem.cleanSubTasks();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.requestSender.hasTaskInFilter({\n\t\t\ttaskId: item.getSourceId()\n\t\t}).then((response) => {\n\t\t\tif (!response.data.has)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\tif (!entity)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst existingItem = this.entityStorage.findItemBySourceId(item.getSourceId());\n\t\t\tif (existingItem)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.itemMover.moveToPosition(entity, entity, item);\n\t\t\tthis.entityStorage.recalculateItemsSort();\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tupdateItem(tmpItem: Item, item?: Item)\n\t{\n\t\tif (!item)\n\t\t{\n\t\t\titem = this.entityStorage.findItemByItemId(tmpItem.getId());\n\t\t}\n\n\t\tif (item)\n\t\t{\n\t\t\tconst isParentChangeAction = tmpItem.isSubTask() !== item.isSubTask();\n\t\t\tif (isParentChangeAction)\n\t\t\t{\n\t\t\t\tif (tmpItem.isSubTask())\n\t\t\t\t{\n\t\t\t\t\tconst entity = this.entityStorage.findEntityByItemId(item.getId());\n\t\t\t\t\tentity.removeItem(item);\n\t\t\t\t\titem.removeYourself();\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst targetEntityId = tmpItem.getEntityId();\n\t\t\tconst sourceEntityId = item.getEntityId();\n\t\t\tconst targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\t\t\tconst sourceEntity = this.entityStorage.findEntityByEntityId(sourceEntityId);\n\n\t\t\tif (tmpItem.getEntityId() !== item.getEntityId())\n\t\t\t{\n\t\t\t\tif (targetEntity && sourceEntity)\n\t\t\t\t{\n\t\t\t\t\tthis.itemMover.moveToPosition(sourceEntity, targetEntity, item);\n\t\t\t\t\tthis.entityStorage.recalculateItemsSort();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.updateEntityCounters(targetEntity);\n\t\t\t}\n\n\t\t\titem.updateYourself(tmpItem);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (tmpItem.isSubTask())\n\t\t\t{\n\t\t\t\tconst targetEntityId = tmpItem.getEntityId();\n\t\t\t\tconst targetEntity = this.entityStorage.findEntityByEntityId(targetEntityId);\n\n\t\t\t\tthis.updateEntityCounters(targetEntity);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.addItemToEntity(tmpItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateEntityCounters(sourceEntity: Entity, endEntity?: Entity)\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(sourceEntity.getId(), sourceEntity);\n\t\tif (endEntity)\n\t\t{\n\t\t\tentities.set(endEntity.getId(), endEntity);\n\t\t}\n\n\t\tthis.entityCounters.updateCounters(entities);\n\t}\n\n\tonCalculateSort(baseEvent: BaseEvent)\n\t{\n\t\tconst listSortInfo = baseEvent.getData();\n\n\t\tObject.entries(listSortInfo).forEach(([itemId, info]) => {\n\t\t\tif (Object.prototype.hasOwnProperty.call(info, 'tmpId'))\n\t\t\t{\n\t\t\t\tthis.addTmpIdToSkipSorting(info.tmpId);\n\t\t\t}\n\t\t});\n\t}\n\n\taddTmpIdToSkipAdding(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.add(tmpId);\n\t}\n\n\taddIdToSkipUpdating(itemId: string)\n\t{\n\t\tthis.listIdsToSkipUpdating.add(itemId);\n\t}\n\n\taddIdToSkipRemoving(itemId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.add(itemId);\n\t}\n\n\taddTmpIdToSkipSorting(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipSorting.add(tmpId);\n\t}\n\n\texternalAdd(itemId: number): boolean\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tsetTimeout(() => (this.isDelayedAdd(itemId) ? resolve() : reject()), 3000);\n\t\t});\n\t}\n\n\tisDelayedAdd(itemId: number): boolean\n\t{\n\t\treturn this.listToAddAfterUpdate.has(itemId);\n\t}\n\n\tsetDelayedAdd(itemId: number)\n\t{\n\t\tthis.listToAddAfterUpdate.add(itemId);\n\t}\n\n\tcleanDelayedAdd(itemId: number)\n\t{\n\t\tthis.listToAddAfterUpdate.delete(itemId);\n\t}\n\n\tneedSkipAdd(tmpId: string): boolean\n\t{\n\t\treturn this.listIdsToSkipAdding.has(tmpId);\n\t}\n\n\tcleanSkipAdd(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipAdding.delete(tmpId);\n\t}\n\n\tneedSkipUpdate(item: Item): boolean\n\t{\n\t\treturn this.listIdsToSkipUpdating.has(item.getId());\n\t}\n\n\tcleanSkipUpdate(item: Item)\n\t{\n\t\tthis.listIdsToSkipUpdating.delete(item.getId());\n\t}\n\n\tneedSkipRemove(itemId: number): boolean\n\t{\n\t\treturn this.listIdsToSkipRemoving.has(itemId);\n\t}\n\n\tcleanSkipRemove(itemId: number)\n\t{\n\t\tthis.listIdsToSkipRemoving.delete(itemId);\n\t}\n\n\tneedSkipSort(tmpId: string): boolean\n\t{\n\t\treturn this.listIdsToSkipSorting.has(tmpId);\n\t}\n\n\tcleanSkipSort(tmpId: string)\n\t{\n\t\tthis.listIdsToSkipSorting.delete(tmpId);\n\t}\n}","import {EntityStorage} from '../entity/entity.storage';\n\nimport {BaseEvent} from 'main.core.events';\n\nimport {RequestSender} from '../utility/request.sender';\n\nimport {Epic} from '../epic/epic';\n\nimport type {EpicType} from '../item/task/epic';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tepic: Epic\n}\n\nexport class PullEpic\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.epic = params.epic;\n\n\t\tthis.listIdsToSkipAdding = new Set();\n\t\tthis.listIdsToSkipUpdating = new Set();\n\t\tthis.listIdsToSkipRemoving = new Set();\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\tepicAdded: this.onEpicAdded.bind(this),\n\t\t\tepicUpdated: this.onEpicUpdated.bind(this),\n\t\t\tepicRemoved: this.onEpicRemoved.bind(this)\n\t\t};\n\t}\n\n\tonEpicAdded(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterAdd((new BaseEvent()).setData(epicData));\n\t}\n\n\tonEpicUpdated(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterEdit((new BaseEvent()).setData(epicData));\n\t}\n\n\tonEpicRemoved(epicData: EpicType)\n\t{\n\t\tthis.epic.onAfterRemove((new BaseEvent()).setData(epicData));\n\t}\n}","import {Filter} from '../service/filter';\n\nimport {EntityStorage} from '../entity/entity.storage';\n\nimport {Item} from '../item/item';\n\nimport {RequestSender} from '../utility/request.sender';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tfilterService: Filter,\n\tuserId: number,\n\tgroupId: number\n}\n\nexport class PullCounters\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.filterService = params.filterService;\n\t\tthis.userId = params.userId;\n\t\tthis.groupId = params.groupId;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\ttask_view: this.onTaskView.bind(this),\n\t\t\tscrum_read_all: this.onCommentsReadAll.bind(this)\n\t\t};\n\t}\n\n\tonTaskView(data)\n\t{\n\t\tconst inputTaskId = parseInt(data.TASK_ID, 10);\n\t\tconst inputUserId = parseInt(data.USER_ID, 10);\n\n\t\tif (inputUserId !== this.userId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet item = this.entityStorage.findItemBySourceId(inputTaskId);\n\t\tif (!item)\n\t\t{\n\t\t\titem = this.entityStorage.findItemBySourceInFilteredCompletedSprints(inputTaskId);\n\t\t}\n\n\t\tif (item)\n\t\t{\n\t\t\tthis.requestSender.getCurrentState({\n\t\t\t\ttaskId: item.getSourceId()\n\t\t\t}).then((response) => {\n\t\t\t\titem.updateYourself(Item.buildItem(response.data.itemData));\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t}\n\t}\n\n\tonCommentsReadAll(data)\n\t{\n\t\tconst groupId = data.GROUP_ID;\n\n\t\tif (groupId && groupId === this.groupId)\n\t\t{\n\t\t\tthis.filterService.applyFilter();\n\t\t}\n\t}\n}","import {Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {PULL as Pull} from 'pull.client';\n\nimport {Filter} from '../service/filter';\n\nimport {EntityStorage} from '../entity/entity.storage';\n\nimport {RequestSender} from '../utility/request.sender';\n\nimport {PullCounters} from '../pull/pull.counters';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tfilter: Filter,\n\tisOwnerCurrentUser: boolean,\n\tuserId: number,\n\tgroupId: number\n}\n\nexport class TaskCounters\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.filterService = params.filter;\n\n\t\tthis.isOwnerCurrentUser = params.isOwnerCurrentUser;\n\n\t\tthis.userId = parseInt(params.userId, 10);\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\tthis.filter = this.filterService.getFilterManager();\n\n\t\tthis.updateFields();\n\t\tthis.bindEvents();\n\t\tthis.subscribeToPull();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t\tEventEmitter.subscribe('Tasks.Toolbar:onItem', this.onCounterClick.bind(this));\n\t}\n\n\tsubscribeToPull()\n\t{\n\t\tPull.subscribe(new PullCounters({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tfilterService: this.filterService,\n\t\t\tuserId: this.userId,\n\t\t\tgroupId: this.groupId\n\t\t}));\n\t}\n\n\tonFilterApply()\n\t{\n\t\tthis.updateFields();\n\t}\n\n\tupdateFields()\n\t{\n\t\tthis.fields = this.filter.getFilterFieldsValues();\n\t}\n\n\tonCounterClick(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\n\t\tif (data.counter && data.counter.filter)\n\t\t{\n\t\t\tthis.toggleByField({[data.counter.filterField]: data.counter.filterValue});\n\t\t}\n\t}\n\n\tisFilteredByField(field)\n\t{\n\t\tif (!Object.keys(this.fields).includes(field))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Type.isArray(this.fields[field]))\n\t\t{\n\t\t\treturn this.fields[field].length > 0;\n\t\t}\n\n\t\treturn this.fields[field] !== '';\n\t}\n\n\tisFilteredByFieldValue(field, value)\n\t{\n\t\treturn this.isFilteredByField(field) && this.fields[field] === value;\n\t}\n\n\ttoggleByField(field)\n\t{\n\t\tconst name = Object.keys(field)[0];\n\t\tconst value = field[name];\n\n\t\tif (!this.isFilteredByFieldValue(name, value))\n\t\t{\n\t\t\tthis.filter.getApi().extendFilter({[name]: value});\n\t\t\treturn;\n\t\t}\n\n\t\tthis.filter.getFilterFields().forEach((field) => {\n\t\t\tif (field.getAttribute('data-name') === name)\n\t\t\t{\n\t\t\t\tthis.filter.getFields().deleteField(field);\n\t\t\t}\n\t\t});\n\n\t\tthis.filter.getSearch().apply();\n\t}\n}","import {Type, Dom} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {BaseEvent} from 'main.core.events';\n\nimport {Filter} from '../service/filter';\n\nimport {PlanBuilder} from '../view/plan/plan.builder';\n\nimport {Entity} from '../entity/entity';\nimport {EntityStorage} from '../entity/entity.storage';\nimport {Sprint, SprintParams} from '../entity/sprint/sprint';\n\nimport {RequestSender} from './request.sender';\n\nimport {Item, ItemParams} from '../item/item';\n\ntype Params = {\n\tfilter: Filter,\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tplanBuilder: PlanBuilder,\n\tpageSize: number\n}\n\ntype ApplyFilterResponse = {\n\tdata: {\n\t\tisExactSearchApplied: 'Y' | 'N',\n\t\tcompletedSprints: Array<SprintParams>,\n\t\titems: Array<ItemParams>\n\t}\n}\n\nexport class FilterHandler\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.filter = params.filter;\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.planBuilder = params.planBuilder;\n\t\tthis.pageSize = params.pageSize;\n\n\t\tthis.filter.subscribe('applyFilter', this.onApplyFilter.bind(this));\n\t}\n\n\tonApplyFilter(baseEvent: BaseEvent)\n\t{\n\t\tthis.fadeOutAll();\n\n\t\tconst containerPosition = Dom.getPosition(this.planBuilder.getScrumContainer());\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.planBuilder.getScrumContainer(),\n\t\t\toffset: {\n\t\t\t\ttop: `${containerPosition.top / 2}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\tthis.requestSender.applyFilter({\n\t\t\tpageSize: this.pageSize\n\t\t}).then((response: ApplyFilterResponse) => {\n\n\t\t\tconst filteredItemsData = response.data.items;\n\n\t\t\tthis.entityStorage.getAllItems().forEach((item: Item) => {\n\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\tentity.removeItem(item);\n\t\t\t\tif (item.isShownSubTasks())\n\t\t\t\t{\n\t\t\t\t\titem.hideSubTasks();\n\t\t\t\t}\n\t\t\t\titem.removeYourself();\n\t\t\t});\n\n\t\t\tconst completedSprints = new Map();\n\n\t\t\tfilteredItemsData.forEach((itemParams: ItemParams) => {\n\t\t\t\tconst item = Item.buildItem(itemParams);\n\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\t\t\t\tif (response.data.completedSprints.length)\n\t\t\t\t{\n\t\t\t\t\tresponse.data.completedSprints\n\t\t\t\t\t\t.forEach((sprintParams: SprintParams) => {\n\t\t\t\t\t\t\tif (item.getEntityId() === sprintParams.id)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (completedSprints.has(item.getEntityId()))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcompletedSprints.get(item.getEntityId()).setItem(item);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst completedSprint = Sprint.buildSprint(sprintParams);\n\t\t\t\t\t\t\t\t\tcompletedSprint.setItem(item);\n\t\t\t\t\t\t\t\t\tcompletedSprint.setShortView('Y');\n\n\t\t\t\t\t\t\t\t\tcompletedSprints.set(completedSprint.getId(), completedSprint);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}\n\n\t\t\t\tif (entity && !entity.isCompleted())\n\t\t\t\t{\n\t\t\t\t\titem.setShortView(entity.getShortView());\n\n\t\t\t\t\tentity.appendItemToList(item);\n\t\t\t\t\tentity.setItem(item);\n\n\t\t\t\t\tentity.setActiveLoadItems(false);\n\t\t\t\t\tentity.bindItemsLoader();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst isExactSearchApplied = response.data.isExactSearchApplied === 'Y';\n\n\t\t\tthis.entityStorage.getAllEntities()\n\t\t\t\t.forEach((entity: Entity) => {\n\t\t\t\t\tentity.setExactSearchApplied(response.data.isExactSearchApplied);\n\t\t\t\t\tif (!entity.isCompleted() && entity.isEmpty())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (entity.getNumberTasks() > 0 && entity.isExactSearchApplied())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentity.showEmptySearchStub();\n\t\t\t\t\t\t\tentity.hideDropzone();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (this.entityStorage.existsAtLeastOneItem())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tentity.showDropzone();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tentity.hideEmptySearchStub();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!entity.isBacklog() && !entity.isCompleted())\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.setPageNumberItems(Math.ceil((entity.getNumberItems() / entity.getPageSize())));\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\n\t\t\tthis.planBuilder.hideEmptySearchStub();\n\n\t\t\tif (completedSprints.size)\n\t\t\t{\n\t\t\t\tthis.planBuilder.showFilteredCompletedSprints(completedSprints);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.planBuilder.hideFilteredCompletedSprints();\n\n\t\t\t\tif (isExactSearchApplied)\n\t\t\t\t{\n\t\t\t\t\tthis.planBuilder.showEmptySearchStub();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.fadeInAll();\n\n\t\t\tloader.hide();\n\t\t}).catch((response) => {\n\n\t\t\tthis.fadeInAll();\n\n\t\t\tloader.hide();\n\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tfadeOutAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeOut();\n\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tif (!sprint.isCompleted())\n\t\t\t{\n\t\t\t\tsprint.fadeOut();\n\t\t\t}\n\t\t});\n\t}\n\n\tfadeInAll()\n\t{\n\t\tthis.entityStorage.getBacklog().fadeIn();\n\n\t\tthis.entityStorage.getSprints().forEach((sprint: Sprint) => {\n\t\t\tif (!sprint.isCompleted())\n\t\t\t{\n\t\t\t\tsprint.fadeIn();\n\t\t\t}\n\t\t});\n\t}\n}","import {Item} from '../item/item';\n\ntype Params = {\n\tparentItem: Item\n}\n\nexport class Decomposition\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.parentItem = params.parentItem;\n\n\t\tthis.count = 1;\n\t}\n\n\tgetParentItem(): Item\n\t{\n\t\treturn this.parentItem;\n\t}\n\n\taddNumberDecompositionsPerformed()\n\t{\n\t\tthis.count++;\n\t}\n\n\tgetNumberDecompositionsPerformed(): number\n\t{\n\t\treturn this.count;\n\t}\n}\n","import { Filter } from '../service/filter';\n\nimport { EntityStorage } from '../entity/entity.storage';\n\nimport { RequestSender } from '../utility/request.sender';\n\ntype Params = {\n\trequestSender: RequestSender,\n\tentityStorage: EntityStorage,\n\tgroupId: number\n}\n\ntype PushParams = {\n\toldTagName: string,\n\tnewTagName: string,\n\tgroupId: number,\n\toldTagsNames: Array,\n}\n\nexport class PullTag\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.requestSender = params.requestSender;\n\t\tthis.entityStorage = params.entityStorage;\n\t\tthis.groupId = params.groupId;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap()\n\t{\n\t\treturn {\n\t\t\ttag_changed: this.onTagChanged.bind(this),\n\t\t};\n\t}\n\n\tonTagChanged(params: PushParams)\n\t{\n\t\tlet tagDialogs = BX.UI.EntitySelector.Dialog.getInstances();\n\t\ttagDialogs.forEach(dialog => {\n\t\t\tdialog.hide();\n\t\t});\n\t\tif (parseInt(this.groupId, 10) !== params.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.entityStorage.getBacklog().fadeOut();\n\n\t\tconst updatedTags = params.oldTagsNames;\n\t\tlet updatedTag = params.oldTagName;\n\t\tconst newTag = params.newTagName;\n\n\t\tconst items = this.entityStorage.getAllItems();\n\t\tconst itemsToUpdate = new Set();\n\t\titems.forEach((item: Item) => {\n\t\t\tconst tags = item.getTags().getValue();\n\t\t\tif (tags.find((tag: string) => tag === updatedTag))\n\t\t\t{\n\t\t\t\titemsToUpdate.add(item);\n\t\t\t}\n\t\t\tif (updatedTags)\n\t\t\t{\n\t\t\t\tupdatedTags.forEach(tag => {\n\t\t\t\t\tlet updatedTagFromArray = tag;\n\t\t\t\t\tif (tags.find((tag: string) => tag === updatedTagFromArray))\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.add(item);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t});\n\t\titemsToUpdate.forEach((item: Item) => {\n\t\t\tconst currentTags = item.getTags().getValue();\n\t\t\tcurrentTags.forEach((tag, index, array) => {\n\t\t\t\tif (updatedTags &&updatedTags.length !== 0 && updatedTags.find((tagInArr: string) => tag === tagInArr))\n\t\t\t\t{\n\t\t\t\t\tarray[index] = newTag;\n\t\t\t\t}\n\t\t\t\telse if (tag === updatedTag)\n\t\t\t\t{\n\t\t\t\t\tarray[index] = newTag;\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst newTags = [];\n\t\t\tcurrentTags.forEach(tag => {\n\t\t\t\tif (tag !== '')\n\t\t\t\t{\n\t\t\t\t\tnewTags.push(tag);\n\t\t\t\t}\n\t\t\t});\n\t\t\titem.setTags(newTags);\n\t\t});\n\t\tsetTimeout(() => {\n\t\t\tthis.entityStorage.getBacklog().fadeIn();\n\t\t}, 1000);\n\n\t}\n\n}","import {Type, Loc, Dom} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Loader} from 'main.loader';\nimport {Menu} from 'main.popup';\n\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nimport {ShortView} from 'ui.short-view';\n\nimport {DiskManager} from '../../service/disk.manager';\n\nimport {View, Views} from '../view';\n\nimport {PlanBuilder} from './plan.builder';\n\nimport {Entity} from '../../entity/entity';\nimport {ActionPanel} from '../../entity/action.panel';\nimport {EntityStorage} from '../../entity/entity.storage';\nimport {SearchItems} from '../../entity/search.items';\nimport {Backlog, BacklogParams} from '../../entity/backlog/backlog';\nimport {Header as BacklogHeader} from '../../entity/backlog/header';\nimport {Sprint, SprintParams} from '../../entity/sprint/sprint';\nimport {SprintMover} from '../../entity/sprint/sprint.mover';\nimport {SprintSidePanel} from '../../entity/sprint/sprint.side.panel';\n\nimport {Item, ItemParams} from '../../item/item';\nimport {SubTasks} from '../../item/task/sub.tasks';\nimport {ItemMover} from '../../item/item.mover';\nimport {ItemDesigner} from '../../item/item.designer';\n\nimport {Epic} from '../../epic/epic';\n\nimport {PULL as Pull} from 'pull.client';\n\nimport {PullSprint} from '../../pull/pull.sprint';\nimport {PullItem} from '../../pull/pull.item';\nimport {PullEpic} from '../../pull/pull.epic';\n\nimport {TaskCounters} from '../../counters/task.counters';\nimport {EntityCounters} from '../../counters/entity.counters';\n\nimport {FilterHandler} from '../../utility/filter.handler';\nimport {Input} from '../../utility/input';\nimport {TagSearcher} from '../../utility/tag.searcher';\nimport {Decomposition} from '../../utility/decomposition';\nimport {Tool} from '../../utility/tool';\n\nimport type {EpicType} from '../../item/task/epic';\nimport type {ResponsibleType} from '../../item/task/responsible';\n\nimport type {ShowLinkedTasksResponse} from '../../response';\nimport { PullTag } from '../../pull/pull.tag';\n\ntype Params = {\n\tpathToTask: string,\n\tpathToTaskCreate: string,\n\tpathToBurnDown: string,\n\tdefaultSprintDuration: number,\n\tactiveSprintId: number,\n\tbacklog: BacklogParams,\n\tsprints: Array<SprintParams>,\n\tviews: Views,\n\ttags: {\n\t\tepic: Array<EpicType>,\n\t\ttask: Array\n\t},\n\tdefaultResponsible: ResponsibleType,\n\tpageSize: number,\n\tisShortView: 'Y' | 'N',\n\tdisplayPriority: string,\n\tmandatoryExists: 'Y' | 'N',\n\tisExactSearchApplied: 'Y' | 'N'\n}\n\nexport class Plan extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.Plan');\n\n\t\tthis.pathToTask = params.pathToTask;\n\t\tthis.pathToTaskCreate = params.pathToTaskCreate;\n\t\tthis.pathToBurnDown = params.pathToBurnDown;\n\t\tthis.mandatoryExists = params.mandatoryExists === 'Y';\n\t\tthis.defaultResponsible = params.defaultResponsible;\n\t\tthis.pageSize = parseInt(params.pageSize, 10);\n\t\tthis.activeSprintId = parseInt(params.activeSprintId, 10);\n\t\tthis.views = params.views;\n\t\tthis.isShortView = params.isShortView;\n\t\tthis.displayPriority = params.displayPriority;\n\t\tthis.isExactSearchApplied = params.isExactSearchApplied;\n\n\t\tthis.entityStorage = new EntityStorage();\n\t\tthis.entityStorage.addBacklog(Backlog.buildBacklog(params.backlog));\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tsprintData.defaultSprintDuration = params.defaultSprintDuration;\n\t\t\tsprintData.isShortView = params.isShortView;\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.entityStorage.addSprint(sprint);\n\t\t});\n\n\t\tthis.entityCounters = new EntityCounters({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.taskCounters = new TaskCounters({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tfilter: this.filter,\n\t\t\tuserId: params.userId,\n\t\t\tgroupId: params.groupId,\n\t\t\tisOwnerCurrentUser: params.isOwnerCurrentUser\n\t\t});\n\n\t\tthis.tagSearcher = new TagSearcher({\n\t\t\trequestSender: this.requestSender,\n\t\t\tfilter: this.filter,\n\t\t\tgroupId: params.groupId,\n\t\t\ttagsAreConverting: params.tagsAreConverting,\n\t\t});\n\t\tObject.values(params.tags.epic).forEach((epic) => {\n\t\t\tthis.tagSearcher.addEpicToSearcher(epic);\n\t\t});\n\n\t\tthis.planBuilder = new PlanBuilder({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tdefaultSprintDuration: params.defaultSprintDuration,\n\t\t\tpageNumberToCompletedSprints: params.pageNumberToCompletedSprints,\n\t\t\tdisplayPriority: params.displayPriority,\n\t\t\tisShortView: params.isShortView,\n\t\t\tmandatoryExists: params.mandatoryExists,\n\t\t\tisExactSearchApplied: params.isExactSearchApplied\n\t\t});\n\t\tthis.planBuilder.subscribe('beforeCreateSprint', (baseEvent: BaseEvent) => {\n\t\t\tconst requestData = baseEvent.getData();\n\t\t\tthis.pullSprint.addTmpIdToSkipAdding(requestData.tmpId);\n\t\t});\n\t\tthis.planBuilder.subscribe(\n\t\t\t'createSprint',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tconst sprint: Sprint = baseEvent.getData();\n\t\t\t\tthis.subscribeToSprint(sprint);\n\t\t\t\tthis.itemMover.addSprintContainers(sprint);\n\t\t\t}\n\t\t);\n\t\tthis.planBuilder.subscribe(\n\t\t\t'createSprintNode',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tconst sprint: Sprint = baseEvent.getData();\n\t\t\t\tthis.subscribeToSprint(sprint);\n\t\t\t\tthis.itemMover.addSprintContainers(sprint);\n\t\t\t}\n\t\t);\n\t\tthis.planBuilder.subscribe('sprintsScroll', this.onActionPanelScroll.bind(this));\n\n\t\tthis.searchItems = new SearchItems({\n\t\t\tplanBuilder: this.planBuilder,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.sprintMover = new SprintMover({\n\t\t\trequestSender: this.requestSender,\n\t\t\tplanBuilder: this.planBuilder,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.itemMover = new ItemMover({\n\t\t\trequestSender: this.requestSender,\n\t\t\tplanBuilder: this.planBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tentityCounters: this.entityCounters\n\t\t});\n\n\t\tthis.itemDesigner = new ItemDesigner({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage\n\t\t});\n\n\t\tthis.filterHandler = new FilterHandler({\n\t\t\tfilter: this.filter,\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tplanBuilder: this.planBuilder,\n\t\t\tpageSize: this.pageSize\n\t\t});\n\n\t\tthis.epic = new Epic({\n\t\t\tgroupId: this.groupId,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tfilter: this.filter,\n\t\t\ttagSearcher: this.tagSearcher\n\t\t});\n\t\tthis.pullTag = new PullTag({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tgroupId: this.groupId\n\t\t});\n\t\tthis.pullSprint = new PullSprint({\n\t\t\trequestSender: this.requestSender,\n\t\t\tplanBuilder: this.planBuilder,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tgroupId: this.getCurrentGroupId()\n\t\t});\n\t\tthis.pullItem = new PullItem({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tentityCounters: this.entityCounters,\n\t\t\ttagSearcher: this.tagSearcher,\n\t\t\titemMover: this.itemMover,\n\t\t\tcurrentUserId: this.getCurrentUserId(),\n\t\t\tgroupId: this.getCurrentGroupId()\n\t\t});\n\t\tthis.pullEpic = new PullEpic({\n\t\t\trequestSender: this.requestSender,\n\t\t\tentityStorage: this.entityStorage,\n\t\t\tepic: this.epic,\n\t\t});\n\n\t\tthis.input = new Input();\n\t\tthis.input.subscribe('createTaskItem', this.onCreateTaskItem.bind(this));\n\t\tthis.input.subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tthis.input.subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tthis.input.subscribe('epicSearchOpen', this.onEpicSearchOpen.bind(this));\n\t\tthis.input.subscribe('epicSearchClose', this.onEpicSearchClose.bind(this));\n\t\tthis.input.subscribe('render', this.onRenderInput.bind(this));\n\t\tthis.input.subscribe('remove', this.onRemoveInput.bind(this));\n\n\t\tthis.actionPanel = null;\n\t\tthis.responsibleDialog = null;\n\n\t\tthis.bindHandlers();\n\n\t\tthis.subscribeToPull();\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tsuper.renderTo(container);\n\n\t\tthis.planBuilder.renderTo(container);\n\t}\n\n\trenderRightElementsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderRightElementsTo(container);\n\n\t\tconst shortView = new ShortView({\n\t\t\tisShortView: this.isShortView\n\t\t});\n\n\t\tshortView.renderTo(container);\n\t\tshortView.subscribe('change', this.onChangeShortView.bind(this));\n\t}\n\n\tsetDisplayPriority(value: string)\n\t{\n\t\tsuper.setDisplayPriority(value);\n\n\t\tthis.planBuilder.setWidthPriority(value);\n\n\t\tthis.requestSender.saveDisplayPriority({\n\t\t\tvalue: value\n\t\t})\n\t\t\t.then((response) => {})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tsubscribeToPull()\n\t{\n\t\tPull.subscribe(this.pullSprint);\n\t\tPull.subscribe(this.pullItem);\n\t\tPull.subscribe(this.pullEpic);\n\t\tPull.subscribe(this.pullTag);\n\t}\n\n\tbindHandlers()\n\t{\n\t\tthis.entityStorage.getBacklog().subscribe('showInput', this.onShowBacklogInput.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('openAddTaskForm', this.onOpenAddTaskForm.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('updateItem', this.onUpdateItem.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showTask', this.onShowTask.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('destroyActionPanel', this.onDestroyActionPanel.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('changeTaskResponsible', this.onChangeTaskResponsible.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('onShowResponsibleDialog', this.onShowResponsibleDialog.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('openAddEpicForm', this.onOpenEpicForm.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('epicSearchOpen', this.onEpicSearchOpen.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('epicSearchClose', this.onEpicSearchClose.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('filterByEpic', this.onFilterByEpic.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('filterByTag', this.onFilterByTag.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('loadItems', (baseEvent: BaseEvent) => {\n\t\t\tconst entity: Entity = baseEvent.getTarget();\n\t\t\tif (!this.loadItemsRepeatCounter.has(entity.getId()))\n\t\t\t{\n\t\t\t\tthis.loadItemsRepeatCounter.set(entity.getId(), 0);\n\t\t\t}\n\t\t\tthis.loadItems(entity);\n\t\t});\n\t\tthis.entityStorage.getBacklog().subscribe('toggleActionPanel', this.onToggleActionPanel.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showLinked', this.onShowLinked.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('itemsScroll', this.onActionPanelScroll.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('showBlank', this.onShowBlank.bind(this));\n\t\tthis.entityStorage.getBacklog().subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\n\t\tthis.entityStorage.getSprints().forEach((sprint) => this.subscribeToSprint(sprint));\n\n\t\tthis.epic.subscribe('filterByTag', this.onFilterByTag.bind(this));\n\n\t\tthis.itemMover.subscribe('dragStart', () => {\n\t\t\tthis.destroyActionPanel();\n\t\t\tif (this.searchItems.isActive())\n\t\t\t{\n\t\t\t\tthis.searchItems.stop();\n\t\t\t}\n\t\t});\n\n\t\tdocument.onkeydown = this.onDocumentKeyDown.bind(this);\n\t\tdocument.onclick = this.onDocumentClick.bind(this);\n\t}\n\n\tsubscribeToSprint(sprint: Sprint)\n\t{\n\t\tsprint.subscribe('showInput', this.onShowSprintInput.bind(this));\n\t\tsprint.subscribe('createSprint', this.onCreateSprint.bind(this));\n\t\tsprint.subscribe('updateItem', this.onUpdateItem.bind(this));\n\t\tsprint.subscribe('getSubTasks', this.onGetSubTasks.bind(this));\n\t\tsprint.subscribe('showTask', this.onShowTask.bind(this));\n\t\tsprint.subscribe('destroyActionPanel', this.onDestroyActionPanel.bind(this));\n\t\tsprint.subscribe('startSprint', this.onStartSprint.bind(this));\n\t\tsprint.subscribe('completeSprint', this.onCompleteSprint.bind(this));\n\t\tsprint.subscribe('changeTaskResponsible', this.onChangeTaskResponsible.bind(this));\n\t\tsprint.subscribe('onShowResponsibleDialog', this.onShowResponsibleDialog.bind(this));\n\t\tsprint.subscribe('removeSprint', this.onRemoveSprint.bind(this));\n\t\tsprint.subscribe('changeSprintName', this.onChangeSprintName.bind(this));\n\t\tsprint.subscribe('changeSprintDeadline', this.onChangeSprintDeadline.bind(this));\n\t\tsprint.subscribe('tagsSearchOpen', this.onTagsSearchOpen.bind(this));\n\t\tsprint.subscribe('tagsSearchClose', this.onTagsSearchClose.bind(this));\n\t\tsprint.subscribe('epicSearchOpen', this.onEpicSearchOpen.bind(this));\n\t\tsprint.subscribe('epicSearchClose', this.onEpicSearchClose.bind(this));\n\t\tsprint.subscribe('filterByEpic', this.onFilterByEpic.bind(this));\n\t\tsprint.subscribe('filterByTag', this.onFilterByTag.bind(this));\n\t\tsprint.subscribe('getSprintCompletedItems', this.onGetSprintCompletedItems.bind(this));\n\t\tsprint.subscribe('showSprintBurnDownChart', this.onShowSprintBurnDownChart.bind(this));\n\t\tsprint.subscribe('showSprintCreateMenu', this.onOpenSprintAddMenu.bind(this));\n\t\tsprint.subscribe('loadItems', (baseEvent: BaseEvent) => {\n\t\t\tconst entity: Entity = baseEvent.getTarget();\n\t\t\tif (!this.loadItemsRepeatCounter.has(entity.getId()))\n\t\t\t{\n\t\t\t\tthis.loadItemsRepeatCounter.set(entity.getId(), 0);\n\t\t\t}\n\t\t\tthis.loadItems(entity);\n\t\t});\n\t\tsprint.subscribe('toggleActionPanel', this.onToggleActionPanel.bind(this));\n\t\tsprint.subscribe('showLinked', this.onShowLinked.bind(this));\n\t\tsprint.subscribe('showDropzone', this.onShowDropZone.bind(this));\n\t\tsprint.subscribe('toggleVisibilityContent', () => {\n\t\t\tthis.planBuilder.adjustSprintListWidth();\n\t\t});\n\t\tsprint.subscribe('deactivateGroupMode', this.onDeactivateGroupMode.bind(this));\n\t}\n\n\tshowErrorAlert(message: string)\n\t{\n\t\tMessageBox.alert(message, Loc.getMessage('TASKS_SCRUM_ERROR_TITLE_POPUP'));\n\t}\n\n\tonDocumentKeyDown(event)\n\t{\n\t\tevent = event || window.event;\n\n\t\tif (this.searchItems.isActive())\n\t\t{\n\t\t\tif (event.key === 'ArrowUp' || event.key === 'ArrowLeft')\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tthis.searchItems.moveToPrev();\n\t\t\t}\n\n\t\t\tif (event.key === 'ArrowDown' || event.key === 'ArrowRight')\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tthis.searchItems.moveToNext();\n\t\t\t}\n\t\t}\n\n\t\tif (event.key === 'Escape')\n\t\t{\n\t\t\tlet prevented = false;\n\n\t\t\tif (this.searchItems.isActive())\n\t\t\t{\n\t\t\t\tprevented = true;\n\n\t\t\t\tthis.searchItems.stop();\n\t\t\t}\n\n\t\t\tif (this.actionPanel)\n\t\t\t{\n\t\t\t\tprevented = true;\n\n\t\t\t\tthis.destroyActionPanel();\n\n\t\t\t\tthis.entityStorage.getAllEntities()\n\t\t\t\t\t.forEach((entity: Entity) => {\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t}\n\n\t\t\tif (prevented)\n\t\t\t{\n\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t}\n\t\t}\n\t}\n\n\tonDocumentClick(event)\n\t{\n\t\tevent = event || window.event;\n\n\t\tif (this.searchItems.isActive() && !this.searchItems.isClickInside(event.target))\n\t\t{\n\t\t\tthis.searchItems.stop();\n\t\t}\n\n\t\tif (this.diskManager && !this.diskManager.isClickInside(event.target))\n\t\t{\n\t\t\tthis.diskManager.closeAttachmentMenu();\n\t\t\tthis.diskManager = null;\n\t\t}\n\t}\n\n\tonShowBacklogInput(baseEvent: BaseEvent)\n\t{\n\t\tconst backlog: Backlog = baseEvent.getTarget();\n\t\tconst header: ?BacklogHeader = baseEvent.getData();\n\n\t\tthis.showInput(backlog).then(() => {\n\t\t\tif (!Type.isPlainObject(header))\n\t\t\t{\n\t\t\t\theader.unLockTaskButton();\n\t\t\t}\n\t\t});\n\t}\n\n\tonShowSprintInput(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint: Sprint = baseEvent.getTarget();\n\n\t\tif (sprint.isHideContent())\n\t\t{\n\t\t\tsprint.subscribeOnce('toggleVisibilityContent', this.showInput.bind(this, sprint));\n\t\t\tsprint.toggleVisibilityContent(sprint.getContentContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showInput(sprint);\n\t\t}\n\t}\n\n\tonOpenAddTaskForm()\n\t{\n\t\tthis.sidePanel.openSidePanelByUrl(this.pathToTaskCreate.replace('#task_id#', 0));\n\t}\n\n\tonCreateSprint()\n\t{\n\t\tthis.planBuilder.createSprint();\n\t}\n\n\tonRenderInput(baseEvent: BaseEvent)\n\t{\n\t\tthis.deactivateDraggable();\n\n\t\tconst input: Input = baseEvent.getTarget();\n\n\t\tconst entity = input.getEntity();\n\n\t\tentity.hideBlank();\n\t\tentity.hideDropzone();\n\t\tentity.hideEmptySearchStub();\n\t}\n\n\tonRemoveInput(baseEvent: BaseEvent)\n\t{\n\t\tthis.activateDraggable();\n\n\t\tconst input: Input = baseEvent.getTarget();\n\n\t\tconst entity = input.getEntity();\n\n\t\tif (!input.isTaskCreated() && entity.isEmpty())\n\t\t{\n\t\t\tif (entity.isBacklog())\n\t\t\t{\n\t\t\t\tif (this.entityStorage.existsAtLeastOneItem())\n\t\t\t\t{\n\t\t\t\t\tif (entity.isExactSearchApplied())\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.showEmptySearchStub();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.showDropzone();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tentity.showBlank();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (entity.getNumberTasks() > 0 && entity.isExactSearchApplied())\n\t\t\t\t{\n\t\t\t\t\tentity.showEmptySearchStub();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tentity.showDropzone();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tif (this.decomposition)\n\t\t{\n\t\t\tthis.decomposition.getParentItem().deactivateDecompositionMode();\n\t\t\tthis.decomposition = null;\n\t\t}\n\n\t\tentity.adjustListItemsWidth();\n\t}\n\n\tonCreateTaskItem(baseEvent: BaseEvent)\n\t{\n\t\tconst input: Input = baseEvent.getTarget();\n\n\t\tconst entity = input.getEntity();\n\n\t\tlet newItem: Item = null;\n\n\t\ttry\n\t\t{\n\t\t\tnewItem = this.createItem(input);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.showErrorAlert(error.message);\n\n\t\t\tinput.removeYourself();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.decomposition)\n\t\t{\n\t\t\tconst parentItem: Item = this.decomposition.getParentItem();\n\n\t\t\tthis.pullItem.addIdToSkipUpdating(parentItem.getId());\n\n\t\t\tnewItem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\t\tnewItem.setParentTaskId(parentItem.getSourceId());\n\t\t\tnewItem.setEpic(parentItem.getEpic().getValue());\n\t\t\tnewItem.setTags(parentItem.getTags().getValue());\n\t\t\tnewItem.setResponsible(parentItem.getResponsible().getValue());\n\n\t\t\tif (entity.isBacklog())\n\t\t\t{\n\t\t\t\tparentItem.setLinkedTask('Y');\n\t\t\t\tparentItem.updateBorderColor();\n\n\t\t\t\tnewItem.setLinkedTask('Y');\n\t\t\t\tnewItem.setBorderColor(parentItem.getBorderColor());\n\t\t\t\tnewItem.setSort(parentItem.getSort() + this.decomposition.getNumberDecompositionsPerformed());\n\n\t\t\t\tDom.insertBefore(newItem.render(), input.getNode());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnewItem.setSubTask('Y');\n\t\t\t\tnewItem.setSort(parentItem.getSort() + (parentItem.getSubTasksCount() + 1));\n\t\t\t\tnewItem.setParentTaskId(parentItem.getSourceId());\n\t\t\t\tnewItem.setParentTask('N');\n\t\t\t}\n\n\t\t\tthis.decomposition.addNumberDecompositionsPerformed();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewItem.setEpic(input.getEpic());\n\n\t\t\tinput.setEpic(null);\n\n\t\t\tnewItem.setParentEntity(entity.getId(), entity.getEntityType());\n\t\t\tnewItem.setSort(1);\n\t\t\tnewItem.setResponsible(this.defaultResponsible);\n\n\t\t\tif (entity.isEmpty())\n\t\t\t{\n\t\t\t\tDom.insertBefore(newItem.render(), entity.getLoaderNode());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.insertBefore(newItem.render(), entity.getFirstItemNode(this.input));\n\t\t\t}\n\t\t}\n\n\t\tthis.pullItem.addTmpIdToSkipAdding(newItem.getId());\n\t\tthis.pullItem.addTmpIdToSkipSorting(newItem.getId());\n\n\t\tthis.sendRequestToCreateTask(entity, newItem).then((response) => {\n\n\t\t\tthis.fillItemAfterCreation(newItem, response.data);\n\n\t\t\tentity.setItem(newItem);\n\n\t\t\tthis.updateEntityCounters(entity);\n\n\t\t\tif (this.decomposition)\n\t\t\t{\n\t\t\t\tconst parentItem: Item = this.decomposition.getParentItem();\n\n\t\t\t\tif (!entity.isBacklog())\n\t\t\t\t{\n\t\t\t\t\tconst subTasks = parentItem.getSubTasks();\n\n\t\t\t\t\tsubTasks.addTask(newItem);\n\n\t\t\t\t\tif (!subTasks.isShown())\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.appendNodeAfterItem(subTasks.render(), parentItem.getNode());\n\t\t\t\t\t}\n\n\t\t\t\t\tconst subTaskInfo = {};\n\t\t\t\t\tsubTaskInfo[newItem.getSourceId()] = {\n\t\t\t\t\t\tsourceId: newItem.getSourceId(),\n\t\t\t\t\t\tcompleted: 'N',\n\t\t\t\t\t\tstoryPoints: ''\n\t\t\t\t\t};\n\n\t\t\t\t\tparentItem.setSubTasksInfo({...parentItem.getSubTasksInfo(), ...subTaskInfo})\n\t\t\t\t\tparentItem.setParentTask('Y');\n\n\t\t\t\t\tparentItem.showSubTasks();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tinput.unDisable();\n\t\t\tinput.focus();\n\n\t\t\tentity.adjustListItemsWidth();\n\t\t\tthis.planBuilder.adjustSprintListWidth();\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonUpdateItem(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst updateData = baseEvent.getData();\n\n\t\tthis.pullItem.addIdToSkipUpdating(updateData.itemId);\n\n\t\tthis.requestSender.updateItem(baseEvent.getData())\n\t\t\t.then(() => {\n\t\t\t\tconst isStoryPointsUpdated = (!Type.isUndefined(updateData.storyPoints));\n\t\t\t\tif (isStoryPointsUpdated)\n\t\t\t\t{\n\t\t\t\t\tthis.updateEntityCounters(entity);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonGetSubTasks(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint: Sprint = baseEvent.getTarget();\n\t\tconst subTasks: SubTasks = baseEvent.getData();\n\n\t\tsprint.appendNodeAfterItem(subTasks.render(), subTasks.getParentItem().getNode());\n\n\t\tthis.requestSender.getSubTaskItems({\n\t\t\tentityId: sprint.getId(),\n\t\t\ttaskId: subTasks.getParentItem().getSourceId()\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tresponse.data.forEach((itemParams: ItemParams) => {\n\t\t\t\t\tconst subTaskItem = Item.buildItem(itemParams);\n\t\t\t\t\tsprint.setItem(subTaskItem);\n\t\t\t\t\tsubTasks.addTask(subTaskItem);\n\t\t\t\t});\n\t\t\t\tsubTasks.getParentItem().showSubTasks();\n\t\t\t\tsprint.deactivateSubTaskLoading(subTasks.getParentItem());\n\t\t\t\tthis.planBuilder.adjustSprintListWidth();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonChangeTaskResponsible(baseEvent: BaseEvent)\n\t{\n\t\tconst item: Item = baseEvent.getData();\n\n\t\tthis.pullItem.addIdToSkipUpdating(item.getId());\n\n\t\tthis.requestSender.changeTaskResponsible({\n\t\t\titemId: item.getId(),\n\t\t\tsourceId: item.getSourceId(),\n\t\t\tresponsible: item.getResponsible().getValue(),\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonShowResponsibleDialog(baseEvent: BaseEvent)\n\t{\n\t\tthis.responsibleDialog = baseEvent.getData();\n\t}\n\n\tonOpenEpicForm(baseEvent: BaseEvent)\n\t{\n\t\tconst header: BacklogHeader = baseEvent.getData();\n\n\t\tthis.epic.openAddForm().then(() => {\n\t\t\theader.unLockEpicButton();\n\t\t});\n\t}\n\n\tonStartSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tgroupId: this.groupId,\n\t\t\tviews: this.views\n\t\t});\n\n\t\tsprintSidePanel.showStartForm(sprint);\n\t}\n\n\tonCompleteSprint()\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tgroupId: this.groupId,\n\t\t\tviews: this.views\n\t\t});\n\n\t\tsprintSidePanel.showCompletionForm();\n\n\t\tsprintSidePanel.subscribe('showTask', (innerBaseEvent: BaseEvent) => {\n\t\t\tthis.sidePanel.openSidePanelByUrl(this.getPathToTask().replace('#task_id#', innerBaseEvent.getData()));\n\t\t});\n\t}\n\n\tonRemoveSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint: Sprint = baseEvent.getTarget();\n\n\t\tthis.pullSprint.addIdToSkipRemoving(sprint.getId());\n\n\t\tthis.requestSender.removeSprint({\n\t\t\tsprintId: sprint.getId(),\n\t\t\tsortInfo: this.sprintMover.calculateSprintSort()\n\t\t})\n\t\t.then(() => {\n\n\t\t\tif (!sprint.isEmpty())\n\t\t\t{\n\t\t\t\t[...sprint.getItems().values()]\n\t\t\t\t\t.map((item: Item) => {\n\t\t\t\t\t\tsprint.addItemToGroupMode(item);\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tthis.itemMover.moveToWithGroupMode(sprint, this.entityStorage.getBacklog(), null, false, false);\n\t\t\t}\n\n\t\t\tthis.destroyActionPanel();\n\n\t\t\tsprint.removeYourself();\n\n\t\t\tthis.entityStorage.removeSprint(sprint.getId());\n\n\t\t\tthis.planBuilder.adjustSprintListWidth();\n\t\t})\n\t\t.catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeSprintName(baseEvent: BaseEvent)\n\t{\n\t\tconst requestData = baseEvent.getData();\n\t\tthis.pullSprint.addIdToSkipUpdating(requestData.sprintId);\n\t\tthis.requestSender.changeSprintName(requestData).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonChangeSprintDeadline(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint: Sprint = baseEvent.getTarget();\n\t\tconst requestData = baseEvent.getData();\n\n\t\tthis.pullSprint.addIdToSkipUpdating(requestData.sprintId);\n\t\tthis.requestSender.changeSprintDeadline(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tconst sprintData = response.data;\n\t\t\t\tsprint.setDateStart(sprintData.dateStart);\n\t\t\t\tsprint.setDateEnd(sprintData.dateEnd);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tonGetSprintCompletedItems(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\t\tconst listItemsNode = sprint.getListItemsNode();\n\t\tconst listPosition = Dom.getPosition(listItemsNode);\n\n\t\tDom.style(sprint.getContentContainer(), 'height', 'auto');\n\n\t\tconst loader = new Loader({\n\t\t\tsize: 60,\n\t\t\tmode: 'inline',\n\t\t\tcolor: '#eaeaea',\n\t\t\toffset: {\n\t\t\t\tleft: `${(listPosition.width / 2 - 30)}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show(); // todo promise wtf\n\n\t\tthis.requestSender.getSprintCompletedItems({\n\t\t\tsprintId: sprint.getId()\n\t\t}).then((response) => {\n\t\t\tloader.hide();\n\t\t\tif (response.data.length > 0)\n\t\t\t{\n\t\t\t\tresponse.data.forEach((itemParams: ItemParams) => {\n\t\t\t\t\tconst item = Item.buildItem(itemParams);\n\t\t\t\t\tif (!sprint.getItems().has(item.getId()))\n\t\t\t\t\t{\n\t\t\t\t\t\titem.setDisableStatus(sprint.isDisabled());\n\t\t\t\t\t\tsprint.appendItemToList(item);\n\t\t\t\t\t\tsprint.setItem(item);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsprint.showBlank();\n\t\t\t}\n\t\t\tsprint.showContent(sprint.getContentContainer());\n\t\t}).catch((response) => {\n\t\t\tloader.hide();\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonShowSprintBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint = baseEvent.getTarget();\n\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tgroupId: this.groupId,\n\t\t\tviews: this.views,\n\t\t\tpathToBurnDown: this.pathToBurnDown\n\t\t});\n\n\t\tsprintSidePanel.showBurnDownChart(sprint);\n\t}\n\n\tonOpenSprintAddMenu(baseEvent: BaseEvent)\n\t{\n\t\tconst entity = baseEvent.getTarget();\n\t\tconst button = baseEvent.getData().getNode();\n\n\t\tif (this.sprintAddMenu)\n\t\t{\n\t\t\tthis.sprintAddMenu.getPopupWindow().destroy();\n\t\t\tthis.sprintAddMenu = null;\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst buttonRect = button.getBoundingClientRect();\n\n\t\tthis.sprintAddMenu = new Menu({\n\t\t\tid: 'tasks-scrum-sprint-add-menu',\n\t\t\tbindElement: button,\n\t\t\tcloseByEsc : true,\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t\toffset: 78\n\t\t\t},\n\t\t\toffsetLeft: buttonRect.width - 67\n\t\t});\n\n\t\tthis.sprintAddMenu.addMenuItem({\n\t\t\ttext: Loc.getMessage('TASKS_SCRUM_BACKLOG_SPRINT_FIRST_ADD'),\n\t\t\tonclick: (event, menuItem) => {\n\t\t\t\tthis.onShowSprintInput((new BaseEvent()).setTarget(entity));\n\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t}\n\t\t});\n\t\tthis.sprintAddMenu.addMenuItem({\n\t\t\ttext: Loc.getMessage('TASKS_SCRUM_BACKLOG_SPRINT_SECOND_ADD'),\n\t\t\tonclick: (event, menuItem) => {\n\t\t\t\tthis.planBuilder.createSprint();\n\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t}\n\t\t});\n\n\t\tthis.sprintAddMenu.getPopupWindow().subscribe('onClose', () => {\n\t\t\tthis.sprintAddMenu.getPopupWindow().destroy();\n\t\t\tthis.sprintAddMenu = null;\n\t\t});\n\t\tthis.sprintAddMenu.getPopupWindow().subscribe('onShow', () => {\n\t\t\tconst angle = this.sprintAddMenu.getMenuContainer().querySelector('.popup-window-angly');\n\t\t\tDom.style(angle, 'pointerEvents', 'none');\n\t\t});\n\n\t\tthis.sprintAddMenu.show();\n\t}\n\n\tonShowTask(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getData();\n\n\t\tthis.sidePanel.openSidePanelByUrl(this.pathToTask.replace('#task_id#', item.getSourceId()));\n\t}\n\n\tonDestroyActionPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getData();\n\n\t\tthis.destroyActionPanel();\n\n\t\t(this.entityStorage.findEntityByItemId(item.getId())).deactivateGroupMode();\n\t}\n\n\tonTagsSearchOpen(baseEvent: BaseEvent)\n\t{\n\t\tthis.tagSearcher.showTagsSearchDialog(this.input, baseEvent.getData());\n\t}\n\n\tonTagsSearchClose()\n\t{\n\t\tthis.tagSearcher.closeTagsSearchDialog();\n\t}\n\n\tonFilterByTag(baseEvent: BaseEvent)\n\t{\n\t\tconst tag = baseEvent.getData();\n\t\tconst currentValue = this.filter.getValueFromField({name: 'TAG', value: ''});\n\t\tconst newValue = (String(tag) === String(currentValue) ? [] : [String(tag)]);\n\n\t\tthis.filter.setValuesToField([\n\t\t\t{\n\t\t\t\tname: 'TAG',\n\t\t\t\tvalue: newValue,\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'TAG_label',\n\t\t\t\tvalue: newValue,\n\t\t\t},\n\t\t]);\n\t\tthis.filter.scrollToSearchContainer();\n\t}\n\n\tonEpicSearchOpen(baseEvent: BaseEvent)\n\t{\n\t\tthis.tagSearcher.showEpicSearchDialog(this.input, baseEvent.getData());\n\t}\n\n\tonEpicSearchClose()\n\t{\n\t\tthis.tagSearcher.closeEpicSearchDialog();\n\t}\n\n\tonFilterByEpic(baseEvent: BaseEvent)\n\t{\n\t\tconst epicId = baseEvent.getData();\n\t\tconst currentValue = this.filter.getValueFromField({name: 'EPIC', value: ''});\n\n\t\tif (String(epicId) === String(currentValue))\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'EPIC', value: ''});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filter.setValueToField({name: 'EPIC', value: String(epicId)});\n\t\t}\n\n\t\tthis.filter.scrollToSearchContainer();\n\t}\n\n\tonChangeShortView(baseEvent: BaseEvent)\n\t{\n\t\tconst isShortView = baseEvent.getData();\n\n\t\tthis.planBuilder.setShortView(isShortView);\n\n\t\tthis.destroyActionPanel();\n\n\t\tconst entities = this.entityStorage.getAllEntities();\n\n\t\tentities\n\t\t\t.forEach((entity: Entity) => {\n\t\t\t\tif (!entity.isCompleted())\n\t\t\t\t{\n\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\tentity.fadeOut();\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tthis.requestSender.saveShortView({\n\t\t\tisShortView: isShortView\n\t\t})\n\t\t.then((response) => {\n\t\t\tentities\n\t\t\t\t.forEach((entity: Entity) => {\n\t\t\t\t\tif (!entity.isCompleted())\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.setShortView(isShortView);\n\t\t\t\t\t\tentity.adjustListItemsWidth();\n\t\t\t\t\t\tentity.fadeIn();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t})\n\t\t.catch((response) => {\n\t\t\tentities\n\t\t\t\t.forEach((entity: Entity) => {\n\t\t\t\t\tif (!entity.isCompleted())\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.fadeIn();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tonToggleActionPanel(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getData();\n\t\tconst entity = baseEvent.getTarget();\n\n\t\tif (this.actionPanel)\n\t\t{\n\t\t\tconst repeatedClick = (this.actionPanel.getItem().getId() === item.getId());\n\n\t\t\tthis.destroyActionPanel();\n\n\t\t\tif (repeatedClick || entity.hasItemInGroupMode(item))\n\t\t\t{\n\t\t\t\tthis.deactivateGroupMode(entity, item);\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.activateGroupMode(entity, item);\n\n\t\tthis.showActionPanel(entity, item);\n\n\t\tif (this.searchItems.isActive())\n\t\t{\n\t\t\tthis.searchItems.updateCurrentIndexByItem(item);\n\t\t}\n\t}\n\n\tonShowLinked(baseEvent: BaseEvent)\n\t{\n\t\tconst item = baseEvent.getData();\n\n\t\tif (this.searchItems.isActive())\n\t\t{\n\t\t\tthis.searchItems.stop();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.destroyActionPanel();\n\n\t\tconst containerPosition = Dom.getPosition(this.planBuilder.getScrumContainer());\n\n\t\twindow.scrollTo({ top: containerPosition.top, behavior: 'smooth' });\n\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.planBuilder.getScrumContainer(),\n\t\t\toffset: {\n\t\t\t\ttop: `${containerPosition.top / 2}px`\n\t\t\t}\n\t\t});\n\n\t\tloader.show();\n\n\t\tthis.searchItems.deactivateGroupMode();\n\t\tthis.searchItems.fadeOutAll();\n\n\t\tthis.requestSender.showLinkedTasks({\n\t\t\ttaskId: item.getSourceId()\n\t\t})\n\t\t\t.then((response: ShowLinkedTasksResponse) => {\n\t\t\t\tconst filteredItems = response.data.items;\n\t\t\t\tconst linkedItemIds = response.data.linkedItemIds;\n\n\t\t\t\tfilteredItems.forEach((itemParams: ItemParams) => {\n\t\t\t\t\tconst item = Item.buildItem(itemParams);\n\t\t\t\t\tconst entity = this.entityStorage.findEntityByEntityId(item.getEntityId());\n\n\t\t\t\t\tif (!entity.isCompleted() && !entity.hasItem(item))\n\t\t\t\t\t{\n\t\t\t\t\t\titem.setShortView(entity.getShortView());\n\t\t\t\t\t\tentity.appendItemToList(item);\n\t\t\t\t\t\tentity.setItem(item);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tconst allItems = this.entityStorage.getAllItems();\n\t\t\t\tconst items = new Set();\n\t\t\t\tlinkedItemIds.forEach((itemId: number) => {\n\t\t\t\t\tif (allItems.has(itemId))\n\t\t\t\t\t{\n\t\t\t\t\t\titems.add(allItems.get(itemId));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.itemDesigner.updateBorderColor(items);\n\n\t\t\t\tif (linkedItemIds.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.searchItems.start(item, linkedItemIds);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.searchItems.fadeInAll();\n\t\t\t\t}\n\n\t\t\t\tloader.hide();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\n\t\t\t\tloader.hide();\n\t\t\t})\n\t\t;\n\t}\n\n\tonActionPanelScroll()\n\t{\n\t\tif (this.actionPanel)\n\t\t{\n\t\t\tthis.actionPanel.calculatePanelTopPosition();\n\t\t}\n\n\t\tif (this.diskManager)\n\t\t{\n\t\t\tthis.diskManager.closeAttachmentMenu();\n\t\t\tthis.diskManager = null;\n\t\t}\n\n\t\tif (this.itemMover.hasActionPanelDialog())\n\t\t{\n\t\t\tthis.itemMover.closeActionPanelDialogs();\n\t\t}\n\n\t\tif (this.tagSearcher.hasActionPanelDialog())\n\t\t{\n\t\t\tthis.tagSearcher.closeActionPanelDialogs();\n\t\t}\n\n\t\tif (this.responsibleDialog && this.responsibleDialog.isOpen())\n\t\t{\n\t\t\tthis.responsibleDialog.hide();\n\t\t}\n\t}\n\n\tonShowBlank(baseEvent: BaseEvent)\n\t{\n\t\tconst backlog: Backlog = baseEvent.getTarget();\n\n\t\tsetTimeout(() => {\n\t\t\tif (!backlog.isEmpty())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.entityStorage.existsAtLeastOneItem())\n\t\t\t{\n\t\t\t\tif (backlog.isExactSearchApplied())\n\t\t\t\t{\n\t\t\t\t\tbacklog.showEmptySearchStub();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbacklog.showDropzone();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbacklog.showBlank();\n\t\t\t}\n\t\t}, 200);\n\t}\n\n\tonDeactivateGroupMode(baseEvent: BaseEvent)\n\t{\n\t\tthis.destroyActionPanel();\n\t}\n\n\tonShowDropZone(baseEvent: BaseEvent)\n\t{\n\t\tconst sprint: Sprint = baseEvent.getTarget();\n\n\t\tsetTimeout(() => {\n\t\t\tif (!sprint.isEmpty())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (sprint.getNumberTasks() > 0 && sprint.isExactSearchApplied())\n\t\t\t{\n\t\t\t\tsprint.showEmptySearchStub();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsprint.showDropzone();\n\t\t\t}\n\t\t}, 200);\n\t}\n\n\tloadItems(entity: Entity)\n\t{\n\t\tif (this.loadItemsRepeatCounter.get(entity.getId()) > 1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tentity.setActiveLoadItems(true);\n\n\t\tif (entity.getNumberItems() >= this.pageSize)\n\t\t{\n\t\t\tentity.getListItems().addScrollbar();\n\t\t}\n\n\t\tconst loader = entity.showItemsLoader();\n\n\t\tconst requestData = {\n\t\t\tentityId: entity.getId(),\n\t\t\tpageNumber: entity.getPageNumberItems() + 1,\n\t\t\tpageSize: this.pageSize\n\t\t};\n\n\t\tthis.requestSender.getItems(requestData)\n\t\t\t.then((response) => {\n\t\t\t\tconst items = response.data;\n\n\t\t\t\tentity.setActiveLoadItems(false);\n\n\t\t\t\tif (Type.isArray(items) && items.length)\n\t\t\t\t{\n\t\t\t\t\tentity.incrementPageNumberItems();\n\n\t\t\t\t\tthis.createItemsInEntity(entity, items);\n\n\t\t\t\t\tif (entity.isGroupMode())\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.activateGroupMode();\n\t\t\t\t\t}\n\n\t\t\t\t\tentity.bindItemsLoader();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (entity.getNumberTasks() !== entity.getNumberItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.loadItemsRepeatCounter.set(\n\t\t\t\t\t\t\tentity.getId(),\n\t\t\t\t\t\t\tthis.loadItemsRepeatCounter.get(entity.getId()) + 1\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tentity.decrementPageNumberItems();\n\n\t\t\t\t\t\tthis.loadItems(entity);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.unbindItemsLoader();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tloader.hide();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tloader.hide();\n\t\t\t\tentity.setActiveLoadItems(false);\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tshowInput(entity: Entity, bindNode: ?HTMLElement): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tif (this.input.isExists())\n\t\t\t{\n\t\t\t\tthis.input.submit();\n\n\t\t\t\tif (this.input.hasEntity(entity))\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.input.subscribeOnce('unDisable', () => {\n\t\t\t\t\t\tthis.input.removeYourself();\n\n\t\t\t\t\t\tthis.renderInput(entity, bindNode);\n\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.renderInput(entity, bindNode);\n\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n\n\trenderInput(entity: Entity, bindNode: ?HTMLElement)\n\t{\n\t\tthis.input.setEntity(entity);\n\n\t\tif (Type.isElementNode(bindNode))\n\t\t{\n\t\t\tthis.input.setBindNode(bindNode);\n\n\t\t\tDom.insertAfter(this.input.render(), bindNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.input.cleanBindNode();\n\n\t\t\tif (entity.isEmpty())\n\t\t\t{\n\t\t\t\tDom.insertBefore(this.input.render(), entity.getLoaderNode());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.insertBefore(this.input.render(), entity.getFirstItemNode(this.input));\n\t\t\t}\n\t\t}\n\n\t\tentity.adjustListItemsWidth();\n\n\t\tthis.input.focus();\n\n\t\tthis.scrollToInput();\n\t}\n\n\tscrollToInput()\n\t{\n\t\tconst entity: Entity = this.input.getEntity();\n\n\t\tif (entity.isBacklog())\n\t\t{\n\t\t\tconst scrollContainer = entity.getListItemsNode();\n\n\t\t\tconst topPosition = Dom.getRelativePosition(this.input.getInputNode(), scrollContainer).top;\n\n\t\t\tscrollContainer.scrollTo({\n\t\t\t\ttop: scrollContainer.scrollTop + topPosition - 100,\n\t\t\t\tbehavior: 'smooth'\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst sprintsContainer = this.planBuilder.getSprintsContainer()\n\n\t\t\tconst topPosition = Dom.getRelativePosition(this.input.getInputNode(), sprintsContainer).top;\n\n\t\t\tsprintsContainer.scrollTo({\n\t\t\t\ttop: sprintsContainer.scrollTop + topPosition - 100,\n\t\t\t\tbehavior: 'smooth'\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateItemsInEntity(entity: Entity, items: Array)\n\t{\n\t\titems.forEach((itemData: ItemParams) => {\n\t\t\tconst item = Item.buildItem(itemData);\n\t\t\titem.setEntityType(entity.getEntityType());\n\t\t\tif (!this.entityStorage.findItemByItemId(item.getId()))\n\t\t\t{\n\t\t\t\titem.setShortView(entity.getShortView());\n\t\t\t\tentity.appendItemToList(item);\n\t\t\t\tentity.setItem(item);\n\t\t\t}\n\t\t});\n\t}\n\n\tshowActionPanel(entity: Entity, item: Item)\n\t{\n\t\tconst stopSearch = () => {\n\t\t\tif (this.searchItems.isActive())\n\t\t\t{\n\t\t\t\tthis.searchItems.stop();\n\t\t\t}\n\t\t}\n\n\t\tconst isMultipleAction = (entity.getGroupModeItems().size > 1);\n\n\t\t//todo maybe will cool move list actions to item scope\n\t\tthis.actionPanel = new ActionPanel({\n\t\t\tentity: entity,\n\t\t\titem: item,\n\t\t\titemList: {\n\t\t\t\ttask: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tdisable : isMultipleAction,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.onShowTask(\n\t\t\t\t\t\t\tnew BaseEvent({\n\t\t\t\t\t\t\t\tdata: item\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.destroyActionPanel();\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tattachment: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tdisable : !item.isEditAllowed(),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tif (this.diskManager)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.diskManager.closeAttachmentMenu();\n\t\t\t\t\t\t\tthis.diskManager = null;\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.diskManager = new DiskManager({\n\t\t\t\t\t\t\ttargetElement: event.currentTarget\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.diskManager.subscribe('onFinish', (baseEvent) => {\n\t\t\t\t\t\t\tthis.attachFilesToTask(entity, baseEvent.getData());\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.diskManager.showAttachmentMenu(event.currentTarget);\n\t\t\t\t\t\tthis.actionPanel.subscribe('onDestroy', () => {\n\t\t\t\t\t\t\tif (this.diskManager)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.diskManager.closeAttachmentMenu();\n\t\t\t\t\t\t\t\tthis.diskManager = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdod: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tdisable : isMultipleAction,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.showDod(item);\n\t\t\t\t\t\tthis.destroyActionPanel();\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tdisable : (!item.isMovable()),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.moveItem(item, event.currentTarget);\n\t\t\t\t\t\tstopSearch();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tsprint: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tdisable : false,\n\t\t\t\t\tmultiple : (this.entityStorage.getSprintsAvailableForFilling(entity).size > 1),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tthis.moveToSprint(entity, item, event.currentTarget);\n\t\t\t\t\t\tstopSearch();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbacklog: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tdisable : (item.getEntityType() !== 'sprint'),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.moveToBacklog(entity, item);\n\t\t\t\t\t\tthis.destroyActionPanel();\n\t\t\t\t\t\tstopSearch();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ttags: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tdisable : !item.isEditAllowed(),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tif (this.tagSearcher.hasActionPanelDialog())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.tagSearcher.closeActionPanelDialogs();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.showTagSearcher(entity, item, event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tepic: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tdisable : !item.isEditAllowed(),\n\t\t\t\t\tcallback: (event) => {\n\t\t\t\t\t\tif (this.tagSearcher.hasActionPanelDialog())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.tagSearcher.closeActionPanelDialogs();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.showEpicSearcher(entity, item, event.currentTarget);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdecomposition: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tdisable : (isMultipleAction),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tif (entity.isBacklog())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.startBacklogDecomposition(entity, item);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.startSprintDecomposition(entity, item);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.destroyActionPanel();\n\t\t\t\t\t\tentity.deactivateGroupMode();\n\t\t\t\t\t\tstopSearch();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tactivity: true,\n\t\t\t\t\tdisable : (!item.isRemoveAllowed()),\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tMessageBox.confirm(\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_CONFIRM_TEXT_REMOVE_TASKS'),\n\t\t\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t\t\tthis.removeGroupItems(entity).then(() => {\n\t\t\t\t\t\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\t\t\t\t\t\tentity.removeItem(groupModeItem);\n\t\t\t\t\t\t\t\t\t\tthis.deactivateGroupMode(entity, groupModeItem);\n\t\t\t\t\t\t\t\t\t\tgroupModeItem.removeYourself();\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tthis.updateEntityCounters(entity);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tLoc.getMessage('TASKS_SCRUM_BUTTON_TEXT_REMOVE'),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.destroyActionPanel();\n\t\t\t\t\t\tstopSearch();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.actionPanel.subscribe('unSelect', () => {\n\t\t\tthis.destroyActionPanel();\n\t\t\tentity.deactivateGroupMode();\n\t\t});\n\n\t\tthis.actionPanel.show();\n\t}\n\n\tactivateDraggable()\n\t{\n\t\tthis.entityStorage.getAllItems().forEach((item: Item) => item.setDisableStatus(false));\n\t}\n\n\tdeactivateDraggable()\n\t{\n\t\tthis.entityStorage.getAllItems().forEach((item: Item) => item.setDisableStatus(true));\n\t}\n\n\tactivateGroupMode(entity: Entity, item?: Item)\n\t{\n\t\tif (item)\n\t\t{\n\t\t\tentity.addItemToGroupMode(item);\n\t\t}\n\n\t\tif (entity.isGroupMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tentity.activateGroupMode();\n\n\t\tif (entity.getId() !== this.entityStorage.getBacklog().getId())\n\t\t{\n\t\t\tthis.entityStorage.getBacklog().deactivateGroupMode();\n\t\t}\n\t\tthis.entityStorage.getSprints().forEach((sprint) => {\n\t\t\tif (entity.getId() !== sprint.getId())\n\t\t\t{\n\t\t\t\tsprint.deactivateGroupMode();\n\t\t\t}\n\t\t});\n\t}\n\n\tdeactivateGroupMode(entity: Entity, item?: Item)\n\t{\n\t\tif (item)\n\t\t{\n\t\t\tentity.removeItemFromGroupMode(item);\n\t\t}\n\n\t\tif (!entity.isGroupMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst groupModeItems = entity.getGroupModeItems();\n\t\tif (groupModeItems.size === 0)\n\t\t{\n\t\t\tentity.deactivateGroupMode();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showActionPanel(entity, Array.from(groupModeItems.values()).pop());\n\t\t}\n\t}\n\n\tcreateItem(input: Input): Item\n\t{\n\t\tconst epic = input.getEpic();\n\n\t\tconst value = input.getInputNode().value.trim();\n\n\t\tconst valueWithoutEpic =\n\t\t\tepic\n\t\t\t\t? value.replace(new RegExp('@' + Tool.escapeRegex(epic.name) + '$', 'g'), '')\n\t\t\t\t: value\n\t\t;\n\n\t\tconst item = Item.buildItem({\n\t\t\tid: '',\n\t\t\tname: valueWithoutEpic,\n\t\t\tgroupId: this.getCurrentGroupId(),\n\t\t\tpathToTask: this.pathToTask\n\t\t});\n\n\t\titem.setShortView(this.isShortView);\n\n\t\treturn item;\n\t}\n\n\tsendRequestToCreateTask(entity: Entity, item: Item): Promise\n\t{\n\t\tconst requestData = {\n\t\t\t'tmpId': item.getId(),\n\t\t\t'name': item.getName().getValue(),\n\t\t\t'entityId': item.getEntityId(),\n\t\t\t'entityType': entity.getEntityType(),\n\t\t\t'epicId': item.getEpic().getValue().id,\n\t\t\t'sort': item.getSort(),\n\t\t\t'storyPoints': item.getStoryPoints().getValue().getPoints(),\n\t\t\t'parentTaskId': item.getParentTaskId(),\n\t\t\t'responsible': item.getResponsible().getValue(),\n\t\t\t'info': item.getInfo(),\n\t\t\t'sortInfo': this.itemMover.calculateSort(entity.getListItemsNode())\n\t\t};\n\t\treturn this.requestSender.createTask(requestData);\n\t}\n\n\tfillItemAfterCreation(item: Item, responseData: Object): Item\n\t{\n\t\titem.setId(responseData.id);\n\t\titem.setEpic(responseData.epic);\n\t\titem.setTags(responseData.tags);\n\t\titem.setResponsible(responseData.responsible);\n\t\titem.setSourceId(responseData.sourceId);\n\t\titem.setAllowedActions(responseData.allowedActions);\n\n\t\titem.setName(item.getName().getValue());\n\t}\n\n\tupdateEntityCounters(sourceEntity: Entity, endEntity?: Entity)\n\t{\n\t\tconst entities = new Map();\n\n\t\tentities.set(sourceEntity.getId(), sourceEntity);\n\t\tif (endEntity)\n\t\t{\n\t\t\tentities.set(endEntity.getId(), endEntity);\n\t\t}\n\n\t\tthis.entityCounters.updateCounters(entities);\n\t}\n\n\tdestroyActionPanel()\n\t{\n\t\tif (this.actionPanel)\n\t\t{\n\t\t\tthis.actionPanel.destroy();\n\t\t}\n\n\t\tthis.actionPanel = null;\n\t}\n\n\tgetActionPanel(): ?ActionPanel\n\t{\n\t\treturn this.actionPanel;\n\t}\n\n\tattachFilesToTask(entity: Entity, attachedIds: Array<string>)\n\t{\n\t\tif (attachedIds.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemIds = [];\n\n\t\tentity.getGroupModeItems()\n\t\t\t.forEach((groupModeItem: Item) => {\n\t\t\t\tthis.pullItem.addIdToSkipUpdating(groupModeItem.getId());\n\t\t\t\titemIds.push(groupModeItem.getId());\n\t\t\t})\n\t\t;\n\n\t\tthis.requestSender.attachFilesToTask({\n\t\t\titemIds: itemIds,\n\t\t\tattachedIds: attachedIds,\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tentity.getGroupModeItems()\n\t\t\t\t\t.forEach((groupModeItem: Item) => {\n\t\t\t\t\t\tgroupModeItem.setFiles(response.data.attachedFilesCount[groupModeItem.getId()]);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t\tthis.destroyActionPanel();\n\t\t\t\tentity.deactivateGroupMode();\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t})\n\t\t;\n\t}\n\n\tshowDod(item: Item)\n\t{\n\t\tthis.sidePanel.showByExtension('Dod', {\n\t\t\tview: 'list',\n\t\t\tgroupId: this.groupId,\n\t\t\ttaskId: item.getSourceId(),\n\t\t\tskipNotifications: true\n\t\t});\n\t}\n\n\tmoveItem(item: Item, bindButton: HTMLElement)\n\t{\n\t\tthis.itemMover.moveItem(item, bindButton);\n\t}\n\n\tmoveToSprint(entityFrom: Entity, item: Item, bindButton: HTMLElement)\n\t{\n\t\tthis.itemMover.moveToAnotherEntity(entityFrom, item, null, bindButton);\n\n\t\tif (this.entityStorage.getSprintsAvailableForFilling(entityFrom).size <= 1)\n\t\t{\n\t\t\tthis.destroyActionPanel();\n\t\t}\n\t}\n\n\tmoveToBacklog(sprint: Sprint, item: Item)\n\t{\n\t\tthis.itemMover.moveToAnotherEntity(sprint, item, this.entityStorage.getBacklog());\n\t}\n\n\tshowTagSearcher(entity: Entity, item: Item, bindButton: HTMLElement)\n\t{\n\t\tthis.tagSearcher.showTagsDialog(item, bindButton);\n\n\t\tthis.tagSearcher.unsubscribeAll('attachTagToTask');\n\t\tthis.tagSearcher.subscribe('attachTagToTask', (innerBaseEvent) => {\n\t\t\tconst tag = innerBaseEvent.getData();\n\n\t\t\tconst itemIds = [];\n\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\tthis.pullItem.addIdToSkipUpdating(groupModeItem.getId());\n\t\t\t\titemIds.push(groupModeItem.getId());\n\t\t\t});\n\t\t\tthis.requestSender.updateTaskTags({\n\t\t\t\titemIds: itemIds,\n\t\t\t\ttag: tag\n\t\t\t}).then((response) => {\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\tconst currentTags = groupModeItem.getTags().getValue();\n\t\t\t\t\tif (!currentTags.includes(tag))\n\t\t\t\t\t{\n\t\t\t\t\t\tcurrentTags.push(tag);\n\t\t\t\t\t}\n\t\t\t\t\tgroupModeItem.setTags(currentTags);\n\t\t\t\t});\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\n\t\t});\n\n\t\tthis.tagSearcher.unsubscribeAll('deAttachTagToTask');\n\t\tthis.tagSearcher.subscribe('deAttachTagToTask', (innerBaseEvent) => {\n\t\t\tconst tag = innerBaseEvent.getData();\n\n\t\t\tconst itemIds = [];\n\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\tthis.pullItem.addIdToSkipUpdating(groupModeItem.getId());\n\t\t\t\titemIds.push(groupModeItem.getId());\n\t\t\t});\n\t\t\tthis.requestSender.removeTaskTags({\n\t\t\t\titemIds: itemIds,\n\t\t\t\ttag: tag\n\t\t\t}).then((response) => {\n\t\t\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\t\t\t\t\tconst currentTags = groupModeItem.getTags().getValue();\n\t\t\t\t\tcurrentTags.splice(currentTags.indexOf(tag), 1);\n\t\t\t\t\tgroupModeItem.setTags(currentTags);\n\t\t\t\t});\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t});\n\t\t});\n\n\t\tthis.tagSearcher.unsubscribeAll('hideTagDialog');\n\t\tthis.tagSearcher.subscribe('hideTagDialog', () => {\n\t\t\tif (!this.tagSearcher.isEpicDialogShown())\n\t\t\t{\n\t\t\t\tthis.destroyActionPanel();\n\t\t\t\tentity.deactivateGroupMode();\n\t\t\t}\n\t\t});\n\t}\n\n\tshowEpicSearcher(entity: Entity, item: Item, bindButton: HTMLElement)\n\t{\n\t\tthis.tagSearcher.showEpicDialog(item, bindButton);\n\n\t\tthis.tagSearcher.unsubscribeAll('updateItemEpic');\n\t\tthis.tagSearcher.subscribe('updateItemEpic', (innerBaseEvent: BaseEvent) => {\n\t\t\tconst itemIds = [];\n\t\t\tconst epicId = innerBaseEvent.getData();\n\t\t\tentity.getGroupModeItems()\n\t\t\t\t.forEach((groupModeItem: Item) => {\n\t\t\t\t\tgroupModeItem.setEpic(this.tagSearcher.getEpicById(epicId));\n\t\t\t\t\titemIds.push(groupModeItem.getId());\n\t\t\t\t\tthis.pullItem.addIdToSkipUpdating(groupModeItem.getId());\n\t\t\t\t})\n\t\t\t;\n\t\t\tthis.requestSender.updateItemEpics({\n\t\t\t\titemIds: itemIds,\n\t\t\t\tepicId: epicId\n\t\t\t})\n\t\t\t\t.then((response) => {})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\n\t\tthis.tagSearcher.unsubscribeAll('hideEpicDialog');\n\t\tthis.tagSearcher.subscribe('hideEpicDialog', () => {\n\t\t\tthis.destroyActionPanel();\n\t\t\tentity.deactivateGroupMode();\n\t\t});\n\t}\n\n\tremoveGroupItems(entity: Entity): Promise\n\t{\n\t\tconst itemIds = [];\n\n\t\tentity.getGroupModeItems().forEach((groupModeItem: Item) => {\n\n\t\t\titemIds.push(groupModeItem.getId());\n\n\t\t\tthis.pullItem.addIdToSkipRemoving(groupModeItem.getId());\n\t\t});\n\n\t\treturn this.requestSender.removeItems({\n\t\t\titemIds: itemIds,\n\t\t\tsortInfo: this.itemMover.calculateSort(entity.getListItemsNode())\n\t\t}).catch((response) => {\n\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t});\n\t}\n\n\tstartBacklogDecomposition(entity: Entity, parentItem: Item)\n\t{\n\t\tthis.decomposition = new Decomposition({\n\t\t\tparentItem: parentItem\n\t\t});\n\n\t\tif (!parentItem.isLinkedTask())\n\t\t{\n\t\t\tthis.itemDesigner.getRandomColorForItemBorder()\n\t\t\t\t.then((randomColor: string) => {\n\t\t\t\t\tparentItem.setBorderColor(randomColor);\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\n\t\tthis.showInput(entity, parentItem.getNode());\n\t}\n\n\tstartSprintDecomposition(entity: Entity, parentItem: Item)\n\t{\n\t\tthis.decomposition = new Decomposition({\n\t\t\tparentItem: parentItem\n\t\t});\n\n\t\tparentItem.activateDecompositionMode();\n\n\t\tconst renderInputAfterSubTasks = (subTasks: SubTasks) => {\n\t\t\tif (!subTasks.isShown())\n\t\t\t{\n\t\t\t\tentity.appendNodeAfterItem(subTasks.render(), parentItem.getNode());\n\t\t\t}\n\t\t\tparentItem.showSubTasks();\n\n\t\t\tthis.showInput(entity, subTasks.getNode());\n\t\t}\n\n\t\tif (parentItem.isParentTask())\n\t\t{\n\t\t\tconst subTasks = parentItem.getSubTasks();\n\n\t\t\tif (subTasks.isEmpty())\n\t\t\t{\n\t\t\t\tthis.requestSender.getSubTaskItems({\n\t\t\t\t\tentityId: entity.getId(),\n\t\t\t\t\ttaskId: parentItem.getSourceId()\n\t\t\t\t})\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tresponse.data.forEach((itemParams: ItemParams) => {\n\t\t\t\t\t\t\tconst subTaskItem = Item.buildItem(itemParams);\n\t\t\t\t\t\t\tentity.setItem(subTaskItem);\n\t\t\t\t\t\t\tsubTasks.addTask(subTaskItem);\n\t\t\t\t\t\t});\n\t\t\t\t\t\trenderInputAfterSubTasks(subTasks);\n\t\t\t\t\t})\n\t\t\t\t\t.catch((response) => {\n\t\t\t\t\t\tthis.requestSender.showErrorAlert(response);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\trenderInputAfterSubTasks(subTasks);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showInput(entity, parentItem.getNode());\n\t\t}\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\ntype Params = {\n\tcanCompleteSprint: boolean\n}\n\nexport class CompleteSprintButton extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.canCompleteSprint = params.canCompleteSprint;\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ActiveSprintButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst disableUiClass = (this.canCompleteSprint ? '' : 'ui-btn-disabled');\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-primary ui-btn-xs ui-btn-round ui-btn-no-caps ${disableUiClass}\">\n\t\t\t\t<span>\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ACTIONS_COMPLETE_SPRINT')}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onCompleteSprintClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonCompleteSprintClick()\n\t{\n\t\tif (this.canCompleteSprint)\n\t\t{\n\t\t\tthis.emit('completeSprint');\n\t\t}\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../../service/side.panel';\n\nimport '../../css/robot.button.css';\n\ntype Params = {\n\tsidePanel: SidePanel,\n\tgroupId: number,\n\tisTaskLimitsExceeded: boolean,\n\tcanUseAutomation: boolean\n}\n\nexport class RobotButton extends EventEmitter\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.sidePanel = params.sidePanel;\n\t\tthis.isTaskLimitsExceeded = params.isTaskLimitsExceeded;\n\t\tthis.canUseAutomation = params.canUseAutomation;\n\t\tthis.groupId = params.groupId;\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.RobotButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet className = 'tasks-scrum-robot-btn ui-btn ui-btn-light-border ui-btn-no-caps ui-btn-themes ui-btn-round';\n\t\tif (this.isShowLimitSidePanel())\n\t\t{\n\t\t\tclassName += ' ui-btn-icon-lock';\n\t\t}\n\n\t\tconst node = Tag.render`\n\t\t\t<button class=\"${className}\">\n\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ROBOTS_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonClick()\n\t{\n\t\tif (this.isShowLimitSidePanel())\n\t\t{\n\t\t\tBX.UI.InfoHelper.show('limit_tasks_robots', {\n\t\t\t\tisLimit: true,\n\t\t\t\tlimitAnalyticsLabels: {\n\t\t\t\t\tmodule: 'tasks',\n\t\t\t\t\tsource: 'scrumActiveSprint',\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst url = '/bitrix/components/bitrix/tasks.automation/slider.php?site_id='\n\t\t\t\t+ Loc.getMessage('SITE_ID') + '&project_id=' + this.groupId;\n\n\t\t\tthis.sidePanel.openSidePanel(url, {customLeftBoundary: 0, cacheable: false});\n\t\t}\n\t}\n\n\tisShowLimitSidePanel(): boolean\n\t{\n\t\treturn (this.isTaskLimitsExceeded && !this.canUseAutomation);\n\t}\n}","import {Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {View, Views} from './view';\nimport {CompleteSprintButton} from './header/complete.sprint.button';\nimport {RobotButton} from './header/robot.button';\n\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\n\nimport {StatsBuilder} from '../entity/sprint/stats/stats.builder';\n\ntype Params = {\n\tactiveSprintId: number,\n\tviews: Views,\n\ttaskLimitExceeded: 'Y' | 'N',\n\tcanUseAutomation: 'Y' | 'N',\n\tcanCompleteSprint: 'Y' | 'N'\n}\n\nexport class ActiveSprint extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.ActiveSprint');\n\n\t\tthis.setParams(params);\n\n\t\tif (this.existActiveSprint())\n\t\t{\n\t\t\tthis.bindHandlers();\n\t\t}\n\n\t\tthis.sidePanel = new SidePanel();\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderSprintStatsTo(container);\n\n\t\t// todo ger data for sprint from server\n\t\tif (this.sprint)\n\t\t{\n\t\t\tthis.stats = StatsBuilder.build(this.sprint);\n\t\t\tthis.stats.setKanbanStyle();\n\n\t\t\tDom.append(this.stats.render(), container);\n\t\t}\n\t}\n\n\trenderRightElementsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderRightElementsTo(container);\n\n\t\tif (!this.existActiveSprint())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.canCompleteSprint) // todo change to can robot access\n\t\t{\n\t\t\tconst robotButton = new RobotButton({\n\t\t\t\tsidePanel: this.sidePanel,\n\t\t\t\tgroupId: this.getCurrentGroupId(),\n\t\t\t\tisTaskLimitsExceeded: this.isTaskLimitsExceeded(),\n\t\t\t\tcanUseAutomation: this.isCanUseAutomation()\n\t\t\t});\n\n\t\t\tDom.append(robotButton.render(), container);\n\t\t}\n\n\t\tconst completeSprintButton = new CompleteSprintButton({\n\t\t\tcanCompleteSprint: this.canCompleteSprint\n\t\t});\n\t\tcompleteSprintButton.subscribe('completeSprint', this.onCompleteSprint.bind(this));\n\n\t\tDom.append(completeSprintButton.render(), container);\n\n\t\tDom.addClass(container, '--without-bg');\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.activeSprintId = parseInt(params.activeSprintId, 10);\n\n\t\tthis.setTaskLimitsExceeded(params.taskLimitExceeded);\n\t\tthis.setCanUseAutomation(params.canUseAutomation);\n\n\t\tthis.views = params.views;\n\n\t\tthis.canCompleteSprint = (params.canCompleteSprint === 'Y');\n\t}\n\n\tsetTaskLimitsExceeded(limitExceeded: string)\n\t{\n\t\tthis.limitExceeded = (limitExceeded === 'Y');\n\t}\n\n\tisTaskLimitsExceeded(): boolean\n\t{\n\t\treturn this.limitExceeded;\n\t}\n\n\tsetCanUseAutomation(canUseAutomation: string)\n\t{\n\t\tthis.canUseAutomation = (canUseAutomation === 'Y');\n\t}\n\n\tisCanUseAutomation(): boolean\n\t{\n\t\treturn this.canUseAutomation;\n\t}\n\n\texistActiveSprint(): boolean\n\t{\n\t\treturn this.activeSprintId > 0;\n\t}\n\n\tbindHandlers()\n\t{\n\t\t// eslint-disable-next-line\n\t\tconst kanbanManager = BX.Tasks.Scrum.Kanban;\n\t\tif (kanbanManager)\n\t\t{\n\t\t\tthis.bindKanbanHandlers(kanbanManager.getKanban());\n\t\t\tkanbanManager.getKanbansGroupedByParentTasks().forEach((kanban) => {\n\t\t\t\tthis.bindKanbanHandlers(kanban);\n\t\t\t});\n\t\t}\n\t}\n\n\tbindKanbanHandlers(kanban)\n\t{\n\t\tEventEmitter.subscribe(kanban, 'Kanban.Grid:onItemMoved', (event: BaseEvent) => {\n\t\t\tconst [kanbanItem, targetColumn, beforeItem] = event.getCompatData();\n\t\t\tthis.onItemMoved(kanbanItem, targetColumn, beforeItem);\n\t\t});\n\t}\n\n\tonCompleteSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tgroupId: this.groupId,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tviews: this.views\n\t\t});\n\t\tsprintSidePanel.showCompletionForm();\n\n\t\tsprintSidePanel.subscribe('showTask', (innerBaseEvent: BaseEvent) => {\n\t\t\tthis.sidePanel.openSidePanelByUrl(this.getPathToTask().replace('#task_id#', innerBaseEvent.getData()));\n\t\t});\n\t}\n\n\t/**\n\t * Hook on item moved.\n\t * @param {BX.Tasks.Kanban.Item} kanbanItem\n\t * @param {BX.Tasks.Kanban.Column} targetColumn\n\t * @param {BX.Tasks.Kanban.Item} [beforeItem]\n\t * @returns {void}\n\t */\n\tonItemMoved(kanbanItem, targetColumn, beforeItem)\n\t{\n\t\t// todo update stats\n\t\t//this.stats.setSprintData(this.sprint);\n\t}\n}","import {Event, Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class BurnDownButton extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.BurnDownButton');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-primary ui-btn-xs ui-btn-round ui-btn-no-caps\">\n\t\t\t\t<span>\n\t\t\t\t\t${Loc.getMessage('TASKS_SCRUM_ACTIVE_SPRINT_BUTTON')}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.onClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\tonClick()\n\t{\n\t\tthis.emit('click');\n\t}\n}","import {Dom, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {SidePanel} from '../service/side.panel';\n\nimport {Sprint} from '../entity/sprint/sprint';\nimport {SprintSidePanel} from '../entity/sprint/sprint.side.panel';\n\nimport {View} from './view';\nimport {BurnDownButton} from './header/burn.down.button';\n\nimport type {Views} from './view';\nimport type {SprintParams} from '../entity/sprint/sprint';\n\ntype Params = {\n\tviews: Views,\n\tcompletedSprint: SprintParams,\n\tsprints: Array<SprintParams>,\n\tpathToBurnDown: string\n}\n\nexport class CompletedSprint extends View\n{\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.CompletedSprint');\n\n\t\tthis.setParams(params);\n\n\t\tthis.bindHandlers();\n\t}\n\n\trenderRightElementsTo(container: HTMLElement)\n\t{\n\t\tsuper.renderRightElementsTo(container);\n\n\t\tif (this.completedSprint === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst burnDownButton = new BurnDownButton();\n\t\tburnDownButton.subscribe('click', this.onShowSprintBurnDownChart.bind(this));\n\n\t\tDom.addClass(container, '--without-bg');\n\n\t\tDom.append(burnDownButton.render(), container);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tif (Type.isArray(params.completedSprint))\n\t\t{\n\t\t\tthis.completedSprint = null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.completedSprint = new Sprint(params.completedSprint);\n\t\t}\n\n\t\tthis.sidePanel = new SidePanel();\n\n\t\tthis.sprints = new Map();\n\t\tparams.sprints.forEach((sprintData) => {\n\t\t\tconst sprint = Sprint.buildSprint(sprintData);\n\t\t\tthis.sprints.set(sprint.getId(), sprint);\n\t\t});\n\t\tthis.views = params.views;\n\n\t\tthis.pathToBurnDown = params.pathToBurnDown;\n\t}\n\n\tbindHandlers()\n\t{\n\t\tEventEmitter.subscribe('onTasksGroupSelectorChange', this.onSprintSelectorChange.bind(this));\n\t}\n\n\tonSprintSelectorChange(event: BaseEvent)\n\t{\n\t\tconst [currentSprint] = event.getCompatData()\n\n\t\tthis.completedSprint = this.findSprintBySprintId(currentSprint.sprintId);\n\t}\n\n\tonShowSprintBurnDownChart(baseEvent: BaseEvent)\n\t{\n\t\tconst sprintSidePanel = new SprintSidePanel({\n\t\t\tgroupId: this.groupId,\n\t\t\tsidePanel: this.sidePanel,\n\t\t\tviews: this.views,\n\t\t\tpathToBurnDown: this.pathToBurnDown\n\t\t});\n\t\tsprintSidePanel.showBurnDownChart(this.completedSprint);\n\t}\n\n\tfindSprintBySprintId(sprintId: number): Sprint\n\t{\n\t\treturn [...this.sprints.values()].find((sprint) => sprint.getId() === parseInt(sprintId, 10));\n\t}\n}","import {Dom} from 'main.core';\n\nimport {View} from './view/view';\nimport {Plan} from './view/plan/plan';\nimport {ActiveSprint} from './view/active.sprint';\nimport {CompletedSprint} from './view/completed.sprint';\n\nimport {Culture, CultureData} from './utility/culture';\n\ntype Params = {\n\tviewName: string,\n\tculture: CultureData\n}\n\nexport class Entry\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.setParams(params);\n\n\t\tthis.buildView(params);\n\t}\n\n\tsetParams(params: Params)\n\t{\n\t\tthis.setViewName(params.viewName);\n\n\t\tCulture.getInstance().setData(params.culture);\n\t}\n\n\tsetViewName(viewName: string)\n\t{\n\t\tconst availableViews = new Set([\n\t\t\t'plan',\n\t\t\t'activeSprint',\n\t\t\t'completedSprint'\n\t\t]);\n\n\t\tif (!availableViews.has(viewName))\n\t\t{\n\t\t\tthrow Error('Invalid value to activeView parameter');\n\t\t}\n\n\t\tthis.viewName = viewName;\n\t}\n\n\tgetViewName(): string\n\t{\n\t\treturn this.viewName;\n\t}\n\n\tsetView(view: View)\n\t{\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.view = view;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.view = null;\n\t\t}\n\t}\n\n\tgetView(): View\n\t{\n\t\treturn this.view;\n\t}\n\n\tbuildView(params: Params)\n\t{\n\t\tconst viewName = this.getViewName();\n\n\t\tif (viewName === 'plan')\n\t\t{\n\t\t\tthis.setView(new Plan(params));\n\t\t}\n\t\telse if (viewName === 'activeSprint')\n\t\t{\n\t\t\tthis.setView(new ActiveSprint(params));\n\t\t}\n\t\telse if (viewName === 'completedSprint')\n\t\t{\n\t\t\tthis.setView(new CompletedSprint(params));\n\t\t}\n\t}\n\n\trenderTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderTo(container);\n\t\t}\n\t}\n\n\trenderTabsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderTabsTo(container);\n\t\t}\n\t}\n\n\trenderSprintStatsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderSprintStatsTo(container);\n\t\t}\n\t}\n\n\trenderRightElementsTo(container: HTMLElement)\n\t{\n\t\tconst view = this.getView();\n\t\tif (view instanceof View)\n\t\t{\n\t\t\tthis.getView().renderRightElementsTo(container);\n\t\t}\n\t}\n\n\tsetDisplayPriority(menuItem: HTMLElement, value: string)\n\t{\n\t\tif (!Dom.hasClass(menuItem, 'menu-popup-item-accept'))\n\t\t{\n\t\t\tthis.refreshIcons(menuItem);\n\n\t\t\tconst view = this.getView();\n\t\t\tif (view instanceof View)\n\t\t\t{\n\t\t\t\tthis.getView().setDisplayPriority(value);\n\t\t\t}\n\t\t}\n\t}\n\n\trefreshIcons(item: HTMLElement)\n\t{\n\t\titem.parentElement.childNodes.forEach((element) => {\n\t\t\tDom.removeClass(element, 'menu-popup-item-accept');\n\t\t});\n\n\t\tDom.addClass(item, 'menu-popup-item-accept');\n\t}\n}\n"],"names":["SidePanel","setEventNamespace","sidePanelManager","BX","Instance","bindEvents","EventEmitter","subscribe","event","getCompatData","sliderEvent","sidePanel","getSlider","setCacheable","emit","currentSidePanel","Boolean","getPreviousSlider","topSidePanel","getTopSlider","reload","close","previousSidePanel","url","open","id","options","name","params","extensionName","toLowerCase","top","Runtime","loadExtension","then","exports","replaceAll","extension","show","RequestSender","signedParameters","debugMode","action","data","Promise","resolve","reject","ajax","runAction","analyticsLabel","runComponentAction","mode","sendRequestToComponent","scrum","sendRequest","response","alertTitle","Type","isUndefined","errors","length","firstError","shift","errorCode","code","message","title","Loc","getMessage","MessageBox","alert","Filter","filterId","requestSender","searchFieldApplied","initUiFilterManager","bindHandlers","filterManager","Main","getById","onApplyFilter","bind","getSearch","getContainer","filterSearchContainer","getSearchContainer","isNodeInViewport","scrollIntoView","values","filterInstance","promise","getSearchString","autoResolve","item","fieldInstances","getField","fieldOptions","getFieldByName","found","ITEMS","find","listItem","NAME","push","itemsNode","node","querySelector","items","Dom","attr","value","getApi","extendFilter","reduce","res","filterFieldsValues","getFilterFieldsValues","resetFilter","applyFilter","element","rect","getBoundingClientRect","left","bottom","window","innerHeight","document","documentElement","clientHeight","right","innerWidth","clientWidth","Tabs","views","planTabActiveClass","active","activeTabActiveClass","completedTabActiveClass","Tag","render","Text","encode","querySelectorAll","forEach","tab","Event","getTopSidePanel","showLoader","View","isOwnerCurrentUser","loadItemsRepeatCounter","Map","filter","scrumManager","userId","parseInt","groupId","pathToTask","isString","baseEvent","clear","container","isDomNode","Error","tabs","append","availableValues","Set","has","DiskManager","targetElement","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","attachedIds","controlId","getRandom","popup","Popup","content","getAttachmentsLoaderContent","autoHide","closeByEsc","angle","offsetTop","offsetLeft","Disk","UF","add","UID","controlName","hideSelectDialog","filesChooser","contentContainer","onCustomEvent","DiskFileDialog","openDiskFileDialog","isClickInside","contains","getPopupContainer","popupWindow","addCustomEvent","onFileUploadSuccess","fileResult","uf","file","uploaderFile","element_id","toString","Toggle","visible","shown","disabled","onClick","isDisabled","disable","isShown","unDisable","Tool","string","replace","Name","trim","important","isImportant","completed","isCompleted","sourceId","visualClasses","words","split","lastWord","RegExp","escapeRegex","addClass","removeClass","Checklist","complete","isInteger","all","uiClasses","Files","count","Comments","taskCounter","isNull","color","Epic","epic","isArray","description","createdBy","modifiedBy","colorBorder","convertHexToRGBA","colorBackground","visibility","hexCode","opacity","hex","r","substring","g","b","Tags","tags","map","tag","target","textContent","JSON","stringify","getValue","Responsible","responsible","isPlainObject","src","photo","photoStyle","encodeURI","StoryPointsStorage","storyPoints","isFloat","isNaN","parseFloat","toFixed","String","StoryPoints","storyPointsStorage","setPoints","disableStatus","getPoints","isEmpty","input","onBlur","onKeyDown","isDisable","inputContainer","firstElementChild","focus","setSelectionRange","currentValue","isComposing","key","blur","SubTasks","parentItem","list","removeYourself","onTransitionEnd","getNode","remove","size","set","getId","hideLoader","renderSubTasks","style","scrollHeight","height","innerHTML","loader","listPosition","getPosition","Loader","offset","width","hide","isHide","Item","groupMode","decompositionMode","toggle","checklist","files","comments","subTasks","setItemParams","shortView","setId","setGroupId","setTmpId","tmpId","setSort","sort","setEntityId","entityId","setEntityType","entityType","setSourceId","setInfo","info","setSubTasksInfo","subTasksInfo","setParentTask","isParentTask","setLinkedTask","isLinkedTask","setParentTaskId","parentTaskId","setSubTask","isSubTask","setCompleted","setDisableStatus","setAllowedActions","allowedActions","setImportant","onShowToggle","onHideToggle","inputName","getSourceId","inputEpic","isShortView","renderFullView","updateTagsVisibility","inputTags","replaceTags","getData","inputResponsible","onResponsibleClick","inputStoryPoints","onSetStoryPoints","dataset","setPreviousSort","previousSort","updateBorderColor","strikeOut","unStrikeOut","getSubTasksInfo","Object","keys","parentTask","setToggle","getSubTasksCount","linkedTask","subTask","borderColor","getBorderColor","colorNode","getEntityType","moveActivity","status","checked","getSubTasks","cleanTasks","tmpItem","getName","setName","getChecklist","setChecklist","getComplete","getAll","getFiles","setFiles","getComments","setComments","getEpic","setEpic","getTags","isEqualTags","setTags","getResponsible","setResponsible","getStoryPoints","setStoryPoints","getEntityId","getParentTaskId","renderShortView","typeClass","subClass","linkedClass","entityClass","getSort","onItemClick","tagsContainer","tagsNode","tagNode","tagList","hasClass","hasNode","isGroupMode","responsibleDialog","isOpen","preselectedItems","Dialog","targetNode","enableSearch","context","dropdownMode","events","selectedItem","getTitle","getAvatar","entities","getGroupId","dynamicLoad","itemId","hideSubTasks","parentNode","searchNode","skipParent","result","isEqualNode","nodes","getElementsByTagName","k","IntersectionObserver","observer","entries","isIntersecting","blink","disconnect","threshold","observe","setTimeout","checkListComplete","checkListAll","attachedFilesCount","setSubTasks","ListItems","entity","getItems","renderLoader","TagSearcher","filterService","tagsAreConverting","allTags","messageViewed","epicName","avatar","tagsList","epicList","epicId","showConvertingMessage","choiceWasMade","statusSuccess","tagDialog","multiple","compactView","searchOptions","allowCreateItem","footer","Tasks","EntitySelector","Footer","footerOptions","taskId","clearUnavailableItems","getTarget","getFooterContainer","zIndex","onShowTaskEditCallback","hideDialogLabel","deselectedItem","onSearchCallback","tagSelectorOptions","onInput","selector","dialog","getDialog","label","getTextBoxValue","currentEpic","selectedItems","currentEpicInfo","get","epicDialog","getEpicList","hideOnDeselect","searchQuery","getQuery","createEpic","addEpicToSearcher","addItemToListTypeField","VALUE","epicDialogItem","getEpicById","selected","addItem","getSelectedItems","textBoxWidth","placeholder","inputObject","enteredQuery","setTagsSearchMode","getInputNode","tagSearchDialog","getNodeId","offsetWidth","tabOptions","onLoadTaskQuickCreateCallback","newValue","regex","currentPiece","pop","pieceOfValue","deselect","isNil","searchTab","getSearchTab","isEmptyResult","search","epicSearchDialog","epicEnteredQuery","setSelectedEpicLength","getEpicByName","setEpicSearchMode","lastSearchQuery","getLastSearchQuery","query","hidden","tagName","newTag","addTag","success","alertClass","showAlert","error","removeAlert","addEventListener","handler","type","ctrlKey","metaKey","keyCode","getTagSelectorQuery","itemIds","updateTaskTags","select","setBadges","group","getTagSelector","clearTextBox","focusSearch","selectFirstTab","ev","dialogId","className","messageType","UI","createElement","before","notification","buttons","MessageBoxButtons","OK","okCaption","onOk","inputText","tagRegExp","matches","match","exec","epicRegExp","Input","bindNode","taskCreated","selectedEpicLength","nodeId","onTagSearch","onEpicSearch","onKeydown","isTagsSearchMode","isEpicSearchMode","submit","stopImmediatePropagation","Browser","isMac","currentPieceOfName","enteredHashTags","getHashTagNamesFromText","createTaskItem","inputNode","enteredHashEpics","getHashEpicNamesFromText","isExists","Entity","groupModeItems","setEntityParams","observerLoadItems","listItems","itemLoader","itemsLoaderNode","blank","dropzone","emptySearchStub","setViews","setNumberTasks","numberTasks","setShortView","setMandatory","mandatoryExists","setExactSearchApplied","isExactSearchApplied","pageSize","setPageNumberItems","pageNumberItems","isShownSubTasks","getListNode","listItemsNode","getListItemsNode","newItem","subscribeToItem","setItemMoveActivity","getShortView","hideBlank","hideDropzone","hideEmptySearchStub","adjustListItemsWidth","setMoveActivity","unsubscribeAll","getList","removeItem","insertBefore","lastElementChild","exactSearchApplied","setStats","bindItemsLoader","itemNode","fistNode","nextElementSibling","activateGroupMode","deactivateGroupMode","removeItemFromGroupMode","addItemToGroupMode","loaderNode","getNumberItems","isActiveLoadItems","activeLoadItems","destroy","newItemNode","bindItemNode","getLoaderNode","hasListItemsScroll","getListItems","addScrollbar","removeScrollbar","Header","backlog","epicButtonLocked","taskButtonLocked","epicButton","taskButton","uiEpicClasses","uiTaskClasses","renderTaskCounterLabel","getNumberTasks","onEpicClick","onTaskClick","lockEpicButton","lockTaskButton","Blank","isBacklog","renderBacklog","renderCompletedSprint","Dropzone","renderSprint","renderSprintEmptyText","EmptySearchStub","getStubText","Backlog","setBacklogParams","header","itemData","buildItem","updateTaskCounter","onItemsScroll","backlogData","setHeader","setBlank","setDropzone","setEmptySearchStub","setListItems","Culture","dayMonthFormat","longDateFormat","shortTimeFormat","Date","sprint","isActive","getFormattedDateStart","getFormattedDateEnd","getDateStartFormatted","getDateEndFormatted","parentPopup","closest","customBlur","calendar","showCalendar","field","bTime","bSetFocus","bHideTime","bindOnce","updateDateNode","date","format","getInstance","getDayMonthFormat","Math","floor","parseDate","getTime","dateStartNode","dateEndNode","dateStartInput","dateEndInput","classList","stopPropagation","sprintId","dateStart","unbind","dateEnd","weekCount","getDefaultSprintDuration","getDateStart","getDateEnd","StatsCalculator","first","second","round","Stats","setSprintData","statsCalculator","kanbanMode","setCompletedStoryPoints","getCompletedStoryPoints","setUncompletedStoryPoints","getUncompletedStoryPoints","setEndDate","weekendDaysTime","getWeekendDaysTime","completedStoryPoints","uncompletedStoryPoints","endDate","now","CompletedStats","percentage","calculatePercentage","completedDate","getCompletedDate","getEndDate","HeaderDate","getFormattedTitleDatePeriod","getLongDateFormat","ExpiredStats","expiredDay","getExpiredDay","ActiveStats","remainingDays","getRemainingDays","dateWithWeekendOffset","setSeconds","getSeconds","setHours","msPerMinute","msPerHour","msPerDay","daysRemaining","StatsBuilder","isExpired","stats","build","renderEditInput","renderEdit","renderRemove","titleNode","editNode","isPlanned","removeNode","confirm","messageBox","ChartIcon","uiChartStyles","Counters","renderAverageNumberStoryPoints","Hint","createInstance","popupParameters","animation","init","getAverageNumberStoryPoints","Button","uiBtnStyles","Info","chartIcon","counters","button","disableUiClass","isAccessDenied","getUiClasses","getButtonText","getStatus","toUpperCase","canComplete","canStart","Tick","tick","setDate","getHeaderClass","upTick","downTick","setButton","setTick","Sprint","setSprintParams","hideCont","setDateStart","setDateEnd","setDateStartFormatted","dateStartFormatted","setDateEndFormatted","dateEndFormatted","setWeekendDaysTime","setDefaultSprintDuration","defaultSprintDuration","setAverageNumberStoryPoints","averageNumberStoryPoints","setStatus","setCompletedTasks","completedTasks","setUncompletedTasks","uncompletedTasks","setItems","buildHeader","onChangeName","onChangeSprintDeadline","toggleVisibilityContent","getContentContainer","sprintEnd","isNodeCreated","sprintSort","itemParams","sprintGoal","start","isNumber","availableStatus","disableButton","unDisableButton","tmpSprint","openClass","showEmptySearchStub","showDropzone","isSubTaskLoadingActive","subTaskLoadingActive","appendNodeAfterItem","showSubTasks","getCompletedTasks","getUncompletedTasks","activateEditMode","deactivateEditMode","requestData","hasOwnProperty","isHideContent","showContent","hideContent","unDisableToggle","EntityStorage","sprints","filteredCompletedSprints","entityFrom","activeSprint","getActiveSprint","getPlannedSprints","filledSprint","recalculateItemsSort","backlogItems","Scroller","planBuilder","entityStorage","isItemInViewport","isBacklogItem","scrollContainer","getBacklog","itemTopPosition","getRelativePosition","scrollTo","scrollTop","behavior","sprintsContainer","getSprintsContainer","position","hasItem","CompletedSprints","pageNumber","statsUploaded","sprintsUploaded","isActiveLoad","filteredSprintsNode","listNode","renderHeader","renderList","observerTargetNode","bindLoad","hideFilteredHeader","showHeader","btnStyles","btnNode","onBtnClick","currentTarget","isSprintsUploaded","hideList","showList","onLoadStats","renderObserverTarget","averageNumberTasks","averagePercentageCompletion","onLoadCompletedSprints","getCompletedSprintsStats","updateStats","showErrorAlert","getCompletedSprints","createSprints","nameNode","statsHeaderNode","numberSprints","renderStats","sprintData","buildSprint","addSprint","onAfterAppend","completedSprints","clean","addFilteredCompletedSprint","clearFilteredCompletedSprints","hideHeader","PlanBuilder","pageNumberToCompletedSprints","displayPriority","scroller","scrumContainer","setWidthPriority","renderSprintsContainer","getSprints","adjustSprintListWidth","plannedSprints","sprintsNode","renderSprintDropzone","existCompletedSprint","updatePlannedSprints","getFilteredCompletedSprints","showFilteredCompletedSprints","onSprintsScroll","sprintDropzone","createSprint","sprintParams","appendToPlannedContainer","scrollToSprint","removeSprint","parentElement","updateSprintContainers","hasScroll","activeContainer","plannedContainer","existActiveSprint","plannedSprint","disableHeaderButton","unDisableHeaderButton","showFilteredSprints","hideFilteredSprints","ActionPanel","bindElement","itemList","task","activity","attachment","dod","move","decomposition","isBlockBlur","hintManager","observeBindElement","calculatePanelPosition","createActionPanel","bindItems","body","hideHint","baseBtnClass","arrowClass","getSelectedText","getGroupModeItems","disableClass","sprintArrowClass","decClass","hintText","selectedBtn","callback","number","displayPanel","hidePanel","panel","fakePanel","cloneNode","isPanelWiderThanViewport","fakePanelRect","windowWidth","removeLastSeparator","actionPanel","SearchArrows","currentPosition","closeBtn","prevBtn","nextBtn","onClose","onPrev","onNext","SearchItems","currentIndex","arrows","startItem","linkedItemIds","setList","fadeOutAll","scrollToItem","getCurrent","updateCurrentIndexByItem","activateCurrent","activateLinkedMode","showArrows","fadeInAll","cleanList","removeArrows","getAllItems","inputItem","deactivateCurrent","index","updateArrows","currentItem","activateCurrentLinkedMode","deactivateCurrentLinkedMode","fadeOut","setActiveLoadItems","fadeIn","stop","moveToPrev","moveToNext","adjustArrowsPosition","updateCurrentPosition","arrowsRect","backlogRect","deactivateLinkedMode","SprintMover","onSetDraggable","dragEndEvent","endContainer","updateSprintSort","sortInfo","calculateSprintSort","increment","listSortInfo","SprintSidePanel","pathToBurnDown","showByExtension","location","href","openSidePanel","EntityCounters","entityIds","getEntityCounters","ItemMover","entityCounters","dragItems","lastOutContainer","draggableItems","addContainer","addDropzone","getDropzone","containers","dropZones","getSprintDropzone","Draggable","draggable","dragElement","CLONE","delay","onBeforeDragStart","onDragStart","onDragEnd","onDropEnd","onDropZoneEnter","onDropZoneOut","dragBeforeStartEvent","source","findItemByItemId","preventDefault","sourceContainer","sourceEntityId","sourceEntity","findEntityByEntityId","isMultipleDrag","addMultipleMode","getAllEntities","entityItem","blockScrumContainerSelect","dragStartEvent","removeMultipleMode","unblockScrumContainerSelect","isDropToZone","endEntityId","endEntity","onItemMove","dragGroupItems","dragDropEvent","isSprintDropzone","addSprintContainers","moveTo","insertDom","moveInCurrentContainer","onMoveConfirm","moveItemFromEntityToEntity","moveInAnotherContainer","children","entityTo","updateItemSort","calculateSort","updateEntityCounters","dragItem","isMoveInCurrentContainer","sortedDragItems","dragItemIds","groupedItem","findEntityByItemId","listToMove","isFirstItem","text","onclick","menuItem","sortedItems","sortedItemsIds","groupModeItem","moveItemToUp","activateBlinking","next","getMenuWindow","isLastItem","moveItemToDown","showMoveItemMenu","updateSort","updateItemsSort","Array","from","updateCounters","updatedItemsIds","moveToAnotherEntity","isSortUpdated","updatedItemId","targetEntity","bindButton","isMoveToSprint","getSprintsAvailableForFilling","showListSprintsToMove","moveToWithGroupMode","after","update","entityListNode","onMoveItemUpdate","isMoveFromAnotherEntity","itemSort","itemPreviousSortSort","getPreviousSort","bindItemSort","bindItem","appendItemAfterItem","getFirstItemNode","resortItems","setParentEntity","setItem","moveToSprintMenu","getPopupWindow","Menu","isSameSprint","addMenuItem","moveItemMenu","ItemDesigner","listAllUsedColors","randomColorCount","defaultColor","getAllUsedColors","getRandomColor","getAllColors","allColors","randomColor","random","isThisBorderColorAlreadyUse","isAlreadyUse","usedColor","getAllUsedItemBorderColors","itemIdsToUpdateColor","updateBorderColorToLinkedItems","fromEntries","updatedItems","setBorderColor","tagSearcher","subscribeToExtension","onAfterAdd","onAfterEdit","onAfterRemove","view","itemEpic","removeEpicFromSearcher","PullSprint","listIdsToSkipAdding","listIdsToSkipUpdating","listIdsToSkipRemoving","sprintAdded","onSprintAdded","sprintUpdated","onSprintUpdated","sprintRemoved","onSprintRemoved","needSkipAdd","cleanSkipAdd","getSprintData","createSprintNode","needSkipUpdate","cleanSkipUpdate","currentStatus","updateYourself","moveSprintToActiveListNode","moveSprintToCompletedListNode","needSkipRemove","cleanSkipRemove","PullItem","itemMover","currentUserId","listToAddAfterUpdate","listIdsToSkipSorting","onCalculateSort","itemAdded","onItemAdded","itemUpdated","onItemUpdated","itemRemoved","onItemRemoved","itemSortUpdated","onItemSortUpdated","comment_add","onCommentAdd","setDelayedAdd","externalAdd","cleanDelayedAdd","getItemData","addItemToEntity","isDelayedAdd","updateItem","itemsSortInfo","itemsInfoToSort","needSkipSort","itemsToSort","newItems","itemInfoToSort","targetEntityId","moveToPosition","participants","includes","xmlId","entityXmlId","findItemBySourceId","getCurrentState","isDecompositionMode","cleanSubTasks","hasTaskInFilter","existingItem","isParentChangeAction","prototype","call","addTmpIdToSkipSorting","PullEpic","epicAdded","onEpicAdded","epicUpdated","onEpicUpdated","epicRemoved","onEpicRemoved","epicData","BaseEvent","setData","PullCounters","task_view","onTaskView","scrum_read_all","onCommentsReadAll","inputTaskId","TASK_ID","inputUserId","USER_ID","findItemBySourceInFilteredCompletedSprints","GROUP_ID","TaskCounters","getFilterManager","updateFields","subscribeToPull","onFilterApply","onCounterClick","Pull","fields","counter","toggleByField","filterField","filterValue","isFilteredByField","isFilteredByFieldValue","getFilterFields","getAttribute","getFields","deleteField","apply","FilterHandler","containerPosition","getScrumContainer","filteredItemsData","completedSprint","appendItemToList","existsAtLeastOneItem","ceil","getPageSize","hideFilteredCompletedSprints","Decomposition","PullTag","tag_changed","onTagChanged","tagDialogs","getInstances","updatedTags","oldTagsNames","updatedTag","oldTagName","newTagName","itemsToUpdate","updatedTagFromArray","currentTags","array","tagInArr","newTags","Plan","pathToTaskCreate","defaultResponsible","activeSprintId","addBacklog","buildBacklog","taskCounters","pullSprint","addTmpIdToSkipAdding","subscribeToSprint","onActionPanelScroll","searchItems","sprintMover","itemDesigner","filterHandler","pullTag","getCurrentGroupId","pullItem","getCurrentUserId","pullEpic","onCreateTaskItem","onTagsSearchOpen","onTagsSearchClose","onEpicSearchOpen","onEpicSearchClose","onRenderInput","onRemoveInput","renderTo","ShortView","onChangeShortView","saveDisplayPriority","onShowBacklogInput","onOpenAddTaskForm","onUpdateItem","onShowTask","onDestroyActionPanel","onChangeTaskResponsible","onShowResponsibleDialog","onOpenEpicForm","onFilterByEpic","onFilterByTag","loadItems","onToggleActionPanel","onShowLinked","onShowBlank","onDeactivateGroupMode","destroyActionPanel","onkeydown","onDocumentKeyDown","onDocumentClick","onShowSprintInput","onCreateSprint","onGetSubTasks","onStartSprint","onCompleteSprint","onRemoveSprint","onChangeSprintName","onGetSprintCompletedItems","onShowSprintBurnDownChart","onOpenSprintAddMenu","onShowDropZone","prevented","diskManager","closeAttachmentMenu","showInput","unLockTaskButton","subscribeOnce","openSidePanelByUrl","deactivateDraggable","getEntity","activateDraggable","isTaskCreated","showBlank","getParentItem","deactivateDecompositionMode","createItem","addIdToSkipUpdating","getNumberDecompositionsPerformed","addNumberDecompositionsPerformed","sendRequestToCreateTask","fillItemAfterCreation","addTask","subTaskInfo","updateData","isStoryPointsUpdated","getSubTaskItems","subTaskItem","deactivateSubTaskLoading","changeTaskResponsible","openAddForm","unLockEpicButton","sprintSidePanel","showStartForm","showCompletionForm","innerBaseEvent","getPathToTask","addIdToSkipRemoving","changeSprintName","changeSprintDeadline","getSprintCompletedItems","showBurnDownChart","sprintAddMenu","buttonRect","setTarget","getMenuContainer","showTagsSearchDialog","closeTagsSearchDialog","getValueFromField","setValuesToField","scrollToSearchContainer","showEpicSearchDialog","closeEpicSearchDialog","setValueToField","saveShortView","repeatedClick","getItem","hasItemInGroupMode","showActionPanel","showLinkedTasks","filteredItems","allItems","calculatePanelTopPosition","hasActionPanelDialog","closeActionPanelDialogs","showItemsLoader","getPageNumberItems","incrementPageNumberItems","createItemsInEntity","decrementPageNumberItems","unbindItemsLoader","hasEntity","renderInput","setEntity","isElementNode","setBindNode","insertAfter","cleanBindNode","scrollToInput","topPosition","stopSearch","isMultipleAction","isEditAllowed","attachFilesToTask","showAttachmentMenu","showDod","isMovable","moveItem","moveToSprint","moveToBacklog","showTagSearcher","showEpicSearcher","startBacklogDecomposition","startSprintDecomposition","isRemoveAllowed","removeGroupItems","valueWithoutEpic","getInfo","createTask","responseData","skipNotifications","showTagsDialog","removeTaskTags","splice","indexOf","isEpicDialogShown","showEpicDialog","updateItemEpics","removeItems","getRandomColorForItemBorder","activateDecompositionMode","renderInputAfterSubTasks","CompleteSprintButton","canCompleteSprint","onCompleteSprintClick","RobotButton","isTaskLimitsExceeded","canUseAutomation","isShowLimitSidePanel","InfoHelper","isLimit","limitAnalyticsLabels","module","customLeftBoundary","cacheable","ActiveSprint","setParams","setKanbanStyle","robotButton","isCanUseAutomation","completeSprintButton","setTaskLimitsExceeded","taskLimitExceeded","setCanUseAutomation","limitExceeded","kanbanManager","Scrum","Kanban","bindKanbanHandlers","getKanban","getKanbansGroupedByParentTasks","kanban","kanbanItem","targetColumn","beforeItem","onItemMoved","BurnDownButton","CompletedSprint","burnDownButton","onSprintSelectorChange","currentSprint","findSprintBySprintId","Entry","buildView","setViewName","viewName","culture","availableViews","getViewName","setView","getView","renderTabsTo","renderSprintStatsTo","renderRightElementsTo","refreshIcons","setDisplayPriority","childNodes"],"mappings":";;;;;KAEaA,SAAb;CAAA;;CAEC,uBACA;CAAA;;CAAA;CACC;;CAEA,UAAKC,iBAAL,CAAuB,0BAAvB;CAEA;;;CACA,UAAKC,gBAAL,GAAwBC,EAAE,CAACH,SAAH,CAAaI,QAArC;CACA;;CAEA,UAAKC,UAAL;;CATD;CAUC;;CAbF;CAAA;CAAA,iCAgBC;CAAA;;CACCC,MAAAA,6BAAY,CAACC,SAAb,CAAuB,yBAAvB,EAAkD,UAACC,KAAD,EAAsB;CACvE,mCAAsBA,KAAK,CAACC,aAAN,EAAtB;CAAA;CAAA,YAAOC,WAAP;;CACA,YAAMC,SAAS,GAAGD,WAAW,CAACE,SAAZ,EAAlB;CACAD,QAAAA,SAAS,CAACE,YAAV,CAAuB,KAAvB;;CACA,QAAA,MAAI,CAACC,IAAL,CAAU,iBAAV,EAA6BH,SAA7B;CACA,OALD;CAOAL,MAAAA,6BAAY,CAACC,SAAb,CAAuB,0BAAvB,EAAmD,UAACC,KAAD,EAAsB;CACxE,oCAAsBA,KAAK,CAACC,aAAN,EAAtB;CAAA;CAAA,YAAOC,WAAP;;CACA,YAAMC,SAAS,GAAGD,WAAW,CAACE,SAAZ,EAAlB;;CACA,QAAA,MAAI,CAACE,IAAL,CAAU,kBAAV,EAA8BH,SAA9B;CACA,OAJD;CAKA;CA7BF;CAAA;CAAA,6CA+B0BI,gBA/B1B,EAgCC;CACC,aAAOC,OAAO,CAAC,KAAKd,gBAAL,CAAsBe,iBAAtB,CAAwCF,gBAAxC,CAAD,CAAd;CACA;CAlCF;CAAA;CAAA,sCAqCC;CACC,UAAMG,YAAY,GAAG,KAAKhB,gBAAL,CAAsBiB,YAAtB,EAArB;CAEA,aAAOD,YAAY,GAAGA,YAAH,GAAkB,IAArC;CACA;CAzCF;CAAA;CAAA,yCA4CC;CACC,UAAI,KAAKhB,gBAAL,CAAsBiB,YAAtB,EAAJ,EACA;CACC,aAAKjB,gBAAL,CAAsBiB,YAAtB,GAAqCC,MAArC;CACA;CACD;CAjDF;CAAA;CAAA,wCAoDC;CACC,UAAI,KAAKlB,gBAAL,CAAsBiB,YAAtB,EAAJ,EACA;CACC,aAAKjB,gBAAL,CAAsBiB,YAAtB,GAAqCE,KAArC;CACA;CACD;CAzDF;CAAA;CAAA,4CA2DyBN,gBA3DzB,EA4DC;CACC,UAAMO,iBAAiB,GAAG,KAAKpB,gBAAL,CAAsBe,iBAAtB,CAAwCF,gBAAxC,CAA1B;CAEAO,MAAAA,iBAAiB,CAACF,MAAlB;CACA;CAhEF;CAAA;CAAA,uCAkEoBG,GAlEpB,EAmEC;CACC,WAAKrB,gBAAL,CAAsBsB,IAAtB,CAA2BD,GAA3B;CACA;CArEF;CAAA;CAAA,kCAuEeE,EAvEf,EAuEmBC,OAvEnB,EAwEC;CACC,WAAKxB,gBAAL,CAAsBsB,IAAtB,CAA2BC,EAA3B,EAA+BC,OAA/B;CACA;CA1EF;CAAA;CAAA,oCA4EiBC,IA5EjB,EA4E+BC,MA5E/B,EA6EC;CACC,UAAMC,aAAa,GAAG,iBAAiBF,IAAI,CAACG,WAAL,EAAvC;CAEA,aAAOC,GAAG,CAAC5B,EAAJ,CAAO6B,OAAP,CAAeC,aAAf,CAA6BJ,aAA7B,EACLK,IADK,CACA,UAACC,OAAD,EAAa;CAElBR,QAAAA,IAAI,GAAGA,IAAI,CAACS,UAAL,CAAgB,GAAhB,EAAqB,EAArB,CAAP;;CAEA,YAAID,OAAO,IAAIA,OAAO,CAACR,IAAD,CAAtB,EACA;CACC,cAAMU,SAAS,GAAG,IAAIF,OAAO,CAACR,IAAD,CAAX,CAAkBC,MAAlB,CAAlB;CAEAS,UAAAA,SAAS,CAACC,IAAV;CAEA,iBAAOD,SAAP;CACA,SAPD,MASA;CACC,iBAAO,IAAP;CACA;CACD,OAjBK,CAAP;CAmBA;CAnGF;CAAA;CAAA,EAA+B/B,6BAA/B;;KCOaiC,aAAb;CAEC,2BACA;CAAA,QADYb,OACZ,uEADsB,EACtB;CAAA;CACC,SAAKc,gBAAL,GAAyBd,OAAO,CAACc,gBAAR,GAA2Bd,OAAO,CAACc,gBAAnC,GAAsD,EAA/E;CACA,SAAKC,SAAL,GAAiBf,OAAO,CAACe,SAAzB;CACA;;CANF;CAAA;CAAA,0CASC;CACC,aAAO,KAAKD,gBAAZ;CACA;CAXF;CAAA;CAAA,gCAaaE,MAbb,EAcC;CAAA;;CAAA,UAD4BC,IAC5B,uEADmC,EACnC;CACC,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvCC,QAAAA,cAAI,CAACC,SAAL,CAAeN,MAAf,EAAuB;CACtBF,UAAAA,gBAAgB,EAAE,KAAI,CAACA,gBADD;CAEtBG,UAAAA,IAAI,EAAEA;CAFgB,SAAvB,EAGGT,IAHH,CAGQW,OAHR,EAGiBC,MAHjB;CAIA,OALM,CAAP;CAMA;CArBF;CAAA;CAAA,6CAwBC;CAAA;;CAAA,UADuBH,IACvB,uEAD8B,EAC9B;CAAA,UADkCD,MAClC;CAAA,UAD0CO,cAC1C,uEAD2D,EAC3D;CACCN,MAAAA,IAAI,CAACF,SAAL,GAAiB,KAAKA,SAAtB;CACA,aAAO,IAAIG,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvCC,QAAAA,cAAI,CAACG,kBAAL,CAAwB,oBAAxB,EAA8CR,MAA9C,EAAsD;CACrDS,UAAAA,IAAI,EAAE,OAD+C;CAErDX,UAAAA,gBAAgB,EAAE,MAAI,CAACA,gBAF8B;CAGrDG,UAAAA,IAAI,EAAEA,IAH+C;CAIrDM,UAAAA,cAAc,EAAEA;CAJqC,SAAtD,EAKGf,IALH,CAKQW,OALR,EAKiBC,MALjB;CAMA,OAPM,CAAP;CAQA;CAlCF;CAAA;CAAA,gCAoCaH,IApCb,EAqCC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,aAAlC,CAAP;CACA;CAvCF;CAAA;CAAA,mCAyCgBA,IAzChB,EA0CC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,gBAAlC,CAAP;CACA;CA5CF;CAAA;CAAA,2BA8CQA,IA9CR,EA+CC;CACC,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvCC,QAAAA,cAAI,CAACG,kBAAL,CAAwB,uBAAxB,EAAiD,QAAjD,EAA2D;CAC1DC,UAAAA,IAAI,EAAE,OADoD;CAE1DR,UAAAA,IAAI,EAAEA;CAFoD,SAA3D,EAGGT,IAHH,CAGQW,OAHR,EAGiBC,MAHjB;CAIA,OALM,CAAP;CAMA;CAtDF;CAAA;CAAA,qCAwDkBH,IAxDlB,EAyDC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,kBAAlC,CAAP;CACA;CA3DF;CAAA;CAAA,iCA6DcA,IA7Dd,EA8DC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,cAAlC,CAAP;CACA;CAhEF;CAAA;CAAA,gCAkEaA,IAlEb,EAmEC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,aAAlC,CAAP;CACA;CArEF;CAAA;CAAA,mCAuEgBA,IAvEhB,EAwEC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,gBAAlC,CAAP;CACA;CA1EF;CAAA;CAAA,+BA4EYA,IA5EZ,EA6EC;CACC,aAAO,KAAKS,sBAAL,CACNT,IADM,EAEN,YAFM,EAGN;CACCU,QAAAA,KAAK,EAAE,GADR;CAECX,QAAAA,MAAM,EAAE;CAFT,OAHM,CAAP;CAQA;CAtFF;CAAA;CAAA,+BAwFYC,IAxFZ,EAyFC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,YAAlC,CAAP;CACA;CA3FF;CAAA;CAAA,0CA6FuBA,IA7FvB,EA8FC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,uBAAlC,CAAP;CACA;CAhGF;CAAA;CAAA,oCAkGiBA,IAlGjB,EAmGC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,iBAAlC,CAAP;CACA;CArGF;CAAA;CAAA,oCAuGiBA,IAvGjB,EAwGC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,iBAAlC,CAAP;CACA;CA1GF;CAAA;CAAA,iCA4GcA,IA5Gd,EA6GC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,cAAlC,CAAP;CACA;CA/GF;CAAA;CAAA,qCAiHkBA,IAjHlB,EAkHC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,kBAAlC,CAAP;CACA;CApHF;CAAA;CAAA,yCAsHsBA,IAtHtB,EAuHC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,sBAAlC,CAAP;CACA;CAzHF;CAAA;CAAA,4CA2HyBA,IA3HzB,EA4HC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,yBAAlC,CAAP;CACA;CA9HF;CAAA;CAAA,wCAgIqBA,IAhIrB,EAiIC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,qBAAlC,CAAP;CACA;CAnIF;CAAA;CAAA,6CAqI0BA,IArI1B,EAsIC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,0BAAlC,CAAP;CACA;CAxIF;CAAA;CAAA,6BA0IUA,IA1IV,EA2IC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,UAAlC,CAAP;CACA;CA7IF;CAAA;CAAA,kCA+IeA,IA/If,EAgJC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,eAAlC,CAAP;CACA;CAlJF;CAAA;CAAA,wCAoJqBA,IApJrB,EAqJC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,qBAAlC,CAAP;CACA;CAvJF;CAAA;CAAA,sCAyJmBA,IAzJnB,EA0JC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,mBAAlC,CAAP;CACA;CA5JF;CAAA;CAAA,sCA8JmBA,IA9JnB,EA+JC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,mBAAlC,CAAP;CACA;CAjKF;CAAA;CAAA,mCAmKgBA,IAnKhB,EAoKC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,gBAAlC,CAAP;CACA;CAtKF;CAAA;CAAA,mCAwKgBA,IAxKhB,EAyKC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,gBAAlC,CAAP;CACA;CA3KF;CAAA;CAAA,oCA6KiBA,IA7KjB,EA8KC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,iBAAlC,CAAP;CACA;CAhLF;CAAA;CAAA,mDAkLgCA,IAlLhC,EAmLC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,gCAAlC,CAAP;CACA;CArLF;CAAA;CAAA,6BAuLUA,IAvLV,EAwLC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,UAAlC,CAAP;CACA;CA1LF;CAAA;CAAA,+BA4LYA,IA5LZ,EA6LC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,YAAlC,CAAP;CACA;CA/LF;CAAA;CAAA,gCAiMaA,IAjMb,EAkMC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,aAAlC,CAAP;CACA;CApMF;CAAA;CAAA,oCAsMiBA,IAtMjB,EAuMC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,iBAAlC,CAAP;CACA;CAzMF;CAAA;CAAA,+CA2M4BA,IA3M5B,EA4MC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,4BAAlC,CAAP;CACA;CA9MF;CAAA;CAAA,oCAgNiBA,IAhNjB,EAiNC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,iBAAlC,CAAP;CACA;CAnNF;CAAA;CAAA,+BAqNYA,IArNZ,EAsNC;CACC,aAAO,KAAKW,WAAL,CAAiB,oCAAjB,EAAuDX,IAAvD,CAAP;CACA;CAxNF;CAAA;CAAA,gCA0NaA,IA1Nb,EA2NC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,aAAlC,CAAP;CACA;CA7NF;CAAA;CAAA,kCA+NeA,IA/Nf,EAgOC;CACC,aAAO,KAAKS,sBAAL,CAA4BT,IAA5B,EAAkC,eAAlC,CAAP;CACA;CAlOF;CAAA;CAAA,mCAoOgBY,QApOhB,EAoOyCC,UApOzC,EAqOC;CACC,UAAIC,cAAI,CAACC,WAAL,CAAiBH,QAAQ,CAACI,MAA1B,CAAJ,EACA;CACC;CACA;;CAED,UAAIJ,QAAQ,CAACI,MAAT,CAAgBC,MAApB,EACA;CACC,YAAMC,UAAU,GAAGN,QAAQ,CAACI,MAAT,CAAgBG,KAAhB,EAAnB;;CACA,YAAID,UAAJ,EACA;CACC,cAAME,SAAS,GAAIF,UAAU,CAACG,IAAX,GAAkBH,UAAU,CAACG,IAA7B,GAAoC,EAAvD;CAEA,cAAMC,OAAO,GAAGJ,UAAU,CAACI,OAAX,GAAqB,GAArB,GAA2BF,SAA3C;CACA,cAAMG,KAAK,GAAIV,UAAU,GAAGA,UAAH,GAAgBW,aAAG,CAACC,UAAJ,CAAe,+BAAf,CAAzC;CAEAC,UAAAA,gCAAU,CAACC,KAAX,CAAiBL,OAAjB,EAA0BC,KAA1B;CACA;CACD;CACD;CAxPF;CAAA;CAAA;;;;;KCUaK,MAAb;CAAA;;CAEC,kBAAY3C,MAAZ,EACA;CAAA;;CAAA;CACC,wGAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,uBAAvB;;CAEA,UAAKuE,QAAL,GAAgB5C,MAAM,CAAC4C,QAAvB;CACA,UAAKC,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CAEA,UAAKC,kBAAL,GAA0B,KAA1B;;CAEA,UAAKC,mBAAL;;CACA,UAAKC,YAAL;;CAXD;CAYC;;CAfF;CAAA;CAAA,0CAkBC;CACC;CACA,WAAKC,aAAL,GAAqB1E,EAAE,CAAC2E,IAAH,CAAQD,aAAR,CAAsBE,OAAtB,CAA8B,KAAKP,QAAnC,CAArB;CACA;CACA;CAtBF;CAAA;CAAA,mCAyBC;CACClE,MAAAA,6BAAY,CAACC,SAAb,CAAuB,sBAAvB,EAA+C,KAAKyE,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAA/C;CACA;CA3BF;CAAA;CAAA,2CA8BC;CACC,aAAO,KAAKP,kBAAZ;CACA;CAhCF;CAAA;CAAA,yCAmCC;CACC,aAAO,KAAKG,aAAL,CAAmBK,SAAnB,GAA+BC,YAA/B,EAAP;CACA;CArCF;CAAA;CAAA,uCAwCC;CACC,aAAO,KAAKN,aAAZ;CACA;CA1CF;CAAA;CAAA,8CA6CC;CACC,UAAMO,qBAAqB,GAAG,KAAKC,kBAAL,EAA9B;;CAEA,UAAI,CAAC,KAAKC,gBAAL,CAAsBF,qBAAtB,CAAL,EACA;CACCA,QAAAA,qBAAqB,CAACG,cAAtB,CAAqC,IAArC;CACA;CACD;CApDF;CAAA;CAAA,kCAsDe/E,KAtDf,EAuDC;CACC,iCAA4DA,KAAK,CAACC,aAAN,EAA5D;CAAA;CAAA,UAAO+D,QAAP;CAAA,UAAiBgB,MAAjB;CAAA,UAAyBC,cAAzB;CAAA,UAAyCC,OAAzC;CAAA,UAAkD9D,MAAlD;;CAEA,UAAI6D,cAAc,CAACP,SAAf,GAA2BS,eAA3B,EAAJ,EACA;CACC,aAAKjB,kBAAL,GAA0B,IAA1B;CACA,OAHD,MAKA;CACC,aAAKA,kBAAL,GAA0B,KAA1B;CACA;;CAED,UAAI,KAAKF,QAAL,KAAkBA,QAAtB,EACA;CACC;CACA;;CAED5C,MAAAA,MAAM,CAACgE,WAAP,GAAqB,IAArB;CAEA,WAAK9E,IAAL,CAAU,aAAV,EAAyB;CACxB4E,QAAAA,OAAO,EAAEA;CADe,OAAzB;CAGA;CA7EF;CAAA;CAAA,2CA+EwB/D,IA/ExB,EA+EsCkE,IA/EtC,EAgFC;CACC;CAEA,UAAMC,cAAc,GAAG,KAAKjB,aAAL,CAAmBkB,QAAnB,CAA4BpE,IAA5B,CAAvB;CACA,UAAMqE,YAAY,GAAG,KAAKnB,aAAL,CAAmBoB,cAAnB,CAAkCtE,IAAlC,CAArB;;CAEA,UAAI,CAACmE,cAAD,IAAmB,CAACE,YAAxB,EACA;CACC;CACA;;CAED,UAAME,KAAK,GAAGJ,cAAc,CAACpE,OAAf,CAAuByE,KAAvB,CAA6BC,IAA7B,CAAkC,UAACC,QAAD;CAAA,eAAcA,QAAQ,CAACC,IAAT,KAAkBT,IAAI,CAACS,IAArC;CAAA,OAAlC,CAAd;;CACA,UAAI,CAAC7C,cAAI,CAACC,WAAL,CAAiBwC,KAAjB,CAAL,EACA;CACC;CACA;;CAEDJ,MAAAA,cAAc,CAACpE,OAAf,CAAuByE,KAAvB,CAA6BI,IAA7B,CAAkCV,IAAlC;CACAG,MAAAA,YAAY,CAACG,KAAb,CAAmBI,IAAnB,CAAwBV,IAAxB;CAEA,UAAMW,SAAS,GAAGV,cAAc,CAACW,IAAf,CAAoBC,aAApB,CAAkC,gBAAc/E,IAAd,GAAmB,GAArD,CAAlB;CAEA,UAAMgF,KAAK,GAAGC,aAAG,CAACC,IAAJ,CAASL,SAAT,EAAoB,YAApB,CAAd;CACAG,MAAAA,KAAK,CAACJ,IAAN,CAAWV,IAAX;CACAe,MAAAA,aAAG,CAACC,IAAJ,CAASL,SAAT,EAAoB,YAApB,EAAkCG,KAAlC;CACA;CAzGF;CAAA;CAAA,oCA2GiBG,KA3GjB,EA4GC;CACC,WAAKjC,aAAL,CAAmBkC,MAAnB,GAA4BC,YAA5B,iCAA2CF,KAAK,CAACnF,IAAjD,EAAwDmF,KAAK,CAACA,KAA9D;CACA;CA9GF;CAAA;CAAA,qCAgHkBtB,MAhHlB,EAiHC;CACC,WAAKX,aAAL,CAAmBkC,MAAnB,GAA4BC,YAA5B,CACCxB,MAAM,CAACyB,MAAP,CAAc,UAACC,GAAD,EAAMJ,KAAN;CAAA,+CAAsBI,GAAtB,uCAA4BJ,KAAK,CAACnF,IAAlC,EAAyCmF,KAAK,CAACA,KAA/C;CAAA,OAAd,EAAsE,EAAtE,CADD;CAGA;CArHF;CAAA;CAAA,sCAuHmBA,KAvHnB,EAwHC;CACC,UAAMK,kBAAkB,GAAG,KAAKtC,aAAL,CAAmBuC,qBAAnB,EAA3B;CACA,aAAOD,kBAAkB,CAACL,KAAK,CAACnF,IAAP,CAAzB;CACA;CA3HF;CAAA;CAAA,kCA8HC;CACC,WAAKkD,aAAL,CAAmBwC,WAAnB;CACA;CAhIF;CAAA;CAAA,kCAmIC;CACC,WAAKxC,aAAL,CAAmByC,WAAnB;CACA;CArIF;CAAA;CAAA,qCAuIkBC,OAvIlB,EAwIC;CACC,UAAMC,IAAI,GAAGD,OAAO,CAACE,qBAAR,EAAb;CACA,aACCD,IAAI,CAACzF,GAAL,IAAY,CAAZ,IACAyF,IAAI,CAACE,IAAL,IAAa,CADb,IAEAF,IAAI,CAACG,MAAL,KAAgBC,MAAM,CAACC,WAAP,IAAsBC,QAAQ,CAACC,eAAT,CAAyBC,YAA/D,CAFA,IAGAR,IAAI,CAACS,KAAL,KAAeL,MAAM,CAACM,UAAP,IAAqBJ,QAAQ,CAACC,eAAT,CAAyBI,WAA7D,CAJD;CAMA;CAhJF;CAAA;CAAA,EAA4B7H,6BAA5B;;;KCRa8H,IAAb;CAEC,gBAAYxG,MAAZ,EACA;CAAA;CACC,SAAKjB,SAAL,GAAiBiB,MAAM,CAACjB,SAAxB;CACA,SAAK0H,KAAL,GAAazG,MAAM,CAACyG,KAApB;CAEA,SAAK5B,IAAL,GAAY,IAAZ;CACA;;CARF;CAAA;CAAA,6BAWC;CAAA;;CACC,UAAM6B,kBAAkB,GACvB,KAAKD,KAAL,CAAW,MAAX,EAAmBE,MAAnB,GACE,oCADF,GAEE,EAHH;CAKA,UAAMC,oBAAoB,GACzB,KAAKH,KAAL,CAAW,cAAX,EAA2BE,MAA3B,GACE,oCADF,GAEE,EAHH;CAKA,UAAME,uBAAuB,GAC5B,KAAKJ,KAAL,CAAW,iBAAX,EAA8BE,MAA9B,GACE,oCADF,GAEE,EAHH;CAMA,WAAK9B,IAAL,GAAYiC,aAAG,CAACC,MAAhB,qdAGW,KAAKN,KAAL,CAAW,MAAX,EAAmB9G,GAH9B,EAIsC+G,kBAJtC,EAKKM,cAAI,CAACC,MAAL,CAAY,KAAKR,KAAL,CAAW,MAAX,EAAmB1G,IAA/B,CALL,EAOW,KAAK0G,KAAL,CAAW,cAAX,EAA2B9G,GAPtC,EAQsCiH,oBARtC,EASKI,cAAI,CAACC,MAAL,CAAY,KAAKR,KAAL,CAAW,cAAX,EAA2B1G,IAAvC,CATL,EAWW,KAAK0G,KAAL,CAAW,iBAAX,EAA8B9G,GAXzC,EAYsCkH,uBAZtC,EAaKG,cAAI,CAACC,MAAL,CAAY,KAAKR,KAAL,CAAW,iBAAX,EAA8B1G,IAA1C,CAbL;CAiBA,WAAK8E,IAAL,CAAUqC,gBAAV,CAA2B,GAA3B,EAAgCC,OAAhC,CAAwC,UAACC,GAAD,EAAsB;CAC7DC,QAAAA,eAAK,CAAChE,IAAN,CAAW+D,GAAX,EAAgB,OAAhB,EAAyB,YAAM;CAC9B,cAAM9H,YAAY,GAAG,KAAI,CAACP,SAAL,CAAeuI,eAAf,EAArB;;CACA,cAAIhI,YAAY,KAAK,IAArB,EACA;CACCA,YAAAA,YAAY,CAACiI,UAAb;CACA;CACD,SAND;CAOA,OARD;CAUA,aAAO,KAAK1C,IAAZ;CACA;CAxDF;CAAA;CAAA;;KCuBa2C,IAAb;CAAA;;CAEC,gBAAYxH,MAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,qBAAvB;;CAEA,UAAKoJ,kBAAL,GAA2BzH,MAAM,CAACyH,kBAAP,KAA8B,GAAzD;CAEA,UAAKC,sBAAL,GAA8B,IAAIC,GAAJ,EAA9B;CAEA,UAAK5I,SAAL,GAAiB,IAAIX,SAAJ,EAAjB;CAEA,UAAKyE,aAAL,GAAqB,IAAIlC,aAAJ,CAAkB;CACtCC,MAAAA,gBAAgB,EAAEZ,MAAM,CAACY,gBADa;CAEtCC,MAAAA,SAAS,EAAEb,MAAM,CAACa;CAFoB,KAAlB,CAArB;CAKA,UAAK+G,MAAL,GAAc,IAAIjF,MAAJ,CAAW;CACxBC,MAAAA,QAAQ,EAAE5C,MAAM,CAAC4C,QADO;CAExBiF,MAAAA,YAAY,2CAFY;CAGxBhF,MAAAA,aAAa,EAAE,MAAKA;CAHI,KAAX,CAAd;;CAKA,UAAK+E,MAAL,CAAYjJ,SAAZ,CAAsB,aAAtB,EAAqC,MAAKyE,aAAL,CAAmBC,IAAnB,2CAArC;;CAEA,UAAKyE,MAAL,GAAcC,QAAQ,CAAC/H,MAAM,CAAC8H,MAAR,EAAgB,EAAhB,CAAtB;CACA,UAAKE,OAAL,GAAeD,QAAQ,CAAC/H,MAAM,CAACgI,OAAR,EAAiB,EAAjB,CAAvB;CAEA,UAAKC,UAAL,GAAmBpG,cAAI,CAACqG,QAAL,CAAclI,MAAM,CAACiI,UAArB,IAAmCjI,MAAM,CAACiI,UAA1C,GAAuD,EAA1E;CA1BD;CA2BC;;CA9BF;CAAA;CAAA,kCAgCeE,SAhCf,EAiCC;CACC,WAAKT,sBAAL,CAA4BU,KAA5B;CACA;CAnCF;CAAA;CAAA,6BAqCUC,SArCV,EAsCC;CACC,UAAI,CAACxG,cAAI,CAACyG,SAAL,CAAeD,SAAf,CAAL,EACA;CACC,cAAM,IAAIE,KAAJ,CAAU,wCAAV,CAAN;CACA;CACD;CA3CF;CAAA;CAAA,iCA6CcF,SA7Cd,EA8CC;CACC,UAAI,CAACxG,cAAI,CAACyG,SAAL,CAAeD,SAAf,CAAL,EACA;CACC,cAAM,IAAIE,KAAJ,CAAU,uCAAV,CAAN;CACA;;CAED,UAAMC,IAAI,GAAG,IAAIhC,IAAJ,CAAS;CACrBzH,QAAAA,SAAS,EAAE,KAAKA,SADK;CAErB0H,QAAAA,KAAK,EAAE,KAAKA;CAFS,OAAT,CAAb;CAKAzB,MAAAA,aAAG,CAACyD,MAAJ,CAAWD,IAAI,CAACzB,MAAL,EAAX,EAA0BsB,SAA1B;CACA;CA1DF;CAAA;CAAA,wCA4DqBA,SA5DrB,EA6DC;CACC,UAAI,CAACxG,cAAI,CAACyG,SAAL,CAAeD,SAAf,CAAL,EACA;CACC,cAAM,IAAIE,KAAJ,CAAU,+CAAV,CAAN;CACA;CACD;CAlEF;CAAA;CAAA,0CAoEuBF,SApEvB,EAqEC;CACC,UAAI,CAACxG,cAAI,CAACyG,SAAL,CAAeD,SAAf,CAAL,EACA;CACC,cAAM,IAAIE,KAAJ,CAAU,0CAAV,CAAN;CACA;CACD;CA1EF;CAAA;CAAA,uCA4EoBrD,KA5EpB,EA6EC;CACC,UAAMwD,eAAe,GAAG,IAAIC,GAAJ,CAAQ,CAC/B,SAD+B,EAE/B,QAF+B,CAAR,CAAxB;;CAKA,UAAI,CAACD,eAAe,CAACE,GAAhB,CAAoB1D,KAApB,CAAL,EACA;CACC,cAAMqD,KAAK,CAAC,2CAAD,CAAX;CACA;CACD;CAvFF;CAAA;CAAA,uCA0FC;CACC,aAAO,KAAKT,MAAZ;CACA;CA5FF;CAAA;CAAA,wCA+FC;CACC,aAAO,KAAKE,OAAZ;CACA;CAjGF;CAAA;CAAA,oCAoGC;CACC,aAAO,KAAKC,UAAZ;CACA;CAtGF;CAAA;CAAA,EAA0BvJ,6BAA1B;;;KCxBamK,WAAb;CAAA;;CAEC,uBAAY7I,MAAZ,EACA;CAAA;;CAAA;CACC,6GAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,4BAAvB;;CAEA,UAAKyK,aAAL,GAAqB9I,MAAM,CAAC8I,aAA5B;CAEA,UAAKC,QAAL,GAAgB;CACfC,MAAAA,SAAS,EAAE,yDAAyDzG,aAAG,CAACC,UAAJ,CAAe,SAAf,CADrD;CAEfyG,MAAAA,aAAa,EAAE,6CAFA;CAGfC,MAAAA,aAAa,EAAE,6CAHA;CAIfC,MAAAA,SAAS,EAAE;CAJI,KAAhB;CAOA,UAAKC,WAAL,GAAmB,EAAnB;CAdD;CAeC;;CAlBF;CAAA;CAAA,uCAoBoBvE,IApBpB,EAqBC;CAAA;;CACC,UAAMwE,SAAS,GAAGrC,cAAI,CAACsC,SAAL,EAAlB;CAEA,WAAKC,KAAL,GAAa,IAAIC,gBAAJ,wCACoBxC,cAAI,CAACsC,SAAL,EADpB,GAEZzE,IAFY,EAGZ;CACC4E,QAAAA,OAAO,EAAE,KAAKC,2BAAL,CAAiCL,SAAjC,CADV;CAECM,QAAAA,QAAQ,EAAE,KAFX;CAGCC,QAAAA,UAAU,EAAE,IAHb;CAICC,QAAAA,KAAK,EAAE,KAJR;CAKCC,QAAAA,SAAS,EAAE,EALZ;CAMCC,QAAAA,UAAU,EAAE,CAAC;CANd,OAHY,CAAb;CAaA,WAAKR,KAAL,CAAW5K,SAAX,CAAqB,QAArB,EAA+B,YAAM;CACpCJ,QAAAA,EAAE,CAACyL,IAAH,CAAQC,EAAR,CAAWC,GAAX,CAAe;CACdC,UAAAA,GAAG,EAAEd,SADS;CAEde,UAAAA,WAAW,aAAMf,SAAN,QAFG;CAGdgB,UAAAA,gBAAgB,EAAE,KAHJ;CAIdrB,UAAAA,SAAS,EAAE,MAAI,CAACD,QAAL,CAAcC,SAJX;CAKdC,UAAAA,aAAa,EAAE,MAAI,CAACF,QAAL,CAAcE,aALf;CAMdC,UAAAA,aAAa,EAAE,MAAI,CAACH,QAAL,CAAcG,aANf;CAOdC,UAAAA,SAAS,EAAE,MAAI,CAACJ,QAAL,CAAcI;CAPX,SAAf;;CAUA,YAAMmB,YAAY,GAAG,MAAI,CAACf,KAAL,CAAWgB,gBAAX,CAA4BzF,aAA5B,CAA0C,gBAA1C,CAArB;CAEA;;;CACAvG,QAAAA,EAAE,CAACiM,aAAH,CAAiBF,YAAjB,EAA+B,wBAA/B,EAAyD,CAAC,MAAD,CAAzD;CACA;;CAEA,YAAI/L,EAAE,CAACkM,cAAP,EACA;CACC/L,UAAAA,6BAAY,CAACC,SAAb,CAAuBJ,EAAE,CAACkM,cAA1B,EAA0C,eAA1C,EAA2D,MAAI,CAACC,kBAAL,CAAwBrH,IAAxB,CAA6B,MAA7B,CAA3D;CACA;CACD,OArBD;CAuBA,WAAKkG,KAAL,CAAW5K,SAAX,CAAqB,SAArB,EAAgC,YAAM;CACrC,QAAA,MAAI,CAACO,IAAL,CAAU,UAAV,EAAsB,MAAI,CAACkK,WAA3B;CACA,OAFD;CAIA1K,MAAAA,6BAAY,CAACC,SAAb,CAAuB,UAAvB,EAAmC;CAAA,eAAM,MAAI,CAAC4K,KAAL,CAAW9J,KAAX,EAAN;CAAA,OAAnC;CAEA,WAAK8J,KAAL,CAAW7I,IAAX;CACA;CAnEF;CAAA;CAAA,0CAsEC;CACC,UAAI,KAAK6I,KAAT,EACA;CACC,aAAKA,KAAL,CAAW9J,KAAX;CACA;CACD;CA3EF;CAAA;CAAA,kCA6EeoF,IA7Ef,EA8EC;CACC,UAAI8F,aAAa,GAAG,KAApB;;CAEA,UAAI,KAAK7B,aAAL,CAAmB8B,QAAnB,CAA4B/F,IAA5B,CAAJ,EACA;CACC8F,QAAAA,aAAa,GAAG,IAAhB;CACA;;CAED,UAAI,KAAKpB,KAAL,IAAc,KAAKA,KAAL,CAAWsB,iBAAX,GAA+BD,QAA/B,CAAwC/F,IAAxC,CAAlB,EACA;CACC8F,QAAAA,aAAa,GAAG,IAAhB;CACA;;CAED,UACCpM,EAAE,CAACkM,cAAH,IACGlM,EAAE,CAACkM,cAAH,CAAkBK,WAAlB,KAAkC,IADrC,IAEGvM,EAAE,CAACkM,cAAH,CAAkBK,WAAlB,CAA8BD,iBAA9B,GAAkDD,QAAlD,CAA2D/F,IAA3D,CAHJ,EAKA;CACC8F,QAAAA,aAAa,GAAG,IAAhB;CACA;;CAED,aAAOA,aAAP;CACA;CArGF;CAAA;CAAA,yCAwGC;CAAA;;CACC,UAAIpM,EAAE,CAACkM,cAAH,CAAkBK,WAAlB,KAAkC,IAAtC,EACA;CACCvM,QAAAA,EAAE,CAACkM,cAAH,CAAkBK,WAAlB,CAA8BnM,SAA9B,CAAwC,SAAxC,EAAmD;CAAA,iBAAM,MAAI,CAAC4K,KAAL,CAAW9J,KAAX,EAAN;CAAA,SAAnD;CACA;CACD;CA7GF;CAAA;CAAA,gDA+G6B4J,SA/G7B,EAgHC;CACC,UAAMiB,YAAY,GAAGxD,aAAG,CAACC,MAAP,o5CAEcsC,SAFd,EAWeA,SAXf,EAaYA,SAbZ,EAcX9G,aAAG,CAACC,UAAJ,CAAe,8CAAf,CAdW,EAkBK6G,SAlBL,EA2BX9G,aAAG,CAACC,UAAJ,CAAe,yCAAf,CA3BW,EAgCLD,aAAG,CAACC,UAAJ,CAAe,2CAAf,CAhCK,CAAlB;CAwCA;;CACAjE,MAAAA,EAAE,CAACwM,cAAH,CAAkBT,YAAlB,EAAgC,qBAAhC,EAAuD,KAAKU,mBAAL,CAAyB3H,IAAzB,CAA8B,IAA9B,CAAvD;CACA;;CAEA,aAAOiH,YAAP;CACA;CA9JF;CAAA;CAAA,wCAgKqBW,UAhKrB,EAgKiCC,EAhKjC,EAgKqCC,IAhKrC,EAgK2CC,YAhK3C,EAiKC;CACC,UAAIvJ,cAAI,CAACC,WAAL,CAAiBqJ,IAAjB,KAA0BtJ,cAAI,CAACC,WAAL,CAAiBsJ,YAAjB,CAA9B,EACA;CACC;CACA;;CAED,WAAKhC,WAAL,CAAiBzE,IAAjB,CAAsBsG,UAAU,CAACI,UAAX,CAAsBC,QAAtB,EAAtB;CACA;CAxKF;CAAA;CAAA,EAAiC5M,6BAAjC;;;KCHa6M,MAAb;CAAA;;CAEC,kBAAYvL,MAAZ,EACA;CAAA;;CAAA;CACC,wGAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,4BAAvB;;CAEA,UAAKmN,OAAL,GAAexL,MAAM,CAACwL,OAAtB;CAEA,UAAKC,KAAL,GAAa,KAAb;CACA,UAAKC,QAAL,GAAgB,KAAhB;CARD;CASC;;CAZF;CAAA;CAAA,6BAeC;CACC,WAAK7G,IAAL,GAAYiC,aAAG,CAACC,MAAhB,kKACmD,KAAKyE,OAAL,GAAe,WAAf,GAA6B,EADhF;CAIAnE,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;CAEA,aAAO,KAAKwB,IAAZ;CACA;CAvBF;CAAA;CAAA,8BA0BC;CACC,aAAO,KAAKA,IAAZ;CACA;CA5BF;CAAA;CAAA,8BA+BC;CACC,UAAI,KAAK+G,UAAL,EAAJ,EACA;CACC;CACA;;CAED,WAAKC,OAAL;;CAEA,UAAI,KAAKC,OAAL,EAAJ,EACA;CACC,aAAK5M,IAAL,CAAU,MAAV;CACA,OAHD,MAKA;CACC,aAAKA,IAAL,CAAU,MAAV;CACA;CACD;CA/CF;CAAA;CAAA,2BAkDC;CACC,WAAKuM,KAAL,GAAa,IAAb;CAEA,WAAKM,SAAL;CACA;CAtDF;CAAA;CAAA,2BAyDC;CACC,WAAKN,KAAL,GAAa,KAAb;CAEA,WAAKM,SAAL;CACA;CA7DF;CAAA;CAAA,8BAgEC;CACC,aAAO,KAAKN,KAAZ;CACA;CAlEF;CAAA;CAAA,iCAqEC;CACC,aAAO,KAAKC,QAAZ;CACA;CAvEF;CAAA;CAAA,8BA0EC;CACC,WAAKA,QAAL,GAAgB,IAAhB;CACA;CA5EF;CAAA;CAAA,gCA+EC;CACC,WAAKA,QAAL,GAAgB,KAAhB;CACA;CAjFF;CAAA;CAAA,EAA4BhN,6BAA5B;;KCPasN,IAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,gCAEoBC,MAFpB,EAGC;CACC,aAAOA,MAAM,CAACC,OAAP,CAAe,wBAAf,EAAyC,MAAzC,CAAP;CACA;CALF;CAAA;CAAA;;;KCYaC,IAAb;CAAA;;CAEC,gBAAYnM,MAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,0BAAvB;;CAEA,UAAK6G,KAAL,GAAerD,cAAI,CAACqG,QAAL,CAAclI,MAAM,CAACD,IAArB,KAA8BC,MAAM,CAACD,IAAtC,GAA8CC,MAAM,CAACD,IAAP,CAAYqM,IAAZ,EAA9C,GAAmE,EAAjF;CACA,UAAKC,SAAL,GAAiBrM,MAAM,CAACsM,WAAxB;CACA,UAAKC,SAAL,GAAiBvM,MAAM,CAACwM,WAAxB;CACA,UAAKC,QAAL,GAAgBzM,MAAM,CAACyM,QAAvB;CAEA,UAAKxE,UAAL,GAAkB,MAAKwE,QAAL,GAAgBzM,MAAM,CAACiI,UAAP,CAAkBiE,OAAlB,CAA0B,WAA1B,EAAuC,MAAKO,QAA5C,CAAhB,GAAwE,IAA1F;;CAEA,QAAI,CAAC,MAAKvH,KAAV,EACA;CACC,YAAM,IAAIqD,KAAJ,CAAUhG,aAAG,CAACC,UAAJ,CAAe,iCAAf,CAAV,CAAN;CACA;;CAED,UAAKqC,IAAL,GAAY,IAAZ;CAjBD;CAkBC;;CArBF;CAAA;CAAA,6BAwBC;CAAA;;CACC,UAAI6H,aAAa,GAAG,KAAKH,SAAL,GAAiB,aAAjB,GAAiC,EAArD;CACAG,MAAAA,aAAa,IAAI,KAAKL,SAAL,GAAiB,cAAjB,GAAkC,EAAnD;CAEA,UAAInH,KAAK,GAAG8B,cAAI,CAACC,MAAL,CAAY,KAAK/B,KAAjB,CAAZ;;CACA,UAAI,KAAKmH,SAAT,EACA;CACC,YAAMM,KAAK,GAAG,KAAKzH,KAAL,CAAW0H,KAAX,CAAiB,GAAjB,CAAd;CACA,YAAMC,QAAQ,GAAGF,KAAK,CAACA,KAAK,CAAC3K,MAAN,GAAe,CAAhB,CAAtB;CACAkD,QAAAA,KAAK,GAAGA,KAAK,CAACgH,OAAN,CAAc,IAAIY,MAAJ,CAAWd,IAAI,CAACe,WAAL,CAAiBF,QAAjB,IAA6B,GAAxC,CAAd,kBAAqEA,QAArE,aAAR;CACA;;CAED,UAAI,KAAK5E,UAAT,EACA;CACC,aAAKpD,IAAL,GAAYiC,aAAG,CAACC,MAAhB,+NAEUC,cAAI,CAACC,MAAL,CAAY,KAAKgB,UAAjB,CAFV,EAGoCyE,aAHpC,EAKIxH,KALJ;CASAmC,QAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,YAAM;CACpC,UAAA,MAAI,CAAC3F,IAAL,CAAU,UAAV;CACA,SAFD;CAGA,OAdD,MAgBA;CACC,aAAK2F,IAAL,GAAYiC,aAAG,CAACC,MAAhB,mLACwC2F,aADxC,EAEIxH,KAFJ;CAMAmC,QAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;CACA;;CAED,aAAO,KAAKwB,IAAZ;CACA;CA/DF;CAAA;CAAA,8BAkEC;CACC,aAAO,KAAKA,IAAZ;CACA;CApEF;CAAA;CAAA,+BAuEC;CACC,aAAO,KAAKK,KAAZ;CACA;CAzEF;CAAA;CAAA,iCA2EcA,KA3Ed,EA4EC;CACC,WAAKqH,SAAL,GAAiBrH,KAAjB;CACA;CA9EF;CAAA;CAAA,gCAiFC;CACCF,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKnI,IAAlB,EAAwB,aAAxB;CACA;CAnFF;CAAA;CAAA,kCAsFC;CACCG,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKpI,IAArB,EAA2B,aAA3B;CACA;CAxFF;CAAA;CAAA,8BA2FC;CACC,WAAK3F,IAAL,CAAU,OAAV;CACA;CA7FF;CAAA;CAAA,EAA0BR,6BAA1B;;;KCJawO,SAAb;CAAA;;CAEC,qBAAYlN,MAAZ,EACA;CAAA;;CAAA;CACC,2GAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,+BAAvB;;CAEA,UAAK8O,QAAL,GAAiBtL,cAAI,CAACuL,SAAL,CAAepN,MAAM,CAACmN,QAAtB,IAAkCpF,QAAQ,CAAC/H,MAAM,CAACmN,QAAR,EAAkB,EAAlB,CAA1C,GAAkE,CAAnF;CACA,UAAKE,GAAL,GAAYxL,cAAI,CAACuL,SAAL,CAAepN,MAAM,CAACqN,GAAtB,IAA6BtF,QAAQ,CAAC/H,MAAM,CAACqN,GAAR,EAAa,EAAb,CAArC,GAAwD,CAApE;CAEA,UAAKnI,KAAL,aAAgB,MAAKiI,QAArB,cAAiC,MAAKE,GAAtC;CAEA,UAAKxI,IAAL,GAAY,IAAZ;CAVD;CAWC;;CAdF;CAAA;CAAA,6BAiBC;CACC,UAAMyI,SAAS,GAAG,qCAAlB;CAEA,WAAKzI,IAAL,GAAYiC,aAAG,CAACC,MAAhB,yLAC+C,KAAKsG,GAAL,GAAW,WAAX,GAAyB,EADxE,EAC8EC,SAD9E,EAEI,KAAKpI,KAFT;CAMAmC,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;CAEA,aAAO,KAAKwB,IAAZ;CACA;CA7BF;CAAA;CAAA,8BAgCC;CACC,aAAO,KAAKA,IAAZ;CACA;CAlCF;CAAA;CAAA,+BAqCC;CACC,aAAO,KAAKK,KAAZ;CACA;CAvCF;CAAA;CAAA,kCA0CC;CACC,aAAO,KAAKiI,QAAZ;CACA;CA5CF;CAAA;CAAA,6BA+CC;CACC,aAAO,KAAKE,GAAZ;CACA;CAjDF;CAAA;CAAA,8BAoDC;CACC,WAAKnO,IAAL,CAAU,OAAV;CACA;CAtDF;CAAA;CAAA,EAA+BR,6BAA/B;;;KCLa6O,KAAb;CAAA;;CAEC,iBAAYC,KAAZ,EACA;CAAA;;CAAA;CACC,uGAAMA,KAAN;;CAEA,UAAKnP,iBAAL,CAAuB,2BAAvB;;CAEA,UAAK6G,KAAL,GAAcrD,cAAI,CAACuL,SAAL,CAAeI,KAAf,IAAwBzF,QAAQ,CAACyF,KAAD,EAAQ,EAAR,CAAhC,GAA8C,CAA5D;CAEA,UAAK3I,IAAL,GAAY,IAAZ;CAPD;CAQC;;CAXF;CAAA;CAAA,6BAcC;CACC,UAAMyI,SAAS,GAAG,qCAAlB;CAEA,WAAKzI,IAAL,GAAYiC,aAAG,CAACC,MAAhB,+LACqD,KAAK7B,KAAL,GAAa,WAAb,GAA2B,EADhF,EACsFoI,SADtF,EAEI,KAAKpI,KAFT;CAMAmC,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;CAEA,aAAO,KAAKwB,IAAZ;CACA;CA1BF;CAAA;CAAA,8BA6BC;CACC,aAAO,KAAKA,IAAZ;CACA;CA/BF;CAAA;CAAA,+BAkCC;CACC,aAAO,KAAKK,KAAZ;CACA;CApCF;CAAA;CAAA,8BAuCC;CACC,WAAKhG,IAAL,CAAU,OAAV;CACA;CAzCF;CAAA;CAAA,EAA2BR,6BAA3B;;;KCKa+O,QAAb;CAAA;;CAEC,oBAAYC,WAAZ,EACA;CAAA;;CAAA;CACC,0GAAMA,WAAN;;CAEA,UAAKrP,iBAAL,CAAuB,8BAAvB;;CAEA,QAAIwD,cAAI,CAACC,WAAL,CAAiB4L,WAAjB,KAAiC7L,cAAI,CAAC8L,MAAL,CAAYD,WAAZ,CAArC,EACA;CACCA,MAAAA,WAAW,GAAG;CACbE,QAAAA,KAAK,EAAE,EADM;CAEb1I,QAAAA,KAAK,EAAE;CAFM,OAAd;CAIA;;CAED,UAAKwI,WAAL,GAAmBA,WAAnB;CAEA,UAAK7I,IAAL,GAAY,IAAZ;CAfD;CAgBC;;CAnBF;CAAA;CAAA,6BAsBC;CACC,WAAKA,IAAL,GAAYiC,aAAG,CAACC,MAAhB,oRACkD,KAAK2G,WAAL,CAAiBxI,KAAjB,GAAyB,WAAzB,GAAuC,EADzF,EAE2B,KAAKwI,WAAL,CAAiBE,KAF5C,EAGmC7F,QAAQ,CAAC,KAAK2F,WAAL,CAAiBxI,KAAlB,EAAyB,EAAzB,CAH3C;CAQAmC,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;CAEA,aAAO,KAAKwB,IAAZ;CACA;CAlCF;CAAA;CAAA,8BAqCC;CACC,aAAO,KAAKA,IAAZ;CACA;CAvCF;CAAA;CAAA,+BA0CC;CACC,aAAO,KAAK6I,WAAZ;CACA;CA5CF;CAAA;CAAA,8BA+CC;CACC,WAAKxO,IAAL,CAAU,OAAV;CACA;CAjDF;CAAA;CAAA,EAA8BR,6BAA9B;;;KCKamP,IAAb;CAAA;;CAEC,gBAAYC,IAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,IAAN;;CAEA,UAAKzP,iBAAL,CAAuB,0BAAvB;;CAEA,QAAIwD,cAAI,CAACC,WAAL,CAAiBgM,IAAjB,KAA0BjM,cAAI,CAACkM,OAAL,CAAaD,IAAb,CAA1B,IAAgDjM,cAAI,CAAC8L,MAAL,CAAYG,IAAZ,CAApD,EACA;CACCA,MAAAA,IAAI,GAAG;CACNjO,QAAAA,EAAE,EAAE,CADE;CAENmI,QAAAA,OAAO,EAAE,CAFH;CAGNjI,QAAAA,IAAI,EAAE,EAHA;CAINiO,QAAAA,WAAW,EAAE,EAJP;CAKNC,QAAAA,SAAS,EAAE,CALL;CAMNC,QAAAA,UAAU,EAAE,CANN;CAONN,QAAAA,KAAK,EAAE;CAPD,OAAP;CASA;;CAED,UAAKE,IAAL,GAAYA,IAAZ;CAlBD;CAmBC;;CAtBF;CAAA;CAAA,6BAyBC;CACC,WAAKjJ,IAAL,GAAYiC,aAAG,CAACC,MAAhB,iSACuC,KAAK+G,IAAL,CAAUjO,EAAV,GAAe,WAAf,GAA6B,EADpE,8BAIiC,KAAKiO,IAAL,CAAUF,KAJ3C,GAMU5G,cAAI,CAACC,MAAL,CAAY,KAAK6G,IAAL,CAAU/N,IAAtB,CANV;CAUAsH,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;CAEA,aAAO,KAAKwB,IAAZ;CACA;CAvCF;CAAA;CAAA,qCA0CC;CACC,UAAMsJ,WAAW,GAAG,KAAKC,gBAAL,CAAsB,KAAKN,IAAL,CAAUF,KAAhC,EAAuC,GAAvC,CAApB;CACA,UAAMS,eAAe,GAAG,KAAKD,gBAAL,CAAsB,KAAKN,IAAL,CAAUF,KAAhC,EAAuC,GAAvC,CAAxB;CAEA,UAAMU,UAAU,GAAG,KAAKR,IAAL,CAAUjO,EAAV,GAAe,CAAf,GAAmB,WAAnB,GAAiC,EAApD;CAEA,WAAKgF,IAAL,GAAYiC,aAAG,CAACC,MAAhB,gPAE6CuH,UAF7C,EAGuBD,eAHvB,EAGyDF,WAHzD,EAIInH,cAAI,CAACC,MAAL,CAAY,KAAK6G,IAAL,CAAU/N,IAAtB,CAJJ;CAOAsH,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;CAEA,aAAO,KAAKwB,IAAZ;CACA;CA1DF;CAAA;CAAA,8BA6DC;CACC,aAAO,KAAKA,IAAZ;CACA;CA/DF;CAAA;CAAA,+BAkEC;CACC,aAAO,KAAKiJ,IAAZ;CACA;CApEF;CAAA;CAAA,4BAuEC;CACC,aAAO,KAAKA,IAAL,CAAUjO,EAAjB;CACA;CAzEF;CAAA;CAAA,8BA4EC;CACC,WAAKX,IAAL,CAAU,OAAV;CACA;CA9EF;CAAA;CAAA,qCAgFkBqP,OAhFlB,EAgF2BC,OAhF3B,EAiFC;CACC,UAAIC,GAAG,GAAGF,OAAO,CAACrC,OAAR,CAAgB,GAAhB,EAAqB,EAArB,CAAV;;CAEA,UAAIuC,GAAG,CAACzM,MAAJ,KAAe,CAAnB,EACA;CACCyM,QAAAA,GAAG,aAAMA,GAAG,CAAC,CAAD,CAAT,SAAeA,GAAG,CAAC,CAAD,CAAlB,SAAwBA,GAAG,CAAC,CAAD,CAA3B,SAAiCA,GAAG,CAAC,CAAD,CAApC,SAA0CA,GAAG,CAAC,CAAD,CAA7C,SAAmDA,GAAG,CAAC,CAAD,CAAtD,CAAH;CACA;;CAED,UAAMC,CAAC,GAAG3G,QAAQ,CAAC0G,GAAG,CAACE,SAAJ,CAAc,CAAd,EAAiB,CAAjB,CAAD,EAAsB,EAAtB,CAAlB;CACA,UAAMC,CAAC,GAAG7G,QAAQ,CAAC0G,GAAG,CAACE,SAAJ,CAAc,CAAd,EAAiB,CAAjB,CAAD,EAAsB,EAAtB,CAAlB;CACA,UAAME,CAAC,GAAG9G,QAAQ,CAAC0G,GAAG,CAACE,SAAJ,CAAc,CAAd,EAAiB,CAAjB,CAAD,EAAsB,EAAtB,CAAlB;CAEA,4BAAeD,CAAf,cAAoBE,CAApB,cAAyBC,CAAzB,cAA8BL,OAA9B;CACA;CA9FF;CAAA;CAAA,EAA0B9P,6BAA1B;;;KCVaoQ,IAAb;CAAA;;CAEC,gBAAYC,IAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,IAAN;;CAEA,UAAK1Q,iBAAL,CAAuB,0BAAvB;;CAEA,UAAK0Q,IAAL,GAAalN,cAAI,CAACkM,OAAL,CAAagB,IAAb,IAAqBA,IAArB,GAA4B,EAAzC;CAEA,UAAKlK,IAAL,GAAY,IAAZ;CAPD;CAQC;;CAXF;CAAA;CAAA,6BAcC;CAAA;;CACC,UAAI,KAAKkK,IAAL,CAAU/M,MAAd,EACA;CACC,aAAK6C,IAAL,GAAYiC,aAAG,CAACC,MAAhB,4GACG,KAAKgI,IAAL,CAAUC,GAAV,CAAc,UAACC,GAAD,EAAS;CACxB,iBAAOnI,aAAG,CAACC,MAAX,uJAAuEC,cAAI,CAACC,MAAL,CAAYgI,GAAZ,CAAvE;CACA,SAFC,CADH;CAKA,OAPD,MASA;CACC,aAAKpK,IAAL,GAAYiC,aAAG,CAACC,MAAhB;CACA;;CAED,UAAIlF,cAAI,CAACkM,OAAL,CAAa,KAAKlJ,IAAlB,CAAJ,EACA;CACC,aAAKA,IAAL,CAAUsC,OAAV,CAAkB,UAACtC,IAAD,EAAuB;CACxCwC,UAAAA,eAAK,CAAChE,IAAN,CAAWwB,IAAX,EAAiB,OAAjB,EAA0B,MAAI,CAAC8G,OAAL,CAAatI,IAAb,CAAkB,MAAlB,CAA1B;CACA,SAFD;CAGA,OALD,MAOA;CACCgE,QAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;CACA;;CAED,aAAO,KAAKwB,IAAZ;CACA;CAxCF;CAAA;CAAA,8BA2CC;CACC,aAAO,KAAKA,IAAZ;CACA;CA7CF;CAAA;CAAA,+BAgDC;CACC,aAAO,KAAKkK,IAAZ;CACA;CAlDF;CAAA;CAAA,4BAoDSnQ,KApDT,EAqDC;CACC,WAAKM,IAAL,CAAU,OAAV,EAAmBN,KAAK,CAACsQ,MAAN,CAAaC,WAAb,CAAyBR,SAAzB,CAAmC,CAAnC,CAAnB;CACA;CAvDF;CAAA;CAAA,gCAyDaI,IAzDb,EA0DC;CACC,aAAOK,IAAI,CAACC,SAAL,CAAe,KAAKC,QAAL,EAAf,MAAoCF,IAAI,CAACC,SAAL,CAAeN,IAAI,CAACO,QAAL,EAAf,CAA3C;CACA;CA5DF;CAAA;CAAA,EAA0B5Q,6BAA1B;;;KCSa6Q,WAAb;CAAA;;CAEC,uBAAYC,WAAZ,EACA;CAAA;;CAAA;CACC;;CAEA,UAAKnR,iBAAL,CAAuB,iCAAvB;;CAEA,UAAKmR,WAAL,GAAoB3N,cAAI,CAAC4N,aAAL,CAAmBD,WAAnB,IAAkCA,WAAlC,GAAgD,IAApE;CALD;CAMC;;CATF;CAAA;CAAA,6BAYC;CACC,UAAMlC,SAAS,GAAG,6BAAlB;CAEA,UAAMvN,IAAI,GAAGiH,cAAI,CAACC,MAAL,CAAY,KAAKuI,WAAL,CAAiBzP,IAA7B,CAAb;CAEA,UAAM2P,GAAG,GAAG,KAAKF,WAAL,CAAiBG,KAAjB,GAAyB3I,cAAI,CAACC,MAAL,CAAY,KAAKuI,WAAL,CAAiBG,KAAjB,CAAuBD,GAAnC,CAAzB,GAAmE,IAA/E;CACA,UAAME,UAAU,GAAGF,GAAG,oCAA6BG,SAAS,CAACH,GAAD,CAAtC,WAAmD,EAAzE;CAEA,WAAK7K,IAAL,GAAYiC,aAAG,CAACC,MAAhB,+TAEqDuG,SAFrD,EAE0EvN,IAF1E,EAGe6P,UAHf,EAKU7P,IALV;CASAsH,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,KAAxB,CAAX,EAA2C,OAA3C,EAAoD,KAAK6G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAApD;CACAgE,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,MAAxB,CAAX,EAA4C,OAA5C,EAAqD,KAAK6G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAArD;CAEA,aAAO,KAAKwB,IAAZ;CACA;CAjCF;CAAA;CAAA,8BAoCC;CACC,aAAO,KAAKA,IAAZ;CACA;CAtCF;CAAA;CAAA,+BAyCC;CACC,aAAO,KAAK2K,WAAZ;CACA;CA3CF;CAAA;CAAA,8BA8CC;CACC,WAAKtQ,IAAL,CAAU,OAAV;CACA;CAhDF;CAAA;CAAA,EAAkCR,6BAAlC;;KCVaoR,kBAAb;CAEC,gCACA;CAAA;CACC,SAAKC,WAAL,GAAmB,EAAnB;CACA;;CALF;CAAA;CAAA,8BAOWA,WAPX,EAQC;CACC,UAAIA,WAAW,KAAK,EAApB,EACA;CACC,aAAKA,WAAL,GAAmB,EAAnB;CAEA;CACA;;CAED,UACClO,cAAI,CAACC,WAAL,CAAiBiO,WAAjB,KACIlO,cAAI,CAACmO,OAAL,CAAaD,WAAb,KAA6BE,KAAK,CAACC,UAAU,CAACH,WAAD,CAAX,CAFvC,EAIA;CACC;CACA;;CAED,UAAIlO,cAAI,CAACmO,OAAL,CAAaD,WAAb,CAAJ,EACA;CACCA,QAAAA,WAAW,GAAGG,UAAU,CAACH,WAAD,CAAV,CAAwBI,OAAxB,CAAgC,CAAhC,CAAd;CACA;;CAED,WAAKJ,WAAL,GAAmBK,MAAM,CAACL,WAAD,CAAzB;CACA;CA9BF;CAAA;CAAA,gCAiCC;CACC,aAAO,KAAKA,WAAZ;CACA;CAnCF;CAAA;CAAA,kCAsCC;CACC,WAAKA,WAAL,GAAmB,EAAnB;CACA;CAxCF;CAAA;CAAA,8BA2CC;CACC,aAAO,KAAKA,WAAL,KAAqB,EAA5B;CACA;CA7CF;CAAA;CAAA;;;KCGaM,WAAb;CAAA;;CAEC,uBAAYN,WAAZ,EACA;CAAA;;CAAA;CACC;;CAEA,UAAK1R,iBAAL,CAAuB,iCAAvB;;CAEA,UAAKiS,kBAAL,GAA0B,IAAIR,kBAAJ,EAA1B;;CAEA,UAAKQ,kBAAL,CAAwBC,SAAxB,CAAkCR,WAAlC;;CAEA,UAAKS,aAAL,GAAqB,KAArB;CATD;CAUC;;CAbF;CAAA;CAAA,6BAgBC;CACC,UAAMtL,KAAK,GAAG8B,cAAI,CAACC,MAAL,CAAY,KAAKqJ,kBAAL,CAAwBG,SAAxB,EAAZ,CAAd;CAEA,WAAK5L,IAAL,GAAYiC,aAAG,CAACC,MAAhB,ioBAE2C,KAAKuJ,kBAAL,CAAwBI,OAAxB,KAAoC,SAApC,GAAgD,EAF3F,EAGWnO,aAAG,CAACC,UAAJ,CAAe,wCAAf,CAHX,EAOM,KAAK8N,kBAAL,CAAwBI,OAAxB,KAAoC,GAApC,GAA0CxL,KAPhD,EAacA,KAbd;CAoBAmC,MAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,0CAAxB,CADD,EAEC,OAFD,EAGC,KAAK6G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAHD;CAMA,UAAMsN,KAAK,GAAG,KAAK9L,IAAL,CAAUC,aAAV,CAAwB,wCAAxB,CAAd;CAEAuC,MAAAA,eAAK,CAAChE,IAAN,CAAWsN,KAAX,EAAkB,MAAlB,EAA0B,KAAKC,MAAL,CAAYvN,IAAZ,CAAiB,IAAjB,CAA1B;CACAgE,MAAAA,eAAK,CAAChE,IAAN,CAAWsN,KAAX,EAAkB,SAAlB,EAA6B,KAAKE,SAAL,CAAexN,IAAf,CAAoBsN,KAApB,CAA7B;CAEA,aAAO,KAAK9L,IAAZ;CACA;CAnDF;CAAA;CAAA,8BAsDC;CACC,aAAO,KAAKA,IAAZ;CACA;CAxDF;CAAA;CAAA,+BA2DC;CACC,aAAO,KAAKyL,kBAAZ;CACA;CA7DF;CAAA;CAAA,gCAgEC;CACC,aAAO,KAAKE,aAAZ;CACA;CAlEF;CAAA;CAAA,8BAqEC;CACC,WAAKA,aAAL,GAAqB,IAArB;CACA;CAvEF;CAAA;CAAA,gCA0EC;CACC,WAAKA,aAAL,GAAqB,KAArB;CACA;CA5EF;CAAA;CAAA,8BA+EC;CACC,UAAI,KAAKM,SAAL,EAAJ,EACA;CACC;CACA;;CAED,UAAMC,cAAc,GAAG,KAAKlM,IAAL,CAAUC,aAAV,CAAwB,kDAAxB,CAAvB;CACA,UAAM6L,KAAK,GAAGI,cAAc,CAACC,iBAA7B;CACA,UAAM9L,KAAK,GAAG,KAAKoL,kBAAL,CAAwBG,SAAxB,EAAd;CAEAzL,MAAAA,aAAG,CAACgI,QAAJ,CAAa+D,cAAb,EAA6B,UAA7B;CAEAJ,MAAAA,KAAK,CAACM,KAAN;CACAN,MAAAA,KAAK,CAACO,iBAAN,CAAwBhM,KAAK,CAAClD,MAA9B,EAAsCkD,KAAK,CAAClD,MAA5C;CACA;CA7FF;CAAA;CAAA,6BAgGC;CACC,UAAM+O,cAAc,GAAG,KAAKlM,IAAL,CAAUC,aAAV,CAAwB,kDAAxB,CAAvB;CACA,UAAM6L,KAAK,GAAGI,cAAc,CAACC,iBAA7B;CAEA,UAAM9L,KAAK,GAAGyL,KAAK,CAACzL,KAAN,CAAYkH,IAAZ,EAAd;CAEA,UAAM+E,YAAY,GAAG,KAAKb,kBAAL,CAAwBG,SAAxB,EAArB;;CAEA,UAAIU,YAAY,KAAKjM,KAArB,EACA;CACC,aAAKhG,IAAL,CAAU,gBAAV,EAA4BgG,KAA5B;CACA;;CAEDF,MAAAA,aAAG,CAACiI,WAAJ,CAAgB8D,cAAhB,EAAgC,UAAhC;CACA;CA9GF;CAAA;CAAA,8BAgHWnS,KAhHX,EAiHC;CACC,UAAIA,KAAK,CAACwS,WAAN,IAAqBxS,KAAK,CAACyS,GAAN,KAAc,QAAnC,IAA+CzS,KAAK,CAACyS,GAAN,KAAc,OAAjE,EACA;CACC,aAAKC,IAAL;CACA;CACD;CAtHF;CAAA;CAAA,EAAkC5S,6BAAlC;;;KCCa6S,QAAb;CAAA;;CAEC,oBAAYC,UAAZ,EACA;CAAA;;CAAA;CACC;;CAEA,UAAKnT,iBAAL,CAAuB,yBAAvB;;CAEA,UAAKmT,UAAL,GAAkBA,UAAlB;CAEA,UAAKC,IAAL,GAAY,IAAI9J,GAAJ,EAAZ;CAEA,UAAK9C,IAAL,GAAY,IAAZ;CATD;CAUC;;CAbF;CAAA;CAAA,6BAgBC;CACC,WAAK6M,cAAL;CAEA,WAAK7M,IAAL,GAAYiC,aAAG,CAACC,MAAhB;CAEAM,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,eAAtB,EAAuC,KAAK8M,eAAL,CAAqBtO,IAArB,CAA0B,IAA1B,EAAgC,KAAKwB,IAArC,CAAvC;CAEA,aAAO,KAAKA,IAAZ;CACA;CAxBF;CAAA;CAAA,8BA2BC;CACC,aAAO,KAAKA,IAAZ;CACA;CA7BF;CAAA;CAAA,qCAgCC;CACC,UAAIhD,cAAI,CAAC8L,MAAL,CAAY,KAAKiE,OAAL,EAAZ,CAAJ,EACA;CACC;CACA;;CAED5M,MAAAA,aAAG,CAAC6M,MAAJ,CAAW,KAAKhN,IAAhB;CAEA,WAAKA,IAAL,GAAY,IAAZ;CACA;CAzCF;CAAA;CAAA,8BA4CC;CACC,aAAO,KAAK4M,IAAL,CAAUK,IAAV,KAAmB,CAA1B;CACA;CA9CF;CAAA;CAAA,oCAiDC;CACC,aAAO,KAAKN,UAAZ;CACA;CAnDF;CAAA;CAAA,4BAqDSvN,IArDT,EAsDC;CACC,WAAKwN,IAAL,CAAUM,GAAV,CAAc9N,IAAI,CAAC+N,KAAL,EAAd,EAA4B/N,IAA5B;CACA;CAxDF;CAAA;CAAA,8BA2DC;CACC,aAAO,KAAKwN,IAAZ;CACA;CA7DF;CAAA;CAAA,iCAgEC;CACC,WAAKA,IAAL,CAAUtK,OAAV,CAAkB,UAAClD,IAAD,EAAgB;CACjCe,QAAAA,aAAG,CAAC6M,MAAJ,CAAW5N,IAAI,CAAC2N,OAAL,EAAX;CACA,OAFD;CAIA,WAAKH,IAAL,CAAUrJ,KAAV;CACA;CAtEF;CAAA;CAAA,2BAyEC;CAAA;;CACC,aAAO,IAAIpH,OAAJ,CACN,UAACC,OAAD,EAAa;CACZ,QAAA,MAAI,CAACA,OAAL,GAAeA,OAAf;;CAEA,YAAIY,cAAI,CAAC8L,MAAL,CAAY,MAAI,CAACiE,OAAL,EAAZ,CAAJ,EACA;CACC;CACA;;CAED,YAAI,MAAI,CAACH,IAAL,CAAUK,IAAd,EACA;CACC,UAAA,MAAI,CAACG,UAAL;;CAEA,UAAA,MAAI,CAACC,cAAL;CACA,SALD,MAOA;CACC,UAAA,MAAI,CAAC3K,UAAL;CACA;;CAEDvC,QAAAA,aAAG,CAACmN,KAAJ,CAAU,MAAI,CAACP,OAAL,EAAV,EAA0B,QAA1B,YAAwC,MAAI,CAACA,OAAL,GAAeQ,YAAvD;CACA,OArBK,CAAP;CAuBA;CAjGF;CAAA;CAAA,2BAoGC;CAAA;;CACC,aAAO,IAAIpR,OAAJ,CACN,UAACC,OAAD,EAAa;CACZ,QAAA,MAAI,CAACA,OAAL,GAAeA,OAAf;;CAEA,YAAIY,cAAI,CAAC8L,MAAL,CAAY,MAAI,CAACiE,OAAL,EAAZ,CAAJ,EACA;CACC,UAAA,MAAI,CAAC3Q,OAAL;;CAEA,iBAAO,IAAP;CACA;;CAED,QAAA,MAAI,CAACgR,UAAL;CAEA;;;CACA,QAAA,MAAI,CAACL,OAAL,GAAeO,KAAf,CAAqBE,MAArB,aAAkC,MAAI,CAACT,OAAL,GAAeQ,YAAjD;CACA,QAAA,MAAI,CAACR,OAAL,GAAexL,YAAf;CACA,QAAA,MAAI,CAACwL,OAAL,GAAeO,KAAf,CAAqBE,MAArB,GAA8B,GAA9B;CACA;CACA,OAlBK,CAAP;CAoBA;CAzHF;CAAA;CAAA,8BA4HC;CACC,aAAO,CAACxQ,cAAI,CAAC8L,MAAL,CAAY,KAAK9I,IAAjB,CAAR;CACA;CA9HF;CAAA;CAAA,qCAiIC;CAAA;;CACC,WAAKA,IAAL,CAAUyN,SAAV,GAAsB,EAAtB;CAEA,WAAKb,IAAL,CAAUtK,OAAV,CAAkB,UAAClD,IAAD,EAAgB;CACjCe,QAAAA,aAAG,CAACyD,MAAJ,CAAWxE,IAAI,CAAC8C,MAAL,EAAX,EAA0B,MAAI,CAAC6K,OAAL,EAA1B;CACA,OAFD;CAGA;CAvIF;CAAA;CAAA,iCA0IC;CACC,UAAI,KAAKW,MAAT,EACA;CACC,aAAKA,MAAL,CAAY7R,IAAZ;CAEA;CACA;;CAED,UAAM8R,YAAY,GAAGxN,aAAG,CAACyN,WAAJ,CAAgB,KAAKb,OAAL,EAAhB,CAArB;CAEA,WAAKW,MAAL,GAAc,IAAIG,kBAAJ,CAAW;CACxBxD,QAAAA,MAAM,EAAE,KAAK0C,OAAL,EADgB;CAExBE,QAAAA,IAAI,EAAE,EAFkB;CAGxBvQ,QAAAA,IAAI,EAAE,QAHkB;CAIxBqM,QAAAA,KAAK,EAAE,wBAJiB;CAKxB+E,QAAAA,MAAM,EAAE;CACPxS,UAAAA,GAAG,QADI;CAEP2F,UAAAA,IAAI,YAAM0M,YAAY,CAACI,KAAb,GAAqB,CAArB,GAAyB,EAA/B;CAFG;CALgB,OAAX,CAAd;CAWA,WAAKL,MAAL,CAAY7R,IAAZ;CACA;CAhKF;CAAA;CAAA,iCAmKC;CACC,UAAI,KAAK6R,MAAT,EACA;CACC,aAAKA,MAAL,CAAYM,IAAZ;CACA;CACD;CAxKF;CAAA;CAAA,oCA0KiBhO,IA1KjB,EA2KC;CACC,UAAMiO,MAAM,GAAI9N,aAAG,CAACmN,KAAJ,CAAUtN,IAAV,EAAgB,QAAhB,MAA8B,KAA9C;;CAEA,UAAIiO,MAAJ,EACA;CACC,aAAKpB,cAAL;CACA,OAHD,MAKA;CACC1M,QAAAA,aAAG,CAACmN,KAAJ,CAAUtN,IAAV,EAAgB,QAAhB,EAA0B,MAA1B;CACA;;CAED,WAAK5D,OAAL;CACA;CAxLF;CAAA;CAAA,EAA8BvC,6BAA9B;;;KC+DaqU,IAAb;CAAA;;CAEC,gBAAY/S,MAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,qBAAvB;;CAEA,UAAK2U,SAAL,GAAiB,KAAjB;CACA,UAAKC,iBAAL,GAAyB,KAAzB;CAEA,UAAKpO,IAAL,GAAY,IAAZ;CAEA,UAAKqO,MAAL,GAAc,IAAd;CACA,UAAKnT,IAAL,GAAY,IAAZ;CACA,UAAKoT,SAAL,GAAiB,IAAjB;CACA,UAAKC,KAAL,GAAa,IAAb;CACA,UAAKC,QAAL,GAAgB,IAAhB;CACA,UAAKvF,IAAL,GAAY,IAAZ;CACA,UAAKiB,IAAL,GAAY,IAAZ;CACA,UAAKS,WAAL,GAAmB,IAAnB;CACA,UAAKO,WAAL,GAAmB,IAAnB;CACA,UAAKuD,QAAL,GAAgB,IAAhB;;CAEA,UAAKC,aAAL,CAAmBvT,MAAnB;;CAEA,UAAKwT,SAAL,GAAiB,GAAjB;CAvBD;CAwBC;;CA3BF;CAAA;CAAA,kCA6BexT,MA7Bf,EA8BC;CACC,WAAKyT,KAAL,CAAWzT,MAAM,CAACH,EAAlB;CACA,WAAK6T,UAAL,CAAgB1T,MAAM,CAACgI,OAAvB;CACA,WAAK2L,QAAL,CAAc3T,MAAM,CAAC4T,KAArB;CACA,WAAKC,OAAL,CAAa7T,MAAM,CAAC8T,IAApB;CACA,WAAKC,WAAL,CAAiB/T,MAAM,CAACgU,QAAxB;CACA,WAAKC,aAAL,CAAmBjU,MAAM,CAACkU,UAA1B;CACA,WAAKC,WAAL,CAAiBnU,MAAM,CAACyM,QAAxB;CACA,WAAK2H,OAAL,CAAapU,MAAM,CAACqU,IAApB;CAEA,WAAKC,eAAL,CAAqBtU,MAAM,CAACuU,YAA5B;CACA,WAAKC,aAAL,CAAmBxU,MAAM,CAACyU,YAA1B;CACA,WAAKC,aAAL,CAAmB1U,MAAM,CAAC2U,YAA1B;CACA,WAAKC,eAAL,CAAqB5U,MAAM,CAAC6U,YAA5B;CACA,WAAKC,UAAL,CAAgB9U,MAAM,CAAC+U,SAAvB;CACA,WAAKC,YAAL,CAAkBhV,MAAM,CAACuM,SAAzB;CACA,WAAK0I,gBAAL,CAAsB,KAAtB;CACA,WAAKC,iBAAL,CAAuBlV,MAAM,CAACmV,cAA9B;CACA,WAAKC,YAAL,CAAkBpV,MAAM,CAACsM,WAAzB;CAEA,WAAKrE,UAAL,GAAkBjI,MAAM,CAACiI,UAAzB;CACA;CAnDF;CAAA;CAAA,8BA+EWuD,OA/EX,EAgFC;CACC,UAAM0H,MAAM,GAAG,IAAI3H,MAAJ,CAAW;CAAEC,QAAAA,OAAO,EAAPA;CAAF,OAAX,CAAf;;CAEA,UAAI,KAAK0H,MAAT,EACA;CACClO,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKgH,MAAL,CAAYtB,OAAZ,EAAZ,EAAmCsB,MAAM,CAACnM,MAAP,EAAnC;CACA;;CAED,WAAKmM,MAAL,GAAcA,MAAd;CAEA,WAAKA,MAAL,CAAYvU,SAAZ,CAAsB,MAAtB,EAA8B,KAAK0W,YAAL,CAAkBhS,IAAlB,CAAuB,IAAvB,CAA9B;CACA,WAAK6P,MAAL,CAAYvU,SAAZ,CAAsB,MAAtB,EAA8B,KAAK2W,YAAL,CAAkBjS,IAAlB,CAAuB,IAAvB,CAA9B;CACA;CA5FF;CAAA;CAAA,gCA+FC;CACC,aAAO,KAAK6P,MAAZ;CACA;CAjGF;CAAA;CAAA,4BAmGSqC,SAnGT,EAoGC;CAAA;;CACC,UAAMxV,IAAI,GAAG,IAAIoM,IAAJ,CAAS;CACrBpM,QAAAA,IAAI,EAAEwV,SADe;CAErB/I,QAAAA,WAAW,EAAE,KAAKA,WAAL,EAFQ;CAGrBF,QAAAA,WAAW,EAAE,KAAKA,WAAL,EAHQ;CAIrBrE,QAAAA,UAAU,EAAE,KAAKA,UAJI;CAKrBwE,QAAAA,QAAQ,EAAE,KAAK+I,WAAL;CALW,OAAT,CAAb;;CAQA,UAAI,KAAKzV,IAAT,EACA;CACCiF,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKnM,IAAL,CAAU6R,OAAV,EAAZ,EAAiC7R,IAAI,CAACgH,MAAL,EAAjC;CACA;;CAED,WAAKhH,IAAL,GAAYA,IAAZ;CAEA,WAAKA,IAAL,CAAUpB,SAAV,CAAoB,OAApB,EAA6B;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,UAAV,CAAN;CAAA,OAA7B;CACA,WAAKa,IAAL,CAAUpB,SAAV,CAAoB,UAApB,EAAgC;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,oBAAV,CAAN;CAAA,OAAhC;CACA;CAtHF;CAAA;CAAA,8BAyHC;CACC,aAAO,KAAKa,IAAZ;CACA;CA3HF;CAAA;CAAA,iCA6HcoN,QA7Hd,EA6HgCE,GA7HhC,EA8HC;CAAA;;CACC,UAAM8F,SAAS,GAAG,IAAIjG,SAAJ,CAAc;CAAEC,QAAAA,QAAQ,EAARA,QAAF;CAAYE,QAAAA,GAAG,EAAHA;CAAZ,OAAd,CAAlB;;CAEA,UAAI,KAAK8F,SAAT,EACA;CACCnO,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKiH,SAAL,CAAevB,OAAf,EAAZ,EAAsCuB,SAAS,CAACpM,MAAV,EAAtC;CACA;;CAED,WAAKoM,SAAL,GAAiBA,SAAjB;CAEA,WAAKA,SAAL,CAAexU,SAAf,CAAyB,OAAzB,EAAkC;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,UAAV,CAAN;CAAA,OAAlC;CACA;CAzIF;CAAA;CAAA,mCA4IC;CACC,aAAO,KAAKiU,SAAZ;CACA;CA9IF;CAAA;CAAA,6BAgJU3F,KAhJV,EAiJC;CAAA;;CACC,UAAM4F,KAAK,GAAG,IAAI7F,KAAJ,CAAUC,KAAV,CAAd;;CAEA,UAAI,KAAK4F,KAAT,EACA;CACCpO,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKkH,KAAL,CAAWxB,OAAX,EAAZ,EAAkCwB,KAAK,CAACrM,MAAN,EAAlC;CACA;;CAED,WAAKqM,KAAL,GAAaA,KAAb;CAEA,WAAKA,KAAL,CAAWzU,SAAX,CAAqB,OAArB,EAA8B;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,UAAV,CAAN;CAAA,OAA9B;CACA;CA5JF;CAAA;CAAA,+BA+JC;CACC,aAAO,KAAKkU,KAAZ;CACA;CAjKF;CAAA;CAAA,gCAmKa1F,WAnKb,EAoKC;CAAA;;CACC,UAAM2F,QAAQ,GAAG,IAAI5F,QAAJ,CAAaC,WAAb,CAAjB;;CAEA,UAAI,KAAK2F,QAAT,EACA;CACCrO,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKmH,QAAL,CAAczB,OAAd,EAAZ,EAAqCyB,QAAQ,CAACtM,MAAT,EAArC;CACA;;CAED,WAAKsM,QAAL,GAAgBA,QAAhB;CAEA,WAAKA,QAAL,CAAc1U,SAAd,CAAwB,OAAxB,EAAiC;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,UAAV,CAAN;CAAA,OAAjC;CACA;CA/KF;CAAA;CAAA,kCAkLC;CACC,aAAO,KAAKmU,QAAZ;CACA;CApLF;CAAA;CAAA,4BAsLSoC,SAtLT,EAuLC;CAAA;;CACC,UAAM3H,IAAI,GAAG,IAAID,IAAJ,CAAS4H,SAAT,CAAb;;CAEA,UAAI,KAAK3H,IAAT,EACA;CACC9I,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAK4B,IAAL,CAAU8D,OAAV,EAAZ,EAAiC,KAAK8D,WAAL,KAAqB5H,IAAI,CAAC/G,MAAL,EAArB,GAAqC+G,IAAI,CAAC6H,cAAL,EAAtE;CACA;;CAED,WAAK7H,IAAL,GAAYA,IAAZ;CAEA,WAAK8H,oBAAL;CAEA,WAAK9H,IAAL,CAAUnP,SAAV,CAAoB,OAApB,EAA6B;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,cAAV,EAA0B,MAAI,CAAC4O,IAAL,CAAUkE,KAAV,EAA1B,CAAN;CAAA,OAA7B;CACA;CApMF;CAAA;CAAA,8BAuMC;CACC,aAAO,KAAKlE,IAAZ;CACA;CAzMF;CAAA;CAAA,4BA2MS+H,SA3MT,EA4MC;CAAA;;CACC,UAAM9G,IAAI,GAAG,IAAID,IAAJ,CAAS+G,SAAT,CAAb;;CAEA,UAAI,KAAK9G,IAAT,EACA;CACC,YAAI,KAAK6C,OAAL,EAAJ;CACA;CACC,iBAAKkE,WAAL,CAAiB/G,IAAjB;CACA;CACD;;CAED,WAAKA,IAAL,GAAYA,IAAZ;CAEA,WAAK6G,oBAAL;CAEA,WAAK7G,IAAL,CAAUpQ,SAAV,CAAoB,OAApB,EAA6B,UAACwJ,SAAD;CAAA,eAA0B,MAAI,CAACjJ,IAAL,CAAU,aAAV,EAAyBiJ,SAAS,CAAC4N,OAAV,EAAzB,CAA1B;CAAA,OAA7B;CACA;CA5NF;CAAA;CAAA,8BA+NC;CACC,aAAO,KAAKhH,IAAZ;CACA;CAjOF;CAAA;CAAA,iCAmOc7J,KAnOd,EAoOC;CACC,WAAKsO,SAAL,GAAkBtO,KAAK,KAAK,GAAV,GAAgB,GAAhB,GAAsB,GAAxC;;CAEA,UAAI,KAAK0M,OAAL,EAAJ,EACA;CACC5M,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAK0F,OAAL,EAAZ,EAA4B,KAAK7K,MAAL,EAA5B;CACA;CACD;CA3OF;CAAA;CAAA,mCA8OC;CACC,aAAO,KAAKyM,SAAZ;CACA;CAhPF;CAAA;CAAA,kCAmPC;CACC,aAAO,KAAKA,SAAL,KAAmB,GAA1B;CACA;CArPF;CAAA;CAAA,mCAuPgBwC,gBAvPhB,EAwPC;CACC,UAAMxG,WAAW,GAAG,IAAID,WAAJ,CAAgByG,gBAAhB,CAApB;;CAEA,UAAI,KAAKxG,WAAT,EACA;CACCxK,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKsD,WAAL,CAAiBoC,OAAjB,EAAZ,EAAwCpC,WAAW,CAACzI,MAAZ,EAAxC;CACA;;CAED,WAAKyI,WAAL,GAAmBA,WAAnB;CAEA,WAAKA,WAAL,CAAiB7Q,SAAjB,CAA2B,OAA3B,EAAoC,KAAKsX,kBAAL,CAAwB5S,IAAxB,CAA6B,IAA7B,CAApC;CACA;CAnQF;CAAA;CAAA,qCAsQC;CACC,aAAO,KAAKmM,WAAZ;CACA;CAxQF;CAAA;CAAA,mCA0QgB0G,gBA1QhB,EA2QC;CACC,UAAMnG,WAAW,GAAG,IAAIM,WAAJ,CAAgB6F,gBAAhB,CAApB;;CAEA,UAAI,KAAKnG,WAAT,EACA;CACC/K,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAK6D,WAAL,CAAiB6B,OAAjB,EAAZ,EAAwC7B,WAAW,CAAChJ,MAAZ,EAAxC;CACA;;CAED,UAAI,KAAK6E,UAAL,EAAJ,EACA;CACCmE,QAAAA,WAAW,CAAClE,OAAZ;CACA;;CAED,WAAKkE,WAAL,GAAmBA,WAAnB;CAEA,WAAKA,WAAL,CAAiBpR,SAAjB,CAA2B,gBAA3B,EAA6C,KAAKwX,gBAAL,CAAsB9S,IAAtB,CAA2B,IAA3B,CAA7C;CACA;CA3RF;CAAA;CAAA,qCA8RC;CACC,aAAO,KAAK0M,WAAZ;CACA;CAhSF;CAAA;CAAA,kCAmSC;CAAA;;CACC,WAAKuD,QAAL,GAAgB,IAAI/B,QAAJ,CAAa,IAAb,CAAhB;CAEA,WAAK+B,QAAL,CAAc3U,SAAd,CAAwB,OAAxB,EAAiC;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,UAAV,CAAN;CAAA,OAAjC;CACA;CAvSF;CAAA;CAAA,kCA0SC;CACC,aAAO,KAAKoU,QAAZ;CACA;CA5SF;CAAA;CAAA,0BA8SOzT,EA9SP,EA+SC;CACC,WAAKA,EAAL,GACCgC,cAAI,CAACuL,SAAL,CAAevN,EAAf,IAAqBkI,QAAQ,CAAClI,EAAD,EAAK,EAAL,CAA7B,GACEgC,cAAI,CAACqG,QAAL,CAAcrI,EAAd,KAAqBA,EAAtB,GAA4BA,EAA5B,GAAiCmH,cAAI,CAACsC,SAAL,EAFnC;;CAKA,UAAI,KAAKsI,OAAL,EAAJ,EACA;CACC,aAAKA,OAAL,GAAewE,OAAf,CAAuBvW,EAAvB,GAA4B,KAAKA,EAAjC;CACA;CACD;CAzTF;CAAA;CAAA,4BA4TC;CACC,aAAO,KAAKA,EAAZ;CACA;CA9TF;CAAA;CAAA,+BAgUYA,EAhUZ,EAiUC;CACC,WAAKmI,OAAL,GAAgBnG,cAAI,CAACuL,SAAL,CAAevN,EAAf,IAAqBkI,QAAQ,CAAClI,EAAD,EAAK,EAAL,CAA7B,GAAwC,CAAxD;CACA;CAnUF;CAAA;CAAA,iCAsUC;CACC,aAAO,KAAKmI,OAAZ;CACA;CAxUF;CAAA;CAAA,6BA0UU4L,KA1UV,EA2UC;CACC,WAAKA,KAAL,GAAc/R,cAAI,CAACqG,QAAL,CAAc0L,KAAd,IAAuBA,KAAvB,GAA+B,EAA7C;CACA;CA7UF;CAAA;CAAA,+BAgVC;CACC,aAAO,KAAKA,KAAZ;CACA;CAlVF;CAAA;CAAA,4BAoVSE,IApVT,EAqVC;CACC,WAAKuC,eAAL,CAAqB,KAAKvC,IAA1B;CAEA,WAAKA,IAAL,GAAajS,cAAI,CAACuL,SAAL,CAAe0G,IAAf,IAAuB/L,QAAQ,CAAC+L,IAAD,EAAO,EAAP,CAA/B,GAA4C,CAAzD;;CAEA,UAAI,KAAKlC,OAAL,EAAJ,EACA;CACC5M,QAAAA,aAAG,CAACC,IAAJ,CAAS,KAAK2M,OAAL,EAAT,EAAyB,WAAzB,EAAsC,KAAKkC,IAA3C;CACA;CACD;CA9VF;CAAA;CAAA,8BAiWC;CACC,aAAO,KAAKA,IAAZ;CACA;CAnWF;CAAA;CAAA,oCAqWiBA,IArWjB,EAsWC;CACC,WAAKwC,YAAL,GAAqBzU,cAAI,CAACuL,SAAL,CAAe0G,IAAf,IAAuB/L,QAAQ,CAAC+L,IAAD,EAAO,EAAP,CAA/B,GAA4C,CAAjE;CACA;CAxWF;CAAA;CAAA,sCA2WC;CACC,aAAO,KAAKwC,YAAZ;CACA;CA7WF;CAAA;CAAA,gCA+WatC,QA/Wb,EAgXC;CACC,WAAKA,QAAL,GAAiBnS,cAAI,CAACuL,SAAL,CAAe4G,QAAf,IAA2BjM,QAAQ,CAACiM,QAAD,EAAW,EAAX,CAAnC,GAAoD,CAArE;CACA;CAlXF;CAAA;CAAA,kCAqXC;CACC,aAAO,KAAKA,QAAZ;CACA;CAvXF;CAAA;CAAA,kCAyXeE,UAzXf,EA0XC;CACC,WAAKA,UAAL,GAAmB,IAAIvL,GAAJ,CAAQ,CAAC,SAAD,EAAY,QAAZ,CAAR,EAA+BC,GAA/B,CAAmCsL,UAAnC,IAAiDA,UAAjD,GAA8D,SAAjF;CAEA,WAAKqC,iBAAL;CACA;CA9XF;CAAA;CAAA,oCAiYC;CACC,aAAO,KAAKrC,UAAZ;CACA;CAnYF;CAAA;CAAA,gCAqYazH,QArYb,EAsYC;CACC,WAAKA,QAAL,GAAiB5K,cAAI,CAACuL,SAAL,CAAeX,QAAf,IAA2B1E,QAAQ,CAAC0E,QAAD,EAAW,EAAX,CAAnC,GAAoD,CAArE;CACA;CAxYF;CAAA;CAAA,kCA2YC;CACC,aAAO,KAAKA,QAAZ;CACA;CA7YF;CAAA;CAAA,iCA+YcvH,KA/Yd,EAgZC;CACC,UAAMqH,SAAS,GAAIrH,KAAK,KAAK,GAA7B;;CAEA,UAAI,KAAKnF,IAAT,EACA;CACC,aAAKA,IAAL,CAAUiV,YAAV,CAAuBzI,SAAvB;;CAEA,YAAIA,SAAJ,EACA;CACC,eAAKxM,IAAL,CAAUyW,SAAV;CACA,SAHD,MAKA;CACC,eAAKzW,IAAL,CAAU0W,WAAV;CACA;CACD;;CAED,WAAKlK,SAAL,GAAiBA,SAAjB;CACA;CAlaF;CAAA;CAAA,sCAoamB4I,cApanB,EAqaC;CACC,WAAKA,cAAL,GAAuBtT,cAAI,CAAC4N,aAAL,CAAmB0F,cAAnB,IAAqCA,cAArC,GAAsD,EAA7E;CACA;CAvaF;CAAA;CAAA,iCAyac7I,WAzad,EA0aC;CACC,WAAKD,SAAL,GAAkBC,WAAW,KAAK,GAAlC;CACA;CA5aF;CAAA;CAAA,kCA+aC;CACC,aAAO,KAAKD,SAAZ;CACA;CAjbF;CAAA;CAAA,oCAmbiBkI,YAnbjB,EAobC;CACC,WAAKA,YAAL,GAAoBA,YAApB;CACA;CAtbF;CAAA;CAAA,sCAybC;CACC,aAAO,KAAKA,YAAZ;CACA;CA3bF;CAAA;CAAA,uCA8bC;CACC,UAAI,CAAC,KAAKmC,eAAL,EAAL,EACA;CACC,eAAO,CAAP;CACA;;CAED,aAAOC,MAAM,CAACC,IAAP,CAAY,KAAKF,eAAL,EAAZ,EAAoC1U,MAA3C;CACA;CArcF;CAAA;CAAA,kCAucekD,KAvcf,EAwcC;CACC,WAAK2R,UAAL,GAAmB3R,KAAK,KAAK,GAA7B;;CAEA,UAAI,KAAK0M,OAAL,EAAJ,EACA;CACC,aAAKkF,SAAL,CAAe,KAAKrC,YAAL,EAAf;;CAEA,YAAI,KAAKA,YAAL,EAAJ,EACA;CACCzP,UAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,gBAA7B;;CAEA,cAAI,KAAKmF,gBAAL,KAA0B,CAA9B,EACA;CACC/R,YAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,QAA7B;CACA,WAHD,MAKA;CACC5M,YAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,QAAhC;CACA;CACD,SAZD,MAcA;CACC5M,UAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,gBAAhC;CACA;CACD;CACD;CAjeF;CAAA;CAAA,mCAoeC;CACC,aAAO,KAAKiF,UAAZ;CACA;CAteF;CAAA;CAAA,kCAwee3R,KAxef,EAyeC;CACC,WAAK8R,UAAL,GAAmB9R,KAAK,KAAK,GAA7B;;CAEA,UAAI,KAAK0M,OAAL,EAAJ,EACA;CACC,YAAI,KAAK+C,YAAL,MAAuB,CAAC,KAAKI,SAAL,EAA5B,EACA;CACC/P,UAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,UAA7B;CACA,SAHD,MAKA;CACC5M,UAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,UAAhC;CACA;CACD;CACD;CAvfF;CAAA;CAAA,mCA0fC;CACC,aAAO,KAAKoF,UAAZ;CACA;CA5fF;CAAA;CAAA,oCA8fiBnX,EA9fjB,EA+fC;CACC,WAAKgV,YAAL,GAAqBhT,cAAI,CAACuL,SAAL,CAAevN,EAAf,IAAqBkI,QAAQ,CAAClI,EAAD,EAAK,EAAL,CAA7B,GAAwC,CAA7D;CACA;CAjgBF;CAAA;CAAA,sCAogBC;CACC,aAAO,KAAKgV,YAAZ;CACA;CAtgBF;CAAA;CAAA,+BAwgBY3P,KAxgBZ,EAygBC;CACC,WAAK+R,OAAL,GAAgB/R,KAAK,KAAK,GAA1B;;CAEA,UAAI,KAAK0M,OAAL,EAAJ,EACA;CACC,YAAI,KAAKmD,SAAL,EAAJ,EACA;CACC/P,UAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,YAA7B;CACA,SAHD,MAKA;CACC5M,UAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,YAAhC;CACA;CACD;CACD;CAvhBF;CAAA;CAAA,gCA0hBC;CACC,aAAO,KAAKqF,OAAZ;CACA;CA5hBF;CAAA;CAAA,4BA8hBS5C,IA9hBT,EA+hBC;CACC,UAAIxS,cAAI,CAACC,WAAL,CAAiBuS,IAAjB,CAAJ,EACA;CACC,aAAKA,IAAL,GAAY;CACXzG,UAAAA,KAAK,EAAE,EADI;CAEXsJ,UAAAA,WAAW,EAAE;CAFF,SAAZ;CAKA;CACA;;CAED,WAAK7C,IAAL,GAAYA,IAAZ;CACA;CA3iBF;CAAA;CAAA,8BA8iBC;CACC,aAAO,KAAKA,IAAZ;CACA;CAhjBF;CAAA;CAAA,mCAkjBgBzG,KAljBhB,EAmjBC;CACC,WAAKyG,IAAL,CAAU6C,WAAV,GAAyBrV,cAAI,CAACqG,QAAL,CAAc0F,KAAd,IAAuBA,KAAvB,GAA+B,EAAxD;CAEA,WAAK2I,iBAAL;CACA;CAvjBF;CAAA;CAAA,qCA0jBC;CACC,aAAQ1U,cAAI,CAACqG,QAAL,CAAc,KAAKmM,IAAL,CAAU6C,WAAxB,IAAuC,KAAK7C,IAAL,CAAU6C,WAAjD,GAA+D,EAAvE;CACA;CA5jBF;CAAA;CAAA,wCA+jBC;CACC,UAAI,KAAKvC,YAAL,MAAuB,CAAC,KAAKI,SAAL,EAAxB,IAA4C,KAAKnD,OAAL,EAA5C,IAA8D,KAAKuF,cAAL,OAA0B,EAA5F,EACA;CACC,YAAMC,SAAS,GAAG,KAAKxF,OAAL,GAAe9M,aAAf,CAA6B,0BAA7B,CAAlB;CAEAE,QAAAA,aAAG,CAACmN,KAAJ,CAAUiF,SAAV,EAAqB,iBAArB,EAAwC,KAAKD,cAAL,EAAxC;;CAEA,gBAAQ,KAAKE,aAAL,EAAR;CAEC,eAAK,SAAL;CACCrS,YAAAA,aAAG,CAACmN,KAAJ,CAAU,KAAKP,OAAL,GAAe9M,aAAf,CAA6B,wBAA7B,CAAV,EAAkE,iBAAlE,EAAqF,KAAKqS,cAAL,EAArF;CACA;;CACD,eAAK,QAAL;CACCnS,YAAAA,aAAG,CAACmN,KAAJ,CAAU,KAAKP,OAAL,EAAV,EAA0B,YAA1B,EAAwC,IAAxC;CACA;CAPF;CASA;CACD;CAhlBF;CAAA;CAAA,kCAmlBC;CACC,aAAO,KAAKrF,SAAZ;CACA;CArlBF;CAAA;CAAA,iCAwlBC;CACC,aAAO,KAAKiE,aAAZ;CACA;CA1lBF;CAAA;CAAA,oCA4lBiBtL,KA5lBjB,EA6lBC;CACC,WAAKoS,YAAL,GAAoBlY,OAAO,CAAC8F,KAAD,CAA3B;CACA;CA/lBF;CAAA;CAAA,gCAkmBC;CACC,aAAO,KAAKoS,YAAZ;CACA;CApmBF;CAAA;CAAA,qCAsmBkBC,MAtmBlB,EAumBC;CACC,WAAK/G,aAAL,GAAqBpR,OAAO,CAACmY,MAAD,CAA5B;;CAEA,UAAI,KAAKxH,WAAT,EACA;CACC,YAAI,KAAKnE,UAAL,EAAJ,EACA;CACC,eAAKmE,WAAL,CAAiBlE,OAAjB;CACA,SAHD,MAKA;CACC,eAAKkE,WAAL,CAAiBhE,SAAjB;CACA;CACD;CACD;CArnBF;CAAA;CAAA,wCAwnBC;CACC/G,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,WAA7B;CACA;CA1nBF;CAAA;CAAA,0CA6nBC;CACC5M,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,WAAhC;CACA;CA/nBF;CAAA;CAAA,yCAkoBC;CACC5M,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,eAA7B;CACA;CApoBF;CAAA;CAAA,2CAuoBC;CACC5M,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,eAAhC;CACA5M,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,uBAAhC;CACA;CA1oBF;CAAA;CAAA,gDA6oBC;CACC5M,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,uBAA7B;CACA;CA/oBF;CAAA;CAAA,kDAkpBC;CACC5M,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,uBAAhC;CACA;CAppBF;CAAA;CAAA,yCAupBC;CACC,WAAKoB,SAAL,GAAiB,IAAjB;CAEAhO,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,CAAC,cAAD,CAA7B;CAEA,WAAKA,OAAL,GAAe9M,aAAf,CAA6B,sCAA7B,EAAqE0S,OAArE,GAA+E,IAA/E;CACA;CA7pBF;CAAA;CAAA,8CAgqBC;CACC,WAAKxE,SAAL,GAAiB,KAAjB;CAEAhO,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,CAAC,cAAD,CAAhC;CAEA,WAAKA,OAAL,GAAe9M,aAAf,CAA6B,sCAA7B,EAAqE0S,OAArE,GAA+E,KAA/E;CACA;CAtqBF;CAAA;CAAA,kCAyqBC;CACC,aAAO,KAAKxE,SAAZ;CACA;CA3qBF;CAAA;CAAA,8BA8qBC;CACC,aAAO,KAAKnO,IAAZ;CACA;CAhrBF;CAAA;CAAA,mCAmrBC;CAAA;;CACCG,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,QAA7B;CAEA,WAAK6F,WAAL,GACE/W,IADF,GAEEJ,IAFF,CAEO,YAAM;CACX,QAAA,MAAI,CAAC4S,MAAL,CAAYxS,IAAZ;CACA,OAJF;CAMA;CA5rBF;CAAA;CAAA,mCA+rBC;CAAA;;CACCsE,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,QAAhC;CAEA,WAAK6F,WAAL,GACE5E,IADF,GAEEvS,IAFF,CAEO,YAAM;CACX,QAAA,OAAI,CAAC4S,MAAL,CAAYL,IAAZ;CACA,OAJF;CAMA;CAxsBF;CAAA;CAAA,oCA2sBC;CACC,WAAK4E,WAAL,GAAmBC,UAAnB;CACA;CA7sBF;CAAA;CAAA,sCAgtBC;CACC,aAAO,KAAKD,WAAL,GAAmB3L,OAAnB,EAAP;CACA;CAltBF;CAAA;CAAA,gDAqtBC;CACC,WAAKmH,iBAAL,GAAyB,IAAzB;CACA;CAvtBF;CAAA;CAAA,kDA0tBC;CACC,WAAKA,iBAAL,GAAyB,KAAzB;CACA;CA5tBF;CAAA;CAAA,0CA+tBC;CACC,aAAO,KAAKA,iBAAZ;CACA;CAjuBF;CAAA;CAAA,oCAmuBiBe,QAnuBjB,EAmuBmCE,UAnuBnC,EAouBC;CACC,WAAKH,WAAL,CAAiBC,QAAjB;CACA,WAAKC,aAAL,CAAmBC,UAAnB;CACA;CAvuBF;CAAA;CAAA,oCA0uBC;CACC,aAAO9U,OAAO,CAAC,KAAK+V,cAAL,CAAoB,WAApB,CAAD,CAAd;CACA;CA5uBF;CAAA;CAAA,sCA+uBC;CACC,aAAO/V,OAAO,CAAC,KAAK+V,cAAL,CAAoB,aAApB,CAAD,CAAd;CACA;CAjvBF;CAAA;CAAA,mCAmvBgBwC,OAnvBhB,EAovBC;CACC,WAAKb,SAAL,CAAea,OAAO,CAAClD,YAAR,EAAf;;CAEA,UAAI,KAAKmD,OAAL,GAAetI,QAAf,OAA8BqI,OAAO,CAACC,OAAR,GAAkBtI,QAAlB,EAAlC,EACA;CACC,aAAKuI,OAAL,CAAaF,OAAO,CAACC,OAAR,GAAkBtI,QAAlB,EAAb;CACA;;CACD,UAAI,KAAKwI,YAAL,GAAoBxI,QAApB,OAAmCqI,OAAO,CAACG,YAAR,GAAuBxI,QAAvB,EAAvC,EACA;CACC,aAAKyI,YAAL,CACCJ,OAAO,CAACG,YAAR,GAAuBE,WAAvB,EADD,EAECL,OAAO,CAACG,YAAR,GAAuBG,MAAvB,EAFD;CAIA;;CACD,UAAI,KAAKC,QAAL,GAAgB5I,QAAhB,OAA+BqI,OAAO,CAACO,QAAR,GAAmB5I,QAAnB,EAAnC,EACA;CACC,aAAK6I,QAAL,CAAcR,OAAO,CAACO,QAAR,GAAmB5I,QAAnB,EAAd;CACA;;CACD,UAAI,KAAK8I,WAAL,GAAmB9I,QAAnB,OAAkCqI,OAAO,CAACS,WAAR,GAAsB9I,QAAtB,EAAtC,EACA;CACC,aAAK+I,WAAL,CAAiBV,OAAO,CAACS,WAAR,GAAsB9I,QAAtB,EAAjB;CACA;;CACD,UAAI,KAAKgJ,OAAL,GAAehJ,QAAf,OAA8BqI,OAAO,CAACW,OAAR,GAAkBhJ,QAAlB,EAAlC,EACA;CACC,aAAKiJ,OAAL,CAAaZ,OAAO,CAACW,OAAR,GAAkBhJ,QAAlB,EAAb;CACA;;CACD,UAAI,CAAC,KAAKkJ,OAAL,GAAeC,WAAf,CAA2Bd,OAAO,CAACa,OAAR,EAA3B,CAAL,EACA;CACC,aAAKE,OAAL,CAAaf,OAAO,CAACa,OAAR,GAAkBlJ,QAAlB,EAAb;CACA;;CACD,UAAI,KAAKqJ,cAAL,GAAsBrJ,QAAtB,OAAqCqI,OAAO,CAACgB,cAAR,GAAyBrJ,QAAzB,EAAzC,EACA;CACC,aAAKsJ,cAAL,CAAoBjB,OAAO,CAACgB,cAAR,GAAyBrJ,QAAzB,EAApB;CACA;;CACD,UACC,CAAC,KAAKyF,SAAL,EAAD,IACG,KAAK8D,cAAL,GAAsBvJ,QAAtB,GAAiCmB,SAAjC,OAAiDkH,OAAO,CAACkB,cAAR,GAAyBvJ,QAAzB,GAAoCmB,SAApC,EAFrD,EAIA;CACC,aAAKqI,cAAL,CAAoBnB,OAAO,CAACkB,cAAR,GAAyBvJ,QAAzB,GAAoCmB,SAApC,EAApB;CACA;;CACD,WAAKsD,WAAL,CAAiB4D,OAAO,CAACoB,WAAR,EAAjB;;CACA,UAAI,KAAKvM,WAAL,OAAuBmL,OAAO,CAACnL,WAAR,EAA3B,EACA;CACC,aAAKwI,YAAL,CAAkB2C,OAAO,CAACnL,WAAR,KAAwB,GAAxB,GAA8B,GAAhD;CACA;;CACD,UAAI,KAAKF,WAAL,OAAuBqL,OAAO,CAACrL,WAAR,EAA3B,EACA;CACC,aAAK8I,YAAL,CAAkBuC,OAAO,CAACrL,WAAR,KAAwB,GAAxB,GAA8B,GAAhD;CACA,aAAKuL,OAAL,CAAaF,OAAO,CAACC,OAAR,GAAkBtI,QAAlB,EAAb;CACA;;CAED,WAAKkF,aAAL,CAAmBmD,OAAO,CAAClD,YAAR,KAAyB,GAAzB,GAA+B,GAAlD;CACA,WAAKC,aAAL,CAAmBiD,OAAO,CAAChD,YAAR,KAAyB,GAAzB,GAA+B,GAAlD;CACA,WAAKC,eAAL,CAAqB+C,OAAO,CAACqB,eAAR,EAArB;CACA,WAAKlE,UAAL,CAAgB6C,OAAO,CAAC5C,SAAR,KAAsB,GAAtB,GAA4B,GAA5C;CACA;CA5yBF;CAAA;CAAA,qCA+yBC;CACC/P,MAAAA,aAAG,CAAC6M,MAAJ,CAAW,KAAKhN,IAAhB;CAEA,WAAKA,IAAL,GAAY,IAAZ;CACA;CAnzBF;CAAA;CAAA,6BAszBC;CACC,UAAI,KAAK6Q,WAAL,EAAJ,EACA;CACC,eAAO,KAAKuD,eAAL,EAAP;CACA,OAHD,MAKA;CACC,eAAO,KAAKtD,cAAL,EAAP;CACA;CACD;CA/zBF;CAAA;CAAA,sCAk0BC;CACC,UAAMuD,SAAS,GAAG,CAAC,KAAKzE,YAAL,KAAsB,kBAAtB,GAA2C,GAA5C,KAAoD,KAAKM,SAAL,KAAmB,cAAnB,GAAoC,EAAxF,CAAlB;CACA,UAAMoE,QAAQ,GAAG,KAAKpC,gBAAL,KAA0B,CAA1B,GAA8B,UAA9B,GAA2C,EAA5D;CACA,UAAMqC,WAAW,GAAG,KAAKzE,YAAL,MAAuB,CAAC,KAAKI,SAAL,EAAxB,GAA2C,YAA3C,GAA0D,EAA9E;CACA,UAAMsE,WAAW,GAAG,YAAY,KAAKhC,aAAL,EAAhC;CAEA,WAAKxS,IAAL,GAAYiC,aAAG,CAACC,MAAhB,qqCAE4BmS,SAF5B,EAEwCC,QAFxC,EAEmDC,WAFnD,EAEsGC,WAFtG,EAGarS,cAAI,CAACC,MAAL,CAAY,KAAK+K,KAAL,EAAZ,CAHb,EAIehL,cAAI,CAACC,MAAL,CAAY,KAAKqS,OAAL,EAAZ,CAJf,EASK,KAAKpG,MAAL,GAAc,KAAKA,MAAL,CAAYnM,MAAZ,EAAd,GAAqC,EAT1C,EAWM,KAAKhH,IAAL,GAAY,KAAKA,IAAL,CAAUgH,MAAV,EAAZ,GAAiC,EAXvC,EAaO,KAAK+G,IAAL,GAAY,KAAKA,IAAL,CAAU/G,MAAV,EAAZ,GAAiC,EAbxC,EAcO,KAAKgI,IAAL,GAAY,KAAKA,IAAL,CAAUhI,MAAV,EAAZ,GAAiC,EAdxC,EAkBM,KAAKsM,QAAL,GAAgB,KAAKA,QAAL,CAActM,MAAd,EAAhB,GAAyC,EAlB/C,EAoBO,KAAKqM,KAAL,GAAa,KAAKA,KAAL,CAAWrM,MAAX,EAAb,GAAmC,EApB1C,EAqBO,KAAKoM,SAAL,GAAiB,KAAKA,SAAL,CAAepM,MAAf,EAAjB,GAA2C,EArBlD,EAyBI,KAAKyI,WAAL,GAAmB,KAAKA,WAAL,CAAiBzI,MAAjB,EAAnB,GAA+C,EAzBnD,EA0BI,CAAC,KAAKgO,SAAL,EAAD,IAAqB,KAAKhF,WAA1B,GAAwC,KAAKA,WAAL,CAAiBhJ,MAAjB,EAAxC,GAAoE,EA1BxE;CAmCAM,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK0U,WAAL,CAAiBlW,IAAjB,CAAsB,IAAtB,CAA/B;CAEA,WAAKkT,iBAAL;CAEA,aAAO,KAAK1R,IAAZ;CACA;CAh3BF;CAAA;CAAA,qCAm3BC;CACC,UAAMqU,SAAS,GAAG,CAAC,KAAKzE,YAAL,KAAsB,kBAAtB,GAA2C,GAA5C,KAAoD,KAAKM,SAAL,KAAmB,cAAnB,GAAoC,EAAxF,CAAlB;CACA,UAAMoE,QAAQ,GAAG,KAAKpC,gBAAL,KAA0B,CAA1B,GAA8B,UAA9B,GAA2C,EAA5D;CACA,UAAMqC,WAAW,GAAG,KAAKzE,YAAL,MAAuB,CAAC,KAAKI,SAAL,EAAxB,GAA2C,YAA3C,GAA0D,EAA9E;CACA,UAAMsE,WAAW,GAAG,YAAY,KAAKhC,aAAL,EAAhC;CAEA,WAAKxS,IAAL,GAAYiC,aAAG,CAACC,MAAhB,uuCAE4BmS,SAF5B,EAEwCC,QAFxC,EAEmDC,WAFnD,EAEqGC,WAFrG,EAGarS,cAAI,CAACC,MAAL,CAAY,KAAK+K,KAAL,EAAZ,CAHb,EAIehL,cAAI,CAACC,MAAL,CAAY,KAAKqS,OAAL,EAAZ,CAJf,EAUK,KAAKpG,MAAL,GAAc,KAAKA,MAAL,CAAYnM,MAAZ,EAAd,GAAqC,EAV1C,EAYM,KAAKhH,IAAL,GAAY,KAAKA,IAAL,CAAUgH,MAAV,EAAZ,GAAiC,EAZvC,EAcO,KAAK+G,IAAL,GAAY,KAAKA,IAAL,CAAU6H,cAAV,EAAZ,GAAyC,EAdhD,EAeO,KAAK5G,IAAL,GAAY,KAAKA,IAAL,CAAUhI,MAAV,EAAZ,GAAiC,EAfxC,EAkBK,KAAKsM,QAAL,GAAgB,KAAKA,QAAL,CAActM,MAAd,EAAhB,GAAyC,EAlB9C,EAsBI,KAAKyI,WAAL,GAAmB,KAAKA,WAAL,CAAiBzI,MAAjB,EAAnB,GAA+C,EAtBnD,EAyBM,KAAKqM,KAAL,GAAa,KAAKA,KAAL,CAAWrM,MAAX,EAAb,GAAmC,EAzBzC,EA0BM,KAAKoM,SAAL,GAAiB,KAAKA,SAAL,CAAepM,MAAf,EAAjB,GAA2C,EA1BjD,EA6BI,CAAC,KAAKgO,SAAL,EAAD,IAAqB,KAAKhF,WAA1B,GAAwC,KAAKA,WAAL,CAAiBhJ,MAAjB,EAAxC,GAAoE,EA7BxE;CAwCA,WAAK6O,oBAAL;CAEAvO,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK0U,WAAL,CAAiBlW,IAAjB,CAAsB,IAAtB,CAA/B;CAEA,WAAKkT,iBAAL;CAEA,aAAO,KAAK1R,IAAZ;CACA;CAx6BF;CAAA;CAAA,2CA26BC;CACC,UAAI,CAAC,KAAK+M,OAAL,EAAL,EACA;CACC;CACA;;CAED,UAAI,KAAK9D,IAAL,CAAUwB,QAAV,GAAqBzP,EAArB,GAA0B,CAA1B,IAA+B,KAAKkP,IAAL,CAAUO,QAAV,GAAqBtN,MAArB,GAA8B,CAAjE,EACA;CACCgD,QAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,GAAe9M,aAAf,CAA6B,0BAA7B,CAAb,EAAuE,WAAvE;CACA,OAHD,MAKA;CACCE,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,GAAe9M,aAAf,CAA6B,0BAA7B,CAAhB,EAA0E,WAA1E;CACA;CACD;CAz7BF;CAAA;CAAA,gCA27BaiK,IA37Bb,EA47BC;CACC,UAAMyK,aAAa,GAAG,KAAK5H,OAAL,GAAe9M,aAAf,CAA6B,0BAA7B,CAAtB;CACA,UAAM2U,QAAQ,GAAGD,aAAa,CAACtS,gBAAd,CAA+B,6BAA/B,CAAjB;CAEAuS,MAAAA,QAAQ,CAACtS,OAAT,CAAiB,UAACuS,OAAD;CAAA,eAA0B1U,aAAG,CAAC6M,MAAJ,CAAW6H,OAAX,CAA1B;CAAA,OAAjB;CAEA,UAAMC,OAAO,GAAG5K,IAAI,CAAChI,MAAL,EAAhB;;CAEA,UAAIlF,cAAI,CAACkM,OAAL,CAAa4L,OAAb,CAAJ,EACA;CACCA,QAAAA,OAAO,CAACxS,OAAR,CAAgB,UAACuS,OAAD;CAAA,iBAA0B1U,aAAG,CAACyD,MAAJ,CAAWiR,OAAX,EAAoBF,aAApB,CAA1B;CAAA,SAAhB;CACA,OAHD,MAKA;CACCxU,QAAAA,aAAG,CAACyD,MAAJ,CAAWkR,OAAX,EAAoBH,aAApB;CACA;CACD;CA58BF;CAAA;CAAA,gCA88Ba5a,KA98Bb,EA+8BC;CACC,UAAMsQ,MAAM,GAAGtQ,KAAK,CAACsQ,MAArB;;CAEA,UAAIlK,aAAG,CAAC4U,QAAJ,CAAa1K,MAAb,EAAqB,yBAArB,CAAJ,EACA;CACC,aAAKhQ,IAAL,CAAU,YAAV;CAEA;CACA;;CAED,UAAI,KAAK0M,UAAL,EAAJ,EACA;CACC;CACA;;CAED,UAAI,KAAKsH,MAAL,IAAe,KAAK2G,OAAL,CAAa,KAAK3G,MAAL,CAAYtB,OAAZ,EAAb,EAAoC1C,MAApC,CAAnB,EACA;CACC;CACA;;CACD,UAAI,KAAKnP,IAAL,IAAa,KAAK8Z,OAAL,CAAa,KAAK9Z,IAAL,CAAU6R,OAAV,EAAb,EAAkC1C,MAAlC,CAAjB,EACA;CACC;CACA;;CACD,UAAI,KAAKiE,SAAL,IAAkB,KAAK0G,OAAL,CAAa,KAAK1G,SAAL,CAAevB,OAAf,EAAb,EAAuC1C,MAAvC,CAAtB,EACA;CACC;CACA;;CACD,UAAI,KAAKkE,KAAL,IAAc,KAAKyG,OAAL,CAAa,KAAKzG,KAAL,CAAWxB,OAAX,EAAb,EAAmC1C,MAAnC,CAAlB,EACA;CACC;CACA;;CACD,UAAI,KAAKmE,QAAL,IAAiB,KAAKwG,OAAL,CAAa,KAAKxG,QAAL,CAAczB,OAAd,EAAb,EAAsC1C,MAAtC,CAArB,EACA;CACC;CACA;;CACD,UAAI,KAAKpB,IAAL,IAAa,KAAK+L,OAAL,CAAa,KAAK/L,IAAL,CAAU8D,OAAV,EAAb,EAAkC1C,MAAlC,CAAjB,EACA;CACC;CACA;;CACD,UAAI,KAAKH,IAAL,IAAa,KAAK8K,OAAL,CAAa,KAAK9K,IAAL,CAAU6C,OAAV,EAAb,EAAkC1C,MAAlC,CAAjB,EACA;CACC;CACA;;CACD,UAAI,KAAKM,WAAL,IAAoB,KAAKqK,OAAL,CAAa,KAAKrK,WAAL,CAAiBoC,OAAjB,EAAb,EAAyC1C,MAAzC,EAAiD,IAAjD,CAAxB,EACA;CACC;CACA;;CACD,UAAI,KAAK6F,SAAL,EAAJ,EACA;CACC;CACA;;CACD,UAAI,KAAKhF,WAAL,IAAoB,KAAK8J,OAAL,CAAa,KAAK9J,WAAL,CAAiB6B,OAAjB,EAAb,EAAyC1C,MAAzC,CAAxB,EACA;CACC;CACA;;CAED,WAAKhQ,IAAL,CAAU,mBAAV;CACA;CAxgCF;CAAA;CAAA,yCA2gCC;CAAA;;CACC,UAAI,KAAK4a,WAAL,EAAJ,EACA;CACC;CACA;;CAED,UAAI,KAAKlO,UAAL,EAAJ,EACA;CACC;CACA;;CAED,UAAI,KAAKmO,iBAAL,IAA0B,KAAKA,iBAAL,CAAuBC,MAAvB,EAA9B,EACA;CACC,aAAKD,iBAAL,CAAuBlH,IAAvB;CACA,aAAKkH,iBAAL,GAAyB,IAAzB;CAEA;CACA;;CAED,UAAMvK,WAAW,GAAG,KAAKmJ,cAAL,GAAsBrJ,QAAtB,EAApB;CACA,UAAM2K,gBAAgB,GAAGzK,WAAW,GAAG,CAAC,CAAC,MAAD,EAAUA,WAAW,CAAC3P,EAAtB,CAAD,CAAH,GAAiC,EAArE;CAEA,WAAKka,iBAAL,GAAyB,IAAIG,wBAAJ,CAAW;CACnCC,QAAAA,UAAU,EAAE,KAAK3K,WAAL,CAAiBoC,OAAjB,EADuB;CAEnCwI,QAAAA,YAAY,EAAE,IAFqB;CAGnCC,QAAAA,OAAO,EAAE,OAH0B;CAInCC,QAAAA,YAAY,EAAE,IAJqB;CAKnCL,QAAAA,gBAAgB,EAAEA,gBALiB;CAMnCM,QAAAA,MAAM,EAAE;CACP,2BAAiB,sBAAC3b,KAAD,EAAW;CAC3B,YAAA,OAAI,CAACmb,iBAAL,CAAuBlH,IAAvB;;CACA,gBAAM2H,YAAY,GAAG5b,KAAK,CAACmX,OAAN,GAAgB9R,IAArC;;CACA,YAAA,OAAI,CAAC2U,cAAL,CAAoB;CACnB/Y,cAAAA,EAAE,EAAE2a,YAAY,CAACxI,KAAb,EADe;CAEnBjS,cAAAA,IAAI,EAAEya,YAAY,CAACC,QAAb,EAFa;CAGnB9K,cAAAA,KAAK,EAAE;CACND,gBAAAA,GAAG,EAAE8K,YAAY,CAACE,SAAb;CADC;CAHY,aAApB;;CAOA,YAAA,OAAI,CAACxb,IAAL,CAAU,uBAAV;CACA;CAZM,SAN2B;CAoBnCyb,QAAAA,QAAQ,EAAE,CACT;CACC9a,UAAAA,EAAE,EAAE,YADL;CAECC,UAAAA,OAAO,EAAE;CACRkI,YAAAA,OAAO,EAAE,KAAK4S,UAAL;CADD,WAFV;CAKCC,UAAAA,WAAW,EAAE;CALd,SADS,EAQT;CACChb,UAAAA,EAAE,EAAE;CADL,SARS;CApByB,OAAX,CAAzB;CAkCA,WAAKX,IAAL,CAAU,yBAAV,EAAqC,KAAK6a,iBAA1C;CAEA,WAAKA,iBAAL,CAAuBrZ,IAAvB;CACA;CAtkCF;CAAA;CAAA,qCAwkCkByH,SAxkClB,EAykCC;CACC,UAAI,KAAKyD,UAAL,EAAJ,EACA;CACC;CACA;;CAED,WAAK1M,IAAL,CAAU,YAAV,EAAwB;CACvB4b,QAAAA,MAAM,EAAE,KAAK9I,KAAL,EADe;CAEvBgC,QAAAA,QAAQ,EAAE,KAAK+E,WAAL,EAFa;CAGvBhJ,QAAAA,WAAW,EAAE5H,SAAS,CAAC4N,OAAV;CAHU,OAAxB;CAMA,WAAK+C,cAAL,CAAoB3Q,SAAS,CAAC4N,OAAV,EAApB;CACA;CAtlCF;CAAA;CAAA,mCAylCC;CACC,WAAK7W,IAAL,CAAU,cAAV,EAA0B,KAAKuY,WAAL,EAA1B;CACA;CA3lCF;CAAA;CAAA,mCA8lCC;CACC,WAAKsD,YAAL;CACA;CAhmCF;CAAA;CAAA,4BAkmCSC,UAlmCT,EAkmCuDC,UAlmCvD,EAmmCC;CAAA;;CAAA,UAD+EC,UAC/E,uEAD4F,KAC5F;;CACC,UAAIrZ,cAAI,CAACkM,OAAL,CAAaiN,UAAb,CAAJ,EACA;CACC,YAAMG,MAAM,GAAGH,UAAU,CACvBhM,GADa,CACT,UAACnK,IAAD;CAAA,iBAAuB,OAAI,CAACgV,OAAL,CAAahV,IAAb,EAAmBoW,UAAnB,EAA+BC,UAA/B,CAAvB;CAAA,SADS,EAEb1W,IAFa,CAER,UAAC2W,MAAD;CAAA,iBAAYA,MAAM,KAAK,IAAvB;CAAA,SAFQ,CAAf;CAKA,eAAO,CAACtZ,cAAI,CAACC,WAAL,CAAiBqZ,MAAjB,CAAR;CACA;;CAED,UAAI,CAACD,UAAD,IAAeD,UAAU,CAACG,WAAX,CAAuBJ,UAAvB,CAAnB,EACA;CACC,eAAO,IAAP;CACA;;CAED,UAAMK,KAAK,GAAGL,UAAU,CAACM,oBAAX,CAAgC,GAAhC,CAAd;;CAEA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,KAAK,CAACrZ,MAA1B,EAAkCuZ,CAAC,EAAnC,EACA;CACC,YAAIN,UAAU,CAACG,WAAX,CAAuBC,KAAK,CAACE,CAAD,CAA5B,CAAJ,EACA;CACC,iBAAO,IAAP;CACA;CACD;;CAED,aAAO,KAAP;CACA;CA9nCF;CAAA;CAAA,uCAioCC;CAAA;;CACC,UAAI,CAAC,KAAK3J,OAAL,EAAL,EACA;CACC;CACA;;CAED,UAAI/P,cAAI,CAACC,WAAL,CAAiB0Z,oBAAjB,CAAJ,EACA;CACC;CACA;;CAED,UAAMC,QAAQ,GAAG,IAAID,oBAAJ,CAAyB,UAACE,OAAD,EACzC;CACC,YAAIA,OAAO,CAAC,CAAD,CAAP,CAAWC,cAAX,KAA8B,IAAlC,EACA;CACC,UAAA,OAAI,CAACC,KAAL;;CAEAH,UAAAA,QAAQ,CAACI,UAAT;CACA;CACD,OARe,EAShB;CACCC,QAAAA,SAAS,EAAE,CAAC,CAAD;CADZ,OATgB,CAAjB;CAcAL,MAAAA,QAAQ,CAACM,OAAT,CAAiB,KAAKnK,OAAL,EAAjB;CACA;CA3pCF;CAAA;CAAA,4BA8pCC;CAAA;;CACC,UAAI,CAAC,KAAKA,OAAL,EAAL,EACA;CACC;CACA;;CAED5M,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,SAA7B;CACAoK,MAAAA,UAAU,CAAC,YAAM;CAChBhX,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,OAAI,CAAC2E,OAAL,EAAhB,EAAgC,SAAhC;CACA,OAFS,EAEP,GAFO,CAAV;CAGA;CAxqCF;CAAA;CAAA,8BAqDkB5R,MArDlB,EAsDC;CACC,UAAMiE,IAAI,GAAG,IAAI8O,IAAJ,CAAS/S,MAAT,CAAb;CAEAiE,MAAAA,IAAI,CAAC6S,SAAL,CAAe7S,IAAI,CAACwQ,YAAL,EAAf;CACAxQ,MAAAA,IAAI,CAAC4T,OAAL,CAAa7X,MAAM,CAACD,IAApB;CACAkE,MAAAA,IAAI,CAAC8T,YAAL,CACC/X,MAAM,CAACic,iBADR,EAECjc,MAAM,CAACkc,YAFR;CAIAjY,MAAAA,IAAI,CAACkU,QAAL,CAAcnY,MAAM,CAACmc,kBAArB;CACAlY,MAAAA,IAAI,CAACoU,WAAL,CAAiBrY,MAAM,CAAC0N,WAAxB;CACAzJ,MAAAA,IAAI,CAACsU,OAAL,CAAavY,MAAM,CAAC8N,IAApB;CACA7J,MAAAA,IAAI,CAACyU,OAAL,CAAa1Y,MAAM,CAAC+O,IAApB;CACA9K,MAAAA,IAAI,CAAC2U,cAAL,CAAoB5Y,MAAM,CAACwP,WAA3B;;CAEA,UAAI,CAACvL,IAAI,CAAC8Q,SAAL,EAAL,EACA;CACC9Q,QAAAA,IAAI,CAAC6U,cAAL,CAAoB9Y,MAAM,CAAC+P,WAA3B;CACA;;CAED9L,MAAAA,IAAI,CAACmY,WAAL;CAEA,aAAOnY,IAAP;CACA;CA7EF;CAAA;CAAA,EAA0BvF,6BAA1B;;;KChEa2d,SAAb;CAEC,qBAAYC,MAAZ,EACA;CAAA;CACC,SAAKA,MAAL,GAAcA,MAAd;CAEA,SAAKzX,IAAL,GAAY,IAAZ;CACA;;CAPF;CAAA;CAAA,6BAUC;CAAA;;CACC,WAAKA,IAAL,GAAYiC,aAAG,CAACC,MAAhB,gNAC2D,KAAKuV,MAAL,CAAYtK,KAAZ,EAD3D,EAEI,+BAAI,KAAKsK,MAAL,CAAYC,QAAZ,GAAuB3Y,MAAvB,EAAJ,EAAqCoL,GAArC,CAAyC,UAAC/K,IAAD,EAAgB;CAC1DA,QAAAA,IAAI,CAACgQ,aAAL,CAAmB,KAAI,CAACqI,MAAL,CAAYjF,aAAZ,EAAnB;CACA,eAAOpT,IAAI,CAAC8C,MAAL,EAAP;CACA,OAHC,CAFJ,EAMI,KAAKyV,YAAL,EANJ;CAUA,aAAO,KAAK3X,IAAZ;CACA;CAtBF;CAAA;CAAA,mCAyBC;CACC,aAAOiC,aAAG,CAACC,MAAX;CACA;CA3BF;CAAA;CAAA,8BA8BC;CACC,aAAO,KAAKlC,IAAZ;CACA;CAhCF;CAAA;CAAA,kCAmCC;CACC,aAAO,KAAKA,IAAZ;CACA;CArCF;CAAA;CAAA,gCAuCamP,QAvCb,EAwCC;CACC,WAAKnP,IAAL,CAAUuR,OAAV,CAAkBpC,QAAlB,GAA6BjM,QAAQ,CAACiM,QAAD,EAAW,EAAX,CAArC;CACA;CA1CF;CAAA;CAAA,mCA6CC;CACChP,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,aAA7B;CACA;CA/CF;CAAA;CAAA,sCAkDC;CACC5M,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,aAAhC;CACA;CApDF;CAAA;CAAA;;KCmBa6K,WAAb;CAAA;;CAKC,uBAAYzc,MAAZ,EACA;CAAA;;CAAA;CACC,6GAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,4BAAvB;;CAEA,UAAKwE,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,UAAK6Z,aAAL,GAAqB1c,MAAM,CAAC4H,MAA5B;CACA,UAAKI,OAAL,GAAeD,QAAQ,CAAC/H,MAAM,CAACgI,OAAR,EAAiB,EAAjB,CAAvB;CACA,UAAK2U,iBAAL,GAAyB3c,MAAM,CAAC2c,iBAAhC;CACA,UAAKC,OAAL,GAAe,IAAIjV,GAAJ,EAAf;CAEA,UAAKkV,aAAL,GAAqB,KAArB;CAXD;CAYC;;CAlBF;CAAA;CAAA,sCAoBmB/O,IApBnB,EAqBC;CACC,UAAMgP,QAAQ,GAAGhP,IAAI,CAAC/N,IAAL,CAAUqM,IAAV,EAAjB;CAEA,WAAKwQ,OAAL,CAAa7K,GAAb,CAAiB,UAAUjE,IAAI,CAACjO,EAAhC,EAAoC;CACnCA,QAAAA,EAAE,EAAEiO,IAAI,CAACjO,EAD0B;CAEnCmU,QAAAA,QAAQ,EAAE,MAFyB;CAGnCxL,QAAAA,IAAI,EAAE,SAH6B;CAInClG,QAAAA,KAAK,EAAEwa,QAJ4B;CAKnCC,QAAAA,MAAM,EAAE,0FAL2B;CAMnChd,QAAAA,IAAI,EAAE+c,QAN6B;CAOnC9O,QAAAA,WAAW,EAAEF,IAAI,CAACE,WAPiB;CAQnCJ,QAAAA,KAAK,EAAEE,IAAI,CAACF,KARuB;CASnC5F,QAAAA,OAAO,EAAE8F,IAAI,CAAC9F,OATqB;CAUnCiG,QAAAA,SAAS,EAAEH,IAAI,CAACG,SAVmB;CAWnCC,QAAAA,UAAU,EAAEJ,IAAI,CAACI;CAXkB,OAApC;CAaA;CArCF;CAAA;CAAA,2CAuCwBJ,IAvCxB,EAwCC;CACC,WAAK8O,OAAL,WAAoB,UAAU9O,IAAI,CAACjO,EAAnC;CACA;CA1CF;CAAA;CAAA,iCA6CC;CACC,4CAAW,KAAK+c,OAAL,CAAahZ,MAAb,EAAX;CACA;CA/CF;CAAA;CAAA,kCAkDC;CACC,UAAMoZ,QAAQ,GAAG,EAAjB;CACA,qCAAI,KAAKJ,OAAL,CAAahZ,MAAb,EAAJ,EAA2BuD,OAA3B,CAAmC,UAAC8H,GAAD,EAAS;CAC3C,YAAIA,GAAG,CAAC+E,QAAJ,KAAiB,KAArB,EACA;CACCgJ,UAAAA,QAAQ,CAACrY,IAAT,CAAcsK,GAAd;CACA;CACD,OALD;CAMA,aAAO+N,QAAP;CACA;CA3DF;CAAA;CAAA,kCA8DC;CACC,UAAMC,QAAQ,GAAG,EAAjB;CAEA,qCAAI,KAAKL,OAAL,CAAahZ,MAAb,EAAJ,EAA2BuD,OAA3B,CAAmC,UAAC2G,IAAD,EAAU;CAC5C,YAAIA,IAAI,CAACkG,QAAL,KAAkB,MAAtB,EACA;CACCiJ,UAAAA,QAAQ,CAACtY,IAAT,CAAcmJ,IAAd;CACA;CACD,OALD;CAOA,aAAOmP,QAAP;CACA;CAzEF;CAAA;CAAA,kCA2EeH,QA3Ef,EA4EC;CACC,UAAIhP,IAAI,GAAG,IAAX;CAEA,qCAAI,KAAK8O,OAAL,CAAahZ,MAAb,EAAJ,EAA2BuD,OAA3B,CAAmC,UAAC8H,GAAD,EAAS;CAC3C,YAAIA,GAAG,CAAC+E,QAAJ,KAAiB,MAAjB,IAA2B/E,GAAG,CAAClP,IAAJ,KAAa+c,QAA5C,EACA;CACChP,UAAAA,IAAI,GAAGmB,GAAP;CACA;CACD,OALD;CAOA,aAAOnB,IAAP;CACA;CAvFF;CAAA;CAAA,gCAyFaoP,MAzFb,EA0FC;CACC,aAAO,+BAAI,KAAKN,OAAL,CAAahZ,MAAb,EAAJ,EACLY,IADK,CACA,UAACsJ,IAAD;CAAA,eAAWA,IAAI,CAACkG,QAAL,KAAkB,MAAlB,IAA4BlG,IAAI,CAACjO,EAAL,KAAYqd,MAAnD;CAAA,OADA,CAAP;CAGA,KA9FF;;CAAA;CAAA;CAAA,mCAgGgBjZ,IAhGhB,EAgG4BkW,UAhG5B,EAiGC;CAAA;;CACC,UAAI,KAAKwC,iBAAT,EACA;CACC,aAAKQ,qBAAL;CACA;CACA;;CACD,UAAIC,aAAa,GAAG,KAApB;CACA,UAAIpV,OAAO,GAAG,KAAKA,OAAnB;CACA,UAAIqV,aAAa,GAAG;CAAE9F,QAAAA,MAAM,EAAE;CAAV,OAApB;CACA,WAAK+F,SAAL,GAAiB,IAAIpD,wBAAJ,CAAW;CAC3Bra,QAAAA,EAAE,EAAEoE,IAAI,CAAC+N,KAAL,GAAa1G,QAAb,EADuB;CAE3B6O,QAAAA,UAAU,EAAEA,UAFe;CAG3BvH,QAAAA,KAAK,EAAE,GAHoB;CAI3BP,QAAAA,MAAM,EAAE,GAJmB;CAK3BkL,QAAAA,QAAQ,EAAE,IALiB;CAM3BjD,QAAAA,YAAY,EAAE,IANa;CAO3BF,QAAAA,YAAY,EAAE,IAPa;CAQ3BoD,QAAAA,WAAW,EAAE,IARc;CAS3BC,QAAAA,aAAa,EAAE;CACdC,UAAAA,eAAe,EAAE;CADH,SATY;CAY3BC,QAAAA,MAAM,EAAEpf,EAAE,CAACqf,KAAH,CAASC,cAAT,CAAwBC,MAZL;CAa3BC,QAAAA,aAAa,EAAE;CACdjW,UAAAA,MAAM,EAAE,KAAKA,MADC;CAEdE,UAAAA,OAAO,EAAEA;CAFK,SAbY;CAiB3B8B,QAAAA,SAAS,EAAE,EAjBgB;CAkB3B6Q,QAAAA,QAAQ,EAAE,CACT;CACC9a,UAAAA,EAAE,EAAE,UADL;CAECC,UAAAA,OAAO,EAAE;CACRkI,YAAAA,OAAO,EAAE,KAAKA,OADN;CAERgW,YAAAA,MAAM,EAAE/Z,IAAI,CAACuR,WAAL;CAFA;CAFV,SADS,CAlBiB;CA2B3ByI,QAAAA,qBAAqB,EAAE,IA3BI;CA4B3B1D,QAAAA,MAAM,EAAE;CACP,oBAAU,gBAACpS,SAAD,EAA0B;CACnCA,YAAAA,SAAS,CAAC+V,SAAV,GAAsBC,kBAAtB,GAA2ChM,KAA3C,CAAiDiM,MAAjD,GAA0D,CAA1D;;CACA,YAAA,MAAI,CAACC,sBAAL,CAA4BlW,SAA5B,EAAuCkV,aAAvC,EAAsDpZ,IAAtD;;CACA,YAAA,MAAI,CAACqa,eAAL,CAAqBnW,SAAS,CAAC+V,SAAV,EAArB;CACA,WALM;CAMP,2BAAiB,sBAACtf,KAAD,EAAW;CAC3Bwe,YAAAA,aAAa,GAAG,IAAhB;CACA,gBAAM5C,YAAY,GAAG5b,KAAK,CAACmX,OAAN,GAAgB9R,IAArC;CACA,gBAAMgL,GAAG,GAAGuL,YAAY,CAACC,QAAb,EAAZ;;CACA,YAAA,MAAI,CAACvb,IAAL,CAAU,iBAAV,EAA6B+P,GAA7B;CACA,WAXM;CAYP,6BAAmB,wBAACrQ,KAAD,EAAW;CAC7Bwe,YAAAA,aAAa,GAAG,IAAhB;CACA,gBAAMmB,cAAc,GAAG3f,KAAK,CAACmX,OAAN,GAAgB9R,IAAvC;CACA,gBAAMgL,GAAG,GAAGsP,cAAc,CAAC9D,QAAf,EAAZ;;CACA,YAAA,MAAI,CAACvb,IAAL,CAAU,mBAAV,EAA+B+P,GAA/B;CACA,WAjBM;CAkBP,sBAAY,kBAAArQ,KAAK,EAAI;CACpB,YAAA,MAAI,CAAC4f,gBAAL,CAAsB5f,KAAtB;CACA;CApBM,SA5BmB;CAkD3B6f,QAAAA,kBAAkB,EAAE;CACnBlE,UAAAA,MAAM,EAAE;CACPmE,YAAAA,OAAO,EAAE,iBAAC9f,KAAD,EAAW;CACnB,kBAAM+f,QAAQ,GAAG/f,KAAK,CAACmX,OAAN,GAAgB4I,QAAjC;;CACA,kBAAIA,QAAJ,EACA;CACC,oBAAMC,MAAM,GAAGD,QAAQ,CAACE,SAAT,EAAf;CACA,oBAAMC,KAAK,GAAGF,MAAM,CAACrb,YAAP,GAAsBuB,aAAtB,CAAoC,iCAApC,CAAd;CACAga,gBAAAA,KAAK,CAAC3P,WAAN,GAAoBnI,cAAI,CAACC,MAAL,CAAY0X,QAAQ,CAACI,eAAT,EAAZ,CAApB;CACA;CACD;CATM;CADW;CAlDO,OAAX,CAAjB;CAiEA,WAAKzB,SAAL,CAAe3e,SAAf,CAAyB,QAAzB,EAAmC,YAAM;CACxC,YAAIye,aAAJ,EACA;CACC,UAAA,MAAI,CAACle,IAAL,CAAU,eAAV;CACA;;CACD,QAAA,MAAI,CAACoe,SAAL,GAAiB,IAAjB;CACA,OAND;CAQA,WAAKA,SAAL,CAAe5c,IAAf;CACA;CApLF;CAAA;CAAA,mCAsLgBuD,IAtLhB,EAsL4BkW,UAtL5B,EAuLC;CAAA;;CACC,UAAM6E,WAAW,GAAG/a,IAAI,CAACqU,OAAL,GAAehJ,QAAf,EAApB;CAEA,UAAM2P,aAAa,GAAG,EAAtB;;CACA,UAAID,WAAJ,EACA;CACC,YAAME,eAAe,GAAG,KAAKtC,OAAL,CAAauC,GAAb,CAAiB,UAAUH,WAAW,CAACnf,EAAvC,CAAxB;;CACA,YAAIqf,eAAJ,EACA;CACCD,UAAAA,aAAa,CAACta,IAAd,CAAmBua,eAAnB;CACA;CACD;;CAED,UAAI9B,aAAa,GAAG,KAApB;CAEA,WAAKgC,UAAL,GAAkB,IAAIlF,wBAAJ,CAAW;CAC5Bra,QAAAA,EAAE,EAAEoE,IAAI,CAAC+N,KAAL,EADwB;CAE5BmI,QAAAA,UAAU,EAAEA,UAFgB;CAG5BvH,QAAAA,KAAK,EAAE,GAHqB;CAI5BP,QAAAA,MAAM,EAAE,GAJoB;CAK5BkL,QAAAA,QAAQ,EAAE,KALkB;CAM5BjD,QAAAA,YAAY,EAAE,IANc;CAO5BF,QAAAA,YAAY,EAAE,IAPc;CAQ5BtQ,QAAAA,SAAS,EAAE,EARiB;CAS5BmV,QAAAA,aAAa,EAAEA,aATa;CAU5Bla,QAAAA,KAAK,EAAE,KAAKsa,WAAL,EAVqB;CAW5B5B,QAAAA,aAAa,EAAE;CACdC,UAAAA,eAAe,EAAE,IADH;CAEdK,UAAAA,aAAa,EAAE;CACde,YAAAA,KAAK,EAAEvc,aAAG,CAACC,UAAJ,CAAe,uCAAf;CADO;CAFD,SAXa;CAiB5B8c,QAAAA,cAAc,EAAE,IAjBY;CAkB5B/E,QAAAA,MAAM,EAAE;CACP,sCAA4B,iCAAC3b,KAAD,EAAW;CACtC,mBAAO,IAAIoC,OAAJ,CAAY,UAACC,OAAD,EAAa;CAC/B,mCAAwBrC,KAAK,CAACmX,OAAN,EAAxB;CAAA,kBAAQwJ,WAAR,kBAAQA,WAAR;;CACA,kBAAMX,MAAM,GAAGhgB,KAAK,CAACsf,SAAN,EAAf;CACA,kBAAMpB,QAAQ,GAAGyC,WAAW,CAACC,QAAZ,EAAjB;;CACA,cAAA,MAAI,CAACC,UAAL,CAAgB3C,QAAhB,EACExc,IADF,CACO,UAACwN,IAAD,EAAoB;CACzB,gBAAA,MAAI,CAAC4R,iBAAL,CAAuB5R,IAAvB;;CACA,gBAAA,MAAI,CAAC4O,aAAL,CAAmBiD,sBAAnB,CAA0C,MAA1C,EAAkD;CACjDjb,kBAAAA,IAAI,EAAEoJ,IAAI,CAAC/N,IAAL,CAAUqM,IAAV,EAD2C;CAEjDwT,kBAAAA,KAAK,EAAExP,MAAM,CAACtC,IAAI,CAACjO,EAAN;CAFoC,iBAAlD;;CAIA,oBAAMggB,cAAc,GAAG,MAAI,CAACC,WAAL,CAAiBhS,IAAI,CAACjO,EAAtB,CAAvB;;CACAggB,gBAAAA,cAAc,CAACE,QAAf,GAA0B,IAA1B;CACAF,gBAAAA,cAAc,CAAC/L,IAAf,GAAsB,CAAtB;CACA8K,gBAAAA,MAAM,CAACoB,OAAP,CAAeH,cAAf;;CACA,gBAAA,MAAI,CAAC3gB,IAAL,CAAU,gBAAV,EAA4B4O,IAAI,CAACjO,EAAjC;;CACAud,gBAAAA,aAAa,GAAG,IAAhB;;CACA,gBAAA,MAAI,CAACgC,UAAL,CAAgBvM,IAAhB;;CACA5R,gBAAAA,OAAO;CACP,eAfF;CAiBA,aArBM,CAAP;CAsBA,WAxBM;CAyBP,2BAAiB,sBAACrC,KAAD,EAAW;CAC3Bwe,YAAAA,aAAa,GAAG,IAAhB;CACA,gBAAM5C,YAAY,GAAG5b,KAAK,CAACmX,OAAN,GAAgB9R,IAArC;CACA,gBAAMiZ,MAAM,GAAG1C,YAAY,CAACxI,KAAb,EAAf;;CACA,YAAA,MAAI,CAAC9S,IAAL,CAAU,gBAAV,EAA4Bge,MAA5B;CACA,WA9BM;CA+BP,6BAAmB,0BAAM;CACxBlB,YAAAA,UAAU,CAAC,YAAM;CAChBoB,cAAAA,aAAa,GAAG,IAAhB;;CACA,kBAAI,MAAI,CAACgC,UAAL,CAAgBa,gBAAhB,GAAmCje,MAAnC,KAA8C,CAAlD,EACA;CACC,gBAAA,MAAI,CAAC9C,IAAL,CAAU,gBAAV,EAA4B,CAA5B;CACA;CACD,aANS,EAMP,EANO,CAAV;CAOA;CAvCM,SAlBoB;CA2D5Buf,QAAAA,kBAAkB,EAAE;CACnByB,UAAAA,YAAY,EAAE,GADK;CAEnBC,UAAAA,WAAW,EAAE5d,aAAG,CAACC,UAAJ,CAAe,4CAAf;CAFM;CA3DQ,OAAX,CAAlB;CAiEA,WAAK4c,UAAL,CAAgBzgB,SAAhB,CAA0B,QAA1B,EAAoC,YAAM;CACzC,YAAIye,aAAJ,EACA;CACC,UAAA,MAAI,CAACle,IAAL,CAAU,gBAAV;CACA;;CACD,QAAA,MAAI,CAACkgB,UAAL,GAAkB,IAAlB;CACA,OAND;CAQA,WAAKA,UAAL,CAAgB1e,IAAhB;CACA;CAhRF;CAAA;CAAA,wCAmRC;CACC,aAAO,KAAK0e,UAAL,IAAmB,KAAKA,UAAL,CAAgBpF,MAAhB,EAA1B;CACA;CArRF;CAAA;CAAA,2CAwRC;CACC,aAAQ,KAAKoF,UAAL,IAAmB,KAAK9B,SAAhC;CACA;CA1RF;CAAA;CAAA,8CA6RC;CACC,UAAI,KAAK8B,UAAT,EACA;CACC,aAAKA,UAAL,CAAgBvM,IAAhB;CACA;;CAED,UAAI,KAAKyK,SAAT,EACA;CACC,aAAKA,SAAL,CAAezK,IAAf;CACA;CACD,KAvSF;;CAAA;CAAA;CAAA,yCA0SsBuN,WA1StB,EA0S0CC,YA1S1C,EA2SC;CAAA;;CACC,UAAI,KAAK1D,iBAAT,EACA;CACCyD,QAAAA,WAAW,CAACE,iBAAZ,CAA8B,KAA9B;CACA;CACA;;CACD,UAAM3P,KAAK,GAAGyP,WAAW,CAACG,YAAZ,EAAd;;CAEA,UAAI,KAAKC,eAAL,IAAwB,KAAKA,eAAL,CAAqBxO,KAArB,OAAiCoO,WAAW,CAACK,SAAZ,EAA7D,EACA;CACC,aAAKD,eAAL,GAAuB,IAAvB;CACA;;CACD,UAAIxY,OAAO,GAAG,KAAKA,OAAnB;;CACA,UAAI,CAAC,KAAKwY,eAAV,EACA;CACC,aAAKA,eAAL,GAAuB,IAAItG,wBAAJ,CAAW;CACjCra,UAAAA,EAAE,EAAEugB,WAAW,CAACK,SAAZ,EAD6B;CAEjCtG,UAAAA,UAAU,EAAEiG,WAAW,CAACxO,OAAZ,EAFqB;CAGjCgB,UAAAA,KAAK,EAAEwN,WAAW,CAACxO,OAAZ,GAAsB8O,WAHI;CAIjCrO,UAAAA,MAAM,EAAE,GAJyB;CAKjCkL,UAAAA,QAAQ,EAAE,KALuB;CAMjCjD,UAAAA,YAAY,EAAE,IANmB;CAOjCkD,UAAAA,WAAW,EAAE,IAPoB;CAQjC7C,UAAAA,QAAQ,EAAE,CACT;CACC9a,YAAAA,EAAE,EAAE,UADL;CAECC,YAAAA,OAAO,EAAE;CACRkI,cAAAA,OAAO,EAAE,KAAKA;CADN;CAFV,WADS,CARuB;CAgBjC2Y,UAAAA,UAAU,EAAE;CACXnV,YAAAA,OAAO,EAAE;CADE,WAhBqB;CAmBjCiS,UAAAA,aAAa,EAAE;CACdC,YAAAA,eAAe,EAAE;CADH,WAnBkB;CAsBjCC,UAAAA,MAAM,EAAEpf,EAAE,CAACqf,KAAH,CAASC,cAAT,CAAwBC,MAtBC;CAuBjCC,UAAAA,aAAa,EAAE;CACdjW,YAAAA,MAAM,EAAE,KAAKA,MADC;CAEdE,YAAAA,OAAO,EAAEA;CAFK,WAvBkB;CA2BjCiW,UAAAA,qBAAqB,EAAE,IA3BU;CA4BjC1D,UAAAA,MAAM,EAAE;CACP,sBAAU,gBAAC3b,KAAD,EAAW;CACpBA,cAAAA,KAAK,CAACsf,SAAN,GAAkBC,kBAAlB,GAAuChM,KAAvC,CAA6CiM,MAA7C,GAAsD,CAAtD;;CACA,cAAA,MAAI,CAACwC,6BAAL,CAAmChiB,KAAnC,EAA0CwhB,WAA1C;CACA,aAJM;CAKP,wBAAY,kBAAAxhB,KAAK,EAAI;CACpB,cAAA,MAAI,CAAC4f,gBAAL,CAAsB5f,KAAtB;CACA,aAPM;CAQP,6BAAiB,sBAACA,KAAD,EAAW;CAC3B,kBAAIiiB,QAAQ,GAAG,EAAf;CACA,kBAAMC,KAAK,GAAG,IAAIhU,MAAJ,CAAW,QAAX,EAAqB,GAArB,CAAd;CACA,kBAAMiU,YAAY,GAAGpQ,KAAK,CAACzL,KAAN,CAAY0H,KAAZ,CAAkBkU,KAAlB,EAAyBE,GAAzB,EAArB;CACArQ,cAAAA,KAAK,CAACzL,KAAN,CAAY0H,KAAZ,CAAkBkU,KAAlB,EACE3Z,OADF,CACU,UAAC8Z,YAAD,EAA0B;CAClC,oBAAIF,YAAY,KAAKE,YAArB,EACA;CACCJ,kBAAAA,QAAQ,GAAGA,QAAQ,GAAG,GAAX,GAAiBI,YAA5B;CACA;CACD,eANF;CAQA,kBAAMzG,YAAY,GAAG5b,KAAK,CAACmX,OAAN,GAAgB9R,IAArC;CACA4c,cAAAA,QAAQ,GAAGA,QAAQ,GAAG,IAAX,GAAkBrG,YAAY,CAACC,QAAb,EAA7B;CACA9J,cAAAA,KAAK,CAACzL,KAAN,GAAc2b,QAAQ,CAACzU,IAAT,EAAd;CACAuE,cAAAA,KAAK,CAACM,KAAN;CACAuJ,cAAAA,YAAY,CAAC0G,QAAb;CACA;CAzBM;CA5ByB,SAAX,CAAvB;CAyDA,aAAKV,eAAL,CAAqB7hB,SAArB,CAA+B,QAA/B,EAAyC,YAAM;CAC9CyhB,UAAAA,WAAW,CAACE,iBAAZ,CAA8B,KAA9B;CACA,SAFD;CAGA;;CAEDF,MAAAA,WAAW,CAACzhB,SAAZ,CAAsB,SAAtB,EAAiC,UAAAC,KAAK,EAAI;CACzC,YAAIiD,cAAI,CAACsf,KAAL,CAAW,MAAI,CAACX,eAAhB,CAAJ,EACA;CACC;CACA;;CACD,YAAMY,SAAS,GAAG,MAAI,CAACZ,eAAL,CAAqBa,YAArB,EAAlB;;CACA,YAAIxf,cAAI,CAACsf,KAAL,CAAWC,SAAX,CAAJ,EACA;CACC;CACA;;CACD,YAAIA,SAAS,CAACE,aAAV,EAAJ,EACA;CACC,UAAA,MAAI,CAACd,eAAL,CAAqB3N,IAArB;;CACA,UAAA,MAAI,CAAC2N,eAAL,GAAuB,IAAvB;CACA7P,UAAAA,KAAK,CAACM,KAAN;CACA;CACD,OAhBD;CAkBAmP,MAAAA,WAAW,CAACE,iBAAZ,CAA8B,IAA9B;CACA,WAAKE,eAAL,CAAqB9f,IAArB;CACA,WAAK8f,eAAL,CAAqBe,MAArB,CAA4BlB,YAA5B;CACA;CA7YF;CAAA;CAAA,4CAgZC;CACC,UAAI,KAAKG,eAAT,EACA;CACC,aAAKA,eAAL,CAAqB3N,IAArB;CACA;CACD;CArZF;CAAA;CAAA,yCAuZsBuN,WAvZtB,EAuZ0CC,YAvZ1C,EAwZC;CAAA;;CACC,UAAM1P,KAAK,GAAGyP,WAAW,CAACG,YAAZ,EAAd;;CAEA,UAAI,KAAKiB,gBAAL,IAAyB,KAAKA,gBAAL,CAAsBxP,KAAtB,OAAkCoO,WAAW,CAACK,SAAZ,EAA/D,EACA;CACC,aAAKe,gBAAL,GAAwB,IAAxB;CACA;;CAED,WAAKC,gBAAL,GAAwBpB,YAAxB;;CAEA,UAAI,CAAC,KAAKmB,gBAAV,EACA;CACC,aAAKA,gBAAL,GAAwB,IAAItH,wBAAJ,CAAW;CAClCra,UAAAA,EAAE,EAAEugB,WAAW,CAACK,SAAZ,EAD8B;CAElCtG,UAAAA,UAAU,EAAEiG,WAAW,CAACxO,OAAZ,EAFsB;CAGlCgB,UAAAA,KAAK,EAAEwN,WAAW,CAACxO,OAAZ,GAAsB8O,WAHK;CAIlCrO,UAAAA,MAAM,EAAE,GAJ0B;CAKlCkL,UAAAA,QAAQ,EAAE,KALwB;CAMlCjD,UAAAA,YAAY,EAAE,IANoB;CAOlCmD,UAAAA,aAAa,EAAE;CACdC,YAAAA,eAAe,EAAE,IADH;CAEdK,YAAAA,aAAa,EAAE;CACde,cAAAA,KAAK,EAAEvc,aAAG,CAACC,UAAJ,CAAe,uCAAf;CADO;CAFD,WAPmB;CAalCuC,UAAAA,KAAK,EAAE,KAAKsa,WAAL,EAb2B;CAclC9E,UAAAA,MAAM,EAAE;CACP,wCAA4B,iCAAC3b,KAAD,EAAW;CACtC,qBAAO,IAAIoC,OAAJ,CAAY,UAACC,OAAD,EAAa;CAC/B,sCAAwBrC,KAAK,CAACmX,OAAN,EAAxB;CAAA,oBAAQwJ,WAAR,mBAAQA,WAAR;;CACA,oBAAMzC,QAAQ,GAAGyC,WAAW,CAACC,QAAZ,EAAjB;CAEAY,gBAAAA,WAAW,CAACvU,OAAZ;CAEAuU,gBAAAA,WAAW,CAACsB,qBAAZ,CAAkC,+BAAI5E,QAAJ,EAAc9a,MAAhD;CACA2O,gBAAAA,KAAK,CAACM,KAAN;;CAEA,gBAAA,MAAI,CAACwO,UAAL,CAAgB3C,QAAhB,EACExc,IADF,CACO,UAACwN,IAAD,EAAqB;CAE1B,kBAAA,MAAI,CAAC4R,iBAAL,CAAuB5R,IAAvB;;CAEA,kBAAA,MAAI,CAAC4O,aAAL,CAAmBiD,sBAAnB,CAA0C,MAA1C,EAAkD;CACjDjb,oBAAAA,IAAI,EAAEoJ,IAAI,CAAC/N,IAAL,CAAUqM,IAAV,EAD2C;CAEjDwT,oBAAAA,KAAK,EAAExP,MAAM,CAACtC,IAAI,CAACjO,EAAN;CAFoC,mBAAlD;;CAKAugB,kBAAAA,WAAW,CAACrU,SAAZ;CACA4E,kBAAAA,KAAK,CAACM,KAAN;CACAmP,kBAAAA,WAAW,CAAC7H,OAAZ,CAAoBzK,IAApB;CAEA7M,kBAAAA,OAAO;CACP,iBAfF;;CAkBA,gBAAA,MAAI,CAACugB,gBAAL,CAAsB3O,IAAtB;;CACA,gBAAA,MAAI,CAAC2O,gBAAL,GAAwB,IAAxB;CACA,eA7BM,CAAP;CA8BA,aAhCM;CAiCP,6BAAiB,sBAAC5iB,KAAD,EAAsB;CACtC,kBAAM4b,YAAY,GAAG5b,KAAK,CAACmX,OAAN,GAAgB9R,IAArC;CACA,kBAAM6Y,QAAQ,GAAGtC,YAAY,CAACC,QAAb,EAAjB;CACA9J,cAAAA,KAAK,CAACzL,KAAN,GAAcyL,KAAK,CAACzL,KAAN,CAAYgH,OAAZ,CAAoB,MAAM,MAAI,CAACuV,gBAA/B,EAAiD,EAAjD,EAAqDvV,OAArD,CAA6D,GAA7D,EAAkE,EAAlE,CAAd;CACAyE,cAAAA,KAAK,CAACzL,KAAN,GAAcyL,KAAK,CAACzL,KAAN,GAAc,GAAd,GAAoB4X,QAAlC;CACAsD,cAAAA,WAAW,CAACsB,qBAAZ,CAAkC,+BAAI5E,QAAJ,EAAc9a,MAAhD;CACA2O,cAAAA,KAAK,CAACM,KAAN;CACAuJ,cAAAA,YAAY,CAAC0G,QAAb;CACAd,cAAAA,WAAW,CAAC7H,OAAZ,CAAoB,MAAI,CAACoJ,aAAL,CAAmBnH,YAAY,CAACC,QAAb,EAAnB,CAApB;CACA;CA1CM;CAd0B,SAAX,CAAxB;CA4DA,aAAK+G,gBAAL,CAAsB7iB,SAAtB,CAAgC,QAAhC,EAA0C,YAAM;CAC/CyhB,UAAAA,WAAW,CAACwB,iBAAZ,CAA8B,KAA9B;CACA,SAFD;CAIAxB,QAAAA,WAAW,CAACzhB,SAAZ,CAAsB,aAAtB,EAAqC,YAAM;CAC1C,cAAIkD,cAAI,CAACsf,KAAL,CAAW,MAAI,CAACK,gBAAhB,CAAJ,EACA;CACC;CACA;;CACD,cAAMJ,SAAS,GAAG,MAAI,CAACI,gBAAL,CAAsBH,YAAtB,EAAlB;;CACA,cAAIxf,cAAI,CAACsf,KAAL,CAAWC,SAAX,CAAJ,EACA;CACC;CACA;;CACD,cAAMS,eAAe,GAAGT,SAAS,CAACU,kBAAV,EAAxB;;CACA,cAAIjgB,cAAI,CAACsf,KAAL,CAAWU,eAAX,CAAJ,EACA;CACC;CACA;;CACD,cAAM/E,QAAQ,GAAG+E,eAAe,CAACrC,QAAhB,EAAjB;CAEAY,UAAAA,WAAW,CAACvU,OAAZ;CAEAuU,UAAAA,WAAW,CAACsB,qBAAZ,CAAkC,+BAAI5E,QAAJ,EAAc9a,MAAhD;CACA2O,UAAAA,KAAK,CAACM,KAAN;;CAEA,UAAA,MAAI,CAACwO,UAAL,CAAgB3C,QAAhB,EACExc,IADF,CACO,UAACwN,IAAD,EAAqB;CAE1B,YAAA,MAAI,CAAC4R,iBAAL,CAAuB5R,IAAvB;;CAEA,YAAA,MAAI,CAAC4O,aAAL,CAAmBiD,sBAAnB,CAA0C,MAA1C,EAAkD;CACjDjb,cAAAA,IAAI,EAAEoJ,IAAI,CAAC/N,IAAL,CAAUqM,IAAV,EAD2C;CAEjDwT,cAAAA,KAAK,EAAExP,MAAM,CAACtC,IAAI,CAACjO,EAAN;CAFoC,aAAlD;;CAKAugB,YAAAA,WAAW,CAACrU,SAAZ;CACA4E,YAAAA,KAAK,CAACM,KAAN;CACAmP,YAAAA,WAAW,CAAC7H,OAAZ,CAAoBzK,IAApB;CACA,WAbF;;CAgBA,UAAA,MAAI,CAAC0T,gBAAL,CAAsB3O,IAAtB;;CACA,UAAA,MAAI,CAAC2O,gBAAL,GAAwB,IAAxB;CACA,SAxCD;CAyCA;;CAEDpB,MAAAA,WAAW,CAACwB,iBAAZ,CAA8B,IAA9B;CAEA,WAAKJ,gBAAL,CAAsB9gB,IAAtB;CACA,WAAK8gB,gBAAL,CAAsBD,MAAtB,CAA6B,KAAKE,gBAAlC;CACA;CAnhBF;CAAA;CAAA,4CAshBC;CACC,UAAI,KAAKD,gBAAT,EACA;CACC,aAAKA,gBAAL,CAAsB3O,IAAtB;CACA;CACD;CA3hBF;CAAA;CAAA,+BA6hBYiK,QA7hBZ,EA8hBC;CACC,aAAO,KAAKja,aAAL,CAAmB4c,UAAnB,CACL;CACCzX,QAAAA,OAAO,EAAE,KAAKA,OADf;CAECjI,QAAAA,IAAI,EAAE+c;CAFP,OADK,EAMLxc,IANK,CAMA,UAACqB,QAAD,EAAc;CACnB,eAAOA,QAAQ,CAACZ,IAAhB;CACA,OARK,CAAP;CAUA;CAziBF;CAAA;CAAA,oCAukBiB6d,MAvkBjB,EAwkBC;CACC;CACAA,MAAAA,MAAM,CACJrb,YADF,GAEE2D,gBAFF,CAEmB,wBAFnB,EAGEC,OAHF,CAGU,UAAC2X,KAAD,EAAwB;CAChC9Z,QAAAA,aAAG,CAACgI,QAAJ,CAAa8R,KAAb,EAAoB,8BAApB;CACA,OALF;CAOA;CAjlBF;CAAA;CAAA,qCAmlBkBlgB,KAnlBlB,EAolBC;CACC,UAAIggB,MAAM,GAAGhgB,KAAK,CAACsf,SAAN,EAAb;CACA,UAAI6D,KAAK,GAAGnjB,KAAK,CAACmX,OAAN,GAAgBgM,KAA5B;;CACA,UAAIA,KAAK,CAAC3V,IAAN,OAAiB,EAArB,EACA;CACCwS,QAAAA,MAAM,CAACT,kBAAP,GAA4BrZ,aAA5B,CAA0C,oCAA1C,EAAgFkd,MAAhF,GAAyF,KAAzF;CACApD,QAAAA,MAAM,CAACT,kBAAP,GAA4BrZ,aAA5B,CAA0C,wCAA1C,EAAoFkd,MAApF,GAA6F,KAA7F;CACA,OAJD,MAMA;CACCpD,QAAAA,MAAM,CAACT,kBAAP,GAA4BrZ,aAA5B,CAA0C,oCAA1C,EAAgFkd,MAAhF,GAAyF,IAAzF;CACApD,QAAAA,MAAM,CAACT,kBAAP,GAA4BrZ,aAA5B,CAA0C,wCAA1C,EAAoFkd,MAApF,GAA6F,IAA7F;CACA;CACD;CAjmBF;CAAA;CAAA,kDAmmB+BpjB,KAnmB/B,EAmmBsCwhB,WAnmBtC,EAomBC;CAAA;;CACC,UAAIxB,MAAM,GAAGhgB,KAAK,CAACsf,SAAN,EAAb;CACA,WAAKI,eAAL,CAAqBM,MAArB;CACA,UAAIjO,KAAK,GAAGyP,WAAW,CAACG,YAAZ,EAAZ;CAEAH,MAAAA,WAAW,CAACzhB,SAAZ,CAAsB,aAAtB,EAAqC,UAACC,KAAD,EAAW;CAC/C,YAAMkiB,KAAK,GAAG,IAAIhU,MAAJ,CAAW,QAAX,EAAqB,GAArB,CAAd;CACA,YAAMiU,YAAY,GAAGpQ,KAAK,CAACzL,KAAN,CAAY0H,KAAZ,CAAkBkU,KAAlB,EAAyBE,GAAzB,EAArB;CACA,YAAMiB,OAAO,GAAGlB,YAAY,CAAC7U,OAAb,CAAqB,GAArB,EAA0B,EAA1B,EAA8BE,IAA9B,EAAhB;CACA,YAAIrL,IAAI,GAAG;CACVmhB,UAAAA,MAAM,EAAED,OADE;CAEVja,UAAAA,OAAO,EAAE,MAAI,CAACA,OAFJ;CAGVgW,UAAAA,MAAM,EAAE,CAHE;CAIVld,UAAAA,MAAM,EAAE;CAJE,SAAX;;CAMA,YAAImhB,OAAO,KAAK,EAAhB,EACA;CACC;CACA;;CACD,QAAA,MAAI,CAACpf,aAAL,CAAmBsf,MAAnB,CAA0BphB,IAA1B,EAAgCT,IAAhC,CAAqC,UAAAqB,QAAQ,EAAI;CAChD,cAAI,CAACA,QAAQ,CAACZ,IAAT,CAAcqhB,OAAnB,EACA;CACC,gBAAIC,UAAU,GAAG,sCAAjB;;CACA,YAAA,MAAI,CAACC,SAAL,CAAe1D,MAAM,CAAC5M,KAAP,EAAf,EAA+BqQ,UAA/B,EAA2C1gB,QAAQ,CAACZ,IAAT,CAAcwhB,KAAzD;;CACAvG,YAAAA,UAAU,CAAC,YAAM;CACf,cAAA,MAAI,CAACwG,WAAL,CAAiB5D,MAAjB,EAAyByD,UAAzB;CACA,aAFQ,EAGT,IAHS,CAAV;CAIA;CACA;;CACDzD,UAAAA,MAAM,CAAC2C,MAAP,CAAcU,OAAd;CACA,SAZD;CAaA,OA3BD;CA6BArD,MAAAA,MAAM,CAACT,kBAAP,GAA4BrZ,aAA5B,CAA0C,oCAA1C,EACE2d,gBADF,CACmB,OADnB,EAC4B,UAAA7jB,KAAK,EAAI;CACnC,YAAMkiB,KAAK,GAAG,IAAIhU,MAAJ,CAAW,QAAX,EAAqB,GAArB,CAAd;CACA,YAAMiU,YAAY,GAAGpQ,KAAK,CAACzL,KAAN,CAAY0H,KAAZ,CAAkBkU,KAAlB,EAAyBE,GAAzB,EAArB;CACA,YAAMiB,OAAO,GAAGlB,YAAY,CAAC7U,OAAb,CAAqB,GAArB,EAA0B,EAA1B,EAA8BE,IAA9B,EAAhB;CACA,YAAIrL,IAAI,GAAG;CACVmhB,UAAAA,MAAM,EAAED,OADE;CAEVja,UAAAA,OAAO,EAAE,MAAI,CAACA,OAFJ;CAGVgW,UAAAA,MAAM,EAAE,CAHE;CAIVld,UAAAA,MAAM,EAAE;CAJE,SAAX;;CAMA,YAAImhB,OAAO,KAAK,EAAhB,EACA;CACC;CACA;;CACD,QAAA,MAAI,CAACpf,aAAL,CAAmBsf,MAAnB,CAA0BphB,IAA1B,EAAgCT,IAAhC,CAAqC,UAAAqB,QAAQ,EAAI;CAChD,cAAI,CAACA,QAAQ,CAACZ,IAAT,CAAcqhB,OAAnB,EACA;CACC,gBAAIC,UAAU,GAAG,sCAAjB;;CACA,YAAA,MAAI,CAACC,SAAL,CAAe1D,MAAM,CAAC5M,KAAP,EAAf,EAA+BqQ,UAA/B,EAA2C1gB,QAAQ,CAACZ,IAAT,CAAcwhB,KAAzD;;CACAvG,YAAAA,UAAU,CAAC,YAAM;CACf,cAAA,MAAI,CAACwG,WAAL,CAAiB5D,MAAjB,EAAyByD,UAAzB;CACA,aAFQ,EAGT,IAHS,CAAV;CAIA;CACA;;CACDzD,UAAAA,MAAM,CAAC2C,MAAP,CAAcU,OAAd;CACA,SAZD;CAaA,OA5BF;CA6BA;CAnqBF;CAAA;CAAA,2CAqqBwBrjB,KArqBxB,EAqqB+Bye,aArqB/B,EAqqB8CpZ,IArqB9C,EAsqBC;CAAA;;CACC,UAAI2a,MAAM,GAAGhgB,KAAK,CAACsf,SAAN,EAAb;CACA,UAAM3D,MAAM,GAAG,CAAC,OAAD,EAAU,SAAV,CAAf;;CAEA,UAAMmI,OAAO,GAAG,SAAVA,OAAU,CAAA9jB,KAAK,EAAI;CACxB,YAAIA,KAAK,CAAC+jB,IAAN,KAAe,SAAnB,EACA;CACC,cAAI,EAAE,CAAC/jB,KAAK,CAACgkB,OAAN,IAAiBhkB,KAAK,CAACikB,OAAxB,KAAoCjkB,KAAK,CAACkkB,OAAN,KAAkB,EAAxD,CAAJ,EACA;CACC;CACA;CACD;;CAED,YAAM7T,GAAG,GAAG2P,MAAM,CAACmE,mBAAP,EAAZ;;CACA,YAAI9T,GAAG,CAAC7C,IAAJ,OAAe,EAAnB,EACA;CACC;CACA;;CACD,YAAMrL,IAAI,GAAG;CACZkO,UAAAA,GAAG,EAAEA,GADO;CAEZ+T,UAAAA,OAAO,EAAE,CAAC/e,IAAI,CAAC+N,KAAL,EAAD,CAFG;CAGZhK,UAAAA,OAAO,EAAE,MAAI,CAACA,OAHF;CAIZlH,UAAAA,MAAM,EAAE;CAJI,SAAb;;CAMA,QAAA,MAAI,CAAC+B,aAAL,CAAmBogB,cAAnB,CAAkCliB,IAAlC,EAAwCT,IAAxC,CAA6C,UAAAqB,QAAQ,EAAI;CACxD,cAAIA,QAAQ,CAACZ,IAAT,CAAcqhB,OAAlB,EACA;CACC/E,YAAAA,aAAa,CAAC9F,MAAd,GAAuB,IAAvB;;CACA,gBAAItT,KAAI,GAAG2a,MAAM,CAACoB,OAAP,CAAe;CACzBngB,cAAAA,EAAE,EAAEoP,GADqB;CAEzB+E,cAAAA,QAAQ,EAAE,UAFe;CAGzB1R,cAAAA,KAAK,EAAE2M,GAHkB;CAIzBzG,cAAAA,IAAI,EAAE;CAJmB,aAAf,CAAX;;CAOAvE,YAAAA,KAAI,CAACif,MAAL;;CACAjf,YAAAA,KAAI,CAACkf,SAAL,CAAe,CAAC;CAAE7gB,cAAAA,KAAK,EAAEX,QAAQ,CAACZ,IAAT,CAAcqiB;CAAvB,aAAD,CAAf;;CACAxE,YAAAA,MAAM,CAACyE,cAAP,GAAwBC,YAAxB;CACA1E,YAAAA,MAAM,CAAC2E,WAAP;CACA3E,YAAAA,MAAM,CAAC4E,cAAP;CAEA,WAhBD,MAkBA;CACC,gBAAInB,UAAU,GAAG,sCAAjB;;CACA,YAAA,MAAI,CAACC,SAAL,CAAe1D,MAAM,CAAC5M,KAAP,EAAf,EAA+BqQ,UAA/B,EAA2C1gB,QAAQ,CAACZ,IAAT,CAAcwhB,KAAzD;;CACAvG,YAAAA,UAAU,CAAC,YAAM;CACf,cAAA,MAAI,CAACwG,WAAL,CAAiB5D,MAAjB,EAAyByD,UAAzB;CACA,aAFQ,EAGT,IAHS,CAAV;CAIA;CACD,SA3BD;CA4BA,OAhDD;;CAkDA9H,MAAAA,MAAM,CAACpT,OAAP,CAAe,UAASsc,EAAT,EAAa;CAC3B,YAAIA,EAAE,KAAK,OAAX,EACA;CACC7E,UAAAA,MAAM,CAACT,kBAAP,GAA4BrZ,aAA5B,CAA0C,oCAA1C,EACE2d,gBADF,CACmBgB,EADnB,EACuBf,OADvB;CAEA,SAJD,MAMA;CACC9D,UAAAA,MAAM,CAACrb,YAAP,GAAsBkf,gBAAtB,CAAuCgB,EAAvC,EAA2Cf,OAA3C;CACA;CACD,OAVD;CAWA;CAvuBF;CAAA;CAAA,8BAyuBWgB,QAzuBX,EAyuB6BC,SAzuB7B,EAyuBgDpB,KAzuBhD,EA0uBC;CAAA,UAD8DqB,WAC9D,uEAD4E,sCAC5E;CACC,UAAIhF,MAAM,GAAGrgB,EAAE,CAACslB,EAAH,CAAMhG,cAAN,CAAqB3D,MAArB,CAA4B/W,OAA5B,CAAoCugB,QAApC,CAAb;;CAEA,UAAI9E,MAAM,CAACrb,YAAP,GAAsBuB,aAAtB,eAA2C6e,SAA3C,EAAJ,EACA;CACC;CACA;;CAED,UAAIjhB,KAAK,GAAGwD,QAAQ,CAAC4d,aAAT,CAAuB,KAAvB,CAAZ;CACAphB,MAAAA,KAAK,CAACihB,SAAN,GAAkBA,SAAlB;CACAjhB,MAAAA,KAAK,CAAC4P,SAAN,uCACkBsR,WADlB,iFAGQrB,KAHR;CAOA3D,MAAAA,MAAM,CAACT,kBAAP,GAA4B4F,MAA5B,CAAmCrhB,KAAnC;CACA;CA5vBF;CAAA;CAAA,gCA8vBakc,MA9vBb,EA8vB6B+E,SA9vB7B,EA+vBC;CACC,UAAIK,YAAY,GAAGpF,MAAM,CAACrb,YAAP,GAAsBuB,aAAtB,eAA2C6e,SAA3C,EAAnB;CACAK,MAAAA,YAAY,IAAIA,YAAY,CAACnS,MAAb,EAAhB;CACA;CAlwBF;CAAA;CAAA,4CAqwBC;CACC,UAAMxP,OAAO,GAAG,IAAII,gCAAJ,CAAe;CAC9BH,QAAAA,KAAK,EAAEC,aAAG,CAACC,UAAJ,CAAe,oDAAf,CADuB;CAE9BH,QAAAA,OAAO,EAAEE,aAAG,CAACC,UAAJ,CAAe,mDAAf,CAFqB;CAG9ByhB,QAAAA,OAAO,EAAEC,uCAAiB,CAACC,EAHG;CAI9BC,QAAAA,SAAS,EAAE7hB,aAAG,CAACC,UAAJ,CAAe,8DAAf,CAJmB;CAK9B6hB,QAAAA,IAAI,EAAE,gBAAU;CACfhiB,UAAAA,OAAO,CAAC5C,KAAR;CACA;CAP6B,OAAf,CAAhB;CASA4C,MAAAA,OAAO,CAAC3B,IAAR;CACA;CAhxBF;CAAA;CAAA,4CA2iBgC4jB,SA3iBhC,EA4iBC;CACC,UAAMxD,KAAK,GAAG,IAAIhU,MAAJ,CAAW2P,WAAW,CAAC8H,SAAvB,EAAkC,GAAlC,CAAd;CAEA,UAAMC,OAAO,GAAG,EAAhB;CACA,UAAIC,KAAJ;;CACA,aAAOA,KAAK,GAAG3D,KAAK,CAAC4D,IAAN,CAAWJ,SAAX,CAAf,EACA;CACCE,QAAAA,OAAO,CAAC7f,IAAR,CAAa8f,KAAK,CAAC,CAAD,CAAL,CAAS9V,SAAT,CAAmB,CAAnB,CAAb;CACA;;CAED,aAAO6V,OAAP;CACA;CAvjBF;CAAA;CAAA,6CAyjBiCF,SAzjBjC,EA0jBC;CACC,UAAMxD,KAAK,GAAG,IAAIhU,MAAJ,CAAW2P,WAAW,CAACkI,UAAvB,EAAmC,GAAnC,CAAd;CAEA,UAAMH,OAAO,GAAG,EAAhB;CACA,UAAIC,KAAJ;;CACA,aAAOA,KAAK,GAAG3D,KAAK,CAAC4D,IAAN,CAAWJ,SAAX,CAAf,EACA;CACCE,QAAAA,OAAO,CAAC7f,IAAR,CAAa8f,KAAK,CAAC,CAAD,CAAL,CAAS9V,SAAT,CAAmB,CAAnB,CAAb;CACA;;CAED,aAAO6V,OAAP;CACA;CArkBF;CAAA;CAAA,EAAiC9lB,6BAAjC;6BAAa+d,0BAEO;6BAFPA,2BAGQ;;;KChBRmI,KAAb;CAAA;;CAEC,mBACA;CAAA;;CAAA;CACC;;CAEA,UAAKvmB,iBAAL,CAAuB,sBAAvB;;CAEA,UAAKie,MAAL,GAAc,IAAd;CACA,UAAKuI,QAAL,GAAgB,IAAhB;CAEA,UAAKhgB,IAAL,GAAY,IAAZ;CAEA,UAAKK,KAAL,GAAa,EAAb;CACA,UAAK4I,IAAL,GAAY,IAAZ;CACA,UAAKgX,WAAL,GAAmB,KAAnB;CAEA,UAAKC,kBAAL,GAA0B,CAA1B;CAdD;CAeC;;CAlBF;CAAA;CAAA,8BAoBWzI,MApBX,EAqBC;CACC,WAAKA,MAAL,GAAcA,MAAd;CACA;CAvBF;CAAA;CAAA,gCA0BC;CACC,aAAO,KAAKA,MAAZ;CACA;CA5BF;CAAA;CAAA,8BA8BWA,MA9BX,EA+BC;CACC,aAAO,KAAKA,MAAL,IAAe,KAAKA,MAAL,CAAYtK,KAAZ,OAAwBsK,MAAM,CAACtK,KAAP,EAA9C;CACA;CAjCF;CAAA;CAAA,gCAmCanN,IAnCb,EAoCC;CACC,WAAKggB,QAAL,GAAgBhgB,IAAhB;CACA;CAtCF;CAAA;CAAA,kCAyCC;CACC,aAAO,KAAKggB,QAAZ;CACA;CA3CF;CAAA;CAAA,oCA8CC;CACC,WAAKA,QAAL,GAAgB,IAAhB;CACA;CAhDF;CAAA;CAAA,6BAmDC;CAAA;;CACC,WAAKG,MAAL,GAAche,cAAI,CAACsC,SAAL,EAAd;CAEA,WAAKzE,IAAL,GAAYiC,aAAG,CAACC,MAAhB,sYACYC,cAAI,CAACC,MAAL,CAAY,KAAK+d,MAAjB,CADZ,EAGkBziB,aAAG,CAACC,UAAJ,CAAe,6CAAf,CAHlB,EAKKwE,cAAI,CAACC,MAAL,CAAY,KAAK/B,KAAjB,CALL,EAOK3C,aAAG,CAACC,UAAJ,CAAe,oDAAf,CAPL;CAYA6E,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKkd,YAAL,EAAX,EAAgC,OAAhC,EAAyC,UAAC3hB,KAAD,EAAW;CACnD,QAAA,MAAI,CAACqmB,WAAL,CAAiBrmB,KAAjB;;CACA,QAAA,MAAI,CAACsmB,YAAL,CAAkBtmB,KAAlB;CACA,OAHD;CAIAyI,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKkd,YAAL,EAAX,EAAgC,SAAhC,EAA2C,KAAK4E,SAAL,CAAe9hB,IAAf,CAAoB,IAApB,CAA3C;CACAgE,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKkd,YAAL,EAAX,EAAgC,MAAhC,EAAwC,KAAK3P,MAAL,CAAYvN,IAAZ,CAAiB,IAAjB,CAAxC;CAEA,WAAKnE,IAAL,CAAU,QAAV;CAEA,WAAK4lB,WAAL,GAAmB,KAAnB;CAEA,aAAO,KAAKjgB,IAAZ;CACA;CA9EF;CAAA;CAAA,8BAgFWjG,KAhFX,EAiFC;CACC,UAAIA,KAAK,CAACyS,GAAN,KAAc,QAAd,IAA0BzS,KAAK,CAACyS,GAAN,KAAc,OAA5C,EACA;CACC,YAAI,CAAC,KAAK+T,gBAAL,EAAD,IAA4B,CAAC,KAAKC,gBAAL,EAAjC,EACA;CACC,eAAKC,MAAL;CAEA1mB,UAAAA,KAAK,CAAC2mB,wBAAN;CACA;;CAED,YACC3mB,KAAK,CAACyS,GAAN,KAAc,OAAd,IACG,EAAGmU,iBAAO,CAACC,KAAR,MAAmB7mB,KAAK,CAACikB,OAA1B,IAAsCjkB,KAAK,CAACgkB,OAA9C,CAFJ,EAIA;CACC,eAAK1jB,IAAL,CAAU,SAAV,EAAqB;CAAEN,YAAAA,KAAK,EAALA;CAAF,WAArB;CACA;;CACD,YACCA,KAAK,CAACyS,GAAN,KAAc,OAAd,KACKmU,iBAAO,CAACC,KAAR,MAAmB7mB,KAAK,CAACikB,OAA1B,IAAsCjkB,KAAK,CAACgkB,OADhD,CADD,EAIA;CACC,eAAK1jB,IAAL,CAAU,aAAV,EAAyB;CAAEN,YAAAA,KAAK,EAALA;CAAF,WAAzB;CACA;CACD;CACD;CA1GF;CAAA;CAAA,6BA6GC;CACC,UAAM+R,KAAK,GAAG,KAAK4P,YAAL,EAAd;;CAEA,UAAI5P,KAAK,CAACzL,KAAN,KAAgB,EAApB,EACA;CACC,aAAKwM,cAAL;CACA;CACD;CApHF;CAAA;CAAA,gCAsHa9S,KAtHb,EAuHC;CACC,UAAM8mB,kBAAkB,GAAG9mB,KAAK,CAACsQ,MAAN,CAAahK,KAAb,CAAmB0H,KAAnB,CAAyB,GAAzB,EAA8BoU,GAA9B,EAA3B;CACA,UAAM2E,eAAe,GAAGlJ,WAAW,CAACmJ,uBAAZ,CAAoCF,kBAApC,CAAxB;CAEA,UAAM3D,KAAK,GAAG4D,eAAe,CAAC3jB,MAAhB,GAAyB2jB,eAAe,CAAC3E,GAAhB,EAAzB,GAAiD,EAA/D;;CAEA,UAAIe,KAAK,IAAInjB,KAAK,CAACmC,IAAN,KAAe,GAA5B,EACA;CACC,aAAK6gB,iBAAL,CAAuB,KAAvB;CACA,aAAKtB,iBAAL,CAAuB,IAAvB;CAEA,aAAKphB,IAAL,CAAU,gBAAV,EAA4B6iB,KAA5B;CACA,OAND,MAQA;CACC,aAAK7iB,IAAL,CAAU,iBAAV;CACA;CACD;CAxIF;CAAA;CAAA,6BA2IC;CACC,WAAK2M,OAAL;;CAEA,UAAI,KAAK6E,OAAL,EAAJ,EACA;CACC,aAAKgB,cAAL;CACA,OAHD,MAKA;CACC,aAAKmU,cAAL;CACA;CACD;CAtJF;CAAA;CAAA,iCAwJcjnB,KAxJd,EAyJC;CACC,UAAMknB,SAAS,GAAGlnB,KAAK,CAACsQ,MAAxB;CACA,UAAM6W,gBAAgB,GAAGtJ,WAAW,CAACuJ,wBAAZ,CAAqCF,SAAS,CAAC5gB,KAA/C,CAAzB;CAEA,UAAM6c,KAAK,GAAGgE,gBAAgB,CAAC/jB,MAAjB,GAA0B+jB,gBAAgB,CAAC/E,GAAjB,EAA1B,GAAmD,EAAjE;;CAEA,UACC,KAAK+D,kBAAL,GAA0B,CAA1B,IACG,KAAKA,kBAAL,IAA2B,+BAAIhD,KAAJ,EAAW/f,MAF1C,EAIA;CACC;CACA;;CAED,WAAK+iB,kBAAL,GAA0B,CAA1B;;CAEA,UAAIhD,KAAK,IAAInjB,KAAK,CAACmC,IAAN,KAAe,GAA5B,EACA;CACC,aAAKuf,iBAAL,CAAuB,KAAvB;CACA,aAAKsB,iBAAL,CAAuB,IAAvB;CAEA,aAAK1iB,IAAL,CAAU,gBAAV,EAA4B6iB,KAA5B;CACA,OAND,MAQA;CACC,aAAK7iB,IAAL,CAAU,iBAAV;CACA;CACD;CApLF;CAAA;CAAA,4BAuLC;CACC,UAAMyR,KAAK,GAAG,KAAK4P,YAAL,EAAd;CAEA,UAAMve,MAAM,GAAG2O,KAAK,CAACzL,KAAN,CAAYlD,MAA3B;CAEA2O,MAAAA,KAAK,CAACM,KAAN;CACAN,MAAAA,KAAK,CAACO,iBAAN,CAAwBlP,MAAxB,EAAgCA,MAAhC;CACA;CA9LF;CAAA;CAAA,8BAiMC;CACCgD,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKnI,IAAlB,EAAwB,YAAxB;CAEA,WAAK0b,YAAL,GAAoB7U,QAApB,GAA+B,IAA/B;CACA;CArMF;CAAA;CAAA,gCAwMC;CACC1G,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKpI,IAArB,EAA2B,YAA3B;CAEA,WAAK0b,YAAL,GAAoB7U,QAApB,GAA+B,KAA/B;CAEA,WAAKxM,IAAL,CAAU,WAAV;CACA;CA9MF;CAAA;CAAA,+BAiNC;CACC,aAAO,CAAC2C,cAAI,CAAC8L,MAAL,CAAY,KAAK9I,IAAjB,CAAR;CACA;CAnNF;CAAA;CAAA,8BAsNC;CACC,UAAI,CAAC,KAAKohB,QAAL,EAAL,EACA;CACC,eAAO,IAAP;CACA;;CAED,UAAMtV,KAAK,GAAG,KAAK4P,YAAL,EAAd;CAEA,aAAO5P,KAAK,CAACzL,KAAN,KAAgB,EAAvB;CACA;CA/NF;CAAA;CAAA,oCAkOC;CACC,aAAO,KAAK4f,WAAZ;CACA;CApOF;CAAA;CAAA,4BAsOShX,IAtOT,EAuOC;CACC,WAAKA,IAAL,GAAYA,IAAZ;CACA;CAzOF;CAAA;CAAA,8BA4OC;CACC,aAAO,KAAKjJ,IAAZ;CACA;CA9OF;CAAA;CAAA,gCAiPC;CACC,aAAO,KAAKmgB,MAAZ;CACA;CAnPF;CAAA;CAAA,mCAsPC;CACC,aAAO,KAAKngB,IAAL,CAAUC,aAAV,CAAwB,UAAxB,CAAP;CACA;CAxPF;CAAA;CAAA,8BA2PC;CACC,aAAO,KAAKgJ,IAAZ;CACA;CA7PF;CAAA;CAAA,qCAgQC;CACC9I,MAAAA,aAAG,CAAC6M,MAAJ,CAAW,KAAKhN,IAAhB;CAEA,WAAKA,IAAL,GAAY,IAAZ;CAEA,WAAK3F,IAAL,CAAU,QAAV;CACA;CAtQF;CAAA;CAAA,sCAwQmBgG,KAxQnB,EAyQC;CACCF,MAAAA,aAAG,CAACC,IAAJ,CAAS,KAAKsb,YAAL,EAAT,EAA8B,mBAA9B,EAAmDrb,KAAnD;CACA;CA3QF;CAAA;CAAA,uCA8QC;CACC,aAAOF,aAAG,CAACC,IAAJ,CAAS,KAAKsb,YAAL,EAAT,EAA8B,mBAA9B,CAAP;CACA;CAhRF;CAAA;CAAA,sCAkRmBrb,KAlRnB,EAmRC;CACCF,MAAAA,aAAG,CAACC,IAAJ,CAAS,KAAKsb,YAAL,EAAT,EAA8B,oBAA9B,EAAoDrb,KAApD;CACA;CArRF;CAAA;CAAA,uCAwRC;CACC,aAAOF,aAAG,CAACC,IAAJ,CAAS,KAAKsb,YAAL,EAAT,EAA8B,oBAA9B,CAAP;CACA;CA1RF;CAAA;CAAA,0CA4RuBve,MA5RvB,EA6RC;CACC,WAAK+iB,kBAAL,GAA0Bhd,QAAQ,CAAC/F,MAAD,EAAS,EAAT,CAAlC;CACA;CA/RF;CAAA;CAAA,qCAkSC;CACC,UAAM2O,KAAK,GAAG,KAAK4P,YAAL,EAAd;;CAEA,UAAI5P,KAAK,CAACzL,KAAV,EACA;CACC,aAAKhG,IAAL,CAAU,gBAAV,EAA4ByR,KAAK,CAACzL,KAAlC;CAEA,aAAK4f,WAAL,GAAmB,IAAnB;CAEAnU,QAAAA,KAAK,CAACzL,KAAN,GAAc,EAAd;CACA;CACD;CA7SF;CAAA;CAAA,EAA2BxG,6BAA3B;;KCeawnB,MAAb;CAAA;;CAEC,kBAAYlmB,MAAZ,EACA;CAAA;;CAAA;CACC,wGAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,uBAAvB;;CAEA,UAAK0R,WAAL,GAAmB,IAAID,kBAAJ,EAAnB;CAEA,UAAK/K,KAAL,GAAa,IAAI4C,GAAJ,EAAb;CAEA,UAAKqL,SAAL,GAAiB,KAAjB;CACA,UAAKmT,cAAL,GAAsB,IAAIxe,GAAJ,EAAtB;;CAEA,UAAKye,eAAL,CAAqBpmB,MAArB;;CAEA,UAAKqmB,iBAAL,GAAyB,IAAzB;CAEA,UAAKxhB,IAAL,GAAY,IAAZ;CACA,UAAKyhB,SAAL,GAAiB,IAAjB;CAEA,UAAKC,UAAL,GAAkB,IAAlB;CACA,UAAKC,eAAL,GAAuB,IAAvB;CAEA,UAAKC,KAAL,GAAa,IAAb;CACA,UAAKC,QAAL,GAAgB,IAAhB;CACA,UAAKC,eAAL,GAAuB,IAAvB;CAxBD;CAyBC;;CA5BF;CAAA;CAAA,oCA8BiB3mB,MA9BjB,EA+BC;CACC,WAAKyT,KAAL,CAAWzT,MAAM,CAACH,EAAlB;CACA,WAAK+mB,QAAL,CAAc5mB,MAAM,CAACyG,KAArB;CACA,WAAKogB,cAAL,CAAoB7mB,MAAM,CAAC8mB,WAA3B;CACA,WAAKhO,cAAL,CAAoB9Y,MAAM,CAAC+P,WAA3B;CACA,WAAKgX,YAAL,CAAkB/mB,MAAM,CAAC0V,WAAzB;CACA,WAAKsR,YAAL,CAAkBhnB,MAAM,CAACinB,eAAzB;CACA,WAAKC,qBAAL,CAA2BlnB,MAAM,CAACmnB,oBAAlC;CAEA,WAAKC,QAAL,GAAgBrf,QAAQ,CAAC/H,MAAM,CAAConB,QAAR,EAAkB,EAAlB,CAAxB;CACA,WAAKC,kBAAL,CAAwBrnB,MAAM,CAACsnB,eAA/B;CACA;CA1CF;CAAA;CAAA,iCA4CchL,MA5Cd,EA6CC;CACC,WAAKgK,SAAL,GAAiB,IAAIjK,SAAJ,CAAcC,MAAd,CAAjB;CACA;CA/CF;CAAA;CAAA,mCAkDC;CACC,aAAO,KAAKgK,SAAZ;CACA;CApDF;CAAA;CAAA,iCAsDcphB,KAtDd,EAuDC;CAAA;;CACC,WAAKsO,SAAL,GAAkBtO,KAAK,KAAK,GAAV,GAAgB,GAAhB,GAAsB,GAAxC;CAEA,WAAKqX,QAAL,GACEpV,OADF,CACU,UAAClD,IAAD,EAAgB;CACxB,YAAIA,IAAI,CAACwQ,YAAL,MAAuBxQ,IAAI,CAACsjB,eAAL,EAA3B,EACA;CACCtjB,UAAAA,IAAI,CAAC8W,YAAL;CACA;;CACD9W,QAAAA,IAAI,CAAC8iB,YAAL,CAAkB,MAAI,CAACvT,SAAvB;CACA,OAPF;CASA;CAnEF;CAAA;CAAA,mCAsEC;CACC,aAAO,KAAKA,SAAZ;CACA;CAxEF;CAAA;CAAA,kCA2EC;CACC,aAAO,KAAKA,SAAL,KAAmB,GAA1B;CACA;CA7EF;CAAA;CAAA,iCA+EctO,KA/Ed,EAgFC;CACC,WAAK+hB,eAAL,GAAuB/hB,KAAK,KAAK,GAAjC;CACA;CAlFF;CAAA;CAAA,8BAqFC;CACC,aAAO,KAAKL,IAAZ;CACA;CAvFF;CAAA;CAAA,0BAyFOhF,EAzFP,EA0FC;CACC,WAAKA,EAAL,GAAWgC,cAAI,CAACuL,SAAL,CAAevN,EAAf,IAAqBkI,QAAQ,CAAClI,EAAD,EAAK,EAAL,CAA7B,GAAwC,CAAnD;;CAEA,UAAI,KAAKymB,SAAT,EACA;CACC,aAAKA,SAAL,CAAevS,WAAf,CAA2B,KAAKlU,EAAhC;CACA;CACD;CAjGF;CAAA;CAAA,4BAoGC;CACC,aAAO,KAAKA,EAAZ;CACA;CAtGF;CAAA;CAAA,6BAwGU4G,KAxGV,EAyGC;CACC,WAAKA,KAAL,GAAc5E,cAAI,CAAC4N,aAAL,CAAmBhJ,KAAnB,IAA4BA,KAA5B,GAAoC,EAAlD;CACA;CA3GF;CAAA;CAAA,+BA8GC;CACC,aAAO,KAAKA,KAAZ;CACA;CAhHF;CAAA;CAAA,oCAmHC;CACC,aAAO,QAAP;CACA;CArHF;CAAA;CAAA,gCAwHC;CACC,aAAO,KAAK4Q,aAAL,OAAyB,SAAhC;CACA;CA1HF;CAAA;CAAA,+BA6HC;CACC,aAAO,KAAP;CACA;CA/HF;CAAA;CAAA,kCAkIC;CACC,aAAO,KAAP;CACA;CApIF;CAAA;CAAA,uCAuIC;CACC,aAAQ,KAAKiP,SAAL,GAAiB,KAAKA,SAAL,CAAekB,WAAf,EAAjB,GAAgD,IAAxD;CACA;CAzIF;CAAA;CAAA,8BA4IC;CACC,aAAQ,KAAKziB,KAAL,CAAW+M,IAAX,KAAoB,CAA5B;CACA;CA9IF;CAAA;CAAA,qCAiJC;CACC,aAAO,KAAK/M,KAAL,CAAW+M,IAAlB;CACA;CAnJF;CAAA;CAAA,+BAsJC;CACC,aAAO,KAAK/M,KAAZ;CACA;CAxJF;CAAA;CAAA,4BA0JSd,IA1JT,EA2JC;CACC,aAAO,KAAKc,KAAL,CAAW6D,GAAX,CAAe3E,IAAI,CAAC+N,KAAL,EAAf,CAAP;CACA;CA7JF;CAAA;CAAA,kCAgKC;CACC,aAAO,KAAKoV,QAAZ;CACA;CAlKF;CAAA;CAAA,yCAqKC;CACC,aAAO,KAAKE,eAAZ;CACA;CAvKF;CAAA;CAAA,uCAyKoBA,eAzKpB,EA0KC;CACC,UAAIzlB,cAAI,CAACuL,SAAL,CAAeka,eAAf,CAAJ,EACA;CACCA,QAAAA,eAAe,GAAGvf,QAAQ,CAACuf,eAAD,EAAkB,EAAlB,CAA1B;CACA;;CAED,WAAKA,eAAL,GAAuBA,eAAe,GAAGA,eAAH,GAAqB,CAA3D;CACA;CAjLF;CAAA;CAAA,+CAoLC;CACC,WAAKA,eAAL;CACA;CAtLF;CAAA;CAAA,+CAyLC;CACC,WAAKA,eAAL;CACA;CA3LF;CAAA;CAAA,2CA8LC;CAAA;;CACC,UAAMG,aAAa,GAAG,KAAKC,gBAAL,EAAtB;;CACA,UAAI,CAACD,aAAL,EACA;CACC;CACA;;CAED,UAAI3T,IAAI,GAAG,CAAX;CACA2T,MAAAA,aAAa,CAACvgB,gBAAd,CAA+B,mBAA/B,EAAoDC,OAApD,CAA4D,UAACtC,IAAD,EAAuB;CAClF,YAAMZ,IAAI,GAAG,MAAI,CAACsY,QAAL,GAAgB4C,GAAhB,CAAoBpX,QAAQ,CAAClD,IAAI,CAACuR,OAAL,CAAavW,EAAd,EAAkB,EAAlB,CAA5B,CAAb;;CACA,YAAIoE,IAAJ,EACA;CACCA,UAAAA,IAAI,CAAC4P,OAAL,CAAaC,IAAb;CACAA,UAAAA,IAAI;CACJ;CACD,OAPD;CAQA;CA9MF;CAAA;CAAA,4BAgNS6T,OAhNT,EAiNC;CAAA;;CACC,WAAK5iB,KAAL,CAAWgN,GAAX,CAAe4V,OAAO,CAAC3V,KAAR,EAAf,EAAgC2V,OAAhC;CAEA,WAAKC,eAAL,CAAqBD,OAArB;CAEA,qCAAI,KAAK5iB,KAAL,CAAWnB,MAAX,EAAJ,EAAyBoL,GAAzB,CAA6B,UAAC/K,IAAD,EAAU;CACtC,QAAA,MAAI,CAAC4jB,mBAAL,CAAyB5jB,IAAzB;CACA,OAFD;CAIA0jB,MAAAA,OAAO,CAAC1T,aAAR,CAAsB,KAAKoD,aAAL,EAAtB;CACAsQ,MAAAA,OAAO,CAACZ,YAAR,CAAqB,KAAKe,YAAL,EAArB;CAEA,WAAKC,SAAL;CACA,WAAKC,YAAL;CACA,WAAKC,mBAAL;CAEA,WAAKC,oBAAL;CACA;CAlOF;CAAA;CAAA,wCAoOqBjkB,IApOrB,EAqOC;CACCA,MAAAA,IAAI,CAACkkB,eAAL,CAAqB,KAAKpjB,KAAL,CAAW+M,IAAX,GAAkB,CAAvC;CACA;CAvOF;CAAA;CAAA,+BAyOY7N,IAzOZ,EA0OC;CAAA;;CACC,UAAI,KAAKc,KAAL,CAAW6D,GAAX,CAAe3E,IAAI,CAAC+N,KAAL,EAAf,CAAJ,EACA;CACC,aAAKjN,KAAL,WAAkBd,IAAI,CAAC+N,KAAL,EAAlB;CAEA/N,QAAAA,IAAI,CAACmkB,cAAL;CAEA,uCAAI,KAAKrjB,KAAL,CAAWnB,MAAX,EAAJ,EAAyBoL,GAAzB,CAA6B,UAAC/K,IAAD,EAAU;CACtC,UAAA,MAAI,CAAC4jB,mBAAL,CAAyB5jB,IAAzB;CACA,SAFD;;CAIA,YAAIA,IAAI,CAACwQ,YAAL,EAAJ,EACA;CACCxQ,UAAAA,IAAI,CAACwT,WAAL,GAAmB4Q,OAAnB,GAA6BlhB,OAA7B,CAAqC,UAAClD,IAAD,EAAgB;CACpD,YAAA,MAAI,CAACqkB,UAAL,CAAgBrkB,IAAhB;CACA,WAFD;CAGA;;CAED,aAAKqjB,eAAL,GAAuB,CAAvB;CAEA,aAAKY,oBAAL;CACA;CACD;CAhQF;CAAA;CAAA,qCAkQkBjkB,IAlQlB,EAmQC;CACCe,MAAAA,aAAG,CAACujB,YAAJ,CAAiBtkB,IAAI,CAAC8C,MAAL,EAAjB,EAAgC,KAAK2gB,gBAAL,GAAwBc,gBAAxD;CAEA,WAAKN,oBAAL;CACA;CAvQF;CAAA;CAAA,oCA0QC;CACC,aAAO,CAACrmB,cAAI,CAAC8L,MAAL,CAAY,KAAK9I,IAAjB,CAAR;CACA;CA5QF;CAAA;CAAA,mCA8QgBiiB,WA9QhB,EA+QC;CACC,WAAKA,WAAL,GAAoBjlB,cAAI,CAACuL,SAAL,CAAe0Z,WAAf,IAA8B/e,QAAQ,CAAC+e,WAAD,EAAc,EAAd,CAAtC,GAA0D,CAA9E;CACA;CAjRF;CAAA;CAAA,qCAoRC;CACC,aAAQ,KAAKA,WAAL,GAAmB,KAAKA,WAAxB,GAAsC,KAAKvK,QAAL,GAAgBzK,IAA9D;CACA;CAtRF;CAAA;CAAA,0CAwRuB5M,KAxRvB,EAyRC;CACC,WAAKujB,kBAAL,GAA0BvjB,KAAK,KAAK,GAApC;CACA;CA3RF;CAAA;CAAA,2CA8RC;CACC,aAAO,KAAKujB,kBAAZ;CACA;CAhSF;CAAA;CAAA,oCAmSC;CAAA;;CACC,qCAAI,KAAK1jB,KAAL,CAAWnB,MAAX,EAAJ,EAAyBoL,GAAzB,CAA6B,UAAC/K,IAAD,EAAU;CACtC,QAAA,MAAI,CAAC2jB,eAAL,CAAqB3jB,IAArB;;CACA,QAAA,MAAI,CAAC4jB,mBAAL,CAAyB5jB,IAAzB;CACA,OAHD;CAKA,WAAKykB,QAAL;;CAEA,UAAI,CAAC,KAAKlc,WAAL,EAAL,EACA;CACC,aAAKga,eAAL,GAAuB,KAAK5U,OAAL,GAAe9M,aAAf,CAA6B,kCAA7B,CAAvB;CACA,aAAK6jB,eAAL,CAAqB,KAAKnC,eAA1B;CACA;;CAED,WAAK0B,oBAAL;CACA;CAlTF;CAAA;CAAA,oCAoTiBjkB,IApTjB,EAqTC;CAAA;;CACC,UAAI,CAAC,KAAKyjB,gBAAL,EAAL,EACA;CACC;CACA;;CAEDzjB,MAAAA,IAAI,CAACgQ,aAAL,CAAmB,KAAKoD,aAAL,EAAnB;CAEApT,MAAAA,IAAI,CAACtF,SAAL,CAAe,YAAf,EAA6B,UAACwJ,SAAD,EAA0B;CACtD,QAAA,MAAI,CAACjJ,IAAL,CAAU,YAAV,EAAwBiJ,SAAS,CAAC4N,OAAV,EAAxB;CACA,OAFD;CAIA9R,MAAAA,IAAI,CAACtF,SAAL,CAAe,UAAf,EAA2B,UAACwJ,SAAD,EAA0B;CACpD,QAAA,MAAI,CAACjJ,IAAL,CAAU,UAAV,EAAsBiJ,SAAS,CAAC+V,SAAV,EAAtB;CACA,OAFD;CAIAja,MAAAA,IAAI,CAACtF,SAAL,CAAe,oBAAf,EAAqC,UAACwJ,SAAD,EAA0B;CAC9D,QAAA,MAAI,CAACjJ,IAAL,CAAU,oBAAV,EAAgCiJ,SAAS,CAAC+V,SAAV,EAAhC;CACA,OAFD;CAIAja,MAAAA,IAAI,CAACtF,SAAL,CAAe,uBAAf,EAAwC,UAACwJ,SAAD,EAA0B;CACjE,QAAA,MAAI,CAACjJ,IAAL,CAAU,uBAAV,EAAmCiJ,SAAS,CAAC+V,SAAV,EAAnC;CACA,OAFD;CAIAja,MAAAA,IAAI,CAACtF,SAAL,CAAe,yBAAf,EAA0C,UAACwJ,SAAD,EAA0B;CACnE,QAAA,MAAI,CAACjJ,IAAL,CAAU,yBAAV,EAAqCiJ,SAAS,CAAC4N,OAAV,EAArC;CACA,OAFD;CAIA9R,MAAAA,IAAI,CAACtF,SAAL,CAAe,cAAf,EAA+B,UAACwJ,SAAD,EAA0B;CACxD,QAAA,MAAI,CAACjJ,IAAL,CAAU,cAAV,EAA0BiJ,SAAS,CAAC4N,OAAV,EAA1B;CACA,OAFD;CAIA9R,MAAAA,IAAI,CAACtF,SAAL,CAAe,aAAf,EAA8B,UAACwJ,SAAD,EAA0B;CACvD,QAAA,MAAI,CAACjJ,IAAL,CAAU,aAAV,EAAyBiJ,SAAS,CAAC4N,OAAV,EAAzB;CACA,OAFD;CAIA9R,MAAAA,IAAI,CAACtF,SAAL,CAAe,mBAAf,EAAoC,UAACwJ,SAAD,EAA0B;CAC7D,QAAA,MAAI,CAACjJ,IAAL,CAAU,mBAAV,EAA+BiJ,SAAS,CAAC+V,SAAV,EAA/B;CACA,OAFD;CAIAja,MAAAA,IAAI,CAACtF,SAAL,CAAe,YAAf,EAA6B,UAACwJ,SAAD,EAA0B;CACtD,QAAA,MAAI,CAACjJ,IAAL,CAAU,YAAV,EAAwBiJ,SAAS,CAAC+V,SAAV,EAAxB;CACA,OAFD;CAGA;CAhWF;CAAA;CAAA,oCAkWiBpD,MAlWjB,EAmWC;CACC,aAAO,KAAK/V,KAAL,CAAWoa,GAAX,CAAgBtd,cAAI,CAACuL,SAAL,CAAe0N,MAAf,IAAyB/S,QAAQ,CAAC+S,MAAD,EAAS,EAAT,CAAjC,GAAgDA,MAAhE,CAAP;CACA;CArWF;CAAA;CAAA,sCAuWmBrO,QAvWnB,EAwWC;CACC,aAAO,+BAAI,KAAK1H,KAAL,CAAWnB,MAAX,EAAJ,EAAyBY,IAAzB,CAA8B,UAACP,IAAD;CAAA,eAAgBA,IAAI,CAACuR,WAAL,OAAuB/I,QAAvC;CAAA,OAA9B,CAAP;CACA;CA1WF;CAAA;CAAA,2CA4WwBoI,YA5WxB,EA6WC;CACC,UAAM9P,KAAK,GAAG,IAAI4C,GAAJ,EAAd;CAEA,qCAAI,KAAK5C,KAAL,CAAWnB,MAAX,EAAJ,EAAyBoL,GAAzB,CAA6B,UAAC/K,IAAD,EAAgB;CAC5C,YAAIA,IAAI,CAAC+U,eAAL,OAA2BnE,YAA/B,EACA;CACC9P,UAAAA,KAAK,CAACgN,GAAN,CAAU9N,IAAI,CAAC+N,KAAL,EAAV,EAAwB/N,IAAxB;CACA;CACD,OALD;CAOA,aAAOc,KAAP;CACA;CAxXF;CAAA;CAAA,mCA0XgBgL,WA1XhB,EA2XC;CACC,WAAKA,WAAL,CAAiBQ,SAAjB,CAA2BR,WAA3B;CAEA,WAAK2Y,QAAL;CACA;CA/XF;CAAA;CAAA,qCAkYC;CACC,aAAO,KAAK3Y,WAAZ;CACA;CApYF;CAAA;CAAA,gCAsYa9L,IAtYb,EAuYC;CACC,UAAMwjB,aAAa,GAAG,KAAKC,gBAAL,EAAtB;CACA,UAAMkB,QAAQ,GAAG3kB,IAAI,CAAC2N,OAAL,EAAjB;CACA,UAAMZ,iBAAiB,GAAGyW,aAAa,CAACzW,iBAAxC;CAEA,aAAOA,iBAAiB,CAACoK,WAAlB,CAA8BwN,QAA9B,CAAP;CACA;CA7YF;CAAA;CAAA,+BA+YY3kB,IA/YZ,EAgZC;CACC,UAAMwjB,aAAa,GAAG,KAAKC,gBAAL,EAAtB;CACA,UAAMkB,QAAQ,GAAG3kB,IAAI,CAAC2N,OAAL,EAAjB;CAEA,aAAO6V,aAAa,CAACe,gBAAd,CAA+BpN,WAA/B,CAA2CwN,QAA3C,CAAP;CACA;CArZF;CAAA;CAAA,qCAuZkBjY,KAvZlB,EAwZC;CACC,UAAM8W,aAAa,GAAG,KAAKC,gBAAL,EAAtB;CAEA,UAAMmB,QAAQ,GAAGpB,aAAa,CAACzW,iBAA/B;;CAEA,UAAIL,KAAK,IAAIkY,QAAQ,CAACzN,WAAT,CAAqBzK,KAAK,CAACiB,OAAN,EAArB,CAAb,EACA;CACC,eAAOiX,QAAQ,CAACC,kBAAhB;CACA,OAHD,MAKA;CACC,eAAOD,QAAP;CACA;CACD;CAraF;CAAA;CAAA,oCAwaC;CACC,aAAO,KAAKrC,eAAL,GAAuB,KAAKA,eAA5B,GAA8C,IAArD;CACA;CA1aF;CAAA;CAAA,8BA6aC;CACCxhB,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK0a,gBAAL,EAAb,EAAsC,iCAAtC;CACA;CA/aF;CAAA;CAAA,6BAkbC;CACC1iB,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKya,gBAAL,EAAhB,EAAyC,iCAAzC;CACA;CApbF;CAAA;CAAA,wCAubC;CACC,WAAK1U,SAAL,GAAiB,IAAjB;CAEA,WAAKuJ,QAAL,GAAgBpV,OAAhB,CAAwB,UAAClD,IAAD,EAAgB;CACvCA,QAAAA,IAAI,CAAC8kB,iBAAL;CACA,OAFD;CAGA;CA7bF;CAAA;CAAA,0CAgcC;CACC,WAAK/V,SAAL,GAAiB,KAAjB;CAEA,WAAKuJ,QAAL,GAAgBpV,OAAhB,CAAwB,UAAClD,IAAD,EAAgB;CACvCA,QAAAA,IAAI,CAAC+kB,mBAAL;CACA,OAFD;CAIA,WAAK7C,cAAL,CAAoBhf,OAApB,CAA4B,UAAClD,IAAD,EAAgB;CAC3CA,QAAAA,IAAI,CAACglB,uBAAL;CACA,OAFD;CAGA,WAAK9C,cAAL,CAAoB/d,KAApB;CAEA,WAAKlJ,IAAL,CAAU,qBAAV;CACA;CA7cF;CAAA;CAAA,kCAgdC;CACC,aAAO,KAAK8T,SAAZ;CACA;CAldF;CAAA;CAAA,uCAodoB/O,IApdpB,EAqdC;CACC,WAAKkiB,cAAL,CAAoBpU,GAApB,CAAwB9N,IAAI,CAAC+N,KAAL,EAAxB,EAAsC/N,IAAtC;CAEAA,MAAAA,IAAI,CAACilB,kBAAL;CACA;CAzdF;CAAA;CAAA,4CA2dyBjlB,IA3dzB,EA4dC;CACC,WAAKkiB,cAAL,WAA2BliB,IAAI,CAAC+N,KAAL,EAA3B;CAEA/N,MAAAA,IAAI,CAACglB,uBAAL;CACA;CAheF;CAAA;CAAA,uCAkeoBhlB,IAlepB,EAmeC;CACC,aAAO,KAAKkiB,cAAL,CAAoBvd,GAApB,CAAwB3E,IAAI,CAAC+N,KAAL,EAAxB,CAAP;CACA;CAreF;CAAA;CAAA,wCAweC;CACC,aAAO,KAAKmU,cAAZ;CACA;CA1eF;CAAA;CAAA,oCA4eiBgD,UA5ejB,EA6eC;CAAA;;CACC,UAAI,CAACA,UAAL,EACA;CACC,YAAI,KAAK3C,eAAT,EACA;CACC2C,UAAAA,UAAU,GAAG,KAAK3C,eAAlB;CACA,SAHD,MAKA;CACC;CACA;CACD;;CAED,UAAI,KAAK4C,cAAL,MAAyB,KAAKhC,QAAlC,EACA;CACCpiB,QAAAA,aAAG,CAACgI,QAAJ,CAAamc,UAAb,EAAyB,WAAzB;CACA;;CAED,UAAItnB,cAAI,CAACC,WAAL,CAAiB0Z,oBAAjB,CAAJ,EACA;CACC;CACA;;CAED,UAAI,KAAK6K,iBAAT,EACA;CACC,aAAKA,iBAAL,CAAuBxK,UAAvB;CACA;;CAED,WAAKwK,iBAAL,GAAyB,IAAI7K,oBAAJ,CAAyB,UAACE,OAAD,EACjD;CACC,YAAIA,OAAO,CAAC,CAAD,CAAP,CAAWC,cAAX,KAA8B,IAAlC,EACA;CACC,cAAI,CAAC,MAAI,CAAC0N,iBAAL,EAAL,EACA;CACC,YAAA,MAAI,CAACnqB,IAAL,CAAU,WAAV;CACA;CACD;CACD,OATuB,EAUxB;CACC4c,QAAAA,SAAS,EAAE,CAAC,CAAD;CADZ,OAVwB,CAAzB;CAeA,WAAKuK,iBAAL,CAAuBtK,OAAvB,CAA+BoN,UAA/B;CACA;CAzhBF;CAAA;CAAA,wCA4hBC;CACC,UAAI,KAAK9C,iBAAT,EACA;CACC,aAAKA,iBAAL,CAAuBxK,UAAvB;CACA;;CAED,UAAI,KAAK2K,eAAT,EACA;CACCxhB,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKuZ,eAArB,EAAsC,WAAtC;CACA;CACD;CAtiBF;CAAA;CAAA,uCAwiBoBthB,KAxiBpB,EAyiBC;CACC,WAAKokB,eAAL,GAAuBlqB,OAAO,CAAC8F,KAAD,CAA9B;CACA;CA3iBF;CAAA;CAAA,wCA8iBC;CACC,aAAO,KAAKokB,eAAL,KAAyB,IAAhC;CACA;CAhjBF;CAAA;CAAA,sCAmjBC;CACC,UAAM9W,YAAY,GAAGxN,aAAG,CAACyN,WAAJ,CAAgB,KAAK+T,eAArB,CAArB;;CAEA,UAAI,KAAKD,UAAT,EACA;CACC,aAAKA,UAAL,CAAgBgD,OAAhB;CACA;;CAED,WAAKhD,UAAL,GAAkB,IAAI7T,kBAAJ,CAAW;CAC5BxD,QAAAA,MAAM,EAAE,KAAKsX,eADe;CAE5B1U,QAAAA,IAAI,EAAE,EAFsB;CAG5BvQ,QAAAA,IAAI,EAAE,QAHsB;CAI5BoR,QAAAA,MAAM,EAAE;CACPxS,UAAAA,GAAG,EAAE,KADE;CAEP2F,UAAAA,IAAI,YAAO0M,YAAY,CAACI,KAAb,GAAqB,CAAtB,GAA2B,EAAjC;CAFG;CAJoB,OAAX,CAAlB;;CAUA,UAAI,KAAKwW,cAAL,MAAyB,KAAKhC,QAAlC,EACA;CACC,aAAKb,UAAL,CAAgB7lB,IAAhB;CACA;;CAED,aAAO,KAAK6lB,UAAZ;CACA;CA3kBF;CAAA;CAAA,+BA6kBY;CA7kBZ;CAAA;CAAA,gCAglBC;CACC,UAAI,KAAKE,KAAT,EACA;CACCzhB,QAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKyZ,KAAL,CAAW7U,OAAX,EAAb,EAAmC,QAAnC;CACA;CACD;CArlBF;CAAA;CAAA,gCAwlBC;CACC,UAAI,KAAK6U,KAAT,EACA;CACCzhB,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKwZ,KAAL,CAAW7U,OAAX,EAAhB,EAAsC,QAAtC;CACA;CACD;CA7lBF;CAAA;CAAA,mCAgmBC;CACC,UAAI,KAAK8U,QAAT,EACA;CACC1hB,QAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK0Z,QAAL,CAAc9U,OAAd,EAAb,EAAsC,QAAtC;CACA;CACD;CArmBF;CAAA;CAAA,mCAwmBC;CACC,UAAI,KAAK8U,QAAT,EACA;CACC1hB,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKyZ,QAAL,CAAc9U,OAAd,EAAhB,EAAyC,QAAzC;CACA;CACD;CA7mBF;CAAA;CAAA,0CAgnBC;CACC,UAAI,KAAK+U,eAAT,EACA;CACC3hB,QAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK2Z,eAAL,CAAqB/U,OAArB,EAAb,EAA6C,QAA7C;CACA;CACD;CArnBF;CAAA;CAAA,0CAwnBC;CACC,UAAI,KAAK+U,eAAT,EACA;CACC3hB,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK0Z,eAAL,CAAqB/U,OAArB,EAAhB,EAAgD,QAAhD;CACA;CACD;CA7nBF;CAAA;CAAA,kCAgoBC;CACC,aAAO,KAAK8U,QAAL,GAAgB,KAAKA,QAAL,CAAc9U,OAAd,EAAhB,GAA0C,IAAjD;CACA;CAloBF;CAAA;CAAA,wCAooBqB4X,WApoBrB,EAooB+CC,YApoB/C,EAqoBC;CACC,UAAIA,YAAY,CAACX,kBAAjB,EACA;CACC9jB,QAAAA,aAAG,CAACujB,YAAJ,CAAiBiB,WAAjB,EAA8BC,YAAY,CAACX,kBAA3C;CACA,OAHD,MAKA;CACC,YAAI,KAAKY,aAAL,EAAJ,EACA;CACC1kB,UAAAA,aAAG,CAACyD,MAAJ,CAAW+gB,WAAX,EAAwB,KAAKE,aAAL,EAAxB;CACA,SAHD,MAKA;CACC1kB,UAAAA,aAAG,CAACyD,MAAJ,CAAW+gB,WAAX,EAAwB,KAAK9B,gBAAL,EAAxB;CACA;CACD;CACD;CArpBF;CAAA;CAAA,2CAwpBC;CACC,UAAI7lB,cAAI,CAAC8L,MAAL,CAAY,KAAK+Z,gBAAL,EAAZ,CAAJ,EACA;CACC;CACA;;CAED,UAAMiC,kBAAkB,GAAG,KAAKjC,gBAAL,GAAwBtV,YAAxB,GAAuC,KAAKsV,gBAAL,GAAwBthB,YAA1F;;CAEA,UAAIujB,kBAAJ,EACA;CACC,aAAKC,YAAL,GAAoBC,YAApB;CACA,OAHD,MAKA;CACC,aAAKD,YAAL,GAAoBE,eAApB;CACA;CACD;CAxqBF;CAAA;CAAA,EAA4BprB,6BAA5B;;;KCrBaqrB,MAAb;CAAA;;CAEC,kBAAYC,OAAZ,EACA;CAAA;;CAAA;CACC,wGAAMA,OAAN;;CAEA,UAAK3rB,iBAAL,CAAuB,8BAAvB;;CAEA,UAAK2rB,OAAL,GAAeA,OAAf;CAEA,UAAKC,gBAAL,GAAwB,KAAxB;CACA,UAAKC,gBAAL,GAAwB,KAAxB;CAEA,UAAKrlB,IAAL,GAAY,IAAZ;CAEA,UAAKslB,UAAL,GAAkB,IAAlB;CACA,UAAKC,UAAL,GAAkB,IAAlB;CAbD;CAcC;;CAjBF;CAAA;CAAA,6BAoBC;CACC,UAAMC,aAAa,GAAG,gFAAtB;CACA,UAAMC,aAAa,GAAG,8DAAtB;CAEA,WAAKzlB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,oiBAKMxE,aAAG,CAACC,UAAJ,CAAe,2BAAf,CALN,EAOK,KAAK+nB,sBAAL,CAA4B,KAAKP,OAAL,CAAaQ,cAAb,EAA5B,CAPL,EAU4CH,aAV5C,EAWK9nB,aAAG,CAACC,UAAJ,CAAe,iCAAf,CAXL,EAa4C8nB,aAb5C,EAcK/nB,aAAG,CAACC,UAAJ,CAAe,iCAAf,CAdL;CAoBA,UAAMyhB,OAAO,GAAG,KAAKpf,IAAL,CAAUqC,gBAAV,CAA2B,QAA3B,CAAhB;CAEA,WAAKijB,UAAL,GAAkBlG,OAAO,CAAChgB,IAAR,CAAa,CAAb,CAAlB;CACA,WAAKmmB,UAAL,GAAkBnG,OAAO,CAAChgB,IAAR,CAAa,CAAb,CAAlB;CAEAoD,MAAAA,eAAK,CAAChE,IAAN,CAAW4gB,OAAO,CAAChgB,IAAR,CAAa,CAAb,CAAX,EAA4B,OAA5B,EAAqC,KAAKwmB,WAAL,CAAiBpnB,IAAjB,CAAsB,IAAtB,CAArC;CACAgE,MAAAA,eAAK,CAAChE,IAAN,CAAW4gB,OAAO,CAAChgB,IAAR,CAAa,CAAb,CAAX,EAA4B,OAA5B,EAAqC,KAAKymB,WAAL,CAAiBrnB,IAAjB,CAAsB,IAAtB,CAArC;CAEA,aAAO,KAAKwB,IAAZ;CACA;CArDF;CAAA;CAAA,sCAuDmBK,KAvDnB,EAwDC;CACCF,MAAAA,aAAG,CAACkH,OAAJ,CACC,KAAKrH,IAAL,CAAUC,aAAV,CAAwB,6BAAxB,CADD,EAEC,KAAKylB,sBAAL,CAA4BrlB,KAA5B,CAFD;CAIA;CA7DF;CAAA;CAAA,2CA+DwBA,KA/DxB,EAgEC;CACC,aAAO4B,aAAG,CAACC,MAAX,4KAEIxE,aAAG,CAACC,UAAJ,CAAe,yCAAf,EAA0D0J,OAA1D,CAAkE,SAAlE,EAA6EhH,KAA7E,CAFJ;CAKA;CAtEF;CAAA;CAAA,uCAyEC;CACC,WAAK+kB,gBAAL,GAAwB,KAAxB;CAEAjlB,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKkd,UAArB,EAAiC,aAAjC;CACA;CA7EF;CAAA;CAAA,qCAgFC;CACC,WAAKF,gBAAL,GAAwB,IAAxB;CAEAjlB,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKmd,UAAlB,EAA8B,aAA9B;CACA;CApFF;CAAA;CAAA,uCAuFC;CACC,WAAKD,gBAAL,GAAwB,KAAxB;CAEAllB,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKmd,UAArB,EAAiC,aAAjC;CACA;CA3FF;CAAA;CAAA,qCA8FC;CACC,WAAKF,gBAAL,GAAwB,IAAxB;CAEAllB,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKod,UAAlB,EAA8B,aAA9B;CACA;CAlGF;CAAA;CAAA,kCAqGC;CACC,UAAI,KAAKH,gBAAT,EACA;CACC;CACA;;CAED,WAAKU,cAAL;CAEA,WAAKzrB,IAAL,CAAU,WAAV;CACA;CA9GF;CAAA;CAAA,kCAiHC;CACC,UAAI,KAAKgrB,gBAAT,EACA;CACC;CACA;;CAED,WAAKU,cAAL;CAEA,WAAK1rB,IAAL,CAAU,WAAV;CACA;CA1HF;CAAA;CAAA,EAA4BR,6BAA5B;;;KCDamsB,KAAb;CAEC,iBAAYvO,MAAZ,EACA;CAAA;CACC,SAAKA,MAAL,GAAcA,MAAd;CAEA,SAAKzX,IAAL,GAAY,IAAZ;CACA;;CAPF;CAAA;CAAA,6BAUC;CACC,UAAI,KAAKyX,MAAL,CAAYwO,SAAZ,EAAJ,EACA;CACC,eAAO,KAAKC,aAAL,EAAP;CACA,OAHD,MAIK,IAAI,KAAKzO,MAAL,CAAY9P,WAAZ,EAAJ,EACL;CACC,eAAO,KAAKwe,qBAAL,EAAP;CACA;CACD;CAnBF;CAAA;CAAA,oCAsBC;CACC,WAAKnmB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,ykBAIKxE,aAAG,CAACC,UAAJ,CAAe,6BAAf,CAJL,EAOKD,aAAG,CAACC,UAAJ,CAAe,6BAAf,CAPL,EAUKD,aAAG,CAACC,UAAJ,CAAe,6BAAf,CAVL,EAaKD,aAAG,CAACC,UAAJ,CAAe,6BAAf,CAbL;CAkBA,aAAO,KAAKqC,IAAZ;CACA;CA1CF;CAAA;CAAA,4CA6CC;CACC,WAAKA,IAAL,GAAYiC,aAAG,CAACC,MAAhB,uLAEIxE,aAAG,CAACC,UAAJ,CAAe,oCAAf,CAFJ;CAMA,aAAO,KAAKqC,IAAZ;CACA;CArDF;CAAA;CAAA,8BAwDC;CACC,aAAO,KAAKA,IAAZ;CACA;CA1DF;CAAA;CAAA,iCA6DC;CACCG,MAAAA,aAAG,CAAC6M,MAAJ,CAAW,KAAKhN,IAAhB;CAEA,WAAKA,IAAL,GAAY,IAAZ;CACA;CAjEF;CAAA;CAAA;;;KCCaomB,QAAb;CAAA;;CAEC,oBAAY3O,MAAZ,EACA;CAAA;;CAAA;CACC,0GAAMA,MAAN;;CAEA,UAAKje,iBAAL,CAAuB,yBAAvB;;CAEA,UAAKie,MAAL,GAAcA,MAAd;CAEA,UAAK2K,eAAL,GAAuB,KAAvB;CAEA,UAAKpiB,IAAL,GAAY,IAAZ;CATD;CAUC;;CAbF;CAAA;CAAA,6BAgBC;CACC,UAAI,KAAKyX,MAAL,CAAYwO,SAAZ,EAAJ,EACA;CACC,eAAO,KAAKC,aAAL,EAAP;CACA,OAHD,MAKA;CACC,eAAO,KAAKG,YAAL,EAAP;CACA;CACD;CAzBF;CAAA;CAAA,8BA4BC;CACC,aAAO,KAAKrmB,IAAZ;CACA;CA9BF;CAAA;CAAA,iCAiCC;CACCG,MAAAA,aAAG,CAAC6M,MAAJ,CAAW,KAAKhN,IAAhB;CAEA,WAAKA,IAAL,GAAY,IAAZ;CACA;CArCF;CAAA;CAAA,oCAwCC;CAAA;;CACC,WAAKA,IAAL,GAAYiC,aAAG,CAACC,MAAhB,kNAC2E,KAAKuV,MAAL,CAAYtK,KAAZ,EAD3E,EAEIzP,aAAG,CAACC,UAAJ,CAAe,gCAAf,CAFJ;CAMA6E,MAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IADN,EAEC,OAFD,EAGC;CAAA,eAAM,MAAI,CAAC3F,IAAL,CAAU,YAAV,CAAN;CAAA,OAHD;CAMA,aAAO,KAAK2F,IAAZ;CACA;CAtDF;CAAA;CAAA,mCAyDC;CAAA;;CACC,WAAKA,IAAL,GAAYiC,aAAG,CAACC,MAAhB,+RAC2D,KAAKuV,MAAL,CAAYtK,KAAZ,EAD3D,EAGKzP,aAAG,CAACC,UAAJ,CAAe,4BAAf,CAHL,EAKI,KAAK2oB,qBAAL,EALJ;;CASA,UAAI,CAAC,KAAKlE,eAAV,EACA;CACC5f,QAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,yCAAxB,CADD,EAEC,OAFD,EAGC;CAAA,iBAAM,MAAI,CAAC5F,IAAL,CAAU,YAAV,CAAN;CAAA,SAHD;CAKA;;CAED,aAAO,KAAK2F,IAAZ;CACA;CA7EF;CAAA;CAAA,4CAgFC;CACC,UAAI,KAAKoiB,eAAT,EACA;CACC,eAAOngB,aAAG,CAACC,MAAX,0LAEIxE,aAAG,CAACC,UAAJ,CAAe,4BAAf,CAFJ;CAKA,OAPD,MASA;CACC,eAAOsE,aAAG,CAACC,MAAX,mRAGKxE,aAAG,CAACC,UAAJ,CAAe,4BAAf,CAHL,EAIYD,aAAG,CAACC,UAAJ,CAAe,4BAAf,CAJZ;CAOA;CACD;CAnGF;CAAA;CAAA,mCAsGC;CACC,WAAKykB,eAAL,GAAuB,IAAvB;CACA;CAxGF;CAAA;CAAA,EAA8BvoB,6BAA9B;;;KCFa0sB,eAAb;CAEC,2BAAY9O,MAAZ,EACA;CAAA;CACC,SAAKA,MAAL,GAAcA,MAAd;CAEA,SAAKzX,IAAL,GAAY,IAAZ;CACA;;CAPF;CAAA;CAAA,6BAUC;CACC,WAAKA,IAAL,GAAYiC,aAAG,CAACC,MAAhB,uLAEI,KAAKskB,WAAL,EAFJ;CAMA,aAAO,KAAKxmB,IAAZ;CACA;CAlBF;CAAA;CAAA,8BAqBC;CACC,aAAO,KAAKA,IAAZ;CACA;CAvBF;CAAA;CAAA,kCA0BC;CACC,UAAI,KAAKyX,MAAL,CAAYwO,SAAZ,EAAJ,EACA;CACC,eAAOvoB,aAAG,CAACC,UAAJ,CAAe,uCAAf,CAAP;CACA,OAHD,MAKA;CACC,eAAOD,aAAG,CAACC,UAAJ,CAAe,sCAAf,CAAP;CACA;CACD;CAnCF;CAAA;CAAA;;;KCea8oB,OAAb;CAAA;;CAEC,mBAAYtrB,MAAZ,EACA;CAAA;;CAAA;CACC,yGAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,wBAAvB;;CAEA,UAAKktB,gBAAL,CAAsBvrB,MAAtB;;CAEA,UAAKwrB,MAAL,GAAc,IAAd;CAPD;CAQC;;CAXF;CAAA;CAAA,qCAakBxrB,MAblB,EAcC;CAAA;;CACCA,MAAAA,MAAM,CAAC+E,KAAP,CAAaoC,OAAb,CAAqB,UAACskB,QAAD,EAAc;CAClC,YAAMxnB,IAAI,GAAG8O,IAAI,CAAC2Y,SAAL,CAAeD,QAAf,CAAb;CACAxnB,QAAAA,IAAI,CAAC8iB,YAAL,CAAkB,MAAI,CAACe,YAAL,EAAlB;;CACA,QAAA,MAAI,CAAC/iB,KAAL,CAAWgN,GAAX,CAAe9N,IAAI,CAAC+N,KAAL,EAAf,EAA6B/N,IAA7B;CACA,OAJD;CAKA;CApBF;CAAA;CAAA,8BAmCW+lB,OAnCX,EAoCC;CAAA;;CACC,WAAKwB,MAAL,GAAc,IAAIzB,MAAJ,CAAWC,OAAX,CAAd;CAEA,WAAKwB,MAAL,CAAY7sB,SAAZ,CAAsB,WAAtB,EAAmC,UAACwJ,SAAD,EAA0B;CAC5D,QAAA,MAAI,CAACjJ,IAAL,CAAU,iBAAV,EAA6BiJ,SAAS,CAAC+V,SAAV,EAA7B;CACA,OAFD;CAIA,WAAKsN,MAAL,CAAY7sB,SAAZ,CAAsB,WAAtB,EAAmC,UAACwJ,SAAD,EAA0B;CAC5D,YAAI,MAAI,CAAC8e,eAAT,EACA;CACC,UAAA,MAAI,CAAC/nB,IAAL,CAAU,iBAAV;CACA,SAHD,MAKA;CACC,UAAA,MAAI,CAACA,IAAL,CAAU,WAAV,EAAuBiJ,SAAS,CAAC+V,SAAV,EAAvB;CACA;CACD,OATD;CAUA;CArDF;CAAA;CAAA,6BAuDU8L,OAvDV,EAwDC;CACC,WAAKvD,KAAL,GAAa,IAAIoE,KAAJ,CAAUb,OAAV,CAAb;CACA;CA1DF;CAAA;CAAA,gCA4DaA,OA5Db,EA6DC;CAAA;;CACC,WAAKtD,QAAL,GAAgB,IAAIuE,QAAJ,CAAajB,OAAb,CAAhB;CAEA,WAAKtD,QAAL,CAAc/nB,SAAd,CAAwB,YAAxB,EAAsC,YAAM;CAC3C,YAAI,MAAI,CAACsoB,eAAT,EACA;CACC,UAAA,MAAI,CAAC/nB,IAAL,CAAU,iBAAV;CACA,SAHD,MAKA;CACC,UAAA,MAAI,CAACA,IAAL,CAAU,WAAV;CACA;CACD,OATD;CAUA;CA1EF;CAAA;CAAA,uCA4EoB8qB,OA5EpB,EA6EC;CACC,WAAKrD,eAAL,GAAuB,IAAIyE,eAAJ,CAAoBpB,OAApB,CAAvB;CACA;CA/EF;CAAA;CAAA,mCAiFgBlD,WAjFhB,EAkFC;CACC,0GAAqBA,WAArB;;CAEA,UAAI,KAAK0E,MAAT,EACA;CACC,aAAKA,MAAL,CAAYG,iBAAZ,CAA8B,KAAKnB,cAAL,EAA9B;CACA;CACD;CAzFF;CAAA;CAAA,oCA4FC;CACC,aAAO,SAAP;CACA;CA9FF;CAAA;CAAA,iCAiGC;CACC,aAAO,KAAP;CACA;CAnGF;CAAA;CAAA,6BAsGC;CACC,WAAK3lB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,yTAGK,KAAKykB,MAAL,GAAc,KAAKA,MAAL,CAAYzkB,MAAZ,EAAd,GAAqC,EAH1C,EAIK,KAAK0f,KAAL,GAAa,KAAKA,KAAL,CAAW1f,MAAX,EAAb,GAAmC,EAJxC,EAKK,KAAK2f,QAAL,GAAgB,KAAKA,QAAL,CAAc3f,MAAd,EAAhB,GAAyC,EAL9C,EAMK,KAAK4f,eAAL,GAAuB,KAAKA,eAAL,CAAqB5f,MAArB,EAAvB,GAAuD,EAN5D,EAOK,KAAKuf,SAAL,GAAiB,KAAKA,SAAL,CAAevf,MAAf,EAAjB,GAA2C,EAPhD;CAYAM,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,6BAAxB,CAAX,EAAmE,QAAnE,EAA6E,KAAK8mB,aAAL,CAAmBvoB,IAAnB,CAAwB,IAAxB,CAA7E;CAEA,aAAO,KAAKwB,IAAZ;CACA;CAtHF;CAAA;CAAA,4BAwHS8iB,OAxHT,EAyHC;CACC,mGAAcA,OAAd;;CAEA,UAAIA,OAAO,CAAC/V,OAAR,EAAJ,EACA;CACC5M,QAAAA,aAAG,CAACgI,QAAJ,CAAa2a,OAAO,CAAC/V,OAAR,EAAb,EAAgC,gBAAhC;CACA;CACD;CAhIF;CAAA;CAAA,+BAkIY3N,IAlIZ,EAmIC;CACC,sGAAiBA,IAAjB;;CAEA,UAAI,KAAKyM,OAAL,EAAJ,EACA;CACC,aAAKxR,IAAL,CAAU,WAAV;CACA;CACD;CA1IF;CAAA;CAAA,oCA6IC;CACC;;CAEA,UAAI,KAAKwR,OAAL,EAAJ,EACA;CACC,aAAKxR,IAAL,CAAU,WAAV;CACA;CACD;CApJF;CAAA;CAAA,oCAuJC;CACC,WAAKA,IAAL,CAAU,aAAV;CACA;CAzJF;CAAA;CAAA,iCAsBqB2sB,WAtBrB,EAuBC;CACC,UAAM7B,OAAO,GAAG,IAAIsB,OAAJ,CAAYO,WAAZ,CAAhB;CAEA7B,MAAAA,OAAO,CAAC8B,SAAR,CAAkB9B,OAAlB;CACAA,MAAAA,OAAO,CAAC+B,QAAR,CAAiB/B,OAAjB;CACAA,MAAAA,OAAO,CAACgC,WAAR,CAAoBhC,OAApB;CACAA,MAAAA,OAAO,CAACiC,kBAAR,CAA2BjC,OAA3B;CACAA,MAAAA,OAAO,CAACkC,YAAR,CAAqBlC,OAArB;CAEA,aAAOA,OAAP;CACA;CAjCF;CAAA;CAAA,EAA6B9D,MAA7B;;;;;;;;;;;;;;ACZA,KAAaiG,OAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,4BAcSprB,IAdT,EAeC;CACC,WAAKA,IAAL,GAAYA,IAAZ;CACA;CAjBF;CAAA;CAAA,wCAoBC;CACC,aAAO,KAAKA,IAAL,CAAUqrB,cAAjB;CACA;CAtBF;CAAA;CAAA,wCAyBC;CACC,aAAO,KAAKrrB,IAAL,CAAUsrB,cAAjB;CACA;CA3BF;CAAA;CAAA,yCA8BC;CACC,aAAO,KAAKtrB,IAAL,CAAUurB,eAAjB;CACA;CAhCF;CAAA;CAAA,kCAKC;CACC,UAAI,iCAACH,OAAD,EANOA,OAMP,YAAJ,EACA;CACC,wCAAAA,OAAO,EARGA,OAQH,aAAa,IAAIA,OAAJ,EAAb,CAAP;CACA;;CAED,6CAAOA,OAAP,EAXWA,OAWX;CACA;CAZF;CAAA;CAAA;;;;;;;KCAaI,MAAb;CAAA;;CAEC,gBAAYC,MAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,MAAN;;CAEA,UAAKnuB,iBAAL,CAAuB,mCAAvB;;CAEA,UAAKmuB,MAAL,GAAcA,MAAd;CAEA,UAAK3nB,IAAL,GAAY,IAAZ;CAPD;CAQC;;CAXF;CAAA;CAAA,6BAcC;CACC,UAAI,KAAK2nB,MAAL,CAAYC,QAAZ,MAA0B,KAAKD,MAAL,CAAYhgB,WAAZ,EAA9B,EACA;CACC,eAAO,EAAP;CACA;;CAED,WAAK3H,IAAL,GAAYiC,aAAG,CAACC,MAAhB,wfAEmDwlB,IAAI,CAACG,qBAAL,CAA2B,KAAKF,MAAhC,CAFnD,EAIiDD,IAAI,CAACI,mBAAL,CAAyB,KAAKH,MAA9B,CAJjD,EAKiDxlB,cAAI,CAACC,MAAL,CAAY,KAAKulB,MAAL,CAAYI,qBAAZ,EAAZ,CALjD,EAM+C5lB,cAAI,CAACC,MAAL,CAAY,KAAKulB,MAAL,CAAYK,mBAAZ,EAAZ,CAN/C;CAUA,WAAKpuB,UAAL;CAEA,aAAO,KAAKoG,IAAZ;CACA;CAjCF;CAAA;CAAA,8BAoCC;CACC,aAAO,KAAKA,IAAZ;CACA;CAtCF;CAAA;CAAA,iCAyCC;CAAA;;CACC,UAAI,KAAK2nB,MAAL,CAAYC,QAAZ,MAA0B,KAAKD,MAAL,CAAYhgB,WAAZ,EAA9B,EACA;CACC;CACA;;CAED,UAAMsgB,WAAW,GAAG,KAAKjoB,IAAL,CAAUkoB,OAAV,CAAkB,eAAlB,CAApB;;CAEA,UAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;CACxBzuB,QAAAA,EAAE,CAAC0uB,QAAH,CAAY9N,GAAZ,GAAkB5V,KAAlB,CAAwB9J,KAAxB;CACA,OAFD;;CAIA,UAAMytB,YAAY,GAAG,SAAfA,YAAe,CAACroB,IAAD,EAAOsoB,KAAP,EAAiB;CACrC;CACA5uB,QAAAA,EAAE,CAAC0uB,QAAH,CAAY;CACXpoB,UAAAA,IAAI,EAAEA,IADK;CAEXsoB,UAAAA,KAAK,EAAEA,KAFI;CAGXC,UAAAA,KAAK,EAAE,KAHI;CAIXC,UAAAA,SAAS,EAAE,KAJA;CAKXC,UAAAA,SAAS,EAAE;CALA,SAAZ;CAOA;;CACA,YAAIR,WAAJ,EACA;CACCzlB,UAAAA,eAAK,CAACkmB,QAAN,CAAeT,WAAf,EAA4B,OAA5B,EAAqCE,UAArC;CACA;CACD,OAdD;;CAgBA,UAAMQ,cAAc,GAAG,SAAjBA,cAAiB,CAAC3oB,IAAD,EAAOK,KAAP,EAAiB;CACvC;CACAL,QAAAA,IAAI,CAACsK,WAAL,GAAmB5Q,EAAE,CAACkvB,IAAH,CAAQC,MAAR,CAClBvB,OAAO,CAACwB,WAAR,GAAsBC,iBAAtB,EADkB,EAElBC,IAAI,CAACC,KAAL,CAAWvvB,EAAE,CAACwvB,SAAH,CAAa7oB,KAAb,EAAoB8oB,OAApB,KAAgC,IAA3C,CAFkB,CAAnB;CAIA;CACA,OAPD;;CAQA,UAAMtsB,WAAW,GAAG,SAAdA,WAAc,CAACX,IAAD,EAAU;CAC7B,QAAA,MAAI,CAAC7B,IAAL,CAAU,sBAAV,EAAkC6B,IAAlC;CACA,OAFD;;CAIA,UAAMktB,aAAa,GAAG,KAAKppB,IAAL,CAAUC,aAAV,CAAwB,UAAxB,CAAtB;CACA,UAAMopB,WAAW,GAAG,KAAKrpB,IAAL,CAAUC,aAAV,CAAwB,QAAxB,CAApB;CACA,UAAMqpB,cAAc,GAAG,KAAKtpB,IAAL,CAAUC,aAAV,CAAwB,yBAAxB,CAAvB;CACA,UAAMspB,YAAY,GAAG,KAAKvpB,IAAL,CAAUC,aAAV,CAAwB,uBAAxB,CAArB;CAEAuC,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,UAACjG,KAAD,EAAW;CACzC,YAAMsQ,MAAM,GAAGtQ,KAAK,CAACsQ,MAArB;;CACA,YAAIA,MAAM,CAACmf,SAAP,CAAiBzjB,QAAjB,CAA0B,SAA1B,CAAJ,EACA;CACCsiB,UAAAA,YAAY,CAAChe,MAAD,EAASif,cAAT,CAAZ;CACA,SAHD,MAIK,IAAIjf,MAAM,CAACmf,SAAP,CAAiBzjB,QAAjB,CAA0B,OAA1B,CAAJ,EACL;CACCsiB,UAAAA,YAAY,CAAChe,MAAD,EAASkf,YAAT,CAAZ;CACA;;CACDxvB,QAAAA,KAAK,CAAC0vB,eAAN;CACA,OAXD;CAYAjnB,MAAAA,eAAK,CAAChE,IAAN,CAAW8qB,cAAX,EAA2B,QAA3B,EAAqC,UAACvvB,KAAD,EAAW;CAC/C,YAAMsG,KAAK,GAAGtG,KAAK,CAACsQ,MAAN,CAAahK,KAA3B;CACAsoB,QAAAA,cAAc,CAACS,aAAD,EAAgB/oB,KAAhB,CAAd;CACAxD,QAAAA,WAAW,CAAC;CACX6sB,UAAAA,QAAQ,EAAE,MAAI,CAAC/B,MAAL,CAAYxa,KAAZ,EADC;CAEXwc,UAAAA,SAAS,EAAEX,IAAI,CAACC,KAAL,CAAWvvB,EAAE,CAACwvB,SAAH,CAAa7oB,KAAb,EAAoB8oB,OAApB,KAAgC,IAA3C;CAFA,SAAD,CAAX;;CAIA,YAAIlB,WAAJ,EACA;CACCzlB,UAAAA,eAAK,CAAConB,MAAN,CAAa3B,WAAb,EAA0B,OAA1B,EAAmCE,UAAnC;CACA;CACD,OAXD;CAYA3lB,MAAAA,eAAK,CAAChE,IAAN,CAAW+qB,YAAX,EAAyB,QAAzB,EAAmC,UAACxvB,KAAD,EAAW;CAC7C,YAAMsG,KAAK,GAAGtG,KAAK,CAACsQ,MAAN,CAAahK,KAA3B;CACAsoB,QAAAA,cAAc,CAACU,WAAD,EAAchpB,KAAd,CAAd;CACAxD,QAAAA,WAAW,CAAC;CACX6sB,UAAAA,QAAQ,EAAE,MAAI,CAAC/B,MAAL,CAAYxa,KAAZ,EADC;CAEX0c,UAAAA,OAAO,EAAEb,IAAI,CAACC,KAAL,CAAWvvB,EAAE,CAACwvB,SAAH,CAAa7oB,KAAb,EAAoB8oB,OAApB,KAAgC,IAA3C;CAFE,SAAD,CAAX;;CAIA,YAAIlB,WAAJ,EACA;CACCzlB,UAAAA,eAAK,CAAConB,MAAN,CAAa3B,WAAb,EAA0B,OAA1B,EAAmCE,UAAnC;CACA;CACD,OAXD;CAYA;CA1HF;CAAA;CAAA,+BA6HC;CACC,UAAM2B,SAAS,GAAI5mB,QAAQ,CAAC,KAAKykB,MAAL,CAAYoC,wBAAZ,EAAD,EAAyC,EAAzC,CAAR,GAAuD,MAA1E;;CAEA,UAAID,SAAS,GAAG,CAAhB,EACA;CACC,eAAOA,SAAS,GAAG,GAAZ,GAAkBpsB,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAAzB;CACA,OAHD,MAIK,IAAImsB,SAAS,KAAK,CAAlB,EACL;CACC,eAAOA,SAAS,GAAG,GAAZ,GAAkBpsB,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAAzB;CACA,OAHI,MAKL;CACC,eAAOmsB,SAAS,GAAG,GAAZ,GAAkBpsB,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAAzB;CACA;CACD;CA5IF;CAAA;CAAA,gDA8IoCgqB,MA9IpC,EA+IC;CACC,aAAOD,IAAI,CAACG,qBAAL,CAA2BF,MAA3B,IAAqC,KAArC,GAA6CD,IAAI,CAACI,mBAAL,CAAyBH,MAAzB,CAApD;CACA;CAjJF;CAAA;CAAA,0CAmJ8BA,MAnJ9B,EAoJC;CACC;CACA,aAAOjuB,EAAE,CAACkvB,IAAH,CAAQC,MAAR,CAAevB,OAAO,CAACwB,WAAR,GAAsBC,iBAAtB,EAAf,EAA0DpB,MAAM,CAACqC,YAAP,EAA1D,EAAiF,IAAjF,EAAuF,IAAvF,CAAP;CACA;CACA;CAxJF;CAAA;CAAA,wCA0J4BrC,MA1J5B,EA2JC;CACC;CACA,aAAOjuB,EAAE,CAACkvB,IAAH,CAAQC,MAAR,CAAevB,OAAO,CAACwB,WAAR,GAAsBC,iBAAtB,EAAf,EAA0DpB,MAAM,CAACsC,UAAP,EAA1D,EAA+E,IAA/E,EAAqF,IAArF,CAAP;CACA;CACA;CA/JF;CAAA;CAAA,EAA0BpwB,6BAA1B;;KCNaqwB,eAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,wCAEqBC,KAFrB,EAEoCC,MAFpC,EAGC;CACC,UAAID,KAAK,KAAK,CAAd,EACA;CACC,eAAO,CAAP;CACA;;CAED,UAAIA,KAAK,KAAK,EAAd,EACA;CACC,eAAO,GAAP;CACA;;CAED,UAAM7T,MAAM,GAAG0S,IAAI,CAACqB,KAAL,CAAWD,MAAM,GAAG,GAAT,GAAeD,KAA1B,CAAf;CAEA,aAAQ/e,KAAK,CAACkL,MAAD,CAAL,GAAgB,CAAhB,GAAoBA,MAA5B;CACA;CAjBF;CAAA;CAAA;;;KCMagU,KAAb;CAAA;;CAEC,iBAAY3C,MAAZ,EACA;CAAA;;CAAA;CACC,uGAAMA,MAAN;;CAEA,UAAKnuB,iBAAL,CAAuB,6BAAvB;;CAEA,UAAK+wB,aAAL,CAAmB5C,MAAnB;;CAEA,UAAK6C,eAAL,GAAuB,IAAIN,eAAJ,EAAvB;CAEA,UAAKlqB,IAAL,GAAY,IAAZ;CAEA,UAAKyqB,UAAL,GAAkB,KAAlB;CAXD;CAYC;;CAfF;CAAA;CAAA,qCAkBC;CACC,WAAKA,UAAL,GAAkB,IAAlB;CACA;CApBF;CAAA;CAAA,mCAuBC;CACC,aAAO,KAAKA,UAAZ;CACA;CAzBF;CAAA;CAAA,6BA4BC;CACC,WAAKzqB,IAAL,GAAYiC,aAAG,CAACC,MAAhB;CAEA,aAAO,KAAKlC,IAAZ;CACA;CAhCF;CAAA;CAAA,kCAkCe2nB,MAlCf,EAmCC;CACC,WAAKA,MAAL,GAAcA,MAAd;CAEA,WAAK1T,cAAL,CAAoB0T,MAAM,CAAC3T,cAAP,GAAwBpI,SAAxB,EAApB;CACA,WAAK8e,uBAAL,CAA6B/C,MAAM,CAACgD,uBAAP,GAAiC/e,SAAjC,EAA7B;CACA,WAAKgf,yBAAL,CAA+BjD,MAAM,CAACkD,yBAAP,GAAmCjf,SAAnC,EAA/B;CACA,WAAKkf,UAAL,CAAgBnD,MAAM,CAACsC,UAAP,EAAhB;CAEA,WAAKc,eAAL,GAAuBpD,MAAM,CAACqD,kBAAP,EAAvB;;CAEA,UAAI,KAAKhrB,IAAT,EACA;CACCG,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKrH,IAAjB,EAAuB,KAAKkC,MAAL,EAAvB;CACA;CACD;CAjDF;CAAA;CAAA,mCAmDgBgJ,WAnDhB,EAoDC;CACC,UAAIlO,cAAI,CAACC,WAAL,CAAiBiO,WAAjB,KAAiCE,KAAK,CAACC,UAAU,CAACH,WAAD,CAAX,CAA1C,EACA;CACC,aAAKA,WAAL,GAAmB,CAAnB;CACA,OAHD,MAKA;CACC,aAAKA,WAAL,GAAmBG,UAAU,CAACH,WAAD,CAA7B;CACA;CACD;CA7DF;CAAA;CAAA,qCAgEC;CACC,aAAO,KAAKA,WAAZ;CACA;CAlEF;CAAA;CAAA,4CAoEyBA,WApEzB,EAqEC;CACC,UAAIlO,cAAI,CAACC,WAAL,CAAiBiO,WAAjB,KAAiCE,KAAK,CAACC,UAAU,CAACH,WAAD,CAAX,CAA1C,EACA;CACC,aAAK+f,oBAAL,GAA4B,CAA5B;CACA,OAHD,MAKA;CACC,aAAKA,oBAAL,GAA4B5f,UAAU,CAACH,WAAD,CAAtC;CACA;CACD;CA9EF;CAAA;CAAA,8CAiFC;CACC,aAAO,KAAK+f,oBAAZ;CACA;CAnFF;CAAA;CAAA,8CAqF2B/f,WArF3B,EAsFC;CACC,UAAIlO,cAAI,CAACC,WAAL,CAAiBiO,WAAjB,KAAiCE,KAAK,CAACC,UAAU,CAACH,WAAD,CAAX,CAA1C,EACA;CACC,aAAKggB,sBAAL,GAA8B,CAA9B;CACA,OAHD,MAKA;CACC,aAAKA,sBAAL,GAA8B7f,UAAU,CAACH,WAAD,CAAxC;CACA;CACD;CA/FF;CAAA;CAAA,gDAkGC;CACC,aAAO,KAAK+f,oBAAZ;CACA;CApGF;CAAA;CAAA,+BAsGYE,OAtGZ,EAuGC;CACC,UAAInuB,cAAI,CAACC,WAAL,CAAiBkuB,OAAjB,KAA6B/f,KAAK,CAAClI,QAAQ,CAACioB,OAAD,EAAU,EAAV,CAAT,CAAtC,EACA;CACC,aAAKA,OAAL,GAAgBzD,IAAI,CAAC0D,GAAL,KAAa,IAA7B;CACA,OAHD,MAKA;CACC,aAAKD,OAAL,GAAejoB,QAAQ,CAACioB,OAAD,EAAU,EAAV,CAAvB;CACA;CACD;CAhHF;CAAA;CAAA,iCAmHC;CACC,aAAO,KAAKA,OAAZ;CACA;CArHF;CAAA;CAAA,EAA2BtxB,6BAA3B;;;KCAawxB,cAAb;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,6BAGC;CACC,UAAMC,UAAU,GAAG,KAAKd,eAAL,CAAqBe,mBAArB,CAClB,KAAKvX,cAAL,EADkB,EAElB,KAAK2W,uBAAL,EAFkB,CAAnB;CAKA,UAAMa,aAAa,GAAG,KAAKC,gBAAL,CAAsB,KAAKC,UAAL,EAAtB,CAAtB;CAEA,UAAMzR,KAAK,GAAGvc,aAAG,CAACC,UAAJ,CAAe,0CAAf,EACZ0J,OADY,CACJ,WADI,EACSikB,UADT,EAEZjkB,OAFY,CAEJ,QAFI,EAEMmkB,aAFN,CAAd;CAKA,UAAM/tB,KAAK,GAAGkuB,MAAU,CAACC,2BAAX,CAAuC,KAAKjE,MAA5C,CAAd;CAEA,WAAK3nB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,oJACezE,KADf,EAEIwc,KAFJ;CAMA,aAAO,KAAKja,IAAZ;CACA;CAzBF;CAAA;CAAA,qCA2BkBmrB,OA3BlB,EA4BC;CACC,aAAOzxB,EAAE,CAACkvB,IAAH,CAAQC,MAAR,CAAevB,OAAO,CAACwB,WAAR,GAAsB+C,iBAAtB,EAAf,EAA0DV,OAA1D,CAAP;CACA;CA9BF;CAAA;CAAA,EAAoCb,KAApC;;;KCAawB,YAAb;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,6BAGC;CACC,UAAMR,UAAU,GAAG,KAAKd,eAAL,CAAqBe,mBAArB,CAClB,KAAKvX,cAAL,EADkB,EAElB,KAAK2W,uBAAL,EAFkB,CAAnB;CAIA,UAAMoB,UAAU,GAAG,KAAKC,aAAL,CAAmB,KAAKN,UAAL,EAAnB,CAAnB;CAEA,UAAMzR,KAAK,GAAGvc,aAAG,CAACC,UAAJ,CAAe,wCAAf,EACZ0J,OADY,CACJ,WADI,EACSikB,UADT,EAEZjkB,OAFY,CAEJ,QAFI,EAEM0kB,UAFN,CAAd;CAKA,UAAMtuB,KAAK,GAAGkuB,MAAU,CAACC,2BAAX,CAAuC,KAAKjE,MAA5C,CAAd;CAEA,WAAK3nB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,oJACezE,KADf,EAEIwc,KAFJ;CAMA,aAAO,KAAKja,IAAZ;CACA;CAxBF;CAAA;CAAA,kCA0BemrB,OA1Bf,EA2BC;CACC,aAAOzxB,EAAE,CAACkvB,IAAH,CAAQC,MAAR,CAAevB,OAAO,CAACwB,WAAR,GAAsB+C,iBAAtB,EAAf,EAA0DV,OAA1D,CAAP;CACA;CA7BF;CAAA;CAAA,EAAkCb,KAAlC;;;KCDa2B,WAAb;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,6BAGC;CACC,UAAMC,aAAa,GAAG,KAAKC,gBAAL,CAAsB,KAAKT,UAAL,EAAtB,CAAtB;CACA,UAAMJ,UAAU,GAAG,KAAKd,eAAL,CAAqBe,mBAArB,CAClB,KAAKvX,cAAL,EADkB,EAElB,KAAK2W,uBAAL,EAFkB,CAAnB;CAKA,UAAI1Q,KAAK,GAAG,EAAZ;;CACA,UAAIjd,cAAI,CAACuL,SAAL,CAAe2jB,aAAf,KAAiCA,aAAa,IAAI,CAAtD,EACA;CACCjS,QAAAA,KAAK,GAAGvc,aAAG,CAACC,UAAJ,CAAe,4CAAf,EACN0J,OADM,CACE,WADF,EACeikB,UADf,CAAR;CAGA,OALD,MAOA;CACCrR,QAAAA,KAAK,GAAGvc,aAAG,CAACC,UAAJ,CAAe,uCAAf,EACN0J,OADM,CACE,QADF,EACY6kB,aADZ,EAEN7kB,OAFM,CAEE,WAFF,EAEeikB,UAFf,CAAR;CAIA;;CAED,UAAM7tB,KAAK,GAAGkuB,MAAU,CAACC,2BAAX,CAAuC,KAAKjE,MAA5C,CAAd;CAEA,WAAK3nB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,oJACezE,KADf,EAEIwc,KAFJ;CAMA,aAAO,KAAKja,IAAZ;CACA;CAlCF;CAAA;CAAA,qCAoCkBmrB,OApClB,EAqCC;CACC,UAAMiB,qBAAqB,GAAG,IAAI1E,IAAJ,EAA9B;CACA0E,MAAAA,qBAAqB,CAACC,UAAtB,CAAiCD,qBAAqB,CAACE,UAAtB,KAAqC,KAAKvB,eAA3E;CACAqB,MAAAA,qBAAqB,CAACG,QAAtB,CAA+B,CAA/B,EAAkC,CAAlC,EAAqC,CAArC,EAAwC,CAAxC;CAEA,UAAM1C,OAAO,GAAG,IAAInC,IAAJ,CAASyD,OAAO,GAAG,IAAnB,CAAhB;CAEA,UAAMqB,WAAW,GAAG,KAAK,IAAzB;CACA,UAAMC,SAAS,GAAGD,WAAW,GAAG,EAAhC;CACA,UAAME,QAAQ,GAAGD,SAAS,GAAG,EAA7B;CAEA,UAAME,aAAa,GAAG3D,IAAI,CAACqB,KAAL,CAAW,CAACR,OAAO,GAAGuC,qBAAX,IAAoCM,QAA/C,CAAtB;;CAEA,UAAIC,aAAa,IAAI,CAArB,EACA;CACC,eAAOA,aAAP;CACA,OAHD,MAKA;CACC,eAAOjzB,EAAE,CAACkvB,IAAH,CAAQC,MAAR,CAAe,OAAf,EAAwBuD,qBAAxB,EAA+CvC,OAA/C,CAAP;CACA;CACD;CA1DF;CAAA;CAAA,EAAiCS,KAAjC;;KCEasC,YAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,0BAEcjF,MAFd,EAGC;CACC,UAAIA,MAAM,CAAChgB,WAAP,EAAJ,EACA;CACC,eAAO,IAAI0jB,cAAJ,CAAmB1D,MAAnB,CAAP;CACA,OAHD,MAIK,IAAIA,MAAM,CAACkF,SAAP,EAAJ,EACL;CACC,eAAO,IAAIf,YAAJ,CAAiBnE,MAAjB,CAAP;CACA,OAHI,MAIA,IAAIA,MAAM,CAACC,QAAP,EAAJ,EACL;CACC,eAAO,IAAIqE,WAAJ,CAAgBtE,MAAhB,CAAP;CACA,OAHI,MAKL;CACC,eAAO,IAAI2C,KAAJ,CAAU3C,MAAV,CAAP;CACA;CACD;CApBF;CAAA;CAAA;;;KCDa2C,OAAb;CAAA;;CAEC,iBAAY3C,MAAZ,EACA;CAAA;;CAAA;CACC,uGAAMA,MAAN;;CAEA,UAAKnuB,iBAAL,CAAuB,oCAAvB;;CAEA,UAAKmuB,MAAL,GAAcA,MAAd;CAEA,UAAK3nB,IAAL,GAAY,IAAZ;CAPD;CAQC;;CAXF;CAAA;CAAA,6BAcC;CACC,UAAM8sB,KAAK,GAAGF,YAAY,CAACG,KAAb,CAAmB,KAAKpF,MAAxB,CAAd;CAEA,WAAK3nB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,kLAEI4qB,KAAK,CAAC5qB,MAAN,EAFJ;CAMA,aAAO,KAAKlC,IAAZ;CACA;CAxBF;CAAA;CAAA,8BA2BC;CACC,aAAO,KAAKA,IAAZ;CACA;CA7BF;CAAA;CAAA,EAA2BnG,6BAA3B;;;KCGayN,MAAb;CAAA;;CAEC,gBAAYqgB,MAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,MAAN;;CAEA,UAAKnuB,iBAAL,CAAuB,mCAAvB;;CAEA,UAAKmuB,MAAL,GAAcA,MAAd;CAEA,UAAKiB,IAAL,GAAY,IAAZ;CACA,UAAKkE,KAAL,GAAa,IAAb;CAEA,UAAK9sB,IAAL,GAAY,IAAZ;CAVD;CAWC;;CAdF;CAAA;CAAA,4BAgBS2nB,MAhBT,EAiBC;CAAA;;CACC,UAAMiB,IAAI,GAAG,IAAIlB,MAAJ,CAASC,MAAT,CAAb;;CAEA,UAAI,KAAKiB,IAAT,EACA;CACCzoB,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKuhB,IAAL,CAAU7b,OAAV,EAAZ,EAAiC6b,IAAI,CAAC1mB,MAAL,EAAjC;CACA;;CAED,WAAK0mB,IAAL,GAAYA,IAAZ;CAEA,WAAKA,IAAL,CAAU9uB,SAAV,CAAoB,sBAApB,EAA4C,UAACwJ,SAAD,EAAe;CAC1D,QAAA,MAAI,CAACjJ,IAAL,CAAU,sBAAV,EAAkCiJ,SAAS,CAAC4N,OAAV,EAAlC;CACA,OAFD;CAGA;CA9BF;CAAA;CAAA,8BAiCC;CACC,aAAO,KAAK0X,IAAZ;CACA;CAnCF;CAAA;CAAA,6BAqCUjB,MArCV,EAsCC;CACC,UAAMmF,KAAK,GAAG,IAAIxC,OAAJ,CAAU3C,MAAV,CAAd;;CAEA,UAAI,KAAKmF,KAAT,EACA;CACC3sB,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKylB,KAAL,CAAW/f,OAAX,EAAZ,EAAkC+f,KAAK,CAAC5qB,MAAN,EAAlC;CACA;;CAED,WAAK4qB,KAAL,GAAaA,KAAb;CACA;CA/CF;CAAA;CAAA,6BAkDC;CAAA;;CACC,WAAK9sB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,iSAEI,KAAK8qB,eAAL,EAFJ,EAIK7qB,cAAI,CAACC,MAAL,CAAY,KAAKulB,MAAL,CAAY5U,OAAZ,EAAZ,CAJL,EAMI,KAAKka,UAAL,EANJ,EAOI,KAAKC,YAAL,EAPJ,EAQI,KAAKtE,IAAL,GAAY,KAAKA,IAAL,CAAU1mB,MAAV,EAAZ,GAAiC,EARrC,EASI,KAAK4qB,KAAL,GAAa,KAAKA,KAAL,CAAW5qB,MAAX,EAAb,GAAmC,EATvC;CAYA,UAAMirB,SAAS,GAAG,KAAKntB,IAAL,CAAUC,aAAV,CAAwB,qBAAxB,CAAlB;CACA,UAAMmtB,QAAQ,GAAG,KAAKptB,IAAL,CAAUC,aAAV,CAAwB,4BAAxB,CAAjB;CAEAuC,MAAAA,eAAK,CAAChE,IAAN,CAAW2uB,SAAX,EAAsB,OAAtB,EAA+B,YAAM;CACpC,QAAA,MAAI,CAAC9yB,IAAL,CAAU,WAAV,EAAuB,MAAI,CAAC2F,IAAL,CAAUC,aAAV,CAAwB,mCAAxB,CAAvB;CACA,OAFD;CAGAuC,MAAAA,eAAK,CAAChE,IAAN,CAAW4uB,QAAX,EAAqB,OAArB,EAA8B,YAAM;CACnC,QAAA,MAAI,CAAC/yB,IAAL,CAAU,WAAV,EAAuB,MAAI,CAAC2F,IAAL,CAAUC,aAAV,CAAwB,mCAAxB,CAAvB;CACA,OAFD;;CAIA,UAAI,KAAK0nB,MAAL,CAAY0F,SAAZ,EAAJ,EACA;CACC,YAAMC,UAAU,GAAG,KAAKttB,IAAL,CAAUC,aAAV,CAAwB,8BAAxB,CAAnB;CAEAuC,QAAAA,eAAK,CAAChE,IAAN,CAAW8uB,UAAX,EAAuB,OAAvB,EAAgC,YAAM;CACrC,cAAI,MAAI,CAAC3F,MAAL,CAAY9b,OAAZ,EAAJ,EACA;CACC,YAAA,MAAI,CAACxR,IAAL,CAAU,cAAV;CACA,WAHD,MAKA;CACCuD,YAAAA,gCAAU,CAAC2vB,OAAX,CACC7vB,aAAG,CAACC,UAAJ,CAAe,wCAAf,CADD,EAEC,UAAC6vB,UAAD,EAAgB;CACf,cAAA,MAAI,CAACnzB,IAAL,CAAU,cAAV;;CACAmzB,cAAAA,UAAU,CAAC5yB,KAAX;CACA,aALF,EAMC8C,aAAG,CAACC,UAAJ,CAAe,gCAAf,CAND;CAQA;CACD,SAhBD;CAiBA;;CAED,aAAO,KAAKqC,IAAZ;CACA;CAjGF;CAAA;CAAA,8BAoGC;CACC,aAAO,KAAKA,IAAZ;CACA;CAtGF;CAAA;CAAA,sCAyGC;CACC,UAAMyI,SAAS,GAAG,oEAAlB;CAEA,aAAOxG,aAAG,CAACC,MAAX,sTAC0CuG,SAD1C,EAKYtG,cAAI,CAACC,MAAL,CAAY,KAAKulB,MAAL,CAAY5U,OAAZ,EAAZ,CALZ;CASA;CArHF;CAAA;CAAA,iCAwHC;CACC,UAAI,CAAC,KAAK4U,MAAL,CAAYhgB,WAAZ,EAAL,EACA;CACC,eAAO1F,aAAG,CAACC,MAAX;CACA,OAHD,MAKA;CACC,eAAO,EAAP;CACA;CACD;CAjIF;CAAA;CAAA,mCAoIC;CACC,UAAI,KAAKylB,MAAL,CAAY0F,SAAZ,EAAJ,EACA;CACC,eAAOprB,aAAG,CAACC,MAAX;CACA,OAHD,MAKA;CACC,eAAO,EAAP;CACA;CACD;CA7IF;CAAA;CAAA,EAA0BrI,6BAA1B;;;KCJa4zB,SAAb;CAAA;;CAEC,qBAAY9F,MAAZ,EACA;CAAA;;CAAA;CACC,2GAAMA,MAAN;;CAEA,UAAKnuB,iBAAL,CAAuB,6CAAvB;;CAEA,UAAKmuB,MAAL,GAAcA,MAAd;CAEA,UAAK3nB,IAAL,GAAY,IAAZ;CAPD;CAQC;;CAXF;CAAA;CAAA,6BAcC;CACC,UAAM0tB,aAAa,GAAG,4CAAtB;CAEA,WAAK1tB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,wPAE0DwrB,aAF1D;CAMAlrB,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;CAEA,aAAO,KAAKwB,IAAZ;CACA;CA1BF;CAAA;CAAA,8BA6BC;CACC,WAAK3F,IAAL,CAAU,OAAV;CACA;CA/BF;CAAA;CAAA,EAA+BR,6BAA/B;;;KCEa8zB,QAAb;CAAA;;CAEC,oBAAYhG,MAAZ,EACA;CAAA;;CAAA;CACC,0GAAMA,MAAN;;CAEA,UAAKnuB,iBAAL,CAAuB,4CAAvB;;CAEA,UAAKmuB,MAAL,GAAcA,MAAd;CAEA,UAAK3nB,IAAL,GAAY,IAAZ;CAPD;CAQC;;CAXF;CAAA;CAAA,6BAcC;CACC,WAAKA,IAAL,GAAYiC,aAAG,CAACC,MAAhB,o1BAIMxE,aAAG,CAACC,UAAJ,CAAe,wBAAf,CAJN,EAQiBD,aAAG,CAACC,UAAJ,CAAe,wBAAf,CARjB,EAUMuF,QAAQ,CAAC,KAAKykB,MAAL,CAAYhC,cAAZ,EAAD,EAA+B,EAA/B,CAVd,EAeMjoB,aAAG,CAACC,UAAJ,CAAe,wCAAf,CAfN,EAmBiBD,aAAG,CAACC,UAAJ,CAAe,wCAAf,CAnBjB,EAqBM,KAAKgqB,MAAL,CAAY3T,cAAZ,GAA6BnI,OAA7B,KAAyC,GAAzC,GAA+C,KAAK8b,MAAL,CAAY3T,cAAZ,GAA6BpI,SAA7B,EArBrD,EAuBK,KAAKgiB,8BAAL,EAvBL;CA4BAl0B,MAAAA,EAAE,CAACslB,EAAH,CAAM6O,IAAN,CAAWC,cAAX,CAA0B;CACzBC,QAAAA,eAAe,EAAE;CAChBhpB,UAAAA,UAAU,EAAE,IADI;CAEhBD,UAAAA,QAAQ,EAAE,IAFM;CAGhBkpB,UAAAA,SAAS,EAAE;CAHK;CADQ,OAA1B,EAMGC,IANH,CAMQ,KAAKjuB,IANb;CAQA,aAAO,KAAKA,IAAZ;CACA;CApDF;CAAA;CAAA,qDAuDC;CACC,UACC,CAAC,KAAK2nB,MAAL,CAAY0F,SAAZ,EAAD,IACG,CAAC,KAAK1F,MAAL,CAAYuG,2BAAZ,EAFL,EAIA;CACC,eAAO,EAAP;CACA;;CAED,aAAOjsB,aAAG,CAACC,MAAX,wPAGexE,aAAG,CAACC,UAAJ,CAAe,yCAAf,CAHf,EAKI,KAAKgqB,MAAL,CAAYuG,2BAAZ,EALJ;CAQA;CAxEF;CAAA;CAAA,EAA8Br0B,6BAA9B;;;KCFas0B,MAAb;CAAA;;CAEC,kBAAYxG,MAAZ,EACA;CAAA;;CAAA;CACC,wGAAMA,MAAN;;CAEA,UAAKnuB,iBAAL,CAAuB,0CAAvB;;CAEA,UAAKmuB,MAAL,GAAcA,MAAd;CAEA,UAAK3nB,IAAL,GAAY,IAAZ;CAPD;CAQC;;CAXF;CAAA;CAAA,6BAcC;CACC,UAAMouB,WAAW,GAAG,4DAApB;CAEA,WAAKpuB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,iKAC+CksB,WAD/C;CAIA5rB,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;CAEA,aAAO,KAAKwB,IAAZ;CACA;CAxBF;CAAA;CAAA,8BA2BC;CACC,aAAO,KAAKA,IAAZ;CACA;CA7BF;CAAA;CAAA,8BAgCC;CACC,WAAK3F,IAAL,CAAU,OAAV;CACA;CAlCF;CAAA;CAAA,EAA4BR,6BAA5B;;;KCIaw0B,IAAb;CAAA;;CAEC,gBAAY1G,MAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,MAAN;;CAEA,UAAKnuB,iBAAL,CAAuB,mCAAvB;;CAEA,UAAKmuB,MAAL,GAAcA,MAAd;CAEA,UAAK3nB,IAAL,GAAY,IAAZ;CAEA,UAAKsuB,SAAL,GAAiB,IAAIb,SAAJ,CAAc9F,MAAd,CAAjB;CACA,UAAK4G,QAAL,GAAgB,IAAIZ,QAAJ,CAAahG,MAAb,CAAhB;CACA,UAAK6G,MAAL,GAAc,IAAIL,MAAJ,CAAWxG,MAAX,CAAd;CAXD;CAYC;;CAfF;CAAA;CAAA,6BAkBC;CAAA;;CACC,WAAK3nB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,qMAEI,KAAKosB,SAAL,CAAepsB,MAAf,EAFJ,EAGI,KAAKqsB,QAAL,CAAcrsB,MAAd,EAHJ,EAII,KAAKssB,MAAL,CAAYtsB,MAAZ,EAJJ;CAQA,WAAKosB,SAAL,CAAex0B,SAAf,CAAyB,OAAzB,EAAkC;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,mBAAV,CAAN;CAAA,OAAlC;CACA,WAAKm0B,MAAL,CAAY10B,SAAZ,CACC,OADD,EAEC,UAACwJ,SAAD;CAAA,eAA0B,MAAI,CAACjJ,IAAL,CAAU,gBAAV,EAA4BiJ,SAAS,CAAC+V,SAAV,EAA5B,CAA1B;CAAA,OAFD;CAKA,aAAO,KAAKrZ,IAAZ;CACA;CAlCF;CAAA;CAAA,8BAqCC;CACC,aAAO,KAAKA,IAAZ;CACA;CAvCF;CAAA;CAAA,8BA0CC;CACC,WAAK3F,IAAL,CAAU,OAAV;CACA;CA5CF;CAAA;CAAA,EAA0BR,6BAA1B;;;KCJas0B,QAAb;CAAA;;CAEC,kBAAYxG,MAAZ,EACA;CAAA;;CAAA;CACC,wGAAMA,MAAN;;CAEA,UAAKnuB,iBAAL,CAAuB,qCAAvB;;CAEA,UAAKmuB,MAAL,GAAcA,MAAd;CAEA,UAAK9gB,QAAL,GAAgB,KAAhB;CAEA,UAAK7G,IAAL,GAAY,IAAZ;CATD;CAUC;;CAbF;CAAA;CAAA,6BAgBC;CACC,UAAI,KAAK2nB,MAAL,CAAYhgB,WAAZ,EAAJ,EACA;CACC,eAAO,KAAK3H,IAAZ;CACA;;CAED,UAAMyuB,cAAc,GAAI,KAAKC,cAAL,KAAwB,iBAAxB,GAA4C,EAApE;CAEA,WAAK1uB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,wRAEwC,KAAKysB,YAAL,EAFxC,EAE+DF,cAF/D,EAGW,KAAKG,aAAL,EAHX,EAKoD,KAAKA,aAAL,EALpD;CASApsB,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;CAEA,aAAO,KAAKwB,IAAZ;CACA;CApCF;CAAA;CAAA,8BAuCC;CACC,aAAO,KAAKA,IAAZ;CACA;CAzCF;CAAA;CAAA,8BA4CC;CACC,UAAI,KAAK6G,QAAL,IAAiB,KAAK6nB,cAAL,EAArB,EACA;CACC;CACA;;CAED,WAAKr0B,IAAL,CAAU,OAAV;CACA;CAnDF;CAAA;CAAA,mCAsDC;CACC,aAAO,6DAAP;CACA;CAxDF;CAAA;CAAA,oCA2DC;CACC,aAAOqD,aAAG,CAACC,UAAJ,CAAe,sCAAsC,KAAKgqB,MAAL,CAAYkH,SAAZ,GAAwBC,WAAxB,EAArD,CAAP;CACA;CA7DF;CAAA;CAAA,8BAgEC;CACC,WAAKjoB,QAAL,GAAgB,IAAhB;;CAEA,UAAI,KAAK7G,IAAT,EACA;CACCG,QAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKnI,IAAlB,EAAwB,iBAAxB;CACA;CACD;CAvEF;CAAA;CAAA,gCA0EC;CACC,WAAK6G,QAAL,GAAgB,KAAhB;;CAEA,UAAI,KAAK7G,IAAL,IAAa,CAAC,KAAK0uB,cAAL,EAAlB,EACA;CACCvuB,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKpI,IAArB,EAA2B,iBAA3B;CACA;CACD;CAjFF;CAAA;CAAA,qCAoFC;CACC,aACC,KAAK2nB,MAAL,CAAYC,QAAZ,MAA0B,CAAC,KAAKD,MAAL,CAAYoH,WAAZ,EAA3B,IACG,KAAKpH,MAAL,CAAY0F,SAAZ,MAA2B,CAAC,KAAK1F,MAAL,CAAYqH,QAAZ,EAFhC;CAIA;CAzFF;CAAA;CAAA,EAA4Bn1B,6BAA5B;;;KCAao1B,IAAb;CAAA;;CAEC,gBAAYtH,MAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,MAAN;;CAEA,UAAKnuB,iBAAL,CAAuB,mCAAvB;;CAEA,UAAKmuB,MAAL,GAAcA,MAAd;CAEA,UAAK3nB,IAAL,GAAY,IAAZ;CAPD;CAQC;;CAXF;CAAA;CAAA,6BAcC;CAEC,WAAKA,IAAL,GAAYiC,aAAG,CAACC,MAAhB;CAIAM,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,OAAtB,EAA+B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA/B;;CAEA,UAAI,KAAKmpB,MAAL,CAAYhgB,WAAZ,EAAJ,EACA;CACCxH,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKpI,IAArB,EAA2B,MAA3B;CACA;;CAED,aAAO,KAAKA,IAAZ;CACA;CA5BF;CAAA;CAAA,8BA+BC;CACC,WAAK3F,IAAL,CAAU,OAAV;CACA;CAjCF;CAAA;CAAA,6BAoCC;CACC,UAAI,CAAC,KAAK2F,IAAV,EACA;CACC;CACA;;CAEDG,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKnI,IAAlB,EAAwB,MAAxB;CACA;CA3CF;CAAA;CAAA,+BA8CC;CACC,UAAI,CAAC,KAAKA,IAAV,EACA;CACC;CACA;;CAEDG,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKpI,IAArB,EAA2B,MAA3B;CACA;CArDF;CAAA;CAAA,EAA0BnG,6BAA1B;;;KCMaqrB,QAAb;CAAA;;CAEC,kBAAYyC,MAAZ,EACA;CAAA;;CAAA;CACC,wGAAMA,MAAN;;CAEA,UAAKnuB,iBAAL,CAAuB,8BAAvB;;CAEA,UAAKmuB,MAAL,GAAcA,MAAd;CAEA,UAAK3nB,IAAL,GAAY,IAAZ;CAEA,UAAK9E,IAAL,GAAY,IAAZ;CACA,UAAK4xB,KAAL,GAAa,IAAb;CACA,UAAKtd,IAAL,GAAY,IAAZ;CACA,UAAKgf,MAAL,GAAc,IAAd;CACA,UAAKU,IAAL,GAAY,IAAZ;CAbD;CAcC;;CAjBF;CAAA;CAAA,4BAwCSvH,MAxCT,EAyCC;CAAA;;CACC,UAAMzsB,IAAI,GAAG,IAAIoM,MAAJ,CAASqgB,MAAT,CAAb;;CAEA,UAAIA,MAAM,CAAC0F,SAAP,EAAJ,EACA;CACCnyB,QAAAA,IAAI,CAACi0B,OAAL,CAAaxH,MAAb;CACA;;CAED,UAAIA,MAAM,CAACC,QAAP,EAAJ,EACA;CACC1sB,QAAAA,IAAI,CAAC2oB,QAAL,CAAc8D,MAAd;CACA;;CAED,UAAI,KAAKzsB,IAAT,EACA;CACCiF,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKnM,IAAL,CAAU6R,OAAV,EAAZ,EAAiC7R,IAAI,CAACgH,MAAL,EAAjC;CACA;;CAED,WAAKhH,IAAL,GAAYA,IAAZ;CAEA,WAAKA,IAAL,CAAUpB,SAAV,CAAoB,WAApB,EAAiC,UAACwJ,SAAD,EAAe;CAC/C,QAAA,MAAI,CAACjJ,IAAL,CAAU,YAAV,EAAwBiJ,SAAS,CAAC4N,OAAV,EAAxB;CACA,OAFD;CAGA,WAAKhW,IAAL,CAAUpB,SAAV,CAAoB,cAApB,EAAoC;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,cAAV,CAAN;CAAA,OAApC;CACA,WAAKa,IAAL,CAAUpB,SAAV,CAAoB,sBAApB,EAA4C,UAACwJ,SAAD,EAAe;CAC1D,QAAA,MAAI,CAACjJ,IAAL,CAAU,sBAAV,EAAkCiJ,SAAS,CAAC4N,OAAV,EAAlC;CACA,OAFD;CAGA;CApEF;CAAA;CAAA,8BAuEC;CACC,aAAO,KAAKhW,IAAZ;CACA;CAzEF;CAAA;CAAA,6BA2EUysB,MA3EV,EA4EC;CACC,UAAI,CAACA,MAAM,CAAChgB,WAAP,EAAL,EACA;CACC;CACA;;CAED,UAAMmlB,KAAK,GAAG,IAAIxC,OAAJ,CAAU3C,MAAV,CAAd;;CAEA,UAAI,KAAKmF,KAAT,EACA;CACC3sB,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKylB,KAAL,CAAW/f,OAAX,EAAZ,EAAkC+f,KAAK,CAAC5qB,MAAN,EAAlC;CACA;;CAED,WAAK4qB,KAAL,GAAaA,KAAb;CACA;CA1FF;CAAA;CAAA,4BA4FSnF,MA5FT,EA6FC;CAAA;;CACC,UAAMnY,IAAI,GAAG,IAAI6e,IAAJ,CAAS1G,MAAT,CAAb;;CAEA,UAAI,KAAKnY,IAAT,EACA;CACCrP,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKmI,IAAL,CAAUzC,OAAV,EAAZ,EAAiCyC,IAAI,CAACtN,MAAL,EAAjC;CACA;;CAED,WAAKsN,IAAL,GAAYA,IAAZ;CAEA,WAAKA,IAAL,CAAU1V,SAAV,CAAoB,mBAApB,EAAyC;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,mBAAV,CAAN;CAAA,OAAzC;CACA,WAAKmV,IAAL,CAAU1V,SAAV,CACC,gBADD,EAEC,UAACwJ,SAAD;CAAA,eAA0B,MAAI,CAACjJ,IAAL,CAAU,gBAAV,EAA4BiJ,SAAS,CAAC4N,OAAV,EAA5B,CAA1B;CAAA,OAFD;CAIA;CA5GF;CAAA;CAAA,8BA8GWyW,MA9GX,EA+GC;CAAA;;CACC,UAAM6G,MAAM,GAAG,IAAIL,QAAJ,CAAWxG,MAAX,CAAf;;CAEA,UAAI,KAAK6G,MAAT,EACA;CACCruB,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKmnB,MAAL,CAAYzhB,OAAZ,EAAZ,EAAmCyhB,MAAM,CAACtsB,MAAP,EAAnC;CACA;;CAED,WAAKssB,MAAL,GAAcA,MAAd;CAEA,WAAKA,MAAL,CAAY10B,SAAZ,CAAsB,OAAtB,EAA+B,YAAM;CACpC,YAAI,MAAI,CAAC6tB,MAAL,CAAYC,QAAZ,EAAJ,EACA;CACC,UAAA,MAAI,CAACvtB,IAAL,CAAU,gBAAV;CACA,SAHD,MAIK,IAAI,MAAI,CAACstB,MAAL,CAAY0F,SAAZ,EAAJ,EACL;CACC,UAAA,MAAI,CAAChzB,IAAL,CAAU,aAAV;CACA;CACD,OATD;CAUA;CAnIF;CAAA;CAAA,4BAqISstB,MArIT,EAsIC;CAAA;;CACC,WAAKuH,IAAL,GAAY,IAAID,IAAJ,CAAStH,MAAT,CAAZ;CAEA,WAAKuH,IAAL,CAAUp1B,SAAV,CAAoB,OAApB,EAA6B,YAAM;CAClC,QAAA,MAAI,CAACO,IAAL,CAAU,yBAAV;CACA,OAFD;CAGA;CA5IF;CAAA;CAAA,6BA+IC;CACC,WAAK2F,IAAL,GAAYiC,aAAG,CAACC,MAAhB,wOAC2C,KAAKktB,cAAL,EAD3C,EAEI,KAAKl0B,IAAL,GAAY,KAAKA,IAAL,CAAUgH,MAAV,EAAZ,GAAiC,EAFrC,EAGI,KAAK4qB,KAAL,GAAa,KAAKA,KAAL,CAAW5qB,MAAX,EAAb,GAAmC,EAHvC,EAII,KAAKsN,IAAL,GAAY,KAAKA,IAAL,CAAUtN,MAAV,EAAZ,GAAiC,EAJrC,EAKI,KAAKssB,MAAL,GAAc,KAAKA,MAAL,CAAYtsB,MAAZ,EAAd,GAAqC,EALzC,EAMI,KAAKgtB,IAAL,GAAY,KAAKA,IAAL,CAAUhtB,MAAV,EAAZ,GAAgC,EANpC;CAUA,aAAO,KAAKlC,IAAZ;CACA;CA3JF;CAAA;CAAA,8BA8JC;CACC,aAAO,KAAKA,IAAZ;CACA;CAhKF;CAAA;CAAA,qCAmKC;CACC,aAAO,mCAAmC,KAAK2nB,MAAL,CAAYkH,SAAZ,EAA1C;CACA;CArKF;CAAA;CAAA,uCAwKC;CACC1uB,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK4E,OAAL,EAAb,EAA6B,WAA7B;CACA;CA1KF;CAAA;CAAA,yCA6KC;CACC5M,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK2E,OAAL,EAAhB,EAAgC,WAAhC;CACA;CA/KF;CAAA;CAAA,6BAkLC;CACC,UAAI,CAAC,KAAKmiB,IAAV,EACA;CACC;CACA;;CAED,WAAKA,IAAL,CAAUG,MAAV;CACA;CAzLF;CAAA;CAAA,+BA4LC;CACC,UAAI,CAAC,KAAKH,IAAV,EACA;CACC;CACA;;CAED,WAAKA,IAAL,CAAUI,QAAV;CACA;CAnMF;CAAA;CAAA,oCAsMC;CACC,UAAI,KAAKd,MAAT,EACA;CACC,aAAKA,MAAL,CAAYxnB,OAAZ;CACA;CACD;CA3MF;CAAA;CAAA,sCA8MC;CACC,UAAI,KAAKwnB,MAAT,EACA;CACC,aAAKA,MAAL,CAAYtnB,SAAZ;CACA;CACD;CAnNF;CAAA;CAAA,gCAmBoBygB,MAnBpB,EAoBC;CACC,UAAMhB,MAAM,GAAG,IAAIzB,MAAJ,CAAWyC,MAAX,CAAf;CAEAhB,MAAAA,MAAM,CAAC3T,OAAP,CAAe2U,MAAf;;CAEA,UAAIA,MAAM,CAAChgB,WAAP,EAAJ,EACA;CACCgf,QAAAA,MAAM,CAAC9C,QAAP,CAAgB8D,MAAhB;CACA,OAHD,MAKA;CACChB,QAAAA,MAAM,CAACpX,OAAP,CAAeoY,MAAf;CACAhB,QAAAA,MAAM,CAAC4I,SAAP,CAAiB5H,MAAjB;CACA;;CAEDhB,MAAAA,MAAM,CAAC6I,OAAP,CAAe7H,MAAf;CAEA,aAAOhB,MAAP;CACA;CAtCF;CAAA;CAAA,EAA4B9sB,6BAA5B;;;KC0Ca41B,MAAb;CAAA;;CAEC,kBAAYt0B,MAAZ,EACA;CAAA;;CAAA;CACC,wGAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,uBAAvB;;CAEA,UAAKyxB,oBAAL,GAA4B,IAAIhgB,kBAAJ,EAA5B;CACA,UAAKigB,sBAAL,GAA8B,IAAIjgB,kBAAJ,EAA9B;;CAEA,UAAKykB,eAAL,CAAqBv0B,MAArB;;CAEA,UAAKw0B,QAAL,GAAgB,MAAKhoB,WAAL,EAAhB;CAVD;CAWC;;CAdF;CAAA;CAAA,oCAgBiBxM,MAhBjB,EAiBC;CACC,WAAK2T,QAAL,CAAc3T,MAAM,CAAC4T,KAArB;CACA,WAAKiE,OAAL,CAAa7X,MAAM,CAACD,IAApB;CACA,WAAK8T,OAAL,CAAa7T,MAAM,CAAC8T,IAApB;CACA,WAAK2gB,YAAL,CAAkBz0B,MAAM,CAACwuB,SAAzB;CACA,WAAKkG,UAAL,CAAgB10B,MAAM,CAAC0uB,OAAvB;CACA,WAAKiG,qBAAL,CAA2B30B,MAAM,CAAC40B,kBAAlC;CACA,WAAKC,mBAAL,CAAyB70B,MAAM,CAAC80B,gBAAhC;CACA,WAAKC,kBAAL,CAAwB/0B,MAAM,CAAC4vB,eAA/B;CACA,WAAKoF,wBAAL,CAA8Bh1B,MAAM,CAACi1B,qBAArC;CACA,WAAKC,2BAAL,CAAiCl1B,MAAM,CAACm1B,wBAAxC;CACA,WAAKC,SAAL,CAAep1B,MAAM,CAACuX,MAAtB;CACA,WAAKgY,uBAAL,CAA6BvvB,MAAM,CAAC8vB,oBAApC;CACA,WAAKL,yBAAL,CAA+BzvB,MAAM,CAAC+vB,sBAAtC;CACA,WAAKsF,iBAAL,CAAuBr1B,MAAM,CAACs1B,cAA9B;CACA,WAAKC,mBAAL,CAAyBv1B,MAAM,CAACw1B,gBAAhC;CACA,WAAKC,QAAL,CAAcz1B,MAAM,CAAC+E,KAArB;CACA,WAAKqP,OAAL,CAAapU,MAAM,CAACqU,IAApB;CACA,WAAKa,iBAAL,CAAuBlV,MAAM,CAACmV,cAA9B;CACA;CApCF;CAAA;CAAA,8BAsDWqX,MAtDX,EAuDC;CAAA;;CACC,UAAMhB,MAAM,GAAGzB,QAAM,CAAC2L,WAAP,CAAmBlJ,MAAnB,CAAf;;CAEA,UAAI,KAAKhB,MAAT,EACA;CACCxmB,QAAAA,aAAG,CAACkH,OAAJ,CAAY,KAAKsf,MAAL,CAAY5Z,OAAZ,EAAZ,EAAmC4Z,MAAM,CAACzkB,MAAP,EAAnC;CACA;;CAED,WAAKykB,MAAL,GAAcA,MAAd;CAEA,WAAKA,MAAL,CAAY7sB,SAAZ,CAAsB,YAAtB,EAAoC,KAAKg3B,YAAL,CAAkBtyB,IAAlB,CAAuB,IAAvB,CAApC;CACA,WAAKmoB,MAAL,CAAY7sB,SAAZ,CAAsB,cAAtB,EAAsC;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,cAAV,CAAN;CAAA,OAAtC;CACA,WAAKssB,MAAL,CAAY7sB,SAAZ,CAAsB,gBAAtB,EAAwC;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,gBAAV,CAAN;CAAA,OAAxC;CACA,WAAKssB,MAAL,CAAY7sB,SAAZ,CAAsB,aAAtB,EAAqC;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,aAAV,CAAN;CAAA,OAArC;CACA,WAAKssB,MAAL,CAAY7sB,SAAZ,CAAsB,sBAAtB,EAA8C,KAAKi3B,sBAAL,CAA4BvyB,IAA5B,CAAiC,IAAjC,CAA9C;CACA,WAAKmoB,MAAL,CAAY7sB,SAAZ,CAAsB,yBAAtB,EAAiD,YAAM;CACtD,QAAA,MAAI,CAACk3B,uBAAL,CAA6B,MAAI,CAACC,mBAAL,EAA7B;CACA,OAFD;CAGA,WAAKtK,MAAL,CAAY7sB,SAAZ,CAAsB,mBAAtB,EAA2C;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,yBAAV,CAAN;CAAA,OAA3C;CACA,WAAKssB,MAAL,CAAY7sB,SAAZ,CACC,gBADD,EAEC,UAACwJ,SAAD,EAA0B;CACzB,YAAI,MAAI,CAAC8e,eAAT,EACA;CACC,UAAA,MAAI,CAAC/nB,IAAL,CAAU,cAAV;CACA,SAHD,MAKA;CACC,UAAA,MAAI,CAACA,IAAL,CAAU,sBAAV,EAAkCiJ,SAAS,CAAC4N,OAAV,EAAlC;CACA;CACD,OAXF;CAaA;CAvFF;CAAA;CAAA,6BAyFUyW,MAzFV,EA0FC;CACC,WAAK/F,KAAL,GAAa,IAAIoE,KAAJ,CAAU2B,MAAV,CAAb;CACA;CA5FF;CAAA;CAAA,gCA8FaA,MA9Fb,EA+FC;CAAA;;CACC,WAAK9F,QAAL,GAAgB,IAAIuE,QAAJ,CAAauB,MAAb,CAAhB;;CAEA,UAAI,KAAKvF,eAAT,EACA;CACC,aAAKP,QAAL,CAAcM,YAAd;CACA;;CAED,WAAKN,QAAL,CAAc/nB,SAAd,CAAwB,YAAxB,EAAsC;CAAA,eAAM,MAAI,CAACO,IAAL,CAAU,WAAV,CAAN;CAAA,OAAtC;CACA;CAxGF;CAAA;CAAA,uCA0GoBstB,MA1GpB,EA2GC;CACC,UAAI,CAAC,KAAKhgB,WAAL,EAAL,EACA;CACC,aAAKma,eAAL,GAAuB,IAAIyE,eAAJ,CAAoBoB,MAApB,CAAvB;CACA;CACD;CAhHF;CAAA;CAAA,+BAmHC;CACC,aAAQ,KAAKkH,SAAL,OAAqB,QAA7B;CACA;CArHF;CAAA;CAAA,gCAwHC;CACC,aAAQ,KAAKA,SAAL,OAAqB,SAA7B;CACA;CA1HF;CAAA;CAAA,kCA6HC;CACC,aAAQ,KAAKA,SAAL,OAAqB,WAA7B;CACA;CA/HF;CAAA;CAAA,iCAkIC;CACC,aAAQ,KAAKlnB,WAAL,EAAR;CACA;CApIF;CAAA;CAAA,gCAuIC;CACC,UAAMupB,SAAS,GAAG,IAAIxJ,IAAJ,CAAS,KAAKmC,OAAL,GAAe,IAAxB,CAAlB;CACA,aAAQ,KAAKjC,QAAL,MAAoBsJ,SAAS,CAAC/H,OAAV,KAAuB,IAAIzB,IAAJ,EAAD,CAAayB,OAAb,EAAlD;CACA;CA1IF;CAAA;CAAA,oCA6IC;CACC,aAAO,QAAP;CACA;CA/IF;CAAA;CAAA,4BAiJSrG,OAjJT,EAkJC;CACC,kGAAcA,OAAd;CAEAA,MAAAA,OAAO,CAAC1S,gBAAR,CAAyB,KAAKrJ,UAAL,EAAzB;;CAEA,UAAI+b,OAAO,CAAC/V,OAAR,EAAJ,EACA;CACC5M,QAAAA,aAAG,CAACgI,QAAJ,CAAa2a,OAAO,CAAC/V,OAAR,EAAb,EAAgC,eAAhC;CACA;CACD;CA3JF;CAAA;CAAA,+BA6JY3N,IA7JZ,EA8JC;CACC,qGAAiBA,IAAjB;;CAEA,UAAI,KAAKyM,OAAL,EAAJ,EACA;CACC,aAAKxR,IAAL,CAAU,cAAV;CACA;CACD;CArKF;CAAA;CAAA,4BAuKSa,IAvKT,EAwKC;CACC,WAAKA,IAAL,GAAa8B,cAAI,CAACqG,QAAL,CAAcnI,IAAd,IAAsBA,IAAtB,GAA6B,EAA1C;;CAEA,UAAI,KAAKi2B,aAAL,EAAJ,EACA;CACC,aAAKxK,MAAL,CAAY3T,OAAZ,CAAoB,IAApB;CACA;CACD;CA/KF;CAAA;CAAA,8BAkLC;CACC,aAAO,KAAK9X,IAAZ;CACA;CApLF;CAAA;CAAA,6BAsLU6T,KAtLV,EAuLC;CACC,WAAKA,KAAL,GAAc/R,cAAI,CAACqG,QAAL,CAAc0L,KAAd,IAAuBA,KAAvB,GAA+B,EAA7C;CACA;CAzLF;CAAA;CAAA,+BA4LC;CACC,aAAO,KAAKA,KAAZ;CACA;CA9LF;CAAA;CAAA,4BAgMSE,IAhMT,EAiMC;CACC,WAAKA,IAAL,GAAajS,cAAI,CAACuL,SAAL,CAAe0G,IAAf,IAAuB/L,QAAQ,CAAC+L,IAAD,EAAO,EAAP,CAA/B,GAA4C,CAAzD;;CAEA,UAAI,KAAKlC,OAAL,EAAJ,EACA;CACC,aAAKA,OAAL,GAAewE,OAAf,CAAuB6f,UAAvB,GAAoC,KAAKniB,IAAzC;CACA;CACD;CAxMF;CAAA;CAAA,8BA2MC;CACC,aAAO,KAAKA,IAAZ;CACA;CA7MF;CAAA;CAAA,iCA+Mc0a,SA/Md,EAgNC;CACC,WAAKA,SAAL,GAAkB3sB,cAAI,CAACuL,SAAL,CAAeohB,SAAf,IAA4BzmB,QAAQ,CAACymB,SAAD,EAAY,EAAZ,CAApC,GAAsD,CAAxE;;CAEA,UAAI,KAAKwH,aAAL,EAAJ,EACA;CACC,aAAKxK,MAAL,CAAY3T,OAAZ,CAAoB,IAApB;CACA;CACD;CAvNF;CAAA;CAAA,mCA0NC;CACC,aAAO9P,QAAQ,CAAC,KAAKymB,SAAN,EAAiB,EAAjB,CAAf;CACA;CA5NF;CAAA;CAAA,+BA8NYE,OA9NZ,EA+NC;CACC,WAAKA,OAAL,GAAgB7sB,cAAI,CAACuL,SAAL,CAAeshB,OAAf,IAA0B3mB,QAAQ,CAAC2mB,OAAD,EAAU,EAAV,CAAlC,GAAkD,CAAlE;;CAEA,UAAI,KAAKsH,aAAL,EAAJ,EACA;CACC,aAAKxK,MAAL,CAAY3T,OAAZ,CAAoB,IAApB;CACA;CACD;CAtOF;CAAA;CAAA,iCAyOC;CACC,aAAO9P,QAAQ,CAAC,KAAK2mB,OAAN,EAAe,EAAf,CAAf;CACA;CA3OF;CAAA;CAAA,0CA6OuBF,SA7OvB,EA8OC;CACC,WAAKoG,kBAAL,GAA2B/yB,cAAI,CAACqG,QAAL,CAAcsmB,SAAd,IAA2BA,SAA3B,GAAuC,EAAlE;CACA;CAhPF;CAAA;CAAA,4CAmPC;CACC,aAAO,KAAKoG,kBAAZ;CACA;CArPF;CAAA;CAAA,wCAuPqBlG,OAvPrB,EAwPC;CACC,WAAKoG,gBAAL,GAAyBjzB,cAAI,CAACqG,QAAL,CAAcwmB,OAAd,IAAyBA,OAAzB,GAAmC,EAA5D;CACA;CA1PF;CAAA;CAAA,0CA6PC;CACC,aAAO,KAAKoG,gBAAZ;CACA;CA/PF;CAAA;CAAA,uCAiQoBlF,eAjQpB,EAkQC;CACC,WAAKA,eAAL,GAAwB/tB,cAAI,CAACuL,SAAL,CAAewiB,eAAf,IAAkC7nB,QAAQ,CAAC6nB,eAAD,EAAkB,EAAlB,CAA1C,GAAkE,CAA1F;CACA;CApQF;CAAA;CAAA,yCAuQC;CACC,aAAO,KAAKA,eAAZ;CACA;CAzQF;CAAA;CAAA,4CA2QyBE,oBA3QzB,EA4QC;CACC,WAAKA,oBAAL,CAA0Bvf,SAA1B,CAAoCuf,oBAApC;CAEA,WAAKpH,QAAL;CACA;CAhRF;CAAA;CAAA,8CAmRC;CACC,aAAO,KAAKoH,oBAAZ;CACA;CArRF;CAAA;CAAA,8CAuR2BC,sBAvR3B,EAwRC;CACC,WAAKA,sBAAL,CAA4Bxf,SAA5B,CAAsCwf,sBAAtC;CAEA,WAAKrH,QAAL;CACA;CA5RF;CAAA;CAAA,gDA+RC;CACC,aAAO,KAAKqH,sBAAZ;CACA;CAjSF;CAAA;CAAA,+BAoSC;CACC,UAAI,KAAKvE,MAAT,EACA;CACC,aAAKA,MAAL,CAAY9C,QAAZ,CAAqB,IAArB;CACA,aAAK8C,MAAL,CAAY3T,OAAZ,CAAoB,IAApB;CACA,aAAK2T,MAAL,CAAYpX,OAAZ,CAAoB,IAApB;CACA;CACD;CA3SF;CAAA;CAAA,6BA6SUrP,KA7SV,EA8SC;CAAA;;CACC,UAAI,CAAClD,cAAI,CAACkM,OAAL,CAAahJ,KAAb,CAAL,EACA;CACC;CACA;;CAEDA,MAAAA,KAAK,CAACoC,OAAN,CAAc,UAAC+uB,UAAD,EAA4B;CACzC,YAAMjyB,IAAI,GAAG8O,IAAI,CAAC2Y,SAAL,CAAewK,UAAf,CAAb;CACAjyB,QAAAA,IAAI,CAACgR,gBAAL,CAAsB,MAAI,CAACrJ,UAAL,EAAtB;CACA3H,QAAAA,IAAI,CAAC8iB,YAAL,CAAkB,MAAI,CAACe,YAAL,EAAlB;;CACA,QAAA,MAAI,CAAC/iB,KAAL,CAAWgN,GAAX,CAAe9N,IAAI,CAAC+N,KAAL,EAAf,EAA6B/N,IAA7B;CACA,OALD;CAMA;CA1TF;CAAA;CAAA,4BA4TSoQ,IA5TT,EA6TC;CACC,WAAKA,IAAL,GAAaxS,cAAI,CAAC4N,aAAL,CAAmB4E,IAAnB,IAA2BA,IAA3B,GAAkC;CAAC8hB,QAAAA,UAAU,EAAE;CAAb,OAA/C;CACA;CA/TF;CAAA;CAAA,sCAiUmBhhB,cAjUnB,EAkUC;CACC,WAAKA,cAAL,GAAsB;CACrBihB,QAAAA,KAAK,EAAE,KADc;CAErBjpB,QAAAA,QAAQ,EAAE;CAFW,OAAtB;;CAKA,UAAItL,cAAI,CAAC4N,aAAL,CAAmB0F,cAAnB,CAAJ,EACA;CACC,aAAKA,cAAL,CAAoBihB,KAApB,GAA4BjhB,cAAc,CAACihB,KAAf,KAAyB,IAArD;CACA,aAAKjhB,cAAL,CAAoBhI,QAApB,GAA+BgI,cAAc,CAAChI,QAAf,KAA4B,IAA3D;CACA;CACD;CA7UF;CAAA;CAAA,+BAgVC;CACC,aAAO,KAAKgI,cAAL,CAAoBihB,KAApB,KAA8B,IAArC;CACA;CAlVF;CAAA;CAAA,kCAqVC;CACC,aAAO,KAAKjhB,cAAL,CAAoBhI,QAApB,KAAiC,IAAxC;CACA;CAvVF;CAAA;CAAA,mCAyVgB2Z,WAzVhB,EA0VC;CACC,yGAAqBA,WAArB;;CAEA,UAAI,KAAK0E,MAAT,EACA;CACC,aAAKA,MAAL,CAAYpX,OAAZ,CAAoB,IAApB;CACA;CACD;CAjWF;CAAA;CAAA,sCAmWmBkhB,cAnWnB,EAoWC;CACC,WAAKA,cAAL,GAAuBzzB,cAAI,CAACuL,SAAL,CAAekoB,cAAf,IAAiCvtB,QAAQ,CAACutB,cAAD,EAAiB,EAAjB,CAAzC,GAAgE,CAAvF;CACA;CAtWF;CAAA;CAAA,wCAyWC;CACC,aAAO,KAAKA,cAAZ;CACA;CA3WF;CAAA;CAAA,wCA6WqBE,gBA7WrB,EA8WC;CACC,WAAKA,gBAAL,GAAyB3zB,cAAI,CAACuL,SAAL,CAAeooB,gBAAf,IAAmCztB,QAAQ,CAACytB,gBAAD,EAAmB,EAAnB,CAA3C,GAAoE,CAA7F;CACA;CAhXF;CAAA;CAAA,0CAmXC;CACC,aAAO,KAAKA,gBAAZ;CACA;CArXF;CAAA;CAAA,6CAuX0BP,qBAvX1B,EAwXC;CACC,WAAKA,qBAAL,GAA8BpzB,cAAI,CAACuL,SAAL,CAAe6nB,qBAAf,IAC3BltB,QAAQ,CAACktB,qBAAD,EAAwB,EAAxB,CADmB,GAE3B,CAFH;CAIA;CA7XF;CAAA;CAAA,+CAgYC;CACC,aAAO,KAAKA,qBAAZ;CACA;CAlYF;CAAA;CAAA,gDAoY6BE,wBApY7B,EAqYC;CACC,WAAKA,wBAAL,GAAiCtzB,cAAI,CAACw0B,QAAL,CAAclB,wBAAd,IAC9BjlB,UAAU,CAACilB,wBAAD,CADoB,GAE9B,CAFH;CAIA;CA1YF;CAAA;CAAA,kDA6YC;CACC,aAAO,KAAKA,wBAAZ;CACA;CA/YF;CAAA;CAAA,8BAkZC;CACC,aAAO,KAAK9gB,IAAZ;CACA;CApZF;CAAA;CAAA,0CAuZC;CACC,UAAMtP,KAAK,GAAG,IAAI4C,GAAJ,EAAd;CAEA,WAAK5C,KAAL,CAAWoC,OAAX,CAAmB,UAAClD,IAAD,EAAgB;CAClC,YAAI,CAACA,IAAI,CAACuI,WAAL,EAAL,EACA;CACCzH,UAAAA,KAAK,CAACgN,GAAN,CAAU9N,IAAI,CAAC+N,KAAL,EAAV,EAAwB/N,IAAxB;CACA;CACD,OALD;CAOA,aAAOc,KAAP;CACA;CAlaF;CAAA;CAAA,8BAoaWwS,MApaX,EAqaC;CAAA;;CACC,UAAM+e,eAAe,GAAG,IAAI3tB,GAAJ,CAAQ,CAC/B,SAD+B,EAE/B,QAF+B,EAG/B,WAH+B,CAAR,CAAxB;CAMA,WAAK4O,MAAL,GAAe+e,eAAe,CAAC1tB,GAAhB,CAAoB2O,MAApB,IAA8BA,MAA9B,GAAuC,SAAtD;CAEA,WAAKuU,SAAL,CAAe,IAAf;CAEA,WAAK/mB,KAAL,CAAWoC,OAAX,CAAmB,UAAClD,IAAD,EAAU;CAC5BA,QAAAA,IAAI,CAACgR,gBAAL,CAAsB,MAAI,CAACrJ,UAAL,EAAtB;CACA,OAFD;;CAIA,UAAI,KAAKA,UAAL,EAAJ,EACA;CACC,YAAI,KAAK+E,KAAT,EACA;CACC,eAAKA,KAAL,CAAWe,cAAX;CACA;CACD;CACD;CA3bF;CAAA;CAAA,gCA8bC;CACC,aAAO,KAAK6F,MAAZ;CACA;CAhcF;CAAA;CAAA,0CAmcC;CACC,UAAI,KAAKiU,MAAT,EACA;CACC,aAAKA,MAAL,CAAY+K,aAAZ;CACA;CACD;CAxcF;CAAA;CAAA,4CA2cC;CACC,UAAI,KAAK/K,MAAT,EACA;CACC,aAAKA,MAAL,CAAYgL,eAAZ;CACA;CACD;CAhdF;CAAA;CAAA,mCAkdgBC,SAldhB,EAmdC;CACC,UAAIA,SAAS,CAAC7e,OAAV,OAAwB,KAAKA,OAAL,EAA5B,EACA;CACC,aAAKC,OAAL,CAAa4e,SAAS,CAAC7e,OAAV,EAAb;CACA;;CACD,UAAI6e,SAAS,CAAC5H,YAAV,OAA6B,KAAKA,YAAL,EAAjC,EACA;CACC,aAAK4F,YAAL,CAAkBgC,SAAS,CAAC5H,YAAV,EAAlB;CACA;;CACD,UAAI4H,SAAS,CAAC3H,UAAV,OAA2B,KAAKA,UAAL,EAA/B,EACA;CACC,aAAK4F,UAAL,CAAgB+B,SAAS,CAAC3H,UAAV,EAAhB;CACA;;CAED,WAAKhW,cAAL,CAAoB2d,SAAS,CAAC5d,cAAV,GAA2BpI,SAA3B,EAApB;CACA,WAAK8e,uBAAL,CAA6BkH,SAAS,CAACjH,uBAAV,GAAoC/e,SAApC,EAA7B;CACA,WAAKgf,yBAAL,CAA+BgH,SAAS,CAAC/G,yBAAV,GAAsCjf,SAAtC,EAA/B;;CAEA,UAAIgmB,SAAS,CAAC/C,SAAV,OAA0B,KAAKA,SAAL,EAA9B,EACA;CACC,aAAK0B,SAAL,CAAeqB,SAAS,CAAC/C,SAAV,EAAf;CACA;;CAED,UAAI,KAAK7uB,IAAL,IAAa,KAAK2mB,MAAtB,EACA;CACC,aAAKM,SAAL,CAAe,IAAf;CACA;CACD;CA9eF;CAAA;CAAA,qCAifC;CACCzkB,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKwB,IAAhB,EAAsB,eAAtB,EAAuC,KAAKstB,UAAL,CAAgB9uB,IAAhB,CAAqB,IAArB,CAAvC;CAEA;;CACA,WAAKwB,IAAL,CAAUsN,KAAV,CAAgBE,MAAhB,aAA6B,KAAKxN,IAAL,CAAUuN,YAAvC;CACA,WAAKvN,IAAL,CAAUuB,YAAV;CACA,WAAKvB,IAAL,CAAUsN,KAAV,CAAgBE,MAAhB,GAAyB,GAAzB;CACA;CACA;CAzfF;CAAA;CAAA,iCA4fC;CACCrN,MAAAA,aAAG,CAAC6M,MAAJ,CAAW,KAAKhN,IAAhB;CACA,WAAKA,IAAL,GAAY,IAAZ;CACA;CA/fF;CAAA;CAAA,6BAkgBC;CACC,UAAM6xB,SAAS,GAAG,KAAKlqB,WAAL,KAAqB,EAArB,GAA0B,QAA5C;CAEA,WAAK3H,IAAL,GAAYiC,aAAG,CAACC,MAAhB,oZAE8C2vB,SAF9C,EAGsB,KAAK5iB,IAH3B,EAIoB,KAAK9B,KAAL,EAJpB,EAMI,KAAKwZ,MAAL,GAAc,KAAKA,MAAL,CAAYzkB,MAAZ,EAAd,GAAqC,EANzC,EAQK,KAAK0f,KAAL,GAAa,KAAKA,KAAL,CAAW1f,MAAX,EAAb,GAAmC,EARxC,EASK,KAAK2f,QAAL,GAAgB,KAAKA,QAAL,CAAc3f,MAAd,EAAhB,GAAyC,EAT9C,EAUK,KAAK4f,eAAL,GAAuB,KAAKA,eAAL,CAAqB5f,MAArB,EAAvB,GAAuD,EAV5D,EAWK,KAAKuf,SAAL,GAAiB,KAAKA,SAAL,CAAevf,MAAf,EAAjB,GAA2C,EAXhD;CAgBAM,MAAAA,eAAK,CAAChE,IAAN,CACC,KAAKyyB,mBAAL,EADD,EAEC,eAFD,EAGC,KAAKnkB,eAAL,CAAqBtO,IAArB,CAA0B,IAA1B,EAAgC,KAAKyyB,mBAAL,EAAhC,CAHD;CAMA,aAAO,KAAKjxB,IAAZ;CACA;CA5hBF;CAAA;CAAA,oCA+hBC;CACC;;CAEA,UAAI,KAAK6L,OAAL,MAAkB,CAAC,KAAKlE,WAAL,EAAvB,EACA;CACC,YAAI,KAAKge,cAAL,KAAwB,CAAxB,IAA6B,KAAKrD,oBAAL,EAAjC,EACA;CACC,eAAKwP,mBAAL;CACA,SAHD,MAKA;CACC,eAAKC,YAAL;CACA;CACD;CACD;CA7iBF;CAAA;CAAA,oCA+iBiB3yB,IA/iBjB,EAgjBC;CAAA;;CACC,0GAAsBA,IAAtB;CAEAA,MAAAA,IAAI,CAACtF,SAAL,CAAe,cAAf,EAA+B,UAACwJ,SAAD,EAA0B;CACxD,YAAMqJ,UAAgB,GAAGrJ,SAAS,CAAC+V,SAAV,EAAzB;CACA,YAAM5K,QAAkB,GAAGnL,SAAS,CAAC4N,OAAV,EAA3B;;CAEA,YAAI,MAAI,CAAC8gB,sBAAL,EAAJ,EACA;CACC;CACA;;CAED,YAAIvjB,QAAQ,CAAC5C,OAAT,EAAJ,EACA;CACC,UAAA,MAAI,CAAComB,oBAAL,GAA4B,IAA5B;;CAEA,UAAA,MAAI,CAAC53B,IAAL,CAAU,aAAV,EAAyBoU,QAAzB;CACA,SALD,MAOA;CACC,UAAA,MAAI,CAACyjB,mBAAL,CAAyBzjB,QAAQ,CAACvM,MAAT,EAAzB,EAA4CyK,UAAU,CAACI,OAAX,EAA5C;;CAEAJ,UAAAA,UAAU,CAACwlB,YAAX;CACA;CACD,OArBD;CAuBA/yB,MAAAA,IAAI,CAACtF,SAAL,CAAe,uBAAf,EAAwC,UAACwJ,SAAD,EAA0B;CACjE,uCAAI,MAAI,CAACoU,QAAL,GAAgB3Y,MAAhB,EAAJ,EAA8BoL,GAA9B,CAAkC,UAAC/K,IAAD,EAAgB;CACjD,cAAIA,IAAI,CAACuI,WAAL,EAAJ,EACA;CACC,YAAA,MAAI,CAAC6oB,iBAAL,CAAuB,MAAI,CAAC4B,iBAAL,KAA2B,CAAlD;CACA,WAHD,MAKA;CACC,YAAA,MAAI,CAAC1B,mBAAL,CAAyB,MAAI,CAAC2B,mBAAL,KAA6B,CAAtD;CACA;CACD,SATD;CAUA,OAXD;CAaAjzB,MAAAA,IAAI,CAACtF,SAAL,CAAe,gBAAf,EAAiC,UAACwJ,SAAD,EAA0B;CAC1D,QAAA,MAAI,CAACjJ,IAAL,CAAU,gBAAV,EAA4BiJ,SAAS,CAAC+V,SAAV,EAA5B;CACA,OAFD;CAGA;CA1lBF;CAAA;CAAA,iCA4lBc/V,SA5lBd,EA6lBC;CAAA;;CACC,UAAMqjB,MAAc,GAAGrjB,SAAS,CAAC+V,SAAV,EAAvB;CACA,UAAMvN,KAAuB,GAAGxI,SAAS,CAAC4N,OAAV,EAAhC;CAEAyV,MAAAA,MAAM,CAAC2L,gBAAP;CAEA,UAAMn1B,MAAM,GAAG2O,KAAK,CAACzL,KAAN,CAAYlD,MAA3B;CAEA2O,MAAAA,KAAK,CAACM,KAAN;CACAN,MAAAA,KAAK,CAACO,iBAAN,CAAwBlP,MAAxB,EAAgCA,MAAhC;CAEAqF,MAAAA,eAAK,CAAChE,IAAN,CAAWsN,KAAX,EAAkB,SAAlB,EAA6B,UAAC/R,KAAD,EAA0B;CACtD,YAAIA,KAAK,CAACwS,WAAN,IAAqBxS,KAAK,CAACyS,GAAN,KAAc,QAAnC,IAA+CzS,KAAK,CAACyS,GAAN,KAAc,OAAjE,EACA;CACCV,UAAAA,KAAK,CAACW,IAAN;CAEA1S,UAAAA,KAAK,CAAC2mB,wBAAN;CACA;CACD,OAPD;CASAle,MAAAA,eAAK,CAACkmB,QAAN,CAAe5c,KAAf,EAAsB,MAAtB,EAA8B,YAAM;CACnC,YAAI,MAAI,CAACiH,OAAL,OAAmBjH,KAAK,CAACzL,KAA7B,EACA;CACC,UAAA,MAAI,CAAC2S,OAAL,CAAalH,KAAK,CAACzL,KAAnB;;CAEA,UAAA,MAAI,CAAChG,IAAL,CAAU,kBAAV,EAA8B;CAC7BqvB,YAAAA,QAAQ,EAAE,MAAI,CAACvc,KAAL,EADmB;CAE7BjS,YAAAA,IAAI,EAAE,MAAI,CAAC6X,OAAL;CAFuB,WAA9B;CAIA;;CAED4T,QAAAA,MAAM,CAAC4L,kBAAP;CACA,OAZD;CAaA;CA9nBF;CAAA;CAAA,2CAgoBwBjvB,SAhoBxB,EAioBC;CACC,UAAMkvB,WAAW,GAAGlvB,SAAS,CAAC4N,OAAV,EAApB;CAEA,WAAK7W,IAAL,CAAU,sBAAV,EAAkCm4B,WAAlC;;CAEA,UAAIA,WAAW,CAACC,cAAZ,CAA2B,WAA3B,CAAJ,EACA;CACC,aAAK9I,SAAL,GAAiBzmB,QAAQ,CAACsvB,WAAW,CAAC7I,SAAb,EAAwB,EAAxB,CAAzB;CACA,OAHD,MAIK,IAAI6I,WAAW,CAACC,cAAZ,CAA2B,SAA3B,CAAJ,EACL;CACC,aAAK5I,OAAL,GAAe3mB,QAAQ,CAACsvB,WAAW,CAAC3I,OAAb,EAAsB,EAAtB,CAAvB;CACA;CACD;CA9oBF;CAAA;CAAA,oCAgpBiB7pB,IAhpBjB,EAipBC;CACC,UAAIG,aAAG,CAACmN,KAAJ,CAAUtN,IAAV,EAAgB,QAAhB,MAA8B,KAAlC,EACA;CACCG,QAAAA,aAAG,CAACmN,KAAJ,CAAUtN,IAAV,EAAgB,QAAhB,EAA0B,MAA1B;CACA;;CAED,WAAK3F,IAAL,CAAU,yBAAV;CACA;CAxpBF;CAAA;CAAA,4CA0pByB2F,IA1pBzB,EA2pBC;CACC,UAAI,KAAK0yB,aAAL,EAAJ,EACA;CACC,aAAKC,WAAL,CAAiB3yB,IAAjB;CAEAG,QAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKnI,IAAlB,EAAwB,QAAxB;;CAEA,YAAI,KAAK2H,WAAL,EAAJ,EACA;CACC,cAAI,KAAK+P,QAAL,GAAgBzK,IAAhB,KAAyB,CAA7B,EACA;CACC,iBAAK5S,IAAL,CAAU,yBAAV;CACA;CACD;CACD,OAbD,MAeA;CACC,aAAKu4B,WAAL,CAAiB5yB,IAAjB;CAEAG,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKpI,IAArB,EAA2B,QAA3B;CACA;CACD;CAhrBF;CAAA;CAAA,gCAkrBaA,IAlrBb,EAmrBC;CACC,WAAK2vB,QAAL,GAAgB,KAAhB;;CAEA,UAAI3vB,IAAJ,EACA;CACCG,QAAAA,aAAG,CAACmN,KAAJ,CAAUtN,IAAV,EAAgB,QAAhB,YAA8BA,IAAI,CAACuN,YAAnC;CACA;;CAED,UAAI,KAAKoZ,MAAT,EACA;CACC,aAAKA,MAAL,CAAY0I,MAAZ;CACA;CACD;CA/rBF;CAAA;CAAA,gCAisBarvB,IAjsBb,EAksBC;CACC,WAAK2vB,QAAL,GAAgB,IAAhB;;CAEA,UAAI3vB,IAAJ,EACA;CACC;CACAA,QAAAA,IAAI,CAACsN,KAAL,CAAWE,MAAX,aAAwBxN,IAAI,CAACuN,YAA7B;CACAvN,QAAAA,IAAI,CAACuB,YAAL;CACAvB,QAAAA,IAAI,CAACsN,KAAL,CAAWE,MAAX,GAAoB,GAApB;CACA;CACA;;CAED,UAAI,KAAKmZ,MAAT,EACA;CACC,aAAKA,MAAL,CAAY2I,QAAZ;CACA;CACD;CAltBF;CAAA;CAAA,oCAqtBC;CACC,aAAO,KAAKK,QAAZ;CACA;CAvtBF;CAAA;CAAA,iCA0tBC;CACC,UAAI,KAAK3vB,IAAT,EACA;CACCG,QAAAA,aAAG,CAACmN,KAAJ,CAAU,KAAKtN,IAAf,EAAqB,SAArB,EAAgC,OAAhC;CACA;CACD;CA/tBF;CAAA;CAAA,iCAkuBC;CACC,UAAI,KAAKA,IAAT,EACA;CACCG,QAAAA,aAAG,CAACmN,KAAJ,CAAU,KAAKtN,IAAf,EAAqB,SAArB,EAAgC,MAAhC;CACA;CACD;CAvuBF;CAAA;CAAA,0CA0uBC;CACC,aAAO,KAAKA,IAAL,CAAUC,aAAV,CAAwB,iCAAxB,CAAP;CACA;CA5uBF;CAAA;CAAA,8BA+uBC;CACC,UAAI,CAAC,KAAK0H,WAAL,EAAL,EACA;CACC;CACA;CACD;CApvBF;CAAA;CAAA,6BAuvBC;CACC,UAAI,CAAC,KAAKA,WAAL,EAAL,EACA;CACC;CACA;CACD;CA5vBF;CAAA;CAAA,6CA8vB0BvI,IA9vB1B,EA+vBC;CACC,WAAK6yB,oBAAL,GAA4B,KAA5B;CAEA7yB,MAAAA,IAAI,CAACyzB,eAAL;CACA;CAnwBF;CAAA;CAAA,6CAswBC;CACC,aAAO,KAAKZ,oBAAL,KAA8B,IAArC;CACA;CAxwBF;CAAA;CAAA,gCAsCoB92B,MAtCpB,EAuCC;CACC,UAAMwsB,MAAM,GAAG,IAAI8H,MAAJ,CAAWt0B,MAAX,CAAf;CAEAwsB,MAAAA,MAAM,CAACV,SAAP,CAAiBU,MAAjB;;CACA,UAAIA,MAAM,CAAChgB,WAAP,EAAJ,EACA;CACCggB,QAAAA,MAAM,CAACT,QAAP,CAAgBS,MAAhB;CACA;;CACDA,MAAAA,MAAM,CAACR,WAAP,CAAmBQ,MAAnB;CACAA,MAAAA,MAAM,CAACP,kBAAP,CAA0BO,MAA1B;CACAA,MAAAA,MAAM,CAACN,YAAP,CAAoBM,MAApB;CAEA,aAAOA,MAAP;CACA;CApDF;CAAA;CAAA,EAA4BtG,MAA5B;;KC/CayR,aAAb;CAEC,2BACA;CAAA;CACC,SAAK3N,OAAL,GAAe,IAAf;CACA,SAAK4N,OAAL,GAAe,IAAIjwB,GAAJ,EAAf;CACA,SAAKkwB,wBAAL,GAAgC,IAAIlwB,GAAJ,EAAhC;CACA;;CAPF;CAAA;CAAA,+BASYqiB,OATZ,EAUC;CACC,UAAI,EAAEA,OAAO,YAAYsB,OAArB,CAAJ,EACA;CACC,cAAM,IAAI/iB,KAAJ,CAAU,2CAAV,CAAN;CACA;;CAED,WAAKyhB,OAAL,GAAeA,OAAf;CACA;CAjBF;CAAA;CAAA,8BAmBWwC,MAnBX,EAoBC;CACC,WAAKoL,OAAL,CAAa7lB,GAAb,CAAiBya,MAAM,CAACxa,KAAP,EAAjB,EAAiCwa,MAAjC;CACA;CAtBF;CAAA;CAAA,+CAwB4BA,MAxB5B,EAyBC;CACC,WAAKqL,wBAAL,CAA8B9lB,GAA9B,CAAkCya,MAAM,CAACxa,KAAP,EAAlC,EAAkDwa,MAAlD;CACA;CA3BF;CAAA;CAAA,oDA8BC;CACC,WAAKqL,wBAAL,CAA8BzvB,KAA9B;CACA;CAhCF;CAAA;CAAA,iCAkCcmmB,QAlCd,EAmCC;CACC,WAAKqJ,OAAL,WAAoBrJ,QAApB;CACA;CArCF;CAAA;CAAA,iCAwCC;CACC,UAAI,KAAKvE,OAAL,KAAiB,IAArB,EACA;CACC,cAAM,IAAIzhB,KAAJ,CAAU,kCAAV,CAAN;CACA;;CAED,aAAO,KAAKyhB,OAAZ;CACA;CA/CF;CAAA;CAAA,iCAkDC;CACC,aAAO,KAAK4N,OAAZ;CACA;CApDF;CAAA;CAAA,sCAuDC;CACC,aAAO,+BAAI,KAAKA,OAAL,CAAah0B,MAAb,EAAJ,EAA2BY,IAA3B,CAAgC,UAACgoB,MAAD;CAAA,eAAoBA,MAAM,CAACC,QAAP,EAApB;CAAA,OAAhC,CAAP;CACA;CAzDF;CAAA;CAAA,wCA4DC;CACC,UAAMmL,OAAO,GAAG,IAAIjvB,GAAJ,EAAhB;CAEA,WAAKivB,OAAL,CAAazwB,OAAb,CAAqB,UAACqlB,MAAD,EAAoB;CACxC,YAAIA,MAAM,CAAC0F,SAAP,EAAJ,EACA;CACC0F,UAAAA,OAAO,CAAC1tB,GAAR,CAAYsiB,MAAZ;CACA;CACD,OALD;CAOA,aAAOoL,OAAP;CACA;CAvEF;CAAA;CAAA,kDA0EC;CACC,UAAMA,OAAO,GAAG,IAAIjvB,GAAJ,EAAhB;CAEA,WAAKivB,OAAL,CAAazwB,OAAb,CAAqB,UAACqlB,MAAD,EAAoB;CACxC,YAAIA,MAAM,CAAChgB,WAAP,MAAwB,CAACggB,MAAM,CAAC9b,OAAP,EAA7B,EACA;CACCknB,UAAAA,OAAO,CAAC1tB,GAAR,CAAYsiB,MAAZ;CACA;CACD,OALD;CAOA,aAAOoL,OAAP;CACA;CArFF;CAAA;CAAA,kDAuF+BE,UAvF/B,EAwFC;CACC,UAAMF,OAAO,GAAG,IAAIjvB,GAAJ,EAAhB;CAEA,WAAKivB,OAAL,CAAazwB,OAAb,CAAqB,UAACqlB,MAAD,EAAoB;CACxC,YAAI,CAACA,MAAM,CAAChgB,WAAP,EAAD,IAAyBsrB,UAAU,CAAC9lB,KAAX,OAAuBwa,MAAM,CAACxa,KAAP,EAApD,EACA;CACC4lB,UAAAA,OAAO,CAAC1tB,GAAR,CAAYsiB,MAAZ;CACA;CACD,OALD;CAOA,aAAOoL,OAAP;CACA;CAnGF;CAAA;CAAA,2CAsGC;CACC,aAAO,CAAC/1B,cAAI,CAACC,WAAL,CAAiB,+BAAI,KAAK81B,OAAL,CAAah0B,MAAb,EAAJ,EAA2BY,IAA3B,CAAgC,UAACgoB,MAAD;CAAA,eAAYA,MAAM,CAAChgB,WAAP,EAAZ;CAAA,OAAhC,CAAjB,CAAR;CACA;CAxGF;CAAA;CAAA,qCA2GC;CACC,UAAMmO,QAAQ,GAAG,IAAIhT,GAAJ,EAAjB;CAEAgT,MAAAA,QAAQ,CAAC5I,GAAT,CAAa,KAAKiY,OAAL,CAAahY,KAAb,EAAb,EAAmC,KAAKgY,OAAxC;CAEA,qCAAI,KAAK4N,OAAL,CAAah0B,MAAb,EAAJ,EAA2BoL,GAA3B,CAA+B,UAACwd,MAAD;CAAA,eAAY7R,QAAQ,CAAC5I,GAAT,CAAaya,MAAM,CAACxa,KAAP,EAAb,EAA6Bwa,MAA7B,CAAZ;CAAA,OAA/B;CAEA,aAAO7R,QAAP;CACA;CAnHF;CAAA;CAAA,kCAsHC;CACC,UAAI5V,KAAK,GAAG,IAAI4C,GAAJ,CAAQ,KAAKqiB,OAAL,CAAazN,QAAb,EAAR,CAAZ;CAEA,UAAMwb,YAAY,GAAG,KAAKC,eAAL,EAArB;;CAEA,UAAID,YAAJ,EACA;CACChzB,QAAAA,KAAK,GAAG,IAAI4C,GAAJ,0CAAY5C,KAAZ,kCAAsBgzB,YAAY,CAACxb,QAAb,EAAtB,GAAR;CACA;;CAED,qCAAI,KAAK0b,iBAAL,GAAyBr0B,MAAzB,EAAJ,EAAuCoL,GAAvC,CAA2C,UAACwd,MAAD;CAAA,eAAYznB,KAAK,GAAG,IAAI4C,GAAJ,0CAAY5C,KAAZ,kCAAsBynB,MAAM,CAACjQ,QAAP,EAAtB,GAApB;CAAA,OAA3C;CAEA,aAAOxX,KAAP;CACA;CAnIF;CAAA;CAAA,2CAsIC;CACC,UAAI,KAAKilB,OAAL,CAAaQ,cAAb,KAAgC,CAApC,EACA;CACC,eAAO,IAAP;CACA;;CAED,UAAM0N,YAAY,GAAG,+BAAI,KAAKN,OAAL,CAAah0B,MAAb,EAAJ,EAA2BY,IAA3B,CAAgC,UAACgoB,MAAD;CAAA,eAAoBA,MAAM,CAAChC,cAAP,KAA0B,CAA9C;CAAA,OAAhC,CAArB;CAEA,aAAO,CAAC3oB,cAAI,CAACC,WAAL,CAAiBo2B,YAAjB,CAAR;CACA;CA/IF;CAAA;CAAA,2CAkJC;CACC,WAAKlO,OAAL,CAAamO,oBAAb;CACA,WAAKP,OAAL,CAAazwB,OAAb,CAAqB,UAACqlB,MAAD;CAAA,eAAYA,MAAM,CAAC2L,oBAAP,EAAZ;CAAA,OAArB;CACA;CArJF;CAAA;CAAA,yCAuJsBnkB,QAvJtB,EAwJC;CACCA,MAAAA,QAAQ,GAAGjM,QAAQ,CAACiM,QAAD,EAAW,EAAX,CAAnB;;CAEA,UAAI,KAAKgW,OAAL,CAAahY,KAAb,OAAyBgC,QAA7B,EACA;CACC,eAAO,KAAKgW,OAAZ;CACA;;CAED,aAAO,+BAAI,KAAK4N,OAAL,CAAah0B,MAAb,EAAJ,EAA2BY,IAA3B,CAAgC,UAACgoB,MAAD;CAAA,eAAYA,MAAM,CAACxa,KAAP,OAAmBgC,QAA/B;CAAA,OAAhC,CAAP;CACA;CAjKF;CAAA;CAAA,qCAmKkB8G,MAnKlB,EAoKC;CACCA,MAAAA,MAAM,GAAG/S,QAAQ,CAAC+S,MAAD,EAAS,EAAT,CAAjB;CAEA,UAAMsd,YAAY,GAAG,KAAKpO,OAAL,CAAazN,QAAb,EAArB;;CACA,UAAI6b,YAAY,CAACxvB,GAAb,CAAiBkS,MAAjB,CAAJ,EACA;CACC,eAAOsd,YAAY,CAACjZ,GAAb,CAAiBrE,MAAjB,CAAP;CACA;;CAED,UAAM0R,MAAM,GAAG,+BAAI,KAAKoL,OAAL,CAAah0B,MAAb,EAAJ,EAA2BY,IAA3B,CAAgC,UAACgoB,MAAD;CAAA,eAAYA,MAAM,CAACjQ,QAAP,GAAkB3T,GAAlB,CAAsBkS,MAAtB,CAAZ;CAAA,OAAhC,CAAf;;CACA,UAAI0R,MAAJ,EACA;CACC,eAAOA,MAAM,CAACjQ,QAAP,GAAkB4C,GAAlB,CAAsBrE,MAAtB,CAAP;CACA;;CAED,aAAO,IAAP;CACA;CApLF;CAAA;CAAA,uCAsLoBrO,QAtLpB,EAuLC;CACCA,MAAAA,QAAQ,GAAG1E,QAAQ,CAAC0E,QAAD,EAAW,EAAX,CAAnB;CAEA,UAAI1H,KAAK,GAAG,IAAI4C,GAAJ,CAAQ,KAAKqiB,OAAL,CAAazN,QAAb,EAAR,CAAZ;CAEA,qCAAI,KAAKqb,OAAL,CAAah0B,MAAb,EAAJ,EAA2BoL,GAA3B,CAA+B,UAACwd,MAAD;CAAA,eAAYznB,KAAK,GAAG,IAAI4C,GAAJ,0CAAY5C,KAAZ,kCAAsBynB,MAAM,CAACjQ,QAAP,EAAtB,GAApB;CAAA,OAA/B;CAEA,aAAO,+BAAIxX,KAAK,CAACnB,MAAN,EAAJ,EAAoBY,IAApB,CAAyB,UAACP,IAAD;CAAA,eAAgBA,IAAI,CAACuR,WAAL,OAAuB/I,QAAvC;CAAA,OAAzB,CAAP;CACA;CA/LF;CAAA;CAAA,+DAiM4CA,QAjM5C,EAkMC;CACC,UAAI1H,KAAK,GAAG,IAAI4C,GAAJ,EAAZ;CAEA,qCAAI,KAAKkwB,wBAAL,CAA8Bj0B,MAA9B,EAAJ,EAA4CoL,GAA5C,CAAgD,UAACwd,MAAD;CAAA,eAAYznB,KAAK,GAAG,IAAI4C,GAAJ,0CAAY5C,KAAZ,kCAAsBynB,MAAM,CAACjQ,QAAP,EAAtB,GAApB;CAAA,OAAhD;CAEA,aAAO,+BAAIxX,KAAK,CAACnB,MAAN,EAAJ,EAAoBY,IAApB,CAAyB,UAACP,IAAD;CAAA,eAAgBA,IAAI,CAACuR,WAAL,OAAuB/I,QAAvC;CAAA,OAAzB,CAAP;CACA;CAxMF;CAAA;CAAA,uCA0MoBqO,MA1MpB,EA2MC;CACCA,MAAAA,MAAM,GAAG/S,QAAQ,CAAC+S,MAAD,EAAS,EAAT,CAAjB;CAEA,UAAMsd,YAAY,GAAG,KAAKpO,OAAL,CAAazN,QAAb,EAArB;;CACA,UAAI6b,YAAY,CAACxvB,GAAb,CAAiBkS,MAAjB,CAAJ,EACA;CACC,eAAO,KAAKkP,OAAZ;CACA;;CAED,aAAO,+BAAI,KAAK4N,OAAL,CAAah0B,MAAb,EAAJ,EAA2BY,IAA3B,CAAgC,UAACgoB,MAAD;CAAA,eAAYA,MAAM,CAACjQ,QAAP,GAAkB3T,GAAlB,CAAsBkS,MAAtB,CAAZ;CAAA,OAAhC,CAAP;CACA;CArNF;CAAA;CAAA;;KCQaud,QAAb;CAEC,oBAAYr4B,MAAZ,EACA;CAAA;CACC,SAAKs4B,WAAL,GAAmBt4B,MAAM,CAACs4B,WAA1B;CACA,SAAKC,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA;;CANF;CAAA;CAAA,iCAQct0B,IARd,EASC;CACC,UAAI,KAAKu0B,gBAAL,CAAsBv0B,IAAtB,CAAJ,EACA;CACC;CACA;;CAED,UAAM0O,MAAM,GAAG,GAAf;;CAEA,UAAI,KAAK8lB,aAAL,CAAmBx0B,IAAnB,CAAJ,EACA;CACC,YAAMy0B,eAAe,GAAG,KAAKH,aAAL,CAAmBI,UAAnB,GAAgCjR,gBAAhC,EAAxB;CAEA,YAAMkR,eAAe,GAAG5zB,aAAG,CAAC6zB,mBAAJ,CAAwB50B,IAAI,CAAC2N,OAAL,EAAxB,EAAwC8mB,eAAxC,EAAyDv4B,GAAjF;CAEAu4B,QAAAA,eAAe,CAACI,QAAhB,CAAyB;CACxB34B,UAAAA,GAAG,EAAEu4B,eAAe,CAACK,SAAhB,GAA4BH,eAA5B,GAA8CjmB,MAD3B;CAExBqmB,UAAAA,QAAQ,EAAE;CAFc,SAAzB;CAIA,OAVD,MAYA;CACC,YAAMC,gBAAgB,GAAG,KAAKX,WAAL,CAAiBY,mBAAjB,EAAzB;CAEA,YAAMN,gBAAe,GAAG5zB,aAAG,CAAC6zB,mBAAJ,CAAwB50B,IAAI,CAAC2N,OAAL,EAAxB,EAAwCqnB,gBAAxC,EAA0D94B,GAAlF;CAEA84B,QAAAA,gBAAgB,CAACH,QAAjB,CAA0B;CACzB34B,UAAAA,GAAG,EAAE84B,gBAAgB,CAACF,SAAjB,GAA6BH,gBAA7B,GAA+CjmB,MAD3B;CAEzBqmB,UAAAA,QAAQ,EAAE;CAFe,SAA1B;CAIA;CACD;CAvCF;CAAA;CAAA,mCAyCgBxM,MAzChB,EA0CC;CACCxmB,MAAAA,MAAM,CAAC8yB,QAAP,CAAgB;CAAE34B,QAAAA,GAAG,EAAE,GAAP;CAAY64B,QAAAA,QAAQ,EAAE;CAAtB,OAAhB,EADD;;CAKC,UAAMrmB,MAAM,GAAG,EAAf;CAEA,UAAMsmB,gBAAgB,GAAG,KAAKX,WAAL,CAAiBY,mBAAjB,EAAzB;CACA,UAAMC,QAAQ,GAAGn0B,aAAG,CAAC6zB,mBAAJ,CAAwBrM,MAAM,CAAC5a,OAAP,EAAxB,EAA0CqnB,gBAA1C,EAA4D94B,GAA7E;CAEA84B,MAAAA,gBAAgB,CAACH,QAAjB,CAA0B;CACzB34B,QAAAA,GAAG,EAAE84B,gBAAgB,CAACF,SAAjB,GAA6BI,QAA7B,GAAwCxmB,MADpB;CAEzBqmB,QAAAA,QAAQ,EAAE;CAFe,OAA1B;CAIA;CAxDF;CAAA;CAAA,qCA0DkB/0B,IA1DlB,EA2DC;CACC,UAAM2B,IAAI,GAAG3B,IAAI,CAAC2N,OAAL,GAAe/L,qBAAf,EAAb;CAEA,aACCD,IAAI,CAACzF,GAAL,IAAY,CAAZ,IACGyF,IAAI,CAACE,IAAL,IAAa,CADhB,IAEGF,IAAI,CAACG,MAAL,KAAgBC,MAAM,CAACC,WAAP,IAAsBC,QAAQ,CAACC,eAAT,CAAyBC,YAA/D,CAFH,IAGGR,IAAI,CAACS,KAAL,KAAeL,MAAM,CAACM,UAAP,IAAqBJ,QAAQ,CAACC,eAAT,CAAyBI,WAA7D,CAJJ;CAMA;CApEF;CAAA;CAAA,kCAsEetC,IAtEf,EAuEC;CACC,aAAO,KAAKs0B,aAAL,CAAmBI,UAAnB,GAAgCS,OAAhC,CAAwCn1B,IAAxC,CAAP;CACA;CAzEF;CAAA;CAAA;;;KCaao1B,gBAAb;CAAA;;CAEC,4BAAYr5B,MAAZ,EACA;CAAA;;CAAA;CACC,kHAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,iCAAvB;;CAEA,UAAKwE,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,UAAK01B,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA,UAAKe,UAAL,GAAkBvxB,QAAQ,CAAC/H,MAAM,CAACs5B,UAAR,EAAoB,EAApB,CAA1B;CACA,UAAK5jB,WAAL,GAAmB1V,MAAM,CAAC0V,WAA1B;CAEA,UAAK6jB,aAAL,GAAqB,KAArB;CACA,UAAKC,eAAL,GAAuB,KAAvB;CAEA,UAAKjnB,MAAL,GAAc,IAAd;CAEA,UAAKknB,YAAL,GAAoB,KAApB;CAEA,UAAK50B,IAAL,GAAY,IAAZ;CACA,UAAK2mB,MAAL,GAAc,IAAd;CACA,UAAKkO,mBAAL,GAA2B,IAA3B;CACA,UAAKC,QAAL,GAAgB,IAAhB;CACA,UAAKhT,eAAL,GAAuB,IAAvB;CArBD;CAsBC;;CAzBF;CAAA;CAAA,6BA4BC;CACC,WAAK9hB,IAAL,GAAYiC,aAAG,CAACC,MAAhB,mnBAKOxE,aAAG,CAACC,UAAJ,CAAe,qCAAf,CALP,EASMD,aAAG,CAACC,UAAJ,CAAe,yCAAf,CATN,EAYK,KAAKo3B,YAAL,EAZL,EAaK,KAAKC,UAAL,EAbL;CAkBA,WAAKH,mBAAL,GAA2B,KAAK70B,IAAL,CAAUC,aAAV,CAAwB,yCAAxB,CAA3B;CACA,WAAK60B,QAAL,GAAgB,KAAK90B,IAAL,CAAUC,aAAV,CAAwB,uCAAxB,CAAhB;CAEA,WAAK6hB,eAAL,GAAuB,KAAK9hB,IAAL,CAAUC,aAAV,CAAwB,6BAAxB,CAAvB;CAEAuC,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKs2B,QAAhB,EAA0B,eAA1B,EAA2C,KAAKhoB,eAAL,CAAqBtO,IAArB,CAA0B,IAA1B,CAA3C;CAEA,UAAMy2B,kBAAkB,GAAG,KAAKH,QAAL,CAAc70B,aAAd,CAA4B,gDAA5B,CAA3B;CAEA,WAAKi1B,QAAL,CAAcD,kBAAd;CAEA,aAAO,KAAKj1B,IAAZ;CACA;CA3DF;CAAA;CAAA,0CA8DC;CACCG,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK2Z,eAAlB,EAAmC,QAAnC;CAEA,WAAKqT,kBAAL;CACA;CAlEF;CAAA;CAAA,0CAqEC;CACCh1B,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK0Z,eAArB,EAAsC,QAAtC;CAEA,WAAKsT,UAAL;CACA;CAzEF;CAAA;CAAA,mCA4EC;CACC,UAAMC,SAAS,GAAG,2EAAlB;CAEA,WAAK1O,MAAL,GAAc1kB,aAAG,CAACC,MAAlB,qZAGKxE,aAAG,CAACC,UAAJ,CAAe,oCAAf,CAHL,EAMoD03B,SANpD;CAUA,UAAMC,OAAO,GAAG,KAAK3O,MAAL,CAAY1mB,aAAZ,CAA0B,sCAA1B,CAAhB;CACAuC,MAAAA,eAAK,CAAChE,IAAN,CAAW82B,OAAX,EAAoB,OAApB,EAA6B,KAAKC,UAAL,CAAgB/2B,IAAhB,CAAqB,IAArB,CAA7B;CAEA,aAAO,KAAKmoB,MAAZ;CACA;CA7FF;CAAA;CAAA,+BA+FY5sB,KA/FZ,EAgGC;CACC,UAAMiG,IAAI,GAAGjG,KAAK,CAACy7B,aAAnB;CAEA,UAAMvuB,OAAO,GAAG9G,aAAG,CAAC4U,QAAJ,CAAa/U,IAAb,EAAmB,MAAnB,CAAhB;;CAEA,UAAIiH,OAAJ,EACA;CACC9G,QAAAA,aAAG,CAACiI,WAAJ,CAAgBpI,IAAhB,EAAsB,MAAtB;CACA,OAHD,MAKA;CACCG,QAAAA,aAAG,CAACgI,QAAJ,CAAanI,IAAb,EAAmB,MAAnB;CAEAG,QAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAK2sB,QAAlB,EAA4B,WAA5B;;CAEA,YAAI,CAAC,KAAKW,iBAAL,EAAD,IAA6Bz4B,cAAI,CAAC8L,MAAL,CAAY,KAAK4E,MAAjB,CAAjC,EACA;CACC,eAAKA,MAAL,GAAc,KAAKhL,UAAL,EAAd;CACA;CACD;;CAED,UAAIuE,OAAJ,EACA;CACC,aAAKyuB,QAAL;CACA,OAHD,MAKA;CACC,aAAKC,QAAL;CACA;;CAED,WAAKC,WAAL;CACA;CA/HF;CAAA;CAAA,iCAkIC;CACC,aAAO3zB,aAAG,CAACC,MAAX,sLAEI,KAAK2zB,oBAAL,EAFJ;CAKA;CAxIF;CAAA;CAAA,2CA2IC;CACC,aAAO5zB,aAAG,CAACC,MAAX;CACA;CA7IF;CAAA;CAAA,gCA+Ia4qB,KA/Ib,EAgJC;CACC,aAAO7qB,aAAG,CAACC,MAAX,mIAEIxE,aAAG,CAACC,UAAJ,CAAe,qCAAf,EACA0J,OADA,CACQ,SADR,EACmBnE,QAAQ,CAAC4pB,KAAK,CAACgJ,kBAAP,EAA2B,EAA3B,CAD3B,EAEAzuB,OAFA,CAEQ,eAFR,EAEyBnE,QAAQ,CAAC4pB,KAAK,CAACwD,wBAAP,EAAiC,EAAjC,CAFjC,EAGAjpB,OAHA,CAGQ,WAHR,EAGqBnE,QAAQ,CAAC4pB,KAAK,CAACiJ,2BAAP,EAAoC,EAApC,CAH7B,CAFJ;CASA;CA1JF;CAAA;CAAA,wCA6JC;CACC,aAAO,KAAKpB,eAAZ;CACA;CA/JF;CAAA;CAAA,6BAiKUjnB,MAjKV,EAkKC;CAAA;;CACC,UAAI1Q,cAAI,CAACC,WAAL,CAAiB0Z,oBAAjB,CAAJ,EACA;CACC;CACA;;CAED,UAAMC,QAAQ,GAAG,IAAID,oBAAJ,CAAyB,UAACE,OAAD,EACzC;CACC,YAAGA,OAAO,CAAC,CAAD,CAAP,CAAWC,cAAX,KAA8B,IAAjC,EACA;CACC,cAAI,CAAC,MAAI,CAAC8d,YAAV,EACA;CACC,YAAA,MAAI,CAACoB,sBAAL;CACA;CACD;CACD,OATe,EAUhB;CACC/e,QAAAA,SAAS,EAAE,CAAC,CAAD;CADZ,OAVgB,CAAjB;CAeAL,MAAAA,QAAQ,CAACM,OAAT,CAAiBxJ,MAAjB;CACA;CAxLF;CAAA;CAAA,kCA2LC;CAAA;;CACC,UAAI,KAAKgnB,aAAT,EACA;CACC;CACA;;CAED,WAAKA,aAAL,GAAqB,IAArB;CAEA,WAAK12B,aAAL,CAAmBi4B,wBAAnB,GACEx6B,IADF,CACO,UAACqB,QAAD,EAAc;CACnB,QAAA,MAAI,CAACo5B,WAAL,CAAiBp5B,QAAQ,CAACZ,IAA1B;CACA,OAHF,WAIQ,UAACY,QAAD,EAAc;CACpB,QAAA,MAAI,CAAC43B,aAAL,GAAqB,KAArB;;CACA,QAAA,MAAI,CAAC12B,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAPF;CASA;CA5MF;CAAA;CAAA,6CA+MC;CAAA;;CACC,WAAK83B,YAAL,GAAoB,IAApB;;CAEA,UAAI,KAAKa,iBAAL,MAA4Bz4B,cAAI,CAAC8L,MAAL,CAAY,KAAK4E,MAAjB,CAAhC,EACA;CACC,aAAKA,MAAL,GAAc,KAAKhL,UAAL,EAAd;CACA;;CAED,UAAM8vB,WAAW,GAAG;CACnBiC,QAAAA,UAAU,EAAE,KAAKA;CADE,OAApB;CAIA,WAAKz2B,aAAL,CAAmBo4B,mBAAnB,CAAuC5D,WAAvC,EACE/2B,IADF,CACO,UAACqB,QAAD,EAAc;CACnB,YAAMZ,IAAI,GAAGY,QAAQ,CAACZ,IAAtB;;CACA,YAAIc,cAAI,CAACkM,OAAL,CAAahN,IAAb,KAAsBA,IAAI,CAACiB,MAA/B,EACA;CACC,UAAA,MAAI,CAACs3B,UAAL;;CAEA,UAAA,MAAI,CAAC4B,aAAL,CAAmBn6B,IAAnB;;CAEA,UAAA,MAAI,CAAC04B,YAAL,GAAoB,KAApB;;CAEA,UAAA,MAAI,CAACe,QAAL;CACA;;CACD,QAAA,MAAI,CAAChB,eAAL,GAAuB,IAAvB;;CACA,YAAI,MAAI,CAACjnB,MAAT,EACA;CACC,UAAA,MAAI,CAACA,MAAL,CAAYM,IAAZ;CACA;CACD,OAlBF,WAmBQ,UAAClR,QAAD,EAAc;CACpB,YAAI,MAAI,CAAC4Q,MAAT,EACA;CACC,UAAA,MAAI,CAACA,MAAL,CAAYM,IAAZ;CACA;;CACD,QAAA,MAAI,CAAC4mB,YAAL,GAAoB,KAApB;;CACA,QAAA,MAAI,CAAC52B,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OA1BF;CA4BA;CAvPF;CAAA;CAAA,iCA0PC;CACC,UAAM6Q,YAAY,GAAGxN,aAAG,CAACyN,WAAJ,CAAgB,KAAKknB,QAArB,CAArB;CAEA,UAAMpnB,MAAM,GAAG,IAAIG,kBAAJ,CAAW;CACzBxD,QAAAA,MAAM,EAAE,KAAKyqB,QADY;CAEzB7nB,QAAAA,IAAI,EAAE,EAFmB;CAGzBvQ,QAAAA,IAAI,EAAE,QAHmB;CAIzBoR,QAAAA,MAAM,EAAE;CACP7M,UAAAA,IAAI,YAAM0M,YAAY,CAACI,KAAb,GAAqB,CAArB,GAAyB,EAA/B;CADG;CAJiB,OAAX,CAAf;CASAL,MAAAA,MAAM,CAAC7R,IAAP;CAEA,aAAO6R,MAAP;CACA;CAzQF;CAAA;CAAA,gCA2Qaof,KA3Qb,EA4QC;CACC,UAAMwJ,QAAQ,GAAG,KAAKt2B,IAAL,CAAUC,aAAV,CAAwB,uCAAxB,CAAjB;CACA,UAAMs2B,eAAe,GAAG,KAAKv2B,IAAL,CAAUC,aAAV,CAAwB,wCAAxB,CAAxB;CAEAq2B,MAAAA,QAAQ,CAAChsB,WAAT,GAAuBgsB,QAAQ,CAAChsB,WAAT,GAAuB,IAAvB,GAA8BpH,QAAQ,CAAC4pB,KAAK,CAAC0J,aAAP,EAAsB,EAAtB,CAA7D;CAEAr2B,MAAAA,aAAG,CAACyD,MAAJ,CAAW,KAAK6yB,WAAL,CAAiB3J,KAAjB,CAAX,EAAoCyJ,eAApC;CACA;CAnRF;CAAA;CAAA,kCAqRexD,OArRf,EAsRC;CAAA;;CACCA,MAAAA,OAAO,CAACzwB,OAAR,CAAgB,UAACo0B,UAAD,EAA8B;CAC7CA,QAAAA,UAAU,CAAC7lB,WAAX,GAAyB,GAAzB;CACA,YAAM8W,MAAM,GAAG8H,MAAM,CAACkH,WAAP,CAAmBD,UAAnB,CAAf;;CAEA,QAAA,MAAI,CAAChD,aAAL,CAAmBkD,SAAnB,CAA6BjP,MAA7B;;CAEAxnB,QAAAA,aAAG,CAACujB,YAAJ,CACCiE,MAAM,CAACzlB,MAAP,EADD,EAEC,MAAI,CAAC4yB,QAAL,CAAc70B,aAAd,CAA4B,gDAA5B,CAFD;CAIA0nB,QAAAA,MAAM,CAACkP,aAAP;;CAEA,QAAA,MAAI,CAACx8B,IAAL,CAAU,cAAV,EAA0BstB,MAA1B;CACA,OAbD;CAcA;CArSF;CAAA;CAAA,8BAuSWA,MAvSX,EAwSC;CACC,WAAK+L,aAAL,CAAmBkD,SAAnB,CAA6BjP,MAA7B;CAEAxnB,MAAAA,aAAG,CAACujB,YAAJ,CAAiBiE,MAAM,CAACzlB,MAAP,EAAjB,EAAkC,KAAK4yB,QAAL,CAAc3oB,iBAAhD;CAEAwb,MAAAA,MAAM,CAACkP,aAAP;CAEA,WAAKx8B,IAAL,CAAU,cAAV,EAA0BstB,MAA1B;CACA;CAhTF;CAAA;CAAA,wCAkTqBmP,gBAlTrB,EAmTC;CAAA;;CACC,UAAI95B,cAAI,CAAC8L,MAAL,CAAY,KAAK+rB,mBAAjB,CAAJ,EACA;CACC;CACA;;CAED10B,MAAAA,aAAG,CAAC42B,KAAJ,CAAU,KAAKlC,mBAAf;CAEAiC,MAAAA,gBAAgB,CACdx0B,OADF,CACU,UAACqlB,MAAD,EAAoB;CAC5BxnB,QAAAA,aAAG,CAACyD,MAAJ,CAAW+jB,MAAM,CAACzlB,MAAP,EAAX,EAA4B,MAAI,CAAC2yB,mBAAjC;CACAlN,QAAAA,MAAM,CAACkP,aAAP;;CACA,QAAA,MAAI,CAACx8B,IAAL,CAAU,cAAV,EAA0BstB,MAA1B;;CACA,QAAA,MAAI,CAAC+L,aAAL,CAAmBsD,0BAAnB,CAA8CrP,MAA9C;;CACAxQ,QAAAA,UAAU,CAAC;CAAA,iBAAMwQ,MAAM,CAACqJ,uBAAP,CAA+BrJ,MAAM,CAACsJ,mBAAP,EAA/B,CAAN;CAAA,SAAD,EAAqE,GAArE,CAAV;CACA,OAPF;CAUA,WAAKkE,kBAAL;CACA;CAtUF;CAAA;CAAA,0CAyUC;CACCh1B,MAAAA,aAAG,CAAC42B,KAAJ,CAAU,KAAKlC,mBAAf;CAEA,WAAKnB,aAAL,CAAmBuD,6BAAnB;CAEA,WAAK7B,UAAL;CACA;CA/UF;CAAA;CAAA,yCAkVC;CACC,WAAK8B,UAAL;CACA,WAAKxB,QAAL;CAEAv1B,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKue,MAAL,CAAY1mB,aAAZ,CAA0B,sCAA1B,CAAhB,EAAmF,MAAnF;CACA;CAvVF;CAAA;CAAA,iCA0VC;CACC,UAAIjD,cAAI,CAAC8L,MAAL,CAAY,KAAK6d,MAAjB,CAAJ,EACA;CACC;CACA;;CAEDxmB,MAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKue,MAArB,EAA6B,QAA7B;CACA;CAjWF;CAAA;CAAA,iCAoWC;CACC,UAAI3pB,cAAI,CAAC8L,MAAL,CAAY,KAAK6d,MAAjB,CAAJ,EACA;CACC;CACA;;CAEDxmB,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKwe,MAAlB,EAA0B,QAA1B;CACA;CA3WF;CAAA;CAAA,+BA8WC;CACC,UAAMxQ,UAAU,GAAG,KAAKnW,IAAL,CAAUC,aAAV,CAAwB,kCAAxB,CAAnB;CAEAE,MAAAA,aAAG,CAACgI,QAAJ,CAAagO,UAAb,EAAyB,QAAzB;CAEAhW,MAAAA,aAAG,CAACmN,KAAJ,CAAU,KAAKwnB,QAAf,EAAyB,QAAzB,YAAuC,KAAKA,QAAL,CAAcvnB,YAArD;CAEA,WAAKlT,IAAL,CAAU,aAAV;CACA;CAtXF;CAAA;CAAA,+BAyXC;CACC,UAAM8b,UAAU,GAAG,KAAKnW,IAAL,CAAUC,aAAV,CAAwB,kCAAxB,CAAnB;CAEAE,MAAAA,aAAG,CAACiI,WAAJ,CAAgB+N,UAAhB,EAA4B,QAA5B;CAEA;;CACA,WAAK2e,QAAL,CAAcxnB,KAAd,CAAoBE,MAApB,aAAiC,KAAKsnB,QAAL,CAAcvnB,YAA/C;CACA,WAAKunB,QAAL,CAAcvzB,YAAd;CACA,WAAKuzB,QAAL,CAAcxnB,KAAd,CAAoBE,MAApB,GAA6B,GAA7B;CACA;CACA;CAnYF;CAAA;CAAA,sCAsYC;CACC,UAAMS,MAAM,GAAI9N,aAAG,CAACmN,KAAJ,CAAU,KAAKwnB,QAAf,EAAyB,QAAzB,MAAuC,KAAvD;;CAEA,UAAI7mB,MAAJ,EACA;CACC9N,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAK0sB,QAArB,EAA+B,WAA/B;CACA,OAHD,MAKA;CACC30B,QAAAA,aAAG,CAACmN,KAAJ,CAAU,KAAKwnB,QAAf,EAAyB,QAAzB,EAAmC,MAAnC;CACA;;CAED,WAAKz6B,IAAL,CAAU,aAAV;CACA;CAnZF;CAAA;CAAA,EAAsCR,6BAAtC;;;KCLas9B,WAAb;CAAA;;CAEC,uBAAYh8B,MAAZ,EACA;CAAA;;CAAA;CACC,6GAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,2BAAvB;;CAEA,UAAKwE,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,UAAK01B,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA,UAAKtD,qBAAL,GAA6Bj1B,MAAM,CAACi1B,qBAApC;CACA,UAAKgH,4BAAL,GAAoCj8B,MAAM,CAACi8B,4BAA3C;CACA,UAAKC,eAAL,GAAuBl8B,MAAM,CAACk8B,eAA9B;CACA,UAAKxmB,WAAL,GAAmB1V,MAAM,CAAC0V,WAA1B;CACA,UAAKuR,eAAL,GAAuBjnB,MAAM,CAACinB,eAA9B;CACA,UAAKE,oBAAL,GAA4BnnB,MAAM,CAACmnB,oBAAP,KAAgC,GAA5D;CAEA,UAAKgV,QAAL,GAAgB,IAAI9D,QAAJ,CAAa;CAC5BC,MAAAA,WAAW,2CADiB;CAE5BC,MAAAA,aAAa,EAAE,MAAKA;CAFQ,KAAb,CAAhB;CAdD;CAkBC;;CArBF;CAAA;CAAA,6BAuBUlwB,SAvBV,EAwBC;CACC,WAAK+zB,cAAL,GAAsB/zB,SAAtB;CAEA,WAAKg0B,gBAAL,CAAsB,KAAKH,eAA3B;CAEAl3B,MAAAA,aAAG,CAACyD,MAAJ,CAAW,KAAK8vB,aAAL,CAAmBI,UAAnB,GAAgC5xB,MAAhC,EAAX,EAAqD,KAAKq1B,cAA1D;CACA,WAAK7D,aAAL,CAAmBI,UAAnB,GAAgC+C,aAAhC;CAEA12B,MAAAA,aAAG,CAACyD,MAAJ,CAAW,KAAK6zB,sBAAL,EAAX,EAA0C,KAAKF,cAA/C;CACA,WAAK7D,aAAL,CAAmBgE,UAAnB,GAAgCp1B,OAAhC,CAAwC,UAACqlB,MAAD,EAAoB;CAC3D,YAAI,CAACA,MAAM,CAAChgB,WAAP,EAAL,EACA;CACCggB,UAAAA,MAAM,CAACkP,aAAP;CACA;CACD,OALD;CAOA,WAAKx8B,IAAL,CAAU,cAAV;CAEA,WAAKs9B,qBAAL;CACA;CA3CF;CAAA;CAAA,6CA8CC;CAAA;;CACC,WAAKb,gBAAL,GAAwB,IAAItC,gBAAJ,CAAqB;CAC5Cx2B,QAAAA,aAAa,EAAE,KAAKA,aADwB;CAE5C01B,QAAAA,aAAa,EAAE,KAAKA,aAFwB;CAG5Ce,QAAAA,UAAU,EAAE,KAAK2C,4BAH2B;CAI5CvmB,QAAAA,WAAW,EAAE,KAAKA;CAJ0B,OAArB,CAAxB;CAMA,WAAKimB,gBAAL,CAAsBh9B,SAAtB,CAAgC,cAAhC,EAAgD,UAACwJ,SAAD,EAA0B;CACzE,QAAA,MAAI,CAACjJ,IAAL,CAAU,cAAV,EAA0BiJ,SAAS,CAAC4N,OAAV,EAA1B;CACA,OAFD;CAGA,WAAK4lB,gBAAL,CAAsBh9B,SAAtB,CAAgC,aAAhC,EAA+C;CAAA,eAAM,MAAI,CAAC69B,qBAAL,EAAN;CAAA,OAA/C;CAEA,UAAMzE,YAAY,GAAG,KAAKQ,aAAL,CAAmBP,eAAnB,EAArB;CACA,UAAMyE,cAAc,GAAG,KAAKlE,aAAL,CAAmBN,iBAAnB,EAAvB;CAEA,WAAKyE,WAAL,GAAmB51B,aAAG,CAACC,MAAvB,qXAE6CgxB,YAAY,GAAG,EAAH,GAAQ,SAFjE,EAGKA,YAAY,GAAGA,YAAY,CAAChxB,MAAb,EAAH,GAA2B,EAH5C,EAK8C01B,cAAc,CAAC3qB,IAAf,GAAsB,EAAtB,GAA2B,SALzE,EAMK,+BAAI2qB,cAAc,CAAC74B,MAAf,EAAJ,EAA6BoL,GAA7B,CAAiC,UAACwd,MAAD;CAAA,eAAYA,MAAM,CAACzlB,MAAP,EAAZ;CAAA,OAAjC,CANL,EAQI,KAAK41B,oBAAL,EARJ,EASI,KAAKpE,aAAL,CAAmBqE,oBAAnB,KAA4C,KAAKjB,gBAAL,CAAsB50B,MAAtB,EAA5C,GAA6E,EATjF;CAaA,WAAK81B,oBAAL,CAA0BJ,cAA1B,EAA0C,CAAC56B,cAAI,CAACC,WAAL,CAAiBi2B,YAAjB,CAA3C;;CAEA,UAAI,KAAK5Q,oBAAT,EACA;CACC,YAAM0Q,wBAAwB,GAAG,KAAKU,aAAL,CAAmBuE,2BAAnB,EAAjC;;CACA,YAAIjF,wBAAwB,CAAC/lB,IAA7B,EACA;CACC,eAAKirB,4BAAL,CAAkClF,wBAAlC;CACA,SAHD,MAKA;CACC,eAAKlB,mBAAL;CACA;CACD;;CAEDtvB,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAKq5B,WAAhB,EAA6B,QAA7B,EAAuC,KAAKM,eAAL,CAAqB35B,IAArB,CAA0B,IAA1B,CAAvC;CAEA,aAAO,KAAKq5B,WAAZ;CACA;CA5FF;CAAA;CAAA,2CA+FC;CACC,WAAKO,cAAL,GAAsBn2B,aAAG,CAACC,MAA1B,kPAGKxE,aAAG,CAACC,UAAJ,CAAe,kCAAf,CAHL;CAQA6E,MAAAA,eAAK,CAAChE,IAAN,CAAW,KAAK45B,cAAhB,EAAgC,OAAhC,EAAyC,KAAKC,YAAL,CAAkB75B,IAAlB,CAAuB,IAAvB,CAAzC;CAEA,aAAO,KAAK45B,cAAZ;CACA;CA3GF;CAAA;CAAA,qCA6GkB/3B,KA7GlB,EA8GC;CACC,UAAIA,KAAK,KAAK,SAAd,EACA;CACCF,QAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKovB,cAAlB,EAAkC,0BAAlC;CACA,OAHD,MAKA;CACCp3B,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKmvB,cAArB,EAAqC,0BAArC;CACA;CACD;CAvHF;CAAA;CAAA,iCAyHcl3B,KAzHd,EA0HC;CACC,WAAKwQ,WAAL,GAAmBxQ,KAAnB;CACA;CA5HF;CAAA;CAAA,0CA+HC;CACC,aAAO,KAAKw3B,WAAZ;CACA;CAjIF;CAAA;CAAA,wCAoIC;CACC,aAAO,KAAKO,cAAZ;CACA;CAtIF;CAAA;CAAA,qCAwIkB50B,SAxIlB,EAyIC;CACC,UAAIA,SAAS,CAAC2I,iBAAd,EACA;CACC,eAAOhM,aAAG,CAAC4U,QAAJ,CAAavR,SAAS,CAAC2I,iBAAvB,EAA0C,kCAA1C,CAAP;CACA,OAHD,MAKA;CACC,eAAO,KAAP;CACA;CACD;CAlJF;CAAA;CAAA,mCAqJC;CAAA;;CACC,UAAMwd,SAAS,GAAGX,IAAI,CAACC,KAAL,CAAWvB,IAAI,CAAC0D,GAAL,KAAa,IAAxB,CAAlB;CACA,UAAMvB,OAAO,GAAIb,IAAI,CAACC,KAAL,CAAWvB,IAAI,CAAC0D,GAAL,KAAa,IAAxB,IAAgCloB,QAAQ,CAAC,KAAKktB,qBAAN,EAA6B,EAA7B,CAAzD;CACA,UAAMnhB,IAAI,GAAG,KAAKykB,aAAL,CAAmBN,iBAAnB,GAAuCnmB,IAAvC,GAA8C,CAA3D;CAEA,UAAMulB,WAAW,GAAG;CACnBzjB,QAAAA,KAAK,EAAE5M,cAAI,CAACsC,SAAL,EADY;CAEnBwK,QAAAA,IAAI,EAAEA,IAAI,GAAG,CAFM;CAGnB0a,QAAAA,SAAS,EAAEA,SAHQ;CAInBE,QAAAA,OAAO,EAAEA;CAJU,OAApB;CAOA,WAAKxvB,IAAL,CAAU,oBAAV,EAAgCm4B,WAAhC;CAEA,aAAO,KAAKx0B,aAAL,CAAmBq6B,YAAnB,CAAgC7F,WAAhC,EACL/2B,IADK,CACA,UAACqB,QAAD,EAAc;CACnB,YAAMw7B,YAA0B,GAAGx7B,QAAQ,CAACZ,IAA5C;CACAo8B,QAAAA,YAAY,CAACznB,WAAb,GAA2B,MAAI,CAACA,WAAhC;CACAynB,QAAAA,YAAY,CAAClW,eAAb,GAA+B,MAAI,CAACA,eAApC;CACAkW,QAAAA,YAAY,CAAChW,oBAAb,GAAoC,MAAI,CAACA,oBAAL,GAA4B,GAA5B,GAAkC,GAAtE;CAEA,YAAMqF,MAAM,GAAG8H,MAAM,CAACkH,WAAP,CAAmB2B,YAAnB,CAAf;;CAEA,QAAA,MAAI,CAAC5E,aAAL,CAAmBkD,SAAnB,CAA6BjP,MAA7B;;CAEA,QAAA,MAAI,CAAC4Q,wBAAL,CAA8B5Q,MAA9B;;CAEA,QAAA,MAAI,CAAC2P,QAAL,CAAckB,cAAd,CAA6B7Q,MAA7B;;CAEA,QAAA,MAAI,CAACttB,IAAL,CAAU,cAAV,EAA0BstB,MAA1B;;CAEA,eAAOA,MAAP;CACA,OAlBK,WAmBC,UAAC7qB,QAAD,EAAc;CACpB,QAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OArBK,CAAP;CAuBA;CA1LF;CAAA;CAAA,qCA4LkB6qB,MA5LlB,EA6LC;CACCA,MAAAA,MAAM,CAACzF,YAAP,CAAoB,KAAKrR,WAAzB;CACA8W,MAAAA,MAAM,CAACxF,YAAP,CAAoB,KAAKC,eAAzB;CAEA,WAAKsR,aAAL,CAAmBkD,SAAnB,CAA6BjP,MAA7B;CAEA,WAAK4Q,wBAAL,CAA8B5Q,MAA9B;CAEA,WAAKttB,IAAL,CAAU,kBAAV,EAA8BstB,MAA9B;CACA;CAtMF;CAAA;CAAA,6CAwM0BA,MAxM1B,EAyMC;CACC,UAAMnkB,SAAS,GAAG,KAAK6wB,mBAAL,GAA2Bp0B,aAA3B,CAAyC,gCAAzC,CAAlB;CAEAE,MAAAA,aAAG,CAACyD,MAAJ,CAAW+jB,MAAM,CAACzlB,MAAP,EAAX,EAA4BsB,SAA5B;CAEArD,MAAAA,aAAG,CAACiI,WAAJ,CAAgB5E,SAAhB,EAA2B,SAA3B;CAEAmkB,MAAAA,MAAM,CAACkP,aAAP;CAEA,WAAKc,qBAAL;CAEA,WAAKK,oBAAL,CACC,KAAKtE,aAAL,CAAmBN,iBAAnB,EADD,EAEC,CAACp2B,cAAI,CAACC,WAAL,CAAiB,KAAKy2B,aAAL,CAAmBP,eAAnB,EAAjB,CAFF;CAIA;CAxNF;CAAA;CAAA,+CA0N4BxL,MA1N5B,EA2NC;CACC,UAAMnkB,SAAS,GAAG,KAAK6wB,mBAAL,GAA2Bp0B,aAA3B,CAAyC,+BAAzC,CAAlB;CAEAE,MAAAA,aAAG,CAACyD,MAAJ,CAAW+jB,MAAM,CAAC5a,OAAP,EAAX,EAA6BvJ,SAA7B;CAEArD,MAAAA,aAAG,CAACiI,WAAJ,CAAgB5E,SAAhB,EAA2B,SAA3B;CACA;CAjOF;CAAA;CAAA,kDAmO+BmkB,MAnO/B,EAoOC;CACCA,MAAAA,MAAM,CAAC2F,UAAP;CAEA,WAAKoG,aAAL,CAAmB+E,YAAnB,CAAgC9Q,MAAM,CAACxa,KAAP,EAAhC;;CAEA,UAAI,KAAK2pB,gBAAL,CAAsBrB,iBAAtB,EAAJ,EACA;CACC,aAAKqB,gBAAL,CAAsBF,SAAtB,CAAgCjP,MAAhC;CACA;;CAED,WAAKgQ,qBAAL;CACA;CA/OF;CAAA;CAAA,wCAiPqBhT,WAjPrB,EAiP+CC,YAjP/C,EAkPC;CACC,UAAIA,YAAY,CAACX,kBAAjB,EACA;CACC9jB,QAAAA,aAAG,CAACujB,YAAJ,CAAiBiB,WAAjB,EAA8BC,YAAY,CAACX,kBAA3C;CACA,OAHD,MAKA;CACC9jB,QAAAA,aAAG,CAACyD,MAAJ,CAAW+gB,WAAX,EAAwBC,YAAY,CAAC8T,aAArC;CACA;CACD;CA3PF;CAAA;CAAA,sCA8PC;CACC,WAAKr+B,IAAL,CAAU,eAAV;CACA;CAhQF;CAAA;CAAA,4CAmQC;CACC,WAAKs+B,sBAAL;CAEA,UAAMC,SAAS,GAAG,KAAKvE,mBAAL,GAA2B9mB,YAA3B,GAA0C,KAAK8mB,mBAAL,GAA2B9yB,YAAvF;;CAEA,UAAIq3B,SAAJ,EACA;CACCz4B,QAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKksB,mBAAL,EAAb,EAAyC,aAAzC;CACA,OAHD,MAKA;CACCl0B,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,KAAKisB,mBAAL,EAAhB,EAA4C,aAA5C;CACA;CACD;CAhRF;CAAA;CAAA,6CAmRC;CACC,UAAMnB,YAAY,GAAG,KAAKQ,aAAL,CAAmBP,eAAnB,EAArB;CACA,UAAM0F,eAAe,GAAG,KAAKxE,mBAAL,GAA2Bp0B,aAA3B,CAAyC,+BAAzC,CAAxB;;CACA,UAAIizB,YAAJ,EACA;CACC/yB,QAAAA,aAAG,CAACiI,WAAJ,CAAgBywB,eAAhB,EAAiC,SAAjC;CACA,OAHD,MAKA;CACC14B,QAAAA,aAAG,CAACgI,QAAJ,CAAa0wB,eAAb,EAA8B,SAA9B;CACA;;CAED,UAAMjB,cAAc,GAAG,KAAKlE,aAAL,CAAmBN,iBAAnB,EAAvB;CACA,UAAM0F,gBAAgB,GAAG,KAAKzE,mBAAL,GAA2Bp0B,aAA3B,CAAyC,gCAAzC,CAAzB;;CACA,UAAI23B,cAAc,CAAC3qB,IAAnB,EACA;CACC9M,QAAAA,aAAG,CAACiI,WAAJ,CAAgB0wB,gBAAhB,EAAkC,SAAlC;CACA,OAHD,MAKA;CACC34B,QAAAA,aAAG,CAACgI,QAAJ,CAAa2wB,gBAAb,EAA+B,SAA/B;CACA;CACD;CAzSF;CAAA;CAAA,yCA2SsBlB,cA3StB,EA2SmDmB,iBA3SnD,EA4SC;CACC,UAAIA,iBAAJ,EACA;CACCnB,QAAAA,cAAc,CAACt1B,OAAf,CAAuB,UAAC02B,aAAD,EAA2B;CACjDA,UAAAA,aAAa,CAACC,mBAAd;CACA,SAFD;CAGA,OALD,MAOA;CACCrB,QAAAA,cAAc,CAACt1B,OAAf,CAAuB,UAAC02B,aAAD,EAA2B;CACjDA,UAAAA,aAAa,CAACE,qBAAd;CACA,SAFD;CAGA;CACD;CAzTF;CAAA;CAAA,wCA4TC;CACC,aAAO,KAAK3B,cAAZ;CACA;CA9TF;CAAA;CAAA,gDAiUC;CACCp3B,MAAAA,aAAG,CAACgI,QAAJ,CAAa,KAAKovB,cAAlB,EAAkC,eAAlC;CACA;CAnUF;CAAA;CAAA,kDAsUC;CAAA;;CACCpgB,MAAAA,UAAU,CAAC,YAAM;CAChBhX,QAAAA,aAAG,CAACiI,WAAJ,CAAgB,MAAI,CAACmvB,cAArB,EAAqC,eAArC;CACA,OAFS,EAEP,GAFO,CAAV;CAGA;CA1UF;CAAA;CAAA,0CA6UC;CACC,UAAI,KAAK7D,aAAL,CAAmBqE,oBAAnB,EAAJ,EACA;CACC,aAAKjB,gBAAL,CAAsBhF,mBAAtB;CACA;CACD;CAlVF;CAAA;CAAA,0CAqVC;CACC,UAAI,KAAK4B,aAAL,CAAmBqE,oBAAnB,EAAJ,EACA;CACC,aAAKjB,gBAAL,CAAsB1T,mBAAtB;CACA;CACD;CA1VF;CAAA;CAAA,iDA4V8B0T,gBA5V9B,EA6VC;CACC,UAAI,KAAKpD,aAAL,CAAmBqE,oBAAnB,EAAJ,EACA;CACC,aAAKjB,gBAAL,CAAsBqC,mBAAtB,CAA0CrC,gBAA1C;CACA;CACD;CAlWF;CAAA;CAAA,mDAqWC;CACC,UAAI,KAAKpD,aAAL,CAAmBqE,oBAAnB,EAAJ,EACA;CACC,aAAKjB,gBAAL,CAAsBsC,mBAAtB;CACA;CACD;CA1WF;CAAA;CAAA,EAAiCv/B,6BAAjC;;;;;;;KCJaw/B,WAAb;CAAA;;CAEC,uBAAYl+B,MAAZ,EACA;CAAA;;CAAA;CACC,6GAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,4BAAvB;;CAEA,UAAKie,MAAL,GAActc,MAAM,CAACsc,MAArB;CACA,UAAKrY,IAAL,GAAYjE,MAAM,CAACiE,IAAnB;CAEA,UAAKk6B,WAAL,GAAmB,MAAKl6B,IAAL,CAAU2N,OAAV,EAAnB;CAEA,UAAKwsB,QAAL,uCAAoB;CACnBC,MAAAA,IAAI,EAAE;CAACC,QAAAA,QAAQ,EAAE;CAAX,OADa;CAEnBC,MAAAA,UAAU,EAAE;CAACD,QAAAA,QAAQ,EAAE;CAAX,OAFO;CAGnBE,MAAAA,GAAG,EAAE;CAACF,QAAAA,QAAQ,EAAE;CAAX,OAHc;CAInBG,MAAAA,IAAI,EAAE;CAACH,QAAAA,QAAQ,EAAE;CAAX,OAJa;CAKnB9R,MAAAA,MAAM,EAAE;CAAC8R,QAAAA,QAAQ,EAAE;CAAX,OALW;CAMnBtU,MAAAA,OAAO,EAAE;CAACsU,QAAAA,QAAQ,EAAE;CAAX,OANU;CAOnBvvB,MAAAA,IAAI,EAAE;CAACuvB,QAAAA,QAAQ,EAAE;CAAX,OAPa;CAQnBxwB,MAAAA,IAAI,EAAE;CAACwwB,QAAAA,QAAQ,EAAE;CAAX,OARa;CASnBI,MAAAA,aAAa,EAAE;CAACJ,QAAAA,QAAQ,EAAE;CAAX,OATI;CAUnBzsB,MAAAA,MAAM,EAAE;CAACysB,QAAAA,QAAQ,EAAE;CAAX;CAVW,KAApB,GAWMt+B,MAAM,CAACo+B,QAXb;CAaA,UAAKv5B,IAAL,GAAY,IAAZ;CAEA,UAAK85B,WAAL,GAAmB,KAAnB;CAEA,UAAKC,WAAL,GAAmB,IAAnB;;CAEA,UAAKC,kBAAL;;CA7BD;CA8BC;;CAjCF;CAAA;CAAA,2BAoCC;CACC,WAAKh6B,IAAL,GAAY,KAAKi6B,sBAAL,CAA4B,KAAKC,iBAAL,EAA5B,CAAZ;CACA,WAAKC,SAAL;CAEA,WAAKJ,WAAL,GAAmBrgC,EAAE,CAACslB,EAAH,CAAM6O,IAAN,CAAWC,cAAX,CAA0B;CAC5CC,QAAAA,eAAe,EAAE;CAChBhpB,UAAAA,UAAU,EAAE,IADI;CAEhBD,UAAAA,QAAQ,EAAE,IAFM;CAGhBkpB,UAAAA,SAAS,EAAE;CAHK;CAD2B,OAA1B,CAAnB;CAQA,WAAK+L,WAAL,CAAiB9L,IAAjB,CAAsB,KAAKjuB,IAA3B;CAEAG,MAAAA,aAAG,CAACyD,MAAJ,CAAW,KAAK5D,IAAhB,EAAsBqB,QAAQ,CAAC+4B,IAA/B;CACA;CAnDF;CAAA;CAAA,8BAsDC;CACCj6B,MAAAA,aAAG,CAAC6M,MAAJ,CAAW,KAAKhN,IAAhB;CAEA,WAAKA,IAAL,GAAY,IAAZ;;CAEA,UAAI,KAAK4W,QAAT,EACA;CACC,aAAKA,QAAL,CAAcI,UAAd;CACA;;CAED,WAAKqjB,QAAL;CAEA,WAAKhgC,IAAL,CAAU,WAAV;CACA;CAnEF;CAAA;CAAA,+BAsEC;CACC,UAAI,KAAK0/B,WAAT,EACA;CACC,aAAKA,WAAL,CAAiB/rB,IAAjB;CACA;CACD;CA3EF;CAAA;CAAA,8BA8EC;CACC,aAAO,KAAKhO,IAAZ;CACA;CAhFF;CAAA;CAAA,8BAmFC;CACC,aAAO,KAAKZ,IAAZ;CACA;CArFF;CAAA;CAAA,wCAwFC;CACC,UAAIo6B,IAAI,GAAG,EAAX;CACA,UAAIE,UAAU,GAAG,EAAjB;CACA,UAAIC,GAAG,GAAG,EAAV;CACA,UAAIC,IAAI,GAAG,EAAX;CACA,UAAIjS,MAAM,GAAG,EAAb;CACA,UAAIxC,OAAO,GAAG,EAAd;CACA,UAAIjb,IAAI,GAAG,EAAX;CACA,UAAIjB,IAAI,GAAG,EAAX;CACA,UAAI4wB,aAAa,GAAG,EAApB;CACA,UAAI7sB,MAAM,GAAG,EAAb;CAEA,UAAMstB,YAAY,GAAG,gCAArB;CACA,UAAMC,UAAU,GAAG,2CAAnB;CAEA,UAAMrf,QAAQ,GAAGjZ,aAAG,CAACC,MAAP,+aAGT,KAAKs4B,eAAL,CAAqB,KAAK/iB,MAAL,CAAYgjB,iBAAZ,GAAgCxtB,IAArD,CAHS,CAAd;;CAUA,UAAI,KAAKssB,QAAL,CAAcC,IAAd,CAAmBC,QAAvB,EACA;CACC,YAAMiB,YAAY,GAAG,KAAKnB,QAAL,CAAcC,IAAd,CAAmBxyB,OAAnB,KAA+B,IAA/B,GAAsC,YAAtC,GAAqD,EAA1E;CAEAwyB,QAAAA,IAAI,GAAGv3B,aAAG,CAACC,MAAP,oeAEOo4B,YAFP,EAE2DI,YAF3D,EAGWh9B,aAAG,CAACC,UAAJ,CAAe,oCAAf,CAHX,EAOCD,aAAG,CAACC,UAAJ,CAAe,+BAAf,CAPD,CAAJ;CAYA;;CAED,UAAI,KAAK47B,QAAL,CAAcG,UAAd,CAAyBD,QAA7B,EACA;CACC,YAAMiB,aAAY,GAAG,KAAKnB,QAAL,CAAcG,UAAd,CAAyB1yB,OAAzB,KAAqC,IAArC,GAA4C,YAA5C,GAA2D,EAAhF;;CAEA0yB,QAAAA,UAAU,GAAGz3B,aAAG,CAACC,MAAP,yYAECo4B,YAFD,EAE2DI,aAF3D,EAGKh9B,aAAG,CAACC,UAAJ,CAAe,oCAAf,CAHL,CAAV;CASA;;CAED,UAAI,KAAK47B,QAAL,CAAcI,GAAd,CAAkBF,QAAtB,EACA;CACC,YAAMiB,cAAY,GAAG,KAAKnB,QAAL,CAAcI,GAAd,CAAkB3yB,OAAlB,KAA8B,IAA9B,GAAqC,YAArC,GAAoD,EAAzE;;CAEA2yB,QAAAA,GAAG,GAAG13B,aAAG,CAACC,MAAP,gaAEQo4B,YAFR,EAE2DI,cAF3D,EAGYh9B,aAAG,CAACC,UAAJ,CAAe,uCAAf,CAHZ,EAMED,aAAG,CAACC,UAAJ,CAAe,8BAAf,CANF,CAAH;CAWA;;CAED,UAAI,KAAK47B,QAAL,CAAcK,IAAd,CAAmBH,QAAvB,EACA;CACC,YAAMiB,cAAY,GAAG,KAAKnB,QAAL,CAAcK,IAAd,CAAmB5yB,OAAnB,KAA+B,IAA/B,GAAsC,YAAtC,GAAqD,EAA1E;;CAEA4yB,QAAAA,IAAI,GAAG33B,aAAG,CAACC,MAAP,saAEOo4B,YAFP,EAE2DC,UAF3D,EAEyEG,cAFzE,EAGWh9B,aAAG,CAACC,UAAJ,CAAe,oCAAf,CAHX,EAMCD,aAAG,CAACC,UAAJ,CAAe,+BAAf,CAND,CAAJ;CAWA;;CAED,UAAI,KAAK47B,QAAL,CAAc5R,MAAd,CAAqB8R,QAAzB,EACA;CACC,YAAMiB,cAAY,GAAG,KAAKnB,QAAL,CAAc5R,MAAd,CAAqB3gB,OAArB,KAAiC,IAAjC,GAAwC,YAAxC,GAAuD,EAA5E;;CACA,YAAM2zB,gBAAgB,GAAG,KAAKpB,QAAL,CAAc5R,MAAd,CAAqBjP,QAArB,KAAkC,IAAlC,GAAyC6hB,UAAzC,GAAsD,EAA/E;CAEA5S,QAAAA,MAAM,GAAG1lB,aAAG,CAACC,MAAP,oaAEKo4B,YAFL,EAE2DK,gBAF3D,EAE+ED,cAF/E,EAGSh9B,aAAG,CAACC,UAAJ,CAAe,sCAAf,CAHT,EAMDD,aAAG,CAACC,UAAJ,CAAe,iCAAf,CANC,CAAN;CAWA;;CAED,UAAI,KAAK47B,QAAL,CAAcpU,OAAd,CAAsBsU,QAA1B,EACA;CACC,YAAMiB,cAAY,GAAG,KAAKnB,QAAL,CAAcpU,OAAd,CAAsBne,OAAtB,KAAkC,IAAlC,GAAyC,YAAzC,GAAwD,EAA7E;;CAEAme,QAAAA,OAAO,GAAGljB,aAAG,CAACC,MAAP,gaAEIo4B,YAFJ,EAE2DI,cAF3D,EAGQh9B,aAAG,CAACC,UAAJ,CAAe,uCAAf,CAHR,EAMFD,aAAG,CAACC,UAAJ,CAAe,kCAAf,CANE,CAAP;CAWA;;CAED,UAAI,KAAK47B,QAAL,CAAcrvB,IAAd,CAAmBuvB,QAAvB,EACA;CACC,YAAMiB,cAAY,GAAG,KAAKnB,QAAL,CAAcrvB,IAAd,CAAmBlD,OAAnB,KAA+B,IAA/B,GAAsC,YAAtC,GAAqD,EAA1E;;CAEAkD,QAAAA,IAAI,GAAGjI,aAAG,CAACC,MAAP,kaAEOo4B,YAFP,EAE2DC,UAF3D,EAEyEG,cAFzE,EAGWh9B,aAAG,CAACC,UAAJ,CAAe,mCAAf,CAHX,EAMCD,aAAG,CAACC,UAAJ,CAAe,+BAAf,CAND,CAAJ;CAWA;;CAED,UAAI,KAAK47B,QAAL,CAActwB,IAAd,CAAmBwwB,QAAvB,EACA;CACC,YAAMiB,cAAY,GAAG,KAAKnB,QAAL,CAActwB,IAAd,CAAmBjC,OAAnB,KAA+B,IAA/B,GAAsC,YAAtC,GAAqD,EAA1E;;CAEAiC,QAAAA,IAAI,GAAGhH,aAAG,CAACC,MAAP,maAEOo4B,YAFP,EAE4DC,UAF5D,EAE0EG,cAF1E,EAGWh9B,aAAG,CAACC,UAAJ,CAAe,oCAAf,CAHX,EAMCD,aAAG,CAACC,UAAJ,CAAe,+BAAf,CAND,CAAJ;CAWA;;CAED,UAAI,KAAK47B,QAAL,CAAcM,aAAd,CAA4BJ,QAAhC,EACA;CACC,YAAMiB,cAAY,GAAG,KAAKnB,QAAL,CAAcM,aAAd,CAA4B7yB,OAA5B,KAAwC,IAAxC,GAA+C,YAA/C,GAA8D,EAAnF;;CACA,YAAM4zB,QAAQ,GAAG,KAAKnjB,MAAL,CAAYwO,SAAZ,KACd,sDADc,GAEd,qDAFH;CAIA,YAAM4U,QAAQ,GAAG,KAAKpjB,MAAL,CAAYwO,SAAZ,KACdvoB,aAAG,CAACC,UAAJ,CAAe,2CAAf,CADc,GAEdD,aAAG,CAACC,UAAJ,CAAe,0CAAf,CAFH;CAKAk8B,QAAAA,aAAa,GAAG53B,aAAG,CAACC,MAAP,kWAEFo4B,YAFE,EAEcM,QAFd,EAE0BF,cAF1B,EAGEG,QAHF,CAAb;CASA;;CAED,UAAI,KAAKtB,QAAL,CAAcvsB,MAAd,CAAqBysB,QAAzB,EACA;CACC,YAAMiB,cAAY,GAAG,KAAKnB,QAAL,CAAcvsB,MAAd,CAAqBhG,OAArB,KAAiC,IAAjC,GAAwC,YAAxC,GAAuD,EAA5E;;CAEAgG,QAAAA,MAAM,GAAG/K,aAAG,CAACC,MAAP,+TAEKo4B,YAFL,EAE2DI,cAF3D,EAGSh9B,aAAG,CAACC,UAAJ,CAAe,sCAAf,CAHT,CAAN;CAQA;;CAED,aAAOsE,aAAG,CAACC,MAAX,ycAGKgZ,QAHL,EAIKse,IAJL,EAKKE,UALL,EAMKC,GANL,EAOKC,IAPL,EAQKjS,MARL,EASKxC,OATL,EAUKjb,IAVL,EAWKjB,IAXL,EAYK4wB,aAZL,EAaK7sB,MAbL;CAiBA;CA/SF;CAAA;CAAA,gCAkTC;CAAA;;CACC,UAAM8tB,WAAW,GAAG,KAAK96B,IAAL,CAAUC,aAAV,CAAwB,0CAAxB,CAApB;CACAuC,MAAAA,eAAK,CAAChE,IAAN,CACCs8B,WAAW,CAAC76B,aAAZ,CAA0B,kCAA1B,CADD,EAEC,OAFD,EAGC;CAAA,eAAM,MAAI,CAAC5F,IAAL,CAAU,UAAV,CAAN;CAAA,OAHD;;CAMA,UAAI,KAAKk/B,QAAL,CAAcC,IAAd,CAAmBC,QAAnB,IAA+B,KAAKF,QAAL,CAAcC,IAAd,CAAmBxyB,OAAnB,KAA+B,IAAlE,EACA;CACCxE,QAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,sCAAxB,CADD,EAEC,OAFD,EAGC,KAAKs5B,QAAL,CAAcC,IAAd,CAAmBuB,QAHpB;CAKA;;CAED,UAAI,KAAKxB,QAAL,CAAcG,UAAd,CAAyBD,QAAzB,IAAqC,KAAKF,QAAL,CAAcG,UAAd,CAAyB1yB,OAAzB,KAAqC,IAA9E,EACA;CACCxE,QAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,4CAAxB,CADD,EAEC,OAFD,EAGC,KAAKs5B,QAAL,CAAcG,UAAd,CAAyBqB,QAH1B;CAKA;;CAED,UAAI,KAAKxB,QAAL,CAAcI,GAAd,CAAkBF,QAAlB,IAA8B,KAAKF,QAAL,CAAcI,GAAd,CAAkB3yB,OAAlB,KAA8B,IAAhE,EACA;CACCxE,QAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,qCAAxB,CADD,EAEC,OAFD,EAGC,KAAKs5B,QAAL,CAAcI,GAAd,CAAkBoB,QAHnB;CAKA;;CAED,UAAI,KAAKxB,QAAL,CAAcK,IAAd,CAAmBH,QAAnB,IAA+B,KAAKF,QAAL,CAAcK,IAAd,CAAmB5yB,OAAnB,KAA+B,IAAlE,EACA;CACCxE,QAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,sCAAxB,CADD,EAEC,OAFD,EAGC,KAAKs5B,QAAL,CAAcK,IAAd,CAAmBmB,QAHpB;CAKA;;CAED,UAAI,KAAKxB,QAAL,CAAc5R,MAAd,CAAqB8R,QAArB,IAAiC,KAAKF,QAAL,CAAc5R,MAAd,CAAqB3gB,OAArB,KAAiC,IAAtE,EACA;CACCxE,QAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,wCAAxB,CADD,EAEC,OAFD,EAGC,KAAKs5B,QAAL,CAAc5R,MAAd,CAAqBoT,QAHtB;CAKA;;CAED,UAAI,KAAKxB,QAAL,CAAcpU,OAAd,CAAsBsU,QAAtB,IAAkC,KAAKF,QAAL,CAAcpU,OAAd,CAAsBne,OAAtB,KAAkC,IAAxE,EACA;CACCxE,QAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,yCAAxB,CADD,EAEC,OAFD,EAGC,KAAKs5B,QAAL,CAAcpU,OAAd,CAAsB4V,QAHvB;CAKA;;CAED,UAAI,KAAKxB,QAAL,CAAcrvB,IAAd,CAAmBuvB,QAAnB,IAA+B,KAAKF,QAAL,CAAcrvB,IAAd,CAAmBlD,OAAnB,KAA+B,IAAlE,EACA;CACCxE,QAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,sCAAxB,CADD,EAEC,OAFD,EAGC,KAAKs5B,QAAL,CAAcrvB,IAAd,CAAmB6wB,QAHpB;CAKA;;CAED,UAAI,KAAKxB,QAAL,CAActwB,IAAd,CAAmBwwB,QAAnB,IAA+B,KAAKF,QAAL,CAActwB,IAAd,CAAmBjC,OAAnB,KAA+B,IAAlE,EACA;CACCxE,QAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,uCAAxB,CADD,EAEC,OAFD,EAGC,KAAKs5B,QAAL,CAActwB,IAAd,CAAmB8xB,QAHpB;CAKA;;CAED,UAAI,KAAKxB,QAAL,CAAcM,aAAd,CAA4BJ,QAA5B,IAAwC,KAAKF,QAAL,CAAcM,aAAd,CAA4B7yB,OAA5B,KAAwC,IAApF,EACA;CACC,YAAM4zB,QAAQ,GAAG,KAAKnjB,MAAL,CAAYwO,SAAZ,KACd,sDADc,GAEd,qDAFH;CAKAzjB,QAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,MAAM26B,QAA9B,CADD,EAEC,OAFD,EAGC,KAAKrB,QAAL,CAAcM,aAAd,CAA4BkB,QAH7B;CAKA;;CAED,UAAI,KAAKxB,QAAL,CAAcvsB,MAAd,CAAqBysB,QAArB,IAAiC,KAAKF,QAAL,CAAcvsB,MAAd,CAAqBhG,OAArB,KAAiC,IAAtE,EACA;CACCxE,QAAAA,eAAK,CAAChE,IAAN,CACC,KAAKwB,IAAL,CAAUC,aAAV,CAAwB,wCAAxB,CADD,EAEC,OAFD,EAGC,KAAKs5B,QAAL,CAAcvsB,MAAd,CAAqB+tB,QAHtB;CAKA;CACD;CAxZF;CAAA;CAAA,oCA0ZiBC,MA1ZjB,EA2ZC;CACC,aAAOt9B,aAAG,CAACC,UAAJ,CAAe,mCAAf,IAAsDuF,QAAQ,CAAC83B,MAAD,EAAS,EAAT,CAArE;CACA;CA7ZF;CAAA;CAAA,yCAgaC;CAAA;;CACC,UAAIh+B,cAAI,CAACC,WAAL,CAAiB0Z,oBAAjB,CAAJ,EACA;CACC;CACA;;CAED,WAAKC,QAAL,GAAgB,IAAID,oBAAJ,CAAyB,UAACE,OAAD,EACxC;CACC,YAAIA,OAAO,CAAC,CAAD,CAAP,CAAWC,cAAX,KAA8B,IAAlC,EACA;CACC,UAAA,MAAI,CAACmkB,YAAL;CACA,SAHD,MAKA;CACC,UAAA,MAAI,CAACC,SAAL;CACA;CACD,OAVc,EAWf;CACCjkB,QAAAA,SAAS,EAAE,CAAC,CAAD;CADZ,OAXe,CAAhB;CAgBA,WAAKL,QAAL,CAAcM,OAAd,CAAsB,KAAKoiB,WAA3B;CACA;CAvbF;CAAA;CAAA,mCA0bC;CACC,UAAI,CAACn5B,aAAG,CAAC8G,OAAJ,CAAY,KAAK8F,OAAL,EAAZ,CAAL,EACA;CACC5M,QAAAA,aAAG,CAACmN,KAAJ,CAAU,KAAKP,OAAL,EAAV,EAA0B,SAA1B,EAAqC,OAArC;CACA;CACD;CA/bF;CAAA;CAAA,gCAkcC;CACC,UAAI5M,aAAG,CAAC8G,OAAJ,CAAY,KAAK8F,OAAL,EAAZ,CAAJ,EACA;CACC5M,QAAAA,aAAG,CAACmN,KAAJ,CAAU,KAAKP,OAAL,EAAV,EAA0B,SAA1B,EAAqC,MAArC;CACA;CACD;CAvcF;CAAA;CAAA,2CAycwBouB,KAzcxB,EA0cC;CACC,UAAM7G,QAAQ,GAAGn0B,aAAG,CAACyN,WAAJ,CAAgB,KAAK0rB,WAArB,CAAjB;CAEA,UAAMh+B,GAAG,aAAMg5B,QAAQ,CAACh5B,GAAf,OAAT;CACA,UAAI2F,IAAI,aAAMqzB,QAAQ,CAACrzB,IAAf,OAAR;CAEA,UAAMm6B,SAAS,GAAGD,KAAK,CAACE,SAAN,CAAgB,IAAhB,CAAlB;CACAl7B,MAAAA,aAAG,CAACmN,KAAJ,CAAU8tB,SAAV,EAAqB,YAArB,EAAmC,QAAnC;CACAj7B,MAAAA,aAAG,CAACmN,KAAJ,CAAU8tB,SAAV,EAAqB,KAArB,YAA+B9G,QAAQ,CAACh5B,GAAxC;CACA6E,MAAAA,aAAG,CAACmN,KAAJ,CAAU8tB,SAAV,EAAqB,MAArB,YAAgC9G,QAAQ,CAACrzB,IAAzC;CAEAd,MAAAA,aAAG,CAACyD,MAAJ,CAAWw3B,SAAX,EAAsB/5B,QAAQ,CAAC+4B,IAA/B;;CACA,UAAI,KAAKkB,wBAAL,CAA8BF,SAA9B,CAAJ,EACA;CACC,YAAMG,aAAa,GAAGH,SAAS,CAACp6B,qBAAV,EAAtB;CACA,YAAMw6B,WAAW,GAAIr6B,MAAM,CAACM,UAAP,IAAqBJ,QAAQ,CAACC,eAAT,CAAyBI,WAAnE;CACAT,QAAAA,IAAI,aAAMs6B,aAAa,CAACt6B,IAAd,IAAsBs6B,aAAa,CAAC/5B,KAAd,GAAsBg6B,WAAtB,GAAoC,EAA1D,CAAN,OAAJ;CACA;;CACDr7B,MAAAA,aAAG,CAAC6M,MAAJ,CAAWouB,SAAX;CAEAj7B,MAAAA,aAAG,CAACmN,KAAJ,CAAU6tB,KAAV,EAAiB,KAAjB,EAAwB7/B,GAAxB;CACA6E,MAAAA,aAAG,CAACmN,KAAJ,CAAU6tB,KAAV,EAAiB,MAAjB,EAAyBl6B,IAAzB;CACAd,MAAAA,aAAG,CAACmN,KAAJ,CAAU6tB,KAAV,EAAiB,QAAjB,EAA2B,IAA3B;CAEA,WAAKM,mBAAL,CAAyBN,KAAzB;CAEA,aAAOA,KAAP;CACA;CAreF;CAAA;CAAA,6CAue0Br6B,OAve1B,EAweC;CACC,UAAMC,IAAI,GAAGD,OAAO,CAACE,qBAAR,EAAb;CACA,UAAMw6B,WAAW,GAAIr6B,MAAM,CAACM,UAAP,IAAqBJ,QAAQ,CAACC,eAAT,CAAyBI,WAAnE;CAEA,aAAQX,IAAI,CAACS,KAAL,GAAag6B,WAArB;CACA;CA7eF;CAAA;CAAA,gDAgfC;CACC,UAAI,CAAC,KAAKzuB,OAAL,EAAL,EACA;CACC;CACA;;CAED,UAAMunB,QAAQ,GAAGn0B,aAAG,CAACyN,WAAJ,CAAgB,KAAK0rB,WAArB,CAAjB;CAEAn5B,MAAAA,aAAG,CAACmN,KAAJ,CAAU,KAAKP,OAAL,EAAV,EAA0B,KAA1B,YAAoCunB,QAAQ,CAACh5B,GAA7C;CACA;CAzfF;CAAA;CAAA,wCA2fqB6/B,KA3frB,EA4fC;CACC,UAAMO,WAAW,GAAIP,KAAK,CAACl7B,aAAN,CAAoB,4BAApB,CAArB;;CACA,UAAIE,aAAG,CAAC4U,QAAJ,CAAa2mB,WAAW,CAAC/X,gBAAzB,EAA2C,sCAA3C,CAAJ,EACA;CACCxjB,QAAAA,aAAG,CAAC6M,MAAJ,CAAW0uB,WAAW,CAAC/X,gBAAvB;CACA;CACD;CAlgBF;CAAA;CAAA,EAAiC9pB,6BAAjC;;;KCNa8hC,YAAb;CAAA;;CAEC,wBAAYxgC,MAAZ,EACA;CAAA;;CAAA;CACC,8GAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,6BAAvB;;CAEA,UAAKoT,IAAL,GAAYzR,MAAM,CAACyR,IAAnB;CAEA,UAAKgvB,eAAL,GAAuB14B,QAAQ,CAAC/H,MAAM,CAACygC,eAAR,EAAyB,EAAzB,CAA/B;CAEA,UAAK57B,IAAL,GAAY,IAAZ;CATD;CAUC;;CAbF;CAAA;CAAA,6BAgBC;CACC,WAAKA,IAAL,GAAYiC,aAAG,CAACC,MAAhB,ynBAMoD,KAAK05B,eANzD,EAM4E,KAAKhvB,IAAL,CAAUK,IANtF;CAaA,UAAM4uB,QAAQ,GAAG,KAAK77B,IAAL,CAAUC,aAAV,CAAwB,sCAAxB,CAAjB;CACA,UAAM67B,OAAO,GAAG,KAAK97B,IAAL,CAAUC,aAAV,CAAwB,qCAAxB,CAAhB;CACA,UAAM87B,OAAO,GAAG,KAAK/7B,IAAL,CAAUC,aAAV,CAAwB,qCAAxB,CAAhB;CAEAuC,MAAAA,eAAK,CAAChE,IAAN,CAAWq9B,QAAX,EAAqB,OAArB,EAA8B,KAAKG,OAAL,CAAax9B,IAAb,CAAkB,IAAlB,CAA9B;CACAgE,MAAAA,eAAK,CAAChE,IAAN,CAAWs9B,OAAX,EAAoB,OAApB,EAA6B,KAAKG,MAAL,CAAYz9B,IAAZ,CAAiB,IAAjB,CAA7B;CACAgE,MAAAA,eAAK,CAAChE,IAAN,CAAWu9B,OAAX,EAAoB,OAApB,EAA6B,KAAKG,MAAL,CAAY19B,IAAZ,CAAiB,IAAjB,CAA7B;CAEA,aAAO,KAAKwB,IAAZ;CACA;CAvCF;CAAA;CAAA,8BA0CC;CACC,aAAO,KAAKA,IAAZ;CACA;CA5CF;CAAA;CAAA,0CA8CuBK,KA9CvB,EA+CC;CACC,WAAKu7B,eAAL,GAAuB14B,QAAQ,CAAC7C,KAAD,EAAQ,EAAR,CAA/B;;CAEA,UAAI,KAAKL,IAAT,EACA;CACC,aAAKA,IAAL,CAAUC,aAAV,CAAwB,oCAAxB,EACEqK,WADF,aACmB,KAAKsxB,eADxB,cAC2C,KAAKhvB,IAAL,CAAUK,IADrD;CAGA;CACD;CAxDF;CAAA;CAAA,6BA2DC;CACC9M,MAAAA,aAAG,CAAC6M,MAAJ,CAAW,KAAKhN,IAAhB;CAEA,WAAKA,IAAL,GAAY,IAAZ;CACA;CA/DF;CAAA;CAAA,8BAkEC;CACC,WAAK3F,IAAL,CAAU,OAAV;CACA;CApEF;CAAA;CAAA,6BAuEC;CACC,WAAKA,IAAL,CAAU,MAAV;CACA;CAzEF;CAAA;CAAA,6BA4EC;CACC,WAAKA,IAAL,CAAU,MAAV;CACA;CA9EF;CAAA;CAAA,EAAkCR,6BAAlC;;KCMasiC,WAAb;CAAA;;CAEC,uBAAYhhC,MAAZ,EACA;CAAA;;CAAA;CACC,6GAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,4BAAvB;;CAEA,UAAKi6B,WAAL,GAAmBt4B,MAAM,CAACs4B,WAA1B;CACA,UAAKC,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CAEA,UAAK4D,QAAL,GAAgB,IAAI9D,QAAJ,CAAa;CAC5BC,MAAAA,WAAW,EAAE,MAAKA,WADU;CAE5BC,MAAAA,aAAa,EAAE,MAAKA;CAFQ,KAAb,CAAhB;CAKA,UAAK5xB,MAAL,GAAc,KAAd;CAEA,UAAK8K,IAAL,GAAY,IAAI9I,GAAJ,EAAZ;CAEA,UAAKs4B,YAAL,GAAoB,CAApB;CAEA,UAAKC,MAAL,GAAc,IAAd;CAnBD;CAoBC;;CAvBF;CAAA;CAAA,0BAyBOC,SAzBP,EAyBwBC,aAzBxB,EA0BC;CACC,WAAKz6B,MAAL,GAAc,IAAd;CAEA,WAAK06B,OAAL,CAAaD,aAAb;CAEA,WAAKE,UAAL;;CAEA,UAAI,CAAC,KAAK7I,aAAL,CAAmB0I,SAAnB,CAAL,EACA;CACC,aAAKhF,QAAL,CAAcoF,YAAd,CAA2B,KAAKC,UAAL,EAA3B;CACA;;CAED,UAAI,CAACL,SAAS,CAACv1B,UAAV,EAAL,EACA;CACC,aAAK61B,wBAAL,CAA8BN,SAA9B;CAEA,aAAKO,eAAL,CAAqBP,SAArB;CACA;;CAED,WAAK1vB,IAAL,CAAUtK,OAAV,CAAkB,UAAClD,IAAD,EAAgB;CACjCA,QAAAA,IAAI,CAAC09B,kBAAL;CACA,OAFD;CAIA,WAAKC,UAAL;CACA;CAlDF;CAAA;CAAA,2BAqDC;CACC,WAAKj7B,MAAL,GAAc,KAAd;CAEA,WAAKs6B,YAAL,GAAoB,CAApB;CAEA,WAAKY,SAAL;CAEA,WAAKC,SAAL;CACA,WAAKC,YAAL;CACA;CA9DF;CAAA;CAAA,4BAgESX,aAhET,EAiEC;CAAA;;CACC,WAAK3vB,IAAL,GAAY,IAAI9I,GAAJ,EAAZ;CAEA,UAAM5D,KAAK,GAAG,KAAKwzB,aAAL,CAAmByJ,WAAnB,EAAd;CAEAZ,MAAAA,aAAa,CAACj6B,OAAd,CAAsB,UAAC2T,MAAD,EAAoB;CACzC,YAAI/V,KAAK,CAAC6D,GAAN,CAAUkS,MAAV,CAAJ,EACA;CACC,UAAA,MAAI,CAACrJ,IAAL,CAAUvH,GAAV,CAAcnF,KAAK,CAACoa,GAAN,CAAUrE,MAAV,CAAd;CACA;CACD,OALD;CAMA;CA5EF;CAAA;CAAA,+BA+EC;CACC,aAAO,KAAKnU,MAAZ;CACA;CAjFF;CAAA;CAAA,kCAmFe1C,IAnFf,EAoFC;CACC,aAAO,KAAKs0B,aAAL,CAAmBI,UAAnB,GAAgCS,OAAhC,CAAwCn1B,IAAxC,CAAP;CACA;CAtFF;CAAA;CAAA,iCAyFC;CACC,aAAO,+BAAI,KAAKwN,IAAL,CAAU7N,MAAV,EAAJ,EAAwB,KAAKq9B,YAA7B,CAAP;CACA;CA3FF;CAAA;CAAA,6CA6F0BgB,SA7F1B,EA8FC;CAAA;;CACC,WAAKC,iBAAL,CAAuB,KAAKV,UAAL,EAAvB;CAEA,qCAAI,KAAK/vB,IAAL,CAAU7N,MAAV,EAAJ,EAAwBuD,OAAxB,CAAgC,UAAClD,IAAD,EAAak+B,KAAb,EAA+B;CAC9D,YAAIF,SAAS,CAACjwB,KAAV,OAAsB/N,IAAI,CAAC+N,KAAL,EAA1B,EACA;CACC,UAAA,MAAI,CAACivB,YAAL,GAAoBkB,KAApB;CACA;CACD,OALD;CAOA,WAAKC,YAAL;CACA;CAzGF;CAAA;CAAA,iCA4GC;CACC,WAAKF,iBAAL,CAAuB,KAAKV,UAAL,EAAvB;CAEA,WAAKP,YAAL;;CAEA,UAAI,KAAKA,YAAL,GAAoB,CAAxB,EACA;CACC,aAAKA,YAAL,GAAqB,KAAKxvB,IAAL,CAAUK,IAAV,GAAiB,CAAtC;CACA;;CAED,WAAKswB,YAAL;CAEA,UAAMC,WAAW,GAAG,KAAKb,UAAL,EAApB;CAEA,WAAKrF,QAAL,CAAcoF,YAAd,CAA2Bc,WAA3B;CAEA,WAAKX,eAAL,CAAqBW,WAArB;CACA;CA7HF;CAAA;CAAA,iCAgIC;CACC,WAAKH,iBAAL,CAAuB,KAAKV,UAAL,EAAvB;CAEA,WAAKP,YAAL;;CAEA,UAAI,KAAKA,YAAL,KAAsB,KAAKxvB,IAAL,CAAUK,IAApC,EACA;CACC,aAAKmvB,YAAL,GAAoB,CAApB;CACA;;CAED,WAAKmB,YAAL;CAEA,UAAMC,WAAW,GAAG,KAAKb,UAAL,EAApB;CAEA,WAAKrF,QAAL,CAAcoF,YAAd,CAA2Bc,WAA3B;CAEA,WAAKX,eAAL,CAAqBW,WAArB;CACA;CAjJF;CAAA;CAAA,oCAmJiBp+B,IAnJjB,EAoJC;CACCA,MAAAA,IAAI,CAACq+B,yBAAL,CAA+Br+B,IAA/B;CACA;CAtJF;CAAA;CAAA,wCAyJC;CACC,WAAKwN,IAAL,CAAUtK,OAAV,CAAkB,UAAClD,IAAD,EAAgB;CACjCA,QAAAA,IAAI,CAACs+B,2BAAL;CACA,OAFD;CAGA;CA7JF;CAAA;CAAA,iCAgKC;CACC,WAAKhK,aAAL,CAAmBI,UAAnB,GAAgC6J,OAAhC;CACA,WAAKjK,aAAL,CAAmBI,UAAnB,GAAgC8J,kBAAhC,CAAmD,IAAnD;CAEA,UAAM1K,YAAY,GAAG,KAAKQ,aAAL,CAAmBP,eAAnB,EAArB;;CACA,UAAID,YAAJ,EACA;CACCA,QAAAA,YAAY,CAACyK,OAAb;CACAzK,QAAAA,YAAY,CAAC0K,kBAAb,CAAgC,IAAhC;;CAEA,YAAI1K,YAAY,CAACR,aAAb,EAAJ,EACA;CACCQ,UAAAA,YAAY,CAAClC,uBAAb,CAAqCkC,YAAY,CAACjC,mBAAb,EAArC;CACA;CACD;;CAED,WAAKyC,aAAL,CAAmBN,iBAAnB,GACE9wB,OADF,CACU,UAACqlB,MAAD,EAAoB;CAC5BA,QAAAA,MAAM,CAACgW,OAAP;CACAhW,QAAAA,MAAM,CAACiW,kBAAP,CAA0B,IAA1B;;CACA,YAAIjW,MAAM,CAAC+K,aAAP,EAAJ,EACA;CACC/K,UAAAA,MAAM,CAACqJ,uBAAP,CAA+BrJ,MAAM,CAACsJ,mBAAP,EAA/B;CACA;CACD,OARF;CAUA;CA1LF;CAAA;CAAA,gCA6LC;CACC,WAAKyC,aAAL,CAAmBI,UAAnB,GAAgC+J,MAAhC;CAEA,UAAM3K,YAAY,GAAG,KAAKQ,aAAL,CAAmBP,eAAnB,EAArB;;CACA,UAAID,YAAJ,EACA;CACCA,QAAAA,YAAY,CAAC2K,MAAb;CACA;;CAED,WAAKnK,aAAL,CAAmBN,iBAAnB,GACE9wB,OADF,CACU,UAACqlB,MAAD,EAAoB;CAC5BA,QAAAA,MAAM,CAACkW,MAAP;CACA,OAHF;CAKA;CA3MF;CAAA;CAAA,0CA8MC;CACC,WAAKnK,aAAL,CAAmBI,UAAnB,GAAgC3P,mBAAhC;CAEA,UAAM+O,YAAY,GAAG,KAAKQ,aAAL,CAAmBP,eAAnB,EAArB;;CACA,UAAID,YAAJ,EACA;CACCA,QAAAA,YAAY,CAAC/O,mBAAb;CACA;;CAED,WAAKuP,aAAL,CAAmBN,iBAAnB,GACE9wB,OADF,CACU,UAACqlB,MAAD,EAAoB;CAC5BA,QAAAA,MAAM,CAACxD,mBAAP;CACA,OAHF;CAKA;CA5NF;CAAA;CAAA,iCA+NC;CACC,WAAKkY,MAAL,GAAc,IAAIV,YAAJ,CAAiB;CAC9BC,QAAAA,eAAe,EAAE,KAAKQ,YAAL,GAAoB,CADP;CAE9BxvB,QAAAA,IAAI,EAAE,KAAKA;CAFmB,OAAjB,CAAd;CAKA,WAAKyvB,MAAL,CAAYviC,SAAZ,CAAsB,OAAtB,EAA+B,KAAKgkC,IAAL,CAAUt/B,IAAV,CAAe,IAAf,CAA/B;CACA,WAAK69B,MAAL,CAAYviC,SAAZ,CAAsB,MAAtB,EAA8B,KAAKikC,UAAL,CAAgBv/B,IAAhB,CAAqB,IAArB,CAA9B;CACA,WAAK69B,MAAL,CAAYviC,SAAZ,CAAsB,MAAtB,EAA8B,KAAKkkC,UAAL,CAAgBx/B,IAAhB,CAAqB,IAArB,CAA9B;CAEA2B,MAAAA,aAAG,CAACyD,MAAJ,CAAW,KAAKy4B,MAAL,CAAYn6B,MAAZ,EAAX,EAAiCb,QAAQ,CAAC+4B,IAA1C;CAEA,WAAK6D,oBAAL;CACA;CA5OF;CAAA;CAAA,mCA+OC;CACC,UAAI,KAAK5B,MAAT,EACA;CACC,aAAKA,MAAL,CAAY6B,qBAAZ,CAAkC,KAAK9B,YAAL,GAAoB,CAAtD;CACA;CACD;CApPF;CAAA;CAAA,2CAuPC;CACC,UAAM+B,UAAU,GAAGh+B,aAAG,CAACyN,WAAJ,CAAgB,KAAKyuB,MAAL,CAAYtvB,OAAZ,EAAhB,CAAnB;CACA,UAAMqxB,WAAW,GAAGj+B,aAAG,CAACyN,WAAJ,CAAgB,KAAK8lB,aAAL,CAAmBI,UAAnB,GAAgC/mB,OAAhC,EAAhB,CAApB;CAEA,WAAKsvB,MAAL,CAAYtvB,OAAZ,GAAsBO,KAAtB,CAA4BhS,GAA5B,aAAsC8iC,WAAW,CAAC5wB,MAAZ,GAAqB,CAAtB,IAA4B4wB,WAAW,CAAC9iC,GAAZ,GAAkB6iC,UAAU,CAAC3wB,MAAzD,CAArC;CACA,WAAK6uB,MAAL,CAAYtvB,OAAZ,GAAsBO,KAAtB,CAA4BrM,IAA5B,aAAsCm9B,WAAW,CAACn9B,IAAZ,IAAqBk9B,UAAU,CAACpwB,KAAX,GAAmB,CAApB,GAAyB,EAA7C,CAAtC;CACA;CA7PF;CAAA;CAAA,gCAgQC;CACC,WAAKnB,IAAL,CAAUtK,OAAV,CAAkB,UAAClD,IAAD;CAAA,eAAgBA,IAAI,CAACi/B,oBAAL,EAAhB;CAAA,OAAlB;CAEA,WAAKzxB,IAAL,GAAY,IAAI9I,GAAJ,EAAZ;CACA;CApQF;CAAA;CAAA,mCAuQC;CACC,WAAKu4B,MAAL,CAAYrvB,MAAZ;CACA;CAzQF;CAAA;CAAA,kCA2QehN,IA3Qf,EA4QC;CACC,UAAI8F,aAAa,GAAG,KAApB;CAEA,UAAMqf,OAAO,GAAG,KAAKuO,aAAL,CAAmBI,UAAnB,EAAhB;;CAEA,UAAI3O,OAAO,CAACpY,OAAR,GAAkBhH,QAAlB,CAA2B/F,IAA3B,CAAJ,EACA;CACC8F,QAAAA,aAAa,GAAG,IAAhB;CACA;;CAED,UAAMotB,YAAY,GAAG,KAAKQ,aAAL,CAAmBP,eAAnB,EAArB;;CACA,UAAID,YAAY,IAAIA,YAAY,CAACnmB,OAAb,GAAuBhH,QAAvB,CAAgC/F,IAAhC,CAApB,EACA;CACC8F,QAAAA,aAAa,GAAG,IAAhB;CACA;;CAED,UAAI,KAAKu2B,MAAL,IAAe,KAAKA,MAAL,CAAYtvB,OAAZ,GAAsBhH,QAAtB,CAA+B/F,IAA/B,CAAnB,EACA;CACC8F,QAAAA,aAAa,GAAG,IAAhB;CACA;;CAED,WAAK4tB,aAAL,CAAmBN,iBAAnB,GACE9wB,OADF,CACU,UAACqlB,MAAD,EAAoB;CAC5B,YAAIA,MAAM,CAAC5a,OAAP,GAAiBhH,QAAjB,CAA0B/F,IAA1B,CAAJ,EACA;CACC8F,UAAAA,aAAa,GAAG,IAAhB;CACA;CACD,OANF;CASA,aAAOA,aAAP;CACA;CA3SF;CAAA;CAAA,EAAiCjM,6BAAjC;;KCHaykC,WAAb;CAEC,uBAAYnjC,MAAZ,EACA;CAAA;CACC,SAAK6C,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,SAAKy1B,WAAL,GAAmBt4B,MAAM,CAACs4B,WAA1B;CACA,SAAKC,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CAEA,SAAKv1B,YAAL;CACA;;CATF;CAAA;CAAA,mCAYC;CACC,WAAKs1B,WAAL,CAAiB35B,SAAjB,CAA2B,cAA3B,EAA2C,KAAKykC,cAAL,CAAoB//B,IAApB,CAAyB,IAAzB,CAA3C,EADD;CAIC;CAhBF;CAAA;CAAA,mCAkBgB8E,SAlBhB,EAmBC;CAEC;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CA9BF;CAAA;CAAA,iCAgCcA,SAhCd,EAiCC;CAAA;;CACC,UAAMk7B,YAAY,GAAGl7B,SAAS,CAAC4N,OAAV,EAArB;;CACA,UAAI,CAACstB,YAAY,CAACC,YAAlB,EACA;CACC;CACA;;CAED,WAAKzgC,aAAL,CAAmB0gC,gBAAnB,CAAoC;CACnCC,QAAAA,QAAQ,EAAE,KAAKC,mBAAL;CADyB,OAApC,WAES,UAAC9hC,QAAD,EAAc;CACtB,QAAA,KAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAJD;CAKA;CA7CF;CAAA;CAAA,0CAgDC;CAAA,UADoB+hC,SACpB,uEADgC,CAChC;CACC,UAAMC,YAAY,GAAG,EAArB;CAEA,UAAM/L,OAAO,GAAG,KAAKW,aAAL,CAAmBN,iBAAnB,EAAhB;CAEA,UAAInkB,IAAI,GAAG,IAAI4vB,SAAf;CACA9L,MAAAA,OAAO,CAACzwB,OAAR,CAAgB,UAACqlB,MAAD,EAAoB;CACnCA,QAAAA,MAAM,CAAC3Y,OAAP,CAAeC,IAAf;CACA6vB,QAAAA,YAAY,CAACnX,MAAM,CAACxa,KAAP,EAAD,CAAZ,GAA+B;CAC9B8B,UAAAA,IAAI,EAAEA;CADwB,SAA/B;CAGAA,QAAAA,IAAI;CACJ,OAND;CAQA,aAAO6vB,YAAP;CACA;CA/DF;CAAA;CAAA;;KCaaC,eAAb;CAAA;;CAEC,2BAAY5jC,MAAZ,EACA;CAAA;;CAAA;CACC,iHAAMA,MAAN;CAEA,UAAKjB,SAAL,GAAiBiB,MAAM,CAACjB,SAAxB;CACA,UAAKiJ,OAAL,GAAeD,QAAQ,CAAC/H,MAAM,CAACgI,OAAR,EAAiB,EAAjB,CAAvB;CACA,UAAKvB,KAAL,GAAazG,MAAM,CAACyG,KAApB;CACA,UAAKo9B,cAAL,GAAsB7jC,MAAM,CAAC6jC,cAAP,GAAwB7jC,MAAM,CAAC6jC,cAA/B,GAAgD,EAAtE;CAND;CAOC;;CAVF;CAAA;CAAA,kCAYerX,MAZf,EAaC;CAAA;;CACC,WAAKztB,SAAL,CAAe+kC,eAAf,CACC,mBADD,EAEC;CACC97B,QAAAA,OAAO,EAAE,KAAKA,OADf;CAECumB,QAAAA,QAAQ,EAAE/B,MAAM,CAACxa,KAAP;CAFX,OAFD,EAOE1R,IAPF,CAOO,UAACG,SAAD,EAAe;CACpB,YAAIA,SAAJ,EACA;CACCA,UAAAA,SAAS,CAAC9B,SAAV,CAAoB,YAApB,EAAkC,UAACwJ,SAAD,EAA0B;CAC3D47B,YAAAA,QAAQ,CAACC,IAAT,GAAgB,MAAI,CAACv9B,KAAL,CAAW,cAAX,EAA2B9G,GAA3C;CACA,WAFD;CAGA;CACD,OAdF;CAgBA;CA9BF;CAAA;CAAA,yCAiCC;CAAA;;CACC,WAAKZ,SAAL,CAAe+kC,eAAf,CACC,wBADD,EAEC;CAAE97B,QAAAA,OAAO,EAAE,KAAKA;CAAhB,OAFD,EAIE1H,IAJF,CAIO,UAACG,SAAD,EAAe;CACpB,YAAIA,SAAJ,EACA;CACCA,UAAAA,SAAS,CAAC9B,SAAV,CAAoB,eAApB,EAAqC,UAACwJ,SAAD,EAA0B;CAC9D47B,YAAAA,QAAQ,CAACC,IAAT,GAAgB,MAAI,CAACv9B,KAAL,CAAW,MAAX,EAAmB9G,GAAnC;CACA,WAFD;CAGAc,UAAAA,SAAS,CAAC9B,SAAV,CAAoB,WAApB,EAAiC,UAACwJ,SAAD,EAA0B;CAC1D,YAAA,MAAI,CAACjJ,IAAL,CAAU,UAAV,EAAsBiJ,SAAS,CAAC4N,OAAV,EAAtB;CACA,WAFD;CAGA;CACD,OAdF;CAgBA;CAlDF;CAAA;CAAA,sCAoDmByW,MApDnB,EAqDC;CACC,UAAI,KAAKqX,cAAT,EACA;CACC,aAAK9kC,SAAL,CAAeklC,aAAf,CAA6B,KAAKJ,cAAL,CAAoB33B,OAApB,CAA4B,aAA5B,EAA2CsgB,MAAM,CAACxa,KAAP,EAA3C,CAA7B;CACA,OAHD,MAKA;CACC,cAAM,IAAIzJ,KAAJ,CAAU,6CAAV,CAAN;CACA;CACD;CA9DF;CAAA;CAAA,EAAqC7J,6BAArC;;KChBawlC,cAAb;CAEC,0BAAYlkC,MAAZ,EACA;CAAA;CACC,SAAK6C,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,SAAK01B,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA;;CANF;CAAA;CAAA,mCAQgB5d,QARhB,EASC;CAAA;;CACC,UAAM0c,WAAW,GAAG;CACnB8M,QAAAA,SAAS,iCAAMxpB,QAAQ,CAAC/D,IAAT,EAAN;CADU,OAApB;CAIA,WAAK/T,aAAL,CAAmBuhC,iBAAnB,CAAqC/M,WAArC,EACE/2B,IADF,CACO,UAACqB,QAAD,EAAc;CACnBgV,QAAAA,MAAM,CAACC,IAAP,CAAYjV,QAAQ,CAACZ,IAArB,EAA2BoG,OAA3B,CAAmC,UAAC6M,QAAD,EAAsB;CACxDA,UAAAA,QAAQ,GAAGjM,QAAQ,CAACiM,QAAD,EAAW,EAAX,CAAnB;CACA,cAAMsI,MAAM,GAAG3B,QAAQ,CAACwE,GAAT,CAAanL,QAAb,CAAf;CACA,cAAMof,QAAQ,GAAGzxB,QAAQ,CAACZ,IAAT,CAAciT,QAAd,CAAjB;CACAsI,UAAAA,MAAM,CAACxD,cAAP,CAAsBsa,QAAQ,CAACrjB,WAA/B;CACAuM,UAAAA,MAAM,CAACuK,cAAP,CAAsBuM,QAAQ,CAACtM,WAA/B;;CACA,cAAIxK,MAAM,CAACmQ,QAAP,EAAJ,EACA;CACCnQ,YAAAA,MAAM,CAACiT,uBAAP,CAA+B6D,QAAQ,CAACtD,oBAAxC;CACAxT,YAAAA,MAAM,CAACmT,yBAAP,CAAiC2D,QAAQ,CAACrD,sBAA1C;CACA;CACD,SAXD;CAYA,OAdF,WAeQ,UAACpuB,QAAD,EAAc;CACpB,QAAA,KAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAjBF;CAmBA;CAjCF;CAAA;CAAA;;;;;KCuBa0iC,SAAb;CAAA;;CAEC,qBAAYrkC,MAAZ,EACA;CAAA;;CAAA;CACC,2GAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,0BAAvB;;CAEA,UAAKwE,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,UAAKy1B,WAAL,GAAmBt4B,MAAM,CAACs4B,WAA1B;CACA,UAAKC,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA,UAAK+L,cAAL,GAAsBtkC,MAAM,CAACskC,cAA7B;CAEA,UAAKnI,QAAL,GAAgB,IAAI9D,QAAJ,CAAa;CAC5BC,MAAAA,WAAW,EAAE,MAAKA,WADU;CAE5BC,MAAAA,aAAa,EAAE,MAAKA;CAFQ,KAAb,CAAhB;CAKA,UAAKgM,SAAL,GAAiB,IAAI57B,GAAJ,EAAjB;CAEA,UAAK67B,gBAAL,GAAwB,IAAxB;;CAEA,UAAKxhC,YAAL;;CAnBD;CAoBC;;CAvBF;CAAA;CAAA,mCA0BC;CAAA;;CACC,WAAKs1B,WAAL,CAAiB35B,SAAjB,CAA2B,cAA3B,EAA2C,KAAKykC,cAAL,CAAoB//B,IAApB,CAAyB,IAAzB,CAA3C;CACA,WAAKi1B,WAAL,CAAiB35B,SAAjB,CAA2B,kBAA3B,EAA+C,UAACwJ,SAAD,EAA0B;CACxE,YAAMqkB,MAAM,GAAGrkB,SAAS,CAAC4N,OAAV,EAAf;;CACA,QAAA,MAAI,CAAC0uB,cAAL,CAAoBC,YAApB,CAAiClY,MAAM,CAAC9E,gBAAP,EAAjC;;CACA,QAAA,MAAI,CAAC+c,cAAL,CAAoBE,WAApB,CAAgCnY,MAAM,CAACoY,WAAP,EAAhC;CACA,OAJD;CAKA;CAjCF;CAAA;CAAA,mCAmCgBz8B,SAnChB,EAoCC;CACC,UAAM6hB,OAAO,GAAG,KAAKuO,aAAL,CAAmBI,UAAnB,EAAhB;CAEA,UAAMkM,UAAU,GAAG,CAClB7a,OAAO,CAACtC,gBAAR,EADkB,CAAnB;CAGA,UAAMod,SAAS,GAAG,CACjB9a,OAAO,CAAC4a,WAAR,EADiB,EAEjB,KAAKtM,WAAL,CAAiByM,iBAAjB,EAFiB,CAAlB;CAKA,WAAKxM,aAAL,CAAmBgE,UAAnB,GAAgCp1B,OAAhC,CAAwC,UAACqlB,MAAD,EAAY;CACnD,YAAI,CAACA,MAAM,CAAC5gB,UAAP,EAAL,EACA;CACCi5B,UAAAA,UAAU,CAAClgC,IAAX,CAAgB6nB,MAAM,CAAC9E,gBAAP,EAAhB;;CAEA,cAAI8E,MAAM,CAACoY,WAAP,EAAJ,EACA;CACCE,YAAAA,SAAS,CAACngC,IAAV,CAAe6nB,MAAM,CAACoY,WAAP,EAAf;CACA;CACD;CACD,OAVD;CAYA,WAAKH,cAAL,GAAsB,IAAIO,kCAAJ,CAAc;CACnC38B,QAAAA,SAAS,EAAEw8B,UADwB;CAEnCne,QAAAA,QAAQ,EAAEoe,SAFyB;CAGnCG,QAAAA,SAAS,EAAE,0BAHwB;CAInCC,QAAAA,WAAW,EAAE,oBAJsB;CAKnCviB,QAAAA,IAAI,EAAEqiB,kCAAS,CAACG,KALmB;CAMnCC,QAAAA,KAAK,EAAE;CAN4B,OAAd,CAAtB;CASA,WAAKX,cAAL,CAAoB9lC,SAApB,CAA8B,aAA9B,EAA6C,KAAK0mC,iBAAL,CAAuBhiC,IAAvB,CAA4B,IAA5B,CAA7C;CACA,WAAKohC,cAAL,CAAoB9lC,SAApB,CAA8B,OAA9B,EAAuC,KAAK2mC,WAAL,CAAiBjiC,IAAjB,CAAsB,IAAtB,CAAvC;CACA,WAAKohC,cAAL,CAAoB9lC,SAApB,CAA8B,KAA9B,EAAqC,KAAK4mC,SAAL,CAAeliC,IAAf,CAAoB,IAApB,CAArC;CAEA,WAAKohC,cAAL,CAAoB9lC,SAApB,CAA8B,MAA9B,EAAsC,KAAK6mC,SAAL,CAAeniC,IAAf,CAAoB,IAApB,CAAtC;CACA,WAAKohC,cAAL,CAAoB9lC,SAApB,CAA8B,gBAA9B,EAAgD,KAAK8mC,eAAL,CAAqBpiC,IAArB,CAA0B,IAA1B,CAAhD;CACA,WAAKohC,cAAL,CAAoB9lC,SAApB,CAA8B,cAA9B,EAA8C,KAAK+mC,aAAL,CAAmBriC,IAAnB,CAAwB,IAAxB,CAA9C;CACA;CA3EF;CAAA;CAAA,sCA6EmB8E,SA7EnB,EA8EC;CAAA;;CACC,UAAMw9B,oBAAoB,GAAGx9B,SAAS,CAAC4N,OAAV,EAA7B;;CAEA,UAAI,CAAC4vB,oBAAoB,CAACC,MAA1B,EACA;CACC;CACA;;CAED,UAAM9qB,MAAM,GAAG/S,QAAQ,CAAC49B,oBAAoB,CAACC,MAArB,CAA4BxvB,OAA5B,CAAoCvW,EAArC,EAAyC,EAAzC,CAAvB;CAEA,UAAMoE,IAAI,GAAG,KAAKs0B,aAAL,CAAmBsN,gBAAnB,CAAoC/qB,MAApC,CAAb;;CAEA,UAAI,CAAC7W,IAAD,IAASA,IAAI,CAAC8Q,SAAL,EAAT,IAA6B9Q,IAAI,CAAC2H,UAAL,EAAjC,EACA;CACCzD,QAAAA,SAAS,CAAC29B,cAAV;CACA,OAHD,MAKA;CACC,YAAI7hC,IAAI,CAACsjB,eAAL,EAAJ,EACA;CACCtjB,UAAAA,IAAI,CAAC8W,YAAL;CACA;;CAED,YAAMgrB,eAAe,GAAGJ,oBAAoB,CAACI,eAA7C;;CACA,YAAIlkC,cAAI,CAACC,WAAL,CAAiBikC,eAAjB,CAAJ,EACA;CACC59B,UAAAA,SAAS,CAAC29B,cAAV;CAEA;CACA;;CAED,YAAME,cAAc,GAAGj+B,QAAQ,CAACg+B,eAAe,CAAC3vB,OAAhB,CAAwBpC,QAAzB,EAAmC,EAAnC,CAA/B;CACA,YAAMiyB,YAAY,GAAG,KAAK1N,aAAL,CAAmB2N,oBAAnB,CAAwCF,cAAxC,CAArB;;CACA,YAAI,CAACC,YAAL,EACA;CACC99B,UAAAA,SAAS,CAAC29B,cAAV;CAEA;CACA;;CAED,aAAKvB,SAAL,CAAen8B,KAAf;CAEA69B,QAAAA,YAAY,CAAC3G,iBAAb,GACEn4B,OADF,CACU,UAACqT,YAAD,EAAwB;CAChC,cAAIA,YAAY,CAACxI,KAAb,OAAyB/N,IAAI,CAAC+N,KAAL,EAA7B,EACA;CACC,YAAA,MAAI,CAACuyB,SAAL,CAAer6B,GAAf,CAAmBsQ,YAAnB;CACA;CACD,SANF;CASA,YAAM2rB,cAAc,GAAI,KAAK5B,SAAL,CAAezyB,IAAf,GAAsB,CAA9C;;CACA,YAAIq0B,cAAJ,EACA;CACC,eAAKC,eAAL,CAAqBniC,IAArB,EAA2B,KAAKsgC,SAAhC;CACA;;CAED,aAAKhM,aAAL,CAAmB8N,cAAnB,GACEl/B,OADF,CACU,UAACmV,MAAD,EAAoB;CAC5BA,UAAAA,MAAM,CAAC0M,mBAAP;CACA1M,UAAAA,MAAM,CAACC,QAAP,GACEpV,OADF,CACU,UAACm/B,UAAD,EAAsB;CAC9B,gBAAIA,UAAU,CAAC/e,eAAX,EAAJ,EACA;CACC+e,cAAAA,UAAU,CAACvrB,YAAX;CACA;CACD,WANF;CAQA,SAXF;CAcA,aAAK7b,IAAL,CAAU,WAAV;CACA;CACD;CAvJF;CAAA;CAAA,gCAyJaiJ,SAzJb,EA0JC;CACC,WAAKmwB,WAAL,CAAiBiO,yBAAjB;CAEA,UAAMC,cAAc,GAAGr+B,SAAS,CAAC4N,OAAV,EAAvB;CAEA,UAAMgwB,eAAe,GAAGS,cAAc,CAACT,eAAvC;CACA,UAAMC,cAAc,GAAGj+B,QAAQ,CAACg+B,eAAe,CAAC3vB,OAAhB,CAAwBpC,QAAzB,EAAmC,EAAnC,CAA/B;CAEA,UAAMiyB,YAAY,GAAG,KAAK1N,aAAL,CAAmB2N,oBAAnB,CAAwCF,cAAxC,CAArB;CAEA,WAAKzN,aAAL,CACE8N,cADF,GAEEl/B,OAFF,CAEU,UAACmV,MAAD,EAAoB;CAC5B,YAAI,CAACA,MAAM,CAAC9P,WAAP,EAAD,IAAyBy5B,YAAY,CAACj0B,KAAb,OAAyBsK,MAAM,CAACtK,KAAP,EAAtD,EACA;CACC,cAAIsK,MAAM,CAAC5L,OAAP,EAAJ,EACA;CACC4L,YAAAA,MAAM,CAACsa,YAAP;CACAta,YAAAA,MAAM,CAAC2L,mBAAP;CACA3L,YAAAA,MAAM,CAACyL,SAAP;CACA;CACD;CACD,OAZF;CAcA;CAlLF;CAAA;CAAA,8BAoLW5f,SApLX,EAqLC;CAAA;;CACC,UAAMk7B,YAAY,GAAGl7B,SAAS,CAAC4N,OAAV,EAArB;CAEA,UAAM6S,QAAQ,GAAGya,YAAY,CAACuC,MAA9B;CACA,UAAM9qB,MAAM,GAAG/S,QAAQ,CAAC6gB,QAAQ,CAACxS,OAAT,CAAiBvW,EAAlB,EAAsB,EAAtB,CAAvB;CAEA,UAAMoE,IAAI,GAAG,KAAKs0B,aAAL,CAAmBsN,gBAAnB,CAAoC/qB,MAApC,CAAb;;CAEA,UAAI,CAAC7W,IAAL,EACA;CACC;CACA;;CAED,UAAMkiC,cAAc,GAAI,KAAK5B,SAAL,CAAezyB,IAAf,GAAsB,CAA9C;;CACA,UAAIq0B,cAAJ,EACA;CACC,aAAKM,kBAAL,CAAwBxiC,IAAxB,EAA8B,KAAKsgC,SAAnC;CACA;;CAED,WAAKjM,WAAL,CAAiBoO,2BAAjB;CAEA,UAAMX,eAAe,GAAG1C,YAAY,CAAC0C,eAArC;CACA,UAAIzC,YAAY,GAAGD,YAAY,CAACC,YAAhC;;CACA,UAAI,CAACA,YAAL,EACA;CACC,YAAI,KAAKqD,YAAT,EACA;CACC,eAAKA,YAAL,GAAoB,KAApB;CACA,SAHD,MAKA;CACCrD,UAAAA,YAAY,GAAG,KAAKkB,gBAApB;CACA;CACD;;CAED,WAAKA,gBAAL,GAAwB,IAAxB;;CAEA,UAAI,CAAClB,YAAL,EACA;CACCn7B,QAAAA,SAAS,CAAC29B,cAAV;CAEA;CACA;;CAED,UAAME,cAAc,GAAGj+B,QAAQ,CAACg+B,eAAe,CAAC3vB,OAAhB,CAAwBpC,QAAzB,EAAmC,EAAnC,CAA/B;CACA,UAAM4yB,WAAW,GAAG7+B,QAAQ,CAACu7B,YAAY,CAACltB,OAAb,CAAqBpC,QAAtB,EAAgC,EAAhC,CAA5B;CAEA,UAAMiyB,YAAY,GAAG,KAAK1N,aAAL,CAAmB2N,oBAAnB,CAAwCF,cAAxC,CAArB;CACA,UAAMa,SAAS,GAAG,KAAKtO,aAAL,CAAmB2N,oBAAnB,CAAwCU,WAAxC,CAAlB;;CAEA,UAAIX,YAAY,IAAIY,SAApB,EACA;CACC,aAAKC,UAAL,CAAgB7iC,IAAhB,EAAsBgiC,YAAtB,EAAoCY,SAApC,EACEvmC,IADF,CACO,YAAM;CACX,cAAM6lC,cAAc,GAAI,MAAI,CAAC5B,SAAL,CAAezyB,IAAf,GAAsB,CAA9C;;CACA,cAAIq0B,cAAJ,EACA;CACC,YAAA,MAAI,CAACY,cAAL,CAAoB9iC,IAApB,EAA0B,MAAI,CAACsgC,SAA/B,EAA0C0B,YAA1C,EAAwDY,SAAxD;CACA;CACD,SAPF;CAUAZ,QAAAA,YAAY,CAAC/d,oBAAb;CACA2e,QAAAA,SAAS,CAAC3e,oBAAV;CACA;;CAED,UAAI+d,YAAJ,EACA;CACC,aAAK1N,aAAL,CACE8N,cADF,GAEEl/B,OAFF,CAEU,UAACmV,MAAD,EAAoB;CAC5B,cAAI,CAACA,MAAM,CAAC9P,WAAP,EAAD,IAAyBy5B,YAAY,CAACj0B,KAAb,OAAyBsK,MAAM,CAACtK,KAAP,EAAtD,EACA;CACC,gBAAIsK,MAAM,CAAC5L,OAAP,EAAJ,EACA;CACC,kBAAI4L,MAAM,CAACkO,cAAP,KAA0B,CAA1B,IAA+BlO,MAAM,CAAC6K,oBAAP,EAAnC,EACA;CACC7K,gBAAAA,MAAM,CAACqa,mBAAP;CACAra,gBAAAA,MAAM,CAAC0L,YAAP;CACA,eAJD,MAMA;CACC1L,gBAAAA,MAAM,CAACsa,YAAP;CACAta,gBAAAA,MAAM,CAAC2L,mBAAP;CACA;CACD;CACD;CACD,SAnBF;CAqBA;;CAED,WAAKqQ,WAAL,CAAiBkE,qBAAjB;CACA;CAjRF;CAAA;CAAA,8BAmRWr0B,SAnRX,EAoRC;CAAA;;CACC,UAAM6+B,aAAa,GAAG7+B,SAAS,CAAC4N,OAAV,EAAtB;CAEA,UAAM2Q,QAAQ,GAAGsgB,aAAa,CAACtgB,QAA/B;CAEA,UAAMqf,eAAe,GAAGiB,aAAa,CAACjB,eAAtC;CAEA,UAAMC,cAAc,GAAGj+B,QAAQ,CAACg+B,eAAe,CAAC3vB,OAAhB,CAAwBpC,QAAzB,EAAmC,EAAnC,CAA/B;CACA,UAAM4yB,WAAW,GAAG7+B,QAAQ,CAAC2e,QAAQ,CAACtQ,OAAT,CAAiBpC,QAAlB,EAA4B,EAA5B,CAA5B;CAEA,UAAMiyB,YAAY,GAAG,KAAK1N,aAAL,CAAmB2N,oBAAnB,CAAwCF,cAAxC,CAArB;CACA,UAAMa,SAAS,GAAG,KAAKtO,aAAL,CAAmB2N,oBAAnB,CAAwCU,WAAxC,CAAlB;CAEA,UAAMhe,QAAQ,GAAGoe,aAAa,CAACpB,MAA/B;CACA,UAAM9qB,MAAM,GAAG/S,QAAQ,CAAC6gB,QAAQ,CAACxS,OAAT,CAAiBvW,EAAlB,EAAsB,EAAtB,CAAvB;CAEA,UAAMoE,IAAI,GAAG,KAAKs0B,aAAL,CAAmBsN,gBAAnB,CAAoC/qB,MAApC,CAAb;;CAEA,UAAI,KAAKwd,WAAL,CAAiB2O,gBAAjB,CAAkCvgB,QAAlC,CAAJ,EACA;CACC,aAAK4R,WAAL,CAAiB4E,YAAjB,GACE58B,IADF,CACO,UAACksB,MAAD,EAAoB;CACzB,UAAA,MAAI,CAAC0a,mBAAL,CAAyB1a,MAAzB;;CACA,UAAA,MAAI,CAAC2a,MAAL,CAAYlB,YAAZ,EAA0BzZ,MAA1B,EAAkCvoB,IAAlC;;CACA,cAAMkiC,cAAc,GAAI,MAAI,CAAC5B,SAAL,CAAezyB,IAAf,GAAsB,CAA9C;;CACA,cAAIq0B,cAAJ,EACA;CACC,YAAA,MAAI,CAACY,cAAL,CAAoB9iC,IAApB,EAA0B,MAAI,CAACsgC,SAA/B,EAA0C0B,YAA1C,EAAwDzZ,MAAxD;CACA;CACD,SATF;CAWA,OAbD,MAeA;CACC,YAAIyZ,YAAY,IAAIY,SAApB,EACA;CACC,cAAMje,SAAQ,GAAGoe,aAAa,CAACpB,MAA/B;;CACA,cAAM9qB,OAAM,GAAG/S,QAAQ,CAAC6gB,SAAQ,CAACxS,OAAT,CAAiBvW,EAAlB,EAAsB,EAAtB,CAAvB;;CAEA,cAAMoE,KAAI,GAAG,KAAKs0B,aAAL,CAAmBsN,gBAAnB,CAAoC/qB,OAApC,CAAb;;CACA,cAAI7W,KAAJ,EACA;CACC,iBAAK6iC,UAAL,CAAgB7iC,KAAhB,EAAsBgiC,YAAtB,EAAoCY,SAApC,EAA+C,IAA/C,EACEvmC,IADF,CACO,YAAM;CACX,kBAAM6lC,cAAc,GAAI,MAAI,CAAC5B,SAAL,CAAezyB,IAAf,GAAsB,CAA9C;;CACA,kBAAIq0B,cAAJ,EACA;CACC,gBAAA,MAAI,CAACY,cAAL,CAAoB9iC,KAApB,EAA0B,MAAI,CAACsgC,SAA/B,EAA0C0B,YAA1C,EAAwDY,SAAxD;CACA;;CAEDZ,cAAAA,YAAY,CAAC/d,oBAAb;CACA2e,cAAAA,SAAS,CAAC3e,oBAAV;;CAEA,cAAA,MAAI,CAACoQ,WAAL,CAAiBkE,qBAAjB;CACA,aAZF;CAcA;CACD;CACD;;CAED,WAAKjE,aAAL,CACE8N,cADF,GAEEl/B,OAFF,CAEU,UAACmV,MAAD,EAAoB;CAC5B,YAAI,CAACA,MAAM,CAAC9P,WAAP,EAAD,IAAyBy5B,YAAY,CAACj0B,KAAb,OAAyBsK,MAAM,CAACtK,KAAP,EAAtD,EACA;CACC,cAAIsK,MAAM,CAAC5L,OAAP,EAAJ,EACA;CACC,gBAAI4L,MAAM,CAACkO,cAAP,KAA0B,CAA1B,IAA+BlO,MAAM,CAAC6K,oBAAP,EAAnC,EACA;CACC7K,cAAAA,MAAM,CAACqa,mBAAP;CACAra,cAAAA,MAAM,CAAC0L,YAAP;CACA,aAJD,MAMA;CACC1L,cAAAA,MAAM,CAACsa,YAAP;CACAta,cAAAA,MAAM,CAAC2L,mBAAP;CACA;CACD;CACD;CACD,OAnBF;CAqBA;CArWF;CAAA;CAAA,sCAwWC;CACC,WAAK0e,YAAL,GAAoB,IAApB;CACA;CA1WF;CAAA;CAAA,oCA6WC;CACC,WAAKA,YAAL,GAAoB,KAApB;CACA;CA/WF;CAAA;CAAA,+BAiXY1iC,IAjXZ,EAiXwBgiC,YAjXxB,EAiX8CY,SAjX9C,EAiXiEO,SAjXjE,EAkXC;CAAA;;CACC,UAAInB,YAAY,CAACj0B,KAAb,OAAyB60B,SAAS,CAAC70B,KAAV,EAA7B,EACA;CACC,eAAO,KAAKq1B,sBAAL,CAA4B,IAAI1+B,GAAJ,CAAQ,CAAC1E,IAAI,CAAC+N,KAAL,EAAD,CAAR,CAA5B,EAAqDi0B,YAArD,CAAP;CACA,OAHD,MAKA;CACC,YAAM5jC,OAAO,GAAGE,aAAG,CAACC,UAAJ,CAAe,gDAAf,CAAhB;CAEA,eAAO,KAAK8kC,aAAL,CAAmBrB,YAAnB,EAAiC5jC,OAAjC,EACL/B,IADK,CACA,YAAM;CACX,cAAI8mC,SAAJ,EACA;CACCpiC,YAAAA,aAAG,CAACujB,YAAJ,CAAiBtkB,IAAI,CAAC2N,OAAL,EAAjB,EAAiCi1B,SAAS,CAACnd,aAAV,EAAjC;CACA;;CACD,UAAA,MAAI,CAAC6d,0BAAL,CAAgCtjC,IAAhC,EAAsCgiC,YAAtC,EAAoDY,SAApD;;CACA,UAAA,MAAI,CAACW,sBAAL,CAA4B,IAAI7+B,GAAJ,CAAQ,CAAC1E,IAAI,CAAC+N,KAAL,EAAD,CAAR,CAA5B,EAAqDi0B,YAArD,EAAmEY,SAAnE;CACA,SARK,WASC,YAAM;CACZ7hC,UAAAA,aAAG,CAACujB,YAAJ,CACCtkB,IAAI,CAAC2N,OAAL,EADD,EAECq0B,YAAY,CAACve,gBAAb,GAAgC+f,QAAhC,CAAyCxjC,IAAI,CAACqV,OAAL,KAAiB,CAA1D,CAFD;CAIA,SAdK,CAAP;CAgBA;CACD;CA5YF;CAAA;CAAA,qCA8YkBwe,UA9YlB,EA8YsC4P,QA9YtC,EA8YwDzjC,IA9YxD,EA+YC;CAAA;;CACC,WAAKpB,aAAL,CAAmB8kC,cAAnB,CAAkC;CACjC3zB,QAAAA,QAAQ,EAAE0zB,QAAQ,CAAC11B,KAAT,EADuB;CAEjCgR,QAAAA,OAAO,EAAE,CAAC/e,IAAI,CAAC+N,KAAL,EAAD,CAFwB;CAGjCwxB,QAAAA,QAAQ,sCACJ,KAAKoE,aAAL,CAAmBF,QAAQ,CAAChgB,gBAAT,EAAnB,EAAgD,IAAI/e,GAAJ,CAAQ,CAAC1E,IAAI,CAAC+N,KAAL,EAAD,CAAR,CAAhD,EAAyE,IAAzE,CADI,GAEJ,KAAK41B,aAAL,CAAmB9P,UAAU,CAACpQ,gBAAX,EAAnB,EAAkD,IAAI/e,GAAJ,EAAlD,EAA6D,IAA7D,CAFI;CAHyB,OAAlC,EAQErI,IARF,CAQO,YAAM;CACX,QAAA,MAAI,CAACunC,oBAAL,CAA0B/P,UAA1B,EAAsC4P,QAAtC;CACA,OAVF,WAWQ,UAAC/lC,QAAD,EAAc;CACpB,QAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAbF;CAeA;CA/ZF;CAAA;CAAA,kCAiae2a,MAjaf,EAia+Bja,OAja/B,EAkaC;CACC,aAAO,IAAIrB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvC,YAAIob,MAAM,CAACmQ,QAAP,EAAJ,EACA;CACChqB,UAAAA,gCAAU,CAAC2vB,OAAX,CACC/vB,OADD,EAEC,UAACgwB,UAAD,EAAgB;CACfA,YAAAA,UAAU,CAAC5yB,KAAX;CACAwB,YAAAA,OAAO;CACP,WALF,EAMCsB,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAND,EAOC,UAAC6vB,UAAD,EAAgB;CACfA,YAAAA,UAAU,CAAC5yB,KAAX;CACAyB,YAAAA,MAAM;CACN,WAVF;CAYA,SAdD,MAgBA;CACCD,UAAAA,OAAO;CACP;CACD,OApBM,CAAP;CAqBA;CAxbF;CAAA;CAAA,mCA0bgB6mC,QA1bhB,EA0bgCvD,SA1bhC,EA0bsDzM,UA1btD,EA0b0E4P,QA1b1E,EA2bC;CAAA;;CACC,UAAMK,wBAAwB,GAAIjQ,UAAU,CAAC9lB,KAAX,OAAuB01B,QAAQ,CAAC11B,KAAT,EAAzD;CAEA,UAAMg2B,eAAe,GAAG,+BAAIzD,SAAS,CAAC3gC,MAAV,EAAJ,EACtBkQ,IADsB,CACjB,UAACkb,KAAD,EAAcC,MAAd,EAA+B;CACpC,YAAID,KAAK,CAAC1V,OAAN,KAAkB2V,MAAM,CAAC3V,OAAP,EAAtB,EAAwC,OAAO,CAAP;CACxC,YAAI0V,KAAK,CAAC1V,OAAN,KAAkB2V,MAAM,CAAC3V,OAAP,EAAtB,EAAwC,OAAO,CAAC,CAAR;CACxC,OAJsB,CAAxB;CAOA,UAAM2uB,WAAW,GAAG,IAAIt/B,GAAJ,EAApB;CACAq/B,MAAAA,eAAe,CACb7gC,OADF,CACU,UAAC+gC,WAAD,EAAuB;CAC/BD,QAAAA,WAAW,CAAC/9B,GAAZ,CAAgBg+B,WAAW,CAACl2B,KAAZ,EAAhB;CACA01B,QAAAA,QAAQ,CAAC3Q,mBAAT,CAA6BmR,WAAW,CAACt2B,OAAZ,EAA7B,EAAoDk2B,QAAQ,CAACl2B,OAAT,EAApD;;CACA,YAAI,CAACm2B,wBAAL,EACA;CACC,UAAA,MAAI,CAACR,0BAAL,CAAgCW,WAAhC,EAA6CpQ,UAA7C,EAAyD4P,QAAzD;CACA;CACD,OARF;;CAWA,UAAIK,wBAAJ,EACA;CACC,aAAKV,sBAAL,CAA4BY,WAA5B,EAAyCnQ,UAAzC;CACA,OAHD,MAKA;CACC,aAAK0P,sBAAL,CAA4BS,WAA5B,EAAyCnQ,UAAzC,EAAqD4P,QAArD;CACA;CACD;CAzdF;CAAA;CAAA,oCA2diBzjC,IA3djB,EA2d6BsgC,SA3d7B,EA4dC;CAECv/B,MAAAA,aAAG,CAACgI,QAAJ,CAAa/I,IAAI,CAAC2N,OAAL,EAAb,EAA8B2yB,SAAS,CAACzyB,IAAV,GAAiB,CAAjB,GAAqB,sBAArB,GAA8C,iBAA5E;CAEAyyB,MAAAA,SAAS,CACPp9B,OADF,CACU,UAAC2gC,QAAD,EAAoB;CAC5B9iC,QAAAA,aAAG,CAACgI,QAAJ,CAAa86B,QAAQ,CAACl2B,OAAT,EAAb,EAAiC,wBAAjC;CACA,OAHF;CAKA;CAreF;CAAA;CAAA,uCAueoB3N,IAvepB,EAuegCsgC,SAvehC,EAweC;CAECv/B,MAAAA,aAAG,CAACiI,WAAJ,CAAgBhJ,IAAI,CAAC2N,OAAL,EAAhB,EAAgC,iBAAhC;CACA5M,MAAAA,aAAG,CAACiI,WAAJ,CAAgBhJ,IAAI,CAAC2N,OAAL,EAAhB,EAAgC,sBAAhC;CAEA2yB,MAAAA,SAAS,CACPp9B,OADF,CACU,UAAC2gC,QAAD,EAAoB;CAC5B9iC,QAAAA,aAAG,CAACiI,WAAJ,CAAgB66B,QAAQ,CAACl2B,OAAT,EAAhB,EAAoC,wBAApC;CACA,OAHF;CAKA;CAlfF;CAAA;CAAA,wCAofqB4a,MApfrB,EAqfC;CACC,UAAI,CAACA,MAAM,CAAC5gB,UAAP,EAAL,EACA;CACC,aAAK64B,cAAL,CAAoBC,YAApB,CAAiClY,MAAM,CAAC9E,gBAAP,EAAjC;CACA,aAAK+c,cAAL,CAAoBE,WAApB,CAAgCnY,MAAM,CAACoY,WAAP,EAAhC;CACA;CACD;CA3fF;CAAA;CAAA,6BA6fU3gC,IA7fV,EA6fsBovB,MA7ftB,EA8fC;CAAA;;CACC,UAAM/W,MAAM,GAAG,KAAKic,aAAL,CAAmB4P,kBAAnB,CAAsClkC,IAAI,CAAC+N,KAAL,EAAtC,CAAf;CAEA,UAAMo2B,UAAU,GAAG,EAAnB;;CAEA,UAAI,CAAC9rB,MAAM,CAAC+rB,WAAP,CAAmBpkC,IAAnB,CAAL,EACA;CACCmkC,QAAAA,UAAU,CAACzjC,IAAX,CAAgB;CACf2jC,UAAAA,IAAI,EAAE/lC,aAAG,CAACC,UAAJ,CAAe,kCAAf,CADS;CAEf+lC,UAAAA,OAAO,EAAE,iBAAC3pC,KAAD,EAAQ4pC,QAAR,EAAqB;CAC7B,gBAAMriB,cAAc,GAAG7J,MAAM,CAACgjB,iBAAP,EAAvB;CAEA,gBAAMmJ,WAAW,GAAG,+BAAItiB,cAAc,CAACviB,MAAf,EAAJ,EAA6BkQ,IAA7B,CAAkC,UAACkb,KAAD,EAAcC,MAAd,EAA+B;CACpF,kBAAID,KAAK,CAAC1V,OAAN,KAAkB2V,MAAM,CAAC3V,OAAP,EAAtB,EAAwC,OAAO,CAAP;CACxC,kBAAI0V,KAAK,CAAC1V,OAAN,KAAkB2V,MAAM,CAAC3V,OAAP,EAAtB,EAAwC,OAAO,CAAC,CAAR;CACxC,aAHmB,CAApB;CAIA,gBAAMovB,cAAc,GAAG,IAAI//B,GAAJ,EAAvB;CAEA8/B,YAAAA,WAAW,CAACthC,OAAZ,CAAoB,UAACwhC,aAAD,EAAyB;CAC5CD,cAAAA,cAAc,CAACx+B,GAAf,CAAmBy+B,aAAa,CAAC32B,KAAd,EAAnB;;CACA,kBAAI22B,aAAa,CAACl0B,YAAd,MAAgCk0B,aAAa,CAACphB,eAAd,EAApC,EACA;CACCohB,gBAAAA,aAAa,CAAC5tB,YAAd;CACA;;CACD,cAAA,MAAI,CAAC6tB,YAAL,CAAkBD,aAAlB,EAAiCrsB,MAAM,CAACoL,gBAAP,EAAjC,EAA4D,KAA5D;;CACAihB,cAAAA,aAAa,CAACE,gBAAd;CACA,aARD;;CAUA,YAAA,MAAI,CAAC1M,QAAL,CAAcoF,YAAd,CAA2BkH,WAAW,CAAC7kC,MAAZ,GAAqBklC,IAArB,GAA4B5jC,KAAvD;;CAEA,YAAA,MAAI,CAACrC,aAAL,CAAmB8kC,cAAnB,CAAkC;CACjCnE,cAAAA,QAAQ,EAAE,MAAI,CAACoE,aAAL,CAAmBtrB,MAAM,CAACoL,gBAAP,EAAnB,EAA8CghB,cAA9C;CADuB,aAAlC,WAES,UAAC/mC,QAAD,EAAc;CACtB,cAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,aAJD;;CAMA2a,YAAAA,MAAM,CAAC0M,mBAAP;CAEAwf,YAAAA,QAAQ,CAACO,aAAT,GAAyBtpC,KAAzB;CACA;CAhCc,SAAhB;CAkCA;;CACD,UAAI,CAAC6c,MAAM,CAAC0sB,UAAP,CAAkB/kC,IAAlB,CAAL,EACA;CACCmkC,QAAAA,UAAU,CAACzjC,IAAX,CAAgB;CACf2jC,UAAAA,IAAI,EAAE/lC,aAAG,CAACC,UAAJ,CAAe,oCAAf,CADS;CAEf+lC,UAAAA,OAAO,EAAE,iBAAC3pC,KAAD,EAAQ4pC,QAAR,EAAqB;CAC7B,gBAAMriB,cAAc,GAAG7J,MAAM,CAACgjB,iBAAP,EAAvB;CAEA,gBAAMmJ,WAAW,GAAG,+BAAItiB,cAAc,CAACviB,MAAf,EAAJ,EAA6BkQ,IAA7B,CAAkC,UAACkb,KAAD,EAAcC,MAAd,EAA+B;CACpF,kBAAID,KAAK,CAAC1V,OAAN,KAAkB2V,MAAM,CAAC3V,OAAP,EAAtB,EAAwC,OAAO,CAAP;CACxC,kBAAI0V,KAAK,CAAC1V,OAAN,KAAkB2V,MAAM,CAAC3V,OAAP,EAAtB,EAAwC,OAAO,CAAC,CAAR;CACxC,aAHmB,CAApB;CAKA,gBAAMovB,cAAc,GAAG,IAAI//B,GAAJ,EAAvB;CACA8/B,YAAAA,WAAW,CAACthC,OAAZ,CAAoB,UAACwhC,aAAD,EAAyB;CAC5CD,cAAAA,cAAc,CAACx+B,GAAf,CAAmBy+B,aAAa,CAAC32B,KAAd,EAAnB;;CACA,kBAAI22B,aAAa,CAACl0B,YAAd,MAAgCk0B,aAAa,CAACphB,eAAd,EAApC,EACA;CACCohB,gBAAAA,aAAa,CAAC5tB,YAAd;CACA;;CACD,cAAA,MAAI,CAACkuB,cAAL,CAAoBN,aAApB,EAAmCrsB,MAAM,CAACoL,gBAAP,EAAnC,EAA8D,KAA9D;;CACAihB,cAAAA,aAAa,CAACE,gBAAd;CACA,aARD;;CAUA,YAAA,MAAI,CAAC1M,QAAL,CAAcoF,YAAd,CAA2BkH,WAAW,CAAC7kC,MAAZ,GAAqBklC,IAArB,GAA4B5jC,KAAvD;;CAEA,YAAA,MAAI,CAACrC,aAAL,CAAmB8kC,cAAnB,CAAkC;CACjCnE,cAAAA,QAAQ,EAAE,MAAI,CAACoE,aAAL,CAAmBtrB,MAAM,CAACoL,gBAAP,EAAnB,EAA8CghB,cAA9C;CADuB,aAAlC,WAES,UAAC/mC,QAAD,EAAc;CACtB,cAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,aAJD;;CAMA2a,YAAAA,MAAM,CAAC0M,mBAAP;CAEAwf,YAAAA,QAAQ,CAACO,aAAT,GAAyBtpC,KAAzB;CACA;CAhCc,SAAhB;CAkCA;;CAED,WAAKypC,gBAAL,CAAsBjlC,IAAtB,EAA4BovB,MAA5B,EAAoC+U,UAApC;CACA;CA/kBF;CAAA;CAAA,iCAilBcnkC,IAjlBd,EAilB0BwjB,aAjlB1B,EAklBC;CAAA,UADwC0hB,UACxC,uEADqD,IACrD;CACCnkC,MAAAA,aAAG,CAACujB,YAAJ,CAAiBtkB,IAAI,CAAC2N,OAAL,EAAjB,EAAiC6V,aAAa,CAACzW,iBAA/C;;CAEA,UAAIm4B,UAAJ,EACA;CACC,aAAKC,eAAL,CAAqBnlC,IAArB,EAA2BwjB,aAA3B;CACA;CACD;CAzlBF;CAAA;CAAA,mCA2lBgBxjB,IA3lBhB,EA2lBsBwjB,aA3lBtB,EA4lBC;CAAA,UADoC0hB,UACpC,uEADiD,IACjD;CACCnkC,MAAAA,aAAG,CAACujB,YAAJ,CAAiBtkB,IAAI,CAAC2N,OAAL,EAAjB,EAAiC6V,aAAa,CAACe,gBAA/C;;CAEA,UAAI2gB,UAAJ,EACA;CACC,aAAKC,eAAL,CAAqBnlC,IAArB,EAA2BwjB,aAA3B;CACA;CACD;CAnmBF;CAAA;CAAA,oCAqmBiBxjB,IArmBjB,EAqmB6BwjB,aArmB7B,EAsmBC;CAAA;;CACC,WAAK5kB,aAAL,CAAmB8kC,cAAnB,CAAkC;CACjC3kB,QAAAA,OAAO,EAAE,CAAC/e,IAAI,CAAC+N,KAAL,EAAD,CADwB;CAEjCwxB,QAAAA,QAAQ,sBACJ,KAAKoE,aAAL,CAAmBngB,aAAnB,EAAkC,IAAI9e,GAAJ,CAAQ,CAAC1E,IAAI,CAAC+N,KAAL,EAAD,CAAR,CAAlC,CADI;CAFyB,OAAlC,WAKS,UAACrQ,QAAD,EAAc;CACtB,QAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAPD;CAQA;CA/mBF;CAAA;CAAA,2CAinBwBqhB,OAjnBxB,EAinB4C1G,MAjnB5C,EAknBC;CAAA;;CACC,aAAO,KAAKzZ,aAAL,CAAmB8kC,cAAnB,CAAkC;CACxCnE,QAAAA,QAAQ,EAAE,KAAKoE,aAAL,CAAmBtrB,MAAM,CAACoL,gBAAP,EAAnB,EAA8C1E,OAA9C;CAD8B,OAAlC,WAEE,UAACrhB,QAAD,EAAc;CACtB,QAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAJM,CAAP;CAKA;CAxnBF;CAAA;CAAA,2CA0nBwBqhB,OA1nBxB,EA0nB4CijB,YA1nB5C,EA0nBkEY,SA1nBlE,EA2nBC;CAAA;;CACC,WAAKhkC,aAAL,CAAmB8kC,cAAnB,CAAkC;CACjC3zB,QAAAA,QAAQ,EAAE6yB,SAAS,CAAC70B,KAAV,EADuB;CAEjCgR,QAAAA,OAAO,EAAEqmB,KAAK,CAACC,IAAN,CAAWtmB,OAAX,CAFwB;CAGjCwgB,QAAAA,QAAQ,EAAE,KAAKoE,aAAL,CAAmBf,SAAS,CAACnf,gBAAV,EAAnB,EAAiD1E,OAAjD,EAA0D,IAA1D;CAHuB,OAAlC,EAKE1iB,IALF,CAKO;CAAA,eAAM,OAAI,CAACunC,oBAAL,CAA0B5B,YAA1B,EAAwCY,SAAxC,CAAN;CAAA,OALP,WAMQ,UAACllC,QAAD;CAAA,eAAc,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC,CAAd;CAAA,OANR;CAQA;CApoBF;CAAA;CAAA,yCAsoBsBskC,YAtoBtB,EAsoB4CY,SAtoB5C,EAuoBC;CACC,UAAMlsB,QAAQ,GAAG,IAAIhT,GAAJ,EAAjB;CAEAgT,MAAAA,QAAQ,CAAC5I,GAAT,CAAak0B,YAAY,CAACj0B,KAAb,EAAb,EAAmCi0B,YAAnC;;CACA,UAAIY,SAAJ,EACA;CACClsB,QAAAA,QAAQ,CAAC5I,GAAT,CAAa80B,SAAS,CAAC70B,KAAV,EAAb,EAAgC60B,SAAhC;CACA;;CAED,WAAKvC,cAAL,CAAoBiF,cAApB,CAAmC5uB,QAAnC;CACA;CAjpBF;CAAA;CAAA,kCAmpBetS,SAnpBf,EAmpB0BmhC,eAnpB1B,EAopBC;CAAA;;CAAA,UADgDC,mBAChD,uEADsE,KACtE;CACC,UAAM9F,YAAY,GAAG,EAArB;CAEA,UAAM5+B,KAAK,kCAAOsD,SAAS,CAACnB,gBAAV,CAA2B,aAA3B,CAAP,CAAX;CACA,UAAI4M,IAAI,GAAG,CAAX;CACA/O,MAAAA,KAAK,CAACoC,OAAN,CAAc,UAACyhB,QAAD,EAAc;CAC3B,YAAM9N,MAAM,GAAG/S,QAAQ,CAAC6gB,QAAQ,CAACxS,OAAT,CAAiBvW,EAAlB,EAAsB,EAAtB,CAAvB;;CACA,YAAMoE,IAAI,GAAG,OAAI,CAACs0B,aAAL,CAAmBsN,gBAAnB,CAAoC/qB,MAApC,CAAb;;CACA,YAAI7W,IAAI,IAAI,CAACA,IAAI,CAAC8Q,SAAL,EAAb,EACA;CACC,cAAMnB,KAAK,GAAG5M,cAAI,CAACsC,SAAL,EAAd;CACA,cAAIogC,aAAa,GAAI51B,IAAI,KAAK7P,IAAI,CAACqV,OAAL,EAA9B;CACArV,UAAAA,IAAI,CAAC4P,OAAL,CAAaC,IAAb;CACA6vB,UAAAA,YAAY,CAAC7oB,MAAD,CAAZ,GAAuB;CACtBhH,YAAAA,IAAI,EAAEA;CADgB,WAAvB;;CAGA,cAAI21B,mBAAJ,EACA;CACC9F,YAAAA,YAAY,CAAC7oB,MAAD,CAAZ,CAAqB9G,QAArB,GAAgC3L,SAAS,CAAC+N,OAAV,CAAkBpC,QAAlD;CACA01B,YAAAA,aAAa,GAAG,IAAhB;CACA;;CACD,cAAIA,aAAa,IAAIF,eAAjB,IAAoCA,eAAe,CAAC5gC,GAAhB,CAAoBkS,MAApB,CAAxC,EACA;CACC6oB,YAAAA,YAAY,CAAC7oB,MAAD,CAAZ,CAAqBlH,KAArB,GAA6BA,KAA7B;CACA+vB,YAAAA,YAAY,CAAC7oB,MAAD,CAAZ,CAAqB6uB,aAArB,GAAqC7uB,MAArC;CACA;;CACD8N,UAAAA,QAAQ,CAACxS,OAAT,CAAiBtC,IAAjB,GAAwBA,IAAxB;CAEAA,UAAAA,IAAI;CACJ;CACD,OAzBD;CA2BA,WAAK5U,IAAL,CAAU,eAAV,EAA2BykC,YAA3B;CAEA,aAAOA,YAAP;CACA;CAvrBF;CAAA;CAAA,gCAyrBarnB,MAzrBb,EA0rBC;CAAA;;CACC,UAAIxI,IAAI,GAAG,CAAX;CACA,qCAAIwI,MAAM,CAACoL,gBAAP,GAA0BxgB,gBAA1B,CAA2C,aAA3C,CAAJ,EACEC,OADF,CACU,UAACyhB,QAAD,EAA2B;CACnC,YAAM9N,MAAM,GAAG/S,QAAQ,CAAC6gB,QAAQ,CAACxS,OAAT,CAAiBvW,EAAlB,EAAsB,EAAtB,CAAvB;;CACA,YAAMoE,IAAI,GAAG,OAAI,CAACs0B,aAAL,CAAmBsN,gBAAnB,CAAoC/qB,MAApC,CAAb;;CACA,YAAI7W,IAAI,IAAI,CAACA,IAAI,CAAC8Q,SAAL,EAAb,EACA;CACC9Q,UAAAA,IAAI,CAAC4P,OAAL,CAAaC,IAAb;CACAA,UAAAA,IAAI;CACJ;CACD,OATF;CAWA;CAvsBF;CAAA;CAAA,wCAysBqBgkB,UAzsBrB,EAysByC7zB,IAzsBzC,EAysBqD2lC,YAzsBrD,EAysB4EC,UAzsB5E,EA0sBC;CAAA;;CACC,UAAMC,cAAc,GAAIjoC,cAAI,CAAC8L,MAAL,CAAYi8B,YAAZ,CAAxB;CAEA,UAAMhS,OAAO,GAAIkS,cAAc,GAAG,KAAKvR,aAAL,CAAmBwR,6BAAnB,CAAiDjS,UAAjD,CAAH,GAAkE,IAAjG;;CAEA,UAAIgS,cAAJ,EACA;CACC,YAAIlS,OAAO,CAAC9lB,IAAR,GAAe,CAAnB,EACA;CACC,eAAKk4B,qBAAL,CAA2BlS,UAA3B,EAAuC7zB,IAAvC,EAA6C4lC,UAA7C;CACA,SAHD,MAKA;CACC,cAAIjS,OAAO,CAAC9lB,IAAR,KAAiB,CAArB,EACA;CACC,iBAAKwmB,WAAL,CAAiB4E,YAAjB,GAAgC58B,IAAhC,CAAqC,UAACksB,MAAD,EAAoB;CACxD,cAAA,OAAI,CAACyd,mBAAL,CAAyBnS,UAAzB,EAAqCtL,MAArC,EAA6CvoB,IAA7C,EAAmD,IAAnD,EAAyD,KAAzD;CACA,aAFD;CAGA,WALD,MAOA;CACC2zB,YAAAA,OAAO,CAACzwB,OAAR,CAAgB,UAACqlB,MAAD,EAAoB;CACnC,cAAA,OAAI,CAACyd,mBAAL,CAAyBnS,UAAzB,EAAqCtL,MAArC,EAA6CvoB,IAA7C,EAAmD,IAAnD,EAAyD,KAAzD;CACA,aAFD;CAGA;CACD;CACD,OArBD,MAuBA;CACC,YAAM5B,OAAO,GAAGE,aAAG,CAACC,UAAJ,CAAe,iDAAf,CAAhB;CAEA,aAAK8kC,aAAL,CAAmBxP,UAAnB,EAA+Bz1B,OAA/B,EACE/B,IADF,CACO,YAAM;CACX,UAAA,OAAI,CAAC2pC,mBAAL,CAAyBnS,UAAzB,EAAqC8R,YAArC,EAAmD3lC,IAAnD,EAAyD,KAAzD,EAAgE,KAAhE;CACA,SAHF,WAIQ,YAAM,EAJd;CAMA;CACD;CAhvBF;CAAA;CAAA,wCAkvBqB6zB,UAlvBrB,EAkvByC4P,QAlvBzC,EAkvB2DzjC,IAlvB3D,EAmvBC;CAAA;;CAAA,UADuEimC,KACvE,uEAD+E,IAC/E;CAAA,UADqFC,MACrF,uEAD8F,IAC9F;CACC,UAAMhkB,cAAc,GAAG2R,UAAU,CAACwH,iBAAX,EAAvB;;CAEA,UAAIr7B,IAAI,IAAI,CAACkiB,cAAc,CAACvd,GAAf,CAAmB3E,IAAI,CAAC+N,KAAL,EAAnB,CAAb,EACA;CACCmU,QAAAA,cAAc,CAACpU,GAAf,CAAmB9N,IAAI,CAAC+N,KAAL,EAAnB,EAAiC/N,IAAjC;CACA;;CAED,UAAMwkC,WAAW,GAAG,+BAAItiB,cAAc,CAACviB,MAAf,EAAJ,EAA6BkQ,IAA7B,CAAkC,UAACkb,KAAD,EAAcC,MAAd,EAA+B;CACpF,YAAIib,KAAJ,EACA;CACC,cAAIlb,KAAK,CAAC1V,OAAN,KAAkB2V,MAAM,CAAC3V,OAAP,EAAtB,EAAwC,OAAO,CAAP;CACxC,cAAI0V,KAAK,CAAC1V,OAAN,KAAkB2V,MAAM,CAAC3V,OAAP,EAAtB,EAAwC,OAAO,CAAC,CAAR;CACxC,SAJD,MAMA;CACC,cAAI0V,KAAK,CAAC1V,OAAN,KAAkB2V,MAAM,CAAC3V,OAAP,EAAtB,EAAwC,OAAO,CAAP;CACxC,cAAI0V,KAAK,CAAC1V,OAAN,KAAkB2V,MAAM,CAAC3V,OAAP,EAAtB,EAAwC,OAAO,CAAC,CAAR;CACxC;CACD,OAXmB,CAApB;CAaA,UAAMovB,cAAc,GAAG,IAAI//B,GAAJ,EAAvB;CAEA8/B,MAAAA,WAAW,CAACthC,OAAZ,CAAoB,UAACwhC,aAAD,EAAyB;CAC5C,QAAA,OAAI,CAACxB,MAAL,CAAYrP,UAAZ,EAAwB4P,QAAxB,EAAkCiB,aAAlC,EAAiDuB,KAAjD,EAAwDC,MAAxD;;CACAzB,QAAAA,cAAc,CAACx+B,GAAf,CAAmBy+B,aAAa,CAAC32B,KAAd,EAAnB;CACA22B,QAAAA,aAAa,CAACE,gBAAd;CACA,OAJD;CAMA,WAAK1M,QAAL,CAAcoF,YAAd,CAA2BkH,WAAW,CAAC7kC,MAAZ,GAAqBklC,IAArB,GAA4B5jC,KAAvD;CAEA,WAAKrC,aAAL,CAAmB8kC,cAAnB,CAAkC;CACjC3zB,QAAAA,QAAQ,EAAE0zB,QAAQ,CAAC11B,KAAT,EADuB;CAEjCgR,QAAAA,OAAO,EAAEqmB,KAAK,CAACC,IAAN,CAAWZ,cAAX,CAFwB;CAGjClF,QAAAA,QAAQ,sCACJ,KAAKoE,aAAL,CAAmBF,QAAQ,CAAChgB,gBAAT,EAAnB,EAAgDghB,cAAhD,EAAgE,IAAhE,CADI,GAEJ,KAAKd,aAAL,CAAmB9P,UAAU,CAACpQ,gBAAX,EAAnB,EAAkD,IAAI/e,GAAJ,EAAlD,EAA6D,IAA7D,CAFI;CAHyB,OAAlC,EAQErI,IARF,CAQO,YAAM;CACX,QAAA,OAAI,CAACunC,oBAAL,CAA0B/P,UAA1B,EAAsC4P,QAAtC;CACA,OAVF,WAWQ,UAAC/lC,QAAD,EAAc;CACpB,QAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAbF;CAgBAm2B,MAAAA,UAAU,CAAC9O,mBAAX;CACA0e,MAAAA,QAAQ,CAAC1e,mBAAT;CACA;CApyBF;CAAA;CAAA,2BAsyBQ8O,UAtyBR,EAsyB4B4P,QAtyB5B,EAsyB8CzjC,IAtyB9C,EAuyBC;CAAA,UADyDimC,KACzD,uEADiE,IACjE;CAAA,UADuEC,MACvE,uEADgF,IAChF;CACC,UAAMvhB,QAAQ,GAAG3kB,IAAI,CAAC2N,OAAL,EAAjB;CACA,UAAMw4B,cAAc,GAAG1C,QAAQ,CAAChgB,gBAAT,EAAvB;;CAEA,UAAIzjB,IAAI,CAACwQ,YAAL,MAAuBxQ,IAAI,CAACsjB,eAAL,EAA3B,EACA;CACCtjB,QAAAA,IAAI,CAAC8W,YAAL;CACA;;CAED,UAAImvB,KAAJ,EACA;CACCllC,QAAAA,aAAG,CAACujB,YAAJ,CAAiBK,QAAjB,EAA2BwhB,cAAc,CAAC5hB,gBAA1C;CACA,OAHD,MAKA;CACCxjB,QAAAA,aAAG,CAACujB,YAAJ,CAAiBK,QAAjB,EAA2BwhB,cAAc,CAACp5B,iBAA1C;CACA;;CAED,WAAKu2B,0BAAL,CAAgCtjC,IAAhC,EAAsC6zB,UAAtC,EAAkD4P,QAAlD;;CAEA,UAAIyC,MAAJ,EACA;CACC,aAAKE,gBAAL,CAAsBvS,UAAtB,EAAkC4P,QAAlC,EAA4CzjC,IAA5C;CACA;CACD;CA/zBF;CAAA;CAAA,mCAi0BgB6zB,UAj0BhB,EAi0BoC4P,QAj0BpC,EAi0BsDzjC,IAj0BtD,EAk0BC;CACC,UAAMqmC,uBAAuB,GAAIxS,UAAU,CAAC9lB,KAAX,OAAuB01B,QAAQ,CAAC11B,KAAT,EAAxD;CAEA,UAAM4W,QAAQ,GAAG3kB,IAAI,CAAC2N,OAAL,KAAiB3N,IAAI,CAAC2N,OAAL,EAAjB,GAAkC3N,IAAI,CAAC8C,MAAL,EAAnD;CACA,UAAMwjC,QAAQ,GAAGtmC,IAAI,CAACqV,OAAL,EAAjB;CACA,UAAMkxB,oBAAoB,GAAGvmC,IAAI,CAACwmC,eAAL,EAA7B;CAEA,UAAML,cAAc,GAAG1C,QAAQ,CAAChgB,gBAAT,EAAvB;CACA,UAAM+B,YAAY,GAAG2gB,cAAc,CAAC3C,QAAf,CAAwB8C,QAAQ,GAAG,CAAnC,CAArB;;CAEA,UAAIvlC,aAAG,CAAC4U,QAAJ,CAAa6P,YAAb,EAA2B,mBAA3B,CAAJ,EACA;CACC,YAAMihB,YAAY,GAAG3iC,QAAQ,CAAC0hB,YAAY,CAACrT,OAAb,CAAqBtC,IAAtB,EAA4B,EAA5B,CAA7B;CAEA,YAAM62B,QAAQ,GAAG,KAAKpS,aAAL,CAAmBsN,gBAAnB,CAAoC99B,QAAQ,CAAC0hB,YAAY,CAACrT,OAAb,CAAqBvW,EAAtB,EAA0B,EAA1B,CAA5C,CAAjB;;CACA,YAAI8qC,QAAQ,CAACl2B,YAAT,MAA2Bk2B,QAAQ,CAACpjB,eAAT,EAA/B,EACA;CACCojB,UAAAA,QAAQ,CAAC5vB,YAAT;CACA;;CAED,YAAIyvB,oBAAoB,GAAG,CAAvB,IAA4BE,YAAY,IAAIF,oBAAhD,EACA;CACC,cAAIF,uBAAJ,EACA;CACCtlC,YAAAA,aAAG,CAACujB,YAAJ,CAAiBK,QAAjB,EAA2Ba,YAA3B;CACA,WAHD,MAKA;CACC,iBAAK6O,WAAL,CAAiBsS,mBAAjB,CAAqChiB,QAArC,EAA+Ca,YAA/C;CACA;CACD,SAVD,MAYA;CACCzkB,UAAAA,aAAG,CAACujB,YAAJ,CAAiBK,QAAjB,EAA2Ba,YAA3B;CACA;CACD,OAzBD,MA2BA;CACC,YAAIie,QAAQ,CAACh3B,OAAT,EAAJ,EACA;CACC1L,UAAAA,aAAG,CAACujB,YAAJ,CAAiBK,QAAjB,EAA2B8e,QAAQ,CAAChe,aAAT,EAA3B;CACA,SAHD,MAKA;CACC,cAAIge,QAAQ,CAAC5c,SAAT,EAAJ,EACA;CACC9lB,YAAAA,aAAG,CAACujB,YAAJ,CAAiBK,QAAjB,EAA2B8e,QAAQ,CAACmD,gBAAT,EAA3B;CACA,WAHD,MAKA;CACC7lC,YAAAA,aAAG,CAACujB,YAAJ,CAAiBK,QAAjB,EAA2B8e,QAAQ,CAAChe,aAAT,EAA3B;CACA;CACD;CACD;;CAED,WAAK6d,0BAAL,CAAgCtjC,IAAhC,EAAsC6zB,UAAtC,EAAkD4P,QAAlD;CAEA,WAAKG,oBAAL,CAA0B/P,UAA1B,EAAsC4P,QAAtC;;CAEA,UAAI4C,uBAAJ,EACA;CACC,aAAKQ,WAAL,CAAiBhT,UAAjB;CACA;;CACD,WAAKgT,WAAL,CAAiBpD,QAAjB;CACA;CAl4BF;CAAA;CAAA,+CAo4B4BzjC,IAp4B5B,EAo4BwC6zB,UAp4BxC,EAo4B4D4P,QAp4B5D,EAq4BC;CACC5P,MAAAA,UAAU,CAACxP,UAAX,CAAsBrkB,IAAtB;CAEAA,MAAAA,IAAI,CAAC8mC,eAAL,CAAqBrD,QAAQ,CAAC11B,KAAT,EAArB,EAAuC01B,QAAQ,CAACrwB,aAAT,EAAvC;CAEAqwB,MAAAA,QAAQ,CAACsD,OAAT,CAAiB/mC,IAAjB;CACA;CA34BF;CAAA;CAAA,0CA64BuB6zB,UA74BvB,EA64B2C7zB,IA74B3C,EA64BuDovB,MA74BvD,EA84BC;CAAA;;CACC,UAAMxzB,EAAE,gCAAyBi4B,UAAU,CAACzgB,aAAX,KAA6BygB,UAAU,CAAC9lB,KAAX,EAA7B,GAAkD/N,IAAI,CAAC+N,KAAL,EAA3E,CAAR;;CAEA,UAAI,KAAKi5B,gBAAT,EACA;CACC,aAAKA,gBAAL,CAAsBC,cAAtB,GAAuCzrC,KAAvC;CAEA;CACA;;CAED,WAAKwrC,gBAAL,GAAwB,IAAIE,eAAJ,CAAS;CAChCtrC,QAAAA,EAAE,EAAEA,EAD4B;CAEhCs+B,QAAAA,WAAW,EAAE9K,MAFmB;CAGhCvpB,QAAAA,SAAS,EAAE,EAHqB;CAIhCC,QAAAA,UAAU,EAAE,CAAC;CAJmB,OAAT,CAAxB;CAOA,WAAKwuB,aAAL,CAAmBgE,UAAnB,GAAgCp1B,OAAhC,CAAwC,UAACqlB,MAAD,EAAY;CACnD,YAAI,CAACA,MAAM,CAAChgB,WAAP,EAAD,IAAyB,CAAC,OAAI,CAAC4+B,YAAL,CAAkBtT,UAAlB,EAA8BtL,MAA9B,CAA9B,EACA;CACC,UAAA,OAAI,CAACye,gBAAL,CAAsBI,WAAtB,CAAkC;CACjC/C,YAAAA,IAAI,EAAE9b,MAAM,CAAC5U,OAAP,EAD2B;CAEjC2wB,YAAAA,OAAO,EAAE,iBAAC3pC,KAAD,EAAQ4pC,QAAR,EAAqB;CAC7B,kBAAInmC,OAAO,GAAGE,aAAG,CAACC,UAAJ,CAAe,gDAAf,CAAd;;CACA,kBAAIs1B,UAAU,CAAChe,WAAX,EAAJ,EACA;CACCzX,gBAAAA,OAAO,GAAGE,aAAG,CAACC,UAAJ,CAAe,iDAAf,CAAV;CACA;;CACD,cAAA,OAAI,CAAC8kC,aAAL,CAAmBxP,UAAnB,EAA+Bz1B,OAA/B,EACE/B,IADF,CACO,YAAM;CACX,gBAAA,OAAI,CAAC2pC,mBAAL,CAAyBnS,UAAzB,EAAqCtL,MAArC,EAA6CvoB,IAA7C,EAAmD,IAAnD,EAAyD,KAAzD;CACA,eAHF,WAIQ,YAAM,EAJd;;CAMAukC,cAAAA,QAAQ,CAACO,aAAT,GAAyBtpC,KAAzB;CACA;CAfgC,WAAlC;CAiBA;CACD,OArBD;CAuBA,WAAKwrC,gBAAL,CAAsBC,cAAtB,GAAuCvsC,SAAvC,CAAiD,SAAjD,EAA4D,YAAM;CACjE,QAAA,OAAI,CAACssC,gBAAL,CAAsB1hB,OAAtB;;CACA,QAAA,OAAI,CAAC0hB,gBAAL,GAAwB,IAAxB;;CACA,QAAA,OAAI,CAAC/rC,IAAL,CAAU,uBAAV;CACA,OAJD;CAMA,WAAK+rC,gBAAL,CAAsBvqC,IAAtB;CACA;CA77BF;CAAA;CAAA,iCA+7BcsuB,KA/7Bd,EA+7B6BC,MA/7B7B,EAg8BC;CACC,aAAQD,KAAK,CAAC3X,aAAN,OAA0B,QAA1B,IAAsC2X,KAAK,CAAChd,KAAN,OAAkBid,MAAM,CAACjd,KAAP,EAAhE;CACA;CAl8BF;CAAA;CAAA,qCAo8BkB/N,IAp8BlB,EAo8BwBovB,MAp8BxB,EAo8BgC+U,UAp8BhC,EAq8BC;CAAA;;CACC,UAAMvoC,EAAE,uBAAgBoE,IAAI,CAAC+N,KAAL,EAAhB,CAAR;;CAEA,UAAI,KAAKs5B,YAAT,EACA;CACC,aAAKA,YAAL,CAAkBJ,cAAlB,GAAmCzrC,KAAnC;CAEA;CACA;;CAED,WAAK6rC,YAAL,GAAoB,IAAIH,eAAJ,CAAS;CAC5BtrC,QAAAA,EAAE,EAAEA,EADwB;CAE5Bs+B,QAAAA,WAAW,EAAE9K,MAFe;CAG5BvpB,QAAAA,SAAS,EAAE,EAHiB;CAI5BC,QAAAA,UAAU,EAAE,CAAC;CAJe,OAAT,CAApB;CAOAq+B,MAAAA,UAAU,CAACjhC,OAAX,CAAmB,UAAClD,IAAD,EAAU;CAC5B,QAAA,OAAI,CAACqnC,YAAL,CAAkBD,WAAlB,CAA8BpnC,IAA9B;CACA,OAFD;CAIA,WAAKqnC,YAAL,CAAkBJ,cAAlB,GAAmCvsC,SAAnC,CAA6C,SAA7C,EAAwD,YAAM;CAC7D,QAAA,OAAI,CAAC2sC,YAAL,CAAkB/hB,OAAlB;;CACA,QAAA,OAAI,CAAC+hB,YAAL,GAAoB,IAApB;;CACA,QAAA,OAAI,CAACpsC,IAAL,CAAU,eAAV;CACA,OAJD;CAMA,WAAKosC,YAAL,CAAkB5qC,IAAlB;CACA;CAj+BF;CAAA;CAAA,2CAo+BC;CACC,aAAQ,KAAK4qC,YAAL,IAAqB,KAAKL,gBAAlC;CACA;CAt+BF;CAAA;CAAA,8CAy+BC;CACC,UAAI,KAAKK,YAAT,EACA;CACC,aAAKA,YAAL,CAAkBJ,cAAlB,GAAmCzrC,KAAnC;CACA;;CAED,UAAI,KAAKwrC,gBAAT,EACA;CACC,aAAKA,gBAAL,CAAsBC,cAAtB,GAAuCzrC,KAAvC;CACA;CACD;CAn/BF;CAAA;CAAA,EAA+Bf,6BAA/B;;KCvBa6sC,YAAb;CAEC,wBAAYvrC,MAAZ,EACA;CAAA;CACC,SAAK6C,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,SAAK01B,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CAEA,SAAKiT,iBAAL,GAAyB,IAAI7iC,GAAJ,EAAzB;CAEA,SAAK8iC,gBAAL,GAAwB,CAAxB;CACA,SAAKC,YAAL,GAAoB,SAApB;CACA;;CAXF;CAAA;CAAA,kDAcC;CAAA;;CACC,WAAKD,gBAAL,GAAwB,CAAxB;CAEA,aAAO,KAAKE,gBAAL,GAAwBrrC,IAAxB,CAA6B,YAAM;CACzC,eAAO,KAAI,CAACsrC,cAAL,CAAoB,KAAI,CAACC,YAAL,EAApB,CAAP;CACA,OAFM,CAAP;CAGA;CApBF;CAAA;CAAA,mCAuBC;CACC,aAAO,CACN,SADM,EACK,SADL,EACgB,SADhB,EAC2B,SAD3B,EAEN,SAFM,EAEK,SAFL,EAEgB,SAFhB,EAE2B,SAF3B,EAGN,SAHM,EAGK,SAHL,EAGgB,SAHhB,EAG2B,SAH3B,EAIN,SAJM,EAIK,SAJL,EAIgB,SAJhB,EAI2B,SAJ3B,EAKN,SALM,EAKK,SALL,EAKgB,SALhB,EAK2B,SAL3B,EAMN,SANM,EAMK,SANL,EAMgB,SANhB,EAM2B,SAN3B,EAON,SAPM,EAOK,SAPL,EAOgB,SAPhB,EAO2B,SAP3B,EAQN,SARM,EAQK,SARL,EAQgB,SARhB,EAQ2B,SAR3B,EASN,SATM,EASK,SATL,EASgB,SAThB,EAS2B,SAT3B,EAUN,SAVM,EAUK,SAVL,EAUgB,SAVhB,EAU2B,SAV3B,EAWN,SAXM,EAWK,SAXL,EAWgB,SAXhB,EAW2B,SAX3B,EAYN,SAZM,EAYK,SAZL,EAYgB,SAZhB,EAY2B,SAZ3B,EAaN,SAbM,EAaK,SAbL,CAAP;CAeA;CAvCF;CAAA;CAAA,mCAyCgBC,SAzChB,EA0CC;CACC,WAAKL,gBAAL;;CAEA,UAAI,KAAKA,gBAAL,IAAyBK,SAAS,CAAC9pC,MAAvC,EACA;CACC,eAAO,KAAK0pC,YAAZ;CACA;;CAED,UAAMK,WAAW,GAAGD,SAAS,CAACje,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACme,MAAL,KAAgBF,SAAS,CAAC9pC,MAArC,CAAD,CAA7B;;CAEA,UAAI,KAAKiqC,2BAAL,CAAiCF,WAAjC,CAAJ,EACA;CACC,eAAO,KAAKH,cAAL,CAAoBE,SAApB,CAAP;CACA,OAHD,MAKA;CACC,eAAOC,WAAP;CACA;CACD;CA5DF;CAAA;CAAA,gDA8D6Bn+B,KA9D7B,EA+DC;CACC,UAAIs+B,YAAY,GAAG,KAAnB;CAEA,WAAKV,iBAAL,CACErkC,OADF,CACU,UAACglC,SAAD,EAAuB;CAC/B,YAAIA,SAAS,KAAKv+B,KAAlB,EACA;CACCs+B,UAAAA,YAAY,GAAG,IAAf;CACA;CACD,OANF;CASA,aAAOA,YAAP;CACA;CA5EF;CAAA;CAAA,uCA+EC;CAAA;;CACC,UAAM/H,SAAS,GAAG,IAAIx7B,GAAJ,EAAlB;CACA,WAAK4vB,aAAL,CAAmB8N,cAAnB,GACEl/B,OADF,CACU,UAACmV,MAAD,EAAoB;CAC5B,YAAI,CAACA,MAAM,CAAC9P,WAAP,EAAL,EACA;CACC23B,UAAAA,SAAS,CAACj6B,GAAV,CAAcoS,MAAM,CAACtK,KAAP,EAAd;CACA;CACD,OANF;CASA,aAAO,KAAKnP,aAAL,CAAmBupC,0BAAnB,CAA8C;CACpDjI,QAAAA,SAAS,iCAAMA,SAAS,CAACvgC,MAAV,EAAN;CAD2C,OAA9C,EAGLtD,IAHK,CAGA,UAACqB,QAAD,EAAc;CACnB,QAAA,MAAI,CAAC6pC,iBAAL,GAAyB,IAAI7iC,GAAJ,CAAQhH,QAAQ,CAACZ,IAAjB,CAAzB;CACA,OALK,WAMC,UAACY,QAAD,EAAc;CACpB,QAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OARK,CAAP;CAUA;CApGF;CAAA;CAAA,sCAsGmBoD,KAtGnB,EAuGC;CAAA;;CACC,UAAMsnC,oBAAoB,GAAG,IAAI1jC,GAAJ,EAA7B;CAEA5D,MAAAA,KAAK,CAACoC,OAAN,CAAc,UAAClD,IAAD,EAAgB;CAC7B,YAAIA,IAAI,CAAC0Q,YAAL,MAAuB,CAAC1Q,IAAI,CAACkT,cAAL,EAA5B,EACA;CACCk1B,UAAAA,oBAAoB,CAACniC,GAArB,CAAyBjG,IAAI,CAAC+N,KAAL,EAAzB;CACA;CACD,OALD;;CAOA,UAAIq6B,oBAAoB,CAACv6B,IAAzB,EACA;CACC,aAAK65B,gBAAL,GAAwBrrC,IAAxB,CAA6B,YAAM;CAClC,cAAMyE,KAAK,GAAG,IAAI4C,GAAJ,EAAd;CACA0kC,UAAAA,oBAAoB,CAACllC,OAArB,CAA6B,UAAC2T,MAAD,EAAoB;CAChD/V,YAAAA,KAAK,CAACgN,GAAN,CAAU+I,MAAV,EAAkB,MAAI,CAAC8wB,cAAL,CAAoB,MAAI,CAACC,YAAL,EAApB,CAAlB;CACA,WAFD;;CAIA,UAAA,MAAI,CAAChpC,aAAL,CAAmBypC,8BAAnB,CAAkD;CACjDvnC,YAAAA,KAAK,EAAE4R,MAAM,CAAC41B,WAAP,CAAmBxnC,KAAnB;CAD0C,WAAlD,EAGEzE,IAHF,CAGO,UAACqB,QAAD,EAAc;CACnB,gBAAM6qC,YAAY,GAAG7qC,QAAQ,CAACZ,IAA9B;CACA4V,YAAAA,MAAM,CAACC,IAAP,CAAY41B,YAAZ,EAA0BrlC,OAA1B,CAAkC,UAAC2T,MAAD,EAAoB;CACrD,kBAAM5D,WAAW,GAAGs1B,YAAY,CAAC1xB,MAAD,CAAhC;;CACA,kBAAM7W,IAAI,GAAG,MAAI,CAACs0B,aAAL,CAAmBsN,gBAAnB,CAAoC/qB,MAApC,CAAb;;CACA7W,cAAAA,IAAI,CAACwoC,cAAL,CAAoBv1B,WAApB;CACA,aAJD;CAKA,WAVF,WAWQ,UAACvV,QAAD,EAAc;CACpB,YAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,WAbF;CAeA,SArBD;CAsBA;CACD;CA1IF;CAAA;CAAA;;KCOakM,MAAb;CAAA;;CAEC,gBAAY7N,MAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,4BAAvB;;CAEA,UAAK2J,OAAL,GAAeD,QAAQ,CAAC/H,MAAM,CAACgI,OAAR,EAAiB,EAAjB,CAAvB;CAEA,UAAKuwB,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA,UAAKx5B,SAAL,GAAiBiB,MAAM,CAACjB,SAAxB;CACA,UAAK6I,MAAL,GAAc5H,MAAM,CAAC4H,MAArB;CACA,UAAK8kC,WAAL,GAAmB1sC,MAAM,CAAC0sC,WAA1B;;CAEA,UAAKC,oBAAL;;CAZD;CAaC;;CAhBF;CAAA;CAAA,2CAmBC;CAAA;;CACCjuC,MAAAA,6BAAY,CAACC,SAAb,CACC,8BADD,EAEC,UAACwJ,SAAD,EAA0B;CACzB,QAAA,MAAI,CAACykC,UAAL,CAAgBzkC,SAAhB;CACA,OAJF;CAOAzJ,MAAAA,6BAAY,CAACC,SAAb,CACC,+BADD,EAEC,UAACwJ,SAAD,EAA0B;CACzB,QAAA,MAAI,CAAC0kC,WAAL,CAAiB1kC,SAAjB;CACA,OAJF;CAOAzJ,MAAAA,6BAAY,CAACC,SAAb,CACC,iCADD,EAEC,UAACwJ,SAAD,EAA0B;CACzB,QAAA,MAAI,CAACjJ,IAAL,CAAU,aAAV,EAAyBiJ,SAAS,CAAC4N,OAAV,EAAzB;CACA,OAJF;CAOArX,MAAAA,6BAAY,CAACC,SAAb,CACC,iCADD,EAEC,UAACwJ,SAAD,EAA0B;CACzB,QAAA,MAAI,CAAC2kC,aAAL,CAAmB3kC,SAAnB;CACA,OAJF;CAMA;CA/CF;CAAA;CAAA,kCAkDC;CACC,aAAO,KAAKpJ,SAAL,CAAe+kC,eAAf,CACN,MADM,EAEN;CACCiJ,QAAAA,IAAI,EAAE,KADP;CAEC/kC,QAAAA,OAAO,EAAE,KAAKA;CAFf,OAFM,CAAP;CAOA;CA1DF;CAAA;CAAA,+BA4DYG,SA5DZ,EA6DC;CACC,UAAM2F,IAAc,GAAG3F,SAAS,CAAC4N,OAAV,EAAvB;CAEA,WAAK22B,WAAL,CAAiBhtB,iBAAjB,CAAmC5R,IAAnC;CAEA,WAAKlG,MAAL,CAAY+X,sBAAZ,CAAmC,MAAnC,EAA2C;CAC1Cjb,QAAAA,IAAI,EAAEoJ,IAAI,CAAC/N,IAAL,CAAUqM,IAAV,EADoC;CAE1CwT,QAAAA,KAAK,EAAExP,MAAM,CAACtC,IAAI,CAACjO,EAAN;CAF6B,OAA3C;CAIA;CAtEF;CAAA;CAAA,gCAwEasI,SAxEb,EAyEC;CACC,UAAM2F,IAAc,GAAG3F,SAAS,CAAC4N,OAAV,EAAvB;CAEA,WAAKwiB,aAAL,CAAmByJ,WAAnB,GAAiC76B,OAAjC,CAAyC,UAAClD,IAAD,EAAU;CAClD,YAAM+oC,QAAQ,GAAG/oC,IAAI,CAACqU,OAAL,GAAehJ,QAAf,EAAjB;;CACA,YAAI09B,QAAQ,IAAIA,QAAQ,CAACntC,EAAT,KAAgBiO,IAAI,CAACjO,EAArC,EACA;CACCoE,UAAAA,IAAI,CAACsU,OAAL,CAAazK,IAAb;CACA;CACD,OAND;CAQA,WAAK4+B,WAAL,CAAiBO,sBAAjB,CAAwCn/B,IAAxC;CACA,WAAK4+B,WAAL,CAAiBhtB,iBAAjB,CAAmC5R,IAAnC;CACA;CAtFF;CAAA;CAAA,kCAwFe3F,SAxFf,EAyFC;CACC,UAAM2F,IAAc,GAAG3F,SAAS,CAAC4N,OAAV,EAAvB;CAEA,WAAKwiB,aAAL,CAAmByJ,WAAnB,GAAiC76B,OAAjC,CAAyC,UAAClD,IAAD,EAAU;CAClD,YAAM+oC,QAAQ,GAAG/oC,IAAI,CAACqU,OAAL,GAAehJ,QAAf,EAAjB;;CACA,YAAI09B,QAAQ,IAAIA,QAAQ,CAACntC,EAAT,KAAgBiO,IAAI,CAACjO,EAArC,EACA;CACCoE,UAAAA,IAAI,CAACsU,OAAL;CACA;CACD,OAND;CAQA,WAAKm0B,WAAL,CAAiBO,sBAAjB,CAAwCn/B,IAAxC;CACA;CArGF;CAAA;CAAA,EAA0BpP,6BAA1B;;KCMawuC,UAAb;CAEC,sBAAYltC,MAAZ,EACA;CAAA;CACC,SAAK6C,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,SAAKy1B,WAAL,GAAmBt4B,MAAM,CAACs4B,WAA1B;CACA,SAAKC,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA,SAAKvwB,OAAL,GAAehI,MAAM,CAACgI,OAAtB;CAEA,SAAKmlC,mBAAL,GAA2B,IAAIxkC,GAAJ,EAA3B;CACA,SAAKykC,qBAAL,GAA6B,IAAIzkC,GAAJ,EAA7B;CACA,SAAK0kC,qBAAL,GAA6B,IAAI1kC,GAAJ,EAA7B;CACA;;CAZF;CAAA;CAAA,kCAeC;CACC,aAAO,OAAP;CACA;CAjBF;CAAA;CAAA,6BAoBC;CACC,aAAO;CACN2kC,QAAAA,WAAW,EAAE,KAAKC,aAAL,CAAmBlqC,IAAnB,CAAwB,IAAxB,CADP;CAENmqC,QAAAA,aAAa,EAAE,KAAKC,eAAL,CAAqBpqC,IAArB,CAA0B,IAA1B,CAFT;CAGNqqC,QAAAA,aAAa,EAAE,KAAKC,eAAL,CAAqBtqC,IAArB,CAA0B,IAA1B;CAHT,OAAP;CAKA;CA1BF;CAAA;CAAA,kCA4BerD,MA5Bf,EA6BC;CAAA;;CACC,UAAI,KAAKgI,OAAL,KAAiBhI,MAAM,CAACgI,OAA5B,EACA;CACC;CACA;;CAED,UAAI,KAAK4lC,WAAL,CAAiB5tC,MAAM,CAAC4T,KAAxB,CAAJ,EACA;CACC,aAAKi6B,YAAL,CAAkB7tC,MAAM,CAAC4T,KAAzB;CAEA;CACA;;CAED,WAAK/Q,aAAL,CAAmBirC,aAAnB,CAAiC;CAChCvf,QAAAA,QAAQ,EAAEvuB,MAAM,CAACH;CADe,OAAjC,EAGES,IAHF,CAGO,UAACqB,QAAD,EAAc;CACnBA,QAAAA,QAAQ,CAACZ,IAAT,CAAcgE,KAAd,GAAsB,EAAtB;CACA,YAAMynB,MAAM,GAAG8H,MAAM,CAACkH,WAAP,CAAmB75B,QAAQ,CAACZ,IAA5B,CAAf;;CACA,QAAA,KAAI,CAACu3B,WAAL,CAAiByV,gBAAjB,CAAkCvhB,MAAlC;CACA,OAPF,WAQQ,UAAC7qB,QAAD,EAAc,EARtB;CAUA;CApDF;CAAA;CAAA,oCAsDiB3B,MAtDjB,EAuDC;CAAA;;CACC,UAAI,KAAKgI,OAAL,KAAiBhI,MAAM,CAACgI,OAA5B,EACA;CACC;CACA;;CAED,UAAI,KAAKgmC,cAAL,CAAoBhuC,MAAM,CAACH,EAA3B,CAAJ,EACA;CACC,aAAKouC,eAAL,CAAqBjuC,MAAM,CAACH,EAA5B;CAEA;CACA;;CAED,WAAKgD,aAAL,CAAmBirC,aAAnB,CAAiC;CAChCvf,QAAAA,QAAQ,EAAEvuB,MAAM,CAACH;CADe,OAAjC,EAGES,IAHF,CAGO,UAACqB,QAAD,EAAc;CACnBA,QAAAA,QAAQ,CAACZ,IAAT,CAAcgE,KAAd,GAAsB,EAAtB;CACA,YAAM0xB,SAAS,GAAGnC,MAAM,CAACkH,WAAP,CAAmB75B,QAAQ,CAACZ,IAA5B,CAAlB;;CACA,YAAMyrB,MAAc,GAAG,MAAI,CAAC+L,aAAL,CAAmB2N,oBAAnB,CAAwCzP,SAAS,CAACzkB,KAAV,EAAxC,CAAvB;;CACA,YAAIwa,MAAJ,EACA;CACC,cAAM0hB,aAAa,GAAG1hB,MAAM,CAACkH,SAAP,EAAtB;CAEAlH,UAAAA,MAAM,CAAC2hB,cAAP,CAAsB1X,SAAtB;;CAEA,cAAIA,SAAS,CAAC/C,SAAV,OAA0Bwa,aAA9B,EACA;CACC,gBAAIzX,SAAS,CAAC/C,SAAV,OAA0B,QAA9B,EACA;CACC,cAAA,MAAI,CAAC4E,WAAL,CAAiB8V,0BAAjB,CAA4C5hB,MAA5C;CACA;;CAED,gBAAIiK,SAAS,CAAC/C,SAAV,OAA0B,WAA9B,EACA;CACClH,cAAAA,MAAM,CAACjQ,QAAP,GACEpV,OADF,CACU,UAAClD,IAAD,EAAgB;CACxB,oBAAIA,IAAI,CAACsjB,eAAL,EAAJ,EACA;CACCtjB,kBAAAA,IAAI,CAAC8W,YAAL;CACA;;CACDyR,gBAAAA,MAAM,CAAClE,UAAP,CAAkBrkB,IAAlB;CACAA,gBAAAA,IAAI,CAACyN,cAAL;CACA,eARF;CAUA8a,cAAAA,MAAM,CAACT,QAAP,CAAgBS,MAAhB;CACAA,cAAAA,MAAM,CAACiL,WAAP;;CAEA,cAAA,MAAI,CAACa,WAAL,CAAiB+V,6BAAjB,CAA+C7hB,MAA/C;CACA;CACD;;CAED,UAAA,MAAI,CAAC8L,WAAL,CAAiBuE,oBAAjB,CACC,MAAI,CAACtE,aAAL,CAAmBN,iBAAnB,EADD,EAEE,CAACp2B,cAAI,CAACC,WAAL,CAAiB,MAAI,CAACy2B,aAAL,CAAmBP,eAAnB,EAAjB,CAFH;;CAKA,UAAA,MAAI,CAACM,WAAL,CAAiBkF,sBAAjB;CACA;CACD,OA9CF,WA+CQ,UAAC77B,QAAD,EAAc,EA/CtB;CAiDA;CArHF;CAAA;CAAA,oCAuHiB3B,MAvHjB,EAwHC;CACC,UAAI,KAAKgI,OAAL,KAAiBhI,MAAM,CAACgI,OAA5B,EACA;CACC;CACA;;CAED,UAAI,KAAKsmC,cAAL,CAAoBtuC,MAAM,CAACH,EAA3B,CAAJ,EACA;CACC,aAAK0uC,eAAL,CAAqBvuC,MAAM,CAACH,EAA5B;CAEA;CACA;;CAED,UAAM2sB,MAAM,GAAG,KAAK+L,aAAL,CAAmB2N,oBAAnB,CAAwClmC,MAAM,CAACH,EAA/C,CAAf;;CACA,UAAI2sB,MAAJ,EACA;CACCA,QAAAA,MAAM,CAAC9a,cAAP;CAEA,aAAK6mB,aAAL,CAAmB+E,YAAnB,CAAgC9Q,MAAM,CAACxa,KAAP,EAAhC;CACA;CACD;CA5IF;CAAA;CAAA,yCA8IsB4B,KA9ItB,EA+IC;CACC,WAAKu5B,mBAAL,CAAyBjjC,GAAzB,CAA6B0J,KAA7B;CACA;CAjJF;CAAA;CAAA,wCAmJqB2a,QAnJrB,EAoJC;CACC,WAAK6e,qBAAL,CAA2BljC,GAA3B,CAA+BqkB,QAA/B;CACA;CAtJF;CAAA;CAAA,wCAwJqBA,QAxJrB,EAyJC;CACC,WAAK8e,qBAAL,CAA2BnjC,GAA3B,CAA+BqkB,QAA/B;CACA;CA3JF;CAAA;CAAA,gCA6Ja3a,KA7Jb,EA8JC;CACC,aAAO,KAAKu5B,mBAAL,CAAyBvkC,GAAzB,CAA6BgL,KAA7B,CAAP;CACA;CAhKF;CAAA;CAAA,iCAkKcA,KAlKd,EAmKC;CACC,WAAKu5B,mBAAL,WAAgCv5B,KAAhC;CACA;CArKF;CAAA;CAAA,mCAuKgB2a,QAvKhB,EAwKC;CACC,aAAO,KAAK6e,qBAAL,CAA2BxkC,GAA3B,CAA+B2lB,QAA/B,CAAP;CACA;CA1KF;CAAA;CAAA,oCA4KiBA,QA5KjB,EA6KC;CACC,WAAK6e,qBAAL,WAAkC7e,QAAlC;CACA;CA/KF;CAAA;CAAA,mCAiLgBA,QAjLhB,EAkLC;CACC,aAAO,KAAK8e,qBAAL,CAA2BzkC,GAA3B,CAA+B2lB,QAA/B,CAAP;CACA;CApLF;CAAA;CAAA,oCAsLiBA,QAtLjB,EAuLC;CACC,WAAK8e,qBAAL,WAAkC9e,QAAlC;CACA;CAzLF;CAAA;CAAA;;KCMaigB,QAAb;CAEC,oBAAYxuC,MAAZ,EACA;CAAA;CACC,SAAK6C,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,SAAK01B,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA,SAAK+L,cAAL,GAAsBtkC,MAAM,CAACskC,cAA7B;CACA,SAAKoI,WAAL,GAAmB1sC,MAAM,CAAC0sC,WAA1B;CACA,SAAK+B,SAAL,GAAiBzuC,MAAM,CAACyuC,SAAxB;CACA,SAAKC,aAAL,GAAqB1uC,MAAM,CAAC0uC,aAA5B;CACA,SAAK1mC,OAAL,GAAehI,MAAM,CAACgI,OAAtB;CAEA,SAAK2mC,oBAAL,GAA4B,IAAIhmC,GAAJ,EAA5B;CAEA,SAAKwkC,mBAAL,GAA2B,IAAIxkC,GAAJ,EAA3B;CACA,SAAKykC,qBAAL,GAA6B,IAAIzkC,GAAJ,EAA7B;CACA,SAAK0kC,qBAAL,GAA6B,IAAI1kC,GAAJ,EAA7B;CACA,SAAKimC,oBAAL,GAA4B,IAAIjmC,GAAJ,EAA5B;CAEA,SAAK8lC,SAAL,CAAe9vC,SAAf,CAAyB,eAAzB,EAA0C,KAAKkwC,eAAL,CAAqBxrC,IAArB,CAA0B,IAA1B,CAA1C;CACA;;CApBF;CAAA;CAAA,kCAuBC;CACC,aAAO,OAAP;CACA;CAzBF;CAAA;CAAA,6BA4BC;CACC,aAAO;CACNyrC,QAAAA,SAAS,EAAE,KAAKC,WAAL,CAAiB1rC,IAAjB,CAAsB,IAAtB,CADL;CAEN2rC,QAAAA,WAAW,EAAE,KAAKC,aAAL,CAAmB5rC,IAAnB,CAAwB,IAAxB,CAFP;CAGN6rC,QAAAA,WAAW,EAAE,KAAKC,aAAL,CAAmB9rC,IAAnB,CAAwB,IAAxB,CAHP;CAIN+rC,QAAAA,eAAe,EAAE,KAAKC,iBAAL,CAAuBhsC,IAAvB,CAA4B,IAA5B,CAJX;CAKNisC,QAAAA,WAAW,EAAE,KAAKC,YAAL,CAAkBlsC,IAAlB,CAAuB,IAAvB;CALP,OAAP;CAOA;CApCF;CAAA;CAAA,gCAsCarD,MAtCb,EAuCC;CAAA;;CACC,UAAI,KAAKgI,OAAL,KAAiBhI,MAAM,CAACgI,OAA5B,EACA;CACC;CACA;;CAED,WAAKwnC,aAAL,CAAmBxvC,MAAM,CAACH,EAA1B;CAEA,WAAK4vC,WAAL,CAAiBzvC,MAAM,CAACH,EAAxB,aACU;CAAA,eAAM,KAAI,CAAC6vC,eAAL,CAAqB1vC,MAAM,CAACH,EAA5B,CAAN;CAAA,OADV,EAEES,IAFF,CAEO,YAAM;CACX,QAAA,KAAI,CAACuC,aAAL,CAAmB8sC,WAAnB,CAA+B;CAC9B3sB,UAAAA,OAAO,EAAE,CAAChjB,MAAM,CAACH,EAAR;CADqB,SAA/B,EAGES,IAHF,CAGO,UAACqB,QAAD,EAAc;CACnB,cAAM8pB,QAAQ,GAAG9pB,QAAQ,CAACZ,IAAT,CACfyD,IADe,CACV,UAACinB,QAAD;CAAA,mBAA0BA,QAAQ,CAAC5rB,EAAT,KAAgBG,MAAM,CAACH,EAAjD;CAAA,WADU,CAAjB;CAGA,cAAMoE,IAAI,GAAG8O,IAAI,CAAC2Y,SAAL,CAAeD,QAAf,CAAb;;CACA,UAAA,KAAI,CAACmkB,eAAL,CAAqB3rC,IAArB;CACA,SATF,WAUQ,UAACtC,QAAD,EAAc,EAVtB;CAYA,OAfF,WAgBQ,YAAM,EAhBd;CAkBA;CAjEF;CAAA;CAAA,kCAmEe3B,MAnEf,EAoEC;CAAA;;CACC,UAAI,KAAKgI,OAAL,KAAiBhI,MAAM,CAACgI,OAA5B,EACA;CACC;CACA;;CAED,WAAKnF,aAAL,CAAmB8sC,WAAnB,CAA+B;CAC9B3sB,QAAAA,OAAO,EAAE,CAAChjB,MAAM,CAACH,EAAR;CADqB,OAA/B,EAGES,IAHF,CAGO,UAACqB,QAAD,EAAc;CACnB,YAAM8pB,QAAQ,GAAG9pB,QAAQ,CAACZ,IAAT,CACfyD,IADe,CACV,UAACinB,QAAD;CAAA,iBAA0BA,QAAQ,CAAC5rB,EAAT,KAAgBG,MAAM,CAACH,EAAjD;CAAA,SADU,CAAjB;CAGA,YAAMoE,IAAI,GAAG8O,IAAI,CAAC2Y,SAAL,CAAeD,QAAf,CAAb;;CAEA,YAAI,MAAI,CAACokB,YAAL,CAAkB5rC,IAAI,CAAC+N,KAAL,EAAlB,CAAJ,EACA;CACC,UAAA,MAAI,CAAC09B,eAAL,CAAqBzrC,IAAI,CAAC+N,KAAL,EAArB;;CAEA,cAAI,MAAI,CAAC47B,WAAL,CAAiB5tC,MAAM,CAAC4T,KAAxB,CAAJ,EACA;CACC,YAAA,MAAI,CAACi6B,YAAL,CAAkB7tC,MAAM,CAAC4T,KAAzB;;CAEA;CACA;;CAED,UAAA,MAAI,CAACg8B,eAAL,CAAqB3rC,IAArB;;CAEA;CACA;;CAED,YAAI,MAAI,CAAC+pC,cAAL,CAAoB/pC,IAApB,CAAJ,EACA;CACC,UAAA,MAAI,CAACgqC,eAAL,CAAqBhqC,IAArB;;CAEA;CACA;;CAED,QAAA,MAAI,CAAC6rC,UAAL,CAAgB7rC,IAAhB;CACA,OAjCF,WAkCQ,UAACtC,QAAD,EAAc,EAlCtB;CAoCA;CA9GF;CAAA;CAAA,kCAgHe3B,MAhHf,EAiHC;CACC,UAAI,KAAKgI,OAAL,KAAiBhI,MAAM,CAACgI,OAA5B,EACA;CACC;CACA;;CAED,UAAI,KAAKsmC,cAAL,CAAoBtuC,MAAM,CAACH,EAA3B,CAAJ,EACA;CACC,aAAK0uC,eAAL,CAAqBvuC,MAAM,CAACH,EAA5B;CAEA;CACA;;CAED,UAAMoE,IAAI,GAAG,KAAKs0B,aAAL,CAAmBsN,gBAAnB,CAAoC7lC,MAAM,CAACH,EAA3C,CAAb;;CACA,UAAIoE,IAAJ,EACA;CACC,YAAMqY,MAAM,GAAG,KAAKic,aAAL,CAAmB4P,kBAAnB,CAAsClkC,IAAI,CAAC+N,KAAL,EAAtC,CAAf;CACAsK,QAAAA,MAAM,CAACgM,UAAP,CAAkBrkB,IAAlB;CACAA,QAAAA,IAAI,CAACyN,cAAL;CAEA,aAAKm2B,oBAAL,CAA0BvrB,MAA1B;CACA;CACD;CAvIF;CAAA;CAAA,sCAyImByzB,aAzInB,EA0IC;CAAA;;CACC,UAAMC,eAAe,GAAG,IAAIroC,GAAJ,EAAxB;CAEAgP,MAAAA,MAAM,CAAC+E,OAAP,CAAeq0B,aAAf,EAA8B5oC,OAA9B,CAAsC,gBAAoB;CAAA;CAAA,YAAlB2T,MAAkB;CAAA,YAAVzG,IAAU;;CACzD,YAAI,CAAC,MAAI,CAAC47B,YAAL,CAAkB57B,IAAI,CAACT,KAAvB,CAAL,EACA;CACCo8B,UAAAA,eAAe,CAACj+B,GAAhB,CAAoBhK,QAAQ,CAAC+S,MAAD,EAAS,EAAT,CAA5B,EAA0CzG,IAA1C;CACA;;CACD,QAAA,MAAI,CAACk6B,eAAL,CAAqBl6B,IAAI,CAACT,KAA1B;CACA,OAND;;CAQA,UAAIo8B,eAAe,CAACl+B,IAAhB,KAAyB,CAA7B,EACA;CACC;CACA;;CAED,WAAKjP,aAAL,CAAmB8sC,WAAnB,CAA+B;CAC9B3sB,QAAAA,OAAO,iCAAMgtB,eAAe,CAACp5B,IAAhB,EAAN;CADuB,OAA/B,EAGEtW,IAHF,CAGO,UAACqB,QAAD,EAAc;CACnB,YAAMuuC,WAAW,GAAG,IAAIvoC,GAAJ,EAApB;CACA,YAAMwoC,QAAQ,GAAG,IAAIxnC,GAAJ,EAAjB;CACAhH,QAAAA,QAAQ,CAACZ,IAAT,CACEoG,OADF,CACU,UAACskB,QAAD,EAA0B;CAClC,cAAIxnB,IAAI,GAAG,MAAI,CAACs0B,aAAL,CAAmBsN,gBAAnB,CAAoCpa,QAAQ,CAAC5rB,EAA7C,CAAX;;CACA,cAAI,CAACoE,IAAL,EACA;CACCA,YAAAA,IAAI,GAAG8O,IAAI,CAAC2Y,SAAL,CAAeD,QAAf,CAAP;CACA0kB,YAAAA,QAAQ,CAACjmC,GAAT,CAAajG,IAAI,CAAC+N,KAAL,EAAb;CACA;;CACDk+B,UAAAA,WAAW,CAACn+B,GAAZ,CAAgB9N,IAAI,CAAC+N,KAAL,EAAhB,EAA8B/N,IAA9B;CACA,SATF;CAWAisC,QAAAA,WAAW,CAAC/oC,OAAZ,CAAoB,UAAClD,IAAD,EAAgB;CACnC,cAAMmsC,cAAc,GAAGJ,eAAe,CAAC7wB,GAAhB,CAAoBlb,IAAI,CAAC+N,KAAL,EAApB,CAAvB;;CACA,cAAI/N,IAAI,CAACwQ,YAAL,MAAuBxQ,IAAI,CAACsjB,eAAL,EAA3B,EACA;CACCtjB,YAAAA,IAAI,CAAC8W,YAAL;CACA;;CACD9W,UAAAA,IAAI,CAAC4P,OAAL,CAAau8B,cAAc,CAACt8B,IAA5B;;CACA,cAAIq8B,QAAQ,CAACvnC,GAAT,CAAa3E,IAAI,CAAC+N,KAAL,EAAb,CAAJ,EACA;CACC/N,YAAAA,IAAI,CAACoS,eAAL,CAAqB,CAArB;CACA;;CACD,cAAM4vB,YAAY,GAAG,MAAI,CAAC1N,aAAL,CAAmB2N,oBAAnB,CAAwCjiC,IAAI,CAAC8U,WAAL,EAAxC,CAArB;;CACA,cAAIktB,YAAJ,EACA;CACC,gBAAMoK,cAAc,GACnBxuC,cAAI,CAACC,WAAL,CAAiBsuC,cAAc,CAACp8B,QAAhC,IACG/P,IAAI,CAAC8U,WAAL,EADH,GAEGq3B,cAAc,CAACp8B,QAHnB;;CAKA,gBAAI41B,YAAY,GAAG,MAAI,CAACrR,aAAL,CAAmB2N,oBAAnB,CAAwCmK,cAAxC,CAAnB;;CACA,gBAAI,CAACzG,YAAD,IAAiB3D,YAAY,CAACj0B,KAAb,OAAyB43B,YAAY,CAAC53B,KAAb,EAA9C,EACA;CACC43B,cAAAA,YAAY,GAAG3D,YAAf;CACA;;CACD,YAAA,MAAI,CAACwI,SAAL,CAAe6B,cAAf,CAA8BrK,YAA9B,EAA4C2D,YAA5C,EAA0D3lC,IAA1D;;CACA,YAAA,MAAI,CAACs0B,aAAL,CAAmBJ,oBAAnB;CACA;CACD,SA3BD;CA4BA,OA7CF,WA8CQ,UAACx2B,QAAD,EAAc,EA9CtB;CAgDA;CA1MF;CAAA;CAAA,iCA4Mc3B,MA5Md,EA6MC;CAAA;;CACC,UAAMuwC,YAAY,GAAG1uC,cAAI,CAACkM,OAAL,CAAa/N,MAAM,CAACuwC,YAApB,IAAoCvwC,MAAM,CAACuwC,YAA3C,GAA0D,EAA/E;;CAEA,UAAIA,YAAY,CAACC,QAAb,CAAsB,KAAK9B,aAAL,CAAmBpjC,QAAnB,EAAtB,CAAJ,EACA;CACC,YAAMmlC,KAAK,GAAGzwC,MAAM,CAAC0wC,WAAP,CAAmB9jC,KAAnB,CAAyB,GAAzB,CAAd;;CACA,YAAI6jC,KAAJ,EACA;CACC,cAAMv8B,UAAU,GAAGu8B,KAAK,CAAC,CAAD,CAAxB;CACA,cAAMzyB,MAAM,GAAGyyB,KAAK,CAAC,CAAD,CAApB;CACA,cAAMxsC,IAAI,GAAG,KAAKs0B,aAAL,CAAmBoY,kBAAnB,CAAsC3yB,MAAtC,CAAb;;CACA,cAAI9J,UAAU,KAAK,MAAf,IAAyBjQ,IAA7B,EACA;CACC,iBAAKpB,aAAL,CAAmB+tC,eAAnB,CAAmC;CAClC5yB,cAAAA,MAAM,EAAE/Z,IAAI,CAACuR,WAAL;CAD0B,aAAnC,EAEGlV,IAFH,CAEQ,UAACqB,QAAD,EAAc;CACrB,kBAAMgW,OAAO,GAAG5E,IAAI,CAAC2Y,SAAL,CAAe/pB,QAAQ,CAACZ,IAAT,CAAc0qB,QAA7B,CAAhB;;CACA,cAAA,MAAI,CAACqkB,UAAL,CAAgBn4B,OAAhB,EAAyB1T,IAAzB;CACA,aALD,WAKS,UAACtC,QAAD,EAAc;CACtB,cAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,aAPD;CAQA;CACD;CACD;CACD;CArOF;CAAA;CAAA,oCAuOiBsC,IAvOjB,EAwOC;CAAA;;CACC,UAAIA,IAAI,CAAC8Q,SAAL,EAAJ,EACA;CACC,YAAMvD,UAAU,GAAG,KAAK+mB,aAAL,CAAmBoY,kBAAnB,CAAsC1sC,IAAI,CAAC+U,eAAL,EAAtC,CAAnB;;CAEA,YAAIxH,UAAU,IAAI,CAACA,UAAU,CAACq/B,mBAAX,EAAnB,EACA;CACCr/B,UAAAA,UAAU,CAACuJ,YAAX;CACAvJ,UAAAA,UAAU,CAACs/B,aAAX;CACA;;CAED;CACA;;CAED,WAAKjuC,aAAL,CAAmBkuC,eAAnB,CAAmC;CAClC/yB,QAAAA,MAAM,EAAE/Z,IAAI,CAACuR,WAAL;CAD0B,OAAnC,EAEGlV,IAFH,CAEQ,UAACqB,QAAD,EAAc;CACrB,YAAI,CAACA,QAAQ,CAACZ,IAAT,CAAc6H,GAAnB,EACA;CACC;CACA;;CAED,YAAM0T,MAAM,GAAG,MAAI,CAACic,aAAL,CAAmB2N,oBAAnB,CAAwCjiC,IAAI,CAAC8U,WAAL,EAAxC,CAAf;;CACA,YAAI,CAACuD,MAAL,EACA;CACC;CACA;;CAED,YAAM00B,YAAY,GAAG,MAAI,CAACzY,aAAL,CAAmBoY,kBAAnB,CAAsC1sC,IAAI,CAACuR,WAAL,EAAtC,CAArB;;CACA,YAAIw7B,YAAJ,EACA;CACC;CACA;;CAED,QAAA,MAAI,CAACvC,SAAL,CAAe6B,cAAf,CAA8Bh0B,MAA9B,EAAsCA,MAAtC,EAA8CrY,IAA9C;;CACA,QAAA,MAAI,CAACs0B,aAAL,CAAmBJ,oBAAnB;CACA,OAtBD,WAsBS,UAACx2B,QAAD,EAAc;CACtB,QAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAxBD;CAyBA;CA/QF;CAAA;CAAA,+BAiRYgW,OAjRZ,EAiR2B1T,IAjR3B,EAkRC;CACC,UAAI,CAACA,IAAL,EACA;CACCA,QAAAA,IAAI,GAAG,KAAKs0B,aAAL,CAAmBsN,gBAAnB,CAAoCluB,OAAO,CAAC3F,KAAR,EAApC,CAAP;CACA;;CAED,UAAI/N,IAAJ,EACA;CACC,YAAMgtC,oBAAoB,GAAGt5B,OAAO,CAAC5C,SAAR,OAAwB9Q,IAAI,CAAC8Q,SAAL,EAArD;;CACA,YAAIk8B,oBAAJ,EACA;CACC,cAAIt5B,OAAO,CAAC5C,SAAR,EAAJ,EACA;CACC,gBAAMuH,MAAM,GAAG,KAAKic,aAAL,CAAmB4P,kBAAnB,CAAsClkC,IAAI,CAAC+N,KAAL,EAAtC,CAAf;CACAsK,YAAAA,MAAM,CAACgM,UAAP,CAAkBrkB,IAAlB;CACAA,YAAAA,IAAI,CAACyN,cAAL;CACA;;CAED;CACA;;CAED,YAAM2+B,cAAc,GAAG14B,OAAO,CAACoB,WAAR,EAAvB;CACA,YAAMitB,cAAc,GAAG/hC,IAAI,CAAC8U,WAAL,EAAvB;CACA,YAAM6wB,YAAY,GAAG,KAAKrR,aAAL,CAAmB2N,oBAAnB,CAAwCmK,cAAxC,CAArB;CACA,YAAMpK,YAAY,GAAG,KAAK1N,aAAL,CAAmB2N,oBAAnB,CAAwCF,cAAxC,CAArB;;CAEA,YAAIruB,OAAO,CAACoB,WAAR,OAA0B9U,IAAI,CAAC8U,WAAL,EAA9B,EACA;CACC,cAAI6wB,YAAY,IAAI3D,YAApB,EACA;CACC,iBAAKwI,SAAL,CAAe6B,cAAf,CAA8BrK,YAA9B,EAA4C2D,YAA5C,EAA0D3lC,IAA1D;CACA,iBAAKs0B,aAAL,CAAmBJ,oBAAnB;CACA;CACD,SAPD,MASA;CACC,eAAK0P,oBAAL,CAA0B+B,YAA1B;CACA;;CAED3lC,QAAAA,IAAI,CAACkqC,cAAL,CAAoBx2B,OAApB;CACA,OAlCD,MAoCA;CACC,YAAIA,OAAO,CAAC5C,SAAR,EAAJ,EACA;CACC,cAAMs7B,eAAc,GAAG14B,OAAO,CAACoB,WAAR,EAAvB;;CACA,cAAM6wB,aAAY,GAAG,KAAKrR,aAAL,CAAmB2N,oBAAnB,CAAwCmK,eAAxC,CAArB;;CAEA,eAAKxI,oBAAL,CAA0B+B,aAA1B;CACA,SAND,MAQA;CACC,eAAKgG,eAAL,CAAqBj4B,OAArB;CACA;CACD;CACD;CAzUF;CAAA;CAAA,yCA2UsBsuB,YA3UtB,EA2U4CY,SA3U5C,EA4UC;CACC,UAAMlsB,QAAQ,GAAG,IAAIhT,GAAJ,EAAjB;CAEAgT,MAAAA,QAAQ,CAAC5I,GAAT,CAAak0B,YAAY,CAACj0B,KAAb,EAAb,EAAmCi0B,YAAnC;;CACA,UAAIY,SAAJ,EACA;CACClsB,QAAAA,QAAQ,CAAC5I,GAAT,CAAa80B,SAAS,CAAC70B,KAAV,EAAb,EAAgC60B,SAAhC;CACA;;CAED,WAAKvC,cAAL,CAAoBiF,cAApB,CAAmC5uB,QAAnC;CACA;CAtVF;CAAA;CAAA,oCAwViBxS,SAxVjB,EAyVC;CAAA;;CACC,UAAMw7B,YAAY,GAAGx7B,SAAS,CAAC4N,OAAV,EAArB;CAEAY,MAAAA,MAAM,CAAC+E,OAAP,CAAeioB,YAAf,EAA6Bx8B,OAA7B,CAAqC,iBAAoB;CAAA;CAAA,YAAlB2T,MAAkB;CAAA,YAAVzG,IAAU;;CACxD,YAAIsC,MAAM,CAACu6B,SAAP,CAAiB5Z,cAAjB,CAAgC6Z,IAAhC,CAAqC98B,IAArC,EAA2C,OAA3C,CAAJ,EACA;CACC,UAAA,MAAI,CAAC+8B,qBAAL,CAA2B/8B,IAAI,CAACT,KAAhC;CACA;CACD,OALD;CAMA;CAlWF;CAAA;CAAA,yCAoWsBA,KApWtB,EAqWC;CACC,WAAKu5B,mBAAL,CAAyBjjC,GAAzB,CAA6B0J,KAA7B;CACA;CAvWF;CAAA;CAAA,wCAyWqBkH,MAzWrB,EA0WC;CACC,WAAKsyB,qBAAL,CAA2BljC,GAA3B,CAA+B4Q,MAA/B;CACA;CA5WF;CAAA;CAAA,wCA8WqBA,MA9WrB,EA+WC;CACC,WAAKuyB,qBAAL,CAA2BnjC,GAA3B,CAA+B4Q,MAA/B;CACA;CAjXF;CAAA;CAAA,0CAmXuBlH,KAnXvB,EAoXC;CACC,WAAKg7B,oBAAL,CAA0B1kC,GAA1B,CAA8B0J,KAA9B;CACA;CAtXF;CAAA;CAAA,gCAwXakH,MAxXb,EAyXC;CAAA;;CACC,aAAO,IAAI9Z,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvC8a,QAAAA,UAAU,CAAC;CAAA,iBAAO,MAAI,CAAC6zB,YAAL,CAAkB/0B,MAAlB,IAA4B7Z,OAAO,EAAnC,GAAwCC,MAAM,EAArD;CAAA,SAAD,EAA2D,IAA3D,CAAV;CACA,OAFM,CAAP;CAGA;CA7XF;CAAA;CAAA,iCA+Xc4Z,MA/Xd,EAgYC;CACC,aAAO,KAAK6zB,oBAAL,CAA0B/lC,GAA1B,CAA8BkS,MAA9B,CAAP;CACA;CAlYF;CAAA;CAAA,kCAoYeA,MApYf,EAqYC;CACC,WAAK6zB,oBAAL,CAA0BzkC,GAA1B,CAA8B4Q,MAA9B;CACA;CAvYF;CAAA;CAAA,oCAyYiBA,MAzYjB,EA0YC;CACC,WAAK6zB,oBAAL,WAAiC7zB,MAAjC;CACA;CA5YF;CAAA;CAAA,gCA8YalH,KA9Yb,EA+YC;CACC,aAAO,KAAKu5B,mBAAL,CAAyBvkC,GAAzB,CAA6BgL,KAA7B,CAAP;CACA;CAjZF;CAAA;CAAA,iCAmZcA,KAnZd,EAoZC;CACC,WAAKu5B,mBAAL,WAAgCv5B,KAAhC;CACA;CAtZF;CAAA;CAAA,mCAwZgB3P,IAxZhB,EAyZC;CACC,aAAO,KAAKmpC,qBAAL,CAA2BxkC,GAA3B,CAA+B3E,IAAI,CAAC+N,KAAL,EAA/B,CAAP;CACA;CA3ZF;CAAA;CAAA,oCA6ZiB/N,IA7ZjB,EA8ZC;CACC,WAAKmpC,qBAAL,WAAkCnpC,IAAI,CAAC+N,KAAL,EAAlC;CACA;CAhaF;CAAA;CAAA,mCAkagB8I,MAlahB,EAmaC;CACC,aAAO,KAAKuyB,qBAAL,CAA2BzkC,GAA3B,CAA+BkS,MAA/B,CAAP;CACA;CAraF;CAAA;CAAA,oCAuaiBA,MAvajB,EAwaC;CACC,WAAKuyB,qBAAL,WAAkCvyB,MAAlC;CACA;CA1aF;CAAA;CAAA,iCA4aclH,KA5ad,EA6aC;CACC,aAAO,KAAKg7B,oBAAL,CAA0BhmC,GAA1B,CAA8BgL,KAA9B,CAAP;CACA;CA/aF;CAAA;CAAA,kCAibeA,KAjbf,EAkbC;CACC,WAAKg7B,oBAAL,WAAiCh7B,KAAjC;CACA;CApbF;CAAA;CAAA;;KCfay9B,QAAb;CAEC,oBAAYrxC,MAAZ,EACA;CAAA;CACC,SAAK6C,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,SAAK01B,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA,SAAKzqB,IAAL,GAAY9N,MAAM,CAAC8N,IAAnB;CAEA,SAAKq/B,mBAAL,GAA2B,IAAIxkC,GAAJ,EAA3B;CACA,SAAKykC,qBAAL,GAA6B,IAAIzkC,GAAJ,EAA7B;CACA,SAAK0kC,qBAAL,GAA6B,IAAI1kC,GAAJ,EAA7B;CACA;;CAXF;CAAA;CAAA,kCAcC;CACC,aAAO,OAAP;CACA;CAhBF;CAAA;CAAA,6BAmBC;CACC,aAAO;CACN2oC,QAAAA,SAAS,EAAE,KAAKC,WAAL,CAAiBluC,IAAjB,CAAsB,IAAtB,CADL;CAENmuC,QAAAA,WAAW,EAAE,KAAKC,aAAL,CAAmBpuC,IAAnB,CAAwB,IAAxB,CAFP;CAGNquC,QAAAA,WAAW,EAAE,KAAKC,aAAL,CAAmBtuC,IAAnB,CAAwB,IAAxB;CAHP,OAAP;CAKA;CAzBF;CAAA;CAAA,gCA2BauuC,QA3Bb,EA4BC;CACC,WAAK9jC,IAAL,CAAU8+B,UAAV,CAAsB,IAAIiF,0BAAJ,EAAD,CAAkBC,OAAlB,CAA0BF,QAA1B,CAArB;CACA;CA9BF;CAAA;CAAA,kCAgCeA,QAhCf,EAiCC;CACC,WAAK9jC,IAAL,CAAU++B,WAAV,CAAuB,IAAIgF,0BAAJ,EAAD,CAAkBC,OAAlB,CAA0BF,QAA1B,CAAtB;CACA;CAnCF;CAAA;CAAA,kCAqCeA,QArCf,EAsCC;CACC,WAAK9jC,IAAL,CAAUg/B,aAAV,CAAyB,IAAI+E,0BAAJ,EAAD,CAAkBC,OAAlB,CAA0BF,QAA1B,CAAxB;CACA;CAxCF;CAAA;CAAA;;KCAaG,YAAb;CAEC,wBAAY/xC,MAAZ,EACA;CAAA;CACC,SAAK6C,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,SAAK01B,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA,SAAK7b,aAAL,GAAqB1c,MAAM,CAAC0c,aAA5B;CACA,SAAK5U,MAAL,GAAc9H,MAAM,CAAC8H,MAArB;CACA,SAAKE,OAAL,GAAehI,MAAM,CAACgI,OAAtB;CACA;;CATF;CAAA;CAAA,kCAYC;CACC,aAAO,OAAP;CACA;CAdF;CAAA;CAAA,6BAiBC;CACC,aAAO;CACNgqC,QAAAA,SAAS,EAAE,KAAKC,UAAL,CAAgB5uC,IAAhB,CAAqB,IAArB,CADL;CAEN6uC,QAAAA,cAAc,EAAE,KAAKC,iBAAL,CAAuB9uC,IAAvB,CAA4B,IAA5B;CAFV,OAAP;CAIA;CAtBF;CAAA;CAAA,+BAwBYtC,IAxBZ,EAyBC;CAAA;;CACC,UAAMqxC,WAAW,GAAGrqC,QAAQ,CAAChH,IAAI,CAACsxC,OAAN,EAAe,EAAf,CAA5B;CACA,UAAMC,WAAW,GAAGvqC,QAAQ,CAAChH,IAAI,CAACwxC,OAAN,EAAe,EAAf,CAA5B;;CAEA,UAAID,WAAW,KAAK,KAAKxqC,MAAzB,EACA;CACC;CACA;;CAED,UAAI7D,IAAI,GAAG,KAAKs0B,aAAL,CAAmBoY,kBAAnB,CAAsCyB,WAAtC,CAAX;;CACA,UAAI,CAACnuC,IAAL,EACA;CACCA,QAAAA,IAAI,GAAG,KAAKs0B,aAAL,CAAmBia,0CAAnB,CAA8DJ,WAA9D,CAAP;CACA;;CAED,UAAInuC,IAAJ,EACA;CACC,aAAKpB,aAAL,CAAmB+tC,eAAnB,CAAmC;CAClC5yB,UAAAA,MAAM,EAAE/Z,IAAI,CAACuR,WAAL;CAD0B,SAAnC,EAEGlV,IAFH,CAEQ,UAACqB,QAAD,EAAc;CACrBsC,UAAAA,IAAI,CAACkqC,cAAL,CAAoBp7B,IAAI,CAAC2Y,SAAL,CAAe/pB,QAAQ,CAACZ,IAAT,CAAc0qB,QAA7B,CAApB;CACA,SAJD,WAIS,UAAC9pB,QAAD,EAAc;CACtB,UAAA,KAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,SAND;CAOA;CACD;CAlDF;CAAA;CAAA,sCAoDmBZ,IApDnB,EAqDC;CACC,UAAMiH,OAAO,GAAGjH,IAAI,CAAC0xC,QAArB;;CAEA,UAAIzqC,OAAO,IAAIA,OAAO,KAAK,KAAKA,OAAhC,EACA;CACC,aAAK0U,aAAL,CAAmBhX,WAAnB;CACA;CACD;CA5DF;CAAA;CAAA;;KCMagtC,YAAb;CAEC,wBAAY1yC,MAAZ,EACA;CAAA;CACC,SAAK6C,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,SAAK01B,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA,SAAK7b,aAAL,GAAqB1c,MAAM,CAAC4H,MAA5B;CAEA,SAAKH,kBAAL,GAA0BzH,MAAM,CAACyH,kBAAjC;CAEA,SAAKK,MAAL,GAAcC,QAAQ,CAAC/H,MAAM,CAAC8H,MAAR,EAAgB,EAAhB,CAAtB;CACA,SAAKE,OAAL,GAAeD,QAAQ,CAAC/H,MAAM,CAACgI,OAAR,EAAiB,EAAjB,CAAvB;CAEA,SAAKJ,MAAL,GAAc,KAAK8U,aAAL,CAAmBi2B,gBAAnB,EAAd;CAEA,SAAKC,YAAL;CACA,SAAKn0C,UAAL;CACA,SAAKo0C,eAAL;CACA;;CAlBF;CAAA;CAAA,iCAqBC;CACCn0C,MAAAA,6BAAY,CAACC,SAAb,CAAuB,sBAAvB,EAA+C,KAAKm0C,aAAL,CAAmBzvC,IAAnB,CAAwB,IAAxB,CAA/C;CACA3E,MAAAA,6BAAY,CAACC,SAAb,CAAuB,sBAAvB,EAA+C,KAAKo0C,cAAL,CAAoB1vC,IAApB,CAAyB,IAAzB,CAA/C;CACA;CAxBF;CAAA;CAAA,sCA2BC;CACC2vC,MAAAA,gBAAI,CAACr0C,SAAL,CAAe,IAAIozC,YAAJ,CAAiB;CAC/BlvC,QAAAA,aAAa,EAAE,KAAKA,aADW;CAE/B01B,QAAAA,aAAa,EAAE,KAAKA,aAFW;CAG/B7b,QAAAA,aAAa,EAAE,KAAKA,aAHW;CAI/B5U,QAAAA,MAAM,EAAE,KAAKA,MAJkB;CAK/BE,QAAAA,OAAO,EAAE,KAAKA;CALiB,OAAjB,CAAf;CAOA;CAnCF;CAAA;CAAA,oCAsCC;CACC,WAAK4qC,YAAL;CACA;CAxCF;CAAA;CAAA,mCA2CC;CACC,WAAKK,MAAL,GAAc,KAAKrrC,MAAL,CAAYpC,qBAAZ,EAAd;CACA;CA7CF;CAAA;CAAA,mCA+CgB2C,SA/ChB,EAgDC;CACC,UAAMpH,IAAI,GAAGoH,SAAS,CAAC4N,OAAV,EAAb;;CAEA,UAAIhV,IAAI,CAACmyC,OAAL,IAAgBnyC,IAAI,CAACmyC,OAAL,CAAatrC,MAAjC,EACA;CACC,aAAKurC,aAAL,iCAAqBpyC,IAAI,CAACmyC,OAAL,CAAaE,WAAlC,EAAgDryC,IAAI,CAACmyC,OAAL,CAAaG,WAA7D;CACA;CACD;CAvDF;CAAA;CAAA,sCAyDmBlmB,KAzDnB,EA0DC;CACC,UAAI,CAACxW,MAAM,CAACC,IAAP,CAAY,KAAKq8B,MAAjB,EAAyBzC,QAAzB,CAAkCrjB,KAAlC,CAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAItrB,cAAI,CAACkM,OAAL,CAAa,KAAKklC,MAAL,CAAY9lB,KAAZ,CAAb,CAAJ,EACA;CACC,eAAO,KAAK8lB,MAAL,CAAY9lB,KAAZ,EAAmBnrB,MAAnB,GAA4B,CAAnC;CACA;;CAED,aAAO,KAAKixC,MAAL,CAAY9lB,KAAZ,MAAuB,EAA9B;CACA;CAtEF;CAAA;CAAA,2CAwEwBA,KAxExB,EAwE+BjoB,KAxE/B,EAyEC;CACC,aAAO,KAAKouC,iBAAL,CAAuBnmB,KAAvB,KAAiC,KAAK8lB,MAAL,CAAY9lB,KAAZ,MAAuBjoB,KAA/D;CACA;CA3EF;CAAA;CAAA,kCA6EeioB,KA7Ef,EA8EC;CAAA;;CACC,UAAMptB,IAAI,GAAG4W,MAAM,CAACC,IAAP,CAAYuW,KAAZ,EAAmB,CAAnB,CAAb;CACA,UAAMjoB,KAAK,GAAGioB,KAAK,CAACptB,IAAD,CAAnB;;CAEA,UAAI,CAAC,KAAKwzC,sBAAL,CAA4BxzC,IAA5B,EAAkCmF,KAAlC,CAAL,EACA;CACC,aAAK0C,MAAL,CAAYzC,MAAZ,GAAqBC,YAArB,iCAAoCrF,IAApC,EAA2CmF,KAA3C;CACA;CACA;;CAED,WAAK0C,MAAL,CAAY4rC,eAAZ,GAA8BrsC,OAA9B,CAAsC,UAACgmB,KAAD,EAAW;CAChD,YAAIA,KAAK,CAACsmB,YAAN,CAAmB,WAAnB,MAAoC1zC,IAAxC,EACA;CACC,UAAA,KAAI,CAAC6H,MAAL,CAAY8rC,SAAZ,GAAwBC,WAAxB,CAAoCxmB,KAApC;CACA;CACD,OALD;CAOA,WAAKvlB,MAAL,CAAYtE,SAAZ,GAAwBswC,KAAxB;CACA;CAhGF;CAAA;CAAA;;KCUaC,aAAb;CAEC,yBAAY7zC,MAAZ,EACA;CAAA;CACC,SAAK4H,MAAL,GAAc5H,MAAM,CAAC4H,MAArB;CACA,SAAK/E,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,SAAK01B,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA,SAAKD,WAAL,GAAmBt4B,MAAM,CAACs4B,WAA1B;CACA,SAAKlR,QAAL,GAAgBpnB,MAAM,CAAConB,QAAvB;CAEA,SAAKxf,MAAL,CAAYjJ,SAAZ,CAAsB,aAAtB,EAAqC,KAAKyE,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAArC;CACA;;CAXF;CAAA;CAAA,kCAae8E,SAbf,EAcC;CAAA;;CACC,WAAKm5B,UAAL;CAEA,UAAMwS,iBAAiB,GAAG9uC,aAAG,CAACyN,WAAJ,CAAgB,KAAK6lB,WAAL,CAAiByb,iBAAjB,EAAhB,CAA1B;CAEA,UAAMxhC,MAAM,GAAG,IAAIG,kBAAJ,CAAW;CACzBxD,QAAAA,MAAM,EAAE,KAAKopB,WAAL,CAAiByb,iBAAjB,EADiB;CAEzBphC,QAAAA,MAAM,EAAE;CACPxS,UAAAA,GAAG,YAAK2zC,iBAAiB,CAAC3zC,GAAlB,GAAwB,CAA7B;CADI;CAFiB,OAAX,CAAf;CAOAoS,MAAAA,MAAM,CAAC7R,IAAP;CAEA,WAAKmC,aAAL,CAAmB6C,WAAnB,CAA+B;CAC9B0hB,QAAAA,QAAQ,EAAE,KAAKA;CADe,OAA/B,EAEG9mB,IAFH,CAEQ,UAACqB,QAAD,EAAmC;CAE1C,YAAMqyC,iBAAiB,GAAGryC,QAAQ,CAACZ,IAAT,CAAcgE,KAAxC;;CAEA,QAAA,KAAI,CAACwzB,aAAL,CAAmByJ,WAAnB,GAAiC76B,OAAjC,CAAyC,UAAClD,IAAD,EAAgB;CACxD,cAAMqY,MAAM,GAAG,KAAI,CAACic,aAAL,CAAmB2N,oBAAnB,CAAwCjiC,IAAI,CAAC8U,WAAL,EAAxC,CAAf;;CACAuD,UAAAA,MAAM,CAACgM,UAAP,CAAkBrkB,IAAlB;;CACA,cAAIA,IAAI,CAACsjB,eAAL,EAAJ,EACA;CACCtjB,YAAAA,IAAI,CAAC8W,YAAL;CACA;;CACD9W,UAAAA,IAAI,CAACyN,cAAL;CACA,SARD;;CAUA,YAAMiqB,gBAAgB,GAAG,IAAIh0B,GAAJ,EAAzB;CAEAqsC,QAAAA,iBAAiB,CAAC7sC,OAAlB,CAA0B,UAAC+uB,UAAD,EAA4B;CACrD,cAAMjyB,IAAI,GAAG8O,IAAI,CAAC2Y,SAAL,CAAewK,UAAf,CAAb;;CACA,cAAM5Z,MAAM,GAAG,KAAI,CAACic,aAAL,CAAmB2N,oBAAnB,CAAwCjiC,IAAI,CAAC8U,WAAL,EAAxC,CAAf;;CACA,cAAIpX,QAAQ,CAACZ,IAAT,CAAc46B,gBAAd,CAA+B35B,MAAnC,EACA;CACCL,YAAAA,QAAQ,CAACZ,IAAT,CAAc46B,gBAAd,CACEx0B,OADF,CACU,UAACg2B,YAAD,EAAgC;CACxC,kBAAIl5B,IAAI,CAAC8U,WAAL,OAAuBokB,YAAY,CAACt9B,EAAxC,EACA;CACC,oBAAI87B,gBAAgB,CAAC/yB,GAAjB,CAAqB3E,IAAI,CAAC8U,WAAL,EAArB,CAAJ,EACA;CACC4iB,kBAAAA,gBAAgB,CAACxc,GAAjB,CAAqBlb,IAAI,CAAC8U,WAAL,EAArB,EAAyCiyB,OAAzC,CAAiD/mC,IAAjD;CACA,iBAHD,MAKA;CACC,sBAAMgwC,eAAe,GAAG3f,MAAM,CAACkH,WAAP,CAAmB2B,YAAnB,CAAxB;CACA8W,kBAAAA,eAAe,CAACjJ,OAAhB,CAAwB/mC,IAAxB;CACAgwC,kBAAAA,eAAe,CAACltB,YAAhB,CAA6B,GAA7B;CAEA4U,kBAAAA,gBAAgB,CAAC5pB,GAAjB,CAAqBkiC,eAAe,CAACjiC,KAAhB,EAArB,EAA8CiiC,eAA9C;CACA;CACD;CACD,aAjBF;CAmBA;;CAED,cAAI33B,MAAM,IAAI,CAACA,MAAM,CAAC9P,WAAP,EAAf,EACA;CACCvI,YAAAA,IAAI,CAAC8iB,YAAL,CAAkBzK,MAAM,CAACwL,YAAP,EAAlB;CAEAxL,YAAAA,MAAM,CAAC43B,gBAAP,CAAwBjwC,IAAxB;CACAqY,YAAAA,MAAM,CAAC0uB,OAAP,CAAe/mC,IAAf;CAEAqY,YAAAA,MAAM,CAACmmB,kBAAP,CAA0B,KAA1B;CACAnmB,YAAAA,MAAM,CAACqM,eAAP;CACA;CACD,SApCD;CAsCA,YAAMxB,oBAAoB,GAAGxlB,QAAQ,CAACZ,IAAT,CAAcomB,oBAAd,KAAuC,GAApE;;CAEA,QAAA,KAAI,CAACoR,aAAL,CAAmB8N,cAAnB,GACEl/B,OADF,CACU,UAACmV,MAAD,EAAoB;CAC5BA,UAAAA,MAAM,CAAC4K,qBAAP,CAA6BvlB,QAAQ,CAACZ,IAAT,CAAcomB,oBAA3C;;CACA,cAAI,CAAC7K,MAAM,CAAC9P,WAAP,EAAD,IAAyB8P,MAAM,CAAC5L,OAAP,EAA7B,EACA;CACC,gBAAI4L,MAAM,CAACkO,cAAP,KAA0B,CAA1B,IAA+BlO,MAAM,CAAC6K,oBAAP,EAAnC,EACA;CACC7K,cAAAA,MAAM,CAACqa,mBAAP;CACAra,cAAAA,MAAM,CAAC0L,YAAP;CACA,aAJD,MAMA;CACC,kBAAI,KAAI,CAACuQ,aAAL,CAAmB4b,oBAAnB,EAAJ,EACA;CACC73B,gBAAAA,MAAM,CAACsa,YAAP;CACA;;CACDta,cAAAA,MAAM,CAAC2L,mBAAP;CACA;CACD;;CACD,cAAI,CAAC3L,MAAM,CAACwO,SAAP,EAAD,IAAuB,CAACxO,MAAM,CAAC9P,WAAP,EAA5B,EACA;CACC8P,YAAAA,MAAM,CAAC+K,kBAAP,CAA0BwG,IAAI,CAACumB,IAAL,CAAW93B,MAAM,CAAC8M,cAAP,KAA0B9M,MAAM,CAAC+3B,WAAP,EAArC,CAA1B;CACA;CACD,SAvBF;;CA0BA,QAAA,KAAI,CAAC/b,WAAL,CAAiBrQ,mBAAjB;;CAEA,YAAI0T,gBAAgB,CAAC7pB,IAArB,EACA;CACC,UAAA,KAAI,CAACwmB,WAAL,CAAiByE,4BAAjB,CAA8CpB,gBAA9C;CACA,SAHD,MAKA;CACC,UAAA,KAAI,CAACrD,WAAL,CAAiBgc,4BAAjB;;CAEA,cAAIntB,oBAAJ,EACA;CACC,YAAA,KAAI,CAACmR,WAAL,CAAiB3B,mBAAjB;CACA;CACD;;CAED,QAAA,KAAI,CAACkL,SAAL;;CAEAtvB,QAAAA,MAAM,CAACM,IAAP;CACA,OAvGD,WAuGS,UAAClR,QAAD,EAAc;CAEtB,QAAA,KAAI,CAACkgC,SAAL;;CAEAtvB,QAAAA,MAAM,CAACM,IAAP;;CAEA,QAAA,KAAI,CAAChQ,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OA9GD;CA+GA;CA3IF;CAAA;CAAA,iCA8IC;CACC,WAAK42B,aAAL,CAAmBI,UAAnB,GAAgC6J,OAAhC;CAEA,WAAKjK,aAAL,CAAmBgE,UAAnB,GAAgCp1B,OAAhC,CAAwC,UAACqlB,MAAD,EAAoB;CAC3D,YAAI,CAACA,MAAM,CAAChgB,WAAP,EAAL,EACA;CACCggB,UAAAA,MAAM,CAACgW,OAAP;CACA;CACD,OALD;CAMA;CAvJF;CAAA;CAAA,gCA0JC;CACC,WAAKjK,aAAL,CAAmBI,UAAnB,GAAgC+J,MAAhC;CAEA,WAAKnK,aAAL,CAAmBgE,UAAnB,GAAgCp1B,OAAhC,CAAwC,UAACqlB,MAAD,EAAoB;CAC3D,YAAI,CAACA,MAAM,CAAChgB,WAAP,EAAL,EACA;CACCggB,UAAAA,MAAM,CAACkW,MAAP;CACA;CACD,OALD;CAMA;CAnKF;CAAA;CAAA;;KC1Ba6R,aAAb;CAEC,yBAAYv0C,MAAZ,EACA;CAAA;CACC,SAAKwR,UAAL,GAAkBxR,MAAM,CAACwR,UAAzB;CAEA,SAAKhE,KAAL,GAAa,CAAb;CACA;;CAPF;CAAA;CAAA,oCAUC;CACC,aAAO,KAAKgE,UAAZ;CACA;CAZF;CAAA;CAAA,uDAeC;CACC,WAAKhE,KAAL;CACA;CAjBF;CAAA;CAAA,uDAoBC;CACC,aAAO,KAAKA,KAAZ;CACA;CAtBF;CAAA;CAAA;;KCaagnC,OAAb;CAEC,mBAAYx0C,MAAZ,EACA;CAAA;CACC,SAAK6C,aAAL,GAAqB7C,MAAM,CAAC6C,aAA5B;CACA,SAAK01B,aAAL,GAAqBv4B,MAAM,CAACu4B,aAA5B;CACA,SAAKvwB,OAAL,GAAehI,MAAM,CAACgI,OAAtB;CACA;;CAPF;CAAA;CAAA,kCAUC;CACC,aAAO,OAAP;CACA;CAZF;CAAA;CAAA,6BAeC;CACC,aAAO;CACNysC,QAAAA,WAAW,EAAE,KAAKC,YAAL,CAAkBrxC,IAAlB,CAAuB,IAAvB;CADP,OAAP;CAGA;CAnBF;CAAA;CAAA,iCAqBcrD,MArBd,EAsBC;CAAA;;CACC,UAAI20C,UAAU,GAAGp2C,EAAE,CAACslB,EAAH,CAAMhG,cAAN,CAAqB3D,MAArB,CAA4B06B,YAA5B,EAAjB;CACAD,MAAAA,UAAU,CAACxtC,OAAX,CAAmB,UAAAyX,MAAM,EAAI;CAC5BA,QAAAA,MAAM,CAAC/L,IAAP;CACA,OAFD;;CAGA,UAAI9K,QAAQ,CAAC,KAAKC,OAAN,EAAe,EAAf,CAAR,KAA+BhI,MAAM,CAACgI,OAA1C,EACA;CACC;CACA;;CACD,WAAKuwB,aAAL,CAAmBI,UAAnB,GAAgC6J,OAAhC;CAEA,UAAMqS,WAAW,GAAG70C,MAAM,CAAC80C,YAA3B;CACA,UAAIC,UAAU,GAAG/0C,MAAM,CAACg1C,UAAxB;CACA,UAAM9yB,MAAM,GAAGliB,MAAM,CAACi1C,UAAtB;CAEA,UAAMlwC,KAAK,GAAG,KAAKwzB,aAAL,CAAmByJ,WAAnB,EAAd;CACA,UAAMkT,aAAa,GAAG,IAAIvsC,GAAJ,EAAtB;CACA5D,MAAAA,KAAK,CAACoC,OAAN,CAAc,UAAClD,IAAD,EAAgB;CAC7B,YAAM8K,IAAI,GAAG9K,IAAI,CAACuU,OAAL,GAAelJ,QAAf,EAAb;;CACA,YAAIP,IAAI,CAACvK,IAAL,CAAU,UAACyK,GAAD;CAAA,iBAAiBA,GAAG,KAAK8lC,UAAzB;CAAA,SAAV,CAAJ,EACA;CACCG,UAAAA,aAAa,CAAChrC,GAAd,CAAkBjG,IAAlB;CACA;;CACD,YAAI4wC,WAAJ,EACA;CACCA,UAAAA,WAAW,CAAC1tC,OAAZ,CAAoB,UAAA8H,GAAG,EAAI;CAC1B,gBAAIkmC,mBAAmB,GAAGlmC,GAA1B;;CACA,gBAAIF,IAAI,CAACvK,IAAL,CAAU,UAACyK,GAAD;CAAA,qBAAiBA,GAAG,KAAKkmC,mBAAzB;CAAA,aAAV,CAAJ,EACA;CACCD,cAAAA,aAAa,CAAChrC,GAAd,CAAkBjG,IAAlB;CACA;CACD,WAND;CAOA;CAED,OAjBD;CAkBAixC,MAAAA,aAAa,CAAC/tC,OAAd,CAAsB,UAAClD,IAAD,EAAgB;CACrC,YAAMmxC,WAAW,GAAGnxC,IAAI,CAACuU,OAAL,GAAelJ,QAAf,EAApB;CACA8lC,QAAAA,WAAW,CAACjuC,OAAZ,CAAoB,UAAC8H,GAAD,EAAMkzB,KAAN,EAAakT,KAAb,EAAuB;CAC1C,cAAIR,WAAW,IAAGA,WAAW,CAAC7yC,MAAZ,KAAuB,CAArC,IAA0C6yC,WAAW,CAACrwC,IAAZ,CAAiB,UAAC8wC,QAAD;CAAA,mBAAsBrmC,GAAG,KAAKqmC,QAA9B;CAAA,WAAjB,CAA9C,EACA;CACCD,YAAAA,KAAK,CAAClT,KAAD,CAAL,GAAejgB,MAAf;CACA,WAHD,MAIK,IAAIjT,GAAG,KAAK8lC,UAAZ,EACL;CACCM,YAAAA,KAAK,CAAClT,KAAD,CAAL,GAAejgB,MAAf;CACA;CACD,SATD;CAUA,YAAMqzB,OAAO,GAAG,EAAhB;CACAH,QAAAA,WAAW,CAACjuC,OAAZ,CAAoB,UAAA8H,GAAG,EAAI;CAC1B,cAAIA,GAAG,KAAK,EAAZ,EACA;CACCsmC,YAAAA,OAAO,CAAC5wC,IAAR,CAAasK,GAAb;CACA;CACD,SALD;CAMAhL,QAAAA,IAAI,CAACyU,OAAL,CAAa68B,OAAb;CACA,OApBD;CAqBAv5B,MAAAA,UAAU,CAAC,YAAM;CAChB,QAAA,KAAI,CAACuc,aAAL,CAAmBI,UAAnB,GAAgC+J,MAAhC;CACA,OAFS,EAEP,IAFO,CAAV;CAIA;CAlFF;CAAA;CAAA;;;;;KCuDa8S,IAAb;CAAA;;CAEC,gBAAYx1C,MAAZ,EACA;CAAA;;CAAA;CACC,sGAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,qBAAvB;;CAEA,UAAK4J,UAAL,GAAkBjI,MAAM,CAACiI,UAAzB;CACA,UAAKwtC,gBAAL,GAAwBz1C,MAAM,CAACy1C,gBAA/B;CACA,UAAK5R,cAAL,GAAsB7jC,MAAM,CAAC6jC,cAA7B;CACA,UAAK5c,eAAL,GAAuBjnB,MAAM,CAACinB,eAAP,KAA2B,GAAlD;CACA,UAAKyuB,kBAAL,GAA0B11C,MAAM,CAAC01C,kBAAjC;CACA,UAAKtuB,QAAL,GAAgBrf,QAAQ,CAAC/H,MAAM,CAAConB,QAAR,EAAkB,EAAlB,CAAxB;CACA,UAAKuuB,cAAL,GAAsB5tC,QAAQ,CAAC/H,MAAM,CAAC21C,cAAR,EAAwB,EAAxB,CAA9B;CACA,UAAKlvC,KAAL,GAAazG,MAAM,CAACyG,KAApB;CACA,UAAKiP,WAAL,GAAmB1V,MAAM,CAAC0V,WAA1B;CACA,UAAKwmB,eAAL,GAAuBl8B,MAAM,CAACk8B,eAA9B;CACA,UAAK/U,oBAAL,GAA4BnnB,MAAM,CAACmnB,oBAAnC;CAEA,UAAKoR,aAAL,GAAqB,IAAIZ,aAAJ,EAArB;;CACA,UAAKY,aAAL,CAAmBqd,UAAnB,CAA8BtqB,OAAO,CAACuqB,YAAR,CAAqB71C,MAAM,CAACgqB,OAA5B,CAA9B;;CACAhqB,IAAAA,MAAM,CAAC43B,OAAP,CAAezwB,OAAf,CAAuB,UAACo0B,UAAD,EAAgB;CACtCA,MAAAA,UAAU,CAACtG,qBAAX,GAAmCj1B,MAAM,CAACi1B,qBAA1C;CACAsG,MAAAA,UAAU,CAAC7lB,WAAX,GAAyB1V,MAAM,CAAC0V,WAAhC;CACA,UAAM8W,MAAM,GAAG8H,MAAM,CAACkH,WAAP,CAAmBD,UAAnB,CAAf;;CACA,YAAKhD,aAAL,CAAmBkD,SAAnB,CAA6BjP,MAA7B;CACA,KALD;CAOA,UAAK8X,cAAL,GAAsB,IAAIJ,cAAJ,CAAmB;CACxCrhC,MAAAA,aAAa,EAAE,MAAKA,aADoB;CAExC01B,MAAAA,aAAa,EAAE,MAAKA;CAFoB,KAAnB,CAAtB;CAKA,UAAKud,YAAL,GAAoB,IAAIpD,YAAJ,CAAiB;CACpC7vC,MAAAA,aAAa,EAAE,MAAKA,aADgB;CAEpC01B,MAAAA,aAAa,EAAE,MAAKA,aAFgB;CAGpC3wB,MAAAA,MAAM,EAAE,MAAKA,MAHuB;CAIpCE,MAAAA,MAAM,EAAE9H,MAAM,CAAC8H,MAJqB;CAKpCE,MAAAA,OAAO,EAAEhI,MAAM,CAACgI,OALoB;CAMpCP,MAAAA,kBAAkB,EAAEzH,MAAM,CAACyH;CANS,KAAjB,CAApB;CASA,UAAKilC,WAAL,GAAmB,IAAIjwB,WAAJ,CAAgB;CAClC5Z,MAAAA,aAAa,EAAE,MAAKA,aADc;CAElC+E,MAAAA,MAAM,EAAE,MAAKA,MAFqB;CAGlCI,MAAAA,OAAO,EAAEhI,MAAM,CAACgI,OAHkB;CAIlC2U,MAAAA,iBAAiB,EAAE3c,MAAM,CAAC2c;CAJQ,KAAhB,CAAnB;CAMAhG,IAAAA,MAAM,CAAC/S,MAAP,CAAc5D,MAAM,CAAC+O,IAAP,CAAYjB,IAA1B,EAAgC3G,OAAhC,CAAwC,UAAC2G,IAAD,EAAU;CACjD,YAAK4+B,WAAL,CAAiBhtB,iBAAjB,CAAmC5R,IAAnC;CACA,KAFD;CAIA,UAAKwqB,WAAL,GAAmB,IAAI0D,WAAJ,CAAgB;CAClCn5B,MAAAA,aAAa,EAAE,MAAKA,aADc;CAElC01B,MAAAA,aAAa,EAAE,MAAKA,aAFc;CAGlCtD,MAAAA,qBAAqB,EAAEj1B,MAAM,CAACi1B,qBAHI;CAIlCgH,MAAAA,4BAA4B,EAAEj8B,MAAM,CAACi8B,4BAJH;CAKlCC,MAAAA,eAAe,EAAEl8B,MAAM,CAACk8B,eALU;CAMlCxmB,MAAAA,WAAW,EAAE1V,MAAM,CAAC0V,WANc;CAOlCuR,MAAAA,eAAe,EAAEjnB,MAAM,CAACinB,eAPU;CAQlCE,MAAAA,oBAAoB,EAAEnnB,MAAM,CAACmnB;CARK,KAAhB,CAAnB;;CAUA,UAAKmR,WAAL,CAAiB35B,SAAjB,CAA2B,oBAA3B,EAAiD,UAACwJ,SAAD,EAA0B;CAC1E,UAAMkvB,WAAW,GAAGlvB,SAAS,CAAC4N,OAAV,EAApB;;CACA,YAAKggC,UAAL,CAAgBC,oBAAhB,CAAqC3e,WAAW,CAACzjB,KAAjD;CACA,KAHD;;CAIA,UAAK0kB,WAAL,CAAiB35B,SAAjB,CACC,cADD,EAEC,UAACwJ,SAAD,EAA0B;CACzB,UAAMqkB,MAAc,GAAGrkB,SAAS,CAAC4N,OAAV,EAAvB;;CACA,YAAKkgC,iBAAL,CAAuBzpB,MAAvB;;CACA,YAAKiiB,SAAL,CAAevH,mBAAf,CAAmC1a,MAAnC;CACA,KANF;;CAQA,UAAK8L,WAAL,CAAiB35B,SAAjB,CACC,kBADD,EAEC,UAACwJ,SAAD,EAA0B;CACzB,UAAMqkB,MAAc,GAAGrkB,SAAS,CAAC4N,OAAV,EAAvB;;CACA,YAAKkgC,iBAAL,CAAuBzpB,MAAvB;;CACA,YAAKiiB,SAAL,CAAevH,mBAAf,CAAmC1a,MAAnC;CACA,KANF;;CAQA,UAAK8L,WAAL,CAAiB35B,SAAjB,CAA2B,eAA3B,EAA4C,MAAKu3C,mBAAL,CAAyB7yC,IAAzB,2CAA5C;;CAEA,UAAK8yC,WAAL,GAAmB,IAAInV,WAAJ,CAAgB;CAClC1I,MAAAA,WAAW,EAAE,MAAKA,WADgB;CAElCC,MAAAA,aAAa,EAAE,MAAKA;CAFc,KAAhB,CAAnB;CAKA,UAAK6d,WAAL,GAAmB,IAAIjT,WAAJ,CAAgB;CAClCtgC,MAAAA,aAAa,EAAE,MAAKA,aADc;CAElCy1B,MAAAA,WAAW,EAAE,MAAKA,WAFgB;CAGlCC,MAAAA,aAAa,EAAE,MAAKA;CAHc,KAAhB,CAAnB;CAMA,UAAKkW,SAAL,GAAiB,IAAIpK,SAAJ,CAAc;CAC9BxhC,MAAAA,aAAa,EAAE,MAAKA,aADU;CAE9By1B,MAAAA,WAAW,EAAE,MAAKA,WAFY;CAG9BC,MAAAA,aAAa,EAAE,MAAKA,aAHU;CAI9B+L,MAAAA,cAAc,EAAE,MAAKA;CAJS,KAAd,CAAjB;CAOA,UAAK+R,YAAL,GAAoB,IAAI9K,YAAJ,CAAiB;CACpC1oC,MAAAA,aAAa,EAAE,MAAKA,aADgB;CAEpC01B,MAAAA,aAAa,EAAE,MAAKA;CAFgB,KAAjB,CAApB;CAKA,UAAK+d,aAAL,GAAqB,IAAIzC,aAAJ,CAAkB;CACtCjsC,MAAAA,MAAM,EAAE,MAAKA,MADyB;CAEtC/E,MAAAA,aAAa,EAAE,MAAKA,aAFkB;CAGtC01B,MAAAA,aAAa,EAAE,MAAKA,aAHkB;CAItCD,MAAAA,WAAW,EAAE,MAAKA,WAJoB;CAKtClR,MAAAA,QAAQ,EAAE,MAAKA;CALuB,KAAlB,CAArB;CAQA,UAAKtZ,IAAL,GAAY,IAAID,MAAJ,CAAS;CACpB7F,MAAAA,OAAO,EAAE,MAAKA,OADM;CAEpBjJ,MAAAA,SAAS,EAAE,MAAKA,SAFI;CAGpBw5B,MAAAA,aAAa,EAAE,MAAKA,aAHA;CAIpB3wB,MAAAA,MAAM,EAAE,MAAKA,MAJO;CAKpB8kC,MAAAA,WAAW,EAAE,MAAKA;CALE,KAAT,CAAZ;CAOA,UAAK6J,OAAL,GAAe,IAAI/B,OAAJ,CAAY;CAC1B3xC,MAAAA,aAAa,EAAE,MAAKA,aADM;CAE1B01B,MAAAA,aAAa,EAAE,MAAKA,aAFM;CAG1BvwB,MAAAA,OAAO,EAAE,MAAKA;CAHY,KAAZ,CAAf;CAKA,UAAK+tC,UAAL,GAAkB,IAAI7I,UAAJ,CAAe;CAChCrqC,MAAAA,aAAa,EAAE,MAAKA,aADY;CAEhCy1B,MAAAA,WAAW,EAAE,MAAKA,WAFc;CAGhCC,MAAAA,aAAa,EAAE,MAAKA,aAHY;CAIhCvwB,MAAAA,OAAO,EAAE,MAAKwuC,iBAAL;CAJuB,KAAf,CAAlB;CAMA,UAAKC,QAAL,GAAgB,IAAIjI,QAAJ,CAAa;CAC5B3rC,MAAAA,aAAa,EAAE,MAAKA,aADQ;CAE5B01B,MAAAA,aAAa,EAAE,MAAKA,aAFQ;CAG5B+L,MAAAA,cAAc,EAAE,MAAKA,cAHO;CAI5BoI,MAAAA,WAAW,EAAE,MAAKA,WAJU;CAK5B+B,MAAAA,SAAS,EAAE,MAAKA,SALY;CAM5BC,MAAAA,aAAa,EAAE,MAAKgI,gBAAL,EANa;CAO5B1uC,MAAAA,OAAO,EAAE,MAAKwuC,iBAAL;CAPmB,KAAb,CAAhB;CASA,UAAKG,QAAL,GAAgB,IAAItF,QAAJ,CAAa;CAC5BxuC,MAAAA,aAAa,EAAE,MAAKA,aADQ;CAE5B01B,MAAAA,aAAa,EAAE,MAAKA,aAFQ;CAG5BzqB,MAAAA,IAAI,EAAE,MAAKA;CAHiB,KAAb,CAAhB;CAMA,UAAK6C,KAAL,GAAa,IAAIiU,KAAJ,EAAb;;CACA,UAAKjU,KAAL,CAAWhS,SAAX,CAAqB,gBAArB,EAAuC,MAAKi4C,gBAAL,CAAsBvzC,IAAtB,2CAAvC;;CACA,UAAKsN,KAAL,CAAWhS,SAAX,CAAqB,gBAArB,EAAuC,MAAKk4C,gBAAL,CAAsBxzC,IAAtB,2CAAvC;;CACA,UAAKsN,KAAL,CAAWhS,SAAX,CAAqB,iBAArB,EAAwC,MAAKm4C,iBAAL,CAAuBzzC,IAAvB,2CAAxC;;CACA,UAAKsN,KAAL,CAAWhS,SAAX,CAAqB,gBAArB,EAAuC,MAAKo4C,gBAAL,CAAsB1zC,IAAtB,2CAAvC;;CACA,UAAKsN,KAAL,CAAWhS,SAAX,CAAqB,iBAArB,EAAwC,MAAKq4C,iBAAL,CAAuB3zC,IAAvB,2CAAxC;;CACA,UAAKsN,KAAL,CAAWhS,SAAX,CAAqB,QAArB,EAA+B,MAAKs4C,aAAL,CAAmB5zC,IAAnB,2CAA/B;;CACA,UAAKsN,KAAL,CAAWhS,SAAX,CAAqB,QAArB,EAA+B,MAAKu4C,aAAL,CAAmB7zC,IAAnB,2CAA/B;;CAEA,UAAKk9B,WAAL,GAAmB,IAAnB;CACA,UAAKxmB,iBAAL,GAAyB,IAAzB;;CAEA,UAAK/W,YAAL;;CAEA,UAAK6vC,eAAL;;CAhKD;CAiKC;;CApKF;CAAA;CAAA,6BAsKUxqC,SAtKV,EAuKC;CACC,iGAAeA,SAAf;CAEA,WAAKiwB,WAAL,CAAiB6e,QAAjB,CAA0B9uC,SAA1B;CACA;CA3KF;CAAA;CAAA,0CA6KuBA,SA7KvB,EA8KC;CACC,8GAA4BA,SAA5B;CAEA,UAAMmL,SAAS,GAAG,IAAI4jC,sBAAJ,CAAc;CAC/B1hC,QAAAA,WAAW,EAAE,KAAKA;CADa,OAAd,CAAlB;CAIAlC,MAAAA,SAAS,CAAC2jC,QAAV,CAAmB9uC,SAAnB;CACAmL,MAAAA,SAAS,CAAC7U,SAAV,CAAoB,QAApB,EAA8B,KAAK04C,iBAAL,CAAuBh0C,IAAvB,CAA4B,IAA5B,CAA9B;CACA;CAvLF;CAAA;CAAA,uCAyLoB6B,KAzLpB,EA0LC;CAAA;;CACC,2GAAyBA,KAAzB;CAEA,WAAKozB,WAAL,CAAiB+D,gBAAjB,CAAkCn3B,KAAlC;CAEA,WAAKrC,aAAL,CAAmBy0C,mBAAnB,CAAuC;CACtCpyC,QAAAA,KAAK,EAAEA;CAD+B,OAAvC,EAGE5E,IAHF,CAGO,UAACqB,QAAD,EAAc,EAHrB,WAIQ,UAACA,QAAD,EAAc;CACpB,QAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OANF;CAQA;CAvMF;CAAA;CAAA,sCA0MC;CACCqxC,MAAAA,gBAAI,CAACr0C,SAAL,CAAe,KAAKo3C,UAApB;CACA/C,MAAAA,gBAAI,CAACr0C,SAAL,CAAe,KAAK83C,QAApB;CACAzD,MAAAA,gBAAI,CAACr0C,SAAL,CAAe,KAAKg4C,QAApB;CACA3D,MAAAA,gBAAI,CAACr0C,SAAL,CAAe,KAAK43C,OAApB;CACA;CA/MF;CAAA;CAAA,mCAkNC;CAAA;;CACC,WAAKhe,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,WAA1C,EAAuD,KAAK44C,kBAAL,CAAwBl0C,IAAxB,CAA6B,IAA7B,CAAvD;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,iBAA1C,EAA6D,KAAK64C,iBAAL,CAAuBn0C,IAAvB,CAA4B,IAA5B,CAA7D;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,YAA1C,EAAwD,KAAK84C,YAAL,CAAkBp0C,IAAlB,CAAuB,IAAvB,CAAxD;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,UAA1C,EAAsD,KAAK+4C,UAAL,CAAgBr0C,IAAhB,CAAqB,IAArB,CAAtD;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,oBAA1C,EAAgE,KAAKg5C,oBAAL,CAA0Bt0C,IAA1B,CAA+B,IAA/B,CAAhE;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,uBAA1C,EAAmE,KAAKi5C,uBAAL,CAA6Bv0C,IAA7B,CAAkC,IAAlC,CAAnE;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,yBAA1C,EAAqE,KAAKk5C,uBAAL,CAA6Bx0C,IAA7B,CAAkC,IAAlC,CAArE;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,iBAA1C,EAA6D,KAAKm5C,cAAL,CAAoBz0C,IAApB,CAAyB,IAAzB,CAA7D;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,gBAA1C,EAA4D,KAAKk4C,gBAAL,CAAsBxzC,IAAtB,CAA2B,IAA3B,CAA5D;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,iBAA1C,EAA6D,KAAKm4C,iBAAL,CAAuBzzC,IAAvB,CAA4B,IAA5B,CAA7D;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,gBAA1C,EAA4D,KAAKo4C,gBAAL,CAAsB1zC,IAAtB,CAA2B,IAA3B,CAA5D;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,iBAA1C,EAA6D,KAAKq4C,iBAAL,CAAuB3zC,IAAvB,CAA4B,IAA5B,CAA7D;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,cAA1C,EAA0D,KAAKo5C,cAAL,CAAoB10C,IAApB,CAAyB,IAAzB,CAA1D;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,aAA1C,EAAyD,KAAKq5C,aAAL,CAAmB30C,IAAnB,CAAwB,IAAxB,CAAzD;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,WAA1C,EAAuD,UAACwJ,SAAD,EAA0B;CAChF,YAAMmU,MAAc,GAAGnU,SAAS,CAAC+V,SAAV,EAAvB;;CACA,YAAI,CAAC,MAAI,CAACxW,sBAAL,CAA4BkB,GAA5B,CAAgC0T,MAAM,CAACtK,KAAP,EAAhC,CAAL,EACA;CACC,UAAA,MAAI,CAACtK,sBAAL,CAA4BqK,GAA5B,CAAgCuK,MAAM,CAACtK,KAAP,EAAhC,EAAgD,CAAhD;CACA;;CACD,QAAA,MAAI,CAACimC,SAAL,CAAe37B,MAAf;CACA,OAPD;CAQA,WAAKic,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,mBAA1C,EAA+D,KAAKu5C,mBAAL,CAAyB70C,IAAzB,CAA8B,IAA9B,CAA/D;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,YAA1C,EAAwD,KAAKw5C,YAAL,CAAkB90C,IAAlB,CAAuB,IAAvB,CAAxD;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,aAA1C,EAAyD,KAAKu3C,mBAAL,CAAyB7yC,IAAzB,CAA8B,IAA9B,CAAzD;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,WAA1C,EAAuD,KAAKy5C,WAAL,CAAiB/0C,IAAjB,CAAsB,IAAtB,CAAvD;CACA,WAAKk1B,aAAL,CAAmBI,UAAnB,GAAgCh6B,SAAhC,CAA0C,qBAA1C,EAAiE,KAAK05C,qBAAL,CAA2Bh1C,IAA3B,CAAgC,IAAhC,CAAjE;CAEA,WAAKk1B,aAAL,CAAmBgE,UAAnB,GAAgCp1B,OAAhC,CAAwC,UAACqlB,MAAD;CAAA,eAAY,MAAI,CAACypB,iBAAL,CAAuBzpB,MAAvB,CAAZ;CAAA,OAAxC;CAEA,WAAK1e,IAAL,CAAUnP,SAAV,CAAoB,aAApB,EAAmC,KAAKq5C,aAAL,CAAmB30C,IAAnB,CAAwB,IAAxB,CAAnC;CAEA,WAAKorC,SAAL,CAAe9vC,SAAf,CAAyB,WAAzB,EAAsC,YAAM;CAC3C,QAAA,MAAI,CAAC25C,kBAAL;;CACA,YAAI,MAAI,CAACnC,WAAL,CAAiB1pB,QAAjB,EAAJ,EACA;CACC,UAAA,MAAI,CAAC0pB,WAAL,CAAiBxT,IAAjB;CACA;CACD,OAND;CAQAz8B,MAAAA,QAAQ,CAACqyC,SAAT,GAAqB,KAAKC,iBAAL,CAAuBn1C,IAAvB,CAA4B,IAA5B,CAArB;CACA6C,MAAAA,QAAQ,CAACqiC,OAAT,GAAmB,KAAKkQ,eAAL,CAAqBp1C,IAArB,CAA0B,IAA1B,CAAnB;CACA;CA7PF;CAAA;CAAA,sCA+PmBmpB,MA/PnB,EAgQC;CAAA;;CACCA,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,WAAjB,EAA8B,KAAK+5C,iBAAL,CAAuBr1C,IAAvB,CAA4B,IAA5B,CAA9B;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,cAAjB,EAAiC,KAAKg6C,cAAL,CAAoBt1C,IAApB,CAAyB,IAAzB,CAAjC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,YAAjB,EAA+B,KAAK84C,YAAL,CAAkBp0C,IAAlB,CAAuB,IAAvB,CAA/B;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,aAAjB,EAAgC,KAAKi6C,aAAL,CAAmBv1C,IAAnB,CAAwB,IAAxB,CAAhC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,UAAjB,EAA6B,KAAK+4C,UAAL,CAAgBr0C,IAAhB,CAAqB,IAArB,CAA7B;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,oBAAjB,EAAuC,KAAKg5C,oBAAL,CAA0Bt0C,IAA1B,CAA+B,IAA/B,CAAvC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,aAAjB,EAAgC,KAAKk6C,aAAL,CAAmBx1C,IAAnB,CAAwB,IAAxB,CAAhC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,gBAAjB,EAAmC,KAAKm6C,gBAAL,CAAsBz1C,IAAtB,CAA2B,IAA3B,CAAnC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,uBAAjB,EAA0C,KAAKi5C,uBAAL,CAA6Bv0C,IAA7B,CAAkC,IAAlC,CAA1C;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,yBAAjB,EAA4C,KAAKk5C,uBAAL,CAA6Bx0C,IAA7B,CAAkC,IAAlC,CAA5C;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,cAAjB,EAAiC,KAAKo6C,cAAL,CAAoB11C,IAApB,CAAyB,IAAzB,CAAjC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,kBAAjB,EAAqC,KAAKq6C,kBAAL,CAAwB31C,IAAxB,CAA6B,IAA7B,CAArC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,sBAAjB,EAAyC,KAAKi3B,sBAAL,CAA4BvyB,IAA5B,CAAiC,IAAjC,CAAzC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,gBAAjB,EAAmC,KAAKk4C,gBAAL,CAAsBxzC,IAAtB,CAA2B,IAA3B,CAAnC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,iBAAjB,EAAoC,KAAKm4C,iBAAL,CAAuBzzC,IAAvB,CAA4B,IAA5B,CAApC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,gBAAjB,EAAmC,KAAKo4C,gBAAL,CAAsB1zC,IAAtB,CAA2B,IAA3B,CAAnC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,iBAAjB,EAAoC,KAAKq4C,iBAAL,CAAuB3zC,IAAvB,CAA4B,IAA5B,CAApC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,cAAjB,EAAiC,KAAKo5C,cAAL,CAAoB10C,IAApB,CAAyB,IAAzB,CAAjC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,aAAjB,EAAgC,KAAKq5C,aAAL,CAAmB30C,IAAnB,CAAwB,IAAxB,CAAhC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,yBAAjB,EAA4C,KAAKs6C,yBAAL,CAA+B51C,IAA/B,CAAoC,IAApC,CAA5C;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,yBAAjB,EAA4C,KAAKu6C,yBAAL,CAA+B71C,IAA/B,CAAoC,IAApC,CAA5C;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,sBAAjB,EAAyC,KAAKw6C,mBAAL,CAAyB91C,IAAzB,CAA8B,IAA9B,CAAzC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,WAAjB,EAA8B,UAACwJ,SAAD,EAA0B;CACvD,YAAMmU,MAAc,GAAGnU,SAAS,CAAC+V,SAAV,EAAvB;;CACA,YAAI,CAAC,MAAI,CAACxW,sBAAL,CAA4BkB,GAA5B,CAAgC0T,MAAM,CAACtK,KAAP,EAAhC,CAAL,EACA;CACC,UAAA,MAAI,CAACtK,sBAAL,CAA4BqK,GAA5B,CAAgCuK,MAAM,CAACtK,KAAP,EAAhC,EAAgD,CAAhD;CACA;;CACD,QAAA,MAAI,CAACimC,SAAL,CAAe37B,MAAf;CACA,OAPD;CAQAkQ,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,mBAAjB,EAAsC,KAAKu5C,mBAAL,CAAyB70C,IAAzB,CAA8B,IAA9B,CAAtC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,YAAjB,EAA+B,KAAKw5C,YAAL,CAAkB90C,IAAlB,CAAuB,IAAvB,CAA/B;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,cAAjB,EAAiC,KAAKy6C,cAAL,CAAoB/1C,IAApB,CAAyB,IAAzB,CAAjC;CACAmpB,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,yBAAjB,EAA4C,YAAM;CACjD,QAAA,MAAI,CAAC25B,WAAL,CAAiBkE,qBAAjB;CACA,OAFD;CAGAhQ,MAAAA,MAAM,CAAC7tB,SAAP,CAAiB,qBAAjB,EAAwC,KAAK05C,qBAAL,CAA2Bh1C,IAA3B,CAAgC,IAAhC,CAAxC;CACA;CAtSF;CAAA;CAAA,mCAwSgBhB,OAxShB,EAySC;CACCI,MAAAA,gCAAU,CAACC,KAAX,CAAiBL,OAAjB,EAA0BE,aAAG,CAACC,UAAJ,CAAe,+BAAf,CAA1B;CACA;CA3SF;CAAA;CAAA,sCA6SmB5D,KA7SnB,EA8SC;CACCA,MAAAA,KAAK,GAAGA,KAAK,IAAIoH,MAAM,CAACpH,KAAxB;;CAEA,UAAI,KAAKu3C,WAAL,CAAiB1pB,QAAjB,EAAJ,EACA;CACC,YAAI7tB,KAAK,CAACyS,GAAN,KAAc,SAAd,IAA2BzS,KAAK,CAACyS,GAAN,KAAc,WAA7C,EACA;CACCzS,UAAAA,KAAK,CAACknC,cAAN;CAEA,eAAKqQ,WAAL,CAAiBvT,UAAjB;CACA;;CAED,YAAIhkC,KAAK,CAACyS,GAAN,KAAc,WAAd,IAA6BzS,KAAK,CAACyS,GAAN,KAAc,YAA/C,EACA;CACCzS,UAAAA,KAAK,CAACknC,cAAN;CAEA,eAAKqQ,WAAL,CAAiBtT,UAAjB;CACA;CACD;;CAED,UAAIjkC,KAAK,CAACyS,GAAN,KAAc,QAAlB,EACA;CACC,YAAIgoC,SAAS,GAAG,KAAhB;;CAEA,YAAI,KAAKlD,WAAL,CAAiB1pB,QAAjB,EAAJ,EACA;CACC4sB,UAAAA,SAAS,GAAG,IAAZ;CAEA,eAAKlD,WAAL,CAAiBxT,IAAjB;CACA;;CAED,YAAI,KAAKpC,WAAT,EACA;CACC8Y,UAAAA,SAAS,GAAG,IAAZ;CAEA,eAAKf,kBAAL;CAEA,eAAK/f,aAAL,CAAmB8N,cAAnB,GACEl/B,OADF,CACU,UAACmV,MAAD,EAAoB;CAC5BA,YAAAA,MAAM,CAAC0M,mBAAP;CACA,WAHF;CAKA;;CAED,YAAIqwB,SAAJ,EACA;CACCz6C,UAAAA,KAAK,CAAC2mB,wBAAN;CACA;CACD;CACD;CA/VF;CAAA;CAAA,oCAiWiB3mB,KAjWjB,EAkWC;CACCA,MAAAA,KAAK,GAAGA,KAAK,IAAIoH,MAAM,CAACpH,KAAxB;;CAEA,UAAI,KAAKu3C,WAAL,CAAiB1pB,QAAjB,MAA+B,CAAC,KAAK0pB,WAAL,CAAiBxrC,aAAjB,CAA+B/L,KAAK,CAACsQ,MAArC,CAApC,EACA;CACC,aAAKinC,WAAL,CAAiBxT,IAAjB;CACA;;CAED,UAAI,KAAK2W,WAAL,IAAoB,CAAC,KAAKA,WAAL,CAAiB3uC,aAAjB,CAA+B/L,KAAK,CAACsQ,MAArC,CAAzB,EACA;CACC,aAAKoqC,WAAL,CAAiBC,mBAAjB;CACA,aAAKD,WAAL,GAAmB,IAAnB;CACA;CACD;CA/WF;CAAA;CAAA,uCAiXoBnxC,SAjXpB,EAkXC;CACC,UAAM6hB,OAAgB,GAAG7hB,SAAS,CAAC+V,SAAV,EAAzB;CACA,UAAMsN,MAAsB,GAAGrjB,SAAS,CAAC4N,OAAV,EAA/B;CAEA,WAAKyjC,SAAL,CAAexvB,OAAf,EAAwB1pB,IAAxB,CAA6B,YAAM;CAClC,YAAI,CAACuB,cAAI,CAAC4N,aAAL,CAAmB+b,MAAnB,CAAL,EACA;CACCA,UAAAA,MAAM,CAACiuB,gBAAP;CACA;CACD,OALD;CAMA;CA5XF;CAAA;CAAA,sCA8XmBtxC,SA9XnB,EA+XC;CACC,UAAMqkB,MAAc,GAAGrkB,SAAS,CAAC+V,SAAV,EAAvB;;CAEA,UAAIsO,MAAM,CAAC+K,aAAP,EAAJ,EACA;CACC/K,QAAAA,MAAM,CAACktB,aAAP,CAAqB,yBAArB,EAAgD,KAAKF,SAAL,CAAen2C,IAAf,CAAoB,IAApB,EAA0BmpB,MAA1B,CAAhD;CACAA,QAAAA,MAAM,CAACqJ,uBAAP,CAA+BrJ,MAAM,CAACsJ,mBAAP,EAA/B;CACA,OAJD,MAMA;CACC,aAAK0jB,SAAL,CAAehtB,MAAf;CACA;CACD;CA3YF;CAAA;CAAA,wCA8YC;CACC,WAAKztB,SAAL,CAAe46C,kBAAf,CAAkC,KAAKlE,gBAAL,CAAsBvpC,OAAtB,CAA8B,WAA9B,EAA2C,CAA3C,CAAlC;CACA;CAhZF;CAAA;CAAA,qCAmZC;CACC,WAAKosB,WAAL,CAAiB4E,YAAjB;CACA;CArZF;CAAA;CAAA,kCAuZe/0B,SAvZf,EAwZC;CACC,WAAKyxC,mBAAL;CAEA,UAAMjpC,KAAY,GAAGxI,SAAS,CAAC+V,SAAV,EAArB;CAEA,UAAM5B,MAAM,GAAG3L,KAAK,CAACkpC,SAAN,EAAf;CAEAv9B,MAAAA,MAAM,CAACyL,SAAP;CACAzL,MAAAA,MAAM,CAAC0L,YAAP;CACA1L,MAAAA,MAAM,CAAC2L,mBAAP;CACA;CAlaF;CAAA;CAAA,kCAoae9f,SApaf,EAqaC;CACC,WAAK2xC,iBAAL;CAEA,UAAMnpC,KAAY,GAAGxI,SAAS,CAAC+V,SAAV,EAArB;CAEA,UAAM5B,MAAM,GAAG3L,KAAK,CAACkpC,SAAN,EAAf;;CAEA,UAAI,CAAClpC,KAAK,CAACopC,aAAN,EAAD,IAA0Bz9B,MAAM,CAAC5L,OAAP,EAA9B,EACA;CACC,YAAI4L,MAAM,CAACwO,SAAP,EAAJ,EACA;CACC,cAAI,KAAKyN,aAAL,CAAmB4b,oBAAnB,EAAJ,EACA;CACC,gBAAI73B,MAAM,CAAC6K,oBAAP,EAAJ,EACA;CACC7K,cAAAA,MAAM,CAACqa,mBAAP;CACA,aAHD,MAKA;CACCra,cAAAA,MAAM,CAACsa,YAAP;CACA;CACD,WAVD,MAYA;CACCta,YAAAA,MAAM,CAAC09B,SAAP;CACA;CACD,SAjBD,MAmBA;CACC,cAAI19B,MAAM,CAACkO,cAAP,KAA0B,CAA1B,IAA+BlO,MAAM,CAAC6K,oBAAP,EAAnC,EACA;CACC7K,YAAAA,MAAM,CAACqa,mBAAP;CACA,WAHD,MAKA;CACCra,YAAAA,MAAM,CAACsa,YAAP;CACA;CACD;CACD;;CAGD,UAAI,KAAK8H,aAAT,EACA;CACC,aAAKA,aAAL,CAAmBub,aAAnB,GAAmCC,2BAAnC;CACA,aAAKxb,aAAL,GAAqB,IAArB;CACA;;CAEDpiB,MAAAA,MAAM,CAAC4L,oBAAP;CACA;CArdF;CAAA;CAAA,qCAudkB/f,SAvdlB,EAwdC;CAAA;;CACC,UAAMwI,KAAY,GAAGxI,SAAS,CAAC+V,SAAV,EAArB;CAEA,UAAM5B,MAAM,GAAG3L,KAAK,CAACkpC,SAAN,EAAf;CAEA,UAAIlyB,OAAa,GAAG,IAApB;;CAEA,UACA;CACCA,QAAAA,OAAO,GAAG,KAAKwyB,UAAL,CAAgBxpC,KAAhB,CAAV;CACA,OAHD,CAIA,OAAO4R,KAAP,EACA;CACC,aAAKyY,cAAL,CAAoBzY,KAAK,CAAClgB,OAA1B;CAEAsO,QAAAA,KAAK,CAACe,cAAN;CAEA;CACA;;CAED,UAAI,KAAKgtB,aAAT,EACA;CACC,YAAMltB,UAAgB,GAAG,KAAKktB,aAAL,CAAmBub,aAAnB,EAAzB;CAEA,aAAKxD,QAAL,CAAc2D,mBAAd,CAAkC5oC,UAAU,CAACQ,KAAX,EAAlC;CAEA2V,QAAAA,OAAO,CAACojB,eAAR,CAAwBzuB,MAAM,CAACtK,KAAP,EAAxB,EAAwCsK,MAAM,CAACjF,aAAP,EAAxC;CACAsQ,QAAAA,OAAO,CAAC/S,eAAR,CAAwBpD,UAAU,CAACgE,WAAX,EAAxB;CACAmS,QAAAA,OAAO,CAACpP,OAAR,CAAgB/G,UAAU,CAAC8G,OAAX,GAAqBhJ,QAArB,EAAhB;CACAqY,QAAAA,OAAO,CAACjP,OAAR,CAAgBlH,UAAU,CAACgH,OAAX,GAAqBlJ,QAArB,EAAhB;CACAqY,QAAAA,OAAO,CAAC/O,cAAR,CAAuBpH,UAAU,CAACmH,cAAX,GAA4BrJ,QAA5B,EAAvB;;CAEA,YAAIgN,MAAM,CAACwO,SAAP,EAAJ,EACA;CACCtZ,UAAAA,UAAU,CAACkD,aAAX,CAAyB,GAAzB;CACAlD,UAAAA,UAAU,CAAC+E,iBAAX;CAEAoR,UAAAA,OAAO,CAACjT,aAAR,CAAsB,GAAtB;CACAiT,UAAAA,OAAO,CAAC8kB,cAAR,CAAuBj7B,UAAU,CAAC2F,cAAX,EAAvB;CACAwQ,UAAAA,OAAO,CAAC9T,OAAR,CAAgBrC,UAAU,CAAC8H,OAAX,KAAuB,KAAKolB,aAAL,CAAmB2b,gCAAnB,EAAvC;CAEAr1C,UAAAA,aAAG,CAACujB,YAAJ,CAAiBZ,OAAO,CAAC5gB,MAAR,EAAjB,EAAmC4J,KAAK,CAACiB,OAAN,EAAnC;CACA,SAVD,MAYA;CACC+V,UAAAA,OAAO,CAAC7S,UAAR,CAAmB,GAAnB;CACA6S,UAAAA,OAAO,CAAC9T,OAAR,CAAgBrC,UAAU,CAAC8H,OAAX,MAAwB9H,UAAU,CAACuF,gBAAX,KAAgC,CAAxD,CAAhB;CACA4Q,UAAAA,OAAO,CAAC/S,eAAR,CAAwBpD,UAAU,CAACgE,WAAX,EAAxB;CACAmS,UAAAA,OAAO,CAACnT,aAAR,CAAsB,GAAtB;CACA;;CAED,aAAKkqB,aAAL,CAAmB4b,gCAAnB;CACA,OAhCD,MAkCA;CACC3yB,QAAAA,OAAO,CAACpP,OAAR,CAAgB5H,KAAK,CAAC2H,OAAN,EAAhB;CAEA3H,QAAAA,KAAK,CAAC4H,OAAN,CAAc,IAAd;CAEAoP,QAAAA,OAAO,CAACojB,eAAR,CAAwBzuB,MAAM,CAACtK,KAAP,EAAxB,EAAwCsK,MAAM,CAACjF,aAAP,EAAxC;CACAsQ,QAAAA,OAAO,CAAC9T,OAAR,CAAgB,CAAhB;CACA8T,QAAAA,OAAO,CAAC/O,cAAR,CAAuB,KAAK88B,kBAA5B;;CAEA,YAAIp5B,MAAM,CAAC5L,OAAP,EAAJ,EACA;CACC1L,UAAAA,aAAG,CAACujB,YAAJ,CAAiBZ,OAAO,CAAC5gB,MAAR,EAAjB,EAAmCuV,MAAM,CAACoN,aAAP,EAAnC;CACA,SAHD,MAKA;CACC1kB,UAAAA,aAAG,CAACujB,YAAJ,CAAiBZ,OAAO,CAAC5gB,MAAR,EAAjB,EAAmCuV,MAAM,CAACuuB,gBAAP,CAAwB,KAAKl6B,KAA7B,CAAnC;CACA;CACD;;CAED,WAAK8lC,QAAL,CAAcT,oBAAd,CAAmCruB,OAAO,CAAC3V,KAAR,EAAnC;CACA,WAAKykC,QAAL,CAAcrF,qBAAd,CAAoCzpB,OAAO,CAAC3V,KAAR,EAApC;CAEA,WAAKuoC,uBAAL,CAA6Bj+B,MAA7B,EAAqCqL,OAArC,EAA8CrnB,IAA9C,CAAmD,UAACqB,QAAD,EAAc;CAEhE,QAAA,MAAI,CAAC64C,qBAAL,CAA2B7yB,OAA3B,EAAoChmB,QAAQ,CAACZ,IAA7C;;CAEAub,QAAAA,MAAM,CAAC0uB,OAAP,CAAerjB,OAAf;;CAEA,QAAA,MAAI,CAACkgB,oBAAL,CAA0BvrB,MAA1B;;CAEA,YAAI,MAAI,CAACoiB,aAAT,EACA;CACC,cAAMltB,WAAgB,GAAG,MAAI,CAACktB,aAAL,CAAmBub,aAAnB,EAAzB;;CAEA,cAAI,CAAC39B,MAAM,CAACwO,SAAP,EAAL,EACA;CACC,gBAAMxX,QAAQ,GAAG9B,WAAU,CAACiG,WAAX,EAAjB;;CAEAnE,YAAAA,QAAQ,CAACmnC,OAAT,CAAiB9yB,OAAjB;;CAEA,gBAAI,CAACrU,QAAQ,CAACxH,OAAT,EAAL,EACA;CACCwQ,cAAAA,MAAM,CAACya,mBAAP,CAA2BzjB,QAAQ,CAACvM,MAAT,EAA3B,EAA8CyK,WAAU,CAACI,OAAX,EAA9C;CACA;;CAED,gBAAM8oC,WAAW,GAAG,EAApB;CACAA,YAAAA,WAAW,CAAC/yB,OAAO,CAACnS,WAAR,EAAD,CAAX,GAAqC;CACpC/I,cAAAA,QAAQ,EAAEkb,OAAO,CAACnS,WAAR,EAD0B;CAEpCjJ,cAAAA,SAAS,EAAE,GAFyB;CAGpCwD,cAAAA,WAAW,EAAE;CAHuB,aAArC;;CAMAyB,YAAAA,WAAU,CAAC8C,eAAX,qCAA+B9C,WAAU,CAACkF,eAAX,EAA/B,GAAgEgkC,WAAhE;;CACAlpC,YAAAA,WAAU,CAACgD,aAAX,CAAyB,GAAzB;;CAEAhD,YAAAA,WAAU,CAACwlB,YAAX;CACA;CACD;;CAEDrmB,QAAAA,KAAK,CAAC5E,SAAN;CACA4E,QAAAA,KAAK,CAACM,KAAN;CAEAqL,QAAAA,MAAM,CAAC4L,oBAAP;;CACA,QAAA,MAAI,CAACoQ,WAAL,CAAiBkE,qBAAjB;CACA,OA1CD,WA0CS,UAAC76B,QAAD,EAAc;CACtB,QAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OA5CD;CA6CA;CAjlBF;CAAA;CAAA,iCAmlBcwG,SAnlBd,EAolBC;CAAA;;CACC,UAAMmU,MAAM,GAAGnU,SAAS,CAAC+V,SAAV,EAAf;CACA,UAAMy8B,UAAU,GAAGxyC,SAAS,CAAC4N,OAAV,EAAnB;CAEA,WAAK0gC,QAAL,CAAc2D,mBAAd,CAAkCO,UAAU,CAAC7/B,MAA7C;CAEA,WAAKjY,aAAL,CAAmBitC,UAAnB,CAA8B3nC,SAAS,CAAC4N,OAAV,EAA9B,EACEzV,IADF,CACO,YAAM;CACX,YAAMs6C,oBAAoB,GAAI,CAAC/4C,cAAI,CAACC,WAAL,CAAiB64C,UAAU,CAAC5qC,WAA5B,CAA/B;;CACA,YAAI6qC,oBAAJ,EACA;CACC,UAAA,MAAI,CAAC/S,oBAAL,CAA0BvrB,MAA1B;CACA;CACD,OAPF,WAQQ,UAAC3a,QAAD,EAAc;CACpB,QAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAVF;CAYA;CAtmBF;CAAA;CAAA,kCAwmBewG,SAxmBf,EAymBC;CAAA;;CACC,UAAMqkB,MAAc,GAAGrkB,SAAS,CAAC+V,SAAV,EAAvB;CACA,UAAM5K,QAAkB,GAAGnL,SAAS,CAAC4N,OAAV,EAA3B;CAEAyW,MAAAA,MAAM,CAACuK,mBAAP,CAA2BzjB,QAAQ,CAACvM,MAAT,EAA3B,EAA8CuM,QAAQ,CAAC2mC,aAAT,GAAyBroC,OAAzB,EAA9C;CAEA,WAAK/O,aAAL,CAAmBg4C,eAAnB,CAAmC;CAClC7mC,QAAAA,QAAQ,EAAEwY,MAAM,CAACxa,KAAP,EADwB;CAElCgM,QAAAA,MAAM,EAAE1K,QAAQ,CAAC2mC,aAAT,GAAyBzkC,WAAzB;CAF0B,OAAnC,EAIElV,IAJF,CAIO,UAACqB,QAAD,EAAc;CACnBA,QAAAA,QAAQ,CAACZ,IAAT,CAAcoG,OAAd,CAAsB,UAAC+uB,UAAD,EAA4B;CACjD,cAAM4kB,WAAW,GAAG/nC,IAAI,CAAC2Y,SAAL,CAAewK,UAAf,CAApB;CACA1J,UAAAA,MAAM,CAACwe,OAAP,CAAe8P,WAAf;CACAxnC,UAAAA,QAAQ,CAACmnC,OAAT,CAAiBK,WAAjB;CACA,SAJD;CAKAxnC,QAAAA,QAAQ,CAAC2mC,aAAT,GAAyBjjB,YAAzB;CACAxK,QAAAA,MAAM,CAACuuB,wBAAP,CAAgCznC,QAAQ,CAAC2mC,aAAT,EAAhC;;CACA,QAAA,MAAI,CAAC3hB,WAAL,CAAiBkE,qBAAjB;CACA,OAbF,WAcQ,UAAC76B,QAAD,EAAc;CACpB,QAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAhBF;CAkBA;CAjoBF;CAAA;CAAA,4CAmoByBwG,SAnoBzB,EAooBC;CAAA;;CACC,UAAMlE,IAAU,GAAGkE,SAAS,CAAC4N,OAAV,EAAnB;CAEA,WAAK0gC,QAAL,CAAc2D,mBAAd,CAAkCn2C,IAAI,CAAC+N,KAAL,EAAlC;CAEA,WAAKnP,aAAL,CAAmBm4C,qBAAnB,CAAyC;CACxClgC,QAAAA,MAAM,EAAE7W,IAAI,CAAC+N,KAAL,EADgC;CAExCvF,QAAAA,QAAQ,EAAExI,IAAI,CAACuR,WAAL,EAF8B;CAGxChG,QAAAA,WAAW,EAAEvL,IAAI,CAAC0U,cAAL,GAAsBrJ,QAAtB;CAH2B,OAAzC,WAIS,UAAC3N,QAAD,EAAc;CACtB,QAAA,MAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAND;CAOA;CAhpBF;CAAA;CAAA,4CAkpByBwG,SAlpBzB,EAmpBC;CACC,WAAK4R,iBAAL,GAAyB5R,SAAS,CAAC4N,OAAV,EAAzB;CACA;CArpBF;CAAA;CAAA,mCAupBgB5N,SAvpBhB,EAwpBC;CACC,UAAMqjB,MAAqB,GAAGrjB,SAAS,CAAC4N,OAAV,EAA9B;CAEA,WAAKjI,IAAL,CAAUmtC,WAAV,GAAwB36C,IAAxB,CAA6B,YAAM;CAClCkrB,QAAAA,MAAM,CAAC0vB,gBAAP;CACA,OAFD;CAGA;CA9pBF;CAAA;CAAA,kCAgqBe/yC,SAhqBf,EAiqBC;CACC,UAAMqkB,MAAM,GAAGrkB,SAAS,CAAC+V,SAAV,EAAf;CAEA,UAAMi9B,eAAe,GAAG,IAAIvX,eAAJ,CAAoB;CAC3C7kC,QAAAA,SAAS,EAAE,KAAKA,SAD2B;CAE3CiJ,QAAAA,OAAO,EAAE,KAAKA,OAF6B;CAG3CvB,QAAAA,KAAK,EAAE,KAAKA;CAH+B,OAApB,CAAxB;CAMA00C,MAAAA,eAAe,CAACC,aAAhB,CAA8B5uB,MAA9B;CACA;CA3qBF;CAAA;CAAA,uCA8qBC;CAAA;;CACC,UAAM2uB,eAAe,GAAG,IAAIvX,eAAJ,CAAoB;CAC3C7kC,QAAAA,SAAS,EAAE,KAAKA,SAD2B;CAE3CiJ,QAAAA,OAAO,EAAE,KAAKA,OAF6B;CAG3CvB,QAAAA,KAAK,EAAE,KAAKA;CAH+B,OAApB,CAAxB;CAMA00C,MAAAA,eAAe,CAACE,kBAAhB;CAEAF,MAAAA,eAAe,CAACx8C,SAAhB,CAA0B,UAA1B,EAAsC,UAAC28C,cAAD,EAA+B;CACpE,QAAA,MAAI,CAACv8C,SAAL,CAAe46C,kBAAf,CAAkC,MAAI,CAAC4B,aAAL,GAAqBrvC,OAArB,CAA6B,WAA7B,EAA0CovC,cAAc,CAACvlC,OAAf,EAA1C,CAAlC;CACA,OAFD;CAGA;CA1rBF;CAAA;CAAA,mCA4rBgB5N,SA5rBhB,EA6rBC;CAAA;;CACC,UAAMqkB,MAAc,GAAGrkB,SAAS,CAAC+V,SAAV,EAAvB;CAEA,WAAK63B,UAAL,CAAgByF,mBAAhB,CAAoChvB,MAAM,CAACxa,KAAP,EAApC;CAEA,WAAKnP,aAAL,CAAmBy6B,YAAnB,CAAgC;CAC/B/O,QAAAA,QAAQ,EAAE/B,MAAM,CAACxa,KAAP,EADqB;CAE/BwxB,QAAAA,QAAQ,EAAE,KAAK4S,WAAL,CAAiB3S,mBAAjB;CAFqB,OAAhC,EAICnjC,IAJD,CAIM,YAAM;CAEX,YAAI,CAACksB,MAAM,CAAC9b,OAAP,EAAL,EACA;CACC,yCAAI8b,MAAM,CAACjQ,QAAP,GAAkB3Y,MAAlB,EAAJ,EACEoL,GADF,CACM,UAAC/K,IAAD,EAAgB;CACpBuoB,YAAAA,MAAM,CAACtD,kBAAP,CAA0BjlB,IAA1B;CACA,WAHF;;CAMA,UAAA,OAAI,CAACwqC,SAAL,CAAexE,mBAAf,CAAmCzd,MAAnC,EAA2C,OAAI,CAAC+L,aAAL,CAAmBI,UAAnB,EAA3C,EAA4E,IAA5E,EAAkF,KAAlF,EAAyF,KAAzF;CACA;;CAED,QAAA,OAAI,CAAC2f,kBAAL;;CAEA9rB,QAAAA,MAAM,CAAC9a,cAAP;;CAEA,QAAA,OAAI,CAAC6mB,aAAL,CAAmB+E,YAAnB,CAAgC9Q,MAAM,CAACxa,KAAP,EAAhC;;CAEA,QAAA,OAAI,CAACsmB,WAAL,CAAiBkE,qBAAjB;CACA,OAxBD,WAyBO,UAAC76B,QAAD,EAAc;CACpB,QAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OA3BD;CA4BA;CA9tBF;CAAA;CAAA,uCAguBoBwG,SAhuBpB,EAiuBC;CAAA;;CACC,UAAMkvB,WAAW,GAAGlvB,SAAS,CAAC4N,OAAV,EAApB;CACA,WAAKggC,UAAL,CAAgBqE,mBAAhB,CAAoC/iB,WAAW,CAAC9I,QAAhD;CACA,WAAK1rB,aAAL,CAAmB44C,gBAAnB,CAAoCpkB,WAApC,WAAuD,UAAC11B,QAAD,EAAc;CACpE,QAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAFD;CAGA;CAvuBF;CAAA;CAAA,2CAyuBwBwG,SAzuBxB,EA0uBC;CAAA;;CACC,UAAMqkB,MAAc,GAAGrkB,SAAS,CAAC+V,SAAV,EAAvB;CACA,UAAMmZ,WAAW,GAAGlvB,SAAS,CAAC4N,OAAV,EAApB;CAEA,WAAKggC,UAAL,CAAgBqE,mBAAhB,CAAoC/iB,WAAW,CAAC9I,QAAhD;CACA,WAAK1rB,aAAL,CAAmB64C,oBAAnB,CAAwCrkB,WAAxC,EACE/2B,IADF,CACO,UAACqB,QAAD,EAAc;CACnB,YAAM45B,UAAU,GAAG55B,QAAQ,CAACZ,IAA5B;CACAyrB,QAAAA,MAAM,CAACiI,YAAP,CAAoB8G,UAAU,CAAC/M,SAA/B;CACAhC,QAAAA,MAAM,CAACkI,UAAP,CAAkB6G,UAAU,CAAC7M,OAA7B;CACA,OALF,WAMQ,UAAC/sB,QAAD,EAAc;CACpB,QAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OARF;CAUA;CAzvBF;CAAA;CAAA,8CA2vB2BwG,SA3vB3B,EA4vBC;CAAA;;CACC,UAAMqkB,MAAM,GAAGrkB,SAAS,CAAC+V,SAAV,EAAf;CACA,UAAMuJ,aAAa,GAAG+E,MAAM,CAAC9E,gBAAP,EAAtB;CACA,UAAMlV,YAAY,GAAGxN,aAAG,CAACyN,WAAJ,CAAgBgV,aAAhB,CAArB;CAEAziB,MAAAA,aAAG,CAACmN,KAAJ,CAAUqa,MAAM,CAACsJ,mBAAP,EAAV,EAAwC,QAAxC,EAAkD,MAAlD;CAEA,UAAMvjB,MAAM,GAAG,IAAIG,kBAAJ,CAAW;CACzBZ,QAAAA,IAAI,EAAE,EADmB;CAEzBvQ,QAAAA,IAAI,EAAE,QAFmB;CAGzBqM,QAAAA,KAAK,EAAE,SAHkB;CAIzB+E,QAAAA,MAAM,EAAE;CACP7M,UAAAA,IAAI,YAAM0M,YAAY,CAACI,KAAb,GAAqB,CAArB,GAAyB,EAA/B;CADG;CAJiB,OAAX,CAAf;CASAL,MAAAA,MAAM,CAAC7R,IAAP,GAhBD;;CAkBC,WAAKmC,aAAL,CAAmB84C,uBAAnB,CAA2C;CAC1CptB,QAAAA,QAAQ,EAAE/B,MAAM,CAACxa,KAAP;CADgC,OAA3C,EAEG1R,IAFH,CAEQ,UAACqB,QAAD,EAAc;CACrB4Q,QAAAA,MAAM,CAACM,IAAP;;CACA,YAAIlR,QAAQ,CAACZ,IAAT,CAAciB,MAAd,GAAuB,CAA3B,EACA;CACCL,UAAAA,QAAQ,CAACZ,IAAT,CAAcoG,OAAd,CAAsB,UAAC+uB,UAAD,EAA4B;CACjD,gBAAMjyB,IAAI,GAAG8O,IAAI,CAAC2Y,SAAL,CAAewK,UAAf,CAAb;;CACA,gBAAI,CAAC1J,MAAM,CAACjQ,QAAP,GAAkB3T,GAAlB,CAAsB3E,IAAI,CAAC+N,KAAL,EAAtB,CAAL,EACA;CACC/N,cAAAA,IAAI,CAACgR,gBAAL,CAAsBuX,MAAM,CAAC5gB,UAAP,EAAtB;CACA4gB,cAAAA,MAAM,CAAC0nB,gBAAP,CAAwBjwC,IAAxB;CACAuoB,cAAAA,MAAM,CAACwe,OAAP,CAAe/mC,IAAf;CACA;CACD,WARD;CASA,SAXD,MAaA;CACCuoB,UAAAA,MAAM,CAACwtB,SAAP;CACA;;CACDxtB,QAAAA,MAAM,CAACgL,WAAP,CAAmBhL,MAAM,CAACsJ,mBAAP,EAAnB;CACA,OArBD,WAqBS,UAACn0B,QAAD,EAAc;CACtB4Q,QAAAA,MAAM,CAACM,IAAP;;CACA,QAAA,OAAI,CAAChQ,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAxBD;CAyBA;CAvyBF;CAAA;CAAA,8CAyyB2BwG,SAzyB3B,EA0yBC;CACC,UAAMqkB,MAAM,GAAGrkB,SAAS,CAAC+V,SAAV,EAAf;CAEA,UAAMi9B,eAAe,GAAG,IAAIvX,eAAJ,CAAoB;CAC3C7kC,QAAAA,SAAS,EAAE,KAAKA,SAD2B;CAE3CiJ,QAAAA,OAAO,EAAE,KAAKA,OAF6B;CAG3CvB,QAAAA,KAAK,EAAE,KAAKA,KAH+B;CAI3Co9B,QAAAA,cAAc,EAAE,KAAKA;CAJsB,OAApB,CAAxB;CAOAsX,MAAAA,eAAe,CAACS,iBAAhB,CAAkCpvB,MAAlC;CACA;CArzBF;CAAA;CAAA,wCAuzBqBrkB,SAvzBrB,EAwzBC;CAAA;;CACC,UAAMmU,MAAM,GAAGnU,SAAS,CAAC+V,SAAV,EAAf;CACA,UAAMmV,MAAM,GAAGlrB,SAAS,CAAC4N,OAAV,GAAoBnE,OAApB,EAAf;;CAEA,UAAI,KAAKiqC,aAAT,EACA;CACC,aAAKA,aAAL,CAAmB3Q,cAAnB,GAAoC3hB,OAApC;CACA,aAAKsyB,aAAL,GAAqB,IAArB;CAEA;CACA;;CAED,UAAMC,UAAU,GAAGzoB,MAAM,CAACxtB,qBAAP,EAAnB;CAEA,WAAKg2C,aAAL,GAAqB,IAAI1Q,eAAJ,CAAS;CAC7BtrC,QAAAA,EAAE,EAAE,6BADyB;CAE7Bs+B,QAAAA,WAAW,EAAE9K,MAFgB;CAG7BzpB,QAAAA,UAAU,EAAG,IAHgB;CAI7BC,QAAAA,KAAK,EAAE;CACNsvB,UAAAA,QAAQ,EAAE,KADJ;CAENxmB,UAAAA,MAAM,EAAE;CAFF,SAJsB;CAQ7B5I,QAAAA,UAAU,EAAE+xC,UAAU,CAAClpC,KAAX,GAAmB;CARF,OAAT,CAArB;CAWA,WAAKipC,aAAL,CAAmBxQ,WAAnB,CAA+B;CAC9B/C,QAAAA,IAAI,EAAE/lC,aAAG,CAACC,UAAJ,CAAe,sCAAf,CADwB;CAE9B+lC,QAAAA,OAAO,EAAE,iBAAC3pC,KAAD,EAAQ4pC,QAAR,EAAqB;CAC7B,UAAA,OAAI,CAACkQ,iBAAL,CAAwB,IAAI7G,0BAAJ,EAAD,CAAkBkK,SAAlB,CAA4Bz/B,MAA5B,CAAvB;;CACAksB,UAAAA,QAAQ,CAACO,aAAT,GAAyBtpC,KAAzB;CACA;CAL6B,OAA/B;CAOA,WAAKo8C,aAAL,CAAmBxQ,WAAnB,CAA+B;CAC9B/C,QAAAA,IAAI,EAAE/lC,aAAG,CAACC,UAAJ,CAAe,uCAAf,CADwB;CAE9B+lC,QAAAA,OAAO,EAAE,iBAAC3pC,KAAD,EAAQ4pC,QAAR,EAAqB;CAC7B,UAAA,OAAI,CAAClQ,WAAL,CAAiB4E,YAAjB;;CACAsL,UAAAA,QAAQ,CAACO,aAAT,GAAyBtpC,KAAzB;CACA;CAL6B,OAA/B;CAQA,WAAKo8C,aAAL,CAAmB3Q,cAAnB,GAAoCvsC,SAApC,CAA8C,SAA9C,EAAyD,YAAM;CAC9D,QAAA,OAAI,CAACk9C,aAAL,CAAmB3Q,cAAnB,GAAoC3hB,OAApC;;CACA,QAAA,OAAI,CAACsyB,aAAL,GAAqB,IAArB;CACA,OAHD;CAIA,WAAKA,aAAL,CAAmB3Q,cAAnB,GAAoCvsC,SAApC,CAA8C,QAA9C,EAAwD,YAAM;CAC7D,YAAMkL,KAAK,GAAG,OAAI,CAACgyC,aAAL,CAAmBG,gBAAnB,GAAsCl3C,aAAtC,CAAoD,qBAApD,CAAd;;CACAE,QAAAA,aAAG,CAACmN,KAAJ,CAAUtI,KAAV,EAAiB,eAAjB,EAAkC,MAAlC;CACA,OAHD;CAKA,WAAKgyC,aAAL,CAAmBn7C,IAAnB;CACA;CA12BF;CAAA;CAAA,+BA42BYyH,SA52BZ,EA62BC;CACC,UAAMlE,IAAI,GAAGkE,SAAS,CAAC4N,OAAV,EAAb;CAEA,WAAKhX,SAAL,CAAe46C,kBAAf,CAAkC,KAAK1xC,UAAL,CAAgBiE,OAAhB,CAAwB,WAAxB,EAAqCjI,IAAI,CAACuR,WAAL,EAArC,CAAlC;CACA;CAj3BF;CAAA;CAAA,yCAm3BsBrN,SAn3BtB,EAo3BC;CACC,UAAMlE,IAAI,GAAGkE,SAAS,CAAC4N,OAAV,EAAb;CAEA,WAAKuiC,kBAAL;CAEC,WAAK/f,aAAL,CAAmB4P,kBAAnB,CAAsClkC,IAAI,CAAC+N,KAAL,EAAtC,CAAD,CAAsDgX,mBAAtD;CACA;CA13BF;CAAA;CAAA,qCA43BkB7gB,SA53BlB,EA63BC;CACC,WAAKukC,WAAL,CAAiBuP,oBAAjB,CAAsC,KAAKtrC,KAA3C,EAAkDxI,SAAS,CAAC4N,OAAV,EAAlD;CACA;CA/3BF;CAAA;CAAA,wCAk4BC;CACC,WAAK22B,WAAL,CAAiBwP,qBAAjB;CACA;CAp4BF;CAAA;CAAA,kCAs4Be/zC,SAt4Bf,EAu4BC;CACC,UAAM8G,GAAG,GAAG9G,SAAS,CAAC4N,OAAV,EAAZ;CACA,UAAM5E,YAAY,GAAG,KAAKvJ,MAAL,CAAYu0C,iBAAZ,CAA8B;CAACp8C,QAAAA,IAAI,EAAE,KAAP;CAAcmF,QAAAA,KAAK,EAAE;CAArB,OAA9B,CAArB;CACA,UAAM2b,QAAQ,GAAIzQ,MAAM,CAACnB,GAAD,CAAN,KAAgBmB,MAAM,CAACe,YAAD,CAAtB,GAAuC,EAAvC,GAA4C,CAACf,MAAM,CAACnB,GAAD,CAAP,CAA9D;CAEA,WAAKrH,MAAL,CAAYw0C,gBAAZ,CAA6B,CAC5B;CACCr8C,QAAAA,IAAI,EAAE,KADP;CAECmF,QAAAA,KAAK,EAAE2b;CAFR,OAD4B,EAK5B;CACC9gB,QAAAA,IAAI,EAAE,WADP;CAECmF,QAAAA,KAAK,EAAE2b;CAFR,OAL4B,CAA7B;CAUA,WAAKjZ,MAAL,CAAYy0C,uBAAZ;CACA;CAv5BF;CAAA;CAAA,qCAy5BkBl0C,SAz5BlB,EA05BC;CACC,WAAKukC,WAAL,CAAiB4P,oBAAjB,CAAsC,KAAK3rC,KAA3C,EAAkDxI,SAAS,CAAC4N,OAAV,EAAlD;CACA;CA55BF;CAAA;CAAA,wCA+5BC;CACC,WAAK22B,WAAL,CAAiB6P,qBAAjB;CACA;CAj6BF;CAAA;CAAA,mCAm6BgBp0C,SAn6BhB,EAo6BC;CACC,UAAM+U,MAAM,GAAG/U,SAAS,CAAC4N,OAAV,EAAf;CACA,UAAM5E,YAAY,GAAG,KAAKvJ,MAAL,CAAYu0C,iBAAZ,CAA8B;CAACp8C,QAAAA,IAAI,EAAE,MAAP;CAAemF,QAAAA,KAAK,EAAE;CAAtB,OAA9B,CAArB;;CAEA,UAAIkL,MAAM,CAAC8M,MAAD,CAAN,KAAmB9M,MAAM,CAACe,YAAD,CAA7B,EACA;CACC,aAAKvJ,MAAL,CAAY40C,eAAZ,CAA4B;CAACz8C,UAAAA,IAAI,EAAE,MAAP;CAAemF,UAAAA,KAAK,EAAE;CAAtB,SAA5B;CACA,OAHD,MAKA;CACC,aAAK0C,MAAL,CAAY40C,eAAZ,CAA4B;CAACz8C,UAAAA,IAAI,EAAE,MAAP;CAAemF,UAAAA,KAAK,EAAEkL,MAAM,CAAC8M,MAAD;CAA5B,SAA5B;CACA;;CAED,WAAKtV,MAAL,CAAYy0C,uBAAZ;CACA;CAl7BF;CAAA;CAAA,sCAo7BmBl0C,SAp7BnB,EAq7BC;CAAA;;CACC,UAAMuN,WAAW,GAAGvN,SAAS,CAAC4N,OAAV,EAApB;CAEA,WAAKuiB,WAAL,CAAiBvR,YAAjB,CAA8BrR,WAA9B;CAEA,WAAK4iC,kBAAL;CAEA,UAAM39B,QAAQ,GAAG,KAAK4d,aAAL,CAAmB8N,cAAnB,EAAjB;CAEA1rB,MAAAA,QAAQ,CACNxT,OADF,CACU,UAACmV,MAAD,EAAoB;CAC5B,YAAI,CAACA,MAAM,CAAC9P,WAAP,EAAL,EACA;CACC8P,UAAAA,MAAM,CAAC0M,mBAAP;CACA1M,UAAAA,MAAM,CAACkmB,OAAP;CACA;CACD,OAPF;CAUA,WAAK3/B,aAAL,CAAmB45C,aAAnB,CAAiC;CAChC/mC,QAAAA,WAAW,EAAEA;CADmB,OAAjC,EAGCpV,IAHD,CAGM,UAACqB,QAAD,EAAc;CACnBgZ,QAAAA,QAAQ,CACNxT,OADF,CACU,UAACmV,MAAD,EAAoB;CAC5B,cAAI,CAACA,MAAM,CAAC9P,WAAP,EAAL,EACA;CACC8P,YAAAA,MAAM,CAACyK,YAAP,CAAoBrR,WAApB;CACA4G,YAAAA,MAAM,CAAC4L,oBAAP;CACA5L,YAAAA,MAAM,CAAComB,MAAP;CACA;CACD,SARF;CAUA,OAdD,WAeO,UAAC/gC,QAAD,EAAc;CACpBgZ,QAAAA,QAAQ,CACNxT,OADF,CACU,UAACmV,MAAD,EAAoB;CAC5B,cAAI,CAACA,MAAM,CAAC9P,WAAP,EAAL,EACA;CACC8P,YAAAA,MAAM,CAAComB,MAAP;CACA;CACD,SANF;;CAQA,QAAA,OAAI,CAAC7/B,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAzBD;CA0BA;CAl+BF;CAAA;CAAA,wCAo+BqBwG,SAp+BrB,EAq+BC;CACC,UAAMlE,IAAI,GAAGkE,SAAS,CAAC4N,OAAV,EAAb;CACA,UAAMuG,MAAM,GAAGnU,SAAS,CAAC+V,SAAV,EAAf;;CAEA,UAAI,KAAKqiB,WAAT,EACA;CACC,YAAMmc,aAAa,GAAI,KAAKnc,WAAL,CAAiBoc,OAAjB,GAA2B3qC,KAA3B,OAAuC/N,IAAI,CAAC+N,KAAL,EAA9D;CAEA,aAAKsmC,kBAAL;;CAEA,YAAIoE,aAAa,IAAIpgC,MAAM,CAACsgC,kBAAP,CAA0B34C,IAA1B,CAArB,EACA;CACC,eAAK+kB,mBAAL,CAAyB1M,MAAzB,EAAiCrY,IAAjC;CAEA;CACA;CACD;;CAED,WAAK8kB,iBAAL,CAAuBzM,MAAvB,EAA+BrY,IAA/B;CAEA,WAAK44C,eAAL,CAAqBvgC,MAArB,EAA6BrY,IAA7B;;CAEA,UAAI,KAAKkyC,WAAL,CAAiB1pB,QAAjB,EAAJ,EACA;CACC,aAAK0pB,WAAL,CAAiB1U,wBAAjB,CAA0Cx9B,IAA1C;CACA;CACD;CA//BF;CAAA;CAAA,iCAigCckE,SAjgCd,EAkgCC;CAAA;;CACC,UAAMlE,IAAI,GAAGkE,SAAS,CAAC4N,OAAV,EAAb;;CAEA,UAAI,KAAKogC,WAAL,CAAiB1pB,QAAjB,EAAJ,EACA;CACC,aAAK0pB,WAAL,CAAiBxT,IAAjB;CAEA;CACA;;CAED,WAAK2V,kBAAL;CAEA,UAAMxE,iBAAiB,GAAG9uC,aAAG,CAACyN,WAAJ,CAAgB,KAAK6lB,WAAL,CAAiByb,iBAAjB,EAAhB,CAA1B;CAEA/tC,MAAAA,MAAM,CAAC8yB,QAAP,CAAgB;CAAE34B,QAAAA,GAAG,EAAE2zC,iBAAiB,CAAC3zC,GAAzB;CAA8B64B,QAAAA,QAAQ,EAAE;CAAxC,OAAhB;CAEA,UAAMzmB,MAAM,GAAG,IAAIG,kBAAJ,CAAW;CACzBxD,QAAAA,MAAM,EAAE,KAAKopB,WAAL,CAAiByb,iBAAjB,EADiB;CAEzBphC,QAAAA,MAAM,EAAE;CACPxS,UAAAA,GAAG,YAAK2zC,iBAAiB,CAAC3zC,GAAlB,GAAwB,CAA7B;CADI;CAFiB,OAAX,CAAf;CAOAoS,MAAAA,MAAM,CAAC7R,IAAP;CAEA,WAAKy1C,WAAL,CAAiBntB,mBAAjB;CACA,WAAKmtB,WAAL,CAAiB7U,UAAjB;CAEA,WAAKz+B,aAAL,CAAmBi6C,eAAnB,CAAmC;CAClC9+B,QAAAA,MAAM,EAAE/Z,IAAI,CAACuR,WAAL;CAD0B,OAAnC,EAGElV,IAHF,CAGO,UAACqB,QAAD,EAAuC;CAC5C,YAAMo7C,aAAa,GAAGp7C,QAAQ,CAACZ,IAAT,CAAcgE,KAApC;CACA,YAAMq8B,aAAa,GAAGz/B,QAAQ,CAACZ,IAAT,CAAcqgC,aAApC;CAEA2b,QAAAA,aAAa,CAAC51C,OAAd,CAAsB,UAAC+uB,UAAD,EAA4B;CACjD,cAAMjyB,IAAI,GAAG8O,IAAI,CAAC2Y,SAAL,CAAewK,UAAf,CAAb;;CACA,cAAM5Z,MAAM,GAAG,OAAI,CAACic,aAAL,CAAmB2N,oBAAnB,CAAwCjiC,IAAI,CAAC8U,WAAL,EAAxC,CAAf;;CAEA,cAAI,CAACuD,MAAM,CAAC9P,WAAP,EAAD,IAAyB,CAAC8P,MAAM,CAAC8c,OAAP,CAAen1B,IAAf,CAA9B,EACA;CACCA,YAAAA,IAAI,CAAC8iB,YAAL,CAAkBzK,MAAM,CAACwL,YAAP,EAAlB;CACAxL,YAAAA,MAAM,CAAC43B,gBAAP,CAAwBjwC,IAAxB;CACAqY,YAAAA,MAAM,CAAC0uB,OAAP,CAAe/mC,IAAf;CACA;CACD,SAVD;;CAYA,YAAM+4C,QAAQ,GAAG,OAAI,CAACzkB,aAAL,CAAmByJ,WAAnB,EAAjB;;CACA,YAAMj9B,KAAK,GAAG,IAAI4D,GAAJ,EAAd;CACAy4B,QAAAA,aAAa,CAACj6B,OAAd,CAAsB,UAAC2T,MAAD,EAAoB;CACzC,cAAIkiC,QAAQ,CAACp0C,GAAT,CAAakS,MAAb,CAAJ,EACA;CACC/V,YAAAA,KAAK,CAACmF,GAAN,CAAU8yC,QAAQ,CAAC79B,GAAT,CAAarE,MAAb,CAAV;CACA;CACD,SALD;;CAMA,QAAA,OAAI,CAACu7B,YAAL,CAAkB9/B,iBAAlB,CAAoCxR,KAApC;;CAEA,YAAIq8B,aAAa,CAACp/B,MAAd,GAAuB,CAA3B,EACA;CACC,UAAA,OAAI,CAACm0C,WAAL,CAAiB/f,KAAjB,CAAuBnyB,IAAvB,EAA6Bm9B,aAA7B;CACA,SAHD,MAKA;CACC,UAAA,OAAI,CAAC+U,WAAL,CAAiBtU,SAAjB;CACA;;CAEDtvB,QAAAA,MAAM,CAACM,IAAP;CACA,OAvCF,WAwCQ,UAAClR,QAAD,EAAc;CACpB,QAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;;CAEA4Q,QAAAA,MAAM,CAACM,IAAP;CACA,OA5CF;CA8CA;CA5kCF;CAAA;CAAA,0CA+kCC;CACC,UAAI,KAAK0tB,WAAT,EACA;CACC,aAAKA,WAAL,CAAiB0c,yBAAjB;CACA;;CAED,UAAI,KAAK3D,WAAT,EACA;CACC,aAAKA,WAAL,CAAiBC,mBAAjB;CACA,aAAKD,WAAL,GAAmB,IAAnB;CACA;;CAED,UAAI,KAAK7K,SAAL,CAAeyO,oBAAf,EAAJ,EACA;CACC,aAAKzO,SAAL,CAAe0O,uBAAf;CACA;;CAED,UAAI,KAAKzQ,WAAL,CAAiBwQ,oBAAjB,EAAJ,EACA;CACC,aAAKxQ,WAAL,CAAiByQ,uBAAjB;CACA;;CAED,UAAI,KAAKpjC,iBAAL,IAA0B,KAAKA,iBAAL,CAAuBC,MAAvB,EAA9B,EACA;CACC,aAAKD,iBAAL,CAAuBlH,IAAvB;CACA;CACD;CAzmCF;CAAA;CAAA,gCA2mCa1K,SA3mCb,EA4mCC;CAAA;;CACC,UAAM6hB,OAAgB,GAAG7hB,SAAS,CAAC+V,SAAV,EAAzB;CAEAlC,MAAAA,UAAU,CAAC,YAAM;CAChB,YAAI,CAACgO,OAAO,CAACtZ,OAAR,EAAL,EACA;CACC;CACA;;CACD,YAAI,OAAI,CAAC6nB,aAAL,CAAmB4b,oBAAnB,EAAJ,EACA;CACC,cAAInqB,OAAO,CAAC7C,oBAAR,EAAJ,EACA;CACC6C,YAAAA,OAAO,CAAC2M,mBAAR;CACA,WAHD,MAKA;CACC3M,YAAAA,OAAO,CAAC4M,YAAR;CACA;CACD,SAVD,MAYA;CACC5M,UAAAA,OAAO,CAACgwB,SAAR;CACA;CACD,OApBS,EAoBP,GApBO,CAAV;CAqBA;CApoCF;CAAA;CAAA,0CAsoCuB7xC,SAtoCvB,EAuoCC;CACC,WAAKmwC,kBAAL;CACA;CAzoCF;CAAA;CAAA,mCA2oCgBnwC,SA3oChB,EA4oCC;CACC,UAAMqkB,MAAc,GAAGrkB,SAAS,CAAC+V,SAAV,EAAvB;CAEAlC,MAAAA,UAAU,CAAC,YAAM;CAChB,YAAI,CAACwQ,MAAM,CAAC9b,OAAP,EAAL,EACA;CACC;CACA;;CACD,YAAI8b,MAAM,CAAChC,cAAP,KAA0B,CAA1B,IAA+BgC,MAAM,CAACrF,oBAAP,EAAnC,EACA;CACCqF,UAAAA,MAAM,CAACmK,mBAAP;CACA,SAHD,MAKA;CACCnK,UAAAA,MAAM,CAACoK,YAAP;CACA;CACD,OAbS,EAaP,GAbO,CAAV;CAcA;CA7pCF;CAAA;CAAA,8BA+pCWta,MA/pCX,EAgqCC;CAAA;;CACC,UAAI,KAAK5U,sBAAL,CAA4ByX,GAA5B,CAAgC7C,MAAM,CAACtK,KAAP,EAAhC,IAAkD,CAAtD,EACA;CACC;CACA;;CAEDsK,MAAAA,MAAM,CAACmmB,kBAAP,CAA0B,IAA1B;;CAEA,UAAInmB,MAAM,CAAC8M,cAAP,MAA2B,KAAKhC,QAApC,EACA;CACC9K,QAAAA,MAAM,CAACsN,YAAP,GAAsBC,YAAtB;CACA;;CAED,UAAMtX,MAAM,GAAG+J,MAAM,CAAC8gC,eAAP,EAAf;CAEA,UAAM/lB,WAAW,GAAG;CACnBrjB,QAAAA,QAAQ,EAAEsI,MAAM,CAACtK,KAAP,EADS;CAEnBsnB,QAAAA,UAAU,EAAEhd,MAAM,CAAC+gC,kBAAP,KAA8B,CAFvB;CAGnBj2B,QAAAA,QAAQ,EAAE,KAAKA;CAHI,OAApB;CAMA,WAAKvkB,aAAL,CAAmB0Z,QAAnB,CAA4B8a,WAA5B,EACE/2B,IADF,CACO,UAACqB,QAAD,EAAc;CACnB,YAAMoD,KAAK,GAAGpD,QAAQ,CAACZ,IAAvB;CAEAub,QAAAA,MAAM,CAACmmB,kBAAP,CAA0B,KAA1B;;CAEA,YAAI5gC,cAAI,CAACkM,OAAL,CAAahJ,KAAb,KAAuBA,KAAK,CAAC/C,MAAjC,EACA;CACCsa,UAAAA,MAAM,CAACghC,wBAAP;;CAEA,UAAA,OAAI,CAACC,mBAAL,CAAyBjhC,MAAzB,EAAiCvX,KAAjC;;CAEA,cAAIuX,MAAM,CAACxC,WAAP,EAAJ,EACA;CACCwC,YAAAA,MAAM,CAACyM,iBAAP;CACA;;CAEDzM,UAAAA,MAAM,CAACqM,eAAP;CACA,SAZD,MAcA;CACC,cAAIrM,MAAM,CAACkO,cAAP,OAA4BlO,MAAM,CAAC8M,cAAP,EAAhC,EACA;CACC,YAAA,OAAI,CAAC1hB,sBAAL,CAA4BqK,GAA5B,CACCuK,MAAM,CAACtK,KAAP,EADD,EAEC,OAAI,CAACtK,sBAAL,CAA4ByX,GAA5B,CAAgC7C,MAAM,CAACtK,KAAP,EAAhC,IAAkD,CAFnD;;CAKAsK,YAAAA,MAAM,CAACkhC,wBAAP;;CAEA,YAAA,OAAI,CAACvF,SAAL,CAAe37B,MAAf;CACA,WAVD,MAYA;CACCA,YAAAA,MAAM,CAACmhC,iBAAP;CACA;CACD;;CACDlrC,QAAAA,MAAM,CAACM,IAAP;CACA,OAtCF,WAuCQ,UAAClR,QAAD,EAAc;CACpB4Q,QAAAA,MAAM,CAACM,IAAP;CACAyJ,QAAAA,MAAM,CAACmmB,kBAAP,CAA0B,KAA1B;;CACA,QAAA,OAAI,CAAC5/B,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OA3CF;CA6CA;CAluCF;CAAA;CAAA,8BAouCW2a,MApuCX,EAouC2BuI,QApuC3B,EAquCC;CAAA;;CACC,aAAO,IAAI7jB,OAAJ,CAAY,UAACC,OAAD,EAAa;CAC/B,YAAI,OAAI,CAAC0P,KAAL,CAAWsV,QAAX,EAAJ,EACA;CACC,UAAA,OAAI,CAACtV,KAAL,CAAW2U,MAAX;;CAEA,cAAI,OAAI,CAAC3U,KAAL,CAAW+sC,SAAX,CAAqBphC,MAArB,CAAJ,EACA;CACCrb,YAAAA,OAAO;CACP,WAHD,MAKA;CACC,YAAA,OAAI,CAAC0P,KAAL,CAAW+oC,aAAX,CAAyB,WAAzB,EAAsC,YAAM;CAC3C,cAAA,OAAI,CAAC/oC,KAAL,CAAWe,cAAX;;CAEA,cAAA,OAAI,CAACisC,WAAL,CAAiBrhC,MAAjB,EAAyBuI,QAAzB;;CAEA5jB,cAAAA,OAAO;CACP,aAND;CAOA;CACD,SAlBD,MAoBA;CACC,UAAA,OAAI,CAAC08C,WAAL,CAAiBrhC,MAAjB,EAAyBuI,QAAzB;;CAEA5jB,UAAAA,OAAO;CACP;CACD,OA1BM,CAAP;CA2BA;CAjwCF;CAAA;CAAA,gCAmwCaqb,MAnwCb,EAmwC6BuI,QAnwC7B,EAowCC;CACC,WAAKlU,KAAL,CAAWitC,SAAX,CAAqBthC,MAArB;;CAEA,UAAIza,cAAI,CAACg8C,aAAL,CAAmBh5B,QAAnB,CAAJ,EACA;CACC,aAAKlU,KAAL,CAAWmtC,WAAX,CAAuBj5B,QAAvB;CAEA7f,QAAAA,aAAG,CAAC+4C,WAAJ,CAAgB,KAAKptC,KAAL,CAAW5J,MAAX,EAAhB,EAAqC8d,QAArC;CACA,OALD,MAOA;CACC,aAAKlU,KAAL,CAAWqtC,aAAX;;CAEA,YAAI1hC,MAAM,CAAC5L,OAAP,EAAJ,EACA;CACC1L,UAAAA,aAAG,CAACujB,YAAJ,CAAiB,KAAK5X,KAAL,CAAW5J,MAAX,EAAjB,EAAsCuV,MAAM,CAACoN,aAAP,EAAtC;CACA,SAHD,MAKA;CACC1kB,UAAAA,aAAG,CAACujB,YAAJ,CAAiB,KAAK5X,KAAL,CAAW5J,MAAX,EAAjB,EAAsCuV,MAAM,CAACuuB,gBAAP,CAAwB,KAAKl6B,KAA7B,CAAtC;CACA;CACD;;CAED2L,MAAAA,MAAM,CAAC4L,oBAAP;CAEA,WAAKvX,KAAL,CAAWM,KAAX;CAEA,WAAKgtC,aAAL;CACA;CAhyCF;CAAA;CAAA,oCAmyCC;CACC,UAAM3hC,MAAc,GAAG,KAAK3L,KAAL,CAAWkpC,SAAX,EAAvB;;CAEA,UAAIv9B,MAAM,CAACwO,SAAP,EAAJ,EACA;CACC,YAAM4N,eAAe,GAAGpc,MAAM,CAACoL,gBAAP,EAAxB;CAEA,YAAMw2B,WAAW,GAAGl5C,aAAG,CAAC6zB,mBAAJ,CAAwB,KAAKloB,KAAL,CAAW4P,YAAX,EAAxB,EAAmDmY,eAAnD,EAAoEv4B,GAAxF;CAEAu4B,QAAAA,eAAe,CAACI,QAAhB,CAAyB;CACxB34B,UAAAA,GAAG,EAAEu4B,eAAe,CAACK,SAAhB,GAA4BmlB,WAA5B,GAA0C,GADvB;CAExBllB,UAAAA,QAAQ,EAAE;CAFc,SAAzB;CAIA,OAVD,MAYA;CACC,YAAMC,gBAAgB,GAAG,KAAKX,WAAL,CAAiBY,mBAAjB,EAAzB;CAEA,YAAMglB,YAAW,GAAGl5C,aAAG,CAAC6zB,mBAAJ,CAAwB,KAAKloB,KAAL,CAAW4P,YAAX,EAAxB,EAAmD0Y,gBAAnD,EAAqE94B,GAAzF;CAEA84B,QAAAA,gBAAgB,CAACH,QAAjB,CAA0B;CACzB34B,UAAAA,GAAG,EAAE84B,gBAAgB,CAACF,SAAjB,GAA6BmlB,YAA7B,GAA2C,GADvB;CAEzBllB,UAAAA,QAAQ,EAAE;CAFe,SAA1B;CAIA;CACD;CA5zCF;CAAA;CAAA,wCA8zCqB1c,MA9zCrB,EA8zCqCvX,KA9zCrC,EA+zCC;CAAA;;CACCA,MAAAA,KAAK,CAACoC,OAAN,CAAc,UAACskB,QAAD,EAA0B;CACvC,YAAMxnB,IAAI,GAAG8O,IAAI,CAAC2Y,SAAL,CAAeD,QAAf,CAAb;CACAxnB,QAAAA,IAAI,CAACgQ,aAAL,CAAmBqI,MAAM,CAACjF,aAAP,EAAnB;;CACA,YAAI,CAAC,OAAI,CAACkhB,aAAL,CAAmBsN,gBAAnB,CAAoC5hC,IAAI,CAAC+N,KAAL,EAApC,CAAL,EACA;CACC/N,UAAAA,IAAI,CAAC8iB,YAAL,CAAkBzK,MAAM,CAACwL,YAAP,EAAlB;CACAxL,UAAAA,MAAM,CAAC43B,gBAAP,CAAwBjwC,IAAxB;CACAqY,UAAAA,MAAM,CAAC0uB,OAAP,CAAe/mC,IAAf;CACA;CACD,OATD;CAUA;CA10CF;CAAA;CAAA,oCA40CiBqY,MA50CjB,EA40CiCrY,IA50CjC,EA60CC;CAAA;;CACC,UAAMk6C,UAAU,GAAG,SAAbA,UAAa,GAAM;CACxB,YAAI,OAAI,CAAChI,WAAL,CAAiB1pB,QAAjB,EAAJ,EACA;CACC,UAAA,OAAI,CAAC0pB,WAAL,CAAiBxT,IAAjB;CACA;CACD,OALD;;CAOA,UAAMyb,gBAAgB,GAAI9hC,MAAM,CAACgjB,iBAAP,GAA2BxtB,IAA3B,GAAkC,CAA5D,CARD;;CAWC,WAAKyuB,WAAL,GAAmB,IAAIrC,WAAJ,CAAgB;CAClC5hB,QAAAA,MAAM,EAAEA,MAD0B;CAElCrY,QAAAA,IAAI,EAAEA,IAF4B;CAGlCm6B,QAAAA,QAAQ,EAAE;CACTC,UAAAA,IAAI,EAAE;CACLC,YAAAA,QAAQ,EAAE,IADL;CAELzyB,YAAAA,OAAO,EAAGuyC,gBAFL;CAGLxe,YAAAA,QAAQ,EAAE,oBAAM;CACf,cAAA,OAAI,CAAC8X,UAAL,CACC,IAAI7F,0BAAJ,CAAc;CACb9wC,gBAAAA,IAAI,EAAEkD;CADO,eAAd,CADD;;CAKA,cAAA,OAAI,CAACq0C,kBAAL;;CACAh8B,cAAAA,MAAM,CAAC0M,mBAAP;CACA;CAXI,WADG;CAcTuV,UAAAA,UAAU,EAAE;CACXD,YAAAA,QAAQ,EAAE,IADC;CAEXzyB,YAAAA,OAAO,EAAG,CAAC5H,IAAI,CAACo6C,aAAL,EAFA;CAGXze,YAAAA,QAAQ,EAAE,kBAAChhC,KAAD,EAAW;CACpB,kBAAI,OAAI,CAAC06C,WAAT,EACA;CACC,gBAAA,OAAI,CAACA,WAAL,CAAiBC,mBAAjB;;CACA,gBAAA,OAAI,CAACD,WAAL,GAAmB,IAAnB;CAEA;CACA;;CACD,cAAA,OAAI,CAACA,WAAL,GAAmB,IAAIzwC,WAAJ,CAAgB;CAClCC,gBAAAA,aAAa,EAAElK,KAAK,CAACy7B;CADa,eAAhB,CAAnB;;CAGA,cAAA,OAAI,CAACif,WAAL,CAAiB36C,SAAjB,CAA2B,UAA3B,EAAuC,UAACwJ,SAAD,EAAe;CACrD,gBAAA,OAAI,CAACm2C,iBAAL,CAAuBhiC,MAAvB,EAA+BnU,SAAS,CAAC4N,OAAV,EAA/B;CACA,eAFD;;CAGA,cAAA,OAAI,CAACujC,WAAL,CAAiBiF,kBAAjB,CAAoC3/C,KAAK,CAACy7B,aAA1C;;CACA,cAAA,OAAI,CAACkG,WAAL,CAAiB5hC,SAAjB,CAA2B,WAA3B,EAAwC,YAAM;CAC7C,oBAAI,OAAI,CAAC26C,WAAT,EACA;CACC,kBAAA,OAAI,CAACA,WAAL,CAAiBC,mBAAjB;;CACA,kBAAA,OAAI,CAACD,WAAL,GAAmB,IAAnB;CACA;CACD,eAND;CAOA;CAzBU,WAdH;CAyCT9a,UAAAA,GAAG,EAAE;CACJF,YAAAA,QAAQ,EAAE,IADN;CAEJzyB,YAAAA,OAAO,EAAGuyC,gBAFN;CAGJxe,YAAAA,QAAQ,EAAE,oBAAM;CACf,cAAA,OAAI,CAAC4e,OAAL,CAAav6C,IAAb;;CACA,cAAA,OAAI,CAACq0C,kBAAL;;CACAh8B,cAAAA,MAAM,CAAC0M,mBAAP;CACA;CAPG,WAzCI;CAkDTyV,UAAAA,IAAI,EAAE;CACLH,YAAAA,QAAQ,EAAE,IADL;CAELzyB,YAAAA,OAAO,EAAI,CAAC5H,IAAI,CAACw6C,SAAL,EAFP;CAGL7e,YAAAA,QAAQ,EAAE,kBAAChhC,KAAD,EAAW;CACpB,cAAA,OAAI,CAAC8/C,QAAL,CAAcz6C,IAAd,EAAoBrF,KAAK,CAACy7B,aAA1B;;CACA8jB,cAAAA,UAAU;CACV;CANI,WAlDG;CA0DT3xB,UAAAA,MAAM,EAAE;CACP8R,YAAAA,QAAQ,EAAE,IADH;CAEPzyB,YAAAA,OAAO,EAAG,KAFH;CAGP0R,YAAAA,QAAQ,EAAI,KAAKgb,aAAL,CAAmBwR,6BAAnB,CAAiDztB,MAAjD,EAAyDxK,IAAzD,GAAgE,CAHrE;CAIP8tB,YAAAA,QAAQ,EAAE,kBAAChhC,KAAD,EAAW;CACpB,cAAA,OAAI,CAAC+/C,YAAL,CAAkBriC,MAAlB,EAA0BrY,IAA1B,EAAgCrF,KAAK,CAACy7B,aAAtC;;CACA8jB,cAAAA,UAAU;CACV;CAPM,WA1DC;CAmETn0B,UAAAA,OAAO,EAAE;CACRsU,YAAAA,QAAQ,EAAE,IADF;CAERzyB,YAAAA,OAAO,EAAI5H,IAAI,CAACoT,aAAL,OAAyB,QAF5B;CAGRuoB,YAAAA,QAAQ,EAAE,oBAAM;CACf,cAAA,OAAI,CAACgf,aAAL,CAAmBtiC,MAAnB,EAA2BrY,IAA3B;;CACA,cAAA,OAAI,CAACq0C,kBAAL;;CACA6F,cAAAA,UAAU;CACV;CAPO,WAnEA;CA4ETpvC,UAAAA,IAAI,EAAE;CACLuvB,YAAAA,QAAQ,EAAE,IADL;CAELzyB,YAAAA,OAAO,EAAG,CAAC5H,IAAI,CAACo6C,aAAL,EAFN;CAGLze,YAAAA,QAAQ,EAAE,kBAAChhC,KAAD,EAAW;CACpB,kBAAI,OAAI,CAAC8tC,WAAL,CAAiBwQ,oBAAjB,EAAJ,EACA;CACC,gBAAA,OAAI,CAACxQ,WAAL,CAAiByQ,uBAAjB;;CAEA;CACA;;CACD,cAAA,OAAI,CAAC0B,eAAL,CAAqBviC,MAArB,EAA6BrY,IAA7B,EAAmCrF,KAAK,CAACy7B,aAAzC;CACA;CAXI,WA5EG;CAyFTvsB,UAAAA,IAAI,EAAE;CACLwwB,YAAAA,QAAQ,EAAE,IADL;CAELzyB,YAAAA,OAAO,EAAG,CAAC5H,IAAI,CAACo6C,aAAL,EAFN;CAGLze,YAAAA,QAAQ,EAAE,kBAAChhC,KAAD,EAAW;CACpB,kBAAI,OAAI,CAAC8tC,WAAL,CAAiBwQ,oBAAjB,EAAJ,EACA;CACC,gBAAA,OAAI,CAACxQ,WAAL,CAAiByQ,uBAAjB;;CAEA;CACA;;CACD,cAAA,OAAI,CAAC2B,gBAAL,CAAsBxiC,MAAtB,EAA8BrY,IAA9B,EAAoCrF,KAAK,CAACy7B,aAA1C;CACA;CAXI,WAzFG;CAsGTqE,UAAAA,aAAa,EAAE;CACdJ,YAAAA,QAAQ,EAAE,IADI;CAEdzyB,YAAAA,OAAO,EAAIuyC,gBAFG;CAGdxe,YAAAA,QAAQ,EAAE,oBAAM;CACf,kBAAItjB,MAAM,CAACwO,SAAP,EAAJ,EACA;CACC,gBAAA,OAAI,CAACi0B,yBAAL,CAA+BziC,MAA/B,EAAuCrY,IAAvC;CACA,eAHD,MAKA;CACC,gBAAA,OAAI,CAAC+6C,wBAAL,CAA8B1iC,MAA9B,EAAsCrY,IAAtC;CACA;;CACD,cAAA,OAAI,CAACq0C,kBAAL;;CACAh8B,cAAAA,MAAM,CAAC0M,mBAAP;CACAm1B,cAAAA,UAAU;CACV;CAfa,WAtGN;CAuHTtsC,UAAAA,MAAM,EAAE;CACPysB,YAAAA,QAAQ,EAAE,IADH;CAEPzyB,YAAAA,OAAO,EAAI,CAAC5H,IAAI,CAACg7C,eAAL,EAFL;CAGPrf,YAAAA,QAAQ,EAAE,oBAAM;CACfn9B,cAAAA,gCAAU,CAAC2vB,OAAX,CACC7vB,aAAG,CAACC,UAAJ,CAAe,uCAAf,CADD,EAEC,UAAC6vB,UAAD,EAAgB;CACfA,gBAAAA,UAAU,CAAC5yB,KAAX;;CACA,gBAAA,OAAI,CAACy/C,gBAAL,CAAsB5iC,MAAtB,EAA8Bhc,IAA9B,CAAmC,YAAM;CACxCgc,kBAAAA,MAAM,CAACgjB,iBAAP,GAA2Bn4B,OAA3B,CAAmC,UAACwhC,aAAD,EAAyB;CAC3DrsB,oBAAAA,MAAM,CAACgM,UAAP,CAAkBqgB,aAAlB;;CACA,oBAAA,OAAI,CAAC3f,mBAAL,CAAyB1M,MAAzB,EAAiCqsB,aAAjC;;CACAA,oBAAAA,aAAa,CAACj3B,cAAd;CACA,mBAJD;;CAKA,kBAAA,OAAI,CAACm2B,oBAAL,CAA0BvrB,MAA1B;CACA,iBAPD;CAQA,eAZF,EAaC/Z,aAAG,CAACC,UAAJ,CAAe,gCAAf,CAbD;;CAeA,cAAA,OAAI,CAAC81C,kBAAL;;CACA6F,cAAAA,UAAU;CACV;CArBM;CAvHC;CAHwB,OAAhB,CAAnB;CAoJA,WAAK5d,WAAL,CAAiB5hC,SAAjB,CAA2B,UAA3B,EAAuC,YAAM;CAC5C,QAAA,OAAI,CAAC25C,kBAAL;;CACAh8B,QAAAA,MAAM,CAAC0M,mBAAP;CACA,OAHD;CAKA,WAAKuX,WAAL,CAAiB7/B,IAAjB;CACA;CAl/CF;CAAA;CAAA,wCAq/CC;CACC,WAAK63B,aAAL,CAAmByJ,WAAnB,GAAiC76B,OAAjC,CAAyC,UAAClD,IAAD;CAAA,eAAgBA,IAAI,CAACgR,gBAAL,CAAsB,KAAtB,CAAhB;CAAA,OAAzC;CACA;CAv/CF;CAAA;CAAA,0CA0/CC;CACC,WAAKsjB,aAAL,CAAmByJ,WAAnB,GAAiC76B,OAAjC,CAAyC,UAAClD,IAAD;CAAA,eAAgBA,IAAI,CAACgR,gBAAL,CAAsB,IAAtB,CAAhB;CAAA,OAAzC;CACA;CA5/CF;CAAA;CAAA,sCA8/CmBqH,MA9/CnB,EA8/CmCrY,IA9/CnC,EA+/CC;CACC,UAAIA,IAAJ,EACA;CACCqY,QAAAA,MAAM,CAAC4M,kBAAP,CAA0BjlB,IAA1B;CACA;;CAED,UAAIqY,MAAM,CAACxC,WAAP,EAAJ,EACA;CACC;CACA;;CAEDwC,MAAAA,MAAM,CAACyM,iBAAP;;CAEA,UAAIzM,MAAM,CAACtK,KAAP,OAAmB,KAAKumB,aAAL,CAAmBI,UAAnB,GAAgC3mB,KAAhC,EAAvB,EACA;CACC,aAAKumB,aAAL,CAAmBI,UAAnB,GAAgC3P,mBAAhC;CACA;;CACD,WAAKuP,aAAL,CAAmBgE,UAAnB,GAAgCp1B,OAAhC,CAAwC,UAACqlB,MAAD,EAAY;CACnD,YAAIlQ,MAAM,CAACtK,KAAP,OAAmBwa,MAAM,CAACxa,KAAP,EAAvB,EACA;CACCwa,UAAAA,MAAM,CAACxD,mBAAP;CACA;CACD,OALD;CAMA;CAthDF;CAAA;CAAA,wCAwhDqB1M,MAxhDrB,EAwhDqCrY,IAxhDrC,EAyhDC;CACC,UAAIA,IAAJ,EACA;CACCqY,QAAAA,MAAM,CAAC2M,uBAAP,CAA+BhlB,IAA/B;CACA;;CAED,UAAI,CAACqY,MAAM,CAACxC,WAAP,EAAL,EACA;CACC;CACA;;CAED,UAAMqM,cAAc,GAAG7J,MAAM,CAACgjB,iBAAP,EAAvB;;CACA,UAAInZ,cAAc,CAACrU,IAAf,KAAwB,CAA5B,EACA;CACCwK,QAAAA,MAAM,CAAC0M,mBAAP;CACA,OAHD,MAKA;CACC,aAAK6zB,eAAL,CAAqBvgC,MAArB,EAA6B+sB,KAAK,CAACC,IAAN,CAAWnjB,cAAc,CAACviB,MAAf,EAAX,EAAoCod,GAApC,EAA7B;CACA;CACD;CA7iDF;CAAA;CAAA,+BA+iDYrQ,KA/iDZ,EAgjDC;CACC,UAAM7C,IAAI,GAAG6C,KAAK,CAAC2H,OAAN,EAAb;CAEA,UAAMpT,KAAK,GAAGyL,KAAK,CAAC4P,YAAN,GAAqBrb,KAArB,CAA2BkH,IAA3B,EAAd;CAEA,UAAM+yC,gBAAgB,GACrBrxC,IAAI,GACD5I,KAAK,CAACgH,OAAN,CAAc,IAAIY,MAAJ,CAAW,MAAMd,IAAI,CAACe,WAAL,CAAiBe,IAAI,CAAC/N,IAAtB,CAAN,GAAoC,GAA/C,EAAoD,GAApD,CAAd,EAAwE,EAAxE,CADC,GAEDmF,KAHJ;CAMA,UAAMjB,IAAI,GAAG8O,IAAI,CAAC2Y,SAAL,CAAe;CAC3B7rB,QAAAA,EAAE,EAAE,EADuB;CAE3BE,QAAAA,IAAI,EAAEo/C,gBAFqB;CAG3Bn3C,QAAAA,OAAO,EAAE,KAAKwuC,iBAAL,EAHkB;CAI3BvuC,QAAAA,UAAU,EAAE,KAAKA;CAJU,OAAf,CAAb;CAOAhE,MAAAA,IAAI,CAAC8iB,YAAL,CAAkB,KAAKrR,WAAvB;CAEA,aAAOzR,IAAP;CACA;CArkDF;CAAA;CAAA,4CAukDyBqY,MAvkDzB,EAukDyCrY,IAvkDzC,EAwkDC;CACC,UAAMozB,WAAW,GAAG;CACnB,iBAASpzB,IAAI,CAAC+N,KAAL,EADU;CAEnB,gBAAQ/N,IAAI,CAAC2T,OAAL,GAAetI,QAAf,EAFW;CAGnB,oBAAYrL,IAAI,CAAC8U,WAAL,EAHO;CAInB,sBAAcuD,MAAM,CAACjF,aAAP,EAJK;CAKnB,kBAAUpT,IAAI,CAACqU,OAAL,GAAehJ,QAAf,GAA0BzP,EALjB;CAMnB,gBAAQoE,IAAI,CAACqV,OAAL,EANW;CAOnB,uBAAerV,IAAI,CAAC4U,cAAL,GAAsBvJ,QAAtB,GAAiCmB,SAAjC,EAPI;CAQnB,wBAAgBxM,IAAI,CAAC+U,eAAL,EARG;CASnB,uBAAe/U,IAAI,CAAC0U,cAAL,GAAsBrJ,QAAtB,EATI;CAUnB,gBAAQrL,IAAI,CAACm7C,OAAL,EAVW;CAWnB,oBAAY,KAAK3Q,SAAL,CAAe7G,aAAf,CAA6BtrB,MAAM,CAACoL,gBAAP,EAA7B;CAXO,OAApB;CAaA,aAAO,KAAK7kB,aAAL,CAAmBw8C,UAAnB,CAA8BhoB,WAA9B,CAAP;CACA;CAvlDF;CAAA;CAAA,0CAylDuBpzB,IAzlDvB,EAylDmCq7C,YAzlDnC,EA0lDC;CACCr7C,MAAAA,IAAI,CAACwP,KAAL,CAAW6rC,YAAY,CAACz/C,EAAxB;CACAoE,MAAAA,IAAI,CAACsU,OAAL,CAAa+mC,YAAY,CAACxxC,IAA1B;CACA7J,MAAAA,IAAI,CAACyU,OAAL,CAAa4mC,YAAY,CAACvwC,IAA1B;CACA9K,MAAAA,IAAI,CAAC2U,cAAL,CAAoB0mC,YAAY,CAAC9vC,WAAjC;CACAvL,MAAAA,IAAI,CAACkQ,WAAL,CAAiBmrC,YAAY,CAAC7yC,QAA9B;CACAxI,MAAAA,IAAI,CAACiR,iBAAL,CAAuBoqC,YAAY,CAACnqC,cAApC;CAEAlR,MAAAA,IAAI,CAAC4T,OAAL,CAAa5T,IAAI,CAAC2T,OAAL,GAAetI,QAAf,EAAb;CACA;CAnmDF;CAAA;CAAA,yCAqmDsB22B,YArmDtB,EAqmD4CY,SArmD5C,EAsmDC;CACC,UAAMlsB,QAAQ,GAAG,IAAIhT,GAAJ,EAAjB;CAEAgT,MAAAA,QAAQ,CAAC5I,GAAT,CAAak0B,YAAY,CAACj0B,KAAb,EAAb,EAAmCi0B,YAAnC;;CACA,UAAIY,SAAJ,EACA;CACClsB,QAAAA,QAAQ,CAAC5I,GAAT,CAAa80B,SAAS,CAAC70B,KAAV,EAAb,EAAgC60B,SAAhC;CACA;;CAED,WAAKvC,cAAL,CAAoBiF,cAApB,CAAmC5uB,QAAnC;CACA;CAhnDF;CAAA;CAAA,yCAmnDC;CACC,UAAI,KAAK4lB,WAAT,EACA;CACC,aAAKA,WAAL,CAAiBhX,OAAjB;CACA;;CAED,WAAKgX,WAAL,GAAmB,IAAnB;CACA;CA1nDF;CAAA;CAAA,qCA6nDC;CACC,aAAO,KAAKA,WAAZ;CACA;CA/nDF;CAAA;CAAA,sCAioDmBjkB,MAjoDnB,EAioDmClT,WAjoDnC,EAkoDC;CAAA;;CACC,UAAIA,WAAW,CAACpH,MAAZ,KAAuB,CAA3B,EACA;CACC;CACA;;CAED,UAAMghB,OAAO,GAAG,EAAhB;CAEA1G,MAAAA,MAAM,CAACgjB,iBAAP,GACEn4B,OADF,CACU,UAACwhC,aAAD,EAAyB;CACjC,QAAA,OAAI,CAAC8N,QAAL,CAAc2D,mBAAd,CAAkCzR,aAAa,CAAC32B,KAAd,EAAlC;;CACAgR,QAAAA,OAAO,CAACre,IAAR,CAAagkC,aAAa,CAAC32B,KAAd,EAAb;CACA,OAJF;CAOA,WAAKnP,aAAL,CAAmBy7C,iBAAnB,CAAqC;CACpCt7B,QAAAA,OAAO,EAAEA,OAD2B;CAEpC5Z,QAAAA,WAAW,EAAEA;CAFuB,OAArC,EAIE9I,IAJF,CAIO,UAACqB,QAAD,EAAc;CACnB2a,QAAAA,MAAM,CAACgjB,iBAAP,GACEn4B,OADF,CACU,UAACwhC,aAAD,EAAyB;CACjCA,UAAAA,aAAa,CAACxwB,QAAd,CAAuBxW,QAAQ,CAACZ,IAAT,CAAcob,kBAAd,CAAiCwsB,aAAa,CAAC32B,KAAd,EAAjC,CAAvB;CACA,SAHF;;CAKA,QAAA,OAAI,CAACsmC,kBAAL;;CACAh8B,QAAAA,MAAM,CAAC0M,mBAAP;CACA,OAZF,WAaQ,UAACrnB,QAAD,EAAc;CACpB,QAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OAfF;CAiBA;CAlqDF;CAAA;CAAA,4BAoqDSsC,IApqDT,EAqqDC;CACC,WAAKlF,SAAL,CAAe+kC,eAAf,CAA+B,KAA/B,EAAsC;CACrCiJ,QAAAA,IAAI,EAAE,MAD+B;CAErC/kC,QAAAA,OAAO,EAAE,KAAKA,OAFuB;CAGrCgW,QAAAA,MAAM,EAAE/Z,IAAI,CAACuR,WAAL,EAH6B;CAIrC+pC,QAAAA,iBAAiB,EAAE;CAJkB,OAAtC;CAMA;CA5qDF;CAAA;CAAA,6BA8qDUt7C,IA9qDV,EA8qDsB4lC,UA9qDtB,EA+qDC;CACC,WAAK4E,SAAL,CAAeiQ,QAAf,CAAwBz6C,IAAxB,EAA8B4lC,UAA9B;CACA;CAjrDF;CAAA;CAAA,iCAmrDc/R,UAnrDd,EAmrDkC7zB,IAnrDlC,EAmrD8C4lC,UAnrD9C,EAorDC;CACC,WAAK4E,SAAL,CAAehF,mBAAf,CAAmC3R,UAAnC,EAA+C7zB,IAA/C,EAAqD,IAArD,EAA2D4lC,UAA3D;;CAEA,UAAI,KAAKtR,aAAL,CAAmBwR,6BAAnB,CAAiDjS,UAAjD,EAA6DhmB,IAA7D,IAAqE,CAAzE,EACA;CACC,aAAKwmC,kBAAL;CACA;CACD;CA3rDF;CAAA;CAAA,kCA6rDe9rB,MA7rDf,EA6rD+BvoB,IA7rD/B,EA8rDC;CACC,WAAKwqC,SAAL,CAAehF,mBAAf,CAAmCjd,MAAnC,EAA2CvoB,IAA3C,EAAiD,KAAKs0B,aAAL,CAAmBI,UAAnB,EAAjD;CACA;CAhsDF;CAAA;CAAA,oCAksDiBrc,MAlsDjB,EAksDiCrY,IAlsDjC,EAksD6C4lC,UAlsD7C,EAmsDC;CAAA;;CACC,WAAK6C,WAAL,CAAiB8S,cAAjB,CAAgCv7C,IAAhC,EAAsC4lC,UAAtC;CAEA,WAAK6C,WAAL,CAAiBtkB,cAAjB,CAAgC,iBAAhC;CACA,WAAKskB,WAAL,CAAiB/tC,SAAjB,CAA2B,iBAA3B,EAA8C,UAAC28C,cAAD,EAAoB;CACjE,YAAMrsC,GAAG,GAAGqsC,cAAc,CAACvlC,OAAf,EAAZ;CAEA,YAAMiN,OAAO,GAAG,EAAhB;CACA1G,QAAAA,MAAM,CAACgjB,iBAAP,GAA2Bn4B,OAA3B,CAAmC,UAACwhC,aAAD,EAAyB;CAC3D,UAAA,OAAI,CAAC8N,QAAL,CAAc2D,mBAAd,CAAkCzR,aAAa,CAAC32B,KAAd,EAAlC;;CACAgR,UAAAA,OAAO,CAACre,IAAR,CAAagkC,aAAa,CAAC32B,KAAd,EAAb;CACA,SAHD;;CAIA,QAAA,OAAI,CAACnP,aAAL,CAAmBogB,cAAnB,CAAkC;CACjCD,UAAAA,OAAO,EAAEA,OADwB;CAEjC/T,UAAAA,GAAG,EAAEA;CAF4B,SAAlC,EAGG3O,IAHH,CAGQ,UAACqB,QAAD,EAAc;CACrB2a,UAAAA,MAAM,CAACgjB,iBAAP,GAA2Bn4B,OAA3B,CAAmC,UAACwhC,aAAD,EAAyB;CAC3D,gBAAMyM,WAAW,GAAGzM,aAAa,CAACnwB,OAAd,GAAwBlJ,QAAxB,EAApB;;CACA,gBAAI,CAAC8lC,WAAW,CAAC5E,QAAZ,CAAqBvhC,GAArB,CAAL,EACA;CACCmmC,cAAAA,WAAW,CAACzwC,IAAZ,CAAiBsK,GAAjB;CACA;;CACD05B,YAAAA,aAAa,CAACjwB,OAAd,CAAsB08B,WAAtB;CACA,WAPD;CAQA,SAZD,WAYS,UAACzzC,QAAD,EAAc;CACtB,UAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,SAdD;CAgBA,OAxBD;CA0BA,WAAK+qC,WAAL,CAAiBtkB,cAAjB,CAAgC,mBAAhC;CACA,WAAKskB,WAAL,CAAiB/tC,SAAjB,CAA2B,mBAA3B,EAAgD,UAAC28C,cAAD,EAAoB;CACnE,YAAMrsC,GAAG,GAAGqsC,cAAc,CAACvlC,OAAf,EAAZ;CAEA,YAAMiN,OAAO,GAAG,EAAhB;CACA1G,QAAAA,MAAM,CAACgjB,iBAAP,GAA2Bn4B,OAA3B,CAAmC,UAACwhC,aAAD,EAAyB;CAC3D,UAAA,OAAI,CAAC8N,QAAL,CAAc2D,mBAAd,CAAkCzR,aAAa,CAAC32B,KAAd,EAAlC;;CACAgR,UAAAA,OAAO,CAACre,IAAR,CAAagkC,aAAa,CAAC32B,KAAd,EAAb;CACA,SAHD;;CAIA,QAAA,OAAI,CAACnP,aAAL,CAAmB48C,cAAnB,CAAkC;CACjCz8B,UAAAA,OAAO,EAAEA,OADwB;CAEjC/T,UAAAA,GAAG,EAAEA;CAF4B,SAAlC,EAGG3O,IAHH,CAGQ,UAACqB,QAAD,EAAc;CACrB2a,UAAAA,MAAM,CAACgjB,iBAAP,GAA2Bn4B,OAA3B,CAAmC,UAACwhC,aAAD,EAAyB;CAC3D,gBAAMyM,WAAW,GAAGzM,aAAa,CAACnwB,OAAd,GAAwBlJ,QAAxB,EAApB;CACA8lC,YAAAA,WAAW,CAACsK,MAAZ,CAAmBtK,WAAW,CAACuK,OAAZ,CAAoB1wC,GAApB,CAAnB,EAA6C,CAA7C;CACA05B,YAAAA,aAAa,CAACjwB,OAAd,CAAsB08B,WAAtB;CACA,WAJD;CAKA,SATD,WASS,UAACzzC,QAAD,EAAc;CACtB,UAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,SAXD;CAYA,OApBD;CAsBA,WAAK+qC,WAAL,CAAiBtkB,cAAjB,CAAgC,eAAhC;CACA,WAAKskB,WAAL,CAAiB/tC,SAAjB,CAA2B,eAA3B,EAA4C,YAAM;CACjD,YAAI,CAAC,OAAI,CAAC+tC,WAAL,CAAiBkT,iBAAjB,EAAL,EACA;CACC,UAAA,OAAI,CAACtH,kBAAL;;CACAh8B,UAAAA,MAAM,CAAC0M,mBAAP;CACA;CACD,OAND;CAOA;CAhwDF;CAAA;CAAA,qCAkwDkB1M,MAlwDlB,EAkwDkCrY,IAlwDlC,EAkwD8C4lC,UAlwD9C,EAmwDC;CAAA;;CACC,WAAK6C,WAAL,CAAiBmT,cAAjB,CAAgC57C,IAAhC,EAAsC4lC,UAAtC;CAEA,WAAK6C,WAAL,CAAiBtkB,cAAjB,CAAgC,gBAAhC;CACA,WAAKskB,WAAL,CAAiB/tC,SAAjB,CAA2B,gBAA3B,EAA6C,UAAC28C,cAAD,EAA+B;CAC3E,YAAMt4B,OAAO,GAAG,EAAhB;CACA,YAAM9F,MAAM,GAAGo+B,cAAc,CAACvlC,OAAf,EAAf;CACAuG,QAAAA,MAAM,CAACgjB,iBAAP,GACEn4B,OADF,CACU,UAACwhC,aAAD,EAAyB;CACjCA,UAAAA,aAAa,CAACpwB,OAAd,CAAsB,OAAI,CAACm0B,WAAL,CAAiB5sB,WAAjB,CAA6B5C,MAA7B,CAAtB;CACA8F,UAAAA,OAAO,CAACre,IAAR,CAAagkC,aAAa,CAAC32B,KAAd,EAAb;;CACA,UAAA,OAAI,CAACykC,QAAL,CAAc2D,mBAAd,CAAkCzR,aAAa,CAAC32B,KAAd,EAAlC;CACA,SALF;;CAOA,QAAA,OAAI,CAACnP,aAAL,CAAmBi9C,eAAnB,CAAmC;CAClC98B,UAAAA,OAAO,EAAEA,OADyB;CAElC9F,UAAAA,MAAM,EAAEA;CAF0B,SAAnC,EAIE5c,IAJF,CAIO,UAACqB,QAAD,EAAc,EAJrB,WAKQ,UAACA,QAAD,EAAc;CACpB,UAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,SAPF;CASA,OAnBD;CAqBA,WAAK+qC,WAAL,CAAiBtkB,cAAjB,CAAgC,gBAAhC;CACA,WAAKskB,WAAL,CAAiB/tC,SAAjB,CAA2B,gBAA3B,EAA6C,YAAM;CAClD,QAAA,OAAI,CAAC25C,kBAAL;;CACAh8B,QAAAA,MAAM,CAAC0M,mBAAP;CACA,OAHD;CAIA;CAjyDF;CAAA;CAAA,qCAmyDkB1M,MAnyDlB,EAoyDC;CAAA;;CACC,UAAM0G,OAAO,GAAG,EAAhB;CAEA1G,MAAAA,MAAM,CAACgjB,iBAAP,GAA2Bn4B,OAA3B,CAAmC,UAACwhC,aAAD,EAAyB;CAE3D3lB,QAAAA,OAAO,CAACre,IAAR,CAAagkC,aAAa,CAAC32B,KAAd,EAAb;;CAEA,QAAA,OAAI,CAACykC,QAAL,CAAc+E,mBAAd,CAAkC7S,aAAa,CAAC32B,KAAd,EAAlC;CACA,OALD;CAOA,aAAO,KAAKnP,aAAL,CAAmBk9C,WAAnB,CAA+B;CACrC/8B,QAAAA,OAAO,EAAEA,OAD4B;CAErCwgB,QAAAA,QAAQ,EAAE,KAAKiL,SAAL,CAAe7G,aAAf,CAA6BtrB,MAAM,CAACoL,gBAAP,EAA7B;CAF2B,OAA/B,WAGE,UAAC/lB,QAAD,EAAc;CACtB,QAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,OALM,CAAP;CAMA;CApzDF;CAAA;CAAA,8CAszD2B2a,MAtzD3B,EAszD2C9K,UAtzD3C,EAuzDC;CACC,WAAKktB,aAAL,GAAqB,IAAI6V,aAAJ,CAAkB;CACtC/iC,QAAAA,UAAU,EAAEA;CAD0B,OAAlB,CAArB;;CAIA,UAAI,CAACA,UAAU,CAACmD,YAAX,EAAL,EACA;CACC,aAAK0hC,YAAL,CAAkB2J,2BAAlB,GACE1/C,IADF,CACO,UAACyrC,WAAD,EAAyB;CAC9Bv6B,UAAAA,UAAU,CAACi7B,cAAX,CAA0BV,WAA1B;CACA,SAHF;CAKA;;CAED,WAAKyN,SAAL,CAAel9B,MAAf,EAAuB9K,UAAU,CAACI,OAAX,EAAvB;CACA;CAt0DF;CAAA;CAAA,6CAw0D0B0K,MAx0D1B,EAw0D0C9K,UAx0D1C,EAy0DC;CAAA;;CACC,WAAKktB,aAAL,GAAqB,IAAI6V,aAAJ,CAAkB;CACtC/iC,QAAAA,UAAU,EAAEA;CAD0B,OAAlB,CAArB;CAIAA,MAAAA,UAAU,CAACyuC,yBAAX;;CAEA,UAAMC,wBAAwB,GAAG,SAA3BA,wBAA2B,CAAC5sC,QAAD,EAAwB;CACxD,YAAI,CAACA,QAAQ,CAACxH,OAAT,EAAL,EACA;CACCwQ,UAAAA,MAAM,CAACya,mBAAP,CAA2BzjB,QAAQ,CAACvM,MAAT,EAA3B,EAA8CyK,UAAU,CAACI,OAAX,EAA9C;CACA;;CACDJ,QAAAA,UAAU,CAACwlB,YAAX;;CAEA,QAAA,OAAI,CAACwiB,SAAL,CAAel9B,MAAf,EAAuBhJ,QAAQ,CAAC1B,OAAT,EAAvB;CACA,OARD;;CAUA,UAAIJ,UAAU,CAACiD,YAAX,EAAJ,EACA;CACC,YAAMnB,QAAQ,GAAG9B,UAAU,CAACiG,WAAX,EAAjB;;CAEA,YAAInE,QAAQ,CAAC5C,OAAT,EAAJ,EACA;CACC,eAAK7N,aAAL,CAAmBg4C,eAAnB,CAAmC;CAClC7mC,YAAAA,QAAQ,EAAEsI,MAAM,CAACtK,KAAP,EADwB;CAElCgM,YAAAA,MAAM,EAAExM,UAAU,CAACgE,WAAX;CAF0B,WAAnC,EAIElV,IAJF,CAIO,UAACqB,QAAD,EAAc;CACnBA,YAAAA,QAAQ,CAACZ,IAAT,CAAcoG,OAAd,CAAsB,UAAC+uB,UAAD,EAA4B;CACjD,kBAAM4kB,WAAW,GAAG/nC,IAAI,CAAC2Y,SAAL,CAAewK,UAAf,CAApB;CACA5Z,cAAAA,MAAM,CAAC0uB,OAAP,CAAe8P,WAAf;CACAxnC,cAAAA,QAAQ,CAACmnC,OAAT,CAAiBK,WAAjB;CACA,aAJD;CAKAoF,YAAAA,wBAAwB,CAAC5sC,QAAD,CAAxB;CACA,WAXF,WAYQ,UAAC3R,QAAD,EAAc;CACpB,YAAA,OAAI,CAACkB,aAAL,CAAmBm4B,cAAnB,CAAkCr5B,QAAlC;CACA,WAdF;CAgBA,SAlBD,MAoBA;CACCu+C,UAAAA,wBAAwB,CAAC5sC,QAAD,CAAxB;CACA;CACD,OA3BD,MA6BA;CACC,aAAKkmC,SAAL,CAAel9B,MAAf,EAAuB9K,UAAU,CAACI,OAAX,EAAvB;CACA;CACD;CA13DF;CAAA;CAAA,EAA0BpK,IAA1B;;;KCnEa24C,oBAAb;CAAA;;CAEC,gCAAYngD,MAAZ,EACA;CAAA;;CAAA;CACC;CAEA,UAAKogD,iBAAL,GAAyBpgD,MAAM,CAACogD,iBAAhC;;CAEA,UAAK/hD,iBAAL,CAAuB,mCAAvB;;CALD;CAMC;;CATF;CAAA;CAAA,6BAYC;CACC,UAAMi1B,cAAc,GAAI,KAAK8sB,iBAAL,GAAyB,EAAzB,GAA8B,iBAAtD;CAEA,UAAMv7C,IAAI,GAAGiC,aAAG,CAACC,MAAP,6PAC2EusB,cAD3E,EAGL/wB,aAAG,CAACC,UAAJ,CAAe,qCAAf,CAHK,CAAV;CAQA6E,MAAAA,eAAK,CAAChE,IAAN,CAAWwB,IAAX,EAAiB,OAAjB,EAA0B,KAAKw7C,qBAAL,CAA2Bh9C,IAA3B,CAAgC,IAAhC,CAA1B;CAEA,aAAOwB,IAAP;CACA;CA1BF;CAAA;CAAA,4CA6BC;CACC,UAAI,KAAKu7C,iBAAT,EACA;CACC,aAAKlhD,IAAL,CAAU,gBAAV;CACA;CACD;CAlCF;CAAA;CAAA,EAA0CR,6BAA1C;;;KCOa4hD,WAAb;CAAA;;CAEC,uBAAYtgD,MAAZ,EACA;CAAA;;CAAA;CACC,6GAAMA,MAAN;CAEA,UAAKjB,SAAL,GAAiBiB,MAAM,CAACjB,SAAxB;CACA,UAAKwhD,oBAAL,GAA4BvgD,MAAM,CAACugD,oBAAnC;CACA,UAAKC,gBAAL,GAAwBxgD,MAAM,CAACwgD,gBAA/B;CACA,UAAKx4C,OAAL,GAAehI,MAAM,CAACgI,OAAtB;;CAEA,UAAK3J,iBAAL,CAAuB,4BAAvB;;CARD;CASC;;CAZF;CAAA;CAAA,6BAeC;CACC,UAAIslB,SAAS,GAAG,4FAAhB;;CACA,UAAI,KAAK88B,oBAAL,EAAJ,EACA;CACC98B,QAAAA,SAAS,IAAI,mBAAb;CACA;;CAED,UAAM9e,IAAI,GAAGiC,aAAG,CAACC,MAAP,0JACQ4c,SADR,EAENphB,aAAG,CAACC,UAAJ,CAAe,2BAAf,CAFM,CAAV;CAMA6E,MAAAA,eAAK,CAAChE,IAAN,CAAWwB,IAAX,EAAiB,OAAjB,EAA0B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA1B;CAEA,aAAOwB,IAAP;CACA;CA/BF;CAAA;CAAA,8BAkCC;CACC,UAAI,KAAK47C,oBAAL,EAAJ,EACA;CACCliD,QAAAA,EAAE,CAACslB,EAAH,CAAM68B,UAAN,CAAiBhgD,IAAjB,CAAsB,oBAAtB,EAA4C;CAC3CigD,UAAAA,OAAO,EAAE,IADkC;CAE3CC,UAAAA,oBAAoB,EAAE;CACrBC,YAAAA,MAAM,EAAE,OADa;CAErBjb,YAAAA,MAAM,EAAE;CAFa;CAFqB,SAA5C;CAOA,OATD,MAWA;CACC,YAAMjmC,GAAG,GAAG,mEACT4C,aAAG,CAACC,UAAJ,CAAe,SAAf,CADS,GACmB,cADnB,GACoC,KAAKwF,OADrD;CAGA,aAAKjJ,SAAL,CAAeklC,aAAf,CAA6BtkC,GAA7B,EAAkC;CAACmhD,UAAAA,kBAAkB,EAAE,CAArB;CAAwBC,UAAAA,SAAS,EAAE;CAAnC,SAAlC;CACA;CACD;CApDF;CAAA;CAAA,2CAuDC;CACC,aAAQ,KAAKR,oBAAL,IAA6B,CAAC,KAAKC,gBAA3C;CACA;CAzDF;CAAA;CAAA,EAAiC9hD,6BAAjC;;KCOasiD,YAAb;CAAA;;CAEC,wBAAYhhD,MAAZ,EACA;CAAA;;CAAA;CACC,8GAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,6BAAvB;;CAEA,UAAK4iD,SAAL,CAAejhD,MAAf;;CAEA,QAAI,MAAK49B,iBAAL,EAAJ,EACA;CACC,YAAK56B,YAAL;CACA;;CAED,UAAKjE,SAAL,GAAiB,IAAIX,SAAJ,EAAjB;CAZD;CAaC;;CAhBF;CAAA;CAAA,wCAkBqBiK,SAlBrB,EAmBC;CACC,oHAA0BA,SAA1B,EADD;;CAIC,UAAI,KAAKmkB,MAAT,EACA;CACC,aAAKmF,KAAL,GAAaF,YAAY,CAACG,KAAb,CAAmB,KAAKpF,MAAxB,CAAb;CACA,aAAKmF,KAAL,CAAWuvB,cAAX;CAEAl8C,QAAAA,aAAG,CAACyD,MAAJ,CAAW,KAAKkpB,KAAL,CAAW5qB,MAAX,EAAX,EAAgCsB,SAAhC;CACA;CACD;CA9BF;CAAA;CAAA,0CAgCuBA,SAhCvB,EAiCC;CACC,sHAA4BA,SAA5B;;CAEA,UAAI,CAAC,KAAKu1B,iBAAL,EAAL,EACA;CACC;CACA;;CAED,UAAI,KAAKwiB,iBAAT;CACA;CACC,cAAMe,WAAW,GAAG,IAAIb,WAAJ,CAAgB;CACnCvhD,YAAAA,SAAS,EAAE,KAAKA,SADmB;CAEnCiJ,YAAAA,OAAO,EAAE,KAAKwuC,iBAAL,EAF0B;CAGnC+J,YAAAA,oBAAoB,EAAE,KAAKA,oBAAL,EAHa;CAInCC,YAAAA,gBAAgB,EAAE,KAAKY,kBAAL;CAJiB,WAAhB,CAApB;CAOAp8C,UAAAA,aAAG,CAACyD,MAAJ,CAAW04C,WAAW,CAACp6C,MAAZ,EAAX,EAAiCsB,SAAjC;CACA;;CAED,UAAMg5C,oBAAoB,GAAG,IAAIlB,oBAAJ,CAAyB;CACrDC,QAAAA,iBAAiB,EAAE,KAAKA;CAD6B,OAAzB,CAA7B;CAGAiB,MAAAA,oBAAoB,CAAC1iD,SAArB,CAA+B,gBAA/B,EAAiD,KAAKm6C,gBAAL,CAAsBz1C,IAAtB,CAA2B,IAA3B,CAAjD;CAEA2B,MAAAA,aAAG,CAACyD,MAAJ,CAAW44C,oBAAoB,CAACt6C,MAArB,EAAX,EAA0CsB,SAA1C;CAEArD,MAAAA,aAAG,CAACgI,QAAJ,CAAa3E,SAAb,EAAwB,cAAxB;CACA;CA7DF;CAAA;CAAA,8BA+DWrI,MA/DX,EAgEC;CACC,WAAK21C,cAAL,GAAsB5tC,QAAQ,CAAC/H,MAAM,CAAC21C,cAAR,EAAwB,EAAxB,CAA9B;CAEA,WAAK2L,qBAAL,CAA2BthD,MAAM,CAACuhD,iBAAlC;CACA,WAAKC,mBAAL,CAAyBxhD,MAAM,CAACwgD,gBAAhC;CAEA,WAAK/5C,KAAL,GAAazG,MAAM,CAACyG,KAApB;CAEA,WAAK25C,iBAAL,GAA0BpgD,MAAM,CAACogD,iBAAP,KAA6B,GAAvD;CACA;CAzEF;CAAA;CAAA,0CA2EuBqB,aA3EvB,EA4EC;CACC,WAAKA,aAAL,GAAsBA,aAAa,KAAK,GAAxC;CACA;CA9EF;CAAA;CAAA,2CAiFC;CACC,aAAO,KAAKA,aAAZ;CACA;CAnFF;CAAA;CAAA,wCAqFqBjB,gBArFrB,EAsFC;CACC,WAAKA,gBAAL,GAAyBA,gBAAgB,KAAK,GAA9C;CACA;CAxFF;CAAA;CAAA,yCA2FC;CACC,aAAO,KAAKA,gBAAZ;CACA;CA7FF;CAAA;CAAA,wCAgGC;CACC,aAAO,KAAK7K,cAAL,GAAsB,CAA7B;CACA;CAlGF;CAAA;CAAA,mCAqGC;CAAA;;CACC;CACA,UAAM+L,aAAa,GAAGnjD,EAAE,CAACqf,KAAH,CAAS+jC,KAAT,CAAeC,MAArC;;CACA,UAAIF,aAAJ,EACA;CACC,aAAKG,kBAAL,CAAwBH,aAAa,CAACI,SAAd,EAAxB;CACAJ,QAAAA,aAAa,CAACK,8BAAd,GAA+C56C,OAA/C,CAAuD,UAAC66C,MAAD,EAAY;CAClE,UAAA,MAAI,CAACH,kBAAL,CAAwBG,MAAxB;CACA,SAFD;CAGA;CACD;CA/GF;CAAA;CAAA,uCAiHoBA,MAjHpB,EAkHC;CAAA;;CACCtjD,MAAAA,6BAAY,CAACC,SAAb,CAAuBqjD,MAAvB,EAA+B,yBAA/B,EAA0D,UAACpjD,KAAD,EAAsB;CAC/E,mCAA+CA,KAAK,CAACC,aAAN,EAA/C;CAAA;CAAA,YAAOojD,UAAP;CAAA,YAAmBC,YAAnB;CAAA,YAAiCC,UAAjC;;CACA,QAAA,MAAI,CAACC,WAAL,CAAiBH,UAAjB,EAA6BC,YAA7B,EAA2CC,UAA3C;CACA,OAHD;CAIA;CAvHF;CAAA;CAAA,qCAyHkBh6C,SAzHlB,EA0HC;CAAA;;CACC,UAAMgzC,eAAe,GAAG,IAAIvX,eAAJ,CAAoB;CAC3C57B,QAAAA,OAAO,EAAE,KAAKA,OAD6B;CAE3CjJ,QAAAA,SAAS,EAAE,KAAKA,SAF2B;CAG3C0H,QAAAA,KAAK,EAAE,KAAKA;CAH+B,OAApB,CAAxB;CAKA00C,MAAAA,eAAe,CAACE,kBAAhB;CAEAF,MAAAA,eAAe,CAACx8C,SAAhB,CAA0B,UAA1B,EAAsC,UAAC28C,cAAD,EAA+B;CACpE,QAAA,MAAI,CAACv8C,SAAL,CAAe46C,kBAAf,CAAkC,MAAI,CAAC4B,aAAL,GAAqBrvC,OAArB,CAA6B,WAA7B,EAA0CovC,cAAc,CAACvlC,OAAf,EAA1C,CAAlC;CACA,OAFD;CAGA;CAED;CACD;CACA;CACA;CACA;CACA;CACA;;CA7IA;CAAA;CAAA,gCA8IaksC,UA9Ib,EA8IyBC,YA9IzB,EA8IuCC,UA9IvC,EA+IC;CAEC;CACA;CAlJF;CAAA;CAAA,EAAkC36C,IAAlC;;;KClBa66C,cAAb;CAAA;;CAEC,4BACA;CAAA;;CAAA;CACC;;CAEA,UAAKhkD,iBAAL,CAAuB,+BAAvB;;CAHD;CAIC;;CAPF;CAAA;CAAA,6BAUC;CACC,UAAMwG,IAAI,GAAGiC,aAAG,CAACC,MAAP,wPAGLxE,aAAG,CAACC,UAAJ,CAAe,kCAAf,CAHK,CAAV;CAQA6E,MAAAA,eAAK,CAAChE,IAAN,CAAWwB,IAAX,EAAiB,OAAjB,EAA0B,KAAK8G,OAAL,CAAatI,IAAb,CAAkB,IAAlB,CAA1B;CAEA,aAAOwB,IAAP;CACA;CAtBF;CAAA;CAAA,8BAyBC;CACC,WAAK3F,IAAL,CAAU,OAAV;CACA;CA3BF;CAAA;CAAA,EAAoCR,6BAApC;;KCkBa4jD,eAAb;CAAA;;CAEC,2BAAYtiD,MAAZ,EACA;CAAA;;CAAA;CACC,iHAAMA,MAAN;;CAEA,UAAK3B,iBAAL,CAAuB,gCAAvB;;CAEA,UAAK4iD,SAAL,CAAejhD,MAAf;;CAEA,UAAKgD,YAAL;;CAPD;CAQC;;CAXF;CAAA;CAAA,0CAauBqF,SAbvB,EAcC;CACC,yHAA4BA,SAA5B;;CAEA,UAAI,KAAK4rC,eAAL,KAAyB,IAA7B,EACA;CACC;CACA;;CAED,UAAMsO,cAAc,GAAG,IAAIF,cAAJ,EAAvB;CACAE,MAAAA,cAAc,CAAC5jD,SAAf,CAAyB,OAAzB,EAAkC,KAAKu6C,yBAAL,CAA+B71C,IAA/B,CAAoC,IAApC,CAAlC;CAEA2B,MAAAA,aAAG,CAACgI,QAAJ,CAAa3E,SAAb,EAAwB,cAAxB;CAEArD,MAAAA,aAAG,CAACyD,MAAJ,CAAW85C,cAAc,CAACx7C,MAAf,EAAX,EAAoCsB,SAApC;CACA;CA5BF;CAAA;CAAA,8BA8BWrI,MA9BX,EA+BC;CAAA;;CACC,UAAI6B,cAAI,CAACkM,OAAL,CAAa/N,MAAM,CAACi0C,eAApB,CAAJ,EACA;CACC,aAAKA,eAAL,GAAuB,IAAvB;CACA,OAHD,MAKA;CACC,aAAKA,eAAL,GAAuB,IAAI3f,MAAJ,CAAWt0B,MAAM,CAACi0C,eAAlB,CAAvB;CACA;;CAED,WAAKl1C,SAAL,GAAiB,IAAIX,SAAJ,EAAjB;CAEA,WAAKw5B,OAAL,GAAe,IAAIjwB,GAAJ,EAAf;CACA3H,MAAAA,MAAM,CAAC43B,OAAP,CAAezwB,OAAf,CAAuB,UAACo0B,UAAD,EAAgB;CACtC,YAAM/O,MAAM,GAAG8H,MAAM,CAACkH,WAAP,CAAmBD,UAAnB,CAAf;;CACA,QAAA,MAAI,CAAC3D,OAAL,CAAa7lB,GAAb,CAAiBya,MAAM,CAACxa,KAAP,EAAjB,EAAiCwa,MAAjC;CACA,OAHD;CAIA,WAAK/lB,KAAL,GAAazG,MAAM,CAACyG,KAApB;CAEA,WAAKo9B,cAAL,GAAsB7jC,MAAM,CAAC6jC,cAA7B;CACA;CAnDF;CAAA;CAAA,mCAsDC;CACCnlC,MAAAA,6BAAY,CAACC,SAAb,CAAuB,4BAAvB,EAAqD,KAAK6jD,sBAAL,CAA4Bn/C,IAA5B,CAAiC,IAAjC,CAArD;CACA;CAxDF;CAAA;CAAA,2CA0DwBzE,KA1DxB,EA2DC;CACC,iCAAwBA,KAAK,CAACC,aAAN,EAAxB;CAAA;CAAA,UAAO4jD,aAAP;;CAEA,WAAKxO,eAAL,GAAuB,KAAKyO,oBAAL,CAA0BD,aAAa,CAACl0B,QAAxC,CAAvB;CACA;CA/DF;CAAA;CAAA,8CAiE2BpmB,SAjE3B,EAkEC;CACC,UAAMgzC,eAAe,GAAG,IAAIvX,eAAJ,CAAoB;CAC3C57B,QAAAA,OAAO,EAAE,KAAKA,OAD6B;CAE3CjJ,QAAAA,SAAS,EAAE,KAAKA,SAF2B;CAG3C0H,QAAAA,KAAK,EAAE,KAAKA,KAH+B;CAI3Co9B,QAAAA,cAAc,EAAE,KAAKA;CAJsB,OAApB,CAAxB;CAMAsX,MAAAA,eAAe,CAACS,iBAAhB,CAAkC,KAAK3H,eAAvC;CACA;CA1EF;CAAA;CAAA,yCA4EsB1lB,QA5EtB,EA6EC;CACC,aAAO,+BAAI,KAAKqJ,OAAL,CAAah0B,MAAb,EAAJ,EAA2BY,IAA3B,CAAgC,UAACgoB,MAAD;CAAA,eAAYA,MAAM,CAACxa,KAAP,OAAmBjK,QAAQ,CAACwmB,QAAD,EAAW,EAAX,CAAvC;CAAA,OAAhC,CAAP;CACA;CA/EF;CAAA;CAAA,EAAqC/mB,IAArC;;KCPam7C,KAAb;CAEC,iBAAY3iD,MAAZ,EACA;CAAA;CACC,SAAKihD,SAAL,CAAejhD,MAAf;CAEA,SAAK4iD,SAAL,CAAe5iD,MAAf;CACA;;CAPF;CAAA;CAAA,8BASWA,MATX,EAUC;CACC,WAAK6iD,WAAL,CAAiB7iD,MAAM,CAAC8iD,QAAxB;CAEA32B,MAAAA,OAAO,CAACwB,WAAR,GAAsBmkB,OAAtB,CAA8B9xC,MAAM,CAAC+iD,OAArC;CACA;CAdF;CAAA;CAAA,gCAgBaD,QAhBb,EAiBC;CACC,UAAME,cAAc,GAAG,IAAIr6C,GAAJ,CAAQ,CAC9B,MAD8B,EAE9B,cAF8B,EAG9B,iBAH8B,CAAR,CAAvB;;CAMA,UAAI,CAACq6C,cAAc,CAACp6C,GAAf,CAAmBk6C,QAAnB,CAAL,EACA;CACC,cAAMv6C,KAAK,CAAC,uCAAD,CAAX;CACA;;CAED,WAAKu6C,QAAL,GAAgBA,QAAhB;CACA;CA9BF;CAAA;CAAA,kCAiCC;CACC,aAAO,KAAKA,QAAZ;CACA;CAnCF;CAAA;CAAA,4BAqCS/V,IArCT,EAsCC;CACC,UAAIA,IAAI,YAAYvlC,IAApB,EACA;CACC,aAAKulC,IAAL,GAAYA,IAAZ;CACA,OAHD,MAKA;CACC,aAAKA,IAAL,GAAY,IAAZ;CACA;CACD;CA/CF;CAAA;CAAA,8BAkDC;CACC,aAAO,KAAKA,IAAZ;CACA;CApDF;CAAA;CAAA,8BAsDW/sC,MAtDX,EAuDC;CACC,UAAM8iD,QAAQ,GAAG,KAAKG,WAAL,EAAjB;;CAEA,UAAIH,QAAQ,KAAK,MAAjB,EACA;CACC,aAAKI,OAAL,CAAa,IAAI1N,IAAJ,CAASx1C,MAAT,CAAb;CACA,OAHD,MAIK,IAAI8iD,QAAQ,KAAK,cAAjB,EACL;CACC,aAAKI,OAAL,CAAa,IAAIlC,YAAJ,CAAiBhhD,MAAjB,CAAb;CACA,OAHI,MAIA,IAAI8iD,QAAQ,KAAK,iBAAjB,EACL;CACC,aAAKI,OAAL,CAAa,IAAIZ,eAAJ,CAAoBtiD,MAApB,CAAb;CACA;CACD;CAtEF;CAAA;CAAA,6BAwEUqI,SAxEV,EAyEC;CACC,UAAM0kC,IAAI,GAAG,KAAKoW,OAAL,EAAb;;CACA,UAAIpW,IAAI,YAAYvlC,IAApB,EACA;CACC,aAAK27C,OAAL,GAAehM,QAAf,CAAwB9uC,SAAxB;CACA;CACD;CA/EF;CAAA;CAAA,iCAiFcA,SAjFd,EAkFC;CACC,UAAM0kC,IAAI,GAAG,KAAKoW,OAAL,EAAb;;CACA,UAAIpW,IAAI,YAAYvlC,IAApB,EACA;CACC,aAAK27C,OAAL,GAAeC,YAAf,CAA4B/6C,SAA5B;CACA;CACD;CAxFF;CAAA;CAAA,wCA0FqBA,SA1FrB,EA2FC;CACC,UAAM0kC,IAAI,GAAG,KAAKoW,OAAL,EAAb;;CACA,UAAIpW,IAAI,YAAYvlC,IAApB,EACA;CACC,aAAK27C,OAAL,GAAeE,mBAAf,CAAmCh7C,SAAnC;CACA;CACD;CAjGF;CAAA;CAAA,0CAmGuBA,SAnGvB,EAoGC;CACC,UAAM0kC,IAAI,GAAG,KAAKoW,OAAL,EAAb;;CACA,UAAIpW,IAAI,YAAYvlC,IAApB,EACA;CACC,aAAK27C,OAAL,GAAeG,qBAAf,CAAqCj7C,SAArC;CACA;CACD;CA1GF;CAAA;CAAA,uCA4GoBmgC,QA5GpB,EA4G2CtjC,KA5G3C,EA6GC;CACC,UAAI,CAACF,aAAG,CAAC4U,QAAJ,CAAa4uB,QAAb,EAAuB,wBAAvB,CAAL,EACA;CACC,aAAK+a,YAAL,CAAkB/a,QAAlB;CAEA,YAAMuE,IAAI,GAAG,KAAKoW,OAAL,EAAb;;CACA,YAAIpW,IAAI,YAAYvlC,IAApB,EACA;CACC,eAAK27C,OAAL,GAAeK,kBAAf,CAAkCt+C,KAAlC;CACA;CACD;CACD;CAxHF;CAAA;CAAA,iCA0HcjB,IA1Hd,EA2HC;CACCA,MAAAA,IAAI,CAACs5B,aAAL,CAAmBkmB,UAAnB,CAA8Bt8C,OAA9B,CAAsC,UAACxB,OAAD,EAAa;CAClDX,QAAAA,aAAG,CAACiI,WAAJ,CAAgBtH,OAAhB,EAAyB,wBAAzB;CACA,OAFD;CAIAX,MAAAA,aAAG,CAACgI,QAAJ,CAAa/I,IAAb,EAAmB,wBAAnB;CACA;CAjIF;CAAA;CAAA;;;;;;;;"}