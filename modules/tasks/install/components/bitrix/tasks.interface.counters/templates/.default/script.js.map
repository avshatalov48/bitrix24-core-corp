{"version":3,"file":"script.js","sources":["src/counters-helper.js","src/counters-item.js","src/entry.js"],"sourcesContent":["import {Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nclass Filter\n{\n\tconstructor(options)\n\t{\n\t\tthis.filterId = options.filterId;\n\t\tthis.filterManager = BX.Main.filterManager.getById(this.filterId);\n\n\t\tthis.bindEvents();\n\t\tthis.updateFields();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t}\n\n\tonFilterApply()\n\t{\n\t\tthis.updateFields();\n\t}\n\n\tupdateFields()\n\t{\n\t\tthis.fields = this.filterManager.getFilterFieldsValues();\n\t}\n\n\tisFilteredByField(field)\n\t{\n\t\tif (!Object.keys(this.fields).includes(field))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Type.isArray(this.fields[field]))\n\t\t{\n\t\t\treturn this.fields[field].length > 0;\n\t\t}\n\n\t\treturn this.fields[field] !== '';\n\t}\n\n\tisFilteredByFieldValue(field, value)\n\t{\n\t\treturn this.isFilteredByField(field) && this.fields[field] === value;\n\t}\n\n\ttoggleByField(field)\n\t{\n\t\tconst name = Object.keys(field)[0];\n\t\tconst value = field[name];\n\n\t\tif (!this.isFilteredByFieldValue(name, value))\n\t\t{\n\t\t\tthis.filterManager.getApi().extendFilter(\n\t\t\t\t{[name]: value},\n\t\t\t\tfalse,\n\t\t\t\t{COUNTER_TYPE: 'TASKS_COUNTER_TYPE_' + value}\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.filterManager.getFilterFields().forEach((field) => {\n\t\t\tif (field.getAttribute('data-name') === name)\n\t\t\t{\n\t\t\t\tthis.filterManager.getFields().deleteField(field);\n\t\t\t}\n\t\t});\n\n\t\tthis.filterManager.getSearch().apply();\n\t}\n\n\tgetFilter()\n\t{\n\t\treturn this.filterManager;\n\t}\n}\n\nexport {\n\tFilter\n}","import { Tag, Event, Type, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport default class CountersItem\n{\n\tconstructor(options)\n\t{\n\t\tthis.count = options.count;\n\t\tthis.name = options.name;\n\t\tthis.type = options.type;\n\t\tthis.color = options.color;\n\t\tthis.filterField = options.filterField;\n\t\tthis.filterValue = options.filterValue;\n\t\tthis.filter = options.filter;\n\n\t\tthis.$container = null;\n\t\tthis.$remove = null;\n\t\tthis.$counter = null;\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Tasks.Counters:active', (param)=> {\n\t\t\tthis !== param.data ? this.unActive() : null;\n\t\t});\n\t}\n\n\tgetCounter()\n\t{\n\t\tif(!this.$counter)\n\t\t{\n\t\t\tconst count = this.count > 99 ? '99+' : this.count;\n\t\t\tthis.$counter = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-num ${this.getCounterColor()}\">\n\t\t\t\t\t<div class=\"tasks-counters--item-counter-num-text --stop --without-animate\">${count}</div>\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$counter;\n\t}\n\n\tgetCounterColor()\n\t{\n\t\tif (!this.color)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn `--${this.color}`;\n\t}\n\n\tanimateCounter(start, value)\n\t{\n\t\tif(start > 99 && value > 99)\n\t\t\treturn;\n\n\t\tvalue > 99\n\t\t\t? value = 99\n\t\t\t: null;\n\n\t\tif(start > 99)\n\t\t\tstart = 99;\n\n\t\tlet duration = start - value;\n\t\tif(duration < 0)\n\t\t\tduration = duration * -1;\n\n\t\tthis.$counter.innerHTML = '';\n\t\tthis.getCounter().classList.remove('--update');\n\t\tthis.getCounter().classList.remove('--update-multi');\n\n\t\tif(duration > 5)\n\t\t{\n\t\t\tsetTimeout(()=> {\n\t\t\t\tthis.getCounter().style.animationDuration = (duration * 50) + 'ms';\n\t\t\t\tthis.getCounter().classList.add('--update-multi');\n\t\t\t});\n\t\t}\n\t\tconst timer = setInterval(()=> {\n\t\t\tvalue < start\n\t\t\t\t? start--\n\t\t\t\t: start++;\n\n\t\t\tconst node = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-num-text ${value < start ? '--decrement' : ''}\">${start}</div>\n\t\t\t`;\n\n\t\t\tif(start === value)\n\t\t\t{\n\t\t\t\tnode.classList.add('--stop');\n\n\t\t\t\tif(duration < 5)\n\t\t\t\t\tthis.getCounter().classList.add('--update');\n\n\t\t\t\tclearInterval(timer);\n\t\t\t\tstart === 0 ? this.fade() : this.unFade();\n\t\t\t}\n\n\t\t\tif(start !== value)\n\t\t\t{\n\t\t\t\tEvent.bind(node, 'animationend', ()=> {\n\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.$counter.appendChild(node);\n\t\t}, 50);\n\t}\n\n\tupdateCount(param: number)\n\t{\n\t\tif(this.count === param)\n\t\t\treturn;\n\n\t\tthis.animateCounter(this.count, param);\n\n\t\tthis.count = param;\n\t}\n\n\tgetRemove()\n\t{\n\t\tif(!this.$remove)\n\t\t{\n\t\t\tthis.$remove = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-remove\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$remove;\n\t}\n\n\tfade()\n\t{\n\t\tthis.getContainer().classList.add('--fade');\n\t}\n\n\tunFade()\n\t{\n\t\tthis.getContainer().classList.remove('--fade');\n\t}\n\n\tactive(node: HTMLElement)\n\t{\n\t\tconst targetNode = Type.isDomNode(node) ? node : this.getContainer();\n\t\ttargetNode.classList.add('--hover');\n\t\tEventEmitter.emit('BX.Tasks.Counters:active', this);\n\t}\n\n\tunActive(node: HTMLElement)\n\t{\n\t\tconst targetNode = Type.isDomNode(node) ? node : this.getContainer();\n\t\ttargetNode.classList.remove('--hover');\n\t\tEventEmitter.emit('BX.Tasks.Counters:unActive', this);\n\t}\n\n\tadjustClick()\n\t{\n\t\tEventEmitter.emit('Tasks.Toolbar:onItem', {counter: this});\n\n\t\tthis.$container.classList.contains('--hover')\n\t\t\t? this.unActive()\n\t\t\t: this.active()\n\t\t;\n\t}\n\n\tgetPopupMenuItemContainer()\n\t{\n\t\tconst title = Loc.getMessage('TASKS_COUNTER_OTHER_TASKS').replace('#TITLE#', this.name.toLowerCase());\n\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"task-counters--popup-item\">\n\t\t\t\t\t<span class=\"tasks-counters--item-counter-num ${this.getCounterColor()}\">${this.count}</span>\n\t\t\t\t\t<span class=\"task-counters--popup-item-text\">${title}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetContainer(param): HTMLElement\n\t{\n\t\tif(!this.$container)\n\t\t{\n\t\t\tthis.$container = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter ${Number(this.count) === 0 ? ' --fade' : ''}\">\n\t\t\t\t\t<div class=\"tasks-counters--item-counter-wrapper\">\n\t\t\t\t\t\t${this.getCounter()}\n\t\t\t\t\t\t<div class=\"tasks-counters--item-counter-title\">${this.name}</div>\n\t\t\t\t\t\t${this.getRemove()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (this.filter.isFilteredByFieldValue(this.filterField, this.filterValue))\n\t\t\t{\n\t\t\t\tthis.active(this.$container);\n\t\t\t}\n\n\t\t\tEvent.bind(this.$container, 'click', this.adjustClick.bind(this));\n\t\t}\n\n\t\treturn this.$container;\n\t}\n}","import {Tag, Event, Loc, ajax as Ajax, Dom} from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Menu, MenuItem } from 'main.popup';\nimport { Filter } from './counters-helper';\nimport CountersItem from './counters-item';\n\nimport './style.css'\n\nexport class Counters\n{\n\tstatic get counterTypes()\n\t{\n\t\treturn {\n\t\t\tmy: [\n\t\t\t\t'expired',\n\t\t\t\t'my_expired',\n\t\t\t\t'originator_expired',\n\t\t\t\t'accomplices_expired',\n\t\t\t\t'auditor_expired',\n\t\t\t\t'new_comments',\n\t\t\t\t'my_new_comments',\n\t\t\t\t'originator_new_comments',\n\t\t\t\t'accomplices_new_comments',\n\t\t\t\t'auditor_new_comments',\n\t\t\t\t'projects_total_expired',\n\t\t\t\t'projects_total_comments',\n\t\t\t\t'sonet_total_expired',\n\t\t\t\t'sonet_total_comments',\n\t\t\t\t'groups_total_expired',\n\t\t\t\t'groups_total_comments',\n\t\t\t\t'scrum_total_comments'\n\t\t\t],\n\t\t\tother: [\n\t\t\t\t'project_expired',\n\t\t\t\t'project_comments',\n\t\t\t\t'projects_foreign_expired',\n\t\t\t\t'projects_foreign_comments',\n\t\t\t\t'groups_foreign_expired',\n\t\t\t\t'groups_foreign_comments',\n\t\t\t\t'sonet_foreign_expired',\n\t\t\t\t'sonet_foreign_comments',\n\t\t\t\t'scrum_foreign_comments'\n\t\t\t],\n\t\t\tadditional: [\n\t\t\t\t'muted_new_comments',\n\t\t\t],\n\t\t\texpired: [\n\t\t\t\t'expired',\n\t\t\t\t'my_expired',\n\t\t\t\t'originator_expired',\n\t\t\t\t'accomplices_expired',\n\t\t\t\t'auditor_expired',\n\t\t\t\t'project_expired',\n\t\t\t\t'projects_total_expired',\n\t\t\t\t'projects_foreign_expired',\n\t\t\t\t'groups_total_expired',\n\t\t\t\t'groups_foreign_expired',\n\t\t\t\t'sonet_total_expired',\n\t\t\t\t'sonet_foreign_expired',\n\t\t\t],\n\t\t\tcomment: [\n\t\t\t\t'new_comments',\n\t\t\t\t'my_new_comments',\n\t\t\t\t'originator_new_comments',\n\t\t\t\t'accomplices_new_comments',\n\t\t\t\t'auditor_new_comments',\n\t\t\t\t'muted_new_comments',\n\t\t\t\t'project_comments',\n\t\t\t\t'projects_total_comments',\n\t\t\t\t'projects_foreign_comments',\n\t\t\t\t'groups_total_comments',\n\t\t\t\t'groups_foreign_comments',\n\t\t\t\t'sonet_total_comments',\n\t\t\t\t'sonet_foreign_comments',\n\t\t\t\t'scrum_total_comments',\n\t\t\t\t'scrum_foreign_comments'\n\t\t\t],\n\t\t};\n\t}\n\n\tstatic updateTimeout = false;\n\tstatic needUpdate = false;\n\n\tstatic timeoutTTL = 5000;\n\n\tconstructor(options)\n\t{\n\t\tthis.userId = options.userId;\n\t\tthis.targetUserId = options.targetUserId;\n\t\tthis.groupId = options.groupId;\n\t\tthis.counters = options.counters;\n\t\tthis.initialCounterTypes = options.counterTypes;\n\t\tthis.renderTo = options.renderTo;\n\t\tthis.role = options.role;\n\t\tthis.signedParameters = options.signedParameters;\n\n\t\tthis.popupMenu = null;\n\n\t\tthis.$readAll = {\n\t\t\tcropped: null,\n\t\t\tlayout: null\n\t\t};\n\t\tthis.$more = null;\n\t\tthis.$moreArrow = null;\n\t\tthis.$other = {\n\t\t\tcropped: null,\n\t\t\tlayout: null\n\t\t};\n\t\tthis.$myTaskHead = null;\n\n\t\tthis.filter = new Filter({filterId: options.filterId});\n\n\t\tthis.bindEvents();\n\t\tthis.setData(this.counters);\n\n\t\tthis.initPull();\n\t}\n\n\tisMyTaskList()\n\t{\n\t\treturn this.userId === this.targetUserId;\n\t}\n\n\tisUserTaskList()\n\t{\n\t\treturn (Object.keys(this.otherCounters).length === 0);\n\t}\n\n\tisProjectsTaskList()\n\t{\n\t\treturn this.groupId > 0;\n\t}\n\n\tisProjectList()\n\t{\n\t\treturn !this.isUserTaskList() && !this.isProjectsTaskList();\n\t}\n\n\tinitPull()\n\t{\n\t\tBX.PULL.subscribe({\n\t\t\tmoduleId: 'tasks',\n\t\t\tcallback: data => this.processPullEvent(data),\n\t\t});\n\n\t\tthis.extendWatch();\n\t}\n\n\textendWatch()\n\t{\n\t\tif (this.isProjectsTaskList() || this.isProjectList())\n\t\t{\n\t\t\tlet tagId = 'TASKS_PROJECTS';\n\n\t\t\tif (this.isProjectsTaskList())\n\t\t\t{\n\t\t\t\ttagId = `TASKS_PROJECTS_${this.groupId}`;\n\t\t\t}\n\n\t\t\tBX.PULL.extendWatch(tagId, true);\n\t\t\tsetTimeout(() => this.extendWatch(), 29 * 60 * 1000);\n\t\t}\n\t}\n\n\tprocessPullEvent(data)\n\t{\n\t\tconst eventHandlers = {\n\t\t\tuser_counter: this.onUserCounter.bind(this),\n\t\t\tproject_counter: this.onProjectCounter.bind(this),\n\t\t};\n\t\tconst has = Object.prototype.hasOwnProperty;\n\t\tconst {command, params} = data;\n\t\tif (has.call(eventHandlers, command))\n\t\t{\n\t\t\tconst method = eventHandlers[command];\n\t\t\tif (method)\n\t\t\t{\n\t\t\t\tmethod.apply(this, [params]);\n\t\t\t}\n\t\t}\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApply.bind(this));\n\t}\n\n\tonFilterApply()\n\t{\n\t\tthis.filter.updateFields();\n\n\t\tif (this.isRoleChanged())\n\t\t{\n\t\t\tthis.updateRole();\n\t\t\tthis.updateCountersData();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst counters = {...this.myCounters, ...this.otherCounters};\n\t\t\tObject.values(counters).forEach((counter) => {\n\t\t\t\tif (counter)\n\t\t\t\t{\n\t\t\t\t\tthis.filter.isFilteredByFieldValue(counter.filterField, counter.filterValue)\n\t\t\t\t\t\t? counter.active()\n\t\t\t\t\t\t: counter.unActive()\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tupdateCountersData()\n\t{\n\t\tif (Counters.updateTimeout)\n\t\t{\n\t\t\tCounters.needUpdate = true;\n\t\t\treturn;\n\t\t}\n\n\t\tCounters.updateTimeout = true;\n\t\tCounters.needUpdate = false;\n\n\t\tAjax.runComponentAction('bitrix:tasks.interface.counters', 'getCounters', {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\trole: this.role,\n\t\t\t\tcounters: this.initialCounterTypes,\n\t\t\t},\n\t\t\tsignedParameters: this.signedParameters,\n\t\t}).then(\n\t\t\tresponse => this.rerender(response.data),\n\t\t\tresponse => console.log(response)\n\t\t);\n\n\t\tsetTimeout(function() {\n\t\t\tCounters.updateTimeout = false;\n\t\t\tif (Counters.needUpdate)\n\t\t\t{\n\t\t\t\tthis.updateCountersData();\n\t\t\t}\n\t\t}.bind(this), Counters.timeoutTTL);\n\t}\n\n\tisRoleChanged()\n\t{\n\t\treturn this.role !== (this.filter.isFilteredByField('ROLEID') ? this.filter.fields.ROLEID : 'view_all');\n\t}\n\n\tupdateRole()\n\t{\n\t\tthis.role = (this.filter.isFilteredByField('ROLEID') ? this.filter.fields.ROLEID : 'view_all');\n\t}\n\n\tonUserCounter(data)\n\t{\n\t\tconst has = Object.prototype.hasOwnProperty;\n\t\tif (\n\t\t\t!this.isUserTaskList()\n\t\t\t|| !this.isMyTaskList()\n\t\t\t|| !has.call(data, this.groupId)\n\t\t\t|| this.userId !== Number(data.userId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet newCommentsCount = 0;\n\n\t\tObject.entries(data[this.groupId][this.role]).forEach(([type, value]) => {\n\t\t\tif (this.myCounters[type])\n\t\t\t{\n\t\t\t\tthis.myCounters[type].updateCount(value);\n\n\t\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t\t{\n\t\t\t\t\tnewCommentsCount += value;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.additionalCounters[type] && Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tnewCommentsCount += value;\n\t\t\t}\n\t\t});\n\n\t\tif (newCommentsCount > 0)\n\t\t{\n\t\t\tthis.$readAllInner.classList.remove('--fade');\n\t\t}\n\t}\n\n\tonProjectCounter(data)\n\t{\n\t\tif (this.isUserTaskList())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateCountersData();\n\t}\n\n\tgetCounterItem(param: Object): Object\n\t{\n\t\treturn new CountersItem({\n\t\t\tcount: param.count,\n\t\t\tname: param.name,\n\t\t\ttype: param.type,\n\t\t\tcolor: param.color,\n\t\t\tfilterField: param.filterField,\n\t\t\tfilterValue: param.filterValue,\n\t\t\tfilter: this.filter,\n\t\t});\n\t}\n\n\tgetCounterNameByType(type: String)\n\t{\n\t\tif (Counters.counterTypes.expired.includes(type))\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_COUNTER_EXPIRED');\n\t\t}\n\t\telse if (Counters.counterTypes.comment.includes(type))\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_COUNTER_NEW_COMMENTS');\n\t\t}\n\t}\n\n\tsetData(counters)\n\t{\n\t\tthis.myCounters = {};\n\t\tthis.otherCounters = {};\n\t\tthis.additionalCounters = {};\n\n\t\tconst availableTypes = [\n\t\t\t...Counters.counterTypes.additional,\n\t\t\t...Counters.counterTypes.my,\n\t\t\t...Counters.counterTypes.other\n\t\t];\n\n\t\tObject.entries(counters).forEach(([type, data]) => {\n\t\t\tif (!availableTypes.includes(type))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst counterItem = this.getCounterItem({\n\t\t\t\ttype,\n\t\t\t\tname: this.getCounterNameByType(type),\n\t\t\t\tcount: Number(data.VALUE),\n\t\t\t\tcolor: data.STYLE,\n\t\t\t\tfilterField: data.FILTER_FIELD,\n\t\t\t\tfilterValue: data.FILTER_VALUE,\n\t\t\t});\n\n\t\t\tif (Counters.counterTypes.additional.includes(type))\n\t\t\t{\n\t\t\t\tthis.additionalCounters[type] = counterItem;\n\t\t\t}\n\t\t\telse if (Counters.counterTypes.my.includes(type))\n\t\t\t{\n\t\t\t\tthis.myCounters[type] = counterItem;\n\t\t\t}\n\t\t\telse if (Counters.counterTypes.other.includes(type))\n\t\t\t{\n\t\t\t\tthis.otherCounters[type] = counterItem;\n\t\t\t}\n\t\t});\n\t}\n\n\tisCroppedBlock(node: HTMLElement)\n\t{\n\t\tif(node)\n\t\t\treturn node.classList.contains('--cropp');\n\t}\n\n\tgetReadAllBlock(): HTMLElement\n\t{\n\t\tconst counters = {...this.myCounters, ...this.otherCounters, ...this.additionalCounters};\n\t\tlet newCommentsCount = 0;\n\n\t\tObject.entries(counters).forEach(([type, counter]) => {\n\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tnewCommentsCount += counter.count;\n\t\t\t}\n\t\t});\n\n\t\tthis.$readAllInner = Tag.render`\n\t\t\t<div data-role=\"tasks-counters--item-head-read-all\" class=\"tasks-counters--item-head\n\t\t\t\t\t\t${newCommentsCount === 0 ? '--fade' : ''} \n\t\t\t\t\t\t--action \n\t\t\t\t\t\t--read-all\">\n\t\t\t\t<div class=\"tasks-counters--item-head-read-all--icon\"></div>\n\t\t\t\t<div class=\"tasks-counters--item-head-read-all--text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_COUNTER_READ_ALL')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tlet readAllClick = this.readAllForProjects.bind(this);\n\t\tif (\n\t\t\tthis.isUserTaskList()\n\t\t\t|| (this.isProjectsTaskList() && this.role !== 'view_all')\n\t\t)\n\t\t{\n\t\t\treadAllClick = this.readAllByRole.bind(this);\n\t\t}\n\t\telse if (\n\t\t\tthis.myCounters['scrum_total_comments']\n\t\t\t|| this.otherCounters['scrum_foreign_comments']\n\t\t)\n\t\t{\n\t\t\treadAllClick = this.readAllForScrum.bind(this);\n\t\t}\n\n\t\tEvent.bind(this.$readAllInner, 'click', readAllClick);\n\t\tEvent.bind(this.$readAllInner, 'click', () => this.$readAllInner.classList.add('--fade'));\n\n\t\tthis.$readAll.layout = Tag.render`\n\t\t\t<div class=\"tasks-counters--item\">${this.$readAllInner}</div>\n\t\t`;\n\n\t\treturn this.$readAll.layout;\n\t}\n\n\treadAllByRole()\n\t{\n\t\tAjax.runAction('tasks.task.comment.readAll', {\n\t\t\tdata: {\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\tuserId: this.userId,\n\t\t\t\trole: this.role,\n\t\t\t},\n\t\t});\n\t}\n\n\treadAllForProjects()\n\t{\n\t\tconst allCounters = {...this.myCounters, ...this.otherCounters};\n\t\tObject.entries(allCounters).forEach(([type, counter]) => {\n\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tcounter.updateCount(0);\n\t\t\t}\n\t\t});\n\n\t\tAjax.runAction('tasks.task.comment.readProject', {\n\t\t\tdata: {\n\t\t\t\tgroupId: this.groupId,\n\t\t\t},\n\t\t});\n\t}\n\n\treadAllForScrum()\n\t{\n\t\tconst allCounters = {...this.myCounters, ...this.otherCounters};\n\t\tObject.entries(allCounters).forEach(([type, counter]) => {\n\t\t\tif (Counters.counterTypes.comment.includes(type))\n\t\t\t{\n\t\t\t\tcounter.updateCount(0);\n\t\t\t}\n\t\t});\n\n\t\tAjax.runAction('tasks.task.comment.readScrum', {\n\t\t\tdata: {\n\t\t\t\tgroupId: this.groupId,\n\t\t\t},\n\t\t});\n\t}\n\n\tgetPopup()\n\t{\n\t\tconst itemsNode = [];\n\n\t\tObject.values(this.otherCounters).forEach((counter) => {\n\t\t\tconst menuItem = new MenuItem({\n\t\t\t\thtml: counter.getPopupMenuItemContainer().innerHTML,\n\t\t\t});\n\t\t\tmenuItem.onclick = this.onPopupItemClick.bind(this, menuItem, counter);\n\n\t\t\titemsNode.push(menuItem);\n\t\t});\n\n\t\tthis.popupMenu = new Menu({\n\t\t\tbindElement: this.$moreArrow,\n\t\t\tclassName: 'tasks-counters--scope',\n\t\t\tangle: {\n\t\t\t\toffset: 96,\n\t\t\t},\n\t\t\tautoHide: true,\n\t\t\tcloseEsc: true,\n\t\t\toffsetTop: 5,\n\t\t\toffsetLeft: -67,\n\t\t\tanimation: 'fading-slide',\n\t\t\titems: itemsNode,\n\t\t\tevents: {\n\t\t\t\tonPopupShow: () => this.$more.classList.add('--hover'),\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.$more.classList.remove('--hover');\n\t\t\t\t\tthis.popupMenu.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn this.popupMenu;\n\t}\n\n\tonPopupItemClick(item, counter)\n\t{\n\t\tcounter.adjustClick();\n\t\tthis.popupMenu.close();\n\t}\n\n\tgetMoreArrow()\n\t{\n\t\tif(!this.$moreArrow)\n\t\t{\n\t\t\tthis.$moreArrow = Tag.render`\n\t\t\t\t<div class=\"tasks-counters--item-counter-arrow\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$moreArrow;\n\t}\n\n\tgetMore()\n\t{\n\t\tlet value = 0;\n\n\t\tObject.values(this.otherCounters).forEach((counter) => {\n\t\t\tvalue += Number(counter.count);\n\t\t});\n\n\t\tconst count = value > 99\n\t\t\t? '99+'\n\t\t\t: value;\n\n\t\tthis.$moreArrow = Tag.render`\n\t\t\t<div class=\"tasks-counters--item-counter-arrow\"></div>\n\t\t`;\n\n\t\tthis.$more = Tag.render`\n\t\t\t<div class=\"tasks-counters--item-counter--more\">\n\t\t\t\t<div class=\"tasks-counters--item-counter-wrapper\">\n\t\t\t\t\t<div class=\"tasks-counters--item-counter-title\">${Loc.getMessage('TASKS_COUNTER_MORE')}:</div>\n\t\t\t\t\t<div class=\"tasks-counters--item-counter-num\">${count}</div>\n\t\t\t\t\t${this.$moreArrow}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.$more, 'click', ()=> this.getPopup().show());\n\n\t\treturn this.$more;\n\t}\n\n\tgetOther()\n\t{\n\t\tif (Object.keys(this.otherCounters).length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst content = [];\n\t\tObject.values(this.otherCounters).forEach(counter => content.push(counter.getContainer()));\n\n\t\tthis.$other.cropped = this.isCroppedBlock(this.$other.layout);\n\n\t\tthis.$other.layout = Tag.render`\n\t\t\t<div class=\"tasks-counters--item --other\" ${this.$other.cropped ? '--cropp' : ''}\">\n\t\t\t\t<div data-role=\"tasks-counters--item-head-other\" class=\"tasks-counters--item-head\">${Loc.getMessage('TASKS_COUNTER_OTHER')}</div>\n\t\t\t\t<div class=\"tasks-counters--item-content\">\n\t\t\t\t\t${content}\n\t\t\t\t\t${this.getMore()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.$other.layout;\n\t}\n\n\tgetContainer()\n\t{\n\t\tconst content = [];\n\t\tObject.values(this.myCounters).forEach(counter => content.push(counter.getContainer()));\n\n\t\tthis.$myTaskHead = Tag.render`\n\t\t\t<div class=\"tasks-counters--item-head\">\n\t\t\t\t${Loc.getMessage('TASKS_COUNTER_MY')}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.$element = Tag.render`\n\t\t\t<div class=\"tasks-counters tasks-counters--scope\">\n\t\t\t\t<div class=\"tasks-counters--item\">\n\t\t\t\t\t${this.$myTaskHead}\n\t\t\t\t\t<div class=\"tasks-counters--item-content\">${content}</div>\n\t\t\t\t</div>\n\t\t\t\t${this.getOther()}\n\t\t\t\t${this.isUserTaskList() && !this.isMyTaskList() ? '' : this.getReadAllBlock()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.$element;\n\t}\n\n\trerender(counters)\n\t{\n\t\tthis.setData(counters);\n\t\tthis.render();\n\t}\n\n\trender()\n\t{\n\t\tlet node = this.getContainer();\n\t\tlet fakeNode = node.cloneNode(true);\n\t\tfakeNode.classList.add('task-interface-toolbar');\n\t\tfakeNode.style.position = 'fixed';\n\t\tfakeNode.style.opacity = '0';\n\t\tfakeNode.style.width = 'auto';\n\t\tfakeNode.style.pointerEvents = 'none';\n\t\tdocument.body.appendChild(fakeNode);\n\t\tthis.nodeWidth = fakeNode.offsetWidth;\n\t\tdocument.body.removeChild(fakeNode);\n\n\t\tDom.replace(this.renderTo.firstChild, node);\n\t}\n}"],"names":["Filter","options","filterId","filterManager","BX","Main","getById","bindEvents","updateFields","EventEmitter","subscribe","onFilterApply","bind","fields","getFilterFieldsValues","field","Object","keys","includes","Type","isArray","length","value","isFilteredByField","name","isFilteredByFieldValue","getApi","extendFilter","COUNTER_TYPE","getFilterFields","forEach","getAttribute","getFields","deleteField","getSearch","apply","CountersItem","count","type","color","filterField","filterValue","filter","$container","$remove","$counter","param","data","unActive","Tag","render","getCounterColor","start","duration","innerHTML","getCounter","classList","remove","setTimeout","style","animationDuration","add","timer","setInterval","node","clearInterval","fade","unFade","Event","parentNode","removeChild","appendChild","animateCounter","getContainer","targetNode","isDomNode","emit","counter","contains","active","title","Loc","getMessage","replace","toLowerCase","Number","getRemove","adjustClick","Counters","my","other","additional","expired","comment","userId","targetUserId","groupId","counters","initialCounterTypes","counterTypes","renderTo","role","signedParameters","popupMenu","$readAll","cropped","layout","$more","$moreArrow","$other","$myTaskHead","setData","initPull","otherCounters","isUserTaskList","isProjectsTaskList","PULL","moduleId","callback","processPullEvent","extendWatch","isProjectList","tagId","eventHandlers","user_counter","onUserCounter","project_counter","onProjectCounter","has","prototype","hasOwnProperty","command","params","call","method","isRoleChanged","updateRole","updateCountersData","myCounters","values","updateTimeout","needUpdate","Ajax","runComponentAction","mode","then","response","rerender","console","log","timeoutTTL","ROLEID","isMyTaskList","newCommentsCount","entries","updateCount","additionalCounters","$readAllInner","availableTypes","counterItem","getCounterItem","getCounterNameByType","VALUE","STYLE","FILTER_FIELD","FILTER_VALUE","readAllClick","readAllForProjects","readAllByRole","readAllForScrum","runAction","allCounters","itemsNode","menuItem","MenuItem","html","getPopupMenuItemContainer","onclick","onPopupItemClick","push","Menu","bindElement","className","angle","offset","autoHide","closeEsc","offsetTop","offsetLeft","animation","items","events","onPopupShow","onPopupClose","destroy","item","close","getPopup","show","content","isCroppedBlock","getMore","$element","getOther","getReadAllBlock","fakeNode","cloneNode","position","opacity","width","pointerEvents","document","body","nodeWidth","offsetWidth","Dom","firstChild"],"mappings":"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"}