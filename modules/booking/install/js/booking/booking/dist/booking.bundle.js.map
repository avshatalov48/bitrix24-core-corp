{"version":3,"file":"booking.bundle.js","sources":["../src/lib/expand-off-hours/expand-off-hours.js","../src/components/filter/filter.js","../src/components/counters-panel/counters-panel.js","../src/components/after-title/statistics/statistics.js","../src/components/after-title/clients/clients.js","../src/components/after-title/profit/profit.js","../src/components/after-title/after-title.js","../src/lib/grid/grid.js","../src/components/grid/left-panel/off-hours/off-hours.js","../src/components/grid/left-panel/left-panel.js","../src/components/grid/now-line/now-line.js","../src/lib/busy-slots/busy-slots.js","../src/components/grid/bookings/booking/add-client/add-client.js","../src/components/grid/bookings/booking/booking-time/change-time-popup/change-time-popup.js","../src/components/grid/bookings/booking/booking-time/booking-time.js","../src/components/grid/bookings/booking/note/note-popup/note-popup.js","../src/components/grid/bookings/booking/actions/actions-popup/client/note/note.js","../src/components/grid/bookings/booking/actions/actions-popup/client/empty.js","../src/components/grid/bookings/booking/actions/actions-popup/client/edit-client-button/edit-client-button.js","../src/components/grid/bookings/booking/actions/actions-popup/client/client.js","../src/components/grid/bookings/booking/actions/actions-popup/deal/deal.js","../src/components/grid/bookings/booking/actions/actions-popup/document/document.js","../src/components/grid/bookings/booking/actions/actions-popup/message/message.js","../src/components/grid/bookings/booking/actions/actions-popup/confirmation/confirmation-menu/confirmation-menu.js","../src/components/grid/bookings/booking/actions/actions-popup/confirmation/confirmation.js","../src/components/grid/bookings/booking/actions/actions-popup/visit/visit-menu/visit-menu.js","../src/components/grid/bookings/booking/actions/actions-popup/visit/visit.js","../src/components/grid/bookings/booking/actions/actions-popup/full-form/full-form.js","../src/components/grid/bookings/booking/actions/actions-popup/overbooking/overbooking.js","../src/components/grid/bookings/booking/actions/actions-popup/waitlist/waitlist.js","../src/components/grid/bookings/booking/actions/actions-popup/remove-btn/remove-btn.js","../src/components/grid/bookings/booking/actions/actions-popup/actions-popup.js","../src/components/grid/bookings/booking/actions/actions.js","../src/components/grid/bookings/booking/note/note.js","../src/components/grid/bookings/booking/communication/communication.js","../src/components/grid/bookings/booking/disabled-popup/disabled-popup.js","../src/components/grid/bookings/booking/booking.js","../src/components/grid/bookings/busy-slot/busy-popup/busy-popup.js","../src/components/grid/bookings/busy-slot/busy-slot.js","../src/components/grid/base-cell/base-cell.js","../src/components/grid/bookings/cell/cell.js","../src/components/grid/bookings/bookings.js","../src/components/grid/column/cell/cell.js","../src/components/grid/column/off-hours/off-hours.js","../src/components/grid/column/column.js","../src/lib/maximize/maximize.js","../src/components/grid/scale-panel/scale-panel.js","../src/components/grid/sidebar/calendar/calendar.js","../src/components/grid/sidebar/sidebar.js","../src/components/grid/grid.js","../src/components/header/resource/resource-workload/battery-icon/battery-icon.js","../src/components/header/resource/resource-workload/workload-popup/workload-popup.js","../src/components/header/resource/resource-workload/resource-workload.js","../src/components/header/resource/resource-menu/resource-menu.js","../src/components/header/resource/resource.js","../src/components/header/add-resource-button/add-resource-button.js","../src/components/header/select-resources/dialog-header/content-header.js","../src/components/header/select-resources/dialog-header/resource-types/resource-types.js","../src/components/header/select-resources/dialog-header/resize/resize.js","../src/components/header/select-resources/dialog-header/search/search.js","../src/components/header/select-resources/dialog-header/dialog-header.js","../src/components/header/select-resources/dialog-footer/content-footer.js","../src/components/header/select-resources/dialog-footer/dialog-footer.js","../src/components/header/select-resources/select-resources.js","../src/components/header/header.js","../src/components/intersections/multiple/multiple.js","../src/components/intersections/single/single.js","../src/components/intersections/intersections.js","../src/components/base-component/base-component.js","../src/components/multi-booking/booking-multiple-button/booking-multiple-button.js","../src/components/multi-booking/multi-booking-items-list/multi-booking-item.js","../src/components/multi-booking/multi-booking-items-list/multi-booking-items-list.js","../src/components/multi-booking/add-client-button/add-client-button.js","../src/components/multi-booking/cancel-button/cancel-button.js","../src/components/multi-booking/multi-booking.js","../src/components/banner/banner.js","../src/components/trial/trial.js","../src/components/app.js","../src/booking.js"],"sourcesContent":["import { Dom } from 'main.core';\nimport { Core } from 'booking.core';\nimport { Model } from 'booking.const';\n\nconst cellHeight = 50;\nconst cellHeightProperty = '--booking-off-hours-cell-height';\nconst classCollapse = '--booking-booking-collapse';\nconst classExpand = '--booking-booking-expand';\n\nclass ExpandOffHours\n{\n\t#animation: BX.easing;\n\n\tget #container(): HTMLElement\n\t{\n\t\treturn Core.getParams().container;\n\t}\n\n\tget #content(): HTMLElement\n\t{\n\t\treturn BX('booking-content');\n\t}\n\n\tget #gridWrap(): HTMLElement\n\t{\n\t\treturn BX('booking-booking-grid-wrap');\n\t}\n\n\tget #fromHour(): number\n\t{\n\t\treturn Core.getStore().getters['interface/fromHour'];\n\t}\n\n\tget #toHour(): number\n\t{\n\t\treturn Core.getStore().getters['interface/toHour'];\n\t}\n\n\texpand({ keepScroll }): void\n\t{\n\t\tDom.removeClass(this.#container, classCollapse);\n\t\tDom.addClass(this.#container, classExpand);\n\t\tthis.animate(0, cellHeight, keepScroll);\n\t}\n\n\tcollapse(): void\n\t{\n\t\tDom.removeClass(this.#container, classExpand);\n\t\tDom.addClass(this.#container, classCollapse);\n\t\tthis.animate(cellHeight, 0, true);\n\t}\n\n\tanimate(fromHeight: number, toHeight: number, keepScroll: boolean = false): void\n\t{\n\t\tconst savedScrollTop = this.#gridWrap.scrollTop;\n\t\tconst savedScrollHeight = this.#gridWrap.scrollHeight;\n\t\tconst topCellsCoefficient = this.#fromHour / (24 - (this.#toHour - this.#fromHour));\n\n\t\tthis.#animation?.stop();\n\t\tthis.#animation = new BX.easing({\n\t\t\tduration: 200,\n\t\t\tstart: {\n\t\t\t\theight: fromHeight,\n\t\t\t},\n\t\t\tfinish: {\n\t\t\t\theight: toHeight,\n\t\t\t},\n\t\t\tstep: ({ height }) => {\n\t\t\t\tDom.style(this.#content, cellHeightProperty, `calc(var(--zoom) * ${height}px)`);\n\n\t\t\t\tif (keepScroll)\n\t\t\t\t{\n\t\t\t\t\tconst heightChange = this.#gridWrap.scrollHeight - savedScrollHeight;\n\n\t\t\t\t\tthis.#gridWrap.scrollTop = savedScrollTop + heightChange * topCellsCoefficient;\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t\tthis.#animation.animate();\n\t}\n\n\tsetExpanded(isExpanded: boolean): void\n\t{\n\t\tconst savedScrollTop = this.#gridWrap.scrollTop;\n\t\tconst savedScrollHeight = this.#gridWrap.scrollHeight;\n\t\tconst topCellsCoefficient = this.#fromHour / (24 - (this.#toHour - this.#fromHour));\n\n\t\tconst height = isExpanded ? cellHeight : 0;\n\t\tconst className = isExpanded ? classExpand : classCollapse;\n\n\t\tDom.removeClass(this.#container, [classCollapse, classExpand]);\n\t\tDom.addClass(this.#container, className);\n\t\tDom.style(this.#content, cellHeightProperty, `calc(var(--zoom) * ${height}px)`);\n\n\t\tconst heightChange = this.#gridWrap.scrollHeight - savedScrollHeight;\n\t\tthis.#gridWrap.scrollTop = savedScrollTop + heightChange * topCellsCoefficient;\n\n\t\tvoid Core.getStore().dispatch(`${Model.Interface}/setOffHoursExpanded`, isExpanded);\n\t}\n}\n\nexport const expandOffHours: ExpandOffHours = new ExpandOffHours();\n","import { BaseEvent, EventEmitter } from 'main.core.events';\nimport type { BookingUIFilter } from 'booking.lib.booking-filter';\n\nexport const FilterPreset = Object.freeze({\n\tNotConfirmed: 'booking-filter-preset-unconfirmed',\n\tDelayed: 'booking-filter-preset-delayed',\n\tCreatedByMe: 'booking-filter-preset-created-by-me',\n});\n\nexport const FilterField = Object.freeze({\n\tCreatedBy: 'CREATED_BY',\n\tContact: 'CONTACT',\n\tCompany: 'COMPANY',\n\tResource: 'RESOURCE',\n\tConfirmed: 'CONFIRMED',\n\tDelayed: 'DELAYED',\n});\n\nexport const Filter = {\n\temits: ['apply', 'clear'],\n\tprops: {\n\t\tfilterId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tfilter: null,\n\t\t};\n\t},\n\tcreated(): void\n\t{\n\t\tthis.filter = BX.Main.filterManager.getById(this.filterId);\n\n\t\tEventEmitter.subscribe('BX.Main.Filter:beforeApply', this.onBeforeApply);\n\t},\n\tmethods: {\n\t\tonBeforeApply(event: BaseEvent): void\n\t\t{\n\t\t\tconst [filterId] = event.getData();\n\t\t\tif (filterId !== this.filterId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isFilterEmpty())\n\t\t\t{\n\t\t\t\tthis.$emit('clear');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$emit('apply');\n\t\t\t}\n\t\t},\n\t\tsetPresetId(presetId: string): void\n\t\t{\n\t\t\tif (this.getPresetId() === presetId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.filter.getApi().setFilter({\n\t\t\t\tpreset_id: presetId,\n\t\t\t});\n\t\t},\n\t\tgetPresetId(): string | null\n\t\t{\n\t\t\tconst preset = this.filter.getPreset().getCurrentPresetId();\n\n\t\t\treturn preset === 'tmp_filter' ? null : preset;\n\t\t},\n\t\tisFilterEmpty(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.getFields()).length === 0;\n\t\t},\n\t\tgetFields(): BookingUIFilter\n\t\t{\n\t\t\tconst booleanFields = [FilterField.Confirmed, FilterField.Delayed];\n\t\t\tconst arrayFields = [FilterField.Company, FilterField.Contact, FilterField.CreatedBy, FilterField.Resource];\n\n\t\t\tconst filterFields = this.filter.getFilterFieldsValues();\n\t\t\tconst fields = booleanFields\n\t\t\t\t.filter((field) => ['Y', 'N'].includes(filterFields[field]))\n\t\t\t\t.reduce((acc, field) => ({\n\t\t\t\t\t...acc,\n\t\t\t\t\t[field]: filterFields[field],\n\t\t\t\t}), {})\n\t\t\t;\n\n\t\t\tarrayFields.forEach((field: string) => {\n\t\t\t\tif (filterFields[field]?.length > 0)\n\t\t\t\t{\n\t\t\t\t\tfields[field] = filterFields[field];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn fields;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div></div>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { CounterPanel } from 'ui.counterpanel';\nimport { CounterColor } from 'ui.cnt';\nimport './counters-panel.css';\n\nexport const CounterItem = Object.freeze({\n\tNotConfirmed: 'not-confirmed',\n\tDelayed: 'delayed',\n});\n\nexport const CountersPanel = {\n\temits: ['activeItem'],\n\tprops: {\n\t\ttarget: HTMLElement,\n\t},\n\tmounted(): void\n\t{\n\t\tthis.addCounterPanel();\n\n\t\tEventEmitter.subscribe('BX.UI.CounterPanel.Item:activate', this.onActiveItem);\n\t\tEventEmitter.subscribe('BX.UI.CounterPanel.Item:deactivate', this.onActiveItem);\n\t},\n\tcomputed: mapGetters({\n\t\tcounters: 'counters/get',\n\t}),\n\tmethods: {\n\t\tsetItem(itemId: string | null): void\n\t\t{\n\t\t\tif (this.getActiveItem() === itemId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tObject.values(CounterItem).forEach((id) => this.counterPanel.getItemById(id).deactivate());\n\n\t\t\tconst item = this.counterPanel.getItemById(itemId);\n\t\t\titem?.activate();\n\t\t},\n\t\taddCounterPanel(): void\n\t\t{\n\t\t\tthis.counterPanel = new CounterPanel({\n\t\t\t\ttarget: this.target,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: CounterItem.NotConfirmed,\n\t\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_COUNTER_PANEL_NOT_CONFIRMED'),\n\t\t\t\t\t\tvalue: this.counters.unConfirmed,\n\t\t\t\t\t\tcolor: getFieldName(CounterColor, CounterColor.THEME),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: CounterItem.Delayed,\n\t\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_COUNTER_PANEL_DELAYED'),\n\t\t\t\t\t\tvalue: this.counters.delayed,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\n\t\t\tthis.counterPanel.init();\n\t\t},\n\t\tonActiveItem(): void\n\t\t{\n\t\t\tthis.$emit('activeItem', this.getActiveItem());\n\t\t},\n\t\tgetActiveItem(): string | null\n\t\t{\n\t\t\treturn this.counterPanel.getItems().find(({ isActive }) => isActive)?.id ?? null;\n\t\t},\n\t},\n\twatch: {\n\t\tcounters(counters): void\n\t\t{\n\t\t\tthis.counterPanel.getItems().forEach((item) => {\n\t\t\t\tif (item.id === CounterItem.NotConfirmed)\n\t\t\t\t{\n\t\t\t\t\titem.updateColor(getFieldName(CounterColor, CounterColor.DANGER));\n\t\t\t\t\titem.updateValue(counters.unConfirmed);\n\t\t\t\t}\n\n\t\t\t\tif (item.id === CounterItem.Delayed)\n\t\t\t\t{\n\t\t\t\t\titem.updateColor(getFieldName(CounterColor, CounterColor.DANGER));\n\t\t\t\t\titem.updateValue(counters.delayed);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div></div>\n\t`,\n};\n\nconst getFieldName = (obj, field) => Object.entries(obj).find(([, value]) => value === field)[0];\n","import { Event } from 'main.core';\nimport { StatisticsPopup } from 'booking.component.statistics-popup';\n\nexport const Statistics = {\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tvalueFormatted: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tincreasedValue: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tincreasedValueFormatted: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tpopupId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\trows: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tbutton: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tmethods: {\n\t\tonMouseEnter(): void\n\t\t{\n\t\t\tthis.clearTimeouts();\n\t\t\tthis.showTimeout = setTimeout(() => this.showPopup(), 100);\n\t\t},\n\t\tonMouseLeave(): void\n\t\t{\n\t\t\tEvent.unbind(document, 'mouseover', this.updateHoverElement);\n\t\t\tEvent.bind(document, 'mouseover', this.updateHoverElement);\n\n\t\t\tthis.clearTimeouts();\n\n\t\t\tif (!this.button)\n\t\t\t{\n\t\t\t\tthis.closePopup();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.closeTimeout = setTimeout(() => {\n\t\t\t\tthis.popupContainer = document.getElementById(this.popupId);\n\t\t\t\tif (!this.popupContainer?.contains(this.hoverElement) && !this.$refs.container.contains(this.hoverElement))\n\t\t\t\t{\n\t\t\t\t\tthis.closePopup();\n\t\t\t\t}\n\n\t\t\t\tif (this.popupContainer)\n\t\t\t\t{\n\t\t\t\t\tEvent.unbind(this.popupContainer, 'mouseleave', this.onMouseLeave);\n\t\t\t\t\tEvent.bind(this.popupContainer, 'mouseleave', this.onMouseLeave);\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t},\n\t\tupdateHoverElement(event: MouseEvent): void\n\t\t{\n\t\t\tthis.hoverElement = event.target;\n\t\t},\n\t\tshowPopup(): void\n\t\t{\n\t\t\tthis.clearTimeouts();\n\t\t\tthis.isPopupShown = true;\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.clearTimeouts();\n\t\t\tthis.isPopupShown = false;\n\t\t\tEvent.unbind(this.popupContainer, 'mouseleave', this.onMouseLeave);\n\t\t\tEvent.unbind(document, 'mouseover', this.updateHoverElement);\n\t\t},\n\t\tclearTimeouts(): void\n\t\t{\n\t\t\tclearTimeout(this.closeTimeout);\n\t\t\tclearTimeout(this.showTimeout);\n\t\t},\n\t\tclose()\n\t\t{\n\t\t\tthis.closePopup();\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\twatch: {\n\t\tvalue(): void\n\t\t{\n\t\t\tthis.$refs.animation?.replaceWith(this.$refs.animation);\n\t\t},\n\t},\n\tcomponents: {\n\t\tStatisticsPopup,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-toolbar-after-title-info-profit-container\" ref=\"container\">\n\t\t\t<div\n\t\t\t\tv-html=\"valueFormatted\"\n\t\t\t\tclass=\"booking-toolbar-after-title-info-profit\"\n\t\t\t\t@click=\"showPopup\"\n\t\t\t\t@mouseenter=\"onMouseEnter\"\n\t\t\t\t@mouseleave=\"onMouseLeave\"\n\t\t\t></div>\n\t\t\t<div\n\t\t\t\tv-if=\"increasedValue > 0\"\n\t\t\t\tv-html=\"increasedValueFormatted\"\n\t\t\t\tclass=\"booking-toolbar-after-title-profit-increased\"\n\t\t\t\tref=\"animation\"\n\t\t\t></div>\n\t\t</div>\n\t\t<StatisticsPopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:popupId=\"popupId\"\n\t\t\t:bindElement=\"$refs.container\"\n\t\t\t:title=\"title\"\n\t\t\t:rows=\"rows\"\n\t\t\t:button=\"button\"\n\t\t\t@close=\"close\"\n\t\t/>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\n\nimport { Statistics } from '../statistics/statistics';\n\nexport const Clients = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tincreasedValue: 0,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\ttotalNewClientsToday: `${Model.Interface}/totalNewClientsToday`,\n\t\t\ttotalClients: `${Model.Interface}/totalClients`,\n\t\t}),\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn 'booking-booking-after-title-clients-popup';\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_AFTER_TITLE_CLIENTS_POPUP_TITLE');\n\t\t},\n\t\trows(): { title: string, value: string }[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_AFTER_TITLE_CLIENTS_POPUP_TOTAL_CLIENTS_TODAY'),\n\t\t\t\t\tvalue: `+${this.totalNewClientsToday}`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_AFTER_TITLE_CLIENTS_POPUP_TOTAL_CLIENTS'),\n\t\t\t\t\tvalue: `<div>${this.totalClients}</div>`,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tbutton(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('BOOKING_BOOKING_CLIENTS_LIST'),\n\t\t\t\tclick: () => BX.SidePanel.Instance.open('/crm/contact/list/'),\n\t\t\t};\n\t\t},\n\t\tclientsProfitFormatted(): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural('BOOKING_BOOKING_PLUS_NUM_CLIENTS', this.totalNewClientsToday, {\n\t\t\t\t'#NUM#': this.totalNewClientsToday,\n\t\t\t});\n\t\t},\n\t\tincreasedValueFormatted(): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural('BOOKING_BOOKING_PLUS_NUM_CLIENTS', this.increasedValue, {\n\t\t\t\t'#NUM#': this.increasedValue,\n\t\t\t});\n\t\t},\n\t},\n\twatch: {\n\t\ttotalNewClientsToday(newValue: number, previousValue: number): void\n\t\t{\n\t\t\tthis.increasedValue = newValue - previousValue;\n\t\t},\n\t},\n\tcomponents: {\n\t\tStatistics,\n\t},\n\ttemplate: `\n\t\t<Statistics\n\t\t\t:value=\"totalNewClientsToday\"\n\t\t\t:valueFormatted=\"clientsProfitFormatted\"\n\t\t\t:increasedValue=\"increasedValue\"\n\t\t\t:increasedValueFormatted=\"increasedValueFormatted\"\n\t\t\t:popupId=\"popupId\"\n\t\t\t:title=\"title\"\n\t\t\t:rows=\"rows\"\n\t\t\t:button=\"button\"\n\t\t/>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport { currencyFormat } from 'booking.lib.currency-format';\nimport type { MoneyStatistics } from 'booking.model.interface';\n\nimport { Statistics } from '../statistics/statistics';\n\nexport const Profit = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tincreasedValue: 0,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tmoneyStatistics: `${Model.Interface}/moneyStatistics`,\n\t\t}),\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn 'booking-booking-after-title-profit-popup';\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_AFTER_TITLE_PROFIT_POPUP_TITLE');\n\t\t},\n\t\trows(): { title: string, value: string }[]\n\t\t{\n\t\t\tconst otherCurrencies = this.moneyStatistics?.month\n\t\t\t\t?.filter(({ currencyId }) => currencyId !== this.baseCurrencyId)\n\t\t\t\t?.map(({ currencyId }) => currencyId) ?? []\n\t\t\t;\n\n\t\t\treturn [\n\t\t\t\tthis.getTodayRow(this.baseCurrencyId),\n\t\t\t\t...otherCurrencies.map((currencyId: string) => this.getTodayRow(currencyId)),\n\t\t\t\tthis.getMonthRow(this.baseCurrencyId),\n\t\t\t\t...otherCurrencies.map((currencyId: string) => this.getMonthRow(currencyId)),\n\t\t\t];\n\t\t},\n\t\ttodayProfit(): number\n\t\t{\n\t\t\treturn this.getTodayProfit(this.moneyStatistics);\n\t\t},\n\t\ttodayProfitFormatted(): string\n\t\t{\n\t\t\treturn this.formatTodayProfit(this.todayProfit);\n\t\t},\n\t\tincreasedValueFormatted(): string\n\t\t{\n\t\t\treturn this.formatTodayProfit(this.increasedValue);\n\t\t},\n\t\tbaseCurrencyId(): string\n\t\t{\n\t\t\treturn currencyFormat.getBaseCurrencyId();\n\t\t},\n\t},\n\tmethods: {\n\t\tgetTodayRow(currencyId: string): { title: string, value: string }\n\t\t{\n\t\t\tconst title = this.loc('BOOKING_BOOKING_AFTER_TITLE_PROFIT_POPUP_TOTAL_TODAY');\n\n\t\t\treturn {\n\t\t\t\ttitle: currencyId === this.baseCurrencyId ? title : '',\n\t\t\t\tvalue: `+${this.getTodayProfitFormatted(currencyId)}`,\n\t\t\t};\n\t\t},\n\t\tgetMonthRow(currencyId: string): { title: string, value: string }\n\t\t{\n\t\t\tconst title = this.loc('BOOKING_BOOKING_AFTER_TITLE_PROFIT_POPUP_MONTH', {\n\t\t\t\t'#MONTH#': DateTimeFormat.format('f'),\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\ttitle: currencyId === this.baseCurrencyId ? title : '',\n\t\t\t\tvalue: `<div>${this.getMonthProfitFormatted(currencyId)}</div>`,\n\t\t\t};\n\t\t},\n\t\tgetTodayProfitFormatted(currency: string): string\n\t\t{\n\t\t\tconst statistics = this.moneyStatistics?.today?.find(({ currencyId }) => currencyId === currency);\n\t\t\tconst profit = statistics?.opportunity ?? 0;\n\n\t\t\treturn currencyFormat.format(currency, profit);\n\t\t},\n\t\tgetMonthProfitFormatted(currency: string): string\n\t\t{\n\t\t\tconst statistics = this.moneyStatistics?.month?.find(({ currencyId }) => currencyId === currency);\n\t\t\tconst profit = statistics?.opportunity ?? 0;\n\n\t\t\treturn currencyFormat.format(currency, profit);\n\t\t},\n\t\tgetTodayProfit(statistics: MoneyStatistics | null): number\n\t\t{\n\t\t\tconst statistic = statistics?.today?.find(({ currencyId }) => currencyId === this.baseCurrencyId);\n\n\t\t\treturn statistic?.opportunity ?? 0;\n\t\t},\n\t\tformatTodayProfit(profit: number): string\n\t\t{\n\t\t\treturn `+ <span>${currencyFormat.format(this.baseCurrencyId, profit)}</span>`;\n\t\t},\n\t},\n\twatch: {\n\t\tmoneyStatistics(newValue: MoneyStatistics, previousValue: MoneyStatistics): void\n\t\t{\n\t\t\tthis.increasedValue = this.getTodayProfit(newValue) - this.getTodayProfit(previousValue);\n\t\t},\n\t},\n\tcomponents: {\n\t\tStatistics,\n\t},\n\ttemplate: `\n\t\t<Statistics\n\t\t\t:value=\"todayProfit\"\n\t\t\t:valueFormatted=\"todayProfitFormatted\"\n\t\t\t:increasedValue=\"increasedValue\"\n\t\t\t:increasedValueFormatted=\"increasedValueFormatted\"\n\t\t\t:popupId=\"popupId\"\n\t\t\t:title=\"title\"\n\t\t\t:rows=\"rows\"\n\t\t/>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { Clients } from './clients/clients';\nimport { Profit } from './profit/profit';\nimport './after-title.css';\n\nexport const AfterTitle = {\n\tcomputed: {\n\t\tdateFormatted(): string\n\t\t{\n\t\t\tconst format = DateTimeFormat.getFormat('DAY_SHORT_MONTH_FORMAT');\n\n\t\t\treturn DateTimeFormat.format(format, Date.now() / 1000);\n\t\t},\n\t},\n\tcomponents: {\n\t\tClients,\n\t\tProfit,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-toolbar-after-title\">\n\t\t\t<div class=\"booking-toolbar-after-title-date\" ref=\"date\">\n\t\t\t\t{{ dateFormatted }}\n\t\t\t</div>\n\t\t\t<div class=\"booking-toolbar-after-title-info\">\n\t\t\t\t<Clients/>\n\t\t\t\t<Profit/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Core } from 'booking.core';\nimport { Model } from 'booking.const';\nimport { Duration } from 'booking.lib.duration';\n\nclass Grid\n{\n\tcalculateLeft(resourceId: number): number\n\t{\n\t\tconst cellWidth = 280 * this.#zoom;\n\t\tconst indexOfResource = this.#resourcesIds.indexOf(resourceId);\n\n\t\treturn indexOfResource * cellWidth;\n\t}\n\n\tcalculateTop(fromTs: number): number\n\t{\n\t\tconst hourHeight = 50 * this.#zoom;\n\n\t\tconst from = new Date(Math.max(this.#selectedDateTs, fromTs + this.#offset));\n\t\tconst bookingMinutes = from.getHours() * 60 + from.getMinutes();\n\t\tconst fromMinutes = this.#fromHour * 60;\n\n\t\treturn (bookingMinutes - fromMinutes) * (hourHeight / 60);\n\t}\n\n\tcalculateHeight(fromTs: number, toTs: number): number\n\t{\n\t\tconst hourHeight = 50 * this.#zoom;\n\t\tconst minHeight = hourHeight / 4;\n\n\t\tconst from = Math.max(this.#selectedDateTs, fromTs + this.#offset);\n\t\tconst to = Math.min(new Date(this.#selectedDateTs).setHours(24), toTs + this.#offset);\n\n\t\treturn Math.max((to - from) / Duration.getUnitDurations().H * hourHeight, minHeight);\n\t}\n\n\tcalculateRealHeight(fromTs: number, toTs: number): number\n\t{\n\t\tconst hourHeight = 50 * this.#zoom;\n\t\tconst minHeight = hourHeight / 4;\n\n\t\tconst minTs = new Date(this.#selectedDateTs).setHours(this.#offHoursExpanded ? 0 : this.#fromHour);\n\t\tconst maxTs = new Date(this.#selectedDateTs).setHours(this.#offHoursExpanded ? 24 : this.#toHour);\n\t\tconst from = Math.max(minTs, fromTs + this.#offset);\n\t\tconst to = Math.min(maxTs, toTs + this.#offset);\n\n\t\treturn Math.max((to - from) / Duration.getUnitDurations().H * hourHeight, minHeight);\n\t}\n\n\tget #selectedDateTs(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/selectedDateTs`] + this.#offset;\n\t}\n\n\tget #offset(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/offset`];\n\t}\n\n\tget #zoom(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/zoom`];\n\t}\n\n\tget #resourcesIds(): number[]\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/resourcesIds`];\n\t}\n\n\tget #fromHour(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/fromHour`];\n\t}\n\n\tget #toHour(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/toHour`];\n\t}\n\n\tget #offHoursExpanded(): boolean\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/offHoursExpanded`];\n\t}\n}\n\nexport const grid = new Grid();\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { expandOffHours } from '../../../../lib/expand-off-hours/expand-off-hours';\nimport './off-hours.css';\n\nexport const OffHours = {\n\tprops: {\n\t\tbottom: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toffHoursHover: 'interface/offHoursHover',\n\t\t\toffHoursExpanded: 'interface/offHoursExpanded',\n\t\t\tfromHour: 'interface/fromHour',\n\t\t\ttoHour: 'interface/toHour',\n\t\t}),\n\t\tfromFormatted(): string\n\t\t{\n\t\t\tif (this.bottom)\n\t\t\t{\n\t\t\t\treturn this.formatHour(this.toHour);\n\t\t\t}\n\n\t\t\treturn this.formatHour(0);\n\t\t},\n\t\ttoFormatted(): string\n\t\t{\n\t\t\tif (this.bottom)\n\t\t\t{\n\t\t\t\treturn this.formatHour(24);\n\t\t\t}\n\n\t\t\treturn this.formatHour(this.fromHour);\n\t\t},\n\t},\n\tmethods: {\n\t\tformatHour(hour: number): string\n\t\t{\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\t\t\tconst timestamp = new Date().setHours(hour, 0) / 1000;\n\n\t\t\treturn DateTimeFormat.format(timeFormat, timestamp);\n\t\t},\n\t\tanimateOffHours({ keepScroll }): void\n\t\t{\n\t\t\tif (this.offHoursExpanded)\n\t\t\t{\n\t\t\t\texpandOffHours.collapse();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\texpandOffHours.expand({ keepScroll });\n\t\t\t}\n\n\t\t\tvoid this.$store.dispatch('interface/setOffHoursExpanded', !this.offHoursExpanded);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-off-hours\"\n\t\t\t:class=\"{'--hover': offHoursHover, '--bottom': bottom}\"\n\t\t\t@click=\"animateOffHours({ keepScroll: bottom })\"\n\t\t\t@mouseenter=\"$store.dispatch('interface/setOffHoursHover', true)\"\n\t\t\t@mouseleave=\"$store.dispatch('interface/setOffHoursHover', false)\"\n\t\t>\n\t\t\t<div class=\"booking-booking-off-hours-border\"></div>\n\t\t\t<span>{{ fromFormatted }}</span>\n\t\t\t<span>{{ toFormatted }}</span>\n\t\t</div>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { range } from 'booking.lib.range';\nimport { OffHours } from './off-hours/off-hours';\nimport './left-panel.css';\n\ntype Hour = {\n\tvalue: number,\n\tformatted: string,\n\toffHours: boolean,\n\tlast: boolean,\n};\n\nexport const LeftPanel = {\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toffHoursHover: 'interface/offHoursHover',\n\t\t\toffHoursExpanded: 'interface/offHoursExpanded',\n\t\t\tfromHour: 'interface/fromHour',\n\t\t\ttoHour: 'interface/toHour',\n\t\t}),\n\t\tpanelHours(): Hour[]\n\t\t{\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\t\t\tconst lastHour = this.offHoursExpanded ? 24 : this.toHour;\n\n\t\t\treturn range(0, 24).map((hour) => {\n\t\t\t\tconst timestamp = new Date().setHours(hour, 0) / 1000;\n\n\t\t\t\treturn {\n\t\t\t\t\tvalue: hour,\n\t\t\t\t\tformatted: DateTimeFormat.format(timeFormat, timestamp),\n\t\t\t\t\toffHours: hour < this.fromHour || hour >= this.toHour,\n\t\t\t\t\tlast: hour === lastHour,\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t},\n\tcomponents: {\n\t\tOffHours,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-grid-left-panel-container\">\n\t\t\t<div class=\"booking-booking-grid-left-panel\">\n\t\t\t\t<OffHours/>\n\t\t\t\t<OffHours :bottom=\"true\"/>\n\t\t\t\t<template v-for=\"hour of panelHours\" :key=\"hour.value\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"hour.last\"\n\t\t\t\t\t\tclass=\"booking-booking-grid-left-panel-time-text\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ hour.formatted }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"hour.value !== 24\"\n\t\t\t\t\t\tclass=\"booking-booking-grid-left-panel-time\"\n\t\t\t\t\t\t:class=\"{'--off-hours': hour.offHours}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"booking-booking-grid-left-panel-time-text\">\n\t\t\t\t\t\t\t{{ hour.formatted }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport './now-line.css';\n\nexport const NowLine = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tvisible: true,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.updateNowLine();\n\t\tsetInterval(() => this.updateNowLine(), 1000);\n\t},\n\tcomputed: mapGetters({\n\t\tzoom: `${Model.Interface}/zoom`,\n\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\toffHoursExpanded: `${Model.Interface}/offHoursExpanded`,\n\t\tfromHour: `${Model.Interface}/fromHour`,\n\t\ttoHour: `${Model.Interface}/toHour`,\n\t\toffset: `${Model.Interface}/offset`,\n\t}),\n\tmethods: {\n\t\tsetVisible(visible: boolean): void\n\t\t{\n\t\t\tthis.visible = visible;\n\t\t\tthis.updateNowLine();\n\t\t},\n\t\tupdateNowLine(): void\n\t\t{\n\t\t\tconst now = new Date(Date.now() + this.offset);\n\n\t\t\tconst hourHeight = 50 * this.zoom;\n\t\t\tconst fromMinutes = this.fromHour * 60;\n\t\t\tconst nowMinutes = now.getHours() * 60 + now.getMinutes();\n\t\t\tconst toHour = this.offHoursExpanded ? 24 : this.toHour;\n\t\t\tconst toMinutes = Math.min(toHour * 60 + 21, nowMinutes);\n\t\t\tconst top = (toMinutes - fromMinutes) * (hourHeight / 60);\n\t\t\tDom.style(this.$refs.nowLine, 'top', `${top}px`);\n\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\t\t\tconst timeFormatted = DateTimeFormat.format(timeFormat, now.getTime() / 1000);\n\t\t\tif (timeFormatted !== this.$refs.nowText.innerText)\n\t\t\t{\n\t\t\t\tthis.$refs.nowText.innerText = timeFormatted;\n\t\t\t}\n\n\t\t\tconst date = new Date(this.selectedDateTs + this.offset);\n\n\t\t\tconst visible = this.visible\n\t\t\t\t&& Date.UTC(date.getFullYear(), date.getMonth(), date.getDate())\n\t\t\t\t=== Date.UTC(now.getFullYear(), now.getMonth(), now.getDate())\n\t\t\t;\n\t\t\tDom.style(this.$refs.nowLine, 'display', visible ? '' : 'none');\n\t\t},\n\t},\n\twatch: {\n\t\tselectedDateTs(): void\n\t\t{\n\t\t\tthis.updateNowLine();\n\t\t},\n\t\tzoom(): void\n\t\t{\n\t\t\tthis.updateNowLine();\n\t\t},\n\t\toffHoursExpanded(offHoursExpanded: boolean): void\n\t\t{\n\t\t\tconst now = new Date();\n\t\t\tconst nowMinutes = now.getHours() * 60 + now.getMinutes();\n\t\t\tif (nowMinutes < this.toHour * 60)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setVisible(!offHoursExpanded);\n\t\t\tsetTimeout(() => this.setVisible(true), 200);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-grid-now-line\" ref=\"nowLine\">\n\t\t\t<div class=\"booking-booking-grid-now-line-text\" ref=\"nowText\"></div>\n\t\t</div>\n\t`,\n};\n","import { Core } from 'booking.core';\nimport { BusySlot, DateFormat, Model } from 'booking.const';\nimport { Duration } from 'booking.lib.duration';\nimport { resourceDialogService } from 'booking.provider.service.resource-dialog-service';\nimport { resourcesDateCache } from 'booking.lib.resources-date-cache';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { ResourceModel, SlotRange } from 'booking.model.resources';\n\nexport type BusySlotDto = {\n\tid: string,\n\tfromTs: number,\n\ttoTs: number,\n\tresourceId: number,\n\tintersectingResourceId?: number,\n\ttype: string,\n};\n\nclass BusySlots\n{\n\t#busySlots: BusySlotDto[] = [];\n\n\t#getBookings(): BookingModel[]\n\t{\n\t\treturn Core.getStore().getters[`${Model.Bookings}/getByDateAndResources`](\n\t\t\tthis.#selectedDateTs,\n\t\t\tthis.#resourcesIds,\n\t\t);\n\t}\n\n\t#getIntersectingBookings(resourcesIds: number[]): BookingModel[]\n\t{\n\t\treturn Core.getStore().getters[`${Model.Bookings}/getByDateAndResources`](\n\t\t\tthis.#selectedDateTs,\n\t\t\tresourcesIds,\n\t\t);\n\t}\n\n\tget #selectedWeekDay(): string\n\t{\n\t\treturn DateFormat.WeekDays[new Date(this.#selectedDateTs + this.#offset).getDay()];\n\t}\n\n\tget #selectedDateTs(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/selectedDateTs`];\n\t}\n\n\tget #offset(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/offset`];\n\t}\n\n\tget #timezoneOffset(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/timezoneOffset`];\n\t}\n\n\tget #resourcesIds(): number[]\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/resourcesIds`];\n\t}\n\n\tget #intersections(): number[]\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/intersections`];\n\t}\n\n\tasync loadBusySlots(): Promise<void>\n\t{\n\t\tawait this.#loadIntersections();\n\n\t\tvoid Core.getStore().dispatch(`${Model.Interface}/clearDisabledBusySlots`);\n\t\tvoid Core.getStore().dispatch(`${Model.Interface}/clearBusySlots`);\n\n\t\tconst resourcesWithIntersections = Object.keys(this.#intersections)\n\t\t\t.flatMap((key: string) => {\n\t\t\t\tconst resourceId = Number(key);\n\n\t\t\t\tif (resourceId > 0)\n\t\t\t\t{\n\t\t\t\t\treturn resourceId;\n\t\t\t\t}\n\n\t\t\t\treturn this.#resourcesIds;\n\t\t\t})\n\t\t;\n\n\t\tthis.#busySlots = [\n\t\t\t...this.#resourcesIds.flatMap((resourceId) => this.#calculateOffHoursBusySlots(resourceId)),\n\t\t\t...resourcesWithIntersections.flatMap((resourceId) => this.#calculateIntersectionBusySlots(resourceId)),\n\t\t];\n\n\t\treturn Core.getStore().dispatch(`${Model.Interface}/upsertBusySlotMany`, this.#busySlots);\n\t}\n\n\tasync #loadIntersections(): Promise<void>\n\t{\n\t\tconst selectedResourceIds = [...new Set(Object.values(this.#intersections).flat())];\n\n\t\tconst dateTs = this.#selectedDateTs / 1000;\n\t\tconst loadedResourcesIds = new Set(resourcesDateCache.getIdsByDateTs(dateTs));\n\t\tconst idsToLoad = selectedResourceIds.filter((id: number) => !loadedResourcesIds.has(id));\n\n\t\tawait resourceDialogService.loadByIds(idsToLoad, dateTs);\n\t}\n\n\t#calculateOffHoursBusySlots(resourceId: number): BusySlotDto[]\n\t{\n\t\tconst resource: ResourceModel = this.#getResource(resourceId);\n\t\tif (resource.slotRanges.length === 0)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst bookingRanges = this.#getBookings()\n\t\t\t.filter((booking: BookingModel) => booking.resourcesIds.includes(resourceId))\n\t\t\t.map((booking: BookingModel) => this.#calculateMinutesRange(booking))\n\t\t;\n\n\t\tconst minutesInDay = Duration.getUnitDurations().d / Duration.getUnitDurations().i;\n\n\t\tconst slotRanges = resource.slotRanges\n\t\t\t.map((slotRange: SlotRange): SlotRange => {\n\t\t\t\tconst timeZone = slotRange.timezone;\n\n\t\t\t\tconst date = new Date(this.#selectedDateTs);\n\t\t\t\tconst dateInTimezone = new Date(date.toLocaleString('en-US', { timeZone }));\n\t\t\t\tconst dateInUTC = new Date(date.toLocaleString('en-US', { timeZone: 'UTC' }));\n\n\t\t\t\tconst timezoneOffset = (dateInTimezone.getTime() - dateInUTC.getTime()) / 1000;\n\t\t\t\tconst minutesOffset = (this.#timezoneOffset - timezoneOffset) / 60;\n\n\t\t\t\treturn {\n\t\t\t\t\t...slotRange,\n\t\t\t\t\tfrom: slotRange.from + minutesOffset,\n\t\t\t\t\tto: slotRange.to + minutesOffset,\n\t\t\t\t};\n\t\t\t})\n\t\t\t.map((slotRange: SlotRange) => {\n\t\t\t\tif (slotRange.from > minutesInDay)\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...slotRange,\n\t\t\t\t\t\tfrom: slotRange.from - minutesInDay,\n\t\t\t\t\t\tto: slotRange.to - minutesInDay,\n\t\t\t\t\t\tweekDays: slotRange.weekDays.map((weekDay) => this.#getNextDay(weekDay)),\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (slotRange.to < 0)\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...slotRange,\n\t\t\t\t\t\tfrom: slotRange.from + minutesInDay,\n\t\t\t\t\t\tto: slotRange.to + minutesInDay,\n\t\t\t\t\t\tweekDays: slotRange.weekDays.map((weekDay) => this.#getPreviousDay(weekDay)),\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn slotRange;\n\t\t\t})\n\t\t\t.flatMap((slotRange: SlotRange): SlotRange[] => {\n\t\t\t\tif (slotRange.from < 0)\n\t\t\t\t{\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...slotRange,\n\t\t\t\t\t\t\tfrom: 0,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t...slotRange.weekDays.map((weekDay) => ({\n\t\t\t\t\t\t\t...slotRange,\n\t\t\t\t\t\t\tfrom: minutesInDay + slotRange.from,\n\t\t\t\t\t\t\tto: minutesInDay,\n\t\t\t\t\t\t\tweekDays: [this.#getPreviousDay(weekDay)],\n\t\t\t\t\t\t})),\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\tif (slotRange.to > minutesInDay)\n\t\t\t\t{\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...slotRange,\n\t\t\t\t\t\t\tto: minutesInDay,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t...slotRange.weekDays.map((weekDay) => ({\n\t\t\t\t\t\t\t...slotRange,\n\t\t\t\t\t\t\tfrom: 0,\n\t\t\t\t\t\t\tto: slotRange.to - minutesInDay,\n\t\t\t\t\t\t\tweekDays: [this.#getNextDay(weekDay)],\n\t\t\t\t\t\t})),\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\treturn slotRange;\n\t\t\t})\n\t\t\t.filter((slotRange: SlotRange) => slotRange.weekDays.includes(this.#selectedWeekDay))\n\t\t;\n\n\t\tconst freeRanges = this.filterSlotRanges([...slotRanges, ...bookingRanges]);\n\n\t\tconst busyRanges = [0, ...freeRanges.flatMap(({ from, to }) => [from, to]), 24 * 60]\n\t\t\t.reduce((acc, minutes, index) => {\n\t\t\t\tconst chunkIndex = Math.floor(index / 2);\n\n\t\t\t\tacc[chunkIndex] ??= [];\n\t\t\t\tacc[chunkIndex].push(minutes);\n\n\t\t\t\treturn acc;\n\t\t\t}, [])\n\t\t;\n\n\t\treturn busyRanges.filter(([from, to]) => to - from > 0).map(([from, to]): BusySlotDto => {\n\t\t\tconst fromTs = new Date(this.#selectedDateTs).setMinutes(from);\n\t\t\tconst toTs = new Date(this.#selectedDateTs).setMinutes(to);\n\t\t\tconst id = `${resourceId}-${fromTs}-${toTs}`;\n\t\t\tconst type = BusySlot.OffHours;\n\n\t\t\treturn { id, fromTs, toTs, resourceId, type };\n\t\t});\n\t}\n\n\t#calculateIntersectionBusySlots(resourceId: number): BusySlotDto[]\n\t{\n\t\tconst resource: ResourceModel = this.#getResource(resourceId);\n\t\tif (resource.slotRanges.length === 0)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst intersectingResourcesIds = [\n\t\t\t...(this.#intersections[0] ?? []),\n\t\t\t...(this.#intersections[resourceId] ?? []),\n\t\t];\n\n\t\tconst intersectingBookings = this.#getIntersectingBookings(intersectingResourcesIds)\n\t\t\t.filter((booking: BookingModel) => !booking.resourcesIds.includes(resourceId))\n\t\t;\n\n\t\tconst intersectingBookingRanges = intersectingBookings\n\t\t\t.map((booking: BookingModel) => this.#calculateMinutesRange(booking));\n\t\tif (intersectingBookingRanges.length === 0)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst bookingRanges = this.#getBookings()\n\t\t\t.filter((booking: BookingModel) => resourceId === booking.resourcesIds[0])\n\t\t\t.map((booking: BookingModel) => this.#calculateMinutesRange(booking))\n\t\t;\n\n\t\tconst busyRanges = intersectingBookingRanges.flatMap((intersectingRange) => {\n\t\t\treturn this.#subtractRanges(intersectingRange, bookingRanges);\n\t\t});\n\n\t\treturn busyRanges.map(({ from, to, id }): BusySlotDto => {\n\t\t\tconst fromTs = new Date(this.#selectedDateTs).setMinutes(from);\n\t\t\tconst toTs = new Date(this.#selectedDateTs).setMinutes(to);\n\t\t\tconst type = BusySlot.Intersection;\n\n\t\t\tconst booking = intersectingBookings.find((intersectingBooking) => intersectingBooking.id === id);\n\n\t\t\tconst intersectingResourceId = booking\n\t\t\t\t? booking.resourcesIds.find((it) => intersectingResourcesIds.includes(it))\n\t\t\t\t: 0\n\t\t\t;\n\n\t\t\treturn {\n\t\t\t\tid: `${resourceId}-${fromTs}-${toTs}`,\n\t\t\t\tfromTs,\n\t\t\t\ttoTs,\n\t\t\t\tresourceId,\n\t\t\t\tintersectingResourceId,\n\t\t\t\ttype,\n\t\t\t};\n\t\t});\n\t}\n\n\t#calculateMinutesRange(booking: BookingModel): { from: number, to: number }\n\t{\n\t\tconst date = new Date(this.#selectedDateTs);\n\t\tconst dateFromTs = Math.max(date.getTime(), booking.dateFromTs) + this.#offset;\n\t\tconst dateToTs = Math.min(date.setDate(date.getDate() + 1), booking.dateToTs) + this.#offset;\n\n\t\tconst dateFrom = new Date(dateFromTs);\n\t\tconst dateTo = new Date(dateToTs);\n\t\tconst to = dateTo.getHours() * 60 + dateTo.getMinutes();\n\n\t\treturn {\n\t\t\tfrom: dateFrom.getHours() * 60 + dateFrom.getMinutes(),\n\t\t\tto: to === 0 ? 60 * 24 : to,\n\t\t\tid: booking.id,\n\t\t};\n\t}\n\n\t#subtractRanges(range, bookingRanges): { from: number, to: number }[]\n\t{\n\t\tlet remainingRanges = [{ ...range }];\n\n\t\tbookingRanges.forEach((bookingRange) => {\n\t\t\tremainingRanges = remainingRanges.flatMap((remainingRange) => {\n\t\t\t\tif (this.#rangesOverlap(remainingRange, bookingRange))\n\t\t\t\t{\n\t\t\t\t\tconst parts = [];\n\t\t\t\t\tif (remainingRange.from < bookingRange.from)\n\t\t\t\t\t{\n\t\t\t\t\t\tparts.push({\n\t\t\t\t\t\t\tfrom: remainingRange.from,\n\t\t\t\t\t\t\tto: bookingRange.from,\n\t\t\t\t\t\t\tid: remainingRange.id,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (remainingRange.to > bookingRange.to)\n\t\t\t\t\t{\n\t\t\t\t\t\tparts.push({\n\t\t\t\t\t\t\tfrom: bookingRange.to,\n\t\t\t\t\t\t\tto: remainingRange.to,\n\t\t\t\t\t\t\tid: remainingRange.id,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn parts;\n\t\t\t\t}\n\n\t\t\t\treturn [remainingRange];\n\t\t\t});\n\t\t});\n\n\t\treturn remainingRanges;\n\t}\n\n\t#rangesOverlap(range1, range2): boolean\n\t{\n\t\treturn range1.from < range2.to && range2.from < range1.to;\n\t}\n\n\tfilterSlotRanges(slotRanges: { from: number, to: number }[]): { from: number, to: number }[]\n\t{\n\t\treturn slotRanges\n\t\t\t.map(({ from, to }) => ({ from, to }))\n\t\t\t.sort((a, b) => a.from - b.from)\n\t\t\t.reduce((acc, { from, to }) => {\n\t\t\t\tconst last = acc.length - 1;\n\t\t\t\tif (acc[last] && acc[last].to >= from)\n\t\t\t\t{\n\t\t\t\t\tif (acc[last].to <= to)\n\t\t\t\t\t{\n\t\t\t\t\t\tacc[last].to = to;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tacc.push({ from, to });\n\t\t\t\t}\n\n\t\t\t\treturn acc;\n\t\t\t}, [])\n\t\t\t.filter(({ from, to }) => to - from > 0)\n\t\t;\n\t}\n\n\t#getResource(resourceId: number): ResourceModel\n\t{\n\t\treturn Core.getStore().getters[`${Model.Resources}/getById`](resourceId);\n\t}\n\n\t#getNextDay(weekDay: string): string\n\t{\n\t\treturn DateFormat.WeekDays[(DateFormat.WeekDays.indexOf(weekDay) + 1) % 7];\n\t}\n\n\t#getPreviousDay(weekDay: string): string\n\t{\n\t\treturn DateFormat.WeekDays[(DateFormat.WeekDays.indexOf(weekDay) + 7 - 1) % 7];\n\t}\n}\n\nexport const busySlots = new BusySlots();\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { ClientPopup } from 'booking.component.client-popup';\nimport { AhaMoment, HelpDesk, Model } from 'booking.const';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { limit } from 'booking.lib.limit';\nimport type { ClientData } from 'booking.model.clients';\nimport './add-client.css';\n\nexport const AddClient = {\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\texpired: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tshowPopup: false,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.isRealId(this.bookingId))\n\t\t{\n\t\t\tahaMoments.setBookingForAhaMoment(this.bookingId);\n\t\t}\n\n\t\tif (ahaMoments.shouldShow(AhaMoment.AddClient, { bookingId: this.bookingId }))\n\t\t{\n\t\t\tvoid this.showAhaMoment();\n\t\t}\n\t},\n\tcomputed: mapGetters({\n\t\tproviderModuleId: `${Model.Clients}/providerModuleId`,\n\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t}),\n\tmethods: {\n\t\tclickHandler(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.showPopup = true;\n\t\t},\n\t\tasync addClientsToBook(clients: ClientData[]): Promise<void>\n\t\t{\n\t\t\tconst booking = this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t\tawait bookingService.update({\n\t\t\t\tid: booking.id,\n\t\t\t\tclients,\n\t\t\t});\n\t\t},\n\t\tisRealId(id: number): number\n\t\t{\n\t\t\treturn /^[1-9]\\d*$/.test(id);\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-add-client',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_ADD_CLIENT_TITLE'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_ADD_CLIENT_TEXT'),\n\t\t\t\tarticle: HelpDesk.AhaAddClient,\n\t\t\t\ttarget: this.$refs.button,\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.AddClient);\n\t\t},\n\t},\n\tcomponents: {\n\t\tClientPopup,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"providerModuleId\"\n\t\t\tclass=\"booking-booking-booking-add-client\"\n\t\t\t:class=\"{ '--expired': expired }\"\n\t\t\tdata-element=\"booking-add-client-button\"\n\t\t\t:data-id=\"bookingId\"\n\t\t\t:data-resource-id=\"resourceId\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"clickHandler\"\n\t\t>\n\t\t\t{{ loc('BOOKING_BOOKING_PLUS_CLIENT') }}\n\t\t</div>\n\t\t<ClientPopup\n\t\t\tv-if=\"showPopup\"\n\t\t\t:bindElement=\"this.$refs.button\"\n\t\t\t:offset-top=\"-100\"\n\t\t\t:offset-left=\"this.$refs.button.offsetWidth + 10\"\n\t\t\t@create=\"addClientsToBook\"\n\t\t\t@close=\"showPopup = false\"\n\t\t/>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { PopupOptions } from 'main.popup';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport { Popup } from 'booking.component.popup';\nimport { TimeSelector } from 'booking.component.time-selector';\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'booking.component.button';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel } from 'booking.model.bookings';\nimport './change-time-popup.css';\n\nexport const ChangeTimePopup = {\n\temits: ['close'],\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\ttargetNode: HTMLElement,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tButtonIcon,\n\t\t\tfromTs: 0,\n\t\t\ttoTs: 0,\n\t\t\tduration: 0,\n\t\t};\n\t},\n\tcreated(): void\n\t{\n\t\tthis.fromTs = this.booking.dateFromTs;\n\t\tthis.toTs = this.booking.dateToTs;\n\t\tthis.duration = this.toTs - this.fromTs;\n\t},\n\tmounted(): void\n\t{\n\t\tEvent.bind(document, 'scroll', this.adjustPosition, true);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEvent.unbind(document, 'scroll', this.adjustPosition, true);\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t}),\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `booking-change-time-popup-${this.bookingId}`;\n\t\t},\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tclassName: 'booking-booking-change-time-popup',\n\t\t\t\tbindElement: this.targetNode,\n\t\t\t\toffsetTop: -10,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tangle: {\n\t\t\t\t\toffset: this.targetNode.offsetWidth / 2,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tisBusy(): boolean\n\t\t{\n\t\t\treturn this.bookings\n\t\t\t\t.filter(({ id }) => id !== this.bookingId)\n\t\t\t\t.some(({ dateToTs, dateFromTs }) => dateToTs > this.fromTs && this.toTs > dateFromTs)\n\t\t\t;\n\t\t},\n\t\tbookings(): BookingModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getByDateAndResources`](\n\t\t\t\tthis.selectedDateTs,\n\t\t\t\tthis.booking.resourcesIds,\n\t\t\t);\n\t\t},\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t},\n\tmethods: {\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tthis.$refs.popup.adjustPosition();\n\t\t\tthis.$refs.timeFrom.adjustMenuPosition();\n\t\t\tthis.$refs.timeTo.adjustMenuPosition();\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tconst tsChanged = this.booking.dateFromTs !== this.fromTs || this.booking.dateToTs !== this.toTs;\n\t\t\tif (!this.isBusy && tsChanged)\n\t\t\t{\n\t\t\t\tvoid bookingService.update({\n\t\t\t\t\tid: this.booking.id,\n\t\t\t\t\tdateFromTs: this.fromTs,\n\t\t\t\t\tdateToTs: this.toTs,\n\t\t\t\t\ttimezoneFrom: this.booking.timezoneFrom,\n\t\t\t\t\ttimezoneTo: this.booking.timezoneTo,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tfreeze(): void\n\t\t{\n\t\t\tthis.$refs.popup.getPopupInstance().setAutoHide(false);\n\t\t},\n\t\tunfreeze(): void\n\t\t{\n\t\t\tthis.$refs.popup.getPopupInstance().setAutoHide(true);\n\t\t},\n\t},\n\twatch: {\n\t\tfromTs(): void\n\t\t{\n\t\t\tthis.toTs = this.fromTs + this.duration;\n\t\t},\n\t\ttoTs(): void\n\t\t{\n\t\t\tif (this.toTs <= this.fromTs)\n\t\t\t{\n\t\t\t\tthis.fromTs = this.toTs - this.duration;\n\t\t\t}\n\n\t\t\tthis.duration = this.toTs - this.fromTs;\n\t\t},\n\t\tisBusy(): void\n\t\t{\n\t\t\tsetTimeout(() => this.adjustPosition(), 0);\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t\tTimeSelector,\n\t\tButton,\n\t},\n\ttemplate: `\n\t\t<Popup\n\t\t\t:id=\"popupId\"\n\t\t\t:config=\"config\"\n\t\t\t@close=\"closePopup\"\n\t\t\tref=\"popup\"\n\t\t>\n\t\t\t<div class=\"booking-booking-change-time-popup-content\">\n\t\t\t\t<div class=\"booking-booking-change-time-popup-main\">\n\t\t\t\t\t<TimeSelector\n\t\t\t\t\t\tv-model=\"fromTs\"\n\t\t\t\t\t\t:hasError=\"isBusy\"\n\t\t\t\t\t\tdata-element=\"booking-change-time-from\"\n\t\t\t\t\t\t:data-ts=\"fromTs\"\n\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\tref=\"timeFrom\"\n\t\t\t\t\t\t@freeze=\"freeze\"\n\t\t\t\t\t\t@unfreeze=\"unfreeze\"\n\t\t\t\t\t\t@enterSave=\"closePopup\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div class=\"booking-booking-change-time-popup-separator\"></div>\n\t\t\t\t\t<TimeSelector\n\t\t\t\t\t\tv-model=\"toTs\"\n\t\t\t\t\t\t:hasError=\"isBusy\"\n\t\t\t\t\t\t:minTs=\"fromTs\"\n\t\t\t\t\t\tdata-element=\"booking-change-time-to\"\n\t\t\t\t\t\t:data-ts=\"toTs\"\n\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\tref=\"timeTo\"\n\t\t\t\t\t\t@freeze=\"freeze\"\n\t\t\t\t\t\t@unfreeze=\"unfreeze\"\n\t\t\t\t\t\t@enterSave=\"closePopup\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclass=\"booking-booking-change-time-popup-button\"\n\t\t\t\t\t\t:size=\"ButtonIcon.MEDIUM\"\n\t\t\t\t\t\t:color=\"ButtonColor.PRIMARY\"\n\t\t\t\t\t\t:icon=\"ButtonIcon.DONE\"\n\t\t\t\t\t\t:disabled=\"isBusy\"\n\t\t\t\t\t\t@click=\"closePopup\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"isBusy\" class=\"booking-booking-change-time-popup-error\">\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_TIME_IS_NOT_AVAILABLE') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport type { BookingModel } from 'booking.model.bookings';\nimport { ChangeTimePopup } from './change-time-popup/change-time-popup';\nimport './booking-time.css';\n\nexport const BookingTime = {\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tshowPopup: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toffset: `${Model.Interface}/offset`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t\ttimeFormatted(): string\n\t\t{\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\t\treturn this.loc('BOOKING_BOOKING_TIME_RANGE', {\n\t\t\t\t'#FROM#': DateTimeFormat.format(timeFormat, (this.booking.dateFromTs + this.offset) / 1000),\n\t\t\t\t'#TO#': DateTimeFormat.format(timeFormat, (this.booking.dateToTs + this.offset) / 1000),\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tclickHandler(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.isRealId(this.bookingId))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.showPopup = true;\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.showPopup = false;\n\t\t},\n\t\tisRealId(id: number): number\n\t\t{\n\t\t\treturn /^[1-9]\\d*$/.test(id);\n\t\t},\n\t},\n\tcomponents: {\n\t\tChangeTimePopup,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-booking-time\"\n\t\t\t:class=\"{'--lock': !isFeatureEnabled}\"\n\t\t\tdata-element=\"booking-booking-time\"\n\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t:data-resource-id=\"resourceId\"\n\t\t\t:data-from=\"booking.dateFromTs\"\n\t\t\t:data-to=\"booking.dateToTs\"\n\t\t\tref=\"time\"\n\t\t\t@click=\"clickHandler\"\n\t\t>\n\t\t\t{{ timeFormatted }}\n\t\t</div>\n\t\t<ChangeTimePopup\n\t\t\tv-if=\"showPopup\"\n\t\t\t:bookingId=\"bookingId\"\n\t\t\t:targetNode=\"$refs.time\"\n\t\t\t@close=\"closePopup\"\n\t\t/>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { PopupOptions } from 'main.popup';\nimport { Resolvable } from 'booking.lib.resolvable';\nimport { Popup } from 'booking.component.popup';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport { Button, ButtonSize, ButtonColor } from 'booking.component.button';\nimport type { BookingModel } from 'booking.model.bookings';\nimport './note-popup.css';\n\nexport const NotePopup = {\n\temits: ['close'],\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tnote: '',\n\t\t\tmountedPromise: new Resolvable(),\n\t\t};\n\t},\n\tcreated(): void\n\t{\n\t\tthis.note = this.bookingNote;\n\t},\n\tmounted(): void\n\t{\n\t\tthis.mountedPromise.resolve();\n\t\tthis.adjustPosition();\n\t\tthis.focusOnTextarea();\n\t\tEvent.bind(document, 'scroll', this.adjustPosition, true);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEvent.unbind(document, 'scroll', this.adjustPosition, true);\n\t},\n\tcomputed: {\n\t\tbookingNote(): string\n\t\t{\n\t\t\treturn this.booking.note ?? '';\n\t\t},\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `booking-booking-note-popup-${this.bookingId}`;\n\t\t},\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tclassName: 'booking-booking-note-popup',\n\t\t\t\tbindElement: this.bindElement(),\n\t\t\t\tminWidth: this.bindElement().offsetWidth,\n\t\t\t\theight: 120,\n\t\t\t\toffsetTop: -10,\n\t\t\t\tbackground: 'var(--ui-color-background-note)',\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tautoHide: this.isEditMode,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tsaveNote(): void\n\t\t{\n\t\t\tconst note = this.note.trim();\n\t\t\tif (this.bookingNote !== note)\n\t\t\t{\n\t\t\t\tvoid bookingService.update({\n\t\t\t\t\tid: this.booking.id,\n\t\t\t\t\tnote,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.closePopup();\n\t\t},\n\t\tonMouseDown(): void\n\t\t{\n\t\t\tEvent.unbind(window, 'mouseup', this.onMouseUp);\n\t\t\tEvent.bind(window, 'mouseup', this.onMouseUp);\n\t\t\tthis.setAutoHide(false);\n\t\t},\n\t\tonMouseUp(): void\n\t\t{\n\t\t\tEvent.unbind(window, 'mouseup', this.onMouseUp);\n\t\t\tsetTimeout(() => this.setAutoHide(this.isEditMode), 0);\n\t\t},\n\t\tsetAutoHide(autoHide: boolean): void\n\t\t{\n\t\t\tthis.$refs.popup?.getPopupInstance()?.setAutoHide(autoHide);\n\t\t},\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tthis.$refs.popup.adjustPosition();\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tfocusOnTextarea(): void\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.isEditMode)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.textarea.focus();\n\t\t\t\t}\n\t\t\t}, 0);\n\t\t},\n\t},\n\twatch: {\n\t\tisEditMode(isEditMode: boolean): void\n\t\t{\n\t\t\tthis.setAutoHide(isEditMode);\n\t\t\tthis.focusOnTextarea();\n\t\t},\n\t\tasync note(): Promise<void>\n\t\t{\n\t\t\tawait this.mountedPromise;\n\n\t\t\tthis.$refs.popup.getPopupInstance().setHeight(0);\n\n\t\t\tconst minHeight = 120;\n\t\t\tconst maxHeight = 280;\n\t\t\tconst height = this.$refs.textarea.scrollHeight + 45;\n\t\t\tconst popupHeight = Math.min(maxHeight, Math.max(minHeight, height));\n\n\t\t\tthis.$refs.popup.getPopupInstance().setHeight(popupHeight);\n\t\t\tthis.adjustPosition();\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t\tButton,\n\t},\n\ttemplate: `\n\t\t<Popup\n\t\t\t:id=\"popupId\"\n\t\t\t:config=\"config\"\n\t\t\tref=\"popup\"\n\t\t\t@close=\"closePopup\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"booking-booking-note-popup-content\"\n\t\t\t\tdata-element=\"booking-note-popup\"\n\t\t\t\t:data-id=\"bookingId\"\n\t\t\t\t@mousedown=\"onMouseDown\"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"booking-booking-note-popup-title\"\n\t\t\t\t\tdata-element=\"booking-note-popup-title\"\n\t\t\t\t\t:data-id=\"bookingId\"\n\t\t\t\t>\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_NOTE_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<textarea\n\t\t\t\t\tv-model=\"note\"\n\t\t\t\t\tclass=\"booking-booking-note-popup-textarea\"\n\t\t\t\t\t:placeholder=\"loc('BOOKING_BOOKING_NOTE_HINT')\"\n\t\t\t\t\t:disabled=\"!isEditMode\"\n\t\t\t\t\tdata-element=\"booking-note-popup-textarea\"\n\t\t\t\t\t:data-id=\"bookingId\"\n\t\t\t\t\t:data-disabled=\"!isEditMode\"\n\t\t\t\t\tref=\"textarea\"\n\t\t\t\t></textarea>\n\t\t\t\t<div v-if=\"isEditMode\" class=\"booking-booking-note-popup-buttons\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\t:dataset=\"{id: bookingId, element: 'booking-note-popup-save'}\"\n\t\t\t\t\t\t:text=\"loc('BOOKING_BOOKING_NOTE_SAVE')\"\n\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t:color=\"ButtonColor.PRIMARY\"\n\t\t\t\t\t\t@click=\"saveNote\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Button\n\t\t\t\t\t\t:dataset=\"{id: bookingId, element: 'booking-note-popup-cancel'}\"\n\t\t\t\t\t\t:text=\"loc('BOOKING_BOOKING_NOTE_CANCEL')\"\n\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t:color=\"ButtonColor.LINK\"\n\t\t\t\t\t\t@click=\"closePopup\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\n\nimport type { BookingModel } from 'booking.model.bookings';\nimport { NotePopup } from '../../../../note/note-popup/note-popup';\nimport './note.css';\n\nexport const Note = {\n\temits: ['popupShown', 'popupClosed'],\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tisPopupShown: false,\n\t\t\tisEditMode: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t\thasNote(): boolean\n\t\t{\n\t\t\treturn Boolean(this.booking.note);\n\t\t},\n\t},\n\tmethods: {\n\t\tonMouseEnter(): void\n\t\t{\n\t\t\tthis.showNoteTimeout = setTimeout(() => this.showViewPopup(), 100);\n\t\t},\n\t\tonMouseLeave(): void\n\t\t{\n\t\t\tclearTimeout(this.showNoteTimeout);\n\t\t\tthis.closeViewPopup();\n\t\t},\n\t\tshowViewPopup(): void\n\t\t{\n\t\t\tif (this.isPopupShown || !this.hasNote)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isEditMode = false;\n\t\t\tthis.showPopup();\n\t\t},\n\t\tcloseViewPopup(): void\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.closePopup();\n\t\t},\n\t\tshowEditPopup(): void\n\t\t{\n\t\t\tthis.isEditMode = true;\n\t\t\tthis.showPopup();\n\t\t},\n\t\tcloseEditPopup(): void\n\t\t{\n\t\t\tif (!this.isEditMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.closePopup();\n\t\t},\n\t\tshowPopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = true;\n\t\t\tthis.$emit('popupShown');\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = false;\n\t\t\tthis.$emit('popupClosed');\n\t\t},\n\t},\n\tcomponents: {\n\t\tNotePopup,\n\t\tIcon,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-actions-popup__item-client-note\"\n\t\t\tdata-element=\"booking-menu-note\"\n\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t:data-has-note=\"hasNote\"\n\t\t\t:class=\"{'--empty': !hasNote}\"\n\t\t\tref=\"note\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"booking-actions-popup__item-client-note-inner\"\n\t\t\t\tdata-element=\"booking-menu-note-add\"\n\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t@mouseenter=\"onMouseEnter\"\n\t\t\t\t@mouseleave=\"onMouseLeave\"\n\t\t\t\t@click=\"() => hasNote ? showViewPopup() : showEditPopup()\"\n\t\t\t>\n\t\t\t\t<template v-if=\"hasNote\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"booking-actions-popup__item-client-note-text\"\n\t\t\t\t\t\tdata-element=\"booking-menu-note-text\"\n\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ booking.note }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"isFeatureEnabled\"\n\t\t\t\t\t\tclass=\"booking-actions-popup__item-client-note-edit\"\n\t\t\t\t\t\tdata-element=\"booking-menu-note-edit\"\n\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\t@click=\"showEditPopup\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Icon :name=\"IconSet.PENCIL_40\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<Icon :name=\"IconSet.PLUS_20\"/>\n\t\t\t\t\t<div class=\"booking-actions-popup__item-client-note-text\">\n\t\t\t\t\t\t{{ loc('BB_ACTIONS_POPUP_ADD_NOTE') }}\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t\t<NotePopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:isEditMode=\"isEditMode && isFeatureEnabled\"\n\t\t\t:bookingId=\"bookingId\"\n\t\t\t:bindElement=\"() => $refs.note\"\n\t\t\t@close=\"closeEditPopup\"\n\t\t/>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { hint } from 'ui.vue3.directives.hint';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\nimport { limit } from 'booking.lib.limit';\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'booking.component.button';\nimport { ClientPopup } from 'booking.component.client-popup';\nimport { Model } from 'booking.const';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { ClientData } from 'booking.model.clients';\n\nimport './client.css';\n\nexport const Empty = {\n\temits: ['popupShown', 'popupClosed'],\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdirectives: { hint },\n\tcomponents: {\n\t\tButton,\n\t\tIcon,\n\t\tClientPopup,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tButtonIcon,\n\t\t\tisLoading: true,\n\t\t\tshownClientPopup: false,\n\t\t};\n\t},\n\tmethods: {\n\t\tshowClientPopup(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.shownClientPopup = true;\n\t\t\tthis.$emit('popupShown');\n\t\t},\n\t\thideClientPopup(): void\n\t\t{\n\t\t\tthis.shownClientPopup = false;\n\t\t\tthis.$emit('popupClosed');\n\t\t},\n\t\tasync addClientsToBook(clients: ClientData[]): Promise<void>\n\t\t{\n\t\t\tconst booking = this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t\tawait bookingService.update({\n\t\t\t\tid: booking.id,\n\t\t\t\tclients,\n\t\t\t});\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\tbtnIcon(): string\n\t\t{\n\t\t\treturn this.isFeatureEnabled ? ButtonIcon.ADD : ButtonIcon.LOCK;\n\t\t},\n\t\tuserIcon(): string\n\t\t{\n\t\t\treturn IconSet.PERSON;\n\t\t},\n\t\tpersonSize(): number\n\t\t{\n\t\t\treturn 26;\n\t\t},\n\t\tcallIcon(): string\n\t\t{\n\t\t\treturn IconSet.TELEPHONY_HANDSET_1;\n\t\t},\n\t\tmessageIcon(): string\n\t\t{\n\t\t\treturn IconSet.CHATS_1;\n\t\t},\n\t\ticonSize(): number\n\t\t{\n\t\t\treturn 20;\n\t\t},\n\t\ticonColor(): string\n\t\t{\n\t\t\treturn 'var(--ui-color-palette-gray-20)';\n\t\t},\n\t\tsoonHint(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.loc('BOOKING_BOOKING_SOON_HINT'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\toffsetLeft: -60,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-actions-popup__item-client-icon-container\">\n\t\t\t<div class=\"booking-actions-popup__item-client-icon\">\n\t\t\t\t<Icon :name=\"userIcon\" :size=\"personSize\" :color=\"iconColor\"/>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"booking-actions-popup__item-client-info --empty\">\n\t\t\t<div class=\"booking-actions-popup__item-client-info-label --empty\">\n\t\t\t\t{{loc('BB_ACTIONS_POPUP_CLIENT_EMPTY_NAME_LABEL')}}\n\t\t\t</div>\n\t\t\t<div class=\"booking-actions-popup__item-client-info-empty\">\n\t\t\t\t<div></div>\n\t\t\t\t<div></div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"booking-actions-popup-item-buttons booking-actions-popup__item-client-info-btn\"\n\t\t\t\tref=\"clientButton\"\n\t\t\t>\n\t\t\t\t<Button\n\t\t\t\t\t:text=\"loc('BB_ACTIONS_POPUP_CLIENT_BTN_EMPTY_LABEL')\"\n\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t:color=\"ButtonColor.PRIMARY\"\n\t\t\t\t\t:icon=\"btnIcon\"\n\t\t\t\t\t:round=\"true\"\n\t\t\t\t\t@click=\"showClientPopup\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<ClientPopup\n\t\t\t\tv-if=\"shownClientPopup\"\n\t\t\t\t:bindElement=\"this.$refs.clientButton\"\n\t\t\t\t@create=\"addClientsToBook\"\n\t\t\t\t@close=\"hideClientPopup\"\n\t\t\t/>\n\t\t</div>\n\t\t<div v-hint=\"soonHint\" class=\"booking-actions-popup__item-client-action\">\n\t\t\t<Icon :name=\"callIcon\" :size=\"iconSize\" :color=\"iconColor\"/>\n\t\t\t<Icon :name=\"messageIcon\" :size=\"iconSize\" :color=\"iconColor\"/>\n\t\t</div>\n\t`,\n};\n","import { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'booking.component.button';\nimport { CrmEntity, Model } from 'booking.const';\nimport { ClientPopup, type CurrentClient } from 'booking.component.client-popup';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { ClientData, ClientModel } from 'booking.model.clients';\n\nexport const EditClientButton = {\n\tname: 'EditClientButton',\n\temits: ['visible', 'invisible'],\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { isClientPopupShowed: boolean }\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tButtonIcon,\n\t\t\tisClientPopupShowed: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t\tcurrentClient(): CurrentClient\n\t\t{\n\t\t\tconst getByClientData = this.$store.getters[`${Model.Clients}/getByClientData`];\n\t\t\tconst client: { contact: ?ClientModel, company: ?ClientModel } = {\n\t\t\t\tcontact: null,\n\t\t\t\tcompany: null,\n\t\t\t};\n\n\t\t\t(this.booking.clients || []).map((clientData) => getByClientData(clientData))\n\t\t\t\t.forEach((clientModel) => {\n\t\t\t\t\tif (clientModel.type.code === CrmEntity.Contact)\n\t\t\t\t\t{\n\t\t\t\t\t\tclient.contact = clientModel;\n\t\t\t\t\t}\n\t\t\t\t\telse if (clientModel.type.code === CrmEntity.Company)\n\t\t\t\t\t{\n\t\t\t\t\t\tclient.company = clientModel;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\treturn client;\n\t\t},\n\t},\n\tmethods: {\n\t\tasync updateClient(clients: ClientData[]): Promise<void>\n\t\t{\n\t\t\tawait bookingService.update({\n\t\t\t\tid: this.booking.id,\n\t\t\t\tclients,\n\t\t\t});\n\t\t},\n\t\tshowPopup(): void\n\t\t{\n\t\t\tthis.isClientPopupShowed = true;\n\t\t\tthis.$emit('visible');\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.isClientPopupShowed = false;\n\t\t\tthis.$emit('invisible');\n\t\t},\n\t},\n\tcomponents: {\n\t\tClientPopup,\n\t\tButton,\n\t\tIcon,\n\t},\n\ttemplate: `\n\t\t<Button\n\t\t\tdata-element=\"booking-menu-client-edit\"\n\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t:color=\"ButtonColor.LIGHT\"\n\t\t\t:round=\"true\"\n\t\t\tref=\"editClientButton\"\n\t\t\t@click=\"showPopup\"\n\t\t>\n\t\t\t<Icon :name=\"IconSet.MORE\"/>\n\t\t</Button>\n\t\t<ClientPopup\n\t\t\tv-if=\"isClientPopupShowed\"\n\t\t\t:bind-element=\"$refs.editClientButton.$el\"\n\t\t\t:current-client=\"currentClient\"\n\t\t\t@create=\"updateClient\"\n\t\t\t@close=\"closePopup\"\n\t\t/>\n\t`,\n};\n","import { SidePanel } from 'main.sidepanel';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport { lazyload } from 'ui.vue3.directives.lazyload';\nimport { hint } from 'ui.vue3.directives.hint';\nimport 'ui.icon-set.main';\n\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'booking.component.button';\nimport { Loader } from 'booking.component.loader';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { ClientData, ClientModel } from 'booking.model.clients';\n\nimport { Note } from './note/note';\nimport { Empty } from './empty';\nimport { EditClientButton } from './edit-client-button/edit-client-button';\nimport './client.css';\n\nexport const Client = {\n\temits: ['freeze', 'unfreeze'],\n\tname: 'BookingActionsPopupClient',\n\tdirectives: { lazyload, hint },\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tButton,\n\t\tIcon,\n\t\tLoader,\n\t\tEmpty,\n\t\tNote,\n\t\tEditClientButton,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tButtonIcon,\n\t\t\tisLoading: true,\n\t\t};\n\t},\n\tasync mounted()\n\t{\n\t\tthis.isLoading = false;\n\t},\n\tmethods: {\n\t\topenClient(): void\n\t\t{\n\t\t\tconst entity = this.client.type.code.toLowerCase();\n\n\t\t\tSidePanel.Instance.open(`/crm/${entity}/details/${this.client.id}/`);\n\t\t},\n\t},\n\tcomputed: {\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t\tclient(): ClientModel | null\n\t\t{\n\t\t\tconst clientData: ClientData = this.booking.primaryClient;\n\n\t\t\treturn clientData ? this.$store.getters['clients/getByClientData'](clientData) : null;\n\t\t},\n\t\tclientPhone(): string\n\t\t{\n\t\t\tconst client: ClientModel = this.client;\n\n\t\t\treturn (\n\t\t\t\tclient.phones.length > 0\n\t\t\t\t\t? client.phones[0]\n\t\t\t\t\t: this.loc('BB_ACTIONS_POPUP_CLIENT_PHONE_LABEL')\n\t\t\t);\n\t\t},\n\t\tclientAvatar(): string\n\t\t{\n\t\t\tconst client: ClientModel = this.client;\n\n\t\t\treturn client.image;\n\t\t},\n\t\tclientStatus(): string\n\t\t{\n\t\t\tif (!this.client.isReturning)\n\t\t\t{\n\t\t\t\treturn this.loc('BB_ACTIONS_POPUP_CLIENT_STATUS_FIRST');\n\t\t\t}\n\n\t\t\treturn this.loc('BB_ACTIONS_POPUP_CLIENT_STATUS_RETURNING');\n\t\t},\n\t\tuserIcon(): string\n\t\t{\n\t\t\treturn IconSet.PERSON;\n\t\t},\n\t\tpersonSize(): number\n\t\t{\n\t\t\treturn 26;\n\t\t},\n\t\tcallIcon(): string\n\t\t{\n\t\t\treturn IconSet.TELEPHONY_HANDSET_1;\n\t\t},\n\t\tmessageIcon(): string\n\t\t{\n\t\t\treturn IconSet.CHATS_1;\n\t\t},\n\t\ticonSize(): number\n\t\t{\n\t\t\treturn 20;\n\t\t},\n\t\ticonColor(): string\n\t\t{\n\t\t\treturn 'var(--ui-color-palette-gray-20)';\n\t\t},\n\t\timageTypeClass(): string[] | string\n\t\t{\n\t\t\treturn '--user';\n\t\t},\n\t\tsoonHint(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.loc('BOOKING_BOOKING_SOON_HINT'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\toffsetLeft: -60,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-actions-popup__item booking-actions-popup__item-client\">\n\t\t\t<div class=\"booking-actions-popup__item-client-client\">\n\t\t\t\t<Loader v-if=\"isLoading\" class=\"booking-actions-popup__item-client-loader\" />\n\t\t\t\t<template v-else-if=\"client\">\n\t\t\t\t\t<div class=\"booking-actions-popup__item-client-icon-container\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"clientAvatar\"\n\t\t\t\t\t\t\tclass=\"booking-actions-popup-user__avatar\"\n\t\t\t\t\t\t\t:class=\"imageTypeClass\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tv-lazyload :data-lazyload-src=\"clientAvatar\"\n\t\t\t\t\t\t\t\tclass=\"booking-actions-popup-user__source\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-else class=\"booking-actions-popup__item-client-icon\">\n\t\t\t\t\t\t\t<Icon :name=\"userIcon\" :size=\"personSize\" :color=\"iconColor\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"booking-actions-popup__item-client-info\">\n\t\t\t\t\t\t<div class=\"booking-actions-popup__item-client-info-label\" :title=\"client.name\">\n\t\t\t\t\t\t\t{{ client.name }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"booking-actions-popup-item-info\">\n\t\t\t\t\t\t\t<div class=\"booking-actions-popup-item-subtitle\">\n\t\t\t\t\t\t\t\t{{ clientStatus }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"booking-actions-popup-item-subtitle\">\n\t\t\t\t\t\t\t\t{{ clientPhone }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"booking-actions-popup-item-buttons booking-actions-popup__item-client-info-btn\">\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tdata-element=\"booking-menu-client-open\"\n\t\t\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\t\t\tclass=\"booking-actions-popup-item-client-open-button\"\n\t\t\t\t\t\t\t\t:text=\"loc('BB_ACTIONS_POPUP_CLIENT_BTN_LABEL')\"\n\t\t\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t\t\t:color=\"ButtonColor.LIGHT_BORDER\"\n\t\t\t\t\t\t\t\t:round=\"true\"\n\t\t\t\t\t\t\t\t@click=\"openClient\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<EditClientButton\n\t\t\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t\t\t@visible=\"$emit('freeze')\"\n\t\t\t\t\t\t\t\t@invisible=\"$emit('unfreeze')\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-hint=\"soonHint\" class=\"booking-actions-popup__item-client-action\">\n\t\t\t\t\t\t<Icon :name=\"callIcon\" :size=\"iconSize\" :color=\"iconColor\"/>\n\t\t\t\t\t\t<Icon :name=\"messageIcon\" :size=\"iconSize\" :color=\"iconColor\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<Empty\n\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t@popupShown=\"$emit('freeze')\"\n\t\t\t\t\t\t@popupClosed=\"$emit('unfreeze')\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t\t<Note\n\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t@popupShown=\"$emit('freeze')\"\n\t\t\t\t@popupClosed=\"$emit('unfreeze')\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Event, Runtime, Uri } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { SidePanel } from 'main.sidepanel';\nimport { Menu, MenuManager } from 'main.popup';\nimport type { MenuItemOptions } from 'main.popup';\n\nimport { Dialog } from 'ui.entity-selector';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\nimport { limit } from 'booking.lib.limit';\nimport { CrmEntity, EntitySelectorEntity, HelpDesk, Model, Module } from 'booking.const';\nimport { helpDesk } from 'booking.lib.help-desk';\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'booking.component.button';\nimport { Loader } from 'booking.component.loader';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel, DealData } from 'booking.model.bookings';\nimport type { ClientData } from 'booking.model.clients';\n\nimport './deal.css';\n\nexport const Deal = {\n\tname: 'BookingActionsPopupDeal',\n\temits: ['freeze', 'unfreeze'],\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tButton,\n\t\tIcon,\n\t\tLoader,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tButtonIcon,\n\t\t\tisLoading: false,\n\t\t\tsaveDealDebounce: Runtime.debounce(this.saveDeal, 10, this),\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.dialog = new Dialog({\n\t\t\tcontext: 'BOOKING',\n\t\t\tmultiple: false,\n\t\t\ttargetNode: this.getDialogButton(),\n\t\t\twidth: 340,\n\t\t\theight: 340,\n\t\t\tenableSearch: true,\n\t\t\tdropdownMode: true,\n\t\t\tpreselectedItems: this.deal ? [[EntitySelectorEntity.Deal, this.deal.value]] : [],\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: EntitySelectorEntity.Deal,\n\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t},\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonShow: this.freeze,\n\t\t\t\tonHide: this.unfreeze,\n\t\t\t\t'Item:onSelect': this.itemChange,\n\t\t\t\t'Item:onDeselect': this.itemChange,\n\t\t\t},\n\t\t});\n\n\t\tEvent.bind(document, 'scroll', this.adjustPosition, true);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEvent.unbind(document, 'scroll', this.adjustPosition, true);\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\tmenuId(): string\n\t\t{\n\t\t\treturn 'booking-actions-popup-deal-menu';\n\t\t},\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t\tdeal(): DealData | null\n\t\t{\n\t\t\treturn this.booking.externalData?.find((data) => data.entityTypeId === CrmEntity.Deal) ?? null;\n\t\t},\n\t\tdateFormatted(): string\n\t\t{\n\t\t\tif (!this.deal.data.createdTimestamp)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst format = DateTimeFormat.getFormat('DAY_MONTH_FORMAT');\n\n\t\t\treturn DateTimeFormat.format(format, this.deal.data.createdTimestamp);\n\t\t},\n\t},\n\tmethods: {\n\t\tfreeze(): void\n\t\t{\n\t\t\tthis.$emit('freeze');\n\t\t},\n\t\tunfreeze(): void\n\t\t{\n\t\t\tif (this.dialog?.isOpen() || this.getMenu()?.getPopupWindow().isShown())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('unfreeze');\n\t\t},\n\t\tcreateDeal(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst bookingIdParamName = 'bookingId';\n\n\t\t\tconst createDealUrl = new Uri('/crm/deal/details/0/');\n\t\t\tcreateDealUrl.setQueryParam(bookingIdParamName, this.bookingId);\n\n\t\t\t(this.booking.clients ?? []).forEach((client: ClientData) => {\n\t\t\t\tconst paramName = {\n\t\t\t\t\t[CrmEntity.Contact]: 'contact_id',\n\t\t\t\t\t[CrmEntity.Company]: 'company_id',\n\t\t\t\t}[client.type.code];\n\n\t\t\t\tcreateDealUrl.setQueryParam(paramName, client.id);\n\t\t\t});\n\n\t\t\tSidePanel.Instance.open(createDealUrl.toString(), {\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: ({ slider }) => {\n\t\t\t\t\t\tslider.getWindow().BX.Event.EventEmitter.subscribe('onCrmEntityCreate', (event) => {\n\t\t\t\t\t\t\tconst [data] = event.getData();\n\n\t\t\t\t\t\t\tconst isDeal = data.entityTypeName === CrmEntity.Deal;\n\t\t\t\t\t\t\tconst bookingId = Number(new Uri(data.sliderUrl).getQueryParam(bookingIdParamName));\n\t\t\t\t\t\t\tif (!isDeal || bookingId !== this.bookingId)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst dealData = this.mapEntityInfoToDeal(data.entityInfo);\n\n\t\t\t\t\t\t\tthis.saveDealDebounce(dealData);\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tif (this.deal?.value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.saveDealDebounce(this.deal);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tshowMenu(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst bindElement = this.$refs.moreButton.$el;\n\t\t\tMenuManager.destroy(this.menuId);\n\t\t\tMenuManager.show({\n\t\t\t\tid: this.menuId,\n\t\t\t\tbindElement,\n\t\t\t\titems: this.getMenuItems(),\n\t\t\t\toffsetLeft: bindElement.offsetWidth / 2,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonShow: this.freeze,\n\t\t\t\t\tonAfterClose: this.unfreeze,\n\t\t\t\t\tonDestroy: this.unfreeze,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tgetMenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttext: this.loc('BB_ACTIONS_POPUP_DEAL_CHANGE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.showDealDialog();\n\t\t\t\t\t\tthis.getMenu().close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: this.loc('BB_ACTIONS_POPUP_DEAL_CLEAR'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.dialog?.deselectAll();\n\t\t\t\t\t\tthis.saveDealDebounce(null);\n\t\t\t\t\t\tthis.getMenu().close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tshowDealDialog(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.dialog.setTargetNode(this.getDialogButton());\n\t\t\tthis.dialog.show();\n\t\t},\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tthis.dialog.setTargetNode(this.getDialogButton());\n\t\t\tthis.dialog.adjustPosition();\n\t\t\tthis.getMenu()?.getPopupWindow().adjustPosition();\n\t\t},\n\t\tgetMenu(): Menu | null\n\t\t{\n\t\t\treturn MenuManager.getMenuById(this.menuId);\n\t\t},\n\t\topenDeal(): void\n\t\t{\n\t\t\tSidePanel.Instance.open(`/crm/deal/details/${this.deal.value}/`, {\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tif (this.deal?.value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvoid bookingService.getById(this.bookingId);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\titemChange(): void\n\t\t{\n\t\t\tconst dealData = this.getDealData();\n\n\t\t\tthis.saveDealDebounce(dealData);\n\n\t\t\tthis.dialog.hide();\n\t\t},\n\t\tgetDealData(): DealData | null\n\t\t{\n\t\t\tconst item = this.dialog.getSelectedItems()[0];\n\t\t\tif (!item)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.mapEntityInfoToDeal(item.getCustomData().get('entityInfo'));\n\t\t},\n\t\tmapEntityInfoToDeal(info: Object): DealData\n\t\t{\n\t\t\treturn {\n\t\t\t\tmoduleId: Module.Crm,\n\t\t\t\tentityTypeId: info.typeName,\n\t\t\t\tvalue: info.id,\n\t\t\t\tdata: [],\n\t\t\t};\n\t\t},\n\t\tsaveDeal(dealData: DealData | null): void\n\t\t{\n\t\t\tconst externalData = dealData ? [dealData] : [];\n\n\t\t\tvoid bookingService.update({\n\t\t\t\tid: this.booking.id,\n\t\t\t\texternalData,\n\t\t\t});\n\t\t},\n\t\tgetDialogButton(): HTMLElement\n\t\t{\n\t\t\treturn this.deal ? this.$refs.moreButton.$el : this.$refs.addButton.$el;\n\t\t},\n\t\tshowHelpDesk(): void\n\t\t{\n\t\t\thelpDesk.show(\n\t\t\t\tHelpDesk.BookingActionsDeal.code,\n\t\t\t\tHelpDesk.BookingActionsDeal.anchorCode,\n\t\t\t);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-actions-popup__item booking-actions-popup__item-deal-content\"\n\t\t\t:class=\"{ '--active': deal }\"\n\t\t>\n\t\t\t<Loader v-if=\"isLoading\" class=\"booking-actions-popup__item-deal-loader\" />\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"booking-actions-popup__item-deal\">\n\t\t\t\t\t<div class=\"booking-actions-popup-item-icon\">\n\t\t\t\t\t\t<Icon :name=\"IconSet.DEAL\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"booking-actions-popup-item-info\">\n\t\t\t\t\t\t<div class=\"booking-actions-popup-item-title\">\n\t\t\t\t\t\t\t<span>{{ loc('BB_ACTIONS_POPUP_DEAL_LABEL') }}</span>\n\t\t\t\t\t\t\t<Icon :name=\"IconSet.HELP\" @click=\"showHelpDesk\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<template v-if=\"deal\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"booking-actions-popup__item-deal-profit\"\n\t\t\t\t\t\t\t\tdata-element=\"booking-menu-deal-profit\"\n\t\t\t\t\t\t\t\t:data-profit=\"deal.data.opportunity\"\n\t\t\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\t\t\tv-html=\"deal.data.formattedOpportunity\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"booking-actions-popup-item-subtitle\"\n\t\t\t\t\t\t\t\tdata-element=\"booking-menu-deal-ts\"\n\t\t\t\t\t\t\t\t:data-ts=\"deal.data.createdTimestamp * 1000\"\n\t\t\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ dateFormatted }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class=\"booking-actions-popup-item-subtitle\">\n\t\t\t\t\t\t\t\t{{ loc('BB_ACTIONS_POPUP_DEAL_ADD_LABEL') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-actions-popup-item-buttons\">\n\t\t\t\t\t<template v-if=\"deal\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tdata-element=\"booking-menu-deal-open-button\"\n\t\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\t\tbuttonClass=\"ui-btn-shadow\"\n\t\t\t\t\t\t\t:text=\"loc('BB_ACTIONS_POPUP_DEAL_OPEN')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t\t:color=\"ButtonColor.LIGHT\"\n\t\t\t\t\t\t\t:round=\"true\"\n\t\t\t\t\t\t\t@click=\"openDeal\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tdata-element=\"booking-menu-deal-more-button\"\n\t\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\t\tbuttonClass=\"ui-btn-shadow\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t\t:color=\"ButtonColor.LIGHT\"\n\t\t\t\t\t\t\t:round=\"true\"\n\t\t\t\t\t\t\tref=\"moreButton\"\n\t\t\t\t\t\t\t@click=\"showMenu\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon :name=\"IconSet.MORE\"/>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tdata-element=\"booking-menu-deal-create-button\"\n\t\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\t\tclass=\"booking-actions-popup-plus-button\"\n\t\t\t\t\t\t\t:class=\"{'--lock': !isFeatureEnabled}\"\n\t\t\t\t\t\t\tbuttonClass=\"ui-btn-shadow\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t\t:color=\"ButtonColor.LIGHT\"\n\t\t\t\t\t\t\t:round=\"true\"\n\t\t\t\t\t\t\t@click=\"createDeal\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon v-if=\"isFeatureEnabled\" :name=\"IconSet.PLUS_30\"/>\n\t\t\t\t\t\t\t<Icon v-else :name=\"IconSet.LOCK\"/>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclass=\"booking-menu-deal-add-button\"\n\t\t\t\t\t\t\t:class=\"{'--lock': !isFeatureEnabled}\"\n\t\t\t\t\t\t\tdata-element=\"booking-menu-deal-add-button\"\n\t\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\t\tbuttonClass=\"ui-btn-shadow\"\n\t\t\t\t\t\t\t:text=\"loc('BB_ACTIONS_POPUP_DEAL_BTN_LABEL')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t\t:color=\"ButtonColor.LIGHT\"\n\t\t\t\t\t\t\t:round=\"true\"\n\t\t\t\t\t\t\tref=\"addButton\"\n\t\t\t\t\t\t\t@click=\"showDealDialog\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon v-if=\"!isFeatureEnabled\" :name=\"IconSet.LOCK\"/>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'booking.component.button';\nimport { Loader } from 'booking.component.loader';\nimport { bookingActionsService } from 'booking.provider.service.booking-actions-service';\n\nimport './document.css';\n\nexport const Document = {\n\tname: 'BookingActionsPopupDocument',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tButton,\n\t\tIcon,\n\t\tLoader,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tButtonIcon,\n\t\t\tisLoading: true,\n\t\t};\n\t},\n\tasync mounted()\n\t{\n\t\tawait bookingActionsService.getDocData();\n\n\t\tthis.isLoading = false;\n\t},\n\tmethods: {\n\t\tlinkDoc(): void {},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-actions-popup__item booking-actions-popup__item-doc-content --disabled\">\n\t\t\t<Loader v-if=\"isLoading\" class=\"booking-actions-popup__item-doc-loader\" />\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"booking-actions-popup__item-doc\">\n\t\t\t\t\t<div class=\"booking-actions-popup-item-icon\">\n\t\t\t\t\t\t<Icon :name=\"IconSet.DOCUMENT\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"booking-actions-popup-item-info\">\n\t\t\t\t\t\t<div class=\"booking-actions-popup-item-title\">\n\t\t\t\t\t\t\t<span>{{ loc('BB_ACTIONS_POPUP_DOC_LABEL') }}</span>\n\t\t\t\t\t\t\t<Icon :name=\"IconSet.HELP\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"booking-actions-popup-item-subtitle\">\n\t\t\t\t\t\t\t{{ loc('BB_ACTIONS_POPUP_DOC_ADD_LABEL') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-actions-popup-item-buttons\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclass=\"booking-actions-popup-plus-button\"\n\t\t\t\t\t\tbuttonClass=\"ui-btn-shadow\"\n\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t:color=\"ButtonColor.LIGHT\"\n\t\t\t\t\t\t:round=\"true\"\n\t\t\t\t\t\t:disabled=\"true\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Icon :name=\"IconSet.PLUS_30\"/>\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tbuttonClass=\"ui-btn-shadow\"\n\t\t\t\t\t\t:text=\"loc('BB_ACTIONS_POPUP_DOC_BTN_LABEL')\"\n\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t:color=\"ButtonColor.LIGHT\"\n\t\t\t\t\t\t:round=\"true\"\n\t\t\t\t\t\t@click=\"linkDoc\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<div class=\"booking-booking-actions-popup-label\">\n\t\t\t\t{{ loc('BB_ACTIONS_POPUP_LABEL_SOON') }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { limit } from 'booking.lib.limit';\nimport { Event } from 'main.core';\nimport { Menu, MenuManager } from 'main.popup';\nimport type { MenuItemOptions } from 'main.popup';\n\nimport { Notifier } from 'ui.notification-manager';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport { HelpDesk, Model } from 'booking.const';\nimport { helpDesk } from 'booking.lib.help-desk';\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'booking.component.button';\nimport { Loader } from 'booking.component.loader';\nimport { bookingActionsService } from 'booking.provider.service.booking-actions-service';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { ClientData, ClientModel } from 'booking.model.clients';\nimport type { MessageStatusModel } from 'booking.model.message-status';\n\nimport './message.css';\n\nexport const Message = {\n\temits: ['freeze', 'unfreeze'],\n\tname: 'BookingActionsPopupMessage',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tButton,\n\t\tIcon,\n\t\tLoader,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tButtonIcon,\n\t\t\tisLoading: true,\n\t\t\tisPrimaryClientIdUpdated: false,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tvoid this.fetchMessageData();\n\t},\n\twatch: {\n\t\tclientId(): void\n\t\t{\n\t\t\tthis.isPrimaryClientIdUpdated = true;\n\t\t},\n\t\tupdatedAt(): void\n\t\t{\n\t\t\tif (this.isPrimaryClientIdUpdated && this.isCurrentSenderAvailable)\n\t\t\t{\n\t\t\t\tvoid this.fetchMessageData();\n\n\t\t\t\tthis.isPrimaryClientIdUpdated = false;\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\topenMenu(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.status.isDisabled && this.isCurrentSenderAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.getMenu()?.getPopupWindow()?.isShown())\n\t\t\t{\n\t\t\t\tthis.destroyMenu();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuButton = this.$refs.button.$el;\n\t\t\tMenuManager.create(\n\t\t\t\tthis.menuId,\n\t\t\t\tmenuButton,\n\t\t\t\tthis.getMenuItems(),\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: menuButton.offsetWidth - menuButton.offsetWidth / 2,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonClose: this.destroyMenu,\n\t\t\t\t\t\tonDestroy: this.destroyMenu,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t).show();\n\n\t\t\tthis.$emit('freeze');\n\t\t\tEvent.bind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tgetMenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\treturn Object.values(this.dictionary).map(({ name, value }) => ({\n\t\t\t\ttext: name,\n\t\t\t\tonclick: () => this.sendMessage(value),\n\t\t\t\tdisabled: value === this.dictionary.Feedback.value,\n\t\t\t}));\n\t\t},\n\t\tasync sendMessage(notificationType: string): Promise<void>\n\t\t{\n\t\t\tthis.destroyMenu();\n\n\t\t\tconst result = await bookingActionsService.sendMessage(this.bookingId, notificationType);\n\n\t\t\tif (!result.isSuccess)\n\t\t\t{\n\t\t\t\tNotifier.notify({\n\t\t\t\t\tid: 'booking-message-send-error',\n\t\t\t\t\ttext: result.errorText,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvoid this.fetchMessageData();\n\t\t},\n\t\tdestroyMenu(): void\n\t\t{\n\t\t\tMenuManager.destroy(this.menuId);\n\t\t\tthis.$emit('unfreeze');\n\t\t\tEvent.unbind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tthis.getMenu()?.getPopupWindow()?.adjustPosition();\n\t\t},\n\t\tgetMenu(): Menu | null\n\t\t{\n\t\t\treturn MenuManager.getMenuById(this.menuId);\n\t\t},\n\t\tasync fetchMessageData(): Promise<void>\n\t\t{\n\t\t\tthis.isLoading = true;\n\n\t\t\tawait bookingActionsService.getMessageData(this.bookingId);\n\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\tshowHelpDesk(): void\n\t\t{\n\t\t\thelpDesk.show(\n\t\t\t\tHelpDesk.BookingActionsMessage.code,\n\t\t\t\tHelpDesk.BookingActionsMessage.anchorCode,\n\t\t\t);\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tdictionary: `${Model.Dictionary}/getNotifications`,\n\t\t\tisCurrentSenderAvailable: `${Model.Interface}/isCurrentSenderAvailable`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\tmenuId(): string\n\t\t{\n\t\t\treturn `booking-message-menu-${this.bookingId}`;\n\t\t},\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t\tclient(): ClientModel | null\n\t\t{\n\t\t\tconst clientData: ClientData = this.booking.primaryClient;\n\n\t\t\treturn clientData ? this.$store.getters['clients/getByClientData'](clientData) : null;\n\t\t},\n\t\tclientId(): number\n\t\t{\n\t\t\treturn this.booking.primaryClient?.id;\n\t\t},\n\t\tupdatedAt(): number\n\t\t{\n\t\t\treturn this.booking.updatedAt;\n\t\t},\n\t\tstatus(): MessageStatusModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.MessageStatus}/getById`](this.bookingId);\n\t\t},\n\t\ticonColor(): string\n\t\t{\n\t\t\tconst colorMap: Record<MessageStatusModel['semantic'], string> = {\n\t\t\t\tsuccess: '#ffffff',\n\t\t\t\tprimary: '#ffffff',\n\t\t\t\tfailure: '#ffffff',\n\t\t\t};\n\n\t\t\treturn colorMap[this.status.semantic] || '';\n\t\t},\n\t\tfailure(): boolean\n\t\t{\n\t\t\treturn this.status.semantic === 'failure';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-actions-popup__item booking-actions-popup__item-message-content\"\n\t\t\t:class=\"{'--disabled': !isCurrentSenderAvailable}\"\n\t\t>\n\t\t\t<Loader v-if=\"isLoading\" class=\"booking-actions-popup__item-message-loader\" />\n\t\t\t<template v-else>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"booking-actions-popup-item-icon\"\n\t\t\t\t\t:class=\"'--' + status.semantic\"\n\t\t\t\t>\n\t\t\t\t\t<Icon\n\t\t\t\t\t\t:name=\"IconSet.SMS\"\n\t\t\t\t\t\t:color=\"iconColor\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-actions-popup-item-info\">\n\t\t\t\t\t<div class=\"booking-actions-popup-item-title\">\n\t\t\t\t\t\t<span :title=\"status.title\">{{ status.title }}</span>\n\t\t\t\t\t\t<Icon :name=\"IconSet.HELP\" @click=\"showHelpDesk\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"booking-actions-popup-item-subtitle\"\n\t\t\t\t\t\t:class=\"'--' + status.semantic\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ status.description }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-actions-popup-item-buttons\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tdata-element=\"booking-menu-message-button\"\n\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\tclass=\"booking-actions-popup-button-with-chevron\"\n\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t'--lock': !isFeatureEnabled,\n\t\t\t\t\t\t\t'--disabled': status.isDisabled && isCurrentSenderAvailable\n\t\t\t\t\t\t}\"\n\t\t\t\t\t\tbuttonClass=\"ui-btn-shadow\"\n\t\t\t\t\t\t:text=\"loc('BB_ACTIONS_POPUP_MESSAGE_BUTTON_SEND')\"\n\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t:color=\"ButtonColor.LIGHT\"\n\t\t\t\t\t\t:round=\"true\"\n\t\t\t\t\t\tref=\"button\"\n\t\t\t\t\t\t@click=\"openMenu\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Icon v-if=\"isFeatureEnabled\" :name=\"IconSet.CHEVRON_DOWN\"/>\n\t\t\t\t\t\t<Icon v-else :name=\"IconSet.LOCK\"/>\n\t\t\t\t\t</Button>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"failure\"\n\t\t\t\t\t\tclass=\"booking-actions-popup-item-buttons-counter\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<div\n\t\t\t\tv-if=\"!isCurrentSenderAvailable\"\n\t\t\t\tclass=\"booking-booking-actions-popup-label\"\n\t\t\t>\n\t\t\t\t{{ loc('BB_ACTIONS_POPUP_LABEL_SOON') }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { limit } from 'booking.lib.limit';\nimport { Event } from 'main.core';\nimport { MenuManager, Menu } from 'main.popup';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\n\nimport { Model } from 'booking.const';\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'booking.component.button';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel } from 'booking.model.bookings';\n\nimport './confirmation-menu.css';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nexport const ConfirmationMenu = {\n\temits: ['popupShown', 'popupClosed'],\n\tname: 'ConfirmationMenu',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { menuPopup: Menu | null }\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tButtonIcon,\n\t\t\tmenuPopup: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `booking-confirmation-menu-${this.bookingId}`;\n\t\t},\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t},\n\tunmounted(): void\n\t{\n\t\tif (this.menuPopup)\n\t\t{\n\t\t\tthis.destroy();\n\t\t}\n\t},\n\tmethods: {\n\t\tupdateConfirmStatus(isConfirmed: boolean): void\n\t\t{\n\t\t\tvoid bookingService.update({\n\t\t\t\tid: this.booking.id,\n\t\t\t\tisConfirmed,\n\t\t\t});\n\t\t},\n\t\topenMenu(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.menuPopup?.popupWindow?.isShown())\n\t\t\t{\n\t\t\t\tthis.destroy();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuButton = this.$refs.button.$el;\n\t\t\tthis.menuPopup = MenuManager.create(\n\t\t\t\tthis.popupId,\n\t\t\t\tmenuButton,\n\t\t\t\tthis.getMenuItems(),\n\t\t\t\t{\n\t\t\t\t\tclassName: 'booking-confirmation-menu-popup',\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: menuButton.offsetWidth - menuButton.offsetWidth / 2,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcacheable: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonClose: () => this.destroy(),\n\t\t\t\t\t\tonDestroy: () => this.unbindScrollEvent(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t\tthis.menuPopup.show();\n\t\t\tthis.bindScrollEvent();\n\t\t\tthis.$emit('popupShown');\n\t\t},\n\t\tgetMenuItems(): Array\n\t\t{\n\t\t\tconst text = (\n\t\t\t\tthis.booking.isConfirmed\n\t\t\t\t\t? this.loc('BB_ACTIONS_POPUP_CONFIRMATION_MENU_NOT_CONFIRMED')\n\t\t\t\t\t: this.loc('BB_ACTIONS_POPUP_CONFIRMATION_MENU_CONFIRMED')\n\t\t\t);\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttext,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.updateConfirmStatus(!this.booking.isConfirmed);\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tdestroy(): void\n\t\t{\n\t\t\tMenuManager.destroy(this.popupId);\n\t\t\tthis.unbindScrollEvent();\n\t\t\tthis.$emit('popupClosed');\n\t\t},\n\t\tbindScrollEvent(): void\n\t\t{\n\t\t\tEvent.bind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tunbindScrollEvent(): void\n\t\t{\n\t\t\tEvent.unbind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tthis.menuPopup?.popupWindow?.adjustPosition();\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t\tButton,\n\t},\n\ttemplate: `\n\t\t<Button\n\t\t\tdata-element=\"booking-menu-confirmation-button\"\n\t\t\t:data-booking-id=\"bookingId\"\n\t\t\tclass=\"booking-actions-popup-button-with-chevron\"\n\t\t\t:class=\"{'--lock': !isFeatureEnabled}\"\n\t\t\tbuttonClass=\"ui-btn-shadow\"\n\t\t\t:text=\"loc('BB_ACTIONS_POPUP_CONFIRMATION_BTN_LABEL')\"\n\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t:color=\"ButtonColor.LIGHT\"\n\t\t\t:round=\"true\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"openMenu\"\n\t\t>\n\t\t\t<Icon v-if=\"isFeatureEnabled\" :name=\"IconSet.CHEVRON_DOWN\"/>\n\t\t\t<Icon v-else :name=\"IconSet.LOCK\"/>\n\t\t</Button>\n\t`,\n};\n","import { Loader } from 'booking.component.loader';\nimport { HelpDesk } from 'booking.const';\nimport { helpDesk } from 'booking.lib.help-desk';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport type { BookingModel } from 'booking.model.bookings';\nimport { ConfirmationMenu } from './confirmation-menu/confirmation-menu';\nimport './confirmation.css';\n\nexport const Confirmation = {\n\temits: ['freeze', 'unfreeze'],\n\tname: 'BookingActionsPopupConfirmation',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t\tLoader,\n\t\tConfirmationMenu,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tisLoading: true,\n\t\t};\n\t},\n\tasync mounted()\n\t{\n\t\tthis.isLoading = false;\n\t},\n\tmethods: {\n\t\tshowHelpDesk(): void\n\t\t{\n\t\t\thelpDesk.show(\n\t\t\t\tHelpDesk.BookingActionsConfirmation.code,\n\t\t\t\tHelpDesk.BookingActionsConfirmation.anchorCode,\n\t\t\t);\n\t\t},\n\t},\n\tcomputed: {\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t\ticonColor(): string\n\t\t{\n\t\t\tconst unconfirmedCounter = this.booking.counters\n\t\t\t\t.find((counter) => counter.type === 'booking_unconfirmed')?.value;\n\t\t\tconst delayedCounter = this.booking.counters\n\t\t\t\t.find((counter) => counter.type === 'booking_delayed')?.value;\n\n\t\t\tif (\n\t\t\t\tthis.booking.isConfirmed === false\n\t\t\t\t&& !unconfirmedCounter\n\t\t\t\t&& !delayedCounter\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn '#BDC1C6';\n\t\t\t}\n\n\t\t\treturn '#ffffff';\n\t\t},\n\t\tstateClass(): string\n\t\t{\n\t\t\tif (this.booking.isConfirmed)\n\t\t\t{\n\t\t\t\treturn '--confirmed';\n\t\t\t}\n\n\t\t\tconst unconfirmedCounter = this.booking.counters\n\t\t\t\t.find((counter) => counter.type === 'booking_unconfirmed')?.value;\n\t\t\tconst delayedCounter = this.booking.counters\n\t\t\t\t.find((counter) => counter.type === 'booking_delayed')?.value;\n\n\t\t\tif (unconfirmedCounter)\n\t\t\t{\n\t\t\t\treturn '--not-confirmed';\n\t\t\t}\n\n\t\t\tif (delayedCounter)\n\t\t\t{\n\t\t\t\treturn '--delayed';\n\t\t\t}\n\n\t\t\treturn '--awaiting';\n\t\t},\n\t\tstateText(): string\n\t\t{\n\t\t\tif (this.booking.isConfirmed)\n\t\t\t{\n\t\t\t\treturn this.loc('BB_ACTIONS_POPUP_CONFIRMATION_CONFIRMED');\n\t\t\t}\n\n\t\t\tconst unconfirmedCounter = this.booking.counters\n\t\t\t\t.find((counter) => counter.type === 'booking_unconfirmed')?.value;\n\t\t\tconst delayedCounter = this.booking.counters\n\t\t\t\t.find((counter) => counter.type === 'booking_delayed')?.value;\n\n\t\t\tif (unconfirmedCounter)\n\t\t\t{\n\t\t\t\treturn this.loc('BB_ACTIONS_POPUP_CONFIRMATION_NOT_CONFIRMED');\n\t\t\t}\n\n\t\t\tif (delayedCounter)\n\t\t\t{\n\t\t\t\treturn this.loc('BB_ACTIONS_POPUP_CONFIRMATION_DELAYED');\n\t\t\t}\n\n\t\t\treturn this.loc('BB_ACTIONS_POPUP_CONFIRMATION_AWAITING');\n\t\t},\n\t\thasBtnCounter(): boolean\n\t\t{\n\t\t\tif (this.booking.isConfirmed)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst unconfirmedCounter = this.booking.counters\n\t\t\t\t.find((counter) => counter.type === 'booking_unconfirmed')?.value;\n\t\t\tconst delayedCounter = this.booking.counters\n\t\t\t\t.find((counter) => counter.type === 'booking_delayed')?.value;\n\n\t\t\treturn Boolean(unconfirmedCounter || delayedCounter);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-actions-popup__item booking-actions-popup__item-confirmation-content\">\n\t\t\t<Loader v-if=\"isLoading\" class=\"booking-actions-popup__item-confirmation-loader\" />\n\t\t\t<template v-else>\n\t\t\t\t<div :class=\"['booking-actions-popup-item-icon', stateClass]\">\n\t\t\t\t\t<Icon :name=\"IconSet.CHECK\" :color=\"iconColor\"/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-actions-popup-item-info\">\n\t\t\t\t\t<div class=\"booking-actions-popup-item-title\">\n\t\t\t\t\t\t<span>{{ loc('BB_ACTIONS_POPUP_CONFIRMATION_LABEL') }}</span>\n\t\t\t\t\t\t<Icon :name=\"IconSet.HELP\" @click=\"showHelpDesk\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\t:class=\"['booking-actions-popup-item-subtitle', stateClass]\"\n\t\t\t\t\t\tdata-element=\"booking-menu-confirmation-status\"\n\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\t:data-confirmed=\"booking.isConfirmed\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ stateText }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-actions-popup-item-buttons\">\n\t\t\t\t\t<ConfirmationMenu\n\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t@popupShown=\"$emit('freeze')\"\n\t\t\t\t\t\t@popupClosed=\"$emit('unfreeze')\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"hasBtnCounter\"\n\t\t\t\t\t\tclass=\"booking-actions-popup-item-buttons-counter\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { limit } from 'booking.lib.limit';\nimport { Event } from 'main.core';\nimport type { MenuItemOptions } from 'main.popup';\nimport { MenuManager, Menu } from 'main.popup';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\n\nimport { Model } from 'booking.const';\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'booking.component.button';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel } from 'booking.model.bookings';\n\nexport const VisitMenu = {\n\temits: ['popupShown', 'popupClosed'],\n\tname: 'VisitMenu',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { menuPopup: Menu | null }\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tButtonIcon,\n\t\t\tmenuPopup: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tdictionary: `${Model.Dictionary}/getBookingVisitStatuses`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `booking-visit-menu-${this.bookingId}`;\n\t\t},\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t},\n\tunmounted(): void\n\t{\n\t\tif (this.menuPopup)\n\t\t{\n\t\t\tthis.destroy();\n\t\t}\n\t},\n\tmethods: {\n\t\tupdateVisitStatus(status: string): void\n\t\t{\n\t\t\tvoid bookingService.update({\n\t\t\t\tid: this.booking.id,\n\t\t\t\tvisitStatus: status,\n\t\t\t});\n\t\t},\n\t\topenMenu(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.menuPopup?.popupWindow?.isShown())\n\t\t\t{\n\t\t\t\tthis.destroy();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuButton = this.$refs.button.$el;\n\t\t\tthis.menuPopup = MenuManager.create(\n\t\t\t\tthis.popupId,\n\t\t\t\tmenuButton,\n\t\t\t\tthis.getMenuItems(),\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: menuButton.offsetWidth - menuButton.offsetWidth / 2,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonClose: () => this.destroy(),\n\t\t\t\t\t\tonDestroy: () => this.unbindScrollEvent(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t\tthis.menuPopup.show();\n\t\t\tthis.bindScrollEvent();\n\t\t\tthis.$emit('popupShown');\n\t\t},\n\t\tgetMenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttext: this.loc('BB_ACTIONS_POPUP_VISIT_BTN_LABEL_UNKNOWN'),\n\t\t\t\t\tonclick: () => this.setVisitStatus(this.dictionary.Unknown),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: this.loc('BB_ACTIONS_POPUP_VISIT_BTN_LABEL_VISITED'),\n\t\t\t\t\tonclick: () => this.setVisitStatus(this.dictionary.Visited),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: this.loc('BB_ACTIONS_POPUP_VISIT_BTN_LABEL_NOT_VISITED'),\n\t\t\t\t\tonclick: () => this.setVisitStatus(this.dictionary.NotVisited),\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tsetVisitStatus(status: string)\n\t\t{\n\t\t\tthis.updateVisitStatus(status);\n\t\t\tthis.destroy();\n\t\t},\n\t\tdestroy(): void\n\t\t{\n\t\t\tMenuManager.destroy(this.popupId);\n\t\t\tthis.unbindScrollEvent();\n\t\t\tthis.$emit('popupClosed');\n\t\t},\n\t\tbindScrollEvent(): void\n\t\t{\n\t\t\tEvent.bind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tunbindScrollEvent(): void\n\t\t{\n\t\t\tEvent.unbind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tthis.menuPopup?.popupWindow?.adjustPosition();\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t\tButton,\n\t},\n\ttemplate: `\n\t\t<Button\n\t\t\tdata-element=\"booking-menu-visit-button\"\n\t\t\t:data-booking-id=\"bookingId\"\n\t\t\tclass=\"booking-actions-popup-button-with-chevron\"\n\t\t\t:class=\"{'--lock': !isFeatureEnabled}\"\n\t\t\tbuttonClass=\"ui-btn-shadow\"\n\t\t\t:text=\"loc('BB_ACTIONS_POPUP_VISIT_BTN_LABEL')\"\n\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t:color=\"ButtonColor.LIGHT\"\n\t\t\t:round=\"true\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"openMenu\"\n\t\t>\n\t\t\t<Icon v-if=\"isFeatureEnabled\" :name=\"IconSet.CHEVRON_DOWN\"/>\n\t\t\t<Icon v-else :name=\"IconSet.LOCK\"/>\n\t\t</Button>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport { HelpDesk, Model } from 'booking.const';\nimport { helpDesk } from 'booking.lib.help-desk';\nimport { Loader } from 'booking.component.loader';\nimport type { BookingModel } from 'booking.model.bookings';\nimport { VisitMenu } from './visit-menu/visit-menu';\nimport './visit.css';\n\nexport const Visit = {\n\temits: ['freeze', 'unfreeze'],\n\tname: 'BookingActionsPopupVisit',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t\tLoader,\n\t\tVisitMenu,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tisLoading: true,\n\t\t};\n\t},\n\tasync mounted()\n\t{\n\t\tthis.isLoading = false;\n\t},\n\tmethods: {\n\t\tshowHelpDesk(): void\n\t\t{\n\t\t\thelpDesk.show(\n\t\t\t\tHelpDesk.BookingActionsVisit.code,\n\t\t\t\tHelpDesk.BookingActionsVisit.anchorCode,\n\t\t\t);\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tdictionary: `${Model.Dictionary}/getBookingVisitStatuses`,\n\t\t}),\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t\tgetLocVisitStatus(): string {\n\t\t\tswitch (this.booking.visitStatus)\n\t\t\t{\n\t\t\t\tcase this.dictionary.Visited:\n\t\t\t\t\treturn this.loc('BB_ACTIONS_POPUP_VISIT_BTN_LABEL_VISITED');\n\t\t\t\tcase this.dictionary.NotVisited:\n\t\t\t\t\treturn this.loc('BB_ACTIONS_POPUP_VISIT_BTN_LABEL_NOT_VISITED');\n\t\t\t\tdefault:\n\t\t\t\t\treturn (this.booking.clients.length === 0)\n\t\t\t\t\t\t? this.loc('BB_ACTIONS_POPUP_VISIT_ADD_LABEL')\n\t\t\t\t\t\t: this.loc('BB_ACTIONS_POPUP_VISIT_BTN_LABEL_UNKNOWN')\n\t\t\t\t\t;\n\t\t\t}\n\t\t},\n\t\tgetVisitInfoStyles(): string\n\t\t{\n\t\t\tswitch (this.booking.visitStatus)\n\t\t\t{\n\t\t\t\tcase this.dictionary.Visited:\n\t\t\t\t\treturn '--visited';\n\t\t\t\tcase this.dictionary.NotVisited:\n\t\t\t\t\treturn '--not-visited';\n\t\t\t\tdefault:\n\t\t\t\t\treturn '--unknown';\n\t\t\t}\n\t\t},\n\t\tcardIconColor(): string\n\t\t{\n\t\t\tswitch (this.booking.visitStatus)\n\t\t\t{\n\t\t\t\tcase this.dictionary.NotVisited:\n\t\t\t\tcase this.dictionary.Visited:\n\t\t\t\t\treturn 'var(--ui-color-palette-white-base)';\n\t\t\t\tdefault:\n\t\t\t\t\treturn 'var(--ui-color-palette-gray-20)';\n\t\t\t}\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\tswitch (this.booking.visitStatus)\n\t\t\t{\n\t\t\t\tcase this.dictionary.Visited:\n\t\t\t\t\treturn '--visited';\n\t\t\t\tcase this.dictionary.NotVisited:\n\t\t\t\t\treturn '--not-visited';\n\t\t\t\tdefault:\n\t\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-actions-popup__item booking-actions-popup__item-visit-content\">\n\t\t\t<Loader v-if=\"isLoading\" class=\"booking-actions-popup__item-visit-loader\" />\n\t\t\t<template v-else>\n\t\t\t\t<div :class=\"['booking-actions-popup-item-icon', iconClass]\">\n\t\t\t\t\t<Icon :name=\"IconSet.CUSTOMER_CARD\" :color=\"cardIconColor\"/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-actions-popup-item-info\">\n\t\t\t\t\t<div class=\"booking-actions-popup-item-title\">\n\t\t\t\t\t\t<span>{{ loc('BB_ACTIONS_POPUP_VISIT_LABEL') }}</span>\n\t\t\t\t\t\t<Icon :name=\"IconSet.HELP\" @click=\"showHelpDesk\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\t:class=\"['booking-actions-popup-item-subtitle', getVisitInfoStyles]\"\n\t\t\t\t\t\tdata-element=\"booking-menu-visit-status\"\n\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\t:data-visit-status=\"booking.visitStatus\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ getLocVisitStatus }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-actions-popup-item-buttons\">\n\t\t\t\t\t<VisitMenu\n\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t@popupShown=\"$emit('freeze')\"\n\t\t\t\t\t\t@popupClosed=\"$emit('unfreeze')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { hint } from 'ui.vue3.directives.hint';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\n\nimport './full-form.css';\n\nexport const FullForm = {\n\tname: 'BookingActionsPopupFullForm',\n\tdirectives: { hint },\n\tcomponents: {\n\t\tIcon,\n\t},\n\tcomputed: {\n\t\tarrowIcon(): string\n\t\t{\n\t\t\treturn IconSet.CHEVRON_RIGHT;\n\t\t},\n\t\tarrowIconSize(): number\n\t\t{\n\t\t\treturn 12;\n\t\t},\n\t\tarrowIconColor(): string\n\t\t{\n\t\t\treturn 'var(--ui-color-palette-gray-40)';\n\t\t},\n\t\tsoonHint(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.loc('BOOKING_BOOKING_SOON_HINT'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\toffsetLeft: 60,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tclick(): void {},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-actions-popup__item booking-actions-popup__item-full-form-content --disabled\"\n\t\t\t@click=\"click\"\n\t\t\tv-hint=\"soonHint\"\n\t\t>\n\t\t\t<div class=\"booking-actions-popup__item-full-form-label\">\n\t\t\t\t{{loc('BB_ACTIONS_POPUP_FULL_FORM_LABEL')}}\n\t\t\t</div>\n\t\t\t<div class=\"booking-actions-popup__item-full-form-icon\">\n\t\t\t\t<Icon :name=\"arrowIcon\" :size=\"arrowIconSize\" :color=\"arrowIconColor\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport './overbooking.css';\n\nexport const Overbooking = {\n\tname: 'BookingActionsPopupOverbooking',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t},\n\tmethods: {\n\t\topenOverbooking(): void {},\n\t\tsendToOverbookingList(): void {},\n\t},\n\tcomputed: {\n\t\tplusIcon(): string\n\t\t{\n\t\t\treturn IconSet.PLUS_20;\n\t\t},\n\t\tplusIconSize(): number\n\t\t{\n\t\t\treturn 20;\n\t\t},\n\t\tplusIconColor(): string\n\t\t{\n\t\t\treturn 'var(--ui-color-palette-gray-20)';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-actions-popup__item-overbooking-icon\">\n\t\t\t<Icon :name=\"plusIcon\" :size=\"plusIconSize\" :color=\"plusIconColor\"/>\n\t\t\t<div class=\"booking-actions-popup__item-overbooking-label\">\n\t\t\t\t{{loc('BB_ACTIONS_POPUP_OVERBOOKING_LABEL')}}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport './waitlist.css';\n\nexport const Waitlist = {\n\tname: 'BookingActionsPopupWaitlist',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t},\n\tcomputed: {\n\t\tclockIcon(): string\n\t\t{\n\t\t\treturn IconSet.BLACK_CLOCK;\n\t\t},\n\t\tclockIconSize(): number\n\t\t{\n\t\t\treturn 20;\n\t\t},\n\t\tclockIconColor(): string\n\t\t{\n\t\t\treturn 'var(--ui-color-palette-gray-20)';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-actions-popup__item-waitlist-icon --end\">\n\t\t\t<Icon :name=\"clockIcon\" :size=\"clockIconSize\" :color=\"clockIconColor\"/>\n\t\t\t<div class=\"booking-actions-popup__item-waitlist-label\">\n\t\t\t\t{{loc('BB_ACTIONS_POPUP_OVERBOOKING_LIST')}}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport { Model } from 'booking.const';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport './remove-btn.css';\n\nconst secondsToDelete = 5;\n\nexport const RemoveBtn = {\n\tname: 'BookingActionsPopupRemoveBtn',\n\temits: ['close'],\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { secondsLeft: number }\n\t{\n\t\treturn {\n\t\t\tsecondsLeft: secondsToDelete,\n\t\t};\n\t},\n\tcomponents: {\n\t\tIcon,\n\t},\n\tmethods: {\n\t\treset(intervalId: number, balloon: { close(): void }): void\n\t\t{\n\t\t\tclearInterval(intervalId);\n\t\t\tballoon.close();\n\t\t\tthis.secondsLeft = secondsToDelete;\n\t\t},\n\t\tremoveBooking(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\n\t\t\tconst balloon = BX.UI.Notification.Center.notify({\n\t\t\t\tid: this.balloonId,\n\t\t\t\tcontent: this.balloonTitle,\n\t\t\t\tactions: [{\n\t\t\t\t\ttitle: this.balloonCancelText,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tthis.reset(interval, balloon);\n\t\t\t\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/removeDeletingBooking`, this.bookingId);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}],\n\t\t\t});\n\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/addDeletingBooking`, this.bookingId);\n\n\t\t\tconst interval = setInterval(() => {\n\t\t\t\tthis.secondsLeft--;\n\n\t\t\t\tif (this.secondsLeft >= 1)\n\t\t\t\t{\n\t\t\t\t\tballoon.update({ content: this.balloonTitle });\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.reset(interval, balloon);\n\t\t\t\t\tvoid bookingService.delete(this.bookingId);\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t},\n\t},\n\tcomputed: {\n\t\tballoonId(): string\n\t\t{\n\t\t\treturn `booking-notify-${this.bookingId}`;\n\t\t},\n\t\tballoonCancelText(): string\n\t\t{\n\t\t\treturn this.loc('BB_BOOKING_REMOVE_BALLOON_CANCEL');\n\t\t},\n\t\tballoonTitle(): string\n\t\t{\n\t\t\treturn this.loc('BB_BOOKING_REMOVE_BALLOON_TEXT', { '#countdown#': this.secondsLeft });\n\t\t},\n\t\tremoveIcon(): string\n\t\t{\n\t\t\treturn IconSet.TRASH_BIN;\n\t\t},\n\t\tremoveIconSize(): number\n\t\t{\n\t\t\treturn 20;\n\t\t},\n\t\tremoveIconColor(): string\n\t\t{\n\t\t\treturn 'var(--ui-color-palette-gray-20)';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-actions-popup__item-remove-btn-icon --end\"\n\t\t\tdata-element=\"booking-menu-remove-button\"\n\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t@click=\"removeBooking\"\n\t\t>\n\t\t\t<div class=\"booking-actions-popup__item-overbooking-label\">\n\t\t\t\t{{ loc('BB_ACTIONS_POPUP_OVERBOOKING_REMOVE') }}\n\t\t\t</div>\n\t\t\t<Icon :name=\"removeIcon\" :size=\"removeIconSize\" :color=\"removeIconColor\"/>\n\t\t</div>\n\t`,\n};\n","import { Popup, PopupManager } from 'main.popup';\nimport type { PopupOptions } from 'main.popup';\nimport { StickyPopup } from 'booking.component.popup';\nimport type { BookingModel } from 'booking.model.bookings';\nimport { PopupMakerItem, PopupMaker } from 'booking.component.popup-maker';\n\nimport { Client } from './client/client';\nimport { Deal } from './deal/deal';\nimport { Document } from './document/document';\nimport { Message } from './message/message';\nimport { Confirmation } from './confirmation/confirmation';\nimport { Visit } from './visit/visit';\nimport { FullForm } from './full-form/full-form';\nimport { Overbooking } from './overbooking/overbooking';\nimport { Waitlist } from './waitlist/waitlist';\nimport { RemoveBtn } from './remove-btn/remove-btn';\nimport './actions-popup.css';\n\nexport const ActionsPopup = {\n\tname: 'BookingActionsPopup',\n\temits: ['close'],\n\tprops: {\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsoonTmp: false,\n\t\t};\n\t},\n\tbeforeCreate(): void\n\t{\n\t\tPopupManager.getPopups()\n\t\t\t.filter((popup: Popup) => /booking-booking-actions-popup/.test(popup.getId()))\n\t\t\t.forEach((popup: Popup) => popup.destroy())\n\t\t;\n\t},\n\tcomputed: {\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `booking-booking-actions-popup-${this.bookingId}`;\n\t\t},\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tclassName: 'booking-booking-actions-popup',\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\twidth: 325,\n\t\t\t\toffsetLeft: this.bindElement.offsetWidth,\n\t\t\t\toffsetTop: -200,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t};\n\t\t},\n\t\tcontentStructure(): Array<PopupMakerItem | Array<PopupMakerItem>>\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: 'client',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t},\n\t\t\t\t\tcomponent: Client,\n\t\t\t\t},\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'deal',\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomponent: Deal,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'document',\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomponent: Document,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\t{\n\t\t\t\t\tid: 'message',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t},\n\t\t\t\t\tcomponent: Message,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'confirmation',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t},\n\t\t\t\t\tcomponent: Confirmation,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'visit',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t},\n\t\t\t\t\tcomponent: Visit,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'fullForm',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t},\n\t\t\t\t\tcomponent: FullForm,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t},\n\tcomponents: {\n\t\tStickyPopup,\n\t\tPopupMaker,\n\t\tClient,\n\t\tDeal,\n\t\tDocument,\n\t\tMessage,\n\t\tConfirmation,\n\t\tVisit,\n\t\tFullForm,\n\t\tOverbooking,\n\t\tWaitlist,\n\t\tRemoveBtn,\n\t},\n\ttemplate: `\n\t\t<StickyPopup\n\t\t\tv-slot=\"{freeze, unfreeze}\"\n\t\t\t:id=\"popupId\"\n\t\t\t:config=\"config\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<PopupMaker\n\t\t\t\t:contentStructure=\"contentStructure\"\n\t\t\t\t@freeze=\"freeze\"\n\t\t\t\t@unfreeze=\"unfreeze\"\n\t\t\t/>\n\t\t\t<div class=\"booking-booking-actions-popup-footer\">\n\t\t\t\t<template v-if=\"soonTmp\">\n\t\t\t\t\t<Overbooking :bookingId />\n\t\t\t\t\t<Waitlist :bookingId />\n\t\t\t\t</template>\n\t\t\t\t<RemoveBtn :bookingId @close=\"$emit('close')\" />\n\t\t\t</div>\n\t\t</StickyPopup>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport { ActionsPopup } from './actions-popup/actions-popup';\n\nexport const Actions = {\n\tname: 'BookingActions',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tshowPopup: false,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.isEditingBookingMode && this.editingBookingId === this.bookingId)\n\t\t{\n\t\t\tthis.showPopup = true;\n\t\t}\n\t},\n\tcomputed: mapGetters({\n\t\teditingBookingId: `${Model.Interface}/editingBookingId`,\n\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t}),\n\tmethods: {\n\t\tclickHandler(): void\n\t\t{\n\t\t\tthis.showPopup = true;\n\t\t},\n\t},\n\tcomponents: {\n\t\tActionsPopup,\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tref=\"node\"\n\t\t\tclass=\"booking-booking-booking-actions\"\n\t\t\tdata-element=\"booking-booking-actions-button\"\n\t\t\t:data-id=\"bookingId\"\n\t\t\t:data-resource-id=\"resourceId\"\n\t\t\t@click=\"clickHandler\"\n\t\t>\n\t\t\t<div class=\"booking-booking-booking-actions-inner\">\n\t\t\t\t<div class=\"ui-icon-set --chevron-down\"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<ActionsPopup\n\t\t\tv-if=\"showPopup\"\n\t\t\t:bookingId=\"bookingId\"\n\t\t\t:bindElement=\"this.$refs.node\"\n\t\t\t@close=\"showPopup = false\"\n\t\t/>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport type { BookingModel } from 'booking.model.bookings';\nimport { NotePopup } from './note-popup/note-popup';\nimport './note.css';\n\nexport const Note = {\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t\tisEditMode: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t\thasNote(): boolean\n\t\t{\n\t\t\treturn Boolean(this.booking.note);\n\t\t},\n\t},\n\tmethods: {\n\t\tshowViewPopup(): void\n\t\t{\n\t\t\tif (this.isPopupShown || !this.hasNote)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isEditMode = false;\n\t\t\tthis.isPopupShown = true;\n\t\t},\n\t\tcloseViewPopup(): void\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isPopupShown = false;\n\t\t},\n\t\tshowEditPopup(): void\n\t\t{\n\t\t\tthis.isEditMode = true;\n\t\t\tthis.isPopupShown = true;\n\t\t},\n\t\tcloseEditPopup(): void\n\t\t{\n\t\t\tif (!this.isEditMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isPopupShown = false;\n\t\t},\n\t},\n\tcomponents: {\n\t\tNotePopup,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-booking-note\">\n\t\t\t<div\n\t\t\t\tclass=\"booking-booking-booking-note-button\"\n\t\t\t\t:class=\"{'--has-note': hasNote}\"\n\t\t\t\tdata-element=\"booking-booking-note-button\"\n\t\t\t\t:data-id=\"bookingId\"\n\t\t\t\t@click=\"showEditPopup\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --note\"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<NotePopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:isEditMode=\"isEditMode && isFeatureEnabled\"\n\t\t\t:bookingId=\"bookingId\"\n\t\t\t:bindElement=\"bindElement\"\n\t\t\t@close=\"closeEditPopup\"\n\t\t/>\n\t`,\n};\n","import { hint } from 'ui.vue3.directives.hint';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport './communication.css';\n\nexport const Communication = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t};\n\t},\n\tcomputed: {\n\t\tsoonHint(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.loc('BOOKING_BOOKING_SOON_HINT'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\toffsetLeft: -60,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\tdirectives: { hint },\n\tcomponents: {\n\t\tIcon,\n\t},\n\ttemplate: `\n\t\t<div v-hint=\"soonHint\" class=\"booking-booking-booking-communication\">\n\t\t\t<Icon :name=\"IconSet.TELEPHONY_HANDSET_1\"/>\n\t\t\t<Icon :name=\"IconSet.CHATS_2\"/>\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { PopupOptions } from 'main.popup';\nimport { Popup } from 'booking.component.popup';\nimport './disabled-popup.css';\n\nexport const DisabledPopup = {\n\temits: ['close'],\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.adjustPosition();\n\t\tsetTimeout(() => this.closePopup(), 3000);\n\t\tEvent.bind(document, 'scroll', this.adjustPosition, true);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEvent.unbind(document, 'scroll', this.adjustPosition, true);\n\t},\n\tcomputed: {\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `booking-booking-disabled-popup-${this.bookingId}-${this.resourceId}`;\n\t\t},\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tclassName: 'booking-booking-disabled-popup',\n\t\t\t\tbindElement: this.bindElement(),\n\t\t\t\twidth: this.bindElement().offsetWidth,\n\t\t\t\toffsetTop: -10,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tautoHide: true,\n\t\t\t\tdarkMode: true,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tthis.$refs.popup.adjustPosition();\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\ttemplate: `\n\t\t<Popup\n\t\t\t:id=\"popupId\"\n\t\t\t:config=\"config\"\n\t\t\tref=\"popup\"\n\t\t\t@close=\"closePopup\"\n\t\t>\n\t\t\t<div class=\"booking-booking-disabled-popup-content\">\n\t\t\t\t{{ loc('BOOKING_BOOKING_YOU_CANNOT_EDIT_THIS_BOOKING') }}\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\n\nimport { Counter as UiCounter, CounterSize, CounterColor } from 'booking.component.counter';\nimport { CrmEntity, Model } from 'booking.const';\nimport type { BookingModel, DealData } from 'booking.model.bookings';\nimport type { ClientModel, ClientData } from 'booking.model.clients';\n\nimport { grid } from '../../../../lib/grid/grid';\n\nimport { AddClient } from './add-client/add-client';\nimport { BookingTime } from './booking-time/booking-time';\nimport { Actions } from './actions/actions';\nimport { Note } from './note/note';\nimport { Communication } from './communication/communication';\nimport { DisabledPopup } from './disabled-popup/disabled-popup';\nimport type { BookingUiDuration } from './types';\nimport './booking.css';\n\nexport type { BookingUiDuration };\n\nconst BookingWidth = 280;\n\nexport const Booking = {\n\tname: 'Booking',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tnowTs: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\t/**\n\t\t * @param {BookingUiDuration[]} uiBookings\n\t\t */\n\t\tuiBookings: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tvisible: true,\n\t\t\tisDisabledPopupShown: false,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.updateVisibility();\n\t\tthis.updateVisibilityDuringTransition();\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\t\tzoom: `${Model.Interface}/zoom`,\n\t\t\tscroll: `${Model.Interface}/scroll`,\n\t\t\teditingBookingId: `${Model.Interface}/editingBookingId`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t}),\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t\tclient(): ClientModel\n\t\t{\n\t\t\tconst clientData: ClientData = this.booking.primaryClient;\n\n\t\t\treturn clientData ? this.$store.getters[`${Model.Clients}/getByClientData`](clientData) : null;\n\t\t},\n\t\tdeal(): DealData | null\n\t\t{\n\t\t\treturn this.booking.externalData?.find((data) => data.entityTypeId === CrmEntity.Deal) ?? null;\n\t\t},\n\t\tbookingName(): string\n\t\t{\n\t\t\treturn this.client ? this.client.name : this.booking.name;\n\t\t},\n\t\tleft(): number\n\t\t{\n\t\t\treturn grid.calculateLeft(this.resourceId);\n\t\t},\n\t\ttop(): number\n\t\t{\n\t\t\treturn grid.calculateTop(this.booking.dateFromTs);\n\t\t},\n\t\theight(): number\n\t\t{\n\t\t\treturn grid.calculateHeight(this.booking.dateFromTs, this.booking.dateToTs);\n\t\t},\n\t\trealHeight(): number\n\t\t{\n\t\t\treturn grid.calculateRealHeight(this.booking.dateFromTs, this.booking.dateToTs);\n\t\t},\n\t\tdisabled(): boolean\n\t\t{\n\t\t\treturn this.isEditingBookingMode && this.editingBookingId !== this.bookingId;\n\t\t},\n\t\tcounterOptions(): Object\n\t\t{\n\t\t\treturn Object.freeze({\n\t\t\t\tcolor: CounterColor.DANGER,\n\t\t\t\tsize: CounterSize.LARGE,\n\t\t\t});\n\t\t},\n\t\toverlappingBookings(): BookingUiDuration[]\n\t\t{\n\t\t\tconst { dateFromTs } = this.booking;\n\t\t\tconst uiBooking = this.uiBookings.find((booking) => dateFromTs === booking.fromTs);\n\n\t\t\tif (!uiBooking)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tconst { fromTs, toTs } = uiBooking;\n\n\t\t\treturn [\n\t\t\t\t...this.uiBookings.filter((booking) => fromTs > booking.fromTs && fromTs < booking.toTs),\n\t\t\t\tuiBooking,\n\t\t\t\t...this.uiBookings.filter((booking) => toTs > booking.fromTs && toTs < booking.toTs),\n\t\t\t];\n\t\t},\n\t\tbookingWidth(): number\n\t\t{\n\t\t\tconst overlappingBookingsCount = this.overlappingBookings.length;\n\n\t\t\treturn BookingWidth / (overlappingBookingsCount > 0 ? overlappingBookingsCount : 1);\n\t\t},\n\t\tbookingOffset(): number\n\t\t{\n\t\t\tconst index = this.overlappingBookings.findIndex(({ id }) => id === this.booking.id);\n\n\t\t\treturn this.bookingWidth * this.zoom * index;\n\t\t},\n\t\tshortView(): boolean\n\t\t{\n\t\t\treturn this.overlappingBookings.length > 1;\n\t\t},\n\t\tisExpiredBooking(): boolean\n\t\t{\n\t\t\treturn this.booking.dateToTs < this.nowTs;\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateVisibilityDuringTransition(): void\n\t\t{\n\t\t\tthis.animation?.stop();\n\t\t\tthis.animation = new BX.easing({\n\t\t\t\tduration: 200,\n\t\t\t\tstart: {},\n\t\t\t\tfinish: {},\n\t\t\t\tstep: this.updateVisibility,\n\t\t\t});\n\t\t\tthis.animation.animate();\n\t\t},\n\t\tupdateVisibility(): void\n\t\t{\n\t\t\tif (!this.$refs.container)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst rect = this.$refs.container.getBoundingClientRect();\n\t\t\tthis.visible = rect.right > 0 && rect.left < window.innerWidth;\n\t\t},\n\t\tgetBindElement(): HTMLElement\n\t\t{\n\t\t\treturn this.$refs.container;\n\t\t},\n\t\tonNoteMouseEnter(): void\n\t\t{\n\t\t\tthis.showNoteTimeout = setTimeout(() => this.$refs.note.showViewPopup(), 100);\n\t\t},\n\t\tonNoteMouseLeave(): void\n\t\t{\n\t\t\tclearTimeout(this.showNoteTimeout);\n\t\t\tthis.$refs.note.closeViewPopup();\n\t\t},\n\t\tonClick(event: PointerEvent): void\n\t\t{\n\t\t\tif (this.disabled)\n\t\t\t{\n\t\t\t\tthis.isDisabledPopupShown = true;\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tscroll(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tzoom(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tresourcesIds(): void\n\t\t{\n\t\t\tthis.updateVisibilityDuringTransition();\n\t\t},\n\t},\n\tcomponents: {\n\t\tAddClient,\n\t\tBookingTime,\n\t\tActions,\n\t\tNote,\n\t\tCommunication,\n\t\tUiCounter,\n\t\tDisabledPopup,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-booking\"\n\t\t\tdata-element=\"booking-booking\"\n\t\t\t:data-id=\"bookingId\"\n\t\t\t:data-resource-id=\"resourceId\"\n\t\t\t:style=\"{\n\t\t\t\t'--left': left + bookingOffset + 'px',\n\t\t\t\t'--top': top + 'px',\n\t\t\t\t'--height': height + 'px',\n\t\t\t\t'--width': bookingWidth + 'px',\n\t\t\t}\"\n\t\t\t:class=\"{\n\t\t\t\t'--zoom-is-less-than-08': zoom < 0.8,\n\t\t\t\t'--compact-mode': realHeight < 40 || zoom < 0.8,\n\t\t\t\t'--small': realHeight <= 12.5,\n\t\t\t\t'--short': shortView,\n\t\t\t\t'--disabled': disabled,\n\t\t\t\t'--confirmed': booking.isConfirmed,\n\t\t\t\t'--expired': isExpiredBooking,\n\t\t\t}\"\n\t\t\tref=\"container\"\n\t\t\t@click.capture=\"onClick\"\n\t\t>\n\t\t\t<div v-if=\"visible\" class=\"booking-booking-booking-padding\">\n\t\t\t\t<div class=\"booking-booking-booking-inner\">\n\t\t\t\t\t<div class=\"booking-booking-booking-content\">\n\t\t\t\t\t\t<div class=\"booking-booking-booking-content-row\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-show=\"!shortView\"\n\t\t\t\t\t\t\t\tclass=\"booking-booking-booking-name-container\"\n\t\t\t\t\t\t\t\t@mouseenter=\"onNoteMouseEnter\"\n\t\t\t\t\t\t\t\t@mouseleave=\"onNoteMouseLeave\"\n\t\t\t\t\t\t\t\t@click=\"$refs.note.showViewPopup()\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"booking-booking-booking-name\"\n\t\t\t\t\t\t\t\t\t:title=\"bookingName\"\n\t\t\t\t\t\t\t\t\tdata-element=\"booking-booking-name\"\n\t\t\t\t\t\t\t\t\t:data-id=\"bookingId\"\n\t\t\t\t\t\t\t\t\t:data-resource-id=\"resourceId\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{ bookingName }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Note\n\t\t\t\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t\t\t\t:bindElement=\"getBindElement\"\n\t\t\t\t\t\t\t\t\tref=\"note\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<BookingTime\n\t\t\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t\t\t:resourceId=\"resourceId\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-if=\"deal\"\n\t\t\t\t\t\t\t\tclass=\"booking-booking-booking-profit\"\n\t\t\t\t\t\t\t\tdata-element=\"booking-booking-profit\"\n\t\t\t\t\t\t\t\t:data-id=\"bookingId\"\n\t\t\t\t\t\t\t\t:data-resource-id=\"resourceId\"\n\t\t\t\t\t\t\t\t:data-profit=\"deal.data.opportunity\"\n\t\t\t\t\t\t\t\tv-html=\"deal.data.formattedOpportunity\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"booking-booking-booking-content-row --lower\">\n\t\t\t\t\t\t\t<BookingTime\n\t\t\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t\t\t:resourceId=\"resourceId\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Communication v-if=\"client\"/>\n\t\t\t\t\t\t\t<AddClient\n\t\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t\t\t:resourceId=\"resourceId\"\n\t\t\t\t\t\t\t\t:expired=\"isExpiredBooking\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Actions :bookingId=\"bookingId\" :resourceId=\"resourceId\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<UiCounter\n\t\t\t\tv-if=\"booking.counter > 0\"\n\t\t\t\t:value=\"booking.counter\"\n\t\t\t\t:color=\"counterOptions.color\"\n\t\t\t\t:size=\"counterOptions.size\"\n\t\t\t\tborder\n\t\t\t\tcounter-class=\"booking--counter\"\n\t\t\t/>\n\t\t\t<DisabledPopup\n\t\t\t\tv-if=\"isDisabledPopupShown\"\n\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t:resourceId=\"resourceId\"\n\t\t\t\t:bindElement=\"() => $refs.container\"\n\t\t\t\t@close=\"isDisabledPopupShown = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { Popup as MainPopup, PopupOptions } from 'main.popup';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Popup } from 'booking.component.popup';\nimport { BusySlot, Model } from 'booking.const';\nimport type { ResourceModel } from 'booking.model.resources';\nimport './busy-popup.css';\n\nexport const BusyPopup = {\n\temits: ['close'],\n\tprops: {\n\t\tbusySlot: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toffset: `${Model.Interface}/offset`,\n\t\t\tmousePosition: `${Model.Interface}/mousePosition`,\n\t\t}),\n\t\tresource(): ResourceModel\n\t\t{\n\t\t\tconst resourceId = (\n\t\t\t\tthis.busySlot.type === BusySlot.Intersection\n\t\t\t\t\t? this.busySlot.intersectingResourceId\n\t\t\t\t\t: this.busySlot.resourceId\n\t\t\t);\n\n\t\t\treturn this.$store.getters[`${Model.Resources}/getById`](resourceId);\n\t\t},\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `booking-booking-busy-popup-${this.busySlot.resourceId}`;\n\t\t},\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\tconst width = 200;\n\n\t\t\tconst angleLeft = MainPopup.getOption('angleMinBottom');\n\t\t\tconst angleOffset = width / 2 - angleLeft;\n\n\t\t\treturn {\n\t\t\t\tbindElement: this.mousePosition,\n\t\t\t\twidth,\n\t\t\t\tbackground: '#2878ca',\n\t\t\t\toffsetTop: -5,\n\t\t\t\toffsetLeft: -angleOffset + angleLeft,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tangle: {\n\t\t\t\t\toffset: angleOffset,\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t},\n\t\t\t\tangleBorderRadius: '4px 0',\n\t\t\t\tautoHide: false,\n\t\t\t};\n\t\t},\n\t\ttextFormatted(): string\n\t\t{\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\t\tconst messageId = (\n\t\t\t\tthis.busySlot.type === BusySlot.Intersection\n\t\t\t\t\t? 'BOOKING_BOOKING_INTERSECTING_RESOURCE_IS_BUSY'\n\t\t\t\t\t: 'BOOKING_BOOKING_RESOURCE_IS_BUSY'\n\t\t\t);\n\n\t\t\treturn this.loc(messageId, {\n\t\t\t\t'#RESOURCE#': this.resource.name,\n\t\t\t\t'#TIME_FROM#': DateTimeFormat.format(timeFormat, (this.busySlot.fromTs + this.offset) / 1000),\n\t\t\t\t'#TIME_TO#': DateTimeFormat.format(timeFormat, (this.busySlot.toTs + this.offset) / 1000),\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tconst popup: MainPopup = this.$refs.popup?.getPopupInstance();\n\t\t\tif (!popup)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpopup.setBindElement(this.mousePosition);\n\t\t\tpopup.adjustPosition();\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\twatch: {\n\t\tmousePosition: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.adjustPosition();\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\ttemplate: `\n\t\t<Popup\n\t\t\t:id=\"popupId\"\n\t\t\t:config=\"config\"\n\t\t\tref=\"popup\"\n\t\t\t@close=\"closePopup\"\n\t\t>\n\t\t\t<div class=\"booking-booking-busy-popup\">\n\t\t\t\t{{ textFormatted }}\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { Dom, Event, Type } from 'main.core';\nimport { createNamespacedHelpers } from 'ui.vue3.vuex';\nimport { BusySlot as BusySlotType, Model } from 'booking.const';\nimport { grid } from '../../../../lib/grid/grid';\n\nimport { BusyPopup } from './busy-popup/busy-popup';\nimport './busy-slot.css';\n\nconst { mapGetters: mapInterfaceGetters } = createNamespacedHelpers(Model.Interface);\n\nconst BookingBusySlotClassName = 'booking-booking-busy-slot';\n\ntype BusySlotData = {\n\tisPopupShown: boolean,\n};\n\nexport const BusySlot = {\n\tname: 'BusySlot',\n\tprops: {\n\t\tbusySlot: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): { BookingBusySlotClassName: string }\n\t{\n\t\treturn {\n\t\t\tBookingBusySlotClassName,\n\t\t};\n\t},\n\tdata(): BusySlotData\n\t{\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapInterfaceGetters({\n\t\t\tdisabledBusySlots: 'disabledBusySlots',\n\t\t\tisFilterMode: 'isFilterMode',\n\t\t\tisEditingBookingMode: 'isEditingBookingMode',\n\t\t}),\n\t\tisDisabled(): boolean\n\t\t{\n\t\t\tif (this.isFilterMode)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.busySlot.id in this.disabledBusySlots;\n\t\t},\n\t\tleft(): number\n\t\t{\n\t\t\treturn grid.calculateLeft(this.busySlot.resourceId);\n\t\t},\n\t\ttop(): number\n\t\t{\n\t\t\treturn grid.calculateTop(this.busySlot.fromTs);\n\t\t},\n\t\theight(): number\n\t\t{\n\t\t\treturn grid.calculateHeight(this.busySlot.fromTs, this.busySlot.toTs);\n\t\t},\n\t},\n\tmethods: {\n\t\tonClick(): void\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.isFilterMode\n\t\t\t\t|| this.isEditingBookingMode\n\t\t\t\t|| this.busySlot.type === BusySlotType.Intersection\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/addDisabledBusySlot`, this.busySlot);\n\t\t},\n\t\tonMouseEnter(): void\n\t\t{\n\t\t\tclearTimeout(this.showTimeout);\n\t\t\tthis.showTimeout = setTimeout(() => this.showPopup(), 300);\n\t\t\tEvent.unbind(document, 'mousemove', this.onMouseMove);\n\t\t\tEvent.bind(document, 'mousemove', this.onMouseMove);\n\t\t},\n\t\tonMouseMove(event: MouseEvent): void\n\t\t{\n\t\t\tif (this.cursorInsideContainer(event.target))\n\t\t\t{\n\t\t\t\tthis.updatePopup(event);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEvent.unbind(document, 'mousemove', this.onMouseMove);\n\t\t\t\tthis.closePopup();\n\t\t\t}\n\t\t},\n\t\tonMouseLeave(event: MouseEvent): void\n\t\t{\n\t\t\tif (event.relatedTarget?.closest('.popup-window')?.querySelector('.booking-booking-busy-popup'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEvent.unbind(document, 'mousemove', this.onMouseMove);\n\t\t\tthis.closePopup();\n\t\t},\n\t\tcursorInsideContainer(eventTarget: EventTarget): boolean\n\t\t{\n\t\t\treturn !Type.isNull(eventTarget) && Dom.hasClass(eventTarget, this.BookingBusySlotClassName);\n\t\t},\n\t\tupdatePopup(event: MouseEvent): void\n\t\t{\n\t\t\tconst rect = this.$refs.container?.getBoundingClientRect();\n\t\t\tif (\n\t\t\t\t!rect\n\t\t\t\t|| event.clientY > rect.top + rect.height\n\t\t\t\t|| event.clientY < rect.top\n\t\t\t\t|| event.clientX < rect.left\n\t\t\t\t|| event.clientX > rect.left + rect.width\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.closePopup();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.showTimeout ??= setTimeout(() => this.showPopup(), 300);\n\t\t},\n\t\tshowPopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = true;\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tclearTimeout(this.showTimeout);\n\t\t\tthis.showTimeout = null;\n\t\t\tthis.isPopupShown = false;\n\t\t},\n\t},\n\tcomponents: {\n\t\tBusyPopup,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"[BookingBusySlotClassName, {\n\t\t\t\t'--disabled': isDisabled\n\t\t\t}]\"\n\t\t\t:style=\"{\n\t\t\t\t'--left': left + 'px',\n\t\t\t\t'--top': top + 'px',\n\t\t\t\t'--height': height + 'px',\n\t\t\t}\"\n\t\t\tdata-element=\"booking-busy-slot\"\n\t\t\t:data-id=\"busySlot.resourceId\"\n\t\t\t:data-from=\"busySlot.fromTs\"\n\t\t\t:data-to=\"busySlot.toTs\"\n\t\t\tref=\"container\"\n\t\t\t@click.stop=\"onClick\"\n\t\t\t@mouseenter.stop=\"onMouseEnter\"\n\t\t\t@mouseleave.stop=\"onMouseLeave\"\n\t\t></div>\n\t\t<BusyPopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:busySlot=\"busySlot\"\n\t\t\t@close=\"closePopup\"\n\t\t/>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport { DateTimeFormat } from 'main.date';\nimport { Model } from 'booking.const';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport { limit } from 'booking.lib.limit';\nimport { grid } from '../../../lib/grid/grid';\nimport './base-cell.css';\n\n/**\n * @typedef {Object} Cell\n * @property {string} id\n * @property {number} fromTs\n * @property {number} toTs\n * @property {number} resourceId\n * @property {boolean} boundedToBottom\n */\nexport const BaseCell = {\n\tprops: {\n\t\t/** @type {Cell} */\n\t\tcell: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedCells: `${Model.Interface}/selectedCells`,\n\t\t\tzoom: `${Model.Interface}/zoom`,\n\t\t\tintersections: `${Model.Interface}/intersections`,\n\t\t\ttimezone: `${Model.Interface}/timezone`,\n\t\t\toffset: `${Model.Interface}/offset`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\tselected(): boolean\n\t\t{\n\t\t\treturn this.cell.id in this.selectedCells;\n\t\t},\n\t\thasSelectedCells(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.selectedCells).length > 0;\n\t\t},\n\t\ttimeFormatted(): string\n\t\t{\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\t\treturn this.loc('BOOKING_BOOKING_TIME_RANGE', {\n\t\t\t\t'#FROM#': DateTimeFormat.format(timeFormat, (this.cell.fromTs + this.offset) / 1000),\n\t\t\t\t'#TO#': DateTimeFormat.format(timeFormat, (this.cell.toTs + this.offset) / 1000),\n\t\t\t});\n\t\t},\n\t\theight(): number\n\t\t{\n\t\t\treturn grid.calculateRealHeight(this.cell.fromTs, this.cell.toTs);\n\t\t},\n\t},\n\tmethods: {\n\t\tonCellSelected({ target: { checked } }): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (checked)\n\t\t\t{\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/addSelectedCell`, this.cell);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/removeSelectedCell`, this.cell);\n\t\t\t}\n\t\t},\n\t\taddBooking(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setHoveredCell`, null);\n\n\t\t\tvoid bookingService.add({\n\t\t\t\tid: `tmp-id-${Date.now()}-${Math.random()}`,\n\t\t\t\tdateFromTs: this.cell.fromTs,\n\t\t\t\tdateToTs: this.cell.toTs,\n\t\t\t\tname: this.loc('BOOKING_BOOKING_DEFAULT_BOOKING_NAME'),\n\t\t\t\tresourcesIds: [...new Set([\n\t\t\t\t\tthis.cell.resourceId,\n\t\t\t\t\t...(this.intersections[0] ?? []),\n\t\t\t\t\t...(this.intersections[this.cell.resourceId] ?? []),\n\t\t\t\t])],\n\t\t\t\ttimezoneFrom: this.timezone,\n\t\t\t\ttimezoneTo: this.timezone,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-base-cell\"\n\t\t\t:class=\"{\n\t\t\t\t'--selected': selected,\n\t\t\t\t'--bounded-to-bottom': cell.boundedToBottom,\n\t\t\t\t'--height-is-less-than-40': height < 40,\n\t\t\t\t'--compact-mode': height < 40 || zoom < 0.8,\n\t\t\t\t'--small': height <= 12.5,\n\t\t\t}\"\n\t\t\t:style=\"{\n\t\t\t\t'--height': height + 'px',\n\t\t\t}\"\n\t\t\tdata-element=\"booking-base-cell\"\n\t\t\t:data-resource-id=\"cell.resourceId\"\n\t\t\t:data-from=\"cell.fromTs\"\n\t\t\t:data-to=\"cell.toTs\"\n\t\t\t:data-selected=\"selected\"\n\t\t>\n\t\t\t<div class=\"booking-booking-grid-cell-padding\">\n\t\t\t\t<div class=\"booking-booking-grid-cell-inner\">\n\t\t\t\t\t<label\n\t\t\t\t\t\tclass=\"booking-booking-grid-cell-time\"\n\t\t\t\t\t\tdata-element=\"booking-grid-cell-select-label\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"booking-booking-grid-cell-time-inner\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tclass=\"booking-booking-grid-cell-checkbox\"\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t:checked=\"selected\"\n\t\t\t\t\t\t\t\t@change=\"onCellSelected\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span data-element=\"booking-grid-cell-time\">\n\t\t\t\t\t\t\t\t{{ timeFormatted }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</label>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"!hasSelectedCells\"\n\t\t\t\t\t\tclass=\"booking-booking-grid-cell-select-button-container\"\n\t\t\t\t\t\tref=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"booking-booking-grid-cell-select-button\"\n\t\t\t\t\t\t\t:class=\"{'--lock': !isFeatureEnabled}\"\n\t\t\t\t\t\t\tdata-element=\"booking-grid-cell-add-button\"\n\t\t\t\t\t\t\t@click=\"addBooking\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"booking-booking-grid-cell-select-button-text\">\n\t\t\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_SELECT') }}\n\t\t\t\t\t\t\t\t<Icon v-if=\"!isFeatureEnabled\" :name=\"IconSet.LOCK\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-icon-set --chevron-right\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { grid } from '../../../../lib/grid/grid';\nimport { BaseCell } from '../../base-cell/base-cell';\nimport './cell.css';\n\n/**\n * @typedef {Object} Cell\n * @property {string} id\n * @property {number} fromTs\n * @property {number} toTs\n * @property {number} resourceId\n * @property {boolean} boundedToBottom\n */\nexport const Cell = {\n\tprops: {\n\t\t/** @type {Cell} */\n\t\tcell: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tleft(): number\n\t\t{\n\t\t\treturn grid.calculateLeft(this.cell.resourceId);\n\t\t},\n\t\ttop(): number\n\t\t{\n\t\t\treturn grid.calculateTop(this.cell.fromTs);\n\t\t},\n\t\theight(): number\n\t\t{\n\t\t\treturn grid.calculateHeight(this.cell.fromTs, this.cell.toTs);\n\t\t},\n\t},\n\tcomponents: {\n\t\tBaseCell,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-selected-cell\"\n\t\t\t:style=\"{\n\t\t\t\t'--left': left + 'px',\n\t\t\t\t'--top': top + 'px',\n\t\t\t\t'--height': height + 'px',\n\t\t\t}\"\n\t\t\t@mouseleave=\"$store.dispatch('interface/setHoveredCell', null)\"\n\t\t>\n\t\t\t<BaseCell\n\t\t\t\t:cell=\"cell\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { createNamespacedHelpers } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport type { BookingModel } from 'booking.model.bookings';\n\nimport { busySlots } from '../../../lib/busy-slots/busy-slots';\nimport type { BookingUiDuration } from './booking/types';\nimport { Booking } from './booking/booking';\nimport { BusySlot } from './busy-slot/busy-slot';\nimport { Cell } from './cell/cell';\nimport './bookings.css';\n\nconst { mapGetters: mapInterfaceGetters } = createNamespacedHelpers(Model.Interface);\n\nconst MinUiBookingDurationMs = 15 * 60 * 1000;\n\nexport const Bookings = {\n\tname: 'Bookings',\n\tdata(): { nowTs: number }\n\t{\n\t\treturn {\n\t\t\tnowTs: Date.now(),\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapInterfaceGetters({\n\t\t\tresourcesIds: 'resourcesIds',\n\t\t\tselectedDateTs: 'selectedDateTs',\n\t\t\tisFilterMode: 'isFilterMode',\n\t\t\tfilteredBookingsIds: 'filteredBookingsIds',\n\t\t\tselectedCells: 'selectedCells',\n\t\t\thoveredCell: 'hoveredCell',\n\t\t\tbusySlots: 'busySlots',\n\t\t}),\n\t\tbookingsHash(): string\n\t\t{\n\t\t\treturn JSON.stringify(this.bookings);\n\t\t},\n\t\tbookings(): BookingModel[]\n\t\t{\n\t\t\tconst dateTs = this.selectedDateTs;\n\n\t\t\tlet bookings = [];\n\t\t\tif (this.isFilterMode)\n\t\t\t{\n\t\t\t\tbookings = this.$store.getters[`${Model.Bookings}/getByDateAndIds`](dateTs, this.filteredBookingsIds);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbookings = this.$store.getters[`${Model.Bookings}/getByDateAndResources`](dateTs, this.resourcesIds);\n\t\t\t}\n\n\t\t\treturn bookings.flatMap((booking) => {\n\t\t\t\treturn booking.resourcesIds\n\t\t\t\t\t.filter((resourceId: number) => this.resourcesIds.includes(resourceId))\n\t\t\t\t\t.map((resourceId: number) => ({\n\t\t\t\t\t\t...booking,\n\t\t\t\t\t\tresourcesIds: [resourceId],\n\t\t\t\t\t}))\n\t\t\t\t;\n\t\t\t});\n\t\t},\n\t\tcells(): CellDto[]\n\t\t{\n\t\t\tconst cells = [...Object.values(this.selectedCells), this.hoveredCell];\n\t\t\tconst dateFromTs = this.selectedDateTs;\n\t\t\tconst dateToTs = new Date(dateFromTs).setDate(new Date(dateFromTs).getDate() + 1);\n\n\t\t\treturn cells.filter((cell: CellDto) => cell && cell.toTs > dateFromTs && dateToTs > cell.fromTs);\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.startInterval();\n\t},\n\tmethods: {\n\t\tgenerateBookingKey(booking: BookingModel): string\n\t\t{\n\t\t\treturn `${booking.id}-${booking.resourcesIds[0]}`;\n\t\t},\n\t\tgetUiBookings(resourceId: number): BookingUiDuration[]\n\t\t{\n\t\t\treturn this.bookings\n\t\t\t\t.filter((booking) => booking.resourcesIds?.[0] === resourceId)\n\t\t\t\t.map((booking) => {\n\t\t\t\t\tconst duration = booking.dateToTs - booking.dateFromTs;\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: booking.id,\n\t\t\t\t\t\tfromTs: booking.dateFromTs,\n\t\t\t\t\t\ttoTs: duration < MinUiBookingDurationMs\n\t\t\t\t\t\t\t? booking.dateFromTs + MinUiBookingDurationMs\n\t\t\t\t\t\t\t: booking.dateToTs\n\t\t\t\t\t\t,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t},\n\t\tstartInterval(): void\n\t\t{\n\t\t\tsetInterval(() => {\n\t\t\t\tthis.nowTs = Date.now();\n\t\t\t}, 5 * 1000);\n\t\t},\n\t},\n\twatch: {\n\t\tselectedDateTs(): void\n\t\t{\n\t\t\tvoid busySlots.loadBusySlots();\n\t\t},\n\t\tbookingsHash(): void\n\t\t{\n\t\t\tvoid busySlots.loadBusySlots();\n\t\t},\n\t\tresourcesIds(): void\n\t\t{\n\t\t\tvoid busySlots.loadBusySlots();\n\t\t},\n\t},\n\tcomponents: {\n\t\tBooking,\n\t\tBusySlot,\n\t\tCell,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-bookings\">\n\t\t\t<TransitionGroup name=\"booking-transition-booking\">\n\t\t\t\t<template v-for=\"booking of bookings\" :key=\"generateBookingKey(booking)\">\n\t\t\t\t\t<Booking\n\t\t\t\t\t\t:bookingId=\"booking.id\"\n\t\t\t\t\t\t:resourceId=\"booking.resourcesIds[0]\"\n\t\t\t\t\t\t:nowTs\n\t\t\t\t\t\t:uiBookings=\"getUiBookings(booking.resourcesIds[0])\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</TransitionGroup>\n\t\t\t<template v-for=\"busySlot of busySlots\" :key=\"busySlot.id\">\n\t\t\t\t<BusySlot\n\t\t\t\t\t:busySlot=\"busySlot\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<template v-for=\"cell of cells\" :key=\"cell.id\">\n\t\t\t\t<Cell\n\t\t\t\t\t:cell=\"cell\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport type { BookingModel } from 'booking.model.bookings';\n\nimport type { BusySlotDto } from '../../../../lib/busy-slots/busy-slots';\nimport type { CellDto, CellData } from './types';\nimport './cell.css';\n\nconst halfHour = 30 * 60 * 1000;\n\nexport const Cell = {\n\tname: 'Cell',\n\tprops: {\n\t\t/** @type {CellDto} */\n\t\tcell: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): CellData\n\t{\n\t\treturn {\n\t\t\thovered: false,\n\t\t\thalfOffset: 0,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tzoom: `${Model.Interface}/zoom`,\n\t\t\tdisabledBusySlots: `${Model.Interface}/disabledBusySlots`,\n\t\t\tselectedCells: `${Model.Interface}/selectedCells`,\n\t\t\tbookings: `${Model.Bookings}/get`,\n\t\t\tisFilterMode: `${Model.Interface}/isFilterMode`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\tbusySlots: `${Model.Interface}/busySlots`,\n\t\t}),\n\t\tactiveBusySlots(): BusySlotDto[]\n\t\t{\n\t\t\treturn this.busySlots.filter(({ id }) => !(id in this.disabledBusySlots));\n\t\t},\n\t\tisAvailable(): boolean\n\t\t{\n\t\t\tif (this.isFilterMode || this.isEditingBookingMode)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst { fromTs, toTs } = this.freeSpace;\n\n\t\t\tconst cellFromTs = this.cell.fromTs;\n\t\t\tconst cellHalfTs = this.cell.fromTs + halfHour;\n\n\t\t\treturn (toTs > cellFromTs || toTs > cellHalfTs) && (toTs - fromTs) >= this.duration;\n\t\t},\n\t\ttimeFormatted(): string\n\t\t{\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\t\treturn this.loc('BOOKING_BOOKING_TIME_RANGE', {\n\t\t\t\t'#FROM#': DateTimeFormat.format(timeFormat, this.fromTs / 1000),\n\t\t\t\t'#TO#': DateTimeFormat.format(timeFormat, this.toTs / 1000),\n\t\t\t});\n\t\t},\n\t\tfromTs(): number\n\t\t{\n\t\t\treturn Math.min(this.freeSpace.toTs - this.duration, this.cell.fromTs) + this.halfOffset;\n\t\t},\n\t\ttoTs(): number\n\t\t{\n\t\t\treturn this.fromTs + this.duration;\n\t\t},\n\t\tduration(): number\n\t\t{\n\t\t\treturn this.cell.toTs - this.cell.fromTs;\n\t\t},\n\t\tfreeSpace(): {fromTs: number, toTs: number}\n\t\t{\n\t\t\tlet maxFrom = 0;\n\t\t\tlet minTo = Infinity;\n\t\t\tfor (const { fromTs, toTs } of this.colliding)\n\t\t\t{\n\t\t\t\tif (this.cell.fromTs + halfHour > fromTs && this.cell.fromTs + halfHour < toTs)\n\t\t\t\t{\n\t\t\t\t\tmaxFrom = toTs;\n\t\t\t\t\tminTo = fromTs;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (toTs <= this.cell.fromTs + halfHour)\n\t\t\t\t{\n\t\t\t\t\tmaxFrom = Math.max(maxFrom, toTs);\n\t\t\t\t}\n\n\t\t\t\tif (fromTs >= this.cell.fromTs + halfHour)\n\t\t\t\t{\n\t\t\t\t\tminTo = Math.min(minTo, fromTs);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { fromTs: maxFrom, toTs: minTo };\n\t\t},\n\t\tcolliding(): {fromTs: number, toTs: number}[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t...this.bookings\n\t\t\t\t\t.filter((booking: BookingModel) => booking.resourcesIds.includes(this.cell.resourceId))\n\t\t\t\t\t.map(({ dateFromTs, dateToTs }) => ({ fromTs: dateFromTs, toTs: dateToTs })),\n\t\t\t\t...this.activeBusySlots\n\t\t\t\t\t.filter((busySlot: BusySlotDto) => busySlot.resourceId === this.cell.resourceId)\n\t\t\t\t\t.map(({ fromTs, toTs }) => ({ fromTs, toTs })),\n\t\t\t\t...Object.values(this.selectedCells)\n\t\t\t\t\t.filter((cell: CellDto) => cell.resourceId === this.cell.resourceId)\n\t\t\t\t\t.map(({ fromTs, toTs }) => ({ fromTs, toTs })),\n\t\t\t];\n\t\t},\n\t},\n\tmethods: {\n\t\tmouseEnterHandler(event: MouseEvent): void\n\t\t{\n\t\t\tthis.updateHalfHour(event);\n\t\t},\n\t\tmouseLeaveHandler(event: MouseEvent): void\n\t\t{\n\t\t\tconst nextHoveredCell = event.relatedTarget?.closest('.booking-booking-base-cell');\n\n\t\t\tif (!nextHoveredCell || nextHoveredCell?.dataset?.selected === 'true')\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setHoveredCell`, null);\n\t\t\t}\n\t\t},\n\t\tmouseMoveHandler(event: MouseEvent): void\n\t\t{\n\t\t\tthis.updateHalfHour(event);\n\t\t},\n\t\tupdateHalfHour(event: MouseEvent): void\n\t\t{\n\t\t\tif (this.$refs.button?.contains(event.target))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst clientY = event.clientY - window.scrollY;\n\t\t\tconst rect = this.$el.getBoundingClientRect();\n\t\t\tconst bottomHalf = clientY > (rect.top + rect.top + rect.height) / 2;\n\t\t\tconst canSubtractHalfHour = this.fromTs - this.halfOffset >= this.freeSpace.fromTs;\n\t\t\tconst canAddHalfHour = this.toTs - this.halfOffset + halfHour <= this.freeSpace.toTs;\n\n\t\t\tif ((bottomHalf && canAddHalfHour) || (!bottomHalf && !canSubtractHalfHour))\n\t\t\t{\n\t\t\t\tthis.halfOffset = halfHour;\n\t\t\t}\n\n\t\t\tif ((!bottomHalf && canSubtractHalfHour) || (bottomHalf && !canAddHalfHour))\n\t\t\t{\n\t\t\t\tthis.halfOffset = 0;\n\t\t\t}\n\n\t\t\tconst offsetNotMatchesHalf = (bottomHalf && this.halfOffset === 0) || (!bottomHalf && this.halfOffset !== 0);\n\n\t\t\tif (this.duration <= halfHour && offsetNotMatchesHalf)\n\t\t\t{\n\t\t\t\tthis.clearCell(event);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.hoverCell({\n\t\t\t\tid: `${this.cell.resourceId}-${this.fromTs}-${this.toTs}`,\n\t\t\t\tfromTs: this.fromTs,\n\t\t\t\ttoTs: this.toTs,\n\t\t\t\tresourceId: this.cell.resourceId,\n\t\t\t\tboundedToBottom: this.toTs === this.freeSpace.toTs,\n\t\t\t});\n\t\t},\n\t\tclearCell(event: MouseEvent): void\n\t\t{\n\t\t\tconst nextHoveredCell = event.relatedTarget?.closest('.booking-booking-base-cell');\n\n\t\t\tif (!nextHoveredCell || nextHoveredCell?.dataset?.selected === 'true')\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setHoveredCell`, null);\n\t\t\t}\n\t\t},\n\t\thoverCell(cell: CellDto): void\n\t\t{\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setHoveredCell`, null);\n\n\t\t\tif (this.isAvailable)\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setHoveredCell`, cell);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-grid-cell\"\n\t\t\tdata-element=\"booking-grid-cell\"\n\t\t\t:data-resource-id=\"cell.resourceId\"\n\t\t\t:data-from=\"cell.fromTs\"\n\t\t\t:data-to=\"cell.toTs\"\n\t\t\t@mouseenter=\"mouseEnterHandler\"\n\t\t\t@mouseleave=\"mouseLeaveHandler\"\n\t\t\t@mousemove=\"mouseMoveHandler\"\n\t\t>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport { expandOffHours } from '../../../../lib/expand-off-hours/expand-off-hours';\nimport './off-hours.css';\n\nexport const OffHours = {\n\tprops: {\n\t\tbottom: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: mapGetters({\n\t\toffHoursHover: `${Model.Interface}/offHoursHover`,\n\t\toffHoursExpanded: `${Model.Interface}/offHoursExpanded`,\n\t}),\n\tmethods: {\n\t\tanimateOffHours({ keepScroll }): void\n\t\t{\n\t\t\tif (this.offHoursExpanded)\n\t\t\t{\n\t\t\t\texpandOffHours.collapse();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\texpandOffHours.expand({ keepScroll });\n\t\t\t}\n\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setOffHoursExpanded`, !this.offHoursExpanded);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-grid-padding\">\n\t\t\t<div\n\t\t\t\tclass=\"booking-booking-column-off-hours\"\n\t\t\t\t:class=\"{'--bottom': bottom, '--hover': offHoursHover}\"\n\t\t\t\t@click=\"animateOffHours({ keepScroll: bottom })\"\n\t\t\t\t@mouseenter=\"$store.dispatch('interface/setOffHoursHover', true)\"\n\t\t\t\t@mouseleave=\"$store.dispatch('interface/setOffHoursHover', false)\"\n\t\t\t></div>\n\t\t</div>\n\t`,\n};\n","import { createNamespacedHelpers } from 'ui.vue3.vuex';\nimport { range } from 'booking.lib.range';\nimport { Model } from 'booking.const';\nimport type { ResourceModel } from 'booking.model.resources';\nimport { Cell } from './cell/cell';\nimport { OffHours } from './off-hours/off-hours';\nimport './column.css';\n\nconst { mapGetters: mapInterfaceGetters } = createNamespacedHelpers(Model.Interface);\n\nexport const Column = {\n\tprops: {\n\t\tresourceId: Number,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tvisible: true,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.updateVisibility();\n\t\tthis.updateVisibilityDuringTransition();\n\t},\n\tcomputed: {\n\t\t...mapInterfaceGetters({\n\t\t\tresourcesIds: 'resourcesIds',\n\t\t\tzoom: 'zoom',\n\t\t\tscroll: 'scroll',\n\t\t\tselectedDateTs: 'selectedDateTs',\n\t\t\toffHoursHover: 'offHoursHover',\n\t\t\toffHoursExpanded: 'offHoursExpanded',\n\t\t\tfromHour: 'fromHour',\n\t\t\ttoHour: 'toHour',\n\t\t\toffset: 'offset',\n\t\t}),\n\t\tresource(): ResourceModel\n\t\t{\n\t\t\treturn this.$store.getters['resources/getById'](this.resourceId);\n\t\t},\n\t\tfromMinutes(): number\n\t\t{\n\t\t\treturn this.fromHour * 60;\n\t\t},\n\t\ttoMinutes(): number\n\t\t{\n\t\t\treturn this.toHour * 60;\n\t\t},\n\t\tslotSize(): number\n\t\t{\n\t\t\treturn this.resource.slotRanges[0]?.slotSize ?? 60;\n\t\t},\n\t\toffHoursTopCells(): CellDto[]\n\t\t{\n\t\t\treturn this.cells.filter((it: CellDto) => it.minutes < this.fromMinutes);\n\t\t},\n\t\tworkTimeCells(): CellDto[]\n\t\t{\n\t\t\treturn this.cells.filter((it: CellDto) => it.minutes >= this.fromMinutes && it.minutes < this.toMinutes);\n\t\t},\n\t\toffHoursBottomCells(): CellDto[]\n\t\t{\n\t\t\treturn this.cells.filter((it: CellDto) => it.minutes >= this.toMinutes);\n\t\t},\n\t\tcells(): CellDto[]\n\t\t{\n\t\t\tconst hour = 3600 * 1000;\n\t\t\tconst from = this.selectedDateTs;\n\t\t\tconst to = new Date(from).setDate(new Date(from).getDate() + 1);\n\n\t\t\treturn range(from, to - hour, hour).map((fromTs) => {\n\t\t\t\tconst toTs = fromTs + this.slotSize * 60 * 1000;\n\n\t\t\t\treturn {\n\t\t\t\t\tid: `${this.resource.id}-${fromTs}-${toTs}`,\n\t\t\t\t\tfromTs,\n\t\t\t\t\ttoTs,\n\t\t\t\t\tminutes: new Date(fromTs + this.offset).getHours() * 60,\n\t\t\t\t\tresourceId: this.resource.id,\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateVisibilityDuringTransition(): void\n\t\t{\n\t\t\tthis.animation?.stop();\n\t\t\tthis.animation = new BX.easing({\n\t\t\t\tduration: 200,\n\t\t\t\tstart: {},\n\t\t\t\tfinish: {},\n\t\t\t\tstep: this.updateVisibility,\n\t\t\t});\n\t\t\tthis.animation.animate();\n\t\t},\n\t\tupdateVisibility(): void\n\t\t{\n\t\t\tconst rect = this.$el.getBoundingClientRect();\n\t\t\tthis.visible = rect.right > 0 && rect.left < window.innerWidth;\n\t\t},\n\t},\n\twatch: {\n\t\tscroll(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tzoom(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tresourcesIds(): void\n\t\t{\n\t\t\tthis.updateVisibilityDuringTransition();\n\t\t},\n\t},\n\tcomponents: {\n\t\tCell,\n\t\tOffHours,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-grid-column\"\n\t\t\tdata-element=\"booking-grid-column\"\n\t\t\t:data-id=\"resourceId\"\n\t\t>\n\t\t\t<template v-if=\"visible\">\n\t\t\t\t<OffHours/>\n\t\t\t\t<div class=\"booking-booking-grid-off-hours-cells\">\n\t\t\t\t\t<Cell v-for=\"cell of offHoursTopCells\" :key=\"cell.id\" :cell=\"cell\"/>\n\t\t\t\t</div>\n\t\t\t\t<Cell v-for=\"cell of workTimeCells\" :key=\"cell.id\" :cell=\"cell\"/>\n\t\t\t\t<div class=\"booking-booking-grid-off-hours-cells --bottom\">\n\t\t\t\t\t<Cell v-for=\"cell of offHoursBottomCells\" :key=\"cell.id\" :cell=\"cell\"/>\n\t\t\t\t</div>\n\t\t\t\t<OffHours :bottom=\"true\"/>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { Dom, Tag } from 'main.core';\nimport { Core } from 'booking.core';\nimport { Model } from 'booking.const';\nimport './maximize.css';\n\ntype Inset = {\n\tleft: number,\n\ttop: number,\n\tright: number,\n\tbottom: number,\n};\n\nconst duration = 200;\nconst counterPanelScopeClass = 'ui-counter-panel__scope';\nconst darkThemeClass = 'bitrix24-dark-theme';\n\nexport class Maximize\n{\n\t#slider;\n\t#label: HTMLElement;\n\t#overlay: HTMLElement;\n\n\tconstructor({ onOverlayClick })\n\t{\n\t\tthis.onOverlayClick = onOverlayClick;\n\t\tthis.#slider = new (BX.SidePanel.Manager.getSliderClass())('');\n\t\tthis.#label = this.#renderLabel(this.#slider);\n\t\tthis.#overlay = this.#renderOverlay(this.#label);\n\n\t\tif (top.BX)\n\t\t{\n\t\t\tthis.handleSliderClose = this.#handleSliderClose.bind(this);\n\t\t\ttop.BX.Event.EventEmitter.subscribe('SidePanel.Slider:onCloseComplete', this.handleSliderClose);\n\t\t\ttop.BX.Event.EventEmitter.subscribe('SidePanel.Slider:onDestroy', this.handleSliderClose);\n\t\t}\n\t}\n\n\t#handleSliderClose(): void\n\t{\n\t\tif (this.#isExpanded)\n\t\t{\n\t\t\tthis.#slider.applyHacks();\n\t\t\tBX.SidePanel.Instance.disablePageScrollbar();\n\t\t}\n\t}\n\n\t#renderLabel(slider): HTMLElement\n\t{\n\t\tslider.getLabel().setOnclick(this.onOverlayClick);\n\t\tDom.addClass(slider.getLabel().getContainer(), 'booking-booking-slider-label');\n\n\t\treturn slider.getLabel().getContainer();\n\t}\n\n\t#renderOverlay(label: HTMLElement): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"booking-booking-overlay\" onclick=\"${this.onOverlayClick}\">\n\t\t\t\t${label}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tget #appContainer(): HTMLElement\n\t{\n\t\treturn BX('content-table');\n\t}\n\n\tget #appHeader(): HTMLElement\n\t{\n\t\treturn document.querySelector('.page-header');\n\t}\n\n\tget #counterPanel(): HTMLElement\n\t{\n\t\treturn Core.getParams().counterPanelContainer.firstElementChild;\n\t}\n\n\tget #appContent(): HTMLElement\n\t{\n\t\treturn BX('workarea-content');\n\t}\n\n\tget #appContentPaddingBottomElement(): HTMLElement\n\t{\n\t\treturn BX('workarea')?.parentElement;\n\t}\n\n\tget #imBar(): HTMLElement\n\t{\n\t\treturn BX('bx-im-bar');\n\t}\n\n\tget #imBarWidth(): number\n\t{\n\t\treturn window.innerWidth - this.#imBar.getBoundingClientRect().left;\n\t}\n\n\tget #isExpanded(): boolean\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/expanded`];\n\t}\n\n\tasync maximize(): Promise<void>\n\t{\n\t\tawait Core.getStore().dispatch(`${Model.Interface}/setExpanded`, true);\n\n\t\tthis.#slider.applyHacks();\n\t\tBX.SidePanel.Instance.disablePageScrollbar();\n\n\t\tconst start = this.#getInset(this.#appContainer);\n\t\tDom.style(this.#appContainer, 'position', 'fixed');\n\t\tDom.style(this.#appContainer, 'inset', `0 0 0 ${this.#imBarWidth}px`);\n\t\tconst finish = this.#getInset(this.#appContainer);\n\n\t\tthis.#applyMaximizedStyles();\n\n\t\tDom.removeClass(this.#overlay, '--closing');\n\t\tDom.addClass(this.#overlay, '--opening');\n\t\tDom.append(this.#overlay, document.body);\n\t\tawait this.#animate(start, finish);\n\t}\n\n\tasync minimize(): Promise<void>\n\t{\n\t\tawait Core.getStore().dispatch(`${Model.Interface}/setExpanded`, false);\n\n\t\tthis.#slider.resetHacks();\n\t\tBX.SidePanel.Instance.enablePageScrollbar();\n\n\t\tconst start = this.#getInset(this.#appContainer);\n\t\tDom.style(this.#appContainer, 'position', null);\n\t\tconst finish = this.#getInset(this.#appContainer);\n\n\t\tthis.#applyMinimizedStyles();\n\n\t\tDom.removeClass(this.#overlay, '--opening');\n\t\tDom.addClass(this.#overlay, '--closing');\n\t\tDom.style(this.#appContainer, 'position', 'fixed');\n\t\tawait this.#animate(start, finish);\n\t\tDom.style(this.#appContainer, 'position', null);\n\t\tDom.remove(this.#overlay);\n\t}\n\n\t#getInset(container: HTMLElement): Inset\n\t{\n\t\tconst rect = container.getBoundingClientRect();\n\n\t\treturn {\n\t\t\tleft: rect.left,\n\t\t\ttop: rect.top,\n\t\t\tright: window.innerWidth - (rect.left + rect.width),\n\t\t\tbottom: window.innerHeight - (rect.top + rect.height),\n\t\t};\n\t}\n\n\t#animate(start: Inset, finish: Inset): Promise<void>\n\t{\n\t\treturn new Promise((complete) => new BX.easing({\n\t\t\tduration,\n\t\t\tstart,\n\t\t\tfinish,\n\t\t\tstep: ({ top, right, bottom, left }: Inset) => {\n\t\t\t\tDom.style(this.#appContainer, 'inset', `${top}px ${right}px ${bottom}px ${left}px`);\n\t\t\t\tDom.style(this.#label, 'top', `${top}px`);\n\t\t\t\tDom.style(this.#label, 'left', `${left}px`);\n\t\t\t},\n\t\t\tcomplete,\n\t\t}).animate());\n\t}\n\n\t#applyMaximizedStyles(): void\n\t{\n\t\tDom.removeClass(this.#counterPanel, counterPanelScopeClass);\n\t\tDom.addClass(this.#appContainer, darkThemeClass);\n\t\tDom.style(this.#appContainer, 'height', 'initial');\n\t\tDom.style(this.#appContainer, 'position', 'fixed');\n\t\tDom.style(this.#appContainer, 'clip-path', `inset(0 ${this.#imBarWidth}px 0 0)`);\n\t\tDom.style(this.#appContainer, 'background', 'var(--ui-color-palette-white-base)');\n\t\tDom.style(this.#appHeader, 'border-bottom', '1px solid var(--ui-color-base-10)');\n\t\tDom.style(this.#appHeader, 'max-width', '100%');\n\t\tDom.style(this.#appHeader.parentElement, 'padding-right', `${this.#imBarWidth}px`);\n\t\tDom.style(this.#appContent, 'margin', 0);\n\t\tDom.style(this.#appContent, 'border-radius', 0);\n\t\tDom.style(this.#appContentPaddingBottomElement, 'padding-bottom', 0);\n\t\tDom.style(this.#appContentPaddingBottomElement, 'padding-right', `${this.#imBarWidth}px`);\n\t\tDom.style(this.#overlay, '--right', `${this.#imBarWidth}px`);\n\t\tBX.ZIndexManager.register(this.#appContainer, { overlay: this.#overlay });\n\t}\n\n\t#applyMinimizedStyles(): void\n\t{\n\t\tDom.addClass(this.#counterPanel, counterPanelScopeClass);\n\t\tDom.removeClass(this.#appContainer, darkThemeClass);\n\t\tDom.style(this.#appContainer, 'position', null);\n\t\tDom.style(this.#appContainer, 'clip-path', null);\n\t\tDom.style(this.#appContainer, 'background', null);\n\t\tDom.style(this.#appHeader, 'border-bottom', null);\n\t\tDom.style(this.#appHeader, 'max-width', null);\n\t\tDom.style(this.#appHeader.parentElement, 'padding-right', null);\n\t\tDom.style(this.#appContent, 'margin', null);\n\t\tDom.style(this.#appContent, 'border-radius', null);\n\t\tDom.style(this.#appContentPaddingBottomElement, 'padding-bottom', null);\n\t\tDom.style(this.#appContentPaddingBottomElement, 'padding-right', null);\n\t\tBX.ZIndexManager.unregister(this.#appContainer);\n\t}\n}\n","import { Dom, Event } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Core } from 'booking.core';\nimport { AhaMoment, HelpDesk } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { Maximize } from '../../../lib/maximize/maximize';\nimport './scale-panel.css';\n\nexport const ScalePanel = {\n\tprops: {\n\t\tgetColumnsContainer: Function,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisSlider: Core.getParams().isSlider,\n\t\t\tmaximize: new Maximize({\n\t\t\t\tonOverlayClick: () => this.collapse(),\n\t\t\t}),\n\t\t\tdesiredZoom: this.$store.getters['interface/zoom'],\n\t\t\tminZoom: 0.5,\n\t\t\tmaxZoom: 1,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tzoom: 'interface/zoom',\n\t\t\texpanded: 'interface/expanded',\n\t\t}),\n\t\tzoomFormatted(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_ZOOM_PERCENT', {\n\t\t\t\t'#PERCENT#': Math.round(this.zoom * 100),\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\texpand(): void\n\t\t{\n\t\t\tvoid this.maximize.maximize();\n\t\t},\n\t\tcollapse(): void\n\t\t{\n\t\t\tvoid this.maximize.minimize();\n\t\t},\n\t\tfitToScreen(): void\n\t\t{\n\t\t\tconst sidebarPadding = 260;\n\t\t\tconst view = this.getColumnsContainer();\n\t\t\tconst zoomCoefficient = (view.offsetWidth - sidebarPadding) / (view.scrollWidth - sidebarPadding);\n\t\t\tconst newZoom = Math.floor(this.zoom * zoomCoefficient * 10) / 10;\n\n\t\t\tthis.zoomInto(newZoom);\n\t\t},\n\t\tzoomInto(zoomInto: number): void\n\t\t{\n\t\t\tconst noTransitionClass = '--booking-booking-no-transition';\n\t\t\tconst container = Core.getParams().container;\n\t\t\tconst maxAnimationDuration = 400;\n\n\t\t\tthis.desiredZoom = Math.max(this.minZoom, Math.min(this.maxZoom, zoomInto));\n\n\t\t\tif (this.zoom === this.desiredZoom)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.animation?.stop();\n\t\t\tDom.addClass(container, noTransitionClass);\n\t\t\tthis.animation = new BX.easing({\n\t\t\t\tduration: Math.abs(this.zoom - this.desiredZoom) / this.minZoom * maxAnimationDuration,\n\t\t\t\tstart: { zoom: this.zoom * 100 },\n\t\t\t\tfinish: { zoom: this.desiredZoom * 100 },\n\t\t\t\tstep: ({ zoom }) => this.$store.dispatch('interface/setZoom', zoom / 100),\n\t\t\t\tcomplete: () => Dom.removeClass(container, noTransitionClass),\n\t\t\t});\n\t\t\tthis.animation.animate();\n\t\t},\n\t\tasync onMouseDown(direction: 1 | -1): Promise<void>\n\t\t{\n\t\t\tEvent.unbind(window, 'mouseup', this.onMouseUp);\n\t\t\tEvent.bind(window, 'mouseup', this.onMouseUp);\n\t\t\tthis.mouseDown = true;\n\t\t\tawait new Promise((resolve) => setTimeout(resolve, 50));\n\t\t\tif (this.mouseDown)\n\t\t\t{\n\t\t\t\tclearInterval(this.zoomInterval);\n\t\t\t\tthis.zoomInterval = setInterval(() => this.zoomInto(this.desiredZoom + direction * 0.1), 40);\n\t\t\t}\n\t\t},\n\t\tonMouseUp(): void\n\t\t{\n\t\t\tthis.mouseDown = false;\n\t\t\tif (this.desiredZoom > this.zoom)\n\t\t\t{\n\t\t\t\tthis.desiredZoom = Math.ceil(this.zoom * 10) / 10;\n\t\t\t}\n\n\t\t\tif (this.desiredZoom < this.zoom)\n\t\t\t{\n\t\t\t\tthis.desiredZoom = Math.floor(this.zoom * 10) / 10;\n\t\t\t}\n\n\t\t\tthis.zoomInto(this.desiredZoom);\n\t\t\tclearInterval(this.zoomInterval);\n\t\t\tEvent.unbind(window, 'mouseup', this.onMouseUp);\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tahaMoments.setPopupShown(AhaMoment.ExpandGrid);\n\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-expand-grid',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_EXPAND_GRID_TITLE'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_EXPAND_GRID_TEXT'),\n\t\t\t\tarticle: HelpDesk.AhaExpandGrid,\n\t\t\t\ttarget: this.$refs.expand,\n\t\t\t\ttop: true,\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.ExpandGrid);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-grid-scale-panel\">\n\t\t\t<div v-if=\"!isSlider\" class=\"booking-booking-grid-scale-panel-full-screen\" ref=\"expand\">\n\t\t\t\t<div v-if=\"expanded\" class=\"ui-icon-set --collapse-diagonal\" @click=\"collapse\"></div>\n\t\t\t\t<div v-else class=\"ui-icon-set --expand-diagonal\" @click=\"expand\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"booking-booking-grid-scale-panel-fit-to-screen\">\n\t\t\t\t<div class=\"booking-booking-grid-scale-panel-fit-to-screen-text\" @click=\"fitToScreen\">\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_SHOW_ALL') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"booking-booking-grid-scale-panel-change\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-icon-set --minus-30\"\n\t\t\t\t\t:class=\"{'--disabled': zoom <= minZoom}\"\n\t\t\t\t\t@click=\"zoomInto(desiredZoom - 0.1)\"\n\t\t\t\t\t@mousedown=\"onMouseDown(-1)\"\n\t\t\t\t></div>\n\t\t\t\t<div v-html=\"zoomFormatted\" class=\"booking-booking-grid-scale-panel-zoom\"></div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-icon-set --plus-30\"\n\t\t\t\t\t:class=\"{'--disabled': zoom >= maxZoom}\"\n\t\t\t\t\t@click=\"zoomInto(desiredZoom + 0.1)\"\n\t\t\t\t\t@mousedown=\"onMouseDown(1)\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { DatePicker, DatePickerEvent, getNextDate, createDate } from 'ui.date-picker';\nimport { createNamespacedHelpers } from 'ui.vue3.vuex';\n\nimport { DateFormat, Model } from 'booking.const';\n\nimport './calendar.css';\n\nconst { mapGetters: mapInterfaceGetters } = createNamespacedHelpers(Model.Interface);\n\nexport const Calendar = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\texpanded: true,\n\t\t};\n\t},\n\tcreated(): void\n\t{\n\t\tthis.datePicker = new DatePicker({\n\t\t\tselectedDates: [this.selectedDateTs],\n\t\t\tinline: true,\n\t\t\thideHeader: true,\n\t\t});\n\n\t\tthis.setViewDate();\n\n\t\tthis.datePicker.subscribe(DatePickerEvent.SELECT, (event) => {\n\t\t\tconst date = event.getData().date;\n\t\t\tconst selectedDate = this.createDateFromUtc(date);\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setSelectedDateTs`, selectedDate.getTime());\n\t\t\tthis.setViewDate();\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tthis.datePicker.setTargetNode(this.$refs.datePicker);\n\t\tthis.datePicker.show();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.datePicker.destroy();\n\t},\n\tcomputed: {\n\t\t...mapInterfaceGetters({\n\t\t\tfilteredMarks: 'filteredMarks',\n\t\t\tfreeMarks: 'freeMarks',\n\t\t\tisFilterMode: 'isFilterMode',\n\t\t\tgetCounterMarks: 'getCounterMarks',\n\t\t\toffset: 'offset',\n\t\t}),\n\t\tselectedDateTs(): number\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Interface}/selectedDateTs`] + this.offset;\n\t\t},\n\t\tviewDateTs(): number\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Interface}/viewDateTs`] + this.offset;\n\t\t},\n\t\tcounterMarks(): string[]\n\t\t{\n\t\t\tif (this.isFilterMode)\n\t\t\t{\n\t\t\t\treturn this.getCounterMarks(this.filteredMarks);\n\t\t\t}\n\n\t\t\treturn this.getCounterMarks();\n\t\t},\n\t\tformattedDate(): string\n\t\t{\n\t\t\tconst format = this.expanded\n\t\t\t\t? this.loc('BOOKING_MONTH_YEAR_FORMAT')\n\t\t\t\t: DateTimeFormat.getFormat('LONG_DATE_FORMAT')\n\t\t\t;\n\n\t\t\tconst timestamp = this.expanded\n\t\t\t\t? this.viewDateTs / 1000\n\t\t\t\t: this.selectedDateTs / 1000\n\t\t\t;\n\n\t\t\treturn DateTimeFormat.format(format, timestamp);\n\t\t},\n\t},\n\tmethods: {\n\t\tonCollapseClick(): void\n\t\t{\n\t\t\tthis.expanded = !this.expanded;\n\t\t},\n\t\tonPreviousClick(): void\n\t\t{\n\t\t\tif (this.expanded)\n\t\t\t{\n\t\t\t\tthis.previousMonth();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.previousDate();\n\t\t\t}\n\t\t},\n\t\tonNextClick(): void\n\t\t{\n\t\t\tif (this.expanded)\n\t\t\t{\n\t\t\t\tthis.nextMonth();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.nextDate();\n\t\t\t}\n\t\t},\n\t\tpreviousDate(): void\n\t\t{\n\t\t\tconst selectedDate = this.datePicker.getSelectedDate() || this.datePicker.getToday();\n\t\t\tthis.datePicker.selectDate(getNextDate(selectedDate, 'day', -1));\n\t\t\tthis.setViewDate();\n\t\t},\n\t\tnextDate(): void\n\t\t{\n\t\t\tconst selectedDate = this.datePicker.getSelectedDate() || this.datePicker.getToday();\n\t\t\tthis.datePicker.selectDate(getNextDate(selectedDate, 'day'));\n\t\t\tthis.setViewDate();\n\t\t},\n\t\tpreviousMonth(): void\n\t\t{\n\t\t\tconst viewDate = this.datePicker.getViewDate();\n\t\t\tthis.datePicker.setViewDate(getNextDate(viewDate, 'month', -1));\n\t\t\tthis.setViewDate();\n\t\t},\n\t\tnextMonth(): void\n\t\t{\n\t\t\tconst viewDate = this.datePicker.getViewDate();\n\t\t\tthis.datePicker.setViewDate(getNextDate(viewDate, 'month'));\n\t\t\tthis.setViewDate();\n\t\t},\n\t\tsetViewDate(): void\n\t\t{\n\t\t\tconst viewDate = this.createDateFromUtc(this.datePicker.getViewDate());\n\t\t\tconst viewDateTs = viewDate.setDate(1);\n\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setViewDateTs`, viewDateTs);\n\t\t},\n\t\tcreateDateFromUtc(date: Date): Date\n\t\t{\n\t\t\treturn new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());\n\t\t},\n\t\tupdateMarks(): void\n\t\t{\n\t\t\tif (this.isFilterMode)\n\t\t\t{\n\t\t\t\tthis.setFilterMarks();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setFreeMarks();\n\t\t\t}\n\n\t\t\tthis.setCounterMarks();\n\t\t},\n\t\tsetFreeMarks(): void\n\t\t{\n\t\t\tconst bgColorFree = 'rgba(var(--ui-color-background-success-rgb), 0.7)';\n\t\t\tconst dates = this.prepareDates(this.freeMarks);\n\n\t\t\tthis.datePicker.setDayColors([\n\t\t\t\t{\n\t\t\t\t\tmatcher: dates,\n\t\t\t\t\tbgColor: bgColorFree,\n\t\t\t\t},\n\t\t\t]);\n\t\t},\n\t\tsetFilterMarks(): void\n\t\t{\n\t\t\tconst bgColorFilter = 'rgba(var(--ui-color-primary-rgb), 0.20)';\n\t\t\tconst dates = this.prepareDates(this.filteredMarks);\n\n\t\t\tthis.datePicker.setDayColors([\n\t\t\t\t{\n\t\t\t\t\tmatcher: dates,\n\t\t\t\t\tbgColor: bgColorFilter,\n\t\t\t\t},\n\t\t\t]);\n\t\t},\n\t\tsetCounterMarks(): void\n\t\t{\n\t\t\tconst dates = this.prepareDates(this.counterMarks);\n\n\t\t\tthis.datePicker.setDayMarks([\n\t\t\t\t{\n\t\t\t\t\tmatcher: dates,\n\t\t\t\t\tbgColor: 'red',\n\t\t\t\t},\n\t\t\t]);\n\t\t},\n\t\tprepareDates(dates: string[]): string[]\n\t\t{\n\t\t\treturn dates.map((markDate: string): string => {\n\t\t\t\tconst date = DateTimeFormat.parse(markDate, false, DateFormat.ServerParse);\n\n\t\t\t\treturn this.prepareTimestamp(date.getTime());\n\t\t\t});\n\t\t},\n\t\tprepareTimestamp(timestamp: number): string\n\t\t{\n\t\t\tconst dateFormat = DateTimeFormat.getFormat('FORMAT_DATE');\n\n\t\t\treturn DateTimeFormat.format(dateFormat, timestamp / 1000);\n\t\t},\n\t},\n\twatch: {\n\t\tselectedDateTs(selectedDateTs: number): void\n\t\t{\n\t\t\tthis.datePicker.selectDate(createDate(selectedDateTs));\n\t\t\tthis.updateMarks();\n\t\t},\n\t\tfilteredMarks(): void\n\t\t{\n\t\t\tthis.updateMarks();\n\t\t},\n\t\tfreeMarks(): void\n\t\t{\n\t\t\tthis.updateMarks();\n\t\t},\n\t\tcounterMarks(): void\n\t\t{\n\t\t\tthis.setCounterMarks();\n\t\t},\n\t\tisFilterMode(): void\n\t\t{\n\t\t\tthis.updateMarks();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-sidebar-calendar\">\n\t\t\t<div class=\"booking-booking-sidebar-calendar-header\">\n\t\t\t\t<div class=\"booking-booking-sidebar-calendar-button\" @click=\"onPreviousClick\">\n\t\t\t\t\t<div class=\"ui-icon-set --chevron-left\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-booking-sidebar-calendar-title\">\n\t\t\t\t\t{{ formattedDate }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-booking-sidebar-calendar-button\" @click=\"onNextClick\">\n\t\t\t\t\t<div class=\"ui-icon-set --chevron-right\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-booking-sidebar-calendar-button --collapse\" @click=\"onCollapseClick\">\n\t\t\t\t\t<div v-if=\"expanded\" class=\"ui-icon-set --collapse\"></div>\n\t\t\t\t\t<div v-else class=\"ui-icon-set --expand-1\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"booking-booking-sidebar-calendar-date-picker\"\n\t\t\t\t:class=\"{'--expanded': expanded}\"\n\t\t\t\tref=\"datePicker\"\n\t\t\t></div>\n\t\t</div>\n\t`,\n};\n","import { Calendar } from './calendar/calendar';\nimport './sidebar.css';\n\nexport const Sidebar = {\n\tcomponents: {\n\t\tCalendar,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-sidebar\">\n\t\t\t<Calendar/>\n\t\t</div>\n\t`,\n};\n","import { Dom, Event } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Ears } from 'ui.ears';\n\nimport { AhaMoment, Model } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport type { BookingModel } from 'booking.model.bookings';\nimport { grid } from '../../lib/grid/grid';\n\nimport { LeftPanel } from './left-panel/left-panel';\nimport { NowLine } from './now-line/now-line';\nimport { Bookings } from './bookings/bookings';\nimport { Column } from './column/column';\nimport { ScalePanel } from './scale-panel/scale-panel';\nimport { Sidebar } from './sidebar/sidebar';\nimport './grid.css';\n\nexport const Grid = {\n\tdata(): Object {\n\t\treturn {\n\t\t\tscrolledToBooking: false,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.ears = new Ears({\n\t\t\tcontainer: this.$refs.columnsContainer,\n\t\t\tsmallSize: true,\n\t\t\tclassName: 'booking-booking-grid-columns-ears',\n\t\t}).init();\n\n\t\tEvent.EventEmitter.subscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\tEvent.EventEmitter.subscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\t\tscroll: `${Model.Interface}/scroll`,\n\t\t\teditingBookingId: `${Model.Interface}/editingBookingId`,\n\t\t}),\n\t\teditingBooking(): BookingModel | null\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.editingBookingId) ?? null;\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateEars(): void\n\t\t{\n\t\t\tthis.ears.toggleEars();\n\n\t\t\tthis.tryShowAhaMoment();\n\t\t},\n\t\tareEarsShown(): boolean\n\t\t{\n\t\t\tconst shownClass = 'ui-ear-show';\n\n\t\t\treturn Dom.hasClass(this.ears.getRightEar(), shownClass) || Dom.hasClass(this.ears.getLeftEar(), shownClass);\n\t\t},\n\t\tscrollToEditingBooking(): void\n\t\t{\n\t\t\tif (!this.editingBooking || this.scrolledToBooking)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst top = grid.calculateTop(this.editingBooking.dateFromTs);\n\t\t\tconst height = grid.calculateHeight(this.editingBooking.dateFromTs, this.editingBooking.dateToTs);\n\t\t\tthis.$refs.inner.scrollTop = top + height / 2 + this.$refs.inner.offsetHeight / 2;\n\t\t\tthis.scrolledToBooking = true;\n\t\t},\n\t\ttryShowAhaMoment(): void\n\t\t{\n\t\t\tif (this.areEarsShown() && ahaMoments.shouldShow(AhaMoment.ExpandGrid))\n\t\t\t{\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t\t\t\tvoid this.$refs.scalePanel.showAhaMoment();\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tscroll(value): void\n\t\t{\n\t\t\tthis.$refs.columnsContainer.scrollLeft = value;\n\t\t},\n\t\teditingBooking(): void\n\t\t{\n\t\t\tthis.scrollToEditingBooking();\n\t\t},\n\t},\n\tcomponents: {\n\t\tLeftPanel,\n\t\tNowLine,\n\t\tColumn,\n\t\tBookings,\n\t\tScalePanel,\n\t\tSidebar,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-grid\">\n\t\t\t<div\n\t\t\t\tid=\"booking-booking-grid-wrap\"\n\t\t\t\tclass=\"booking-booking-grid-inner --vertical-scroll-bar\"\n\t\t\t\tref=\"inner\"\n\t\t\t>\n\t\t\t\t<LeftPanel/>\n\t\t\t\t<NowLine/>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"booking-booking-grid-columns --horizontal-scroll-bar\"\n\t\t\t\t\tref=\"columnsContainer\"\n\t\t\t\t\t@scroll=\"$store.dispatch('interface/setScroll', $refs.columnsContainer.scrollLeft)\"\n\t\t\t\t>\n\t\t\t\t\t<Bookings/>\n\t\t\t\t\t<TransitionGroup name=\"booking-transition-resource\" @after-leave=\"updateEars\" @after-enter=\"updateEars\">\n\t\t\t\t\t\t<template v-for=\"resourceId of resourcesIds\" :key=\"resourceId\">\n\t\t\t\t\t\t\t<Column :resourceId=\"resourceId\"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</TransitionGroup>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<ScalePanel\n\t\t\t\t:getColumnsContainer=\"() => $refs.columnsContainer\"\n\t\t\t\tref=\"scalePanel\"\n\t\t\t/>\n\t\t</div>\n\t\t<Sidebar/>\n\t`,\n};\n","import './battery-icon.css';\n\nconst MIN_CHARGE = 0;\nconst MAX_CHARGE = 12;\nconst CHARGE_COLOR = 'var(--ui-color-primary-alt)';\nconst EMPTY_COLOR = 'var(--ui-color-background-secondary)';\n\nexport const BATTERY_ICON_HEIGHT = 14;\nexport const BATTERY_ICON_WIDTH = 27;\n\nexport const BatteryIcon = {\n\tname: 'BatteryIcon',\n\tprops: {\n\t\tpercent: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tdataId: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: '',\n\t\t},\n\t\theight: {\n\t\t\ttype: Number,\n\t\t\tdefault: BATTERY_ICON_HEIGHT,\n\t\t},\n\t\twidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: BATTERY_ICON_WIDTH,\n\t\t},\n\t},\n\tmounted(): void {\n\t\tthis.repaint();\n\t},\n\tmethods: {\n\t\tgetCharge(percent: number): number\n\t\t{\n\t\t\tif (percent <= 0)\n\t\t\t{\n\t\t\t\treturn MIN_CHARGE;\n\t\t\t}\n\t\t\tif (percent >= 100)\n\t\t\t{\n\t\t\t\treturn MAX_CHARGE;\n\t\t\t}\n\n\t\t\treturn Math.round(percent * MAX_CHARGE * 0.01);\n\t\t},\n\t\trepaint(): void\n\t\t{\n\t\t\tconst rects: SVGRectElement[] = this.$refs['icon-battery-charge']?.children || [];\n\t\t\tconst charge: number = this.getCharge(this.percent);\n\t\t\tlet index = 1;\n\n\t\t\tfor (const rect: SVGRectElement of rects)\n\t\t\t{\n\t\t\t\trect.setAttribute('fill', index > charge ? EMPTY_COLOR : CHARGE_COLOR);\n\t\t\t\tindex++;\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tpercent: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.repaint();\n\t\t\t},\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :data-id=\"dataId\" :data-percent=\"percent\" data-element=\"booking-resource-workload-percent\">\n\t\t\t<svg id=\"booking--battery-icon\" :width=\"width\" :height=\"height\" viewBox=\"0 0 27 14\" fill=\"none\"\n\t\t\t\t xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t<rect width=\"23.2875\" height=\"13.8\" rx=\"4\" fill=\"white\"/>\n\t\t\t\t<rect x=\"22.6871\" y=\"0.6\" width=\"12.6\" height=\"22.0875\" rx=\"3.4\" transform=\"rotate(90 22.6871 0.6)\" stroke=\"#C9CCD0\" stroke-width=\"1.2\"/>\n\t\t\t\t<g ref=\"icon-battery-charge\" id=\"booking--battery-icon-charge\" clip-path=\"url(#clip0_5003_187951)\">\n\t\t\t\t\t<rect x=\"2.58789\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"4.09766\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"5.60547\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"7.11523\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"8.625\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"10.1328\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"11.6426\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"13.1523\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"14.6621\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"16.1699\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"17.6797\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"19.1895\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t</g>\n\t\t\t\t<g clip-path=\"url(#clip1_5003_187951)\">\n\t\t\t\t\t<ellipse cx=\"23.102\" cy=\"6.89999\" rx=\"2.9\" ry=\"3.48\" transform=\"rotate(90 23.102 6.89999)\" fill=\"#C9CCD0\"/>\n\t\t\t\t</g>\n\t\t\t\t<defs>\n\t\t\t\t\t<clipPath id=\"clip0_5003_187951\">\n\t\t\t\t\t\t<rect x=\"2.58789\" y=\"2.5875\" width=\"18.1125\" height=\"8.625\" rx=\"1.5\" fill=\"white\"/>\n\t\t\t\t\t</clipPath>\n\t\t\t\t\t<clipPath id=\"clip1_5003_187951\">\n\t\t\t\t\t\t<rect width=\"6.9\" height=\"2.15625\" fill=\"white\" transform=\"translate(26.7383 3.45) rotate(90)\"/>\n\t\t\t\t\t</clipPath>\n\t\t\t\t</defs>\n\t\t\t</svg>\n\t\t</div>\n\t`,\n};\n","import { StatisticsPopup } from 'booking.component.statistics-popup';\n\nexport const WorkloadPopup = {\n\temits: ['close'],\n\tprops: {\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tslotsCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tbookingCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tworkLoadPercent: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn 'booking-booking-resource-workload-popup';\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_RESOURCE_WORKLOAD_POPUP_TITLE');\n\t\t},\n\t\trows(): { title: string, value: string }[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_RESOURCE_WORKLOAD_SLOTS_BOOKED'),\n\t\t\t\t\tvalue: this.slotsBookedFormatted,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\telement: 'booking-resource-workload-popup-count',\n\t\t\t\t\t\tresourceId: this.resourceId,\n\t\t\t\t\t\tbookedCount: this.bookingCount,\n\t\t\t\t\t\ttotalCount: this.slotsCount,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_RESOURCE_WORKLOAD'),\n\t\t\t\t\tvalue: this.workLoadPercentFormatted,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\telement: 'booking-resource-workload-popup-percent',\n\t\t\t\t\t\tresourceId: this.resourceId,\n\t\t\t\t\t\tpercent: this.workLoadPercent,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tslotsBookedFormatted(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_RESOURCE_WORKLOAD_BOOKED_FROM_SLOTS_COUNT', {\n\t\t\t\t'#BOOKED#': this.bookingCount,\n\t\t\t\t'#SLOTS_COUNT#': this.slotsCount,\n\t\t\t});\n\t\t},\n\t\tworkLoadPercentFormatted(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_RESOURCE_WORKLOAD_PERCENT', {\n\t\t\t\t'#PERCENT#': this.workLoadPercent,\n\t\t\t});\n\t\t},\n\t},\n\tcomponents: {\n\t\tStatisticsPopup,\n\t},\n\ttemplate: `\n\t\t<StatisticsPopup\n\t\t\t:popupId=\"popupId\"\n\t\t\t:bindElement=\"bindElement\"\n\t\t\t:title=\"title\"\n\t\t\t:rows=\"rows\"\n\t\t\t:dataset=\"{\n\t\t\t\tid: resourceId,\n\t\t\t\telement: 'booking-resource-workload-popup',\n\t\t\t}\"\n\t\t\t@close=\"$emit('close')\"\n\t\t/>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\n\nimport { AhaMoment, DateFormat, HelpDesk, Model } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport type { ResourceModel } from 'booking.model.resources';\nimport type { BookingModel } from 'booking.model.bookings';\n\nimport { busySlots } from '../../../../lib/busy-slots/busy-slots';\nimport { BatteryIcon, BATTERY_ICON_HEIGHT, BATTERY_ICON_WIDTH } from './battery-icon/battery-icon';\nimport { WorkloadPopup } from './workload-popup/workload-popup';\nimport './resource-workload.css';\n\nexport const ResourceWorkload = {\n\tname: 'ResourceWorkload',\n\tprops: {\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tscale: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1,\n\t\t},\n\t\tisGrid: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedDateTs: 'interface/selectedDateTs',\n\t\t\tfromHour: 'interface/fromHour',\n\t\t\ttoHour: 'interface/toHour',\n\t\t}),\n\t\tworkLoadPercent(): number\n\t\t{\n\t\t\tif (this.slotsCount === 0)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\treturn Math.round(this.bookingCount / this.slotsCount * 100);\n\t\t},\n\t\tbookingCount(): number\n\t\t{\n\t\t\treturn this.bookings.length;\n\t\t},\n\t\tslotsCount(): number\n\t\t{\n\t\t\tconst selectedDate = new Date(this.selectedDateTs);\n\t\t\tconst selectedWeekDay = DateFormat.WeekDays[selectedDate.getDay()];\n\t\t\tconst slotRanges = busySlots.filterSlotRanges(\n\t\t\t\tthis.resource.slotRanges.filter((slotRange) => {\n\t\t\t\t\treturn slotRange.weekDays.includes(selectedWeekDay);\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tconst slotSize = this.resource.slotRanges[0].slotSize ?? 60;\n\n\t\t\treturn Math.floor(slotRanges.reduce((sum, slotRange) => {\n\t\t\t\treturn sum + (slotRange.to - slotRange.from) / slotSize;\n\t\t\t}, 0));\n\t\t},\n\t\tbookings(): BookingModel[]\n\t\t{\n\t\t\tconst dateTs = this.selectedDateTs;\n\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getByDateAndResources`](dateTs, [this.resourceId]);\n\t\t},\n\t\tresource(): ResourceModel\n\t\t{\n\t\t\treturn this.$store.getters['resources/getById'](this.resourceId);\n\t\t},\n\t\tbatteryIconOptions(): { height: number, width: number }\n\t\t{\n\t\t\treturn {\n\t\t\t\theight: Math.round(BATTERY_ICON_HEIGHT * this.scale),\n\t\t\t\twidth: Math.round(BATTERY_ICON_WIDTH * this.scale),\n\t\t\t};\n\t\t},\n\t\tbookingsCount(): number\n\t\t{\n\t\t\treturn this.bookings.length;\n\t\t},\n\t},\n\tmethods: {\n\t\tonMouseEnter(): void\n\t\t{\n\t\t\tthis.showTimeout = setTimeout(() => this.showPopup(), 100);\n\t\t},\n\t\tonMouseLeave(): void\n\t\t{\n\t\t\tclearTimeout(this.showTimeout);\n\t\t\tthis.closePopup();\n\t\t},\n\t\tshowPopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = true;\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = false;\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tahaMoments.setPopupShown(AhaMoment.ResourceWorkload);\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-resource-workload',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_RESOURCE_WORKLOAD_TITLE'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_RESOURCE_WORKLOAD_TEXT'),\n\t\t\t\tarticle: HelpDesk.AhaResourceWorkload,\n\t\t\t\ttarget: this.$refs.container,\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.ResourceWorkload);\n\t\t},\n\t},\n\twatch: {\n\t\tbookingsCount(newCount: number, previousCount: number): void\n\t\t{\n\t\t\tif (this.isGrid && newCount > previousCount && ahaMoments.shouldShow(AhaMoment.ResourceWorkload))\n\t\t\t{\n\t\t\t\tvoid this.showAhaMoment();\n\t\t\t}\n\t\t},\n\t},\n\tcomponents: {\n\t\tBatteryIcon,\n\t\tWorkloadPopup,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-header-resource-workload\"\n\t\t\tdata-element=\"booking-resource-workload\"\n\t\t\t:data-id=\"resourceId\"\n\t\t\tref=\"container\"\n\t\t\t@click=\"showPopup\"\n\t\t\t@mouseenter=\"onMouseEnter\"\n\t\t\t@mouseleave=\"onMouseLeave\"\n\t\t>\n\t\t\t<BatteryIcon \n\t\t\t\t:percent=\"workLoadPercent\"\n\t\t\t\t:data-id=\"resourceId\"\n\t\t\t\t:height=\"batteryIconOptions.height\"\n\t\t\t\t:width=\"batteryIconOptions.width\"\n\t\t\t/>\n\t\t</div>\n\t\t<WorkloadPopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:resourceId=\"resourceId\"\n\t\t\t:slotsCount=\"slotsCount\"\n\t\t\t:bookingCount=\"bookingCount\"\n\t\t\t:workLoadPercent=\"workLoadPercent\"\n\t\t\t:bindElement=\"$refs.container\"\n\t\t\t@close=\"closePopup\"\n\t\t/>\n\t`,\n};\n","import { limit } from 'booking.lib.limit';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Event, Loc } from 'main.core';\nimport { MenuManager, Menu, Popup } from 'main.popup';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport 'ui.hint';\nimport { Model } from 'booking.const';\nimport { hideResources } from 'booking.lib.resources';\nimport { ResourceCreationWizard } from 'booking.resource-creation-wizard';\nimport { resourceService } from 'booking.provider.service.resources-service';\n\nimport './resource-menu.css';\n\nexport const ResourceMenu = {\n\tname: 'ResourceMenu',\n\tprops: {\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { menuPopup: Menu | null }\n\t{\n\t\treturn {\n\t\t\tmenuPopup: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tfavoritesIds: `${Model.Favorites}/get`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `resource-menu-${this.resourceId || 'new'}`;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.hint = BX.UI.Hint.createInstance({\n\t\t\tpopupParameters: {},\n\t\t});\n\t},\n\tunmounted(): void\n\t{\n\t\tif (this.menuPopup)\n\t\t{\n\t\t\tthis.destroy();\n\t\t}\n\t},\n\tmethods: {\n\t\topenMenu(): void\n\t\t{\n\t\t\tif (this.menuPopup?.popupWindow?.isShown())\n\t\t\t{\n\t\t\t\tthis.destroy();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuButton = this.$refs['menu-button'];\n\t\t\tthis.menuPopup = MenuManager.create(\n\t\t\t\tthis.popupId,\n\t\t\t\tmenuButton,\n\t\t\t\tthis.getMenuItems(),\n\t\t\t\t{\n\t\t\t\t\tclassName: 'booking-resource-menu-popup',\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\toffsetTop: -3,\n\t\t\t\t\toffsetLeft: menuButton.offsetWidth - 6,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcacheable: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonDestroy: () => this.unbindScrollEvent(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t\tthis.menuPopup.show();\n\t\t\tthis.bindScrollEvent();\n\t\t},\n\t\tgetMenuItems(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t// {\n\t\t\t\t// \thtml: `<span>${this.loc('BOOKING_RESOURCE_MENU_ADD_BOOKING')}</span>`,\n\t\t\t\t// \tonclick: () => this.destroy(),\n\t\t\t\t// },\n\t\t\t\t{\n\t\t\t\t\thtml: `<span>${this.loc('BOOKING_RESOURCE_MENU_EDIT_RESOURCE')}</span>`,\n\t\t\t\t\tclassName: (\n\t\t\t\t\t\tthis.isFeatureEnabled\n\t\t\t\t\t\t\t? 'menu-popup-item menu-popup-no-icon'\n\t\t\t\t\t\t\t: 'menu-popup-item --lock'\n\t\t\t\t\t),\n\t\t\t\t\tonclick: async () => {\n\t\t\t\t\t\tif (!this.isFeatureEnabled)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlimit.show();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst wizard = new ResourceCreationWizard();\n\t\t\t\t\t\tthis.editResource(this.resourceId, wizard);\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t// {\n\t\t\t\t// \thtml: `<span>${this.loc('BOOKING_RESOURCE_MENU_EDIT_NOTIFY')}</span>`,\n\t\t\t\t// \tonclick: () => this.destroy(),\n\t\t\t\t// },\n\t\t\t\t// {\n\t\t\t\t// \thtml: `<span>${this.loc('BOOKING_RESOURCE_MENU_CREATE_COPY')}</span>`,\n\t\t\t\t// \tonclick: () => this.destroy(),\n\t\t\t\t// },\n\t\t\t\t// {\n\t\t\t\t// \thtml: '<span></span>',\n\t\t\t\t// \tdisabled: true,\n\t\t\t\t// \tclassName: 'menu-item-divider',\n\t\t\t\t// },\n\t\t\t\t{\n\t\t\t\t\thtml: `<span>${this.loc('BOOKING_RESOURCE_MENU_HIDE')}</span>`,\n\t\t\t\t\tonclick: async () => {\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t\tawait this.hideResource(this.resourceId);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: `<span class=\"alert-text\">${this.loc('BOOKING_RESOURCE_MENU_DELETE')}</span>`,\n\t\t\t\t\tonclick: async () => {\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t\tawait this.deleteResource(this.resourceId);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tdestroy(): void\n\t\t{\n\t\t\tMenuManager.destroy(this.popupId);\n\t\t\tthis.unbindScrollEvent();\n\t\t},\n\t\tbindScrollEvent(): void\n\t\t{\n\t\t\tEvent.bind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tunbindScrollEvent(): void\n\t\t{\n\t\t\tEvent.unbind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tthis.menuPopup?.popupWindow?.adjustPosition();\n\t\t},\n\t\tasync editResource(resourceId: number, wizard: ResourceCreationWizard): void\n\t\t{\n\t\t\twizard.open(resourceId);\n\t\t},\n\t\tasync hideResource(resourceId: number): Promise<void>\n\t\t{\n\t\t\tconst ids = [...this.favoritesIds];\n\t\t\tconst index = this.favoritesIds.indexOf(resourceId);\n\t\t\tif (index === -1)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tids.splice(index, 1);\n\n\t\t\tawait hideResources(ids);\n\t\t},\n\t\tasync deleteResource(resourceId: number): Promise<void>\n\t\t{\n\t\t\tconst confirmed = await this.confirmDelete(resourceId);\n\n\t\t\tif (confirmed)\n\t\t\t{\n\t\t\t\tawait resourceService.delete(resourceId);\n\t\t\t}\n\t\t},\n\t\tasync confirmDelete(resourceId: number): Promise<boolean>\n\t\t{\n\t\t\tconst disabled = await resourceService.hasBookings(resourceId);\n\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tconst messageBox = MessageBox.create({\n\t\t\t\t\tmessage: Loc.getMessage('BOOKING_RESOURCE_CONFIRM_DELETE'),\n\t\t\t\t\tyesCaption: Loc.getMessage('BOOKING_RESOURCE_CONFIRM_DELETE_YES'),\n\t\t\t\t\tmodal: true,\n\t\t\t\t\tbuttons: MessageBoxButtons.YES_CANCEL,\n\t\t\t\t\tonYes: () => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tresolve(true);\n\t\t\t\t\t},\n\t\t\t\t\tonCancel: () => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tresolve(false);\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tif (disabled)\n\t\t\t\t{\n\t\t\t\t\tconst popup: Popup = messageBox.getPopupWindow();\n\t\t\t\t\tpopup.subscribe('onAfterShow', () => {\n\t\t\t\t\t\tconst yesButton = messageBox.getYesButton();\n\t\t\t\t\t\tyesButton.setDisabled(true);\n\n\t\t\t\t\t\tEvent.bind(yesButton.getContainer(), 'mouseenter', () => {\n\t\t\t\t\t\t\tthis.hint.show(\n\t\t\t\t\t\t\t\tyesButton.getContainer(),\n\t\t\t\t\t\t\t\tLoc.getMessage('BOOKING_RESOURCE_CONFIRM_DELETE_HINT'),\n\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tEvent.bind(yesButton.getContainer(), 'mouseleave', () => {\n\t\t\t\t\t\t\tthis.hint.hide(yesButton.getContainer());\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tmessageBox.show();\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button ref=\"menu-button\" class=\"ui-icon-set --more\" @click=\"openMenu\"></button>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { CrmEntity, Model } from 'booking.const';\nimport { currencyFormat } from 'booking.lib.currency-format';\nimport type { BookingModel, DealData } from 'booking.model.bookings';\nimport type { ResourceModel } from 'booking.model.resources';\nimport type { ResourceTypeModel } from 'booking.model.resource-types';\n\nimport { ResourceWorkload } from './resource-workload/resource-workload';\nimport { ResourceMenu } from './resource-menu/resource-menu';\nimport './resource.css';\n\nexport const Resource = {\n\tprops: {\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tvisible: true,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.updateVisibility();\n\t\tthis.updateVisibilityDuringTransition();\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\t\tzoom: `${Model.Interface}/zoom`,\n\t\t\tscroll: `${Model.Interface}/scroll`,\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t}),\n\t\tresource(): ResourceModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Resources}/getById`](this.resourceId);\n\t\t},\n\t\tresourceType(): ResourceTypeModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.ResourceTypes}/getById`](this.resource.typeId);\n\t\t},\n\t\tprofit(): string\n\t\t{\n\t\t\tconst currencyId = currencyFormat.getBaseCurrencyId();\n\t\t\tconst deals = this.bookings\n\t\t\t\t.map(({ externalData }) => externalData?.find((data) => data.entityTypeId === CrmEntity.Deal) ?? null)\n\t\t\t\t.filter((deal: DealData | null) => deal?.data?.currencyId === currencyId)\n\t\t\t;\n\n\t\t\tif (deals.length === 0)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst uniqueDeals: DealData[] = [...new Map(deals.map((it) => [it.value, it])).values()];\n\n\t\t\tconst profit = uniqueDeals.reduce((sum: number, deal: DealData) => sum + deal.data.opportunity, 0);\n\n\t\t\treturn currencyFormat.format(currencyId, profit);\n\t\t},\n\t\tbookings(): BookingModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getByDateAndResources`](this.selectedDateTs, [this.resourceId]);\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateVisibilityDuringTransition(): void\n\t\t{\n\t\t\tthis.animation?.stop();\n\t\t\tthis.animation = new BX.easing({\n\t\t\t\tduration: 200,\n\t\t\t\tstart: {},\n\t\t\t\tfinish: {},\n\t\t\t\tstep: this.updateVisibility,\n\t\t\t});\n\t\t\tthis.animation.animate();\n\t\t},\n\t\tupdateVisibility(): void\n\t\t{\n\t\t\tif (!this.$refs.container)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst rect = this.$refs.container.getBoundingClientRect();\n\t\t\tthis.visible = rect.right > 0 && rect.left < window.innerWidth;\n\t\t},\n\t},\n\twatch: {\n\t\tscroll(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tzoom(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tresourcesIds(): void\n\t\t{\n\t\t\tthis.updateVisibilityDuringTransition();\n\t\t},\n\t},\n\tcomponents: {\n\t\tResourceMenu,\n\t\tResourceWorkload,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-header-resource\"\n\t\t\tdata-element=\"booking-resource\"\n\t\t\t:data-id=\"resourceId\"\n\t\t\tref=\"container\"\n\t\t>\n\t\t\t<template v-if=\"visible\">\n\t\t\t\t<ResourceWorkload\n\t\t\t\t\t:resourceId=\"resourceId\"\n\t\t\t\t\t:scale=\"zoom\"\n\t\t\t\t\t:isGrid=\"true\"\n\t\t\t\t/>\n\t\t\t\t<div class=\"booking-booking-header-resource-title\">\n\t\t\t\t\t<div class=\"booking-booking-header-resource-name\" :title=\"resource.name\">\n\t\t\t\t\t\t{{ resource.name }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"booking-booking-header-resource-type\" :title=\"resourceType.name\">\n\t\t\t\t\t\t{{ resourceType.name }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-booking-header-resource-profit\" v-html=\"profit\"></div>\n\t\t\t\t<div class=\"booking-booking-header-resource-actions\">\n\t\t\t\t\t<ResourceMenu :resource-id/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { limit } from 'booking.lib.limit';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.actions';\n\nimport { AhaMoment, HelpDesk, Model } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { ResourceCreationWizard } from 'booking.resource-creation-wizard';\nimport './add-resource-button.css';\n\nexport const AddResourceButton = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t};\n\t},\n\tcomputed: mapGetters({\n\t\tisLoaded: `${Model.Interface}/isLoaded`,\n\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t}),\n\tmethods: {\n\t\taddResource(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnew ResourceCreationWizard().open();\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-add-resource',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_ADD_RESOURCES_TITLE'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_ADD_RESOURCES_TEXT'),\n\t\t\t\tarticle: HelpDesk.AhaAddResource,\n\t\t\t\ttarget: this.$refs.button,\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.AddResource);\n\t\t},\n\t},\n\twatch: {\n\t\tisLoaded(): void\n\t\t{\n\t\t\tif (ahaMoments.shouldShow(AhaMoment.AddResource))\n\t\t\t{\n\t\t\t\tvoid this.showAhaMoment();\n\t\t\t}\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-header-add-resource\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"addResource\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"booking-booking-header-add-resource-icon\"\n\t\t\t\t:class=\"{'--lock': !isFeatureEnabled}\"\n\t\t\t>\n\t\t\t\t<Icon v-if=\"isFeatureEnabled\" :name=\"IconSet.PLUS_20\"/>\n\t\t\t\t<Icon v-else :name=\"IconSet.LOCK\" :size=\"16\"/>\n\t\t\t</div>\n\t\t\t<div class=\"booking-booking-header-add-resource-text\">\n\t\t\t\t{{ loc('BOOKING_BOOKING_ADD_RESOURCE') }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseHeader } from 'ui.entity-selector';\n\nexport class ContentHeader extends BaseHeader\n{\n\tconstructor(...props)\n\t{\n\t\tsuper(...props);\n\n\t\tthis.getContainer();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.options.content;\n\t}\n}\n","import { mapGetters } from 'ui.vue3.vuex';\nimport type { ResourceTypeModel } from 'booking.model.resource-types';\nimport './resource-types.css';\n\nexport const ResourceTypes = {\n\temits: ['update:modelValue'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tselectedTypes: {},\n\t\t};\n\t},\n\tcomputed: mapGetters({\n\t\tresourceTypes: 'resourceTypes/get',\n\t}),\n\tmethods: {\n\t\tselectAll(): void\n\t\t{\n\t\t\tObject.keys(this.selectedTypes).forEach((typeId) => {\n\t\t\t\tthis.selectedTypes[typeId] = true;\n\t\t\t});\n\t\t},\n\t\tdeselectAll(): void\n\t\t{\n\t\t\tObject.keys(this.selectedTypes).forEach((typeId) => {\n\t\t\t\tthis.selectedTypes[typeId] = false;\n\t\t\t});\n\t\t},\n\t},\n\twatch: {\n\t\tresourceTypes(resourceTypes: ResourceTypeModel[]): void\n\t\t{\n\t\t\tresourceTypes.forEach((resourceType: ResourceTypeModel) => {\n\t\t\t\tthis.selectedTypes[resourceType.id] ??= true;\n\t\t\t});\n\t\t},\n\t\tselectedTypes: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', this.selectedTypes);\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-resources-dialog-header-types\">\n\t\t\t<div class=\"booking-booking-resources-dialog-header-header\">\n\t\t\t\t<div class=\"booking-booking-resources-dialog-header-title\">\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_RESOURCE_TYPES') }}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-button\"\n\t\t\t\t\tdata-element=\"booking-resources-dialog-select-all-types-button\"\n\t\t\t\t\t@click=\"selectAll\"\n\t\t\t\t>\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_SELECT_ALL') }}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-button\"\n\t\t\t\t\tdata-element=\"booking-resources-dialog-deselect-all-types-button\"\n\t\t\t\t\t@click=\"deselectAll\"\n\t\t\t\t>\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_DESELECT_ALL') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"booking-booking-resources-dialog-header-items\">\n\t\t\t\t<template v-for=\"resourceType of resourceTypes\" :key=\"resourceType.id\">\n\t\t\t\t\t<label\n\t\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-item\"\n\t\t\t\t\t\tdata-element=\"booking-resources-dialog-type\"\n\t\t\t\t\t\t:data-id=\"resourceType.id\"\n\t\t\t\t\t\t:data-selected=\"selectedTypes[resourceType.id]\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-item-text\"\n\t\t\t\t\t\t\tdata-element=\"booking-resources-dialog-type-name\"\n\t\t\t\t\t\t\t:data-id=\"resourceType.id\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ resourceType.name }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<input type=\"checkbox\" v-model=\"selectedTypes[resourceType.id]\">\n\t\t\t\t\t</label>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom, Event } from 'main.core';\nimport './resize.css';\n\nexport const Resize = {\n\temits: ['startResize', 'endResize'],\n\tprops: {\n\t\tgetNode: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisResized: false,\n\t\t\tstartMouseY: 0,\n\t\t\tstartHeight: 0,\n\t\t};\n\t},\n\tmethods: {\n\t\tstartResize(event: MouseEvent): void\n\t\t{\n\t\t\tthis.$emit('startResize');\n\t\t\tDom.style(document.body, 'user-select', 'none');\n\t\t\tEvent.bind(window, 'mouseup', this.endResize);\n\t\t\tEvent.bind(window, 'pointermove', this.resize);\n\t\t\tthis.isResized = true;\n\t\t\tthis.startMouseY = event.clientY;\n\t\t\tthis.startHeight = this.getNode().offsetHeight;\n\t\t},\n\t\tresize(event: MouseEvent): void\n\t\t{\n\t\t\tif (!this.isResized)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\n\t\t\tconst minHeight = 110;\n\t\t\tconst maxHeight = 180;\n\t\t\tconst height = this.startHeight + event.clientY - this.startMouseY;\n\t\t\tconst newHeight = Math.min(maxHeight, Math.max(height, minHeight));\n\n\t\t\tDom.style(this.getNode(), 'max-height', `${newHeight}px`);\n\t\t},\n\t\tendResize(): void\n\t\t{\n\t\t\tthis.$emit('endResize');\n\t\t\tDom.style(document.body, 'user-select', '');\n\t\t\tEvent.unbind(window, 'mouseup', this.endResize);\n\t\t\tEvent.unbind(window, 'pointermove', this.resize);\n\t\t\tthis.isResized = false;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-resources-dialog-header-resize\"\n\t\t\t@mousedown=\"startResize\"\n\t\t></div>\n\t`,\n};\n","import { Runtime, Type } from 'main.core';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport './search.css';\n\nexport const Search = {\n\temits: ['search'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsearchDebounced: Runtime.debounce(this.search, 200, this),\n\t\t\tquery: '',\n\t\t};\n\t},\n\tcomputed: {\n\t\tsearchIcon(): string\n\t\t{\n\t\t\treturn IconSet.SEARCH_2;\n\t\t},\n\t},\n\tmethods: {\n\t\tonInput(event: InputEvent): void\n\t\t{\n\t\t\tconst query = event.target.value;\n\t\t\tthis.query = query;\n\n\t\t\tif (Type.isStringFilled(query))\n\t\t\t{\n\t\t\t\tthis.searchDebounced(query);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.search(query);\n\t\t\t}\n\t\t},\n\t\tsearch(query: string): void\n\t\t{\n\t\t\tif (this.query === query)\n\t\t\t{\n\t\t\t\tthis.$emit('search', query);\n\t\t\t}\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-resources-dialog-header-input-container\">\n\t\t\t<input\n\t\t\t\tclass=\"booking-booking-resources-dialog-header-input\"\n\t\t\t\t:placeholder=\"loc('BOOKING_BOOKING_RESOURCES_DIALOG_SEARCH')\"\n\t\t\t\tdata-element=\"booking-resources-dialog-search-input\"\n\t\t\t\t@input=\"onInput\"\n\t\t\t>\n\t\t\t<div class=\"booking-booking-resources-dialog-header-input-icon\">\n\t\t\t\t<Icon :name=\"searchIcon\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { ResourceTypes } from './resource-types/resource-types';\nimport { Resize } from './resize/resize';\nimport { Search } from './search/search';\nimport './dialog-header.css';\n\nexport const DialogHeader = {\n\temits: ['update:modelValue', 'search', 'startResize', 'endResize', 'selectAll', 'deselectAll'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tselectedTypes: {},\n\t\t};\n\t},\n\tcomputed: mapGetters({\n\t\tresources: 'resources/get',\n\t}),\n\twatch: {\n\t\tselectedTypes: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', this.selectedTypes);\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tResourceTypes,\n\t\tResize,\n\t\tSearch,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-resources-dialog-header\" ref=\"header\">\n\t\t\t<ResourceTypes\n\t\t\t\tref=\"resourceTypes\"\n\t\t\t\tv-model=\"selectedTypes\"\n\t\t\t/>\n\t\t\t<Resize\n\t\t\t\t:getNode=\"() => this.$refs.resourceTypes.$el\"\n\t\t\t\t@startResize=\"$emit('startResize')\"\n\t\t\t\t@endResize=\"$emit('endResize')\"\n\t\t\t/>\n\t\t\t<div class=\"booking-booking-resources-dialog-header-resources\">\n\t\t\t\t<div class=\"booking-booking-resources-dialog-header-header\">\n\t\t\t\t\t<div class=\"booking-booking-resources-dialog-header-title\">\n\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_RESOURCES') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-button\"\n\t\t\t\t\t\tdata-element=\"booking-resources-dialog-select-all-button\"\n\t\t\t\t\t\t@click=\"$emit('selectAll')\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_SELECT_ALL') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-button\"\n\t\t\t\t\t\tdata-element=\"booking-resources-dialog-deselect-all-button\"\n\t\t\t\t\t\t@click=\"$emit('deselectAll')\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_DESELECT_ALL') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<Search @search=\"(query) => this.$emit('search', query)\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseFooter } from 'ui.entity-selector';\nimport './dialog-footer.css';\n\nexport class ContentFooter extends BaseFooter\n{\n\tconstructor(...props)\n\t{\n\t\tsuper(...props);\n\n\t\tthis.getContainer();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.options.content;\n\t}\n}\n","import { Button as UiButton, ButtonSize, ButtonColor } from 'booking.component.button';\nimport './dialog-footer.css';\n\nexport const DialogFooter = {\n\tname: 'DialogFooter',\n\temits: ['reset'],\n\tcomputed: {\n\t\tbuttonSettings(): { size: string, color: string }\n\t\t{\n\t\t\treturn Object.freeze({\n\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\tcolor: ButtonColor.LINK,\n\t\t\t});\n\t\t},\n\t\tbuttonLabel(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_RESOURCES_DIALOG_RESET');\n\t\t},\n\t},\n\tcomponents: {\n\t\tUiButton,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking--booking--select-resources-dialog-footer\">\n\t\t\t<UiButton\n\t\t\t\t:size=\"buttonSettings.size\"\n\t\t\t\t:color=\"buttonSettings.color\"\n\t\t\t\t:text=\"buttonLabel\"\n\t\t\t\tbutton-class=\"booking--booking--select-resources-dialog-footer__button\"\n\t\t\t\t@click=\"$emit('reset')\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { ahaMoments } from 'booking.lib.aha-moments';\nimport { Dom, Event, Runtime, Type } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Dialog, Item, type ItemOptions } from 'ui.entity-selector';\n\nimport { AhaMoment, EntitySelectorEntity, EntitySelectorTab, HelpDesk, Limit, Model } from 'booking.const';\nimport { resourceDialogService } from 'booking.provider.service.resource-dialog-service';\nimport { hideResources } from 'booking.lib.resources';\nimport { resourcesDateCache } from 'booking.lib.resources-date-cache';\nimport type { ResourceModel } from 'booking.model.resources';\nimport type { ResourceTypeModel } from 'booking.model.resource-types';\n\nimport { ContentHeader } from './dialog-header/content-header';\nimport { DialogHeader } from './dialog-header/dialog-header';\nimport { ContentFooter } from './dialog-footer/content-footer';\nimport { DialogFooter } from './dialog-footer/dialog-footer';\nimport { ResourceWorkload } from '../resource/resource-workload/resource-workload';\nimport './select-resources.css';\n\nexport const SelectResources = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tdialogFilled: false,\n\t\t\tquery: '',\n\t\t\tsaveItemsDebounce: Runtime.debounce(this.saveItems, 10, this),\n\t\t\tworkloadRefs: {},\n\t\t\tselectedTypes: {},\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.dialog = new Dialog({\n\t\t\tcontext: 'BOOKING',\n\t\t\ttargetNode: this.$refs.button,\n\t\t\twidth: 340,\n\t\t\theight: Math.min(window.innerHeight - 280, 600),\n\t\t\toffsetLeft: 4,\n\t\t\tdropdownMode: true,\n\t\t\tpreselectedItems: this.favoritesIds.map((resourceId) => [EntitySelectorEntity.Resource, resourceId]),\n\t\t\titems: this.resources.map((resource) => this.getItemOptions(resource)),\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: EntitySelectorEntity.Resource,\n\t\t\t\t},\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonShow: this.onShow,\n\t\t\t\t'Item:onSelect': this.saveItemsDebounce,\n\t\t\t\t'Item:onDeselect': this.saveItemsDebounce,\n\t\t\t},\n\t\t\theader: ContentHeader,\n\t\t\theaderOptions: {\n\t\t\t\tcontent: this.$refs.dialogHeader.$el,\n\t\t\t},\n\t\t\tfooter: ContentFooter,\n\t\t\tfooterOptions: {\n\t\t\t\tcontent: this.$refs.dialogFooter.$el,\n\t\t\t},\n\t\t});\n\n\t\tEvent.bind(this.dialog.getRecentTab().getContainer(), 'scroll', this.loadOnScroll);\n\t\tEvent.EventEmitter.subscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\tEvent.EventEmitter.subscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t\tfavoritesIds: `${Model.Favorites}/get`,\n\t\t\tresources: `${Model.Resources}/get`,\n\t\t\tisFilterMode: `${Model.Interface}/isFilterMode`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\tisLoaded: `${Model.Interface}/isLoaded`,\n\t\t\tmainResources: `${Model.MainResources}/resources`,\n\t\t}),\n\t\tmainResourceIds(): Set<number>\n\t\t{\n\t\t\treturn new Set(this.mainResources);\n\t\t},\n\t\tisDefaultState(): boolean\n\t\t{\n\t\t\treturn this.mainResourceIds.size === this.favoritesIds.length\n\t\t\t\t&& this.favoritesIds.every((id: number) => this.mainResourceIds.has(id));\n\t\t},\n\t},\n\tmethods: {\n\t\tshowDialog(): void\n\t\t{\n\t\t\tthis.updateItems();\n\t\t\tvoid this.loadMainResources();\n\n\t\t\tthis.dialog.show();\n\t\t},\n\t\tasync onShow(): Promise<void>\n\t\t{\n\t\t\tif (this.dialogFilled)\n\t\t\t{\n\t\t\t\tvoid this.loadOnScroll();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.dialogFilled = true;\n\n\t\t\tawait resourceDialogService.fillDialog(this.selectedDateTs / 1000);\n\t\t},\n\t\tasync loadOnScroll(): Promise<void>\n\t\t{\n\t\t\tconst container = this.dialog.getRecentTab().getContainer();\n\t\t\tconst scrollTop = container.scrollTop;\n\t\t\tconst maxScroll = container.scrollHeight - container.offsetHeight;\n\n\t\t\tif (scrollTop + 10 >= maxScroll)\n\t\t\t{\n\t\t\t\tconst loadedResourcesIds = resourcesDateCache.getIdsByDateTs(this.selectedDateTs / 1000);\n\t\t\t\tconst resourcesIds = this.resources.map((resource: ResourceModel) => resource.id);\n\t\t\t\tconst idsToLoad = resourcesIds\n\t\t\t\t\t.filter((id: number) => !loadedResourcesIds.includes(id))\n\t\t\t\t\t.slice(0, Limit.ResourcesDialog)\n\t\t\t\t;\n\n\t\t\t\tawait resourceDialogService.loadByIds(idsToLoad, this.selectedDateTs / 1000);\n\n\t\t\t\tthis.updateItems();\n\t\t\t}\n\t\t},\n\t\tasync loadMainResources(): Promise<void>\n\t\t{\n\t\t\tawait resourceDialogService.getMainResources();\n\t\t},\n\t\tupdateItems(): void\n\t\t{\n\t\t\tthis.dialog.getItems().forEach((item: Item) => {\n\t\t\t\tconst id = item.getId();\n\t\t\t\tconst workload = this.workloadRefs[id];\n\t\t\t\tconst isHidden = this.isItemHidden(id);\n\t\t\t\tconst isSelected = this.isItemSelected(id);\n\n\t\t\t\titem.getNodes().forEach((node) => {\n\t\t\t\t\tconst avatarContainer = node.getAvatarContainer();\n\t\t\t\t\tDom.style(avatarContainer, 'width', 'max-content');\n\t\t\t\t\tDom.style(avatarContainer, 'height', 'max-content');\n\t\t\t\t\tDom.append(workload, avatarContainer);\n\t\t\t\t});\n\n\t\t\t\titem.setHidden(isHidden);\n\n\t\t\t\tif (!item.isSelected() && isSelected)\n\t\t\t\t{\n\t\t\t\t\titem.select();\n\t\t\t\t}\n\n\t\t\t\tif (item.isSelected() && !isSelected)\n\t\t\t\t{\n\t\t\t\t\titem.deselect();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tsaveItems(): void\n\t\t{\n\t\t\tvoid hideResources(this.dialog.getSelectedItems().map((item) => item.id));\n\t\t},\n\t\taddItems(resources: ResourceModel[]): void\n\t\t{\n\t\t\tconst itemsOptions: { [id: number]: ItemOptions } = resources.reduce((acc, resource: ResourceModel) => ({\n\t\t\t\t...acc,\n\t\t\t\t[resource.id]: this.getItemOptions(resource),\n\t\t\t}), {});\n\n\t\t\tObject.values(itemsOptions).forEach((itemOptions: ItemOptions) => this.dialog.addItem(itemOptions));\n\n\t\t\tconst itemsIds = this.dialog.getItems().map((item: Item) => item.getId())\n\t\t\t\t.filter((id: number) => itemsOptions[id])\n\t\t\t;\n\n\t\t\tthis.dialog.removeItems();\n\t\t\titemsIds.forEach((id: number) => this.dialog.addItem(itemsOptions[id]));\n\n\t\t\t// I don't know why, but tab is being removed after this.dialog.removeItems();\n\t\t\tconst tab = this.dialog.getActiveTab();\n\t\t\tif (tab)\n\t\t\t{\n\t\t\t\ttab.getContainer().append(tab.getRootNode().getChildrenContainer());\n\t\t\t\ttab.render();\n\t\t\t}\n\n\t\t\tthis.updateItems();\n\n\t\t\tif (Type.isStringFilled(this.query))\n\t\t\t{\n\t\t\t\tvoid this.search(this.query);\n\t\t\t}\n\t\t},\n\t\tgetItemOptions(resource: ResourceModel): ItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: resource.id,\n\t\t\t\tentityId: EntitySelectorEntity.Resource,\n\t\t\t\ttitle: resource.name,\n\t\t\t\tsubtitle: this.getResourceType(resource.typeId).name,\n\t\t\t\tavatarOptions: {\n\t\t\t\t\tbgImage: 'none',\n\t\t\t\t\tborderRadius: '0',\n\t\t\t\t},\n\t\t\t\ttabs: EntitySelectorTab.Recent,\n\t\t\t\tselected: this.isItemSelected(resource.id),\n\t\t\t\thidden: this.isItemHidden(resource.id),\n\t\t\t\tnodeAttributes: {\n\t\t\t\t\t'data-id': resource.id,\n\t\t\t\t\t'data-element': 'booking-select-resources-dialog-item',\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tisItemSelected(id: number): boolean\n\t\t{\n\t\t\treturn this.favoritesIds.includes(id);\n\t\t},\n\t\tisItemHidden(id: number): boolean\n\t\t{\n\t\t\tconst loadedResourcesIds = resourcesDateCache.getIdsByDateTs(this.selectedDateTs / 1000);\n\t\t\tconst resource = this.getResource(id);\n\t\t\tconst visible = loadedResourcesIds.includes(id) && resource && this.selectedTypes[resource.typeId];\n\n\t\t\treturn !visible;\n\t\t},\n\t\tgetResource(id: number): ResourceModel\n\t\t{\n\t\t\treturn this.$store.getters['resources/getById'](id);\n\t\t},\n\t\tgetResourceType(id: number): ResourceTypeModel\n\t\t{\n\t\t\treturn this.$store.getters['resourceTypes/getById'](id);\n\t\t},\n\t\tasync search(query: string): Promise<void>\n\t\t{\n\t\t\tthis.query = query;\n\n\t\t\tthis.dialog.search(this.query);\n\t\t\tthis.updateItems();\n\t\t\tthis.dialog.getSearchTab().getStub().hide();\n\t\t\tthis.dialog.getSearchTab().getSearchLoader().show();\n\n\t\t\tawait resourceDialogService.doSearch(this.query, this.selectedDateTs / 1000);\n\n\t\t\tthis.dialog.search(this.query);\n\t\t\tthis.updateItems();\n\t\t\tthis.dialog.getSearchTab().getSearchLoader().hide();\n\t\t\tif (this.dialog.getSearchTab().isEmptyResult())\n\t\t\t{\n\t\t\t\tthis.dialog.getSearchTab().getStub().show();\n\t\t\t}\n\t\t},\n\t\tstartResize(): void\n\t\t{\n\t\t\tthis.dialog.freeze();\n\t\t},\n\t\tendResize(): void\n\t\t{\n\t\t\tsetTimeout(() => this.dialog.unfreeze());\n\t\t},\n\t\tselectAll(): void\n\t\t{\n\t\t\tthis.dialog.getItems().forEach((item: Item) => {\n\t\t\t\tif (!item.isHidden())\n\t\t\t\t{\n\t\t\t\t\titem.select();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tdeselectAll(): void\n\t\t{\n\t\t\tthis.dialog.getItems().forEach((item: Item) => {\n\t\t\t\tif (!item.isHidden())\n\t\t\t\t{\n\t\t\t\t\titem.deselect();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tsetWorkloadRef(element: HTMLElement, id: number): void\n\t\t{\n\t\t\tthis.workloadRefs[id] = element;\n\t\t},\n\t\ttryShowAhaMoment(): void\n\t\t{\n\t\t\tif (ahaMoments.shouldShow(AhaMoment.SelectResources))\n\t\t\t{\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t\t\t\tvoid this.showAhaMoment();\n\t\t\t}\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-select-resources',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_SELECT_RESOURCES_TITLE'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_SELECT_RESOURCES_TEXT'),\n\t\t\t\tarticle: HelpDesk.AhaSelectResources,\n\t\t\t\ttarget: this.$refs.button,\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.SelectResources);\n\t\t},\n\t\treset(): void\n\t\t{\n\t\t\tconst mainResourceIds: Set<number> = this.mainResourceIds;\n\n\t\t\tthis.dialog.getItems().forEach((item: Item) => {\n\t\t\t\tif (mainResourceIds.has(item.id))\n\t\t\t\t{\n\t\t\t\t\titem.select();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\titem.deselect();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\twatch: {\n\t\tfavoritesIds(): void\n\t\t{\n\t\t\tthis.updateItems();\n\t\t},\n\t\tresources: {\n\t\t\thandler(resources: ResourceModel[]): void\n\t\t\t{\n\t\t\t\tsetTimeout(() => this.addItems(resources));\n\t\t\t\tresourceDialogService.clearMainResourcesCache();\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t\tselectedTypes: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.updateItems();\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t\tisLoaded(): void\n\t\t{\n\t\t\tthis.tryShowAhaMoment();\n\t\t},\n\t},\n\tcomponents: {\n\t\tDialogHeader,\n\t\tDialogFooter,\n\t\tResourceWorkload,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-select-resources\"\n\t\t\t:class=\"{'--disabled': isFilterMode}\"\n\t\t\tdata-element=\"booking-select-resources\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"showDialog\"\n\t\t>\n\t\t\t<div class=\"ui-icon-set --funnel\"></div>\n\t\t</div>\n\t\t<DialogHeader\n\t\t\tref=\"dialogHeader\"\n\t\t\tv-model=\"selectedTypes\"\n\t\t\t@search=\"search\"\n\t\t\t@startResize=\"startResize\"\n\t\t\t@endResize=\"endResize\"\n\t\t\t@selectAll=\"selectAll\"\n\t\t\t@deselectAll=\"deselectAll\"\n\t\t/>\n\t\t<DialogFooter\n\t\t\tv-show=\"dialogFilled && !isDefaultState\"\n\t\t\tref=\"dialogFooter\"\n\t\t\t@reset=\"reset\"\n\t\t/>\n\t\t<div class=\"booking-booking-select-resources-workload-container\">\n\t\t\t<template v-for=\"resource of resources\">\n\t\t\t\t<span class=\"booking-booking-select-resources-workload\" :ref=\"(el) => setWorkloadRef(el, resource.id)\">\n\t\t\t\t\t<ResourceWorkload :resourceId=\"resource.id\"/>\n\t\t\t\t</span>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport { Resource } from './resource/resource';\nimport { AddResourceButton } from './add-resource-button/add-resource-button';\nimport { SelectResources } from './select-resources/select-resources';\nimport './header.css';\n\nexport const Header = {\n\tcomputed: mapGetters({\n\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\tscroll: `${Model.Interface}/scroll`,\n\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t}),\n\twatch: {\n\t\tscroll(value): void\n\t\t{\n\t\t\tthis.$refs.inner.scrollLeft = value;\n\t\t},\n\t},\n\tcomponents: {\n\t\tResource,\n\t\tAddResourceButton,\n\t\tSelectResources,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-header\">\n\t\t\t<SelectResources/>\n\t\t\t<div\n\t\t\t\tclass=\"booking-booking-header-inner\"\n\t\t\t\tref=\"inner\"\n\t\t\t\t@scroll=\"$store.dispatch('interface/setScroll', $refs.inner.scrollLeft)\"\n\t\t\t>\n\t\t\t\t<TransitionGroup name=\"booking-transition-resource\">\n\t\t\t\t\t<template v-for=\"resourceId of resourcesIds\" :key=\"resourceId\">\n\t\t\t\t\t\t<Resource :resourceId=\"resourceId\"/>\n\t\t\t\t\t</template>\n\t\t\t\t</TransitionGroup>\n\t\t\t\t<AddResourceButton v-if=\"!isEditingBookingMode\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Dialog, Item } from 'ui.entity-selector';\n\nimport { EntitySelectorEntity, EntitySelectorTab, Model } from 'booking.const';\nimport { limit } from 'booking.lib.limit';\nimport type { ResourceTypeModel } from 'booking.model.resource-types';\nimport type { ResourceModel } from 'booking.model.resources';\nimport './multiple.css';\n\nexport const Multiple = {\n\temits: [\n\t\t'change',\n\t],\n\tprops: {\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisSelected: false,\n\t\t\tselectedItems: [],\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.selector = this.createSelector();\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.selector.destroy();\n\t\tthis.selector = null;\n\t},\n\tmethods: {\n\t\tcreateSelector(): Dialog\n\t\t{\n\t\t\treturn new Dialog({\n\t\t\t\tid: `booking-intersection-selector-resource-${this.resourceId}`,\n\t\t\t\ttargetNode: this.$refs.intersectionField,\n\t\t\t\twidth: 400,\n\t\t\t\tenableSearch: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tcontext: 'bookingResourceIntersection',\n\t\t\t\tmultiple: true,\n\t\t\t\tcacheable: true,\n\t\t\t\tshowAvatars: false,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: EntitySelectorEntity.Resource,\n\t\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\tlabel: this.loc('BOOKING_BOOKING_ADD_INTERSECTION_DIALOG_SEARCH_FOOTER'),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonHide: this.changeSelected.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tshowSelector(): void\n\t\t{\n\t\t\tif (this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tthis.selector.show();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlimit.show();\n\t\t\t}\n\t\t},\n\t\tchangeSelected(): void\n\t\t{\n\t\t\tthis.selectedItems = this.selector.getSelectedItems();\n\n\t\t\tthis.isSelected = this.selectedItems.length > 0;\n\n\t\t\tconst selectedIds = this.selectedItems.map((item) => item.id);\n\n\t\t\tthis.$emit('change', selectedIds, this.resourceId);\n\t\t},\n\t\thandleRemove(itemId: number): void\n\t\t{\n\t\t\tthis.selector.getItem([EntitySelectorEntity.Resource, itemId]).deselect();\n\n\t\t\tthis.changeSelected();\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\t\tresources: `${Model.Resources}/get`,\n\t\t}),\n\t\tfirstItemTitle(): string\n\t\t{\n\t\t\treturn this.selectedItems.length > 0 ? this.selectedItems[0].title : '';\n\t\t},\n\t\tremainingItemsCount(): number\n\t\t{\n\t\t\treturn this.selectedItems.length > 1 ? this.selectedItems.length - 1 : 0;\n\t\t},\n\t},\n\twatch: {\n\t\tresourcesIds(resourcesIds: number[], previousResourcesIds: number[]): void\n\t\t{\n\t\t\tconst deletedIds = previousResourcesIds.filter((id: number) => !resourcesIds.includes(id));\n\t\t\tconst newIds = resourcesIds.filter((id: number) => !previousResourcesIds.includes(id));\n\n\t\t\tdeletedIds.forEach((id: number) => {\n\t\t\t\tconst item: Item = this.selector.getItem([EntitySelectorEntity.Resource, id]);\n\t\t\t\tthis.selector.removeItem(item);\n\t\t\t});\n\n\t\t\tnewIds.forEach((id: number) => {\n\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](id);\n\t\t\t\tconst resourceType: ResourceTypeModel = this.$store.getters[`${Model.ResourceTypes}/getById`](resource.typeId);\n\n\t\t\t\tthis.selector.addItem({\n\t\t\t\t\tid,\n\t\t\t\t\tentityId: EntitySelectorEntity.Resource,\n\t\t\t\t\ttitle: resource.name,\n\t\t\t\t\tsubtitle: resourceType.name,\n\t\t\t\t\ttabs: EntitySelectorTab.Recent,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.changeSelected();\n\t\t},\n\t\tresources: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.selector.getItems().forEach((item: Item) => {\n\t\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](item.getId());\n\t\t\t\t\tif (!resource)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst resourceType: ResourceTypeModel = this.$store.getters[`${Model.ResourceTypes}/getById`](resource.typeId);\n\n\t\t\t\t\titem.setTitle(resource.name);\n\t\t\t\t\titem.setSubtitle(resourceType.name);\n\t\t\t\t});\n\n\t\t\t\tthis.selector.getTagSelector().getTags().forEach((tag) => {\n\t\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](tag.getId());\n\t\t\t\t\tif (!resource)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\ttag.setTitle(resource.name);\n\t\t\t\t\ttag.render();\n\t\t\t\t});\n\n\t\t\t\tthis.selectedItems = this.selector.getSelectedItems();\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"intersectionField\"\n\t\t\tclass=\"booking-booking-intersections-resource\"\n\t\t\t:data-id=\"'booking-booking-intersections-resource-' + resourceId\"\n\t\t>\n\t\t\t<template v-if=\"isSelected\">\n\t\t\t\t<div\n\t\t\t\t\tref=\"selectorItemContainer\"\n\t\t\t\t\tclass=\"booking-booking-intersections-resource-container\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"selectedItems.length > 0\"\n\t\t\t\t\t\tclass=\"bbi-resource-selector-item bbi-resource-selector-tag\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"bbi-resource-selector-tag-content\" :title=\"firstItemTitle\">\n\t\t\t\t\t\t\t<div class=\"bbi-resource-selector-tag-title\">{{ firstItemTitle }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tclass=\"bbi-resource-selector-tag-remove\"\n\t\t\t\t\t\t\t@click=\"handleRemove(selectedItems[0].id)\"\n\t\t\t\t\t\t\t:data-id=\"'bbi-resource-selector-tag-remove-' + resourceId\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"remainingItemsCount > 0\"\n\t\t\t\t\t\tclass=\"bbi-resource-selector-item bbi-resource-selector-tag --count\"\n\t\t\t\t\t\t@click=\"showSelector\"\n\t\t\t\t\t\t:data-id=\"'bbi-resource-selector-tag-count-' + resourceId\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"bbi-resource-selector-tag-content\">\n\t\t\t\t\t\t\t<div class=\"bbi-resource-selector-tag-title --count\">+{{ remainingItemsCount }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"bbi-resource-selector-item bbi-resource-selector-add-button\"\n\t\t\t\t\t\t\t@click=\"showSelector\"\n\t\t\t\t\t\t\t:data-id=\"'bbi-resource-selector-add-button' + resourceId\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"bbi-resource-selector-add-button-caption\">\n\t\t\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_INTERSECTION_BUTTON_MORE') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<span\n\t\t\t\t\tref=\"selectorButton\"\n\t\t\t\t\tclass=\"bbi-resource-selector-item bbi-resource-selector-add-button\"\n\t\t\t\t\t@click=\"showSelector\"\n\t\t\t\t\t:data-id=\"'bbi-resource-selector-add-button' + resourceId\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"bbi-resource-selector-add-button-caption\">\n\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_INTERSECTION_BUTTON') }}\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Item, TagSelector } from 'ui.entity-selector';\n\nimport { AhaMoment, EntitySelectorEntity, EntitySelectorTab, HelpDesk, Model } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { limit } from 'booking.lib.limit';\nimport type { ResourceModel } from 'booking.model.resources';\nimport type { ResourceTypeModel } from 'booking.model.resource-types';\nimport './single.css';\n\nexport const Single = {\n\temits: ['change'],\n\tcreated(): void\n\t{\n\t\tthis.selector = this.createSelector();\n\n\t\tif (!this.isFeatureEnabled)\n\t\t{\n\t\t\tthis.selector.lock();\n\t\t}\n\t},\n\tmounted(): void\n\t{\n\t\tthis.mountSelector();\n\n\t\tEvent.EventEmitter.subscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\tEvent.EventEmitter.subscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.destroySelector();\n\t},\n\tcomputed: mapGetters({\n\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\tintersections: `${Model.Interface}/intersections`,\n\t\tisLoaded: `${Model.Interface}/isLoaded`,\n\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\tresources: `${Model.Resources}/get`,\n\t}),\n\tmethods: {\n\t\tcreateSelector(): TagSelector\n\t\t{\n\t\t\treturn new TagSelector({\n\t\t\t\tmultiple: true,\n\t\t\t\taddButtonCaption: this.loc('BOOKING_BOOKING_ADD_INTERSECTION'),\n\t\t\t\tshowCreateButton: false,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\theader: this.loc('BOOKING_BOOKING_ADD_INTERSECTION_DIALOG_HEADER'),\n\t\t\t\t\tcontext: 'bookingResourceIntersection',\n\t\t\t\t\twidth: 290,\n\t\t\t\t\theight: 340,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\tenableSearch: true,\n\t\t\t\t\tcacheable: true,\n\t\t\t\t\tshowAvatars: false,\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: EntitySelectorEntity.Resource,\n\t\t\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\t\tlabel: this.loc('BOOKING_BOOKING_ADD_INTERSECTION_DIALOG_SEARCH_FOOTER'),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonAfterTagAdd: this.onSelectorChange,\n\t\t\t\t\tonAfterTagRemove: this.onSelectorChange,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tonSelectorChange(): void\n\t\t{\n\t\t\tconst selectedIds = this.selector.getDialog().getSelectedItems().map(({ id }) => id);\n\n\t\t\tthis.$emit('change', selectedIds);\n\t\t},\n\t\tmountSelector(): void\n\t\t{\n\t\t\tthis.selector.renderTo(this.$refs.intersectionField);\n\t\t},\n\t\tdestroySelector(): void\n\t\t{\n\t\t\tthis.selector.getDialog().destroy();\n\t\t\tthis.selector = null;\n\t\t\tthis.$refs.intersectionField.innerHTML = '';\n\t\t},\n\t\tgetResource(id: number): ResourceModel\n\t\t{\n\t\t\treturn this.$store.getters['resources/getById'](id);\n\t\t},\n\t\tgetResourceType(id: number): ResourceTypeModel\n\t\t{\n\t\t\treturn this.$store.getters['resourceTypes/getById'](id);\n\t\t},\n\t\ttryShowAhaMoment(): void\n\t\t{\n\t\t\tif (\n\t\t\t\tahaMoments.shouldShow(AhaMoment.ResourceIntersection)\n\t\t\t\t&& this.selector\n\t\t\t)\n\t\t\t{\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t\t\t\tvoid this.showAhaMoment();\n\t\t\t}\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-resource-intersection',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_RESOURCE_INTERSECTION_TITLE'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_RESOURCE_INTERSECTION_TEXT'),\n\t\t\t\tarticle: HelpDesk.AhaResourceIntersection,\n\t\t\t\ttarget: this.selector.getAddButton(),\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.ResourceIntersection);\n\t\t},\n\t\tclick(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tintersections(intersections: Object): void\n\t\t{\n\t\t\tif (!this.isEditingBookingMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst resourcesIds = intersections[0] ?? [];\n\n\t\t\tresourcesIds.forEach((id: number): void => {\n\t\t\t\tconst resource = this.getResource(id);\n\n\t\t\t\tthis.selector.getDialog().addItem({\n\t\t\t\t\tid: resource.id,\n\t\t\t\t\tentityId: EntitySelectorEntity.Resource,\n\t\t\t\t\ttitle: resource.name,\n\t\t\t\t\tsubtitle: this.getResourceType(resource.typeId).name,\n\t\t\t\t\tselected: true,\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tisLoaded(): void\n\t\t{\n\t\t\tthis.tryShowAhaMoment();\n\t\t},\n\t\tresourcesIds(resourcesIds: number[], previousResourcesIds: number[]): void\n\t\t{\n\t\t\tconst deletedIds = previousResourcesIds.filter((id: number) => !resourcesIds.includes(id));\n\t\t\tconst newIds = resourcesIds.filter((id: number) => !previousResourcesIds.includes(id));\n\n\t\t\tdeletedIds.forEach((id: number) => {\n\t\t\t\tconst item: Item = this.selector.getDialog().getItem([EntitySelectorEntity.Resource, id]);\n\t\t\t\tthis.selector.getDialog().removeItem(item);\n\n\t\t\t\tconst tag = this.selector.getTags().find((it) => it.getId() === id);\n\t\t\t\ttag?.remove();\n\t\t\t});\n\n\t\t\tnewIds.forEach((id: number) => {\n\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](id);\n\t\t\t\tconst resourceType: ResourceTypeModel = this.$store.getters[`${Model.ResourceTypes}/getById`](resource.typeId);\n\n\t\t\t\tthis.selector.getDialog().addItem({\n\t\t\t\t\tid,\n\t\t\t\t\tentityId: EntitySelectorEntity.Resource,\n\t\t\t\t\ttitle: resource.name,\n\t\t\t\t\tsubtitle: resourceType.name,\n\t\t\t\t\ttabs: EntitySelectorTab.Recent,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.onSelectorChange();\n\n\t\t\tthis.tryShowAhaMoment();\n\t\t},\n\t\tresources: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.selector.getDialog().getItems().forEach((item: Item) => {\n\t\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](item.getId());\n\t\t\t\t\tif (!resource)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst resourceType: ResourceTypeModel = this.$store.getters[`${Model.ResourceTypes}/getById`](resource.typeId);\n\n\t\t\t\t\titem.setTitle(resource.name);\n\t\t\t\t\titem.setSubtitle(resourceType.name);\n\t\t\t\t});\n\n\t\t\t\tthis.selector.getTags().forEach((tag) => {\n\t\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](tag.getId());\n\t\t\t\t\tif (!resource)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\ttag.setTitle(resource.name);\n\t\t\t\t\ttag.render();\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"intersectionField\"\n\t\t\tclass=\"booking-booking-intersections-line\"\n\t\t\tdata-id=\"booking-booking-intersections-line\"\n\t\t\t@click=\"click\"\n\t\t></div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Dom } from 'main.core';\nimport { MenuManager, MenuItem } from 'main.popup';\nimport { Set as IconSet } from 'ui.icon-set.api.core';\nimport { BIcon as Icon } from 'ui.icon-set.api.vue';\nimport { HelpDesk, Model, Option } from 'booking.const';\nimport { optionService } from 'booking.provider.service.option-service';\nimport { limit } from 'booking.lib.limit';\nimport { helpDesk } from 'booking.lib.help-desk';\nimport { busySlots } from '../../lib/busy-slots/busy-slots';\nimport { Multiple } from './multiple/multiple';\nimport { Single } from './single/single';\n\nimport './intersections.css';\n\nexport const Intersections = {\n\tcomponents: {\n\t\tIcon,\n\t\tMultiple,\n\t\tSingle,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tintersectionModeMenuItemId: 'booking-intersection-menu-mode',\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.menu = MenuManager.create(\n\t\t\t'booking-intersection-menu',\n\t\t\tthis.$refs.intersectionMenu,\n\t\t\tthis.getMenuItems(),\n\t\t\t{\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: true,\n\t\t\t},\n\t\t);\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.menu.destroy();\n\t\tthis.menu = null;\n\t},\n\tmethods: {\n\t\tshowMenu(): void\n\t\t{\n\t\t\tif (this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tthis.menu.show();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlimit.show();\n\t\t\t}\n\t\t},\n\t\tgetMenuItems(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: this.intersectionModeMenuItemId,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\tid: this.intersectionModeMenuItemId,\n\t\t\t\t\t},\n\t\t\t\t\ttext: this.loc('BOOKING_BOOKING_INTERSECTION_MENU_ALL'),\n\t\t\t\t\tclassName: (\n\t\t\t\t\t\tthis.isIntersectionForAll\n\t\t\t\t\t\t\t? 'menu-popup-item menu-popup-item-accept'\n\t\t\t\t\t\t\t: 'menu-popup-item menu-popup-no-icon'\n\t\t\t\t\t),\n\t\t\t\t\tonclick: async (event: PointerEvent, item: MenuItem) => {\n\t\t\t\t\t\tthis.menu.close();\n\n\t\t\t\t\t\tconst value = !this.isIntersectionForAll;\n\n\t\t\t\t\t\tawait this.$store.dispatch(`${Model.Interface}/setIntersectionMode`, value);\n\t\t\t\t\t\tawait optionService.setBool(Option.IntersectionForAll, value);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdelimiter: true,\n\t\t\t\t},\n\t\t\t\t// {\n\t\t\t\t// \tid: 'booking-intersection-menu-settings',\n\t\t\t\t// \tdataset: {\n\t\t\t\t// \t\tid: 'booking-intersection-menu-settings',\n\t\t\t\t// \t},\n\t\t\t\t// \ttext: this.loc('BOOKING_BOOKING_INTERSECTION_MENU_SETTINGS'),\n\t\t\t\t// \tonclick: () => {},\n\t\t\t\t// },\n\t\t\t\t{\n\t\t\t\t\tid: 'booking-intersection-menu-info',\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\tid: 'booking-intersection-menu-info',\n\t\t\t\t\t},\n\t\t\t\t\ttext: this.loc('BOOKING_BOOKING_INTERSECTION_MENU_HOW'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\thelpDesk.show(\n\t\t\t\t\t\t\tHelpDesk.Intersection.code,\n\t\t\t\t\t\t\tHelpDesk.Intersection.anchorCode,\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tasync showIntersections(selectedResourceIds: number[], resourceId: number = 0): void\n\t\t{\n\t\t\tconst intersections = {\n\t\t\t\t...(resourceId === 0 ? {} : this.intersections),\n\t\t\t\t[resourceId]: selectedResourceIds,\n\t\t\t};\n\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/setIntersections`, intersections);\n\n\t\t\tawait busySlots.loadBusySlots();\n\t\t},\n\t\ttoggleMenuItemActivityState(item: MenuItem)\n\t\t{\n\t\t\tDom.toggleClass(item.getContainer(), 'menu-popup-item-accept');\n\t\t\tDom.toggleClass(item.getContainer(), 'menu-popup-no-icon');\n\t\t},\n\t},\n\twatch: {\n\t\tasync isIntersectionForAll(): void\n\t\t{\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/setIntersections`, {});\n\n\t\t\tawait busySlots.loadBusySlots();\n\n\t\t\tthis.toggleMenuItemActivityState(\n\t\t\t\tthis.menu.getMenuItem(this.intersectionModeMenuItemId),\n\t\t\t);\n\t\t},\n\t\tscroll(value): void\n\t\t{\n\t\t\tif (this.$refs.inner)\n\t\t\t{\n\t\t\t\tthis.$refs.inner.scrollLeft = value;\n\t\t\t}\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\t\tbookings: `${Model.Bookings}/get`,\n\t\t\tisFilterMode: `${Model.Interface}/isFilterMode`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\tintersections: `${Model.Interface}/intersections`,\n\t\t\tisIntersectionForAll: `${Model.Interface}/isIntersectionForAll`,\n\t\t\tscroll: `${Model.Interface}/scroll`,\n\t\t\tisLoaded: `${Model.Interface}/isLoaded`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\thasIntersections(): boolean\n\t\t{\n\t\t\treturn Object.values(this.intersections).some((resourcesIds: number[]) => resourcesIds.length > 0);\n\t\t},\n\t\tdisabled(): boolean\n\t\t{\n\t\t\treturn !this.isLoaded || this.isFilterMode || this.isEditingBookingMode;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-intersections\" :class=\"{'--disabled': disabled}\">\n\t\t\t<div\n\t\t\t\tref=\"intersectionMenu\"\n\t\t\t\tclass=\"booking-booking-intersections-left-panel\"\n\t\t\t\t:class=\"{'--active': hasIntersections}\"\n\t\t\t\t@click=\"showMenu\"\n\t\t\t\tdata-id=\"booking-intersections-left-panel-menu\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --double-rhombus\"></div>\n\t\t\t\t<div v-if=\"!isFeatureEnabled\" class=\"booking-lock-icon-container\">\n\t\t\t\t\t<Icon :name=\"IconSet.LOCK\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<template v-if=\"isIntersectionForAll\">\n\t\t\t\t<Single @change=\"showIntersections\"/>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div\n\t\t\t\t\tref=\"inner\"\n\t\t\t\t\tclass=\"booking-booking-intersections-inner\"\n\t\t\t\t\t@scroll=\"$store.dispatch('interface/setScroll', $refs.inner.scrollLeft)\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"booking-booking-intersections-row\">\n\t\t\t\t\t\t<div class=\"booking-booking-intersections-row-inner\">\n\t\t\t\t\t\t\t<template\n\t\t\t\t\t\t\t\tv-for=\"resourceId of resourcesIds\"\n\t\t\t\t\t\t\t\t:key=\"resourceId\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Multiple :resourceId=\"resourceId\" @change=\"showIntersections\"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"booking-booking-intersections-inner-blank\"></div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Grid } from '../grid/grid';\nimport { Header } from '../header/header';\nimport { Intersections } from '../intersections/intersections';\nimport './base-component.css';\n\nexport const BaseComponent = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tDateTimeFormat,\n\t\t};\n\t},\n\tcomputed: mapGetters({\n\t\tfromHour: 'interface/fromHour',\n\t\ttoHour: 'interface/toHour',\n\t\tzoom: 'interface/zoom',\n\t}),\n\tcomponents: {\n\t\tHeader,\n\t\tIntersections,\n\t\tGrid,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tid=\"booking-content\"\n\t\t\tclass=\"booking\"\n\t\t\t:style=\"{\n\t\t\t\t'--from-hour': fromHour,\n\t\t\t\t'--to-hour': toHour,\n\t\t\t\t'--zoom': zoom,\n\t\t\t}\"\n\t\t\t:class=\"{\n\t\t\t\t'--zoom-is-less-than-07': zoom < 0.7,\n\t\t\t\t'--zoom-is-less-than-08': zoom < 0.8,\n\t\t\t\t'--am-pm-mode': DateTimeFormat.isAmPmMode(),\n\t\t\t}\"\n\t\t>\n\t\t\t<Header/>\n\t\t\t<Intersections/>\n\t\t\t<Grid/>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { Button as UiButton, ButtonSize, ButtonColor } from 'booking.component.button';\n\nexport const BookingMultipleButton = {\n\tname: 'BookingMultipleButton',\n\temits: ['book'],\n\tprops: {\n\t\tfetching: Boolean,\n\t},\n\tcomputed: {\n\t\ttext(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_MULTI_BUTTON_LABEL');\n\t\t},\n\t\tsize(): string\n\t\t{\n\t\t\treturn ButtonSize.SMALL;\n\t\t},\n\t\tcolor(): string\n\t\t{\n\t\t\treturn ButtonColor.SUCCESS;\n\t\t},\n\t},\n\tcomponents: {\n\t\tUiButton,\n\t},\n\ttemplate: `\n\t\t<UiButton\n\t\t\t:text\n\t\t\t:size\n\t\t\t:color\n\t\t\t:waiting=\"fetching\"\n\t\t\t@click=\"$emit('book')\"\n\t\t/>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport { Button as UiButton, ButtonSize, ButtonColor } from 'booking.component.button';\nimport { Duration } from 'booking.lib.duration';\n\nexport const MultiBookingItem = {\n\tname: 'MultiBookingItem',\n\temits: ['remove-selected'],\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tfromTs: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\ttoTs: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toffset: `${Model.Interface}/offset`,\n\t\t}),\n\t\tlabel(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_MULTI_ITEM_TITLE', {\n\t\t\t\t'#DATE#': DateTimeFormat.format('d M H:i', (this.fromTs + this.offset) / 1000),\n\t\t\t\t'#DURATION#': new Duration(this.toTs - this.fromTs).format(),\n\t\t\t});\n\t\t},\n\t\tbuttonColor(): string\n\t\t{\n\t\t\treturn ButtonColor.LINK;\n\t\t},\n\t\tbuttonSize(): string\n\t\t{\n\t\t\treturn ButtonSize.EXTRA_SMALL;\n\t\t},\n\t},\n\tcomponents: {\n\t\tUiButton,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking--multi-booking--book\">\n\t\t\t<label>\n\t\t\t\t{{ label }}\n\t\t\t</label>\n\t\t\t<button\n\t\t\t\t:class=\"[buttonSize, buttonColor, 'ui-btn ui-icon-set --cross-20']\"\n\t\t\t\ttype=\"button\"\n\t\t\t\t@click=\"$emit('remove-selected', this.id)\">\n\t\t\t</button>\n\t\t</div>\n\t`,\n};\n","import { Ears } from 'ui.ears';\nimport { Model } from 'booking.const';\nimport { MultiBookingItem } from './multi-booking-item';\nimport './multi-booking-items-list.css';\n\nexport const MultiBookingItemsList = {\n\tname: 'MultiBookingItemsList',\n\temits: ['remove-selected'],\n\tcomputed: {\n\t\tselectedCells(): Object\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Interface}/selectedCells`];\n\t\t},\n\t\tselectedCellsCount(): number\n\t\t{\n\t\t\treturn Object.keys(this.selectedCells).length;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.ears = new Ears({\n\t\t\tcontainer: this.$refs.wrapper,\n\t\t\tsmallSize: true,\n\t\t\tclassName: 'booking--multi-booking--items-ears',\n\t\t\tnoScrollbar: true,\n\t\t}).init();\n\t},\n\twatch: {\n\t\tselectedCellsCount: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tsetTimeout(() => this.ears.toggleEars(), 0);\n\t\t\t},\n\t\t},\n\t},\n\tcomponents: {\n\t\tMultiBookingItem,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking--multi-booking--book-list\">\n\t\t\t<div ref=\"wrapper\" class=\"booking--multi-booking--books-wrapper\">\n\t\t\t\t<MultiBookingItem\n\t\t\t\t\tv-for=\"cell in selectedCells\"\n\t\t\t\t\t:key=\"cell.id\"\n\t\t\t\t\t:id=\"cell.id\"\n\t\t\t\t\t:from-ts=\"cell.fromTs\"\n\t\t\t\t\t:to-ts=\"cell.toTs\"\n\t\t\t\t\t:resource-id=\"cell.resourceId\"\n\t\t\t\t\t@remove-selected=\"$emit('remove-selected', $event)\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { ButtonSize, ButtonColor } from 'booking.component.button';\nimport { ClientPopup } from 'booking.component.client-popup';\nimport type { CurrentClient } from 'booking.component.client-popup';\nimport { CrmEntity, Model } from 'booking.const';\nimport type { ClientModel } from 'booking.model.clients';\n\nexport const AddClientButton = {\n\tname: 'AddClientButton',\n\temits: ['update:model-value'],\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { isPopupShown: boolean }\n\t{\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tcomputed:\n\t\t{\n\t\t\t...mapGetters({\n\t\t\t\tgetByClientData: `${Model.Clients}/getByClientData`,\n\t\t\t}),\n\t\t\tcolor(): string\n\t\t\t{\n\t\t\t\treturn ButtonColor.LINK;\n\t\t\t},\n\t\t\tsize(): string\n\t\t\t{\n\t\t\t\treturn ButtonSize.EXTRA_SMALL;\n\t\t\t},\n\t\t\tlabel(): string\n\t\t\t{\n\t\t\t\tif (this.modelValue.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn this.loc('BOOKING_MULTI_CLIENT');\n\t\t\t\t}\n\n\t\t\t\treturn this.loc('BOOKING_MULTI_CLIENT_WHIT_NAME', {\n\t\t\t\t\t'#NAME#': this.modelValue.find((client) => client.name)?.name || '',\n\t\t\t\t});\n\t\t\t},\n\t\t\tcurrentClient(): CurrentClient | null\n\t\t\t{\n\t\t\t\tif (this.modelValue.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tcontact: this.findClientByType(CrmEntity.Contact),\n\t\t\t\t\tcompany: this.findClientByType(CrmEntity.Company),\n\t\t\t\t};\n\t\t\t},\n\t\t},\n\tmethods: {\n\t\tcreateClients(clients: Object[])\n\t\t{\n\t\t\tconst clientsData = clients.map((client) => this.getByClientData(client));\n\t\t\tthis.$emit('update:model-value', clientsData);\n\t\t},\n\t\tfindClientByType(clientTypeCode: string): ClientModel\n\t\t{\n\t\t\treturn this.modelValue.find(({ type }) => type.code === clientTypeCode);\n\t\t},\n\t},\n\tcomponents: {\n\t\tClientPopup,\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\t:class=\"['ui-btn', 'booking--multi-booking--client-button', color, size]\"\n\t\t\ttype=\"button\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"isPopupShown = !isPopupShown\"\n\t\t>\n\t\t\t<i class=\"ui-icon-set --customer-card\"></i>\n\t\t\t<span>{{ label }}</span>\n\t\t</button>\n\t\t<ClientPopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:bind-element=\"$refs.button\"\n\t\t\t:currentClient\n\t\t\t@create=\"createClients\"\n\t\t\t@close=\"isPopupShown = false\"/>\n\t`,\n};\n","import { ButtonSize, ButtonColor } from 'booking.component.button';\nimport './cancel-button.css';\n\nexport const CancelButton = {\n\tname: 'CancelButton',\n\temits: ['click'],\n\tcomputed: {\n\t\tcolor(): string\n\t\t{\n\t\t\treturn ButtonColor.LINK;\n\t\t},\n\t\tsize(): string\n\t\t{\n\t\t\treturn ButtonSize.EXTRA_SMALL;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\t:class=\"['ui-btn', 'booking--multi-booking--cancel-button', color, size]\"\n\t\t\ttype=\"button\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"$emit('click')\"\n\t\t>\n\t\t\t<i \n\t\t\t\tclass=\"ui-icon-set --cross-25\" \n\t\t\t\tstyle=\"--ui-icon-set__icon-base-color: rgba(var(--ui-color-palette-white-base-rgb), 0.3);--ui-icon-set__icon-size: var(--ui-size-2xl)\"></i>\n\t\t</button>\n\t`,\n};\n","import { Loc, Text } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { ClientModel } from 'booking.model.clients';\n\nimport { BookingMultipleButton } from './booking-multiple-button/booking-multiple-button';\nimport { MultiBookingItemsList } from './multi-booking-items-list/multi-booking-items-list';\nimport { AddClientButton } from './add-client-button/add-client-button';\nimport { CancelButton } from './cancel-button/cancel-button';\nimport './multi-booking.css';\n\nexport const MultiBooking = {\n\tname: 'MultiBooking',\n\tdata(): { fetching: boolean, clients: ClientModel[] }\n\t{\n\t\treturn {\n\t\t\tfetching: false,\n\t\t\tclients: [],\n\t\t};\n\t},\n\tcomputed: mapGetters({\n\t\tselectedCells: `${Model.Interface}/selectedCells`,\n\t\ttimezone: `${Model.Interface}/timezone`,\n\t}),\n\tmethods: {\n\t\tremoveSelected(id: string): void\n\t\t{\n\t\t\tif (Object.hasOwnProperty.call(this.selectedCells, id))\n\t\t\t{\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/removeSelectedCell`, this.selectedCells[id]);\n\t\t\t}\n\t\t},\n\t\tasync book(): void\n\t\t{\n\t\t\tconst bookings = this.getBookings();\n\t\t\tif (bookings.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.fetching = true;\n\t\t\tconst bookingList = await bookingService.addList(bookings);\n\t\t\tthis.fetching = false;\n\n\t\t\tthis.showNotification(bookingList);\n\n\t\t\tawait this.closeMultiBooking();\n\t\t},\n\t\tgetBookings(): BookingModel[]\n\t\t{\n\t\t\treturn Object.values(this.selectedCells).map((cell) => ({\n\t\t\t\tid: `tmp-id-${Date.now()}-${Math.random()}`,\n\t\t\t\tdateFromTs: cell.fromTs,\n\t\t\t\tdateToTs: cell.toTs,\n\t\t\t\tname: this.loc('BOOKING_BOOKING_DEFAULT_BOOKING_NAME'),\n\t\t\t\tresourcesIds: [cell.resourceId],\n\t\t\t\ttimezoneFrom: this.timezone,\n\t\t\t\ttimezoneTo: this.timezone,\n\t\t\t\tclients: this.clients,\n\t\t\t}));\n\t\t},\n\t\tshowNotification(bookingList)\n\t\t{\n\t\t\tconst bookingQuantity = bookingList.length;\n\n\t\t\tconst balloon = BX.UI.Notification.Center.notify({\n\t\t\t\tid: Text.getRandom(),\n\t\t\t\tcontent: Loc.getMessagePlural('BOOKING_MULTI_CREATED', bookingQuantity, {\n\t\t\t\t\t'#QUANTITY#': bookingQuantity,\n\t\t\t\t}),\n\t\t\t\tactions: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.loc('BOOKING_MULTI_CREATED_CANCEL'),\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: () => this.reset(bookingList, balloon),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t},\n\t\tasync reset(bookingList, balloon): Promise<void>\n\t\t{\n\t\t\tawait bookingService.deleteList(bookingList.map(({ id }) => id));\n\t\t\tballoon?.close();\n\t\t},\n\t\tasync closeMultiBooking()\n\t\t{\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/clearSelectedCells`);\n\t\t},\n\t},\n\tcomponents: {\n\t\tBookingMultipleButton,\n\t\tMultiBookingItemsList,\n\t\tAddClientButton,\n\t\tCancelButton,\n\t},\n\ttemplate: `\n\t\t<Teleport to=\"#uiToolbarContainer\" defer>\n\t\t\t<div class=\"booking--multi-booking--bar\">\n\t\t\t\t<BookingMultipleButton :fetching @book=\"book\"/>\n\t\t\t\t<MultiBookingItemsList @remove-selected=\"removeSelected\"/>\n\t\t\t\t<div class=\"booking--multi-booking--divider-vertical\"></div>\n\t\t\t\t<AddClientButton v-model=\"clients\"/>\n\t\t\t\t<div class=\"booking--multi-booking--space\"></div>\n\t\t\t\t<div class=\"booking--multi-booking--close\">\n\t\t\t\t\t<div class=\"booking--multi-booking--divider-vertical\"></div>\n\t\t\t\t\t<CancelButton @click=\"closeMultiBooking\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Teleport>\n\t`,\n};\n","import { Runtime } from 'main.core';\nimport { shallowRef } from 'ui.vue3';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\n\nimport { Resolvable } from 'booking.lib.resolvable';\nimport { AhaMoment } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\n\nexport const Banner = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisBannerShown: false,\n\t\t\tbannerComponent: null,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tif (ahaMoments.shouldShow(AhaMoment.Banner))\n\t\t{\n\t\t\tvoid this.showBanner();\n\t\t}\n\t},\n\tmethods: {\n\t\tasync showBanner(): Promise<void>\n\t\t{\n\t\t\tBannerDispatcher.critical.toQueue(async (onDone) => {\n\t\t\t\tconst { PromoBanner } = await Runtime.loadExtension('booking.component.promo-banner');\n\n\t\t\t\tthis.bannerComponent = shallowRef(PromoBanner);\n\t\t\t\tthis.isBannerShown = true;\n\n\t\t\t\tthis.bannerClosed = new Resolvable();\n\t\t\t\tawait this.bannerClosed;\n\n\t\t\t\tonDone();\n\t\t\t});\n\t\t},\n\t\tcloseBanner(): void\n\t\t{\n\t\t\tthis.isBannerShown = false;\n\n\t\t\tthis.setShown();\n\n\t\t\tthis.bannerClosed.resolve();\n\t\t},\n\t\tsetShown(): void\n\t\t{\n\t\t\tahaMoments.setShown(AhaMoment.Banner);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<component v-if=\"isBannerShown\" :is=\"bannerComponent\" @setShown=\"setShown\" @close=\"closeBanner\"/>\n\t`,\n};\n","import { AutoLauncher } from 'ui.auto-launch';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Runtime } from 'main.core';\nimport { shallowRef } from 'ui.vue3';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\n\nimport { Resolvable } from 'booking.lib.resolvable';\nimport { AhaMoment, Model } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\n\nexport const Trial = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisBannerShown: false,\n\t\t\tbannerComponent: null,\n\t\t};\n\t},\n\twatch: {\n\t\tisShownTrialPopup(): void\n\t\t{\n\t\t\tif (ahaMoments.shouldShow(AhaMoment.TrialBanner))\n\t\t\t{\n\t\t\t\tif (!AutoLauncher.isEnabled())\n\t\t\t\t{\n\t\t\t\t\tAutoLauncher.enable();\n\t\t\t\t}\n\n\t\t\t\tvoid this.showBanner();\n\t\t\t}\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisShownTrialPopup: `${Model.Interface}/isShownTrialPopup`,\n\t\t}),\n\t},\n\tmethods: {\n\t\tasync showBanner(): Promise<void>\n\t\t{\n\t\t\tBannerDispatcher.critical.toQueue(async (onDone) => {\n\t\t\t\tconst { TrialBanner } = await Runtime.loadExtension('booking.component.trial-banner');\n\n\t\t\t\tthis.bannerComponent = shallowRef(TrialBanner);\n\t\t\t\tthis.isBannerShown = true;\n\n\t\t\t\tthis.bannerClosed = new Resolvable();\n\t\t\t\tawait this.bannerClosed;\n\n\t\t\t\tonDone();\n\t\t\t});\n\t\t},\n\t\tcloseBanner(): void\n\t\t{\n\t\t\tthis.isBannerShown = false;\n\n\t\t\tahaMoments.setShown(AhaMoment.TrialBanner);\n\n\t\t\tthis.bannerClosed.resolve();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<component v-if=\"isBannerShown\" :is=\"bannerComponent\" @close=\"closeBanner\"/>\n\t`,\n};\n","import { Loader } from 'main.loader';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport { mainPageService } from 'booking.provider.service.main-page-service';\nimport { dictionaryService } from 'booking.provider.service.dictionary-service';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport { calendarService } from 'booking.provider.service.calendar-service';\nimport { resourceDialogService } from 'booking.provider.service.resource-dialog-service';\nimport { mousePosition } from 'booking.lib.mouse-position';\nimport type { BookingModel } from 'booking.model.bookings';\n\nimport { expandOffHours } from '../lib/expand-off-hours/expand-off-hours';\nimport { Filter, FilterPreset } from './filter/filter';\nimport { CountersPanel, CounterItem } from './counters-panel/counters-panel';\nimport { AfterTitle } from './after-title/after-title';\nimport { BaseComponent } from './base-component/base-component';\nimport { MultiBooking } from './multi-booking/multi-booking';\nimport { Banner } from './banner/banner';\nimport { Trial } from './trial/trial';\n\nexport const App = {\n\tname: 'BookingApp',\n\tprops: {\n\t\tafterTitleContainer: HTMLElement,\n\t\tcounterPanelContainer: HTMLElement,\n\t\tfilterId: String,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tloader: new Loader(),\n\t\t};\n\t},\n\tasync mounted(): Promise<void>\n\t{\n\t\tmousePosition.bindMouseMove();\n\n\t\tthis.showLoader();\n\t\texpandOffHours.setExpanded(true);\n\t\tthis.addAfterTitle();\n\n\t\tawait Promise.all([\n\t\t\tdictionaryService.fetchData(),\n\t\t\tthis.fetchPage(this.isEditingBookingMode ? 0 : this.selectedDateTs / 1000),\n\t\t]);\n\n\t\tvoid this.$store.dispatch(`${Model.Interface}/setIsLoaded`, true);\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t\tviewDateTs: `${Model.Interface}/viewDateTs`,\n\t\t\tisFilterMode: `${Model.Interface}/isFilterMode`,\n\t\t\tfilteredBookingsIds: `${Model.Interface}/filteredBookingsIds`,\n\t\t\tselectedCells: `${Model.Interface}/selectedCells`,\n\t\t\tresourcesIds: `${Model.Favorites}/get`,\n\t\t\textraResourcesIds: `${Model.Interface}/extraResourcesIds`,\n\t\t\tbookings: `${Model.Bookings}/get`,\n\t\t\tintersections: `${Model.Interface}/intersections`,\n\t\t\teditingBookingId: `${Model.Interface}/editingBookingId`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\toffset: `${Model.Interface}/offset`,\n\t\t}),\n\t\thasSelectedCells(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.selectedCells).length > 0;\n\t\t},\n\t\teditingBooking(): BookingModel | null\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.editingBookingId) ?? null;\n\t\t},\n\t},\n\tmethods: {\n\t\tasync fetchPage(dateTs: number = 0): Promise<void>\n\t\t{\n\t\t\tthis.showLoader();\n\n\t\t\tawait mainPageService.fetchData(dateTs);\n\n\t\t\tif (this.extraResourcesIds.length > 0)\n\t\t\t{\n\t\t\t\tawait resourceDialogService.loadByIds(\n\t\t\t\t\tthis.extraResourcesIds,\n\t\t\t\t\tthis.selectedDateTs / 1000,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.hideLoader();\n\t\t},\n\t\tonActiveItem(counterItem: string | null): void\n\t\t{\n\t\t\tif (this.ignoreConterPanel)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$refs.filter.setPresetId(this.getPresetIdByCounterItem(counterItem));\n\t\t},\n\t\tasync applyFilter(): Promise<void>\n\t\t{\n\t\t\tconst presetId = this.$refs.filter.getPresetId();\n\t\t\tconst fields = this.$refs.filter.getFields();\n\n\t\t\tthis.setCounterItem(this.getCounterItemByPresetId(presetId));\n\n\t\t\tthis.showLoader();\n\n\t\t\tawait Promise.all([\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setFilterMode`, true),\n\t\t\t\tthis.updateMarks(),\n\t\t\t\tbookingService.filter(fields),\n\t\t\t]);\n\n\t\t\tthis.hideLoader();\n\t\t},\n\t\tasync clearFilter(): Promise<void>\n\t\t{\n\t\t\tthis.setCounterItem(null);\n\n\t\t\tcalendarService.clearFilterCache();\n\t\t\tbookingService.clearFilterCache();\n\n\t\t\tvoid Promise.all([\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setResourcesIds`, this.resourcesIds),\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setFilterMode`, false),\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setFilteredBookingsIds`, []),\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setFilteredMarks`, []),\n\t\t\t]);\n\n\t\t\tthis.hideLoader();\n\t\t},\n\t\tsetCounterItem(item: string | null): void\n\t\t{\n\t\t\tthis.ignoreConterPanel = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.ignoreConterPanel = false;\n\t\t\t}, 0);\n\n\t\t\tthis.$refs.countersPanel.setItem(item);\n\t\t},\n\t\tgetCounterItemByPresetId(presetId: string | null): string | null\n\t\t{\n\t\t\treturn {\n\t\t\t\t[FilterPreset.NotConfirmed]: CounterItem.NotConfirmed,\n\t\t\t\t[FilterPreset.Delayed]: CounterItem.Delayed,\n\t\t\t}[presetId];\n\t\t},\n\t\tgetPresetIdByCounterItem(counterItem: string | null): string | null\n\t\t{\n\t\t\treturn {\n\t\t\t\t[CounterItem.NotConfirmed]: FilterPreset.NotConfirmed,\n\t\t\t\t[CounterItem.Delayed]: FilterPreset.Delayed,\n\t\t\t}[counterItem];\n\t\t},\n\t\taddAfterTitle(): void\n\t\t{\n\t\t\tthis.afterTitleContainer.append(this.$refs.afterTitle.$el);\n\t\t},\n\t\tshowResourcesWithBookings(): void\n\t\t{\n\t\t\tconst resourcesIds = this.$store.getters[`${Model.Bookings}/getByDateAndIds`](\n\t\t\t\tthis.selectedDateTs,\n\t\t\t\tthis.filteredBookingsIds,\n\t\t\t)\n\t\t\t\t.map((booking: BookingModel) => booking.resourcesIds[0])\n\t\t\t\t.filter((value, index, array) => array.indexOf(value) === index)\n\t\t\t;\n\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setResourcesIds`, resourcesIds);\n\t\t},\n\t\tasync updateMarks(): Promise<void>\n\t\t{\n\t\t\tif (this.isFilterMode)\n\t\t\t{\n\t\t\t\tawait this.updateFilterMarks();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tawait Promise.all([\n\t\t\t\t\tthis.updateFreeMarks(),\n\t\t\t\t\tthis.updateCounterMarks(),\n\t\t\t\t]);\n\t\t\t}\n\t\t},\n\t\tasync updateFreeMarks(): Promise<void>\n\t\t{\n\t\t\tconst resources = this.resourcesIds.map((id: number) => [\n\t\t\t\tid,\n\t\t\t\t...(this.intersections[0] ?? []),\n\t\t\t\t...(this.intersections[id] ?? []),\n\t\t\t]);\n\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/setFreeMarks`, []);\n\n\t\t\tawait calendarService.loadMarks(this.viewDateTs, resources);\n\t\t},\n\t\tasync updateFilterMarks(): Promise<void>\n\t\t{\n\t\t\tconst fields = this.$refs.filter.getFields();\n\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/setFilteredMarks`, []);\n\n\t\t\tawait calendarService.loadFilterMarks(fields);\n\t\t},\n\t\tasync updateCounterMarks(): Promise<void>\n\t\t{\n\t\t\tawait calendarService.loadCounterMarks(this.viewDateTs);\n\t\t},\n\t\tshowLoader(): void\n\t\t{\n\t\t\tvoid this.loader.show(this.$refs.baseComponent.$el);\n\t\t},\n\t\thideLoader(): void\n\t\t{\n\t\t\tvoid this.loader.hide();\n\t\t},\n\t},\n\twatch: {\n\t\tselectedDateTs(): void\n\t\t{\n\t\t\tif (this.isFilterMode)\n\t\t\t{\n\t\t\t\tvoid this.applyFilter();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid this.fetchPage(this.selectedDateTs / 1000);\n\t\t\t}\n\t\t},\n\t\tfilteredBookingsIds(): void\n\t\t{\n\t\t\tif (this.isFilterMode)\n\t\t\t{\n\t\t\t\tthis.showResourcesWithBookings();\n\t\t\t}\n\t\t},\n\t\tisFilterMode(isFilterMode: boolean): void\n\t\t{\n\t\t\tif (!isFilterMode)\n\t\t\t{\n\t\t\t\tvoid this.fetchPage(this.selectedDateTs / 1000);\n\t\t\t}\n\t\t},\n\t\tviewDateTs(): void\n\t\t{\n\t\t\tvoid this.updateMarks();\n\t\t},\n\t\tresourcesIds(): void\n\t\t{\n\t\t\tvoid this.updateMarks();\n\t\t},\n\t\tintersections(): void\n\t\t{\n\t\t\tvoid this.updateMarks();\n\t\t},\n\t\teditingBooking(booking: BookingModel | null): void\n\t\t{\n\t\t\tconst additionalResourcesIds = booking?.resourcesIds?.slice(1) ?? [];\n\t\t\tif (additionalResourcesIds.length > 0)\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setIntersections`, {\n\t\t\t\t\t0: additionalResourcesIds,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\tcomponents: {\n\t\tBaseComponent,\n\t\tAfterTitle,\n\t\tFilter,\n\t\tCountersPanel,\n\t\tMultiBooking,\n\t\tBanner,\n\t\tTrial,\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<MultiBooking v-if=\"hasSelectedCells\"/>\n\t\t\t<AfterTitle ref=\"afterTitle\"/>\n\t\t\t<Filter\n\t\t\t\t:filterId=\"filterId\"\n\t\t\t\tref=\"filter\"\n\t\t\t\t@apply=\"applyFilter\"\n\t\t\t\t@clear=\"clearFilter\"\n\t\t\t/>\n\t\t\t<CountersPanel\n\t\t\t\t:target=\"counterPanelContainer\"\n\t\t\t\tref=\"countersPanel\"\n\t\t\t\t@activeItem=\"onActiveItem\"\n\t\t\t/>\n\t\t\t<BaseComponent ref=\"baseComponent\"/>\n\t\t\t<Banner/>\n\t\t\t<Trial/>\n\t\t</div>\n\t`,\n};\n","import { BitrixVue } from 'ui.vue3';\nimport { Core, type BookingParams } from 'booking.core';\nimport { locMixin } from 'booking.component.mixin.loc-mixin';\nimport { App } from './components/app';\n\nexport class Booking\n{\n\tconstructor(params: BookingParams)\n\t{\n\t\tCore.setParams(params);\n\n\t\tvoid this.#mountApplication();\n\t}\n\n\tasync #mountApplication(): Promise<void>\n\t{\n\t\tawait Core.init();\n\n\t\tconst application = BitrixVue.createApp(App, Core.getParams());\n\n\t\tapplication.mixin(locMixin);\n\t\tapplication.use(Core.getStore());\n\t\tapplication.mount(Core.getParams().container);\n\t}\n}\n"],"names":["cellHeight","cellHeightProperty","classCollapse","classExpand","ExpandOffHours","expand","keepScroll","Dom","removeClass","addClass","animate","collapse","fromHeight","toHeight","savedScrollTop","scrollTop","savedScrollHeight","scrollHeight","topCellsCoefficient","stop","BX","easing","duration","start","height","finish","step","style","heightChange","setExpanded","isExpanded","className","Core","getStore","dispatch","Model","Interface","getParams","container","getters","expandOffHours","FilterPreset","Object","freeze","NotConfirmed","Delayed","CreatedByMe","FilterField","CreatedBy","Contact","Company","Resource","Confirmed","Filter","emits","props","filterId","type","String","required","data","filter","created","Main","filterManager","getById","EventEmitter","subscribe","onBeforeApply","methods","event","getData","isFilterEmpty","$emit","setPresetId","presetId","getPresetId","getApi","setFilter","preset_id","preset","getPreset","getCurrentPresetId","keys","getFields","length","booleanFields","arrayFields","filterFields","getFilterFieldsValues","fields","field","includes","reduce","acc","forEach","template","CounterItem","CountersPanel","target","HTMLElement","mounted","addCounterPanel","onActiveItem","computed","mapGetters","counters","setItem","itemId","getActiveItem","values","id","counterPanel","getItemById","deactivate","item","activate","CounterPanel","items","title","loc","value","unConfirmed","color","getFieldName","CounterColor","THEME","delayed","init","getItems","find","isActive","watch","updateColor","DANGER","updateValue","obj","entries","Statistics","Number","valueFormatted","increasedValue","increasedValueFormatted","popupId","rows","Array","button","isPopupShown","onMouseEnter","clearTimeouts","showTimeout","setTimeout","showPopup","onMouseLeave","Event","unbind","document","updateHoverElement","bind","closePopup","closeTimeout","popupContainer","getElementById","contains","hoverElement","$refs","clearTimeout","close","animation","replaceWith","components","StatisticsPopup","Clients","totalNewClientsToday","totalClients","click","SidePanel","Instance","open","clientsProfitFormatted","Loc","getMessagePlural","newValue","previousValue","Profit","moneyStatistics","otherCurrencies","month","currencyId","baseCurrencyId","map","getTodayRow","getMonthRow","todayProfit","getTodayProfit","todayProfitFormatted","formatTodayProfit","currencyFormat","getBaseCurrencyId","getTodayProfitFormatted","DateTimeFormat","format","getMonthProfitFormatted","currency","statistics","today","profit","opportunity","statistic","AfterTitle","dateFormatted","getFormat","Date","now","Grid","calculateLeft","resourceId","cellWidth","indexOfResource","indexOf","calculateTop","fromTs","hourHeight","from","Math","max","bookingMinutes","getHours","getMinutes","fromMinutes","calculateHeight","toTs","minHeight","to","min","setHours","Duration","getUnitDurations","H","calculateRealHeight","minTs","maxTs","grid","OffHours","bottom","Boolean","default","offHoursHover","offHoursExpanded","fromHour","toHour","fromFormatted","formatHour","toFormatted","hour","timeFormat","timestamp","animateOffHours","$store","LeftPanel","panelHours","lastHour","range","formatted","offHours","last","NowLine","visible","updateNowLine","setInterval","zoom","selectedDateTs","offset","setVisible","nowMinutes","toMinutes","top","nowLine","timeFormatted","getTime","nowText","innerText","date","UTC","getFullYear","getMonth","getDate","BusySlots","loadBusySlots","resourcesWithIntersections","flatMap","key","filterSlotRanges","slotRanges","sort","a","b","push","Bookings","resourcesIds","DateFormat","WeekDays","getDay","selectedResourceIds","Set","flat","dateTs","loadedResourcesIds","resourcesDateCache","getIdsByDateTs","idsToLoad","has","resourceDialogService","loadByIds","resource","bookingRanges","booking","minutesInDay","d","i","slotRange","timeZone","timezone","dateInTimezone","toLocaleString","dateInUTC","timezoneOffset","minutesOffset","weekDays","weekDay","freeRanges","busyRanges","minutes","index","chunkIndex","floor","setMinutes","BusySlot","intersectingResourcesIds","intersectingBookings","intersectingBookingRanges","intersectingRange","Intersection","intersectingBooking","intersectingResourceId","it","dateFromTs","dateToTs","setDate","dateFrom","dateTo","remainingRanges","bookingRange","remainingRange","parts","range1","range2","Resources","busySlots","AddClient","bookingId","expired","isRealId","ahaMoments","setBookingForAhaMoment","shouldShow","AhaMoment","showAhaMoment","providerModuleId","isFeatureEnabled","clickHandler","limit","show","addClientsToBook","clients","bookingService","update","test","text","article","HelpDesk","AhaAddClient","setShown","ClientPopup","ChangeTimePopup","targetNode","ButtonSize","ButtonColor","ButtonIcon","adjustPosition","beforeUnmount","config","bindElement","offsetTop","bindOptions","forceBindPosition","position","angle","offsetWidth","isBusy","bookings","some","popup","timeFrom","adjustMenuPosition","timeTo","tsChanged","timezoneFrom","timezoneTo","getPopupInstance","setAutoHide","unfreeze","Popup","TimeSelector","Button","BookingTime","NotePopup","Function","isEditMode","note","mountedPromise","Resolvable","bookingNote","resolve","focusOnTextarea","minWidth","background","autoHide","saveNote","trim","onMouseDown","window","onMouseUp","textarea","focus","setHeight","maxHeight","popupHeight","Note","IconSet","hasNote","showNoteTimeout","showViewPopup","closeViewPopup","showEditPopup","closeEditPopup","Icon","Empty","directives","hint","isLoading","shownClientPopup","showClientPopup","hideClientPopup","btnIcon","ADD","LOCK","userIcon","PERSON","personSize","callIcon","TELEPHONY_HANDSET_1","messageIcon","CHATS_1","iconSize","iconColor","soonHint","popupOptions","offsetLeft","EditClientButton","name","isClientPopupShowed","currentClient","getByClientData","client","contact","company","clientData","clientModel","code","CrmEntity","updateClient","Client","lazyload","Loader","openClient","entity","toLowerCase","primaryClient","clientPhone","phones","clientAvatar","image","clientStatus","isReturning","imageTypeClass","Deal","saveDealDebounce","Runtime","debounce","saveDeal","dialog","Dialog","context","multiple","getDialogButton","width","enableSearch","dropdownMode","preselectedItems","deal","EntitySelectorEntity","entities","dynamicLoad","dynamicSearch","events","onShow","onHide","itemChange","menuId","externalData","entityTypeId","createdTimestamp","isOpen","getMenu","getPopupWindow","isShown","createDeal","bookingIdParamName","createDealUrl","Uri","setQueryParam","paramName","toString","onLoad","slider","getWindow","isDeal","entityTypeName","sliderUrl","getQueryParam","dealData","mapEntityInfoToDeal","entityInfo","onClose","showMenu","moreButton","$el","MenuManager","destroy","getMenuItems","onAfterClose","onDestroy","onclick","showDealDialog","deselectAll","setTargetNode","getMenuById","openDeal","getDealData","hide","getSelectedItems","getCustomData","get","info","moduleId","Module","Crm","typeName","addButton","showHelpDesk","helpDesk","BookingActionsDeal","anchorCode","Document","bookingActionsService","getDocData","linkDoc","Message","isPrimaryClientIdUpdated","fetchMessageData","clientId","updatedAt","isCurrentSenderAvailable","openMenu","status","isDisabled","destroyMenu","menuButton","create","capture","dictionary","sendMessage","disabled","Feedback","notificationType","result","isSuccess","Notifier","notify","errorText","getMessageData","BookingActionsMessage","Dictionary","MessageStatus","colorMap","success","primary","failure","semantic","ConfirmationMenu","menuPopup","unmounted","updateConfirmStatus","isConfirmed","popupWindow","closeByEsc","cacheable","unbindScrollEvent","bindScrollEvent","Confirmation","BookingActionsConfirmation","unconfirmedCounter","counter","delayedCounter","stateClass","stateText","hasBtnCounter","VisitMenu","updateVisitStatus","visitStatus","setVisitStatus","Unknown","Visited","NotVisited","Visit","BookingActionsVisit","getLocVisitStatus","getVisitInfoStyles","cardIconColor","iconClass","FullForm","arrowIcon","CHEVRON_RIGHT","arrowIconSize","arrowIconColor","Overbooking","openOverbooking","sendToOverbookingList","plusIcon","PLUS_20","plusIconSize","plusIconColor","Waitlist","clockIcon","BLACK_CLOCK","clockIconSize","clockIconColor","secondsToDelete","RemoveBtn","secondsLeft","reset","intervalId","balloon","clearInterval","removeBooking","UI","Notification","Center","balloonId","content","balloonTitle","actions","balloonCancelText","interval","delete","removeIcon","TRASH_BIN","removeIconSize","removeIconColor","ActionsPopup","soonTmp","beforeCreate","PopupManager","getPopups","getId","contentStructure","component","StickyPopup","PopupMaker","Actions","isEditingBookingMode","editingBookingId","Communication","DisabledPopup","darkMode","BookingWidth","Booking","nowTs","uiBookings","isDisabledPopupShown","updateVisibility","updateVisibilityDuringTransition","scroll","bookingName","left","realHeight","counterOptions","size","CounterSize","LARGE","overlappingBookings","uiBooking","bookingWidth","overlappingBookingsCount","bookingOffset","findIndex","shortView","isExpiredBooking","rect","getBoundingClientRect","right","innerWidth","getBindElement","onNoteMouseEnter","onNoteMouseLeave","onClick","stopPropagation","UiCounter","BusyPopup","busySlot","mousePosition","angleLeft","MainPopup","getOption","angleOffset","angleBorderRadius","textFormatted","messageId","setBindElement","handler","deep","mapInterfaceGetters","createNamespacedHelpers","BookingBusySlotClassName","setup","disabledBusySlots","isFilterMode","BusySlotType","onMouseMove","cursorInsideContainer","updatePopup","relatedTarget","closest","querySelector","eventTarget","Type","isNull","hasClass","clientY","clientX","BaseCell","cell","selectedCells","intersections","selected","hasSelectedCells","onCellSelected","checked","addBooking","add","random","Cell","MinUiBookingDurationMs","filteredBookingsIds","hoveredCell","bookingsHash","JSON","stringify","cells","startInterval","generateBookingKey","getUiBookings","halfHour","hovered","halfOffset","activeBusySlots","isAvailable","freeSpace","cellFromTs","cellHalfTs","maxFrom","minTo","Infinity","colliding","mouseEnterHandler","updateHalfHour","mouseLeaveHandler","nextHoveredCell","dataset","mouseMoveHandler","scrollY","bottomHalf","canSubtractHalfHour","canAddHalfHour","offsetNotMatchesHalf","clearCell","hoverCell","boundedToBottom","Column","slotSize","offHoursTopCells","workTimeCells","offHoursBottomCells","counterPanelScopeClass","darkThemeClass","Maximize","constructor","onOverlayClick","Manager","getSliderClass","handleSliderClose","maximize","applyHacks","disablePageScrollbar","append","body","minimize","resetHacks","enablePageScrollbar","remove","getLabel","setOnclick","getContainer","label","Tag","render","counterPanelContainer","firstElementChild","parentElement","innerHeight","Promise","complete","ZIndexManager","register","overlay","unregister","ScalePanel","getColumnsContainer","isSlider","desiredZoom","minZoom","maxZoom","expanded","zoomFormatted","round","fitToScreen","sidebarPadding","view","zoomCoefficient","scrollWidth","newZoom","zoomInto","noTransitionClass","maxAnimationDuration","abs","direction","mouseDown","zoomInterval","ceil","setPopupShown","ExpandGrid","AhaExpandGrid","Calendar","datePicker","DatePicker","selectedDates","inline","hideHeader","setViewDate","DatePickerEvent","SELECT","selectedDate","createDateFromUtc","filteredMarks","freeMarks","getCounterMarks","viewDateTs","counterMarks","formattedDate","onCollapseClick","onPreviousClick","previousMonth","previousDate","onNextClick","nextMonth","nextDate","getSelectedDate","getToday","selectDate","getNextDate","viewDate","getViewDate","getUTCFullYear","getUTCMonth","getUTCDate","updateMarks","setFilterMarks","setFreeMarks","setCounterMarks","bgColorFree","dates","prepareDates","setDayColors","matcher","bgColor","bgColorFilter","setDayMarks","markDate","parse","ServerParse","prepareTimestamp","dateFormat","createDate","Sidebar","scrolledToBooking","ears","Ears","columnsContainer","smallSize","tryShowAhaMoment","editingBooking","updateEars","toggleEars","areEarsShown","shownClass","getRightEar","getLeftEar","scrollToEditingBooking","inner","offsetHeight","unsubscribe","scalePanel","scrollLeft","MIN_CHARGE","MAX_CHARGE","CHARGE_COLOR","EMPTY_COLOR","BATTERY_ICON_HEIGHT","BATTERY_ICON_WIDTH","BatteryIcon","percent","dataId","repaint","getCharge","rects","children","charge","setAttribute","WorkloadPopup","slotsCount","bookingCount","workLoadPercent","slotsBookedFormatted","element","bookedCount","totalCount","workLoadPercentFormatted","ResourceWorkload","scale","isGrid","selectedWeekDay","sum","batteryIconOptions","bookingsCount","AhaResourceWorkload","newCount","previousCount","ResourceMenu","favoritesIds","Favorites","Hint","createInstance","popupParameters","html","wizard","ResourceCreationWizard","editResource","hideResource","deleteResource","ids","splice","hideResources","confirmed","confirmDelete","resourceService","hasBookings","messageBox","MessageBox","message","getMessage","yesCaption","modal","buttons","MessageBoxButtons","YES_CANCEL","onYes","onCancel","yesButton","getYesButton","setDisabled","resourceType","ResourceTypes","typeId","deals","uniqueDeals","Map","AddResourceButton","isLoaded","addResource","AhaAddResource","AddResource","ContentHeader","BaseHeader","options","selectedTypes","resourceTypes","selectAll","Resize","getNode","isResized","startMouseY","startHeight","startResize","endResize","resize","preventDefault","newHeight","Search","searchDebounced","search","query","searchIcon","SEARCH_2","onInput","isStringFilled","DialogHeader","resources","ContentFooter","BaseFooter","DialogFooter","buttonSettings","SMALL","LINK","buttonLabel","UiButton","SelectResources","dialogFilled","saveItemsDebounce","saveItems","workloadRefs","getItemOptions","header","headerOptions","dialogHeader","footer","footerOptions","dialogFooter","getRecentTab","loadOnScroll","mainResources","MainResources","mainResourceIds","isDefaultState","every","showDialog","updateItems","loadMainResources","fillDialog","maxScroll","slice","Limit","ResourcesDialog","getMainResources","workload","isHidden","isItemHidden","isSelected","isItemSelected","getNodes","node","avatarContainer","getAvatarContainer","setHidden","select","deselect","addItems","itemsOptions","itemOptions","addItem","itemsIds","removeItems","tab","getActiveTab","getRootNode","getChildrenContainer","entityId","subtitle","getResourceType","avatarOptions","bgImage","borderRadius","tabs","EntitySelectorTab","Recent","hidden","nodeAttributes","getResource","getSearchTab","getStub","getSearchLoader","doSearch","isEmptyResult","setWorkloadRef","AhaSelectResources","clearMainResourcesCache","Header","Multiple","selectedItems","selector","createSelector","intersectionField","showAvatars","searchOptions","allowCreateItem","changeSelected","showSelector","selectedIds","handleRemove","getItem","firstItemTitle","remainingItemsCount","previousResourcesIds","deletedIds","newIds","removeItem","setTitle","setSubtitle","getTagSelector","getTags","tag","Single","lock","mountSelector","destroySelector","TagSelector","addButtonCaption","showCreateButton","dialogOptions","onAfterTagAdd","onSelectorChange","onAfterTagRemove","getDialog","renderTo","innerHTML","ResourceIntersection","AhaResourceIntersection","getAddButton","Intersections","intersectionModeMenuItemId","menu","intersectionMenu","isIntersectionForAll","optionService","setBool","Option","IntersectionForAll","delimiter","showIntersections","toggleMenuItemActivityState","toggleClass","getMenuItem","hasIntersections","BaseComponent","BookingMultipleButton","fetching","SUCCESS","MultiBookingItem","buttonColor","buttonSize","EXTRA_SMALL","MultiBookingItemsList","selectedCellsCount","wrapper","noScrollbar","AddClientButton","modelValue","findClientByType","createClients","clientsData","clientTypeCode","CancelButton","MultiBooking","removeSelected","hasOwnProperty","call","book","getBookings","bookingList","addList","showNotification","closeMultiBooking","bookingQuantity","Text","getRandom","deleteList","Banner","isBannerShown","bannerComponent","showBanner","BannerDispatcher","critical","toQueue","onDone","PromoBanner","loadExtension","shallowRef","bannerClosed","closeBanner","Trial","isShownTrialPopup","TrialBanner","AutoLauncher","isEnabled","enable","App","afterTitleContainer","loader","bindMouseMove","showLoader","addAfterTitle","all","dictionaryService","fetchData","fetchPage","extraResourcesIds","mainPageService","hideLoader","counterItem","ignoreConterPanel","getPresetIdByCounterItem","applyFilter","setCounterItem","getCounterItemByPresetId","clearFilter","calendarService","clearFilterCache","countersPanel","afterTitle","showResourcesWithBookings","array","updateFilterMarks","updateFreeMarks","updateCounterMarks","loadMarks","loadFilterMarks","loadCounterMarks","baseComponent","additionalResourcesIds","params","setParams","application","BitrixVue","createApp","mixin","locMixin","use","mount"],"mappings":"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"}