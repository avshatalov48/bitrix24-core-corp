this.BX=this.BX||{};this.BX.Booking=this.BX.Booking||{};(function(e,t,s,o){"use strict";class i extends s.BuilderModel{getName(){return o.Model.Interface}getState(){var e,t;const s=new Date;const o=this.getVariable("schedule",{});return{isFeatureEnabled:this.getVariable("isFeatureEnabled",false),canTurnOnTrial:this.getVariable("canTurnOnTrial",false),canTurnOnDemo:this.getVariable("canTurnOnDemo",false),editingBookingId:this.getVariable("editingBookingId",0),draggedBookingId:0,draggedBookingResourceId:0,resizedBookingId:0,isLoaded:false,zoom:1,expanded:false,scroll:0,offHoursHover:false,offHoursExpanded:false,fromHour:(e=o.fromHour)!=null?e:9,toHour:(t=o.toHour)!=null?t:19,selectedDateTs:new Date(s.getFullYear(),s.getMonth(),s.getDate()).getTime(),viewDateTs:new Date(s.getFullYear(),s.getMonth()).getTime(),deletingBookings:{},selectedCells:{},hoveredCell:null,busySlots:{},disabledBusySlots:{},resourcesIds:[],isFilterMode:false,isIntersectionForAll:true,filteredBookingsIds:[],filteredMarks:[],counterMarks:[],freeMarks:[],totalClients:this.getVariable("totalClients",0),totalNewClientsToday:this.getVariable("totalNewClientsToday",0),moneyStatistics:this.getVariable("moneyStatistics",null),intersections:{},quickFilter:{hovered:{},active:{},ignoredBookingIds:{}},timezone:this.getVariable("timezone",Intl.DateTimeFormat().resolvedOptions().timeZone),mousePosition:{top:0,left:0},isCurrentSenderAvailable:false,isShownTrialPopup:false}}getGetters(){return{isFeatureEnabled:e=>e.isFeatureEnabled||e.canTurnOnTrial,canTurnOnTrial:e=>e.canTurnOnTrial,canTurnOnDemo:e=>e.canTurnOnDemo,isShownTrialPopup:e=>e.isShownTrialPopup,editingBookingId:e=>e.editingBookingId,isEditingBookingMode:e=>e.editingBookingId>0,draggedBookingId:e=>e.draggedBookingId,draggedBookingResourceId:e=>e.draggedBookingResourceId,resizedBookingId:e=>e.resizedBookingId,isDragMode:e=>e.draggedBookingId||e.resizedBookingId,isLoaded:e=>e.isLoaded,zoom:e=>e.zoom,expanded:e=>e.expanded,scroll:e=>e.scroll,offHoursHover:e=>e.offHoursHover,offHoursExpanded:e=>e.offHoursExpanded,fromHour:e=>e.fromHour,toHour:e=>e.toHour,selectedDateTs:(e,t)=>e.selectedDateTs-t.offset,viewDateTs:(e,t)=>e.viewDateTs-t.offset,deletingBookings:e=>e.deletingBookings,selectedCells:e=>e.selectedCells,hoveredCell:e=>e.hoveredCell,busySlots:e=>Object.values(e.busySlots),disabledBusySlots:e=>e.disabledBusySlots,resourcesIds:(e,t,s,i)=>{const r=i[`${o.Model.Bookings}/getByDate`](e.selectedDateTs).filter((e=>e.counter>0)).map((e=>e.resourcesIds[0]));const l=[...new Set([...e.resourcesIds,...r])];const n=new Set(t.getOccupancy(l,Object.values(e.quickFilter.ignoredBookingIds)).filter((s=>Object.values(e.quickFilter.active).some((o=>{const i=new Date(e.selectedDateTs).setHours(o)-t.offset;const r=new Date(e.selectedDateTs).setHours(o+1)-t.offset;return r>s.fromTs&&i<s.toTs})))).flatMap((e=>e.resourcesIds)));return l.filter((e=>!n.has(e)))},extraResourcesIds:(e,t)=>{const s=e.resourcesIds;return t.resourcesIds.filter((e=>!s.includes(e)))},isFilterMode:e=>e.isFilterMode,isIntersectionForAll:e=>e.isIntersectionForAll,filteredBookingsIds:e=>e.filteredBookingsIds,filteredMarks:e=>e.filteredMarks,freeMarks:e=>e.freeMarks,totalClients:e=>e.totalClients,totalNewClientsToday:e=>e.totalNewClientsToday,moneyStatistics:e=>e.moneyStatistics,getCounterMarks:e=>(s=null)=>{if(t.Type.isNull(s)){return e.counterMarks}return e.counterMarks.filter((e=>s.includes(e)))},intersections:e=>e.intersections,quickFilter:e=>e.quickFilter,timezone:e=>e.timezone,timezoneOffset:e=>{const t=e.timezone;const s=new Date(e.selectedDateTs);const o=new Date(s.toLocaleString("en-US",{timeZone:t}));const i=new Date(s.toLocaleString("en-US",{timeZone:"UTC"}));return(o.getTime()-i.getTime())/1e3},offset:(e,t)=>(t.timezoneOffset+new Date(e.selectedDateTs).getTimezoneOffset()*60)*1e3,mousePosition:e=>e.mousePosition,isCurrentSenderAvailable:e=>e.isCurrentSenderAvailable,getColliding:(e,t)=>(s,o)=>[...t.getOccupancy([s],o),...Object.values(e.selectedCells).filter((e=>e.resourceId===s)).map((e=>({fromTs:e.fromTs,toTs:e.toTs,resourcesIds:[e.resourceId]})))],getOccupancy:(e,t,s,i)=>(s,r=[])=>{const l=new Set(s);const n=i[`${o.Model.Bookings}/get`].filter((e=>{const t=e.resourcesIds.some((e=>l.has(e)));const s=!r.includes(e.id);return t&&s})).map((e=>({fromTs:e.dateFromTs,toTs:e.dateToTs,resourcesIds:e.resourcesIds})));const d=Object.values(e.busySlots).filter((s=>{const i=t.isDragMode&&s.type===o.BusySlot.OffHours;const r=!(s.id in e.disabledBusySlots)&&!i;const n=l.has(s.resourceId);return r&&n})).map((({fromTs:e,toTs:t,resourceId:s})=>({fromTs:e,toTs:t,resourcesIds:[s]})));return[...n,...d]}}}getActions(){return{setEditingBookingId:(e,t)=>{e.commit("setEditingBookingId",t)},setDraggedBookingId:(e,t)=>{e.commit("setDraggedBookingId",t)},setDraggedBookingResourceId:(e,t)=>{e.commit("setDraggedBookingResourceId",t)},setResizedBookingId:(e,t)=>{e.commit("setResizedBookingId",t)},setIsLoaded:(e,t)=>{e.commit("setIsLoaded",t)},setZoom:(e,t)=>{e.commit("setZoom",t)},setExpanded:(e,t)=>{e.commit("setExpanded",t)},setScroll:(e,t)=>{e.commit("setScroll",t)},setOffHoursHover:(e,t)=>{e.commit("setOffHoursHover",t)},setOffHoursExpanded:(e,t)=>{e.commit("setOffHoursExpanded",t)},setSelectedDateTs:(e,t)=>{e.commit("setSelectedDateTs",t)},setViewDateTs:(e,t)=>{e.commit("setViewDateTs",t)},addDeletingBooking:(e,t)=>{e.commit("addDeletingBooking",t)},removeDeletingBooking:(e,t)=>{e.commit("removeDeletingBooking",t)},addSelectedCell:(e,t)=>{e.commit("addSelectedCell",t)},removeSelectedCell:(e,t)=>{e.commit("removeSelectedCell",t)},clearSelectedCells:e=>{e.commit("clearSelectedCells")},setHoveredCell:(e,t)=>{e.commit("setHoveredCell",t)},upsertBusySlotMany:(e,t)=>{t.forEach((t=>e.commit("upsertBusySlot",t)))},clearBusySlots:e=>{e.commit("clearBusySlots")},addDisabledBusySlot:(e,t)=>{e.commit("addDisabledBusySlot",t)},clearDisabledBusySlots:e=>{e.commit("clearDisabledBusySlots")},setResourcesIds:(e,t)=>{e.commit("setResourcesIds",t)},deleteResourceId:(e,t)=>{e.commit("deleteResourceId",t)},setFilterMode:(e,t)=>{e.commit("setFilterMode",t)},setIntersectionMode:(e,t)=>{e.commit("setIntersectionMode",t)},setFilteredBookingsIds:(e,t)=>{e.commit("setFilteredBookingsIds",t)},setFilteredMarks:(e,t)=>{e.commit("setFilteredMarks",t)},setFreeMarks:(e,t)=>{e.commit("setFreeMarks",t)},setTotalClients:(e,t)=>{e.commit("setTotalClients",t)},setTotalNewClientsToday:(e,t)=>{e.commit("setTotalNewClientsToday",t)},setMoneyStatistics:(e,t)=>{e.commit("setMoneyStatistics",t)},setCounterMarks:(e,t)=>{e.commit("setCounterMarks",t)},setIntersections:(e,t)=>{e.commit("setIntersections",t)},hoverQuickFilter:(e,t)=>{e.commit("hoverQuickFilter",t)},fleeQuickFilter:(e,t)=>{e.commit("fleeQuickFilter",t)},activateQuickFilter:(e,t)=>{e.commit("activateQuickFilter",t);e.commit("clearQuickFilterIgnoredBookingIds")},deactivateQuickFilter:(e,t)=>{e.commit("deactivateQuickFilter",t);e.commit("clearQuickFilterIgnoredBookingIds")},addQuickFilterIgnoredBookingId:(e,t)=>{e.commit("addQuickFilterIgnoredBookingId",t)},setMousePosition:(e,t)=>{e.commit("setMousePosition",t)},setIsCurrentSenderAvailable:(e,t)=>{e.commit("setIsCurrentSenderAvailable",t)},setIsFeatureEnabled:(e,t)=>{e.commit("setIsFeatureEnabled",t)},setCanTurnOnTrial:(e,t)=>{e.commit("setCanTurnOnTrial",t)},setIsShownTrialPopup:(e,t)=>{e.commit("setIsShownTrialPopup",t)}}}getMutations(){return{setEditingBookingId:(e,t)=>{e.editingBookingId=t},setDraggedBookingId:(e,t)=>{e.draggedBookingId=t},setResizedBookingId:(e,t)=>{e.resizedBookingId=t},setDraggedBookingResourceId:(e,t)=>{e.draggedBookingResourceId=t},setIsLoaded:(e,t)=>{e.isLoaded=t},setZoom:(e,t)=>{e.zoom=t},setExpanded:(e,t)=>{e.expanded=t},setScroll:(e,t)=>{e.scroll=t},setOffHoursHover:(e,t)=>{e.offHoursHover=t},setOffHoursExpanded:(e,t)=>{e.offHoursExpanded=t},setSelectedDateTs:(e,t)=>{e.selectedDateTs=t},setViewDateTs:(e,t)=>{e.viewDateTs=t},addDeletingBooking:(e,t)=>{e.deletingBookings[t]=t},removeDeletingBooking:(e,t)=>{delete e.deletingBookings[t]},addSelectedCell:(e,t)=>{e.selectedCells[t.id]=t},removeSelectedCell:(e,t)=>{delete e.selectedCells[t.id]},clearSelectedCells:e=>{e.selectedCells={}},setHoveredCell:(e,t)=>{e.hoveredCell=t},upsertBusySlot:(e,t)=>{var s,o,i;(i=(s=e.busySlots)[o=t.id])!=null?i:s[o]=t;Object.assign(e.busySlots[t.id],t)},clearBusySlots:e=>{e.busySlots={}},addDisabledBusySlot:(e,t)=>{e.disabledBusySlots[t.id]=t},clearDisabledBusySlots:e=>{e.disabledBusySlots={}},setResourcesIds:(e,t)=>{e.resourcesIds=t.sort(((e,t)=>e-t))},deleteResourceId:(e,t)=>{e.resourcesIds=e.resourcesIds.filter((e=>e!==t))},setFilterMode:(e,t)=>{e.isFilterMode=t},setIntersectionMode:(e,t)=>{e.isIntersectionForAll=t},setFilteredBookingsIds:(e,t)=>{e.filteredBookingsIds=[...t]},setFilteredMarks:(e,t)=>{e.filteredMarks=t},setFreeMarks:(e,t)=>{e.freeMarks=t},setTotalClients:(e,t)=>{e.totalClients=t},setTotalNewClientsToday:(e,t)=>{e.totalNewClientsToday=t},setMoneyStatistics:(e,t)=>{e.moneyStatistics=t},setCounterMarks:(e,t)=>{e.counterMarks=t},setIntersections:(e,t)=>{e.intersections=t},hoverQuickFilter:(e,t)=>{e.quickFilter.hovered[t]=t},fleeQuickFilter:(e,t)=>{delete e.quickFilter.hovered[t]},activateQuickFilter:(e,t)=>{e.quickFilter.active[t]=t},deactivateQuickFilter:(e,t)=>{delete e.quickFilter.active[t]},addQuickFilterIgnoredBookingId:(e,t)=>{e.quickFilter.ignoredBookingIds[t]=t},clearQuickFilterIgnoredBookingIds:e=>{e.quickFilter.ignoredBookingIds={}},setMousePosition:(e,t)=>{e.mousePosition=t},setIsCurrentSenderAvailable:(e,t)=>{e.isCurrentSenderAvailable=t},setIsFeatureEnabled:(e,t)=>{e.isFeatureEnabled=t},setCanTurnOnTrial:(e,t)=>{e.canTurnOnTrial=t},setIsShownTrialPopup:(e,t)=>{e.isShownTrialPopup=t}}}}e.Interface=i})(this.BX.Booking.Model=this.BX.Booking.Model||{},BX,BX.Vue3.Vuex,BX.Booking.Const);
//# sourceMappingURL=interface.bundle.map.js