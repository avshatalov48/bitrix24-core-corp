this.BX=this.BX||{};(function(t,o,n,e,i,a,r,c,s,p,d){"use strict";const l={computed:{isBookingCanceled(){return this.booking.isDeleted===true}}};const g={name:"Header",mixins:[l],components:{Icon:r.BIcon},props:{booking:{type:Object,required:true},company:{type:String,required:true},context:{type:String,required:true}},data(){return{}},computed:{iconColor(){if(this.context==="delayed.pub.page"){return"var(--ui-color-palette-gray-60)"}return this.isBookingCanceled?"var(--ui-color-palette-red-60)":"var(--ui-color-palette-green-60)"},iconSize(){return 45},iconName(){if(this.context==="delayed.pub.page"){return r.Set.HOURGLASS_SANDGLASS}return this.isBookingCanceled?r.Set.CROSS_CIRCLE_70:r.Set.CIRCLE_CHECK},titleClass(){if(this.context==="delayed.pub.page"){return"--delayed"}return this.isBookingCanceled?"--canceled":""},title(){if(this.context==="delayed.pub.page"){return this.loc("BOOKING_CONFIRM_PAGE_BOOKING_CONFIRMATION_WAITING")}return this.isBookingCanceled?this.loc("BOOKING_CONFIRM_PAGE_BOOKING_CANCELED"):this.loc("BOOKING_CONFIRM_PAGE_BOOKING_CONFIRMED")}},template:`\n\t\t<div class="confirm-page-header">\n\t\t\t<div class="confirm-page-header-status">\n\t\t\t\t<div :class="['confirm-page-header-status-icon', titleClass]">\n\t\t\t\t\t<Icon :name="iconName" :size="iconSize" :color="iconColor" />\n\t\t\t\t</div>\n\t\t\t\t<div :class="['confirm-page-header-status-title', titleClass]">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div class="confirm-page-header-company">\n\t\t\t\t<div class="confirm-page-header-company-title">{{ company }}</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const m={name:"BookingTime",mixins:[l],props:{booking:{type:Object,required:true}},data(){return{}},computed:{getBookingDateFrom(){return new Date(this.booking.datePeriod.from.timestamp*1e3)},getBookingDateTo(){return new Date(this.booking.datePeriod.to.timestamp*1e3)},getTimeTo(){const t=new Date(this.booking.datePeriod.to.timestamp);return`${t.getHours()}:${t.getMinutes()}`},getMonth(){return a.DateTimeFormat.format("F",this.getBookingDateFrom)},getDayOfWeek(){const t=this.getBookingDateFrom.getDay();return this.loc(`BOOKING_CONFIRM_PAGE_CALENDAR_WEEK_DAY_${t}`)},timeFromFormatted(){const t=a.DateTimeFormat.getFormat("SHORT_TIME_FORMAT");return a.DateTimeFormat.format(t,this.getBookingDateFrom)},timeFormatted(){const t=a.DateTimeFormat.getFormat("SHORT_TIME_FORMAT");return this.loc("BOOKING_CONFIRM_PAGE_TIME_RANGE",{"#FROM#":a.DateTimeFormat.format(t,this.getBookingDateFrom),"#TO#":a.DateTimeFormat.format(t,this.getBookingDateTo)})},timeDetailFormatted(){const t=a.DateTimeFormat.getFormat("SHORT_DAY_OF_WEEK_MONTH_FORMAT");return a.DateTimeFormat.format(t,this.getBookingDateFrom)},timeZoneFormatted(){const t=this.getBookingDateFrom.getTimezoneOffset();const o=Math.floor(Math.abs(t)/60);const n=Math.abs(t)%60;const e=t>0?"-":"+";return`GMT${e}${String(o).padStart(2,"0")}:${String(n).padStart(2,"0")}, ${this.booking.datePeriod.from.timezone}`}},template:`\n\t\t<div class="confirm-page-content-border">\n\t\t\t<div class="confirm-page-content-booking-time">\n\t\t\t\t<div class="confirm-page-content-booking-time-calendar">\n\t\t\t\t\t<div class="confirm-page-content-booking-time-calendar-container">\n\t\t\t\t\t\t<div class="confirm-page-content-booking-time-calendar-container-border"></div>\n\t\t\t\t\t\t<div class="confirm-page-content-booking-time-calendar-container-header"></div>\n\t\t\t\t\t\t<div class="confirm-page-content-booking-time-calendar-container-date">{{ getBookingDateFrom.getDate() }}</div>\n\t\t\t\t\t\t<div class="confirm-page-content-booking-time-calendar-container-month">{{ getMonth }}</div>\n\t\t\t\t\t\t<div class="confirm-page-content-booking-time-calendar-container-time">{{ timeFromFormatted }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="confirm-page-content-booking-time-detail">\n\t\t\t\t\t<div class="confirm-page-content-booking-time-detail-date">{{ timeDetailFormatted }}</div>\n\t\t\t\t\t<div class="confirm-page-content-booking-time-detail-time">{{ timeFormatted }}</div>\n\t\t\t\t\t<div class="confirm-page-content-booking-time-detail-timezone">{{ timeZoneFormatted }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const u={name:"BookingDetailItem",props:{item:{type:Object,required:true}},data(){return{}},template:`\n\t\t<div class="booking-confirm-page-content-booking-detail-line"></div>\n\t\t<div class="booking-confirm-page-content-booking-detail-service">\n\t\t\t<div class="booking-confirm-page-content-booking-detail-service-item">\n\t\t\t\t<div class="booking-confirm-page-content-booking-detail-service-item-summary">\n\t\t\t\t\t<div class="booking-confirm-page-content-booking-detail-service-item-summary-title">\u041c\u0430\u0441\u0441\u0430\u0436 \u0440\u0430\u0441\u0441\u043b\u0430\u0431\u043b\u2026</div>\n\t\t\t\t\t<div class="booking-confirm-page-content-booking-detail-service-item-summary-duration">1 \u0447\u0430\u0441</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="booking-confirm-page-content-booking-detail-service-item-price">1800 \u20bd</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const b={name:"BookingDetailTotal",props:{booking:{type:Object,required:true}},data(){return{}},template:`\n\t\t<div class="booking-confirm-page-content-booking-detail-line"></div>\n\t\t<div class="booking-confirm-page-content-booking-detail-service">\n\t\t\t<div class="booking-confirm-page-content-booking-detail-service-item">\n\t\t\t\t<div class="booking-confirm-page-content-booking-detail-service-item-total-title">\u0418\u0442\u043e\u0433\u043e</div>\n\t\t\t\t<div class="booking-confirm-page-content-booking-detail-service-item-total-price">3800 \u20bd</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const k={name:"BookingDetailAvatar",props:{booking:{type:Object,required:true}},data(){return{}},template:`\n\t\t\n\t`};const f={name:"BookingDetail",mixins:[l],components:{Item:u,Total:b,Avatar:k},props:{booking:{type:Object,required:true}},data(){return{}},template:`\n\t\t<div class="booking-confirm-page-content-booking-detail-border">\n\t\t\t<div class="booking-confirm-page-content-booking-detail-title">{{ loc('BOOKING_CONFIRM_PAGE_BOOKING_DETAILS') }}</div>\n\t\t\t<div class="booking-confirm-page-content-booking-detail-line"></div>\n\t\t\t<div class="booking-confirm-page-content-booking-detail-master">\n\t\t\t\t<Avatar :booking="booking" />\n\t\t\t\t<div class="booking-confirm-page-content-booking-detail-master-info">\n\t\t\t\t\t<div class="booking-confirm-page-content-booking-detail-master-name">{{ booking.resources[0].name }}</div>\n\t\t\t\t\t<div class="booking-confirm-page-content-booking-detail-master-title">{{ booking.resources[0].type.name }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const B={name:"Content",components:{BookingTime:m,BookingDetail:f},props:{booking:{type:Object,required:true}},data(){return{}},template:`\n\t\t<div class="confirm-page-content">\n\t\t\t<BookingTime :booking="booking"/>\n\t\t\t<BookingDetail :booking="booking"/>\n\t\t</div>\n\t`};const v={name:"ConfirmPopup",emits:["bookingConfirmed","bookingCanceled","closePopup"],components:{Popup:d.Popup,Button:p.Button},props:{booking:{type:Object,required:true},showPopup:{type:Boolean,required:true}},data(){return{ButtonSize:p.ButtonSize,ButtonColor:p.ButtonColor,btnWaiting:false}},methods:{confirmBookingHandler(){this.btnWaiting=true;this.$emit("bookingConfirmed")},cancelBookingHandler(){this.btnWaiting=true;this.$emit("bookingCanceled")}},computed:{popupId(){return`booking-confirm-page-popup-${this.booking.id}`},popupConfig(){return{className:"booking-confirm-page-popup",offsetLeft:0,offsetTop:0,overlay:true,borderRadius:"5px",autoHide:false}}},watch:{booking:{handler(t){if(t.isConfirmed===true){this.btnWaiting=false;this.$emit("closePopup")}},deep:true}},template:`\n\t\t<Popup\n\t\t\tv-if="showPopup"\n\t\t\t:id="popupId"\n\t\t\t:config="popupConfig"\n\t\t\t@close="closePopup"\n\t\t>\n\t\t\t<div class="cancel-booking-popup-content">\n\t\t\t\t<div class="cancel-booking-popup-content-title">{{ loc('BOOKING_CONFIRM_PAGE_MESSAGEBOX_CONFIRM_TILE') }}</div>\n\t\t\t\t<div class="cancel-booking-popup-content-text">{{ loc('BOOKING_CONFIRM_PAGE_MESSAGEBOX_CONFIRM_TEXT') }}</div>\n\t\t\t\t<div class="cancel-booking-popup-content-buttons">\n\t\t\t\t\t<Button\n\t\t\t\t\t\t:text="loc('BOOKING_CONFIRM_PAGE_MESSAGEBOX_BTN_NOT_CONFIRM')"\n\t\t\t\t\t\t:size="ButtonSize.EXTRA_SMALL"\n\t\t\t\t\t\t:color="ButtonColor.LIGHT_BORDER"\n\t\t\t\t\t\t:buttonClass="'cancel-booking-popup-content-buttons-no'"\n\t\t\t\t\t\t@click="cancelBookingHandler"\n\t\t\t\t\t/>\n\t\t\t\t\t<Button\n\t\t\t\t\t\t:text="loc('BOOKING_CONFIRM_PAGE_MESSAGEBOX_BTN_CONFIRM')"\n\t\t\t\t\t\t:size="ButtonSize.EXTRA_SMALL"\n\t\t\t\t\t\t:buttonClass="'cancel-booking-popup-content-buttons-yes --confirm'"\n\t\t\t\t\t\t:waiting="btnWaiting"\n\t\t\t\t\t\t@click="confirmBookingHandler"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`};const C={name:"CancelPopup",emits:["bookingCanceled","popupClosed"],components:{Popup:d.Popup,Button:p.Button},props:{booking:{type:Object,required:true},showPopup:{type:Boolean,required:true}},data(){return{ButtonSize:p.ButtonSize,ButtonColor:p.ButtonColor,btnWaiting:false}},methods:{cancelBookingHandler(){this.btnWaiting=true;this.$emit("bookingCanceled")},closePopup(){this.$emit("popupClosed")}},computed:{popupId(){return`booking-confirm-page-popup-${this.booking.id}`},popupConfig(){return{className:"booking-confirm-page-popup",offsetLeft:0,offsetTop:0,overlay:true,borderRadius:"5px"}}},watch:{booking:{handler(t){if(t.isDeleted===true){this.btnWaiting=false;this.closePopup()}},deep:true}},template:`\n\t\t<Popup\n\t\t\tv-if="showPopup"\n\t\t\t:id="popupId"\n\t\t\t:config="popupConfig"\n\t\t\t@close="closePopup"\n\t\t>\n\t\t\t<div class="cancel-booking-popup-content">\n\t\t\t\t<div class="cancel-booking-popup-content-title">{{ loc('BOOKING_CONFIRM_PAGE_MESSAGEBOX_TILE') }}</div>\n\t\t\t\t<div class="cancel-booking-popup-content-text">{{ loc('BOOKING_CONFIRM_PAGE_MESSAGEBOX_TEXT') }}</div>\n\t\t\t\t<div class="cancel-booking-popup-content-buttons">\n\t\t\t\t\t<Button\n\t\t\t\t\t\t:text="loc('BOOKING_CONFIRM_PAGE_MESSAGEBOX_BTN_NO')"\n\t\t\t\t\t\t:size="ButtonSize.EXTRA_SMALL"\n\t\t\t\t\t\t:color="ButtonColor.LIGHT_BORDER"\n\t\t\t\t\t\t:buttonClass="'cancel-booking-popup-content-buttons-no'"\n\t\t\t\t\t\t@click="closePopup"\n\t\t\t\t\t/>\n\t\t\t\t\t<Button\n\t\t\t\t\t\t:text="loc('BOOKING_CONFIRM_PAGE_MESSAGEBOX_BTN_YES')"\n\t\t\t\t\t\t:size="ButtonSize.EXTRA_SMALL"\n\t\t\t\t\t\t:buttonClass="'cancel-booking-popup-content-buttons-yes'"\n\t\t\t\t\t\t:waiting="btnWaiting"\n\t\t\t\t\t\t@click="cancelBookingHandler"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`};const h={name:"Cancel",emits:["bookingCanceled","bookingConfirmed"],components:{Icon:r.BIcon,Button:p.Button,CancelPopup:C,ConfirmPopup:v},props:{booking:{type:Object,required:true},context:{type:String,required:true}},data(){return{ButtonSize:p.ButtonSize,ButtonColor:p.ButtonColor,ButtonIcon:p.ButtonIcon,showPopup:this.context==="delayed.pub.page",btnWaiting:false,showLink:true}},methods:{cancelBookingHandler(){this.btnWaiting=true;this.$emit("bookingCanceled")},confirmBookingHandler(){this.btnWaiting=true;this.$emit("bookingConfirmed")},cancelBtnHandler(){if(this.booking.isDeleted===true){return}this.showPopup=true},closePopup(){this.showPopup=false}},computed:{icon(){return r.Set.UNDO_1},iconSize(){return 17},iconColor(){return"#A8ADB4"},popupId(){return`booking-confirm-page-popup-${this.booking.id}`},popupConfig(){return{className:"booking-confirm-page-popup",offsetLeft:0,offsetTop:0,overlay:true,borderRadius:"5px"}},showCancelBtn(){return this.context!=="manager.view.details"}},watch:{booking:{handler(t){if(t.isDeleted===true){this.showLink=false;this.btnWaiting=false;this.showPopup=false}if(t.isConfirmed===true){this.btnWaiting=false;this.showPopup=false}},deep:true}},template:`\n\t\t<div v-if="showLink" class="cancel-booking">\n\t\t\t<Icon :name="icon" :size="iconSize" :color="iconColor" v-if="showCancelBtn"/>\n\t\t\t<a class="cancel-booking-link" @click="cancelBtnHandler" v-if="showCancelBtn">\n\t\t\t\t{{ loc('BOOKING_CONFIRM_PAGE_CANCEL_BTN') }}\n\t\t\t</a>\n\t\t</div>\n\t\t<CancelPopup \n\t\t\tv-if="context === 'cancel.pub.page'"\n\t\t\t:showPopup="showPopup" \n\t\t\t:booking="booking"\n\t\t\t@bookingCanceled="cancelBookingHandler"\n\t\t\t@popupClosed="closePopup"\n\t\t/>\n\t\t<ConfirmPopup\n\t\t\tv-if="context === 'delayed.pub.page'"\n\t\t\t:showPopup="showPopup"\n\t\t\t:booking="booking"\n\t\t\t@bookingCanceled="cancelBookingHandler"\n\t\t\t@bookingConfirmed="confirmBookingHandler"\n\t\t\t@closePopup="closePopup"\n\t\t/>\n\t`};const O={name:"Footer",emits:["bookingCanceled","bookingConfirmed"],components:{Cancel:h},props:{booking:{type:Object,required:true},context:{type:String,required:true}},data(){return{}},template:`\n\t\t<div>\n\t\t\t<Cancel \n\t\t\t\t:booking="booking"\n\t\t\t\t:context="context"\n\t\t\t\t@bookingCanceled="$emit('bookingCanceled')"\n\t\t\t\t@bookingConfirmed="$emit('bookingConfirmed')"\n\t\t\t/>\n\t\t</div>\n\t`};const _={name:"ConfirmPageApp",components:{Header:g,Content:B,Footer:O},props:{booking:{type:Object,required:true},hash:{type:String,required:true},company:{type:String,required:true},context:{type:String,required:true}},data(){return{confirmedBooking:this.booking,confirmedContext:this.context}},methods:{async bookingCancelHandler(){try{await c.ajax.runComponentAction("bitrix:booking.pub.confirm","cancel",{mode:"class",data:{hash:this.hash}});this.confirmedBooking.isDeleted=true;if(this.confirmedContext==="delayed.pub.page"){this.confirmedContext="cancel.pub.page"}}catch(t){console.error("Confirm page: cancel error",t)}},async bookingConfirmHandler(){try{await c.ajax.runComponentAction("bitrix:booking.pub.confirm","confirm",{mode:"class",data:{hash:this.hash}});this.confirmedBooking.isConfirmed=true;if(this.confirmedContext==="delayed.pub.page"){this.confirmedBooking.confirmedByDelayed=true;this.confirmedContext="cancel.pub.page"}}catch(t){console.error("Confirm page: confirm error",t)}}},template:`\n\t\t<div class="confirm-page-container">\n\t\t\t<div class="confirm-page-body">\n\t\t\t\t<Header \n\t\t\t\t\t:booking="confirmedBooking"\n\t\t\t\t\t:company="company"\n\t\t\t\t\t:context="confirmedContext"\n\t\t\t\t/>\n\t\t\t\t<Content :booking="confirmedBooking"/>\n\t\t\t\t<Footer \n\t\t\t\t\t:booking="confirmedBooking"\n\t\t\t\t\t:context="confirmedContext"\n\t\t\t\t\t@bookingCanceled="bookingCancelHandler"\n\t\t\t\t\t@bookingConfirmed="bookingConfirmHandler"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};class I{constructor(t){const n=o.BitrixVue.createApp(_,t);n.mixin(e.locMixin);n.mount(t.container)}}t.ConfirmPagePublic=I})(this.BX.Booking=this.BX.Booking||{},BX.Vue3,BX.Booking.Model,BX.Booking.Component.Mixin,BX,BX.Main,BX.UI.IconSet,BX,BX.Main,BX.Booking.Component,BX.Booking.Component);
//# sourceMappingURL=confirm-page-public.bundle.map.js