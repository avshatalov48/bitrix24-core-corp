this.BX=this.BX||{};(function(t,e,i,o,n,s,r,a,c,l,d,u,p,m,h,T,f,_,R,v,C,y,S,g,w,b,N,I,E,O,B,A,k,L,D,z,M,P){"use strict";const x={name:"UiLoader",props:{show:Boolean},data(){return{loader:new r.Loader}},mounted(){void this.loader.show(this.$refs.loader)},template:`\n\t\t<div ref="loader"></div>\n\t`};const W={name:"ResourceCreationWizardLayout",props:{step:{type:Number,required:true},title:{type:String,default:""},loading:Boolean},watch:{step(){var t;(t=this.$refs.wrapper)==null?void 0:t.scrollTo(0,0)}},components:{UiLoader:x},template:`\n\t\t<div class="resource-creation-wizard-layout">\n\t\t\t<div ref="wrapper" class="resource-creation-wizard__wrapper">\n\t\t\t\t<div class="resource-creation-wizard__header">\n\t\t\t\t\t<slot name="header">\n\t\t\t\t\t\t<h4 class="resource-creation-wizard__header-title">\n\t\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t\t</h4>\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t\t<div v-show="!loading" class="resource-creation-wizard__content">\n\t\t\t\t\t<slot/>\n\t\t\t\t</div>\n\t\t\t\t<UiLoader v-if="loading"/>\n\t\t\t</div>\n\t\t\t<slot name="footer"/>\n\t\t</div>\n\t`};const F={name:"ResourceCreationWizardHeader",computed:{title(){return this.$store.state["resource-creation-wizard"].resourceName}},template:`\n\t\t<span class="resource-creation-wizard__header-title">\n\t\t\t{{ title }}\n\t\t</span>\n\t`};const H={name:"NextButton",components:{UiButton:z.Button},props:{step:{type:Number,required:true},steps:{type:Array,required:true},disabled:Boolean,waiting:Boolean},computed:{currentStep(){return this.steps[this.step-1]},size(){return z.ButtonSize.SMALL},color(){return z.ButtonColor.SUCCESS}},template:`\n\t\t<UiButton\n\t\t\t:text="currentStep.labelNext"\n\t\t\t:title="currentStep.labelNext"\n\t\t\t:size\n\t\t\t:color\n\t\t\t:disabled\n\t\t\t:waiting\n\t\t\t@click="currentStep.next()"\n\t\t/>\n\t`};const $={name:"BackButton",props:{step:{type:Number,required:true},steps:{type:Array,required:true}},computed:{buttonSize(){return z.ButtonSize.SMALL},buttonColor(){return z.ButtonColor.LINK},currentStep(){return this.steps[this.step-1]}},components:{UiButton:z.Button},template:`\n\t\t<UiButton\n\t\t\tclass="resource-creation-wizard__back-button"\n\t\t\t:text="currentStep.labelBack"\n\t\t\t:title="currentStep.labelBack"\n\t\t\t:size="buttonSize"\n\t\t\t:color="buttonColor"\n\t\t\t@click="currentStep.back()"\n\t\t/>\n\t`};class G{constructor(t=false){this.hidden=false;this.hidden=t}get store(){return this.getStore()}getStore(){return a.Core.getStore()}get labelNext(){return N.Loc.getMessage("BRCW_BUTTON_CONTINUE")}get labelBack(){return N.Loc.getMessage("BRCW_BUTTON_CANCEL")}async next(){await this.store.dispatch("resource-creation-wizard/nextStep")}async back(){await this.store.dispatch("resource-creation-wizard/prevStep")}}class X extends G{constructor(){super(true)}get labelBack(){return N.Loc.getMessage("BRCW_BUTTON_CANCEL")}next(){return super.next()}back(){N.Event.EventEmitter.emit(M.EventName.CloseWizard)}}var q=babelHelpers.classPrivateFieldLooseKey("upsertResource");var U=babelHelpers.classPrivateFieldLooseKey("isBitrix24SenderAvailable");var V=babelHelpers.classPrivateFieldLooseKey("prepareNotificationOptions");class j extends G{constructor(){super();Object.defineProperty(this,V,{value:Z});Object.defineProperty(this,U,{value:Y});Object.defineProperty(this,q,{value:K});this.step=3}get labelNext(){var t;const e=((t=this.store.getters[`${M.Model.ResourceCreationWizard}/getResource`])==null?void 0:t.id)||null;return N.Type.isNull(e)?N.Loc.getMessage("BRCW_BUTTON_CREATE_RESOURCE"):N.Loc.getMessage("BRCW_BUTTON_UPDATE_RESOURCE")}async next(){this.store.commit(`${M.Model.ResourceCreationWizard}/setSaving`,true);const t=await this.isBitrix24Approved();if(!t){this.store.commit(`${M.Model.ResourceCreationWizard}/setSaving`,false);return}if(this.store.getters[`${M.Model.ResourceCreationWizard}/isGlobalSchedule`]){var e,i;const t=(e=(i=this.store.state[M.Model.ResourceCreationWizard].resource.slotRanges[0])==null?void 0:i.slotSize)!=null?e:60;const o=this.store.getters[`${M.Model.ResourceCreationWizard}/getCompanyScheduleSlots`];const n=this.store.getters[`${M.Model.Interface}/timezone`];const s=o.map((e=>({...e,slotSize:t,timezone:n})));await this.store.dispatch(`${M.Model.ResourceCreationWizard}/updateResource`,{slotRanges:s})}const o=this.store.state[M.Model.ResourceCreationWizard].resource;const n=this.store.getters[`${M.Model.ResourceTypes}/getById`](o.typeId);const s=await babelHelpers.classPrivateFieldLooseBase(this,q)[q](o);if(!s){this.store.commit(`${M.Model.ResourceCreationWizard}/setSaving`,false);return}await T.resourceTypeService.update(n);this.store.commit(`${M.Model.ResourceCreationWizard}/init`,{step:1,resourceId:null,resource:null});N.Event.EventEmitter.emit(M.EventName.CloseWizard)}async isBitrix24Approved(){if(!babelHelpers.classPrivateFieldLooseBase(this,U)[U]()){return Promise.resolve(true)}return d.ConditionChecker.checkIsApproved({senderType:d.Types.bitrix24})}back(){return super.back()}}async function K(t){const e=Boolean(t.id);const i=await(e?l.resourceService.update(t):l.resourceService.add(t));let o=N.Loc.getMessage(e?"BRCW_UPDATE_SUCCESS_MESSAGE":"BRCW_CREATE_SUCCESS_MESSAGE");if(N.Type.isArrayFilled(i.errors)){o=i.errors[0].message}c.Notifier.notify(babelHelpers.classPrivateFieldLooseBase(this,V)[V](o));return!N.Type.isArrayFilled(i.errors)}function Y(){const t=this.store.getters[`${M.Model.Notifications}/getSenders`].find((t=>t.moduleId===M.Module.Crm&&t.code===d.Types.bitrix24));if(!t){return false}return t.canUse}function Z(t){return{id:N.Text.getRandom(),text:t}}var Q=babelHelpers.classPrivateFieldLooseKey("isFirstStep");class J extends G{constructor(){super();Object.defineProperty(this,Q,{get:tt,set:void 0});this.step=2}get labelBack(){return babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]?super.labelBack:N.Loc.getMessage("BRCW_BUTTON_BACK")}async next(){const t=this.getStore();if(!t.state[M.Model.ResourceCreationWizard].resource.name){if(!N.Type.isNull(t.state[M.Model.ResourceCreationWizard].resourceId)){await t.dispatch(`${M.Model.ResourceCreationWizard}/setInvalidResourceName`,true);return}await t.dispatch(`${M.Model.ResourceCreationWizard}/updateResource`,{name:N.Loc.getMessage("BRCW_DEFAULT_RESOURCE_NAME")})}if(!t.state[M.Model.ResourceCreationWizard].resource.typeId){await t.dispatch(`${M.Model.ResourceCreationWizard}/setInvalidResourceType`,true);return}return super.next()}async back(){if(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]){N.Event.EventEmitter.emit(M.EventName.CloseWizard)}else{await super.back()}}}function tt(){return this.store.getters[`${M.Model.ResourceCreationWizard}/startStep`]===this.step}const et={name:"ResourceCreationWizardFooter",props:{step:{type:Number,required:true},disabled:Boolean},data(){return{steps:[new X,new J,new j]}},computed:L.mapGetters({isSaving:`${M.Model.ResourceCreationWizard}/isSaving`}),components:{BackButton:$,NextButton:H},template:`\n\t\t<div v-if="!steps[step - 1].hidden" class="resource-creation-wizard__footer">\n\t\t\t<NextButton :step :steps :disabled :waiting="isSaving"/>\n\t\t\t<BackButton :step :steps :disabled="isSaving"/>\n\t\t</div>\n\t`};const it={name:"ResourceType",emits:["selected"],props:{resourceType:{type:Object,required:true}},data(){return{IconSet:E.Set}},components:{Icon:E.BIcon},template:`\n\t\t<div class="booking--rcw--resource-type-item" @click="$emit('selected', resourceType)">\n\t\t\t<div class="rcw__resource-type">\n\t\t\t\t<div :class="['booking--rcw--resource-type__icon', 'booking--rcw--resource-type__icon--' + resourceType.code]">\n\t\t\t\t</div>\n\t\t\t\t<div class="rcw__resource-type__row">\n\t\t\t\t\t<div class="rcw__resource-type__label">\n\t\t\t\t\t\t<div class="rcw__resource-type__label-title">{{ resourceType.name }}</div>\n\t\t\t\t\t\t<div class="rcw__resource-type__label-description">{{ resourceType.description }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Icon :name="IconSet.ARROW_RIGHT"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const ot={name:"ResourceCategoryCard",computed:{resourceTypes(){return this.$store.state[M.Model.ResourceCreationWizard].advertisingResourceTypes}},methods:{...L.mapMutations(M.Model.ResourceCreationWizard,["updateResource","updateFetching"]),loadResourceTypes(){this.updateFetching(true);setTimeout((()=>{this.updateFetching(false)}),1)},async selectResourceType({relatedResourceTypeId:t}){this.updateResource({typeId:t});await this.$store.dispatch(`${M.Model.ResourceCreationWizard}/nextStep`)},showHelpDesk(){P.helpDesk.show(M.HelpDesk.ResourceType.code,M.HelpDesk.ResourceType.anchorCode)}},beforeMount(){this.loadResourceTypes()},components:{ResourceType:it},template:`\n\t\t<div class="resource-category-card">\n\t\t\t<div class="resource-category-card__header">\n\t\t\t\t<div class="resource-category-card__header__title">\n\t\t\t\t\t{{ loc('BRCW_CHOOSE_CATEGORY') }}\n\t\t\t\t</div>\n\t\t\t\t<div class="booking--resource-category-card__header__sub-title">\n\t\t\t\t\t{{ loc('BRCW_CHOOSE_CATEGORY_DESCRIPTION') }}\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass="booking--rcw--more"\n\t\t\t\t\t\t@click="showHelpDesk"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ loc('BRCW_CHOOSE_CATEGORY_DESCRIPTION_MORE') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="resource-category-card__content resource-creation-wizard__form">\n\t\t\t\t<ResourceType\n\t\t\t\t\tv-for="resourceType in resourceTypes"\n\t\t\t\t\t:key="resourceType.code"\n\t\t\t\t\t:resource-type\n\t\t\t\t\t:data-id="'brcw-resource-type-list-' + resourceType.code"\n\t\t\t\t\t@selected="selectResourceType"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};const nt={name:"ErrorMessage",props:{message:{type:String,default:""}},template:`\n\t\t<div class="booking--rcw--error-message-container">\n\t\t\t<div class="booking--rcw--error-message">\n\t\t\t\t<span class="ui-icon-set --warning"></span>\n\t\t\t\t<span>{{ message }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`};const st={name:"ResourceSettingsCardBaseFields",emits:["nameUpdate","typeUpdate"],props:{initialResourceName:{type:String,default:""},initialResourceType:{type:Object,required:true}},data(){return{entityId:M.EntitySelectorEntity.ResourceType,typeSelectorId:`booking-resource-creation-types${N.Text.getRandom()}`,typeName:this.initialResourceType.typeName}},computed:{resourceName:{get(){return this.initialResourceName},set(t=""){this.$emit("nameUpdate",t)}},invalidResourceName(){return this.$store.state[M.Model.ResourceCreationWizard].invalidResourceName},invalidResourceType(){return this.$store.state[M.Model.ResourceCreationWizard].invalidResourceType},errorMessage(){return this.loc("BRCW_SETTINGS_CARD_REQUIRED_FIELD")}},methods:{showTypeSelector(){const t=this.getTypeSelectorDialog(this.$refs.typeSelectorAngle);t.show()},getTypeSelectorDialog(t){const e=m.Dialog.getById(this.typeSelectorId);if(e){e.setTargetNode(t);return e}return new m.Dialog({id:this.typeSelectorId,targetNode:t,width:300,height:400,enableSearch:true,dropdownMode:true,context:"bookingResourceCreationType",multiple:false,cacheable:true,entities:[{id:this.entityId,dynamicLoad:true,dynamicSearch:true}],popupOptions:{targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")},searchOptions:{allowCreateItem:true,footerOptions:{label:this.loc("BRCW_SETTINGS_CARD_TYPE_SELECTOR_CREATE_BTN")}},events:{"Search:onItemCreateAsync":t=>new Promise((e=>{const{searchQuery:i}=t.getData();const o=t.getTarget();this.createType(i.getQuery()).then((t=>{this.updateResourceType(t.id,t.name);o.addItem(this.prepareTypeToDialog(t));o.hide();e()})).catch((()=>{e()}))})),"Item:onSelect":t=>{const e=t.getData().item;this.updateResourceType(e.getId(),e.getTitle())}}})},async createType(t){return T.resourceTypeService.add({moduleId:"booking",name:t})},prepareTypeToDialog(t){return{id:t.id,entityId:this.entityId,title:t.name,sort:1,selected:true,tabs:"recents",supertitle:this.loc("BRCW_SETTINGS_CARD_TYPE_SELECTOR_SUPER_TITLE"),avatar:"/bitrix/js/booking/images/entity-selector/resource-type.svg"}},updateResourceType(t,e){this.typeName=e;this.$emit("typeUpdate",t)},scrollToBaseFieldsForm(){var t;(t=this.$refs.baseFieldsForm)==null?void 0:t.scrollIntoView(true,{behavior:"smooth",block:"center"})}},watch:{invalidResourceName(t){if(t){this.scrollToBaseFieldsForm()}},invalidResourceType(t){if(t){this.scrollToBaseFieldsForm()}}},components:{ErrorMessage:nt},template:`\n\t\t<div ref="baseFieldsForm" class="ui-form resource-creation-wizard__form-settings --base">\n\t\t\t<div class="ui-form-row-inline booking--rcw--form-row-align">\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t<label class="ui-ctl-label-text" for="brcw-settings-resource-name">\n\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_NAME_LABEL') }}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-content booking--rcw--field-with-validation">\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tv-model.trim="resourceName"\n\t\t\t\t\t\t\t\tid="brcw-settings-resource-name"\n\t\t\t\t\t\t\t\tdata-id="brcw-settings-resource-name-input"\n\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t:class="{ '--error': invalidResourceName }"\n\t\t\t\t\t\t\t\t:placeholder="this.loc('BRCW_SETTINGS_CARD_NAME_PLACEHOLDER')"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<ErrorMessage\n\t\t\t\t\t\t\tv-if="invalidResourceName"\n\t\t\t\t\t\t\t:message="errorMessage"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">\n\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_TYPE_LABEL') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-content booking--rcw--field-with-validation">\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tref="typeSelectorAngle"\n\t\t\t\t\t\t\t\tclass="ui-ctl-after ui-ctl-icon-angle"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tref="typeSelectorElement"\n\t\t\t\t\t\t\t\tdata-id="brcw-settings-resource-type-selector"\n\t\t\t\t\t\t\t\tclass="ui-ctl-element resource-creation-wizard__form-settings-element"\n\t\t\t\t\t\t\t\t:class="{\n\t\t\t\t\t\t\t\t\t'--placeholder': !typeName,\n\t\t\t\t\t\t\t\t\t'--error': invalidResourceType,\n\t\t\t\t\t\t\t\t}"\n\t\t\t\t\t\t\t\t@click="showTypeSelector"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<template v-if="typeName">\n\t\t\t\t\t\t\t\t\t{{ typeName }}\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_TYPE_PLACEHOLDER') }}\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<ErrorMessage\n\t\t\t\t\t\t\tv-if="invalidResourceType"\n\t\t\t\t\t\t\t:message="errorMessage"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const rt={name:"ResourceSettingsCardTitleLayout",props:{title:{type:String,required:true},iconType:{type:String,required:true}},components:{Icon:E.BIcon},template:`\n\t\t<div class="resource-creation-wizard__form-settings-title-row">\n\t\t\t<Icon\n\t\t\t\t:name="iconType"\n\t\t\t\t:color="'var(--ui-color-primary)'"\n\t\t\t\t:size="24"\n\t\t\t/>\n\t\t\t<div class="resource-creation-wizard__form-settings-title">\n\t\t\t\t{{ title }}\n\t\t\t</div>\n\t\t</div>\n\t`};const at={name:"ScheduleItem",emits:["update:model-value"],props:{modelValue:{type:Boolean,required:true},itemClass:{type:String,required:true},title:{type:String,required:true},description:{type:String,required:true},value:{type:Boolean,required:true}},methods:{selectOption(){this.$emit("update:model-value",this.value)},showHelpDesk(){P.helpDesk.show(M.HelpDesk.ResourceSchedule.code,M.HelpDesk.ResourceSchedule.anchorCode)}},computed:{isSelected(){return this.modelValue.toString()===this.value.toString()},moreLabel(){return this.loc("BRCW_SETTINGS_CARD_MORE")}},template:`\n\t\t<div \n\t\t\t:class="['booking--rcw--schedule-item', { '--selected': isSelected }]" \n\t\t\t@click="selectOption"\n\t\t>\n\t\t\t<div class="booking--rcw--schedule-item-radio ui-ctl-radio">\n\t\t\t\t<input\n\t\t\t\t\t:id="itemClass"\n\t\t\t\t\t:checked="isSelected"\n\t\t\t\t\t:value="value.toString()"\n\t\t\t\t\ttype="radio"\n\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t@input="$emit('update:model-value', $event.target.value === 'true')"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class="booking--rcw--schedule-item-text">\n\t\t\t\t<label\n\t\t\t\t\t:for="itemClass"\n\t\t\t\t\tclass="booking--rcw--schedule-item-text-title">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</label>\n\t\t\t\t<div class="booking--rcw--schedule-item-text-description">{{ description }}</div>\n\t\t\t\t<span \n\t\t\t\t\tclass="booking--rcw--more booking--rcw--schedule-item-text-description-more"\n\t\t\t\t\t@click="showHelpDesk"\n\t\t\t\t>\n\t\t\t\t\t{{ moreLabel }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div class="booking--rcw--schedule-item-view" :class="itemClass"></div>\n\t\t</div>\n\t`};const ct={name:"ResourceSettingsCardScheduleTypes",emits:["update:model-value"],props:{modelValue:{type:Boolean,default:true}},components:{TitleLayout:rt,ScheduleItem:at},computed:{title(){return this.loc("BRCW_SETTINGS_CARD_SCHEDULE_TITLE")},titleIconType(){return E.Set.COLLABORATION},items(){return[{id:"common",itemClass:"resource-creation-wizard__form-settings-schedule-view-common",title:this.loc("BRCW_SETTINGS_CARD_SCHEDULE_COLUMNS_TITLE"),description:this.loc("BRCW_SETTINGS_CARD_SCHEDULE_COLUMNS_DESCRIPTION"),value:true},{id:"extra",itemClass:"resource-creation-wizard__form-settings-schedule-view-extra",title:this.loc("BRCW_SETTINGS_CARD_SCHEDULE_CROSS_RESOURCING_TITLE"),description:this.loc("BRCW_SETTINGS_CARD_SCHEDULE_CROSS_RESOURCING_DESCRIPTION"),value:false}]}},template:`\n\t\t<div class="ui-form resource-creation-wizard__form-settings --schedule">\n\t\t\t<TitleLayout\n\t\t\t\t:title="title"\n\t\t\t\t:iconType="titleIconType"\n\t\t\t/>\n\t\t\t<div class="resource-creation-wizard__form-settings-schedule-view">\n\t\t\t\t<ScheduleItem\n\t\t\t\t\tv-for="item in items"\n\t\t\t\t\t:key="item.id"\n\t\t\t\t\t:data-id="'brcw-resource-schedule-view-' + item.id"\n\t\t\t\t\t:model-value="modelValue"\n\t\t\t\t\t:item-class="item.itemClass"\n\t\t\t\t\t:title="item.title"\n\t\t\t\t\t:description="item.description"\n\t\t\t\t\t:value="item.value"\n\t\t\t\t\t@update:model-value="$emit('update:model-value', $event)"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};const lt={name:"ResourceSettingsCardTextLayout",props:{type:{type:String,required:true},text:{type:String,required:true}},methods:{showHelpDesk(){P.helpDesk.show(M.HelpDesk[`Resource${this.type}`].code,M.HelpDesk[`Resource${this.type}`].anchorCode)}},template:`\n\t\t<div class="resource-creation-wizard__form-settings-text-row">\n\t\t\t<div class="resource-creation-wizard__form-settings-text">\n\t\t\t\t{{ text }}\n\t\t\t\t<span @click="showHelpDesk">{{ loc('BRCW_SETTINGS_CARD_MORE') }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`};const{mapGetters:dt}=L.createNamespacedHelpers("resource-creation-wizard");const ut={data(){return{selected:{Mon:false,Tue:false,Wed:false,Thu:false,Fri:false,Sat:false,Sun:false},daysLabel:""}},created(){this.initialDays.forEach((t=>{if(Object.prototype.hasOwnProperty.call(this.selected,t)){this.selected[t]=true}}));this.daysLabel=this.formatDaysLabel()},methods:{formatDaysLabel(){const t=this.loc("BRCW_SETTINGS_CARD_WORK_TIME_DAYS");const e=this.companyScheduleSlots[0].weekDays;if(this.isArraysEqual(this.selectedDays,e)){return t}const i=Object.keys(this.daysLabelMap);const o=this.selectedDays.sort(((t,e)=>i.indexOf(t)-i.indexOf(e)));const n=o.map((t=>this.daysLabelMap[t]));return String(n.join(", "))},getDayDefaultIndex(t){const e={Sun:0,Mon:1,Tue:2,Wed:3,Thu:4,Fri:5,Sat:6};return e[t]},isArraysEqual(t,e){return t.length===e.length&&t.every(((t,i)=>t===e[i]))}},computed:{...dt({companyScheduleSlots:"getCompanyScheduleSlots",weekStart:"weekStart"}),selectedDays(){return Object.keys(this.selected).filter((t=>this.selected[t]))},daysLabelMap(){const t=[];const e="D";const i=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];const o=i.indexOf(this.weekStart);const n=[...i.slice(o),...i.slice(0,o)];n.forEach(((i,o)=>{const n=(new Date).getDay();const s=this.getDayDefaultIndex(i);const r=(s-n+7)%7;const a=new Date;a.setDate(a.getDate()+r);t[o]=g.DateTimeFormat.format(e,a)}));return n.reduce(((e,i,o)=>{e[i]=t[o];return e}),{})}}};const pt={name:"ResourceSettingsCardWeekDaysPopup",emits:["select","close"],props:{id:{type:String,required:true},bindElement:{type:HTMLElement,required:true},initialDays:{type:Array,required:true}},components:{Popup:w.Popup},mixins:[ut],methods:{close(){this.$emit("close")},click(t){const e=Object.keys(this.selected).filter((t=>this.selected[t]===true));if(e.length===1&&e[0]===t){return}this.selected[t]=!this.selected[t];this.$emit("select",this.selectedDays,this.formatDaysLabel())}},computed:{popupId(){return`booking-work-time-popup-${this.id}`},config(){return{bindElement:this.bindElement,targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper"),offsetRight:this.bindElement.offsetWidth,angle:false,bindOptions:{forceBindPosition:true,forceLeft:true}}}},template:`\n\t\t<Popup\n\t\t\t:id="popupId"\n\t\t\t:config="config"\n\t\t\t@close="close"\n\t\t\tref="popup"\n\t\t>\n\t\t\t<div class="resource-creation-wizard__form-week-days-popup">\n\t\t\t\t<div\n\t\t\t\t\tv-for="(day, index) in daysLabelMap"\n\t\t\t\t\t:key="index"\n\t\t\t\t\t:data-id="'brcw-resource-work-time-week-day-' + index + '-' + id"\n\t\t\t\t\tclass="resource-creation-wizard__form-week-days-popup-weekday"\n\t\t\t\t\t:class="{ '--selected': selected[index] }"\n\t\t\t\t\t@click="() => click(index)"\n\t\t\t\t>\n\t\t\t\t\t<div class="resource-creation-wizard__form-week-days-popup-weekday-text">\n\t\t\t\t\t\t{{ day }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="resource-creation-wizard__form-week-days-popup-weekday-icon"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`};const mt={name:"ResourceSettingsCardWorkTimeSlotRange",emits:["add","update","remove"],props:{id:{type:Number,required:true},isLastRange:{type:Boolean,required:true},initialSlotRange:{type:Object,required:true}},components:{WeekDaysPopup:pt},mixins:[ut],data(){return{fromId:"from",toId:"to",fromTs:0,toTs:0,duration:0,isShownDays:false,arrow:{days:false,from:false,to:false},removeSlot:!this.isLastRange,localSlotRange:{...this.initialSlotRange},initialDays:[...this.initialSlotRange.weekDays]}},created(){this.fromTs=this.slotRange.from;this.toTs=this.slotRange.to;this.duration=this.toTs-this.fromTs},watch:{"slotRange.from":function(t){this.fromTs=t;this.toTs=this.fromTs+this.duration;this.update()},"slotRange.to":function(t){this.toTs=t;if(this.toTs<=this.fromTs){this.fromTs=this.toTs-this.duration}this.duration=this.toTs-this.fromTs;this.update()}},methods:{showDays(){this.isShownDays=true;this.arrow.days=true},hideDays(){this.isShownDays=false;this.arrow.days=false},selectDays(t,e){this.slotRange.weekDays=t;this.daysLabel=e;this.update()},show(t,e){if(this.arrow[e]===true){return}const i=b.MenuManager.create({id:`booking-work-time-popup-${Date.now()}`,className:"resource-creation-wizard__form-work-time-menu",bindElement:t,targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper"),autoHide:true,closeByEsc:true,events:{onShow:()=>{this.arrow[e]=true;const t=i.getMenuItems().find((t=>N.Dom.hasClass(t.getLayout().item,"--selected")));const o=36;const n=2*o;const s=i.getPopupWindow().getContentContainer();const r=N.Dom.getRelativePosition(t.getContainer(),s).top;s.scrollTo({top:s.scrollTop+r-n,behavior:"instant"})},onClose:()=>{this.arrow[e]=false}},maxHeight:200,minWidth:t.offsetWidth});for(const[t,o]of Object.entries(this.generateTimeMap(e))){const n=parseInt(t,10);const s="menu-popup-item menu-popup-no-icon";i.addMenuItem({text:o,className:this.slotRange[e]===n?`${s} --selected`:s,onclick:()=>{this.slotRange[e]=parseInt(n,10);i.close()}})}i.show()},generateTimeMap(t){const e={};const i=g.DateTimeFormat.getFormat("SHORT_TIME_FORMAT");const o=30;const n=t===this.toId?this.fromTs+o:0;const s=t===this.fromId?this.toTs:1440;for(let t=n;t<s;t+=o){const o=(new Date).setHours(0,t,0,0)/1e3;e[t]=g.DateTimeFormat.format(i,o)}if(t===this.toId){const t=(new Date).setHours(0,0,0,0)/1e3;e[s]=g.DateTimeFormat.format(i,t)}return e},clickBtn(){if(this.removeSlot===false){this.removeSlot=true;this.$emit("add")}else{this.removeSlot=false;this.$emit("remove",this.id)}},update(){this.$emit("update",this.id,this.slotRange)}},computed:{daysId(){return`days-${this.id}`},days(){return this.$refs.days},slotRange(){return this.localSlotRange},fromLabel(){const t=this.generateTimeMap(this.fromId);return t[this.slotRange.from]},toLabel(){const t=this.generateTimeMap(this.toId);return t[this.slotRange.to]}},template:`\n\t\t<div class="ui-form-content resource-creation-wizard__form-work-time-selector-widget">\n\t\t\t<div class="ui-form-row resource-creation-wizard__form-work-time-selector-widget-days">\n\t\t\t\t<div\n\t\t\t\t\tref="days"\n\t\t\t\t\t:data-id="'brcw-resource-work-time-slot-range-days-' + id"\n\t\t\t\t\tclass="rcw-ui-ctl ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-sm ui-ctl-round"\n\t\t\t\t\t@click="showDays"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass="ui-ctl-after ui-ctl-icon-angle"\n\t\t\t\t\t\t:class="{ '--active': arrow.days }"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div class="ui-ctl-element">\n\t\t\t\t\t\t{{ daysLabel }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<WeekDaysPopup\n\t\t\t\t\t\tv-if="isShownDays"\n\t\t\t\t\t\t:id="daysId"\n\t\t\t\t\t\t:bindElement="days"\n\t\t\t\t\t\t:initialDays="slotRange.weekDays"\n\t\t\t\t\t\t@select="selectDays"\n\t\t\t\t\t\t@close="hideDays"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ui-form-row resource-creation-wizard__form-work-time-selector-widget-time">\n\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tref="from"\n\t\t\t\t\t\t\t:data-id="'brcw-resource-work-time-slot-range-from-' + id"\n\t\t\t\t\t\t\tclass="ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-sm ui-ctl-round"\n\t\t\t\t\t\t\t@click="() => show($refs.from, fromId)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass="ui-ctl-after ui-ctl-icon-angle"\n\t\t\t\t\t\t\t\t:class="{ '--active': arrow.from }"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div class="ui-ctl-element">{{ fromLabel }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t<div class="resource-creation-wizard__form-work-time-selector-dash"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tref="to"\n\t\t\t\t\t\t\t:data-id="'brcw-resource-work-time-slot-range-to-' + id"\n\t\t\t\t\t\t\tclass="ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-sm ui-ctl-round"\n\t\t\t\t\t\t\t@click="() => show($refs.to, toId)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass="ui-ctl-after ui-ctl-icon-angle"\n\t\t\t\t\t\t\t\t:class="{ '--active': arrow.to }"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div class="ui-ctl-element">{{ toLabel }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ui-form-row resource-creation-wizard__form-work-time-selector-btn-row">\n\t\t\t\t<div\n\t\t\t\t\t:data-id="'brcw-resource-work-time-slot-range-add-' + id"\n\t\t\t\t\tclass="resource-creation-wizard__form-work-time-selector-btn"\n\t\t\t\t\t:class="{ '--remove': removeSlot }"\n\t\t\t\t\t@click="clickBtn"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t</div>\n\t`};const ht={name:"ResourceSettingsCardWorkTimeSelector",emits:["update","updateGlobalSchedule","getGlobalSchedule"],props:{initialSlotRanges:{type:Array,required:true},isGlobalSchedule:{type:Boolean,required:true},defaultSlotRange:{type:Object,required:true},initialTimezone:{type:String,required:true},currentTimezone:{type:String,required:true},isCompanyScheduleAccess:{type:Boolean,required:true}},components:{WorkTimeSlotRange:mt,Icon:E.BIcon},data(){return{localSlotRanges:this.processSlotRanges(this.initialSlotRanges),isChecked:this.isGlobalSchedule,hasTimezonesDifference:false,formattedInitialOffset:"",formattedCurrentOffset:""}},created(){this.calculateDifferenceBetweenTimezones(this.initialTimezone,this.currentTimezone)},watch:{initialSlotRanges:{handler(t){this.localSlotRanges=this.processSlotRanges(t)},deep:true},isChecked(t){this.$emit("updateGlobalSchedule",t)}},methods:{openCompanyWorkTime(t){const e=t.target===t.currentTarget;if(!e&&this.isCompanyScheduleAccess){top.BX.Event.EventEmitter.subscribeOnce(top.BX.Event.EventEmitter.GLOBAL_TARGET,"SidePanel.Slider:onLoad",(t=>{const e=t.getTarget();e.getWindow().BX.Event.EventEmitter.subscribeOnce(e.getWindow().BX.Event.EventEmitter.GLOBAL_TARGET,"BX.Intranet.Settings:onSuccessSave",(t=>{const e=t.getData();e.reloadAfterClose=false;this.$emit("getGlobalSchedule")}))}));BX.SidePanel.Instance.open("/settings/configs/?page=schedule",{cacheable:false});t.preventDefault()}},updateSlotRange(t,e){this.slotRanges[t]=e;this.$emit("update",this.slotRanges)},addSlotRange(){this.slotRanges.push(this.defaultSlotRange);this.$emit("update",this.slotRanges)},removeSlotRange(t){this.slotRanges.splice(t,1);this.$emit("update",this.slotRanges)},processSlotRanges(t){return t.map((t=>{if(t.id===null){return{...t,id:N.Text.getRandom()}}return t}))},getTimezoneOffset(t){const e=new Date;const i=new Date(e.toLocaleString("en-US",{timeZone:"UTC"}));const o=new Date(e.toLocaleString("en-US",{timeZone:t}));return(i.getTime()-o.getTime())/(1e3*60)},calculateDifferenceBetweenTimezones(t,e){const i=this.getTimezoneOffset(t);const o=this.getTimezoneOffset(e);this.hasTimezonesDifference=i!==o;if(this.hasTimezonesDifference){const e=t=>{const e=t>=0?"+":"-";const i=Math.floor(Math.abs(t)/60);const o=Math.abs(t)%60;return`${e}${i}:${o.toString().padStart(2,"0")}`};this.formattedInitialOffset=`UTC ${e(-i)} ${t}`;const n=o-i;this.formattedCurrentOffset=e(n)}},onSlotClick(){this.isChecked=false}},computed:{companyWorkTimeOptionLabel(){return this.loc("BRCW_SETTINGS_CARD_WORK_TIME_COMPANY_OPTION")},slotRanges(){return this.localSlotRanges},isSlotsDisabled(){return this.isChecked},timezoneIconType(){return E.Set.EARTH_TIME},formattedTimezonesText(){return this.loc("BRCW_SETTINGS_CARD_WORK_TIME_TIMEZONES").replace("#utc#",this.formattedInitialOffset).replace("#difference#",this.formattedCurrentOffset)}},template:`\n\t\t<div class="ui-form resource-creation-wizard__form-work-time-selector">\n\t\t\t<div class="ui-form-row-inline">\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<label\n\t\t\t\t\t\tfor="brcw-settings-work-time-company-option"\n\t\t\t\t\t\tclass="ui-ctl ui-ctl-checkbox"\n\t\t\t\t\t>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid="brcw-settings-work-time-company-option"\n\t\t\t\t\t\t\tdata-id="brcw-settings-work-time-company-option"\n\t\t\t\t\t\t\ttype="checkbox"\n\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\tv-model="isChecked"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="ui-ctl-label-text work-time-selector-label-text"\n\t\t\t\t\t\t\t:class="{'--disabled': !isCompanyScheduleAccess }"\n\t\t\t\t\t\t\t@click="openCompanyWorkTime"\n\t\t\t\t\t\t\tv-html="companyWorkTimeOptionLabel"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass="resource-creation-wizard__form-work-time-selector-slots"\n\t\t\t\t:class="{'--disabled': isSlotsDisabled }"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tv-for="(slotRange, index) in slotRanges"\n\t\t\t\t\t:key="slotRange.id"\n\t\t\t\t\t:data-id="'brcw-resource-work-time-slot-' + slotRange.id"\n\t\t\t\t\tclass="ui-form-row-inline"\n\t\t\t\t\t@click="onSlotClick"\n\t\t\t\t>\n\t\t\t\t\t<WorkTimeSlotRange\n\t\t\t\t\t\t:id="index"\n\t\t\t\t\t\t:initialSlotRange="slotRange"\n\t\t\t\t\t\t:isLastRange="index === slotRanges.length - 1"\n\t\t\t\t\t\t@add="addSlotRange"\n\t\t\t\t\t\t@update="updateSlotRange"\n\t\t\t\t\t\t@remove="removeSlotRange"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if="hasTimezonesDifference"\n\t\t\t\t\tclass="resource-creation-wizard__form-work-time-selector-slots-timezone"\n\t\t\t\t>\n\t\t\t\t\t<div class="resource-creation-wizard__form-work-time-selector-slots-timezone-icon">\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t:name="timezoneIconType"\n\t\t\t\t\t\t\t:color="'var(--ui-color-palette-gray-50)'"\n\t\t\t\t\t\t\t:size="24"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass="resource-creation-wizard__form-work-time-selector-slots-timezone-text"\n\t\t\t\t\t\tv-html="formattedTimezonesText"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const Tt={name:"ResourceSettingsCardWorkTime",emits:["update","updateGlobalSchedule","getGlobalSchedule"],props:{initialSlotRanges:{type:Array,required:true},isGlobalSchedule:{type:Boolean,required:true},defaultSlotRange:{type:Object,required:true},initialTimezone:{type:String,required:true},currentTimezone:{type:String,required:true},isCompanyScheduleAccess:{type:Boolean,required:true}},components:{TitleLayout:rt,TextLayout:lt,WorkTimeSelector:ht},methods:{update(t){this.$emit("update",t)},updateGlobalSchedule(t){this.$emit("updateGlobalSchedule",t)},getGlobalSchedule(){this.$emit("getGlobalSchedule")}},computed:{title(){return this.loc("BRCW_SETTINGS_CARD_WORK_TIME_TITLE")},titleIconType(){return E.Set.CLOCK_2}},template:`\n\t\t<div class="ui-form resource-creation-wizard__form-settings">\n\t\t\t<TitleLayout\n\t\t\t\t:title="title"\n\t\t\t\t:iconType="titleIconType"\n\t\t\t/>\n\t\t\t<TextLayout\n\t\t\t\ttype="WorkTime"\n\t\t\t\t:text="loc('BRCW_SETTINGS_CARD_WORK_TIME_TEXT')"\n\t\t\t/>\n\t\t\t<WorkTimeSelector\n\t\t\t\t:initialSlotRanges="initialSlotRanges"\n\t\t\t\t:defaultSlotRange="defaultSlotRange"\n\t\t\t\t:isGlobalSchedule="isGlobalSchedule"\n\t\t\t\t:initialTimezone="initialTimezone"\n\t\t\t\t:currentTimezone="currentTimezone"\n\t\t\t\t:isCompanyScheduleAccess="isCompanyScheduleAccess"\n\t\t\t\t@update="update"\n\t\t\t\t@updateGlobalSchedule="updateGlobalSchedule"\n\t\t\t\t@getGlobalSchedule="getGlobalSchedule"\n\t\t\t/>\n\t\t</div>\n\t`};const ft={name:"ResourceSettingsCardSlotLengthSlotLengthPrecisionSelection",directives:{hint:I.hint},emits:["input"],components:{},props:{initialValue:{type:Number,default:0}},data(){return{days:0,hours:0,minutes:0}},created(){this.distributeInitialValue()},methods:{distributeInitialValue(){let t=this.initialValue;this.days=Math.floor(t/(24*60));t%=24*60;this.hours=Math.floor(t/60);t%=60;this.minutes=t},calculateTotalMinutes(){const t=this.days*24*60+this.hours*60+this.minutes;this.$emit("input",t)},validateHours(){this.hours=parseInt(this.hours,10);if(!N.Type.isNumber(this.hours)){this.hours=0}if(this.hours>12){this.hours=12}this.calculateTotalMinutes()},validateMinutes(){this.minutes=parseInt(this.minutes,10);if(!N.Type.isNumber(this.minutes)){this.minutes=0}if(this.minutes>59){this.minutes=59}this.calculateTotalMinutes()},handleEnterKey(t){if(t.key==="Enter"){t.target.blur()}}},computed:{hourHint(){return{text:this.loc("BRCW_SETTINGS_CARD_SLOT_LENGTH_PRECISION_LIMIT_HOUR"),popupOptions:{targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")}}},minutesHint(){return{text:this.loc("BRCW_SETTINGS_CARD_SLOT_LENGTH_PRECISION_LIMIT_MINUTES"),popupOptions:{targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")}}}},template:`\n\t\t<div class="ui-form resource-creation-wizard__form-slot-length-precision-selection">\n\t\t\t<div class="ui-form-row-inline">\n\t\t\t\t<div class="ui-form-row --disabled">\n\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div class="ui-ctl ui-ctl-time ui-ctl-sm ui-ctl-round">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t:data-id="'brcw-resource-slot-length-precision-days'"\n\t\t\t\t\t\t\t\t\tv-model="days"\n\t\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_SLOT_LENGTH_PRECISION_1') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tclass="ui-ctl ui-ctl-time ui-ctl-sm ui-ctl-round"\n\t\t\t\t\t\t\t\tv-hint="hourHint"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t:data-id="'brcw-resource-slot-length-precision-hours'"\n\t\t\t\t\t\t\t\t\tv-model="hours"\n\t\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t@blur="validateHours"\n\t\t\t\t\t\t\t\t\t@keydown="handleEnterKey"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_SLOT_LENGTH_PRECISION_2') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tclass="ui-ctl ui-ctl-time ui-ctl-sm ui-ctl-round"\n\t\t\t\t\t\t\t\tv-hint="minutesHint"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t:data-id="'brcw-resource-slot-length-precision-minutes'"\n\t\t\t\t\t\t\t\t\tv-model="minutes"\n\t\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t@blur="validateMinutes"\n\t\t\t\t\t\t\t\t\t@keydown="handleEnterKey"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_SLOT_LENGTH_PRECISION_3') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const _t=R.Duration.getUnitDurations();const Rt=Object.fromEntries(Object.entries(_t).map((([t,e])=>[t,e/_t.i])));const vt=new Set([Rt.H*24,Rt.d*7]);const Ct={name:"ResourceSettingsCardSlotLengthSelector",directives:{hint:I.hint},emits:["select"],components:{SlotLengthPrecisionSelection:ft},props:{initialSelectedValue:{type:Number,required:true}},data(){return{selectedValue:this.initialSelectedValue,selectedPrecisionValue:this.initialSelectedValue,precisionMode:false}},created(){const t=new Set([Rt.H,Rt.H*2,Rt.H*24,Rt.d*7]);if(!t.has(this.selectedValue)){this.selectedValue=0;this.precisionMode=true}},methods:{select(t){if(vt.has(t)){return}this.selectedValue=parseInt(t,10);if(t===0){this.precisionMode=true}else{this.precisionMode=false;this.$emit("select",this.selectedValue)}},selectPrecision(t){this.selectedPrecisionValue=t===0?Rt.H:parseInt(t,10);if(t===0){this.selectedValue=Rt.H;this.precisionMode=false}this.$emit("select",this.selectedPrecisionValue)},getClass(t){return{"ui-btn-primary":this.selectedValue===t,"ui-btn-light":this.selectedValue!==t,"ui-btn-disabled":vt.has(t)}},getSoonHintContent(t){if(vt.has(t)){return{text:this.loc("BRCW_SOON_HINT"),popupOptions:{targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper"),bindOptions:{position:"bottom"},offsetLeft:0,offsetTop:0}}}return null}},computed:{durations(){return[{label:new R.Duration(_t.H).format("H"),value:Rt.H},{label:new R.Duration(_t.H*2).format("H"),value:Rt.H*2},{label:new R.Duration(_t.H*24).format("H"),value:Rt.H*24},{label:new R.Duration(_t.d*7).format("d"),value:Rt.d*7},{label:this.loc("BRCW_SETTINGS_CARD_SLOT_LENGTH_SELECTOR_CUSTOM"),value:0}]}},template:`\n\t\t<div class="resource-creation-wizard__form-slot-length-selector">\n\t\t\t<div\n\t\t\t\tv-for="(duration, index) in durations"\n\t\t\t\t:key="index"\n\t\t\t\t:data-id="'brcw-resource-slot-length-selector-size-' + index"\n\t\t\t\tclass="ui-btn ui-btn-xs"\n\t\t\t\t:class="getClass(duration.value)"\n\t\t\t\t@click="select(duration.value)"\n\t\t\t\tv-hint="getSoonHintContent(duration.value)"\n\t\t\t>\n\t\t\t\t{{ duration.label }}\n\t\t\t</div>\n\t\t</div>\n\t\t<transition name="fade">\n\t\t\t<div\n\t\t\t\tv-if="precisionMode"\n\t\t\t\tclass="resource-creation-wizard__form-slot-length-precision"\n\t\t\t>\n\t\t\t\t<SlotLengthPrecisionSelection\n\t\t\t\t\t:initialValue="selectedPrecisionValue"\n\t\t\t\t\t@input="selectPrecision"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</transition>\n\t`};const yt={name:"ResourceSettingsCardSlotLength",emits:["select"],components:{TitleLayout:rt,TextLayout:lt,SlotLengthSelector:Ct},props:{initialSelectedValue:{type:Number,default:60}},data(){return{selectedSlotLength:this.initialSelectedValue}},methods:{updateSelectedValue(t){this.selectedSlotLength=t;this.$emit("select",t)}},computed:{title(){return this.loc("BRCW_SETTINGS_CARD_SLOT_LENGTH_TITLE")},titleIconType(){return E.Set.GANTT_GRAPHS}},template:`\n\t\t<div class="ui-form resource-creation-wizard__form-settings">\n\t\t\t<TitleLayout\n\t\t\t\t:title="title"\n\t\t\t\t:iconType="titleIconType"\n\t\t\t/>\n\t\t\t<TextLayout\n\t\t\t\ttype="SlotLength"\n\t\t\t\t:text="loc('BRCW_SETTINGS_CARD_SLOT_LENGTH_TEXT')"\n\t\t\t/>\n\t\t\t<div>\n\t\t\t\t<SlotLengthSelector\n\t\t\t\t\t:initialSelectedValue="initialSelectedValue"\n\t\t\t\t\t@select="updateSelectedValue"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};const{mapGetters:St,mapActions:gt,mapMutations:wt}=L.createNamespacedHelpers("resource-creation-wizard");const bt={name:"ResourceSettingsCard",components:{BaseFields:st,ScheduleTypes:ct,WorkTime:Tt,SlotLength:yt},created(){var t,e,i;this.initialTimezone=this.getInitialSlotTimeZone();this.selectedSlotLength=(t=(e=this.resource.slotRanges)==null?void 0:(i=e[0])==null?void 0:i.slotSize)!=null?t:60;const o=N.Type.isArrayFilled(this.resource.slotRanges)?this.resource.slotRanges:this.companyScheduleSlots;this.updateSlotRanges(o)},data(){return{selectedSlotLength:60,initialTimezone:""}},methods:{...gt(["setInvalidResourceName","setInvalidResourceType"]),...wt(["updateResource","setGlobalSchedule"]),updateResourceName(t){this.updateResource({name:t});if(t){this.setInvalidResourceName(false)}},updateResourceType(t){this.updateResource({typeId:t});if(t){this.setInvalidResourceType(false)}},updateSlotRanges(t){this.updateResource({slotRanges:this.updateSlotDataForAllRanges(t)})},updateSlotLength(t){this.selectedSlotLength=t;if(this.resource.slotRanges.length===0){return}this.updateSlotRanges(this.resource.slotRanges)},updateSlotDataForAllRanges(t){const e=t||this.resource.slotRanges;return e.map((t=>({...t,slotSize:this.selectedSlotLength,timezone:this.timezone})))},updateGlobalSchedule(t){this.setGlobalSchedule(t)},async fetchData(){await p.resourceCreationWizardService.fetchData();if(!this.isEditForm){this.updateSlotRanges(this.companyScheduleSlots)}},getInitialSlotTimeZone(){var t;const e=this.isEditForm?this.resource.slotRanges:this.companyScheduleSlots;return(t=e[0])==null?void 0:t.timezone}},computed:{...L.mapGetters({timezone:`${M.Model.Interface}/timezone`}),...St({resource:"getResource",companyScheduleSlots:"getCompanyScheduleSlots",isCompanyScheduleAccess:"isCompanyScheduleAccess",isGlobalSchedule:"isGlobalSchedule"}),resourceName(){return this.resource.name},resourceType(){const t=this.$store.getters["resourceTypes/getById"](this.resource.typeId);return{typeId:this.resource.typeId,typeName:t==null?void 0:t.name}},slotRanges(){return this.resource.slotRanges},defaultSlotRange(){return this.companyScheduleSlots[0]},slotSize(){var t,e;const i=(t=this.resource.slotRanges)==null?void 0:t[0];return(e=i==null?void 0:i.slotSize)!=null?e:60},isMain:{get(){return this.resource.isMain},set(t){this.updateResource({isMain:t})}},isEditForm(){return this.resource.id!==null}},template:`\n\t\t<div class="resource-settings-card">\n\t\t\t<BaseFields\n\t\t\t\t:data-id="'brcw-resource-settings-base'"\n\t\t\t\t:initialResourceName="resourceName"\n\t\t\t\t:initialResourceType="resourceType"\n\t\t\t\t@nameUpdate="updateResourceName"\n\t\t\t\t@typeUpdate="updateResourceType"\n\t\t\t/>\n\t\t\t<ScheduleTypes\n\t\t\t\t:data-id="'brcw-resource-settings-schedule-types'"\n\t\t\t\tv-model="isMain"\n\t\t\t/>\n\t\t\t<WorkTime\n\t\t\t\t:data-id="'brcw-resource-settings-work-time'"\n\t\t\t\t:initialSlotRanges="slotRanges"\n\t\t\t\t:defaultSlotRange="defaultSlotRange"\n\t\t\t\t:isGlobalSchedule="isGlobalSchedule"\n\t\t\t\t:initialTimezone="initialTimezone"\n\t\t\t\t:currentTimezone="timezone"\n\t\t\t\t:isCompanyScheduleAccess="isCompanyScheduleAccess"\n\t\t\t\t@update="updateSlotRanges"\n\t\t\t\t@updateGlobalSchedule="updateGlobalSchedule"\n\t\t\t\t@getGlobalSchedule="fetchData"\n\t\t\t/>\n\t\t\t<SlotLength\n\t\t\t\t:data-id="'brcw-resource-settings-slot-length'"\n\t\t\t\t:initialSelectedValue="slotSize"\n\t\t\t\t@select="updateSlotLength"\n\t\t\t/>\n\t\t</div>\n\t`};const Nt={name:"ChannelMenu",emits:["popupShown","popupClosed","update:value"],props:{currentChannel:{type:String,default:null}},data(){return{ButtonSize:z.ButtonSize,ButtonColor:z.ButtonColor,ButtonIcon:z.ButtonIcon,menuPopup:null,channel:this.loc("BRCW_NOTIFICATION_CARD_MESSAGE_SELECT_WHA")}},computed:{popupId(){return"booking-choose-channel-menu"},notificationChannelOptions(){return[{label:this.loc("BRCW_NOTIFICATION_CARD_MESSAGE_SELECT_WHA"),value:M.NotificationChannel.WhatsApp},{label:this.loc("BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_SELECT_SMS"),value:M.NotificationChannel.Sms}]}},mounted(){var t;this.channel=((t=this.notificationChannelOptions.find((({value:t})=>t===this.currentChannel)))==null?void 0:t.label)||this.loc("BRCW_NOTIFICATION_CARD_MESSAGE_SELECT_WHA")},unmounted(){if(this.menuPopup){this.destroy()}},methods:{openMenu(){var t,e;if((t=this.menuPopup)!=null&&(e=t.popupWindow)!=null&&e.isShown()){this.destroy();return}const i=this.$refs["menu-button"];this.menuPopup=b.MenuManager.create(this.popupId,i,this.getMenuItems(),{className:"booking-choose-channel-menu",closeByEsc:true,autoHide:true,offsetTop:0,offsetLeft:i.offsetWidth-i.offsetWidth/2,angle:true,cacheable:true,targetContainer:document.querySelector("div.resource-creation-wizard__wrapper"),events:{onClose:()=>this.destroy(),onDestroy:()=>this.destroy()}});this.menuPopup.show();this.bindScrollEvent();this.$emit("popupShown")},getMenuItems(){return[{text:this.loc("BRCW_NOTIFICATION_CARD_MESSAGE_SELECT_WHA"),onclick:()=>{this.channel=this.loc("BRCW_NOTIFICATION_CARD_MESSAGE_SELECT_WHA");this.$emit("update:value",M.NotificationChannel.WhatsApp);this.destroy()}},{text:this.loc("BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_SELECT_SMS"),onclick:()=>{this.channel=this.loc("BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_SELECT_SMS");this.$emit("update:value",M.NotificationChannel.Sms);this.destroy()}}]},destroy(){b.MenuManager.destroy(this.popupId);this.unbindScrollEvent();this.$emit("popupClosed")},bindScrollEvent(){N.Event.bind(document,"scroll",this.adjustPosition,{capture:true})},unbindScrollEvent(){N.Event.unbind(document,"scroll",this.adjustPosition,{capture:true})},adjustPosition(){var t,e;(t=this.menuPopup)==null?void 0:(e=t.popupWindow)==null?void 0:e.adjustPosition()}},components:{Icon:E.BIcon},template:`\n\t\t<button\n\t\t\tref="menu-button"\n\t\t\t:class="['channel-menu-btn', 'ui-btn ui-btn-round', ButtonSize.EXTRA_SMALL, ButtonColor.SECONDARY]"\n\t\t\ttype="button"\n\t\t\t@click="openMenu"\n\t\t>\n\t\t\t{{ channel }}\n\t\t</button>\n\t`};const It={name:"ResourceNotificationChooseTemplatePopup",emits:["close","templateTypeSelected"],props:{bindElement:{type:HTMLElement,required:true},model:{type:Object,required:true},currentChannel:{type:String,required:true},currentTemplateType:{type:String,required:true},buttonSize:{type:String,default:z.ButtonSize.EXTRA_SMALL},buttonColors:{type:Object,default:()=>({selected:z.ButtonColor.BASE_LIGHT,default:z.ButtonColor.PRIMARY})}},data(){return{IconSet:E.Set,messenger:M.NotificationChannel.WhatsApp,selectedTemplateType:this.currentTemplateType}},components:{Popup:w.Popup,ChannelMenu:Nt,Icon:E.BIcon},beforeMount(){this.messenger=this.currentChannel},mounted(){this.adjustPosition();N.Event.bind(document,"scroll",this.adjustPosition,{capture:true})},beforeUnmount(){N.Event.unbind(document,"scroll",this.adjustPosition,{capture:true})},computed:{...L.mapGetters({templateTypes:`${M.Model.Dictionary}/getNotificationTemplates`}),popupId(){return`booking-resource-wizard-choose-template-popup-${N.Text.getRandom(4)}`},config(){var t,e;return{className:"booking-resource-wizard-choose-template-popup",bindElement:this.bindElement,bindOptions:{forceBindPosition:true,forceTop:true},width:350,offsetLeft:((t=(e=this.bindElement.childNodes[0])==null?void 0:e.offsetWidth)!=null?t:146)+10,offsetTop:-149,animation:"fading-slide",angle:{offset:120,position:"left"},angleBorderRadius:"4px 0",padding:15,targetContainer:document.querySelector("div.resource-creation-wizard__wrapper")}},getFormattedTime(){return g.DateTimeFormat.format(g.DateTimeFormat.getFormat("SHORT_TIME_FORMAT"),Date.now()/1e3)}},methods:{getMessageTemplate(t,e){const i=this.model.templates.find((t=>t.type===e));if(!i){return""}switch(t){case M.NotificationChannel.WhatsApp:return i.text;case M.NotificationChannel.Sms:return i.textSms;default:return""}},handleChannelChange(t){this.messenger=t},chooseType(t){this.selectedTemplateType=t;this.$emit("templateTypeSelected",this.selectedTemplateType)},adjustPosition(){this.$refs.popup.adjustPosition({forceBindPosition:true,forceTop:true})},getButtonText(t){return this.selectedTemplateType===t?this.loc("BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_BTN_SELECTED"):this.loc("BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_BTN_SELECT_TYPE")},getButtonColor(t){return this.selectedTemplateType===t?this.buttonColors.selected:this.buttonColors.default},getTemplateTitle(t){const e=Object.values(this.templateTypes).find((e=>e.value===t));return e?e.name:""}},template:`\n\t\t<Popup\n\t\t\tv-slot="{freeze, unfreeze}"\n\t\t\t:id="popupId"\n\t\t\t:config="config"\n\t\t\tref="popup"\n\t\t\t@close="$emit('close')"\n\t\t>\n\t\t\t<div class="booking-resource-wizard-choose-template-popup">\n\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-header">\n\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-header-title">\n\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_HEADER_TITLE') }}\n\t\t\t\t\t\t<ChannelMenu\n\t\t\t\t\t\t\t:current-channel="messenger"\n\t\t\t\t\t\t\t@popupShown="freeze"\n\t\t\t\t\t\t\t@popupClosed="unfreeze"\n\t\t\t\t\t\t\t@update:value="handleChannelChange"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t:class="['--close-btn']"\n\t\t\t\t\t\t\t:name="IconSet.CROSS_25"\n\t\t\t\t\t\t\t:color="'var(--ui-color-palette-gray-20)'"\n\t\t\t\t\t\t\t@click="$emit('close')"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-header-close-btn"></div>\n\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-header-line"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-container">\n\t\t\t\t\t<div v-for="template in this.model.templates" :key="template.type"\n\t\t\t\t\t\t class="booking-resource-wizard-choose-template-popup-content">\n\t\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-content-desc">\n\t\t\t\t\t\t\t{{ getTemplateTitle(template.type) }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-content-msg-example">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t:class="['booking-resource-wizard-choose-template-popup-content-msg-example-body', messenger]">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t:class="['booking-resource-wizard-choose-template-popup-content-msg-example-body-text', messenger]">\n\t\t\t\t\t\t\t\t\t<div v-html="getMessageTemplate(messenger, template.type)"></div>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t:class="['booking-resource-wizard-choose-template-popup-content-msg-example-body-text-time', messenger]">\n\t\t\t\t\t\t\t\t\t\t{{ getFormattedTime }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t:class="['booking-resource-wizard-choose-template-popup-content-msg-example-body-text-tail', messenger]"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-content-msg-example-actions">\n\t\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\t\t:name="IconSet.CIRCLE_CHECK"\n\t\t\t\t\t\t\t\t\t:color="'var(--ui-color-palette-green-55)'"\n\t\t\t\t\t\t\t\t\t:size="24"\n\t\t\t\t\t\t\t\t\tv-if="selectedTemplateType === template.type"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t:class="['ui-btn ui-btn-round', buttonSize, getButtonColor(template.type), {'--selected': selectedTemplateType === template.type}]"\n\t\t\t\t\t\t\t\t\ttype="button"\n\t\t\t\t\t\t\t\t\t@click="chooseType(template.type)"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{ getButtonText(template.type) }}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`};const Et={methods:{getLabel(t,e,i=""){const o=e?"ui-label ui-label-tag-secondary notification-label --active":"ui-label ui-label-tag-light ui-label-fill notification-label";return`\n\t\t\t\t<div data-hint="${i}" data-hint-no-icon class="${o}">\n\t\t\t\t\t<div class="ui-label-status"></div>\n\t\t\t\t\t<span class="ui-label-inner">${t}</span>\n\t\t\t\t</div>\n\t\t\t`}}};const Ot={methods:{getMessageTemplate(t){var e,i;switch(t){case M.NotificationChannel.WhatsApp:return((e=this.template)==null?void 0:e.text)||"";case M.NotificationChannel.Sms:return((i=this.template)==null?void 0:i.textSms)||"";default:return""}}},mounted(){if(!this.resource.id){this.updateResource({isConfirmationNotificationOn:this.resourceType.isConfirmationNotificationOn,isFeedbackNotificationOn:this.resourceType.isFeedbackNotificationOn,isInfoNotificationOn:this.resourceType.isInfoNotificationOn,isDelayedNotificationOn:this.resourceType.isDelayedNotificationOn,isReminderNotificationOn:this.resourceType.isReminderNotificationOn,templateTypeConfirmation:this.resourceType.templateTypeConfirmation,templateTypeFeedback:this.resourceType.templateTypeFeedback,templateTypeInfo:this.resourceType.templateTypeInfo,templateTypeDelayed:this.resourceType.templateTypeDelayed,templateTypeReminder:this.resourceType.templateTypeReminder})}},computed:{isCheckedForAll:{get(){return this.isCheckedForAllLocal},set(t){this.isCheckedForAllLocal=t;this.updateResourceType()}}}};const Bt={name:"ResourceNotification",emits:["update:checked"],directives:{hint:I.hint},props:{title:{type:String,required:true},view:{type:String,required:true},checked:{type:Boolean,default:false},hideSwitcher:{type:Boolean,default:false},disableSwitcher:{type:Boolean,default:false}},data(){return{IconSet:E.Set,messenger:M.NotificationChannel.WhatsApp}},components:{UiSwitcher:A.Switcher,ChannelMenu:Nt,Icon:E.BIcon},created(){this.hintManager=BX.UI.Hint.createInstance({id:this.containerId,popupParameters:{targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")}})},mounted(){this.hintManager.init(this.$el)},updated(){this.hintManager.init(this.$el)},computed:{containerId(){return`brwc-resource-notification-container-${N.Text.getRandom(5)}`},templateHeader(){return this.loc("BRCW_NOTIFICATION_CARD_MESSAGE_TEXT")},soonHint(){return{text:this.loc("BRCW_BOOKING_SOON_HINT"),popupOptions:{offsetLeft:60,targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")}}}},methods:{handleChannelChange(t){this.messenger=t},handleTemplateTypeSelected(t){void this.$store.dispatch(`${Model.ResourceCreationWizard}/updateResource`,{[this.templateTypeField]:t})},getChooseTemplateButton(){return this.$refs.chooseTemplateBtn||null}},template:`\n\t\t<div class="ui-form resource-creation-wizard__form-notification">\n\t\t\t<div class="resource-creation-wizard__form-notification-info">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-info-title-row">\n\t\t\t\t\t<Icon :name="IconSet.CHAT_LINE" :class="{'--disabled': !checked}"/>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-title"\n\t\t\t\t\t\t:class="{'--disabled': !checked}"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if="!hideSwitcher"\n\t\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-switcher"\n\t\t\t\t\t>\n\t\t\t\t\t\t<UiSwitcher\n\t\t\t\t\t\t\t:data-id="'brcw-resource-notification-info-switcher-' + view"\n\t\t\t\t\t\t\t:model-value="checked"\n\t\t\t\t\t\t\t:disabled="disableSwitcher"\n\t\t\t\t\t\t\t@update:model-value="$emit('update:checked', $event)"\n\t\t\t\t\t\t\tv-hint="disableSwitcher && soonHint"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="resource-creation-wizard__form-notification-info-text-row">\n\t\t\t\t\t<div class="resource-creation-wizard__form-notification__info-text-row-message-text">\n\t\t\t\t\t\t{{ templateHeader }}\n\t\t\t\t\t\t<ChannelMenu\n\t\t\t\t\t\t\t:current-channel="messenger"\n\t\t\t\t\t\t\t@update:value="handleChannelChange"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<slot name="notification-template" :messenger="messenger"/>\n\t\t\t</div>\n\t\t\t<slot/>\n\t\t</div>\n\t`};const At={name:"ResourceNotificationTextRow",props:{icon:{type:String,required:true}},template:`\n\t\t<div class="resource-creation-wizard__form-notification-text-row">\n\t\t\t<div :class="[icon, 'ui-icon-set', 'resource-creation-wizard__form-notification-text-row-icon']"></div>\n\t\t\t<slot />\n\t\t</div>\n\t`};const kt={name:"ResourceNotificationCheckBoxRow",emits:["update:checked"],props:{checked:{type:Boolean,required:true},disabled:{type:Boolean,required:false,default:false}},template:`\n\t\t<div class="resource-creation-wizard__form-notification-text-row">\n\t\t\t<div :class="['resource-creation-wizard__form-notification-text-row-checkbox']">\n\t\t\t\t<input\n\t\t\t\t\ttype="checkbox"\n\t\t\t\t\t:disabled="disabled"\n\t\t\t\t\t:checked="checked"\n\t\t\t\t\t@input="$emit('update:checked', $event.target.checked)"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<slot />\n\t\t</div>\n\t`};const Lt={template:`\n\t\t<div class="booking-resource-creation-wizard-message-template-empty">\n\t\t\t<div class="booking-resource-creation-wizard-message-template-empty-icon"></div>\n\t\t\t<div class="booking-resource-creation-wizard-message-template-empty-text">\n\t\t\t\t{{ loc('BRCW_MESSAGE_TEMPLATE_SOON_TEXT') }}\n\t\t\t</div>\n\t\t</div>\n\t`};const Dt={name:"ResourceNotificationCardBaseInfo",props:{model:{type:Object,required:true},resourceType:{type:Object,required:true}},mixins:[Et,Ot],components:{ResourceNotification:Bt,ResourceNotificationTextRow:At,ResourceNotificationCheckBoxRow:kt,ChooseTemplatePopup:It,Button:z.Button,TemplateEmpty:Lt},data(){return{ButtonSize:z.ButtonSize,ButtonColor:z.ButtonColor,isCheckedForAllLocal:true,originalValue:this.resourceType.isInfoNotificationOn,originalTemplateType:this.resourceType.templateTypeInfo,showTemplatePopup:false}},mounted(){if(S.ahaMoments.shouldShow(M.AhaMoment.MessageTemplate)){setTimeout((()=>this.showAhaMoment()),500)}if(!this.template){console.warn("Notification template not found");this.isInfoNotificationOn=false}},methods:{...L.mapMutations(M.Model.ResourceCreationWizard,["updateResource"]),updateResourceType(){const t=this.isCheckedForAll?this.isInfoNotificationOn:this.originalValue;const e=this.isCheckedForAll?this.resource.templateTypeInfo:this.originalTemplateType;const i=this.resourceType;this.$store.dispatch("resourceTypes/upsert",{...i,isInfoNotificationOn:t,templateTypeInfo:e})},chooseTemplate(){this.showTemplatePopup=true},handleTemplateTypeSelected(t){this.updateResource({templateTypeInfo:t});this.updateResourceType()},async showAhaMoment(){await S.ahaMoments.showGuide({id:"booking-message-template",title:this.loc("BOOKING_AHA_MESSAGE_TEMPLATE_TITLE"),text:this.loc("BOOKING_AHA_MESSAGE_TEMPLATE_TEXT"),article:M.HelpDesk.AhaMessageTemplate,target:this.$refs.chooseTemplateButton.$el,targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")});S.ahaMoments.setShown(M.AhaMoment.MessageTemplate)},showHelpDesk(){P.helpDesk.show(M.HelpDesk.ResourceNotificationInfo.code,M.HelpDesk.ResourceNotificationInfo.anchorCode)}},computed:{...L.mapGetters({resource:`${M.Model.ResourceCreationWizard}/getResource`,isCurrentSenderAvailable:`${M.Model.Notifications}/isCurrentSenderAvailable`}),isInfoNotificationOn:{get(){return this.isCurrentSenderAvailable&&this.resource.isInfoNotificationOn},set(t){this.updateResource({isInfoNotificationOn:t});this.updateResourceType()}},resourceNotificationTitle(){return this.loc("BRCW_NOTIFICATION_CARD_BASE_INFO_TITLE")},template(){return this.model.templates.find((t=>t.type===this.resource.templateTypeInfo))},locInfoTimeSend(){const t=this.loc("BRCW_BOOKING_SOON_HINT");const e=this.loc("BRCW_NOTIFICATION_CARD_LABEL_IMMEDIATELY");const i={"#time#":this.getLabel(e,this.isInfoNotificationOn,t)};return this.loc("BRCW_NOTIFICATION_CARD_BASE_INFO_HELPER_TEXT_SECOND",i)},helpDesk(){return M.HelpDesk.ResourceNotificationInfo}},methods:{async showAhaMoment(){const t=this.$refs.card.getChooseTemplateButton();if(N.Type.isNull(t)){return}await S.ahaMoments.showGuide({id:"booking-message-template",title:this.loc("BOOKING_AHA_MESSAGE_TEMPLATE_TITLE"),text:this.loc("BOOKING_AHA_MESSAGE_TEMPLATE_TEXT"),article:M.HelpDesk.AhaMessageTemplate,target:this.$refs.card.getChooseTemplateButton(),targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")});S.ahaMoments.setShown(M.AhaMoment.MessageTemplate)}},template:`\n\t\t<ResourceNotification\n\t\t\tv-model:checked="isInfoNotificationOn"\n\t\t\t:view="'base-info'"\n\t\t\t:title="resourceNotificationTitle"\n\t\t\t:disableSwitcher="!isCurrentSenderAvailable || !template"\n\t\t>\n\t\t\t<template #notification-template="{ messenger }">\n\t\t\t\t<div\n\t\t\t\t\tv-if="isCurrentSenderAvailable"\n\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-template"\n\t\t\t\t\tv-html="getMessageTemplate(messenger)"\n\t\t\t\t></div>\n\t\t\t\t<TemplateEmpty v-else/>\n\t\t\t\t<div\n\t\t\t\t\tv-if="isCurrentSenderAvailable"\n\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-template-choose-buttons"\n\t\t\t\t>\n\t\t\t\t\t<div ref="chooseTemplateBtn">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tref="chooseTemplateButton"\n\t\t\t\t\t\t\t:disabled="!isInfoNotificationOn"\n\t\t\t\t\t\t\t:text="loc('BRCW_NOTIFICATION_CARD_CHOOSE_TEMPLATE_TYPE')"\n\t\t\t\t\t\t\t:size="ButtonSize.EXTRA_SMALL"\n\t\t\t\t\t\t\t:color="ButtonColor.LIGHT_BORDER"\n\t\t\t\t\t\t\t:round="true"\n\t\t\t\t\t\t\t@click="chooseTemplate"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ChooseTemplatePopup\n\t\t\t\t\tv-if="showTemplatePopup"\n\t\t\t\t\t:bindElement="$refs.chooseTemplateBtn"\n\t\t\t\t\t:model="model"\n\t\t\t\t\t:current-channel="messenger"\n\t\t\t\t\t:currentTemplateType="resource.templateTypeInfo"\n\t\t\t\t\t@templateTypeSelected="handleTemplateTypeSelected"\n\t\t\t\t\t@close="showTemplatePopup = false"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<ResourceNotificationTextRow icon="--info-1">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_BASE_INFO_HELPER_TEXT_FIRST') }}\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="resource-creation-wizard__form-notification-text --more"\n\t\t\t\t\t\t\t@click="showHelpDesk"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_MORE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</ResourceNotificationTextRow>\n\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text" v-html="locInfoTimeSend"></div>\n\t\t\t</ResourceNotificationTextRow>\n\t\t\t<ResourceNotificationCheckBoxRow \n\t\t\t\tv-model:checked="isCheckedForAll"\n\t\t\t\t:disabled="!isInfoNotificationOn"\n\t\t\t>\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_HELPER_TEXT_APPLY_FOR_ALL') }}\n\t\t\t\t</div>\n\t\t\t</ResourceNotificationCheckBoxRow>\n\t\t</ResourceNotification>\n\t`};const zt={name:"ResourceNotificationCardConfirmation",mixins:[Et,Ot],props:{model:{type:Object,required:true},resourceType:{type:Object,required:true}},data(){return{ButtonSize:z.ButtonSize,ButtonColor:z.ButtonColor,isCheckedForAllLocal:true,originalValue:this.resourceType.isConfirmationNotificationOn,originalTemplateType:this.resourceType.templateTypeConfirmation,showTemplatePopup:false}},computed:{...L.mapGetters({resource:`${M.Model.ResourceCreationWizard}/getResource`,isCurrentSenderAvailable:`${M.Model.Notifications}/isCurrentSenderAvailable`}),isConfirmationNotificationOn:{get(){return this.isCurrentSenderAvailable&&this.resource.isConfirmationNotificationOn},set(t){this.updateResource({isConfirmationNotificationOn:t});this.updateResourceType()}},locSendMessageBefore(){const t=this.loc("BRCW_BOOKING_SOON_HINT");const e=this.loc("BRCW_NOTIFICATION_CARD_LABEL_DAYS_BEFORE");const i={"#days_before#":this.getLabel(e,this.isConfirmationNotificationOn,t)};return this.loc("BRCW_NOTIFICATION_CARD_CONFIRMATION_HELPER_TEXT_SECOND",i)},locRetryMessage(){const t=this.loc("BRCW_BOOKING_SOON_HINT");const e=this.loc("BRCW_NOTIFICATION_CARD_LABEL_TIMES");const i=this.loc("BRCW_NOTIFICATION_CARD_LABEL_TIME_DELAY");const o={"#times#":this.getLabel(e,this.isConfirmationNotificationOn,t),"#time_delay#":this.getLabel(i,this.isConfirmationNotificationOn,t)};return this.loc("BRCW_NOTIFICATION_CARD_CONFIRMATION_HELPER_TEXT_THIRD",o)},template(){return this.model.templates.find((t=>t.type===this.resource.templateTypeConfirmation))}},methods:{...L.mapMutations("resource-creation-wizard",["updateResource"]),updateResourceType(){const t=this.isCheckedForAll?this.isConfirmationNotificationOn:this.originalValue;const e=this.isCheckedForAll?this.resource.templateTypeConfirmation:this.originalTemplateType;const i=this.resourceType;this.$store.dispatch("resourceTypes/upsert",{...i,isConfirmationNotificationOn:t,templateTypeConfirmation:e})},chooseTemplate(){this.showTemplatePopup=true},handleTemplateTypeSelected(t){this.updateResource({templateTypeConfirmation:t});this.updateResourceType()},showHelpDesk(){P.helpDesk.show(M.HelpDesk.ResourceNotificationConfirmation.code,M.HelpDesk.ResourceNotificationConfirmation.anchorCode)}},mounted(){if(!this.template){console.warn("Notification template not found");this.isConfirmationNotificationOn=false}},components:{ResourceNotification:Bt,ResourceNotificationTextRow:At,ResourceNotificationCheckBoxRow:kt,ChooseTemplatePopup:It,Button:z.Button,TemplateEmpty:Lt},template:`\n\t\t<ResourceNotification \n\t\t\tv-model:checked="isConfirmationNotificationOn"\n\t\t\t:view="'confirmation'"\n\t\t\t:title="loc('BRCW_NOTIFICATION_CARD_CONFIRMATION_TITLE')"\n\t\t\t:disableSwitcher="!isCurrentSenderAvailable || !template"\n\t\t>\n\t\t\t<template #notification-template="{ messenger }">\n\t\t\t\t<div\n\t\t\t\t\tv-if="isCurrentSenderAvailable"\n\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-template"\n\t\t\t\t\tv-html="getMessageTemplate(messenger)"\n\t\t\t\t></div>\n\t\t\t\t<TemplateEmpty v-else/>\n\t\t\t\t<div\n\t\t\t\t\tv-if="isCurrentSenderAvailable"\n\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-template-choose-buttons"\n\t\t\t\t>\n\t\t\t\t\t<div ref="chooseTemplateBtn">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t:disabled="!isConfirmationNotificationOn"\n\t\t\t\t\t\t\t:text="loc('BRCW_NOTIFICATION_CARD_CHOOSE_TEMPLATE_TYPE')"\n\t\t\t\t\t\t\t:size="ButtonSize.EXTRA_SMALL"\n\t\t\t\t\t\t\t:color="ButtonColor.LIGHT_BORDER"\n\t\t\t\t\t\t\t:round="true"\n\t\t\t\t\t\t\t@click="chooseTemplate"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ChooseTemplatePopup\n\t\t\t\t\tv-if="showTemplatePopup"\n\t\t\t\t\t:bindElement="$refs.chooseTemplateBtn"\n\t\t\t\t\t:model="model"\n\t\t\t\t\t:current-channel="messenger"\n\t\t\t\t\t:currentTemplateType="resource.templateTypeConfirmation"\n\t\t\t\t\t@templateTypeSelected="handleTemplateTypeSelected"\n\t\t\t\t\t@close="showTemplatePopup = false"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<ResourceNotificationTextRow icon="--info-1">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_CONFIRMATION_HELPER_TEXT_FIRST') }}\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="resource-creation-wizard__form-notification-text --more"\n\t\t\t\t\t\t\t@click="showHelpDesk"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_MORE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</ResourceNotificationTextRow>\n\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text" v-html="locSendMessageBefore"></div>\n\t\t\t</ResourceNotificationTextRow>\n\t\t\t<ResourceNotificationTextRow icon="--undo-1">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text" v-html="locRetryMessage"></div>\n\t\t\t</ResourceNotificationTextRow>\n\t\t\t<ResourceNotificationCheckBoxRow \n\t\t\t\tv-model:checked="isCheckedForAll"\n\t\t\t\t:disabled="!isConfirmationNotificationOn"\n\t\t\t>\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_HELPER_TEXT_APPLY_FOR_ALL') }}\n\t\t\t\t</div>\n\t\t\t</ResourceNotificationCheckBoxRow>\n\t\t</ResourceNotification>\n\t`};const Mt={name:"ResourceNotificationCardReminder",mixins:[Et,Ot],props:{model:{type:Object,required:true},resourceType:{type:Object,required:true}},data(){return{ButtonSize:z.ButtonSize,ButtonColor:z.ButtonColor,isCheckedForAllLocal:true,originalValue:this.resourceType.isReminderNotificationOn,originalTemplateType:this.resourceType.templateTypeReminder,showTemplatePopup:false}},computed:{...L.mapGetters({resource:`${M.Model.ResourceCreationWizard}/getResource`,isCurrentSenderAvailable:`${M.Model.Notifications}/isCurrentSenderAvailable`}),isReminderNotificationOn:{get(){return this.isCurrentSenderAvailable&&this.resource.isReminderNotificationOn},set(t){this.updateResource({isReminderNotificationOn:t});this.updateResourceType()}},locSendReminderTime(){const t=this.loc("BRCW_BOOKING_SOON_HINT");const e=this.loc("BRCW_NOTIFICATION_CARD_LABEL_CHOOSE_TIME");const i={"#time#":this.getLabel(e,this.isReminderNotificationOn,t)};return this.loc("BRCW_NOTIFICATION_CARD_REMINDER_HELPER_TEXT_SECOND",i)},template(){return this.model.templates.find((t=>t.type===this.resource.templateTypeReminder))}},methods:{...L.mapMutations("resource-creation-wizard",["updateResource"]),updateResourceType(){const t=this.isCheckedForAll?this.isReminderNotificationOn:this.originalValue;const e=this.isCheckedForAll?this.resource.templateTypeReminder:this.originalTemplateType;const i=this.resourceType;this.$store.dispatch("resourceTypes/upsert",{...i,isReminderNotificationOn:t,templateTypeReminder:e})},chooseTemplate(){this.showTemplatePopup=true},handleTemplateTypeSelected(t){this.updateResource({templateTypeReminder:t});this.updateResourceType()},showHelpDesk(){P.helpDesk.show(M.HelpDesk.ResourceNotificationReminder.code,M.HelpDesk.ResourceNotificationReminder.anchorCode)}},mounted(){if(!this.template){console.warn("Notification template not found");this.isReminderNotificationOn=false}},components:{ResourceNotification:Bt,ResourceNotificationTextRow:At,ResourceNotificationCheckBoxRow:kt,ChooseTemplatePopup:It,Button:z.Button,TemplateEmpty:Lt},template:`\n\t\t<ResourceNotification\n\t\t\tv-model:checked="isReminderNotificationOn"\n\t\t\t:view="'reminder'"\n\t\t\t:title="loc('BRCW_NOTIFICATION_CARD_REMINDER_TITLE')"\n\t\t\t:disableSwitcher="!isCurrentSenderAvailable || !template"\n\t\t>\n\t\t\t<template #notification-template="{ messenger }">\n\t\t\t\t<div\n\t\t\t\t\tv-if="isCurrentSenderAvailable"\n\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-template"\n\t\t\t\t\tv-html="getMessageTemplate(messenger)"\n\t\t\t\t></div>\n\t\t\t\t<TemplateEmpty v-else/>\n\t\t\t\t<div\n\t\t\t\t\tv-if="isCurrentSenderAvailable && model.templates.length > 1"\n\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-template-choose-buttons"\n\t\t\t\t>\n\t\t\t\t\t<div ref="chooseTemplateBtn">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t:disabled="!isReminderNotificationOn"\n\t\t\t\t\t\t\t:text="loc('BRCW_NOTIFICATION_CARD_CHOOSE_TEMPLATE_TYPE')"\n\t\t\t\t\t\t\t:size="ButtonSize.EXTRA_SMALL"\n\t\t\t\t\t\t\t:color="ButtonColor.LIGHT_BORDER"\n\t\t\t\t\t\t\t:round="true"\n\t\t\t\t\t\t\t@click="chooseTemplate"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ChooseTemplatePopup\n\t\t\t\t\tv-if="showTemplatePopup"\n\t\t\t\t\t:bindElement="$refs.chooseTemplateBtn"\n\t\t\t\t\t:model="model"\n\t\t\t\t\t:current-channel="messenger"\n\t\t\t\t\t:currentTemplateType="resource.templateTypeReminder"\n\t\t\t\t\t@templateTypeSelected="handleTemplateTypeSelected"\n\t\t\t\t\t@close="showTemplatePopup = false"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<ResourceNotificationTextRow icon="--info-1">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_REMINDER_HELPER_TEXT_FIRST') }}\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="resource-creation-wizard__form-notification-text --more"\n\t\t\t\t\t\t\t@click="showHelpDesk"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_MORE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</ResourceNotificationTextRow>\n\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text" v-html="locSendReminderTime"></div>\n\t\t\t</ResourceNotificationTextRow>\n\t\t\t<ResourceNotificationCheckBoxRow\n\t\t\t\tv-model:checked="isCheckedForAll"\n\t\t\t\t:disabled="!isReminderNotificationOn"\n\t\t\t>\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_HELPER_TEXT_APPLY_FOR_ALL') }}\n\t\t\t\t</div>\n\t\t\t</ResourceNotificationCheckBoxRow>\n\t\t</ResourceNotification>\n\t`};const Pt={name:"ResourceNotificationCardFeedback",mixins:[Et,Ot],props:{model:{type:Object,required:true},resourceType:{type:Object,required:true}},components:{ResourceNotification:Bt,ResourceNotificationTextRow:At,ResourceNotificationCheckBoxRow:kt,ChooseTemplatePopup:It,Button:z.Button,TemplateEmpty:Lt},data(){return{ButtonSize:z.ButtonSize,ButtonColor:z.ButtonColor,isCheckedForAllLocal:true,originalValue:this.resourceType.isFeedbackNotificationOn,originalTemplateType:this.resourceType.templateTypeFeedback,showTemplatePopup:false}},methods:{...L.mapMutations("resource-creation-wizard",["updateResource"]),updateResourceType(){const t=this.isCheckedForAll?this.isFeedbackNotificationOn:this.originalValue;const e=this.isCheckedForAll?this.resource.templateTypeFeedback:this.originalTemplateType;const i=this.resourceType;this.$store.dispatch("resourceTypes/upsert",{...i,isFeedbackNotificationOn:t,templateTypeFeedback:e})},chooseTemplate(){this.showTemplatePopup=true},handleTemplateTypeSelected(t){this.updateResource({templateTypeFeedback:t});this.updateResourceType()},showHelpDesk(){P.helpDesk.show(M.HelpDesk.ResourceNotificationFeedback.code,M.HelpDesk.ResourceNotificationFeedback.anchorCode)}},computed:{...L.mapGetters({resource:`${M.Model.ResourceCreationWizard}/getResource`,isCurrentSenderAvailable:`${M.Model.Notifications}/isCurrentSenderAvailable`}),isFeedbackNotificationOn:{get(){return false},set(t){this.updateResource({isFeedbackNotificationOn:t});this.updateResourceType()}},locSendFeedbackTime(){const t=this.loc("BRCW_BOOKING_SOON_HINT");const e=this.loc("BRCW_NOTIFICATION_CARD_LABEL_IMMEDIATELY");const i={"#time#":this.getLabel(e,this.isFeedbackNotificationOn,t)};return this.loc("BRCW_NOTIFICATION_CARD_FEEDBACK_HELPER_TEXT_SECOND",i)},template(){return this.model.templates.find((t=>t.type===this.resource.templateTypeFeedback))}},template:`\n\t\t<ResourceNotification\n\t\t\tv-model:checked="isFeedbackNotificationOn"\n\t\t\t:view="'feedback'"\n\t\t\t:disableSwitcher="true"\n\t\t\t:title="loc('BRCW_NOTIFICATION_CARD_FEEDBACK_TITLE')"\n\t\t>\n\t\t\t<template #notification-template="{ messenger }">\n\t\t\t\t<div\n\t\t\t\t\tv-if="isCurrentSenderAvailable"\n\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-template"\n\t\t\t\t\tv-html="getMessageTemplate(messenger)"\n\t\t\t\t></div>\n\t\t\t\t<TemplateEmpty v-else/>\n\t\t\t\t<div\n\t\t\t\t\tv-if="isCurrentSenderAvailable"\n\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-template-choose-buttons"\n\t\t\t\t>\n\t\t\t\t\t<div ref="chooseTemplateBtn">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t:disabled="!isFeedbackNotificationOn"\n\t\t\t\t\t\t\t:text="loc('BRCW_NOTIFICATION_CARD_CHOOSE_TEMPLATE_TYPE')"\n\t\t\t\t\t\t\t:size="ButtonSize.EXTRA_SMALL"\n\t\t\t\t\t\t\t:color="ButtonColor.LIGHT_BORDER"\n\t\t\t\t\t\t\t:round="true"\n\t\t\t\t\t\t\t@click="chooseTemplate"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ChooseTemplatePopup\n\t\t\t\t\tv-if="showTemplatePopup"\n\t\t\t\t\t:bindElement="$refs.chooseTemplateBtn"\n\t\t\t\t\t:model="model"\n\t\t\t\t\t:current-channel="messenger"\n\t\t\t\t\t:currentTemplateType="resource.templateTypeFeedback"\n\t\t\t\t\t@templateTypeSelected="handleTemplateTypeSelected"\n\t\t\t\t\t@close="showTemplatePopup = false"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<ResourceNotificationTextRow icon="--info-1">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_FEEDBACK_HELPER_TEXT_FIRST') }}\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="resource-creation-wizard__form-notification-text --more"\n\t\t\t\t\t\t\t@click="showHelpDesk"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_MORE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</ResourceNotificationTextRow>\n\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text" v-html="locSendFeedbackTime"></div>\n\t\t\t</ResourceNotificationTextRow>\n\t\t\t<ResourceNotificationCheckBoxRow \n\t\t\t\tv-model:checked="isCheckedForAll"\n\t\t\t\t:disabled="!isFeedbackNotificationOn"\n\t\t\t>\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_HELPER_TEXT_APPLY_FOR_ALL') }}\n\t\t\t\t</div>\n\t\t\t</ResourceNotificationCheckBoxRow>\n\t\t</ResourceNotification>\n\t`};const xt={name:"ResourceNotificationCardLate",props:{model:{type:Object,required:true},resourceType:{type:Object,required:true}},mixins:[Et,Ot],data(){return{ButtonSize:z.ButtonSize,ButtonColor:z.ButtonColor,isCheckedForAllLocal:true,originalValue:this.resourceType.isDelayedNotificationOn,originalTemplateType:this.resourceType.templateTypeDelayed,showTemplatePopup:false}},computed:{...L.mapGetters({resource:`${M.Model.ResourceCreationWizard}/getResource`,isCurrentSenderAvailable:`${M.Model.Notifications}/isCurrentSenderAvailable`}),isDelayedNotificationOn:{get(){return this.isCurrentSenderAvailable&&this.resource.isDelayedNotificationOn},set(t){this.updateResource({isDelayedNotificationOn:t});this.updateResourceType()}},resourceNotificationTitle(){return this.loc("BRCW_NOTIFICATION_CARD_LATE_TITLE")},template(){return this.model.templates.find((t=>t.type===this.resource.templateTypeDelayed))},locSendMessageAfter(){const t=this.loc("BRCW_BOOKING_SOON_HINT");const e=this.loc("BRCW_NOTIFICATION_CARD_LABEL_TIME_AFTER_MINUTES");const i={"#time#":this.getLabel(e,this.isDelayedNotificationOn,t)};return this.loc("BRCW_NOTIFICATION_CARD_LATE_HELPER_TEXT_SECOND",i)}},methods:{...L.mapMutations("resource-creation-wizard",["updateResource"]),updateResourceType(){const t=this.isCheckedForAll?this.isDelayedNotificationOn:this.originalValue;const e=this.isCheckedForAll?this.resource.templateTypeDelayed:this.originalTemplateType;const i=this.resourceType;this.$store.dispatch("resourceTypes/upsert",{...i,isDelayedNotificationOn:t,templateTypeDelayed:e})},chooseTemplate(){this.showTemplatePopup=true},handleTemplateTypeSelected(t){this.updateResource({templateTypeDelayed:t});this.updateResourceType()},showHelpDesk(){P.helpDesk.show(M.HelpDesk.ResourceNotificationLate.code,M.HelpDesk.ResourceNotificationLate.anchorCode)}},mounted(){if(!this.template){console.warn("Notification template not found");this.isDelayedNotificationOn=false}},components:{ResourceNotification:Bt,ResourceNotificationTextRow:At,ResourceNotificationCheckBoxRow:kt,ChooseTemplatePopup:It,Button:z.Button,TemplateEmpty:Lt},template:`\n\t\t<ResourceNotification\n\t\t\tv-model:checked="isDelayedNotificationOn"\n\t\t\t:view="'late'"\n\t\t\t:title="resourceNotificationTitle"\n\t\t\t:disableSwitcher="!isCurrentSenderAvailable || !template"\n\t\t>\n\t\t\t<template #notification-template="{ messenger }">\n\t\t\t\t<div\n\t\t\t\t\tv-if="isCurrentSenderAvailable"\n\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-template"\n\t\t\t\t\tv-html="getMessageTemplate(messenger)"\n\t\t\t\t></div>\n\t\t\t\t<TemplateEmpty v-else/>\n\t\t\t\t<div\n\t\t\t\t\tv-if="isCurrentSenderAvailable"\n\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-template-choose-buttons"\n\t\t\t\t>\n\t\t\t\t\t<div ref="chooseTemplateBtn">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t:disabled="!isDelayedNotificationOn"\n\t\t\t\t\t\t\t:text="loc('BRCW_NOTIFICATION_CARD_CHOOSE_TEMPLATE_TYPE')"\n\t\t\t\t\t\t\t:size="ButtonSize.EXTRA_SMALL"\n\t\t\t\t\t\t\t:color="ButtonColor.LIGHT_BORDER"\n\t\t\t\t\t\t\t:round="true"\n\t\t\t\t\t\t\t@click="chooseTemplate"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ChooseTemplatePopup\n\t\t\t\t\tv-if="showTemplatePopup"\n\t\t\t\t\t:bindElement="$refs.chooseTemplateBtn"\n\t\t\t\t\t:model="model"\n\t\t\t\t\t:current-channel="messenger"\n\t\t\t\t\t:currentTemplateType="resource.templateTypeDelayed"\n\t\t\t\t\t@templateTypeSelected="handleTemplateTypeSelected"\n\t\t\t\t\t@close="showTemplatePopup = false"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<ResourceNotificationTextRow icon="--info-1">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_LATE_HELPER_TEXT_FIRST') }}\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="resource-creation-wizard__form-notification-text --more"\n\t\t\t\t\t\t\t@click="showHelpDesk"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_MORE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</ResourceNotificationTextRow>\n\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text" v-html="locSendMessageAfter"></div>\n\t\t\t</ResourceNotificationTextRow>\n\t\t\t<ResourceNotificationCheckBoxRow\n\t\t\t\tv-model:checked="isCheckedForAll"\n\t\t\t\t:disabled="!isDelayedNotificationOn"\n\t\t\t>\n\t\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_HELPER_TEXT_APPLY_FOR_ALL') }}\n\t\t\t\t</div>\n\t\t\t</ResourceNotificationCheckBoxRow>\n\t\t</ResourceNotification>\n\t`};const Wt={name:"ResourceNotificationCard",components:{BaseInfo:Dt,Confirmation:zt,Reminder:Mt,Late:xt,Feedback:Pt},methods:{...L.mapMutations("resource-creation-wizard",["updateResource"])},computed:{notificationViews(){return this.notifications.map((t=>{switch(t.type){case this.dictionary.Info.value:return{view:"BaseInfo",model:t};case this.dictionary.Confirmation.value:return{view:"Confirmation",model:t};case this.dictionary.Reminder.value:return{view:"Reminder",model:t};case this.dictionary.Delayed.value:return{view:"Late",model:t};case this.dictionary.Feedback.value:return{view:"Feedback",model:t};default:return""}}))},...L.mapGetters({notifications:`${M.Model.Notifications}/get`,dictionary:`${M.Model.Dictionary}/getNotifications`,resource:`${M.Model.ResourceCreationWizard}/getResource`}),resourceType(){return this.$store.getters["resourceTypes/getById"](this.resource.typeId)}},template:`\n\t\t<div class="resource-notification-card">\n\t\t\t<slot v-for="notification of notificationViews" :key="notification.view">\n\t\t\t\t<component\n\t\t\t\t\t:is="notification.view"\n\t\t\t\t\t:model="notification.model"\n\t\t\t\t\t:resourceType="this.resourceType"\n\t\t\t\t\t:data-id="'brcw-resource-notification-view-' + notification.view"\n\t\t\t\t/>\n\t\t\t</slot>\n\t\t</div>\n\t`};const Ft={name:"ResourceCreationWizardApp",components:{ResourceCreationWizardLayout:W,ResourceCreationWizardHeader:F,ResourceCreationWizardFooter:et,ResourceCategoryCard:ot,ResourceSettingsCard:bt,ResourceNotificationCard:Wt},data(){return{init:true}},computed:{...L.mapState({step:t=>t["resource-creation-wizard"].step,fetching:t=>t["resource-creation-wizard"].fetching}),...L.mapGetters("resource-creation-wizard",["invalidCurrentCard","resourceId"]),currentView(){const t=this.step||1;switch(t){case 2:return"ResourceSettingsCard";case 3:return"ResourceNotificationCard";default:return"ResourceCategoryCard"}},isEditForm(){return this.resourceId!==null}},async beforeMount(){await this.initApp()},methods:{...L.mapActions("resource-creation-wizard",["initState"]),...L.mapMutations("resource-creation-wizard",["prevStep","updateFetching","setGlobalSchedule"]),async initApp(){await this.initState();await this.loadWizardData();this.init=false},async loadWizardData(){try{this.updateFetching(true);await p.resourceCreationWizardService.fetchData()}catch(t){console.error("Loading wizard data error",t)}finally{this.updateFetching(false);if(!this.isEditForm){this.setGlobalSchedule(true)}}}},template:`\n\t\t<div id="booking-resource-creation-wizard">\n\t\t\t<ResourceCreationWizardLayout :loading="fetching" :step>\n\t\t\t\t<template #header>\n\t\t\t\t\t<ResourceCreationWizardHeader/>\n\t\t\t\t</template>\n\t\t\t\t<template v-if="!init">\n\t\t\t\t\t<component :is="currentView"/>\n\t\t\t\t</template>\n\t\t\t\t<template #footer>\n\t\t\t\t\t<ResourceCreationWizardFooter :step/>\n\t\t\t\t</template>\n\t\t\t</ResourceCreationWizardLayout>\n\t\t</div>\n\t`};var Ht=babelHelpers.classPrivateFieldLooseKey("width");var $t=babelHelpers.classPrivateFieldLooseKey("application");var Gt=babelHelpers.classPrivateFieldLooseKey("makeName");var Xt=babelHelpers.classPrivateFieldLooseKey("mountContent");var qt=babelHelpers.classPrivateFieldLooseKey("initCore");var Ut=babelHelpers.classPrivateFieldLooseKey("makeContainer");class Vt{constructor(){Object.defineProperty(this,Ut,{value:Zt});Object.defineProperty(this,qt,{value:Yt});Object.defineProperty(this,Xt,{value:Kt});Object.defineProperty(this,$t,{writable:true,value:null})}open(t=null){s.SidePanelInstance.open(babelHelpers.classPrivateFieldLooseBase(Vt,Gt)[Gt](t),{width:babelHelpers.classPrivateFieldLooseBase(Vt,Ht)[Ht],cacheable:false,events:{onClose:this.closeSidePanel.bind(this)},contentCallback:async()=>{await babelHelpers.classPrivateFieldLooseBase(this,qt)[qt](t);this.subscribe();const e=babelHelpers.classPrivateFieldLooseBase(this,Ut)[Ut]();babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt](e);return e}})}async closeSidePanel(){this.unsubscribe();babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].unmount();babelHelpers.classPrivateFieldLooseBase(this,$t)[$t]=null;await a.Core.removeDynamicModule(M.Model.ResourceCreationWizard);await a.Core.removeDynamicModule(M.Model.Notifications)}subscribe(){N.Event.EventEmitter.subscribe(M.EventName.CloseWizard,this.close)}unsubscribe(){N.Event.EventEmitter.unsubscribe(M.EventName.CloseWizard,this.close)}close(){s.SidePanelInstance.close()}}function jt(t="new"){return`booking:resource-creation-wizard:${t||"new"}`}function Kt(t){const o=e.BitrixVue.createApp(Ft,a.Core.getParams());o.mixin(i.locMixin);o.use(a.Core.getStore());o.mount(t);babelHelpers.classPrivateFieldLooseBase(this,$t)[$t]=o}async function Yt(t){try{await a.Core.init();await a.Core.addDynamicModule(n.ResourceCreationWizardModel.create().setVariables({resourceId:t}));await a.Core.addDynamicModule(o.Notifications.create())}catch(t){console.error("Init Resource creation wizard error",t)}}function Zt(){const t=document.createElement("div");t.id="booking-resource-creation-wizard-app";return t}Object.defineProperty(Vt,Gt,{value:jt});Object.defineProperty(Vt,Ht,{writable:true,value:600});t.ResourceCreationWizard=Vt})(this.BX.Booking=this.BX.Booking||{},BX.Vue3,BX.Booking.Component.Mixin,BX.Booking.Model,BX.Booking.Model,BX.Booking.Lib,BX,BX.Booking,BX.UI.NotificationManager,BX.Booking.Provider.Service,BX.Crm.MessageSender,BX,BX.Booking.Provider.Service,BX.UI.EntitySelector,BX.Booking.Model,BX.Booking.Provider.Service,BX.Event,BX.UI,BX.Booking.Lib,BX,BX.UI,BX,BX.Booking.Lib,BX.Main,BX.Booking.Component,BX.Main,BX,BX.Vue3.Directives,BX.UI.IconSet,BX,BX,BX.Booking.Component,BX.UI,BX.Vue3.Vuex,BX,BX.Booking.Component,BX.Booking.Const,BX.Booking.Lib);
//# sourceMappingURL=resource-creation-wizard.bundle.map.js