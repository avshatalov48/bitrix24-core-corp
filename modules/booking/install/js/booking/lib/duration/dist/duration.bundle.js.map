{"version":3,"file":"duration.bundle.js","sources":["../src/duration.js"],"sourcesContent":["import { DateTimeFormat } from 'main.date';\n\nexport class Duration\n{\n\tconstructor(milliseconds: number)\n\t{\n\t\tthis.milliseconds = Math.abs(milliseconds);\n\t}\n\n\tstatic createFromSeconds(seconds: number): Duration\n\t{\n\t\treturn new Duration(seconds * Duration.getUnitDurations().s);\n\t}\n\n\tstatic createFromMinutes(minutes: number): Duration\n\t{\n\t\treturn new Duration(minutes * Duration.getUnitDurations().i);\n\t}\n\n\tget seconds(): number\n\t{\n\t\treturn Math.floor(this.milliseconds / Duration.getUnitDurations().s);\n\t}\n\n\tget minutes(): number\n\t{\n\t\treturn Math.floor(this.milliseconds / Duration.getUnitDurations().i);\n\t}\n\n\tget hours(): number\n\t{\n\t\treturn Math.floor(this.milliseconds / Duration.getUnitDurations().H);\n\t}\n\n\tget days(): number\n\t{\n\t\treturn Math.floor(this.milliseconds / Duration.getUnitDurations().d);\n\t}\n\n\t/**\n\t * Duration in months (considering that a month is 31 days)\n\t */\n\tget months(): number\n\t{\n\t\treturn Math.floor(this.milliseconds / Duration.getUnitDurations().m);\n\t}\n\n\t/**\n\t * Duration in years (considering that a year is 365 days)\n\t */\n\tget years(): number\n\t{\n\t\treturn Math.floor(this.milliseconds / Duration.getUnitDurations().Y);\n\t}\n\n\t/**\n\t * Available units: `s` - seconds, `i` - minutes, `H` - hours, `d` - days, `m` - months, `Y` - years.\n\t *\n\t * If not pass format string then:\n\t * - Duration will be formatted automatically with 'Y m d H i s'\n\t * @example '1 day 2 hours 20 minutes'\n\t * - Units will be taken with mod:\n\t * @example result will be '1 hour 30 minutes' instead of '1 hour 90 minutes 3600 seconds'\n\t * - Zero units will not be shown\n\t * @example result will be '1 hour' instead of '1 hour 0 minutes 0 seconds'\n\t */\n\tformat(formatStr: string = ''): string\n\t{\n\t\tif (formatStr === '')\n\t\t{\n\t\t\treturn this.formatAllUnits('Y m d H i s', true).replaceAll(/\\s+/g, ' ').trim();\n\t\t}\n\n\t\treturn this.formatAllUnits(formatStr, false);\n\t}\n\n\tformatAllUnits(formatStr: string, mod: boolean): string\n\t{\n\t\t// eslint-disable-next-line unicorn/better-regex\n\t\treturn formatStr.replaceAll(/([YmdHis])/g, (unitStr) => this.formatUnit(unitStr, mod));\n\t}\n\n\tformatUnit(unitStr: string, mod: boolean): string\n\t{\n\t\tconst value = mod ? this.getUnitPropertyModByFormat(unitStr) : this.getUnitPropertyByFormat(unitStr);\n\t\tif (mod && value === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst now = Date.now() / 1000;\n\t\tconst unitDuration = value * this.getUnitDuration(unitStr) / 1000;\n\n\t\treturn DateTimeFormat.format(`${unitStr}diff`, now - unitDuration, now);\n\t}\n\n\tgetUnitPropertyByFormat(unitStr: string): number\n\t{\n\t\tconst props = { s: this.seconds, i: this.minutes, H: this.hours, d: this.days, m: this.months, Y: this.years };\n\n\t\treturn props[unitStr];\n\t}\n\n\tgetUnitPropertyModByFormat(unitStr: string): number\n\t{\n\t\tconst propsMod = {\n\t\t\ts: this.seconds % 60,\n\t\t\ti: this.minutes % 60,\n\t\t\tH: this.hours % 24,\n\t\t\td: this.days % 31,\n\t\t\tm: this.months % 12,\n\t\t\tY: this.years,\n\t\t};\n\n\t\treturn propsMod[unitStr];\n\t}\n\n\tgetUnitDuration(unitStr: string): number\n\t{\n\t\treturn Duration.getUnitDurations()[unitStr];\n\t}\n\n\tstatic getUnitDurations(): { s: number, i: number, H: number, d: number, m: number, Y: number }\n\t{\n\t\treturn {\n\t\t\ts: 1000,\n\t\t\ti: 60000,\n\t\t\tH: 3_600_000,\n\t\t\td: 86_400_000,\n\t\t\tm: 2_678_400_000,\n\t\t\tY: 31_536_000_000,\n\t\t};\n\t}\n}\n"],"names":["Duration","constructor","milliseconds","Math","abs","createFromSeconds","seconds","getUnitDurations","s","createFromMinutes","minutes","i","floor","hours","H","days","d","months","m","years","Y","format","formatStr","formatAllUnits","replaceAll","trim","mod","unitStr","formatUnit","value","getUnitPropertyModByFormat","getUnitPropertyByFormat","now","Date","unitDuration","getUnitDuration","DateTimeFormat","props","propsMod"],"mappings":";;;;;;CAEO,MAAMA,QAAQ,CACrB;GACCC,WAAW,CAACC,YAAoB,EAChC;KACC,IAAI,CAACA,YAAY,GAAGC,IAAI,CAACC,GAAG,CAACF,YAAY,CAAC;;GAG3C,OAAOG,iBAAiB,CAACC,OAAe,EACxC;KACC,OAAO,IAAIN,QAAQ,CAACM,OAAO,GAAGN,QAAQ,CAACO,gBAAgB,EAAE,CAACC,CAAC,CAAC;;GAG7D,OAAOC,iBAAiB,CAACC,OAAe,EACxC;KACC,OAAO,IAAIV,QAAQ,CAACU,OAAO,GAAGV,QAAQ,CAACO,gBAAgB,EAAE,CAACI,CAAC,CAAC;;GAG7D,IAAIL,OAAO,GACX;KACC,OAAOH,IAAI,CAACS,KAAK,CAAC,IAAI,CAACV,YAAY,GAAGF,QAAQ,CAACO,gBAAgB,EAAE,CAACC,CAAC,CAAC;;GAGrE,IAAIE,OAAO,GACX;KACC,OAAOP,IAAI,CAACS,KAAK,CAAC,IAAI,CAACV,YAAY,GAAGF,QAAQ,CAACO,gBAAgB,EAAE,CAACI,CAAC,CAAC;;GAGrE,IAAIE,KAAK,GACT;KACC,OAAOV,IAAI,CAACS,KAAK,CAAC,IAAI,CAACV,YAAY,GAAGF,QAAQ,CAACO,gBAAgB,EAAE,CAACO,CAAC,CAAC;;GAGrE,IAAIC,IAAI,GACR;KACC,OAAOZ,IAAI,CAACS,KAAK,CAAC,IAAI,CAACV,YAAY,GAAGF,QAAQ,CAACO,gBAAgB,EAAE,CAACS,CAAC,CAAC;;;;CAItE;CACA;GACC,IAAIC,MAAM,GACV;KACC,OAAOd,IAAI,CAACS,KAAK,CAAC,IAAI,CAACV,YAAY,GAAGF,QAAQ,CAACO,gBAAgB,EAAE,CAACW,CAAC,CAAC;;;;CAItE;CACA;GACC,IAAIC,KAAK,GACT;KACC,OAAOhB,IAAI,CAACS,KAAK,CAAC,IAAI,CAACV,YAAY,GAAGF,QAAQ,CAACO,gBAAgB,EAAE,CAACa,CAAC,CAAC;;;;CAItE;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;GACCC,MAAM,CAACC,SAAiB,GAAG,EAAE,EAC7B;KACC,IAAIA,SAAS,KAAK,EAAE,EACpB;OACC,OAAO,IAAI,CAACC,cAAc,CAAC,aAAa,EAAE,IAAI,CAAC,CAACC,UAAU,CAAC,MAAM,EAAE,GAAG,CAAC,CAACC,IAAI,EAAE;;KAG/E,OAAO,IAAI,CAACF,cAAc,CAACD,SAAS,EAAE,KAAK,CAAC;;GAG7CC,cAAc,CAACD,SAAiB,EAAEI,GAAY,EAC9C;;KAEC,OAAOJ,SAAS,CAACE,UAAU,CAAC,aAAa,EAAGG,OAAO,IAAK,IAAI,CAACC,UAAU,CAACD,OAAO,EAAED,GAAG,CAAC,CAAC;;GAGvFE,UAAU,CAACD,OAAe,EAAED,GAAY,EACxC;KACC,MAAMG,KAAK,GAAGH,GAAG,GAAG,IAAI,CAACI,0BAA0B,CAACH,OAAO,CAAC,GAAG,IAAI,CAACI,uBAAuB,CAACJ,OAAO,CAAC;KACpG,IAAID,GAAG,IAAIG,KAAK,KAAK,CAAC,EACtB;OACC,OAAO,EAAE;;KAGV,MAAMG,GAAG,GAAGC,IAAI,CAACD,GAAG,EAAE,GAAG,IAAI;KAC7B,MAAME,YAAY,GAAGL,KAAK,GAAG,IAAI,CAACM,eAAe,CAACR,OAAO,CAAC,GAAG,IAAI;KAEjE,OAAOS,wBAAc,CAACf,MAAM,CAAE,GAAEM,OAAQ,MAAK,EAAEK,GAAG,GAAGE,YAAY,EAAEF,GAAG,CAAC;;GAGxED,uBAAuB,CAACJ,OAAe,EACvC;KACC,MAAMU,KAAK,GAAG;OAAE7B,CAAC,EAAE,IAAI,CAACF,OAAO;OAAEK,CAAC,EAAE,IAAI,CAACD,OAAO;OAAEI,CAAC,EAAE,IAAI,CAACD,KAAK;OAAEG,CAAC,EAAE,IAAI,CAACD,IAAI;OAAEG,CAAC,EAAE,IAAI,CAACD,MAAM;OAAEG,CAAC,EAAE,IAAI,CAACD;MAAO;KAE9G,OAAOkB,KAAK,CAACV,OAAO,CAAC;;GAGtBG,0BAA0B,CAACH,OAAe,EAC1C;KACC,MAAMW,QAAQ,GAAG;OAChB9B,CAAC,EAAE,IAAI,CAACF,OAAO,GAAG,EAAE;OACpBK,CAAC,EAAE,IAAI,CAACD,OAAO,GAAG,EAAE;OACpBI,CAAC,EAAE,IAAI,CAACD,KAAK,GAAG,EAAE;OAClBG,CAAC,EAAE,IAAI,CAACD,IAAI,GAAG,EAAE;OACjBG,CAAC,EAAE,IAAI,CAACD,MAAM,GAAG,EAAE;OACnBG,CAAC,EAAE,IAAI,CAACD;MACR;KAED,OAAOmB,QAAQ,CAACX,OAAO,CAAC;;GAGzBQ,eAAe,CAACR,OAAe,EAC/B;KACC,OAAO3B,QAAQ,CAACO,gBAAgB,EAAE,CAACoB,OAAO,CAAC;;GAG5C,OAAOpB,gBAAgB,GACvB;KACC,OAAO;OACNC,CAAC,EAAE,IAAI;OACPG,CAAC,EAAE,KAAK;OACRG,CAAC,EAAE,OAAS;OACZE,CAAC,EAAE,QAAU;OACbE,CAAC,EAAE,UAAa;OAChBE,CAAC,EAAE;MACH;;CAEH;;;;;;;;"}