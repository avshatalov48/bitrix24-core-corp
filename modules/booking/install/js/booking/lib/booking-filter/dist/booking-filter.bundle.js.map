{"version":3,"file":"booking-filter.bundle.js","sources":["../src/booking-filter.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { Model } from 'booking.const';\nimport { Core } from 'booking.core';\nimport type { BookingUIFilter, BookingListFilter } from './types';\n\nclass BookingFilter\n{\n\tprepareFilter(fields: BookingUIFilter, withinMonth: boolean = false): BookingListFilter\n\t{\n\t\tconst dateTs = Core.getStore().getters[`${Model.Interface}/${withinMonth ? 'viewDateTs' : 'selectedDateTs'}`];\n\t\tconst date = new Date(dateTs);\n\n\t\tconst filter = {\n\t\t\tWITHIN: {\n\t\t\t\tDATE_FROM: date.getTime() / 1000,\n\t\t\t\tDATE_TO: withinMonth\n\t\t\t\t\t? date.setMonth(date.getMonth() + 1) / 1000\n\t\t\t\t\t: date.setDate(date.getDate() + 1) / 1000,\n\t\t\t},\n\t\t};\n\n\t\tif (Type.isArrayFilled(fields.CREATED_BY))\n\t\t{\n\t\t\tfilter.CREATED_BY = fields.CREATED_BY.map((id: string) => Number(id));\n\t\t}\n\n\t\tif (Type.isArrayFilled(fields.CONTACT))\n\t\t{\n\t\t\tfilter.CRM_CONTACT_ID = fields.CONTACT.map((id: string) => Number(id));\n\t\t}\n\n\t\tif (Type.isArrayFilled(fields.COMPANY))\n\t\t{\n\t\t\tfilter.CRM_COMPANY_ID = fields.COMPANY.map((id: string) => Number(id));\n\t\t}\n\n\t\tif (Type.isArrayFilled(fields.RESOURCE))\n\t\t{\n\t\t\tfilter.RESOURCE_ID = fields.RESOURCE.map((id: string) => Number(id));\n\t\t}\n\n\t\tif (fields.CONFIRMED)\n\t\t{\n\t\t\tfilter.IS_CONFIRMED = { 'Y': 1, 'N': 0 }[fields.CONFIRMED];\n\t\t}\n\n\t\tif (fields.DELAYED)\n\t\t{\n\t\t\tfilter.IS_DELAYED = { 'Y': 1, 'N': 0 }[fields.DELAYED];\n\t\t}\n\n\t\treturn filter;\n\t}\n}\n\nexport const bookingFilter = new BookingFilter();\n"],"names":["BookingFilter","prepareFilter","fields","withinMonth","dateTs","Core","getStore","getters","Model","Interface","date","Date","filter","WITHIN","DATE_FROM","getTime","DATE_TO","setMonth","getMonth","setDate","getDate","Type","isArrayFilled","CREATED_BY","map","id","Number","CONTACT","CRM_CONTACT_ID","COMPANY","CRM_COMPANY_ID","RESOURCE","RESOURCE_ID","CONFIRMED","IS_CONFIRMED","DELAYED","IS_DELAYED","bookingFilter"],"mappings":";;;;;;CAKA,MAAMA,aAAa,CACnB;GACCC,aAAa,CAACC,MAAuB,EAAEC,WAAoB,GAAG,KAAK,EACnE;KACC,MAAMC,MAAM,GAAGC,iBAAI,CAACC,QAAQ,EAAE,CAACC,OAAO,CAAE,GAAEC,mBAAK,CAACC,SAAU,IAAGN,WAAW,GAAG,YAAY,GAAG,gBAAiB,EAAC,CAAC;KAC7G,MAAMO,IAAI,GAAG,IAAIC,IAAI,CAACP,MAAM,CAAC;KAE7B,MAAMQ,MAAM,GAAG;OACdC,MAAM,EAAE;SACPC,SAAS,EAAEJ,IAAI,CAACK,OAAO,EAAE,GAAG,IAAI;SAChCC,OAAO,EAAEb,WAAW,GACjBO,IAAI,CAACO,QAAQ,CAACP,IAAI,CAACQ,QAAQ,EAAE,GAAG,CAAC,CAAC,GAAG,IAAI,GACzCR,IAAI,CAACS,OAAO,CAACT,IAAI,CAACU,OAAO,EAAE,GAAG,CAAC,CAAC,GAAG;;MAEvC;KAED,IAAIC,cAAI,CAACC,aAAa,CAACpB,MAAM,CAACqB,UAAU,CAAC,EACzC;OACCX,MAAM,CAACW,UAAU,GAAGrB,MAAM,CAACqB,UAAU,CAACC,GAAG,CAAEC,EAAU,IAAKC,MAAM,CAACD,EAAE,CAAC,CAAC;;KAGtE,IAAIJ,cAAI,CAACC,aAAa,CAACpB,MAAM,CAACyB,OAAO,CAAC,EACtC;OACCf,MAAM,CAACgB,cAAc,GAAG1B,MAAM,CAACyB,OAAO,CAACH,GAAG,CAAEC,EAAU,IAAKC,MAAM,CAACD,EAAE,CAAC,CAAC;;KAGvE,IAAIJ,cAAI,CAACC,aAAa,CAACpB,MAAM,CAAC2B,OAAO,CAAC,EACtC;OACCjB,MAAM,CAACkB,cAAc,GAAG5B,MAAM,CAAC2B,OAAO,CAACL,GAAG,CAAEC,EAAU,IAAKC,MAAM,CAACD,EAAE,CAAC,CAAC;;KAGvE,IAAIJ,cAAI,CAACC,aAAa,CAACpB,MAAM,CAAC6B,QAAQ,CAAC,EACvC;OACCnB,MAAM,CAACoB,WAAW,GAAG9B,MAAM,CAAC6B,QAAQ,CAACP,GAAG,CAAEC,EAAU,IAAKC,MAAM,CAACD,EAAE,CAAC,CAAC;;KAGrE,IAAIvB,MAAM,CAAC+B,SAAS,EACpB;OACCrB,MAAM,CAACsB,YAAY,GAAG;SAAE,GAAG,EAAE,CAAC;SAAE,GAAG,EAAE;QAAG,CAAChC,MAAM,CAAC+B,SAAS,CAAC;;KAG3D,IAAI/B,MAAM,CAACiC,OAAO,EAClB;OACCvB,MAAM,CAACwB,UAAU,GAAG;SAAE,GAAG,EAAE,CAAC;SAAE,GAAG,EAAE;QAAG,CAAClC,MAAM,CAACiC,OAAO,CAAC;;KAGvD,OAAOvB,MAAM;;CAEf;AAEA,OAAayB,aAAa,GAAG,IAAIrC,aAAa,EAAE;;;;;;;;"}