{"version":3,"file":"drag.bundle.js","sources":["../src/drag.js"],"sourcesContent":["import { Dom, Loc, Runtime } from 'main.core';\nimport { Popup, PopupManager } from 'main.popup';\nimport { DateTimeFormat } from 'main.date';\nimport { Draggable, DragMoveEvent, DragStartEvent } from 'ui.draganddrop.draggable';\n\nimport { Model } from 'booking.const';\nimport { Core } from 'booking.core';\nimport { busySlots } from 'booking.lib.busy-slots';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel } from 'booking.model.bookings';\n\ntype Params = {\n\tdraggable: string,\n\tcontainer: HTMLElement,\n};\n\nexport class Drag\n{\n\t#params: Params;\n\t#dragManager: Draggable;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\n\t\tthis.#dragManager = new Draggable({\n\t\t\tcontainer: this.#params.container,\n\t\t\tdraggable: this.#params.draggable,\n\t\t\telementsPreventingDrag: ['.booking-booking-resize'],\n\t\t\tdelay: 200,\n\t\t});\n\n\t\tthis.#dragManager.subscribe('start', this.#onDragStart.bind(this));\n\t\tthis.#dragManager.subscribe('move', this.#onDragMove.bind(this));\n\t\tthis.#dragManager.subscribe('end', this.#onDragEnd.bind(this));\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#dragManager.destroy();\n\t}\n\n\tasync #onDragStart(event: DragStartEvent): Promise<void>\n\t{\n\t\tconst { draggable, source: { dataset }, clientX, clientY } = event.getData();\n\n\t\tawait Promise.all([\n\t\t\tCore.getStore().dispatch(`${Model.Interface}/setDraggedBookingId`, Number(dataset.id)),\n\t\t\tCore.getStore().dispatch(`${Model.Interface}/setDraggedBookingResourceId`, Number(dataset.resourceId)),\n\t\t]);\n\n\t\tDom.style(draggable, 'pointer-events', 'none');\n\t\tthis.#getAdditionalBookingElements(this.#params.container).forEach((element) => {\n\t\t\tconst clone = Runtime.clone(element);\n\t\t\tdraggable.append(clone);\n\n\t\t\tconst translateX = element.getBoundingClientRect().left - draggable.getBoundingClientRect().left;\n\t\t\tconst translateY = element.getBoundingClientRect().top - draggable.getBoundingClientRect().top;\n\t\t\tDom.style(clone, 'transition', 'none');\n\t\t\tDom.style(clone, 'transform', `translate(${translateX}px, ${translateY}px)`);\n\t\t\tDom.style(clone, 'animation', 'none');\n\t\t});\n\n\t\tthis.#getBookingElements(this.#params.container).forEach((element) => {\n\t\t\tif (draggable.contains(element))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.addClass(element, '--drag-source');\n\t\t\tDom.style(element, 'visibility', 'visible');\n\t\t});\n\n\t\tconst transformOriginX = clientX - draggable.getBoundingClientRect().left;\n\t\tconst transformOriginY = clientY - draggable.getBoundingClientRect().top;\n\t\tthis.#getBookingElements(draggable).forEach((clone) => {\n\t\t\tDom.style(clone, 'transform-origin', `${transformOriginX}px ${transformOriginY}px`);\n\t\t});\n\n\t\tPopupManager.getPopups().forEach((popup: Popup) => popup.close());\n\n\t\tvoid busySlots.loadBusySlots();\n\t}\n\n\t#onDragMove(event: DragMoveEvent): void\n\t{\n\t\tconst { draggable, clientX, clientY } = event.getData();\n\n\t\tthis.#getAdditionalBookingElements(draggable).forEach((clone, index) => {\n\t\t\tDom.style(clone, 'transition', '');\n\t\t\tDom.style(clone, 'transform', `rotate(${index === 1 ? 4 : 0}deg)`);\n\t\t\tDom.style(clone, 'zIndex', `-${index + 1}`);\n\t\t});\n\n\t\tif (this.#isDragDeleteHovered(clientX, clientY))\n\t\t{\n\t\t\tDom.addClass(draggable, '--deleting');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(draggable, '--deleting');\n\t\t}\n\n\t\tdraggable.querySelectorAll('[data-element=\"booking-booking-time\"]').forEach((time) => {\n\t\t\ttime.innerText = this.#timeFormatted;\n\t\t});\n\n\t\tthis.#updateScroll(draggable, clientX, clientY);\n\t}\n\n\tasync #onDragEnd(): Promise<void>\n\t{\n\t\tclearInterval(this.scrollTimeout);\n\n\t\tthis.#getBookingElements(this.#params.container).forEach((element) => {\n\t\t\tDom.removeClass(element, '--drag-source');\n\t\t\tDom.style(element, 'visibility', '');\n\t\t});\n\n\t\tif (this.#hoveredCell)\n\t\t{\n\t\t\tthis.#moveBooking({\n\t\t\t\tbooking: this.#draggedBooking,\n\t\t\t\tresourceId: this.#draggedBookingResourceId,\n\t\t\t\tcell: this.#hoveredCell,\n\t\t\t});\n\t\t}\n\n\t\tawait Core.getStore().dispatch(`${Model.Interface}/setDraggedBookingId`, null);\n\n\t\tvoid busySlots.loadBusySlots();\n\t}\n\n\t#getBookingElements(container: HTMLElement): HTMLElement[]\n\t{\n\t\tconst element = 'booking-booking';\n\t\tconst id = this.#draggedBookingId;\n\n\t\treturn [...container\n\t\t\t.querySelectorAll(`[data-element=\"${element}\"][data-id=\"${id}\"]`),\n\t\t];\n\t}\n\n\t#getAdditionalBookingElements(container: HTMLElement): HTMLElement[]\n\t{\n\t\tconst element = 'booking-booking';\n\t\tconst id = this.#draggedBookingId;\n\t\tconst resourceId = this.#draggedBookingResourceId;\n\n\t\treturn [...container\n\t\t\t.querySelectorAll(`[data-element=\"${element}\"][data-id=\"${id}\"]:not([data-resource-id=\"${resourceId}\"])`),\n\t\t];\n\t}\n\n\t#updateScroll(draggable: HTMLElement, x: number, y: number): void\n\t{\n\t\tclearTimeout(this.scrollTimeout);\n\t\tif (this.#isDragDeleteHovered(x, y))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst gridRect = this.#gridWrap.getBoundingClientRect();\n\t\tconst draggableRect = draggable.getBoundingClientRect();\n\n\t\tthis.scrollTimeout = setTimeout(() => this.#updateScroll(draggable), 16);\n\n\t\tif (draggableRect.left < gridRect.left)\n\t\t{\n\t\t\tthis.#gridColumns.scrollLeft -= this.#getSpeed(draggableRect.left, gridRect.left);\n\t\t}\n\t\telse if (draggableRect.right > gridRect.right)\n\t\t{\n\t\t\tthis.#gridColumns.scrollLeft += this.#getSpeed(draggableRect.right, gridRect.right);\n\t\t}\n\t\telse if (draggableRect.top < gridRect.top)\n\t\t{\n\t\t\tthis.#gridWrap.scrollTop -= this.#getSpeed(draggableRect.top, gridRect.top);\n\t\t}\n\t\telse if (draggableRect.bottom > gridRect.bottom)\n\t\t{\n\t\t\tthis.#gridWrap.scrollTop += 2 * this.#getSpeed(draggableRect.bottom, gridRect.bottom);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tclearTimeout(this.scrollTimeout);\n\t\t}\n\t}\n\n\t#getSpeed(a: number, b: number): number\n\t{\n\t\treturn (Math.floor(Math.sqrt(Math.abs(a - b))) + 1) / 2;\n\t}\n\n\t#isDragDeleteHovered(x: number, y: number): boolean\n\t{\n\t\tif (!x || !y)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn document.elementFromPoint(x, y)?.closest('[data-element=\"booking-drag-delete\"]');\n\t}\n\n\t#moveBooking({ booking, resourceId, cell }: { booking: BookingModel, resourceId: number, cell: CellDto }): void\n\t{\n\t\tif (cell.fromTs === booking.dateFromTs && cell.toTs === booking.dateToTs && cell.resourceId === resourceId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst additionalResourcesIds = booking.resourcesIds.includes(cell.resourceId)\n\t\t\t? booking.resourcesIds\n\t\t\t: booking.resourcesIds.filter((id: number) => id !== resourceId)\n\t\t;\n\n\t\tvoid bookingService.update({\n\t\t\tid: booking.id,\n\t\t\tdateFromTs: cell.fromTs,\n\t\t\tdateToTs: cell.toTs,\n\t\t\tresourcesIds: [...new Set([\n\t\t\t\tcell.resourceId,\n\t\t\t\t...additionalResourcesIds,\n\t\t\t])],\n\t\t\ttimezoneFrom: booking.timezoneFrom,\n\t\t\ttimezoneTo: booking.timezoneTo,\n\t\t});\n\t}\n\n\tget #timeFormatted(): string\n\t{\n\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\t\tconst from = this.#hoveredCell?.fromTs ?? this.#draggedBooking.dateFromTs;\n\t\tconst to = this.#hoveredCell?.toTs ?? this.#draggedBooking.dateToTs;\n\n\t\treturn Loc.getMessage('BOOKING_BOOKING_TIME_RANGE', {\n\t\t\t'#FROM#': DateTimeFormat.format(timeFormat, (from + this.#offset) / 1000),\n\t\t\t'#TO#': DateTimeFormat.format(timeFormat, (to + this.#offset) / 1000),\n\t\t});\n\t}\n\n\tget #draggedBooking(): BookingModel | null\n\t{\n\t\treturn Core.getStore().getters[`${Model.Bookings}/getById`](this.#draggedBookingId) ?? null;\n\t}\n\n\tget #draggedBookingId(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/draggedBookingId`];\n\t}\n\n\tget #draggedBookingResourceId(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/draggedBookingResourceId`];\n\t}\n\n\tget #hoveredCell(): CellDto\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/hoveredCell`];\n\t}\n\n\tget #offset(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/offset`];\n\t}\n\n\tget #gridWrap(): HTMLElement\n\t{\n\t\treturn BX('booking-booking-grid-wrap');\n\t}\n\n\tget #gridColumns(): HTMLElement\n\t{\n\t\treturn BX('booking-booking-grid-columns');\n\t}\n}\n"],"names":["Drag","constructor","params","Draggable","container","draggable","elementsPreventingDrag","delay","subscribe","bind","destroy","event","source","dataset","clientX","clientY","getData","Promise","all","Core","getStore","dispatch","Model","Interface","Number","id","resourceId","Dom","style","forEach","element","clone","Runtime","append","translateX","getBoundingClientRect","left","translateY","top","contains","addClass","transformOriginX","transformOriginY","PopupManager","getPopups","popup","close","busySlots","loadBusySlots","index","removeClass","querySelectorAll","time","innerText","clearInterval","scrollTimeout","booking","cell","x","y","clearTimeout","gridRect","draggableRect","setTimeout","scrollLeft","right","scrollTop","bottom","a","b","Math","floor","sqrt","abs","document","elementFromPoint","closest","fromTs","dateFromTs","toTs","dateToTs","additionalResourcesIds","resourcesIds","includes","filter","bookingService","update","Set","timezoneFrom","timezoneTo","timeFormat","DateTimeFormat","getFormat","from","to","Loc","getMessage","format","getters","Bookings","BX"],"mappings":"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"}