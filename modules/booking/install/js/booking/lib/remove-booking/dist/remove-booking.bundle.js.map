{"version":3,"file":"remove-booking.bundle.js","sources":["../src/remove-booking.js"],"sourcesContent":["import { Loc } from 'main.core';\nimport 'ui.notification';\n\nimport { Model } from 'booking.const';\nimport { Core } from 'booking.core';\nimport { bookingService } from 'booking.provider.service.booking-service';\n\nconst secondsToDelete = 5;\n\nexport class RemoveBooking\n{\n\t#balloon: BX.UI.Notification.Balloon;\n\t#bookingId: number;\n\t#secondsLeft: number;\n\t#cancelingTheDeletion: boolean;\n\t#interval: number;\n\n\tconstructor(bookingId: number)\n\t{\n\t\tthis.#bookingId = bookingId;\n\n\t\tthis.#removeBooking();\n\t}\n\n\t#removeBooking(): void\n\t{\n\t\tthis.#secondsLeft = secondsToDelete;\n\n\t\tthis.#balloon = BX.UI.Notification.Center.notify({\n\t\t\tid: `booking-notify-remove-${this.#bookingId}`,\n\t\t\tcontent: this.#getBalloonTitle(),\n\t\t\tactions: [{\n\t\t\t\ttitle: Loc.getMessage('BB_BOOKING_REMOVE_BALLOON_CANCEL'),\n\t\t\t\tevents: {\n\t\t\t\t\tmouseup: this.#cancelDeletion,\n\t\t\t\t},\n\t\t\t}],\n\t\t\tevents: {\n\t\t\t\tonClose: this.#onBalloonClose,\n\t\t\t},\n\t\t});\n\n\t\tthis.#startDeletion();\n\t}\n\n\t#startDeletion(): void\n\t{\n\t\tthis.#interval = setInterval(() => {\n\t\t\tthis.#secondsLeft--;\n\n\t\t\tthis.#balloon.update({ content: this.#getBalloonTitle() });\n\n\t\t\tif (this.#secondsLeft <= 0)\n\t\t\t{\n\t\t\t\tthis.#balloon.close();\n\t\t\t}\n\t\t}, 1000);\n\n\t\tvoid Core.getStore().dispatch(`${Model.Interface}/addDeletingBooking`, this.#bookingId);\n\t}\n\n\t#getBalloonTitle(): string\n\t{\n\t\treturn Loc.getMessage('BB_BOOKING_REMOVE_BALLOON_TEXT', {\n\t\t\t'#countdown#': this.#secondsLeft,\n\t\t});\n\t}\n\n\t#cancelDeletion = (): void => {\n\t\tthis.#cancelingTheDeletion = true;\n\t\tthis.#balloon.close();\n\n\t\tvoid Core.getStore().dispatch(`${Model.Interface}/removeDeletingBooking`, this.#bookingId);\n\t};\n\n\t#onBalloonClose = (): void => {\n\t\tclearInterval(this.#interval);\n\n\t\tif (this.#cancelingTheDeletion)\n\t\t{\n\t\t\tthis.#cancelingTheDeletion = false;\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid bookingService.delete(this.#bookingId);\n\t};\n}\n"],"names":["secondsToDelete","RemoveBooking","constructor","bookingId","close","Core","getStore","dispatch","Model","Interface","clearInterval","bookingService","delete","BX","UI","Notification","Center","notify","id","content","actions","title","Loc","getMessage","events","mouseup","onClose","setInterval","update"],"mappings":";;;;;;CAOA,MAAMA,eAAe,GAAG,CAAC;CAAC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAE1B,CAAO,MAAMC,aAAa,CAC1B;GAOCC,WAAW,CAACC,SAAiB,EAC7B;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA,OAkDkB,MAAY;SAC7B,4CAAI,kDAAyB,IAAI;SACjC,4CAAI,sBAAUC,KAAK,EAAE;SAErB,KAAKC,iBAAI,CAACC,QAAQ,EAAE,CAACC,QAAQ,CAAE,GAAEC,mBAAK,CAACC,SAAU,wBAAuB,0CAAE,IAAI,0BAAY;;;KAC1F;OAAA;OAAA,OAEiB,MAAY;SAC7BC,aAAa,yCAAC,IAAI,wBAAW;SAE7B,4CAAI,IAAI,iDACR;WACC,4CAAI,kDAAyB,KAAK;WAElC;;SAGD,KAAKC,sDAAc,CAACC,MAAM,yCAAC,IAAI,0BAAY;;;KAlE3C,4CAAI,4BAAcT,SAAS;KAE3B,4CAAI;;CAkEN;CAAC,2BA9DA;GACC,4CAAI,gCAAgBH,eAAe;GAEnC,4CAAI,wBAAYa,EAAE,CAACC,EAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;KAChDC,EAAE,EAAG,yBAAsB,wCAAE,IAAI,yBAAY,EAAC;KAC9CC,OAAO,0CAAE,IAAI,uCAAmB;KAChCC,OAAO,EAAE,CAAC;OACTC,KAAK,EAAEC,aAAG,CAACC,UAAU,CAAC,kCAAkC,CAAC;OACzDC,MAAM,EAAE;SACPC,OAAO,0CAAE,IAAI;;MAEd,CAAC;KACFD,MAAM,EAAE;OACPE,OAAO,0CAAE,IAAI;;IAEd,CAAC;GAEF,4CAAI;CACL;CAAC,2BAGD;GACC,4CAAI,0BAAaC,WAAW,CAAC,MAAM;KAClC,4CAAI,+BAAe;KAEnB,4CAAI,sBAAUC,MAAM,CAAC;OAAET,OAAO,0CAAE,IAAI;MAAqB,CAAC;KAE1D,IAAI,4CAAI,iCAAiB,CAAC,EAC1B;OACC,4CAAI,sBAAUf,KAAK,EAAE;;IAEtB,EAAE,IAAI,CAAC;GAER,KAAKC,iBAAI,CAACC,QAAQ,EAAE,CAACC,QAAQ,CAAE,GAAEC,mBAAK,CAACC,SAAU,qBAAoB,0CAAE,IAAI,0BAAY;CACxF;CAAC,6BAGD;GACC,OAAOa,aAAG,CAACC,UAAU,CAAC,gCAAgC,EAAE;KACvD,aAAa,0CAAE,IAAI;IACnB,CAAC;CACH;;;;;;;;"}