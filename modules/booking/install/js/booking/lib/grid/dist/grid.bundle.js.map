{"version":3,"file":"grid.bundle.js","sources":["../src/grid.js"],"sourcesContent":["import { Core } from 'booking.core';\nimport { Model } from 'booking.const';\nimport { Duration } from 'booking.lib.duration';\n\nclass Grid\n{\n\tcalculateLeft(resourceId: number): number\n\t{\n\t\tconst cellWidth = 280 * this.#zoom;\n\t\tconst indexOfResource = this.#resourcesIds.indexOf(resourceId);\n\n\t\treturn indexOfResource * cellWidth;\n\t}\n\n\tcalculateTop(fromTs: number): number\n\t{\n\t\tconst hourHeight = 50 * this.#zoom;\n\n\t\tconst from = new Date(Math.max(this.#selectedDateTs, fromTs + this.#offset));\n\t\tconst bookingMinutes = from.getHours() * 60 + from.getMinutes();\n\t\tconst fromMinutes = this.#fromHour * 60;\n\n\t\treturn (bookingMinutes - fromMinutes) * (hourHeight / 60);\n\t}\n\n\tcalculateHeight(fromTs: number, toTs: number): number\n\t{\n\t\tconst hourHeight = 50 * this.#zoom;\n\t\tconst minHeight = hourHeight / 4;\n\n\t\tconst from = Math.max(this.#selectedDateTs, fromTs + this.#offset);\n\t\tconst to = Math.min(new Date(this.#selectedDateTs).setHours(24), toTs + this.#offset);\n\n\t\treturn Math.max((to - from) / Duration.getUnitDurations().H * hourHeight, minHeight);\n\t}\n\n\tcalculateRealHeight(fromTs: number, toTs: number): number\n\t{\n\t\tconst hourHeight = 50 * this.#zoom;\n\t\tconst minHeight = hourHeight / 4;\n\n\t\tconst minTs = new Date(this.#selectedDateTs).setHours(this.#offHoursExpanded ? 0 : this.#fromHour);\n\t\tconst maxTs = new Date(this.#selectedDateTs).setHours(this.#offHoursExpanded ? 24 : this.#toHour);\n\t\tconst from = Math.max(minTs, fromTs + this.#offset);\n\t\tconst to = Math.min(maxTs, toTs + this.#offset);\n\n\t\treturn Math.max((to - from) / Duration.getUnitDurations().H * hourHeight, minHeight);\n\t}\n\n\tget #selectedDateTs(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/selectedDateTs`] + this.#offset;\n\t}\n\n\tget #offset(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/offset`];\n\t}\n\n\tget #zoom(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/zoom`];\n\t}\n\n\tget #resourcesIds(): number[]\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/resourcesIds`];\n\t}\n\n\tget #fromHour(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/fromHour`];\n\t}\n\n\tget #toHour(): number\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/toHour`];\n\t}\n\n\tget #offHoursExpanded(): boolean\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/offHoursExpanded`];\n\t}\n}\n\nexport const grid = new Grid();\n"],"names":["Grid","calculateLeft","resourceId","cellWidth","indexOfResource","indexOf","calculateTop","fromTs","hourHeight","from","Date","Math","max","bookingMinutes","getHours","getMinutes","fromMinutes","calculateHeight","toTs","minHeight","to","min","setHours","Duration","getUnitDurations","H","calculateRealHeight","minTs","maxTs","Core","getStore","getters","Model","Interface","grid"],"mappings":"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"}