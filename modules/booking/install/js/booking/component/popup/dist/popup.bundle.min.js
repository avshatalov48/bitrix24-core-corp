this.BX=this.BX||{};this.BX.Booking=this.BX.Booking||{};(function(t,e,i){"use strict";class n{constructor(t){this.popup=null;this.sliders=new Set;this.popup=t;this.getPopup().subscribe("onShow",this.onPopupShow.bind(this));this.getPopup().subscribe("onClose",this.onPopupClose.bind(this));this.getPopup().subscribe("onDestroy",this.onPopupClose.bind(this));this.handleSliderOpen=this.handleSliderOpen.bind(this);this.handleSliderClose=this.handleSliderClose.bind(this);this.handleSliderDestroy=this.handleSliderDestroy.bind(this)}bindEvents(){this.unbindEvents();if(top.BX){top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onOpen",this.handleSliderOpen);top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onCloseComplete",this.handleSliderClose);top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onDestroy",this.handleSliderDestroy)}}unbindEvents(){if(top.BX){top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onOpen",this.handleSliderOpen);top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onCloseComplete",this.handleSliderClose);top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onDestroy",this.handleSliderDestroy)}}onPopupShow(){this.bindEvents()}onPopupClose(){this.unbindEvents();this.sliders.clear();this.popup.unfreeze()}handleSliderOpen(t){const[e]=t.getData();const i=e.getSlider();if(!this.isPopupInSlider(i)){this.sliders.add(i);this.popup.freeze()}}handleSliderClose(t){const[e]=t.getData();const i=e.getSlider();this.sliders.delete(i);if(this.sliders.size===0){this.popup.unfreeze()}}handleSliderDestroy(t){const[e]=t.getData();const i=e.getSlider();if(this.isPopupInSlider(i)){this.unbindEvents();this.getPopup().destroy()}else{this.sliders.delete(i);if(this.sliders.size===0){this.popup.unfreeze()}}}isPopupInSlider(t){if(t.getFrameWindow()){return t.getFrameWindow().document.contains(this.getPopup().getPopupContainer())}return t.getContainer().contains(this.getPopup().getPopupContainer())}getPopup(){return this.popup.getPopupInstance()}}const o={emits:["close"],props:{id:{type:String,required:true},config:{type:Object,default:{}}},created(){new n(this)},beforeMount(){this.getPopupInstance().show()},mounted(){this.adjustPosition();this.getPopupInstance().getContentContainer().remove();const{angleBorderRadius:t}=this.config;i.Dom.style(this.container,"--booking-popup-angle-border-radius",t)},beforeUnmount(){this.closePopup()},computed:{popupContainer(){return`#${this.id}`},container(){return this.getPopupInstance().getPopupContainer()},options(){return{...this.defaultOptions,...this.config}},defaultOptions(){return{id:this.id,cacheable:false,autoHide:true,autoHideHandler:({target:t})=>{const e=t!==this.container&&!this.container.contains(t);const i=t.closest(".popup-window-ui-tour");return e&&!i},closeByEsc:true,animation:"fading",events:{onPopupClose:this.closePopup,onPopupDestroy:this.closePopup}}}},methods:{contains(t){var e;return(e=this.container.contains(t))!=null?e:false},adjustPosition(){this.getPopupInstance().adjustPosition(this.options.bindOptions)},freeze(){this.getPopupInstance().setAutoHide(false)},unfreeze(){this.getPopupInstance().setAutoHide(this.options.autoHide)},getPopupInstance(){if(!this.instance){var t;(t=e.PopupManager.getPopupById(this.id))==null?void 0:t.destroy();this.instance=new e.Popup(this.options)}return this.instance},closePopup(){var t;(t=this.instance)==null?void 0:t.destroy();this.instance=null;this.$emit("close")}},template:`\n\t\t<Teleport :to="popupContainer">\n\t\t\t<slot :adjustPosition="adjustPosition" :freeze="freeze" :unfreeze="unfreeze"></slot>\n\t\t</Teleport>\n\t`};const s={emits:["close","adjustPosition"],props:{id:{type:String,required:true},config:{type:Object,default:{}}},mounted(){this.adjustPosition();i.Event.bind(document,"scroll",this.adjustPosition,true)},beforeUnmount(){i.Event.unbind(document,"scroll",this.adjustPosition,true)},computed:{options(){var t;return{padding:0,background:"transparent",bindOptions:{forceBindPosition:true,forceLeft:true},...this.config,className:`booking-booking-sticky-popup ${(t=this.config.className)!=null?t:""}`}}},methods:{contains(t){return this.$refs.popup.contains(t)},adjustPosition(){this.$refs.popup.adjustPosition();const t=this.config.bindElement.getBoundingClientRect().top+this.config.offsetTop;i.Dom.style(this.$refs.stickyContent,"top",`${t}px`);i.Dom.style(this.$refs.stickyContent,"width",`${this.config.width}px`);i.Dom.style(this.$refs.popup.container,"top",0);this.$emit("adjustPosition")}},components:{Popup:o},template:`\n\t\t<Popup\n\t\t\tv-slot="{freeze, unfreeze}"\n\t\t\t:id="id"\n\t\t\t:config="options"\n\t\t\tref="popup"\n\t\t\t@close="$emit('close')"\n\t\t>\n\t\t\t<div class="booking-booking-sticky-popup-content popup-window" ref="stickyContent">\n\t\t\t\t<slot :freeze="freeze" :unfreeze="unfreeze" :adjustPosition="adjustPosition"></slot>\n\t\t\t</div>\n\t\t</Popup>\n\t`};t.Popup=o;t.StickyPopup=s})(this.BX.Booking.Component=this.BX.Booking.Component||{},BX.Main,BX);
//# sourceMappingURL=popup.bundle.map.js