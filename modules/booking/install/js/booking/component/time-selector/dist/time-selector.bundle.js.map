{"version":3,"file":"time-selector.bundle.js","sources":["../src/lib/time-formatter.js","../src/time-selector.js"],"sourcesContent":["import { DateTimeFormat } from 'main.date';\n\nclass TimeFormatter\n{\n\tparseTime(value: string, previousTimestamp: number): number\n\t{\n\t\tif (this.#isIncorrectTimeValue(value))\n\t\t{\n\t\t\treturn previousTimestamp;\n\t\t}\n\n\t\tlet time = this.getMaskedTime(value);\n\t\ttime = this.#beautifyTime(time);\n\t\tif (DateTimeFormat.isAmPmMode())\n\t\t{\n\t\t\tlet amPmSymbol = (value.toLowerCase().match(/[ap]/g) ?? []).pop();\n\t\t\tif (!amPmSymbol)\n\t\t\t{\n\t\t\t\tconst hour = Number(this.#getMinutesAndHours(time).hours);\n\t\t\t\tif (hour >= 8 && hour <= 11)\n\t\t\t\t{\n\t\t\t\t\tamPmSymbol = 'a';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tamPmSymbol = 'p';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (amPmSymbol === 'a')\n\t\t\t{\n\t\t\t\ttime += ' am';\n\t\t\t}\n\n\t\t\tif (amPmSymbol === 'p')\n\t\t\t{\n\t\t\t\ttime += ' pm';\n\t\t\t}\n\t\t}\n\n\t\treturn new Date(`${DateTimeFormat.format('Y-m-d', previousTimestamp / 1000)} ${time}`).getTime();\n\t}\n\n\tgetMaskedTime(value: string, key: string): string\n\t{\n\t\tlet time = '';\n\t\tconst { hours, minutes } = this.#getMinutesAndHours(value, key);\n\t\tif (hours && !minutes)\n\t\t{\n\t\t\ttime = String(hours);\n\t\t\tif (value.length - time.length === 1 || value.includes(':'))\n\t\t\t{\n\t\t\t\ttime += ':';\n\t\t\t}\n\t\t}\n\n\t\tif (hours && minutes)\n\t\t{\n\t\t\ttime = `${hours}:${minutes}`;\n\t\t}\n\n\t\tif (DateTimeFormat.isAmPmMode() && this.#clearTimeString(time) !== '')\n\t\t{\n\t\t\tconst amPmSymbol = (value.toLowerCase().match(/[ap]/g) ?? []).pop();\n\t\t\tif (amPmSymbol === 'a')\n\t\t\t{\n\t\t\t\ttime = `${this.#beautifyTime(time)} am`;\n\t\t\t}\n\n\t\t\tif (amPmSymbol === 'p')\n\t\t\t{\n\t\t\t\ttime = `${this.#beautifyTime(time)} pm`;\n\t\t\t}\n\t\t}\n\n\t\treturn time;\n\t}\n\n\tformatTime(timestamp: number): string\n\t{\n\t\tconst format = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\treturn DateTimeFormat.format(format, timestamp / 1000);\n\t}\n\n\t#isIncorrectTimeValue(timeValue: string): boolean\n\t{\n\t\tif (DateTimeFormat.isAmPmMode())\n\t\t{\n\t\t\treturn timeValue === '';\n\t\t}\n\n\t\tconst date = new Date(`${DateTimeFormat.format('Y-m-d')} ${timeValue}`);\n\n\t\treturn timeValue === '' || (timeValue[0] !== '0' && date.getHours() === 0);\n\t}\n\n\t#beautifyTime(time: string): string\n\t{\n\t\tif (this.#clearTimeString(time) === '')\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tif (!time.includes(':'))\n\t\t{\n\t\t\ttime += ':00';\n\t\t}\n\n\t\tif (time.indexOf(':') === time.length - 1)\n\t\t{\n\t\t\ttime += '00';\n\t\t}\n\n\t\tlet { hours, minutes } = this.#getMinutesAndHours(time);\n\t\thours = `0${hours}`.slice(-2);\n\t\tminutes = `0${minutes}`.slice(-2);\n\n\t\treturn `${hours}:${minutes}`;\n\t}\n\n\t#getMinutesAndHours(value: string, key: string): { hours: string, minutes: string }\n\t{\n\t\tconst time = this.#clearTimeString(value, key);\n\t\tlet hours = 0;\n\t\tlet minutes = 0;\n\n\t\tif (time.includes(':'))\n\t\t{\n\t\t\thours = time.match(/\\d*:/g)[0].slice(0, -1);\n\t\t\tminutes = time.match(/:\\d*/g)[0].slice(1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst digits = (time.match(/\\d/g) ?? []).splice(0, 4).map((d) => Number(d));\n\t\t\tif (digits.length === 4 && digits[0] > this.#getMaxHours() / 10)\n\t\t\t{\n\t\t\t\tdigits.pop();\n\t\t\t}\n\n\t\t\tif (digits.length === 1)\n\t\t\t{\n\t\t\t\thours = String(digits[0]);\n\t\t\t}\n\n\t\t\tif (digits.length === 2)\n\t\t\t{\n\t\t\t\thours = `${digits[0]}${digits[1]}`;\n\t\t\t\tif (Number(hours) > this.#getMaxHours())\n\t\t\t\t{\n\t\t\t\t\thours = String(digits[0]);\n\t\t\t\t\tminutes = String(digits[1]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (digits.length === 3)\n\t\t\t{\n\t\t\t\tif (DateTimeFormat.isAmPmMode())\n\t\t\t\t{\n\t\t\t\t\tif (digits[0] >= 1)\n\t\t\t\t\t{\n\t\t\t\t\t\thours = String(digits[0]);\n\t\t\t\t\t\tminutes = `${digits[1]}${digits[2]}`;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\thours = `${digits[0]}${digits[1]}`;\n\t\t\t\t\t\tminutes = String(digits[2]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (Number(`${digits[0]}${digits[1]}`) < 24)\n\t\t\t\t{\n\t\t\t\t\thours = `${digits[0]}${digits[1]}`;\n\t\t\t\t\tminutes = String(digits[2]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\thours = String(digits[0]);\n\t\t\t\t\tminutes = `${digits[1]}${digits[2]}`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (digits.length === 4)\n\t\t\t{\n\t\t\t\thours = `${digits[0]}${digits[1]}`;\n\t\t\t\tminutes = `${digits[2]}${digits[3]}`;\n\t\t\t}\n\t\t}\n\n\t\tif (hours)\n\t\t{\n\t\t\thours = this.#formatHours(hours);\n\t\t}\n\n\t\tif (minutes)\n\t\t{\n\t\t\tminutes = this.#formatMinutes(minutes);\n\t\t}\n\n\t\treturn { hours, minutes };\n\t}\n\n\t#clearTimeString(str: string, key: string): string\n\t{\n\t\tlet validatedTime = str.replaceAll(/[ap]/g, '').replaceAll(/\\D/g, ':'); // remove a and p and replace not digits to :\n\t\tvalidatedTime = validatedTime.replace(/:*/, ''); // remove everything before first digit\n\n\t\t// leave only first :\n\t\tconst firstColonIndex = validatedTime.indexOf(':');\n\t\tvalidatedTime = validatedTime.slice(0, firstColonIndex + 1) + validatedTime.slice(firstColonIndex + 1).replaceAll(':', '');\n\n\t\t// leave not more than 2 hour digits and 2 minute digits\n\t\tif (firstColonIndex !== -1)\n\t\t{\n\t\t\tconst hours = this.#formatHours(validatedTime.match(/\\d*:/g)[0].slice(0, -1));\n\t\t\tconst minutes = validatedTime.match(/:\\d*/g)[0].slice(1).slice(0, 3);\n\t\t\tif (hours.length === 1 && minutes.length === 3 && !Number.isNaN(Number(key)) && this.#areTimeDigitsCorrect(`${hours}${minutes}`))\n\t\t\t{\n\t\t\t\treturn `${hours}${minutes}`;\n\t\t\t}\n\n\t\t\treturn `${hours}:${minutes}`;\n\t\t}\n\n\t\treturn validatedTime.slice(0, 4);\n\t}\n\n\t#areTimeDigitsCorrect(time): boolean\n\t{\n\t\tconst hh = time.slice(0, 2);\n\t\tconst mm = time.slice(2);\n\n\t\treturn this.#formatHours(hh) === hh && this.#formatMinutes(mm) === mm;\n\t}\n\n\t#formatHours(hours: string): string\n\t{\n\t\tif (DateTimeFormat.isAmPmMode())\n\t\t{\n\t\t\treturn hours;\n\t\t}\n\n\t\tconst firstDigit = hours[0];\n\t\tif (Number(firstDigit) > this.#getMaxHours() / 10)\n\t\t{\n\t\t\treturn `0${firstDigit}`;\n\t\t}\n\n\t\tif (Number(hours) <= this.#getMaxHours())\n\t\t{\n\t\t\treturn `${firstDigit}${hours[1] ?? ''}`;\n\t\t}\n\n\t\treturn String(firstDigit);\n\t}\n\n\t#formatMinutes(minutes: string): string\n\t{\n\t\tconst firstDigit = minutes[0];\n\n\t\treturn firstDigit >= 6 ? `0${firstDigit}` : `${firstDigit}${minutes[1] ?? ''}`;\n\t}\n\n\t#getMaxHours(): number\n\t{\n\t\treturn DateTimeFormat.isAmPmMode() ? 12 : 24;\n\t}\n}\n\nexport const timeFormatter = new TimeFormatter();\n","import { Event } from 'main.core';\nimport { Menu, MenuManager, MenuItem, type MenuItemOptions } from 'main.popup';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Duration } from 'booking.lib.duration';\nimport { Model } from 'booking.const';\nimport { timeFormatter } from './lib/time-formatter';\nimport './time-selector.css';\n\nconst hour = Duration.getUnitDurations().H;\nconst halfHour = hour / 2;\n\ntype TimeSelectorData = {\n\tisMenuShow: boolean,\n\tfocusByMouseDown: boolean,\n\tmenuShownOnFocus: boolean,\n};\n\nexport const TimeSelector = {\n\temits: ['update:modelValue', 'freeze', 'unfreeze', 'enterSave'],\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tminTs: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\thasError: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): TimeSelectorData\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t\tfocusByMouseDown: false,\n\t\t\tmenuShownOnFocus: false,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.$refs.input.value = this.formatTime(this.timestamp);\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toffset: `${Model.Interface}/offset`,\n\t\t}),\n\t\tid(): string\n\t\t{\n\t\t\treturn 'booking-time-selector-menu';\n\t\t},\n\t\ttimestamp(): number\n\t\t{\n\t\t\treturn this.modelValue;\n\t\t},\n\t},\n\tmethods: {\n\t\tonFocus(): void\n\t\t{\n\t\t\tif (this.isMenuShown)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (!this.isMenuShown)\n\t\t\t\t{\n\t\t\t\t\tthis.menuShownOnFocus = true;\n\t\t\t\t\tthis.showMenu();\n\n\t\t\t\t\tif (!this.focusByMouseDown)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onAfterMenuShown();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 200);\n\t\t},\n\t\tonMouseDown(): void\n\t\t{\n\t\t\tif (!this.isMenuShown)\n\t\t\t{\n\t\t\t\tthis.focusByMouseDown = true;\n\n\t\t\t\tEvent.bind(window, 'dragend', this.onAfterMenuShown);\n\t\t\t\tEvent.bind(window, 'click', this.onAfterMenuShown);\n\t\t\t}\n\t\t},\n\t\tonClick(): void\n\t\t{\n\t\t\tif (this.isMenuShown)\n\t\t\t{\n\t\t\t\tif (!this.menuShownOnFocus)\n\t\t\t\t{\n\t\t\t\t\tthis.hideMenu();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showMenu();\n\t\t\t}\n\t\t},\n\t\tonAfterMenuShown(): void\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.menuShownOnFocus = false;\n\t\t\t\tthis.focusByMouseDown = false;\n\t\t\t\tEvent.unbind(window, 'dragend', this.onAfterMenuShown);\n\t\t\t\tEvent.unbind(window, 'click', this.onAfterMenuShown);\n\t\t\t}, 0);\n\t\t},\n\t\tonKeyDown(event: KeyboardEvent): void\n\t\t{\n\t\t\tif (event.key === 'Enter' && this.timestamp === this.parseTime(this.$refs.input.value))\n\t\t\t{\n\t\t\t\tthis.$emit('enterSave');\n\t\t\t}\n\n\t\t\tthis.hideMenu();\n\t\t},\n\t\tshowMenu(): void\n\t\t{\n\t\t\tMenuManager.show({\n\t\t\t\tid: this.id,\n\t\t\t\tclassName: 'booking-time-selector-menu',\n\t\t\t\tbindElement: this.$refs.input,\n\t\t\t\titems: this.getMenuItems(),\n\t\t\t\tautoHide: true,\n\t\t\t\tmaxHeight: 300,\n\t\t\t\tminWidth: this.$refs.input.offsetWidth,\n\t\t\t\tevents: {\n\t\t\t\t\tonShow: this.onShow,\n\t\t\t\t\tonClose: this.hideMenu,\n\t\t\t\t\tonDestroy: this.hideMenu,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.getMenu().getPopupWindow().autoHideHandler = ({ target }) => {\n\t\t\t\tconst popup = this.getMenu().getPopupWindow();\n\t\t\t\tconst shouldHide = target !== popup.getPopupContainer() && !popup.getPopupContainer().contains(target);\n\n\t\t\t\treturn shouldHide && !this.menuShownOnFocus;\n\t\t\t};\n\n\t\t\tthis.scrollToClosestItem();\n\t\t},\n\t\tgetMenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\tconst date = new Date(this.timestamp);\n\t\t\tconst dateTs = new Date(date.getFullYear(), date.getMonth(), date.getDate()).getTime() - this.offset;\n\n\t\t\tconst timestamps = Array.from({ length: 49 }).fill(0)\n\t\t\t\t.map((_, i) => dateTs + i * halfHour)\n\t\t\t\t.filter((timestamp: number) => timestamp >= this.minTs + hour)\n\t\t\t;\n\n\t\t\tif (this.minTs > 0 && timestamps[0] - (this.minTs + hour) >= hour / 4)\n\t\t\t{\n\t\t\t\ttimestamps.unshift(this.minTs + hour);\n\t\t\t}\n\n\t\t\tif (this.minTs > 0)\n\t\t\t{\n\t\t\t\ttimestamps.unshift(this.minTs + hour / 4, this.minTs + hour / 2, this.minTs + 3 * hour / 4);\n\t\t\t}\n\n\t\t\treturn timestamps.map((timestamp: number): MenuItemOptions => ({\n\t\t\t\tid: timestamp,\n\t\t\t\thtml: `\n\t\t\t\t\t<span\n\t\t\t\t\t\tdata-element=\"booking-time-selector-item\"\n\t\t\t\t\t\tdata-timestamp=\"${timestamp}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${this.formatTime(timestamp)}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"menu-popup-item-hint\">${this.getDurationHint(timestamp)}</span>\n\t\t\t\t`,\n\t\t\t\tclassName: timestamp === this.timestamp ? 'menu-popup-no-icon --selected' : 'menu-popup-no-icon',\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.$emit('update:modelValue', timestamp);\n\t\t\t\t\tthis.getMenu().close();\n\t\t\t\t},\n\t\t\t}));\n\t\t},\n\t\tgetDurationHint(timestamp: string): string\n\t\t{\n\t\t\tif (this.minTs > 0)\n\t\t\t{\n\t\t\t\tconst diff = timestamp - this.minTs;\n\t\t\t\tif (diff < hour)\n\t\t\t\t{\n\t\t\t\t\treturn new Duration(diff).format();\n\t\t\t\t}\n\n\t\t\t\tconst roundedDiff = Math.round(diff / halfHour) * halfHour;\n\t\t\t\tconst hint = new Duration(roundedDiff).format();\n\n\t\t\t\treturn diff === roundedDiff ? hint : this.loc('BOOKING_TIME_SELECTOR_APPROXIMATE_VALUE', {\n\t\t\t\t\t'#VALUE#': hint,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tscrollToClosestItem(): void\n\t\t{\n\t\t\tconst closest = this.getMenu().getMenuItems().reduce((prev: MenuItem, curr: MenuItem): MenuItem => {\n\t\t\t\treturn (Math.abs(curr.getId() - this.timestamp) < Math.abs(prev.getId() - this.timestamp) ? curr : prev);\n\t\t\t});\n\n\t\t\tconst closestItemNode = closest?.getLayout()?.item;\n\t\t\tif (!closestItemNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuContainer = this.getMenu().getPopupWindow().getContentContainer();\n\n\t\t\tmenuContainer.scrollTop = closestItemNode.offsetTop - closestItemNode.offsetHeight - 36 * 3;\n\t\t},\n\t\tisShown(): boolean\n\t\t{\n\t\t\treturn this.getMenu()?.getPopupWindow().isShown() ?? false;\n\t\t},\n\t\tadjustMenuPosition(): void\n\t\t{\n\t\t\tthis.getMenu()?.getPopupWindow().adjustPosition();\n\t\t},\n\t\tgetMenu(): Menu | null\n\t\t{\n\t\t\treturn MenuManager.getMenuById(this.id);\n\t\t},\n\t\tonShow(): void\n\t\t{\n\t\t\tthis.isMenuShown = true;\n\t\t\tthis.freeze();\n\t\t\tthis.$refs.input.select();\n\t\t},\n\t\thideMenu(): void\n\t\t{\n\t\t\tthis.isMenuShown = false;\n\t\t\tthis.unfreeze();\n\t\t\tMenuManager.destroy(this.id);\n\t\t},\n\t\tfreeze(): void\n\t\t{\n\t\t\tthis.$emit('freeze');\n\t\t},\n\t\tunfreeze(): void\n\t\t{\n\t\t\tthis.$emit('unfreeze');\n\t\t},\n\t\tonInput(event: InputEvent): void\n\t\t{\n\t\t\tconst input = this.$refs.input;\n\n\t\t\tif (event.inputType === 'deleteContentBackward')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tinput.value = timeFormatter.getMaskedTime(input.value, event.data);\n\n\t\t\tif (input.value === this.formatTime(this.parseTime(input.value)))\n\t\t\t{\n\t\t\t\tthis.onChange();\n\t\t\t}\n\t\t},\n\t\tonChange(): void\n\t\t{\n\t\t\tlet timestamp = this.parseTime(this.$refs.input.value);\n\n\t\t\tif (timestamp < this.minTs)\n\t\t\t{\n\t\t\t\tconst value = this.formatTime(timestamp);\n\t\t\t\tconst validItem = this.getMenuItems().find((item: MenuItemOptions) => item.text === value);\n\t\t\t\ttimestamp = validItem?.id ?? timestamp;\n\t\t\t}\n\n\t\t\tthis.$refs.input.value = this.formatTime(timestamp);\n\n\t\t\tthis.$emit('update:modelValue', timestamp);\n\t\t},\n\t\tformatTime(timestamp: number): string\n\t\t{\n\t\t\treturn timeFormatter.formatTime(timestamp + this.offset);\n\t\t},\n\t\tparseTime(value: string): number\n\t\t{\n\t\t\treturn timeFormatter.parseTime(value, this.timestamp + this.offset) - this.offset;\n\t\t},\n\t},\n\twatch: {\n\t\tmodelValue(): void\n\t\t{\n\t\t\tthis.$refs.input.value = this.formatTime(this.timestamp);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-time-selector\"\n\t\t\t:class=\"{'--menu-shown': isMenuShown}\"\n\t\t>\n\t\t\t<input\n\t\t\t\tclass=\"booking-time-selector-input\"\n\t\t\t\t:class=\"{'--error': hasError}\"\n\t\t\t\tref=\"input\"\n\t\t\t\t@focus=\"onFocus\"\n\t\t\t\t@mousedown=\"onMouseDown\"\n\t\t\t\t@click=\"onClick\"\n\t\t\t\t@keydown=\"onKeyDown\"\n\t\t\t\t@input=\"onInput\"\n\t\t\t\t@change=\"onChange\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tclass=\"ui-icon-set --chevron-down\"\n\t\t\t></div>\n\t\t</div>\n\t`,\n};\n"],"names":["TimeFormatter","parseTime","value","previousTimestamp","time","getMaskedTime","DateTimeFormat","isAmPmMode","amPmSymbol","toLowerCase","match","pop","hour","Number","hours","Date","format","getTime","key","minutes","String","length","includes","formatTime","timestamp","getFormat","timeValue","date","getHours","indexOf","slice","digits","splice","map","d","str","validatedTime","replaceAll","replace","firstColonIndex","isNaN","hh","mm","firstDigit","timeFormatter","Duration","getUnitDurations","H","halfHour","TimeSelector","emits","props","modelValue","type","required","minTs","default","hasError","Boolean","data","isMenuShown","focusByMouseDown","menuShownOnFocus","mounted","$refs","input","computed","mapGetters","offset","Model","Interface","id","methods","onFocus","setTimeout","showMenu","onAfterMenuShown","onMouseDown","Event","bind","window","onClick","hideMenu","unbind","onKeyDown","event","$emit","MenuManager","show","className","bindElement","items","getMenuItems","autoHide","maxHeight","minWidth","offsetWidth","events","onShow","onClose","onDestroy","getMenu","getPopupWindow","autoHideHandler","target","popup","shouldHide","getPopupContainer","contains","scrollToClosestItem","dateTs","getFullYear","getMonth","getDate","timestamps","Array","from","fill","_","i","filter","unshift","html","getDurationHint","onclick","close","diff","roundedDiff","Math","round","hint","loc","closest","reduce","prev","curr","abs","getId","closestItemNode","getLayout","item","menuContainer","getContentContainer","scrollTop","offsetTop","offsetHeight","isShown","adjustMenuPosition","adjustPosition","getMenuById","freeze","select","unfreeze","destroy","onInput","inputType","onChange","validItem","find","text","watch","template"],"mappings":"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"}