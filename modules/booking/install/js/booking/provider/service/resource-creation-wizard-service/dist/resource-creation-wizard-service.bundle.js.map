{"version":3,"file":"resource-creation-wizard-service.bundle.js","sources":["../src/data-extractor.js","../src/resource-creation-wizard-service.js"],"sourcesContent":["import type { SlotRange } from 'booking.model.resources';\nimport type { AdvertisingResourceType, NotificationsSettings } from './types';\n\nexport class ResourceCreationWizardDataExtractor\n{\n\t#data;\n\n\tconstructor(data)\n\t{\n\t\tthis.#data = data;\n\t}\n\n\tgetAdvertisingResourceTypes(): AdvertisingResourceType[]\n\t{\n\t\treturn this.#data.advertisingResourceTypes ?? [];\n\t}\n\n\tgetNotificationsSettings(): NotificationsSettings\n\t{\n\t\treturn this.#data.notificationsSettings;\n\t}\n\n\tgetCompanyScheduleSlots(): SlotRange[]\n\t{\n\t\treturn this.#data.companyScheduleSlots;\n\t}\n\n\tisCompanyScheduleAccess(): boolean\n\t{\n\t\treturn Boolean(this.#data.isCompanyScheduleAccess);\n\t}\n\n\tgetWeekStart(): string\n\t{\n\t\treturn this.#data.weekStart;\n\t}\n}\n","import { Core } from 'booking.core';\nimport { ApiClient } from 'booking.lib.api-client';\nimport { Model } from 'booking.const';\nimport { ResourceCreationWizardDataExtractor } from './data-extractor';\n\nclass ResourceCreationWizardService\n{\n\tasync fetchData(): Promise<void>\n\t{\n\t\tawait this.loadData();\n\t}\n\n\tasync loadData()\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst api = new ApiClient();\n\t\t\tconst data = await api.post('ResourceWizard.get', {});\n\n\t\t\tconst extractor = new ResourceCreationWizardDataExtractor(data);\n\t\t\tconst store = Core.getStore();\n\n\t\t\tconst { notifications, senders } = extractor.getNotificationsSettings();\n\n\t\t\tawait Promise.all([\n\t\t\t\tstore.dispatch(\n\t\t\t\t\t`${Model.ResourceCreationWizard}/setAdvertisingResourceTypes`,\n\t\t\t\t\textractor.getAdvertisingResourceTypes(),\n\t\t\t\t),\n\t\t\t\tstore.dispatch(`${Model.Notifications}/upsertMany`, notifications),\n\t\t\t\tstore.dispatch(`${Model.Notifications}/upsertManySenders`, senders),\n\t\t\t\tstore.dispatch(\n\t\t\t\t\t`${Model.ResourceCreationWizard}/setCompanyScheduleSlots`,\n\t\t\t\t\textractor.getCompanyScheduleSlots(),\n\t\t\t\t),\n\t\t\t\tstore.dispatch(\n\t\t\t\t\t`${Model.ResourceCreationWizard}/setCompanyScheduleAccess`,\n\t\t\t\t\textractor.isCompanyScheduleAccess(),\n\t\t\t\t),\n\t\t\t\tstore.dispatch(\n\t\t\t\t\t`${Model.ResourceCreationWizard}/setWeekStart`,\n\t\t\t\t\textractor.getWeekStart(),\n\t\t\t\t),\n\t\t\t]);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('ResourceCreationWizardService load data error', error);\n\t\t}\n\t}\n}\n\nexport const resourceCreationWizardService = new ResourceCreationWizardService();\n"],"names":["ResourceCreationWizardDataExtractor","constructor","data","getAdvertisingResourceTypes","advertisingResourceTypes","getNotificationsSettings","notificationsSettings","getCompanyScheduleSlots","companyScheduleSlots","isCompanyScheduleAccess","Boolean","getWeekStart","weekStart","ResourceCreationWizardService","fetchData","loadData","api","ApiClient","post","extractor","store","Core","getStore","notifications","senders","Promise","all","dispatch","Model","ResourceCreationWizard","Notifications","error","console","resourceCreationWizardService"],"mappings":";;;;;;;;AAGA,CAAO,MAAMA,mCAAmC,CAChD;GAGCC,WAAW,CAACC,IAAI,EAChB;KAAA;OAAA;OAAA;;KACC,4CAAI,kBAASA,IAAI;;GAGlBC,2BAA2B,GAC3B;KAAA;KACC,gCAAO,4CAAI,gBAAOC,wBAAwB,oCAAI,EAAE;;GAGjDC,wBAAwB,GACxB;KACC,OAAO,4CAAI,gBAAOC,qBAAqB;;GAGxCC,uBAAuB,GACvB;KACC,OAAO,4CAAI,gBAAOC,oBAAoB;;GAGvCC,uBAAuB,GACvB;KACC,OAAOC,OAAO,CAAC,4CAAI,gBAAOD,uBAAuB,CAAC;;GAGnDE,YAAY,GACZ;KACC,OAAO,4CAAI,gBAAOC,SAAS;;CAE7B;;CC/BA,MAAMC,6BAA6B,CACnC;GACC,MAAMC,SAAS,GACf;KACC,MAAM,IAAI,CAACC,QAAQ,EAAE;;GAGtB,MAAMA,QAAQ,GACd;KACC,IACA;OACC,MAAMC,GAAG,GAAG,IAAIC,+BAAS,EAAE;OAC3B,MAAMf,IAAI,GAAG,MAAMc,GAAG,CAACE,IAAI,CAAC,oBAAoB,EAAE,EAAE,CAAC;OAErD,MAAMC,SAAS,GAAG,IAAInB,mCAAmC,CAACE,IAAI,CAAC;OAC/D,MAAMkB,KAAK,GAAGC,iBAAI,CAACC,QAAQ,EAAE;OAE7B,MAAM;SAAEC,aAAa;SAAEC;QAAS,GAAGL,SAAS,CAACd,wBAAwB,EAAE;OAEvE,MAAMoB,OAAO,CAACC,GAAG,CAAC,CACjBN,KAAK,CAACO,QAAQ,CACZ,GAAEC,mBAAK,CAACC,sBAAuB,8BAA6B,EAC7DV,SAAS,CAAChB,2BAA2B,EAAE,CACvC,EACDiB,KAAK,CAACO,QAAQ,CAAE,GAAEC,mBAAK,CAACE,aAAc,aAAY,EAAEP,aAAa,CAAC,EAClEH,KAAK,CAACO,QAAQ,CAAE,GAAEC,mBAAK,CAACE,aAAc,oBAAmB,EAAEN,OAAO,CAAC,EACnEJ,KAAK,CAACO,QAAQ,CACZ,GAAEC,mBAAK,CAACC,sBAAuB,0BAAyB,EACzDV,SAAS,CAACZ,uBAAuB,EAAE,CACnC,EACDa,KAAK,CAACO,QAAQ,CACZ,GAAEC,mBAAK,CAACC,sBAAuB,2BAA0B,EAC1DV,SAAS,CAACV,uBAAuB,EAAE,CACnC,EACDW,KAAK,CAACO,QAAQ,CACZ,GAAEC,mBAAK,CAACC,sBAAuB,eAAc,EAC9CV,SAAS,CAACR,YAAY,EAAE,CACxB,CACD,CAAC;MACF,CACD,OAAOoB,KAAK,EACZ;OACCC,OAAO,CAACD,KAAK,CAAC,+CAA+C,EAAEA,KAAK,CAAC;;;CAGxE;AAEA,OAAaE,6BAA6B,GAAG,IAAIpB,6BAA6B,EAAE;;;;;;;;"}