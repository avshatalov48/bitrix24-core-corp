{"version":3,"file":"main-page-service.bundle.js","sources":["../src/main-page-data-extractor.js","../src/counters-extractor.js","../src/main-page-service.js"],"sourcesContent":["import { CrmEntity } from 'booking.const';\nimport { BookingMappers } from 'booking.provider.service.booking-service';\nimport { ClientMappers } from 'booking.provider.service.client-service';\nimport { ResourceMappers } from 'booking.provider.service.resources-service';\nimport { ResourceTypeMappers } from 'booking.provider.service.resources-type-service';\n\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { BookingDto } from 'booking.provider.service.booking-service';\nimport type { CountersModel } from 'booking.model.counters';\nimport type { ClientModel } from 'booking.model.clients';\nimport type { ClientDto } from 'booking.provider.service.client-service';\nimport type { ResourceModel } from 'booking.model.resources';\nimport type { ResourceDto } from 'booking.provider.service.resources-service';\nimport type { ResourceTypeModel } from 'booking.model.resource-types';\nimport type { ResourceTypeDto } from 'booking.provider.service.resources-type-service';\n\nimport type { MainPageGetResponse } from './types';\n\nexport class MainPageDataExtractor\n{\n\t#response: MainPageGetResponse;\n\n\tconstructor(response: MainPageGetResponse)\n\t{\n\t\tthis.#response = response;\n\t}\n\n\tgetFavoriteIds(): number[]\n\t{\n\t\treturn this.#response.favorites.resources.map((resource: ResourceDto) => resource.id);\n\t}\n\n\tgetBookings(): BookingModel[]\n\t{\n\t\treturn this.#response.bookings.map((booking: BookingDto): BookingModel => {\n\t\t\treturn BookingMappers.mapDtoToModel(booking);\n\t\t});\n\t}\n\n\tgetClientsProviderModuleId(): string\n\t{\n\t\treturn this.#response.clients.providerModuleId;\n\t}\n\n\tgetClients(): ClientModel[]\n\t{\n\t\treturn [\n\t\t\t...this.#extractClients(CrmEntity.Contact),\n\t\t\t...this.#extractClients(CrmEntity.Company),\n\t\t\t...this.#extractClientsFromBookings(),\n\t\t];\n\t}\n\n\t#extractClients(code: string): ClientModel[]\n\t{\n\t\tconst module = this.#response.clients.providerModuleId;\n\t\tif (!module)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn Object.values(this.#response.clients.recent[code]).map((client): ClientModel => ({\n\t\t\t...client,\n\t\t\ttype: { module, code },\n\t\t}));\n\t}\n\n\t#extractClientsFromBookings(): ClientModel[]\n\t{\n\t\treturn this.#response.bookings\n\t\t\t.flatMap(({ clients }) => clients.map((client: ClientDto): ClientModel => {\n\t\t\t\treturn ClientMappers.mapDtoToModel(client);\n\t\t\t}));\n\t}\n\n\tgetCounters(): CountersModel\n\t{\n\t\treturn this.#response.counters;\n\t}\n\n\tgetResources(): ResourceModel[]\n\t{\n\t\tconst favoriteResources = this.#response.favorites?.resources ?? [];\n\t\tconst bookingResources = this.#response.bookings.flatMap(({ resources }) => resources);\n\n\t\tconst result = {};\n\t\t[...favoriteResources, ...bookingResources].forEach((resourceDto: ResourceDto) => {\n\t\t\tresult[resourceDto.id] ??= ResourceMappers.mapDtoToModel(resourceDto);\n\t\t});\n\n\t\treturn Object.values(result);\n\t}\n\n\tgetResourceTypes(): ResourceTypeModel[]\n\t{\n\t\treturn this.#response.resourceTypes.map((resourceTypeDto: ResourceTypeDto): ResourceTypeModel => {\n\t\t\treturn ResourceTypeMappers.mapDtoToModel(resourceTypeDto);\n\t\t});\n\t}\n\n\tgetIntersectionMode(): boolean\n\t{\n\t\treturn this.#response.isIntersectionForAll;\n\t}\n\n\tgetIsCurrentSenderAvailable(): boolean\n\t{\n\t\treturn this.#response.isCurrentSenderAvailable;\n\t}\n}\n","import type { CountersModel } from 'booking.model.counters';\nimport type { MainPageGetCountersResponse, MoneyStatisticsDto } from './types';\n\nexport class CountersExtractor\n{\n\t#response: MainPageGetCountersResponse;\n\n\tconstructor(response: MainPageGetCountersResponse)\n\t{\n\t\tthis.#response = response;\n\t}\n\n\tgetCounters(): CountersModel\n\t{\n\t\treturn this.#response.counters;\n\t}\n\n\tgetTotalClients(): number\n\t{\n\t\treturn this.#response.clientStatistics.total;\n\t}\n\n\tgetTotalNewClientsToday(): number\n\t{\n\t\treturn this.#response.clientStatistics.totalToday;\n\t}\n\n\tgetMoneyStatistics(): MoneyStatisticsDto\n\t{\n\t\treturn this.#response.moneyStatistics;\n\t}\n}\n","import { Core } from 'booking.core';\nimport { Model } from 'booking.const';\nimport { resourcesDateCache } from 'booking.lib.resources-date-cache';\nimport { ApiClient } from 'booking.lib.api-client';\nimport type { BookingModel } from 'booking.model.bookings';\n\nimport { MainPageDataExtractor } from './main-page-data-extractor';\nimport { CountersExtractor } from './counters-extractor';\n\nclass MainPageService\n{\n\t#dateCache: number[] = [];\n\n\tclearCache(ids: number[]): void\n\t{\n\t\tthis.#dateCache = this.#dateCache.filter((date: number) => resourcesDateCache.isDateLoaded(date, ids));\n\t}\n\n\tasync fetchData(dateTs: number): Promise<void>\n\t{\n\t\tif (this.#dateCache.includes(dateTs))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#dateCache.push(dateTs);\n\n\t\tawait this.loadData(dateTs);\n\t}\n\n\tasync loadData(dateTs: number): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tif (Core.getStore().getters[`${Model.Interface}/isEditingBookingMode`])\n\t\t\t{\n\t\t\t\tawait this.#requestDataForBooking(dateTs);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tawait this.#requestData(dateTs);\n\t\t\t}\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('BookingMainPageGetRequest: error', error);\n\t\t}\n\t}\n\n\tasync #requestData(dateTs: number): Promise<void>\n\t{\n\t\tconst data = await new ApiClient().get('MainPage.get', { dateTs });\n\t\tconst extractor = new MainPageDataExtractor(data);\n\n\t\tresourcesDateCache.upsertIds(dateTs, extractor.getFavoriteIds());\n\n\t\tawait Promise.all([\n\t\t\tCore.getStore().dispatch(`${Model.Favorites}/set`, extractor.getFavoriteIds()),\n\t\t\tCore.getStore().dispatch(`${Model.Interface}/setResourcesIds`, extractor.getFavoriteIds()),\n\t\t\tCore.getStore().dispatch(`${Model.Interface}/setIntersectionMode`, extractor.getIntersectionMode()),\n\t\t\tCore.getStore().dispatch(`${Model.Resources}/upsertMany`, extractor.getResources()),\n\t\t\tCore.getStore().dispatch(`${Model.ResourceTypes}/upsertMany`, extractor.getResourceTypes()),\n\t\t\tCore.getStore().dispatch(`${Model.Counters}/set`, extractor.getCounters()),\n\t\t\tCore.getStore().dispatch(`${Model.Bookings}/upsertMany`, extractor.getBookings()),\n\t\t\tCore.getStore().dispatch(`${Model.Clients}/upsertMany`, extractor.getClients()),\n\t\t\tCore.getStore().dispatch(`${Model.Clients}/setProviderModuleId`, extractor.getClientsProviderModuleId()),\n\t\t\tCore.getStore().dispatch(`${Model.Interface}/setIsCurrentSenderAvailable`, extractor.getIsCurrentSenderAvailable()),\n\t\t]);\n\t}\n\n\tasync #requestDataForBooking(dateTs: number): Promise<void>\n\t{\n\t\tconst bookingId = Core.getParams().editingBookingId;\n\t\tconst timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n\t\tconst resourcesIds = Core.getStore().getters[`${Model.Favorites}/get`];\n\n\t\tconst data = await new ApiClient().get('MainPage.getForBooking', { dateTs, bookingId, timezone, resourcesIds });\n\n\t\tconst extractor = new MainPageDataExtractor(data);\n\n\t\tconst promises = [\n\t\t\tCore.getStore().dispatch(`${Model.Interface}/setIntersectionMode`, extractor.getIntersectionMode()),\n\t\t\tCore.getStore().dispatch(`${Model.Resources}/upsertMany`, extractor.getResources()),\n\t\t\tCore.getStore().dispatch(`${Model.ResourceTypes}/upsertMany`, extractor.getResourceTypes()),\n\t\t\tCore.getStore().dispatch(`${Model.Counters}/set`, extractor.getCounters()),\n\t\t\tCore.getStore().dispatch(`${Model.Bookings}/upsertMany`, extractor.getBookings()),\n\t\t\tCore.getStore().dispatch(`${Model.Clients}/upsertMany`, extractor.getClients()),\n\t\t\tCore.getStore().dispatch(`${Model.Clients}/setProviderModuleId`, extractor.getClientsProviderModuleId()),\n\t\t\tCore.getStore().dispatch(`${Model.Interface}/setIsCurrentSenderAvailable`, extractor.getIsCurrentSenderAvailable()),\n\t\t];\n\n\t\tconst editingBooking = extractor.getBookings()\n\t\t\t.find((booking: BookingModel) => booking.id === bookingId)\n\t\t;\n\n\t\tif (!editingBooking && dateTs === 0)\n\t\t{\n\t\t\tpromises.push(\n\t\t\t\tCore.getStore().dispatch(`${Model.Interface}/setEditingBookingId`, 0),\n\t\t\t);\n\t\t}\n\n\t\tlet selectedDate = new Date(dateTs * 1000);\n\t\tif (editingBooking && dateTs === 0)\n\t\t{\n\t\t\tconst dateFrom = new Date(editingBooking.dateFromTs);\n\t\t\tselectedDate = new Date(dateFrom.getFullYear(), dateFrom.getMonth(), dateFrom.getDate());\n\n\t\t\tpromises.push(\n\t\t\t\tCore.getStore().dispatch(`${Model.Interface}/setSelectedDateTs`, selectedDate.getTime()),\n\t\t\t);\n\n\t\t\tthis.#dateCache.push(selectedDate.getTime() / 1000);\n\t\t}\n\n\t\tlet selectedResourcesIds = resourcesIds;\n\t\tif (editingBooking && resourcesIds.length === 0)\n\t\t{\n\t\t\tselectedResourcesIds = [editingBooking.resourcesIds[0]];\n\n\t\t\tpromises.push(\n\t\t\t\tCore.getStore().dispatch(`${Model.Favorites}/set`, [editingBooking.resourcesIds[0]]),\n\t\t\t\tCore.getStore().dispatch(`${Model.Interface}/setResourcesIds`, [editingBooking.resourcesIds[0]]),\n\t\t\t);\n\t\t}\n\n\t\tresourcesDateCache.upsertIds(selectedDate.getTime() / 1000, selectedResourcesIds);\n\n\t\tawait Promise.all(promises);\n\t}\n\n\tasync fetchCounters(): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst data = await new ApiClient().get('MainPage.getCounters');\n\n\t\t\tconst extractor = new CountersExtractor(data);\n\n\t\t\tawait Promise.all([\n\t\t\t\tCore.getStore().dispatch(`${Model.Interface}/setTotalClients`, extractor.getTotalClients()),\n\t\t\t\tCore.getStore().dispatch(`${Model.Interface}/setTotalNewClientsToday`, extractor.getTotalNewClientsToday()),\n\t\t\t\tCore.getStore().dispatch(`${Model.Interface}/setMoneyStatistics`, extractor.getMoneyStatistics()),\n\t\t\t\tCore.getStore().dispatch(`${Model.Counters}/set`, extractor.getCounters()),\n\t\t\t]);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('BookingMainPageGetCountersRequest: error', error);\n\t\t}\n\t}\n\n\tasync activateDemo(): Promise<boolean>\n\t{\n\t\ttry\n\t\t{\n\t\t\treturn await new ApiClient().get('MainPage.activateDemo');\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('BookingMainPageActivateDemoRequest: error', error);\n\t\t}\n\n\t\treturn Promise.resolve(false);\n\t}\n}\n\nexport const mainPageService = new MainPageService();\n"],"names":["MainPageDataExtractor","constructor","response","getFavoriteIds","favorites","resources","map","resource","id","getBookings","bookings","booking","BookingMappers","mapDtoToModel","getClientsProviderModuleId","clients","providerModuleId","getClients","CrmEntity","Contact","Company","getCounters","counters","getResources","favoriteResources","bookingResources","flatMap","result","forEach","resourceDto","ResourceMappers","Object","values","getResourceTypes","resourceTypes","resourceTypeDto","ResourceTypeMappers","getIntersectionMode","isIntersectionForAll","getIsCurrentSenderAvailable","isCurrentSenderAvailable","code","module","recent","client","type","ClientMappers","CountersExtractor","getTotalClients","clientStatistics","total","getTotalNewClientsToday","totalToday","getMoneyStatistics","moneyStatistics","MainPageService","clearCache","ids","filter","date","resourcesDateCache","isDateLoaded","fetchData","dateTs","includes","push","loadData","Core","getStore","getters","Model","Interface","error","console","fetchCounters","data","ApiClient","get","extractor","Promise","all","dispatch","Counters","activateDemo","resolve","upsertIds","Favorites","Resources","ResourceTypes","Bookings","Clients","bookingId","getParams","editingBookingId","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","resourcesIds","promises","editingBooking","find","selectedDate","Date","dateFrom","dateFromTs","getFullYear","getMonth","getDate","getTime","selectedResourcesIds","length","mainPageService"],"mappings":"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"}