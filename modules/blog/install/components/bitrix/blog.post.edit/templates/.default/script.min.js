function show_special(){var e=document.getElementById("special_perms");if(document.getElementById("blog_perms_1").checked===true)e.style.display="block";else e.style.display="none"}function changeDate(){document.getElementById("date-publ").style.display="block";document.getElementById("date-publ-text").style.display="none";document.getElementById("DATE_PUBLISH_DEF").value=""}BlogPostAutoSaveIcon=function(){var e="POST_BLOG_FORM";var t=BX(e);if(!t)return;var o=BX("post-form-autosave-icon");var a=BX.findChild(t,{className:/lhe-stat-toolbar-cont/},true,true);if(a.length<1)return false;var r=a[a.length-1];r.insertBefore(o,r.children[0])};BlogPostAutoSave=function(){var e="POST_BLOG_FORM";var t=BX(e);if(!t)return;var o="POST_MESSAGE";var a="POST_TITLE";var r=BX(a);var i=BX(e).TAGS;var n="blogPostAutoSave";var s="blogPostAutoRestore";var d=BX.message("AUTOSAVE_R");var l=BX.message("BLOG_POST_AUTOSAVE");var u=null;var c=BX.create("A",{attr:{href:"javascript:void(0)"},props:{className:n+" bx-core-autosave bx-core-autosave-ready",title:BX.message("AUTOSAVE_T"),id:"post-form-autosave-icon"}});BX("blog-post-autosave-hidden").appendChild(c);var f=function(e){if(window.oBlogLHE){window.oBlogLHE.fAutosave=e;BX.bind(window.oBlogLHE.pEditorDocument,"keydown",BX.proxy(e.Init,e));BX.bind(window.oBlogLHE.pTextarea,"keydown",BX.proxy(e.Init,e));BX.bind(r,"keydown",BX.proxy(e.Init,e));BX.bind(i,"keydown",BX.proxy(e.Init,e))}};BX.addCustomEvent(t,"onAutoSavePrepare",function(e,t){e.DISABLE_STANDARD_NOTIFY=true;BX.bind(c,"click",BX.proxy(e.Save,e));var o=e;setTimeout(function(){f(o)},1500)});BX.addCustomEvent(t,"onAutoSave",function(t,r){BX.removeClass(c,"bx-core-autosave-edited");BX.removeClass(c,"bx-core-autosave-ready");BX.addClass(c,"bx-core-autosave-saving");if(!window.oBlogLHE)return;r[o+"_type"]=window.oBlogLHE.sEditorMode;var n="";if(window.oBlogLHE.sEditorMode=="code")n=window.oBlogLHE.GetCodeEditorContent();else n=window.oBlogLHE.GetEditorContent();r[o]=n;r[a]=BX(a).value;r[i]=BX(e).TAGS.value});BX.addCustomEvent(t,"onAutoSaveFinished",function(e,t){t=parseInt(t);if(!isNaN(t)){setTimeout(function(){BX.removeClass(c,"bx-core-autosave-saving");BX.addClass(c,"bx-core-autosave-ready")},1e3);c.title=BX.message("AUTOSAVE_L").replace("#DATE#",BX.formatDate(new Date(t*1e3)))}});BX.addCustomEvent(t,"onAutoSaveInit",function(){BX.removeClass(c,"bx-core-autosave-ready");BX.addClass(c,"bx-core-autosave-edited")});BX.addCustomEvent(t,"onAutoSaveRestoreFound",function(e,t){var r=BX.util.trim(t[o])||"",i=BX.util.trim(t[a])||"";if(r.length<1&&i.length<1)return;e.Restore()});BX.addCustomEvent(t,"onAutoSaveRestore",function(t,r){if(!window.oBlogLHE||!r[o])return;window.oBlogLHE.SetView(r[o+"_type"]);if(!!window.oBlogLHE.sourseBut)window.oBlogLHE.sourseBut.Check(r[o+"_type"]=="code");if(r[o+"_type"]=="code")window.oBlogLHE.SetContent(r[o]);else window.oBlogLHE.SetEditorContent(r[o]);BX(a).value=r[a];BX(e).TAGS.value=r[i];f(t)});BX.addCustomEvent(t,"onAutoSaveRestoreFinished",function(e,t){if(!!u)BX.remove(u)})};function blogShowFile(){BX.toggle(BX("blog-upload-file"));BX.onCustomEvent(BX("blog-post-user-fields-UF_BLOG_POST_DOC"),"BFileDLoadFormController")}var formParams={},reinit=function(e){if(formParams[e]&&formParams[e]["editorID"]){if(formParams[e]["editor"])formParams[e]["editor"](formParams[e]["text"]);else setTimeout(function(){reinit(e)},50)}};BX.BlogPostInit=function(e,t){formParams={};formParams[e]={editorID:t["editorID"],showTitle:!!t["showTitle"],submitted:false,text:t["text"],autoSave:t["autoSave"],handler:window.LHEPostForm&&window.LHEPostForm.getHandler(t["editorID"]),editor:window.LHEPostForm&&window.LHEPostForm.getEditor(t["editorID"]),restoreAutosave:!!t["restoreAutosave"]};var o=function(t,o){if(o==e){formParams[e]["handler"]=t;var a=function(){var e=[BX("feed-add-post-form-notice-blockblogPostForm"),BX("feed-add-buttons-blockblogPostForm"),BX("feed-add-post-content-message-add-ins")];for(var t=0;t<e.length;t++){if(!!e[t]){BX.adjust(e[t],{style:{display:"block",height:"auto",opacity:1}})}}},r=function(){var t,o=[BX("feed-add-post-form-notice-blockblogPostForm"),BX("feed-add-buttons-blockblogPostForm"),BX("feed-add-post-content-message-add-ins")];for(t=0;t<o.length;t++){if(!!o[t]){BX.adjust(o[t],{style:{display:"block",height:"0px",opacity:0}})}}if(formParams[e]["showTitle"])window["showPanelTitle_"+e](false,false)};BX.addCustomEvent(t.eventNode,"OnAfterShowLHE",a);BX.addCustomEvent(t.eventNode,"OnAfterHideLHE",r);if(t.eventNode.style.display=="none")r();else a()}},a=function(t){if(t.id==formParams[e]["editorID"]){formParams[e]["editor"]=t;if(formParams[e]["autoSave"]!="N")new BlogPostAutoSave(formParams[e]["autoSave"],formParams[e]["restoreAutosave"]);var o=window[t.id+"Files"],a=window.LHEPostForm.getHandler(t.id),r,i,n,s=[],d=null;for(i in a["controllers"]){if(a["controllers"].hasOwnProperty(i)){if(a["controllers"][i]["parser"]&&a["controllers"][i]["parser"]["bxTag"]=="postimage"){d=a["controllers"][i];break}}}var l=function(e,t){return function(){e.insertFile(t)}},u=function(e,t,o){return function(){if(d){d.deleteFile(t,{});BX.remove(BX("wd-doc"+t));BX.ajax({method:"GET",url:o})}else{e.deleteFile(t,o,e,{controlID:"common"})}}};for(r in o){if(o.hasOwnProperty(r)){if(d){d.addFile(o[r])}else{i=a.checkFile(r,"common",o[r]);s.push(r);if(!!i&&BX("wd-doc"+r)&&!BX("wd-doc"+r).hasOwnProperty("bx-bound")){BX("wd-doc"+r).setAttribute("bx-bound","Y");if((n=BX.findChild(BX("wd-doc"+r),{className:"feed-add-img-wrap"},true,false))&&n){BX.bind(n,"click",l(a,i));n.style.cursor="pointer"}if((n=BX.findChild(BX("wd-doc"+r),{className:"feed-add-img-title"},true,false))&&n){BX.bind(n,"click",l(a,i));n.style.cursor="pointer"}if((n=BX.findChild(BX("wd-doc"+r),{className:"feed-add-post-del-but"},true,false))&&n){BX.bind(n,"click",u(a,r,o[r]["del_url"]));n.style.cursor="pointer"}}}if((n=BX.findChild(BX("wd-doc"+r),{className:"feed-add-post-del-but"},true,false))&&n){BX.bind(n,"click",u(a,r,o[r]["del_url"]));n.style.cursor="pointer"}}}if(s.length>0){t.SaveContent();var c=t.GetContent();c=c.replace(new RegExp("\\&\\#91\\;IMG ID=("+s.join("|")+")([WIDTHHEIGHT=0-9 ]*)\\&\\#93\\;","gim"),"[IMG ID=$1$2]");t.SetContent(c);t.Focus()}}},r=function(e){var t="\nimg.bxed-cut{background: transparent url('/bitrix/images/blog/editor/cut_image.gif') left top repeat-x; margin: 2px; width: 100%; height: 12px;}\n";if(e.iframeCssText!=undefined&&e.iframeCssText.length>0)e.iframeCssText+=t;else e.iframeCssText=t;e.AddButton({id:"cut",name:BX.message.CutTitle,iconClassName:"cut",disabledForTextarea:false,src:"/bitrix/images/blog/editor/cut_button.png",toolbarSort:205,handler:function(){var t=this,o=false;if(!t.editor.bbCode||!t.editor.synchro.IsFocusedOnTextarea()){var a='<img id="'+e.SetBxTag(false,{tag:"cut"})+'" class="bxed-cut" src="'+e.EMPTY_IMAGE_SRC+'" title="'+BX.message.CutTitle+'">';o=t.editor.action.actions.insertHTML.exec("insertHTML",a)}else{o=t.editor.action.actions.formatBbCode.exec("formatBbCode",{tag:"CUT",singleTag:true})}return o}});e.AddParser({name:"cut",obj:{Parse:function(t,o){o=o.replace(/\[cut\]/gi,function(t,o,a){var r='<img id="'+e.SetBxTag(false,{tag:"cut"})+'" class="bxed-cut" src="'+e.EMPTY_IMAGE_SRC+'" title="'+BX.message.CutTitle+'">';return r});return o},UnParse:function(e,t){if(e.tag=="cut")return"[CUT]";else return""}}})};BX.addCustomEvent(window,"onInitialized",o);if(formParams[e]["handler"])o(formParams[e]["handler"],e);BX.addCustomEvent(window,"OnEditorInitedBefore",r);if(formParams[e]["editor"])r(formParams[e]["editor"]);BX.addCustomEvent(window,"OnEditorInitedAfter",a);if(formParams[e]["editor"])a(formParams[e]["editor"]);BX.ready(function(){if(BX.browser.IsIE()&&BX("POST_TITLE")){var e=function(e){if(!this.value||this.value==this.getAttribute("placeholder")){this.value=this.getAttribute("placeholder");BX.removeClass(this,"feed-add-post-inp-active")}};BX.bind(BX("POST_TITLE"),"blur",e);e.apply(BX("POST_TITLE"));BX("POST_TITLE").__onchange=BX.delegate(function(e){if(this.value==this.getAttribute("placeholder")){this.value=""}if(this.className.indexOf("feed-add-post-inp-active")<0){BX.addClass(this,"feed-add-post-inp-active")}},BX("POST_TITLE"));BX.bind(BX("POST_TITLE"),"click",BX("POST_TITLE").__onchange);BX.bind(BX("POST_TITLE"),"keydown",BX("POST_TITLE").__onchange);BX.bind(BX("POST_TITLE").form,"submit",function(){if(BX("POST_TITLE").value==BX("POST_TITLE").getAttribute("placeholder")){BX("POST_TITLE").value=""}})}})};
//# sourceMappingURL=script.map.js