(()=>{class e{static get types(){return{expired:{expired:"expired",projectExpired:"projectExpired"},newComments:{newComments:"newComments",projectNewComments:"projectNewComments"},my:{expired:"expired",newComments:"newComments"},project:{projectExpired:"projectExpired",projectNewComments:"projectNewComments"}}}static get colors(){return{danger:"danger",success:"success",gray:"gray"}}constructor(e){this.project=e;this.members=e._members;this.set(this.getDefault())}getDefault(){return{counters:{[e.types.my.expired]:0,[e.types.my.newComments]:0,[e.types.project.projectExpired]:0,[e.types.project.projectNewComments]:0},color:e.colors.gray,value:0,isHidden:false}}get(){return{counters:this.counters,color:this.color,value:this.value,isHidden:this.isHidden}}set(e){this.counters=e.counters||this.counters;this.color=e.color||this.color;this.value=e.value||0;this.isHidden=e.isHidden||!this.members.isInProject()}read(){Object.keys(this.counters).forEach((t=>{if(e.types.newComments[t]){this.value-=this.counters[t];this.counters[t]=0}}));this.value=this.value<0?0:this.value;this.color=this.counters[e.types.expired.expired]>0?e.colors.danger:e.colors.gray}getNewCommentsCount(){let t=0;Object.keys(this.counters).forEach((s=>{if(e.types.newComments[s]){t+=this.counters[s]}}));return t}}class t{constructor(e){this.project=e;this.set(this.getDefault())}getDefault(){return{heads:{},members:{}}}get(){return{heads:this.heads,members:this.members}}set(e){this.heads=e.heads||this.heads||{};this.members=e.members||this.members||{}}getHeadIcons(){const e=[];Object.values(this.heads).filter((e=>e.isOwner==="N")).slice(0,2).forEach((t=>e.push(t.photo)));const t=Object.values(this.heads).filter((e=>e.isOwner==="Y"))[0];if(t){e.splice(0,0,t.photo)}return e}getMemberIcons(){const e=[];Object.values(this.members).filter((e=>e.isAccessRequesting==="N")).slice(0,5).forEach((t=>e.push(t.photo)));return e}getHeadCount(){return Object.keys(this.heads).length}getMemberCount(){return Object.values(this.members).filter((e=>e.isAccessRequesting==="N")).length}isOwner(){const e=Object.values(this.heads).filter((e=>e.isOwner==="Y"))[0];return e&&Number(e.id)===Number(this.project.userId)}isHead(){return Object.values(this.heads).find((e=>Number(e.id)===Number(this.project.userId)))}isMember(){return Object.values(this.members).filter((e=>e.isAccessRequesting==="N")).find((e=>e.id===this.project.userId))}isInProject(){return this.isHead()||this.isMember()}}class s{static get types(){return{about:"about",edit:"edit",delete:"delete",members:"members",invite:"invite",join:"join",leave:"leave",pin:"pin",unpin:"unpin",read:"read"}}constructor(e){this.project=e;this.counter=e._counter;this.set(this.getDefault())}getDefault(){return{[s.types.edit]:false,[s.types.delete]:false,[s.types.invite]:false,[s.types.join]:false,[s.types.leave]:false}}get(){return{[s.types.about]:true,[s.types.edit]:this.canEdit,[s.types.delete]:this.canDelete,[s.types.members]:true,[s.types.invite]:this.canInvite,[s.types.join]:this.canJoin,[s.types.leave]:this.canLeave,[s.types.pin]:!this.project.isPinned,[s.types.unpin]:this.project.isPinned,[s.types.read]:true}}set(e){this.canEdit=e.edit||false;this.canDelete=e.delete||false;this.canInvite=e.invite||false;this.canJoin=e.join||false;this.canLeave=e.leave||false}pin(){this.project.isPinned=true;return new Promise(((e,t)=>{new RequestExecutor("tasks.project.pin",{projectId:this.project.id}).call().then((t=>e(t)),(e=>{console.error(e);t(e)}))}))}unpin(){this.project.isPinned=false;return new Promise(((e,t)=>{new RequestExecutor("tasks.project.unpin",{projectId:this.project.id}).call().then((t=>e(t)),(e=>{console.error(e);t(e)}))}))}read(){this.counter.read();return new Promise(((e,t)=>{new RequestExecutor("tasks.task.comment.readProject",{groupId:this.project.id}).call().then((t=>e(t)),(e=>{console.error(e);t(e)}))}))}join(){this.canJoin=false;this.canLeave=true;return new Promise(((e,t)=>{new RequestExecutor("socialnetwork.api.usertogroup.join",{params:{groupId:this.project.id}}).call().then((t=>e(t)),(e=>t(e)))}))}leave(){this.canJoin=true;this.canLeave=false;return new Promise(((e,t)=>{new RequestExecutor("socialnetwork.api.usertogroup.leave",{params:{groupId:this.project.id}}).call().then((t=>e(t)),(e=>t(e)))}))}}class i{static get userOptions(){return{pinned:2}}static get types(){return{public:"public",private:"private",secret:"secret",extranet:"extranet"}}constructor(i){this.userId=i;this._members=new t(this);this._counter=new e(this);this._actions=new s(this);this.setDefaultData()}setDefaultData(){this.id=`tmp-id-${(new Date).getTime()}`;this.name="";this.image="";this.userGroupId=0;this.numberOfMembers=0;this.numberOfModerators=0;this.isPinned=false;this.isClosed=false;this.isOpened=false;this.isVisible=false;this.isExtranet=false;this.members={};this.counter={};this.actions={};this.activityDate=null;this.additionalData={}}setData(e){this.id=Number(e.id);this.name=e.name;this.image=e.image;this.numberOfMembers=Number(e.numberOfMembers);this.numberOfModerators=Number(e.numberOfModerators);this.isPinned=e.isPinned==="Y";this.isClosed=e.closed==="Y";this.isOpened=e.opened==="Y";this.isVisible=e.visible==="Y";this.isExtranet=e.isExtranet==="Y";this.members=e.members;this.counter=e.counter;this.actions=e.actions;const t=Date.parse(e.activityDate);this.activityDate=t>0?t:null;this.additionalData=e.additionalData}updateData(e){const t=Object.prototype.hasOwnProperty;if(t.call(e,"id")){this.id=Number(e.id)}if(t.call(e,"name")){this.name=e.name}if(t.call(e,"image")){this.image=e.image}if(t.call(e,"numberOfMembers")){this.numberOfMembers=Number(e.numberOfMembers)}if(t.call(e,"numberOfModerators")){this.numberOfModerators=Number(e.numberOfModerators)}if(t.call(e,"isPinned")){this.isPinned=e.isPinned==="Y"}if(t.call(e,"closed")){this.isClosed=e.closed==="Y"}if(t.call(e,"opened")){this.isOpened=e.opened==="Y"}if(t.call(e,"visible")){this.isVisible=e.visible==="Y"}if(t.call(e,"isExtranet")){this.isExtranet=e.isExtranet==="Y"}if(t.call(e,"members")){this.members=e.members}if(t.call(e,"counter")){this.counter=e.counter}if(t.call(e,"actions")){this.actions=e.actions}if(t.call(e,"activityDate")){const t=Date.parse(e.activityDate);this.activityDate=t>0?t:null}if(t.call(e,"additionalData")){this.additionalData=e.additionalData}}open(){PageManager.openPage({cache:false,url:`/mobile/log/?group_id=${this.id}`})}getType(){if(this.isExtranet){return i.types.extranet}if(this.isVisible){if(this.isOpened){return i.types.public}return i.types.private}return i.types.secret}get counter(){return this._counter.get()}set counter(e){this._counter.set(e)}getCounterValue(){return this.counter.value}getCounterColor(){return this.counter.color}getCounterIsHidden(){return this.counter.isHidden}getCounterMyExpiredCount(){return this.counter.counters[e.types.my.expired]}getCounterMyNewCommentsCount(){return this.counter.counters[e.types.my.newComments]}getCounterProjectExpiredCount(){return this.counter.counters[e.types.project.projectExpired]}getCounterProjectNewCommentsCount(){return this.counter.counters[e.types.project.projectNewComments]}getNewCommentsCount(){return this._counter.getNewCommentsCount()}get actions(){return this._actions.get()}set actions(e){this._actions.set(e)}pin(){return this._actions.pin()}unpin(){return this._actions.unpin()}read(){return this._actions.read()}join(){return this._actions.join()}leave(){return this._actions.leave()}pseudoRead(){return this._counter.read()}get members(){return this._members.get()}set members(e){this._members.set(e)}getHeadIcons(){return this._members.getHeadIcons()}getMemberIcons(){return this._members.getMemberIcons()}getHeadCount(){return this._members.getHeadCount()}getMemberCount(){return this._members.getMemberCount()}isOwner(){return this._members.isOwner()}}jnexport([i,"Project"])})();
//# sourceMappingURL=extension.map.js