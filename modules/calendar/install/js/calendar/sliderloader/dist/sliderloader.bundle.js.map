{"version":3,"file":"sliderloader.bundle.js","sources":["../src/sliderloader.js"],"sourcesContent":["\"use strict\";\nimport {Loc, Runtime, Type, Uri} from \"main.core\";\nimport { DeletedViewForm } from \"calendar.sharing.deletedviewform\";\n\nexport class SliderLoader\n{\n\tconstructor(entryId, options = {})\n\t{\n\t\tthis.extensionName = (\n\t\t\t(\n\t\t\t\tType.isString(entryId)\n\t\t\t\t&& (\n\t\t\t\t\tentryId === 'NEW'\n\t\t\t\t\t|| entryId.substr(0, 4) === 'EDIT'\n\t\t\t\t)\n\t\t\t)\n\t\t\t|| !parseInt(entryId)\n\t\t)\n\t\t\t? 'EventEditForm'\n\t\t\t: 'EventViewForm';\n\n\t\tthis.sliderId = options.sliderId || \"calendar:slider-\" + Math.random();\n\n\t\tentryId = (Type.isString(entryId) && entryId.substr(0, 4) === 'EDIT')\n\t\t\t? parseInt(entryId.substr(4))\n\t\t\t: parseInt(entryId);\n\n\t\tthis.extensionParams = {\n\t\t\tentryId: entryId,\n\t\t\tentry: options.entry || null,\n\t\t\ttype: options.type || null,\n\t\t\townerId: parseInt(options.ownerId) || null,\n\t\t\tuserId: parseInt(options.userId) || null,\n\t\t};\n\n\t\tif (Type.isArray(options.participantsEntityList))\n\t\t{\n\t\t\tthis.extensionParams.participantsEntityList = options.participantsEntityList;\n\t\t}\n\n\t\tif (Type.isArray(options.participantsSelectorEntityList))\n\t\t{\n\t\t\tthis.extensionParams.participantsSelectorEntityList = options.participantsSelectorEntityList;\n\t\t}\n\n\t\tif (options.formDataValue)\n\t\t{\n\t\t\tthis.extensionParams.formDataValue = options.formDataValue;\n\t\t}\n\n\t\tif (options.calendarContext)\n\t\t{\n\t\t\tthis.extensionParams.calendarContext = options.calendarContext;\n\t\t}\n\n\t\tif (options.isLocationCalendar)\n\t\t{\n\t\t\tthis.extensionParams.isLocationCalendar = options.isLocationCalendar;\n\t\t}\n\n\t\tif (options.roomsManager)\n\t\t{\n\t\t\tthis.extensionParams.roomsManager = options.roomsManager;\n\t\t}\n\n\t\tif (options.locationAccess)\n\t\t{\n\t\t\tthis.extensionParams.locationAccess = options.locationAccess;\n\t\t}\n\n\t\tif (options.locationCapacity)\n\t\t{\n\t\t\tthis.extensionParams.locationCapacity = options.locationCapacity;\n\t\t}\n\n\t\tif (options.dayOfWeekMonthFormat)\n\t\t{\n\t\t\tthis.extensionParams.dayOfWeekMonthFormat = options.dayOfWeekMonthFormat;\n\t\t}\n\n\t\tif (Type.isDate(options.entryDateFrom))\n\t\t{\n\t\t\tthis.extensionParams.entryDateFrom = options.entryDateFrom;\n\t\t}\n\n\t\tif (options.timezoneOffset)\n\t\t{\n\t\t\tthis.extensionParams.timezoneOffset = options.timezoneOffset;\n\t\t}\n\n\t\tif (Type.isString(options.entryName))\n\t\t{\n\t\t\tthis.extensionParams.entryName = options.entryName;\n\t\t}\n\n\t\tif (Type.isString(options.entryDescription))\n\t\t{\n\t\t\tthis.extensionParams.entryDescription = options.entryDescription;\n\t\t}\n\n\t\tif (Type.isString(options.link))\n\t\t{\n\t\t\tconst uri = new Uri(options.link);\n\t\t\tconst isSharing = uri.getQueryParam('IS_SHARING');\n\t\t\tthis.isSharing = isSharing === '1';\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tif (this.isSharing)\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(this.sliderId, {\n\t\t\t\tcontentCallback: (slider) => new Promise((resolve) => {\n\t\t\t\t\tnew DeletedViewForm(this.extensionParams.entryId).initInSlider(slider, resolve);\n\t\t\t\t}),\n\t\t\t\twidth: 600,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(this.sliderId, {\n\t\t\t\tcontentCallback: this.loadExtension.bind(this),\n\t\t\t\tlabel: {\n\t\t\t\t\ttext: Loc.getMessage('CALENDAR_EVENT'),\n\t\t\t\t\tbgColor: \"#55D0E0\"\n\t\t\t\t},\n\t\t\t\ttype: 'calendar:slider'\n\t\t\t});\n\t\t}\n\t}\n\n\tloadExtension(slider)\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst extensionName = 'calendar.' + this.extensionName.toLowerCase();\n\t\t\tRuntime.loadExtension(extensionName).then((exports) => {\n\t\t\t\tif (exports && exports[this.extensionName])\n\t\t\t\t{\n\t\t\t\t\tconst calendarForm = new exports[this.extensionName](this.extensionParams);\n\t\t\t\t\tif (typeof calendarForm.initInSlider)\n\t\t\t\t\t{\n\t\t\t\t\t\tcalendarForm.initInSlider(slider, resolve);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.error(`Extension \"calendar.${extensionName}\" not found`);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n}"],"names":["SliderLoader","constructor","entryId","options","extensionName","Type","isString","substr","parseInt","sliderId","Math","random","extensionParams","entry","type","ownerId","userId","isArray","participantsEntityList","participantsSelectorEntityList","formDataValue","calendarContext","isLocationCalendar","roomsManager","locationAccess","locationCapacity","dayOfWeekMonthFormat","isDate","entryDateFrom","timezoneOffset","entryName","entryDescription","link","uri","Uri","isSharing","getQueryParam","show","BX","SidePanel","Instance","open","contentCallback","slider","Promise","resolve","DeletedViewForm","initInSlider","width","loadExtension","bind","label","text","Loc","getMessage","bgColor","toLowerCase","Runtime","then","exports","calendarForm","console","error"],"mappings":"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"}