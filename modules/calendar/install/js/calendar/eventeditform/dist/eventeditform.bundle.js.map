{"version":3,"file":"eventeditform.bundle.js","sources":["../src/sliderdatetimecontrol.js","../src/eventeditform.js"],"sourcesContent":["\"use strict\";\nimport {Loc, Dom} from 'main.core';\nimport {DateTimeControl, TimeSelector} from 'calendar.controls';\n\nexport class SliderDateTimeControl extends DateTimeControl\n{\n\tcreate()\n\t{\n\t\tthis.DOM.dateTimeWrap = this.DOM.outerContent.querySelector(`#${this.UID}_datetime_container`);\n\t\tthis.DOM.fromDate = this.DOM.outerContent.querySelector(`#${this.UID}_date_from`);\n\t\tthis.DOM.toDate = this.DOM.outerContent.querySelector(`#${this.UID}_date_to`);\n\t\tthis.DOM.fromTime = this.DOM.outerContent.querySelector(`#${this.UID}_time_from`);\n\t\tthis.DOM.toTime = this.DOM.outerContent.querySelector(`#${this.UID}_time_to`);\n\n\t\tthis.fromTimeControl = new TimeSelector({\n\t\t\tinput: this.DOM.fromTime,\n\t\t\tonChangeCallback: this.handleTimeFromChange.bind(this)\n\t\t});\n\n\t\tthis.toTimeControl = new TimeSelector({\n\t\t\tinput: this.DOM.toTime,\n\t\t\tonChangeCallback: this.handleTimeToChange.bind(this)\n\t\t});\n\n\t\tthis.DOM.fullDay = this.DOM.outerContent.querySelector(`#${this.UID}_date_full_day`);\n\t\tthis.DOM.defTimezoneWrap = this.DOM.outerContent.querySelector(`#${this.UID}_timezone_default_wrap`);\n\t\tthis.DOM.defTimezone = this.DOM.outerContent.querySelector(`#${this.UID}_timezone_default`);\n\n\t\tthis.DOM.fromTz = this.DOM.outerContent.querySelector(`#${this.UID}_timezone_from`);\n\t\tthis.DOM.toTz = this.DOM.outerContent.querySelector(`#${this.UID}_timezone_to`);\n\t\tthis.DOM.tzButton = this.DOM.outerContent.querySelector(`#${this.UID}_timezone_btn`);\n\t\tthis.DOM.tzOuterCont = this.DOM.outerContent.querySelector(`#${this.UID}_timezone_wrap`);\n\t\tthis.DOM.tzCont = this.DOM.outerContent.querySelector(`#${this.UID}_timezone_inner_wrap`);\n\n\t\tthis.DOM.outerContent.querySelector(`#${this.UID}_timezone_hint`).title = Loc.getMessage('EC_EVENT_TZ_HINT');\n\t\tthis.DOM.outerContent.querySelector(`#${this.UID}_timezone_default_hint`).title = Loc.getMessage('EC_EVENT_TZ_DEF_HINT');\n\n\t\tthis.prepareModel();\n\t\tthis.bindEventHandlers();\n\t}\n\n\tprepareModel()\n\t{\n\t\tDom.adjust(this.DOM.fromDate, {props: {autocomplete: 'off'}});\n\t\tDom.adjust(this.DOM.toDate, {props: {autocomplete: 'off'}});\n\t\tDom.adjust(this.DOM.fromTime, {props: {autocomplete: 'off'}});\n\t\tDom.adjust(this.DOM.toTime, {props: {autocomplete: 'off'}});\n\t}\n}","\"use strict\";\n\nimport {Type, Event, Loc, Dom, Browser, Tag, Runtime} from 'main.core';\nimport {SliderDateTimeControl} from './sliderdatetimecontrol.js';\nimport {SectionSelector, Reminder, ColorSelector, Location, RepeatSelector, BusyUsersDialog} from 'calendar.controls';\nimport {Util} from \"calendar.util\";\nimport {Entry, EntryManager} from \"calendar.entry\";\nimport {CalendarSectionManager} from \"calendar.calendarsection\";\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Planner} from \"calendar.planner\";\nimport {TagSelector as EntityTagSelector} from 'ui.entity-selector';\nimport {MobileSyncBanner} from 'calendar.sync.interface';\n\nexport class EventEditForm\n{\n\tDOM = {};\n\tplanner = null;\n\tuid = null;\n\tsliderId = \"calendar:edit-entry-slider\";\n\tzIndex = 3100;\n\tdenyClose = false;\n\tformType = 'slider_main';\n\tSTATE = {READY: 1, REQUEST: 2, ERROR: 3};\n\tsections = [];\n\tsectionIndex = {};\n\ttrackingUsersList = [];\n\tuserSettings = {};\n\n\tconstructor(options = {})\n\t{\n\t\tthis.name = options.name || 'eventeditform';\n\t\tthis.type = options.type || 'user';\n\t\tthis.ownerId = options.ownerId;\n\t\tthis.userId = options.userId || parseInt(Loc.getMessage('USER_ID'));\n\t\tthis.entryId = parseInt(options.entryId);\n\t\tthis.entry = options.entry || null;\n\t\tthis.formDataValue = options.formDataValue || {};\n\t\tthis.emitter = new EventEmitter();\n\t\tthis.emitter.setEventNamespace('BX.Calendar.EventEditForm');\n\t\tthis.BX = Util.getBX();\n\t\tthis.formSettings = {\n\t\t\tpinnedFields : {}\n\t\t};\n\t\tif (!this.ownerId && this.type === 'user')\n\t\t{\n\t\t\tthis.ownerId = parseInt(Loc.getMessage('USER_ID'));\n\t\t}\n\n\t\tthis.refreshPlanner = Runtime.debounce(this.refreshPlannerState, 100, this);\n\n\t\tthis.state = this.STATE.READY;\n\t\tthis.sliderOnClose = this.hide.bind(this);\n\t}\n\n\tinitInSlider(slider, promiseResolve)\n\t{\n\t\tthis.sliderId = slider.getUrl();\n\t\tthis.BX.addCustomEvent(slider, \"SidePanel.Slider:onLoad\", this.onLoadSlider.bind(this));\n\t\tthis.BX.addCustomEvent(slider, \"SidePanel.Slider:onClose\", this.sliderOnClose);\n\t\tthis.BX.addCustomEvent(slider, \"SidePanel.Slider:onBeforeCloseComplete\", this.destroy.bind(this));\n\t\tthis.setCurrentEntry(this.entry || null);\n\n\t\tthis.createContent(slider).then(function(html)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(promiseResolve))\n\t\t\t\t{\n\t\t\t\t\tpromiseResolve(html);\n\t\t\t\t}\n\t\t\t}.bind(this)\n\t\t);\n\n\t\tthis.opened = true;\n\t\tthis.bindEventHandlers();\n\t}\n\n\tshow(params = {})\n\t{\n\t\tthis.setCurrentEntry(params.entry);\n\t\tif (params.formType)\n\t\t{\n\t\t\tthis.formType = params.formType;\n\t\t}\n\n\t\tthis.BX.SidePanel.Instance.open(this.sliderId, {\n\t\t\tcontentCallback: this.createContent.bind(this),\n\t\t\tlabel: {\n\t\t\t\ttext: Loc.getMessage('CALENDAR_EVENT'),\n\t\t\t\tbgColor: \"#55D0E0\"\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonClose: this.sliderOnClose,\n\t\t\t\tonCloseComplete: this.destroy.bind(this),\n\t\t\t\tonLoad: this.onLoadSlider.bind(this)\n\t\t\t}\n\t\t});\n\n\t\tthis.opened = true;\n\t\tthis.bindEventHandlers();\n\t}\n\n\tisOpened()\n\t{\n\t\treturn this.opened;\n\t}\n\n\tbindEventHandlers()\n\t{\n\t\tthis.keyHandlerBind = this.keyHandler.bind(this);\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBind);\n\n\t\t// region 'protection from closing slider by accident'\n\t\tthis.mouseUpNodeCheck = null;\n\n\t\tEvent.bind(document, 'mousedown', (e)=>{this.mousedownTarget = e.target || e.srcElement;});\n\t\tEvent.bind(document, 'mouseup', (e)=>{\n\t\t\tlet target = e.target || e.srcElement;\n\t\t\tif (this.mousedownTarget !== target)\n\t\t\t{\n\t\t\t\tthis.mouseUpNodeCheck = false;\n\t\t\t}\n\t\t\tsetTimeout(()=>{this.mouseUpNodeCheck = null;}, 0);\n\t\t});\n\t\t// endregion\n\n\t\tthis.BX.addCustomEvent(window, \"onCalendarControlChildPopupShown\", this.BX.proxy(this.denySliderClose, this));\n\t\tthis.BX.addCustomEvent(window, \"onCalendarControlChildPopupClosed\", this.BX.proxy(this.allowSliderClose, this));\n\t}\n\n\tonLoadSlider(event)\n\t{\n\t\tthis.slider = event.getSlider();\n\t\tthis.DOM.content = this.slider.layout.content;\n\t\tthis.sliderId = this.slider.getUrl();\n\n\t\t// Used to execute javasctipt and attach CSS from ajax responce\n\t\tthis.BX.html(this.slider.layout.content, this.slider.getData().get(\"sliderContent\"));\n\t\tthis.initControls(this.uid);\n\t\tthis.setFormValues();\n\t}\n\n\tclose()\n\t{\n\t\tif (!this.checkDenyClose())\n\t\t{\n\t\t\tthis.state = this.STATE.READY;\n\t\t\tthis.BX.SidePanel.Instance.close();\n\t\t}\n\t}\n\n\tsave(options = {})\n\t{\n\t\tif (this.state === this.STATE.REQUEST)\n\t\t\treturn;\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\t\tif (!this.entry.id\n\t\t\t&& this.hasExternalEmailUsers()\n\t\t\t&& Util.checkEmailLimitationPopup()\n\t\t\t&& !options.emailLimitationDialogShown)\n\t\t{\n\t\t\tEntryManager.showEmailLimitationDialog({\n\t\t\t\tcallback: () => {\n\t\t\t\t\toptions.emailLimitationDialogShown = true;\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.userSettings.sendFromEmail && this.hasExternalEmailUsers())\n\t\t{\n\t\t\tEntryManager.showConfirmedEmailDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tif (params.sendFromEmail)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userSettings.sendFromEmail = params.sendFromEmail;\n\t\t\t\t\t}\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.entry.id && this.entry.isRecursive()\n\t\t\t&& !options.confirmed\n\t\t\t&& this.getFormDataChanges(['section', 'notify']).length > 0)\n\t\t{\n\t\t\tEntryManager.showConfirmEditDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tthis.save({\n\t\t\t\t\t\trecursionMode: params.recursionMode,\n\t\t\t\t\t\tconfirmed: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.entry.id\n\t\t\t&& this.entry.isMeeting()\n\t\t\t&& options.sendInvitesAgain === undefined\n\t\t\t&& this.getFormDataChanges().includes('date&time')\n\t\t\t&& this.entry.getAttendees().find((item) => {return item.STATUS === 'N';})\n\t\t)\n\t\t{\n\t\t\tEntryManager.showReInviteUsersDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\toptions.sendInvitesAgain = params.sendInvitesAgain;\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tDom.addClass(this.DOM.saveBtn, this.BX.UI.Button.State.CLOCKING);\n\t\tDom.addClass(this.DOM.closeBtn, this.BX.UI.Button.State.DISABLED);\n\t\tthis.state = this.STATE.REQUEST;\n\n\t\tthis.DOM.form.id.value = this.entry.id || 0;\n\n\t\t// Location\n\t\tthis.DOM.form.location.value = this.locationSelector.getTextValue();\n\n\t\tif (this.editor)\n\t\t{\n\t\t\tthis.editor.SaveContent();\n\t\t}\n\n\t\tlet section = this.getCurrentSection();\n\t\tif (section)\n\t\t{\n\t\t\t// Color\n\t\t\tif (section.COLOR.toLowerCase() !== this.colorSelector.getValue().toLowerCase())\n\t\t\t{\n\t\t\t\tthis.DOM.form.color.value = this.colorSelector.getValue();\n\t\t\t}\n\t\t\tthis.BX.userOptions.save('calendar', 'user_settings', 'lastUsedSection', parseInt(section.ID));\n\t\t}\n\n\t\tthis.DOM.form.current_date_from.value = options.recursionMode ? Util.formatDate(this.entry.from) : '';\n\t\tthis.DOM.form.rec_edit_mode.value = options.recursionMode || '';\n\n\t\tif (options.sendInvitesAgain !== undefined)\n\t\t{\n\t\t\tthis.DOM.form.appendChild(Tag.render`<input name=\"sendInvitesAgain\" type=\"hidden\" value=\"${options.sendInvitesAgain ? 'Y' : 'N'}\">`);\n\t\t}\n\n\t\t// Save attendees from userSelector\n\t\tDom.clean(this.DOM.userSelectorValueWarp);\n\t\tthis.getUserSelectorEntityList().forEach((entity, index) => {\n\t\t\tthis.DOM.userSelectorValueWarp.appendChild(Tag.render`\n\t\t\t\t<input type=\"hidden\" name=\"attendeesEntityList[${index}][entityId]\" value=\"${entity.entityId}\">\n\t\t\t`);\n\t\t\tthis.DOM.userSelectorValueWarp.appendChild(Tag.render`\n\t\t\t\t<input type=\"hidden\" name=\"attendeesEntityList[${index}][id]\" value=\"${entity.id}\">\n\t\t\t`);\n\t\t});\n\n\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.editEntry', {\n\t\t\tdata: new FormData(this.DOM.form),\n\t\t\tanalyticsLabel: {\n\t\t\t\tcalendarAction: this.entry.id ? 'edit_event' : 'create_event',\n\t\t\t\tformType: 'full',\n\t\t\t\temailGuests: this.hasExternalEmailUsers() ? 'Y' : 'N',\n\t\t\t\tmarkView: Util.getCurrentView() || 'outside',\n\t\t\t\tmarkCrm: this.DOM.form['UF_CRM_CAL_EVENT[]'] && this.DOM.form['UF_CRM_CAL_EVENT[]'].value ? 'Y' : 'N',\n\t\t\t\tmarkRrule: this.repeatSelector.getType(),\n\t\t\t\tmarkMeeting: this.entry.isMeeting() ? 'Y' : 'N',\n\t\t\t\tmarkType: this.type\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\t\tDom.removeClass(this.DOM.saveBtn, this.BX.UI.Button.State.CLOCKING);\n\t\t\t\tDom.removeClass(this.DOM.closeBtn, this.BX.UI.Button.State.DISABLED);\n\n\t\t\t\tthis.state = this.STATE.READY;\n\t\t\t\tif (response.data.entryId)\n\t\t\t\t{\n\t\t\t\t\tif (this.entry.id)\n\t\t\t\t\t{\n\t\t\t\t\t\tEntryManager.showEditEntryNotification(response.data.entryId);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tEntryManager.showNewEntryNotification(response.data.entryId);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.emitter.emit('onSave', new BaseEvent({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tresponseData: response.data,\n\t\t\t\t\t\toptions: options\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t\tthis.close();\n\n\t\t\t\tif (response.data.displayMobileBanner)\n\t\t\t\t{\n\t\t\t\t\tnew MobileSyncBanner().showInPopup();\n\t\t\t\t}\n\n\t\t\t\tif (response.data.countEventWithEmailGuestAmount)\n\t\t\t\t{\n\t\t\t\t\tUtil.setEventWithEmailGuestAmount(response.data.countEventWithEmailGuestAmount);\n\t\t\t\t}\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tDom.removeClass(this.DOM.saveBtn, this.BX.UI.Button.State.CLOCKING);\n\t\t\t\tDom.removeClass(this.DOM.closeBtn, this.BX.UI.Button.State.DISABLED);\n\n\t\t\t\tif (response.data && Type.isPlainObject(response.data.busyUsersList))\n\t\t\t\t{\n\t\t\t\t\tthis.handleBusyUsersError(response.data.busyUsersList);\n\n\t\t\t\t\tlet errors = [];\n\t\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\t\tif (error.code !== \"edit_entry_user_busy\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\terrors.push(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tresponse.errors = errors;\n\t\t\t\t}\n\n\t\t\t\tif (response.errors && response.errors.length)\n\t\t\t\t{\n\t\t\t\t\tthis.showError(response.errors);\n\t\t\t\t}\n\n\t\t\t\tthis.state = this.STATE.ERROR;\n\t\t\t}\n\t\t);\n\t}\n\n\thandleBusyUsersError(busyUsers)\n\t{\n\t\tlet\n\t\t\tusers = [],\n\t\t\tuserIds = [];\n\n\t\tfor (let id in busyUsers)\n\t\t{\n\t\t\tif (busyUsers.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tusers.push(busyUsers[id]);\n\t\t\t\tuserIds.push(id);\n\t\t\t}\n\t\t}\n\n\t\tthis.busyUsersDialog = new BusyUsersDialog();\n\t\tthis.busyUsersDialog.subscribe('onSaveWithout', () => {\n\t\t\tthis.DOM.form.exclude_users.value = userIds.join(',');\n\t\t\tthis.save();\n\t\t});\n\n\t\tthis.busyUsersDialog.show({users: users});\n\t}\n\n\tclientSideCheck()\n\t{\n\n\t}\n\n\thide(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\tif (this.checkDenyClose())\n\t\t\t{\n\t\t\t\tevent.denyAction();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.BX.removeCustomEvent(\"SidePanel.Slider::onClose\", this.sliderOnClose);\n\t\t\t\tif (this.attendeesSelector)\n\t\t\t\t \tthis.attendeesSelector.closeAll();\n\n\t\t\t\tthis.destroy(event);\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(event)\n\t{\n\t\tif (event && event.getSliderPage && event.getSliderPage().getUrl() === this.sliderId)\n\t\t{\n\t\t\tthis.BX.onCustomEvent('OnCalendarPlannerDoUninstall', [{plannerId: this.plannerId}]);\n\t\t\t//this.BX.removeCustomEvent('OnDestinationAddNewItem', this.BX.proxy(this.refreshPlannerState, this));\n\t\t\t//this.BX.removeCustomEvent('OnDestinationUnselect', this.BX.proxy(this.refreshPlannerState, this));\n\t\t\t//this.BX.removeCustomEvent('OnCalendarPlannerSelectorChanged',\n\t\t\t// this.BX.proxy(this.onCalendarPlannerSelectorChanged, this));\n\n\t\t\tEvent.unbind(document, 'keydown', this.keyHandlerBind);\n\n\t\t\t//this.BX.removeCustomEvent(\"SidePanel.Slider:onCloseComplete\", this.BX.proxy(this.destroy, this));\n\t\t\tthis.BX.SidePanel.Instance.destroy(this.sliderId);\n\n\t\t\tUtil.closeAllPopups();\n\n\t\t\tthis.planner = null;\n\t\t\tthis.opened = false;\n\t\t}\n\t}\n\n\tcreateContent(slider)\n\t{\n\t\tlet promise = new this.BX.Promise();\n\n\t\tlet entry = this.getCurrentEntry();\n\n\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.getEditEventSlider', {\n\t\t\tdata: {\n\t\t\t\tevent_id: this.entryId || entry.id,\n\t\t\t\tdate_from: entry ? Util.formatDate(entry.from) : '',\n\t\t\t\tform_type: this.formType,\n\t\t\t\ttype: this.type,\n\t\t\t\townerId: this.ownerId\n\t\t\t}\n\t\t})\n\t\t\t.then(\n\t\t\t\t// Success\n\t\t\t\t(response) => {\n\t\t\t\t\tif ((Type.isFunction(slider.isOpen) && slider.isOpen()) || slider.isOpen === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet html = this.BX.util.trim(response.data.html);\n\t\t\t\t\t\tslider.getData().set(\"sliderContent\", html);\n\n\t\t\t\t\t\tlet params = response.data.additionalParams;\n\n\t\t\t\t\t\tthis.uid = params.uniqueId;\n\t\t\t\t\t\tthis.editorId = params.editorId;\n\t\t\t\t\t\tthis.lastUsedSection = params.lastSection;\n\t\t\t\t\t\tthis.formSettings = this.getSettings(params.formSettings || []);\n\n\t\t\t\t\t\tthis.setUserSelectorEntityList(this.formDataValue.attendeesEntityList || params.attendeesEntityList || []);\n\n\t\t\t\t\t\tthis.attendeesPreselectedItems = this.getUserSelectorEntityList().map((item) => {return [item.entityId, item.id]});\n\t\t\t\t\t\tthis.setUserSettings(params.userSettings);\n\t\t\t\t\t\tUtil.setEventWithEmailGuestAmount(params.countEventWithEmailGuestAmount);\n\t\t\t\t\t\tUtil.setEventWithEmailGuestLimit(params.eventWithEmailGuestLimit);\n\n\t\t\t\t\t\tthis.handleSections(params.sections, params.trackingUsersList);\n\t\t\t\t\t\tthis.handleLocationData(params.locationFeatureEnabled, params.locationList, params.iblockMeetingRoomList);\n\n\t\t\t\t\t\tif (!entry.id && !entry.sectionId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setCurrentEntry();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.updateEntryData(params.entry, {\n\t\t\t\t\t\t\tuserSettings: this.userSettings\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tpromise.fulfill(html);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Failure\n\t\t\t\t(response)=>{\n\t\t\t\t\t//this.calendar.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\t\treturn promise;\n\t}\n\n\n\tinitControls(uid)\n\t{\n\t\tthis.DOM.title = this.DOM.content.querySelector(`#${uid}_title`);\n\n\t\tthis.DOM.formWrap = this.DOM.content.querySelector(`#${uid}_form_wrap`);\n\t\tthis.DOM.form = this.DOM.content.querySelector(`#${uid}_form`);\n\n\t\tthis.DOM.saveBtn = this.DOM.content.querySelector(`#${uid}_save`);\n\t\tthis.DOM.closeBtn = this.DOM.content.querySelector(`#${uid}_close`);\n\t\tEvent.bind(this.DOM.saveBtn, 'click', this.save.bind(this));\n\t\tEvent.bind(this.DOM.closeBtn, 'click', this.close.bind(this));\n\n\t\tthis.initFormFieldManager(uid);\n\t\tthis.initDateTimeControl(uid);\n\t\tthis.initNameControl(uid);\n\t\tthis.initEditorControl(uid);\n\t\tthis.initAttendeesControl(uid);\n\t\tthis.initPlanner(uid);\n\t\tthis.initReminderControl(uid);\n\t\tthis.initSectionSelector(uid);\n\t\tthis.initLocationControl(uid);\n\t\tthis.initRepeatRuleControl(uid);\n\t\tthis.initColorControl(uid);\n\t\tthis.initCrmUfControl(uid);\n\t\tthis.initAdditionalControls(uid);\n\n\t\tthis.checkLastItemBorder();\n\t}\n\n\tupdateEntryData(entryData, options = {})\n\t{\n\t\tif (this.entry instanceof Entry)\n\t\t{\n\t\t\tlet userSettings = options.userSettings || {};\n\n\t\t\tif (Type.isPlainObject(entryData))\n\t\t\t{\n\t\t\t\tthis.entry.prepareData(entryData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!this.entry.getTimezoneFrom() || this.entry.getTimezoneTo())\n\t\t\t\t{\n\t\t\t\t\tthis.entry.setTimezone(userSettings.timezoneName || userSettings.timezoneDefaultName || null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thandleSections(sections, trackingUsersList)\n\t{\n\t\tthis.sections = sections;\n\t\tthis.sectionIndex = {};\n\t\tthis.trackingUsersList = trackingUsersList || [];\n\n\t\tif (Type.isArray(sections))\n\t\t{\n\t\t\tsections.forEach((value, ind) => {this.sectionIndex[parseInt(value.ID)] = ind;}, this);\n\t\t}\n\t}\n\n\thandleLocationData(locationFeatureEnabled, locationList, iblockMeetingRoomList)\n\t{\n\t\tthis.locationFeatureEnabled = !!locationFeatureEnabled;\n\t\tthis.locationList = locationList || [];\n\t\tthis.iblockMeetingRoomList = iblockMeetingRoomList || [];\n\n\t\tLocation.setLocationList(locationList);\n\t\tLocation.setMeetingRoomList(iblockMeetingRoomList);\n\t}\n\n\tsetUserSettings(userSettings)\n\t{\n\t\tthis.userSettings = userSettings;\n\t}\n\n\tsetFormValues()\n\t{\n\t\tlet entry = this.entry;\n\n\t\t// Date time\n\t\tthis.dateTimeControl.setValue({\n\t\t\tfrom: this.formDataValue.from || entry.from,\n\t\t\tto: this.formDataValue.to || entry.to,\n\t\t\tfullDay: Type.isBoolean(this.formDataValue.fullDay) ? this.formDataValue.fullDay : entry.fullDay,\n\t\t\ttimezoneFrom: entry.getTimezoneFrom() || '',\n\t\t\ttimezoneTo: entry.getTimezoneTo() || '',\n\t\t\ttimezoneName: this.userSettings.timezoneName\n\t\t});\n\n\t\tthis.DOM.entryName.value = this.formDataValue.name || entry.getName();\n\n\t\t// Section\n\t\tthis.DOM.sectionInput.value = this.formDataValue.section || this.getCurrentSectionId();\n\t\tthis.sectionSelector.updateValue();\n\n\t\tif (!this.fieldIsPinned('section'))\n\t\t{\n\t\t\tlet currentSection = this.getCurrentSection();\n\t\t\tif (currentSection['CAL_TYPE'] !== this.type || currentSection['CAL_TYPE'] === this.type && parseInt(currentSection['OWNER_ID']) !== this.ownerId)\n\t\t\t{\n\t\t\t\tthis.pinField('section');\n\t\t\t}\n\t\t}\n\n\t\t// Color\n\t\tthis.colorSelector.setValue(this.formDataValue.color || entry.getColor() || this.getCurrentSection().COLOR);\n\n\t\t// Reminders\n\t\tthis.reminderControl.setValue(this.formDataValue.reminder || entry.getReminders());\n\n\t\t// Recursion\n\t\tthis.repeatSelector.setValue(entry.getRrule());\n\n\t\t// accessibility\n\t\tif (this.DOM.accessibilityInput)\n\t\t{\n\t\t\tthis.DOM.accessibilityInput.value = entry.accessibility;\n\t\t}\n\n\t\t// Location\n\t\tthis.locationSelector.setValue(this.formDataValue.location || entry.getLocation());\n\n\t\t// Private\n\t\tif (this.DOM.privateEventCheckbox)\n\t\t{\n\t\t\tthis.DOM.privateEventCheckbox.checked = entry.private;\n\t\t}\n\n\t\t// Importance\n\t\tif (this.DOM.importantEventCheckbox)\n\t\t{\n\t\t\tthis.DOM.importantEventCheckbox.checked = entry.important;\n\t\t}\n\n\t\tif (this.DOM.form.meeting_notify)\n\t\t{\n\t\t\tif (this.formDataValue.meetingNotify !== undefined)\n\t\t\t{\n\t\t\t\tthis.DOM.form.meeting_notify.checked = this.formDataValue.meetingNotify;\n\t\t\t}\n\t\t\tif (this.entry.data && this.entry.data.MEETING)\n\t\t\t{\n\t\t\t\tthis.DOM.form.meeting_notify.checked = this.entry.data.MEETING.NOTIFY;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.form.meeting_notify.checked = true; // default value\n\t\t\t}\n\t\t}\n\n\t\tif (this.DOM.form.allow_invite)\n\t\t{\n\t\t\tif (this.entry.data)\n\t\t\t{\n\t\t\t\tthis.DOM.form.allow_invite.checked = this.entry.data.MEETING && this.entry.data.MEETING.ALLOW_INVITE;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.form.allow_invite.checked = this.entry.allowInvite;\n\t\t\t}\n\t\t}\n\n\t\tthis.loadPlannerData({\n\t\t\tentityList: this.getUserSelectorEntityList(),\n\t\t\tfrom: Util.formatDate(entry.from.getTime() - Util.getDayLength() * 3),\n\t\t\tto: Util.formatDate(entry.to.getTime() + Util.getDayLength() * 10),\n\t\t\ttimezone: entry.getTimezoneFrom(),\n\t\t\tlocation: this.locationSelector.getTextValue()\n\t\t});\n\t}\n\n\tswitchFullDay(value)\n\t{\n\t\tvalue = !!this.DOM.fullDay.checked;\n\t\tif (value && Type.isString(this.userSettings.timezoneName)\n\t\t\t&& (!this.DOM.fromTz.value || !this.DOM.toTz.value))\n\t\t{\n\t\t\tthis.DOM.fromTz.value = this.userSettings.timezoneName;\n\t\t\tthis.DOM.toTz.value = this.userSettings.timezoneName;\n\t\t\tthis.DOM.defTimezone.value = this.userSettings.timezoneName;\n\t\t}\n\n\t\tif (value)\n\t\t{\n\t\t\tDom.addClass(this.DOM.dateTimeWrap, 'calendar-options-item-datetime-hide-time');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.DOM.dateTimeWrap, 'calendar-options-item-datetime-hide-time');\n\t\t}\n\n\t\tif(this.reminderControl)\n\t\t{\n\t\t\tthis.reminderControl.setFullDayMode(value);\n\t\t}\n\n\t\tthis.refreshPlanner();\n\t}\n\n\tswitchTimezone()\n\t{\n\t\tif (Dom.hasClass(this.DOM.tzCont, 'calendar-options-timezone-collapse'))\n\t\t{\n\t\t\tDom.addClass(this.DOM.tzCont, 'calendar-options-timezone-expand');\n\t\t\tDom.removeClass(this.DOM.tzCont, 'calendar-options-timezone-collapse');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.DOM.tzCont, 'calendar-options-timezone-collapse');\n\t\t\tDom.removeClass(this.DOM.tzCont, 'calendar-options-timezone-expand');\n\t\t}\n\t}\n\n\tinitFormFieldManager(uid)\n\t{\n\t\tthis.DOM.mainBlock = this.DOM.content.querySelector(`#${uid}_main_block_wrap`);\n\t\tthis.DOM.additionalBlockWrap = this.DOM.content.querySelector(`#${uid}_additional_block_wrap`);\n\t\tthis.DOM.additionalBlock = this.DOM.content.querySelector(`#${uid}_additional_block`);\n\t\tthis.DOM.pinnedNamesWrap = this.DOM.content.querySelector(`#${uid}_additional_pinned_names`);\n\t\tthis.DOM.additionalSwitch = this.DOM.content.querySelector(`#${uid}_additional_switch`);\n\n\t\tEvent.bind(this.DOM.additionalSwitch, 'click', () => {\n\t\t\tDom.toggleClass(this.DOM.additionalSwitch, 'opened');\n\t\t\tDom.toggleClass(this.DOM.additionalBlock, 'invisible');\n\t\t});\n\n\t\tEvent.bind(this.DOM.formWrap, 'click', (e) => {\n\t\t\tlet target = e.target || e.srcElement;\n\t\t\tif (target && target.getAttribute && target.getAttribute('data-bx-fixfield'))\n\t\t\t{\n\t\t\t\tlet fieldName = target.getAttribute('data-bx-fixfield');\n\t\t\t\tif (!this.fieldIsPinned(fieldName))\n\t\t\t\t{\n\t\t\t\t\tthis.pinField(fieldName);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.unPinField(fieldName);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tinitDateTimeControl(uid)\n\t{\n\t\tthis.dateTimeControl = new SliderDateTimeControl(uid, {\n\t\t\tshowTimezone: true,\n\t\t\touterContent: this.DOM.content\n\t\t});\n\n\t\tthis.dateTimeControl.subscribe('onChange', (event) => {\n\t\t\tif (event instanceof BaseEvent)\n\t\t\t{\n\t\t\t\tlet value = event.getData().value;\n\t\t\t\tif (this.reminderControl)\n\t\t\t\t{\n\t\t\t\t\tthis.reminderControl.setFullDayMode(value.fullDay);\n\t\t\t\t}\n\n\t\t\t\tif (this.planner)\n\t\t\t\t{\n\t\t\t\t\tthis.planner.updateSelector(value.from, value.to, value.fullDay);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tinitNameControl(uid)\n\t{\n\t\tthis.DOM.entryName = this.DOM.content.querySelector(`#${uid}_entry_name`);\n\t\tsetTimeout(() => {\n\t\t\tthis.DOM.entryName.focus();\n\t\t\tthis.DOM.entryName.select();\n\t\t}, 500);\n\t}\n\n\tinitReminderControl(uid)\n\t{\n\t\tthis.reminderValues = [];\n\t\tthis.DOM.reminderWrap = this.DOM.content.querySelector(`#${uid}_reminder`);\n\t\tthis.DOM.reminderInputsWrap = this.DOM.reminderWrap.appendChild(Tag.render`<span></span>`);\n\n\t\tthis.reminderControl = new Reminder({\n\t\t\twrap: this.DOM.reminderWrap,\n\t\t\tzIndex: this.zIndex,\n\t\t\t// showPopupCallBack: function()\n\t\t\t// {\n\t\t\t// \t//_this.denySliderClose();\n\t\t\t// },\n\t\t\t// hidePopupCallBack: function()\n\t\t\t// {\n\t\t\t// \t//_this.allowSliderClose();\n\t\t\t// }\n\t\t});\n\n\t\tthis.reminderControl.subscribe('onChange', (event) =>\n\t\t{\n\t\t\tif (event instanceof BaseEvent)\n\t\t\t{\n\t\t\t\tthis.reminderValues = event.getData().values;\n\t\t\t\tDom.clean(this.DOM.reminderInputsWrap);\n\t\t\t\tthis.reminderValues.forEach((value) => {\n\t\t\t\t\tthis.DOM.reminderInputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\t\t\t\tprops: {name: 'reminder[]', type: 'hidden'},\n\t\t\t\t\t\tattrs: {value: value}}));\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tinitSectionSelector(uid)\n\t{\n\t\tthis.DOM.sectionInput = this.DOM.content.querySelector(`#${uid}_section`);\n\t\tthis.sectionSelector = new SectionSelector({\n\t\t\touterWrap: this.DOM.content.querySelector(`#${uid}_section_wrap`),\n\t\t\tdefaultCalendarType: this.type,\n\t\t\tdefaultOwnerId: this.ownerId,\n\t\t\tsectionList: this.sections,\n\t\t\tsectionGroupList: CalendarSectionManager.getSectionGroupList({\n\t\t\t\ttype: this.type || 'user',\n\t\t\t\townerId: this.ownerId || this.userId,\n\t\t\t\tuserId: this.userId,\n\t\t\t\ttrackingUsersList: this.trackingUsersList,\n\t\t\t}),\n\t\t\tmode: 'full',\n\t\t\tzIndex: this.zIndex,\n\t\t\tgetCurrentSection: ()=>{\n\t\t\t\tlet section = this.getCurrentSection();\n\t\t\t\tif (section)\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: section.ID,\n\t\t\t\t\t\tname: section.NAME,\n\t\t\t\t\t\tcolor: section.COLOR\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tselectCallback: (sectionValue) => {\n\t\t\t\tif (sectionValue)\n\t\t\t\t{\n\t\t\t\t\t//this.BX.userOptions.save('calendar', 'user_settings', 'lastUsedSection', sectionValue.id);\n\t\t\t\t\tthis.DOM.sectionInput.value = sectionValue.id;\n\t\t\t\t\tif (this.colorSelector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.colorSelector.setValue(sectionValue.color);\n\t\t\t\t\t}\n\t\t\t\t\tthis.entry.setSectionId(sectionValue.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tinitEditorControl(uid)\n\t{\n\t\tif (!window[\"BXHtmlEditor\"])\n\t\t{\n\t\t\treturn setTimeout(BX.delegate(this.initEditorControl, this), 50);\n\t\t}\n\n\t\tthis.editor = null;\n\t\tif (window[\"BXHtmlEditor\"])\n\t\t{\n\t\t\tthis.editor = window[\"BXHtmlEditor\"].Get(this.editorId);\n\t\t}\n\n\t\tif (!this.editor && top[\"BXHtmlEditor\"] !== window[\"BXHtmlEditor\"])\n\t\t{\n\t\t\tthis.editor = top[\"BXHtmlEditor\"].Get(this.editorId);\n\t\t}\n\n\t\tif (this.editor && this.editor.IsShown())\n\t\t{\n\t\t\tthis.customizeHtmlEditor();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.BX.addCustomEvent(window[\"BXHtmlEditor\"], 'OnEditorCreated', function (editor)\n\t\t\t{\n\t\t\t\tif (editor.id === this.editorId)\n\t\t\t\t{\n\t\t\t\t\tthis.editor = editor;\n\t\t\t\t\tthis.customizeHtmlEditor();\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}\n\t}\n\n\tcustomizeHtmlEditor()\n\t{\n\t\tlet editor = this.editor;\n\t\tif (editor.toolbar && editor.toolbar.controls && editor.toolbar.controls.spoiler)\n\t\t{\n\t\t\tDom.remove(editor.toolbar.controls.spoiler.pCont);\n\t\t}\n\t}\n\n\tinitLocationControl(uid)\n\t{\n\t\tthis.DOM.locationWrap = this.DOM.content.querySelector(`#${uid}_location_wrap`);\n\t\tthis.DOM.locationInput = this.DOM.content.querySelector(`#${uid}_location`);\n\n\t\tthis.locationSelector = new Location(\n\t\t\t{\n\t\t\t\tinputName: 'lo_cation', // don't use 'location' word here mantis:107863\n\t\t\t\twrap: this.DOM.locationWrap,\n\t\t\t\trichLocationEnabled: this.locationFeatureEnabled,\n\t\t\t\tlocationList: this.locationList,\n\t\t\t\tiblockMeetingRoomList: this.iblockMeetingRoomList,\n\t\t\t\tonChangeCallback: this.refreshPlanner\n\t\t\t}\n\t\t);\n\t}\n\n\tinitRepeatRuleControl(uid)\n\t{\n\t\tthis.DOM.rruleWrap = this.DOM.content.querySelector(`#${uid}_rrule_wrap`);\n\t\tthis.repeatSelector = new RepeatSelector(\n\t\t\t{\n\t\t\t\twrap: this.DOM.rruleWrap,\n\t\t\t\trruleType: this.DOM.content.querySelector(`#${uid}_rrule_type`),\n\t\t\t\tgetDate: function() {return this.dateTimeControl.getValue().from;}.bind(this)\n\t\t\t}\n\t\t);\n\n\t\tthis.dateTimeControl.subscribe('onChange', ()=>{\n\t\t\tif (this.repeatSelector.getType() === 'weekly')\n\t\t\t{\n\t\t\t\tthis.repeatSelector.changeType(this.repeatSelector.getType());\n\t\t\t}\n\t\t});\n\t}\n\n\tinitAttendeesControl(uid)\n\t{\n\t\tthis.DOM.userSelectorWrap = this.DOM.content.querySelector('.calendar-attendees-selector-wrap');\n\t\tthis.DOM.userSelectorValueWarp = this.DOM.userSelectorWrap.appendChild(Tag.render`<div></div>`);\n\n\t\tthis.userTagSelector = new EntityTagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: this.attendeesPreselectedItems || [],\n\t\t\t\tzIndex: this.slider.zIndex,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteGuestLink: true,\n\t\t\t\t\t\t\temailUsers: true,\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: {selectMode: 'usersAndDepartments'}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\t\toptions: { 'all-users': true }\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tsearchTabOptions: {\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_USER_DIALOG_404_TITLE'),\n\t\t\t\t\t\tsubtitle: Loc.getMessage('EC_USER_DIALOG_404_SUBTITLE'),\n\t\t\t\t\t\ticon: '/bitrix/images/calendar/search-email.svg',\n\t\t\t\t\t\ticonOpacity: 100,\n\t\t\t\t\t\tarrow: true,\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.userTagSelector.renderTo(this.DOM.userSelectorWrap);\n\t\t//this.DOM.moreOuterWrap = BX(this.id + '_more_outer_wrap');\n\t\t//this.DOM.moreLink = BX.adjust(BX(this.id + '_more'), {events: {click: BX.delegate(function(){BX.toggleClass(this.DOM.moreWrap, 'collapse');}, this)}});\n\t\t//this.DOM.moreWrap = BX(this.id + '_more_wrap');\n\t}\n\n\thandleUserSelectorChanges()\n\t{\n\t\tif (this.planner)\n\t\t{\n\t\t\tthis.planner.show();\n\t\t\tthis.planner.showLoader();\n\n\t\t\tthis.setUserSelectorEntityList(this.userTagSelector.getTags().map((item) => {\n\t\t\t\treturn {\n\t\t\t\t\tentityId: item.entityId,\n\t\t\t\t\tid: item.id,\n\t\t\t\t\tentityType: item.entityType\n\t\t\t\t}}));\n\t\t\tthis.refreshPlanner();\n\t\t}\n\t}\n\n\thasExternalEmailUsers()\n\t{\n\t\treturn !!this.getUserSelectorEntityList().find((item) => {return item.entityType === 'email';});\n\t}\n\n\tinitPlanner(uid)\n\t{\n\t\tthis.DOM.plannerOuterWrap = this.DOM.content.querySelector(`#${uid}_planner_outer_wrap`);\n\n\t\tthis.planner = new Planner({\n\t\t\twrap: this.DOM.plannerOuterWrap,\n\t\t\tminWidth: parseInt(this.DOM.plannerOuterWrap.offsetWidth),\n\t\t});\n\n\t\tthis.planner.subscribe('onDateChange', this.handlePlannerSelectorChanges.bind(this));\n\n\t\tthis.planner.show();\n\t\tthis.planner.showLoader();\n\t}\n\n\tloadPlannerData(params = {})\n\t{\n\t\tthis.planner.showLoader();\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.updatePlanner', {\n\t\t\t\tdata: {\n\t\t\t\t\tentryId: this.entry.id || 0,\n\t\t\t\t\townerId: this.ownerId,\n\t\t\t\t\ttype: this.type,\n\t\t\t\t\tentityList: params.entityList || [],\n\t\t\t\t\tdateFrom: params.from || '',\n\t\t\t\t\tdateTo: params.to || '',\n\t\t\t\t\ttimezone: params.timezone || '',\n\t\t\t\t\tlocation: params.location || '',\n\t\t\t\t\tentries: params.entrieIds || false\n\t\t\t\t}\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.planner.hideLoader();\n\t\t\t\t\t\tlet attendees = [];\n\t\t\t\t\t\tif (Type.isArray(response.data.entries))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresponse.data.entries.forEach((entry) => {\n\t\t\t\t\t\t\t\tif (entry.type === 'user')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattendees.push({\n\t\t\t\t\t\t\t\t\t\tid: entry.id,\n\t\t\t\t\t\t\t\t\t\tname: entry.name,\n\t\t\t\t\t\t\t\t\t\tavatar: entry.avatar,\n\t\t\t\t\t\t\t\t\t\tsmallAvatar: entry.smallAvatar || entry.avatar,\n\t\t\t\t\t\t\t\t\t\turl: entry.url\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet dateTime = this.dateTimeControl.getValue();\n\t\t\t\t\t\tthis.planner.update(\n\t\t\t\t\t\t\tresponse.data.entries,\n\t\t\t\t\t\t\tresponse.data.accessibility\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.planner.updateSelector(dateTime.from, dateTime.to, dateTime.fullDay);\n\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {resolve(response);}\n\t\t\t\t);\n\n\t\t});\n\t}\n\n\n\tinitAdditionalControls(uid)\n\t{\n\t\tthis.DOM.accessibilityInput = this.DOM.content.querySelector(`#${uid}_accessibility`);\n\t\tthis.DOM.privateEventCheckbox = this.DOM.content.querySelector(`#${uid}_private`);\n\t\tthis.DOM.importantEventCheckbox = this.DOM.content.querySelector(`#${uid}_important`);\n\t}\n\n\tinitColorControl(uid)\n\t{\n\t\tthis.DOM.colorWrap = this.DOM.content.querySelector(`#${uid}_color_selector_wrap`);\n\t\tthis.colorSelector = new ColorSelector(\n\t\t\t{\n\t\t\t\twrap: this.DOM.colorWrap\n\t\t\t}\n\t\t);\n\t}\n\n\tinitCrmUfControl(uid)\n\t{\n\t\tthis.DOM.crmUfWrap = BX(uid + '-uf-crm-wrap');\n\n\t\tif (this.DOM.crmUfWrap)\n\t\t{\n\t\t\tlet entry = this.getCurrentEntry();\n\t\t\tlet loader = this.DOM.crmUfWrap.appendChild(Dom.adjust(Util.getLoader(50), {style: {height: '40px', width: '40px'}}));\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.getCrmUserfield', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tevent_id: (entry && entry.id) ? entry.id : 0\n\t\t\t\t\t}\n\t\t\t\t}).then(\n\t\t\t\t\t// Success\n\t\t\t\t\tfunction(response)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Type.isDomNode(this.DOM.crmUfWrap))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.BX.html(this.DOM.crmUfWrap, response.data.html);\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\t// Failure\n\t\t\t\t\tfunction (response)\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.remove(loader);\n\t\t\t\t\t}.bind(this)\n\t\t\t\t);\n\t\t\t}.bind(this), 800);\n\t\t}\n\t}\n\n\tdenySliderClose()\n\t{\n\t\tthis.denyClose = true;\n\t}\n\n\tallowSliderClose()\n\t{\n\t\tthis.denyClose = false;\n\t}\n\n\tcheckDenyClose()\n\t{\n\t\t// pending request\n\t\tif (this.state === this.STATE.REQUEST)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\t// Check if closing of slider was caused during selection.\n\t\tif (!Type.isNull(this.mouseUpNodeCheck))\n\t\t{\n\t\t\treturn !this.mouseUpNodeCheck;\n\t\t}\n\n\t\t// if (top.BX(this.id + '_time_from_div') && top.BX(this.id + '_time_from_div').style.display !== 'none')\n\t\t// \treturn true;\n\t\t//\n\t\t// if (top.BX(this.id + '_time_to_div') && top.BX(this.id + '_time_to_div').style.display !== 'none')\n\t\t// \treturn true;\n\n\t\treturn this.denyClose;\n\t}\n\n\tsetCurrentEntry(entry = null, userIndex = null)\n\t{\n\t\tthis.entry = EntryManager.getEntryInstance(entry, userIndex, {type: this.type, ownerId: this.ownerId});\n\t}\n\n\tgetCurrentEntry()\n\t{\n\t\treturn this.entry;\n\t}\n\n\tgetCurrentSection()\n\t{\n\t\tlet\n\t\t\tsection = false,\n\t\t\tsectionId = this.getCurrentSectionId();\n\n\t\tif (sectionId\n\t\t\t&& this.sectionIndex[sectionId] !== undefined\n\t\t\t&& this.sections[this.sectionIndex[sectionId]] !== undefined)\n\t\t{\n\t\t\tsection = this.sections[this.sectionIndex[sectionId]];\n\t\t}\n\n\t\treturn section;\n\t}\n\n\tgetCurrentSectionId()\n\t{\n\t\tlet\n\t\t\tsection = 0,\n\t\t\tentry = this.getCurrentEntry();\n\n\t\tif (entry instanceof Entry)\n\t\t{\n\t\t\tsection = parseInt(entry.sectionId);\n\t\t}\n\n\t\tif (!section && this.lastUsedSection && this.sections[this.sectionIndex[parseInt(this.lastUsedSection)]])\n\t\t{\n\t\t\tsection = parseInt(this.lastUsedSection);\n\t\t}\n\n\t\tif (!section && this.sections[0])\n\t\t{\n\t\t\tsection = parseInt(this.sections[0].ID);\n\t\t}\n\t\treturn section;\n\t}\n\n\tpinField(fieldName)\n\t{\n\t\tlet [placeHolders, placeHoldersAdditional] = this.getPlaceholders();\n\t\tlet\n\t\t\tfield = placeHoldersAdditional[fieldName],\n\t\t\tnewField = placeHolders[fieldName],\n\t\t\tfieldHeight = field.offsetHeight;\n\n\t\tfield.style.height = fieldHeight + 'px';\n\t\tsetTimeout(function(){Dom.addClass(field, 'calendar-hide-field');}, 0);\n\t\tnewField.style.height = '0';\n\n\t\tif (fieldName === 'description')\n\t\t{\n\t\t\tsetTimeout(function()\n\t\t\t{\n\t\t\t\tif (!this.DOM.descriptionAdditionalWrap)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.descriptionAdditionalWrap = this.DOM.additionalBlock.querySelector('.calendar-info-panel-description');\n\t\t\t\t}\n\n\t\t\t\tif (this.DOM.descriptionAdditionalWrap)\n\t\t\t\t{\n\n\t\t\t\t\twhile(this.DOM.descriptionAdditionalWrap.firstChild)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewField.appendChild(this.DOM.descriptionAdditionalWrap.firstChild);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnewField.style.height = fieldHeight + 'px';\n\t\t\t}.bind(this), 200);\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tDom.removeClass(field, 'calendar-hide-field');\n\t\t\t\tfield.style.display = 'none';\n\t\t\t\tnewField.style.height = '';\n\t\t\t\tthis.pinnedFieldsIndex[fieldName] = true;\n\t\t\t\tlet editor = window[\"BXHtmlEditor\"].Get(this.editorId);\n\t\t\t\tif (editor)\n\t\t\t\t{\n\t\t\t\t\teditor.CheckAndReInit();\n\t\t\t\t}\n\t\t\t\tthis.saveSettings();\n\t\t\t\tthis.updateAdditionalBlockState();\n\t\t\t}.bind(this), 500);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(function()\n\t\t\t{\n\t\t\t\twhile(field.firstChild)\n\t\t\t\t{\n\t\t\t\t\tnewField.appendChild(field.firstChild);\n\t\t\t\t}\n\t\t\t\tnewField.style.height = fieldHeight + 'px';\n\t\t\t}, 200);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tDom.removeClass(field, 'calendar-hide-field');\n\t\t\t\tfield.style.height = '';\n\t\t\t\tnewField.style.height = '';\n\t\t\t\tthis.pinnedFieldsIndex[fieldName] = true;\n\t\t\t\tthis.saveSettings();\n\t\t\t\tthis.updateAdditionalBlockState();\n\t\t\t}, 300);\n\t\t}\n\t}\n\n\tunPinField(fieldName)\n\t{\n\t\tlet [placeHolders, placeHoldersAdditional] = this.getPlaceholders();\n\t\tlet\n\t\t\tfield = placeHolders[fieldName],\n\t\t\tnewField = placeHoldersAdditional[fieldName],\n\t\t\tfieldHeight = field.offsetHeight;\n\n\t\tfield.style.height = fieldHeight + 'px';\n\t\tsetTimeout(function(){\n\t\t\tDom.addClass(field, 'calendar-hide-field');\n\t\t}, 0);\n\t\tnewField.style.height = '0';\n\n\t\tif (fieldName === 'description')\n\t\t{\n\t\t\tsetTimeout(function(){\n\t\t\t\tif (!this.DOM.descriptionAdditionalWrap)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.descriptionAdditionalWrap = this.DOM.additionalBlock.querySelector('.calendar-info-panel-description');\n\t\t\t\t}\n\n\t\t\t\tif (this.DOM.descriptionAdditionalWrap)\n\t\t\t\t{\n\t\t\t\t\twhile(field.firstChild)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.DOM.descriptionAdditionalWrap.appendChild(field.firstChild);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tnewField.style.display = '';\n\t\t\t\tnewField.style.height = fieldHeight + 'px';\n\t\t\t}.bind(this), 200);\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tDom.removeClass(field, 'calendar-hide-field');\n\t\t\t\tfield.style.height = '';\n\t\t\t\tnewField.style.height = '';\n\t\t\t\tthis.pinnedFieldsIndex[fieldName] = false;\n\n\t\t\t\tlet editor = window[\"BXHtmlEditor\"].Get(this.editorId);\n\t\t\t\tif (editor)\n\t\t\t\t{\n\t\t\t\t\teditor.CheckAndReInit();\n\t\t\t\t}\n\n\t\t\t\tthis.saveSettings();\n\t\t\t\tthis.updateAdditionalBlockState();\n\t\t\t}.bind(this), 300);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(function(){\n\t\t\t\twhile(field.firstChild)\n\t\t\t\t{\n\t\t\t\t\tnewField.appendChild(field.firstChild);\n\t\t\t\t}\n\t\t\t\tnewField.style.height = fieldHeight + 'px';\n\t\t\t}, 200);\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tDom.removeClass(field, 'calendar-hide-field');\n\t\t\t\tfield.style.height = '';\n\t\t\t\tnewField.style.height = '';\n\t\t\t\tthis.pinnedFieldsIndex[fieldName] = false;\n\n\t\t\t\tthis.saveSettings();\n\t\t\t\tthis.updateAdditionalBlockState();\n\t\t\t}.bind(this), 300);\n\t\t}\n\t}\n\n\tfieldIsPinned(fieldName)\n\t{\n\t\treturn this.pinnedFieldsIndex[fieldName];\n\t}\n\n\tgetPlaceholders()\n\t{\n\t\tif (!this.placeHolders)\n\t\t{\n\t\t\tthis.placeHolders = {};\n\t\t\tthis.placeHoldersAdditional = {};\n\n\t\t\tlet\n\t\t\t\ti,\n\t\t\t\tfieldId,\n\t\t\t\tnodes = this.DOM.formWrap.querySelectorAll('.calendar-field-additional-placeholder');\n\n\t\t\tfor (i = 0; i < nodes.length; i++)\n\t\t\t{\n\t\t\t\tfieldId = nodes[i].getAttribute('data-bx-block-placeholer');\n\t\t\t\tif (fieldId)\n\t\t\t\t{\n\t\t\t\t\tthis.placeHoldersAdditional[fieldId] = nodes[i];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tnodes = this.DOM.formWrap.querySelectorAll('.calendar-field-placeholder');\n\t\t\tfor (i = 0; i < nodes.length; i++)\n\t\t\t{\n\t\t\t\tfieldId = nodes[i].getAttribute('data-bx-block-placeholer');\n\t\t\t\tif (fieldId)\n\t\t\t\t{\n\t\t\t\t\tthis.placeHolders[fieldId] = nodes[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn [this.placeHolders, this.placeHoldersAdditional];\n\t}\n\n\tgetSettings(settings)\n\t{\n\t\tthis.pinnedFieldsIndex = {};\n\t\tlet i, pinnedFields = [];\n\n\t\tfor (i in settings.pinnedFields)\n\t\t{\n\t\t\tif (settings.pinnedFields.hasOwnProperty(i))\n\t\t\t{\n\t\t\t\tpinnedFields.push(settings.pinnedFields[i]);\n\t\t\t\tthis.pinnedFieldsIndex[settings.pinnedFields[i]] = true;\n\t\t\t}\n\t\t}\n\t\tsettings.pinnedFields = pinnedFields;\n\t\treturn settings;\n\t}\n\n\tsaveSettings()\n\t{\n\t\tlet fieldName, pinnedFields = [];\n\n\t\tfor (fieldName in this.pinnedFieldsIndex)\n\t\t{\n\t\t\tif (this.pinnedFieldsIndex.hasOwnProperty(fieldName) && this.pinnedFieldsIndex[fieldName])\n\t\t\t{\n\t\t\t\tpinnedFields.push(fieldName);\n\t\t\t}\n\t\t}\n\n\t\tthis.formSettings.pinnedFields = pinnedFields;\n\t\tthis.BX.userOptions.save('calendar', this.formType, 'pinnedFields', pinnedFields);\n\t}\n\n\tupdateAdditionalBlockState(timeout)\n\t{\n\t\tif (timeout !== false)\n\t\t{\n\t\t\tif (this.updateAdditionalBlockTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.updateAdditionalBlockTimeout);\n\t\t\t\tthis.updateAdditionalBlockTimeout = null;\n\t\t\t}\n\t\t\tthis.updateAdditionalBlockTimeout = setTimeout(() => {this.updateAdditionalBlockState(false)}, 300);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet i, names = this.DOM.additionalBlock.getElementsByClassName('js-calendar-field-name');\n\t\t\tDom.clean(this.DOM.pinnedNamesWrap);\n\t\t\tfor (i = 0; i < names.length; i++)\n\t\t\t{\n\t\t\t\tthis.DOM.pinnedNamesWrap.appendChild(Dom.create(\"SPAN\", {props: {className: 'calendar-additional-alt-promo-text'}, html: names[i].innerHTML}));\n\t\t\t}\n\n\t\t\tif (!names.length)\n\t\t\t{\n\t\t\t\tDom.addClass(this.DOM.additionalBlockWrap, 'calendar-additional-block-hidden');\n\t\t\t}\n\t\t\telse if (Dom.hasClass(this.DOM.additionalBlockWrap, 'calendar-additional-block-hidden'))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.DOM.additionalBlockWrap, 'calendar-additional-block-hidden');\n\t\t\t}\n\n\t\t\tthis.checkLastItemBorder();\n\t\t}\n\t}\n\n\tcheckLastItemBorder()\n\t{\n\t\tlet\n\t\t\tnoBorderClass = 'no-border',\n\t\t\ti, nodes;\n\n\t\tnodes = this.DOM.mainBlock.querySelectorAll('.calendar-options-item-border');\n\t\tfor (i = 0; i < nodes.length; i++)\n\t\t{\n\t\t\tif (i === nodes.length - 1)\n\t\t\t{\n\t\t\t\tDom.addClass(nodes[i], noBorderClass);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(nodes[i], noBorderClass);\n\t\t\t}\n\t\t}\n\n\t\tnodes = this.DOM.additionalBlock.querySelectorAll('.calendar-options-item-border');\n\t\tfor (i = 0; i < nodes.length; i++)\n\t\t{\n\t\t\tif (i === nodes.length - 1)\n\t\t\t{\n\t\t\t\tDom.addClass(nodes[i], noBorderClass);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(nodes[i], noBorderClass);\n\t\t\t}\n\t\t}\n\t}\n\n\thandlePlannerSelectorChanges(event)\n\t{\n\t\tif (event instanceof BaseEvent)\n\t\t{\n\t\t\tlet data = event.getData();\n\t\t\t// Date time\n\t\t\tthis.dateTimeControl.setValue({\n\t\t\t\tfrom: data.dateFrom,\n\t\t\t\tto: data.dateTo\n\t\t\t});\n\t\t\t//this.checkLocationAccessibility();\n\t\t}\n\t}\n\n\tgetUserSelectorEntityList()\n\t{\n\t\treturn this.selectorEntityList;\n\t}\n\n\tsetUserSelectorEntityList(selectorEntityList)\n\t{\n\t\tthis.selectorEntityList = selectorEntityList;\n\t}\n\n\trefreshPlannerState()\n\t{\n\t\tlet dateTime = this.dateTimeControl.getValue();\n\t\tthis.loadPlannerData({\n\t\t\tentityList: this.getUserSelectorEntityList(),\n\t\t\tfrom: Util.formatDate(dateTime.from.getTime() - Util.getDayLength() * 3),\n\t\t\tto: Util.formatDate(dateTime.to.getTime() + Util.getDayLength() * 10),\n\t\t\ttimezone: dateTime.timezoneFrom,\n\t\t\tlocation: this.locationSelector.getTextValue()\n\t\t});\n\t}\n\n\tplannerIsShown()\n\t{\n\t\treturn this.DOM.plannerWrap && Dom.hasClass(this.DOM.plannerWrap, 'calendar-edit-planner-wrap-shown');\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif((e.ctrlKey || e.metaKey) && !e.altKey && e.keyCode === Util.getKeyCode('enter'))\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tshowError(errorList)\n\t{\n\t\tlet errorText = '';\n\n\t\tif (Type.isArray(errorList))\n\t\t{\n\t\t\terrorList.forEach((error) => {\n\t\t\t\tif (error.code === \"edit_entry_location_busy\")\n\t\t\t\t{\n\t\t\t\t\treturn Util.showFieldError(error.message, this.DOM.locationWrap, {clearTimeout: 10000});\n\t\t\t\t}\n\t\t\t\terrorText += error.message + \"\\n\";\n\t\t\t});\n\t\t}\n\n\t\tif (errorText !== '')\n\t\t{\n\t\t\talert(errorText);\n\t\t}\n\t}\n\n\tgetFormDataChanges(excludes = [])\n\t{\n\t\tconst entry = this.entry;\n\t\tlet fields = [];\n\n\t\t// Name\n\t\tif (!excludes.includes('name')\n\t\t\t&& entry.name !== this.DOM.form.name.value)\n\t\t{\n\t\t\tfields.push('name');\n\t\t}\n\n\t\t// Description\n\t\t// if (!excludes.includes('name')\n\t\t// \t&& this.descriptionValue !== this.DOM.form.desc.value)\n\t\t// {\n\t\t// \tfields.push('description');\n\t\t// }\n\n\t\t// Location\n\t\tif (!excludes.includes('location')\n\t\t\t&&\n\t\t\tthis.locationSelector.getTextLocation(Location.parseStringValue(this.entry.getLocation()))\n\t\t\t!==\n\t\t\tthis.locationSelector.getTextLocation(Location.parseStringValue(this.locationSelector.getTextValue()))\n\t\t)\n\t\t{\n\t\t\tfields.push('location');\n\t\t}\n\n\t\t// Date + time\n\t\tconst dateTime = this.dateTimeControl.getValue();\n\t\tif (!excludes.includes('date&time')\n\t\t\t&&\n\t\t\t(entry.isFullDay() !== dateTime.fullDay\n\t\t\t\t|| dateTime.from.toString() !== entry.from.toString()\n\t\t\t\t|| dateTime.to.toString() !== entry.to.toString()))\n\t\t{\n\t\t\tfields.push('date&time');\n\t\t}\n\n\t\t// Section\n\t\tif (!excludes.includes('section')\n\t\t\t&&\n\t\t\tparseInt(entry.sectionId) !== parseInt(this.DOM.sectionInput.value))\n\t\t{\n\t\t\tfields.push('section');\n\t\t}\n\n\t\t// Access codes\n\t\tif (!excludes.includes('codes')\n\t\t\t&&\n\t\t\tthis.getUserSelectorEntityList().map((item)=>{return item.entityId + ':' + item.id}).join('|')\n\t\t\t!==\n\t\t\tentry.getAttendeesEntityList().map((item)=>{return item.entityId + ':' + item.id}).join('|')\n\t\t)\n\t\t{\n\t\t\tfields.push('codes');\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\tformDataChanged()\n\t{\n\t\treturn this.getFormDataChanges().length > 0;\n\t}\n\n\tgetUserCodes()\n\t{\n\t\tconst\n\t\t\tcodes = [],\n\t\t\tvaluesInput = this.DOM.attendeesWrap.querySelectorAll('input[name=\"EVENT_DESTINATION[]\"]');\n\n\t\tfor (let i = 0; i < valuesInput.length; i++)\n\t\t{\n\t\t\tif (!codes.includes(valuesInput[i].value))\n\t\t\t{\n\t\t\t\tcodes.push(valuesInput[i].value);\n\t\t\t}\n\t\t}\n\t\treturn codes;\n\t}\n}\n"],"names":["SliderDateTimeControl","DOM","dateTimeWrap","outerContent","querySelector","UID","fromDate","toDate","fromTime","toTime","fromTimeControl","TimeSelector","input","onChangeCallback","handleTimeFromChange","bind","toTimeControl","handleTimeToChange","fullDay","defTimezoneWrap","defTimezone","fromTz","toTz","tzButton","tzOuterCont","tzCont","title","Loc","getMessage","prepareModel","bindEventHandlers","Dom","adjust","props","autocomplete","DateTimeControl","EventEditForm","options","READY","REQUEST","ERROR","name","type","ownerId","userId","parseInt","entryId","entry","formDataValue","emitter","EventEmitter","setEventNamespace","BX","Util","getBX","formSettings","pinnedFields","refreshPlanner","Runtime","debounce","refreshPlannerState","state","STATE","sliderOnClose","hide","slider","promiseResolve","sliderId","getUrl","addCustomEvent","onLoadSlider","destroy","setCurrentEntry","createContent","then","html","Type","isFunction","opened","params","formType","SidePanel","Instance","open","contentCallback","label","text","bgColor","events","onClose","onCloseComplete","onLoad","keyHandlerBind","keyHandler","Event","document","mouseUpNodeCheck","e","mousedownTarget","target","srcElement","setTimeout","window","proxy","denySliderClose","allowSliderClose","event","getSlider","content","layout","getData","get","initControls","uid","setFormValues","checkDenyClose","close","isPlainObject","id","hasExternalEmailUsers","checkEmailLimitationPopup","emailLimitationDialogShown","EntryManager","showEmailLimitationDialog","callback","save","userSettings","sendFromEmail","showConfirmedEmailDialog","isRecursive","confirmed","getFormDataChanges","length","showConfirmEditDialog","recursionMode","isMeeting","sendInvitesAgain","undefined","includes","getAttendees","find","item","STATUS","showReInviteUsersDialog","addClass","saveBtn","UI","Button","State","CLOCKING","closeBtn","DISABLED","form","value","location","locationSelector","getTextValue","editor","SaveContent","section","getCurrentSection","COLOR","toLowerCase","colorSelector","getValue","color","userOptions","ID","current_date_from","formatDate","from","rec_edit_mode","appendChild","Tag","render","clean","userSelectorValueWarp","getUserSelectorEntityList","forEach","entity","index","entityId","ajax","runAction","data","FormData","analyticsLabel","calendarAction","emailGuests","markView","getCurrentView","markCrm","markRrule","repeatSelector","getType","markMeeting","markType","response","removeClass","showEditEntryNotification","showNewEntryNotification","emit","BaseEvent","responseData","displayMobileBanner","MobileSyncBanner","showInPopup","countEventWithEmailGuestAmount","setEventWithEmailGuestAmount","busyUsersList","handleBusyUsersError","errors","error","code","push","showError","busyUsers","users","userIds","hasOwnProperty","busyUsersDialog","BusyUsersDialog","subscribe","exclude_users","join","show","denyAction","removeCustomEvent","attendeesSelector","closeAll","getSliderPage","onCustomEvent","plannerId","unbind","closeAllPopups","planner","promise","Promise","getCurrentEntry","event_id","date_from","form_type","isOpen","util","trim","set","additionalParams","uniqueId","editorId","lastUsedSection","lastSection","getSettings","setUserSelectorEntityList","attendeesEntityList","attendeesPreselectedItems","map","setUserSettings","setEventWithEmailGuestLimit","eventWithEmailGuestLimit","handleSections","sections","trackingUsersList","handleLocationData","locationFeatureEnabled","locationList","iblockMeetingRoomList","sectionId","updateEntryData","fulfill","formWrap","initFormFieldManager","initDateTimeControl","initNameControl","initEditorControl","initAttendeesControl","initPlanner","initReminderControl","initSectionSelector","initLocationControl","initRepeatRuleControl","initColorControl","initCrmUfControl","initAdditionalControls","checkLastItemBorder","entryData","Entry","prepareData","getTimezoneFrom","getTimezoneTo","setTimezone","timezoneName","timezoneDefaultName","sectionIndex","isArray","ind","Location","setLocationList","setMeetingRoomList","dateTimeControl","setValue","to","isBoolean","timezoneFrom","timezoneTo","entryName","getName","sectionInput","getCurrentSectionId","sectionSelector","updateValue","fieldIsPinned","currentSection","pinField","getColor","reminderControl","reminder","getReminders","getRrule","accessibilityInput","accessibility","getLocation","privateEventCheckbox","checked","private","importantEventCheckbox","important","meeting_notify","meetingNotify","MEETING","NOTIFY","allow_invite","ALLOW_INVITE","allowInvite","loadPlannerData","entityList","getTime","getDayLength","timezone","isString","setFullDayMode","hasClass","mainBlock","additionalBlockWrap","additionalBlock","pinnedNamesWrap","additionalSwitch","toggleClass","getAttribute","fieldName","unPinField","showTimezone","updateSelector","focus","select","reminderValues","reminderWrap","reminderInputsWrap","Reminder","wrap","zIndex","values","create","attrs","SectionSelector","outerWrap","defaultCalendarType","defaultOwnerId","sectionList","sectionGroupList","CalendarSectionManager","getSectionGroupList","mode","NAME","selectCallback","sectionValue","setSectionId","delegate","Get","top","IsShown","customizeHtmlEditor","toolbar","controls","spoiler","remove","pCont","locationWrap","locationInput","inputName","richLocationEnabled","rruleWrap","RepeatSelector","rruleType","getDate","changeType","userSelectorWrap","userTagSelector","EntityTagSelector","dialogOptions","context","preselectedItems","handleUserSelectorChanges","entities","inviteGuestLink","emailUsers","selectMode","searchTabOptions","stubOptions","subtitle","icon","iconOpacity","arrow","renderTo","showLoader","getTags","entityType","plannerOuterWrap","Planner","minWidth","offsetWidth","handlePlannerSelectorChanges","resolve","dateFrom","dateTo","entries","entrieIds","hideLoader","attendees","avatar","smallAvatar","url","dateTime","update","colorWrap","ColorSelector","crmUfWrap","loader","getLoader","style","height","width","isDomNode","denyClose","isNull","userIndex","getEntryInstance","getPlaceholders","placeHolders","placeHoldersAdditional","field","newField","fieldHeight","offsetHeight","descriptionAdditionalWrap","firstChild","display","pinnedFieldsIndex","CheckAndReInit","saveSettings","updateAdditionalBlockState","i","fieldId","nodes","querySelectorAll","settings","timeout","updateAdditionalBlockTimeout","clearTimeout","names","getElementsByClassName","className","innerHTML","noBorderClass","selectorEntityList","plannerWrap","ctrlKey","metaKey","altKey","keyCode","getKeyCode","errorList","errorText","showFieldError","message","alert","excludes","fields","getTextLocation","parseStringValue","isFullDay","toString","getAttendeesEntityList","codes","valuesInput","attendeesWrap"],"mappings":";;;;KAIaA,qBAAb;CAAA;;CAAA;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,6BAGC;CACC,WAAKC,GAAL,CAASC,YAAT,GAAwB,KAAKD,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,yBAAxB;CACA,WAAKJ,GAAL,CAASK,QAAT,GAAoB,KAAKL,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,gBAApB;CACA,WAAKJ,GAAL,CAASM,MAAT,GAAkB,KAAKN,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,cAAlB;CACA,WAAKJ,GAAL,CAASO,QAAT,GAAoB,KAAKP,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,gBAApB;CACA,WAAKJ,GAAL,CAASQ,MAAT,GAAkB,KAAKR,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,cAAlB;CAEA,WAAKK,eAAL,GAAuB,IAAIC,8BAAJ,CAAiB;CACvCC,QAAAA,KAAK,EAAE,KAAKX,GAAL,CAASO,QADuB;CAEvCK,QAAAA,gBAAgB,EAAE,KAAKC,oBAAL,CAA0BC,IAA1B,CAA+B,IAA/B;CAFqB,OAAjB,CAAvB;CAKA,WAAKC,aAAL,GAAqB,IAAIL,8BAAJ,CAAiB;CACrCC,QAAAA,KAAK,EAAE,KAAKX,GAAL,CAASQ,MADqB;CAErCI,QAAAA,gBAAgB,EAAE,KAAKI,kBAAL,CAAwBF,IAAxB,CAA6B,IAA7B;CAFmB,OAAjB,CAArB;CAKA,WAAKd,GAAL,CAASiB,OAAT,GAAmB,KAAKjB,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,oBAAnB;CACA,WAAKJ,GAAL,CAASkB,eAAT,GAA2B,KAAKlB,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,4BAA3B;CACA,WAAKJ,GAAL,CAASmB,WAAT,GAAuB,KAAKnB,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,uBAAvB;CAEA,WAAKJ,GAAL,CAASoB,MAAT,GAAkB,KAAKpB,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,oBAAlB;CACA,WAAKJ,GAAL,CAASqB,IAAT,GAAgB,KAAKrB,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,kBAAhB;CACA,WAAKJ,GAAL,CAASsB,QAAT,GAAoB,KAAKtB,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,mBAApB;CACA,WAAKJ,GAAL,CAASuB,WAAT,GAAuB,KAAKvB,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,oBAAvB;CACA,WAAKJ,GAAL,CAASwB,MAAT,GAAkB,KAAKxB,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,0BAAlB;CAEA,WAAKJ,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,qBAAkEqB,KAAlE,GAA0EC,aAAG,CAACC,UAAJ,CAAe,kBAAf,CAA1E;CACA,WAAK3B,GAAL,CAASE,YAAT,CAAsBC,aAAtB,YAAwC,KAAKC,GAA7C,6BAA0EqB,KAA1E,GAAkFC,aAAG,CAACC,UAAJ,CAAe,sBAAf,CAAlF;CAEA,WAAKC,YAAL;CACA,WAAKC,iBAAL;CACA;CAnCF;CAAA;CAAA,mCAsCC;CACCC,MAAAA,aAAG,CAACC,MAAJ,CAAW,KAAK/B,GAAL,CAASK,QAApB,EAA8B;CAAC2B,QAAAA,KAAK,EAAE;CAACC,UAAAA,YAAY,EAAE;CAAf;CAAR,OAA9B;CACAH,MAAAA,aAAG,CAACC,MAAJ,CAAW,KAAK/B,GAAL,CAASM,MAApB,EAA4B;CAAC0B,QAAAA,KAAK,EAAE;CAACC,UAAAA,YAAY,EAAE;CAAf;CAAR,OAA5B;CACAH,MAAAA,aAAG,CAACC,MAAJ,CAAW,KAAK/B,GAAL,CAASO,QAApB,EAA8B;CAACyB,QAAAA,KAAK,EAAE;CAACC,UAAAA,YAAY,EAAE;CAAf;CAAR,OAA9B;CACAH,MAAAA,aAAG,CAACC,MAAJ,CAAW,KAAK/B,GAAL,CAASQ,MAApB,EAA4B;CAACwB,QAAAA,KAAK,EAAE;CAACC,UAAAA,YAAY,EAAE;CAAf;CAAR,OAA5B;CACA;CA3CF;CAAA;CAAA,EAA2CC,iCAA3C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KCSaC,aAAb;CAeC,2BACA;CAAA,QADYC,OACZ,uEADsB,EACtB;CAAA;CAAA,6CAdM,EAcN;CAAA,iDAbU,IAaV;CAAA,6CAZM,IAYN;CAAA,kDAXW,4BAWX;CAAA,gDAVS,IAUT;CAAA,mDATY,KASZ;CAAA,kDARW,aAQX;CAAA,+CAPQ;CAACC,MAAAA,KAAK,EAAE,CAAR;CAAWC,MAAAA,OAAO,EAAE,CAApB;CAAuBC,MAAAA,KAAK,EAAE;CAA9B,KAOR;CAAA,kDANW,EAMX;CAAA,sDALe,EAKf;CAAA,2DAJoB,EAIpB;CAAA,sDAHe,EAGf;CACC,SAAKC,IAAL,GAAYJ,OAAO,CAACI,IAAR,IAAgB,eAA5B;CACA,SAAKC,IAAL,GAAYL,OAAO,CAACK,IAAR,IAAgB,MAA5B;CACA,SAAKC,OAAL,GAAeN,OAAO,CAACM,OAAvB;CACA,SAAKC,MAAL,GAAcP,OAAO,CAACO,MAAR,IAAkBC,QAAQ,CAAClB,aAAG,CAACC,UAAJ,CAAe,SAAf,CAAD,CAAxC;CACA,SAAKkB,OAAL,GAAeD,QAAQ,CAACR,OAAO,CAACS,OAAT,CAAvB;CACA,SAAKC,KAAL,GAAaV,OAAO,CAACU,KAAR,IAAiB,IAA9B;CACA,SAAKC,aAAL,GAAqBX,OAAO,CAACW,aAAR,IAAyB,EAA9C;CACA,SAAKC,OAAL,GAAe,IAAIC,6BAAJ,EAAf;CACA,SAAKD,OAAL,CAAaE,iBAAb,CAA+B,2BAA/B;CACA,SAAKC,EAAL,GAAUC,kBAAI,CAACC,KAAL,EAAV;CACA,SAAKC,YAAL,GAAoB;CACnBC,MAAAA,YAAY,EAAG;CADI,KAApB;;CAGA,QAAI,CAAC,KAAKb,OAAN,IAAiB,KAAKD,IAAL,KAAc,MAAnC,EACA;CACC,WAAKC,OAAL,GAAeE,QAAQ,CAAClB,aAAG,CAACC,UAAJ,CAAe,SAAf,CAAD,CAAvB;CACA;;CAED,SAAK6B,cAAL,GAAsBC,iBAAO,CAACC,QAAR,CAAiB,KAAKC,mBAAtB,EAA2C,GAA3C,EAAgD,IAAhD,CAAtB;CAEA,SAAKC,KAAL,GAAa,KAAKC,KAAL,CAAWxB,KAAxB;CACA,SAAKyB,aAAL,GAAqB,KAAKC,IAAL,CAAUjD,IAAV,CAAe,IAAf,CAArB;CACA;;CAvCF;CAAA;CAAA,iCAyCckD,MAzCd,EAyCsBC,cAzCtB,EA0CC;CACC,WAAKC,QAAL,GAAgBF,MAAM,CAACG,MAAP,EAAhB;CACA,WAAKhB,EAAL,CAAQiB,cAAR,CAAuBJ,MAAvB,EAA+B,yBAA/B,EAA0D,KAAKK,YAAL,CAAkBvD,IAAlB,CAAuB,IAAvB,CAA1D;CACA,WAAKqC,EAAL,CAAQiB,cAAR,CAAuBJ,MAAvB,EAA+B,0BAA/B,EAA2D,KAAKF,aAAhE;CACA,WAAKX,EAAL,CAAQiB,cAAR,CAAuBJ,MAAvB,EAA+B,wCAA/B,EAAyE,KAAKM,OAAL,CAAaxD,IAAb,CAAkB,IAAlB,CAAzE;CACA,WAAKyD,eAAL,CAAqB,KAAKzB,KAAL,IAAc,IAAnC;CAEA,WAAK0B,aAAL,CAAmBR,MAAnB,EAA2BS,IAA3B,CAAgC,UAASC,IAAT,EAC/B;CACC,YAAIC,cAAI,CAACC,UAAL,CAAgBX,cAAhB,CAAJ,EACA;CACCA,UAAAA,cAAc,CAACS,IAAD,CAAd;CACA;CACD,OAN8B,CAM7B5D,IAN6B,CAMxB,IANwB,CAAhC;CASA,WAAK+D,MAAL,GAAc,IAAd;CACA,WAAKhD,iBAAL;CACA;CA5DF;CAAA;CAAA,2BA+DC;CAAA,UADKiD,MACL,uEADc,EACd;CACC,WAAKP,eAAL,CAAqBO,MAAM,CAAChC,KAA5B;;CACA,UAAIgC,MAAM,CAACC,QAAX,EACA;CACC,aAAKA,QAAL,GAAgBD,MAAM,CAACC,QAAvB;CACA;;CAED,WAAK5B,EAAL,CAAQ6B,SAAR,CAAkBC,QAAlB,CAA2BC,IAA3B,CAAgC,KAAKhB,QAArC,EAA+C;CAC9CiB,QAAAA,eAAe,EAAE,KAAKX,aAAL,CAAmB1D,IAAnB,CAAwB,IAAxB,CAD6B;CAE9CsE,QAAAA,KAAK,EAAE;CACNC,UAAAA,IAAI,EAAE3D,aAAG,CAACC,UAAJ,CAAe,gBAAf,CADA;CAEN2D,UAAAA,OAAO,EAAE;CAFH,SAFuC;CAM9CC,QAAAA,MAAM,EAAE;CACPC,UAAAA,OAAO,EAAE,KAAK1B,aADP;CAEP2B,UAAAA,eAAe,EAAE,KAAKnB,OAAL,CAAaxD,IAAb,CAAkB,IAAlB,CAFV;CAGP4E,UAAAA,MAAM,EAAE,KAAKrB,YAAL,CAAkBvD,IAAlB,CAAuB,IAAvB;CAHD;CANsC,OAA/C;CAaA,WAAK+D,MAAL,GAAc,IAAd;CACA,WAAKhD,iBAAL;CACA;CArFF;CAAA;CAAA,+BAwFC;CACC,aAAO,KAAKgD,MAAZ;CACA;CA1FF;CAAA;CAAA,wCA6FC;CAAA;;CACC,WAAKc,cAAL,GAAsB,KAAKC,UAAL,CAAgB9E,IAAhB,CAAqB,IAArB,CAAtB;CACA+E,MAAAA,eAAK,CAAC/E,IAAN,CAAWgF,QAAX,EAAqB,SAArB,EAAgC,KAAKH,cAArC,EAFD;;CAKC,WAAKI,gBAAL,GAAwB,IAAxB;CAEAF,MAAAA,eAAK,CAAC/E,IAAN,CAAWgF,QAAX,EAAqB,WAArB,EAAkC,UAACE,CAAD,EAAK;CAAC,QAAA,KAAI,CAACC,eAAL,GAAuBD,CAAC,CAACE,MAAF,IAAYF,CAAC,CAACG,UAArC;CAAiD,OAAzF;CACAN,MAAAA,eAAK,CAAC/E,IAAN,CAAWgF,QAAX,EAAqB,SAArB,EAAgC,UAACE,CAAD,EAAK;CACpC,YAAIE,MAAM,GAAGF,CAAC,CAACE,MAAF,IAAYF,CAAC,CAACG,UAA3B;;CACA,YAAI,KAAI,CAACF,eAAL,KAAyBC,MAA7B,EACA;CACC,UAAA,KAAI,CAACH,gBAAL,GAAwB,KAAxB;CACA;;CACDK,QAAAA,UAAU,CAAC,YAAI;CAAC,UAAA,KAAI,CAACL,gBAAL,GAAwB,IAAxB;CAA8B,SAApC,EAAsC,CAAtC,CAAV;CACA,OAPD,EARD;;CAkBC,WAAK5C,EAAL,CAAQiB,cAAR,CAAuBiC,MAAvB,EAA+B,kCAA/B,EAAmE,KAAKlD,EAAL,CAAQmD,KAAR,CAAc,KAAKC,eAAnB,EAAoC,IAApC,CAAnE;CACA,WAAKpD,EAAL,CAAQiB,cAAR,CAAuBiC,MAAvB,EAA+B,mCAA/B,EAAoE,KAAKlD,EAAL,CAAQmD,KAAR,CAAc,KAAKE,gBAAnB,EAAqC,IAArC,CAApE;CACA;CAjHF;CAAA;CAAA,iCAmHcC,KAnHd,EAoHC;CACC,WAAKzC,MAAL,GAAcyC,KAAK,CAACC,SAAN,EAAd;CACA,WAAK1G,GAAL,CAAS2G,OAAT,GAAmB,KAAK3C,MAAL,CAAY4C,MAAZ,CAAmBD,OAAtC;CACA,WAAKzC,QAAL,GAAgB,KAAKF,MAAL,CAAYG,MAAZ,EAAhB,CAHD;;CAMC,WAAKhB,EAAL,CAAQuB,IAAR,CAAa,KAAKV,MAAL,CAAY4C,MAAZ,CAAmBD,OAAhC,EAAyC,KAAK3C,MAAL,CAAY6C,OAAZ,GAAsBC,GAAtB,CAA0B,eAA1B,CAAzC;CACA,WAAKC,YAAL,CAAkB,KAAKC,GAAvB;CACA,WAAKC,aAAL;CACA;CA7HF;CAAA;CAAA,4BAgIC;CACC,UAAI,CAAC,KAAKC,cAAL,EAAL,EACA;CACC,aAAKtD,KAAL,GAAa,KAAKC,KAAL,CAAWxB,KAAxB;CACA,aAAKc,EAAL,CAAQ6B,SAAR,CAAkBC,QAAlB,CAA2BkC,KAA3B;CACA;CACD;CAtIF;CAAA;CAAA,2BAyIC;CAAA;;CAAA,UADK/E,OACL,uEADe,EACf;CACC,UAAI,KAAKwB,KAAL,KAAe,KAAKC,KAAL,CAAWvB,OAA9B,EACC;CACDF,MAAAA,OAAO,GAAGuC,cAAI,CAACyC,aAAL,CAAmBhF,OAAnB,IAA8BA,OAA9B,GAAwC,EAAlD;;CACA,UAAI,CAAC,KAAKU,KAAL,CAAWuE,EAAZ,IACA,KAAKC,qBAAL,EADA,IAEAlE,kBAAI,CAACmE,yBAAL,EAFA,IAGA,CAACnF,OAAO,CAACoF,0BAHb,EAIA;CACCC,QAAAA,2BAAY,CAACC,yBAAb,CAAuC;CACtCC,UAAAA,QAAQ,EAAE,oBAAM;CACfvF,YAAAA,OAAO,CAACoF,0BAAR,GAAqC,IAArC;;CACA,YAAA,MAAI,CAACI,IAAL,CAAUxF,OAAV;CACA;CAJqC,SAAvC;CAMA,eAAO,KAAP;CACA;;CAED,UAAI,CAAC,KAAKyF,YAAL,CAAkBC,aAAnB,IAAoC,KAAKR,qBAAL,EAAxC,EACA;CACCG,QAAAA,2BAAY,CAACM,wBAAb,CAAsC;CACrCJ,UAAAA,QAAQ,EAAE,kBAAC7C,MAAD,EAAY;CACrB,gBAAIA,MAAM,CAACgD,aAAX,EACA;CACC,cAAA,MAAI,CAACD,YAAL,CAAkBC,aAAlB,GAAkChD,MAAM,CAACgD,aAAzC;CACA;;CACD,YAAA,MAAI,CAACF,IAAL,CAAUxF,OAAV;CACA;CAPoC,SAAtC;CASA,eAAO,KAAP;CACA;;CAED,UAAI,KAAKU,KAAL,CAAWuE,EAAX,IAAiB,KAAKvE,KAAL,CAAWkF,WAAX,EAAjB,IACA,CAAC5F,OAAO,CAAC6F,SADT,IAEA,KAAKC,kBAAL,CAAwB,CAAC,SAAD,EAAY,QAAZ,CAAxB,EAA+CC,MAA/C,GAAwD,CAF5D,EAGA;CACCV,QAAAA,2BAAY,CAACW,qBAAb,CAAmC;CAClCT,UAAAA,QAAQ,EAAE,kBAAC7C,MAAD,EAAY;CACrB,YAAA,MAAI,CAAC8C,IAAL,CAAU;CACTS,cAAAA,aAAa,EAAEvD,MAAM,CAACuD,aADb;CAETJ,cAAAA,SAAS,EAAE;CAFF,aAAV;CAIA;CANiC,SAAnC;CAQA,eAAO,KAAP;CACA;;CAED,UAAI,KAAKnF,KAAL,CAAWuE,EAAX,IACA,KAAKvE,KAAL,CAAWwF,SAAX,EADA,IAEAlG,OAAO,CAACmG,gBAAR,KAA6BC,SAF7B,IAGA,KAAKN,kBAAL,GAA0BO,QAA1B,CAAmC,WAAnC,CAHA,IAIA,KAAK3F,KAAL,CAAW4F,YAAX,GAA0BC,IAA1B,CAA+B,UAACC,IAAD,EAAU;CAAC,eAAOA,IAAI,CAACC,MAAL,KAAgB,GAAvB;CAA4B,OAAtE,CAJJ,EAMA;CACCpB,QAAAA,2BAAY,CAACqB,uBAAb,CAAqC;CACpCnB,UAAAA,QAAQ,EAAE,kBAAC7C,MAAD,EAAY;CACrB1C,YAAAA,OAAO,CAACmG,gBAAR,GAA2BzD,MAAM,CAACyD,gBAAlC;;CACA,YAAA,MAAI,CAACX,IAAL,CAAUxF,OAAV;CACA;CAJmC,SAArC;CAMA,eAAO,KAAP;CACA;;CAEDN,MAAAA,aAAG,CAACiH,QAAJ,CAAa,KAAK/I,GAAL,CAASgJ,OAAtB,EAA+B,KAAK7F,EAAL,CAAQ8F,EAAR,CAAWC,MAAX,CAAkBC,KAAlB,CAAwBC,QAAvD;CACAtH,MAAAA,aAAG,CAACiH,QAAJ,CAAa,KAAK/I,GAAL,CAASqJ,QAAtB,EAAgC,KAAKlG,EAAL,CAAQ8F,EAAR,CAAWC,MAAX,CAAkBC,KAAlB,CAAwBG,QAAxD;CACA,WAAK1F,KAAL,GAAa,KAAKC,KAAL,CAAWvB,OAAxB;CAEA,WAAKtC,GAAL,CAASuJ,IAAT,CAAclC,EAAd,CAAiBmC,KAAjB,GAAyB,KAAK1G,KAAL,CAAWuE,EAAX,IAAiB,CAA1C,CAnED;;CAsEC,WAAKrH,GAAL,CAASuJ,IAAT,CAAcE,QAAd,CAAuBD,KAAvB,GAA+B,KAAKE,gBAAL,CAAsBC,YAAtB,EAA/B;;CAEA,UAAI,KAAKC,MAAT,EACA;CACC,aAAKA,MAAL,CAAYC,WAAZ;CACA;;CAED,UAAIC,OAAO,GAAG,KAAKC,iBAAL,EAAd;;CACA,UAAID,OAAJ,EACA;CACC;CACA,YAAIA,OAAO,CAACE,KAAR,CAAcC,WAAd,OAAgC,KAAKC,aAAL,CAAmBC,QAAnB,GAA8BF,WAA9B,EAApC,EACA;CACC,eAAKjK,GAAL,CAASuJ,IAAT,CAAca,KAAd,CAAoBZ,KAApB,GAA4B,KAAKU,aAAL,CAAmBC,QAAnB,EAA5B;CACA;;CACD,aAAKhH,EAAL,CAAQkH,WAAR,CAAoBzC,IAApB,CAAyB,UAAzB,EAAqC,eAArC,EAAsD,iBAAtD,EAAyEhF,QAAQ,CAACkH,OAAO,CAACQ,EAAT,CAAjF;CACA;;CAED,WAAKtK,GAAL,CAASuJ,IAAT,CAAcgB,iBAAd,CAAgCf,KAAhC,GAAwCpH,OAAO,CAACiG,aAAR,GAAwBjF,kBAAI,CAACoH,UAAL,CAAgB,KAAK1H,KAAL,CAAW2H,IAA3B,CAAxB,GAA2D,EAAnG;CACA,WAAKzK,GAAL,CAASuJ,IAAT,CAAcmB,aAAd,CAA4BlB,KAA5B,GAAoCpH,OAAO,CAACiG,aAAR,IAAyB,EAA7D;;CAEA,UAAIjG,OAAO,CAACmG,gBAAR,KAA6BC,SAAjC,EACA;CACC,aAAKxI,GAAL,CAASuJ,IAAT,CAAcoB,WAAd,CAA0BC,aAAG,CAACC,MAA9B,oBAA2FzI,OAAO,CAACmG,gBAAR,GAA2B,GAA3B,GAAiC,GAA5H;CACA,OA9FF;;;CAiGCzG,MAAAA,aAAG,CAACgJ,KAAJ,CAAU,KAAK9K,GAAL,CAAS+K,qBAAnB;CACA,WAAKC,yBAAL,GAAiCC,OAAjC,CAAyC,UAACC,MAAD,EAASC,KAAT,EAAmB;CAC3D,QAAA,MAAI,CAACnL,GAAL,CAAS+K,qBAAT,CAA+BJ,WAA/B,CAA2CC,aAAG,CAACC,MAA/C,qBACkDM,KADlD,EAC8ED,MAAM,CAACE,QADrF;;CAGA,QAAA,MAAI,CAACpL,GAAL,CAAS+K,qBAAT,CAA+BJ,WAA/B,CAA2CC,aAAG,CAACC,MAA/C,qBACkDM,KADlD,EACwED,MAAM,CAAC7D,EAD/E;CAGA,OAPD;CASA,WAAKlE,EAAL,CAAQkI,IAAR,CAAaC,SAAb,CAAuB,qCAAvB,EAA8D;CAC7DC,QAAAA,IAAI,EAAE,IAAIC,QAAJ,CAAa,KAAKxL,GAAL,CAASuJ,IAAtB,CADuD;CAE7DkC,QAAAA,cAAc,EAAE;CACfC,UAAAA,cAAc,EAAE,KAAK5I,KAAL,CAAWuE,EAAX,GAAgB,YAAhB,GAA+B,cADhC;CAEftC,UAAAA,QAAQ,EAAE,MAFK;CAGf4G,UAAAA,WAAW,EAAE,KAAKrE,qBAAL,KAA+B,GAA/B,GAAqC,GAHnC;CAIfsE,UAAAA,QAAQ,EAAExI,kBAAI,CAACyI,cAAL,MAAyB,SAJpB;CAKfC,UAAAA,OAAO,EAAE,KAAK9L,GAAL,CAASuJ,IAAT,CAAc,oBAAd,KAAuC,KAAKvJ,GAAL,CAASuJ,IAAT,CAAc,oBAAd,EAAoCC,KAA3E,GAAmF,GAAnF,GAAyF,GALnF;CAMfuC,UAAAA,SAAS,EAAE,KAAKC,cAAL,CAAoBC,OAApB,EANI;CAOfC,UAAAA,WAAW,EAAE,KAAKpJ,KAAL,CAAWwF,SAAX,KAAyB,GAAzB,GAA+B,GAP7B;CAQf6D,UAAAA,QAAQ,EAAE,KAAK1J;CARA;CAF6C,OAA9D,EAYGgC,IAZH,CAYQ,UAAC2H,QAAD,EAAc;CACpBtK,QAAAA,aAAG,CAACuK,WAAJ,CAAgB,MAAI,CAACrM,GAAL,CAASgJ,OAAzB,EAAkC,MAAI,CAAC7F,EAAL,CAAQ8F,EAAR,CAAWC,MAAX,CAAkBC,KAAlB,CAAwBC,QAA1D;CACAtH,QAAAA,aAAG,CAACuK,WAAJ,CAAgB,MAAI,CAACrM,GAAL,CAASqJ,QAAzB,EAAmC,MAAI,CAAClG,EAAL,CAAQ8F,EAAR,CAAWC,MAAX,CAAkBC,KAAlB,CAAwBG,QAA3D;CAEA,QAAA,MAAI,CAAC1F,KAAL,GAAa,MAAI,CAACC,KAAL,CAAWxB,KAAxB;;CACA,YAAI+J,QAAQ,CAACb,IAAT,CAAc1I,OAAlB,EACA;CACC,cAAI,MAAI,CAACC,KAAL,CAAWuE,EAAf,EACA;CACCI,YAAAA,2BAAY,CAAC6E,yBAAb,CAAuCF,QAAQ,CAACb,IAAT,CAAc1I,OAArD;CACA,WAHD,MAKA;CACC4E,YAAAA,2BAAY,CAAC8E,wBAAb,CAAsCH,QAAQ,CAACb,IAAT,CAAc1I,OAApD;CACA;CACD;;CAED,QAAA,MAAI,CAACG,OAAL,CAAawJ,IAAb,CAAkB,QAAlB,EAA4B,IAAIC,0BAAJ,CAAc;CACzClB,UAAAA,IAAI,EAAE;CACLmB,YAAAA,YAAY,EAAEN,QAAQ,CAACb,IADlB;CAELnJ,YAAAA,OAAO,EAAEA;CAFJ;CADmC,SAAd,CAA5B;;CAMA,QAAA,MAAI,CAAC+E,KAAL;;CAEA,YAAIiF,QAAQ,CAACb,IAAT,CAAcoB,mBAAlB,EACA;CACC,cAAIC,wCAAJ,GAAuBC,WAAvB;CACA;;CAED,YAAIT,QAAQ,CAACb,IAAT,CAAcuB,8BAAlB,EACA;CACC1J,UAAAA,kBAAI,CAAC2J,4BAAL,CAAkCX,QAAQ,CAACb,IAAT,CAAcuB,8BAAhD;CACA;CACD,OA9CF,EA+CC,UAACV,QAAD,EAAc;CACbtK,QAAAA,aAAG,CAACuK,WAAJ,CAAgB,MAAI,CAACrM,GAAL,CAASgJ,OAAzB,EAAkC,MAAI,CAAC7F,EAAL,CAAQ8F,EAAR,CAAWC,MAAX,CAAkBC,KAAlB,CAAwBC,QAA1D;CACAtH,QAAAA,aAAG,CAACuK,WAAJ,CAAgB,MAAI,CAACrM,GAAL,CAASqJ,QAAzB,EAAmC,MAAI,CAAClG,EAAL,CAAQ8F,EAAR,CAAWC,MAAX,CAAkBC,KAAlB,CAAwBG,QAA3D;;CAEA,YAAI8C,QAAQ,CAACb,IAAT,IAAiB5G,cAAI,CAACyC,aAAL,CAAmBgF,QAAQ,CAACb,IAAT,CAAcyB,aAAjC,CAArB,EACA;CACC,UAAA,MAAI,CAACC,oBAAL,CAA0Bb,QAAQ,CAACb,IAAT,CAAcyB,aAAxC;;CAEA,cAAIE,MAAM,GAAG,EAAb;CACAd,UAAAA,QAAQ,CAACc,MAAT,CAAgBjC,OAAhB,CAAwB,UAACkC,KAAD,EAAW;CAClC,gBAAIA,KAAK,CAACC,IAAN,KAAe,sBAAnB,EACA;CACCF,cAAAA,MAAM,CAACG,IAAP,CAAYF,KAAZ;CACA;CACD,WALD;CAMAf,UAAAA,QAAQ,CAACc,MAAT,GAAkBA,MAAlB;CACA;;CAED,YAAId,QAAQ,CAACc,MAAT,IAAmBd,QAAQ,CAACc,MAAT,CAAgB/E,MAAvC,EACA;CACC,UAAA,MAAI,CAACmF,SAAL,CAAelB,QAAQ,CAACc,MAAxB;CACA;;CAED,QAAA,MAAI,CAACtJ,KAAL,GAAa,MAAI,CAACC,KAAL,CAAWtB,KAAxB;CACA,OAvEF;CAyEA;CA7TF;CAAA;CAAA,yCA+TsBgL,SA/TtB,EAgUC;CAAA;;CACC,UACCC,KAAK,GAAG,EADT;CAAA,UAECC,OAAO,GAAG,EAFX;;CAIA,WAAK,IAAIpG,EAAT,IAAekG,SAAf,EACA;CACC,YAAIA,SAAS,CAACG,cAAV,CAAyBrG,EAAzB,CAAJ,EACA;CACCmG,UAAAA,KAAK,CAACH,IAAN,CAAWE,SAAS,CAAClG,EAAD,CAApB;CACAoG,UAAAA,OAAO,CAACJ,IAAR,CAAahG,EAAb;CACA;CACD;;CAED,WAAKsG,eAAL,GAAuB,IAAIC,iCAAJ,EAAvB;CACA,WAAKD,eAAL,CAAqBE,SAArB,CAA+B,eAA/B,EAAgD,YAAM;CACrD,QAAA,MAAI,CAAC7N,GAAL,CAASuJ,IAAT,CAAcuE,aAAd,CAA4BtE,KAA5B,GAAoCiE,OAAO,CAACM,IAAR,CAAa,GAAb,CAApC;;CACA,QAAA,MAAI,CAACnG,IAAL;CACA,OAHD;CAKA,WAAK+F,eAAL,CAAqBK,IAArB,CAA0B;CAACR,QAAAA,KAAK,EAAEA;CAAR,OAA1B;CACA;CArVF;CAAA;CAAA,sCAwVC;CAxVD;CAAA;CAAA,yBA4VM/G,KA5VN,EA6VC;CACC,UAAIA,KAAK,IAAIA,KAAK,CAACC,SAAf,IAA4BD,KAAK,CAACC,SAAN,GAAkBvC,MAAlB,OAA+B,KAAKD,QAApE,EACA;CACC,YAAI,KAAKgD,cAAL,EAAJ,EACA;CACCT,UAAAA,KAAK,CAACwH,UAAN;CACA,SAHD,MAKA;CACC,eAAK9K,EAAL,CAAQ+K,iBAAR,CAA0B,2BAA1B,EAAuD,KAAKpK,aAA5D;CACA,cAAI,KAAKqK,iBAAT,EACE,KAAKA,iBAAL,CAAuBC,QAAvB;CAEF,eAAK9J,OAAL,CAAamC,KAAb;CACA;CACD;CACD;CA7WF;CAAA;CAAA,4BA+WSA,KA/WT,EAgXC;CACC,UAAIA,KAAK,IAAIA,KAAK,CAAC4H,aAAf,IAAgC5H,KAAK,CAAC4H,aAAN,GAAsBlK,MAAtB,OAAmC,KAAKD,QAA5E,EACA;CACC,aAAKf,EAAL,CAAQmL,aAAR,CAAsB,8BAAtB,EAAsD,CAAC;CAACC,UAAAA,SAAS,EAAE,KAAKA;CAAjB,SAAD,CAAtD,EADD;CAGC;CACA;CACA;;CAEA1I,QAAAA,eAAK,CAAC2I,MAAN,CAAa1I,QAAb,EAAuB,SAAvB,EAAkC,KAAKH,cAAvC,EAPD;;CAUC,aAAKxC,EAAL,CAAQ6B,SAAR,CAAkBC,QAAlB,CAA2BX,OAA3B,CAAmC,KAAKJ,QAAxC;CAEAd,QAAAA,kBAAI,CAACqL,cAAL;CAEA,aAAKC,OAAL,GAAe,IAAf;CACA,aAAK7J,MAAL,GAAc,KAAd;CACA;CACD;CAnYF;CAAA;CAAA,kCAqYeb,MArYf,EAsYC;CAAA;;CACC,UAAI2K,OAAO,GAAG,IAAI,KAAKxL,EAAL,CAAQyL,OAAZ,EAAd;CAEA,UAAI9L,KAAK,GAAG,KAAK+L,eAAL,EAAZ;CAEA,WAAK1L,EAAL,CAAQkI,IAAR,CAAaC,SAAb,CAAuB,8CAAvB,EAAuE;CACtEC,QAAAA,IAAI,EAAE;CACLuD,UAAAA,QAAQ,EAAE,KAAKjM,OAAL,IAAgBC,KAAK,CAACuE,EAD3B;CAEL0H,UAAAA,SAAS,EAAEjM,KAAK,GAAGM,kBAAI,CAACoH,UAAL,CAAgB1H,KAAK,CAAC2H,IAAtB,CAAH,GAAiC,EAF5C;CAGLuE,UAAAA,SAAS,EAAE,KAAKjK,QAHX;CAILtC,UAAAA,IAAI,EAAE,KAAKA,IAJN;CAKLC,UAAAA,OAAO,EAAE,KAAKA;CALT;CADgE,OAAvE,EASE+B,IATF;CAWE,gBAAC2H,QAAD,EAAc;CACb,YAAKzH,cAAI,CAACC,UAAL,CAAgBZ,MAAM,CAACiL,MAAvB,KAAkCjL,MAAM,CAACiL,MAAP,EAAnC,IAAuDjL,MAAM,CAACiL,MAAP,KAAkB,IAA7E,EACA;CACC,cAAIvK,IAAI,GAAG,MAAI,CAACvB,EAAL,CAAQ+L,IAAR,CAAaC,IAAb,CAAkB/C,QAAQ,CAACb,IAAT,CAAc7G,IAAhC,CAAX;;CACAV,UAAAA,MAAM,CAAC6C,OAAP,GAAiBuI,GAAjB,CAAqB,eAArB,EAAsC1K,IAAtC;CAEA,cAAII,MAAM,GAAGsH,QAAQ,CAACb,IAAT,CAAc8D,gBAA3B;CAEA,UAAA,MAAI,CAACrI,GAAL,GAAWlC,MAAM,CAACwK,QAAlB;CACA,UAAA,MAAI,CAACC,QAAL,GAAgBzK,MAAM,CAACyK,QAAvB;CACA,UAAA,MAAI,CAACC,eAAL,GAAuB1K,MAAM,CAAC2K,WAA9B;CACA,UAAA,MAAI,CAACnM,YAAL,GAAoB,MAAI,CAACoM,WAAL,CAAiB5K,MAAM,CAACxB,YAAP,IAAuB,EAAxC,CAApB;;CAEA,UAAA,MAAI,CAACqM,yBAAL,CAA+B,MAAI,CAAC5M,aAAL,CAAmB6M,mBAAnB,IAA0C9K,MAAM,CAAC8K,mBAAjD,IAAwE,EAAvG;;CAEA,UAAA,MAAI,CAACC,yBAAL,GAAiC,MAAI,CAAC7E,yBAAL,GAAiC8E,GAAjC,CAAqC,UAAClH,IAAD,EAAU;CAAC,mBAAO,CAACA,IAAI,CAACwC,QAAN,EAAgBxC,IAAI,CAACvB,EAArB,CAAP;CAAgC,WAAhF,CAAjC;;CACA,UAAA,MAAI,CAAC0I,eAAL,CAAqBjL,MAAM,CAAC+C,YAA5B;;CACAzE,UAAAA,kBAAI,CAAC2J,4BAAL,CAAkCjI,MAAM,CAACgI,8BAAzC;CACA1J,UAAAA,kBAAI,CAAC4M,2BAAL,CAAiClL,MAAM,CAACmL,wBAAxC;;CAEA,UAAA,MAAI,CAACC,cAAL,CAAoBpL,MAAM,CAACqL,QAA3B,EAAqCrL,MAAM,CAACsL,iBAA5C;;CACA,UAAA,MAAI,CAACC,kBAAL,CAAwBvL,MAAM,CAACwL,sBAA/B,EAAuDxL,MAAM,CAACyL,YAA9D,EAA4EzL,MAAM,CAAC0L,qBAAnF;;CAEA,cAAI,CAAC1N,KAAK,CAACuE,EAAP,IAAa,CAACvE,KAAK,CAAC2N,SAAxB,EACA;CACC,YAAA,MAAI,CAAClM,eAAL;CACA;;CAED,UAAA,MAAI,CAACmM,eAAL,CAAqB5L,MAAM,CAAChC,KAA5B,EAAmC;CAClC+E,YAAAA,YAAY,EAAE,MAAI,CAACA;CADe,WAAnC;;CAIA8G,UAAAA,OAAO,CAACgC,OAAR,CAAgBjM,IAAhB;CACA;CACD,OA7CH;CA+CE,gBAAC0H,QAAD,EAAY;CAEX,OAjDH;CAmDA,aAAOuC,OAAP;CACA;CA/bF;CAAA;CAAA,iCAkcc3H,GAlcd,EAmcC;CACC,WAAKhH,GAAL,CAASyB,KAAT,GAAiB,KAAKzB,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,YAAjB;CAEA,WAAKhH,GAAL,CAAS4Q,QAAT,GAAoB,KAAK5Q,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,gBAApB;CACA,WAAKhH,GAAL,CAASuJ,IAAT,GAAgB,KAAKvJ,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,WAAhB;CAEA,WAAKhH,GAAL,CAASgJ,OAAT,GAAmB,KAAKhJ,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,WAAnB;CACA,WAAKhH,GAAL,CAASqJ,QAAT,GAAoB,KAAKrJ,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,YAApB;CACAnB,MAAAA,eAAK,CAAC/E,IAAN,CAAW,KAAKd,GAAL,CAASgJ,OAApB,EAA6B,OAA7B,EAAsC,KAAKpB,IAAL,CAAU9G,IAAV,CAAe,IAAf,CAAtC;CACA+E,MAAAA,eAAK,CAAC/E,IAAN,CAAW,KAAKd,GAAL,CAASqJ,QAApB,EAA8B,OAA9B,EAAuC,KAAKlC,KAAL,CAAWrG,IAAX,CAAgB,IAAhB,CAAvC;CAEA,WAAK+P,oBAAL,CAA0B7J,GAA1B;CACA,WAAK8J,mBAAL,CAAyB9J,GAAzB;CACA,WAAK+J,eAAL,CAAqB/J,GAArB;CACA,WAAKgK,iBAAL,CAAuBhK,GAAvB;CACA,WAAKiK,oBAAL,CAA0BjK,GAA1B;CACA,WAAKkK,WAAL,CAAiBlK,GAAjB;CACA,WAAKmK,mBAAL,CAAyBnK,GAAzB;CACA,WAAKoK,mBAAL,CAAyBpK,GAAzB;CACA,WAAKqK,mBAAL,CAAyBrK,GAAzB;CACA,WAAKsK,qBAAL,CAA2BtK,GAA3B;CACA,WAAKuK,gBAAL,CAAsBvK,GAAtB;CACA,WAAKwK,gBAAL,CAAsBxK,GAAtB;CACA,WAAKyK,sBAAL,CAA4BzK,GAA5B;CAEA,WAAK0K,mBAAL;CACA;CA7dF;CAAA;CAAA,oCA+diBC,SA/djB,EAgeC;CAAA,UAD2BvP,OAC3B,uEADqC,EACrC;;CACC,UAAI,KAAKU,KAAL,YAAsB8O,oBAA1B,EACA;CACC,YAAI/J,YAAY,GAAGzF,OAAO,CAACyF,YAAR,IAAwB,EAA3C;;CAEA,YAAIlD,cAAI,CAACyC,aAAL,CAAmBuK,SAAnB,CAAJ,EACA;CACC,eAAK7O,KAAL,CAAW+O,WAAX,CAAuBF,SAAvB;CACA,SAHD,MAKA;CACC,cAAI,CAAC,KAAK7O,KAAL,CAAWgP,eAAX,EAAD,IAAiC,KAAKhP,KAAL,CAAWiP,aAAX,EAArC,EACA;CACC,iBAAKjP,KAAL,CAAWkP,WAAX,CAAuBnK,YAAY,CAACoK,YAAb,IAA6BpK,YAAY,CAACqK,mBAA1C,IAAiE,IAAxF;CACA;CACD;CACD;CACD;CAjfF;CAAA;CAAA,mCAmfgB/B,QAnfhB,EAmf0BC,iBAnf1B,EAofC;CAAA;;CACC,WAAKD,QAAL,GAAgBA,QAAhB;CACA,WAAKgC,YAAL,GAAoB,EAApB;CACA,WAAK/B,iBAAL,GAAyBA,iBAAiB,IAAI,EAA9C;;CAEA,UAAIzL,cAAI,CAACyN,OAAL,CAAajC,QAAb,CAAJ,EACA;CACCA,QAAAA,QAAQ,CAAClF,OAAT,CAAiB,UAACzB,KAAD,EAAQ6I,GAAR,EAAgB;CAAC,UAAA,MAAI,CAACF,YAAL,CAAkBvP,QAAQ,CAAC4G,KAAK,CAACc,EAAP,CAA1B,IAAwC+H,GAAxC;CAA6C,SAA/E,EAAiF,IAAjF;CACA;CACD;CA7fF;CAAA;CAAA,uCA+foB/B,sBA/fpB,EA+f4CC,YA/f5C,EA+f0DC,qBA/f1D,EAggBC;CACC,WAAKF,sBAAL,GAA8B,CAAC,CAACA,sBAAhC;CACA,WAAKC,YAAL,GAAoBA,YAAY,IAAI,EAApC;CACA,WAAKC,qBAAL,GAA6BA,qBAAqB,IAAI,EAAtD;CAEA8B,MAAAA,0BAAQ,CAACC,eAAT,CAAyBhC,YAAzB;CACA+B,MAAAA,0BAAQ,CAACE,kBAAT,CAA4BhC,qBAA5B;CACA;CAvgBF;CAAA;CAAA,oCAygBiB3I,YAzgBjB,EA0gBC;CACC,WAAKA,YAAL,GAAoBA,YAApB;CACA;CA5gBF;CAAA;CAAA,oCA+gBC;CACC,UAAI/E,KAAK,GAAG,KAAKA,KAAjB,CADD;;CAIC,WAAK2P,eAAL,CAAqBC,QAArB,CAA8B;CAC7BjI,QAAAA,IAAI,EAAE,KAAK1H,aAAL,CAAmB0H,IAAnB,IAA2B3H,KAAK,CAAC2H,IADV;CAE7BkI,QAAAA,EAAE,EAAE,KAAK5P,aAAL,CAAmB4P,EAAnB,IAAyB7P,KAAK,CAAC6P,EAFN;CAG7B1R,QAAAA,OAAO,EAAE0D,cAAI,CAACiO,SAAL,CAAe,KAAK7P,aAAL,CAAmB9B,OAAlC,IAA6C,KAAK8B,aAAL,CAAmB9B,OAAhE,GAA0E6B,KAAK,CAAC7B,OAH5D;CAI7B4R,QAAAA,YAAY,EAAE/P,KAAK,CAACgP,eAAN,MAA2B,EAJZ;CAK7BgB,QAAAA,UAAU,EAAEhQ,KAAK,CAACiP,aAAN,MAAyB,EALR;CAM7BE,QAAAA,YAAY,EAAE,KAAKpK,YAAL,CAAkBoK;CANH,OAA9B;CASA,WAAKjS,GAAL,CAAS+S,SAAT,CAAmBvJ,KAAnB,GAA2B,KAAKzG,aAAL,CAAmBP,IAAnB,IAA2BM,KAAK,CAACkQ,OAAN,EAAtD,CAbD;;CAgBC,WAAKhT,GAAL,CAASiT,YAAT,CAAsBzJ,KAAtB,GAA8B,KAAKzG,aAAL,CAAmB+G,OAAnB,IAA8B,KAAKoJ,mBAAL,EAA5D;CACA,WAAKC,eAAL,CAAqBC,WAArB;;CAEA,UAAI,CAAC,KAAKC,aAAL,CAAmB,SAAnB,CAAL,EACA;CACC,YAAIC,cAAc,GAAG,KAAKvJ,iBAAL,EAArB;;CACA,YAAIuJ,cAAc,CAAC,UAAD,CAAd,KAA+B,KAAK7Q,IAApC,IAA4C6Q,cAAc,CAAC,UAAD,CAAd,KAA+B,KAAK7Q,IAApC,IAA4CG,QAAQ,CAAC0Q,cAAc,CAAC,UAAD,CAAf,CAAR,KAAyC,KAAK5Q,OAA1I,EACA;CACC,eAAK6Q,QAAL,CAAc,SAAd;CACA;CACD,OA1BF;;;CA6BC,WAAKrJ,aAAL,CAAmBwI,QAAnB,CAA4B,KAAK3P,aAAL,CAAmBqH,KAAnB,IAA4BtH,KAAK,CAAC0Q,QAAN,EAA5B,IAAgD,KAAKzJ,iBAAL,GAAyBC,KAArG,EA7BD;;CAgCC,WAAKyJ,eAAL,CAAqBf,QAArB,CAA8B,KAAK3P,aAAL,CAAmB2Q,QAAnB,IAA+B5Q,KAAK,CAAC6Q,YAAN,EAA7D,EAhCD;;CAmCC,WAAK3H,cAAL,CAAoB0G,QAApB,CAA6B5P,KAAK,CAAC8Q,QAAN,EAA7B,EAnCD;;CAsCC,UAAI,KAAK5T,GAAL,CAAS6T,kBAAb,EACA;CACC,aAAK7T,GAAL,CAAS6T,kBAAT,CAA4BrK,KAA5B,GAAoC1G,KAAK,CAACgR,aAA1C;CACA,OAzCF;;;CA4CC,WAAKpK,gBAAL,CAAsBgJ,QAAtB,CAA+B,KAAK3P,aAAL,CAAmB0G,QAAnB,IAA+B3G,KAAK,CAACiR,WAAN,EAA9D,EA5CD;;CA+CC,UAAI,KAAK/T,GAAL,CAASgU,oBAAb,EACA;CACC,aAAKhU,GAAL,CAASgU,oBAAT,CAA8BC,OAA9B,GAAwCnR,KAAK,CAACoR,OAA9C;CACA,OAlDF;;;CAqDC,UAAI,KAAKlU,GAAL,CAASmU,sBAAb,EACA;CACC,aAAKnU,GAAL,CAASmU,sBAAT,CAAgCF,OAAhC,GAA0CnR,KAAK,CAACsR,SAAhD;CACA;;CAED,UAAI,KAAKpU,GAAL,CAASuJ,IAAT,CAAc8K,cAAlB,EACA;CACC,YAAI,KAAKtR,aAAL,CAAmBuR,aAAnB,KAAqC9L,SAAzC,EACA;CACC,eAAKxI,GAAL,CAASuJ,IAAT,CAAc8K,cAAd,CAA6BJ,OAA7B,GAAuC,KAAKlR,aAAL,CAAmBuR,aAA1D;CACA;;CACD,YAAI,KAAKxR,KAAL,CAAWyI,IAAX,IAAmB,KAAKzI,KAAL,CAAWyI,IAAX,CAAgBgJ,OAAvC,EACA;CACC,eAAKvU,GAAL,CAASuJ,IAAT,CAAc8K,cAAd,CAA6BJ,OAA7B,GAAuC,KAAKnR,KAAL,CAAWyI,IAAX,CAAgBgJ,OAAhB,CAAwBC,MAA/D;CACA,SAHD,MAKA;CACC,eAAKxU,GAAL,CAASuJ,IAAT,CAAc8K,cAAd,CAA6BJ,OAA7B,GAAuC,IAAvC,CADD;CAEC;CACD;;CAED,UAAI,KAAKjU,GAAL,CAASuJ,IAAT,CAAckL,YAAlB,EACA;CACC,YAAI,KAAK3R,KAAL,CAAWyI,IAAf,EACA;CACC,eAAKvL,GAAL,CAASuJ,IAAT,CAAckL,YAAd,CAA2BR,OAA3B,GAAqC,KAAKnR,KAAL,CAAWyI,IAAX,CAAgBgJ,OAAhB,IAA2B,KAAKzR,KAAL,CAAWyI,IAAX,CAAgBgJ,OAAhB,CAAwBG,YAAxF;CACA,SAHD,MAKA;CACC,eAAK1U,GAAL,CAASuJ,IAAT,CAAckL,YAAd,CAA2BR,OAA3B,GAAqC,KAAKnR,KAAL,CAAW6R,WAAhD;CACA;CACD;;CAED,WAAKC,eAAL,CAAqB;CACpBC,QAAAA,UAAU,EAAE,KAAK7J,yBAAL,EADQ;CAEpBP,QAAAA,IAAI,EAAErH,kBAAI,CAACoH,UAAL,CAAgB1H,KAAK,CAAC2H,IAAN,CAAWqK,OAAX,KAAuB1R,kBAAI,CAAC2R,YAAL,KAAsB,CAA7D,CAFc;CAGpBpC,QAAAA,EAAE,EAAEvP,kBAAI,CAACoH,UAAL,CAAgB1H,KAAK,CAAC6P,EAAN,CAASmC,OAAT,KAAqB1R,kBAAI,CAAC2R,YAAL,KAAsB,EAA3D,CAHgB;CAIpBC,QAAAA,QAAQ,EAAElS,KAAK,CAACgP,eAAN,EAJU;CAKpBrI,QAAAA,QAAQ,EAAE,KAAKC,gBAAL,CAAsBC,YAAtB;CALU,OAArB;CAOA;CA5mBF;CAAA;CAAA,kCA8mBeH,KA9mBf,EA+mBC;CACCA,MAAAA,KAAK,GAAG,CAAC,CAAC,KAAKxJ,GAAL,CAASiB,OAAT,CAAiBgT,OAA3B;;CACA,UAAIzK,KAAK,IAAI7E,cAAI,CAACsQ,QAAL,CAAc,KAAKpN,YAAL,CAAkBoK,YAAhC,CAAT,KACC,CAAC,KAAKjS,GAAL,CAASoB,MAAT,CAAgBoI,KAAjB,IAA0B,CAAC,KAAKxJ,GAAL,CAASqB,IAAT,CAAcmI,KAD1C,CAAJ,EAEA;CACC,aAAKxJ,GAAL,CAASoB,MAAT,CAAgBoI,KAAhB,GAAwB,KAAK3B,YAAL,CAAkBoK,YAA1C;CACA,aAAKjS,GAAL,CAASqB,IAAT,CAAcmI,KAAd,GAAsB,KAAK3B,YAAL,CAAkBoK,YAAxC;CACA,aAAKjS,GAAL,CAASmB,WAAT,CAAqBqI,KAArB,GAA6B,KAAK3B,YAAL,CAAkBoK,YAA/C;CACA;;CAED,UAAIzI,KAAJ,EACA;CACC1H,QAAAA,aAAG,CAACiH,QAAJ,CAAa,KAAK/I,GAAL,CAASC,YAAtB,EAAoC,0CAApC;CACA,OAHD,MAKA;CACC6B,QAAAA,aAAG,CAACuK,WAAJ,CAAgB,KAAKrM,GAAL,CAASC,YAAzB,EAAuC,0CAAvC;CACA;;CAED,UAAG,KAAKwT,eAAR,EACA;CACC,aAAKA,eAAL,CAAqByB,cAArB,CAAoC1L,KAApC;CACA;;CAED,WAAKhG,cAAL;CACA;CAxoBF;CAAA;CAAA,qCA2oBC;CACC,UAAI1B,aAAG,CAACqT,QAAJ,CAAa,KAAKnV,GAAL,CAASwB,MAAtB,EAA8B,oCAA9B,CAAJ,EACA;CACCM,QAAAA,aAAG,CAACiH,QAAJ,CAAa,KAAK/I,GAAL,CAASwB,MAAtB,EAA8B,kCAA9B;CACAM,QAAAA,aAAG,CAACuK,WAAJ,CAAgB,KAAKrM,GAAL,CAASwB,MAAzB,EAAiC,oCAAjC;CACA,OAJD,MAMA;CACCM,QAAAA,aAAG,CAACiH,QAAJ,CAAa,KAAK/I,GAAL,CAASwB,MAAtB,EAA8B,oCAA9B;CACAM,QAAAA,aAAG,CAACuK,WAAJ,CAAgB,KAAKrM,GAAL,CAASwB,MAAzB,EAAiC,kCAAjC;CACA;CACD;CAtpBF;CAAA;CAAA,yCAwpBsBwF,GAxpBtB,EAypBC;CAAA;;CACC,WAAKhH,GAAL,CAASoV,SAAT,GAAqB,KAAKpV,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,sBAArB;CACA,WAAKhH,GAAL,CAASqV,mBAAT,GAA+B,KAAKrV,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,4BAA/B;CACA,WAAKhH,GAAL,CAASsV,eAAT,GAA2B,KAAKtV,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,uBAA3B;CACA,WAAKhH,GAAL,CAASuV,eAAT,GAA2B,KAAKvV,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,8BAA3B;CACA,WAAKhH,GAAL,CAASwV,gBAAT,GAA4B,KAAKxV,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,wBAA5B;CAEAnB,MAAAA,eAAK,CAAC/E,IAAN,CAAW,KAAKd,GAAL,CAASwV,gBAApB,EAAsC,OAAtC,EAA+C,YAAM;CACpD1T,QAAAA,aAAG,CAAC2T,WAAJ,CAAgB,MAAI,CAACzV,GAAL,CAASwV,gBAAzB,EAA2C,QAA3C;CACA1T,QAAAA,aAAG,CAAC2T,WAAJ,CAAgB,MAAI,CAACzV,GAAL,CAASsV,eAAzB,EAA0C,WAA1C;CACA,OAHD;CAKAzP,MAAAA,eAAK,CAAC/E,IAAN,CAAW,KAAKd,GAAL,CAAS4Q,QAApB,EAA8B,OAA9B,EAAuC,UAAC5K,CAAD,EAAO;CAC7C,YAAIE,MAAM,GAAGF,CAAC,CAACE,MAAF,IAAYF,CAAC,CAACG,UAA3B;;CACA,YAAID,MAAM,IAAIA,MAAM,CAACwP,YAAjB,IAAiCxP,MAAM,CAACwP,YAAP,CAAoB,kBAApB,CAArC,EACA;CACC,cAAIC,SAAS,GAAGzP,MAAM,CAACwP,YAAP,CAAoB,kBAApB,CAAhB;;CACA,cAAI,CAAC,MAAI,CAACrC,aAAL,CAAmBsC,SAAnB,CAAL,EACA;CACC,YAAA,MAAI,CAACpC,QAAL,CAAcoC,SAAd;CACA,WAHD,MAKA;CACC,YAAA,MAAI,CAACC,UAAL,CAAgBD,SAAhB;CACA;CACD;CACD,OAdD;CAeA;CAprBF;CAAA;CAAA,wCAsrBqB3O,GAtrBrB,EAurBC;CAAA;;CACC,WAAKyL,eAAL,GAAuB,IAAI1S,qBAAJ,CAA0BiH,GAA1B,EAA+B;CACrD6O,QAAAA,YAAY,EAAE,IADuC;CAErD3V,QAAAA,YAAY,EAAE,KAAKF,GAAL,CAAS2G;CAF8B,OAA/B,CAAvB;CAKA,WAAK8L,eAAL,CAAqB5E,SAArB,CAA+B,UAA/B,EAA2C,UAACpH,KAAD,EAAW;CACrD,YAAIA,KAAK,YAAYgG,0BAArB,EACA;CACC,cAAIjD,KAAK,GAAG/C,KAAK,CAACI,OAAN,GAAgB2C,KAA5B;;CACA,cAAI,MAAI,CAACiK,eAAT,EACA;CACC,YAAA,MAAI,CAACA,eAAL,CAAqByB,cAArB,CAAoC1L,KAAK,CAACvI,OAA1C;CACA;;CAED,cAAI,MAAI,CAACyN,OAAT,EACA;CACC,YAAA,MAAI,CAACA,OAAL,CAAaoH,cAAb,CAA4BtM,KAAK,CAACiB,IAAlC,EAAwCjB,KAAK,CAACmJ,EAA9C,EAAkDnJ,KAAK,CAACvI,OAAxD;CACA;CACD;CACD,OAdD;CAeA;CA5sBF;CAAA;CAAA,oCA8sBiB+F,GA9sBjB,EA+sBC;CAAA;;CACC,WAAKhH,GAAL,CAAS+S,SAAT,GAAqB,KAAK/S,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,iBAArB;CACAZ,MAAAA,UAAU,CAAC,YAAM;CAChB,QAAA,MAAI,CAACpG,GAAL,CAAS+S,SAAT,CAAmBgD,KAAnB;;CACA,QAAA,MAAI,CAAC/V,GAAL,CAAS+S,SAAT,CAAmBiD,MAAnB;CACA,OAHS,EAGP,GAHO,CAAV;CAIA;CArtBF;CAAA;CAAA,wCAutBqBhP,GAvtBrB,EAwtBC;CAAA;;CACC,WAAKiP,cAAL,GAAsB,EAAtB;CACA,WAAKjW,GAAL,CAASkW,YAAT,GAAwB,KAAKlW,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,eAAxB;CACA,WAAKhH,GAAL,CAASmW,kBAAT,GAA8B,KAAKnW,GAAL,CAASkW,YAAT,CAAsBvL,WAAtB,CAAkCC,aAAG,CAACC,MAAtC,qBAA9B;CAEA,WAAK4I,eAAL,GAAuB,IAAI2C,0BAAJ,CAAa;CACnCC,QAAAA,IAAI,EAAE,KAAKrW,GAAL,CAASkW,YADoB;CAEnCI,QAAAA,MAAM,EAAE,KAAKA,MAFsB;CAInC;CACA;CACA;CACA;CACA;CACA;CACA;;CAVmC,OAAb,CAAvB;CAaA,WAAK7C,eAAL,CAAqB5F,SAArB,CAA+B,UAA/B,EAA2C,UAACpH,KAAD,EAC3C;CACC,YAAIA,KAAK,YAAYgG,0BAArB,EACA;CACC,UAAA,MAAI,CAACwJ,cAAL,GAAsBxP,KAAK,CAACI,OAAN,GAAgB0P,MAAtC;CACAzU,UAAAA,aAAG,CAACgJ,KAAJ,CAAU,MAAI,CAAC9K,GAAL,CAASmW,kBAAnB;;CACA,UAAA,MAAI,CAACF,cAAL,CAAoBhL,OAApB,CAA4B,UAACzB,KAAD,EAAW;CACtC,YAAA,MAAI,CAACxJ,GAAL,CAASmW,kBAAT,CAA4BxL,WAA5B,CAAwC7I,aAAG,CAAC0U,MAAJ,CAAW,OAAX,EAAoB;CAC3DxU,cAAAA,KAAK,EAAE;CAACQ,gBAAAA,IAAI,EAAE,YAAP;CAAqBC,gBAAAA,IAAI,EAAE;CAA3B,eADoD;CAE3DgU,cAAAA,KAAK,EAAE;CAACjN,gBAAAA,KAAK,EAAEA;CAAR;CAFoD,aAApB,CAAxC;CAGA,WAJD;CAKA;CACD,OAZD;CAaA;CAvvBF;CAAA;CAAA,wCAyvBqBxC,GAzvBrB,EA0vBC;CAAA;;CACC,WAAKhH,GAAL,CAASiT,YAAT,GAAwB,KAAKjT,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,cAAxB;CACA,WAAKmM,eAAL,GAAuB,IAAIuD,iCAAJ,CAAoB;CAC1CC,QAAAA,SAAS,EAAE,KAAK3W,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,mBAD+B;CAE1C4P,QAAAA,mBAAmB,EAAE,KAAKnU,IAFgB;CAG1CoU,QAAAA,cAAc,EAAE,KAAKnU,OAHqB;CAI1CoU,QAAAA,WAAW,EAAE,KAAK3G,QAJwB;CAK1C4G,QAAAA,gBAAgB,EAAEC,+CAAsB,CAACC,mBAAvB,CAA2C;CAC5DxU,UAAAA,IAAI,EAAE,KAAKA,IAAL,IAAa,MADyC;CAE5DC,UAAAA,OAAO,EAAE,KAAKA,OAAL,IAAgB,KAAKC,MAF8B;CAG5DA,UAAAA,MAAM,EAAE,KAAKA,MAH+C;CAI5DyN,UAAAA,iBAAiB,EAAE,KAAKA;CAJoC,SAA3C,CALwB;CAW1C8G,QAAAA,IAAI,EAAE,MAXoC;CAY1CZ,QAAAA,MAAM,EAAE,KAAKA,MAZ6B;CAa1CvM,QAAAA,iBAAiB,EAAE,6BAAI;CACtB,cAAID,OAAO,GAAG,OAAI,CAACC,iBAAL,EAAd;;CACA,cAAID,OAAJ,EACA;CACC,mBAAO;CACNzC,cAAAA,EAAE,EAAEyC,OAAO,CAACQ,EADN;CAEN9H,cAAAA,IAAI,EAAEsH,OAAO,CAACqN,IAFR;CAGN/M,cAAAA,KAAK,EAAEN,OAAO,CAACE;CAHT,aAAP;CAKA;;CACD,iBAAO,KAAP;CACA,SAxByC;CAyB1CoN,QAAAA,cAAc,EAAE,wBAACC,YAAD,EAAkB;CACjC,cAAIA,YAAJ,EACA;CACC;CACA,YAAA,OAAI,CAACrX,GAAL,CAASiT,YAAT,CAAsBzJ,KAAtB,GAA8B6N,YAAY,CAAChQ,EAA3C;;CACA,gBAAI,OAAI,CAAC6C,aAAT,EACA;CACC,cAAA,OAAI,CAACA,aAAL,CAAmBwI,QAAnB,CAA4B2E,YAAY,CAACjN,KAAzC;CACA;;CACD,YAAA,OAAI,CAACtH,KAAL,CAAWwU,YAAX,CAAwBD,YAAY,CAAChQ,EAArC;CACA;CACD;CApCyC,OAApB,CAAvB;CAsCA;CAlyBF;CAAA;CAAA,sCAoyBmBL,GApyBnB,EAqyBC;CACC,UAAI,CAACX,MAAM,CAAC,cAAD,CAAX,EACA;CACC,eAAOD,UAAU,CAACjD,EAAE,CAACoU,QAAH,CAAY,KAAKvG,iBAAjB,EAAoC,IAApC,CAAD,EAA4C,EAA5C,CAAjB;CACA;;CAED,WAAKpH,MAAL,GAAc,IAAd;;CACA,UAAIvD,MAAM,CAAC,cAAD,CAAV,EACA;CACC,aAAKuD,MAAL,GAAcvD,MAAM,CAAC,cAAD,CAAN,CAAuBmR,GAAvB,CAA2B,KAAKjI,QAAhC,CAAd;CACA;;CAED,UAAI,CAAC,KAAK3F,MAAN,IAAgB6N,GAAG,CAAC,cAAD,CAAH,KAAwBpR,MAAM,CAAC,cAAD,CAAlD,EACA;CACC,aAAKuD,MAAL,GAAc6N,GAAG,CAAC,cAAD,CAAH,CAAoBD,GAApB,CAAwB,KAAKjI,QAA7B,CAAd;CACA;;CAED,UAAI,KAAK3F,MAAL,IAAe,KAAKA,MAAL,CAAY8N,OAAZ,EAAnB,EACA;CACC,aAAKC,mBAAL;CACA,OAHD,MAKA;CACC,aAAKxU,EAAL,CAAQiB,cAAR,CAAuBiC,MAAM,CAAC,cAAD,CAA7B,EAA+C,iBAA/C,EAAkE,UAAUuD,MAAV,EAClE;CACC,cAAIA,MAAM,CAACvC,EAAP,KAAc,KAAKkI,QAAvB,EACA;CACC,iBAAK3F,MAAL,GAAcA,MAAd;CACA,iBAAK+N,mBAAL;CACA;CACD,SAPiE,CAOhE7W,IAPgE,CAO3D,IAP2D,CAAlE;CAQA;CACD;CAr0BF;CAAA;CAAA,0CAw0BC;CACC,UAAI8I,MAAM,GAAG,KAAKA,MAAlB;;CACA,UAAIA,MAAM,CAACgO,OAAP,IAAkBhO,MAAM,CAACgO,OAAP,CAAeC,QAAjC,IAA6CjO,MAAM,CAACgO,OAAP,CAAeC,QAAf,CAAwBC,OAAzE,EACA;CACChW,QAAAA,aAAG,CAACiW,MAAJ,CAAWnO,MAAM,CAACgO,OAAP,CAAeC,QAAf,CAAwBC,OAAxB,CAAgCE,KAA3C;CACA;CACD;CA90BF;CAAA;CAAA,wCAg1BqBhR,GAh1BrB,EAi1BC;CACC,WAAKhH,GAAL,CAASiY,YAAT,GAAwB,KAAKjY,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,oBAAxB;CACA,WAAKhH,GAAL,CAASkY,aAAT,GAAyB,KAAKlY,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,eAAzB;CAEA,WAAK0C,gBAAL,GAAwB,IAAI4I,0BAAJ,CACvB;CACC6F,QAAAA,SAAS,EAAE,WADZ;CACyB;CACxB9B,QAAAA,IAAI,EAAE,KAAKrW,GAAL,CAASiY,YAFhB;CAGCG,QAAAA,mBAAmB,EAAE,KAAK9H,sBAH3B;CAICC,QAAAA,YAAY,EAAE,KAAKA,YAJpB;CAKCC,QAAAA,qBAAqB,EAAE,KAAKA,qBAL7B;CAMC5P,QAAAA,gBAAgB,EAAE,KAAK4C;CANxB,OADuB,CAAxB;CAUA;CA/1BF;CAAA;CAAA,0CAi2BuBwD,GAj2BvB,EAk2BC;CAAA;;CACC,WAAKhH,GAAL,CAASqY,SAAT,GAAqB,KAAKrY,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,iBAArB;CACA,WAAKgF,cAAL,GAAsB,IAAIsM,gCAAJ,CACrB;CACCjC,QAAAA,IAAI,EAAE,KAAKrW,GAAL,CAASqY,SADhB;CAECE,QAAAA,SAAS,EAAE,KAAKvY,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,iBAFZ;CAGCwR,QAAAA,OAAO,EAAE,YAAW;CAAC,iBAAO,KAAK/F,eAAL,CAAqBtI,QAArB,GAAgCM,IAAvC;CAA6C,SAAzD,CAA0D3J,IAA1D,CAA+D,IAA/D;CAHV,OADqB,CAAtB;CAQA,WAAK2R,eAAL,CAAqB5E,SAArB,CAA+B,UAA/B,EAA2C,YAAI;CAC9C,YAAI,OAAI,CAAC7B,cAAL,CAAoBC,OAApB,OAAkC,QAAtC,EACA;CACC,UAAA,OAAI,CAACD,cAAL,CAAoByM,UAApB,CAA+B,OAAI,CAACzM,cAAL,CAAoBC,OAApB,EAA/B;CACA;CACD,OALD;CAMA;CAl3BF;CAAA;CAAA,yCAo3BsBjF,GAp3BtB,EAq3BC;CACC,WAAKhH,GAAL,CAAS0Y,gBAAT,GAA4B,KAAK1Y,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,CAA+B,mCAA/B,CAA5B;CACA,WAAKH,GAAL,CAAS+K,qBAAT,GAAiC,KAAK/K,GAAL,CAAS0Y,gBAAT,CAA0B/N,WAA1B,CAAsCC,aAAG,CAACC,MAA1C,qBAAjC;CAEA,WAAK8N,eAAL,GAAuB,IAAIC,6BAAJ,CAAsB;CAC5CC,QAAAA,aAAa,EAAE;CACdC,UAAAA,OAAO,EAAE,UADK;CAEdC,UAAAA,gBAAgB,EAAE,KAAKlJ,yBAAL,IAAkC,EAFtC;CAGdyG,UAAAA,MAAM,EAAE,KAAKtS,MAAL,CAAYsS,MAHN;CAId/Q,UAAAA,MAAM,EAAE;CACP,6BAAiB,KAAKyT,yBAAL,CAA+BlY,IAA/B,CAAoC,IAApC,CADV;CAEP,+BAAmB,KAAKkY,yBAAL,CAA+BlY,IAA/B,CAAoC,IAApC;CAFZ,WAJM;CAQdmY,UAAAA,QAAQ,EAAE,CACT;CACC5R,YAAAA,EAAE,EAAE,MADL;CAECjF,YAAAA,OAAO,EAAE;CACR8W,cAAAA,eAAe,EAAE,IADT;CAERC,cAAAA,UAAU,EAAE;CAFJ;CAFV,WADS,EAQT;CACC9R,YAAAA,EAAE,EAAE;CADL,WARS,EAWT;CACCA,YAAAA,EAAE,EAAE,YADL;CAECjF,YAAAA,OAAO,EAAE;CAACgX,cAAAA,UAAU,EAAE;CAAb;CAFV,WAXS,EAeT;CACC/R,YAAAA,EAAE,EAAE,WADL;CAECjF,YAAAA,OAAO,EAAE;CAAE,2BAAa;CAAf;CAFV,WAfS,CARI;CA4BdiX,UAAAA,gBAAgB,EAAE;CACjBC,YAAAA,WAAW,EAAE;CACZ7X,cAAAA,KAAK,EAAEC,aAAG,CAACC,UAAJ,CAAe,0BAAf,CADK;CAEZ4X,cAAAA,QAAQ,EAAE7X,aAAG,CAACC,UAAJ,CAAe,6BAAf,CAFE;CAGZ6X,cAAAA,IAAI,EAAE,0CAHM;CAIZC,cAAAA,WAAW,EAAE,GAJD;CAKZC,cAAAA,KAAK,EAAE;CALK;CADI;CA5BJ;CAD6B,OAAtB,CAAvB;CAyCA,WAAKf,eAAL,CAAqBgB,QAArB,CAA8B,KAAK3Z,GAAL,CAAS0Y,gBAAvC,EA7CD;CA+CC;CACA;CACA;CAt6BF;CAAA;CAAA,gDAy6BC;CACC,UAAI,KAAKhK,OAAT,EACA;CACC,aAAKA,OAAL,CAAaV,IAAb;CACA,aAAKU,OAAL,CAAakL,UAAb;CAEA,aAAKjK,yBAAL,CAA+B,KAAKgJ,eAAL,CAAqBkB,OAArB,GAA+B/J,GAA/B,CAAmC,UAAClH,IAAD,EAAU;CAC3E,iBAAO;CACNwC,YAAAA,QAAQ,EAAExC,IAAI,CAACwC,QADT;CAEN/D,YAAAA,EAAE,EAAEuB,IAAI,CAACvB,EAFH;CAGNyS,YAAAA,UAAU,EAAElR,IAAI,CAACkR;CAHX,WAAP;CAIE,SAL4B,CAA/B;CAMA,aAAKtW,cAAL;CACA;CACD;CAv7BF;CAAA;CAAA,4CA07BC;CACC,aAAO,CAAC,CAAC,KAAKwH,yBAAL,GAAiCrC,IAAjC,CAAsC,UAACC,IAAD,EAAU;CAAC,eAAOA,IAAI,CAACkR,UAAL,KAAoB,OAA3B;CAAoC,OAArF,CAAT;CACA;CA57BF;CAAA;CAAA,gCA87Ba9S,GA97Bb,EA+7BC;CACC,WAAKhH,GAAL,CAAS+Z,gBAAT,GAA4B,KAAK/Z,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,yBAA5B;CAEA,WAAK0H,OAAL,GAAe,IAAIsL,wBAAJ,CAAY;CAC1B3D,QAAAA,IAAI,EAAE,KAAKrW,GAAL,CAAS+Z,gBADW;CAE1BE,QAAAA,QAAQ,EAAErX,QAAQ,CAAC,KAAK5C,GAAL,CAAS+Z,gBAAT,CAA0BG,WAA3B;CAFQ,OAAZ,CAAf;CAKA,WAAKxL,OAAL,CAAab,SAAb,CAAuB,cAAvB,EAAuC,KAAKsM,4BAAL,CAAkCrZ,IAAlC,CAAuC,IAAvC,CAAvC;CAEA,WAAK4N,OAAL,CAAaV,IAAb;CACA,WAAKU,OAAL,CAAakL,UAAb;CACA;CA38BF;CAAA;CAAA,sCA88BC;CAAA;;CAAA,UADgB9U,MAChB,uEADyB,EACzB;CACC,WAAK4J,OAAL,CAAakL,UAAb;CACA,aAAO,IAAIhL,OAAJ,CAAY,UAACwL,OAAD,EAAa;CAC/B,QAAA,OAAI,CAACjX,EAAL,CAAQkI,IAAR,CAAaC,SAAb,CAAuB,yCAAvB,EAAkE;CACjEC,UAAAA,IAAI,EAAE;CACL1I,YAAAA,OAAO,EAAE,OAAI,CAACC,KAAL,CAAWuE,EAAX,IAAiB,CADrB;CAEL3E,YAAAA,OAAO,EAAE,OAAI,CAACA,OAFT;CAGLD,YAAAA,IAAI,EAAE,OAAI,CAACA,IAHN;CAILoS,YAAAA,UAAU,EAAE/P,MAAM,CAAC+P,UAAP,IAAqB,EAJ5B;CAKLwF,YAAAA,QAAQ,EAAEvV,MAAM,CAAC2F,IAAP,IAAe,EALpB;CAML6P,YAAAA,MAAM,EAAExV,MAAM,CAAC6N,EAAP,IAAa,EANhB;CAOLqC,YAAAA,QAAQ,EAAElQ,MAAM,CAACkQ,QAAP,IAAmB,EAPxB;CAQLvL,YAAAA,QAAQ,EAAE3E,MAAM,CAAC2E,QAAP,IAAmB,EARxB;CASL8Q,YAAAA,OAAO,EAAEzV,MAAM,CAAC0V,SAAP,IAAoB;CATxB;CAD2D,SAAlE,EAaE/V,IAbF,CAaO,UAAC2H,QAAD,EAAc;CAClB,UAAA,OAAI,CAACsC,OAAL,CAAa+L,UAAb;;CACA,cAAIC,SAAS,GAAG,EAAhB;;CACA,cAAI/V,cAAI,CAACyN,OAAL,CAAahG,QAAQ,CAACb,IAAT,CAAcgP,OAA3B,CAAJ,EACA;CACCnO,YAAAA,QAAQ,CAACb,IAAT,CAAcgP,OAAd,CAAsBtP,OAAtB,CAA8B,UAACnI,KAAD,EAAW;CACxC,kBAAIA,KAAK,CAACL,IAAN,KAAe,MAAnB,EACA;CACCiY,gBAAAA,SAAS,CAACrN,IAAV,CAAe;CACdhG,kBAAAA,EAAE,EAAEvE,KAAK,CAACuE,EADI;CAEd7E,kBAAAA,IAAI,EAAEM,KAAK,CAACN,IAFE;CAGdmY,kBAAAA,MAAM,EAAE7X,KAAK,CAAC6X,MAHA;CAIdC,kBAAAA,WAAW,EAAE9X,KAAK,CAAC8X,WAAN,IAAqB9X,KAAK,CAAC6X,MAJ1B;CAKdE,kBAAAA,GAAG,EAAE/X,KAAK,CAAC+X;CALG,iBAAf;CAOA;CACD,aAXD;CAYA;;CAED,cAAIC,QAAQ,GAAG,OAAI,CAACrI,eAAL,CAAqBtI,QAArB,EAAf;;CACA,UAAA,OAAI,CAACuE,OAAL,CAAaqM,MAAb,CACC3O,QAAQ,CAACb,IAAT,CAAcgP,OADf,EAECnO,QAAQ,CAACb,IAAT,CAAcuI,aAFf;;CAIA,UAAA,OAAI,CAACpF,OAAL,CAAaoH,cAAb,CAA4BgF,QAAQ,CAACrQ,IAArC,EAA2CqQ,QAAQ,CAACnI,EAApD,EAAwDmI,QAAQ,CAAC7Z,OAAjE;;CAEAmZ,UAAAA,OAAO,CAAChO,QAAD,CAAP;CACA,SAxCH,EAyCE,UAACA,QAAD,EAAc;CAACgO,UAAAA,OAAO,CAAChO,QAAD,CAAP;CAAmB,SAzCpC;CA4CA,OA7CM,CAAP;CA8CA;CA9/BF;CAAA;CAAA,2CAigCwBpF,GAjgCxB,EAkgCC;CACC,WAAKhH,GAAL,CAAS6T,kBAAT,GAA8B,KAAK7T,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,oBAA9B;CACA,WAAKhH,GAAL,CAASgU,oBAAT,GAAgC,KAAKhU,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,cAAhC;CACA,WAAKhH,GAAL,CAASmU,sBAAT,GAAkC,KAAKnU,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,gBAAlC;CACA;CAtgCF;CAAA;CAAA,qCAwgCkBA,GAxgClB,EAygCC;CACC,WAAKhH,GAAL,CAASgb,SAAT,GAAqB,KAAKhb,GAAL,CAAS2G,OAAT,CAAiBxG,aAAjB,YAAmC6G,GAAnC,0BAArB;CACA,WAAKkD,aAAL,GAAqB,IAAI+Q,+BAAJ,CACpB;CACC5E,QAAAA,IAAI,EAAE,KAAKrW,GAAL,CAASgb;CADhB,OADoB,CAArB;CAKA;CAhhCF;CAAA;CAAA,qCAkhCkBhU,GAlhClB,EAmhCC;CACC,WAAKhH,GAAL,CAASkb,SAAT,GAAqB/X,EAAE,CAAC6D,GAAG,GAAG,cAAP,CAAvB;;CAEA,UAAI,KAAKhH,GAAL,CAASkb,SAAb,EACA;CACC,YAAIpY,KAAK,GAAG,KAAK+L,eAAL,EAAZ;CACA,YAAIsM,MAAM,GAAG,KAAKnb,GAAL,CAASkb,SAAT,CAAmBvQ,WAAnB,CAA+B7I,aAAG,CAACC,MAAJ,CAAWqB,kBAAI,CAACgY,SAAL,CAAe,EAAf,CAAX,EAA+B;CAACC,UAAAA,KAAK,EAAE;CAACC,YAAAA,MAAM,EAAE,MAAT;CAAiBC,YAAAA,KAAK,EAAE;CAAxB;CAAR,SAA/B,CAA/B,CAAb;CAEAnV,QAAAA,UAAU,CAAC,YAAU;CACpB,eAAKjD,EAAL,CAAQkI,IAAR,CAAaC,SAAb,CAAuB,2CAAvB,EAAoE;CACnEC,YAAAA,IAAI,EAAE;CACLuD,cAAAA,QAAQ,EAAGhM,KAAK,IAAIA,KAAK,CAACuE,EAAhB,GAAsBvE,KAAK,CAACuE,EAA5B,GAAiC;CADtC;CAD6D,WAApE,EAIG5C,IAJH;CAMC,oBAAS2H,QAAT,EACA;CACC,gBAAIzH,cAAI,CAAC6W,SAAL,CAAe,KAAKxb,GAAL,CAASkb,SAAxB,CAAJ,EACA;CACC,mBAAK/X,EAAL,CAAQuB,IAAR,CAAa,KAAK1E,GAAL,CAASkb,SAAtB,EAAiC9O,QAAQ,CAACb,IAAT,CAAc7G,IAA/C;CACA;CACD,WAND,CAME5D,IANF,CAMO,IANP,CAND;CAcC,oBAAUsL,QAAV,EACA;CACCtK,YAAAA,aAAG,CAACiW,MAAJ,CAAWoD,MAAX;CACA,WAHD,CAGEra,IAHF,CAGO,IAHP,CAdD;CAmBA,SApBU,CAoBTA,IApBS,CAoBJ,IApBI,CAAD,EAoBI,GApBJ,CAAV;CAqBA;CACD;CAjjCF;CAAA;CAAA,sCAojCC;CACC,WAAK2a,SAAL,GAAiB,IAAjB;CACA;CAtjCF;CAAA;CAAA,uCAyjCC;CACC,WAAKA,SAAL,GAAiB,KAAjB;CACA;CA3jCF;CAAA;CAAA,qCA8jCC;CACC;CACA,UAAI,KAAK7X,KAAL,KAAe,KAAKC,KAAL,CAAWvB,OAA9B,EACA;CACC,eAAO,IAAP;CACA,OALF;;;CAQC,UAAI,CAACqC,cAAI,CAAC+W,MAAL,CAAY,KAAK3V,gBAAjB,CAAL,EACA;CACC,eAAO,CAAC,KAAKA,gBAAb;CACA,OAXF;CAcC;CACA;CACA;CACA;;;CAEA,aAAO,KAAK0V,SAAZ;CACA;CAllCF;CAAA;CAAA,sCAqlCC;CAAA,UADgB3Y,KAChB,uEADwB,IACxB;CAAA,UAD8B6Y,SAC9B,uEAD0C,IAC1C;CACC,WAAK7Y,KAAL,GAAa2E,2BAAY,CAACmU,gBAAb,CAA8B9Y,KAA9B,EAAqC6Y,SAArC,EAAgD;CAAClZ,QAAAA,IAAI,EAAE,KAAKA,IAAZ;CAAkBC,QAAAA,OAAO,EAAE,KAAKA;CAAhC,OAAhD,CAAb;CACA;CAvlCF;CAAA;CAAA,sCA0lCC;CACC,aAAO,KAAKI,KAAZ;CACA;CA5lCF;CAAA;CAAA,wCA+lCC;CACC,UACCgH,OAAO,GAAG,KADX;CAAA,UAEC2G,SAAS,GAAG,KAAKyC,mBAAL,EAFb;;CAIA,UAAIzC,SAAS,IACT,KAAK0B,YAAL,CAAkB1B,SAAlB,MAAiCjI,SADjC,IAEA,KAAK2H,QAAL,CAAc,KAAKgC,YAAL,CAAkB1B,SAAlB,CAAd,MAAgDjI,SAFpD,EAGA;CACCsB,QAAAA,OAAO,GAAG,KAAKqG,QAAL,CAAc,KAAKgC,YAAL,CAAkB1B,SAAlB,CAAd,CAAV;CACA;;CAED,aAAO3G,OAAP;CACA;CA5mCF;CAAA;CAAA,0CA+mCC;CACC,UACCA,OAAO,GAAG,CADX;CAAA,UAEChH,KAAK,GAAG,KAAK+L,eAAL,EAFT;;CAIA,UAAI/L,KAAK,YAAY8O,oBAArB,EACA;CACC9H,QAAAA,OAAO,GAAGlH,QAAQ,CAACE,KAAK,CAAC2N,SAAP,CAAlB;CACA;;CAED,UAAI,CAAC3G,OAAD,IAAY,KAAK0F,eAAjB,IAAoC,KAAKW,QAAL,CAAc,KAAKgC,YAAL,CAAkBvP,QAAQ,CAAC,KAAK4M,eAAN,CAA1B,CAAd,CAAxC,EACA;CACC1F,QAAAA,OAAO,GAAGlH,QAAQ,CAAC,KAAK4M,eAAN,CAAlB;CACA;;CAED,UAAI,CAAC1F,OAAD,IAAY,KAAKqG,QAAL,CAAc,CAAd,CAAhB,EACA;CACCrG,QAAAA,OAAO,GAAGlH,QAAQ,CAAC,KAAKuN,QAAL,CAAc,CAAd,EAAiB7F,EAAlB,CAAlB;CACA;;CACD,aAAOR,OAAP;CACA;CAnoCF;CAAA;CAAA,6BAqoCU6L,SAroCV,EAsoCC;CAAA;;CAAA,kCAC8C,KAAKkG,eAAL,EAD9C;CAAA;CAAA,UACMC,YADN;CAAA,UACoBC,sBADpB;;CAEC,UACCC,KAAK,GAAGD,sBAAsB,CAACpG,SAAD,CAD/B;CAAA,UAECsG,QAAQ,GAAGH,YAAY,CAACnG,SAAD,CAFxB;CAAA,UAGCuG,WAAW,GAAGF,KAAK,CAACG,YAHrB;CAKAH,MAAAA,KAAK,CAACX,KAAN,CAAYC,MAAZ,GAAqBY,WAAW,GAAG,IAAnC;CACA9V,MAAAA,UAAU,CAAC,YAAU;CAACtE,QAAAA,aAAG,CAACiH,QAAJ,CAAaiT,KAAb,EAAoB,qBAApB;CAA4C,OAAxD,EAA0D,CAA1D,CAAV;CACAC,MAAAA,QAAQ,CAACZ,KAAT,CAAeC,MAAf,GAAwB,GAAxB;;CAEA,UAAI3F,SAAS,KAAK,aAAlB,EACA;CACCvP,QAAAA,UAAU,CAAC,YACX;CACC,cAAI,CAAC,KAAKpG,GAAL,CAASoc,yBAAd,EACA;CACC,iBAAKpc,GAAL,CAASoc,yBAAT,GAAqC,KAAKpc,GAAL,CAASsV,eAAT,CAAyBnV,aAAzB,CAAuC,kCAAvC,CAArC;CACA;;CAED,cAAI,KAAKH,GAAL,CAASoc,yBAAb,EACA;CAEC,mBAAM,KAAKpc,GAAL,CAASoc,yBAAT,CAAmCC,UAAzC,EACA;CACCJ,cAAAA,QAAQ,CAACtR,WAAT,CAAqB,KAAK3K,GAAL,CAASoc,yBAAT,CAAmCC,UAAxD;CACA;CACD;;CACDJ,UAAAA,QAAQ,CAACZ,KAAT,CAAeC,MAAf,GAAwBY,WAAW,GAAG,IAAtC;CACA,SAhBU,CAgBTpb,IAhBS,CAgBJ,IAhBI,CAAD,EAgBI,GAhBJ,CAAV;CAkBAsF,QAAAA,UAAU,CAAC,YAAU;CACpBtE,UAAAA,aAAG,CAACuK,WAAJ,CAAgB2P,KAAhB,EAAuB,qBAAvB;CACAA,UAAAA,KAAK,CAACX,KAAN,CAAYiB,OAAZ,GAAsB,MAAtB;CACAL,UAAAA,QAAQ,CAACZ,KAAT,CAAeC,MAAf,GAAwB,EAAxB;CACA,eAAKiB,iBAAL,CAAuB5G,SAAvB,IAAoC,IAApC;CACA,cAAI/L,MAAM,GAAGvD,MAAM,CAAC,cAAD,CAAN,CAAuBmR,GAAvB,CAA2B,KAAKjI,QAAhC,CAAb;;CACA,cAAI3F,MAAJ,EACA;CACCA,YAAAA,MAAM,CAAC4S,cAAP;CACA;;CACD,eAAKC,YAAL;CACA,eAAKC,0BAAL;CACA,SAZU,CAYT5b,IAZS,CAYJ,IAZI,CAAD,EAYI,GAZJ,CAAV;CAaA,OAjCD,MAmCA;CACCsF,QAAAA,UAAU,CAAC,YACX;CACC,iBAAM4V,KAAK,CAACK,UAAZ,EACA;CACCJ,YAAAA,QAAQ,CAACtR,WAAT,CAAqBqR,KAAK,CAACK,UAA3B;CACA;;CACDJ,UAAAA,QAAQ,CAACZ,KAAT,CAAeC,MAAf,GAAwBY,WAAW,GAAG,IAAtC;CACA,SAPS,EAOP,GAPO,CAAV;CASA9V,QAAAA,UAAU,CAAC,YAAM;CAChBtE,UAAAA,aAAG,CAACuK,WAAJ,CAAgB2P,KAAhB,EAAuB,qBAAvB;CACAA,UAAAA,KAAK,CAACX,KAAN,CAAYC,MAAZ,GAAqB,EAArB;CACAW,UAAAA,QAAQ,CAACZ,KAAT,CAAeC,MAAf,GAAwB,EAAxB;CACA,UAAA,OAAI,CAACiB,iBAAL,CAAuB5G,SAAvB,IAAoC,IAApC;;CACA,UAAA,OAAI,CAAC8G,YAAL;;CACA,UAAA,OAAI,CAACC,0BAAL;CACA,SAPS,EAOP,GAPO,CAAV;CAQA;CACD;CAvsCF;CAAA;CAAA,+BAysCY/G,SAzsCZ,EA0sCC;CAAA,mCAC8C,KAAKkG,eAAL,EAD9C;CAAA;CAAA,UACMC,YADN;CAAA,UACoBC,sBADpB;;CAEC,UACCC,KAAK,GAAGF,YAAY,CAACnG,SAAD,CADrB;CAAA,UAECsG,QAAQ,GAAGF,sBAAsB,CAACpG,SAAD,CAFlC;CAAA,UAGCuG,WAAW,GAAGF,KAAK,CAACG,YAHrB;CAKAH,MAAAA,KAAK,CAACX,KAAN,CAAYC,MAAZ,GAAqBY,WAAW,GAAG,IAAnC;CACA9V,MAAAA,UAAU,CAAC,YAAU;CACpBtE,QAAAA,aAAG,CAACiH,QAAJ,CAAaiT,KAAb,EAAoB,qBAApB;CACA,OAFS,EAEP,CAFO,CAAV;CAGAC,MAAAA,QAAQ,CAACZ,KAAT,CAAeC,MAAf,GAAwB,GAAxB;;CAEA,UAAI3F,SAAS,KAAK,aAAlB,EACA;CACCvP,QAAAA,UAAU,CAAC,YAAU;CACpB,cAAI,CAAC,KAAKpG,GAAL,CAASoc,yBAAd,EACA;CACC,iBAAKpc,GAAL,CAASoc,yBAAT,GAAqC,KAAKpc,GAAL,CAASsV,eAAT,CAAyBnV,aAAzB,CAAuC,kCAAvC,CAArC;CACA;;CAED,cAAI,KAAKH,GAAL,CAASoc,yBAAb,EACA;CACC,mBAAMJ,KAAK,CAACK,UAAZ,EACA;CACC,mBAAKrc,GAAL,CAASoc,yBAAT,CAAmCzR,WAAnC,CAA+CqR,KAAK,CAACK,UAArD;CACA;CACD;;CAEDJ,UAAAA,QAAQ,CAACZ,KAAT,CAAeiB,OAAf,GAAyB,EAAzB;CACAL,UAAAA,QAAQ,CAACZ,KAAT,CAAeC,MAAf,GAAwBY,WAAW,GAAG,IAAtC;CACA,SAhBU,CAgBTpb,IAhBS,CAgBJ,IAhBI,CAAD,EAgBI,GAhBJ,CAAV;CAkBAsF,QAAAA,UAAU,CAAC,YAAU;CACpBtE,UAAAA,aAAG,CAACuK,WAAJ,CAAgB2P,KAAhB,EAAuB,qBAAvB;CACAA,UAAAA,KAAK,CAACX,KAAN,CAAYC,MAAZ,GAAqB,EAArB;CACAW,UAAAA,QAAQ,CAACZ,KAAT,CAAeC,MAAf,GAAwB,EAAxB;CACA,eAAKiB,iBAAL,CAAuB5G,SAAvB,IAAoC,KAApC;CAEA,cAAI/L,MAAM,GAAGvD,MAAM,CAAC,cAAD,CAAN,CAAuBmR,GAAvB,CAA2B,KAAKjI,QAAhC,CAAb;;CACA,cAAI3F,MAAJ,EACA;CACCA,YAAAA,MAAM,CAAC4S,cAAP;CACA;;CAED,eAAKC,YAAL;CACA,eAAKC,0BAAL;CACA,SAdU,CAcT5b,IAdS,CAcJ,IAdI,CAAD,EAcI,GAdJ,CAAV;CAeA,OAnCD,MAqCA;CACCsF,QAAAA,UAAU,CAAC,YAAU;CACpB,iBAAM4V,KAAK,CAACK,UAAZ,EACA;CACCJ,YAAAA,QAAQ,CAACtR,WAAT,CAAqBqR,KAAK,CAACK,UAA3B;CACA;;CACDJ,UAAAA,QAAQ,CAACZ,KAAT,CAAeC,MAAf,GAAwBY,WAAW,GAAG,IAAtC;CACA,SANS,EAMP,GANO,CAAV;CAQA9V,QAAAA,UAAU,CAAC,YAAU;CACpBtE,UAAAA,aAAG,CAACuK,WAAJ,CAAgB2P,KAAhB,EAAuB,qBAAvB;CACAA,UAAAA,KAAK,CAACX,KAAN,CAAYC,MAAZ,GAAqB,EAArB;CACAW,UAAAA,QAAQ,CAACZ,KAAT,CAAeC,MAAf,GAAwB,EAAxB;CACA,eAAKiB,iBAAL,CAAuB5G,SAAvB,IAAoC,KAApC;CAEA,eAAK8G,YAAL;CACA,eAAKC,0BAAL;CACA,SARU,CAQT5b,IARS,CAQJ,IARI,CAAD,EAQI,GARJ,CAAV;CASA;CACD;CA/wCF;CAAA;CAAA,kCAixCe6U,SAjxCf,EAkxCC;CACC,aAAO,KAAK4G,iBAAL,CAAuB5G,SAAvB,CAAP;CACA;CApxCF;CAAA;CAAA,sCAuxCC;CACC,UAAI,CAAC,KAAKmG,YAAV,EACA;CACC,aAAKA,YAAL,GAAoB,EAApB;CACA,aAAKC,sBAAL,GAA8B,EAA9B;CAEA,YACCY,CADD;CAAA,YAECC,OAFD;CAAA,YAGCC,KAAK,GAAG,KAAK7c,GAAL,CAAS4Q,QAAT,CAAkBkM,gBAAlB,CAAmC,wCAAnC,CAHT;;CAKA,aAAKH,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGE,KAAK,CAAC1U,MAAtB,EAA8BwU,CAAC,EAA/B,EACA;CACCC,UAAAA,OAAO,GAAGC,KAAK,CAACF,CAAD,CAAL,CAASjH,YAAT,CAAsB,0BAAtB,CAAV;;CACA,cAAIkH,OAAJ,EACA;CACC,iBAAKb,sBAAL,CAA4Ba,OAA5B,IAAuCC,KAAK,CAACF,CAAD,CAA5C;CACA;CACD;;CAEDE,QAAAA,KAAK,GAAG,KAAK7c,GAAL,CAAS4Q,QAAT,CAAkBkM,gBAAlB,CAAmC,6BAAnC,CAAR;;CACA,aAAKH,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGE,KAAK,CAAC1U,MAAtB,EAA8BwU,CAAC,EAA/B,EACA;CACCC,UAAAA,OAAO,GAAGC,KAAK,CAACF,CAAD,CAAL,CAASjH,YAAT,CAAsB,0BAAtB,CAAV;;CACA,cAAIkH,OAAJ,EACA;CACC,iBAAKd,YAAL,CAAkBc,OAAlB,IAA6BC,KAAK,CAACF,CAAD,CAAlC;CACA;CACD;CACD;;CAED,aAAO,CAAC,KAAKb,YAAN,EAAoB,KAAKC,sBAAzB,CAAP;CACA;CAvzCF;CAAA;CAAA,gCAyzCagB,QAzzCb,EA0zCC;CACC,WAAKR,iBAAL,GAAyB,EAAzB;CACA,UAAII,CAAJ;CAAA,UAAOpZ,YAAY,GAAG,EAAtB;;CAEA,WAAKoZ,CAAL,IAAUI,QAAQ,CAACxZ,YAAnB,EACA;CACC,YAAIwZ,QAAQ,CAACxZ,YAAT,CAAsBmK,cAAtB,CAAqCiP,CAArC,CAAJ,EACA;CACCpZ,UAAAA,YAAY,CAAC8J,IAAb,CAAkB0P,QAAQ,CAACxZ,YAAT,CAAsBoZ,CAAtB,CAAlB;CACA,eAAKJ,iBAAL,CAAuBQ,QAAQ,CAACxZ,YAAT,CAAsBoZ,CAAtB,CAAvB,IAAmD,IAAnD;CACA;CACD;;CACDI,MAAAA,QAAQ,CAACxZ,YAAT,GAAwBA,YAAxB;CACA,aAAOwZ,QAAP;CACA;CAx0CF;CAAA;CAAA,mCA20CC;CACC,UAAIpH,SAAJ;CAAA,UAAepS,YAAY,GAAG,EAA9B;;CAEA,WAAKoS,SAAL,IAAkB,KAAK4G,iBAAvB,EACA;CACC,YAAI,KAAKA,iBAAL,CAAuB7O,cAAvB,CAAsCiI,SAAtC,KAAoD,KAAK4G,iBAAL,CAAuB5G,SAAvB,CAAxD,EACA;CACCpS,UAAAA,YAAY,CAAC8J,IAAb,CAAkBsI,SAAlB;CACA;CACD;;CAED,WAAKrS,YAAL,CAAkBC,YAAlB,GAAiCA,YAAjC;CACA,WAAKJ,EAAL,CAAQkH,WAAR,CAAoBzC,IAApB,CAAyB,UAAzB,EAAqC,KAAK7C,QAA1C,EAAoD,cAApD,EAAoExB,YAApE;CACA;CAx1CF;CAAA;CAAA,+CA01C4ByZ,OA11C5B,EA21CC;CAAA;;CACC,UAAIA,OAAO,KAAK,KAAhB,EACA;CACC,YAAI,KAAKC,4BAAT,EACA;CACCC,UAAAA,YAAY,CAAC,KAAKD,4BAAN,CAAZ;CACA,eAAKA,4BAAL,GAAoC,IAApC;CACA;;CACD,aAAKA,4BAAL,GAAoC7W,UAAU,CAAC,YAAM;CAAC,UAAA,OAAI,CAACsW,0BAAL,CAAgC,KAAhC;CAAuC,SAA/C,EAAiD,GAAjD,CAA9C;CACA,OARD,MAUA;CACC,YAAIC,CAAJ;CAAA,YAAOQ,KAAK,GAAG,KAAKnd,GAAL,CAASsV,eAAT,CAAyB8H,sBAAzB,CAAgD,wBAAhD,CAAf;CACAtb,QAAAA,aAAG,CAACgJ,KAAJ,CAAU,KAAK9K,GAAL,CAASuV,eAAnB;;CACA,aAAKoH,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGQ,KAAK,CAAChV,MAAtB,EAA8BwU,CAAC,EAA/B,EACA;CACC,eAAK3c,GAAL,CAASuV,eAAT,CAAyB5K,WAAzB,CAAqC7I,aAAG,CAAC0U,MAAJ,CAAW,MAAX,EAAmB;CAACxU,YAAAA,KAAK,EAAE;CAACqb,cAAAA,SAAS,EAAE;CAAZ,aAAR;CAA2D3Y,YAAAA,IAAI,EAAEyY,KAAK,CAACR,CAAD,CAAL,CAASW;CAA1E,WAAnB,CAArC;CACA;;CAED,YAAI,CAACH,KAAK,CAAChV,MAAX,EACA;CACCrG,UAAAA,aAAG,CAACiH,QAAJ,CAAa,KAAK/I,GAAL,CAASqV,mBAAtB,EAA2C,kCAA3C;CACA,SAHD,MAIK,IAAIvT,aAAG,CAACqT,QAAJ,CAAa,KAAKnV,GAAL,CAASqV,mBAAtB,EAA2C,kCAA3C,CAAJ,EACL;CACCvT,UAAAA,aAAG,CAACuK,WAAJ,CAAgB,KAAKrM,GAAL,CAASqV,mBAAzB,EAA8C,kCAA9C;CACA;;CAED,aAAK3D,mBAAL;CACA;CACD;CAz3CF;CAAA;CAAA,0CA43CC;CACC,UACC6L,aAAa,GAAG,WADjB;CAAA,UAECZ,CAFD;CAAA,UAEIE,KAFJ;CAIAA,MAAAA,KAAK,GAAG,KAAK7c,GAAL,CAASoV,SAAT,CAAmB0H,gBAAnB,CAAoC,+BAApC,CAAR;;CACA,WAAKH,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGE,KAAK,CAAC1U,MAAtB,EAA8BwU,CAAC,EAA/B,EACA;CACC,YAAIA,CAAC,KAAKE,KAAK,CAAC1U,MAAN,GAAe,CAAzB,EACA;CACCrG,UAAAA,aAAG,CAACiH,QAAJ,CAAa8T,KAAK,CAACF,CAAD,CAAlB,EAAuBY,aAAvB;CACA,SAHD,MAKA;CACCzb,UAAAA,aAAG,CAACuK,WAAJ,CAAgBwQ,KAAK,CAACF,CAAD,CAArB,EAA0BY,aAA1B;CACA;CACD;;CAEDV,MAAAA,KAAK,GAAG,KAAK7c,GAAL,CAASsV,eAAT,CAAyBwH,gBAAzB,CAA0C,+BAA1C,CAAR;;CACA,WAAKH,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGE,KAAK,CAAC1U,MAAtB,EAA8BwU,CAAC,EAA/B,EACA;CACC,YAAIA,CAAC,KAAKE,KAAK,CAAC1U,MAAN,GAAe,CAAzB,EACA;CACCrG,UAAAA,aAAG,CAACiH,QAAJ,CAAa8T,KAAK,CAACF,CAAD,CAAlB,EAAuBY,aAAvB;CACA,SAHD,MAKA;CACCzb,UAAAA,aAAG,CAACuK,WAAJ,CAAgBwQ,KAAK,CAACF,CAAD,CAArB,EAA0BY,aAA1B;CACA;CACD;CACD;CA15CF;CAAA;CAAA,iDA45C8B9W,KA55C9B,EA65CC;CACC,UAAIA,KAAK,YAAYgG,0BAArB,EACA;CACC,YAAIlB,IAAI,GAAG9E,KAAK,CAACI,OAAN,EAAX,CADD;;CAGC,aAAK4L,eAAL,CAAqBC,QAArB,CAA8B;CAC7BjI,UAAAA,IAAI,EAAEc,IAAI,CAAC8O,QADkB;CAE7B1H,UAAAA,EAAE,EAAEpH,IAAI,CAAC+O;CAFoB,SAA9B,EAHD;CAQC;CACD;CAx6CF;CAAA;CAAA,gDA26CC;CACC,aAAO,KAAKkD,kBAAZ;CACA;CA76CF;CAAA;CAAA,8CA+6C2BA,kBA/6C3B,EAg7CC;CACC,WAAKA,kBAAL,GAA0BA,kBAA1B;CACA;CAl7CF;CAAA;CAAA,0CAq7CC;CACC,UAAI1C,QAAQ,GAAG,KAAKrI,eAAL,CAAqBtI,QAArB,EAAf;CACA,WAAKyK,eAAL,CAAqB;CACpBC,QAAAA,UAAU,EAAE,KAAK7J,yBAAL,EADQ;CAEpBP,QAAAA,IAAI,EAAErH,kBAAI,CAACoH,UAAL,CAAgBsQ,QAAQ,CAACrQ,IAAT,CAAcqK,OAAd,KAA0B1R,kBAAI,CAAC2R,YAAL,KAAsB,CAAhE,CAFc;CAGpBpC,QAAAA,EAAE,EAAEvP,kBAAI,CAACoH,UAAL,CAAgBsQ,QAAQ,CAACnI,EAAT,CAAYmC,OAAZ,KAAwB1R,kBAAI,CAAC2R,YAAL,KAAsB,EAA9D,CAHgB;CAIpBC,QAAAA,QAAQ,EAAE8F,QAAQ,CAACjI,YAJC;CAKpBpJ,QAAAA,QAAQ,EAAE,KAAKC,gBAAL,CAAsBC,YAAtB;CALU,OAArB;CAOA;CA97CF;CAAA;CAAA,qCAi8CC;CACC,aAAO,KAAK3J,GAAL,CAASyd,WAAT,IAAwB3b,aAAG,CAACqT,QAAJ,CAAa,KAAKnV,GAAL,CAASyd,WAAtB,EAAmC,kCAAnC,CAA/B;CACA;CAn8CF;CAAA;CAAA,+BAq8CYzX,CAr8CZ,EAs8CC;CACC,UAAG,CAACA,CAAC,CAAC0X,OAAF,IAAa1X,CAAC,CAAC2X,OAAhB,KAA4B,CAAC3X,CAAC,CAAC4X,MAA/B,IAAyC5X,CAAC,CAAC6X,OAAF,KAAcza,kBAAI,CAAC0a,UAAL,CAAgB,OAAhB,CAA1D,EACA;CACC,aAAKlW,IAAL;CACA;CACD;CA38CF;CAAA;CAAA,8BA68CWmW,SA78CX,EA88CC;CAAA;;CACC,UAAIC,SAAS,GAAG,EAAhB;;CAEA,UAAIrZ,cAAI,CAACyN,OAAL,CAAa2L,SAAb,CAAJ,EACA;CACCA,QAAAA,SAAS,CAAC9S,OAAV,CAAkB,UAACkC,KAAD,EAAW;CAC5B,cAAIA,KAAK,CAACC,IAAN,KAAe,0BAAnB,EACA;CACC,mBAAOhK,kBAAI,CAAC6a,cAAL,CAAoB9Q,KAAK,CAAC+Q,OAA1B,EAAmC,OAAI,CAACle,GAAL,CAASiY,YAA5C,EAA0D;CAACiF,cAAAA,YAAY,EAAE;CAAf,aAA1D,CAAP;CACA;;CACDc,UAAAA,SAAS,IAAI7Q,KAAK,CAAC+Q,OAAN,GAAgB,IAA7B;CACA,SAND;CAOA;;CAED,UAAIF,SAAS,KAAK,EAAlB,EACA;CACCG,QAAAA,KAAK,CAACH,SAAD,CAAL;CACA;CACD;CAh+CF;CAAA;CAAA,yCAm+CC;CAAA,UADmBI,QACnB,uEAD8B,EAC9B;CACC,UAAMtb,KAAK,GAAG,KAAKA,KAAnB;CACA,UAAIub,MAAM,GAAG,EAAb,CAFD;;CAKC,UAAI,CAACD,QAAQ,CAAC3V,QAAT,CAAkB,MAAlB,CAAD,IACA3F,KAAK,CAACN,IAAN,KAAe,KAAKxC,GAAL,CAASuJ,IAAT,CAAc/G,IAAd,CAAmBgH,KADtC,EAEA;CACC6U,QAAAA,MAAM,CAAChR,IAAP,CAAY,MAAZ;CACA,OATF;CAYC;CACA;CACA;CACA;CACA;CAEA;;;CACA,UAAI,CAAC+Q,QAAQ,CAAC3V,QAAT,CAAkB,UAAlB,CAAD,IAEH,KAAKiB,gBAAL,CAAsB4U,eAAtB,CAAsChM,0BAAQ,CAACiM,gBAAT,CAA0B,KAAKzb,KAAL,CAAWiR,WAAX,EAA1B,CAAtC,MAEA,KAAKrK,gBAAL,CAAsB4U,eAAtB,CAAsChM,0BAAQ,CAACiM,gBAAT,CAA0B,KAAK7U,gBAAL,CAAsBC,YAAtB,EAA1B,CAAtC,CAJD,EAMA;CACC0U,QAAAA,MAAM,CAAChR,IAAP,CAAY,UAAZ;CACA,OA3BF;;;CA8BC,UAAMyN,QAAQ,GAAG,KAAKrI,eAAL,CAAqBtI,QAArB,EAAjB;;CACA,UAAI,CAACiU,QAAQ,CAAC3V,QAAT,CAAkB,WAAlB,CAAD,KAEF3F,KAAK,CAAC0b,SAAN,OAAsB1D,QAAQ,CAAC7Z,OAA/B,IACG6Z,QAAQ,CAACrQ,IAAT,CAAcgU,QAAd,OAA6B3b,KAAK,CAAC2H,IAAN,CAAWgU,QAAX,EADhC,IAEG3D,QAAQ,CAACnI,EAAT,CAAY8L,QAAZ,OAA2B3b,KAAK,CAAC6P,EAAN,CAAS8L,QAAT,EAJ5B,CAAJ,EAKA;CACCJ,QAAAA,MAAM,CAAChR,IAAP,CAAY,WAAZ;CACA,OAtCF;;;CAyCC,UAAI,CAAC+Q,QAAQ,CAAC3V,QAAT,CAAkB,SAAlB,CAAD,IAEH7F,QAAQ,CAACE,KAAK,CAAC2N,SAAP,CAAR,KAA8B7N,QAAQ,CAAC,KAAK5C,GAAL,CAASiT,YAAT,CAAsBzJ,KAAvB,CAFvC,EAGA;CACC6U,QAAAA,MAAM,CAAChR,IAAP,CAAY,SAAZ;CACA,OA9CF;;;CAiDC,UAAI,CAAC+Q,QAAQ,CAAC3V,QAAT,CAAkB,OAAlB,CAAD,IAEH,KAAKuC,yBAAL,GAAiC8E,GAAjC,CAAqC,UAAClH,IAAD,EAAQ;CAAC,eAAOA,IAAI,CAACwC,QAAL,GAAgB,GAAhB,GAAsBxC,IAAI,CAACvB,EAAlC;CAAqC,OAAnF,EAAqF0G,IAArF,CAA0F,GAA1F,MAEAjL,KAAK,CAAC4b,sBAAN,GAA+B5O,GAA/B,CAAmC,UAAClH,IAAD,EAAQ;CAAC,eAAOA,IAAI,CAACwC,QAAL,GAAgB,GAAhB,GAAsBxC,IAAI,CAACvB,EAAlC;CAAqC,OAAjF,EAAmF0G,IAAnF,CAAwF,GAAxF,CAJD,EAMA;CACCsQ,QAAAA,MAAM,CAAChR,IAAP,CAAY,OAAZ;CACA;;CAED,aAAOgR,MAAP;CACA;CA/hDF;CAAA;CAAA,sCAkiDC;CACC,aAAO,KAAKnW,kBAAL,GAA0BC,MAA1B,GAAmC,CAA1C;CACA;CApiDF;CAAA;CAAA,mCAuiDC;CACC,UACCwW,KAAK,GAAG,EADT;CAAA,UAECC,WAAW,GAAG,KAAK5e,GAAL,CAAS6e,aAAT,CAAuB/B,gBAAvB,CAAwC,mCAAxC,CAFf;;CAIA,WAAK,IAAIH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiC,WAAW,CAACzW,MAAhC,EAAwCwU,CAAC,EAAzC,EACA;CACC,YAAI,CAACgC,KAAK,CAAClW,QAAN,CAAemW,WAAW,CAACjC,CAAD,CAAX,CAAenT,KAA9B,CAAL,EACA;CACCmV,UAAAA,KAAK,CAACtR,IAAN,CAAWuR,WAAW,CAACjC,CAAD,CAAX,CAAenT,KAA1B;CACA;CACD;;CACD,aAAOmV,KAAP;CACA;CApjDF;CAAA;CAAA;;;;;;;;"}