this.BX=this.BX||{};(function(t,e,a,i,n,r,s){"use strict";let o=t=>t,c,l;class u{static parseTime(t){let e=u.parseDate1(BX.date.format(u.getDateFormat(),new Date)+" "+t,false);return e?{h:e.getHours(),m:e.getMinutes()}:e}static getTimeRounded(t){return Math.round(t.getTime()/6e4)*6e4}static parseDate(t,e,a,i){return BX.parseDate(t,e,a,i)}static parseDate1(t,a,i){let n,r,s,o;if(!a)a=e.Loc.getMessage("FORMAT_DATETIME");t=BX.util.trim(t);if(i!==false)a=a.replace(":SS","");if(BX.type.isNotEmptyString(t)){o="";for(n=1;n<=12;n++){o=o+"|"+e.Loc.getMessage("MON_"+n)}let i=new RegExp("([0-9]+|[a-z]+"+o+")","ig"),c=t.match(i),l=e.Loc.getMessage("FORMAT_DATE").match(/(DD|MI|MMMM|MM|M|YYYY)/gi),u=[],g=[],m={};if(!c){return null}if(c.length>l.length){l=a.match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/gi)}for(n=0,r=c.length;n<r;n++){if(BX.util.trim(c[n])!==""){u[u.length]=c[n]}}for(n=0,r=l.length;n<r;n++){if(BX.util.trim(l[n])!=""){g[g.length]=l[n]}}let d=BX.util.array_search("MMMM",g);if(d>0){u[d]=BX.getNumMonth(u[d]);g[d]="MM"}else{d=BX.util.array_search("M",g);if(d>0){u[d]=BX.getNumMonth(u[d]);g[d]="MM"}}for(n=0,r=g.length;n<r;n++){s=g[n].toUpperCase();m[s]=s=="T"||s=="TT"?u[n]:parseInt(u[n],10)}if(m["DD"]>0&&m["MM"]>0&&m["YYYY"]>0){let t=new Date;{t.setDate(1);t.setFullYear(m["YYYY"]);t.setMonth(m["MM"]-1);t.setDate(m["DD"]);t.setHours(0,0,0)}if((!isNaN(m["HH"])||!isNaN(m["GG"])||!isNaN(m["H"])||!isNaN(m["G"]))&&!isNaN(m["MI"])){if(!isNaN(m["H"])||!isNaN(m["G"])){let t=(m["T"]||m["TT"]||"am").toUpperCase()=="PM";let e=parseInt(m["H"]||m["G"]||0,10);if(t){m["HH"]=e+(e==12?0:12)}else{m["HH"]=e<12?e:0}}else{m["HH"]=parseInt(m["HH"]||m["GG"]||0,10)}if(isNaN(m["SS"]))m["SS"]=0;{t.setHours(m["HH"],m["MI"],m["SS"])}}return t}}return null}static formatTime(t,a){let i;if(e.Type.isDate(t)){i=t}else{i=new Date;i.setHours(t,a,0)}return BX.date.format(u.getTimeFormatShort(),i.getTime()/1e3)}static formatDate(t){if(e.Type.isDate(t)){t=t.getTime()}return BX.date.format(u.getDateFormat(),t/1e3)}static formatDateTime(t){if(e.Type.isDate(t)){t=t.getTime()}return BX.date.format(u.getDateTimeFormat(),t/1e3)}static formatTimeInterval(t,e){const i=a.DateTimeFormat.format(u.getTimeFormatShort(),t.getTime()/1e3);const n=a.DateTimeFormat.format(u.getTimeFormatShort(),e.getTime()/1e3);return`${i} - ${n}`}static formatDateUsable(t,a=true,i=false){const n=e.Loc.getMessage("LANGUAGE_ID");let r=u.getDateFormat();if(n==="ru"||n==="ua"){r=i?"l, j F":"j F";if(t.getFullYear&&t.getFullYear()!==(new Date).getFullYear()&&a!==false){r+=" Y"}}return BX.date.format([["today","today"],["tommorow","tommorow"],["yesterday","yesterday"],["",r]],t)}static getDayLength(){if(!u.DAY_LENGTH){u.DAY_LENGTH=864e5}return u.DAY_LENGTH}static getDefaultColorList(){return["#86b100","#0092cc","#00afc7","#e89b06","#00b38c","#de2b24","#bd7ac9","#838fa0","#c3612c","#e97090"]}static findTargetNode(t,e){let a=false;if(t){let i="data-bx-calendar",n;if(t.attributes&&t.attributes.length){for(n=0;n<t.attributes.length;n++){if(t.attributes[n].name&&t.attributes[n].name.substr(0,i.length)===i){a=t;break}}}if(!a){a=BX.findParent(t,(function(t){let e;if(t.attributes&&t.attributes.length){for(e=0;e<t.attributes.length;e++){if(t.attributes[e].name&&t.attributes[e].name.substr(0,i.length)===i)return true}}return false}),e)}}return a}static getFollowedUserList(t){return[]}static getWeekDayByInd(t){return["SU","MO","TU","WE","TH","FR","SA"][t]}static getIndByWeekDay(t){return new Object({SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6})[t]}static getWeekdaysLoc(){const t=new Date;const e=[];const i=24*60*60*1e3;for(let n=0;n<7;n++){const r=a.DateTimeFormat.format("D",new Date(t.getTime()+i*n));e[(t.getDay()+n)%7]=r}return e}static getLoader(t,a){return e.Tag.render(c||(c=o`
		<div class="${0}">
			<svg class="calendar-loader-circular"
				style="width:${0}px; height:${0}px;"
				viewBox="25 25 50 50">
					<circle class="calendar-loader-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>
					<circle class="calendar-loader-inner-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>
			</svg>
		</div>
`),a||"calendar-loader",parseInt(t),parseInt(t))}static getDayCode(t){return t.getFullYear()+"-"+("0"+~~(t.getMonth()+1)).substr(-2,2)+"-"+("0"+~~t.getDate()).substr(-2,2)}static getTextColor(t){if(!t){return false}if(t.charAt(0)==="#"){t=t.substring(1,7)}let e=parseInt(t.substring(0,2),16),a=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16),n=(e*.8+a+i*.2)/510*100;return n<50}static getKeyCode(t){if(!e.Type.isString(t)){return false}let a={backspace:8,enter:13,escape:27,space:32,delete:46,left:37,right:39,up:38,down:40,z:90,y:89,shift:16,ctrl:17,alt:18,cmd:91,cmdRight:93,pageUp:33,pageDown:34,d:68,w:87,m:77,a:65};return a[t.toLowerCase()]}static isAnyModifierKeyPressed(t=window.event){if(t){return t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}return null}static getUsableDateTime(t,a){if(e.Type.isDate(t)){t=t.getTime()}let i=(a||10)*60*1e3;t=Math.ceil(t/i)*i;return new Date(t)}static showNotification(t,a=null){if(e.Type.isString(t)&&t!==""){BX.UI.Notification.Center.notify({content:t,actions:a})}}static showFieldError(t,a,i){if(e.Type.isDomNode(a)&&e.Type.isString(t)&&t!==""){e.Dom.remove(a.querySelector(".ui-alert"));let i=new BX.UI.Alert({color:BX.UI.Alert.Color.DANGER,icon:BX.UI.Alert.Icon.DANGER,text:t});let n=i.getContainer();a.appendChild(n);return n}}static getDateFormat(){if(!u.DATE_FORMAT){u.DATE_FORMAT=BX.Main.Date.convertBitrixFormat(e.Loc.getMessage("FORMAT_DATE"))}return u.DATE_FORMAT}static setDayOfWeekMonthFormat(t){u.dayOfWeekMonthFormat=t}static getDayOfWeekMonthFormat(){return u.dayOfWeekMonthFormat||"l, j F"}static setDayMonthFormat(t){u.dayMonthFormat=t}static getDayMonthFormat(){return u.dayMonthFormat||"j F"}static setLongDateFormat(t){u.longDateFormat=t}static getLongDateFormat(){return u.longDateFormat||"j F Y"}static getDateTimeFormat(){if(!u.DATETIME_FORMAT){u.DATETIME_FORMAT=BX.Main.Date.convertBitrixFormat(e.Loc.getMessage("FORMAT_DATETIME"))}return u.DATETIME_FORMAT}static getTimeFormat(){if(!u.TIME_FORMAT){if(e.Loc.getMessage("FORMAT_DATETIME").substr(0,e.Loc.getMessage("FORMAT_DATE").length)===e.Loc.getMessage("FORMAT_DATE")){u.TIME_FORMAT=BX.util.trim(u.getDateTimeFormat().substr(u.getDateFormat().length));u.TIME_FORMAT_BX=BX.util.trim(e.Loc.getMessage("FORMAT_DATETIME").substr(e.Loc.getMessage("FORMAT_DATE").length))}else{u.TIME_FORMAT_BX=BX.isAmPmMode()?"H:MI:SS T":"HH:MI:SS";u.TIME_FORMAT=BX.date.convertBitrixFormat(BX.isAmPmMode()?"H:MI:SS T":"HH:MI:SS")}}return u.TIME_FORMAT}static getTimeFormatShort(){if(!u.TIME_FORMAT_SHORT){u.TIME_FORMAT_SHORT=u.getTimeFormat().replace(":s","");u.TIME_FORMAT_SHORT_BX=u.TIME_FORMAT_BX.replace(":SS","")}return u.TIME_FORMAT_SHORT}static getCurrentUserId(){if(!u.currentUserId){u.currentUserId=parseInt(e.Loc.getMessage("USER_ID"))}return u.currentUserId}static getTimeByInt(t){t=parseInt(t);let e=Math.floor(t/60);return{hour:e,min:t-e*60}}static preventSelection(t){t.ondrag=BX.False;t.ondragstart=BX.False;t.onselectstart=BX.False}static getBX(){return window.top.BX||window.BX}static closeAllPopups(){if(n.PopupManager.isAnyPopupShown()){for(let t=0,e=n.PopupManager._popups.length;t<e;t++){if(n.PopupManager._popups[t]&&n.PopupManager._popups[t].isShown()){n.PopupManager._popups[t].close()}}}}static showConfirmPopup(t,a,i={}){this.confirmPopup=new s.MessageBox({message:e.Tag.render(l||(l=o`
				<div class="calendar-list-slider-messagebox-text">
					${0}
				</div>
			`),a),minHeight:120,minWidth:280,maxWidth:300,buttons:BX.UI.Dialogs.MessageBoxButtons.OK_CANCEL,onOk:()=>{var e;t();(e=this.confirmPopup)==null?void 0:e.close()},onCancel:()=>{var t;(t=this.confirmPopup)==null?void 0:t.close()},popupOptions:{events:{onPopupClose:()=>{delete this.confirmPopup}},closeByEsc:false,padding:0,contentPadding:0,animation:"fading-slide"},...i});this.confirmPopup.show()}static sendAnalyticLabel(t){BX.ajax.runAction("calendar.api.calendarajax.sendAnalyticsLabel",{analyticsLabel:t})}static setOptions(t,e){u.config=t;u.additionalParams=e}static setUserSettings(t){u.userSettings=t}static getUserSettings(){return e.Type.isObjectLike(u.userSettings)?u.userSettings:{}}static setCalendarContext(t){u.calendarContext=t}static getCalendarContext(){return u.calendarContext||null}static getMeetingStatusList(){return["Y","N","Q","H"]}static checkEmailLimitationPopup(){const t=u.getEventWithEmailGuestAmount();const e=u.getEventWithEmailGuestLimit();return e>0&&(t===8||t===4||t>=e)}static isEventWithEmailGuestAllowed(){return u.getEventWithEmailGuestLimit()===-1||u.getEventWithEmailGuestAmount()<u.getEventWithEmailGuestLimit()}static setEventWithEmailGuestAmount(t){u.countEventWithEmailGuestAmount=t}static setEventWithEmailGuestLimit(t){u.eventWithEmailGuestLimit=t}static getEventWithEmailGuestAmount(){return u.countEventWithEmailGuestAmount}static getEventWithEmailGuestLimit(){return u.eventWithEmailGuestLimit}static setCurrentView(t=null){u.currentCalendarView=t}static getCurrentView(){return u.currentCalendarView||null}static adjustDateForTimezoneOffset(t,a=0,i=false){if(!e.Type.isDate(t))throw new Error("Wrong type for date attribute. DateTime object expected.");if(!parseInt(a)||i===true)return t;return new Date(t.getTime()-parseInt(a)*1e3)}static getFormattedTimezone(t){const e=this.getTimeZoneOffset(t);if(e===0){return"(UTC) "+t}const a=e>0?"-":"+";const i=("0"+Math.floor(Math.abs(e)/60)).slice(-2);const n=("0"+Math.abs(e)%60).slice(-2);return"(UTC "+a+i+":"+n+") "+t}static getTimezoneDateFromTimestampUTC(t,e){return new Date(t+this.getTimeZoneOffset()*60*1e3-this.getTimeZoneOffset(e)*60*1e3)}static getTimeZoneOffset(t=undefined){const e=new Date((new Date).toLocaleString("en-US",{timeZone:t})).getTime();const a=new Date((new Date).toLocaleString("en-US",{timeZone:"UTC"})).getTime();return parseInt((a-e)/6e4)}static randomInt(t,e){return Math.round(t-.5+Math.random()*(e-t+1))}static getRandomColor(){const t=u.getDefaultColorList();return t[u.randomInt(0,t.length-1)]}static setAccessNames(t={}){u.accessNames={};for(let e in t){if(t.hasOwnProperty(e)){u.setAccessName(e,t[e])}}}static getAccessName(t){return u.accessNames[t]||t}static setAccessName(t,e){u.accessNames[t]=e}static getRandomInt(t=6){return Math.round(Math.random()*Math.pow(10,t))}static displayError(t,a){if(e.Type.isArray(t)){let e="";for(let a=0;a<t.length;a++){e+=t[a].message+"\n"}t=e}setTimeout((()=>{alert(t||"[Bitrix Calendar] Request error");if(a){location.reload()}}),200)}static convertEntityToAccessCode(t){if(e.Type.isObjectLike(t)){if(t.entityId==="meta-user"&&t.id==="all-users"){return"UA"}else if(t.entityId==="user"){return"U"+t.id}else if(t.entityId==="project"){return"SG"+t.id+"_K"}else if(t.entityId==="department"){return"DR"+t.id}else if(t.entityId==="group"){return t.id}}}static extendPlannerWatches({entries:t,userId:e}){t.forEach((t=>{if(t.type==="user"&&parseInt(t.id)!==parseInt(e)){const e=u.PLANNER_PULL_TAG.replace("#USER_ID#",t.id);if(!u.PLANNER_WATCH_LIST.includes(e)){r.PULL.extendWatch(e);u.PLANNER_WATCH_LIST.push(e)}}}))}static clearPlannerWatches(){u.PLANNER_WATCH_LIST.forEach((t=>{r.PULL.clearWatch(t)}));u.PLANNER_WATCH_LIST=[]}static registerRequestId(){const t=BX.Calendar.Util.getRandomInt(8);u.REQUEST_ID_LIST.push(t);return t}static unregisterRequestId(t){u.REQUEST_ID_LIST=u.REQUEST_ID_LIST.filter((e=>e!==t))}static checkRequestId(t){t=parseInt(t);return!e.Type.isInteger(t)||!u.REQUEST_ID_LIST.includes(t)}static initHintNode(t){var a;const i=u.getBX();if(e.Type.isElementNode(t)&&i!=null&&(a=i.UI)!=null&&a.Hint){var n,r;if(i!=null&&(n=i.UI)!=null&&(r=n.Hint)!=null&&r.popup){i.UI.Hint.popup.destroy();i.UI.Hint.popup=null;i.UI.Hint.content=null}i.UI.Hint.initNode(t)}}static documentIsDisplayingNow(){return!document.hidden}static removeHash(){if("pushState"in history){history.pushState("",document.title,window.location.pathname+window.location.search)}else{let t=document.body.scrollTop;let e=document.body.scrollLeft;window.location.hash="";document.body.scrollTop=t;document.body.scrollLeft=e}}static setIphoneConnectionStatus(t){u.iphoneConnectionStatus=t}static isIphoneConnected(){return u.iphoneConnectionStatus}static setMacConnectionStatus(t){u.macConnectionStatus=t}static isMacConnected(){return u.macConnectionStatus}static setIcloudConnectionStatus(t){u.icloudConnectionStatus=t}static isIcloudConnected(){return u.icloudConnectionStatus}static setGoogleConnectionStatus(t){u.googleConnectionStatus=t}static isGoogleConnected(){return u.googleConnectionStatus}static setIsSharingFeatureEnabled(t){u.isSharingFeatureEnabled=t}static checkSharingFeatureEnabled(){return u.isSharingFeatureEnabled}static setSharingConfig(t){u.sharingConfig=t}static getSharingConfig(){return u.sharingConfig}static downloadIcsFile(t,e){const a=document.createElement("a");a.href="data:text/calendar,"+encodeURI(t);a.download=e;a.click()}static isMobileBrowser(){return navigator.userAgent.toLowerCase().includes("iphone")||navigator.userAgent.toLowerCase().includes("ipad")||navigator.userAgent.toLowerCase().includes("android")}}u.PLANNER_PULL_TAG="calendar-planner-#USER_ID#";u.PLANNER_WATCH_LIST=[];u.REQUEST_ID_LIST=[];u.accessNames={};t.Util=u})(this.BX.Calendar=this.BX.Calendar||{},BX,BX.Main,BX,BX.Main,BX,BX.UI.Dialogs);
//# sourceMappingURL=util.bundle.map.js