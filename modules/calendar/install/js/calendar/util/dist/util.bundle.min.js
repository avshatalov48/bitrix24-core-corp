this.BX=this.BX||{};(function(e,t,r,a,n){"use strict";(function(e){if(!e.BX){e.BX={}}if(!e.BX.Main){e.BX.Main={}}else if(e.BX.Main.Date){return}var t=e.BX;t.Main.Date=t.Main.DateTimeFormat={AM_PM_MODE:{UPPER:1,LOWER:2,NONE:false},format:function(e,t,a,n){var i=this;var s=r.isDate(t)?new Date(t.getTime()):r.isNumber(t)?new Date(t*1e3):new Date;var _=r.isDate(a)?new Date(a.getTime()):r.isNumber(a)?new Date(a*1e3):new Date;var o=!!n;if(r.isArray(e))return l(e,s,_,o);else if(!r.isNotEmptyString(e))return"";var u=(e.match(/{{([^{}]*)}}/g)||[]).map((function(e){return(e.match(/[^{}]+/)||[""])[0]}));if(u.length>0){u.forEach((function(t,r){e=e.replace("{{"+t+"}}","{{"+r+"}}")}))}var D=/\\?(sago|iago|isago|Hago|dago|mago|Yago|sdiff|idiff|Hdiff|ddiff|mdiff|Ydiff|sshort|ishort|Hshort|dshort|mhort|Yshort|yesterday|today|tommorow|tomorrow|[a-z])/gi;var M={d:function(){return r.strPadLeft(T(s).toString(),2,"0")},D:function(){return i._getMessage("DOW_"+A(s))},j:function(){return T(s)},l:function(){return i._getMessage("DAY_OF_WEEK_"+A(s))},N:function(){return A(s)||7},S:function(){if(T(s)%10==1&&T(s)!=11)return"st";else if(T(s)%10==2&&T(s)!=12)return"nd";else if(T(s)%10==3&&T(s)!=13)return"rd";else return"th"},w:function(){return A(s)},z:function(){var e=new Date(g(s),0,1);var t=new Date(g(s),O(s),T(s));return Math.ceil((t-e)/(24*3600*1e3))},W:function(){var e=new Date(s.getTime());var t=(A(s)+6)%7;p(e,T(e)-t+3);var a=e.getTime();h(e,0,1);if(A(e)!=4)h(e,0,1+(4-A(e)+7)%7);var n=1+Math.ceil((a-e)/(7*24*3600*1e3));return r.strPadLeft(n.toString(),2,"0")},F:function(){return i._getMessage("MONTH_"+(O(s)+1)+"_S")},f:function(){return i._getMessage("MONTH_"+(O(s)+1))},m:function(){return r.strPadLeft((O(s)+1).toString(),2,"0")},M:function(){return i._getMessage("MON_"+(O(s)+1))},n:function(){return O(s)+1},t:function(){var e=o?new Date(Date.UTC(g(s),O(s)+1,0)):new Date(g(s),O(s)+1,0);return T(e)},L:function(){var e=g(s);return e%4==0&&e%100!=0||e%400==0?1:0},o:function(){var e=new Date(s.getTime());p(e,T(e)-(A(s)+6)%7+3);return g(e)},Y:function(){return g(s)},y:function(){return g(s).toString().slice(2)},a:function(){return m(s)>11?"pm":"am"},A:function(){return m(s)>11?"PM":"AM"},B:function(){var e=(s.getUTCHours()+1)%24+s.getUTCMinutes()/60+s.getUTCSeconds()/3600;return r.strPadLeft(Math.floor(e*1e3/24).toString(),3,"0")},g:function(){return m(s)%12||12},G:function(){return m(s)},h:function(){return r.strPadLeft((m(s)%12||12).toString(),2,"0")},H:function(){return r.strPadLeft(m(s).toString(),2,"0")},i:function(){return r.strPadLeft(F(s).toString(),2,"0")},s:function(){return r.strPadLeft(E(s).toString(),2,"0")},u:function(){return r.strPadLeft((d(s)*1e3).toString(),6,"0")},e:function(){if(o)return"UTC";return""},I:function(){if(o)return 0;var e=new Date(g(s),0,1);var t=Date.UTC(g(s),0,1);var r=new Date(g(s),6,0);var a=Date.UTC(g(s),6,0);return 0+(e-t!==r-a)},O:function(){if(o)return"+0000";var e=s.getTimezoneOffset();var t=Math.abs(e);return(e>0?"-":"+")+r.strPadLeft((Math.floor(t/60)*100+t%60).toString(),4,"0")},P:function(){if(o)return"+00:00";var e=this.O();return e.substr(0,3)+":"+e.substr(3)},Z:function(){if(o)return 0;return-s.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(D,S)},r:function(){return"D, d M Y H:i:s O".replace(D,S)},U:function(){return Math.floor(s.getTime()/1e3)},sago:function(){return I(H((_-s)/1e3),{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"})},sdiff:function(){return I(H((_-s)/1e3),{0:"FD_SECOND_DIFF_0",1:"FD_SECOND_DIFF_1","10_20":"FD_SECOND_DIFF_10_20",MOD_1:"FD_SECOND_DIFF_MOD_1",MOD_2_4:"FD_SECOND_DIFF_MOD_2_4",MOD_OTHER:"FD_SECOND_DIFF_MOD_OTHER"})},sshort:function(){return i._getMessage("FD_SECOND_SHORT").replace(/#VALUE#/g,H((_-s)/1e3))},iago:function(){return I(H((_-s)/60/1e3),{0:"FD_MINUTE_AGO_0",1:"FD_MINUTE_AGO_1","10_20":"FD_MINUTE_AGO_10_20",MOD_1:"FD_MINUTE_AGO_MOD_1",MOD_2_4:"FD_MINUTE_AGO_MOD_2_4",MOD_OTHER:"FD_MINUTE_AGO_MOD_OTHER"})},idiff:function(){return I(H((_-s)/60/1e3),{0:"FD_MINUTE_DIFF_0",1:"FD_MINUTE_DIFF_1","10_20":"FD_MINUTE_DIFF_10_20",MOD_1:"FD_MINUTE_DIFF_MOD_1",MOD_2_4:"FD_MINUTE_DIFF_MOD_2_4",MOD_OTHER:"FD_MINUTE_DIFF_MOD_OTHER"})},isago:function(){var e=H((_-s)/60/1e3);var t=I(e,{0:"FD_MINUTE_0",1:"FD_MINUTE_1","10_20":"FD_MINUTE_10_20",MOD_1:"FD_MINUTE_MOD_1",MOD_2_4:"FD_MINUTE_MOD_2_4",MOD_OTHER:"FD_MINUTE_MOD_OTHER"});t+=" ";var r=H((_-s)/1e3)-e*60;t+=I(r,{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"});return t},ishort:function(){return i._getMessage("FD_MINUTE_SHORT").replace(/#VALUE#/g,H((_-s)/60/1e3))},Hago:function(){return I(H((_-s)/60/60/1e3),{0:"FD_HOUR_AGO_0",1:"FD_HOUR_AGO_1","10_20":"FD_HOUR_AGO_10_20",MOD_1:"FD_HOUR_AGO_MOD_1",MOD_2_4:"FD_HOUR_AGO_MOD_2_4",MOD_OTHER:"FD_HOUR_AGO_MOD_OTHER"})},Hdiff:function(){return I(H((_-s)/60/60/1e3),{0:"FD_HOUR_DIFF_0",1:"FD_HOUR_DIFF_1","10_20":"FD_HOUR_DIFF_10_20",MOD_1:"FD_HOUR_DIFF_MOD_1",MOD_2_4:"FD_HOUR_DIFF_MOD_2_4",MOD_OTHER:"FD_HOUR_DIFF_MOD_OTHER"})},Hshort:function(){return i._getMessage("FD_HOUR_SHORT").replace(/#VALUE#/g,H((_-s)/60/60/1e3))},yesterday:function(){return i._getMessage("FD_YESTERDAY")},today:function(){return i._getMessage("FD_TODAY")},tommorow:function(){return i._getMessage("FD_TOMORROW")},tomorrow:function(){return i._getMessage("FD_TOMORROW")},dago:function(){return I(H((_-s)/60/60/24/1e3),{0:"FD_DAY_AGO_0",1:"FD_DAY_AGO_1","10_20":"FD_DAY_AGO_10_20",MOD_1:"FD_DAY_AGO_MOD_1",MOD_2_4:"FD_DAY_AGO_MOD_2_4",MOD_OTHER:"FD_DAY_AGO_MOD_OTHER"})},ddiff:function(){return I(H((_-s)/60/60/24/1e3),{0:"FD_DAY_DIFF_0",1:"FD_DAY_DIFF_1","10_20":"FD_DAY_DIFF_10_20",MOD_1:"FD_DAY_DIFF_MOD_1",MOD_2_4:"FD_DAY_DIFF_MOD_2_4",MOD_OTHER:"FD_DAY_DIFF_MOD_OTHER"})},dshort:function(){return i._getMessage("FD_DAY_SHORT").replace(/#VALUE#/g,H((_-s)/60/60/24/1e3))},mago:function(){return I(H((_-s)/60/60/24/31/1e3),{0:"FD_MONTH_AGO_0",1:"FD_MONTH_AGO_1","10_20":"FD_MONTH_AGO_10_20",MOD_1:"FD_MONTH_AGO_MOD_1",MOD_2_4:"FD_MONTH_AGO_MOD_2_4",MOD_OTHER:"FD_MONTH_AGO_MOD_OTHER"})},mdiff:function(){return I(H((_-s)/60/60/24/31/1e3),{0:"FD_MONTH_DIFF_0",1:"FD_MONTH_DIFF_1","10_20":"FD_MONTH_DIFF_10_20",MOD_1:"FD_MONTH_DIFF_MOD_1",MOD_2_4:"FD_MONTH_DIFF_MOD_2_4",MOD_OTHER:"FD_MONTH_DIFF_MOD_OTHER"})},mshort:function(){return i._getMessage("FD_MONTH_SHORT").replace(/#VALUE#/g,H((_-s)/60/60/24/31/1e3))},Yago:function(){return I(H((_-s)/60/60/24/365/1e3),{0:"FD_YEARS_AGO_0",1:"FD_YEARS_AGO_1","10_20":"FD_YEARS_AGO_10_20",MOD_1:"FD_YEARS_AGO_MOD_1",MOD_2_4:"FD_YEARS_AGO_MOD_2_4",MOD_OTHER:"FD_YEARS_AGO_MOD_OTHER"})},Ydiff:function(){return I(H((_-s)/60/60/24/365/1e3),{0:"FD_YEARS_DIFF_0",1:"FD_YEARS_DIFF_1","10_20":"FD_YEARS_DIFF_10_20",MOD_1:"FD_YEARS_DIFF_MOD_1",MOD_2_4:"FD_YEARS_DIFF_MOD_2_4",MOD_OTHER:"FD_YEARS_DIFF_MOD_OTHER"})},Yshort:function(){return I(H((_-s)/60/60/24/365/1e3),{0:"FD_YEARS_SHORT_0",1:"FD_YEARS_SHORT_1","10_20":"FD_YEARS_SHORT_10_20",MOD_1:"FD_YEARS_SHORT_MOD_1",MOD_2_4:"FD_YEARS_SHORT_MOD_2_4",MOD_OTHER:"FD_YEARS_SHORT_MOD_OTHER"})},x:function(){var e=i.isAmPmMode(true);var t=e===i.AM_PM_MODE.LOWER?"g:i a":e===i.AM_PM_MODE.UPPER?"g:i A":"H:i";return i.format([["tomorrow","tomorrow, "+t],["-",i.convertBitrixFormat(i._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")],["s","sago"],["i","iago"],["today","today, "+t],["yesterday","yesterday, "+t],["",i.convertBitrixFormat(i._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")]],s,_,o)},X:function(){var e=i.isAmPmMode(true);var t=e===i.AM_PM_MODE.LOWER?"g:i a":e===i.AM_PM_MODE.UPPER?"g:i A":"H:i";var r=i.format([["tomorrow","tomorrow"],["-",i.convertBitrixFormat(i._getMessage("FORMAT_DATE"))],["today","today"],["yesterday","yesterday"],["",i.convertBitrixFormat(i._getMessage("FORMAT_DATE"))]],s,_,o);var a=i.format([["tomorrow",t],["today",t],["yesterday",t],["",""]],s,_,o);if(a.length>0)return i._getMessage("FD_DAY_AT_TIME").replace(/#DAY#/g,r).replace(/#TIME#/g,a);else return r},Q:function(){var e=H((_-s)/60/60/24/1e3);if(e==0)return i._getMessage("FD_DAY_DIFF_1").replace(/#VALUE#/g,1);else return i.format([["d","ddiff"],["m","mdiff"],["","Ydiff"]],s,_)}};var c=false;if(e[0]&&e[0]=="^"){c=true;e=e.substr(1)}var f=e.replace(D,S);if(c){f=f.replace(/\s*00:00:00\s*/g,"").replace(/(\d\d:\d\d)(:00)/g,"$1").replace(/(\s*00:00\s*)(?!:)/g,"")}if(u.length>0){u.forEach((function(e,t){f=f.replace("{{"+t+"}}",e)}))}return f;function l(e,t,r,a){var n=H((r-t)/1e3);for(var s=0;s<e.length;s++){var _=e[s][0];var o=e[s][1];var u=null;if(_=="s"){if(n<60)return i.format(o,t,r,a)}else if((u=/^s(\d+)\>?(\d+)?/.exec(_))!=null){if(u[1]&&u[2]){if(n<u[1]&&n>u[2]){return i.format(o,t,r,a)}}else if(n<u[1]){return i.format(o,t,r,a)}}else if(_=="i"){if(n<60*60)return i.format(o,t,r,a)}else if((u=/^i(\d+)\>?(\d+)?/.exec(_))!=null){if(u[1]&&u[2]){if(n<u[1]*60&&n>u[2]*60){return i.format(o,t,r,a)}}else if(n<u[1]*60){return i.format(o,t,r,a)}}else if(_=="H"){if(n<24*60*60)return i.format(o,t,r,a)}else if((u=/^H(\d+)\>?(\d+)?/.exec(_))!=null){if(u[1]&&u[2]){if(n<u[1]*60*60&&n>u[2]*60*60){return i.format(o,t,r,a)}}else if(n<u[1]*60*60){return i.format(o,t,r,a)}}else if(_=="d"){if(n<31*24*60*60)return i.format(o,t,r,a)}else if((u=/^d(\d+)\>?(\d+)?/.exec(_))!=null){if(u[1]&&u[2]){if(n<u[1]*24*60*60&&n>u[2]*24*60*60){return i.format(o,t,r,a)}}else if(n<u[1]*24*60*60){return i.format(o,t,r,a)}}else if(_=="m"){if(n<365*24*60*60)return i.format(o,t,r,a)}else if((u=/^m(\d+)\>?(\d+)?/.exec(_))!=null){if(u[1]&&u[2]){if(n<u[1]*31*24*60*60&&n>u[2]*31*24*60*60){return i.format(o,t,r,a)}}else if(n<u[1]*31*24*60*60){return i.format(o,t,r,a)}}else if(_=="now"){if(t.getTime()==r.getTime()){return i.format(o,t,r,a)}}else if(_=="today"){var D=g(r),M=O(r),c=T(r);var f=a?new Date(Date.UTC(D,M,c,0,0,0,0)):new Date(D,M,c,0,0,0,0);var l=a?new Date(Date.UTC(D,M,c+1,0,0,0,0)):new Date(D,M,c+1,0,0,0,0);if(t>=f&&t<l)return i.format(o,t,r,a)}else if(_=="todayFuture"){var D=g(r),M=O(r),c=T(r);var f=r.getTime();var l=a?new Date(Date.UTC(D,M,c+1,0,0,0,0)):new Date(D,M,c+1,0,0,0,0);if(t>=f&&t<l)return i.format(o,t,r,a)}else if(_=="yesterday"){D=g(r);M=O(r);c=T(r);var m=a?new Date(Date.UTC(D,M,c-1,0,0,0,0)):new Date(D,M,c-1,0,0,0,0);var F=a?new Date(Date.UTC(D,M,c,0,0,0,0)):new Date(D,M,c,0,0,0,0);if(t>=m&&t<F)return i.format(o,t,r,a)}else if(_=="tommorow"||_=="tomorrow"){D=g(r);M=O(r);c=T(r);var E=a?new Date(Date.UTC(D,M,c+1,0,0,0,0)):new Date(D,M,c+1,0,0,0,0);var d=a?new Date(Date.UTC(D,M,c+2,0,0,0,0)):new Date(D,M,c+2,0,0,0,0);if(t>=E&&t<d)return i.format(o,t,r,a)}else if(_=="-"){if(n<0)return i.format(o,t,r,a)}}return e.length>0?i.format(e[e.length-1][1],t,r,a):""}function g(e){return o?e.getUTCFullYear():e.getFullYear()}function T(e){return o?e.getUTCDate():e.getDate()}function O(e){return o?e.getUTCMonth():e.getMonth()}function m(e){return o?e.getUTCHours():e.getHours()}function F(e){return o?e.getUTCMinutes():e.getMinutes()}function E(e){return o?e.getUTCSeconds():e.getSeconds()}function d(e){return o?e.getUTCMilliseconds():e.getMilliseconds()}function A(e){return o?e.getUTCDay():e.getDay()}function p(e,t){return o?e.setUTCDate(t):e.setDate(t)}function h(e,t,r){return o?e.setUTCMonth(t,r):e.setMonth(t,r)}function I(e,t){var r=e<100?Math.abs(e):Math.abs(e%100);var a=r%10;var n="";if(r==0)n=i._getMessage(t["0"]);else if(r==1)n=i._getMessage(t["1"]);else if(r>=10&&r<=20)n=i._getMessage(t["10_20"]);else if(a==1)n=i._getMessage(t["MOD_1"]);else if(2<=a&&a<=4)n=i._getMessage(t["MOD_2_4"]);else n=i._getMessage(t["MOD_OTHER"]);return n.replace(/#VALUE#/g,e)}function S(e,t){if(M[e])return M[e]();else return t}function H(e){return e>=0?Math.floor(e):Math.ceil(e)}},convertBitrixFormat:function(e){if(!r.isNotEmptyString(e))return"";return e.replace("YYYY","Y").replace("MMMM","F").replace("MM","m").replace("M","M").replace("DD","d").replace("G","g").replace(/GG/i,"G").replace("H","h").replace(/HH/i,"H").replace("MI","i").replace("SS","s").replace("TT","A").replace("T","a")},convertToUTC:function(e){if(!r.isDate(e))return null;return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))},getNewDate:function(e){return new Date(this.getBrowserTimestamp(e))},getBrowserTimestamp:function(e){e=parseInt(e,10);var t=new Date(e*1e3).getTimezoneOffset()*60;return(parseInt(e,10)+parseInt(this._getMessage("SERVER_TZ_OFFSET"))+t)*1e3},getServerTimestamp:function(e){e=parseInt(e,10);var t=new Date(e).getTimezoneOffset()*60;return Math.round(e/1e3-(parseInt(this._getMessage("SERVER_TZ_OFFSET"),10)+parseInt(t,10)))},formatLastActivityDate:function(e,t,r){var a=this.isAmPmMode(true);var n=a===this.AM_PM_MODE.LOWER?"g:i a":a===this.AM_PM_MODE.UPPER?"g:i A":"H:i";var i=[["tomorrow","#01#"+n],["now","#02#"],["todayFuture","#03#"+n],["yesterday","#04#"+n],["-",this.convertBitrixFormat(this._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")],["s60","sago"],["i60","iago"],["H5","Hago"],["H24","#03#"+n],["d31","dago"],["m12>1","mago"],["m12>0","dago"],["","#05#"]];var s=this.format(i,e,t,r);var _=null;if((_=/^#(\d+)#(.*)/.exec(s))!=null){switch(_[1]){case"01":s=this._getMessage("FD_LAST_SEEN_TOMORROW").replace("#TIME#",_[2]);break;case"02":s=this._getMessage("FD_LAST_SEEN_NOW");break;case"03":s=this._getMessage("FD_LAST_SEEN_TODAY").replace("#TIME#",_[2]);break;case"04":s=this._getMessage("FD_LAST_SEEN_YESTERDAY").replace("#TIME#",_[2]);break;case"05":s=this._getMessage("FD_LAST_SEEN_MORE_YEAR");break;default:s=_[2];break}}return s},isAmPmMode:function(e){if(e===true){return this._getMessage("AMPM_MODE")}return this._getMessage("AMPM_MODE")!==false},_getMessage:function(e){return t.message(e)},parse:function(e,t,a,n){if(r.isNotEmptyString(e)){if(!a)a=this._getMessage("FORMAT_DATE");if(!n)n=this._getMessage("FORMAT_DATETIME");var i="";for(u=1;u<=12;u++){i=i+"|"+this._getMessage("MON_"+u)}var s=new RegExp("([0-9]+|[a-z]+"+i+")","ig"),_=e.match(s),o=a.match(/(DD|MI|MMMM|MM|M|YYYY)/gi),u,D,M=[],c=[],f={};if(!_){return null}if(_.length>o.length){o=n.match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/gi)}for(u=0,D=_.length;u<D;u++){if(_[u].trim()!==""){M[M.length]=_[u]}}for(u=0,D=o.length;u<D;u++){if(o[u].trim()!==""){c[c.length]=o[u]}}var l=r.array_search("MMMM",c);if(l>0){M[l]=this.getMonthIndex(M[l]);c[l]="MM"}else{l=r.array_search("M",c);if(l>0){M[l]=this.getMonthIndex(M[l]);c[l]="MM"}}for(u=0,D=c.length;u<D;u++){var g=c[u].toUpperCase();f[g]=g==="T"||g==="TT"?M[u]:parseInt(M[u],10)}if(f["DD"]>0&&f["MM"]>0&&f["YYYY"]>0){var T=new Date;if(t){T.setUTCDate(1);T.setUTCFullYear(f["YYYY"]);T.setUTCMonth(f["MM"]-1);T.setUTCDate(f["DD"]);T.setUTCHours(0,0,0,0)}else{T.setDate(1);T.setFullYear(f["YYYY"]);T.setMonth(f["MM"]-1);T.setDate(f["DD"]);T.setHours(0,0,0,0)}if((!isNaN(f["HH"])||!isNaN(f["GG"])||!isNaN(f["H"])||!isNaN(f["G"]))&&!isNaN(f["MI"])){if(!isNaN(f["H"])||!isNaN(f["G"])){var O=(f["T"]||f["TT"]||"am").toUpperCase()==="PM",m=parseInt(f["H"]||f["G"]||0,10);if(O){f["HH"]=m+(m===12?0:12)}else{f["HH"]=m<12?m:0}}else{f["HH"]=parseInt(f["HH"]||f["GG"]||0,10)}if(isNaN(f["SS"]))f["SS"]=0;if(t){T.setUTCHours(f["HH"],f["MI"],f["SS"])}else{T.setHours(f["HH"],f["MI"],f["SS"])}}return T}}return null},getMonthIndex:function(e){var t,r=e.toUpperCase(),a=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],n=["january","february","march","april","may","june","july","august","september","october","november","december"];for(t=1;t<=12;t++){if(r===this._getMessage("MON_"+t).toUpperCase()||r===this._getMessage("MONTH_"+t).toUpperCase()||r===a[t-1].toUpperCase()||r===n[t-1].toUpperCase()){return t}}return e}};var r={isDate:function(e){return e&&Object.prototype.toString.call(e)=="[object Date]"},isNumber:function(e){return e===0?true:e?typeof e=="number"||e instanceof Number:false},isArray:function(e){return e&&Object.prototype.toString.call(e)=="[object Array]"},isString:function(e){return e===""?true:e?typeof e=="string"||e instanceof String:false},isNotEmptyString:function(e){return this.isString(e)?e.length>0:false},strPadLeft:function(e,t,r){var a=e.length,n=r.length;if(a>=t)return e;for(;a<t;a+=n)e=r+e;return e},array_search:function(e,t){for(var r=0;r<t.length;r++){if(t[r]==e)return r}return-1}}})(window);let i=e=>e,s;class _{static parseTime(e){let t=_.parseDate1(BX.date.format(_.getDateFormat(),new Date)+" "+e,false);return t?{h:t.getHours(),m:t.getMinutes()}:t}static getTimeRounded(e){return Math.round(e.getTime()/6e4)*6e4}static parseDate(e,t,r,a){return BX.parseDate(e,t,r,a)}static parseDate1(e,r,a){let n,i,s,_;if(!r)r=t.Loc.getMessage("FORMAT_DATETIME");e=BX.util.trim(e);if(a!==false)r=r.replace(":SS","");if(BX.type.isNotEmptyString(e)){_="";for(n=1;n<=12;n++){_=_+"|"+t.Loc.getMessage("MON_"+n)}let a=new RegExp("([0-9]+|[a-z]+"+_+")","ig"),o=e.match(a),u=t.Loc.getMessage("FORMAT_DATE").match(/(DD|MI|MMMM|MM|M|YYYY)/gi),D=[],M=[],c={};if(!o){return null}if(o.length>u.length){u=r.match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/gi)}for(n=0,i=o.length;n<i;n++){if(BX.util.trim(o[n])!==""){D[D.length]=o[n]}}for(n=0,i=u.length;n<i;n++){if(BX.util.trim(u[n])!=""){M[M.length]=u[n]}}let f=BX.util.array_search("MMMM",M);if(f>0){D[f]=BX.getNumMonth(D[f]);M[f]="MM"}else{f=BX.util.array_search("M",M);if(f>0){D[f]=BX.getNumMonth(D[f]);M[f]="MM"}}for(n=0,i=M.length;n<i;n++){s=M[n].toUpperCase();c[s]=s=="T"||s=="TT"?D[n]:parseInt(D[n],10)}if(c["DD"]>0&&c["MM"]>0&&c["YYYY"]>0){let e=new Date;{e.setDate(1);e.setFullYear(c["YYYY"]);e.setMonth(c["MM"]-1);e.setDate(c["DD"]);e.setHours(0,0,0)}if((!isNaN(c["HH"])||!isNaN(c["GG"])||!isNaN(c["H"])||!isNaN(c["G"]))&&!isNaN(c["MI"])){if(!isNaN(c["H"])||!isNaN(c["G"])){let e=(c["T"]||c["TT"]||"am").toUpperCase()=="PM";let t=parseInt(c["H"]||c["G"]||0,10);if(e){c["HH"]=t+(t==12?0:12)}else{c["HH"]=t<12?t:0}}else{c["HH"]=parseInt(c["HH"]||c["GG"]||0,10)}if(isNaN(c["SS"]))c["SS"]=0;{e.setHours(c["HH"],c["MI"],c["SS"])}}return e}}return null}static formatTime(e,r){let a;if(t.Type.isDate(e)){a=e}else{a=new Date;a.setHours(e,r,0)}return BX.date.format(_.getTimeFormatShort(),a.getTime()/1e3)}static formatDate(e){if(t.Type.isDate(e)){e=e.getTime()}return BX.date.format(_.getDateFormat(),e/1e3)}static formatDateTime(e){if(t.Type.isDate(e)){e=e.getTime()}return BX.date.format(_.getDateTimeFormat(),e/1e3)}static formatDateUsable(e,r=true,a=false){const n=t.Loc.getMessage("LANGUAGE_ID");let i=_.getDateFormat();if(n==="ru"||n==="ua"){i=a?"l, j F":"j F";if(e.getFullYear&&e.getFullYear()!==(new Date).getFullYear()&&r!==false){i+=" Y"}}return BX.date.format([["today","today"],["tommorow","tommorow"],["yesterday","yesterday"],["",i]],e)}static getDayLength(){if(!_.DAY_LENGTH){_.DAY_LENGTH=864e5}return _.DAY_LENGTH}static getDefaultColorList(){return["#86b100","#0092cc","#00afc7","#da9100","#00b38c","#de2b24","#bd7ac9","#838fa0","#ab7917","#e97090"]}static findTargetNode(e,t){let r=false;if(e){let a="data-bx-calendar",n;if(e.attributes&&e.attributes.length){for(n=0;n<e.attributes.length;n++){if(e.attributes[n].name&&e.attributes[n].name.substr(0,a.length)===a){r=e;break}}}if(!r){r=BX.findParent(e,(function(e){let t;if(e.attributes&&e.attributes.length){for(t=0;t<e.attributes.length;t++){if(e.attributes[t].name&&e.attributes[t].name.substr(0,a.length)===a)return true}}return false}),t)}}return r}static getFollowedUserList(e){return[]}static getWeekDayByInd(e){return["SU","MO","TU","WE","TH","FR","SA"][e]}static getLoader(e,r){return t.Tag.render(s||(s=i`
		<div class="${0}">
			<svg class="calendar-loader-circular"
				style="width:${0}px; height:${0}px;"
				viewBox="25 25 50 50">
					<circle class="calendar-loader-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>
					<circle class="calendar-loader-inner-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>
			</svg>
		</div>
`),r||"calendar-loader",parseInt(e),parseInt(e))}static getDayCode(e){return e.getFullYear()+"-"+("0"+~~(e.getMonth()+1)).substr(-2,2)+"-"+("0"+~~e.getDate()).substr(-2,2)}static getTextColor(e){if(!e){return false}if(e.charAt(0)==="#"){e=e.substring(1,7)}let t=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),a=parseInt(e.substring(4,6),16),n=(t*.8+r+a*.2)/510*100;return n<50}static getKeyCode(e){if(!t.Type.isString(e)){return false}let r={backspace:8,enter:13,escape:27,space:32,delete:46,left:37,right:39,up:38,down:40,z:90,y:89,shift:16,ctrl:17,alt:18,cmd:91,cmdRight:93,pageUp:33,pageDown:34,d:68,w:87,m:77,a:65};return r[e.toLowerCase()]}static getUsableDateTime(e,r){if(t.Type.isDate(e)){e=e.getTime()}let a=(r||10)*60*1e3;e=Math.ceil(e/a)*a;return new Date(e)}static showNotification(e,r=null){if(t.Type.isString(e)&&e!==""){BX.UI.Notification.Center.notify({content:e,actions:r})}}static showFieldError(e,r,a){if(t.Type.isDomNode(r)&&t.Type.isString(e)&&e!==""){t.Dom.remove(r.querySelector(".ui-alert"));let a=new BX.UI.Alert({color:BX.UI.Alert.Color.DANGER,icon:BX.UI.Alert.Icon.DANGER,text:e});let n=a.getContainer();r.appendChild(n)}}static getDateFormat(){if(!_.DATE_FORMAT){_.DATE_FORMAT=BX.Main.Date.convertBitrixFormat(t.Loc.getMessage("FORMAT_DATE"))}return _.DATE_FORMAT}static setDayOfWeekMonthFormat(e){_.dayOfWeekMonthFormat=e}static getDayOfWeekMonthFormat(){return _.dayOfWeekMonthFormat||"l, j F"}static setDayMonthFormat(e){_.dayMonthFormat=e}static getDayMonthFormat(){return _.dayMonthFormat||"j F"}static getDateTimeFormat(){if(!_.DATETIME_FORMAT){_.DATETIME_FORMAT=BX.Main.Date.convertBitrixFormat(t.Loc.getMessage("FORMAT_DATETIME"))}return _.DATETIME_FORMAT}static getTimeFormat(){if(!_.TIME_FORMAT){if(t.Loc.getMessage("FORMAT_DATETIME").substr(0,t.Loc.getMessage("FORMAT_DATE").length)===t.Loc.getMessage("FORMAT_DATE")){_.TIME_FORMAT=BX.util.trim(_.getDateTimeFormat().substr(_.getDateFormat().length));_.TIME_FORMAT_BX=BX.util.trim(t.Loc.getMessage("FORMAT_DATETIME").substr(t.Loc.getMessage("FORMAT_DATE").length))}else{_.TIME_FORMAT_BX=BX.isAmPmMode()?"H:MI:SS T":"HH:MI:SS";_.TIME_FORMAT=BX.date.convertBitrixFormat(BX.isAmPmMode()?"H:MI:SS T":"HH:MI:SS")}}return _.TIME_FORMAT}static getTimeFormatShort(){if(!_.TIME_FORMAT_SHORT){_.TIME_FORMAT_SHORT=_.getTimeFormat().replace(":s","");_.TIME_FORMAT_SHORT_BX=_.TIME_FORMAT_BX.replace(":SS","")}return _.TIME_FORMAT_SHORT}static getCurrentUserId(){if(!_.currentUserId){_.currentUserId=parseInt(t.Loc.getMessage("USER_ID"))}return _.currentUserId}static getTimeByInt(e){e=parseInt(e);let t=Math.floor(e/60);return{hour:t,min:e-t*60}}static preventSelection(e){e.ondrag=BX.False;e.ondragstart=BX.False;e.onselectstart=BX.False}static getBX(){return window.top.BX||window.BX}static closeAllPopups(){if(a.PopupManager.isAnyPopupShown()){for(let e=0,t=a.PopupManager._popups.length;e<t;e++){if(a.PopupManager._popups[e]&&a.PopupManager._popups[e].isShown()){a.PopupManager._popups[e].close()}}}}static sendAnalyticLabel(e){BX.ajax.runAction("calendar.api.calendarajax.sendAnalyticsLabel",{analyticsLabel:e})}static setOptions(e,t){_.config=e;_.additionalParams=t}static setUserSettings(e){_.userSettings=e}static getUserSettings(){return t.Type.isObjectLike(_.userSettings)?_.userSettings:{}}static setCalendarContext(e){_.calendarContext=e}static getCalendarContext(){return _.calendarContext||null}static getMeetingStatusList(){return["Y","N","Q","H"]}static checkEmailLimitationPopup(){const e=_.getEventWithEmailGuestAmount();const t=_.getEventWithEmailGuestLimit();return t>0&&(e===8||e===4||e>=t)}static isEventWithEmailGuestAllowed(){return _.getEventWithEmailGuestLimit()===-1||_.getEventWithEmailGuestAmount()<_.getEventWithEmailGuestLimit()}static setEventWithEmailGuestAmount(e){_.countEventWithEmailGuestAmount=e}static setEventWithEmailGuestLimit(e){_.eventWithEmailGuestLimit=e}static getEventWithEmailGuestAmount(){return _.countEventWithEmailGuestAmount}static getEventWithEmailGuestLimit(){return _.eventWithEmailGuestLimit}static setCurrentView(e=null){_.currentCalendarView=e}static getCurrentView(){return _.currentCalendarView||null}static adjustDateForTimezoneOffset(e,r=0,a=false){if(!t.Type.isDate(e))throw new Error("Wrong type for date attribute. DateTime object expected.");if(!parseInt(r)||a===true)return e;return new Date(e.getTime()-parseInt(r)*1e3)}static randomInt(e,t){return Math.round(e-.5+Math.random()*(t-e+1))}static getRandomColor(){const e=_.getDefaultColorList();return e[_.randomInt(0,e.length-1)]}static setAccessNames(e={}){_.accessNames={};for(let t in e){if(e.hasOwnProperty(t)){_.setAccessName(t,e[t])}}}static getAccessName(e){return _.accessNames[e]||e}static setAccessName(e,t){_.accessNames[e]=t}static getRandomInt(e=6){return Math.round(Math.random()*Math.pow(10,e))}static displayError(e,r){if(t.Type.isArray(e)){let t="";for(let r=0;r<e.length;r++){t+=e[r].message+"\n"}e=t}setTimeout((()=>{alert(e||"[Bitrix Calendar] Request error");if(r){location.reload()}}),200)}static convertEntityToAccessCode(e){if(t.Type.isObjectLike(e)){if(e.entityId==="meta-user"&&e.id==="all-users"){return"UA"}else if(e.entityId==="user"){return"U"+e.id}else if(e.entityId==="project"){return"SG"+e.id+"_K"}else if(e.entityId==="department"){return"DR"+e.id}else if(e.entityId==="group"){return e.id}}}static extendPlannerWatches({entries:e,userId:t}){e.forEach((e=>{if(e.type==="user"&&parseInt(e.id)!==parseInt(t)){const t=_.PLANNER_PULL_TAG.replace("#USER_ID#",e.id);if(!_.PLANNER_WATCH_LIST.includes(t)){n.PULL.extendWatch(t);_.PLANNER_WATCH_LIST.push(t)}}}))}static clearPlannerWatches(){_.PLANNER_WATCH_LIST.forEach((e=>{n.PULL.clearWatch(e)}));_.PLANNER_WATCH_LIST=[]}static registerRequestId(){const e=BX.Calendar.Util.getRandomInt(8);_.REQUEST_ID_LIST.push(e);return e}static unregisterRequestId(e){_.REQUEST_ID_LIST=_.REQUEST_ID_LIST.filter((t=>t!==e))}static checkRequestId(e){e=parseInt(e);return!t.Type.isInteger(e)||!_.REQUEST_ID_LIST.includes(e)}static initHintNode(e){var r;const a=_.getBX();if(t.Type.isElementNode(e)&&a!=null&&(r=a.UI)!=null&&r.Hint){var n,i;if(a!=null&&(n=a.UI)!=null&&(i=n.Hint)!=null&&i.popup){a.UI.Hint.popup.destroy();a.UI.Hint.popup=null;a.UI.Hint.content=null}a.UI.Hint.initNode(e)}}static documentIsDisplayingNow(){return!document.hidden}static removeHash(){if("pushState"in history){history.pushState("",document.title,window.location.pathname+window.location.search)}else{let e=document.body.scrollTop;let t=document.body.scrollLeft;window.location.hash="";document.body.scrollTop=e;document.body.scrollLeft=t}}static setIphoneConnectionStatus(e){_.iphoneConnectionStatus=e}static isIphoneConnected(){return _.iphoneConnectionStatus}static setMacConnectionStatus(e){_.macConnectionStatus=e}static isMacConnected(){return _.macConnectionStatus}}_.PLANNER_PULL_TAG="calendar-planner-#USER_ID#";_.PLANNER_WATCH_LIST=[];_.REQUEST_ID_LIST=[];_.accessNames={};e.Util=_})(this.BX.Calendar=this.BX.Calendar||{},BX,BX,BX.Main,BX);
//# sourceMappingURL=util.bundle.map.js