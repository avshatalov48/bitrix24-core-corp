{"version":3,"file":"resourcebookinguserfield.bundle.js","sources":["../src/formfieldtunnerabstract.js","../src/formfieldtunnerpopupabstract.js","../src/formfieldtunnervaluepopupabstract.js","../src/controls/userselectorfieldeditcontrol.js","../src/controls/userselectorfieldtunner.js","../src/controls/resourceselectorfieldtunner.js","../src/controls/serviceselectorfieldtunner.js","../src/controls/durationselectorfieldtunner.js","../src/controls/dateselectorfieldtunner.js","../src/controls/timeselectorfieldtunner.js","../src/adjustfieldcontroller.js","../src/controls/resourceselectorfieldeditcontrol.js","../src/controls/plannerpopup.js","../src/editfieldcontroller.js","../src/controls/serviceselector.js","../src/controls/timezoneselector.js","../src/controls/modeselector.js","../src/customizecrmentityeditor.js","../src/calendarviewsettingsslider.js","../src/adminsettingsviewer.js","../src/resourcebookinguserfield.js"],"sourcesContent":["import {Dom, Type} from \"calendar.resourcebooking\";\n\nexport class FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tthis.label = '';\n\t\tthis.formLabel = '';\n\t\tthis.displayed = false;\n\t\tthis.valuePopup = null;\n\t\tthis.statePopup = null;\n\t\tthis.displayCheckboxDisabled = false;\n\t\tthis.DOM = {};\n\t}\n\n\tbuild(params)\n\t{\n\t\tthis.updateConfig(params.params);\n\n\t\tthis.DOM.fieldWrap = Dom.create(\"div\", {props: {className: 'calendar-resbook-webform-settings-popup-item'}});\n\n\t\tthis.DOM.labelWrap = this.DOM.fieldWrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field'}\n\t\t}));\n\t\tthis.DOM.labelNode = this.DOM.labelWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field-title'}, text: this.getLabel()\n\t\t}));\n\n\t\t// Label in form\n\t\tthis.DOM.formTitleWrap = this.DOM.labelWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {\n\t\t\t\tclassName: 'calendar-resbook-webform-settings-popup-field-subtitle' + (this.isDisplayed() ? ' show' : '')\n\t\t\t}\n\t\t}));\n\t\tthis.DOM.formTitleLabel = this.DOM.formTitleWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field-subtitle-text'},\n\t\t\ttext: this.getFormLabel(),\n\t\t\tevents: {click: this.enableFormTitleEditMode.bind(this)}\n\t\t}));\n\t\tthis.DOM.formTitleEditIcon = this.DOM.formTitleWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field-edit'},\n\t\t\tevents: {click: this.enableFormTitleEditMode.bind(this)}\n\t\t}));\n\n\t\t// Display checkbox\n\t\tthis.DOM.checkboxNode = this.DOM.fieldWrap.appendChild(Dom.create(\"div\", {props: {className: 'calendar-resbook-webform-settings-popup-checkbox-container'}})).appendChild(Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"checkbox\", value: 'Y', checked: this.isDisplayed(), disabled: this.displayCheckboxDisabled\n\t\t\t}, events: {\n\t\t\t\tclick: this.checkDisplayMode.bind(this)\n\t\t\t}\n\t\t}));\n\n\t\t// State popup\n\t\tthis.buildStatePopup({\n\t\t\twrap: this.DOM.fieldWrap, config: params.config || {}\n\t\t});\n\n\t\t// Value popup\n\t\tthis.buildValuePopup({\n\t\t\twrap: this.DOM.fieldWrap, config: params.config || {}\n\t\t});\n\n\t\tif (Type.isFunction(params.changeSettingsCallback))\n\t\t{\n\t\t\tthis.changeSettingsCallback = params.changeSettingsCallback;\n\t\t}\n\n\t\tparams.wrap.appendChild(this.DOM.fieldWrap);\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.valuePopup && Type.isFunction(this.valuePopup.closePopup))\n\t\t{\n\t\t\tthis.valuePopup.closePopup();\n\t\t}\n\t\tif (this.statePopup && Type.isFunction(this.statePopup.closePopup))\n\t\t{\n\t\t\tthis.statePopup.closePopup();\n\t\t}\n\t}\n\n\tupdateConfig(params = {})\n\t{\n\t\tthis.setFormLabel(params.label || this.formLabel);\n\t\tif (params.show)\n\t\t{\n\t\t\tthis.displayed = params.show !== 'N';\n\t\t}\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t}\n\n\tbuildValuePopup(params)\n\t{\n\t}\n\n\tgetLabel()\n\t{\n\t\treturn this.label;\n\t}\n\n\tgetFormLabel()\n\t{\n\t\treturn this.formLabel;\n\t}\n\n\tsetFormLabel(formLabel)\n\t{\n\t\tthis.formLabel = formLabel || '';\n\t}\n\n\tisDisplayed()\n\t{\n\t\treturn this.displayed;\n\t}\n\n\tcheckDisplayMode()\n\t{\n\t\tthis.displayed = !!this.DOM.checkboxNode.checked;\n\t\tif (this.displayed)\n\t\t{\n\t\t\tthis.displayInForm();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideInForm();\n\t\t}\n\t}\n\n\tdisplayInForm()\n\t{\n\t\tDom.addClass(this.DOM.formTitleWrap, 'show');\n\t\tthis.triggerChangeRefresh();\n\t}\n\n\thideInForm ()\n\t{\n\t\tDom.removeClass(this.DOM.formTitleWrap, 'show');\n\t\tthis.triggerChangeRefresh();\n\t}\n\n\tenableFormTitleEditMode()\n\t{\n\t\tif (!this.DOM.formTitleInputNode)\n\t\t{\n\t\t\tthis.DOM.formTitleInputNode = this.DOM.formTitleWrap.appendChild(Dom.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tclassName: 'calendar-resbook-webform-settings-popup-field-subtitle-text'\n\t\t\t\t},\n\t\t\t\tevents: {blur: this.finishFormTitleEditMode.bind(this)}\n\t\t\t}));\n\t\t}\n\n\t\tthis.DOM.formTitleInputNode.value = this.getFormLabel();\n\t\tthis.DOM.formTitleInputNode.style.display = '';\n\t\tthis.DOM.formTitleLabel.style.display = 'none';\n\t\tthis.DOM.formTitleEditIcon.style.display = 'none';\n\t\tthis.DOM.formTitleInputNode.focus();\n\t}\n\n\tfinishFormTitleEditMode()\n\t{\n\t\tthis.setFormLabel(this.DOM.formTitleInputNode.value);\n\t\tDom.adjust(this.DOM.formTitleLabel, {text: this.getFormLabel()});\n\t\tthis.DOM.formTitleLabel.style.display = '';\n\t\tthis.DOM.formTitleEditIcon.style.display = '';\n\t\tthis.DOM.formTitleInputNode.style.display = 'none';\n\t\tthis.triggerChangeRefresh();\n\t}\n\n\tgetSettingsValue()\n\t{\n\n\t}\n\n\ttriggerChangeRefresh()\n\t{\n\t\tsetTimeout(function(){BX.onCustomEvent('ResourceBooking.webformSettings:onChanged');}.bind(this), 50);\n\t}\n}\n\n\n\n\n","import {Dom, Event} from \"main.core\";\n\nexport class FormFieldTunnerPopupAbstract {\n\tconstructor(params)\n\t{\n\t\tthis.id = 'resourcebooking-settings-popup-' + Math.round(Math.random() * 100000);\n\t\tthis.menuItems = [];\n\t\tthis.DOM = {\n\t\t\touterWrap: params.wrap\n\t\t};\n\t\tthis.handleClickFunc = this.handleClick.bind(this);\n\t}\n\n\tbuild()\n\t{\n\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props:{className:'calendar-resbook-webform-settings-popup-select'}}));\n\n\t\tthis.DOM.currentStateLink = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create(\"span\",\n\t\t\t\t{\n\t\t\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-select-value'},\n\t\t\t\t\ttext: this.getCurrentModeState(),\n\t\t\t\t\tevents: {click: this.showPopup.bind(this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.isPopupShown() || this.disabled)\n\t\t{\n\t\t\treturn this.closePopup();\n\t\t}\n\n\t\tthis.menuItems = this.getMenuItems();\n\n\t\tEvent.unbind(document, 'click', this.handleClickFunc);\n\t\tthis.popup = BX.PopupMenu.create(\n\t\t\tthis.id,\n\t\t\tthis.DOM.currentStateLink,\n\t\t\tthis.menuItems,\n\t\t\t{\n\t\t\t\tclassName: 'popup-window-resource-select',\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : false,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.popupWindow.setAngle({offset: 30, position: 'top'});\n\t\tthis.popup.show(true);\n\t\tthis.popupContainer = this.popup.popupWindow.popupContainer;\n\n\t\t//this.popupContainer.style.width = parseInt(this.DOM.blocksWrap.offsetWidth) + 'px';\n\n\t\t// BX.addCustomEvent(this.popup.popupWindow, 'onPopupClose', function()\n\t\t// {\n\t\t// \tBX.PopupMenu.destroy(this.id);\n\t\t// \tthis.popup = null;\n\t\t// }.bind(this));\n\n\t\tthis.popup.menuItems.forEach(function(menuItem)\n\t\t{\n\t\t\tlet inputType = false, className, checked, inputNameStr = '';\n\t\t\tif (menuItem.dataset && menuItem.dataset.type)\n\t\t\t{\n\t\t\t\tchecked = menuItem.dataset.checked;\n\n\t\t\t\tlet menuItemClassName = 'menu-popup-item';\n\t\t\t\tif (menuItem.dataset.type === 'radio')\n\t\t\t\t{\n\t\t\t\t\tinputType = 'radio';\n\t\t\t\t\tclassName = 'menu-popup-item-resource-radio';\n\t\t\t\t\tif (menuItem.dataset.inputName)\n\t\t\t\t\t{\n\t\t\t\t\t\tinputNameStr = ' name=\"' + menuItem.dataset.inputName + '\" ';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (menuItem.dataset.type === 'checkbox')\n\t\t\t\t{\n\t\t\t\t\tinputType = 'checkbox';\n\t\t\t\t\tclassName = 'menu-popup-item-resource-checkbox';\n\t\t\t\t}\n\n\t\t\t\tlet innerHtml = '<div class=\"menu-popup-item-inner\">';\n\t\t\t\tif (menuItem.dataset.type === 'submenu-list')\n\t\t\t\t{\n\t\t\t\t\tmenuItemClassName += ' menu-popup-item-submenu';\n\t\t\t\t\tinnerHtml += '<div class=\"menu-popup-item-resource menu-popup-item-resource-wide\">' +\n\t\t\t\t\t\t'<span class=\"menu-popup-item-text\">' +\n\t\t\t\t\t\t'<span>' + menuItem.text + '</span>' +\n\t\t\t\t\t\t'<span class=\"menu-popup-item-resource-subvalue\">' + (menuItem.dataset.textValue || menuItem.dataset.value) + '</span>' +\n\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t}\n\t\t\t\telse if (inputType)\n\t\t\t\t{\n\t\t\t\t\tinnerHtml += '<div class=\"menu-popup-item-resource\">';\n\t\t\t\t\tif (inputType)\n\t\t\t\t\t{\n\t\t\t\t\t\tinnerHtml += '<input class=\"' + className + '\" type=\"' + inputType + '\"' + (checked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\" ' + inputNameStr + '>' +\n\t\t\t\t\t\t\t'<label class=\"menu-popup-item-text\"  for=\"' + menuItem.id + '\">' + menuItem.text + '</label>';\n\t\t\t\t\t}\n\t\t\t\t\tinnerHtml += '</div>';\n\t\t\t\t}\n\n\t\t\t\tinnerHtml += '</div>';\n\n\t\t\t\tmenuItem.layout.item.className = menuItemClassName;\n\t\t\t\tmenuItem.layout.item.innerHTML = innerHtml;\n\t\t\t}\n\t\t}, this);\n\n\t\tsetTimeout(()=>{Event.bind(document, 'click', this.handleClickFunc);}, 50);\n\t}\n\n\tclosePopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t\tthis.popupContainer.style.maxHeight = '';\n\t\t}\n\t}\n\n\tisPopupShown()\n\t{\n\t\treturn this.popup && this.popup.popupWindow &&\n\t\t\tthis.popup.popupWindow.isShown && this.popup.popupWindow.isShown() &&\n\t\t\tthis.popup.popupWindow.popupContainer &&\n\t\t\tBX.isNodeInDom(this.popup.popupWindow.popupContainer)\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn '';\n\t}\n\n\tgetMenuItems()\n\t{\n\t\treturn [];\n\t}\n\n\tgetPopupContent()\n\t{\n\t\tthis.DOM.innerWrap = Dom.create(\"div\", {props : {className : ''}});\n\t\treturn this.DOM.innerWrap;\n\t}\n\n\thandlePopupClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (target.hasAttribute('data-bx-resbook-control-node') ||\n\t\t\tBX.findParent(target, {attribute: 'data-bx-resbook-control-node'}, this.DOM.innerWrap)\n\t\t)\n\t\t{\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tif (this.changesTimeout)\n\t\t{\n\t\t\tthis.changesTimeout = clearTimeout(this.changesTimeout);\n\t\t}\n\t\tthis.changesTimeout = setTimeout(BX.delegate(function(){BX.onCustomEvent('ResourceBooking.webformSettings:onChanged');}, this), 50);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (this.isPopupShown() && !BX.isParentForNode(this.popupContainer, target))\n\t\t{\n\t\t\treturn this.closePopup({animation: true});\n\t\t}\n\t}\n\n\tsetDisabled()\n\t{\n\t\tthis.disabled = true;\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.closePopup();\n\t\t}\n\t\tDom.addClass(this.DOM.innerWrap, 'disabled');\n\t}\n\n\tsetEnabled()\n\t{\n\t\tthis.disabled = false;\n\t\tDom.removeClass(this.DOM.innerWrap, 'disabled');\n\t}\n}","import {BookingUtil, Dom} from \"calendar.resourcebooking\";\n\nexport class FormFieldTunnerValuePopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tthis.id = 'resourcebooking-settings-value-popup-' + Math.round(Math.random() * 100000);\n\t\tthis.selectedValues = [];\n\t\tthis.DOM = {\n\t\t\touterWrap: params.wrap\n\t\t};\n\t}\n\n\tbuild()\n\t{\n\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: {className: 'calendar-resbook-webform-settings-popup-select-result'}}));\n\n\t\tthis.DOM.valueLink = this.DOM.innerWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-select-value'},\n\t\t\ttext: this.getCurrentValueState(),\n\t\t\tevents: {\n\t\t\t\tclick: this.showPopup.bind(this),\n\t\t\t\tmouseover: this.showHoverPopup.bind(this),\n\t\t\t\tmouseout: this.hideHoverPopup.bind(this)\n\t\t\t}\n\t\t}));\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.popup && this.popup.isShown())\n\t\t{\n\t\t\treturn this.popup.close();\n\t\t}\n\n\t\tthis.popup = new BX.PopupWindow(\n\t\t\tthis.id,\n\t\t\tthis.DOM.valueLink,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\twidth: this.getPopupWidth(),\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: this.getPopupContent()\n\t\t\t});\n\t\tthis.popup.setAngle({offset: 60, position: 'top'});\n\t\tthis.popup.show(true);\n\n\t\tBX.unbind(this.DOM.innerWrap, 'click', BX.proxy(this.handlePopupClick, this));\n\t\tBX.bind(this.DOM.innerWrap, 'click', BX.proxy(this.handlePopupClick, this));\n\n\t\tBX.addCustomEvent(this.popup, 'onPopupClose', BX.delegate(function ()\n\t\t{\n\t\t\tthis.handlePopupCloose();\n\t\t\tthis.popup.destroy(this.id);\n\t\t\tthis.popup = null;\n\t\t}, this));\n\t}\n\n\tclosePopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\t}\n\n\tisPopupShown()\n\t{\n\t\treturn this.popup && this.popup.popupWindow &&\n\t\t\tthis.popup.popupWindow.isShown && this.popup.popupWindow.isShown() &&\n\t\t\tthis.popup.popupWindow.popupContainer &&\n\t\t\tBX.isNodeInDom(this.popup.popupWindow.popupContainer)\n\t}\n\n\tshowHoverPopup()\n\t{\n\t}\n\n\thideHoverPopup()\n\t{\n\t}\n\n\thandlePopupCloose()\n\t{\n\t}\n\n\tgetCurrentValueState()\n\t{\n\t\treturn BX.message('WEBF_RES_NO_VALUE');\n\t}\n\n\tgetPopupContent()\n\t{\n\t\tthis.DOM.innerWrap = Dom.create(\"div\", {props: {className: ''}});\n\n\t\tthis.DOM.innerWrap.style.minWidth = '500px';\n\t\tthis.DOM.innerWrap.style.minHeight = '30px';\n\t\treturn this.DOM.innerWrap;\n\t}\n\n\tgetPopupWidth()\n\t{\n\t\treturn null;\n\t}\n\n\thandlePopupClick(e)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (target.hasAttribute('data-bx-resbook-control-node') || BX.findParent(target, {attribute: 'data-bx-resbook-control-node'}, this.DOM.innerWrap))\n\t\t{\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsetTimeout(BX.delegate(function(){BX.onCustomEvent('ResourceBooking.webformSettings:onChanged');}, this), 50);\n\t}\n\n\tshowPopupLoader()\n\t{\n\t\tif (this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.hidePopupLoader();\n\t\t\tthis.DOM.popupLoader = this.DOM.innerWrap.appendChild(BookingUtil.getLoader(50));\n\t\t}\n\t}\n\n\thidePopupLoader()\n\t{\n\t\tDom.remove(this.DOM.popupLoader);\n\t}\n}\n\n\texport class FormFieldTunnerMultipleChecknoxPopupAbstract extends FormFieldTunnerValuePopupAbstract{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.id = 'resourcebooking-settings-multiple-checknox-' + Math.round(Math.random() * 100000);\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\treturn this.closePopup();\n\t\t}\n\n\t\tvar menuItems = [];\n\n\t\tthis.values.forEach(function(item)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\tid: item.id,\n\t\t\t\ttext: BX.util.htmlspecialchars(item.title),\n\t\t\t\tdataset: item.dataset,\n\t\t\t\tonclick: BX.proxy(this.menuItemClick, this)\n\t\t\t});\n\t\t}, this);\n\n\t\tif (menuItems.length > 1)\n\t\t{\n\t\t\tthis.selectAllMessage = this.selectAllMessage || 'select all';\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this.selectAllMessage,\n\t\t\t\tonclick: BX.proxy(this.selectAllItemClick, this)\n\t\t\t});\n\t\t}\n\n\t\tthis.popup = BX.PopupMenu.create(\n\t\t\tthis.id,\n\t\t\tthis.DOM.valueLink,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tclassName: 'popup-window-resource-select',\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : false,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.popupWindow.setAngle({offset: 60, position: 'top'});\n\t\tthis.popup.show(true);\n\t\tthis.popupContainer = this.popup.popupWindow.popupContainer;\n\n\t\tBX.addCustomEvent(this.popup.popupWindow, 'onPopupClose', BX.proxy(function()\n\t\t{\n\t\t\tthis.handlePopupCloose();\n\t\t\tBX.PopupMenu.destroy(this.id);\n\t\t\tthis.popup = null;\n\t\t}, this));\n\n\t\tthis.popup.menuItems.forEach(function(menuItem)\n\t\t{\n\t\t\tvar checked;\n\t\t\tif (menuItem.dataset && menuItem.dataset.id)\n\t\t\t{\n\t\t\t\tchecked = this.selectedValues.find(function(itemId){return itemId === menuItem.id});\n\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox\" type=\"checkbox\"' + (checked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + menuItem.text + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selectAllChecked = !this.values.find(function(value){\n\t\t\t\t\treturn !this.selectedValues.find(function(itemId){return itemId === value.id});\n\t\t\t\t},this);\n\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item menu-popup-item-resource-all';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox menu-popup-item-all-resources-checkbox\" type=\"checkbox\"' + (this.selectAllChecked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + menuItem.text + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t}, this);\n\n\t\tsetTimeout(BX.delegate(function(){\n\t\t\tBX.bind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}, this), 50);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tvar\n\t\t\tselectAllcheckbox,\n\t\t\ttarget = e.target || e.srcElement,\n\t\t\tcheckbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox'),\n\t\t\tfoundValue = this.values.find(function(value){return value.id === menuItem.id;});\n\n\t\tif (foundValue)\n\t\t{\n\t\t\tif (target && (Dom.hasClass(target, \"menu-popup-item\") || Dom.hasClass(target, \"menu-popup-item-resource-checkbox\") || Dom.hasClass(target, \"menu-popup-item-inner\") ))\n\t\t\t{\n\t\t\t\tif (!Dom.hasClass(target, \"menu-popup-item-resource-checkbox\"))\n\t\t\t\t{\n\t\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t\t}\n\n\t\t\t\tif (checkbox.checked)\n\t\t\t\t{\n\t\t\t\t\tthis.selectItem(foundValue);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.deselectItem(foundValue);\n\t\t\t\t\tselectAllcheckbox = this.popupContainer.querySelector('.menu-popup-item-all-resources-checkbox');\n\t\t\t\t\tthis.selectAllChecked = false;\n\t\t\t\t\tif (selectAllcheckbox)\n\t\t\t\t\t{\n\t\t\t\t\t\tselectAllcheckbox.checked = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\tselectItem(value)\n\t{\n\t\tif (!BX.util.in_array(value.id, this.selectedValues))\n\t\t{\n\t\t\tthis.selectedValues.push(value.id);\n\t\t}\n\t}\n\tdeselectItem(value)\n\t{\n\t\tvar index = BX.util.array_search(value.id, this.selectedValues);\n\t\tif (index >= 0)\n\t\t{\n\t\t\tthis.selectedValues = BX.util.deleteFromArray(this.selectedValues, index);\n\t\t}\n\t}\n\n\tselectAllItemClick(e, menuItem)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (target && (Dom.hasClass(target, \"menu-popup-item\") || Dom.hasClass(target, \"menu-popup-item-resource-checkbox\")))\n\t\t{\n\t\t\tvar checkbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox');\n\n\t\t\tif (Dom.hasClass(target, \"menu-popup-item\"))\n\t\t\t{\n\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t}\n\n\t\t\tvar i, checkboxes = this.popupContainer.querySelectorAll('input.menu-popup-item-resource-checkbox');\n\t\t\tthis.selectAllChecked = checkbox.checked;\n\n\t\t\tfor (i = 0; i < checkboxes.length; i++)\n\t\t\t{\n\t\t\t\tcheckboxes[i].checked = this.selectAllChecked;\n\t\t\t}\n\t\t\tthis.selectedValues = [];\n\t\t\tif (this.selectAllChecked)\n\t\t\t{\n\t\t\t\tthis.values.forEach(function(value){this.selectedValues.push(value.id);}, this);\n\t\t\t}\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\thandleClick(e)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (this.isPopupShown() && !BX.isParentForNode(this.popupContainer, target))\n\t\t{\n\t\t\tthis.closePopup({animation: true});\n\t\t}\n\n\t\tthis.handleControlChanges();\n\t}\n\n\tclosePopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t\tthis.popupContainer.style.maxHeight = '';\n\t\t\tBX.unbind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\treturn this.selectedValues;\n\t}\n}","import {BookingUtil} from \"calendar.resourcebooking\";\n\nexport class UserSelectorFieldEditControl\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params || {};\n\t\tthis.id = this.params.id || 'user-selector-' + Math.round(Math.random() * 100000);\n\t\tthis.wrapNode = this.params.wrapNode;\n\t\tthis.zIndex = this.params.zIndex || 3100;\n\t\tthis.destinationInputName = this.params.inputName || 'EVENT_DESTINATION';\n\t\tthis.params.selectGroups = false;\n\t\tthis.addMessage = this.params.addMessage || BX.message('USER_TYPE_RESOURCE_ADD_USER');\n\t\tthis.checkLimit = BX.type.isFunction(params.checkLimitCallback) ? params.checkLimitCallback : false;\n\n\t\tif (BX.type.isArray(this.params.itemsSelected))\n\t\t{\n\t\t\tthis.params.itemsSelected = this.convertAttendeesCodes(this.params.itemsSelected);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.params.itemsSelected = this.getSocnetDestinationConfig('itemsSelected');\n\t\t}\n\n\t\tthis.DOM = {\n\t\t\touterWrap: this.params.outerWrap,\n\t\t\twrapNode: this.params.wrapNode\n\t\t};\n\n\t\tthis.create();\n\t}\n\n\tcreate ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\tBX.addClass(this.DOM.outerWrap, 'calendar-resourcebook-folding-block' + (this.params.shown !== false ? ' shown' : ''));\n\t\t}\n\n\t\tlet id = this.id;\n\n\t\tBX.bind(this.wrapNode, 'click', BX.delegate(function (e)\n\t\t{\n\t\t\tlet target = e.target || e.srcElement;\n\t\t\tif (target.className === 'calendar-resourcebook-content-block-control-delete') // Delete button\n\t\t\t{\n\t\t\t\tBX.SocNetLogDestination.deleteItem(target.getAttribute('data-item-id'), target.getAttribute('data-item-type'), id);\n\t\t\t\tlet block = BX.findParent(target, {className: 'calendar-resourcebook-content-block-control-inner'});\n\t\t\t\tif (block && BX.hasClass(block, 'shown'))\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(block, 'shown');\n\t\t\t\t\tsetTimeout(function(){BX.remove(block);}, 300);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.SocNetLogDestination.openDialog(id);\n\t\t\t}\n\t\t}, this));\n\n\t\tthis.socnetDestinationInputWrap = this.wrapNode.appendChild(BX.create('SPAN', {props: {className: 'calendar-resourcebook-destination-input-box'}}));\n\t\tthis.socnetDestinationInput = this.socnetDestinationInputWrap.appendChild(BX.create('INPUT', {\n\t\t\tprops: {\n\t\t\t\tid: id + '-inp',\n\t\t\t\tclassName: 'calendar-resourcebook-destination-input'\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\tvalue: '',\n\t\t\t\ttype: 'text'\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tkeydown: function (e)\n\t\t\t\t{\n\t\t\t\t\treturn BX.SocNetLogDestination.searchBeforeHandler(e, {\n\t\t\t\t\t\tformName: id, inputId: id + '-inp'\n\t\t\t\t\t});\n\t\t\t\t}, keyup: function (e)\n\t\t\t\t{\n\t\t\t\t\treturn BX.SocNetLogDestination.searchHandler(e, {\n\t\t\t\t\t\tformName: id,\n\t\t\t\t\t\tinputId: id + '-inp',\n\t\t\t\t\t\tlinkId: 'event-grid-dest-add-link',\n\t\t\t\t\t\tsendAjax: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis.socnetDestinationLink = this.wrapNode.appendChild(BX.create('DIV', {\n\t\t\tprops: {className: 'calendar-resourcebook-content-block-control-text calendar-resourcebook-content-block-control-text-add'},\n\t\t\ttext: this.addMessage\n\t\t}));\n\n\t\tthis.init();\n\t}\n\n\tshow ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\tBX.addClass(this.DOM.outerWrap, 'shown');\n\t\t}\n\t}\n\n\thide ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\tBX.removeClass(this.DOM.outerWrap, 'shown');\n\t\t}\n\t}\n\n\tisShown ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\treturn BX.hasClass(this.DOM.outerWrap, 'shown');\n\t\t}\n\t}\n\n\tinit ()\n\t{\n\t\tif (!this.socnetDestinationInput || !this.wrapNode)\n\t\t\treturn;\n\n\t\tlet _this = this;\n\n\t\tthis.params.items = this.getSocnetDestinationConfig('items');\n\t\tthis.params.itemsLast = this.getSocnetDestinationConfig('itemsLast');\n\n\t\tif (this.params.selectGroups === false)\n\t\t{\n\t\t\tthis.params.items.groups = {};\n\t\t\tthis.params.items.department = {};\n\t\t\tthis.params.items.sonetgroups = {};\n\t\t}\n\n\t\tBX.SocNetLogDestination.init({\n\t\t\tname: this.id,\n\t\t\tsearchInput: this.socnetDestinationInput,\n\t\t\textranetUser: false,\n\t\t\tuserSearchArea: 'I',\n\t\t\tbindMainPopup: {\n\t\t\t\tnode: this.wrapNode, offsetTop: '5px', offsetLeft: '15px'\n\t\t\t},\n\t\t\tbindSearchPopup: {\n\t\t\t\tnode: this.wrapNode, offsetTop: '5px', offsetLeft: '15px'\n\t\t\t},\n\t\t\tcallback: {\n\t\t\t\tselect: BX.proxy(this.selectCallback, this),\n\t\t\t\tunSelect: BX.proxy(this.unSelectCallback, this),\n\t\t\t\topenDialog: BX.proxy(this.openDialogCallback, this),\n\t\t\t\tcloseDialog: BX.proxy(this.closeDialogCallback, this),\n\t\t\t\topenSearch: BX.proxy(this.openDialogCallback, this),\n\t\t\t\tcloseSearch: function ()\n\t\t\t\t{\n\t\t\t\t\t_this.closeDialogCallback(true);\n\t\t\t\t}\n\t\t\t},\n\t\t\titems: this.params.items,\n\t\t\titemsLast: this.params.itemsLast,\n\t\t\titemsSelected: this.params.itemsSelected,\n\t\t\tdepartmentSelectDisable: this.params.selectGroups === false\n\t\t});\n\t}\n\n\tcloseAll ()\n\t{\n\t\tif (BX.SocNetLogDestination.isOpenDialog())\n\t\t{\n\t\t\tBX.SocNetLogDestination.closeDialog();\n\t\t}\n\t\tBX.SocNetLogDestination.closeSearch();\n\t}\n\n\tselectCallback(item, type)\n\t{\n\t\tif (type === 'users')\n\t\t{\n\t\t\tthis.addUserBlock(item);\n\t\t\tBX.onCustomEvent('OnResourceBookDestinationAddNewItem', [item, this.id]);\n\t\t\tthis.socnetDestinationInput.value = '';\n\t\t}\n\t}\n\n\taddUserBlock(item, animation)\n\t{\n\t\tif (this.checkLimit && !this.checkLimit())\n\t\t{\n\t\t\treturn BookingUtil.showLimitationPopup();\n\t\t}\n\n\t\tif (this.getAttendeesCodesList().includes(item.id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst blocks = this.wrapNode.querySelectorAll(`calendar-resourcebook-content-block-control-inner[data-id='${item.id}']`);\n\t\tfor (let i = 0; i < blocks.length; i++)\n\t\t{\n\t\t\tBX.remove(blocks[i]);\n\t\t}\n\n\t\tconst itemWrap = this.wrapNode.appendChild(BX.create(\"DIV\", {\n\t\t\tattrs: {\n\t\t\t\t'data-id': item.id, className: \"calendar-resourcebook-content-block-control-inner green\"\n\t\t\t},\n\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-control-text\">' + item.name + '</div>' + '<div data-item-id=\"' + item.id + '\" data-item-type=\"users\" class=\"calendar-resourcebook-content-block-control-delete\"></div>' + '<input type=\"hidden\" name=\"' + this.destinationInputName + '[U][]' + '\" value=\"' + item.id + '\">'\n\t\t}));\n\n\t\tif (animation !== false)\n\t\t{\n\t\t\tsetTimeout(BX.delegate(function (){BX.addClass(itemWrap, 'shown');}, this), 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addClass(itemWrap, 'shown');\n\t\t}\n\n\t\tthis.wrapNode.appendChild(this.socnetDestinationInputWrap);\n\t\tthis.wrapNode.appendChild(this.socnetDestinationLink);\n\t}\n\n\tunSelectCallback(item)\n\t{\n\t\tlet elements = BX.findChildren(this.wrapNode, {attribute: {'data-id': item.id}}, true);\n\t\tif (elements != null)\n\t\t{\n\t\t\tfor (let j = 0; j < elements.length; j++)\n\t\t\t{\n\t\t\t\tBX.remove(elements[j]);\n\t\t\t}\n\t\t}\n\n\t\tBX.onCustomEvent('OnResourceBookDestinationUnselect', [item, this.id]);\n\t\tthis.socnetDestinationInput.value = '';\n\t\tthis.socnetDestinationLink.innerHTML = this.addMessage;\n\t}\n\n\topenDialogCallback ()\n\t{\n\t\tif (BX.SocNetLogDestination.popupWindow)\n\t\t{\n\t\t\t// Fix zIndex for slider issues\n\t\t\tBX.SocNetLogDestination.popupWindow.params.zIndex = this.zIndex;\n\t\t\tBX.SocNetLogDestination.popupWindow.popupContainer.style.zIndex = this.zIndex;\n\t\t}\n\n\t\tif (BX.SocNetLogDestination.popupSearchWindow)\n\t\t{\n\t\t\t// Fix zIndex for slider issues\n\t\t\tBX.SocNetLogDestination.popupSearchWindow.params.zIndex = this.zIndex;\n\t\t\tBX.SocNetLogDestination.popupSearchWindow.popupContainer.style.zIndex = this.zIndex;\n\t\t}\n\n\t\tBX.style(this.socnetDestinationInputWrap, 'display', 'inline-block');\n\t\tBX.style(this.socnetDestinationLink, 'display', 'none');\n\t\tBX.focus(this.socnetDestinationInput);\n\t}\n\n\tcloseDialogCallback(cleanInputValue)\n\t{\n\t\tif (!BX.SocNetLogDestination.isOpenSearch() && this.socnetDestinationInput.value.length <= 0)\n\t\t{\n\t\t\tBX.style(this.socnetDestinationInputWrap, 'display', 'none');\n\t\t\tBX.style(this.socnetDestinationLink, 'display', 'inline-block');\n\t\t\tif (cleanInputValue === true)\n\t\t\t\tthis.socnetDestinationInput.value = '';\n\n\t\t\t// Disable backspace\n\t\t\tif (BX.SocNetLogDestination.backspaceDisable || BX.SocNetLogDestination.backspaceDisable != null)\n\t\t\t\tBX.unbind(window, 'keydown', BX.SocNetLogDestination.backspaceDisable);\n\n\t\t\tBX.bind(window, 'keydown', BX.SocNetLogDestination.backspaceDisable = function(e)\n\t\t\t{\n\t\t\t\tif (e.keyCode === 8)\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsetTimeout(function()\n\t\t\t{\n\t\t\t\tBX.unbind(window, 'keydown', BX.SocNetLogDestination.backspaceDisable);\n\t\t\t\tBX.SocNetLogDestination.backspaceDisable = null;\n\t\t\t}, 5000);\n\t\t}\n\t}\n\n\tgetCodes()\n\t{\n\t\tlet\n\t\t\tinputsList = this.wrapNode.getElementsByTagName('INPUT'),\n\t\t\tcodes = [], i, value;\n\n\t\tfor (i = 0; i < inputsList.length; i++)\n\t\t{\n\t\t\tvalue = BX.util.trim(inputsList[i].value);\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tcodes.push(inputsList[i].value);\n\t\t\t}\n\t\t}\n\t\treturn codes;\n\t}\n\n\tgetAttendeesCodes()\n\t{\n\t\tlet\n\t\t\tinputsList = this.wrapNode.getElementsByTagName('INPUT'),\n\t\t\tvalues = [],\n\t\t\ti;\n\n\t\tfor (i = 0; i < inputsList.length; i++)\n\t\t{\n\t\t\tvalues.push(inputsList[i].value);\n\t\t}\n\n\t\treturn this.convertAttendeesCodes(values);\n\t}\n\n\tconvertAttendeesCodes(values)\n\t{\n\t\tlet attendeesCodes = {};\n\n\t\tif (BX.type.isArray(values))\n\t\t{\n\t\t\tvalues.forEach(function(code){\n\t\t\t\tif (code.substr(0, 2) === 'DR')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"department\";\n\t\t\t\t}\n\t\t\t\telse if (code.substr(0, 2) === 'UA')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"groups\";\n\t\t\t\t}\n\t\t\t\telse if (code.substr(0, 2) === 'SG')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"sonetgroups\";\n\t\t\t\t}\n\t\t\t\telse if (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"users\";\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn attendeesCodes;\n\t}\n\n\tgetAttendeesCodesList(codes)\n\t{\n\t\tlet result = [];\n\t\tif (!codes)\n\t\t\tcodes = this.getAttendeesCodes();\n\t\tfor (let i in codes)\n\t\t{\n\t\t\tif (codes.hasOwnProperty(i))\n\t\t\t{\n\t\t\t\tresult.push(i);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetSocnetDestinationConfig(key)\n\t{\n\t\tlet\n\t\t\tres,\n\t\t\tsocnetDestination = this.params.socnetDestination || {};\n\n\t\tif (key === 'items')\n\t\t{\n\t\t\tres = {\n\t\t\t\tusers: socnetDestination.USERS || {},\n\t\t\t\tgroups: socnetDestination.EXTRANET_USER === 'Y' || socnetDestination.DENY_TOALL\n\t\t\t\t\t? {}\n\t\t\t\t\t: {UA: {id: 'UA', name: BX.message('USER_TYPE_RESOURCE_TO_ALL_USERS')}},\n\t\t\t\tsonetgroups: socnetDestination.SONETGROUPS || {},\n\t\t\t\tdepartment: socnetDestination.DEPARTMENT || {},\n\t\t\t\tdepartmentRelation: socnetDestination.DEPARTMENT_RELATION || {}\n\t\t\t};\n\t\t}\n\t\telse if (key === 'itemsLast' && socnetDestination.LAST)\n\t\t{\n\t\t\tres = {\n\t\t\t\tusers: socnetDestination.LAST.USERS || {},\n\t\t\t\tgroups: socnetDestination.EXTRANET_USER === 'Y' ? {} : {UA: true},\n\t\t\t\tsonetgroups: socnetDestination.LAST.SONETGROUPS || {},\n\t\t\t\tdepartment: socnetDestination.LAST.DEPARTMENT || {}\n\t\t\t};\n\t\t}\n\t\telse if (key === 'itemsSelected')\n\t\t{\n\t\t\tres = socnetDestination.SELECTED || {};\n\t\t}\n\t\treturn res || {};\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\tlet\n\t\t\tresult = [], i,\n\t\t\tinputs = this.wrapNode.querySelectorAll('input');\n\n\t\tfor (i = 0; i < inputs.length; i++)\n\t\t{\n\t\t\tif (inputs[i].type === 'hidden' && inputs[i].value)\n\t\t\t{\n\t\t\t\tif (inputs[i].value.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tresult.push(parseInt(inputs[i].value.substr(1)));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsetValues(userList, trigerOnChange)\n\t{\n\t\tlet i, user;\n\t\tconst blocks = this.wrapNode.querySelectorAll('.calendar-resourcebook-content-block-control-inner');\n\t\tfor (i = 0; i < blocks.length; i++)\n\t\t{\n\t\t\tBX.remove(blocks[i]);\n\t\t}\n\n\t\tfor (i = 0; i < userList.length; i++)\n\t\t{\n\t\t\tif (BX.SocNetLogDestination.obItems[this.id]['users'])\n\t\t\t{\n\t\t\t\tuser = BX.SocNetLogDestination.obItems[this.id]['users']['U' + userList[i]];\n\t\t\t\tif (user)\n\t\t\t\t{\n\t\t\t\t\tthis.addUserBlock({\n\t\t\t\t\t\tid: 'U' + userList[i],\n\t\t\t\t\t\tname: user.name\n\t\t\t\t\t}, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (trigerOnChange !== false && this.onChangeCallback && BX.type.isFunction(this.onChangeCallback))\n\t\t{\n\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t}\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n}\n\n\nexport class WebformUserSelectorFieldEditControl extends UserSelectorFieldEditControl\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.DOM.externalWrap = params.externalWrap;\n\t\tthis.closeDialogDelayFlag = false;\n\t\tthis.finalShowClassName = 'calendar-resbook-socnet-dest-custom-wrap-appearing';\n\t}\n\n\topenDialogCallback()\n\t{\n\t\tsuper.openDialogCallback();\n\t\tBX.cleanNode(this.DOM.externalWrap);\n\n\t\tlet useAnimation = !this.closeDialogDelayFlag;\n\t\tif ((this.popupContent && BX.hasClass(this.popupContent, this.finalShowClassName))\n\t\t\t||\n\t\t\t(this.popupSearchContent && BX.hasClass(this.popupSearchContent, this.finalShowClassName))\n\t\t)\n\t\t{\n\t\t\tuseAnimation = false;\n\t\t}\n\n\t\tif (BX.SocNetLogDestination.popupWindow)\n\t\t{\n\t\t\tthis.popupContent = this.DOM.externalWrap.appendChild(BX.SocNetLogDestination.popupWindow.contentContainer);\n\t\t\tBX.addClass(BX.SocNetLogDestination.popupWindow.popupContainer, 'calendar-resbook-socnet-dest-popup-hide');\n\n\t\t\tif (useAnimation)\n\t\t\t{\n\t\t\t\tBX.addClass(this.popupContent, 'calendar-resbook-socnet-dest-custom-wrap');\n\t\t\t\tBX.defer(function(){\n\t\t\t\t\tBX.addClass(this.popupContent, 'calendar-resbook-socnet-dest-custom-wrap-show');\n\n\t\t\t\t\tsetTimeout(BX.delegate(function(){\n\t\t\t\t\t\tBX.addClass(this.popupContent, this.finalShowClassName);\n\t\t\t\t\t}, this), 200);\n\t\t\t\t}, this)();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.addClass(this.popupContent, this.finalShowClassName);\n\t\t\t}\n\t\t}\n\n\t\tif (BX.SocNetLogDestination.popupSearchWindow)\n\t\t{\n\t\t\tthis.popupSearchContent = this.DOM.externalWrap.appendChild(BX.SocNetLogDestination.popupSearchWindow.contentContainer);\n\t\t\tBX.addClass(this.popupSearchContent, this.finalShowClassName);\n\t\t\tBX.addClass(BX.SocNetLogDestination.popupSearchWindow.popupContainer, 'calendar-resbook-socnet-dest-popup-hide');\n\t\t}\n\t}\n\n\tcloseDialogCallback()\n\t{\n\t\tsuper.closeDialogCallback();\n\n\t\tthis.closeDialogDelayFlag = true;\n\t\tsetTimeout(function()\n\t\t{\n\t\t\tthis.closeDialogDelayFlag = false;\n\t\t}.bind(this), 10);\n\n\t\tif (this.popupContent)\n\t\t{\n\t\t\tBX.removeClass(this.popupContent, 'calendar-resbook-socnet-dest-custom-wrap');\n\t\t\tBX.removeClass(this.popupContent, 'calendar-resbook-socnet-dest-custom-wrap-show');\n\t\t\tBX.removeClass(this.popupContent, this.finalShowClassName);\n\t\t}\n\t}\n}","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {FormFieldTunnerValuePopupAbstract} from \"../formfieldtunnervaluepopupabstract\";\nimport {ResourcebookingUserfield} from \"../resourcebookinguserfield\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type, Dom} from \"main.core\";\nimport {WebformUserSelectorFieldEditControl} from \"./userselectorfieldeditcontrol\";\n\nexport class UserSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_USERS');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_USERS_LABEL');\n\t\tthis.displayed = true;\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig(params);\n\t\tthis.defaultMode = params.defaultMode;\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.isDisplayed = this.isDisplayed.bind(this);\n\t\tparams.defaultMode = params.defaultMode || this.defaultMode;\n\t\tthis.statePopup = new UsersStatePopup(params);\n\t}\n\n\tbuildValuePopup(params)\n\t{\n\t\tthis.valuePopup = new UsersValuePopup(params);\n\t}\n\n\tdisplayInForm()\n\t{\n\t\tsuper.displayInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setEnabled();\n\t}\n\n\thideInForm()\n\t{\n\t\tsuper.hideInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setDisabled();\n\t}\n\n\tgetValue()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tdefaultMode: this.statePopup.getDefaultMode(),\n\t\t\tvalue: this.valuePopup.getSelectedValues()\n\t\t};\n\t}\n}\n\nclass UsersStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'usersStatePopup';\n\t\tthis.inputName = 'user-select-mode';\n\t\tthis.id = 'users-state-' + Math.round(Math.random() * 1000);\n\t\tthis.defaultMode = params.defaultMode === 'none' ? 'none' : 'auto';\n\t\tthis.isDisplayed = Type.isFunction(params.isDisplayed) ? params.isDisplayed : function(){return false};\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tlet submenuClass = 'main-buttons-submenu-separator main-buttons-submenu-item main-buttons-hidden-label';\n\n\t\treturn [\n\t\t\t{\n\t\t\t\ttext: '<span>' + Loc.getMessage('WEBF_RES_SELECT_DEFAULT_TITLE') + '</span>',\n\t\t\t\tclassName: submenuClass\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'users-state-list',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DEFAULT_EMPTY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'none',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'none'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'users-state-auto',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DEFAULT_FREE_USER'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'auto',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'auto'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset && menuItem.dataset.inputName === this.inputName\n\t\t)\n\t\t{\n\t\t\tthis.defaultMode = menuItem.dataset.value;\n\t\t}\n\t\tthis.handleControlChanges();\n\t\tsetTimeout(this.closePopup.bind(this), 50);\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn this.isDisplayed()\n\t\t\t?\n\t\t\t(Loc.getMessage('WEBF_RES_SELECT_USER_FROM_LIST_SHORT') +\n\t\t\t\t(this.defaultMode === 'none'\n\t\t\t\t\t\t? ''\n\t\t\t\t\t\t: (',<br>' + Loc.getMessage('WEBF_RES_AUTO_SELECT_USER_SHORT'))\n\t\t\t\t))\n\t\t\t:\n\t\t\tLoc.getMessage('WEBF_RES_SELECT_USER_FROM_LIST_AUTO');\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t\tBX.onCustomEvent(this, \"ResourceBooking.userSettingsField:onControlChanged\", []);\n\t}\n\n\tgetDefaultMode()\n\t{\n\t\treturn this.defaultMode;\n\t}\n}\n\nclass UsersValuePopup extends FormFieldTunnerValuePopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'usersValuePopup';\n\n\t\tthis.values = [];\n\t\tthis.selectedValues = [];\n\t\tthis.selectedCodes = [];\n\t\tlet\n\t\t\tselectedItems, selectedIndex = {},\n\t\t\tselectAll = params.config.selected === null;\n\n\t\tselectedItems = Type.isArray(params.config.selected) ? params.config.selected : params.config.selected.split('|');\n\t\tif (Type.isArray(selectedItems))\n\t\t{\n\t\t\tfor(let i = 0; i < selectedItems.length; i++)\n\t\t\t{\n\t\t\t\tselectedIndex[selectedItems[i]] = true;\n\t\t\t\tthis.selectedValues.push(selectedItems[i]);\n\t\t\t\tthis.selectedCodes.push('U' + selectedItems[i]);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isArray(params.config.users) && selectAll)\n\t\t{\n\t\t\tparams.config.users.forEach(function(userId)\n\t\t\t{\n\t\t\t\tif (!selectedIndex[userId])\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push(userId);\n\t\t\t\t\tthis.selectedCodes.push('U' + userId);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.config = {};\n\t\tthis.build();\n\t}\n\n\tgetPopupContent()\n\t{\n\t\tsuper.getPopupContent();\n\t\tnew Promise((resolve) => {\n\n\t\t\tif (!this.config.socnetDestination)\n\t\t\t{\n\t\t\t\tthis.showPopupLoader();\n\t\t\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getuserselectordata', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tselectedUserList: this.selectedValues\n\t\t\t\t\t}\n\t\t\t\t}).then(function (response)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hidePopupLoader();\n\t\t\t\t\t\tthis.config.socnetDestination = response.data;\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\tfunction (response) {\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t}).then(this.buildUserSelector.bind(this));\n\n\t\treturn this.DOM.innerWrap;\n\t}\n\n\tshowPopupLoader ()\n\t{\n\t\tif (this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.hidePopupLoader();\n\t\t\tthis.DOM.popupLoader = this.DOM.innerWrap.appendChild(Dom.create(\"div\", {props: {className: 'calendar-resourcebook-popup-loader-wrap'}}));\n\t\t\tthis.DOM.popupLoader.appendChild(BookingUtil.getLoader(38));\n\t\t}\n\t}\n\n\tgetPopupWidth()\n\t{\n\t\treturn 680;\n\t}\n\n\tbuildUserSelector()\n\t{\n\t\tthis.DOM.userCurrentvalueWrap = this.DOM.innerWrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops: {\n\t\t\t\tclassName: 'calendar-resourcebook-content-block-control custom-field-item'\n\t\t\t}\n\t\t}));\n\t\tthis.DOM.userSelectorWrap = this.DOM.innerWrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops: {\n\t\t\t\tclassName: 'calendar-resourcebook-pseudo-popup-wrap'\n\t\t\t}\n\t\t}));\n\n\t\tthis.userSelector = new WebformUserSelectorFieldEditControl({\n\t\t\twrapNode: this.DOM.userCurrentvalueWrap,\n\t\t\tsocnetDestination: this.config.socnetDestination,\n\t\t\titemsSelected: this.selectedCodes,\n\t\t\taddMessage: Loc.getMessage('USER_TYPE_RESOURCE_SELECT_USER'),\n\t\t\texternalWrap: this.DOM.userSelectorWrap\n\t\t});\n\n\t\tthis.userSelectorId = this.userSelector.getId();\n\n\t\tBX.addCustomEvent('OnResourceBookDestinationAddNewItem', this.triggerUserSelectorUpdate.bind(this));\n\t\tBX.addCustomEvent('OnResourceBookDestinationUnselect', this.triggerUserSelectorUpdate.bind(this));\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\treturn this.selectedValues;\n\t}\n\n\ttriggerUserSelectorUpdate(item, selectroId, delayExecution)\n\t{\n\t\tif (selectroId === this.userSelectorId)\n\t\t{\n\t\t\tif (this.selectorUpdateTimeout)\n\t\t\t{\n\t\t\t\tthis.selectorUpdateTimeout = clearTimeout(this.selectorUpdateTimeout);\n\t\t\t}\n\n\t\t\tif (delayExecution !== false)\n\t\t\t{\n\t\t\t\tthis.selectorUpdateTimeout = setTimeout(function(){\n\t\t\t\t\tthis.triggerUserSelectorUpdate(item, selectroId, false);\n\t\t\t\t}.bind(this), 300);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.selectedValues = [];\n\t\t\tthis.selectedCodes = this.userSelector.getAttendeesCodesList();\n\n\t\t\tthis.selectedCodes.forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push(parseInt(code.substr(1)));\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\tgetCurrentValueState()\n\t{\n\t\tconst count = this.selectedValues.length;\n\t\treturn count ? (count + ' ' + ResourcebookingUserfield.getPluralMessage('WEBF_RES_USER', count)) : Loc.getMessage('WEBF_RES_NO_VALUE');\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tBX.onCustomEvent('ResourceBooking.settingsUserSelector:onChanged');\n\t\tsuper.handleControlChanges();\n\t\tDom.adjust(this.DOM.valueLink, {text: this.getCurrentValueState()});\n\t}\n}","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {FormFieldTunnerMultipleChecknoxPopupAbstract} from \"../formfieldtunnervaluepopupabstract\";\nimport {ResourcebookingUserfield} from \"../resourcebookinguserfield\";\nimport {Loc, Type, Dom} from \"main.core\";\n\nexport class ResourceSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_RESOURCES');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_RESOURCES_LABEL');\n\t\tthis.displayed = true;\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig(params);\n\t\tthis.defaultMode = params.defaultMode;\n\t\tthis.multiple = params.multiple === 'Y';\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.isDisplayed = this.isDisplayed.bind(this);\n\t\tparams.defaultMode = params.defaultMode || this.defaultMode;\n\t\tparams.multiple = params.multiple == null ? this.multiple : params.multiple;\n\t\tthis.statePopup = new ResourcesStatePopup(params);\n\t}\n\n\tbuildValuePopup (params)\n\t{\n\t\tthis.valuePopup = new ResourcesValuePopup(params);\n\t}\n\n\tdisplayInForm ()\n\t{\n\t\tsuper.displayInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setEnabled();\n\t}\n\n\thideInForm ()\n\t{\n\t\tsuper.hideInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setDisabled();\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tdefaultMode: this.statePopup.getDefaultMode(),\n\t\t\tmultiple: this.statePopup.getMultiple() ? 'Y' : 'N',\n\t\t\tvalue: this.valuePopup.getSelectedId()\n\t\t};\n\t}\n}\n\n\nclass ResourcesStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'resourcesStatePopup';\n\t\tthis.inputName = 'resource-select-mode';\n\t\tthis.defaultMode = params.defaultMode === 'none' ? 'none' : 'auto';\n\t\tthis.multiple = !!params.multiple;\n\t\tthis.isDisplayed = Type.isFunction(params.isDisplayed) ? params.isDisplayed : function(){return false;};\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tvar submenuClass = 'main-buttons-submenu-separator main-buttons-submenu-item main-buttons-hidden-label';\n\n\t\treturn [\n\t\t\t{\n\t\t\t\ttext: '<span>' + Loc.getMessage('WEBF_RES_SELECT_DEFAULT_TITLE') + '</span>',\n\t\t\t\tclassName: submenuClass\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'resources-state-list',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DEFAULT_EMPTY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'none',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'none'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'resources-state-auto',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_AUTO_SELECT_RES'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'auto',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'auto'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tdelimiter: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'resources-state-multiple',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_MULTIPLE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\tchecked: this.multiple\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn this.isDisplayed()\n\t\t\t?\n\t\t\t(Loc.getMessage('WEBF_RES_SELECT_RES_FROM_LIST_SHORT') +\n\t\t\t\t(this.defaultMode === 'none'\n\t\t\t\t\t\t? ''\n\t\t\t\t\t\t: (',<br>' + Loc.getMessage('WEBF_RES_AUTO_SELECT_RES_SHORT'))\n\t\t\t\t))\n\t\t\t:\n\t\t\tLoc.getMessage('WEBF_RES_SELECT_RES_FROM_LIST_AUTO');\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t\tBX.onCustomEvent(this, \"ResourceBooking.userSettingsField:onControlChanged\", []);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.dataset.inputName === this.inputName)\n\t\t\t{\n\t\t\t\tthis.defaultMode = menuItem.dataset.value;\n\t\t\t}\n\t\t\telse if (menuItem.id === 'resources-state-multiple')\n\t\t\t{\n\t\t\t\tthis.multiple = !!target.checked;\n\t\t\t}\n\t\t}\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetDefaultMode()\n\t{\n\t\treturn this.defaultMode;\n\t}\n\n\tgetMultiple()\n\t{\n\t\treturn this.multiple;\n\t}\n}\n\n\nclass ResourcesValuePopup extends FormFieldTunnerMultipleChecknoxPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'resourcesValuePopup';\n\t\tthis.selectAllMessage = Loc.getMessage('USER_TYPE_RESOURCE_SELECT_ALL');\n\n\t\tlet\n\t\t\tselectedItems, selectedIndex = {},\n\t\t\tselectAll = params.config.selected === null;\n\n\t\tif (Type.isArray(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected;\n\t\t}\n\t\telse if (Type.isString(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected.split('|');\n\t\t}\n\n\t\tif (Type.isArray(selectedItems))\n\t\t{\n\t\t\tfor(let i = 0; i < selectedItems.length; i++)\n\t\t\t{\n\t\t\t\tselectedIndex[selectedItems[i]] = true;\n\t\t\t}\n\t\t}\n\n\t\tthis.values = [];\n\t\tthis.selectedValues = [];\n\t\tif (Type.isArray(params.config.resources))\n\t\t{\n\t\t\tparams.config.resources.forEach(function(resource)\n\t\t\t{\n\t\t\t\tlet valueId = this.prepareValueId(resource);\n\t\t\t\tthis.values.push({\n\t\t\t\t\tid: valueId,\n\t\t\t\t\ttitle: resource.title,\n\t\t\t\t\tdataset: resource\n\t\t\t\t});\n\n\t\t\t\tif (selectAll || selectedIndex[resource.id])\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push(valueId);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.build();\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tDom.adjust(this.DOM.valueLink, {text: this.getCurrentValueState()});\n\t}\n\n\tgetCurrentValueState()\n\t{\n\t\tlet count = this.selectedValues.length;\n\t\treturn count ? (count + ' ' + ResourcebookingUserfield.getPluralMessage('WEBF_RES_RESOURCE', count)) : Loc.getMessage('WEBF_RES_NO_VALUE');\n\t}\n\n\tprepareValueId(resource)\n\t{\n\t\treturn resource.type + '|' + resource.id;\n\t}\n\n\tgetSelectedId()\n\t{\n\t\tlet result = [];\n\t\tthis.getSelectedValues().forEach(function(value)\n\t\t{\n\t\t\tlet val = value.split('|');\n\t\t\tif (val && val[1])\n\t\t\t{\n\t\t\t\tresult.push(parseInt(val[1]));\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n}\n\n\n\n\n","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerMultipleChecknoxPopupAbstract} from \"../formfieldtunnervaluepopupabstract\";\nimport {ResourcebookingUserfield} from \"../resourcebookinguserfield\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type, Dom} from \"main.core\";\n\nexport class ServiceSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_SERVICES');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_SERVICE_LABEL');\n\t\tthis.displayed = true;\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tif (params && Type.isDomNode(params.wrap))\n\t\t{\n\t\t\tparams.wrap.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: {className:'calendar-resbook-webform-settings-popup-select disabled'},\n\t\t\t\thtml: '<span class=\"calendar-resbook-webform-settings-popup-select-value\">' + Loc.getMessage('WEBF_RES_FROM_LIST') + '</span>'\n\t\t\t}));\n\t\t}\n\t}\n\n\tbuildValuePopup (params)\n\t{\n\t\tthis.valuePopup = new ServiceValuePopup(params);\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tvalue: this.valuePopup.getSelectedValues()\n\t\t};\n\t}\n}\n\n\nclass ServiceValuePopup extends FormFieldTunnerMultipleChecknoxPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'ServiceValuePopup';\n\t\tthis.selectAllMessage = Loc.getMessage('WEBF_RES_SELECT_ALL_SERVICES');\n\n\t\tlet selectAll = params.config.selected === null || params.config.selected === '' || params.config.selected === undefined;\n\t\tthis.values = [];\n\t\tthis.selectedValues = [];\n\n\t\tlet selectedItems, selectedIndex = {};\n\t\tif (Type.isArray(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected;\n\t\t}\n\t\telse if (Type.isString(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected.split('|');\n\t\t}\n\n\t\tif (Type.isArray(selectedItems))\n\t\t{\n\t\t\tfor(let i = 0; i < selectedItems.length; i++)\n\t\t\t{\n\t\t\t\tselectedIndex[BookingUtil.translit(selectedItems[i])] = true;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isArray(params.config.services))\n\t\t{\n\t\t\tparams.config.services.forEach(function(service)\n\t\t\t{\n\t\t\t\tservice.id = BookingUtil.translit(service.name);\n\t\t\t\tthis.values.push({\n\t\t\t\t\tid: service.id,\n\t\t\t\t\ttitle: service.name + ' - ' + BookingUtil.getDurationLabel(service.duration),\n\t\t\t\t\tdataset: service\n\t\t\t\t});\n\n\t\t\t\tif (selectAll || selectedIndex[BookingUtil.translit(service.name)])\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push(service.id);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.config = {};\n\t\tthis.build();\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tDom.adjust(this.DOM.valueLink, {text: this.getCurrentValueState()});\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\treturn this.selectedValues.length ? this.selectedValues : '#EMPTY-SERVICE-LIST#';\n\t}\n\n\tgetCurrentValueState()\n\t{\n\t\tlet count = this.selectedValues.length;\n\t\treturn count ? (count + ' ' + ResourcebookingUserfield.getPluralMessage('WEBF_RES_SERVICE', count)) : Loc.getMessage('WEBF_RES_NO_VALUE');\n\t}\n}\n\n\n","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type} from \"main.core\";\n\nexport class DurationSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_DURATION');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_DURATION_LABEL');\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig();\n\t\tthis.defaultValue = params.defaultValue;\n\t\tthis.manualInput = params.manualInput === 'Y';\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.isDisplayed = this.isDisplayed.bind(this);\n\t\tparams.defaultValue = this.defaultValue;\n\t\tparams.manualInput = this.manualInput;\n\t\tthis.statePopup = new DurationStatePopup(params);\n\t}\n\n\tdisplayInForm ()\n\t{\n\t\tsuper.displayInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t}\n\n\thideInForm ()\n\t{\n\t\tsuper.hideInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tdefaultValue: this.statePopup.getDefaultValue(),\n\t\t\tmanualInput: this.statePopup.getManualInput() ? 'Y' : 'N'\n\t\t};\n\t}\n}\n\n\nclass DurationStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'durationStatePopup';\n\t\tthis.inputName = 'duration-select-mode';\n\t\tthis.manualInput = !!params.manualInput;\n\t\tthis.defaultValue = params.defaultValue || 60;\n\t\tthis.isDisplayed = Type.isFunction(params.isDisplayed) ? params.isDisplayed : function(){return false;};\n\t\tthis.durationList = BookingUtil.getDurationList(params.fullDay);\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'duration-default-value',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DURATION_AUTO'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'submenu-list',\n\t\t\t\t\tvalue: this.defaultValue,\n\t\t\t\t\ttextValue: this.getDurationLabelByValue(this.defaultValue)\n\t\t\t\t},\n\t\t\t\titems: this.getDefaultMenuItems()\n\t\t\t}].concat((this.isDisplayed()\n\t\t\t? [\n\t\t\t\t{\n\t\t\t\t\tdelimiter: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'duration-manual-input',\n\t\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_MANUAL_INPUT'),\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\t\tchecked: this.manualInput\n\t\t\t\t\t},\n\t\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t\t}\n\t\t\t]\n\t\t\t: []));\n\t}\n\n\tgetDefaultMenuItems()\n\t{\n\t\tlet menuItems = [];\n\n\t\tif (Type.isArray(this.durationList))\n\t\t{\n\t\t\tthis.durationList.forEach(function(item)\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\tid: 'duration-' + item.value,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\ttype: 'duration',\n\t\t\t\t\t\tvalue: item.value\n\t\t\t\t\t},\n\t\t\t\t\ttext: item.label,\n\t\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t\t});\n\t\t\t}, this);\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tgetDurationLabelByValue(duration)\n\t{\n\t\tlet foundDuration = this.durationList.find(function(item){return parseInt(item.value) === parseInt(duration)});\n\t\treturn foundDuration ? foundDuration.label : null;\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn this.isDisplayed()\n\t\t\t?\n\t\t\t(Loc.getMessage('WEBF_RES_SELECT_DURATION_FROM_LIST_SHORT')\n\t\t\t\t+ (',<br>' + Loc.getMessage('WEBF_RES_SELECT_DURATION_BY_DEFAULT') + ' ' + this.getDurationLabelByValue(this.defaultValue)))\n\t\t\t:\n\t\t\tLoc.getMessage('WEBF_RES_SELECT_DURATION_AUTO') + ' ' + this.getDurationLabelByValue(this.defaultValue);\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t\tBX.onCustomEvent(this, \"ResourceBooking.userSettingsField:onControlChanged\", []);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.id === 'duration-manual-input')\n\t\t\t{\n\t\t\t\tthis.manualInput = !!target.checked;\n\t\t\t}\n\t\t}\n\t\telse if (menuItem.dataset && menuItem.dataset.type === 'duration')\n\t\t{\n\t\t\tthis.defaultValue = parseInt(menuItem.dataset.value);\n\t\t}\n\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetManualInput()\n\t{\n\t\treturn this.manualInput;\n\t}\n\n\tgetDefaultValue()\n\t{\n\t\treturn this.defaultValue;\n\t}\n}","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {Loc, Type, Dom} from \"main.core\";\n\nexport class DateSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_DATE');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_DATE_LABEL');\n\t\tthis.displayed = true;\n\t\tthis.displayCheckboxDisabled = true;\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig();\n\t\tthis.style = params.style;\n\t\tthis.start = params.start;\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.style = params.style || this.style;\n\t\tparams.start = params.start || this.start;\n\t\tthis.statePopup = new DateStatePopup(params);\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tstyle: this.statePopup.getStyle(),\n\t\t\tstart: this.statePopup.getStart()\n\t\t};\n\t}\n}\n\n\nclass DateStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'dateStatePopup';\n\t\tthis.styleInputName = 'date-select-style';\n\t\tthis.startInputName = 'date-select-start';\n\t\tthis.style = params.style === 'popup' ? 'popup' : 'line'; // popup|line\n\t\tthis.start = params.start === 'today' ? 'today' : 'free'; // today|free\n\t\tthis.build();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tlet submenuClass = 'main-buttons-submenu-separator main-buttons-submenu-item main-buttons-hidden-label';\n\n\t\treturn [\n\t\t\t{\n\t\t\t\ttext: '<span>' + Loc.getMessage('WEBF_RES_CALENDAR_STYLE') + '</span>',\n\t\t\t\tclassName: submenuClass\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'date-state-style-popup',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_STYLE_POPUP'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'popup',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'popup'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'date-state-style-line',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_STYLE_LINE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'line',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'line'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: '<span>' + Loc.getMessage('WEBF_RES_CALENDAR_START_FROM') + '</span>',\n\t\t\t\tclassName: submenuClass\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'date-state-start-from-today',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_TODAY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'today',\n\t\t\t\t\tinputName: this.startInputName,\n\t\t\t\t\tchecked: this.start === 'today'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'date-state-start-from-free',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_FREE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'free',\n\t\t\t\t\tinputName: this.startInputName,\n\t\t\t\t\tchecked: this.start === 'free'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn (this.style === 'popup'\n\t\t\t? Loc.getMessage('WEBF_RES_CALENDAR_STYLE_POPUP')\n\t\t\t: Loc.getMessage('WEBF_RES_CALENDAR_STYLE_LINE'))\n\t\t\t+ ', '\n\t\t\t+ (this.start === 'today'\n\t\t\t\t? Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_TODAY_SHORT')\n\t\t\t\t: Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_FREE_SHORT'));\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tDom.adjust(this.DOM.currentStateLink, {text: this.getCurrentModeState()});\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.dataset.inputName === this.styleInputName)\n\t\t\t{\n\t\t\t\tthis.style = menuItem.dataset.value;\n\t\t\t}\n\t\t\telse if (menuItem.dataset.inputName === this.startInputName)\n\t\t\t{\n\t\t\t\tthis.start = menuItem.dataset.value;\n\t\t\t}\n\t\t}\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetStyle()\n\t{\n\t\treturn this.style;\n\t}\n\n\tgetStart()\n\t{\n\t\treturn this.start;\n\t}\n}\n\n","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type} from \"main.core\";\n\nexport class TimeSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_TIME');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_TIME_LABEL');\n\t\tthis.displayed = true;\n\t\tthis.displayCheckboxDisabled = true;\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig();\n\t\tthis.style = params.style;\n\t\tthis.showOnlyFree = params.showOnlyFree === 'Y';\n\t\tthis.showFinishTime = params.showFinishTime === 'Y';\n\t\tthis.scale = parseInt(params.scale);\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.style = params.style || this.style;\n\t\tparams.showOnlyFree = this.showOnlyFree;\n\t\tparams.showFinishTime = this.showFinishTime;\n\t\tparams.scale = this.scale;\n\t\tthis.statePopup = new TimeStatePopup(params);\n\t}\n\n\tgetValue()\n\t{\n\t\treturn {\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tstyle: this.statePopup.getStyle(),\n\t\t\tshowFinishTime: this.statePopup.getShowFinishTime(),\n\t\t\tshowOnlyFree: this.statePopup.getShowOnlyFree(),\n\t\t\tscale: this.statePopup.getScale()\n\t\t};\n\t}\n}\n\n\nclass TimeStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'timeStatePopup';\n\t\tthis.styleInputName = 'date-select-style';\n\n\t\tthis.showOnlyFree = params.showOnlyFree;\n\t\tthis.showFinishTime = params.showFinishTime;\n\t\tthis.scale = params.scale;\n\t\tthis.stateShowFreeId = 'time-state-show-free';\n\t\tthis.stateShowFinishId = 'time-state-show-finish';\n\t\tthis.style = params.style === 'select' ? 'select' : 'slots'; // select|slots\n\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tlet\n\t\t\tsubmenuClass = 'main-buttons-submenu-separator main-buttons-submenu-item main-buttons-hidden-label';\n\n\t\treturn [\n\t\t\t{\n\t\t\t\ttext: '<span>' + Loc.getMessage('WEBF_RES_TIME_STYLE') + '</span>',\n\t\t\t\tclassName: submenuClass\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'time-state-style-select',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_STYLE_SELECT'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'select',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'select'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'time-state-style-slots',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_STYLE_SLOT'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'slots',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'slots'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tdelimiter: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'time-state-scale',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_BOOKING_SIZE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'submenu-list',\n\t\t\t\t\tvalue: this.scale,\n\t\t\t\t\ttextValue: this.getDurationLabelByValue(this.scale)\n\t\t\t\t},\n\t\t\t\titems: this.getDurationMenuItems()\n\t\t\t},\n\t\t\t{\n\t\t\t\tdelimiter: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: this.stateShowFreeId,\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_SHOW_FREE_ONLY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\tchecked: this.showOnlyFree\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: this.stateShowFinishId,\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_SHOW_FINISH_TIME'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\tchecked: this.showFinishTime\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn (this.style === 'select'\n\t\t\t? Loc.getMessage('WEBF_RES_TIME_STYLE_SELECT')\n\t\t\t: Loc.getMessage('WEBF_RES_TIME_STYLE_SLOT'))\n\t\t\t+ ',<br>'\n\t\t\t+ Loc.getMessage('WEBF_RES_TIME_BOOKING_SIZE') + ': '\n\t\t\t+ this.getDurationLabelByValue(this.scale);\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.dataset.inputName === this.styleInputName)\n\t\t\t{\n\t\t\t\tthis.style = menuItem.dataset.value;\n\t\t\t}\n\t\t\telse if (menuItem.id === this.stateShowFreeId)\n\t\t\t{\n\t\t\t\tthis.showOnlyFree = !!target.checked;\n\t\t\t}\n\t\t\telse if (menuItem.id === this.stateShowFinishId)\n\t\t\t{\n\t\t\t\tthis.showFinishTime = !!target.checked;\n\t\t\t}\n\t\t}\n\t\telse if (menuItem.dataset && menuItem.dataset.type === 'scale')\n\t\t{\n\t\t\tthis.scale = parseInt(menuItem.dataset.value);\n\t\t}\n\n\t\tthis.handleControlChanges();\n\t}\n\n\n\tgetDurationMenuItems()\n\t{\n\t\tlet\n\t\t\tdurationList = this.getDurationList(),\n\t\t\tmenuItems = [];\n\n\t\tdurationList.forEach(function(duration){\n\t\t\tmenuItems.push({\n\t\t\t\tid: 'duration-' + duration.value,\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'scale',\n\t\t\t\t\tvalue: duration.value\n\t\t\t\t},\n\t\t\t\ttext: duration.label,\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t});\n\t\t}, this);\n\n\t\treturn menuItems;\n\t}\n\n\n\tgetDurationList()\n\t{\n\t\tif (!this.durationList)\n\t\t{\n\t\t\tthis.durationList = BookingUtil.getDurationList(false);\n\t\t\tthis.durationList = this.durationList.filter(function(duration)\n\t\t\t{\n\t\t\t\treturn duration.value && duration.value >= 15 && duration.value <= 240;\n\t\t\t});\n\t\t}\n\t\treturn this.durationList;\n\t}\n\n\tgetDurationLabelByValue(duration)\n\t{\n\t\tlet foundDuration = this.getDurationList().find(function(item){return item.value === duration});\n\t\treturn foundDuration ? foundDuration.label : null;\n\t}\n\n\tgetStyle()\n\t{\n\t\treturn this.style;\n\t}\n\n\tgetScale()\n\t{\n\t\treturn this.scale;\n\t}\n\n\tgetShowOnlyFree()\n\t{\n\t\treturn this.showOnlyFree ? 'Y' : 'N';\n\t}\n\n\tgetShowFinishTime()\n\t{\n\t\treturn this.showFinishTime ? 'Y' : 'N';\n\t}\n}\n\n\n","import {BookingUtil, FieldViewControllerEdit, FieldViewControllerPreview, Dom, Loc, Type} from \"calendar.resourcebooking\";\nimport {ResourcebookingUserfield} from \"./resourcebookinguserfield\";\nimport {UserSelectorFieldTunner} from \"./controls/userselectorfieldtunner\";\nimport {ResourceSelectorFieldTunner} from \"./controls/resourceselectorfieldtunner\";\nimport {ServiceSelectorFieldTunner} from \"./controls/serviceselectorfieldtunner\";\nimport {DurationSelectorFieldTunner} from \"./controls/durationselectorfieldtunner\";\nimport {DateSelectorFieldTunner} from \"./controls/dateselectorfieldtunner\";\nimport {TimeSelectorFieldTunner} from \"./controls/timeselectorfieldtunner\";\n\nexport class AdjustFieldController\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params;\n\t\tthis.complexFields = {};\n\t\tthis.userFieldParams = null;\n\t\tthis.id = 'resbook-settings-popup-' + Math.round(Math.random() * 100000);\n\t\tthis.settingsData = AdjustFieldController.getSettingsData(this.params.settings.data);\n\t\tthis.params.settings.data = this.settingsData;\n\n\t\tthis.DOM = {\n\t\t\tinnerWrap: this.params.innerWrap,\n\t\t\tsettingsWrap: this.params.innerWrap.appendChild(Dom.create(\"div\", {attrs: {'data-bx-resource-field-settings': 'Y'}})),\n\t\t\tcaptionNode: this.params.captionNode,\n\t\t\tsettingsInputs: {}\n\t\t};\n\t}\n\n\tinit()\n\t{\n\t\t// Request field params\n\t\tthis.showFieldLoader();\n\n\t\tResourcebookingUserfield.getUserFieldParams({\n\t\t\tfieldName: this.params.entityName,\n\t\t\tselectedUsers: this.getSelectedUsers()\n\t\t}).then(\n\t\t\tfunction(fieldParams)\n\t\t\t{\n\t\t\t\tthis.hideFieldLoader();\n\t\t\t\tthis.userFieldParams = fieldParams;\n\n\t\t\t\tthis.fieldLayout = new FieldViewControllerEdit({\n\t\t\t\t\twrap: this.DOM.innerWrap,\n\t\t\t\t\tdisplayTitle: false,\n\t\t\t\t\ttitle: this.getCaption(),\n\t\t\t\t\tsettings: this.getSettings()\n\t\t\t\t});\n\t\t\t\tthis.fieldLayout.build();\n\t\t\t\tthis.updateSettingsDataInputs();\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tshowSettingsPopup()\n\t{\n\t\tResourcebookingUserfield.getUserFieldParams(\n\t\t{\n\t\t\tfieldName: this.params.entityName,\n\t\t\tselectedUsers: this.getSelectedUsers()\n\t\t}).then(\n\t\t\tfunction(fieldParams)\n\t\t\t{\n\t\t\t\tthis.userFieldParams = fieldParams;\n\t\t\t\tthis.settingsPopupId = 'calendar-resourcebooking-settings-popup-' + Math.round(Math.random() * 100000);\n\t\t\t\tthis.settingsPopup = new BX.PopupWindow(\n\t\t\t\t\tthis.settingsPopupId,\n\t\t\t\t\tnull,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: this.getSettingsContentNode(),\n\t\t\t\t\t\tclassName: 'calendar-resbook-webform-settings-popup-window',\n\t\t\t\t\t\tautoHide: false,\n\t\t\t\t\t\tlightShadow: true,\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\toverlay: {backgroundColor: 'black', opacity: 500},\n\t\t\t\t\t\tzIndex: -400,\n\t\t\t\t\t\ttitleBar: Loc.getMessage('WEBF_RES_SETTINGS'),\n\t\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\t\tbuttons : [new BX.PopupWindowButton({})]\n\t\t\t\t\t});\n\n\t\t\t\tlet buttonNodeWrap = this.settingsPopup.buttons[0].buttonNode.parentNode;\n\t\t\t\tDom.remove(this.settingsPopup.buttons[0].buttonNode);\n\t\t\t\tthis.settingsPopup.buttons[0].buttonNode = buttonNodeWrap.appendChild(Dom.create(\n\t\t\t\t\t\"button\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops : { className : 'ui-btn ui-btn-success'},\n\t\t\t\t\t\tevents: {click: function(){this.settingsPopup.close();}.bind(this)},\n\t\t\t\t\t\ttext : Loc.getMessage('WEBF_RES_CLOSE_SETTINGS_POPUP')\n\t\t\t\t\t}\n\t\t\t\t));\n\n\t\t\t\tBX.removeClass(this.settingsPopup.buttons[0].buttonNode, 'popup-window-button');\n\t\t\t\tthis.settingsPopup.show();\n\n\t\t\t\tBX.addCustomEvent(this.settingsPopup, 'onPopupClose', function(popup)\n\t\t\t\t{\n\t\t\t\t\tthis.destroyControls();\n\t\t\t\t\tthis.settingsPopup.destroy(this.id);\n\t\t\t\t\tthis.settingsPopup = null;\n\t\t\t\t\tif (this.previewFieldLayout)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.previewFieldLayout.destroy();\n\t\t\t\t\t}\n\t\t\t\t}.bind(this));\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tgetSettingsContentNode()\n\t{\n\t\tlet outerWrap = Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-settings-popup'}});\n\n\t\tlet leftWrap = outerWrap.appendChild(Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-settings-popup-inner'}}));\n\t\tthis.buildSettingsForm({wrap: leftWrap});\n\n\t\tlet previewWrap = outerWrap.appendChild(Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-settings-popup-preview'}}));\n\n\t\tthis.previewFieldLayout = new FieldViewControllerPreview({\n\t\t\twrap: previewWrap,\n\t\t\ttitle: this.getCaption(),\n\t\t\tsettings: this.getSettings()\n\t\t});\n\t\tthis.previewFieldLayout.build();\n\n\t\tBX.addCustomEvent('ResourceBooking.webformSettings:onChanged', this.handleWebformSettingsChanges.bind(this));\n\n\t\treturn outerWrap;\n\t}\n\n\tbuildSettingsForm(params)\n\t{\n\t\tlet\n\t\t\tsettings = this.getSettings(),\n\t\t\twrap = params.wrap,\n\t\t\ttitleId = 'title-' + this.id;\n\n\t\tthis.DOM.captionWrap = wrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-title'},\n\t\t\thtml: '<label for=\"' + titleId + '\" class=\"calendar-resbook-webform-settings-popup-label\">' + Loc.getMessage('WEBF_RES_NAME_LABEL') + '</label>'\n\t\t}));\n\t\tthis.DOM.captionInput = this.DOM.captionWrap.appendChild(Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tid: titleId,\n\t\t\t\tclassName: \"calendar-resbook-webform-settings-popup-input\",\n\t\t\t\ttype: \"text\",\n\t\t\t\tvalue: this.getCaption()\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tchange: this.updateCaption.bind(this),\n\t\t\t\tblur: this.updateCaption.bind(this),\n\t\t\t\tkeyup: this.updateCaption.bind(this)\n\t\t\t}\n\t\t}));\n\t\tthis.updateCaption();\n\n\t\tthis.DOM.fieldsOuterWrap = wrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-content'},\n\t\t\thtml: '<div class=\"calendar-resbook-webform-settings-popup-head\">' +\n\t\t\t\t'<div class=\"calendar-resbook-webform-settings-popup-head-inner\">' +\n\t\t\t\t'<span class=\"calendar-resbook-webform-settings-popup-head-text\">' + Loc.getMessage('WEBF_RES_FIELD_NAME') + '</span>' +\n\t\t\t\t'<span class=\"calendar-resbook-webform-settings-popup-head-decs\">' + Loc.getMessage('WEBF_RES_FIELD_NAME_IN_FORM') + '</span>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'<div class=\"calendar-resbook-webform-settings-popup-head-inner\">' +\n\t\t\t\t'<span class=\"calendar-resbook-webform-settings-popup-head-text\">' + Loc.getMessage('WEBF_RES_FIELD_SHOW_IN_FORM') + '</span>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'</div>'\n\t\t}));\n\n\t\tthis.DOM.fieldsWrap = this.DOM.fieldsOuterWrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-list'}\n\t\t}));\n\n\t\tif (settings.userfieldSettings.useUsers)\n\t\t{\n\t\t\tthis.buildComplexField('users', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.users,\n\t\t\t\tconfig: {\n\t\t\t\t\tusers: settings.userfieldSettings.users,\n\t\t\t\t\tselected: settings.data.users.value\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tBX.addCustomEvent('ResourceBooking.settingsUserSelector:onChanged', this.checkBitrix24Limitation.bind(this));\n\t\t}\n\n\t\tif (settings.userfieldSettings.useResources)\n\t\t{\n\t\t\tthis.buildComplexField('resources', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.resources,\n\t\t\t\tconfig: {\n\t\t\t\t\tresources: settings.userfieldSettings.resources,\n\t\t\t\t\tselected: settings.data.resources.value\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (settings.userfieldSettings.useServices)\n\t\t{\n\t\t\tthis.buildComplexField('services', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.services,\n\t\t\t\tconfig: {\n\t\t\t\t\tservices: settings.userfieldSettings.services,\n\t\t\t\t\tselected: settings.data.services.value\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buildComplexField('duration', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.duration\n\t\t\t});\n\t\t}\n\n\t\tthis.buildComplexField('date', {\n\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\tparams: settings.data.date\n\t\t});\n\n\t\tif (!settings.userfieldSettings.fullDay)\n\t\t{\n\t\t\tthis.buildComplexField('time', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.time\n\t\t\t});\n\t\t}\n\n\t\tthis.DOM.fieldsWrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-item'},\n\t\t\thtml: '<div class=\"calendar-resbook-webform-settings-popup-decs\">' +\n\t\t\t\t(Loc.getMessage('WEBF_RES_BOOKING_SETTINGS_HELP')\n\t\t\t\t\t.replace('#START_LINK#', '<a href=\"javascript:void(0);\"' +\n\t\t\t\t\t\t' onclick=\"if (top.BX.Helper){top.BX.Helper.show(\\'redirect=detail&code=8366733\\');}\">')\n\t\t\t\t\t.replace('#END_LINK#', '</a>')) +\n\t\t\t\t'</div>'\n\t\t}));\n\t}\n\n\tdestroyControls()\n\t{\n\t\tfor (let k in this.complexFields)\n\t\t{\n\t\t\tif (this.complexFields.hasOwnProperty(k) && Type.isFunction(this.complexFields[k].destroy))\n\t\t\t{\n\t\t\t\tthis.complexFields[k].destroy();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleWebformSettingsChanges()\n\t{\n\t\tif (this.refreshLayoutTimeout)\n\t\t{\n\t\t\tthis.refreshLayoutTimeout = clearTimeout(this.refreshLayoutTimeout);\n\t\t}\n\n\t\tthis.refreshLayoutTimeout = setTimeout(function()\n\t\t{\n\t\t\t// Update settings and inputs\n\t\t\tfor (let k in this.complexFields)\n\t\t\t{\n\t\t\t\tif (this.complexFields.hasOwnProperty(k) && Type.isFunction(this.complexFields[k].getValue))\n\t\t\t\t{\n\t\t\t\t\tthis.settingsData[k] = this.complexFields[k].getValue();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.updateSettingsDataInputs();\n\n\t\t\t// Refresh preview\n\t\t\tthis.previewFieldLayout.refreshLayout(this.settingsData);\n\t\t\t// Refresh form layout (behind the settings popup)\n\t\t\tthis.fieldLayout.refreshLayout(this.settingsData);\n\n\t\t\t// Small Hack to make form look better - height adjusment\n\t\t\tthis.previewFieldLayout.getOuterWrap().style.maxHeight = Math.round(this.previewFieldLayout.getInnerWrap().offsetHeight * 0.73) + 'px';\n\t\t}.bind(this), 100);\n\t}\n\n\tbuildComplexField(type, params)\n\t{\n\t\tswitch(type)\n\t\t{\n\t\t\tcase 'users':\n\t\t\t\tthis.complexFields[type] = new UserSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'resources':\n\t\t\t\tthis.complexFields[type] = new ResourceSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'services':\n\t\t\t\tthis.complexFields[type] = new ServiceSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'duration':\n\t\t\t\tthis.complexFields[type] = new DurationSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'date':\n\t\t\t \tthis.complexFields[type] = new DateSelectorFieldTunner();\n\t\t\t \tbreak;\n\t\t\tcase 'time':\n\t\t\t\tthis.complexFields[type] = new TimeSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (Type.isObject(this.complexFields[type]))\n\t\t{\n\t\t\tthis.complexFields[type].build(params);\n\t\t}\n\t}\n\n\tstatic getSettingsData(data)\n\t{\n\t\tlet\n\t\t\tfield, option,\n\t\t\tsettingsData = BX.clone(AdjustFieldController.getDefaultSettingsData(), true);\n\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tfor (field in data)\n\t\t\t{\n\t\t\t\tif (data.hasOwnProperty(field) && settingsData[field])\n\t\t\t\t{\n\t\t\t\t\tif (Type.isPlainObject(data[field]))\n\t\t\t\t\t{\n\t\t\t\t\t\tfor (option in data[field])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (data[field].hasOwnProperty(option))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tsettingsData[field][option] = data[field][option];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsettingsData[field] = data[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn settingsData;\n\t}\n\n\tstatic getDefaultSettingsData()\n\t{\n\t\treturn {\n\t\t\tusers : {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_USERS_LABEL'),\n\t\t\t\tdefaultMode: 'auto', // none|auto\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tresources: {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_RESOURCES_LABEL'),\n\t\t\t\tdefaultMode: 'auto', // none|auto\n\t\t\t\tmultiple: 'N',\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tservices: {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_SERVICE_LABEL'),\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tduration: {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_DURATION_LABEL'),\n\t\t\t\tdefaultValue: 60,\n\t\t\t\tmanualInput: 'N'\n\t\t\t},\n\t\t\tdate: {\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_DATE_LABEL'),\n\t\t\t\tstyle: 'line', // line|popup\n\t\t\t\tstart: 'today'\n\t\t\t},\n\t\t\ttime: {\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_TIME_LABEL'),\n\t\t\t\tstyle: 'slots',\n\t\t\t\tshowOnlyFree: 'Y',\n\t\t\t\tshowFinishTime: 'N',\n\t\t\t\tscale: 60\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSelectedUsers()\n\t{\n\t\treturn this.settingsData && this.settingsData.users && Type.isString(this.settingsData.users.value) ? this.settingsData.users.value.split('|') : [];\n\t}\n\n\tupdateSettingsDataInputs()\n\t{\n\t\tlet field, option;\n\t\tfor (field in this.settingsData)\n\t\t{\n\t\t\tif (this.settingsData.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tif (Type.isPlainObject(this.settingsData[field]))\n\t\t\t\t{\n\t\t\t\t\tfor (option in this.settingsData[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.settingsData[field].hasOwnProperty(option))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.updateSettingsInputValue([field, option], this.settingsData[field][option]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.updateSettingsInputValue([field], this.settingsData[field]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateSettingsInputValue(key, value)\n\t{\n\t\tlet uniKey = key.join('-');\n\t\tif (!this.DOM.settingsInputs[uniKey])\n\t\t{\n\t\t\tthis.DOM.settingsInputs[uniKey] = this.DOM.settingsWrap.appendChild(Dom.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"hidden\",\n\t\t\t\t\tname: this.params.formName + '[SETTINGS_DATA][' + key.join('][') + ']'\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tvalue = value.join('|');\n\t\t}\n\n\t\tthis.DOM.settingsInputs[uniKey].value = value;\n\t}\n\n\tshowFieldLoader()\n\t{\n\t\tif (this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.hideFieldLoader();\n\t\t\tthis.DOM.fieldLoader = this.DOM.innerWrap.appendChild(BookingUtil.getLoader(100));\n\t\t}\n\t}\n\n\thideFieldLoader()\n\t{\n\t\tDom.remove(this.DOM.fieldLoader);\n\t}\n\n\tgetSettings()\n\t{\n\t\tif (!this.params.settings.userfieldSettings)\n\t\t{\n\t\t\tthis.params.settings.userfieldSettings = {\n\t\t\t\tresources: this.userFieldParams.SETTINGS.SELECTED_RESOURCES,\n\t\t\t\tusers: this.userFieldParams.SETTINGS.SELECTED_USERS,\n\t\t\t\tservices: this.userFieldParams.SETTINGS.SERVICE_LIST,\n\t\t\t\tfullDay: this.userFieldParams.SETTINGS.FULL_DAY === 'Y',\n\t\t\t\tuseResources: this.userFieldParams.SETTINGS.USE_RESOURCES === 'Y'\n\t\t\t\t\t&& this.userFieldParams.SETTINGS.SELECTED_RESOURCES.length,\n\t\t\t\tuseUsers: this.userFieldParams.SETTINGS.USE_USERS === 'Y',\n\t\t\t\tuseServices: this.userFieldParams.SETTINGS.USE_SERVICES === 'Y',\n\t\t\t\tresourceLimit: this.userFieldParams.SETTINGS.RESOURCE_LIMIT,\n\t\t\t\tuserIndex: this.userFieldParams.SETTINGS.USER_INDEX\n\t\t\t}\n\t\t}\n\n\t\treturn this.params.settings;\n\t}\n\n\tupdateSettings(settings)\n\t{\n\t}\n\n\tgetCaption()\n\t{\n\t\treturn this.params.settings.caption;\n\t}\n\n\tupdateCaption()\n\t{\n\t\tlet caption = this.DOM.captionInput.value;\n\t\tif (this.params.settings.caption !== caption || !this.DOM.settingsInputs.caption)\n\t\t{\n\t\t\tthis.params.settings.caption = caption;\n\t\t\tif (this.previewFieldLayout)\n\t\t\t{\n\t\t\t\tthis.previewFieldLayout.updateTitle(this.params.settings.caption);\n\t\t\t}\n\n\t\t\t// Update title\n\t\t\tif (!this.DOM.settingsInputs.caption)\n\t\t\t{\n\t\t\t\tthis.DOM.settingsInputs.caption = this.DOM.settingsWrap.appendChild(Dom.create(\"input\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\ttype: \"hidden\",\n\t\t\t\t\t\tname: this.params.formName + '[CAPTION]'\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t\tthis.DOM.settingsInputs.caption.value = this.params.settings.caption;\n\n\t\t\tif (this.DOM.captionNode)\n\t\t\t{\n\t\t\t\tDom.adjust(this.DOM.captionNode, {text: this.params.settings.caption});\n\t\t\t}\n\t\t}\n\t}\n\n\tisRequired()\n\t{\n\t\treturn this.params.settings.required === 'Y';\n\t}\n\n\tupdateRequiredValue()\n\t{\n\t\tthis.params.settings.required = this.DOM.requiredCheckbox.checked ? 'Y' : 'N';\n\t\tif (!this.DOM.settingsInputs.required)\n\t\t{\n\t\t\tthis.DOM.settingsInputs.required = this.DOM.settingsWrap.appendChild(Dom.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"hidden\",\n\t\t\t\t\tname: this.params.formName + '[REQUIRED]'\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t\tthis.DOM.settingsInputs.required.value = this.params.settings.required;\n\t}\n\n\tcheckBitrix24Limitation()\n\t{\n\t\tlet\n\t\t\tcount = 0,\n\t\t\tsettings = this.getSettings();\n\n\t\tif (Type.isArray(this.params.settings.userfieldSettings.resources))\n\t\t{\n\t\t\tcount += this.params.settings.userfieldSettings.resources.length;\n\t\t}\n\n\t\tif (settings.userfieldSettings.useUsers && this.complexFields.users)\n\t\t{\n\t\t\tlet usersValue = this.complexFields.users.getValue();\n\t\t\tif (usersValue && Type.isArray(usersValue.value))\n\t\t\t{\n\t\t\t\tcount += usersValue.value.length;\n\t\t\t}\n\t\t}\n\n\t\tif (settings.userfieldSettings.resourceLimit > 0 && count > settings.userfieldSettings.resourceLimit)\n\t\t{\n\t\t\tBookingUtil.showLimitationPopup();\n\t\t}\n\t}\n}","import {BookingUtil} from \"calendar.resourcebooking\";\n\nexport class ResourceSelectorFieldEditControl\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params || {};\n\t\tthis.editMode = !!this.params.editMode;\n\t\tthis.id = this.params.id || 'resource-selector-' + Math.round(Math.random() * 100000);\n\t\tthis.resourceList = BX.type.isArray(params.resourceList) ? params.resourceList : [];\n\t\tthis.checkLimit = BX.type.isFunction(params.checkLimitCallback) ? params.checkLimitCallback : false;\n\t\tthis.checkLimitForNew = BX.type.isFunction(params.checkLimitCallbackForNew) ? params.checkLimitCallbackForNew : false;\n\n\t\tthis.selectedValues = [];\n\t\tthis.selectedValuesIndex = {};\n\n\t\tthis.selectedBlocks = [];\n\t\tthis.newValues = [];\n\n\t\tthis.DOM = {\n\t\t\touterWrap: this.params.outerWrap,\n\t\t\tblocksWrap: this.params.blocksWrap || false,\n\t\t\tlistWrap: this.params.listWrap\n\t\t};\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tthis.DOM.controlsWrap = this.params.controlsWrap;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.arrowNode = BX.create(\"span\", {props: {className: \"calendar-resourcebook-content-block-detail-icon calendar-resourcebook-content-block-detail-icon-arrow\"}});\n\t\t}\n\n\t\tthis.onChangeCallback = this.params.onChangeCallback || null;\n\n\t\tthis.create();\n\t\tthis.setValues(params.values);\n\t}\n\n\n\tcreate ()\n\t{\n\t\tBX.addClass(this.DOM.outerWrap, 'calendar-resourcebook-resource-list-wrap calendar-resourcebook-folding-block' + (this.params.shown !== false ? ' shown' : ''));\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tthis.DOM.addButton = this.DOM.controlsWrap.appendChild(BX.create(\"span\", {\n\t\t\t\tprops: {className: \"calendar-resource-content-block-add-link\"},\n\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_ADD'),\n\t\t\t\tevents: {click: BX.delegate(this.addResourceBlock, this)}\n\t\t\t}));\n\n\t\t\tif (this.resourceList.length > 0)\n\t\t\t{\n\t\t\t\tthis.DOM.selectButton = this.DOM.controlsWrap.appendChild(BX.create(\"span\", {\n\t\t\t\t\tprops: {className: \"calendar-resource-content-block-add-link\"},\n\t\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_SELECT'),\n\t\t\t\t\tevents: {click: BX.delegate(this.openResourcesPopup, this)}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.bind(this.DOM.blocksWrap, 'click', BX.delegate(this.handleBlockClick, this));\n\t\t}\n\t}\n\n\tshow ()\n\t{\n\t\tBX.addClass(this.DOM.outerWrap, 'shown');\n\t}\n\n\thide ()\n\t{\n\t\tthis.DOM.outerWrap.style.maxHeight = '';\n\t\tBX.removeClass(this.DOM.outerWrap, 'shown');\n\t}\n\n\tisShown ()\n\t{\n\t\treturn BX.hasClass(this.DOM.outerWrap, 'shown');\n\t}\n\n\thandleBlockClick (e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\n\t\tif (target)\n\t\t{\n\t\t\tlet blockValue = target.getAttribute('data-bx-remove-block');\n\t\t\tif (blockValue)\n\t\t\t{\n\t\t\t\t// Remove from blocks\n\t\t\t\tthis.selectedBlocks.find(function(element, index)\n\t\t\t\t{\n\t\t\t\t\tif (element.value === blockValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(element.wrap, 'shown');\n\t\t\t\t\t\tsetTimeout(BX.delegate(function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.remove(element.wrap)\n\t\t\t\t\t\t}, this), 300);\n\n\t\t\t\t\t\tthis.selectedBlocks = BX.util.deleteFromArray(this.selectedBlocks, index);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\n\t\t\t\t// Remove from values\n\t\t\t\tthis.selectedValues.find(function(element, index)\n\t\t\t\t{\n\t\t\t\t\tif (element.title === blockValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selectedValues = BX.util.deleteFromArray(this.selectedValues, index);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\n\t\t\t\tif (BX.type.isFunction(this.onChangeCallback))\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t\t\t}\n\n\t\t\t\tthis.checkBlockWrapState();\n\t\t\t}\n\n\t\t\tif (!blockValue)\n\t\t\t{\n\t\t\t\tthis.openResourcesPopup();\n\t\t\t}\n\t\t}\n\t}\n\n\topenResourcesPopup ()\n\t{\n\t\tif (!this.resourceList.length)\n\t\t{\n\t\t\treturn this.addResourceBlock();\n\t\t}\n\n\t\tif (this.isResourcesPopupShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menuItems = [];\n\n\t\tthis.resourceList.forEach(function(resource)\n\t\t{\n\t\t\tif (resource.deleted)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: BX.util.htmlspecialchars(resource.title),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: resource.type,\n\t\t\t\t\tid: resource.id,\n\t\t\t\t\ttitle: resource.title\n\t\t\t\t},\n\t\t\t\tonclick: BX.delegate(function(e, menuItem)\n\t\t\t\t{\n\t\t\t\t\tlet\n\t\t\t\t\t\tselectAllcheckbox,\n\t\t\t\t\t\ttarget = e.target || e.srcElement,\n\t\t\t\t\t\tcheckbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox'),\n\t\t\t\t\t\tfoundResource = this.resourceList.find(function(resource)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn parseInt(resource.id) === parseInt(menuItem.dataset.id)\n\t\t\t\t\t\t\t\t&& resource.type === menuItem.dataset.type;\n\t\t\t\t\t\t}, this);\n\n\t\t\t\t\tif (foundResource)\n\t\t\t\t\t{\n\t\t\t\t\t\t// Complete removing of the resource\n\t\t\t\t\t\tif (target && BX.hasClass(target, \"calendar-resourcebook-content-block-control-delete\"))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.removeResourceBlock({\n\t\t\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\t\tthis.checkResourceInputs();\n\n\t\t\t\t\t\t\tselectAllcheckbox = this.popupContainer.querySelector('.menu-popup-item-all-resources-checkbox');\n\t\t\t\t\t\t\tthis.selectAllChecked = false;\n\t\t\t\t\t\t\tif (selectAllcheckbox)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tselectAllcheckbox.checked = false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet menuItemNode = BX.findParent(target, {className: 'menu-popup-item'});\n\t\t\t\t\t\t\tif (menuItemNode)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.addClass(menuItemNode, 'menu-popup-item-resource-remove-loader');\n\n\t\t\t\t\t\t\t\tmenuItemNode.appendChild(BookingUtil.getLoader(25));\n\t\t\t\t\t\t\t\tlet textNode = menuItemNode.querySelector('.menu-popup-item-text');\n\t\t\t\t\t\t\t\tif (textNode)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttextNode.innerHTML = BX.message('USER_TYPE_RESOURCE_DELETING');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfoundResource.deleted = true;\n\t\t\t\t\t\t\tsetTimeout(BX.delegate(function()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (menuItemNode)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmenuItemNode.style.maxHeight = '0';\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (!this.resourceList.find(function(resource){return !resource.deleted;}))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.PopupMenu.destroy(this.id);\n\t\t\t\t\t\t\t\t\tthis.DOM.selectButton.style.opacity = 0;\n\n\t\t\t\t\t\t\t\t\tsetTimeout(BX.delegate(function(){BX.remove(this.DOM.selectButton);}, this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, this), 500);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (target && (BX.hasClass(target, \"menu-popup-item\") || BX.hasClass(target, \"menu-popup-item-resource-checkbox\") || BX.hasClass(target, \"menu-popup-item-inner\") ))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!BX.hasClass(target, \"menu-popup-item-resource-checkbox\"))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (checkbox.checked)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.addResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\t\t\t\tvalue: foundResource.title,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.removeResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\t\t\tthis.checkResourceInputs();\n\n\t\t\t\t\t\t\t\tselectAllcheckbox = this.popupContainer.querySelector('.menu-popup-item-all-resources-checkbox');\n\t\t\t\t\t\t\t\tthis.selectAllChecked = false;\n\t\t\t\t\t\t\t\tif (selectAllcheckbox)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tselectAllcheckbox.checked = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, this)\n\t\t\t});\n\t\t}, this);\n\n\t\tif (menuItems.length > 1)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_SELECT_ALL'),\n\t\t\t\tonclick: BX.delegate(function(e, menuItem)\n\t\t\t\t{\n\t\t\t\t\tlet target = e.target || e.srcElement;\n\t\t\t\t\tif (target && (BX.hasClass(target, \"menu-popup-item\") || BX.hasClass(target, \"menu-popup-item-resource-checkbox\")))\n\t\t\t\t\t{\n\t\t\t\t\t\tlet checkbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox');\n\n\t\t\t\t\t\tif (BX.hasClass(target, \"menu-popup-item\"))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet i, checkboxes = this.popupContainer.querySelectorAll('input.menu-popup-item-resource-checkbox');\n\t\t\t\t\t\tthis.selectAllChecked = checkbox.checked;\n\n\t\t\t\t\t\tfor (i = 0; i < checkboxes.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcheckboxes[i].checked = this.selectAllChecked;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.resourceList.forEach(function(resource){\n\t\t\t\t\t\t\tif (resource.deleted)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (this.selectAllChecked)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.addResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: resource,\n\t\t\t\t\t\t\t\t\tvalue: resource.title,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.removeResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: resource,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this);\n\n\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\tthis.checkResourceInputs();\n\t\t\t\t\t}\n\t\t\t\t}, this)\n\t\t\t});\n\t\t}\n\n\t\tthis.popup = BX.PopupMenu.create(\n\t\t\tthis.id,\n\t\t\tthis.DOM.selectButton || this.DOM.blocksWrap,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tclassName: 'popup-window-resource-select',\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : false,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.show(true);\n\t\tthis.popupContainer = this.popup.popupWindow.popupContainer;\n\t\tif (!this.editMode)\n\t\t{\n\t\t\tthis.popupContainer.style.width = parseInt(this.DOM.blocksWrap.offsetWidth) + 'px';\n\t\t}\n\n\t\tBX.addCustomEvent(this.popup.popupWindow, 'onPopupClose', BX.proxy(function(){BX.PopupMenu.destroy(this.id);}, this));\n\n\t\tthis.popup.menuItems.forEach(function(menuItem)\n\t\t{\n\t\t\tlet checked;\n\t\t\tif (menuItem.dataset && menuItem.dataset.type)\n\t\t\t{\n\t\t\t\tchecked = this.selectedValues.find(function(item)\n\t\t\t\t{\n\t\t\t\t\treturn parseInt(item.id) === parseInt(menuItem.dataset.id)\n\t\t\t\t\t\t&& item.type === menuItem.dataset.type;\n\t\t\t\t});\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox\" type=\"checkbox\"' + (checked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + BX.util.htmlspecialchars(menuItem.dataset.title) + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t(this.editMode ? '<div class=\"calendar-resourcebook-content-block-control-delete\"></div>' : '') +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selectAllChecked = !this.resourceList.find(function(resource){\n\t\t\t\t\treturn !this.selectedValues.find(function(item)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn parseInt(item.id) === parseInt(resource.id)\n\t\t\t\t\t\t\t&& item.type === resource.type\n\t\t\t\t\t});\n\t\t\t\t},this);\n\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item menu-popup-item-resource-all';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox menu-popup-item-all-resources-checkbox\" type=\"checkbox\"' + (this.selectAllChecked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + BX.message('USER_TYPE_RESOURCE_SELECT_ALL') + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t}, this);\n\n\t\tsetTimeout(BX.delegate(function(){\n\t\t\tBX.bind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}, this), 50);\n\t}\n\n\taddResourceBlock(params)\n\t{\n\t\tif (!BX.type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif ((params.resource && (this.checkLimit && !this.checkLimit() && window.B24))\n\t\t\t||\n\t\t\t(!params.resource && (this.checkLimitForNew && !this.checkLimitForNew() && window.B24)))\n\t\t{\n\t\t\treturn BookingUtil.showLimitationPopup();\n\t\t}\n\n\t\tlet\n\t\t\t_this = this,\n\t\t\tblockEntry;\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tif (params.resource && this.selectedValues.find(function(val)\n\t\t\t{\n\t\t\t\treturn val.id && parseInt(val.id) === parseInt(params.resource.id)\n\t\t\t\t\t&& val.type === params.resource.type;\n\t\t\t}))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!params.value)\n\t\t\t{\n\t\t\t\tparams.value = '';\n\t\t\t}\n\n\t\t\tblockEntry = {\n\t\t\t\tvalue: params.value,\n\t\t\t\twrap : this.DOM.listWrap\n\t\t\t\t\t.appendChild(BX.create(\"div\", {props:{className: \"calendar-resourcebook-content-block-detail calendar-resourcebook-outer-resource-wrap\"}}))\n\t\t\t\t\t.appendChild(BX.create(\"div\", {props:{className: \"calendar-resourcebook-content-block-detail-resource\"}}))\n\t\t\t\t\t.appendChild(BX.create(\"div\", {props:{className: \"calendar-resourcebook-content-block-detail-resource-inner calendar-resourcebook-content-block-detail-resource-inner-wide\"}}))\n\t\t\t};\n\n\t\t\tblockEntry.input = blockEntry.wrap.appendChild(BX.create(\"input\", {\n\t\t\t\tprops:{\n\t\t\t\t\tclassName: \"calendar-resourcebook-content-input\",\n\t\t\t\t\tvalue: params.value,\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tplaceholder: BX.message('USER_TYPE_RESOURCE_NAME')\n\t\t\t\t},\n\t\t\t\tdataset: {\n\t\t\t\t\tresourceType: params.resource ? params.resource.type : '',\n\t\t\t\t\tresourceId: params.resource ? params.resource.id : ''\n\t\t\t\t}\n\t\t\t}));\n\t\t\tblockEntry.delButton = blockEntry.wrap.appendChild(BX.create(\"div\", {\n\t\t\t\tprops:{className: \"calendar-resourcebook-content-block-control-delete\"},\n\t\t\t\tevents: {click(){\n\t\t\t\t\t\tBX.remove(BX.findParent(this, {className: 'calendar-resourcebook-outer-resource-wrap'}));\n\t\t\t\t\t\t_this.selectedValues = _this.getSelectedValues();\n\t\t\t\t\t\t_this.checkResourceInputs();\n\t\t\t\t\t}}\n\t\t\t}));\n\n\t\t\tif (params.focusInput !== false)\n\t\t\t{\n\t\t\t\tBX.focus(blockEntry.input);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (params.value && this.selectedBlocks.find(function(val){return val.value && val.value === params.value;}))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tblockEntry = {\n\t\t\t\tvalue: params.value,\n\t\t\t\tresource: params.resource || false,\n\t\t\t\twrap : this.DOM.blocksWrap.appendChild(BX.create(\"div\", {\n\t\t\t\t\tprops:{\n\t\t\t\t\t\tclassName: \"calendar-resourcebook-content-block-control-inner\"\n\t\t\t\t\t\t\t+ (params.animation ? '' : ' shown')\n\t\t\t\t\t\t\t+ (params.transparent ? ' transparent' : '')\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"div\", {\n\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-control-text\"},\n\t\t\t\t\t\t\ttext: params.value || ''\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create(\"div\", {\n\t\t\t\t\t\t\tattrs: {'data-bx-remove-block': params.value},\n\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-control-delete\"}\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}))\n\t\t\t};\n\n\t\t\tthis.selectedBlocks.push(blockEntry);\n\n\t\t\t// Show it with animation\n\t\t\tif (params.animation)\n\t\t\t{\n\t\t\t\tsetTimeout(BX.delegate(function ()\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(blockEntry.wrap, 'shown');\n\t\t\t\t}, this), 1);\n\t\t\t}\n\n\t\t\tif (params.trigerOnChange !== false && this.onChangeCallback && BX.type.isFunction(this.onChangeCallback))\n\t\t\t{\n\t\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t\t}\n\n\t\t\tthis.checkBlockWrapState();\n\t\t}\n\n\t\t// Adjust outer wrap max height\n\t\tif (this.DOM.listWrap && this.DOM.outerWrap)\n\t\t{\n\t\t\tif (BX.hasClass(this.DOM.outerWrap, 'shown'))\n\t\t\t{\n\t\t\t\tthis.DOM.outerWrap.style.maxHeight = Math.max(10000, this.DOM.listWrap.childNodes.length * 45 + 100) + 'px';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.outerWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}\n\n\t\treturn blockEntry;\n\t}\n\n\tremoveResourceBlock(params)\n\t{\n\t\tif (this.editMode)\n\t\t{\n\t\t\tlet\n\t\t\t\tresourceType, resourceId,\n\t\t\t\ti, inputs = this.DOM.listWrap.querySelectorAll('.calendar-resourcebook-content-input');\n\n\t\t\tfor (i = 0; i < inputs.length; i++)\n\t\t\t{\n\t\t\t\tresourceType = inputs[i].getAttribute('data-resource-type');\n\t\t\t\tresourceId = inputs[i].getAttribute('data-resource-id');\n\t\t\t\tif (resourceType === params.resource.type && parseInt(resourceId) === parseInt(params.resource.id))\n\t\t\t\t{\n\t\t\t\t\tBX.remove(BX.findParent(inputs[i], {className: 'calendar-resourcebook-outer-resource-wrap'}));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (params.resource)\n\t\t\t{\n\t\t\t\tthis.selectedBlocks.find(function(element, index)\n\t\t\t\t{\n\t\t\t\t\tif (element.value === params.resource.title)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(element.wrap, 'shown');\n\t\t\t\t\t\tsetTimeout(BX.delegate(function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.remove(element.wrap)\n\t\t\t\t\t\t}, this), 300);\n\n\t\t\t\t\t\tthis.selectedBlocks = BX.util.deleteFromArray(this.selectedBlocks, index);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\t\t\t}\n\t\t\tthis.checkBlockWrapState();\n\n\t\t\tif (params.trigerOnChange !== false && this.onChangeCallback && BX.type.isFunction(this.onChangeCallback))\n\t\t\t{\n\t\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckResourceInputs()\n\t{\n\t\tif (this.editMode)\n\t\t{\n\t\t\tif (!this.selectedValues.length)\n\t\t\t{\n\t\t\t\tthis.addResourceBlock({animation: true});\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckBlockWrapState()\n\t{\n\t\tif (!this.editMode)\n\t\t{\n\t\t\tif (!this.selectedBlocks.length)\n\t\t\t{\n\t\t\t\tif (!this.DOM.emptyPlaceholder)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.emptyPlaceholder = this.DOM.blocksWrap.appendChild(\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops : {className : \"calendar-resourcebook-content-block-control-empty\"},\n\t\t\t\t\t\t\thtml: '<span class=\"calendar-resourcebook-content-block-control-text\">' + BX.message('USER_TYPE_RESOURCE_LIST_PLACEHOLDER') + '</span>'\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.emptyPlaceholder.className = \"calendar-resourcebook-content-block-control-empty\";\n\t\t\t\t\tthis.DOM.blocksWrap.appendChild(this.DOM.emptyPlaceholder);\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(BX.delegate(function(){\n\t\t\t\t\tif (BX.isNodeInDom(this.DOM.emptyPlaceholder))\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.addClass(this.DOM.emptyPlaceholder, 'show');\n\t\t\t\t\t}\n\t\t\t\t}, this), 50);\n\t\t\t}\n\t\t\telse if (this.DOM.emptyPlaceholder)\n\t\t\t{\n\t\t\t\tBX.remove(this.DOM.emptyPlaceholder);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (this.isResourcesPopupShown() && !BX.isParentForNode(this.popupContainer, target)\n\t\t)\n\t\t{\n\t\t\tthis.closeResourcesPopup({animation: true});\n\t\t}\n\t}\n\n\tisResourcesPopupShown()\n\t{\n\t\treturn this.popup && this.popup.popupWindow &&\n\t\t\tthis.popup.popupWindow.isShown && this.popup.popupWindow.isShown() &&\n\t\t\tthis.popup.popupWindow.popupContainer &&\n\t\t\tBX.isNodeInDom(this.popup.popupWindow.popupContainer)\n\t}\n\n\tcloseResourcesPopup(params)\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.close();\n\t\t\tthis.popupContainer.style.maxHeight = '';\n\t\t\tBX.unbind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}\n\t}\n\n\tgetValues()\n\t{\n\t\treturn this.resourceList;\n\t}\n\n\taddToSelectedValues(value)\n\t{\n\t\tif (!this.selectedValues.find(function(val){return parseInt(val.id) === parseInt(value.id) && val.type === value.type;}))\n\t\t{\n\t\t\tthis.selectedValues.push(value);\n\t\t}\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\tthis.selectedValues = [];\n\t\tif (this.editMode)\n\t\t{\n\t\t\tlet\n\t\t\t\tresourceType, resourceId, i,\n\t\t\t\tinputs = this.DOM.listWrap.querySelectorAll('.calendar-resourcebook-content-input');\n\n\t\t\tfor (i = 0; i < inputs.length; i++)\n\t\t\t{\n\t\t\t\tresourceType = inputs[i].getAttribute('data-resource-type');\n\t\t\t\tresourceId = inputs[i].getAttribute('data-resource-id');\n\t\t\t\tif (resourceType && resourceId)\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push({type: resourceType, id: resourceId, title: inputs[i].value});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push({type: 'resource', title: inputs[i].value});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selectedBlocks.forEach(function(element){\n\t\t\t\tthis.selectedValues.push({type: element.resource.type, id: element.resource.id});\n\t\t\t}, this);\n\t\t}\n\n\t\treturn this.selectedValues;\n\t}\n\n\tgetDeletedValues()\n\t{\n\t\treturn this.resourceList.filter(function(resource){return resource.deleted;});\n\t}\n\n\tsetValues(values, trigerOnChange)\n\t{\n\t\tthis.selectedBlocks.forEach(function(element){BX.remove(element.wrap);});\n\t\tthis.selectedBlocks = [];\n\t\ttrigerOnChange = trigerOnChange !== false;\n\n\t\tif (BX.type.isArray(values))\n\t\t{\n\t\t\tvalues.forEach(function(value)\n\t\t\t{\n\t\t\t\tlet foundResource = this.resourceList.find(function(resource)\n\t\t\t\t{\n\t\t\t\t\treturn parseInt(resource.id) === parseInt(value.id) && resource.type === value.type;\n\t\t\t\t}, this);\n\n\t\t\t\tif (foundResource)\n\t\t\t\t{\n\t\t\t\t\tthis.addResourceBlock({\n\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\tvalue: foundResource.title,\n\t\t\t\t\t\ttrigerOnChange: trigerOnChange\n\t\t\t\t\t});\n\t\t\t\t\tthis.addToSelectedValues(foundResource);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\tthis.checkResourceInputs();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.DOM.arrowNode)\n\t\t\t{\n\t\t\t\tthis.DOM.blocksWrap.appendChild(this.DOM.arrowNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.checkBlockWrapState();\n\t}\n}","import {Type, Dom, Event, BookingUtil} from \"calendar.resourcebooking\";\n\nexport class PlannerPopup\n{\n\tconstructor(params)\n\t{\n\t}\n\n\tshow (params)\n\t{\n\t\tif (!params)\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\t\tthis.params = params;\n\t\tthis.bindNode = params.bindNode;\n\t\tthis.plannerId = this.params.plannerId;\n\t\tthis.config = this.params.plannerConfig;\n\n\t\tif (this.isShown() || !this.bindNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.lastPlannerIdShown && this.lastPlannerIdShown !== this.plannerId)\n\t\t{\n\t\t\tthis.close({animation: false});\n\t\t}\n\n\t\tthis.currentEntries = [];\n\n\t\tthis.plannerWrap = Dom.create('DIV', {\n\t\t\tattrs: {\n\t\t\t\tid: this.plannerId,\n\t\t\t\tclassName: 'calendar-planner-wrapper'\n\t\t\t}\n\t\t});\n\n\t\tthis.popup = new BX.PopupWindow(this.plannerId + \"_popup\",\n\t\t\tthis.bindNode,\n\t\t\t{\n\t\t\t\tautoHide: false,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: - parseInt(this.bindNode.offsetHeight) - 20,\n\t\t\t\toffsetLeft: this.bindNode.offsetWidth + 38,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: this.plannerWrap\n\t\t\t});\n\n\t\tthis.popup.setAngle({offset: 100, position: 'left'});\n\t\tthis.popup.show(true);\n\t\tthis.lastPlannerIdShown = this.plannerId;\n\n\t\tlet\n\t\t\tbindPos = BX.pos(this.bindNode),\n\t\t\twinSize = BX.GetWindowSize();\n\n\t\tthis.plannerWidth = winSize.innerWidth - bindPos.right - 160;\n\t\tthis.config.width = this.plannerWidth;\n\n\t\tsetTimeout(function(){\n\t\t\tif (this.popup && this.popup.popupContainer)\n\t\t\t{\n\t\t\t\tDom.addClass(this.popup.popupContainer, 'calendar-resbook-planner-popup');\n\t\t\t\tthis.popup.popupContainer.style.width = 0;\n\t\t\t}\n\t\t}.bind(this), 1);\n\n\t\tsetTimeout(function(){\n\t\t\tif (this.popup && this.popup.popupContainer)\n\t\t\t{\n\t\t\t\tthis.popup.popupContainer.style.width = (this.plannerWidth + 40) + 'px';\n\t\t\t\tDom.addClass(this.popup.popupContainer, 'show');\n\t\t\t}\n\t\t\tEvent.bind(document, 'click', this.handleClick.bind(this));\n\t\t}.bind(this), 50);\n\t\tsetTimeout(this.showPlanner.bind(this), 350);\n\n\t\tBX.addCustomEvent(this.popup, 'onPopupClose', this.close.bind(this));\n\t}\n\n\tupdate (params, refreshParams)\n\t{\n\t\tif (!this.isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet\n\t\t\tcodes = [], i, k, code,\n\t\t\tcodeIndex = {},\n\t\t\tplannerConfig = BX.clone(this.config, true),\n\t\t\tfromTimestamp, toTimestamp,\n\t\t\tdateFrom, dateTo;\n\n\t\tif (Type.isPlainObject(this.lastUpdateParams) && Type.isPlainObject(params) && refreshParams !== true)\n\t\t{\n\t\t\tfor (k in params)\n\t\t\t{\n\t\t\t\tif (params.hasOwnProperty(k))\n\t\t\t\t{\n\t\t\t\t\tthis.lastUpdateParams[k] = params[k];\n\t\t\t\t}\n\t\t\t}\n\t\t\tparams = this.lastUpdateParams;\n\t\t}\n\n\t\t// Save selector information\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tthis.lastUpdateParams = params;\n\t\t}\n\n\t\tparams.focusSelector = params.focusSelector !== false;\n\n\t\tif (params.from && params.to)\n\t\t{\n\t\t\tdateFrom = BookingUtil.parseDate(params.from);\n\t\t\tdateTo = BookingUtil.parseDate(params.to);\n\t\t\tfromTimestamp = dateFrom.getTime();\n\t\t\ttoTimestamp = dateTo.getTime();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (params.selector.fullDay)\n\t\t\t{\n\t\t\t\tfromTimestamp = params.selector.from.getTime() - BookingUtil.getDayLength() * 12;\n\t\t\t\ttoTimestamp = params.selector.from.getTime() + BookingUtil.getDayLength() * 14;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfromTimestamp = params.selector.from.getTime() - BookingUtil.getDayLength() * 3;\n\t\t\t\ttoTimestamp = params.selector.from.getTime() + BookingUtil.getDayLength() * 5;\n\t\t\t}\n\n\t\t\tdateFrom = new Date(fromTimestamp);\n\t\t\tdateTo = new Date(toTimestamp);\n\n\t\t\tplannerConfig.scaleDateFrom = dateFrom;\n\t\t\tplannerConfig.scaleDateTo = dateTo;\n\t\t}\n\n\t\tif (Type.isArray(params.userList))\n\t\t{\n\t\t\tfor (i = 0; i < params.userList.length; i++)\n\t\t\t{\n\t\t\t\tcode = 'U' + params.userList[i].id;\n\t\t\t\tif (!codeIndex[code])\n\t\t\t\t{\n\t\t\t\t\tcodes.push(code);\n\t\t\t\t\tcodeIndex[code] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isArray(params.selectedUsers))\n\t\t{\n\t\t\tfor (i = 0; i < params.selectedUsers.length; i++)\n\t\t\t{\n\t\t\t\tcode = 'U' + params.selectedUsers[i];\n\t\t\t\tif (!codeIndex[code])\n\t\t\t\t{\n\t\t\t\t\tcodes.push(code);\n\t\t\t\t\tcodeIndex[code] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet requestData = {\n\t\t\tcodes: codes,\n\t\t\tresources: params.resourceList,\n\t\t\tfrom: BookingUtil.formatDate(null, fromTimestamp / 1000),\n\t\t\tto: BookingUtil.formatDate(null, toTimestamp / 1000),\n\t\t\tcurrentEventList: this.params.currentEventList || []\n\t\t};\n\n\t\tif (this.checkUpdateParams(requestData) && this.isShown())\n\t\t{\n\t\t\tthis.showPlannerLoader();\n\t\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getplannerdata', {\n\t\t\t\tdata: requestData\n\t\t\t}).then(function (response)\n\t\t\t\t{\n\t\t\t\t\tthis.hidePlannerLoader();\n\n\t\t\t\t\tif (this.lastRequestData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.lastRequestData.response = response;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.currentEntries = response.data.entries;\n\t\t\t\t\tthis.currentAccessibility = response.data.accessibility;\n\t\t\t\t\tthis.currentLoadedDataFrom = dateFrom;\n\t\t\t\t\tthis.currentLoadedDataTo = dateTo;\n\n\t\t\t\t\tif (Type.isArray(response.data.entries))\n\t\t\t\t\t{\n\t\t\t\t\t\tresponse.data.entries.forEach(function(entry)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentry.selected = ((entry.type === 'user'\n\t\t\t\t\t\t\t\t&& params.selectedUsers.find(function(userId){return parseInt(entry.id) === parseInt(userId);}))\n\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\t(entry.type === 'resource'\n\t\t\t\t\t\t\t\t\t&& params.selectedResources.find(function(item){return entry.type === item.type && parseInt(entry.id) === parseInt(item.id);}))\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.isShown())\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.onCustomEvent('OnCalendarPlannerDoUpdate', [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tplannerId: this.plannerId,\n\t\t\t\t\t\t\t\tconfig: plannerConfig,\n\t\t\t\t\t\t\t\tfocusSelector: params.focusSelector,\n\t\t\t\t\t\t\t\tselector: {\n\t\t\t\t\t\t\t\t\tfrom: params.selector.from,\n\t\t\t\t\t\t\t\t\tto: params.selector.to,\n\t\t\t\t\t\t\t\t\tfullDay: params.selector.fullDay,\n\t\t\t\t\t\t\t\t\tanimation: params.focusSelector,\n\t\t\t\t\t\t\t\t\tupdateScaleLimits: params.focusSelector\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tentries: response.data.entries,\n\t\t\t\t\t\t\t\t\taccessibility: response.data.accessibility\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tloadedDataFrom: dateFrom,\n\t\t\t\t\t\t\t\tloadedDataTo: dateTo,\n\t\t\t\t\t\t\t\tshow: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]);\n\t\t\t\t\t}\n\t\t\t\t}.bind(this));\n\t\t}\n\t\telse if (Type.isPlainObject(this.lastRequestData.response))\n\t\t{\n\t\t\tlet response = this.lastRequestData.response;\n\t\t\tthis.currentEntries = response.data.entries;\n\t\t\tthis.currentAccessibility = response.data.accessibility;\n\t\t\tthis.currentLoadedDataFrom = dateFrom;\n\t\t\tthis.currentLoadedDataTo = dateTo;\n\n\t\t\tif (Type.isArray(response.data.entries))\n\t\t\t{\n\t\t\t\tresponse.data.entries.forEach(function(entry)\n\t\t\t\t{\n\t\t\t\t\tentry.selected = ((entry.type === 'user'\n\t\t\t\t\t\t&& params.selectedUsers.find(function(userId){return parseInt(entry.id) === parseInt(userId);}))\n\t\t\t\t\t\t||\n\t\t\t\t\t\t(entry.type === 'resource'\n\t\t\t\t\t\t\t&& params.selectedResources.find(function(item){return entry.type === item.type && parseInt(entry.id) === parseInt(item.id);}))\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.isShown())\n\t\t\t{\n\t\t\t\tBX.onCustomEvent('OnCalendarPlannerDoUpdate', [\n\t\t\t\t\t{\n\t\t\t\t\t\tplannerId: this.plannerId,\n\t\t\t\t\t\tconfig: plannerConfig,\n\t\t\t\t\t\tfocusSelector: params.focusSelector,\n\t\t\t\t\t\tselector: {\n\t\t\t\t\t\t\tfrom: params.selector.from,\n\t\t\t\t\t\t\tto: params.selector.to,\n\t\t\t\t\t\t\tfullDay: params.selector.fullDay,\n\t\t\t\t\t\t\tanimation: params.focusSelector,\n\t\t\t\t\t\t\tupdateScaleLimits: params.focusSelector\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tentries: response.data.entries,\n\t\t\t\t\t\t\taccessibility: response.data.accessibility\n\t\t\t\t\t\t},\n\t\t\t\t\t\tloadedDataFrom: dateFrom,\n\t\t\t\t\t\tloadedDataTo: dateTo,\n\t\t\t\t\t\tshow: false\n\t\t\t\t\t}\n\t\t\t\t]);\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckUpdateParams (requestData)\n\t{\n\t\tlet requestPlannerUpdate = false;\n\t\tif (!this.lastRequestData || this.lastRequestPlannerId !== this.plannerId)\n\t\t{\n\t\t\trequestPlannerUpdate = true;\n\t\t}\n\n\t\t// 1. Compare dates\n\t\tif (!requestPlannerUpdate && requestData.from !== this.lastRequestData.from)\n\t\t{\n\t\t\trequestPlannerUpdate = true;\n\t\t}\n\t\t// 2. Compare users\n\t\tif (!requestPlannerUpdate\n\t\t\t&& Type.isArray(requestData.codes) && Type.isArray(this.lastRequestData.codes)\n\t\t\t&& BX.util.array_diff(requestData.codes, this.lastRequestData.codes).length > 0\n\t\t)\n\t\t{\n\t\t\trequestPlannerUpdate = true;\n\t\t}\n\n\t\t// 3. Compare resources\n\t\tif (!requestPlannerUpdate && Type.isArray(requestData.resources) && Type.isArray(this.lastRequestData.resources))\n\t\t{\n\t\t\tif (requestData.resources.length !== this.lastRequestData.resources.length)\n\t\t\t{\n\t\t\t\trequestPlannerUpdate = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet resIndex = {};\n\t\t\t\trequestData.resources.forEach(function (res)\n\t\t\t\t{\n\t\t\t\t\tresIndex[res.type + '_' + res.id] = true\n\t\t\t\t});\n\n\t\t\t\tthis.lastRequestData.resources.forEach(function(res)\n\t\t\t\t{\n\t\t\t\t\tif (!resIndex[res.type + '_' + res.id])\n\t\t\t\t\t{\n\t\t\t\t\t\trequestPlannerUpdate = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Save request data for future comparing\n\t\tif (requestPlannerUpdate)\n\t\t{\n\t\t\tthis.lastRequestData = requestData;\n\t\t\tthis.lastRequestPlannerId = this.plannerId;\n\t\t}\n\n\t\treturn requestPlannerUpdate;\n\t}\n\n\tshowPlanner ()\n\t{\n\t\tthis.planner = new CalendarPlanner(\n\t\t\tthis.params.plannerConfig,\n\t\t\t{\n\t\t\t\tconfig: this.config,\n\t\t\t\tdata: {\n\t\t\t\t\taccessibility: this.currentAccessibility || {},\n\t\t\t\t\tentries: this.currentEntries\n\t\t\t\t},\n\t\t\t\tselector: {\n\t\t\t\t\tfrom: this.params.selector.from,\n\t\t\t\t\tto: this.params.selector.to,\n\t\t\t\t\tfullDay: this.params.selector.fullDay,\n\t\t\t\t\tupdateScaleLimits: true,\n\t\t\t\t\tupdateScaleType: false,\n\t\t\t\t\tfocus: true,\n\t\t\t\t\tRRULE: false,\n\t\t\t\t\tanimation: false\n\t\t\t\t},\n\t\t\t\tloadedDataFrom: this.currentLoadedDataFrom,\n\t\t\t\tloadedDataTo: this.currentLoadedDataTo,\n\t\t\t\tfocusSelector: true,\n\t\t\t\tplannerId: this.plannerId,\n\t\t\t\tshow: true\n\t\t\t}\n\t\t);\n\n\t\t// planner events\n\t\tif (Type.isFunction(this.params.selectorOnChangeCallback))\n\t\t{\n\t\t\tBX.addCustomEvent('OnCalendarPlannerSelectorChanged', this.params.selectorOnChangeCallback);\n\t\t}\n\t\tif (Type.isFunction(this.params.selectEntriesOnChangeCallback))\n\t\t{\n\t\t\tBX.addCustomEvent('OnCalendarPlannerSelectedEntriesOnChange', this.params.selectEntriesOnChangeCallback);\n\t\t}\n\t\tif (Type.isFunction(this.params.checkSelectorStatusCallback))\n\t\t{\n\t\t\tBX.addCustomEvent('OnCalendarPlannerSelectorStatusOnChange', this.params.checkSelectorStatusCallback);\n\t\t}\n\n\t\tBX.addCustomEvent('OnCalendarPlannerScaleChanged', BX.proxy(function(params)\n\t\t{\n\t\t\tthis.update({\n\t\t\t\tfrom: params.from,\n\t\t\t\tto: params.to,\n\t\t\t\tfocusSelector: params.focusSelector === true\n\t\t\t});\n\t\t}, this));\n\n\t}\n\n\tshowPlannerLoader ()\n\t{\n\t\tif (this.planner && this.planner.outerWrap)\n\t\t{\n\t\t\tif (this.loader)\n\t\t\t{\n\t\t\t\tDom.remove(this.loader);\n\t\t\t}\n\t\t\tthis.loader = this.planner.outerWrap.appendChild(BookingUtil.getLoader(150));\n\t\t}\n\t}\n\n\thidePlannerLoader ()\n\t{\n\t\tif (this.loader)\n\t\t{\n\t\t\tDom.remove(this.loader);\n\t\t\tthis.loader = false;\n\t\t}\n\t}\n\n\tclose(params)\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tif (params && params.animation)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.popup.popupContainer, 'show');\n\t\t\t\tsetTimeout(BX.delegate(function()\n\t\t\t\t{\n\t\t\t\t\tparams.animation = false;\n\t\t\t\t\tthis.close(params);\n\t\t\t\t}, this), 300);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.unbind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t\t\tBX.removeCustomEvent(this.popup, 'onPopupClose', BX.proxy(this.close, this));\n\t\t\t\tthis.popup.destroy();\n\t\t\t\tthis.planner = null;\n\t\t\t\tthis.popup = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.lastPlannerIdShown === this.plannerId\n\t\t\t&& this.popup && this.popup.isShown && this.popup.isShown();\n\t}\n\n\tgetPlannerId()\n\t{\n\t\tif (typeof this.plannerId === 'undefined')\n\t\t{\n\t\t\tthis.plannerId = 'calendar-planner-' + Math.round(Math.random() * 100000);\n\t\t}\n\t\treturn this.plannerId;\n\t}\n\n\tgetPlannerContainer()\n\t{\n\t\treturn BX('calendar-planner-outer' + this.getPlannerId(), true);\n\t}\n\n\trefreshDateTimeView(params)\n\t{\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (this.isShown()\n\t\t\t&& !BX.isParentForNode(this.bindNode, target)\n\t\t\t&& !BX.isParentForNode(BX('BXSocNetLogDestination'), target)\n\t\t\t&& !BX.isParentForNode(this.popup.popupContainer, target)\n\t\t)\n\t\t{\n\t\t\tif (!document.querySelector('div.popup-window-resource-select'))\n\t\t\t{\n\t\t\t\tthis.close({animation: true});\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n\n\n\n","import {BookingUtil, Dom, Loc, Event, Type, SelectInput} from \"calendar.resourcebooking\";\nimport {UserSelectorFieldEditControl} from \"./controls/userselectorfieldeditcontrol\";\nimport {ResourceSelectorFieldEditControl} from \"./controls/resourceselectorfieldeditcontrol\";\nimport {ResourcebookingUserfield} from \"calendar.resourcebookinguserfield\";\nimport {PlannerPopup} from \"./controls/plannerpopup\";\n\nexport class EditFieldController\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params;\n\t\tthis.plannerPopup = null;\n\n\t\tthis.DOM = {\n\t\t\touterWrap: BX(params.controlId),\n\t\t\tvalueInputs: []\n\t\t};\n\n\t\tthis.isNew = !this.params.value || !this.params.value.DATE_FROM;\n\n\t\tif (this.params.socnetDestination)\n\t\t{\n\t\t\tResourcebookingUserfield.setSocnetDestination(this.params.socnetDestination);\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tthis.buildUserfieldWrap();\n\t\tthis.createEventHandlers();\n\t\tthis.setControlValues();\n\t}\n\n\tbuildUserfieldWrap()\n\t{\n\t\tthis.buildDateControl();\n\t\tthis.buildTimeControl();\n\t\tthis.buildServiceControl();\n\t\tthis.buildDurationControl();\n\t\tthis.buildUserSelectorControl();\n\t\tthis.buildResourceSelectorControl();\n\t}\n\n\tcreateEventHandlers()\n\t{\n\t\tEvent.bind(this.DOM.outerWrap, 'click',this.showPlannerPopup.bind(this));\n\t\tEvent.bind(this.DOM.fromInput, 'focus',this.showPlannerPopup.bind(this));\n\t\tEvent.bind(this.DOM.durationInput, 'focus',this.showPlannerPopup.bind(this));\n\n\t\tsetTimeout(function(){\n\t\t\tBX.onCustomEvent(window, 'onCrmEntityEditorUserFieldSetValidator',\n\t\t\t[\n\t\t\t\tthis.params.controlId,\n\t\t\t\tfunction(result)\n\t\t\t\t{\n\t\t\t\t\tif (!this.params.allowOverbooking && this.isOverbooked())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (result && result.addError && BX.Crm && BX.Crm.EntityValidationError)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.addError(BX.Crm.EntityValidationError.create({field: this}));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t\t// let _validationPromise = new BX.Promise();\n\t\t\t\t\t// _validationPromise.fulfill();\n\t\t\t\t\t// return _validationPromise;\n\t\t\t\t}.bind(this)\n\t\t\t]);\n\t\t}.bind(this), 100);\n\n\t\tsetTimeout(this.onChangeValues.bind(this), 100);\n\t}\n\n\tsetControlValues()\n\t{\n\t\tthis.allValuesValue = null;\n\n\t\tlet\n\t\t\tdateFrom,\n\t\t\tduration,\n\t\t\tdefaultDuration = this.params.fullDay ? 1440 : 60, // One day or one hour as default\n\t\t\tdateTo;\n\n\t\tif (this.isNew)\n\t\t{\n\t\t\tlet params = ResourcebookingUserfield.getParamsFromHash(this.params.userfieldId);\n\t\t\tif (params && params.length > 1)\n\t\t\t{\n\t\t\t\tdateFrom = BX.parseDate(params[0]);\n\t\t\t\tdateTo = BX.parseDate(params[1]);\n\t\t\t\tif (dateFrom && dateTo)\n\t\t\t\t{\n\t\t\t\t\tduration = Math.round(Math.max((dateTo.getTime() - dateFrom.getTime()) / 60000, 0));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!dateFrom)\n\t\t\t{\n\t\t\t\tdateFrom = new Date();\n\t\t\t\tlet\n\t\t\t\t\troundMin = 30,\n\t\t\t\t\tr = (roundMin || 10) * 60 * 1000,\n\t\t\t\t\ttimestamp = Math.ceil(dateFrom.getTime() / r) * r;\n\t\t\t\tdateFrom = new Date(timestamp);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdateFrom = BX.parseDate(this.params.value.DATE_FROM);\n\t\t\tdateTo = BX.parseDate(this.params.value.DATE_TO);\n\t\t\tduration = Math.round(Math.max((dateTo.getTime() - dateFrom.getTime()) / 60000, 0));\n\t\t}\n\n\t\tif (!duration)\n\t\t{\n\t\t\tduration = defaultDuration;\n\t\t}\n\n\t\tthis.DOM.fromInput.value = BookingUtil.formatDate(BookingUtil.getDateFormat(), dateFrom);\n\t\tif (this.DOM.timeFromInput)\n\t\t{\n\t\t\tthis.DOM.timeFromInput.value = BookingUtil.formatDate(BookingUtil.getTimeFormatShort(), dateFrom);\n\t\t}\n\n\t\tif (this.durationList)\n\t\t{\n\t\t\tthis.durationList.setValue(duration);\n\t\t}\n\n\t\tif (this.serviceList)\n\t\t{\n\t\t\tthis.serviceList.setValue(this.params.value.SERVICE_NAME || '');\n\t\t}\n\n\t\tlet selectedUsers = [];\n\t\tlet selectedResources = [];\n\t\tif (this.params.value && Type.isArray(this.params.value.ENTRIES))\n\t\t{\n\t\t\tthis.params.value.ENTRIES.forEach(function(entry)\n\t\t\t{\n\t\t\t\tif (entry.TYPE === 'user')\n\t\t\t\t{\n\t\t\t\t\tselectedUsers.push(parseInt(entry.RESOURCE_ID));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tselectedResources.push({\n\t\t\t\t\t\tid: parseInt(entry.RESOURCE_ID),\n\t\t\t\t\t\ttype: entry.TYPE\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (this.resourceSelector)\n\t\t{\n\t\t\tthis.resourceSelector.setValues(selectedResources, false);\n\t\t}\n\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tthis.userSelector.setValues(selectedUsers, false);\n\t\t}\n\t}\n\n\tbuildDateControl()\n\t{\n\t\tthis.DOM.dateTimeWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-wrap calendar-resourcebook-content-block-detail-wrap-flex\"}}));\n\n\t\tthis.DOM.dateWrap = this.DOM.dateTimeWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_DATE_LABEL') + '</span></div>'\n\t\t\t}));\n\n\t\tthis.DOM.fromInput = this.DOM.dateWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs: {\n\t\t\t\tvalue: '',\n\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_DATE_LABEL'),\n\t\t\t\ttype: 'text'\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: EditFieldController.showCalendarPicker,\n\t\t\t\tchange: this.triggerUpdatePlanner.bind(this)\n\t\t\t},\n\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime'}\n\t\t}));\n\n\t\tthis.DOM.emptyInput = this.DOM.dateWrap.appendChild(Dom.create('INPUT', {attrs: {value: '',type: 'text'}, props: {className: 'calendar-resbook-empty-input'}}));\n\t}\n\n\tbuildTimeControl()\n\t{\n\t\tif (!this.params.fullDay)\n\t\t{\n\t\t\tthis.DOM.timeWrap = this.DOM.dateTimeWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_TIME_LABEL') + '</span></div>'\n\t\t\t\t}));\n\n\t\t\tthis.DOM.timeFromInput = this.DOM.timeWrap.appendChild(Dom.create('INPUT', {\n\t\t\t\tattrs: {\n\t\t\t\t\tvalue: '',\n\t\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_TIME_LABEL'),\n\t\t\t\t\ttype: 'text'\n\t\t\t\t},\n\t\t\t\tstyle: {width: '100px'},\n\t\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime-menu'}\n\t\t\t}));\n\n\t\t\tthis.fromTime = new SelectInput({\n\t\t\t\tinput: this.DOM.timeFromInput,\n\t\t\t\tvalues: BookingUtil.getSimpleTimeList(),\n\t\t\t\tonChangeCallback: this.triggerUpdatePlanner.bind(this),\n\t\t\t\tonAfterMenuOpen: function(ind, popupMenu)\n\t\t\t\t{\n\t\t\t\t\tif (!ind && popupMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet\n\t\t\t\t\t\t\ti, menuItem,\n\t\t\t\t\t\t\tnearestTimeValue = BookingUtil.adaptTimeValue({h: dateFrom.getHours(), m: dateFrom.getMinutes()});\n\n\t\t\t\t\t\tif (nearestTimeValue && nearestTimeValue.label)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor (i = 0; i < popupMenu.menuItems.length; i++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmenuItem = popupMenu.menuItems[i];\n\t\t\t\t\t\t\t\tif (menuItem\n\t\t\t\t\t\t\t\t\t&& nearestTimeValue.label === menuItem.text\n\t\t\t\t\t\t\t\t\t&& menuItem.layout)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tpopupMenu.layout.menuContainer.scrollTop = menuItem.layout.item.offsetTop - 2;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t});\n\t\t}\n\t}\n\n\tbuildServiceControl()\n\t{\n\t\tif (this.params.useServices && Type.isArray(this.params.serviceList) && this.params.serviceList.length > 0)\n\t\t{\n\t\t\tif (this.params.fullDay)\n\t\t\t{\n\t\t\t\tthis.DOM.durationWrap = this.DOM.dateTimeWrap;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.durationWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-wrap calendar-resourcebook-content-block-detail-wrap-flex\"}}));\n\t\t\t}\n\n\t\t\tthis.DOM.servicesWrap = this.DOM.durationWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_LABEL') + '</span></div>'\n\t\t\t\t}));\n\n\t\t\tthis.DOM.serviceInput = this.DOM.servicesWrap.appendChild(Dom.create('INPUT', {\n\t\t\t\tattrs: {\n\t\t\t\t\tvalue: '',\n\t\t\t\t\t//value: this.params.value.SERVICE_NAME || '',\n\t\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_LABEL'),\n\t\t\t\t\ttype: 'text'\n\t\t\t\t},\n\t\t\t\tstyle: {width: '200px'},\n\t\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime-menu'}\n\t\t\t}));\n\n\t\t\tlet serviceListValues = [];\n\t\t\tthis.params.serviceList.forEach(function(service)\n\t\t\t{\n\t\t\t\tif (service.name !== '')\n\t\t\t\t{\n\t\t\t\t\tserviceListValues.push({value: service.duration, label: service.name});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.isNew && serviceListValues.length >= 1)\n\t\t\t{\n\t\t\t\tthis.DOM.serviceInput.value = serviceListValues[0].label;\n\t\t\t\t//duration = parseInt(serviceListValues[0].value);\n\t\t\t}\n\n\t\t\tthis.serviceList = new SelectInput({\n\t\t\t\tinput: this.DOM.serviceInput,\n\t\t\t\tvalues: serviceListValues,\n\t\t\t\tonChangeCallback: function(state)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isPlainObject(state) && state.realValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.durationList.setValue(parseInt(state.realValue));\n\t\t\t\t\t\tthis.duration = BookingUtil.parseDuration(this.DOM.durationInput.value);\n\t\t\t\t\t\tthis.triggerUpdatePlanner();\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t});\n\t\t}\n\t}\n\n\tbuildDurationControl()\n\t{\n\t\tif (!this.DOM.durationWrap)\n\t\t{\n\t\t\tthis.DOM.durationWrap = this.DOM.dateTimeWrap;\n\t\t}\n\n\t\t// region Duration\n\t\tthis.DOM.durationControlWrap = this.DOM.durationWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_DURATION_LABEL') + '</span></div>'\n\t\t\t}));\n\n\t\tthis.DOM.durationInput = this.DOM.durationControlWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs: {\n\t\t\t\t//value: duration,\n\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_DURATION_LABEL'),\n\t\t\t\ttype: 'text'\n\t\t\t},\n\t\t\tstyle: {width: '90px'},\n\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime-menu'}\n\t\t}));\n\n\t\t//this.duration = parseInt(duration);\n\t\tthis.durationList = new SelectInput({\n\t\t\tinput: this.DOM.durationInput,\n\t\t\tvalues: BookingUtil.getDurationList(this.params.fullDay),\n\t\t\t//value: duration,\n\t\t\tonChangeCallback: function()\n\t\t\t{\n\t\t\t\tthis.duration = BookingUtil.parseDuration(this.DOM.durationInput.value);\n\t\t\t\tthis.triggerUpdatePlanner();\n\t\t\t}.bind(this)\n\t\t});\n\t}\n\n\tbuildUserSelectorControl()\n\t{\n\t\tif (this.params.useUsers)\n\t\t{\n\t\t\tthis.DOM.userSelectorWrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {\n\t\t\t\tprops: {className: 'calendar-resbook-users-selector-wrap'}\n\t\t\t}));\n\n\t\t\tthis.DOM.userSelectorWrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-resourcebook-content-block-control-field'}}));\n\n\t\t\tlet userSelectorTitle = Loc.getMessage('USER_TYPE_RESOURCE_USERS_CONTROL_DEFAULT_NAME');\n\t\t\tthis.DOM.userSelectorWrap\n\t\t\t\t.appendChild(Dom.create('DIV', {props: {className: 'calendar-resourcebook-content-block-title'}}))\n\t\t\t\t.appendChild(Dom.create('SPAN', {props: {className: 'calendar-resourcebook-content-block-title-text'}, text: userSelectorTitle}));\n\t\t\tthis.DOM.userListWrap = this.DOM.userSelectorWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control custom-field-item\"}}));\n\n\t\t\tthis.userSelector = new UserSelectorFieldEditControl({\n\t\t\t\twrapNode: this.DOM.userListWrap,\n\t\t\t\tsocnetDestination: ResourcebookingUserfield.getSocnetDestination(),\n\t\t\t\taddMessage: Loc.getMessage('USER_TYPE_RESOURCE_SELECT_USER'),\n\t\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this)\n\t\t\t});\n\n\t\t\tBX.addCustomEvent('OnResourceBookDestinationAddNewItem', this.triggerUpdatePlanner.bind(this));\n\t\t\tBX.addCustomEvent('OnResourceBookDestinationUnselect', this.triggerUpdatePlanner.bind(this));\n\t\t}\n\t}\n\n\tbuildResourceSelectorControl()\n\t{\n\t\tif (this.params.useResources)\n\t\t{\n\t\t\tthis.DOM.resourcesWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\" }}));\n\n\t\t\tlet resSelectorTitle = Loc.getMessage('USER_TYPE_RESOURCE_RESOURCE_CONTROL_DEFAULT_NAME');\n\t\t\tthis.DOM.resourcesWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: resSelectorTitle}));\n\t\t\tthis.DOM.resourcesListWrap = this.DOM.resourcesWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control custom-field-item\"}}));\n\n\t\t\tthis.resourceSelector = new ResourceSelectorFieldEditControl({\n\t\t\t\touterWrap: this.DOM.resourcesWrap,\n\t\t\t\tblocksWrap: this.DOM.resourcesListWrap,\n\t\t\t\tvalues: [],\n\t\t\t\tresourceList: this.params.resourceList,\n\t\t\t\tonChangeCallback: this.triggerUpdatePlanner.bind(this),\n\t\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this)\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showCalendarPicker(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tBX.calendar({node: target, field: target, bTime: false});\n\t\tBX.focus(target);\n\t}\n\n\tonChangeValues()\n\t{\n\t\tthis.duration = this.duration || BookingUtil.parseDuration(this.DOM.durationInput.value);\n\t\tconst duration = this.duration * 60;\n\t\tlet\n\t\t\tallValuesValue = '',\n\t\t\tformatDatetime = BX.isAmPmMode() ? Loc.getMessage(\"FORMAT_DATETIME\").replace(':SS', '') : Loc.getMessage(\"FORMAT_DATETIME\"),\n\t\t\tdateFrom,\n\t\t\tdateFromValue = '',\n\t\t\tserviceName = this.DOM.serviceInput ? this.DOM.serviceInput.value : '',\n\t\t\tentries = [];\n\n\t\tdateFrom = this.params.fullDay ? BookingUtil.parseDate(this.DOM.fromInput.value) : BookingUtil.parseDate(this.DOM.fromInput.value + ' ' + this.DOM.timeFromInput.value, false, false, formatDatetime);\n\n\t\tif (Type.isDate(dateFrom))\n\t\t{\n\t\t\tif (this.params.useResources)\n\t\t\t{\n\t\t\t\tentries = entries.concat(this.getSelectedResourceList());\n\t\t\t}\n\n\t\t\tif (this.params.useUsers)\n\t\t\t{\n\t\t\t\tentries = entries.concat(this.getSelectedUserList());\n\t\t\t}\n\t\t\tdateFromValue = BookingUtil.formatDate(BookingUtil.getDateTimeFormat(), dateFrom.getTime() / 1000);\n\t\t}\n\n\t\t// Clear inputs\n\t\tthis.DOM.valueInputs.forEach(function(input){BX.remove(input);});\n\t\tthis.DOM.valueInputs = [];\n\n\t\tentries.forEach(function(entry)\n\t\t{\n\t\t\tlet value = entry.type + '|' + entry.id + '|' + dateFromValue + '|' + duration + '|' + serviceName;\n\t\t\tallValuesValue += value + '#';\n\n\t\t\tthis.DOM.valueInputs.push(this.DOM.outerWrap.appendChild(\n\t\t\t\tDom.create('INPUT', {\n\t\t\t\t\tattrs:{\n\t\t\t\t\t\tname: this.params.inputName,\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t}})));\n\t\t}, this);\n\n\n\t\tif (!entries.length)\n\t\t{\n\t\t\tthis.DOM.valueInputs.push(this.DOM.outerWrap.appendChild(\n\t\t\t\tDom.create('INPUT', {\n\t\t\t\t\tattrs:{\n\t\t\t\t\t\tname: this.params.inputName,\n\t\t\t\t\t\tvalue: 'empty',\n\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t}})));\n\t\t}\n\n\t\tif (this.allValuesValue !== null && this.allValuesValue !== allValuesValue)\n\t\t{\n\t\t\tBX.onCustomEvent(window, 'onCrmEntityEditorUserFieldExternalChanged', [this.params.controlId]);\n\t\t\tBX.fireEvent(this.DOM.emptyInput, 'change');\n\t\t}\n\t\tthis.allValuesValue = allValuesValue;\n\t}\n\n\tshowPlannerPopup()\n\t{\n\t\tlet currentEventList = [];\n\t\tif (this.params.value && Type.isArray(this.params.value.ENTRIES))\n\t\t{\n\t\t\tthis.params.value.ENTRIES.forEach(function(entry)\n\t\t\t{\n\t\t\t\tcurrentEventList.push(entry.EVENT_ID);\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isNull(this.plannerPopup))\n\t\t{\n\t\t\tthis.plannerPopup = new PlannerPopup();\n\t\t}\n\n\t\tthis.plannerPopup.show({\n\t\t\tplannerId: this.params.plannerId,\n\t\t\tbindNode: this.DOM.outerWrap,\n\t\t\tplannerConfig: this.getPlannerConfig(),\n\t\t\tselector: this.getSelectorData(),\n\t\t\tselectorOnChangeCallback: this.plannerSelectorOnChange.bind(this),\n\t\t\tselectEntriesOnChangeCallback: this.plannerSelectedEntriesOnChange.bind(this),\n\t\t\tcheckSelectorStatusCallback: this.checkSelectorStatusCallback.bind(this),\n\t\t\tcurrentEventList: currentEventList\n\t\t});\n\n\t\tthis.triggerUpdatePlanner();\n\t}\n\n\ttriggerUpdatePlanner()\n\t{\n\t\tif (!Type.isNull(this.plannerPopup)\n\t\t\t&& this.plannerPopup.plannerId === this.params.plannerId\n\t\t\t&& this.plannerPopup.isShown())\n\t\t{\n\t\t\tthis.plannerPopup.update({\n\t\t\t\tplannerId: this.params.plannerId,\n\t\t\t\tplannerConfig: this.getPlannerConfig(),\n\t\t\t\tselector: this.getSelectorData(),\n\t\t\t\tresourceList: this.getResourceList(),\n\t\t\t\tselectedResources: this.resourceSelector ? this.resourceSelector.getSelectedValues() : false,\n\t\t\t\tuserList: this.getUserList(),\n\t\t\t\tselectedUsers: this.userSelector ? this.userSelector.getSelectedValues() : false\n\t\t\t},\n\t\t\ttrue);\n\t\t}\n\n\t\tthis.onChangeValues();\n\t}\n\n\tgetPlannerConfig()\n\t{\n\t\tif (!this.params.plannerConfig)\n\t\t{\n\t\t\tthis.params.plannerConfig = {\n\t\t\t\tid: this.params.plannerId,\n\t\t\t\tselectEntriesMode: true,\n\t\t\t\tscaleLimitOffsetLeft: 2,\n\t\t\t\tscaleLimitOffsetRight: 2,\n\t\t\t\tmaxTimelineSize: 300,\n\t\t\t\tminEntryRows: 300,\n\t\t\t\tentriesListWidth: 120,\n\t\t\t\ttimelineCellWidth: 49,\n\t\t\t\tminWidth: 300,\n\t\t\t\taccuracy: 300,\n\t\t\t\tworkTime: [parseInt(this.params.workTime[0]), parseInt(this.params.workTime[1])]\n\t\t\t};\n\t\t}\n\n\t\tthis.params.plannerConfig.clickSelectorScaleAccuracy = Math.max((this.duration * 60) || 300, 3600);\n\n\t\treturn this.params.plannerConfig;\n\t}\n\n\tplannerSelectorOnChange(params)\n\t{\n\t\tif (params.plannerId === this.params.plannerId\n\t\t\t&& Type.isDate(params.dateFrom)\n\t\t\t&& Type.isDate(params.dateTo)\n\t\t)\n\t\t{\n\t\t\tlet\n\t\t\t\tdateFrom = params.dateFrom,\n\t\t\t\tdateTo = params.dateTo;\n\n\t\t\tthis.DOM.fromInput.value =  BookingUtil.formatDate(BookingUtil.getDateFormat(), dateFrom);\n\n\t\t\tif (this.DOM.timeFromInput)\n\t\t\t{\n\t\t\t\tthis.DOM.timeFromInput.value = BookingUtil.formatDate(BookingUtil.getTimeFormatShort(), dateFrom);\n\t\t\t}\n\n\t\t\t// Duration in minutes\n\t\t\tthis.duration = (dateTo.getTime() - dateFrom.getTime() + (this.params.fullDay ? BookingUtil.getDayLength() : 0)) / 60000;\n\t\t\tthis.duration = Math.round(Math.max(this.duration, 0));\n\t\t\tthis.durationList.setValue(this.duration);\n\n\t\t\tthis.onChangeValues();\n\t\t}\n\t}\n\n\tplannerSelectedEntriesOnChange(params)\n\t{\n\t\tif (params.plannerId === this.params.plannerId && Type.isArray(params.entries))\n\t\t{\n\t\t\tlet\n\t\t\t\tselectedResources = [],\n\t\t\t\tselectedUsers = [];\n\n\t\t\tparams.entries.forEach(function(entry)\n\t\t\t{\n\t\t\t\tif (entry.selected)\n\t\t\t\t{\n\t\t\t\t\tif (entry.type === 'user')\n\t\t\t\t\t{\n\t\t\t\t\t\tselectedUsers.push(entry.id);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tselectedResources.push({\n\t\t\t\t\t\t\tid: entry.id,\n\t\t\t\t\t\t\ttype: entry.type\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.resourceSelector)\n\t\t\t{\n\t\t\t\tthis.resourceSelector.setValues(selectedResources, false);\n\t\t\t}\n\t\t\tif (this.userSelector)\n\t\t\t{\n\t\t\t\tthis.userSelector.setValues(selectedUsers, false);\n\t\t\t}\n\n\t\t\tthis.onChangeValues();\n\t\t}\n\t}\n\n\tcheckSelectorStatusCallback(params)\n\t{\n\t\tif (params.plannerId === this.params.plannerId && !this.params.allowOverbooking)\n\t\t{\n\t\t\tlet errorClass = 'calendar-resbook-error';\n\t\t\tthis.overbooked = params.status === 'busy';\n\n\t\t\tif (this.overbooked)\n\t\t\t{\n\t\t\t\tif (!this.DOM.errorNode)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.errorNode = this.DOM.dateTimeWrap.appendChild(Dom.create(\"div\", {\n\t\t\t\t\t\tprops: {className: \"calendar-resbook-content-error-text\"},\n\t\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_BOOKED_ERROR')\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tif (this.DOM.fromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(this.DOM.fromInput, errorClass);\n\t\t\t\t}\n\t\t\t\tif (this.DOM.timeFromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(this.DOM.timeFromInput, errorClass);\n\t\t\t\t}\n\t\t\t\tsetTimeout(BX.delegate(function(){BX.focus(this.DOM.fromInput)}, this), 50);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.DOM.errorNode)\n\t\t\t\t{\n\t\t\t\t\tBX.remove(this.DOM.errorNode);\n\t\t\t\t\tthis.DOM.errorNode = null;\n\t\t\t\t}\n\n\t\t\t\tif (this.DOM.fromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(this.DOM.fromInput, errorClass);\n\t\t\t\t}\n\t\t\t\tif (this.DOM.timeFromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(this.DOM.timeFromInput, errorClass);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSelectorData()\n\t{\n\t\tlet\n\t\t\tformatDatetime = BX.isAmPmMode() ? Loc.getMessage(\"FORMAT_DATETIME\").replace(':SS', '') : Loc.getMessage(\"FORMAT_DATETIME\"),\n\t\t\tselector, dateTo,\n\t\t\tduration = this.duration,\n\t\t\tdateFrom = BookingUtil.parseDate(this.DOM.fromInput.value + (this.DOM.timeFromInput ? ' ' + this.DOM.timeFromInput.value : ''), false, false, formatDatetime);\n\n\t\tif (!duration)\n\t\t{\n\t\t\tduration = this.params.fullDay ? 1440 : 60;\n\t\t}\n\n\t\tif (!Type.isDate(dateFrom))\n\t\t{\n\t\t\tdateFrom = new Date();\n\t\t}\n\n\t\tdateTo = new Date(dateFrom.getTime() + duration * 60000 - (this.params.fullDay ? BookingUtil.getDayLength() : 0));\n\n\t\tselector = {\n\t\t\tfrom: dateFrom,\n\t\t\tto: dateTo,\n\t\t\tfullDay: this.params.fullDay,\n\t\t\tupdateScaleLimits: true\n\t\t};\n\n\t\treturn selector;\n\t}\n\n\tgetResourceList()\n\t{\n\t\tlet entries = [];\n\t\tif (this.resourceSelector)\n\t\t{\n\t\t\tthis.resourceSelector.getValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tentries.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: parseInt(value.id),\n\t\t\t\t\t\ttype : value.type,\n\t\t\t\t\t\tname : value.title\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\treturn entries;\n\t}\n\tgetSelectedResourceList()\n\t{\n\t\tlet entries = [];\n\t\tif (this.resourceSelector)\n\t\t{\n\t\t\tthis.resourceSelector.getSelectedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tentries.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: parseInt(value.id),\n\t\t\t\t\t\ttype : value.type,\n\t\t\t\t\t\tname : value.title\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\treturn entries;\n\t}\n\n\tgetUserList()\n\t{\n\t\tlet entries = [], index = {}, userId;\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tif (Type.isArray(this.params.userList))\n\t\t\t{\n\t\t\t\tthis.params.userList.forEach(function(userId){\n\t\t\t\t\tif (!index[userId])\n\t\t\t\t\t{\n\t\t\t\t\t\tentries.push({id: userId, type : 'user'});\n\t\t\t\t\t\tindex[userId] = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.userSelector.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tuserId = parseInt(code.substr(1));\n\t\t\t\t\tif (!index[userId])\n\t\t\t\t\t{\n\t\t\t\t\t\tentries.push({id: userId, type : 'user'});\n\t\t\t\t\t\tindex[userId] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn entries;\n\t}\n\n\tgetSelectedUserList()\n\t{\n\t\tlet entries = [];\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tthis.userSelector.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tentries.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: parseInt(code.substr(1)),\n\t\t\t\t\t\t\ttype : 'user'\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn entries;\n\t}\n\n\tcheckResourceCountLimit()\n\t{\n\t\treturn this.params.resourceLimit <= 0 || this.getTotalResourceCount() <= this.params.resourceLimit;\n\t}\n\n\tgetTotalResourceCount()\n\t{\n\t\tlet result = 0;\n\t\tif (this.params.useResources && this.resourceSelector)\n\t\t{\n\t\t\tresult += this.resourceSelector.getValues().length;\n\t\t}\n\n\t\tif (this.params.useUsers)\n\t\t{\n\t\t\tresult += this.getSelectedUserList().length;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tisOverbooked()\n\t{\n\t\treturn this.overbooked;\n\t}\n}\n","import {BookingUtil, Type, Dom, Loc, SelectInput} from \"calendar.resourcebooking\";\n\nexport class ServiceSelector\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = Type.isPlainObject(params) ? params : {};\n\t\tthis.outerCont = this.params.outerCont;\n\t\tthis.fieldSettings = this.params.fieldSettings || {};\n\t\tthis.create();\n\t}\n\n\tcreate()\n\t{\n\t\tthis.serviceListOuterWrap = this.outerCont.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-wrap calendar-resourcebook-service-list-wrap\"}}));\n\n\t\tthis.durationTitleId = 'duration-title-wrap-' + Math.round(Math.random() * 100000);\n\t\tthis.servicesTitleWrap = this.serviceListOuterWrap\n\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-detail-inner\"},\n\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-detail-resource\">' +\n\t\t\t\t\t'<div class=\"calendar-resourcebook-content-block-title\">' +\n\t\t\t\t\t'<span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_LABEL') + '</span>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div id=\"' + this.durationTitleId + '\" class=\"calendar-resourcebook-content-block-title calendar-resourcebook-content-block-duration-title\">' +\n\t\t\t\t\t'<span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_DURATION_LABEL') + '</span>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>'\n\t\t\t}));\n\n\t\tthis.serviceListRowsWrap = this.serviceListOuterWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-inner\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail\"}}));\n\n\t\tBX.bind(this.serviceListRowsWrap, 'click', this.handlePopupClick.bind(this));\n\t\tif (Type.isArray(this.fieldSettings.SERVICE_LIST) && this.fieldSettings.SERVICE_LIST.length > 0)\n\t\t{\n\t\t\tthis.fieldSettings.SERVICE_LIST.forEach(function(service)\n\t\t\t{\n\t\t\t\tthis.addRow(service, false);\n\t\t\t}, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addRow(false, false);\n\t\t}\n\n\t\tthis.serviceListAddWrap = this.serviceListOuterWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resource-content-block-add-field\"}}));\n\n\t\tthis.serviceAddButton = this.serviceListAddWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: \"calendar-resource-content-block-add-link calendar-resource-content-block-add-link-icon\"},\n\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_ADD_SERVICE'),\n\t\t\tevents: {click: this.addRow.bind(this)}\n\t\t}));\n\n\t\tBX.bind(window, 'resize', this.checkDurationTitlePosition.bind(this));\n\t\tthis.checkDurationTitlePosition();\n\n\t\tthis.show(this.fieldSettings.USE_SERVICES === 'Y');\n\t}\n\n\tshow(show)\n\t{\n\t\tif (show)\n\t\t{\n\t\t\tthis.serviceListOuterWrap.style.display = '';\n\t\t\tDom.addClass(this.serviceListOuterWrap, 'show');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.serviceListOuterWrap.style.display = 'none';\n\t\t\tDom.removeClass(this.serviceListOuterWrap, 'show');\n\t\t}\n\t}\n\n\taddRow(row, animation)\n\t{\n\t\tanimation = animation !== false;\n\n\t\tif (!Type.isPlainObject(row))\n\t\t{\n\t\t\trow = {name: '', duration: this.getDefaultDuration()}\n\t\t}\n\n\t\tlet service = {\n\t\t\touterWrap: this.serviceListRowsWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-resource calendar-resourcebook-service-row\"}}))\n\t\t};\n\n\t\tif (animation)\n\t\t{\n\t\t\tsetTimeout(function(){\n\t\t\t\tDom.addClass(service.outerWrap, 'show');\n\t\t\t}, 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(service.outerWrap, 'show');\n\t\t}\n\n\t\tservice.wrap = service.outerWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-resource-inner\"}}));\n\n\t\tservice.nameInput = service.wrap.appendChild(Dom.create(\"input\", {\n\t\t\tprops: {\n\t\t\t\tclassName: \"calendar-resourcebook-content-input calendar-resourcebook-service-input\",\n\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_PLACEHOLDER'),\n\t\t\t\ttype: \"text\",\n\t\t\t\tvalue: row.name\n\t\t\t},\n\t\t\tattrs: {}\n\t\t}));\n\n\t\tservice.durationInput = service.wrap.appendChild(Dom.create(\"input\", {\n\t\t\tprops: {\n\t\t\t\tclassName: \"calendar-resbook-duration-input calendar-resbook-field-datetime-menu\",\n\t\t\t\ttype: \"text\",\n\t\t\t\tvalue: row.duration\n\t\t\t},\n\t\t\tattrs: {}\n\t\t}));\n\n\t\tservice.durationList = new SelectInput({\n\t\t\tinput: service.durationInput,\n\t\t\tgetValues: function(){\n\t\t\t\tlet fullday = false;\n\t\t\t\tif (Type.isFunction(this.params.getFullDayValue))\n\t\t\t\t{\n\t\t\t\t\tfullday = this.params.getFullDayValue();\n\t\t\t\t}\n\t\t\t\treturn BookingUtil.getDurationList(fullday);\n\t\t\t}.bind(this),\n\t\t\tvalue: row.duration\n\t\t});\n\n\t\tservice.deleteWrap = service.wrap.appendChild(Dom.create(\"DIV\", {\n\t\t\tprops: {className: \"calendar-resourcebook-content-block-detail-delete\"},\n\t\t\thtml: '<span class=\"calendar-resourcebook-content-block-control-delete calendar-resourcebook-content-block-control-delete-detail\"></span>'\n\t\t}));\n\n\t\t// Adjust outer wrap max height\n\t\tthis.serviceListOuterWrap.style.maxHeight = Math.max(600, this.serviceListRowsWrap.childNodes.length * 40 + 100) + 'px';\n\t}\n\n\tcheckDurationTitlePosition(timeout)\n\t{\n\t\tif (timeout !== false)\n\t\t{\n\t\t\tif (this.checkDurationTitlePositionTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.checkDurationTitlePositionTimeout);\n\t\t\t}\n\n\t\t\tthis.checkDurationTitlePositionTimeout = setTimeout(function(){\n\n\t\t\t\tthis.checkDurationTitlePosition(false);\n\t\t\t}.bind(this), 100);\n\t\t\treturn;\n\t\t}\n\n\t\tlet durationInput = this.serviceListOuterWrap.querySelector('input.calendar-resbook-duration-input');\n\t\tif (this.durationTitleId && BX(this.durationTitleId) && durationInput)\n\t\t{\n\t\t\tBX(this.durationTitleId).style.left = (durationInput.offsetLeft + 15) + 'px';\n\t\t}\n\t}\n\n\tgetDefaultDuration()\n\t{\n\t\tlet fullday = false;\n\t\tif (Type.isFunction(this.params.getFullDayValue))\n\t\t{\n\t\t\tfullday = this.params.getFullDayValue();\n\t\t}\n\t\treturn fullday ? 1440 : 30;\n\t}\n\n\tclickHandler(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Dom.hasClass(target, 'calendar-resourcebook-content-block-control-delete')\n\t\t\t|| Dom.hasClass(target, 'calendar-resourcebook-content-block-detail-delete')) // Delete button\n\t\t{\n\t\t\tlet resWrap = BX.findParent(target, {className: 'calendar-resourcebook-service-row'});\n\t\t\tif (resWrap)\n\t\t\t{\n\t\t\t\tDom.removeClass(resWrap, 'show');\n\t\t\t\tsetTimeout(function(){Dom.remove(resWrap);}, 500);\n\t\t\t\tthis.checkRows();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetValues(e)\n\t{\n\t\tlet\n\t\t\tserviceList = [],\n\t\t\tnameInput, durationInput,\n\t\t\ti, rows = this.serviceListRowsWrap.querySelectorAll('.calendar-resourcebook-service-row');\n\n\t\tfor (i = 0; i < rows.length; i++)\n\t\t{\n\t\t\tif (Dom.hasClass(rows[i], 'show'))\n\t\t\t{\n\t\t\t\tnameInput = rows[i].querySelector('input.calendar-resourcebook-service-input');\n\t\t\t\tdurationInput = rows[i].querySelector('input.calendar-resbook-duration-input');\n\n\t\t\t\tif (nameInput && durationInput)\n\t\t\t\t{\n\t\t\t\t\tserviceList.push({\n\t\t\t\t\t\tname: nameInput.value,\n\t\t\t\t\t\tduration: BookingUtil.parseDuration(durationInput.value)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn serviceList;\n\t}\n\n\tcheckRows()\n\t{\n\t\tlet serviceList = this.getValues();\n\t\tif (!serviceList.length)\n\t\t{\n\t\t\tthis.show(false);\n\t\t\tif (Type.isFunction(this.params.onFullClearHandler))\n\t\t\t{\n\t\t\t\tthis.params.onFullClearHandler();\n\t\t\t}\n\t\t\tthis.addRow(false, false);\n\t\t}\n\t}\n\n\n\thandlePopupClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Dom.hasClass(target, 'calendar-resourcebook-content-block-control-delete')\n\t\t\t|| Dom.hasClass(target, 'calendar-resourcebook-content-block-detail-delete')) // Delete button\n\t\t{\n\t\t\tlet resWrap = BX.findParent(target, {className: 'calendar-resourcebook-service-row'});\n\t\t\tif (resWrap)\n\t\t\t{\n\t\t\t\tBX.removeClass(resWrap, 'show');\n\t\t\t\tsetTimeout(function(){BX.remove(resWrap);}, 500);\n\t\t\t\tthis.checkRows();\n\t\t\t}\n\t\t}\n\t}\n}","import {Type, Dom, Loc} from \"calendar.resourcebooking\";\nexport class TimezoneSelector\n{\n\tstatic timezoneList;\n\n\tconstructor(params)\n\t{\n\t\tthis.params = Type.isPlainObject(params) ? params : {};\n\t\tthis.DOM = {\n\t\t\touterWrap: this.params.outerWrap\n\t\t};\n\t\tDom.addClass(this.DOM.outerWrap, 'fields enumeration field-item');\n\t\tthis.create();\n\t}\n\n\tcreate()\n\t{\n\t\tthis.DOM.select = this.DOM.outerWrap.appendChild(Dom.create('select'));\n\t\tthis.DOM.select.options.add(\n\t\t\tnew Option(\n\t\t\t\tLoc.getMessage('USER_TYPE_LOADING_TIMEZONE_LIST'),\n\t\t\t\tthis.params.selectedValue || '',\n\t\t\t\ttrue,\n\t\t\t\ttrue)\n\t\t);\n\n\t\tthis.getTimezoneList().then(\n\t\t\tfunction(timezoneList)\n\t\t\t{\n\t\t\t\tDom.remove(this.DOM.select.options[0]);\n\t\t\t\ttimezoneList.forEach(function(timezone)\n\t\t\t\t{\n\t\t\t\t\tlet selected = this.params.selectedValue ? this.params.selectedValue === timezone.value : timezone.selected;\n\n\t\t\t\t\tthis.DOM.select.options.add(\n\t\t\t\t\t\tnew Option(\n\t\t\t\t\t\t\ttimezone.label,\n\t\t\t\t\t\t\ttimezone.value,\n\t\t\t\t\t\t\tselected,\n\t\t\t\t\t\t\tselected));\n\t\t\t\t}, this);\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tgetTimezoneList(params)\n\t{\n\t\tparams = params || {};\n\n\t\treturn new Promise((resolve) => {\n\t\t\tif (!TimezoneSelector.timezoneList || params.clearCache)\n\t\t\t{\n\t\t\t\tBX.ajax.runAction('calendar.api.calendarajax.getTimezoneList')\n\t\t\t\t\t.then(function (response)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tTimezoneSelector.timezoneList = [];\n\t\t\t\t\t\t\tfor (let key in response.data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (response.data.hasOwnProperty(key))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tTimezoneSelector.timezoneList.push({\n\t\t\t\t\t\t\t\t\t\tvalue: response.data[key].timezone_id,\n\t\t\t\t\t\t\t\t\t\tlabel: response.data[key].title,\n\t\t\t\t\t\t\t\t\t\tselected: response.data[key].default\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve(TimezoneSelector.timezoneList);\n\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\tfunction (response)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve(TimezoneSelector.timezoneList);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetValue()\n\t{\n\t\treturn this.DOM.select.value;\n\t}\n}\n\n\n\n\n\n\n\n","import {Type, Dom, Loc, Event} from \"calendar.resourcebooking\";\n\nexport class ModeSelector\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params;\n\t\tthis.outerWrap = this.create();\n\t}\n\n\tcreate()\n\t{\n\t\tlet\n\t\t\twrapNode = Dom.create(\"span\",\n\t\t\t\t{\n\t\t\t\t\tprops:{className: \"calendar-resourcebook-content-block-select calendar-resourcebook-mode-selector\"}\n\t\t\t\t}\n\t\t\t),\n\t\t\tmenuItems = [\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES'),\n\t\t\t\t\tonclick: function(e, item){\n\t\t\t\t\t\tif (Type.isFunction(this.params.showResources))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.params.showResources();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twrapNode.innerHTML = item.text;\n\t\t\t\t\t\tthis.modeSwitcherPopup.close();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_USERS'),\n\t\t\t\t\tonclick: function(e, item){\n\t\t\t\t\t\tif (Type.isFunction(this.params.showUsers))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.params.showUsers();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twrapNode.innerHTML = item.text;\n\t\t\t\t\t\tthis.modeSwitcherPopup.close();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES_AND_USERS'),\n\t\t\t\t\tonclick: function(e, item){\n\t\t\t\t\t\tif (Type.isFunction(this.params.showResourcesAndUsers))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.params.showResourcesAndUsers();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twrapNode.innerHTML = item.text;\n\t\t\t\t\t\tthis.modeSwitcherPopup.close();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t}\n\t\t\t],\n\t\t\tswitcherId = 'mode-switcher-' + Math.round(Math.random() * 100000);\n\n\n\t\tEvent.bind(wrapNode, 'click', function(){\n\t\t\tif (this.modeSwitcherPopup && this.modeSwitcherPopup.popupWindow && this.modeSwitcherPopup.popupWindow.isShown())\n\t\t\t{\n\t\t\t\treturn this.modeSwitcherPopup.close();\n\t\t\t}\n\n\t\t\tthis.modeSwitcherPopup = BX.PopupMenu.create(\n\t\t\t\tswitcherId,\n\t\t\t\twrapNode,\n\t\t\t\tmenuItems,\n\t\t\t\t{\n\t\t\t\t\tcloseByEsc : true,\n\t\t\t\t\tautoHide : true,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 20,\n\t\t\t\t\tangle: true\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis.modeSwitcherPopup.show();\n\n\t\t\tBX.addCustomEvent(this.modeSwitcherPopup.popupWindow, 'onPopupClose', function()\n\t\t\t{\n\t\t\t\tBX.PopupMenu.destroy(switcherId);\n\t\t\t\tthis.modeSwitcherPopup = null;\n\t\t\t}.bind(this));\n\t\t}.bind(this));\n\n\t\tif (this.params.useUsers && !this.params.useResources)\n\t\t{\n\t\t\twrapNode.innerHTML = Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_USERS');\n\t\t}\n\t\telse if (this.params.useUsers && this.params.useResources)\n\t\t{\n\t\t\twrapNode.innerHTML = Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES_AND_USERS');\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapNode.innerHTML = Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES');\n\t\t}\n\n\t\treturn wrapNode;\n\t}\n\n\tgetOuterWrap()\n\t{\n\t\treturn this.outerWrap;\n\t}\n}\n","import {BookingUtil} from \"calendar.resourcebooking\";\nimport {ServiceSelector} from \"./controls/serviceselector\"\nimport {UserSelectorFieldEditControl} from \"./controls/userselectorfieldeditcontrol\";\nimport {ResourceSelectorFieldEditControl} from \"./controls/resourceselectorfieldeditcontrol\";\nimport {TimezoneSelector} from \"./controls/timezoneselector\";\nimport {ModeSelector} from \"./controls/modeselector\";\nimport {ResourcebookingUserfield} from \"calendar.resourcebookinguserfield\";\n\nexport let customizeCrmEntityEditor = function(CrmConfigurator)\n{\n\tlet Configurator = function()\n\t{\n\t\tConfigurator.superclass.constructor.apply(this);\n\t};\n\tBX.extend(Configurator, CrmConfigurator);\n\n\tConfigurator.create = function(id, settings)\n\t{\n\t\tlet self = new Configurator();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t};\n\n\tConfigurator.prototype.layout = function(options, params)\n\t{\n\t\tif(this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif(!BX.type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {}\n\t\t}\n\n\t\tif(this._mode === BX.Crm.EntityEditorMode.view)\n\t\t{\n\t\t\tthrow \"EntityEditorUserFieldConfigurator. View mode is not supported by this control type.\";\n\t\t}\n\n\t\tthis.getBitrix24Limitation({\n\t\t\tcallback: BX.delegate(function(limit)\n\t\t\t{\n\t\t\t\tthis.RESOURCE_LIMIT = limit;\n\t\t\t}, this)\n\t\t});\n\n\t\tif(this._field)\n\t\t{\n\t\t\tthis.fieldInfo = this._field.getFieldInfo();\n\t\t}\n\t\telse if (!params.settings)\n\t\t{\n\t\t\treturn this.getDefaultUserfieldSettings({\n\t\t\t\tdisplayCallback: BX.delegate(function(settings)\n\t\t\t\t{\n\t\t\t\t\tthis.layout(options, {settings: settings});\n\t\t\t\t}, this)\n\t\t\t});\n\t\t}\n\n\t\tthis._wrapper = BX.create(\"div\", {props: {className: \"calendar-resourcebook-content\"}});\n\t\tthis._innerWrapper = this._wrapper\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-wrap\"}}))\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-inner\"}}));\n\n\t\tvar\n\t\t\tfieldSettings = this.fieldInfo ? this.fieldInfo.SETTINGS : params.settings,\n\t\t\tresourceList = [],\n\t\t\tselectedResourceList = [],\n\t\t\tisNew = this._field === null,\n\t\t\ttitle = this.getMessage(\"labelField\"),\n\t\t\tmanager = this._editor.getUserFieldManager(),\n\t\t\tlabel = this._field ? this._field.getTitle() : manager.getDefaultFieldLabel(this._typeId);\n\n\t\tthis.RESOURCE_LIMIT = fieldSettings.RESOURCE_LIMIT || 0;\n\n\t\t// region Field Title\n\t\tthis._labelInput = BX.create(\"input\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"crm-entity-widget-content-input\",\n\t\t\t\t\t\ttype: \"text\",\n\t\t\t\t\t\tvalue: label\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._innerWrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t// Title\n\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-widget-content-block-title\" },\n\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-widget-content-block-title-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\ttext: title\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t// Input\n\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-field\" },\n\t\t\t\t\t\t\t\t\tchildren: [ this._labelInput ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t// Hr\n\t\t\t\t\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t// endregion\n\n\t\t// region Users&Resources Mode selector\n\t\tthis._innerWrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-title-text\"},\n\t\t\t\t\t\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_CHOOSE')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tnew ModeSelector({\n\t\t\t\t\t\t\t\tuseResources: fieldSettings.USE_RESOURCES === 'Y',\n\t\t\t\t\t\t\t\tuseUsers: fieldSettings.USE_USERS === 'Y',\n\t\t\t\t\t\t\t\tshowUsers: function()\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.resourceList.hide();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResources: function()\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.hide();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResourcesAndUsers: function()\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t\t\t}).getOuterWrap()\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t// endregion\n\n\t\tvar optionWrapper = this._innerWrapper.appendChild(BX.create(\n\t\t\t\"div\",\n\t\t\t{\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" }\n\t\t\t}\n\t\t));\n\n\t\t// region Use Resources Option\n\t\tthis.resourcesWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.resourcesTitleWrap = this.resourcesWrap\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_RESOURCE_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.resourcesListWrap = this.resourcesWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-new-entries-wrap calendar-resourcebook-content-block-detail-inner\"}}));\n\n\t\tthis.resourcesListLowControls = this.resourcesWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resource-content-block-add-field\"}}));\n\n\t\tif (fieldSettings.RESOURCES\n\t\t\t&& BX.type.isPlainObject(fieldSettings.RESOURCES['resource'])\n\t\t\t&& BX.type.isArray(fieldSettings.RESOURCES['resource'].SECTIONS))\n\t\t{\n\t\t\tfieldSettings.RESOURCES['resource'].SECTIONS.forEach(function(resource)\n\t\t\t{\n\t\t\t\tresourceList.push({\n\t\t\t\t\tid: resource.ID,\n\t\t\t\t\ttitle: resource.NAME,\n\t\t\t\t\ttype: resource.CAL_TYPE\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tif (BX.type.isArray(fieldSettings.SELECTED_RESOURCES))\n\t\t{\n\t\t\tfieldSettings.SELECTED_RESOURCES.forEach(function(resource)\n\t\t\t{\n\t\t\t\tselectedResourceList.push({\n\t\t\t\t\tid: resource.id,\n\t\t\t\t\ttype: resource.type\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.resourceList = new ResourceSelectorFieldEditControl({\n\t\t\tshown: fieldSettings.USE_RESOURCES === 'Y',\n\t\t\teditMode: true,\n\t\t\touterWrap: this.resourcesWrap,\n\t\t\tlistWrap: this.resourcesListWrap,\n\t\t\tcontrolsWrap: this.resourcesListLowControls,\n\t\t\tvalues: selectedResourceList,\n\t\t\tresourceList: resourceList,\n\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this),\n\t\t\tcheckLimitCallbackForNew: this.checkResourceCountLimitForNewEntries.bind(this)\n\t\t});\n\t\t// endregion\n\n\t\t// region Users Selector\n\t\tthis.userSelectorWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.usersTitleWrap = this.userSelectorWrap\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_USERS_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.usersListWrap = this.userSelectorWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control\"}}));\n\n\t\tvar itemsSelected = [];\n\t\tif (BX.type.isArray(fieldSettings.SELECTED_USERS))\n\t\t{\n\t\t\tfieldSettings.SELECTED_USERS.forEach(function(user)\n\t\t\t{\n\t\t\t\titemsSelected.push('U' + parseInt(user));\n\t\t\t});\n\t\t}\n\n\t\tthis.userList = new UserSelectorFieldEditControl({\n\t\t\tshown: fieldSettings.USE_USERS === 'Y',\n\t\t\touterWrap: this.userSelectorWrap,\n\t\t\twrapNode: this.usersListWrap,\n\t\t\tsocnetDestination: ResourcebookingUserfield.getSocnetDestination(),\n\t\t\titemsSelected: itemsSelected,\n\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this)\n\t\t});\n\t\t// endregion\n\n\t\t// Region Data, Time and services\n\t\toptionWrapper.appendChild(\n\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } })\n\t\t);\n\n\t\tthis.datetimeOptionsWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\" }}));\n\n\t\tthis.datetimeOptionsWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}})).appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_DATETIME_BLOCK_TITLE') + ':'}));\n\n\t\tthis.datetimeOptionsInnerWrap = this.datetimeOptionsWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-options\"}}));\n\n\t\tthis.timezoneSettingsWrap = optionWrapper.appendChild(\n\t\t\tBX.create(\"div\", {props: {\n\t\t\t\t\tclassName: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-options\" },\n\t\t\t\tstyle: {display: fieldSettings.FULL_DAY === 'Y' ? 'none' : ''}\n\t\t\t}));\n\n\t\tthis.timezoneSettingsWrap.appendChild(BX.create(\"hr\", {props: {className: \"crm-entity-widget-hr\"}}));\n\t\tthis.timezoneSettingsWrap\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(BX.create(\"span\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_TIMEZONE_SETTINGS_TITLE') + ':'}));\n\n\t\tthis.timezoneSelectorWrap = this.timezoneSettingsWrap.appendChild(BX.create(\"div\", {\n\t\t\tstyle: {display: fieldSettings.USE_USER_TIMEZONE === 'Y' ? 'none' : ''}\n\t\t}));\n\n\t\tthis.timezoneSelectWrap = this.timezoneSelectorWrap\n\t\t\t.appendChild(BX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-field\" }\n\t\t\t\t}\n\t\t\t));\n\n\n\t\tthis.timezoneSelector = new TimezoneSelector({\n\t\t\touterWrap: this.timezoneSelectWrap,\n\t\t\tselectedValue: fieldSettings.TIMEZONE\n\t\t});\n\n\t\tthis.useUserTimezoneCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: fieldSettings.USE_USER_TIMEZONE === 'Y'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis.timezoneSettingsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.useUserTimezoneCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_USE_USER_TIMEZONE') })\n\t\t\t\t\t\t],\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: BX.proxy(this.handleUserTimezoneCheckbox, this)\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t// endregion\n\n\t\t//region Checkbox \"Full day\"\n\t\tthis._fulldayCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: fieldSettings.FULL_DAY === 'Y'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick: BX.proxy(this.handleFullDayMode, this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._fulldayCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_FULL_DAY') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Add services\"\n\t\tthis._servicesCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: fieldSettings.USE_SERVICES === 'Y'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick : BX.delegate(function(){\n\t\t\t\t\t\tif (this.serviceList)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.serviceList.show(this._servicesCheckBox.checked);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._servicesCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_ADD_SERVICES') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.serviceList = new ServiceSelector({\n\t\t\touterCont: this.datetimeOptionsInnerWrap,\n\t\t\tonFullClearHandler: function()\n\t\t\t{\n\t\t\t\tthis._servicesCheckBox.checked = false;\n\t\t\t}.bind(this),\n\t\t\tfieldSettings: fieldSettings,\n\t\t\tgetFullDayValue: function(){return this._fulldayCheckBox.checked}.bind(this)\n\t\t});\n\n\t\toptionWrapper.appendChild(\n\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } })\n\t\t);\n\n\t\t//region Checkbox \"Is Required\"\n\t\tthis.additionaOptionsWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-options\"}}));\n\n\t\tthis._isRequiredCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{ props: { type: \"checkbox\", checked: this._field && this._field.isRequired() } }\n\t\t);\n\n\t\tthis.additionaOptionsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._isRequiredCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: this.getMessage(\"isRequiredField\") })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Show Always\"\n\t\tthis._showAlwaysCheckBox = BX.create(\"input\", { props: { type: \"checkbox\" } });\n\t\tif(isNew)\n\t\t{\n\t\t\tthis._showAlwaysCheckBox.checked = BX.prop.getBoolean(this._settings, \"showAlways\", true);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._showAlwaysCheckBox.checked = this._field.checkOptionFlag(\n\t\t\t\tBX.Crm.EntityEditorControlOptions.showAlways\n\t\t\t);\n\t\t}\n\t\tthis.additionaOptionsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._showAlwaysCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: this.getMessage(\"showAlways\") })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Overbooking\"\n\t\tthis._overbookingCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{ props: { type: \"checkbox\", checked: fieldSettings.ALLOW_OVERBOOKING === 'Y'} }\n\t\t);\n\n\t\tthis.additionaOptionsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._overbookingCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_OVERBOOKING') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\tthis._innerWrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: \"calendar-resourcebook-content-block-btn-container\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } }),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"button\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: {type: \"button\", className: \"ui-btn ui-btn-sm ui-btn-primary\"},\n\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_EDITOR_SAVE\"),\n\t\t\t\t\t\t\t\tevents: {  click: BX.delegate(this.onSaveButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"button\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: {type: \"button\", className: \"ui-btn ui-btn-sm ui-btn-light-border\" },\n\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_EDITOR_CANCEL\"),\n\t\t\t\t\t\t\t\tevents: {  click: BX.delegate(this.onCancelButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.fieldSettings = fieldSettings;\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t};\n\n\tConfigurator.prototype.getDefaultUserfieldSettings = function(params)\n\t{\n\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getdefaultuserfieldsettings', {\n\t\t\tdata: {}\n\t\t}).then(function (response)\n\t\t\t{\n\t\t\t\tif (params && BX.type.isFunction(params.displayCallback))\n\t\t\t\t{\n\t\t\t\t\tparams.displayCallback(response.data);\n\t\t\t\t}\n\t\t\t},\n\t\t\tfunction (response) {\n\t\t\t\t/**\n\t\t\t\t {\n\t\t\t\t\t\t \"status\": \"error\",\n\t\t\t\t\t\t \"errors\": [...]\n\t\t\t\t\t }\n\t\t\t\t **/\n\t\t\t});\n\t};\n\n\tConfigurator.prototype.getBitrix24Limitation = function(params)\n\t{\n\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getbitrix24limitation', {\n\t\t\tdata: {}\n\t\t}).then(function (response)\n\t\t\t{\n\t\t\t\tif (params && BX.type.isFunction(params.callback))\n\t\t\t\t{\n\t\t\t\t\tparams.callback(response.data);\n\t\t\t\t}\n\t\t\t},\n\t\t\tfunction (response) {\n\t\t\t\t/**\n\t\t\t\t {\n\t\t\t\t\t\t \"status\": \"error\",\n\t\t\t\t\t\t \"errors\": [...]\n\t\t\t\t\t }\n\t\t\t\t **/\n\t\t\t});\n\t};\n\n\tConfigurator.prototype.onSaveButtonClick = function()\n\t{\n\t\tif(this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.RESOURCE_LIMIT > 0 && this.getTotalResourceCount() > this.RESOURCE_LIMIT)\n\t\t{\n\t\t\tBookingUtil.showLimitationPopup();\n\t\t\treturn;\n\t\t}\n\n\t\tvar params =\n\t\t\t{\n\t\t\t\ttypeId: this._typeId,\n\t\t\t\tlabel: this._labelInput.value,\n\t\t\t\tmandatory: this._isRequiredCheckBox.checked,\n\t\t\t\tshowAlways: this._showAlwaysCheckBox.checked,\n\t\t\t\tmultiple: true\n\t\t\t};\n\n\t\tif(this._field)\n\t\t{\n\t\t\tparams[\"field\"] = this._field;\n\t\t}\n\n\t\tthis.fieldSettings.USE_RESOURCES = this.resourceList.isShown() ? 'Y' : 'N';\n\t\tthis.fieldSettings.USE_USERS = this.userList.isShown() ? 'Y' : 'N';\n\n\t\tif (this.fieldSettings\n\t\t\t&& BX.type.isPlainObject(this.fieldSettings.RESOURCES)\n\t\t\t&& BX.type.isPlainObject(this.fieldSettings.RESOURCES['resource']))\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_RESOURCES = [];\n\n\t\t\tthis.resourceList.getSelectedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tthis.fieldSettings.SELECTED_RESOURCES.push(value);\n\t\t\t}, this);\n\n\t\t\tthis.resourceList.getDeletedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tthis.fieldSettings.SELECTED_RESOURCES.push(value);\n\t\t\t}, this);\n\t\t}\n\n\n\t\tif (this.fieldSettings && this.userList)\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_USERS = [0];\n\t\t\tthis.userList.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tthis.fieldSettings.SELECTED_USERS.push(parseInt(code.substr(1)));\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.fieldSettings.USE_SERVICES = this._servicesCheckBox.checked ? 'Y' : 'N';\n\t\tthis.fieldSettings.SERVICE_LIST = [];\n\t\tif (this._servicesCheckBox.checked && this.serviceList)\n\t\t{\n\t\t\tthis.fieldSettings.SERVICE_LIST = this.serviceList.getValues();\n\t\t}\n\n\t\tthis.fieldSettings.FULL_DAY = this._fulldayCheckBox.checked ? 'Y' : 'N';\n\t\tthis.fieldSettings.ALLOW_OVERBOOKING = this._overbookingCheckBox.checked ? 'Y' : 'N';\n\n\t\tif (this.fieldSettings.FULL_DAY === 'N')\n\t\t{\n\t\t\tthis.fieldSettings.TIMEZONE = this.timezoneSelector.getValue();\n\t\t\tthis.fieldSettings.USE_USER_TIMEZONE = this.useUserTimezoneCheckBox.checked ? 'Y' : 'N';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fieldSettings.TIMEZONE = '';\n\t\t\tthis.fieldSettings.USE_USER_TIMEZONE = 'N';\n\t\t}\n\n\t\tparams[\"settings\"] = this.fieldSettings;\n\n\t\tBX.onCustomEvent(this, \"onSave\", [ this, params]);\n\t};\n\n\tConfigurator.prototype.getTotalResourceCount = function()\n\t{\n\t\tvar result = 0;\n\n\t\tif (this.fieldSettings)\n\t\t{\n\t\t\tif (BX.type.isPlainObject(this.fieldSettings.RESOURCES)\n\t\t\t\t&& BX.type.isPlainObject(this.fieldSettings.RESOURCES.resource)\n\t\t\t\t&& BX.type.isArray(this.fieldSettings.RESOURCES.resource.SECTIONS)\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult += this.fieldSettings.RESOURCES.resource.SECTIONS.length;\n\t\t\t}\n\n\t\t\tresult -= this.resourceList.getDeletedValues().length;\n\n\t\t\tthis.resourceList.getSelectedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tif (!value.id && value.title !== '')\n\t\t\t\t{\n\t\t\t\t\tresult++;\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tif (this.userList)\n\t\t\t{\n\t\t\t\tresult += this.userList.getAttendeesCodesList().length;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t};\n\n\tConfigurator.prototype.checkResourceCountLimitForNewEntries = function()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() < this.RESOURCE_LIMIT;\n\t};\n\n\tConfigurator.prototype.checkResourceCountLimit = function()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() <= this.RESOURCE_LIMIT;\n\t};\n\n\tConfigurator.prototype.handleFullDayMode = function()\n\t{\n\t\tthis.timezoneSettingsWrap.style.display = this._fulldayCheckBox.checked ? 'none' : '';\n\t};\n\n\tConfigurator.prototype.handleUserTimezoneCheckbox = function()\n\t{\n\t\tthis.timezoneSelectorWrap.style.display = this.useUserTimezoneCheckBox.checked ? 'none' : '';\n\t};\n\n\n\treturn Configurator;\n};","export class CalendarViewSettingsSlider\n{\n\tconstructor(params)\n\t{\n\t\tthis.id = 'calendar_custom_settings_' + Math.round(Math.random() * 1000000);\n\t\tthis.zIndex = 3100;\n\t\tthis.sliderId = \"calendar:resbook-settings-slider\";\n\n\t\tthis.SLIDER_WIDTH = 400;\n\t\tthis.SLIDER_DURATION = 80;\n\t\tthis.DOM = {};\n\n\t\tthis.params = params;\n\t}\n\n\tshow()\n\t{\n\t\tBX.SidePanel.Instance.open(this.sliderId, {\n\t\t\tcontentCallback: BX.delegate(this.create, this),\n\t\t\twidth: this.SLIDER_WIDTH,\n\t\t\tanimationDuration: this.SLIDER_DURATION\n\t\t});\n\n\t\tthis.hideHandler = this.hide.bind(this);\n\t\tthis.destroyHandler = this.destroy.bind(this);\n\t\tBX.addCustomEvent(\"SidePanel.Slider:onClose\", this.hideHandler);\n\t\tBX.addCustomEvent(\"SidePanel.Slider:onCloseComplete\", );\n\t}\n\n\tclose()\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t}\n\n\thide(event)\n\t{\n\t\tif (event && event.getSliderPage && event.getSliderPage().getUrl() === this.sliderId)\n\t\t{\n\t\t\t// if (this.denyClose)\n\t\t\t// {\n\t\t\t// \tevent.denyAction();\n\t\t\t// }\n\t\t\t// else\n\t\t\t// {\n\t\t\t\tBX.removeCustomEvent(\"SidePanel.Slider:onClose\", this.hideHandler);\n\t\t\t//}\n\t\t}\n\t}\n\n\tdestroy(event)\n\t{\n\t\tif (event && event.getSliderPage && event.getSliderPage().getUrl() === this.sliderId)\n\t\t{\n\t\t\tBX.removeCustomEvent(\"SidePanel.Slider:onCloseComplete\", this.destroyHandler);\n\t\t\tBX.SidePanel.Instance.destroy(this.sliderId);\n\t\t}\n\t}\n\n\tcreate()\n\t{\n\t\tlet promise = new BX.Promise();\n\n\t\tlet html = '<div class=\"webform-buttons calendar-form-buttons-fixed\">' +\n\t\t\t'<span id=\"' + this.id + '_save\" class=\"webform-small-button webform-small-button-blue\">' + BX.message('USER_TYPE_RESOURCE_SAVE') + '</span>' +\n\t\t\t'<span id=\"' + this.id + '_close\" class=\"webform-button-link\">' + BX.message('USER_TYPE_RESOURCE_CLOSE') + '</span>' +\n\t\t\t'</div>' +\n\t\t\t'<div class=\"calendar-slider-calendar-wrap\">' +\n\t\t\t'<div class=\"calendar-slider-header\"><div class=\"calendar-head-area\"><div class=\"calendar-head-area-inner\"><div class=\"calendar-head-area-title\">' +\n\t\t\t'<span class=\"calendar-head-area-name\">' + BX.message('USER_TYPE_RESOURCE_SETTINGS') + \t\t\t'</span>' +\n\t\t\t'</div></div></div></div>' +\n\t\t\t'<div class=\"resource-booking-slider-workarea\"><div class=\"resource-booking-slider-content\"><div id=\"' + this.id + '_content\" class=\"resource-booking-settings\"></div></div></div></div>';\n\n\t\tpromise.fulfill(BX.util.trim(html));\n\t\tsetTimeout(this.initControls.bind(this), 100);\n\n\t\treturn promise;\n\t}\n\n\tinitControls()\n\t{\n\t\tthis.DOM.content = BX(this.id + '_content');\n\n\t\tBX.bind(BX(this.id + '_save'), 'click', this.save.bind(this));\n\t\tBX.bind(BX(this.id + '_close'), 'click', this.close.bind(this));\n\n\t\t// 1. Field\n\t\tif (this.params && BX.type.isArray(this.params.filterSelectValues))\n\t\t{\n\t\t\tthis.DOM.fieldOuterWrap = this.DOM.content.appendChild(BX.create('DIV', {attrs: {className: 'calendar-settings-control'}}));\n\t\t\tthis.DOM.fieldOuterWrap.appendChild(BX.create('DIV', {\n\t\t\t\tattrs: {className: 'calendar-settings-control-name'},\n\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_FILTER_NAME')\n\t\t\t}));\n\n\t\t\tthis.DOM.fieldSelect = this.DOM.fieldOuterWrap.appendChild(BX.create('DIV', {attrs: {className: 'calendar-field-container calendar-field-container-select'}}))\n\t\t\t\t.appendChild(BX.create('DIV', {attrs: {className: 'calendar-field-block'}}))\n\t\t\t\t.appendChild(BX.create('select', {attrs: {className: 'calendar-field calendar-field-select'}}));\n\n\t\t\tthis.params.filterSelectValues.forEach(function(value){\n\t\t\t\tthis.DOM.fieldSelect.options.add(\n\t\t\t\t\tnew Option(value.TEXT, value.VALUE, this.params.filterSelect === value.VALUE, this.params.filterSelect === value.VALUE));\n\t\t\t}, this);\n\t\t}\n\t}\n\n\tsave()\n\t{\n\t\tlet entityType = this.params.entityType || 'none';\n\t\tBX.userOptions.save('calendar', 'resourceBooking', entityType, this.DOM.fieldSelect.value);\n\t\tthis.close();\n\t\tBX.reload();\n\t}\n}\n\n\n\n","import {Event, Dom, Loc, Type} from \"calendar.resourcebooking\";\nimport {ServiceSelector} from \"./controls/serviceselector\"\nimport {UserSelectorFieldEditControl} from \"./controls/userselectorfieldeditcontrol\";\nimport {ModeSelector} from \"./controls/modeselector\";\nimport {ResourceSelectorFieldEditControl} from \"./controls/resourceselectorfieldeditcontrol\";\n\nexport class AdminSettingsViewer\n{\n\tconstructor(params = {})\n\t{\n\t\tthis.params = Type.isPlainObject(params) ? params : {};\n\t\tthis.fieldSettings = Type.isPlainObject(this.params.settings) ? this.params.settings : {};\n\n\t\tthis.DOM = {\n\t\t\touterWrap: document.getElementById(this.params.outerWrapId),\n\t\t\tform: document.forms[this.params.formName]\n\t\t};\n\t}\n\n\tshowLayout()\n\t{\n\t\tif (!this.DOM.outerWrap || !this.DOM.form)\n\t\t\treturn;\n\n\t\tEvent.bind(this.DOM.form, 'submit', this.onSubmit.bind(this));\n\n\t\tDom.addClass(this.DOM.outerWrap, 'calendar-resourcebook-content calendar-resourcebook-content-admin-settings');\n\n\t\tthis.DOM.innerWrap = this.DOM.outerWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-wrap\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-inner\"}}));\n\n\t\tlet\n\t\t\tresourceList = [],\n\t\t\tselectedResourceList = [];\n\n\t\tthis.DOM.innerWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tDom.create(\n\t\t\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-title-text\"},\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tnew ModeSelector({\n\t\t\t\t\t\t\t\tuseResources: this.fieldSettings.USE_RESOURCES === 'Y',\n\t\t\t\t\t\t\t\tuseUsers: this.fieldSettings.USE_USERS === 'Y',\n\t\t\t\t\t\t\t\tshowUsers: function(){\n\t\t\t\t\t\t\t\t\tthis.resourceList.hide();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResources: function(){\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.hide();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResourcesAndUsers: function(){\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t\t\t}).getOuterWrap()\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.DOM.optionWrap = this.DOM.innerWrap.appendChild(Dom.create(\n\t\t\t\"div\",\n\t\t\t{\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" }\n\t\t\t}\n\t\t));\n\n\t\t// region Use Resources Option\n\t\tthis.resourcesWrap = this.DOM.optionWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.resourcesTitleWrap = this.resourcesWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: Loc.getMessage('USER_TYPE_RESOURCE_RESOURCE_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.resourcesListWrap = this.resourcesWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-new-entries-wrap calendar-resourcebook-content-block-detail-inner\"}}));\n\n\t\tthis.resourcesListLowControls = this.resourcesWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resource-content-block-add-field\"}}));\n\n\t\tif (this.fieldSettings.RESOURCES\n\t\t\t&& Type.isPlainObject(this.fieldSettings.RESOURCES['resource'])\n\t\t\t&& Type.isArray(this.fieldSettings.RESOURCES['resource'].SECTIONS))\n\t\t{\n\t\t\tthis.fieldSettings.RESOURCES['resource'].SECTIONS.forEach(function(resource)\n\t\t\t{\n\t\t\t\tresourceList.push({\n\t\t\t\t\tid: resource.ID,\n\t\t\t\t\ttitle: resource.NAME,\n\t\t\t\t\ttype: resource.CAL_TYPE\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArray(this.fieldSettings.SELECTED_RESOURCES))\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_RESOURCES.forEach(function(resource)\n\t\t\t{\n\t\t\t\tselectedResourceList.push({\n\t\t\t\t\tid: resource.id,\n\t\t\t\t\ttype: resource.type\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.resourceList = new ResourceSelectorFieldEditControl({\n\t\t\tshown: this.fieldSettings.USE_RESOURCES === 'Y',\n\t\t\teditMode: true,\n\t\t\touterWrap: this.resourcesWrap,\n\t\t\tlistWrap: this.resourcesListWrap,\n\t\t\tcontrolsWrap: this.resourcesListLowControls,\n\t\t\tvalues: selectedResourceList,\n\t\t\tresourceList: resourceList,\n\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this)\n\t\t});\n\n\t\tthis.userSelectorWrap = this.DOM.optionWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.usersTitleWrap = this.userSelectorWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: Loc.getMessage('USER_TYPE_RESOURCE_USERS_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.usersListWrap = this.userSelectorWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control custom-field-item\"}}));\n\n\t\tlet itemsSelected = [];\n\t\tif (Type.isArray(this.fieldSettings.SELECTED_USERS))\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_USERS.forEach(function(user)\n\t\t\t{\n\t\t\t\titemsSelected.push('U' + parseInt(user));\n\t\t\t});\n\t\t}\n\n\t\tthis.userList = new UserSelectorFieldEditControl({\n\t\t\tshown: this.fieldSettings.USE_USERS === 'Y',\n\t\t\touterWrap: this.userSelectorWrap,\n\t\t\twrapNode: this.usersListWrap,\n\t\t\tsocnetDestination: this.params.socnetDestination,\n\t\t\titemsSelected: itemsSelected\n\t\t});\n\n\t\t// Region Data, Time and services\n\t\tthis.DOM.optionWrap.appendChild(\n\t\t\tDom.create(\"hr\", { props: { className: \"calendar-resbook-hr\"}})\n\t\t);\n\n\t\tthis.datetimeOptionsWrap = this.DOM.optionWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\" }}));\n\n\t\tthis.datetimeOptionsWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}})).appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: Loc.getMessage('USER_TYPE_RESOURCE_DATETIME_BLOCK_TITLE') + ':'}));\n\n\t\tthis.datetimeOptionsInnerWrap = this.datetimeOptionsWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-options\"}}));\n\t\t// endregion\n\n\t\t//region Checkbox \"Full day\"\n\t\tthis.DOM.fulldayCheckBox = Dom.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: { type: \"checkbox\", checked: this.fieldSettings.FULL_DAY === 'Y'}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.DOM.fulldayCheckBox,\n\t\t\t\t\t\t\tDom.create(\"span\", { text: Loc.getMessage('USER_TYPE_RESOURCE_FULL_DAY') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Add services\"\n\t\tthis.DOM.useServicedayCheckBox = Dom.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: this.fieldSettings.USE_SERVICES === 'Y'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'click' : function(){\n\t\t\t\t\t\tif (this.serviceList)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.serviceList.show(this.DOM.useServicedayCheckBox.checked);\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.DOM.useServicedayCheckBox,\n\t\t\t\t\t\t\tDom.create(\"span\", { text: Loc.getMessage('USER_TYPE_RESOURCE_ADD_SERVICES') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.serviceList = new ServiceSelector({\n\t\t\touterCont: this.datetimeOptionsInnerWrap,\n\t\t\tfieldSettings: this.fieldSettings,\n\t\t\tgetFullDayValue: function(){return this.DOM.fulldayCheckBox.checked}.bind(this)\n\t\t});\n\n\t\tthis.DOM.optionWrap.appendChild(\n\t\t\tDom.create(\"hr\", { props: { className: \"calendar-resbook-hr\"}})\n\t\t);\n\n\t\tthis.DOM.overbookingCheckbox = Dom.create(\"input\", {props: {type: \"checkbox\", checked: this.fieldSettings.ALLOW_OVERBOOKING === 'Y'}});\n\n\t\tthis.DOM.optionWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.DOM.overbookingCheckbox,\n\t\t\t\t\t\t\tDom.create(\"span\", { text: Loc.getMessage('USER_TYPE_RESOURCE_OVERBOOKING') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\t}\n\n\tonSubmit(e)\n\t{\n\t\tif (!this.DOM.inputsWrap)\n\t\t{\n\t\t\tthis.DOM.inputsWrap = this.DOM.outerWrap.appendChild(Dom.create(\"DIV\"));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.clean(this.DOM.inputsWrap);\n\t\t}\n\n\t\tlet inputName = this.params.htmlControl.NAME;\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[USE_USERS]',\n\t\t\t\tvalue: this.userList.isShown() ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[USE_RESOURCES]',\n\t\t\t\tvalue: this.resourceList.isShown() ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[USE_SERVICES]',\n\t\t\t\tvalue: this.DOM.useServicedayCheckBox.checked ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[FULL_DAY]',\n\t\t\t\tvalue: this.DOM.fulldayCheckBox.checked ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[ALLOW_OVERBOOKING]',\n\t\t\t\tvalue: this.DOM.overbookingCheckbox.checked ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\t// Selected resources\n\t\tif (this.resourceList)\n\t\t{\n\t\t\tthis.prepareFormDataInputs(this.DOM.inputsWrap, this.resourceList.getSelectedValues().concat(this.resourceList.getDeletedValues()), inputName + '[SELECTED_RESOURCES]');\n\t\t}\n\n\t\t// // Selected users\n\t\tif (this.userList)\n\t\t{\n\t\t\tlet SELECTED_USERS = [];\n\t\t\tthis.userList.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tSELECTED_USERS.push(parseInt(code.substr(1)));\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tthis.prepareFormDataInputs(this.DOM.inputsWrap, SELECTED_USERS, inputName + '[SELECTED_USERS]');\n\t\t}\n\n\t\tif (this.DOM.useServicedayCheckBox.checked && this.serviceList)\n\t\t{\n\t\t\tthis.prepareFormDataInputs(this.DOM.inputsWrap, this.serviceList.getValues(), inputName + '[SERVICE_LIST]');\n\t\t}\n\t}\n\n\tprepareFormDataInputs(wrap, data, inputName)\n\t{\n\t\tdata.forEach(function(value, ind)\n\t\t{\n\t\t\tif (Type.isPlainObject(value))\n\t\t\t{\n\t\t\t\tlet k;\n\t\t\t\tfor (k in value)\n\t\t\t\t{\n\t\t\t\t\tif (value.hasOwnProperty(k))\n\t\t\t\t\t{\n\t\t\t\t\t\twrap.appendChild(Dom.create('INPUT', {\n\t\t\t\t\t\t\tattrs:{\n\t\t\t\t\t\t\t\tname: inputName + '[' + ind + '][' + k + ']',\n\t\t\t\t\t\t\t\tvalue: value[k],\n\t\t\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t\t\t}}));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twrap.appendChild(Dom.create('INPUT', {\n\t\t\t\t\tattrs:{\n\t\t\t\t\t\tname: inputName + '[' + ind + ']',\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t}}));\n\t\t\t}\n\t\t}, this);\n\t}\n\n\tgetTotalResourceCount()\n\t{\n\t\tlet result = 0;\n\n\t\tif (this.fieldSettings)\n\t\t{\n\t\t\tif (Type.isPlainObject(this.fieldSettings.RESOURCES)\n\t\t\t\t&& Type.isPlainObject(this.fieldSettings.RESOURCES.resource)\n\t\t\t\t&& Type.isArray(this.fieldSettings.RESOURCES.resource.SECTIONS)\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult += this.fieldSettings.RESOURCES.resource.SECTIONS.length;\n\t\t\t}\n\n\t\t\tif (this.resourceList)\n\t\t\t{\n\t\t\t\tresult -= this.resourceList.getDeletedValues().length;\n\n\t\t\t\tthis.resourceList.getSelectedValues().forEach(function(value)\n\t\t\t\t{\n\t\t\t\t\tif (!value.id && value.title !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tresult++;\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\t\t\t}\n\n\t\t\tif (this.userList)\n\t\t\t{\n\t\t\t\tresult += this.userList.getAttendeesCodesList().length;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tcheckResourceCountLimitForNewEntries()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() < this.RESOURCE_LIMIT;\n\t}\n\n\tcheckResourceCountLimit()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() <= this.RESOURCE_LIMIT;\n\t}\n}","import {AdjustFieldController} from \"./adjustfieldcontroller\";\nimport {EditFieldController} from \"./editfieldcontroller\";\nimport {Type} from \"main.core\";\nimport {Resourcebooking, BookingUtil} from \"calendar.resourcebooking\";\nimport {customizeCrmEntityEditor} from \"./customizecrmentityeditor\"\nimport {CalendarViewSettingsSlider} from \"./calendarviewsettingsslider\"\nimport {AdminSettingsViewer} from \"./adminsettingsviewer\"\n\nexport {Resourcebooking, BookingUtil, AdminSettingsViewer};\nexport class ResourcebookingUserfield\n{\n\tstatic fieldParamsCache = {};\n\tstatic socnetDestination = null;\n\n\t/**\n\t * Creates instance of Resourcebooking field for crm form edit interface (not for live form)\n\t * and initialize it with given field params\n\t * Used in CRM webform module to display and adjust resourcebooking field\n\t *\n\t * @param {array} params - incoming data params\n\t */\n\tstatic initCrmFormFieldController(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {\n\t\t\t\tfield:{}\n\t\t\t};\n\t\t}\n\n\t\tlet bookingFieldParams = {};\n\t\tif (Type.isDomNode(params.field.node))\n\t\t{\n\t\t\tbookingFieldParams.outerWrap = params.field.node;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new Error(\"The argument \\\"params.field.node\\\" must be a DOM node.\");\n\t\t}\n\n\t\tbookingFieldParams.innerWrap = bookingFieldParams.outerWrap.querySelector('.crm-webform-resourcebooking-wrap');\n\t\tif (!bookingFieldParams.innerWrap)\n\t\t{\n\t\t\tthrow new Error(\"Can't find necessary DOM node \\\"div.crm-webform-resourcebooking-wrap\\\"\");\n\t\t}\n\n\t\tbookingFieldParams.name = params.field.name;\n\t\tbookingFieldParams.formName = 'FIELD[' + params.field.name + ']';\n\t\tbookingFieldParams.captionNode = params.field.lblCaption;\n\t\tbookingFieldParams.entityFieldName = params.field.entity_field_name;\n\t\tbookingFieldParams.entityName = params.field.dict.entity_field_name;\n\n\t\tbookingFieldParams.settings = {\n\t\t\tcaption: params.field.captionValue || params.field.dict.caption,\n\t\t\trequired: params.field.isRequired || params.field.dict.required,\n\t\t\tdata: params.field.settingsData || []\n\t\t};\n\n\t\tlet adjustFieldController = new AdjustFieldController(bookingFieldParams);\n\t\tadjustFieldController.init();\n\t\treturn adjustFieldController;\n\t}\n\n\tstatic initEditFieldController(params)\n\t{\n\t\tlet editFieldController = new EditFieldController(params);\n\t\teditFieldController.init();\n\n\t\treturn editFieldController;\n\t}\n\n\tstatic getCrmFieldConfigurator(id, settings)\n\t{\n\t\tif(window.BX && BX.Crm && Type.isFunction(BX.Crm.EntityEditorUserFieldConfigurator))\n\t\t{\n\t\t\treturn customizeCrmEntityEditor(BX.Crm.EntityEditorUserFieldConfigurator).create(id, settings);\n\t\t}\n\t}\n\n\tstatic getUserFieldParams(params = {})\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tlet fieldName = params.fieldName || '';\n\n\t\t\tif (params.clearCache || !ResourcebookingUserfield.fieldParamsCache[params.fieldName])\n\t\t\t{\n\t\t\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getfieldparams', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfieldname: params.fieldName,\n\t\t\t\t\t\tselectedUsers: params.selectedUsers || []\n\t\t\t\t\t}\n\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tResourcebookingUserfield.fieldParamsCache[fieldName] = response.data;\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve(ResourcebookingUserfield.fieldParamsCache[fieldName]);\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic getPluralMessage(messageId, number)\n\t{\n\t\tlet pluralForm, langId;\n\n\t\tlangId = BX.message('LANGUAGE_ID') || 'en';\n\t\tnumber = parseInt(number);\n\n\t\tif (number < 0)\n\t\t{\n\t\t\tnumber = -1*number;\n\t\t}\n\n\t\tif (langId)\n\t\t{\n\t\t\tswitch (langId)\n\t\t\t{\n\t\t\t\tcase 'de':\n\t\t\t\tcase 'en':\n\t\t\t\t\tpluralForm = ((number !== 1) ? 1 : 0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ru':\n\t\t\t\tcase 'ua':\n\t\t\t\t\tpluralForm = (((number%10 === 1) && (number%100 !== 11)) ? 0 : (((number%10 >= 2) && (number%10 <= 4) && ((number%100 < 10) || (number%100 >= 20))) ? 1 : 2));\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tpluralForm = 1;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpluralForm = 1;\n\t\t}\n\n\t\treturn BX.message(messageId + '_PLURAL_' + pluralForm);\n\t}\n\n\tstatic getParamsFromHash(userfieldId)\n\t{\n\t\tlet\n\t\t\tparams, regRes,\n\t\t\thash = unescape(window.location.hash);\n\n\t\tif (hash)\n\t\t{\n\t\t\tregRes = new RegExp('#calendar:' + userfieldId + '\\\\|(.*)', 'ig').exec(hash);\n\t\t\tif (regRes && regRes.length > 1)\n\t\t\t{\n\t\t\t\tparams = regRes[1].split('|');\n\t\t\t}\n\t\t}\n\t\treturn params;\n\t}\n\n\tstatic openExternalSettingsSlider(params)\n\t{\n\t\tlet settingsSlider = new CalendarViewSettingsSlider(params);\n\t\tsettingsSlider.show();\n\t}\n\n\tstatic setSocnetDestination(socnetDestination)\n\t{\n\t\tResourcebookingUserfield.socnetDestination = socnetDestination;\n\t}\n\n\tstatic getSocnetDestination()\n\t{\n\t\treturn ResourcebookingUserfield.socnetDestination;\n\t}\n}"],"names":["FormFieldTunnerAbstract","label","formLabel","displayed","valuePopup","statePopup","displayCheckboxDisabled","DOM","params","updateConfig","fieldWrap","Dom","create","props","className","labelWrap","appendChild","labelNode","text","getLabel","formTitleWrap","isDisplayed","formTitleLabel","getFormLabel","events","click","enableFormTitleEditMode","bind","formTitleEditIcon","checkboxNode","attrs","type","value","checked","disabled","checkDisplayMode","buildStatePopup","wrap","config","buildValuePopup","Type","isFunction","changeSettingsCallback","closePopup","setFormLabel","show","displayInForm","hideInForm","addClass","triggerChangeRefresh","removeClass","formTitleInputNode","blur","finishFormTitleEditMode","style","display","focus","adjust","setTimeout","BX","onCustomEvent","FormFieldTunnerPopupAbstract","id","Math","round","random","menuItems","outerWrap","handleClickFunc","handleClick","innerWrap","currentStateLink","getCurrentModeState","showPopup","isPopupShown","getMenuItems","Event","unbind","document","popup","PopupMenu","closeByEsc","autoHide","offsetTop","offsetLeft","cacheable","popupWindow","setAngle","offset","position","popupContainer","forEach","menuItem","inputType","inputNameStr","dataset","menuItemClassName","inputName","innerHtml","textValue","layout","item","innerHTML","close","maxHeight","isShown","isNodeInDom","e","target","srcElement","hasAttribute","findParent","attribute","handleControlChanges","changesTimeout","clearTimeout","delegate","isParentForNode","animation","FormFieldTunnerValuePopupAbstract","selectedValues","valueLink","getCurrentValueState","mouseover","showHoverPopup","mouseout","hideHoverPopup","PopupWindow","loseByEsc","width","getPopupWidth","lightShadow","content","getPopupContent","proxy","handlePopupClick","addCustomEvent","handlePopupCloose","destroy","message","minWidth","minHeight","hidePopupLoader","popupLoader","BookingUtil","getLoader","remove","FormFieldTunnerMultipleChecknoxPopupAbstract","values","push","util","htmlspecialchars","title","onclick","menuItemClick","length","selectAllMessage","selectAllItemClick","find","itemId","selectAllChecked","selectAllcheckbox","checkbox","querySelector","foundValue","hasClass","selectItem","deselectItem","in_array","index","array_search","deleteFromArray","i","checkboxes","querySelectorAll","UserSelectorFieldEditControl","wrapNode","zIndex","destinationInputName","selectGroups","addMessage","checkLimit","checkLimitCallback","isArray","itemsSelected","convertAttendeesCodes","getSocnetDestinationConfig","shown","SocNetLogDestination","deleteItem","getAttribute","block","openDialog","socnetDestinationInputWrap","socnetDestinationInput","keydown","searchBeforeHandler","formName","inputId","keyup","searchHandler","linkId","sendAjax","socnetDestinationLink","init","_this","items","itemsLast","groups","department","sonetgroups","name","searchInput","extranetUser","userSearchArea","bindMainPopup","node","bindSearchPopup","callback","select","selectCallback","unSelect","unSelectCallback","openDialogCallback","closeDialog","closeDialogCallback","openSearch","closeSearch","departmentSelectDisable","isOpenDialog","addUserBlock","showLimitationPopup","getAttendeesCodesList","includes","blocks","itemWrap","html","elements","findChildren","j","popupSearchWindow","cleanInputValue","isOpenSearch","backspaceDisable","window","keyCode","preventDefault","inputsList","getElementsByTagName","codes","trim","attendeesCodes","code","substr","result","getAttendeesCodes","hasOwnProperty","key","res","socnetDestination","users","USERS","EXTRANET_USER","DENY_TOALL","UA","SONETGROUPS","DEPARTMENT","departmentRelation","DEPARTMENT_RELATION","LAST","SELECTED","inputs","parseInt","userList","trigerOnChange","user","obItems","onChangeCallback","WebformUserSelectorFieldEditControl","externalWrap","closeDialogDelayFlag","finalShowClassName","cleanNode","useAnimation","popupContent","popupSearchContent","contentContainer","defer","UserSelectorFieldTunner","Loc","getMessage","defaultMode","UsersStatePopup","UsersValuePopup","setEnabled","setDisabled","getDefaultMode","getSelectedValues","build","submenuClass","isDomNode","nodeName","toLowerCase","selectedCodes","selectedItems","selectedIndex","selectAll","selected","split","userId","Promise","resolve","showPopupLoader","ajax","runAction","data","selectedUserList","then","response","buildUserSelector","userCurrentvalueWrap","userSelectorWrap","userSelector","userSelectorId","getId","triggerUserSelectorUpdate","selectroId","delayExecution","selectorUpdateTimeout","count","ResourcebookingUserfield","getPluralMessage","ResourceSelectorFieldTunner","multiple","ResourcesStatePopup","ResourcesValuePopup","getMultiple","getSelectedId","delimiter","isString","resources","resource","valueId","prepareValueId","val","ServiceSelectorFieldTunner","ServiceValuePopup","undefined","translit","services","service","getDurationLabel","duration","DurationSelectorFieldTunner","defaultValue","manualInput","DurationStatePopup","getDefaultValue","getManualInput","durationList","getDurationList","fullDay","getDurationLabelByValue","getDefaultMenuItems","concat","foundDuration","DateSelectorFieldTunner","start","DateStatePopup","getStyle","getStart","styleInputName","startInputName","TimeSelectorFieldTunner","showOnlyFree","showFinishTime","scale","TimeStatePopup","getShowFinishTime","getShowOnlyFree","getScale","stateShowFreeId","stateShowFinishId","getDurationMenuItems","filter","AdjustFieldController","complexFields","userFieldParams","settingsData","getSettingsData","settings","settingsWrap","captionNode","settingsInputs","showFieldLoader","getUserFieldParams","fieldName","entityName","selectedUsers","getSelectedUsers","fieldParams","hideFieldLoader","fieldLayout","FieldViewControllerEdit","displayTitle","getCaption","getSettings","updateSettingsDataInputs","settingsPopupId","settingsPopup","getSettingsContentNode","overlay","backgroundColor","opacity","titleBar","closeIcon","buttons","PopupWindowButton","buttonNodeWrap","buttonNode","parentNode","destroyControls","previewFieldLayout","leftWrap","buildSettingsForm","previewWrap","FieldViewControllerPreview","handleWebformSettingsChanges","titleId","captionWrap","captionInput","change","updateCaption","fieldsOuterWrap","fieldsWrap","userfieldSettings","useUsers","buildComplexField","updateSettings","checkBitrix24Limitation","useResources","useServices","date","time","replace","k","refreshLayoutTimeout","getValue","refreshLayout","getOuterWrap","getInnerWrap","offsetHeight","isObject","field","option","isPlainObject","updateSettingsInputValue","uniKey","join","fieldLoader","SETTINGS","SELECTED_RESOURCES","SELECTED_USERS","SERVICE_LIST","FULL_DAY","USE_RESOURCES","USE_USERS","USE_SERVICES","resourceLimit","RESOURCE_LIMIT","userIndex","USER_INDEX","caption","updateTitle","required","requiredCheckbox","usersValue","clone","getDefaultSettingsData","ResourceSelectorFieldEditControl","editMode","resourceList","checkLimitForNew","checkLimitCallbackForNew","selectedValuesIndex","selectedBlocks","newValues","blocksWrap","listWrap","controlsWrap","arrowNode","setValues","addButton","addResourceBlock","selectButton","openResourcesPopup","handleBlockClick","blockValue","element","checkBlockWrapState","isResourcesPopupShown","deleted","foundResource","removeResourceBlock","checkResourceInputs","menuItemNode","textNode","offsetWidth","B24","blockEntry","input","placeholder","resourceType","resourceId","delButton","focusInput","transparent","children","max","childNodes","emptyPlaceholder","closeResourcesPopup","addToSelectedValues","PlannerPopup","bindNode","plannerId","plannerConfig","lastPlannerIdShown","currentEntries","plannerWrap","bindPos","pos","winSize","GetWindowSize","plannerWidth","innerWidth","right","showPlanner","refreshParams","codeIndex","fromTimestamp","toTimestamp","dateFrom","dateTo","lastUpdateParams","focusSelector","from","to","parseDate","getTime","selector","getDayLength","Date","scaleDateFrom","scaleDateTo","requestData","formatDate","currentEventList","checkUpdateParams","showPlannerLoader","hidePlannerLoader","lastRequestData","entries","currentAccessibility","accessibility","currentLoadedDataFrom","currentLoadedDataTo","entry","selectedResources","updateScaleLimits","loadedDataFrom","loadedDataTo","requestPlannerUpdate","lastRequestPlannerId","array_diff","resIndex","planner","CalendarPlanner","updateScaleType","RRULE","selectorOnChangeCallback","selectEntriesOnChangeCallback","checkSelectorStatusCallback","update","loader","removeCustomEvent","getPlannerId","EditFieldController","plannerPopup","controlId","valueInputs","isNew","DATE_FROM","setSocnetDestination","buildUserfieldWrap","createEventHandlers","setControlValues","buildDateControl","buildTimeControl","buildServiceControl","buildDurationControl","buildUserSelectorControl","buildResourceSelectorControl","showPlannerPopup","fromInput","durationInput","allowOverbooking","isOverbooked","addError","Crm","EntityValidationError","onChangeValues","allValuesValue","defaultDuration","getParamsFromHash","userfieldId","roundMin","r","timestamp","ceil","DATE_TO","getDateFormat","timeFromInput","getTimeFormatShort","setValue","serviceList","SERVICE_NAME","ENTRIES","TYPE","RESOURCE_ID","resourceSelector","dateTimeWrap","dateWrap","showCalendarPicker","triggerUpdatePlanner","emptyInput","timeWrap","fromTime","SelectInput","getSimpleTimeList","onAfterMenuOpen","ind","popupMenu","nearestTimeValue","adaptTimeValue","h","getHours","m","getMinutes","menuContainer","scrollTop","durationWrap","servicesWrap","serviceInput","serviceListValues","state","realValue","parseDuration","durationControlWrap","userSelectorTitle","userListWrap","getSocnetDestination","checkResourceCountLimit","resourcesWrap","resSelectorTitle","resourcesListWrap","formatDatetime","isAmPmMode","dateFromValue","serviceName","isDate","getSelectedResourceList","getSelectedUserList","getDateTimeFormat","fireEvent","EVENT_ID","isNull","getPlannerConfig","getSelectorData","plannerSelectorOnChange","plannerSelectedEntriesOnChange","getResourceList","getUserList","selectEntriesMode","scaleLimitOffsetLeft","scaleLimitOffsetRight","maxTimelineSize","minEntryRows","entriesListWidth","timelineCellWidth","accuracy","workTime","clickSelectorScaleAccuracy","errorClass","overbooked","status","errorNode","getValues","getTotalResourceCount","calendar","bTime","ServiceSelector","outerCont","fieldSettings","serviceListOuterWrap","durationTitleId","servicesTitleWrap","serviceListRowsWrap","addRow","serviceListAddWrap","serviceAddButton","checkDurationTitlePosition","row","getDefaultDuration","nameInput","fullday","getFullDayValue","deleteWrap","timeout","checkDurationTitlePositionTimeout","left","resWrap","checkRows","rows","onFullClearHandler","TimezoneSelector","options","add","Option","selectedValue","getTimezoneList","timezoneList","timezone","clearCache","timezone_id","default","ModeSelector","showResources","modeSwitcherPopup","showUsers","showResourcesAndUsers","switcherId","angle","customizeCrmEntityEditor","CrmConfigurator","Configurator","superclass","constructor","apply","extend","self","initialize","prototype","_hasLayout","_mode","EntityEditorMode","view","getBitrix24Limitation","limit","_field","fieldInfo","getFieldInfo","getDefaultUserfieldSettings","displayCallback","_wrapper","_innerWrapper","selectedResourceList","manager","_editor","getUserFieldManager","getTitle","getDefaultFieldLabel","_typeId","_labelInput","hide","optionWrapper","resourcesTitleWrap","resourcesListLowControls","RESOURCES","SECTIONS","ID","NAME","CAL_TYPE","checkResourceCountLimitForNewEntries","usersTitleWrap","usersListWrap","datetimeOptionsWrap","datetimeOptionsInnerWrap","timezoneSettingsWrap","timezoneSelectorWrap","USE_USER_TIMEZONE","timezoneSelectWrap","timezoneSelector","TIMEZONE","useUserTimezoneCheckBox","handleUserTimezoneCheckbox","_fulldayCheckBox","handleFullDayMode","_servicesCheckBox","additionaOptionsWrap","_isRequiredCheckBox","isRequired","_showAlwaysCheckBox","prop","getBoolean","_settings","checkOptionFlag","EntityEditorControlOptions","showAlways","_overbookingCheckBox","ALLOW_OVERBOOKING","onSaveButtonClick","onCancelButtonClick","registerLayout","_isLocked","typeId","mandatory","getDeletedValues","CalendarViewSettingsSlider","sliderId","SLIDER_WIDTH","SLIDER_DURATION","SidePanel","Instance","open","contentCallback","animationDuration","hideHandler","destroyHandler","event","getSliderPage","getUrl","promise","fulfill","initControls","save","filterSelectValues","fieldOuterWrap","fieldSelect","TEXT","VALUE","filterSelect","entityType","userOptions","reload","AdminSettingsViewer","getElementById","outerWrapId","form","forms","onSubmit","optionWrap","fulldayCheckBox","useServicedayCheckBox","overbookingCheckbox","inputsWrap","clean","htmlControl","prepareFormDataInputs","bookingFieldParams","Error","lblCaption","entityFieldName","entity_field_name","dict","captionValue","adjustFieldController","editFieldController","EntityEditorUserFieldConfigurator","fieldParamsCache","fieldname","messageId","number","pluralForm","langId","regRes","hash","unescape","location","RegExp","exec","settingsSlider"],"mappings":"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"}