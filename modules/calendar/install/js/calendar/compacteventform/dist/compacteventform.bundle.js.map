{"version":3,"file":"compacteventform.bundle.js","sources":["../src/compacteventform.js"],"sourcesContent":["// @flow\nimport {Type, Tag, Loc, Dom, Event, Runtime, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Util} from 'calendar.util';\nimport {Popup, PopupManager} from 'main.popup';\nimport {\n\tDateTimeControl,\n\tLocation,\n\tReminder,\n\tSectionSelector,\n\tUserPlannerSelector,\n\tColorSelector,\n\tBusyUsersDialog\n} from \"calendar.controls\";\nimport {Entry, EntryManager} from \"calendar.entry\";\nimport {SectionManager} from \"calendar.sectionmanager\";\n\nexport class CompactEventForm extends EventEmitter\n{\n\tstatic VIEW_MODE = 'view';\n\tstatic EDIT_MODE = 'edit';\n\tstatic USER_URL = '/company/personal/user/#USER_ID#/';\n\tSTATE = {READY: 1, REQUEST: 2, ERROR: 3};\n\tzIndex = 1200;\n\tZ_INDEX_OFFSET = -1000;\n\tuserSettings = '';\n\tDOM = {};\n\tmode;\n\tdisplayed = false;\n\tsections = [];\n\tsectionIndex = {};\n\ttrackingUsersList = [];\n\tcheckDataBeforeCloseMode = true;\n\tCHECK_CHANGES_DELAY = 500;\n\tRELOAD_DATA_DELAY = 500;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.CompactEventForm');\n\t\tthis.userId = options.userId || Util.getCurrentUserId();\n\t\tthis.type = options.type || 'user';\n\t\tthis.isLocationCalendar = options.isLocationCalendar || false;\n\t\tthis.calendarContext = options.calendarContext || null;\n\t\tthis.ownerId = options.ownerId || this.userId;\n\t\tthis.BX = Util.getBX();\n\n\t\tthis.checkForChangesDebounce = Runtime.debounce(this.checkForChanges, this.CHECK_CHANGES_DELAY, this);\n\t\tthis.reloadEntryDataDebounce = Runtime.debounce(this.reloadEntryData, this.RELOAD_DATA_DELAY, this);\n\t\tthis.checkOutsideClickClose = this.checkOutsideClickClose.bind(this);\n\t\tthis.outsideMouseDownClose = this.outsideMouseDownClose.bind(this);\n\t\tthis.keyHandler = this.handleKeyPress.bind(this);\n\t}\n\n\tshow(mode = CompactEventForm.EDIT_MODE, params ={})\n\t{\n\t\tthis.setParams(params);\n\t\tthis.setMode(mode);\n\n\t\tthis.state = this.STATE.READY;\n\n\t\tthis.popupId = 'compact-event-form-' + Math.round(Math.random() * 100000);\n\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.destroy();\n\t\t}\n\t\tthis.popup = this.getPopup(params);\n\n\t\t// Small hack to use transparent titlebar to drag&drop popup\n\t\tDom.addClass(this.popup.titleBar, 'calendar-add-popup-titlebar');\n\t\tDom.removeClass(this.popup.popupContainer, 'popup-window-with-titlebar');\n\t\tDom.removeClass(this.popup.closeIcon, 'popup-window-titlebar-close-icon');\n\t\tEvent.bind(document, \"mousedown\", this.outsideMouseDownClose);\n\t\tEvent.bind(document, \"mouseup\", this.checkOutsideClickClose);\n\t\tEvent.bind(document, \"keydown\", this.keyHandler);\n\t\tEvent.bind(this.popup.popupContainer, 'transitionend', () => {Dom.removeClass(this.popup.popupContainer, 'calendar-simple-view-popup-show');});\n\n\t\t// Fulfill previous deletions to avoid data inconsistency\n\t\tif (this.getMode() === CompactEventForm.EDIT_MODE)\n\t\t{\n\t\t\tEntryManager.doDelayedActions();\n\t\t}\n\n\t\tthis.prepareData()\n\t\t\t.then(() => {\n\t\t\t\tif (this.checkLocationView())\n\t\t\t\t{\n\t\t\t\t\tthis.setFormValuesLocation();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.setFormValues();\n\t\t\t\t}\n\n\t\t\t\tthis.popup.show();\n\t\t\t\tif (this.isLocationCalendar\n\t\t\t\t\t|| (this.userPlannerSelector.attendeesEntityList.length > 1 && this.getMode() !== CompactEventForm.VIEW_MODE)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.userPlannerSelector.showPlanner();\n\t\t\t\t}\n\n\t\t\t\tthis.checkDataBeforeCloseMode = true;\n\t\t\t\tif (this.canDo('edit') && this.DOM.titleInput && mode === CompactEventForm.EDIT_MODE)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.titleInput.focus();\n\t\t\t\t\tthis.DOM.titleInput.select();\n\t\t\t\t}\n\n\t\t\t\tthis.displayed = true;\n\n\t\t\t\tif (this.getMode() === CompactEventForm.VIEW_MODE)\n\t\t\t\t{\n\t\t\t\t\tUtil.sendAnalyticLabel({calendarAction: 'view_event', formType: 'compact'});\n\t\t\t\t\tthis.popup.getButtons()[0].button.focus();\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tthis.getMode() === CompactEventForm.EDIT_MODE\n\t\t\t\t\t&& !this.userPlannerSelector.isPlannerDisplayed()\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.userPlannerSelector.checkBusyTime()\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tcheckLocationView()\n\t{\n\t\treturn this.getMode() === CompactEventForm.VIEW_MODE && this.type === 'location'\n\t}\n\n\tgetPopup(params)\n\t{\n\t\treturn new Popup(this.popupId,\n\t\t\tparams.bindNode,\n\t\t\t{\n\t\t\t\tzIndex: this.zIndex + this.Z_INDEX_OFFSET,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tcloseIcon: true,\n\t\t\t\ttitleBar: true,\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tclassName: 'calendar-simple-view-popup calendar-simple-view-popup-show',\n\t\t\t\tcacheable: false,\n\t\t\t\tcontent: this.checkLocationView()\n\t\t\t\t\t? this.getPopupContentLocation()\n\t\t\t\t\t: this.getPopupContentCalendar(),\n\t\t\t\tbuttons: this.getButtons(),\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: this.close.bind(this)\n\t\t\t\t},\n\t\t\t});\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.displayed;\n\t}\n\n\tclose(fromButton = true)\n\t{\n\t\tif (\n\t\t\t(\n\t\t\t\t!fromButton && !this.checkTopSlider()\n\t\t\t)\n\t\t\t||\n\t\t\t(\n\t\t\t\tthis.getMode() === CompactEventForm.EDIT_MODE\n\t\t\t\t&& this.formDataChanged()\n\t\t\t\t&& this.checkDataBeforeCloseMode\n\t\t\t\t&& !confirm(Loc.getMessage('EC_SAVE_ENTRY_CONFIRM'))\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t// Workaround to prevent form closing even if user don't want to and presses \"cancel\" in confirm\n\t\t\tif (this.popup)\n\t\t\t{\n\t\t\t\tthis.popup.destroyed = true;\n\t\t\t\tsetTimeout(() => {this.popup.destroyed = false;}, 0);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tthis.displayed = false;\n\t\tthis.emit('onClose');\n\t\tEvent.unbind(document, \"mousedown\", this.outsideMouseDownClose);\n\t\tEvent.unbind(document, \"mouseup\", this.checkOutsideClickClose);\n\t\tEvent.unbind(document, \"keydown\", this.keyHandler);\n\n\t\tif (this.userPlannerSelector)\n\t\t{\n\t\t\tthis.userPlannerSelector.destroy();\n\t\t}\n\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.destroy();\n\t\t}\n\n\t\tif (Location)\n\t\t{\n\t\t\tLocation.setCurrentCapacity(0);\n\t\t}\n\t\tUtil.clearPlannerWatches();\n\t\tUtil.closeAllPopups();\n\t}\n\n\tgetPopupContentCalendar()\n\t{\n\t\tthis.DOM.wrap = Tag.render`<div class=\"calendar-add-popup-wrap\">\n\t\t\t${this.DOM.titleOuterWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-container calendar-field-container-string-select\">\n\t\t\t\t<div class=\"calendar-field-block\">\n\t\t\t\t\t${this.getTitleControl()}\n\t\t\t\t\t${this.getColorControl()}\n\t\t\t\t</div>\n\t\t\t</div>`}\n\t\t\t<div class=\"calendar-field-container calendar-field-container-choice\">\n\t\t\t\t${this.getSectionControl('textselect')}\n\t\t\t</div>\n\n\t\t\t${this.getDateTimeControl()}\n\n\t\t\t${this.getUserPlannerSelector()}\n\n\t\t\t<div class=\"calendar-field-container calendar-field-container-info\">\n\t\t\t\t${this.getTypeInfoControl()}\n\n\t\t\t\t\t${this.getLocationControl()}\n\n\t\t\t\t${this.DOM.remindersOuterWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-field-block\">\n\t\t\t\t\t<div class=\"calendar-field-title\">${Loc.getMessage('EC_REMIND_LABEL')}:</div>\n\t\t\t\t\t${this.createRemindersControl()}\n\t\t\t\t</div>`}\n\t\t\t\t${this.getRRuleInfoControl()}\n\t\t\t</div>\n\t\t</div>`;\n\n\t\treturn this.DOM.wrap;\n\t}\n\n\tgetPopupContentLocation()\n\t{\n\t\tthis.DOM.wrap = Tag.render`<div class=\"calendar-add-popup-wrap\">\n\t\t\t${this.DOM.titleOuterWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-container calendar-field-container-string-select\">\n\t\t\t\t<div class=\"calendar-field-block\">\n\t\t\t\t\t${this.getTitleControlLocation()}\n\t\t\t\t\t${this.getColorControlsLocationView()}\n\t\t\t\t</div>\n\t\t\t</div>`}\n\t\t\t<div class=\"calendar-field-container calendar-field-container-choice\">\n\t\t\t\t${this.getSectionControl('location')}\n\t\t\t</div>\n\t\t\t${this.getDateTimeControl()}\n\t\t\t\n\t\t</div>`;\n\t\tif (this.entry.id !== this.entry.parentId)\n\t\t{\n\t\t\tthis.DOM.wrap.appendChild(Tag.render`\n\t\t\t\t${this.getHostControl()}\n\t\t\t`);\n\t\t}\n\n\t\treturn this.DOM.wrap;\n\t}\n\n\tgetButtons()\n\t{\n\t\tlet buttons = [];\n\t\tconst mode = this.getMode();\n\n\t\tif (mode === CompactEventForm.EDIT_MODE)\n\t\t{\n\t\t\tconst saveBtn = new BX.UI.Button({\n\t\t\t\tname: 'save',\n\t\t\t\ttext : (this.isNewEntry()\n\t\t\t\t\t? Loc.getMessage('CALENDAR_EVENT_DO_ADD')\n\t\t\t\t\t: Loc.getMessage('CALENDAR_EVENT_DO_SAVE')),\n\t\t\t\tclassName: \"ui-btn ui-btn-primary\",\n\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t}}\n\t\t\t});\n\t\t\tsaveBtn.button.setAttribute('data-role', 'saveButton');\n\t\t\tbuttons.push(saveBtn);\n\n\n\t\t\tconst closeBtn = new BX.UI.Button({\n\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_CANCEL'),\n\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\tif (this.isNewEntry())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setFormValues();\n\n\t\t\t\t\t\t\tif (this.userPlannerSelector)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.userPlannerSelector.destroy();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.setMode(CompactEventForm.VIEW_MODE);\n\t\t\t\t\t\t\tthis.popup.setButtons(this.getButtons());\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t});\n\t\t\tcloseBtn.button.setAttribute('data-role', 'closeButton');\n\t\t\tbuttons.push(closeBtn);\n\n\t\t\tconst fullFormBtn = new BX.UI.Button({\n\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_FULL_FORM'),\n\t\t\t\tclassName: \"ui-btn calendar-full-form-btn\",\n\t\t\t\tevents : {click : this.editEntryInSlider.bind(this)}\n\t\t\t});\n\t\t\tfullFormBtn.button.setAttribute('data-role', 'fullForm');\n\t\t\tbuttons.push(fullFormBtn);\n\t\t}\n\t\telse if (mode === CompactEventForm.VIEW_MODE)\n\t\t{\n\t\t\tif (this.entry.isMeeting() && this.entry.getCurrentStatus() === 'Q')\n\t\t\t{\n\t\t\t\tconst acceptBtn = new BX.UI.Button({\n\t\t\t\t\tclassName: \"ui-btn ui-btn-primary\",\n\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_Y'),\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'Y')\n\t\t\t\t\t\t\t\t.then(this.refreshMeetingStatus.bind(this));\n\t\t\t\t\t\t}}\n\t\t\t\t});\n\t\t\t\tacceptBtn.button.setAttribute('data-role', 'accept');\n\t\t\t\tbuttons.push(acceptBtn);\n\n\t\t\t\tconst declineBtn = new BX.UI.Button({\n\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_N'),\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'N')\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\tif (this.isShown())\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}}\n\t\t\t\t});\n\t\t\t\tdeclineBtn.button.setAttribute('data-role', 'decline');\n\t\t\t\tbuttons.push(declineBtn);\n\t\t\t}\n\n\t\t\tif (this.checkLocationView())\n\t\t\t{\n\t\t\t\tif (this.entry.id !== this.entry.parentId)\n\t\t\t\t{\n\t\t\t\t\tbuttons.push(\n\t\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\t\tclassName: `ui-btn ${this.entry.isMeeting() && this.entry.getCurrentStatus() === 'Q' ? 'ui-btn-link' : 'ui-btn-primary'}`,\n\t\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_OPEN_PARENT'),\n\t\t\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\t\t\tBX.Calendar.EntryManager.openViewSlider(\n\t\t\t\t\t\t\t\t\t\tthis.entry.parentId,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\t\t\t\t\tfrom: this.entry.from,\n\t\t\t\t\t\t\t\t\t\t\ttimezoneOffset: this.entry && this.entry.data ? this.entry.data.TZ_OFFSET_FROM : null\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t\tif(this.canDo('release'))\n\t\t\t\t\t{\n\t\t\t\t\t\tbuttons.push(\n\t\t\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\t\t\tname: 'release',\n\t\t\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_RELEASE'),\n\t\t\t\t\t\t\t\tclassName: 'ui-btn ui-btn-light-border',\n\t\t\t\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\t\t\t\tthis.releaseLocation();\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbuttons.push(\n\t\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\t\tclassName: `ui-btn ui-btn-disabled`,\n\t\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_UPDATE_PROGRESS'),\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst openBtn = new BX.UI.Button({\n\t\t\t\t\tclassName: `ui-btn ${this.entry.isMeeting() && this.entry.getCurrentStatus() === 'Q' ? 'ui-btn-link' : 'ui-btn-primary'}`,\n\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_OPEN'),\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\tBX.Calendar.EntryManager.openViewSlider(\n\t\t\t\t\t\t\t\tthis.entry.id,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tentry: this.entry,\n\t\t\t\t\t\t\t\t\tcalendarContext: this.calendarContext,\n\t\t\t\t\t\t\t\t\ttype: this.type,\n\t\t\t\t\t\t\t\t\townerId: this.ownerId,\n\t\t\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\t\t\tfrom: this.entry.from,\n\t\t\t\t\t\t\t\t\ttimezoneOffset: this.entry && this.entry.data ? this.entry.data.TZ_OFFSET_FROM : null\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t}}\n\t\t\t\t});\n\t\t\t\topenBtn.button.setAttribute('data-role', 'openButton');\n\t\t\t\tbuttons.push(openBtn);\n\t\t\t}\n\n\t\t\tif (this.entry.isMeeting() && this.entry.getCurrentStatus() === 'N')\n\t\t\t{\n\t\t\t\tconst acceptBtn = new BX.UI.Button({\n\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_Y'),\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'Y')\n\t\t\t\t\t\t\t\t.then(this.refreshMeetingStatus.bind(this));\n\t\t\t\t\t\t}}\n\t\t\t\t});\n\t\t\t\tacceptBtn.button.setAttribute('data-role', 'accept');\n\t\t\t\tbuttons.push(acceptBtn);\n\t\t\t}\n\n\t\t\tif (this.entry.isMeeting() && this.entry.getCurrentStatus() === 'Y')\n\t\t\t{\n\t\t\t\tconst declineBtn = new BX.UI.Button({\n\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_N'),\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'N')\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\tif (this.isShown())\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}}\n\t\t\t\t});\n\t\t\t\tdeclineBtn.button.setAttribute('data-role', 'decline');\n\t\t\t\tbuttons.push(declineBtn);\n\t\t\t}\n\n\t\t\tif (!this.isNewEntry() && this.canDo('edit') && this.type !== 'location')\n\t\t\t{\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_EDIT'),\n\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\tevents : {click : this.editEntryInSlider.bind(this)}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!this.isNewEntry()\n\t\t\t\t&& this.canDo('delete')\n\t\t\t\t&& !this.checkLocationView()\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\t!this.entry.isMeeting()\n\t\t\t\t\t|| !this.entry.getCurrentStatus()\n\t\t\t\t\t|| this.entry.getCurrentStatus() === 'H'\n\t\t\t\t\t|| this.entry.data['CREATED_BY'] === this.entry.data['MEETING_HOST']\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tbuttons.push(\n\t\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_DELETE'),\n\t\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\t\t\tEventEmitter.subscribeOnce('BX.Calendar.Entry:beforeDelete', () => {\n\t\t\t\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tEntryManager.deleteEntry(this.entry);\n\n\t\t\t\t\t\t\t\t\tif (!this.entry.wasEverRecursive())\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (buttons.length > 2)\n\t\t{\n\t\t\tbuttons[1].button.className = \"ui-btn ui-btn-light-border\";\n\t\t}\n\n\t\treturn buttons;\n\t}\n\n\tfreezePopup()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.buttons.forEach((button) => {\n\t\t\t\tif (button?.options?.name === 'save')\n\t\t\t\t{\n\t\t\t\t\tbutton.setClocking(true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbutton.setDisabled(true);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tunfreezePopup()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.buttons.forEach((button) => {\n\t\t\t\tbutton.setClocking(false);\n\t\t\t\tbutton.setDisabled(false);\n\t\t\t});\n\t\t}\n\t}\n\n\trefreshMeetingStatus()\n\t{\n\t\tthis.emit('doRefresh');\n\t\tthis.popup.setButtons(this.getButtons());\n\t\tif (this.userPlannerSelector)\n\t\t{\n\t\t\tthis.userPlannerSelector.displayAttendees(this.entry.getAttendees());\n\t\t}\n\t}\n\n\thideLoader()\n\t{\n\t\tif (Type.isDomNode(this.DOM.loader))\n\t\t{\n\t\t\tDom.remove(this.DOM.loader);\n\t\t\tthis.DOM.loader = null;\n\t\t}\n\t}\n\n\tshowInEditMode(params = {})\n\t{\n\t\treturn this.show(CompactEventForm.EDIT_MODE, params);\n\t}\n\n\tshowInViewMode(params = {})\n\t{\n\t\treturn this.show(CompactEventForm.VIEW_MODE, params);\n\t}\n\n\tsetMode(mode)\n\t{\n\t\tif (mode === 'edit' || mode === 'view')\n\t\t{\n\t\t\tthis.mode = mode;\n\t\t}\n\t}\n\n\tgetMode()\n\t{\n\t\treturn this.mode;\n\t}\n\n\tcheckForChanges()\n\t{\n\t\tif (\n\t\t\t!this.isNewEntry()\n\t\t\t&& this.getMode() === CompactEventForm.VIEW_MODE\n\t\t\t&& this.formDataChanged()\n\t\t)\n\t\t{\n\t\t\tthis.setMode(CompactEventForm.EDIT_MODE);\n\t\t\tthis.popup.setButtons(this.getButtons());\n\t\t}\n\t\telse if (\n\t\t\t!this.isNewEntry()\n\t\t\t&& this.getMode() === CompactEventForm.EDIT_MODE\n\t\t\t&& !this.formDataChanged()\n\t\t)\n\t\t{\n\t\t\tthis.setMode(CompactEventForm.VIEW_MODE);\n\t\t\tthis.popup.setButtons(this.getButtons());\n\t\t}\n\t\tthis.emitOnChange();\n\t}\n\n\tcheckLocationForm(event)\n\t{\n\t\tif (event && event instanceof BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tconst usersCount = data.usersCount;\n\n\t\t\tlet locationCapacity = Location.getCurrentCapacity() || 0;\n\n\t\t\tif (this.locationSelector.value.type === undefined)\n\t\t\t{\n\t\t\t\tif (locationCapacity)\n\t\t\t\t{\n\t\t\t\t\tlocationCapacity = 0;\n\t\t\t\t\tLocation.setCurrentCapacity(0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (locationCapacity < usersCount && locationCapacity !== 0)\n\t\t\t{\n\t\t\t\tthis.locationSelector.addCapacityAlert();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.locationSelector.removeCapacityAlert();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFormDataChanges(excludes = [])\n\t{\n\t\tconst entry = this.entry;\n\t\tlet fields = [];\n\n\t\t// Name\n\t\tif (!excludes.includes('name') && entry.name !== this.DOM.titleInput.value)\n\t\t{\n\t\t\tfields.push('name');\n\t\t}\n\n\t\t// Location\n\t\tif (\n\t\t\t!excludes.includes('location')\n\t\t\t&&\n\t\t\tthis.locationSelector.getTextLocation(Location.parseStringValue(entry.getLocation()))\n\t\t\t!==\n\t\t\tthis.locationSelector.getTextLocation(Location.parseStringValue(this.locationSelector.getTextValue()))\n\t\t)\n\t\t{\n\t\t\tfields.push('location');\n\t\t}\n\n\t\t// Date + time\n\t\tconst dateTime = this.dateTimeControl.getValue();\n\t\tif (\n\t\t\t!excludes.includes('date&time')\n\t\t\t&&\n\t\t\t(entry.isFullDay() !== dateTime.fullDay\n\t\t\t\t|| dateTime.from.toString() !== entry.from.toString()\n\t\t\t\t|| dateTime.to.toString() !== entry.to.toString()\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tfields.push('date&time');\n\t\t}\n\n\t\t// Notify\n\t\tif (\n\t\t\t!excludes.includes('notify')\n\t\t\t&& (!entry.isMeeting() || entry.getMeetingNotify()) !== this.userPlannerSelector.getInformValue()\n\t\t)\n\t\t{\n\t\t\tfields.push('notify');\n\t\t}\n\n\t\t// Section\n\t\tif (!excludes.includes('section') && parseInt(entry.sectionId) !== parseInt(this.sectionValue))\n\t\t{\n\t\t\tfields.push('section');\n\t\t}\n\n\t\t// Access codes\n\t\tif (\n\t\t\t!excludes.includes('codes')\n\t\t\t&&\n\t\t\tthis.userPlannerSelector.getEntityList().map((item)=>{return item.entityId + ':' + item.id}).join('|')\n\t\t\t!==\n\t\t\tentry.getAttendeesEntityList().map((item)=>{return item.entityId + ':' + item.id}).join('|')\n\t\t)\n\t\t{\n\t\t\tfields.push('codes');\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\tformDataChanged()\n\t{\n\t\treturn this.getFormDataChanges().length > 0;\n\t}\n\n\tsetParams(params = {})\n\t{\n\t\tthis.userId = params.userId || Util.getCurrentUserId();\n\t\tthis.type = params.type || 'user';\n\t\tthis.isLocationCalendar = params.isLocationCalendar || false;\n\t\tthis.locationAccess = params.locationAccess || false;\n\t\tthis.dayOfWeekMonthFormat = params.dayOfWeekMonthFormat || false;\n\t\tthis.calendarContext = params.calendarContext || null;\n\t\tthis.ownerId = params.ownerId ? params.ownerId : 0;\n\t\tif (this.type === 'user' && !this.ownerId)\n\t\t{\n\t\t\tthis.ownerId = this.userId;\n\t\t}\n\t\tthis.entry = EntryManager.getEntryInstance(params.entry, params.userIndex, {type: this.type, ownerId: this.ownerId});\n\t\tthis.sectionValue = null;\n\n\t\tif (\n\t\t\t!this.entry.id\n\t\t\t&& Type.isPlainObject(params.entryTime)\n\t\t\t&& Type.isDate(params.entryTime.from)\n\t\t\t&& Type.isDate(params.entryTime.to)\n\t\t)\n\t\t{\n\t\t\tthis.entry.setDateTimeValue(params.entryTime);\n\t\t}\n\n\t\tif (Type.isPlainObject(params.userSettings))\n\t\t{\n\t\t\tthis.userSettings = params.userSettings;\n\t\t}\n\n\t\tthis.locationFeatureEnabled = !!params.locationFeatureEnabled;\n\t\tthis.locationList = Type.isArray(params.locationList)\n\t\t\t? params.locationList.filter(locationItem => {return locationItem.PERM.view_full})\n\t\t\t: [];\n\n\t\tthis.roomsManager = params.roomsManager || null;\n\t\tthis.iblockMeetingRoomList = params.iblockMeetingRoomList || [];\n\n\t\tthis.plannerFeatureEnabled = !!params.plannerFeatureEnabled;\n\n\t\tthis.setSections(params.sections, params.trackingUserList)\n\t}\n\n\tsetSections(sections, trackingUsersList = [])\n\t{\n\t\tthis.sections = sections;\n\t\tthis.sectionIndex = {};\n\t\tthis.trackingUsersList = trackingUsersList || [];\n\n\t\tif (Type.isArray(this.sections))\n\t\t{\n\t\t\tthis.sections.forEach((value, ind) => {\n\t\t\t\tconst id = parseInt(value.ID || value.id);\n\t\t\t\tif (id > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.sectionIndex[id] = ind;\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tconst section = this.getCurrentSection();\n\t\tif (this.entry.id)\n\t\t{\n\t\t\tthis.getSectionsForEditEvent(this.sections, section);\n\t\t}\n\t}\n\n\tprepareData(params = {})\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst section = this.getCurrentSection();\n\t\t\tif (section && section.canDo)\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.getCompactFormData', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tentryId: this.entry.id,\n\t\t\t\t\t\tloadSectionId: this.entry.sectionId\n\t\t\t\t\t}\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tif (response && response.data && response.data.section)\n\t\t\t\t\t{\n\t\t\t\t\t\t// todo: refactor this part to new Section entities\n\t\t\t\t\t\tthis.sections.push(new window.BXEventCalendar.Section(Util.getCalendarContext(), response.data.section));\n\t\t\t\t\t\tthis.setSections(this.sections);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tgetTitleControl()\n\t{\n\t\tthis.DOM.titleInput = Tag.render`\n\t\t\t<input class=\"calendar-field calendar-field-string\"\n\t\t\t\tvalue=\"\"\n\t\t\t\tplaceholder=\"${Loc.getMessage('EC_ENTRY_NAME')}\"\n\t\t\t\ttype=\"text\"\n\t\t\t/>\n\t\t`;\n\n\t\tEvent.bind(this.DOM.titleInput, 'keyup', this.checkForChangesDebounce);\n\t\tEvent.bind(this.DOM.titleInput, 'change', this.checkForChangesDebounce);\n\n\t\treturn this.DOM.titleInput;\n\t}\n\n\tgetTitleControlLocation()\n\t{\n\t\tthis.DOM.titleInput = Tag.render`\n\t\t\t<input class=\"calendar-field calendar-field-string\"\n\t\t\t\tvalue=\"\"\n\t\t\t\tplaceholder=\"${Loc.getMessage('EC_ENTRY_NAME')}\"\n\t\t\t\ttype=\"text\"\n\t\t\t\treadonly\n\t\t\t/>\n\t\t`;\n\n\t\treturn this.DOM.titleInput;\n\t}\n\n\tgetHostControl()\n\t{\n\t\tconst userId = this.entry.data.CREATED_BY;\n\t\tconst userUrl = CompactEventForm.USER_URL.replace('#USER_ID#', userId);\n\t\tconst userAvatar = this.BX.Calendar.EntryManager.userIndex[userId]\n\t\t\t? this.BX.Calendar.EntryManager.userIndex[userId].AVATAR\n\t\t\t: ''\n\t\t;\n\n\t\tthis.DOM.hostBar = Tag.render`\n\t\t\t<div class=\"calendar-slider-detail-option-without-border\">\n\t\t\t\t<div class=\"calendar-slider-detail-option-block\">\n\t\t\t\t\t<div class=\"calendar-field-value\">\n\t\t\t\t\t\t${Loc.getMessage('EC_HOST') + ': '}\n\t\t\t\t\t</div>\n\t\t\t\t\t<span class=\"calendar-field-location-host-img\">\n\t\t\t\t\t\t<a href=\"${userUrl}\">\n\t\t\t\t\t\t\t<img class=\"calendar-field-location-host-img-value\" src=\"${userAvatar}\" alt=\"\">\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class=\"calendar-slider-detail-option-value\">\n\t\t\t\t\t\t<a href=\"${userUrl}\" class=\"calendar-slider-sidebar-user-info-name calendar-slider-sidebar-user-info-name-padding\">${BX.util.htmlspecialchars(this.entry.name)}</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\treturn this.DOM.hostBar;\n\t}\n\n\tgetColorControl()\n\t{\n\t\tthis.DOM.colorSelect = Tag.render`<div class=\"calendar-field calendar-field-select calendar-field-tiny\"></div>`;\n\t\tthis.colorSelector = new ColorSelector({\n\t\t\twrap: this.DOM.colorSelect,\n\t\t\tmode: 'selector'\n\t\t});\n\n\t\tthis.colorSelector.subscribe('onChange', (event) => {\n\t\t\tif (event instanceof BaseEvent)\n\t\t\t{\n\t\t\t\tconst color = event.getData().value;\n\t\t\t\tif (\n\t\t\t\t\t!this.isNewEntry()\n\t\t\t\t\t&& (this.canDo('edit') || this.entry.getCurrentStatus() !== false)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.updateColor', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tentryId: this.entry.id,\n\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\tcolor: color\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.entry.data.COLOR = color;\n\n\t\t\t\t\tthis.emit('doRefresh');\n\t\t\t\t\tthis.emitOnChange();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\n\t\treturn this.DOM.colorSelect;\n\t}\n\n\tgetColorControlsLocationView()\n\t{\n\t\tthis.DOM.colorSelect = Tag.render`<div class=\"calendar-field calendar-field-select calendar-colorpicker-readonly calendar-field-tiny\"></div>`;\n\t\tthis.colorSelector = new ColorSelector({\n\t\t\twrap: this.DOM.colorSelect,\n\t\t\tmode: 'view'\n\t\t});\n\t\treturn this.DOM.colorSelect;\n\t}\n\n\tgetSectionControl(mode)\n\t{\n\t\tthis.DOM.sectionSelectWrap = Tag.render`<div class=\"calendar-field-choice-calendar\"></div>`;\n\t\tthis.sectionSelector = new SectionSelector({\n\t\t\touterWrap: this.DOM.sectionSelectWrap,\n\t\t\tdefaultCalendarType: this.type,\n\t\t\tdefaultOwnerId: this.ownerId,\n\t\t\tsectionList: this.sections,\n\t\t\tsectionGroupList: SectionManager.getSectionGroupList({\n\t\t\t\ttype: this.type,\n\t\t\t\townerId: this.ownerId,\n\t\t\t\tuserId: this.userId,\n\t\t\t\ttrackingUsersList: this.trackingUsersList,\n\t\t\t}),\n\t\t\tmode: mode,\n\t\t\tzIndex: this.zIndex,\n\t\t\tgetCurrentSection: () => {\n\t\t\t\tconst section = this.getCurrentSection();\n\t\t\t\tif (section)\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: section.id,\n\t\t\t\t\t\tname: section.name,\n\t\t\t\t\t\tcolor: section.color\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tselectCallback: (sectionValue) => {\n\t\t\t\tif (sectionValue)\n\t\t\t\t{\n\t\t\t\t\tif (this.colorSelector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.colorSelector.setValue(sectionValue.color);\n\t\t\t\t\t}\n\t\t\t\t\tthis.sectionValue = sectionValue.id;\n\t\t\t\t\tthis.checkForChangesDebounce();\n\n\t\t\t\t\tSectionManager.saveDefaultSectionId(this.sectionValue);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn this.DOM.sectionSelectWrap;\n\t}\n\n\tgetDateTimeControl()\n\t{\n\t\tthis.DOM.dateTimeWrap = Tag.render`<div class=\"calendar-field-container calendar-field-container-datetime\"></div>`;\n\n\t\tthis.dateTimeControl = new DateTimeControl(null, {\n\t\t\tshowTimezone: false,\n\t\t\touterWrap: this.DOM.dateTimeWrap,\n\t\t\tinlineEditMode: true\n\t\t});\n\n\t\tthis.dateTimeControl.subscribe('onChange', (event) => {\n\t\t\tif (event instanceof BaseEvent)\n\t\t\t{\n\t\t\t\tlet value = event.getData().value;\n\t\t\t\tif (this.remindersControl)\n\t\t\t\t{\n\t\t\t\t\tthis.remindersControl.setFullDayMode(value.fullDay);\n\n\t\t\t\t\tif (this.isNewEntry() && !this.remindersControl.wasChangedByUser())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst defaultReminders = EntryManager.getNewEntryReminders(\n\t\t\t\t\t\t\tvalue.fullDay ? 'fullDay' : 'withTime'\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tthis.remindersControl.setValue(defaultReminders, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.userPlannerSelector)\n\t\t\t\t{\n\t\t\t\t\tif (!this.userPlannerSelector.isPlannerDisplayed())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userPlannerSelector.showPlanner();\n\t\t\t\t\t}\n\t\t\t\t\tthis.userPlannerSelector.setLocationValue(this.locationSelector.getTextValue());\n\t\t\t\t\tthis.userPlannerSelector.setDateTime(value, true);\n\t\t\t\t\tthis.userPlannerSelector.refreshPlannerStateDebounce();\n\t\t\t\t}\n\n\t\t\t\tif (this.locationSelector)\n\t\t\t\t{\n\t\t\t\t\tthis.locationSelector.checkLocationAccessibility(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfrom: event.getData().value.from,\n\t\t\t\t\t\t\tto: event.getData().value.to,\n\t\t\t\t\t\t\tfullDay: event.getData().value.fullDay,\n\t\t\t\t\t\t\tcurrentEventId: this.entry.id\n\t\t\t\t\t\t},\n\t\t\t\t\t)\n\t\t\t\t}\n\n\t\t\t\tthis.checkForChangesDebounce();\n\t\t\t}\n\t\t});\n\n\t\treturn this.DOM.dateTimeWrap;\n\t}\n\n\tgetUserPlannerSelector()\n\t{\n\t\tthis.DOM.userPlannerSelectorOuterWrap = Tag.render`<div>\n\t\t\t<div class=\"calendar-field-container calendar-field-container-members\">\n\t\t\t\t${this.DOM.userSelectorWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-field-block\">\n\t\t\t\t\t<div class=\"calendar-members-selected\">\n\t\t\t\t\t\t<span class=\"calendar-attendees-label\"></span>\n\t\t\t\t\t\t<span class=\"calendar-attendees-list\"></span>\n\t\t\t\t\t\t<span class=\"calendar-members-more\">${Loc.getMessage('EC_ATTENDEES_MORE')}</span>\n\t\t\t\t\t\t<span class=\"calendar-members-change-link\">${Loc.getMessage('EC_SEC_SLIDER_CHANGE')}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`}\n\t\t\t\t<span class=\"calendar-videocall-wrap calendar-videocall-hidden\"></span>\n\t\t\t\t${this.DOM.informWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-field-container-inform\">\n\t\t\t\t\t<span class=\"calendar-field-container-inform-text\">${Loc.getMessage('EC_NOTIFY_OPTION')}</span>\n\t\t\t\t</div>`}\n\t\t\t</div>\n\t\t\t<div class=\"calendar-user-selector-wrap\"></div>\n\t\t\t<div class=\"calendar-add-popup-planner-wrap calendar-add-popup-show-planner\">\n\t\t\t\t${this.DOM.plannerOuterWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-planner-wrapper\" style=\"height: 0\">\n\t\t\t\t</div>`}\n\t\t\t</div>\n\t\t\t${this.DOM.hideGuestsWrap = Tag.render`\n\t\t\t<div class=\"calendar-hide-members-container\" style=\"display: none;\">\n\t\t\t\t<div class=\"calendar-hide-members-container-inner\">\n\t\t\t\t\t<div class=\"calendar-hide-members-icon-hidden\"></div>\n\t\t\t\t\t<div class=\"calendar-hide-members-text\">${Loc.getMessage('EC_HIDE_GUEST_NAMES')}</div>\n\t\t\t\t\t<span class=\"calendar-hide-members-helper\" data-hint=\"${Loc.getMessage('EC_HIDE_GUEST_NAMES_HINT')}\"></span>\n\t\t\t\t</div>\n\t\t\t</div>`}\n\t\t<div>`;\n\n\t\tthis.userPlannerSelector = new UserPlannerSelector({\n\t\t\touterWrap: this.DOM.userPlannerSelectorOuterWrap,\n\t\t\twrap: this.DOM.userSelectorWrap,\n\t\t\tinformWrap: this.DOM.informWrap,\n\t\t\tplannerOuterWrap: this.DOM.plannerOuterWrap,\n\t\t\thideGuestsWrap: this.DOM.hideGuestsWrap,\n\t\t\treadOnlyMode: false,\n\t\t\tuserId: this.userId,\n\t\t\ttype: this.type,\n\t\t\townerId: this.ownerId,\n\t\t\tzIndex: this.zIndex + 10,\n\t\t\tplannerFeatureEnabled: this.plannerFeatureEnabled,\n\t\t\tdayOfWeekMonthFormat: this.dayOfWeekMonthFormat\n\t\t});\n\n\t\tthis.userPlannerSelector.subscribe('onDateChange', this.handlePlannerSelectorChanges.bind(this));\n\t\tthis.userPlannerSelector.subscribe('onNotifyChange', this.checkForChangesDebounce);\n\t\tthis.userPlannerSelector.subscribe('onUserCodesChange', this.checkForChangesDebounce);\n\n\t\treturn this.DOM.userPlannerSelectorOuterWrap;\n\t}\n\n\tgetLocationControl()\n\t{\n\t\tthis.DOM.locationWrap = Tag.render`<div class=\"calendar-field-place\"></div>`;\n\t\tthis.DOM.locationOuterWrap = Tag.render`<div class=\"calendar-field-block\">\n\t\t\t<div class=\"calendar-field-title calendar-field-title-align-top\">${Loc.getMessage('EC_LOCATION_LABEL')}:</div>\n\t\t\t${this.DOM.locationWrap}\n\t\t</div>`;\n\n\t\tthis.locationSelector = new Location(\n\t\t\t{\n\t\t\t\twrap: this.DOM.locationWrap,\n\t\t\t\trichLocationEnabled: this.locationFeatureEnabled,\n\t\t\t\tlocationList: this.locationList || [],\n\t\t\t\troomsManager: this.roomsManager || null,\n\t\t\t\tlocationAccess: this.locationAccess || false,\n\t\t\t\tiblockMeetingRoomList: this.iblockMeetingRoomList || [],\n\t\t\t\tinlineEditModeEnabled: !this.isLocationCalendar,\n\t\t\t\tonChangeCallback: () => {\n\t\t\t\t\tif (this.userPlannerSelector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userPlannerSelector.setLocationValue(this.locationSelector.getTextValue());\n\t\t\t\t\t\tif (this.locationSelector.getValue().type !== undefined\n\t\t\t\t\t\t\t&& !this.userPlannerSelector.isPlannerDisplayed())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.userPlannerSelector.showPlanner();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.userPlannerSelector.refreshPlannerStateDebounce();\n\t\t\t\t\t}\n\t\t\t\t\tthis.checkForChangesDebounce();\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tif (this.userPlannerSelector)\n\t\t{\n\t\t\tthis.userPlannerSelector.subscribe('onDisplayAttendees', this.checkLocationForm.bind(this));\n\t\t}\n\n\t\treturn this.DOM.locationOuterWrap;\n\t}\n\n\tcreateRemindersControl()\n\t{\n\t\tthis.reminderValues = [];\n\t\tthis.DOM.remindersWrap = Tag.render`<div class=\"calendar-text\"></div>`;\n\t\tthis.remindersControl = new Reminder({\n\t\t\twrap: this.DOM.remindersWrap,\n\t\t\tzIndex: this.zIndex\n\t\t});\n\n\t\tthis.remindersControl.subscribe('onChange', (event) => {\n\t\t\tif (event instanceof BaseEvent)\n\t\t\t{\n\t\t\t\tthis.reminderValues = event.getData().values;\n\t\t\t\tif (!this.isNewEntry()\n\t\t\t\t\t&& (this.canDo('edit')\n\t\t\t\t\t\t|| this.entry.getCurrentStatus() !== false))\n\t\t\t\t{\n\t\t\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.updateReminders', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tentryId: this.entry.id,\n\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\treminders: this.reminderValues\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tthis.entry.data.REMIND = response.data.REMIND;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn this.DOM.remindersWrap;\n\t}\n\n\tgetTypeInfoControl()\n\t{\n\t\tthis.DOM.typeInfoTitle = Tag.render`<div class=\"calendar-field-title\"></div>`;\n\t\tthis.DOM.typeInfoLink = Tag.render`<div class=\"calendar-field-link\"></div>`;\n\n\t\tthis.DOM.typeInfoWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-block\" style=\"display: none\">\n\t\t\t\t${this.DOM.typeInfoTitle}\n\t\t\t\t${this.DOM.typeInfoLink}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.DOM.typeInfoWrap;\n\t}\n\n\tgetRRuleInfoControl()\n\t{\n\t\tthis.DOM.rruleInfo = Tag.render`<div class=\"calendar-text\"></div>`;\n\t\tthis.DOM.rruleInfoWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-block\" style=\"display: none\">\n\t\t\t\t<div class=\"calendar-field-title\">${Loc.getMessage('EC_REPEAT')}:</div>\n\t\t\t\t${this.DOM.rruleInfo}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.DOM.rruleInfoWrap;\n\t}\n\n\tgetTimezoneInfoControl()\n\t{\n\t\tthis.DOM.timezoneInfo = Tag.render`<div class=\"calendar-text\"></div>`;\n\t\tthis.DOM.timezoneInfoWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-block\" style=\"display: none\">\n\t\t\t\t<div class=\"calendar-field-title\">${Loc.getMessage('EC_TIMEZONE')}:</div>\n\t\t\t\t${this.DOM.timezoneInfo}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.DOM.timezoneInfoWrap;\n\t}\n\n\tisNewEntry()\n\t{\n\t\treturn !this.entry.id;\n\t}\n\n\tcanDo(action)\n\t{\n\t\tconst section = this.getCurrentSection();\n\n\t\tif (action === 'edit' || action === 'delete')\n\t\t{\n\t\t\tif ((this.entry.isMeeting() && this.entry.id !== this.entry.parentId))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.entry.isResourcebooking())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn section.canDo('edit');\n\t\t}\n\n\t\tif (action === 'view')\n\t\t{\n\t\t\treturn section.canDo('view_time');\n\t\t}\n\n\t\tif (action === 'viewFull')\n\t\t{\n\t\t\treturn section.canDo('view_full');\n\t\t}\n\n\t\tif(action === 'release')\n\t\t{\n\t\t\treturn section.canDo('access');\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tsetFormValues()\n\t{\n\t\tconst entry = this.entry;\n\t\tconst section = this.getCurrentSection();\n\t\tconst readOnly = !this.canDo('edit');\n\n\t\t// Date time\n\t\tthis.dateTimeControl.setValue({\n\t\t\tfrom: Util.adjustDateForTimezoneOffset(entry.from, entry.userTimezoneOffsetFrom, entry.fullDay),\n\t\t\tto: Util.adjustDateForTimezoneOffset(entry.to, entry.userTimezoneOffsetTo, entry.fullDay),\n\t\t\tfullDay: entry.fullDay,\n\t\t\ttimezoneFrom: entry.getTimezoneFrom() || '',\n\t\t\ttimezoneTo: entry.getTimezoneTo() || '',\n\t\t\ttimezoneName: this.userSettings.timezoneName,\n\t\t});\n\t\tthis.dateTimeControl.setInlineEditMode(this.isNewEntry() ? 'edit' : 'view');\n\t\tthis.dateTimeControl.setViewMode(readOnly);\n\n\t\t// Title\n\t\tthis.DOM.titleInput.value = entry.getName();\n\n\t\tif (readOnly)\n\t\t{\n\t\t\tif (this.entry.getCurrentStatus() === false)\n\t\t\t{\n\t\t\t\tthis.DOM.titleInput.type = 'hidden'; // Hide input\n\t\t\t\t// Add label instead\n\t\t\t\tthis.DOM.titleLabel = this.DOM.titleInput.parentNode.insertBefore(Tag.render`<span class=\"calendar-field calendar-field-string\">${Text.encode(entry.getName())}</span>`, this.DOM.titleInput);\n\t\t\t\tDom.addClass(this.DOM.titleOuterWrap, 'calendar-field-container-view');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.titleInput.disabled = true;\n\t\t\t}\n\t\t}\n\n\t\t// Color\n\t\tthis.colorSelector.setValue(entry.getColor() || section.color, false);\n\t\tthis.colorSelector.setViewMode(readOnly && this.entry.getCurrentStatus() === false);\n\n\t\t// Section\n\t\tthis.sectionValue = this.getCurrentSectionId();\n\t\tthis.sectionSelector.updateValue();\n\t\tif (this.isSyncSection(section) && entry.id)\n\t\t{\n\t\t\tthis.sectionSelector.setViewMode(true);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.sectionSelector.setViewMode(readOnly);\n\t\t}\n\n\t\t// Reminders\n\t\tthis.remindersControl.setValue(entry.getReminders(), false);\n\t\tthis.remindersControl.setViewMode(readOnly && this.entry.getCurrentStatus() === false);\n\t\tif (readOnly && this.entry.getCurrentStatus() === false)\n\t\t{\n\t\t\tthis.DOM.remindersOuterWrap.style.display = 'none';\n\t\t}\n\n\t\t// Recurcion\n\t\tif (entry.isRecursive())\n\t\t{\n\t\t\tthis.DOM.rruleInfoWrap.style = '';\n\t\t\tDom.adjust(this.DOM.rruleInfo, {text: entry.getRRuleDescription()});\n\t\t}\n\n\t\t// Location\n\t\tlet location = entry.getLocation();\n\t\tif (readOnly && !location)\n\t\t{\n\t\t\tthis.DOM.locationOuterWrap.style.display = 'none';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.locationSelector.setViewMode(readOnly);\n\t\t\tif (this.isLocationCalendar)\n\t\t\t{\n\t\t\t\tthis.locationSelector.setValue(this.locationSelector.default);\n\t\t\t\tlocation = this.locationSelector.default;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.locationOuterWrap.style.display = '';\n\t\t\t\tthis.locationSelector.setValue(entry.getLocation());\n\t\t\t}\n\t\t}\n\t\tif (this.locationSelector)\n\t\t{\n\t\t\tthis.locationSelector.checkLocationAccessibility(\n\t\t\t\t{\n\t\t\t\t\tfrom: this.dateTimeControl.getValue().from,\n\t\t\t\t\tto: this.dateTimeControl.getValue().to,\n\t\t\t\t\tfullDay: this.dateTimeControl.getValue().fullDay,\n\t\t\t\t\tcurrentEventId: this.entry.id\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\t//User Planner Selector\n\t\tif (\n\t\t\tthis.userPlannerSelector\n\t\t\t&& (this.canDo('viewFull') || entry.getCurrentStatus() !== false)\n\t\t)\n\t\t{\n\t\t\tthis.userPlannerSelector.setValue({\n\t\t\t\tattendeesEntityList: entry.getAttendeesEntityList(),\n\t\t\t\tlocation: location,\n\t\t\t\tattendees: entry.getAttendees(),\n\t\t\t\tnotify: !entry.isMeeting() || entry.getMeetingNotify(),\n\t\t\t\tviewMode: this.getMode() === CompactEventForm.VIEW_MODE,\n\t\t\t\tentry: entry,\n\t\t\t\thideGuests: entry.getHideGuests()\n\t\t\t});\n\t\t\tthis.userPlannerSelector.setDateTime(this.dateTimeControl.getValue());\n\t\t\tthis.userPlannerSelector.setViewMode(readOnly);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.remove(this.DOM.userPlannerSelectorOuterWrap);\n\t\t}\n\n\t\tlet hideInfoContainer = true;\n\t\tthis.DOM.infoContainer = this.DOM.wrap.querySelector('.calendar-field-container-info');\n\t\tfor(let i = 0; i <= this.DOM.infoContainer.childNodes.length; i++)\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isElementNode(this.DOM.infoContainer.childNodes[i])\n\t\t\t\t&& this.DOM.infoContainer.childNodes[i].style.display !== 'none'\n\t\t\t)\n\t\t\t{\n\t\t\t\thideInfoContainer = false;\n\t\t\t}\n\t\t}\n\t\tif (hideInfoContainer)\n\t\t{\n\t\t\tthis.DOM.infoContainer.style.display = 'none';\n\t\t}\n\t}\n\n\tsetFormValuesLocation()\n\t{\n\t\tlet\n\t\t\tentry = this.entry,\n\t\t\tsection = this.getCurrentSection(),\n\t\t\treadOnly = true;\n\n\t\t// Date time\n\t\tthis.dateTimeControl.setValue({\n\t\t\tfrom: Util.adjustDateForTimezoneOffset(entry.from, entry.userTimezoneOffsetFrom, entry.fullDay),\n\t\t\tto: Util.adjustDateForTimezoneOffset(entry.to, entry.userTimezoneOffsetTo, entry.fullDay),\n\t\t\tfullDay: entry.fullDay,\n\t\t\ttimezoneFrom: entry.getTimezoneFrom() || '',\n\t\t\ttimezoneTo: entry.getTimezoneTo() || '',\n\t\t\ttimezoneName: this.userSettings.timezoneName,\n\t\t});\n\t\tthis.dateTimeControl.setInlineEditMode(this.isNewEntry() ? 'edit' : 'view');\n\t\tthis.dateTimeControl.setViewMode(readOnly);\n\n\t\t// Title\n\t\tif (this.entry.id !== this.entry.parentId)\n\t\t{\n\t\t\tthis.DOM.titleInput.value = section.name\n\t\t\t\t+ ': ' + BX.util.htmlspecialchars(entry.getName());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.titleInput.value = Loc.getMessage('CALENDAR_UPDATE');\n\t\t}\n\n\t\t// Color\n\t\tthis.colorSelector.setValue(entry.getColor() || section.color, false);\n\t\tthis.colorSelector.setViewMode(!readOnly);\n\n\t\t// Section\n\t\tthis.sectionValue = this.getCurrentSectionId();\n\t\tthis.sectionSelector.updateValue();\n\t\tthis.sectionSelector.setViewMode(readOnly);\n\t}\n\n\tsave(options = {}): boolean\n\t{\n\t\tif (this.state === this.STATE.REQUEST)\n\t\t\treturn false;\n\n\t\tconst entry = this.getCurrentEntry();\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\tif (this.isNewEntry()\n\t\t\t&& this.userPlannerSelector.hasExternalEmailUsers()\n\t\t\t&& Util.checkEmailLimitationPopup()\n\t\t\t&& !options.emailLimitationDialogShown)\n\t\t{\n\t\t\tEntryManager.showEmailLimitationDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\toptions.emailLimitationDialogShown = true;\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.userSettings.sendFromEmail\n\t\t\t&& this.userPlannerSelector.hasExternalEmailUsers())\n\t\t{\n\t\t\tEntryManager.showConfirmedEmailDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.isNewEntry()\n\t\t\t&& entry.isRecursive()\n\t\t\t&& !options.confirmed\n\t\t\t&& this.getFormDataChanges(['section', 'notify']).length > 0)\n\t\t{\n\t\t\tEntryManager.showConfirmEditDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\toptions.recursionMode = (entry.isFirstInstance() && params.recursionMode === 'next')\n\t\t\t\t\t\t? 'all'\n\t\t\t\t\t\t: params.recursionMode;\n\t\t\t\t\toptions.confirmed = true;\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.isNewEntry()\n\t\t\t&& entry.isMeeting()\n\t\t\t&& options.sendInvitesAgain === undefined\n\t\t\t&& this.getFormDataChanges().includes('date&time')\n\t\t\t&& entry.getAttendees().find((item) => {return item.STATUS === 'N';})\n\t\t)\n\t\t{\n\t\t\tEntryManager.showReInviteUsersDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\toptions.sendInvitesAgain = params.sendInvitesAgain;\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tconst dateTime = this.dateTimeControl.getValue();\n\t\tconst data = {\n\t\t\tid: entry.id,\n\t\t\tsection: this.sectionValue,\n\t\t\tname: this.DOM.titleInput.value,\n\t\t\tdesc: entry.getDescription(),\n\t\t\treminder: this.remindersControl.getSelectedValues(),\n\t\t\tdate_from: dateTime.fromDate,\n\t\t\tdate_to: dateTime.toDate,\n\t\t\tskip_time: dateTime.fullDay ? 'Y' : 'N',\n\t\t\ttime_from: Util.formatTime(Util.adjustDateForTimezoneOffset(dateTime.from, -entry.userTimezoneOffsetFrom, dateTime.fullDay)),\n\t\t\ttime_to: Util.formatTime(Util.adjustDateForTimezoneOffset(dateTime.to, -entry.userTimezoneOffsetTo, dateTime.fullDay)),\n\t\t\tlocation: this.locationSelector.getTextValue(),\n\t\t\ttz_from: entry.getTimezoneFrom(),\n\t\t\ttz_to: entry.getTimezoneTo(),\n\t\t\tmeeting_notify: this.userPlannerSelector.getInformValue() ? 'Y' : 'N',\n\t\t\tmeeting_host: entry.data.MEETING_HOST || '0',\n\t\t\tchat_id: entry.data.MEETING\n\t\t\t\t? entry.data.MEETING.CHAT_ID\n\t\t\t\t: 0,\n\t\t\texclude_users: this.excludeUsers || [],\n\t\t\tattendeesEntityList: this.userPlannerSelector.getEntityList(),\n\t\t\tsendInvitesAgain: options.sendInvitesAgain ? 'Y' : 'N',\n\t\t\thide_guests: this.userPlannerSelector.hideGuests ? 'Y' : 'N',\n\t\t\trequestUid: BX.Calendar.Util.registerRequestId(),\n\t\t\tprivate_event: entry.isPrivate() ? 'Y' : 'N'\n\t\t};\n\n\t\tlet checkCurrentUsersAccessibility = !entry.id || this.checkCurrentUsersAccessibility();\n\t\tif (!checkCurrentUsersAccessibility\n\t\t\t&& this.getFormDataChanges().includes('codes'))\n\t\t{\n\t\t\tconst previousAttendeesList = entry.getAttendeesEntityList();\n\t\t\tconst newAttendeesList = [];\n\t\t\tdata.attendeesEntityList.forEach(entity => {\n\t\t\t\tif (!previousAttendeesList.find((item) => {\n\t\t\t\t\treturn entity.entityId === item.entityId\n\t\t\t\t\t\t&& parseInt(entity.id) === parseInt(item.id);\n\t\t\t\t}))\n\t\t\t\t{\n\t\t\t\t\tif (entity.entityId === 'user')\n\t\t\t\t\t{\n\t\t\t\t\t\tnewAttendeesList.push(entity.id);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tcheckCurrentUsersAccessibility = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tdata.newAttendeesList = newAttendeesList;\n\t\t}\n\t\tdata.checkCurrentUsersAccessibility = checkCurrentUsersAccessibility ? 'Y' : 'N';\n\n\t\tif (entry.id && entry.isRecursive())\n\t\t{\n\t\t\tdata.EVENT_RRULE = entry.data.RRULE;\n\t\t}\n\n\t\tif (options.recursionMode)\n\t\t{\n\t\t\tdata.rec_edit_mode = options.recursionMode;\n\t\t\tdata.current_date_from = Util.formatDate(entry.from);\n\t\t}\n\n\t\tif (this.getCurrentSection().color.toLowerCase() !== this.colorSelector.getValue().toLowerCase())\n\t\t{\n\t\t\tdata.color = this.colorSelector.getValue();\n\t\t}\n\n\t\tthis.state = this.STATE.REQUEST;\n\n\t\tthis.freezePopup();\n\t\tthis.BX.ajax.runAction('calendar.api.calendarentryajax.editEntry', {\n\t\t\t\tdata: data,\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tcalendarAction: this.isNewEntry() ? 'create_event' : 'edit_event',\n\t\t\t\t\tformType: 'compact',\n\t\t\t\t\temailGuests: this.userPlannerSelector.hasExternalEmailUsers() ? 'Y' : 'N',\n\t\t\t\t\tmarkView: Util.getCurrentView() || 'outside',\n\t\t\t\t\tmarkCrm: 'N',\n\t\t\t\t\tmarkRrule: 'NONE',\n\t\t\t\t\tmarkMeeting: this.entry.isMeeting() ? 'Y' : 'N',\n\t\t\t\t\tmarkType: this.type\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\t\tif (this.isLocationCalendar && this.roomsManager)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.roomsManager.unsetHiddenRoom(Location.parseStringValue(data.location).room_id);\n\t\t\t\t\t}\n\n\t\t\t\t\t// unset section from hidden\n\t\t\t\t\tconst section = this.getCurrentSection();\n\t\t\t\t\tif (section && !section.isShown())\n\t\t\t\t\t{\n\t\t\t\t\t\tsection.show();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.unfreezePopup();\n\t\t\t\t\tthis.state = this.STATE.READY;\n\t\t\t\t\tif (response.data.entryId)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (entry.id)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tEntryManager.showEditEntryNotification(response.data.entryId);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tEntryManager.showNewEntryNotification(response.data.entryId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.emit('onSave', new BaseEvent({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tresponseData: response.data,\n\t\t\t\t\t\t\toptions: options\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t\tthis.close();\n\n\t\t\t\t\tif (response.data.countEventWithEmailGuestAmount)\n\t\t\t\t\t{\n\t\t\t\t\t\tUtil.setEventWithEmailGuestAmount(response.data.countEventWithEmailGuestAmount);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isArray(response.data.eventList)\n\t\t\t\t\t\t&& response.data.eventList.length\n\t\t\t\t\t\t&& response.data.eventList[0].REMIND\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tEntryManager.setNewEntryReminders(\n\t\t\t\t\t\t\tdateTime.fullDay ? 'fullDay' : 'withTime',\n\t\t\t\t\t\t\tresponse.data.eventList[0].REMIND\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tthis.unfreezePopup();\n\t\t\t\t\tif (response.data && Type.isPlainObject(response.data.busyUsersList))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.handleBusyUsersError(response.data.busyUsersList);\n\n\t\t\t\t\t\tlet errors = [];\n\t\t\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\t\t\tif (error.code !== \"edit_entry_user_busy\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\terrors.push(error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresponse.errors = errors;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (response.errors && response.errors.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showError(response.errors);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.state = this.STATE.ERROR;\n\t\t\t\t}\n\t\t\t);\n\n\t\treturn true;\n\t}\n\n\thandleBusyUsersError(busyUsers)\n\t{\n\t\tlet\n\t\t\tusers = [],\n\t\t\tuserIds = [];\n\n\t\tfor (let id in busyUsers)\n\t\t{\n\t\t\tif (busyUsers.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tusers.push(busyUsers[id]);\n\t\t\t\tuserIds.push(id);\n\t\t\t}\n\t\t}\n\n\t\tthis.busyUsersDialog = new BusyUsersDialog();\n\t\tthis.busyUsersDialog.subscribe('onSaveWithout', () => {\n\t\t\tthis.excludeUsers = userIds.join(',');\n\t\t\tthis.save();\n\t\t});\n\n\t\tthis.busyUsersDialog.show({users: users});\n\t}\n\n\thandleKeyPress(e)\n\t{\n\t\tif (\n\t\t\tthis.getMode() === CompactEventForm.EDIT_MODE\n\t\t\t&& e.keyCode === Util.getKeyCode('enter')\n\t\t\t&& (e.ctrlKey || e.metaKey) && !e.altKey\n\t\t)\n\t\t{\n\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\tthis.locationSelector.selectContol.onChangeCallback();\n\t\t\tthis.save();\n\t\t}\n\t\telse if (\n\t\t\tthis.checkTopSlider()\n\t\t\t&& e.keyCode === Util.getKeyCode('escape')\n\t\t\t&& this.couldBeClosedByEsc()\n\t\t)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse if (\n\t\t\te.keyCode === Util.getKeyCode('delete')\n\t\t\t&& !this.isNewEntry()\n\t\t\t&& this.canDo('delete')\n\t\t)\n\t\t{\n\t\t\tconst target = event.target || event.srcElement;\n\t\t\tconst tagName = Type.isElementNode(target) ? target.tagName.toLowerCase() : null;\n\t\t\tif (tagName && !['input', 'textarea'].includes(tagName))\n\t\t\t{\n\t\t\t\tEventEmitter.subscribeOnce('BX.Calendar.Entry:beforeDelete', () => {\n\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\tthis.close();\n\t\t\t\t});\n\t\t\t\tEntryManager.deleteEntry(this.entry);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetCurrentEntry()\n\t{\n\t\treturn this.entry;\n\t}\n\n\tgetCurrentSection()\n\t{\n\t\tlet section = false;\n\t\tconst sectionId = this.getCurrentSectionId();\n\n\t\tif (\n\t\t\tsectionId\n\t\t\t&& this.sectionIndex[sectionId] !== undefined\n\t\t\t&& this.sections[this.sectionIndex[sectionId]] !== undefined)\n\t\t{\n\t\t\tsection = this.sections[this.sectionIndex[sectionId]];\n\t\t}\n\t\treturn section;\n\t}\n\n\tgetCurrentSectionId()\n\t{\n\t\tlet sectionId = 0;\n\t\tif (this.sectionValue)\n\t\t{\n\t\t\tsectionId = this.sectionValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst entry = this.getCurrentEntry();\n\t\t\tif (entry instanceof Entry)\n\t\t\t{\n\t\t\t\tsectionId = parseInt(entry.sectionId);\n\t\t\t}\n\n\t\t\t// TODO: refactor - don't take first section\n\t\t\tif (!sectionId && this.sections[0])\n\t\t\t{\n\t\t\t\tsectionId = parseInt(this.sections[0].id);\n\t\t\t}\n\t\t}\n\t\treturn sectionId;\n\t}\n\n\thandlePlannerSelectorChanges(event)\n\t{\n\t\tif (event instanceof BaseEvent)\n\t\t{\n\t\t\tconst dateTimeValue = this.dateTimeControl.getValue();\n\t\t\tdateTimeValue.from = event.getData().dateFrom;\n\t\t\tdateTimeValue.to = event.getData().dateTo;\n\t\t\t// Date time\n\t\t\tthis.dateTimeControl.setValue(dateTimeValue);\n\t\t\tthis.userPlannerSelector.setDateTime(this.dateTimeControl.getValue());\n\n\t\t\tif (this.locationSelector)\n\t\t\t{\n\t\t\t\tthis.locationSelector.checkLocationAccessibility(\n\t\t\t\t\t{\n\t\t\t\t\t\tfrom: event.getData().dateFrom,\n\t\t\t\t\t\tto: event.getData().dateTo,\n\t\t\t\t\t\tfullDay: event.getData().fullDay,\n\t\t\t\t\t\tcurrentEventId: this.entry.id\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t}\n\t\t\tthis.checkForChangesDebounce();\n\t\t}\n\t}\n\n\teditEntryInSlider()\n\t{\n\t\tthis.checkDataBeforeCloseMode = false;\n\t\tconst dateTime = this.dateTimeControl.getValue();\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tBX.Calendar.EntryManager.openEditSlider({\n\t\t\tcalendarContext: calendarContext,\n\t\t\tentry: this.entry,\n\t\t\ttype: this.type,\n\t\t\tisLocationCalendar: this.isLocationCalendar,\n\t\t\tlocationAccess: this.locationAccess,\n\t\t\tdayOfWeekMonthFormat: this.dayOfWeekMonthFormat,\n\t\t\troomsManager: this.roomsManager,\n\t\t\tlocationCapacity: Location.getCurrentCapacity(), // for location component\n\t\t\townerId: this.ownerId,\n\t\t\tuserId: this.userId,\n\t\t\tformDataValue: {\n\t\t\t\tsection: this.sectionValue,\n\t\t\t\tname: this.DOM.titleInput.value,\n\t\t\t\treminder: this.remindersControl.getSelectedRawValues(),\n\t\t\t\tcolor: this.colorSelector.getValue(),\n\t\t\t\tfrom: Util.adjustDateForTimezoneOffset(dateTime.from, -this.entry.userTimezoneOffsetFrom, dateTime.fullDay),\n\t\t\t\tto: Util.adjustDateForTimezoneOffset(dateTime.to, -this.entry.userTimezoneOffsetTo, dateTime.fullDay),\n\t\t\t\tfullDay: dateTime.fullDay,\n\t\t\t\tlocation: this.locationSelector.getTextValue(),\n\t\t\t\tmeetingNotify: this.userPlannerSelector.getInformValue() ? 'Y' : 'N',\n\t\t\t\thideGuests: this.userPlannerSelector.hideGuests ? 'Y' : 'N',\n\t\t\t\tattendeesEntityList: this.userPlannerSelector.getEntityList()\n\t\t\t}\n\t\t});\n\t\tthis.close();\n\t}\n\n\toutsideMouseDownClose(event)\n\t{\n\t\tlet target = event.target || event.srcElement;\n\t\tthis.outsideMouseDown = !target.closest('div.popup-window');\n\t}\n\n\tcheckTopSlider()\n\t{\n\t\treturn !Util.getBX().SidePanel.Instance.getTopSlider();\n\t}\n\n\tcheckOutsideClickClose(event)\n\t{\n\t\tlet target = event.target || event.srcElement;\n\t\tthis.outsideMouseUp = !target.closest('div.popup-window');\n\t\tif (this.couldBeClosedByEsc()\n\t\t\t&& this.outsideMouseDown\n\t\t\t&& this.outsideMouseUp\n\t\t\t&& (this.getMode() === CompactEventForm.VIEW_MODE\n\t\t\t\t|| !this.formDataChanged()\n\t\t\t\t|| this.isNewEntry())\n\t\t)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.close(false);\n\t\t\t}, 0);\n\t\t}\n\t}\n\n\tcouldBeClosedByEsc()\n\t{\n\t\treturn !PopupManager._popups.find((popup)=>{return popup && popup.getId() !== this.popupId && popup.isShown();});\n\t}\n\n\temitOnChange()\n\t{\n\t\tthis.emit('onChange', new BaseEvent({\n\t\t\tdata: {\n\t\t\t\tform: this,\n\t\t\t\tentry: this.entry\n\t\t\t}\n\t\t}));\n\t}\n\n\tshowError(errorList)\n\t{\n\t\tlet errorText = '';\n\n\t\tif (Type.isArray(errorList))\n\t\t{\n\t\t\terrorList.forEach((error) => {\n\t\t\t\terrorText += error.message + \"\\n\";\n\t\t\t});\n\t\t}\n\n\t\tif (errorText !== '')\n\t\t{\n\t\t\talert(errorText);\n\t\t}\n\t}\n\n\treloadEntryData()\n\t{\n\t\tif (this.isShown()\n\t\t\t&& !this.isNewEntry()\n\t\t\t&& this.getMode() === CompactEventForm.VIEW_MODE)\n\t\t{\n\t\t\tconst calendar = Util.getCalendarContext();\n\t\t\tif (calendar)\n\t\t\t{\n\t\t\t\tconst entry = EntryManager.getEntryInstance(\n\t\t\t\t\tcalendar.getView().getEntryById(this.entry.getUniqueId())\n\t\t\t\t);\n\n\t\t\t\tif (entry && entry.getUniqueId())\n\t\t\t\t{\n\t\t\t\t\tthis.entry = entry;\n\t\t\t\t\tthis.setFormValues();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckCurrentUsersAccessibility()\n\t{\n\t\treturn this.getFormDataChanges().includes('date&time');\n\t}\n\n\thandlePull(params)\n\t{\n\t\tif (this.userPlannerSelector\n\t\t\t&& this.userPlannerSelector?.planner?.isShown())\n\t\t{\n\t\t\tconst userIdList = Type.isArray(params?.fields?.ATTENDEES) ? params.fields.ATTENDEES: [];\n\t\t\tconst eventOwner = params?.fields?.CAL_TYPE === 'user'\n\t\t\t\t? parseInt(params?.fields?.OWNER_ID)\n\t\t\t\t: parseInt(params?.fields?.CREATED_BY);\n\t\t\tif (!userIdList.includes(eventOwner))\n\t\t\t{\n\t\t\t\tuserIdList.push(eventOwner);\n\t\t\t}\n\t\t\tthis.userPlannerSelector.clearAccessibilityData(userIdList);\n\n\t\t\tthis.userPlannerSelector.refreshPlannerStateDebounce();\n\t\t}\n\n\t\tconst entry = this.getCurrentEntry();\n\t\tif (\n\t\t\t!this.isNewEntry()\n\t\t\t&& entry\n\t\t\t&& entry.parentId === parseInt(params?.fields?.PARENT_ID)\n\t\t)\n\t\t{\n\t\t\tif (params.command === 'delete_event'\n\t\t\t\t&& entry.getType() === params?.fields?.CAL_TYPE)\n\t\t\t{\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst onEntryListReloadHandler = () => {\n\t\t\t\t\tthis.reloadEntryDataDebounce();\n\t\t\t\t\tBX.Event.EventEmitter.unsubscribe('BX.Calendar:onEntryListReload', onEntryListReloadHandler);\n\t\t\t\t};\n\t\t\t\tBX.Event.EventEmitter.subscribe('BX.Calendar:onEntryListReload', onEntryListReloadHandler);\n\t\t\t}\n\t\t}\n\t}\n\n\tisSyncSection(section)\n\t{\n\t\treturn section.isGoogle()\n\t\t\t|| section.isIcloud()\n\t\t\t|| section.isOffice365()\n\t\t\t|| section.isCalDav()\n\t\t\t|| section.hasConnection()\n\t\t;\n\t}\n\n\tgetSectionsForEditEvent(sections, currentSection)\n\t{\n\t\tconst result = [];\n\t\tconst currentType = currentSection.type;\n\t\tresult.push(currentSection);\n\n\t\tsections.forEach((section) => {\n\t\t\tif (!this.isSyncSection(section) && section.type === currentType)\n\t\t\t{\n\t\t\t\tresult.push(section);\n\t\t\t}\n\t\t});\n\n\t\tthis.sections = result;\n\t\tthis.sectionIndex = [];\n\t\tif (Type.isArray(this.sections))\n\t\t{\n\t\t\tthis.sections.forEach((value, ind) => {\n\t\t\t\tconst id = parseInt(value.ID || value.id);\n\t\t\t\tif (id > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.sectionIndex[id] = ind;\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\t}\n\n\treleaseLocation(options = {})\n\t{\n\t\tconst entry = this.getCurrentEntry();\n\n\t\tif (entry.id && entry.isRecursive()\n\t\t\t&& !options.confirmed\n\t\t)\n\t\t{\n\t\t\tEntryManager.showConfirmEditDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\toptions.confirmed = true;\n\t\t\t\t\tthis.releaseLocation({\n\t\t\t\t\t\trecursionMode: params.recursionMode,\n\t\t\t\t\t\tconfirmed: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif(!options.recursionMode)\n\t\t{\n\t\t\toptions.recursionMode = '';\n\t\t}\n\n\t\tthis.state = this.STATE.REQUEST;\n\n\t\tthis.freezePopup();\n\n\t\tthis.BX.ajax.runAction('calendar.api.locationajax.cancelBooking', {\n\t\t\tdata:{\n\t\t\t\tparent_event_id: entry.parentId,\n\t\t\t\trecursion_mode: options.recursionMode,\n\t\t\t\tsection_id: entry.sectionId,\n\t\t\t\tcurrent_event_date_from: entry.data.DATE_FROM,\n\t\t\t\tcurrent_event_date_to: entry.data.DATE_TO,\n\t\t\t\towner_id: entry.data.CREATED_BY,\n\t\t\t}\n\t\t})\n\t\t.then((response) => {\n\t\t\t\tthis.unfreezePopup();\n\t\t\t\tthis.state = this.STATE.READY;\n\t\t\t\tEntryManager.showReleaseLocationNotification();\n\t\t\t\tthis.calendarContext.reloadDebounce();\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tthis.unfreezePopup();\n\t\t\t\tthis.state = this.STATE.ERROR;\n\t\t\t\tthis.close();\n\t\t});\n\n\t\treturn true;\n\t}\n}"],"names":["CompactEventForm","EventEmitter","constructor","options","STATE","READY","REQUEST","ERROR","zIndex","Z_INDEX_OFFSET","userSettings","DOM","displayed","sections","sectionIndex","trackingUsersList","checkDataBeforeCloseMode","CHECK_CHANGES_DELAY","RELOAD_DATA_DELAY","setEventNamespace","userId","Util","getCurrentUserId","type","isLocationCalendar","calendarContext","ownerId","BX","getBX","checkForChangesDebounce","Runtime","debounce","checkForChanges","reloadEntryDataDebounce","reloadEntryData","checkOutsideClickClose","bind","outsideMouseDownClose","keyHandler","handleKeyPress","show","mode","EDIT_MODE","params","setParams","setMode","state","popupId","Math","round","random","popup","destroy","getPopup","Dom","addClass","titleBar","removeClass","popupContainer","closeIcon","Event","document","getMode","EntryManager","doDelayedActions","prepareData","then","checkLocationView","setFormValuesLocation","setFormValues","userPlannerSelector","attendeesEntityList","length","VIEW_MODE","showPlanner","canDo","titleInput","focus","select","sendAnalyticLabel","calendarAction","formType","getButtons","button","isPlannerDisplayed","checkBusyTime","Popup","bindNode","closeByEsc","offsetTop","offsetLeft","draggable","resizable","lightShadow","className","cacheable","content","getPopupContentLocation","getPopupContentCalendar","buttons","events","onPopupClose","close","isShown","fromButton","checkTopSlider","formDataChanged","confirm","Loc","getMessage","destroyed","setTimeout","emit","unbind","Location","setCurrentCapacity","clearPlannerWatches","closeAllPopups","wrap","Tag","render","titleOuterWrap","getTitleControl","getColorControl","getSectionControl","getDateTimeControl","getUserPlannerSelector","getTypeInfoControl","getLocationControl","remindersOuterWrap","createRemindersControl","getRRuleInfoControl","getTitleControlLocation","getColorControlsLocationView","entry","id","parentId","appendChild","getHostControl","saveBtn","UI","Button","name","text","isNewEntry","click","save","setAttribute","push","closeBtn","setButtons","fullFormBtn","editEntryInSlider","isMeeting","getCurrentStatus","acceptBtn","setMeetingStatus","refreshMeetingStatus","declineBtn","Calendar","openViewSlider","from","timezoneOffset","data","TZ_OFFSET_FROM","releaseLocation","openBtn","subscribeOnce","deleteEntry","wasEverRecursive","freezePopup","forEach","setClocking","setDisabled","unfreezePopup","displayAttendees","getAttendees","hideLoader","Type","isDomNode","loader","remove","showInEditMode","showInViewMode","emitOnChange","checkLocationForm","event","BaseEvent","getData","usersCount","locationCapacity","getCurrentCapacity","locationSelector","value","undefined","addCapacityAlert","removeCapacityAlert","getFormDataChanges","excludes","fields","includes","getTextLocation","parseStringValue","getLocation","getTextValue","dateTime","dateTimeControl","getValue","isFullDay","fullDay","toString","to","getMeetingNotify","getInformValue","parseInt","sectionId","sectionValue","getEntityList","map","item","entityId","join","getAttendeesEntityList","locationAccess","dayOfWeekMonthFormat","getEntryInstance","userIndex","isPlainObject","entryTime","isDate","setDateTimeValue","locationFeatureEnabled","locationList","isArray","filter","locationItem","PERM","view_full","roomsManager","iblockMeetingRoomList","plannerFeatureEnabled","setSections","trackingUserList","ind","ID","section","getCurrentSection","getSectionsForEditEvent","Promise","resolve","ajax","runAction","entryId","loadSectionId","response","window","BXEventCalendar","Section","getCalendarContext","CREATED_BY","userUrl","USER_URL","replace","userAvatar","AVATAR","hostBar","util","htmlspecialchars","colorSelect","colorSelector","ColorSelector","subscribe","color","COLOR","sectionSelectWrap","sectionSelector","SectionSelector","outerWrap","defaultCalendarType","defaultOwnerId","sectionList","sectionGroupList","SectionManager","getSectionGroupList","selectCallback","setValue","saveDefaultSectionId","dateTimeWrap","DateTimeControl","showTimezone","inlineEditMode","remindersControl","setFullDayMode","wasChangedByUser","defaultReminders","getNewEntryReminders","setLocationValue","setDateTime","refreshPlannerStateDebounce","checkLocationAccessibility","currentEventId","userPlannerSelectorOuterWrap","userSelectorWrap","informWrap","plannerOuterWrap","hideGuestsWrap","UserPlannerSelector","readOnlyMode","handlePlannerSelectorChanges","locationWrap","locationOuterWrap","richLocationEnabled","inlineEditModeEnabled","onChangeCallback","reminderValues","remindersWrap","Reminder","values","reminders","REMIND","typeInfoTitle","typeInfoLink","typeInfoWrap","rruleInfo","rruleInfoWrap","getTimezoneInfoControl","timezoneInfo","timezoneInfoWrap","action","isResourcebooking","readOnly","adjustDateForTimezoneOffset","userTimezoneOffsetFrom","userTimezoneOffsetTo","timezoneFrom","getTimezoneFrom","timezoneTo","getTimezoneTo","timezoneName","setInlineEditMode","setViewMode","getName","titleLabel","parentNode","insertBefore","Text","encode","disabled","getColor","getCurrentSectionId","updateValue","isSyncSection","getReminders","style","display","isRecursive","adjust","getRRuleDescription","location","default","attendees","notify","viewMode","hideGuests","getHideGuests","hideInfoContainer","infoContainer","querySelector","i","childNodes","isElementNode","getCurrentEntry","hasExternalEmailUsers","checkEmailLimitationPopup","emailLimitationDialogShown","showEmailLimitationDialog","callback","sendFromEmail","showConfirmedEmailDialog","confirmed","showConfirmEditDialog","recursionMode","isFirstInstance","sendInvitesAgain","find","STATUS","showReInviteUsersDialog","desc","getDescription","reminder","getSelectedValues","date_from","fromDate","date_to","toDate","skip_time","time_from","formatTime","time_to","tz_from","tz_to","meeting_notify","meeting_host","MEETING_HOST","chat_id","MEETING","CHAT_ID","exclude_users","excludeUsers","hide_guests","requestUid","registerRequestId","private_event","isPrivate","checkCurrentUsersAccessibility","previousAttendeesList","newAttendeesList","entity","EVENT_RRULE","RRULE","rec_edit_mode","current_date_from","formatDate","toLowerCase","analyticsLabel","emailGuests","markView","getCurrentView","markCrm","markRrule","markMeeting","markType","unsetHiddenRoom","room_id","showEditEntryNotification","showNewEntryNotification","responseData","countEventWithEmailGuestAmount","setEventWithEmailGuestAmount","eventList","setNewEntryReminders","busyUsersList","handleBusyUsersError","errors","error","code","showError","busyUsers","users","userIds","hasOwnProperty","busyUsersDialog","BusyUsersDialog","e","keyCode","getKeyCode","ctrlKey","metaKey","altKey","selectContol","couldBeClosedByEsc","target","srcElement","tagName","Entry","dateTimeValue","dateFrom","dateTo","openEditSlider","formDataValue","getSelectedRawValues","meetingNotify","outsideMouseDown","closest","SidePanel","Instance","getTopSlider","outsideMouseUp","PopupManager","_popups","getId","form","errorList","errorText","message","alert","calendar","getView","getEntryById","getUniqueId","handlePull","planner","userIdList","ATTENDEES","eventOwner","CAL_TYPE","OWNER_ID","clearAccessibilityData","PARENT_ID","command","getType","onEntryListReloadHandler","unsubscribe","isGoogle","isIcloud","isOffice365","isCalDav","hasConnection","currentSection","result","currentType","parent_event_id","recursion_mode","section_id","current_event_date_from","DATE_FROM","current_event_date_to","DATE_TO","owner_id","showReleaseLocationNotification","reloadDebounce"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAiBO,MAAMA,gBAAN,SAA+BC,6BAA/B,CACP;GAkBCC,WAAW,CAACC,OAAO,GAAG,EAAX,EACX;KACC;KADD,KAfAC,KAeA,GAfQ;OAACC,KAAK,EAAE,CAAR;OAAWC,OAAO,EAAE,CAApB;OAAuBC,KAAK,EAAE;MAetC;KAAA,KAdAC,MAcA,GAdS,IAcT;KAAA,KAbAC,cAaA,GAbiB,CAAC,IAalB;KAAA,KAZAC,YAYA,GAZe,EAYf;KAAA,KAXAC,GAWA,GAXM,EAWN;KAAA,KATAC,SASA,GATY,KASZ;KAAA,KARAC,QAQA,GARW,EAQX;KAAA,KAPAC,YAOA,GAPe,EAOf;KAAA,KANAC,iBAMA,GANoB,EAMpB;KAAA,KALAC,wBAKA,GAL2B,IAK3B;KAAA,KAJAC,mBAIA,GAJsB,GAItB;KAAA,KAHAC,iBAGA,GAHoB,GAGpB;KAEC,KAAKC,iBAAL,CAAuB,8BAAvB;KACA,KAAKC,MAAL,GAAcjB,OAAO,CAACiB,MAAR,IAAkBC,kBAAI,CAACC,gBAAL,EAAhC;KACA,KAAKC,IAAL,GAAYpB,OAAO,CAACoB,IAAR,IAAgB,MAA5B;KACA,KAAKC,kBAAL,GAA0BrB,OAAO,CAACqB,kBAAR,IAA8B,KAAxD;KACA,KAAKC,eAAL,GAAuBtB,OAAO,CAACsB,eAAR,IAA2B,IAAlD;KACA,KAAKC,OAAL,GAAevB,OAAO,CAACuB,OAAR,IAAmB,KAAKN,MAAvC;KACA,KAAKO,EAAL,GAAUN,kBAAI,CAACO,KAAL,EAAV;KAEA,KAAKC,uBAAL,GAA+BC,iBAAO,CAACC,QAAR,CAAiB,KAAKC,eAAtB,EAAuC,KAAKf,mBAA5C,EAAiE,IAAjE,CAA/B;KACA,KAAKgB,uBAAL,GAA+BH,iBAAO,CAACC,QAAR,CAAiB,KAAKG,eAAtB,EAAuC,KAAKhB,iBAA5C,EAA+D,IAA/D,CAA/B;KACA,KAAKiB,sBAAL,GAA8B,KAAKA,sBAAL,CAA4BC,IAA5B,CAAiC,IAAjC,CAA9B;KACA,KAAKC,qBAAL,GAA6B,KAAKA,qBAAL,CAA2BD,IAA3B,CAAgC,IAAhC,CAA7B;KACA,KAAKE,UAAL,GAAkB,KAAKC,cAAL,CAAoBH,IAApB,CAAyB,IAAzB,CAAlB;;;GAGDI,IAAI,CAACC,IAAI,GAAGzC,gBAAgB,CAAC0C,SAAzB,EAAoCC,MAAM,GAAE,EAA5C,EACJ;KACC,KAAKC,SAAL,CAAeD,MAAf;KACA,KAAKE,OAAL,CAAaJ,IAAb;KAEA,KAAKK,KAAL,GAAa,KAAK1C,KAAL,CAAWC,KAAxB;KAEA,KAAK0C,OAAL,GAAe,wBAAwBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,MAA3B,CAAvC;;KAEA,IAAI,KAAKC,KAAT,EACA;OACC,KAAKA,KAAL,CAAWC,OAAX;;;KAED,KAAKD,KAAL,GAAa,KAAKE,QAAL,CAAcV,MAAd,CAAb,CAZD;;KAeCW,aAAG,CAACC,QAAJ,CAAa,KAAKJ,KAAL,CAAWK,QAAxB,EAAkC,6BAAlC;KACAF,aAAG,CAACG,WAAJ,CAAgB,KAAKN,KAAL,CAAWO,cAA3B,EAA2C,4BAA3C;KACAJ,aAAG,CAACG,WAAJ,CAAgB,KAAKN,KAAL,CAAWQ,SAA3B,EAAsC,kCAAtC;KACAC,eAAK,CAACxB,IAAN,CAAWyB,QAAX,EAAqB,WAArB,EAAkC,KAAKxB,qBAAvC;KACAuB,eAAK,CAACxB,IAAN,CAAWyB,QAAX,EAAqB,SAArB,EAAgC,KAAK1B,sBAArC;KACAyB,eAAK,CAACxB,IAAN,CAAWyB,QAAX,EAAqB,SAArB,EAAgC,KAAKvB,UAArC;KACAsB,eAAK,CAACxB,IAAN,CAAW,KAAKe,KAAL,CAAWO,cAAtB,EAAsC,eAAtC,EAAuD,MAAM;OAACJ,aAAG,CAACG,WAAJ,CAAgB,KAAKN,KAAL,CAAWO,cAA3B,EAA2C,iCAA3C;MAA9D,EArBD;;KAwBC,IAAI,KAAKI,OAAL,OAAmB9D,gBAAgB,CAAC0C,SAAxC,EACA;OACCqB,2BAAY,CAACC,gBAAb;;;KAGD,KAAKC,WAAL,GACEC,IADF,CACO,MAAM;OACX,IAAI,KAAKC,iBAAL,EAAJ,EACA;SACC,KAAKC,qBAAL;QAFD,MAKA;SACC,KAAKC,aAAL;;;OAGD,KAAKlB,KAAL,CAAWX,IAAX;;OACA,IAAI,KAAKhB,kBAAL,IACC,KAAK8C,mBAAL,CAAyBC,mBAAzB,CAA6CC,MAA7C,GAAsD,CAAtD,IAA2D,KAAKV,OAAL,OAAmB9D,gBAAgB,CAACyE,SADpG,EAGA;SACC,KAAKH,mBAAL,CAAyBI,WAAzB;;;OAGD,KAAK1D,wBAAL,GAAgC,IAAhC;;OACA,IAAI,KAAK2D,KAAL,CAAW,MAAX,KAAsB,KAAKhE,GAAL,CAASiE,UAA/B,IAA6CnC,IAAI,KAAKzC,gBAAgB,CAAC0C,SAA3E,EACA;SACC,KAAK/B,GAAL,CAASiE,UAAT,CAAoBC,KAApB;SACA,KAAKlE,GAAL,CAASiE,UAAT,CAAoBE,MAApB;;;OAGD,KAAKlE,SAAL,GAAiB,IAAjB;;OAEA,IAAI,KAAKkD,OAAL,OAAmB9D,gBAAgB,CAACyE,SAAxC,EACA;SACCpD,kBAAI,CAAC0D,iBAAL,CAAuB;WAACC,cAAc,EAAE,YAAjB;WAA+BC,QAAQ,EAAE;UAAhE;SACA,KAAK9B,KAAL,CAAW+B,UAAX,GAAwB,CAAxB,EAA2BC,MAA3B,CAAkCN,KAAlC;;;OAGD,IACC,KAAKf,OAAL,OAAmB9D,gBAAgB,CAAC0C,SAApC,IACG,CAAC,KAAK4B,mBAAL,CAAyBc,kBAAzB,EAFL,EAIA;SACC,KAAKd,mBAAL,CAAyBe,aAAzB;;MAvCH;;;GA4CDlB,iBAAiB,GACjB;KACC,OAAO,KAAKL,OAAL,OAAmB9D,gBAAgB,CAACyE,SAApC,IAAiD,KAAKlD,IAAL,KAAc,UAAtE;;;GAGD8B,QAAQ,CAACV,MAAD,EACR;KACC,OAAO,IAAI2C,gBAAJ,CAAU,KAAKvC,OAAf,EACNJ,MAAM,CAAC4C,QADD,EAEN;OACC/E,MAAM,EAAE,KAAKA,MAAL,GAAc,KAAKC,cAD5B;OAEC+E,UAAU,EAAE,IAFb;OAGCC,SAAS,EAAE,CAHZ;OAICC,UAAU,EAAE,CAJb;OAKC/B,SAAS,EAAE,IALZ;OAMCH,QAAQ,EAAE,IANX;OAOCmC,SAAS,EAAE,IAPZ;OAQCC,SAAS,EAAE,KARZ;OASCC,WAAW,EAAE,IATd;OAUCC,SAAS,EAAE,4DAVZ;OAWCC,SAAS,EAAE,KAXZ;OAYCC,OAAO,EAAE,KAAK7B,iBAAL,KACN,KAAK8B,uBAAL,EADM,GAEN,KAAKC,uBAAL,EAdJ;OAeCC,OAAO,EAAE,KAAKjB,UAAL,EAfV;OAgBCkB,MAAM,EAAE;SACPC,YAAY,EAAE,KAAKC,KAAL,CAAWlE,IAAX,CAAgB,IAAhB;;MAnBV,CAAP;;;GAwBDmE,OAAO,GACP;KACC,OAAO,KAAK3F,SAAZ;;;GAGD0F,KAAK,CAACE,UAAU,GAAG,IAAd,EACL;KACC,IAEE,CAACA,UAAD,IAAe,CAAC,KAAKC,cAAL,EADjB,IAKC,KAAK3C,OAAL,OAAmB9D,gBAAgB,CAAC0C,SAApC,IACG,KAAKgE,eAAL,EADH,IAEG,KAAK1F,wBAFR,IAGG,CAAC2F,OAAO,CAACC,aAAG,CAACC,UAAJ,CAAe,uBAAf,CAAD,CATb,EAYA;;OAEC,IAAI,KAAK1D,KAAT,EACA;SACC,KAAKA,KAAL,CAAW2D,SAAX,GAAuB,IAAvB;SACAC,UAAU,CAAC,MAAM;WAAC,KAAK5D,KAAL,CAAW2D,SAAX,GAAuB,KAAvB;UAAR,EAAwC,CAAxC,CAAV;;;OAED;;;KAGD,KAAKlG,SAAL,GAAiB,KAAjB;KACA,KAAKoG,IAAL,CAAU,SAAV;KACApD,eAAK,CAACqD,MAAN,CAAapD,QAAb,EAAuB,WAAvB,EAAoC,KAAKxB,qBAAzC;KACAuB,eAAK,CAACqD,MAAN,CAAapD,QAAb,EAAuB,SAAvB,EAAkC,KAAK1B,sBAAvC;KACAyB,eAAK,CAACqD,MAAN,CAAapD,QAAb,EAAuB,SAAvB,EAAkC,KAAKvB,UAAvC;;KAEA,IAAI,KAAKgC,mBAAT,EACA;OACC,KAAKA,mBAAL,CAAyBlB,OAAzB;;;KAGD,IAAI,KAAKD,KAAT,EACA;OACC,KAAKA,KAAL,CAAWC,OAAX;;;KAGD,IAAI8D,0BAAJ,EACA;OACCA,0BAAQ,CAACC,kBAAT,CAA4B,CAA5B;;;KAED9F,kBAAI,CAAC+F,mBAAL;KACA/F,kBAAI,CAACgG,cAAL;;;GAGDnB,uBAAuB,GACvB;KACC,KAAKvF,GAAL,CAAS2G,IAAT,GAAgBC,aAAG,CAACC,MAApB,cAA2B;KAA3B,CAOS;;MAPT,CASyC;;;KATzC,CAY6B;;KAZ7B,CAciC;;;MAdjC,CAiB8B;;OAjB9B,CAmB+B;;MAnB/B,CAyBU;MAzBV,CA0B+B;;SA1B/B,GACG,KAAK7G,GAAL,CAAS8G,cAAT,GAA0BF,aAAG,CAACC,MAA9B,gBAAqC;;;OAArC,CAGyB;OAHzB,CAIyB;;UAJzB,GAGE,KAAKE,eAAL,EAHF,EAIE,KAAKC,eAAL,EAJF,CADH,EASI,KAAKC,iBAAL,CAAuB,YAAvB,CATJ,EAYG,KAAKC,kBAAL,EAZH,EAcG,KAAKC,sBAAL,EAdH,EAiBI,KAAKC,kBAAL,EAjBJ,EAmBK,KAAKC,kBAAL,EAnBL,EAqBI,KAAKrH,GAAL,CAASsH,kBAAT,GAA8BV,aAAG,CAACC,MAAlC,gBAAyC;;yCAAzC,CAEqE;OAFrE,CAG+B;WAH/B,GAEmCZ,aAAG,CAACC,UAAJ,CAAe,iBAAf,CAFnC,EAGC,KAAKqB,sBAAL,EAHD,CArBJ,EA0BI,KAAKC,mBAAL,EA1BJ;KA8BA,OAAO,KAAKxH,GAAL,CAAS2G,IAAhB;;;GAGDrB,uBAAuB,GACvB;KACC,KAAKtF,GAAL,CAAS2G,IAAT,GAAgBC,aAAG,CAACC,MAApB,gBAA2B;KAA3B,CAOS;;MAPT,CASuC;;KATvC,CAW6B;;SAX7B,GACG,KAAK7G,GAAL,CAAS8G,cAAT,GAA0BF,aAAG,CAACC,MAA9B,gBAAqC;;;OAArC,CAGiC;OAHjC,CAIsC;;UAJtC,GAGE,KAAKY,uBAAL,EAHF,EAIE,KAAKC,4BAAL,EAJF,CADH,EASI,KAAKT,iBAAL,CAAuB,UAAvB,CATJ,EAWG,KAAKC,kBAAL,EAXH;;KAcA,IAAI,KAAKS,KAAL,CAAWC,EAAX,KAAkB,KAAKD,KAAL,CAAWE,QAAjC,EACA;OACC,KAAK7H,GAAL,CAAS2G,IAAT,CAAcmB,WAAd,CAA0BlB,aAAG,CAACC,MAA9B,gBAAqC;MAArC,CACyB;IADzB,GACG,KAAKkB,cAAL,EADH;;;KAKD,OAAO,KAAK/H,GAAL,CAAS2G,IAAhB;;;GAGDpC,UAAU,GACV;KACC,IAAIiB,OAAO,GAAG,EAAd;KACA,MAAM1D,IAAI,GAAG,KAAKqB,OAAL,EAAb;;KAEA,IAAIrB,IAAI,KAAKzC,gBAAgB,CAAC0C,SAA9B,EACA;OACC,MAAMiG,OAAO,GAAG,IAAIhH,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;SAChCC,IAAI,EAAE,MAD0B;SAEhCC,IAAI,EAAI,KAAKC,UAAL,KACLpC,aAAG,CAACC,UAAJ,CAAe,uBAAf,CADK,GAELD,aAAG,CAACC,UAAJ,CAAe,wBAAf,CAJ6B;SAKhCf,SAAS,EAAE,uBALqB;SAMhCM,MAAM,EAAG;WAAC6C,KAAK,EAAG,MAAM;aACtB,KAAKjI,wBAAL,GAAgC,KAAhC;aACA,KAAKkI,IAAL;;;QARa,CAAhB;OAWAP,OAAO,CAACxD,MAAR,CAAegE,YAAf,CAA4B,WAA5B,EAAyC,YAAzC;OACAhD,OAAO,CAACiD,IAAR,CAAaT,OAAb;OAGA,MAAMU,QAAQ,GAAG,IAAI1H,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;SACjCE,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,0BAAf,CAD0B;SAEjCf,SAAS,EAAE,oBAFsB;SAGjCM,MAAM,EAAG;WAAC6C,KAAK,EAAG,MAAM;aACtB,IAAI,KAAKD,UAAL,EAAJ,EACA;eACC,KAAKhI,wBAAL,GAAgC,KAAhC;eACA,KAAKsF,KAAL;cAHD,MAMA;eACC,KAAKjC,aAAL;;eAEA,IAAI,KAAKC,mBAAT,EACA;iBACC,KAAKA,mBAAL,CAAyBlB,OAAzB;;;eAGD,KAAKP,OAAL,CAAa7C,gBAAgB,CAACyE,SAA9B;eACA,KAAKtB,KAAL,CAAWmG,UAAX,CAAsB,KAAKpE,UAAL,EAAtB;;;;QAnBa,CAAjB;OAuBAmE,QAAQ,CAAClE,MAAT,CAAgBgE,YAAhB,CAA6B,WAA7B,EAA0C,aAA1C;OACAhD,OAAO,CAACiD,IAAR,CAAaC,QAAb;OAEA,MAAME,WAAW,GAAG,IAAI5H,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;SACpCE,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,0BAAf,CAD6B;SAEpCf,SAAS,EAAE,+BAFyB;SAGpCM,MAAM,EAAG;WAAC6C,KAAK,EAAG,KAAKO,iBAAL,CAAuBpH,IAAvB,CAA4B,IAA5B;;QAHC,CAApB;OAKAmH,WAAW,CAACpE,MAAZ,CAAmBgE,YAAnB,CAAgC,WAAhC,EAA6C,UAA7C;OACAhD,OAAO,CAACiD,IAAR,CAAaG,WAAb;MAjDD,MAmDK,IAAI9G,IAAI,KAAKzC,gBAAgB,CAACyE,SAA9B,EACL;OACC,IAAI,KAAK6D,KAAL,CAAWmB,SAAX,MAA0B,KAAKnB,KAAL,CAAWoB,gBAAX,OAAkC,GAAhE,EACA;SACC,MAAMC,SAAS,GAAG,IAAIhI,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;WAClC/C,SAAS,EAAE,uBADuB;WAElCiD,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,iBAAf,CAF2B;WAGlCT,MAAM,EAAG;aAAC6C,KAAK,EAAG,MAAM;eACtBlF,2BAAY,CAAC6F,gBAAb,CAA8B,KAAKtB,KAAnC,EAA0C,GAA1C,EACEpE,IADF,CACO,KAAK2F,oBAAL,CAA0BzH,IAA1B,CAA+B,IAA/B,CADP;;;UAJe,CAAlB;SAQAuH,SAAS,CAACxE,MAAV,CAAiBgE,YAAjB,CAA8B,WAA9B,EAA2C,QAA3C;SACAhD,OAAO,CAACiD,IAAR,CAAaO,SAAb;SAEA,MAAMG,UAAU,GAAG,IAAInI,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;WACnC/C,SAAS,EAAE,oBADwB;WAEnCiD,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,iBAAf,CAF4B;WAGnCT,MAAM,EAAG;aAAC6C,KAAK,EAAG,MAAM;eACtBlF,2BAAY,CAAC6F,gBAAb,CAA8B,KAAKtB,KAAnC,EAA0C,GAA1C,EACEpE,IADF,CACO,MAAM;iBACV,IAAI,KAAKqC,OAAL,EAAJ,EACA;mBACC,KAAKD,KAAL;;gBAJJ;;;UAJgB,CAAnB;SAcAwD,UAAU,CAAC3E,MAAX,CAAkBgE,YAAlB,CAA+B,WAA/B,EAA4C,SAA5C;SACAhD,OAAO,CAACiD,IAAR,CAAaU,UAAb;;;OAGD,IAAI,KAAK3F,iBAAL,EAAJ,EACA;SACC,IAAI,KAAKmE,KAAL,CAAWC,EAAX,KAAkB,KAAKD,KAAL,CAAWE,QAAjC,EACA;WACCrC,OAAO,CAACiD,IAAR,CACC,IAAIzH,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;aAChB/C,SAAS,EAAG,UAAS,KAAKwC,KAAL,CAAWmB,SAAX,MAA0B,KAAKnB,KAAL,CAAWoB,gBAAX,OAAkC,GAA5D,GAAkE,aAAlE,GAAkF,gBAAiB,EADxG;aAEhBX,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,+BAAf,CAFS;aAGhBT,MAAM,EAAG;eAAC6C,KAAK,EAAG,MAAM;iBACtB,KAAKjI,wBAAL,GAAgC,KAAhC;iBACAW,EAAE,CAACoI,QAAH,CAAYhG,YAAZ,CAAyBiG,cAAzB,CACC,KAAK1B,KAAL,CAAWE,QADZ,EAEC;mBACCpH,MAAM,EAAE,KAAKA,MADd;mBAEC6I,IAAI,EAAE,KAAK3B,KAAL,CAAW2B,IAFlB;mBAGCC,cAAc,EAAE,KAAK5B,KAAL,IAAc,KAAKA,KAAL,CAAW6B,IAAzB,GAAgC,KAAK7B,KAAL,CAAW6B,IAAX,CAAgBC,cAAhD,GAAiE;kBALnF;iBAQA,KAAK9D,KAAL;;;YAbH,CADD;;WAkBA,IAAG,KAAK3B,KAAL,CAAW,SAAX,CAAH,EACA;aACCwB,OAAO,CAACiD,IAAR,CACC,IAAIzH,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;eAChBC,IAAI,EAAE,SADU;eAEhBC,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,2BAAf,CAFS;eAGhBf,SAAS,EAAE,4BAHK;eAIhBM,MAAM,EAAG;iBAAC6C,KAAK,EAAG,MAAM;mBACtB,KAAKjI,wBAAL,GAAgC,KAAhC;mBACA,KAAKqJ,eAAL;;;cANH,CADD;;UAtBF,MAoCA;WACClE,OAAO,CAACiD,IAAR,CACC,IAAIzH,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;aAChB/C,SAAS,EAAG,wBADI;aAEhBiD,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,0BAAf;YAFR,CADD;;QAvCF,MAgDA;SACC,MAAMyD,OAAO,GAAG,IAAI3I,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;WAChC/C,SAAS,EAAG,UAAS,KAAKwC,KAAL,CAAWmB,SAAX,MAA0B,KAAKnB,KAAL,CAAWoB,gBAAX,OAAkC,GAA5D,GAAkE,aAAlE,GAAkF,gBAAiB,EADxF;WAEhCX,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,wBAAf,CAFyB;WAGhCT,MAAM,EAAG;aAAC6C,KAAK,EAAG,MAAM;eACtB,KAAKjI,wBAAL,GAAgC,KAAhC;eACAW,EAAE,CAACoI,QAAH,CAAYhG,YAAZ,CAAyBiG,cAAzB,CACC,KAAK1B,KAAL,CAAWC,EADZ,EAEC;iBACCD,KAAK,EAAE,KAAKA,KADb;iBAEC7G,eAAe,EAAE,KAAKA,eAFvB;iBAGCF,IAAI,EAAE,KAAKA,IAHZ;iBAICG,OAAO,EAAE,KAAKA,OAJf;iBAKCN,MAAM,EAAE,KAAKA,MALd;iBAMC6I,IAAI,EAAE,KAAK3B,KAAL,CAAW2B,IANlB;iBAOCC,cAAc,EAAE,KAAK5B,KAAL,IAAc,KAAKA,KAAL,CAAW6B,IAAzB,GAAgC,KAAK7B,KAAL,CAAW6B,IAAX,CAAgBC,cAAhD,GAAiE;gBATnF;eAYA,KAAK9D,KAAL;;;UAjBa,CAAhB;SAoBAgE,OAAO,CAACnF,MAAR,CAAegE,YAAf,CAA4B,WAA5B,EAAyC,YAAzC;SACAhD,OAAO,CAACiD,IAAR,CAAakB,OAAb;;;OAGD,IAAI,KAAKhC,KAAL,CAAWmB,SAAX,MAA0B,KAAKnB,KAAL,CAAWoB,gBAAX,OAAkC,GAAhE,EACA;SACC,MAAMC,SAAS,GAAG,IAAIhI,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;WAClC/C,SAAS,EAAE,oBADuB;WAElCiD,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,iBAAf,CAF2B;WAGlCT,MAAM,EAAG;aAAC6C,KAAK,EAAG,MAAM;eACtBlF,2BAAY,CAAC6F,gBAAb,CAA8B,KAAKtB,KAAnC,EAA0C,GAA1C,EACEpE,IADF,CACO,KAAK2F,oBAAL,CAA0BzH,IAA1B,CAA+B,IAA/B,CADP;;;UAJe,CAAlB;SAQAuH,SAAS,CAACxE,MAAV,CAAiBgE,YAAjB,CAA8B,WAA9B,EAA2C,QAA3C;SACAhD,OAAO,CAACiD,IAAR,CAAaO,SAAb;;;OAGD,IAAI,KAAKrB,KAAL,CAAWmB,SAAX,MAA0B,KAAKnB,KAAL,CAAWoB,gBAAX,OAAkC,GAAhE,EACA;SACC,MAAMI,UAAU,GAAG,IAAInI,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;WACnC/C,SAAS,EAAE,oBADwB;WAEnCiD,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,iBAAf,CAF4B;WAGnCT,MAAM,EAAG;aAAC6C,KAAK,EAAG,MAAM;eACtBlF,2BAAY,CAAC6F,gBAAb,CAA8B,KAAKtB,KAAnC,EAA0C,GAA1C,EACEpE,IADF,CACO,MAAM;iBACV,IAAI,KAAKqC,OAAL,EAAJ,EACA;mBACC,KAAKD,KAAL;;gBAJJ;;;UAJgB,CAAnB;SAcAwD,UAAU,CAAC3E,MAAX,CAAkBgE,YAAlB,CAA+B,WAA/B,EAA4C,SAA5C;SACAhD,OAAO,CAACiD,IAAR,CAAaU,UAAb;;;OAGD,IAAI,CAAC,KAAKd,UAAL,EAAD,IAAsB,KAAKrE,KAAL,CAAW,MAAX,CAAtB,IAA4C,KAAKpD,IAAL,KAAc,UAA9D,EACA;SACC4E,OAAO,CAACiD,IAAR,CACC,IAAIzH,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;WAChBE,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,wBAAf,CADS;WAEhBf,SAAS,EAAE,oBAFK;WAGhBM,MAAM,EAAG;aAAC6C,KAAK,EAAG,KAAKO,iBAAL,CAAuBpH,IAAvB,CAA4B,IAA5B;;UAHnB,CADD;;;OASD,IACC,CAAC,KAAK4G,UAAL,EAAD,IACG,KAAKrE,KAAL,CAAW,QAAX,CADH,IAEG,CAAC,KAAKR,iBAAL,EAHL,EAKA;SACC,IACC,CAAC,KAAKmE,KAAL,CAAWmB,SAAX,EAAD,IACG,CAAC,KAAKnB,KAAL,CAAWoB,gBAAX,EADJ,IAEG,KAAKpB,KAAL,CAAWoB,gBAAX,OAAkC,GAFrC,IAGG,KAAKpB,KAAL,CAAW6B,IAAX,CAAgB,YAAhB,MAAkC,KAAK7B,KAAL,CAAW6B,IAAX,CAAgB,cAAhB,CAJtC,EAMA;WACChE,OAAO,CAACiD,IAAR,CACC,IAAIzH,EAAE,CAACiH,EAAH,CAAMC,MAAV,CAAiB;aAChBE,IAAI,EAAGnC,aAAG,CAACC,UAAJ,CAAe,0BAAf,CADS;aAEhBf,SAAS,EAAE,oBAFK;aAGhBM,MAAM,EAAG;eAAC6C,KAAK,EAAG,MAAM;iBACtBhJ,6BAAY,CAACsK,aAAb,CAA2B,gCAA3B,EAA6D,MAAM;mBAClE,KAAKvJ,wBAAL,GAAgC,KAAhC;mBACA,KAAKsF,KAAL;kBAFD;iBAKAvC,2BAAY,CAACyG,WAAb,CAAyB,KAAKlC,KAA9B;;iBAEA,IAAI,CAAC,KAAKA,KAAL,CAAWmC,gBAAX,EAAL,EACA;mBACC,KAAKnE,KAAL;;;;YAbJ,CADD;;;;;KAuBH,IAAIH,OAAO,CAAC3B,MAAR,GAAiB,CAArB,EACA;OACC2B,OAAO,CAAC,CAAD,CAAP,CAAWhB,MAAX,CAAkBW,SAAlB,GAA8B,4BAA9B;;;KAGD,OAAOK,OAAP;;;GAGDuE,WAAW,GACX;KACC,IAAI,KAAKvH,KAAT,EACA;OACC,KAAKA,KAAL,CAAWgD,OAAX,CAAmBwE,OAAnB,CAA4BxF,MAAD,IAAY;SAAA;;SACtC,IAAI,CAAAA,MAAM,QAAN,+BAAAA,MAAM,CAAEhF,OAAR,qCAAiB2I,IAAjB,MAA0B,MAA9B,EACA;WACC3D,MAAM,CAACyF,WAAP,CAAmB,IAAnB;UAFD,MAKA;WACCzF,MAAM,CAAC0F,WAAP,CAAmB,IAAnB;;QAPF;;;;GAaFC,aAAa,GACb;KACC,IAAI,KAAK3H,KAAT,EACA;OACC,KAAKA,KAAL,CAAWgD,OAAX,CAAmBwE,OAAnB,CAA4BxF,MAAD,IAAY;SACtCA,MAAM,CAACyF,WAAP,CAAmB,KAAnB;SACAzF,MAAM,CAAC0F,WAAP,CAAmB,KAAnB;QAFD;;;;GAOFhB,oBAAoB,GACpB;KACC,KAAK7C,IAAL,CAAU,WAAV;KACA,KAAK7D,KAAL,CAAWmG,UAAX,CAAsB,KAAKpE,UAAL,EAAtB;;KACA,IAAI,KAAKZ,mBAAT,EACA;OACC,KAAKA,mBAAL,CAAyByG,gBAAzB,CAA0C,KAAKzC,KAAL,CAAW0C,YAAX,EAA1C;;;;GAIFC,UAAU,GACV;KACC,IAAIC,cAAI,CAACC,SAAL,CAAe,KAAKxK,GAAL,CAASyK,MAAxB,CAAJ,EACA;OACC9H,aAAG,CAAC+H,MAAJ,CAAW,KAAK1K,GAAL,CAASyK,MAApB;OACA,KAAKzK,GAAL,CAASyK,MAAT,GAAkB,IAAlB;;;;GAIFE,cAAc,CAAC3I,MAAM,GAAG,EAAV,EACd;KACC,OAAO,KAAKH,IAAL,CAAUxC,gBAAgB,CAAC0C,SAA3B,EAAsCC,MAAtC,CAAP;;;GAGD4I,cAAc,CAAC5I,MAAM,GAAG,EAAV,EACd;KACC,OAAO,KAAKH,IAAL,CAAUxC,gBAAgB,CAACyE,SAA3B,EAAsC9B,MAAtC,CAAP;;;GAGDE,OAAO,CAACJ,IAAD,EACP;KACC,IAAIA,IAAI,KAAK,MAAT,IAAmBA,IAAI,KAAK,MAAhC,EACA;OACC,KAAKA,IAAL,GAAYA,IAAZ;;;;GAIFqB,OAAO,GACP;KACC,OAAO,KAAKrB,IAAZ;;;GAGDT,eAAe,GACf;KACC,IACC,CAAC,KAAKgH,UAAL,EAAD,IACG,KAAKlF,OAAL,OAAmB9D,gBAAgB,CAACyE,SADvC,IAEG,KAAKiC,eAAL,EAHJ,EAKA;OACC,KAAK7D,OAAL,CAAa7C,gBAAgB,CAAC0C,SAA9B;OACA,KAAKS,KAAL,CAAWmG,UAAX,CAAsB,KAAKpE,UAAL,EAAtB;MAPD,MASK,IACJ,CAAC,KAAK8D,UAAL,EAAD,IACG,KAAKlF,OAAL,OAAmB9D,gBAAgB,CAAC0C,SADvC,IAEG,CAAC,KAAKgE,eAAL,EAHA,EAKL;OACC,KAAK7D,OAAL,CAAa7C,gBAAgB,CAACyE,SAA9B;OACA,KAAKtB,KAAL,CAAWmG,UAAX,CAAsB,KAAKpE,UAAL,EAAtB;;;KAED,KAAKsG,YAAL;;;GAGDC,iBAAiB,CAACC,KAAD,EACjB;KACC,IAAIA,KAAK,IAAIA,KAAK,YAAYC,0BAA9B,EACA;OACC,MAAMxB,IAAI,GAAGuB,KAAK,CAACE,OAAN,EAAb;OACA,MAAMC,UAAU,GAAG1B,IAAI,CAAC0B,UAAxB;OAEA,IAAIC,gBAAgB,GAAG5E,0BAAQ,CAAC6E,kBAAT,MAAiC,CAAxD;;OAEA,IAAI,KAAKC,gBAAL,CAAsBC,KAAtB,CAA4B1K,IAA5B,KAAqC2K,SAAzC,EACA;SACC,IAAIJ,gBAAJ,EACA;WACCA,gBAAgB,GAAG,CAAnB;WACA5E,0BAAQ,CAACC,kBAAT,CAA4B,CAA5B;;;;OAIF,IAAI2E,gBAAgB,GAAGD,UAAnB,IAAiCC,gBAAgB,KAAK,CAA1D,EACA;SACC,KAAKE,gBAAL,CAAsBG,gBAAtB;QAFD,MAKA;SACC,KAAKH,gBAAL,CAAsBI,mBAAtB;;;;;GAKHC,kBAAkB,CAACC,QAAQ,GAAG,EAAZ,EAClB;KACC,MAAMhE,KAAK,GAAG,KAAKA,KAAnB;KACA,IAAIiE,MAAM,GAAG,EAAb,CAFD;;KAKC,IAAI,CAACD,QAAQ,CAACE,QAAT,CAAkB,MAAlB,CAAD,IAA8BlE,KAAK,CAACQ,IAAN,KAAe,KAAKnI,GAAL,CAASiE,UAAT,CAAoBqH,KAArE,EACA;OACCM,MAAM,CAACnD,IAAP,CAAY,MAAZ;MAPF;;;KAWC,IACC,CAACkD,QAAQ,CAACE,QAAT,CAAkB,UAAlB,CAAD,IAEA,KAAKR,gBAAL,CAAsBS,eAAtB,CAAsCvF,0BAAQ,CAACwF,gBAAT,CAA0BpE,KAAK,CAACqE,WAAN,EAA1B,CAAtC,MAEA,KAAKX,gBAAL,CAAsBS,eAAtB,CAAsCvF,0BAAQ,CAACwF,gBAAT,CAA0B,KAAKV,gBAAL,CAAsBY,YAAtB,EAA1B,CAAtC,CALD,EAOA;OACCL,MAAM,CAACnD,IAAP,CAAY,UAAZ;MAnBF;;;KAuBC,MAAMyD,QAAQ,GAAG,KAAKC,eAAL,CAAqBC,QAArB,EAAjB;;KACA,IACC,CAACT,QAAQ,CAACE,QAAT,CAAkB,WAAlB,CAAD,KAEClE,KAAK,CAAC0E,SAAN,OAAsBH,QAAQ,CAACI,OAA/B,IACGJ,QAAQ,CAAC5C,IAAT,CAAciD,QAAd,OAA6B5E,KAAK,CAAC2B,IAAN,CAAWiD,QAAX,EADhC,IAEGL,QAAQ,CAACM,EAAT,CAAYD,QAAZ,OAA2B5E,KAAK,CAAC6E,EAAN,CAASD,QAAT,EAJ/B,CADD,EAQA;OACCX,MAAM,CAACnD,IAAP,CAAY,WAAZ;MAjCF;;;KAqCC,IACC,CAACkD,QAAQ,CAACE,QAAT,CAAkB,QAAlB,CAAD,IACG,CAAC,CAAClE,KAAK,CAACmB,SAAN,EAAD,IAAsBnB,KAAK,CAAC8E,gBAAN,EAAvB,MAAqD,KAAK9I,mBAAL,CAAyB+I,cAAzB,EAFzD,EAIA;OACCd,MAAM,CAACnD,IAAP,CAAY,QAAZ;MA1CF;;;KA8CC,IAAI,CAACkD,QAAQ,CAACE,QAAT,CAAkB,SAAlB,CAAD,IAAiCc,QAAQ,CAAChF,KAAK,CAACiF,SAAP,CAAR,KAA8BD,QAAQ,CAAC,KAAKE,YAAN,CAA3E,EACA;OACCjB,MAAM,CAACnD,IAAP,CAAY,SAAZ;MAhDF;;;KAoDC,IACC,CAACkD,QAAQ,CAACE,QAAT,CAAkB,OAAlB,CAAD,IAEA,KAAKlI,mBAAL,CAAyBmJ,aAAzB,GAAyCC,GAAzC,CAA8CC,IAAD,IAAQ;OAAC,OAAOA,IAAI,CAACC,QAAL,GAAgB,GAAhB,GAAsBD,IAAI,CAACpF,EAAlC;MAAtD,EAA6FsF,IAA7F,CAAkG,GAAlG,MAEAvF,KAAK,CAACwF,sBAAN,GAA+BJ,GAA/B,CAAoCC,IAAD,IAAQ;OAAC,OAAOA,IAAI,CAACC,QAAL,GAAgB,GAAhB,GAAsBD,IAAI,CAACpF,EAAlC;MAA5C,EAAmFsF,IAAnF,CAAwF,GAAxF,CALD,EAOA;OACCtB,MAAM,CAACnD,IAAP,CAAY,OAAZ;;;KAGD,OAAOmD,MAAP;;;GAGD7F,eAAe,GACf;KACC,OAAO,KAAK2F,kBAAL,GAA0B7H,MAA1B,GAAmC,CAA1C;;;GAGD5B,SAAS,CAACD,MAAM,GAAG,EAAV,EACT;KACC,KAAKvB,MAAL,GAAcuB,MAAM,CAACvB,MAAP,IAAiBC,kBAAI,CAACC,gBAAL,EAA/B;KACA,KAAKC,IAAL,GAAYoB,MAAM,CAACpB,IAAP,IAAe,MAA3B;KACA,KAAKC,kBAAL,GAA0BmB,MAAM,CAACnB,kBAAP,IAA6B,KAAvD;KACA,KAAKuM,cAAL,GAAsBpL,MAAM,CAACoL,cAAP,IAAyB,KAA/C;KACA,KAAKC,oBAAL,GAA4BrL,MAAM,CAACqL,oBAAP,IAA+B,KAA3D;KACA,KAAKvM,eAAL,GAAuBkB,MAAM,CAAClB,eAAP,IAA0B,IAAjD;KACA,KAAKC,OAAL,GAAeiB,MAAM,CAACjB,OAAP,GAAiBiB,MAAM,CAACjB,OAAxB,GAAkC,CAAjD;;KACA,IAAI,KAAKH,IAAL,KAAc,MAAd,IAAwB,CAAC,KAAKG,OAAlC,EACA;OACC,KAAKA,OAAL,GAAe,KAAKN,MAApB;;;KAED,KAAKkH,KAAL,GAAavE,2BAAY,CAACkK,gBAAb,CAA8BtL,MAAM,CAAC2F,KAArC,EAA4C3F,MAAM,CAACuL,SAAnD,EAA8D;OAAC3M,IAAI,EAAE,KAAKA,IAAZ;OAAkBG,OAAO,EAAE,KAAKA;MAA9F,CAAb;KACA,KAAK8L,YAAL,GAAoB,IAApB;;KAEA,IACC,CAAC,KAAKlF,KAAL,CAAWC,EAAZ,IACG2C,cAAI,CAACiD,aAAL,CAAmBxL,MAAM,CAACyL,SAA1B,CADH,IAEGlD,cAAI,CAACmD,MAAL,CAAY1L,MAAM,CAACyL,SAAP,CAAiBnE,IAA7B,CAFH,IAGGiB,cAAI,CAACmD,MAAL,CAAY1L,MAAM,CAACyL,SAAP,CAAiBjB,EAA7B,CAJJ,EAMA;OACC,KAAK7E,KAAL,CAAWgG,gBAAX,CAA4B3L,MAAM,CAACyL,SAAnC;;;KAGD,IAAIlD,cAAI,CAACiD,aAAL,CAAmBxL,MAAM,CAACjC,YAA1B,CAAJ,EACA;OACC,KAAKA,YAAL,GAAoBiC,MAAM,CAACjC,YAA3B;;;KAGD,KAAK6N,sBAAL,GAA8B,CAAC,CAAC5L,MAAM,CAAC4L,sBAAvC;KACA,KAAKC,YAAL,GAAoBtD,cAAI,CAACuD,OAAL,CAAa9L,MAAM,CAAC6L,YAApB,IACjB7L,MAAM,CAAC6L,YAAP,CAAoBE,MAApB,CAA2BC,YAAY,IAAI;OAAC,OAAOA,YAAY,CAACC,IAAb,CAAkBC,SAAzB;MAA5C,CADiB,GAEjB,EAFH;KAIA,KAAKC,YAAL,GAAoBnM,MAAM,CAACmM,YAAP,IAAuB,IAA3C;KACA,KAAKC,qBAAL,GAA6BpM,MAAM,CAACoM,qBAAP,IAAgC,EAA7D;KAEA,KAAKC,qBAAL,GAA6B,CAAC,CAACrM,MAAM,CAACqM,qBAAtC;KAEA,KAAKC,WAAL,CAAiBtM,MAAM,CAAC9B,QAAxB,EAAkC8B,MAAM,CAACuM,gBAAzC;;;GAGDD,WAAW,CAACpO,QAAD,EAAWE,iBAAiB,GAAG,EAA/B,EACX;KACC,KAAKF,QAAL,GAAgBA,QAAhB;KACA,KAAKC,YAAL,GAAoB,EAApB;KACA,KAAKC,iBAAL,GAAyBA,iBAAiB,IAAI,EAA9C;;KAEA,IAAImK,cAAI,CAACuD,OAAL,CAAa,KAAK5N,QAAlB,CAAJ,EACA;OACC,KAAKA,QAAL,CAAc8J,OAAd,CAAsB,CAACsB,KAAD,EAAQkD,GAAR,KAAgB;SACrC,MAAM5G,EAAE,GAAG+E,QAAQ,CAACrB,KAAK,CAACmD,EAAN,IAAYnD,KAAK,CAAC1D,EAAnB,CAAnB;;SACA,IAAIA,EAAE,GAAG,CAAT,EACA;WACC,KAAKzH,YAAL,CAAkByH,EAAlB,IAAwB4G,GAAxB;;QAJF,EAMG,IANH;;;KASD,MAAME,OAAO,GAAG,KAAKC,iBAAL,EAAhB;;KACA,IAAI,KAAKhH,KAAL,CAAWC,EAAf,EACA;OACC,KAAKgH,uBAAL,CAA6B,KAAK1O,QAAlC,EAA4CwO,OAA5C;;;;GAIFpL,WAAW,CAACtB,MAAM,GAAG,EAAV,EACX;KACC,OAAO,IAAI6M,OAAJ,CAAaC,OAAD,IAAa;OAC/B,MAAMJ,OAAO,GAAG,KAAKC,iBAAL,EAAhB;;OACA,IAAID,OAAO,IAAIA,OAAO,CAAC1K,KAAvB,EACA;SACC8K,OAAO;QAFR,MAKA;SACC,KAAK9N,EAAL,CAAQ+N,IAAR,CAAaC,SAAb,CAAuB,8CAAvB,EAAuE;WACtExF,IAAI,EAAE;aACLyF,OAAO,EAAE,KAAKtH,KAAL,CAAWC,EADf;aAELsH,aAAa,EAAE,KAAKvH,KAAL,CAAWiF;;UAH5B,EAKGrJ,IALH,CAKS4L,QAAD,IAAc;WACrB,IAAIA,QAAQ,IAAIA,QAAQ,CAAC3F,IAArB,IAA6B2F,QAAQ,CAAC3F,IAAT,CAAckF,OAA/C,EACA;;aAEC,KAAKxO,QAAL,CAAcuI,IAAd,CAAmB,IAAI2G,MAAM,CAACC,eAAP,CAAuBC,OAA3B,CAAmC5O,kBAAI,CAAC6O,kBAAL,EAAnC,EAA8DJ,QAAQ,CAAC3F,IAAT,CAAckF,OAA5E,CAAnB;aACA,KAAKJ,WAAL,CAAiB,KAAKpO,QAAtB;aACA4O,OAAO;;UAXT;;MARK,CAAP;;;GA0BD/H,eAAe,GACf;KACC,KAAK/G,GAAL,CAASiE,UAAT,GAAsB2C,aAAG,CAACC,MAA1B,gBAAiC;;;mBAAjC,CAGiD;;;GAHjD,GAGiBZ,aAAG,CAACC,UAAJ,CAAe,eAAf,CAHjB;KAQAjD,eAAK,CAACxB,IAAN,CAAW,KAAKzB,GAAL,CAASiE,UAApB,EAAgC,OAAhC,EAAyC,KAAK/C,uBAA9C;KACA+B,eAAK,CAACxB,IAAN,CAAW,KAAKzB,GAAL,CAASiE,UAApB,EAAgC,QAAhC,EAA0C,KAAK/C,uBAA/C;KAEA,OAAO,KAAKlB,GAAL,CAASiE,UAAhB;;;GAGDwD,uBAAuB,GACvB;KACC,KAAKzH,GAAL,CAASiE,UAAT,GAAsB2C,aAAG,CAACC,MAA1B,gBAAiC;;;mBAAjC,CAGiD;;;;GAHjD,GAGiBZ,aAAG,CAACC,UAAJ,CAAe,eAAf,CAHjB;KASA,OAAO,KAAKlG,GAAL,CAASiE,UAAhB;;;GAGD8D,cAAc,GACd;KACC,MAAMtH,MAAM,GAAG,KAAKkH,KAAL,CAAW6B,IAAX,CAAgBgG,UAA/B;KACA,MAAMC,OAAO,GAAGpQ,gBAAgB,CAACqQ,QAAjB,CAA0BC,OAA1B,CAAkC,WAAlC,EAA+ClP,MAA/C,CAAhB;KACA,MAAMmP,UAAU,GAAG,KAAK5O,EAAL,CAAQoI,QAAR,CAAiBhG,YAAjB,CAA8BmK,SAA9B,CAAwC9M,MAAxC,IAChB,KAAKO,EAAL,CAAQoI,QAAR,CAAiBhG,YAAjB,CAA8BmK,SAA9B,CAAwC9M,MAAxC,EAAgDoP,MADhC,GAEhB,EAFH;KAKA,KAAK7P,GAAL,CAAS8P,OAAT,GAAmBlJ,aAAG,CAACC,MAAvB,gBAA8B;;;;QAA9B,CAIuC;;;iBAJvC,CAOuB;kEAPvB,CAQ2E;;;;iBAR3E,CAYuB,mGAZvB,CAYmK;;;;GAZnK,GAIMZ,aAAG,CAACC,UAAJ,CAAe,SAAf,IAA4B,IAJlC,EAOeuJ,OAPf,EAQgEG,UARhE,EAYeH,OAZf,EAYyHzO,EAAE,CAAC+O,IAAH,CAAQC,gBAAR,CAAyB,KAAKrI,KAAL,CAAWQ,IAApC,CAZzH;KAiBA,OAAO,KAAKnI,GAAL,CAAS8P,OAAhB;;;GAGD9I,eAAe,GACf;KACC,KAAKhH,GAAL,CAASiQ,WAAT,GAAuBrJ,aAAG,CAACC,MAA3B,kBAAkC,8EAAlC;KACA,KAAKqJ,aAAL,GAAqB,IAAIC,+BAAJ,CAAkB;OACtCxJ,IAAI,EAAE,KAAK3G,GAAL,CAASiQ,WADuB;OAEtCnO,IAAI,EAAE;MAFc,CAArB;KAKA,KAAKoO,aAAL,CAAmBE,SAAnB,CAA6B,UAA7B,EAA0CrF,KAAD,IAAW;OACnD,IAAIA,KAAK,YAAYC,0BAArB,EACA;SACC,MAAMqF,KAAK,GAAGtF,KAAK,CAACE,OAAN,GAAgBK,KAA9B;;SACA,IACC,CAAC,KAAKjD,UAAL,EAAD,KACI,KAAKrE,KAAL,CAAW,MAAX,KAAsB,KAAK2D,KAAL,CAAWoB,gBAAX,OAAkC,KAD5D,CADD,EAIA;WACC,KAAK/H,EAAL,CAAQ+N,IAAR,CAAaC,SAAb,CAAuB,uCAAvB,EAAgE;aAC/DxF,IAAI,EAAE;eACLyF,OAAO,EAAE,KAAKtH,KAAL,CAAWC,EADf;eAELnH,MAAM,EAAE,KAAKA,MAFR;eAGL4P,KAAK,EAAEA;;YAJT;WAOA,KAAK1I,KAAL,CAAW6B,IAAX,CAAgB8G,KAAhB,GAAwBD,KAAxB;WAEA,KAAKhK,IAAL,CAAU,WAAV;WACA,KAAKwE,YAAL;;;MAnBH;KAyBA,OAAO,KAAK7K,GAAL,CAASiQ,WAAhB;;;GAGDvI,4BAA4B,GAC5B;KACC,KAAK1H,GAAL,CAASiQ,WAAT,GAAuBrJ,aAAG,CAACC,MAA3B,kBAAkC,4GAAlC;KACA,KAAKqJ,aAAL,GAAqB,IAAIC,+BAAJ,CAAkB;OACtCxJ,IAAI,EAAE,KAAK3G,GAAL,CAASiQ,WADuB;OAEtCnO,IAAI,EAAE;MAFc,CAArB;KAIA,OAAO,KAAK9B,GAAL,CAASiQ,WAAhB;;;GAGDhJ,iBAAiB,CAACnF,IAAD,EACjB;KACC,KAAK9B,GAAL,CAASuQ,iBAAT,GAA6B3J,aAAG,CAACC,MAAjC,kBAAwC,oDAAxC;KACA,KAAK2J,eAAL,GAAuB,IAAIC,iCAAJ,CAAoB;OAC1CC,SAAS,EAAE,KAAK1Q,GAAL,CAASuQ,iBADsB;OAE1CI,mBAAmB,EAAE,KAAK/P,IAFgB;OAG1CgQ,cAAc,EAAE,KAAK7P,OAHqB;OAI1C8P,WAAW,EAAE,KAAK3Q,QAJwB;OAK1C4Q,gBAAgB,EAAEC,sCAAc,CAACC,mBAAf,CAAmC;SACpDpQ,IAAI,EAAE,KAAKA,IADyC;SAEpDG,OAAO,EAAE,KAAKA,OAFsC;SAGpDN,MAAM,EAAE,KAAKA,MAHuC;SAIpDL,iBAAiB,EAAE,KAAKA;QAJP,CALwB;OAW1C0B,IAAI,EAAEA,IAXoC;OAY1CjC,MAAM,EAAE,KAAKA,MAZ6B;OAa1C8O,iBAAiB,EAAE,MAAM;SACxB,MAAMD,OAAO,GAAG,KAAKC,iBAAL,EAAhB;;SACA,IAAID,OAAJ,EACA;WACC,OAAO;aACN9G,EAAE,EAAE8G,OAAO,CAAC9G,EADN;aAENO,IAAI,EAAEuG,OAAO,CAACvG,IAFR;aAGNkI,KAAK,EAAE3B,OAAO,CAAC2B;YAHhB;;;SAMD,OAAO,KAAP;QAvByC;OAyB1CY,cAAc,EAAGpE,YAAD,IAAkB;SACjC,IAAIA,YAAJ,EACA;WACC,IAAI,KAAKqD,aAAT,EACA;aACC,KAAKA,aAAL,CAAmBgB,QAAnB,CAA4BrE,YAAY,CAACwD,KAAzC;;;WAED,KAAKxD,YAAL,GAAoBA,YAAY,CAACjF,EAAjC;WACA,KAAK1G,uBAAL;WAEA6P,sCAAc,CAACI,oBAAf,CAAoC,KAAKtE,YAAzC;;;MAnCoB,CAAvB;KAwCA,OAAO,KAAK7M,GAAL,CAASuQ,iBAAhB;;;GAGDrJ,kBAAkB,GAClB;KACC,KAAKlH,GAAL,CAASoR,YAAT,GAAwBxK,aAAG,CAACC,MAA5B,kBAAmC,gFAAnC;KAEA,KAAKsF,eAAL,GAAuB,IAAIkF,iCAAJ,CAAoB,IAApB,EAA0B;OAChDC,YAAY,EAAE,KADkC;OAEhDZ,SAAS,EAAE,KAAK1Q,GAAL,CAASoR,YAF4B;OAGhDG,cAAc,EAAE;MAHM,CAAvB;KAMA,KAAKpF,eAAL,CAAqBiE,SAArB,CAA+B,UAA/B,EAA4CrF,KAAD,IAAW;OACrD,IAAIA,KAAK,YAAYC,0BAArB,EACA;SACC,IAAIM,KAAK,GAAGP,KAAK,CAACE,OAAN,GAAgBK,KAA5B;;SACA,IAAI,KAAKkG,gBAAT,EACA;WACC,KAAKA,gBAAL,CAAsBC,cAAtB,CAAqCnG,KAAK,CAACgB,OAA3C;;WAEA,IAAI,KAAKjE,UAAL,MAAqB,CAAC,KAAKmJ,gBAAL,CAAsBE,gBAAtB,EAA1B,EACA;aACC,MAAMC,gBAAgB,GAAGvO,2BAAY,CAACwO,oBAAb,CACxBtG,KAAK,CAACgB,OAAN,GAAgB,SAAhB,GAA4B,UADJ,CAAzB;aAIA,KAAKkF,gBAAL,CAAsBN,QAAtB,CAA+BS,gBAA/B,EAAiD,KAAjD;;;;SAIF,IAAI,KAAKhO,mBAAT,EACA;WACC,IAAI,CAAC,KAAKA,mBAAL,CAAyBc,kBAAzB,EAAL,EACA;aACC,KAAKd,mBAAL,CAAyBI,WAAzB;;;WAED,KAAKJ,mBAAL,CAAyBkO,gBAAzB,CAA0C,KAAKxG,gBAAL,CAAsBY,YAAtB,EAA1C;WACA,KAAKtI,mBAAL,CAAyBmO,WAAzB,CAAqCxG,KAArC,EAA4C,IAA5C;WACA,KAAK3H,mBAAL,CAAyBoO,2BAAzB;;;SAGD,IAAI,KAAK1G,gBAAT,EACA;WACC,KAAKA,gBAAL,CAAsB2G,0BAAtB,CACC;aACC1I,IAAI,EAAEyB,KAAK,CAACE,OAAN,GAAgBK,KAAhB,CAAsBhC,IAD7B;aAECkD,EAAE,EAAEzB,KAAK,CAACE,OAAN,GAAgBK,KAAhB,CAAsBkB,EAF3B;aAGCF,OAAO,EAAEvB,KAAK,CAACE,OAAN,GAAgBK,KAAhB,CAAsBgB,OAHhC;aAIC2F,cAAc,EAAE,KAAKtK,KAAL,CAAWC;YAL7B;;;SAUD,KAAK1G,uBAAL;;MAzCF;KA6CA,OAAO,KAAKlB,GAAL,CAASoR,YAAhB;;;GAGDjK,sBAAsB,GACtB;KACC,KAAKnH,GAAL,CAASkS,4BAAT,GAAwCtL,aAAG,CAACC,MAA5C,kBAAmD;;MAAnD,CAUU;;MAVV,CAeU;;;;MAfV,CAqBU;;KArBV,CA8BS;QA9BT,GAEI,KAAK7G,GAAL,CAASmS,gBAAT,GAA4BvL,aAAG,CAACC,MAAhC,kBAAuC;;;;;4CAAvC,CAK0E;mDAL1E,CAMoF;;WANpF,GAKsCZ,aAAG,CAACC,UAAJ,CAAe,mBAAf,CALtC,EAM6CD,aAAG,CAACC,UAAJ,CAAe,sBAAf,CAN7C,CAFJ,EAYI,KAAKlG,GAAL,CAASoS,UAAT,GAAsBxL,aAAG,CAACC,MAA1B,kBAAiC;;0DAAjC,CAEuF;WAFvF,GAEoDZ,aAAG,CAACC,UAAJ,CAAe,kBAAf,CAFpD,CAZJ,EAmBI,KAAKlG,GAAL,CAASqS,gBAAT,GAA4BzL,aAAG,CAACC,MAAhC,kBAAuC;;WAAvC,EAnBJ,EAuBG,KAAK7G,GAAL,CAASsS,cAAT,GAA0B1L,aAAG,CAACC,MAA9B,kBAAqC;;;;+CAArC,CAIgF;6DAJhF,CAKmG;;UALnG,GAI0CZ,aAAG,CAACC,UAAJ,CAAe,qBAAf,CAJ1C,EAKwDD,aAAG,CAACC,UAAJ,CAAe,0BAAf,CALxD,CAvBH;KAiCA,KAAKvC,mBAAL,GAA2B,IAAI4O,qCAAJ,CAAwB;OAClD7B,SAAS,EAAE,KAAK1Q,GAAL,CAASkS,4BAD8B;OAElDvL,IAAI,EAAE,KAAK3G,GAAL,CAASmS,gBAFmC;OAGlDC,UAAU,EAAE,KAAKpS,GAAL,CAASoS,UAH6B;OAIlDC,gBAAgB,EAAE,KAAKrS,GAAL,CAASqS,gBAJuB;OAKlDC,cAAc,EAAE,KAAKtS,GAAL,CAASsS,cALyB;OAMlDE,YAAY,EAAE,KANoC;OAOlD/R,MAAM,EAAE,KAAKA,MAPqC;OAQlDG,IAAI,EAAE,KAAKA,IARuC;OASlDG,OAAO,EAAE,KAAKA,OAToC;OAUlDlB,MAAM,EAAE,KAAKA,MAAL,GAAc,EAV4B;OAWlDwO,qBAAqB,EAAE,KAAKA,qBAXsB;OAYlDhB,oBAAoB,EAAE,KAAKA;MAZD,CAA3B;KAeA,KAAK1J,mBAAL,CAAyByM,SAAzB,CAAmC,cAAnC,EAAmD,KAAKqC,4BAAL,CAAkChR,IAAlC,CAAuC,IAAvC,CAAnD;KACA,KAAKkC,mBAAL,CAAyByM,SAAzB,CAAmC,gBAAnC,EAAqD,KAAKlP,uBAA1D;KACA,KAAKyC,mBAAL,CAAyByM,SAAzB,CAAmC,mBAAnC,EAAwD,KAAKlP,uBAA7D;KAEA,OAAO,KAAKlB,GAAL,CAASkS,4BAAhB;;;GAGD7K,kBAAkB,GAClB;KACC,KAAKrH,GAAL,CAAS0S,YAAT,GAAwB9L,aAAG,CAACC,MAA5B,kBAAmC,0CAAnC;KACA,KAAK7G,GAAL,CAAS2S,iBAAT,GAA6B/L,aAAG,CAACC,MAAjC,kBAAwC;sEAAxC,CACwG;KADxG,CAEyB;SAFzB,GACoEZ,aAAG,CAACC,UAAJ,CAAe,mBAAf,CADpE,EAEG,KAAKlG,GAAL,CAAS0S,YAFZ;KAKA,KAAKrH,gBAAL,GAAwB,IAAI9E,0BAAJ,CACvB;OACCI,IAAI,EAAE,KAAK3G,GAAL,CAAS0S,YADhB;OAECE,mBAAmB,EAAE,KAAKhF,sBAF3B;OAGCC,YAAY,EAAE,KAAKA,YAAL,IAAqB,EAHpC;OAICM,YAAY,EAAE,KAAKA,YAAL,IAAqB,IAJpC;OAKCf,cAAc,EAAE,KAAKA,cAAL,IAAuB,KALxC;OAMCgB,qBAAqB,EAAE,KAAKA,qBAAL,IAA8B,EANtD;OAOCyE,qBAAqB,EAAE,CAAC,KAAKhS,kBAP9B;OAQCiS,gBAAgB,EAAE,MAAM;SACvB,IAAI,KAAKnP,mBAAT,EACA;WACC,KAAKA,mBAAL,CAAyBkO,gBAAzB,CAA0C,KAAKxG,gBAAL,CAAsBY,YAAtB,EAA1C;;WACA,IAAI,KAAKZ,gBAAL,CAAsBe,QAAtB,GAAiCxL,IAAjC,KAA0C2K,SAA1C,IACA,CAAC,KAAK5H,mBAAL,CAAyBc,kBAAzB,EADL,EAEA;aACC,KAAKd,mBAAL,CAAyBI,WAAzB;;;WAED,KAAKJ,mBAAL,CAAyBoO,2BAAzB;;;SAED,KAAK7Q,uBAAL;;MApBqB,CAAxB;;KAyBA,IAAI,KAAKyC,mBAAT,EACA;OACC,KAAKA,mBAAL,CAAyByM,SAAzB,CAAmC,oBAAnC,EAAyD,KAAKtF,iBAAL,CAAuBrJ,IAAvB,CAA4B,IAA5B,CAAzD;;;KAGD,OAAO,KAAKzB,GAAL,CAAS2S,iBAAhB;;;GAGDpL,sBAAsB,GACtB;KACC,KAAKwL,cAAL,GAAsB,EAAtB;KACA,KAAK/S,GAAL,CAASgT,aAAT,GAAyBpM,aAAG,CAACC,MAA7B,kBAAoC,mCAApC;KACA,KAAK2K,gBAAL,GAAwB,IAAIyB,0BAAJ,CAAa;OACpCtM,IAAI,EAAE,KAAK3G,GAAL,CAASgT,aADqB;OAEpCnT,MAAM,EAAE,KAAKA;MAFU,CAAxB;KAKA,KAAK2R,gBAAL,CAAsBpB,SAAtB,CAAgC,UAAhC,EAA6CrF,KAAD,IAAW;OACtD,IAAIA,KAAK,YAAYC,0BAArB,EACA;SACC,KAAK+H,cAAL,GAAsBhI,KAAK,CAACE,OAAN,GAAgBiI,MAAtC;;SACA,IAAI,CAAC,KAAK7K,UAAL,EAAD,KACC,KAAKrE,KAAL,CAAW,MAAX,KACA,KAAK2D,KAAL,CAAWoB,gBAAX,OAAkC,KAFnC,CAAJ,EAGA;WACC,KAAK/H,EAAL,CAAQ+N,IAAR,CAAaC,SAAb,CAAuB,2CAAvB,EAAoE;aACnExF,IAAI,EAAE;eACLyF,OAAO,EAAE,KAAKtH,KAAL,CAAWC,EADf;eAELnH,MAAM,EAAE,KAAKA,MAFR;eAGL0S,SAAS,EAAE,KAAKJ;;YAJlB,EAMGxP,IANH,CAMS4L,QAAD,IAAc;aACrB,KAAKxH,KAAL,CAAW6B,IAAX,CAAgB4J,MAAhB,GAAyBjE,QAAQ,CAAC3F,IAAT,CAAc4J,MAAvC;YAPD;;;MARH;KAqBA,OAAO,KAAKpT,GAAL,CAASgT,aAAhB;;;GAGD5L,kBAAkB,GAClB;KACC,KAAKpH,GAAL,CAASqT,aAAT,GAAyBzM,aAAG,CAACC,MAA7B,kBAAoC,0CAApC;KACA,KAAK7G,GAAL,CAASsT,YAAT,GAAwB1M,aAAG,CAACC,MAA5B,kBAAmC,yCAAnC;KAEA,KAAK7G,GAAL,CAASuT,YAAT,GAAwB3M,aAAG,CAACC,MAA5B,kBAAmC;;MAAnC,CAE2B;MAF3B,CAG0B;;GAH1B,GAEI,KAAK7G,GAAL,CAASqT,aAFb,EAGI,KAAKrT,GAAL,CAASsT,YAHb;KAMA,OAAO,KAAKtT,GAAL,CAASuT,YAAhB;;;GAGD/L,mBAAmB,GACnB;KACC,KAAKxH,GAAL,CAASwT,SAAT,GAAqB5M,aAAG,CAACC,MAAzB,kBAAgC,mCAAhC;KACA,KAAK7G,GAAL,CAASyT,aAAT,GAAyB7M,aAAG,CAACC,MAA7B,kBAAoC;;wCAApC,CAEkE;MAFlE,CAGuB;;GAHvB,GAEsCZ,aAAG,CAACC,UAAJ,CAAe,WAAf,CAFtC,EAGI,KAAKlG,GAAL,CAASwT,SAHb;KAMA,OAAO,KAAKxT,GAAL,CAASyT,aAAhB;;;GAGDC,sBAAsB,GACtB;KACC,KAAK1T,GAAL,CAAS2T,YAAT,GAAwB/M,aAAG,CAACC,MAA5B,kBAAmC,mCAAnC;KACA,KAAK7G,GAAL,CAAS4T,gBAAT,GAA4BhN,aAAG,CAACC,MAAhC,kBAAuC;;wCAAvC,CAEoE;MAFpE,CAG0B;;GAH1B,GAEsCZ,aAAG,CAACC,UAAJ,CAAe,aAAf,CAFtC,EAGI,KAAKlG,GAAL,CAAS2T,YAHb;KAMA,OAAO,KAAK3T,GAAL,CAAS4T,gBAAhB;;;GAGDvL,UAAU,GACV;KACC,OAAO,CAAC,KAAKV,KAAL,CAAWC,EAAnB;;;GAGD5D,KAAK,CAAC6P,MAAD,EACL;KACC,MAAMnF,OAAO,GAAG,KAAKC,iBAAL,EAAhB;;KAEA,IAAIkF,MAAM,KAAK,MAAX,IAAqBA,MAAM,KAAK,QAApC,EACA;OACC,IAAK,KAAKlM,KAAL,CAAWmB,SAAX,MAA0B,KAAKnB,KAAL,CAAWC,EAAX,KAAkB,KAAKD,KAAL,CAAWE,QAA5D,EACA;SACC,OAAO,KAAP;;;OAGD,IAAI,KAAKF,KAAL,CAAWmM,iBAAX,EAAJ,EACA;SACC,OAAO,KAAP;;;OAGD,OAAOpF,OAAO,CAAC1K,KAAR,CAAc,MAAd,CAAP;;;KAGD,IAAI6P,MAAM,KAAK,MAAf,EACA;OACC,OAAOnF,OAAO,CAAC1K,KAAR,CAAc,WAAd,CAAP;;;KAGD,IAAI6P,MAAM,KAAK,UAAf,EACA;OACC,OAAOnF,OAAO,CAAC1K,KAAR,CAAc,WAAd,CAAP;;;KAGD,IAAG6P,MAAM,KAAK,SAAd,EACA;OACC,OAAOnF,OAAO,CAAC1K,KAAR,CAAc,QAAd,CAAP;;;KAGD,OAAO,IAAP;;;GAGDN,aAAa,GACb;KACC,MAAMiE,KAAK,GAAG,KAAKA,KAAnB;KACA,MAAM+G,OAAO,GAAG,KAAKC,iBAAL,EAAhB;KACA,MAAMoF,QAAQ,GAAG,CAAC,KAAK/P,KAAL,CAAW,MAAX,CAAlB,CAHD;;KAMC,KAAKmI,eAAL,CAAqB+E,QAArB,CAA8B;OAC7B5H,IAAI,EAAE5I,kBAAI,CAACsT,2BAAL,CAAiCrM,KAAK,CAAC2B,IAAvC,EAA6C3B,KAAK,CAACsM,sBAAnD,EAA2EtM,KAAK,CAAC2E,OAAjF,CADuB;OAE7BE,EAAE,EAAE9L,kBAAI,CAACsT,2BAAL,CAAiCrM,KAAK,CAAC6E,EAAvC,EAA2C7E,KAAK,CAACuM,oBAAjD,EAAuEvM,KAAK,CAAC2E,OAA7E,CAFyB;OAG7BA,OAAO,EAAE3E,KAAK,CAAC2E,OAHc;OAI7B6H,YAAY,EAAExM,KAAK,CAACyM,eAAN,MAA2B,EAJZ;OAK7BC,UAAU,EAAE1M,KAAK,CAAC2M,aAAN,MAAyB,EALR;OAM7BC,YAAY,EAAE,KAAKxU,YAAL,CAAkBwU;MANjC;KAQA,KAAKpI,eAAL,CAAqBqI,iBAArB,CAAuC,KAAKnM,UAAL,KAAoB,MAApB,GAA6B,MAApE;KACA,KAAK8D,eAAL,CAAqBsI,WAArB,CAAiCV,QAAjC,EAfD;;KAkBC,KAAK/T,GAAL,CAASiE,UAAT,CAAoBqH,KAApB,GAA4B3D,KAAK,CAAC+M,OAAN,EAA5B;;KAEA,IAAIX,QAAJ,EACA;OACC,IAAI,KAAKpM,KAAL,CAAWoB,gBAAX,OAAkC,KAAtC,EACA;SACC,KAAK/I,GAAL,CAASiE,UAAT,CAAoBrD,IAApB,GAA2B,QAA3B,CADD;;;SAGC,KAAKZ,GAAL,CAAS2U,UAAT,GAAsB,KAAK3U,GAAL,CAASiE,UAAT,CAAoB2Q,UAApB,CAA+BC,YAA/B,CAA4CjO,aAAG,CAACC,MAAhD,kBAAuD,sDAAvD,CAAyI,SAAzI,GAA4GiO,cAAI,CAACC,MAAL,CAAYpN,KAAK,CAAC+M,OAAN,EAAZ,CAA5G,GAAmJ,KAAK1U,GAAL,CAASiE,UAA5J,CAAtB;SACAtB,aAAG,CAACC,QAAJ,CAAa,KAAK5C,GAAL,CAAS8G,cAAtB,EAAsC,+BAAtC;QALD,MAQA;SACC,KAAK9G,GAAL,CAASiE,UAAT,CAAoB+Q,QAApB,GAA+B,IAA/B;;MA/BH;;;KAoCC,KAAK9E,aAAL,CAAmBgB,QAAnB,CAA4BvJ,KAAK,CAACsN,QAAN,MAAoBvG,OAAO,CAAC2B,KAAxD,EAA+D,KAA/D;KACA,KAAKH,aAAL,CAAmBuE,WAAnB,CAA+BV,QAAQ,IAAI,KAAKpM,KAAL,CAAWoB,gBAAX,OAAkC,KAA7E,EArCD;;KAwCC,KAAK8D,YAAL,GAAoB,KAAKqI,mBAAL,EAApB;KACA,KAAK1E,eAAL,CAAqB2E,WAArB;;KACA,IAAI,KAAKC,aAAL,CAAmB1G,OAAnB,KAA+B/G,KAAK,CAACC,EAAzC,EACA;OACC,KAAK4I,eAAL,CAAqBiE,WAArB,CAAiC,IAAjC;MAFD,MAKA;OACC,KAAKjE,eAAL,CAAqBiE,WAArB,CAAiCV,QAAjC;MAhDF;;;KAoDC,KAAKvC,gBAAL,CAAsBN,QAAtB,CAA+BvJ,KAAK,CAAC0N,YAAN,EAA/B,EAAqD,KAArD;KACA,KAAK7D,gBAAL,CAAsBiD,WAAtB,CAAkCV,QAAQ,IAAI,KAAKpM,KAAL,CAAWoB,gBAAX,OAAkC,KAAhF;;KACA,IAAIgL,QAAQ,IAAI,KAAKpM,KAAL,CAAWoB,gBAAX,OAAkC,KAAlD,EACA;OACC,KAAK/I,GAAL,CAASsH,kBAAT,CAA4BgO,KAA5B,CAAkCC,OAAlC,GAA4C,MAA5C;MAxDF;;;KA4DC,IAAI5N,KAAK,CAAC6N,WAAN,EAAJ,EACA;OACC,KAAKxV,GAAL,CAASyT,aAAT,CAAuB6B,KAAvB,GAA+B,EAA/B;OACA3S,aAAG,CAAC8S,MAAJ,CAAW,KAAKzV,GAAL,CAASwT,SAApB,EAA+B;SAACpL,IAAI,EAAET,KAAK,CAAC+N,mBAAN;QAAtC;MA/DF;;;KAmEC,IAAIC,QAAQ,GAAGhO,KAAK,CAACqE,WAAN,EAAf;;KACA,IAAI+H,QAAQ,IAAI,CAAC4B,QAAjB,EACA;OACC,KAAK3V,GAAL,CAAS2S,iBAAT,CAA2B2C,KAA3B,CAAiCC,OAAjC,GAA2C,MAA3C;MAFD,MAKA;OACC,KAAKlK,gBAAL,CAAsBoJ,WAAtB,CAAkCV,QAAlC;;OACA,IAAI,KAAKlT,kBAAT,EACA;SACC,KAAKwK,gBAAL,CAAsB6F,QAAtB,CAA+B,KAAK7F,gBAAL,CAAsBuK,OAArD;SACAD,QAAQ,GAAG,KAAKtK,gBAAL,CAAsBuK,OAAjC;QAHD,MAMA;SACC,KAAK5V,GAAL,CAAS2S,iBAAT,CAA2B2C,KAA3B,CAAiCC,OAAjC,GAA2C,EAA3C;SACA,KAAKlK,gBAAL,CAAsB6F,QAAtB,CAA+BvJ,KAAK,CAACqE,WAAN,EAA/B;;;;KAGF,IAAI,KAAKX,gBAAT,EACA;OACC,KAAKA,gBAAL,CAAsB2G,0BAAtB,CACC;SACC1I,IAAI,EAAE,KAAK6C,eAAL,CAAqBC,QAArB,GAAgC9C,IADvC;SAECkD,EAAE,EAAE,KAAKL,eAAL,CAAqBC,QAArB,GAAgCI,EAFrC;SAGCF,OAAO,EAAE,KAAKH,eAAL,CAAqBC,QAArB,GAAgCE,OAH1C;SAIC2F,cAAc,EAAE,KAAKtK,KAAL,CAAWC;QAL7B;MAxFF;;;KAmGC,IACC,KAAKjE,mBAAL,KACI,KAAKK,KAAL,CAAW,UAAX,KAA0B2D,KAAK,CAACoB,gBAAN,OAA6B,KAD3D,CADD,EAIA;OACC,KAAKpF,mBAAL,CAAyBuN,QAAzB,CAAkC;SACjCtN,mBAAmB,EAAE+D,KAAK,CAACwF,sBAAN,EADY;SAEjCwI,QAAQ,EAAEA,QAFuB;SAGjCE,SAAS,EAAElO,KAAK,CAAC0C,YAAN,EAHsB;SAIjCyL,MAAM,EAAE,CAACnO,KAAK,CAACmB,SAAN,EAAD,IAAsBnB,KAAK,CAAC8E,gBAAN,EAJG;SAKjCsJ,QAAQ,EAAE,KAAK5S,OAAL,OAAmB9D,gBAAgB,CAACyE,SALb;SAMjC6D,KAAK,EAAEA,KAN0B;SAOjCqO,UAAU,EAAErO,KAAK,CAACsO,aAAN;QAPb;OASA,KAAKtS,mBAAL,CAAyBmO,WAAzB,CAAqC,KAAK3F,eAAL,CAAqBC,QAArB,EAArC;OACA,KAAKzI,mBAAL,CAAyB8Q,WAAzB,CAAqCV,QAArC;MAfD,MAkBA;OACCpR,aAAG,CAAC+H,MAAJ,CAAW,KAAK1K,GAAL,CAASkS,4BAApB;;;KAGD,IAAIgE,iBAAiB,GAAG,IAAxB;KACA,KAAKlW,GAAL,CAASmW,aAAT,GAAyB,KAAKnW,GAAL,CAAS2G,IAAT,CAAcyP,aAAd,CAA4B,gCAA5B,CAAzB;;KACA,KAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,IAAI,KAAKrW,GAAL,CAASmW,aAAT,CAAuBG,UAAvB,CAAkCzS,MAAtD,EAA8DwS,CAAC,EAA/D,EACA;OACC,IACC9L,cAAI,CAACgM,aAAL,CAAmB,KAAKvW,GAAL,CAASmW,aAAT,CAAuBG,UAAvB,CAAkCD,CAAlC,CAAnB,KACG,KAAKrW,GAAL,CAASmW,aAAT,CAAuBG,UAAvB,CAAkCD,CAAlC,EAAqCf,KAArC,CAA2CC,OAA3C,KAAuD,MAF3D,EAIA;SACCW,iBAAiB,GAAG,KAApB;;;;KAGF,IAAIA,iBAAJ,EACA;OACC,KAAKlW,GAAL,CAASmW,aAAT,CAAuBb,KAAvB,CAA6BC,OAA7B,GAAuC,MAAvC;;;;GAIF9R,qBAAqB,GACrB;KACC,IACCkE,KAAK,GAAG,KAAKA,KADd;SAEC+G,OAAO,GAAG,KAAKC,iBAAL,EAFX;SAGCoF,QAAQ,GAAG,IAHZ,CADD;;KAOC,KAAK5H,eAAL,CAAqB+E,QAArB,CAA8B;OAC7B5H,IAAI,EAAE5I,kBAAI,CAACsT,2BAAL,CAAiCrM,KAAK,CAAC2B,IAAvC,EAA6C3B,KAAK,CAACsM,sBAAnD,EAA2EtM,KAAK,CAAC2E,OAAjF,CADuB;OAE7BE,EAAE,EAAE9L,kBAAI,CAACsT,2BAAL,CAAiCrM,KAAK,CAAC6E,EAAvC,EAA2C7E,KAAK,CAACuM,oBAAjD,EAAuEvM,KAAK,CAAC2E,OAA7E,CAFyB;OAG7BA,OAAO,EAAE3E,KAAK,CAAC2E,OAHc;OAI7B6H,YAAY,EAAExM,KAAK,CAACyM,eAAN,MAA2B,EAJZ;OAK7BC,UAAU,EAAE1M,KAAK,CAAC2M,aAAN,MAAyB,EALR;OAM7BC,YAAY,EAAE,KAAKxU,YAAL,CAAkBwU;MANjC;KAQA,KAAKpI,eAAL,CAAqBqI,iBAArB,CAAuC,KAAKnM,UAAL,KAAoB,MAApB,GAA6B,MAApE;KACA,KAAK8D,eAAL,CAAqBsI,WAArB,CAAiCV,QAAjC,EAhBD;;KAmBC,IAAI,KAAKpM,KAAL,CAAWC,EAAX,KAAkB,KAAKD,KAAL,CAAWE,QAAjC,EACA;OACC,KAAK7H,GAAL,CAASiE,UAAT,CAAoBqH,KAApB,GAA4BoD,OAAO,CAACvG,IAAR,GACzB,IADyB,GAClBnH,EAAE,CAAC+O,IAAH,CAAQC,gBAAR,CAAyBrI,KAAK,CAAC+M,OAAN,EAAzB,CADV;MAFD,MAMA;OACC,KAAK1U,GAAL,CAASiE,UAAT,CAAoBqH,KAApB,GAA4BrF,aAAG,CAACC,UAAJ,CAAe,iBAAf,CAA5B;MA1BF;;;KA8BC,KAAKgK,aAAL,CAAmBgB,QAAnB,CAA4BvJ,KAAK,CAACsN,QAAN,MAAoBvG,OAAO,CAAC2B,KAAxD,EAA+D,KAA/D;KACA,KAAKH,aAAL,CAAmBuE,WAAnB,CAA+B,CAACV,QAAhC,EA/BD;;KAkCC,KAAKlH,YAAL,GAAoB,KAAKqI,mBAAL,EAApB;KACA,KAAK1E,eAAL,CAAqB2E,WAArB;KACA,KAAK3E,eAAL,CAAqBiE,WAArB,CAAiCV,QAAjC;;;GAGDxL,IAAI,CAAC/I,OAAO,GAAG,EAAX,EACJ;KACC,IAAI,KAAK2C,KAAL,KAAe,KAAK1C,KAAL,CAAWE,OAA9B,EACC,OAAO,KAAP;KAED,MAAMgI,KAAK,GAAG,KAAK6O,eAAL,EAAd;KACAhX,OAAO,GAAG+K,cAAI,CAACiD,aAAL,CAAmBhO,OAAnB,IAA8BA,OAA9B,GAAwC,EAAlD;;KAEA,IAAI,KAAK6I,UAAL,MACA,KAAK1E,mBAAL,CAAyB8S,qBAAzB,EADA,IAEA/V,kBAAI,CAACgW,yBAAL,EAFA,IAGA,CAAClX,OAAO,CAACmX,0BAHb,EAIA;OACCvT,2BAAY,CAACwT,yBAAb,CAAuC;SACtCC,QAAQ,EAAG7U,MAAD,IAAY;WACrBxC,OAAO,CAACmX,0BAAR,GAAqC,IAArC;WACA,KAAKpO,IAAL,CAAU/I,OAAV;;QAHF;OAMA,OAAO,KAAP;;;KAGD,IAAI,CAAC,KAAKO,YAAL,CAAkB+W,aAAnB,IACA,KAAKnT,mBAAL,CAAyB8S,qBAAzB,EADJ,EAEA;OACCrT,2BAAY,CAAC2T,wBAAb,CAAsC;SACrCF,QAAQ,EAAG7U,MAAD,IAAY;WACrB,KAAKuG,IAAL,CAAU/I,OAAV;;QAFF;OAKA,OAAO,KAAP;;;KAGD,IAAI,CAAC,KAAK6I,UAAL,EAAD,IACAV,KAAK,CAAC6N,WAAN,EADA,IAEA,CAAChW,OAAO,CAACwX,SAFT,IAGA,KAAKtL,kBAAL,CAAwB,CAAC,SAAD,EAAY,QAAZ,CAAxB,EAA+C7H,MAA/C,GAAwD,CAH5D,EAIA;OACCT,2BAAY,CAAC6T,qBAAb,CAAmC;SAClCJ,QAAQ,EAAG7U,MAAD,IAAY;WACrBxC,OAAO,CAAC0X,aAAR,GAAyBvP,KAAK,CAACwP,eAAN,MAA2BnV,MAAM,CAACkV,aAAP,KAAyB,MAArD,GACrB,KADqB,GAErBlV,MAAM,CAACkV,aAFV;WAGA1X,OAAO,CAACwX,SAAR,GAAoB,IAApB;WACA,KAAKzO,IAAL,CAAU/I,OAAV;;QANF;OASA,OAAO,KAAP;;;KAGD,IAAI,CAAC,KAAK6I,UAAL,EAAD,IACAV,KAAK,CAACmB,SAAN,EADA,IAEAtJ,OAAO,CAAC4X,gBAAR,KAA6B7L,SAF7B,IAGA,KAAKG,kBAAL,GAA0BG,QAA1B,CAAmC,WAAnC,CAHA,IAIAlE,KAAK,CAAC0C,YAAN,GAAqBgN,IAArB,CAA2BrK,IAAD,IAAU;OAAC,OAAOA,IAAI,CAACsK,MAAL,KAAgB,GAAvB;MAArC,CAJJ,EAMA;OACClU,2BAAY,CAACmU,uBAAb,CAAqC;SACpCV,QAAQ,EAAG7U,MAAD,IAAY;WACrBxC,OAAO,CAAC4X,gBAAR,GAA2BpV,MAAM,CAACoV,gBAAlC;WACA,KAAK7O,IAAL,CAAU/I,OAAV;;QAHF;OAMA,OAAO,KAAP;;;KAGD,MAAM0M,QAAQ,GAAG,KAAKC,eAAL,CAAqBC,QAArB,EAAjB;KACA,MAAM5C,IAAI,GAAG;OACZ5B,EAAE,EAAED,KAAK,CAACC,EADE;OAEZ8G,OAAO,EAAE,KAAK7B,YAFF;OAGZ1E,IAAI,EAAE,KAAKnI,GAAL,CAASiE,UAAT,CAAoBqH,KAHd;OAIZkM,IAAI,EAAE7P,KAAK,CAAC8P,cAAN,EAJM;OAKZC,QAAQ,EAAE,KAAKlG,gBAAL,CAAsBmG,iBAAtB,EALE;OAMZC,SAAS,EAAE1L,QAAQ,CAAC2L,QANR;OAOZC,OAAO,EAAE5L,QAAQ,CAAC6L,MAPN;OAQZC,SAAS,EAAE9L,QAAQ,CAACI,OAAT,GAAmB,GAAnB,GAAyB,GARxB;OASZ2L,SAAS,EAAEvX,kBAAI,CAACwX,UAAL,CAAgBxX,kBAAI,CAACsT,2BAAL,CAAiC9H,QAAQ,CAAC5C,IAA1C,EAAgD,CAAC3B,KAAK,CAACsM,sBAAvD,EAA+E/H,QAAQ,CAACI,OAAxF,CAAhB,CATC;OAUZ6L,OAAO,EAAEzX,kBAAI,CAACwX,UAAL,CAAgBxX,kBAAI,CAACsT,2BAAL,CAAiC9H,QAAQ,CAACM,EAA1C,EAA8C,CAAC7E,KAAK,CAACuM,oBAArD,EAA2EhI,QAAQ,CAACI,OAApF,CAAhB,CAVG;OAWZqJ,QAAQ,EAAE,KAAKtK,gBAAL,CAAsBY,YAAtB,EAXE;OAYZmM,OAAO,EAAEzQ,KAAK,CAACyM,eAAN,EAZG;OAaZiE,KAAK,EAAE1Q,KAAK,CAAC2M,aAAN,EAbK;OAcZgE,cAAc,EAAE,KAAK3U,mBAAL,CAAyB+I,cAAzB,KAA4C,GAA5C,GAAkD,GAdtD;OAeZ6L,YAAY,EAAE5Q,KAAK,CAAC6B,IAAN,CAAWgP,YAAX,IAA2B,GAf7B;OAgBZC,OAAO,EAAE9Q,KAAK,CAAC6B,IAAN,CAAWkP,OAAX,GACN/Q,KAAK,CAAC6B,IAAN,CAAWkP,OAAX,CAAmBC,OADb,GAEN,CAlBS;OAmBZC,aAAa,EAAE,KAAKC,YAAL,IAAqB,EAnBxB;OAoBZjV,mBAAmB,EAAE,KAAKD,mBAAL,CAAyBmJ,aAAzB,EApBT;OAqBZsK,gBAAgB,EAAE5X,OAAO,CAAC4X,gBAAR,GAA2B,GAA3B,GAAiC,GArBvC;OAsBZ0B,WAAW,EAAE,KAAKnV,mBAAL,CAAyBqS,UAAzB,GAAsC,GAAtC,GAA4C,GAtB7C;OAuBZ+C,UAAU,EAAE/X,EAAE,CAACoI,QAAH,CAAY1I,IAAZ,CAAiBsY,iBAAjB,EAvBA;OAwBZC,aAAa,EAAEtR,KAAK,CAACuR,SAAN,KAAoB,GAApB,GAA0B;MAxB1C;KA2BA,IAAIC,8BAA8B,GAAG,CAACxR,KAAK,CAACC,EAAP,IAAa,KAAKuR,8BAAL,EAAlD;;KACA,IAAI,CAACA,8BAAD,IACA,KAAKzN,kBAAL,GAA0BG,QAA1B,CAAmC,OAAnC,CADJ,EAEA;OACC,MAAMuN,qBAAqB,GAAGzR,KAAK,CAACwF,sBAAN,EAA9B;OACA,MAAMkM,gBAAgB,GAAG,EAAzB;OACA7P,IAAI,CAAC5F,mBAAL,CAAyBoG,OAAzB,CAAiCsP,MAAM,IAAI;SAC1C,IAAI,CAACF,qBAAqB,CAAC/B,IAAtB,CAA4BrK,IAAD,IAAU;WACzC,OAAOsM,MAAM,CAACrM,QAAP,KAAoBD,IAAI,CAACC,QAAzB,IACHN,QAAQ,CAAC2M,MAAM,CAAC1R,EAAR,CAAR,KAAwB+E,QAAQ,CAACK,IAAI,CAACpF,EAAN,CADpC;UADI,CAAL,EAIA;WACC,IAAI0R,MAAM,CAACrM,QAAP,KAAoB,MAAxB,EACA;aACCoM,gBAAgB,CAAC5Q,IAAjB,CAAsB6Q,MAAM,CAAC1R,EAA7B;YAFD,MAKA;aACCuR,8BAA8B,GAAG,IAAjC;;;QAZH;OAgBA3P,IAAI,CAAC6P,gBAAL,GAAwBA,gBAAxB;;;KAED7P,IAAI,CAAC2P,8BAAL,GAAsCA,8BAA8B,GAAG,GAAH,GAAS,GAA7E;;KAEA,IAAIxR,KAAK,CAACC,EAAN,IAAYD,KAAK,CAAC6N,WAAN,EAAhB,EACA;OACChM,IAAI,CAAC+P,WAAL,GAAmB5R,KAAK,CAAC6B,IAAN,CAAWgQ,KAA9B;;;KAGD,IAAIha,OAAO,CAAC0X,aAAZ,EACA;OACC1N,IAAI,CAACiQ,aAAL,GAAqBja,OAAO,CAAC0X,aAA7B;OACA1N,IAAI,CAACkQ,iBAAL,GAAyBhZ,kBAAI,CAACiZ,UAAL,CAAgBhS,KAAK,CAAC2B,IAAtB,CAAzB;;;KAGD,IAAI,KAAKqF,iBAAL,GAAyB0B,KAAzB,CAA+BuJ,WAA/B,OAAiD,KAAK1J,aAAL,CAAmB9D,QAAnB,GAA8BwN,WAA9B,EAArD,EACA;OACCpQ,IAAI,CAAC6G,KAAL,GAAa,KAAKH,aAAL,CAAmB9D,QAAnB,EAAb;;;KAGD,KAAKjK,KAAL,GAAa,KAAK1C,KAAL,CAAWE,OAAxB;KAEA,KAAKoK,WAAL;KACA,KAAK/I,EAAL,CAAQ+N,IAAR,CAAaC,SAAb,CAAuB,0CAAvB,EAAmE;OACjExF,IAAI,EAAEA,IAD2D;OAEjEqQ,cAAc,EAAE;SACfxV,cAAc,EAAE,KAAKgE,UAAL,KAAoB,cAApB,GAAqC,YADtC;SAEf/D,QAAQ,EAAE,SAFK;SAGfwV,WAAW,EAAE,KAAKnW,mBAAL,CAAyB8S,qBAAzB,KAAmD,GAAnD,GAAyD,GAHvD;SAIfsD,QAAQ,EAAErZ,kBAAI,CAACsZ,cAAL,MAAyB,SAJpB;SAKfC,OAAO,EAAE,GALM;SAMfC,SAAS,EAAE,MANI;SAOfC,WAAW,EAAE,KAAKxS,KAAL,CAAWmB,SAAX,KAAyB,GAAzB,GAA+B,GAP7B;SAQfsR,QAAQ,EAAE,KAAKxZ;;MAVlB,EAaE2C,IAbF,CAaQ4L,QAAD,IAAc;OAClB,IAAI,KAAKtO,kBAAL,IAA2B,KAAKsN,YAApC,EACA;SACC,KAAKA,YAAL,CAAkBkM,eAAlB,CAAkC9T,0BAAQ,CAACwF,gBAAT,CAA0BvC,IAAI,CAACmM,QAA/B,EAAyC2E,OAA3E;QAHiB;;;OAOlB,MAAM5L,OAAO,GAAG,KAAKC,iBAAL,EAAhB;;OACA,IAAID,OAAO,IAAI,CAACA,OAAO,CAAC9I,OAAR,EAAhB,EACA;SACC8I,OAAO,CAAC7M,IAAR;;;OAGD,KAAKsI,aAAL;OACA,KAAKhI,KAAL,GAAa,KAAK1C,KAAL,CAAWC,KAAxB;;OACA,IAAIyP,QAAQ,CAAC3F,IAAT,CAAcyF,OAAlB,EACA;SACC,IAAItH,KAAK,CAACC,EAAV,EACA;WACCxE,2BAAY,CAACmX,yBAAb,CAAuCpL,QAAQ,CAAC3F,IAAT,CAAcyF,OAArD;UAFD,MAKA;WACC7L,2BAAY,CAACoX,wBAAb,CAAsCrL,QAAQ,CAAC3F,IAAT,CAAcyF,OAApD;;;;OAIF,KAAK5I,IAAL,CAAU,QAAV,EAAoB,IAAI2E,0BAAJ,CAAc;SACjCxB,IAAI,EAAE;WACLiR,YAAY,EAAEtL,QAAQ,CAAC3F,IADlB;WAELhK,OAAO,EAAEA;;QAHS,CAApB;OAMA,KAAKmG,KAAL;;OAEA,IAAIwJ,QAAQ,CAAC3F,IAAT,CAAckR,8BAAlB,EACA;SACCha,kBAAI,CAACia,4BAAL,CAAkCxL,QAAQ,CAAC3F,IAAT,CAAckR,8BAAhD;;;OAGD,IAAInQ,cAAI,CAACuD,OAAL,CAAaqB,QAAQ,CAAC3F,IAAT,CAAcoR,SAA3B,KACAzL,QAAQ,CAAC3F,IAAT,CAAcoR,SAAd,CAAwB/W,MADxB,IAEAsL,QAAQ,CAAC3F,IAAT,CAAcoR,SAAd,CAAwB,CAAxB,EAA2BxH,MAF/B,EAIA;SACChQ,2BAAY,CAACyX,oBAAb,CACC3O,QAAQ,CAACI,OAAT,GAAmB,SAAnB,GAA+B,UADhC,EAEC6C,QAAQ,CAAC3F,IAAT,CAAcoR,SAAd,CAAwB,CAAxB,EAA2BxH,MAF5B;;MA1DJ,EAgEGjE,QAAD,IAAc;OACb,KAAKhF,aAAL;;OACA,IAAIgF,QAAQ,CAAC3F,IAAT,IAAiBe,cAAI,CAACiD,aAAL,CAAmB2B,QAAQ,CAAC3F,IAAT,CAAcsR,aAAjC,CAArB,EACA;SACC,KAAKC,oBAAL,CAA0B5L,QAAQ,CAAC3F,IAAT,CAAcsR,aAAxC;SAEA,IAAIE,MAAM,GAAG,EAAb;SACA7L,QAAQ,CAAC6L,MAAT,CAAgBhR,OAAhB,CAAyBiR,KAAD,IAAW;WAClC,IAAIA,KAAK,CAACC,IAAN,KAAe,sBAAnB,EACA;aACCF,MAAM,CAACvS,IAAP,CAAYwS,KAAZ;;UAHF;SAMA9L,QAAQ,CAAC6L,MAAT,GAAkBA,MAAlB;;;OAGD,IAAI7L,QAAQ,CAAC6L,MAAT,IAAmB7L,QAAQ,CAAC6L,MAAT,CAAgBnX,MAAvC,EACA;SACC,KAAKsX,SAAL,CAAehM,QAAQ,CAAC6L,MAAxB;;;OAGD,KAAK7Y,KAAL,GAAa,KAAK1C,KAAL,CAAWG,KAAxB;MArFH;KAyFA,OAAO,IAAP;;;GAGDmb,oBAAoB,CAACK,SAAD,EACpB;KACC,IACCC,KAAK,GAAG,EADT;SAECC,OAAO,GAAG,EAFX;;KAIA,KAAK,IAAI1T,EAAT,IAAewT,SAAf,EACA;OACC,IAAIA,SAAS,CAACG,cAAV,CAAyB3T,EAAzB,CAAJ,EACA;SACCyT,KAAK,CAAC5S,IAAN,CAAW2S,SAAS,CAACxT,EAAD,CAApB;SACA0T,OAAO,CAAC7S,IAAR,CAAab,EAAb;;;;KAIF,KAAK4T,eAAL,GAAuB,IAAIC,iCAAJ,EAAvB;KACA,KAAKD,eAAL,CAAqBpL,SAArB,CAA+B,eAA/B,EAAgD,MAAM;OACrD,KAAKyI,YAAL,GAAoByC,OAAO,CAACpO,IAAR,CAAa,GAAb,CAApB;OACA,KAAK3E,IAAL;MAFD;KAKA,KAAKiT,eAAL,CAAqB3Z,IAArB,CAA0B;OAACwZ,KAAK,EAAEA;MAAlC;;;GAGDzZ,cAAc,CAAC8Z,CAAD,EACd;KACC,IACC,KAAKvY,OAAL,OAAmB9D,gBAAgB,CAAC0C,SAApC,IACG2Z,CAAC,CAACC,OAAF,KAAcjb,kBAAI,CAACkb,UAAL,CAAgB,OAAhB,CADjB,KAEIF,CAAC,CAACG,OAAF,IAAaH,CAAC,CAACI,OAFnB,KAE+B,CAACJ,CAAC,CAACK,MAHnC,EAKA;OACC,KAAK1b,wBAAL,GAAgC,KAAhC;OACA,KAAKgL,gBAAL,CAAsB2Q,YAAtB,CAAmClJ,gBAAnC;OACA,KAAKvK,IAAL;MARD,MAUK,IACJ,KAAKzC,cAAL,MACG4V,CAAC,CAACC,OAAF,KAAcjb,kBAAI,CAACkb,UAAL,CAAgB,QAAhB,CADjB,IAEG,KAAKK,kBAAL,EAHC,EAKL;OACC,KAAKtW,KAAL;MANI,MAQA,IACJ+V,CAAC,CAACC,OAAF,KAAcjb,kBAAI,CAACkb,UAAL,CAAgB,QAAhB,CAAd,IACG,CAAC,KAAKvT,UAAL,EADJ,IAEG,KAAKrE,KAAL,CAAW,QAAX,CAHC,EAKL;OACC,MAAMkY,MAAM,GAAGnR,KAAK,CAACmR,MAAN,IAAgBnR,KAAK,CAACoR,UAArC;OACA,MAAMC,OAAO,GAAG7R,cAAI,CAACgM,aAAL,CAAmB2F,MAAnB,IAA6BA,MAAM,CAACE,OAAP,CAAexC,WAAf,EAA7B,GAA4D,IAA5E;;OACA,IAAIwC,OAAO,IAAI,CAAC,CAAC,OAAD,EAAU,UAAV,EAAsBvQ,QAAtB,CAA+BuQ,OAA/B,CAAhB,EACA;SACC9c,6BAAY,CAACsK,aAAb,CAA2B,gCAA3B,EAA6D,MAAM;WAClE,KAAKvJ,wBAAL,GAAgC,KAAhC;WACA,KAAKsF,KAAL;UAFD;SAIAvC,2BAAY,CAACyG,WAAb,CAAyB,KAAKlC,KAA9B;;;;;GAKH6O,eAAe,GACf;KACC,OAAO,KAAK7O,KAAZ;;;GAGDgH,iBAAiB,GACjB;KACC,IAAID,OAAO,GAAG,KAAd;KACA,MAAM9B,SAAS,GAAG,KAAKsI,mBAAL,EAAlB;;KAEA,IACCtI,SAAS,IACN,KAAKzM,YAAL,CAAkByM,SAAlB,MAAiCrB,SADpC,IAEG,KAAKrL,QAAL,CAAc,KAAKC,YAAL,CAAkByM,SAAlB,CAAd,MAAgDrB,SAHpD,EAIA;OACCmD,OAAO,GAAG,KAAKxO,QAAL,CAAc,KAAKC,YAAL,CAAkByM,SAAlB,CAAd,CAAV;;;KAED,OAAO8B,OAAP;;;GAGDwG,mBAAmB,GACnB;KACC,IAAItI,SAAS,GAAG,CAAhB;;KACA,IAAI,KAAKC,YAAT,EACA;OACCD,SAAS,GAAG,KAAKC,YAAjB;MAFD,MAKA;OACC,MAAMlF,KAAK,GAAG,KAAK6O,eAAL,EAAd;;OACA,IAAI7O,KAAK,YAAY0U,oBAArB,EACA;SACCzP,SAAS,GAAGD,QAAQ,CAAChF,KAAK,CAACiF,SAAP,CAApB;QAJF;;;OAQC,IAAI,CAACA,SAAD,IAAc,KAAK1M,QAAL,CAAc,CAAd,CAAlB,EACA;SACC0M,SAAS,GAAGD,QAAQ,CAAC,KAAKzM,QAAL,CAAc,CAAd,EAAiB0H,EAAlB,CAApB;;;;KAGF,OAAOgF,SAAP;;;GAGD6F,4BAA4B,CAAC1H,KAAD,EAC5B;KACC,IAAIA,KAAK,YAAYC,0BAArB,EACA;OACC,MAAMsR,aAAa,GAAG,KAAKnQ,eAAL,CAAqBC,QAArB,EAAtB;OACAkQ,aAAa,CAAChT,IAAd,GAAqByB,KAAK,CAACE,OAAN,GAAgBsR,QAArC;OACAD,aAAa,CAAC9P,EAAd,GAAmBzB,KAAK,CAACE,OAAN,GAAgBuR,MAAnC,CAHD;;OAKC,KAAKrQ,eAAL,CAAqB+E,QAArB,CAA8BoL,aAA9B;OACA,KAAK3Y,mBAAL,CAAyBmO,WAAzB,CAAqC,KAAK3F,eAAL,CAAqBC,QAArB,EAArC;;OAEA,IAAI,KAAKf,gBAAT,EACA;SACC,KAAKA,gBAAL,CAAsB2G,0BAAtB,CACC;WACC1I,IAAI,EAAEyB,KAAK,CAACE,OAAN,GAAgBsR,QADvB;WAEC/P,EAAE,EAAEzB,KAAK,CAACE,OAAN,GAAgBuR,MAFrB;WAGClQ,OAAO,EAAEvB,KAAK,CAACE,OAAN,GAAgBqB,OAH1B;WAIC2F,cAAc,EAAE,KAAKtK,KAAL,CAAWC;UAL7B;;;OASD,KAAK1G,uBAAL;;;;GAIF2H,iBAAiB,GACjB;KACC,KAAKxI,wBAAL,GAAgC,KAAhC;KACA,MAAM6L,QAAQ,GAAG,KAAKC,eAAL,CAAqBC,QAArB,EAAjB;KACA,MAAMtL,eAAe,GAAGJ,kBAAI,CAAC6O,kBAAL,EAAxB;KACAvO,EAAE,CAACoI,QAAH,CAAYhG,YAAZ,CAAyBqZ,cAAzB,CAAwC;OACvC3b,eAAe,EAAEA,eADsB;OAEvC6G,KAAK,EAAE,KAAKA,KAF2B;OAGvC/G,IAAI,EAAE,KAAKA,IAH4B;OAIvCC,kBAAkB,EAAE,KAAKA,kBAJc;OAKvCuM,cAAc,EAAE,KAAKA,cALkB;OAMvCC,oBAAoB,EAAE,KAAKA,oBANY;OAOvCc,YAAY,EAAE,KAAKA,YAPoB;OAQvChD,gBAAgB,EAAE5E,0BAAQ,CAAC6E,kBAAT,EARqB;;OASvCrK,OAAO,EAAE,KAAKA,OATyB;OAUvCN,MAAM,EAAE,KAAKA,MAV0B;OAWvCic,aAAa,EAAE;SACdhO,OAAO,EAAE,KAAK7B,YADA;SAEd1E,IAAI,EAAE,KAAKnI,GAAL,CAASiE,UAAT,CAAoBqH,KAFZ;SAGdoM,QAAQ,EAAE,KAAKlG,gBAAL,CAAsBmL,oBAAtB,EAHI;SAIdtM,KAAK,EAAE,KAAKH,aAAL,CAAmB9D,QAAnB,EAJO;SAKd9C,IAAI,EAAE5I,kBAAI,CAACsT,2BAAL,CAAiC9H,QAAQ,CAAC5C,IAA1C,EAAgD,CAAC,KAAK3B,KAAL,CAAWsM,sBAA5D,EAAoF/H,QAAQ,CAACI,OAA7F,CALQ;SAMdE,EAAE,EAAE9L,kBAAI,CAACsT,2BAAL,CAAiC9H,QAAQ,CAACM,EAA1C,EAA8C,CAAC,KAAK7E,KAAL,CAAWuM,oBAA1D,EAAgFhI,QAAQ,CAACI,OAAzF,CANU;SAOdA,OAAO,EAAEJ,QAAQ,CAACI,OAPJ;SAQdqJ,QAAQ,EAAE,KAAKtK,gBAAL,CAAsBY,YAAtB,EARI;SASd2Q,aAAa,EAAE,KAAKjZ,mBAAL,CAAyB+I,cAAzB,KAA4C,GAA5C,GAAkD,GATnD;SAUdsJ,UAAU,EAAE,KAAKrS,mBAAL,CAAyBqS,UAAzB,GAAsC,GAAtC,GAA4C,GAV1C;SAWdpS,mBAAmB,EAAE,KAAKD,mBAAL,CAAyBmJ,aAAzB;;MAtBvB;KAyBA,KAAKnH,KAAL;;;GAGDjE,qBAAqB,CAACqJ,KAAD,EACrB;KACC,IAAImR,MAAM,GAAGnR,KAAK,CAACmR,MAAN,IAAgBnR,KAAK,CAACoR,UAAnC;KACA,KAAKU,gBAAL,GAAwB,CAACX,MAAM,CAACY,OAAP,CAAe,kBAAf,CAAzB;;;GAGDhX,cAAc,GACd;KACC,OAAO,CAACpF,kBAAI,CAACO,KAAL,GAAa8b,SAAb,CAAuBC,QAAvB,CAAgCC,YAAhC,EAAR;;;GAGDzb,sBAAsB,CAACuJ,KAAD,EACtB;KACC,IAAImR,MAAM,GAAGnR,KAAK,CAACmR,MAAN,IAAgBnR,KAAK,CAACoR,UAAnC;KACA,KAAKe,cAAL,GAAsB,CAAChB,MAAM,CAACY,OAAP,CAAe,kBAAf,CAAvB;;KACA,IAAI,KAAKb,kBAAL,MACA,KAAKY,gBADL,IAEA,KAAKK,cAFL,KAGC,KAAK/Z,OAAL,OAAmB9D,gBAAgB,CAACyE,SAApC,IACA,CAAC,KAAKiC,eAAL,EADD,IAEA,KAAKsC,UAAL,EALD,CAAJ,EAOA;OACCjC,UAAU,CAAC,MAAM;SAChB,KAAKT,KAAL,CAAW,KAAX;QADS,EAEP,CAFO,CAAV;;;;GAMFsW,kBAAkB,GAClB;KACC,OAAO,CAACkB,uBAAY,CAACC,OAAb,CAAqB/F,IAArB,CAA2B7U,KAAD,IAAS;OAAC,OAAOA,KAAK,IAAIA,KAAK,CAAC6a,KAAN,OAAkB,KAAKjb,OAAhC,IAA2CI,KAAK,CAACoD,OAAN,EAAlD;MAApC,CAAR;;;GAGDiF,YAAY,GACZ;KACC,KAAKxE,IAAL,CAAU,UAAV,EAAsB,IAAI2E,0BAAJ,CAAc;OACnCxB,IAAI,EAAE;SACL8T,IAAI,EAAE,IADD;SAEL3V,KAAK,EAAE,KAAKA;;MAHQ,CAAtB;;;GAQDwT,SAAS,CAACoC,SAAD,EACT;KACC,IAAIC,SAAS,GAAG,EAAhB;;KAEA,IAAIjT,cAAI,CAACuD,OAAL,CAAayP,SAAb,CAAJ,EACA;OACCA,SAAS,CAACvT,OAAV,CAAmBiR,KAAD,IAAW;SAC5BuC,SAAS,IAAIvC,KAAK,CAACwC,OAAN,GAAgB,IAA7B;QADD;;;KAKD,IAAID,SAAS,KAAK,EAAlB,EACA;OACCE,KAAK,CAACF,SAAD,CAAL;;;;GAIFjc,eAAe,GACf;KACC,IAAI,KAAKqE,OAAL,MACA,CAAC,KAAKyC,UAAL,EADD,IAEA,KAAKlF,OAAL,OAAmB9D,gBAAgB,CAACyE,SAFxC,EAGA;OACC,MAAM6Z,QAAQ,GAAGjd,kBAAI,CAAC6O,kBAAL,EAAjB;;OACA,IAAIoO,QAAJ,EACA;SACC,MAAMhW,KAAK,GAAGvE,2BAAY,CAACkK,gBAAb,CACbqQ,QAAQ,CAACC,OAAT,GAAmBC,YAAnB,CAAgC,KAAKlW,KAAL,CAAWmW,WAAX,EAAhC,CADa,CAAd;;SAIA,IAAInW,KAAK,IAAIA,KAAK,CAACmW,WAAN,EAAb,EACA;WACC,KAAKnW,KAAL,GAAaA,KAAb;WACA,KAAKjE,aAAL;;;;;;GAMJyV,8BAA8B,GAC9B;KACC,OAAO,KAAKzN,kBAAL,GAA0BG,QAA1B,CAAmC,WAAnC,CAAP;;;GAGDkS,UAAU,CAAC/b,MAAD,EACV;KAAA;;KACC,IAAI,KAAK2B,mBAAL,6BACA,KAAKA,mBADL,uCACA,sBAA0Bqa,OAD1B,aACA,uBAAmCpY,OAAnC,EADJ,EAEA;OAAA;;OACC,MAAMqY,UAAU,GAAG1T,cAAI,CAACuD,OAAL,CAAa9L,MAAb,sCAAaA,MAAM,CAAE4J,MAArB,qBAAa,eAAgBsS,SAA7B,IAA0Clc,MAAM,CAAC4J,MAAP,CAAcsS,SAAxD,GAAmE,EAAtF;OACA,MAAMC,UAAU,GAAG,CAAAnc,MAAM,QAAN,+BAAAA,MAAM,CAAE4J,MAAR,qCAAgBwS,QAAhB,MAA6B,MAA7B,GAChBzR,QAAQ,CAAC3K,MAAD,uCAACA,MAAM,CAAE4J,MAAT,qBAAC,gBAAgByS,QAAjB,CADQ,GAEhB1R,QAAQ,CAAC3K,MAAD,uCAACA,MAAM,CAAE4J,MAAT,qBAAC,gBAAgB4D,UAAjB,CAFX;;OAGA,IAAI,CAACyO,UAAU,CAACpS,QAAX,CAAoBsS,UAApB,CAAL,EACA;SACCF,UAAU,CAACxV,IAAX,CAAgB0V,UAAhB;;;OAED,KAAKxa,mBAAL,CAAyB2a,sBAAzB,CAAgDL,UAAhD;OAEA,KAAKta,mBAAL,CAAyBoO,2BAAzB;;;KAGD,MAAMpK,KAAK,GAAG,KAAK6O,eAAL,EAAd;;KACA,IACC,CAAC,KAAKnO,UAAL,EAAD,IACGV,KADH,IAEGA,KAAK,CAACE,QAAN,KAAmB8E,QAAQ,CAAC3K,MAAD,uCAACA,MAAM,CAAE4J,MAAT,qBAAC,gBAAgB2S,SAAjB,CAH/B,EAKA;OAAA;;OACC,IAAIvc,MAAM,CAACwc,OAAP,KAAmB,cAAnB,IACA7W,KAAK,CAAC8W,OAAN,QAAoBzc,MAApB,uCAAoBA,MAAM,CAAE4J,MAA5B,qBAAoB,gBAAgBwS,QAApC,CADJ,EAEA;SACC,KAAKzY,KAAL;QAHD,MAMA;SACC,MAAM+Y,wBAAwB,GAAG,MAAM;WACtC,KAAKpd,uBAAL;WACAN,EAAE,CAACiC,KAAH,CAAS3D,YAAT,CAAsBqf,WAAtB,CAAkC,+BAAlC,EAAmED,wBAAnE;UAFD;;SAIA1d,EAAE,CAACiC,KAAH,CAAS3D,YAAT,CAAsB8Q,SAAtB,CAAgC,+BAAhC,EAAiEsO,wBAAjE;;;;;GAKHtJ,aAAa,CAAC1G,OAAD,EACb;KACC,OAAOA,OAAO,CAACkQ,QAAR,MACHlQ,OAAO,CAACmQ,QAAR,EADG,IAEHnQ,OAAO,CAACoQ,WAAR,EAFG,IAGHpQ,OAAO,CAACqQ,QAAR,EAHG,IAIHrQ,OAAO,CAACsQ,aAAR,EAJJ;;;GAQDpQ,uBAAuB,CAAC1O,QAAD,EAAW+e,cAAX,EACvB;KACC,MAAMC,MAAM,GAAG,EAAf;KACA,MAAMC,WAAW,GAAGF,cAAc,CAACre,IAAnC;KACAse,MAAM,CAACzW,IAAP,CAAYwW,cAAZ;KAEA/e,QAAQ,CAAC8J,OAAT,CAAkB0E,OAAD,IAAa;OAC7B,IAAI,CAAC,KAAK0G,aAAL,CAAmB1G,OAAnB,CAAD,IAAgCA,OAAO,CAAC9N,IAAR,KAAiBue,WAArD,EACA;SACCD,MAAM,CAACzW,IAAP,CAAYiG,OAAZ;;MAHF;KAOA,KAAKxO,QAAL,GAAgBgf,MAAhB;KACA,KAAK/e,YAAL,GAAoB,EAApB;;KACA,IAAIoK,cAAI,CAACuD,OAAL,CAAa,KAAK5N,QAAlB,CAAJ,EACA;OACC,KAAKA,QAAL,CAAc8J,OAAd,CAAsB,CAACsB,KAAD,EAAQkD,GAAR,KAAgB;SACrC,MAAM5G,EAAE,GAAG+E,QAAQ,CAACrB,KAAK,CAACmD,EAAN,IAAYnD,KAAK,CAAC1D,EAAnB,CAAnB;;SACA,IAAIA,EAAE,GAAG,CAAT,EACA;WACC,KAAKzH,YAAL,CAAkByH,EAAlB,IAAwB4G,GAAxB;;QAJF,EAMG,IANH;;;;GAUF9E,eAAe,CAAClK,OAAO,GAAG,EAAX,EACf;KACC,MAAMmI,KAAK,GAAG,KAAK6O,eAAL,EAAd;;KAEA,IAAI7O,KAAK,CAACC,EAAN,IAAYD,KAAK,CAAC6N,WAAN,EAAZ,IACA,CAAChW,OAAO,CAACwX,SADb,EAGA;OACC5T,2BAAY,CAAC6T,qBAAb,CAAmC;SAClCJ,QAAQ,EAAG7U,MAAD,IAAY;WACrBxC,OAAO,CAACwX,SAAR,GAAoB,IAApB;WACA,KAAKtN,eAAL,CAAqB;aACpBwN,aAAa,EAAElV,MAAM,CAACkV,aADF;aAEpBF,SAAS,EAAE;YAFZ;;QAHF;OASA,OAAO,KAAP;;;KAGD,IAAG,CAACxX,OAAO,CAAC0X,aAAZ,EACA;OACC1X,OAAO,CAAC0X,aAAR,GAAwB,EAAxB;;;KAGD,KAAK/U,KAAL,GAAa,KAAK1C,KAAL,CAAWE,OAAxB;KAEA,KAAKoK,WAAL;KAEA,KAAK/I,EAAL,CAAQ+N,IAAR,CAAaC,SAAb,CAAuB,yCAAvB,EAAkE;OACjExF,IAAI,EAAC;SACJ4V,eAAe,EAAEzX,KAAK,CAACE,QADnB;SAEJwX,cAAc,EAAE7f,OAAO,CAAC0X,aAFpB;SAGJoI,UAAU,EAAE3X,KAAK,CAACiF,SAHd;SAIJ2S,uBAAuB,EAAE5X,KAAK,CAAC6B,IAAN,CAAWgW,SAJhC;SAKJC,qBAAqB,EAAE9X,KAAK,CAAC6B,IAAN,CAAWkW,OAL9B;SAMJC,QAAQ,EAAEhY,KAAK,CAAC6B,IAAN,CAAWgG;;MAPvB,EAUCjM,IAVD,CAUO4L,QAAD,IAAc;OAClB,KAAKhF,aAAL;OACA,KAAKhI,KAAL,GAAa,KAAK1C,KAAL,CAAWC,KAAxB;OACA0D,2BAAY,CAACwc,+BAAb;OACA,KAAK9e,eAAL,CAAqB+e,cAArB;OACA,KAAKla,KAAL;MAfF,EAiBEwJ,QAAD,IAAc;OACb,KAAKhF,aAAL;OACA,KAAKhI,KAAL,GAAa,KAAK1C,KAAL,CAAWG,KAAxB;OACA,KAAK+F,KAAL;MApBF;KAuBA,OAAO,IAAP;;;CA39DF;CADatG,iBAELyE,YAAY;CAFPzE,iBAGL0C,YAAY;CAHP1C,iBAILqQ,WAAW;;;;;;;;"}