{"version":3,"file":"compacteventform.bundle.js","sources":["../src/compacteventform.js"],"sourcesContent":["// @flow\nimport {Type, Tag, Loc, Dom, Event, Runtime, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Util} from 'calendar.util';\nimport {Popup, PopupManager} from 'main.popup';\nimport {\n\tDateTimeControl,\n\tLocation,\n\tReminder,\n\tSectionSelector,\n\tUserPlannerSelector,\n\tColorSelector,\n\tBusyUsersDialog\n} from \"calendar.controls\";\nimport {Entry, EntryManager} from \"calendar.entry\";\nimport {SectionManager} from \"calendar.sectionmanager\";\nimport {MobileSyncBanner} from \"calendar.sync.interface\";\n\nexport class CompactEventForm extends EventEmitter\n{\n\tstatic VIEW_MODE = 'view';\n\tstatic EDIT_MODE = 'edit';\n\tstatic USER_URL = '/company/personal/user/#USER_ID#/';\n\tSTATE = {READY: 1, REQUEST: 2, ERROR: 3};\n\tzIndex = 1200;\n\tZ_INDEX_OFFSET = -1000;\n\tuserSettings = '';\n\tDOM = {};\n\tmode;\n\tdisplayed = false;\n\tsections = [];\n\tsectionIndex = {};\n\ttrackingUsersList = [];\n\tcheckDataBeforeCloseMode = true;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.CompactEventForm');\n\t\tthis.userId = options.userId || Util.getCurrentUserId();\n\t\tthis.type = options.type || 'user';\n\t\tthis.isLocationCalendar = options.isLocationCalendar || false;\n\t\tthis.calendarContext = options.calendarContext || null;\n\t\tthis.ownerId = options.ownerId || this.userId;\n\t\tthis.BX = Util.getBX();\n\n\t\tthis.checkForChanges = Runtime.debounce(this.checkForChangesImmediately, 300, this);\n\t\tthis.checkOutsideClickClose = this.checkOutsideClickClose.bind(this);\n\t\tthis.outsideMouseDownClose = this.outsideMouseDownClose.bind(this);\n\t\tthis.keyHandler = this.handleKeyPress.bind(this);\n\t}\n\n\tshow(mode = CompactEventForm.EDIT_MODE, params ={})\n\t{\n\t\tthis.setParams(params);\n\t\tthis.setMode(mode);\n\n\t\tthis.state = this.STATE.READY;\n\n\t\tthis.popupId = 'compact-event-form-' + Math.round(Math.random() * 100000);\n\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.destroy();\n\t\t}\n\t\tthis.popup = this.getPopup(params);\n\n\t\t// Small hack to use transparent titlebar to drag&drop popup\n\t\tDom.addClass(this.popup.titleBar, 'calendar-add-popup-titlebar');\n\t\tDom.removeClass(this.popup.popupContainer, 'popup-window-with-titlebar');\n\t\tDom.removeClass(this.popup.closeIcon, 'popup-window-titlebar-close-icon');\n\t\tEvent.bind(document, \"mousedown\", this.outsideMouseDownClose);\n\t\tEvent.bind(document, \"mouseup\", this.checkOutsideClickClose);\n\t\tEvent.bind(document, \"keydown\", this.keyHandler);\n\t\tEvent.bind(this.popup.popupContainer, 'transitionend', ()=>{Dom.removeClass(this.popup.popupContainer, 'calendar-simple-view-popup-show');});\n\n\t\t// Fulfill previous deletions to avoid data inconsistency\n\t\tif (this.getMode() === CompactEventForm.EDIT_MODE)\n\t\t{\n\t\t\tEntryManager.doDelayedActions();\n\t\t}\n\n\t\tthis.prepareData()\n\t\t\t.then(()=>{\n\t\t\t\tif (this.checkLocationView())\n\t\t\t\t{\n\t\t\t\t\tthis.setFormValuesLocation();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.setFormValues();\n\t\t\t\t}\n\n\t\t\t\tthis.popup.show();\n\n\t\t\t\tthis.checkDataBeforeCloseMode = true;\n\t\t\t\tif (this.canDo('edit') && this.DOM.titleInput && mode === CompactEventForm.EDIT_MODE)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.titleInput.focus();\n\t\t\t\t\tthis.DOM.titleInput.select();\n\t\t\t\t}\n\n\t\t\t\tthis.displayed = true;\n\n\t\t\t\tif (this.getMode() === CompactEventForm.VIEW_MODE)\n\t\t\t\t{\n\t\t\t\t\tUtil.sendAnalyticLabel({calendarAction: 'view_event', formType: 'compact'});\n\t\t\t\t\tthis.popup.getButtons()[0].button.focus();\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tthis.getMode() === CompactEventForm.EDIT_MODE\n\t\t\t\t\t&& !this.userPlannerSelector.isPlannerDisplayed()\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.userPlannerSelector.checkBusyTime()\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tcheckLocationView()\n\t{\n\t\treturn this.getMode() === CompactEventForm.VIEW_MODE && this.type === 'location'\n\t}\n\n\tgetPopup(params)\n\t{\n\t\treturn new Popup(this.popupId,\n\t\t\tparams.bindNode,\n\t\t\t{\n\t\t\t\tzIndex: this.zIndex + this.Z_INDEX_OFFSET,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tcloseIcon: true,\n\t\t\t\ttitleBar: true,\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tclassName: 'calendar-simple-view-popup calendar-simple-view-popup-show',\n\t\t\t\tcacheable: false,\n\t\t\t\tcontent: this.checkLocationView()\n\t\t\t\t\t? this.getPopupContentLocation()\n\t\t\t\t\t: this.getPopupContentCalendar(),\n\t\t\t\tbuttons: this.getButtons(),\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: this.close.bind(this)\n\t\t\t\t},\n\t\t\t});\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.displayed;\n\t}\n\n\tclose()\n\t{\n\t\tif (this.getMode() === CompactEventForm.EDIT_MODE\n\t\t\t&& this.formDataChanged()\n\t\t\t&& this.checkDataBeforeCloseMode\n\t\t\t&& !confirm(Loc.getMessage('EC_SAVE_ENTRY_CONFIRM')))\n\t\t{\n\t\t\t// Workaround to prevent form closing even if user don't want to and presses \"cancel\" in confirm\n\t\t\tif (this.popup)\n\t\t\t{\n\t\t\t\tthis.popup.destroyed = true;\n\t\t\t\tsetTimeout(() => {this.popup.destroyed = false;}, 0);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tthis.displayed = false;\n\t\tthis.emit('onClose');\n\t\tEvent.unbind(document, \"mousedown\", this.outsideMouseDownClose);\n\t\tEvent.unbind(document, \"mouseup\", this.checkOutsideClickClose);\n\t\tEvent.unbind(document, \"keydown\", this.keyHandler);\n\n\t\tif (this.userPlannerSelector)\n\t\t{\n\t\t\tthis.userPlannerSelector.destroy();\n\t\t}\n\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.destroy();\n\t\t}\n\n\t\tif (Location)\n\t\t{\n\t\t\tLocation.setCurrentCapacity(0);\n\t\t}\n\t\tUtil.clearPlannerWatches();\n\t\tUtil.closeAllPopups();\n\t}\n\n\tgetPopupContentCalendar()\n\t{\n\t\tthis.DOM.wrap = Tag.render`<div class=\"calendar-add-popup-wrap\">\n\t\t\t${this.DOM.titleOuterWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-container calendar-field-container-string-select\">\n\t\t\t\t<div class=\"calendar-field-block\">\n\t\t\t\t\t${this.getTitleControl()}\n\t\t\t\t\t${this.getColorControl()}\n\t\t\t\t</div>\n\t\t\t</div>`}\n\t\t\t<div class=\"calendar-field-container calendar-field-container-choice\">\n\t\t\t\t${this.getSectionControl()}\n\t\t\t</div>\n\n\t\t\t${this.getDateTimeControl()}\n\n\t\t\t${this.getUserPlannerSelector()}\n\n\t\t\t<div class=\"calendar-field-container calendar-field-container-info\">\n\t\t\t\t${this.getTypeInfoControl()}\n\n\t\t\t\t\t${this.getLocationControl()}\n\n\t\t\t\t${this.DOM.remindersOuterWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-field-block\">\n\t\t\t\t\t<div class=\"calendar-field-title\">${Loc.getMessage('EC_REMIND_LABEL')}:</div>\n\t\t\t\t\t${this.createRemindersControl()}\n\t\t\t\t</div>`}\n\t\t\t\t${this.getRRuleInfoControl()}\n\t\t\t</div>\n\t\t</div>`;\n\n\t\treturn this.DOM.wrap;\n\t}\n\n\tgetPopupContentLocation()\n\t{\n\t\tthis.DOM.wrap = Tag.render`<div class=\"calendar-add-popup-wrap\">\n\t\t\t${this.DOM.titleOuterWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-container calendar-field-container-string-select\">\n\t\t\t\t<div class=\"calendar-field-block\">\n\t\t\t\t\t${this.getTitleControlLocation()}\n\t\t\t\t\t${this.getColorControlsLocationView()}\n\t\t\t\t</div>\n\t\t\t</div>`}\n\t\t\t<div class=\"calendar-field-container calendar-field-container-choice\">\n\t\t\t\t${this.getLocationSectionControls()}\n\t\t\t</div>\n\t\t\t${this.getDateTimeControl()}\n\t\t\t\n\t\t</div>`;\n\t\tif (this.entry.id !== this.entry.parentId)\n\t\t{\n\t\t\tthis.DOM.wrap.appendChild(Tag.render`\n\t\t\t\t${this.getHostControl()}\n\t\t\t`);\n\t\t}\n\n\t\treturn this.DOM.wrap;\n\t}\n\n\tgetButtons()\n\t{\n\t\tlet buttons = [];\n\t\tconst mode = this.getMode();\n\n\t\tif (mode === CompactEventForm.EDIT_MODE)\n\t\t{\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\tname: 'save',\n\t\t\t\t\ttext : (this.isNewEntry()\n\t\t\t\t\t\t? Loc.getMessage('CALENDAR_EVENT_DO_ADD')\n\t\t\t\t\t\t: Loc.getMessage('CALENDAR_EVENT_DO_SAVE')),\n\t\t\t\t\tclassName: \"ui-btn ui-btn-primary\",\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\tthis.save();\n\t\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t);\n\n\t\t\t// For testing purposes\n\t\t\tif (Type.isElementNode(buttons[0].button))\n\t\t\t{\n\t\t\t\tbuttons[0].button.setAttribute('data-role', 'saveButton');\n\t\t\t}\n\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_CANCEL'),\n\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\tif (this.isNewEntry())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.setFormValues();\n\n\t\t\t\t\t\t\t\tif (this.userPlannerSelector)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.userPlannerSelector.destroy();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tthis.setMode(CompactEventForm.VIEW_MODE);\n\t\t\t\t\t\t\t\tthis.popup.setButtons(this.getButtons());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_FULL_FORM'),\n\t\t\t\t\tclassName: \"ui-btn calendar-full-form-btn\",\n\t\t\t\t\tevents : {click : this.editEntryInSlider.bind(this)}\n\t\t\t\t})\n\t\t\t);\n\t\t\t//sideButton = true;\n\n\t\t\t// if (!this.isNewEntry() && this.canDo('delete'))\n\t\t\t// {\n\t\t\t// \tbuttons.push(\n\t\t\t// \t\tnew BX.UI.Button({\n\t\t\t// \t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_DELETE'),\n\t\t\t// \t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t// \t\t\tevents : {click : ()=>{\n\t\t\t// \t\t\t\tEntryManager.deleteEntry(this.entry);\n\t\t\t// \t\t\t}}\n\t\t\t// \t\t})\n\t\t\t// \t);\n\t\t\t// }\n\t\t}\n\t\telse if (mode === CompactEventForm.VIEW_MODE)\n\t\t{\n\t\t\tif (this.entry.isMeeting()\n\t\t\t\t&& this.entry.getCurrentStatus() === 'Q')\n\t\t\t{\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\tclassName: \"ui-btn ui-btn-primary\",\n\t\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_Y'),\n\t\t\t\t\t\tevents : {click : ()=>{\n\t\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'Y')\n\t\t\t\t\t\t\t\t\t.then(this.refreshMeetingStatus.bind(this));\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_N'),\n\t\t\t\t\t\tevents : {click : ()=>{\n\t\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'N')\n\t\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\t\tif (this.isShown())\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (this.checkLocationView())\n\t\t\t{\n\t\t\t\tif (this.entry.id !== this.entry.parentId)\n\t\t\t\t{\n\t\t\t\t\tbuttons.push(\n\t\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\t\tclassName: `ui-btn ${this.entry.isMeeting() && this.entry.getCurrentStatus() === 'Q' ? 'ui-btn-link' : 'ui-btn-primary'}`,\n\t\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_OPEN_PARENT'),\n\t\t\t\t\t\t\tevents : {click : ()=>{\n\t\t\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\t\t\tBX.Calendar.EntryManager.openViewSlider(\n\t\t\t\t\t\t\t\t\t\tthis.entry.parentId,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\t\t\t\t\tfrom: this.entry.from,\n\t\t\t\t\t\t\t\t\t\t\ttimezoneOffset: this.entry && this.entry.data ? this.entry.data.TZ_OFFSET_FROM : null\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbuttons.push(\n\t\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\t\tclassName: `ui-btn ui-btn-disabled`,\n\t\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_UPDATE_PROGRESS'),\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\tclassName: `ui-btn ${this.entry.isMeeting() && this.entry.getCurrentStatus() === 'Q' ? 'ui-btn-link' : 'ui-btn-primary'}`,\n\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_OPEN'),\n\t\t\t\t\t\tevents : {click : ()=>{\n\t\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\t\tBX.Calendar.EntryManager.openViewSlider(\n\t\t\t\t\t\t\t\t\tthis.entry.id,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tentry: this.entry,\n\t\t\t\t\t\t\t\t\t\tcalendarContext: this.calendarContext,\n\t\t\t\t\t\t\t\t\t\ttype: this.type,\n\t\t\t\t\t\t\t\t\t\townerId: this.ownerId,\n\t\t\t\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\t\t\t\tfrom: this.entry.from,\n\t\t\t\t\t\t\t\t\t\ttimezoneOffset: this.entry && this.entry.data ? this.entry.data.TZ_OFFSET_FROM : null\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\n\t\t\t// For testing purposes\n\t\t\tif (Type.isElementNode(buttons[buttons.length - 1].button))\n\t\t\t{\n\t\t\t\tbuttons[buttons.length - 1].button.setAttribute('data-role', 'openButton');\n\t\t\t}\n\n\t\t\tif (this.entry.isMeeting()\n\t\t\t\t&& this.entry.getCurrentStatus() === 'N')\n\t\t\t{\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_Y'),\n\t\t\t\t\t\tevents : {click : ()=>{\n\t\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'Y')\n\t\t\t\t\t\t\t\t\t.then(this.refreshMeetingStatus.bind(this));\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.entry.isMeeting()\n\t\t\t\t&& this.entry.getCurrentStatus() === 'Y')\n\t\t\t{\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_N'),\n\t\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'N')\n\t\t\t\t\t\t\t\t\t.then(this.refreshMeetingStatus.bind(this));\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (!this.isNewEntry() && this.canDo('edit') && this.type !== 'location')\n\t\t\t{\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_EDIT'),\n\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\tevents : {click : this.editEntryInSlider.bind(this)}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (!this.isNewEntry() && this.canDo('delete') && this.entry.getCurrentStatus() === 'H' && !this.checkLocationView())\n\t\t\t{\n\t\t\t\tif (!this.entry.isMeeting()\n\t\t\t\t\t|| !this.entry.getCurrentStatus()\n\t\t\t\t\t|| this.entry.getCurrentStatus() === 'H')\n\t\t\t\t{\n\t\t\t\t\tbuttons.push(\n\t\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_DELETE'),\n\t\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\t\tevents : {click : ()=>{\n\t\t\t\t\t\t\t\t\tEventEmitter.subscribeOnce('BX.Calendar.Entry:beforeDelete', ()=>{\n\t\t\t\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tEntryManager.deleteEntry(this.entry);\n\n\t\t\t\t\t\t\t\t\tif (!this.entry.wasEverRecursive())\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (buttons.length > 2)\n\t\t{\n\t\t\tbuttons[1].button.className = \"ui-btn ui-btn-light-border\";\n\t\t}\n\n\t\treturn buttons;\n\t}\n\n\tfreezePopup()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.buttons.forEach((button) => {\n\t\t\t\tif (button?.options?.name === 'save')\n\t\t\t\t{\n\t\t\t\t\tbutton.setClocking(true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbutton.setDisabled(true);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tunfreezePopup()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.buttons.forEach((button) => {\n\t\t\t\tbutton.setClocking(false);\n\t\t\t\tbutton.setDisabled(false);\n\t\t\t});\n\t\t}\n\t}\n\n\trefreshMeetingStatus()\n\t{\n\t\tthis.emit('doRefresh');\n\t\tthis.popup.setButtons(this.getButtons());\n\t\tif (this.userPlannerSelector)\n\t\t{\n\t\t\tthis.userPlannerSelector.displayAttendees(this.entry.getAttendees());\n\t\t}\n\t}\n\n\thideLoader()\n\t{\n\t\tif (Type.isDomNode(this.DOM.loader))\n\t\t{\n\t\t\tDom.remove(this.DOM.loader);\n\t\t\tthis.DOM.loader = null;\n\t\t}\n\t}\n\n\tshowInEditMode(params = {})\n\t{\n\t\treturn this.show(CompactEventForm.EDIT_MODE, params);\n\t}\n\n\tshowInViewMode(params = {})\n\t{\n\t\treturn this.show(CompactEventForm.VIEW_MODE, params);\n\t}\n\n\tsetMode(mode)\n\t{\n\t\tif (mode === 'edit' || mode === 'view')\n\t\t{\n\t\t\tthis.mode = mode;\n\t\t}\n\t}\n\n\tgetMode()\n\t{\n\t\treturn this.mode;\n\t}\n\n\tcheckForChangesImmediately()\n\t{\n\t\tif (!this.isNewEntry()\n\t\t\t&& this.getMode() === CompactEventForm.VIEW_MODE\n\t\t\t&& this.formDataChanged())\n\t\t{\n\t\t\tthis.setMode(CompactEventForm.EDIT_MODE);\n\t\t\tthis.popup.setButtons(this.getButtons());\n\t\t}\n\t\telse if (!this.isNewEntry()\n\t\t\t&& this.getMode() === CompactEventForm.EDIT_MODE\n\t\t\t&& !this.formDataChanged())\n\t\t{\n\t\t\tthis.setMode(CompactEventForm.VIEW_MODE);\n\t\t\tthis.popup.setButtons(this.getButtons());\n\t\t}\n\t\tthis.emitOnChange();\n\t}\n\n\tcheckLocationForm(event)\n\t{\n\t\tif (event && event instanceof BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tconst usersCount = data.usersCount;\n\n\t\t\tlet locationCapacity = Location.getCurrentCapacity() || 0;\n\n\t\t\tif (this.locationSelector.value.type === undefined)\n\t\t\t{\n\t\t\t\tif (locationCapacity)\n\t\t\t\t{\n\t\t\t\t\tlocationCapacity = 0;\n\t\t\t\t\tLocation.setCurrentCapacity(0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (locationCapacity < usersCount && locationCapacity !== 0)\n\t\t\t{\n\t\t\t\tthis.locationSelector.addCapacityAlert();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.locationSelector.removeCapacityAlert();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFormDataChanges(excludes = [])\n\t{\n\t\tconst entry = this.entry;\n\t\tlet fields = [];\n\n\t\t// Name\n\t\tif (!excludes.includes('name')\n\t\t\t&& entry.name !== this.DOM.titleInput.value)\n\t\t{\n\t\t\tfields.push('name');\n\t\t}\n\n\t\t// Location\n\t\tif (!excludes.includes('location')\n\t\t\t&&\n\t\t\tthis.locationSelector.getTextLocation(Location.parseStringValue(entry.getLocation()))\n\t\t\t!==\n\t\t\tthis.locationSelector.getTextLocation(Location.parseStringValue(this.locationSelector.getTextValue()))\n\t\t)\n\t\t{\n\t\t\tfields.push('location');\n\t\t}\n\n\t\t// Date + time\n\t\tconst dateTime = this.dateTimeControl.getValue();\n\t\tif (!excludes.includes('date&time')\n\t\t\t&&\n\t\t\t(entry.isFullDay() !== dateTime.fullDay\n\t\t\t\t|| dateTime.from.toString() !== entry.from.toString()\n\t\t\t\t|| dateTime.to.toString() !== entry.to.toString()))\n\t\t{\n\t\t\tfields.push('date&time');\n\t\t}\n\n\t\t// Notify\n\t\tif (!excludes.includes('notify')\n\t\t\t&&\n\t\t\t(!entry.isMeeting() || entry.getMeetingNotify())\n\t\t\t!== this.userPlannerSelector.getInformValue())\n\t\t{\n\t\t\tfields.push('notify');\n\t\t}\n\n\t\t// Section\n\t\tif (!excludes.includes('section')\n\t\t\t&&\n\t\t\tparseInt(entry.sectionId) !== parseInt(this.sectionValue))\n\t\t{\n\t\t\tfields.push('section');\n\t\t}\n\n\t\t// Access codes\n\t\tif (!excludes.includes('codes')\n\t\t\t&&\n\t\t\tthis.userPlannerSelector.getEntityList().map((item)=>{return item.entityId + ':' + item.id}).join('|')\n\t\t\t!==\n\t\t\tentry.getAttendeesEntityList().map((item)=>{return item.entityId + ':' + item.id}).join('|')\n\t\t)\n\t\t{\n\t\t\tfields.push('codes');\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\tformDataChanged()\n\t{\n\t\treturn this.getFormDataChanges().length > 0;\n\t}\n\n\tsetParams(params = {})\n\t{\n\t\tthis.userId = params.userId || Util.getCurrentUserId();\n\t\tthis.type = params.type || 'user';\n\t\tthis.isLocationCalendar = params.isLocationCalendar || false;\n\t\tthis.locationAccess = params.locationAccess || false;\n\t\tthis.dayOfWeekMonthFormat = params.dayOfWeekMonthFormat || false;\n\t\tthis.calendarContext = params.calendarContext || null;\n\t\tthis.ownerId = params.ownerId ? params.ownerId : 0;\n\t\tif (this.type === 'user' && !this.ownerId)\n\t\t{\n\t\t\tthis.ownerId = this.userId;\n\t\t}\n\t\tthis.entry = EntryManager.getEntryInstance(params.entry, params.userIndex, {type: this.type, ownerId: this.ownerId});\n\t\tthis.sectionValue = null;\n\n\t\tif (!this.entry.id\n\t\t\t&& Type.isPlainObject(params.entryTime)\n\t\t\t&& Type.isDate(params.entryTime.from)\n\t\t\t&& Type.isDate(params.entryTime.to)\n\t\t)\n\t\t{\n\t\t\tthis.entry.setDateTimeValue(params.entryTime);\n\t\t}\n\n\t\tif (Type.isPlainObject(params.userSettings))\n\t\t{\n\t\t\tthis.userSettings = params.userSettings;\n\t\t}\n\n\t\tthis.locationFeatureEnabled = !!params.locationFeatureEnabled;\n\t\tthis.locationList = params.locationList || [];\n\t\tthis.roomsManager = params.roomsManager || null;\n\t\tthis.iblockMeetingRoomList = params.iblockMeetingRoomList || [];\n\n\t\tthis.plannerFeatureEnabled = !!params.plannerFeatureEnabled;\n\n\t\tthis.setSections(params.sections, params.trackingUserList)\n\t}\n\n\tsetSections(sections, trackingUsersList = [])\n\t{\n\t\tthis.sections = sections;\n\t\tthis.sectionIndex = {};\n\t\tthis.trackingUsersList = trackingUsersList || [];\n\n\t\tif (Type.isArray(sections))\n\t\t{\n\t\t\tsections.forEach((value, ind) => {\n\t\t\t\tconst id = parseInt(value.ID || value.id);\n\t\t\t\tif (id > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.sectionIndex[id] = ind;\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\t}\n\n\tprepareData(params = {})\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst section = this.getCurrentSection();\n\t\t\tif (section && section.canDo)\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.getCompactFormData', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tentryId: this.entry.id,\n\t\t\t\t\t\tloadSectionId: this.entry.sectionId\n\t\t\t\t\t}\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tif (response && response.data && response.data.section)\n\t\t\t\t\t{\n\t\t\t\t\t\t// todo: refactor this part to new Section entities\n\t\t\t\t\t\tthis.sections.push(new window.BXEventCalendar.Section(Util.getCalendarContext(), response.data.section));\n\t\t\t\t\t\tthis.setSections(this.sections);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tgetTitleControl()\n\t{\n\t\tthis.DOM.titleInput = Tag.render`\n\t\t\t<input class=\"calendar-field calendar-field-string\"\n\t\t\t\tvalue=\"\"\n\t\t\t\tplaceholder=\"${Loc.getMessage('EC_ENTRY_NAME')}\"\n\t\t\t\ttype=\"text\"\n\t\t\t/>\n\t\t`;\n\n\t\tEvent.bind(this.DOM.titleInput, 'keyup', this.checkForChanges);\n\t\tEvent.bind(this.DOM.titleInput, 'change', this.checkForChanges);\n\n\t\treturn this.DOM.titleInput;\n\t}\n\n\tgetTitleControlLocation()\n\t{\n\t\tthis.DOM.titleInput = Tag.render`\n\t\t\t<input class=\"calendar-field calendar-field-string\"\n\t\t\t\tvalue=\"\"\n\t\t\t\tplaceholder=\"${Loc.getMessage('EC_ENTRY_NAME')}\"\n\t\t\t\ttype=\"text\"\n\t\t\t\treadonly\n\t\t\t/>\n\t\t`;\n\n\t\treturn this.DOM.titleInput;\n\t}\n\n\tgetHostControl()\n\t{\n\t\tconst userId = this.entry.data.CREATED_BY;\n\t\tconst userUrl = CompactEventForm.USER_URL.replace('#USER_ID#', userId);\n\t\tconst userAvatar = this.BX.Calendar.EntryManager.userIndex[userId]\n\t\t\t? this.BX.Calendar.EntryManager.userIndex[userId].AVATAR\n\t\t\t: '';\n\n\t\tthis.DOM.hostBar = Tag.render`\n\t\t\t<div class=\"calendar-slider-detail-option-without-border\">\n\t\t\t\t<div class=\"calendar-slider-detail-option-block\">\n\t\t\t\t\t<div class=\"calendar-field-value\">\n\t\t\t\t\t\t${Loc.getMessage('EC_HOST') + ': '}\n\t\t\t\t\t</div>\n\t\t\t\t\t<span class=\"calendar-field-location-host-img\">\n\t\t\t\t\t\t<a href=\"${userUrl}\">\n\t\t\t\t\t\t\t<img class=\"calendar-field-location-host-img-value\" src=\"${userAvatar}\">\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class=\"calendar-slider-detail-option-value\">\n\t\t\t\t\t\t<a href=\"${userUrl}\" class=\"calendar-slider-sidebar-user-info-name calendar-slider-sidebar-user-info-name-padding\">${BX.util.htmlspecialchars(this.entry.name)}</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\treturn this.DOM.hostBar;\n\t}\n\n\tgetColorControl()\n\t{\n\t\tthis.DOM.colorSelect = Tag.render`<div class=\"calendar-field calendar-field-select calendar-field-tiny\"></div>`;\n\t\tthis.colorSelector = new ColorSelector({\n\t\t\twrap: this.DOM.colorSelect,\n\t\t\tmode: 'selector'\n\t\t});\n\n\t\tthis.colorSelector.subscribe('onChange', (event) => {\n\t\t\tif (event instanceof BaseEvent)\n\t\t\t{\n\t\t\t\tconst color = event.getData().value;\n\t\t\t\tif (!this.isNewEntry()\n\t\t\t\t\t&& (this.canDo('edit')\n\t\t\t\t\t\t|| this.entry.getCurrentStatus() !== false))\n\t\t\t\t{\n\t\t\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.updateColor', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tentryId: this.entry.id,\n\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\tcolor: color\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.entry.data.COLOR = color;\n\n\t\t\t\t\tthis.emit('doRefresh');\n\t\t\t\t\tthis.emitOnChange();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\n\t\treturn this.DOM.colorSelect;\n\t}\n\n\tgetColorControlsLocationView()\n\t{\n\t\tthis.DOM.colorSelect = Tag.render`<div class=\"calendar-field calendar-field-select calendar-colorpicker-readonly calendar-field-tiny\"></div>`;\n\t\tthis.colorSelector = new ColorSelector({\n\t\t\twrap: this.DOM.colorSelect,\n\t\t\tmode: 'view'\n\t\t});\n\t\treturn this.DOM.colorSelect;\n\t}\n\n\tgetSectionControl()\n\t{\n\t\tthis.DOM.sectionSelectWrap = Tag.render`<div class=\"calendar-field-choice-calendar\"></div>`;\n\t\tthis.sectionSelector = new SectionSelector({\n\t\t\touterWrap: this.DOM.sectionSelectWrap,\n\t\t\tdefaultCalendarType: this.type,\n\t\t\tdefaultOwnerId: this.ownerId,\n\t\t\tsectionList: this.sections,\n\t\t\tsectionGroupList: SectionManager.getSectionGroupList({\n\t\t\t\ttype: this.type,\n\t\t\t\townerId: this.ownerId,\n\t\t\t\tuserId: this.userId,\n\t\t\t\ttrackingUsersList: this.trackingUsersList,\n\t\t\t}),\n\t\t\tmode: 'textselect',\n\t\t\tzIndex: this.zIndex,\n\t\t\tgetCurrentSection: ()=>{\n\t\t\t\tlet section = this.getCurrentSection();\n\t\t\t\tif (section)\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: section.id,\n\t\t\t\t\t\tname: section.name,\n\t\t\t\t\t\tcolor: section.color\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tselectCallback: (sectionValue) => {\n\t\t\t\tif (sectionValue)\n\t\t\t\t{\n\t\t\t\t\tif (this.colorSelector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.colorSelector.setValue(sectionValue.color);\n\t\t\t\t\t}\n\t\t\t\t\tthis.sectionValue = sectionValue.id;\n\t\t\t\t\tthis.checkForChanges();\n\n\t\t\t\t\tSectionManager.saveDefaultSectionId(this.sectionValue);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn this.DOM.sectionSelectWrap;\n\t}\n\n\tgetLocationSectionControls()\n\t{\n\t\tthis.DOM.sectionSelectWrap = Tag.render`<div class=\"calendar-field-choice-calendar\"></div>`;\n\t\tthis.sectionSelector = new SectionSelector({\n\t\t\touterWrap: this.DOM.sectionSelectWrap,\n\t\t\tdefaultCalendarType: this.type,\n\t\t\tdefaultOwnerId: this.ownerId,\n\t\t\tsectionList: this.sections,\n\t\t\tsectionGroupList: SectionManager.getSectionGroupList({\n\t\t\t\ttype: this.type,\n\t\t\t\townerId: this.ownerId,\n\t\t\t\tuserId: this.userId,\n\t\t\t\ttrackingUsersList: this.trackingUsersList,\n\t\t\t}),\n\t\t\tmode: 'location',\n\t\t\tzIndex: this.zIndex,\n\t\t\tgetCurrentSection: ()=>{\n\t\t\t\tlet section = this.getCurrentSection();\n\t\t\t\tif (section)\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: section.id,\n\t\t\t\t\t\tname: section.name,\n\t\t\t\t\t\tcolor: section.color\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t});\n\n\t\treturn this.DOM.sectionSelectWrap;\n\t}\n\n\tgetDateTimeControl()\n\t{\n\t\tthis.DOM.dateTimeWrap = Tag.render`<div class=\"calendar-field-container calendar-field-container-datetime\"></div>`;\n\n\t\tthis.dateTimeControl = new DateTimeControl(null, {\n\t\t\tshowTimezone: false,\n\t\t\touterWrap: this.DOM.dateTimeWrap,\n\t\t\tinlineEditMode: true\n\t\t});\n\n\t\tthis.dateTimeControl.subscribe('onChange', (event) => {\n\t\t\tif (event instanceof BaseEvent)\n\t\t\t{\n\t\t\t\tlet value = event.getData().value;\n\t\t\t\tif (this.remindersControl)\n\t\t\t\t{\n\t\t\t\t\tthis.remindersControl.setFullDayMode(value.fullDay);\n\n\t\t\t\t\tif (this.isNewEntry() && !this.remindersControl.wasChangedByUser())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst defaultReminders = EntryManager.getNewEntryReminders(\n\t\t\t\t\t\t\tvalue.fullDay ? 'fullDay' : 'withTime'\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tthis.remindersControl.setValue(defaultReminders, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.userPlannerSelector)\n\t\t\t\t{\n\t\t\t\t\tif (!this.userPlannerSelector.isPlannerDisplayed())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userPlannerSelector.showPlanner();\n\t\t\t\t\t}\n\t\t\t\t\tthis.userPlannerSelector.setLocationValue(this.locationSelector.getTextValue());\n\t\t\t\t\tthis.userPlannerSelector.setDateTime(value, true);\n\t\t\t\t\tthis.userPlannerSelector.refreshPlanner();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (this.locationSelector)\n\t\t\t\t{\n\t\t\t\t\tthis.locationSelector.checkLocationAccessibility(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfrom: event.getData().value.from,\n\t\t\t\t\t\t\tto: event.getData().value.to,\n\t\t\t\t\t\t\tfullDay: event.getData().value.fullDay,\n\t\t\t\t\t\t\tcurrentEventId: this.entry.id\n\t\t\t\t\t\t},\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.checkForChanges();\n\t\t\t}\n\t\t});\n\n\t\treturn this.DOM.dateTimeWrap;\n\t}\n\n\tgetUserPlannerSelector()\n\t{\n\t\tthis.DOM.userPlannerSelectorOuterWrap = Tag.render`<div>\n\t\t\t<div class=\"calendar-field-container calendar-field-container-members\">\n\t\t\t\t${this.DOM.userSelectorWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-field-block\">\n\t\t\t\t\t<div class=\"calendar-members-selected\">\n\t\t\t\t\t\t<span class=\"calendar-attendees-label\"></span>\n\t\t\t\t\t\t<span class=\"calendar-attendees-list\"></span>\n\t\t\t\t\t\t<span class=\"calendar-members-more\">${Loc.getMessage('EC_ATTENDEES_MORE')}</span>\n\t\t\t\t\t\t<span class=\"calendar-members-change-link\">${Loc.getMessage('EC_SEC_SLIDER_CHANGE')}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`}\n\t\t\t\t<span class=\"calendar-videocall-wrap calendar-videocall-hidden\"></span>\n\t\t\t\t${this.DOM.informWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-field-container-inform\">\n\t\t\t\t\t<span class=\"calendar-field-container-inform-text\">${Loc.getMessage('EC_NOTIFY_OPTION')}</span>\n\t\t\t\t</div>`}\n\t\t\t</div>\n\t\t\t<div class=\"calendar-user-selector-wrap\"></div>\n\t\t\t<div class=\"calendar-add-popup-planner-wrap calendar-add-popup-show-planner\">\n\t\t\t\t${this.DOM.plannerOuterWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-planner-wrapper\" style=\"height: 0\">\n\t\t\t\t</div>`}\n\t\t\t</div>\n\t\t\t${this.DOM.hideGuestsWrap = Tag.render`\n\t\t\t<div class=\"calendar-hide-members-container\" style=\"display: none;\">\n\t\t\t\t<div class=\"calendar-hide-members-container-inner\">\n\t\t\t\t\t<div class=\"calendar-hide-members-icon-hidden\"></div>\n\t\t\t\t\t<div class=\"calendar-hide-members-text\">${Loc.getMessage('EC_HIDE_GUEST_NAMES')}</div>\n\t\t\t\t\t<span class=\"calendar-hide-members-helper\" data-hint=\"${Loc.getMessage('EC_HIDE_GUEST_NAMES_HINT')}\"></span>\n\t\t\t\t</div>\n\t\t\t</div>`}\n\t\t<div>`;\n\n\t\tthis.userPlannerSelector = new UserPlannerSelector({\n\t\t\touterWrap: this.DOM.userPlannerSelectorOuterWrap,\n\t\t\twrap: this.DOM.userSelectorWrap,\n\t\t\tinformWrap: this.DOM.informWrap,\n\t\t\tplannerOuterWrap: this.DOM.plannerOuterWrap,\n\t\t\thideGuestsWrap: this.DOM.hideGuestsWrap,\n\t\t\treadOnlyMode: false,\n\t\t\tuserId: this.userId,\n\t\t\ttype: this.type,\n\t\t\townerId: this.ownerId,\n\t\t\tzIndex: this.zIndex + 10,\n\t\t\tplannerFeatureEnabled: this.plannerFeatureEnabled,\n\t\t\tdayOfWeekMonthFormat: this.dayOfWeekMonthFormat\n\t\t});\n\n\t\tthis.userPlannerSelector.subscribe('onDateChange', this.handlePlannerSelectorChanges.bind(this));\n\t\tthis.userPlannerSelector.subscribe('onNotifyChange', this.checkForChanges);\n\t\t// this.subscribe('onLoad', this.userPlannerSelector.checkEmployment.bind(this.userPlannerSelector));\n\t\tthis.userPlannerSelector.subscribe('onUserCodesChange', this.checkForChanges);\n\n\t\treturn this.DOM.userPlannerSelectorOuterWrap;\n\t}\n\n\tgetLocationControl()\n\t{\n\t\tthis.DOM.locationWrap = Tag.render`<div class=\"calendar-field-place\"></div>`;\n\t\tthis.DOM.locationOuterWrap = Tag.render`<div class=\"calendar-field-block\">\n\t\t\t<div class=\"calendar-field-title calendar-field-title-align-top\">${Loc.getMessage('EC_LOCATION_LABEL')}:</div>\n\t\t\t${this.DOM.locationWrap}\n\t\t</div>`;\n\n\t\tthis.locationSelector = new Location(\n\t\t\t{\n\t\t\t\twrap: this.DOM.locationWrap,\n\t\t\t\trichLocationEnabled: this.locationFeatureEnabled,\n\t\t\t\tlocationList: this.locationList || [],\n\t\t\t\troomsManager: this.roomsManager || null,\n\t\t\t\tlocationAccess: this.locationAccess || false,\n\t\t\t\tiblockMeetingRoomList: this.iblockMeetingRoomList || [],\n\t\t\t\tinlineEditModeEnabled: !this.isLocationCalendar,\n\t\t\t\tonChangeCallback: () => {\n\t\t\t\t\tif (this.userPlannerSelector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userPlannerSelector.setLocationValue(this.locationSelector.getTextValue());\n\t\t\t\t\t\tif (this.locationSelector.getValue().type !== undefined\n\t\t\t\t\t\t\t&& !this.userPlannerSelector.isPlannerDisplayed())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.userPlannerSelector.showPlanner();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.userPlannerSelector.refreshPlanner();\n\t\t\t\t\t}\n\t\t\t\t\tthis.checkForChanges();\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tif (this.userPlannerSelector)\n\t\t{\n\t\t\tthis.userPlannerSelector.subscribe('onDisplayAttendees', this.checkLocationForm.bind(this));\n\t\t}\n\n\t\treturn this.DOM.locationOuterWrap;\n\t}\n\n\tcreateRemindersControl()\n\t{\n\t\tthis.reminderValues = [];\n\t\tthis.DOM.remindersWrap = Tag.render`<div class=\"calendar-text\"></div>`;\n\t\tthis.remindersControl = new Reminder({\n\t\t\twrap: this.DOM.remindersWrap,\n\t\t\tzIndex: this.zIndex\n\t\t});\n\n\t\tthis.remindersControl.subscribe('onChange', (event) => {\n\t\t\tif (event instanceof BaseEvent)\n\t\t\t{\n\t\t\t\tthis.reminderValues = event.getData().values;\n\t\t\t\tif (!this.isNewEntry()\n\t\t\t\t\t&& (this.canDo('edit')\n\t\t\t\t\t\t|| this.entry.getCurrentStatus() !== false))\n\t\t\t\t{\n\t\t\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.updateReminders', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tentryId: this.entry.id,\n\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\treminders: this.reminderValues\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tthis.entry.data.REMIND = response.data.REMIND;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn this.DOM.remindersWrap;\n\t}\n\n\tgetTypeInfoControl()\n\t{\n\t\tthis.DOM.typeInfoTitle = Tag.render`<div class=\"calendar-field-title\"></div>`;\n\t\tthis.DOM.typeInfoLink = Tag.render`<div class=\"calendar-field-link\"></div>`;\n\n\t\tthis.DOM.typeInfoWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-block\" style=\"display: none\">\n\t\t\t\t${this.DOM.typeInfoTitle}\n\t\t\t\t${this.DOM.typeInfoLink}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.DOM.typeInfoWrap;\n\t}\n\n\tgetRRuleInfoControl()\n\t{\n\t\tthis.DOM.rruleInfo = Tag.render`<div class=\"calendar-text\"></div>`;\n\t\tthis.DOM.rruleInfoWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-block\" style=\"display: none\">\n\t\t\t\t<div class=\"calendar-field-title\">${Loc.getMessage('EC_REPEAT')}:</div>\n\t\t\t\t${this.DOM.rruleInfo}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.DOM.rruleInfoWrap;\n\t}\n\n\tgetTimezoneInfoControl()\n\t{\n\t\tthis.DOM.timezoneInfo = Tag.render`<div class=\"calendar-text\"></div>`;\n\t\tthis.DOM.timezoneInfoWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-block\" style=\"display: none\">\n\t\t\t\t<div class=\"calendar-field-title\">${Loc.getMessage('EC_TIMEZONE')}:</div>\n\t\t\t\t${this.DOM.timezoneInfo}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.DOM.timezoneInfoWrap;\n\t}\n\n\tisNewEntry()\n\t{\n\t\treturn !this.entry.id;\n\t}\n\n\tcanDo(action)\n\t{\n\t\tconst section = this.getCurrentSection();\n\n\t\tif (action === 'edit' || action === 'delete')\n\t\t{\n\t\t\tif ((this.entry.isMeeting() && this.entry.id !== this.entry.parentId))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.entry.isResourcebooking())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn section.canDo('edit');\n\t\t}\n\n\t\tif (action === 'view')\n\t\t{\n\t\t\treturn section.canDo('view_time');\n\t\t}\n\n\t\tif (action === 'viewFull')\n\t\t{\n\t\t\treturn section.canDo('view_full');\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tsetFormValues()\n\t{\n\t\tlet\n\t\t\tentry = this.entry,\n\t\t\tsection = this.getCurrentSection(),\n\t\t\treadOnly = !this.canDo('edit');\n\n\t\t// Date time\n\t\tthis.dateTimeControl.setValue({\n\t\t\tfrom: Util.adjustDateForTimezoneOffset(entry.from, entry.userTimezoneOffsetFrom, entry.fullDay),\n\t\t\tto: Util.adjustDateForTimezoneOffset(entry.to, entry.userTimezoneOffsetTo, entry.fullDay),\n\t\t\tfullDay: entry.fullDay,\n\t\t\ttimezoneFrom: entry.getTimezoneFrom() || '',\n\t\t\ttimezoneTo: entry.getTimezoneTo() || '',\n\t\t\ttimezoneName: this.userSettings.timezoneName,\n\t\t});\n\t\tthis.dateTimeControl.setInlineEditMode(this.isNewEntry() ? 'edit' : 'view');\n\t\tthis.dateTimeControl.setViewMode(readOnly);\n\n\t\t// Title\n\t\tthis.DOM.titleInput.value = entry.getName();\n\n\t\tif (readOnly)\n\t\t{\n\t\t\tif (this.entry.getCurrentStatus() === false)\n\t\t\t{\n\t\t\t\tthis.DOM.titleInput.type = 'hidden'; // Hide input\n\t\t\t\t// Add label instead\n\t\t\t\tthis.DOM.titleLabel = this.DOM.titleInput.parentNode.insertBefore(Tag.render`<span class=\"calendar-field calendar-field-string\">${Text.encode(entry.getName())}</span>`, this.DOM.titleInput);\n\t\t\t\tDom.addClass(this.DOM.titleOuterWrap, 'calendar-field-container-view');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.titleInput.disabled = true;\n\t\t\t}\n\t\t}\n\n\t\t// Color\n\t\tthis.colorSelector.setValue(entry.getColor() || section.color, false);\n\t\tthis.colorSelector.setViewMode(readOnly && this.entry.getCurrentStatus() === false);\n\n\t\t// Section\n\t\tthis.sectionValue = this.getCurrentSectionId();\n\t\tthis.sectionSelector.updateValue();\n\t\tthis.sectionSelector.setViewMode(readOnly);\n\n\t\t// Reminders\n\t\tthis.remindersControl.setValue(entry.getReminders(), false);\n\t\tthis.remindersControl.setViewMode(readOnly && this.entry.getCurrentStatus() === false);\n\t\tif (readOnly && this.entry.getCurrentStatus() === false)\n\t\t{\n\t\t\tthis.DOM.remindersOuterWrap.style.display = 'none';\n\t\t}\n\n\t\t// Recurcion\n\t\tif (entry.isRecursive())\n\t\t{\n\t\t\tthis.DOM.rruleInfoWrap.style = '';\n\t\t\tDom.adjust(this.DOM.rruleInfo, {text: entry.getRRuleDescription()});\n\t\t}\n\n\t\t// Timezone\n\t\t// if (Type.isStringFilled(entry.getTimezoneFrom())\n\t\t// \t&& entry.getTimezoneFrom() !== this.userSettings.timezoneName\n\t\t// \t&& !this.isNewEntry())\n\t\t// {\n\t\t// \tthis.DOM.timezoneInfoWrap.style = '';\n\t\t// \tDom.adjust(this.DOM.timezoneInfo, {text: entry.getTimezoneFrom()});\n\t\t// }\n\n\t\t// Location\n\t\tlet location = entry.getLocation();\n\t\tif (readOnly && !location)\n\t\t{\n\t\t\tthis.DOM.locationOuterWrap.style.display = 'none';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.locationSelector.setViewMode(readOnly);\n\t\t\tif (this.isLocationCalendar)\n\t\t\t{\n\t\t\t\tthis.locationSelector.setValue(this.locationSelector.default);\n\t\t\t\tlocation = this.locationSelector.default;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.locationOuterWrap.style.display = '';\n\t\t\t\tthis.locationSelector.setValue(entry.getLocation());\n\t\t\t}\n\t\t}\n\t\tif (this.locationSelector)\n\t\t{\n\t\t\tthis.locationSelector.checkLocationAccessibility(\n\t\t\t\t{\n\t\t\t\t\tfrom: this.dateTimeControl.getValue().from,\n\t\t\t\t\tto: this.dateTimeControl.getValue().to,\n\t\t\t\t\tfullDay: this.dateTimeControl.getValue().fullDay,\n\t\t\t\t\tcurrentEventId: this.entry.id\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\t//User Planner Selector\n\t\tif ((this.userPlannerSelector\n\t\t\t&& (this.canDo('viewFull') || entry.getCurrentStatus() !== false)))\n\t\t{\n\t\t\tthis.userPlannerSelector.setValue({\n\t\t\t\tattendeesEntityList: entry.getAttendeesEntityList(),\n\t\t\t\tlocation: location,\n\t\t\t\tattendees: entry.getAttendees(),\n\t\t\t\tnotify: !entry.isMeeting() || entry.getMeetingNotify(),\n\t\t\t\tviewMode: this.getMode() === CompactEventForm.VIEW_MODE,\n\t\t\t\tentry: entry,\n\t\t\t\thideGuests: entry.getHideGuests()\n\t\t\t});\n\t\t\tthis.userPlannerSelector.setDateTime(this.dateTimeControl.getValue());\n\t\t\tthis.userPlannerSelector.setViewMode(readOnly);\n\t\t\tif (this.isLocationCalendar)\n\t\t\t{\n\t\t\t\tthis.userPlannerSelector.showPlanner();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.remove(this.DOM.userPlannerSelectorOuterWrap);\n\t\t}\n\n\t\tlet hideInfoContainer = true;\n\t\tthis.DOM.infoContainer = this.DOM.wrap.querySelector('.calendar-field-container-info');\n\t\tfor(let i = 0; i <= this.DOM.infoContainer.childNodes.length; i++)\n\t\t{\n\t\t\tif (Type.isElementNode(this.DOM.infoContainer.childNodes[i])\n\t\t\t\t&& this.DOM.infoContainer.childNodes[i].style.display !== 'none')\n\t\t\t{\n\t\t\t\thideInfoContainer = false;\n\t\t\t}\n\t\t}\n\t\tif (hideInfoContainer)\n\t\t{\n\t\t\tthis.DOM.infoContainer.style.display = 'none';\n\t\t}\n\t}\n\n\tsetFormValuesLocation()\n\t{\n\t\tlet\n\t\t\tentry = this.entry,\n\t\t\tsection = this.getCurrentSection(),\n\t\t\treadOnly = true;\n\n\t\t// Date time\n\t\tthis.dateTimeControl.setValue({\n\t\t\tfrom: Util.adjustDateForTimezoneOffset(entry.from, entry.userTimezoneOffsetFrom, entry.fullDay),\n\t\t\tto: Util.adjustDateForTimezoneOffset(entry.to, entry.userTimezoneOffsetTo, entry.fullDay),\n\t\t\tfullDay: entry.fullDay,\n\t\t\ttimezoneFrom: entry.getTimezoneFrom() || '',\n\t\t\ttimezoneTo: entry.getTimezoneTo() || '',\n\t\t\ttimezoneName: this.userSettings.timezoneName,\n\t\t});\n\t\tthis.dateTimeControl.setInlineEditMode(this.isNewEntry() ? 'edit' : 'view');\n\t\tthis.dateTimeControl.setViewMode(readOnly);\n\n\t\t// Title\n\t\tif (this.entry.id !== this.entry.parentId)\n\t\t{\n\t\t\tthis.DOM.titleInput.value = section.name\n\t\t\t\t+ ': ' + BX.util.htmlspecialchars(entry.getName());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.titleInput.value = Loc.getMessage('CALENDAR_UPDATE');\n\t\t}\n\n\t\t// Color\n\t\tthis.colorSelector.setValue(entry.getColor() || section.color, false);\n\t\tthis.colorSelector.setViewMode(!readOnly);\n\n\t\t// Section\n\t\tthis.sectionValue = this.getCurrentSectionId();\n\t\tthis.sectionSelector.updateValue();\n\t\tthis.sectionSelector.setViewMode(readOnly);\n\t}\n\n\tsave(options = {}): boolean\n\t{\n\t\tif (this.state === this.STATE.REQUEST)\n\t\t\treturn false;\n\n\t\tconst entry = this.getCurrentEntry();\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\tif (this.isNewEntry()\n\t\t\t&& this.userPlannerSelector.hasExternalEmailUsers()\n\t\t\t&& Util.checkEmailLimitationPopup()\n\t\t\t&& !options.emailLimitationDialogShown)\n\t\t{\n\t\t\tEntryManager.showEmailLimitationDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\toptions.emailLimitationDialogShown = true;\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.userSettings.sendFromEmail\n\t\t\t&& this.userPlannerSelector.hasExternalEmailUsers())\n\t\t{\n\t\t\tEntryManager.showConfirmedEmailDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.isNewEntry()\n\t\t\t&& entry.isRecursive()\n\t\t\t&& !options.confirmed\n\t\t\t&& this.getFormDataChanges(['section', 'notify']).length > 0)\n\t\t{\n\t\t\tEntryManager.showConfirmEditDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\toptions.recursionMode = params.recursionMode;\n\t\t\t\t\toptions.confirmed = true;\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.isNewEntry()\n\t\t\t&& entry.isMeeting()\n\t\t\t&& options.sendInvitesAgain === undefined\n\t\t\t&& this.getFormDataChanges().includes('date&time')\n\t\t\t&& entry.getAttendees().find((item) => {return item.STATUS === 'N';})\n\t\t)\n\t\t{\n\t\t\tEntryManager.showReInviteUsersDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\toptions.sendInvitesAgain = params.sendInvitesAgain;\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tconst dateTime = this.dateTimeControl.getValue();\n\t\tconst data = {\n\t\t\tid: entry.id,\n\t\t\tsection: this.sectionValue,\n\t\t\tname: this.DOM.titleInput.value,\n\t\t\tdesc: entry.getDescription(),\n\t\t\treminder: this.remindersControl.getSelectedValues(),\n\t\t\tdate_from: dateTime.fromDate,\n\t\t\tdate_to: dateTime.toDate,\n\t\t\tskip_time: dateTime.fullDay ? 'Y' : 'N',\n\t\t\ttime_from: Util.formatTime(Util.adjustDateForTimezoneOffset(dateTime.from, -entry.userTimezoneOffsetFrom, dateTime.fullDay)),\n\t\t\ttime_to: Util.formatTime(Util.adjustDateForTimezoneOffset(dateTime.to, -entry.userTimezoneOffsetTo, dateTime.fullDay)),\n\t\t\tlocation: this.locationSelector.getTextValue(),\n\t\t\ttz_from: entry.getTimezoneFrom(),\n\t\t\ttz_to: entry.getTimezoneTo(),\n\t\t\tmeeting_notify: this.userPlannerSelector.getInformValue() ? 'Y' : 'N',\n\t\t\tmeeting_host: entry.data.MEETING_HOST || '0',\n\t\t\tchat_id: entry.data.MEETING\n\t\t\t\t? entry.data.MEETING.CHAT_ID\n\t\t\t\t: 0,\n\t\t\texclude_users: this.excludeUsers || [],\n\t\t\tattendeesEntityList: this.userPlannerSelector.getEntityList(),\n\t\t\tsendInvitesAgain: options.sendInvitesAgain ? 'Y' : 'N',\n\t\t\thide_guests: this.userPlannerSelector.hideGuests ? 'Y' : 'N',\n\t\t\trequestUid: BX.Calendar.Util.registerRequestId(),\n\t\t};\n\n\t\tlet checkCurrentUsersAccessibility = !entry.id || this.checkCurrentUsersAccessibility();\n\t\tif (!checkCurrentUsersAccessibility\n\t\t\t&& this.getFormDataChanges().includes('codes'))\n\t\t{\n\t\t\tconst previousAttendeesList = entry.getAttendeesEntityList();\n\t\t\tconst newAttendeesList = [];\n\t\t\tdata.attendeesEntityList.forEach(entity => {\n\t\t\t\tif (!previousAttendeesList.find((item) => {\n\t\t\t\t\treturn entity.entityId === item.entityId\n\t\t\t\t\t\t&& parseInt(entity.id) === parseInt(item.id);\n\t\t\t\t}))\n\t\t\t\t{\n\t\t\t\t\tif (entity.entityId === 'user')\n\t\t\t\t\t{\n\t\t\t\t\t\tnewAttendeesList.push(entity.id);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tcheckCurrentUsersAccessibility = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tdata.newAttendeesList = newAttendeesList;\n\t\t}\n\t\tdata.checkCurrentUsersAccessibility = checkCurrentUsersAccessibility ? 'Y' : 'N';\n\n\t\tif (entry.id && entry.isRecursive())\n\t\t{\n\t\t\tdata.EVENT_RRULE = entry.data.RRULE;\n\t\t}\n\n\t\tif (options.recursionMode)\n\t\t{\n\t\t\tdata.rec_edit_mode = options.recursionMode;\n\t\t\tdata.current_date_from = Util.formatDate(entry.from);\n\t\t}\n\n\t\tif (this.getCurrentSection().color.toLowerCase() !== this.colorSelector.getValue().toLowerCase())\n\t\t{\n\t\t\tdata.color = this.colorSelector.getValue();\n\t\t}\n\n\t\tthis.state = this.STATE.REQUEST;\n\t\t\n\t\tthis.freezePopup();\n\t\tthis.BX.ajax.runAction('calendar.api.calendarentryajax.editEntry', {\n\t\t\t\tdata: data,\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tcalendarAction: this.isNewEntry() ? 'create_event' : 'edit_event',\n\t\t\t\t\tformType: 'compact',\n\t\t\t\t\temailGuests: this.userPlannerSelector.hasExternalEmailUsers() ? 'Y' : 'N',\n\t\t\t\t\tmarkView: Util.getCurrentView() || 'outside',\n\t\t\t\t\tmarkCrm: 'N',\n\t\t\t\t\tmarkRrule: 'NONE',\n\t\t\t\t\tmarkMeeting: this.entry.isMeeting() ? 'Y' : 'N',\n\t\t\t\t\tmarkType: this.type\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\t\tif (this.isLocationCalendar)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.roomsManager.unsetHiddenRoom(Location.parseStringValue(data.location).room_id);\n\t\t\t\t\t}\n\t\t\t\t\tthis.unfreezePopup();\n\t\t\t\t\tthis.state = this.STATE.READY;\n\t\t\t\t\tif (response.data.entryId)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (entry.id)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tEntryManager.showEditEntryNotification(response.data.entryId);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tEntryManager.showNewEntryNotification(response.data.entryId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.emit('onSave', new BaseEvent({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tresponseData: response.data,\n\t\t\t\t\t\t\toptions: options\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t\tthis.close();\n\n\t\t\t\t\tif (response.data.displayMobileBanner)\n\t\t\t\t\t{\n\t\t\t\t\t\tnew MobileSyncBanner().showInPopup();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (response.data.countEventWithEmailGuestAmount)\n\t\t\t\t\t{\n\t\t\t\t\t\tUtil.setEventWithEmailGuestAmount(response.data.countEventWithEmailGuestAmount);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isArray(response.data.eventList)\n\t\t\t\t\t\t&& response.data.eventList.length\n\t\t\t\t\t\t&& response.data.eventList[0].REMIND\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tEntryManager.setNewEntryReminders(\n\t\t\t\t\t\t\tdateTime.fullDay ? 'fullDay' : 'withTime',\n\t\t\t\t\t\t\tresponse.data.eventList[0].REMIND\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tthis.unfreezePopup();\n\t\t\t\t\tif (response.data && Type.isPlainObject(response.data.busyUsersList))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.handleBusyUsersError(response.data.busyUsersList);\n\n\t\t\t\t\t\tlet errors = [];\n\t\t\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\t\t\tif (error.code !== \"edit_entry_user_busy\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\terrors.push(error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresponse.errors = errors;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (response.errors && response.errors.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showError(response.errors);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.state = this.STATE.ERROR;\n\t\t\t\t}\n\t\t\t);\n\n\t\treturn true;\n\t}\n\n\thandleBusyUsersError(busyUsers)\n\t{\n\t\tlet\n\t\t\tusers = [],\n\t\t\tuserIds = [];\n\n\t\tfor (let id in busyUsers)\n\t\t{\n\t\t\tif (busyUsers.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tusers.push(busyUsers[id]);\n\t\t\t\tuserIds.push(id);\n\t\t\t}\n\t\t}\n\n\t\tthis.busyUsersDialog = new BusyUsersDialog();\n\t\tthis.busyUsersDialog.subscribe('onSaveWithout', () => {\n\t\t\tthis.excludeUsers = userIds.join(',');\n\t\t\tthis.save();\n\t\t});\n\n\t\tthis.busyUsersDialog.show({users: users});\n\t}\n\n\thandleKeyPress(e)\n\t{\n\t\tif (this.getMode() === CompactEventForm.EDIT_MODE\n\t\t\t&& e.keyCode === Util.getKeyCode('enter')\n\t\t\t&& this.checkTopSlider())\n\t\t{\n\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\tthis.save();\n\t\t}\n\t\telse if (this.checkTopSlider()\n\t\t\t&& e.keyCode === Util.getKeyCode('escape')\n\t\t\t&& this.couldBeClosedByEsc()\n\t\t)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse if (\n\t\t\t(\n\t\t\t\te.keyCode === Util.getKeyCode('delete')\n\t\t\t\t// || e.keyCode === Util.getKeyCode('backspace')\n\t\t\t)\n\t\t\t&& !this.isNewEntry()\n\t\t\t&& this.canDo('delete')\n\t\t\t&& this.checkTopSlider())\n\t\t{\n\t\t\tconst target = event.target || event.srcElement;\n\t\t\tconst tagName = Type.isElementNode(target) ? target.tagName.toLowerCase() : null;\n\t\t\tif (tagName && !['input', 'textarea'].includes(tagName))\n\t\t\t{\n\t\t\t\tEventEmitter.subscribeOnce('BX.Calendar.Entry:beforeDelete', ()=>{\n\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\tthis.close();\n\t\t\t\t});\n\t\t\t\tEntryManager.deleteEntry(this.entry);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetCurrentEntry()\n\t{\n\t\treturn this.entry;\n\t}\n\n\tgetCurrentSection()\n\t{\n\t\tlet section = false;\n\t\tconst sectionId = this.getCurrentSectionId();\n\n\t\tif (sectionId\n\t\t\t&& this.sectionIndex[sectionId] !== undefined\n\t\t\t&& this.sections[this.sectionIndex[sectionId]] !== undefined)\n\t\t{\n\t\t\tsection = this.sections[this.sectionIndex[sectionId]];\n\t\t}\n\t\treturn section;\n\t}\n\n\tgetCurrentSectionId()\n\t{\n\t\tlet sectionId = 0;\n\t\tif (this.sectionValue)\n\t\t{\n\t\t\tsectionId = this.sectionValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst entry = this.getCurrentEntry();\n\t\t\tif (entry instanceof Entry)\n\t\t\t{\n\t\t\t\tsectionId = parseInt(entry.sectionId);\n\t\t\t}\n\n\t\t\t// TODO: refactor - don't take first section\n\t\t\tif (!sectionId && this.sections[0])\n\t\t\t{\n\t\t\t\tsectionId = parseInt(this.sections[0].id);\n\t\t\t}\n\t\t}\n\t\treturn sectionId;\n\t}\n\n\thandlePlannerSelectorChanges(event)\n\t{\n\t\tif (event instanceof BaseEvent)\n\t\t{\n\t\t\tconst dateTimeValue = this.dateTimeControl.getValue();\n\t\t\tdateTimeValue.from = event.getData().dateFrom;\n\t\t\tdateTimeValue.to = event.getData().dateTo;\n\t\t\t// Date time\n\t\t\tthis.dateTimeControl.setValue(dateTimeValue);\n\t\t\tthis.userPlannerSelector.setDateTime(this.dateTimeControl.getValue());\n\t\t\t\n\t\t\tif (this.locationSelector)\n\t\t\t{\n\t\t\t\tthis.locationSelector.checkLocationAccessibility(\n\t\t\t\t\t{\n\t\t\t\t\t\tfrom: event.getData().dateFrom,\n\t\t\t\t\t\tto: event.getData().dateTo,\n\t\t\t\t\t\tfullDay: event.getData().fullDay,\n\t\t\t\t\t\tcurrentEventId: this.entry.id\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t}\n\n\teditEntryInSlider()\n\t{\n\t\tthis.checkDataBeforeCloseMode = false;\n\t\tconst dateTime = this.dateTimeControl.getValue();\n\t\tBX.Calendar.EntryManager.openEditSlider({\n\t\t\tentry: this.entry,\n\t\t\ttype: this.type,\n\t\t\tisLocationCalendar: this.isLocationCalendar,\n\t\t\tlocationAccess: this.locationAccess,\n\t\t\tdayOfWeekMonthFormat: this.dayOfWeekMonthFormat,\n\t\t\troomsManager: this.roomsManager,\n\t\t\tlocationCapacity: Location.getCurrentCapacity(), // for location component\n\t\t\townerId: this.ownerId,\n\t\t\tuserId: this.userId,\n\t\t\tformDataValue: {\n\t\t\t\tsection: this.sectionValue,\n\t\t\t\tname: this.DOM.titleInput.value,\n\t\t\t\treminder: this.remindersControl.getSelectedRawValues(),\n\t\t\t\tcolor: this.colorSelector.getValue(),\n\t\t\t\tfrom: Util.adjustDateForTimezoneOffset(dateTime.from, -this.entry.userTimezoneOffsetFrom, dateTime.fullDay),\n\t\t\t\tto: Util.adjustDateForTimezoneOffset(dateTime.to, -this.entry.userTimezoneOffsetTo, dateTime.fullDay),\n\t\t\t\tfullDay: dateTime.fullDay,\n\t\t\t\tlocation: this.locationSelector.getTextValue(),\n\t\t\t\tmeetingNotify: this.userPlannerSelector.getInformValue() ? 'Y' : 'N',\n\t\t\t\thideGuests: this.userPlannerSelector.hideGuests ? 'Y' : 'N',\n\t\t\t\tattendeesEntityList: this.userPlannerSelector.getEntityList()\n\t\t\t}\n\t\t});\n\t\tthis.close();\n\t}\n\n\toutsideMouseDownClose(event)\n\t{\n\t\tif (this.checkTopSlider())\n\t\t{\n\t\t\tlet target = event.target || event.srcElement;\n\t\t\tthis.outsideMouseDown = !target.closest('div.popup-window');\n\t\t}\n\t}\n\n\tcheckTopSlider()\n\t{\n\t\treturn !Util.getBX().SidePanel.Instance.getTopSlider();\n\t}\n\n\tcheckOutsideClickClose(event)\n\t{\n\t\tlet target = event.target || event.srcElement;\n\t\tthis.outsideMouseUp = !target.closest('div.popup-window');\n\t\tif (this.couldBeClosedByEsc()\n\t\t\t&& this.outsideMouseDown\n\t\t\t&& this.outsideMouseUp\n\t\t\t&& (this.getMode() === CompactEventForm.VIEW_MODE\n\t\t\t\t|| !this.formDataChanged()\n\t\t\t\t|| this.isNewEntry())\n\t\t)\n\t\t{\n\t\t\tsetTimeout(this.close.bind(this), 0);\n\t\t}\n\t}\n\n\tcouldBeClosedByEsc()\n\t{\n\t\treturn !PopupManager._popups.find((popup)=>{return popup && popup.getId() !== this.popupId && popup.isShown();});\n\t}\n\n\temitOnChange()\n\t{\n\t\tthis.emit('onChange', new BaseEvent({\n\t\t\tdata: {\n\t\t\t\tform: this,\n\t\t\t\tentry: this.entry\n\t\t\t}\n\t\t}));\n\t}\n\n\tshowError(errorList)\n\t{\n\t\tlet errorText = '';\n\n\t\tif (Type.isArray(errorList))\n\t\t{\n\t\t\terrorList.forEach((error) => {\n\t\t\t\terrorText += error.message + \"\\n\";\n\t\t\t});\n\t\t}\n\n\t\tif (errorText !== '')\n\t\t{\n\t\t\talert(errorText);\n\t\t}\n\t}\n\n\treloadEntryData()\n\t{\n\t\tif (this.isShown()\n\t\t\t&& !this.isNewEntry()\n\t\t\t&& this.getMode() === CompactEventForm.VIEW_MODE)\n\t\t{\n\t\t\tconst calendar = Util.getCalendarContext();\n\t\t\tif (calendar)\n\t\t\t{\n\t\t\t\tthis.entry = EntryManager.getEntryInstance(\n\t\t\t\t\tcalendar.getView().getEntryById(this.entry.getUniqueId())\n\t\t\t\t);\n\n\t\t\t\tthis.setFormValues();\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckCurrentUsersAccessibility()\n\t{\n\t\treturn this.getFormDataChanges().includes('date&time');\n\t}\n\n\thandlePull(params)\n\t{\n\t\tif (this.userPlannerSelector\n\t\t\t&& this.userPlannerSelector?.planner?.isShown())\n\t\t{\n\t\t\tconst userIdList = Type.isArray(params?.fields?.ATTENDEES) ? params.fields.ATTENDEES: [];\n\t\t\tconst eventOwner = params?.fields?.CAL_TYPE === 'user'\n\t\t\t\t? parseInt(params?.fields?.OWNER_ID)\n\t\t\t\t: parseInt(params?.fields?.CREATED_BY);\n\t\t\tif (!userIdList.includes(eventOwner))\n\t\t\t{\n\t\t\t\tuserIdList.push(eventOwner);\n\t\t\t}\n\t\t\tthis.userPlannerSelector.clearAccessibilityData(userIdList);\n\n\t\t\tthis.userPlannerSelector.refreshPlannerState();\n\t\t}\n\n\t\tconst entry = this.getCurrentEntry();\n\t\tif (\n\t\t\t!this.isNewEntry()\n\t\t\t&& entry\n\t\t\t&& entry.parentId === parseInt(params?.fields?.PARENT_ID)\n\t\t)\n\t\t{\n\t\t\tif (params.command === 'delete_event'\n\t\t\t\t&& entry.getType() === params?.fields?.CAL_TYPE)\n\t\t\t{\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst onEntryListReloadHandler = () => {\n\t\t\t\t\tthis.reloadEntryData();\n\t\t\t\t\tBX.Event.EventEmitter.unsubscribe('BX.Calendar:onEntryListReload', onEntryListReloadHandler);\n\t\t\t\t};\n\t\t\t\tBX.Event.EventEmitter.subscribe('BX.Calendar:onEntryListReload', onEntryListReloadHandler);\n\t\t\t}\n\t\t}\n\t}\n}\n"],"names":["CompactEventForm","options","READY","REQUEST","ERROR","setEventNamespace","userId","Util","getCurrentUserId","type","isLocationCalendar","calendarContext","ownerId","BX","getBX","checkForChanges","Runtime","debounce","checkForChangesImmediately","checkOutsideClickClose","bind","outsideMouseDownClose","keyHandler","handleKeyPress","mode","EDIT_MODE","params","setParams","setMode","state","STATE","popupId","Math","round","random","popup","destroy","getPopup","Dom","addClass","titleBar","removeClass","popupContainer","closeIcon","Event","document","getMode","EntryManager","doDelayedActions","prepareData","then","checkLocationView","setFormValuesLocation","setFormValues","show","checkDataBeforeCloseMode","canDo","DOM","titleInput","focus","select","displayed","VIEW_MODE","sendAnalyticLabel","calendarAction","formType","getButtons","button","userPlannerSelector","isPlannerDisplayed","checkBusyTime","Popup","bindNode","zIndex","Z_INDEX_OFFSET","closeByEsc","offsetTop","offsetLeft","draggable","resizable","lightShadow","className","cacheable","content","getPopupContentLocation","getPopupContentCalendar","buttons","events","onPopupClose","close","formDataChanged","confirm","Loc","getMessage","destroyed","setTimeout","emit","unbind","Location","setCurrentCapacity","clearPlannerWatches","closeAllPopups","wrap","Tag","render","titleOuterWrap","getTitleControl","getColorControl","getSectionControl","getDateTimeControl","getUserPlannerSelector","getTypeInfoControl","getLocationControl","remindersOuterWrap","createRemindersControl","getRRuleInfoControl","getTitleControlLocation","getColorControlsLocationView","getLocationSectionControls","entry","id","parentId","appendChild","getHostControl","push","UI","Button","name","text","isNewEntry","click","save","Type","isElementNode","setAttribute","setButtons","editEntryInSlider","isMeeting","getCurrentStatus","setMeetingStatus","refreshMeetingStatus","isShown","Calendar","openViewSlider","from","timezoneOffset","data","TZ_OFFSET_FROM","length","EventEmitter","subscribeOnce","deleteEntry","wasEverRecursive","forEach","setClocking","setDisabled","displayAttendees","getAttendees","isDomNode","loader","remove","emitOnChange","event","BaseEvent","getData","usersCount","locationCapacity","getCurrentCapacity","locationSelector","value","undefined","addCapacityAlert","removeCapacityAlert","excludes","fields","includes","getTextLocation","parseStringValue","getLocation","getTextValue","dateTime","dateTimeControl","getValue","isFullDay","fullDay","toString","to","getMeetingNotify","getInformValue","parseInt","sectionId","sectionValue","getEntityList","map","item","entityId","join","getAttendeesEntityList","getFormDataChanges","locationAccess","dayOfWeekMonthFormat","getEntryInstance","userIndex","isPlainObject","entryTime","isDate","setDateTimeValue","userSettings","locationFeatureEnabled","locationList","roomsManager","iblockMeetingRoomList","plannerFeatureEnabled","setSections","sections","trackingUserList","trackingUsersList","sectionIndex","isArray","ind","ID","Promise","resolve","section","getCurrentSection","ajax","runAction","entryId","loadSectionId","response","window","BXEventCalendar","Section","getCalendarContext","CREATED_BY","userUrl","USER_URL","replace","userAvatar","AVATAR","hostBar","util","htmlspecialchars","colorSelect","colorSelector","ColorSelector","subscribe","color","COLOR","sectionSelectWrap","sectionSelector","SectionSelector","outerWrap","defaultCalendarType","defaultOwnerId","sectionList","sectionGroupList","SectionManager","getSectionGroupList","selectCallback","setValue","saveDefaultSectionId","dateTimeWrap","DateTimeControl","showTimezone","inlineEditMode","remindersControl","setFullDayMode","wasChangedByUser","defaultReminders","getNewEntryReminders","showPlanner","setLocationValue","setDateTime","refreshPlanner","checkLocationAccessibility","currentEventId","userPlannerSelectorOuterWrap","userSelectorWrap","informWrap","plannerOuterWrap","hideGuestsWrap","UserPlannerSelector","readOnlyMode","handlePlannerSelectorChanges","locationWrap","locationOuterWrap","richLocationEnabled","inlineEditModeEnabled","onChangeCallback","checkLocationForm","reminderValues","remindersWrap","Reminder","values","reminders","REMIND","typeInfoTitle","typeInfoLink","typeInfoWrap","rruleInfo","rruleInfoWrap","timezoneInfo","timezoneInfoWrap","action","isResourcebooking","readOnly","adjustDateForTimezoneOffset","userTimezoneOffsetFrom","userTimezoneOffsetTo","timezoneFrom","getTimezoneFrom","timezoneTo","getTimezoneTo","timezoneName","setInlineEditMode","setViewMode","getName","titleLabel","parentNode","insertBefore","Text","encode","disabled","getColor","getCurrentSectionId","updateValue","getReminders","style","display","isRecursive","adjust","getRRuleDescription","location","attendeesEntityList","attendees","notify","viewMode","hideGuests","getHideGuests","hideInfoContainer","infoContainer","querySelector","i","childNodes","getCurrentEntry","hasExternalEmailUsers","checkEmailLimitationPopup","emailLimitationDialogShown","showEmailLimitationDialog","callback","sendFromEmail","showConfirmedEmailDialog","confirmed","showConfirmEditDialog","recursionMode","sendInvitesAgain","find","STATUS","showReInviteUsersDialog","desc","getDescription","reminder","getSelectedValues","date_from","fromDate","date_to","toDate","skip_time","time_from","formatTime","time_to","tz_from","tz_to","meeting_notify","meeting_host","MEETING_HOST","chat_id","MEETING","CHAT_ID","exclude_users","excludeUsers","hide_guests","requestUid","registerRequestId","checkCurrentUsersAccessibility","previousAttendeesList","newAttendeesList","entity","EVENT_RRULE","RRULE","rec_edit_mode","current_date_from","formatDate","toLowerCase","freezePopup","analyticsLabel","emailGuests","markView","getCurrentView","markCrm","markRrule","markMeeting","markType","unsetHiddenRoom","room_id","unfreezePopup","showEditEntryNotification","showNewEntryNotification","responseData","displayMobileBanner","MobileSyncBanner","showInPopup","countEventWithEmailGuestAmount","setEventWithEmailGuestAmount","eventList","setNewEntryReminders","busyUsersList","handleBusyUsersError","errors","error","code","showError","busyUsers","users","userIds","hasOwnProperty","busyUsersDialog","BusyUsersDialog","e","keyCode","getKeyCode","checkTopSlider","couldBeClosedByEsc","target","srcElement","tagName","Entry","dateTimeValue","dateFrom","dateTo","openEditSlider","formDataValue","getSelectedRawValues","meetingNotify","outsideMouseDown","closest","SidePanel","Instance","getTopSlider","outsideMouseUp","PopupManager","_popups","getId","form","errorList","errorText","message","alert","calendar","getView","getEntryById","getUniqueId","planner","userIdList","ATTENDEES","eventOwner","CAL_TYPE","OWNER_ID","clearAccessibilityData","refreshPlannerState","PARENT_ID","command","getType","onEntryListReloadHandler","reloadEntryData","unsubscribe"],"mappings":"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"}