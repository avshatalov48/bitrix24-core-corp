{"version":3,"file":"compacteventform.bundle.js","sources":["../src/compacteventform.js"],"sourcesContent":["// @flow\nimport {Type, Tag, Loc, Dom, Event, Runtime, Text} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Util} from \"calendar.util\";\nimport {Popup, PopupManager} from 'main.popup';\nimport {\n\tDateTimeControl,\n\tLocation,\n\tReminder,\n\tSectionSelector,\n\tUserPlannerSelector,\n\tColorSelector,\n\tBusyUsersDialog\n} from \"calendar.controls\";\nimport {Entry, EntryManager} from \"calendar.entry\";\nimport {CalendarSectionManager} from \"calendar.calendarsection\";\nimport {MobileSyncBanner} from \"calendar.sync.interface\";\n\nexport class CompactEventForm extends EventEmitter\n{\n\tstatic VIEW_MODE = 'view';\n\tstatic EDIT_MODE = 'edit';\n\tSTATE = {READY: 1, REQUEST: 2, ERROR: 3};\n\tzIndex = 1200;\n\tZ_INDEX_OFFSET = -1000;\n\tuserSettings = '';\n\tDOM = {};\n\tmode;\n\tdisplayed = false;\n\tsections = [];\n\tsectionIndex = {};\n\ttrackingUsersList = [];\n\tcheckDataBeforeCloseMode = true;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.CompactEventForm');\n\t\tthis.userId = options.userId || Util.getCurrentUserId();\n\t\tthis.type = options.type || 'user';\n\t\tthis.ownerId = options.ownerId || this.userId;\n\t\tthis.BX = Util.getBX();\n\n\t\tthis.checkForChanges = Runtime.debounce(this.checkForChangesImmediately, 300, this);\n\t\tthis.checkOutsideClickClose = this.checkOutsideClickClose.bind(this);\n\t\tthis.outsideMouseDownClose = this.outsideMouseDownClose.bind(this);\n\t\tthis.keyHandler = this.handleKeyPress.bind(this);\n\t}\n\n\tshow(mode = CompactEventForm.EDIT_MODE, params ={})\n\t{\n\t\tthis.setParams(params);\n\t\tthis.setMode(mode);\n\n\t\tthis.state = this.STATE.READY;\n\n\t\tthis.popupId = 'compact-event-form-' + Math.round(Math.random() * 100000);\n\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.destroy();\n\t\t}\n\n\t\tthis.popup = this.getPopup(params);\n\n\t\t// Small hack to use transparent titlebar to drag&drop popup\n\t\tDom.addClass(this.popup.titleBar, 'calendar-add-popup-titlebar');\n\t\tDom.removeClass(this.popup.popupContainer, 'popup-window-with-titlebar');\n\t\tDom.removeClass(this.popup.closeIcon, 'popup-window-titlebar-close-icon');\n\t\tEvent.bind(document, \"mousedown\", this.outsideMouseDownClose);\n\t\tEvent.bind(document, \"mouseup\", this.checkOutsideClickClose);\n\t\tEvent.bind(document, \"keydown\", this.keyHandler);\n\n\t\tEvent.bind(this.popup.popupContainer, 'transitionend', ()=>{Dom.removeClass(this.popup.popupContainer, 'calendar-simple-view-popup-show');});\n\n\t\tthis.prepareData()\n\t\t\t.then(()=>{\n\t\t\t\tthis.setFormValues();\n\n\t\t\t\tthis.popup.show();\n\n\t\t\t\tthis.checkDataBeforeCloseMode = true;\n\t\t\t\tif (this.canDo('edit') && this.DOM.titleInput && mode === CompactEventForm.EDIT_MODE)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.titleInput.focus();\n\t\t\t\t\tthis.DOM.titleInput.select();\n\t\t\t\t}\n\n\t\t\t\tthis.displayed = true;\n\n\t\t\t\tif (this.getMode() === CompactEventForm.VIEW_MODE)\n\t\t\t\t{\n\t\t\t\t\tUtil.sendAnalyticLabel({calendarAction: 'view_event', formType: 'compact'});\n\t\t\t\t}\n\n\t\t\t\tif (!this.userPlannerSelector.isPlannerDisplayed())\n\t\t\t\t{\n\t\t\t\t\tthis.userPlannerSelector.checkBusyTime()\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tgetPopup(params)\n\t{\n\t\treturn new Popup(this.popupId,\n\t\t\tparams.bindNode,\n\t\t\t{\n\t\t\t\tzIndex: this.zIndex + this.Z_INDEX_OFFSET,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tcloseIcon: true,\n\t\t\t\ttitleBar: true,\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tclassName: 'calendar-simple-view-popup calendar-simple-view-popup-show',\n\t\t\t\tcacheable: false,\n\t\t\t\tcontent: this.getPopupContent(),\n\t\t\t\tbuttons: this.getButtons(),\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: this.close.bind(this)\n\t\t\t\t},\n\t\t\t});\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.displayed;\n\t}\n\n\tclose()\n\t{\n\t\tif (this.getMode() === CompactEventForm.EDIT_MODE\n\t\t\t&& this.formDataChanged()\n\t\t\t&& this.checkDataBeforeCloseMode\n\t\t\t&& !confirm(BX.message('EC_SAVE_ENTRY_CONFIRM')))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t//Dom.addClass(this.popup.popupContainer, 'calendar-simple-view-popup-close');\n\t\tthis.displayed = false;\n\t\tthis.emit('onClose');\n\t\tEvent.unbind(document, \"mousedown\", this.outsideMouseDownClose);\n\t\tEvent.unbind(document, \"mouseup\", this.checkOutsideClickClose);\n\t\tEvent.unbind(document, \"keydown\", this.keyHandler);\n\n\t\t//Dom.removeClass(popup.popupContainer, 'calendar-simple-view-popup-close');\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.destroy();\n\t\t}\n\n\t\tUtil.closeAllPopups();\n\t}\n\n\tgetPopupContent()\n\t{\n\t\tthis.DOM.wrap = Tag.render`<div class=\"calendar-add-popup-wrap\">\n\t\t\t${this.DOM.titleOuterWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-container calendar-field-container-string-select\">\n\t\t\t\t<div class=\"calendar-field-block\">\n\t\t\t\t\t${this.getTitleControl()}\n\t\t\t\t\t${this.getColorControl()}\n\t\t\t\t</div>\n\t\t\t</div>`}\n\t\t\t<div class=\"calendar-field-container calendar-field-container-choice\">\n\t\t\t\t${this.getSectionControl()}\n\t\t\t</div>\n\t\t\t\n\t\t\t${this.getDateTimeControl()}\n\t\t\t\n\t\t\t${this.getUserPlannerSelector()}\n\t\t\t\n\t\t\t<div class=\"calendar-field-container calendar-field-container-info\">\n\t\t\t\t${this.getTypeInfoControl()}\n\t\t\t\t\n\t\t\t\t\t${this.getLocationControl()}\n\t\t\t\t\n\t\t\t\t${this.DOM.remindersOuterWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-field-block\">\n\t\t\t\t\t<div class=\"calendar-field-title\">${Loc.getMessage('EC_REMIND_LABEL')}:</div>\n\t\t\t\t\t${this.createRemindersControl()}\n\t\t\t\t</div>`}\n\t\t\t\t${this.getRRuleInfoControl()}\n\t\t\t</div>\n\t\t</div>`;\n\n\t\treturn this.DOM.wrap;\n\t}\n\n\tgetButtons()\n\t{\n\t\tlet buttons = [];\n\t\tconst mode = this.getMode();\n\n\t\tif (mode === CompactEventForm.EDIT_MODE)\n\t\t{\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext : (this.isNewEntry() ? Loc.getMessage('CALENDAR_EVENT_DO_ADD') : Loc.getMessage('CALENDAR_EVENT_DO_SAVE')),\n\t\t\t\t\tclassName: \"ui-btn ui-btn-primary\",\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_CANCEL'),\n\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\tif (this.isNewEntry())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setFormValues();\n\n\t\t\t\t\t\t\tif (this.userPlannerSelector)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.userPlannerSelector.destroySelector();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.setMode(CompactEventForm.VIEW_MODE);\n\t\t\t\t\t\t\tthis.popup.setButtons(this.getButtons());\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_FULL_FORM'),\n\t\t\t\t\tclassName: \"ui-btn calendar-full-form-btn\",\n\t\t\t\t\tevents : {click : this.editEntryInSlider.bind(this)}\n\t\t\t\t})\n\t\t\t);\n\t\t\t//sideButton = true;\n\n\t\t\t// if (!this.isNewEntry() && this.canDo('delete'))\n\t\t\t// {\n\t\t\t// \tbuttons.push(\n\t\t\t// \t\tnew BX.UI.Button({\n\t\t\t// \t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_DELETE'),\n\t\t\t// \t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t// \t\t\tevents : {click : ()=>{\n\t\t\t// \t\t\t\tEntryManager.deleteEntry(this.entry);\n\t\t\t// \t\t\t}}\n\t\t\t// \t\t})\n\t\t\t// \t);\n\t\t\t// }\n\t\t}\n\t\telse if(mode === CompactEventForm.VIEW_MODE)\n\t\t{\n\t\t\tif (this.entry.isMeeting()\n\t\t\t\t&& this.entry.getCurrentStatus() === 'Q')\n\t\t\t{\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\tclassName: \"ui-btn ui-btn-primary\",\n\t\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_Y'),\n\t\t\t\t\t\tevents : {click : ()=>{\n\t\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'Y')\n\t\t\t\t\t\t\t\t\t.then(this.refreshMeetingStatus.bind(this));\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_N'),\n\t\t\t\t\t\tevents : {click : ()=>{\n\t\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'N')\n\t\t\t\t\t\t\t\t\t.then(this.refreshMeetingStatus.bind(this));\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\tclassName: `ui-btn ${this.entry.isMeeting() && this.entry.getCurrentStatus() === 'Q' ? 'ui-btn-link' : 'ui-btn-primary'}`,\n\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_OPEN'),\n\t\t\t\t\tevents : {click : ()=>{\n\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\tBX.Calendar.EntryManager.openViewSlider(this.entry.id,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tentry: this.entry,\n\t\t\t\t\t\t\t\t\ttype: this.type,\n\t\t\t\t\t\t\t\t\townerId: this.ownerId,\n\t\t\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\t\t\tfrom: this.entry.from,\n\t\t\t\t\t\t\t\t\ttimezoneOffset: this.entry && this.entry.data ? this.entry.data.TZ_OFFSET_FROM : null\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tif (this.entry.isMeeting()\n\t\t\t\t&& this.entry.getCurrentStatus() === 'N')\n\t\t\t{\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_Y'),\n\t\t\t\t\t\tevents : {click : ()=>{\n\t\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'Y')\n\t\t\t\t\t\t\t\t\t.then(this.refreshMeetingStatus.bind(this));\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.entry.isMeeting()\n\t\t\t\t&& this.entry.getCurrentStatus() === 'Y')\n\t\t\t{\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\ttext : Loc.getMessage('EC_DESIDE_BUT_N'),\n\t\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, 'N')\n\t\t\t\t\t\t\t\t\t.then(this.refreshMeetingStatus.bind(this));\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\n\t\t\t// if (!this.isNewEntry() && this.canDo('edit'))\n\t\t\t// {\n\t\t\t// \tbuttons.push(\n\t\t\t// \t\tnew BX.UI.Button({\n\t\t\t// \t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_EDIT')\n\t\t\t// \t\t\t//events : {click : this.save.bind(this)}\n\t\t\t// \t\t})\n\t\t\t// \t);\n\t\t\t// }\n\n\t\t\tif (!this.isNewEntry() && this.canDo('edit'))\n\t\t\t{\n\t\t\t\tbuttons.push(\n\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_EDIT'),\n\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\tevents : {click : this.editEntryInSlider.bind(this)}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\t//sideButton = true;\n\t\t\t}\n\n\t\t\tif (!this.isNewEntry() && this.canDo('delete'))\n\t\t\t{\n\t\t\t\tif (!this.entry.isMeeting()\n\t\t\t\t\t|| !this.entry.getCurrentStatus()\n\t\t\t\t\t|| this.entry.getCurrentStatus() === 'H')\n\t\t\t\t{\n\t\t\t\t\tbuttons.push(\n\t\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_DELETE'),\n\t\t\t\t\t\t\tclassName: \"ui-btn ui-btn-link\",\n\t\t\t\t\t\t\tevents : {click : ()=>{\n\t\t\t\t\t\t\t\t\tEntryManager.deleteEntry(this.entry);\n\t\t\t\t\t\t\t\t\tEventEmitter.subscribeOnce('BX.Calendar.Entry:delete', ()=>{\n\t\t\t\t\t\t\t\t\t\tthis.checkDataBeforeCloseMode = false;\n\t\t\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tif (!this.entry.wasEverRecursive())\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// buttons.push(\n\t\t// \tnew BX.UI.Button({\n\t\t// \t\ttext : Loc.getMessage('CALENDAR_EVENT_DO_CANCEL'),\n\t\t// \t\tclassName: \"ui-btn ui-btn-link\",\n\t\t// \t\t//events : {click : this.save.bind(this)}\n\t\t// \t})\n\t\t// );\n\n\t\t// buttons.push(\n\t\t// \tnew BX.UI.Button({\n\t\t// \t\ttext : Loc.getMessage('CALENDAR_EVENT_FULL_FORM'),\n\t\t// \t\tclassName: \"ui-btn ui-btn-link\"\n\t\t// \t\t//events : {click : this.save.bind(this)}\n\t\t// \t})\n\t\t// );\n\n\t\tif (buttons.length > 2)\n\t\t{\n\t\t\tbuttons[1].button.className = \"ui-btn ui-btn-light-border\";\n\t\t}\n\n\t\treturn buttons;\n\t}\n\n\trefreshMeetingStatus()\n\t{\n\t\tthis.emit('doRefresh');\n\t\tthis.popup.setButtons(this.getButtons());\n\t\tif (this.userPlannerSelector)\n\t\t{\n\t\t\tthis.userPlannerSelector.displayAttendees(this.entry.getAttendees());\n\t\t}\n\t}\n\n\thideLoader()\n\t{\n\t\tif (Type.isDomNode(this.DOM.loader))\n\t\t{\n\t\t\tDom.remove(this.DOM.loader);\n\t\t\tthis.DOM.loader = null;\n\t\t}\n\t}\n\n\tshowInEditMode(params = {})\n\t{\n\t\treturn this.show(CompactEventForm.EDIT_MODE, params);\n\t}\n\n\tshowInViewMode(params = {})\n\t{\n\t\treturn this.show(CompactEventForm.VIEW_MODE, params);\n\t}\n\n\tsetMode(mode)\n\t{\n\t\tif (mode === 'edit' || mode === 'view')\n\t\t{\n\t\t\tthis.mode = mode;\n\t\t}\n\t}\n\n\tgetMode()\n\t{\n\t\treturn this.mode;\n\t}\n\n\tcheckForChangesImmediately()\n\t{\n\t\tif (!this.isNewEntry()\n\t\t\t&& this.getMode() === CompactEventForm.VIEW_MODE\n\t\t\t&& this.formDataChanged())\n\t\t{\n\t\t\tthis.setMode(CompactEventForm.EDIT_MODE);\n\t\t\tthis.popup.setButtons(this.getButtons());\n\t\t}\n\t\telse if (!this.isNewEntry()\n\t\t\t&& this.getMode() === CompactEventForm.EDIT_MODE\n\t\t\t&& !this.formDataChanged())\n\t\t{\n\t\t\tthis.setMode(CompactEventForm.VIEW_MODE);\n\t\t\tthis.popup.setButtons(this.getButtons());\n\t\t}\n\t\tthis.emitOnChange();\n\t}\n\n\tupdateSetMeetingButtons()\n\t{\n\t\tconst entry = this.getCurrentEntry();\n\t\tif (entry.isMeeting())\n\t\t{\n\t\t\t//const buttonsContainer = this.popup.buttonsContainer;\n\t\t\t// this.setStatusControl = new MeetingStatusControl({\n\t\t\t// \twrap: buttonsContainer,\n\t\t\t// \tcurrentStatus: entry.getCurrentStatus()\n\t\t\t// });\n\t\t\t//\n\t\t\t// this.setStatusControl.subscribe('onSetStatus', (event) => {\n\t\t\t// \t\tif (event instanceof BaseEvent)\n\t\t\t// \t\t{\n\t\t\t// \t\t\tlet data = event.getData();\n\t\t\t// \t\t\tEntryManager.setMeetingStatus(entry, data.status);\n\t\t\t// \t\t}\n\t\t\t// \t}\n\t\t\t// );\n\t\t}\n\t}\n\n\tgetformDataChanges(excludes = [])\n\t{\n\t\tconst entry = this.entry;\n\t\tlet fields = [];\n\n\t\t// Name\n\t\tif (!excludes.includes('name')\n\t\t\t&& entry.name !== this.DOM.titleInput.value)\n\t\t{\n\t\t\tfields.push('name');\n\t\t}\n\n\t\t// Location\n\t\tif (!excludes.includes('location')\n\t\t\t&&\n\t\t\tthis.locationSelector.getTextLocation(Location.parseStringValue(entry.getLocation()))\n\t\t\t!==\n\t\t\tthis.locationSelector.getTextLocation(Location.parseStringValue(this.locationSelector.getTextValue()))\n\t\t)\n\t\t{\n\t\t\tfields.push('location');\n\t\t}\n\n\t\t// Date + time\n\t\tconst dateTime = this.dateTimeControl.getValue();\n\t\tif (!excludes.includes('date&time')\n\t\t\t&&\n\t\t\t(entry.isFullDay() !== dateTime.fullDay\n\t\t\t|| dateTime.from.toString() !== entry.from.toString()\n\t\t\t|| dateTime.to.toString() !== entry.to.toString()))\n\t\t{\n\t\t\tfields.push('date&time');\n\t\t}\n\n\t\t// Notify\n\t\tif (!excludes.includes('notify')\n\t\t\t&&\n\t\t\t(!entry.isMeeting() || entry.getMeetingNotify())\n\t\t\t!== this.userPlannerSelector.getInformValue())\n\t\t{\n\t\t\tfields.push('notify');\n\t\t}\n\n\t\t// Section\n\t\tif (!excludes.includes('section')\n\t\t\t&&\n\t\t\tparseInt(entry.sectionId) !== parseInt(this.sectionValue))\n\t\t{\n\t\t\tfields.push('section');\n\t\t}\n\n\t\t// Access codes\n\t\tif (!excludes.includes('codes')\n\t\t&&\n\t\t\tthis.userPlannerSelector.getEntityList().map((item)=>{return item.entityId + ':' + item.id}).join('|')\n\t\t\t!==\n\t\t\tentry.getAttendeesEntityList().map((item)=>{return item.entityId + ':' + item.id}).join('|')\n\t\t)\n\t\t{\n\t\t\tfields.push('codes');\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\tformDataChanged()\n\t{\n\t\treturn this.getformDataChanges().length > 0;\n\t}\n\n\tsetParams(params = {})\n\t{\n\t\tthis.userId = params.userId || Util.getCurrentUserId();\n\t\tthis.type = params.type || 'user';\n\t\tthis.ownerId = params.ownerId ? params.ownerId : 0;\n\t\tif (this.type === 'user' && !this.ownerId)\n\t\t{\n\t\t\tthis.ownerId = this.userId;\n\t\t}\n\t\tthis.entry = EntryManager.getEntryInstance(params.entry, params.userIndex, {type: this.type, ownerId: this.ownerId});\n\t\tthis.sectionValue = null;\n\n\t\tif (!this.entry.id\n\t\t\t&& Type.isPlainObject(params.entryTime)\n\t\t\t&& Type.isDate(params.entryTime.from)\n\t\t\t&& Type.isDate(params.entryTime.to)\n\t\t)\n\t\t{\n\t\t\tthis.entry.setDateTimeValue(params.entryTime);\n\t\t}\n\n\t\tif (Type.isPlainObject(params.userSettings))\n\t\t{\n\t\t\tthis.userSettings = params.userSettings;\n\t\t}\n\n\t\tthis.locationFeatureEnabled = !!params.locationFeatureEnabled;\n\t\tthis.locationList = params.locationList || [];\n\t\tthis.iblockMeetingRoomList = params.iblockMeetingRoomList || [];\n\n\t\tthis.setSections(params.sections, params.trackingUserList)\n\t}\n\n\tsetSections(sections, trackingUsersList = [])\n\t{\n\t\tthis.sections = sections;\n\t\tthis.sectionIndex = {};\n\t\tthis.trackingUsersList = trackingUsersList || [];\n\n\t\tif (Type.isArray(sections))\n\t\t{\n\t\t\tsections.forEach((value, ind) => {\n\t\t\t\tconst id = parseInt(value.ID || value.id);\n\t\t\t\tif (id > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.sectionIndex[id] = ind;\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\t}\n\n\tprepareData(params = {})\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst section = this.getCurrentSection();\n\t\t\tif (section && section.canDo)\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.getCompactFormData', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tentryId: this.entry.id,\n\t\t\t\t\t\tloadSectionId: this.entry.sectionId\n\t\t\t\t\t}\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tif (response && response.data && response.data.section)\n\t\t\t\t\t{\n\t\t\t\t\t\t// todo: refactor this part to new Section entities\n\t\t\t\t\t\tthis.sections.push(new window.BXEventCalendar.Section(Util.getCalendarContext(), response.data.section));\n\t\t\t\t\t\tthis.setSections(this.sections);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tgetTitleControl()\n\t{\n\t\tthis.DOM.titleInput = Tag.render`\n\t\t\t<input class=\"calendar-field calendar-field-string\" \n\t\t\t\tvalue=\"\" \n\t\t\t\tplaceholder=\"${Loc.getMessage('EC_ENTRY_NAME')}\" \n\t\t\t\ttype=\"text\" \n\t\t\t/>\n\t\t`;\n\n\t\tEvent.bind(this.DOM.titleInput, 'keyup', this.checkForChanges);\n\t\tEvent.bind(this.DOM.titleInput, 'change', this.checkForChanges);\n\n\t\treturn this.DOM.titleInput;\n\t}\n\n\tgetColorControl()\n\t{\n\t\tthis.DOM.colorSelect = Tag.render`<div class=\"calendar-field calendar-field-select calendar-field-tiny\"></div>`;\n\t\tthis.colorSelector = new ColorSelector({\n\t\t\twrap: this.DOM.colorSelect,\n\t\t\tmode: 'selector'\n\t\t});\n\n\t\tthis.colorSelector.subscribe('onChange', (event) => {\n\t\t\tif (event instanceof BaseEvent)\n\t\t\t{\n\t\t\t\tconst color = event.getData().value;\n\t\t\t\tif (!this.isNewEntry()\n\t\t\t\t\t&& (this.canDo('edit')\n\t\t\t\t\t\t|| this.entry.getCurrentStatus() !== false))\n\t\t\t\t{\n\t\t\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.updateColor', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tentryId: this.entry.id,\n\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\tcolor: color\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.entry.data.COLOR = color;\n\n\t\t\t\t\tthis.emit('doRefresh');\n\t\t\t\t\tthis.emitOnChange();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\n\t\treturn this.DOM.colorSelect;\n\t}\n\n\tgetSectionControl()\n\t{\n\t\tthis.DOM.sectionSelectWrap = Tag.render`<div class=\"calendar-field-choice-calendar\"></div>`;\n\t\tthis.sectionSelector = new SectionSelector({\n\t\t\touterWrap: this.DOM.sectionSelectWrap,\n\t\t\tdefaultCalendarType: this.type,\n\t\t\tdefaultOwnerId: this.ownerId,\n\t\t\tsectionList: this.sections,\n\t\t\tsectionGroupList: CalendarSectionManager.getSectionGroupList({\n\t\t\t\ttype: this.type,\n\t\t\t\townerId: this.ownerId,\n\t\t\t\tuserId: this.userId,\n\t\t\t\ttrackingUsersList: this.trackingUsersList,\n\t\t\t}),\n\t\t\tmode: 'textselect',\n\t\t\tzIndex: this.zIndex,\n\t\t\tgetCurrentSection: ()=>{\n\t\t\t\tlet section = this.getCurrentSection();\n\t\t\t\tif (section)\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: section.id,\n\t\t\t\t\t\tname: section.name,\n\t\t\t\t\t\tcolor: section.color\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tselectCallback: (sectionValue) => {\n\t\t\t\tif (sectionValue)\n\t\t\t\t{\n\t\t\t\t\tif (this.colorSelector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.colorSelector.setValue(sectionValue.color);\n\t\t\t\t\t}\n\t\t\t\t\tthis.sectionValue = sectionValue.id;\n\t\t\t\t\tthis.checkForChanges();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn this.DOM.sectionSelectWrap;\n\t}\n\n\tgetDateTimeControl()\n\t{\n\t\tthis.DOM.dateTimeWrap = Tag.render`<div class=\"calendar-field-container calendar-field-container-datetime\"></div>`;\n\n\t\tthis.dateTimeControl = new DateTimeControl(null, {\n\t\t\tshowTimezone: false,\n\t\t\touterWrap: this.DOM.dateTimeWrap,\n\t\t\tinlineEditMode: true\n\t\t});\n\n\t\tthis.dateTimeControl.subscribe('onChange', (event) => {\n\t\t\tif (event instanceof BaseEvent)\n\t\t\t{\n\t\t\t\tlet value = event.getData().value;\n\t\t\t\tif (this.remindersControl)\n\t\t\t\t{\n\t\t\t\t\tthis.remindersControl.setFullDayMode(value.fullDay);\n\t\t\t\t}\n\n\t\t\t\tif (this.userPlannerSelector)\n\t\t\t\t{\n\t\t\t\t\tif (!this.userPlannerSelector.isPlannerDisplayed())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userPlannerSelector.showPlanner();\n\t\t\t\t\t}\n\t\t\t\t\tthis.userPlannerSelector.setLocationValue(this.locationSelector.getTextValue());\n\t\t\t\t\tthis.userPlannerSelector.setDateTime(value, true);\n\t\t\t\t\tthis.userPlannerSelector.refreshPlanner();\n\t\t\t\t}\n\t\t\t\tthis.checkForChanges();\n\t\t\t}\n\t\t});\n\n\t\treturn this.DOM.dateTimeWrap;\n\t}\n\n\tgetUserPlannerSelector()\n\t{\n\t\tthis.DOM.userPlannerSelectorOuterWrap = Tag.render`<div>\n\t\t\t<div class=\"calendar-field-container calendar-field-container-members\">\n\t\t\t\t${this.DOM.userSelectorWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-field-block\">\n\t\t\t\t\t<div class=\"calendar-members-selected\">\n\t\t\t\t\t\t<span class=\"calendar-attendees-label\"></span>\n\t\t\t\t\t\t<span class=\"calendar-attendees-list\"></span>\n\t\t\t\t\t\t<span class=\"calendar-members-more\">${Loc.getMessage('EC_ATTENDEES_MORE')}</span>\n\t\t\t\t\t\t<span class=\"calendar-members-change-link\">${Loc.getMessage('EC_SEC_SLIDER_CHANGE')}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`}\n\t\t\t\t<span class=\"calendar-create-chat-link\">${Loc.getMessage('EC_SEC_SLIDER_CREATE_CHAT_LINK')}</span>\n\t\t\t\t${this.DOM.informWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-field-container-inform\">\n\t\t\t\t\t<span class=\"calendar-field-container-inform-text\">${Loc.getMessage('EC_NOTIFY_OPTION')}</span>\n\t\t\t\t</div>`}\n\t\t\t</div>\n\t\t\t<div class=\"calendar-user-selector-wrap\"></div>\n\t\t\t<div class=\"calendar-add-popup-planner-wrap calendar-add-popup-show-planner\">\n\t\t\t\t${this.DOM.plannerOuterWrap = Tag.render`\n\t\t\t\t<div class=\"calendar-planner-wrapper\" style=\"height: 0\">\n\t\t\t\t</div>`}\n\t\t\t</div>\n\t\t\t${this.DOM.hideGuestsWrap = Tag.render`\n\t\t\t<div class=\"calendar-hide-members-container\" style=\"display: none;\">\n\t\t\t\t<div class=\"calendar-hide-members-container-inner\">\n\t\t\t\t\t<div class=\"calendar-hide-members-icon-hidden\"></div>\n\t\t\t\t\t<div class=\"calendar-hide-members-text\">${Loc.getMessage('EC_HIDE_GUEST_NAMES')}</div>\n\t\t\t\t\t<span class=\"calendar-hide-members-helper\" data-hint=\"${Loc.getMessage('EC_HIDE_GUEST_NAMES_HINT')}\"></span>\n\t\t\t\t</div>\n\t\t\t</div>`}\n\t\t<div>`;\n\n\t\tthis.userPlannerSelector = new UserPlannerSelector({\n\t\t\touterWrap: this.DOM.userPlannerSelectorOuterWrap,\n\t\t\twrap: this.DOM.userSelectorWrap,\n\t\t\tinformWrap: this.DOM.informWrap,\n\t\t\tplannerOuterWrap: this.DOM.plannerOuterWrap,\n\t\t\thideGuestsWrap: this.DOM.hideGuestsWrap,\n\t\t\treadOnlyMode: false,\n\t\t\tuserId: this.userId,\n\t\t\ttype: this.type,\n\t\t\townerId: this.ownerId,\n\t\t\tzIndex: this.zIndex + 10\n\t\t});\n\n\t\tthis.userPlannerSelector.subscribe('onDateChange', this.handlePlannerSelectorChanges.bind(this));\n\t\tthis.userPlannerSelector.subscribe('onNotifyChange', this.checkForChanges);\n\t\t// this.subscribe('onLoad', this.userPlannerSelector.checkEmployment.bind(this.userPlannerSelector));\n\t\tthis.userPlannerSelector.subscribe('onUserCodesChange', this.checkForChanges);\n\t\tthis.userPlannerSelector.subscribe('onOpenChat', ()=>{\n\t\t\tEntryManager.openChatForEntry({\n\t\t\t\tentryId: this.entry.parentId,\n\t\t\t\tentry: this.entry\n\t\t\t});\n\t\t});\n\n\t\treturn this.DOM.userPlannerSelectorOuterWrap;\n\t}\n\n\tgetLocationControl()\n\t{\n\t\tthis.DOM.locationWrap = Tag.render`<div class=\"calendar-field-place\"></div>`;\n\t\tthis.DOM.locationOuterWrap = Tag.render`<div class=\"calendar-field-block\">\n\t\t\t<div class=\"calendar-field-title\">${Loc.getMessage('EC_LOCATION_LABEL')}:</div>\n\t\t\t${this.DOM.locationWrap}\n\t\t</div>`;\n\n\t\tthis.locationSelector = new Location(\n\t\t\t{\n\t\t\t\twrap: this.DOM.locationWrap,\n\t\t\t\trichLocationEnabled: this.locationFeatureEnabled,\n\t\t\t\tlocationList: this.locationList || [],\n\t\t\t\tiblockMeetingRoomList: this.iblockMeetingRoomList || [],\n\t\t\t\tinlineEditModeEnabled: true,\n\t\t\t\tonChangeCallback: () => {\n\t\t\t\t\tif (this.userPlannerSelector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userPlannerSelector.setLocationValue(this.locationSelector.getTextValue());\n\t\t\t\t\t\tif (this.locationSelector.getValue().type !== undefined\n\t\t\t\t\t\t\t&& !this.userPlannerSelector.isPlannerDisplayed())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.userPlannerSelector.showPlanner();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.userPlannerSelector.refreshPlanner();\n\t\t\t\t\t}\n\t\t\t\t\tthis.checkForChanges();\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\treturn this.DOM.locationOuterWrap;\n\t}\n\n\tcreateRemindersControl()\n\t{\n\t\tthis.reminderValues = [];\n\t\tthis.DOM.remindersWrap = Tag.render`<div class=\"calendar-text\"></div>`;\n\t\tthis.remindersControl = new Reminder({\n\t\t\twrap: this.DOM.remindersWrap,\n\t\t\tzIndex: this.zIndex\n\t\t});\n\n\t\tthis.remindersControl.subscribe('onChange', (event) => {\n\t\t\tif (event instanceof BaseEvent)\n\t\t\t{\n\t\t\t\tthis.reminderValues = event.getData().values;\n\t\t\t\tif (!this.isNewEntry()\n\t\t\t\t\t&& (this.canDo('edit')\n\t\t\t\t\t|| this.entry.getCurrentStatus() !== false))\n\t\t\t\t{\n\t\t\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.updateReminders', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tentryId: this.entry.id,\n\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\treminders: this.reminderValues\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tthis.entry.data.REMIND = response.data.REMIND;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn this.DOM.remindersWrap;\n\t}\n\n\tgetTypeInfoControl()\n\t{\n\t\tthis.DOM.typeInfoTitle = Tag.render`<div class=\"calendar-field-title\"></div>`;\n\t\tthis.DOM.typeInfoLink = Tag.render`<div class=\"calendar-field-link\"></div>`;\n\n\t\tthis.DOM.typeInfoWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-block\" style=\"display: none\">\n\t\t\t\t${this.DOM.typeInfoTitle}\n\t\t\t\t${this.DOM.typeInfoLink}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.DOM.typeInfoWrap;\n\t}\n\n\tgetRRuleInfoControl()\n\t{\n\t\tthis.DOM.rruleInfo = Tag.render`<div class=\"calendar-text\"></div>`;\n\t\tthis.DOM.rruleInfoWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-block\" style=\"display: none\">\n\t\t\t\t<div class=\"calendar-field-title\">${Loc.getMessage('EC_REPEAT')}:</div>\n\t\t\t\t${this.DOM.rruleInfo}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.DOM.rruleInfoWrap;\n\t}\n\n\tgetTimezoneInfoControl()\n\t{\n\t\tthis.DOM.timezoneInfo = Tag.render`<div class=\"calendar-text\"></div>`;\n\t\tthis.DOM.timezoneInfoWrap = Tag.render`\n\t\t\t<div class=\"calendar-field-block\" style=\"display: none\">\n\t\t\t\t<div class=\"calendar-field-title\">${Loc.getMessage('EC_TIMEZONE')}:</div>\n\t\t\t\t${this.DOM.timezoneInfo}\n\t\t\t</div>\n\t\t`;\n\t\treturn this.DOM.timezoneInfoWrap;\n\t}\n\n\tisNewEntry()\n\t{\n\t\treturn !this.entry.id;\n\t}\n\n\tcanDo(action)\n\t{\n\t\tconst section = this.getCurrentSection();\n\t\t//const userId = Util.getCurrentUserId();\n\n\t\tif (action === 'edit' || action === 'delete')\n\t\t{\n\t\t\t// if (this.entry.isMeeting() && userId === parseInt(this.entry.data.MEETING_HOST))\n\t\t\t// {\n\t\t\t// \treturn true;\n\t\t\t// }\n\n\t\t\tif ((this.entry.isMeeting() && this.entry.id !== this.entry.parentId))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.entry.isResourcebooking())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn section.canDo('edit');\n\t\t}\n\n\t\tif (action === 'view')\n\t\t{\n\t\t\treturn section.canDo('view_time');\n\t\t}\n\n\t\tif (action === 'viewFull')\n\t\t{\n\t\t\treturn section.canDo('view_full');\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tsetFormValues()\n\t{\n\t\tlet\n\t\t\tentry = this.entry,\n\t\t\tsection = this.getCurrentSection(),\n\t\t\treadOnly = !this.canDo('edit');\n\n\t\t// Date time\n\t\tthis.dateTimeControl.setValue({\n\t\t\tfrom: Util.adjustDateForTimezoneOffset(entry.from, entry.userTimezoneOffsetFrom, entry.fullDay),\n\t\t\tto: Util.adjustDateForTimezoneOffset(entry.to, entry.userTimezoneOffsetTo, entry.fullDay),\n\t\t\tfullDay: entry.fullDay,\n\t\t\ttimezoneFrom: entry.getTimezoneFrom() || '',\n\t\t\ttimezoneTo: entry.getTimezoneTo() || '',\n\t\t\ttimezoneName: this.userSettings.timezoneName,\n\t\t});\n\t\tthis.dateTimeControl.setInlineEditMode(this.isNewEntry() ? 'edit' : 'view');\n\t\tthis.dateTimeControl.setViewMode(readOnly);\n\n\t\t// Title\n\t\tthis.DOM.titleInput.value = entry.getName();\n\n\t\tif (readOnly)\n\t\t{\n\t\t\tif (this.entry.getCurrentStatus() === false)\n\t\t\t{\n\t\t\t\tthis.DOM.titleInput.type = 'hidden'; // Hide input\n\t\t\t\t// Add label instead\n\t\t\t\tthis.DOM.titleLabel = this.DOM.titleInput.parentNode.insertBefore(Tag.render`<span class=\"calendar-field calendar-field-string\">${Text.encode(entry.getName())}</span>`, this.DOM.titleInput);\n\t\t\t\tDom.addClass(this.DOM.titleOuterWrap, 'calendar-field-container-view');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.titleInput.disabled = true;\n\t\t\t}\n\t\t}\n\n\t\t// Color\n\t\tthis.colorSelector.setValue(entry.getColor() || section.color, false);\n\t\tthis.colorSelector.setViewMode(readOnly && this.entry.getCurrentStatus() === false);\n\n\t\t// Section\n\t\tthis.sectionValue = this.getCurrentSectionId();\n\t\tthis.sectionSelector.updateValue();\n\t\tthis.sectionSelector.setViewMode(readOnly);\n\n\t\t// Reminders\n\t\tthis.remindersControl.setValue(entry.getReminders(), false);\n\t\tthis.remindersControl.setViewMode(readOnly && this.entry.getCurrentStatus() === false);\n\t\tif (readOnly && this.entry.getCurrentStatus() === false)\n\t\t{\n\t\t\tthis.DOM.remindersOuterWrap.style.display = 'none';\n\t\t}\n\n\t\t// Recurcion\n\t\tif (entry.isRecursive())\n\t\t{\n\t\t\tthis.DOM.rruleInfoWrap.style = '';\n\t\t\tDom.adjust(this.DOM.rruleInfo, {text: entry.getRRuleDescription()});\n\t\t}\n\n\t\t// Timezone\n\t\t// if (Type.isStringFilled(entry.getTimezoneFrom())\n\t\t// \t&& entry.getTimezoneFrom() !== this.userSettings.timezoneName\n\t\t// \t&& !this.isNewEntry())\n\t\t// {\n\t\t// \tthis.DOM.timezoneInfoWrap.style = '';\n\t\t// \tDom.adjust(this.DOM.timezoneInfo, {text: entry.getTimezoneFrom()});\n\t\t// }\n\n\t\t// Location\n\t\tlet location = entry.getLocation();\n\t\tif (readOnly && !location)\n\t\t{\n\t\t\tDom.remove(this.DOM.locationOuterWrap);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.locationSelector.setValue(entry.getLocation());\n\t\t}\n\n\t\tif ((this.userPlannerSelector\n\t\t\t&& (this.canDo('viewFull') || entry.getCurrentStatus() !== false)))\n\t\t{\n\t\t\tthis.userPlannerSelector.setValue({\n\t\t\t\tattendeesEntityList: entry.getAttendeesEntityList(),\n\t\t\t\tlocation: location,\n\t\t\t\tattendees: entry.getAttendees(),\n\t\t\t\tnotify: !entry.isMeeting() || entry.getMeetingNotify(),\n\t\t\t\tviewMode: this.getMode() === CompactEventForm.VIEW_MODE,\n\t\t\t\tentryId: entry.id,\n\t\t\t\thideGuests: entry.getHideGuests()\n\t\t\t});\n\t\t\tthis.userPlannerSelector.setDateTime(this.dateTimeControl.getValue());\n\t\t\tthis.userPlannerSelector.setViewMode(readOnly);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.remove(this.DOM.userPlannerSelectorOuterWrap);\n\t\t}\n\n\t\tthis.updateSetMeetingButtons();\n\n\t\tlet hideInfoContainer = true;\n\t\tthis.DOM.infoContainer = this.DOM.wrap.querySelector('.calendar-field-container-info');\n\t\tfor(let i = 0; i <= this.DOM.infoContainer.childNodes.length; i++)\n\t\t{\n\t\t\tif (Type.isElementNode(this.DOM.infoContainer.childNodes[i])\n\t\t\t\t&& this.DOM.infoContainer.childNodes[i].style.display !== 'none')\n\t\t\t{\n\t\t\t\thideInfoContainer = false;\n\t\t\t}\n\t\t}\n\t\tif (hideInfoContainer)\n\t\t{\n\t\t\tthis.DOM.infoContainer.style.display = 'none';\n\t\t}\n\t}\n\n\tsave(options = {})\n\t{\n\t\tif (this.state === this.STATE.REQUEST)\n\t\t\treturn;\n\n\t\tconst entry = this.getCurrentEntry();\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\tif (this.isNewEntry()\n\t\t\t&& this.userPlannerSelector.hasExternalEmailUsers()\n\t\t\t&& Util.checkEmailLimitationPopup()\n\t\t\t&& !options.emailLimitationDialogShown)\n\t\t{\n\t\t\tEntryManager.showEmailLimitationDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\toptions.emailLimitationDialogShown = true;\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.userSettings.sendFromEmail\n\t\t\t&& this.userPlannerSelector.hasExternalEmailUsers())\n\t\t{\n\t\t\tEntryManager.showConfirmedEmailDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.isNewEntry()\n\t\t\t&& entry.isRecursive()\n\t\t\t&& !options.confirmed\n\t\t\t&& this.getformDataChanges(['section', 'notify']).length > 0)\n\t\t{\n\t\t\tEntryManager.showConfirmEditDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\toptions.recursionMode = params.recursionMode;\n\t\t\t\t\toptions.confirmed = true;\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.isNewEntry()\n\t\t\t&& entry.isMeeting()\n\t\t\t&& options.sendInvitesAgain === undefined\n\t\t\t&& this.getformDataChanges().includes('date&time')\n\t\t\t&& entry.getAttendees().find((item) => {return item.STATUS === 'N';})\n\t\t)\n\t\t{\n\t\t\tEntryManager.showReInviteUsersDialog({\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\toptions.sendInvitesAgain = params.sendInvitesAgain;\n\t\t\t\t\tthis.save(options);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\t// Dom.addClass(this.DOM.saveBtn, this.BX.UI.Button.State.CLOCKING);\n\t\t// Dom.addClass(this.DOM.closeBtn, this.BX.UI.Button.State.DISABLED);\n\n\t\tconst dateTime = this.dateTimeControl.getValue();\n\t\tconst data = {\n\t\t\tid: entry.id,\n\t\t\tsection: this.sectionValue,\n\t\t\tname: this.DOM.titleInput.value,\n\t\t\treminder: this.remindersControl.getSelectedValues(),\n\t\t\tdate_from: dateTime.fromDate,\n\t\t\tdate_to: dateTime.toDate,\n\t\t\tskip_time: dateTime.fullDay ? 'Y' : 'N',\n\t\t\ttime_from: Util.formatTime(Util.adjustDateForTimezoneOffset(dateTime.from, -entry.userTimezoneOffsetFrom, dateTime.fullDay)),\n\t\t\ttime_to: Util.formatTime(Util.adjustDateForTimezoneOffset(dateTime.to, -entry.userTimezoneOffsetTo, dateTime.fullDay)),\n\t\t\tlocation: this.locationSelector.getTextValue(),\n\t\t\ttz_from: entry.getTimezoneFrom(),\n\t\t\ttz_to: entry.getTimezoneTo(),\n\t\t\tmeeting_notify: this.userPlannerSelector.getInformValue() ? 'Y' : 'N',\n\t\t\texclude_users: this.excludeUsers || [],\n\t\t\tattendeesEntityList: this.userPlannerSelector.getEntityList(),\n\t\t\tsendInvitesAgain: options.sendInvitesAgain ? 'Y' : 'N',\n\t\t\thide_guests: this.userPlannerSelector.hideGuests ? 'Y' : 'N'\n\t\t};\n\n\t\tif (entry.id && entry.isRecursive())\n\t\t{\n\t\t\tdata.EVENT_RRULE = entry.data.RRULE;\n\t\t}\n\n\t\tif (options.recursionMode)\n\t\t{\n\t\t\tdata.rec_edit_mode = options.recursionMode;\n\t\t\tdata.current_date_from = Util.formatDate(entry.from);\n\t\t}\n\n\t\tif (this.getCurrentSection().color.toLowerCase() !== this.colorSelector.getValue().toLowerCase())\n\t\t{\n\t\t\tdata.color = this.colorSelector.getValue();\n\t\t}\n\n\t\tthis.state = this.STATE.REQUEST;\n\n\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.editEntry', {\n\t\t\t\tdata: data,\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tcalendarAction: this.isNewEntry() ? 'create_event' : 'edit_event',\n\t\t\t\t\tformType: 'compact',\n\t\t\t\t\temailGuests: this.userPlannerSelector.hasExternalEmailUsers() ? 'Y' : 'N',\n\t\t\t\t\tmarkView: Util.getCurrentView() || 'outside',\n\t\t\t\t\tmarkCrm: 'N',\n\t\t\t\t\tmarkRrule: 'NONE',\n\t\t\t\t\tmarkMeeting: this.entry.isMeeting() ? 'Y' : 'N',\n\t\t\t\t\tmarkType: this.type\n\t\t\t\t}\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\t// Dom.removeClass(this.DOM.saveBtn, this.BX.UI.Button.State.CLOCKING);\n\t\t\t\t// Dom.removeClass(this.DOM.closeBtn, this.BX.UI.Button.State.DISABLED);\n\t\t\t\tthis.state = this.STATE.READY;\n\t\t\t\tif (response.data.entryId)\n\t\t\t\t{\n\t\t\t\t\tif (entry.id)\n\t\t\t\t\t{\n\t\t\t\t\t\tEntryManager.showEditEntryNotification(response.data.entryId);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tEntryManager.showNewEntryNotification(response.data.entryId);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.emit('onSave', new BaseEvent({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tresponseData: response.data,\n\t\t\t\t\t\toptions: options\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t\tthis.close();\n\n\t\t\t\tif (response.data.displayMobileBanner)\n\t\t\t\t{\n\t\t\t\t\tnew MobileSyncBanner().showInPopup();\n\t\t\t\t}\n\n\t\t\t\tif (response.data.countEventWithEmailGuestAmount)\n\t\t\t\t{\n\t\t\t\t\tUtil.setEventWithEmailGuestAmount(response.data.countEventWithEmailGuestAmount);\n\t\t\t\t}\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\t// Dom.removeClass(this.DOM.saveBtn, this.BX.UI.Button.State.CLOCKING);\n\t\t\t\t// Dom.removeClass(this.DOM.closeBtn, this.BX.UI.Button.State.DISABLED);\n\t\t\t\tif (response.data && Type.isPlainObject(response.data.busyUsersList))\n\t\t\t\t{\n\t\t\t\t\tthis.handleBusyUsersError(response.data.busyUsersList);\n\n\t\t\t\t\tlet errors = [];\n\t\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\t\tif (error.code !== \"edit_entry_user_busy\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\terrors.push(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tresponse.errors = errors;\n\t\t\t\t}\n\n\t\t\t\tif (response.errors && response.errors.length)\n\t\t\t\t{\n\t\t\t\t\tthis.showError(response.errors);\n\t\t\t\t}\n\n\t\t\t\tthis.state = this.STATE.ERROR;\n\t\t\t}\n\t\t);\n\t}\n\n\thandleBusyUsersError(busyUsers)\n\t{\n\t\tlet\n\t\t\tusers = [],\n\t\t\tuserIds = [];\n\n\t\tfor (let id in busyUsers)\n\t\t{\n\t\t\tif (busyUsers.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tusers.push(busyUsers[id]);\n\t\t\t\tuserIds.push(id);\n\t\t\t}\n\t\t}\n\n\t\tthis.busyUsersDialog = new BusyUsersDialog();\n\t\tthis.busyUsersDialog.subscribe('onSaveWithout', () => {\n\t\t\tthis.excludeUsers = userIds.join(',');\n\t\t\tthis.save();\n\t\t});\n\n\t\tthis.busyUsersDialog.show({users: users});\n\t}\n\n\thandleKeyPress(e)\n\t{\n\t\tif(this.getMode() === CompactEventForm.EDIT_MODE\n\t\t\t&& e.keyCode === Util.getKeyCode('enter'))\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t\telse if(e.keyCode === Util.getKeyCode('escape')\n\t\t\t&& this.couldBeClosedByEsc())\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse if(e.keyCode === Util.getKeyCode('delete')\n\t\t\t&& !this.isNewEntry()\n\t\t\t&& this.canDo('delete'))\n\t\t{\n\t\t\tlet target = event.target || event.srcElement;\n\t\t\tif (Type.isDomNode(target) && target.tagName !== 'INPUT')\n\t\t\t{\n\t\t\t\tEntryManager.deleteEntry(this.entry);\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetCurrentEntry()\n\t{\n\t\treturn this.entry;\n\t}\n\n\tgetCurrentSection()\n\t{\n\t\tlet section = false;\n\t\tconst sectionId = this.getCurrentSectionId();\n\n\t\tif (sectionId\n\t\t\t&& this.sectionIndex[sectionId] !== undefined\n\t\t\t&& this.sections[this.sectionIndex[sectionId]] !== undefined)\n\t\t{\n\t\t\tsection = this.sections[this.sectionIndex[sectionId]];\n\t\t}\n\t\treturn section;\n\t}\n\n\tgetCurrentSectionId()\n\t{\n\t\tlet sectionId = 0;\n\t\tif (this.sectionValue)\n\t\t{\n\t\t\tsectionId = this.sectionValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst entry = this.getCurrentEntry();\n\t\t\tif (entry instanceof Entry)\n\t\t\t{\n\t\t\t\tsectionId = parseInt(entry.sectionId);\n\t\t\t}\n\n\t\t\tif (!sectionId\n\t\t\t\t&& this.lastUsedSection\n\t\t\t\t&& this.sections[this.sectionIndex[parseInt(this.lastUsedSection)]])\n\t\t\t{\n\t\t\t\tsectionId = parseInt(this.lastUsedSection);\n\t\t\t}\n\t\t\tif (!sectionId && this.sections[0])\n\t\t\t{\n\t\t\t\tsectionId = parseInt(this.sections[0].ID);\n\t\t\t}\n\t\t}\n\t\treturn sectionId;\n\t}\n\n\thandlePlannerSelectorChanges(event)\n\t{\n\t\tif (event instanceof BaseEvent)\n\t\t{\n\t\t\tconst dateTimeValue = this.dateTimeControl.getValue();\n\t\t\tdateTimeValue.from = event.getData().dateFrom;\n\t\t\tdateTimeValue.to = event.getData().dateTo;\n\t\t\t// Date time\n\t\t\tthis.dateTimeControl.setValue(dateTimeValue);\n\t\t\tthis.userPlannerSelector.setDateTime(this.dateTimeControl.getValue());\n\t\t}\n\t}\n\n\teditEntryInSlider()\n\t{\n\t\tthis.checkDataBeforeCloseMode = false;\n\t\tconst dateTime = this.dateTimeControl.getValue();\n\t\tBX.Calendar.EntryManager.openEditSlider({\n\t\t\tentry: this.entry,\n\t\t\ttype: this.type,\n\t\t\townerId: this.ownerId,\n\t\t\tuserId: this.userId,\n\t\t\tformDataValue: {\n\t\t\t\tsection: this.sectionValue,\n\t\t\t\tname: this.DOM.titleInput.value,\n\t\t\t\treminder: this.remindersControl.getSelectedRawValues(),\n\t\t\t\tcolor: this.colorSelector.getValue(),\n\t\t\t\tfrom: Util.adjustDateForTimezoneOffset(dateTime.from, -this.entry.userTimezoneOffsetFrom, dateTime.fullDay),\n\t\t\t\tto: Util.adjustDateForTimezoneOffset(dateTime.to, -this.entry.userTimezoneOffsetTo, dateTime.fullDay),\n\t\t\t\tfullDay: dateTime.fullDay,\n\t\t\t\tlocation: this.locationSelector.getTextValue(),\n\t\t\t\tmeetingNotify: this.userPlannerSelector.getInformValue() ? 'Y' : 'N',\n\t\t\t\thideGuests: this.hideGuests ? 'Y' : 'N',\n\t\t\t\tattendeesEntityList: this.userPlannerSelector.getEntityList()\n\t\t\t}\n\t\t});\n\t\tthis.close();\n\t}\n\n\toutsideMouseDownClose(event)\n\t{\n\t\tlet target = event.target || event.srcElement;\n\t\tthis.outsideMouseDown = !target.closest('div.popup-window');\n\t}\n\n\tcheckOutsideClickClose(event)\n\t{\n\t\tlet target = event.target || event.srcElement;\n\t\tthis.outsideMouseUp = !target.closest('div.popup-window');\n\t\tif(this.couldBeClosedByEsc()\n\t\t\t&& this.outsideMouseDown\n\t\t\t&& this.outsideMouseUp\n\t\t\t&& (this.getMode() === CompactEventForm.VIEW_MODE\n\t\t\t\t|| !this.formDataChanged()\n\t\t\t\t|| this.isNewEntry())\n\t\t)\n\t\t{\n\t\t\tsetTimeout(this.close.bind(this), 0);\n\t\t}\n\t}\n\n\tcouldBeClosedByEsc()\n\t{\n\t\treturn !PopupManager._popups.find((popup)=>{return popup && popup.getId() !== this.popupId && popup.isShown();});\n\t}\n\n\temitOnChange()\n\t{\n\t\tthis.emit('onChange', new BaseEvent({\n\t\t\tdata: {\n\t\t\t\tform: this,\n\t\t\t\tentry: this.entry\n\t\t\t}\n\t\t}));\n\t}\n\n\tshowError(errorList)\n\t{\n\t\tlet errorText = '';\n\n\t\tif (Type.isArray(errorList))\n\t\t{\n\t\t\terrorList.forEach((error) => {\n\t\t\t\terrorText += error.message + \"\\n\";\n\t\t\t});\n\t\t}\n\n\t\tif (errorText !== '')\n\t\t{\n\t\t\talert(errorText);\n\t\t}\n\t}\n}"],"names":["CompactEventForm","options","READY","REQUEST","ERROR","setEventNamespace","userId","Util","getCurrentUserId","type","ownerId","BX","getBX","checkForChanges","Runtime","debounce","checkForChangesImmediately","checkOutsideClickClose","bind","outsideMouseDownClose","keyHandler","handleKeyPress","mode","EDIT_MODE","params","setParams","setMode","state","STATE","popupId","Math","round","random","popup","destroy","getPopup","Dom","addClass","titleBar","removeClass","popupContainer","closeIcon","Event","document","prepareData","then","setFormValues","show","checkDataBeforeCloseMode","canDo","DOM","titleInput","focus","select","displayed","getMode","VIEW_MODE","sendAnalyticLabel","calendarAction","formType","userPlannerSelector","isPlannerDisplayed","checkBusyTime","Popup","bindNode","zIndex","Z_INDEX_OFFSET","closeByEsc","offsetTop","offsetLeft","draggable","resizable","lightShadow","className","cacheable","content","getPopupContent","buttons","getButtons","events","onPopupClose","close","formDataChanged","confirm","message","emit","unbind","closeAllPopups","wrap","Tag","render","titleOuterWrap","getTitleControl","getColorControl","getSectionControl","getDateTimeControl","getUserPlannerSelector","getTypeInfoControl","getLocationControl","remindersOuterWrap","Loc","getMessage","createRemindersControl","getRRuleInfoControl","push","UI","Button","text","isNewEntry","click","save","destroySelector","setButtons","editEntryInSlider","entry","isMeeting","getCurrentStatus","EntryManager","setMeetingStatus","refreshMeetingStatus","Calendar","openViewSlider","id","from","timezoneOffset","data","TZ_OFFSET_FROM","deleteEntry","EventEmitter","subscribeOnce","wasEverRecursive","length","button","displayAttendees","getAttendees","Type","isDomNode","loader","remove","emitOnChange","getCurrentEntry","excludes","fields","includes","name","value","locationSelector","getTextLocation","Location","parseStringValue","getLocation","getTextValue","dateTime","dateTimeControl","getValue","isFullDay","fullDay","toString","to","getMeetingNotify","getInformValue","parseInt","sectionId","sectionValue","getEntityList","map","item","entityId","join","getAttendeesEntityList","getformDataChanges","getEntryInstance","userIndex","isPlainObject","entryTime","isDate","setDateTimeValue","userSettings","locationFeatureEnabled","locationList","iblockMeetingRoomList","setSections","sections","trackingUserList","trackingUsersList","sectionIndex","isArray","forEach","ind","ID","Promise","resolve","section","getCurrentSection","ajax","runAction","entryId","loadSectionId","response","window","BXEventCalendar","Section","getCalendarContext","colorSelect","colorSelector","ColorSelector","subscribe","event","BaseEvent","color","getData","COLOR","sectionSelectWrap","sectionSelector","SectionSelector","outerWrap","defaultCalendarType","defaultOwnerId","sectionList","sectionGroupList","CalendarSectionManager","getSectionGroupList","selectCallback","setValue","dateTimeWrap","DateTimeControl","showTimezone","inlineEditMode","remindersControl","setFullDayMode","showPlanner","setLocationValue","setDateTime","refreshPlanner","userPlannerSelectorOuterWrap","userSelectorWrap","informWrap","plannerOuterWrap","hideGuestsWrap","UserPlannerSelector","readOnlyMode","handlePlannerSelectorChanges","openChatForEntry","parentId","locationWrap","locationOuterWrap","richLocationEnabled","inlineEditModeEnabled","onChangeCallback","undefined","reminderValues","remindersWrap","Reminder","values","reminders","REMIND","typeInfoTitle","typeInfoLink","typeInfoWrap","rruleInfo","rruleInfoWrap","timezoneInfo","timezoneInfoWrap","action","isResourcebooking","readOnly","adjustDateForTimezoneOffset","userTimezoneOffsetFrom","userTimezoneOffsetTo","timezoneFrom","getTimezoneFrom","timezoneTo","getTimezoneTo","timezoneName","setInlineEditMode","setViewMode","getName","titleLabel","parentNode","insertBefore","Text","encode","disabled","getColor","getCurrentSectionId","updateValue","getReminders","style","display","isRecursive","adjust","getRRuleDescription","location","attendeesEntityList","attendees","notify","viewMode","hideGuests","getHideGuests","updateSetMeetingButtons","hideInfoContainer","infoContainer","querySelector","i","childNodes","isElementNode","hasExternalEmailUsers","checkEmailLimitationPopup","emailLimitationDialogShown","showEmailLimitationDialog","callback","sendFromEmail","showConfirmedEmailDialog","confirmed","showConfirmEditDialog","recursionMode","sendInvitesAgain","find","STATUS","showReInviteUsersDialog","reminder","getSelectedValues","date_from","fromDate","date_to","toDate","skip_time","time_from","formatTime","time_to","tz_from","tz_to","meeting_notify","exclude_users","excludeUsers","hide_guests","EVENT_RRULE","RRULE","rec_edit_mode","current_date_from","formatDate","toLowerCase","analyticsLabel","emailGuests","markView","getCurrentView","markCrm","markRrule","markMeeting","markType","showEditEntryNotification","showNewEntryNotification","responseData","displayMobileBanner","MobileSyncBanner","showInPopup","countEventWithEmailGuestAmount","setEventWithEmailGuestAmount","busyUsersList","handleBusyUsersError","errors","error","code","showError","busyUsers","users","userIds","hasOwnProperty","busyUsersDialog","BusyUsersDialog","e","keyCode","getKeyCode","couldBeClosedByEsc","target","srcElement","tagName","Entry","lastUsedSection","dateTimeValue","dateFrom","dateTo","openEditSlider","formDataValue","getSelectedRawValues","meetingNotify","outsideMouseDown","closest","outsideMouseUp","setTimeout","PopupManager","_popups","getId","isShown","form","errorList","errorText","alert"],"mappings":"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"}