this.BX=this.BX||{};(function(e,t,i,s,n,r,a,o,l){"use strict";let c=e=>e,d,h,u,p,f,g,m,E,y,D,C,M,v,S,I,T,O,w,b,_,L,N,A,k,B,P,V,R,U,F,x;class W extends i.EventEmitter{constructor(e={}){super();this.STATE={READY:1,REQUEST:2,ERROR:3};this.zIndex=1200;this.Z_INDEX_OFFSET=-1e3;this.userSettings="";this.DOM={};this.displayed=false;this.sections=[];this.sectionIndex={};this.trackingUsersList=[];this.checkDataBeforeCloseMode=true;this.CHECK_CHANGES_DELAY=500;this.RELOAD_DATA_DELAY=500;this.setEventNamespace("BX.Calendar.CompactEventForm");this.userId=e.userId||s.Util.getCurrentUserId();this.type=e.type||"user";this.isLocationCalendar=e.isLocationCalendar||false;this.calendarContext=e.calendarContext||null;this.ownerId=e.ownerId||this.userId;this.BX=s.Util.getBX();this.checkForChangesDebounce=t.Runtime.debounce(this.checkForChanges,this.CHECK_CHANGES_DELAY,this);this.reloadEntryDataDebounce=t.Runtime.debounce(this.reloadEntryData,this.RELOAD_DATA_DELAY,this);this.checkOutsideClickClose=this.checkOutsideClickClose.bind(this);this.outsideMouseDownClose=this.outsideMouseDownClose.bind(this);this.keyHandler=this.handleKeyPress.bind(this)}show(e=W.EDIT_MODE,i={}){this.setParams(i);this.setMode(e);this.state=this.STATE.READY;this.popupId="compact-event-form-"+Math.round(Math.random()*1e5);if(this.popup){this.popup.destroy()}this.popup=this.getPopup(i);t.Dom.addClass(this.popup.titleBar,"calendar-add-popup-titlebar");t.Dom.removeClass(this.popup.popupContainer,"popup-window-with-titlebar");t.Dom.removeClass(this.popup.closeIcon,"popup-window-titlebar-close-icon");t.Event.bind(document,"mousedown",this.outsideMouseDownClose);t.Event.bind(document,"mouseup",this.checkOutsideClickClose);t.Event.bind(document,"keydown",this.keyHandler);t.Event.bind(this.popup.popupContainer,"transitionend",(()=>{t.Dom.removeClass(this.popup.popupContainer,"calendar-simple-view-popup-show")}));if(this.getMode()===W.EDIT_MODE){a.EntryManager.doDelayedActions()}this.prepareData().then((()=>{if(this.checkLocationView()){this.setFormValuesLocation()}else{this.setFormValues()}this.popup.show();if(this.userPlannerSelector&&(this.isLocationCalendar||this.userPlannerSelector.attendeesEntityList.length>1&&this.getMode()!==W.VIEW_MODE)){this.userPlannerSelector.showPlanner()}this.checkDataBeforeCloseMode=true;if(this.canDo("edit")&&this.DOM.titleInput&&e===W.EDIT_MODE){this.DOM.titleInput.focus();this.DOM.titleInput.select()}this.displayed=true;if(this.getMode()===W.VIEW_MODE){s.Util.sendAnalyticLabel({calendarAction:"view_event",formType:"compact"});this.popup.getButtons()[0].button.focus()}if(this.getMode()===W.EDIT_MODE&&!this.userPlannerSelector.isPlannerDisplayed()){this.userPlannerSelector.checkBusyTime()}}))}checkLocationView(){return this.getMode()===W.VIEW_MODE&&this.type==="location"}getPopup(e){return new n.Popup(this.popupId,e.bindNode,{zIndex:this.zIndex+this.Z_INDEX_OFFSET,closeByEsc:true,offsetTop:0,offsetLeft:0,closeIcon:true,titleBar:true,draggable:true,resizable:false,lightShadow:true,className:"calendar-simple-view-popup calendar-simple-view-popup-show",cacheable:false,content:this.checkLocationView()?this.getPopupContentLocation():this.getPopupContentCalendar(),buttons:this.getButtons(),events:{onPopupClose:this.close.bind(this)}})}isShown(){return this.displayed}close(e=true,i=false){if(!e&&!this.checkTopSlider()){if(this.popup){this.popup.destroyed=true;setTimeout((()=>{this.popup.destroyed=false}),0)}return}if(this.getMode()===W.EDIT_MODE&&this.formDataChanged()&&this.checkDataBeforeCloseMode&&!i){this.showConfirmClosePopup();if(this.popup){this.popup.destroyed=true;setTimeout((()=>{this.popup.destroyed=false}),0)}return}this.displayed=false;this.emit("onClose");t.Event.unbind(document,"mousedown",this.outsideMouseDownClose);t.Event.unbind(document,"mouseup",this.checkOutsideClickClose);t.Event.unbind(document,"keydown",this.keyHandler);if(this.userPlannerSelector){this.userPlannerSelector.destroy()}if(this.popup){this.popup.destroy()}if(r.Location){r.Location.setCurrentCapacity(0)}s.Util.clearPlannerWatches();s.Util.closeAllPopups()}getPopupContentCalendar(){this.DOM.wrap=t.Tag.render(d||(d=c`<div class="calendar-add-popup-wrap">
			${0}
			<div class="calendar-field-container calendar-field-container-choice">
				${0}
			</div>

			${0}

			${0}

			<div class="calendar-field-container calendar-field-container-info">
				${0}

					${0}

				${0}
				${0}
			</div>
		</div>`),this.DOM.titleOuterWrap=t.Tag.render(h||(h=c`
			<div class="calendar-field-container calendar-field-container-string-select">
				<div class="calendar-field-block">
					${0}
					${0}
					${0}
				</div>
			</div>`),this.getEntryCounter(),this.getTitleControl(),this.getColorControl()),this.getSectionControl("textselect"),this.getDateTimeControl(),this.getUserPlannerSelector(),this.getTypeInfoControl(),this.getLocationControl(),this.DOM.remindersOuterWrap=t.Tag.render(u||(u=c`
				<div class="calendar-field-block">
					<div class="calendar-field-title">${0}:</div>
					${0}
				</div>`),t.Loc.getMessage("EC_REMIND_LABEL"),this.createRemindersControl()),this.getRRuleInfoControl());return this.DOM.wrap}getPopupContentLocation(){this.DOM.wrap=t.Tag.render(p||(p=c`<div class="calendar-add-popup-wrap">
			${0}
			<div class="calendar-field-container calendar-field-container-choice">
				${0}
			</div>
			${0}
			
		</div>`),this.DOM.titleOuterWrap=t.Tag.render(f||(f=c`
			<div class="calendar-field-container calendar-field-container-string-select">
				<div class="calendar-field-block">
					${0}
					${0}
				</div>
			</div>`),this.getTitleControlLocation(),this.getColorControlsLocationView()),this.getSectionControl("location"),this.getDateTimeControl());if(this.entry.id!==this.entry.parentId){this.DOM.wrap.appendChild(t.Tag.render(g||(g=c`
				${0}
			`),this.getHostControl()))}return this.DOM.wrap}getButtons(){let e=[];const s=this.getMode();if(s===W.EDIT_MODE){const i=new BX.UI.Button({name:"save",text:this.isNewEntry()?t.Loc.getMessage("CALENDAR_EVENT_DO_ADD"):t.Loc.getMessage("CALENDAR_EVENT_DO_SAVE"),className:"ui-btn ui-btn-primary",events:{click:()=>{this.checkDataBeforeCloseMode=false;this.save()}}});i.button.setAttribute("data-role","saveButton");e.push(i);const s=new BX.UI.Button({text:t.Loc.getMessage("CALENDAR_EVENT_DO_CANCEL"),className:"ui-btn ui-btn-link",events:{click:()=>{if(this.isNewEntry()){this.checkDataBeforeCloseMode=false;this.close()}else{this.setFormValues();if(this.userPlannerSelector){this.userPlannerSelector.destroy()}this.setMode(W.VIEW_MODE);this.popup.setButtons(this.getButtons())}}}});s.button.setAttribute("data-role","closeButton");e.push(s);const n=new BX.UI.Button({text:t.Loc.getMessage("CALENDAR_EVENT_FULL_FORM"),className:"ui-btn calendar-full-form-btn",events:{click:this.editEntryInSlider.bind(this)}});n.button.setAttribute("data-role","fullForm");e.push(n)}else if(s===W.VIEW_MODE){if(this.entry.isMeeting()&&this.entry.getCurrentStatus()==="Q"){const i=new BX.UI.Button({className:"ui-btn ui-btn-primary",text:t.Loc.getMessage("EC_DESIDE_BUT_Y"),events:{click:()=>{a.EntryManager.setMeetingStatus(this.entry,"Y").then(this.refreshMeetingStatus.bind(this))}}});i.button.setAttribute("data-role","accept");e.push(i);const s=new BX.UI.Button({className:"ui-btn ui-btn-link",text:t.Loc.getMessage("EC_DESIDE_BUT_N"),events:{click:()=>{a.EntryManager.setMeetingStatus(this.entry,"N").then((()=>{if(this.isShown()){this.close()}}))}}});s.button.setAttribute("data-role","decline");e.push(s)}if(this.checkLocationView()){if(this.entry.id!==this.entry.parentId){e.push(new BX.UI.Button({className:`ui-btn ${this.entry.isMeeting()&&this.entry.getCurrentStatus()==="Q"?"ui-btn-link":"ui-btn-primary"}`,text:t.Loc.getMessage("CALENDAR_EVENT_DO_OPEN_PARENT"),events:{click:()=>{this.checkDataBeforeCloseMode=false;BX.Calendar.EntryManager.openViewSlider(this.entry.parentId,{userId:this.userId,from:this.entry.from,timezoneOffset:this.entry&&this.entry.data?this.entry.data.TZ_OFFSET_FROM:null});this.close()}}}));if(this.canDo("release")){e.push(new BX.UI.Button({name:"release",text:t.Loc.getMessage("CALENDAR_EVENT_DO_RELEASE"),className:"ui-btn ui-btn-light-border",events:{click:()=>{this.checkDataBeforeCloseMode=false;this.releaseLocation()}}}))}}else{e.push(new BX.UI.Button({className:`ui-btn ui-btn-disabled`,text:t.Loc.getMessage("CALENDAR_UPDATE_PROGRESS")}))}}else{const i=new BX.UI.Button({className:`ui-btn ${this.entry.isMeeting()&&this.entry.getCurrentStatus()==="Q"?"ui-btn-link":"ui-btn-primary"}`,text:t.Loc.getMessage("CALENDAR_EVENT_DO_OPEN"),events:{click:()=>{this.checkDataBeforeCloseMode=false;BX.Calendar.EntryManager.openViewSlider(this.entry.id,{entry:this.entry,calendarContext:this.calendarContext,type:this.type,ownerId:this.ownerId,userId:this.userId,from:this.entry.from,timezoneOffset:this.entry&&this.entry.data?this.entry.data.TZ_OFFSET_FROM:null});this.close()}}});i.button.setAttribute("data-role","openButton");e.push(i)}if(this.entry.isMeeting()&&this.entry.getCurrentStatus()==="N"){const i=new BX.UI.Button({className:"ui-btn ui-btn-link",text:t.Loc.getMessage("EC_DESIDE_BUT_Y"),events:{click:()=>{a.EntryManager.setMeetingStatus(this.entry,"Y").then(this.refreshMeetingStatus.bind(this))}}});i.button.setAttribute("data-role","accept");e.push(i)}if(this.entry.isMeeting()&&this.entry.getCurrentStatus()==="Y"){const i=new BX.UI.Button({className:"ui-btn ui-btn-link",text:t.Loc.getMessage("EC_DESIDE_BUT_N"),events:{click:()=>{a.EntryManager.setMeetingStatus(this.entry,"N").then((()=>{if(this.isShown()){this.close()}}))}}});i.button.setAttribute("data-role","decline");e.push(i)}if(!this.isNewEntry()&&this.canDo("edit")&&this.type!=="location"){e.push(new BX.UI.Button({text:t.Loc.getMessage("CALENDAR_EVENT_DO_EDIT"),className:"ui-btn ui-btn-link",events:{click:this.editEntryInSlider.bind(this)}}))}if(!this.isNewEntry()&&this.canDo("delete")&&!this.checkLocationView()){if(!this.entry.isMeeting()||!this.entry.getCurrentStatus()||this.entry.getCurrentStatus()==="H"||this.entry.data["CREATED_BY"]===this.entry.data["MEETING_HOST"]){e.push(new BX.UI.Button({text:t.Loc.getMessage("CALENDAR_EVENT_DO_DELETE"),className:"ui-btn ui-btn-link",events:{click:()=>{i.EventEmitter.subscribeOnce("BX.Calendar.Entry:beforeDelete",(()=>{this.checkDataBeforeCloseMode=false;this.close()}));a.EntryManager.deleteEntry(this.entry);if(!this.entry.wasEverRecursive()){this.close()}}}}))}}}if(e.length>2){e[1].button.className="ui-btn ui-btn-light-border"}return e}freezePopup(){if(this.popup){this.popup.buttons.forEach((e=>{var t;if((e==null?void 0:(t=e.options)==null?void 0:t.name)==="save"){e.setClocking(true)}else{e.setDisabled(true)}}))}}unfreezePopup(){if(this.popup){this.popup.buttons.forEach((e=>{e.setClocking(false);e.setDisabled(false)}))}}refreshMeetingStatus(){this.emit("doRefresh");this.popup.setButtons(this.getButtons());if(this.entry.isInvited()){t.Dom.removeClass(this.DOM.entryCounter,"calendar-event-invite-counter-none")}else{t.Dom.addClass(this.DOM.entryCounter,"calendar-event-invite-counter-none")}if(this.userPlannerSelector){this.userPlannerSelector.displayAttendees(this.entry.getAttendees())}}hideLoader(){if(t.Type.isDomNode(this.DOM.loader)){t.Dom.remove(this.DOM.loader);this.DOM.loader=null}}showInEditMode(e={}){return this.show(W.EDIT_MODE,e)}showInViewMode(e={}){return this.show(W.VIEW_MODE,e)}setMode(e){if(e==="edit"||e==="view"){this.mode=e}}getMode(){return this.mode}checkForChanges(){if(!this.isNewEntry()&&this.getMode()===W.VIEW_MODE&&this.formDataChanged()){this.setMode(W.EDIT_MODE);this.popup.setButtons(this.getButtons())}else if(!this.isNewEntry()&&this.getMode()===W.EDIT_MODE&&!this.formDataChanged()){this.setMode(W.VIEW_MODE);this.popup.setButtons(this.getButtons())}this.emitOnChange()}checkLocationForm(e){if(e&&e instanceof i.BaseEvent){const t=e.getData();const i=t.usersCount;let s=r.Location.getCurrentCapacity()||0;if(this.locationSelector.value.type===undefined){if(s){s=0;r.Location.setCurrentCapacity(0)}}if(s<i&&s!==0){this.locationSelector.addCapacityAlert()}else{this.locationSelector.removeCapacityAlert()}}}getFormDataChanges(e=[]){const t=this.entry;let i=[];if(!e.includes("name")&&t.name!==this.DOM.titleInput.value){i.push("name")}if(!e.includes("location")&&this.locationSelector.getTextLocation(r.Location.parseStringValue(t.getLocation()))!==this.locationSelector.getTextLocation(r.Location.parseStringValue(this.locationSelector.getTextValue()))){i.push("location")}const s=this.dateTimeControl.getValue();if(!e.includes("date&time")&&(t.isFullDay()!==s.fullDay||s.from.toString()!==t.from.toString()||s.to.toString()!==t.to.toString())){i.push("date&time")}if(!e.includes("notify")&&(!t.isMeeting()||t.getMeetingNotify())!==this.userPlannerSelector.getInformValue()){i.push("notify")}if(!e.includes("section")&&parseInt(t.sectionId)!==parseInt(this.sectionValue)){i.push("section")}if(!e.includes("codes")&&this.userPlannerSelector.getEntityList().map((e=>e.entityId+":"+e.id)).join("|")!==t.getAttendeesEntityList().map((e=>e.entityId+":"+e.id)).join("|")){i.push("codes")}return i}formDataChanged(){return this.getFormDataChanges().length>0}setParams(e={}){this.userId=e.userId||s.Util.getCurrentUserId();this.type=e.type||"user";this.isLocationCalendar=e.isLocationCalendar||false;this.locationAccess=e.locationAccess||false;this.dayOfWeekMonthFormat=e.dayOfWeekMonthFormat||false;this.calendarContext=e.calendarContext||null;this.ownerId=e.ownerId?e.ownerId:0;if(this.type==="user"&&!this.ownerId){this.ownerId=this.userId}this.entry=a.EntryManager.getEntryInstance(e.entry,e.userIndex,{type:this.type,ownerId:this.ownerId});this.sectionValue=null;if(!this.entry.id&&t.Type.isPlainObject(e.entryTime)&&t.Type.isDate(e.entryTime.from)&&t.Type.isDate(e.entryTime.to)){this.entry.setDateTimeValue(e.entryTime)}if(t.Type.isPlainObject(e.userSettings)){this.userSettings=e.userSettings}this.locationFeatureEnabled=!!e.locationFeatureEnabled;this.locationList=t.Type.isArray(e.locationList)?e.locationList.filter((e=>e.PERM.view_full)):[];this.roomsManager=e.roomsManager||null;this.iblockMeetingRoomList=e.iblockMeetingRoomList||[];this.plannerFeatureEnabled=!!e.plannerFeatureEnabled;this.setSections(e.sections,e.trackingUserList)}setSections(e,i=[]){this.sections=e;this.sectionIndex={};this.trackingUsersList=i||[];if(t.Type.isArray(this.sections)){this.sections.forEach(((e,t)=>{const i=parseInt(e.ID||e.id);if(i>0){this.sectionIndex[i]=t}}),this)}const s=this.getCurrentSection();if(this.entry.id){this.getSectionsForEditEvent(this.sections,s)}}prepareData(e={}){return new Promise((e=>{const t=this.getCurrentSection();if(t&&t.canDo){e()}else{this.BX.ajax.runAction("calendar.api.calendarajax.getCompactFormData",{data:{entryId:this.entry.id,loadSectionId:this.entry.sectionId}}).then((t=>{if(t&&t.data&&t.data.section){this.sections.push(new window.BXEventCalendar.Section(s.Util.getCalendarContext(),t.data.section));this.setSections(this.sections);e()}}))}}))}getEntryCounter(){if(!this.DOM.entryCounter){this.DOM.entryCounter=t.Tag.render(m||(m=c`
				<span class="calendar-event-invite-counter calendar-event-invite-counter-big">1</span>
			`))}if(this.entry.isInvited()){t.Dom.removeClass(this.DOM.entryCounter,"calendar-event-invite-counter-none")}else{t.Dom.addClass(this.DOM.entryCounter,"calendar-event-invite-counter-none")}return this.DOM.entryCounter}getTitleControl(){this.DOM.titleInput=t.Tag.render(E||(E=c`
			<input class="calendar-field calendar-field-string"
				value=""
				placeholder="${0}"
				type="text"
			/>
		`),t.Loc.getMessage("EC_ENTRY_NAME"));t.Event.bind(this.DOM.titleInput,"keyup",this.checkForChangesDebounce);t.Event.bind(this.DOM.titleInput,"change",this.checkForChangesDebounce);return this.DOM.titleInput}getTitleControlLocation(){this.DOM.titleInput=t.Tag.render(y||(y=c`
			<input class="calendar-field calendar-field-string"
				value=""
				placeholder="${0}"
				type="text"
				readonly
			/>
		`),t.Loc.getMessage("EC_ENTRY_NAME"));return this.DOM.titleInput}getHostControl(){const e=this.entry.data.CREATED_BY;const i=W.USER_URL.replace("#USER_ID#",e);const s=this.BX.Calendar.EntryManager.userIndex[e]?this.BX.Calendar.EntryManager.userIndex[e].AVATAR:"";this.DOM.hostBar=t.Tag.render(D||(D=c`
			<div class="calendar-slider-detail-option-without-border">
				<div class="calendar-slider-detail-option-block">
					<div class="calendar-field-value">
						${0}
					</div>
					<span class="calendar-field-location-host-img">
						<a href="${0}">
							<img class="calendar-field-location-host-img-value" src="${0}" alt="">
						</a>
					</span>
					<div class="calendar-slider-detail-option-value">
						<a href="${0}" class="calendar-slider-sidebar-user-info-name calendar-slider-sidebar-user-info-name-padding">${0}</a>
					</div>
				</div>
			</div>
		`),t.Loc.getMessage("EC_HOST")+": ",i,s,i,BX.util.htmlspecialchars(this.entry.name));return this.DOM.hostBar}getColorControl(){this.DOM.colorSelect=t.Tag.render(C||(C=c`<div class="calendar-field calendar-field-select calendar-field-tiny"></div>`));this.colorSelector=new r.ColorSelector({wrap:this.DOM.colorSelect,mode:"selector"});this.colorSelector.subscribe("onChange",(e=>{if(e instanceof i.BaseEvent){const t=e.getData().value;if(!this.isNewEntry()&&(this.canDo("edit")||this.entry.getCurrentStatus()!==false)){this.BX.ajax.runAction("calendar.api.calendarajax.updateColor",{data:{entryId:this.entry.id,userId:this.userId,color:t}});this.entry.data.COLOR=t;this.emit("doRefresh");this.emitOnChange()}}}));return this.DOM.colorSelect}getColorControlsLocationView(){this.DOM.colorSelect=t.Tag.render(M||(M=c`<div class="calendar-field calendar-field-select calendar-colorpicker-readonly calendar-field-tiny"></div>`));this.colorSelector=new r.ColorSelector({wrap:this.DOM.colorSelect,mode:"view"});return this.DOM.colorSelect}getSectionControl(e){this.DOM.sectionSelectWrap=t.Tag.render(v||(v=c`<div class="calendar-field-choice-calendar"></div>`));this.sectionSelector=new r.SectionSelector({outerWrap:this.DOM.sectionSelectWrap,defaultCalendarType:this.type,defaultOwnerId:this.ownerId,sectionList:this.sections,sectionGroupList:o.SectionManager.getSectionGroupList({type:this.type,ownerId:this.ownerId,userId:this.userId,trackingUsersList:this.trackingUsersList}),mode:e,zIndex:this.zIndex,getCurrentSection:()=>{const e=this.getCurrentSection();if(e){return{id:e.id,name:e.name,color:e.color}}return false},selectCallback:e=>{if(e){if(this.colorSelector){this.colorSelector.setValue(e.color)}this.sectionValue=e.id;this.checkForChangesDebounce();o.SectionManager.saveDefaultSectionId(this.sectionValue)}}});return this.DOM.sectionSelectWrap}getDateTimeControl(){this.DOM.dateTimeWrap=t.Tag.render(S||(S=c`<div class="calendar-field-container calendar-field-container-datetime"></div>`));this.dateTimeControl=new r.DateTimeControl(null,{showTimezone:false,outerWrap:this.DOM.dateTimeWrap,inlineEditMode:true});this.dateTimeControl.subscribe("onChange",(e=>{if(e instanceof i.BaseEvent){let t=e.getData().value;if(this.remindersControl){this.remindersControl.setFullDayMode(t.fullDay);if(this.isNewEntry()&&!this.remindersControl.wasChangedByUser()){const e=a.EntryManager.getNewEntryReminders(t.fullDay?"fullDay":"withTime");this.remindersControl.setValue(e,false)}}if(this.userPlannerSelector){if(!this.userPlannerSelector.isPlannerDisplayed()){this.userPlannerSelector.showPlanner()}this.userPlannerSelector.setLocationValue(this.locationSelector.getTextValue());this.userPlannerSelector.setDateTime(t,true);this.userPlannerSelector.refreshPlannerStateDebounce()}if(this.locationSelector){this.locationSelector.checkLocationAccessibility({from:e.getData().value.from,to:e.getData().value.to,fullDay:e.getData().value.fullDay,currentEventId:this.entry.id})}this.checkForChangesDebounce()}}));return this.DOM.dateTimeWrap}getUserPlannerSelector(){this.DOM.userPlannerSelectorOuterWrap=t.Tag.render(I||(I=c`<div>
			<div class="calendar-field-container calendar-field-container-members">
				${0}
				<span class="calendar-videocall-wrap calendar-videocall-hidden"></span>
				${0}
			</div>
			<div class="calendar-user-selector-wrap"></div>
			<div class="calendar-add-popup-planner-wrap calendar-add-popup-show-planner">
				${0}
			</div>
			${0}
		<div>`),this.DOM.userSelectorWrap=t.Tag.render(T||(T=c`
				<div class="calendar-field-block">
					<div class="calendar-members-selected">
						<span class="calendar-attendees-label"></span>
						<span class="calendar-attendees-list"></span>
						<span class="calendar-members-more">${0}</span>
						<span class="calendar-members-change-link">${0}</span>
					</div>
				</div>`),t.Loc.getMessage("EC_ATTENDEES_MORE"),t.Loc.getMessage("EC_SEC_SLIDER_CHANGE")),this.DOM.informWrap=t.Tag.render(O||(O=c`
				<div class="calendar-field-container-inform">
					<span class="calendar-field-container-inform-text">${0}</span>
				</div>`),t.Loc.getMessage("EC_NOTIFY_OPTION")),this.DOM.plannerOuterWrap=t.Tag.render(w||(w=c`
				<div class="calendar-planner-wrapper" style="height: 0">
				</div>`)),this.DOM.hideGuestsWrap=t.Tag.render(b||(b=c`
			<div class="calendar-hide-members-container" style="display: none;">
				<div class="calendar-hide-members-container-inner">
					<div class="calendar-hide-members-icon-hidden"></div>
					<div class="calendar-hide-members-text">${0}</div>
					<span class="calendar-hide-members-helper" data-hint="${0}"></span>
				</div>
			</div>`),t.Loc.getMessage("EC_HIDE_GUEST_NAMES"),t.Loc.getMessage("EC_HIDE_GUEST_NAMES_HINT")));this.userPlannerSelector=new r.UserPlannerSelector({outerWrap:this.DOM.userPlannerSelectorOuterWrap,wrap:this.DOM.userSelectorWrap,informWrap:this.DOM.informWrap,plannerOuterWrap:this.DOM.plannerOuterWrap,hideGuestsWrap:this.DOM.hideGuestsWrap,readOnlyMode:false,userId:this.userId,type:this.type,ownerId:this.ownerId,zIndex:this.zIndex+10,plannerFeatureEnabled:this.plannerFeatureEnabled,dayOfWeekMonthFormat:this.dayOfWeekMonthFormat});this.userPlannerSelector.subscribe("onDateChange",this.handlePlannerSelectorChanges.bind(this));this.userPlannerSelector.subscribe("onNotifyChange",this.checkForChangesDebounce);this.userPlannerSelector.subscribe("onUserCodesChange",this.checkForChangesDebounce);return this.DOM.userPlannerSelectorOuterWrap}getLocationControl(){this.DOM.locationWrap=t.Tag.render(_||(_=c`<div class="calendar-field-place"></div>`));this.DOM.locationOuterWrap=t.Tag.render(L||(L=c`<div class="calendar-field-block">
			<div class="calendar-field-title calendar-field-title-align-top">${0}:</div>
			${0}
		</div>`),t.Loc.getMessage("EC_LOCATION_LABEL"),this.DOM.locationWrap);this.locationSelector=new r.Location({wrap:this.DOM.locationWrap,richLocationEnabled:this.locationFeatureEnabled,locationList:this.locationList||[],roomsManager:this.roomsManager||null,locationAccess:this.locationAccess||false,iblockMeetingRoomList:this.iblockMeetingRoomList||[],inlineEditModeEnabled:!this.isLocationCalendar,onChangeCallback:()=>{if(this.userPlannerSelector){this.userPlannerSelector.setLocationValue(this.locationSelector.getTextValue());if(this.locationSelector.getValue().type!==undefined&&!this.userPlannerSelector.isPlannerDisplayed()){this.userPlannerSelector.showPlanner()}this.userPlannerSelector.refreshPlannerStateDebounce()}this.checkForChangesDebounce()}});if(this.userPlannerSelector){var e;this.userPlannerSelector.subscribe("onDisplayAttendees",this.checkLocationForm.bind(this));(e=this.userPlannerSelector.planner)==null?void 0:e.subscribe("onDisplayAttendees",this.checkLocationForm.bind(this))}return this.DOM.locationOuterWrap}createRemindersControl(){this.reminderValues=[];this.DOM.remindersWrap=t.Tag.render(N||(N=c`<div class="calendar-text"></div>`));this.remindersControl=new r.Reminder({wrap:this.DOM.remindersWrap,zIndex:this.zIndex});this.remindersControl.subscribe("onChange",(e=>{if(e instanceof i.BaseEvent){this.reminderValues=e.getData().values;if(!this.isNewEntry()&&(this.canDo("edit")||this.entry.getCurrentStatus()!==false)){this.BX.ajax.runAction("calendar.api.calendarajax.updateReminders",{data:{entryId:this.entry.id,userId:this.userId,reminders:this.reminderValues}}).then((e=>{this.entry.data.REMIND=e.data.REMIND}))}}}));return this.DOM.remindersWrap}getTypeInfoControl(){this.DOM.typeInfoTitle=t.Tag.render(A||(A=c`<div class="calendar-field-title"></div>`));this.DOM.typeInfoLink=t.Tag.render(k||(k=c`<div class="calendar-field-link"></div>`));this.DOM.typeInfoWrap=t.Tag.render(B||(B=c`
			<div class="calendar-field-block" style="display: none">
				${0}
				${0}
			</div>
		`),this.DOM.typeInfoTitle,this.DOM.typeInfoLink);return this.DOM.typeInfoWrap}getRRuleInfoControl(){this.DOM.rruleInfo=t.Tag.render(P||(P=c`<div class="calendar-text"></div>`));this.DOM.rruleInfoWrap=t.Tag.render(V||(V=c`
			<div class="calendar-field-block" style="display: none">
				<div class="calendar-field-title">${0}:</div>
				${0}
			</div>
		`),t.Loc.getMessage("EC_REPEAT"),this.DOM.rruleInfo);return this.DOM.rruleInfoWrap}getTimezoneInfoControl(){this.DOM.timezoneInfo=t.Tag.render(R||(R=c`<div class="calendar-text"></div>`));this.DOM.timezoneInfoWrap=t.Tag.render(U||(U=c`
			<div class="calendar-field-block" style="display: none">
				<div class="calendar-field-title">${0}:</div>
				${0}
			</div>
		`),t.Loc.getMessage("EC_TIMEZONE"),this.DOM.timezoneInfo);return this.DOM.timezoneInfoWrap}isNewEntry(){return!this.entry.id}canDo(e){const t=this.getCurrentSection();if(e==="edit"||e==="delete"){if(this.entry.isMeeting()&&this.entry.id!==this.entry.parentId){return false}if(this.entry.isResourcebooking()){return false}if(this.entry.permissions){var i;return(i=this.entry.permissions)==null?void 0:i["edit"]}return t.canDo("edit")}if(e==="view"){if(this.entry.permissions){var s;return(s=this.entry.permissions)==null?void 0:s["view_time"]}return t.canDo("view_time")}if(e==="viewFull"){if(this.entry.permissions){var n;return(n=this.entry.permissions)==null?void 0:n["view_full"]}return t.canDo("view_full")}if(e==="release"){return t.canDo("access")}return true}setFormValues(){const e=this.entry;const i=this.getCurrentSection();const n=!this.canDo("edit");this.dateTimeControl.setValue({from:s.Util.adjustDateForTimezoneOffset(e.from,e.userTimezoneOffsetFrom,e.fullDay),to:s.Util.adjustDateForTimezoneOffset(e.to,e.userTimezoneOffsetTo,e.fullDay),fullDay:e.fullDay,timezoneFrom:e.getTimezoneFrom()||"",timezoneTo:e.getTimezoneTo()||"",timezoneName:this.userSettings.timezoneName});this.dateTimeControl.setInlineEditMode(this.isNewEntry()?"edit":"view");this.dateTimeControl.setViewMode(n);this.DOM.titleInput.value=e.getName();if(n){if(this.entry.getCurrentStatus()===false){this.DOM.titleInput.type="hidden";this.DOM.titleLabel=this.DOM.titleInput.parentNode.insertBefore(t.Tag.render(F||(F=c`<span class="calendar-field calendar-field-string">${0}</span>`),t.Text.encode(e.getName())),this.DOM.titleInput);t.Dom.addClass(this.DOM.titleOuterWrap,"calendar-field-container-view")}else{this.DOM.titleInput.disabled=true}}this.colorSelector.setValue(e.getColor()||i.color,false);this.colorSelector.setViewMode(n&&this.entry.getCurrentStatus()===false);this.sectionValue=this.getCurrentSectionId();this.sectionSelector.updateValue();if(this.isSyncSection(i)&&e.id){this.sectionSelector.setViewMode(true)}else{this.sectionSelector.setViewMode(n)}this.remindersControl.setValue(e.getReminders(),false);this.remindersControl.setViewMode(n&&this.entry.getCurrentStatus()===false);if(n&&this.entry.getCurrentStatus()===false){this.DOM.remindersOuterWrap.style.display="none"}if(e.isRecursive()){this.DOM.rruleInfoWrap.style="";t.Dom.adjust(this.DOM.rruleInfo,{text:e.getRRuleDescription()})}let r=e.getLocation();if(n&&!r){this.DOM.locationOuterWrap.style.display="none"}else{this.locationSelector.setViewMode(n);if(this.isLocationCalendar){this.locationSelector.setValue(this.locationSelector.default);r=this.locationSelector.default}else{this.DOM.locationOuterWrap.style.display="";this.locationSelector.setValue(e.getLocation())}}if(this.locationSelector){this.locationSelector.checkLocationAccessibility({from:this.dateTimeControl.getValue().from,to:this.dateTimeControl.getValue().to,fullDay:this.dateTimeControl.getValue().fullDay,currentEventId:this.entry.id})}if(this.userPlannerSelector&&(this.canDo("viewFull")||e.getCurrentStatus()!==false)){this.userPlannerSelector.setValue({attendeesEntityList:e.getAttendeesEntityList(),location:r,attendees:e.getAttendees(),notify:!e.isMeeting()||e.getMeetingNotify(),viewMode:this.getMode()===W.VIEW_MODE,entry:e,hideGuests:e.getHideGuests()});this.userPlannerSelector.setDateTime(this.dateTimeControl.getValue());this.userPlannerSelector.setViewMode(n)}else{t.Dom.remove(this.DOM.userPlannerSelectorOuterWrap)}let a=true;this.DOM.infoContainer=this.DOM.wrap.querySelector(".calendar-field-container-info");for(let e=0;e<=this.DOM.infoContainer.childNodes.length;e++){if(t.Type.isElementNode(this.DOM.infoContainer.childNodes[e])&&this.DOM.infoContainer.childNodes[e].style.display!=="none"){a=false}}if(a){this.DOM.infoContainer.style.display="none"}}setFormValuesLocation(){let e=this.entry,i=this.getCurrentSection(),n=true;this.dateTimeControl.setValue({from:s.Util.adjustDateForTimezoneOffset(e.from,e.userTimezoneOffsetFrom,e.fullDay),to:s.Util.adjustDateForTimezoneOffset(e.to,e.userTimezoneOffsetTo,e.fullDay),fullDay:e.fullDay,timezoneFrom:e.getTimezoneFrom()||"",timezoneTo:e.getTimezoneTo()||"",timezoneName:this.userSettings.timezoneName});this.dateTimeControl.setInlineEditMode(this.isNewEntry()?"edit":"view");this.dateTimeControl.setViewMode(n);if(this.entry.id!==this.entry.parentId){this.DOM.titleInput.value=i.name+": "+BX.util.htmlspecialchars(e.getName())}else{this.DOM.titleInput.value=t.Loc.getMessage("CALENDAR_UPDATE")}this.colorSelector.setValue(e.getColor()||i.color,false);this.colorSelector.setViewMode(!n);this.sectionValue=this.getCurrentSectionId();this.sectionSelector.updateValue();this.sectionSelector.setViewMode(n)}save(e={}){if(this.state===this.STATE.REQUEST){return false}const n=this.getCurrentEntry();e=t.Type.isPlainObject(e)?e:{};if(this.isNewEntry()&&this.userPlannerSelector.hasExternalEmailUsers()&&s.Util.checkEmailLimitationPopup()&&!e.emailLimitationDialogShown){a.EntryManager.showEmailLimitationDialog({callback:t=>{e.emailLimitationDialogShown=true;this.save(e)}});return false}if(!this.userSettings.sendFromEmail&&this.userPlannerSelector.hasExternalEmailUsers()){a.EntryManager.showConfirmedEmailDialog({callback:t=>{this.save(e)}});return false}if(!this.isNewEntry()&&n.isRecursive()&&!e.confirmed&&this.getFormDataChanges(["section","notify"]).length>0){a.EntryManager.showConfirmEditDialog({callback:t=>{e.recursionMode=n.isFirstInstance()&&t.recursionMode==="next"?"all":t.recursionMode;e.confirmed=true;this.save(e)}});return false}if(!this.isNewEntry()&&n.isMeeting()&&e.sendInvitesAgain===undefined&&this.getFormDataChanges().includes("date&time")&&n.getAttendees().find((e=>e.STATUS==="N"))){a.EntryManager.showReInviteUsersDialog({callback:t=>{e.sendInvitesAgain=t.sendInvitesAgain;this.save(e)}});return false}if(!this.isNewEntry()&&n.isRecursive()&&!e.confirmed&&this.getFormDataChanges().includes("section")){e.recursionMode=n.isFirstInstance()?"all":"next"}const o=this.dateTimeControl.getValue();const l={id:n.id,section:this.sectionValue,name:this.DOM.titleInput.value,desc:n.getDescription(),reminder:this.remindersControl.getSelectedValues(),date_from:o.fromDate,date_to:o.toDate,skip_time:o.fullDay?"Y":"N",time_from:s.Util.formatTime(s.Util.adjustDateForTimezoneOffset(o.from,-n.userTimezoneOffsetFrom,o.fullDay)),time_to:s.Util.formatTime(s.Util.adjustDateForTimezoneOffset(o.to,-n.userTimezoneOffsetTo,o.fullDay)),location:this.locationSelector.getTextValue(),tz_from:n.getTimezoneFrom(),tz_to:n.getTimezoneTo(),meeting_notify:this.userPlannerSelector.getInformValue()?"Y":"N",meeting_host:n.data.MEETING_HOST||"0",chat_id:n.data.MEETING?n.data.MEETING.CHAT_ID:0,exclude_users:this.excludeUsers||[],attendeesEntityList:this.userPlannerSelector.getEntityList(),sendInvitesAgain:e.sendInvitesAgain?"Y":"N",hide_guests:this.userPlannerSelector.hideGuests?"Y":"N",requestUid:BX.Calendar.Util.registerRequestId(),private_event:n.isPrivate()?"Y":"N"};let c=!n.id||this.checkCurrentUsersAccessibility();if(!c&&this.getFormDataChanges().includes("codes")){const e=n.getAttendeesEntityList();const t=[];l.attendeesEntityList.forEach((i=>{if(!e.find((e=>i.entityId===e.entityId&&parseInt(i.id)===parseInt(e.id)))){if(i.entityId==="user"){t.push(i.id)}else{c=true}}}));l.newAttendeesList=t}l.checkCurrentUsersAccessibility=c?"Y":"N";if(n.id&&n.isRecursive()){l.EVENT_RRULE=n.data.RRULE}if(e.recursionMode){l.rec_edit_mode=e.recursionMode;l.current_date_from=s.Util.formatDate(n.from)}if(this.getCurrentSection().color.toLowerCase()!==this.colorSelector.getValue().toLowerCase()){l.color=this.colorSelector.getValue()}this.state=this.STATE.REQUEST;this.freezePopup();this.BX.ajax.runAction("calendar.api.calendarentryajax.editEntry",{data:l,analyticsLabel:{calendarAction:this.isNewEntry()?"create_event":"edit_event",formType:"compact",emailGuests:this.userPlannerSelector.hasExternalEmailUsers()?"Y":"N",markView:s.Util.getCurrentView()||"outside",markCrm:"N",markRrule:"NONE",markMeeting:this.entry.isMeeting()?"Y":"N",markType:this.type}}).then((c=>{if(this.isLocationCalendar&&this.roomsManager){this.roomsManager.unsetHiddenRoom(r.Location.parseStringValue(l.location).room_id)}const d=this.getCurrentSection();if(d&&!d.isShown()){d.show()}this.unfreezePopup();this.state=this.STATE.READY;if(c.data.entryId){if(n.id){a.EntryManager.showEditEntryNotification(c.data.entryId)}else{a.EntryManager.showNewEntryNotification(c.data.entryId)}}this.emit("onSave",new i.BaseEvent({data:{responseData:c.data,options:e}}));this.close();if(c.data.countEventWithEmailGuestAmount){s.Util.setEventWithEmailGuestAmount(c.data.countEventWithEmailGuestAmount)}if(t.Type.isArray(c.data.eventList)&&c.data.eventList.length&&c.data.eventList[0].REMIND){a.EntryManager.setNewEntryReminders(o.fullDay?"fullDay":"withTime",c.data.eventList[0].REMIND)}}),(e=>{this.unfreezePopup();if(e.data&&t.Type.isPlainObject(e.data.busyUsersList)){this.handleBusyUsersError(e.data.busyUsersList);let t=[];e.errors.forEach((e=>{if(e.code!=="edit_entry_user_busy"){t.push(e)}}));e.errors=t}if(e.errors&&e.errors.length){this.showError(e.errors)}this.state=this.STATE.ERROR}));return true}handleBusyUsersError(e){let t=[],i=[];for(let s in e){if(e.hasOwnProperty(s)){t.push(e[s]);i.push(s)}}this.busyUsersDialog=new r.BusyUsersDialog;this.busyUsersDialog.subscribe("onSaveWithout",(()=>{this.excludeUsers=i.join(",");this.save()}));this.busyUsersDialog.show({users:t})}handleKeyPress(e){if(this.getMode()===W.EDIT_MODE&&e.keyCode===s.Util.getKeyCode("enter")&&(e.ctrlKey||e.metaKey)&&!e.altKey){this.checkDataBeforeCloseMode=false;this.locationSelector.selectContol.onChangeCallback();this.save()}else if(this.checkTopSlider()&&e.keyCode===s.Util.getKeyCode("escape")&&e.type==="keyup"&&this.couldBeClosedByEsc()){this.close()}else if(e.keyCode===s.Util.getKeyCode("delete")&&!this.isNewEntry()&&this.canDo("delete")){const e=event.target||event.srcElement;const s=t.Type.isElementNode(e)?e.tagName.toLowerCase():null;if(s&&!["input","textarea"].includes(s)){i.EventEmitter.subscribeOnce("BX.Calendar.Entry:beforeDelete",(()=>{this.checkDataBeforeCloseMode=false;this.close()}));a.EntryManager.deleteEntry(this.entry)}}else if(e.keyCode===s.Util.getKeyCode("enter")&&this.DOM.confirmPopup){this.close(true,true)}}getCurrentEntry(){return this.entry}getCurrentSection(){let e=false;const t=this.getCurrentSectionId();if(t&&this.sectionIndex[t]!==undefined&&this.sections[this.sectionIndex[t]]!==undefined){e=this.sections[this.sectionIndex[t]]}return e}getCurrentSectionId(){let e=0;if(this.sectionValue){e=this.sectionValue}else{const t=this.getCurrentEntry();if(t instanceof a.Entry){e=parseInt(t.sectionId)}if(!e&&this.sections[0]){e=parseInt(this.sections[0].id)}}return e}handlePlannerSelectorChanges(e){if(e instanceof i.BaseEvent){const t=this.dateTimeControl.getValue();t.from=e.getData().dateFrom;t.to=e.getData().dateTo;this.dateTimeControl.setValue(t);this.userPlannerSelector.setDateTime(this.dateTimeControl.getValue());if(this.locationSelector){this.locationSelector.checkLocationAccessibility({from:e.getData().dateFrom,to:e.getData().dateTo,fullDay:e.getData().fullDay,currentEventId:this.entry.id})}this.checkForChangesDebounce()}}editEntryInSlider(){this.checkDataBeforeCloseMode=false;const e=this.dateTimeControl.getValue();const t=s.Util.getCalendarContext();BX.Calendar.EntryManager.openEditSlider({calendarContext:t,entry:this.entry,type:this.type,isLocationCalendar:this.isLocationCalendar,locationAccess:this.locationAccess,dayOfWeekMonthFormat:this.dayOfWeekMonthFormat,roomsManager:this.roomsManager,locationCapacity:r.Location.getCurrentCapacity(),ownerId:this.ownerId,userId:this.userId,formDataValue:{section:this.sectionValue,name:this.DOM.titleInput.value,reminder:this.remindersControl.getSelectedRawValues(),color:this.colorSelector.getValue(),from:s.Util.adjustDateForTimezoneOffset(e.from,-this.entry.userTimezoneOffsetFrom,e.fullDay),to:s.Util.adjustDateForTimezoneOffset(e.to,-this.entry.userTimezoneOffsetTo,e.fullDay),fullDay:e.fullDay,location:this.locationSelector.getTextValue(),meetingNotify:this.userPlannerSelector.getInformValue()?"Y":"N",hideGuests:this.userPlannerSelector.hideGuests?"Y":"N",attendeesEntityList:this.userPlannerSelector.getEntityList()}});this.close()}outsideMouseDownClose(e){let t=e.target||e.srcElement;this.outsideMouseDown=!t.closest("div.popup-window")}checkTopSlider(){return!s.Util.getBX().SidePanel.Instance.getTopSlider()}checkOutsideClickClose(e){let t=e.target||e.srcElement;this.outsideMouseUp=!t.closest("div.popup-window");if(this.couldBeClosedByEsc()&&this.outsideMouseDown&&this.outsideMouseUp&&(this.getMode()===W.VIEW_MODE||!this.formDataChanged()||this.isNewEntry())){setTimeout((()=>{this.close(false)}),0)}}couldBeClosedByEsc(){return!n.PopupManager._popups.find((e=>e&&e.getId()!==this.popupId&&e.isShown()))}emitOnChange(){this.emit("onChange",new i.BaseEvent({data:{form:this,entry:this.entry}}))}showError(e){let i="";if(t.Type.isArray(e)){e.forEach((e=>{i+=e.message+"\n"}))}if(i!==""){alert(i)}}reloadEntryData(){if(this.isShown()&&!this.isNewEntry()&&this.getMode()===W.VIEW_MODE){const e=s.Util.getCalendarContext();if(e){const t=a.EntryManager.getEntryInstance(e.getView().getEntryById(this.entry.getUniqueId()));if(t&&t.getUniqueId()){this.entry=t;this.setFormValues()}}}}checkCurrentUsersAccessibility(){return this.getFormDataChanges().includes("date&time")}handlePull(e){var i,s,n;if(this.userPlannerSelector&&(i=this.userPlannerSelector)!=null&&(s=i.planner)!=null&&s.isShown()){var r,a,o,l;const i=t.Type.isArray(e==null?void 0:(r=e.fields)==null?void 0:r.ATTENDEES)?e.fields.ATTENDEES:[];const s=(e==null?void 0:(a=e.fields)==null?void 0:a.CAL_TYPE)==="user"?parseInt(e==null?void 0:(o=e.fields)==null?void 0:o.OWNER_ID):parseInt(e==null?void 0:(l=e.fields)==null?void 0:l.CREATED_BY);if(!i.includes(s)){i.push(s)}this.userPlannerSelector.clearAccessibilityData(i);this.userPlannerSelector.refreshPlannerStateDebounce()}const c=this.getCurrentEntry();if(!this.isNewEntry()&&c&&c.parentId===parseInt(e==null?void 0:(n=e.fields)==null?void 0:n.PARENT_ID)){var d;if(e.command==="delete_event"&&c.getType()===(e==null?void 0:(d=e.fields)==null?void 0:d.CAL_TYPE)){this.close()}else{const e=()=>{this.reloadEntryDataDebounce();BX.Event.EventEmitter.unsubscribe("BX.Calendar:onEntryListReload",e)};BX.Event.EventEmitter.subscribe("BX.Calendar:onEntryListReload",e)}}}isSyncSection(e){return e.isGoogle()||e.isIcloud()||e.isOffice365()||e.isCalDav()||e.hasConnection()}getSectionsForEditEvent(e,i){const s=[];const n=i.type;s.push(i);e.forEach((e=>{if(!this.isSyncSection(e)&&e.type===n){s.push(e)}}));this.sections=s;this.sectionIndex=[];if(t.Type.isArray(this.sections)){this.sections.forEach(((e,t)=>{const i=parseInt(e.ID||e.id);if(i>0){this.sectionIndex[i]=t}}),this)}}releaseLocation(e={}){const t=this.getCurrentEntry();if(t.id&&t.isRecursive()&&!e.confirmed){a.EntryManager.showConfirmEditDialog({callback:t=>{e.confirmed=true;this.releaseLocation({recursionMode:t.recursionMode,confirmed:true})}});return false}if(!e.recursionMode){e.recursionMode=""}this.state=this.STATE.REQUEST;this.freezePopup();this.BX.ajax.runAction("calendar.api.locationajax.cancelBooking",{data:{parent_event_id:t.parentId,recursion_mode:e.recursionMode,section_id:t.sectionId,current_event_date_from:t.data.DATE_FROM,current_event_date_to:t.data.DATE_TO,owner_id:t.data.CREATED_BY}}).then((e=>{this.unfreezePopup();this.state=this.STATE.READY;a.EntryManager.showReleaseLocationNotification();this.calendarContext.reloadDebounce();this.close()}),(e=>{this.unfreezePopup();this.state=this.STATE.ERROR;this.close()}));return true}showConfirmClosePopup(){this.DOM.confirmPopup=new l.MessageBox({message:this.getConfirmContent(),minHeight:120,minWidth:280,maxWidth:300,buttons:BX.UI.Dialogs.MessageBoxButtons.OK_CANCEL,onOk:()=>{this.close(true,true)},onCancel:()=>{this.DOM.confirmPopup.close()},okCaption:t.Loc.getMessage("EC_SEC_SLIDER_CLOSE"),popupOptions:{events:{onPopupClose:()=>{delete this.DOM.confirmPopup}},closeByEsc:true,padding:0,contentPadding:0,animation:"fading-slide"}});this.DOM.confirmPopup.show()}getConfirmContent(){return t.Tag.render(x||(x=c`
			<div class="calendar-list-slider-messagebox-text">${0}</div>
		`),t.Loc.getMessage("EC_LEAVE_EVENT_CONFIRM_QUESTION")+"<br>"+t.Loc.getMessage("EC_LEAVE_EVENT_CONFIRM_DESC"))}}W.VIEW_MODE="view";W.EDIT_MODE="edit";W.USER_URL="/company/personal/user/#USER_ID#/";e.CompactEventForm=W})(this.BX.Calendar=this.BX.Calendar||{},BX,BX.Event,BX.Calendar,BX.Main,BX.Calendar.Controls,BX.Calendar,BX.Calendar,BX.UI.Dialogs);
//# sourceMappingURL=compacteventform.bundle.map.js