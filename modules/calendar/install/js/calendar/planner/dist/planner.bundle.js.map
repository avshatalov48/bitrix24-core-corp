{"version":3,"file":"planner.bundle.js","sources":["../src/selector.js","../src/planner.js"],"sourcesContent":["\"use strict\";\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Util} from 'calendar.util';\nimport {Type, Dom, Tag} from 'main.core';\nimport { EventDragAndDrop } from 'calendar.ui.tools.draganddrop';\n\nexport class Selector extends EventEmitter\n{\n\tDOM = {};\n\tselectMode = false;\n\tcurrentDateFrom = new Date();\n\tcurrentDateTo = new Date();\n\tcurrentFullDay = false;\n\tuseAnimation = true;\n\tmagnetDuration = 50;\n\tstickDistanceInMinutes = 30;\n\tmagnetizeDistanceInMinutes = 15;\n\n\tconstructor(params = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.Planner.Selector');\n\n\t\tthis.selectMode = params.selectMode;\n\t\tthis.getPosByDate = params.getPosByDate;\n\t\tthis.getDateByPos = params.getDateByPos;\n\t\tthis.getPosDateMap = params.getPosDateMap;\n\t\tthis.getTimelineWidth = params.getTimelineWidth;\n\t\tthis.getScaleInfo = params.getScaleInfo;\n\t\tthis.solidStatus = params.solidStatus;\n\n\t\tthis.eventDragAndDrop = new EventDragAndDrop(params.getDateByPos, params.getPosByDate, params.getEvents);\n\n\t\tthis.useAnimation = params.useAnimation !== false;\n\t\tthis.DOM.timelineWrap = params.timelineWrap;\n\t\tthis.DOM.timelineFixedWrap = params.timelineFixedWrap;\n\n\t\tthis.render();\n\t}\n\n\trender()\n\t{\n\t\tthis.DOM.wrap = Tag.render`\n\t\t\t<div class=\"calendar-planner-timeline-selector\" data-bx-planner-meta=\"selector\">\n\t\t\t\t<span data-bx-planner-meta=\"selector-resize-left\" class=\"calendar-planner-timeline-drag-left\"></span>\n\t\t\t\t<span class=\"calendar-planner-timeline-selector-grip\"></span>\n\t\t\t\t<span data-bx-planner-meta=\"selector-resize-right\" class=\"calendar-planner-timeline-drag-right\"></span>\n\t\t\t</div>`;\n\n\t\t// prefent draging selector and activating uploader controll in livefeed\n\t\tthis.DOM.wrap.ondrag = BX.False;\n\t\tthis.DOM.wrap.ondragstart = BX.False;\n\n\t\tthis.DOM.titleNode = Tag.render`<div class=\"calendar-planner-selector-notice\" style=\"display: none\"></div>`;\n\n\t\tif (this.selectMode)\n\t\t{\n\t\t\tresult.controlWrap = this.DOM.wrap.appendChild(Tag.render`<div class=\"calendar-planner-selector-control\"></div>`);\n\t\t}\n\t}\n\n\tgetWrap()\n\t{\n\t\treturn this.DOM.wrap;\n\t}\n\n\tgetTitleNode()\n\t{\n\t\treturn this.DOM.titleNode;\n\t}\n\n\t/**\n\t *\n\t *\n\t * @params array array of parameters\n\t * @params[from]\n\t * @params[to]\n\t * @params[updateScaleType] bool\n\t * @params[updateScaleLimits] bool\n\t *\n\t * @return null\n\t */\n\tupdate(params = {})\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tparams.updateScaleType = !!params.updateScaleType;\n\t\tparams.updateScaleLimits = !!params.updateScaleLimits;\n\t\tparams.animation = !!params.animation;\n\n\t\tlet from = Type.isDate(params.from) ? params.from : BX.parseDate(params.from) || this.currentDateFrom;\n\t\tlet to = Type.isDate(params.to) ? params.to : BX.parseDate(params.to) || this.currentDateTo;\n\t\tthis.fullDayMode = params.fullDay !== undefined ? params.fullDay : this.currentFullDay;\n\n\t\tif (Type.isDate(from) && Type.isDate(to))\n\t\t{\n\t\t\tthis.currentFullDay = this.fullDayMode;\n\n\t\t\tif (this.fullDayMode)\n\t\t\t{\n\t\t\t\tfrom.setHours(0, 0, 0, 0);\n\t\t\t\tconst dayCount = Math.ceil((to.getTime() - from.getTime() + 1) / (1000 * 3600 * 24));\n\t\t\t\tto = new Date(from.getTime() + (dayCount - 1) * 24 * 3600 * 1000);\n\t\t\t\tto.setHours(23, 55, 0, 0);\n\t\t\t}\n\n\t\t\tthis.currentDateFrom = from;\n\t\t\tthis.currentDateTo = to;\n\n\t\t\t// Update selector\n\t\t\tthis.show(\n\t\t\t\tfrom,\n\t\t\t\tto,\n\t\t\t\t{\n\t\t\t\t\tanimation: params.animation,\n\t\t\t\t\tfocus: params.focus\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tconst isSelectorInThePast = this.currentDateTo.getTime() < this.getScaleInfo().scaleDateFrom.getTime();\n\t\tconst isSelectorInTheFuture = this.currentDateFrom.getTime() > this.getScaleInfo().scaleDateTo.getTime();\n\t\tif (isSelectorInThePast || isSelectorInTheFuture)\n\t\t{\n\t\t\tthis.DOM.wrap.style.display = 'none';\n\t\t}\n\t}\n\n\tshow(from, to, params)\n\t{\n\t\tconst animation = params.animation && this.useAnimation !== false;\n\t\tconst focus = params.focus === true;\n\t\tconst alignCenter = params.alignCenter !== false;\n\n\t\tthis.DOM.wrap.style.display = 'block';\n\n\t\tif (Type.isDate(from) && Type.isDate(to))\n\t\t{\n\t\t\tlet\n\t\t\t\tfromPos = this.getPosByDate(from),\n\t\t\t\ttoPos = this.getPosByDate(to);\n\n\t\t\tthis.DOM.wrap.style.width = (toPos - fromPos) + 'px';\n\n\t\t\tif (animation && this.DOM.wrap.style.left && !this.currentFullDay)\n\t\t\t{\n\t\t\t\tthis.transit({\n\t\t\t\t\ttoX: fromPos,\n\t\t\t\t\ttriggerChangeEvents: false,\n\t\t\t\t\tfocus: focus\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.wrap.style.left = fromPos + 'px';\n\t\t\t\tthis.DOM.wrap.style.width = (toPos - fromPos) + 'px';\n\t\t\t\tif (focus)\n\t\t\t\t{\n\t\t\t\t\tthis.focus(true, 200, alignCenter);\n\t\t\t\t}\n\t\t\t\tthis.checkStatus(fromPos, true);\n\t\t\t}\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tthis.DOM.wrap.style.display = 'none';\n\t}\n\n\tstartMove()\n\t{\n\t\tdocument.addEventListener('pointermove', this.preventDefault, { passive:false });\n\t\tthis.selectorIsDraged = true;\n\t\tthis.selectorStartLeft = parseInt(this.DOM.wrap.style.left);\n\t\tthis.selectorStartScrollLeft = this.DOM.timelineWrap.scrollLeft;\n\n\t\tthis.eventDragAndDrop.onDragStart(this.currentDateTo.getTime() - this.currentDateFrom.getTime(), this.selectorStartLeft);\n\n\t\tDom.addClass(document.body, 'calendar-planner-unselectable');\n\t}\n\n\tmove(x)\n\t{\n\t\tif (this.selectorIsDraged)\n\t\t{\n\t\t\tlet pos = this.selectorStartLeft + x;\n\n\t\t\t// Correct cursor position acording to changes of scrollleft\n\t\t\tpos -= this.selectorStartScrollLeft - this.DOM.timelineWrap.scrollLeft;\n\t\t\tpos = this.checkPosition(pos);\n\n\t\t\tif (!this.getDateByPos(pos) || !this.getDateByPos(pos + parseInt(this.DOM.wrap.style.width)))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet boundary = this.eventDragAndDrop.getDragBoundary(pos);\n\t\t\tboundary = this.getAutoScrollBoundary(boundary);\n\t\t\tboundary = this.getConstrainedBoundary(boundary);\n\t\t\tthis.setBoundary(boundary);\n\t\t}\n\t}\n\n\tgetAutoScrollBoundary(boundary)\n\t{\n\t\tconst boundaryLeft = boundary.position - this.DOM.timelineWrap.scrollLeft;\n\t\tconst containerLeft = this.getPosByDate(this.getScaleInfo().scaleDateFrom);\n\t\tconst boundaryRight = boundaryLeft + boundary.size;\n\t\tconst containerRight = this.DOM.timelineFixedWrap.offsetWidth;\n\n\t\tif (boundaryRight > containerRight)\n\t\t{\n\t\t\tthis.scrollSpeed = this.getSpeed(boundaryRight, containerRight);\n\t\t\tboundary.position = containerRight + this.DOM.timelineWrap.scrollLeft - boundary.size;\n\t\t\tthis.setAutoScrollInterval(boundary, 1);\n\t\t}\n\t\telse if (boundaryLeft < containerLeft)\n\t\t{\n\t\t\tthis.scrollSpeed = this.getSpeed(boundaryLeft, containerLeft);\n\t\t\tboundary.position = containerLeft + this.DOM.timelineWrap.scrollLeft;\n\t\t\tthis.setAutoScrollInterval(boundary, -1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.stopAutoScroll();\n\t\t}\n\n\t\treturn boundary;\n\t}\n\n\tgetSpeed(x1, x2)\n\t{\n\t\treturn Math.floor(Math.sqrt(Math.abs(x1 - x2))) + 1;\n\t}\n\n\tsetAutoScrollInterval(boundary, direction)\n\t{\n\t\tif (!this.scrollInterval)\n\t\t{\n\t\t\tthis.scrollInterval = setInterval(() => {\n\t\t\t\tif (!this.getDateByPos(boundary.position + this.scrollSpeed * direction)\n\t\t\t\t\t|| !this.getDateByPos(boundary.position + boundary.size + this.scrollSpeed * direction)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.stopAutoScroll();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.DOM.timelineWrap.scrollLeft += this.scrollSpeed * direction;\n\t\t\t\tboundary.position += this.scrollSpeed * direction;\n\t\t\t\tboundary.from = this.getDateByPos(boundary.position);\n\t\t\t\tboundary.to = this.getDateByPos(boundary.position + boundary.size);\n\t\t\t\tthis.eventDragAndDrop.setFinalTimeInterval(boundary.from, boundary.to);\n\t\t\t\tthis.setBoundary(boundary);\n\t\t\t}, 13);\n\t\t}\n\t}\n\n\tstopAutoScroll()\n\t{\n\t\tclearInterval(this.scrollInterval);\n\t\tthis.scrollInterval = false;\n\t}\n\n\tsetBoundary(boundary)\n\t{\n\t\tif (boundary.wasMagnetized)\n\t\t{\n\t\t\tthis.DOM.wrap.style.transition = 'left .05s, width .1s';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.wrap.style.transition = 'width .1s';\n\t\t}\n\n\t\tthis.DOM.wrap.style.width = boundary.size + 'px';\n\t\tthis.DOM.wrap.style.left = boundary.position + 'px';\n\n\t\tthis.showTitle(boundary.from, boundary.to);\n\n\t\tthis.checkStatus(boundary.position, true);\n\t}\n\n\tgetConstrainedBoundary(boundary)\n\t{\n\t\tif (boundary.wasMagnetized || this.fullDayMode)\n\t\t{\n\t\t\treturn boundary;\n\t\t}\n\n\t\tlet from = new Date(boundary.from.getTime());\n\t\tlet to = new Date(boundary.to.getTime());\n\t\tconst duration = to.getTime() - from.getTime();\n\t\tlet position = boundary.position;\n\t\tlet size = boundary.size;\n\t\tlet wasMagnetized = false;\n\n\t\tif (from.getHours() < this.getScaleInfo().shownTimeFrom)\n\t\t{\n\t\t\tfrom.setHours(this.getScaleInfo().shownTimeFrom, 0, 0, 0);\n\t\t\tto = new Date(from.getTime() + duration);\n\t\t\twasMagnetized = true;\n\t\t\tposition = this.getPosByDate(from);\n\t\t\tsize = this.getPosByDate(to) - position;\n\t\t}\n\n\t\tif (to.getHours() > this.getScaleInfo().shownTimeTo\n\t\t\t|| (to.getHours() === this.getScaleInfo().shownTimeTo && to.getMinutes() > 0))\n\t\t{\n\t\t\tto.setHours(this.getScaleInfo().shownTimeTo, 0, 0, 0);\n\t\t\tfrom = new Date(to.getTime() - duration);\n\t\t\twasMagnetized = true;\n\t\t\tposition = this.getPosByDate(from);\n\t\t\tsize = this.getPosByDate(to) - position;\n\t\t}\n\n\t\treturn { from, to, position, size, wasMagnetized };\n\t}\n\n\tendMove()\n\t{\n\t\tdocument.removeEventListener('pointermove', this.preventDefault, { passive:false });\n\t\tthis.stopAutoScroll();\n\t\tif (this.selectorIsDraged)\n\t\t{\n\t\t\tthis.selectorIsDraged = false;\n\n\t\t\tconst left = this.getPosByDate(this.eventDragAndDrop.getFinalFrom());\n\t\t\tconst right = this.getPosByDate(this.eventDragAndDrop.getFinalTo());\n\n\t\t\tconst finalBoundary = this.getConstrainedBoundary({\n\t\t\t\tfrom: this.eventDragAndDrop.getFinalFrom(),\n\t\t\t\tto: this.eventDragAndDrop.getFinalTo(),\n\t\t\t\tposition: left,\n\t\t\t\tsize: right - left\n\t\t\t});\n\n\t\t\tthis.DOM.wrap.style.left = finalBoundary.position + 'px';\n\t\t\tthis.DOM.wrap.style.width = finalBoundary.size + 'px';\n\t\t\tthis.DOM.wrap.style.transition = 'none';\n\n\t\t\tthis.checkStatus(left, true);\n\t\t\tthis.hideTitle();\n\t\t\tthis.setValue();\n\t\t}\n\t\tthis.selectorIsDraged = false;\n\t}\n\n\tstartResize()\n\t{\n\t\tdocument.addEventListener('pointermove', this.preventDefault, { passive:false });\n\n\t\tthis.selectorIsResized = true;\n\n\t\tthis.selectorStartLeft = parseInt(this.DOM.wrap.style.left);\n\t\tthis.selectorStartWidth = parseInt(this.DOM.wrap.style.width);\n\t\tthis.selectorStartScrollLeft = this.DOM.timelineWrap.scrollLeft;\n\t}\n\n\tresize(x)\n\t{\n\t\tif (this.selectorIsResized)\n\t\t{\n\t\t\tlet\n\t\t\t\ttoDate,\n\t\t\t\ttimeTo,\n\t\t\t\twidth = this.selectorStartWidth + x;\n\n\t\t\t// Correct cursor position according to changes of scrollLeft\n\t\t\twidth -= this.selectorStartScrollLeft - this.DOM.timelineWrap.scrollLeft;\n\t\t\tlet rightPos = Math.min(this.selectorStartLeft + width, this.getTimelineWidth());\n\t\t\tif (rightPos < this.selectorStartLeft)\n\t\t\t{\n\t\t\t\trightPos = this.selectorStartLeft;\n\t\t\t}\n\n\t\t\ttoDate = this.getDateByPos(rightPos, true);\n\n\t\t\tif (this.fullDayMode)\n\t\t\t{\n\t\t\t\ttimeTo = parseInt(toDate.getHours()) + Math.round((toDate.getMinutes() / 60) * 10) / 10;\n\t\t\t\ttoDate.setHours(0, 0, 0, 0);\n\t\t\t\tif (timeTo > 12)\n\t\t\t\t{\n\t\t\t\t\ttoDate = new Date(toDate.getTime() + Util.getDayLength());\n\t\t\t\t\ttoDate.setHours(0, 0, 0, 0);\n\t\t\t\t}\n\t\t\t\trightPos = this.getPosByDate(toDate);\n\t\t\t}\n\t\t\telse if (this.getScaleInfo().shownTimeFrom !== 0 || this.getScaleInfo().shownTimeTo !== 24)\n\t\t\t{\n\t\t\t\tlet fromDate = this.getDateByPos(this.selectorStartLeft);\n\t\t\t\tif (toDate && fromDate && fromDate.getDate() !== toDate.getDate())\n\t\t\t\t{\n\t\t\t\t\ttoDate = new Date(fromDate.getTime());\n\t\t\t\t\ttoDate.setHours(this.getScaleInfo().shownTimeTo, 0, 0, 0);\n\t\t\t\t\trightPos = this.getPosByDate(toDate);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.getPosDateMap()[rightPos])\n\t\t\t{\n\t\t\t\tthis.selectorRoundedRightPos = rightPos;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet roundedPos = Selector.roundPos(rightPos);\n\t\t\t\tif (this.getPosDateMap()[roundedPos])\n\t\t\t\t{\n\t\t\t\t\tthis.selectorRoundedRightPos = roundedPos;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.selectorRoundedRightPos < this.selectorStartLeft)\n\t\t\t{\n\t\t\t\tthis.selectorRoundedRightPos = this.selectorStartLeft;\n\t\t\t}\n\n\t\t\tif (this.selectorRoundedRightPos - this.DOM.timelineWrap.scrollLeft > this.DOM.timelineFixedWrap.offsetWidth)\n\t\t\t{\n\t\t\t\tthis.selectorRoundedRightPos = this.DOM.timelineWrap.scrollLeft + this.DOM.timelineFixedWrap.offsetWidth;\n\t\t\t}\n\n\t\t\twidth = this.selectorRoundedRightPos - this.selectorStartLeft;\n\n\t\t\tthis.DOM.wrap.style.width = width + 'px';\n\t\t\tthis.showTitle(this.getDateByPos(this.selectorStartLeft), this.getDateByPos(this.selectorRoundedRightPos));\n\t\t\tthis.checkStatus(this.selectorStartLeft, true);\n\t\t}\n\t}\n\n\tendResize()\n\t{\n\t\tdocument.removeEventListener('pointermove', this.preventDefault, { passive:false });\n\t\tif (this.selectorIsResized)\n\t\t{\n\t\t\tthis.selectorIsResized = false;\n\n\t\t\tlet left = parseInt(this.DOM.wrap.style.left);\n\t\t\tlet right = left + parseInt(this.DOM.wrap.style.width);\n\t\t\tconst from = this.getDateByPos(left);\n\t\t\tconst to = this.getDateByPos(right);\n\t\t\tleft = this.getPosByDate(from);\n\t\t\tright = this.getPosByDate(to);\n\t\t\tthis.DOM.wrap.style.width = (right - left) + 'px';\n\n\t\t\tthis.checkStatus(left, true);\n\t\t\tthis.hideTitle();\n\t\t\tthis.setValue();\n\t\t}\n\t\tthis.selectorIsResized = false;\n\t}\n\n\tpreventDefault(e)\n\t{\n\t\te.preventDefault();\n\t}\n\n\tisDragged()\n\t{\n\t\treturn this.selectorIsResized || this.selectorIsDraged;\n\t}\n\n\tcheckStatus(selectorPos, checkPosition)\n\t{\n\t\tif (this.solidStatus)\n\t\t{\n\t\t\tDom.removeClass(this.DOM.wrap, 'calendar-planner-timeline-selector-warning');\n\t\t\tDom.removeClass(this.mainContWrap, 'calendar-planner-selector-warning');\n\t\t\tDom.addClass(this.DOM.wrap, 'solid');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!selectorPos)\n\t\t\t{\n\t\t\t\tselectorPos = Selector.roundPos(this.DOM.wrap.style.left);\n\t\t\t}\n\n\t\t\tlet fromDate, toDate;\n\t\t\tif (checkPosition === true || !this.currentDateFrom)\n\t\t\t{\n\t\t\t\tlet\n\t\t\t\t\tselectorWidth = parseInt(this.DOM.wrap.style.width),\n\t\t\t\t\tfromPos = selectorPos,\n\t\t\t\t\ttoPos = fromPos + selectorWidth;\n\n\t\t\t\tif (!fromPos && !toPos && !selectorWidth && this.lastFromDate)\n\t\t\t\t{\n\t\t\t\t\tfromDate = this.lastFromDate;\n\t\t\t\t\ttoDate = this.lastToDate;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfromDate = this.getDateByPos(fromPos);\n\t\t\t\t\ttoDate = this.getDateByPos(toPos, true);\n\t\t\t\t\tthis.lastFromDate = fromDate;\n\t\t\t\t\tthis.lastToDate = toDate;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfromDate = this.currentDateFrom;\n\t\t\t\ttoDate = this.currentDateTo;\n\t\t\t}\n\n\t\t\tthis.emit(\n\t\t\t\t'doCheckStatus',\n\t\t\t\tnew BaseEvent(\n\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tdateFrom: fromDate,\n\t\t\t\t\t\t\tdateTo: toDate\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\tsetSelectorStatus(status)\n\t{\n\t\tthis.selectorIsFree = status;\n\t\tif (this.selectorIsFree)\n\t\t{\n\t\t\tDom.removeClass(this.DOM.wrap, 'calendar-planner-timeline-selector-warning');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.DOM.wrap, 'calendar-planner-timeline-selector-warning');\n\t\t}\n\t}\n\n\tsetValue(selectorPos = null, duration = null)\n\t{\n\t\tif (!selectorPos)\n\t\t{\n\t\t\tselectorPos = parseInt(this.DOM.wrap.style.left);\n\t\t}\n\t\tselectorPos = Math.max(0, selectorPos);\n\t\tconst selectorWidth = parseInt(this.DOM.wrap.style.width);\n\n\t\tif (selectorPos + selectorWidth > parseInt(this.getTimelineWidth()))\n\t\t{\n\t\t\tselectorPos = parseInt(this.getTimelineWidth()) - selectorWidth;\n\t\t}\n\n\t\tconst dateFrom = this.getDateByPos(selectorPos);\n\t\tlet dateTo;\n\t\tif (duration)\n\t\t{\n\t\t\tdateTo = new Date(dateFrom.getTime() + duration);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdateTo = this.getDateByPos(selectorPos + selectorWidth, true);\n\t\t}\n\n\t\tif (dateFrom && dateTo)\n\t\t{\n\t\t\tif (this.fullDayMode)\n\t\t\t{\n\t\t\t\tconst dayCount = Math.ceil((dateTo.getTime() - dateFrom.getTime()) / (1000 * 3600 * 24));\n\t\t\t\tdateTo = new Date(dateFrom.getTime() + (dayCount - 1) * 24 * 3600 * 1000);\n\t\t\t\tdateTo.setHours(23, 55, 0, 0);\n\t\t\t}\n\t\t\tif (!this.fullDayMode && dateFrom.getDate() !== dateTo.getDate() && dateTo.getHours() !== 0 && dateTo.getMinutes() !== 0)\n\t\t\t{\n\t\t\t\tconst duration = this.currentDateTo.getTime() - this.currentDateFrom.getTime();\n\t\t\t\tdateTo = new Date(dateFrom.getTime() + duration);\n\t\t\t}\n\n\t\t\tthis.currentDateFrom = dateFrom;\n\t\t\tthis.currentDateTo = dateTo;\n\t\t\tthis.currentFullDay = this.fullDayMode;\n\n\t\t\tthis.emit('onChange', new BaseEvent({data: {\n\t\t\t\tdateFrom: dateFrom,\n\t\t\t\tdateTo: dateTo,\n\t\t\t\tfullDay: this.fullDayMode\n\t\t\t}}));\n\t\t}\n\t}\n\n\tcheckPosition(fromPos, selectorWidth, toPos)\n\t{\n\t\tlet scaleInfo = this.getScaleInfo();\n\t\tif (!this.fullDayMode && scaleInfo.shownTimeFrom === 0 && scaleInfo.shownTimeTo === 24)\n\t\t{\n\t\t\treturn fromPos;\n\t\t}\n\n\t\tfromPos = fromPos || parseInt(this.DOM.wrap.style.left);\n\t\tselectorWidth = selectorWidth || parseInt(this.DOM.wrap.style.width);\n\t\ttoPos = toPos || (fromPos + selectorWidth);\n\t\tif (toPos > parseInt(this.getTimelineWidth()))\n\t\t{\n\t\t\tfromPos = parseInt(this.getTimelineWidth()) - selectorWidth;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet\n\t\t\t\tfromDate = this.getDateByPos(fromPos),\n\t\t\t\ttoDate = this.getDateByPos(toPos, true),\n\t\t\t\ttimeFrom, timeTo,\n\t\t\t\tscaleTimeFrom = parseInt(scaleInfo.shownTimeFrom),\n\t\t\t\tscaleTimeTo = parseInt(scaleInfo.shownTimeTo);\n\n\t\t\tif (fromDate && toDate)\n\t\t\t{\n\t\t\t\tif (this.fullDayMode)\n\t\t\t\t{\n\t\t\t\t\tif (fromDate.getHours() > 12)\n\t\t\t\t\t{\n\t\t\t\t\t\tfromDate = new Date(fromDate.getTime() + Util.getDayLength());\n\t\t\t\t\t}\n\t\t\t\t\tfromDate.setHours(0, 0, 0, 0);\n\n\t\t\t\t\tfromPos = this.getPosByDate(fromDate);\n\t\t\t\t}\n\t\t\t\telse if (fromDate.getDay() !== toDate.getDay())\n\t\t\t\t{\n\t\t\t\t\ttimeFrom = parseInt(fromDate.getHours()) + Math.round((fromDate.getMinutes() / 60) * 10) / 10;\n\t\t\t\t\ttimeTo = parseInt(toDate.getHours()) + Math.round((toDate.getMinutes() / 60) * 10) / 10;\n\n\t\t\t\t\tif (Math.abs(scaleTimeTo - timeFrom) > Math.abs(scaleTimeFrom - timeTo))\n\t\t\t\t\t{\n\t\t\t\t\t\tfromDate.setHours(scaleInfo.shownTimeTo, 0, 0,0);\n\t\t\t\t\t\tfromPos = this.getPosByDate(fromDate) - selectorWidth;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttoDate.setHours(scaleInfo.shownTimeFrom, 0, 0,0);\n\t\t\t\t\t\tfromPos = this.getPosByDate(toDate);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn Math.max(fromPos, 0);\n\t}\n\n\ttransit(params = {})\n\t{\n\t\tthis.DOM.wrap.style.display = 'block';\n\n\t\tlet duration;\n\t\tif (Type.isDate(params.leftDate) && Type.isDate(params.rightDate))\n\t\t{\n\t\t\tif (this.fullDayMode)\n\t\t\t{\n\t\t\t\tconst dayCount = Math.ceil((this.currentDateTo.getTime() - this.currentDateFrom.getTime()) / (1000 * 3600 * 24));\n\t\t\t\tparams.leftDate.setHours(0, 0, 0, 0);\n\t\t\t\tparams.rightDate = new Date(params.leftDate.getTime() + (dayCount - 1) * 24 * 3600 * 1000);\n\t\t\t\tparams.rightDate.setHours(23, 55, 0, 0);\n\t\t\t}\n\t\t\tduration = params.rightDate.getTime() - params.leftDate.getTime();\n\t\t\tconst fromPos = this.getPosByDate(params.leftDate);\n\t\t\tconst toPos = this.getPosByDate(params.rightDate);\n\t\t\tparams.toX = fromPos;\n\t\t\tthis.DOM.wrap.style.width = (toPos - fromPos) + 'px';\n\t\t}\n\n\t\tlet\n\t\t\tfromX = params.fromX ?? parseInt(this.DOM.wrap.style.left),\n\t\t\ttoX = Selector.roundPos(params.toX ?? fromX),\n\t\t\ttriggerChangeEvents = params.triggerChangeEvents !== false,\n\t\t\tfocus = !!params.focus;\n\n\t\tif (fromX !== toX)\n\t\t{\n\t\t\tif (this.animation)\n\t\t\t{\n\t\t\t\tthis.animation.stop();\n\t\t\t}\n\n\t\t\tthis.animation = new BX.easing({\n\t\t\t\tduration: 300,\n\t\t\t\tstart: {left: fromX},\n\t\t\t\tfinish: {left: toX},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: (state) => {this.DOM.wrap.style.left = state.left + 'px'},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.animation = null;\n\t\t\t\t\tlet\n\t\t\t\t\t\tfromPos = parseInt(this.DOM.wrap.style.left),\n\t\t\t\t\t\tcheckedPos = this.checkPosition(fromPos);\n\n\t\t\t\t\tif (checkedPos !== fromPos)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.DOM.wrap.style.left = checkedPos + 'px';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (triggerChangeEvents)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setValue(checkedPos, duration);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (focus)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.focus(true, 300);\n\t\t\t\t\t}\n\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.show(\n\t\t\t\t\t\t\tthis.currentDateFrom,\n\t\t\t\t\t\t\tthis.currentDateTo,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tanimation: false,\n\t\t\t\t\t\t\t\tfocus: focus,\n\t\t\t\t\t\t\t\talignCenter: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}, 200);\n\n\t\t\t\t\tthis.checkStatus(checkedPos);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.animation.animate();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (triggerChangeEvents)\n\t\t\t{\n\t\t\t\tthis.setValue(false, duration);\n\t\t\t}\n\n\t\t\tif (focus === true)\n\t\t\t{\n\t\t\t\tthis.focus(true, 300);\n\t\t\t}\n\n\t\t\tthis.checkStatus();\n\t\t}\n\t}\n\n\tshowTitle(from, to)\n\t{\n\t\tlet\n\t\t\tfromDate = new Date(from.getTime()),\n\t\t\ttoDate = new Date(to.getTime()),\n\t\t\tselectorTitle = this.getTitleNode(),\n\t\t\tselector = this.DOM.wrap;\n\n\t\tif (this.fullDayMode)\n\t\t{\n\t\t\ttoDate = new Date(toDate.getTime() - 5 * 60 * 1000);\n\t\t\tif (toDate.getDate() === fromDate.getDate())\n\t\t\t{\n\t\t\t\tselectorTitle.innerHTML = BX.date.format('d F, D', fromDate.getTime() / 1000);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tselectorTitle.innerHTML =\n\t\t\t\t\tBX.date.format('d F', fromDate.getTime() / 1000)\n\t\t\t\t\t+ ' - '\n\t\t\t\t\t+ BX.date.format('d F', toDate.getTime() / 1000);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselectorTitle.removeAttribute('style');\n\t\t\tselectorTitle.innerHTML = Util.formatTime(fromDate) + ' - ' + Util.formatTime(toDate);\n\t\t}\n\n\t\tif (this.selectMode && this.lastTouchedEntry)\n\t\t{\n\t\t\tlet\n\t\t\t\tentriesListWidth = this.compactMode ? 0 : this.entriesListWidth,\n\t\t\t\tselectorTitleLeft = parseInt(selector.style.left) - this.DOM.timelineWrap.scrollLeft + entriesListWidth + parseInt(selector.style.width) / 2,\n\t\t\t\tselectorTitleTop = parseInt(this.timelineDataCont.offsetTop) + parseInt(this.lastTouchedEntry.style.top) - 12;\n\n\t\t\tselectorTitle.style.top = selectorTitleTop + 'px';\n\t\t\tselectorTitle.style.left = selectorTitleLeft + 'px';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselector.appendChild(selectorTitle);\n\t\t}\n\n\t\tif (selectorTitle === this.selectorTitle)\n\t\t{\n\t\t\tif (selectorTitle.style.display === 'none' || this.selectorHideTimeout)\n\t\t\t{\n\t\t\t\tthis.selectorHideTimeout = clearTimeout(this.selectorHideTimeout);\n\t\t\t\t// Opacity animation\n\t\t\t\tthis.selectorTitle.style.display = '';\n\t\t\t\tthis.selectorTitle.style.opacity = 0;\n\t\t\t\tnew BX.easing({\n\t\t\t\t\tduration: 400,\n\t\t\t\t\tstart: {opacity: 0},\n\t\t\t\t\tfinish: {opacity: 100},\n\t\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quad),\n\t\t\t\t\tstep: (state)=>{this.selectorTitle.style.opacity = state.opacity / 100;},\n\t\t\t\t\tcomplete: ()=>{this.selectorTitle.removeAttribute('style');}\n\t\t\t\t}).animate();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselectorTitle.removeAttribute('style');\n\t\t}\n\t}\n\n\thideTitle(params = {})\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t\tparams = {};\n\n\t\tlet\n\t\t\ttimeoutName = params.selectorIndex === undefined ? 'selectorHideTimeout' : 'selectorHideTimeout_' + params.selectorIndex,\n\t\t\tselectorTitle = params.selectorTitle || this.getTitleNode();\n\n\t\tif (this[timeoutName])\n\t\t\tthis[timeoutName] = clearTimeout(this[timeoutName]);\n\n\t\tif (params.timeout !== false)\n\t\t{\n\t\t\tthis[timeoutName] = setTimeout(() => {\n\t\t\t\tparams.timeout = false;\n\t\t\t\tthis.hideTitle(params);\n\t\t\t}, 700);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// Opacity animation\n\t\t\tselectorTitle.style.display = '';\n\t\t\tselectorTitle.style.opacity = 1;\n\t\t\tnew BX.easing({\n\t\t\t\tduration: 400,\n\t\t\t\tstart: {opacity: 100},\n\t\t\t\tfinish: {opacity: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quad),\n\t\t\t\tstep: (state) => {selectorTitle.style.opacity = state.opacity / 100;},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tselectorTitle.removeAttribute('style');\n\t\t\t\t\tselectorTitle.style.display = 'none';\n\t\t\t\t}\n\t\t\t}).animate();\n\t\t}\n\t}\n\n\tstatic roundPos(x)\n\t{\n\t\treturn Math.round(parseFloat(x));\n\t}\n\n\tfocus(animation = true, timeout = 300, alignCenter)\n\t{\n\t\talignCenter = alignCenter === true;\n\n\t\tif (this.focusTimeout)\n\t\t{\n\t\t\tthis.focusTimeout = !!clearTimeout(this.focusTimeout);\n\t\t}\n\n\t\tif (this.useAnimation === false)\n\t\t{\n\t\t\tanimation = false;\n\t\t}\n\n\t\tif (timeout)\n\t\t{\n\t\t\tthis.focusTimeout = setTimeout(() => {this.focus(animation, false, alignCenter);}, timeout);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst\n\t\t\t\tscreenDelta = 10,\n\t\t\t\tselectorLeft = parseInt(this.DOM.wrap.style.left),\n\t\t\t\tselectorWidth = parseInt(this.DOM.wrap.style.width),\n\t\t\t\tviewWidth = parseInt(this.DOM.timelineWrap.offsetWidth),\n\t\t\t\tviewLeft = parseInt(this.DOM.timelineWrap.scrollLeft),\n\t\t\t\tviewRight = viewLeft + viewWidth;\n\n\t\t\tlet newScrollLeft = viewLeft;\n\n\t\t\tif (selectorLeft < viewLeft + screenDelta\n\t\t\t\t|| selectorLeft > viewRight - screenDelta\n\t\t\t\t|| alignCenter\n\t\t\t)\n\t\t\t{\n\t\t\t\t// Selector is smaller than view - we puting it in the middle of the view\n\t\t\t\tif (selectorWidth <= viewWidth)\n\t\t\t\t{\n\t\t\t\t\tnewScrollLeft = Math.max(Math.round(selectorLeft - ((viewWidth - selectorWidth) / 2 )), screenDelta);\n\n\t\t\t\t}\n\t\t\t\telse // Selector is wider, so we adjust by left side\n\t\t\t\t{\n\t\t\t\t\tnewScrollLeft = Math.max(Math.round(selectorLeft - screenDelta), screenDelta);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newScrollLeft !== viewLeft)\n\t\t\t{\n\t\t\t\tif (animation === false)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.timelineWrap.scrollLeft = newScrollLeft;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnew BX.easing({\n\t\t\t\t\t\tduration: 300,\n\t\t\t\t\t\tstart: {scrollLeft: this.DOM.timelineWrap.scrollLeft},\n\t\t\t\t\t\tfinish: {scrollLeft: newScrollLeft},\n\t\t\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quad),\n\t\t\t\t\t\tstep: (state)=>{this.DOM.timelineWrap.scrollLeft = state.scrollLeft;},\n\t\t\t\t\t\tcomplete: ()=>{}\n\t\t\t\t\t}).animate();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetDuration()\n\t{\n\t\tlet duration = Math.round((this.currentDateTo - this.currentDateFrom) / 1000) * 1000;\n\n\t\tif (this.fullDayMode)\n\t\t{\n\t\t\tduration += Util.getDayLength();\n\t\t}\n\n\t\treturn duration;\n\t}\n\n\tgetDateFrom()\n\t{\n\t\treturn this.currentDateFrom;\n\t}\n\n\tgetDateTo()\n\t{\n\t\treturn this.currentDateTo;\n\t}\n}","// @flow\nimport {Runtime, Type, Event, Loc, Dom, Tag, Text, Browser} from 'main.core';\nimport {Util} from 'calendar.util';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Selector} from './selector.js';\nimport {PopupWindowManager} from \"main.popup\";\n\nexport class Planner extends EventEmitter\n{\n\tDOM = {};\n\tconfig = {};\n\tentryStatusMap = {\n\t\th : 'user-status-h',\n\t\ty : 'user-status-y',\n\t\tq : 'user-status-q',\n\t\tn : 'user-status-n'\n\t};\n\tscaleTypes = ['15min','30min','1hour', '2hour', '1day'];\n\tsavedScaleType = null;\n\tSCALE_OFFSET_BEFORE = 0;  // in days\n\tSCALE_OFFSET_AFTER = 13;  // in days\n\tEXPAND_OFFSET = 3; // in days\n\tEXPAND_DELAY = 2000; // ms\n\tREBUILD_DELAY = 100;\n\tmaxTimelineSize = 300;\n\tMIN_ENTRY_ROWS = 3;\n\tMAX_ENTRY_ROWS = 300;\n\twidth = 700;\n\theight = 84;\n\tminWidth = 700;\n\tminHeight = 84;\n\tworkTime = [8, 18];\n\tscrollStep = 10;\n\tshown = false;\n\tbuilt = false;\n\tlocked = false;\n\tshownScaleTimeFrom = 24;\n\tshownScaleTimeTo = 0;\n\ttimelineCellWidthOrig = false;\n\tproposeTimeLimit = 14; // in days\n\texpandTimelineDelay = 600;\n\tlimitScaleSizeMode = false;\n\tuseAnimation = true;\n\tcheckTimeCache = {};\n\tentriesIndex = new Map();\n\tsolidStatus = false;\n\n\tconstructor(params = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.Planner');\n\t\tthis.config = params;\n\t\tthis.id = params.id;\n\t\tthis.dayOfWeekMonthFormat = params.dayOfWeekMonthFormat || 'd F, l';\n\t\tthis.userId = parseInt(params.userId || Loc.getMessage('USER_ID'));\n\t\tthis.DOM.wrap = params.wrap;\n\t\tthis.SCALE_TIME_FORMAT = BX.isAmPmMode() ? 'g a' : 'G';\n\n\t\tthis.expandTimelineDebounce = Runtime.debounce(this.expandTimeline, this.EXPAND_DELAY, this);\n\t\tthis.setConfig(params);\n\t}\n\n\tshow()\n\t{\n\t\tif (this.currentFromDate && this.currentToDate)\n\t\t{\n\t\t\tconst hourFrom = this.currentFromDate.getHours();\n\t\t\tconst hourTo = this.currentToDate.getHours() + Math.ceil(this.currentToDate.getMinutes() / 60);\n\t\t\tthis.extendScaleTimeLimits(hourFrom, hourTo);\n\t\t}\n\n\t\tif (this.currentFromDate && this.currentToDate)\n\t\t{\n\t\t\tthis.updateScaleLimitsFromEntry(this.currentFromDate, this.currentToDate);\n\t\t}\n\n\t\tlet animation = false;\n\n\t\tif (this.hideAnimation)\n\t\t{\n\t\t\tthis.hideAnimation.stop();\n\t\t\tthis.hideAnimation = null;\n\t\t}\n\n\t\tif (!this.isBuilt())\n\t\t{\n\t\t\tthis.build();\n\t\t\tthis.bindEventHandlers();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.resizePlannerWidth(this.width);\n\t\t}\n\n\t\tthis.buildTimeline();\n\t\tthis.DOM.wrap.style.display = '';\n\n\t\tif (this.adjustWidth)\n\t\t{\n\t\t\tthis.resizePlannerWidth(this.DOM.timelineInnerWrap.offsetWidth);\n\t\t}\n\n\t\tthis.selector.update({\n\t\t\tfrom: this.currentFromDate,\n\t\t\tto: this.currentToDate,\n\t\t\tanimation: false\n\t\t});\n\t\tif (this.currentFromDate && this.currentToDate\n\t\t\t&& this.currentFromDate.getTime() >= this.scaleDateFrom.getTime()\n\t\t\t&& this.currentToDate.getTime() <= this.scaleDateTo.getTime()\n\t\t)\n\t\t{\n\t\t\tthis.selector.focus(false, 0, true);\n\t\t}\n\n\t\tif (this.readonly)\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-readonly');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.DOM.mainWrap, 'calendar-planner-readonly');\n\t\t}\n\n\t\tif (this.compactMode)\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-compact');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.DOM.mainWrap, 'calendar-planner-compact');\n\t\t}\n\n\t\tthis.DOM.entriesOuterWrap.style.display = this.compactMode ? 'none' : '';\n\n\t\tif (animation)\n\t\t{\n\t\t\tif (this.showAnimation)\n\t\t\t{\n\t\t\t\tthis.showAnimation.stop();\n\t\t\t}\n\t\t\tthis.showAnimation = new BX.easing({\n\t\t\t\tduration: 300,\n\t\t\t\tstart: {height: 0},\n\t\t\t\tfinish: {height: this.height},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: (state) => {this.DOM.wrap.style.height = state.height + 'px';},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tif (parseInt(this.DOM.wrap.style.height) < this.height)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.DOM.wrap.style.height = this.height + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tthis.showAnimation = null;\n\t\t\t\t\tthis.selector.focus();\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.showAnimation.animate();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (parseInt(this.DOM.wrap.style.height) < this.height)\n\t\t\t{\n\t\t\t\tthis.DOM.wrap.style.height = this.height + 'px';\n\t\t\t}\n\t\t\tthis.adjustHeight();\n\t\t}\n\n\t\tthis.shown = true;\n\t}\n\n\tsetConfig(params)\n\t{\n\t\tthis.todayLocMessage = Loc.getMessage('EC_PLANNER_TODAY');\n\n\t\tthis.setScaleType(params.scaleType);\n\n\t\t// showTimelineDayTitle\n\t\tif (params.showTimelineDayTitle !== undefined)\n\t\t{\n\t\t\tthis.showTimelineDayTitle = !!params.showTimelineDayTitle;\n\t\t}\n\t\telse if(this.showTimelineDayTitle === undefined)\n\t\t{\n\t\t\tthis.showTimelineDayTitle = true;\n\t\t}\n\n\t\t// compactMode\n\t\tif (params.compactMode !== undefined)\n\t\t{\n\t\t\tthis.compactMode = !!params.compactMode;\n\t\t}\n\t\telse if (this.compactMode === undefined)\n\t\t{\n\t\t\tthis.compactMode = false;\n\t\t}\n\n\t\t// readonly\n\t\tif (params.readonly !== undefined)\n\t\t{\n\t\t\tthis.readonly = !!params.readonly;\n\t\t}\n\t\telse if (this.readonly === undefined)\n\t\t{\n\t\t\tthis.readonly = false;\n\t\t}\n\n\t\tif (this.compactMode)\n\t\t{\n\t\t\tlet compactHeight = 50;\n\t\t\tif (this.showTimelineDayTitle && !this.isOneDayScale())\n\t\t\t\tcompactHeight += 20;\n\t\t\tthis.height = this.minHeight = compactHeight;\n\t\t}\n\n\t\t// Select mode\n\t\tif (params.selectEntriesMode !== undefined)\n\t\t{\n\t\t\tthis.selectMode = !!params.selectEntriesMode;\n\t\t}\n\t\telse if (this.selectMode === undefined)\n\t\t{\n\t\t\tthis.selectMode = false;\n\t\t}\n\n\t\tif (Type.isInteger(params.SCALE_OFFSET_BEFORE))\n\t\t{\n\t\t\tthis.SCALE_OFFSET_BEFORE = parseInt(params.SCALE_OFFSET_BEFORE);\n\t\t}\n\t\tif (Type.isInteger(params.SCALE_OFFSET_AFTER))\n\t\t{\n\t\t\tthis.SCALE_OFFSET_AFTER = parseInt(params.SCALE_OFFSET_AFTER);\n\t\t}\n\t\tif (Type.isInteger(params.maxTimelineSize))\n\t\t{\n\t\t\tthis.maxTimelineSize = parseInt(params.maxTimelineSize);\n\t\t}\n\t\tif (Type.isInteger(params.minEntryRows))\n\t\t{\n\t\t\tthis.MIN_ENTRY_ROWS = parseInt(params.minEntryRows);\n\t\t}\n\t\tif (Type.isInteger(params.maxEntryRows))\n\t\t{\n\t\t\tthis.MAX_ENTRY_ROWS = parseInt(params.maxEntryRows);\n\t\t}\n\n\t\tif (Type.isInteger(params.width))\n\t\t{\n\t\t\tthis.width = parseInt(params.width);\n\t\t}\n\t\tif (Type.isInteger(params.height))\n\t\t{\n\t\t\tthis.height = parseInt(params.height);\n\t\t}\n\t\tif (Type.isInteger(params.minWidth))\n\t\t{\n\t\t\tthis.minWidth = parseInt(params.minWidth);\n\t\t}\n\t\tif (Type.isInteger(params.minHeight))\n\t\t{\n\t\t\tthis.minHeight = parseInt(params.minHeight);\n\t\t}\n\t\tthis.width = Math.max(this.minWidth, this.width);\n\t\tthis.height = Math.max(this.minHeight, this.height);\n\n\t\tif (Type.isArray(params.workTime))\n\t\t{\n\t\t\tthis.workTime = params.workTime;\n\t\t}\n\t\tthis.extendScaleTime(this.workTime[0], this.workTime[1]);\n\n\t\tthis.weekHolidays = params.weekHolidays || this.weekHolidays || [];\n\t\tthis.yearHolidays = params.yearHolidays || this.yearHolidays || [];\n\t\tthis.accuracy = params.accuracy || this.accuracy || 300; // 5 min\n\t\tthis.clickSelectorScaleAccuracy = params.clickSelectorScaleAccuracy || this.accuracy; // 5 min\n\t\tthis.selectorAccuracy = parseInt(params.selectorAccuracy) || this.selectorAccuracy || 300; // 5 min\n\t\tthis.entriesListWidth = parseInt(params.entriesListWidth) || this.entriesListWidth || 200;\n\t\tthis.timelineCellWidth = params.timelineCellWidth || this.timelineCellWidth || 40;\n\t\tthis.solidStatus = params.solidStatus === true;\n\n\t\tthis.showEntiesHeader = params.showEntiesHeader === undefined ? true : !!params.showEntiesHeader;\n\t\tthis.showEntryName = params.showEntryName === undefined ? true : !!params.showEntryName;\n\n\t\tif (this.isOneDayScale() && this.timelineCellWidth < 100)\n\t\t{\n\t\t\tthis.timelineCellWidthOrig = this.timelineCellWidth;\n\t\t\tthis.timelineCellWidth = 100;\n\t\t}\n\t\telse if(this.timelineCellWidthOrig && !this.isOneDayScale())\n\t\t{\n\t\t\tthis.timelineCellWidth = this.timelineCellWidthOrig;\n\t\t\tthis.timelineCellWidthOrig = false;\n\t\t}\n\n\t\tif (this.allowAdjustCellWidth === undefined || params.allowAdjustCellWidth !== undefined)\n\t\t{\n\t\t\tthis.allowAdjustCellWidth = this.readonly\n\t\t\t\t&& this.compactMode\n\t\t\t\t&& params.allowAdjustCellWidth !== false;\n\t\t}\n\n\t\tif (params.locked !== undefined)\n\t\t{\n\t\t\tthis.locked = params.locked;\n\t\t}\n\n\t\tthis.adjustCellWidth();\n\n\t\t// Scale params\n\t\tthis.setScaleLimits(params.scaleDateFrom, params.scaleDateTo);\n\t}\n\n\tupdateScaleLimitsFromEntry(from, to)\n\t{\n\t\tif (from.getTime() > this.scaleDateTo.getTime() || to.getTime() < this.scaleDateFrom.getTime())\n\t\t{\n\t\t\tthis.setScaleLimits(new Date(from.getTime()), new Date(to.getTime() + Util.getDayLength() * this.SCALE_OFFSET_AFTER));\n\t\t}\n\t}\n\n\tsetScaleLimits(scaleDateFrom, scaleDateTo)\n\t{\n\t\tif (scaleDateFrom !== undefined)\n\t\t{\n\t\t\tthis.scaleDateFrom = Type.isDate(scaleDateFrom) ? scaleDateFrom : Util.parseDate(scaleDateFrom);\n\t\t}\n\n\t\tif (!Type.isDate(this.scaleDateFrom))\n\t\t{\n\t\t\tif (this.compactMode && this.readonly)\n\t\t\t{\n\t\t\t\tthis.scaleDateFrom = new Date();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.scaleDateFrom = new Date(new Date().getTime() - Util.getDayLength() * this.SCALE_OFFSET_BEFORE);\n\t\t\t}\n\t\t}\n\t\tthis.scaleDateFrom.setHours(this.isOneDayScale() ? 0 : this.shownScaleTimeFrom, 0, 0, 0);\n\n\t\tif (scaleDateTo !== undefined)\n\t\t{\n\t\t\tthis.scaleDateTo = BX.type.isString(scaleDateTo) ? Util.parseDate(scaleDateTo) : scaleDateTo;\n\t\t}\n\n\t\tif (!Type.isDate(this.scaleDateTo))\n\t\t{\n\t\t\tif (this.compactMode && this.readonly)\n\t\t\t{\n\t\t\t\tthis.scaleDateTo = new Date();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.scaleDateTo = new Date(new Date().getTime() + Util.getDayLength() * this.SCALE_OFFSET_AFTER);\n\t\t\t}\n\t\t}\n\t\tthis.scaleDateTo.setHours(this.isOneDayScale() ? 0 : this.shownScaleTimeTo, 0, 0, 0);\n\t}\n\n\textendScaleTimeLimits(fromTime, toTime)\n\t{\n\t\tif (fromTime !== false && !isNaN(parseInt(fromTime)))\n\t\t{\n\t\t\tthis.shownScaleTimeFrom = Math.min(parseInt(fromTime), this.shownScaleTimeFrom, 23);\n\t\t\tthis.shownScaleTimeFrom = Math.max(this.shownScaleTimeFrom, 0);\n\n\t\t\tif (this.scaleDateFrom)\n\t\t\t{\n\t\t\t\tthis.scaleDateFrom.setHours(this.shownScaleTimeFrom, 0, 0 ,0);\n\t\t\t}\n\t\t}\n\n\t\tif (toTime !== false && !isNaN(parseInt(toTime)))\n\t\t{\n\t\t\tthis.shownScaleTimeTo = Math.max(parseInt(toTime), this.shownScaleTimeTo, 1);\n\t\t\tthis.shownScaleTimeTo = Math.min(this.shownScaleTimeTo, 24);\n\n\t\t\tif (this.scaleDateTo)\n\t\t\t{\n\t\t\t\tthis.scaleDateTo.setHours(this.shownScaleTimeTo, 0, 0, 0);\n\t\t\t}\n\t\t}\n\n\t\tif (this.shownScaleTimeFrom % 2 !== 0)\n\t\t{\n\t\t\tthis.shownScaleTimeFrom--;\n\t\t}\n\n\t\tif (this.shownScaleTimeTo % 2 !== 0)\n\t\t{\n\t\t\tthis.shownScaleTimeTo++;\n\t\t}\n\t}\n\n\tSetLoadedDataLimits(from, to)\n\t{\n\t\tif (from)\n\t\t{\n\t\t\tthis.loadedDataFrom = from.getTime ? from : Util.parseDate(from);\n\t\t}\n\t\tif (to)\n\t\t{\n\t\t\tthis.loadedDataTo = to.getTime ? to : Util.parseDate(to);\n\t\t}\n\t}\n\n\textendScaleTime(fromTime, toTime)\n\t{\n\t\tconst savedTimeFrom = this.shownScaleTimeFrom;\n\t\tconst savedTimeTo = this.shownScaleTimeTo;\n\n\t\tthis.extendScaleTimeLimits(fromTime, toTime);\n\n\t\tif (fromTime === false && toTime !== false)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.extendTimelineToRight(savedTimeTo, this.shownScaleTimeTo);\n\t\t\t}, 200);\n\t\t}\n\t\tif (fromTime !== false && toTime === false)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.extendTimelineToLeft(this.shownScaleTimeFrom, savedTimeFrom);\n\t\t\t}, 200);\n\t\t}\n\t\tif (fromTime !== false && toTime !== false)\n\t\t{\n\t\t\tthis.rebuildDebounce();\n\t\t}\n\t}\n\n\tadjustCellWidth()\n\t{\n\t\tif (this.allowAdjustCellWidth)\n\t\t{\n\t\t\tthis.timelineCellWidth = Math.round(this.width / ((this.shownScaleTimeTo - this.shownScaleTimeFrom) * 3600 / this.scaleSize));\n\t\t}\n\t}\n\n\tbuild()\n\t{\n\t\tif (!Type.isDomNode(this.DOM.wrap))\n\t\t{\n\t\t\tthrow new TypeError(\"Wrap is not DOM node\");\n\t\t}\n\n\t\tthis.DOM.wrap.style.width = this.width + 'px';\n\n\t\t// Left part - list of users and other resources\n\t\tlet entriesListWidth = this.compactMode ? 0 : this.entriesListWidth;\n\n\t\t// Timeline with accessibility information\n\t\tthis.DOM.mainWrap = this.DOM.wrap.appendChild(BX.create('DIV', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'calendar-planner-main-container calendar-planner-main-container-resource'\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\tminHeight: this.minHeight + 'px',\n\t\t\t\theight: this.height + 'px',\n\t\t\t\twidth: this.width + 'px'\n\t\t\t}\n\t\t}));\n\n\t\tif (!this.showEntryName)\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-entry-icons-only');\n\t\t}\n\n\t\tif (this.readonly)\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-readonly');\n\t\t}\n\n\t\tthis.DOM.entriesOuterWrap = this.DOM.mainWrap.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-user-container\" style=\"width: ${entriesListWidth}px; height: ${this.height}px;\"></div>\n\t\t`);\n\n\t\tUtil.preventSelection(this.DOM.entriesOuterWrap);\n\t\tif (this.compactMode)\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-compact');\n\t\t\tthis.DOM.entriesOuterWrap.style.display = 'none';\n\t\t}\n\n\t\tif (this.isOneDayScale())\n\t\t{\n\t\t\tDom.addClass(this.DOM.entriesOuterWrap, 'calendar-planner-no-daytitle');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.DOM.entriesOuterWrap, 'calendar-planner-no-daytitle');\n\t\t}\n\n\t\tif (this.showEntiesHeader !== false)\n\t\t{\n\t\t\tthis.DOM.entrieListHeader = this.DOM.entriesOuterWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-header\"></div>\n\t\t\t`)\n\t\t\t.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-general-info\"></div>\n\t\t\t`)\n\t\t\t.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-users-header\"></div>\n\t\t\t`);\n\n\t\t\tthis.entriesListTitleCounter = this.DOM.entrieListHeader.appendChild(Tag.render`\n\t\t\t\t<span class=\"calendar-planner-users-item\">\n\t\t\t\t\t${Loc.getMessage('EC_PL_ATTENDEES_TITLE') + ' '}\n\t\t\t\t</span>\n\t\t\t`)\n\t\t\t.appendChild(Tag.render`<span></span>`);\n\t\t}\n\n\t\tthis.DOM.entrieListWrap = this.DOM.entriesOuterWrap.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-user-container-inner\"></div>\n\t\t`);\n\n\t\t// Fixed cont with specific width and height\n\t\tthis.DOM.timelineFixedWrap = this.DOM.mainWrap.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-timeline-wrapper\" style=\"height: ${this.height}px\"></div>\n\t\t`);\n\n\t\tif (this.isLocked())\n\t\t{\n\t\t\tthis.lock();\n\t\t}\n\n\t\t// overflow-y: hidden;\n\t\tthis.DOM.timelineVerticalConstraint = this.DOM.timelineFixedWrap.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-timeline-constraint\"></div>\n\t\t`);\n\n\t\t// Movable cont - used to move scale and data containers easy and at the same time\n\t\tthis.DOM.timelineInnerWrap = this.DOM.timelineVerticalConstraint.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-timeline-inner-wrapper\" data-bx-planner-meta=\"timeline\"></div>\n\t\t`);\n\n\t\t// Scale container\n\t\tthis.DOM.timelineScaleWrap = this.DOM.timelineInnerWrap.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-time\"></div>\n\t\t`);\n\t\tUtil.preventSelection(this.DOM.timelineScaleWrap);\n\n\t\t// Accessibility container\n\t\tthis.DOM.timelineDataWrap = this.DOM.timelineInnerWrap.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-timeline-container\" style=\"height: ${this.height}px\"></div>\n\t\t`);\n\t\t// Container with accessibility entries elements\n\t\tthis.DOM.accessibilityWrap = this.DOM.timelineDataWrap.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-acc-wrap\"></div>\n\t\t`);\n\n\t\tif (!this.readonly)\n\t\t{\n\t\t\tthis.DOM.timelineVerticalConstraint.addEventListener('scroll', this.updateTodayButtonVisibility.bind(this));\n\t\t}\n\n\t\t// Selector\n\t\tthis.selector = new Selector({\n\t\t\tselectMode: this.selectMode,\n\t\t\ttimelineFixedWrap: this.DOM.timelineFixedWrap,\n\t\t\ttimelineWrap: this.DOM.timelineVerticalConstraint,\n\t\t\tgetPosByDate: this.getPosByDate.bind(this),\n\t\t\tgetDateByPos: this.getDateByPos.bind(this),\n\t\t\tgetEvents: this.getAllEvents.bind(this),\n\t\t\tgetPosDateMap: () => {\n\t\t\t\treturn this.posDateMap;\n\t\t\t},\n\t\t\tuseAnimation: this.useAnimation,\n\t\t\tsolidStatus: this.solidStatus,\n\t\t\tgetScaleInfo: () => {return {\n\t\t\t\tscale: this.scaleType,\n\t\t\t\tshownTimeFrom: this.shownScaleTimeFrom,\n\t\t\t\tshownTimeTo: this.shownScaleTimeTo,\n\t\t\t\tscaleDateFrom: this.scaleDateFrom,\n\t\t\t\tscaleDateTo: this.scaleDateTo,\n\t\t\t}},\n\t\t\tgetTimelineWidth: () => {\n\t\t\t\treturn parseInt(this.DOM.timelineInnerWrap.style.width)\n\t\t\t}\n\t\t});\n\t\tthis.DOM.timelineDataWrap.appendChild(this.selector.getWrap());\n\t\tthis.DOM.mainWrap.appendChild(this.selector.getTitleNode());\n\t\tthis.selector.subscribe('onChange', this.handleSelectorChanges.bind(this));\n\t\tthis.selector.subscribe('doCheckStatus', this.doCheckSelectorStatus.bind(this));\n\n\t\tif (this.selectMode)\n\t\t{\n\t\t\tthis.selectedEntriesWrap = this.DOM.mainWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-timeline-select-entries-wrap\"></div>\n\t\t\t`);\n\n\t\t\tthis.hoverRow = this.DOM.mainWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-timeline-hover-row\" style=\"top: 0; width: ${parseInt(this.DOM.mainWrap.offsetWidth)}px\"></div>\n\t\t\t`);\n\n\n\t\t\tEvent.bind(document, 'mousemove', this.mouseMoveHandler.bind(this));\n\t\t}\n\n\t\tif (!this.compactMode)\n\t\t{\n\t\t\tthis.DOM.settingsButton = this.DOM.mainWrap.appendChild(Tag.render`<div class=\"calendar-planner-settings-icon-container\" title=\"${Loc.getMessage('EC_PL_SETTINGS_SCALE')}\"><span class=\"calendar-planner-settings-title\">${Loc.getMessage('EC_PL_SETTINGS_SCALE')}</span><span class=\"calendar-planner-settings-icon\"></span></div>`);\n\t\t\tEvent.bind(this.DOM.settingsButton, 'click', () => this.showSettingsPopup());\n\t\t}\n\n\t\tthis.built = true;\n\t}\n\n\tbuildTimeline(clearCache)\n\t{\n\t\tif (\n\t\t\tthis.isBuilt()\n\t\t\t&& (this.lastTimelineKey !== this.getTimelineShownKey()\n\t\t\t|| clearCache === true)\n\t\t)\n\t\t{\n\t\t\tDom.clean(this.DOM.timelineScaleWrap);\n\n\t\t\tthis.scaleData = this.getScaleData();\n\n\t\t\tlet\n\t\t\t\touterDayCont,\n\t\t\t\tdayTitle,\n\t\t\t\tcont = this.DOM.timelineScaleWrap;\n\n\t\t\tthis.futureDayTitles = [];\n\t\t\tthis.todayButtonPivotDay = undefined;\n\t\t\tfor (let i = 0; i < this.scaleData.length; i++)\n\t\t\t{\n\t\t\t\tif (this.showTimelineDayTitle && !this.isOneDayScale())\n\t\t\t\t{\n\t\t\t\t\tif (this.scaleDayTitles[this.scaleData[i].daystamp])\n\t\t\t\t\t{\n\t\t\t\t\t\tcont = this.scaleDayTitles[this.scaleData[i].daystamp];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst date = new Date(this.scaleData[i].timestamp);\n\t\t\t\t\t\tdate.setHours(0, 0, 0, 0);\n\t\t\t\t\t\tconst today = new Date();\n\t\t\t\t\t\ttoday.setHours(0, 0, 0, 0);\n\n\t\t\t\t\t\touterDayCont = this.DOM.timelineScaleWrap.appendChild(Tag.render`\n\t\t\t\t\t\t\t<div class=\"calendar-planner-time-day-outer\"></div>\n\t\t\t\t\t\t`);\n\n\t\t\t\t\t\tlet dayTitleClass = 'calendar-planner-time-day-title';\n\t\t\t\t\t\tif (date.getTime() < today.getTime())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdayTitleClass += ' calendar-planner-time-day-past';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//F d, l\n\t\t\t\t\t\tdayTitle = outerDayCont.appendChild(Tag.render`\n\t\t\t\t\t\t\t<div class=\"${dayTitleClass}\">\n\t\t\t\t\t\t\t\t<span>${BX.date.format(this.dayOfWeekMonthFormat, this.scaleData[i].timestamp / 1000)}</span>\n\t\t\t\t\t\t\t\t<div class=\"calendar-planner-time-day-border\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`);\n\n\t\t\t\t\t\tif (date.getTime() > today.getTime())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.futureDayTitles.push(dayTitle.querySelector('span'));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (date.getTime() === today.getTime())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.todayTitleButton = dayTitle.firstElementChild.appendChild(Tag.render`\n\t\t\t\t\t\t\t\t<div class=\"calendar-planner-today-button\"></div>\n\t\t\t\t\t\t\t`);\n\t\t\t\t\t\t\tthis.todayTitleButton.innerHTML = this.todayLocMessage;\n\t\t\t\t\t\t\tthis.todayTitleButton.addEventListener('click', this.todayButtonClickHandler.bind(this));\n\t\t\t\t\t\t\tthis.todayButtonPivotDay = outerDayCont;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcont = outerDayCont.appendChild(Tag.render`\n\t\t\t\t\t\t\t<div class=\"calendar-planner-time-day\"></div>\n\t\t\t\t\t\t`);\n\n\t\t\t\t\t\tthis.scaleDayTitles[this.scaleData[i].daystamp] = cont;\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet className = 'calendar-planner-time-hour-item' + (this.scaleData[i].dayStart ? ' calendar-planner-day-start' : '');\n\n\t\t\t\tif (\n\t\t\t\t\t(this.scaleType === '15min' || this.scaleType === '30min')\n\t\t\t\t\t&& this.scaleData[i].title !== ''\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tclassName += ' calendar-planner-time-hour-bold';\n\t\t\t\t}\n\n\t\t\t\tthis.scaleData[i].cell = cont.appendChild(BX.create('DIV', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: className\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\twidth: this.timelineCellWidth + 'px',\n\t\t\t\t\t\tminWidth: this.timelineCellWidth + 'px'\n\t\t\t\t\t},\n\t\t\t\t\thtml: this.scaleData[i].title ? '<i>' + this.scaleData[i].title + '</i>' : ''\n\t\t\t\t}));\n\n\t\t\t\tif (!this.isOneDayScale() && this.scaleData[i + 1] && this.scaleData[i + 1].dayStart)\n\t\t\t\t{\n\t\t\t\t\tcont.appendChild(Tag.render`\n\t\t\t\t\t\t<div class=\"calendar-planner-timeline-border\"></div>\n\t\t\t\t\t`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet mapDatePosRes = this.mapDatePos();\n\t\t\tthis.posDateMap = mapDatePosRes.posDateMap;\n\n\t\t\tconst timelineOffset = this.DOM.timelineScaleWrap.offsetWidth;\n\t\t\tthis.DOM.timelineInnerWrap.style.width = timelineOffset + 'px';\n\t\t\tthis.DOM.entrieListWrap.style.top = (parseInt(this.DOM.timelineDataWrap.offsetTop) + 10) + 'px';\n\n\t\t\tthis.lastTimelineKey = this.getTimelineShownKey();\n\t\t\tthis.checkRebuildTimeout(timelineOffset);\n\t\t\tthis.buildTodayButtonWrap();\n\t\t}\n\t}\n\n\tbuildTodayButtonWrap()\n\t{\n\t\tif (this.readonly)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.todayButton)\n\t\t{\n\t\t\tthis.todayButton.remove();\n\t\t}\n\t\tif (this.todayRightButton)\n\t\t{\n\t\t\tthis.todayRightButton.remove();\n\t\t}\n\t\tif (this.DOM.todayButtonContainer)\n\t\t{\n\t\t\tthis.DOM.todayButtonContainer.remove();\n\t\t}\n\t\tif (this.isOneDayScale())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst todayButton = this.DOM.entriesOuterWrap.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-today-button\">${this.todayLocMessage}</div>\n\t\t`);\n\t\tthis.todayButtonWidth = todayButton.offsetWidth;\n\t\ttodayButton.innerHTML = this.todayLocMessage + ' &rarr;';\n\t\tthis.todayButtonRightWidth = todayButton.offsetWidth;\n\t\ttodayButton.innerHTML = this.todayLocMessage + ' &larr;';\n\t\tthis.todayButtonLeftWidth = todayButton.offsetWidth;\n\t\tconst top = BX.pos(todayButton).top - BX.pos(this.DOM.timelineScaleWrap).top;\n\t\ttodayButton.remove();\n\n\t\tlet left = 0;\n\t\tif (this.todayButtonPivotDay)\n\t\t{\n\t\t\tleft = this.todayButtonPivotDay.offsetLeft + this.todayButtonPivotDay.offsetWidth - 10 - this.todayButtonWidth + 1;\n\t\t}\n\t\tconst width = this.DOM.timelineScaleWrap.offsetWidth - left;\n\t\tthis.DOM.todayButtonContainer = this.DOM.timelineScaleWrap.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-today-button-container\" style=\"width: ${width}px; left: ${left}px; top: ${top}px;\"></div>\n\t\t`);\n\t\tthis.todayButton = this.DOM.todayButtonContainer.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-today-button\" style=\"width: ${this.todayButtonWidth}px; direction: rtl;\">${this.todayLocMessage}</div>\n\t\t`);\n\t\tthis.todayRightButton = this.DOM.timelineVerticalConstraint.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-today-button\" style=\"right: 0; top: 5px; position: absolute;\">${this.todayLocMessage}</div>\n\t\t`);\n\n\t\tthis.todayButton.addEventListener('click', this.todayButtonClickHandler.bind(this));\n\t\tthis.todayRightButton.addEventListener('click', this.todayButtonClickHandler.bind(this));\n\t\tthis.updateTodayButtonVisibility(false);\n\n\t\tif (this.isLocked() && this.DOM.todayButtonContainer)\n\t\t{\n\t\t\tDom.addClass(this.DOM.todayButtonContainer, '--lock');\n\t\t}\n\t}\n\n\tgetTimelineShownKey()\n\t{\n\t\treturn 'tm_' + this.scaleDateFrom.getTime() + '_' + this.scaleDateTo.getTime();\n\t}\n\n\tcheckRebuildTimeout(timelineOffset, timeout = 300)\n\t{\n\t\tif (!this._checkRebuildTimeoutCount)\n\t\t{\n\t\t\tthis._checkRebuildTimeoutCount = 0;\n\t\t}\n\n\t\tif (this.rebuildTimeout)\n\t\t{\n\t\t\tthis.rebuildTimeout = !!clearTimeout(this.rebuildTimeout);\n\t\t}\n\n\t\tif (\n\t\t\tthis._checkRebuildTimeoutCount <= 10\n\t\t\t&& Type.isElementNode(this.DOM.timelineScaleWrap)\n\t\t\t&& Dom.isShown(this.DOM.timelineScaleWrap)\n\t\t)\n\t\t{\n\t\t\tthis._checkRebuildTimeoutCount++;\n\t\t\tthis.rebuildTimeout = setTimeout(() => {\n\t\t\t\tif (timelineOffset !== this.DOM.timelineScaleWrap.offsetWidth)\n\t\t\t\t{\n\t\t\t\t\tif (this.rebuildTimeout)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.rebuildTimeout = !!clearTimeout(this.rebuildTimeout);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.rebuild();\n\t\t\t\t\tif (this.selector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selector.focus(true, 300);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.checkRebuildTimeout(timelineOffset, timeout);\n\t\t\t\t}\n\t\t\t}, timeout);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdelete this._checkRebuildTimeoutCount;\n\t\t}\n\t}\n\n\trebuildDebounce(timeout = this.REBUILD_DELAY)\n\t{\n\t\tRuntime.debounce(this.rebuild, timeout, this)();\n\t}\n\n\textendTimelineToLeft(extendedTimeFrom, extendedTimeTo)\n\t{\n\t\tthis.extendTimeline(extendedTimeFrom, extendedTimeTo);\n\t}\n\n\textendTimelineToRight(extendedTimeFrom, extendedTimeTo)\n\t{\n\t\tthis.extendTimeline(extendedTimeFrom, extendedTimeTo, true)\n\t}\n\n\textendTimeline(extendedTimeFrom, extendedTimeTo, isToRight = false)\n\t{\n\t\tif (!this.DOM.timelineScaleWrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst isToLeft = !isToRight;\n\t\tconst dayNodeList = this.DOM.timelineScaleWrap.querySelectorAll('.calendar-planner-time-day');\n\t\tconst dayCount = dayNodeList.length;\n\t\tconst nodeCountInDay = this.scaleData.length / dayCount;\n\t\tconst extendCount = extendedTimeTo - extendedTimeFrom;\n\n\t\tlet cellsInsertedOnLeftCount = 0;\n\t\tconst insertedNodes = [];\n\t\tlet pivotScaleDatumOfDayIndex = isToRight ? nodeCountInDay - 1 : 0;\n\n\t\tfor (const dayNode of dayNodeList)\n\t\t{\n\t\t\tconst pivotNodeOfDay = isToLeft\n\t\t\t\t? dayNode.children[0]\n\t\t\t\t: dayNode.querySelector('.calendar-planner-timeline-border');\n\t\t\tif (isToLeft)\n\t\t\t{\n\t\t\t\tthis.scaleData[pivotScaleDatumOfDayIndex].dayStart = false;\n\t\t\t}\n\n\t\t\tconst daystamp = this.scaleData[pivotScaleDatumOfDayIndex].daystamp;\n\t\t\tlet toTimestamp, fromTimestamp;\n\t\t\tif (isToLeft)\n\t\t\t{\n\t\t\t\ttoTimestamp = this.scaleData[pivotScaleDatumOfDayIndex].timestamp / 1000;\n\t\t\t\tfromTimestamp = toTimestamp - 3600 * extendCount;\n\t\t\t\tif (new Date(fromTimestamp * 1000).getHours() !== extendedTimeFrom)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfromTimestamp = this.scaleData[pivotScaleDatumOfDayIndex].timestamp / 1000 + this.scaleSize;\n\t\t\t\ttoTimestamp = fromTimestamp + 3600 * extendCount;\n\t\t\t\tif (new Date(fromTimestamp * 1000).getHours() !== extendedTimeFrom)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (let insertedTimestamp = fromTimestamp, i = 0; insertedTimestamp < toTimestamp; insertedTimestamp += this.scaleSize, i++)\n\t\t\t{\n\t\t\t\tconst title = BX.date.format('i', insertedTimestamp) === '00'\n\t\t\t\t\t? BX.date.format(this.SCALE_TIME_FORMAT, insertedTimestamp)\n\t\t\t\t\t: '';\n\t\t\t\tif (insertedTimestamp < this.currentFromDate.getTime() / 1000 - (isToLeft ? 3600 * 12 : 0))\n\t\t\t\t{\n\t\t\t\t\tcellsInsertedOnLeftCount++;\n\t\t\t\t}\n\t\t\t\tlet animationClass = 'expand-width-no-animation';\n\t\t\t\tif (\n\t\t\t\t\t(\n\t\t\t\t\t\tisToLeft\n\t\t\t\t\t\t&& insertedTimestamp > this.currentFromDate.getTime() / 1000 - 3600 * 12\n\t\t\t\t\t\t&& insertedTimestamp < this.currentFromDate.getTime() / 1000 + 3600 * 12\n\t\t\t\t\t)\n\t\t\t\t\t||\n\t\t\t\t\t(\n\t\t\t\t\t\tisToRight\n\t\t\t\t\t\t&& insertedTimestamp > this.currentFromDate.getTime() / 1000\n\t\t\t\t\t\t&& insertedTimestamp < this.currentFromDate.getTime() / 1000 + 3600 * 24\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tanimationClass = 'expand-width-0-40';\n\t\t\t\t}\n\n\t\t\t\tconst insertedCell = BX.create('DIV', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'calendar-planner-time-hour-item' + ' ' + animationClass,\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\twidth: this.timelineCellWidth + 'px',\n\t\t\t\t\t\tminWidth: this.timelineCellWidth + 'px'\n\t\t\t\t\t},\n\t\t\t\t\thtml: '<i>' + title + '</i>'\n\t\t\t\t});\n\t\t\t\tinsertedNodes.push(insertedCell);\n\t\t\t\tdayNode.insertBefore(insertedCell, pivotNodeOfDay);\n\n\t\t\t\tconst insertedScaleDatum = {\n\t\t\t\t\tdaystamp: daystamp,\n\t\t\t\t\ttimestamp: insertedTimestamp * 1000,\n\t\t\t\t\tvalue: insertedTimestamp * 1000,\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tdayStart: isToLeft && i === 0,\n\t\t\t\t\tcell: insertedCell\n\t\t\t\t};\n\t\t\t\tthis.scaleData.splice(i + pivotScaleDatumOfDayIndex + (isToRight ? 1 : 0), 0, insertedScaleDatum);\n\t\t\t}\n\t\t\tif (isToLeft)\n\t\t\t{\n\t\t\t\tpivotNodeOfDay.classList.remove('calendar-planner-day-start');\n\t\t\t\tdayNode.children[0].classList.add('calendar-planner-day-start');\n\t\t\t}\n\t\t\tpivotScaleDatumOfDayIndex += nodeCountInDay + extendCount * 3600 / this.scaleSize;\n\t\t}\n\n\t\t// set scroll for timeline to compensate width of static inserted cells\n\t\tconst scroll = this.DOM.timelineVerticalConstraint.scrollLeft;\n\t\tthis.DOM.timelineVerticalConstraint.scrollLeft = scroll + cellsInsertedOnLeftCount * this.timelineCellWidth;\n\n\t\t// get accessibility events for animation\n\t\tconst midnight = new Date(this.currentFromDate.getTime());\n\t\tmidnight.setHours(0,0,0,0);\n\t\tif (isToRight)\n\t\t{\n\t\t\tmidnight.setDate(midnight.getDate() + 1);\n\t\t}\n\t\tconst visibleEvents = this.getVisibleEvents();\n\t\tconst animatedEvents = this.getEventsAfter(visibleEvents, midnight);\n\t\tthis.update(this.entries, this.accessibility);\n\n\t\t// update selector and visible events position during the css animation\n\t\tnew BX.easing({\n\t\t\tduration: 200,\n\t\t\tstart: {},\n\t\t\tfinish: {},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.linear),\n\t\t\tstep: () => {\n\t\t\t\tthis.buildTodayButtonWrap();\n\t\t\t\tthis.selector.update();\n\t\t\t\tfor (const event of animatedEvents)\n\t\t\t\t{\n\t\t\t\t\tevent.node.style.left = this.getPosByDate(new Date(event.fromTimestamp)) + 'px';\n\t\t\t\t}\n\t\t\t},\n\t\t\tcomplete: () => {\n\t\t\t\tfor (const node of insertedNodes)\n\t\t\t\t{\n\t\t\t\t\tnode.classList.remove('expand-width-no-animation');\n\t\t\t\t\tnode.classList.remove('expand-width-0-40');\n\t\t\t\t}\n\t\t\t\tthis.updateTimelineAfterExtend();\n\t\t\t}\n\t\t}).animate();\n\t}\n\n\tupdateTimelineAfterExtend()\n\t{\n\t\tlet mapDatePosRes = this.mapDatePos();\n\t\tthis.posDateMap = mapDatePosRes.posDateMap;\n\t\tconst timelineOffset = this.DOM.timelineScaleWrap.offsetWidth;\n\t\tthis.DOM.timelineInnerWrap.style.width = timelineOffset + 'px';\n\t\tthis.DOM.entrieListWrap.style.top = (parseInt(this.DOM.timelineDataWrap.offsetTop) + 10) + 'px';\n\t\tthis.lastTimelineKey = this.getTimelineShownKey();\n\t\tthis.update(this.entries, this.accessibility);\n\t\tthis.adjustHeight();\n\t\tthis.resizePlannerWidth(this.width);\n\t\tthis.selector.update();\n\t\tthis.clearCacheTime();\n\t\tthis.buildTodayButtonWrap();\n\t}\n\n\trebuild(params = {})\n\t{\n\t\tif (this.isBuilt())\n\t\t{\n\t\t\tthis.buildTimeline(true);\n\t\t\tthis.update(this.entries, this.accessibility);\n\t\t\tthis.adjustHeight();\n\t\t\tthis.resizePlannerWidth(this.width);\n\n\t\t\tif (params.updateSelector !== false)\n\t\t\t{\n\t\t\t\tthis.selector.update(params.selectorParams);\n\t\t\t\tthis.selector.focus(false, 0, true);\n\t\t\t}\n\n\t\t\tthis.clearCacheTime();\n\t\t}\n\t}\n\n\tgetScaleData()\n\t{\n\t\tthis.scaleData = [];\n\t\tthis.scaleDayTitles = {};\n\n\t\tlet\n\t\t\tts, scaleFrom, scaleTo,\n\t\t\ttime, dayStamp, title,\n\t\t\tcurDayStamp = false,\n\t\t\ttimeFrom = this.isOneDayScale() ? 0 : this.shownScaleTimeFrom,\n\t\t\ttimeTo = this.isOneDayScale() ? 0 : this.shownScaleTimeTo;\n\n\t\tthis.scaleDateFrom.setHours(timeFrom, 0, 0, 0);\n\t\tthis.scaleDateTo.setHours(timeTo, 0, 0, 0);\n\t\tscaleFrom = this.scaleDateFrom.getTime();\n\t\tscaleTo = this.scaleDateTo.getTime();\n\n\t\tfor (ts = scaleFrom; ts < scaleTo; ts += this.scaleSize * 1000)\n\t\t{\n\t\t\ttime = parseFloat(BX.date.format('H.i', ts / 1000));\n\n\t\t\tif (this.isOneDayScale())\n\t\t\t\ttitle = BX.date.format('d F, D', ts / 1000);\n\t\t\telse\n\t\t\t\ttitle = BX.date.format('i', ts / 1000) === '00'\n\t\t\t\t\t? BX.date.format(this.SCALE_TIME_FORMAT, ts / 1000)\n\t\t\t\t\t: '';\n\n\t\t\tif (this.isOneDayScale() || (time >= timeFrom && time < timeTo))\n\t\t\t{\n\t\t\t\tdayStamp = BX.date.format('d.m.Y', ts / 1000);\n\t\t\t\tthis.scaleData.push({\n\t\t\t\t\tdaystamp: dayStamp,\n\t\t\t\t\ttimestamp: ts,\n\t\t\t\t\tvalue: ts,\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tdayStart: curDayStamp !== dayStamp\n\t\t\t\t});\n\t\t\t\tcurDayStamp = dayStamp;\n\t\t\t}\n\t\t}\n\n\t\treturn this.scaleData;\n\t}\n\n\tisOneDayScale()\n\t{\n\t\treturn this.scaleType === '1day';\n\t}\n\n\tstatic prepareAccessibilityItem(entry)\n\t{\n\t\tif (!Type.isDate(entry.from))\n\t\t{\n\t\t\tentry.from = Util.parseDate(entry.dateFrom);\n\t\t}\n\n\t\tif (!Type.isDate(entry.to))\n\t\t{\n\t\t\tentry.to = Util.parseDate(entry.dateTo);\n\t\t}\n\n\t\tif (!Type.isDate(entry.from) || !Type.isDate(entry.to))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tentry.from.setSeconds(0,0);\n\t\tentry.fromTimestamp = entry.from.getTime();\n\n\t\tentry.to.setSeconds(0,0);\n\t\tentry.toTimestamp = entry.to.getTime();\n\n\t\tif (!Type.isDate(entry.toReal))\n\t\t{\n\t\t\t// Full day\n\t\t\tif (\n\t\t\t\t(entry.toTimestamp - entry.fromTimestamp) % Util.getDayLength() === 0\n\t\t\t\t&& BX.date.format('H:i', entry.toTimestamp / 1000) === '00:00'\n\t\t\t)\n\t\t\t{\n\t\t\t\tentry.toReal = new Date(entry.to.getTime() + Util.getDayLength());\n\t\t\t\tentry.toReal.setSeconds(0,0);\n\t\t\t\tentry.toTimestampReal = entry.toReal.getTime();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tentry.toReal = entry.to;\n\t\t\t\tentry.toTimestampReal = entry.toTimestamp;\n\t\t\t}\n\t\t}\n\n\t\treturn entry;\n\t}\n\n\taddAccessibilityItem(entry, wrap)\n\t{\n\t\tlet\n\t\t\ttimeFrom, timeTo,\n\t\t\thidden = false,\n\t\t\tfromTimestamp = entry.fromTimestamp,\n\t\t\ttoTimestamp = entry.toTimestampReal || entry.toTimestamp,\n\t\t\tshownScaleTimeFrom = this.isOneDayScale() ? 0 : this.shownScaleTimeFrom,\n\t\t\tshownScaleTimeTo = this.isOneDayScale() ? 24 : this.shownScaleTimeTo,\n\t\t\tfrom = new Date(fromTimestamp),\n\t\t\tto = new Date(toTimestamp);\n\n\t\ttimeFrom = parseInt(from.getHours()) + from.getMinutes() / 60;\n\t\ttimeTo = parseInt(to.getHours()) + to.getMinutes() / 60;\n\n\t\tif (timeFrom > shownScaleTimeTo)\n\t\t{\n\t\t\tfrom = new Date(from.getTime() + Util.getDayLength() - 1);\n\t\t\tfrom.setHours(shownScaleTimeFrom, 0, 0, 0);\n\t\t\tif (from.getTime() >= to.getTime())\n\t\t\t{\n\t\t\t\thidden = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!hidden && timeFrom < shownScaleTimeFrom)\n\t\t{\n\t\t\tfrom.setHours(shownScaleTimeFrom, 0, 0, 0);\n\t\t\tif (from.getTime() >= to.getTime())\n\t\t\t{\n\t\t\t\thidden = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!hidden && timeTo > shownScaleTimeTo)\n\t\t{\n\t\t\tto.setHours(shownScaleTimeTo, 0, 0, 0);\n\t\t\tif (from.getTime() >= to.getTime())\n\t\t\t{\n\t\t\t\thidden = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!hidden && timeTo < shownScaleTimeFrom)\n\t\t{\n\t\t\tto = new Date(to.getTime() - Util.getDayLength() + 1);\n\t\t\tto.setHours(shownScaleTimeTo, 0, 0, 0);\n\t\t\tif (from.getTime() >= to.getTime())\n\t\t\t{\n\t\t\t\thidden = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!hidden && from.getTime() < this.scaleDateTo)\n\t\t{\n\t\t\tlet\n\t\t\t\tfromPos = this.getPosByDate(from),\n\t\t\t\ttoPos = this.getPosByDate(to);\n\n\t\t\tentry.node = wrap.appendChild(BX.create('DIV', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'calendar-planner-acc-entry'\n\t\t\t\t\t\t+ (entry.type && entry.type === 'hr' ? ' calendar-planner-acc-entry-hr' : '')\n\t\t\t\t},\n\t\t\t\tstyle: {\n\t\t\t\t\tleft: fromPos + 'px',\n\t\t\t\t\twidth: Math.max((toPos - fromPos), 3) + 'px'\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tif (entry.title || entry.name)\n\t\t\t{\n\t\t\t\tentry.node.title = entry.title || entry.name;\n\t\t\t}\n\t\t}\n\t}\n\n\tdisplayEntryRow(entry, accessibility = [])\n\t{\n\t\tlet rowWrap;\n\t\tif (entry.type === 'moreLink')\n\t\t{\n\t\t\trowWrap = this.DOM.entrieListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-user\"></div>\n\t\t\t`);\n\n\t\t\tif (this.showEntryName)\n\t\t\t{\n\t\t\t\tthis.DOM.showMoreUsersLink = rowWrap.appendChild(Tag.render`\n\t\t\t\t\t<div class=\"calendar-planner-all-users\" title=\"${entry.title || ''}\">\n\t\t\t\t\t\t${entry.name}\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.showMoreUsersLink = rowWrap.appendChild(Tag.render`\n\t\t\t\t\t<div class=\"calendar-planner-users-more\" title=\"${entry.name || ''}\">\n\t\t\t\t\t\t<span class=\"calendar-planner-users-more-btn\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t}\n\t\t\tEvent.bind(this.DOM.showMoreUsersLink, 'click', () => this.showMoreUsers());\n\n\t\t}\n\t\telse if (entry.type === 'lastUsers')\n\t\t{\n\t\t\trowWrap = this.DOM.entrieListWrap.appendChild(Tag.render`\t\n\t\t\t\t<div class=\"calendar-planner-user\"></div>\n\t\t\t`);\n\n\t\t\tif (this.showEntryName)\n\t\t\t{\n\t\t\t\tthis.DOM.showMoreUsersLink = rowWrap.appendChild(Tag.render`\n\t\t\t\t\t<div class=\"calendar-planner-all-users calendar-planner-last-users\" title=\"${entry.title || ''}\">\n\t\t\t\t\t\t${entry.name}\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.showMoreUsersLink = rowWrap.appendChild(Tag.render`\n\t\t\t\t\t<div class=\"calendar-planner-users-more\" title=\"${entry.title || entry.name}\">\n\t\t\t\t\t\t<span class=\"calendar-planner-users-last-btn\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t}\n\t\t}\n\t\telse if (entry.id && entry.type === 'user')\n\t\t{\n\t\t\trowWrap = this.DOM.entrieListWrap.appendChild(BX.create('DIV', {\n\t\t\t\tattrs: {\n\t\t\t\t\t'data-bx-planner-entry' : entry.uid,\n\t\t\t\t\tclassName: 'calendar-planner-user'\n\t\t\t\t\t\t+ (entry.emailUser ? ' calendar-planner-email-user' : '')\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tif (entry.status && this.entryStatusMap[entry.status])\n\t\t\t{\n\t\t\t\trowWrap.appendChild(BX.create('SPAN', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'calendar-planner-user-status-icon '\n\t\t\t\t\t\t\t+ this.entryStatusMap[entry.status],\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_PL_STATUS_'\n\t\t\t\t\t\t\t+ entry.status.toUpperCase())\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\trowWrap.appendChild(Planner.getEntryAvatarNode(entry));\n\n\t\t\tif (this.showEntryName)\n\t\t\t{\n\t\t\t\trowWrap.appendChild(Tag.render`\n\t\t\t\t\t<span class=\"calendar-planner-user-name\"></span>\n\t\t\t\t`)\n\t\t\t\t.appendChild(BX.create('SPAN', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'calendar-planner-entry-name'\n\t\t\t\t\t},\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\t'bx-tooltip-user-id': entry.id,\n\t\t\t\t\t\t'bx-tooltip-classname': 'calendar-planner-user-tooltip'\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\twidth: (this.entriesListWidth - 42) + 'px'\n\t\t\t\t\t},\n\t\t\t\t\ttext: entry.name\n\t\t\t\t}))\n\t\t\t}\n\t\t}\n\t\telse if (entry.id && entry.type === 'room')\n\t\t{\n\t\t\trowWrap = this.DOM.entrieListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-user\"></div>\n\t\t\t`);\n\t\t\tif (this.showEntryName)\n\t\t\t{\n\t\t\t\trowWrap.appendChild(Tag.render`\n\t\t\t\t\t<span class=\"calendar-planner-user-name\"></span>\n\t\t\t\t`)\n\t\t\t\t.appendChild(Tag.render`\n\t\t\t\t\t<span class=\"calendar-planner-entry-name\" style=\"width: ${this.entriesListWidth - 20}px;\">\n\t\t\t\t\t\t${Text.encode(entry.name)}\n\t\t\t\t\t</span>\n\t\t\t\t`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\trowWrap.appendChild(Tag.render`\n\t\t\t\t\t<div class=\"calendar-planner-location-image-icon\" title=\"${Text.encode(entry.name)}\"></div>\n\t\t\t\t`);\n\t\t\t}\n\t\t}\n\t\telse if (entry.type === 'resource')\n\t\t{\n\t\t\tif (!this.entriesResourceListWrap || !BX.isNodeInDom(this.entriesResourceListWrap))\n\t\t\t{\n\t\t\t\tthis.entriesResourceListWrap = this.DOM.entrieListWrap.appendChild(Tag.render`\n\t\t\t\t\t<div class=\"calendar-planner-container-resource\">\n\t\t\t\t\t\t<div class=\"calendar-planner-resource-header\">\n\t\t\t\t\t\t\t<span class=\"calendar-planner-users-item\">${Loc.getMessage('EC_PL_RESOURCE_TITLE')}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t}\n\n\t\t\trowWrap = this.entriesResourceListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-user\" data-bx-planner-entry=\"${entry.uid}\"></div>\n\t\t\t`);\n\n\t\t\tif (this.showEntryName)\n\t\t\t{\n\t\t\t\trowWrap.appendChild(Tag.render`\n\t\t\t\t\t<span class=\"calendar-planner-user-name\"></span>\n\t\t\t\t`)\n\t\t\t\t.appendChild(Tag.render`\n\t\t\t\t\t<span class=\"calendar-planner-entry-name\" style=\"width: ${this.entriesListWidth - 20}px;\">\n\t\t\t\t\t\t${Text.encode(entry.name)}\n\t\t\t\t\t<span>\n\t\t\t\t`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\trowWrap.appendChild(Tag.render`\n\t\t\t\t\t<div class=\"calendar-planner-location-image-icon\" title=\"${Text.encode(entry.name)}\"></div>\n\t\t\t\t`);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\trowWrap = this.DOM.entrieListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-user\"></div>\n\t\t\t`);\n\t\t\trowWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-all-users\">${Text.encode(entry.name)}</div>\n\t\t\t`);\n\t\t}\n\n\t\tlet top = rowWrap.offsetTop + 13;\n\n\t\tlet dataRowWrap = this.DOM.accessibilityWrap.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-timeline-space\" style=\"top:${top}px\" data-bx-planner-entry=\"${entry.uid||0}\"></div>\n\t\t`);\n\n\t\tif (this.selectMode)\n\t\t{\n\t\t\tentry.selectorControlWrap = this.selector.controlWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-selector-control-row\" data-bx-planner-entry=\"${entry.uid}\" style=\"top: ${top - 4}px;\"></div>\n\t\t\t`);\n\n\t\t\tif (entry.selected)\n\t\t\t{\n\t\t\t\tthis.selectEntryRow(entry);\n\t\t\t}\n\t\t}\n\n\t\t//this.entriesRowMap.set(entry, rowWrap);\n\t\tthis.entriesDataRowMap.set(entry.uid, dataRowWrap);\n\t\taccessibility.forEach((item) => {\n\t\t\titem = Planner.prepareAccessibilityItem(item);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tthis.addAccessibilityItem(item, dataRowWrap);\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic getEntryAvatarNode(entry)\n\t{\n\t\tlet imageNode;\n\t\tconst img = entry.avatar;\n\n\t\tif (!img || img === \"/bitrix/images/1.gif\")\n\t\t{\n\t\t\timageNode = Tag.render`<div bx-tooltip-user-id=\"${entry.id}\" bx-tooltip-classname=\"calendar-planner-user-tooltip\" title=\"${Text.encode(entry.name)}\" class=\"ui-icon calendar-planner-user-image-icon ${(entry.emailUser ? 'ui-icon-common-user-mail' : 'ui-icon-common-user')}\"><i></i></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\timageNode = Tag.render`<div bx-tooltip-user-id=\"${entry.id}\" bx-tooltip-classname=\"calendar-planner-user-tooltip\" title=\"${Text.encode(entry.name)}\" class=\"ui-icon calendar-planner-user-image-icon\"><i style=\"background-image: url('${encodeURI(entry.avatar)}')\"></i></div>`;\n\t\t}\n\t\treturn imageNode;\n\t}\n\n\tselectEntryRow(entry)\n\t{\n\t\tif (BX.type.isPlainObject(entry))\n\t\t{\n\t\t\tlet top = parseInt(entry.dataRowWrap.offsetTop);\n\t\t\tif (\n\t\t\t\t!entry.selectWrap\n\t\t\t\t|| !BX.isParentForNode(this.selectedEntriesWrap, entry.selectWrap)\n\t\t\t)\n\t\t\t{\n\t\t\t\tentry.selectWrap = this.selectedEntriesWrap.appendChild(Tag.render`\n\t\t\t\t\t<div class=\"calendar-planner-timeline-selected\"></div>\n\t\t\t\t`);\n\t\t\t}\n\n\t\t\tentry.selectWrap.style.display = '';\n\t\t\tentry.selectWrap.style.top = (top + 36) + 'px';\n\t\t\tentry.selectWrap.style.width = (parseInt(this.DOM.mainWrap.offsetWidth) + 5) + 'px';\n\n\t\t\tDom.addClass(entry.selectorControlWrap, 'active');\n\t\t\tentry.selected = true;\n\n\t\t\tthis.clearCacheTime();\n\t\t}\n\t}\n\n\tisEntrySelected(entry)\n\t{\n\t\treturn entry && entry.selected;\n\t}\n\n\tdeSelectEntryRow(entry)\n\t{\n\t\tif (BX.type.isPlainObject(entry))\n\t\t{\n\t\t\tif (entry.selectWrap)\n\t\t\t{\n\t\t\t\tentry.selectWrap.style.display = 'none';\n\t\t\t}\n\t\t\tif (entry.selectorControlWrap)\n\t\t\t{\n\t\t\t\tDom.removeClass(entry.selectorControlWrap, 'active');\n\t\t\t}\n\t\t\tentry.selected = false;\n\t\t\tthis.clearCacheTime();\n\t\t}\n\t}\n\n\tstatic getEntryUniqueId(entry)\n\t{\n\t\treturn ['user', 'room'].includes(entry.type) ? entry.id : entry.type + '-' + entry.id;\n\t}\n\n\tgetEntryByUniqueId(entryUniqueId)\n\t{\n\t\tif (BX.type.isArray(this.entries))\n\t\t{\n\t\t\treturn this.entries.find(function(entry){return entry.uid == entryUniqueId;})\n\t\t}\n\t\treturn null;\n\t}\n\n\tbindEventHandlers()\n\t{\n\t\tEvent.bind(this.DOM.wrap, 'click', this.handleClick.bind(this));\n\t\tEvent.bind(this.DOM.wrap, 'contextmenu', this.handleClick.bind(this));\n\t\tEvent.bind(this.DOM.wrap, 'mousedown', this.handleMousedown.bind(this));\n\t\tEvent.bind(document, 'mousemove', this.handleMousemove.bind(this));\n\t\tEvent.bind(document, 'mouseup', this.handleMouseup.bind(this));\n\n\t\tEvent.bind(\n\t\t\tthis.DOM.timelineFixedWrap,\n\t\t\t'onwheel' in document ? 'wheel' : 'mousewheel',\n\t\t\tthis.mouseWheelTimelineHandler.bind(this)\n\t\t);\n\n\t}\n\n\thandleClick(e)\n\t{\n\t\tif (!e)\n\t\t{\n\t\t\te = window.event;\n\t\t}\n\t\te.preventDefault();\n\t\tconst isRightClick = e.which === 3;\n\t\tif (isRightClick || e.target.className === 'calendar-planner-today-button')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clickMousePos = this.getMousePos(e);\n\t\tlet\n\t\t\tnodeTarget = e.target || e.srcElement,\n\t\t\taccuracyMouse = 5;\n\n\t\tif (this.selectMode &&\n\t\t\tDom.hasClass(nodeTarget, 'calendar-planner-selector-control-row'))\n\t\t{\n\t\t\tlet entry = this.getEntryByUniqueId(nodeTarget.getAttribute('data-bx-planner-entry'));\n\t\t\tif (entry)\n\t\t\t{\n\t\t\t\tif (!this.isEntrySelected(entry))\n\t\t\t\t{\n\t\t\t\t\tthis.selectEntryRow(entry);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.deSelectEntryRow(entry);\n\t\t\t\t}\n\n\t\t\t\tthis.selector.checkStatus();\n\n\t\t\t\tBX.onCustomEvent('OnCalendarPlannerSelectedEntriesOnChange', [{\n\t\t\t\t\tplannerId: this.id,\n\t\t\t\t\tentries: this.entries\n\t\t\t\t}]);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.readonly)\n\t\t{\n\t\t\tlet\n\t\t\t\ttimeline = this.findTarget(nodeTarget, 'timeline'),\n\t\t\t\tselector = this.findTarget(nodeTarget, 'selector');\n\n\t\t\tif (timeline && !selector && Math.abs(this.clickMousePos.x - this.mouseDownMousePos.x) < accuracyMouse && Math.abs(this.clickMousePos.y - this.mouseDownMousePos.y) < accuracyMouse)\n\t\t\t{\n\t\t\t\tconst left = this.clickMousePos.x - BX.pos(this.DOM.timelineFixedWrap).left + this.DOM.timelineVerticalConstraint.scrollLeft;\n\t\t\t\tconst mapDatePosRes = this.mapDatePos(this.clickSelectorScaleAccuracy);\n\t\t\t\tlet selectedDateFrom = this.getDateByPos(left, false, mapDatePosRes.posDateMap);\n\t\t\t\tif (!selectedDateFrom)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst selectorTimeLength = this.currentToDate - this.currentFromDate;\n\t\t\t\tlet selectedDateTo = new Date(selectedDateFrom.getTime() + selectorTimeLength);\n\t\t\t\tthis.currentFromDate = selectedDateFrom;\n\t\t\t\tthis.currentToDate = selectedDateTo;\n\n\t\t\t\tthis.selector.transit({\n\t\t\t\t\ttoX: this.getPosByDate(selectedDateFrom),\n\t\t\t\t\tleftDate: this.currentFromDate,\n\t\t\t\t\trightDate: this.currentToDate\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\thandleMousedown(e)\n\t{\n\t\tif (!e)\n\t\t{\n\t\t\te = window.event;\n\t\t}\n\n\t\tlet nodeTarget = e.target || e.srcElement;\n\t\tthis.mouseDownMousePos = this.getMousePos(e);\n\t\tthis.mouseDown = true;\n\n\t\tif (!this.readonly)\n\t\t{\n\t\t\tlet selector = this.findTarget(nodeTarget, 'selector');\n\t\t\tthis.startMousePos = this.mouseDownMousePos;\n\n\t\t\tif (selector)\n\t\t\t{\n\t\t\t\tif (this.findTarget(nodeTarget, 'selector-resize-right'))\n\t\t\t\t{\n\t\t\t\t\tthis.selector.startResize();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.selector.startMove();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.findTarget(nodeTarget, 'timeline'))\n\t\t\t{\n\t\t\t\tthis.startScrollTimeline();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleMouseup()\n\t{\n\t\tif (this.selector.isDragged())\n\t\t{\n\t\t\tthis.selector.endMove();\n\t\t\tthis.selector.endResize();\n\t\t}\n\n\t\tif(this.timelineIsDraged)\n\t\t{\n\t\t\tthis.endScrollTimeline();\n\t\t}\n\n\t\tif (this.shown && !this.readonly && this.mouseDown)\n\t\t{\n\t\t\tthis.checkTimelineScroll();\n\t\t}\n\n\t\tthis.mouseDown = false;\n\t\tDom.removeClass(document.body, 'calendar-planner-unselectable');\n\t}\n\n\thandleMousemove(e)\n\t{\n\t\tlet\n\t\t\tmousePos,\n\t\t\ttarget = e.target || e.srcElement;\n\n\t\tif (this.selectMode && target && target.getAttribute && target.getAttribute('data-bx-planner-entry'))\n\t\t{\n\t\t\tthis.lastTouchedEntry = target;\n\t\t}\n\n\t\tif (this.selector.isDragged())\n\t\t{\n\t\t\tmousePos = this.getMousePos(e);\n\t\t\tthis.selector.move(mousePos.x - this.startMousePos.x);\n\t\t\tthis.selector.resize(mousePos.x - this.startMousePos.x);\n\t\t}\n\n\t\tif(this.timelineIsDraged)\n\t\t{\n\t\t\tmousePos = this.getMousePos(e);\n\t\t\tthis.scrollTimeline(mousePos.x - this.startMousePos.x);\n\t\t}\n\t}\n\n\tmouseWheelTimelineHandler(e)\n\t{\n\t\te = e || window.event;\n\t\tif (this.shown && !this.readonly)\n\t\t{\n\t\t\tif (Browser.isMac())\n\t\t\t{\n\t\t\t\tthis.checkTimelineScroll();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst delta = e.deltaY || e.detail || e.wheelDelta;\n\t\t\t\tif (Math.abs(delta) > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.timelineVerticalConstraint.scrollLeft = Math.max(\n\t\t\t\t\t\tthis.DOM.timelineVerticalConstraint.scrollLeft + Math.round(delta / 3),\n\t\t\t\t\t\t0\n\t\t\t\t\t);\n\t\t\t\t\tthis.checkTimelineScroll();\n\t\t\t\t\treturn BX.PreventDefault(e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateTodayButtonVisibility(animation = true)\n\t{\n\t\tif (this.isOneDayScale())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.todayButton.style.transition = animation ? '' : 'none';\n\n\t\tconst today = new Date();\n\t\ttoday.setHours(this.shownScaleTimeFrom, 0, 0, 0);\n\n\t\tlet parent = this.DOM.entriesOuterWrap;\n\t\tif (this.todayTitleButton)\n\t\t{\n\t\t\tparent = this.todayTitleButton.parentElement;\n\t\t}\n\n\t\tconst doDisplayTodayButton = today.getTime() < this.scaleDateTo.getTime()\n\t\t\t&& BX.pos(parent).left + 30 < BX.pos(this.DOM.entriesOuterWrap).right;\n\t\tif (doDisplayTodayButton && this.todayButton.style.display !== '')\n\t\t{\n\t\t\tthis.todayButton.style.display = '';\n\t\t\tthis.setFutureDayTitlesOffset(false);\n\t\t}\n\t\tif (!doDisplayTodayButton && this.todayButton.style.display !== 'none')\n\t\t{\n\t\t\tthis.todayButton.style.display = 'none';\n\t\t\tthis.setFutureDayTitlesOffset(false);\n\t\t}\n\n\t\tconst doAddLeftArrow = BX.pos(this.todayTitleButton).right + (this.todayButtonLeftWidth - this.todayButtonWidth) < BX.pos(this.DOM.entriesOuterWrap).right;\n\t\tif (doAddLeftArrow && this.todayButton.innerHTML === this.todayLocMessage)\n\t\t{\n\t\t\tthis.todayButton.innerHTML = this.todayLocMessage + ' &larr;';\n\t\t\tthis.todayButton.style.width = this.todayButtonLeftWidth + 'px';\n\t\t\tthis.setFutureDayTitlesOffset(animation);\n\t\t}\n\t\tif (!doAddLeftArrow && this.todayButton.innerHTML !== this.todayLocMessage)\n\t\t{\n\t\t\tthis.todayButton.innerHTML = this.todayLocMessage;\n\t\t\tthis.todayButton.style.width = this.todayButtonWidth + 'px';\n\t\t\tthis.setFutureDayTitlesOffset(animation);\n\t\t}\n\n\t\tconst isTodayInFuture = today.getTime() > this.scaleDateTo.getTime();\n\t\tconst doDisplayTodayRightButton = isTodayInFuture || BX.pos(parent).right > BX.pos(this.DOM.timelineVerticalConstraint).right;\n\t\tif (doDisplayTodayRightButton && this.todayRightButton.style.display !== '')\n\t\t{\n\t\t\tthis.todayRightButton.style.display = '';\n\t\t}\n\t\tif (!doDisplayTodayRightButton && this.todayRightButton.style.display !== 'none')\n\t\t{\n\t\t\tthis.todayRightButton.style.display = 'none';\n\t\t}\n\n\t\tif (this.todayTitleButton)\n\t\t{\n\t\t\tif (BX.pos(this.todayTitleButton).right < BX.pos(this.DOM.timelineVerticalConstraint).right)\n\t\t\t{\n\t\t\t\tthis.todayTitleButton.style.position = 'sticky';\n\t\t\t}\n\t\t\tif (BX.pos(this.todayTitleButton).right > BX.pos(this.DOM.timelineVerticalConstraint).right)\n\t\t\t{\n\t\t\t\tthis.todayTitleButton.style.position = '';\n\t\t\t}\n\t\t}\n\n\t\tconst doAddRightArrow = BX.pos(parent).left > BX.pos(this.DOM.timelineVerticalConstraint).right || isTodayInFuture;\n\t\tif (doAddRightArrow && this.todayRightButton.innerHTML === this.todayLocMessage)\n\t\t{\n\t\t\tthis.todayRightButton.innerHTML = this.todayLocMessage + ' &rarr;';\n\t\t\tthis.todayRightButton.style.width = this.todayButtonRightWidth + 'px';\n\t\t}\n\t\tif (!doAddRightArrow && this.todayRightButton.innerHTML !== this.todayLocMessage)\n\t\t{\n\t\t\tthis.todayRightButton.innerHTML = this.todayLocMessage;\n\t\t\tthis.todayRightButton.style.width = this.todayButtonWidth + 'px';\n\t\t}\n\t}\n\n\tsetFutureDayTitlesOffset(animation = true)\n\t{\n\t\tconst left = this.todayButton.style.display === 'none' ? '' : (parseInt(this.todayButton.style.width) + 4) + 'px';\n\t\tfor (const title of this.futureDayTitles)\n\t\t{\n\t\t\ttitle.style.transition = animation ? '' : 'none';\n\t\t\ttitle.style.left = left;\n\t\t}\n\t}\n\n\ttodayButtonClickHandler()\n\t{\n\t\tif (this.readonly)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.todayButtonPivotDay)\n\t\t{\n\t\t\tconst today = new Date();\n\t\t\ttoday.setHours(this.shownScaleTimeFrom, 0, 0, 0);\n\t\t\tnew BX.easing({\n\t\t\t\tduration: 300,\n\t\t\t\tstart: {scrollLeft: this.DOM.timelineVerticalConstraint.scrollLeft},\n\t\t\t\tfinish: {scrollLeft: this.getPosByDate(today)},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quad),\n\t\t\t\tstep: (state)=>{this.DOM.timelineVerticalConstraint.scrollLeft = state.scrollLeft;},\n\t\t\t\tcomplete: ()=>{}\n\t\t\t}).animate();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.scaleDateFrom = new Date();\n\t\t\tthis.scaleDateFrom.setHours(this.shownScaleTimeFrom, 0, 0, 0);\n\n\t\t\tthis.scaleDateTo = new Date(new Date().getTime() + Util.getDayLength() * this.SCALE_OFFSET_AFTER);\n\t\t\tthis.scaleDateTo.setHours(this.shownScaleTimeTo, 0, 0, 0);\n\n\t\t\tthis.rebuild();\n\t\t\tthis.DOM.timelineVerticalConstraint.scrollLeft = 0;\n\n\t\t\tthis.emit('onExpandTimeline', new BaseEvent({\n\t\t\t\tdata: {\n\t\t\t\t\treload: true,\n\t\t\t\t\tdateFrom: this.scaleDateFrom,\n\t\t\t\t\tdateTo: this.scaleDateTo\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tcheckTimelineScroll()\n\t{\n\t\tconst minScroll = this.scrollStep;\n\t\tconst maxScroll = this.DOM.timelineVerticalConstraint.scrollWidth\n\t\t\t\t\t\t\t- this.DOM.timelineFixedWrap.offsetWidth\n\t\t\t\t\t\t\t- this.scrollStep;\n\n\t\t// Check and expand only if it is visible\n\t\tif (this.DOM.timelineFixedWrap.offsetWidth > 0)\n\t\t{\n\t\t\tconst today = new Date();\n\t\t\ttoday.setHours(this.scaleDateFrom.getHours(), 0, 0, 0);\n\t\t\tif ((this.DOM.timelineVerticalConstraint.scrollLeft <= minScroll) && (this.scaleDateFrom.getTime() > today.getTime()))\n\t\t\t{\n\t\t\t\tthis.expandTimelineDirection = 'past';\n\t\t\t}\n\t\t\tif (this.DOM.timelineVerticalConstraint.scrollLeft >= maxScroll)\n\t\t\t{\n\t\t\t\tthis.expandTimelineDirection = 'future';\n\t\t\t}\n\n\t\t\tif (this.expandTimelineDirection)\n\t\t\t{\n\t\t\t\tif (!this.isLoaderShown())\n\t\t\t\t{\n\t\t\t\t\tthis.showLoader();\n\t\t\t\t}\n\t\t\t\tthis.expandTimelineDebounce();\n\t\t\t}\n\t\t}\n\t}\n\n\tstartScrollTimeline()\n\t{\n\t\tthis.timelineIsDraged = true;\n\t\tthis.timelineStartScrollLeft = this.DOM.timelineVerticalConstraint.scrollLeft;\n\t}\n\tscrollTimeline(x)\n\t{\n\t\tthis.DOM.timelineVerticalConstraint.scrollLeft = Math.max(this.timelineStartScrollLeft - x, 0);\n\t}\n\tendScrollTimeline()\n\t{\n\t\tthis.timelineIsDraged = false;\n\t}\n\n\tfindTarget(node, nodeMetaType, parentCont)\n\t{\n\t\tif (!parentCont)\n\t\t\tparentCont = this.DOM.mainWrap;\n\n\t\tlet type = (node && node.getAttribute) ? node.getAttribute('data-bx-planner-meta') : null;\n\n\t\tif (type !== nodeMetaType)\n\t\t{\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tnode = BX.findParent(node, function(n)\n\t\t\t\t{\n\t\t\t\t\treturn n.getAttribute && n.getAttribute('data-bx-planner-meta') === nodeMetaType;\n\t\t\t\t}, parentCont);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnode = null;\n\t\t\t}\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tgetMousePos(e)\n\t{\n\t\tif (!e)\n\t\t\te = window.event;\n\n\t\tlet x = 0, y = 0;\n\t\tif (e.pageX || e.pageY)\n\t\t{\n\t\t\tx = e.pageX;\n\t\t\ty = e.pageY;\n\t\t}\n\t\telse if (e.clientX || e.clientY)\n\t\t{\n\t\t\tx = e.clientX + (document.documentElement.scrollLeft || document.body.scrollLeft) - document.documentElement.clientLeft;\n\t\t\ty = e.clientY + (document.documentElement.scrollTop || document.body.scrollTop) - document.documentElement.clientTop;\n\t\t}\n\n\t\treturn {x: x, y: y};\n\t}\n\n\tsetScaleType(scaleType)\n\t{\n\t\tif (!this.scaleTypes.includes(scaleType))\n\t\t{\n\t\t\tscaleType = '1hour';\n\t\t}\n\n\t\tthis.scaleType = scaleType;\n\t\tthis.scaleSize = Planner.getScaleSize(scaleType);\n\n\t\tif (this.isOneDayScale() && this.timelineCellWidth < 100)\n\t\t{\n\t\t\tthis.timelineCellWidthOrig = this.timelineCellWidth;\n\t\t\tthis.timelineCellWidth = 100;\n\t\t}\n\t\telse if (!this.isOneDayScale() && this.timelineCellWidthOrig)\n\t\t{\n\t\t\tthis.timelineCellWidth = this.timelineCellWidthOrig;\n\t\t\tthis.timelineCellWidthOrig = false;\n\t\t}\n\n\t\tif (this.isOneDayScale())\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-fulldaymode');\n\t\t\tif (this.DOM.entriesOuterWrap)\n\t\t\t{\n\t\t\t\tDom.addClass(this.DOM.entriesOuterWrap, 'calendar-planner-no-daytitle');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.DOM.mainWrap, 'calendar-planner-fulldaymode');\n\t\t\tif (this.DOM.entriesOuterWrap)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.DOM.entriesOuterWrap, 'calendar-planner-no-daytitle');\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getScaleSize(scaleType)\n\t{\n\t\tlet\n\t\t\thour = 3600,\n\t\t\tmap = {\n\t\t\t\t'15min' : Math.round(hour / 4),\n\t\t\t\t'30min' : Math.round(hour / 2),\n\t\t\t\t'1hour' : hour,\n\t\t\t\t'2hour' : hour * 2,\n\t\t\t\t'1day' : hour * 24\n\t\t\t};\n\n\t\treturn map[scaleType] || hour;\n\t}\n\n\tmapDatePos(accuracy)\n\t{\n\t\tif (!accuracy)\n\t\t{\n\t\t\taccuracy = this.accuracy;\n\t\t}\n\n\t\tlet datePosMap = {};\n\t\tlet posDateMap = {};\n\t\tlet i, j, tsi, xi, tsj, xj, cellWidth;\n\n\t\tthis.substeps = Math.round(this.scaleSize / accuracy);\n\t\tthis.posAccuracy = this.timelineCellWidth / this.substeps;\n\n\t\taccuracy = accuracy * 1000;\n\t\tlet scaleSize = this.scaleData[1].timestamp - this.scaleData[0].timestamp;\n\n\t\tfor (i = 0; i < this.scaleData.length; i++)\n\t\t{\n\t\t\ttsi = this.scaleData[i].timestamp;\n\t\t\txi = parseInt(this.scaleData[i].cell.offsetLeft);\n\t\t\tcellWidth = parseInt(this.scaleData[i].cell.offsetWidth);\n\n\t\t\tif (!datePosMap[tsi])\n\t\t\t{\n\t\t\t\tdatePosMap[tsi] = xi;\n\t\t\t}\n\t\t\tposDateMap[xi] = tsi;\n\n\t\t\tfor (j = 1; j <= cellWidth; j++)\n\t\t\t{\n\t\t\t\ttsj = tsi + Math.round((j * scaleSize / cellWidth) / accuracy) * accuracy;\n\t\t\t\txj = xi + j;\n\t\t\t\tif (!datePosMap[tsi])\n\t\t\t\t{\n\t\t\t\t\tdatePosMap[tsj] = xj;\n\t\t\t\t}\n\t\t\t\tposDateMap[xj] = tsj;\n\n\t\t\t\tif (j === cellWidth &&\n\t\t\t\t\t(!this.scaleData[i + 1] || this.scaleData[i + 1].dayStart))\n\t\t\t\t{\n\t\t\t\t\tdatePosMap[xj + '_end'] = tsj;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (i + 1 < this.scaleData.length && this.scaleData[i + 1].dayStart)\n\t\t\t{\n\t\t\t\tconst borderStart = xi + cellWidth;\n\t\t\t\tconst borderEnd = parseInt(this.scaleData[i + 1].cell.offsetLeft);\n\t\t\t\tconst borderTimestamp = tsi + scaleSize;\n\t\t\t\tfor (let borderX = borderStart; borderX < borderEnd; borderX++)\n\t\t\t\t{\n\t\t\t\t\tposDateMap[borderX] = borderTimestamp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tdatePosMap: datePosMap,\n\t\t\tposDateMap: posDateMap\n\t\t}\n\t}\n\n\tgetPosByDate(date)\n\t{\n\t\tlet x = 0;\n\t\tif (date && typeof date !== 'object')\n\t\t{\n\t\t\tdate = Util.parseDate(date);\n\t\t}\n\n\t\tif (date && typeof date === 'object')\n\t\t{\n\t\t\tlet curInd = 0;\n\t\t\tconst timestamp = date.getTime();\n\n\t\t\tfor (let i = 0; i < this.scaleData.length; i++)\n\t\t\t{\n\t\t\t\tif (timestamp >= this.scaleData[i].timestamp)\n\t\t\t\t{\n\t\t\t\t\tcurInd = i;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.scaleData[curInd] && this.scaleData[curInd].cell)\n\t\t\t{\n\t\t\t\tx = this.scaleData[curInd].cell.offsetLeft;\n\t\t\t\tconst cellWidth = this.scaleData[curInd].cell.offsetWidth;\n\t\t\t\tconst deltaTs = Math.round((timestamp - this.scaleData[curInd].timestamp) / 1000);\n\n\t\t\t\tif (deltaTs > 0)\n\t\t\t\t{\n\t\t\t\t\tx += Math.round(deltaTs * 10 / this.scaleSize * cellWidth) / 10;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn x;\n\t}\n\n\tgetDateByPos(x, end, posDateMap)\n\t{\n\t\tif (!posDateMap)\n\t\t{\n\t\t\tposDateMap = this.posDateMap;\n\t\t}\n\t\tlet\n\t\t\tdate,\n\t\t\ttimestamp = (end && posDateMap[x + '_end']) ? posDateMap[x + '_end'] : posDateMap[x];\n\n\t\tif (!timestamp)\n\t\t{\n\t\t\tx = Math.round(x);\n\t\t\ttimestamp = (end && posDateMap[x + '_end']) ?  posDateMap[x + '_end'] : posDateMap[x];\n\t\t}\n\n\t\tif (timestamp)\n\t\t{\n\t\t\tdate = new Date(timestamp);\n\t\t}\n\n\t\treturn date;\n\t}\n\n\tshowMoreUsers()\n\t{\n\t\tthis.MIN_ENTRY_ROWS = this.MAX_ENTRY_ROWS;\n\t\tthis.update(this.entries, this.accessibility);\n\t\tthis.rebuildDebounce();\n\t}\n\n\tadjustHeight()\n\t{\n\t\tlet\n\t\t\tnewHeight = this.DOM.entrieListWrap.offsetHeight + this.DOM.entrieListWrap.offsetTop + 30,\n\t\t\tcurrentHeight = parseInt(this.DOM.wrap.style.height) || this.height;\n\n\t\tif (this.compactMode && currentHeight < newHeight || !this.compactMode)\n\t\t{\n\t\t\tthis.DOM.wrap.style.height = currentHeight + 'px';\n\t\t\tthis.resizePlannerHeight(newHeight, Math.abs(newHeight - currentHeight) > 10);\n\t\t}\n\t}\n\n\tresizePlannerHeight(height, animation = false)\n\t{\n\t\tthis.height = height;\n\t\tif (animation)\n\t\t{\n\t\t\t// Stop animation before starting another one\n\t\t\tif(this.resizeAnimation)\n\t\t\t{\n\t\t\t\tthis.resizeAnimation.stop();\n\t\t\t\tthis.resizeAnimation = null;\n\t\t\t}\n\t\t\tthis.resizeAnimation = new BX.easing({\n\t\t\t\tduration: 800,\n\t\t\t\tstart: {height: parseInt(this.DOM.wrap.style.height)},\n\t\t\t\tfinish: {height: height},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tthis.resizePlannerHeight(state.height, false);\n\t\t\t\t},\n\t\t\t\tcomplete: () => {this.resizeAnimation = null;}\n\t\t\t});\n\t\t\tthis.resizeAnimation.animate();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.wrap.style.height = height + 'px';\n\t\t\tthis.DOM.mainWrap.style.height = height + 'px';\n\t\t\tthis.DOM.timelineFixedWrap.style.height = height + 'px';\n\t\t\tlet timelineDataContHeight = this.DOM.entrieListWrap.offsetHeight + 3;\n\t\t\tthis.DOM.timelineDataWrap.style.height = timelineDataContHeight + 'px';\n\t\t\t// Todo: resize selector\n\t\t\t//this.selector.wrap.style.height = (timelineDataContHeight + 10) + 'px';\n\t\t\tthis.DOM.entriesOuterWrap.style.height = height + 'px';\n\n\t\t\tif (this.DOM.proposeTimeButton && this.DOM.proposeTimeButton.style.display !== \"none\")\n\t\t\t{\n\t\t\t\tthis.DOM.proposeTimeButton.style.top = (this.DOM.timelineDataWrap.offsetTop + timelineDataContHeight / 2 - 16) + \"px\";\n\t\t\t}\n\t\t}\n\t}\n\n\tresizePlannerWidth(width, animation)\n\t{\n\t\tif (!animation && this.DOM.wrap && this.DOM.mainWrap)\n\t\t{\n\t\t\tthis.DOM.wrap.style.width = width + 'px';\n\t\t\tlet entriesListWidth = this.compactMode ? 0 : this.entriesListWidth;\n\t\t\tthis.DOM.mainWrap.style.width = width + 'px';\n\t\t\tthis.DOM.entriesOuterWrap.style.width = entriesListWidth + 'px';\n\t\t}\n\t}\n\n\texpandTimeline(scaleDateFrom, scaleDateTo)\n\t{\n\t\tlet loadedTimelineSize;\n\t\tlet scrollLeft;\n\t\tconst prevScaleDateFrom = this.scaleDateFrom;\n\t\tconst prevScaleDateTo = this.scaleDateTo;\n\n\t\tif (!scaleDateFrom)\n\t\t\tscaleDateFrom = this.scaleDateFrom;\n\t\tif (!scaleDateTo)\n\t\t\tscaleDateTo = this.scaleDateTo;\n\n\t\tif (this.expandTimelineDirection === 'past')\n\t\t{\n\t\t\tscrollLeft = this.DOM.timelineVerticalConstraint.scrollLeft;\n\t\t\tthis.scaleDateFrom = new Date(scaleDateFrom.getTime() - Util.getDayLength()  * this.EXPAND_OFFSET);\n\t\t\tconst today = new Date();\n\t\t\ttoday.setHours(this.scaleDateFrom.getHours(), 0, 0, 0);\n\t\t\tif (this.scaleDateFrom.getTime() < today)\n\t\t\t{\n\t\t\t\tthis.scaleDateFrom = today;\n\t\t\t}\n\n\t\t\tloadedTimelineSize = (this.scaleDateTo.getTime() - this.scaleDateFrom.getTime()) / Util.getDayLength();\n\t\t\tif (loadedTimelineSize > this.maxTimelineSize)\n\t\t\t{\n\t\t\t\tthis.scaleDateTo = new Date(this.scaleDateFrom.getTime() + Util.getDayLength()  * this.maxTimelineSize);\n\t\t\t\tthis.loadedDataFrom = this.scaleDateFrom;\n\t\t\t\tthis.loadedDataTo = this.scaleDateTo;\n\t\t\t\tthis.limitScaleSizeMode = true;\n\t\t\t}\n\t\t}\n\t\telse if (this.expandTimelineDirection === 'future')\n\t\t{\n\t\t\tlet oldDateTo = this.scaleDateTo;\n\t\t\tscrollLeft = this.DOM.timelineVerticalConstraint.scrollLeft;\n\t\t\tthis.scaleDateTo = new Date(scaleDateTo.getTime() + Util.getDayLength() * this.EXPAND_OFFSET);\n\t\t\tloadedTimelineSize = (this.scaleDateTo.getTime() - this.scaleDateFrom.getTime()) / Util.getDayLength();\n\n\t\t\tif (loadedTimelineSize > this.maxTimelineSize)\n\t\t\t{\n\t\t\t\tthis.scaleDateFrom = new Date(this.scaleDateTo.getTime() - Util.getDayLength()  * this.maxTimelineSize);\n\t\t\t\tthis.loadedDataFrom = this.scaleDateFrom;\n\t\t\t\tthis.loadedDataTo = this.scaleDateTo;\n\n\t\t\t\tscrollLeft = this.getPosByDate(oldDateTo) - this.DOM.timelineFixedWrap.offsetWidth;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.DOM.timelineVerticalConstraint.scrollLeft = this.getPosByDate(oldDateTo) - this.DOM.timelineFixedWrap.offsetWidth;\n\t\t\t\t}, 10);\n\n\t\t\t\tthis.limitScaleSizeMode = true;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.scaleDateFrom = new Date(scaleDateFrom.getTime() - Util.getDayLength()  * this.SCALE_OFFSET_BEFORE);\n\t\t\tthis.scaleDateTo = new Date(scaleDateTo.getTime() + Util.getDayLength() * this.SCALE_OFFSET_AFTER);\n\t\t}\n\n\t\tconst reloadData = this.scaleDateFrom.getTime() < prevScaleDateFrom.getTime()\n\t\t|| this.scaleDateTo.getTime() > prevScaleDateTo.getTime();\n\n\t\tthis.hideLoader();\n\t\tthis.emit('onExpandTimeline', new BaseEvent({\n\t\t\tdata: {\n\t\t\t\treload: reloadData,\n\t\t\t\tdateFrom: this.scaleDateFrom,\n\t\t\t\tdateTo: this.scaleDateTo\n\t\t\t} }));\n\n\t\tconst currentPlannerWidth = this.DOM.timelineInnerWrap.offsetWidth;\n\t\tthis.rebuild({\n\t\t\tupdateSelector: true\n\t\t});\n\n\t\tif (this.expandTimelineDirection === 'past')\n\t\t{\n\t\t\tconst widthDiff = this.DOM.timelineInnerWrap.offsetWidth - currentPlannerWidth;\n\t\t\tthis.DOM.timelineVerticalConstraint.scrollLeft = scrollLeft + widthDiff;\n\t\t}\n\t\telse if (scrollLeft !== undefined)\n\t\t{\n\t\t\tthis.DOM.timelineVerticalConstraint.scrollLeft = scrollLeft;\n\t\t}\n\n\t\tthis.expandTimelineDirection = null;\n\t}\n\n\tgetVisibleEvents()\n\t{\n\t\tconst visibleEvents = [];\n\n\t\tconst timelineFromPosition = this.DOM.timelineVerticalConstraint.scrollLeft;\n\t\tconst timelineToPosition = timelineFromPosition + this.DOM.timelineFixedWrap.offsetWidth;\n\n\t\tfor (const index in this.accessibility)\n\t\t{\n\t\t\tfor (const event of this.accessibility[index])\n\t\t\t{\n\t\t\t\tconst eventFromPosition = this.getPosByDate(new Date(event.fromTimestamp));\n\t\t\t\tconst eventToPosition = this.getPosByDate(new Date(event.toTimestamp));\n\t\t\t\tif (\n\t\t\t\t\tthis.doSegmentsIntersect(eventFromPosition, eventToPosition, timelineFromPosition, timelineToPosition)\n\t\t\t\t\t&& event.node\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tvisibleEvents.push(event);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn visibleEvents;\n\t}\n\n\tgetEventsAfter(events, timestamp)\n\t{\n\t\tconst eventsAfter = [];\n\t\tfor (const event of events)\n\t\t{\n\t\t\tif (event.fromTimestamp >= timestamp)\n\t\t\t{\n\t\t\t\teventsAfter.push(event);\n\t\t\t}\n\t\t}\n\t\treturn eventsAfter;\n\t}\n\n\tupdate(entries = [], accessibility = {})\n\t{\n\t\tDom.clean(this.DOM.entrieListWrap);\n\t\tDom.clean(this.DOM.accessibilityWrap);\n\t\tthis.entriesDataRowMap = new Map();\n\n\t\tif (!Type.isArray(entries))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.entries = entries;\n\t\tthis.accessibility = accessibility;\n\n\t\tconst userId = parseInt(this.userId);\n\n\t\t// sort entries list by amount of accessibility data\n\t\t// Entries without accessibility data should be in the end of the array\n\t\t// But first in the list will be meeting room\n\t\t// And second (or first) will be owner-host of the event\n\t\tentries.sort((a, b) => {\n\t\t\tif (b.status === 'h' || parseInt(b.id) === userId && a.status !== 'h')\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tif (a.status === 'h' || parseInt(a.id) === userId && b.status !== 'h')\n\t\t\t{\n\t\t\t\treturn  -1;\n\t\t\t}\n\t\t\tif (parseInt(a.id) < parseInt(b.id))\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn 1;\n\t\t});\n\n\t\tif (this.selectedEntriesWrap)\n\t\t{\n\t\t\tDom.clean(this.selectedEntriesWrap);\n\t\t\tif (this.selector && this.selector.controlWrap)\n\t\t\t{\n\t\t\t\tDom.clean(this.selector.controlWrap);\n\t\t\t}\n\t\t}\n\n\t\tconst cutData = [];\n\t\tconst cutDataTitle = [];\n\t\tlet usersCount = 0;\n\t\tlet cutAmount = 0;\n\t\tlet dispDataCount = 0;\n\n\t\tentries.forEach((entry, ind) => {\n\t\t\tentry.uid = Planner.getEntryUniqueId(entry);\n\n\t\t\tlet accData = Type.isArray(accessibility[entry.uid]) ? accessibility[entry.uid] : [];\n\t\t\tthis.entriesIndex.set(entry.uid, entry);\n\n\t\t\tif (entry.type === 'user')\n\t\t\t{\n\t\t\t\tusersCount++;\n\t\t\t}\n\n\t\t\tif (ind < this.MIN_ENTRY_ROWS || entries.length === this.MIN_ENTRY_ROWS + 1)\n\t\t\t{\n\t\t\t\tdispDataCount++;\n\t\t\t\tthis.displayEntryRow(entry, accData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcutAmount++;\n\t\t\t\tcutDataTitle.push(entry.name);\n\t\t\t\taccData.forEach((item) => {\n\t\t\t\t\titem = Planner.prepareAccessibilityItem(item);\n\t\t\t\t\tif (item)\n\t\t\t\t\t{\n\t\t\t\t\t\tcutData.push(item);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// Update entries title count\n\t\tif (this.entriesListTitleCounter)\n\t\t{\n\t\t\tthis.entriesListTitleCounter.innerHTML = usersCount > this.MAX_ENTRY_ROWS ? '(' + usersCount + ')' : '';\n\t\t}\n\t\t\tthis.emit('onDisplayAttendees', new BaseEvent({\n\t\t\t\tdata:  {\n\t\t\t\t\tusersCount: usersCount\n\t\t\t\t}\n\t\t\t}));\n\n\t\tif (cutAmount > 0)\n\t\t{\n\t\t\tif (dispDataCount === this.MAX_ENTRY_ROWS)\n\t\t\t{\n\t\t\t\tthis.displayEntryRow({\n\t\t\t\t\tname: Loc.getMessage('EC_PL_ATTENDEES_LAST') + ' (' + cutAmount + ')',\n\t\t\t\t\ttype: 'lastUsers',\n\t\t\t\t\ttitle: cutDataTitle.join(', ')\n\t\t\t\t}, cutData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.displayEntryRow({\n\t\t\t\t\tname: Loc.getMessage('EC_PL_ATTENDEES_SHOW_MORE') + ' (' + cutAmount + ')',\n\t\t\t\t\ttype: 'moreLink'\n\t\t\t\t}, cutData);\n\t\t\t}\n\t\t}\n\n\t\tthis.clearCacheTime();\n\t\tconst status = this.checkTimePeriod(this.currentFromDate, this.currentToDate) === true;\n\t\tthis.updateSelectorFromStatus(status);\n\n\t\tUtil.extendPlannerWatches({entries: entries, userId: this.userId});\n\n\t\tthis.adjustHeight();\n\t}\n\n\tupdateAccessibility(accessibility)\n\t{\n\t\tthis.accessibility = accessibility;\n\t\tif (Type.isPlainObject(accessibility))\n\t\t{\n\t\t\tlet key;\n\t\t\tfor (key in accessibility)\n\t\t\t{\n\t\t\t\tif (accessibility.hasOwnProperty(key)\n\t\t\t\t\t&& Type.isArray(accessibility[key])\n\t\t\t\t\t&& accessibility[key].length)\n\t\t\t\t{\n\t\t\t\t\tlet wrap = this.entriesDataRowMap.get(key);\n\t\t\t\t\tif (Type.isDomNode(wrap))\n\t\t\t\t\t{\n\t\t\t\t\t\taccessibility[key].forEach((event) => {\n\t\t\t\t\t\t\tevent = Planner.prepareAccessibilityItem(event);\n\t\t\t\t\t\t\tif (event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.addAccessibilityItem(event, wrap)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateSelector(from, to, fullDay, options = {})\n\t{\n\t\tif (this.shown && this.selector)\n\t\t{\n\t\t\tthis.setFullDayMode(fullDay);\n\n\t\t\t// Update limits of scale\n\t\t\tif (!this.isOneDayScale())\n\t\t\t{\n\t\t\t\tif (Util.formatDate(from) !== Util.formatDate(to))\n\t\t\t\t{\n\t\t\t\t\tthis.extendScaleTime(0, 24);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet timeFrom = parseInt(from.getHours()) + Math.floor(from.getMinutes() / 60);\n\t\t\t\t\tlet timeTo = parseInt(to.getHours()) + Math.ceil(to.getMinutes() / 60);\n\t\t\t\t\tlet scale = 2;\n\n\t\t\t\t\tif (timeFrom <= this.shownScaleTimeFrom)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.extendScaleTime(timeFrom - scale, false);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (timeTo >= this.shownScaleTimeTo)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.extendScaleTime(false, timeTo + scale);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ((to.getTime() > this.scaleDateTo.getTime())\n\t\t\t\t||\n\t\t\t\tfrom.getTime() < this.scaleDateFrom.getTime())\n\t\t\t{\n\t\t\t\tthis.expandTimelineDirection = false;\n\t\t\t\tthis.expandTimeline(from, to);\n\t\t\t}\n\n\t\t\tthis.currentFromDate = from;\n\t\t\tthis.currentToDate = to;\n\t\t\tif (!this.selector)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (from.getTime() < this.scaleDateFrom.getTime())\n\t\t\t{\n\t\t\t\tthis.selector.update({\n\t\t\t\t\tfrom: from,\n\t\t\t\t\tto: to,\n\t\t\t\t\tfullDay: fullDay,\n\t\t\t\t\tfocus: options.focus !== false\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.selector.update({\n\t\t\t\tfrom: from,\n\t\t\t\tto: to,\n\t\t\t\tfullDay: fullDay\n\t\t\t});\n\n\t\t\tif (options.focus !== false)\n\t\t\t{\n\t\t\t\tthis.selector.focus(true, 300);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleSelectorChanges(event)\n\t{\n\t\tif (event instanceof BaseEvent)\n\t\t{\n\t\t\tlet data = event.getData();\n\t\t\tthis.emit('onDateChange', new BaseEvent({data: data}));\n\t\t\tthis.currentFromDate = data.dateFrom;\n\t\t\tthis.currentToDate = data.dateTo;\n\n\t\t\tif (this.currentToDate.getHours() < this.shownScaleTimeFrom\n\t\t\t\t&& !(this.currentToDate.getHours() === 0 && this.currentToDate.getMinutes() === 0))\n\t\t\t{\n\t\t\t\tthis.extendScaleTime(this.currentToDate.getHours(), false);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAllEvents()\n\t{\n\t\tconst events = [];\n\t\tfor (const entryId in this.accessibility)\n\t\t{\n\t\t\tif (!this.accessibility.hasOwnProperty(entryId) || !Type.isArray(this.accessibility[entryId]))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor (const event of this.accessibility[entryId])\n\t\t\t{\n\t\t\t\tevents.push(event)\n\t\t\t}\n\t\t}\n\t\treturn events;\n\t}\n\n\tdoCheckSelectorStatus(event)\n\t{\n\t\tif (event instanceof BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tthis.clearCacheTime();\n\t\t\tconst selectorStatus = this.checkTimePeriod(data.dateFrom, data.dateTo) === true;\n\t\t\tthis.updateSelectorFromStatus(selectorStatus)\n\t\t}\n\t}\n\n\tupdateSelectorFromStatus(status)\n\t{\n\t\tthis.selector.setSelectorStatus(status);\n\t\tif (this.selector.isDragged())\n\t\t{\n\t\t\tthis.hideProposeControl();\n\t\t}\n\t\tif (status)\n\t\t{\n\t\t\tDom.removeClass(this.DOM.mainWrap, 'calendar-planner-selector-warning');\n\t\t\tthis.hideProposeControl();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-selector-warning');\n\t\t\tif (!this.selector.isDragged())\n\t\t\t{\n\t\t\t\tthis.showProposeControl();\n\t\t\t}\n\t\t}\n\t}\n\n\tproposeTime(params = {})\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tlet\n\t\t\tcurTimestamp = Math.round(this.selector.getDateFrom().getTime() / (this.accuracy * 1000)) * this.accuracy * 1000,\n\t\t\tcurDate = new Date(curTimestamp),\n\t\t\tduration = this.selector.getDuration(),\n\t\t\tdata = [], k, i;\n\n\t\tcurDate.setSeconds(0,0);\n\t\tcurTimestamp = curDate.getTime();\n\n\t\tfor (k in this.accessibility)\n\t\t{\n\t\t\tif (this.accessibility.hasOwnProperty(k) && this.accessibility[k] && this.accessibility[k].length > 0)\n\t\t\t{\n\t\t\t\tfor (i = 0; i < this.accessibility[k].length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (this.accessibility[k][i].toTimestampReal >= curTimestamp)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet item = Planner.prepareAccessibilityItem(this.accessibility[k][i]);\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata.push(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdata.sort(function(a, b){return a.fromTimestamp - b.fromTimestamp});\n\n\t\tlet ts = curTimestamp;\n\t\twhile (true)\n\t\t{\n\t\t\tlet dateFrom = new Date(ts);\n\t\t\tlet dateTo = new Date(ts + duration);\n\n\t\t\tif (!this.isOneDayScale())\n\t\t\t{\n\t\t\t\tlet timeFrom = parseInt(dateFrom.getHours() + dateFrom.getMinutes() / 60);\n\t\t\t\tlet timeTo = parseInt(dateTo.getHours() + dateTo.getMinutes() / 60);\n\t\t\t\tif (timeTo === 0)\n\t\t\t\t{\n\t\t\t\t\ttimeTo = 24;\n\t\t\t\t}\n\n\t\t\t\tif (timeFrom <= this.shownScaleTimeFrom)\n\t\t\t\t{\n\t\t\t\t\tdateFrom.setHours(this.shownScaleTimeFrom, 0, 0, 0);\n\t\t\t\t\tts = dateFrom.getTime();\n\t\t\t\t\tdateTo = new Date(ts + duration);\n\t\t\t\t}\n\n\t\t\t\tif (timeTo > this.shownScaleTimeTo)\n\t\t\t\t{\n\t\t\t\t\tdateFrom = new Date(ts + Util.getDayLength() - 1000); // next day\n\t\t\t\t\tdateFrom.setHours(this.shownScaleTimeFrom, 0, 0, 0);\n\t\t\t\t\tts = dateFrom.getTime();\n\t\t\t\t\tdateTo = new Date(ts + duration);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.fullDayMode)\n\t\t\t{\n\t\t\t\tdateFrom.setHours(0, 0, 0, 0);\n\t\t\t\tdateTo.setHours(0, 0, 0, 0);\n\t\t\t}\n\n\t\t\tconst checkRes = this.checkTimePeriod(dateFrom, dateTo, data);\n\n\t\t\tif (checkRes === true)\n\t\t\t{\n\t\t\t\tif (dateTo.getTime() > this.scaleDateTo.getTime())\n\t\t\t\t{\n\t\t\t\t\tif ((dateTo.getTime() - this.scaleDateTo.getTime()) > this.proposeTimeLimit * Util.getDayLength()\n\t\t\t\t\t\t||\n\t\t\t\t\t\tparams.checkedFuture === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tPlanner.showNoResultNotification();\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.checkedFuture !== true)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.scaleDateTo = new Date(this.scaleDateTo.getTime() + Util.getDayLength() * this.proposeTimeLimit);\n\t\t\t\t\t\tthis.expandTimeline(this.scaleDateFrom, this.scaleDateTo);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (this.fullDayMode)\n\t\t\t\t\t\tdateTo = new Date(dateTo.getTime() - Util.getDayLength());\n\n\t\t\t\t\tthis.selector.update({\n\t\t\t\t\t\tfrom: dateFrom,\n\t\t\t\t\t\tto:dateTo,\n\t\t\t\t\t\tupdateScaleType:false,\n\t\t\t\t\t\tupdateScaleLimits:true,\n\t\t\t\t\t\tanimation: true,\n\t\t\t\t\t\tfocus: true\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.emit('onDateChange', new BaseEvent({data: {\n\t\t\t\t\t\tdateFrom: dateFrom,\n\t\t\t\t\t\tdateTo: dateTo,\n\t\t\t\t\t\tfullDay: this.fullDayMode\n\t\t\t\t\t}}));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (checkRes && checkRes.toTimestampReal)\n\t\t\t{\n\t\t\t\tts = checkRes.toTimestampReal;\n\t\t\t\tif (this.fullDayMode)\n\t\t\t\t{\n\t\t\t\t\tlet dt = new Date(ts + Util.getDayLength() - 1000); // next day\n\t\t\t\t\tdt.setHours(0, 0, 0, 0);\n\t\t\t\t\tts = dt.getTime();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckTimePeriod(fromDate, toDate, data)\n\t{\n\t\tif (!this.currentFromDate)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst timelineFrom = new Date();\n\t\ttimelineFrom.setHours(this.shownScaleTimeFrom, 0, 0, 0);\n\t\tif (this.fullDayMode)\n\t\t{\n\t\t\ttimelineFrom.setHours(0, 0, 0, 0);\n\t\t}\n\t\tif (fromDate && fromDate.getTime() < timelineFrom.getTime())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tlet result = true;\n\t\tlet entry;\n\n\t\tif (!Type.isDate(fromDate) || !Type.isDate(toDate))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tlet fromTimestamp = fromDate.getTime();\n\t\tlet toTimestamp = toDate.getTime();\n\t\tconst cacheKey = fromTimestamp + '_' + toTimestamp;\n\t\tconst accuracy = 3 * 60 * 1000; // 3min\n\n\t\tif (Type.isArray(data))\n\t\t{\n\t\t\tfor (let i = 0; i < data.length; i++)\n\t\t\t{\n\t\t\t\tlet item = data[i];\n\t\t\t\tif (item.type && item.type === 'hr')\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif ((item.fromTimestamp + accuracy) <= toTimestamp && ((item.toTimestampReal || item.toTimestamp) - accuracy) >= fromTimestamp)\n\t\t\t\t{\n\t\t\t\t\tresult = item;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (Type.isArray(this.entries))\n\t\t{\n\t\t\tlet\n\t\t\t\tentriesAccessibleIndex = {},\n\t\t\t\tselectorAccuracy = this.selectorAccuracy * 1000,\n\t\t\t\tentryId;\n\n\t\t\tif (this.checkTimeCache[cacheKey] !== undefined)\n\t\t\t{\n\t\t\t\tresult = this.checkTimeCache[cacheKey];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor (entryId in this.accessibility)\n\t\t\t\t{\n\t\t\t\t\tif (this.accessibility.hasOwnProperty(entryId))\n\t\t\t\t\t{\n\t\t\t\t\t\tentry = this.entries.find(function(el){return el.id === entryId.toString();});\n\n\t\t\t\t\t\tif (!entry || this.selectMode && !entry.selected)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tentriesAccessibleIndex[entryId] = true;\n\t\t\t\t\t\tif (Type.isArray(this.accessibility[entryId]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor (let i = 0; i < this.accessibility[entryId].length; i++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlet item = this.accessibility[entryId][i];\n\t\t\t\t\t\t\t\tif (item.type && item.type === 'hr')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif ((item.fromTimestamp + selectorAccuracy) <= toTimestamp && ((item.toTimestampReal || item.toTimestamp) - selectorAccuracy) >= fromTimestamp)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tentriesAccessibleIndex[entryId] = false;\n\t\t\t\t\t\t\t\t\tresult = item;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.checkTimeCache[cacheKey] = result;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tclearCacheTime()\n\t{\n\t\tthis.checkTimeCache = {};\n\t}\n\n\tcheckEntryTimePeriod(entry, fromDate, toDate)\n\t{\n\t\tlet data = [], i;\n\t\tif (entry && entry.id && BX.type.isArray(this.accessibility[entry.id]))\n\t\t{\n\t\t\tfor (i = 0; i < this.accessibility[entry.id].length; i++)\n\t\t\t{\n\t\t\t\tlet item = Planner.prepareAccessibilityItem(this.accessibility[entry.id][i]);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tdata.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.checkTimePeriod(fromDate, toDate, data) === true;\n\t}\n\n\tshowSettingsPopup()\n\t{\n\t\tlet\tsettingsDialogCont = Tag.render`<div class=\"calendar-planner-settings-popup\"></div>`;\n\t\tlet scaleRow = settingsDialogCont.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-planner-settings-row\">\n\t\t\t\t<i>${Loc.getMessage('EC_PL_SETTINGS_SCALE')}:</i>\n\t\t\t</div>\n\t\t`);\n\t\tlet scaleWrap = scaleRow.appendChild(Tag.render`\n\t\t\t<span class=\"calendar-planner-option-container\"></span>\n\t\t`);\n\n\n\t\tif (this.fullDayMode)\n\t\t{\n\t\t\tscaleRow.title = Loc.getMessage('EC_PL_SETTINGS_SCALE_READONLY_TITLE');\n\t\t\tDom.addClass(scaleRow, 'calendar-planner-option-container-disabled');\n\t\t}\n\n\t\tthis.scaleTypes.forEach((scale)=>{\n\t\t\tscaleWrap.appendChild(Tag.render`<span class=\"calendar-planner-option-tab ${(scale === this.scaleType ? ' calendar-planner-option-tab-active' : '')}\" data-bx-planner-scale=\"${scale}\">${Loc.getMessage('EC_PL_SETTINGS_SCALE_' + scale.toUpperCase())}</span>`);\n\t\t});\n\n\n\t\t// Create and show settings popup\n\t\tlet popup = PopupWindowManager.create(\n\t\t\tthis.id + \"-settings-popup\",\n\t\t\tthis.DOM.settingsButton,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: -1,\n\t\t\t\toffsetLeft: 7,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: settingsDialogCont,\n\t\t\t\tzIndex: 4000,\n\t\t\t\tangle: {postion: 'top'},\n\t\t\t\tcacheable: false\n\t\t\t});\n\t\tpopup.show(true);\n\n\t\tEvent.bind(scaleWrap, 'click', (e) => {\n\t\t\tif (!this.fullDayMode)\n\t\t\t{\n\t\t\t\tlet\n\t\t\t\t\tnodeTarget = e.target || e.srcElement,\n\t\t\t\t\tscale = nodeTarget && nodeTarget.getAttribute && nodeTarget.getAttribute('data-bx-planner-scale');\n\n\t\t\t\tif (scale)\n\t\t\t\t{\n\t\t\t\t\tthis.changeScaleType(scale);\n\t\t\t\t\tpopup.close();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tchangeScaleType(scaleType)\n\t{\n\t\tif (scaleType !== this.scaleType)\n\t\t{\n\t\t\tthis.setScaleType(scaleType);\n\t\t\tthis.rebuild();\n\t\t}\n\t}\n\n\tsetFullDayMode(fullDayMode)\n\t{\n\t\tif (fullDayMode !== this.fullDayMode)\n\t\t{\n\t\t\tthis.fullDayMode = fullDayMode;\n\t\t\tif (fullDayMode && !this.isOneDayScale())\n\t\t\t{\n\t\t\t\tthis.savedScaleType = this.scaleType;\n\t\t\t\tthis.changeScaleType('1day');\n\t\t\t}\n\t\t\telse if (!fullDayMode && this.isOneDayScale() && this.savedScaleType)\n\t\t\t{\n\t\t\t\tthis.changeScaleType(this.savedScaleType);\n\t\t\t\tthis.savedScaleType = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic showNoResultNotification()\n\t{\n\t\talert(Loc.getMessage('EC_PL_PROPOSE_NO_RESULT'));\n\t}\n\n\tshowProposeControl()\n\t{\n\t\tif (!this.DOM.proposeTimeButton)\n\t\t{\n\t\t\tthis.DOM.proposeTimeButton = this.DOM.mainWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-planner-time-arrow-right\">\n\t\t\t\t\t<span class=\"calendar-planner-time-arrow-right-text\">\n\t\t\t\t\t\t${Loc.getMessage('EC_PL_PROPOSE')}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"calendar-planner-time-arrow-right-item\"></span>\n\t\t\t\t</div>\n\t\t\t`);\n\t\t\tEvent.bind(this.DOM.proposeTimeButton, 'click', this.proposeTime.bind(this));\n\n\t\t\tif (this.isLocked())\n\t\t\t{\n\t\t\t\tDom.addClass(this.DOM.proposeTimeButton, '--lock');\n\t\t\t}\n\t\t}\n\t\tthis.DOM.proposeTimeButton.style.display = \"block\";\n\t\tthis.DOM.proposeTimeButton.style.top = (this.DOM.timelineDataWrap.offsetTop + this.DOM.timelineDataWrap.offsetHeight / 2 - 16) + \"px\";\n\t}\n\n\thideProposeControl()\n\t{\n\t\tif (this.DOM.proposeTimeButton)\n\t\t{\n\t\t\tthis.DOM.proposeTimeButton.style.display = \"none\";\n\t\t}\n\t}\n\n\tmouseMoveHandler(e)\n\t{\n\t\tlet\n\t\t\ti, nodes,\n\t\t\tentryUid, parentTarget,\n\t\t\tprevEntry,\n\t\t\tmainContWrap = this.DOM.mainWrap,\n\t\t\ttarget = e.target || e.srcElement;\n\n\t\tentryUid = target.getAttribute('data-bx-planner-entry');\n\t\tif (!entryUid)\n\t\t{\n\t\t\tparentTarget = BX.findParent(target,\n\t\t\t\tfunction(node)\n\t\t\t\t{\n\t\t\t\t\tif (node == mainContWrap ||\n\t\t\t\t\t\tnode.getAttribute && node.getAttribute('data-bx-planner-entry')\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmainContWrap\n\t\t\t);\n\n\t\t\tif (parentTarget)\n\t\t\t{\n\t\t\t\tentryUid = target.getAttribute('data-bx-planner-entry')\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.hoverRow, 'show');\n\t\t\t\tnodes = this.selector.controlWrap.querySelectorAll('.calendar-planner-selector-control-row.hover');\n\t\t\t\tfor (i = 0; i < nodes.length; i++)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(nodes[i], 'hover');\n\t\t\t\t}\n\t\t\t\tprevEntry = this.getEntryByUniqueId(this.howerEntryId);\n\t\t\t\tif (prevEntry && prevEntry.selectWrap)\n\t\t\t\t{\n\t\t\t\t\tprevEntry.selectWrap.style.opacity = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (entryUid)\n\t\t{\n\t\t\tif (this.howerEntryId !== entryUid)\n\t\t\t{\n\t\t\t\tthis.howerEntryId = entryUid;\n\t\t\t\tlet entry = this.getEntryByUniqueId(entryUid);\n\t\t\t\tif (entry)\n\t\t\t\t{\n\t\t\t\t\tlet top = parseInt(entry.dataRowWrap.offsetTop);\n\t\t\t\t\tDom.addClass(this.hoverRow, 'show');\n\t\t\t\t\tthis.hoverRow.style.top = (top + 36) + 'px';\n\t\t\t\t\tthis.hoverRow.style.width = (parseInt(this.DOM.mainWrap.offsetWidth) + 5) + 'px';\n\n\t\t\t\t\tif (entry.selectorControlWrap)\n\t\t\t\t\t{\n\t\t\t\t\t\tnodes = this.selector.controlWrap.querySelectorAll('.calendar-planner-selector-control-row.hover');\n\t\t\t\t\t\tfor (i = 0; i < nodes.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.removeClass(nodes[i], 'hover');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tDom.addClass(entry.selectorControlWrap, 'hover');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tshowLoader()\n\t{\n\t\tthis.hideLoader();\n\t\tthis.DOM.loader = this.DOM.mainWrap.appendChild(Util.getLoader(50));\n\t\tDom.addClass(this.DOM.loader, 'calendar-planner-main-loader');\n\t\tthis.loaderShown = true;\n\t}\n\n\thideLoader()\n\t{\n\t\tif(Type.isDomNode(this.DOM.loader))\n\t\t{\n\t\t\tDom.remove(this.DOM.loader);\n\t\t}\n\t\tthis.loaderShown = false;\n\t}\n\n\tisLoaderShown()\n\t{\n\t\treturn this.loaderShown;\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.shown;\n\t}\n\n\tisBuilt()\n\t{\n\t\treturn this.built;\n\t}\n\n\tisLocked()\n\t{\n\t\treturn this.locked;\n\t}\n\n\tlock()\n\t{\n\t\tif (!this.DOM.lockScreen)\n\t\t{\n\t\t\tthis.DOM.lockScreen = Tag.render`\n\t\t\t\t<div class=\"calendar-planner-timeline-locker\">\n\t\t\t\t\t<div class=\"calendar-planner-timeline-locker-container\">\n\t\t\t\t\t\t<div class=\"calendar-planner-timeline-locker-top\">\n\t\t\t\t\t\t\t<div class=\"calendar-planner-timeline-locker-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"calendar-planner-timeline-text\">${Loc.getMessage('EC_PL_LOCKED_TITLE')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-planner-timeline-locker-button\">\n\t\t\t\t\t\t\t<a href=\"javascript:void(0)\" onclick=\"top.BX.UI.InfoHelper.show('limit_crm_calender_planner');\" class=\"ui-btn ui-btn-sm ui-btn-light-border ui-btn-round\">${Loc.getMessage('EC_PL_UNLOCK_FEATURE')}</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tDom.addClass(this.DOM.timelineFixedWrap, '--lock');\n\t\tthis.DOM.timelineFixedWrap.appendChild(this.DOM.lockScreen);\n\t}\n\n\tdoSegmentsIntersect(x1, x2, y1, y2)\n\t{\n\t\treturn (x1 >= y1 && x1 <= y2)\n\t\t\t|| (x2 >= y1 && x2 <= y2)\n\t\t\t|| (x1 <= y1 && x2 >= y2);\n\t}\n}\n"],"names":["Selector","EventEmitter","constructor","params","DOM","selectMode","currentDateFrom","Date","currentDateTo","currentFullDay","useAnimation","magnetDuration","stickDistanceInMinutes","magnetizeDistanceInMinutes","setEventNamespace","getPosByDate","getDateByPos","getPosDateMap","getTimelineWidth","getScaleInfo","solidStatus","eventDragAndDrop","EventDragAndDrop","getEvents","timelineWrap","timelineFixedWrap","render","wrap","Tag","ondrag","BX","False","ondragstart","titleNode","result","controlWrap","appendChild","getWrap","getTitleNode","update","Type","isPlainObject","updateScaleType","updateScaleLimits","animation","from","isDate","parseDate","to","fullDayMode","fullDay","undefined","setHours","dayCount","Math","ceil","getTime","show","focus","isSelectorInThePast","scaleDateFrom","isSelectorInTheFuture","scaleDateTo","style","display","alignCenter","fromPos","toPos","width","left","transit","toX","triggerChangeEvents","checkStatus","hide","startMove","document","addEventListener","preventDefault","passive","selectorIsDraged","selectorStartLeft","parseInt","selectorStartScrollLeft","scrollLeft","onDragStart","Dom","addClass","body","move","x","pos","checkPosition","boundary","getDragBoundary","getAutoScrollBoundary","getConstrainedBoundary","setBoundary","boundaryLeft","position","containerLeft","boundaryRight","size","containerRight","offsetWidth","scrollSpeed","getSpeed","setAutoScrollInterval","stopAutoScroll","x1","x2","floor","sqrt","abs","direction","scrollInterval","setInterval","setFinalTimeInterval","clearInterval","wasMagnetized","transition","showTitle","duration","getHours","shownTimeFrom","shownTimeTo","getMinutes","endMove","removeEventListener","getFinalFrom","right","getFinalTo","finalBoundary","hideTitle","setValue","startResize","selectorIsResized","selectorStartWidth","resize","toDate","timeTo","rightPos","min","round","Util","getDayLength","fromDate","getDate","selectorRoundedRightPos","roundedPos","roundPos","endResize","e","isDragged","selectorPos","removeClass","mainContWrap","selectorWidth","lastFromDate","lastToDate","emit","BaseEvent","data","dateFrom","dateTo","setSelectorStatus","status","selectorIsFree","max","scaleInfo","timeFrom","scaleTimeFrom","scaleTimeTo","getDay","leftDate","rightDate","fromX","stop","easing","start","finish","makeEaseOut","transitions","quart","step","state","complete","checkedPos","setTimeout","animate","selectorTitle","selector","innerHTML","date","format","removeAttribute","formatTime","lastTouchedEntry","entriesListWidth","compactMode","selectorTitleLeft","selectorTitleTop","timelineDataCont","offsetTop","top","selectorHideTimeout","clearTimeout","opacity","quad","timeoutName","selectorIndex","timeout","parseFloat","focusTimeout","screenDelta","selectorLeft","viewWidth","viewLeft","viewRight","newScrollLeft","getDuration","getDateFrom","getDateTo","Planner","config","entryStatusMap","h","y","q","n","scaleTypes","savedScaleType","SCALE_OFFSET_BEFORE","SCALE_OFFSET_AFTER","EXPAND_OFFSET","EXPAND_DELAY","REBUILD_DELAY","maxTimelineSize","MIN_ENTRY_ROWS","MAX_ENTRY_ROWS","height","minWidth","minHeight","workTime","scrollStep","shown","built","locked","shownScaleTimeFrom","shownScaleTimeTo","timelineCellWidthOrig","proposeTimeLimit","expandTimelineDelay","limitScaleSizeMode","checkTimeCache","entriesIndex","Map","id","dayOfWeekMonthFormat","userId","Loc","getMessage","SCALE_TIME_FORMAT","isAmPmMode","expandTimelineDebounce","Runtime","debounce","expandTimeline","setConfig","currentFromDate","currentToDate","hourFrom","hourTo","extendScaleTimeLimits","updateScaleLimitsFromEntry","hideAnimation","isBuilt","build","bindEventHandlers","resizePlannerWidth","buildTimeline","adjustWidth","timelineInnerWrap","readonly","mainWrap","entriesOuterWrap","adjustHeight","todayLocMessage","setScaleType","scaleType","showTimelineDayTitle","compactHeight","isOneDayScale","selectEntriesMode","isInteger","minEntryRows","maxEntryRows","isArray","extendScaleTime","weekHolidays","yearHolidays","accuracy","clickSelectorScaleAccuracy","selectorAccuracy","timelineCellWidth","showEntiesHeader","showEntryName","allowAdjustCellWidth","adjustCellWidth","setScaleLimits","type","isString","fromTime","toTime","isNaN","SetLoadedDataLimits","loadedDataFrom","loadedDataTo","savedTimeFrom","savedTimeTo","extendTimelineToRight","extendTimelineToLeft","rebuildDebounce","scaleSize","isDomNode","TypeError","create","props","className","preventSelection","entrieListHeader","entriesListTitleCounter","entrieListWrap","isLocked","lock","timelineVerticalConstraint","timelineScaleWrap","timelineDataWrap","accessibilityWrap","updateTodayButtonVisibility","bind","getAllEvents","posDateMap","scale","subscribe","handleSelectorChanges","doCheckSelectorStatus","selectedEntriesWrap","hoverRow","Event","mouseMoveHandler","settingsButton","showSettingsPopup","clearCache","lastTimelineKey","getTimelineShownKey","clean","scaleData","getScaleData","outerDayCont","dayTitle","cont","futureDayTitles","todayButtonPivotDay","i","length","scaleDayTitles","daystamp","timestamp","today","dayTitleClass","push","querySelector","todayTitleButton","firstElementChild","todayButtonClickHandler","dayStart","title","cell","html","mapDatePosRes","mapDatePos","timelineOffset","checkRebuildTimeout","buildTodayButtonWrap","todayButton","remove","todayRightButton","todayButtonContainer","todayButtonWidth","todayButtonRightWidth","todayButtonLeftWidth","offsetLeft","_checkRebuildTimeoutCount","rebuildTimeout","isElementNode","isShown","rebuild","extendedTimeFrom","extendedTimeTo","extendTimeline","isToRight","isToLeft","dayNodeList","querySelectorAll","nodeCountInDay","extendCount","cellsInsertedOnLeftCount","insertedNodes","pivotScaleDatumOfDayIndex","dayNode","pivotNodeOfDay","children","toTimestamp","fromTimestamp","insertedTimestamp","animationClass","insertedCell","insertBefore","insertedScaleDatum","value","splice","classList","add","scroll","midnight","setDate","visibleEvents","getVisibleEvents","animatedEvents","getEventsAfter","entries","accessibility","linear","event","node","updateTimelineAfterExtend","clearCacheTime","updateSelector","selectorParams","ts","scaleFrom","scaleTo","time","dayStamp","curDayStamp","prepareAccessibilityItem","entry","setSeconds","toReal","toTimestampReal","addAccessibilityItem","hidden","name","displayEntryRow","rowWrap","showMoreUsersLink","showMoreUsers","attrs","uid","emailUser","toUpperCase","getEntryAvatarNode","text","Text","encode","entriesResourceListWrap","isNodeInDom","dataRowWrap","selectorControlWrap","selected","selectEntryRow","entriesDataRowMap","set","forEach","item","imageNode","img","avatar","encodeURI","selectWrap","isParentForNode","isEntrySelected","deSelectEntryRow","getEntryUniqueId","includes","getEntryByUniqueId","entryUniqueId","find","handleClick","handleMousedown","handleMousemove","handleMouseup","mouseWheelTimelineHandler","window","isRightClick","which","target","clickMousePos","getMousePos","nodeTarget","srcElement","accuracyMouse","hasClass","getAttribute","onCustomEvent","plannerId","timeline","findTarget","mouseDownMousePos","selectedDateFrom","selectorTimeLength","selectedDateTo","mouseDown","startMousePos","startScrollTimeline","timelineIsDraged","endScrollTimeline","checkTimelineScroll","mousePos","scrollTimeline","Browser","isMac","delta","deltaY","detail","wheelDelta","PreventDefault","parent","parentElement","doDisplayTodayButton","setFutureDayTitlesOffset","doAddLeftArrow","isTodayInFuture","doDisplayTodayRightButton","doAddRightArrow","reload","minScroll","maxScroll","scrollWidth","expandTimelineDirection","isLoaderShown","showLoader","timelineStartScrollLeft","nodeMetaType","parentCont","findParent","pageX","pageY","clientX","clientY","documentElement","clientLeft","scrollTop","clientTop","getScaleSize","hour","map","datePosMap","j","tsi","xi","tsj","xj","cellWidth","substeps","posAccuracy","borderStart","borderEnd","borderTimestamp","borderX","curInd","deltaTs","end","newHeight","offsetHeight","currentHeight","resizePlannerHeight","resizeAnimation","timelineDataContHeight","proposeTimeButton","loadedTimelineSize","prevScaleDateFrom","prevScaleDateTo","oldDateTo","reloadData","hideLoader","currentPlannerWidth","widthDiff","timelineFromPosition","timelineToPosition","index","eventFromPosition","eventToPosition","doSegmentsIntersect","events","eventsAfter","sort","a","b","cutData","cutDataTitle","usersCount","cutAmount","dispDataCount","ind","accData","join","checkTimePeriod","updateSelectorFromStatus","extendPlannerWatches","updateAccessibility","key","hasOwnProperty","get","options","setFullDayMode","formatDate","getData","entryId","selectorStatus","hideProposeControl","showProposeControl","proposeTime","curTimestamp","curDate","k","checkRes","checkedFuture","showNoResultNotification","dt","timelineFrom","cacheKey","el","toString","entriesAccessibleIndex","checkEntryTimePeriod","settingsDialogCont","scaleRow","scaleWrap","popup","PopupWindowManager","autoHide","closeByEsc","lightShadow","content","zIndex","angle","postion","cacheable","changeScaleType","close","alert","nodes","entryUid","parentTarget","prevEntry","howerEntryId","loader","getLoader","loaderShown","lockScreen","y1","y2"],"mappings":"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"}