{"version":3,"file":"planner.bundle.js","sources":["../src/selector.js","../src/planner.js"],"sourcesContent":["\"use strict\";\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Util} from 'calendar.util';\nimport {Type, Dom, Tag} from 'main.core';\n\nexport class Selector extends EventEmitter\n{\n\tDOM = {};\n\tselectMode = false;\n\tcurrentDateFrom = new Date();\n\tcurrentDateTo = new Date();\n\tcurrentFullDay = false;\n\tuseAnimation = true;\n\n\tconstructor(params = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.Planner.Selector');\n\n\t\tthis.selectMode = params.selectMode;\n\t\tthis.getPosByDate = params.getPosByDate;\n\t\tthis.getDateByPos = params.getDateByPos;\n\t\tthis.getPosDateMap = params.getPosDateMap;\n\t\tthis.getTimelineWidth = params.getTimelineWidth;\n\t\tthis.getScaleInfo = params.getScaleInfo;\n\t\tthis.solidStatus = params.solidStatus;\n\n\t\tthis.useAnimation = params.useAnimation !== false;\n\t\tthis.DOM.timelineWrap = params.timelineWrap;\n\n\t\tthis.render();\n\t}\n\n\trender()\n\t{\n\t\tthis.DOM.wrap = Tag.render`\n\t\t\t<div class=\"calendar-planner-timeline-selector\" data-bx-planner-meta=\"selector\">\n\t\t\t\t<span data-bx-planner-meta=\"selector-resize-left\" class=\"calendar-planner-timeline-drag-left\"></span>\n\t\t\t\t<span class=\"calendar-planner-timeline-selector-grip\"></span>\n\t\t\t\t<span data-bx-planner-meta=\"selector-resize-right\" class=\"calendar-planner-timeline-drag-right\"></span>\n\t\t\t</div>`;\n\n\t\t// prefent draging selector and activating uploader controll in livefeed\n\t\tthis.DOM.wrap.ondrag = BX.False;\n\t\tthis.DOM.wrap.ondragstart = BX.False;\n\n\t\tthis.DOM.titleNode = Tag.render`<div class=\"calendar-planner-selector-notice\" style=\"display: none\"></div>`;\n\n\t\tif (this.selectMode)\n\t\t{\n\t\t\tresult.controlWrap = this.DOM.wrap.appendChild(Tag.render`<div class=\"calendar-planner-selector-control\"></div>`);\n\t\t}\n\t}\n\n\tgetWrap()\n\t{\n\t\treturn this.DOM.wrap;\n\t}\n\n\tgetTitleNode()\n\t{\n\t\treturn this.DOM.titleNode;\n\t}\n\n\t/**\n\t *\n\t *\n\t * @params array array of parameters\n\t * @params[from]\n\t * @params[to]\n\t * @params[updateScaleType] bool\n\t * @params[updateScaleLimits] bool\n\t *\n\t * @return null\n\t */\n\tupdate(params = {})\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t\tparams = {};\n\n\t\tparams.updateScaleType = !!params.updateScaleType;\n\t\tparams.updateScaleLimits = !!params.updateScaleLimits;\n\t\tparams.animation = !!params.animation;\n\n\t\tlet\n\t\t\trebuildTimeline = false,\n\t\t\tfrom = Type.isDate(params.from) ? params.from : BX.parseDate(params.from) || this.currentDateFrom,\n\t\t\tto = Type.isDate(params.to) ? params.to : BX.parseDate(params.to) || this.currentDateTo,\n\t\t\tfullDay = params.fullDay !== undefined ? params.fullDay : this.currentFullDay;\n\n\t\tif (Type.isDate(from) && Type.isDate(to))\n\t\t{\n\t\t\tthis.currentDateFrom = from;\n\t\t\tthis.currentDateTo = to;\n\t\t\tthis.currentFullDay = fullDay;\n\n\t\t\t//this.SetFullDayMode(fullDay);\n\t\t\tif (fullDay)\n\t\t\t{\n\t\t\t\tto = new Date(to.getTime() + Util.getDayLength());\n\t\t\t\tfrom.setHours(0, 0, 0,0);\n\t\t\t\tto.setHours(0, 0, 0,0);\n\n\t\t\t\t// if (this.scaleType !== '1day')\n\t\t\t\t// {\n\t\t\t\t// \tthis.setScaleType('1day');\n\t\t\t\t// \trebuildTimeline = true;\n\t\t\t\t// }\n\t\t\t}\n\n\t\t\t// Update limits of scale\n\t\t\t// if (params.updateScaleLimits && this.scaleType !== '1day')\n\t\t\t// {\n\t\t\t// \tlet timeFrom = parseInt(from.getHours()) + Math.floor(from.getMinutes() / 60);\n\t\t\t// \tlet timeTo = parseInt(to.getHours()) + Math.ceil(to.getMinutes() / 60);\n\t\t\t//\n\t\t\t// \tif (Util.formatDate(from) !== Util.formatDate(to))\n\t\t\t// \t{\n\t\t\t// \t\tthis.extendScaleTime(0, 24);\n\t\t\t// \t\trebuildTimeline = true;\n\t\t\t// \t}\n\t\t\t// \telse\n\t\t\t// \t{\n\t\t\t// \t\tif (timeFrom < this.shownScaleTimeFrom)\n\t\t\t// \t\t{\n\t\t\t// \t\t\tthis.extendScaleTime(timeFrom, false);\n\t\t\t// \t\t\trebuildTimeline = true;\n\t\t\t// \t\t}\n\t\t\t//\n\t\t\t// \t\tif (timeTo > this.shownScaleTimeTo)\n\t\t\t// \t\t{\n\t\t\t// \t\t\tthis.extendScaleTime(false, timeTo);\n\t\t\t// \t\t\trebuildTimeline = true;\n\t\t\t// \t\t}\n\t\t\t//\n\t\t\t// \t\tif (rebuildTimeline)\n\t\t\t// \t\t{\n\t\t\t// \t\t\tthis.adjustCellWidth();\n\t\t\t// \t\t}\n\t\t\t// \t}\n\t\t\t// }\n\n\t\t\t//if (params.RRULE)\n\t\t\t//{\n\t\t\t//\tthis.HandleRecursion(params);\n\t\t\t//}\n\n\t\t\t// if (rebuildTimeline)\n\t\t\t// {\n\t\t\t// \tthis.RebuildPlanner({updateSelector: false});\n\t\t\t// }\n\n\t\t\t// Update selector\n\t\t\tthis.show(from, to, {animation: params.animation, focus: params.focus});\n\t\t}\n\t}\n\n\tshow(from, to, params)\n\t{\n\t\tlet\n\t\t\tanimation = params.animation && this.useAnimation !== false,\n\t\t\tfocus = params.focus,\n\t\t\talignCenter = params.alignCenter !== false;\n\n\t\tthis.DOM.wrap.style.display = 'block';\n\n\t\tif (Type.isDate(from) && Type.isDate(to))\n\t\t{\n\t\t\tlet\n\t\t\t\tfromPos = this.getPosByDate(from),\n\t\t\t\ttoPos = this.getPosByDate(to);\n\n\t\t\tthis.DOM.wrap.style.width = (toPos - fromPos) + 'px';\n\n\t\t\tif (animation && this.DOM.wrap.style.left && !this.currentFullDay)\n\t\t\t{\n\t\t\t\tthis.transit({\n\t\t\t\t\ttoX: fromPos,\n\t\t\t\t\ttriggerChangeEvents: false,\n\t\t\t\t\tfocus: focus === true\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.wrap.style.left = fromPos + 'px';\n\t\t\t\tthis.DOM.wrap.style.width = (toPos - fromPos) + 'px';\n\t\t\t\tthis.focus(false, 200, alignCenter);\n\t\t\t\tthis.checkStatus(fromPos);\n\t\t\t}\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tthis.DOM.wrap.style.display = 'none';\n\t}\n\n\tstartMove()\n\t{\n\t\tthis.selectorIsDraged = true;\n\t\tthis.selectorRoundedPos = false;\n\t\tthis.selectorStartLeft = parseInt(this.DOM.wrap.style.left);\n\t\tthis.selectorStartScrollLeft = this.DOM.timelineWrap.scrollLeft;\n\n\t\tDom.addClass(document.body, 'calendar-planner-unselectable');\n\t}\n\n\tmove(x)\n\t{\n\t\tif (this.selectorIsDraged)\n\t\t{\n\t\t\tlet selectorWidth = parseInt(this.DOM.wrap.style.width), pos = this.selectorStartLeft + x;\n\n\t\t\t// Correct cursor position acording to changes of scrollleft\n\t\t\tpos -= this.selectorStartScrollLeft - this.DOM.timelineWrap.scrollLeft;\n\n\t\t\tif (this.getPosDateMap()[pos])\n\t\t\t{\n\t\t\t\tthis.selectorRoundedPos = pos;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet roundedPos = Selector.roundPos(pos);\n\t\t\t\tif (this.getPosDateMap()[roundedPos])\n\t\t\t\t{\n\t\t\t\t\tthis.selectorRoundedPos = roundedPos;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet checkedPos = this.checkPosition(this.selectorRoundedPos);\n\t\t\tif (checkedPos !== this.selectorRoundedPos)\n\t\t\t{\n\t\t\t\tthis.selectorRoundedPos = checkedPos;\n\t\t\t\tpos = checkedPos;\n\t\t\t}\n\n\t\t\tthis.DOM.wrap.style.left = pos + 'px';\n\t\t\tthis.showTitle({fromPos: pos, toPos: this.selectorRoundedPos + selectorWidth});\n\n\t\t\tthis.checkStatus(this.selectorRoundedPos, true);\n\t\t}\n\t}\n\n\tendMove()\n\t{\n\t\tif (this.selectorIsDraged && this.selectorRoundedPos)\n\t\t{\n\t\t\tthis.DOM.wrap.style.left = this.selectorRoundedPos + 'px';\n\t\t\tthis.selectorRoundedPos = false;\n\t\t\tthis.hideTitle();\n\t\t\tthis.setValue(this.selectorRoundedPos);\n\t\t}\n\t\tthis.selectorIsDraged = false;\n\t}\n\n\tstartResize()\n\t{\n\t\tthis.selectorIsResized = true;\n\t\tthis.selectorRoundedPos = false;\n\n\t\tthis.selectorStartLeft = parseInt(this.DOM.wrap.style.left);\n\t\tthis.selectorStartWidth = parseInt(this.DOM.wrap.style.width);\n\t\tthis.selectorStartScrollLeft = this.DOM.timelineWrap.scrollLeft;\n\t}\n\n\tresize(x)\n\t{\n\t\tif (this.selectorIsResized)\n\t\t{\n\t\t\tlet\n\t\t\t\ttoDate,\n\t\t\t\ttimeTo,\n\t\t\t\twidth = this.selectorStartWidth + x;\n\n\t\t\t// Correct cursor position according to changes of scrollLeft\n\t\t\twidth -= this.selectorStartScrollLeft - this.DOM.timelineWrap.scrollLeft;\n\t\t\tlet rightPos = Math.min(this.selectorStartLeft + width, this.getTimelineWidth());\n\n\t\t\ttoDate = this.getDateByPos(rightPos, true);\n\n\t\t\tif (this.fullDayMode)\n\t\t\t{\n\t\t\t\ttimeTo = parseInt(toDate.getHours()) + Math.round((toDate.getMinutes() / 60) * 10) / 10;\n\t\t\t\ttoDate.setHours(0, 0, 0, 0);\n\t\t\t\tif (timeTo > 12)\n\t\t\t\t{\n\t\t\t\t\ttoDate = new Date(toDate.getTime() + Util.getDayLength());\n\t\t\t\t\ttoDate.setHours(0, 0, 0, 0);\n\t\t\t\t}\n\t\t\t\trightPos = this.getPosByDate(toDate);\n\t\t\t\twidth = rightPos - this.selectorStartLeft;\n\n\t\t\t\tif (width <= 10)\n\t\t\t\t{\n\t\t\t\t\ttoDate = this.getDateByPos(this.selectorStartLeft);\n\t\t\t\t\ttoDate = new Date(toDate.getTime() + Util.getDayLength());\n\t\t\t\t\ttoDate.setHours(0, 0, 0, 0);\n\t\t\t\t\twidth = this.getPosByDate(toDate) - this.selectorStartLeft;\n\t\t\t\t\trightPos = this.selectorStartLeft + width;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.shownScaleTimeFrom !== 0 || this.shownScaleTimeTo !== 24)\n\t\t\t{\n\t\t\t\tlet fromDate = this.getDateByPos(this.selectorStartLeft);\n\t\t\t\tif (toDate && fromDate && Util.formatDate(fromDate) !== Util.formatDate(toDate))\n\t\t\t\t{\n\t\t\t\t\ttoDate = new Date(fromDate.getTime());\n\t\t\t\t\ttoDate.setHours(this.shownScaleTimeTo, 0, 0, 0);\n\t\t\t\t\trightPos = this.getPosByDate(toDate);\n\t\t\t\t\twidth = rightPos - this.selectorStartLeft;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.getPosDateMap()[rightPos])\n\t\t\t{\n\t\t\t\tthis.selectorRoundedRightPos = rightPos;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet roundedPos = Selector.roundPos(rightPos);\n\t\t\t\tif (this.getPosDateMap()[roundedPos])\n\t\t\t\t{\n\t\t\t\t\tthis.selectorRoundedRightPos = roundedPos;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.DOM.wrap.style.width = width + 'px';\n\t\t\tthis.showTitle({fromPos: this.selectorStartLeft, toPos: this.selectorRoundedRightPos});\n\t\t\tthis.checkStatus(this.selectorStartLeft, true);\n\t\t}\n\t}\n\n\tendResize()\n\t{\n\t\tif (this.selectorIsResized && this.selectorRoundedRightPos)\n\t\t{\n\t\t\tthis.DOM.wrap.style.width = (this.selectorRoundedPos - parseInt(this.DOM.wrap.style.left)) + 'px';\n\t\t\tthis.selectorRoundedRightPos = false;\n\t\t\tthis.hideTitle();\n\t\t\tthis.setValue();\n\t\t}\n\t\tthis.selectorIsResized = false;\n\t}\n\n\tisDragged()\n\t{\n\t\treturn this.selectorIsResized || this.selectorIsDraged;\n\t}\n\n\tcheckStatus(selectorPos, checkPosition)\n\t{\n\t\tif (this.solidStatus)\n\t\t{\n\t\t\tDom.removeClass(this.DOM.wrap, 'calendar-planner-timeline-selector-warning');\n\t\t\tDom.removeClass(this.mainContWrap, 'calendar-planner-selector-warning');\n\t\t\tDom.addClass(this.DOM.wrap, 'solid');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!selectorPos)\n\t\t\t{\n\t\t\t\tselectorPos = Selector.roundPos(this.DOM.wrap.style.left);\n\t\t\t}\n\n\t\t\tlet fromDate, toDate;\n\t\t\tif (checkPosition === true || !this.currentDateFrom)\n\t\t\t{\n\t\t\t\tlet\n\t\t\t\t\tselectorWidth = parseInt(this.DOM.wrap.style.width),\n\t\t\t\t\tfromPos = selectorPos,\n\t\t\t\t\ttoPos = fromPos + selectorWidth;\n\n\t\t\t\tif (!fromPos && !toPos && !selectorWidth && this.lastFromDate)\n\t\t\t\t{\n\t\t\t\t\tfromDate = this.lastFromDate;\n\t\t\t\t\ttoDate = this.lastToDate;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfromDate = this.getDateByPos(fromPos);\n\t\t\t\t\ttoDate = this.getDateByPos(toPos, true);\n\t\t\t\t\tthis.lastFromDate = fromDate;\n\t\t\t\t\tthis.lastToDate = toDate;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfromDate = this.currentDateFrom;\n\t\t\t\ttoDate = this.currentDateTo;\n\t\t\t}\n\n\t\t\tthis.emit('doCheckStatus', new BaseEvent({data: {dateFrom: fromDate,dateTo: toDate}}));\n\t\t}\n\t}\n\n\tsetSelectorStatus(status)\n\t{\n\t\tthis.selectorIsFree = status;\n\t\tif (this.selectorIsFree)\n\t\t{\n\t\t\tDom.removeClass(this.DOM.wrap, 'calendar-planner-timeline-selector-warning');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.DOM.wrap, 'calendar-planner-timeline-selector-warning');\n\t\t}\n\t}\n\n\tsetValue(selectorPos, selectorWidth)\n\t{\n\t\tif (!selectorPos)\n\t\t{\n\t\t\tselectorPos = parseInt(this.DOM.wrap.style.left);\n\t\t}\n\t\tselectorPos = Math.max(0, selectorPos);\n\n\t\tif (!selectorWidth)\n\t\t{\n\t\t\tselectorWidth = parseInt(this.DOM.wrap.style.width);\n\t\t}\n\n\t\tif (selectorPos + selectorWidth > parseInt(this.getTimelineWidth()))\n\t\t{\n\t\t\tselectorPos = parseInt(this.getTimelineWidth()) - selectorWidth;\n\t\t}\n\n\t\tlet\n\t\t\tdateFrom = this.getDateByPos(selectorPos),\n\t\t\tdateTo = this.getDateByPos(selectorPos + selectorWidth, true);\n\n\t\tif (dateFrom && dateTo)\n\t\t{\n\t\t\tthis.currentDateFrom = dateFrom;\n\t\t\tthis.currentDateTo = dateTo;\n\n\t\t\tif (this.fullDayMode)\n\t\t\t{\n\t\t\t\tdateTo = new Date(dateTo.getTime() - Util.getDayLength());\n\t\t\t}\n\n\t\t\tthis.currentFullDay = this.fullDayMode;\n\n\t\t\tthis.emit('onChange', new BaseEvent({data: {\n\t\t\t\tdateFrom: dateFrom,\n\t\t\t\tdateTo: dateTo,\n\t\t\t\tfullDay: this.fullDayMode\n\t\t\t}}));\n\t\t}\n\t}\n\n\tcheckPosition(fromPos, selectorWidth, toPos)\n\t{\n\t\tlet scaleInfo = this.getScaleInfo();\n\t\tif (scaleInfo.shownTimeFrom !== 0 || scaleInfo.shownTimeTo !== 24\n\t\t&& (scaleInfo.type !== '1day' || this.fullDayMode))\n\t\t{\n\t\t\tif (!fromPos)\n\t\t\t\tfromPos = parseInt(this.DOM.wrap.style.left);\n\n\t\t\tif (!selectorWidth)\n\t\t\t\tselectorWidth = parseInt(this.DOM.wrap.style.width);\n\n\t\t\tif (!toPos)\n\t\t\t\ttoPos = fromPos + selectorWidth;\n\n\t\t\tif (toPos > parseInt(this.getTimelineWidth()))\n\t\t\t{\n\t\t\t\tfromPos = parseInt(this.getTimelineWidth()) - selectorWidth;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet\n\t\t\t\t\tfromDate = this.getDateByPos(fromPos),\n\t\t\t\t\ttoDate = this.getDateByPos(toPos, true),\n\t\t\t\t\ttimeFrom, timeTo,\n\t\t\t\t\tscaleTimeFrom = parseInt(scaleInfo.shownTimeFrom),\n\t\t\t\t\tscaleTimeTo = parseInt(scaleInfo.shownTimeTo);\n\n\t\t\t\tif (fromDate && toDate)\n\t\t\t\t{\n\t\t\t\t\tif (this.fullDayMode)\n\t\t\t\t\t{\n\t\t\t\t\t\ttimeFrom = parseInt(fromDate.getHours()) + Math.round((fromDate.getMinutes() / 60) * 10) / 10;\n\t\t\t\t\t\tfromDate.setHours(0, 0, 0, 0);\n\n\t\t\t\t\t\tif (timeFrom > 12)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfromDate = new Date(fromDate.getTime() + Util.getDayLength());\n\t\t\t\t\t\t\tfromDate.setHours(0, 0, 0, 0);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfromPos = this.getPosByDate(fromDate);\n\t\t\t\t\t}\n\t\t\t\t\telse if (fromDate.getDay() !== toDate.getDay())\n\t\t\t\t\t{\n\t\t\t\t\t\ttimeFrom = parseInt(fromDate.getHours()) + Math.round((fromDate.getMinutes() / 60) * 10) / 10;\n\t\t\t\t\t\ttimeTo = parseInt(toDate.getHours()) + Math.round((toDate.getMinutes() / 60) * 10) / 10;\n\t\t\t\t\t\tif (Math.abs(scaleTimeTo - timeFrom) > Math.abs(scaleTimeFrom - timeTo))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfromDate.setHours(scaleInfo.shownTimeTo, 0, 0,0);\n\t\t\t\t\t\t\tfromPos = this.getPosByDate(fromDate) - selectorWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttoDate.setHours(scaleInfo.shownTimeFrom, 0, 0,0);\n\t\t\t\t\t\t\tfromPos = this.getPosByDate(toDate);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn fromPos;\n\t}\n\n\ttransit(params = {})\n\t{\n\t\tlet\n\t\t\tfromX = params.fromX || parseInt(this.DOM.wrap.style.left),\n\t\t\ttoX = Selector.roundPos(params.toX || fromX),\n\t\t\ttriggerChangeEvents = params.triggerChangeEvents !== false,\n\t\t\tfocus = !!params.focus,\n\t\t\twidth = parseInt(this.DOM.wrap.offsetWidth);\n\n\t\t// triggerChangeEvents - it means that selector transition (animation caused from mouse ebents)\n\t\tif (toX > (fromX + width) && triggerChangeEvents)\n\t\t{\n\t\t\ttoX -= width;\n\t\t}\n\n\t\tif (fromX !== toX)\n\t\t{\n\t\t\tif (this.animation)\n\t\t\t{\n\t\t\t\tthis.animation.stop();\n\t\t\t}\n\n\t\t\tthis.animation = new BX.easing({\n\t\t\t\tduration: 300,\n\t\t\t\tstart: {left: fromX},\n\t\t\t\tfinish: {left: toX},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: (state) => {this.DOM.wrap.style.left = state.left + 'px'},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.animation = null;\n\t\t\t\t\tlet\n\t\t\t\t\t\tfromPos = parseInt(this.DOM.wrap.style.left),\n\t\t\t\t\t\tcheckedPos = this.checkPosition(fromPos);\n\n\t\t\t\t\tif (checkedPos !== fromPos)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.DOM.wrap.style.left = checkedPos + 'px';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (triggerChangeEvents)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setValue(checkedPos);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (focus)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.focus(true, 300);\n\t\t\t\t\t}\n\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.show(\n\t\t\t\t\t\t\tthis.currentDateFrom,\n\t\t\t\t\t\t\tthis.currentDateTo,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tanimation: false,\n\t\t\t\t\t\t\t\tfocus: focus,\n\t\t\t\t\t\t\t\talignCenter: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}, 200);\n\n\t\t\t\t\tthis.checkStatus(checkedPos);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.animation.animate();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (triggerChangeEvents)\n\t\t\t{\n\t\t\t\tthis.setValue();\n\t\t\t}\n\n\t\t\tif (focus === true)\n\t\t\t{\n\t\t\t\tthis.focus(true, 300);\n\t\t\t}\n\n\t\t\tthis.checkStatus();\n\t\t}\n\t}\n\n\tshowTitle(params = {})\n\t{\n\t\tlet\n\t\t\tfromPos = params.fromPos,\n\t\t\ttoPos = params.toPos,\n\t\t\tselectorTitle = params.selectorTitle || this.getTitleNode(),\n\t\t\tselector = params.selector || this.DOM.wrap,\n\t\t\ttimelineWidth = this.getTimelineWidth(),\n\t\t\tfromDate, toDate;\n\n\t\tif (fromPos && toPos)\n\t\t{\n\t\t\tif (toPos > timelineWidth)\n\t\t\t{\n\t\t\t\tfromPos = timelineWidth - parseInt(selector.style.width);\n\t\t\t\ttoPos = timelineWidth;\n\t\t\t}\n\n\t\t\tfromDate = this.getDateByPos(fromPos);\n\t\t\ttoDate = this.getDateByPos(toPos, true);\n\t\t\tif (fromDate && toDate)\n\t\t\t{\n\t\t\t\tif (this.fullDayMode)\n\t\t\t\t{\n\t\t\t\t\tif (Math.abs(toDate.getTime() - fromDate.getTime() - Util.getDayLength()) < 1000)\n\t\t\t\t\t{\n\t\t\t\t\t\tselectorTitle.innerHTML = BX.date.format('d F, D', fromDate.getTime() / 1000);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tselectorTitle.innerHTML =\n\t\t\t\t\t\t\tBX.date.format('d F', fromDate.getTime() / 1000)\n\t\t\t\t\t\t\t+ ' - '\n\t\t\t\t\t\t\t+ BX.date.format('d F', toDate.getTime() / 1000);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tselectorTitle.removeAttribute('style');\n\t\t\t\t\tselectorTitle.innerHTML = Util.formatTime(fromDate) + ' - ' + Util.formatTime(toDate);\n\t\t\t\t}\n\n\t\t\t\tif (this.selectMode && this.lastTouchedEntry)\n\t\t\t\t{\n\t\t\t\t\tlet\n\t\t\t\t\t\tentriesListWidth = this.compactMode ? 0 : this.entriesListWidth,\n\t\t\t\t\t\tselectorTitleLeft = parseInt(selector.style.left) - this.DOM.timelineWrap.scrollLeft + entriesListWidth + parseInt(selector.style.width) / 2,\n\t\t\t\t\t\tselectorTitleTop = parseInt(this.timelineDataCont.offsetTop) + parseInt(this.lastTouchedEntry.style.top) - 12;\n\n\t\t\t\t\tselectorTitle.style.top = selectorTitleTop + 'px';\n\t\t\t\t\tselectorTitle.style.left = selectorTitleLeft + 'px';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tselector.appendChild(selectorTitle);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (selectorTitle === this.selectorTitle)\n\t\t{\n\t\t\tif (selectorTitle.style.display === 'none' || this.selectorHideTimeout)\n\t\t\t{\n\t\t\t\tthis.selectorHideTimeout = clearTimeout(this.selectorHideTimeout);\n\t\t\t\t// Opacity animation\n\t\t\t\tthis.selectorTitle.style.display = '';\n\t\t\t\tthis.selectorTitle.style.opacity = 0;\n\t\t\t\tnew BX.easing({\n\t\t\t\t\tduration: 400,\n\t\t\t\t\tstart: {opacity: 0},\n\t\t\t\t\tfinish: {opacity: 100},\n\t\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quad),\n\t\t\t\t\tstep: (state)=>{this.selectorTitle.style.opacity = state.opacity / 100;},\n\t\t\t\t\tcomplete: ()=>{this.selectorTitle.removeAttribute('style');}\n\t\t\t\t}).animate();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselectorTitle.removeAttribute('style');\n\t\t}\n\t}\n\n\thideTitle(params = {})\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t\tparams = {};\n\n\t\tlet\n\t\t\ttimeoutName = params.selectorIndex === undefined ? 'selectorHideTimeout' : 'selectorHideTimeout_' + params.selectorIndex,\n\t\t\tselectorTitle = params.selectorTitle || this.getTitleNode();\n\n\t\tif (this[timeoutName])\n\t\t\tthis[timeoutName] = clearTimeout(this[timeoutName]);\n\n\t\tif (params.timeout !== false)\n\t\t{\n\t\t\tthis[timeoutName] = setTimeout(() => {\n\t\t\t\tparams.timeout = false;\n\t\t\t\tthis.hideTitle(params);\n\t\t\t}, 700);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// Opacity animation\n\t\t\tselectorTitle.style.display = '';\n\t\t\tselectorTitle.style.opacity = 1;\n\t\t\tnew BX.easing({\n\t\t\t\tduration: 400,\n\t\t\t\tstart: {opacity: 100},\n\t\t\t\tfinish: {opacity: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quad),\n\t\t\t\tstep: (state) => {selectorTitle.style.opacity = state.opacity / 100;},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tselectorTitle.removeAttribute('style');\n\t\t\t\t\tselectorTitle.style.display = 'none';\n\t\t\t\t}\n\t\t\t}).animate();\n\t\t}\n\t}\n\n\tstatic roundPos(x)\n\t{\n\t\treturn Math.round(parseFloat(x));\n\t}\n\n\tfocus(animation = true, timeout = 300, alignCenter)\n\t{\n\t\talignCenter = alignCenter === true;\n\n\n\n\t\tif (this.focusTimeout)\n\t\t{\n\t\t\tthis.focusTimeout = !!clearTimeout(this.focusTimeout);\n\t\t}\n\n\t\tif (this.useAnimation === false)\n\t\t{\n\t\t\tanimation = false;\n\t\t}\n\n\t\tif (timeout)\n\t\t{\n\t\t\tthis.focusTimeout = setTimeout(() => {this.focus(animation, false, alignCenter);}, timeout);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst\n\t\t\t\tscreenDelta = 10,\n\t\t\t\tselectorLeft = parseInt(this.DOM.wrap.style.left),\n\t\t\t\tselectorWidth = parseInt(this.DOM.wrap.style.width),\n\t\t\t\tviewWidth = parseInt(this.DOM.timelineWrap.offsetWidth),\n\t\t\t\tviewLeft = parseInt(this.DOM.timelineWrap.scrollLeft),\n\t\t\t\tviewRight = viewLeft + viewWidth;\n\n\t\t\tlet newScrollLeft = viewLeft;\n\n\t\t\tif (selectorLeft < viewLeft + screenDelta\n\t\t\t\t|| selectorLeft > viewRight - screenDelta\n\t\t\t\t|| alignCenter\n\t\t\t)\n\t\t\t{\n\t\t\t\t// Selector is smaller than view - we puting it in the middle of the view\n\t\t\t\tif (selectorWidth <= viewWidth)\n\t\t\t\t{\n\t\t\t\t\tnewScrollLeft = Math.max(Math.round(selectorLeft - ((viewWidth - selectorWidth) / 2 )), screenDelta);\n\n\t\t\t\t}\n\t\t\t\telse // Selector is wider, so we adjust by left side\n\t\t\t\t{\n\t\t\t\t\tnewScrollLeft = Math.max(Math.round(selectorLeft - screenDelta), screenDelta);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newScrollLeft !== viewLeft)\n\t\t\t{\n\t\t\t\tif (animation === false)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.timelineWrap.scrollLeft = newScrollLeft;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnew BX.easing({\n\t\t\t\t\t\tduration: 300,\n\t\t\t\t\t\tstart: {scrollLeft: this.DOM.timelineWrap.scrollLeft},\n\t\t\t\t\t\tfinish: {scrollLeft: newScrollLeft},\n\t\t\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quad),\n\t\t\t\t\t\tstep: (state)=>{this.DOM.timelineWrap.scrollLeft = state.scrollLeft;},\n\t\t\t\t\t\tcomplete: ()=>{}\n\t\t\t\t\t}).animate();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetDuration()\n\t{\n\t\tlet duration = Math.round((this.currentDateTo - this.currentDateFrom) / 1000) * 1000;\n\n\t\tif (this.fullDayMode)\n\t\t{\n\t\t\tduration += Util.getDayLength();\n\t\t}\n\n\t\treturn duration;\n\t}\n\n\tgetDateFrom()\n\t{\n\t\treturn this.currentDateFrom;\n\t}\n\n\tgetDateTo()\n\t{\n\t\treturn this.currentDateTo;\n\t}\n}","// @flow\nimport {Runtime, Type, Event, Loc, Dom, Tag, Text} from 'main.core';\nimport {Util} from 'calendar.util';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Selector} from './selector.js';\nimport {PopupWindowManager} from \"main.popup\";\n\nexport class Planner extends EventEmitter\n{\n\tDOM = {};\n\tconfig = {};\n\tentryStatusMap = {\n\t\th : 'user-status-h',\n\t\ty : 'user-status-y',\n\t\tq : 'user-status-q',\n\t\tn : 'user-status-n'\n\t};\n\tscaleTypes = ['15min','30min','1hour', '2hour', '1day'];\n\tsavedScaleType = null;\n\tSCALE_OFFSET_BEFORE = 3;  // in days\n\tSCALE_OFFSET_AFTER = 10;  // in days\n\tEXPAND_OFFSET = 3; // in days\n\tEXPAND_DELAY = 2000; // ms\n\tREBUILD_DELAY = 100;\n\tmaxTimelineSize =  20;\n\tMIN_ENTRY_ROWS =  3;\n\tMAX_ENTRY_ROWS = 300;\n\twidth = 700;\n\theight = 84;\n\tminWidth = 700;\n\tminHeight = 84;\n\tworkTime = [9, 18];\n\tscrollStep = 10;\n\tshown = false;\n\tbuilt = false;\n\tlocked = false;\n\tshownScaleTimeFrom = 24;\n\tshownScaleTimeTo = 0;\n\ttimelineCellWidthOrig = false;\n\tproposeTimeLimit = 60; // in days\n\texpandTimelineDelay = 600;\n\tlimitScaleSizeMode = false;\n\tuseAnimation = true;\n\tcheckTimeCache = {};\n\tentriesIndex = new Map();\n\tsolidStatus = false;\n\n\tconstructor(params = {}, initialUpdateParams = null)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.Planner');\n\t\tthis.config = params;\n\t\tthis.id = params.id;\n\t\tthis.userId = parseInt(params.userId || Loc.getMessage('USER_ID'));\n\t\tthis.DOM.wrap = params.wrap;\n\t\tthis.SCALE_TIME_FORMAT = BX.isAmPmMode() ? 'g a' : 'G';\n\n\t\tthis.setConfig(params);\n\t\t// this.SetLoadedDataLimits(this.scaleDateFrom, this.scaleDateTo);\n\n\t\t// BX.addCustomEvent('OnCalendarPlannerDoUpdate', BX.proxy(this.DoUpdate, this));\n\t\t// BX.addCustomEvent('OnCalendarPlannerDoExpand', BX.proxy(this.DoExpand, this));\n\t\t// BX.addCustomEvent('OnCalendarPlannerDoResize', BX.proxy(this.DoResize, this));\n\t\t// BX.addCustomEvent('OnCalendarPlannerDoSetConfig', BX.proxy(this.DoSetConfig, this));\n\t\t// BX.addCustomEvent('OnCalendarPlannerDoUninstall', BX.proxy(this.DoUninstall, this));\n\n\t\t//BX.addCustomEvent('OnCalendarPlannerDoProposeTime', BX.proxy(this.DoProposeTime, this));\n\t\t// if (initialUpdateParams)\n\t\t// {\n\t\t// \tinitialUpdateParams.plannerId = this.id;\n\t\t// \tif (initialUpdateParams.selector)\n\t\t// \t{\n\t\t// \t\tif (initialUpdateParams.selector.from && !initialUpdateParams.selector.from.getTime)\n\t\t// \t\t{\n\t\t// \t\t\tinitialUpdateParams.selector.from = Util.parseDate(initialUpdateParams.selector.from);\n\t\t// \t\t}\n\t\t// \t\tif (initialUpdateParams.selector.to && !initialUpdateParams.selector.to.getTime)\n\t\t// \t\t{\n\t\t// \t\t\tinitialUpdateParams.selector.to = Util.parseDate(initialUpdateParams.selector.to);\n\t\t// \t\t}\n\t\t// \t}\n\t\t// \tthis.useAnimation = false;\n\t\t// \tthis.DoUpdate(initialUpdateParams);\n\t\t// \tsetTimeout(BX.delegate(function(){this.useAnimation = true;}, this), 2000);\n\t\t// }\n\t}\n\n\tshow(options = {animation: false})\n\t{\n\t\tlet animation = false;\n\n\t\tif (this.hideAnimation)\n\t\t{\n\t\t\tthis.hideAnimation.stop();\n\t\t\tthis.hideAnimation = null;\n\t\t}\n\n\n\t\tif (!this.isBuilt())\n\t\t{\n\t\t\tthis.build();\n\t\t\tthis.bindEventHandlers();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.resizePlannerWidth(this.width);\n\t\t}\n\n\t\tthis.buildTimeline();\n\n\t\tif (this.adjustWidth)\n\t\t{\n\t\t\tthis.resizePlannerWidth(this.DOM.timelineInnerWrap.offsetWidth);\n\t\t}\n\n\t\tthis.DOM.wrap.style.display = '';\n\n\t\tif (this.readonly)\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-readonly');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.DOM.mainWrap, 'calendar-planner-readonly');\n\t\t}\n\n\t\tif (this.compactMode)\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-compact');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.DOM.mainWrap, 'calendar-planner-compact');\n\t\t}\n\n\t\tthis.DOM.entriesOuterWrap.style.display = this.compactMode ? 'none' : '';\n\n\t\tif (animation)\n\t\t{\n\t\t\tif (this.showAnimation)\n\t\t\t{\n\t\t\t\tthis.showAnimation.stop();\n\t\t\t}\n\t\t\tthis.showAnimation = new BX.easing({\n\t\t\t\tduration: 300,\n\t\t\t\tstart: {height: 0},\n\t\t\t\tfinish: {height: this.height},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: (state) => {this.DOM.wrap.style.height = state.height + 'px';},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tif (parseInt(this.DOM.wrap.style.height) < this.height)\n\t\t\t\t\t\tthis.DOM.wrap.style.height = this.height + 'px';\n\t\t\t\t\tthis.showAnimation = null;\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.showAnimation.animate();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (parseInt(this.DOM.wrap.style.height) < this.height)\n\t\t\t{\n\t\t\t\tthis.DOM.wrap.style.height = this.height + 'px';\n\t\t\t}\n\t\t\tthis.adjustHeight();\n\t\t}\n\n\t\tthis.shown = true;\n\t}\n\n\tsetConfig(params)\n\t{\n\t\tthis.setScaleType(params.scaleType);\n\n\t\t// showTimelineDayTitle\n\t\tif (params.showTimelineDayTitle !== undefined)\n\t\t\tthis.showTimelineDayTitle = !!params.showTimelineDayTitle;\n\t\telse if(this.showTimelineDayTitle === undefined)\n\t\t\tthis.showTimelineDayTitle = true;\n\n\t\t// compactMode\n\t\tif (params.compactMode !== undefined)\n\t\t\tthis.compactMode = !!params.compactMode;\n\t\telse if (this.compactMode === undefined)\n\t\t\tthis.compactMode = false;\n\n\t\t// readonly\n\t\tif (params.readonly !== undefined)\n\t\t\tthis.readonly = !!params.readonly;\n\t\telse if (this.readonly === undefined)\n\t\t\tthis.readonly = false;\n\n\t\tif (this.compactMode)\n\t\t{\n\t\t\tlet compactHeight = 50;\n\t\t\tif (this.showTimelineDayTitle && !this.isOneDayScale())\n\t\t\t\tcompactHeight += 20;\n\t\t\tthis.height = this.minHeight = compactHeight;\n\t\t}\n\n\t\t// Select mode\n\t\tif (params.selectEntriesMode !== undefined)\n\t\t\tthis.selectMode = !!params.selectEntriesMode;\n\t\telse if (this.selectMode === undefined)\n\t\t\tthis.selectMode = false;\n\n\t\tif (Type.isInteger(params.SCALE_OFFSET_BEFORE))\n\t\t{\n\t\t\tthis.SCALE_OFFSET_BEFORE = parseInt(params.SCALE_OFFSET_BEFORE);\n\t\t}\n\t\tif (Type.isInteger(params.SCALE_OFFSET_AFTER))\n\t\t{\n\t\t\tthis.SCALE_OFFSET_AFTER = parseInt(params.SCALE_OFFSET_AFTER);\n\t\t}\n\t\tif (Type.isInteger(params.maxTimelineSize))\n\t\t{\n\t\t\tthis.maxTimelineSize = parseInt(params.maxTimelineSize);\n\t\t}\n\t\tif (Type.isInteger(params.minEntryRows))\n\t\t{\n\t\t\tthis.MIN_ENTRY_ROWS = parseInt(params.minEntryRows);\n\t\t}\n\t\tif (Type.isInteger(params.maxEntryRows))\n\t\t{\n\t\t\tthis.MAX_ENTRY_ROWS = parseInt(params.maxEntryRows);\n\t\t}\n\n\t\tif (Type.isInteger(params.width))\n\t\t{\n\t\t\tthis.width = parseInt(params.width);\n\t\t}\n\t\tif (Type.isInteger(params.height))\n\t\t{\n\t\t\tthis.height = parseInt(params.height);\n\t\t}\n\t\tif (Type.isInteger(params.minWidth))\n\t\t{\n\t\t\tthis.minWidth = parseInt(params.minWidth);\n\t\t}\n\t\tif (Type.isInteger(params.minHeight))\n\t\t{\n\t\t\tthis.minHeight = parseInt(params.minHeight);\n\t\t}\n\t\tthis.width = Math.max(this.minWidth, this.width);\n\t\tthis.height = Math.max(this.minHeight, this.height);\n\n\t\tif (Type.isArray(params.workTime))\n\t\t{\n\t\t\tthis.workTime = params.workTime;\n\t\t}\n\t\tthis.extendScaleTime(this.workTime[0], this.workTime[1]);\n\n\t\tthis.weekHolidays = params.weekHolidays || this.weekHolidays || [];\n\t\tthis.yearHolidays = params.yearHolidays || this.yearHolidays || [];\n\t\tthis.accuracy = params.accuracy || this.accuracy || 300; // 5 min\n\t\tthis.clickSelectorScaleAccuracy = params.clickSelectorScaleAccuracy || this.accuracy; // 5 min\n\t\tthis.selectorAccuracy = parseInt(params.selectorAccuracy) || this.selectorAccuracy || 300; // 5 min\n\t\tthis.entriesListWidth = parseInt(params.entriesListWidth) || this.entriesListWidth || 200;\n\t\tthis.timelineCellWidth = params.timelineCellWidth || this.timelineCellWidth || 40;\n\t\tthis.solidStatus = params.solidStatus === true;\n\n\t\tthis.showEntiesHeader = params.showEntiesHeader === undefined ? true : !!params.showEntiesHeader;\n\t\tthis.showEntryName = params.showEntryName === undefined ? true : !!params.showEntryName;\n\n\t\tif (this.isOneDayScale() && this.timelineCellWidth < 100)\n\t\t{\n\t\t\tthis.timelineCellWidthOrig = this.timelineCellWidth;\n\t\t\tthis.timelineCellWidth = 100;\n\t\t}\n\t\telse if(this.timelineCellWidthOrig && !this.isOneDayScale())\n\t\t{\n\t\t\tthis.timelineCellWidth = this.timelineCellWidthOrig;\n\t\t\tthis.timelineCellWidthOrig = false;\n\t\t}\n\n\t\tif (this.allowAdjustCellWidth === undefined || params.allowAdjustCellWidth !== undefined)\n\t\t{\n\t\t\tthis.allowAdjustCellWidth = this.readonly\n\t\t\t\t&& this.compactMode\n\t\t\t\t&& params.allowAdjustCellWidth !== false;\n\t\t}\n\n\t\tif (params.locked !== undefined)\n\t\t{\n\t\t\tthis.locked = params.locked;\n\t\t}\n\n\t\tthis.adjustCellWidth();\n\n\t\t// Scale params\n\t\tthis.setScaleLimits(params.scaleDateFrom, params.scaleDateTo);\n\t}\n\n\tsetScaleLimits(scaleDateFrom, scaleDateTo)\n\t{\n\t\tif (scaleDateFrom !== undefined)\n\t\t{\n\t\t\tthis.scaleDateFrom = Type.isDate(scaleDateFrom) ? scaleDateFrom : Util.parseDate(scaleDateFrom);\n\t\t}\n\n\t\tif (!Type.isDate(this.scaleDateFrom))\n\t\t{\n\t\t\tif (this.compactMode && this.readonly)\n\t\t\t{\n\t\t\t\tthis.scaleDateFrom = new Date();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.scaleDateFrom = new Date(new Date().getTime() - Util.getDayLength() * this.SCALE_OFFSET_BEFORE);\n\t\t\t}\n\t\t}\n\t\tthis.scaleDateFrom.setHours(this.isOneDayScale() ? 0 : this.shownScaleTimeFrom, 0, 0, 0);\n\n\t\tif (scaleDateTo !== undefined)\n\t\t{\n\t\t\tthis.scaleDateTo = BX.type.isString(scaleDateTo) ? Util.parseDate(scaleDateTo) : scaleDateTo;\n\t\t}\n\n\t\tif (!Type.isDate(this.scaleDateTo))\n\t\t{\n\t\t\tif (this.compactMode && this.readonly)\n\t\t\t{\n\t\t\t\tthis.scaleDateTo = new Date();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.scaleDateTo = new Date(new Date().getTime() + Util.getDayLength() * this.SCALE_OFFSET_AFTER);\n\t\t\t}\n\t\t}\n\t\tthis.scaleDateTo.setHours(this.isOneDayScale() ? 0 : this.shownScaleTimeTo, 0, 0, 0);\n\t}\n\n\tSetLoadedDataLimits(from, to)\n\t{\n\t\tif (from)\n\t\t\tthis.loadedDataFrom = from.getTime ? from : Util.parseDate(from);\n\t\tif (to)\n\t\t\tthis.loadedDataTo = to.getTime ? to : Util.parseDate(to);\n\t}\n\n\textendScaleTime(fromTime, toTime)\n\t{\n\t\tif (fromTime !== false && !isNaN(parseInt(fromTime)))\n\t\t{\n\t\t\tthis.shownScaleTimeFrom = Math.min(parseInt(fromTime), this.shownScaleTimeFrom, 23);\n\t\t\tthis.shownScaleTimeFrom = Math.max(this.shownScaleTimeFrom, 0);\n\n\t\t\tif (this.scaleDateFrom)\n\t\t\t{\n\t\t\t\tthis.scaleDateFrom.setHours(this.shownScaleTimeFrom, 0,0,0);\n\t\t\t}\n\t\t}\n\n\t\tif (toTime !== false && !isNaN(parseInt(toTime)))\n\t\t{\n\t\t\tthis.shownScaleTimeTo = Math.max(parseInt(toTime), this.shownScaleTimeTo, 1);\n\t\t\tthis.shownScaleTimeTo = Math.min(this.shownScaleTimeTo, 24);\n\n\t\t\tif (this.scaleDateTo)\n\t\t\t{\n\t\t\t\tthis.scaleDateTo.setHours(this.shownScaleTimeTo, 0,0,0);\n\t\t\t}\n\t\t}\n\n\t\tthis.rebuildDebounce();\n\n\t\t//this.checkSelectorPosition = this.shownScaleTimeFrom !== 0 || this.shownScaleTimeTo !== 24;\n\t}\n\n\tadjustCellWidth()\n\t{\n\t\tif (this.allowAdjustCellWidth)\n\t\t{\n\t\t\tthis.timelineCellWidth = Math.round(this.width / ((this.shownScaleTimeTo - this.shownScaleTimeFrom) * 3600 / this.scaleSize));\n\t\t}\n\t}\n\n\tbuild()\n\t{\n\t\tif (!Type.isDomNode(this.DOM.wrap))\n\t\t{\n\t\t\tthrow new TypeError(\"Wrap is not DOM node\");\n\t\t}\n\n\t\tthis.DOM.wrap.style.width = this.width + 'px';\n\n\t\t// Left part - list of users and other resourses\n\t\tlet entriesListWidth = this.compactMode ? 0 : this.entriesListWidth;\n\n\t\t// Timeline with accessibility information\n\t\tthis.DOM.mainWrap = this.DOM.wrap.appendChild(BX.create(\"DIV\", {\n\t\t\tprops: {className: 'calendar-planner-main-container calendar-planner-main-container-resource'}, style: {\n\t\t\t\tminHeight: this.minHeight + 'px',\n\t\t\t\theight: this.height + 'px',\n\t\t\t\twidth: this.width + 'px'\n\t\t\t}\n\t\t}));\n\n\t\tif (!this.showEntryName)\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-entry-icons-only');\n\t\t}\n\n\t\tif (this.readonly)\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-readonly');\n\t\t}\n\n\t\tthis.DOM.entriesOuterWrap = this.DOM.mainWrap.appendChild(BX.create(\"DIV\", {\n\t\t\tprops: {className: 'calendar-planner-user-container'},\n\t\t\tstyle: {\n\t\t\t\twidth: entriesListWidth + 'px',\n\t\t\t\theight: this.height + 'px'\n\t\t\t}\n\t\t}));\n\n\t\tUtil.preventSelection(this.DOM.entriesOuterWrap);\n\t\tif (this.compactMode)\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-compact');\n\t\t\tthis.DOM.entriesOuterWrap.style.display = 'none';\n\t\t}\n\n\t\tif (this.isOneDayScale())\n\t\t{\n\t\t\tDom.addClass(this.DOM.entriesOuterWrap, 'calendar-planner-no-daytitle');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.DOM.entriesOuterWrap, 'calendar-planner-no-daytitle');\n\t\t}\n\n\t\tif (this.showEntiesHeader !== false)\n\t\t{\n\t\t\tthis.DOM.entrieListHeader = this.DOM.entriesOuterWrap.appendChild(\n\t\t\t\tBX.create(\"DIV\", {props: {className: 'calendar-planner-header'}})\n\t\t\t).appendChild(\n\t\t\t\tBX.create(\"DIV\", {props: {className: 'calendar-planner-general-info'}})\n\t\t\t).appendChild(\n\t\t\t\tBX.create(\"DIV\", {props: {className: 'calendar-planner-users-header'}})\n\t\t\t);\n\n\t\t\tthis.entriesListTitleCounter = this.DOM.entrieListHeader.appendChild(BX.create(\"span\", {\n\t\t\t\tprops: {className: 'calendar-planner-users-item'},\n\t\t\t\ttext: Loc.getMessage('EC_PL_ATTENDEES_TITLE') + ' '\n\t\t\t})).appendChild(BX.create(\"span\"));\n\t\t}\n\n\t\tthis.DOM.entrieListWrap = this.DOM.entriesOuterWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-user-container-inner'}}));\n\n\t\t// Fixed cont with specific width and height\n\t\tthis.DOM.timelineFixedWrap = this.DOM.mainWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-planner-timeline-wrapper\" style=\"height: ${this.height}px\"></div>\n\t\t`);\n\n\t\tif (this.isLocked())\n\t\t{\n\t\t\tthis.lock();\n\t\t}\n\n\t\t// Movable cont - used to move scale and data containers easy and at the same time\n\t\tthis.DOM.timelineInnerWrap = this.DOM.timelineFixedWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-timeline-inner-wrapper'}}));\n\t\tthis.DOM.timelineInnerWrap.setAttribute('data-bx-planner-meta', 'timeline');\n\n\t\t// Scale container\n\t\tthis.DOM.timelineScaleWrap = this.DOM.timelineInnerWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-time'}}));\n\t\tUtil.preventSelection(this.DOM.timelineScaleWrap);\n\n\t\t// Accessibility container\n\t\tthis.DOM.timelineDataWrap = this.DOM.timelineInnerWrap.appendChild(BX.create(\"DIV\", {\n\t\t\tprops: {className: 'calendar-planner-timeline-container'},\n\t\t\tstyle: {\n\t\t\t\theight: (this.height) + 'px'\n\t\t\t}\n\t\t}));\n\t\t// Container with accessibility entries elements\n\t\tthis.DOM.accessibilityWrap = this.DOM.timelineDataWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-acc-wrap'}}));\n\n\t\t// Selector\n\t\tthis.selector = new Selector({\n\t\t\tselectMode: this.selectMode,\n\t\t\ttimelineWrap: this.DOM.timelineFixedWrap,\n\t\t\tgetPosByDate: this.getPosByDate.bind(this),\n\t\t\tgetDateByPos: this.getDateByPos.bind(this),\n\t\t\tgetPosDateMap: ()=>{return this.posDateMap;},\n\t\t\tuseAnimation: this.useAnimation,\n\t\t\tsolidStatus: this.solidStatus,\n\t\t\tgetScaleInfo: ()=>{return {\n\t\t\t\tscale: this.scaleType,\n\t\t\t\tshownTimeFrom: this.shownScaleTimeFrom,\n\t\t\t\tshownTimeTo: this.shownScaleTimeTo,\n\t\t\t}},\n\t\t\tgetTimelineWidth: ()=>{return parseInt(this.DOM.timelineInnerWrap.style.width)}\n\t\t});\n\t\tthis.DOM.timelineDataWrap.appendChild(this.selector.getWrap());\n\t\tthis.DOM.mainWrap.appendChild(this.selector.getTitleNode());\n\t\tthis.selector.subscribe('onChange', this.handleSelectorChanges.bind(this));\n\t\tthis.selector.subscribe('doCheckStatus', this.doCheckSelectorStatus.bind(this));\n\n\t\tif (this.selectMode)\n\t\t{\n\t\t\tthis.selectedEntriesWrap = this.DOM.mainWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-timeline-select-entries-wrap'}}));\n\n\t\t\tthis.hoverRow = this.DOM.mainWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\tprops: {className: 'calendar-planner-timeline-hover-row'},\n\t\t\t\tstyle: {\n\t\t\t\t\ttop: 0,\n\t\t\t\t\twidth: parseInt(this.DOM.mainWrap.offsetWidth) + 'px'\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tEvent.bind(document, 'mousemove', this.mouseMoveHandler.bind(this));\n\t\t}\n\n\t\tif (!this.compactMode)\n\t\t{\n\t\t\tthis.DOM.settingsButton = this.DOM.mainWrap.appendChild(Tag.render`<div class=\"calendar-planner-settings-icon-container\" title=\"${Loc.getMessage('EC_PL_SETTINGS_SCALE')}\"><span class=\"calendar-planner-settings-title\">${Loc.getMessage('EC_PL_SETTINGS_SCALE')}</span><span class=\"calendar-planner-settings-icon\"></span></div>`);\n\t\t\tEvent.bind(this.DOM.settingsButton, 'click', this.showSettingsPopup.bind(this));\n\t\t}\n\n\t\tthis.built = true;\n\t}\n\n\tbuildTimeline(clearCache)\n\t{\n\t\tif (this.isBuilt()\n\t\t\t&& (this.lastTimelineKey !== this.getTimelineShownKey()\n\t\t\t|| clearCache === true))\n\t\t{\n\t\t\tif (this.DOM.timelineScaleWrap)\n\t\t\t{\n\t\t\t\tDom.clean(this.DOM.timelineScaleWrap);\n\t\t\t}\n\n\t\t\tthis.scaleData = this.getScaleData();\n\n\t\t\tlet\n\t\t\t\touterDayCont,\n\t\t\t\tdayTitle,\n\t\t\t\tcont = this.DOM.timelineScaleWrap;\n\n\t\t\tfor (let i = 0; i < this.scaleData.length; i++)\n\t\t\t{\n\t\t\t\tif (this.showTimelineDayTitle && !this.isOneDayScale())\n\t\t\t\t{\n\t\t\t\t\tif (this.scaleDayTitles[this.scaleData[i].daystamp])\n\t\t\t\t\t{\n\t\t\t\t\t\tcont = this.scaleDayTitles[this.scaleData[i].daystamp];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\touterDayCont = this.DOM.timelineScaleWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-time-day-outer'}}));\n\n\t\t\t\t\t\tdayTitle = outerDayCont.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: 'calendar-planner-time-day-title'},\n\t\t\t\t\t\t\thtml: '<span>' + BX.date.format('d F, l', this.scaleData[i].timestamp / 1000) + '</span>' + '<div class=\"calendar-planner-time-day-border\"></div>'\n\t\t\t\t\t\t}));\n\n\t\t\t\t\t\tcont = outerDayCont.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: 'calendar-planner-time-day'}\n\t\t\t\t\t\t}));\n\n\t\t\t\t\t\tthis.scaleDayTitles[this.scaleData[i].daystamp] = cont;\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet className = 'calendar-planner-time-hour-item' + (this.scaleData[i].dayStart ? ' calendar-planner-day-start' : '');\n\n\t\t\t\tif ((this.scaleType === '15min' || this.scaleType === '30min') && this.scaleData[i].title !== '')\n\t\t\t\t{\n\t\t\t\t\tclassName += ' calendar-planner-time-hour-bold';\n\t\t\t\t}\n\n\t\t\t\tthis.scaleData[i].cell = cont.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: className}, style: {\n\t\t\t\t\t\twidth: this.timelineCellWidth + 'px', minWidth: this.timelineCellWidth + 'px'\n\t\t\t\t\t}, html: this.scaleData[i].title ? '<i>' + this.scaleData[i].title + '</i>' : ''\n\t\t\t\t}));\n\n\t\t\t\tif (!this.isOneDayScale() && this.scaleData[i + 1] && this.scaleData[i + 1].dayStart)\n\t\t\t\t{\n\t\t\t\t\tcont.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-timeline-border'}}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet mapDatePosRes = this.mapDatePos();\n\t\t\tthis.posDateMap = mapDatePosRes.posDateMap;\n\n\t\t\tconst timelineOffset = this.DOM.timelineScaleWrap.offsetWidth;\n\t\t\tthis.DOM.timelineInnerWrap.style.width = timelineOffset + 'px';\n\t\t\tthis.DOM.entrieListWrap.style.top = (parseInt(this.DOM.timelineDataWrap.offsetTop) + 10) + 'px';\n\n\t\t\tthis.lastTimelineKey = this.getTimelineShownKey();\n\t\t\tthis.checkRebuildTimeout(timelineOffset);\n\t\t}\n\t}\n\n\tgetTimelineShownKey()\n\t{\n\t\treturn 'tm_' + this.scaleDateFrom.getTime() + '_' + this.scaleDateTo.getTime();\n\t}\n\n\tcheckRebuildTimeout(timelineOffset, timeout = 300)\n\t{\n\t\tif (!this._checkRebuildTimeoutCount)\n\t\t{\n\t\t\tthis._checkRebuildTimeoutCount = 0;\n\t\t}\n\n\t\tif (this.rebuildTimeout)\n\t\t{\n\t\t\tthis.rebuildTimeout = !!clearTimeout(this.rebuildTimeout);\n\t\t}\n\n\t\tif (this._checkRebuildTimeoutCount <= 10\n\t\t\t&& Type.isElementNode(this.DOM.timelineScaleWrap)\n\t\t\t&& Dom.isShown(this.DOM.timelineScaleWrap)\n\t\t)\n\t\t{\n\t\t\tthis._checkRebuildTimeoutCount++;\n\t\t\tthis.rebuildTimeout = setTimeout(() => {\n\t\t\t\tif (timelineOffset !== this.DOM.timelineScaleWrap.offsetWidth)\n\t\t\t\t{\n\t\t\t\t\tif (this.rebuildTimeout)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.rebuildTimeout = !!clearTimeout(this.rebuildTimeout);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.rebuild();\n\t\t\t\t\tif (this.selector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selector.focus(false, 300);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.checkRebuildTimeout(timelineOffset, timeout);\n\t\t\t\t}\n\t\t\t}, timeout);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdelete this._checkRebuildTimeoutCount;\n\t\t}\n\t}\n\n\trebuildDebounce(timeout = this.REBUILD_DELAY)\n\t{\n\t\tRuntime.debounce(this.rebuild, timeout, this)();\n\t}\n\n\trebuild(params = {})\n\t{\n\t\tif (this.isBuilt())\n\t\t{\n\t\t\tthis.buildTimeline(true);\n\t\t\tthis.update(this.entries, this.accessibility);\n\t\t\tthis.adjustHeight();\n\t\t\tthis.resizePlannerWidth(this.width);\n\n\t\t\tif (params.updateSelector !== false)\n\t\t\t{\n\t\t\t\tthis.selector.update(params.selectorParams);\n\t\t\t}\n\n\t\t\tthis.clearCacheTime();\n\t\t}\n\t}\n\n\tgetScaleData()\n\t{\n\t\tthis.scaleData = [];\n\t\tthis.scaleDayTitles = {};\n\n\t\tlet\n\t\t\tts, scaleFrom, scaleTo,\n\t\t\ttime, dayStamp, title,\n\t\t\tcurDayStamp = false,\n\t\t\ttimeFrom = this.isOneDayScale() ? 0 : this.shownScaleTimeFrom,\n\t\t\ttimeTo = this.isOneDayScale() ? 0 : this.shownScaleTimeTo;\n\n\t\tthis.scaleDateFrom.setHours(timeFrom, 0, 0, 0);\n\t\tthis.scaleDateTo.setHours(timeTo, 0, 0, 0);\n\t\tscaleFrom = this.scaleDateFrom.getTime();\n\t\tscaleTo = this.scaleDateTo.getTime();\n\n\t\tfor (ts = scaleFrom; ts < scaleTo; ts += this.scaleSize * 1000)\n\t\t{\n\t\t\ttime = parseFloat(BX.date.format('H.i', ts / 1000));\n\n\t\t\tif (this.isOneDayScale())\n\t\t\t\ttitle = BX.date.format('d F, D', ts / 1000);\n\t\t\telse\n\t\t\t\ttitle = BX.date.format('i', ts / 1000) === '00'\n\t\t\t\t\t? BX.date.format(this.SCALE_TIME_FORMAT, ts / 1000)\n\t\t\t\t\t: '';\n\n\t\t\tif (this.isOneDayScale() || (time >= timeFrom && time < timeTo))\n\t\t\t{\n\t\t\t\tdayStamp = BX.date.format('d.m.Y', ts / 1000);\n\t\t\t\tthis.scaleData.push({\n\t\t\t\t\tdaystamp: dayStamp,\n\t\t\t\t\ttimestamp: ts,\n\t\t\t\t\tvalue: ts,\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tdayStart: curDayStamp !== dayStamp\n\t\t\t\t});\n\t\t\t\tcurDayStamp = dayStamp;\n\t\t\t}\n\t\t}\n\n\t\treturn this.scaleData;\n\t}\n\n\tisOneDayScale()\n\t{\n\t\treturn this.scaleType === '1day';\n\t}\n\n\tstatic prepareAccessibilityItem(entry)\n\t{\n\t\tif (!Type.isDate(entry.from))\n\t\t{\n\t\t\tentry.from = Util.parseDate(entry.dateFrom);\n\t\t}\n\n\t\tif (!Type.isDate(entry.to))\n\t\t{\n\t\t\tentry.to = Util.parseDate(entry.dateTo);\n\t\t}\n\n\t\tif (!Type.isDate(entry.from) || !Type.isDate(entry.to))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tentry.from.setSeconds(0,0);\n\t\tentry.fromTimestamp = entry.from.getTime();\n\n\t\tentry.to.setSeconds(0,0);\n\t\tentry.toTimestamp = entry.to.getTime();\n\n\t\tif (!Type.isDate(entry.toReal))\n\t\t{\n\t\t\t// Full day\n\t\t\tif ((entry.toTimestamp - entry.fromTimestamp) % Util.getDayLength() === 0\n\t\t\t\t&&\n\t\t\t\tBX.date.format('H:i', entry.toTimestamp / 1000) === '00:00'\n\t\t\t)\n\t\t\t{\n\t\t\t\tentry.toReal = new Date(entry.to.getTime() + Util.getDayLength());\n\t\t\t\tentry.toReal.setSeconds(0,0);\n\t\t\t\tentry.toTimestampReal = entry.toReal.getTime();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tentry.toReal = entry.to;\n\t\t\t\tentry.toTimestampReal = entry.toTimestamp;\n\t\t\t}\n\t\t}\n\n\t\treturn entry;\n\t}\n\n\taddAccessibilityItem(entry, wrap)\n\t{\n\t\tlet\n\t\t\ttimeFrom, timeTo,\n\t\t\thidden = false,\n\t\t\tfromTimestamp = entry.fromTimestamp,\n\t\t\ttoTimestamp = entry.toTimestampReal || entry.toTimestamp,\n\t\t\tshownScaleTimeFrom = this.isOneDayScale() ? 0 : this.shownScaleTimeFrom,\n\t\t\tshownScaleTimeTo = this.isOneDayScale() ? 24 : this.shownScaleTimeTo,\n\t\t\tfrom = new Date(fromTimestamp),\n\t\t\tto = new Date(toTimestamp);\n\n\t\ttimeFrom = parseInt(from.getHours()) + from.getMinutes() / 60;\n\t\ttimeTo = parseInt(to.getHours()) + to.getMinutes() / 60;\n\n\t\tif (timeFrom > shownScaleTimeTo)\n\t\t{\n\t\t\tfrom = new Date(from.getTime() + Util.getDayLength() - 1);\n\t\t\tfrom.setHours(shownScaleTimeFrom, 0, 0, 0);\n\t\t\tif (from.getTime() >= to.getTime())\n\t\t\t{\n\t\t\t\thidden = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!hidden && timeFrom < shownScaleTimeFrom)\n\t\t{\n\t\t\tfrom.setHours(shownScaleTimeFrom, 0, 0, 0);\n\t\t\tif (from.getTime() >= to.getTime())\n\t\t\t{\n\t\t\t\thidden = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!hidden && timeTo > shownScaleTimeTo)\n\t\t{\n\t\t\tto.setHours(shownScaleTimeTo, 0, 0, 0);\n\t\t\tif (from.getTime() >= to.getTime())\n\t\t\t{\n\t\t\t\thidden = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!hidden && timeTo < shownScaleTimeFrom)\n\t\t{\n\t\t\tto = new Date(to.getTime() - Util.getDayLength() + 1);\n\t\t\tto.setHours(shownScaleTimeTo, 0, 0, 0);\n\t\t\tif (from.getTime() >= to.getTime())\n\t\t\t{\n\t\t\t\thidden = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!hidden)\n\t\t{\n\t\t\tlet\n\t\t\t\tfromPos = this.getPosByDate(from),\n\t\t\t\ttoPos = this.getPosByDate(to);\n\n\t\t\tentry.node = wrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'calendar-planner-acc-entry' + (entry.type && entry.type === 'hr' ? ' calendar-planner-acc-entry-hr' : '')\n\t\t\t\t},\n\t\t\t\tstyle: {\n\t\t\t\t\tleft: fromPos + 'px',\n\t\t\t\t\twidth: Math.max((toPos - fromPos), 3) + 'px'\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tif (entry.title || entry.name)\n\t\t\t{\n\t\t\t\tentry.node.title = entry.title || entry.name;\n\t\t\t}\n\t\t}\n\t}\n\n\tdisplayEntryRow(entry, accessibility = [])\n\t{\n\t\tlet rowWrap;\n\t\tif (entry.type === 'moreLink')\n\t\t{\n\t\t\trowWrap = this.DOM.entrieListWrap.appendChild(BX.create('DIV', {\n\t\t\t\tprops: { className: 'calendar-planner-user' }\n\t\t\t}));\n\n\t\t\tif (this.showEntryName)\n\t\t\t{\n\t\t\t\tthis.DOM.showMoreUsersLink = rowWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'calendar-planner-all-users',\n\t\t\t\t\t\ttitle: entry.title || ''\n\t\t\t\t\t},\n\t\t\t\t\ttext: entry.name,\n\t\t\t\t\tevents: {'click': this.showMoreUsers.bind(this)}\n\t\t\t\t}));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.showMoreUsersLink = rowWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'calendar-planner-users-more',\n\t\t\t\t\t\ttitle: entry.name\n\t\t\t\t\t},\n\t\t\t\t\thtml: '<span class=\"calendar-planner-users-more-btn\"></span>',\n\t\t\t\t\tevents: {'click': this.showMoreUsers.bind(this)}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\telse if (entry.type === 'lastUsers')\n\t\t{\n\t\t\trowWrap = this.DOM.entrieListWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-user'}}));\n\n\t\t\tif (this.showEntryName)\n\t\t\t{\n\t\t\t\tthis.DOM.showMoreUsersLink = rowWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'calendar-planner-all-users calendar-planner-last-users',\n\t\t\t\t\t\ttitle: entry.title || ''\n\t\t\t\t\t},\n\t\t\t\t\ttext: entry.name\n\t\t\t\t}));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.showMoreUsersLink = rowWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'calendar-planner-users-more',\n\t\t\t\t\t\ttitle: entry.title || entry.name\n\t\t\t\t\t},\n\t\t\t\t\thtml: '<span class=\"calendar-planner-users-last-btn\"></span>'\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\telse if (entry.id && entry.type === 'user')\n\t\t{\n\t\t\trowWrap = this.DOM.entrieListWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\tattrs: {\n\t\t\t\t\t'data-bx-planner-entry' : entry.uid,\n\t\t\t\t\tclassName: 'calendar-planner-user' + (entry.emailUser ? ' calendar-planner-email-user' : '')\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tif (entry.status && this.entryStatusMap[entry.status])\n\t\t\t{\n\t\t\t\trowWrap.appendChild(BX.create(\"span\", {props: {className: 'calendar-planner-user-status-icon ' + this.entryStatusMap[entry.status], title: Loc.getMessage('EC_PL_STATUS_' + entry.status.toUpperCase())}}));\n\t\t\t}\n\n\t\t\trowWrap.appendChild(Planner.getEntryAvatarNode(entry));\n\n\t\t\tif (this.showEntryName)\n\t\t\t{\n\t\t\t\trowWrap.appendChild(\n\t\t\t\t\tBX.create(\"span\", {props: {className: 'calendar-planner-user-name'}})).appendChild(\n\t\t\t\t\tBX.create(\"span\", {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'calendar-planner-entry-name'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t'bx-tooltip-user-id': entry.id,\n\t\t\t\t\t\t\t'bx-tooltip-classname': 'calendar-planner-user-tooltip'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\twidth: (this.entriesListWidth - 42) + 'px'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: entry.name\n\t\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\telse if (entry.id && entry.type === 'room')\n\t\t{\n\t\t\trowWrap = this.DOM.entrieListWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-user'}}));\n\n\t\t\tif (this.showEntryName)\n\t\t\t{\n\t\t\t\trowWrap.appendChild(BX.create(\"span\", {props: {className: 'calendar-planner-user-name'}}))\n\t\t\t\t\t.appendChild(BX.create(\"span\", {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'calendar-planner-entry-name'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\twidth: (this.entriesListWidth - 20) + 'px'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: entry.name\n\t\t\t\t}));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\trowWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-location-image-icon', title: entry.name}}));\n\t\t\t}\n\t\t}\n\t\telse if (entry.type === 'resource')\n\t\t{\n\t\t\tif (!this.entriesResourceListWrap || !BX.isNodeInDom(this.entriesResourceListWrap))\n\t\t\t{\n\t\t\t\tthis.entriesResourceListWrap = this.DOM.entrieListWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: 'calendar-planner-container-resource'},\n\t\t\t\t\thtml: '<div class=\"calendar-planner-resource-header\"><span class=\"calendar-planner-users-item\">' + Loc.getMessage('EC_PL_RESOURCE_TITLE') + '</span></div>'\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\trowWrap = this.entriesResourceListWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\tattrs: {\n\t\t\t\t\t'data-bx-planner-entry' : entry.uid,\n\t\t\t\t\tclassName: 'calendar-planner-user'\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tif (this.showEntryName)\n\t\t\t{\n\t\t\t\trowWrap.appendChild(BX.create(\"span\", {props: {className: 'calendar-planner-user-name'}}))\n\t\t\t\t\t.appendChild(BX.create(\"span\", {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'calendar-planner-entry-name'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\twidth: (this.entriesListWidth - 20) + 'px'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: entry.name\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\trowWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-location-image-icon', title: entry.name}}));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\trowWrap = this.DOM.entrieListWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-user'}}));\n\n\t\t\trowWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\tprops: {className: 'calendar-planner-all-users'},\n\t\t\t\ttext: entry.name\n\t\t\t}));\n\t\t}\n\n\t\tlet top = rowWrap.offsetTop + 13;\n\n\t\tlet dataRowWrap = this.DOM.accessibilityWrap.appendChild(Tag.render`<div class=\"calendar-planner-timeline-space\" style=\"top:${top}px\" data-bx-planner-entry=\"${entry.uid||0}\"></div>`);\n\n\t\tif (this.selectMode)\n\t\t{\n\t\t\tentry.selectorControlWrap = this.selector.controlWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\tattrs: {\n\t\t\t\t\t'data-bx-planner-entry' : entry.uid,\n\t\t\t\t\tclassName: 'calendar-planner-selector-control-row'\n\t\t\t\t},\n\t\t\t\tstyle: {\n\t\t\t\t\ttop: (top - 4) + 'px'\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tif (entry.selected)\n\t\t\t{\n\t\t\t\tthis.selectEntryRow(entry);\n\t\t\t}\n\t\t}\n\n\t\t//this.entriesRowMap.set(entry, rowWrap);\n\t\tthis.entriesDataRowMap.set(entry.uid, dataRowWrap);\n\t\taccessibility.forEach((item) => {\n\t\t\titem = Planner.prepareAccessibilityItem(item);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tthis.addAccessibilityItem(item, dataRowWrap);\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic getEntryAvatarNode(entry)\n\t{\n\t\tlet imageNode;\n\t\tconst img = entry.avatar;\n\n\t\tif (!img || img === \"/bitrix/images/1.gif\")\n\t\t{\n\t\t\timageNode = Tag.render`<div bx-tooltip-user-id=\"${entry.id}\" bx-tooltip-classname=\"calendar-planner-user-tooltip\" title=\"${Text.encode(entry.name)}\" class=\"ui-icon calendar-planner-user-image-icon ${(entry.emailUser ? 'ui-icon-common-user-mail' : 'ui-icon-common-user')}\"><i></i></div>`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\timageNode = Tag.render`<div bx-tooltip-user-id=\"${entry.id}\" bx-tooltip-classname=\"calendar-planner-user-tooltip\" title=\"${Text.encode(entry.name)}\" class=\"ui-icon calendar-planner-user-image-icon\"><i style=\"background-image: url('${entry.avatar}')\"></i></div>`;\n\t\t}\n\t\treturn imageNode;\n\t}\n\n\tselectEntryRow(entry)\n\t{\n\t\tif (BX.type.isPlainObject(entry))\n\t\t{\n\t\t\tlet top = parseInt(entry.dataRowWrap.offsetTop);\n\t\t\tif (!entry.selectWrap || !BX.isParentForNode(this.selectedEntriesWrap, entry.selectWrap))\n\t\t\t{\n\t\t\t\tentry.selectWrap = this.selectedEntriesWrap.appendChild(BX.create(\"DIV\", {props: {className: 'calendar-planner-timeline-selected'}}));\n\t\t\t}\n\n\t\t\tentry.selectWrap.style.display = '';\n\t\t\tentry.selectWrap.style.top = (top + 36) + 'px';\n\t\t\tentry.selectWrap.style.width = (parseInt(this.DOM.mainWrap.offsetWidth) + 5) + 'px';\n\n\t\t\tDom.addClass(entry.selectorControlWrap, 'active');\n\t\t\tentry.selected = true;\n\n\t\t\tthis.clearCacheTime();\n\t\t}\n\t}\n\n\tisEntrySelected(entry)\n\t{\n\t\treturn entry && entry.selected;\n\t}\n\n\tdeSelectEntryRow(entry)\n\t{\n\t\tif (BX.type.isPlainObject(entry))\n\t\t{\n\t\t\tif (entry.selectWrap)\n\t\t\t{\n\t\t\t\tentry.selectWrap.style.display = 'none';\n\t\t\t}\n\t\t\tif (entry.selectorControlWrap)\n\t\t\t{\n\t\t\t\tDom.removeClass(entry.selectorControlWrap, 'active');\n\t\t\t}\n\t\t\tentry.selected = false;\n\t\t\tthis.clearCacheTime();\n\t\t}\n\t}\n\n\tstatic getEntryUniqueId(entry)\n\t{\n\t\treturn ['user', 'room'].includes(entry.type) ? entry.id : entry.type + '-' + entry.id;\n\t}\n\n\tgetEntryByUniqueId(entryUniqueId)\n\t{\n\t\tif (BX.type.isArray(this.entries))\n\t\t{\n\t\t\treturn this.entries.find(function(entry){return entry.uid == entryUniqueId;})\n\t\t}\n\t\treturn null;\n\t}\n\n\tbindEventHandlers()\n\t{\n\t\tEvent.bind(this.DOM.wrap, 'click', this.handleClick.bind(this));\n\t\tEvent.bind(this.DOM.wrap, 'mousedown', BX.proxy(this.handleMousedown, this));\n\t\tEvent.bind(document, \"mousemove\", BX.proxy(this.handleMousemove, this));\n\t\tEvent.bind(document, \"mouseup\", BX.proxy(this.handleMouseup, this));\n\n\t\tif ('onwheel' in document)\n\t\t{\n\t\t\tEvent.bind(this.DOM.timelineFixedWrap, \"wheel\", this.mouseWheelTimelineHandler.bind(this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEvent.bind(this.DOM.timelineFixedWrap, \"mousewheel\", this.mouseWheelTimelineHandler.bind(this));\n\t\t}\n\t}\n\n\thandleClick(e)\n\t{\n\t\tif (!e)\n\t\t{\n\t\t\te = window.event;\n\t\t}\n\n\t\tthis.clickMousePos = this.getMousePos(e);\n\t\tlet\n\t\t\tnodeTarget = e.target || e.srcElement,\n\t\t\taccuracyMouse = 5;\n\n\n\t\tif (this.selectMode &&\n\t\t\tDom.hasClass(nodeTarget, 'calendar-planner-selector-control-row'))\n\t\t{\n\t\t\tlet entry = this.getEntryByUniqueId(nodeTarget.getAttribute('data-bx-planner-entry'));\n\t\t\tif (entry)\n\t\t\t{\n\t\t\t\tif (!this.isEntrySelected(entry))\n\t\t\t\t{\n\t\t\t\t\tthis.selectEntryRow(entry);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.deSelectEntryRow(entry);\n\t\t\t\t}\n\n\t\t\t\tthis.selector.checkStatus();\n\n\t\t\t\tBX.onCustomEvent('OnCalendarPlannerSelectedEntriesOnChange', [{\n\t\t\t\t\tplannerId: this.id,\n\t\t\t\t\tentries: this.entries\n\t\t\t\t}]);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.readonly)\n\t\t{\n\t\t\tlet\n\t\t\t\ttimeline = this.findTarget(nodeTarget, 'timeline'),\n\t\t\t\tselector = this.findTarget(nodeTarget, 'selector');\n\n\t\t\tif (timeline && !selector && Math.abs(this.clickMousePos.x - this.mouseDownMousePos.x) < accuracyMouse && Math.abs(this.clickMousePos.y - this.mouseDownMousePos.y) < accuracyMouse)\n\t\t\t{\n\t\t\t\tlet left = this.clickMousePos.x - BX.pos(this.DOM.timelineFixedWrap).left + this.DOM.timelineFixedWrap.scrollLeft;\n\n\t\t\t\tif (this.clickSelectorScaleAccuracy !== this.accuracy)\n\t\t\t\t{\n\t\t\t\t\tlet mapDatePosRes = this.mapDatePos(this.clickSelectorScaleAccuracy);\n\t\t\t\t\tlet dateFrom = this.getDateByPos(left, false, mapDatePosRes.posDateMap);\n\t\t\t\t\tleft = this.getPosByDate(dateFrom);\n\t\t\t\t}\n\n\t\t\t\tthis.selector.transit({toX: left});\n\t\t\t}\n\t\t}\n\t}\n\n\thandleMousedown(e)\n\t{\n\t\tif (!e)\n\t\t{\n\t\t\te = window.event;\n\t\t}\n\n\t\tlet nodeTarget = e.target || e.srcElement;\n\t\tthis.mouseDownMousePos = this.getMousePos(e);\n\t\tthis.mouseDown = true;\n\n\t\tif (!this.readonly)\n\t\t{\n\t\t\tlet selector = this.findTarget(nodeTarget, 'selector');\n\t\t\tthis.startMousePos = this.mouseDownMousePos;\n\n\t\t\tif (selector)\n\t\t\t{\n\t\t\t\tif (this.findTarget(nodeTarget, 'selector-resize-right'))\n\t\t\t\t{\n\t\t\t\t\tthis.selector.startResize();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.selector.startMove();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.findTarget(nodeTarget, 'timeline'))\n\t\t\t{\n\t\t\t\tthis.startScrollTimeline();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleMouseup()\n\t{\n\t\tif (this.selector.isDragged())\n\t\t{\n\t\t\tthis.selector.endMove();\n\t\t\tthis.selector.endResize();\n\t\t}\n\n\t\tif(this.timelineIsDraged)\n\t\t{\n\t\t\tthis.endScrollTimeline();\n\t\t}\n\n\t\tif (this.shown && !this.readonly && this.mouseDown)\n\t\t{\n\t\t\tthis.checkTimelineScroll();\n\t\t}\n\n\t\tthis.mouseDown = false;\n\t\tDom.removeClass(document.body, 'calendar-planner-unselectable');\n\t}\n\n\thandleMousemove(e)\n\t{\n\t\tlet\n\t\t\tmousePos,\n\t\t\ttarget = e.target || e.srcElement;\n\n\t\tif (this.selectMode && target && target.getAttribute && target.getAttribute('data-bx-planner-entry'))\n\t\t{\n\t\t\tthis.lastTouchedEntry = target;\n\t\t}\n\n\t\tif (this.selector.isDragged())\n\t\t{\n\t\t\tmousePos = this.getMousePos(e);\n\t\t\tthis.selector.move(mousePos.x - this.startMousePos.x);\n\t\t\tthis.selector.resize(mousePos.x - this.startMousePos.x);\n\t\t}\n\n\t\tif(this.timelineIsDraged)\n\t\t{\n\t\t\tmousePos = this.getMousePos(e);\n\t\t\tthis.scrollTimeline(mousePos.x - this.startMousePos.x);\n\t\t}\n\t}\n\n\tmouseWheelTimelineHandler(e)\n\t{\n\t\te = e || window.event;\n\t\tif (this.shown && !this.readonly)\n\t\t{\n\t\t\tlet delta = e.deltaY || e.detail || e.wheelDelta;\n\t\t\tif (Math.abs(delta) > 0)\n\t\t\t{\n\t\t\t\tlet newScroll = this.DOM.timelineFixedWrap.scrollLeft + Math.round(delta / 3);\n\t\t\t\tthis.DOM.timelineFixedWrap.scrollLeft = Math.max(newScroll, 0);\n\t\t\t\tthis.checkTimelineScroll();\n\t\t\t\treturn BX.PreventDefault(e);\n\t\t\t}\n\t\t}\n\t}\n\n\n\tcheckTimelineScroll()\n\t{\n\t\tlet\n\t\t\tminScroll = this.scrollStep,\n\t\t\tmaxScroll = this.DOM.timelineFixedWrap.scrollWidth - this.DOM.timelineFixedWrap.offsetWidth - this.scrollStep;\n\n\t\t// Check and expand only if it is visible\n\t\tif (this.DOM.timelineFixedWrap.offsetWidth > 0)\n\t\t{\n\t\t\tif (this.DOM.timelineFixedWrap.scrollLeft <= minScroll)\n\t\t\t{\n\t\t\t\tRuntime.debounce(()=>{this.expandTimeline('left')}, this.EXPAND_DELAY)();\n\t\t\t}\n\t\t\telse if (this.DOM.timelineFixedWrap.scrollLeft >= maxScroll)\n\t\t\t{\n\t\t\t\tRuntime.debounce(()=>{this.expandTimeline('right')}, this.EXPAND_DELAY)();\n\t\t\t}\n\t\t}\n\t}\n\n\tstartScrollTimeline()\n\t{\n\t\tthis.timelineIsDraged = true;\n\t\tthis.timelineStartScrollLeft = this.DOM.timelineFixedWrap.scrollLeft;\n\t}\n\tscrollTimeline(x)\n\t{\n\t\tthis.DOM.timelineFixedWrap.scrollLeft = Math.max(this.timelineStartScrollLeft - x, 0);\n\t}\n\tendScrollTimeline()\n\t{\n\t\tthis.timelineIsDraged = false;\n\t}\n\n\tfindTarget(node, nodeMetaType, parentCont)\n\t{\n\t\tif (!parentCont)\n\t\t\tparentCont = this.DOM.mainWrap;\n\n\t\tlet type = (node && node.getAttribute) ? node.getAttribute('data-bx-planner-meta') : null;\n\n\t\tif (type !== nodeMetaType)\n\t\t{\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tnode = BX.findParent(node, function(n)\n\t\t\t\t{\n\t\t\t\t\treturn n.getAttribute && n.getAttribute('data-bx-planner-meta') === nodeMetaType;\n\t\t\t\t}, parentCont);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnode = null;\n\t\t\t}\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tgetMousePos(e)\n\t{\n\t\tif (!e)\n\t\t\te = window.event;\n\n\t\tlet x = 0, y = 0;\n\t\tif (e.pageX || e.pageY)\n\t\t{\n\t\t\tx = e.pageX;\n\t\t\ty = e.pageY;\n\t\t}\n\t\telse if (e.clientX || e.clientY)\n\t\t{\n\t\t\tx = e.clientX + (document.documentElement.scrollLeft || document.body.scrollLeft) - document.documentElement.clientLeft;\n\t\t\ty = e.clientY + (document.documentElement.scrollTop || document.body.scrollTop) - document.documentElement.clientTop;\n\t\t}\n\n\t\treturn {x: x, y: y};\n\t}\n\n\tsetScaleType(scaleType)\n\t{\n\t\tif (!this.scaleTypes.includes(scaleType))\n\t\t{\n\t\t\tscaleType = '1hour';\n\t\t}\n\n\t\tthis.scaleType = scaleType;\n\t\tthis.scaleSize = Planner.getScaleSize(scaleType);\n\n\t\tif (this.isOneDayScale() && this.timelineCellWidth < 100)\n\t\t{\n\t\t\tthis.timelineCellWidthOrig = this.timelineCellWidth;\n\t\t\tthis.timelineCellWidth = 100;\n\t\t}\n\t\telse if (!this.isOneDayScale() && this.timelineCellWidthOrig)\n\t\t{\n\t\t\tthis.timelineCellWidth = this.timelineCellWidthOrig;\n\t\t\tthis.timelineCellWidthOrig = false;\n\t\t}\n\n\t\tif (this.isOneDayScale())\n\t\t{\n\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-fulldaymode');\n\t\t\tif (this.DOM.entriesOuterWrap)\n\t\t\t{\n\t\t\t\tDom.addClass(this.DOM.entriesOuterWrap, 'calendar-planner-no-daytitle');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.DOM.mainWrap, 'calendar-planner-fulldaymode');\n\t\t\tif (this.DOM.entriesOuterWrap)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.DOM.entriesOuterWrap, 'calendar-planner-no-daytitle');\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getScaleSize(scaleType)\n\t{\n\t\tlet\n\t\t\thour = 3600,\n\t\t\tmap = {\n\t\t\t\t'15min' : Math.round(hour / 4),\n\t\t\t\t'30min' : Math.round(hour / 2),\n\t\t\t\t'1hour' : hour,\n\t\t\t\t'2hour' : hour * 2,\n\t\t\t\t'1day' : hour * 24\n\t\t\t};\n\n\t\treturn map[scaleType] || hour;\n\t}\n\n\tmapDatePos(accuracy)\n\t{\n\t\tif (!accuracy)\n\t\t{\n\t\t\taccuracy = this.accuracy;\n\t\t}\n\n\t\tlet datePosMap = {};\n\t\tlet posDateMap = {};\n\t\tlet i, j, tsi, xi, tsj, xj, cellWidth;\n\n\t\tthis.substeps = Math.round(this.scaleSize / accuracy);\n\t\tthis.posAccuracy = this.timelineCellWidth / this.substeps;\n\n\t\taccuracy = accuracy * 1000;\n\t\tlet scaleSize = this.scaleData[1].timestamp - this.scaleData[0].timestamp;\n\n\t\tfor (i = 0; i < this.scaleData.length; i++)\n\t\t{\n\t\t\ttsi = this.scaleData[i].timestamp;\n\t\t\txi = parseInt(this.scaleData[i].cell.offsetLeft);\n\t\t\tcellWidth = parseInt(this.scaleData[i].cell.offsetWidth);\n\n\t\t\tif (!datePosMap[tsi])\n\t\t\t{\n\t\t\t\tdatePosMap[tsi] = xi;\n\t\t\t}\n\t\t\tposDateMap[xi] = tsi;\n\n\t\t\tfor (j = 1; j <= cellWidth; j++)\n\t\t\t{\n\t\t\t\ttsj = tsi + Math.round((j * scaleSize / cellWidth) / accuracy) * accuracy;\n\t\t\t\txj = xi + j;\n\t\t\t\tif (!datePosMap[tsi])\n\t\t\t\t{\n\t\t\t\t\tdatePosMap[tsj] = xj;\n\t\t\t\t}\n\t\t\t\tposDateMap[xj] = tsj;\n\n\t\t\t\tif (j === cellWidth &&\n\t\t\t\t\t(!this.scaleData[i + 1] || this.scaleData[i + 1].dayStart))\n\t\t\t\t{\n\t\t\t\t\tdatePosMap[xj + '_end'] = tsj;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tdatePosMap: datePosMap,\n\t\t\tposDateMap: posDateMap\n\t\t}\n\t}\n\n\tgetPosByDate(date)\n\t{\n\t\tlet x = 0;\n\t\tif (date && typeof date !== 'object')\n\t\t{\n\t\t\tdate = Util.parseDate(date);\n\t\t}\n\n\t\tif (date && typeof date === 'object')\n\t\t{\n\t\t\tlet\n\t\t\t\ti, curInd = 0,\n\t\t\t\ttimestamp = date.getTime();\n\n\t\t\tfor (i = 0; i < this.scaleData.length; i++)\n\t\t\t{\n\t\t\t\tif (timestamp >= this.scaleData[i].timestamp)\n\t\t\t\t{\n\t\t\t\t\tcurInd = i;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.scaleData[curInd] && this.scaleData[curInd].cell)\n\t\t\t{\n\t\t\t\tx = this.scaleData[curInd].cell.offsetLeft;\n\t\t\t\tlet cellWidth = this.scaleData[curInd].cell.offsetWidth, deltaTs = Math.round((timestamp - this.scaleData[curInd].timestamp) / 1000);\n\n\t\t\t\tif (deltaTs > 0)\n\t\t\t\t{\n\t\t\t\t\tx += Math.round(deltaTs * 10 / this.scaleSize * cellWidth) / 10;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn x;\n\t}\n\n\tgetDateByPos(x, end, posDateMap)\n\t{\n\t\tif (!posDateMap)\n\t\t{\n\t\t\tposDateMap = this.posDateMap;\n\t\t}\n\t\tlet\n\t\t\tdate,\n\t\t\ttimestamp = (end && posDateMap[x + '_end']) ? posDateMap[x + '_end'] : posDateMap[x];\n\n\t\tif (!timestamp)\n\t\t{\n\t\t\tx = Math.round(x);\n\t\t\ttimestamp = (end && posDateMap[x + '_end']) ?  posDateMap[x + '_end'] : posDateMap[x];\n\t\t}\n\n\t\tif (timestamp)\n\t\t{\n\t\t\tdate = new Date(timestamp);\n\t\t}\n\n\t\treturn date;\n\t}\n\n\tshowMoreUsers()\n\t{\n\t\tthis.MIN_ENTRY_ROWS = this.MAX_ENTRY_ROWS;\n\t\tthis.update(this.entries, this.accessibility);\n\t\tthis.rebuildDebounce();\n\t}\n\n\tadjustHeight()\n\t{\n\t\tlet\n\t\t\tnewHeight = this.DOM.entrieListWrap.offsetHeight + this.DOM.entrieListWrap.offsetTop + 30,\n\t\t\tcurrentHeight = parseInt(this.DOM.wrap.style.height) || this.height;\n\n\t\tif (this.compactMode && currentHeight < newHeight || !this.compactMode)\n\t\t{\n\t\t\tthis.DOM.wrap.style.height = currentHeight + 'px';\n\t\t\tthis.resizePlannerHeight(newHeight, Math.abs(newHeight - currentHeight) > 10);\n\t\t}\n\t}\n\n\tresizePlannerHeight(height, animation = false)\n\t{\n\t\tthis.height = height;\n\t\tif (animation)\n\t\t{\n\t\t\t// Stop animation before starting another one\n\t\t\tif(this.resizeAnimation)\n\t\t\t{\n\t\t\t\tthis.resizeAnimation.stop();\n\t\t\t\tthis.resizeAnimation = null;\n\t\t\t}\n\t\t\tthis.resizeAnimation = new BX.easing({\n\t\t\t\tduration: 800,\n\t\t\t\tstart: {height: parseInt(this.DOM.wrap.style.height)},\n\t\t\t\tfinish: {height: height},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tthis.resizePlannerHeight(state.height, false);\n\t\t\t\t},\n\t\t\t\tcomplete: () => {this.resizeAnimation = null;}\n\t\t\t});\n\t\t\tthis.resizeAnimation.animate();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.wrap.style.height = height + 'px';\n\t\t\tthis.DOM.mainWrap.style.height = height + 'px';\n\t\t\tthis.DOM.timelineFixedWrap.style.height = height + 'px';\n\t\t\tlet timelineDataContHeight = this.DOM.entrieListWrap.offsetHeight + 3;\n\t\t\tthis.DOM.timelineDataWrap.style.height = timelineDataContHeight + 'px';\n\t\t\t// Todo: resize selector\n\t\t\t//this.selector.wrap.style.height = (timelineDataContHeight + 10) + 'px';\n\t\t\tthis.DOM.entriesOuterWrap.style.height = height + 'px';\n\n\t\t\tif (this.DOM.proposeTimeButton && this.DOM.proposeTimeButton.style.display !== \"none\")\n\t\t\t{\n\t\t\t\tthis.DOM.proposeTimeButton.style.top = (this.DOM.timelineDataWrap.offsetTop + timelineDataContHeight / 2 - 16) + \"px\";\n\t\t\t}\n\t\t}\n\t}\n\n\tresizePlannerWidth(width, animation)\n\t{\n\t\tif (!animation && this.DOM.wrap && this.DOM.mainWrap)\n\t\t{\n\t\t\tthis.DOM.wrap.style.width = width + 'px';\n\t\t\tlet entriesListWidth = this.compactMode ? 0 : this.entriesListWidth;\n\t\t\tthis.DOM.mainWrap.style.width = width + 'px';\n\t\t\tthis.DOM.entriesOuterWrap.style.width = entriesListWidth + 'px';\n\t\t}\n\t}\n\n\t// ExpandFromCompactMode()\n\t// {\n\t// \tthis.readonly = false;\n\t// \tthis.compactMode = false;\n\t// \tthis.showTimelineDayTitle = true;\n\t// \tDom.removeClass(this.DOM.mainWrap, 'calendar-planner-readonly');\n\t// \tDom.removeClass(this.DOM.mainWrap, 'calendar-planner-compact');\n\t// \tthis.DOM.entriesOuterWrap.style.display = '';\n\t//\n\t// \tif (this.scaleDateFrom && this.scaleDateFrom.getTime)\n\t// \t{\n\t// \t\tthis.scaleDateFrom = new Date(this.scaleDateFrom.getTime() - Util.getDayLength() * this.SCALE_OFFSET_BEFORE /* days before */);\n\t// \t}\n\t//\n\t// \tif (this.scaleDateTo && this.scaleDateTo.getTime)\n\t// \t{\n\t// \t\tthis.scaleDateTo = new Date(this.scaleDateTo.getTime() + Util.getDayLength() * this.SCALE_OFFSET_AFTER /* days after */);\n\t// \t}\n\t//\n\t// \tthis.rebuild();\n\t//\n\t// \tthis.FocusSelector(false, 300);\n\t// }\n\n\texpandTimeline(direction, scaleDateFrom, scaleDateTo)\n\t{\n\t\tlet loadedTimelineSize;\n\t\tlet scrollLeft;\n\t\tconst prevScaleDateFrom = this.scaleDateFrom;\n\t\tconst prevScaleDateTo = this.scaleDateTo;\n\n\t\tif (!scaleDateFrom)\n\t\t\tscaleDateFrom = this.scaleDateFrom;\n\t\tif (!scaleDateTo)\n\t\t\tscaleDateTo = this.scaleDateTo;\n\n\t\tif (direction === 'left')\n\t\t{\n\t\t\tlet oldScaleDateFrom = new Date(this.scaleDateFrom.getTime());\n\t\t\tthis.scaleDateFrom = new Date(scaleDateFrom.getTime() - Util.getDayLength()  * this.EXPAND_OFFSET);\n\n\t\t\tloadedTimelineSize = (this.scaleDateTo.getTime() - this.scaleDateFrom.getTime()) / Util.getDayLength();\n\t\t\tif (loadedTimelineSize > this.maxTimelineSize)\n\t\t\t{\n\t\t\t\tthis.scaleDateTo = new Date(this.scaleDateFrom.getTime() + Util.getDayLength()  * this.maxTimelineSize);\n\t\t\t\tthis.loadedDataFrom = this.scaleDateFrom;\n\t\t\t\tthis.loadedDataTo = this.scaleDateTo;\n\t\t\t\tthis.limitScaleSizeMode = true;\n\t\t\t}\n\t\t\tscrollLeft = this.getPosByDate(oldScaleDateFrom);\n\t\t}\n\t\telse if (direction === 'right')\n\t\t{\n\t\t\tlet oldDateTo = this.scaleDateTo;\n\t\t\tscrollLeft = this.DOM.timelineFixedWrap.scrollLeft;\n\t\t\tthis.scaleDateTo = new Date(scaleDateTo.getTime() + Util.getDayLength() * this.EXPAND_OFFSET);\n\t\t\tloadedTimelineSize = (this.scaleDateTo.getTime() - this.scaleDateFrom.getTime()) / Util.getDayLength();\n\n\t\t\tif (loadedTimelineSize > this.maxTimelineSize)\n\t\t\t{\n\t\t\t\tthis.scaleDateFrom = new Date(this.scaleDateTo.getTime() - Util.getDayLength()  * this.maxTimelineSize);\n\t\t\t\tthis.loadedDataFrom = this.scaleDateFrom;\n\t\t\t\tthis.loadedDataTo = this.scaleDateTo;\n\n\t\t\t\tscrollLeft = this.getPosByDate(oldDateTo) - this.DOM.timelineFixedWrap.offsetWidth;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.DOM.timelineFixedWrap.scrollLeft = this.getPosByDate(oldDateTo) - this.DOM.timelineFixedWrap.offsetWidth;\n\t\t\t\t}, 10);\n\n\t\t\t\tthis.limitScaleSizeMode = true;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.scaleDateFrom = new Date(scaleDateFrom.getTime() - Util.getDayLength()  * this.SCALE_OFFSET_BEFORE);\n\t\t\tthis.scaleDateTo = new Date(scaleDateTo.getTime() + Util.getDayLength() * this.SCALE_OFFSET_AFTER);\n\t\t}\n\n\t\tconst reloadData = this.scaleDateFrom.getTime() < prevScaleDateFrom.getTime()\n\t\t|| this.scaleDateTo.getTime() > prevScaleDateTo.getTime();\n\n\t\tthis.emit('onExpandTimeline', new BaseEvent({\n\t\t\tdata: {\n\t\t\t\treload: reloadData,\n\t\t\t\tdateFrom: this.scaleDateFrom,\n\t\t\t\tdateTo: this.scaleDateTo\n\t\t\t} }));\n\n\t\tthis.rebuildDebounce();\n\n\t\tif (scrollLeft !== undefined)\n\t\t{\n\t\t\tthis.DOM.timelineFixedWrap.scrollLeft = scrollLeft;\n\t\t}\n\t}\n\n\tupdate(entries = [], accessibility = {})\n\t{\n\t\tDom.clean(this.DOM.entrieListWrap);\n\t\tDom.clean(this.DOM.accessibilityWrap);\n\t\tthis.entriesDataRowMap = new Map();\n\n\t\tif (!Type.isArray(entries))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.entries = entries;\n\t\tthis.accessibility = accessibility;\n\n\t\tlet\n\t\t\ti, k, entry, acc,\n\t\t\tuserId = parseInt(this.userId);\n\n\t\t// Compact mode\n\t\tif (this.compactMode)\n\t\t{\n\t\t\t// let data = [];\n\t\t\t// for (k in params.accessibility)\n\t\t\t// {\n\t\t\t// \tif (params.accessibility.hasOwnProperty(k) && params.accessibility[k] && params.accessibility[k].length > 0)\n\t\t\t// \t{\n\t\t\t// \t\tfor (i = 0; i < params.accessibility[k].length; i++)\n\t\t\t// \t\t{\n\t\t\t// \t\t\tdata.push(Planner.prepareAccessibilityItem(params.accessibility[k][i]));\n\t\t\t// \t\t}\n\t\t\t// \t}\n\t\t\t// }\n\t\t\t//\n\t\t\t// this.compactRowWrap = this.accessibilityWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t// \tprops: {className: 'calendar-planner-timeline-space'},\n\t\t\t// \tstyle: {}\n\t\t\t// }));\n\t\t\t//\n\t\t\t// this.currentData = [data];\n\t\t\t// for (i = 0; i < data.length; i++)\n\t\t\t// {\n\t\t\t// \tthis.addAccessibilityItem(data[i], this.compactRowWrap);\n\t\t\t// }\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// sort entries list by amount of accessibilities data\n\t\t\t// Enties without accessibilitity data should be in the end of the array\n\t\t\t// But first in the list will be meeting room\n\t\t\t// And second (or first) will be owner-host of the event\n\t\t\tentries.sort((a, b) => {\n\t\t\t\tif (b.status === 'h' || parseInt(b.id) === userId && a.status !== 'h')\n\t\t\t\t\treturn 1;\n\t\t\t\tif (a.status === 'h' || parseInt(a.id) === userId && b.status !== 'h')\n\t\t\t\t\treturn  -1;\n\t\t\t\treturn 0;\n\t\t\t});\n\n\t\t\tif (this.selectedEntriesWrap)\n\t\t\t{\n\t\t\t\tDom.clean(this.selectedEntriesWrap);\n\t\t\t\tif (this.selector && this.selector.controlWrap)\n\t\t\t\t{\n\t\t\t\t\tDom.clean(this.selector.controlWrap);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet\n\t\t\t\tcutData = [],\n\t\t\t\tusersCount = 0,\n\t\t\t\tcutAmount = 0,\n\t\t\t\tdispDataCount = 0,\n\t\t\t\tcutDataTitle = [];\n\n\t\t\tentries.forEach((entry, ind) => {\n\t\t\t\tentry.uid = Planner.getEntryUniqueId(entry);\n\n\t\t\t\tlet accData = Type.isArray(accessibility[entry.uid]) ? accessibility[entry.uid] : [];\n\t\t\t\tthis.entriesIndex.set(entry.uid, entry);\n\n\t\t\t\tif (entry.type === 'user')\n\t\t\t\t{\n\t\t\t\t\tusersCount++;\n\t\t\t\t}\n\n\t\t\t\tif (ind < this.MIN_ENTRY_ROWS || entries.length === this.MIN_ENTRY_ROWS + 1)\n\t\t\t\t{\n\t\t\t\t\tdispDataCount++;\n\t\t\t\t\tthis.displayEntryRow(entry, accData);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcutAmount++;\n\t\t\t\t\tcutDataTitle.push(entry.name);\n\t\t\t\t\taccData.forEach((item) => {\n\t\t\t\t\t\titem = Planner.prepareAccessibilityItem(item);\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcutData.push(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Update entries title count\n\t\t\tif (this.entriesListTitleCounter)\n\t\t\t{\n\t\t\t\tthis.entriesListTitleCounter.innerHTML = usersCount > this.MAX_ENTRY_ROWS ? '(' + usersCount + ')' : '';\n\t\t\t}\n\n\t\t\tif (cutAmount > 0)\n\t\t\t{\n\t\t\t\tif (dispDataCount === this.MAX_ENTRY_ROWS)\n\t\t\t\t{\n\t\t\t\t\tthis.displayEntryRow({\n\t\t\t\t\t\tname: Loc.getMessage('EC_PL_ATTENDEES_LAST') + ' (' + cutAmount + ')',\n\t\t\t\t\t\ttype: 'lastUsers',\n\t\t\t\t\t\ttitle: cutDataTitle.join(', ')\n\t\t\t\t\t}, cutData);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.displayEntryRow({\n\t\t\t\t\t\tname: Loc.getMessage('EC_PL_ATTENDEES_SHOW_MORE') + ' (' + cutAmount + ')',\n\t\t\t\t\t\ttype: 'moreLink'\n\t\t\t\t\t}, cutData);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tUtil.extendPlannerWatches({entries: entries, userId: this.userId});\n\n\t\tthis.adjustHeight();\n\t}\n\n\tupdateAccessibility(accessibility)\n\t{\n\t\tthis.accessibility = accessibility;\n\t\tif (Type.isPlainObject(accessibility))\n\t\t{\n\t\t\tlet key;\n\t\t\tfor (key in accessibility)\n\t\t\t{\n\t\t\t\tif (accessibility.hasOwnProperty(key)\n\t\t\t\t\t&& Type.isArray(accessibility[key])\n\t\t\t\t\t&& accessibility[key].length)\n\t\t\t\t{\n\t\t\t\t\tlet wrap = this.entriesDataRowMap.get(key);\n\t\t\t\t\tif (Type.isDomNode(wrap))\n\t\t\t\t\t{\n\t\t\t\t\t\taccessibility[key].forEach((event) => {\n\t\t\t\t\t\t\tevent = Planner.prepareAccessibilityItem(event);\n\t\t\t\t\t\t\tif (event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.addAccessibilityItem(event, wrap)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateSelector(from, to, fullDay, options = {})\n\t{\n\t\tif (this.shown && this.selector)\n\t\t{\n\t\t\tthis.setFullDayMode(fullDay);\n\n\t\t\t// Update limits of scale\n\t\t\tif (!this.isOneDayScale())\n\t\t\t{\n\t\t\t\tif (Util.formatDate(from) !== Util.formatDate(to))\n\t\t\t\t{\n\t\t\t\t\tthis.extendScaleTime(0, 24);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet\n\t\t\t\t\t\ttimeFrom = parseInt(from.getHours()) + Math.floor(from.getMinutes() / 60),\n\t\t\t\t\t\ttimeTo = parseInt(to.getHours()) + Math.ceil(to.getMinutes() / 60);\n\n\t\t\t\t\tif (timeFrom < this.shownScaleTimeFrom)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.extendScaleTime(timeFrom, false);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (timeTo > this.shownScaleTimeTo)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.extendScaleTime(false, timeTo);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ((to.getTime() > this.scaleDateTo.getTime())\n\t\t\t\t||\n\t\t\t\tfrom.getTime() < this.scaleDateFrom.getTime())\n\t\t\t{\n\t\t\t\tthis.expandTimeline(false, from, to);\n\t\t\t}\n\n\t\t\tthis.selector.update({\n\t\t\t\tfrom: from,\n\t\t\t\tto: to,\n\t\t\t\tfullDay: fullDay\n\t\t\t});\n\n\t\t\tthis.selector.focus(false, 300);\n\t\t}\n\t}\n\n\thandleSelectorChanges(event)\n\t{\n\t\tif (event instanceof BaseEvent)\n\t\t{\n\t\t\tlet data = event.getData();\n\t\t\tthis.emit('onDateChange', new BaseEvent({data: data}));\n\t\t}\n\t}\n\n\tdoCheckSelectorStatus(event)\n\t{\n\t\tif (event instanceof BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tthis.clearCacheTime();\n\t\t\tconst selectorStatus = this.checkTimePeriod(data.dateFrom, data.dateTo) === true;\n\t\t\tthis.selector.setSelectorStatus(selectorStatus);\n\t\t\tif (selectorStatus)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.DOM.mainWrap, 'calendar-planner-selector-warning');\n\t\t\t\tthis.hideProposeControl();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(this.DOM.mainWrap, 'calendar-planner-selector-warning');\n\t\t\t\tthis.showProposeControl();\n\t\t\t}\n\t\t}\n\t}\n\n\tproposeTime(params = {})\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tlet\n\t\t\tcurTimestamp = Math.round(this.selector.getDateFrom().getTime() / (this.accuracy * 1000)) * this.accuracy * 1000,\n\t\t\tcurDate = new Date(curTimestamp),\n\t\t\tduration = this.selector.getDuration(),\n\t\t\tdata = [], k, i;\n\n\t\tcurDate.setSeconds(0,0);\n\t\tcurTimestamp = curDate.getTime();\n\n\t\tfor (k in this.accessibility)\n\t\t{\n\t\t\tif (this.accessibility.hasOwnProperty(k) && this.accessibility[k] && this.accessibility[k].length > 0)\n\t\t\t{\n\t\t\t\tfor (i = 0; i < this.accessibility[k].length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (this.accessibility[k][i].toTimestampReal >= curTimestamp)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet item = Planner.prepareAccessibilityItem(this.accessibility[k][i]);\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata.push(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdata.sort(function(a, b){return a.fromTimestamp - b.fromTimestamp});\n\n\t\tlet\n\t\t\tts = curTimestamp,\n\t\t\tcheckRes,\n\t\t\tdateFrom, dateTo, timeTo, timeFrom;\n\n\t\twhile (true)\n\t\t{\n\t\t\tdateFrom = new Date(ts);\n\t\t\tdateTo = new Date(ts + duration);\n\n\t\t\tif (!this.isOneDayScale())\n\t\t\t{\n\t\t\t\ttimeFrom = parseInt(dateFrom.getHours()) + dateFrom.getMinutes() / 60;\n\t\t\t\ttimeTo = parseInt(dateTo.getHours()) + dateTo.getMinutes() / 60;\n\n\t\t\t\tif (timeFrom <= this.shownScaleTimeFrom)\n\t\t\t\t{\n\t\t\t\t\tdateFrom.setHours(this.shownScaleTimeFrom, 0, 0, 0);\n\t\t\t\t\tts = dateFrom.getTime();\n\t\t\t\t\tdateTo = new Date(ts + duration);\n\t\t\t\t}\n\n\t\t\t\tif (timeTo > this.shownScaleTimeTo)\n\t\t\t\t{\n\t\t\t\t\tdateFrom = new Date(ts + Util.getDayLength() - 1000); // next day\n\t\t\t\t\tdateFrom.setHours(this.shownScaleTimeFrom, 0, 0, 0);\n\t\t\t\t\tts = dateFrom.getTime();\n\t\t\t\t\tdateTo = new Date(ts + duration);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.fullDayMode)\n\t\t\t{\n\t\t\t\tdateFrom.setHours(0, 0, 0, 0);\n\t\t\t\tdateTo.setHours(0, 0, 0, 0);\n\t\t\t}\n\n\t\t\tcheckRes = this.checkTimePeriod(dateFrom, dateTo, data);\n\n\t\t\tif (checkRes === true)\n\t\t\t{\n\t\t\t\tif (dateTo.getTime() > this.scaleDateTo.getTime())\n\t\t\t\t{\n\t\t\t\t\tif ((dateTo.getTime() - this.scaleDateTo.getTime()) > this.proposeTimeLimit * Util.getDayLength()\n\t\t\t\t\t\t||\n\t\t\t\t\t\tparams.checkedFuture === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tPlanner.showNoResultNotification();\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.checkedFuture !== true)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet scrollLeft = this.DOM.timelineFixedWrap.scrollLeft;\n\t\t\t\t\t\tthis.scaleDateTo = new Date(this.scaleDateTo.getTime() + Util.getDayLength() * this.proposeTimeLimit);\n\t\t\t\t\t\tthis.rebuild();\n\t\t\t\t\t\tthis.DOM.timelineFixedWrap.scrollLeft = scrollLeft;\n\n\t\t\t\t\t\tlet\n\t\t\t\t\t\t\tentry,\n\t\t\t\t\t\t\tentrieIds = [];\n\t\t\t\t\t\tfor (i = 0; i < this.entries.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentry = this.entries[i];\n\t\t\t\t\t\t\tentrieIds.push(entry.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (this.fullDayMode)\n\t\t\t\t\t\tdateTo = new Date(dateTo.getTime() - Util.getDayLength());\n\n\t\t\t\t\tthis.selector.update({\n\t\t\t\t\t\tfrom: dateFrom,\n\t\t\t\t\t\tto:dateTo,\n\t\t\t\t\t\tupdateScaleType:false,\n\t\t\t\t\t\tupdateScaleLimits:true,\n\t\t\t\t\t\tanimation: true,\n\t\t\t\t\t\tfocus: true\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.emit('onDateChange', new BaseEvent({data: {\n\t\t\t\t\t\tdateFrom: dateFrom,\n\t\t\t\t\t\tdateTo: dateTo,\n\t\t\t\t\t\tfullDay: this.fullDayMode\n\t\t\t\t\t}}));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (checkRes && checkRes.toTimestampReal)\n\t\t\t{\n\t\t\t\tts = checkRes.toTimestampReal;\n\t\t\t\tif (this.fullDayMode)\n\t\t\t\t{\n\t\t\t\t\tlet dt = new Date(ts + Util.getDayLength() - 1000); // next day\n\t\t\t\t\tdt.setHours(0, 0, 0, 0);\n\t\t\t\t\tts = dt.getTime();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckTimePeriod(fromDate, toDate, data)\n\t{\n\t\tlet\n\t\t\tresult = true,\n\t\t\tentry,\n\t\t\tfromTimestamp = fromDate.getTime(),\n\t\t\ttoTimestamp = toDate.getTime(),\n\t\t\tcacheKey = fromTimestamp + '_' + toTimestamp,\n\t\t\taccuracy = 60 * 1000, // 1min\n\t\t\titem, i;\n\n\t\tif (Type.isArray(data))\n\t\t{\n\t\t\tfor (i = 0; i < data.length; i++)\n\t\t\t{\n\t\t\t\titem = data[i];\n\t\t\t\tif (item.type && item.type === 'hr')\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif ((item.fromTimestamp + accuracy) <= toTimestamp && ((item.toTimestampReal || item.toTimestamp) - accuracy) >= fromTimestamp)\n\t\t\t\t{\n\t\t\t\t\tresult = item;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (Type.isArray(this.entries))\n\t\t{\n\t\t\tlet\n\t\t\t\tentriesAccessibleIndex = {},\n\t\t\t\tselectorAccuracy = this.selectorAccuracy * 1000,\n\t\t\t\tentryId;\n\n\t\t\tif (this.checkTimeCache[cacheKey] !== undefined)\n\t\t\t{\n\t\t\t\tresult = this.checkTimeCache[cacheKey];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor (entryId in this.accessibility)\n\t\t\t\t{\n\t\t\t\t\tif (this.accessibility.hasOwnProperty(entryId))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.selectMode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentry = this.entries.find(function(el){return parseInt(el.id) === parseInt(entryId);});\n\t\t\t\t\t\t\tif (entry && !entry.selected)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tentriesAccessibleIndex[entryId] = true;\n\t\t\t\t\t\tif (Type.isArray(this.accessibility[entryId]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor (i = 0; i < this.accessibility[entryId].length; i++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem = this.accessibility[entryId][i];\n\t\t\t\t\t\t\t\tif (item.type && item.type === 'hr')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif ((item.fromTimestamp + selectorAccuracy) <= toTimestamp && ((item.toTimestampReal || item.toTimestamp) - selectorAccuracy) >= fromTimestamp)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tentriesAccessibleIndex[entryId] = false;\n\t\t\t\t\t\t\t\t\tresult = item;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// for (i = 0; i < this.entries.length; i++)\n\t\t\t\t// {\n\t\t\t\t// \tif (entriesAccessibleIndex[this.entries[i].id] !== undefined)\n\t\t\t\t// \t{\n\t\t\t\t// \t\tthis.entries[i].currentStatus = !!entriesAccessibleIndex[this.entries[i].id];\n\t\t\t\t// \t}\n\t\t\t\t// \telse\n\t\t\t\t// \t{\n\t\t\t\t// \t\tthis.entries[i].currentStatus = true;\n\t\t\t\t// \t}\n\t\t\t\t// }\n\n\t\t\t\tthis.checkTimeCache[cacheKey] = result;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tclearCacheTime()\n\t{\n\t\tthis.checkTimeCache = {};\n\t}\n\n\tcheckEntryTimePeriod(entry, fromDate, toDate)\n\t{\n\t\tlet data = [], i;\n\t\tif (entry && entry.id && BX.type.isArray(this.accessibility[entry.id]))\n\t\t{\n\t\t\tfor (i = 0; i < this.accessibility[entry.id].length; i++)\n\t\t\t{\n\t\t\t\tlet item = Planner.prepareAccessibilityItem(this.accessibility[entry.id][i]);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tdata.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.checkTimePeriod(fromDate, toDate, data) === true;\n\t}\n\n\tshowSettingsPopup()\n\t{\n\t\tlet\n\t\t\tsettingsDialogCont = BX.create('DIV', {props: {className: 'calendar-planner-settings-popup'}}),\n\t\t\tscaleRow = settingsDialogCont.appendChild(BX.create('DIV', {props: {className: 'calendar-planner-settings-row'}, html: '<i>' + Loc.getMessage('EC_PL_SETTINGS_SCALE') + ':</i>'})),\n\t\t\tscaleWrap = scaleRow.appendChild(BX.create('span', {props: {className: 'calendar-planner-option-container'}}));\n\n\t\tif (this.fullDayMode)\n\t\t{\n\t\t\tscaleRow.title = Loc.getMessage('EC_PL_SETTINGS_SCALE_READONLY_TITLE');\n\t\t\tDom.addClass(scaleRow, 'calendar-planner-option-container-disabled');\n\t\t}\n\n\t\tthis.scaleTypes.forEach((scale)=>{\n\t\t\tscaleWrap.appendChild(Tag.render`<span class=\"calendar-planner-option-tab ${(scale === this.scaleType ? ' calendar-planner-option-tab-active' : '')}\" data-bx-planner-scale=\"${scale}\">${Loc.getMessage('EC_PL_SETTINGS_SCALE_' + scale.toUpperCase())}</span>`);\n\t\t});\n\n\n\t\t// Create and show settings popup\n\t\tlet popup = PopupWindowManager.create(\n\t\t\tthis.id + \"-settings-popup\",\n\t\t\tthis.DOM.settingsButton,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: -1,\n\t\t\t\toffsetLeft: 7,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: settingsDialogCont,\n\t\t\t\tzIndex: 4000,\n\t\t\t\tangle: {postion: 'top'},\n\t\t\t\tcacheable: false\n\t\t\t});\n\t\tpopup.show(true);\n\n\t\tEvent.bind(scaleWrap, 'click', (e) => {\n\t\t\tif (!this.fullDayMode)\n\t\t\t{\n\t\t\t\tlet\n\t\t\t\t\tnodeTarget = e.target || e.srcElement,\n\t\t\t\t\tscale = nodeTarget && nodeTarget.getAttribute && nodeTarget.getAttribute('data-bx-planner-scale');\n\n\t\t\t\tif (scale)\n\t\t\t\t{\n\t\t\t\t\tthis.changeScaleType(scale);\n\t\t\t\t\tpopup.close();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tchangeScaleType(scaleType)\n\t{\n\t\tif (scaleType !== this.scaleType)\n\t\t{\n\t\t\tthis.setScaleType(scaleType);\n\t\t\tthis.rebuild();\n\t\t\tthis.selector.focus(true, 300);\n\t\t}\n\t}\n\n\tsetFullDayMode(fullDayMode)\n\t{\n\t\tif (fullDayMode !== this.fullDayMode)\n\t\t{\n\t\t\tthis.fullDayMode = fullDayMode;\n\t\t\tif (fullDayMode && !this.isOneDayScale())\n\t\t\t{\n\t\t\t\tthis.savedScaleType = this.scaleType;\n\t\t\t\tthis.changeScaleType('1day');\n\t\t\t}\n\t\t\telse if (!fullDayMode && this.isOneDayScale() && this.savedScaleType)\n\t\t\t{\n\t\t\t\tthis.changeScaleType(this.savedScaleType);\n\t\t\t\tthis.savedScaleType = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic showNoResultNotification()\n\t{\n\t\talert(Loc.getMessage('EC_PL_PROPOSE_NO_RESULT'));\n\t}\n\n\tshowProposeControl()\n\t{\n\t\tif (!this.DOM.proposeTimeButton)\n\t\t{\n\t\t\tthis.DOM.proposeTimeButton = this.DOM.mainWrap.appendChild(BX.create(\"DIV\", {\n\t\t\t\tprops: {className: 'calendar-planner-time-arrow-right'},\n\t\t\t\thtml: '<span class=\"calendar-planner-time-arrow-right-text\">' + Loc.getMessage('EC_PL_PROPOSE') + '</span><span class=\"calendar-planner-time-arrow-right-item\"></span>'\n\t\t\t}));\n\t\t\tEvent.bind(this.DOM.proposeTimeButton, 'click', this.proposeTime.bind(this));\n\t\t}\n\t\tthis.DOM.proposeTimeButton.style.display = \"block\";\n\t\tthis.DOM.proposeTimeButton.style.top = (this.DOM.timelineDataWrap.offsetTop + this.DOM.timelineDataWrap.offsetHeight / 2 - 16) + \"px\";\n\t}\n\n\thideProposeControl()\n\t{\n\t\tif (this.DOM.proposeTimeButton)\n\t\t{\n\t\t\tthis.DOM.proposeTimeButton.style.display = \"none\";\n\t\t}\n\t}\n\n\tmouseMoveHandler(e)\n\t{\n\t\tlet\n\t\t\ti, nodes,\n\t\t\tentryUid, parentTarget,\n\t\t\tprevEntry,\n\t\t\tmainContWrap = this.DOM.mainWrap,\n\t\t\ttarget = e.target || e.srcElement;\n\n\t\tentryUid = target.getAttribute('data-bx-planner-entry');\n\t\tif (!entryUid)\n\t\t{\n\t\t\tparentTarget = BX.findParent(target,\n\t\t\t\tfunction(node)\n\t\t\t\t{\n\t\t\t\t\tif (node == mainContWrap ||\n\t\t\t\t\t\tnode.getAttribute && node.getAttribute('data-bx-planner-entry')\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmainContWrap\n\t\t\t);\n\n\t\t\tif (parentTarget)\n\t\t\t{\n\t\t\t\tentryUid = target.getAttribute('data-bx-planner-entry')\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.hoverRow, 'show');\n\t\t\t\tnodes = this.selector.controlWrap.querySelectorAll('.calendar-planner-selector-control-row.hover');\n\t\t\t\tfor (i = 0; i < nodes.length; i++)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(nodes[i], 'hover');\n\t\t\t\t}\n\t\t\t\tprevEntry = this.getEntryByUniqueId(this.howerEntryId);\n\t\t\t\tif (prevEntry && prevEntry.selectWrap)\n\t\t\t\t{\n\t\t\t\t\tprevEntry.selectWrap.style.opacity = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (entryUid)\n\t\t{\n\t\t\tif (this.howerEntryId !== entryUid)\n\t\t\t{\n\t\t\t\tthis.howerEntryId = entryUid;\n\t\t\t\tlet entry = this.getEntryByUniqueId(entryUid);\n\t\t\t\tif (entry)\n\t\t\t\t{\n\t\t\t\t\tlet top = parseInt(entry.dataRowWrap.offsetTop);\n\t\t\t\t\tDom.addClass(this.hoverRow, 'show');\n\t\t\t\t\tthis.hoverRow.style.top = (top + 36) + 'px';\n\t\t\t\t\tthis.hoverRow.style.width = (parseInt(this.DOM.mainWrap.offsetWidth) + 5) + 'px';\n\n\t\t\t\t\tif (entry.selectorControlWrap)\n\t\t\t\t\t{\n\t\t\t\t\t\tnodes = this.selector.controlWrap.querySelectorAll('.calendar-planner-selector-control-row.hover');\n\t\t\t\t\t\tfor (i = 0; i < nodes.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.removeClass(nodes[i], 'hover');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tDom.addClass(entry.selectorControlWrap, 'hover');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tshowLoader()\n\t{\n\t\tthis.hideLoader();\n\t\tthis.DOM.loader = this.DOM.mainWrap.appendChild(Util.getLoader(50));\n\t\tDom.addClass(this.DOM.loader, 'calendar-planner-main-loader');\n\t}\n\n\thideLoader()\n\t{\n\t\tif(Type.isDomNode(this.DOM.loader))\n\t\t{\n\t\t\tDom.remove(this.DOM.loader);\n\t\t}\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.shown;\n\t}\n\n\tisBuilt()\n\t{\n\t\treturn this.built;\n\t}\n\n\tisLocked()\n\t{\n\t\treturn this.locked;\n\t}\n\n\tlock()\n\t{\n\t\tif (!this.DOM.lockScreen)\n\t\t{\n\t\t\tthis.DOM.lockScreen = Tag.render`\n\t\t\t\t<div class=\"calendar-planner-timeline-locker\">\n\t\t\t\t\t<div class=\"calendar-planner-timeline-locker-container\">\n\t\t\t\t\t\t<div class=\"calendar-planner-timeline-locker-top\">\n\t\t\t\t\t\t\t<div class=\"calendar-planner-timeline-locker-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"calendar-planner-timeline-text\">${Loc.getMessage('EC_PL_LOCKED_TITLE')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-planner-timeline-locker-button\">\n\t\t\t\t\t\t\t<a href=\"javascript:void(0)\" onclick=\"top.BX.UI.InfoHelper.show('limit_crm_calender_planner');\" class=\"ui-btn ui-btn-sm ui-btn-light-border ui-btn-round\">${Loc.getMessage('EC_PL_UNLOCK_FEATURE')}</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tDom.addClass(this.DOM.timelineFixedWrap, '--lock');\n\t\tthis.DOM.timelineFixedWrap.appendChild(this.DOM.lockScreen);\n\t}\n}\n"],"names":["Selector","params","Date","setEventNamespace","selectMode","getPosByDate","getDateByPos","getPosDateMap","getTimelineWidth","getScaleInfo","solidStatus","useAnimation","DOM","timelineWrap","render","wrap","Tag","ondrag","BX","False","ondragstart","titleNode","result","controlWrap","appendChild","Type","isPlainObject","updateScaleType","updateScaleLimits","animation","from","isDate","parseDate","currentDateFrom","to","currentDateTo","fullDay","undefined","currentFullDay","getTime","Util","getDayLength","setHours","show","focus","alignCenter","style","display","fromPos","toPos","width","left","transit","toX","triggerChangeEvents","checkStatus","selectorIsDraged","selectorRoundedPos","selectorStartLeft","parseInt","selectorStartScrollLeft","scrollLeft","Dom","addClass","document","body","x","selectorWidth","pos","roundedPos","roundPos","checkedPos","checkPosition","showTitle","hideTitle","setValue","selectorIsResized","selectorStartWidth","toDate","timeTo","rightPos","Math","min","fullDayMode","getHours","round","getMinutes","shownScaleTimeFrom","shownScaleTimeTo","fromDate","formatDate","selectorRoundedRightPos","selectorPos","removeClass","mainContWrap","lastFromDate","lastToDate","emit","BaseEvent","data","dateFrom","dateTo","status","selectorIsFree","max","scaleInfo","shownTimeFrom","shownTimeTo","type","timeFrom","scaleTimeFrom","scaleTimeTo","getDay","abs","fromX","offsetWidth","stop","easing","duration","start","finish","transition","makeEaseOut","transitions","quart","step","state","complete","setTimeout","animate","selectorTitle","getTitleNode","selector","timelineWidth","innerHTML","date","format","removeAttribute","formatTime","lastTouchedEntry","entriesListWidth","compactMode","selectorTitleLeft","selectorTitleTop","timelineDataCont","offsetTop","top","selectorHideTimeout","clearTimeout","opacity","quad","timeoutName","selectorIndex","timeout","focusTimeout","screenDelta","selectorLeft","viewWidth","viewLeft","viewRight","newScrollLeft","parseFloat","EventEmitter","Planner","h","y","q","n","Map","config","id","userId","Loc","getMessage","SCALE_TIME_FORMAT","isAmPmMode","setConfig","hideAnimation","isBuilt","build","bindEventHandlers","resizePlannerWidth","buildTimeline","adjustWidth","timelineInnerWrap","readonly","mainWrap","entriesOuterWrap","height","adjustHeight","shown","setScaleType","scaleType","showTimelineDayTitle","compactHeight","isOneDayScale","minHeight","selectEntriesMode","isInteger","SCALE_OFFSET_BEFORE","SCALE_OFFSET_AFTER","maxTimelineSize","minEntryRows","MIN_ENTRY_ROWS","maxEntryRows","MAX_ENTRY_ROWS","minWidth","isArray","workTime","extendScaleTime","weekHolidays","yearHolidays","accuracy","clickSelectorScaleAccuracy","selectorAccuracy","timelineCellWidth","showEntiesHeader","showEntryName","timelineCellWidthOrig","allowAdjustCellWidth","locked","adjustCellWidth","setScaleLimits","scaleDateFrom","scaleDateTo","isString","loadedDataFrom","loadedDataTo","fromTime","toTime","isNaN","rebuildDebounce","scaleSize","isDomNode","TypeError","create","props","className","preventSelection","entrieListHeader","entriesListTitleCounter","text","entrieListWrap","timelineFixedWrap","isLocked","lock","setAttribute","timelineScaleWrap","timelineDataWrap","accessibilityWrap","bind","posDateMap","scale","getWrap","subscribe","handleSelectorChanges","doCheckSelectorStatus","selectedEntriesWrap","hoverRow","Event","mouseMoveHandler","settingsButton","showSettingsPopup","built","clearCache","lastTimelineKey","getTimelineShownKey","clean","scaleData","getScaleData","outerDayCont","dayTitle","cont","i","length","scaleDayTitles","daystamp","html","timestamp","dayStart","title","cell","mapDatePosRes","mapDatePos","timelineOffset","checkRebuildTimeout","_checkRebuildTimeoutCount","rebuildTimeout","isElementNode","isShown","rebuild","REBUILD_DELAY","Runtime","debounce","update","entries","accessibility","updateSelector","selectorParams","clearCacheTime","ts","scaleFrom","scaleTo","time","dayStamp","curDayStamp","push","value","entry","hidden","fromTimestamp","toTimestamp","toTimestampReal","node","name","rowWrap","showMoreUsersLink","events","showMoreUsers","attrs","uid","emailUser","entryStatusMap","toUpperCase","getEntryAvatarNode","entriesResourceListWrap","isNodeInDom","dataRowWrap","selectorControlWrap","selected","selectEntryRow","entriesDataRowMap","set","forEach","item","prepareAccessibilityItem","addAccessibilityItem","selectWrap","isParentForNode","entryUniqueId","find","handleClick","proxy","handleMousedown","handleMousemove","handleMouseup","mouseWheelTimelineHandler","e","window","event","clickMousePos","getMousePos","nodeTarget","target","srcElement","accuracyMouse","hasClass","getEntryByUniqueId","getAttribute","isEntrySelected","deSelectEntryRow","onCustomEvent","plannerId","timeline","findTarget","mouseDownMousePos","mouseDown","startMousePos","startResize","startMove","startScrollTimeline","isDragged","endMove","endResize","timelineIsDraged","endScrollTimeline","checkTimelineScroll","mousePos","move","resize","scrollTimeline","delta","deltaY","detail","wheelDelta","newScroll","PreventDefault","minScroll","scrollStep","maxScroll","scrollWidth","expandTimeline","EXPAND_DELAY","timelineStartScrollLeft","nodeMetaType","parentCont","findParent","pageX","pageY","clientX","clientY","documentElement","clientLeft","scrollTop","clientTop","scaleTypes","includes","getScaleSize","datePosMap","j","tsi","xi","tsj","xj","cellWidth","substeps","posAccuracy","offsetLeft","curInd","deltaTs","end","newHeight","offsetHeight","currentHeight","resizePlannerHeight","resizeAnimation","timelineDataContHeight","proposeTimeButton","direction","loadedTimelineSize","prevScaleDateFrom","prevScaleDateTo","oldScaleDateFrom","EXPAND_OFFSET","limitScaleSizeMode","oldDateTo","reloadData","reload","sort","a","b","cutData","usersCount","cutAmount","dispDataCount","cutDataTitle","ind","getEntryUniqueId","accData","entriesIndex","displayEntryRow","join","extendPlannerWatches","key","hasOwnProperty","get","setFullDayMode","floor","ceil","getData","selectorStatus","checkTimePeriod","setSelectorStatus","hideProposeControl","showProposeControl","curTimestamp","getDateFrom","curDate","getDuration","k","setSeconds","checkRes","proposeTimeLimit","checkedFuture","showNoResultNotification","entrieIds","dt","cacheKey","entryId","checkTimeCache","el","entriesAccessibleIndex","settingsDialogCont","scaleRow","scaleWrap","popup","PopupWindowManager","autoHide","closeByEsc","lightShadow","content","zIndex","angle","postion","cacheable","changeScaleType","close","savedScaleType","proposeTime","nodes","entryUid","parentTarget","prevEntry","querySelectorAll","howerEntryId","hideLoader","loader","getLoader","remove","lockScreen","toReal","imageNode","img","avatar","Text","encode","hour","map","alert"],"mappings":"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"}