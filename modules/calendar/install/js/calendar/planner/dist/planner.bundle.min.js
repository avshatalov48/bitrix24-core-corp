this.BX=this.BX||{};(function(e,t,i,s,a){"use strict";var l,r,n;var o=function(e){babelHelpers.inherits(a,e);function a(){var e;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,a);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(a).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"DOM",{});babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"selectMode",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"currentDateFrom",new Date);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"currentDateTo",new Date);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"currentFullDay",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"useAnimation",true);e.setEventNamespace("BX.Calendar.Planner.Selector");e.selectMode=t.selectMode;e.getPosByDate=t.getPosByDate;e.getDateByPos=t.getDateByPos;e.getPosDateMap=t.getPosDateMap;e.getTimelineWidth=t.getTimelineWidth;e.getScaleInfo=t.getScaleInfo;e.solidStatus=t.solidStatus;e.useAnimation=t.useAnimation!==false;e.DOM.timelineWrap=t.timelineWrap;e.render();return e}babelHelpers.createClass(a,[{key:"render",value:function e(){this.DOM.wrap=s.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-planner-timeline-selector" data-bx-planner-meta="selector">\n\t\t\t\t<span data-bx-planner-meta="selector-resize-left" class="calendar-planner-timeline-drag-left"></span>\n\t\t\t\t<span class="calendar-planner-timeline-selector-grip"></span>\n\t\t\t\t<span data-bx-planner-meta="selector-resize-right" class="calendar-planner-timeline-drag-right"></span>\n\t\t\t</div>'])));this.DOM.wrap.ondrag=BX.False;this.DOM.wrap.ondragstart=BX.False;this.DOM.titleNode=s.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['<div class="calendar-planner-selector-notice" style="display: none"></div>'])));if(this.selectMode){result.controlWrap=this.DOM.wrap.appendChild(s.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['<div class="calendar-planner-selector-control"></div>']))))}}},{key:"getWrap",value:function e(){return this.DOM.wrap}},{key:"getTitleNode",value:function e(){return this.DOM.titleNode}},{key:"update",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!s.Type.isPlainObject(t)){t={}}t.updateScaleType=!!t.updateScaleType;t.updateScaleLimits=!!t.updateScaleLimits;t.animation=!!t.animation;var a=s.Type.isDate(t.from)?t.from:BX.parseDate(t.from)||this.currentDateFrom;var l=s.Type.isDate(t.to)?t.to:BX.parseDate(t.to)||this.currentDateTo;this.fullDayMode=t.fullDay!==undefined?t.fullDay:this.currentFullDay;if(s.Type.isDate(a)&&s.Type.isDate(l)){this.currentDateFrom=a;this.currentDateTo=l;this.currentFullDay=this.fullDayMode;if(this.fullDayMode){l=new Date(l.getTime()+i.Util.getDayLength());a.setHours(0,0,0,0);l.setHours(0,0,0,0)}this.show(a,l,{animation:t.animation,focus:t.focus})}}},{key:"show",value:function e(t,i,a){var l=a.animation&&this.useAnimation!==false;var r=a.focus!==false;var n=a.alignCenter!==false;this.DOM.wrap.style.display="block";if(s.Type.isDate(t)&&s.Type.isDate(i)){var o=this.getPosByDate(t),h=this.getPosByDate(i);this.DOM.wrap.style.width=h-o+"px";if(l&&this.DOM.wrap.style.left&&!this.currentFullDay){this.transit({toX:o,triggerChangeEvents:false,focus:r})}else{this.DOM.wrap.style.left=o+"px";this.DOM.wrap.style.width=h-o+"px";if(r){this.focus(false,200,n)}this.checkStatus(o,true)}}}},{key:"hide",value:function e(){this.DOM.wrap.style.display="none"}},{key:"startMove",value:function e(){this.selectorIsDraged=true;this.selectorRoundedPos=false;this.selectorStartLeft=parseInt(this.DOM.wrap.style.left);this.selectorStartScrollLeft=this.DOM.timelineWrap.scrollLeft;s.Dom.addClass(document.body,"calendar-planner-unselectable")}},{key:"move",value:function e(t){if(this.selectorIsDraged){var i=parseInt(this.DOM.wrap.style.width),s=this.selectorStartLeft+t;s-=this.selectorStartScrollLeft-this.DOM.timelineWrap.scrollLeft;if(this.getPosDateMap()[s]){this.selectorRoundedPos=s}else{var l=a.roundPos(s);if(this.getPosDateMap()[l]){this.selectorRoundedPos=l}}var r=this.checkPosition(this.selectorRoundedPos);if(r!==this.selectorRoundedPos){this.selectorRoundedPos=r;s=r}this.DOM.wrap.style.left=s+"px";this.showTitle({fromPos:s,toPos:this.selectorRoundedPos+i});this.checkStatus(this.selectorRoundedPos,true)}}},{key:"endMove",value:function e(){if(this.selectorIsDraged&&this.selectorRoundedPos){this.DOM.wrap.style.left=this.selectorRoundedPos+"px";this.selectorRoundedPos=false;this.hideTitle();this.setValue(this.selectorRoundedPos)}this.selectorIsDraged=false}},{key:"startResize",value:function e(){this.selectorIsResized=true;this.selectorRoundedPos=false;this.selectorStartLeft=parseInt(this.DOM.wrap.style.left);this.selectorStartWidth=parseInt(this.DOM.wrap.style.width);this.selectorStartScrollLeft=this.DOM.timelineWrap.scrollLeft}},{key:"resize",value:function e(t){if(this.selectorIsResized){var s,l,r=this.selectorStartWidth+t;r-=this.selectorStartScrollLeft-this.DOM.timelineWrap.scrollLeft;var n=Math.min(this.selectorStartLeft+r,this.getTimelineWidth());s=this.getDateByPos(n,true);if(this.fullDayMode){l=parseInt(s.getHours())+Math.round(s.getMinutes()/60*10)/10;s.setHours(0,0,0,0);if(l>12){s=new Date(s.getTime()+i.Util.getDayLength());s.setHours(0,0,0,0)}n=this.getPosByDate(s);r=n-this.selectorStartLeft;if(r<=10){s=this.getDateByPos(this.selectorStartLeft);s=new Date(s.getTime()+i.Util.getDayLength());s.setHours(0,0,0,0);r=this.getPosByDate(s)-this.selectorStartLeft;n=this.selectorStartLeft+r}}else if(this.shownScaleTimeFrom!==0||this.shownScaleTimeTo!==24){var o=this.getDateByPos(this.selectorStartLeft);if(s&&o&&i.Util.formatDate(o)!==i.Util.formatDate(s)){s=new Date(o.getTime());s.setHours(this.shownScaleTimeTo,0,0,0);n=this.getPosByDate(s);r=n-this.selectorStartLeft}}if(this.getPosDateMap()[n]){this.selectorRoundedRightPos=n}else{var h=a.roundPos(n);if(this.getPosDateMap()[h]){this.selectorRoundedRightPos=h}}this.DOM.wrap.style.width=r+"px";this.showTitle({fromPos:this.selectorStartLeft,toPos:this.selectorRoundedRightPos});this.checkStatus(this.selectorStartLeft,true)}}},{key:"endResize",value:function e(){if(this.selectorIsResized&&this.selectorRoundedRightPos){this.DOM.wrap.style.width=this.selectorRoundedPos-parseInt(this.DOM.wrap.style.left)+"px";this.selectorRoundedRightPos=false;this.hideTitle();this.setValue()}this.selectorIsResized=false}},{key:"isDragged",value:function e(){return this.selectorIsResized||this.selectorIsDraged}},{key:"checkStatus",value:function e(i,l){if(this.solidStatus){s.Dom.removeClass(this.DOM.wrap,"calendar-planner-timeline-selector-warning");s.Dom.removeClass(this.mainContWrap,"calendar-planner-selector-warning");s.Dom.addClass(this.DOM.wrap,"solid")}else{if(!i){i=a.roundPos(this.DOM.wrap.style.left)}var r,n;if(l===true||!this.currentDateFrom){var o=parseInt(this.DOM.wrap.style.width),h=i,c=h+o;if(!h&&!c&&!o&&this.lastFromDate){r=this.lastFromDate;n=this.lastToDate}else{r=this.getDateByPos(h);n=this.getDateByPos(c,true);this.lastFromDate=r;this.lastToDate=n}}else{r=this.currentDateFrom;n=this.currentDateTo}this.emit("doCheckStatus",new t.BaseEvent({data:{dateFrom:r,dateTo:n}}))}}},{key:"setSelectorStatus",value:function e(t){this.selectorIsFree=t;if(this.selectorIsFree){s.Dom.removeClass(this.DOM.wrap,"calendar-planner-timeline-selector-warning")}else{s.Dom.addClass(this.DOM.wrap,"calendar-planner-timeline-selector-warning")}}},{key:"setValue",value:function e(s,a){if(!s){s=parseInt(this.DOM.wrap.style.left)}s=Math.max(0,s);if(!a){a=parseInt(this.DOM.wrap.style.width)}if(s+a>parseInt(this.getTimelineWidth())){s=parseInt(this.getTimelineWidth())-a}var l=this.getDateByPos(s);var r=this.getDateByPos(s+a,true);if(l&&r){this.currentDateFrom=l;this.currentDateTo=r;this.currentFullDay=this.fullDayMode;if(this.fullDayMode){var n=r.getTime();this.currentDateTo=new Date(n-1e3);r=new Date(n-i.Util.getDayLength())}this.emit("onChange",new t.BaseEvent({data:{dateFrom:l,dateTo:r,fullDay:this.fullDayMode}}))}}},{key:"checkPosition",value:function e(t,s,a){var l=this.getScaleInfo();if((l.shownTimeFrom!==0||l.shownTimeTo!==24)&&(l.type!=="1day"||this.fullDayMode)){t=t||parseInt(this.DOM.wrap.style.left);s=s||parseInt(this.DOM.wrap.style.width);a=a||t+s;if(a>parseInt(this.getTimelineWidth())){t=parseInt(this.getTimelineWidth())-s}else{var r=this.getDateByPos(t),n=this.getDateByPos(a,true),o,h,c=parseInt(l.shownTimeFrom),d=parseInt(l.shownTimeTo);if(r&&n){if(this.fullDayMode){o=parseInt(r.getHours())+Math.round(r.getMinutes()/60*10)/10;r.setHours(0,0,0,0);if(o>12){r=new Date(r.getTime()+i.Util.getDayLength());r.setHours(0,0,0,0)}t=this.getPosByDate(r)}else if(r.getDay()!==n.getDay()){o=parseInt(r.getHours())+Math.round(r.getMinutes()/60*10)/10;h=parseInt(n.getHours())+Math.round(n.getMinutes()/60*10)/10;if(Math.abs(d-o)>Math.abs(c-h)){r.setHours(l.shownTimeTo,0,0,0);t=this.getPosByDate(r)-s}else{n.setHours(l.shownTimeFrom,0,0,0);t=this.getPosByDate(n)}}}}}return t}},{key:"transit",value:function e(){var t=this;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var s=i.fromX||parseInt(this.DOM.wrap.style.left),l=a.roundPos(i.toX||s),r=i.triggerChangeEvents!==false,n=!!i.focus,o=parseInt(this.DOM.wrap.offsetWidth);if(l>s+o&&r){l-=o}if(s!==l){if(this.animation){this.animation.stop()}this.animation=new BX.easing({duration:300,start:{left:s},finish:{left:l},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function e(i){t.DOM.wrap.style.left=i.left+"px"},complete:function e(){t.animation=null;var i=parseInt(t.DOM.wrap.style.left),s=t.checkPosition(i);if(s!==i){t.DOM.wrap.style.left=s+"px"}if(r){t.setValue(s)}if(n){t.focus(true,300)}setTimeout((function(){t.show(t.currentDateFrom,t.currentDateTo,{animation:false,focus:n,alignCenter:false})}),200);t.checkStatus(s)}});this.animation.animate()}else{if(r){this.setValue()}if(n===true){this.focus(true,300)}this.checkStatus()}}},{key:"showTitle",value:function e(){var t=this;var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var a=s.fromPos,l=s.toPos,r=s.selectorTitle||this.getTitleNode(),n=s.selector||this.DOM.wrap,o=this.getTimelineWidth(),h,c;if(a&&l){if(l>o){a=o-parseInt(n.style.width);l=o}h=this.getDateByPos(a);c=this.getDateByPos(l,true);if(h&&c){if(this.fullDayMode){if(Math.abs(c.getTime()-h.getTime()-i.Util.getDayLength())<1e3){r.innerHTML=BX.date.format("d F, D",h.getTime()/1e3)}else{r.innerHTML=BX.date.format("d F",h.getTime()/1e3)+" - "+BX.date.format("d F",c.getTime()/1e3)}}else{r.removeAttribute("style");r.innerHTML=i.Util.formatTime(h)+" - "+i.Util.formatTime(c)}if(this.selectMode&&this.lastTouchedEntry){var d=this.compactMode?0:this.entriesListWidth,p=parseInt(n.style.left)-this.DOM.timelineWrap.scrollLeft+d+parseInt(n.style.width)/2,u=parseInt(this.timelineDataCont.offsetTop)+parseInt(this.lastTouchedEntry.style.top)-12;r.style.top=u+"px";r.style.left=p+"px"}else{n.appendChild(r)}}}if(r===this.selectorTitle){if(r.style.display==="none"||this.selectorHideTimeout){this.selectorHideTimeout=clearTimeout(this.selectorHideTimeout);this.selectorTitle.style.display="";this.selectorTitle.style.opacity=0;new BX.easing({duration:400,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function e(i){t.selectorTitle.style.opacity=i.opacity/100},complete:function e(){t.selectorTitle.removeAttribute("style")}}).animate()}}else{r.removeAttribute("style")}}},{key:"hideTitle",value:function e(){var t=this;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!s.Type.isPlainObject(i))i={};var a=i.selectorIndex===undefined?"selectorHideTimeout":"selectorHideTimeout_"+i.selectorIndex,l=i.selectorTitle||this.getTitleNode();if(this[a])this[a]=clearTimeout(this[a]);if(i.timeout!==false){this[a]=setTimeout((function(){i.timeout=false;t.hideTitle(i)}),700)}else{l.style.display="";l.style.opacity=1;new BX.easing({duration:400,start:{opacity:100},finish:{opacity:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function e(t){l.style.opacity=t.opacity/100},complete:function e(){l.removeAttribute("style");l.style.display="none"}}).animate()}}},{key:"focus",value:function e(){var t=this;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:300;var a=arguments.length>2?arguments[2]:undefined;a=a===true;if(this.focusTimeout){this.focusTimeout=!!clearTimeout(this.focusTimeout)}if(this.useAnimation===false){i=false}if(s){this.focusTimeout=setTimeout((function(){t.focus(i,false,a)}),s)}else{var l=10,r=parseInt(this.DOM.wrap.style.left),n=parseInt(this.DOM.wrap.style.width),o=parseInt(this.DOM.timelineWrap.offsetWidth),h=parseInt(this.DOM.timelineWrap.scrollLeft),c=h+o;var d=h;if(r<h+l||r>c-l||a){if(n<=o){d=Math.max(Math.round(r-(o-n)/2),l)}else{d=Math.max(Math.round(r-l),l)}}if(d!==h){if(i===false){this.DOM.timelineWrap.scrollLeft=d}else{new BX.easing({duration:300,start:{scrollLeft:this.DOM.timelineWrap.scrollLeft},finish:{scrollLeft:d},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function e(i){t.DOM.timelineWrap.scrollLeft=i.scrollLeft},complete:function e(){}}).animate()}}}}},{key:"getDuration",value:function e(){var t=Math.round((this.currentDateTo-this.currentDateFrom)/1e3)*1e3;if(this.fullDayMode){t+=i.Util.getDayLength()}return t}},{key:"getDateFrom",value:function e(){return this.currentDateFrom}},{key:"getDateTo",value:function e(){return this.currentDateTo}}],[{key:"roundPos",value:function e(t){return Math.round(parseFloat(t))}}]);return a}(t.EventEmitter);var h,c,d,p,u,m,f;var D=function(e){babelHelpers.inherits(l,e);function l(){var e;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,l);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(l).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"DOM",{});babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"config",{});babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"entryStatusMap",{h:"user-status-h",y:"user-status-y",q:"user-status-q",n:"user-status-n"});babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"scaleTypes",["15min","30min","1hour","2hour","1day"]);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"savedScaleType",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"SCALE_OFFSET_BEFORE",3);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"SCALE_OFFSET_AFTER",10);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"EXPAND_OFFSET",3);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"EXPAND_DELAY",2e3);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"REBUILD_DELAY",100);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"maxTimelineSize",20);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"MIN_ENTRY_ROWS",3);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"MAX_ENTRY_ROWS",300);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"width",700);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"height",84);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"minWidth",700);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"minHeight",84);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"workTime",[9,18]);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"scrollStep",10);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"shown",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"built",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"locked",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"shownScaleTimeFrom",24);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"shownScaleTimeTo",0);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"timelineCellWidthOrig",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"proposeTimeLimit",60);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"expandTimelineDelay",600);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"limitScaleSizeMode",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"useAnimation",true);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"checkTimeCache",{});babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"entriesIndex",new Map);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"solidStatus",false);e.setEventNamespace("BX.Calendar.Planner");e.config=t;e.id=t.id;e.userId=parseInt(t.userId||s.Loc.getMessage("USER_ID"));e.DOM.wrap=t.wrap;e.SCALE_TIME_FORMAT=BX.isAmPmMode()?"g a":"G";e.expandTimelineDebounce=s.Runtime.debounce(e.expandTimeline,e.EXPAND_DELAY,babelHelpers.assertThisInitialized(e));e.setConfig(t);return e}babelHelpers.createClass(l,[{key:"show",value:function e(){if(this.hideAnimation){this.hideAnimation.stop();this.hideAnimation=null}if(!this.isBuilt()){this.build();this.bindEventHandlers()}else{this.resizePlannerWidth(this.width)}this.buildTimeline();if(this.adjustWidth){this.resizePlannerWidth(this.DOM.timelineInnerWrap.offsetWidth)}this.DOM.wrap.style.display="";if(this.readonly){s.Dom.addClass(this.DOM.mainWrap,"calendar-planner-readonly")}else{s.Dom.removeClass(this.DOM.mainWrap,"calendar-planner-readonly")}if(this.compactMode){s.Dom.addClass(this.DOM.mainWrap,"calendar-planner-compact")}else{s.Dom.removeClass(this.DOM.mainWrap,"calendar-planner-compact")}this.DOM.entriesOuterWrap.style.display=this.compactMode?"none":"";{if(parseInt(this.DOM.wrap.style.height)<this.height){this.DOM.wrap.style.height=this.height+"px"}this.adjustHeight()}this.shown=true}},{key:"setConfig",value:function e(t){this.setScaleType(t.scaleType);if(t.showTimelineDayTitle!==undefined)this.showTimelineDayTitle=!!t.showTimelineDayTitle;else if(this.showTimelineDayTitle===undefined)this.showTimelineDayTitle=true;if(t.compactMode!==undefined)this.compactMode=!!t.compactMode;else if(this.compactMode===undefined)this.compactMode=false;if(t.readonly!==undefined)this.readonly=!!t.readonly;else if(this.readonly===undefined)this.readonly=false;if(this.compactMode){var i=50;if(this.showTimelineDayTitle&&!this.isOneDayScale())i+=20;this.height=this.minHeight=i}if(t.selectEntriesMode!==undefined)this.selectMode=!!t.selectEntriesMode;else if(this.selectMode===undefined)this.selectMode=false;if(s.Type.isInteger(t.SCALE_OFFSET_BEFORE)){this.SCALE_OFFSET_BEFORE=parseInt(t.SCALE_OFFSET_BEFORE)}if(s.Type.isInteger(t.SCALE_OFFSET_AFTER)){this.SCALE_OFFSET_AFTER=parseInt(t.SCALE_OFFSET_AFTER)}if(s.Type.isInteger(t.maxTimelineSize)){this.maxTimelineSize=parseInt(t.maxTimelineSize)}if(s.Type.isInteger(t.minEntryRows)){this.MIN_ENTRY_ROWS=parseInt(t.minEntryRows)}if(s.Type.isInteger(t.maxEntryRows)){this.MAX_ENTRY_ROWS=parseInt(t.maxEntryRows)}if(s.Type.isInteger(t.width)){this.width=parseInt(t.width)}if(s.Type.isInteger(t.height)){this.height=parseInt(t.height)}if(s.Type.isInteger(t.minWidth)){this.minWidth=parseInt(t.minWidth)}if(s.Type.isInteger(t.minHeight)){this.minHeight=parseInt(t.minHeight)}this.width=Math.max(this.minWidth,this.width);this.height=Math.max(this.minHeight,this.height);if(s.Type.isArray(t.workTime)){this.workTime=t.workTime}this.extendScaleTime(this.workTime[0],this.workTime[1]);this.weekHolidays=t.weekHolidays||this.weekHolidays||[];this.yearHolidays=t.yearHolidays||this.yearHolidays||[];this.accuracy=t.accuracy||this.accuracy||300;this.clickSelectorScaleAccuracy=t.clickSelectorScaleAccuracy||this.accuracy;this.selectorAccuracy=parseInt(t.selectorAccuracy)||this.selectorAccuracy||300;this.entriesListWidth=parseInt(t.entriesListWidth)||this.entriesListWidth||200;this.timelineCellWidth=t.timelineCellWidth||this.timelineCellWidth||40;this.solidStatus=t.solidStatus===true;this.showEntiesHeader=t.showEntiesHeader===undefined?true:!!t.showEntiesHeader;this.showEntryName=t.showEntryName===undefined?true:!!t.showEntryName;if(this.isOneDayScale()&&this.timelineCellWidth<100){this.timelineCellWidthOrig=this.timelineCellWidth;this.timelineCellWidth=100}else if(this.timelineCellWidthOrig&&!this.isOneDayScale()){this.timelineCellWidth=this.timelineCellWidthOrig;this.timelineCellWidthOrig=false}if(this.allowAdjustCellWidth===undefined||t.allowAdjustCellWidth!==undefined){this.allowAdjustCellWidth=this.readonly&&this.compactMode&&t.allowAdjustCellWidth!==false}if(t.locked!==undefined){this.locked=t.locked}this.adjustCellWidth();this.setScaleLimits(t.scaleDateFrom,t.scaleDateTo)}},{key:"setScaleLimits",value:function e(t,a){if(t!==undefined){this.scaleDateFrom=s.Type.isDate(t)?t:i.Util.parseDate(t)}if(!s.Type.isDate(this.scaleDateFrom)){if(this.compactMode&&this.readonly){this.scaleDateFrom=new Date}else{this.scaleDateFrom=new Date((new Date).getTime()-i.Util.getDayLength()*this.SCALE_OFFSET_BEFORE)}}this.scaleDateFrom.setHours(this.isOneDayScale()?0:this.shownScaleTimeFrom,0,0,0);if(a!==undefined){this.scaleDateTo=BX.type.isString(a)?i.Util.parseDate(a):a}if(!s.Type.isDate(this.scaleDateTo)){if(this.compactMode&&this.readonly){this.scaleDateTo=new Date}else{this.scaleDateTo=new Date((new Date).getTime()+i.Util.getDayLength()*this.SCALE_OFFSET_AFTER)}}this.scaleDateTo.setHours(this.isOneDayScale()?0:this.shownScaleTimeTo,0,0,0)}},{key:"SetLoadedDataLimits",value:function e(t,s){if(t)this.loadedDataFrom=t.getTime?t:i.Util.parseDate(t);if(s)this.loadedDataTo=s.getTime?s:i.Util.parseDate(s)}},{key:"extendScaleTime",value:function e(t,i){if(t!==false&&!isNaN(parseInt(t))){this.shownScaleTimeFrom=Math.min(parseInt(t),this.shownScaleTimeFrom,23);this.shownScaleTimeFrom=Math.max(this.shownScaleTimeFrom,0);if(this.scaleDateFrom){this.scaleDateFrom.setHours(this.shownScaleTimeFrom,0,0,0)}}if(i!==false&&!isNaN(parseInt(i))){this.shownScaleTimeTo=Math.max(parseInt(i),this.shownScaleTimeTo,1);this.shownScaleTimeTo=Math.min(this.shownScaleTimeTo,24);if(this.scaleDateTo){this.scaleDateTo.setHours(this.shownScaleTimeTo,0,0,0)}}this.rebuildDebounce()}},{key:"adjustCellWidth",value:function e(){if(this.allowAdjustCellWidth){this.timelineCellWidth=Math.round(this.width/((this.shownScaleTimeTo-this.shownScaleTimeFrom)*3600/this.scaleSize))}}},{key:"build",value:function e(){var t=this;if(!s.Type.isDomNode(this.DOM.wrap)){throw new TypeError("Wrap is not DOM node")}this.DOM.wrap.style.width=this.width+"px";var a=this.compactMode?0:this.entriesListWidth;this.DOM.mainWrap=this.DOM.wrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-main-container calendar-planner-main-container-resource"},style:{minHeight:this.minHeight+"px",height:this.height+"px",width:this.width+"px"}}));if(!this.showEntryName){s.Dom.addClass(this.DOM.mainWrap,"calendar-planner-entry-icons-only")}if(this.readonly){s.Dom.addClass(this.DOM.mainWrap,"calendar-planner-readonly")}this.DOM.entriesOuterWrap=this.DOM.mainWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-user-container"},style:{width:a+"px",height:this.height+"px"}}));i.Util.preventSelection(this.DOM.entriesOuterWrap);if(this.compactMode){s.Dom.addClass(this.DOM.mainWrap,"calendar-planner-compact");this.DOM.entriesOuterWrap.style.display="none"}if(this.isOneDayScale()){s.Dom.addClass(this.DOM.entriesOuterWrap,"calendar-planner-no-daytitle")}else{s.Dom.removeClass(this.DOM.entriesOuterWrap,"calendar-planner-no-daytitle")}if(this.showEntiesHeader!==false){this.DOM.entrieListHeader=this.DOM.entriesOuterWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-header"}})).appendChild(BX.create("DIV",{props:{className:"calendar-planner-general-info"}})).appendChild(BX.create("DIV",{props:{className:"calendar-planner-users-header"}}));this.entriesListTitleCounter=this.DOM.entrieListHeader.appendChild(BX.create("span",{props:{className:"calendar-planner-users-item"},text:s.Loc.getMessage("EC_PL_ATTENDEES_TITLE")+" "})).appendChild(BX.create("span"))}this.DOM.entrieListWrap=this.DOM.entriesOuterWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-user-container-inner"}}));this.DOM.timelineFixedWrap=this.DOM.mainWrap.appendChild(s.Tag.render(h||(h=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="calendar-planner-timeline-wrapper" style="height: ','px"></div>\n\t\t'])),this.height));if(this.isLocked()){this.lock()}this.DOM.timelineInnerWrap=this.DOM.timelineFixedWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-timeline-inner-wrapper"}}));this.DOM.timelineInnerWrap.setAttribute("data-bx-planner-meta","timeline");this.DOM.timelineScaleWrap=this.DOM.timelineInnerWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-time"}}));i.Util.preventSelection(this.DOM.timelineScaleWrap);this.DOM.timelineDataWrap=this.DOM.timelineInnerWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-timeline-container"},style:{height:this.height+"px"}}));this.DOM.accessibilityWrap=this.DOM.timelineDataWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-acc-wrap"}}));this.selector=new o({selectMode:this.selectMode,timelineWrap:this.DOM.timelineFixedWrap,getPosByDate:this.getPosByDate.bind(this),getDateByPos:this.getDateByPos.bind(this),getPosDateMap:function e(){return t.posDateMap},useAnimation:this.useAnimation,solidStatus:this.solidStatus,getScaleInfo:function e(){return{scale:t.scaleType,shownTimeFrom:t.shownScaleTimeFrom,shownTimeTo:t.shownScaleTimeTo}},getTimelineWidth:function e(){return parseInt(t.DOM.timelineInnerWrap.style.width)}});this.DOM.timelineDataWrap.appendChild(this.selector.getWrap());this.DOM.mainWrap.appendChild(this.selector.getTitleNode());this.selector.subscribe("onChange",this.handleSelectorChanges.bind(this));this.selector.subscribe("doCheckStatus",this.doCheckSelectorStatus.bind(this));if(this.selectMode){this.selectedEntriesWrap=this.DOM.mainWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-timeline-select-entries-wrap"}}));this.hoverRow=this.DOM.mainWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-timeline-hover-row"},style:{top:0,width:parseInt(this.DOM.mainWrap.offsetWidth)+"px"}}));s.Event.bind(document,"mousemove",this.mouseMoveHandler.bind(this))}if(!this.compactMode){this.DOM.settingsButton=this.DOM.mainWrap.appendChild(s.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(['<div class="calendar-planner-settings-icon-container" title="','"><span class="calendar-planner-settings-title">','</span><span class="calendar-planner-settings-icon"></span></div>'])),s.Loc.getMessage("EC_PL_SETTINGS_SCALE"),s.Loc.getMessage("EC_PL_SETTINGS_SCALE")));s.Event.bind(this.DOM.settingsButton,"click",this.showSettingsPopup.bind(this))}this.built=true}},{key:"buildTimeline",value:function e(t){if(this.isBuilt()&&(this.lastTimelineKey!==this.getTimelineShownKey()||t===true)){if(this.DOM.timelineScaleWrap){s.Dom.clean(this.DOM.timelineScaleWrap)}this.scaleData=this.getScaleData();var i,a,l=this.DOM.timelineScaleWrap;for(var r=0;r<this.scaleData.length;r++){if(this.showTimelineDayTitle&&!this.isOneDayScale()){if(this.scaleDayTitles[this.scaleData[r].daystamp]){l=this.scaleDayTitles[this.scaleData[r].daystamp]}else{i=this.DOM.timelineScaleWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-time-day-outer"}}));a=i.appendChild(BX.create("DIV",{props:{className:"calendar-planner-time-day-title"},html:"<span>"+BX.date.format("d F, l",this.scaleData[r].timestamp/1e3)+"</span>"+'<div class="calendar-planner-time-day-border"></div>'}));l=i.appendChild(BX.create("DIV",{props:{className:"calendar-planner-time-day"}}));this.scaleDayTitles[this.scaleData[r].daystamp]=l}}var n="calendar-planner-time-hour-item"+(this.scaleData[r].dayStart?" calendar-planner-day-start":"");if((this.scaleType==="15min"||this.scaleType==="30min")&&this.scaleData[r].title!==""){n+=" calendar-planner-time-hour-bold"}this.scaleData[r].cell=l.appendChild(BX.create("DIV",{props:{className:n},style:{width:this.timelineCellWidth+"px",minWidth:this.timelineCellWidth+"px"},html:this.scaleData[r].title?"<i>"+this.scaleData[r].title+"</i>":""}));if(!this.isOneDayScale()&&this.scaleData[r+1]&&this.scaleData[r+1].dayStart){l.appendChild(BX.create("DIV",{props:{className:"calendar-planner-timeline-border"}}))}}var o=this.mapDatePos();this.posDateMap=o.posDateMap;var h=this.DOM.timelineScaleWrap.offsetWidth;this.DOM.timelineInnerWrap.style.width=h+"px";this.DOM.entrieListWrap.style.top=parseInt(this.DOM.timelineDataWrap.offsetTop)+10+"px";this.lastTimelineKey=this.getTimelineShownKey();this.checkRebuildTimeout(h)}}},{key:"getTimelineShownKey",value:function e(){return"tm_"+this.scaleDateFrom.getTime()+"_"+this.scaleDateTo.getTime()}},{key:"checkRebuildTimeout",value:function e(t){var i=this;var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:300;if(!this._checkRebuildTimeoutCount){this._checkRebuildTimeoutCount=0}if(this.rebuildTimeout){this.rebuildTimeout=!!clearTimeout(this.rebuildTimeout)}if(this._checkRebuildTimeoutCount<=10&&s.Type.isElementNode(this.DOM.timelineScaleWrap)&&s.Dom.isShown(this.DOM.timelineScaleWrap)){this._checkRebuildTimeoutCount++;this.rebuildTimeout=setTimeout((function(){if(t!==i.DOM.timelineScaleWrap.offsetWidth){if(i.rebuildTimeout){i.rebuildTimeout=!!clearTimeout(i.rebuildTimeout)}i.rebuild();if(i.selector){i.selector.focus(false,300)}}else{i.checkRebuildTimeout(t,a)}}),a)}else{delete this._checkRebuildTimeoutCount}}},{key:"rebuildDebounce",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.REBUILD_DELAY;s.Runtime.debounce(this.rebuild,t,this)()}},{key:"rebuild",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(this.isBuilt()){this.buildTimeline(true);this.update(this.entries,this.accessibility);this.adjustHeight();this.resizePlannerWidth(this.width);if(t.updateSelector!==false){this.selector.update(t.selectorParams)}this.clearCacheTime()}}},{key:"getScaleData",value:function e(){this.scaleData=[];this.scaleDayTitles={};var t,i,s,a,l,r,n=false,o=this.isOneDayScale()?0:this.shownScaleTimeFrom,h=this.isOneDayScale()?0:this.shownScaleTimeTo;this.scaleDateFrom.setHours(o,0,0,0);this.scaleDateTo.setHours(h,0,0,0);i=this.scaleDateFrom.getTime();s=this.scaleDateTo.getTime();for(t=i;t<s;t+=this.scaleSize*1e3){a=parseFloat(BX.date.format("H.i",t/1e3));if(this.isOneDayScale())r=BX.date.format("d F, D",t/1e3);else r=BX.date.format("i",t/1e3)==="00"?BX.date.format(this.SCALE_TIME_FORMAT,t/1e3):"";if(this.isOneDayScale()||a>=o&&a<h){l=BX.date.format("d.m.Y",t/1e3);this.scaleData.push({daystamp:l,timestamp:t,value:t,title:r,dayStart:n!==l});n=l}}return this.scaleData}},{key:"isOneDayScale",value:function e(){return this.scaleType==="1day"}},{key:"addAccessibilityItem",value:function e(t,s){var a,l,r=false,n=t.fromTimestamp,o=t.toTimestampReal||t.toTimestamp,h=this.isOneDayScale()?0:this.shownScaleTimeFrom,c=this.isOneDayScale()?24:this.shownScaleTimeTo,d=new Date(n),p=new Date(o);a=parseInt(d.getHours())+d.getMinutes()/60;l=parseInt(p.getHours())+p.getMinutes()/60;if(a>c){d=new Date(d.getTime()+i.Util.getDayLength()-1);d.setHours(h,0,0,0);if(d.getTime()>=p.getTime()){r=true}}if(!r&&a<h){d.setHours(h,0,0,0);if(d.getTime()>=p.getTime()){r=true}}if(!r&&l>c){p.setHours(c,0,0,0);if(d.getTime()>=p.getTime()){r=true}}if(!r&&l<h){p=new Date(p.getTime()-i.Util.getDayLength()+1);p.setHours(c,0,0,0);if(d.getTime()>=p.getTime()){r=true}}if(!r){var u=this.getPosByDate(d),m=this.getPosByDate(p);t.node=s.appendChild(BX.create("DIV",{props:{className:"calendar-planner-acc-entry"+(t.type&&t.type==="hr"?" calendar-planner-acc-entry-hr":"")},style:{left:u+"px",width:Math.max(m-u,3)+"px"}}));if(t.title||t.name){t.node.title=t.title||t.name}}}},{key:"displayEntryRow",value:function e(t){var i=this;var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var r;if(t.type==="moreLink"){r=this.DOM.entrieListWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-user"}}));if(this.showEntryName){this.DOM.showMoreUsersLink=r.appendChild(BX.create("DIV",{props:{className:"calendar-planner-all-users",title:t.title||""},text:t.name,events:{click:this.showMoreUsers.bind(this)}}))}else{this.DOM.showMoreUsersLink=r.appendChild(BX.create("DIV",{props:{className:"calendar-planner-users-more",title:t.name},html:'<span class="calendar-planner-users-more-btn"></span>',events:{click:this.showMoreUsers.bind(this)}}))}}else if(t.type==="lastUsers"){r=this.DOM.entrieListWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-user"}}));if(this.showEntryName){this.DOM.showMoreUsersLink=r.appendChild(BX.create("DIV",{props:{className:"calendar-planner-all-users calendar-planner-last-users",title:t.title||""},text:t.name}))}else{this.DOM.showMoreUsersLink=r.appendChild(BX.create("DIV",{props:{className:"calendar-planner-users-more",title:t.title||t.name},html:'<span class="calendar-planner-users-last-btn"></span>'}))}}else if(t.id&&t.type==="user"){r=this.DOM.entrieListWrap.appendChild(BX.create("DIV",{attrs:{"data-bx-planner-entry":t.uid,className:"calendar-planner-user"+(t.emailUser?" calendar-planner-email-user":"")}}));if(t.status&&this.entryStatusMap[t.status]){r.appendChild(BX.create("span",{props:{className:"calendar-planner-user-status-icon "+this.entryStatusMap[t.status],title:s.Loc.getMessage("EC_PL_STATUS_"+t.status.toUpperCase())}}))}r.appendChild(l.getEntryAvatarNode(t));if(this.showEntryName){r.appendChild(BX.create("span",{props:{className:"calendar-planner-user-name"}})).appendChild(BX.create("span",{props:{className:"calendar-planner-entry-name"},attrs:{"bx-tooltip-user-id":t.id,"bx-tooltip-classname":"calendar-planner-user-tooltip"},style:{width:this.entriesListWidth-42+"px"},text:t.name}))}}else if(t.id&&t.type==="room"){r=this.DOM.entrieListWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-user"}}));if(this.showEntryName){r.appendChild(BX.create("span",{props:{className:"calendar-planner-user-name"}})).appendChild(BX.create("span",{props:{className:"calendar-planner-entry-name"},style:{width:this.entriesListWidth-20+"px"},text:t.name}))}else{r.appendChild(BX.create("DIV",{props:{className:"calendar-planner-location-image-icon",title:t.name}}))}}else if(t.type==="resource"){if(!this.entriesResourceListWrap||!BX.isNodeInDom(this.entriesResourceListWrap)){this.entriesResourceListWrap=this.DOM.entrieListWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-container-resource"},html:'<div class="calendar-planner-resource-header"><span class="calendar-planner-users-item">'+s.Loc.getMessage("EC_PL_RESOURCE_TITLE")+"</span></div>"}))}r=this.entriesResourceListWrap.appendChild(BX.create("DIV",{attrs:{"data-bx-planner-entry":t.uid,className:"calendar-planner-user"}}));if(this.showEntryName){r.appendChild(BX.create("span",{props:{className:"calendar-planner-user-name"}})).appendChild(BX.create("span",{props:{className:"calendar-planner-entry-name"},style:{width:this.entriesListWidth-20+"px"},text:t.name}))}else{r.appendChild(BX.create("DIV",{props:{className:"calendar-planner-location-image-icon",title:t.name}}))}}else{r=this.DOM.entrieListWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-user"}}));r.appendChild(BX.create("DIV",{props:{className:"calendar-planner-all-users"},text:t.name}))}var n=r.offsetTop+13;var o=this.DOM.accessibilityWrap.appendChild(s.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['<div class="calendar-planner-timeline-space" style="top:','px" data-bx-planner-entry="','"></div>'])),n,t.uid||0));if(this.selectMode){t.selectorControlWrap=this.selector.controlWrap.appendChild(BX.create("DIV",{attrs:{"data-bx-planner-entry":t.uid,className:"calendar-planner-selector-control-row"},style:{top:n-4+"px"}}));if(t.selected){this.selectEntryRow(t)}}this.entriesDataRowMap.set(t.uid,o);a.forEach((function(e){e=l.prepareAccessibilityItem(e);if(e){i.addAccessibilityItem(e,o)}}))}},{key:"selectEntryRow",value:function e(t){if(BX.type.isPlainObject(t)){var i=parseInt(t.dataRowWrap.offsetTop);if(!t.selectWrap||!BX.isParentForNode(this.selectedEntriesWrap,t.selectWrap)){t.selectWrap=this.selectedEntriesWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-timeline-selected"}}))}t.selectWrap.style.display="";t.selectWrap.style.top=i+36+"px";t.selectWrap.style.width=parseInt(this.DOM.mainWrap.offsetWidth)+5+"px";s.Dom.addClass(t.selectorControlWrap,"active");t.selected=true;this.clearCacheTime()}}},{key:"isEntrySelected",value:function e(t){return t&&t.selected}},{key:"deSelectEntryRow",value:function e(t){if(BX.type.isPlainObject(t)){if(t.selectWrap){t.selectWrap.style.display="none"}if(t.selectorControlWrap){s.Dom.removeClass(t.selectorControlWrap,"active")}t.selected=false;this.clearCacheTime()}}},{key:"getEntryByUniqueId",value:function e(t){if(BX.type.isArray(this.entries)){return this.entries.find((function(e){return e.uid==t}))}return null}},{key:"bindEventHandlers",value:function e(){s.Event.bind(this.DOM.wrap,"click",this.handleClick.bind(this));s.Event.bind(this.DOM.wrap,"mousedown",this.handleMousedown.bind(this));s.Event.bind(document,"mousemove",this.handleMousemove.bind(this));s.Event.bind(document,"mouseup",this.handleMouseup.bind(this));s.Event.bind(this.DOM.timelineFixedWrap,"onwheel"in document?"wheel":"mousewheel",this.mouseWheelTimelineHandler.bind(this))}},{key:"handleClick",value:function e(t){if(!t){t=window.event}this.clickMousePos=this.getMousePos(t);var i=t.target||t.srcElement,a=5;if(this.selectMode&&s.Dom.hasClass(i,"calendar-planner-selector-control-row")){var l=this.getEntryByUniqueId(i.getAttribute("data-bx-planner-entry"));if(l){if(!this.isEntrySelected(l)){this.selectEntryRow(l)}else{this.deSelectEntryRow(l)}this.selector.checkStatus();BX.onCustomEvent("OnCalendarPlannerSelectedEntriesOnChange",[{plannerId:this.id,entries:this.entries}])}return}if(!this.readonly){var r=this.findTarget(i,"timeline"),n=this.findTarget(i,"selector");if(r&&!n&&Math.abs(this.clickMousePos.x-this.mouseDownMousePos.x)<a&&Math.abs(this.clickMousePos.y-this.mouseDownMousePos.y)<a){var o=this.clickMousePos.x-BX.pos(this.DOM.timelineFixedWrap).left+this.DOM.timelineFixedWrap.scrollLeft;if(this.clickSelectorScaleAccuracy!==this.accuracy){var h=this.mapDatePos(this.clickSelectorScaleAccuracy);var c=this.getDateByPos(o,false,h.posDateMap);o=this.getPosByDate(c)}this.selector.transit({toX:o})}}}},{key:"handleMousedown",value:function e(t){if(!t){t=window.event}var i=t.target||t.srcElement;this.mouseDownMousePos=this.getMousePos(t);this.mouseDown=true;if(!this.readonly){var s=this.findTarget(i,"selector");this.startMousePos=this.mouseDownMousePos;if(s){if(this.findTarget(i,"selector-resize-right")){this.selector.startResize()}else{this.selector.startMove()}}else if(this.findTarget(i,"timeline")){this.startScrollTimeline()}}}},{key:"handleMouseup",value:function e(){if(this.selector.isDragged()){this.selector.endMove();this.selector.endResize()}if(this.timelineIsDraged){this.endScrollTimeline()}if(this.shown&&!this.readonly&&this.mouseDown){this.checkTimelineScroll()}this.mouseDown=false;s.Dom.removeClass(document.body,"calendar-planner-unselectable")}},{key:"handleMousemove",value:function e(t){var i,s=t.target||t.srcElement;if(this.selectMode&&s&&s.getAttribute&&s.getAttribute("data-bx-planner-entry")){this.lastTouchedEntry=s}if(this.selector.isDragged()){i=this.getMousePos(t);this.selector.move(i.x-this.startMousePos.x);this.selector.resize(i.x-this.startMousePos.x)}if(this.timelineIsDraged){i=this.getMousePos(t);this.scrollTimeline(i.x-this.startMousePos.x)}}},{key:"mouseWheelTimelineHandler",value:function e(t){t=t||window.event;if(this.shown&&!this.readonly){if(s.Browser.isMac()){this.checkTimelineScroll()}else{var i=t.deltaY||t.detail||t.wheelDelta;if(Math.abs(i)>0){this.DOM.timelineFixedWrap.scrollLeft=Math.max(this.DOM.timelineFixedWrap.scrollLeft+Math.round(i/3),0);this.checkTimelineScroll();return BX.PreventDefault(t)}}}}},{key:"checkTimelineScroll",value:function e(){var t=this.scrollStep;var i=this.DOM.timelineFixedWrap.scrollWidth-this.DOM.timelineFixedWrap.offsetWidth-this.scrollStep;if(this.DOM.timelineFixedWrap.offsetWidth>0){if(this.DOM.timelineFixedWrap.scrollLeft<=t){this.expandTimelineDirection="past"}else if(this.DOM.timelineFixedWrap.scrollLeft>=i){this.expandTimelineDirection="future"}if(this.expandTimelineDirection){if(!this.isLoaderShown()){this.showLoader()}this.expandTimelineDebounce()}}}},{key:"startScrollTimeline",value:function e(){this.timelineIsDraged=true;this.timelineStartScrollLeft=this.DOM.timelineFixedWrap.scrollLeft}},{key:"scrollTimeline",value:function e(t){this.DOM.timelineFixedWrap.scrollLeft=Math.max(this.timelineStartScrollLeft-t,0)}},{key:"endScrollTimeline",value:function e(){this.timelineIsDraged=false}},{key:"findTarget",value:function e(t,i,s){if(!s)s=this.DOM.mainWrap;var a=t&&t.getAttribute?t.getAttribute("data-bx-planner-meta"):null;if(a!==i){if(t){t=BX.findParent(t,(function(e){return e.getAttribute&&e.getAttribute("data-bx-planner-meta")===i}),s)}else{t=null}}return t}},{key:"getMousePos",value:function e(t){if(!t)t=window.event;var i=0,s=0;if(t.pageX||t.pageY){i=t.pageX;s=t.pageY}else if(t.clientX||t.clientY){i=t.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft;s=t.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop}return{x:i,y:s}}},{key:"setScaleType",value:function e(t){if(!this.scaleTypes.includes(t)){t="1hour"}this.scaleType=t;this.scaleSize=l.getScaleSize(t);if(this.isOneDayScale()&&this.timelineCellWidth<100){this.timelineCellWidthOrig=this.timelineCellWidth;this.timelineCellWidth=100}else if(!this.isOneDayScale()&&this.timelineCellWidthOrig){this.timelineCellWidth=this.timelineCellWidthOrig;this.timelineCellWidthOrig=false}if(this.isOneDayScale()){s.Dom.addClass(this.DOM.mainWrap,"calendar-planner-fulldaymode");if(this.DOM.entriesOuterWrap){s.Dom.addClass(this.DOM.entriesOuterWrap,"calendar-planner-no-daytitle")}}else{s.Dom.removeClass(this.DOM.mainWrap,"calendar-planner-fulldaymode");if(this.DOM.entriesOuterWrap){s.Dom.removeClass(this.DOM.entriesOuterWrap,"calendar-planner-no-daytitle")}}}},{key:"mapDatePos",value:function e(t){if(!t){t=this.accuracy}var i={};var s={};var a,l,r,n,o,h,c;this.substeps=Math.round(this.scaleSize/t);this.posAccuracy=this.timelineCellWidth/this.substeps;t=t*1e3;var d=this.scaleData[1].timestamp-this.scaleData[0].timestamp;for(a=0;a<this.scaleData.length;a++){r=this.scaleData[a].timestamp;n=parseInt(this.scaleData[a].cell.offsetLeft);c=parseInt(this.scaleData[a].cell.offsetWidth);if(!i[r]){i[r]=n}s[n]=r;for(l=1;l<=c;l++){o=r+Math.round(l*d/c/t)*t;h=n+l;if(!i[r]){i[o]=h}s[h]=o;if(l===c&&(!this.scaleData[a+1]||this.scaleData[a+1].dayStart)){i[h+"_end"]=o}}}return{datePosMap:i,posDateMap:s}}},{key:"getPosByDate",value:function e(t){var s=0;if(t&&babelHelpers["typeof"](t)!=="object"){t=i.Util.parseDate(t)}if(t&&babelHelpers["typeof"](t)==="object"){var a=0;var l=t.getTime();for(var r=0;r<this.scaleData.length;r++){if(l>=this.scaleData[r].timestamp){a=r}else{break}}if(this.scaleData[a]&&this.scaleData[a].cell){s=this.scaleData[a].cell.offsetLeft;var n=this.scaleData[a].cell.offsetWidth;var o=Math.round((l-this.scaleData[a].timestamp)/1e3);if(o>0){s+=Math.round(o*10/this.scaleSize*n)/10}}}return s}},{key:"getDateByPos",value:function e(t,i,s){if(!s){s=this.posDateMap}var a,l=i&&s[t+"_end"]?s[t+"_end"]:s[t];if(!l){t=Math.round(t);l=i&&s[t+"_end"]?s[t+"_end"]:s[t]}if(l){a=new Date(l)}return a}},{key:"showMoreUsers",value:function e(){this.MIN_ENTRY_ROWS=this.MAX_ENTRY_ROWS;this.update(this.entries,this.accessibility);this.rebuildDebounce()}},{key:"adjustHeight",value:function e(){var t=this.DOM.entrieListWrap.offsetHeight+this.DOM.entrieListWrap.offsetTop+30,i=parseInt(this.DOM.wrap.style.height)||this.height;if(this.compactMode&&i<t||!this.compactMode){this.DOM.wrap.style.height=i+"px";this.resizePlannerHeight(t,Math.abs(t-i)>10)}}},{key:"resizePlannerHeight",value:function e(t){var i=this;var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this.height=t;if(s){if(this.resizeAnimation){this.resizeAnimation.stop();this.resizeAnimation=null}this.resizeAnimation=new BX.easing({duration:800,start:{height:parseInt(this.DOM.wrap.style.height)},finish:{height:t},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function e(t){i.resizePlannerHeight(t.height,false)},complete:function e(){i.resizeAnimation=null}});this.resizeAnimation.animate()}else{this.DOM.wrap.style.height=t+"px";this.DOM.mainWrap.style.height=t+"px";this.DOM.timelineFixedWrap.style.height=t+"px";var a=this.DOM.entrieListWrap.offsetHeight+3;this.DOM.timelineDataWrap.style.height=a+"px";this.DOM.entriesOuterWrap.style.height=t+"px";if(this.DOM.proposeTimeButton&&this.DOM.proposeTimeButton.style.display!=="none"){this.DOM.proposeTimeButton.style.top=this.DOM.timelineDataWrap.offsetTop+a/2-16+"px"}}}},{key:"resizePlannerWidth",value:function e(t,i){if(!i&&this.DOM.wrap&&this.DOM.mainWrap){this.DOM.wrap.style.width=t+"px";var s=this.compactMode?0:this.entriesListWidth;this.DOM.mainWrap.style.width=t+"px";this.DOM.entriesOuterWrap.style.width=s+"px"}}},{key:"expandTimeline",value:function e(s,a){var l=this;var r;var n;var o=this.scaleDateFrom;var h=this.scaleDateTo;if(!s)s=this.scaleDateFrom;if(!a)a=this.scaleDateTo;if(this.expandTimelineDirection==="past"){var c=new Date(this.scaleDateFrom.getTime());this.scaleDateFrom=new Date(s.getTime()-i.Util.getDayLength()*this.EXPAND_OFFSET);r=(this.scaleDateTo.getTime()-this.scaleDateFrom.getTime())/i.Util.getDayLength();if(r>this.maxTimelineSize){this.scaleDateTo=new Date(this.scaleDateFrom.getTime()+i.Util.getDayLength()*this.maxTimelineSize);this.loadedDataFrom=this.scaleDateFrom;this.loadedDataTo=this.scaleDateTo;this.limitScaleSizeMode=true}n=this.getPosByDate(c)}else if(this.expandTimelineDirection==="future"){var d=this.scaleDateTo;n=this.DOM.timelineFixedWrap.scrollLeft;this.scaleDateTo=new Date(a.getTime()+i.Util.getDayLength()*this.EXPAND_OFFSET);r=(this.scaleDateTo.getTime()-this.scaleDateFrom.getTime())/i.Util.getDayLength();if(r>this.maxTimelineSize){this.scaleDateFrom=new Date(this.scaleDateTo.getTime()-i.Util.getDayLength()*this.maxTimelineSize);this.loadedDataFrom=this.scaleDateFrom;this.loadedDataTo=this.scaleDateTo;n=this.getPosByDate(d)-this.DOM.timelineFixedWrap.offsetWidth;setTimeout((function(){l.DOM.timelineFixedWrap.scrollLeft=l.getPosByDate(d)-l.DOM.timelineFixedWrap.offsetWidth}),10);this.limitScaleSizeMode=true}}else{this.scaleDateFrom=new Date(s.getTime()-i.Util.getDayLength()*this.SCALE_OFFSET_BEFORE);this.scaleDateTo=new Date(a.getTime()+i.Util.getDayLength()*this.SCALE_OFFSET_AFTER)}var p=this.scaleDateFrom.getTime()<o.getTime()||this.scaleDateTo.getTime()>h.getTime();this.hideLoader();this.emit("onExpandTimeline",new t.BaseEvent({data:{reload:p,dateFrom:this.scaleDateFrom,dateTo:this.scaleDateTo}}));this.rebuild({updateSelector:false});if(n!==undefined){this.DOM.timelineFixedWrap.scrollLeft=n}this.expandTimelineDirection=null}},{key:"update",value:function e(){var a=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};s.Dom.clean(this.DOM.entrieListWrap);s.Dom.clean(this.DOM.accessibilityWrap);this.entriesDataRowMap=new Map;if(!s.Type.isArray(r)){return}this.entries=r;this.accessibility=n;var o=parseInt(this.userId);if(this.compactMode);else{r.sort((function(e,t){if(t.status==="h"||parseInt(t.id)===o&&e.status!=="h")return 1;if(e.status==="h"||parseInt(e.id)===o&&t.status!=="h")return-1;return 0}));if(this.selectedEntriesWrap){s.Dom.clean(this.selectedEntriesWrap);if(this.selector&&this.selector.controlWrap){s.Dom.clean(this.selector.controlWrap)}}var h=[],c=0,d=0,p=0,u=[];r.forEach((function(e,t){e.uid=l.getEntryUniqueId(e);var i=s.Type.isArray(n[e.uid])?n[e.uid]:[];a.entriesIndex.set(e.uid,e);if(e.type==="user"){c++}if(t<a.MIN_ENTRY_ROWS||r.length===a.MIN_ENTRY_ROWS+1){p++;a.displayEntryRow(e,i)}else{d++;u.push(e.name);i.forEach((function(e){e=l.prepareAccessibilityItem(e);if(e){h.push(e)}}))}}));if(this.entriesListTitleCounter){this.entriesListTitleCounter.innerHTML=c>this.MAX_ENTRY_ROWS?"("+c+")":""}this.emit("onDisplayAttendees",new t.BaseEvent({data:{usersCount:c}}));if(d>0){if(p===this.MAX_ENTRY_ROWS){this.displayEntryRow({name:s.Loc.getMessage("EC_PL_ATTENDEES_LAST")+" ("+d+")",type:"lastUsers",title:u.join(", ")},h)}else{this.displayEntryRow({name:s.Loc.getMessage("EC_PL_ATTENDEES_SHOW_MORE")+" ("+d+")",type:"moreLink"},h)}}}i.Util.extendPlannerWatches({entries:r,userId:this.userId});this.adjustHeight()}},{key:"updateAccessibility",value:function e(t){var i=this;this.accessibility=t;if(s.Type.isPlainObject(t)){var a;for(a in t){if(t.hasOwnProperty(a)&&s.Type.isArray(t[a])&&t[a].length){(function(){var e=i.entriesDataRowMap.get(a);if(s.Type.isDomNode(e)){t[a].forEach((function(t){t=l.prepareAccessibilityItem(t);if(t){i.addAccessibilityItem(t,e)}}))}})()}}}}},{key:"updateSelector",value:function e(t,s,a){var l=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(this.shown&&this.selector){this.setFullDayMode(a);if(!this.isOneDayScale()){if(i.Util.formatDate(t)!==i.Util.formatDate(s)){this.extendScaleTime(0,24)}else{var r=parseInt(t.getHours())+Math.floor(t.getMinutes()/60),n=parseInt(s.getHours())+Math.ceil(s.getMinutes()/60);if(r<this.shownScaleTimeFrom){this.extendScaleTime(r,false)}if(n>this.shownScaleTimeTo){this.extendScaleTime(false,n)}}}if(s.getTime()>this.scaleDateTo.getTime()||t.getTime()<this.scaleDateFrom.getTime()){this.expandTimelineDirection=false;this.expandTimeline(t,s)}this.selector.update({from:t,to:s,fullDay:a,focus:l.focus!==false});if(l.focus!==false){this.selector.focus(false,300)}}}},{key:"handleSelectorChanges",value:function e(i){if(i instanceof t.BaseEvent){var s=i.getData();this.emit("onDateChange",new t.BaseEvent({data:s}))}}},{key:"doCheckSelectorStatus",value:function e(i){if(i instanceof t.BaseEvent){var a=i.getData();this.clearCacheTime();var l=this.checkTimePeriod(a.dateFrom,a.dateTo)===true;this.selector.setSelectorStatus(l);if(l){s.Dom.removeClass(this.DOM.mainWrap,"calendar-planner-selector-warning");this.hideProposeControl()}else{s.Dom.addClass(this.DOM.mainWrap,"calendar-planner-selector-warning");this.showProposeControl()}}}},{key:"proposeTime",value:function e(){var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!s.Type.isPlainObject(a)){a={}}var r=Math.round(this.selector.getDateFrom().getTime()/(this.accuracy*1e3))*this.accuracy*1e3,n=new Date(r),o=this.selector.getDuration(),h=[],c,d;n.setSeconds(0,0);r=n.getTime();for(c in this.accessibility){if(this.accessibility.hasOwnProperty(c)&&this.accessibility[c]&&this.accessibility[c].length>0){for(d=0;d<this.accessibility[c].length;d++){if(this.accessibility[c][d].toTimestampReal>=r){var p=l.prepareAccessibilityItem(this.accessibility[c][d]);if(p){h.push(p)}}}}}h.sort((function(e,t){return e.fromTimestamp-t.fromTimestamp}));var u=r,m,f,D,y,T;while(true){f=new Date(u);D=new Date(u+o);if(!this.isOneDayScale()){T=parseInt(f.getHours())+f.getMinutes()/60;y=parseInt(D.getHours())+D.getMinutes()/60;if(T<=this.shownScaleTimeFrom){f.setHours(this.shownScaleTimeFrom,0,0,0);u=f.getTime();D=new Date(u+o)}if(y>this.shownScaleTimeTo){f=new Date(u+i.Util.getDayLength()-1e3);f.setHours(this.shownScaleTimeFrom,0,0,0);u=f.getTime();D=new Date(u+o)}}if(this.fullDayMode){f.setHours(0,0,0,0);D.setHours(0,0,0,0)}m=this.checkTimePeriod(f,D,h);if(m===true){if(D.getTime()>this.scaleDateTo.getTime()){if(D.getTime()-this.scaleDateTo.getTime()>this.proposeTimeLimit*i.Util.getDayLength()||a.checkedFuture===true){l.showNoResultNotification()}else if(a.checkedFuture!==true){var g=this.DOM.timelineFixedWrap.scrollLeft;this.scaleDateTo=new Date(this.scaleDateTo.getTime()+i.Util.getDayLength()*this.proposeTimeLimit);this.rebuild();this.DOM.timelineFixedWrap.scrollLeft=g;var M=void 0,b=[];for(d=0;d<this.entries.length;d++){M=this.entries[d];b.push(M.id)}}}else{if(this.fullDayMode)D=new Date(D.getTime()-i.Util.getDayLength());this.selector.update({from:f,to:D,updateScaleType:false,updateScaleLimits:true,animation:true,focus:true});this.emit("onDateChange",new t.BaseEvent({data:{dateFrom:f,dateTo:D,fullDay:this.fullDayMode}}))}break}else if(m&&m.toTimestampReal){u=m.toTimestampReal;if(this.fullDayMode){var v=new Date(u+i.Util.getDayLength()-1e3);v.setHours(0,0,0,0);u=v.getTime()}}}}},{key:"checkTimePeriod",value:function e(t,i,a){var l=this;var r=true;var n;if(!s.Type.isDate(t)||!s.Type.isDate(i)){return r}var o=t.getTime();var h=i.getTime();var c=o+"_"+h;var d=3*60*1e3;if(s.Type.isArray(a)){for(var p=0;p<a.length;p++){var u=a[p];if(u.type&&u.type==="hr"){continue}if(u.fromTimestamp+d<=h&&(u.toTimestampReal||u.toTimestamp)-d>=o){r=u;break}}}else if(s.Type.isArray(this.entries)){(function(){var e=l.selectorAccuracy*1e3,t;if(l.checkTimeCache[c]!==undefined){r=l.checkTimeCache[c]}else{for(t in l.accessibility){if(l.accessibility.hasOwnProperty(t)){if(l.selectMode){n=l.entries.find((function(e){return parseInt(e.id)===parseInt(t)}));if(n&&!n.selected){continue}}if(s.Type.isArray(l.accessibility[t])){for(var i=0;i<l.accessibility[t].length;i++){var a=l.accessibility[t][i];if(a.type&&a.type==="hr"){continue}if(a.fromTimestamp+e<=h&&(a.toTimestampReal||a.toTimestamp)-e>=o){r=a;break}}}}}l.checkTimeCache[c]=r}})()}return r}},{key:"clearCacheTime",value:function e(){this.checkTimeCache={}}},{key:"checkEntryTimePeriod",value:function e(t,i,s){var a=[],r;if(t&&t.id&&BX.type.isArray(this.accessibility[t.id])){for(r=0;r<this.accessibility[t.id].length;r++){var n=l.prepareAccessibilityItem(this.accessibility[t.id][r]);if(n){a.push(n)}}}return this.checkTimePeriod(i,s,a)===true}},{key:"showSettingsPopup",value:function e(){var t=this;var i=BX.create("DIV",{props:{className:"calendar-planner-settings-popup"}}),l=i.appendChild(BX.create("DIV",{props:{className:"calendar-planner-settings-row"},html:"<i>"+s.Loc.getMessage("EC_PL_SETTINGS_SCALE")+":</i>"})),r=l.appendChild(BX.create("span",{props:{className:"calendar-planner-option-container"}}));if(this.fullDayMode){l.title=s.Loc.getMessage("EC_PL_SETTINGS_SCALE_READONLY_TITLE");s.Dom.addClass(l,"calendar-planner-option-container-disabled")}this.scaleTypes.forEach((function(e){r.appendChild(s.Tag.render(p||(p=babelHelpers.taggedTemplateLiteral(['<span class="calendar-planner-option-tab ','" data-bx-planner-scale="','">',"</span>"])),e===t.scaleType?" calendar-planner-option-tab-active":"",e,s.Loc.getMessage("EC_PL_SETTINGS_SCALE_"+e.toUpperCase())))}));var n=a.PopupWindowManager.create(this.id+"-settings-popup",this.DOM.settingsButton,{autoHide:true,closeByEsc:true,offsetTop:-1,offsetLeft:7,lightShadow:true,content:i,zIndex:4e3,angle:{postion:"top"},cacheable:false});n.show(true);s.Event.bind(r,"click",(function(e){if(!t.fullDayMode){var i=e.target||e.srcElement,s=i&&i.getAttribute&&i.getAttribute("data-bx-planner-scale");if(s){t.changeScaleType(s);n.close()}}}))}},{key:"changeScaleType",value:function e(t){if(t!==this.scaleType){this.setScaleType(t);this.rebuild();this.selector.focus(true,300)}}},{key:"setFullDayMode",value:function e(t){if(t!==this.fullDayMode){this.fullDayMode=t;if(t&&!this.isOneDayScale()){this.savedScaleType=this.scaleType;this.changeScaleType("1day")}else if(!t&&this.isOneDayScale()&&this.savedScaleType){this.changeScaleType(this.savedScaleType);this.savedScaleType=null}}}},{key:"showProposeControl",value:function e(){if(!this.DOM.proposeTimeButton){this.DOM.proposeTimeButton=this.DOM.mainWrap.appendChild(BX.create("DIV",{props:{className:"calendar-planner-time-arrow-right"},html:'<span class="calendar-planner-time-arrow-right-text">'+s.Loc.getMessage("EC_PL_PROPOSE")+'</span><span class="calendar-planner-time-arrow-right-item"></span>'}));s.Event.bind(this.DOM.proposeTimeButton,"click",this.proposeTime.bind(this))}this.DOM.proposeTimeButton.style.display="block";this.DOM.proposeTimeButton.style.top=this.DOM.timelineDataWrap.offsetTop+this.DOM.timelineDataWrap.offsetHeight/2-16+"px"}},{key:"hideProposeControl",value:function e(){if(this.DOM.proposeTimeButton){this.DOM.proposeTimeButton.style.display="none"}}},{key:"mouseMoveHandler",value:function e(t){var i,a,l,r,n,o=this.DOM.mainWrap,h=t.target||t.srcElement;l=h.getAttribute("data-bx-planner-entry");if(!l){r=BX.findParent(h,(function(e){if(e==o||e.getAttribute&&e.getAttribute("data-bx-planner-entry")){return true}}),o);if(r){l=h.getAttribute("data-bx-planner-entry")}else{s.Dom.removeClass(this.hoverRow,"show");a=this.selector.controlWrap.querySelectorAll(".calendar-planner-selector-control-row.hover");for(i=0;i<a.length;i++){s.Dom.removeClass(a[i],"hover")}n=this.getEntryByUniqueId(this.howerEntryId);if(n&&n.selectWrap){n.selectWrap.style.opacity=1}}}if(l){if(this.howerEntryId!==l){this.howerEntryId=l;var c=this.getEntryByUniqueId(l);if(c){var d=parseInt(c.dataRowWrap.offsetTop);s.Dom.addClass(this.hoverRow,"show");this.hoverRow.style.top=d+36+"px";this.hoverRow.style.width=parseInt(this.DOM.mainWrap.offsetWidth)+5+"px";if(c.selectorControlWrap){a=this.selector.controlWrap.querySelectorAll(".calendar-planner-selector-control-row.hover");for(i=0;i<a.length;i++){s.Dom.removeClass(a[i],"hover")}s.Dom.addClass(c.selectorControlWrap,"hover")}}}}}},{key:"showLoader",value:function e(){this.hideLoader();this.DOM.loader=this.DOM.mainWrap.appendChild(i.Util.getLoader(40));s.Dom.addClass(this.DOM.loader,"calendar-planner-main-loader");this.loaderShown=true}},{key:"hideLoader",value:function e(){if(s.Type.isDomNode(this.DOM.loader)){s.Dom.remove(this.DOM.loader)}this.loaderShown=false}},{key:"isLoaderShown",value:function e(){return this.loaderShown}},{key:"isShown",value:function e(){return this.shown}},{key:"isBuilt",value:function e(){return this.built}},{key:"isLocked",value:function e(){return this.locked}},{key:"lock",value:function e(){if(!this.DOM.lockScreen){this.DOM.lockScreen=s.Tag.render(u||(u=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="calendar-planner-timeline-locker">\n\t\t\t\t\t<div class="calendar-planner-timeline-locker-container">\n\t\t\t\t\t\t<div class="calendar-planner-timeline-locker-top">\n\t\t\t\t\t\t\t<div class="calendar-planner-timeline-locker-icon"></div>\n\t\t\t\t\t\t\t<div class="calendar-planner-timeline-text">','</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="calendar-planner-timeline-locker-button">\n\t\t\t\t\t\t\t<a href="javascript:void(0)" onclick="top.BX.UI.InfoHelper.show(\'limit_crm_calender_planner\');" class="ui-btn ui-btn-sm ui-btn-light-border ui-btn-round">',"</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"])),s.Loc.getMessage("EC_PL_LOCKED_TITLE"),s.Loc.getMessage("EC_PL_UNLOCK_FEATURE"))}s.Dom.addClass(this.DOM.timelineFixedWrap,"--lock");this.DOM.timelineFixedWrap.appendChild(this.DOM.lockScreen)}}],[{key:"prepareAccessibilityItem",value:function e(t){if(!s.Type.isDate(t.from)){t.from=i.Util.parseDate(t.dateFrom)}if(!s.Type.isDate(t.to)){t.to=i.Util.parseDate(t.dateTo)}if(!s.Type.isDate(t.from)||!s.Type.isDate(t.to)){return false}t.from.setSeconds(0,0);t.fromTimestamp=t.from.getTime();t.to.setSeconds(0,0);t.toTimestamp=t.to.getTime();if(!s.Type.isDate(t.toReal)){if((t.toTimestamp-t.fromTimestamp)%i.Util.getDayLength()===0&&BX.date.format("H:i",t.toTimestamp/1e3)==="00:00"){t.toReal=new Date(t.to.getTime()+i.Util.getDayLength());t.toReal.setSeconds(0,0);t.toTimestampReal=t.toReal.getTime()}else{t.toReal=t.to;t.toTimestampReal=t.toTimestamp}}return t}},{key:"getEntryAvatarNode",value:function e(t){var i;var a=t.avatar;if(!a||a==="/bitrix/images/1.gif"){i=s.Tag.render(m||(m=babelHelpers.taggedTemplateLiteral(['<div bx-tooltip-user-id="','" bx-tooltip-classname="calendar-planner-user-tooltip" title="','" class="ui-icon calendar-planner-user-image-icon ','"><i></i></div>'])),t.id,s.Text.encode(t.name),t.emailUser?"ui-icon-common-user-mail":"ui-icon-common-user")}else{i=s.Tag.render(f||(f=babelHelpers.taggedTemplateLiteral(['<div bx-tooltip-user-id="','" bx-tooltip-classname="calendar-planner-user-tooltip" title="','" class="ui-icon calendar-planner-user-image-icon"><i style="background-image: url(\'',"')\"></i></div>"])),t.id,s.Text.encode(t.name),t.avatar)}return i}},{key:"getEntryUniqueId",value:function e(t){return["user","room"].includes(t.type)?t.id:t.type+"-"+t.id}},{key:"getScaleSize",value:function e(t){var i=3600,s={"15min":Math.round(i/4),"30min":Math.round(i/2),"1hour":i,"2hour":i*2,"1day":i*24};return s[t]||i}},{key:"showNoResultNotification",value:function e(){alert(s.Loc.getMessage("EC_PL_PROPOSE_NO_RESULT"))}}]);return l}(t.EventEmitter);e.Planner=D})(this.BX.Calendar=this.BX.Calendar||{},BX.Event,BX.Calendar,BX,BX.Main);
//# sourceMappingURL=planner.bundle.map.js