{"version":3,"file":"public-v2.bundle.js","sources":["../src/components/layout/members-list.js","../src/components/welcome.js","../src/components/calendar/day.js","../src/components/calendar/calendar.js","../src/components/slot-selector/base.js","../src/components/slot-selector/widget-date.js","../src/components/slot-selector/form/form.js","../src/components/slot-selector/empty-state/empty-state.js","../src/components/slot-selector/empty-state/access-denied.js","../src/components/slot-selector/slot-list/slot-item.js","../src/components/slot-selector/slot-list/slot-list.js","../src/components/slot-selector/event/event.js","../src/components/slot-selector/slot-selector.js","../src/public.js"],"sourcesContent":["import { Event, Loc, Tag, Text, Type } from 'main.core';\nimport 'ui.icon-set.actions';\nimport { MenuManager, Menu } from 'main.popup';\n\nexport type Member = {\n\tname: string,\n\tlastName: string,\n\tavatar: string,\n}\n\ntype MembersListParams = {\n\tmembers: Member[],\n\tavatarSize: number,\n\tclassName: string,\n\ttextClassName: string,\n};\n\nexport class MembersList\n{\n\t#layout: {\n\t\twrap: HTMLElement,\n\t\tavatarItems: HTMLElement,\n\t};\n\n\t#params: MembersListParams;\n\t#members: Member[];\n\n\tconstructor(params: MembersListParams)\n\t{\n\t\tthis.#layout = {};\n\n\t\tthis.#params = params;\n\t\tthis.#members = params.members;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!Type.isArrayFilled(this.#members))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.wrap = Tag.render`\n\t\t\t<div class=\"${this.#params.className}\">\n\t\t\t\t<div class=\"${this.#params.textClassName}\">\n\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_MEETING_HAS_MORE_USERS')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"calendar-pub-line-avatar-container\" style=\"--ui-icon-size: ${this.#params.avatarSize}px\">\n\t\t\t\t\t${this.#renderAvatarItems()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tlet handleScroll;\n\t\tconst menu = MenuManager.create({\n\t\t\tid: 'calendar-pub-welcome-more-avatar-popup' + Date.now(),\n\t\t\tbindElement: this.#layout.avatarItems,\n\t\t\tclassName: 'calendar-pub-users-popup',\n\t\t\titems: this.#members.map((member) => ({\n\t\t\t\thtml: Tag.render`\n\t\t\t\t\t<div class=\"calendar-pub-users-popup-avatar-container\">\n\t\t\t\t\t\t${this.#renderAvatar(member, 'calendar-pub-users-popup-avatar')}\n\t\t\t\t\t\t<div class=\"calendar-pub-users-popup-avatar-text\">\n\t\t\t\t\t\t\t${Text.encode(`${member.name} ${member.lastName}`)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t})),\n\t\t\tautoHide: false,\n\t\t\tmaxHeight: 500,\n\t\t\tmaxWidth: 300,\n\t\t\toffsetLeft: - 2 * this.#layout.avatarItems.offsetWidth,\n\t\t\tevents: {\n\t\t\t\tonShow: () => {\n\t\t\t\t\tconst menuWidth = menu.getPopupWindow().getPopupContainer().offsetWidth;\n\t\t\t\t\tmenu.getPopupWindow().setOffset({\n\t\t\t\t\t\toffsetLeft: this.#layout.avatarItems.offsetWidth / 2 - menuWidth / 2,\n\t\t\t\t\t});\n\t\t\t\t\tmenu.getPopupWindow().adjustPosition();\n\n\t\t\t\t\tdocument.addEventListener('scroll', handleScroll, true);\n\t\t\t\t},\n\t\t\t\tonClose: () => {\n\t\t\t\t\tdocument.removeEventListener('scroll', handleScroll, true);\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\t\thandleScroll = () => menu.getPopupWindow().adjustPosition();\n\n\t\tthis.#bindShowOnHover(menu);\n\n\t\treturn this.#layout.wrap;\n\t}\n\n\t#renderAvatarItems()\n\t{\n\t\tconst maxAvatarsCount = 4;\n\t\tconst showMoreIcon = this.#members.length > maxAvatarsCount;\n\t\tconst avatarsCount = showMoreIcon ? maxAvatarsCount - 1 : maxAvatarsCount;\n\t\tconst avatarClassName = 'calendar-pub-line-avatar';\n\n\t\tthis.#layout.avatarItems = Tag.render`\n\t\t\t<div class=\"calendar-pub-line-avatars\">\n\t\t\t\t${this.#members.slice(0, avatarsCount).map((member) => this.#renderAvatar(member, avatarClassName))}\n\t\t\t\t${showMoreIcon ? this.#renderMoreAvatar() : ''}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.avatarItems;\n\t}\n\n\t#renderMoreAvatar(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<span class=\"ui-icon ui-icon-common-user calendar-pub-line-avatar calendar-pub-line-avatar-more-container\">\n\t\t\t\t<div class=\"ui-icon-set --more calendar-pub-line-avatar-more\"></div>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\t#bindShowOnHover(menu: Menu): void\n\t{\n\t\tconst bindElement = menu.bindElement;\n\t\tconst menuContainer = menu.getMenuContainer();\n\n\t\tlet hoverElement = null;\n\n\t\tconst closeMenuHandler = () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (!menuContainer.contains(hoverElement) && !bindElement.contains(hoverElement))\n\t\t\t\t{\n\t\t\t\t\tmenu.close();\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t};\n\t\tconst showMenuHandler = () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (bindElement.contains(hoverElement))\n\t\t\t\t{\n\t\t\t\t\tmenu.show();\n\t\t\t\t}\n\t\t\t}, 300);\n\t\t};\n\n\t\tEvent.bind(document, 'mouseover', (event) => {\n\t\t\thoverElement = event.target;\n\t\t});\n\t\tEvent.bind(bindElement, 'mouseenter', showMenuHandler);\n\t\tEvent.bind(bindElement, 'mouseleave', closeMenuHandler);\n\t\tEvent.bind(menuContainer, 'mouseleave', closeMenuHandler);\n\t}\n\n\t#renderAvatar(member, className = ''): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<span class=\"ui-icon ui-icon-common-user ${className}\">\n\t\t\t\t<i style=\"${this.#hasAvatar(member) ? `background-image: url('${member.avatar}')` : ''}\"></i>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\t#hasAvatar(member)\n\t{\n\t\treturn Type.isStringFilled(member.avatar) && member.avatar !== '/bitrix/images/1.gif';\n\t}\n}","import { Tag, Loc, Event, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport 'ui.icons.b24';\nimport { Member, MembersList } from './layout/members-list';\n\ntype WelcomeOptions = {\n\towner: any,\n\tlink: any,\n\tcurrentLang: string,\n\tmembers: Member[],\n}\n\nexport default class Welcome\n{\n\t#owner;\n\t#link;\n\t#currentLang;\n\t#name;\n\t#lastName;\n\t#photo;\n\t#layout;\n\t#members;\n\n\tconstructor(options: WelcomeOptions)\n\t{\n\t\tthis.#owner = options.owner || null;\n\t\tthis.#link = options.link || null;\n\t\tthis.#currentLang = options.currentLang || null;\n\t\tthis.#name = this.#owner.name || null;\n\t\tthis.#lastName = this.#owner.lastName || null;\n\t\tthis.#photo = this.#owner.photo || null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tbutton: null,\n\t\t\tlabel: null,\n\t\t};\n\t\tthis.#members = options.members;\n\n\t\tif (\n\t\t\tthis.#link\n\t\t\t&& this.#link.type === 'crm_deal'\n\t\t\t&& this.#link.active === true\n\t\t\t&& this.#link.lastStatus !== 'viewed'\n\t\t\t&& this.#link.lastStatus !== 'notViewed'\n\t\t)\n\t\t{\n\t\t\tthis.#handleTimelineNotify('notViewed');\n\t\t\tthis.#link.lastStatus = 'notViewed';\n\t\t}\n\t}\n\n\tdisableButton()\n\t{\n\t\tDom.addClass(this.#layout.button, '--disabled');\n\t}\n\n\tenableButton()\n\t{\n\t\tDom.removeClass(this.#layout.button, '--disabled');\n\t}\n\n\thideButton()\n\t{\n\t\tDom.addClass(this.#layout.button, '--hidden');\n\t}\n\n\thandleWelcomePageButtonClick()\n\t{\n\t\tif (Dom.hasClass(this.#layout.button, '--disabled'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tthis.#link\n\t\t\t&& this.#link.type === 'crm_deal'\n\t\t\t&& this.#link.active === true\n\t\t\t&& this.#link.lastStatus === 'notViewed'\n\t\t)\n\t\t{\n\t\t\tthis.#handleTimelineNotify('viewed');\n\t\t\tthis.#link.lastStatus = 'viewed';\n\t\t}\n\n\t\tthis.disableButton();\n\t\tEventEmitter.emit('showSlotSelector', this);\n\t}\n\n\t#handleTimelineNotify(mode)\n\t{\n\t\tBX.ajax.runAction('calendar.api.sharingajax.handleTimelineNotify', {\n\t\t\tdata: {\n\t\t\t\tlinkHash: this.#link.hash,\n\t\t\t\tentityId: this.#link.entityId,\n\t\t\t\tentityType: this.#link.type,\n\t\t\t\tnotifyType: mode,\n\t\t\t},\n\t\t});\n\t}\n\n\t#getNodeButton(): HTMLElement\n\t{\n\t\tif (!this.#layout.button)\n\t\t{\n\t\t\tthis.#layout.button = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__btn\">\n\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_SELECT_SLOT')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.button, 'click', () => {\n\t\t\t\tthis.handleWelcomePageButtonClick();\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe('hideSlotSelector', this.enableButton.bind(this));\n\t\t}\n\n\t\treturn this.#layout.button;\n\t}\n\n\t#getNodeLabel()\n\t{\n\t\tif (!this.#layout.label)\n\t\t{\n\t\t\tthis.#layout.label = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__block-label\"></div>\n\t\t\t`;\n\n\t\t\tif (this.#currentLang === 'ru')\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.label, '--ru');\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.label;\n\t}\n\n\tsetAccessDenied()\n\t{\n\t\tthis.#layout.info = this.#getNodeInfo(true);\n\t}\n\n\t#getNodeInfo(accessDenied = false)\n\t{\n\t\tif (!this.#layout.info)\n\t\t{\n\t\t\tthis.#layout.infoTitle = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__typography-title calendar-pub__welcome-info_title\"></div>\n\t\t\t`;\n\t\t\tthis.#layout.infoSubTitle = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__typography-s calendar-pub__welcome-info_subtitle\"></div>\n\t\t\t`;\n\n\t\t\tthis.#layout.info = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__welcome-info\">\n\t\t\t\t\t${this.#layout.infoTitle}\n\t\t\t\t\t${this.#layout.infoSubTitle}\n\t\t\t\t\t${this.#renderAvatarsSection(this.#members)}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tlet title = Loc.getMessage('CALENDAR_SHARING_MY_FREE_SLOTS');\n\t\tlet subTitle = Loc.getMessage('CALENDAR_SHARING_YOU_CAN_CHOOSE_FREE_MEETING_TIME');\n\t\tif (accessDenied)\n\t\t{\n\t\t\ttitle = Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED');\n\t\t\tsubTitle = Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED_INFO');\n\t\t}\n\n\t\tthis.#layout.infoTitle.innerText = title;\n\t\tthis.#layout.infoSubTitle.innerText = subTitle;\n\n\t\treturn this.#layout.info;\n\t}\n\n\t#renderAvatarsSection(members)\n\t{\n\t\treturn new MembersList({\n\t\t\tclassName: 'calendar-pub-welcome-avatar-section-container',\n\t\t\ttextClassName: 'calendar-pub-ui__typography-xs-uppercase',\n\t\t\tavatarSize: 36,\n\t\t\tmembers,\n\t\t}).render();\n\t}\n\n\trender()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__block --welcome\">\n\t\t\t\t${this.#getNodeLabel()}\n\t\t\t\t<div class=\"calendar-pub__welcome\">\n\t\t\t\t\t<div class=\"calendar-pub__welcome-user\">\n\t\t\t\t\t\t<div class=\"calendar-pub__welcome-userpic ui-icon ui-icon-common-user\">\n\t\t\t\t\t\t\t<i ${this.#photo ? `style=\"background-image: url(${encodeURI(this.#photo)})\"` : ''}></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-pub-ui__typography-m\">\n\t\t\t\t\t\t\t${this.#name || ''} ${this.#lastName || ''} \n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-pub__block-separator\"></div>\n\t\t\t\t\t${this.#getNodeInfo()}\n\t\t\t\t\t<div class=\"calendar-pub__welcome-bottom\">\n\t\t\t\t\t\t${this.#getNodeButton()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { Tag, Dom, Event } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\ntype DayOptions = {\n\tvalue: number,\n\tnotCurrentMonth: boolean,\n\ttoday: boolean,\n\tselected: boolean,\n\tweekend: boolean,\n\tenableBooking: boolean,\n\tslots: Object,\n}\n\nexport default class Day\n{\n\t#layout;\n\t#value;\n\t#notCurrentMonth;\n\t#today;\n\t#selected;\n\t#weekend;\n\t#slots;\n\t#enableBooking;\n\n\tconstructor(options: DayOptions)\n\t{\n\t\tthis.#value = options.value || null;\n\t\tthis.#notCurrentMonth = options.notCurrentMonth || null;\n\t\tthis.#today = options.today || null;\n\t\tthis.#slots = options.slots || null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t};\n\t\tthis.#selected = options.selected || null;\n\t\tthis.#weekend = options.weekend || null;\n\t\tthis.#enableBooking = options.enableBooking || null;\n\n\t\tif (this.#selected)\n\t\t{\n\t\t\tthis.select();\n\t\t}\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEvent.bind(this.#getNodeWrapper(), 'click', this.select.bind(this));\n\t}\n\n\tisSelected()\n\t{\n\t\treturn this.#selected;\n\t}\n\n\tgetDay()\n\t{\n\t\treturn this.#value;\n\t}\n\n\tisEnableBooking()\n\t{\n\t\treturn this.#enableBooking;\n\t}\n\n\tselect()\n\t{\n\t\tthis.highlight();\n\t\tEventEmitter.emit('switchSlots', {\n\t\t\tslots: this.#slots,\n\t\t});\n\t}\n\n\thighlight()\n\t{\n\t\tthis.#selected = true;\n\t\tDom.addClass(this.#getNodeWrapper(), '--selected');\n\t\tEventEmitter.emit('selectDate', this);\n\t}\n\n\tunSelect()\n\t{\n\t\tthis.#selected = null;\n\t\tDom.removeClass(this.#getNodeWrapper(), '--selected');\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__month-col --day\">${this.#value}</div>\n\t\t\t`;\n\n\t\t\tif (this.#notCurrentMonth)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.wrapper, '--not-current-month');\n\t\t\t}\n\n\t\t\tif (this.#weekend)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.wrapper, '--weekend');\n\t\t\t}\n\n\t\t\tif (this.#enableBooking)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.wrapper, '--enable-booking');\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n}\n","import { Tag, Loc, Type, Dom, Event, Browser } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Util } from 'calendar.util';\nimport Day from './day';\nimport { DateTimeFormat } from 'main.date';\nimport { MenuManager } from 'main.popup';\n\nexport default class Calendar\n{\n\t#userIds;\n\t#accessibility;\n\t#layout;\n\t#currentMonth;\n\t#currentYear;\n\t#nowTime;\n\t#months;\n\t#selectedDay;\n\t#monthsSlotsMap;\n\t#timezoneOffsetUtc;\n\t#selectedTimezoneOffsetUtc;\n\t#currentMonthIndex;\n\t#currentDayNumber;\n\t#timezoneList;\n\t#calendarSettings;\n\t#rule;\n\t#selectedTimezoneId;\n\t#selectedTimezoneNode;\n\t#config;\n\t#loc;\n\t#timeZonePopup;\n\n\tconstructor(options)\n\t{\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tmonthWrapper: null,\n\t\t\ttimezoneWrapper: null,\n\t\t\tmonth: null,\n\t\t\tcurrentMonth: null,\n\t\t\tprevNav: null,\n\t\t\tnextNav: null,\n\t\t\tdaysOfWeek: null,\n\t\t\tnavigation: null,\n\t\t\tback: null,\n\t\t};\n\n\t\tthis.#userIds = options.userIds;\n\t\tthis.#accessibility = options.accessibility;\n\t\tthis.#timezoneList = options.timezoneList;\n\t\tthis.#calendarSettings = options.calendarSettings;\n\t\tthis.#rule = options.rule;\n\n\t\tthis.#nowTime = new Date();\n\t\tthis.#currentMonthIndex = 0;\n\t\tthis.#currentDayNumber = 1;\n\t\tthis.#selectedTimezoneId = Intl.DateTimeFormat().resolvedOptions().timeZone || 'UTC';\n\t\tthis.#currentMonth = this.#nowTime.getMonth();\n\t\tthis.#currentYear = this.#nowTime.getFullYear();\n\t\tthis.#timezoneOffsetUtc = this.#nowTime.getTimezoneOffset();\n\t\tthis.#selectedTimezoneOffsetUtc = this.#nowTime.getTimezoneOffset();\n\t\tthis.#months = [];\n\t\tthis.#monthsSlotsMap = [];\n\n\t\tthis.#config = {\n\t\t\tslotSize: this.#rule.slotSize,\n\t\t\tfreeTime: {},\n\t\t\tstepSize: 30,\n\t\t\tweekHolidays: [6, 0],\n\t\t\tweekStart: 1,\n\t\t};\n\t\tthis.#loc = {\n\t\t\tweekdays: Util.getWeekdaysLoc(),\n\t\t};\n\t\tthis.#timeZonePopup = null;\n\n\t\tthis.#initConfig();\n\t\tthis.#initCurrentMonthSlots();\n\t\tthis.#bindEvents();\n\n\t\t// preload the next month's accessibilities\n\t\tconst nextYear = this.#getNextYear();\n\t\tconst nextMonth = this.#getNextMonth();\n\t\tthis.#loadMonthAccessibility(nextYear, nextMonth, false);\n\n\t\tsetInterval(this.#incrementTime.bind(this), 15000);\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('selectDate', (event) => {\n\t\t\tconst newSelectedDay = event.data;\n\t\t\tif (this.#selectedDay !== newSelectedDay)\n\t\t\t{\n\t\t\t\tthis.#selectedDay?.unSelect();\n\t\t\t}\n\n\t\t\tthis.#selectedDay = newSelectedDay;\n\t\t\tthis.#currentDayNumber = this.#selectedDay.getDay();\n\t\t});\n\n\t\tEventEmitter.subscribe('onSaveEvent', async (event) => {\n\t\t\tif (event.data.state === 'created' || event.data.state === 'not-created')\n\t\t\t{\n\t\t\t\tawait this.updateEventSlotsList();\n\t\t\t\tthis.highlightMonthDay();\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('onDeleteEvent', async () => {\n\t\t\tawait this.updateEventSlotsList();\n\t\t});\n\n\t\tEventEmitter.subscribe('onCreateAnotherEventButtonClick', () => {\n\t\t\tthis.selectFirstAvailableDay();\n\t\t});\n\t}\n\n\t#incrementTime()\n\t{\n\t\tthis.#nowTime = new Date();\n\n\t\tconst timezoneNode = this.#getNodeTimeZone();\n\t\tDom.clean(this.#getNodeTimezoneWrapper());\n\t\tDom.append(timezoneNode, this.#getNodeTimezoneWrapper());\n\t}\n\n\t#initConfig()\n\t{\n\t\tif (this.#calendarSettings.weekHolidays)\n\t\t{\n\t\t\tthis.#config.weekHolidays = this.#calendarSettings.weekHolidays.map(\n\t\t\t\t(weekDay) => Util.getIndByWeekDay(weekDay),\n\t\t\t);\n\t\t}\n\n\t\tif (this.#calendarSettings.yearHolidays)\n\t\t{\n\t\t\tthis.#config.yearHolidays = this.#calendarSettings.yearHolidays;\n\t\t}\n\n\t\tif (this.#calendarSettings.weekStart)\n\t\t{\n\t\t\tthis.#config.weekStart = Util.getIndByWeekDay(this.#calendarSettings.weekStart);\n\t\t\tthis.#loc.weekdays.push(...this.#loc.weekdays.splice(0, this.#config.weekStart));\n\t\t}\n\n\t\tfor (const range of this.#rule.ranges)\n\t\t{\n\t\t\tfor (const weekday of range.weekdays)\n\t\t\t{\n\t\t\t\tthis.#config.freeTime[weekday] ??= [];\n\t\t\t\tthis.#config.freeTime[weekday].push({\n\t\t\t\t\tfrom: parseInt(range.from, 10),\n\t\t\t\t\tto: parseInt(range.to, 10),\n\t\t\t\t});\n\n\t\t\t\tconst [intersected, notIntersected] = this.#separate((interval) => this.#doIntervalsIntersect(\n\t\t\t\t\tinterval.from,\n\t\t\t\t\tinterval.to,\n\t\t\t\t\tparseInt(range.from, 10),\n\t\t\t\t\tparseInt(range.to, 10),\n\t\t\t\t), this.#config.freeTime[weekday]);\n\n\t\t\t\tif (intersected.length > 0)\n\t\t\t\t{\n\t\t\t\t\tconst from = Math.min(...intersected.map(interval => interval.from));\n\t\t\t\t\tconst to = Math.max(...intersected.map(interval => interval.to));\n\n\t\t\t\t\tthis.#config.freeTime[weekday] = [...notIntersected, { from, to }];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst timezoneOffset = Util.getTimeZoneOffset(this.#selectedTimezoneId);\n\t\tconst serverOffset = parseInt(this.#calendarSettings.serverOffset, 10);\n\t\tconst offset = serverOffset + timezoneOffset;\n\t\tfor (const weekday in this.#config.freeTime)\n\t\t{\n\t\t\tthis.#config.freeTime[weekday] = this.#config.freeTime[weekday].map((range) => {\n\t\t\t\treturn {\n\t\t\t\t\tfrom: range.from - offset,\n\t\t\t\t\tto: range.to - offset,\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif (this.#selectedTimezoneId === 'UTC' || !this.#timezoneList[this.#selectedTimezoneId])\n\t\t{\n\t\t\tthis.#selectedTimezoneId = 'Africa/Dakar';\n\t\t}\n\t}\n\n\t#separate(take, array)\n\t{\n\t\treturn array.reduce(([t, f], e) => (take(e) ? [[...t, e], f] : [t, [...f, e]]), [[], []]);\n\t}\n\n\t#initCurrentMonthSlots()\n\t{\n\t\tthis.#calculateDateTimeSlots(this.#nowTime.getFullYear(), this.#nowTime.getMonth());\n\n\t\tconst month = this.#createMonth(this.#nowTime.getFullYear(), this.#nowTime.getMonth());\n\t\tthis.#months.push(month);\n\t}\n\n\t#calculateDateTimeSlots(year, month)\n\t{\n\t\tconst map = [];\n\t\tconst daysCount = new Date(year, month + 1, 0).getDate();\n\t\tconst accessibilityArrayKey = `${month + 1}.${year}`;\n\t\tconst nowTimestamp = this.#nowTime.getTime();\n\t\tconst timezoneOffset = (this.#selectedTimezoneOffsetUtc - this.#timezoneOffsetUtc) * (-60) * 1000;\n\n\t\tfor (let dayIndex = 1; dayIndex <= daysCount; dayIndex++)\n\t\t{\n\t\t\tconst currentDate = new Date(year, month, dayIndex);\n\n\t\t\tif (this.#isYearHoliday(currentDate))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst freeTime = this.#config.freeTime[currentDate.getDay()];\n\t\t\tif (Type.isUndefined(freeTime))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const range of freeTime)\n\t\t\t{\n\t\t\t\tconst from = new Date(year, month, dayIndex, Math.floor(range.from / 60), range.from % 60);\n\t\t\t\tconst to = new Date(year, month, dayIndex, Math.floor(range.to / 60), range.to % 60);\n\n\t\t\t\tconst dayAccessibility = this.#accessibility[accessibilityArrayKey].filter((event) => {\n\t\t\t\t\tconst parseUTC = !event.isFullDay;\n\t\t\t\t\treturn this.#doIntervalsIntersect(\n\t\t\t\t\t\tBX.parseDate(event.from, parseUTC).getTime(),\n\t\t\t\t\t\tBX.parseDate(event.to, parseUTC).getTime(),\n\t\t\t\t\t\tfrom.getTime(),\n\t\t\t\t\t\tto.getTime(),\n\t\t\t\t\t);\n\t\t\t\t});\n\n\t\t\t\twhile (from.getTime() < to.getTime())\n\t\t\t\t{\n\t\t\t\t\tconst slotStart = from.getTime();\n\t\t\t\t\tconst slotEnd = slotStart + this.#config.slotSize * 60 * 1000;\n\n\t\t\t\t\tif (slotEnd > to.getTime())\n\t\t\t\t\t{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst slotAccessibility = dayAccessibility.filter((event) => {\n\t\t\t\t\t\tconst parseUTC = !event.isFullDay;\n\t\t\t\t\t\treturn this.#doIntervalsIntersect(\n\t\t\t\t\t\t\tBX.parseDate(event.from, parseUTC).getTime(),\n\t\t\t\t\t\t\tBX.parseDate(event.to, parseUTC).getTime(),\n\t\t\t\t\t\t\tslotStart,\n\t\t\t\t\t\t\tslotEnd,\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\n\t\t\t\t\tconst available = slotAccessibility.length === 0 && slotStart > nowTimestamp;\n\t\t\t\t\tif (available)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst timeFrom = new Date(slotStart + timezoneOffset);\n\t\t\t\t\t\tconst timeTo = new Date(timeFrom.getTime() + (slotEnd - slotStart));\n\t\t\t\t\t\tconst dateIndex = timeFrom.getDate();\n\t\t\t\t\t\tmap[dateIndex] ??= [];\n\t\t\t\t\t\tif (timeFrom.getMonth() === month)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmap[dateIndex].push({ timeFrom, timeTo });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfrom.setTime(from.getTime() + this.#config.stepSize * 60 * 1000);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.#monthsSlotsMap[accessibilityArrayKey] = map;\n\t}\n\n\t#doIntervalsIntersect(from1, to1, from2, to2)\n\t{\n\t\tconst startsInside = from2 <= from1 && from1 < to2;\n\t\tconst endsInside = from2 < to1 && to1 <= to2;\n\t\tconst startsBeforeEndsAfter = from1 <= from2 && to1 >= to2;\n\n\t\treturn startsInside || endsInside || startsBeforeEndsAfter;\n\t}\n\n\t#createMonth(year, month)\n\t{\n\t\treturn {\n\t\t\tyear,\n\t\t\tmonth,\n\t\t\tcurrentTimezoneOffset: this.#selectedTimezoneOffsetUtc,\n\t\t\tname: this.#getMonthName(month),\n\t\t\tdays: this.#getMonthDays(year, month),\n\t\t};\n\t}\n\n\tasync updateEventSlotsList()\n\t{\n\t\tconst month = this.#months[this.#currentMonthIndex];\n\t\tconst currentYear = month.year;\n\t\tconst currentMonth = month.month + 1;\n\n\t\tawait this.#loadMonthAccessibility(currentYear, currentMonth);\n\n\t\tthis.#reCreateCurrentMonth();\n\t}\n\n\t#reCreateCurrentMonth()\n\t{\n\t\tthis.#updateMonth(this.#currentMonthIndex);\n\t\tthis.#updateCalendar();\n\t}\n\n\tasync #createNextMonth()\n\t{\n\t\tthis.nextMonthCreating = true;\n\t\tconst currentMonth = this.#months[this.#currentMonthIndex];\n\t\tconst currentYear = currentMonth.year;\n\t\tconst currentMonthIndex = currentMonth.month;\n\n\t\tconst nextMonthIndex = (currentMonthIndex + 1) % 12;\n\t\tconst nextYear = currentYear + Math.floor((currentMonthIndex + 1) / 12);\n\t\tconst nextMonth = nextMonthIndex + 1;\n\n\t\tawait this.#loadMonthAccessibility(nextYear, nextMonth);\n\n\t\tthis.#calculateDateTimeSlots(nextYear, nextMonthIndex);\n\n\t\tconst month = this.#createMonth(nextYear, nextMonthIndex);\n\t\tthis.#months.push(month);\n\t\tthis.nextMonthCreating = false;\n\t}\n\n\t#getNextMonth()\n\t{\n\t\tconst currentMonth = this.#months[this.#currentMonthIndex];\n\t\tconst currentMonthIndex = currentMonth.month;\n\n\t\tconst nextMonthIndex = (currentMonthIndex + 1) % 12;\n\t\treturn nextMonthIndex + 1;\n\t}\n\n\t#getNextYear()\n\t{\n\t\tconst currentMonth = this.#months[this.#currentMonthIndex];\n\t\tconst currentYear = currentMonth.year;\n\t\tconst currentMonthIndex = currentMonth.month;\n\n\t\treturn currentYear + Math.floor((currentMonthIndex + 1) / 12);\n\t}\n\n\tasync #loadMonthAccessibility(year, month, preloadNextMonth = true)\n\t{\n\t\tconst arrayKey = `${month}.${year}`;\n\t\tconst firstMonthDay = new Date(year, month - 1, 1);\n\t\tconst lastMonthDay = new Date(year, month, 0, 23, 59);\n\n\t\tif (!this.#accessibility[arrayKey])\n\t\t{\n\t\t\tconst response = await BX.ajax.runAction('calendar.api.sharingajax.getUsersAccessibility', {\n\t\t\t\tdata: {\n\t\t\t\t\tuserIds: this.#userIds,\n\t\t\t\t\ttimestampFrom: firstMonthDay.getTime(),\n\t\t\t\t\ttimestampTo: lastMonthDay.getTime(),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.#accessibility[arrayKey] = response.data;\n\t\t}\n\n\t\tif (preloadNextMonth === false)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst nextMonthIndex = (month) % 12;\n\t\tconst nextYear = year + Math.floor((month) / 12);\n\t\tconst nextMonth = nextMonthIndex + 1;\n\n\t\tthis.#loadMonthAccessibility(nextYear, nextMonth, false);\n\t}\n\n\t#getMonthName(month)\n\t{\n\t\tconst currentMonthDate = new Date(this.#nowTime.getFullYear(), month, 1);\n\n\t\treturn DateTimeFormat.format('f', currentMonthDate.getTime() / 1000);\n\t}\n\n\t#getMonthDays(year, month)\n\t{\n\t\tconst days = [];\n\t\tconst daysCount = new Date(year, month + 1, 0).getDate();\n\t\tconst accessibilityArrayKey = `${month + 1}.${year}`;\n\n\t\tfor (let dayIndex = 1; dayIndex <= daysCount; dayIndex++)\n\t\t{\n\t\t\tconst newDay = new Date(year, month, dayIndex);\n\t\t\tconst slots = this.#monthsSlotsMap[accessibilityArrayKey][newDay.getDate()] ?? [];\n\n\t\t\tconst params = {\n\t\t\t\tvalue: dayIndex,\n\t\t\t\tslots,\n\t\t\t\tweekend: this.#isHoliday(newDay),\n\t\t\t\tenableBooking: slots.length > 0,\n\t\t\t};\n\n\t\t\tconst day = new Day(params);\n\t\t\tdays.push(day);\n\t\t}\n\n\t\treturn days;\n\t}\n\n\tselectFirstAvailableDay()\n\t{\n\t\tlet visibleDays = this.#months[this.#currentMonthIndex].days;\n\t\tif (this.#currentMonthIndex === 0)\n\t\t{\n\t\t\tconst todayDay = this.#nowTime.getDate();\n\t\t\tvisibleDays = visibleDays.filter((day) => day.getDay() >= todayDay).slice(0, 14);\n\t\t}\n\t\tlet dayToSelect = visibleDays.find((day) => day.isEnableBooking());\n\t\tif (dayToSelect === undefined)\n\t\t{\n\t\t\tdayToSelect = visibleDays[0];\n\t\t}\n\n\t\tdayToSelect.select();\n\t}\n\n\tselectMonthDay()\n\t{\n\t\tconst dayToSelect = this.#getDayToSelect();\n\n\t\tthis.#currentDayNumber = dayToSelect.day;\n\t\tdayToSelect.select();\n\t}\n\n\thighlightMonthDay()\n\t{\n\t\tconst dayToSelect = this.#getDayToSelect();\n\n\t\tthis.#currentDayNumber = dayToSelect.day;\n\t\tdayToSelect.highlight();\n\t}\n\n\t#getDayToSelect()\n\t{\n\t\tconst monthDays = this.#months[this.#currentMonthIndex].days;\n\t\tlet dayToSelect = monthDays.find((day) => day.getDay() === this.#currentDayNumber);\n\t\tif (dayToSelect === undefined)\n\t\t{\n\t\t\tdayToSelect = monthDays[monthDays.length - 1];\n\t\t}\n\n\t\treturn dayToSelect;\n\t}\n\n\t#isHoliday(day)\n\t{\n\t\tconst monthKey = (`0${day.getMonth() + 1}`).slice(-2);\n\t\tconst dayMonthKey = `${day.getDate()}.${monthKey}`;\n\n\t\treturn (this.#config.weekHolidays.includes(day.getDay()) || this.#config.yearHolidays[dayMonthKey] !== undefined);\n\t}\n\n\t#isYearHoliday(day)\n\t{\n\t\tconst dayMonthKey = day.getDate() + '.' + ('0' + (day.getMonth() + 1)).slice(-2);\n\n\t\treturn this.#config.yearHolidays[dayMonthKey] !== undefined;\n\t}\n\n\tgetSelectedTimezoneId()\n\t{\n\t\treturn this.#selectedTimezoneId;\n\t}\n\n\t#getNodeTimeZone()\n\t{\n\t\tthis.#selectedTimezoneNode = Tag.render`\n\t\t\t<div class=\"calendar-sharing__timezone-value\">\n\t\t\t\t${this.#getFormattedTimezone(this.#selectedTimezoneId)}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst timezoneSelect = Tag.render`\n\t\t\t<div class=\"calendar-sharing__timezone\">\n\t\t\t\t${Browser.isMobile() ? this.#getNodeTimezoneSelect() : ''}\n\t\t\t\t<div class=\"calendar-sharing__timezone-area\">\n\t\t\t\t\t<div class=\"calendar-sharing__timezone-title\">${Loc.getMessage('CALENDAR_SHARING_YOR_TIME')}:</div>\n\t\t\t\t\t${this.#selectedTimezoneNode}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#getPopupTimezoneSelect();\n\n\t\tif (!Browser.isMobile())\n\t\t{\n\t\t\tEvent.bind(timezoneSelect, 'click', () => {\n\t\t\t\tconst timezonesPopup = this.#getPopupTimezoneSelect().getPopupWindow();\n\t\t\t\ttimezonesPopup.show();\n\n\t\t\t\tconst popupContent = timezonesPopup.getContentContainer();\n\t\t\t\tconst selectedTimezoneItem = popupContent.querySelector('.menu-popup-item.--selected');\n\t\t\t\tconst selectOffset = timezoneSelect.getBoundingClientRect().top\n\t\t\t\t\t+ timezoneSelect.offsetHeight / 4\n\t\t\t\t\t- popupContent.getBoundingClientRect().top\n\t\t\t\t;\n\t\t\t\tpopupContent.scrollTop = selectedTimezoneItem.offsetTop - selectOffset;\n\t\t\t});\n\t\t}\n\n\t\treturn timezoneSelect;\n\t}\n\n\t#getPopupTimezoneSelect()\n\t{\n\t\tif (this.#timeZonePopup?.getPopupWindow().isShown())\n\t\t{\n\t\t\treturn this.#timeZonePopup;\n\t\t}\n\n\t\tthis.#timeZonePopup?.destroy();\n\t\tconst items = Object.keys(this.#timezoneList).map((timezoneId) => ({\n\t\t\ttext: this.#getFormattedTimezone(timezoneId),\n\t\t\tclassName: (timezoneId === this.#selectedTimezoneId) ? 'menu-popup-no-icon --selected' : 'menu-popup-no-icon',\n\t\t\tonclick: () => {\n\t\t\t\tthis.#updateTimezone(timezoneId);\n\t\t\t\tthis.#timeZonePopup.close();\n\t\t\t},\n\t\t}));\n\n\t\tthis.#timeZonePopup = MenuManager.create({\n\t\t\tid: 'momomiomsiomx92984j',\n\t\t\tclassName: 'calendar-sharing-timezone-select-popup',\n\t\t\titems,\n\t\t\tautoHide: true,\n\t\t\tmaxHeight: window.innerHeight - 150,\n\t\t});\n\n\t\treturn this.#timeZonePopup;\n\t}\n\n\t#getNodeTimezoneSelect()\n\t{\n\t\tconst selectNode = Tag.render`\n\t\t\t<select class=\"calendar-sharing__timezone-select\">\n\t\t\t\t${Object.keys(this.#timezoneList).map((timezoneId) => Tag.render`\n\t\t\t\t\t<option value=\"${timezoneId}\" ${timezoneId === this.#selectedTimezoneId ? 'selected' : ''}>\n\t\t\t\t\t\t${this.#getFormattedTimezone(timezoneId)}\n\t\t\t\t\t</option>\n\t\t\t\t`)}\n\t\t\t</select>\n\t\t`;\n\n\t\tEvent.bind(selectNode, 'change', () => this.#updateTimezone(selectNode.value));\n\n\t\treturn selectNode;\n\t}\n\n\t#updateTimezone(timezoneId)\n\t{\n\t\tthis.#selectedTimezoneId = timezoneId;\n\t\tthis.#selectedTimezoneOffsetUtc = -(this.#timezoneList[this.#selectedTimezoneId].offset / 60);\n\t\tEventEmitter.emit('updateTimezone', { timezone: timezoneId });\n\t\tthis.#selectedTimezoneNode.innerHTML = this.#getFormattedTimezone(this.#selectedTimezoneId);\n\t\tthis.#reCreateCurrentMonth();\n\t\tthis.selectMonthDay();\n\t}\n\n\t#getFormattedTimezone(timezoneId)\n\t{\n\t\treturn `${this.getTimezonePrefix(this.#timezoneList[timezoneId].offset)} - ${timezoneId}`;\n\t}\n\n\tgetTimezonePrefix(timezoneOffset)\n\t{\n\t\tconst offset = timezoneOffset * 1000 - this.#timezoneOffsetUtc * (-60000);\n\t\tconst date = new Date(this.#nowTime.getTime() + offset);\n\n\t\treturn DateTimeFormat.format(Util.getTimeFormatShort(), date.getTime() / 1000);\n\t}\n\n\t#getNodeDaysOfWeek(): HTMLElement\n\t{\n\t\tif (!this.#layout.daysOfWeek)\n\t\t{\n\t\t\tconst nodesWeekDays = this.#loc.weekdays.map((weekDay) => {\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"calendar-sharing__month-col --day-of-week\">${weekDay}</div>\n\t\t\t\t`;\n\t\t\t});\n\n\t\t\tthis.#layout.daysOfWeek = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__month-row\">${nodesWeekDays}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.daysOfWeek;\n\t}\n\n\t#getNodeDay(param = {}): HTMLElement\n\t{\n\t\tparam.selected = this.#selectedDay?.getDay() === param.value && param.currentMonth === true;\n\t\tconst day = new Day(param);\n\n\t\treturn day.render();\n\t}\n\n\t#getNodeMonth()\n\t{\n\t\tconst monthInfo = this.#months[this.#currentMonthIndex];\n\t\tconst year = monthInfo.year;\n\t\tconst month = monthInfo.month;\n\n\t\tconst firstDayOfMonth = (new Date(year, month, 7).getDay() - (this.#config.weekStart - 1) + 7) % 7;\n\t\tconst lastDateOfMonth = new Date(year, month + 1, 0).getDate();\n\t\tconst lastDayOfLastMonth = month === 0\n\t\t\t? new Date(year - 1, 11, 0).getDate()\n\t\t\t: new Date(year, month, 0).getDate()\n\t\t;\n\n\t\tconst nodeMonth = Tag.render`<div class=\"calendar-sharing__month-row\"></div>`;\n\n\t\tlet k = lastDayOfLastMonth - firstDayOfMonth + 1;\n\t\tfor (let j = 0; j < firstDayOfMonth; j++)\n\t\t{\n\t\t\tDom.append(this.#getNodeDay({\n\t\t\t\tvalue: k,\n\t\t\t\tnotCurrentMonth: true,\n\t\t\t}), nodeMonth);\n\t\t\tk++;\n\t\t}\n\n\t\tfor (let i = 0; i <= lastDateOfMonth - 1; i++)\n\t\t{\n\t\t\tconst day = monthInfo.days[i];\n\t\t\tDom.append(day.render(), nodeMonth);\n\t\t}\n\n\t\tlet dayOfWeek = (new Date(year, month, lastDateOfMonth).getDay() - this.#config.weekStart + 7) % 7;\n\t\tfor (dayOfWeek, k = 1; dayOfWeek < 6; dayOfWeek++)\n\t\t{\n\t\t\tDom.append(this.#getNodeDay({\n\t\t\t\tvalue: k,\n\t\t\t\tnotCurrentMonth: true,\n\t\t\t}), nodeMonth);\n\t\t\tk++;\n\t\t}\n\n\t\tconst result = Tag.render`\n\t\t\t<div class=\"calendar-sharing__month\">\n\t\t\t\t${this.#getNodeDaysOfWeek()}\n\t\t\t\t${nodeMonth}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst touchPosition = {\n\t\t\tx: null,\n\t\t};\n\n\t\tconst touchMove = (ev) => {\n\t\t\ttouchPosition.x = ev.changedTouches[0].clientX;\n\t\t};\n\n\t\tEvent.bind(result, 'touchstart', (ev) => {\n\t\t\ttouchMove(ev);\n\t\t});\n\n\t\tEvent.bind(result, 'touchend', (ev) => {\n\t\t\tif (touchPosition.x < ev.changedTouches[0].clientX - 100)\n\t\t\t{\n\t\t\t\tthis.#handlePreviousMonthArrowClick();\n\t\t\t}\n\n\t\t\tif (touchPosition.x > ev.changedTouches[0].clientX + 100)\n\t\t\t{\n\t\t\t\tthis.#handleNextMonthArrowClick();\n\t\t\t}\n\n\t\t\tresult.style.removeProperty('transform');\n\t\t});\n\n\t\tEvent.bind(result, 'touchmove', (ev) => {\n\t\t\tev.preventDefault();\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#getNodeMonthWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.monthWrapper)\n\t\t{\n\t\t\tthis.#layout.monthWrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --month\">\n\t\t\t\t\t${this.#getNodeMonth()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.monthWrapper;\n\t}\n\n\t#getNodeTimezoneWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.timezoneWrapper)\n\t\t{\n\t\t\tthis.#layout.timezoneWrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block\">\n\t\t\t\t\t${this.#getNodeTimeZone()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.timezoneWrapper;\n\t}\n\n\t#getNodeCurrentMonth()\n\t{\n\t\tif (!this.#layout.currentMonth)\n\t\t{\n\t\t\tconst currentMonthName = this.#months[this.#currentMonthIndex].name;\n\t\t\tconst currentYear = this.#months[this.#currentMonthIndex].year;\n\t\t\tthis.#layout.currentMonth = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-title-day calendar-pub-ui__typography-title\">${currentMonthName}, ${currentYear}</div>\n\t\t\t`;\n\n\t\t\tEventEmitter.subscribe(this, 'updateCalendar', () => {\n\t\t\t\tconst currentMonthName = this.#months[this.#currentMonthIndex].name;\n\t\t\t\tconst currentYear = this.#months[this.#currentMonthIndex].year;\n\n\t\t\t\tthis.#layout.currentMonth.innerHTML = `${currentMonthName}, ${currentYear}`;\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.currentMonth;\n\t}\n\n\t#updateCalendar(direction)\n\t{\n\t\tDom.clean(this.#getNodeMonthWrapper());\n\t\tconst nodeMonth = this.#getNodeMonth();\n\n\t\tif (Type.isString(direction))\n\t\t{\n\t\t\tDom.addClass(nodeMonth, `--animate-${direction}`);\n\t\t\tEvent.bind(nodeMonth, 'animationend', () => {\n\t\t\t\tDom.removeClass(nodeMonth, `--animate-${direction}`);\n\t\t\t}, { once: true });\n\t\t}\n\n\t\tDom.append(nodeMonth, this.#getNodeMonthWrapper());\n\t\tEventEmitter.emit(this, 'updateCalendar');\n\n\t\tif (this.#currentMonthIndex === 0)\n\t\t{\n\t\t\tDom.addClass(this.#layout.prevNav, '--disabled');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.#layout.prevNav, '--disabled');\n\t\t}\n\t}\n\n\t#getNodePrevNav(): HTMLElement\n\t{\n\t\tif (!this.#layout.prevNav)\n\t\t{\n\t\t\tthis.#layout.prevNav = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-nav_prev --disabled\" title=\"${Loc.getMessage('CALENDAR_SHARING_NAV_PREV')}\"></div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.prevNav, 'click', this.#handlePreviousMonthArrowClick.bind(this));\n\t\t}\n\n\t\treturn this.#layout.prevNav;\n\t}\n\n\t#getNodeNextNav(): HTMLElement\n\t{\n\t\tif (!this.#layout.nextNav)\n\t\t{\n\t\t\tthis.#layout.nextNav = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-nav_next\" title=\"${Loc.getMessage('CALENDAR_SHARING_NAV_NEXT')}\"></div>\n\t\t\t`;\n\t\t\tEvent.bind(this.#layout.nextNav, 'click', this.#handleNextMonthArrowClick.bind(this));\n\t\t}\n\n\t\treturn this.#layout.nextNav;\n\t}\n\n\t#getNodeNavigation(): HTMLElement\n\t{\n\t\tif (!this.#layout.navigation)\n\t\t{\n\t\t\tthis.#layout.navigation = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-nav\">\n\t\t\t\t\t${this.#getNodePrevNav()}\n\t\t\t\t\t${this.#getNodeNextNav()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.navigation;\n\t}\n\n\tasync #handleNextMonthArrowClick()\n\t{\n\t\tif (this.#currentMonthIndex === this.#months.length - 1)\n\t\t{\n\t\t\tif (this.nextMonthCreating)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.#createNextMonth();\n\t\t}\n\n\t\tthis.#currentMonthIndex += 1;\n\t\tthis.#updateMonth(this.#currentMonthIndex);\n\n\t\tEventEmitter.emit(this, 'clickNextMonth');\n\t\tthis.#updateCalendar('next');\n\t\tthis.selectMonthDay();\n\t}\n\n\t#handlePreviousMonthArrowClick()\n\t{\n\t\tif (this.#currentMonthIndex === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#currentMonthIndex -= 1;\n\t\tthis.#updateMonth(this.#currentMonthIndex);\n\n\t\tEventEmitter.emit(this, 'clickPrevMonth');\n\t\tthis.#updateCalendar('prev');\n\t\tthis.selectMonthDay();\n\t}\n\n\t#updateMonth(monthIndex)\n\t{\n\t\tconst year = this.#months[monthIndex].year;\n\t\tconst month = this.#months[monthIndex].month;\n\t\tthis.#calculateDateTimeSlots(year, month);\n\n\t\tthis.#months[this.#currentMonthIndex] = this.#createMonth(year, month);\n\t}\n\n\t#getNodeBack(): HTMLElement\n\t{\n\t\tif (!this.#layout.back)\n\t\t{\n\t\t\tthis.#layout.back = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-back\"></div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.back, 'click', () => {\n\t\t\t\tEventEmitter.emit('hideSlotSelector', this);\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.back;\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar\">\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-bar\">\n\t\t\t\t\t\t${this.#getNodeBack()}\n\t\t\t\t\t\t${this.#getNodeCurrentMonth()}\n\t\t\t\t\t\t${this.#getNodeNavigation()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getNodeMonthWrapper()}\n\t\t\t\t\t${this.#getNodeTimezoneWrapper()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n}\n","import { EventEmitter } from 'main.core.events';\nimport { Tag, Dom } from 'main.core';\n\ntype BaseOptions = {\n\tisHiddenOnStart: boolean,\n};\nexport default class Base\n{\n\t#wrapNode;\n\t#isHiddenOnStart;\n\tconstructor(options: BaseOptions)\n\t{\n\t\tthis.#wrapNode = null;\n\t\tthis.#isHiddenOnStart = options.isHiddenOnStart;\n\t\tthis.#bindEvents();\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div></div>\n\t\t`;\n\t}\n\n\tgetType()\n\t{\n\t\treturn 'base';\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tDom.append(this.getContent(), this.#getWrapNode());\n\n\t\treturn this.#wrapNode;\n\t}\n\n\t#getWrapNode()\n\t{\n\t\tif (!this.#wrapNode)\n\t\t{\n\t\t\tthis.#wrapNode = Tag.render`<div class=\"calendar-pub__slots-wrap\"></div>`;\n\t\t\tif (this.#isHiddenOnStart)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#wrapNode, '--hidden');\n\t\t\t}\n\t\t}\n\n\t\treturn this.#wrapNode;\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('selectorTypeChange', (ev) => {\n\t\t\tif (ev.data === this.getType())\n\t\t\t{\n\t\t\t\tthis.#show();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#hide();\n\t\t\t}\n\t\t});\n\t}\n\n\t#hide()\n\t{\n\t\tDom.addClass(this.#wrapNode, '--hidden');\n\t}\n\n\t#show()\n\t{\n\t\tDom.removeClass(this.#wrapNode, '--hidden');\n\t}\n}\n","import { Tag, Loc, Type, Dom } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { Util } from 'calendar.util';\nimport { Member, MembersList } from '../layout/members-list';\n\ntype Data = {\n\tfrom: Date,\n\tto: Date,\n\ttimezone: string,\n\tisFullDay: boolean,\n\tmembers: Member[],\n}\n\nexport default class WidgetDate\n{\n\t#layout;\n\t#value;\n\t#members;\n\n\tconstructor()\n\t{\n\t\tthis.#layout = {\n\t\t\tcalendarPage: {\n\t\t\t\tmonth: null,\n\t\t\t\tday: null,\n\t\t\t\ttimeFrom: null,\n\t\t\t},\n\t\t\tdayInfo: null,\n\t\t\ttimeInterval: null,\n\t\t\ttimezone: null,\n\t\t\tavatarsSection: null,\n\t\t};\n\n\t\tthis.#value = {\n\t\t\tfrom: null,\n\t\t\tto: null,\n\t\t\ttimezone: null,\n\t\t\tisFullDay: false,\n\t\t};\n\t}\n\n\tupdateValue(data: Data)\n\t{\n\t\tif (data.from)\n\t\t{\n\t\t\tthis.#value.from = data.from;\n\t\t}\n\n\t\tif (data.to)\n\t\t{\n\t\t\tthis.#value.to = data.to;\n\t\t}\n\n\t\tif (data.timezone)\n\t\t{\n\t\t\tthis.#value.timezone = data.timezone;\n\t\t}\n\n\t\tif (Type.isBoolean(data.isFullDay))\n\t\t{\n\t\t\tthis.#value.isFullDay = data.isFullDay;\n\t\t}\n\n\t\tif (data.members)\n\t\t{\n\t\t\tthis.#members = data.members;\n\t\t}\n\n\t\tthis.updateLayout();\n\t}\n\n\tupdateLayout()\n\t{\n\t\tconst timestampFrom = this.#value.from.getTime() / 1000;\n\t\tconst timestampTo = this.#value.to.getTime() / 1000;\n\n\t\tconst isStartAndEndInDifferentDays = DateTimeFormat.format('j F Y', timestampFrom)\n\t\t\t!== DateTimeFormat.format('j F Y', timestampTo)\n\t\t;\n\t\tconst isFullDay = this.#value.isFullDay;\n\n\t\tconst dayOfWeekMonthFormat = DateTimeFormat.getFormat('DAY_OF_WEEK_MONTH_FORMAT');\n\t\tconst shortTimeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\tif (isFullDay)\n\t\t{\n\t\t\tthis.#getNodeCalendarPageTimeFrom().innerText = Loc.getMessage('CALENDAR_SHARING_WIDGET_DATE_FULL_DAY');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#getNodeCalendarPageTimeFrom().innerText = DateTimeFormat.format(shortTimeFormat, timestampFrom);\n\t\t}\n\n\t\tthis.#getNodeCalendarPageMonth().innerText = DateTimeFormat.format('f', timestampFrom);\n\t\tthis.#getNodeCalendarPageDay().innerText = DateTimeFormat.format('d', timestampFrom);\n\n\t\tif (isFullDay)\n\t\t{\n\t\t\tthis.#getNodeDayInfo().innerText = DateTimeFormat.format(dayOfWeekMonthFormat, timestampFrom);\n\t\t\tthis.#getNodeTimeInterval().innerText = Loc.getMessage('CALENDAR_SHARING_WIDGET_DATE_FULL_DAY');\n\t\t}\n\t\telse if (isStartAndEndInDifferentDays)\n\t\t{\n\t\t\tthis.#getNodeDayInfo().innerText = Loc.getMessage(\n\t\t\t\t'CALENDAR_SHARING_WIDGET_DATE_EVENT_START',\n\t\t\t\t{ '#DATE#': Util.formatDayMonthShortTime(timestampFrom) },\n\t\t\t);\n\t\t\tthis.#getNodeTimeInterval().innerText = Loc.getMessage(\n\t\t\t\t'CALENDAR_SHARING_WIDGET_DATE_EVENT_END',\n\t\t\t\t{ '#DATE#': Util.formatDayMonthShortTime(timestampTo) },\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#getNodeDayInfo().innerText = DateTimeFormat.format(dayOfWeekMonthFormat, timestampFrom);\n\t\t\tthis.#getNodeTimeInterval().innerText = Util.formatTimeInterval(this.#value.from, this.#value.to);\n\t\t}\n\n\t\tif (isFullDay)\n\t\t{\n\t\t\tthis.#getNodeTimezone().innerText = 'no timezone';\n\t\t\tthis.#getNodeTimezone().setAttribute('title', '');\n\t\t\tDom.addClass(this.#getNodeTimezone(), '--hidden');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#getNodeTimezone().innerText = Util.getFormattedTimezone(this.#value.timezone);\n\t\t\tthis.#getNodeTimezone().setAttribute('title', Util.getFormattedTimezone(this.#value.timezone));\n\t\t\tDom.removeClass(this.#getNodeTimezone(), '--hidden');\n\t\t}\n\n\t\tthis.#renderAvatarsSection();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__form-date\">\n\t\t\t\t<div class=\"calendar-pub__form-date-day\">\n\t\t\t\t\t${this.#getNodeCalendarPageMonth()}\n\t\t\t\t\t<div class=\"calendar-pub__form-date-content\">\n\t\t\t\t\t\t${this.#getNodeCalendarPageDay()}\n\t\t\t\t\t\t${this.#getNodeCalendarPageTimeFrom()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"calendar-pub__form-date-info\">\n\t\t\t\t\t${this.#getNodeDayInfo()}\n\t\t\t\t\t${this.#getNodeTimeInterval()}\n\t\t\t\t\t${this.#getNodeTimezone()}\n\t\t\t\t\t${this.#renderAvatarsSection()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getNodeCalendarPageMonth()\n\t{\n\t\tif (!this.#layout.calendarPage.month)\n\t\t{\n\t\t\tthis.#layout.calendarPage.month = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-day_month\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.calendarPage.month;\n\t}\n\n\t#getNodeCalendarPageDay()\n\t{\n\t\tif (!this.#layout.calendarPage.day)\n\t\t{\n\t\t\tthis.#layout.calendarPage.day = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-day_num\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.calendarPage.day;\n\t}\n\n\t#getNodeCalendarPageTimeFrom()\n\t{\n\t\tif (!this.#layout.calendarPage.timeFrom)\n\t\t{\n\t\t\tthis.#layout.calendarPage.timeFrom = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-day_time\">13:00</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.calendarPage.timeFrom;\n\t}\n\n\t#getNodeDayInfo()\n\t{\n\t\tif (!this.#layout.dayInfo)\n\t\t{\n\t\t\tthis.#layout.dayInfo = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-info_day\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.dayInfo;\n\t}\n\n\t#getNodeTimeInterval()\n\t{\n\t\tif (!this.#layout.timeInterval)\n\t\t{\n\t\t\tthis.#layout.timeInterval = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-info_time\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.timeInterval;\n\t}\n\n\t#getNodeTimezone()\n\t{\n\t\tif (!this.#layout.timezone)\n\t\t{\n\t\t\tthis.#layout.timezone = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-info_time-zone\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.timezone;\n\t}\n\n\t#renderAvatarsSection()\n\t{\n\t\tconst avatarsSection = new MembersList({\n\t\t\tclassName: 'calendar-pub__form-date-members',\n\t\t\ttextClassName: 'calendar-pub-ui__typography-xs',\n\t\t\tavatarSize: 30,\n\t\t\tmembers: this.#members,\n\t\t}).render();\n\n\t\tif (!this.#layout.avatarsSection)\n\t\t{\n\t\t\tthis.#layout.avatarsSection = Tag.render`\n\t\t\t\t<div>${avatarsSection}</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#layout.avatarsSection.innerHTML = '';\n\t\t\tthis.#layout.avatarsSection.append(avatarsSection);\n\t\t}\n\n\t\treturn this.#layout.avatarsSection;\n\t}\n}\n","import { Tag, Loc, Event, Dom, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { DateTimeFormat } from 'main.date';\nimport Base from '../base';\nimport { Util } from 'calendar.util';\nimport WidgetDate from '../widget-date';\n\ntype FormOptions = {\n\tisHiddenOnStart: boolean,\n\towner: any,\n\tlink: any,\n\tsharingUser: any,\n\tisFromCrm: boolean,\n\thasContactData: boolean,\n\tisMailFeatureEnabled: boolean,\n\tisPhoneFeatureEnabled: boolean,\n}\n\ntype FormData = {\n\tfrom: Date,\n\tto: Date,\n\ttimezone: string,\n\tisFullDay: boolean,\n}\n\nexport default class Form extends Base\n{\n\t#layout;\n\t#value;\n\t#widgetDate;\n\t#owner;\n\t#link;\n\t#sharingUser;\n\t#phoneDb;\n\t#isFromCrm;\n\t#hasContactData;\n\t#isPhoneFeatureEnabled;\n\t#isMailFeatureEnabled;\n\t#inputData;\n\t#inputErrors;\n\n\tconstructor(options: FormOptions)\n\t{\n\t\tsuper({ isHiddenOnStart: options.isHiddenOnStart });\n\t\tthis.#owner = options.owner;\n\t\tthis.#link = options.link;\n\t\tthis.#widgetDate = new WidgetDate();\n\t\tthis.#sharingUser = options.sharingUser;\n\t\tthis.#isFromCrm = options.isFromCrm;\n\t\tthis.#hasContactData = options.hasContactData;\n\t\tthis.#isPhoneFeatureEnabled = options.isPhoneFeatureEnabled;\n\t\tthis.#isMailFeatureEnabled = options.isMailFeatureEnabled;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tbuttonSend: null,\n\t\t\twidgetDate: null,\n\t\t\tformArea: null,\n\t\t\tback: null,\n\t\t\tcalendarPage: {\n\t\t\t\tmonth: null,\n\t\t\t\tday: null,\n\t\t\t\ttimeFrom: null,\n\t\t\t},\n\t\t\tdayInfo: null,\n\t\t\ttimeInterval: null,\n\t\t\ttimezone: null,\n\t\t\tinputs: {\n\t\t\t\tname: null,\n\t\t\t\tcontact: null,\n\t\t\t\tdescription: null,\n\t\t\t},\n\t\t};\n\t\tthis.#value = {\n\t\t\tfrom: null,\n\t\t\tto: null,\n\t\t\ttimezone: null,\n\t\t\tisFullDay: false,\n\t\t\tmembers: this.#link.members,\n\t\t};\n\t\tthis.#inputData = {\n\t\t\tauthorName: '',\n\t\t\tcontactData: '',\n\t\t\tdescription: '',\n\t\t};\n\t\tthis.#inputErrors = {\n\t\t\tauthorNameEmpty: false,\n\t\t\tcontactDataEmpty: false,\n\t\t\tcontactDataIncorrect: false,\n\t\t};\n\t\tthis.#phoneDb = null;\n\t}\n\n\tcleanDescription()\n\t{\n\t\tthis.#getNodeInputDescription().value = null;\n\t\tthis.#inputData.description = '';\n\t}\n\n\tgetType()\n\t{\n\t\treturn 'form';\n\t}\n\n\tgetContent()\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n\n\tupdateFormValue(data: FormData)\n\t{\n\t\tif (data.from)\n\t\t{\n\t\t\tthis.#value.from = data.from;\n\t\t}\n\n\t\tif (data.to)\n\t\t{\n\t\t\tthis.#value.to = data.to;\n\t\t}\n\n\t\tif (data.timezone)\n\t\t{\n\t\t\tthis.#value.timezone = data.timezone;\n\t\t}\n\n\t\tif (Type.isBoolean(data.isFullDay))\n\t\t{\n\t\t\tthis.#value.isFullDay = data.isFullDay;\n\t\t}\n\t\tthis.updateFormLayout();\n\t}\n\n\tupdateFormLayout()\n\t{\n\t\tthis.#widgetDate.updateValue(this.#value);\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form\">\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-bar\">\n\t\t\t\t\t\t${this.#getNodeBack()}\n\t\t\t\t\t\t<div class=\"calendar-sharing__calendar-title-day calendar-pub-ui__typography-title\">\n\t\t\t\t\t\t\t${this.#getEventName()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-block\">\n\t\t\t\t\t\t${this.#getNodeWidgetDate()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getNodeFormArea()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\t#getEventName()\n\t{\n\t\treturn Loc.getMessage('CALENDAR_SHARING_EVENT_NAME', {\n\t\t\t'#OWNER_NAME#': `${this.#owner.name} ${this.#owner.lastName}`,\n\t\t});\n\t}\n\n\t#getNodeButtonSend(): HTMLElement\n\t{\n\t\tif (!this.#layout.buttonSend)\n\t\t{\n\t\t\tthis.#layout.buttonSend = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__btn\">\n\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_CREATE_MEETING')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.buttonSend, 'click', () => this.#handleSaveButtonClick());\n\t\t}\n\n\t\treturn this.#layout.buttonSend;\n\t}\n\n\tasync #handleSaveButtonClick()\n\t{\n\t\tif (Dom.hasClass(this.#layout.buttonSend, '--wait'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.#layout.buttonSend, '--wait');\n\n\t\tthis.clearInputErrors();\n\t\tif (!this.#validateData())\n\t\t{\n\t\t\tDom.removeClass(this.#layout.buttonSend, '--wait');\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst isSuccessful = await this.#saveEvent();\n\n\t\tif (isSuccessful)\n\t\t{\n\t\t\tEventEmitter.emit('selectorTypeChange', 'event', {\n\t\t\t\teventName: this.#getEventName(),\n\t\t\t\tfrom: this.#value.from,\n\t\t\t\tto: this.#value.to,\n\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t});\n\t\t}\n\n\t\tDom.removeClass(this.#layout.buttonSend, '--wait');\n\t}\n\n\tasync #saveEvent(): boolean\n\t{\n\t\tlet response = null;\n\t\ttry\n\t\t{\n\t\t\tif (this.#isFromCrm)\n\t\t\t{\n\t\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.saveCrmEvent', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\townerCreated: this.#sharingUser.ownerCreated,\n\t\t\t\t\t\townerId: this.#owner.id,\n\t\t\t\t\t\tdateFrom: this.#parseDate(this.#value.from),\n\t\t\t\t\t\tdateTo: this.#parseDate(this.#value.to),\n\t\t\t\t\t\tuserName: this.#inputData.authorName,\n\t\t\t\t\t\tuserContact: this.#inputData.contactData,\n\t\t\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t\t\t\tcrmDealLinkHash: this.#link.hash,\n\t\t\t\t\t\tdescription: this.#inputData.description,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.saveEvent', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\townerCreated: this.#sharingUser.ownerCreated,\n\t\t\t\t\t\townerId: this.#owner.id,\n\t\t\t\t\t\tuserName: this.#inputData.authorName,\n\t\t\t\t\t\tuserContact: this.#inputData.contactData,\n\t\t\t\t\t\tdateFrom: this.#parseDate(this.#value.from),\n\t\t\t\t\t\tdateTo: this.#parseDate(this.#value.to),\n\t\t\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t\t\t\tparentLinkHash: this.#link.hash,\n\t\t\t\t\t\tdescription: this.#inputData.description,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tresponse = e;\n\t\t}\n\n\t\tif (response.errors.length === 0)\n\t\t{\n\t\t\tEventEmitter.emit('onSaveEvent', {\n\t\t\t\teventName: this.#getEventName(),\n\t\t\t\tfrom: this.#value.from,\n\t\t\t\tto: this.#value.to,\n\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t\teventId: response.data.eventId,\n\t\t\t\teventLinkId: response.data.eventLinkId,\n\t\t\t\teventLinkHash: response.data.eventLinkHash,\n\t\t\t\teventLinkShortUrl: response.data.eventLinkShortUrl,\n\t\t\t\tuserName: this.#inputData.authorName,\n\t\t\t\tstate: 'created',\n\t\t\t\tisView: false,\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\n\t\tif (response?.data?.contactDataError || response?.data?.isEmptyContactName)\n\t\t{\n\t\t\tthis.#inputErrors.contactDataIncorrect = response.data.contactDataError === true;\n\t\t\tthis.#inputErrors.authorNameEmpty = response.data.isEmptyContactName === true;\n\t\t\tthis.#renderInputErrors();\n\n\t\t\treturn false;\n\t\t}\n\n\t\tEventEmitter.emit('onSaveEvent', {\n\t\t\teventName: this.#getEventName(),\n\t\t\tfrom: this.#value.from,\n\t\t\tto: this.#value.to,\n\t\t\ttimezone: this.#value.timezone,\n\t\t\tstate: 'not-created',\n\t\t\tisView: false,\n\t\t});\n\n\t\treturn false;\n\t}\n\n\t#parseDate(date): string\n\t{\n\t\tconst dateInFormat = DateTimeFormat.format(Util.getDateFormat(), date.getTime() / 1000);\n\t\tconst timeInFormat = DateTimeFormat.format(Util.getTimeFormat(), date.getTime() / 1000);\n\n\t\treturn `${dateInFormat} ${timeInFormat}`;\n\t}\n\n\t#validateData(): boolean\n\t{\n\t\tif (this.#isCrmAndHasContact())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.#inputData.authorName.length === 0)\n\t\t{\n\t\t\tthis.#inputErrors.authorNameEmpty = true;\n\t\t}\n\n\t\tif (this.#inputData.contactData.length === 0)\n\t\t{\n\t\t\tthis.#inputErrors.contactDataEmpty = true;\n\t\t}\n\n\t\tif (!this.#inputErrors.contactDataEmpty)\n\t\t{\n\t\t\tthis.#inputErrors.contactDataIncorrect = !this.#validatePhone() && !this.#validateEmail();\n\t\t}\n\t\tthis.#renderInputErrors();\n\n\t\treturn !this.#inputErrors.authorNameEmpty\n\t\t\t&& !this.#inputErrors.contactDataEmpty\n\t\t\t&& !this.#inputErrors.contactDataIncorrect\n\t\t\t;\n\t}\n\n\t#validatePhone(): boolean\n\t{\n\t\tif (this.#isMailContactOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst phone = this.#inputData.contactData.replace(/[()\\s\\-]+/g, '');\n\t\tconst match = phone.match(/(^\\+?\\d{4,25}$)/i);\n\n\t\treturn match?.[0] === phone;\n\t}\n\n\t#validateEmail(): boolean\n\t{\n\t\tif (this.#isPhoneContactOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst match = this.#inputData.contactData.match(/(^[^@]+@.+$)/i);\n\n\t\treturn match?.[0] === this.#inputData.contactData;\n\t}\n\n\tclearInputErrors()\n\t{\n\t\tthis.#clearContactNameError();\n\t\tthis.#clearContactDataError();\n\t}\n\n\t#clearContactDataError()\n\t{\n\t\tthis.#inputErrors.contactDataEmpty = false;\n\t\tthis.#inputErrors.contactDataIncorrect = false;\n\t\tthis.#renderInputErrors();\n\t}\n\n\t#clearContactNameError()\n\t{\n\t\tthis.#inputErrors.authorNameEmpty = false;\n\t\tthis.#renderInputErrors();\n\t}\n\n\t#showFullContactPlaceholder(): boolean\n\t{\n\t\treturn !this.#isMailContactOnly() && !this.#isPhoneContactOnly();\n\t}\n\n\t#isMailContactOnly(): boolean\n\t{\n\t\treturn !this.#isPhoneFeatureEnabled && this.#isMailFeatureEnabled;\n\t}\n\n\t#isPhoneContactOnly(): boolean\n\t{\n\t\treturn this.#isPhoneFeatureEnabled && !this.#isMailFeatureEnabled;\n\t}\n\n\t#isCrmAndHasContact(): boolean\n\t{\n\t\treturn this.#isFromCrm && this.#hasContactData;\n\t}\n\n\t#getNodeWidgetDate(): HTMLElement\n\t{\n\t\tif (!this.#layout.widgetDate)\n\t\t{\n\t\t\tthis.#layout.widgetDate = this.#widgetDate.render();\n\t\t}\n\n\t\treturn this.#layout.widgetDate;\n\t}\n\n\t#getNodeFormArea(): HTMLElement\n\t{\n\t\tif (!this.#layout.formArea)\n\t\t{\n\t\t\tthis.#layout.nameInputError = this.#getNodeInputError();\n\t\t\tthis.#layout.contactInputError = this.#getNodeInputError();\n\n\t\t\tthis.#layout.formArea = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form\">\n\t\t\t\t\t<div class=\"calendar-sharing__form-area\">\n\t\t\t\t\t\t<div class=\"calendar-sharing__form-input\">\n\t\t\t\t\t\t\t${this.#getNodeInputName()}\n\t\t\t\t\t\t\t<div class=\"calendar-sharing__form-input-title\">${Loc.getMessage('CALENDAR_SHARING_FORM_INPUT_NAME')}<span>*</span></div>\n\t\t\t\t\t\t\t${this.#layout.nameInputError}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-sharing__form-input\">\n\t\t\t\t\t\t\t${this.#getNodeInputContact()}\n\t\t\t\t\t\t\t<div class=\"calendar-sharing__form-input-title\">${this.#getContactDataPlaceholder()}<span>*</span></div>\n\t\t\t\t\t\t\t${this.#layout.contactInputError}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-sharing__form-input\">\n\t\t\t\t\t\t\t${this.#getNodeInputDescription()}\n\t\t\t\t\t\t\t<div class=\"calendar-sharing__form-input-title\">${Loc.getMessage('CALENDAR_SHARING_FORM_INPUT_INFO')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-pub__welcome-bottom\">\n\t\t\t\t\t\t${this.#getNodeButtonSend()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.formArea;\n\t}\n\n\t#getContactDataPlaceholder(): string\n\t{\n\t\tlet messageCode = 'CALENDAR_SHARING_AUTHOR_CONTACT_DATA_PLACEHOLDER_PHONE_FEATURE_ENABLED';\n\t\tif (this.#isMailContactOnly())\n\t\t{\n\t\t\tmessageCode = 'CALENDAR_SHARING_AUTHOR_CONTACT_DATA_PLACEHOLDER_PHONE_FEATURE_DISABLED';\n\t\t}\n\n\t\tif (this.#isPhoneContactOnly())\n\t\t{\n\t\t\tmessageCode = 'CALENDAR_SHARING_AUTHOR_CONTACT_DATA_PLACEHOLDER_MAIL_FEATURE_DISABLED';\n\t\t}\n\n\t\treturn Loc.getMessage(messageCode);\n\t}\n\n\t#getNodeInputName()\n\t{\n\t\tif (!this.#layout.inputs.name)\n\t\t{\n\t\t\tthis.#layout.inputs.name = Tag.render`\n\t\t\t\t<input type=\"text\" placeholder=\" \" class=\"calendar-sharing__form-input-area\">\n\t\t\t`;\n\t\t\tif (this.#hasContactData)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.inputs.name, '--hidden');\n\t\t\t}\n\t\t\telse if (this.#sharingUser?.userName)\n\t\t\t{\n\t\t\t\tthis.#layout.inputs.name.value = this.#sharingUser?.userName;\n\t\t\t}\n\n\t\t\tthis.#inputData.authorName = this.#layout.inputs.name.value;\n\t\t\tEvent.bind(this.#layout.inputs.name, 'input', () => {\n\t\t\t\tthis.#inputData.authorName = this.#layout.inputs.name.value;\n\t\t\t});\n\n\t\t\tEvent.bind(this.#layout.inputs.name, 'focus', this.#clearContactNameError.bind(this));\n\t\t}\n\n\t\treturn this.#layout.inputs.name;\n\t}\n\n\t#getNodeInputContact()\n\t{\n\t\tif (!this.#layout.inputs.contact)\n\t\t{\n\t\t\tthis.#layout.inputs.contact = Tag.render`\n\t\t\t\t<input type=\"text\" placeholder=\" \" class=\"calendar-sharing__form-input-area\">\n\t\t\t`;\n\n\t\t\tif (this.#isMailContactOnly())\n\t\t\t{\n\t\t\t\tthis.#layout.inputs.contact.inputMode = 'email';\n\t\t\t}\n\n\t\t\tif (this.#isPhoneContactOnly())\n\t\t\t{\n\t\t\t\tthis.#layout.inputs.contact.inputMode = 'tel';\n\t\t\t}\n\n\t\t\tif (this.#hasContactData)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.inputs.contact, '--hidden');\n\t\t\t}\n\t\t\telse if (this.#sharingUser)\n\t\t\t{\n\t\t\t\tif (this.#isMailFeatureEnabled && this.#sharingUser.personalMailbox)\n\t\t\t\t{\n\t\t\t\t\tthis.#layout.inputs.contact.value = this.#sharingUser?.personalMailbox;\n\t\t\t\t}\n\t\t\t\telse if (this.#isPhoneFeatureEnabled && this.#sharingUser.personalPhone)\n\t\t\t\t{\n\t\t\t\t\tthis.#layout.inputs.contact.value = this.#sharingUser?.personalPhone;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.#inputData.contactData = this.#layout.inputs.contact.value;\n\t\t\tEvent.bind(this.#layout.inputs.contact, 'input', (event) => {\n\t\t\t\tthis.#inputData.contactData = this.#layout.inputs.contact.value;\n\t\t\t\tthis.#onPhoneInput(event);\n\t\t\t});\n\n\t\t\tEvent.bind(this.#layout.inputs.contact, 'keydown', this.#onPhoneInputKeyDown.bind(this));\n\t\t\tEvent.bind(this.#layout.inputs.contact, 'focus', this.#clearContactDataError.bind(this));\n\t\t}\n\n\t\treturn this.#layout.inputs.contact;\n\t}\n\n\t#getNodeInputDescription()\n\t{\n\t\tif (!this.#layout.inputs.description)\n\t\t{\n\t\t\tthis.#layout.inputs.description = Tag.render`\n\t\t\t\t<textarea type=\"text\" placeholder=\" \" class=\"calendar-sharing__form-input-area --textarea\"></textarea>\n\t\t\t`;\n\t\t\tthis.#inputData.description = this.#layout.inputs.description.value;\n\t\t\tEvent.bind(this.#layout.inputs.description, 'input', () => {\n\t\t\t\tthis.#inputData.description = this.#layout.inputs.description.value;\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.inputs.description;\n\t}\n\n\t#getNodeInputError()\n\t{\n\t\treturn Tag.render`\n\t\t\t<span class=\"calendar-sharing__form-input-error\"></span>\n\t\t`;\n\t}\n\n\t#renderInputErrors()\n\t{\n\t\tDom.removeClass(this.#layout.inputs.name.parentNode, '--error');\n\t\tDom.removeClass(this.#layout.inputs.contact.parentNode, '--error');\n\t\tif (this.#inputErrors.authorNameEmpty)\n\t\t{\n\t\t\tDom.addClass(this.#layout.inputs.name.parentNode, '--error');\n\t\t\tthis.#layout.nameInputError.innerText = Loc.getMessage('CALENDAR_SHARING_INPUT_ERROR_REQUIRED');\n\t\t}\n\n\t\tif (this.#inputErrors.contactDataEmpty)\n\t\t{\n\t\t\tDom.addClass(this.#layout.inputs.contact.parentNode, '--error');\n\t\t\tthis.#layout.contactInputError.innerText = Loc.getMessage('CALENDAR_SHARING_INPUT_ERROR_REQUIRED');\n\t\t}\n\n\t\tif (this.#inputErrors.contactDataIncorrect)\n\t\t{\n\t\t\tDom.addClass(this.#layout.inputs.contact.parentNode, '--error');\n\t\t\tthis.#layout.contactInputError.innerText = Loc.getMessage('CALENDAR_SHARING_INPUT_ERROR_INCORRECT');\n\t\t}\n\t}\n\n\t#getNodeBack(): HTMLElement\n\t{\n\t\tif (!this.#layout.back)\n\t\t{\n\t\t\tthis.#layout.back = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-back\"></div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.back, 'click', ()=> {\n\t\t\t\tEventEmitter.emit('selectorTypeChange', 'slot-list');\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.back;\n\t}\n\n\t// phone input\n\t#onPhoneInput()\n\t{\n\t\tthis.#clearContactDataError();\n\t\tif (!this.#isPhoneTypeInput())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst textBeforeCursor = this.#getTextBeforeCursor(this.#layout.inputs.contact);\n\n\t\tthis.#inputData.contactData = this.#formatPhone(this.#inputData.contactData);\n\t\tthis.#layout.inputs.contact.value = this.#inputData.contactData;\n\n\t\tthis.#setCursorToFormattedPosition(this.#layout.inputs.contact, textBeforeCursor);\n\t}\n\n\t#getTextBeforeCursor(input)\n\t{\n\t\tconst selectionStart = input.selectionStart;\n\n\t\treturn input.value.slice(0, selectionStart);\n\t}\n\n\t#setCursorToFormattedPosition(input, textBeforeCursor)\n\t{\n\t\tconst firstPart = this.#getTextEscapedForRegex(textBeforeCursor.slice(0, -1));\n\t\tconst lastCharacter = this.#getTextEscapedForRegex(textBeforeCursor.slice(-1));\n\t\tconst matches = input.value.match(`${firstPart}.*?${lastCharacter}`);\n\t\tif (!matches)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst match = matches[0];\n\t\tconst formattedPosition = input.value.indexOf(match) + match.length;\n\t\tinput.setSelectionRange(formattedPosition, formattedPosition);\n\t}\n\n\t#getTextEscapedForRegex(text)\n\t{\n\t\treturn text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\t}\n\n\t#onPhoneInputKeyDown(e)\n\t{\n\t\tif (!this.#isPhoneTypeInput())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#isDigit(e.key) && !this.#isControlKey(e.key) && !Util.isAnyModifierKeyPressed(e))\n\t\t{\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\t#isPhoneTypeInput(): boolean\n\t{\n\t\treturn this.#isPhoneContactOnly() || (this.#showFullContactPlaceholder() && this.contactData.slice(0, 1) === '+');\n\t}\n\n\t#isDigit(key): boolean\n\t{\n\t\treturn /^\\d+$/.test(key);\n\t}\n\n\t#isControlKey(key): boolean\n\t{\n\t\treturn ['Esc', 'Delete', 'Backspace', 'Tab'].indexOf(key) >= 0 || key.includes('Arrow');\n\t}\n\n\t#formatPhone(value): string\n\t{\n\t\tvalue ??= '';\n\n\t\tconst hasPlus = value.indexOf('+') === 0;\n\t\tvalue = value.replace(/\\D/g, '');\n\n\t\tif (!hasPlus && value.substr(0, 1) === '8')\n\t\t{\n\t\t\tvalue = `7${value.substr(1)}`;\n\t\t}\n\n\t\tif (!this.#phoneDb)\n\t\t{\n\t\t\tthis.#phoneDb = \"247,ac,___-____|376,ad,___-___-___|971,ae,___-_-___-____|93,af,__-__-___-____|1268,ag,_ (___) ___-____|1264,ai,_ (___) ___-____|355,al,___ (___) ___-___|374,am,___-__-___-___|599,bq,___-___-____|244,ao,___ (___) ___-___|6721,aq,___-___-___|54,ar,__ (___) ___-____|1684,as,_ (___) ___-____|43,at,__ (___) ___-____|61,au,__-_-____-____|297,aw,___-___-____|994,az,___ (__) ___-__-__|387,ba,___-__-____|1246,bb,_ (___) ___-____|880,bd,___-__-___-___|32,be,__ (___) ___-___|226,bf,___-__-__-____|359,bg,___ (___) ___-___|973,bh,___-____-____|257,bi,___-__-__-____|229,bj,___-__-__-____|1441,bm,_ (___) ___-____|673,bn,___-___-____|591,bo,___-_-___-____|55,br,__-(__)-____-____|1242,bs,_ (___) ___-____|975,bt,___-_-___-___|267,bw,___-__-___-___|375,by,___ (__) ___-__-__|501,bz,___-___-____|243,cd,___ (___) ___-___|236,cf,___-__-__-____|242,cg,___-__-___-____|41,ch,__-__-___-____|225,ci,___-__-___-___|682,ck,___-__-___|56,cl,__-_-____-____|237,cm,___-____-____|86,cn,__ (___) ____-___|57,co,__ (___) ___-____|506,cr,___-____-____|53,cu,__-_-___-____|238,cv,___ (___) __-__|357,cy,___-__-___-___|420,cz,___ (___) ___-___|49,de,__-___-___|253,dj,___-__-__-__-__|45,dk,__-__-__-__-__|1767,dm,_ (___) ___-____|1809,do,_ (___) ___-____|,do,_ (___) ___-____|213,dz,___-__-___-____|593,ec,___-_-___-____|372,ee,___-___-____|20,eg,__ (___) ___-____|291,er,___-_-___-___|34,es,__ (___) ___-___|251,et,___-__-___-____|358,fi,___ (___) ___-__-__|679,fj,___-__-_____|500,fk,___-_____|691,fm,___-___-____|298,fo,___-___-___|262,fr,___-_____-____|33,fr,__ (___) ___-___|508,fr,___-__-____|590,fr,___ (___) ___-___|241,ga,___-_-__-__-__|1473,gd,_ (___) ___-____|995,ge,___ (___) ___-___|594,gf,___-_____-____|233,gh,___ (___) ___-___|350,gi,___-___-_____|299,gl,___-__-__-__|220,gm,___ (___) __-__|224,gn,___-__-___-___|240,gq,___-__-___-____|30,gr,__ (___) ___-____|502,gt,___-_-___-____|1671,gu,_ (___) ___-____|245,gw,___-_-______|592,gy,___-___-____|852,hk,___-____-____|504,hn,___-____-____|385,hr,___-__-___-___|509,ht,___-__-__-____|36,hu,__ (___) ___-___|62,id,__-__-___-__|353,ie,___ (___) ___-___|972,il,___-_-___-____|91,in,__ (____) ___-___|246,io,___-___-____|964,iq,___ (___) ___-____|98,ir,__ (___) ___-____|354,is,___-___-____|39,it,__ (___) ____-___|1876,jm,_ (___) ___-____|962,jo,___-_-____-____|81,jp,__ (___) ___-___|254,ke,___-___-______|996,kg,___ (___) ___-___|855,kh,___ (__) ___-___|686,ki,___-__-___|269,km,___-__-_____|1869,kn,_ (___) ___-____|850,kp,___-___-___|82,kr,__-__-___-____|965,kw,___-____-____|1345,ky,_ (___) ___-____|77,kz,_ (___) ___-__-__|856,la,___-__-___-___|961,lb,___-_-___-___|1758,lc,_ (___) ___-____|423,li,___ (___) ___-____|94,lk,__-__-___-____|231,lr,___-__-___-___|266,ls,___-_-___-____|370,lt,___ (___) __-___|352,lu,___ (___) ___-___|371,lv,___-__-___-___|218,ly,___-__-___-___|212,ma,___-__-____-___|377,mc,___-__-___-___|373,md,___-____-____|382,me,___-__-___-___|261,mg,___-__-__-_____|692,mh,___-___-____|389,mk,___-__-___-___|223,ml,___-__-__-____|95,mm,__-___-___|976,mn,___-__-__-____|853,mo,___-____-____|1670,mp,_ (___) ___-____|596,mq,___ (___) __-__-__|222,mr,___ (__) __-____|1664,ms,_ (___) ___-____|356,mt,___-____-____|230,mu,___-___-____|960,mv,___-___-____|265,mw,___-_-____-____|52,mx,__-__-__-____|60,my,__-_-___-___|258,mz,___-__-___-___|264,na,___-__-___-____|687,nc,___-__-____|227,ne,___-__-__-____|6723,nf,___-___-___|234,ng,___-__-___-__|505,ni,___-____-____|31,nl,__-__-___-____|47,no,__ (___) __-___|977,np,___-__-___-___|674,nr,___-___-____|683,nu,___-____|64,nz,__-__-___-___|968,om,___-__-___-___|507,pa,___-___-____|51,pe,__ (___) ___-___|689,pf,___-__-__-__|675,pg,___ (___) __-___|63,ph,__ (___) ___-____|92,pk,__ (___) ___-____|48,pl,__ (___) ___-___|970,ps,___-__-___-____|351,pt,___-__-___-____|680,pw,___-___-____|595,py,___ (___) ___-___|974,qa,___-____-____|40,ro,__-__-___-____|381,rs,___-__-___-____|7,ru,_ (___) ___-__-__|250,rw,___ (___) ___-___|966,sa,___-_-___-____|677,sb,___-_____|248,sc,___-_-___-___|249,sd,___-__-___-____|46,se,__-__-___-____|65,sg,__-____-____|386,si,___-__-___-___|421,sk,___ (___) ___-___|232,sl,___-__-______|378,sm,___-____-______|221,sn,___-__-___-____|252,so,___-_-___-___|597,sr,___-___-___|211,ss,___-__-___-____|239,st,___-__-_____|503,sv,___-__-__-____|1721,sx,_ (___) ___-____|963,sy,___-__-____-___|268,sz,___ (__) __-____|1649,tc,_ (___) ___-____|235,td,___-__-__-__-__|228,tg,___-__-___-___|66,th,__-__-___-___|992,tj,___-__-___-____|690,tk,___-____|670,tl,___-___-____|993,tm,___-_-___-____|216,tn,___-__-___-___|676,to,___-_____|90,tr,__ (___) ___-____|1868,tt,_ (___) ___-____|688,tv,___-_____|886,tw,___-____-____|255,tz,___-__-___-____|380,ua,___ (__) ___-__-__|256,ug,___ (___) ___-___|44,gb,__-__-____-____|598,uy,___-_-___-__-__|998,uz,___-__-___-____|396698,va,__-_-___-_____|1784,vc,_ (___) ___-____|58,ve,__ (___) ___-____|1284,vg,_ (___) ___-____|1340,vi,_ (___) ___-____|84,vn,__-__-____-___|678,vu,___-_____|681,wf,___-__-____|685,ws,___-__-____|967,ye,___-_-___-___|27,za,__-__-___-____|260,zm,___ (__) ___-____|263,zw,___-_-______|1,us,_ (___) ___-____|\"\n\t\t\t\t.split('|')\n\t\t\t\t.map((item) => {\n\t\t\t\t\titem = item.split(',');\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcode: item[0],\n\t\t\t\t\t\tid: item[1],\n\t\t\t\t\t\tmask: item[2],\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t}\n\n\t\tif (value.length > 0)\n\t\t{\n\t\t\tlet mask = this.#findMask(value);\n\t\t\tmask += (`${mask.indexOf('-') >= 0 ? '-' : ' '}__`).repeat(10);\n\t\t\tfor (let i = 0; i < value.length; i++)\n\t\t\t{\n\t\t\t\tmask = mask.replace('_', value.slice(i, i + 1));\n\t\t\t}\n\t\t\tvalue = mask.replace(/\\D+$/, '').replace(/_/g, '0');\n\t\t}\n\n\t\tif (hasPlus || value.length > 0)\n\t\t{\n\t\t\tvalue = `+${value}`;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\t#findMask(value)\n\t{\n\t\tconst r = this.#phoneDb.filter((item) => {\n\t\t\treturn value.indexOf(item.code) === 0;\n\t\t}).sort((a, b) => {\n\t\t\treturn b.code.length - a.code.length;\n\t\t})[0];\n\n\t\treturn r ? r.mask : '_ ___ __ __ __';\n\t}\n}\n","import { Loc, Tag } from 'main.core';\nimport Base from '../base';\n\ntype EmptyStateOptions = {\n\tisHiddenOnStart: boolean,\n};\n\nexport default class EmptyState extends Base\n{\n\t#layout;\n\n\tconstructor(options: EmptyStateOptions)\n\t{\n\t\tsuper({ isHiddenOnStart: options.isHiddenOnStart });\n\t\tthis.#layout = {\n\t\t\tcontent: null,\n\t\t};\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{}\n\n\tgetType()\n\t{\n\t\treturn 'empty-state';\n\t}\n\n\tgetContent()\n\t{\n\t\treturn this.#getNodeEmptyState();\n\t}\n\n\t#getNodeEmptyState(): HTMLElement\n\t{\n\t\tif (!this.#layout.content)\n\t\t{\n\t\t\tthis.#layout.content = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__slots-empty\">\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_title\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_EMPTY')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_info\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_EMPTY_INFO')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.content;\n\t}\n}\n","import { Loc, Tag } from 'main.core';\nimport Base from '../base';\n\ntype AccessDeniedOptions = {\n\tisHiddenOnStart: boolean,\n};\n\nexport default class AccessDenied extends Base\n{\n\t#layout;\n\n\tconstructor(options: AccessDeniedOptions)\n\t{\n\t\tsuper({ isHiddenOnStart: options.isHiddenOnStart });\n\t\tthis.#layout = {\n\t\t\tcontent: null,\n\t\t};\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{}\n\n\tgetType()\n\t{\n\t\treturn 'access-denied';\n\t}\n\n\tgetContent()\n\t{\n\t\treturn this.#getNodeEmptyState();\n\t}\n\n\t#getNodeEmptyState(): HTMLElement\n\t{\n\t\tif (!this.#layout.content)\n\t\t{\n\t\t\tthis.#layout.content = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__slots-empty --icon-cross\">\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_title\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_info\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED_INFO')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.content;\n\t}\n}\n","import { Tag, Loc, Event, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Util } from 'calendar.util';\n\ntype SlotItemOptions = {\n\tvalue: {\n\t\tfrom: Date,\n\t\tto: Date,\n\t},\n}\n\nexport default class SlotItem\n{\n\t#layout;\n\t#selected;\n\t#value;\n\tBUTTON_MAX_WIDTH = 123;\n\n\tconstructor(options: SlotItemOptions)\n\t{\n\t\tthis.#selected = null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tvalue: null,\n\t\t\tselect: null,\n\t\t};\n\t\tthis.#value = options.value;\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEvent.bind(this.#getNodeWrapper(), 'click', this.select.bind(this));\n\t\tEvent.bind(this.#getNodeSelect(), 'click', this.showForm.bind(this));\n\t}\n\n\tisSelected()\n\t{\n\t\treturn this.#selected;\n\t}\n\n\tselect()\n\t{\n\t\tthis.#selected = true;\n\t\tDom.addClass(this.#getNodeWrapper(), '--selected');\n\t\tEventEmitter.emit('selectSlot', this);\n\t}\n\n\tunSelect()\n\t{\n\t\tthis.#selected = null;\n\t\tDom.removeClass(this.#getNodeWrapper(), '--selected');\n\t}\n\n\tshowForm()\n\t{\n\t\tEventEmitter.emit('confirmedSelectSlot', { value: this.#value });\n\t}\n\n\t#getNodeSelect(): HTMLElement\n\t{\n\t\tif (!this.#layout.select)\n\t\t{\n\t\t\tthis.#layout.select = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__slot-select\">${Loc.getMessage('CALENDAR_SHARING_SELECT_SLOT')}</div>\n\t\t\t`;\n\n\t\t\tdocument.body.append(this.#layout.select);\n\t\t\tif (this.#layout.select.offsetWidth > this.BUTTON_MAX_WIDTH)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.select, '--compact');\n\t\t\t}\n\t\t\tthis.#layout.select.remove();\n\t\t}\n\n\t\treturn this.#layout.select;\n\t}\n\n\t#getNodeValue(): HTMLElement\n\t{\n\t\tif (!this.#layout.value)\n\t\t{\n\t\t\tlet value = Util.formatTimeInterval(this.#value.from, this.#value.to);\n\t\t\tvalue = value.replace(/(am|pm)/g, '<span class=\"calendar-sharing-am-pm\">$1</span>');\n\n\t\t\tthis.#layout.value = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__slot-value\">${value}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.value;\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__slot-item\">\n\t\t\t\t\t${this.#getNodeValue()}\n\t\t\t\t\t${this.#getNodeSelect()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n}\n","import { Dom, Loc, Tag, Event } from 'main.core';\nimport SlotItem from './slot-item';\nimport { EventEmitter } from 'main.core.events';\nimport Base from '../base';\nimport { Util } from 'calendar.util';\n\ntype SlotListOptions = {\n\tisHiddenOnStart: boolean,\n\townerOffset: number,\n}\n\nexport default class SlotList extends Base\n{\n\t#layout;\n\t#slots;\n\t#selectedSlot;\n\t#timezoneNoticeWasUnderstood;\n\t#ownerTimezoneOffsetUtc;\n\t#selectedTimezoneOffsetUtc;\n\n\tconstructor(options: SlotListOptions)\n\t{\n\t\tsuper({ isHiddenOnStart: options.isHiddenOnStart });\n\t\tthis.#layout = {\n\t\t\ttitle: null,\n\t\t\tlist: null,\n\t\t\ttimezoneNotice: null,\n\t\t\ttimezoneNoticeOffset: null,\n\t\t};\n\t\tthis.#slots = [];\n\n\t\tthis.#timezoneNoticeWasUnderstood = false;\n\t\tthis.#ownerTimezoneOffsetUtc = -options.ownerOffset;\n\t\tthis.#selectedTimezoneOffsetUtc = new Date().getTimezoneOffset();\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('updateSlotsList', (event) => {\n\t\t\tthis.#slots = event.data.slots;\n\t\t\tthis.updateSlotsList();\n\t\t});\n\t\tEventEmitter.subscribe('selectSlot', (event) => {\n\t\t\tconst newSelectedSlot = event.data;\n\t\t\tif (this.#selectedSlot !== newSelectedSlot)\n\t\t\t{\n\t\t\t\tthis.#selectedSlot?.unSelect();\n\t\t\t}\n\n\t\t\tthis.#selectedSlot = newSelectedSlot;\n\t\t});\n\t\tEventEmitter.subscribe('updateTimezone', (event) => {\n\t\t\tthis.#selectedTimezoneOffsetUtc = Util.getTimeZoneOffset(event.getData().timezone);\n\n\t\t\tthis.#hideTimezoneNotice();\n\t\t\tif (this.#shouldShowTimezoneNotice())\n\t\t\t{\n\t\t\t\tthis.#showTimezoneNotice();\n\t\t\t}\n\t\t});\n\t}\n\n\tgetType()\n\t{\n\t\treturn 'slot-list';\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn this.#getNodeSlotList();\n\t}\n\n\tupdateSlotsList()\n\t{\n\t\tDom.clean(this.#getNodeList());\n\n\t\tconst slotListNode = this.#getNodeListItems();\n\n\t\tDom.append(slotListNode, this.#getNodeList());\n\t\tDom.removeClass(this.#getNodeList(), '--shadow-top');\n\t\tDom.removeClass(this.#getNodeList(), '--shadow-bottom');\n\t}\n\n\t#getNodeSlotList(): HTMLElement\n\t{\n\t\tif (!this.#layout.slotSelector)\n\t\t{\n\t\t\tthis.#layout.slotSelector = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__slot-list-wrap\">\n\t\t\t\t\t${this.#getNodeTitle()}\n\t\t\t\t\t${this.#getNodeList()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (this.#shouldShowTimezoneNotice())\n\t\t\t{\n\t\t\t\tthis.#showTimezoneNotice();\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.slotSelector;\n\t}\n\n\t#getNodeTitle(): HTMLElement\n\t{\n\t\tif (!this.#layout.title)\n\t\t{\n\t\t\tthis.#layout.title = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-bar\">\n\t\t\t\t\t<div class=\"calendar-pub-ui__typography-m\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_FREE')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.title;\n\t}\n\n\t#getNodeTimezoneNotice()\n\t{\n\t\tif (!this.#layout.timezoneNotice)\n\t\t{\n\t\t\tthis.#layout.timezoneNotice = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-timezone-notice calendar-pub-ui__typography-s\">\n\t\t\t\t\t${this.#getNodeTimezoneNoticeText()}\n\t\t\t\t\t<div class=\"calendar-pub-timezone-notice-offset\">\n\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_TIMEZONE_NOTICE_OFFSET')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getNodeTimezoneNoticeButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tthis.#hideTimezoneNotice();\n\t\t}\n\n\t\treturn this.#layout.timezoneNotice;\n\t}\n\n\t#getNodeTimezoneNoticeText()\n\t{\n\t\tif (!this.#layout.timezoneNoticeText)\n\t\t{\n\t\t\tthis.#layout.timezoneNoticeText = Tag.render`\n\t\t\t\t<div>\n\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_TIMEZONE_NOTICE')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.timezoneNoticeText;\n\t}\n\n\t#getNodeTimezoneNoticeButton()\n\t{\n\t\tconst button = Tag.render`\n\t\t\t<div class=\"calendar-pub-ui__btn --m\">\n\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">\n\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_UNDERSTAND')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(button, 'click', () => {\n\t\t\tthis.#hideTimezoneNotice();\n\t\t\tthis.#timezoneNoticeWasUnderstood = true;\n\t\t});\n\n\t\treturn button;\n\t}\n\n\t#shouldShowTimezoneNotice()\n\t{\n\t\tconst timezoneIsVeryDifferent = Math.abs(this.#ownerTimezoneOffsetUtc - this.#selectedTimezoneOffsetUtc) >= 180;\n\n\t\treturn !this.#timezoneNoticeWasUnderstood && timezoneIsVeryDifferent;\n\t}\n\n\t#showTimezoneNotice()\n\t{\n\t\tconst offset = this.#ownerTimezoneOffsetUtc - this.#selectedTimezoneOffsetUtc;\n\t\tthis.#layout.timezoneNoticeText.innerText = this.#getTimezoneNoticeText(offset);\n\t\tDom.style(this.#layout.timezoneNotice, 'display', '');\n\t}\n\n\t#getTimezoneNoticeText(offset)\n\t{\n\t\tconst sign = (offset < 0) ? '+' : '-';\n\t\treturn Loc.getMessage('CALENDAR_SHARING_TIMEZONE_NOTICE', {\n\t\t\t'#OFFSET#': `${sign}${Util.formatDuration(Math.abs(offset))}`,\n\t\t});\n\t}\n\n\t#hideTimezoneNotice()\n\t{\n\t\tDom.style(this.#layout.timezoneNotice, 'display', 'none');\n\t}\n\n\t#getNodeList(): HTMLElement\n\t{\n\t\tif (!this.#layout.slots)\n\t\t{\n\t\t\tthis.#layout.slots = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --overflow-hidden --shadow\">\n\t\t\t\t\t${this.#getNodeListItems()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.slots;\n\t}\n\n\t#getNodeListItems(): HTMLElement\n\t{\n\t\tconst currentDaySlots = this.#slots\n\t\t\t.map((slot) => new SlotItem({\n\t\t\t\tvalue: {\n\t\t\t\t\tfrom: slot.timeFrom,\n\t\t\t\t\tto: slot.timeTo,\n\t\t\t\t},\n\t\t\t}));\n\n\t\tconst result = Tag.render`\n\t\t\t<div class=\"calendar-sharing__slots\">\n\t\t\t\t${this.#getNodeTimezoneNotice()}\n\t\t\t\t${currentDaySlots.map((slotItem) => slotItem.render())}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(result, 'scroll', () => {\n\t\t\tif (result.scrollTop > 0)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#getNodeList(), '--shadow-top');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.#getNodeList(), '--shadow-top');\n\t\t\t}\n\n\t\t\tif (result.scrollHeight > result.offsetHeight\n\t\t\t\t&& Math.ceil(result.offsetHeight + result.scrollTop) < result.scrollHeight)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#getNodeList(), '--shadow-bottom');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.#getNodeList(), '--shadow-bottom');\n\t\t\t}\n\t\t});\n\n\t\tsetTimeout(() => {\n\t\t\tif (result.scrollHeight > result.offsetHeight)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#getNodeList(), '--shadow-bottom');\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n}\n","import { Member } from '../../layout/members-list';\nimport Base from '../base';\nimport { Util } from 'calendar.util';\nimport { Dom, Loc, Tag, Browser, Type, Text } from 'main.core';\nimport { Popup } from 'main.popup';\nimport WidgetDate from '../widget-date';\nimport { EventEmitter } from 'main.core.events';\nimport { DateTimeFormat } from 'main.date';\nimport { BottomSheet } from 'ui.bottomsheet';\n\ntype State = 'created' | 'not-created' | 'declined' ;\n\ntype EventData = {\n\tfrom: Date,\n\tto: Date,\n\ttimezone: string,\n\tisFullDay: boolean,\n\teventLinkHash: string,\n\teventName: string,\n\tstate: State,\n\tisView: boolean,\n\teventId: boolean,\n\tuserName: string,\n}\n\ntype EventOptions = {\n\tisHiddenOnStart: boolean,\n\towner: any,\n\tevent: any,\n\teventLinkHash: any,\n\tstate: State,\n\tisView: boolean,\n\teventId: number,\n\ttimezone: string,\n\tinDeletedSlider: boolean,\n\taction: string,\n\tcanceledByManager: boolean,\n\tshowBackCalendarButtons: boolean,\n\tmembers: Member[],\n};\n\nexport default class Event extends Base\n{\n\t#event;\n\t#owner;\n\t#currentTimezone;\n\t#icsFile;\n\t#widgetDate;\n\t#layout;\n\t#value;\n\t#state;\n\t#inDeletedSlider;\n\t#isView;\n\t#showBackCalendarButtons;\n\n\tconstructor(options: EventOptions)\n\t{\n\t\tsuper({ isHiddenOnStart: options.isHiddenOnStart });\n\t\tthis.#state = options.state;\n\t\tthis.#isView = options.isView;\n\t\tthis.#event = options.event;\n\t\tthis.#owner = options.owner;\n\t\tthis.#currentTimezone = options.timezone ?? Intl.DateTimeFormat().resolvedOptions().timeZone;\n\t\tthis.#widgetDate = this.#getWidgetDate();\n\t\tthis.#layout = {\n\t\t\tback: null,\n\t\t\twidgetDate: null,\n\t\t\teventName: null,\n\t\t\ticon: null,\n\t\t\tstateTitle: null,\n\t\t\tadditionalBlock: null,\n\t\t\tbottomButton: null,\n\t\t};\n\t\tthis.#value = {\n\t\t\tfrom: null,\n\t\t\tto: null,\n\t\t\ttimezone: null,\n\t\t\tisFullDay: false,\n\t\t\tcanceledTimestamp: null,\n\t\t\tcanceledUserName: null,\n\t\t\teventName: null,\n\t\t\tcanceledByManager: options.canceledByManager,\n\t\t\teventLinkHash: options.eventLinkHash,\n\t\t\teventId: options.eventId,\n\t\t\tmembers: options.members,\n\t\t};\n\t\tthis.#icsFile = null;\n\t\tthis.#inDeletedSlider = options.inDeletedSlider === true;\n\t\tthis.#showBackCalendarButtons = options.showBackCalendarButtons;\n\n\t\tif (this.#event)\n\t\t{\n\t\t\tthis.#initEventData();\n\t\t}\n\n\t\tif (options.action === 'cancel')\n\t\t{\n\t\t\tsetTimeout(this.showCancelEventPopup.bind(this), 0);\n\t\t}\n\n\t\tif (options.action === 'ics')\n\t\t{\n\t\t\tthis.downloadIcsFile();\n\t\t}\n\n\t\tif (options.action === 'videoconference')\n\t\t{\n\t\t\tthis.startVideoconference();\n\t\t}\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn 'event';\n\t}\n\n\t#getWidgetDate(): WidgetDate\n\t{\n\t\tif (!this.#widgetDate)\n\t\t{\n\t\t\tthis.#widgetDate = new WidgetDate();\n\t\t}\n\n\t\treturn this.#widgetDate;\n\t}\n\n\t#initEventData()\n\t{\n\t\tthis.#value.from = Util.getTimezoneDateFromTimestampUTC(\n\t\t\tparseInt(this.#event.timestampFromUTC, 10) * 1000,\n\t\t\tthis.#currentTimezone,\n\t\t);\n\t\tthis.#value.to = Util.getTimezoneDateFromTimestampUTC(\n\t\t\tparseInt(this.#event.timestampToUTC, 10) * 1000,\n\t\t\tthis.#currentTimezone,\n\t\t);\n\t\tthis.#value.timezone = this.#currentTimezone;\n\t\tthis.#value.isFullDay = this.#event.isFullDay;\n\t\tthis.#value.eventName = this.#getEventName();\n\t\tthis.#value.canceledTimestamp = this.#event.canceledTimestamp;\n\t\tthis.#value.canceledUserName = this.#event.externalUserName;\n\t\tthis.updateFormLayout();\n\t}\n\n\tupdateValue(data: EventData)\n\t{\n\t\tif (data.from)\n\t\t{\n\t\t\tthis.#value.from = data.from;\n\t\t}\n\n\t\tif (data.to)\n\t\t{\n\t\t\tthis.#value.to = data.to;\n\t\t}\n\n\t\tif (data.timezone)\n\t\t{\n\t\t\tthis.#value.timezone = data.timezone;\n\t\t}\n\n\t\tif (Type.isBoolean(data.isFullDay))\n\t\t{\n\t\t\tthis.#value.isFullDay = data.isFullDay;\n\t\t}\n\n\t\tif (data.eventLinkHash)\n\t\t{\n\t\t\tthis.#value.eventLinkHash = data.eventLinkHash;\n\t\t}\n\n\t\tif (data.eventName)\n\t\t{\n\t\t\tthis.#value.eventName = data.eventName;\n\t\t}\n\n\t\tif (data.state)\n\t\t{\n\t\t\tthis.#updateState(data.state);\n\t\t}\n\n\t\tif (data.isView)\n\t\t{\n\t\t\tthis.#isView = false;\n\t\t}\n\n\t\tif (data.eventId)\n\t\t{\n\t\t\tthis.#value.eventId = data.eventId;\n\t\t}\n\n\t\tif (data.userName)\n\t\t{\n\t\t\tthis.#value.canceledUserName = data.userName;\n\t\t}\n\n\t\tif (this.#value.canceledByManager === true)\n\t\t{\n\t\t\tthis.#value.canceledByManager = false;\n\t\t}\n\n\t\tthis.updateFormLayout();\n\t}\n\n\tupdateFormLayout()\n\t{\n\t\tthis.#getWidgetDate().updateValue(this.#value);\n\t\tthis.#getEventNameNode().innerText = this.#value.eventName;\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__form-result\">\n\t\t\t\t${this.#getNodeBackWrapper()}\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form --center\">\n\t\t\t\t\t${this.#getNodeIcon()}\n\t\t\t\t\t${this.#getEventNameNode()}\n\t\t\t\t\t${this.#getStateTitleNode()}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form --center\">\n\t\t\t\t\t${this.#getNodeWidgetDate()}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form --center\">\n\t\t\t\t\t${this.#getAdditionalBlockNode()}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --top-auto\">\n\t\t\t\t\t${this.#getBottomButtonNode()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#updateState(state: State)\n\t{\n\t\tthis.#state = state;\n\t\tDom.removeClass(this.#getNodeIcon(), ['--accept', '--decline']);\n\t\tDom.addClass(this.#getNodeIcon(), this.#getIconClassByState(state));\n\n\t\tthis.#getStateTitleNode().innerText = this.#getStateTitleTextByState(state);\n\n\t\tlet oldNode = this.#getAdditionalBlockNode();\n\t\tlet newNode = this.#createAdditionalBlockContentByState(state);\n\t\tthis.#layout.additionalBlock = newNode;\n\t\tDom.replace(oldNode, newNode);\n\n\t\toldNode = this.#getBottomButtonNode();\n\t\tnewNode = this.#createBottomButtonByState(state);\n\t\tthis.#layout.bottomButton = newNode;\n\t\tDom.replace(oldNode, newNode);\n\t}\n\n\t#getNodeIcon()\n\t{\n\t\tif (!this.#layout.icon)\n\t\t{\n\t\t\tthis.#layout.icon = this.#createIconByState(this.#state);\n\t\t}\n\n\t\treturn this.#layout.icon;\n\t}\n\n\t#getNodeBackWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.back)\n\t\t{\n\t\t\tif (this.#showBackCalendarButtons)\n\t\t\t{\n\t\t\t\tthis.#layout.back = Tag.render`\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-bar --arrow\">\n\t\t\t\t\t\t<div class=\"calendar-sharing__calendar-back\" onclick=\"${this.#onReturnButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#layout.back = Tag.render`<div class=\"calendar-sharing__calendar-bar --no-margin\"></div>`;\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.back;\n\t}\n\n\t#createIconByState(state: State)\n\t{\n\t\tconst result = Tag.render`\n\t\t\t<div class=\"calendar-sharing__form-result_icon\"></div>\n\t\t`;\n\t\tDom.addClass(result, this.#getIconClassByState(state));\n\n\t\treturn result;\n\t}\n\n\t#getIconClassByState(state: State)\n\t{\n\t\tlet result = '';\n\t\tswitch (state)\n\t\t{\n\t\t\tcase 'created':\n\t\t\t\tresult = '--accept';\n\t\t\t\tbreak;\n\t\t\tcase 'not-created':\n\t\t\t\tresult = '--decline';\n\t\t\t\tbreak;\n\t\t\tcase 'declined':\n\t\t\t\tresult = '--decline';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#getEventNameNode(): HTMLElement\n\t{\n\t\tif (!this.#layout.eventName)\n\t\t{\n\t\t\tthis.#layout.eventName = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__typography-title --center --line-height-normal\">\n\t\t\t\t\t${this.#value.eventName}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.eventName;\n\t}\n\n\t#getStateTitleNode()\n\t{\n\t\tif (!this.#layout.stateTitle)\n\t\t{\n\t\t\tthis.#layout.stateTitle = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__typography-s --center\"></div>\n\t\t\t`;\n\t\t\tthis.#layout.stateTitle.innerText = this.#getStateTitleTextByState(this.#state);\n\t\t}\n\n\t\treturn this.#layout.stateTitle;\n\t}\n\n\t#getStateTitleTextByState(state: State)\n\t{\n\t\tlet result = '';\n\t\tswitch (state)\n\t\t{\n\t\t\tcase 'created':\n\t\t\t\tif (!this.#isView)\n\t\t\t\t{\n\t\t\t\t\tresult = Loc.getMessage('CALENDAR_SHARING_MEETING_CREATED');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'not-created':\n\t\t\t\tresult = Loc.getMessage('CALENDAR_SHARING_MEETING_NOT_CREATED');\n\t\t\t\tbreak;\n\t\t\tcase 'declined':\n\t\t\t\tresult = Loc.getMessage('CALENDAR_SHARING_MEETING_CANCELED');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#getAdditionalBlockNode()\n\t{\n\t\tif (!this.#layout.additionalBlock)\n\t\t{\n\t\t\tthis.#layout.additionalBlock = this.#createAdditionalBlockContentByState(this.#state);\n\t\t}\n\n\t\treturn this.#layout.additionalBlock;\n\t}\n\n\t#createAdditionalBlockContentByState(state: State)\n\t{\n\t\tlet result = '';\n\n\t\tif (this.#inDeletedSlider)\n\t\t{\n\t\t\tconst date = Util.getTimezoneDateFromTimestampUTC(\n\t\t\t\tparseInt(this.#value.canceledTimestamp, 10) * 1000,\n\t\t\t\tthis.#currentTimezone,\n\t\t\t);\n\n\t\t\tif (this.#value.canceledTimestamp && this.#value.canceledUserName && date)\n\t\t\t{\n\t\t\t\tresult = Tag.render`\n\t\t\t\t\t<div class=\"calendar-pub__form-status\">\n\t\t\t\t\t\t<div class=\"calendar-pub__form-status_text\">\n\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_WHO_CANCELED')}: <a href=\"/company/personal/user/${this.#owner.id}/\" target=\"_blank\" class=\"calendar-sharing-deletedviewform_open-profile\">${Text.encode(this.#value.canceledUserName)}</a>\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t${DateTimeFormat.format(`j F ${Util.getTimeFormatShort()}`, date.getTime() / 1000)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult = Tag.render`\n\t\t\t\t\t<div></div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tswitch (state)\n\t\t{\n\t\t\tcase 'created':\n\t\t\t\tresult = Tag.render`\n\t\t\t\t\t<div onclick=\"${this.showCancelEventPopup.bind(this)}\" class=\"calendar-pub__form-status --decline\">\n\t\t\t\t\t\t<div class=\"calendar-pub__form-status_text\">\n\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_DECLINE_MEETING')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\tcase 'not-created':\n\t\t\t\tresult = Tag.render`\n\t\t\t\t\t<div></div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\tcase 'declined':\n\t\t\t\tconst date = Util.getTimezoneDateFromTimestampUTC(\n\t\t\t\t\tparseInt(this.#value.canceledTimestamp, 10) * 1000,\n\t\t\t\t\tthis.#currentTimezone,\n\t\t\t\t);\n\t\t\t\tif (this.#value.canceledByManager)\n\t\t\t\t{\n\t\t\t\t\tthis.#value.canceledUserName = `${this.#owner.name} ${this.#owner.lastName}`;\n\t\t\t\t}\n\n\t\t\t\tif (this.#value.canceledTimestamp && this.#value.canceledUserName && date)\n\t\t\t\t{\n\t\t\t\t\tresult = Tag.render`\n\t\t\t\t\t\t<div class=\"calendar-pub__form-status\">\n\t\t\t\t\t\t\t<div class=\"calendar-pub__form-status_text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_WHO_CANCELED')}: ${Text.encode(this.#value.canceledUserName)}<br> ${DateTimeFormat.format(`j F ${Util.getTimeFormatShort()}`, date.getTime() / 1000)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult = Tag.render`\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t`;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#getBottomButtonNode()\n\t{\n\t\tif (!this.#layout.bottomButton)\n\t\t{\n\t\t\tthis.#layout.bottomButton = this.#createBottomButtonByState(this.#state);\n\t\t}\n\n\t\treturn this.#layout.bottomButton;\n\t}\n\n\t#createBottomButtonByState(state: State)\n\t{\n\t\tif (this.#inDeletedSlider)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tlet result = '';\n\t\tswitch (state)\n\t\t{\n\t\t\tcase 'created':\n\t\t\t\tthis.#layout.videoconferenceButton = Tag.render`\n\t\t\t\t\t<div onclick=\"${this.#onVideoconferenceButtonClick.bind(this)}\" class=\"calendar-pub-ui__btn --light-border --m calendar-pub-action-btn\">\n\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_OPEN_VIDEOCONFERENCE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tthis.#layout.icsButton = Tag.render`\n\t\t\t\t\t<div onclick=\"${this.#onIcsButtonClick.bind(this)}\" class=\"calendar-pub-ui__btn --light-border --m calendar-pub-action-btn\">\n\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_ADD_TO_CALENDAR')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tresult = Tag.render`\n\t\t\t\t\t<div>\n\t\t\t\t\t\t${this.#layout.videoconferenceButton}\n\t\t\t\t\t\t${this.#layout.icsButton}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\tcase 'not-created':\n\t\t\tcase 'declined':\n\t\t\t\tif (this.#showBackCalendarButtons)\n\t\t\t\t{\n\t\t\t\t\tresult = Tag.render`\n\t\t\t\t\t\t<div onclick=\"${this.#onReturnButtonClick.bind(this)}\" class=\"calendar-pub-ui__btn --light-border --m\">\n\t\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_RETURN_TO_SLOT_LIST')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult = Tag.render`<div></div>`;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetPopup()\n\t{\n\t\tif (!this.popup)\n\t\t{\n\t\t\tconst popupContent = Tag.render`\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"calendar-pub__cookies-title\">${Loc.getMessage('CALENDAR_SHARING_POPUP_MEETING_CANCELED')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__cookies-info\">${Loc.getMessage('CALENDAR_SHARING_POPUP_MEETING_CANCELED_INFO')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__cookies-buttons ${Browser.isMobile() ? '--center' : '--flex-end'}\">\n\t\t\t\t\t\t<div onclick=\"${this.closeCancelEventPopup.bind(this)}\" class=\"calendar-pub-ui__btn --inline --m --light-border\">\n\t\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_POPUP_LEAVE')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div onclick=\"${this.handleDeleteButtonClick.bind(this)}\" class=\"calendar-pub-ui__btn --inline --m --secondary\">\n\t\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_POPUP_CANCEL')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (Browser.isMobile())\n\t\t\t{\n\t\t\t\tthis.popup = new BottomSheet({\n\t\t\t\t\tclassName: 'calendar-pub__state',\n\t\t\t\t\tcontent: popupContent,\n\t\t\t\t\tpadding: '20px 25px',\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\tclassName: 'calendar-pub__popup',\n\t\t\t\t\tcontentBackground: 'transparent',\n\t\t\t\t\twidth: 380,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\tcontent: popupContent,\n\t\t\t\t\toverlay: true,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this.popup;\n\t}\n\n\tshowCancelEventPopup()\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\tcloseCancelEventPopup()\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tasync handleDeleteButtonClick()\n\t{\n\t\tthis.closeCancelEventPopup();\n\t\tconst isSuccess = await this.deleteEvent();\n\t\tif (isSuccess)\n\t\t{\n\t\t\tthis.#value.canceledTimestamp = Date.now() / 1000;\n\t\t\tthis.#updateState('declined');\n\t\t\tEventEmitter.emit('onDeleteEvent');\n\t\t}\n\t}\n\n\tasync #onIcsButtonClick()\n\t{\n\t\tawait this.downloadIcsFile();\n\t}\n\n\tasync #onVideoconferenceButtonClick()\n\t{\n\t\tDom.addClass(this.#layout.videoconferenceButton, '--wait');\n\t\tawait this.startVideoconference();\n\t\tDom.removeClass(this.#layout.videoconferenceButton, '--wait');\n\t}\n\n\tasync deleteEvent()\n\t{\n\t\tlet response = null;\n\t\ttry\n\t\t{\n\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.deleteEvent', {\n\t\t\t\tdata: {\n\t\t\t\t\teventId: this.#value.eventId,\n\t\t\t\t\teventLinkHash: this.#value.eventLinkHash,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tresponse = e;\n\t\t}\n\n\t\treturn response.errors.length === 0;\n\t}\n\n\tasync startVideoconference()\n\t{\n\t\tlet response = null;\n\t\ttry\n\t\t{\n\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.getConferenceLink', {\n\t\t\t\tdata: {\n\t\t\t\t\teventLinkHash: this.#value.eventLinkHash,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error(error);\n\t\t}\n\n\t\tconst conferenceLink = response?.data?.conferenceLink;\n\n\t\tif (conferenceLink)\n\t\t{\n\t\t\twindow.location.href = conferenceLink;\n\t\t}\n\t}\n\n\tasync downloadIcsFile()\n\t{\n\t\tif (!this.#icsFile)\n\t\t{\n\t\t\tconst response = await BX.ajax.runAction('calendar.api.sharingajax.getIcsFileContent', {\n\t\t\t\tdata: {\n\t\t\t\t\teventLinkHash: this.#value.eventLinkHash,\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.icsFile = response.data;\n\t\t}\n\n\t\tUtil.downloadIcsFile(this.icsFile, 'event');\n\t}\n\n\t#onReturnButtonClick()\n\t{\n\t\tEventEmitter.emit('onCreateAnotherEventButtonClick');\n\t}\n\n\t#getNodeWidgetDate(): HTMLElement\n\t{\n\t\tif (!this.#layout.widgetDate)\n\t\t{\n\t\t\tthis.#layout.widgetDate = this.#widgetDate.render();\n\t\t}\n\n\t\treturn this.#layout.widgetDate;\n\t}\n\n\t#getEventName()\n\t{\n\t\treturn Loc.getMessage('CALENDAR_SHARING_EVENT_NAME', {\n\t\t\t'#OWNER_NAME#': `${this.#owner.name} ${this.#owner.lastName}`,\n\t\t});\n\t}\n}\n","import { Dom, Tag, Type } from 'main.core';\nimport { Form } from './form/index';\nimport { EmptyState, AccessDenied } from './empty-state/index';\nimport { SlotList } from './slot-list/index';\nimport { Event } from './event/index';\nimport { EventEmitter } from 'main.core.events';\nimport { Member } from '../layout/members-list';\n\ntype SlotSelectorOptions = {\n\tselectedTimezoneId: number,\n\towner: any,\n\tlink: any,\n\tmembers: Member[],\n\tsharingUser: any,\n\thasContactData: boolean,\n\tcalendarSettings: any,\n\teventLinkHash: any,\n\tevent: any,\n\taction: string,\n\tshowBackCalendarButtons: any,\n};\n\nexport default class SlotSelector\n{\n\t#layout;\n\t#components;\n\t#selectedTimezoneId;\n\t#owner;\n\t#link;\n\t#sharingUser;\n\t#isFromCrm;\n\t#hasContactData;\n\t#calendarSettings;\n\t#eventLinkHash;\n\t#event;\n\t#members;\n\t#action;\n\t#showBackCalendarButtons;\n\n\tBLOCK_NAME_FORM = 'form';\n\tBLOCK_NAME_SLOT_LIST = 'slot-list';\n\tBLOCK_NAME_EMPTY_STATE = 'empty-state';\n\tBLOCK_NAME_ACCESS_DENIED = 'access-denied';\n\tBLOCK_NAME_EVENT = 'event';\n\n\tconstructor(options: SlotSelectorOptions)\n\t{\n\t\tthis.#selectedTimezoneId = options.selectedTimezoneId;\n\t\tthis.#owner = options.owner;\n\t\tthis.#link = options.link;\n\t\tthis.#sharingUser = options.sharingUser;\n\t\tthis.#eventLinkHash = options.eventLinkHash;\n\t\tthis.#event = options.event;\n\t\tthis.#members = options.members;\n\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tempty: null,\n\t\t\ttitle: null,\n\t\t\tslots: null,\n\t\t\tslotSelector: null,\n\t\t};\n\t\tthis.#components = {\n\t\t\tform: null,\n\t\t\tslotList: null,\n\t\t\temptyState: null,\n\t\t\tevent: null,\n\t\t\taccessDenied: null,\n\t\t};\n\t\tthis.#isFromCrm = this.#link.type === 'crm_deal';\n\t\tthis.#hasContactData = options.hasContactData;\n\t\tthis.#calendarSettings = options.calendarSettings;\n\t\tthis.#showBackCalendarButtons = options.showBackCalendarButtons;\n\t\tthis.#action = options.action;\n\n\t\tthis.#bindEvents();\n\t\t// EventEmitter.subscribe('selectorStateChange', this.showForm.bind(this));\n\t\t// EventEmitter.subscribe('hideForm', this.hideForm.bind(this));\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('confirmedSelectSlot', (event) => {\n\t\t\tconst data = event.data;\n\t\t\tconst value = data.value;\n\t\t\tthis.#components.form.updateFormValue({\n\t\t\t\tfrom: value.from,\n\t\t\t\tto: value.to,\n\t\t\t\ttimezone: this.#selectedTimezoneId,\n\t\t\t});\n\t\t\tthis.openForm();\n\t\t});\n\n\t\tEventEmitter.subscribe('switchSlots', (event) => {\n\t\t\tconst slots = event.data.slots ?? [];\n\t\t\tif (slots.length > 0)\n\t\t\t{\n\t\t\t\tEventEmitter.emit('updateSlotsList', event);\n\t\t\t\tthis.openSlotList();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.openEmptyState();\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('updateTimezone', (event) => {\n\t\t\tconst data = event.data;\n\t\t\tthis.#selectedTimezoneId = data.timezone;\n\t\t});\n\n\t\tEventEmitter.subscribe('onSaveEvent', (event) => {\n\t\t\tconst eventData = event.data;\n\t\t\tthis.#components.form.cleanDescription();\n\t\t\tthis.#components.event.updateValue(eventData);\n\t\t\tthis.openEvent();\n\t\t});\n\t}\n\n\topenForm()\n\t{\n\t\tthis.#components.form?.clearInputErrors();\n\t\tthis.openBlock(this.BLOCK_NAME_FORM);\n\t}\n\n\topenSlotList()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_SLOT_LIST);\n\t}\n\n\topenEmptyState()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_EMPTY_STATE);\n\t}\n\n\topenAccessDenied()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_ACCESS_DENIED);\n\t}\n\n\topenEvent()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_EVENT);\n\t}\n\n\topenBlock(blockName)\n\t{\n\t\tEventEmitter.emit('selectorTypeChange', blockName);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.#components.form)\n\t\t{\n\t\t\tthis.#components.form = new Form({\n\t\t\t\tisHiddenOnStart: true,\n\t\t\t\towner: this.#owner,\n\t\t\t\tlink: this.#link,\n\t\t\t\tsharingUser: this.#sharingUser,\n\t\t\t\tisFromCrm: this.#isFromCrm,\n\t\t\t\thasContactData: this.#hasContactData,\n\t\t\t\tisPhoneFeatureEnabled: this.#calendarSettings.phoneFeatureEnabled,\n\t\t\t\tisMailFeatureEnabled: this.#calendarSettings.mailFeatureEnabled,\n\t\t\t});\n\t\t}\n\n\t\tif (!this.#components.emptyState)\n\t\t{\n\t\t\tthis.#components.emptyState = new EmptyState({ isHiddenOnStart: true });\n\t\t}\n\n\t\tif (!this.#components.accessDenied)\n\t\t{\n\t\t\tthis.#components.accessDenied = new AccessDenied({ isHiddenOnStart: true });\n\t\t}\n\n\t\tif (!this.#components.slotList)\n\t\t{\n\t\t\tthis.#components.slotList = new SlotList({\n\t\t\t\tisHiddenOnStart: false,\n\t\t\t\townerOffset: parseInt(this.#calendarSettings.serverOffset, 10),\n\t\t\t});\n\t\t}\n\n\t\tif (!this.#components.event)\n\t\t{\n\t\t\tlet state = 'created';\n\n\t\t\tif (this.#link.active === false || this.#event?.meetingStatus === 'N' || this.#event?.deleted === 'Y')\n\t\t\t{\n\t\t\t\tstate = 'declined';\n\t\t\t}\n\n\t\t\tlet canceledByManager = false;\n\t\t\tif (this.#event?.meetingStatus === 'N')\n\t\t\t{\n\t\t\t\tcanceledByManager = true;\n\t\t\t}\n\n\t\t\tthis.#components.event = new Event({\n\t\t\t\tisHiddenOnStart: false,\n\t\t\t\towner: this.#owner,\n\t\t\t\tevent: this.#event,\n\t\t\t\teventLinkHash: this.#eventLinkHash,\n\t\t\t\tstate,\n\t\t\t\teventId: this.#event.id,\n\t\t\t\tisView: Type.isString(this.#eventLinkHash),\n\t\t\t\tcanceledByManager,\n\t\t\t\tshowBackCalendarButtons: this.#showBackCalendarButtons,\n\t\t\t\taction: this.#action,\n\t\t\t\tmembers: this.#members,\n\t\t\t});\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__slots\">\n\t\t\t\t${this.#components.slotList.render()}\n\t\t\t\t${this.#components.form.render()}\n\t\t\t\t${this.#components.emptyState.render()}\n\t\t\t\t${this.#components.event.render()}\n\t\t\t\t${this.#components.accessDenied.render()}\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { Tag, Type, Dom } from 'main.core';\nimport Welcome from './components/welcome';\nimport { Calendar } from './components/calendar/index';\nimport { SlotSelector } from './components/slot-selector/index';\nimport { EventEmitter } from 'main.core.events';\n\nimport 'ui.design-tokens';\nimport './style.css';\n\ntype PublicOptions = {\n\ttarget: HTMLElement,\n\tlink: any,\n\tparentLink: any,\n\tevent: any,\n\taction: string,\n\tcurrentLang: string,\n\towner: any,\n}\n\nexport default class PublicV2\n{\n\t#layout;\n\t#owner;\n\t#welcomePage;\n\t#calendar;\n\t#slotsBlock;\n\n\t#linkMembers;\n\t#eventMembers;\n\n\tconstructor(options: PublicOptions)\n\t{\n\t\tthis.#owner = options.owner || null;\n\t\tthis.target = Type.isDomNode(options.target) ? options.target : null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tanimate: null,\n\t\t};\n\t\tthis.#welcomePage = null;\n\t\tthis.#calendar = null;\n\t\tthis.#slotsBlock = null;\n\n\t\tthis.#linkMembers = (options.parentLink || options.link).members;\n\t\tthis.#eventMembers = options.link.members ?? options.event.members;\n\n\t\tthis.#init();\n\t\tthis.#bindEvents();\n\n\t\tthis.showPageWelcome(options);\n\n\t\tif (options.link.type === 'event')\n\t\t{\n\t\t\tif (options.parentLink && options.parentLink.active === true)\n\t\t\t{\n\t\t\t\tthis.#renderFreeSlots(options);\n\t\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\t\tthis.#slotsBlock.openEvent();\n\t\t\t}\n\t\t\telse if (options.event)\n\t\t\t{\n\t\t\t\tthis.#renderSlotsSelector(options);\n\t\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\t\tthis.#welcomePage.hideButton();\n\t\t\t\tthis.#welcomePage.setAccessDenied();\n\t\t\t\tthis.#slotsBlock.openEvent();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#renderSlotsSelector(options);\n\t\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\t\tthis.#welcomePage.hideButton();\n\t\t\t\tthis.#slotsBlock.openAccessDenied();\n\t\t\t}\n\t\t}\n\t\telse if (options.link.active === true)\n\t\t{\n\t\t\tthis.#renderFreeSlots(options);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#renderSlotsSelector(options);\n\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\tthis.#welcomePage.hideButton();\n\t\t\tthis.#slotsBlock.openAccessDenied();\n\t\t}\n\n\t\t// this.showFreeSlots();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('showSlotSelector', this.showFreeSlots.bind(this));\n\t\tEventEmitter.subscribe('hideSlotSelector', this.hideFreeSlots.bind(this));\n\t}\n\n\tshowPageWelcome(options)\n\t{\n\t\tif (!options.owner)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#welcomePage = new Welcome({\n\t\t\towner: options.owner,\n\t\t\tlink: options.link,\n\t\t\tcurrentLang: options.currentLang,\n\t\t\tmembers: this.#linkMembers,\n\t\t});\n\n\t\tDom.append(this.#welcomePage.render(), this.#getNodeWrapper());\n\t}\n\n\t#renderFreeSlots(options)\n\t{\n\t\tthis.#calendar = new Calendar({\n\t\t\tuserIds: options.link.userIds,\n\t\t\taccessibility: options.userAccessibility,\n\t\t\ttimezoneList: options.timezoneList,\n\t\t\tcalendarSettings: options.calendarSettings,\n\t\t\trule: options.link.rule,\n\t\t});\n\n\t\tlet eventLinkHash = null;\n\t\tif (options.link.type === 'event')\n\t\t{\n\t\t\teventLinkHash = options.link.hash;\n\t\t}\n\n\t\tthis.#slotsBlock = new SlotSelector({\n\t\t\tselectedTimezoneId: this.#calendar.getSelectedTimezoneId(),\n\t\t\towner: this.#owner,\n\t\t\tlink: options.parentLink || options.link,\n\t\t\tmembers: this.#eventMembers,\n\t\t\tsharingUser: options.sharingUser,\n\t\t\thasContactData: options.hasContactData,\n\t\t\tcalendarSettings: options.calendarSettings,\n\t\t\tevent: options.event,\n\t\t\tshowBackCalendarButtons: true,\n\t\t\teventLinkHash,\n\t\t\taction: options.action,\n\t\t});\n\n\t\tconst firstNodeWrapper = Tag.render`\n\t\t\t<div class=\"calendar-pub__block --plus\">\n\t\t\t\t${this.#calendar.render()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.animate = Tag.render`\n\t\t\t<div class=\"calendar-pub__block-animate\">\n\t\t\t\t${firstNodeWrapper}\n\t\t\t\t<div class=\"calendar-pub__block\">\n\t\t\t\t\t${this.#slotsBlock.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEventEmitter.subscribe('selectorTypeChange', (ev) => {\n\t\t\tif (ev.data === 'form' || ev.data === 'event')\n\t\t\t{\n\t\t\t\tDom.addClass(firstNodeWrapper, '--hidden');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(firstNodeWrapper, '--hidden');\n\t\t\t}\n\t\t});\n\n\t\tDom.append(this.#layout.animate, this.#getNodeWrapper());\n\n\t\tif (options.link.type !== 'event')\n\t\t{\n\t\t\tthis.#calendar.selectFirstAvailableDay();\n\t\t}\n\t}\n\n\t#renderSlotsSelector(options)\n\t{\n\t\tlet eventLinkHash = null;\n\t\tif (options.link.type === 'event')\n\t\t{\n\t\t\teventLinkHash = options.link.hash;\n\t\t}\n\n\t\tthis.#slotsBlock = new SlotSelector({\n\t\t\tselectedTimezoneId: null,\n\t\t\towner: this.#owner,\n\t\t\tlink: options.link,\n\t\t\tsharingUser: options.sharingUser,\n\t\t\thasContactData: options.hasContactData,\n\t\t\tcalendarSettings: options.calendarSettings,\n\t\t\tevent: options.event,\n\t\t\tshowBackCalendarButtons: false,\n\t\t\taction: options.action,\n\t\t\teventLinkHash,\n\t\t});\n\n\t\tthis.#layout.animate = Tag.render`\n\t\t\t<div class=\"calendar-pub__block-animate\">\n\t\t\t\t<div class=\"calendar-pub__block\">\n\t\t\t\t\t${this.#slotsBlock.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(this.#layout.animate, this.#getNodeWrapper());\n\t}\n\n\tshowFreeSlots()\n\t{\n\t\tDom.removeClass(this.#getNodeWrapper(), '--hide');\n\t}\n\n\thideFreeSlots()\n\t{\n\t\tDom.addClass(this.#getNodeWrapper(), '--hide');\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__wrapper calendar-pub__state --hide\"></div>\n\t\t\t`;\n\n\t\t\tif (Type.isArrayFilled(this.#linkMembers) || Type.isArrayFilled(this.#eventMembers))\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.wrapper, '--large');\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\t#render()\n\t{\n\t\tif (!this.target)\n\t\t{\n\t\t\tconsole.warn('BX.Calendar.Sharing: \"target\" is not defined');\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.target.parentNode)\n\t\t{\n\t\t\tDom.append(this.#getNodeWrapper(), this.target.parentNode);\n\t\t\tDom.remove(this.target);\n\t\t}\n\t}\n\n\t#init(): void\n\t{\n\t\tthis.#render();\n\t}\n}\n"],"names":["MembersList","constructor","params","members","render","Type","isArrayFilled","wrap","Tag","className","textClassName","Loc","getMessage","avatarSize","handleScroll","menu","MenuManager","create","id","Date","now","bindElement","avatarItems","items","map","member","html","Text","encode","name","lastName","autoHide","maxHeight","maxWidth","offsetLeft","offsetWidth","events","onShow","menuWidth","getPopupWindow","getPopupContainer","setOffset","adjustPosition","document","addEventListener","onClose","removeEventListener","maxAvatarsCount","showMoreIcon","length","avatarsCount","avatarClassName","slice","menuContainer","getMenuContainer","hoverElement","closeMenuHandler","setTimeout","contains","close","showMenuHandler","show","Event","bind","event","target","avatar","isStringFilled","Welcome","options","owner","link","currentLang","photo","wrapper","button","label","type","active","lastStatus","disableButton","Dom","addClass","enableButton","removeClass","hideButton","handleWelcomePageButtonClick","hasClass","EventEmitter","emit","setAccessDenied","info","encodeURI","mode","BX","ajax","runAction","data","linkHash","hash","entityId","entityType","notifyType","subscribe","accessDenied","infoTitle","infoSubTitle","title","subTitle","innerText","Day","value","notCurrentMonth","today","slots","selected","weekend","enableBooking","select","isSelected","getDay","isEnableBooking","highlight","unSelect","Calendar","monthWrapper","timezoneWrapper","month","currentMonth","prevNav","nextNav","daysOfWeek","navigation","back","userIds","accessibility","timezoneList","calendarSettings","rule","Intl","DateTimeFormat","resolvedOptions","timeZone","getMonth","getFullYear","getTimezoneOffset","slotSize","freeTime","stepSize","weekHolidays","weekStart","weekdays","Util","getWeekdaysLoc","nextYear","nextMonth","setInterval","updateEventSlotsList","currentYear","year","selectFirstAvailableDay","visibleDays","days","todayDay","getDate","filter","day","dayToSelect","find","undefined","selectMonthDay","highlightMonthDay","getSelectedTimezoneId","getTimezonePrefix","timezoneOffset","offset","date","getTime","format","getTimeFormatShort","newSelectedDay","state","timezoneNode","clean","append","weekDay","getIndByWeekDay","yearHolidays","push","splice","range","ranges","weekday","from","parseInt","to","intersected","notIntersected","interval","Math","min","max","getTimeZoneOffset","serverOffset","take","array","reduce","t","f","e","daysCount","accessibilityArrayKey","nowTimestamp","dayIndex","currentDate","isUndefined","floor","dayAccessibility","parseUTC","isFullDay","parseDate","slotStart","slotEnd","slotAccessibility","available","timeFrom","timeTo","dateIndex","setTime","from1","to1","from2","to2","startsInside","endsInside","startsBeforeEndsAfter","currentTimezoneOffset","nextMonthCreating","currentMonthIndex","nextMonthIndex","preloadNextMonth","arrayKey","firstMonthDay","lastMonthDay","response","timestampFrom","timestampTo","currentMonthDate","newDay","monthDays","monthKey","dayMonthKey","includes","timezoneSelect","Browser","isMobile","timezonesPopup","popupContent","getContentContainer","selectedTimezoneItem","querySelector","selectOffset","getBoundingClientRect","top","offsetHeight","scrollTop","offsetTop","isShown","destroy","Object","keys","timezoneId","text","onclick","window","innerHeight","selectNode","timezone","innerHTML","nodesWeekDays","param","monthInfo","firstDayOfMonth","lastDateOfMonth","lastDayOfLastMonth","nodeMonth","k","j","i","dayOfWeek","result","touchPosition","x","touchMove","ev","changedTouches","clientX","style","removeProperty","preventDefault","currentMonthName","direction","isString","once","monthIndex","Base","isHiddenOnStart","getContent","getType","WidgetDate","calendarPage","dayInfo","timeInterval","avatarsSection","updateValue","isBoolean","updateLayout","isStartAndEndInDifferentDays","dayOfWeekMonthFormat","getFormat","shortTimeFormat","formatDayMonthShortTime","formatTimeInterval","setAttribute","getFormattedTimezone","Form","sharingUser","isFromCrm","hasContactData","isPhoneFeatureEnabled","isMailFeatureEnabled","buttonSend","widgetDate","formArea","inputs","contact","description","authorName","contactData","authorNameEmpty","contactDataEmpty","contactDataIncorrect","cleanDescription","updateFormValue","updateFormLayout","clearInputErrors","isSuccessful","eventName","ownerCreated","ownerId","dateFrom","dateTo","userName","userContact","crmDealLinkHash","parentLinkHash","errors","eventId","eventLinkId","eventLinkHash","eventLinkShortUrl","isView","contactDataError","isEmptyContactName","dateInFormat","getDateFormat","timeInFormat","getTimeFormat","phone","replace","match","nameInputError","contactInputError","messageCode","inputMode","personalMailbox","personalPhone","parentNode","textBeforeCursor","input","selectionStart","firstPart","lastCharacter","matches","formattedPosition","indexOf","setSelectionRange","key","isAnyModifierKeyPressed","test","hasPlus","substr","split","item","code","mask","repeat","r","sort","a","b","EmptyState","content","AccessDenied","SlotItem","BUTTON_MAX_WIDTH","showForm","body","remove","SlotList","list","timezoneNotice","timezoneNoticeOffset","ownerOffset","updateSlotsList","slotListNode","newSelectedSlot","getData","slotSelector","timezoneNoticeText","timezoneIsVeryDifferent","abs","sign","formatDuration","currentDaySlots","slot","slotItem","scrollHeight","ceil","icon","stateTitle","additionalBlock","bottomButton","canceledTimestamp","canceledUserName","canceledByManager","inDeletedSlider","showBackCalendarButtons","action","showCancelEventPopup","downloadIcsFile","startVideoconference","getPopup","popup","closeCancelEventPopup","handleDeleteButtonClick","BottomSheet","padding","Popup","contentBackground","width","animation","overlay","isSuccess","deleteEvent","error","console","conferenceLink","location","href","icsFile","getTimezoneDateFromTimestampUTC","timestampFromUTC","timestampToUTC","externalUserName","oldNode","newNode","videoconferenceButton","icsButton","SlotSelector","BLOCK_NAME_FORM","BLOCK_NAME_SLOT_LIST","BLOCK_NAME_EMPTY_STATE","BLOCK_NAME_ACCESS_DENIED","BLOCK_NAME_EVENT","selectedTimezoneId","empty","form","slotList","emptyState","openForm","openBlock","openSlotList","openEmptyState","openAccessDenied","openEvent","blockName","phoneFeatureEnabled","mailFeatureEnabled","meetingStatus","deleted","eventData","PublicV2","isDomNode","animate","parentLink","showPageWelcome","showFreeSlots","hideFreeSlots","userAccessibility","firstNodeWrapper","warn"],"mappings":"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"}