{"version":3,"file":"public-v2.bundle.js","sources":["../src/components/welcome.js","../src/components/calendar/day.js","../src/components/calendar/calendar.js","../src/components/slot-selector/base.js","../src/components/slot-selector/widget-date.js","../src/components/slot-selector/form/form.js","../src/components/slot-selector/empty-state/empty-state.js","../src/components/slot-selector/empty-state/access-denied.js","../src/components/slot-selector/slot-list/slot-item.js","../src/components/slot-selector/slot-list/slot-list.js","../src/components/slot-selector/event/event.js","../src/components/slot-selector/slot-selector.js","../src/public.js"],"sourcesContent":["import { Tag, Loc, Event, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport 'ui.icons.b24';\n\ntype WelcomeOptions = {\n\towner: any,\n\tlink: any,\n\tcurrentLang: string,\n}\n\nexport default class Welcome\n{\n\t#owner;\n\t#link;\n\t#currentLang;\n\t#name;\n\t#lastName;\n\t#photo;\n\t#layout;\n\n\tconstructor(options: WelcomeOptions)\n\t{\n\t\tthis.#owner = options.owner || null;\n\t\tthis.#link = options.link || null;\n\t\tthis.#currentLang = options.currentLang || null;\n\t\tthis.#name = this.#owner.name || null;\n\t\tthis.#lastName = this.#owner.lastName || null;\n\t\tthis.#photo = this.#owner.photo || null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tbutton: null,\n\t\t\tlabel: null,\n\t\t};\n\n\t\tif (\n\t\t\tthis.#link\n\t\t\t&& this.#link.type === 'crm_deal'\n\t\t\t&& this.#link.active === true\n\t\t\t&& this.#link.lastStatus !== 'viewed'\n\t\t\t&& this.#link.lastStatus !== 'notViewed'\n\t\t)\n\t\t{\n\t\t\tthis.#handleTimelineNotify('notViewed');\n\t\t\tthis.#link.lastStatus = 'notViewed';\n\t\t}\n\t}\n\n\tdisableButton()\n\t{\n\t\tDom.addClass(this.#layout.button, '--disabled');\n\t}\n\n\tenableButton()\n\t{\n\t\tDom.removeClass(this.#layout.button, '--disabled');\n\t}\n\n\thideButton()\n\t{\n\t\tDom.addClass(this.#layout.button, '--hidden');\n\t}\n\n\thandleWelcomePageButtonClick()\n\t{\n\t\tif (Dom.hasClass(this.#layout.button, '--disabled'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tthis.#link\n\t\t\t&& this.#link.type === 'crm_deal'\n\t\t\t&& this.#link.active === true\n\t\t\t&& this.#link.lastStatus === 'notViewed'\n\t\t)\n\t\t{\n\t\t\tthis.#handleTimelineNotify('viewed');\n\t\t\tthis.#link.lastStatus = 'viewed';\n\t\t}\n\n\t\tthis.disableButton();\n\t\tEventEmitter.emit('showSlotSelector', this);\n\t}\n\n\t#handleTimelineNotify(mode)\n\t{\n\t\tBX.ajax.runAction('calendar.api.sharingajax.handleTimelineNotify', {\n\t\t\tdata: {\n\t\t\t\tlinkHash: this.#link.hash,\n\t\t\t\tentityId: this.#link.entityId,\n\t\t\t\tentityType: this.#link.type,\n\t\t\t\tnotifyType: mode\n\t\t\t}\n\t\t});\n\t}\n\n\t#getNodeButton(): HTMLElement\n\t{\n\t\tif (!this.#layout.button)\n\t\t{\n\t\t\tthis.#layout.button = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__btn\">\n\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_SELECT_SLOT')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.button, 'click', ()=> {\n\t\t\t\tthis.handleWelcomePageButtonClick();\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe('hideSlotSelector', this.enableButton.bind(this));\n\t\t}\n\n\t\treturn this.#layout.button;\n\t}\n\n\t#getNodeLabel()\n\t{\n\t\tif (!this.#layout.label)\n\t\t{\n\t\t\tthis.#layout.label = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__block-label\"></div>\n\t\t\t`;\n\n\t\t\tif (this.#currentLang === 'ru')\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.label, '--ru');\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.label;\n\t}\n\n\tsetAccessDenied()\n\t{\n\t\tthis.#layout.info = this.#getNodeInfo(true);\n\t}\n\n\t#getNodeInfo(accessDenied = false)\n\t{\n\t\tif (!this.#layout.info)\n\t\t{\n\t\t\tthis.#layout.infoTitle = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__typography-title calendar-pub__welcome-info_title\"></div>\n\t\t\t`;\n\t\t\tthis.#layout.infoSubTitle = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__typography-s\"></div>\n\t\t\t`;\n\n\t\t\tthis.#layout.info = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__welcome-info\">\n\t\t\t\t\t<div class=\"calendar-pub-ui__typography-title calendar-pub__welcome-info_title\">${this.#layout.infoTitle}</div>\n\t\t\t\t\t<div class=\"calendar-pub-ui__typography-s\">${this.#layout.infoSubTitle}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tlet title = Loc.getMessage('CALENDAR_SHARING_MY_FREE_SLOTS');\n\t\tlet subTitle = Loc.getMessage('CALENDAR_SHARING_YOU_CAN_CHOOSE_FREE_MEETING_TIME');\n\t\tif (accessDenied)\n\t\t{\n\t\t\ttitle = Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED');\n\t\t\tsubTitle = Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED_INFO');\n\t\t}\n\n\t\tthis.#layout.infoTitle.innerText = title;\n\t\tthis.#layout.infoSubTitle.innerText = subTitle;\n\n\t\treturn this.#layout.info;\n\t}\n\n\trender()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__block --welcome\">\n\t\t\t\t${this.#getNodeLabel()}\n\t\t\t\t<div class=\"calendar-pub__welcome\">\n\t\t\t\t\t<div class=\"calendar-pub__welcome-user\">\n\t\t\t\t\t\t<div class=\"calendar-pub__welcome-userpic ui-icon ui-icon-common-user\">\n\t\t\t\t\t\t\t<i ${this.#photo ? `style=\"background-image: url(${encodeURI(this.#photo)})\"` : ''}></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-pub-ui__typography-m\">\n\t\t\t\t\t\t\t${this.#name ? this.#name : ''} ${this.#lastName ? this.#lastName : ''} \n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-pub__block-separator\"></div>\n\t\t\t\t\t${this.#getNodeInfo()}\n\t\t\t\t\t<div class=\"calendar-pub__welcome-bottom\">\n\t\t\t\t\t\t${this.#getNodeButton()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { Tag, Loc, Dom, Event } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\ntype DayOptions = {\n\tvalue: number,\n\tnotCurrentMonth: boolean,\n\ttoday: boolean,\n\tselected: boolean,\n\tweekend: boolean,\n\tenableBooking: boolean,\n\tslots: Object,\n}\n\nexport default class Day\n{\n\t#layout;\n\t#value;\n\t#notCurrentMonth;\n\t#today;\n\t#selected;\n\t#weekend;\n\t#slots;\n\t#enableBooking;\n\n\tconstructor(options: DayOptions)\n\t{\n\t\tthis.#value = options.value ? options.value : null;\n\t\tthis.#notCurrentMonth = options.notCurrentMonth ? options.notCurrentMonth : null;\n\t\tthis.#today = options.today ? options.today : null;\n\t\tthis.#slots = options.slots || null;\n\t\tthis.#layout = {\n\t\t\twrapper: null\n\t\t};\n\t\tthis.#selected = options.selected ? options.selected : null;\n\t\tthis.#weekend = options.weekend ? options.weekend : null;\n\t\tthis.#enableBooking = options.enableBooking ? options.enableBooking : null;\n\n\t\tif (this.#selected)\n\t\t{\n\t\t\tthis.select();\n\t\t}\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEvent.bind(this.#getNodeWrapper(), 'click', this.select.bind(this));\n\t}\n\n\tisSelected()\n\t{\n\t\treturn this.#selected;\n\t}\n\n\tgetDay()\n\t{\n\t\treturn this.#value;\n\t}\n\n\tisEnableBooking()\n\t{\n\t\treturn this.#enableBooking;\n\t}\n\n\tselect()\n\t{\n\t\tthis.highlight();\n\t\tEventEmitter.emit('switchSlots', {\n\t\t\tslots: this.#slots,\n\t\t});\n\t}\n\n\thighlight()\n\t{\n\t\tthis.#selected = true;\n\t\tDom.addClass(this.#getNodeWrapper(), '--selected');\n\t\tEventEmitter.emit('selectDate', this);\n\t}\n\n\tunSelect()\n\t{\n\t\tthis.#selected = null;\n\t\tDom.removeClass(this.#getNodeWrapper(), '--selected');\n\t}\n\n\t#getNodeWrapper():HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__month-col --day\">${this.#value}</div>\n\t\t\t`;\n\n\t\t\tif (this.#notCurrentMonth)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.wrapper, '--not-current-month');\n\t\t\t}\n\n\t\t\tif (this.#weekend)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.wrapper, '--weekend');\n\t\t\t}\n\n\t\t\tif (this.#enableBooking)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.wrapper, '--enable-booking');\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n}\n","import { Tag, Loc, Type, Dom, Event } from 'main.core';\nimport { EventEmitter } from \"main.core.events\";\nimport { Util } from 'calendar.util';\nimport Day from './day';\nimport { DateTimeFormat } from \"main.date\";\nimport { Browser } from 'main.core'\nimport { MenuManager } from 'main.popup';\n\nexport default class Calendar\n{\n\t#owner;\n\t#accessibility;\n\t#layout;\n\t#currentMonth;\n\t#currentYear;\n\t#nowTime;\n\t#months;\n\t#selectedDay;\n\t#monthsSlotsMap;\n\t#timezoneOffsetUtc;\n\t#selectedTimezoneOffsetUtc;\n\t#currentMonthIndex;\n\t#currentDayNumber;\n\t#timezoneList;\n\t#calendarSettings;\n\t#selectedTimezoneId;\n\t#selectedTimezoneNode;\n\t#config;\n\t#loc;\n\t#timeZonePopup;\n\n\tconstructor(options)\n\t{\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tmonthWrapper: null,\n\t\t\ttimezoneWrapper: null,\n\t\t\tmonth: null,\n\t\t\tcurrentMonth: null,\n\t\t\tprevNav: null,\n\t\t\tnextNav: null,\n\t\t\tdaysOfWeek: null,\n\t\t\tnavigation: null,\n\t\t\tback: null\n\t\t};\n\n\t\tthis.#owner = options.owner;\n\t\tthis.#accessibility = options.accessibility;\n\t\tthis.#timezoneList = options.timezoneList;\n\t\tthis.#calendarSettings = options.calendarSettings;\n\n\t\tthis.#nowTime = new Date();\n\t\tthis.#currentMonthIndex = 0;\n\t\tthis.#currentDayNumber = 1;\n\t\tthis.#selectedTimezoneId = Intl.DateTimeFormat().resolvedOptions().timeZone || 'UTC';\n\t\tthis.#currentMonth = this.#nowTime.getMonth();\n\t\tthis.#currentYear = this.#nowTime.getFullYear();\n\t\tthis.#timezoneOffsetUtc = this.#nowTime.getTimezoneOffset();\n\t\tthis.#selectedTimezoneOffsetUtc = this.#nowTime.getTimezoneOffset();\n\t\tthis.#months = [];\n\t\tthis.#monthsSlotsMap = [];\n\t\tthis.#config = {\n\t\t\teventDurability: 3600000,\n\t\t\tstepSize: 3600000,\n\t\t\tweekHolidays: [6, 0],\n\t\t\tweekStart: 1,\n\t\t}\n\t\tthis.#loc = {\n\t\t\tweekdays: Util.getWeekdaysLoc(),\n\t\t};\n\t\tthis.#timeZonePopup = null;\n\n\t\tthis.#setConfig();\n\t\tthis.#initCurrentMonthSlots();\n\t\tthis.#bindEvents();\n\t\tsetInterval(this.#incrementTime.bind(this), 15000);\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('selectDate', (event) => {\n\t\t\tconst newSelectedDay = event.data;\n\t\t\tif (this.#selectedDay !== newSelectedDay)\n\t\t\t{\n\t\t\t\tthis.#selectedDay?.unSelect();\n\t\t\t}\n\n\t\t\tthis.#selectedDay = newSelectedDay;\n\t\t\tthis.#currentDayNumber = this.#selectedDay.getDay();\n\t\t});\n\n\t\tEventEmitter.subscribe('onSaveEvent', async (event) => {\n\t\t\tif (event.data.state === 'created' || event.data.state === 'not-created')\n\t\t\t{\n\t\t\t\tawait this.updateEventSlotsList();\n\t\t\t\tthis.highlightMonthDay();\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('onDeleteEvent', async () => {\n\t\t\tawait this.updateEventSlotsList();\n\t\t});\n\n\t\tEventEmitter.subscribe('onCreateAnotherEventButtonClick', () => {\n\t\t\tthis.selectFirstAvailableDay();\n\t\t});\n\t}\n\n\t#incrementTime()\n\t{\n\t\tthis.#nowTime = new Date();\n\n\t\tconst timezoneNode = this.#getNodeTimeZone();\n\t\tDom.clean(this.#getNodeTimezoneWrapper());\n\t\tDom.append(timezoneNode, this.#getNodeTimezoneWrapper());\n\t}\n\n\t#setConfig()\n\t{\n\t\tif (this.#calendarSettings.weekHolidays)\n\t\t{\n\t\t\tthis.#config.weekHolidays = this.#calendarSettings.weekHolidays.map(\n\t\t\t\tweekDay => Util.getIndByWeekDay(weekDay)\n\t\t\t);\n\t\t}\n\t\tif (this.#calendarSettings.yearHolidays)\n\t\t{\n\t\t\tthis.#config.yearHolidays = this.#calendarSettings.yearHolidays;\n\t\t}\n\t\tif (this.#calendarSettings.weekStart)\n\t\t{\n\t\t\tthis.#config.weekStart = Util.getIndByWeekDay(this.#calendarSettings.weekStart);\n\t\t\tthis.#loc.weekdays.push(...this.#loc.weekdays.splice(0, this.#config.weekStart));\n\t\t}\n\n\t\tconst hourOffset = Util.getTimeZoneOffset(this.#selectedTimezoneId) / 60;\n\t\tif (this.#calendarSettings.workTimeStart)\n\t\t{\n\t\t\tconst workTimeStart = parseFloat(this.#calendarSettings.workTimeStart) - hourOffset;\n\t\t\tthis.#config.workTimeStartHours = workTimeStart - workTimeStart % 1;\n\t\t\tthis.#config.workTimeStartMinutes = (workTimeStart % 1) * 60;\n\t\t}\n\t\tif (this.#calendarSettings.workTimeEnd)\n\t\t{\n\t\t\tconst workTimeEnd = parseFloat(this.#calendarSettings.workTimeEnd) - hourOffset;\n\t\t\tthis.#config.workTimeEndHours = workTimeEnd - workTimeEnd % 1;\n\t\t\tthis.#config.workTimeEndMinutes = (workTimeEnd % 1) * 60;\n\t\t}\n\n\t\tif (this.#selectedTimezoneId === 'UTC' || !this.#timezoneList[this.#selectedTimezoneId])\n\t\t{\n\t\t\tthis.#selectedTimezoneId = 'Africa/Dakar';\n\t\t}\n\t}\n\n\t#initCurrentMonthSlots()\n\t{\n\t\tthis.#calculateDateTimeSlots(this.#nowTime.getFullYear(), this.#nowTime.getMonth());\n\n\t\tconst month = this.#createMonth(this.#nowTime.getFullYear(), this.#nowTime.getMonth());\n\t\tthis.#months.push(month);\n\t}\n\n\t#calculateDateTimeSlots(year, month)\n\t{\n\t\tconst map = [];\n\t\tconst daysCount = new Date(year, month + 1, 0).getDate();\n\t\tconst accessibilityArrayKey = (month + 1) + '.' + year;\n\t\tconst nowTimestamp = this.#nowTime.getTime();\n\t\tconst timezoneOffset = (this.#selectedTimezoneOffsetUtc - this.#timezoneOffsetUtc) * (-60) * 1000;\n\n\t\tfor (let dayIndex = 1; dayIndex <= daysCount; dayIndex++)\n\t\t{\n\t\t\tconst currentDate = new Date(year, month, dayIndex);\n\n\t\t\tconst from = new Date(year, month, dayIndex, this.#config.workTimeStartHours, this.#config.workTimeStartMinutes);\n\t\t\tconst to = new Date(year, month, dayIndex, this.#config.workTimeEndHours, this.#config.workTimeEndMinutes);\n\n\t\t\tconst dayAccessibility = this.#accessibility[accessibilityArrayKey].filter((event) => {\n\t\t\t\tconst parseUTC = !event.isFullDay;\n\t\t\t\treturn this.#doIntervalsIntersect(\n\t\t\t\t\tBX.parseDate(event.from, parseUTC).getTime(),\n\t\t\t\t\tBX.parseDate(event.to, parseUTC).getTime(),\n\t\t\t\t\tfrom.getTime(),\n\t\t\t\t\tto.getTime(),\n\t\t\t\t);\n\t\t\t});\n\n\t\t\twhile (from.getTime() < to.getTime())\n\t\t\t{\n\t\t\t\tconst slotStart = from.getTime();\n\t\t\t\tconst slotEnd = slotStart + this.#config.eventDurability;\n\n\t\t\t\tif (slotEnd > to.getTime())\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tconst slotAccessibility = dayAccessibility.filter((event) => {\n\t\t\t\t\tconst parseUTC = !event.isFullDay;\n\t\t\t\t\treturn this.#doIntervalsIntersect(\n\t\t\t\t\t\tBX.parseDate(event.from, parseUTC).getTime(),\n\t\t\t\t\t\tBX.parseDate(event.to, parseUTC).getTime(),\n\t\t\t\t\t\tslotStart,\n\t\t\t\t\t\tslotEnd,\n\t\t\t\t\t);\n\t\t\t\t});\n\n\t\t\t\tconst available = slotAccessibility.length === 0 && !this.#isHoliday(currentDate) && slotStart > nowTimestamp;\n\t\t\t\tif (available)\n\t\t\t\t{\n\t\t\t\t\tconst timeFrom = new Date(slotStart + timezoneOffset);\n\t\t\t\t\tconst timeTo = new Date(timeFrom.getTime() + (slotEnd - slotStart));\n\t\t\t\t\tconst dateIndex = timeFrom.getDate();\n\t\t\t\t\tmap[dateIndex] ??= [];\n\t\t\t\t\tif (timeFrom.getMonth() === month)\n\t\t\t\t\t{\n\t\t\t\t\t\tmap[dateIndex].push({ timeFrom, timeTo });\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfrom.setTime(from.getTime() + this.#config.stepSize);\n\t\t\t}\n\t\t}\n\n\t\tthis.#monthsSlotsMap[accessibilityArrayKey] = map;\n\t}\n\n\t#createMonth(year, month)\n\t{\n\t\treturn {\n\t\t\tyear: year,\n\t\t\tmonth: month,\n\t\t\tcurrentTimezoneOffset: this.#selectedTimezoneOffsetUtc,\n\t\t\tname: this.#getMonthName(month),\n\t\t\tdays: this.#getMonthDays(year, month),\n\t\t};\n\t}\n\n\tasync updateEventSlotsList()\n\t{\n\t\tconst month = this.#months[this.#currentMonthIndex];\n\t\tconst currentYear = month.year;\n\t\tconst currentMonth = month.month + 1;\n\t\tconst arrayKey = currentMonth + '.' + currentYear;\n\n\t\tthis.#accessibility[arrayKey] = await this.#loadMonthAccessibility(currentYear, currentMonth);\n\n\t\tthis.#reCreateCurrentMonth();\n\t}\n\n\t#reCreateCurrentMonth()\n\t{\n\t\tthis.#updateMonth(this.#currentMonthIndex);\n\t\tthis.#updateCalendar();\n\t}\n\n\tasync #createNextMonth()\n\t{\n\t\tconst currentMonth = this.#months[this.#currentMonthIndex];\n\t\tconst currentYear = currentMonth.year;\n\t\tconst currentMonthIndex = currentMonth.month;\n\n\t\tconst nextMonthIndex = (currentMonthIndex + 1) % 12;\n\t\tconst nextYear = currentYear + Math.floor((currentMonthIndex + 1) / 12);\n\t\tconst nextMonth = nextMonthIndex + 1;\n\n\t\tconst arrayKey = nextMonth + '.' + nextYear;\n\n\t\tthis.#accessibility[arrayKey] = await this.#loadMonthAccessibility(nextYear, nextMonth);\n\n\t\tthis.#calculateDateTimeSlots(nextYear, nextMonthIndex);\n\n\t\tconst month = this.#createMonth(nextYear, nextMonthIndex);\n\t\tthis.#months.push(month);\n\t}\n\n\tasync #loadMonthAccessibility(year, month)\n\t{\n\t\tconst firstMonthDay = new Date(year, month - 1, 1);\n\t\tconst lastMonthDay = new Date(year, month, 0, 23, 59);\n\n\t\tconst response = await BX.ajax.runAction('calendar.api.sharingajax.getUserAccessibility', {\n\t\t\tdata: {\n\t\t\t\tuserId: this.#owner.id,\n\t\t\t\ttimestampFrom: firstMonthDay.getTime(),\n\t\t\t\ttimestampTo: lastMonthDay.getTime(),\n\t\t\t}\n\t\t});\n\n\t\treturn response.data;\n\t}\n\n\t#getMonthName(month)\n\t{\n\t\tconst currentMonthDate = new Date(this.#nowTime.getFullYear(), month, 1);\n\n\t\treturn DateTimeFormat.format('f', currentMonthDate.getTime() / 1000);\n\t}\n\n\t#getMonthDays(year, month)\n\t{\n\t\tconst days = [];\n\t\tconst daysCount = new Date(year, month + 1, 0).getDate();\n\t\tconst accessibilityArrayKey = (month + 1) + '.' + year;\n\n\t\tfor (let dayIndex = 1; dayIndex <= daysCount; dayIndex++)\n\t\t{\n\t\t\tconst newDay = new Date(year, month, dayIndex);\n\t\t\tconst slots = this.#monthsSlotsMap[accessibilityArrayKey][newDay.getDate()] ?? [];\n\n\t\t\tconst params = {\n\t\t\t\tvalue: dayIndex,\n\t\t\t\tslots: slots,\n\t\t\t\tweekend: this.#isHoliday(newDay),\n\t\t\t\tenableBooking: slots.length > 0,\n\t\t\t};\n\n\t\t\tconst day = new Day(params);\n\t\t\tdays.push(day);\n\t\t}\n\n\t\treturn days;\n\t}\n\n\tselectFirstAvailableDay()\n\t{\n\t\tlet visibleDays = this.#months[this.#currentMonthIndex].days;\n\t\tif (this.#currentMonthIndex === 0)\n\t\t{\n\t\t\tconst todayDay = this.#nowTime.getDate();\n\t\t\tvisibleDays = visibleDays.filter(day => day.getDay() >= todayDay).slice(0,14);\n\t\t}\n\t\tlet dayToSelect = visibleDays.find(day => day.isEnableBooking());\n\t\tif (dayToSelect === undefined)\n\t\t{\n\t\t\tdayToSelect = visibleDays[0];\n\t\t}\n\n\t\tdayToSelect.select();\n\t}\n\n\tselectMonthDay()\n\t{\n\t\tconst dayToSelect = this.#getDayToSelect();\n\n\t\tthis.#currentDayNumber = dayToSelect.day;\n\t\tdayToSelect.select();\n\t}\n\n\thighlightMonthDay()\n\t{\n\t\tconst dayToSelect = this.#getDayToSelect();\n\n\t\tthis.#currentDayNumber = dayToSelect.day;\n\t\tdayToSelect.highlight();\n\t}\n\n\t#getDayToSelect()\n\t{\n\t\tconst monthDays = this.#months[this.#currentMonthIndex].days;\n\t\tlet dayToSelect = monthDays.find(day => day.getDay() === this.#currentDayNumber);\n\t\tif (dayToSelect === undefined)\n\t\t{\n\t\t\tdayToSelect = monthDays[monthDays.length - 1];\n\t\t}\n\n\t\treturn dayToSelect;\n\t}\n\n\t#isHoliday(day)\n\t{\n\t\tconst dayMonthKey = day.getDate() + '.' + ('0' + (day.getMonth() + 1)).slice(-2);\n\n\t\treturn (this.#config.weekHolidays.includes(day.getDay()) || this.#config.yearHolidays[dayMonthKey] !== undefined);\n\t}\n\n\t#doIntervalsIntersect(from1, to1, from2, to2)\n\t{\n\t\tconst startsInside = from2 <= from1 && from1 < to2;\n\t\tconst endsInside = from2 < to1 && to1 <= to2;\n\t\tconst startsBeforeEndsAfter = from1 <= from2 && to1 >= to2;\n\n\t\treturn startsInside || endsInside || startsBeforeEndsAfter;\n\t}\n\n\tgetSelectedTimezoneId()\n\t{\n\t\treturn this.#selectedTimezoneId;\n\t}\n\n\t#getNodeTimeZone()\n\t{\n\t\tthis.#selectedTimezoneNode = Tag.render`\n\t\t\t<div class=\"calendar-sharing__timezone-value\">\n\t\t\t\t${ this.#getFormattedTimezone(this.#selectedTimezoneId) }\n\t\t\t</div>\n\t\t`;\n\n\t\tconst timezoneSelect = Tag.render`\n\t\t\t<div class=\"calendar-sharing__timezone\">\n\t\t\t\t${Browser.isMobile() ? this.#getNodeTimezoneSelect() : ''}\n\t\t\t\t<div class=\"calendar-sharing__timezone-area\">\n\t\t\t\t\t<div class=\"calendar-sharing__timezone-title\">${Loc.getMessage('CALENDAR_SHARING_YOR_TIME')}:</div>\n\t\t\t\t\t${ this.#selectedTimezoneNode }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#getPopupTimezoneSelect();\n\n\t\tif (!Browser.isMobile())\n\t\t{\n\t\t\ttimezoneSelect.addEventListener('click', ()=> {\n\t\t\t\tconst timezonesPopup = this.#getPopupTimezoneSelect().getPopupWindow();\n\t\t\t\ttimezonesPopup.show();\n\n\t\t\t\tconst popupContent = timezonesPopup.getContentContainer();\n\t\t\t\tconst selectedTimezoneItem = popupContent.querySelector('.menu-popup-item.--selected');\n\t\t\t\tconst selectOffset = timezoneSelect.getBoundingClientRect().top + timezoneSelect.offsetHeight / 4 - popupContent.getBoundingClientRect().top;\n\t\t\t\tpopupContent.scrollTop = selectedTimezoneItem.offsetTop - selectOffset;\n\t\t\t});\n\t\t}\n\n\t\treturn timezoneSelect;\n\t}\n\n\t#getPopupTimezoneSelect()\n\t{\n\t\tif (this.#timeZonePopup?.getPopupWindow().isShown())\n\t\t{\n\t\t\treturn this.#timeZonePopup;\n\t\t}\n\n\t\tthis.#timeZonePopup?.destroy();\n\t\tconst items = Object.keys(this.#timezoneList).map((timezoneId) => ({\n\t\t\ttext: this.#getFormattedTimezone(timezoneId),\n\t\t\tclassName: (timezoneId === this.#selectedTimezoneId) ? 'menu-popup-no-icon --selected' : 'menu-popup-no-icon',\n\t\t\tonclick: ()=> {\n\t\t\t\tthis.#updateTimezone(timezoneId);\n\t\t\t\tthis.#timeZonePopup.close();\n\t\t\t}\n\t\t}));\n\n\t\tthis.#timeZonePopup = MenuManager.create({\n\t\t\tid: 'momomiomsiomx92984j',\n\t\t\tclassName: 'calendar-sharing-timezone-select-popup',\n\t\t\titems: items,\n\t\t\tautoHide: true,\n\t\t\tmaxHeight: window.innerHeight - 150\n\t\t});\n\n\t\treturn this.#timeZonePopup;\n\t}\n\n\t#getNodeTimezoneSelect()\n\t{\n\t\tconst selectNode = Tag.render`\n\t\t\t<select class=\"calendar-sharing__timezone-select\">\n\t\t\t\t${Object.keys(this.#timezoneList).map(timezoneId => Tag.render`\n\t\t\t\t\t<option value=\"${timezoneId}\" ${timezoneId === this.#selectedTimezoneId ? 'selected' : ''}>\n\t\t\t\t\t\t${this.#getFormattedTimezone(timezoneId)}\n\t\t\t\t\t</option>\n\t\t\t\t`)}\n\t\t\t</select>\n\t\t`;\n\n\t\tselectNode.addEventListener('change', () => this.#updateTimezone(selectNode.value));\n\n\t\treturn selectNode;\n\t}\n\n\t#updateTimezone(timezoneId)\n\t{\n\t\tthis.#selectedTimezoneId = timezoneId;\n\t\tthis.#selectedTimezoneOffsetUtc = - (this.#timezoneList[this.#selectedTimezoneId].offset / 60);\n\t\tEventEmitter.emit('updateTimezone', {timezone: timezoneId});\n\t\tthis.#selectedTimezoneNode.innerHTML = this.#getFormattedTimezone(this.#selectedTimezoneId);\n\t\tthis.#reCreateCurrentMonth();\n\t\tthis.selectMonthDay();\n\t}\n\n\t#getFormattedTimezone(timezoneId)\n\t{\n\t\treturn `${ this.getTimezonePrefix(this.#timezoneList[timezoneId].offset) } - ${timezoneId}`;\n\t}\n\n\tgetTimezonePrefix(timezoneOffset)\n\t{\n\t\tconst offset = timezoneOffset * 1000 - this.#timezoneOffsetUtc * (-60000);\n\t\tconst date = new Date(this.#nowTime.getTime() + offset);\n\n\t\treturn DateTimeFormat.format(Util.getTimeFormatShort(), date.getTime() / 1000);\n\t}\n\n\t#getNodeDaysOfWeek(): HTMLElement\n\t{\n\t\tif (!this.#layout.daysOfWeek)\n\t\t{\n\t\t\tconst nodesWeekDays = this.#loc.weekdays.map((weekDay)=> {\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"calendar-sharing__month-col --day-of-week\">${weekDay}</div>\n\t\t\t\t`;\n\t\t\t});\n\n\t\t\tthis.#layout.daysOfWeek = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__month-row\">${nodesWeekDays}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.daysOfWeek;\n\t}\n\n\t#getNodeDay(param = {}): HTMLElement\n\t{\n\t\tparam.selected = this.#selectedDay?.getDay() === param.value && param.currentMonth === true;\n\t\tconst day = new Day(param);\n\n\t\treturn day.render();\n\t}\n\n\t#getNodeMonth()\n\t{\n\t\tconst monthInfo = this.#months[this.#currentMonthIndex];\n\t\tconst year = monthInfo.year;\n\t\tconst month = monthInfo.month;\n\n\t\tconst firstDayOfMonth = (new Date(year, month, 7).getDay() - (this.#config.weekStart - 1) + 7) % 7;\n\t\tconst lastDateOfMonth = new Date(year, month + 1, 0).getDate();\n\t\tconst lastDayOfLastMonth = month === 0\n\t\t\t? new Date(year - 1, 11, 0).getDate()\n\t\t\t: new Date(year, month, 0).getDate()\n\t\t;\n\n\t\tconst nodeMonth = Tag.render`<div class=\"calendar-sharing__month-row\"></div>`;\n\n\t\tlet k = lastDayOfLastMonth - firstDayOfMonth + 1;\n\t\tfor (let j = 0; j < firstDayOfMonth; j++)\n\t\t{\n\t\t\tDom.append(this.#getNodeDay({\n\t\t\t\tvalue: k,\n\t\t\t\tnotCurrentMonth: true,\n\t\t\t}), nodeMonth);\n\t\t\tk++;\n\t\t}\n\n\t\tfor (let i = 0; i <= lastDateOfMonth - 1; i++)\n\t\t{\n\t\t\tconst day = monthInfo.days[i];\n\t\t\tDom.append(day.render(), nodeMonth);\n\t\t}\n\n\t\tlet dayOfWeek = (new Date(year, month, lastDateOfMonth).getDay() - this.#config.weekStart + 7) % 7;\n\t\tfor (dayOfWeek, k = 1; dayOfWeek < 6; dayOfWeek++)\n\t\t{\n\t\t\tDom.append(this.#getNodeDay({\n\t\t\t\tvalue: k,\n\t\t\t\tnotCurrentMonth: true,\n\t\t\t}), nodeMonth);\n\t\t\tk++;\n\t\t}\n\n\t\tconst result = Tag.render`\n\t\t\t<div class=\"calendar-sharing__month\">\n\t\t\t\t${this.#getNodeDaysOfWeek()}\n\t\t\t\t${nodeMonth}\n\t\t\t</div>\n\t\t`;\n\n\t\tlet touchPosition = {\n\t\t\tx: null\n\t\t};\n\n\t\tlet touchMove = (ev) => {\n\t\t\ttouchPosition.x = ev.changedTouches[0].clientX\n\t\t};\n\n\t\tresult.addEventListener('touchstart', (ev)=> {\n\t\t\ttouchMove(ev);\n\t\t});\n\n\t\tresult.addEventListener('touchend', (ev)=> {\n\t\t\tif (touchPosition.x < ev.changedTouches[0].clientX - 100)\n\t\t\t{\n\t\t\t\tthis.#handlePreviousMonthArrowClick();\n\t\t\t}\n\n\t\t\tif (touchPosition.x > ev.changedTouches[0].clientX + 100)\n\t\t\t{\n\t\t\t\tthis.#handleNextMonthArrowClick();\n\t\t\t}\n\n\t\t\tresult.style.removeProperty('transform');\n\t\t});\n\n\t\tresult.addEventListener('touchmove', (ev)=> {\n\t\t\tev.preventDefault();\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#getNodeMonthWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.monthWrapper)\n\t\t{\n\t\t\tthis.#layout.monthWrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --month\">\n\t\t\t\t\t${this.#getNodeMonth()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.monthWrapper;\n\t}\n\n\t#getNodeTimezoneWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.timezoneWrapper)\n\t\t{\n\t\t\tthis.#layout.timezoneWrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block\">\n\t\t\t\t\t${this.#getNodeTimeZone()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.timezoneWrapper;\n\t}\n\n\t#getNodeCurrentMonth()\n\t{\n\t\tif (!this.#layout.currentMonth)\n\t\t{\n\t\t\tconst currentMonthName = this.#months[this.#currentMonthIndex].name;\n\t\t\tconst currentYear = this.#months[this.#currentMonthIndex].year;\n\t\t\tthis.#layout.currentMonth = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-title-day calendar-pub-ui__typography-title\">${currentMonthName}, ${currentYear}</div>\n\t\t\t`;\n\n\t\t\tEventEmitter.subscribe(this, 'updateCalendar', () => {\n\t\t\t\tconst currentMonthName = this.#months[this.#currentMonthIndex].name;\n\t\t\t\tconst currentYear = this.#months[this.#currentMonthIndex].year;\n\n\t\t\t\tthis.#layout.currentMonth.innerHTML = `${currentMonthName}, ${currentYear}`;\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.currentMonth;\n\t}\n\n\t#updateCalendar(direction)\n\t{\n\t\tDom.clean(this.#getNodeMonthWrapper());\n\t\tconst nodeMonth = this.#getNodeMonth();\n\n\t\tif (Type.isString(direction))\n\t\t{\n\t\t\tDom.addClass(nodeMonth, `--animate-${direction}`);\n\t\t\tnodeMonth.addEventListener('animationend', ()=> {\n\t\t\t\tDom.removeClass(nodeMonth, `--animate-${direction}`);\n\t\t\t}, { once: true });\n\t\t}\n\n\t\tDom.append(nodeMonth, this.#getNodeMonthWrapper());\n\t\tEventEmitter.emit(this, 'updateCalendar');\n\n\t\tif (this.#currentMonthIndex === 0)\n\t\t{\n\t\t\tDom.addClass(this.#layout.prevNav, '--disabled');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.#layout.prevNav, '--disabled');\n\t\t}\n\t}\n\n\t#getNodePrevNav(): HTMLElement\n\t{\n\t\tif (!this.#layout.prevNav)\n\t\t{\n\t\t\tthis.#layout.prevNav = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-nav_prev --disabled\" title=\"${Loc.getMessage('CALENDAR_SHARING_NAV_PREV')}\"></div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.prevNav, 'click', this.#handlePreviousMonthArrowClick.bind(this));\n\t\t}\n\n\t\treturn this.#layout.prevNav;\n\t}\n\n\t#getNodeNextNav(): HTMLElement\n\t{\n\t\tif (!this.#layout.nextNav)\n\t\t{\n\t\t\tthis.#layout.nextNav = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-nav_next\" title=\"${Loc.getMessage('CALENDAR_SHARING_NAV_NEXT')}\"></div>\n\t\t\t`;\n\t\t\tEvent.bind(this.#layout.nextNav, 'click', this.#handleNextMonthArrowClick.bind(this));\n\t\t}\n\n\t\treturn this.#layout.nextNav;\n\t}\n\n\t#getNodeNavigation(): HTMLElement\n\t{\n\t\tif (!this.#layout.navigation)\n\t\t{\n\t\t\tthis.#layout.navigation = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-nav\">\n\t\t\t\t\t${this.#getNodePrevNav()}\n\t\t\t\t\t${this.#getNodeNextNav()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.navigation;\n\t}\n\n\tasync #handleNextMonthArrowClick()\n\t{\n\t\tif (this.#currentMonthIndex === this.#months.length - 1)\n\t\t{\n\t\t\tawait this.#createNextMonth();\n\t\t}\n\n\t\tthis.#currentMonthIndex += 1;\n\t\tthis.#updateMonth(this.#currentMonthIndex);\n\n\t\tEventEmitter.emit(this, 'clickNextMonth');\n\t\tthis.#updateCalendar('next');\n\t\tthis.selectMonthDay();\n\t}\n\n\t#handlePreviousMonthArrowClick()\n\t{\n\t\tif (this.#currentMonthIndex === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#currentMonthIndex -= 1;\n\t\tthis.#updateMonth(this.#currentMonthIndex);\n\n\t\tEventEmitter.emit(this, 'clickPrevMonth');\n\t\tthis.#updateCalendar('prev');\n\t\tthis.selectMonthDay();\n\t}\n\n\t#updateMonth(monthIndex)\n\t{\n\t\tconst year = this.#months[monthIndex].year;\n\t\tconst month = this.#months[monthIndex].month;\n\t\tthis.#calculateDateTimeSlots(year, month);\n\n\t\tthis.#months[this.#currentMonthIndex] = this.#createMonth(year, month);\n\t}\n\n\t#getNodeBack(): HTMLElement\n\t{\n\t\tif (!this.#layout.back)\n\t\t{\n\t\t\tthis.#layout.back = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-back\"></div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.back, 'click', () => {\n\t\t\t\tEventEmitter.emit('hideSlotSelector', this);\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.back;\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar\">\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-bar\">\n\t\t\t\t\t\t${this.#getNodeBack()}\n\t\t\t\t\t\t${this.#getNodeCurrentMonth()}\n\t\t\t\t\t\t${this.#getNodeNavigation()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getNodeMonthWrapper()}\n\t\t\t\t\t${this.#getNodeTimezoneWrapper()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n}","import {EventEmitter} from \"main.core.events\";\nimport {Tag, Dom} from \"main.core\";\n\ntype BaseOptions = {\n\tisHiddenOnStart: boolean,\n};\nexport default class Base\n{\n\t#wrapNode;\n\t#isHiddenOnStart;\n\tconstructor(options: BaseOptions)\n\t{\n\t\tthis.#wrapNode = null;\n\t\tthis.#isHiddenOnStart = options.isHiddenOnStart;\n\t\tthis.#bindEvents();\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div></div>\n\t\t`;\n\t}\n\n\tgetType()\n\t{\n\t\treturn 'base';\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tDom.append(this.getContent(), this.#getWrapNode());\n\n\t\treturn this.#wrapNode;\n\t}\n\n\t#getWrapNode()\n\t{\n\t\tif (!this.#wrapNode)\n\t\t{\n\t\t\tthis.#wrapNode = Tag.render`<div class=\"calendar-pub__slots-wrap\"></div>`;\n\t\t\tif (this.#isHiddenOnStart)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#wrapNode, '--hidden');\n\t\t\t}\n\t\t}\n\n\t\treturn this.#wrapNode;\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('selectorTypeChange', (ev)=> {\n\t\t\tif (ev.data !== this.getType())\n\t\t\t{\n\t\t\t\tthis.#hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#show();\n\t\t\t}\n\t\t});\n\t}\n\n\t#hide()\n\t{\n\t\tDom.addClass(this.#wrapNode, '--hidden');\n\t}\n\n\t#show()\n\t{\n\t\tDom.removeClass(this.#wrapNode, '--hidden');\n\t}\n}","import {Tag} from \"main.core\";\nimport {DateTimeFormat} from \"main.date\";\nimport {Util} from \"calendar.util\";\n\n\ntype Data = {\n\tfrom: Date,\n\tto: Date,\n\ttimezone: string,\n}\n\nexport default class WidgetDate\n{\n\n\t#layout;\n\t#value;\n\tconstructor()\n\t{\n\t\tthis.#layout = {\n\t\t\tcalendarPage: {\n\t\t\t\tmonth: null,\n\t\t\t\tday: null,\n\t\t\t\ttimeFrom: null,\n\t\t\t},\n\t\t\tdayInfo: null,\n\t\t\ttimeInterval: null,\n\t\t\ttimezone: null,\n\t\t};\n\n\t\tthis.#value = {\n\t\t\tfrom: null,\n\t\t\tto: null,\n\t\t\ttimezone: null,\n\t\t};\n\t}\n\n\tupdateValue(data: Data)\n\t{\n\t\tif (data.from)\n\t\t{\n\t\t\tthis.#value.from = data.from;\n\t\t}\n\t\tif (data.to)\n\t\t{\n\t\t\tthis.#value.to = data.to;\n\t\t}\n\t\tif (data.timezone)\n\t\t{\n\t\t\tthis.#value.timezone = data.timezone;\n\t\t}\n\t\tthis.updateLayout();\n\t}\n\n\tupdateLayout()\n\t{\n\t\tconst timestampFrom = this.#value.from.getTime() / 1000;\n\n\t\tthis.#getNodeCalendarPageTimeFrom().innerText = DateTimeFormat.format(Util.getTimeFormatShort(), timestampFrom);\n\t\tthis.#getNodeCalendarPageMonth().innerText = DateTimeFormat.format('f', timestampFrom);\n\t\tthis.#getNodeCalendarPageDay().innerText = DateTimeFormat.format('d', timestampFrom);\n\n\t\tthis.#getNodeDayInfo().innerText = DateTimeFormat.format(Util.getDayOfWeekMonthFormat(), timestampFrom);\n\t\tthis.#getNodeTimeInterval().innerText = Util.formatTimeInterval(this.#value.from, this.#value.to);\n\t\tthis.#getNodeTimezone().innerText = Util.getFormattedTimezone(this.#value.timezone);\n\t\tthis.#getNodeTimezone().setAttribute('title', Util.getFormattedTimezone(this.#value.timezone));\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date\">\n\t\t\t\t\t<div class=\"calendar-pub__form-date-day\">\n\t\t\t\t\t\t${this.#getNodeCalendarPageMonth()}\n\t\t\t\t\t\t<div class=\"calendar-pub__form-date-content\">\n\t\t\t\t\t\t\t${this.#getNodeCalendarPageDay()}\n\t\t\t\t\t\t\t${this.#getNodeCalendarPageTimeFrom()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-pub__form-date-info\">\n\t\t\t\t\t\t${this.#getNodeDayInfo()}\n\t\t\t\t\t\t${this.#getNodeTimeInterval()}\n\t\t\t\t\t\t${this.#getNodeTimezone()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t}\n\n\t#getNodeCalendarPageMonth()\n\t{\n\t\tif (!this.#layout.calendarPage.month)\n\t\t{\n\t\t\tthis.#layout.calendarPage.month = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-day_month\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.calendarPage.month;\n\t}\n\n\t#getNodeCalendarPageDay()\n\t{\n\t\tif (!this.#layout.calendarPage.day)\n\t\t{\n\t\t\tthis.#layout.calendarPage.day = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-day_num\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.calendarPage.day;\n\t}\n\n\t#getNodeCalendarPageTimeFrom()\n\t{\n\t\tif (!this.#layout.calendarPage.timeFrom)\n\t\t{\n\t\t\tthis.#layout.calendarPage.timeFrom = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-day_time\">13:00</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.calendarPage.timeFrom;\n\t}\n\n\t#getNodeDayInfo()\n\t{\n\t\tif (!this.#layout.dayInfo)\n\t\t{\n\t\t\tthis.#layout.dayInfo = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-info_day\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.dayInfo;\n\t}\n\n\t#getNodeTimeInterval()\n\t{\n\t\tif (!this.#layout.timeInterval)\n\t\t{\n\t\t\tthis.#layout.timeInterval = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-info_time\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.timeInterval;\n\t}\n\n\t#getNodeTimezone()\n\t{\n\t\tif (!this.#layout.timezone)\n\t\t{\n\t\t\tthis.#layout.timezone = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-info_time-zone\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.timezone;\n\t}\n}","import { Tag, Loc, Event, Dom } from 'main.core';\nimport { EventEmitter } from \"main.core.events\";\nimport { DateTimeFormat } from \"main.date\";\nimport Base from '../base';\nimport { Util } from \"calendar.util\";\nimport WidgetDate from \"../widget-date\";\n\ntype FormOptions = {\n\tisHiddenOnStart: boolean,\n\towner: any,\n\tlink: any,\n\tsharingUser: any,\n\tisFromCrm: boolean,\n\thasContactData: boolean,\n\tisMailFeatureEnabled: boolean,\n\tisPhoneFeatureEnabled: boolean,\n}\n\ntype FormData = {\n\tfrom: Date,\n\tto: Date,\n\ttimezone: string,\n}\n\nexport default class Form extends Base\n{\n\t#layout;\n\t#value;\n\t#widgetDate;\n\t#owner;\n\t#link;\n\t#sharingUser;\n\t#phoneDb;\n\t#isFromCrm;\n\t#hasContactData;\n\t#isPhoneFeatureEnabled;\n\t#isMailFeatureEnabled;\n\t#inputData;\n\t#inputErrors;\n\n\tconstructor(options: FormOptions)\n\t{\n\t\tsuper({isHiddenOnStart: options.isHiddenOnStart});\n\t\tthis.#owner = options.owner;\n\t\tthis.#link = options.link;\n\t\tthis.#widgetDate = new WidgetDate();\n\t\tthis.#sharingUser = options.sharingUser;\n\t\tthis.#isFromCrm = options.isFromCrm;\n\t\tthis.#hasContactData = options.hasContactData;\n\t\tthis.#isPhoneFeatureEnabled = options.isPhoneFeatureEnabled;\n\t\tthis.#isMailFeatureEnabled = options.isMailFeatureEnabled;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tbuttonSend: null,\n\t\t\twidgetDate: null,\n\t\t\tformArea: null,\n\t\t\tback: null,\n\t\t\tcalendarPage: {\n\t\t\t\tmonth: null,\n\t\t\t\tday: null,\n\t\t\t\ttimeFrom: null,\n\t\t\t},\n\t\t\tdayInfo: null,\n\t\t\ttimeInterval: null,\n\t\t\ttimezone: null,\n\t\t\tinputs: {\n\t\t\t\tname: null,\n\t\t\t\tcontact: null,\n\t\t\t\tdescription: null,\n\t\t\t},\n\t\t};\n\t\tthis.#value = {\n\t\t\tfrom: null,\n\t\t\tto: null,\n\t\t\ttimezone: null,\n\t\t};\n\t\tthis.#inputData = {\n\t\t\tauthorName: '',\n\t\t\tcontactData: '',\n\t\t\tdescription: '',\n\t\t};\n\t\tthis.#inputErrors = {\n\t\t\tauthorNameEmpty: false,\n\t\t\tcontactDataEmpty: false,\n\t\t\tcontactDataIncorrect: false,\n\t\t};\n\t\tthis.#phoneDb = null;\n\t}\n\n\tcleanDescription()\n\t{\n\t\tthis.#getNodeInputDescription().value = null;\n\t\tthis.#inputData.description = '';\n\t}\n\n\tgetType()\n\t{\n\t\treturn 'form';\n\t}\n\n\tgetContent()\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n\n\tupdateFormValue(data: FormData)\n\t{\n\t\tif (data.from)\n\t\t{\n\t\t\tthis.#value.from = data.from;\n\t\t}\n\t\tif (data.to)\n\t\t{\n\t\t\tthis.#value.to = data.to;\n\t\t}\n\t\tif (data.timezone)\n\t\t{\n\t\t\tthis.#value.timezone = data.timezone;\n\t\t}\n\t\tthis.updateFormLayout();\n\t}\n\n\tupdateFormLayout()\n\t{\n\t\tthis.#widgetDate.updateValue(this.#value);\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form\">\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-bar\">\n\t\t\t\t\t\t${this.#getNodeBack()}\n\t\t\t\t\t\t<div class=\"calendar-sharing__calendar-title-day calendar-pub-ui__typography-title\">\n\t\t\t\t\t\t\t${this.#getEventName()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-block\">\n\t\t\t\t\t\t${this.#getNodeWidgetDate()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getNodeFormArea()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\t#getEventName()\n\t{\n\t\treturn Loc.getMessage('CALENDAR_SHARING_EVENT_NAME', {\n\t\t\t'#OWNER_NAME#' : this.#owner.name + ' ' + this.#owner.lastName,\n\t\t});\n\t}\n\n\t#getNodeButtonSend(): HTMLElement\n\t{\n\t\tif (!this.#layout.buttonSend)\n\t\t{\n\t\t\tthis.#layout.buttonSend = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__btn\">\n\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_CREATE_MEETING')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.buttonSend, 'click', () => this.#handleSaveButtonClick());\n\t\t}\n\n\t\treturn this.#layout.buttonSend;\n\t}\n\n\tasync #handleSaveButtonClick()\n\t{\n\t\tif (Dom.hasClass(this.#layout.buttonSend, '--wait'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.#layout.buttonSend, '--wait');\n\n\t\tthis.clearInputErrors();\n\t\tif (!this.#validateData())\n\t\t{\n\t\t\tDom.removeClass(this.#layout.buttonSend, '--wait');\n\t\t\treturn;\n\t\t}\n\n\t\tconst isSuccessful = await this.#saveEvent();\n\n\t\tif (isSuccessful)\n\t\t{\n\t\t\tEventEmitter.emit('selectorTypeChange', 'event', {\n\t\t\t\teventName: this.#getEventName(),\n\t\t\t\tfrom: this.#value.from,\n\t\t\t\tto: this.#value.to,\n\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t});\n\t\t}\n\n\t\tDom.removeClass(this.#layout.buttonSend, '--wait');\n\t}\n\n\tasync #saveEvent(): boolean\n\t{\n\t\tlet response = null;\n\t\ttry\n\t\t{\n\t\t\tif (this.#isFromCrm)\n\t\t\t{\n\t\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.saveCrmEvent', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\townerCreated: this.#sharingUser.ownerCreated,\n\t\t\t\t\t\townerId: this.#owner.id,\n\t\t\t\t\t\tdateFrom: this.#parseDate(this.#value.from),\n\t\t\t\t\t\tdateTo: this.#parseDate(this.#value.to),\n\t\t\t\t\t\tuserName: this.#inputData.authorName,\n\t\t\t\t\t\tuserContact: this.#inputData.contactData,\n\t\t\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t\t\t\tcrmDealLinkHash: this.#link.hash,\n\t\t\t\t\t\tdescription: this.#inputData.description,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.saveEvent', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\townerCreated: this.#sharingUser.ownerCreated,\n\t\t\t\t\t\townerId: this.#owner.id,\n\t\t\t\t\t\tuserName: this.#inputData.authorName,\n\t\t\t\t\t\tuserContact: this.#inputData.contactData,\n\t\t\t\t\t\tdateFrom: this.#parseDate(this.#value.from),\n\t\t\t\t\t\tdateTo: this.#parseDate(this.#value.to),\n\t\t\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t\t\t\tparentLinkHash: this.#link.hash,\n\t\t\t\t\t\tdescription: this.#inputData.description,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tresponse = e;\n\t\t}\n\n\t\tif (response.errors.length === 0)\n\t\t{\n\t\t\tEventEmitter.emit('onSaveEvent', {\n\t\t\t\teventName: this.#getEventName(),\n\t\t\t\tfrom: this.#value.from,\n\t\t\t\tto: this.#value.to,\n\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t\teventId: response.data.eventId,\n\t\t\t\teventLinkId: response.data.eventLinkId,\n\t\t\t\teventLinkHash: response.data.eventLinkHash,\n\t\t\t\teventLinkShortUrl: response.data.eventLinkShortUrl,\n\t\t\t\tuserName: this.#inputData.authorName,\n\t\t\t\tstate: 'created',\n\t\t\t\tisView: false,\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\n\t\tif (response?.data?.contactDataError || response?.data?.isEmptyContactName)\n\t\t{\n\t\t\tthis.#inputErrors.contactDataIncorrect = response.data.contactDataError === true;\n\t\t\tthis.#inputErrors.authorNameEmpty = response.data.isEmptyContactName === true;\n\t\t\tthis.#renderInputErrors();\n\n\t\t\treturn false;\n\t\t}\n\n\t\tEventEmitter.emit('onSaveEvent', {\n\t\t\teventName: this.#getEventName(),\n\t\t\tfrom: this.#value.from,\n\t\t\tto: this.#value.to,\n\t\t\ttimezone: this.#value.timezone,\n\t\t\tstate: 'not-created',\n\t\t\tisView: false,\n\t\t});\n\n\t\treturn false;\n\t}\n\n\t#parseDate(date): string\n\t{\n\t\tconst dateInFormat = DateTimeFormat.format(Util.getDateFormat(), date.getTime() / 1000);\n\t\tconst timeInFormat = DateTimeFormat.format(Util.getTimeFormat(), date.getTime() / 1000);\n\t\treturn dateInFormat + ' ' + timeInFormat;\n\t}\n\n\t#validateData(): boolean\n\t{\n\t\tif (this.#isCrmAndHasContact())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.#inputData.authorName.length === 0)\n\t\t{\n\t\t\tthis.#inputErrors.authorNameEmpty = true;\n\t\t}\n\t\tif (this.#inputData.contactData.length === 0)\n\t\t{\n\t\t\tthis.#inputErrors.contactDataEmpty = true;\n\t\t}\n\t\tif (!this.#inputErrors.contactDataEmpty)\n\t\t{\n\t\t\tthis.#inputErrors.contactDataIncorrect = !this.#validatePhone() && !this.#validateEmail();\n\t\t}\n\t\tthis.#renderInputErrors();\n\n\t\treturn !this.#inputErrors.authorNameEmpty && !this.#inputErrors.contactDataEmpty && !this.#inputErrors.contactDataIncorrect;\n\t}\n\n\t#validatePhone(): boolean\n\t{\n\t\tif (this.#isMailContactOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst phone = this.#inputData.contactData.replace(/[()\\s\\-]+/g, '');\n\t\tconst match = phone.match(/(^\\+?\\d{4,25}$)/i);\n\t\treturn match?.[0] === phone;\n\t}\n\n\t#validateEmail(): boolean\n\t{\n\t\tif (this.#isPhoneContactOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst match = this.#inputData.contactData.match(/(^[^@]+@.+$)/i);\n\t\treturn match?.[0] === this.#inputData.contactData;\n\t}\n\n\tclearInputErrors()\n\t{\n\t\tthis.#clearContactNameError();\n\t\tthis.#clearContactDataError();\n\t}\n\n\t#clearContactDataError()\n\t{\n\t\tthis.#inputErrors.contactDataEmpty = false;\n\t\tthis.#inputErrors.contactDataIncorrect = false;\n\t\tthis.#renderInputErrors();\n\t}\n\n\t#clearContactNameError()\n\t{\n\t\tthis.#inputErrors.authorNameEmpty = false;\n\t\tthis.#renderInputErrors();\n\t}\n\n\t#showFullContactPlaceholder(): boolean\n\t{\n\t\treturn !this.#isMailContactOnly() && !this.#isPhoneContactOnly();\n\t}\n\n\t#isMailContactOnly(): boolean\n\t{\n\t\treturn !this.#isPhoneFeatureEnabled && this.#isMailFeatureEnabled;\n\t}\n\n\t#isPhoneContactOnly(): boolean\n\t{\n\t\treturn this.#isPhoneFeatureEnabled && !this.#isMailFeatureEnabled;\n\t}\n\n\t#isCrmAndHasContact(): boolean\n\t{\n\t\treturn this.#isFromCrm && this.#hasContactData;\n\t}\n\n\t#getNodeWidgetDate(): HTMLElement\n\t{\n\t\tif (!this.#layout.widgetDate)\n\t\t{\n\t\t\tthis.#layout.widgetDate = this.#widgetDate.render();\n\t\t}\n\n\t\treturn this.#layout.widgetDate;\n\t}\n\n\t#getNodeFormArea(): HTMLElement\n\t{\n\t\tif (!this.#layout.formArea)\n\t\t{\n\t\t\tthis.#layout.nameInputError = this.#getNodeInputError();\n\t\t\tthis.#layout.contactInputError = this.#getNodeInputError();\n\n\t\t\tthis.#layout.formArea = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form\">\n\t\t\t\t\t<div class=\"calendar-sharing__form-area\">\n\t\t\t\t\t\t<div class=\"calendar-sharing__form-input\">\n\t\t\t\t\t\t\t${this.#getNodeInputName()}\n\t\t\t\t\t\t\t<div class=\"calendar-sharing__form-input-title\">${Loc.getMessage('CALENDAR_SHARING_FORM_INPUT_NAME')}<span>*</span></div>\n\t\t\t\t\t\t\t${this.#layout.nameInputError}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-sharing__form-input\">\n\t\t\t\t\t\t\t${this.#getNodeInputContact()}\n\t\t\t\t\t\t\t<div class=\"calendar-sharing__form-input-title\">${this.#getContactDataPlaceholder()}<span>*</span></div>\n\t\t\t\t\t\t\t${this.#layout.contactInputError}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-sharing__form-input\">\n\t\t\t\t\t\t\t${this.#getNodeInputDescription()}\n\t\t\t\t\t\t\t<div class=\"calendar-sharing__form-input-title\">${Loc.getMessage('CALENDAR_SHARING_FORM_INPUT_INFO')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-pub__welcome-bottom\">\n\t\t\t\t\t\t${this.#getNodeButtonSend()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.formArea;\n\t}\n\n\t#getContactDataPlaceholder(): string\n\t{\n\t\tlet messageCode = 'CALENDAR_SHARING_AUTHOR_CONTACT_DATA_PLACEHOLDER_PHONE_FEATURE_ENABLED';\n\t\tif (this.#isMailContactOnly())\n\t\t{\n\t\t\tmessageCode = 'CALENDAR_SHARING_AUTHOR_CONTACT_DATA_PLACEHOLDER_PHONE_FEATURE_DISABLED';\n\t\t}\n\t\tif (this.#isPhoneContactOnly())\n\t\t{\n\t\t\tmessageCode = 'CALENDAR_SHARING_AUTHOR_CONTACT_DATA_PLACEHOLDER_MAIL_FEATURE_DISABLED';\n\t\t}\n\n\t\treturn Loc.getMessage(messageCode);\n\t}\n\n\t#getNodeInputName()\n\t{\n\t\tif (!this.#layout.inputs.name)\n\t\t{\n\t\t\tthis.#layout.inputs.name = Tag.render`\n\t\t\t\t<input type=\"text\" placeholder=\" \" class=\"calendar-sharing__form-input-area\">\n\t\t\t`;\n\t\t\tif (this.#hasContactData)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.inputs.name, '--hidden');\n\t\t\t}\n\t\t\telse if (this.#sharingUser?.userName)\n\t\t\t{\n\t\t\t\tthis.#layout.inputs.name.value = this.#sharingUser?.userName;\n\t\t\t}\n\n\t\t\tthis.#inputData.authorName = this.#layout.inputs.name.value;\n\t\t\tEvent.bind(this.#layout.inputs.name, 'input', () => {\n\t\t\t\tthis.#inputData.authorName = this.#layout.inputs.name.value;\n\t\t\t});\n\n\t\t\tEvent.bind(this.#layout.inputs.name, 'focus', this.#clearContactNameError.bind(this));\n\t\t}\n\n\t\treturn this.#layout.inputs.name;\n\t}\n\n\t#getNodeInputContact()\n\t{\n\t\tif (!this.#layout.inputs.contact)\n\t\t{\n\t\t\tthis.#layout.inputs.contact = Tag.render`\n\t\t\t\t<input type=\"text\" placeholder=\" \" class=\"calendar-sharing__form-input-area\">\n\t\t\t`;\n\n\t\t\tif(this.#isMailContactOnly())\n\t\t\t{\n\t\t\t\tthis.#layout.inputs.contact.inputMode = 'email';\n\t\t\t}\n\n\t\t\tif(this.#isPhoneContactOnly())\n\t\t\t{\n\t\t\t\tthis.#layout.inputs.contact.inputMode = 'tel';\n\t\t\t}\n\n\t\t\tif (this.#hasContactData)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.inputs.contact, '--hidden');\n\t\t\t}\n\t\t\telse if (this.#sharingUser)\n\t\t\t{\n\t\t\t\tif (this.#isMailFeatureEnabled && this.#sharingUser.personalMailbox)\n\t\t\t\t{\n\t\t\t\t\tthis.#layout.inputs.contact.value = this.#sharingUser?.personalMailbox;\n\t\t\t\t}\n\t\t\t\telse if (this.#isPhoneFeatureEnabled && this.#sharingUser.personalPhone)\n\t\t\t\t{\n\t\t\t\t\tthis.#layout.inputs.contact.value = this.#sharingUser?.personalPhone;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.#inputData.contactData = this.#layout.inputs.contact.value;\n\t\t\tEvent.bind(this.#layout.inputs.contact, 'input', (event) => {\n\t\t\t\tthis.#inputData.contactData = this.#layout.inputs.contact.value;\n\t\t\t\tthis.#onPhoneInput(event);\n\t\t\t});\n\n\t\t\tEvent.bind(this.#layout.inputs.contact, 'keydown', this.#onPhoneInputKeyDown.bind(this));\n\t\t\tEvent.bind(this.#layout.inputs.contact, 'focus', this.#clearContactDataError.bind(this));\n\t\t}\n\n\t\treturn this.#layout.inputs.contact;\n\t}\n\n\t#getNodeInputDescription()\n\t{\n\t\tif (!this.#layout.inputs.description)\n\t\t{\n\t\t\tthis.#layout.inputs.description = Tag.render`\n\t\t\t\t<textarea type=\"text\" placeholder=\" \" class=\"calendar-sharing__form-input-area --textarea\"></textarea>\n\t\t\t`;\n\t\t\tthis.#inputData.description = this.#layout.inputs.description.value;\n\t\t\tEvent.bind(this.#layout.inputs.description, 'input', () => {\n\t\t\t\tthis.#inputData.description = this.#layout.inputs.description.value;\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.inputs.description;\n\t}\n\n\t#getNodeInputError()\n\t{\n\t\treturn Tag.render`\n\t\t\t<span class=\"calendar-sharing__form-input-error\"></span>\n\t\t`;\n\t}\n\n\t#renderInputErrors()\n\t{\n\t\tDom.removeClass(this.#layout.inputs.name.parentNode, '--error');\n\t\tDom.removeClass(this.#layout.inputs.contact.parentNode, '--error');\n\t\tif (this.#inputErrors.authorNameEmpty)\n\t\t{\n\t\t\tDom.addClass(this.#layout.inputs.name.parentNode, '--error');\n\t\t\tthis.#layout.nameInputError.innerText = Loc.getMessage('CALENDAR_SHARING_INPUT_ERROR_REQUIRED');\n\t\t}\n\t\tif (this.#inputErrors.contactDataEmpty)\n\t\t{\n\t\t\tDom.addClass(this.#layout.inputs.contact.parentNode, '--error');\n\t\t\tthis.#layout.contactInputError.innerText = Loc.getMessage('CALENDAR_SHARING_INPUT_ERROR_REQUIRED');\n\t\t}\n\t\tif (this.#inputErrors.contactDataIncorrect)\n\t\t{\n\t\t\tDom.addClass(this.#layout.inputs.contact.parentNode, '--error');\n\t\t\tthis.#layout.contactInputError.innerText = Loc.getMessage('CALENDAR_SHARING_INPUT_ERROR_INCORRECT');\n\t\t}\n\t}\n\n\t#getNodeBack(): HTMLElement\n\t{\n\t\tif (!this.#layout.back)\n\t\t{\n\t\t\tthis.#layout.back = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-back\"></div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.back, 'click', ()=> {\n\t\t\t\tEventEmitter.emit('selectorTypeChange', 'slot-list');\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.back;\n\t}\n\n\t//phone input\n\t#onPhoneInput()\n\t{\n\t\tthis.#clearContactDataError();\n\t\tif (!this.#isPhoneTypeInput())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst textBeforeCursor = this.#getTextBeforeCursor(this.#layout.inputs.contact);\n\n\t\tthis.#inputData.contactData = this.#formatPhone(this.#inputData.contactData);\n\t\tthis.#layout.inputs.contact.value = this.#inputData.contactData;\n\n\t\tthis.#setCursorToFormattedPosition(this.#layout.inputs.contact, textBeforeCursor);\n\t}\n\n\t#getTextBeforeCursor(input)\n\t{\n\t\tconst selectionStart = input.selectionStart;\n\t\treturn input.value.slice(0, selectionStart);\n\t}\n\n\t#setCursorToFormattedPosition(input, textBeforeCursor)\n\t{\n\t\tconst firstPart = this.#getTextEscapedForRegex(textBeforeCursor.slice(0, -1));\n\t\tconst lastCharacter = this.#getTextEscapedForRegex(textBeforeCursor.slice(-1));\n\t\tconst matches = input.value.match(`${firstPart}.*?${lastCharacter}`);\n\t\tif (!matches)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst match = matches[0];\n\t\tconst formattedPosition = input.value.indexOf(match) + match.length;\n\t\tinput.setSelectionRange(formattedPosition, formattedPosition);\n\t}\n\n\t#getTextEscapedForRegex(text)\n\t{\n\t\treturn text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\t}\n\n\t#onPhoneInputKeyDown(e)\n\t{\n\t\tif (!this.#isPhoneTypeInput())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#isDigit(e.key) && !this.#isControlKey(e.key) && !Util.isAnyModifierKeyPressed(e))\n\t\t{\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\t#isPhoneTypeInput(): boolean\n\t{\n\t\treturn this.#isPhoneContactOnly() || this.#showFullContactPlaceholder() && this.contactData.slice(0, 1) === '+';\n\t}\n\n\t#isDigit(key): boolean\n\t{\n\t\treturn /^\\d+$/.test(key);\n\t}\n\n\t#isControlKey(key): boolean\n\t{\n\t\treturn ['Esc', 'Delete', 'Backspace', 'Tab'].indexOf(key) >= 0 || key.includes('Arrow');\n\t}\n\n\t#formatPhone(value): string\n\t{\n\t\tvalue ??= '';\n\n\t\tlet hasPlus = value.indexOf('+') === 0;\n\t\tvalue = value.replace(/\\D/g, '');\n\n\t\tif (!hasPlus && value.substr(0, 1) === '8')\n\t\t{\n\t\t\tvalue = '7' + value.substr(1);\n\t\t}\n\n\t\tif (!this.#phoneDb)\n\t\t{\n\t\t\tthis.#phoneDb = \"247,ac,___-____|376,ad,___-___-___|971,ae,___-_-___-____|93,af,__-__-___-____|1268,ag,_ (___) ___-____|1264,ai,_ (___) ___-____|355,al,___ (___) ___-___|374,am,___-__-___-___|599,bq,___-___-____|244,ao,___ (___) ___-___|6721,aq,___-___-___|54,ar,__ (___) ___-____|1684,as,_ (___) ___-____|43,at,__ (___) ___-____|61,au,__-_-____-____|297,aw,___-___-____|994,az,___ (__) ___-__-__|387,ba,___-__-____|1246,bb,_ (___) ___-____|880,bd,___-__-___-___|32,be,__ (___) ___-___|226,bf,___-__-__-____|359,bg,___ (___) ___-___|973,bh,___-____-____|257,bi,___-__-__-____|229,bj,___-__-__-____|1441,bm,_ (___) ___-____|673,bn,___-___-____|591,bo,___-_-___-____|55,br,__-(__)-____-____|1242,bs,_ (___) ___-____|975,bt,___-_-___-___|267,bw,___-__-___-___|375,by,___ (__) ___-__-__|501,bz,___-___-____|243,cd,___ (___) ___-___|236,cf,___-__-__-____|242,cg,___-__-___-____|41,ch,__-__-___-____|225,ci,___-__-___-___|682,ck,___-__-___|56,cl,__-_-____-____|237,cm,___-____-____|86,cn,__ (___) ____-___|57,co,__ (___) ___-____|506,cr,___-____-____|53,cu,__-_-___-____|238,cv,___ (___) __-__|357,cy,___-__-___-___|420,cz,___ (___) ___-___|49,de,__-___-___|253,dj,___-__-__-__-__|45,dk,__-__-__-__-__|1767,dm,_ (___) ___-____|1809,do,_ (___) ___-____|,do,_ (___) ___-____|213,dz,___-__-___-____|593,ec,___-_-___-____|372,ee,___-___-____|20,eg,__ (___) ___-____|291,er,___-_-___-___|34,es,__ (___) ___-___|251,et,___-__-___-____|358,fi,___ (___) ___-__-__|679,fj,___-__-_____|500,fk,___-_____|691,fm,___-___-____|298,fo,___-___-___|262,fr,___-_____-____|33,fr,__ (___) ___-___|508,fr,___-__-____|590,fr,___ (___) ___-___|241,ga,___-_-__-__-__|1473,gd,_ (___) ___-____|995,ge,___ (___) ___-___|594,gf,___-_____-____|233,gh,___ (___) ___-___|350,gi,___-___-_____|299,gl,___-__-__-__|220,gm,___ (___) __-__|224,gn,___-__-___-___|240,gq,___-__-___-____|30,gr,__ (___) ___-____|502,gt,___-_-___-____|1671,gu,_ (___) ___-____|245,gw,___-_-______|592,gy,___-___-____|852,hk,___-____-____|504,hn,___-____-____|385,hr,___-__-___-___|509,ht,___-__-__-____|36,hu,__ (___) ___-___|62,id,__-__-___-__|353,ie,___ (___) ___-___|972,il,___-_-___-____|91,in,__ (____) ___-___|246,io,___-___-____|964,iq,___ (___) ___-____|98,ir,__ (___) ___-____|354,is,___-___-____|39,it,__ (___) ____-___|1876,jm,_ (___) ___-____|962,jo,___-_-____-____|81,jp,__ (___) ___-___|254,ke,___-___-______|996,kg,___ (___) ___-___|855,kh,___ (__) ___-___|686,ki,___-__-___|269,km,___-__-_____|1869,kn,_ (___) ___-____|850,kp,___-___-___|82,kr,__-__-___-____|965,kw,___-____-____|1345,ky,_ (___) ___-____|77,kz,_ (___) ___-__-__|856,la,___-__-___-___|961,lb,___-_-___-___|1758,lc,_ (___) ___-____|423,li,___ (___) ___-____|94,lk,__-__-___-____|231,lr,___-__-___-___|266,ls,___-_-___-____|370,lt,___ (___) __-___|352,lu,___ (___) ___-___|371,lv,___-__-___-___|218,ly,___-__-___-___|212,ma,___-__-____-___|377,mc,___-__-___-___|373,md,___-____-____|382,me,___-__-___-___|261,mg,___-__-__-_____|692,mh,___-___-____|389,mk,___-__-___-___|223,ml,___-__-__-____|95,mm,__-___-___|976,mn,___-__-__-____|853,mo,___-____-____|1670,mp,_ (___) ___-____|596,mq,___ (___) __-__-__|222,mr,___ (__) __-____|1664,ms,_ (___) ___-____|356,mt,___-____-____|230,mu,___-___-____|960,mv,___-___-____|265,mw,___-_-____-____|52,mx,__-__-__-____|60,my,__-_-___-___|258,mz,___-__-___-___|264,na,___-__-___-____|687,nc,___-__-____|227,ne,___-__-__-____|6723,nf,___-___-___|234,ng,___-__-___-__|505,ni,___-____-____|31,nl,__-__-___-____|47,no,__ (___) __-___|977,np,___-__-___-___|674,nr,___-___-____|683,nu,___-____|64,nz,__-__-___-___|968,om,___-__-___-___|507,pa,___-___-____|51,pe,__ (___) ___-___|689,pf,___-__-__-__|675,pg,___ (___) __-___|63,ph,__ (___) ___-____|92,pk,__ (___) ___-____|48,pl,__ (___) ___-___|970,ps,___-__-___-____|351,pt,___-__-___-____|680,pw,___-___-____|595,py,___ (___) ___-___|974,qa,___-____-____|40,ro,__-__-___-____|381,rs,___-__-___-____|7,ru,_ (___) ___-__-__|250,rw,___ (___) ___-___|966,sa,___-_-___-____|677,sb,___-_____|248,sc,___-_-___-___|249,sd,___-__-___-____|46,se,__-__-___-____|65,sg,__-____-____|386,si,___-__-___-___|421,sk,___ (___) ___-___|232,sl,___-__-______|378,sm,___-____-______|221,sn,___-__-___-____|252,so,___-_-___-___|597,sr,___-___-___|211,ss,___-__-___-____|239,st,___-__-_____|503,sv,___-__-__-____|1721,sx,_ (___) ___-____|963,sy,___-__-____-___|268,sz,___ (__) __-____|1649,tc,_ (___) ___-____|235,td,___-__-__-__-__|228,tg,___-__-___-___|66,th,__-__-___-___|992,tj,___-__-___-____|690,tk,___-____|670,tl,___-___-____|993,tm,___-_-___-____|216,tn,___-__-___-___|676,to,___-_____|90,tr,__ (___) ___-____|1868,tt,_ (___) ___-____|688,tv,___-_____|886,tw,___-____-____|255,tz,___-__-___-____|380,ua,___ (__) ___-__-__|256,ug,___ (___) ___-___|44,gb,__-__-____-____|598,uy,___-_-___-__-__|998,uz,___-__-___-____|396698,va,__-_-___-_____|1784,vc,_ (___) ___-____|58,ve,__ (___) ___-____|1284,vg,_ (___) ___-____|1340,vi,_ (___) ___-____|84,vn,__-__-____-___|678,vu,___-_____|681,wf,___-__-____|685,ws,___-__-____|967,ye,___-_-___-___|27,za,__-__-___-____|260,zm,___ (__) ___-____|263,zw,___-_-______|1,us,_ (___) ___-____|\"\n\t\t\t\t.split('|')\n\t\t\t\t.map(item => {\n\t\t\t\t\titem = item.split(',');\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcode: item[0],\n\t\t\t\t\t\tid: item[1],\n\t\t\t\t\t\tmask: item[2],\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t}\n\n\t\tif (value.length > 0)\n\t\t{\n\t\t\tlet mask = this.#findMask(value);\n\t\t\tmask += ((mask.indexOf('-') >= 0 ? '-' : ' ') + '__').repeat(10);\n\t\t\tfor (let i = 0; i < value.length; i++)\n\t\t\t{\n\t\t\t\tmask = mask.replace('_', value.slice(i, i + 1));\n\t\t\t}\n\t\t\tvalue = mask.replace(/\\D+$/,'').replace(/_/g, '0');\n\t\t}\n\n\t\tif (hasPlus || value.length > 0)\n\t\t{\n\t\t\tvalue = '+' + value;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\t#findMask(value)\n\t{\n\t\tlet r = this.#phoneDb.filter(item => {\n\t\t\treturn value.indexOf(item.code) === 0;\n\t\t}).sort((a, b) => {\n\t\t\treturn b.code.length - a.code.length;\n\t\t})[0];\n\t\treturn r ? r.mask : '_ ___ __ __ __';\n\t}\n}","import {Loc, Tag} from \"main.core\";\nimport Base from '../base';\n\ntype EmptyStateOptions = {\n\tisHiddenOnStart: boolean,\n};\n\nexport default class EmptyState extends Base\n{\n\t#layout;\n\n\tconstructor(options)\n\t{\n\t\tsuper({isHiddenOnStart: options.isHiddenOnStart});\n\t\tthis.#layout = {\n\t\t\tcontent: null,\n\t\t}\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\n\t}\n\n\tgetType()\n\t{\n\t\treturn 'empty-state';\n\t}\n\n\tgetContent()\n\t{\n\t\treturn this.#getNodeEmptyState();\n\t}\n\n\t#getNodeEmptyState(): HTMLElement\n\t{\n\t\tif (!this.#layout.content)\n\t\t{\n\t\t\tthis.#layout.content = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__slots-empty\">\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_title\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_EMPTY')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_info\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_EMPTY_INFO')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.content;\n\t}\n}","import {Loc, Tag} from \"main.core\";\nimport Base from '../base';\n\ntype AccessDeniedOptions = {\n\tisHiddenOnStart: boolean,\n};\n\nexport default class AccessDenied extends Base\n{\n\t#layout;\n\n\tconstructor(options)\n\t{\n\t\tsuper({isHiddenOnStart: options.isHiddenOnStart});\n\t\tthis.#layout = {\n\t\t\tcontent: null,\n\t\t}\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\n\t}\n\n\tgetType()\n\t{\n\t\treturn 'access-denied';\n\t}\n\n\tgetContent()\n\t{\n\t\treturn this.#getNodeEmptyState();\n\t}\n\n\t#getNodeEmptyState(): HTMLElement\n\t{\n\t\tif (!this.#layout.content)\n\t\t{\n\t\t\tthis.#layout.content = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__slots-empty --icon-cross\">\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_title\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_info\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED_INFO')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.content;\n\t}\n}","import { Tag, Loc, Event, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Util } from 'calendar.util';\n\ntype SlotItemOptions = {\n\tvalue: {\n\t\tfrom: Date,\n\t\tto: Date,\n\t},\n}\n\nexport default class SlotItem\n{\n\t#layout;\n\t#selected;\n\t#value;\n\tBUTTON_MAX_WIDTH = 123;\n\n\tconstructor(options: SlotItemOptions)\n\t{\n\t\tthis.#selected = null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tvalue: null,\n\t\t\tselect: null\n\t\t};\n\t\tthis.#value = options.value;\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEvent.bind(this.#getNodeWrapper(), 'click', this.select.bind(this));\n\t\tEvent.bind(this.#getNodeSelect(), 'click', this.showForm.bind(this));\n\t}\n\n\tisSelected()\n\t{\n\t\treturn this.#selected;\n\t}\n\n\tselect()\n\t{\n\t\tthis.#selected = true;\n\t\tDom.addClass(this.#getNodeWrapper(), '--selected');\n\t\tEventEmitter.emit('selectSlot', this);\n\t}\n\n\tunSelect()\n\t{\n\t\tthis.#selected = null;\n\t\tDom.removeClass(this.#getNodeWrapper(), '--selected');\n\t}\n\n\tshowForm()\n\t{\n\t\tEventEmitter.emit('confirmedSelectSlot', {value: this.#value});\n\t}\n\n\t#getNodeSelect(): HTMLElement\n\t{\n\t\tif (!this.#layout.select)\n\t\t{\n\t\t\tthis.#layout.select = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__slot-select\">${Loc.getMessage('CALENDAR_SHARING_SELECT_SLOT')}</div>\n\t\t\t`;\n\n\t\t\tdocument.body.append(this.#layout.select);\n\t\t\tif (this.#layout.select.offsetWidth > this.BUTTON_MAX_WIDTH)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.select, '--compact');\n\t\t\t}\n\t\t\tthis.#layout.select.remove();\n\t\t}\n\n\t\treturn this.#layout.select;\n\t}\n\n\t#getNodeValue(): HTMLElement\n\t{\n\t\tif (!this.#layout.value)\n\t\t{\n\t\t\tlet value = Util.formatTimeInterval(this.#value.from, this.#value.to);\n\t\t\tvalue = value.replace(/(am|pm)/g, `<span class=\"calendar-sharing-am-pm\">$1</span>`)\n\n\t\t\tthis.#layout.value = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__slot-value\">${value}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.value;\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__slot-item\">\n\t\t\t\t\t${this.#getNodeValue()}\n\t\t\t\t\t${this.#getNodeSelect()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n}","import {Dom, Loc, Tag} from \"main.core\";\nimport SlotItem from \"./slot-item\";\nimport {EventEmitter} from \"main.core.events\";\nimport Base from '../base';\n\ntype SlotListOptions = {\n\tisHiddenOnStart: boolean,\n}\nexport default class SlotList extends Base\n{\n\t#layout;\n\t#slots;\n\t#selectedSlot;\n\tconstructor(options: SlotListOptions)\n\t{\n\t\tsuper({isHiddenOnStart: options.isHiddenOnStart});\n\t\tthis.#layout = {\n\t\t\ttitle: null,\n\t\t\tlist: null,\n\t\t}\n\t\tthis.#slots = [];\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('updateSlotsList', (event) => {\n\t\t\tthis.#slots = event.data.slots;\n\t\t\tthis.updateSlotsList();\n\t\t});\n\t\tEventEmitter.subscribe('selectSlot', (event)=> {\n\t\t\tconst newSelectedSlot = event.data;\n\t\t\tif (this.#selectedSlot !== newSelectedSlot)\n\t\t\t{\n\t\t\t\tthis.#selectedSlot?.unSelect();\n\t\t\t}\n\n\t\t\tthis.#selectedSlot = newSelectedSlot;\n\t\t});\n\t}\n\n\tgetType()\n\t{\n\t\treturn 'slot-list';\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn this.#getNodeSlotList();\n\t}\n\n\tupdateSlotsList()\n\t{\n\t\tDom.clean(this.#getNodeList());\n\n\t\tconst slotListNode = this.#getNodeListItems();\n\n\t\tDom.append(slotListNode, this.#getNodeList());\n\t\tDom.removeClass(this.#getNodeList(), '--shadow-top');\n\t\tDom.removeClass(this.#getNodeList(), '--shadow-bottom');\n\t}\n\n\t#getNodeSlotList(): HTMLElement\n\t{\n\t\tif (!this.#layout.slotSelector)\n\t\t{\n\t\t\tthis.#layout.slotSelector = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__slot-list-wrap\">\n\t\t\t\t\t${this.#getNodeTitle()}\n\t\t\t\t\t${this.#getNodeList()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.slotSelector;\n\t}\n\n\t#getNodeTitle(): HTMLElement\n\t{\n\t\tif (!this.#layout.title)\n\t\t{\n\t\t\tthis.#layout.title = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-bar\">\n\t\t\t\t\t<div class=\"calendar-pub-ui__typography-m\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_FREE')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.title;\n\t}\n\n\t#getNodeList(): HTMLElement\n\t{\n\t\tif (!this.#layout.slots)\n\t\t{\n\t\t\tthis.#layout.slots = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --overflow-hidden --shadow\">\n\t\t\t\t\t${this.#getNodeListItems()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.slots;\n\t}\n\n\t#getNodeListItems(): HTMLElement\n\t{\n\t\tconst currentDaySlots = this.#slots\n\t\t\t.map(slot => new SlotItem({\n\t\t\t\tvalue: {\n\t\t\t\t\tfrom: slot.timeFrom,\n\t\t\t\t\tto: slot.timeTo,\n\t\t\t\t}\n\t\t\t}));\n\n\t\tconst result = Tag.render`\n\t\t\t<div class=\"calendar-sharing__slots\">\n\t\t\t\t${currentDaySlots.map(slotItem => slotItem.render())}\n\t\t\t</div>\n\t\t`;\n\n\t\tresult.addEventListener('scroll', ()=> {\n\t\t\tif (result.scrollTop > 0)\n\t\t\t{\n\t\t\t\tthis.#getNodeList().classList.add('--shadow-top');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#getNodeList().classList.remove('--shadow-top');\n\t\t\t}\n\n\t\t\tif (result.scrollHeight > result.offsetHeight\n\t\t\t\t&& Math.ceil(result.offsetHeight + result.scrollTop) < result.scrollHeight)\n\t\t\t{\n\t\t\t\tthis.#getNodeList().classList.add('--shadow-bottom');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#getNodeList().classList.remove('--shadow-bottom');\n\t\t\t}\n\t\t});\n\n\t\tsetTimeout(()=> {\n\t\t\tif (result.scrollHeight > result.offsetHeight)\n\t\t\t{\n\t\t\t\tthis.#getNodeList().classList.add('--shadow-bottom');\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n}","import Base from \"../base\";\nimport { Util } from \"calendar.util\";\nimport {Dom, Loc, Tag, Browser, Text} from \"main.core\";\nimport {Popup} from \"main.popup\";\nimport WidgetDate from \"../widget-date\";\nimport {EventEmitter} from \"main.core.events\";\nimport {DateTimeFormat} from \"main.date\";\nimport {BottomSheet} from \"ui.bottomsheet\";\n\n\ntype State = 'created' | 'not-created' | 'declined' ;\n\ntype EventData = {\n\tfrom: Date,\n\tto: Date,\n\ttimezone: string,\n\teventLinkHash: string,\n\teventName: string,\n\tstate: State,\n\tisView: boolean,\n\teventId: boolean,\n\tuserName: string,\n}\n\ntype EventOptions = {\n\tisHiddenOnStart: boolean,\n\towner: any,\n\tevent: any,\n\teventLinkHash: any,\n\tstate: State,\n\tisView: boolean,\n\teventId: number,\n\ttimezone: string,\n\tinDeletedSlider: boolean,\n\taction: string,\n\tcanceledByManager: boolean,\n\tshowBackCalendarButtons: boolean,\n};\n\n\nexport default class Event extends Base\n{\n\t#event;\n\t#owner;\n\t#currentTimezone;\n\t#icsFile;\n\t#widgetDate;\n\t#layout;\n\t#value;\n\t#state;\n\t#inDeletedSlider;\n\t#isView;\n\t#showBackCalendarButtons;\n\n\tconstructor(options: EventOptions)\n\t{\n\t\tsuper({isHiddenOnStart: options.isHiddenOnStart});\n\t\tthis.#state = options.state;\n\t\tthis.#isView = options.isView;\n\t\tthis.#event = options.event;\n\t\tthis.#owner = options.owner;\n\t\tthis.#currentTimezone = options.timezone ?? Intl.DateTimeFormat().resolvedOptions().timeZone;\n\t\tthis.#widgetDate = this.#getWidgetDate();\n\t\tthis.#layout = {\n\t\t\tback: null,\n\t\t\twidgetDate: null,\n\t\t\teventName: null,\n\t\t\ticon: null,\n\t\t\tstateTitle: null,\n\t\t\tadditionalBlock: null,\n\t\t\tbottomButton: null\n\t\t};\n\t\tthis.#value = {\n\t\t\tfrom: null,\n\t\t\tto: null,\n\t\t\ttimezone: null,\n\t\t\tcanceledTimestamp: null,\n\t\t\tcanceledUserName: null,\n\t\t\teventName: null,\n\t\t\tcanceledByManager: options.canceledByManager,\n\t\t\teventLinkHash: options.eventLinkHash,\n\t\t\teventId: options.eventId,\n\t\t};\n\t\tthis.#icsFile = null;\n\t\tthis.#inDeletedSlider = options.inDeletedSlider === true;\n\t\tthis.#showBackCalendarButtons = options.showBackCalendarButtons;\n\n\t\tif (this.#event)\n\t\t{\n\t\t\tthis.#initEventData();\n\t\t}\n\n\t\tif (options.action === 'cancel')\n\t\t{\n\t\t\tsetTimeout(this.showCancelEventPopup.bind(this), 0);\n\t\t}\n\n\t\tif (options.action === 'ics')\n\t\t{\n\t\t\tthis.downloadIcsFile();\n\t\t}\n\n\t\tif (options.action === 'videoconference')\n\t\t{\n\t\t\tthis.startVideoconference();\n\t\t}\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn 'event';\n\t}\n\n\t#getWidgetDate(): WidgetDate\n\t{\n\t\tif (!this.#widgetDate)\n\t\t{\n\t\t\tthis.#widgetDate = new WidgetDate();\n\t\t}\n\n\t\treturn this.#widgetDate;\n\t}\n\n\t#initEventData()\n\t{\n\t\tthis.#value.from = Util.getTimezoneDateFromTimestampUTC(parseInt(this.#event.timestampFromUTC) * 1000, this.#currentTimezone);\n\t\tthis.#value.to = Util.getTimezoneDateFromTimestampUTC(parseInt(this.#event.timestampToUTC) * 1000, this.#currentTimezone);\n\t\tthis.#value.timezone = this.#currentTimezone;\n\t\tthis.#value.eventName = this.#getEventName();\n\t\tthis.#value.canceledTimestamp = this.#event.canceledTimestamp;\n\t\tthis.#value.canceledUserName = this.#event.externalUserName;\n\t\tthis.updateFormLayout();\n\t}\n\n\tupdateValue(data: EventData)\n\t{\n\t\tif (data.from)\n\t\t{\n\t\t\tthis.#value.from = data.from;\n\t\t}\n\t\tif (data.to)\n\t\t{\n\t\t\tthis.#value.to = data.to;\n\t\t}\n\t\tif (data.timezone)\n\t\t{\n\t\t\tthis.#value.timezone = data.timezone;\n\t\t}\n\t\tif (data.eventLinkHash)\n\t\t{\n\t\t\tthis.#value.eventLinkHash = data.eventLinkHash;\n\t\t}\n\t\tif (data.eventName)\n\t\t{\n\t\t\tthis.#value.eventName = data.eventName;\n\t\t}\n\t\tif (data.state)\n\t\t{\n\t\t\tthis.#updateState(data.state);\n\t\t}\n\t\tif (data.isView)\n\t\t{\n\t\t\tthis.#isView = false;\n\t\t}\n\t\tif (data.eventId)\n\t\t{\n\t\t\tthis.#value.eventId = data.eventId;\n\t\t}\n\t\tif (data.userName)\n\t\t{\n\t\t\tthis.#value.canceledUserName = data.userName;\n\t\t}\n\t\tif (this.#value.canceledByManager === true)\n\t\t{\n\t\t\tthis.#value.canceledByManager = false;\n\t\t}\n\n\t\tthis.updateFormLayout();\n\t}\n\n\tupdateFormLayout()\n\t{\n\t\tthis.#getWidgetDate().updateValue(this.#value);\n\t\tthis.#getEventNameNode().innerText = this.#value.eventName;\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__form-result\">\n\t\t\t\t${this.#getNodeBackWrapper()}\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form --center\">\n\t\t\t\t\t${this.#getNodeIcon()}\n\t\t\t\t\t${this.#getEventNameNode()}\n\t\t\t\t\t${this.#getStateTitleNode()}\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form --center\">\n\t\t\t\t\t${this.#getNodeWidgetDate()}\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form --center\">\n\t\t\t\t\t${this.#getAdditionalBlockNode()}\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --top-auto\">\n\t\t\t\t\t${this.#getBottomButtonNode()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#updateState(state: State)\n\t{\n\t\tthis.#state = state;\n\t\tDom.removeClass(this.#getNodeIcon(), ['--accept', '--decline']);\n\t\tDom.addClass(this.#getNodeIcon(), this.#getIconClassByState(state));\n\n\t\tthis.#getStateTitleNode().innerText = this.#getStateTitleTextByState(state);\n\n\t\tlet oldNode = this.#getAdditionalBlockNode();\n\t\tlet newNode = this.#createAdditionalBlockContentByState(state);\n\t\tthis.#layout.additionalBlock = newNode;\n\t\tDom.replace(oldNode, newNode);\n\n\t\toldNode = this.#getBottomButtonNode();\n\t\tnewNode = this.#createBottomButtonByState(state);\n\t\tthis.#layout.bottomButton = newNode;\n\t\tDom.replace(oldNode, newNode);\n\t}\n\n\t#getNodeIcon()\n\t{\n\t\tif (!this.#layout.icon)\n\t\t{\n\t\t\tthis.#layout.icon = this.#createIconByState(this.#state);\n\t\t}\n\n\t\treturn this.#layout.icon;\n\t}\n\n\t#getNodeBackWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.back)\n\t\t{\n\t\t\tif (this.#showBackCalendarButtons)\n\t\t\t{\n\t\t\t\tthis.#layout.back = Tag.render`\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-bar --arrow\">\n\t\t\t\t\t\t<div class=\"calendar-sharing__calendar-back\" onclick=\"${this.#onReturnButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#layout.back = Tag.render`<div class=\"calendar-sharing__calendar-bar --no-margin\"></div>`;\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.back;\n\t}\n\n\t#createIconByState(state: State)\n\t{\n\t\tlet result = Tag.render`\n\t\t\t<div class=\"calendar-sharing__form-result_icon\"></div>\n\t\t`;\n\t\tDom.addClass(result, this.#getIconClassByState(state));\n\n\t\treturn result;\n\t}\n\n\t#getIconClassByState(state: State)\n\t{\n\t\tlet result = '';\n\t\tswitch (state)\n\t\t{\n\t\t\tcase \"created\":\n\t\t\t\tresult = '--accept';\n\t\t\t\tbreak;\n\t\t\tcase \"not-created\":\n\t\t\t\tresult = '--decline';\n\t\t\t\tbreak;\n\t\t\tcase \"declined\":\n\t\t\t\tresult = '--decline';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#getEventNameNode(): HTMLElement\n\t{\n\t\tif (!this.#layout.eventName)\n\t\t{\n\t\t\tthis.#layout.eventName = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__typography-title --center --line-height-normal\">\n\t\t\t\t\t${this.#value.eventName}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.eventName;\n\t}\n\n\t#getStateTitleNode()\n\t{\n\t\tif (!this.#layout.stateTitle)\n\t\t{\n\t\t\tthis.#layout.stateTitle = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__typography-s --center\"></div>\n\t\t\t`;\n\t\t\tthis.#layout.stateTitle.innerText = this.#getStateTitleTextByState(this.#state);\n\t\t}\n\n\t\treturn this.#layout.stateTitle;\n\t}\n\n\t#getStateTitleTextByState(state: State)\n\t{\n\t\tlet result = '';\n\t\tswitch (state)\n\t\t{\n\t\t\tcase \"created\":\n\t\t\t\tif (!this.#isView)\n\t\t\t\t{\n\t\t\t\t\tresult = Loc.getMessage('CALENDAR_SHARING_MEETING_CREATED');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"not-created\":\n\t\t\t\tresult = Loc.getMessage('CALENDAR_SHARING_MEETING_NOT_CREATED');\n\t\t\t\tbreak;\n\t\t\tcase \"declined\":\n\t\t\t\tresult = Loc.getMessage('CALENDAR_SHARING_MEETING_CANCELED');\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#getAdditionalBlockNode()\n\t{\n\t\tif (!this.#layout.additionalBlock)\n\t\t{\n\t\t\tthis.#layout.additionalBlock = this.#createAdditionalBlockContentByState(this.#state);\n\t\t}\n\n\t\treturn this.#layout.additionalBlock;\n\t}\n\n\t#createAdditionalBlockContentByState(state: State)\n\t{\n\t\tlet result = '';\n\n\t\tif (this.#inDeletedSlider)\n\t\t{\n\t\t\tconst date = Util.getTimezoneDateFromTimestampUTC(parseInt(this.#value.canceledTimestamp) * 1000, this.#currentTimezone);\n\n\t\t\tif (this.#value.canceledTimestamp && this.#value.canceledUserName && date)\n\t\t\t{\n\t\t\t\tresult = Tag.render`\n\t\t\t\t\t\t<div class=\"calendar-pub__form-status\">\n\t\t\t\t\t\t\t<div class=\"calendar-pub__form-status_text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_WHO_CANCELED')}: <a href=\"/company/personal/user/${this.#owner.id}/\" target=\"_blank\" class=\"calendar-sharing-deletedviewform_open-profile\">${Text.encode(this.#value.canceledUserName)}</a>\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t${DateTimeFormat.format('j F ' + Util.getTimeFormatShort(), date.getTime() / 1000)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult = Tag.render`\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tswitch (state)\n\t\t{\n\t\t\tcase \"created\":\n\t\t\t\tresult = Tag.render`\n\t\t\t\t\t<div onclick=\"${this.showCancelEventPopup.bind(this)}\" class=\"calendar-pub__form-status --decline\">\n\t\t\t\t\t\t<div class=\"calendar-pub__form-status_text\">\n\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_DECLINE_MEETING')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\tcase \"not-created\":\n\t\t\t\tresult = Tag.render`\n\t\t\t\t\t<div></div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\tcase \"declined\":\n\t\t\t\tconst date = Util.getTimezoneDateFromTimestampUTC(parseInt(this.#value.canceledTimestamp) * 1000, this.#currentTimezone);\n\t\t\t\tif (this.#value.canceledByManager)\n\t\t\t\t{\n\t\t\t\t\tthis.#value.canceledUserName = this.#owner.name + ' ' + this.#owner.lastName;\n\t\t\t\t}\n\n\t\t\t\tif (this.#value.canceledTimestamp && this.#value.canceledUserName && date)\n\t\t\t\t{\n\t\t\t\t\tresult = Tag.render`\n\t\t\t\t\t\t<div class=\"calendar-pub__form-status\">\n\t\t\t\t\t\t\t<div class=\"calendar-pub__form-status_text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_WHO_CANCELED')}: ${Text.encode(this.#value.canceledUserName)}<br> ${DateTimeFormat.format('j F ' + Util.getTimeFormatShort(), date.getTime() / 1000)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult = Tag.render`\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t`;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#getBottomButtonNode()\n\t{\n\t\tif (!this.#layout.bottomButton)\n\t\t{\n\t\t\tthis.#layout.bottomButton = this.#createBottomButtonByState(this.#state);\n\t\t}\n\n\t\treturn this.#layout.bottomButton;\n\t}\n\n\t#createBottomButtonByState(state: State)\n\t{\n\t\tif (this.#inDeletedSlider)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tlet result = '';\n\t\tswitch (state)\n\t\t{\n\t\t\tcase \"created\":\n\t\t\t\tthis.#layout.videoconferenceButton = Tag.render`\n\t\t\t\t\t<div onclick=\"${this.#onVideoconferenceButtonClick.bind(this)}\" class=\"calendar-pub-ui__btn --light-border --m calendar-pub-action-btn\">\n\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_OPEN_VIDEOCONFERENCE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tthis.#layout.icsButton = Tag.render`\n\t\t\t\t\t<div onclick=\"${this.#onIcsButtonClick.bind(this)}\" class=\"calendar-pub-ui__btn --light-border --m calendar-pub-action-btn\">\n\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_ADD_TO_CALENDAR')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tresult = Tag.render`\n\t\t\t\t\t<div>\n\t\t\t\t\t\t${this.#layout.videoconferenceButton}\n\t\t\t\t\t\t${this.#layout.icsButton}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\tcase \"not-created\":\n\t\t\tcase \"declined\":\n\t\t\t\tif (this.#showBackCalendarButtons)\n\t\t\t\t{\n\t\t\t\t\tresult = Tag.render`\n\t\t\t\t\t\t<div onclick=\"${this.#onReturnButtonClick.bind(this)}\" class=\"calendar-pub-ui__btn --light-border --m\">\n\t\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_RETURN_TO_SLOT_LIST')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult = Tag.render`<div></div>`;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetPopup()\n\t{\n\t\tif (!this.popup)\n\t\t{\n\t\t\tconst popupContent = Tag.render`\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"calendar-pub__cookies-title\">${Loc.getMessage('CALENDAR_SHARING_POPUP_MEETING_CANCELED')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__cookies-info\">${Loc.getMessage('CALENDAR_SHARING_POPUP_MEETING_CANCELED_INFO')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__cookies-buttons ${Browser.isMobile() ? '--center' : '--flex-end'}\">\n\t\t\t\t\t\t<div onclick=\"${this.closeCancelEventPopup.bind(this)}\" class=\"calendar-pub-ui__btn --inline --m --light-border\">\n\t\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_POPUP_LEAVE')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div onclick=\"${this.handleDeleteButtonClick.bind(this)}\" class=\"calendar-pub-ui__btn --inline --m --secondary\">\n\t\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_POPUP_CANCEL')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (Browser.isMobile())\n\t\t\t{\n\t\t\t\tthis.popup = new BottomSheet({\n\t\t\t\t\tclassName: 'calendar-pub__state',\n\t\t\t\t\tcontent: popupContent,\n\t\t\t\t\tpadding: '20px 25px'\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\tclassName: 'calendar-pub__popup',\n\t\t\t\t\tcontentBackground: 'transparent',\n\t\t\t\t\twidth: 380,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\tcontent: popupContent,\n\t\t\t\t\toverlay: true\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this.popup;\n\t}\n\n\tshowCancelEventPopup()\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\tcloseCancelEventPopup()\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tasync handleDeleteButtonClick()\n\t{\n\t\tthis.closeCancelEventPopup();\n\t\tconst isSuccess = await this.deleteEvent();\n\t\tif (isSuccess)\n\t\t{\n\t\t\tthis.#value.canceledTimestamp = new Date().getTime() / 1000;\n\t\t\tthis.#updateState('declined');\n\t\t\tEventEmitter.emit('onDeleteEvent');\n\t\t}\n\t}\n\n\tasync #onIcsButtonClick()\n\t{\n\t\tawait this.downloadIcsFile();\n\t}\n\n\tasync #onVideoconferenceButtonClick()\n\t{\n\t\tDom.addClass(this.#layout.videoconferenceButton, '--wait');\n\t\tawait this.startVideoconference();\n\t\tDom.removeClass(this.#layout.videoconferenceButton, '--wait');\n\t}\n\n\tasync deleteEvent()\n\t{\n\t\tlet response = null;\n\t\ttry\n\t\t{\n\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.deleteEvent', {\n\t\t\t\tdata: {\n\t\t\t\t\teventId: this.#value.eventId,\n\t\t\t\t\teventLinkHash: this.#value.eventLinkHash,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tresponse = e;\n\t\t}\n\n\t\treturn response.errors.length === 0;\n\t}\n\n\tasync startVideoconference()\n\t{\n\t\tlet response = null;\n\t\ttry\n\t\t{\n\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.getConferenceLink', {\n\t\t\t\tdata: {\n\t\t\t\t\teventLinkHash: this.#value.eventLinkHash,\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error(error);\n\t\t}\n\n\t\tconst conferenceLink = response?.data?.conferenceLink;\n\n\t\tif (conferenceLink)\n\t\t{\n\t\t\twindow.location.href = conferenceLink;\n\t\t}\n\t}\n\n\tasync downloadIcsFile()\n\t{\n\t\tif (!this.#icsFile)\n\t\t{\n\t\t\tconst response = await BX.ajax.runAction('calendar.api.sharingajax.getIcsFileContent', {\n\t\t\t\tdata: {\n\t\t\t\t\teventLinkHash: this.#value.eventLinkHash\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.icsFile = response.data;\n\t\t}\n\n\t\tUtil.downloadIcsFile(this.icsFile, 'event');\n\t}\n\n\t#onReturnButtonClick()\n\t{\n\t\tEventEmitter.emit('onCreateAnotherEventButtonClick');\n\t}\n\n\t#getNodeWidgetDate(): HTMLElement\n\t{\n\t\tif (!this.#layout.widgetDate)\n\t\t{\n\t\t\tthis.#layout.widgetDate = this.#widgetDate.render();\n\t\t}\n\n\t\treturn this.#layout.widgetDate;\n\t}\n\n\t#getEventName()\n\t{\n\t\treturn Loc.getMessage('CALENDAR_SHARING_EVENT_NAME', {\n\t\t\t'#OWNER_NAME#' : this.#owner.name + ' ' + this.#owner.lastName,\n\t\t});\n\t}\n}\n","import { Tag, Type } from 'main.core';\nimport { Form } from './form/index';\nimport { EmptyState } from './empty-state/index';\nimport { SlotList } from './slot-list/index';\nimport { Event } from './event/index';\nimport { EventEmitter } from \"main.core.events\";\nimport { AccessDenied } from \"./empty-state/index\";\n\ntype SlotSelectorOptions = {\n\tselectedTimezoneId: number,\n\towner: any,\n\tlink: any,\n\tsharingUser: any,\n\thasContactData: boolean,\n\tcalendarSettings: any,\n\teventLinkHash: any,\n\tevent: any,\n\taction: string,\n\tshowBackCalendarButtons: any,\n};\nexport default class SlotSelector\n{\n\t#layout;\n\t#components;\n\t#selectedTimezoneId;\n\t#owner;\n\t#link;\n\t#sharingUser;\n\t#isFromCrm;\n\t#hasContactData;\n\t#calendarSettings;\n\t#eventLinkHash;\n\t#event;\n\t#action;\n\t#showBackCalendarButtons;\n\n\tBLOCK_NAME_FORM = 'form';\n\tBLOCK_NAME_SLOT_LIST = 'slot-list';\n\tBLOCK_NAME_EMPTY_STATE = 'empty-state';\n\tBLOCK_NAME_ACCESS_DENIED = 'access-denied';\n\tBLOCK_NAME_EVENT = 'event';\n\n\tconstructor(options: SlotSelectorOptions)\n\t{\n\t\tthis.#selectedTimezoneId = options.selectedTimezoneId;\n\t\tthis.#owner = options.owner;\n\t\tthis.#link = options.link;\n\t\tthis.#sharingUser = options.sharingUser;\n\t\tthis.#eventLinkHash = options.eventLinkHash;\n\t\tthis.#event = options.event;\n\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tempty: null,\n\t\t\ttitle: null,\n\t\t\tslots: null,\n\t\t\tslotSelector: null,\n\t\t}\n\t\tthis.#components = {\n\t\t\tform: null,\n\t\t\tslotList: null,\n\t\t\temptyState: null,\n\t\t\tevent: null,\n\t\t\taccessDenied: null,\n\t\t};\n\t\tthis.#isFromCrm = this.#link.type === 'crm_deal';\n\t\tthis.#hasContactData = options.hasContactData;\n\t\tthis.#calendarSettings = options.calendarSettings;\n\t\tthis.#showBackCalendarButtons = options.showBackCalendarButtons;\n\t\tthis.#action = options.action;\n\n\t\tthis.#bindEvents();\n\t\t// EventEmitter.subscribe('selectorStateChange', this.showForm.bind(this));\n\t\t// EventEmitter.subscribe('hideForm', this.hideForm.bind(this));\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('confirmedSelectSlot', (event) => {\n\t\t\tconst data = event.data;\n\t\t\tconst value = data.value;\n\t\t\tthis.#components.form.updateFormValue({\n\t\t\t\tfrom: value.from,\n\t\t\t\tto: value.to,\n\t\t\t\ttimezone: this.#selectedTimezoneId,\n\t\t\t});\n\t\t\tthis.openForm();\n\t\t});\n\n\t\tEventEmitter.subscribe('switchSlots', (event) => {\n\t\t\tconst slots = event.data.slots ?? [];\n\t\t\tif (slots.length > 0)\n\t\t\t{\n\t\t\t\tEventEmitter.emit('updateSlotsList', event);\n\t\t\t\tthis.openSlotList();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.openEmptyState();\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('updateTimezone', (event) => {\n\t\t\tconst data = event.data;\n\t\t\tthis.#selectedTimezoneId = data.timezone;\n\t\t});\n\n\t\tEventEmitter.subscribe('onSaveEvent', (event) => {\n\t\t\tconst eventData = event.data;\n\t\t\tthis.#components.form.cleanDescription();\n\t\t\tthis.#components.event.updateValue(eventData);\n\t\t\tthis.openEvent();\n\t\t});\n\t}\n\n\topenForm()\n\t{\n\t\tthis.#components.form?.clearInputErrors();\n\t\tthis.openBlock(this.BLOCK_NAME_FORM);\n\t}\n\n\topenSlotList()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_SLOT_LIST);\n\t}\n\n\topenEmptyState()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_EMPTY_STATE);\n\t}\n\n\topenAccessDenied()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_ACCESS_DENIED);\n\t}\n\n\topenEvent()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_EVENT);\n\t}\n\n\topenBlock(blockName)\n\t{\n\t\tEventEmitter.emit('selectorTypeChange', blockName);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.#components.form)\n\t\t{\n\t\t\tthis.#components.form = new Form({\n\t\t\t\tisHiddenOnStart: true,\n\t\t\t\towner: this.#owner,\n\t\t\t\tlink: this.#link,\n\t\t\t\tsharingUser: this.#sharingUser,\n\t\t\t\tisFromCrm: this.#isFromCrm,\n\t\t\t\thasContactData: this.#hasContactData,\n\t\t\t\tisPhoneFeatureEnabled: this.#calendarSettings.phoneFeatureEnabled,\n\t\t\t\tisMailFeatureEnabled: this.#calendarSettings.mailFeatureEnabled\n\t\t\t});\n\t\t}\n\t\tif (!this.#components.emptyState)\n\t\t{\n\t\t\tthis.#components.emptyState = new EmptyState({isHiddenOnStart: true});\n\t\t}\n\t\tif (!this.#components.accessDenied)\n\t\t{\n\t\t\tthis.#components.accessDenied = new AccessDenied({isHiddenOnStart: true});\n\t\t}\n\t\tif (!this.#components.slotList)\n\t\t{\n\t\t\tthis.#components.slotList = new SlotList({isHiddenOnStart: false});\n\t\t}\n\t\tif (!this.#components.event)\n\t\t{\n\t\t\tlet state = 'created';\n\n\t\t\tif (this.#link.active === false || this.#event?.meetingStatus === 'N' || this.#event?.deleted === 'Y')\n\t\t\t{\n\t\t\t\tstate = 'declined';\n\t\t\t}\n\n\t\t\tlet canceledByManager = false;\n\t\t\tif (this.#event?.meetingStatus === 'N')\n\t\t\t{\n\t\t\t\tcanceledByManager = true;\n\t\t\t}\n\n\t\t\tthis.#components.event = new Event({\n\t\t\t\tisHiddenOnStart: false,\n\t\t\t\towner: this.#owner,\n\t\t\t\tevent: this.#event,\n\t\t\t\teventLinkHash: this.#eventLinkHash,\n\t\t\t\tstate: state,\n\t\t\t\teventId: this.#event.id,\n\t\t\t\tisView: Type.isString(this.#eventLinkHash),\n\t\t\t\tcanceledByManager: canceledByManager,\n\t\t\t\tshowBackCalendarButtons: this.#showBackCalendarButtons,\n\t\t\t\taction: this.#action,\n\t\t\t});\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__slots\">\n\t\t\t\t${this.#components.slotList.render()}\n\t\t\t\t${this.#components.form.render()}\n\t\t\t\t${this.#components.emptyState.render()}\n\t\t\t\t${this.#components.event.render()}\n\t\t\t\t${this.#components.accessDenied.render()}\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { Tag, Type, Dom, Loc, Event } from 'main.core';\nimport Welcome from './components/welcome';\nimport { Calendar } from './components/calendar/index';\nimport { SlotSelector } from './components/slot-selector/index';\nimport { EventEmitter } from 'main.core.events';\nimport { Form } from 'components/slot-selector/form/index';\n\n\nimport 'ui.design-tokens';\nimport './style.css';\n\ntype PublicOptions = {\n\ttarget: HTMLElement,\n\tlink: any,\n\tparentLink: any,\n\tevent: any,\n\taction: string,\n\tcurrentLang: string,\n\towner: any,\n}\n\nexport default class PublicV2\n{\n\t#layout;\n\t#owner;\n\t#welcomePage;\n\t#calendar;\n\t#slotsBlock;\n\n\tconstructor(options: PublicOptions)\n\t{\n\t\tthis.#owner = options.owner ? options.owner : null;\n\t\tthis.target = Type.isDomNode(options.target) ? options.target : null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tanimate: null,\n\t\t};\n\t\tthis.#welcomePage = null;\n\t\tthis.#calendar = null;\n\t\tthis.#slotsBlock = null;\n\n\t\tthis.#init();\n\t\tthis.#bindEvents();\n\n\t\tthis.showPageWelcome(options);\n\n\t\tif (options.link.type === 'event')\n\t\t{\n\t\t\tif (options.parentLink && options.parentLink.active === true)\n\t\t\t{\n\t\t\t\tthis.#renderFreeSlots(options);\n\t\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\t\tthis.#slotsBlock.openEvent();\n\t\t\t}\n\t\t\telse if (options.event)\n\t\t\t{\n\t\t\t\tthis.#renderSlotsSelector(options);\n\t\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\t\tthis.#welcomePage.hideButton();\n\t\t\t\tthis.#welcomePage.setAccessDenied();\n\t\t\t\tthis.#slotsBlock.openEvent();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#renderSlotsSelector(options);\n\t\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\t\tthis.#welcomePage.hideButton();\n\t\t\t\tthis.#slotsBlock.openAccessDenied();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (options.link.active === true)\n\t\t\t{\n\t\t\t\tthis.#renderFreeSlots(options);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#renderSlotsSelector(options);\n\t\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\t\tthis.#welcomePage.hideButton();\n\t\t\t\tthis.#slotsBlock.openAccessDenied();\n\t\t\t}\n\t\t}\n\n\t\t// this.showFreeSlots();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('showSlotSelector', this.showFreeSlots.bind(this));\n\t\tEventEmitter.subscribe('hideSlotSelector', this.hideFreeSlots.bind(this));\n\t}\n\n\tshowPageWelcome(options)\n\t{\n\t\tif (!options.owner)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#welcomePage = new Welcome({\n\t\t\towner: options.owner,\n\t\t\tlink: options.link,\n\t\t\tcurrentLang: options.currentLang\n\t\t});\n\n\t\tDom.append(this.#welcomePage.render(), this.#getNodeWrapper());\n\t}\n\n\t#renderFreeSlots(options)\n\t{\n\t\tthis.#calendar = new Calendar({\n\t\t\towner: options.owner,\n\t\t\taccessibility: options.userAccessibility,\n\t\t\ttimezoneList: options.timezoneList,\n\t\t\tcalendarSettings: options.calendarSettings,\n\t\t});\n\n\t\tlet eventLinkHash = null;\n\t\tif (options.link.type === 'event')\n\t\t{\n\t\t\teventLinkHash = options.link.hash;\n\t\t}\n\n\t\tthis.#slotsBlock = new SlotSelector({\n\t\t\tselectedTimezoneId: this.#calendar.getSelectedTimezoneId(),\n\t\t\towner: this.#owner,\n\t\t\tlink: options.parentLink || options.link,\n\t\t\tsharingUser: options.sharingUser,\n\t\t\thasContactData: options.hasContactData,\n\t\t\tcalendarSettings: options.calendarSettings,\n\t\t\tevent: options.event,\n\t\t\tshowBackCalendarButtons: true,\n\t\t\teventLinkHash: eventLinkHash,\n\t\t\taction: options.action,\n\t\t});\n\n\t\tconst firstNodeWrapper = Tag.render`\n\t\t\t<div class=\"calendar-pub__block --plus\">\n\t\t\t\t${this.#calendar.render()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.animate = Tag.render`\n\t\t\t<div class=\"calendar-pub__block-animate\">\n\t\t\t\t${firstNodeWrapper}\n\t\t\t\t<div class=\"calendar-pub__block\">\n\t\t\t\t\t${this.#slotsBlock.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEventEmitter.subscribe('selectorTypeChange', (ev)=> {\n\t\t\tif (ev.data === 'form' || ev.data === 'event')\n\t\t\t{\n\t\t\t\tDom.addClass(firstNodeWrapper, '--hidden');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(firstNodeWrapper, '--hidden');\n\t\t\t}\n\t\t});\n\n\t\tDom.append(this.#layout.animate, this.#getNodeWrapper());\n\n\t\tif (options.link.type !== 'event')\n\t\t{\n\t\t\tthis.#calendar.selectFirstAvailableDay();\n\t\t}\n\t}\n\n\t#renderSlotsSelector(options)\n\t{\n\t\tlet eventLinkHash = null;\n\t\tif (options.link.type === 'event')\n\t\t{\n\t\t\teventLinkHash = options.link.hash;\n\t\t}\n\n\t\tthis.#slotsBlock = new SlotSelector({\n\t\t\tselectedTimezoneId: null,\n\t\t\towner: this.#owner,\n\t\t\tlink: options.link,\n\t\t\tsharingUser: options.sharingUser,\n\t\t\thasContactData: options.hasContactData,\n\t\t\tcalendarSettings: options.calendarSettings,\n\t\t\tevent: options.event,\n\t\t\tshowBackCalendarButtons: false,\n\t\t\taction: options.action,\n\t\t\teventLinkHash: eventLinkHash,\n\t\t});\n\n\t\tthis.#layout.animate = Tag.render`\n\t\t\t<div class=\"calendar-pub__block-animate\">\n\t\t\t\t<div class=\"calendar-pub__block\">\n\t\t\t\t\t${this.#slotsBlock.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(this.#layout.animate, this.#getNodeWrapper());\n\t}\n\n\tshowFreeSlots()\n\t{\n\t\tDom.removeClass(this.#getNodeWrapper(), '--hide');\n\t}\n\n\thideFreeSlots()\n\t{\n\t\tDom.addClass(this.#getNodeWrapper(), '--hide');\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__wrapper calendar-pub__state --hide\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\t#render()\n\t{\n\t\tif (!this.target)\n\t\t{\n\t\t\tconsole.warn('BX.Calendar.Sharing: \"target\" is not defined');\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.target.parentNode)\n\t\t{\n\t\t\tDom.append(this.#getNodeWrapper(), this.target.parentNode);\n\t\t\tDom.remove(this.target);\n\t\t}\n\t}\n\n\t#init(): void\n\t{\n\t\tthis.#render();\n\t}\n}"],"names":["Welcome","constructor","options","owner","link","currentLang","name","lastName","photo","wrapper","button","label","type","active","lastStatus","disableButton","Dom","addClass","enableButton","removeClass","hideButton","handleWelcomePageButtonClick","hasClass","EventEmitter","emit","setAccessDenied","info","render","Tag","encodeURI","mode","BX","ajax","runAction","data","linkHash","hash","entityId","entityType","notifyType","Loc","getMessage","Event","bind","subscribe","accessDenied","infoTitle","infoSubTitle","title","subTitle","innerText","Day","value","notCurrentMonth","today","slots","selected","weekend","enableBooking","select","isSelected","getDay","isEnableBooking","highlight","unSelect","Calendar","monthWrapper","timezoneWrapper","month","currentMonth","prevNav","nextNav","daysOfWeek","navigation","back","accessibility","timezoneList","calendarSettings","Date","Intl","DateTimeFormat","resolvedOptions","timeZone","getMonth","getFullYear","getTimezoneOffset","eventDurability","stepSize","weekHolidays","weekStart","weekdays","Util","getWeekdaysLoc","setInterval","updateEventSlotsList","currentYear","year","arrayKey","selectFirstAvailableDay","visibleDays","days","todayDay","getDate","filter","day","slice","dayToSelect","find","undefined","selectMonthDay","highlightMonthDay","getSelectedTimezoneId","getTimezonePrefix","timezoneOffset","offset","date","getTime","format","getTimeFormatShort","event","newSelectedDay","state","timezoneNode","clean","append","map","weekDay","getIndByWeekDay","yearHolidays","push","splice","hourOffset","getTimeZoneOffset","workTimeStart","parseFloat","workTimeStartHours","workTimeStartMinutes","workTimeEnd","workTimeEndHours","workTimeEndMinutes","daysCount","accessibilityArrayKey","nowTimestamp","dayIndex","currentDate","from","to","dayAccessibility","parseUTC","isFullDay","parseDate","slotStart","slotEnd","slotAccessibility","available","length","timeFrom","timeTo","dateIndex","setTime","currentTimezoneOffset","currentMonthIndex","nextMonthIndex","nextYear","Math","floor","nextMonth","firstMonthDay","lastMonthDay","response","userId","id","timestampFrom","timestampTo","currentMonthDate","newDay","params","monthDays","dayMonthKey","includes","from1","to1","from2","to2","startsInside","endsInside","startsBeforeEndsAfter","timezoneSelect","Browser","isMobile","addEventListener","timezonesPopup","getPopupWindow","show","popupContent","getContentContainer","selectedTimezoneItem","querySelector","selectOffset","getBoundingClientRect","top","offsetHeight","scrollTop","offsetTop","isShown","destroy","items","Object","keys","timezoneId","text","className","onclick","close","MenuManager","create","autoHide","maxHeight","window","innerHeight","selectNode","timezone","innerHTML","nodesWeekDays","param","monthInfo","firstDayOfMonth","lastDateOfMonth","lastDayOfLastMonth","nodeMonth","k","j","i","dayOfWeek","result","touchPosition","x","touchMove","ev","changedTouches","clientX","style","removeProperty","preventDefault","currentMonthName","direction","Type","isString","once","monthIndex","Base","isHiddenOnStart","getContent","getType","WidgetDate","calendarPage","dayInfo","timeInterval","updateValue","updateLayout","getDayOfWeekMonthFormat","formatTimeInterval","getFormattedTimezone","setAttribute","Form","sharingUser","isFromCrm","hasContactData","isPhoneFeatureEnabled","isMailFeatureEnabled","buttonSend","widgetDate","formArea","inputs","contact","description","authorName","contactData","authorNameEmpty","contactDataEmpty","contactDataIncorrect","cleanDescription","updateFormValue","updateFormLayout","clearInputErrors","isSuccessful","eventName","ownerCreated","ownerId","dateFrom","dateTo","userName","userContact","crmDealLinkHash","parentLinkHash","e","errors","eventId","eventLinkId","eventLinkHash","eventLinkShortUrl","isView","contactDataError","isEmptyContactName","dateInFormat","getDateFormat","timeInFormat","getTimeFormat","phone","replace","match","nameInputError","contactInputError","messageCode","inputMode","personalMailbox","personalPhone","parentNode","textBeforeCursor","input","selectionStart","firstPart","lastCharacter","matches","formattedPosition","indexOf","setSelectionRange","key","isAnyModifierKeyPressed","test","hasPlus","substr","split","item","code","mask","repeat","r","sort","a","b","EmptyState","content","AccessDenied","SlotItem","BUTTON_MAX_WIDTH","showForm","document","body","offsetWidth","remove","SlotList","list","updateSlotsList","slotListNode","newSelectedSlot","slotSelector","currentDaySlots","slot","slotItem","classList","add","scrollHeight","ceil","setTimeout","icon","stateTitle","additionalBlock","bottomButton","canceledTimestamp","canceledUserName","canceledByManager","inDeletedSlider","showBackCalendarButtons","action","showCancelEventPopup","downloadIcsFile","startVideoconference","getPopup","popup","closeCancelEventPopup","handleDeleteButtonClick","BottomSheet","padding","Popup","contentBackground","width","animation","overlay","isSuccess","deleteEvent","error","console","conferenceLink","location","href","icsFile","getTimezoneDateFromTimestampUTC","parseInt","timestampFromUTC","timestampToUTC","externalUserName","oldNode","newNode","Text","encode","videoconferenceButton","icsButton","SlotSelector","BLOCK_NAME_FORM","BLOCK_NAME_SLOT_LIST","BLOCK_NAME_EMPTY_STATE","BLOCK_NAME_ACCESS_DENIED","BLOCK_NAME_EVENT","selectedTimezoneId","empty","form","slotList","emptyState","openForm","openBlock","openSlotList","openEmptyState","openAccessDenied","openEvent","blockName","phoneFeatureEnabled","mailFeatureEnabled","meetingStatus","deleted","eventData","PublicV2","target","isDomNode","animate","showPageWelcome","parentLink","showFreeSlots","hideFreeSlots","userAccessibility","firstNodeWrapper","warn"],"mappings":"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"}