this.BX=this.BX||{};(function(e,t,i){"use strict";class r{constructor(e){this.BX=BX;this.filterId=e;this.minSearchStringLength=2;this.filter=this.BX.Main.filterManager.getById(this.filterId);this.filterApi=this.filter.getApi();i.EventEmitter.subscribe("BX.Main.Filter:apply",this.applyFilter.bind(this))}getFilter(){return this.filter}displaySearchResult(e){const i=t.Util.getCalendarContext();const r=[];for(const t of e.entries){r.push(new window.BXEventCalendar.Entry(i,t))}i.getView().displayResult(r)}applyFilter(e,t,i,r,a){if(a){a.autoResolve=false}this.applyFilterHandler(r).then((()=>{}))}applyFilterHandler(e){return new Promise((i=>{const r=t.Util.getCalendarContext();if(this.isFilterEmpty()){if(r.getView().resetFilterMode){r.getView().resetFilterMode({resetSearchFilter:false})}if(e){e.fulfill()}}else{r.setView("list",{animation:false});r.getView().applyFilterMode();BX.ajax.runAction("calendar.api.calendarajax.getFilterData",{data:{ownerId:r.util.config.ownerId,userId:r.util.config.userId,type:r.util.config.type}}).then((t=>{if(t.data.entries){if(!r.getView().filterMode){r.getView().applyFilterMode();this.displaySearchResult(t.data)}else{this.displaySearchResult(t.data)}}if(e){e.fulfill()}i(t.data)}),(e=>{i(e.data)}))}}))}isFilterEmpty(){const e=this.filter.getSearch();return!e.getLastSquare()&&(!e.getSearchString()||e.getSearchString().length<this.minSearchStringLength)}resetFilter(){this.filter.resetFilter()}}e.Search=r})(this.BX.Calendar=this.BX.Calendar||{},BX.Calendar,BX.Event);
//# sourceMappingURL=search.bundle.map.js