{"version":3,"file":"roomsmanager.bundle.js","sources":["../src/roomssection.js","../src/roomsmanager.js"],"sourcesContent":["import { Util } from 'calendar.util';\nimport { CalendarSection } from 'calendar.sectionmanager';\n\nexport class RoomsSection extends CalendarSection\n{\n\tconstructor(data)\n\t{\n\t\tsuper(data);\n\t\tthis.updateData(data);\n\t\tthis.calendarContext = Util.getCalendarContext();\n\t\t// this.roomsManager = this.calendarContext.roomsManager;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tthis.data = data || {};\n\t\tthis.type = data.CAL_TYPE || '';\n\t\tthis.necessity = data.NECESSITY || 'N';\n\t\tthis.capacity = parseInt(data.CAPACITY) || 0;\n\t\tthis.ownerId = parseInt(data.OWNER_ID) || 0;\n\t\tthis.id = parseInt(data.ID);\n\t\tthis.location_id = parseInt(data.LOCATION_ID);\n\t\tthis.color = this.data.COLOR;\n\t\tthis.name = this.data.NAME;\n\t\tthis.categoryId = parseInt(this.data.CATEGORY_ID);\n\t\tthis.reserved = this.data.reserved || false;\n\t}\n\n\tbelongsToView()\n\t{\n\t\treturn true;\n\t}\n}","import {Type, Loc, Event, Runtime } from 'main.core';\nimport { SectionManager } from 'calendar.sectionmanager';\nimport { Util } from 'calendar.util';\nimport { RoomsSection } from './roomssection';\nimport { EventEmitter } from 'main.core.events';\nexport { RoomsSection };\n\nexport class RoomsManager extends SectionManager\n{\n\tconstructor(data, config)\n\t{\n\t\tsuper(data, config);\n\t\tthis.locationAccess = config.locationAccess || false;\n\t\tthis.locationContext = config.locationContext || null;\n\t\tthis.setRooms(data.rooms);\n\t\tthis.setConfig(config);\n\t\tthis.sortRooms();\n\t\tthis.setSections(data.sections);\n\t\tthis.sortSections();\n\t\tthis.reloadRoomsFromDatabaseDebounce = Runtime.debounce(this.reloadRoomsFromDatabase, SectionManager.RELOAD_DELAY, this);\n\n\t\tif (Object.keys(Util.accessNames).length === 0)\n\t\t{\n\t\t\tBX.Calendar.Util.setAccessNames(config.accessNames);\n\t\t}\n\t\tEventEmitter.subscribeOnce('BX.Calendar.Rooms:delete', this.deleteRoomHandler.bind(this));\n\t}\n\n\tsortRooms()\n\t{\n\t\tthis.roomsIndex = {};\n\t\tthis.rooms = this.rooms.sort((a, b) => {\n\t\t\tif (a.name.toLowerCase() > b.name.toLowerCase())\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tif (a.name.toLowerCase() < b.name.toLowerCase())\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn 0;\n\t\t});\n\n\t\tthis.rooms.forEach((room, i) => {\n\t\t\tthis.roomsIndex[room.getId()] = i;\n\t\t});\n\t}\n\n\tsetRooms(params = [])\n\t{\n\t\tthis.rooms = [];\n\t\tthis.roomsIndex = {};\n\t\tparams.forEach((roomData) => {\n\t\t\tlet room = new RoomsSection(roomData);\n\t\t\tthis.rooms.push(room);\n\t\t\tthis.roomsIndex[room.getId()] = this.rooms.length - 1;\n\t\t});\n\t}\n\n\tgetRooms()\n\t{\n\t\treturn this.rooms;\n\t}\n\n\tgetRoom(id)\n\t{\n\t\treturn this.rooms[this.roomsIndex[id]];\n\t}\n\n\tcreateRoom(params)\n\t{\n\t\treturn new Promise(resolve => {\n\n\t\t\tparams.name = this.checkName(params.name);\n\t\t\tparams.capacity = this.checkCapacity(params.capacity);\n\t\t\tparams.necessity = (params.necessity && params.capacity !== 0) ? 'Y' : 'N';\n\n\t\t\tBX.ajax.runAction('calendar.api.locationajax.createRoom', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tname: params.name,\n\t\t\t\t\t\tcapacity: params.capacity,\n\t\t\t\t\t\tnecessity: params.necessity,\n\t\t\t\t\t\townerId: this.ownerId,\n\t\t\t\t\t\tcolor: params.color,\n\t\t\t\t\t\taccess: params.access || null,\n\t\t\t\t\t\tcategoryId: params.categoryId,\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst roomList = response.data.rooms || [];\n\t\t\t\t\t\tconst sectionList = response.data.sections || [];\n\t\t\t\t\t\tthis.setRooms(roomList);\n\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\tthis.setSections(sectionList);\n\t\t\t\t\t\tthis.sortSections();\n\n\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t'BX.Calendar.Rooms:create',\n\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: { roomsList: roomList }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.setLocationSelector(roomList);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tBX.Calendar.Util.displayError(response.errors);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t});\n\t}\n\n\tupdateRoom(params)\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tparams.name = this.checkName(params.name);\n\t\t\tparams.capacity = this.checkCapacity(params.capacity);\n\t\t\tparams.necessity = (params.necessity && params.capacity !== 0) ? 'Y' : 'N';\n\n\t\t\tBX.ajax.runAction('calendar.api.locationajax.updateRoom', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: params.id,\n\t\t\t\t\t\tlocation_id: params.location_id,\n\t\t\t\t\t\tname: params.name,\n\t\t\t\t\t\tcapacity: params.capacity,\n\t\t\t\t\t\tnecessity: params.necessity,\n\t\t\t\t\t\tcolor: params.color,\n\t\t\t\t\t\taccess: params.access || null,\n\t\t\t\t\t\tcategoryId: params.categoryId,\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst roomList = response.data.rooms || [];\n\t\t\t\t\t\tconst sectionList = response.data.sections || [];\n\t\t\t\t\t\tthis.setRooms(roomList);\n\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\tthis.setSections(sectionList);\n\t\t\t\t\t\tthis.sortSections();\n\t\t\t\t\t\tthis.unsetHiddenRoom(params.id)\n\n\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t'BX.Calendar.Rooms:update',\n\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: { roomsList: roomList }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.setLocationSelector(roomList);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tBX.Calendar.Util.displayError(response.errors);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t}\n\n\tdeleteRoom(id, location_id)\n\t{\n\t\tconst EventAlias = Util.getBX().Event;\n\t\tEventAlias.EventEmitter.emit(\n\t\t\t'BX.Calendar.Section:delete',\n\t\t\tnew EventAlias.BaseEvent({data: {sectionId: id}})\n\t\t);\n\t\treturn new Promise(resolve => {\n\t\t\tBX.ajax.runAction('calendar.api.locationajax.deleteRoom', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: id,\n\t\t\t\t\t\tlocation_id: location_id\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst roomList = response.data.rooms || [];\n\t\t\t\t\t\tconst sectionList = response.data.sections || [];\n\t\t\t\t\t\tif (!roomList.length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setRooms(roomList);\n\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\tthis.setSections(sectionList);\n\t\t\t\t\t\tthis.sortSections();\n\n\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t'BX.Calendar.Rooms:delete',\n\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tid: id\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.setLocationSelector(roomList);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tBX.Calendar.Util.displayError(response.errors);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t}\n\n\tcheckName(name)\n\t{\n\t\tif (typeof name === 'string')\n\t\t{\n\t\t\tname = name.trim();\n\t\t\tif (RoomsManager.isEmpty(name))\n\t\t\t{\n\t\t\t\tname = Loc.getMessage('EC_SEC_SLIDER_NEW_ROOM');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tname = Loc.getMessage('EC_SEC_SLIDER_NEW_ROOM');\n\t\t}\n\t\treturn name;\n\t}\n\n\tcheckCapacity(capacity)\n\t{\n\t\tif (RoomsManager.isEmpty(capacity) || capacity <= 0 || capacity >= 10000)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\t\treturn capacity;\n\t}\n\n\tgetRoomsInfo()\n\t{\n\t\tconst allActive = [];\n\t\tconst superposed = [];\n\t\tconst active = [];\n\t\tconst hidden = [];\n\n\t\tthis.rooms.forEach((room) => {\n\t\t\tif (room.isShown() && this.calendarType === 'location' && room.type === 'location')\n\t\t\t{\n\t\t\t\tif (room.isSuperposed())\n\t\t\t\t{\n\t\t\t\t\tsuperposed.push(room.id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tactive.push(room.id);\n\t\t\t\t}\n\t\t\t\tallActive.push(room.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thidden.push(room.id);\n\t\t\t}\n\t\t});\n\n\t\treturn { superposed, active, hidden, allActive };\n\t}\n\n\tgetRoomName(id)\n\t{\n\t\tif (RoomsManager.isEmpty(id))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst room = this.getRoom(id);\n\t\treturn room.name;\n\t}\n\n\tunsetHiddenRoom(id)\n\t{\n\t\tif (id)\n\t\t{\n\t\t\tconst room = this.getRoom(id)\n\t\t\tif (room.calendarContext && !room.isShown())\n\t\t\t{\n\t\t\t\troom.show();\n\t\t\t}\n\t\t}\n\t}\n\n\thandlePullRoomChanges(params)\n\t{\n\t\tif (params.command === 'delete_room')\n\t\t{\n\t\t\tconst roomId = parseInt(params.ID, 10);\n\t\t\tif (this.roomsIndex[roomId])\n\t\t\t{\n\t\t\t\tthis.deleteRoomHandler(roomId);\n\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t'BX.Calendar.Rooms:pull-delete',\n\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: { roomId: roomId }\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.reloadRoomsFromDatabaseDebounce();\n\t\t\t}\n\t\t}\n\t\telse if (params.command === 'create_room')\n\t\t{\n\t\t\tthis.reloadRoomsFromDatabase().then(this.reloadDataDebounce());\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar.Rooms:pull-create');\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar:doRefresh');\n\t\t}\n\t\telse if (params.command === 'update_room')\n\t\t{\n\t\t\tthis.reloadRoomsFromDatabase().then(this.reloadDataDebounce());\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar.Rooms:pull-update');\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar:doRefresh');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.reloadRoomsFromDatabase().then(this.reloadDataDebounce());\n\t\t}\n\t}\n\n\tdeleteRoomHandler(id)\n\t{\n\t\tif (this.roomsIndex[id] !== undefined)\n\t\t{\n\t\t\tthis.rooms.splice(this.roomsIndex[id], 1);\n\t\t\tfor (let i = 0; i < this.rooms.length; i++)\n\t\t\t{\n\t\t\t\tthis.roomsIndex[this.rooms[i].id] = i;\n\t\t\t}\n\t\t}\n\t\tif (this.sectionIndex[id] !== undefined)\n\t\t{\n\t\t\tthis.sections.splice(this.sectionIndex[id], 1);\n\t\t\tfor (let i = 0; i < this.sections.length; i++)\n\t\t\t{\n\t\t\t\tthis.sectionIndex[this.sections[i].id] = i;\n\t\t\t}\n\t\t}\n\t}\n\n\treloadRoomsFromDatabase()\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tBX.ajax.runAction('calendar.api.locationajax.getRoomsList')\n\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.setRooms(response.data.rooms || []);\n\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\tBX.Calendar.Controls.Location.setLocationList(response.data.rooms);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t// Failure\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t}\n\n\tgetLocationAccess()\n\t{\n\t\treturn this.locationAccess;\n\t}\n\n\tsetLocationSelector(roomList)\n\t{\n\t\tBX.Calendar.Controls.Location.setLocationList(roomList);\n\t\tif (this.locationContext !== null)\n\t\t{\n\t\t\tthis.locationContext.setValues();\n\t\t}\n\t}\n\n\tstatic isEmpty(param)\n\t{\n\t\tif (Type.isArray(param))\n\t\t{\n\t\t\treturn !param.length;\n\t\t}\n\t\treturn param === null || param === undefined || param === '' || param === [] || param === {};\n\t}\n}"],"names":["RoomsSection","CalendarSection","constructor","data","updateData","calendarContext","Util","getCalendarContext","type","CAL_TYPE","necessity","NECESSITY","capacity","parseInt","CAPACITY","ownerId","OWNER_ID","id","ID","location_id","LOCATION_ID","color","COLOR","name","NAME","categoryId","CATEGORY_ID","reserved","belongsToView","RoomsManager","SectionManager","config","locationAccess","locationContext","setRooms","rooms","setConfig","sortRooms","setSections","sections","sortSections","reloadRoomsFromDatabaseDebounce","Runtime","debounce","reloadRoomsFromDatabase","RELOAD_DELAY","Object","keys","accessNames","length","BX","Calendar","setAccessNames","EventEmitter","subscribeOnce","deleteRoomHandler","bind","roomsIndex","sort","a","b","toLowerCase","forEach","room","i","getId","params","roomData","push","getRooms","getRoom","createRoom","Promise","resolve","checkName","checkCapacity","ajax","runAction","access","then","response","roomList","sectionList","getBX","Event","emit","BaseEvent","roomsList","setLocationSelector","displayError","errors","updateRoom","unsetHiddenRoom","deleteRoom","EventAlias","sectionId","reload","trim","isEmpty","Loc","getMessage","getRoomsInfo","allActive","superposed","active","hidden","isShown","calendarType","isSuperposed","getRoomName","show","handlePullRoomChanges","command","roomId","reloadDataDebounce","undefined","splice","sectionIndex","Controls","Location","setLocationList","getLocationAccess","setValues","param","Type","isArray"],"mappings":"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"}