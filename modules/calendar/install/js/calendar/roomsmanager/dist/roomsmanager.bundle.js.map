{"version":3,"file":"roomsmanager.bundle.js","sources":["../src/roomssection.js","../src/roomsmanager.js"],"sourcesContent":["import { Util } from 'calendar.util';\nimport { CalendarSection } from 'calendar.sectionmanager';\n\nexport class RoomsSection extends CalendarSection\n{\n\tconstructor(data)\n\t{\n\t\tsuper(data);\n\t\tthis.updateData(data);\n\t\tthis.calendarContext = Util.getCalendarContext();\n\t\t// this.roomsManager = this.calendarContext.roomsManager;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tthis.data = data || {};\n\t\tthis.type = data.CAL_TYPE || '';\n\t\tthis.necessity = data.NECESSITY || 'N';\n\t\tthis.capacity = parseInt(data.CAPACITY) || 0;\n\t\tthis.ownerId = parseInt(data.OWNER_ID) || 0;\n\t\tthis.id = parseInt(data.ID);\n\t\tthis.location_id = parseInt(data.LOCATION_ID);\n\t\tthis.color = this.data.COLOR;\n\t\tthis.name = this.data.NAME;\n\t}\n\n\tbelongsToView()\n\t{\n\t\t// const calendarContext = Util.getCalendarContext();\n\t\t// return this.type === calendarContext.getCalendarType()\n\t\t// \t&& this.ownerId === calendarContext.getOwnerId();\n\t\treturn true;\n\t}\n}","import {Type, Loc, Event } from 'main.core';\nimport { SectionManager } from 'calendar.sectionmanager';\nimport { Util } from 'calendar.util';\nimport { RoomsSection } from './roomssection';\nimport { EventEmitter } from 'main.core.events';\nexport { RoomsSection };\n\nexport class RoomsManager extends SectionManager\n{\n\tconstructor(data, config)\n\t{\n\t\tsuper(data, config);\n\t\tthis.locationAccess = config.locationAccess || false;\n\t\tthis.locationContext = config.locationContext || null;\n\t\tthis.setRooms(data.rooms);\n\t\tthis.setConfig(config);\n\t\tthis.sortRooms();\n\t\tthis.setSections(data.sections);\n\t\tthis.sortSections();\n\n\t\tEventEmitter.subscribeOnce('BX.Calendar.Rooms:delete', this.deleteRoomHandler.bind(this));\n\t}\n\n\tsortRooms()\n\t{\n\t\tthis.roomsIndex = {};\n\t\tthis.rooms = this.rooms.sort((a, b) => {\n\t\t\tif (a.name.toLowerCase() > b.name.toLowerCase())\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tif (a.name.toLowerCase() < b.name.toLowerCase())\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn 0;\n\t\t});\n\n\t\tthis.rooms.forEach((room, i) => {\n\t\t\tthis.roomsIndex[room.getId()] = i;\n\t\t});\n\t}\n\n\tsetRooms(params = [])\n\t{\n\t\tthis.rooms = [];\n\t\tthis.roomsIndex = {};\n\t\tparams.forEach((roomData) => {\n\t\t\tlet room = new RoomsSection(roomData);\n\t\t\tthis.rooms.push(room);\n\t\t\tthis.roomsIndex[room.getId()] = this.rooms.length - 1;\n\t\t});\n\t}\n\n\tgetRooms()\n\t{\n\t\treturn this.rooms;\n\t}\n\n\tgetRoom(id)\n\t{\n\t\treturn this.rooms[this.roomsIndex[id]];\n\t}\n\n\tcreateRoom(params)\n\t{\n\t\treturn new Promise(resolve => {\n\n\t\t\tparams.name = this.checkName(params.name);\n\t\t\tparams.capacity = this.checkCapacity(params.capacity);\n\t\t\tparams.necessity = (params.necessity && params.capacity !== 0) ? 'Y' : 'N';\n\n\t\t\tBX.ajax.runAction('calendar.api.locationajax.createRoom', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tname: params.name,\n\t\t\t\t\t\tcapacity: params.capacity,\n\t\t\t\t\t\tnecessity: params.necessity,\n\t\t\t\t\t\townerId: this.ownerId,\n\t\t\t\t\t\tcolor: params.color,\n\t\t\t\t\t\taccess: params.access || null\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst roomList = response.data.rooms || [];\n\t\t\t\t\t\tconst sectionList = response.data.sections || [];\n\t\t\t\t\t\tthis.setRooms(roomList);\n\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\tthis.setSections(sectionList);\n\t\t\t\t\t\tthis.sortSections();\n\n\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t'BX.Calendar.Rooms:create',\n\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: { roomsList: roomList }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.setLocationSelector(roomList);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tBX.Calendar.Util.displayError(response.errors);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t});\n\t}\n\n\tupdateRoom(params)\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tparams.name = this.checkName(params.name);\n\t\t\tparams.capacity = this.checkCapacity(params.capacity);\n\t\t\tparams.necessity = (params.necessity && params.capacity !== 0) ? 'Y' : 'N';\n\n\t\t\tBX.ajax.runAction('calendar.api.locationajax.updateRoom', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: params.id,\n\t\t\t\t\t\tlocation_id: params.location_id,\n\t\t\t\t\t\tname: params.name,\n\t\t\t\t\t\tcapacity: params.capacity,\n\t\t\t\t\t\tnecessity: params.necessity,\n\t\t\t\t\t\tcolor: params.color,\n\t\t\t\t\t\taccess: params.access || null\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst roomList = response.data.rooms || [];\n\t\t\t\t\t\tconst sectionList = response.data.sections || [];\n\t\t\t\t\t\tthis.setRooms(roomList);\n\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\tthis.setSections(sectionList);\n\t\t\t\t\t\tthis.sortSections();\n\t\t\t\t\t\tthis.unsetHiddenRoom(params.id)\n\n\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t'BX.Calendar.Rooms:update',\n\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: { roomsList: roomList }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.setLocationSelector(roomList);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tBX.Calendar.Util.displayError(response.errors);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t}\n\n\tdeleteRoom(id, location_id)\n\t{\n\t\tif (confirm(BX.message('EC_ROOM_DELETE_CONFIRM')))\n\t\t{\n\t\t\tconst EventAlias = Util.getBX().Event;\n\t\t\tEventAlias.EventEmitter.emit(\n\t\t\t\t'BX.Calendar.Section:delete',\n\t\t\t\tnew EventAlias.BaseEvent({data: {sectionId: id}})\n\t\t\t);\n\t\t\treturn new Promise(resolve => {\n\t\t\t\tBX.ajax.runAction('calendar.api.locationajax.deleteRoom', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\tlocation_id: location_id\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.then(\n\t\t\t\t\t\t(response) => {\n\t\t\t\t\t\t\tconst roomList = response.data.rooms || [];\n\t\t\t\t\t\t\tconst sectionList = response.data.sections || [];\n\t\t\t\t\t\t\tif (!roomList.length)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.setRooms(roomList);\n\t\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\t\tthis.setSections(sectionList);\n\t\t\t\t\t\t\tthis.sortSections();\n\n\t\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t\t'BX.Calendar.Rooms:delete',\n\t\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\tid: id\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.setLocationSelector(roomList);\n\t\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t(response) => {\n\t\t\t\t\t\t\tBX.Calendar.Util.displayError(response.errors);\n\t\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckName(name)\n\t{\n\t\tif (typeof name === 'string')\n\t\t{\n\t\t\tname = name.trim();\n\t\t\tif (RoomsManager.isEmpty(name))\n\t\t\t{\n\t\t\t\tname = Loc.getMessage('EC_SEC_SLIDER_NEW_ROOM');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tname = Loc.getMessage('EC_SEC_SLIDER_NEW_ROOM');\n\t\t}\n\t\treturn name;\n\t}\n\n\tcheckCapacity(capacity)\n\t{\n\t\tif (RoomsManager.isEmpty(capacity) || capacity <= 0 || capacity >= 10000)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\t\treturn capacity;\n\t}\n\n\tgetRoomsInfo()\n\t{\n\t\tconst allActive = [];\n\t\tconst superposed = [];\n\t\tconst active = [];\n\t\tconst hidden = [];\n\n\t\tthis.rooms.forEach((room) => {\n\t\t\tif (room.isShown() && this.calendarType === 'location' && room.type === 'location')\n\t\t\t{\n\t\t\t\tif (room.isSuperposed())\n\t\t\t\t{\n\t\t\t\t\tsuperposed.push(room.id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tactive.push(room.id);\n\t\t\t\t}\n\t\t\t\tallActive.push(room.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thidden.push(room.id);\n\t\t\t}\n\t\t});\n\n\t\treturn { superposed, active, hidden, allActive };\n\t}\n\n\tgetRoomName(id)\n\t{\n\t\tif (RoomsManager.isEmpty(id))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst room = this.getRoom(id);\n\t\treturn room.name;\n\t}\n\n\tunsetHiddenRoom(id)\n\t{\n\t\tif (id)\n\t\t{\n\t\t\tthis.room = this.getRoom(id)\n\t\t\tif (!this.room.isShown())\n\t\t\t{\n\t\t\t\tthis.room.show();\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t}\n\n\thandlePullRoomChanges(params)\n\t{\n\t\tif (params.command === 'delete_room')\n\t\t{\n\t\t\tconst roomId = parseInt(params.ID, 10);\n\t\t\tif (this.roomsIndex[roomId])\n\t\t\t{\n\t\t\t\tthis.deleteRoomHandler(roomId);\n\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t'BX.Calendar.Rooms:pull-delete',\n\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: { roomId: roomId }\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.reloadRoomData();\n\t\t\t}\n\t\t}\n\t\telse if (params.command === 'create_room')\n\t\t{\n\t\t\tthis.reloadRoomData().then(this.reloadData().then(() => {\n\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t'BX.Calendar.Rooms:pull-create'\n\t\t\t\t);\n\t\t\t})\n\t\t)\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar:doRefresh');\n\t\t}\n\t\telse if (params.command === 'update_room')\n\t\t{\n\t\t\tthis.reloadRoomData().then(this.reloadData().then(() => {\n\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t'BX.Calendar.Rooms:pull-update'\n\t\t\t\t);\n\t\t\t})\n\t\t)\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar:doRefresh');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.reloadRoomData().then(this.reloadData);\n\t\t}\n\t}\n\n\tdeleteRoomHandler(id)\n\t{\n\t\tif (this.roomsIndex[id] !== undefined)\n\t\t{\n\t\t\tthis.rooms.splice(this.roomsIndex[id], 1);\n\t\t\tfor (let i = 0; i < this.rooms.length; i++)\n\t\t\t{\n\t\t\t\tthis.roomsIndex[this.rooms[i].id] = i;\n\t\t\t}\n\t\t}\n\t\tif (this.sectionIndex[id] !== undefined)\n\t\t{\n\t\t\tthis.sections.splice(this.sectionIndex[id], 1);\n\t\t\tfor (let i = 0; i < this.sections.length; i++)\n\t\t\t{\n\t\t\t\tthis.sectionIndex[this.sections[i].id] = i;\n\t\t\t}\n\t\t}\n\t}\n\n\treloadRoomData()\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tBX.ajax.runAction('calendar.api.locationajax.getRoomsList')\n\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.setRooms(response.data.rooms || []);\n\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\tBX.Calendar.Controls.Location.setLocationList(response.data.rooms);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t// Failure\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t}\n\n\tgetLocationAccess()\n\t{\n\t\treturn this.locationAccess;\n\t}\n\n\tsetLocationSelector(roomList)\n\t{\n\t\tBX.Calendar.Controls.Location.setLocationList(roomList);\n\t\tif (this.locationContext !== null)\n\t\t{\n\t\t\tthis.locationContext.setValues();\n\t\t}\n\t}\n\n\tstatic isEmpty(param)\n\t{\n\t\tif (Type.isArray(param))\n\t\t{\n\t\t\treturn !param.length;\n\t\t}\n\t\treturn param === null || param === undefined || param === '' || param === [] || param === {};\n\t}\n}"],"names":["RoomsSection","data","updateData","calendarContext","Util","getCalendarContext","type","CAL_TYPE","necessity","NECESSITY","capacity","parseInt","CAPACITY","ownerId","OWNER_ID","id","ID","location_id","LOCATION_ID","color","COLOR","name","NAME","CalendarSection","RoomsManager","config","locationAccess","locationContext","setRooms","rooms","setConfig","sortRooms","setSections","sections","sortSections","EventEmitter","subscribeOnce","deleteRoomHandler","bind","roomsIndex","sort","a","b","toLowerCase","forEach","room","i","getId","params","roomData","push","length","Promise","resolve","checkName","checkCapacity","BX","ajax","runAction","access","then","response","roomList","sectionList","getBX","Event","emit","BaseEvent","roomsList","setLocationSelector","Calendar","displayError","errors","unsetHiddenRoom","confirm","message","EventAlias","sectionId","reload","trim","isEmpty","Loc","getMessage","allActive","superposed","active","hidden","isShown","calendarType","isSuperposed","getRoom","show","command","roomId","reloadRoomData","reloadData","undefined","splice","sectionIndex","Controls","Location","setLocationList","setValues","param","Type","isArray","SectionManager"],"mappings":"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"}