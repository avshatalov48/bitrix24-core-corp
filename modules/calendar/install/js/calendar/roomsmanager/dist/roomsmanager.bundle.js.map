{"version":3,"file":"roomsmanager.bundle.js","sources":["../src/roomssection.js","../src/roomsmanager.js"],"sourcesContent":["import { Util } from 'calendar.util';\nimport { CalendarSection } from 'calendar.sectionmanager';\n\nexport class RoomsSection extends CalendarSection\n{\n\tconstructor(data)\n\t{\n\t\tsuper(data);\n\t\tthis.updateData(data);\n\t\tthis.calendarContext = Util.getCalendarContext();\n\t\t// this.roomsManager = this.calendarContext.roomsManager;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tthis.data = data || {};\n\t\tthis.type = data.CAL_TYPE || '';\n\t\tthis.necessity = data.NECESSITY || 'N';\n\t\tthis.capacity = parseInt(data.CAPACITY) || 0;\n\t\tthis.ownerId = parseInt(data.OWNER_ID) || 0;\n\t\tthis.id = parseInt(data.ID);\n\t\tthis.location_id = parseInt(data.LOCATION_ID);\n\t\tthis.color = this.data.COLOR;\n\t\tthis.name = this.data.NAME;\n\t\tthis.categoryId = parseInt(this.data.CATEGORY_ID);\n\t\tthis.reserved = this.data.reserved || false;\n\t}\n\n\tbelongsToView()\n\t{\n\t\treturn true;\n\t}\n}","import {Type, Loc, Event, Runtime } from 'main.core';\nimport { SectionManager } from 'calendar.sectionmanager';\nimport { Util } from 'calendar.util';\nimport { RoomsSection } from './roomssection';\nimport { EventEmitter } from 'main.core.events';\nexport { RoomsSection };\n\nexport class RoomsManager extends SectionManager\n{\n\tconstructor(data, config)\n\t{\n\t\tsuper(data, config);\n\t\tthis.locationAccess = config.locationAccess || false;\n\t\tthis.locationContext = config.locationContext || null;\n\t\tthis.setRooms(data.rooms);\n\t\tthis.setConfig(config);\n\t\tthis.sortRooms();\n\t\tthis.setSections(data.sections);\n\t\tthis.sortSections();\n\t\tthis.reloadRoomsFromDatabaseDebounce = Runtime.debounce(this.reloadRoomsFromDatabase, SectionManager.RELOAD_DELAY, this);\n\n\t\tEventEmitter.subscribeOnce('BX.Calendar.Rooms:delete', this.deleteRoomHandler.bind(this));\n\t}\n\n\tsortRooms()\n\t{\n\t\tthis.roomsIndex = {};\n\t\tthis.rooms = this.rooms.sort((a, b) => {\n\t\t\tif (a.name.toLowerCase() > b.name.toLowerCase())\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tif (a.name.toLowerCase() < b.name.toLowerCase())\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn 0;\n\t\t});\n\n\t\tthis.rooms.forEach((room, i) => {\n\t\t\tthis.roomsIndex[room.getId()] = i;\n\t\t});\n\t}\n\n\tsetRooms(params = [])\n\t{\n\t\tthis.rooms = [];\n\t\tthis.roomsIndex = {};\n\t\tparams.forEach((roomData) => {\n\t\t\tlet room = new RoomsSection(roomData);\n\t\t\tthis.rooms.push(room);\n\t\t\tthis.roomsIndex[room.getId()] = this.rooms.length - 1;\n\t\t});\n\t}\n\n\tgetRooms()\n\t{\n\t\treturn this.rooms;\n\t}\n\n\tgetRoom(id)\n\t{\n\t\treturn this.rooms[this.roomsIndex[id]];\n\t}\n\n\tcreateRoom(params)\n\t{\n\t\treturn new Promise(resolve => {\n\n\t\t\tparams.name = this.checkName(params.name);\n\t\t\tparams.capacity = this.checkCapacity(params.capacity);\n\t\t\tparams.necessity = (params.necessity && params.capacity !== 0) ? 'Y' : 'N';\n\n\t\t\tBX.ajax.runAction('calendar.api.locationajax.createRoom', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tname: params.name,\n\t\t\t\t\t\tcapacity: params.capacity,\n\t\t\t\t\t\tnecessity: params.necessity,\n\t\t\t\t\t\townerId: this.ownerId,\n\t\t\t\t\t\tcolor: params.color,\n\t\t\t\t\t\taccess: params.access || null,\n\t\t\t\t\t\tcategoryId: params.categoryId,\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst roomList = response.data.rooms || [];\n\t\t\t\t\t\tconst sectionList = response.data.sections || [];\n\t\t\t\t\t\tthis.setRooms(roomList);\n\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\tthis.setSections(sectionList);\n\t\t\t\t\t\tthis.sortSections();\n\n\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t'BX.Calendar.Rooms:create',\n\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: { roomsList: roomList }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.setLocationSelector(roomList);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tBX.Calendar.Util.displayError(response.errors);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t});\n\t}\n\n\tupdateRoom(params)\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tparams.name = this.checkName(params.name);\n\t\t\tparams.capacity = this.checkCapacity(params.capacity);\n\t\t\tparams.necessity = (params.necessity && params.capacity !== 0) ? 'Y' : 'N';\n\n\t\t\tBX.ajax.runAction('calendar.api.locationajax.updateRoom', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: params.id,\n\t\t\t\t\t\tlocation_id: params.location_id,\n\t\t\t\t\t\tname: params.name,\n\t\t\t\t\t\tcapacity: params.capacity,\n\t\t\t\t\t\tnecessity: params.necessity,\n\t\t\t\t\t\tcolor: params.color,\n\t\t\t\t\t\taccess: params.access || null,\n\t\t\t\t\t\tcategoryId: params.categoryId,\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst roomList = response.data.rooms || [];\n\t\t\t\t\t\tconst sectionList = response.data.sections || [];\n\t\t\t\t\t\tthis.setRooms(roomList);\n\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\tthis.setSections(sectionList);\n\t\t\t\t\t\tthis.sortSections();\n\t\t\t\t\t\tthis.unsetHiddenRoom(params.id)\n\n\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t'BX.Calendar.Rooms:update',\n\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: { roomsList: roomList }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.setLocationSelector(roomList);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tBX.Calendar.Util.displayError(response.errors);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t}\n\n\tdeleteRoom(id, location_id)\n\t{\n\t\tif (confirm(BX.message('EC_ROOM_DELETE_CONFIRM')))\n\t\t{\n\t\t\tconst EventAlias = Util.getBX().Event;\n\t\t\tEventAlias.EventEmitter.emit(\n\t\t\t\t'BX.Calendar.Section:delete',\n\t\t\t\tnew EventAlias.BaseEvent({data: {sectionId: id}})\n\t\t\t);\n\t\t\treturn new Promise(resolve => {\n\t\t\t\tBX.ajax.runAction('calendar.api.locationajax.deleteRoom', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\tlocation_id: location_id\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.then(\n\t\t\t\t\t\t(response) => {\n\t\t\t\t\t\t\tconst roomList = response.data.rooms || [];\n\t\t\t\t\t\t\tconst sectionList = response.data.sections || [];\n\t\t\t\t\t\t\tif (!roomList.length)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.setRooms(roomList);\n\t\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\t\tthis.setSections(sectionList);\n\t\t\t\t\t\t\tthis.sortSections();\n\n\t\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t\t'BX.Calendar.Rooms:delete',\n\t\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\tid: id\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.setLocationSelector(roomList);\n\t\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t(response) => {\n\t\t\t\t\t\t\tBX.Calendar.Util.displayError(response.errors);\n\t\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckName(name)\n\t{\n\t\tif (typeof name === 'string')\n\t\t{\n\t\t\tname = name.trim();\n\t\t\tif (RoomsManager.isEmpty(name))\n\t\t\t{\n\t\t\t\tname = Loc.getMessage('EC_SEC_SLIDER_NEW_ROOM');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tname = Loc.getMessage('EC_SEC_SLIDER_NEW_ROOM');\n\t\t}\n\t\treturn name;\n\t}\n\n\tcheckCapacity(capacity)\n\t{\n\t\tif (RoomsManager.isEmpty(capacity) || capacity <= 0 || capacity >= 10000)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\t\treturn capacity;\n\t}\n\n\tgetRoomsInfo()\n\t{\n\t\tconst allActive = [];\n\t\tconst superposed = [];\n\t\tconst active = [];\n\t\tconst hidden = [];\n\n\t\tthis.rooms.forEach((room) => {\n\t\t\tif (room.isShown() && this.calendarType === 'location' && room.type === 'location')\n\t\t\t{\n\t\t\t\tif (room.isSuperposed())\n\t\t\t\t{\n\t\t\t\t\tsuperposed.push(room.id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tactive.push(room.id);\n\t\t\t\t}\n\t\t\t\tallActive.push(room.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thidden.push(room.id);\n\t\t\t}\n\t\t});\n\n\t\treturn { superposed, active, hidden, allActive };\n\t}\n\n\tgetRoomName(id)\n\t{\n\t\tif (RoomsManager.isEmpty(id))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst room = this.getRoom(id);\n\t\treturn room.name;\n\t}\n\n\tunsetHiddenRoom(id)\n\t{\n\t\tif (id)\n\t\t{\n\t\t\tconst room = this.getRoom(id)\n\t\t\tif (room.calendarContext && !room.isShown())\n\t\t\t{\n\t\t\t\troom.show();\n\t\t\t}\n\t\t}\n\t}\n\n\thandlePullRoomChanges(params)\n\t{\n\t\tif (params.command === 'delete_room')\n\t\t{\n\t\t\tconst roomId = parseInt(params.ID, 10);\n\t\t\tif (this.roomsIndex[roomId])\n\t\t\t{\n\t\t\t\tthis.deleteRoomHandler(roomId);\n\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t'BX.Calendar.Rooms:pull-delete',\n\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: { roomId: roomId }\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.reloadRoomsFromDatabaseDebounce();\n\t\t\t}\n\t\t}\n\t\telse if (params.command === 'create_room')\n\t\t{\n\t\t\tthis.reloadRoomsFromDatabase().then(this.reloadDataDebounce());\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar.Rooms:pull-create');\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar:doRefresh');\n\t\t}\n\t\telse if (params.command === 'update_room')\n\t\t{\n\t\t\tthis.reloadRoomsFromDatabase().then(this.reloadDataDebounce());\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar.Rooms:pull-update');\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar:doRefresh');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.reloadRoomsFromDatabase().then(this.reloadDataDebounce());\n\t\t}\n\t}\n\n\tdeleteRoomHandler(id)\n\t{\n\t\tif (this.roomsIndex[id] !== undefined)\n\t\t{\n\t\t\tthis.rooms.splice(this.roomsIndex[id], 1);\n\t\t\tfor (let i = 0; i < this.rooms.length; i++)\n\t\t\t{\n\t\t\t\tthis.roomsIndex[this.rooms[i].id] = i;\n\t\t\t}\n\t\t}\n\t\tif (this.sectionIndex[id] !== undefined)\n\t\t{\n\t\t\tthis.sections.splice(this.sectionIndex[id], 1);\n\t\t\tfor (let i = 0; i < this.sections.length; i++)\n\t\t\t{\n\t\t\t\tthis.sectionIndex[this.sections[i].id] = i;\n\t\t\t}\n\t\t}\n\t}\n\n\treloadRoomsFromDatabase()\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tBX.ajax.runAction('calendar.api.locationajax.getRoomsList')\n\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.setRooms(response.data.rooms || []);\n\t\t\t\t\t\tthis.sortRooms();\n\t\t\t\t\t\tBX.Calendar.Controls.Location.setLocationList(response.data.rooms);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t// Failure\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t}\n\n\tgetLocationAccess()\n\t{\n\t\treturn this.locationAccess;\n\t}\n\n\tsetLocationSelector(roomList)\n\t{\n\t\tBX.Calendar.Controls.Location.setLocationList(roomList);\n\t\tif (this.locationContext !== null)\n\t\t{\n\t\t\tthis.locationContext.setValues();\n\t\t}\n\t}\n\n\tstatic isEmpty(param)\n\t{\n\t\tif (Type.isArray(param))\n\t\t{\n\t\t\treturn !param.length;\n\t\t}\n\t\treturn param === null || param === undefined || param === '' || param === [] || param === {};\n\t}\n}"],"names":["RoomsSection","CalendarSection","constructor","data","updateData","calendarContext","Util","getCalendarContext","type","CAL_TYPE","necessity","NECESSITY","capacity","parseInt","CAPACITY","ownerId","OWNER_ID","id","ID","location_id","LOCATION_ID","color","COLOR","name","NAME","categoryId","CATEGORY_ID","reserved","belongsToView","RoomsManager","SectionManager","config","locationAccess","locationContext","setRooms","rooms","setConfig","sortRooms","setSections","sections","sortSections","reloadRoomsFromDatabaseDebounce","Runtime","debounce","reloadRoomsFromDatabase","RELOAD_DELAY","EventEmitter","subscribeOnce","deleteRoomHandler","bind","roomsIndex","sort","a","b","toLowerCase","forEach","room","i","getId","params","roomData","push","length","getRooms","getRoom","createRoom","Promise","resolve","checkName","checkCapacity","BX","ajax","runAction","access","then","response","roomList","sectionList","getBX","Event","emit","BaseEvent","roomsList","setLocationSelector","Calendar","displayError","errors","updateRoom","unsetHiddenRoom","deleteRoom","confirm","message","EventAlias","sectionId","reload","trim","isEmpty","Loc","getMessage","getRoomsInfo","allActive","superposed","active","hidden","isShown","calendarType","isSuperposed","getRoomName","show","handlePullRoomChanges","command","roomId","reloadDataDebounce","undefined","splice","sectionIndex","Controls","Location","setLocationList","getLocationAccess","setValues","param","Type","isArray"],"mappings":"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"}