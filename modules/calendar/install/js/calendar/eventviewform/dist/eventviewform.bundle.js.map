{"version":3,"file":"eventviewform.bundle.js","sources":["../src/eventviewform.js"],"sourcesContent":["\"use strict\";\n\nimport { Util } from 'calendar.util';\nimport { Type, Event, Loc, Tag, Dom, Runtime, Text } from 'main.core';\nimport { Entry, EntryManager } from 'calendar.entry';\nimport { MeetingStatusControl, Reminder } from 'calendar.controls';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Planner } from 'calendar.planner';\nimport { ControlButton } from 'intranet.control-button';\n\nexport class EventViewForm {\n\tpermissions = {};\n\tname = 'eventviewform';\n\tuid = null;\n\tDOM = {};\n\tRELOAD_REQUESTED = 'RELOAD_REQUESTED';\n\tRELOAD_FINISHED = 'RELOAD_FINISHED';\n\treloadStatus = null;\n\tentityChanged = false;\n\tLOAD_DELAY = 500;\n\n\tconstructor(options = {})\n\t{\n\t\tthis.type = options.type || 'user';\n\t\tthis.ownerId = options.ownerId || 0;\n\t\tthis.userId = options.userId || 0;\n\t\tthis.zIndex = 3100;\n\t\tthis.entryId = options.entryId || null;\n\t\tthis.calendarContext = options.calendarContext || null;\n\t\tthis.entryDateFrom = options.entryDateFrom || null;\n\t\tthis.timezoneOffset = options.timezoneOffset || null;\n\t\tthis.BX = Util.getBX();\n\n\t\tthis.sliderOnLoad = this.onLoadSlider.bind(this);\n\t\tthis.handlePullBind = this.handlePull.bind(this);\n\t\tthis.keyHandlerBind = this.keyHandler.bind(this);\n\t\tthis.destroyBind = this.destroy.bind(this);\n\n\t\tthis.loadPlannerDataDebounce = Runtime.debounce(this.loadPlannerData, this.LOAD_DELAY, this);\n\t\tthis.reloadSliderDebounce = Runtime.debounce(this.reloadSlider, this.LOAD_DELAY, this);\n\n\t\tthis.pullEventList = new Set();\n\t}\n\n\tinitInSlider(slider, promiseResolve)\n\t{\n\t\tthis.slider = slider;\n\t\tEventEmitter.subscribe(slider, \"SidePanel.Slider:onLoad\", this.sliderOnLoad);\n\t\tEventEmitter.subscribe(slider, \"SidePanel.Slider:onCloseComplete\", this.destroyBind);\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBind);\n\t\tEvent.bind(document, 'visibilitychange', this.handleVisibilityChange.bind(this));\n\n\t\tEventEmitter.subscribe('onPullEvent-calendar', this.handlePullBind);\n\n\t\tthis.createContent(slider).then(function(html)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(promiseResolve))\n\t\t\t\t{\n\t\t\t\t\tpromiseResolve(html);\n\t\t\t\t}\n\t\t\t}.bind(this)\n\t\t);\n\n\t\tthis.opened = true;\n\t}\n\n\tisOpened()\n\t{\n\t\treturn this.opened;\n\t}\n\n\tdestroy()\n\t{\n\t\tEventEmitter.unsubscribe(this.slider, \"SidePanel.Slider:onLoad\", this.sliderOnLoad);\n\t\tEventEmitter.unsubscribe(this.slider, \"SidePanel.Slider:onCloseComplete\", this.destroyBind);\n\t\tEventEmitter.unsubscribe('onPullEvent-calendar', this.handlePullBind);\n\t\tEvent.unbind(document, 'keydown', this.keyHandlerBind);\n\n\t\tif (this.intranetControllButton && this.intranetControllButton.destroy)\n\t\t{\n\t\t\tthis.intranetControllButton.destroy();\n\t\t}\n\n\t\t// this.BX.SidePanel.Instance.destroy(this.sliderId);\n\t\tUtil.closeAllPopups();\n\t\tthis.opened = false;\n\t}\n\n\tonLoadSlider(event)\n\t{\n\t\tif (!event instanceof BaseEvent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst data = event.getData();\n\t\tconst slider = data[0]?.slider;\n\n\t\tthis.DOM.content = slider.layout.content;\n\n\t\t// Used to execute javasctipt and attach CSS from ajax responce\n\t\tthis.BX.html(slider.layout.content, slider.getData().get(\"sliderContent\"));\n\t\tif (!Type.isNull(this.uid))\n\t\t{\n\t\t\tthis.initControls(this.uid);\n\t\t}\n\n\t\tthis.reloadStatus = this.RELOAD_FINISHED;\n\t}\n\n\tcreateContent(slider)\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.getViewEventSlider', {\n\t\t\t\tanalyticsLabel: {calendarAction: 'view_event', formType: 'full'},\n\t\t\t\tdata: {\n\t\t\t\t\tentryId: this.entryId,\n\t\t\t\t\tdateFrom: Util.formatDate(this.entryDateFrom),\n\t\t\t\t\ttimezoneOffset: this.timezoneOffset\n\t\t\t\t}\n\t\t\t}).then(\n\t\t\t\tresponse => {\n\t\t\t\t\tlet html = '';\n\t\t\t\t\tif ((Type.isFunction(slider.isOpen) && slider.isOpen()) || slider.isOpen === true)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = response.data.html;\n\t\t\t\t\t\tslider.getData().set(\"sliderContent\", html);\n\t\t\t\t\t\tlet params = response.data.additionalParams;\n\n\t\t\t\t\t\tthis.userId = params.userId;\n\t\t\t\t\t\tthis.uid = params.uniqueId;\n\t\t\t\t\t\tthis.entryUrl = params.entryUrl;\n\t\t\t\t\t\tthis.userTimezone = params.userTimezone;\n\t\t\t\t\t\tthis.dayOfWeekMonthFormat = params.dayOfWeekMonthFormat;\n\t\t\t\t\t\tthis.plannerFeatureEnabled = !!params.plannerFeatureEnabled;\n\t\t\t\t\t\tif (this.planner && !this.plannerFeatureEnabled)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.planner.lock();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.handleEntryData(params.entry, params.userIndex, params.section);\n\t\t\t\t\t}\n\t\t\t\t\tresolve(html);\n\t\t\t\t},\n\t\t\t\tresponse => {\n\t\t\t\t\tif (response.errors && response.errors.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tslider.getData().set(\n\t\t\t\t\t\t\t\"sliderContent\",\n\t\t\t\t\t\t\t'<div class=\"calendar-slider-alert\">'\n\t\t\t\t\t\t\t\t+ '<div class=\"calendar-slider-alert-inner\">'\n\t\t\t\t\t\t\t\t\t+ '<div class=\"calendar-slider-alert-img\"></div>'\n\t\t\t\t\t\t\t\t\t+ '<h1 class=\"calendar-slider-alert-text\">' + Text.encode(response.errors[0].message) + '</h1>'\n\t\t\t\t\t\t\t\t+ '</div>'\n\t\t\t\t\t\t\t+ '</div>'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.displayError(response.errors);\n\t\t\t\t\tresolve(response);\n\t\t\t\t});\n\t\t});\n\t}\n\n\tinitControls(uid)\n\t{\n\t\tthis.DOM.title = this.DOM.content.querySelector(`#${uid}_title`);\n\t\tthis.DOM.buttonSet = this.DOM.content.querySelector(`#${uid}_buttonset`);\n\t\tthis.DOM.editButton = this.DOM.content.querySelector(`#${uid}_but_edit`);\n\t\tthis.DOM.delButton = this.DOM.content.querySelector(`#${uid}_but_del`);\n\t\tthis.DOM.sidebarInner = this.DOM.content.querySelector(`#${uid}_sidebar_inner`);\n\n\t\tif (this.DOM.buttonSet)\n\t\t{\n\t\t\tthis.initPlannerControl(uid);\n\t\t\tthis.initUserListControl(uid);\n\t\t}\n\n\t\tconst innerTimeWrap = this.DOM.content.querySelector(`#${uid}_time_inner_wrap`);\n\t\tif (Type.isElementNode(innerTimeWrap) && innerTimeWrap.offsetHeight > 50)\n\t\t{\n\t\t\tDom.addClass(this.DOM.content.querySelector(`#${uid}_time_wrap`), 'calendar-slider-sidebar-head-long-time');\n\t\t}\n\n\t\tif (this.canDo(this.entry, 'edit') && this.DOM.editButton)\n\t\t{\n\t\t\tEvent.bind(this.DOM.editButton, 'click', () => {\n\t\t\t\tthis.BX.SidePanel.Instance.close(false, function ()\n\t\t\t\t{\n\t\t\t\t\tEntryManager.openEditSlider({\n\t\t\t\t\t\tentry: this.entry,\n\t\t\t\t\t\ttype: this.type,\n\t\t\t\t\t\townerId: this.ownerId,\n\t\t\t\t\t\tuserId: this.userId\n\t\t\t\t\t});\n\t\t\t\t}.bind(this));\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.BX.remove(this.DOM.editButton);\n\t\t}\n\n\t\tif (this.DOM.sidebarInner)\n\t\t{\n\t\t\t// Reminder\n\t\t\tthis.DOM.reminderWrap = this.DOM.sidebarInner.querySelector('.calendar-slider-sidebar-remind-wrap');\n\t\t\tif (Type.isDomNode(this.DOM.reminderWrap))\n\t\t\t{\n\t\t\t\tlet viewMode = !this.canDo(this.entry, 'edit')\n\t\t\t\t\t&& this.entry.getCurrentStatus() === false;\n\n\t\t\t\tthis.reminderControl = new this.BX.Calendar.Controls.Reminder({\n\t\t\t\t\twrap: this.DOM.reminderWrap,\n\t\t\t\t\tzIndex: this.zIndex,\n\t\t\t\t\tviewMode: viewMode\n\t\t\t\t});\n\t\t\t\tthis.reminderControl.setValue(this.entry.getReminders());\n\n\t\t\t\tif (!viewMode)\n\t\t\t\t{\n\t\t\t\t\tthis.reminderControl.subscribe('onChange', (event) => {\n\t\t\t\t\t\tif (event instanceof BaseEvent)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.handleEntityChanges();\n\t\t\t\t\t\t\tthis.reminderValues = event.getData().values;\n\t\t\t\t\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.updateReminders', {\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tentryId: this.entry.id,\n\t\t\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\t\t\treminders: this.reminderValues\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet items = this.DOM.sidebarInner.querySelectorAll('.calendar-slider-sidebar-border-bottom');\n\t\t\tif (items.length >= 2)\n\t\t\t{\n\t\t\t\tthis.BX.removeClass(items[items.length - 1], 'calendar-slider-sidebar-border-bottom');\n\t\t\t}\n\t\t}\n\t\tif (this.canDo(this.entry, 'delete'))\n\t\t{\n\t\t\tEvent.bind(this.DOM.delButton, 'click', ()=>{\n\t\t\t\tEventEmitter.subscribeOnce('BX.Calendar.Entry:beforeDelete', ()=>{\n\t\t\t\t\tthis.BX.SidePanel.Instance.close();\n\t\t\t\t});\n\t\t\t\tEntryManager.deleteEntry(this.entry, this.calendarContext);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.BX.remove(this.DOM.delButton);\n\t\t}\n\n\t\tthis.BX.viewElementBind(\n\t\t\tuid + '_' + this.entry.id + '_files_wrap',\n\t\t\t{\n\t\t\t\tshowTitle: true\n\t\t\t},\n\t\t\tfunction(node)\n\t\t\t{\n\t\t\t\treturn Type.isElementNode(node) && (node.getAttribute('data-bx-viewer') || node.getAttribute('data-bx-image'));\n\t\t\t}\n\t\t);\n\n\t\tif (this.entry && this.entry.isMeeting())\n\t\t{\n\t\t\tthis.initAcceptMeetingControl(uid);\n\t\t}\n\n\t\tif (this.DOM.sidebarInner)\n\t\t{\n\t\t\tlet items = this.DOM.sidebarInner.querySelectorAll('.calendar-slider-sidebar-border-bottom');\n\t\t\tif (items.length >= 2)\n\t\t\t{\n\t\t\t\tthis.BX.removeClass(items[items.length - 1], 'calendar-slider-sidebar-border-bottom');\n\t\t\t}\n\t\t}\n\n\t\tthis.DOM.copyButton = this.DOM.content.querySelector(`#${uid}_copy_url_btn`);\n\t\tif (this.DOM.copyButton)\n\t\t{\n\t\t\tEvent.bind(this.DOM.copyButton, 'click', this.copyEventUrl.bind(this));\n\t\t}\n\n\t\t// Init \"Videocall\" control\n\t\tthis.DOM.videoCall = this.DOM.sidebarInner.querySelector('.calendar-slider-sidebar-videocall');\n\t\tif (\n\t\t\tBX?.Intranet?.ControlButton\n\t\t\t&& Type.isElementNode(this.DOM.videoCall)\n\t\t\t&& this.entry.getCurrentStatus() !== false\n\t\t)\n\t\t{\n\t\t\tthis.DOM.videoCall.style.display = '';\n\t\t\tthis.intranetControllButton = new ControlButton({\n\t\t\t\tcontainer: this.DOM.videoCall,\n\t\t\t\tentityType: 'calendar_event',\n\t\t\t\tentityId: this.entry.parentId,\n\t\t\t\tentityData: {\n\t\t\t\t\tdateFrom: Util.formatDate(this.entry.from),\n\t\t\t\t\tparentId: this.entry.parentId\n\t\t\t\t},\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tformType: 'full'\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\thandleEntryData(entryData, userIndex, sectionData)\n\t{\n\t\tthis.entry = new Entry({data: entryData, userIndex: userIndex});\n\n\t\tif (Type.isPlainObject(sectionData))\n\t\t{\n\t\t\tthis.permissions = sectionData.PERM;\n\t\t}\n\n\t\tEntryManager.registerEntrySlider(this.entry, this);\n\t}\n\n\tinitPlannerControl(uid)\n\t{\n\t\tthis.plannerId = uid + '_view_slider_planner';\n\t\tthis.DOM.plannerWrapOuter = this.DOM.content.querySelector(`.calendar-slider-detail-timeline`);\n\t\tthis.DOM.plannerWrap = this.DOM.plannerWrapOuter.querySelector(`.calendar-view-planner-wrap`);\n\n\t\tthis.planner = new Planner({\n\t\t\twrap: this.DOM.plannerWrap,\n\t\t\tminWidth: parseInt(this.DOM.plannerWrap.offsetWidth),\n\t\t\tsolidStatus: true,\n\t\t\treadonly: true,\n\t\t\tlocked: !this.plannerFeatureEnabled,\n\t\t\tdayOfWeekMonthFormat: this.dayOfWeekMonthFormat\n\t\t});\n\n\t\tthis.planner.show();\n\t\tthis.planner.showLoader();\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.DOM.plannerWrapOuter)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.DOM.plannerWrapOuter, 'hidden');\n\t\t\t}\n\t\t}, 500);\n\n\t\tthis.loadPlannerDataDebounce();\n\t}\n\n\tinitUserListControl(uid)\n\t{\n\t\tlet userList = {y : [], i: [], q: [], n: []};\n\n\t\tif (this.entry.isMeeting())\n\t\t{\n\t\t\tthis.entry.getAttendees().forEach(function(user)\n\t\t\t{\n\t\t\t\tif (user.STATUS === 'H')\n\t\t\t\t{\n\t\t\t\t\tuserList.y.push(user);\n\t\t\t\t}\n\t\t\t\telse if (userList[user.STATUS.toLowerCase()])\n\t\t\t\t{\n\t\t\t\t\tuserList[user.STATUS.toLowerCase()].push(user);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.DOM.attendeesListY = this.DOM.content.querySelector(`#${uid}_attendees_y`);\n\t\tthis.DOM.attendeesListN = this.DOM.content.querySelector(`#${uid}_attendees_n`);\n\t\tthis.DOM.attendeesListQ = this.DOM.content.querySelector(`#${uid}_attendees_q`);\n\t\tthis.DOM.attendeesListI = this.DOM.content.querySelector(`#${uid}_attendees_i`);\n\n\t\tEvent.bind(this.DOM.attendeesListY, 'click', ()=>{this.showUserListPopup(this.DOM.attendeesListY, userList.y);});\n\t\tEvent.bind(this.DOM.attendeesListN, 'click', ()=>{this.showUserListPopup(this.DOM.attendeesListN, userList.n);});\n\t\tEvent.bind(this.DOM.attendeesListQ, 'click', ()=>{this.showUserListPopup(this.DOM.attendeesListQ, userList.q);});\n\t\tEvent.bind(this.DOM.attendeesListI, 'click', ()=>{this.showUserListPopup(this.DOM.attendeesListI, userList.i);});\n\t}\n\n\tshowUserListPopup(node, userList)\n\t{\n\t\tif (this.userListPopup)\n\t\t{\n\t\t\tthis.userListPopup.close();\n\t\t}\n\n\t\tif (userList && userList.length)\n\t\t{\n\t\t\tthis.DOM.userListPopupWrap = this.BX.create('DIV', {props: {className: 'calendar-user-list-popup-block'}});\n\t\t\tuserList.forEach(function (user)\n\t\t\t{\n\t\t\t\tlet userWrap = this.DOM.userListPopupWrap.appendChild(this.BX.create('DIV', {props: {className: 'calendar-slider-sidebar-user-container calendar-slider-sidebar-user-card'}}));\n\n\t\t\t\tuserWrap.appendChild(this.BX.create('DIV', {props: {className: 'calendar-slider-sidebar-user-block-avatar'}}))\n\t\t\t\t\t.appendChild(this.BX.create('DIV', {props: {className: 'calendar-slider-sidebar-user-block-item'}}))\n\t\t\t\t\t.appendChild(this.BX.create('IMG', {props: {width: 34, height: 34, src: user.AVATAR}}));\n\n\t\t\t\tuserWrap.appendChild(this.BX.create(\"DIV\", {props: {className: 'calendar-slider-sidebar-user-info'}}))\n\t\t\t\t\t.appendChild(this.BX.create(\"A\", {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\thref: user.URL ? user.URL : '#',\n\t\t\t\t\t\t\tclassName: 'calendar-slider-sidebar-user-info-name'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: user.DISPLAY_NAME\n\t\t\t\t\t}));\n\t\t\t}, this);\n\n\t\t\tthis.userListPopup = this.BX.PopupWindowManager.create(\"user-list-popup-\" + Math.random(), node, {\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tresizable: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: this.DOM.userListPopupWrap,\n\t\t\t\tclassName: 'calendar-user-list-popup',\n\t\t\t\tzIndex: 4000\n\t\t\t});\n\n\t\t\tthis.userListPopup.setAngle({offset: 36});\n\t\t\tthis.userListPopup.show();\n\t\t\tthis.BX.addCustomEvent(this.userListPopup, 'onPopupClose', ()=>{this.userListPopup.destroy();});\n\t\t}\n\t}\n\n\tinitAcceptMeetingControl(uid)\n\t{\n\t\tthis.DOM.statusButtonset = this.DOM.content.querySelector(`#${uid}_status_buttonset`);\n\t\tthis.DOM.statusButtonset.style.marginRight = '12px';\n\n\t\tif (this.entry.getCurrentStatus() === 'H' || this.entry.getCurrentStatus() === false)\n\t\t{\n\t\t\tDom.remove(this.DOM.statusButtonset);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.statusControl = new MeetingStatusControl(\n\t\t\t{\n\t\t\t\twrap: this.DOM.statusButtonset,\n\t\t\t\tcurrentStatus: this.DOM.content.querySelector(`#${uid}_current_status`).value || this.entry.getCurrentStatus()\n\t\t\t});\n\n\t\t\tthis.statusControl.subscribe('onSetStatus', (event) => {\n\t\t\t\t\tif (event instanceof BaseEvent)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.handleEntityChanges();\n\t\t\t\t\t\tEntryManager.setMeetingStatus(this.entry, event.getData().status)\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tthis.statusControl.setStatus(this.entry.getCurrentStatus(), false);\n\t\t\t\t\t\t\t\tthis.statusControl.updateStatus();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tcopyEventUrl()\n\t{\n\t\tif(!this.entryUrl || !this.BX.clipboard.copy(this.entryUrl))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.timeoutIds = this.timeoutIds || [];\n\t\tlet popup = new this.BX.PopupWindow(\n\t\t\t'calendar_clipboard_copy',\n\t\t\tthis.DOM.copyButton,\n\t\t\t{\n\t\t\t\tcontent: Loc.getMessage('CALENDAR_TIP_TEMPLATE_LINK_COPIED'),\n\t\t\t\tdarkMode: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tzIndex: 1000,\n\t\t\t\tangle: true,\n\t\t\t\toffsetLeft: 20,\n\t\t\t\tcachable: false\n\t\t\t}\n\t\t);\n\t\tpopup.show();\n\n\t\tlet timeoutId;\n\t\twhile(timeoutId = this.timeoutIds.pop())\n\t\t{\n\t\t\tclearTimeout(timeoutId);\n\t\t}\n\t\tthis.timeoutIds.push(setTimeout(function(){popup.close();}, 1500));\n\t}\n\n\tdisplayError(errors = [])\n\t{\n\t\t//errors\n\t}\n\n\tcanDo(entry, action)\n\t{\n\t\tif ((action === 'edit' || action === 'delete'))\n\t\t{\n\t\t\tif (entry.isResourcebooking())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.permissions.edit;\n\t\t}\n\n\t\tif ((action === 'view'))\n\t\t{\n\t\t\treturn this.permissions.view_full;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tplannerIsShown()\n\t{\n\t\treturn this.DOM.plannerWrap && Dom.hasClass(this.DOM.plannerWrap, 'calendar-edit-planner-wrap-shown');\n\t}\n\n\tloadPlannerData()\n\t{\n\t\tthis.planner.showLoader();\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.BX.ajax.runAction('calendar.api.calendarajax.updatePlanner', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tentryId: this.entry.id || 0,\n\t\t\t\t\t\tentryLocation: this.entry.data.LOCATION || '',\n\t\t\t\t\t\townerId: this.ownerId,\n\t\t\t\t\t\thostId: this.entry.getMeetingHost(),\n\t\t\t\t\t\ttype: this.type,\n\t\t\t\t\t\tentityList: this.entry.getAttendeesEntityList(),\n\t\t\t\t\t\tdateFrom: Util.formatDate(this.entry.from.getTime() - Util.getDayLength() * 3),\n\t\t\t\t\t\tdateTo: Util.formatDate(this.entry.to.getTime() + Util.getDayLength() * 10),\n\t\t\t\t\t\ttimezone: this.userTimezone,\n\t\t\t\t\t\tlocation: this.entry.getLocation(),\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.planner.hideLoader();\n\t\t\t\t\t\tthis.planner.update(\n\t\t\t\t\t\t\tresponse.data.entries,\n\t\t\t\t\t\t\tresponse.data.accessibility\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tthis.planner.updateSelector(\n\t\t\t\t\t\t\tUtil.adjustDateForTimezoneOffset(\n\t\t\t\t\t\t\t\tthis.entry.from,\n\t\t\t\t\t\t\t\tthis.entry.userTimezoneOffsetFrom,\n\t\t\t\t\t\t\t\tthis.entry.fullDay),\n\t\t\t\t\t\t\tUtil.adjustDateForTimezoneOffset(\n\t\t\t\t\t\t\t\tthis.entry.to,\n\t\t\t\t\t\t\t\tthis.entry.userTimezoneOffsetTo,\n\t\t\t\t\t\t\t\tthis.entry.fullDay\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tthis.entry.fullDay\n\n\t\t\t\t\t\t);\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {resolve(response);}\n\t\t\t\t);\n\n\t\t});\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif(\n\t\t\t(\n\t\t\t\te.keyCode === Util.getKeyCode('delete')\n\t\t\t\t// || e.keyCode === Util.getKeyCode('backspace')\n\t\t\t)\n\t\t\t&& this.canDo(this.entry, 'delete'))\n\t\t{\n\t\t\tconst target = event.target || event.srcElement;\n\t\t\tconst tagName = Type.isElementNode(target) ? target.tagName.toLowerCase() : null;\n\t\t\tif (tagName && !['input', 'textarea'].includes(tagName))\n\t\t\t{\n\t\t\t\tEventEmitter.subscribeOnce('BX.Calendar.Entry:beforeDelete', ()=>{\n\t\t\t\t\tthis.BX.SidePanel.Instance.close();\n\t\t\t\t});\n\t\t\t\tEntryManager.deleteEntry(this.entry, this.calendarContext);\n\t\t\t}\n\t\t}\n\t}\n\n\thandlePull(event: BaseEvent): void\n\t{\n\t\tif (!event instanceof BaseEvent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst data = event.getData();\n\t\tconst command = data[0];\n\n\t\tif (BX.Calendar.Util.documentIsDisplayingNow())\n\t\t{\n\t\t\tswitch(command)\n\t\t\t{\n\t\t\t\tcase 'edit_event':\n\t\t\t\tcase 'delete_event':\n\t\t\t\tcase 'set_meeting_status':\n\t\t\t\t\tconst calendarContext = Util.getCalendarContext();\n\t\t\t\t\tif (calendarContext)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.planner && this.reloadStatus === this.RELOAD_FINISHED)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.loadPlannerDataDebounce();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.reloadSliderDebounce();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst params = {command};\n\t\t\tif (this.pullEventList.has(params))\n\t\t\t{\n\t\t\t\tthis.pullEventList.delete(params);\n\t\t\t}\n\t\t\tthis.pullEventList.add(params);\n\t\t}\n\t}\n\n\thandleVisibilityChange()\n\t{\n\t\tif (this.pullEventList.size)\n\t\t{\n\t\t\tthis.pullEventList.forEach((value, valueAgain, set) =>\n\t\t\t{\n\t\t\t\tif (['edit_event', 'delete_event', 'set_meeting_status',].includes(value.command))\n\t\t\t\t{\n\t\t\t\t\tif (!Util.getCalendarContext())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.reloadSliderDebounce();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.pullEventList.clear();\n\t\t}\n\t}\n\n\thandleEntityChanges()\n\t{\n\t\tthis.entityChanged = true;\n\t}\n\n\treloadSlider(): void\n\t{\n\t\tif (this.reloadStatus === this.RELOAD_FINISHED)\n\t\t{\n\t\t\tconst activeElement = document.activeElement\n\t\t\tif (['IFRAME', 'TEXTAREA'].includes(activeElement.tagName.toUpperCase()))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Protection from reloading same page during changes (status or reminder)\n\t\t\tif (this.entityChanged)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.entityChanged = false;\n\t\t\t\t}, 500);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.unsubscribe(this.slider, \"SidePanel.Slider:onLoad\", this.sliderOnLoad);\n\t\t\tEventEmitter.unsubscribe(this.slider, \"SidePanel.Slider:onCloseComplete\", this.destroyBind);\n\t\t\tEventEmitter.unsubscribe('onPullEvent-calendar', this.handlePullBind);\n\t\t\tEvent.unbind(document, 'keydown', this.keyHandlerBind);\n\n\t\t\tthis.reloadStatus = this.RELOAD_REQUESTED;\n\n\t\t\tthis.slider.reload();\n\t\t}\n\t}\n}\n"],"names":["EventViewForm","options","type","ownerId","userId","zIndex","entryId","calendarContext","entryDateFrom","timezoneOffset","BX","Util","getBX","sliderOnLoad","onLoadSlider","bind","handlePullBind","handlePull","keyHandlerBind","keyHandler","destroyBind","destroy","loadPlannerDataDebounce","Runtime","debounce","loadPlannerData","LOAD_DELAY","reloadSliderDebounce","reloadSlider","pullEventList","Set","slider","promiseResolve","EventEmitter","subscribe","Event","document","handleVisibilityChange","createContent","then","html","Type","isFunction","opened","unsubscribe","unbind","intranetControllButton","closeAllPopups","event","BaseEvent","data","getData","DOM","content","layout","get","isNull","uid","initControls","reloadStatus","RELOAD_FINISHED","Promise","resolve","ajax","runAction","analyticsLabel","calendarAction","formType","dateFrom","formatDate","response","isOpen","set","params","additionalParams","uniqueId","entryUrl","userTimezone","dayOfWeekMonthFormat","plannerFeatureEnabled","planner","lock","handleEntryData","entry","userIndex","section","errors","length","Text","encode","message","displayError","title","querySelector","buttonSet","editButton","delButton","sidebarInner","initPlannerControl","initUserListControl","innerTimeWrap","isElementNode","offsetHeight","Dom","addClass","canDo","SidePanel","Instance","close","EntryManager","openEditSlider","remove","reminderWrap","isDomNode","viewMode","getCurrentStatus","reminderControl","Calendar","Controls","Reminder","wrap","setValue","getReminders","handleEntityChanges","reminderValues","values","id","reminders","items","querySelectorAll","removeClass","subscribeOnce","deleteEntry","viewElementBind","showTitle","node","getAttribute","isMeeting","initAcceptMeetingControl","copyButton","copyEventUrl","videoCall","Intranet","ControlButton","style","display","container","entityType","entityId","parentId","entityData","from","entryData","sectionData","Entry","isPlainObject","permissions","PERM","registerEntrySlider","plannerId","plannerWrapOuter","plannerWrap","Planner","minWidth","parseInt","offsetWidth","solidStatus","readonly","locked","show","showLoader","setTimeout","userList","y","i","q","n","getAttendees","forEach","user","STATUS","push","toLowerCase","attendeesListY","attendeesListN","attendeesListQ","attendeesListI","showUserListPopup","userListPopup","userListPopupWrap","create","props","className","userWrap","appendChild","width","height","src","AVATAR","href","URL","text","DISPLAY_NAME","PopupWindowManager","Math","random","autoHide","closeByEsc","offsetTop","offsetLeft","resizable","lightShadow","setAngle","offset","addCustomEvent","statusButtonset","marginRight","statusControl","MeetingStatusControl","currentStatus","value","setMeetingStatus","status","setStatus","updateStatus","clipboard","copy","timeoutIds","popup","PopupWindow","Loc","getMessage","darkMode","angle","cachable","timeoutId","pop","clearTimeout","action","isResourcebooking","edit","view_full","hasClass","entryLocation","LOCATION","hostId","getMeetingHost","entityList","getAttendeesEntityList","getTime","getDayLength","dateTo","to","timezone","location","getLocation","hideLoader","update","entries","accessibility","updateSelector","adjustDateForTimezoneOffset","userTimezoneOffsetFrom","fullDay","userTimezoneOffsetTo","e","keyCode","getKeyCode","target","srcElement","tagName","includes","command","documentIsDisplayingNow","getCalendarContext","has","add","size","valueAgain","clear","entityChanged","activeElement","toUpperCase","RELOAD_REQUESTED","reload"],"mappings":"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"}