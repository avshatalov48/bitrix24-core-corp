this.BX=this.BX||{};this.BX.Calendar=this.BX.Calendar||{};(function(e,t,i,a,n){"use strict";var s=function(){function e(t){babelHelpers.classCallCheck(this,e);this.DOM={wrap:t.wrap,input:t.input};this.onChangeCallback=BX.type.isFunction(t.onChangeCallback)?t.onChangeCallback:null;this.create()}babelHelpers.createClass(e,[{key:"create",value:function t(){this.selectContol=new BX.Calendar.Controls.SelectInput({input:this.DOM.input,zIndex:4e3,values:e.getValueList(),onChangeCallback:function(){if(this.onChangeCallback){this.onChangeCallback(this.selectContol.getInputValue())}}.bind(this)})}},{key:"setValue",value:function t(a){var n;if(BX.type.isDate(a)){n={h:a.getHours(),m:a.getMinutes()}}else{n=i.Util.parseTime(a)}var s=e.adaptTimeValue(n);this.selectContol.setValue({value:s.value});var o=Math.floor(s.value/60);var l=s.value-o*60;this.DOM.input.value=i.Util.formatTime(o,l)}}],[{key:"adaptTimeValue",value:function t(i){i=parseInt(i.h*60)+parseInt(i.m);var a=e.getValueList(),n=24*60,s=false,o;for(o=0;o<a.length;o++){if(Math.abs(a[o].value-i)<n){n=Math.abs(a[o].value-i);s=o;if(n<=15){break}}}return a[s||0]}},{key:"getValueList",value:function t(){if(!e.valueList){e.valueList=[];var a;for(a=0;a<24;a++){e.valueList.push({value:a*60,label:i.Util.formatTime(a,0)});e.valueList.push({value:a*60+30,label:i.Util.formatTime(a,30)})}}return e.valueList}}]);return e}();babelHelpers.defineProperty(s,"valueList",null);function o(){var e=babelHelpers.taggedTemplateLiteral(['<input id="inp-','" type="text" class="calendar-field calendar-field-datetime" value="" autocomplete="off" placeholder="','"/>']);o=function t(){return e};return e}function l(){var e=babelHelpers.taggedTemplateLiteral(['<span class="calendar-reminder-clear-icon" data-bxc-value="','"/>']);l=function t(){return e};return e}function r(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="calendar-reminder-item">\n\t\t\t\t\t\t<span class="calendar-reminder-item-title">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>"]);r=function t(){return e};return e}function u(){var e=babelHelpers.taggedTemplateLiteral(['<span class="calendar-reminder-clear-icon" data-bxc-value="','"/>']);u=function t(){return e};return e}function p(){var e=babelHelpers.taggedTemplateLiteral(['<span class="calendar-reminder-item">\n\t\t\t\t\t<span class="calendar-reminder-item-title">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</span>"]);p=function t(){return e};return e}function c(){var e=babelHelpers.taggedTemplateLiteral(['<span class="calendar-reminder-clear-icon" data-bxc-value="','"/>']);c=function t(){return e};return e}function d(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="calendar-reminder-item">\n\t\t\t\t\t\t<span class="calendar-reminder-item-title">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>"]);d=function t(){return e};return e}function h(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="calendar-notification-add-btn-wrap">\n\t\t\t\t\t\t<span class="calendar-notification-text">','</span>\n\t\t\t\t\t\t<span class="calendar-notification-btn-container calendar-notification-btn-add">\n\t\t\t\t\t\t\t<span class="calendar-notification-icon"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>']);h=function t(){return e};return e}function m(){var e=babelHelpers.taggedTemplateLiteral(['<span class="calendar-notification-values"></span>']);m=function t(){return e};return e}var f=function(e){babelHelpers.inherits(s,e);function s(e){var t;babelHelpers.classCallCheck(this,s);t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(s).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"defaultReminderTime",540);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"fullDayMode",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"extendedMode",true);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"selectedValues",[]);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"controlList",{});babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"viewMode",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"DOM",{});t.setEventNamespace("BX.Calendar.Controls.Reminder");t.values=t.getValues();t.id=e.id||"reminder-"+Math.round(Math.random()*1e6);t.zIndex=e.zIndex||3200;t.viewMode=e.viewMode===true;t.changeCallack=e.changeCallack;t.showPopupCallBack=e.showPopupCallBack;t.hidePopupCallBack=e.hidePopupCallBack;t.create(e);t.setValue(e.selectedValues||[]);t.bindEventHandlers();return t}babelHelpers.createClass(s,[{key:"create",value:function e(t){if(a.Type.isDomNode(t.wrap)){this.DOM.wrap=t.wrap}if(a.Type.isDomNode(t.valuesContainerNode)){this.DOM.valuesWrap=t.valuesContainerNode}else if(this.DOM.wrap){this.DOM.valuesWrap=this.DOM.wrap.appendChild(a.Tag.render(m()))}if(!this.viewMode){if(a.Type.isDomNode(t.addButtonNode)){this.DOM.addButton=t.addButtonNode}else if(this.DOM.wrap){this.DOM.addButton=this.DOM.wrap.appendChild(a.Tag.render(h(),a.Loc.getMessage("EC_REMIND1_ADD")))}}}},{key:"bindEventHandlers",value:function e(){if(a.Type.isDomNode(this.DOM.addButton)){a.Event.bind(this.DOM.addButton,"click",this.showPopup.bind(this))}if(a.Type.isDomNode(this.DOM.valuesWrap)){a.Event.bind(this.DOM.valuesWrap,"click",this.handleClick.bind(this))}}},{key:"getValues",value:function e(){var t=[];if(!this.fullDayMode){t=t.concat([{value:0,label:a.Loc.getMessage("EC_REMIND1_0"),shortLabel:a.Loc.getMessage("EC_REMIND1_SHORT_0")},{value:5,label:a.Loc.getMessage("EC_REMIND1_5"),shortLabel:a.Loc.getMessage("EC_REMIND1_SHORT_5")},{value:10,label:a.Loc.getMessage("EC_REMIND1_10"),shortLabel:a.Loc.getMessage("EC_REMIND1_SHORT_10")},{value:15,label:a.Loc.getMessage("EC_REMIND1_15"),shortLabel:a.Loc.getMessage("EC_REMIND1_SHORT_15")},{value:20,label:a.Loc.getMessage("EC_REMIND1_20"),shortLabel:a.Loc.getMessage("EC_REMIND1_SHORT_20")},{value:30,label:a.Loc.getMessage("EC_REMIND1_30"),shortLabel:a.Loc.getMessage("EC_REMIND1_SHORT_30")},{value:60,label:a.Loc.getMessage("EC_REMIND1_60"),shortLabel:a.Loc.getMessage("EC_REMIND1_SHORT_60")},{value:120,label:a.Loc.getMessage("EC_REMIND1_120"),shortLabel:a.Loc.getMessage("EC_REMIND1_SHORT_120")}])}if(this.extendedMode){t=t.concat([{id:"time-menu-day-0",label:a.Loc.getMessage("EC_REMIND1_DAY_0"),dataset:{mode:"time-menu",daysBefore:0,time:this.defaultReminderTime}},{id:"time-menu-day-1",label:a.Loc.getMessage("EC_REMIND1_DAY_1"),dataset:{mode:"time-menu",daysBefore:1,time:this.defaultReminderTime}},{id:"time-menu-day-2",label:a.Loc.getMessage("EC_REMIND1_DAY_2"),dataset:{mode:"time-menu",daysBefore:2,time:this.defaultReminderTime}},{id:"custom",label:a.Loc.getMessage("EC_REMIND1_CUSTOM"),dataset:{mode:"custom"}}])}return t}},{key:"setValue",value:function e(t){if(a.Type.isArray(t)){t.forEach(this.addValue,this)}}},{key:"setFullDayMode",value:function e(t){if(t!==this.fullDayMode){this.fullDayMode=t;this.values=this.getValues()}}},{key:"showPopup",value:function e(){var a=this;var s=this,o=[];this.values.forEach(function(e){if(e.mode==="time-menu"||e.mode==="custom"||!BX.util.in_array(e.value,a.selectedValues)){var t={};if(e.dataset&&e.dataset.mode==="time-menu"){t.id=e.id;var n=i.Util.getTimeByInt(a.defaultReminderTime);t.text=e.label.replace("#TIME#",i.Util.formatTime(n.hour,n.min));t.dataset=BX.util.objectMerge({type:"submenu-list",value:a.defaultReminderTime},e.dataset);t.items=a.getSubmenuTimeValues(t,e.label);t.onclick=function(){return function(){s.addValue({before:e.dataset.daysBefore,time:e.dataset.time});BX.defer(function(){s.reminderMenu.close()},s)()}}()}else if(e.dataset&&e.dataset.mode==="custom"){t.id="custom";t.text=e.label;t.items=[{id:"tmp",text:"tmp"}]}else{t.text=e.label;t.onclick=function(e,t){return function(){s.addValue(e);s.reminderMenu.close()}}(e.value,e.mode)}o.push(t)}},this);this.reminderMenu=t.MenuManager.create(this.id,this.DOM.addButton,o,{closeByEsc:true,autoHide:true,zIndex:this.zIndex,offsetTop:0,offsetLeft:9,angle:true,cacheable:false});var l=this.adjustSubmenuPopup.bind(this);var r=this.closeSubmenuPopup.bind(this);n.EventEmitter.subscribe("BX.Main.Popup:onShow",l);n.EventEmitter.subscribe("BX.Main.Popup:onClose",r);this.reminderMenu.popupWindow.subscribe("onClose",function(){n.EventEmitter.unsubscribe("BX.Main.Popup:onShow",l);n.EventEmitter.unsubscribe("BX.Main.Popup:onClose",r)});this.reminderMenu.show()}},{key:"getSubmenuTimeValues",value:function e(t,a){var n=[];s.getTimeValueList(60).forEach(function(e){n.push({id:"time-"+e.value,dataset:{value:e.value,daysBefore:t.dataset.daysBefore},text:e.label,onclick:function(e,n){var s=i.Util.getTimeByInt(n.dataset.value);var o=this.reminderMenu.getMenuItem(t.id);if(o){o.setText(a.replace("#TIME#",i.Util.formatTime(s.hour,s.min)))}this.addValue({time:n.dataset.value,before:n.dataset.daysBefore});BX.defer(function(){this.reminderMenu.close()},this)()}.bind(this)})},this);return n}},{key:"addValue",value:function e(t){var o,h,m=s.formatValue(t);if(a.Type.isPlainObject(t)&&!this.selectedValues.includes(m)){if(a.Type.isInteger(t.before)&&a.Type.isInteger(t.time)){h=this.DOM.valuesWrap.appendChild(a.Tag.render(d(),s.getReminderLabel(t)));if(!this.viewMode){h.appendChild(a.Tag.render(c(),m))}}else if(t.type==="date"&&a.Type.isDate(t.value)){h=this.DOM.valuesWrap.appendChild(a.Tag.render(p(),i.Util.formatDateUsable(t.value)+" "+i.Util.formatTime(t.value)));if(!this.viewMode){h.appendChild(a.Tag.render(u(),m))}}this.selectedValues.push(m);this.controlList[m]=h}else if(t>=0&&!this.selectedValues.includes(m)){for(o=0;o<this.values.length;o++){if(this.values[o].value===t){h=this.DOM.valuesWrap.appendChild(a.Tag.render(r(),this.values[o].shortLabel||this.values[o].label));if(!this.viewMode){h.appendChild(a.Tag.render(l(),m))}this.selectedValues.push(m);this.controlList[m]=h;break}}if(h===undefined){h=this.DOM.valuesWrap.appendChild(a.Dom.create("SPAN",{props:{className:"calendar-reminder-item"},text:s.getText(t)}));if(!this.viewMode){h.appendChild(a.Dom.create("SPAN",{props:{className:"calendar-reminder-clear-icon"},events:{click:function(){this.removeValue(t)}.bind(this)}}))}this.selectedValues.push(t);this.controlList[t]=h}}if(this.changeCallack){this.changeCallack(this.selectedValues)}this.emit("onChange",new n.BaseEvent({data:{values:this.selectedValues}}))}},{key:"removeValue",value:function e(t){if(this.controlList[t]&&a.Type.isDomNode(this.controlList[t])){a.Dom.remove(this.controlList[t])}this.selectedValues=BX.util.deleteFromArray(this.selectedValues,BX.util.array_search(t,this.selectedValues));if(!this.selectedValues.length);if(this.changeCallack){this.changeCallack(this.selectedValues)}this.emit("onChange",new n.BaseEvent({data:{values:this.selectedValues}}))}},{key:"handleClick",value:function e(t){var i=t.target||t.srcElement;var a=i.getAttribute("data-bxc-value");if(this.selectedValues.includes(a)){this.removeValue(a)}}},{key:"adjustSubmenuPopup",value:function e(i){if(i instanceof n.BaseEvent){var a=i.getTarget();if(a instanceof t.Popup){if(/^menu-popup-popup-submenu-time-menu-day-\d$/.test(a.getId())){this.adjustTimeSubmenuPopup(a)}else if(/^menu-popup-popup-submenu-custom$/.test(a.getId())){this.adjustCalendarSubmenuPopup(a)}}}}},{key:"closeSubmenuPopup",value:function e(i){if(i instanceof n.BaseEvent){var s=i.getTarget();if(s instanceof t.Popup){if(/^menu-popup-popup-submenu-time-menu-day-\d$/.test(s.getId()));else if(/^menu-popup-popup-submenu-custom$/.test(s.getId())){var o=s.bindElement;var l=o.querySelector(".menu-popup-item-text");if(a.Type.isDomNode(l)){a.Dom.clean(l);l.innerHTML=a.Loc.getMessage("EC_REMIND1_CUSTOM")}}}}}},{key:"adjustTimeSubmenuPopup",value:function e(t){var i=t.getContentContainer().querySelector('span[data-value="'+this.defaultReminderTime+'"]');if(a.Type.isDomNode(i)){setTimeout(function(){t.getContentContainer().scrollTop=parseInt(i.offsetTop)-10;a.Dom.addClass(i,"menu-popup-item-open")},50)}}},{key:"adjustCalendarSubmenuPopup",value:function e(n){var s=this;var l=n.bindElement;var r=l.querySelector(".menu-popup-item-text");if(a.Type.isDomNode(r)){a.Dom.clean(r);var u=r.appendChild(a.Tag.render(o(),Math.round(Math.random()*1e5),a.Loc.getMessage("EC_REMIND1_CUSTOM_PLACEHOLDER")));var p=BX.calendar.get();p.popup=null;p._current_layer=null;p._layers={};p.Show({node:u,value:i.Util.formatDateTime(i.Util.getUsableDateTime(new Date)),field:u,bTime:true,bHideTime:false});var c=p.popup;c.cacheable=false;if(c&&c.popupContainer){var d=c.popupContainer.querySelector(".bx-calendar");if(a.Type.isDomNode(d)){n.contentContainer.appendChild(d)}c.close();t.MenuManager.destroy(c.uniquePopupId)}a.Event.bind(u,"change",function(){var e=u.value,t=i.Util.parseDate(e);if(a.Type.isDate(t)){s.addValue({type:"date",value:t});s.reminderMenu.close()}})}}}],[{key:"getText",value:function e(t){var i=t,n=[60,24],s=["EC_REMIND1_MIN_COUNT","EC_REMIND1_HOUR_COUNT","EC_REMIND1_DAY_COUNT"],o="";for(var l=0;l<s.length;l++){if(i<n[l]||l===n.length){o=a.Loc.getMessage(s[l]).toString();o=o.replace("#COUNT#",i.toString());break}else{i=Math.ceil(i/n[l])}}return o}},{key:"getTimeValueList",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:30;if(!s.timeValueList){s.timeValueList=[];var a;for(a=0;a<24;a++){s.timeValueList.push({value:a*60,label:i.Util.formatTime(a,0)});if(t<=30){s.timeValueList.push({value:a*60+30,label:i.Util.formatTime(a,30)})}}}return s.timeValueList}},{key:"formatValue",value:function e(t){if(a.Type.isPlainObject(t)&&a.Type.isInteger(t.before)&&a.Type.isInteger(t.time)){return"daybefore|"+t.before+"|"+t.time}else if(a.Type.isPlainObject(t)&&a.Type.isDate(t.value)){return"date|"+i.Util.formatDateTime(t.value)}return t.toString()}},{key:"showCustomInputCalendar",value:function e(t,n){if(!a.Type.isDomNode(n)&&t){n=t.target||t.srcElement}if(a.Type.isDomNode(n)&&n.nodeName.toLowerCase()==="input"){BX.calendar({node:n.parentNode,value:i.Util.formatDateTime(i.Util.getUsableDateTime(new Date)),field:n,bTime:true,bHideTime:false});BX.onCustomEvent(window,"onCalendarControlChildPopupShown");var o=BX.calendar.get().popup;if(o){o.params.zIndex=4200;o.popupContainer.style.zIndex=o.params.zIndex;BX.removeCustomEvent(o,"onPopupClose",s.inputCalendarClosePopupHandler);BX.addCustomEvent(o,"onPopupClose",s.inputCalendarClosePopupHandler)}}}},{key:"inputCalendarClosePopupHandler",value:function e(t){BX.onCustomEvent(window,"onCalendarControlChildPopupClosed")}},{key:"getReminderLabel",value:function e(t){var n="";if(a.Type.isInteger(t.before)&&a.Type.isInteger(t.time)&&[0,1,2].includes(t.before)){var s=i.Util.getTimeByInt(t.time);n=a.Loc.getMessage("EC_REMIND1_DAY_"+t.before+"_SHORT").replace("#TIME#",i.Util.formatTime(s.hour,s.min))}return n}}]);return s}(n.EventEmitter);babelHelpers.defineProperty(f,"timeValueList",null);var v=function(){function e(t){babelHelpers.classCallCheck(this,e);this.params=t;this.id=t.id||"location-"+Math.round(Math.random()*1e6);this.zIndex=t.zIndex||3100;this.DOM={wrapNode:t.wrap};this.disabled=!t.richLocationEnabled;this.value={type:"",text:"",value:""};this.meetingRooms=t.iblockMeetingRoomList||[];e.setMeetingRoomList(t.iblockMeetingRoomList);e.setLocationList(t.locationList);this.create()}babelHelpers.createClass(e,[{key:"create",value:function e(){this.DOM.inputWrap=this.DOM.wrapNode.appendChild(a.Dom.create("DIV",{props:{className:"calendar-field-block"}}));if(this.disabled){BX.addClass(this.DOM.wrapNode,"locked");this.DOM.inputWrap.appendChild(a.Dom.create("DIV",{props:{className:"calendar-lock-icon"},events:{click:function e(){B24.licenseInfoPopup.show("calendar_location",a.Loc.getMessage("EC_B24_LOCATION_LIMITATION_TITLE"),a.Loc.getMessage("EC_B24_LOCATION_LIMITATION"))}}}))}this.DOM.input=this.DOM.inputWrap.appendChild(a.Dom.create("INPUT",{attrs:{name:this.params.inputName||"",placeholder:a.Loc.getMessage("EC_LOCATION_LABEL"),type:"text",autocomplete:this.disabled?"on":"off"},props:{className:"calendar-field calendar-field-select"}}))}},{key:"setValues",value:function t(){var i=[],n=false,s=e.getMeetingRoomList(),o=e.getLocationList();if(a.Type.isArray(s)){s.forEach(function(e){e.ID=parseInt(e.ID);i.push({ID:e.ID,label:BX.util.htmlspecialchars(e.NAME),labelRaw:e.NAME,value:e.ID,type:"mr"});if(this.value.type==="mr"&&parseInt(this.value.value)===e.ID){n=i.length-1}},this);if(i.length>0){i.push({delimiter:true})}}if(a.Type.isArray(o)){if(o.length){o.forEach(function(e){e.ID=parseInt(e.ID);i.push({ID:e.ID,label:BX.util.htmlspecialchars(e.NAME),labelRaw:e.NAME,value:e.ID,type:"calendar"});if(this.value.type==="calendar"&&parseInt(this.value.value)===parseInt(e.ID)){n=i.length-1}},this);i.push({delimiter:true});i.push({label:a.Loc.getMessage("EC_LOCATION_MEETING_ROOM_SET"),callback:this.editMeetingRooms.bind(this)})}else{i.push({label:a.Loc.getMessage("EC_ADD_LOCATION"),callback:this.editMeetingRooms.bind(this)})}}if(this.value){this.DOM.input.value=this.value.str||"";if(this.value.type&&this.value.str===this.getTextLocation(this.value)){this.DOM.input.value=a.Loc.getMessage("EC_LOCATION_404")}}if(this.selectContol){this.selectContol.destroy()}this.selectContol=new BX.Calendar.Controls.SelectInput({input:this.DOM.input,values:i,valueIndex:n,zIndex:this.zIndex,disabled:this.disabled,onChangeCallback:BX.delegate(function(){var e,t=this.DOM.input.value;this.value={text:t};for(e=0;e<i.length;e++){if(i[e].labelRaw===t){this.value.type=i[e].type;this.value.value=i[e].value;break}}if(a.Type.isFunction(this.params.onChangeCallback)){this.params.onChangeCallback()}},this)})}},{key:"editMeetingRooms",value:function e(){var t={};if(this.params.getControlContentCallback){t.wrap=this.params.getControlContentCallback()}if(!t.wrap){t.wrap=this.showEditMeetingRooms()}this.buildLocationEditControl(t)}},{key:"showEditMeetingRooms",value:function e(){if(this.editDialog){this.editDialog.destroy()}this.editDialogContent=a.Dom.create("DIV",{props:{className:"bxec-location-wrap"}});this.editDialog=new BX.PopupWindow(this.id+"_popup",null,{overlay:{opacity:10},autoHide:true,closeByEsc:true,zIndex:this.zIndex,offsetLeft:0,offsetTop:0,draggable:true,bindOnResize:false,titleBar:a.Loc.getMessage("EC_MEETING_ROOM_LIST_TITLE"),closeIcon:{right:"12px",top:"10px"},className:"bxc-popup-window",buttons:[new BX.PopupWindowButton({text:a.Loc.getMessage("EC_SEC_SLIDER_SAVE"),events:{click:BX.delegate(function(){this.saveValues();if(this.editDialog){this.editDialog.close()}},this)}}),new BX.PopupWindowButtonLink({text:a.Loc.getMessage("EC_SEC_SLIDER_CANCEL"),className:"popup-window-button-link-cancel",events:{click:BX.delegate(function(){if(this.editDialog){this.editDialog.close()}},this)}})],content:this.editDialogContent,events:{}});this.editDialog.show();return this.editDialogContent}},{key:"buildLocationEditControl",value:function t(i){var n;this.locationEditControlShown=true;this.editDialogWrap=i.wrap;this.locationRoomList=[];this.addNewButtonField=false;if(a.Type.isArray(e.locationList)){e.locationList.forEach(function(e){if(e.NAME!==""&&e.ID){this.locationRoomList.push({id:parseInt(e.ID),name:e.NAME})}},this)}if(!this.locationRoomList.length){this.locationRoomList.push({id:0,name:""})}for(n=0;n<this.locationRoomList.length;n++){this.addRoomField(this.locationRoomList[n],i.wrap)}this.addNewButtonField={outerWrap:i.wrap.appendChild(a.Dom.create("DIV",{props:{className:"calendar-field-container calendar-field-container-container-text"}}))};this.addNewButtonField.innerWrap=this.addNewButtonField.outerWrap.appendChild(a.Dom.create("DIV",{props:{className:"calendar-field-block"}}));this.addNewButtonField.innerCont=this.addNewButtonField.innerWrap.appendChild(a.Dom.create("DIV",{props:{className:"calendar-text"},html:'<span class="calendar-text-link">'+a.Loc.getMessage("EC_MEETING_ROOM_ADD")+"</span>",events:{click:BX.delegate(function(){var e=this.locationRoomList[this.locationRoomList.length-1];if(e.id||e.deleted||BX.util.trim(e.field.input.value)){this.locationRoomList.push(this.addRoomField({id:0},i.wrap))}},this)}}));i.wrap.appendChild(this.addNewButtonField.outerWrap)}},{key:"addRoomField",value:function t(i){i.field={outerWrap:this.editDialogWrap.appendChild(a.Dom.create("DIV",{props:{className:"calendar-field-container calendar-field-container-string"}}))};i.field.innerWrap=i.field.outerWrap.appendChild(a.Dom.create("DIV",{props:{className:"calendar-field-block"}}));i.field.innerWrap.style.paddingRight="40px";i.field.input=i.field.innerWrap.appendChild(a.Dom.create("INPUT",{props:{className:"calendar-field calendar-field-string"},attrs:{value:i.name||"",placeholder:a.Loc.getMessage("EC_MEETING_ROOM_PLACEHOLDER"),type:"text"},events:{keyup:BX.delegate(function(e){if(parseInt(e.keyCode)===13){this.editRoom(i)}},this)}}));i.field.delRoomEntry=i.field.innerWrap.appendChild(a.Dom.create("SPAN",{props:{className:"calendar-remove-filed"},events:{click:BX.delegate(function(){e.deleteField(i)},this)}}));if(this.addNewButtonField){this.editDialogWrap.appendChild(this.addNewButtonField.outerWrap)}if(!i.id){i.field.input.focus()}return i}},{key:"editRoom",value:function e(t){if(!this.locationEditControlShown)return;t.field.input.value=BX.util.trim(t.field.input.value);if(!t.id){if(t.field.input.value&&BX.util.trim(t.field.input.value)!==BX.util.trim(t.name)){t.name=t.field.input.value;this.locationRoomList.push(this.addRoomField({id:0}))}}else{if(BX.util.trim(t.field.input.value)!==t.name){t.name=t.field.input.value;t.changed=true}}}},{key:"saveValues",value:function t(){var i,a=[];for(i=0;i<this.locationRoomList.length;i++){if(this.locationRoomList[i].field&&this.locationRoomList[i].field.input){if(this.locationRoomList[i].name!==this.locationRoomList[i].field.input.value&&this.locationRoomList[i].id){this.locationRoomList[i].changed=true}this.locationRoomList[i].name=this.locationRoomList[i].field.input.value}if(!this.locationRoomList[i].deleted&&this.locationRoomList[i].name||this.locationRoomList[i].id){a.push({id:this.locationRoomList[i].id||0,name:this.locationRoomList[i].name||"",changed:this.locationRoomList[i].changed||!this.locationRoomList[i].id?"Y":"N",deleted:this.locationRoomList[i].deleted||!this.locationRoomList[i].name?"Y":"N"})}}BX.ajax.runAction("calendar.api.calendarajax.saveLocationList",{data:{locationList:a}}).then(BX.delegate(function(t){e.setLocationList(t.data.locationList);this.setValues()},this),BX.delegate(function(e){},this));this.locationEditControlShown=false}},{key:"getTextValue",value:function e(t){if(!t){t=this.value}var i=t.str||t.text||"";if(t&&t.type==="mr"){i="ECMR_"+t.value+(t.mrevid?"_"+t.mrevid:"")}else if(t&&t.type==="calendar"){i="calendar_"+t.value+(t.room_event_id?"_"+t.room_event_id:"")}return i}},{key:"getValue",value:function e(){return this.value}},{key:"setValue",value:function t(i){if(a.Type.isPlainObject(i)){this.value.text=i.text||"";this.value.type=i.type||"";this.value.value=i.value||""}else{this.value=e.parseStringValue(i)}this.setValues()}},{key:"getTextLocation",value:function t(i){var n=a.Type.isPlainObject(i)?i:e.parseStringValue(i),s,o=n.str;if(a.Type.isArray(this.meetingRooms)&&n.type==="mr"){for(s=0;s<this.meetingRooms.length;s++){if(parseInt(n.value)===parseInt(this.meetingRooms[s].ID)){o=this.meetingRooms[s].NAME;break}}}if(a.Type.isArray(e.locationList)&&n.type==="calendar"){for(s=0;s<e.locationList.length;s++){if(parseInt(n.value)===parseInt(e.locationList[s].ID)){o=e.locationList[s].NAME;break}}}return o}}],[{key:"deleteField",value:function e(t){BX.remove(t.field.outerWrap,true);t.deleted=true;t.changed=true}},{key:"parseStringValue",value:function e(t){if(!a.Type.isString(t)){t=""}var i={type:false,value:false,str:t};if(t.substr(0,5)==="ECMR_"){i.type="mr";var n=t.split("_");if(n.length>=2){if(!isNaN(parseInt(n[1]))&&parseInt(n[1])>0){i.value=i.mrid=parseInt(n[1])}if(!isNaN(parseInt(n[2]))&&parseInt(n[2])>0){i.mrevid=parseInt(n[2])}}}else if(t.substr(0,9)==="calendar_"){i.type="calendar";var s=t.split("_");if(s.length>=2){if(!isNaN(parseInt(s[1]))&&parseInt(s[1])>0){i.value=i.room_id=parseInt(s[1])}if(!isNaN(parseInt(s[2]))&&parseInt(s[2])>0){i.room_event_id=parseInt(s[2])}}}return i}},{key:"setLocationList",value:function t(i){if(a.Type.isArray(i)){e.locationList=i}}},{key:"getLocationList",value:function t(){return e.locationList}},{key:"setMeetingRoomList",value:function t(i){if(a.Type.isArray(i)){e.meetingRoomList=i}}},{key:"getMeetingRoomList",value:function t(){return e.meetingRoomList}}]);return e}();babelHelpers.defineProperty(v,"locationList",[]);babelHelpers.defineProperty(v,"meetingRoomList",[]);var b=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.params=t;this.id=t.id||"user_selector_"+Math.round(Math.random()*1e6);this.zIndex=t.zIndex||3100;this.DOM={wrapNode:t.wrapNode};this.destinationInputName=t.inputName||"EVENT_DESTINATION";if(a.Type.isArray(this.params.itemsSelected)&&this.params.itemsSelected.length){this.params.itemsSelected=this.convertAttendeesCodes(this.params.itemsSelected)}this.create()}babelHelpers.createClass(e,[{key:"create",value:function e(){var t=this.id;this.DOM.socnetDestinationWrap=this.DOM.wrapNode.appendChild(a.Dom.create("DIV",{props:{className:"event-grid-dest-wrap"},events:{click:function e(i){BX.SocNetLogDestination.openDialog(t)}}}));this.socnetDestinationItems=this.DOM.socnetDestinationWrap.appendChild(a.Dom.create("SPAN",{props:{className:""},events:{click:function e(i){var a=i.target||i.srcElement;if(a.className==="feed-event-del-but"){top.BX.SocNetLogDestination.deleteItem(a.getAttribute("data-item-id"),a.getAttribute("data-item-type"),t);i.preventDefault();i.stopPropagation()}},mouseover:function e(t){var i=t.target||t.srcElement;if(i.className==="feed-event-del-but")BX.addClass(i.parentNode,"event-grid-dest-hover")},mouseout:function e(t){var i=t.target||t.srcElement;if(i.className==="feed-event-del-but")BX.removeClass(i.parentNode,"event-grid-dest-hover")}}}));this.socnetDestinationInputWrap=this.DOM.socnetDestinationWrap.appendChild(a.Dom.create("SPAN",{props:{className:"feed-add-destination-input-box"}}));this.socnetDestinationInput=this.socnetDestinationInputWrap.appendChild(a.Dom.create("INPUT",{props:{id:t+"-inp",className:"feed-add-destination-inp"},attrs:{value:"",type:"text"},events:{keydown:function e(i){return top.BX.SocNetLogDestination.searchBeforeHandler(i,{formName:t,inputId:t+"-inp"})},keyup:function e(i){return top.BX.SocNetLogDestination.searchHandler(i,{formName:t,inputId:t+"-inp",linkId:"event-grid-dest-add-link",sendAjax:true})}}}));this.socnetDestinationLink=this.DOM.socnetDestinationWrap.appendChild(a.Dom.create("SPAN",{html:this.params.addLinkMessage||BX.message("EC_DESTINATION_ADD_USERS"),props:{id:t+"-link",className:"feed-add-destination-link"},events:{keydown:function e(i){return top.BX.SocNetLogDestination.searchBeforeHandler(i,{formName:t,inputId:t+"-inp"})},keyup:function e(i){return top.BX.SocNetLogDestination.searchHandler(i,{formName:t,inputId:t+"-inp",linkId:"event-grid-dest-add-link",sendAjax:true})}}}));this.init()}},{key:"init",value:function e(){var t=this;if(!this.socnetDestinationInput||!this.DOM.socnetDestinationWrap||!this.params.items){return}if(this.params.selectGroups===false){this.params.items.groups={};this.params.items.department={};this.params.items.sonetgroups={}}if(this.params.selectUsers===false){this.params.items.users={};this.params.items.groups={};this.params.items.department={}}BX.SocNetLogDestination.init({name:this.id,searchInput:this.socnetDestinationInput,extranetUser:false,userSearchArea:"I",bindMainPopup:{node:this.DOM.socnetDestinationWrap,offsetTop:"5px",offsetLeft:"15px"},bindSearchPopup:{node:this.DOM.socnetDestinationWrap,offsetTop:"5px",offsetLeft:"15px"},callback:{select:this.selectCallback.bind(this),unSelect:this.unSelectCallback.bind(this),openDialog:this.openDialogCallback.bind(this),closeDialog:this.closeDialogCallback.bind(this),openSearch:this.openDialogCallback.bind(this),closeSearch:function e(){t.closeDialogCallback(true)}},items:this.params.items,itemsLast:this.params.itemsLast,itemsSelected:this.params.itemsSelected,departmentSelectDisable:this.params.selectGroups===false})}},{key:"closeAll",value:function e(){if(top.BX.SocNetLogDestination.isOpenDialog()){top.BX.SocNetLogDestination.closeDialog()}top.BX.SocNetLogDestination.closeSearch()}},{key:"selectCallback",value:function e(t,i){var n=i,s="S";if(i==="sonetgroups"){s="SG"}else if(i==="groups"){s="UA";n="all-users"}else if(i==="users"){s="U"}else if(i==="department"){s="DR"}this.socnetDestinationItems.appendChild(a.Dom.create("span",{attrs:{"data-id":t.id},props:{className:"event-grid-dest event-grid-dest-"+n},children:[a.Dom.create("input",{attrs:{type:"hidden",name:this.destinationInputName+"["+s+"][]",value:t.id}}),a.Dom.create("span",{props:{className:"event-grid-dest-text"},html:t.name}),a.Dom.create("span",{props:{className:"feed-event-del-but"},attrs:{"data-item-id":t.id,"data-item-type":i}})]}));BX.onCustomEvent("OnDestinationAddNewItem",[t]);this.socnetDestinationInput.value="";this.socnetDestinationLink.innerHTML=this.params.addLinkMessage||(top.BX.SocNetLogDestination.getSelectedCount(this.id)>0?BX.message("EC_DESTINATION_ADD_MORE"):BX.message("EC_DESTINATION_ADD_USERS"))}},{key:"unSelectCallback",value:function e(t,i,a){var n=BX.findChildren(this.socnetDestinationItems,{attribute:{"data-id":t.id}},true);if(n!=null){for(var s=0;s<n.length;s++){BX.remove(n[s])}}BX.onCustomEvent("OnDestinationUnselect");this.socnetDestinationInput.value="";this.socnetDestinationLink.innerHTML=this.params.addLinkMessage||(top.BX.SocNetLogDestination.getSelectedCount(this.id)>0?BX.message("EC_DESTINATION_ADD_MORE"):BX.message("EC_DESTINATION_ADD_USERS"))}},{key:"openDialogCallback",value:function e(){if(top.BX.SocNetLogDestination.popupWindow){top.BX.SocNetLogDestination.popupWindow.params.zIndex=this.zIndex;top.BX.SocNetLogDestination.popupWindow.popupContainer.style.zIndex=this.zIndex}if(top.BX.SocNetLogDestination.popupSearchWindow){top.BX.SocNetLogDestination.popupSearchWindow.params.zIndex=this.zIndex;top.BX.SocNetLogDestination.popupSearchWindow.popupContainer.style.zIndex=this.zIndex}BX.style(this.socnetDestinationInputWrap,"display","inline-block");BX.style(this.socnetDestinationLink,"display","none");BX.focus(this.socnetDestinationInput)}},{key:"closeDialogCallback",value:function e(t){if(!top.BX.SocNetLogDestination.isOpenSearch()&&this.socnetDestinationInput.value.length<=0){BX.style(this.socnetDestinationInputWrap,"display","none");BX.style(this.socnetDestinationLink,"display","inline-block");if(t===true)this.socnetDestinationInput.value="";if(top.BX.SocNetLogDestination.backspaceDisable||top.BX.SocNetLogDestination.backspaceDisable!=null)BX.unbind(window,"keydown",top.BX.SocNetLogDestination.backspaceDisable);BX.bind(window,"keydown",top.BX.SocNetLogDestination.backspaceDisable=function(e){if(e.keyCode===8){e.preventDefault();return false}});setTimeout(function(){BX.unbind(window,"keydown",top.BX.SocNetLogDestination.backspaceDisable);top.BX.SocNetLogDestination.backspaceDisable=null},5e3)}}},{key:"getCodes",value:function e(){var t=this.socnetDestinationItems.getElementsByTagName("INPUT"),i=[],a;for(a=0;a<t.length;a++){i.push(t[a].value)}return i}},{key:"getAttendeesCodes",value:function e(){var t=this.socnetDestinationItems.getElementsByTagName("INPUT"),i=[],a;for(a=0;a<t.length;a++){i.push(t[a].value)}return this.convertAttendeesCodes(i)}},{key:"convertAttendeesCodes",value:function e(t){var i={};if(a.Type.isArray(t)){t.forEach(function(e){if(e.substr(0,2)==="DR"){i[e]="department"}else if(e.substr(0,2)==="UA"){i[e]="groups"}else if(e.substr(0,2)==="SG"){i[e]="sonetgroups"}else if(e.substr(0,1)==="U"){i[e]="users"}})}return i}},{key:"getAttendeesCodesList",value:function e(t){var i=[];if(!t)t=this.getAttendeesCodes();for(var a in t){if(t.hasOwnProperty(a)){i.push(a)}}return i}},{key:"setValue",value:function e(t){if(this.socnetDestinationItems){a.Dom.clean(this.socnetDestinationItems)}if(a.Type.isArray(t)){this.params.itemsSelected=this.convertAttendeesCodes(t)}this.init()}}]);return e}();var g=function(){function e(t){babelHelpers.classCallCheck(this,e);this.defaultColors=i.Util.getDefaultColorList();this.colors=[];this.zIndex=3100;this.DOM={wrap:t.wrap};this.create();this.bindEventHandlers()}babelHelpers.createClass(e,[{key:"create",value:function e(){for(var t=0;t<this.defaultColors.length;t++){this.colors.push({color:this.defaultColors[t],node:this.DOM.wrap.appendChild(BX.create("LI",{props:{className:"calendar-field-colorpicker-color-item"},attrs:{"data-bx-calendar-color":this.defaultColors[t]},style:{backgroundColor:this.defaultColors[t]},html:'<span class="calendar-field-colorpicker-color"></span>'}))})}this.DOM.customColorNode=this.DOM.wrap.appendChild(BX.create("LI",{props:{className:"calendar-field-colorpicker-color-item"},style:{backgroundColor:"transparent",width:0},html:'<span class="calendar-field-colorpicker-color"></span>'}));this.DOM.customColorLink=this.DOM.wrap.appendChild(BX.create("LI",{props:{className:"calendar-field-colorpicker-color-item-more"},html:'<span class="calendar-field-colorpicker-color-item-more-link">'+BX.message("EC_COLOR")+"</span>",events:{click:BX.delegate(function(){if(!this.colorPickerPopup){this.colorPickerPopup=new BX.ColorPicker({bindElement:this.DOM.customColorLink,onColorSelected:BX.proxy(this.setValue,this),popupOptions:{zIndex:this.zIndex}})}this.colorPickerPopup.open()},this)}}))}},{key:"bindEventHandlers",value:function e(){BX.bind(this.DOM.wrap,"click",BX.proxy(this.handleColorClick,this))}},{key:"handleColorClick",value:function e(t){var a=i.Util.findTargetNode(t.target||t.srcElement,this.DOM.wrap);if(a&&a.getAttribute){var n=a.getAttribute("data-bx-calendar-color");if(n!==null){this.setValue(n)}}}},{key:"setValue",value:function e(t){this.activeColor=t;if(this.DOM.activeColorNode){BX.removeClass(this.DOM.activeColorNode,"active")}if(!BX.util.in_array(this.activeColor,this.defaultColors)&&this.activeColor){this.DOM.customColorNode.style.backgroundColor=this.activeColor;this.DOM.customColorNode.style.width="";this.DOM.activeColorNode=this.DOM.customColorNode;BX.addClass(this.DOM.activeColorNode,"active")}var i;for(i=0;i<this.colors.length;i++){if(this.colors[i].color===this.activeColor){this.DOM.activeColorNode=this.colors[i].node;BX.addClass(this.DOM.activeColorNode,"active");break}}}},{key:"getValue",value:function e(){return this.activeColor}}]);return e}();var D=function(){function e(t){babelHelpers.classCallCheck(this,e);this.id=t.id||"section-select-"+Math.round(Math.random()*1e6);this.sectionList=t.sectionList;this.sectionGroupList=t.sectionGroupList;this.selectCallback=t.selectCallback;this.openPopupCallback=t.openPopupCallback;this.closePopupCallback=t.closePopupCallback;this.getCurrentSection=t.getCurrentSection;this.defaultCalendarType=t.defaultCalendarType;this.defaultOwnerId=parseInt(t.defaultOwnerId);this.zIndex=t.zIndex||3100;this.mode=t.mode;this.DOM={outerWrap:t.outerWrap};this.create();this.initEventHandlers()}babelHelpers.createClass(e,[{key:"create",value:function e(){this.DOM.select=this.DOM.outerWrap.appendChild(a.Dom.create("DIV",{props:{className:"calendar-field calendar-field-select"+(this.mode==="compact"?" calendar-field-tiny":"")}}));this.DOM.innerValue=this.DOM.select.appendChild(a.Dom.create("DIV",{props:{className:"calendar-field-select-icon"},style:{backgroundColor:this.getCurrentColor()}}));if(this.mode==="full"){this.DOM.selectInnerText=this.DOM.select.appendChild(a.Dom.create("SPAN",{text:this.getCurrentTitle()}))}}},{key:"initEventHandlers",value:function e(){a.Event.bind(this.DOM.select,"click",BX.delegate(this.openPopup,this))}},{key:"openPopup",value:function t(){if(this.sectionMenu&&this.sectionMenu.popupWindow&&this.sectionMenu.popupWindow.isShown()){return this.sectionMenu.close()}var i="main-buttons-submenu-separator main-buttons-submenu-item main-buttons-hidden-label",n,s=[],o;if(a.Type.isArray(this.sectionGroupList)){this.sectionGroupList.forEach(function(t){var a=[],n;if(t.belongsToView){a=this.sectionList.filter(this.sectionBelongsToView,this)}else if(t.type==="user"){a=this.sectionList.filter(function(i){return e.getSectionType(i)==="user"&&e.getSectionOwner(i)===t.ownerId})}else if(t.type==="company"){a=this.sectionList.filter(function(i){return e.getSectionType(i)==="company_calendar"||e.getSectionType(i)===t.type})}else{a=this.sectionList.filter(function(i){return e.getSectionType(i)===t.type})}if(a.length>0){s.push({text:"<span>"+t.title+"</span>",className:i});for(n=0;n<a.length;n++){s.push(this.getMenuItem(a[n]))}}},this)}else{for(n=0;n<this.sectionList.length;n++){s.push(this.getMenuItem(this.sectionList[n]))}}this.sectionMenu=BX.PopupMenu.create(this.id,this.DOM.select,s,{closeByEsc:true,autoHide:true,zIndex:this.zIndex,offsetTop:0,offsetLeft:this.mode==="compact"?40:0,angle:this.mode==="compact"});this.sectionMenu.popupWindow.contentContainer.style.overflow="auto";this.sectionMenu.popupWindow.contentContainer.style.maxHeight="400px";if(this.mode==="full"){this.sectionMenu.popupWindow.setWidth(this.DOM.select.offsetWidth-2);this.sectionMenu.popupWindow.contentContainer.style.overflowX="hidden"}this.sectionMenu.show();for(n=0;n<this.sectionMenu.menuItems.length;n++){if(this.sectionMenu.menuItems[n].layout.item){o=this.sectionMenu.menuItems[n].layout.item.querySelector(".menu-popup-item-icon");if(o){o.style.backgroundColor=this.sectionMenu.menuItems[n].color}}}BX.addClass(this.DOM.select,"active");if(a.Type.isFunction(this.openPopupCallback)){this.openPopupCallback(this)}BX.addCustomEvent(this.sectionMenu.popupWindow,"onPopupClose",BX.delegate(function(){if(a.Type.isFunction(this.openPopupCallback)){this.closePopupCallback()}BX.removeClass(this.DOM.select,"active");BX.PopupMenu.destroy(this.id);this.sectionMenu=null},this))}},{key:"getCurrentColor",value:function e(){return(this.getCurrentSection()||{}).color||false}},{key:"getCurrentTitle",value:function e(){return(this.getCurrentSection()||{}).name||""}},{key:"getPopup",value:function e(){return this.sectionMenu}},{key:"getMenuItem",value:function e(t){var i=this;return{text:BX.util.htmlspecialchars(t.name||t.NAME),color:t.color||t.COLOR,className:"calendar-add-popup-section-menu-item",onclick:function(e){return function(){i.DOM.innerValue.style.backgroundColor=e.color||t.COLOR;if(i.DOM.selectInnerText){i.DOM.selectInnerText.innerHTML=BX.util.htmlspecialchars(e.name||e.NAME)}if(a.Type.isFunction(i.selectCallback)){e.color=e.color||t.COLOR;e.id=parseInt(e.id||t.ID);i.selectCallback(e)}i.sectionMenu.close()}}(t)}}},{key:"sectionBelongsToView",value:function t(i){return e.getSectionType(i)===this.defaultCalendarType&&e.getSectionOwner(i)===this.defaultOwnerId}},{key:"updateValue",value:function e(){this.DOM.innerValue.style.backgroundColor=this.getCurrentColor();if(this.mode==="full"){this.DOM.select.appendChild(a.Dom.adjust(this.DOM.selectInnerText,{text:this.getCurrentTitle()}))}}}],[{key:"getSectionType",value:function e(t){return t.type||t.CAL_TYPE}},{key:"getSectionOwner",value:function e(t){return parseInt(t.OWNER_ID||t.data.OWNER_ID)}}]);return e}();var C=function(){function e(t){babelHelpers.classCallCheck(this,e);var i=t.rruleType.form.elements;this.getDate=t.getDate;this.DOM={formElements:i,wrap:t.wrap,rruleType:t.rruleType,interval:i["EVENT_RRULE[INTERVAL]"],rruleEndsOn:{never:i["rrule_endson"][0],count:i["rrule_endson"][1],until:i["rrule_endson"][2]},count:i["EVENT_RRULE[COUNT]"],until:i["EVENT_RRULE[UNTIL]"]};this.create()}babelHelpers.createClass(e,[{key:"create",value:function e(){BX.bind(this.DOM.rruleType,"change",BX.delegate(function(){this.changeType(this.DOM.rruleType.value)},this));BX.bind(this.DOM.until,"click",BX.proxy(function(){BX.calendar({node:this.DOM.until,field:this.DOM.until,bTime:false});BX.focus(this.DOM.until);this.DOM.rruleEndsOn.until.checked=true},this));BX.bind(this.DOM.count,"click",BX.proxy(function(){this.DOM.rruleEndsOn.count.checked=true},this))}},{key:"changeType",value:function e(t){this.DOM.rruleType.value=t?t.toUpperCase():"NONE";var a=this.DOM.rruleType.value.toLowerCase();this.DOM.wrap.className="calendar-rrule-type-"+a;if(a==="weekly"&&BX.type.isFunction(this.getDate)){var n=this.getDate();if(BX.type.isDate(n)){var s=i.Util.getWeekDayByInd(n.getDay());this.DOM.formElements["EVENT_RRULE[BYDAY][]"].forEach(function(e){e.checked=e.checked||e.value===s},this)}}}},{key:"setValue",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.changeType(t.FREQ);this.DOM.interval.value=t.INTERVAL||1;if(t.COUNT){this.DOM.rruleEndsOn.count.checked="checked";this.DOM.count.value=t.COUNT}else if(t["~UNTIL"]){this.DOM.rruleEndsOn.until.checked="checked";this.DOM.until.value=t["~UNTIL"]}else{this.DOM.rruleEndsOn.never.checked="checked"}if(BX.type.isPlainObject(t.BYDAY)){this.DOM.formElements["EVENT_RRULE[BYDAY][]"].forEach(function(e){e.checked=t.BYDAY.hasOwnProperty(e.value)},this)}}},{key:"getType",value:function e(){return this.DOM.rruleType.value.toLowerCase()}}]);return e}();var M=function(){function e(t){babelHelpers.classCallCheck(this,e);this.id=t.id||"bx-select-input-"+Math.round(Math.random()*1e6);this.values=t.values||false;this.input=t.input;this.defaultValue=t.defaultValue||"";this.openTitle=t.openTitle||"";this.className=t.className||"";this.onChangeCallback=t.onChangeCallback||null;this.zIndex=t.zIndex||1200;this.disabled=t.disabled;this.setValue({value:t.value,valueIndex:t.valueIndex});this.curInd=false;this.bindEventHandlers()}babelHelpers.createClass(e,[{key:"bindEventHandlers",value:function e(){if(this.onChangeCallback){BX.bind(this.input,"change",this.onChangeCallback);BX.bind(this.input,"keyup",this.onChangeCallback)}if(this.values){BX.bind(this.input,"click",BX.proxy(this.onClick,this));BX.bind(this.input,"focus",BX.proxy(this.onFocus,this));BX.bind(this.input,"blur",BX.proxy(this.onBlur,this));BX.bind(this.input,"keyup",BX.proxy(this.onKeyup,this))}}},{key:"setValue",value:function e(t){this.currentValue={value:t.value};this.currentValueIndex=t.valueIndex;if(this.currentValueIndex!==undefined&&this.values[this.currentValueIndex]){this.input.value=this.values[this.currentValueIndex].label}}},{key:"getInputValue",value:function e(){return this.input.value}},{key:"showPopup",value:function e(){if(this.shown||this.disabled)return;var t=0,i=0,a=[],n,s=this;for(n=0;n<this.values.length;n++){if(this.values[n].delimiter){a.push(this.values[n])}else{if(this.currentValue&&this.values[n]&&this.values[n].value===this.currentValue.value){t=i}a.push({id:this.values[n].value,text:this.values[n].label,onclick:this.values[n].callback||function(e,t){return function(){s.input.value=t;s.popupMenu.close();s.onChange()}}(this.values[n].value,this.values[n].labelRaw||this.values[n].label)});i++}}this.popupMenu=BX.PopupMenu.create(this.id,this.input,a,{closeByEsc:true,autoHide:true,zIndex:this.zIndex,offsetTop:0,offsetLeft:-1});this.popupMenu.popupWindow.setWidth(this.input.offsetWidth+2);var o=this.popupMenu.layout.menuContainer;BX.addClass(this.popupMenu.layout.menuContainer,"calendar-select-popup");this.popupMenu.show();var l=this.popupMenu.menuItems[t];if(l&&l.layout){o.scrollTop=l.layout.item.offsetTop-l.layout.item.offsetHeight}BX.addCustomEvent(this.popupMenu.popupWindow,"onPopupClose",function(){BX.PopupMenu.destroy(this.id);this.shown=false;this.popupMenu=null}.bind(this));this.input.select();this.shown=true}},{key:"closePopup",value:function e(){BX.PopupMenu.destroy(this.id);this.popupMenu=null;this.shown=false}},{key:"onFocus",value:function e(){setTimeout(function(){if(!this.shown){this.showPopup()}}.bind(this),200)}},{key:"onClick",value:function e(){if(this.shown){this.closePopup()}else{this.showPopup()}}},{key:"onBlur",value:function e(){setTimeout(BX.delegate(this.closePopup,this),200)}},{key:"onKeyup",value:function e(){setTimeout(BX.delegate(this.closePopup,this),50)}},{key:"onChange",value:function e(){var t=this.input.value;BX.onCustomEvent(this,"onSelectInputChanged",[this,t]);if(BX.type.isFunction(this.onChangeCallback)){this.onChangeCallback({value:t})}}},{key:"destroy",value:function e(){if(this.onChangeCallback){BX.unbind(this.input,"change",this.onChangeCallback);BX.unbind(this.input,"keyup",this.onChangeCallback)}BX.unbind(this.input,"click",BX.proxy(this.onClick,this));BX.unbind(this.input,"focus",BX.proxy(this.onFocus,this));BX.unbind(this.input,"blur",BX.proxy(this.onBlur,this));BX.unbind(this.input,"keyup",BX.proxy(this.onKeyup,this));if(this.popupMenu){this.popupMenu.close()}BX.PopupMenu.destroy(this.id);this.popupMenu=null;this.shown=false}}]);return e}();var y=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.id=t.id||"popup-dialog-"+Math.random();this.zIndex=t.zIndex||3200;this.DOM={};this.title=""}babelHelpers.createClass(e,[{key:"create",value:function e(){this.dialog=new BX.PopupWindow(this.id,null,{overlay:{opacity:10},autoHide:true,closeByEsc:true,zIndex:this.zIndex,offsetLeft:0,offsetTop:0,draggable:true,bindOnResize:false,titleBar:this.getTitle(),closeIcon:{right:"12px",top:"10px"},className:"bxc-popup-window",buttons:this.getButtons(),content:this.getContent(),events:{}})}},{key:"getTitle",value:function e(){return this.title}},{key:"getContent",value:function e(){this.DOM.content=BX.create("DIV");return this.DOM.content}},{key:"getButtons",value:function e(){this.buttons=[];return this.buttons}},{key:"show",value:function e(t){if(!this.dialog){this.create()}this.dialog.show()}},{key:"close",value:function e(){if(this.dialog){this.dialog.close()}}}]);return e}();function T(){var e=babelHelpers.taggedTemplateLiteral(['<div class="calendar-view-switcher-text-mode-inner" style="display: none;"></div>']);T=function t(){return e};return e}function E(){var e=babelHelpers.taggedTemplateLiteral(['<div class="calendar-view-switcher-dropdown"></div>']);E=function t(){return e};return e}function k(){var e=babelHelpers.taggedTemplateLiteral(['<div class="calendar-view-switcher-text-inner"></div>']);k=function t(){return e};return e}function w(){var e=babelHelpers.taggedTemplateLiteral(['<div class="calendar-view-switcher-text"></div>']);w=function t(){return e};return e}function I(){var e=babelHelpers.taggedTemplateLiteral(['<div class="calendar-view-switcher-selector"></div>']);I=function t(){return e};return e}var O=function(e){babelHelpers.inherits(i,e);function i(){var e;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,i);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"views",[]);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"created",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"currentValue",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"currentViewMode",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"DOM",{});e.setEventNamespace("BX.Calendar.Controls.ViewSelector");if(a.Type.isArray(t.views)){e.views=t.views}e.zIndex=t.zIndex||3200;e.popupId=t.id||"view-selector-"+Math.round(Math.random()*1e4);e.create();if(t.currentView){e.setValue(t.currentView)}if(t.currentViewMode){e.setViewMode(t.currentViewMode)}return e}babelHelpers.createClass(i,[{key:"create",value:function e(){this.DOM.wrap=a.Tag.render(I());this.DOM.selectorText=a.Tag.render(w());this.DOM.selectorTextInner=this.DOM.selectorText.appendChild(a.Tag.render(k()));this.DOM.wrap.appendChild(this.DOM.selectorText);this.DOM.wrap.appendChild(a.Tag.render(E()));a.Event.bind(this.DOM.wrap,"click",this.showPopup.bind(this));this.DOM.viewModeTextInner=this.DOM.selectorText.appendChild(a.Tag.render(T()));this.created=true}},{key:"getOuterWrap",value:function e(){if(!this.created){this.create()}return this.DOM.wrap}},{key:"setValue",value:function e(t){this.currentValue=this.views.find(function(e){return t.name===e.name},this);if(this.currentValue){a.Dom.adjust(this.DOM.selectorTextInner,{text:this.currentValue.text})}}},{key:"setViewMode",value:function e(t){if(t){this.currentViewMode=this.views.find(function(e){return t===e.name&&e.type==="additional"},this);if(this.currentViewMode){a.Dom.adjust(this.DOM.viewModeTextInner,{text:"("+this.currentViewMode.text+")"})}this.DOM.viewModeTextInner.style.display=this.currentViewMode?"":"block"}}},{key:"getMenuItems",value:function e(){var t=[];this.views.forEach(function(e){if(e.type==="base"){t.push({text:"<span>"+e.text+"</span>"+(e.hotkey?'<span class="calendar-item-hotkey">'+e.hotkey+"</span>":""),className:this.currentValue.name===e.name?"menu-popup-item-accept":" ",onclick:function(){this.emit("onChange",{name:e.name,type:e.type,dataset:e.dataset});this.menuPopup.close()}.bind(this)})}},this);if(t.length<this.views.length){t.push({text:"<span>"+a.Loc.getMessage("EC_VIEW_MODE_SHOW_BY")+"</span>",className:"main-buttons-submenu-separator main-buttons-submenu-item main-buttons-hidden-label"});this.views.forEach(function(e){if(e.type==="additional"){t.push({text:e.text,className:this.currentViewMode.name===e.name?"menu-popup-item-accept":" ",onclick:function(){this.emit("onChange",{name:e.name,type:e.type,dataset:e.dataset});this.menuPopup.close()}.bind(this)})}},this)}return t}},{key:"showPopup",value:function e(){if(this.menuPopup&&this.menuPopup.popupWindow&&this.menuPopup.popupWindow.isShown()){return this.menuPopup.close()}this.menuPopup=t.MenuManager.create(this.popupId,this.DOM.selectorText,this.getMenuItems(),{className:"calendar-view-switcher-popup",closeByEsc:true,autoHide:true,zIndex:this.zIndex,offsetTop:-3,offsetLeft:this.DOM.selectorText.offsetWidth-6,angle:true,cacheable:false});this.menuPopup.show()}},{key:"closePopup",value:function e(){if(this.menuPopup&&this.menuPopup.popupWindow&&this.menuPopup.popupWindow.isShown()){this.menuPopup.close()}}}]);return i}(n.EventEmitter);function L(){var e=babelHelpers.taggedTemplateLiteral(['<span \n\t\t\t\t\t\tclass="calendar-view-switcher-list-item"\n\t\t\t\t\t\tonclick="','"\n\t\t\t\t\t>',"</span>"]);L=function t(){return e};return e}function B(){var e=babelHelpers.taggedTemplateLiteral(['<div class="calendar-view-switcher-list"></div>']);B=function t(){return e};return e}var N=function(e){babelHelpers.inherits(t,e);function t(){var e;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"views",[]);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"created",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"currentValue",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"currentViewMode",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"DOM",{});e.setEventNamespace("BX.Calendar.Controls.LineViewSelector");if(a.Type.isArray(i.views)){e.views=i.views}e.viewsMap=new WeakMap;e.zIndex=i.zIndex||3200;e.popupId=i.id||"view-selector-"+Math.round(Math.random()*1e4);e.create();if(i.currentView){e.setValue(i.currentView)}return e}babelHelpers.createClass(t,[{key:"create",value:function e(){var t=this;this.DOM.wrap=a.Tag.render(B());this.views.forEach(function(e){if(e.type==="base"){t.viewsMap.set(e,{wrap:t.DOM.wrap.appendChild(a.Tag.render(L(),function(){t.emit("onChange",{name:e.name,type:e.type,dataset:e.dataset})},e.text))})}});this.created=true}},{key:"getOuterWrap",value:function e(){if(!this.created){this.create()}return this.DOM.wrap}},{key:"setValue",value:function e(t){this.currentValue=this.views.find(function(e){return t.name===e.name},this);if(this.currentValue){var i=this.viewsMap.get(this.currentValue);var n=this.DOM.wrap.querySelector(".calendar-view-switcher-list-item-active");if(a.Type.isDomNode(n)){a.Dom.removeClass(n,"calendar-view-switcher-list-item-active")}if(a.Type.isDomNode(i.wrap)){a.Dom.addClass(i.wrap,"calendar-view-switcher-list-item-active")}}}},{key:"setViewMode",value:function e(t){if(t){this.currentViewMode=this.views.find(function(e){return t===e.name&&e.type==="additional"},this)}}},{key:"getMenuItems",value:function e(){var t=this;var i=[];this.views.forEach(function(e){if(e.type==="base"){i.push({text:"<span>"+e.text+"</span>"+(e.hotkey?'<span class="calendar-item-hotkey">'+e.hotkey+"</span>":""),className:t.currentValue.name===e.name?"menu-popup-item-accept":" ",onclick:function i(){t.emit("onChange",{name:e.name,type:e.type,dataset:e.dataset});t.menuPopup.close()}})}});if(i.length<this.views.length){i.push({text:"<span>"+a.Loc.getMessage("EC_VIEW_MODE_SHOW_BY")+"</span>",className:"main-buttons-submenu-separator main-buttons-submenu-item main-buttons-hidden-label"});this.views.forEach(function(e){if(e.type==="additional"){i.push({text:e.text,className:this.currentViewMode.name===e.name?"menu-popup-item-accept":" ",onclick:function(){this.emit("onChange",{name:e.name,type:e.type,dataset:e.dataset});this.menuPopup.close()}.bind(this)})}},this)}return i}}]);return t}(n.EventEmitter);var _=function(e){babelHelpers.inherits(t,e);function t(){var e;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"showTasks",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"DOM",{});e.setEventNamespace("BX.Calendar.Controls.AddButton");e.zIndex=i.zIndex||3200;e.popupId=i.id||"add-button-"+Math.round(Math.random()*1e4);e.showTasks=i.showTasks;e.addEntryHandler=a.Type.isFunction(i.addEntry)?i.addEntry:null;e.addTaskHandler=a.Type.isFunction(i.addTask)?i.addTask:null;e.create();return e}babelHelpers.createClass(t,[{key:"create",value:function e(){this.menuItems=[{text:a.Loc.getMessage("EC_ADD_EVENT"),onclick:this.addEntry.bind(this)}];if(this.addTaskHandler){this.menuItems.push({text:a.Loc.getMessage("EC_ADD_TASK"),onclick:this.addTask.bind(this)})}if(this.menuItems.length>1){this.DOM.wrap=a.Dom.create("span",{props:{className:"ui-btn-split ui-btn-primary"},children:[a.Dom.create("button",{props:{className:"ui-btn-main",type:"button"},html:a.Loc.getMessage("EC_ADD"),events:{click:this.addEntry.bind(this)}})]});this.DOM.addButtonExtra=a.Dom.create("span",{props:{className:"ui-btn-extra"},events:{click:this.showPopup.bind(this)}});this.DOM.wrap.appendChild(this.DOM.addButtonExtra)}else{this.DOM.wrap=a.Dom.create("button",{props:{className:"ui-btn ui-btn-primary",type:"button"},html:a.Loc.getMessage("EC_ADD"),events:{click:this.addEntry.bind(this)}})}}},{key:"getWrap",value:function e(){return this.DOM.wrap}},{key:"showPopup",value:function e(){if(this.menuPopup&&this.menuPopup.popupWindow&&this.menuPopup.popupWindow.isShown()){return this.menuPopup.close()}this.menuPopup=BX.PopupMenu.create(this.popupId,this.DOM.addButtonExtra,this.menuItems,{closeByEsc:true,autoHide:true,zIndex:this.zIndex,offsetTop:0,offsetLeft:15,angle:true});this.menuPopup.show();BX.addCustomEvent(this.menuPopup.popupWindow,"onPopupClose",function(){BX.PopupMenu.destroy(this.popupId);this.menuPopup=null;this.addBtnMenu=null}.bind(this))}},{key:"addEntry",value:function e(){if(this.addEntryHandler){this.addEntryHandler()}if(this.menuPopup&&this.menuPopup.popupWindow&&this.menuPopup.popupWindow.isShown()){this.menuPopup.close()}}},{key:"addTask",value:function e(){if(this.addTaskHandler){this.addTaskHandler()}if(this.menuPopup&&this.menuPopup.popupWindow&&this.menuPopup.popupWindow.isShown()){this.menuPopup.close()}}}]);return t}(a.Event.EventEmitter);var x=function(e){babelHelpers.inherits(t,e);function t(){var e;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"showTasks",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"DOM",{});e.setEventNamespace("BX.Calendar.Controls.MeetingStatusControl");e.BX=i.Util.getBX();if(n.wrap&&a.Type.isDomNode(n.wrap)){e.DOM.wrap=n.wrap}else{throw new Error('The argument "params.wrap" must be a DOM node.')}e.id=n.id||"meeting-status-control-"+Math.round(Math.random()*1e4);e.zIndex=3100;e.create();e.status=n.currentStatus||null;if(e.status){e.updateStatus()}return e}babelHelpers.createClass(t,[{key:"create",value:function e(){this.DOM.selectorButton=this.DOM.wrap.appendChild(a.Dom.create("SPAN",{props:{className:"webform-small-button webform-small-button-transparent webform-small-button-dropdown"},events:{click:this.showPopup.bind(this)}}));this.DOM.selectorButtonText=this.DOM.selectorButton.appendChild(a.Dom.create("SPAN",{props:{className:"webform-small-button-text"}}));this.DOM.selectorButtonIcon=this.DOM.selectorButton.appendChild(a.Dom.create("SPAN",{props:{className:"webform-small-button-icon"}}));this.DOM.buttonY=this.DOM.wrap.appendChild(a.Dom.create("SPAN",{props:{className:"webform-small-button webform-small-button-accept"},events:{click:this.accept.bind(this)},html:a.Loc.getMessage("EC_VIEW_DESIDE_BUT_Y")}));this.DOM.buttonN=this.DOM.wrap.appendChild(a.Dom.create("SPAN",{props:{className:"webform-small-button webform-small-button-transparent"},events:{click:this.decline.bind(this)},html:a.Loc.getMessage("EC_VIEW_DESIDE_BUT_N")}))}},{key:"updateStatus",value:function e(){if(this.status==="Q"){this.DOM.selectorButton.style.display="none";this.DOM.buttonY.style.display="";this.DOM.buttonN.style.display=""}else{this.DOM.selectorButton.style.display="";this.DOM.selectorButtonText.innerHTML=a.Loc.getMessage("EC_VIEW_STATUS_BUT_"+this.status);this.DOM.buttonY.style.display="none";this.DOM.buttonN.style.display="none"}}},{key:"accept",value:function e(){this.setStatus("Y")}},{key:"decline",value:function e(){this.setStatus("N")}},{key:"setStatus",value:function e(t){this.status=t;if(this.menuPopup){this.menuPopup.close()}var i=true;if(a.Type.isFunction(this.changeStatusCallback)){i=this.changeStatusCallback(this.status)}this.emit("onSetStatus",new a.Event.BaseEvent({data:{status:t}}));if(i){this.updateStatus()}}},{key:"showPopup",value:function e(){if(this.menuPopup&&this.menuPopup.popupWindow&&this.menuPopup.popupWindow.isShown()){return this.menuPopup.close()}var t;if(this.status==="Y"||this.status==="H"){t=[{text:a.Loc.getMessage("EC_VIEW_DESIDE_BUT_N"),onclick:this.decline.bind(this)}]}else if(this.status==="N"){t=[{text:a.Loc.getMessage("EC_VIEW_DESIDE_BUT_Y"),onclick:this.accept.bind(this)}]}else if(this.status==="I"){t=[{text:a.Loc.getMessage("EC_VIEW_DESIDE_BUT_Y"),onclick:this.accept.bind(this)},{text:a.Loc.getMessage("EC_VIEW_DESIDE_BUT_N"),onclick:this.decline.bind(this)}]}this.menuPopup=this.BX.PopupMenu.create(this.id,this.DOM.selectorButtonIcon,t,{closeByEsc:true,autoHide:true,zIndex:this.zIndex,offsetTop:15,offsetLeft:5,angle:true,cacheable:false});this.menuPopup.show()}}]);return t}(a.Event.EventEmitter);var S=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"DOM",{});e.setEventNamespace("BX.Calendar.Controls.ConfirmStatusDialog");e.zIndex=3200;e.id="confirm-status-dialog-"+Math.round(Math.random()*1e4);return e}babelHelpers.createClass(t,[{key:"show",value:function e(){var t=a.Dom.create("DIV");this.dialog=new BX.PopupWindow(this.id,null,{overlay:{opacity:10},autoHide:true,closeByEsc:true,zIndex:this.zIndex,offsetLeft:0,offsetTop:0,draggable:true,bindOnResize:false,titleBar:a.Loc.getMessage("EC_DECLINE_REC_EVENT"),closeIcon:{right:"12px",top:"10px"},className:"bxc-popup-window",buttons:[new BX.PopupWindowButtonLink({text:a.Loc.getMessage("EC_SEC_SLIDER_CANCEL"),className:"popup-window-button-link-cancel",events:{click:this.close.bind(this)}})],content:t,events:{}});t.appendChild(new BX.PopupWindowButton({text:a.Loc.getMessage("EC_DECLINE_ONLY_THIS"),events:{click:function(){this.emit("onDecline",new n.BaseEvent({data:{recursionMode:"this"}}));this.close()}.bind(this)}}).buttonNode);t.appendChild(new BX.PopupWindowButton({text:a.Loc.getMessage("EC_DECLINE_NEXT"),events:{click:function(){this.emit("onDecline",new n.BaseEvent({data:{recursionMode:"next"}}));this.close()}.bind(this)}}).buttonNode);t.appendChild(new BX.PopupWindowButton({text:a.Loc.getMessage("EC_DECLINE_ALL"),events:{click:function(){this.emit("onDecline",new n.BaseEvent({data:{recursionMode:"all"}}));this.close()}.bind(this)}}).buttonNode);this.dialog.show()}},{key:"close",value:function e(){if(this.dialog){this.dialog.close()}}}]);return t}(n.EventEmitter);var H=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"DOM",{});e.setEventNamespace("BX.Calendar.Controls.ConfirmEditDialog");e.zIndex=3200;e.id="confirm-status-dialog-"+Math.round(Math.random()*1e4);return e}babelHelpers.createClass(t,[{key:"show",value:function e(){var t=this;var i=a.Dom.create("DIV");this.dialog=new BX.PopupWindow(this.id,null,{overlay:{opacity:10},autoHide:true,closeByEsc:true,zIndex:this.zIndex,offsetLeft:0,offsetTop:0,draggable:true,bindOnResize:false,titleBar:a.Loc.getMessage("EC_EDIT_REC_EVENT"),closeIcon:{right:"12px",top:"10px"},className:"bxc-popup-window",buttons:[new BX.PopupWindowButtonLink({text:a.Loc.getMessage("EC_SEC_SLIDER_CANCEL"),className:"popup-window-button-link-cancel",events:{click:this.close.bind(this)}})],content:i,events:{},cacheable:false});i.appendChild(new BX.PopupWindowButton({text:a.Loc.getMessage("EC_REC_EV_ONLY_THIS_EVENT"),events:{click:function e(){t.emit("onEdit",new n.BaseEvent({data:{recursionMode:"this"}}));t.close()}}}).buttonNode);i.appendChild(new BX.PopupWindowButton({text:a.Loc.getMessage("EC_REC_EV_NEXT"),events:{click:function e(){t.emit("onEdit",new n.BaseEvent({data:{recursionMode:"next"}}));t.close()}}}).buttonNode);i.appendChild(new BX.PopupWindowButton({text:a.Loc.getMessage("EC_REC_EV_ALL"),events:{click:function e(){t.emit("onEdit",new n.BaseEvent({data:{recursionMode:"all"}}));t.close()}}}).buttonNode);this.dialog.show()}},{key:"close",value:function e(){if(this.dialog){this.dialog.close()}}}]);return t}(n.EventEmitter);var X=function(e){babelHelpers.inherits(t,e);function t(){var e;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,i));e.title=BX.message("EC_DEL_REC_EVENT");e.entry=i.entry;return e}babelHelpers.createClass(t,[{key:"getContent",value:function e(){this.DOM.content=BX.create("DIV");this.DOM.content.appendChild(new BX.PopupWindowButton({text:BX.message("EC_REC_EV_ONLY_THIS_EVENT"),events:{click:function(){this.entry.deleteThis();this.close()}.bind(this)}}).buttonNode);this.DOM.content.appendChild(new BX.PopupWindowButton({text:BX.message("EC_REC_EV_NEXT"),events:{click:function(){this.entry.deleteNext();this.close()}.bind(this)}}).buttonNode);this.DOM.content.appendChild(new BX.PopupWindowButton({text:BX.message("EC_REC_EV_ALL"),events:{click:function(){this.entry.deleteAll();this.close()}.bind(this)}}).buttonNode);return this.DOM.content}},{key:"getButtons",value:function e(){return[new BX.PopupWindowButtonLink({text:BX.message("EC_SEC_SLIDER_CANCEL"),className:"popup-window-button-link-cancel",events:{click:this.close.bind(this)}})]}}]);return t}(y);function P(){var e=babelHelpers.taggedTemplateLiteral(['<label for="{this.UID}">',"</label>"]);P=function t(){return e};return e}function V(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<input value="Y" type="checkbox" id="{this.UID}"/>\n\t\t\t']);V=function t(){return e};return e}function R(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span class="calendar-event-full-day"></span>\n\t\t\t']);R=function t(){return e};return e}function z(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<input class="calendar-field calendar-field-datetime" value="" type="text" autocomplete="off" style="width: 120px;"/>\n\t\t\t']);z=function t(){return e};return e}function W(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<input class="calendar-field calendar-field-datetime-menu" value="" type="text" autocomplete="off"/>\n\t\t\t']);W=function t(){return e};return e}function A(){var e=babelHelpers.taggedTemplateLiteral(['<div class="calendar-field-block calendar-field-block-between" />']);A=function t(){return e};return e}function U(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<input class="calendar-field calendar-field-datetime-menu" value="" type="text" autocomplete="off"/>\n\t\t\t']);U=function t(){return e};return e}function F(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<input class="calendar-field calendar-field-datetime" value="" type="text" autocomplete="off" style="width: 120px;"/>\n\t\t\t']);F=function t(){return e};return e}var Y=function(e){babelHelpers.inherits(t,e);function t(e){var i;var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{showTimezone:true};babelHelpers.classCallCheck(this,t);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));i.setEventNamespace("BX.Calendar.Controls.DateTimeControl");i.showTimezone=a.showTimezone;i.UID=e||"date-time-"+Math.round(Math.random()*1e5);i.DOM={outerWrap:a.outerWrap||null,outerContent:a.outerContent||null};i.create();return i}babelHelpers.createClass(t,[{key:"create",value:function e(){if(a.Type.isDomNode(this.DOM.outerWrap)){this.DOM.fromDate=this.DOM.outerWrap.appendChild(a.Tag.render(F()));this.DOM.fromTime=this.DOM.outerWrap.appendChild(a.Tag.render(U()));this.DOM.outerWrap.appendChild(a.Tag.render(A()));this.DOM.toTime=this.DOM.outerWrap.appendChild(a.Tag.render(W()));this.DOM.toDate=this.DOM.outerWrap.appendChild(a.Tag.render(z()));this.fromTimeControl=new s({input:this.DOM.fromTime,onChangeCallback:this.handleTimeFromChange.bind(this)});this.toTimeControl=new s({input:this.DOM.toTime,onChangeCallback:this.handleTimeToChange.bind(this)});var t=this.DOM.outerWrap.appendChild(a.Tag.render(R()));this.DOM.fullDay=t.appendChild(a.Tag.render(V()));t.appendChild(a.Tag.render(P(),a.Loc.getMessage("EC_ALL_DAY")))}if(this.showTimezone);this.bindEventHandlers()}},{key:"setValue",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.DOM.fromDate.value=i.Util.formatDate(t.from);this.DOM.toDate.value=i.Util.formatDate(t.to);this.lastDateValue=t.from;this.fromTimeControl.setValue(t.from);this.toTimeControl.setValue(t.to);this.DOM.fromTime.value=i.Util.formatTime(t.from);this.DOM.toTime.value=i.Util.formatTime(t.to);if(t.fullDay!==undefined){this.DOM.fullDay.checked=t.fullDay}if(this.showTimezone){t.timezoneFrom=t.timezoneFrom||t.timezoneName;t.timezoneTo=t.timezoneTo||t.timezoneName;if(t.timezoneFrom!==undefined&&a.Type.isDomNode(this.DOM.fromTz)){this.DOM.fromTz.value=t.timezoneFrom}if(t.timezoneTo!==undefined&&a.Type.isDomNode(this.DOM.toTz)){this.DOM.toTz.value=t.timezoneTo}if(t.timezoneName!==undefined&&(t.timezoneName!==t.timezoneFrom||t.timezoneName!==t.timezoneTo)){this.switchTimezone(true)}}this.handleFullDayChange()}},{key:"getValue",value:function e(){var t={fullDay:this.DOM.fullDay.checked,fromDate:this.DOM.fromDate.value,toDate:this.DOM.toDate.value,fromTime:this.DOM.fromTime.value,toTime:this.DOM.toTime.value,timezoneFrom:this.DOM.fromTz?this.DOM.fromTz.value:null,timezoneTo:this.DOM.toTz?this.DOM.toTz.value:null};t.from=i.Util.parseDate(t.fromDate);if(a.Type.isDate(t.from)){t.to=i.Util.parseDate(t.toDate);if(!a.Type.isDate(t.to)){t.to=t.from}if(t.fullDay){t.from.setHours(0,0,0);t.to.setHours(0,0,0)}else{var n=i.Util.parseTime(t.fromTime),s=i.Util.parseTime(t.toTime)||n;if(n&&s){t.from.setHours(n.h,n.m,0);t.to.setHours(s.h,s.m,0)}}}return t}},{key:"bindEventHandlers",value:function e(){a.Event.bind(this.DOM.fromDate,"click",t.showInputCalendar);a.Event.bind(this.DOM.fromDate,"change",this.handleDateFromChange.bind(this));a.Event.bind(this.DOM.toDate,"click",t.showInputCalendar);a.Event.bind(this.DOM.toDate,"change",this.handleDateToChange.bind(this));a.Event.bind(this.DOM.fullDay,"click",this.handleFullDayChange.bind(this));if(a.Type.isDomNode(this.DOM.defTimezone)){a.Event.bind(this.DOM.defTimezone,"change",BX.delegate(function(){if(this.bindFromToDefaultTimezones){this.DOM.fromTz.value=this.DOM.toTz.value=this.DOM.defTimezone.value}},this))}if(this.showTimezone){if(a.Type.isDomNode(this.DOM.tzButton)){a.Event.bind(this.DOM.tzButton,"click",this.switchTimezone.bind(this))}a.Event.bind(this.DOM.fromTz,"change",function(){if(this.bindTimezones){this.DOM.toTz.value=this.DOM.fromTz.value}this.bindFromToDefaultTimezones=false}.bind(this));a.Event.bind(this.DOM.toTz,"change",function(){this.bindTimezones=false;this.bindFromToDefaultTimezones=false}.bind(this));this.bindTimezones=this.DOM.fromTz.value===this.DOM.toTz.value;this.bindFromToDefaultTimezones=this.bindTimezones&&this.DOM.fromTz.value===this.DOM.toTz.value&&this.DOM.fromTz.value===this.DOM.defTimezone.value}}},{key:"handleDateFromChange",value:function e(){var t=i.Util.parseTime(this.DOM.fromTime.value),a=i.Util.parseTime(this.DOM.toTime.value),n=i.Util.parseDate(this.DOM.fromDate.value),s=i.Util.parseDate(this.DOM.toDate.value);if(this.lastDateValue){if(this.DOM.fullDay.checked&&this.lastDateValue){this.lastDateValue.setHours(0,0,0)}else{if(n&&t){n.setHours(t.h,t.m,0)}if(s&&a){s.setHours(a.h,a.m,0)}}if(n&&this.lastDateValue){s=new Date(n.getTime()+(s.getTime()-this.lastDateValue.getTime()||36e5));if(s){this.DOM.toDate.value=i.Util.formatDate(s)}}}this.lastDateValue=n;this.handleValueChange()}},{key:"handleTimeFromChange",value:function e(){var t=i.Util.parseTime(this.DOM.fromTime.value),a=i.Util.parseTime(this.DOM.toTime.value),n=i.Util.parseDate(this.DOM.fromDate.value),s=i.Util.parseDate(this.DOM.toDate.value);if(n&&t){n.setHours(t.h,t.m,0)}if(s&&a){s.setHours(a.h,a.m,0)}if(this.lastDateValue){var o=new Date(i.Util.getTimeRounded(n)+i.Util.getTimeRounded(s)-i.Util.getTimeRounded(this.lastDateValue));this.DOM.toTime.value=i.Util.formatTime(o);this.DOM.toDate.value=i.Util.formatDate(o)}this.lastDateValue=n;this.handleValueChange()}},{key:"handleDateToChange",value:function e(){this.handleValueChange()}},{key:"handleTimeToChange",value:function e(){this.handleValueChange()}},{key:"handleFullDayChange",value:function e(){var t=this.getFullDayValue();if(t){a.Dom.addClass(this.DOM.dateTimeWrap,"calendar-options-item-datetime-hide-time")}else{a.Dom.removeClass(this.DOM.dateTimeWrap,"calendar-options-item-datetime-hide-time")}this.handleValueChange()}},{key:"handleValueChange",value:function e(){this.emit("onChange",new n.BaseEvent({data:{value:this.getValue()}}))}},{key:"getFullDayValue",value:function e(){return!!this.DOM.fullDay.checked}},{key:"switchTimezone",value:function e(t){if(!a.Type.isBoolean(t)){t=BX.hasClass(this.DOM.tzCont,"calendar-options-timezone-collapse")}if(t){a.Dom.addClass(this.DOM.tzCont,"calendar-options-timezone-expand");a.Dom.removeClass(this.DOM.tzCont,"calendar-options-timezone-collapse")}else{a.Dom.addClass(this.DOM.tzCont,"calendar-options-timezone-collapse");a.Dom.removeClass(this.DOM.tzCont,"calendar-options-timezone-expand")}}}],[{key:"showInputCalendar",value:function e(i){var n=i.target||i.srcElement;if(a.Type.isDomNode(n)&&n.nodeName.toLowerCase()==="input"){BX.calendar({node:n.parentNode,field:n,bTime:false});BX.onCustomEvent(window,"onCalendarControlChildPopupShown");if(BX.calendar.get().popup){BX.removeCustomEvent(BX.calendar.get().popup,"onPopupClose",t.inputCalendarClosePopupHandler);BX.addCustomEvent(BX.calendar.get().popup,"onPopupClose",t.inputCalendarClosePopupHandler)}}}},{key:"inputCalendarClosePopupHandler",value:function e(t){BX.onCustomEvent(window,"onCalendarControlChildPopupClosed")}}]);return t}(n.EventEmitter);var j=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(e),"DOM",{});e.setEventNamespace("BX.Calendar.Controls.ConfirmStatusDialog");e.zIndex=3200;e.id="confirm-status-dialog-"+Math.round(Math.random()*1e4);return e}babelHelpers.createClass(t,[{key:"show",value:function e(){var t=this;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.plural=i.users.length>1;var n,s=[];for(n=0;n<i.users.length;n++){s.push(i.users[n].DISPLAY_NAME)}s=s.join(", ");var o=BX.create("DIV",{props:{className:"calendar-busy-users-content-wrap"},html:'<div class="calendar-busy-users-content">'+BX.util.htmlspecialchars(this.plural?a.Loc.getMessage("EC_BUSY_USERS_PLURAL").replace("#USER_LIST#",s):a.Loc.getMessage("EC_BUSY_USERS_SINGLE").replace("#USER_NAME#",i.users[0].DISPLAY_NAME))+"</div>"});this.dialog=new BX.PopupWindow(this.id,null,{overlay:{opacity:10},autoHide:true,closeByEsc:true,zIndex:this.zIndex,offsetLeft:0,offsetTop:0,draggable:true,bindOnResize:false,titleBar:a.Loc.getMessage("EC_BUSY_USERS_TITLE"),closeIcon:{right:"12px",top:"10px"},className:"bxc-popup-window",content:o,events:{}});o.appendChild(new BX.PopupWindowButton({text:a.Loc.getMessage("EC_BUSY_USERS_BACK2EDIT"),events:{click:function e(){t.close()}}}).buttonNode);o.appendChild(new BX.PopupWindowButton({text:this.plural?a.Loc.getMessage("EC_BUSY_USERS_EXCLUDE_PLURAL"):a.Loc.getMessage("EC_BUSY_USERS_EXCLUDE_SINGLE"),events:{click:function e(){t.emit("onSaveWithout");t.close()}}}).buttonNode);this.dialog.show()}},{key:"close",value:function e(){if(this.dialog){this.dialog.close()}}}]);return t}(n.EventEmitter);e.Reminder=f;e.Location=v;e.UserSelector=b;e.ColorSelector=g;e.SectionSelector=D;e.RepeatSelector=C;e.TimeSelector=s;e.SelectInput=M;e.PopupDialog=y;e.ViewSelector=O;e.LineViewSelector=N;e.AddButton=_;e.MeetingStatusControl=x;e.ConfirmStatusDialog=S;e.ConfirmEditDialog=H;e.ConfirmDeleteDialog=X;e.DateTimeControl=Y;e.BusyUsersDialog=j})(this.BX.Calendar.Controls=this.BX.Calendar.Controls||{},BX.Main,BX.Calendar,BX,BX.Event);
//# sourceMappingURL=controls.bundle.map.js