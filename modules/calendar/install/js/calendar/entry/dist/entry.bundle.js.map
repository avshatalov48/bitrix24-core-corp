{"version":3,"file":"entry.bundle.js","sources":["../src/entrymanager.js","../src/entry.js"],"sourcesContent":["import { Entry } from 'calendar.entry';\nimport { SectionManager } from 'calendar.sectionmanager';\nimport { Util } from 'calendar.util';\nimport {Dom, Event, Loc, Tag, Type} from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { CompactEventForm } from 'calendar.compacteventform';\nimport 'ui.notification';\nimport { RoomsManager } from 'calendar.roomsmanager';\nimport {MessageBox} from \"ui.dialogs.messagebox\";\n\nexport class EntryManager {\n\tstatic newEntryName = '';\n\tstatic userIndex = {};\n\tstatic delayedActionList = [];\n\tstatic DELETE_DELAY_TIMEOUT = 4000;\n\tstatic slidersMap = new WeakMap();\n\n\tstatic getNewEntry(options)\n\t{\n\t\tconst newEntryData = {};\n\t\tconst dateTime = EntryManager.getNewEntryTime(new Date());\n\t\tconst userSettings = Util.getUserSettings();\n\t\tconst userId = Util.getCurrentUserId();\n\n\t\tnewEntryData.ID = null;\n\t\tnewEntryData.NAME = EntryManager.getNewEntryName();\n\t\tnewEntryData.dateFrom = dateTime.from;\n\t\tnewEntryData.dateTo = dateTime.to;\n\t\tif(options.type === 'location')\n\t\t{\n\t\t\tnewEntryData.SECT_ID = RoomsManager.getNewEntrySectionId(options.type, parseInt(options.ownerId));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewEntryData.SECT_ID = SectionManager.getNewEntrySectionId(options.type, parseInt(options.ownerId));\n\t\t}\n\t\tnewEntryData.REMIND = EntryManager.getNewEntryReminders();\n\n\t\tnewEntryData.attendeesEntityList = [{entityId: 'user', id: userId}];\n\t\tnewEntryData.ATTENDEE_LIST = [{id: Util.getCurrentUserId(), status: \"H\"}];\n\n\t\tif (options.type === 'user' && userId !== options.ownerId)\n\t\t{\n\t\t\tnewEntryData.attendeesEntityList.push({entityId: 'user', id: options.ownerId});\n\t\t\tnewEntryData.ATTENDEE_LIST = [\n\t\t\t\t{id: options.ownerId, status: \"H\"},\n\t\t\t\t{id: Util.getCurrentUserId(), status: \"Y\"}\n\t\t\t];\n\t\t}\n\t\telse if (options.type === 'group')\n\t\t{\n\t\t\tnewEntryData.attendeesEntityList.push({entityId: 'project', id: options.ownerId});\n\t\t}\n\n\t\tnewEntryData.TZ_FROM = userSettings.timezoneName || userSettings.timezoneDefaultName || '';\n\t\tnewEntryData.TZ_TO = userSettings.timezoneName || userSettings.timezoneDefaultName || '';\n\n\t\treturn new Entry({data: newEntryData});\n\t}\n\n\tstatic getNewEntryTime(date, duration)\n\t{\n\t\tdate = Util.getUsableDateTime(date);\n\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tconst displayedViewRange = calendarContext.getDisplayedViewRange();\n\t\t\tif (Type.isDate(displayedViewRange?.start))\n\t\t\t{\n\t\t\t\tconst dateTime = date.getTime();\n\t\t\t\tif (\n\t\t\t\t\tdateTime < displayedViewRange.start.getTime()\n\t\t\t\t\t|| dateTime > displayedViewRange.end.getTime()\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tconst startDate = new Date(displayedViewRange.start.getTime());\n\t\t\t\t\tconst workTime = calendarContext.util.getWorkTime();\n\t\t\t\t\tstartDate.setHours(workTime.start, 0, 0,0);\n\t\t\t\t\tdate = Util.getUsableDateTime(startDate);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tfrom : date,\n\t\t\tto : new Date(date.getTime() + (duration || 3600) * 1000)\n\t\t}\n\t}\n\n\tstatic getNewEntryName(): string\n\t{\n\t\treturn (EntryManager.newEntryName || '');\n\t}\n\n\tstatic setNewEntryName(newEntryName)\n\t{\n\t\tEntryManager.newEntryName = newEntryName;\n\t}\n\n\tstatic showEditEntryNotification(entryId)\n\t{\n\t\tUtil.showNotification(\n\t\t\tLoc.getMessage('CALENDAR_SAVE_EVENT_NOTIFICATION'),\n\t\t\t[{\n\t\t\t\ttitle: Loc.getMessage('CALENDAR_EVENT_DO_VIEW'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: function(event, balloon, action) {\n\n\t\t\t\t\t\tEntryManager.openViewSlider(entryId);\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}]\n\t\t)\n\t}\n\n\tstatic showNewEntryNotification(entryId)\n\t{\n\t\tUtil.showNotification(\n\t\t\tLoc.getMessage('CALENDAR_NEW_EVENT_NOTIFICATION'),\n\t\t\t[{\n\t\t\t\ttitle: Loc.getMessage('CALENDAR_EVENT_DO_VIEW'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (event, balloon, action) => {\n\n\t\t\t\t\t\tEntryManager.openViewSlider(entryId);\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}]\n\t\t)\n\t}\n\n\tstatic showDeleteEntryNotification(entry)\n\t{\n\t\tif (entry && entry instanceof Entry)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tid: 'calendar' + entry.getUniqueId(),\n\t\t\t\tcontent: Loc.getMessage('CALENDAR_DELETE_EVENT_NOTIFICATION'),\n\t\t\t\tactions: [{\n\t\t\t\t\ttitle: Loc.getMessage('CALENDAR_EVENT_DO_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon, action) => {\n\t\t\t\t\t\t\tentry.cancelDelete();\n\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showReleaseLocationNotification()\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('CALENDAR_RELEASE_LOCATION_NOTIFICATION'),\n\t\t});\n\t}\n\n\tstatic closeDeleteNotificationBalloon(entry)\n\t{\n\t\tif (entry && entry instanceof Entry)\n\t\t{\n\t\t\tconst balloon = BX.UI.Notification.Center.getBalloonById('calendar' + entry.getUniqueId());\n\t\t\tif (balloon)\n\t\t\t{\n\t\t\t\tballoon.close();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic openEditSlider(options = {})\n\t{\n\t\tconst bx = Util.getBX();\n\n\t\tif (bx.Calendar && bx.Calendar.SliderLoader)\n\t\t{\n\t\t\tnew bx.Calendar.SliderLoader(\n\t\t\t\toptions.entry ? 'EDIT' + options.entry.id : 'NEW',\n\t\t\t\t{\n\t\t\t\t\tcalendarContext: options.calendarContext,\n\t\t\t\t\tentry: options.entry || null,\n\t\t\t\t\ttype: options.type,\n\t\t\t\t\tisLocationCalendar: options.isLocationCalendar || false,\n\t\t\t\t\troomsManager: options.roomsManager || null,\n\t\t\t\t\tlocationAccess: options.locationAccess || false,\n\t\t\t\t\tdayOfWeekMonthFormat: options.dayOfWeekMonthFormat || false,\n\t\t\t\t\tlocationCapacity: options.locationCapacity || 0,\n\t\t\t\t\townerId: options.ownerId,\n\t\t\t\t\tuserId: options.userId,\n\t\t\t\t\tformDataValue: options.formDataValue || null,\n\t\t\t\t\tjumpToControl: options.jumpToControl,\n\t\t\t\t}\n\t\t\t).show();\n\t\t}\n\t}\n\n\tstatic openViewSlider(eventId = null, options = {})\n\t{\n\t\tif (!Type.isNull(eventId))\n\t\t{\n\t\t\tconst bx = Util.getBX();\n\t\t\tif (bx.Calendar && bx.Calendar.SliderLoader)\n\t\t\t{\n\t\t\t\tnew bx.Calendar.SliderLoader(eventId, {\n\t\t\t\t\tentryDateFrom: options.from,\n\t\t\t\t\ttimezoneOffset: options.timezoneOffset,\n\t\t\t\t\tdayOfWeekMonthFormat: options.dayOfWeekMonthFormat || false,\n\t\t\t\t\tcalendarContext: options.calendarContext || null,\n\t\t\t\t\tlink: options.link,\n\t\t\t\t}).show();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic deleteEntry(entry, calendarContext = null)\n\t{\n\t\tif (entry instanceof Entry)\n\t\t{\n\t\t\tconst slider = Util.getBX().SidePanel.Instance.getTopSlider();\n\t\t\tconst beforeDeleteHandler = () => {\n\t\t\t\tif (slider && slider.options.type === 'calendar:slider')\n\t\t\t\t{\n\t\t\t\t\tUtil.getBX().SidePanel.Instance.close();\n\t\t\t\t}\n\t\t\t};\n\t\t\tEventEmitter.subscribe('BX.Calendar.Entry:beforeDelete', beforeDeleteHandler);\n\n\t\t\tconst deleteHandler = () => {\n\t\t\t\tconst calendar = Util.getCalendarContext();\n\n\t\t\t\tif (calendar)\n\t\t\t\t{\n\t\t\t\t\tcalendar.reload();\n\t\t\t\t}\n\t\t\t\telse if (calendarContext)\n\t\t\t\t{\n\t\t\t\t\tcalendarContext.reload();\n\t\t\t\t}\n\t\t\t\tEventEmitter.unsubscribe('BX.Calendar.Entry:delete', deleteHandler);\n\t\t\t\tEventEmitter.unsubscribe('BX.Calendar.Entry:beforeDelete', beforeDeleteHandler);\n\t\t\t};\n\n\t\t\tEventEmitter.subscribe('BX.Calendar.Entry:delete', deleteHandler);\n\n\t\t\tentry.delete();\n\t\t}\n\t}\n\n\tstatic setMeetingStatus(entry, status, params = {})\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tif (!Type.isPlainObject(params))\n\t\t\t{\n\t\t\t\tparams = {};\n\t\t\t}\n\t\t\tparams.recursionMode = params.recursionMode || false;\n\n\t\t\tif (status === 'N' && !params.confirmed)\n\t\t\t{\n\t\t\t\tif (entry.isRecursive())\n\t\t\t\t{\n\t\t\t\t\tthis.showConfirmStatusDialog(entry, resolve);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.setMeetingStatus', {\n\t\t\t\tdata: {\n\t\t\t\t\tentryId: entry.id,\n\t\t\t\t\tentryParentId: entry.parentId,\n\t\t\t\t\tstatus: status,\n\t\t\t\t\trecursionMode: params.recursionMode,\n\t\t\t\t\tcurrentDateFrom: Util.formatDate(entry.from)\n\t\t\t\t}\n\t\t\t}).then(\n\t\t\t\t(response) => {\n\t\t\t\t\tBX.Event.EventEmitter.emit(\n\t\t\t\t\t\t'BX.Calendar.Entry:onChangeMeetingStatus',\n\t\t\t\t\t\tnew Event.BaseEvent({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tentry: entry,\n\t\t\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\t\t\trecursionMode: params.recursionMode,\n\t\t\t\t\t\t\t\tcurrentDateFrom: entry.from,\n\t\t\t\t\t\t\t\tcounters: response.data.counters\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t\tif (entry instanceof Entry)\n\t\t\t\t\t{\n\t\t\t\t\t\tentry.setCurrentStatus(status);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tentry: entry,\n\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\trecursionMode: params.recursionMode,\n\t\t\t\t\t\tcurrentDateFrom: entry.from\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic showConfirmStatusDialog(entry, resolvePromiseCallback = null)\n\t{\n\t\tif (!this.confirmDeclineDialog)\n\t\t{\n\t\t\tthis.confirmDeclineDialog = this.createConfirmStatusDialog();\n\t\t}\n\n\t\tthis.confirmDeclineDialog.show();\n\t\tthis.confirmDeclineDialog.unsubscribeAll('onDecline');\n\t\tthis.confirmDeclineDialog.subscribe('onDecline', function(event)\n\t\t{\n\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t{\n\t\t\t\tEntryManager.setMeetingStatus(\n\t\t\t\t\tentry,\n\t\t\t\t\t'N',\n\t\t\t\t\t{recursionMode: event.getData().recursionMode, confirmed: true}\n\t\t\t\t).then(() => {\n\t\t\t\t\tif (Type.isFunction(resolvePromiseCallback))\n\t\t\t\t\t{\n\t\t\t\t\t\tresolvePromiseCallback();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic showConfirmEditDialog(options)\n\t{\n\t\tif (!this.confirmEditDialog)\n\t\t{\n\t\t\tthis.confirmEditDialog = this.createConfirmEditDialog();\n\t\t}\n\t\tthis.confirmEditDialog.show();\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.confirmEditDialog.unsubscribeAll('onEdit');\n\t\t\tthis.confirmEditDialog.subscribe('onEdit', (event) => {\n\t\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t\t{\n\t\t\t\t\toptions.callback(event.getData());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showReInviteUsersDialog(options)\n\t{\n\t\tif (!this.reinviteUsersDialog)\n\t\t{\n\t\t\tthis.reinviteUsersDialog = this.createReinviteUserDialog();\n\t\t}\n\t\tthis.reinviteUsersDialog.show();\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.reinviteUsersDialog.unsubscribeAll('onSelect');\n\t\t\tthis.reinviteUsersDialog.subscribe('onSelect', function(event)\n\t\t\t{\n\t\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t\t{\n\t\t\t\t\toptions.callback(event.getData());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showConfirmedEmailDialog(options = {})\n\t{\n\t\tif (!this.confirmedEmailDialog)\n\t\t{\n\t\t\tthis.confirmedEmailDialog = this.createConfirmedEmailDialog();\n\t\t}\n\t\tthis.confirmedEmailDialog.show();\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.confirmedEmailDialog.unsubscribeAll('onSelect');\n\t\t\tthis.confirmedEmailDialog.subscribe('onSelect', function(event)\n\t\t\t{\n\t\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t\t{\n\t\t\t\t\toptions.callback(event.getData());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic getLocationRepeatBusyErrorPopup(options = {})\n\t{\n\t\treturn new MessageBox({\n\t\t\ttitle: Loc.getMessage('EC_LOCATION_REPEAT_BUSY_POPUP_TITLE'),\n\t\t\tmessage: Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-messagebox-text-with-title\">\n\t\t\t\t\t${options.message}\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tminHeight: 100,\n\t\t\tminWidth: 300,\n\t\t\tmaxWidth: 690,\n\t\t\tbuttons: BX.UI.Dialogs.MessageBoxButtons.YES_CANCEL,\n\t\t\tonYes: options.onYesCallback,\n\t\t\tonCancel: options.onCancelCallback,\n\t\t\tyesCaption: Loc.getMessage('EC_LOCATION_REPEAT_BUSY_POPUP_SAVE_WITHOUT_ROOM'),\n\t\t\tcancelCaption: Loc.getMessage('EC_LOCATION_REPEAT_BUSY_POPUP_RETURN_TO_EDIT'),\n\t\t\tmediumButtonSize: false,\n\t\t\tpopupOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: options.onPopupCloseCallback,\n\t\t\t\t},\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tpadding: 0,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t},\n\t\t});\n\t}\n\n\tstatic showEmailLimitationDialog(options = {})\n\t{\n\t\tif (!this.limitationEmailDialog)\n\t\t{\n\t\t\tthis.limitationEmailDialog = this.createEmailLimitationDialog();\n\t\t}\n\t\tthis.limitationEmailDialog.subscribe('onClose', ()=>{\n\t\t\tif (Type.isFunction(options.callback))\n\t\t\t{\n\t\t\t\toptions.callback();\n\t\t\t}\n\t\t});\n\t\tthis.limitationEmailDialog.show();\n\t}\n\n\tstatic getCompactViewForm(create = true)\n\t{\n\t\tif (!EntryManager.compactEntryForm && create)\n\t\t{\n\t\t\tEntryManager.compactEntryForm = new CompactEventForm();\n\t\t}\n\n\t\treturn EntryManager.compactEntryForm;\n\t}\n\n\tstatic openCompactViewForm(options = {})\n\t{\n\t\tconst compactForm = EntryManager.getCompactViewForm();\n\t\tif (!compactForm.isShown())\n\t\t{\n\t\t\tcompactForm.unsubscribeAll('onClose');\n\t\t\tif (Type.isFunction(options.closeCallback))\n\t\t\t{\n\t\t\t\tcompactForm.subscribe('onClose', options.closeCallback);\n\t\t\t}\n\t\t\tcompactForm.showInViewMode(options);\n\t\t}\n\t}\n\n\tstatic openCompactEditForm(options = {})\n\t{\n\t\tconst compactForm = EntryManager.getCompactViewForm();\n\t\tif (!compactForm.isShown())\n\t\t{\n\t\t\tcompactForm.unsubscribeAll('onClose');\n\t\t\tif (Type.isFunction(options.closeCallback))\n\t\t\t{\n\t\t\t\tcompactForm.subscribe('onClose', options.closeCallback);\n\t\t\t}\n\t\t\tcompactForm.showInEditMode(options);\n\t\t}\n\t}\n\n\tstatic getEntryInstance(entry, userIndex, options = {})\n\t{\n\t\tlet entryInstance = null;\n\t\tif (entry instanceof Entry)\n\t\t{\n\t\t\tentryInstance = entry;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (Type.isObject(entry) && Type.isObject(entry.data))\n\t\t\t{\n\t\t\t\tentryInstance = new Entry({data: entry.data, userIndex: userIndex});\n\t\t\t}\n\t\t\telse if (Type.isObject(entry))\n\t\t\t{\n\t\t\t\tentryInstance = new Entry({data: entry, userIndex: userIndex});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tentryInstance = EntryManager.getNewEntry(options);\n\t\t\t}\n\t\t}\n\n\t\treturn entryInstance;\n\t}\n\n\tstatic getUserIndex(options = {})\n\t{\n\t\treturn EntryManager.userIndex\n\t}\n\n\tstatic setUserIndex(userIndex)\n\t{\n\t\tEntryManager.userIndex = userIndex;\n\t}\n\n\thandlePullChanges(params)\n\t{\n\t\tif (!BX.Calendar.Util.checkRequestId(params.requestUid))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst compactForm = EntryManager.getCompactViewForm();\n\t\tif (\n\t\t\tcompactForm\n\t\t\t&& compactForm.isShown()\n\t\t)\n\t\t{\n\t\t\tcompactForm.handlePull(params);\n\t\t}\n\n\t\tBX.SidePanel.Instance.getOpenSliders().forEach(slider =>\n\t\t{\n\t\t\tconst data = EntryManager.slidersMap.get(slider);\n\t\t\tif (\n\t\t\t\tdata\n\t\t\t\t&& data.entry\n\t\t\t\t&& data.entry.parentId === parseInt(params?.fields?.PARENT_ID)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tparams.command === 'delete_event'\n\t\t\t\t\t&& data.entry.getType() === params?.fields?.CAL_TYPE\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tslider.close();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (params.command === 'set_meeting_status')\n\t\t{\n\t\t\ttop.BX.Event.EventEmitter.emit('BX.Calendar:doReloadCounters');\n\t\t}\n\t\telse if (params.command === 'delete_event' || params.command === 'edit_event')\n\t\t{\n\t\t\tif (\n\t\t\t\t!params.fields\n\t\t\t\t||\n\t\t\t\t(params?.fields?.IS_MEETING && params?.fields?.MEETING_STATUS === 'Q')\n\t\t\t)\n\t\t\t{\n\t\t\t\ttop.BX.Event.EventEmitter.emit('BX.Calendar:doReloadCounters');\n\t\t\t}\n\n\t\t\tif (params?.fields?.CAL_TYPE === 'location' && top.BX.Calendar?.Controls?.Location)\n\t\t\t{\n\t\t\t\ttop.BX.Calendar.Controls.Location.handlePull(params);\n\t\t\t}\n\t\t}\n\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tconst entrySectionId = parseInt(params?.fields?.SECTION_ID);\n\t\tlet sectionDisplayed = Type.isArray(params.sections)\n\t\t\t&& params.sections.find(section => {\n\t\t\t\treturn section.id === entrySectionId && section.isShown();\n\t\t\t});\n\n\t\tlet loadedEntry = params?.fields\n\t\t\t? EntryManager.getEntryInstance(\n\t\t\t\tcalendarContext.getView().getEntryById(EntryManager.getEntryUniqueId(params.fields)),\n\t\t\t)\n\t\t\t: null;\n\n\t\tif ((sectionDisplayed || loadedEntry) && calendarContext)\n\t\t{\n\t\t\tcalendarContext.reloadDebounce();\n\t\t}\n\t}\n\n\tstatic registerDeleteTimeout(params)\n\t{\n\t\tEntryManager.delayedActionList.push(params);\n\t}\n\n\tstatic unregisterDeleteTimeout({action, data})\n\t{\n\t\tEntryManager.delayedActionList = EntryManager.delayedActionList.filter((item) => {\n\t\t\treturn item.action !== action\n\t\t\t\t|| item.data.entryId !== data.entryId\n\t\t\t\t|| item.data.recursionMode !== data.recursionMode\n\t\t\t\t|| item.data.excludeDate !== data.excludeDate;\n\t\t});\n\t}\n\n\tstatic doDelayedActions()\n\t{\n\t\tlet requestList = [];\n\t\treturn new Promise(resolve => {\n\t\t\tif(!EntryManager.delayedActionList.length)\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\n\t\t\tEntryManager.delayedActionList.forEach(({action, data, params}) => {\n\n\t\t\t\tconst requestUid = parseInt(data.requestUid);\n\t\t\t\trequestList.push(data.requestUid);\n\n\t\t\t\tif (params.entry)\n\t\t\t\t{\n\t\t\t\t\tEntryManager.closeDeleteNotificationBalloon(params.entry);\n\t\t\t\t}\n\n\t\t\t\tBX.ajax.runAction(\n\t\t\t\t\t`calendar.api.calendarajax.${action}`,\n\t\t\t\t\t{data: data}\n\t\t\t\t).then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tType.isFunction(params.callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparams.callback();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\trequestList = requestList.filter(uid => {return uid !== requestUid});\n\t\t\t\t\t\tif (!requestList.length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t() => {\n\t\t\t\t\t\trequestList = requestList.filter(uid => {return uid !== requestUid});\n\t\t\t\t\t\tif (!requestList.length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tEntryManager.unregisterDeleteTimeout({action, data, params});\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic getEntryUniqueId(entryData, entry)\n\t{\n\t\tlet sid = entryData.PARENT_ID || entryData.ID;\n\t\tif (entryData.RRULE)\n\t\t{\n\t\t\tsid += '|' + (entry ? Util.formatDate(entry.from) : Util.formatDate(BX.parseDate(entryData.DATE_FROM)));\n\t\t}\n\n\t\tif (entryData['~TYPE'] === 'tasks')\n\t\t{\n\t\t\tsid += '|' + 'task';\n\t\t}\n\t\treturn sid;\n\t}\n\n\tstatic registerEntrySlider(entry, control)\n\t{\n\t\tconst slider = Util.getBX().SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\tEntryManager.slidersMap.set(slider, {entry, control});\n\t\t}\n\t}\n\n\tstatic getNewEntryReminders(type = 'withTime')\n\t{\n\t\tconst userSettings = Util.getUserSettings();\n\t\tif (Type.isObjectLike(userSettings.defaultReminders)\n\t\t\t&& Type.isArray(userSettings.defaultReminders[type])\n\t\t\t&& userSettings.defaultReminders[type].length)\n\t\t{\n\t\t\treturn userSettings.defaultReminders[type];\n\t\t}\n\n\t\treturn type === 'withTime'\n\t\t\t? [{type: 'min', count: 15}]\n\t\t\t: [{type: 'daybefore', before: 0, time: 480}];\n\t}\n\n\tstatic setNewEntryReminders(type = 'withTime', reminders)\n\t{\n\t\tconst userSettings = Util.getUserSettings();\n\t\tif (Type.isObjectLike(userSettings.defaultReminders))\n\t\t{\n\t\t\tuserSettings.defaultReminders[type] = reminders;\n\t\t}\n\t\tUtil.setUserSettings(userSettings);\n\t}\n\n\t//this is because extensions cant be loaded in iframe with import\n\tstatic createConfirmEditDialog()\n\t{\n\t\tconst bx = Util.getBX();\n\t\treturn new bx.Calendar.Controls.ConfirmEditDialog();\n\t}\n\n\tstatic createConfirmStatusDialog()\n\t{\n\t\tconst bx = Util.getBX();\n\t\treturn new bx.Calendar.Controls.ConfirmStatusDialog();\n\t}\n\n\tstatic createReinviteUserDialog()\n\t{\n\t\tconst bx = Util.getBX();\n\t\treturn new bx.Calendar.Controls.ReinviteUserDialog();\n\t}\n\n\tstatic createConfirmedEmailDialog()\n\t{\n\t\tconst bx = Util.getBX();\n\t\treturn new bx.Calendar.Controls.ConfirmedEmailDialog();\n\t}\n\n\tstatic createEmailLimitationDialog()\n\t{\n\t\tconst bx = Util.getBX();\n\t\treturn new bx.Calendar.Controls.EmailLimitationDialog();\n\t}\n}","import { Util } from 'calendar.util';\nimport { EntryManager } from \"./entrymanager\";\nimport { Type, Loc } from 'main.core';\n\nexport {EntryManager};\n\nexport class Entry\n{\n\tFULL_DAY_LENGTH = 86400;\n\n\tstatic CAL_TYPES = {\n\t\t'user': 'user',\n\t\t'group': 'group',\n\t\t'company': 'company_calendar',\n\t};\n\tconstructor(options = {})\n\t{\n\t\tthis.prepareData(options.data);\n\t\tthis.parts = [];\n\n\t\tif (options.userIndex)\n\t\t{\n\t\t\tthis.setUserIndex(options.userIndex);\n\t\t}\n\n\t\tthis.delayTimeoutMap = new Map();\n\t}\n\n\tprepareData(data)\n\t{\n\t\tthis.data = data;\n\t\tthis.id = parseInt(this.data.ID || 0);\n\t\tthis.parentId = parseInt(this.data.PARENT_ID || 0);\n\n\t\tif (!this.data.DT_SKIP_TIME)\n\t\t{\n\t\t\tthis.data.DT_SKIP_TIME = this.data.SKIP_TIME ? 'Y' : 'N';\n\t\t}\n\t\tif (!Type.isString(this.data.NAME))\n\t\t{\n\t\t\tthis.data.NAME = Loc.getMessage('CALENDAR_DEFAULT_ENTRY_NAME');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.data.NAME = this.data.NAME.replaceAll(/\\r\\n|\\r|\\n/g, ' ');\n\t\t}\n\n\t\tthis.fullDay = this.data.DT_SKIP_TIME === 'Y';\n\t\tthis.accessibility = this.data.ACCESSIBILITY || 'busy';\n\t\tthis.important = this.data.IMPORTANCE === 'high';\n\t\tthis.private = !!this.data.PRIVATE_EVENT;\n\t\tthis.setSectionId(this.data.SECT_ID);\n\t\tthis.name = this.data.NAME;\n\n\t\tthis.userTimezoneOffsetFrom = parseInt(this.data['~USER_OFFSET_FROM']) || 0;\n\t\tthis.userTimezoneOffsetTo = parseInt(this.data['~USER_OFFSET_TO']) || this.userTimezoneOffsetFrom;\n\n\t\tif (!this.data.DT_LENGTH)\n\t\t{\n\t\t\tthis.data.DT_LENGTH = this.data.DURATION || 0;\n\t\t}\n\t\tif (this.fullDay && !this.data.DT_LENGTH)\n\t\t{\n\t\t\tthis.data.DT_LENGTH = this.FULL_DAY_LENGTH;\n\t\t}\n\n\t\tif (\n\t\t\t!Type.isString(this.data.DATE_FROM) && !Type.isString(this.data.DATE_TO)\n\t\t\t&& Type.isDate(this.data.dateFrom) && Type.isDate(this.data.dateTo)\n\t\t)\n\t\t{\n\t\t\tthis.from = this.data.dateFrom;\n\t\t\tthis.to = this.data.dateTo;\n\n\t\t\tthis.data.DT_LENGTH = Math.round((this.to.getTime() - this.from.getTime()) / 1000);\n\t\t\tthis.data.DURATION = this.data.DT_LENGTH;\n\n\t\t\tif (this.fullDay)\n\t\t\t{\n\t\t\t\tthis.data.DATE_FROM = Util.formatDate(this.from.getTime());\n\t\t\t\tthis.data.DATE_TO = Util.formatDate(this.to.getTime());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.from = new Date(this.from.getTime() - (parseInt(this.data['~USER_OFFSET_FROM']) || 0) * 1000);\n\t\t\t\tthis.to = new Date(this.to.getTime() - (parseInt(this.data['~USER_OFFSET_TO']) || 0) * 1000);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.isTask())\n\t\t\t{\n\t\t\t\tthis.from = BX.parseDate(this.data.DATE_FROM) || new Date();\n\t\t\t\tthis.to = BX.parseDate(this.data.DATE_TO) || this.from;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.from = BX.parseDate(this.data.DATE_FROM) || new Date();\n\t\t\t\tthis.to = BX.parseDate(this.data.DATE_TO) || this.from;\n\t\t\t}\n\t\t}\n\n\t\tif (this.fullDay)\n\t\t{\n\t\t\tthis.from.setHours(0, 0, 0, 0);\n\t\t\tthis.to.setHours(0, 0, 0, 0);\n\t\t}\n\n\t\tif (!this.data.ATTENDEES_CODES && !this.isTask())\n\t\t{\n\t\t\tif (this.data.CAL_TYPE === 'user' && this.data.OWNER_ID)\n\t\t\t{\n\t\t\t\tthis.data.ATTENDEES_CODES = ['U' + this.data.OWNER_ID];\n\t\t\t}\n\t\t\telse if (this.data.CREATED_BY)\n\t\t\t{\n\t\t\t\tthis.data.ATTENDEES_CODES = ['U' + this.data.CREATED_BY];\n\t\t\t}\n\t\t}\n\n\t\tthis.startDayCode = this.from;\n\t\tthis.endDayCode = this.to;\n\n\t\tif (!Type.isArray(this.data.REMIND) && Type.isArray(this.data.remind))\n\t\t{\n\t\t\tthis.data.REMIND = [];\n\t\t\tthis.data.remind.forEach(function(value)\n\t\t\t{\n\t\t\t\tthis.data.REMIND.push({type: 'min', count: value});\n\t\t\t}, this);\n\t\t\tdelete this.data.remind;\n\t\t}\n\n\t\tif (this.data.permissions)\n\t\t{\n\t\t\tthis.permissions = this.data.permissions;\n\t\t}\n\t}\n\n\tgetAttendeesCodes()\n\t{\n\t\treturn this.data.ATTENDEES_CODES || [];\n\t}\n\n\tgetAttendeesEntityList()\n\t{\n\t\treturn this.data.attendeesEntityList || [];\n\t}\n\n\tgetAttendees()\n\t{\n\t\tif (!this.attendeeList)\n\t\t{\n\t\t\tthis.attendeeList = [];\n\t\t\tif (Type.isArray(this.data['ATTENDEE_LIST']))\n\t\t\t{\n\t\t\t\tconst userIndex = this.getUserIndex();\n\t\t\t\tthis.data['ATTENDEE_LIST'].forEach((user) => {\n\t\t\t\t\tif (userIndex[user.id])\n\t\t\t\t\t{\n\t\t\t\t\t\tlet attendee = BX.clone(userIndex[user.id]);\n\t\t\t\t\t\tattendee.STATUS = user.status;\n\t\t\t\t\t\tattendee.ENTRY_ID = user.entryId || false;\n\t\t\t\t\t\tthis.attendeeList.push(attendee);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this.attendeeList;\n\t}\n\n\tsetUserIndex(userIndex)\n\t{\n\t\tthis.userIndex = userIndex;\n\t}\n\n\tgetUserIndex()\n\t{\n\t\treturn this.userIndex || EntryManager.getUserIndex();\n\t}\n\n\tcleanParts()\n\t{\n\t\tthis.parts = [];\n\t}\n\n\tstartPart(part)\n\t{\n\t\tpart.partIndex = this.parts.length;\n\t\tthis.parts.push(part);\n\t\treturn this.parts[part.partIndex];\n\t}\n\n\tregisterPartNode(part, params)\n\t{\n\t\tpart.params = params;\n\t}\n\n\tcheckPartIsRegistered(part)\n\t{\n\t\treturn Type.isPlainObject(part.params);\n\t}\n\n\tgetPart(partIndex)\n\t{\n\t\treturn this.parts[partIndex] || false;\n\t}\n\n\tgetWrap(partIndex)\n\t{\n\t\treturn this.parts[partIndex || 0].params.wrapNode;\n\t}\n\n\tgetSectionName()\n\t{\n\t\t//return this.calendar.sectionController.getSection(this.sectionId).name || '';\n\t}\n\n\tgetDescription()\n\t{\n\t\treturn this.data.DESCRIPTION || '';\n\t}\n\n\tapplyViewRange(viewRange)\n\t{\n\t\tlet\n\t\t\tviewRangeStart = viewRange.start.getTime(),\n\t\t\tviewRangeEnd = viewRange.end.getTime(),\n\t\t\tfromTime = this.from.getTime(),\n\t\t\ttoTime = this.to.getTime();\n\n\t\tif (toTime < viewRangeStart || fromTime > viewRangeEnd)\n\t\t\treturn false;\n\n\t\tif (fromTime < viewRangeStart)\n\t\t{\n\t\t\tthis.displayFrom = viewRange.start;\n\t\t\tthis.startDayCode = this.displayFrom;\n\t\t}\n\n\t\tif (toTime > viewRangeEnd)\n\t\t{\n\t\t\tthis.displayTo = viewRange.end;\n\t\t\tthis.endDayCode = this.displayTo;\n\t\t}\n\t\treturn true;\n\t}\n\n\tisPersonal()\n\t{\n\t\t//return (this.data.CAL_TYPE === 'user' && this.data.OWNER_ID == this.calendar.util.userId);\n\t}\n\n\tisMeeting()\n\t{\n\t\treturn !!this.data.IS_MEETING;\n\t}\n\n\tisPrivate()\n\t{\n\t\treturn this.private;\n\t}\n\n\tisResourcebooking()\n\t{\n\t\treturn this.data.EVENT_TYPE === '#resourcebooking#';\n\t}\n\n\tisTask()\n\t{\n\t\treturn this.data['~TYPE'] === 'tasks';\n\t}\n\n\tisSharingEvent()\n\t{\n\t\treturn this.data['EVENT_TYPE'] === '#shared#' || this.data['EVENT_TYPE'] === '#shared_crm#';\n\t}\n\n\tisInvited()\n\t{\n\t\treturn this.getCurrentStatus() === 'Q';\n\t}\n\n\tisLocation()\n\t{\n\t\treturn this.getType() === 'location';\n\t}\n\n\tisFullDay()\n\t{\n\t\treturn this.fullDay;\n\t}\n\n\tisLongWithTime()\n\t{\n\t\treturn !this.fullDay && Util.getDayCode(this.from) !== Util.getDayCode(this.to);\n\t}\n\n\tisExpired()\n\t{\n\t\treturn this.to.getTime() < new Date().getTime();\n\t}\n\n\thasEmailAttendees()\n\t{\n\t\tif (this.emailAttendeesCache === undefined)\n\t\t{\n\t\t\tconst userIndex = EntryManager.getUserIndex();\n\t\t\tfor (let i = 0; i < this.data['ATTENDEE_LIST'].length; i++)\n\t\t\t{\n\t\t\t\tlet user = this.data['ATTENDEE_LIST'][i];\n\t\t\t\tif ((user.status === 'Y' || user.status === 'Q')\n\t\t\t\t\t&& userIndex[user.id]\n\t\t\t\t\t&& userIndex[user.id].EMAIL_USER\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.emailAttendeesCache = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.emailAttendeesCache;\n\t}\n\n\townerIsEmailUser()\n\t{\n\t\tif (this.ownerIsEmailUserCache === undefined)\n\t\t{\n\t\t\tconst userIndex = EntryManager.getUserIndex();\n\t\t\tthis.ownerIsEmailUserCache = userIndex[parseInt(this.data.MEETING_HOST)]\n\t\t\t\t&& userIndex[parseInt(this.data.MEETING_HOST)].EMAIL_USER;\n\t\t}\n\t\treturn this.ownerIsEmailUserCache;\n\t}\n\n\tisSelected()\n\t{\n\t\treturn !!this.selected;\n\t}\n\n\tisCrm()\n\t{\n\t\treturn !!this.data.UF_CRM_CAL_EVENT;\n\t}\n\n\tisFirstReccurentEntry()\n\t{\n\t\treturn (this.data.DATE_FROM_TS_UTC === Math.floor(BX.parseDate(this.data['~DATE_FROM']).getTime() / 1000) * 1000\n\t\t\t||\n\t\t\tBX.parseDate(this.data['DATE_FROM']).getTime() === BX.parseDate(this.data['~DATE_FROM']).getTime()\n\t\t) && !this.data.RECURRENCE_ID;\n\t}\n\n\tisRecursive()\n\t{\n\t\treturn !!this.data.RRULE;\n\t}\n\n\tisFirstInstance()\n\t{\n\t\treturn this.data.RRULE && this.data.RINDEX === 0;\n\t}\n\n\tgetMeetingHost()\n\t{\n\t\treturn parseInt(this.data.MEETING_HOST);\n\t}\n\n\tgetMeetingNotify()\n\t{\n\t\treturn this.data.MEETING.NOTIFY;\n\t}\n\n\tgetHideGuests()\n\t{\n\t\treturn this.data.MEETING && BX.Type.isBoolean(this.data.MEETING.HIDE_GUESTS)\n\t\t\t? this.data.MEETING.HIDE_GUESTS\n\t\t\t: true;\n\t}\n\n\tgetRrule()\n\t{\n\t\treturn this.data.RRULE;\n\t}\n\n\tgetRRuleDescription()\n\t{\n\t\treturn this.data['~RRULE_DESCRIPTION'];\n\t}\n\n\thasRecurrenceId()\n\t{\n\t\treturn this.data.RECURRENCE_ID;\n\t}\n\n\twasEverRecursive()\n\t{\n\t\treturn this.data.RRULE || this.data.RECURRENCE_ID;\n\t}\n\n\tdeselect()\n\t{\n\t\tthis.selected = false;\n\t}\n\n\tselect()\n\t{\n\t\tthis.selected = true;\n\t}\n\n\tdeleteParts(recursionMode)\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tconst wrap = calendarContext.getView().getContainer();\n\n\t\t\tif (recursionMode === 'all')\n\t\t\t{\n\t\t\t\tcalendarContext.getView().entries.forEach((entry) => {\n\t\t\t\t\tif (parseInt(entry.id) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === parseInt(this.data.RECURRENCE_ID)\n\t\t\t\t\t\t|| parseInt(entry.id) === parseInt(this.data.RECURRENCE_ID)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst entryPart = wrap.querySelector('div[data-bx-calendar-entry=\"' + entry.uid + '\"]');\n\t\t\t\t\t\tif (entryPart)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentryPart.style.opacity = 0;\n\t\t\t\t\t\t\tsetTimeout(()=>{entryPart.style.display = 'none';}, 200);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (recursionMode === 'next')\n\t\t\t{\n\t\t\t\tcalendarContext.getView().entries.forEach((entry) => {\n\t\t\t\t\tif ((parseInt(entry.id) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === parseInt(this.data.RECURRENCE_ID)\n\t\t\t\t\t\t|| parseInt(entry.id) === parseInt(this.data.RECURRENCE_ID))\n\t\t\t\t\t\t&& entry.from.getTime() > this.from.getTime()\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst entryPart = wrap.querySelector('div[data-bx-calendar-entry=\"' + entry.uid + '\"]');\n\t\t\t\t\t\tif (entryPart)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentryPart.style.opacity = 0;\n\t\t\t\t\t\t\tsetTimeout(()=>{entryPart.style.display = 'none';}, 200);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (recursionMode === 'this' || !recursionMode)\n\t\t\t{\n\t\t\t\tconst parts = wrap.querySelectorAll('div[data-bx-calendar-entry=\"' + this.getUniqueId() + '\"]');\n\t\t\t\tparts.forEach((entryPart)=>{\n\t\t\t\t\tentryPart.style.opacity = 0;\n\t\t\t\t\tsetTimeout(()=>{entryPart.style.display = 'none';}, 200);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tgetUniqueId()\n\t{\n\t\treturn EntryManager.getEntryUniqueId(this.data, this);\n\t}\n\n\tgetCurrentStatus()\n\t{\n\t\tlet\n\t\t\tuserId = Util.getCurrentUserId(),\n\t\t\tstatus = false,\n\t\t\ti, user;\n\n\t\tif (this.isMeeting())\n\t\t{\n\t\t\tif (userId === parseInt(this.data.CREATED_BY))\n\t\t\t{\n\t\t\t\tstatus = this.data.MEETING_STATUS || 'Q';\n\t\t\t}\n\t\t\telse if (userId === parseInt(this.data.MEETING_HOST))\n\t\t\t{\n\t\t\t\tstatus = 'H';\n\t\t\t\t//status = this.data.MEETING_STATUS || 'H';\n\t\t\t}\n\t\t\telse if (Type.isArray(this.data['ATTENDEE_LIST']))\n\t\t\t{\n\t\t\t\tfor (i = 0; i < this.data['ATTENDEE_LIST'].length; i++)\n\t\t\t\t{\n\t\t\t\t\tuser = this.data['ATTENDEE_LIST'][i];\n\t\t\t\t\tif (parseInt(user.id) === userId)\n\t\t\t\t\t{\n\t\t\t\t\t\tstatus = user.status;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (userId === parseInt(this.data.CREATED_BY))\n\t\t{\n\t\t\tstatus = this.data.MEETING_STATUS || 'H';\n\t\t}\n\n\t\treturn Util.getMeetingStatusList().includes(status) ? status : false;\n\t}\n\n\tsetCurrentStatus(status)\n\t{\n\t\tif (this.isMeeting() && Util.getMeetingStatusList().includes(status))\n\t\t{\n\t\t\tthis.data.MEETING_STATUS = status;\n\n\t\t\tconst userId = Util.getCurrentUserId();\n\t\t\tif (Type.isArray(this.data['ATTENDEE_LIST']))\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < this.data['ATTENDEE_LIST'].length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (parseInt(this.data['ATTENDEE_LIST'][i].id) === userId)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.data['ATTENDEE_LIST'][i].status = status;\n\t\t\t\t\t\tthis.attendeeList = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetReminders()\n\t{\n\t\tlet res = [];\n\t\tif (this.data && this.data.REMIND)\n\t\t{\n\t\t\tthis.data.REMIND.forEach(function (remind)\n\t\t\t{\n\t\t\t\tswitch(remind.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'min':\n\t\t\t\t\t\tres.push(remind.count);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'hour':\n\t\t\t\t\t\tres.push(parseInt(remind.count) * 60);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'day':\n\t\t\t\t\t\tres.push(parseInt(remind.count) * 60 * 24);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'daybefore':\n\t\t\t\t\t\tres.push(remind);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'date':\n\t\t\t\t\t\tif (!Type.isDate(remind.value))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tremind.value = Util.parseDate(remind.value);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isDate(remind.value))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tres.push(remind);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn res;\n\t}\n\n\tgetLengthInDays()\n\t{\n\t\tlet\n\t\t\tfrom = new Date(this.from.getFullYear(), this.from.getMonth(), this.from.getDate(), 0, 0, 0),\n\t\t\tto = new Date(this.to.getFullYear(), this.to.getMonth(), this.to.getDate(), 0, 0, 0);\n\n\t\treturn Math.round((to.getTime() - from.getTime()) / Util.getDayLength()) + 1;\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn (this.name || '');\n\t}\n\n\tgetColor()\n\t{\n\t\treturn this.data.COLOR;\n\t}\n\n\tgetType()\n\t{\n\t\treturn this.data.CAL_TYPE;\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn this.data.OWNER_ID;\n\t}\n\n\tdelete(params)\n\t{\n\t\tparams = Type.isPlainObject(params) ? params : {};\n\t\tlet recursionMode = params.recursionMode || false;\n\n\t\tif (this.wasEverRecursive() && !params.confirmed)\n\t\t{\n\t\t\treturn this.showConfirmDeleteDialog({entry: this});\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// Broadcast event\n\t\t\tBX.onCustomEvent('BX.Calendar.Entry:beforeDelete', [{entryId: this.id, recursionMode: recursionMode, entryData: this.data}]);\n\n\t\t\tEntryManager.showDeleteEntryNotification(this);\n\t\t\tthis.deleteParts(recursionMode);\n\n\t\t\tconst action = 'deleteCalendarEntry';\n\t\t\tconst data = {\n\t\t\t\tentryId: this.id,\n\t\t\t\trecursionMode: params.recursionMode || false,\n\t\t\t\trequestUid: Util.registerRequestId(),\n\t\t\t};\n\n\t\t\tEntryManager.registerDeleteTimeout({\n\t\t\t\taction,\n\t\t\t\tdata,\n\t\t\t\tparams: {\n\t\t\t\t\tentry: this,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tBX.onCustomEvent('BX.Calendar.Entry:delete', [{entryId: this.id, recursionMode: recursionMode}]);\n\t\t\t\t\t}\n\t\t\t\t}});\n\n\t\t\tthis.deleteTimeout = setTimeout(EntryManager.doDelayedActions, EntryManager.DELETE_DELAY_TIMEOUT);\n\t\t\tthis.delayTimeoutMap.set(this.deleteTimeout, {action, data});\n\t\t}\n\t}\n\n\tdeleteThis()\n\t{\n\t\tlet recursionMode = 'this';\n\t\tif (this.isRecursive())\n\t\t{\n\t\t\tBX.onCustomEvent('BX.Calendar.Entry:beforeDelete', [{entryId: this.id, recursionMode: recursionMode, entryData: this.data}]);\n\n\t\t\tEntryManager.showDeleteEntryNotification(this);\n\t\t\tthis.deleteParts(recursionMode);\n\n\t\t\tconst action = 'excludeRecursionDate';\n\t\t\tconst data = {\n\t\t\t\tentryId: this.id,\n\t\t\t\trecursionMode: recursionMode,\n\t\t\t\texcludeDate: this.data.DATE_FROM,\n\t\t\t};\n\n\t\t\tEntryManager.registerDeleteTimeout({\n\t\t\t\taction,\n\t\t\t\tdata,\n\t\t\t\tparams: {\n\t\t\t\t\tentry: this,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tBX.onCustomEvent('BX.Calendar.Entry:delete', [data]);\n\t\t\t\t\t}\n\t\t\t\t}});\n\n\t\t\tthis.deleteTimeout = setTimeout(EntryManager.doDelayedActions, EntryManager.DELETE_DELAY_TIMEOUT);\n\t\t\tthis.delayTimeoutMap.set(this.deleteTimeout, {action, data});\n\t\t}\n\t\telse if (this.hasRecurrenceId())\n\t\t{\n\t\t\tthis.delete({confirmed: true, recursionMode: 'this'});\n\t\t}\n\t}\n\n\tdeleteNext()\n\t{\n\t\tlet recursionMode = 'next';\n\t\tif (this.isRecursive() && this.isFirstReccurentEntry())\n\t\t{\n\t\t\tthis.deleteAll();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.onCustomEvent('BX.Calendar.Entry:beforeDelete', [{entryId: this.id, recursionMode: recursionMode}]);\n\n\t\t\tEntryManager.showDeleteEntryNotification(this);\n\t\t\tthis.deleteParts(recursionMode);\n\n\t\t\tconst calendarContext = Util.getCalendarContext();\n\t\t\tif (calendarContext)\n\t\t\t{\n\n\t\t\t}\n\n\t\t\tconst action = 'changeRecurciveEntryUntil';\n\t\t\tconst data = {\n\t\t\t\tentryId: this.id,\n\t\t\t\trecursionMode: recursionMode,\n\t\t\t\tuntilDate: Util.formatDate(this.from.getTime() - Util.getDayLength()),\n\t\t\t};\n\t\t\tEntryManager.registerDeleteTimeout({\n\t\t\t\taction,\n\t\t\t\tdata,\n\t\t\t\tparams: {\n\t\t\t\t\tentry: this,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tBX.onCustomEvent('BX.Calendar.Entry:delete', [data]);\n\t\t\t\t\t}\n\t\t\t\t}});\n\n\t\t\tthis.deleteTimeout = setTimeout(EntryManager.doDelayedActions, EntryManager.DELETE_DELAY_TIMEOUT);\n\t\t\tthis.delayTimeoutMap.set(this.deleteTimeout, {action, data});\n\t\t}\n\t}\n\n\tdeleteAll()\n\t{\n\t\treturn this.delete({confirmed: true, recursionMode: 'all'});\n\t}\n\n\tcancelDelete()\n\t{\n\t\tif (this.deleteTimeout)\n\t\t{\n\t\t\tconst deleteTimeoutData = this.delayTimeoutMap.get(this.deleteTimeout);\n\t\t\tif (deleteTimeoutData)\n\t\t\t{\n\t\t\t\tEntryManager.unregisterDeleteTimeout(deleteTimeoutData);\n\t\t\t\tBX.onCustomEvent('BX.Calendar.Entry:cancelDelete', [{entryId: this.id, entryData: this.data}]);\n\t\t\t\tthis.delayTimeoutMap.delete(this.delayTimeoutMap);\n\t\t\t}\n\t\t\tclearTimeout(this.deleteTimeout);\n\t\t\tthis.deleteTimeout = null;\n\t\t}\n\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tcalendarContext.reload();\n\t\t}\n\t}\n\n\tshowConfirmDeleteDialog(params)\n\t{\n\t\tif (!this.confirmDeleteDialog)\n\t\t{\n\t\t\tthis.confirmDeleteDialog = new (window.BX || window.top.BX).Calendar.Controls\n\t\t\t\t.ConfirmDeleteDialog({entry: params.entry});\n\t\t}\n\t\tthis.confirmDeleteDialog.show();\n\t}\n\n\tsave()\n\t{\n\t}\n\n\tgetLocation()\n\t{\n\t\treturn this.data.LOCATION;\n\t}\n\n\tsetTimezone(timezoneFrom, timezoneTo = null)\n\t{\n\t\tif(Type.isString(timezoneFrom))\n\t\t{\n\t\t\tthis.data.TZ_FROM = timezoneFrom;\n\t\t\tif (Type.isNull(timezoneTo))\n\t\t\t{\n\t\t\t\tthis.data.TZ_TO = timezoneFrom;\n\t\t\t}\n\t\t}\n\t\tif(Type.isString(timezoneTo))\n\t\t{\n\t\t\tthis.data.TZ_TO = timezoneTo;\n\t\t}\n\t}\n\n\tgetTimezoneFrom()\n\t{\n\t\treturn this.data.TZ_FROM || '';\n\t}\n\n\tgetTimezoneTo()\n\t{\n\t\treturn this.data.TZ_TO || '';\n\t}\n\n\tsetSectionId(value)\n\t{\n\t\tthis.data.SECT_ID = this.sectionId = this.isTask() ? 'tasks' : parseInt(value);\n\t}\n\n\tsetDateTimeValue({from, to})\n\t{\n\t\tif (Type.isDate(from) && Type.isDate(to))\n\t\t{\n\t\t\tthis.from = this.data.dateFrom = from;\n\t\t\tthis.to = this.data.dateTo = to;\n\n\t\t\tthis.data.DT_LENGTH = Math.round((this.to.getTime() - this.from.getTime()) / 1000);\n\t\t\tthis.data.DURATION = this.data.DT_LENGTH;\n\n\t\t\tif (this.fullDay)\n\t\t\t{\n\t\t\t\tthis.data.DATE_FROM = Util.formatDate(this.from.getTime());\n\t\t\t\tthis.data.DATE_TO = Util.formatDate(this.to.getTime());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.data.DATE_FROM = Util.formatDateTime(this.from.getTime());\n\t\t\t\tthis.data.DATE_TO = Util.formatDateTime(this.to.getTime());\n\t\t\t}\n\t\t}\n\t}\n}\n"],"names":["EntryManager","getNewEntry","options","newEntryData","dateTime","getNewEntryTime","Date","userSettings","Util","getUserSettings","userId","getCurrentUserId","ID","NAME","getNewEntryName","dateFrom","from","dateTo","to","type","SECT_ID","RoomsManager","getNewEntrySectionId","parseInt","ownerId","SectionManager","REMIND","getNewEntryReminders","attendeesEntityList","entityId","id","ATTENDEE_LIST","status","push","TZ_FROM","timezoneName","timezoneDefaultName","TZ_TO","Entry","data","date","duration","getUsableDateTime","calendarContext","getCalendarContext","displayedViewRange","getDisplayedViewRange","Type","isDate","start","getTime","end","startDate","workTime","util","getWorkTime","setHours","newEntryName","setNewEntryName","showEditEntryNotification","entryId","showNotification","Loc","getMessage","title","events","click","event","balloon","action","openViewSlider","close","showNewEntryNotification","showDeleteEntryNotification","entry","BX","UI","Notification","Center","notify","getUniqueId","content","actions","cancelDelete","showReleaseLocationNotification","closeDeleteNotificationBalloon","getBalloonById","openEditSlider","bx","getBX","Calendar","SliderLoader","isLocationCalendar","roomsManager","locationAccess","dayOfWeekMonthFormat","locationCapacity","formDataValue","jumpToControl","show","eventId","isNull","entryDateFrom","timezoneOffset","link","deleteEntry","slider","SidePanel","Instance","getTopSlider","beforeDeleteHandler","EventEmitter","subscribe","deleteHandler","calendar","reload","unsubscribe","delete","setMeetingStatus","params","Promise","resolve","isPlainObject","recursionMode","confirmed","isRecursive","showConfirmStatusDialog","ajax","runAction","entryParentId","parentId","currentDateFrom","formatDate","then","response","Event","emit","BaseEvent","counters","setCurrentStatus","resolvePromiseCallback","confirmDeclineDialog","createConfirmStatusDialog","unsubscribeAll","isFunction","getData","showConfirmEditDialog","confirmEditDialog","createConfirmEditDialog","callback","showReInviteUsersDialog","reinviteUsersDialog","createReinviteUserDialog","showConfirmedEmailDialog","confirmedEmailDialog","createConfirmedEmailDialog","getLocationRepeatBusyErrorPopup","MessageBox","message","Tag","render","minHeight","minWidth","maxWidth","buttons","Dialogs","MessageBoxButtons","YES_CANCEL","onYes","onYesCallback","onCancel","onCancelCallback","yesCaption","cancelCaption","mediumButtonSize","popupOptions","onPopupClose","onPopupCloseCallback","closeByEsc","padding","contentPadding","animation","showEmailLimitationDialog","limitationEmailDialog","createEmailLimitationDialog","getCompactViewForm","create","compactEntryForm","CompactEventForm","openCompactViewForm","compactForm","isShown","closeCallback","showInViewMode","openCompactEditForm","showInEditMode","getEntryInstance","userIndex","entryInstance","isObject","getUserIndex","setUserIndex","handlePullChanges","checkRequestId","requestUid","handlePull","getOpenSliders","forEach","slidersMap","get","fields","PARENT_ID","command","getType","CAL_TYPE","top","IS_MEETING","MEETING_STATUS","Controls","Location","entrySectionId","SECTION_ID","sectionDisplayed","isArray","sections","find","section","loadedEntry","getView","getEntryById","getEntryUniqueId","reloadDebounce","registerDeleteTimeout","delayedActionList","unregisterDeleteTimeout","filter","item","excludeDate","doDelayedActions","requestList","length","uid","entryData","sid","RRULE","parseDate","DATE_FROM","registerEntrySlider","control","set","isObjectLike","defaultReminders","count","before","time","setNewEntryReminders","reminders","setUserSettings","ConfirmEditDialog","ConfirmStatusDialog","ReinviteUserDialog","ConfirmedEmailDialog","EmailLimitationDialog","DELETE_DELAY_TIMEOUT","WeakMap","constructor","FULL_DAY_LENGTH","prepareData","parts","delayTimeoutMap","Map","DT_SKIP_TIME","SKIP_TIME","isString","replaceAll","fullDay","accessibility","ACCESSIBILITY","important","IMPORTANCE","private","PRIVATE_EVENT","setSectionId","name","userTimezoneOffsetFrom","userTimezoneOffsetTo","DT_LENGTH","DURATION","DATE_TO","Math","round","isTask","ATTENDEES_CODES","OWNER_ID","CREATED_BY","startDayCode","endDayCode","remind","value","permissions","getAttendeesCodes","getAttendeesEntityList","getAttendees","attendeeList","user","attendee","clone","STATUS","ENTRY_ID","cleanParts","startPart","part","partIndex","registerPartNode","checkPartIsRegistered","getPart","getWrap","wrapNode","getSectionName","getDescription","DESCRIPTION","applyViewRange","viewRange","viewRangeStart","viewRangeEnd","fromTime","toTime","displayFrom","displayTo","isPersonal","isMeeting","isPrivate","isResourcebooking","EVENT_TYPE","isSharingEvent","isInvited","getCurrentStatus","isLocation","isFullDay","isLongWithTime","getDayCode","isExpired","hasEmailAttendees","emailAttendeesCache","undefined","i","EMAIL_USER","ownerIsEmailUser","ownerIsEmailUserCache","MEETING_HOST","isSelected","selected","isCrm","UF_CRM_CAL_EVENT","isFirstReccurentEntry","DATE_FROM_TS_UTC","floor","RECURRENCE_ID","isFirstInstance","RINDEX","getMeetingHost","getMeetingNotify","MEETING","NOTIFY","getHideGuests","isBoolean","HIDE_GUESTS","getRrule","getRRuleDescription","hasRecurrenceId","wasEverRecursive","deselect","select","deleteParts","wrap","getContainer","entries","entryPart","querySelector","style","opacity","setTimeout","display","querySelectorAll","getMeetingStatusList","includes","getReminders","res","getLengthInDays","getFullYear","getMonth","getDate","getDayLength","getName","getColor","COLOR","getOwnerId","showConfirmDeleteDialog","onCustomEvent","registerRequestId","deleteTimeout","deleteThis","deleteNext","deleteAll","untilDate","deleteTimeoutData","clearTimeout","confirmDeleteDialog","window","ConfirmDeleteDialog","save","getLocation","LOCATION","setTimezone","timezoneFrom","timezoneTo","getTimezoneFrom","getTimezoneTo","sectionId","setDateTimeValue","formatDateTime","CAL_TYPES"],"mappings":"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"}