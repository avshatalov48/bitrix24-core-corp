{"version":3,"file":"entry.bundle.js","sources":["../src/entrymanager.js","../src/entry.js"],"sourcesContent":["import { Entry } from 'calendar.entry';\nimport { SectionManager } from 'calendar.sectionmanager';\nimport { Util } from 'calendar.util';\nimport { Event, Loc, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { CompactEventForm } from 'calendar.compacteventform';\nimport 'ui.notification';\nimport { EventViewForm } from 'calendar.eventviewform';\nimport { RoomsManager } from 'calendar.roomsmanager';\n\nexport class EntryManager {\n\tstatic newEntryName = '';\n\tstatic userIndex = {};\n\tstatic delayedActionList = [];\n\tstatic DELETE_DELAY_TIMEOUT = 4000;\n\tstatic slidersMap = new WeakMap();\n\n\tstatic getNewEntry(options)\n\t{\n\t\tconst newEntryData = {};\n\t\tconst dateTime = EntryManager.getNewEntryTime(new Date());\n\t\tconst userSettings = Util.getUserSettings();\n\t\tconst userId = Util.getCurrentUserId();\n\n\t\tnewEntryData.ID = null;\n\t\tnewEntryData.NAME = EntryManager.getNewEntryName();\n\t\tnewEntryData.dateFrom = dateTime.from;\n\t\tnewEntryData.dateTo = dateTime.to;\n\t\tif(options.type === 'location')\n\t\t{\n\t\t\tnewEntryData.SECT_ID = RoomsManager.getNewEntrySectionId(options.type, parseInt(options.ownerId));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewEntryData.SECT_ID = SectionManager.getNewEntrySectionId(options.type, parseInt(options.ownerId));\n\t\t}\n\t\tnewEntryData.REMIND = EntryManager.getNewEntryReminders();\n\n\t\tnewEntryData.attendeesEntityList = [{entityId: 'user', id: userId}];\n\t\tnewEntryData.ATTENDEE_LIST = [{id: Util.getCurrentUserId(), status: \"H\"}];\n\n\t\tif (options.type === 'user' && userId !== options.ownerId)\n\t\t{\n\t\t\tnewEntryData.attendeesEntityList.push({entityId: 'user', id: options.ownerId});\n\t\t\tnewEntryData.ATTENDEE_LIST = [\n\t\t\t\t{id: options.ownerId, status: \"H\"},\n\t\t\t\t{id: Util.getCurrentUserId(), status: \"Y\"}\n\t\t\t];\n\t\t}\n\t\telse if (options.type === 'group')\n\t\t{\n\t\t\tnewEntryData.attendeesEntityList.push({entityId: 'project', id: options.ownerId});\n\t\t}\n\n\t\tnewEntryData.TZ_FROM = userSettings.timezoneName || userSettings.timezoneDefaultName || '';\n\t\tnewEntryData.TZ_TO = userSettings.timezoneName || userSettings.timezoneDefaultName || '';\n\n\t\treturn new Entry({data: newEntryData});\n\t}\n\n\tstatic getNewEntryTime(date, duration)\n\t{\n\t\tdate = Util.getUsableDateTime(date);\n\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tconst displayedViewRange = calendarContext.getDisplayedViewRange();\n\t\t\tif (Type.isDate(displayedViewRange?.start))\n\t\t\t{\n\t\t\t\tconst dateTime = date.getTime();\n\t\t\t\tif (\n\t\t\t\t\tdateTime < displayedViewRange.start.getTime()\n\t\t\t\t\t|| dateTime > displayedViewRange.end.getTime()\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tconst startDate = new Date(displayedViewRange.start.getTime());\n\t\t\t\t\tconst workTime = calendarContext.util.getWorkTime();\n\t\t\t\t\tstartDate.setHours(workTime.start, 0, 0,0);\n\t\t\t\t\tdate = Util.getUsableDateTime(startDate);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tfrom : date,\n\t\t\tto : new Date(date.getTime() + (duration || 3600) * 1000)\n\t\t}\n\t}\n\n\tstatic getNewEntryName()\n\t{\n\t\treturn EntryManager.newEntryName || Loc.getMessage('CALENDAR_DEFAULT_ENTRY_NAME');\n\t}\n\n\tstatic setNewEntryName(newEntryName)\n\t{\n\t\tEntryManager.newEntryName = newEntryName;\n\t}\n\n\tstatic showEditEntryNotification(entryId)\n\t{\n\t\tUtil.showNotification(\n\t\t\tLoc.getMessage('CALENDAR_SAVE_EVENT_NOTIFICATION'),\n\t\t\t[{\n\t\t\t\ttitle: Loc.getMessage('CALENDAR_EVENT_DO_VIEW'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: function(event, balloon, action) {\n\n\t\t\t\t\t\tEntryManager.openViewSlider(entryId);\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}]\n\t\t)\n\t}\n\n\tstatic showNewEntryNotification(entryId)\n\t{\n\t\tUtil.showNotification(\n\t\t\tLoc.getMessage('CALENDAR_NEW_EVENT_NOTIFICATION'),\n\t\t\t[{\n\t\t\t\ttitle: Loc.getMessage('CALENDAR_EVENT_DO_VIEW'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (event, balloon, action) => {\n\n\t\t\t\t\t\tEntryManager.openViewSlider(entryId);\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}]\n\t\t)\n\t}\n\n\tstatic showDeleteEntryNotification(entry)\n\t{\n\t\tif (entry && entry instanceof Entry)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tid: 'calendar' + entry.getUniqueId(),\n\t\t\t\tcontent: Loc.getMessage('CALENDAR_DELETE_EVENT_NOTIFICATION'),\n\t\t\t\tactions: [{\n\t\t\t\t\ttitle: Loc.getMessage('CALENDAR_EVENT_DO_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon, action) => {\n\t\t\t\t\t\t\tentry.cancelDelete();\n\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showReleaseLocationNotification()\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('CALENDAR_RELEASE_LOCATION_NOTIFICATION'),\n\t\t});\n\t}\n\n\tstatic closeDeleteNotificationBalloon(entry)\n\t{\n\t\tif (entry && entry instanceof Entry)\n\t\t{\n\t\t\tconst balloon = BX.UI.Notification.Center.getBalloonById('calendar' + entry.getUniqueId());\n\t\t\tif (balloon)\n\t\t\t{\n\t\t\t\tballoon.close();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic openEditSlider(options = {})\n\t{\n\t\tconst bx = Util.getBX();\n\n\t\tif (bx.Calendar && bx.Calendar.SliderLoader)\n\t\t{\n\t\t\tnew bx.Calendar.SliderLoader(\n\t\t\t\toptions.entry ? 'EDIT' + options.entry.id : 'NEW',\n\t\t\t\t{\n\t\t\t\t\tcalendarContext: options.calendarContext,\n\t\t\t\t\tentry: options.entry || null,\n\t\t\t\t\ttype: options.type,\n\t\t\t\t\tisLocationCalendar: options.isLocationCalendar || false,\n\t\t\t\t\troomsManager: options.roomsManager || null,\n\t\t\t\t\tlocationAccess: options.locationAccess || false,\n\t\t\t\t\tdayOfWeekMonthFormat: options.dayOfWeekMonthFormat || false,\n\t\t\t\t\tlocationCapacity: options.locationCapacity || 0,\n\t\t\t\t\townerId: options.ownerId,\n\t\t\t\t\tuserId: options.userId,\n\t\t\t\t\tformDataValue: options.formDataValue || null\n\t\t\t\t}\n\t\t\t).show();\n\t\t}\n\t}\n\n\tstatic openViewSlider(eventId = null, options = {})\n\t{\n\t\tif (!Type.isNull(eventId))\n\t\t{\n\t\t\tconst bx = Util.getBX();\n\t\t\tif (bx.Calendar && bx.Calendar.SliderLoader)\n\t\t\t{\n\t\t\t\tnew bx.Calendar.SliderLoader(eventId, {\n\t\t\t\t\tentryDateFrom: options.from,\n\t\t\t\t\ttimezoneOffset: options.timezoneOffset,\n\t\t\t\t\tdayOfWeekMonthFormat: options.dayOfWeekMonthFormat || false,\n\t\t\t\t\tcalendarContext: options.calendarContext || null,\n\t\t\t\t}).show();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic deleteEntry(entry, calendarContext = null)\n\t{\n\t\tif (entry instanceof Entry)\n\t\t{\n\t\t\tconst slider = Util.getBX().SidePanel.Instance.getTopSlider();\n\t\t\tconst beforeDeleteHandler = () => {\n\t\t\t\tif (slider && slider.options.type === 'calendar:slider')\n\t\t\t\t{\n\t\t\t\t\tUtil.getBX().SidePanel.Instance.close();\n\t\t\t\t}\n\t\t\t};\n\t\t\tEventEmitter.subscribe('BX.Calendar.Entry:beforeDelete', beforeDeleteHandler);\n\n\t\t\tconst deleteHandler = () => {\n\t\t\t\tconst calendar = Util.getCalendarContext();\n\t\t\t\tif (!calendar && !calendarContext)\n\t\t\t\t{\n\t\t\t\t\treturn Util.getBX().reload();\n\t\t\t\t}\n\n\t\t\t\tif (calendar)\n\t\t\t\t{\n\t\t\t\t\tcalendar.reload();\n\t\t\t\t}\n\t\t\t\telse if (calendarContext)\n\t\t\t\t{\n\t\t\t\t\tcalendarContext.reload();\n\t\t\t\t}\n\t\t\t\tEventEmitter.unsubscribe('BX.Calendar.Entry:delete', deleteHandler);\n\t\t\t\tEventEmitter.unsubscribe('BX.Calendar.Entry:beforeDelete', beforeDeleteHandler);\n\t\t\t};\n\n\t\t\tEventEmitter.subscribe('BX.Calendar.Entry:delete', deleteHandler);\n\n\t\t\tentry.delete();\n\t\t}\n\t}\n\n\tstatic setMeetingStatus(entry, status, params = {})\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tif (!Type.isPlainObject(params))\n\t\t\t{\n\t\t\t\tparams = {};\n\t\t\t}\n\t\t\tparams.recursionMode = params.recursionMode || false;\n\n\t\t\tif (status === 'N' && !params.confirmed)\n\t\t\t{\n\t\t\t\tif (entry.isRecursive())\n\t\t\t\t{\n\t\t\t\t\tthis.showConfirmStatusDialog(entry, resolve);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.setMeetingStatus', {\n\t\t\t\tdata: {\n\t\t\t\t\tentryId: entry.id,\n\t\t\t\t\tentryParentId: entry.parentId,\n\t\t\t\t\tstatus: status,\n\t\t\t\t\trecursionMode: params.recursionMode,\n\t\t\t\t\tcurrentDateFrom: Util.formatDate(entry.from)\n\t\t\t\t}\n\t\t\t}).then(\n\t\t\t\t(response) => {\n\t\t\t\t\tBX.Event.EventEmitter.emit(\n\t\t\t\t\t\t'BX.Calendar.Entry:onChangeMeetingStatus',\n\t\t\t\t\t\tnew Event.BaseEvent({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tentry: entry,\n\t\t\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\t\t\trecursionMode: params.recursionMode,\n\t\t\t\t\t\t\t\tcurrentDateFrom: entry.from,\n\t\t\t\t\t\t\t\tcounters: response.data.counters\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t\tif (entry instanceof Entry)\n\t\t\t\t\t{\n\t\t\t\t\t\tentry.setCurrentStatus(status);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tentry: entry,\n\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\trecursionMode: params.recursionMode,\n\t\t\t\t\t\tcurrentDateFrom: entry.from\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic showConfirmStatusDialog(entry, resolvePromiseCallback = null)\n\t{\n\t\tif (!this.confirmDeclineDialog)\n\t\t{\n\t\t\tconst bx = Util.getBX();\n\t\t\tthis.confirmDeclineDialog = new bx.Calendar.Controls.ConfirmStatusDialog();\n\t\t}\n\n\t\tthis.confirmDeclineDialog.show();\n\t\tthis.confirmDeclineDialog.unsubscribeAll('onDecline');\n\t\tthis.confirmDeclineDialog.subscribe('onDecline', function(event)\n\t\t{\n\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t{\n\t\t\t\tEntryManager.setMeetingStatus(\n\t\t\t\t\tentry,\n\t\t\t\t\t'N',\n\t\t\t\t\t{recursionMode: event.getData().recursionMode, confirmed: true}\n\t\t\t\t).then(() => {\n\t\t\t\t\tif (Type.isFunction(resolvePromiseCallback))\n\t\t\t\t\t{\n\t\t\t\t\t\tresolvePromiseCallback();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic showConfirmEditDialog(options)\n\t{\n\t\tif (!this.confirmEditDialog)\n\t\t{\n\t\t\tconst bx = Util.getBX();\n\t\t\tthis.confirmEditDialog = new bx.Calendar.Controls.ConfirmEditDialog();\n\t\t}\n\t\tthis.confirmEditDialog.show();\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.confirmEditDialog.unsubscribeAll('onEdit');\n\t\t\tthis.confirmEditDialog.subscribe('onEdit', (event) => {\n\t\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t\t{\n\t\t\t\t\toptions.callback(event.getData());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showReInviteUsersDialog(options)\n\t{\n\t\tif (!this.reinviteUsersDialog)\n\t\t{\n\t\t\tconst bx = Util.getBX();\n\t\t\tthis.reinviteUsersDialog = new bx.Calendar.Controls.ReinviteUserDialog();\n\t\t}\n\t\tthis.reinviteUsersDialog.show();\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.reinviteUsersDialog.unsubscribeAll('onSelect');\n\t\t\tthis.reinviteUsersDialog.subscribe('onSelect', function(event)\n\t\t\t{\n\t\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t\t{\n\t\t\t\t\toptions.callback(event.getData());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showConfirmedEmailDialog(options = {})\n\t{\n\t\tif (!this.confirmedEmailDialog)\n\t\t{\n\t\t\tconst bx = Util.getBX();\n\t\t\tthis.confirmedEmailDialog = new bx.Calendar.Controls.ConfirmedEmailDialog();\n\t\t}\n\t\tthis.confirmedEmailDialog.show();\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.confirmedEmailDialog.unsubscribeAll('onSelect');\n\t\t\tthis.confirmedEmailDialog.subscribe('onSelect', function(event)\n\t\t\t{\n\t\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t\t{\n\t\t\t\t\toptions.callback(event.getData());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showEmailLimitationDialog(options = {})\n\t{\n\t\tif (!this.limitationEmailDialog)\n\t\t{\n\t\t\tconst bx = Util.getBX();\n\t\t\tthis.limitationEmailDialog = new bx.Calendar.Controls.EmailLimitationDialog();\n\t\t}\n\t\tthis.limitationEmailDialog.subscribe('onClose', ()=>{\n\t\t\tif (Type.isFunction(options.callback))\n\t\t\t{\n\t\t\t\toptions.callback();\n\t\t\t}\n\t\t});\n\t\tthis.limitationEmailDialog.show();\n\t}\n\n\tstatic getCompactViewForm(create = true)\n\t{\n\t\tif (!EntryManager.compactEntryForm && create)\n\t\t{\n\t\t\tEntryManager.compactEntryForm = new CompactEventForm();\n\t\t}\n\n\t\treturn EntryManager.compactEntryForm;\n\t}\n\n\tstatic openCompactViewForm(options = {})\n\t{\n\t\tconst compactForm = EntryManager.getCompactViewForm();\n\t\tif (!compactForm.isShown())\n\t\t{\n\t\t\tcompactForm.unsubscribeAll('onClose');\n\t\t\tif (Type.isFunction(options.closeCallback))\n\t\t\t{\n\t\t\t\tcompactForm.subscribe('onClose', options.closeCallback);\n\t\t\t}\n\t\t\tcompactForm.showInViewMode(options);\n\t\t}\n\t}\n\n\tstatic openCompactEditForm(options = {})\n\t{\n\t\tconst compactForm = EntryManager.getCompactViewForm();\n\t\tif (!compactForm.isShown())\n\t\t{\n\t\t\tcompactForm.unsubscribeAll('onClose');\n\t\t\tif (Type.isFunction(options.closeCallback))\n\t\t\t{\n\t\t\t\tcompactForm.subscribe('onClose', options.closeCallback);\n\t\t\t}\n\t\t\tcompactForm.showInEditMode(options);\n\t\t}\n\t}\n\n\tstatic getEntryInstance(entry, userIndex, options = {})\n\t{\n\t\tlet entryInstance = null;\n\t\tif (entry instanceof Entry)\n\t\t{\n\t\t\tentryInstance = entry;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (Type.isObject(entry) && Type.isObject(entry.data))\n\t\t\t{\n\t\t\t\tentryInstance = new Entry({data: entry.data, userIndex: userIndex});\n\t\t\t}\n\t\t\telse if (Type.isObject(entry))\n\t\t\t{\n\t\t\t\tentryInstance = new Entry({data: entry, userIndex: userIndex});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tentryInstance = EntryManager.getNewEntry(options);\n\t\t\t}\n\t\t}\n\n\t\treturn entryInstance;\n\t}\n\n\tstatic getUserIndex(options = {})\n\t{\n\t\treturn EntryManager.userIndex\n\t}\n\n\tstatic setUserIndex(userIndex)\n\t{\n\t\tEntryManager.userIndex = userIndex;\n\t}\n\n\thandlePullChanges(params)\n\t{\n\t\tif (!BX.Calendar.Util.checkRequestId(params.requestUid))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst compactForm = EntryManager.getCompactViewForm();\n\t\tif (\n\t\t\tcompactForm\n\t\t\t&& compactForm.isShown()\n\t\t)\n\t\t{\n\t\t\tcompactForm.handlePull(params);\n\t\t}\n\n\t\tBX.SidePanel.Instance.getOpenSliders().forEach(slider =>\n\t\t{\n\t\t\tconst data = EntryManager.slidersMap.get(slider);\n\t\t\tif (\n\t\t\t\tdata\n\t\t\t\t&& data.entry\n\t\t\t\t&& data.entry.parentId === parseInt(params?.fields?.PARENT_ID)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tparams.command === 'delete_event'\n\t\t\t\t\t&& data.entry.getType() === params?.fields?.CAL_TYPE\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tslider.close();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (params.command === 'set_meeting_status')\n\t\t{\n\t\t\ttop.BX.Event.EventEmitter.emit('BX.Calendar:doReloadCounters');\n\t\t}\n\t\telse if (params.command === 'delete_event' || params.command === 'edit_event')\n\t\t{\n\t\t\tif (\n\t\t\t\t!params.fields\n\t\t\t\t||\n\t\t\t\t(params?.fields?.IS_MEETING && params?.fields?.MEETING_STATUS === 'Q')\n\t\t\t)\n\t\t\t{\n\t\t\t\ttop.BX.Event.EventEmitter.emit('BX.Calendar:doReloadCounters');\n\t\t\t}\n\n\t\t\tif (params?.fields?.CAL_TYPE === 'location' && top.BX.Calendar?.Controls?.Location)\n\t\t\t{\n\t\t\t\ttop.BX.Calendar.Controls.Location.handlePull(params);\n\t\t\t}\n\t\t}\n\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tconst entrySectionId = parseInt(params?.fields?.SECTION_ID);\n\t\tlet sectionDisplayed = Type.isArray(params.sections)\n\t\t\t&& params.sections.find(section => {\n\t\t\t\treturn section.id === entrySectionId && section.isShown();\n\t\t\t});\n\n\t\tlet loadedEntry = params?.fields\n\t\t\t? EntryManager.getEntryInstance(\n\t\t\t\tcalendarContext.getView().getEntryById(EntryManager.getEntryUniqueId(params.fields)),\n\t\t\t)\n\t\t\t: null;\n\n\t\tif ((sectionDisplayed || loadedEntry) && calendarContext)\n\t\t{\n\t\t\tcalendarContext.reloadDebounce();\n\t\t}\n\t}\n\n\tstatic registerDeleteTimeout(params)\n\t{\n\t\tEntryManager.delayedActionList.push(params);\n\t}\n\n\tstatic unregisterDeleteTimeout({action, data})\n\t{\n\t\tEntryManager.delayedActionList = EntryManager.delayedActionList.filter((item) => {\n\t\t\treturn item.action !== action\n\t\t\t\t|| item.data.entryId !== data.entryId\n\t\t\t\t|| item.data.recursionMode !== data.recursionMode\n\t\t\t\t|| item.data.excludeDate !== data.excludeDate;\n\t\t});\n\t}\n\n\tstatic doDelayedActions()\n\t{\n\t\tlet requestList = [];\n\t\treturn new Promise(resolve => {\n\t\t\tif(!EntryManager.delayedActionList.length)\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\n\t\t\tEntryManager.delayedActionList.forEach(({action, data, params}) => {\n\n\t\t\t\tconst requestUid = parseInt(data.requestUid);\n\t\t\t\trequestList.push(data.requestUid);\n\n\t\t\t\tif (params.entry)\n\t\t\t\t{\n\t\t\t\t\tEntryManager.closeDeleteNotificationBalloon(params.entry);\n\t\t\t\t}\n\n\t\t\t\tBX.ajax.runAction(\n\t\t\t\t\t`calendar.api.calendarajax.${action}`,\n\t\t\t\t\t{data: data}\n\t\t\t\t).then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tType.isFunction(params.callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparams.callback();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\trequestList = requestList.filter(uid => {return uid !== requestUid});\n\t\t\t\t\t\tif (!requestList.length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t() => {\n\t\t\t\t\t\trequestList = requestList.filter(uid => {return uid !== requestUid});\n\t\t\t\t\t\tif (!requestList.length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tEntryManager.unregisterDeleteTimeout({action, data, params});\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic getEntryUniqueId(entryData, entry)\n\t{\n\t\tlet sid = entryData.PARENT_ID || entryData.ID;\n\t\tif (entryData.RRULE)\n\t\t{\n\t\t\tsid += '|' + (entry ? Util.formatDate(entry.from) : Util.formatDate(BX.parseDate(entryData.DATE_FROM)));\n\t\t}\n\n\t\tif (entryData['~TYPE'] === 'tasks')\n\t\t{\n\t\t\tsid += '|' + 'task';\n\t\t}\n\t\treturn sid;\n\t}\n\n\tstatic registerEntrySlider(entry, control)\n\t{\n\t\tconst slider = Util.getBX().SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\tEntryManager.slidersMap.set(slider, {entry, control});\n\t\t}\n\t}\n\n\tstatic getNewEntryReminders(type = 'withTime')\n\t{\n\t\tconst userSettings = Util.getUserSettings();\n\t\tif (Type.isObjectLike(userSettings.defaultReminders)\n\t\t\t&& Type.isArray(userSettings.defaultReminders[type])\n\t\t\t&& userSettings.defaultReminders[type].length)\n\t\t{\n\t\t\treturn userSettings.defaultReminders[type];\n\t\t}\n\n\t\treturn type === 'withTime'\n\t\t\t? [{type: 'min', count: 15}]\n\t\t\t: [{type: 'daybefore', before: 0, time: 480}];\n\t}\n\n\tstatic setNewEntryReminders(type = 'withTime', reminders)\n\t{\n\t\tconst userSettings = Util.getUserSettings();\n\t\tif (Type.isObjectLike(userSettings.defaultReminders))\n\t\t{\n\t\t\tuserSettings.defaultReminders[type] = reminders;\n\t\t}\n\t\tUtil.setUserSettings(userSettings);\n\t}\n}","import {ConfirmDeleteDialog} from \"calendar.controls\";\nimport {Util} from 'calendar.util';\nimport {EntryManager} from \"./entrymanager\";\nimport { Type, Dom } from 'main.core';\n\nexport {EntryManager};\n\nexport class Entry\n{\n\tFULL_DAY_LENGTH = 86400;\n\tconstructor(options = {})\n\t{\n\t\tthis.prepareData(options.data);\n\t\tthis.parts = [];\n\n\t\tif (options.userIndex)\n\t\t{\n\t\t\tthis.setUserIndex(options.userIndex);\n\t\t}\n\n\t\tthis.delayTimeoutMap = new Map();\n\t}\n\n\tprepareData(data)\n\t{\n\t\tthis.data = data;\n\t\tthis.id = parseInt(this.data.ID || 0);\n\t\tthis.parentId = parseInt(this.data.PARENT_ID || 0);\n\n\t\tif (!this.data.DT_SKIP_TIME)\n\t\t{\n\t\t\tthis.data.DT_SKIP_TIME = this.data.SKIP_TIME ? 'Y' : 'N';\n\t\t}\n\n\t\tthis.fullDay = this.data.DT_SKIP_TIME === 'Y';\n\t\tthis.accessibility = this.data.ACCESSIBILITY || 'busy';\n\t\tthis.important = this.data.IMPORTANCE === 'high';\n\t\tthis.private = !!this.data.PRIVATE_EVENT;\n\t\tthis.setSectionId(this.data.SECT_ID);\n\t\tthis.name = this.data.NAME;\n\n\t\tthis.userTimezoneOffsetFrom = parseInt(this.data['~USER_OFFSET_FROM']) || 0;\n\t\tthis.userTimezoneOffsetTo = parseInt(this.data['~USER_OFFSET_TO']) || this.userTimezoneOffsetFrom;\n\n\t\tif (!this.data.DT_LENGTH)\n\t\t{\n\t\t\tthis.data.DT_LENGTH = this.data.DURATION || 0;\n\t\t}\n\t\tif (this.fullDay && !this.data.DT_LENGTH)\n\t\t{\n\t\t\tthis.data.DT_LENGTH = this.FULL_DAY_LENGTH;\n\t\t}\n\t\t\n\t\tif (\n\t\t\t!Type.isString(this.data.DATE_FROM) && !Type.isString(this.data.DATE_TO)\n\t\t\t&& Type.isDate(this.data.dateFrom) && Type.isDate(this.data.dateTo)\n\t\t)\n\t\t{\n\t\t\tthis.from = this.data.dateFrom;\n\t\t\tthis.to = this.data.dateTo;\n\n\t\t\tthis.data.DT_LENGTH = Math.round((this.to.getTime() - this.from.getTime()) / 1000);\n\t\t\tthis.data.DURATION = this.data.DT_LENGTH;\n\n\t\t\tif (this.fullDay)\n\t\t\t{\n\t\t\t\tthis.data.DATE_FROM = Util.formatDate(this.from.getTime());\n\t\t\t\tthis.data.DATE_TO = Util.formatDate(this.to.getTime());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.from = new Date(this.from.getTime() - (parseInt(this.data['~USER_OFFSET_FROM']) || 0) * 1000);\n\t\t\t\tthis.to = new Date(this.to.getTime() - (parseInt(this.data['~USER_OFFSET_TO']) || 0) * 1000);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.isTask())\n\t\t\t{\n\t\t\t\tthis.from = BX.parseDate(this.data.DATE_FROM) || new Date();\n\t\t\t\tthis.to = BX.parseDate(this.data.DATE_TO) || this.from;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.from = BX.parseDate(this.data.DATE_FROM) || new Date();\n\t\t\t\tthis.to = BX.parseDate(this.data.DATE_TO) || this.from;\n\t\t\t}\n\t\t}\n\n\t\tif (this.fullDay)\n\t\t{\n\t\t\tthis.from.setHours(0, 0, 0, 0);\n\t\t\tthis.to.setHours(0, 0, 0, 0);\n\t\t}\n\n\t\tif (!this.data.ATTENDEES_CODES && !this.isTask())\n\t\t{\n\t\t\tif (this.data.CAL_TYPE === 'user' && this.data.OWNER_ID)\n\t\t\t{\n\t\t\t\tthis.data.ATTENDEES_CODES = ['U' + this.data.OWNER_ID];\n\t\t\t}\n\t\t\telse if (this.data.CREATED_BY)\n\t\t\t{\n\t\t\t\tthis.data.ATTENDEES_CODES = ['U' + this.data.CREATED_BY];\n\t\t\t}\n\t\t}\n\n\t\tthis.startDayCode = this.from;\n\t\tthis.endDayCode = this.to;\n\n\t\tif (!Type.isArray(this.data.REMIND) && Type.isArray(this.data.remind))\n\t\t{\n\t\t\tthis.data.REMIND = [];\n\t\t\tthis.data.remind.forEach(function(value)\n\t\t\t{\n\t\t\t\tthis.data.REMIND.push({type: 'min', count: value});\n\t\t\t}, this);\n\t\t\tdelete this.data.remind;\n\t\t}\n\t}\n\n\tgetAttendeesCodes()\n\t{\n\t\treturn this.data.ATTENDEES_CODES || [];\n\t}\n\n\tgetAttendeesEntityList()\n\t{\n\t\treturn this.data.attendeesEntityList || [];\n\t}\n\n\tgetAttendees()\n\t{\n\t\tif (!this.attendeeList)\n\t\t{\n\t\t\tthis.attendeeList = [];\n\t\t\tif (Type.isArray(this.data['ATTENDEE_LIST']))\n\t\t\t{\n\t\t\t\tconst userIndex = this.getUserIndex();\n\t\t\t\tthis.data['ATTENDEE_LIST'].forEach((user) => {\n\t\t\t\t\tif (userIndex[user.id])\n\t\t\t\t\t{\n\t\t\t\t\t\tlet attendee = BX.clone(userIndex[user.id]);\n\t\t\t\t\t\tattendee.STATUS = user.status;\n\t\t\t\t\t\tattendee.ENTRY_ID = user.entryId || false;\n\t\t\t\t\t\tthis.attendeeList.push(attendee);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this.attendeeList;\n\t}\n\n\tsetUserIndex(userIndex)\n\t{\n\t\tthis.userIndex = userIndex;\n\t}\n\n\tgetUserIndex()\n\t{\n\t\treturn this.userIndex || EntryManager.getUserIndex();\n\t}\n\n\tcleanParts()\n\t{\n\t\tthis.parts = [];\n\t}\n\n\tstartPart(part)\n\t{\n\t\tpart.partIndex = this.parts.length;\n\t\tthis.parts.push(part);\n\t\treturn this.parts[part.partIndex];\n\t}\n\n\tregisterPartNode(part, params)\n\t{\n\t\tpart.params = params;\n\t}\n\n\tcheckPartIsRegistered(part)\n\t{\n\t\treturn Type.isPlainObject(part.params);\n\t}\n\n\tgetPart(partIndex)\n\t{\n\t\treturn this.parts[partIndex] || false;\n\t}\n\n\tgetWrap(partIndex)\n\t{\n\t\treturn this.parts[partIndex || 0].params.wrapNode;\n\t}\n\n\tgetSectionName()\n\t{\n\t\t//return this.calendar.sectionController.getSection(this.sectionId).name || '';\n\t}\n\n\tgetDescription()\n\t{\n\t\treturn this.data.DESCRIPTION || '';\n\t}\n\n\tapplyViewRange(viewRange)\n\t{\n\t\tlet\n\t\t\tviewRangeStart = viewRange.start.getTime(),\n\t\t\tviewRangeEnd = viewRange.end.getTime(),\n\t\t\tfromTime = this.from.getTime(),\n\t\t\ttoTime = this.to.getTime();\n\n\t\tif (toTime < viewRangeStart || fromTime > viewRangeEnd)\n\t\t\treturn false;\n\n\t\tif (fromTime < viewRangeStart)\n\t\t{\n\t\t\tthis.displayFrom = viewRange.start;\n\t\t\tthis.startDayCode = this.displayFrom;\n\t\t}\n\n\t\tif (toTime > viewRangeEnd)\n\t\t{\n\t\t\tthis.displayTo = viewRange.end;\n\t\t\tthis.endDayCode = this.displayTo;\n\t\t}\n\t\treturn true;\n\t}\n\n\tisPersonal()\n\t{\n\t\t//return (this.data.CAL_TYPE === 'user' && this.data.OWNER_ID == this.calendar.util.userId);\n\t}\n\n\tisMeeting()\n\t{\n\t\treturn !!this.data.IS_MEETING;\n\t}\n\n\tisPrivate()\n\t{\n\t\treturn this.private;\n\t}\n\n\tisResourcebooking()\n\t{\n\t\treturn this.data.EVENT_TYPE === '#resourcebooking#';\n\t}\n\n\tisTask()\n\t{\n\t\treturn this.data['~TYPE'] === 'tasks';\n\t}\n\n\tisLocation()\n\t{\n\t\treturn this.getType() === 'location';\n\t}\n\n\tisFullDay()\n\t{\n\t\treturn this.fullDay;\n\t}\n\n\tisLongWithTime()\n\t{\n\t\treturn !this.fullDay && Util.getDayCode(this.from) !== Util.getDayCode(this.to);\n\t}\n\n\tisExpired()\n\t{\n\t\treturn this.to.getTime() < new Date().getTime();\n\t}\n\n\thasEmailAttendees()\n\t{\n\t\tif (this.emailAttendeesCache === undefined)\n\t\t{\n\t\t\tconst userIndex = EntryManager.getUserIndex();\n\t\t\tfor (let i = 0; i < this.data['ATTENDEE_LIST'].length; i++)\n\t\t\t{\n\t\t\t\tlet user = this.data['ATTENDEE_LIST'][i];\n\t\t\t\tif ((user.status === 'Y' || user.status === 'Q')\n\t\t\t\t\t&& userIndex[user.id]\n\t\t\t\t\t&& userIndex[user.id].EMAIL_USER\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.emailAttendeesCache = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.emailAttendeesCache;\n\t}\n\n\townerIsEmailUser()\n\t{\n\t\tif (this.ownerIsEmailUserCache === undefined)\n\t\t{\n\t\t\tconst userIndex = EntryManager.getUserIndex();\n\t\t\tthis.ownerIsEmailUserCache = userIndex[parseInt(this.data.MEETING_HOST)]\n\t\t\t\t&& userIndex[parseInt(this.data.MEETING_HOST)].EMAIL_USER;\n\t\t}\n\t\treturn this.ownerIsEmailUserCache;\n\t}\n\n\tisSelected()\n\t{\n\t\treturn !!this.selected;\n\t}\n\n\tisCrm()\n\t{\n\t\treturn !!this.data.UF_CRM_CAL_EVENT;\n\t}\n\n\tisFirstReccurentEntry()\n\t{\n\t\treturn (this.data.DATE_FROM_TS_UTC === Math.floor(BX.parseDate(this.data['~DATE_FROM']).getTime() / 1000) * 1000\n\t\t\t||\n\t\t\tBX.parseDate(this.data['DATE_FROM']).getTime() === BX.parseDate(this.data['~DATE_FROM']).getTime()\n\t\t) && !this.data.RECURRENCE_ID;\n\t}\n\n\tisRecursive()\n\t{\n\t\treturn !!this.data.RRULE;\n\t}\n\n\tisFirstInstance()\n\t{\n\t\treturn this.data.RRULE && this.data.RINDEX === 0;\n\t}\n\n\tgetMeetingHost()\n\t{\n\t\treturn parseInt(this.data.MEETING_HOST);\n\t}\n\n\tgetMeetingNotify()\n\t{\n\t\treturn this.data.MEETING.NOTIFY;\n\t}\n\n\tgetHideGuests()\n\t{\n\t\treturn this.data.MEETING && BX.Type.isBoolean(this.data.MEETING.HIDE_GUESTS)\n\t\t\t? this.data.MEETING.HIDE_GUESTS\n\t\t\t: true;\n\t}\n\n\tgetRrule()\n\t{\n\t\treturn this.data.RRULE;\n\t}\n\n\tgetRRuleDescription()\n\t{\n\t\treturn this.data['~RRULE_DESCRIPTION'];\n\t}\n\n\thasRecurrenceId()\n\t{\n\t\treturn this.data.RECURRENCE_ID;\n\t}\n\n\twasEverRecursive()\n\t{\n\t\treturn this.data.RRULE || this.data.RECURRENCE_ID;\n\t}\n\n\tdeselect()\n\t{\n\t\tthis.selected = false;\n\t}\n\n\tselect()\n\t{\n\t\tthis.selected = true;\n\t}\n\n\tdeleteParts(recursionMode)\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tconst wrap = calendarContext.getView().getContainer();\n\n\t\t\tif (recursionMode === 'all')\n\t\t\t{\n\t\t\t\tcalendarContext.getView().entries.forEach((entry) => {\n\t\t\t\t\tif (parseInt(entry.id) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === parseInt(this.data.RECURRENCE_ID)\n\t\t\t\t\t\t|| parseInt(entry.id) === parseInt(this.data.RECURRENCE_ID)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst entryPart = wrap.querySelector('div[data-bx-calendar-entry=\"' + entry.uid + '\"]');\n\t\t\t\t\t\tif (entryPart)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentryPart.style.opacity = 0;\n\t\t\t\t\t\t\tsetTimeout(()=>{entryPart.style.display = 'none';}, 200);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (recursionMode === 'next')\n\t\t\t{\n\t\t\t\tcalendarContext.getView().entries.forEach((entry) => {\n\t\t\t\t\tif ((parseInt(entry.id) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === parseInt(this.data.RECURRENCE_ID)\n\t\t\t\t\t\t|| parseInt(entry.id) === parseInt(this.data.RECURRENCE_ID))\n\t\t\t\t\t\t&& entry.from.getTime() > this.from.getTime()\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst entryPart = wrap.querySelector('div[data-bx-calendar-entry=\"' + entry.uid + '\"]');\n\t\t\t\t\t\tif (entryPart)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentryPart.style.opacity = 0;\n\t\t\t\t\t\t\tsetTimeout(()=>{entryPart.style.display = 'none';}, 200);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (recursionMode === 'this' || !recursionMode)\n\t\t\t{\n\t\t\t\tconst parts = wrap.querySelectorAll('div[data-bx-calendar-entry=\"' + this.getUniqueId() + '\"]');\n\t\t\t\tparts.forEach((entryPart)=>{\n\t\t\t\t\tentryPart.style.opacity = 0;\n\t\t\t\t\tsetTimeout(()=>{entryPart.style.display = 'none';}, 200);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tgetUniqueId()\n\t{\n\t\treturn EntryManager.getEntryUniqueId(this.data, this);\n\t}\n\n\tgetCurrentStatus()\n\t{\n\t\tlet\n\t\t\tuserId = Util.getCurrentUserId(),\n\t\t\tstatus = false,\n\t\t\ti, user;\n\n\t\tif (this.isMeeting())\n\t\t{\n\t\t\tif (userId === parseInt(this.data.CREATED_BY))\n\t\t\t{\n\t\t\t\tstatus = this.data.MEETING_STATUS || 'Q';\n\t\t\t}\n\t\t\telse if (userId === parseInt(this.data.MEETING_HOST))\n\t\t\t{\n\t\t\t\tstatus = 'H';\n\t\t\t\t//status = this.data.MEETING_STATUS || 'H';\n\t\t\t}\n\t\t\telse if (Type.isArray(this.data['ATTENDEE_LIST']))\n\t\t\t{\n\t\t\t\tfor (i = 0; i < this.data['ATTENDEE_LIST'].length; i++)\n\t\t\t\t{\n\t\t\t\t\tuser = this.data['ATTENDEE_LIST'][i];\n\t\t\t\t\tif (parseInt(user.id) === userId)\n\t\t\t\t\t{\n\t\t\t\t\t\tstatus = user.status;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (userId === parseInt(this.data.CREATED_BY))\n\t\t{\n\t\t\tstatus = this.data.MEETING_STATUS || 'H';\n\t\t}\n\n\t\treturn Util.getMeetingStatusList().includes(status) ? status : false;\n\t}\n\n\tsetCurrentStatus(status)\n\t{\n\t\tif (this.isMeeting() && Util.getMeetingStatusList().includes(status))\n\t\t{\n\t\t\tthis.data.MEETING_STATUS = status;\n\n\t\t\tconst userId = Util.getCurrentUserId();\n\t\t\tif (Type.isArray(this.data['ATTENDEE_LIST']))\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < this.data['ATTENDEE_LIST'].length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (parseInt(this.data['ATTENDEE_LIST'][i].id) === userId)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.data['ATTENDEE_LIST'][i].status = status;\n\t\t\t\t\t\tthis.attendeeList = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetReminders()\n\t{\n\t\tlet res = [];\n\t\tif (this.data && this.data.REMIND)\n\t\t{\n\t\t\tthis.data.REMIND.forEach(function (remind)\n\t\t\t{\n\t\t\t\tswitch(remind.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'min':\n\t\t\t\t\t\tres.push(remind.count);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'hour':\n\t\t\t\t\t\tres.push(parseInt(remind.count) * 60);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'day':\n\t\t\t\t\t\tres.push(parseInt(remind.count) * 60 * 24);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'daybefore':\n\t\t\t\t\t\tres.push(remind);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'date':\n\t\t\t\t\t\tif (!Type.isDate(remind.value))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tremind.value = Util.parseDate(remind.value);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isDate(remind.value))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tres.push(remind);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn res;\n\t}\n\n\tgetLengthInDays()\n\t{\n\t\tlet\n\t\t\tfrom = new Date(this.from.getFullYear(), this.from.getMonth(), this.from.getDate(), 0, 0, 0),\n\t\t\tto = new Date(this.to.getFullYear(), this.to.getMonth(), this.to.getDate(), 0, 0, 0);\n\n\t\treturn Math.round((to.getTime() - from.getTime()) / Util.getDayLength()) + 1;\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.name || this.defaultNewName;\n\t}\n\n\tgetColor()\n\t{\n\t\treturn this.data.COLOR;\n\t}\n\n\tgetType()\n\t{\n\t\treturn this.data.CAL_TYPE;\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn this.data.OWNER_ID;\n\t}\n\n\tdelete(params)\n\t{\n\t\tparams = Type.isPlainObject(params) ? params : {};\n\t\tlet recursionMode = params.recursionMode || false;\n\n\t\tif (this.wasEverRecursive() && !params.confirmed)\n\t\t{\n\t\t\treturn this.showConfirmDeleteDialog({entry: this});\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// Broadcast event\n\t\t\tBX.onCustomEvent('BX.Calendar.Entry:beforeDelete', [{entryId: this.id, recursionMode: recursionMode}]);\n\n\t\t\tEntryManager.showDeleteEntryNotification(this);\n\t\t\tthis.deleteParts(recursionMode);\n\n\t\t\tconst action = 'deleteCalendarEntry';\n\t\t\tconst data = {\n\t\t\t\tentryId: this.id,\n\t\t\t\trecursionMode: params.recursionMode || false,\n\t\t\t\trequestUid: Util.registerRequestId(),\n\t\t\t};\n\n\t\t\tEntryManager.registerDeleteTimeout({\n\t\t\t\taction,\n\t\t\t\tdata,\n\t\t\t\tparams: {\n\t\t\t\t\tentry: this,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tBX.onCustomEvent('BX.Calendar.Entry:delete', [{entryId: this.id, recursionMode: recursionMode}]);\n\t\t\t\t\t}\n\t\t\t\t}});\n\n\t\t\tthis.deleteTimeout = setTimeout(EntryManager.doDelayedActions, EntryManager.DELETE_DELAY_TIMEOUT);\n\t\t\tthis.delayTimeoutMap.set(this.deleteTimeout, {action, data});\n\t\t}\n\t}\n\n\tdeleteThis()\n\t{\n\t\tlet recursionMode = 'this';\n\t\tif (this.isRecursive())\n\t\t{\n\t\t\tBX.onCustomEvent('BX.Calendar.Entry:beforeDelete', [{entryId: this.id, recursionMode: recursionMode}]);\n\n\t\t\tEntryManager.showDeleteEntryNotification(this);\n\t\t\tthis.deleteParts(recursionMode);\n\n\t\t\tconst action = 'excludeRecursionDate';\n\t\t\tconst data = {\n\t\t\t\tentryId: this.id,\n\t\t\t\trecursionMode: recursionMode,\n\t\t\t\texcludeDate: this.data.DATE_FROM,\n\t\t\t};\n\n\t\t\tEntryManager.registerDeleteTimeout({\n\t\t\t\taction,\n\t\t\t\tdata,\n\t\t\t\tparams: {\n\t\t\t\t\tentry: this,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tBX.onCustomEvent('BX.Calendar.Entry:delete', [data]);\n\t\t\t\t\t}\n\t\t\t\t}});\n\n\t\t\tthis.deleteTimeout = setTimeout(EntryManager.doDelayedActions, EntryManager.DELETE_DELAY_TIMEOUT);\n\t\t\tthis.delayTimeoutMap.set(this.deleteTimeout, {action, data});\n\t\t}\n\t\telse if (this.hasRecurrenceId())\n\t\t{\n\t\t\tthis.delete({confirmed: true, recursionMode: 'this'});\n\t\t}\n\t}\n\n\tdeleteNext()\n\t{\n\t\tlet recursionMode = 'next';\n\t\tif (this.isRecursive() && this.isFirstReccurentEntry())\n\t\t{\n\t\t\tthis.deleteAll();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.onCustomEvent('BX.Calendar.Entry:beforeDelete', [{entryId: this.id, recursionMode: recursionMode}]);\n\n\t\t\tEntryManager.showDeleteEntryNotification(this);\n\t\t\tthis.deleteParts(recursionMode);\n\n\t\t\tconst calendarContext = Util.getCalendarContext();\n\t\t\tif (calendarContext)\n\t\t\t{\n\n\t\t\t}\n\n\t\t\tconst action = 'changeRecurciveEntryUntil';\n\t\t\tconst data = {\n\t\t\t\tentryId: this.id,\n\t\t\t\trecursionMode: recursionMode,\n\t\t\t\tuntilDate: Util.formatDate(this.from.getTime() - Util.getDayLength()),\n\t\t\t};\n\t\t\tEntryManager.registerDeleteTimeout({\n\t\t\t\taction,\n\t\t\t\tdata,\n\t\t\t\tparams: {\n\t\t\t\t\tentry: this,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tBX.onCustomEvent('BX.Calendar.Entry:delete', [data]);\n\t\t\t\t\t}\n\t\t\t\t}});\n\n\t\t\tthis.deleteTimeout = setTimeout(EntryManager.doDelayedActions, EntryManager.DELETE_DELAY_TIMEOUT);\n\t\t\tthis.delayTimeoutMap.set(this.deleteTimeout, {action, data});\n\t\t}\n\t}\n\n\tdeleteAll()\n\t{\n\t\treturn this.delete({confirmed: true, recursionMode: 'all'});\n\t}\n\n\tcancelDelete()\n\t{\n\t\tif (this.deleteTimeout)\n\t\t{\n\t\t\tconst deleteTimeoutData = this.delayTimeoutMap.get(this.deleteTimeout);\n\t\t\tif (deleteTimeoutData)\n\t\t\t{\n\t\t\t\tEntryManager.unregisterDeleteTimeout(deleteTimeoutData);\n\t\t\t\tthis.delayTimeoutMap.delete(this.delayTimeoutMap);\n\t\t\t}\n\t\t\tclearTimeout(this.deleteTimeout);\n\t\t\tthis.deleteTimeout = null;\n\t\t}\n\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tcalendarContext.reload();\n\t\t}\n\t}\n\n\tshowConfirmDeleteDialog(params)\n\t{\n\t\tif (!this.confirmDeleteDialog)\n\t\t{\n\t\t\tthis.confirmDeleteDialog = new (window.BX || window.top.BX).Calendar.Controls\n\t\t\t\t.ConfirmDeleteDialog({entry: params.entry});\n\t\t}\n\t\tthis.confirmDeleteDialog.show();\n\t}\n\n\tsave()\n\t{\n\t}\n\n\tgetLocation()\n\t{\n\t\treturn this.data.LOCATION;\n\t}\n\n\tsetTimezone(timezoneFrom, timezoneTo = null)\n\t{\n\t\tif(Type.isString(timezoneFrom))\n\t\t{\n\t\t\tthis.data.TZ_FROM = timezoneFrom;\n\t\t\tif (Type.isNull(timezoneTo))\n\t\t\t{\n\t\t\t\tthis.data.TZ_TO = timezoneFrom;\n\t\t\t}\n\t\t}\n\t\tif(Type.isString(timezoneTo))\n\t\t{\n\t\t\tthis.data.TZ_TO = timezoneTo;\n\t\t}\n\t}\n\n\tgetTimezoneFrom()\n\t{\n\t\treturn this.data.TZ_FROM || '';\n\t}\n\n\tgetTimezoneTo()\n\t{\n\t\treturn this.data.TZ_TO || '';\n\t}\n\n\tsetSectionId(value)\n\t{\n\t\tthis.data.SECT_ID = this.sectionId = this.isTask() ? 'tasks' : parseInt(value);\n\t}\n\n\tsetDateTimeValue({from, to})\n\t{\n\t\tif (Type.isDate(from) && Type.isDate(to))\n\t\t{\n\t\t\tthis.from = this.data.dateFrom = from;\n\t\t\tthis.to = this.data.dateTo = to;\n\n\t\t\tthis.data.DT_LENGTH = Math.round((this.to.getTime() - this.from.getTime()) / 1000);\n\t\t\tthis.data.DURATION = this.data.DT_LENGTH;\n\n\t\t\tif (this.fullDay)\n\t\t\t{\n\t\t\t\tthis.data.DATE_FROM = Util.formatDate(this.from.getTime());\n\t\t\t\tthis.data.DATE_TO = Util.formatDate(this.to.getTime());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.data.DATE_FROM = Util.formatDateTime(this.from.getTime());\n\t\t\t\tthis.data.DATE_TO = Util.formatDateTime(this.to.getTime());\n\t\t\t}\n\t\t}\n\t}\n}\n"],"names":["EntryManager","getNewEntry","options","newEntryData","dateTime","getNewEntryTime","Date","userSettings","Util","getUserSettings","userId","getCurrentUserId","ID","NAME","getNewEntryName","dateFrom","from","dateTo","to","type","SECT_ID","RoomsManager","getNewEntrySectionId","parseInt","ownerId","SectionManager","REMIND","getNewEntryReminders","attendeesEntityList","entityId","id","ATTENDEE_LIST","status","push","TZ_FROM","timezoneName","timezoneDefaultName","TZ_TO","Entry","data","date","duration","getUsableDateTime","calendarContext","getCalendarContext","displayedViewRange","getDisplayedViewRange","Type","isDate","start","getTime","end","startDate","workTime","util","getWorkTime","setHours","newEntryName","Loc","getMessage","setNewEntryName","showEditEntryNotification","entryId","showNotification","title","events","click","event","balloon","action","openViewSlider","close","showNewEntryNotification","showDeleteEntryNotification","entry","BX","UI","Notification","Center","notify","getUniqueId","content","actions","cancelDelete","showReleaseLocationNotification","closeDeleteNotificationBalloon","getBalloonById","openEditSlider","bx","getBX","Calendar","SliderLoader","isLocationCalendar","roomsManager","locationAccess","dayOfWeekMonthFormat","locationCapacity","formDataValue","show","eventId","isNull","entryDateFrom","timezoneOffset","deleteEntry","slider","SidePanel","Instance","getTopSlider","beforeDeleteHandler","EventEmitter","subscribe","deleteHandler","calendar","reload","unsubscribe","delete","setMeetingStatus","params","Promise","resolve","isPlainObject","recursionMode","confirmed","isRecursive","showConfirmStatusDialog","ajax","runAction","entryParentId","parentId","currentDateFrom","formatDate","then","response","Event","emit","BaseEvent","counters","setCurrentStatus","resolvePromiseCallback","confirmDeclineDialog","Controls","ConfirmStatusDialog","unsubscribeAll","isFunction","getData","showConfirmEditDialog","confirmEditDialog","ConfirmEditDialog","callback","showReInviteUsersDialog","reinviteUsersDialog","ReinviteUserDialog","showConfirmedEmailDialog","confirmedEmailDialog","ConfirmedEmailDialog","showEmailLimitationDialog","limitationEmailDialog","EmailLimitationDialog","getCompactViewForm","create","compactEntryForm","CompactEventForm","openCompactViewForm","compactForm","isShown","closeCallback","showInViewMode","openCompactEditForm","showInEditMode","getEntryInstance","userIndex","entryInstance","isObject","getUserIndex","setUserIndex","handlePullChanges","checkRequestId","requestUid","handlePull","getOpenSliders","forEach","slidersMap","get","fields","PARENT_ID","command","getType","CAL_TYPE","top","IS_MEETING","MEETING_STATUS","Location","entrySectionId","SECTION_ID","sectionDisplayed","isArray","sections","find","section","loadedEntry","getView","getEntryById","getEntryUniqueId","reloadDebounce","registerDeleteTimeout","delayedActionList","unregisterDeleteTimeout","filter","item","excludeDate","doDelayedActions","requestList","length","uid","entryData","sid","RRULE","parseDate","DATE_FROM","registerEntrySlider","control","set","isObjectLike","defaultReminders","count","before","time","setNewEntryReminders","reminders","setUserSettings","DELETE_DELAY_TIMEOUT","WeakMap","constructor","FULL_DAY_LENGTH","prepareData","parts","delayTimeoutMap","Map","DT_SKIP_TIME","SKIP_TIME","fullDay","accessibility","ACCESSIBILITY","important","IMPORTANCE","private","PRIVATE_EVENT","setSectionId","name","userTimezoneOffsetFrom","userTimezoneOffsetTo","DT_LENGTH","DURATION","isString","DATE_TO","Math","round","isTask","ATTENDEES_CODES","OWNER_ID","CREATED_BY","startDayCode","endDayCode","remind","value","getAttendeesCodes","getAttendeesEntityList","getAttendees","attendeeList","user","attendee","clone","STATUS","ENTRY_ID","cleanParts","startPart","part","partIndex","registerPartNode","checkPartIsRegistered","getPart","getWrap","wrapNode","getSectionName","getDescription","DESCRIPTION","applyViewRange","viewRange","viewRangeStart","viewRangeEnd","fromTime","toTime","displayFrom","displayTo","isPersonal","isMeeting","isPrivate","isResourcebooking","EVENT_TYPE","isLocation","isFullDay","isLongWithTime","getDayCode","isExpired","hasEmailAttendees","emailAttendeesCache","undefined","i","EMAIL_USER","ownerIsEmailUser","ownerIsEmailUserCache","MEETING_HOST","isSelected","selected","isCrm","UF_CRM_CAL_EVENT","isFirstReccurentEntry","DATE_FROM_TS_UTC","floor","RECURRENCE_ID","isFirstInstance","RINDEX","getMeetingHost","getMeetingNotify","MEETING","NOTIFY","getHideGuests","isBoolean","HIDE_GUESTS","getRrule","getRRuleDescription","hasRecurrenceId","wasEverRecursive","deselect","select","deleteParts","wrap","getContainer","entries","entryPart","querySelector","style","opacity","setTimeout","display","querySelectorAll","getCurrentStatus","getMeetingStatusList","includes","getReminders","res","getLengthInDays","getFullYear","getMonth","getDate","getDayLength","getName","defaultNewName","getColor","COLOR","getOwnerId","showConfirmDeleteDialog","onCustomEvent","registerRequestId","deleteTimeout","deleteThis","deleteNext","deleteAll","untilDate","deleteTimeoutData","clearTimeout","confirmDeleteDialog","window","ConfirmDeleteDialog","save","getLocation","LOCATION","setTimezone","timezoneFrom","timezoneTo","getTimezoneFrom","getTimezoneTo","sectionId","setDateTimeValue","formatDateTime"],"mappings":"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"}