{"version":3,"file":"resourcebooking.bundle.js","sources":["../src/viewcontrolabstract.js","../src/viewdropdownselect.js","../src/controls/userselector.js","../src/controls/resourceselector.js","../src/controls/serviceselector.js","../src/controls/durationselector.js","../src/controls/dateselector.js","../src/controls/timeselector.js","../src/controls/statusinformer.js","../src/livefieldcontroller.js","../src/translit.js","../src/bookingutil.js","../src/fieldviewcontrollerabstract.js","../src/fieldviewcontrolleredit.js","../src/fieldviewcontrollerpreview.js","../src/controls/selectinput.js","../src/resourcebooking.js"],"sourcesContent":["import {Loc, Dom, Tag} from \"./resourcebooking\";\n\nexport class ViewControlAbstract\n{\n\tconstructor(params)\n\t{\n\t\tif (new.target === ViewControlAbstract)\n\t\t{\n\t\t\tthrow new TypeError(\"Cannot construct Abstract instances directly\");\n\t\t}\n\n\t\tthis.name = null;\n\t\tthis.classNames = {\n\t\t\twrap: params.wrapClassName || 'calendar-resbook-webform-block',\n\t\t\tinnerWrap: 'calendar-resbook-webform-block-inner',\n\t\t\ttitle: 'calendar-resbook-webform-block-title',\n\t\t\tfield: 'calendar-resbook-webform-block-field'\n\t\t};\n\n\t\tthis.DOM = {\n\t\t\touterWrap: params.outerWrap,\n\t\t\twrap: null,\n\t\t\tdataWrap: null,\n\t\t\tinnerWrap: null,\n\t\t\tlabelWrap: null\n\t\t};\n\t\tthis.data = params.data;\n\t\tthis.shown = false;\n\t}\n\n\tisDisplayed()\n\t{\n\t\treturn this.data.show !== 'N';\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.shown;\n\t}\n\n\tdisplay()\n\t{\n\t\tthis.DOM.wrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props : { className : this.classNames.wrap}}));\n\n\t\tthis.DOM.dataWrap = this.DOM.wrap.appendChild(Tag.render`<div data-bx-resource-data-wrap=\"Y\"></div>`);\n\n\t\tif (this.isDisplayed())\n\t\t{\n\t\t\tthis.show({animation: false});\n\t\t}\n\t}\n\n\trefresh(data)\n\t{\n\t\tthis.refreshLabel(data);\n\t\tthis.data = data;\n\n\t\tif (this.setDataConfig())\n\t\t{\n\t\t\tif (this.isDisplayed())\n\t\t\t{\n\t\t\t\tthis.show({animation: true});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hide({animation: true});\n\t\t\t}\n\t\t}\n\t\tthis.data = data;\n\t}\n\n\tsetDataConfig()\n\t{\n\t\treturn true;\n\t}\n\n\trefreshLabel(data)\n\t{\n\t\tif (this.data.label !== data.label)\n\t\t{\n\t\t\tDom.adjust(this.DOM.labelWrap, {text: data.label});\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tif (this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\n\t\tthis.DOM.innerWrap = this.DOM.wrap.appendChild(Dom.create(\"div\", {props : { className : this.classNames.innerWrap}}));\n\n\t\tif (this.data.label || this.label)\n\t\t{\n\t\t\tthis.DOM.labelWrap = this.DOM.innerWrap.appendChild(Dom.create(\"div\", {props : { className : this.classNames.title}, text: this.data.label || this.label}));\n\t\t}\n\t\tthis.DOM.controlWrap = this.DOM.innerWrap.appendChild(Dom.create(\"div\", {props : { className : this.classNames.field}}));\n\t\tthis.displayControl();\n\t\tthis.shown = true;\n\t}\n\n\thide()\n\t{\n\t\tDom.remove(this.DOM.innerWrap);\n\t\tthis.DOM.innerWrap = null;\n\t\tthis.shown = false;\n\t}\n\n\tdisplayControl()\n\t{\n\t}\n\n\tshowWarning(errorMessage)\n\t{\n\t\tif (this.shown && this.DOM.wrap && this.DOM.innerWrap)\n\t\t{\n\t\t\tDom.addClass(this.DOM.wrap, \"calendar-resbook-webform-block-error\");\n\t\t\tthis.displayErrorText(errorMessage || Loc.getMessage('WEBF_RES_BOOKING_REQUIRED_WARNING'));\n\t\t}\n\t}\n\n\thideWarning()\n\t{\n\t\tif (this.DOM.wrap)\n\t\t{\n\t\t\tDom.removeClass(this.DOM.wrap, \"calendar-resbook-webform-block-error\");\n\t\t\tif (this.DOM.errorTextWrap)\n\t\t\t{\n\t\t\t\tDom.remove(this.DOM.errorTextWrap);\n\t\t\t}\n\t\t}\n\t}\n\n\tdisplayErrorText(errorMessage)\n\t{\n\t\tif (this.DOM.errorTextWrap)\n\t\t{\n\t\t\tDom.remove(this.DOM.errorTextWrap);\n\t\t}\n\t\tthis.DOM.errorTextWrap = this.DOM.innerWrap.appendChild(Dom.create(\"span\", {props : { className : 'calendar-resbook-webform-block-error-text'}, text: errorMessage}));\n\t}\n}\n\n\n","import {Type, Loc, Dom, Event, Text, BookingUtil, MenuManager} from \"./resourcebooking\";\n\nexport class ViewDropDownSelect\n{\n\tconstructor(params)\n\t{\n\t\tthis.id = 'viewform-dropdown-select-' + Math.round(Math.random() * 100000);\n\t\tthis.DOM = {\n\t\t\twrap: params.wrap\n\t\t};\n\t\tthis.maxHeight = params.maxHeight;\n\t\tthis.selectAllMessage = Loc.getMessage('WEBF_RES_SELECT_ALL');\n\t\tthis.setSettings(params);\n\t}\n\n\tbuild()\n\t{\n\t\tthis.DOM.select = this.DOM.wrap.appendChild(Dom.create(\"div\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"calendar-resbook-webform-block-input calendar-resbook-webform-block-input-dropdown\"\n\t\t\t},\n\t\t\tevents: {click: this.openPopup.bind(this)}\n\t\t}));\n\n\t\tthis.setSelectedValues(this.selected);\n\t}\n\n\tsetSettings(params)\n\t{\n\t\tthis.handleChangesCallback = Type.isFunction(params.handleChangesCallback) ? params.handleChangesCallback : null;\n\t\tthis.values = params.values;\n\t\tthis.selected = !Type.isArray(params.selected) ? [params.selected] : params.selected;\n\t\tthis.multiple = params.multiple;\n\t}\n\n\topenPopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\treturn this.closePopup();\n\t\t}\n\n\t\tlet menuItems = [];\n\t\tthis.values.forEach(function(item)\n\t\t{\n\t\t\tlet className = 'menu-popup-no-icon';\n\t\t\tif (Type.isArray(this.selected) && this.selected.includes(parseInt(item.id)))\n\t\t\t{\n\t\t\t\tclassName += ' menu-item-selected';\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\tid: item.id,\n\t\t\t\tclassName: className,\n\t\t\t\ttext: Text.encode(item.title),\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t});\n\t\t}, this);\n\n\t\tif (this.multiple && menuItems.length <= 1)\n\t\t{\n\t\t\tthis.multiple = false;\n\t\t}\n\n\t\tif (this.multiple)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\tid: 'select-all',\n\t\t\t\ttext: this.selectAllMessage,\n\t\t\t\tonclick: this.selectAllItemClick.bind(this)\n\t\t\t});\n\t\t}\n\n\t\tthis.popup = MenuManager.create(\n\t\t\tthis.id,\n\t\t\tthis.DOM.select,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tclassName: 'calendar-resbook-form-popup' + (this.multiple ? ' popup-window-resource-select' : ''),\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : !this.multiple,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.show(true);\n\t\tthis.popupContainer = this.popup.popupWindow.popupContainer;\n\t\tthis.popupContainer.style.width = parseInt(this.DOM.select.offsetWidth) + 'px';\n\n\t\tif (this.multiple)\n\t\t{\n\t\t\tthis.popup.menuItems.forEach(function(menuItem)\n\t\t\t{\n\t\t\t\tlet checked;\n\t\t\t\tif (menuItem.id === 'select-all')\n\t\t\t\t{\n\t\t\t\t\tthis.selectAllChecked = !this.values.find(function(value){\n\t\t\t\t\t\treturn !this.selected.find(function(itemId){return itemId === value.id});\n\t\t\t\t\t},this);\n\n\t\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item menu-popup-item-resource-all';\n\t\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox menu-popup-item-all-resources-checkbox\" type=\"checkbox\"' + (this.selectAllChecked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + menuItem.text + '</label>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tchecked = this.selected.find(function(itemId){return itemId === menuItem.id});\n\n\t\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item';\n\t\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox\" type=\"checkbox\"' + (checked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + menuItem.text + '</label>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tEvent.unbind(document, 'click', this.handleClick.bind(this));\n\t\t\tsetTimeout(function(){\n\t\t\t\tEvent.bind(document, 'click', this.handleClick.bind(this));\n\t\t\t}.bind(this), 50);\n\t\t}\n\t}\n\n\tclosePopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t\tif (this.multiple)\n\t\t\t{\n\t\t\t\tEvent.unbind(document, 'click', this.handleClick.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\n\tisPopupShown()\n\t{\n\t\treturn this.popup && this.popup.popupWindow &&\n\t\t\tthis.popup.popupWindow.isShown && this.popup.popupWindow.isShown() &&\n\t\t\tthis.popup.popupWindow.popupContainer &&\n\t\t\tDom.isShown(this.popup.popupWindow.popupContainer);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet\n\t\t\tselectAllcheckbox,\n\t\t\ttarget = e.target || e.srcElement,\n\t\t\tfoundValue, checkbox;\n\n\n\t\tif (this.multiple)\n\t\t{\n\t\t\tfoundValue = this.values.find(function(value){return value.id == menuItem.id;});\n\t\t\tcheckbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox');\n\n\t\t\tif (foundValue && target && (Dom.hasClass(target, \"menu-popup-item\") || Dom.hasClass(target, \"menu-popup-item-resource-checkbox\") || Dom.hasClass(target, \"menu-popup-item-inner\")))\n\t\t\t{\n\t\t\t\tif (!Dom.hasClass(target, \"menu-popup-item-resource-checkbox\"))\n\t\t\t\t{\n\t\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t\t}\n\n\t\t\t\tif (checkbox.checked)\n\t\t\t\t{\n\t\t\t\t\tthis.selectItem(foundValue);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.deselectItem(foundValue);\n\t\t\t\t\tselectAllcheckbox = this.popupContainer.querySelector('.menu-popup-item-all-resources-checkbox');\n\t\t\t\t\tthis.selectAllChecked = false;\n\t\t\t\t\tif (selectAllcheckbox)\n\t\t\t\t\t{\n\t\t\t\t\t\tselectAllcheckbox.checked = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.setSelectedValues(this.selected);\n\t\t\t\tthis.handleControlChanges();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.setSelectedValues([menuItem.id]);\n\t\t\tthis.handleControlChanges();\n\t\t\tthis.closePopup();\n\t\t}\n\t}\n\n\tselectItem(value)\n\t{\n\t\tif (!this.selected.includes(value.id))\n\t\t{\n\t\t\tthis.selected.push(value.id);\n\t\t}\n\t}\n\n\tdeselectItem(value)\n\t{\n\t\tlet index = this.selected.indexOf(parseInt(value.id));\n\t\tif (index >= 0)\n\t\t{\n\t\t\tthis.selected = this.selected.slice(0, index).concat(this.selected.slice(index + 1));\n\t\t}\n\t}\n\n\tselectAllItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (target && (Dom.hasClass(target, \"menu-popup-item\") || Dom.hasClass(target, \"menu-popup-item-resource-checkbox\")))\n\t\t{\n\t\t\tlet checkbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox');\n\n\t\t\tif (Dom.hasClass(target, \"menu-popup-item\"))\n\t\t\t{\n\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t}\n\n\t\t\tlet i, checkboxes = this.popupContainer.querySelectorAll('input.menu-popup-item-resource-checkbox');\n\t\t\tthis.selectAllChecked = checkbox.checked;\n\n\t\t\tfor (i = 0; i < checkboxes.length; i++)\n\t\t\t{\n\t\t\t\tcheckboxes[i].checked = this.selectAllChecked;\n\t\t\t}\n\t\t\tthis.selected = [];\n\t\t\tif (this.selectAllChecked)\n\t\t\t{\n\t\t\t\tthis.values.forEach(function(value){this.selected.push(value.id);}, this);\n\t\t\t}\n\t\t\tthis.setSelectedValues(this.selected);\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\thandleClick(e)\n\t{\n\t\tif (this.isPopupShown() && !this.popupContainer.contains(e.target || e.srcElement))\n\t\t{\n\t\t\tthis.closePopup({animation: true});\n\t\t}\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\treturn this.selected;\n\t}\n\n\tsetSelectedValues(values)\n\t{\n\t\tlet i,\n\t\t\tfoundValue,\n\t\t\ttextValues = [],\n\t\t\tselectedValues = [];\n\n\t\tfor (i = 0; i < values.length; i++)\n\t\t{\n\t\t\tfoundValue = this.values.find(function(value){return value.id === values[i];});\n\t\t\tif (foundValue)\n\t\t\t{\n\t\t\t\ttextValues.push(foundValue.title);\n\t\t\t\tselectedValues.push(foundValue.id);\n\t\t\t}\n\t\t}\n\n\t\tthis.selected = selectedValues;\n\t\tDom.adjust(this.DOM.select, {text: textValues.length ? textValues.join(', ') : Loc.getMessage('USER_TYPE_RESOURCE_LIST_PLACEHOLDER')});\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tif (this.handleChangesCallback)\n\t\t{\n\t\t\tthis.handleChangesCallback(this.getSelectedValues());\n\t\t}\n\t}\n}\n","import {Type} from \"../resourcebooking\";\nimport {ViewControlAbstract} from \"../viewcontrolabstract\";\nimport {ViewDropDownSelect} from \"../viewdropdownselect\";\n\nexport class UserSelector extends ViewControlAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.name = 'UserSelector';\n\t\tthis.data = params.data || {};\n\t\tthis.userList = [];\n\t\tthis.userIndex = {};\n\n\t\tthis.values = [];\n\t\tthis.defaultMode = 'auto';\n\t\tthis.previewMode = params.previewMode === undefined;\n\t\tthis.autoSelectDefaultValue = params.autoSelectDefaultValue;\n\t\tthis.changeValueCallback = params.changeValueCallback;\n\n\t\tthis.handleSettingsData(this.data, params.userIndex);\n\t}\n\n\tdisplayControl()\n\t{\n\t\tthis.selectedValue = this.getSelectedUser();\n\t\tthis.dropdownSelect = new ViewDropDownSelect({\n\t\t\twrap: this.DOM.controlWrap,\n\t\t\tvalues: this.userList,\n\t\t\tselected: this.selectedValue,\n\t\t\thandleChangesCallback: this.handleChanges.bind(this)\n\t\t});\n\t\tthis.dropdownSelect.build();\n\t}\n\n\trefresh(data, userIndex)\n\t{\n\t\tthis.refreshLabel(data);\n\t\tthis.data = data;\n\t\tthis.handleSettingsData(this.data, userIndex);\n\t\tthis.selectedValue = this.getSelectedUser();\n\n\t\tif (this.dropdownSelect)\n\t\t{\n\t\t\tthis.dropdownSelect.setSettings({\n\t\t\t\tvalues: this.userList,\n\t\t\t\tselected: this.selectedValue\n\t\t\t});\n\t\t}\n\n\t\tif (this.setDataConfig())\n\t\t{\n\t\t\tif (this.isDisplayed())\n\t\t\t{\n\t\t\t\tthis.show({animation: true});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hide({animation: true});\n\t\t\t}\n\t\t}\n\t}\n\n\thandleSettingsData(data, userIndex)\n\t{\n\t\tif (Type.isPlainObject(userIndex))\n\t\t{\n\t\t\tfor (let id in userIndex)\n\t\t\t{\n\t\t\t\tif (userIndex.hasOwnProperty(id))\n\t\t\t\t{\n\t\t\t\t\tthis.userIndex[id] = userIndex[id];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.defaultMode = this.data.defaultMode === 'none' ? 'none' : 'auto';\n\t\tlet dataValue = [];\n\t\tthis.userList = [];\n\t\tif (this.data.value)\n\t\t{\n\t\t\tlet dataValueRaw = Type.isArray(this.data.value) ? this.data.value : this.data.value.split('|');\n\t\t\tdataValueRaw.forEach(function(id)\n\t\t\t{\n\t\t\t\tid = parseInt(id);\n\t\t\t\tif (id > 0)\n\t\t\t\t{\n\t\t\t\t\tdataValue.push(id);\n\t\t\t\t\tif (this.userIndex[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userList.push({\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\ttitle: this.userIndex[id].displayName\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\t\tthis.values = dataValue;\n\t}\n\n\tgetSelectedUser()\n\t{\n\t\tlet selected = null;\n\t\tif (this.dropdownSelect)\n\t\t{\n\t\t\tselected = this.dropdownSelect.getSelectedValues();\n\t\t\tselected = (Type.isArray(selected) && selected.length) ? selected[0] : null;\n\t\t}\n\n\t\tif (!selected && this.previewMode\n\t\t\t&& this.data.defaultMode === 'auto'\n\t\t\t&& this.userList && this.userList[0])\n\t\t{\n\t\t\tselected = this.userList[0].id;\n\t\t}\n\n\t\tif (!selected && this.autoSelectDefaultValue)\n\t\t{\n\t\t\tselected = this.autoSelectDefaultValue;\n\t\t}\n\n\t\treturn selected;\n\t}\n\n\tsetSelectedUser(userId)\n\t{\n\t\tif (this.dropdownSelect)\n\t\t{\n\t\t\tthis.dropdownSelect.setSelectedValues([userId]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.autoSelectDefaultValue = parseInt(userId);\n\t\t}\n\t}\n\n\thandleChanges(selectedValues)\n\t{\n\t\tif (!this.previewMode && Type.isFunction(this.changeValueCallback))\n\t\t{\n\t\t\tthis.changeValueCallback(selectedValues[0] || null);\n\t\t}\n\t}\n}","import {Type} from \"../resourcebooking\";\nimport {ViewControlAbstract} from \"../viewcontrolabstract\";\nimport {ViewDropDownSelect} from \"../viewdropdownselect\";\n\nexport class ResourceSelector extends ViewControlAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'ResourceSelector';\n\t\tthis.data = params.data;\n\t\tthis.allResourceList = params.resourceList;\n\t\tthis.autoSelectDefaultValue = params.autoSelectDefaultValue;\n\t\tthis.changeValueCallback = params.changeValueCallback;\n\t\tthis.handleSettingsData(params.data);\n\t}\n\n\thandleSettingsData(data)\n\t{\n\t\tif (!Type.isArray(data.value))\n\t\t{\n\t\t\tlet dataValue = [];\n\t\t\tif (data.value)\n\t\t\t{\n\t\t\t\tdata.value.split('|').forEach(function(id)\n\t\t\t\t{\n\t\t\t\t\tif (parseInt(id) > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdataValue.push(parseInt(id))\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.data.value = dataValue;\n\t\t}\n\n\t\tthis.resourceList = [];\n\t\tif (Type.isArray(this.allResourceList) && Type.isArray(this.data.value))\n\t\t{\n\t\t\tthis.allResourceList.forEach(function(item)\n\t\t\t{\n\t\t\t\tif (this.data.value.includes(parseInt(item.id)))\n\t\t\t\t{\n\t\t\t\t\tthis.resourceList.push(item);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.setSelectedValues(this.getSelectedValues());\n\t}\n\n\tdisplayControl()\n\t{\n\t\tthis.dropdownSelect = new ViewDropDownSelect({\n\t\t\twrap: this.DOM.controlWrap,\n\t\t\tvalues: this.resourceList,\n\t\t\tselected: this.selectedValues,\n\t\t\tmultiple: this.data.multiple === 'Y',\n\t\t\thandleChangesCallback: this.changeValueCallback\n\t\t});\n\t\tthis.dropdownSelect.build();\n\t}\n\n\trefresh(data)\n\t{\n\t\tthis.refreshLabel(data);\n\t\tthis.data = data;\n\t\tthis.handleSettingsData(this.data);\n\t\tthis.setSelectedValues(this.getSelectedValues());\n\n\t\tif (this.dropdownSelect)\n\t\t{\n\t\t\tthis.dropdownSelect.setSettings({\n\t\t\t\tvalues: this.resourceList,\n\t\t\t\tselected: this.selectedValues,\n\t\t\t\tmultiple: this.data.multiple === 'Y'\n\t\t\t});\n\t\t}\n\n\t\tif (this.setDataConfig())\n\t\t{\n\t\t\tif (this.isDisplayed())\n\t\t\t{\n\t\t\t\tthis.show({animation: true});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hide({animation: true});\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\tlet selected = null;\n\n\t\tif (this.dropdownSelect)\n\t\t{\n\t\t\tselected = this.dropdownSelect.getSelectedValues();\n\t\t}\n\n\t\tif (!selected && this.autoSelectDefaultValue)\n\t\t{\n\t\t\tselected = [this.autoSelectDefaultValue];\n\t\t}\n\n\t\tif (!selected && this.data.defaultMode === 'auto')\n\t\t{\n\t\t\tif (this.resourceList && this.resourceList[0])\n\t\t\t{\n\t\t\t\tselected = [this.resourceList[0].id];\n\t\t\t}\n\t\t}\n\n\t\treturn selected;\n\t}\n\n\tsetSelectedValues(selectedValues)\n\t{\n\t\tthis.selectedValues = selectedValues;\n\t}\n\n\tsetSelectedResource(id)\n\t{\n\t\tif (this.dropdownSelect)\n\t\t{\n\t\t\tthis.dropdownSelect.setSelectedValues([id]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.autoSelectDefaultValue = parseInt(id);\n\t\t\tthis.selectedValues = [id];\n\t\t}\n\t}\n}","import {Type, BookingUtil} from \"../resourcebooking\";\nimport {ViewControlAbstract} from \"../viewcontrolabstract\";\nimport {ViewDropDownSelect} from \"../viewdropdownselect\";\n\nexport class ServiceSelector extends ViewControlAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'ServiceSelector';\n\t\tthis.data = params.data;\n\t\tthis.serviceList = [];\n\t\tthis.allServiceList = params.serviceList || [];\n\t\tthis.values = [];\n\t\tthis.changeValueCallback = Type.isFunction(params.changeValueCallback) ? params.changeValueCallback : null;\n\t\tif (params.selectedValue)\n\t\t{\n\t\t\tthis.setSelectedService(params.selectedValue);\n\t\t}\n\t\tthis.handleSettingsData(this.data);\n\t}\n\n\tdisplayControl()\n\t{\n\t\tthis.dropdownSelect = new ViewDropDownSelect({\n\t\t\twrap: this.DOM.controlWrap,\n\t\t\tvalues: this.serviceList,\n\t\t\tselected: this.getSelectedService(),\n\t\t\thandleChangesCallback: function (selectedValues)\n\t\t\t{\n\t\t\t\tif (selectedValues && selectedValues[0])\n\t\t\t\t{\n\t\t\t\t\tthis.setSelectedService(selectedValues[0]);\n\t\t\t\t\tif (this.changeValueCallback)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.changeValueCallback();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}.bind(this)\n\t\t});\n\t\tthis.dropdownSelect.build();\n\t}\n\n\trefresh(data)\n\t{\n\t\tthis.refreshLabel(data);\n\t\tthis.data = data;\n\n\t\tthis.handleSettingsData(this.data);\n\n\t\tif (this.dropdownSelect)\n\t\t{\n\t\t\tthis.dropdownSelect.setSettings({\n\t\t\t\tvalues: this.serviceList,\n\t\t\t\tselected: this.getSelectedService()\n\t\t\t});\n\t\t}\n\n\t\tif (this.setDataConfig())\n\t\t{\n\t\t\tif (this.isDisplayed())\n\t\t\t{\n\t\t\t\tthis.show({animation: true});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hide({animation: true});\n\t\t\t}\n\t\t}\n\t}\n\n\thandleSettingsData()\n\t{\n\t\tthis.serviceIndex = {};\n\t\tif (Type.isArray(this.allServiceList))\n\t\t{\n\t\t\tthis.allServiceList.forEach(function(service)\n\t\t\t{\n\t\t\t\tif (Type.isPlainObject(service)\n\t\t\t\t\t&& Type.isString(service.name)\n\t\t\t\t\t&& service.name.trim() !== '')\n\t\t\t\t{\n\t\t\t\t\tthis.serviceIndex[this.prepareServiceId(service.name)] = service;\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.serviceList = [];\n\t\tif (this.data.value)\n\t\t{\n\t\t\tlet dataValueRaw = Type.isArray(this.data.value) ? this.data.value : this.data.value.split('|');\n\t\t\tdataValueRaw.forEach(function(id)\n\t\t\t{\n\t\t\t\tlet service = this.serviceIndex[this.prepareServiceId(id)];\n\t\t\t\tif (Type.isPlainObject(service)\n\t\t\t\t\t&& Type.isString(service.name)\n\t\t\t\t\t&& service.name.trim() !== '')\n\t\t\t\t{\n\t\t\t\t\tthis.serviceList.push({\n\t\t\t\t\t\tid: this.prepareServiceId(service.name),\n\t\t\t\t\t\ttitle: service.name + ' - ' + BookingUtil.getDurationLabel(service.duration)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\t}\n\n\tsetSelectedService(serviceName)\n\t{\n\t\tthis.selectedService = serviceName;\n\t}\n\n\tgetSelectedService(getMeta)\n\t{\n\t\treturn getMeta !== true ? (this.selectedService || null) : (this.serviceIndex[this.prepareServiceId(this.selectedService)] || null);\n\t}\n\n\tprepareServiceId(str)\n\t{\n\t\treturn BookingUtil.translit(str);\n\t}\n}\n","import {Type, Dom, BookingUtil, SelectInput} from \"../resourcebooking\";\nimport {ViewControlAbstract} from \"../viewcontrolabstract\";\n\nexport class DurationSelector extends ViewControlAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'DurationSelector';\n\t\tthis.data = params.data;\n\t\tthis.durationList = BookingUtil.getDurationList(params.fullDay);\n\t\tthis.changeValueCallback = params.changeValueCallback;\n\t\tthis.defaultValue = params.defaultValue || this.data.defaultValue;\n\t\tthis.handleSettingsData(params.data);\n\t}\n\n\thandleSettingsData()\n\t{\n\t\tthis.durationItems = [];\n\t\tif (Type.isArray(this.durationList))\n\t\t{\n\t\t\tthis.durationList.forEach(function(item)\n\t\t\t{\n\t\t\t\tthis.durationItems.push({\n\t\t\t\t\tid: item.value,\n\t\t\t\t\ttitle: item.label\n\t\t\t\t});\n\t\t\t}, this);\n\t\t}\n\t}\n\n\tdisplayControl()\n\t{\n\t\tthis.DOM.durationInput = this.DOM.controlWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs: {\n\t\t\t\tvalue: this.data.defaultValue || null,\n\t\t\t\ttype: 'text'\n\t\t\t},\n\t\t\tprops: {className: 'calendar-resbook-webform-block-input calendar-resbook-webform-block-input-dropdown'}\n\t\t}));\n\n\t\tthis.durationControl = new SelectInput({\n\t\t\tinput: this.DOM.durationInput,\n\t\t\tvalues: this.durationList,\n\t\t\tvalue: this.data.defaultValue || null,\n\t\t\teditable: this.data.manualInput === 'Y',\n\t\t\tdefaultValue: this.defaultValue,\n\t\t\tsetFirstIfNotFound: true,\n\t\t\tonChangeCallback: this.changeValueCallback\n\t\t});\n\t}\n\n\trefresh(data)\n\t{\n\t\tthis.refreshLabel(data);\n\t\tthis.data = data;\n\t\tthis.handleSettingsData(this.data);\n\n\t\tif (this.setDataConfig())\n\t\t{\n\t\t\tif (this.isDisplayed())\n\t\t\t{\n\t\t\t\tthis.show({animation: true});\n\t\t\t\tif (this.durationControl)\n\t\t\t\t{\n\t\t\t\t\tthis.durationControl.setValue(this.data.defaultValue || null);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hide({animation: true});\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSelectedValue()\n\t{\n\t\tlet duration = null;\n\t\tif (this.durationControl)\n\t\t{\n\t\t\tduration = BookingUtil.parseDuration(this.durationControl.getValue());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tduration = parseInt(this.defaultValue);\n\t\t}\n\t\treturn duration;\n\t}\n}","import {Type, Loc, Dom, Event, Tag, Browser, BookingUtil} from \"../resourcebooking\";\nimport {ViewControlAbstract} from \"../viewcontrolabstract\";\n\nexport class DateSelector extends ViewControlAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.DOM = {\n\t\t\touterWrap: params.outerWrap,\n\t\t\twrap: null\n\t\t};\n\t\tthis.data = params.data || {};\n\t\tthis.changeValueCallback = params.changeValueCallback;\n\t\tthis.requestDataCallback = params.requestDataCallback;\n\t\tthis.previewMode = params.previewMode === undefined;\n\t\tthis.allowOverbooking = params.allowOverbooking;\n\t\tthis.setDataConfig();\n\t\tthis.displayed = true;\n\t}\n\n\tdisplay(params)\n\t{\n\t\tparams = params || {};\n\t\tthis.setDateIndex(params.availableDateIndex);\n\t\tthis.setCurrentDate(params.selectedValue);\n\n\t\tthis.DOM.wrap = this.DOM.outerWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block\"></div>`);\n\n\t\tthis.DOM.innerWrap = this.DOM.wrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-inner\"></div>`);\n\t\tif (this.data.label)\n\t\t{\n\t\t\tthis.DOM.labelWrap = this.DOM.innerWrap.appendChild(Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-block-title'}, text: this.data.label + '*'}));\n\t\t}\n\t\tthis.displayControl();\n\t\tthis.shown = true;\n\t}\n\n\trefresh(data, params)\n\t{\n\t\tparams = params || {};\n\t\tthis.setDateIndex(params.availableDateIndex);\n\t\tthis.setCurrentDate(params.selectedValue);\n\n\t\tthis.data = data;\n\t\tDom.adjust(this.DOM.labelWrap, {text: this.data.label + '*'});\n\n\t\tif (this.setDataConfig())\n\t\t{\n\t\t\tDom.remove(this.DOM.controlWrap);\n\t\t\tthis.displayControl();\n\t\t}\n\n\t\tif (this.style === 'line')\n\t\t{\n\t\t\tthis.lineDateControl.refreshDateAvailability();\n\t\t}\n\t}\n\n\tsetDataConfig()\n\t{\n\t\tlet\n\t\t\tstyle = this.data.style === 'line' ? 'line' : 'popup', // line|popup\n\t\t\tstart = this.data.start === 'today' ? 'today' : 'free',\n\t\t\tconfigWasChanged = this.style !== style || this.start !== start;\n\n\t\tthis.style = style;\n\t\tthis.start = start;\n\n\t\treturn configWasChanged;\n\t}\n\n\thide()\n\t{\n\t\tDom.remove(this.DOM.innerWrap);\n\t\tthis.DOM.innerWrap = null;\n\t}\n\n\tdisplayControl()\n\t{\n\t\tthis.DOM.controlWrap = this.DOM.innerWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-date\"></div>`);\n\n\t\tif (this.style === 'popup')\n\t\t{\n\t\t\tthis.DOM.controlWrap.className = 'calendar-resbook-webform-block-calendar';\n\t\t\tthis.popupSateControl = new PopupDateSelector(\n\t\t\t\t{\n\t\t\t\t\twrap: this.DOM.controlWrap,\n\t\t\t\t\tisDateAvailable: this.isDateAvailable.bind(this),\n\t\t\t\t\tonChange: function(value)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onChange(value);\n\t\t\t\t\t}.bind(this)\n\t\t\t\t});\n\t\t\tthis.popupSateControl.build();\n\t\t\tthis.popupSateControl.setValue(this.getValue());\n\t\t}\n\t\telse if (this.style === 'line')\n\t\t{\n\t\t\tthis.DOM.controlWrap.className = 'calendar-resbook-webform-block-date';\n\t\t\tthis.lineDateControl = new LineDateSelector(\n\t\t\t\t{\n\t\t\t\t\twrap: this.DOM.controlWrap,\n\t\t\t\t\tisDateAvailable: this.isDateAvailable.bind(this),\n\t\t\t\t\tonChange: this.onChange.bind(this)\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis.lineDateControl.build();\n\t\t\tthis.lineDateControl.setValue(this.getValue());\n\t\t}\n\t}\n\n\tsetCurrentDate(date)\n\t{\n\t\tif (Type.isDate(date))\n\t\t{\n\t\t\tthis.currentDate = date;\n\t\t}\n\t}\n\n\tsetDateIndex(availableDateIndex)\n\t{\n\t\tif (Type.isPlainObject(availableDateIndex))\n\t\t{\n\t\t\tthis.availableDateIndex = availableDateIndex;\n\t\t}\n\t}\n\n\tisDateLoaded(date)\n\t{\n\t\tif (Type.isDate(date) && !this.isItPastDate(date) && this.availableDateIndex)\n\t\t{\n\t\t\tif (this.availableDateIndex[BookingUtil.formatDate(null, date)] !== undefined)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (Type.isFunction(this.requestDataCallback))\n\t\t\t{\n\t\t\t\tthis.requestDataCallback({date: date});\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tisDateAvailable(date)\n\t{\n\t\tif (this.previewMode || this.allowOverbooking)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (Type.isDate(date) && !this.isItPastDate(date) && this.availableDateIndex)\n\t\t{\n\t\t\tlet dateKey = BookingUtil.formatDate(null, date);\n\t\t\tif (this.availableDateIndex[dateKey] === undefined)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(this.requestDataCallback))\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataCallback({date: date});\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.availableDateIndex[dateKey];\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tisItPastDate(date)\n\t{\n\t\tif (Type.isDate(date))\n\t\t{\n\t\t\tlet\n\t\t\t\tnowDate = new Date(),\n\t\t\t\tcheckDate = new Date(date.getTime());\n\n\t\t\tnowDate.setHours(0, 0, 0, 0);\n\t\t\tcheckDate.setHours(0, 0, 0, 0);\n\n\t\t\treturn checkDate.getTime() < nowDate.getTime();\n\t\t}\n\t\treturn false;\n\t}\n\n\trefreshCurrentValue()\n\t{\n\t\tthis.onChange(this.getDisplayedValue());\n\t}\n\n\tgetDisplayedValue()\n\t{\n\t\treturn this.style === 'popup' ? this.popupSateControl.getValue() : this.lineDateControl.getValue();;\n\t}\n\n\tonChange(date)\n\t{\n\t\tif (Type.isFunction(this.changeValueCallback))\n\t\t{\n\t\t\tlet realDate = date;\n\t\t\tif (!Type.isDate(realDate))\n\t\t\t{\n\t\t\t\trealDate = this.getDisplayedValue();\n\t\t\t}\n\t\t\tthis.setCurrentDate(date);\n\t\t\tthis.changeValueCallback(date, realDate, this.isDateAvailable(realDate));\n\t\t}\n\t}\n\n\tgetValue()\n\t{\n\t\tif (!this.currentDate)\n\t\t{\n\t\t\tthis.currentDate = new Date();\n\t\t}\n\t\treturn this.currentDate;\n\t}\n}\n\n\nclass PopupDateSelector\n{\n\tstatic externalDatePickerIsEnabled = null;\n\n\tconstructor(params)\n\t{\n\t\tthis.DOM = {\n\t\t\touterWrap: params.wrap,\n\t\t\twrap: null\n\t\t};\n\t\tthis.value = null;\n\t\tthis.datePicker = null;\n\t\tthis.isDateAvailable = Type.isFunction(params.isDateAvailable) ? params.isDateAvailable : function(){return true};\n\t\tthis.onChange = Type.isFunction(params.onChange) ? params.onChange : function(){};\n\t}\n\n\tbuild()\n\t{\n\t\tthis.DOM.wrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops : { className : 'calendar-resbook-webform-block-strip'},\n\t\t\tevents: {click: this.handleClick.bind(this)}\n\t\t}));\n\n\t\tthis.DOM.valueInput = this.DOM.wrap.appendChild(Tag.render`<input type=\"hidden\" \nvalue=\"\"/>`);\n\n\t\tthis.DOM.previousArrow = this.DOM.wrap.appendChild(Tag.render`<span class=\"calendar-resbook-webform-block-strip-arrow calendar-resbook-webform-block-strip-arrow-prev\" data-bx-resbook-date-meta=\"previous\"/>`);\n\n\t\tthis.DOM.stateWrap = this.DOM.wrap.appendChild(Tag.render`<span class=\"calendar-resbook-webform-block-strip-text\" data-bx-resbook-date-meta=\"calendar\"/>`);\n\n\t\tthis.DOM.stateWrapDate = this.DOM.stateWrap.appendChild(Tag.render`<span class=\"calendar-resbook-webform-block-strip-date\"/>`);\n\t\tthis.DOM.stateWrapDay = this.DOM.stateWrap.appendChild(Tag.render`<span class=\"calendar-resbook-webform-block-strip-day\"/>`);\n\n\t\tthis.DOM.nextArrow = this.DOM.wrap.appendChild(Tag.render`<span class=\"calendar-resbook-webform-block-strip-arrow calendar-resbook-webform-block-strip-arrow-next\" data-bx-resbook-date-meta=\"next\"/>`);\n\t}\n\n\tgetValue()\n\t{\n\t\treturn this.value;\n\t}\n\n\tsetValue(dateValue)\n\t{\n\t\tthis.value = dateValue;\n\t\tDom.adjust(this.DOM.stateWrapDate, {text: BookingUtil.formatDate(Loc.getMessage('WEBF_RES_DATE_FORMAT_DATE_LINE'), dateValue)});\n\t\tDom.adjust(this.DOM.stateWrapDay, {text: BookingUtil.formatDate(Loc.getMessage('WEBF_RES_DATE_FORMAT_DAY_LINE'), dateValue)});\n\n\t\tif (!this.isDateAvailable(dateValue) || !Type.isDate(dateValue))\n\t\t{\n\t\t\tthis.onChange(false);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.onChange(this.value);\n\t\t}\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet\n\t\t\tdateValue,\n\t\t\ttarget = e.target || e.srcElement;\n\n\t\tif (target.hasAttribute('data-bx-resbook-date-meta') ||\n\t\t\t(target = target.closest('[data-bx-resbook-date-meta]')))\n\t\t{\n\t\t\tlet dateMeta = target.getAttribute('data-bx-resbook-date-meta');\n\t\t\tif (dateMeta === 'previous')\n\t\t\t{\n\t\t\t\tdateValue = this.getValue();\n\t\t\t\tdateValue.setDate(dateValue.getDate() - 1);\n\t\t\t\tthis.setValue(dateValue);\n\t\t\t}\n\t\t\telse if (dateMeta === 'next')\n\t\t\t{\n\t\t\t\tdateValue = this.getValue();\n\t\t\t\tdateValue.setDate(dateValue.getDate() + 1);\n\t\t\t\tthis.setValue(dateValue);\n\t\t\t}\n\t\t\telse if (dateMeta === 'calendar')\n\t\t\t{\n\t\t\t\tthis.openCalendarPopup();\n\t\t\t}\n\t\t}\n\t}\n\n\topenCalendarPopup()\n\t{\n\t\tthis.DOM.valueInput.value = BookingUtil.formatDate(null, this.getValue().getTime() / 1000);\n\n\t\tif (PopupDateSelector.isExternalDatePickerEnabled())\n\t\t{\n\t\t\tthis.openExternalDatePicker();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.openBxCalendar();\n\t\t}\n\t}\n\n\topenBxCalendar()\n\t{\n\t\tBX.calendar({node: this.DOM.stateWrap, field: this.DOM.valueInput, bTime: false});\n\t\tif (BX.calendar.get().popup)\n\t\t{\n\t\t\tBookingUtil.unbindCustomEvent(BX.calendar.get().popup, 'onPopupClose', this.handleCalendarClose.bind(this));\n\t\t\tBookingUtil.bindCustomEvent(BX.calendar.get().popup, 'onPopupClose', this.handleCalendarClose.bind(this));\n\t\t}\n\t}\n\n\thandleCalendarClose()\n\t{\n\t\tthis.setValue(BookingUtil.parseDate(this.DOM.valueInput.value));\n\t}\n\n\tstatic isExternalDatePickerEnabled()\n\t{\n\t\tif (Type.isNull(PopupDateSelector.externalDatePickerIsEnabled))\n\t\t{\n\t\t\tPopupDateSelector.externalDatePickerIsEnabled = !!(window.BX && BX.UI && BX.UI.Vue && BX.UI.Vue.Components && BX.UI.Vue.Components.DatePick);\n\t\t}\n\n\t\treturn PopupDateSelector.externalDatePickerIsEnabled;\n\t}\n\n\topenExternalDatePicker()\n\t{\n\t\tif (Type.isNull(this.datePicker))\n\t\t{\n\t\t\tthis.datePicker = new BX.UI.Vue.Components.DatePick(\n\t\t\t\t{\n\t\t\t\t\tnode: this.DOM.stateWrap,\n\t\t\t\t\thasTime: false,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tchange: function(value){\n\t\t\t\t\t\t\tthis.DOM.valueInput.value = value;\n\t\t\t\t\t\t\tthis.handleCalendarClose();\n\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis.datePicker.value = this.DOM.valueInput.value;\n\t\tthis.datePicker.toggle();\n\t}\n}\n\n\n\nclass LineDateSelector\n{\n\tconstructor(params)\n\t{\n\t\tparams = params || {};\n\t\tthis.DOM = {\n\t\t\touterWrap: params.wrap,\n\t\t\twrap: null\n\t\t};\n\t\tthis.value = null;\n\t\tthis.isDateAvailable = Type.isFunction(params.isDateAvailable) ? params.isDateAvailable : function(){return true};\n\t\tthis.onChange = Type.isFunction(params.onChange) ? params.onChange : function(){};\n\t\tthis.DAYS_DISPLAY_SIZE = 30;\n\t\tthis.DOM.dayNodes = {};\n\t\tthis.dayNodeIndex = {};\n\t}\n\n\tbuild()\n\t{\n\t\tthis.DOM.monthTitle = this.DOM.outerWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops : { className : 'calendar-resbook-webform-block-date-month'}\n\t\t}));\n\n\t\tthis.DOM.wrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops : { className : 'calendar-resbook-webform-block-date-range'},\n\t\t\tevents: {click: this.handleClick.bind(this)}\n\t\t}));\n\n\t\tthis.DOM.controlStaticWrap = this.DOM.wrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-date-range-static-wrap\" \n></div>`);\n\t\tthis.DOM.controlInnerWrap = this.DOM.controlStaticWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-date-range-inner-wrap\" \n></div>`);\n\t\tthis.DOM.valueInput = this.DOM.wrap.appendChild(Tag.render`<input type=\"hidden\" \nvalue=\"\"/>`);\n\n\t\tthis.fillDays();\n\t\tthis.initCustomScroll();\n\t}\n\n\tfillDays()\n\t{\n\t\tlet\n\t\t\ti,\n\t\t\tstartDate = this.getStartLoadDate(),\n\t\t\tdate = new Date(startDate.getTime());\n\n\t\tfor (i = 0; i < this.DAYS_DISPLAY_SIZE; i++)\n\t\t{\n\t\t\tthis.addDateSlot(date);\n\t\t\tdate.setDate(date.getDate() + 1);\n\t\t}\n\n\t\tthis.innerWidth = parseInt(this.DOM.controlInnerWrap.offsetWidth);\n\t}\n\n\taddDateSlot(date)\n\t{\n\t\tlet dateCode = BookingUtil.formatDate('Y-m-d', date.getTime() / 1000);\n\t\tthis.dayNodeIndex[dateCode] = new Date(date.getTime());\n\t\tthis.DOM.dayNodes[dateCode] = this.DOM.controlInnerWrap.appendChild(Dom.create(\"div\", {\n\t\t\tattrs : {\n\t\t\t\tclassName : 'calendar-resbook-webform-block-date-item' + (this.isDateAvailable(date) ? '' : ' calendar-resbook-webform-block-date-item-off'),\n\t\t\t\t'data-bx-resbook-date-meta' : dateCode\n\t\t\t},\n\t\t\thtml: '<div class=\"calendar-resbook-webform-block-date-item-inner\">' +\n\t\t\t\t'<span class=\"calendar-resbook-webform-block-date-number\">' +\n\t\t\t\tBookingUtil.formatDate(Loc.getMessage('WEBF_RES_DATE_FORMAT_DATE'), date) +\n\t\t\t\t'</span>' +\n\t\t\t\t'<span class=\"calendar-resbook-webform-block-date-day\">' +\n\t\t\t\tBookingUtil.formatDate(Loc.getMessage('WEBF_RES_DATE_FORMAT_DAY_OF_THE_WEEK'), date) +\n\t\t\t\t'</span>' +\n\t\t\t\t'</div>'\n\t\t}));\n\t}\n\n\trefreshDateAvailability()\n\t{\n\t\tfor (let dateCode in this.DOM.dayNodes)\n\t\t{\n\t\t\tif (this.DOM.dayNodes.hasOwnProperty(dateCode))\n\t\t\t{\n\t\t\t\tif (this.isDateAvailable(this.dayNodeIndex[dateCode]))\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.DOM.dayNodes[dateCode], 'calendar-resbook-webform-block-date-item-off');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.DOM.dayNodes[dateCode], 'calendar-resbook-webform-block-date-item-off');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet\n\t\t\tdateValue,\n\t\t\ttarget = e.target || e.srcElement;\n\n\t\tif (target.hasAttribute('data-bx-resbook-date-meta') ||\n\t\t\t(target = target.closest('[data-bx-resbook-date-meta]')))\n\t\t{\n\t\t\tlet dateMeta = target.getAttribute('data-bx-resbook-date-meta');\n\t\t\tif (dateMeta && (dateValue = BookingUtil.parseDate(dateMeta, false, 'YYYY-MM-DD')))\n\t\t\t{\n\t\t\t\tthis.setValue(dateValue);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetValue(dateValue)\n\t{\n\t\tif (Type.isDate(dateValue))\n\t\t{\n\t\t\tthis.value = dateValue;\n\t\t\tlet dayNode = this.getDayNode(dateValue);\n\t\t\tif (dayNode)\n\t\t\t{\n\t\t\t\tthis.setSelected(dayNode);\n\t\t\t}\n\t\t\tthis.onChange(this.value);\n\t\t}\n\t}\n\n\tgetValue()\n\t{\n\t\treturn this.value;\n\t}\n\n\tgetDayNode(dateValue)\n\t{\n\t\tlet dateCode = BookingUtil.formatDate('Y-m-d', dateValue.getTime() / 1000);\n\t\tif (this.DOM.dayNodes[dateCode])\n\t\t{\n\t\t\treturn this.DOM.dayNodes[dateCode];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fillDays(dateValue);\n\t\t\tif (this.DOM.dayNodes[dateCode])\n\t\t\t{\n\t\t\t\treturn this.DOM.dayNodes[dateCode];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tsetSelected(dayNode)\n\t{\n\t\tif (this.currentSelected)\n\t\t{\n\t\t\tDom.removeClass(this.currentSelected, 'calendar-resbook-webform-block-date-item-select');\n\t\t}\n\t\tthis.currentSelected = dayNode;\n\t\tDom.addClass(dayNode, 'calendar-resbook-webform-block-date-item-select');\n\t}\n\n\tgetStartLoadDate()\n\t{\n\t\tif (!this.startLoadDate)\n\t\t{\n\t\t\tthis.startLoadDate = new Date();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.startLoadDate.setDate(this.startLoadDate.getDate() + this.DAYS_DISPLAY_SIZE);\n\t\t}\n\t\treturn this.startLoadDate;\n\t}\n\n\tinitCustomScroll()\n\t{\n\t\tlet arrowWrap = this.DOM.wrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-arrow-container\" \n></div>`);\n\n\t\tthis.DOM.leftArrow = arrowWrap.appendChild(Dom.create(\"span\",\n\t\t\t{\n\t\t\t\tprops : {className : 'calendar-resbook-webform-block-arrow calendar-resbook-webform-block-arrow-prev'},\n\t\t\t\tevents: {click: this.handlePreletrowClick.bind(this)}\n\t\t\t}));\n\t\tthis.DOM.rightArrow = arrowWrap.appendChild(Dom.create(\"span\",\n\t\t\t{\n\t\t\t\tprops : { className : 'calendar-resbook-webform-block-arrow calendar-resbook-webform-block-arrow-next'},\n\t\t\t\tevents: {click: this.handleNextArrowClick.bind(this)}\n\t\t\t}));\n\n\t\tthis.outerWidth = parseInt(this.DOM.controlStaticWrap.offsetWidth);\n\t\tthis.innerWidth = parseInt(this.DOM.controlInnerWrap.offsetWidth);\n\n\t\tif ('onwheel' in document)\n\t\t{\n\t\t\tEvent.bind(this.DOM.controlStaticWrap, \"wheel\", this.mousewheelScrollHandler.bind(this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEvent.bind(this.DOM.controlStaticWrap, \"mousewheel\", this.mousewheelScrollHandler.bind(this));\n\t\t}\n\n\t\tthis.checkScrollPosition();\n\t}\n\n\thandleNextArrowClick()\n\t{\n\t\tthis.DOM.controlStaticWrap.scrollLeft = this.DOM.controlStaticWrap.scrollLeft + 100;\n\t\tthis.checkScrollPosition();\n\t}\n\n\thandlePreletrowClick()\n\t{\n\t\tthis.DOM.controlStaticWrap.scrollLeft = Math.max(this.DOM.controlStaticWrap.scrollLeft - 100, 0);\n\t\tthis.checkScrollPosition();\n\t}\n\n\tmousewheelScrollHandler(e)\n\t{\n\t\te = e || window.event;\n\t\tlet delta = e.deltaY || e.detail || e.wheelDelta;\n\t\tif (Math.abs(delta) > 0)\n\t\t{\n\t\t\tif (!Browser.isMac())\n\t\t\t{\n\t\t\t\tdelta = delta * 3;\n\t\t\t}\n\t\t\tthis.DOM.controlStaticWrap.scrollLeft = Math.max(this.DOM.controlStaticWrap.scrollLeft + delta, 0);\n\t\t\tthis.checkScrollPosition();\n\n\t\t\tif(e.stopPropagation)\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tcheckScrollPosition()\n\t{\n\t\tif (this.outerWidth <= this.innerWidth)\n\t\t{\n\t\t\tthis.DOM.leftArrow.style.display = this.DOM.controlStaticWrap.scrollLeft === 0 ? 'none' : '';\n\t\t\t//this.DOM.rightArrow.style.display = (this.innerWidth - this.outerWidth - 4 <= this.DOM.controlStaticWrap.scrollLeft) ? 'none' : '';\n\t\t\tif (this.innerWidth - this.outerWidth - 4 <= this.DOM.controlStaticWrap.scrollLeft)\n\t\t\t{\n\t\t\t\tthis.fillDays();\n\t\t\t}\n\t\t}\n\n\t\tthis.updateMonthTitle();\n\t}\n\n\tupdateMonthTitle()\n\t{\n\t\tif (!this.dayNodeOuterWidth)\n\t\t{\n\t\t\tthis.dayNodeOuterWidth = this.DOM.controlInnerWrap.childNodes[1].offsetLeft - this.DOM.controlInnerWrap.childNodes[0].offsetLeft;\n\t\t\tif (!this.dayNodeOuterWidth)\n\t\t\t{\n\t\t\t\treturn setTimeout(this.updateMonthTitle.bind(this), 100);\n\t\t\t}\n\t\t}\n\n\t\tlet\n\t\t\tmonthFrom, monthTo, dateMeta, dateValue,\n\t\t\tfirstDayNodeIndex = Math.floor(this.DOM.controlStaticWrap.scrollLeft / this.dayNodeOuterWidth),\n\t\t\tlastDayNodeIndex = Math.floor((this.DOM.controlStaticWrap.scrollLeft + this.outerWidth) / this.dayNodeOuterWidth);\n\n\t\tif (this.DOM.controlInnerWrap.childNodes[firstDayNodeIndex])\n\t\t{\n\t\t\tdateMeta = this.DOM.controlInnerWrap.childNodes[firstDayNodeIndex].getAttribute('data-bx-resbook-date-meta');\n\t\t\tif (dateMeta && (dateValue = BookingUtil.parseDate(dateMeta, false, 'YYYY-MM-DD')))\n\t\t\t{\n\t\t\t\tmonthFrom = monthTo = BookingUtil.formatDate('f', dateValue);\n\t\t\t}\n\t\t}\n\n\t\tif (this.DOM.controlInnerWrap.childNodes[lastDayNodeIndex])\n\t\t{\n\t\t\tdateMeta = this.DOM.controlInnerWrap.childNodes[lastDayNodeIndex].getAttribute('data-bx-resbook-date-meta');\n\t\t\tif (dateMeta && (dateValue = BookingUtil.parseDate(dateMeta, false, 'YYYY-MM-DD')))\n\t\t\t{\n\t\t\t\tmonthTo = BookingUtil.formatDate('f', dateValue);\n\t\t\t}\n\t\t}\n\n\t\tif (monthFrom && monthTo)\n\t\t{\n\t\t\tDom.adjust(this.DOM.monthTitle, {text: monthTo === monthFrom ? monthFrom : monthFrom + ' - ' + monthTo});\n\t\t}\n\t}\n}","import {Type, Loc, Dom, Event, Tag, Browser, BookingUtil, MenuManager} from \"../resourcebooking\";\nimport {ViewControlAbstract} from \"../viewcontrolabstract\";\n\nexport class TimeSelector extends ViewControlAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.DOM = {\n\t\t\touterWrap: params.outerWrap,\n\t\t\twrap: null\n\t\t};\n\n\t\tthis.data = params.data || {};\n\t\tthis.setDataConfig();\n\n\t\tthis.timeFrom = this.data.timeFrom || params.timeFrom || 7;\n\t\tif (params.timeFrom !== undefined)\n\t\t{\n\t\t\tthis.timeFrom = params.timeFrom;\n\t\t}\n\t\tthis.timeTo = this.data.timeTo || 20;\n\t\tif (params.timeTo !== undefined)\n\t\t{\n\t\t\tthis.timeTo = params.timeTo;\n\t\t}\n\t\tthis.SLOTS_ROW_AMOUNT = 6;\n\t\tthis.id = 'time-selector-' + Math.round(Math.random() * 1000);\n\t\tthis.popupSelectId = this.id + '-select-popup';\n\n\t\tthis.previewMode = params.previewMode === undefined;\n\t\tthis.changeValueCallback = params.changeValueCallback;\n\t\tthis.timezone = params.timezone;\n\t\tthis.timezoneOffset = params.timezoneOffset;\n\t\tthis.timezoneOffsetLabel = params.timezoneOffsetLabel;\n\t\tthis.timeMidday = 12;\n\t\tthis.timeEvening = 17;\n\t\tthis.displayed = true;\n\t}\n\n\tsetDataConfig()\n\t{\n\t\tlet\n\t\t\tstyle = this.data.style === 'select' ? 'select' : 'slots', // select|slots\n\t\t\tshowOnlyFree = this.data.showOnlyFree !== 'N',\n\t\t\tshowFinishTime = this.data.showFinishTime === 'Y',\n\t\t\tscale = parseInt(this.data.scale || 30),\n\t\t\tconfigWasChanged = this.style !== style || this.showOnlyFree !== showOnlyFree || this.showFinishTime !== showFinishTime || this.scale !== scale;\n\n\t\tthis.style = style;\n\t\tthis.showOnlyFree = showOnlyFree;\n\t\tthis.showFinishTime = showFinishTime;\n\t\tthis.scale = scale;\n\n\t\treturn configWasChanged;\n\t}\n\n\tdisplay()\n\t{\n\t\tthis.DOM.wrap = this.DOM.outerWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block\"></div>`);\n\t\tthis.DOM.innerWrap = this.DOM.wrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-inner\"></div>`);\n\t\tif (this.data.label)\n\t\t{\n\t\t\tthis.DOM.labelWrap = this.DOM.innerWrap.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: {className: 'calendar-resbook-webform-block-title'},\n\t\t\t\ttext: this.data.label + '*'\n\t\t\t}));\n\n\t\t\tif (this.timezone)\n\t\t\t{\n\t\t\t\tthis.DOM.timezoneLabelWrap = this.DOM.labelWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-title-timezone\"></div>`);\n\t\t\t\tDom.adjust(this.DOM.timezoneLabelWrap, {html: Loc.getMessage('USER_TYPE_RESOURCE_TIMEZONE').replace('#TIMEZONE#', this.timezone + ' ' + this.timezoneOffsetLabel)});\n\t\t\t}\n\t\t}\n\n\t\tthis.displayControl();\n\t\tthis.setValue(this.getValue());\n\t\tthis.shown = true;\n\t}\n\n\trefresh(data, params)\n\t{\n\t\tparams = params || {};\n\t\tthis.setSlotIndex(params.slotIndex);\n\t\tthis.currentDate = params.currentDate || new Date();\n\t\tthis.data = data;\n\n\t\tif (!this.isShown())\n\t\t{\n\t\t\tthis.setDataConfig();\n\t\t\tthis.display();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.DOM.labelWrap && this.data.label)\n\t\t\t{\n\t\t\t\tDom.adjust(this.DOM.labelWrap, {text: this.data.label + '*'});\n\t\t\t}\n\n\t\t\tif (this.timezone)\n\t\t\t{\n\t\t\t\tif (!this.DOM.timezoneLabelWrap\n\t\t\t\t\t|| !this.DOM.labelWrap.contains(this.DOM.timezoneLabelWrap))\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.timezoneLabelWrap = this.DOM.labelWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-title-timezone\"></div>`);\n\n\t\t\t\t}\n\t\t\t\tDom.adjust(this.DOM.timezoneLabelWrap, {html: Loc.getMessage('USER_TYPE_RESOURCE_TIMEZONE').replace('#TIMEZONE#', this.timezone + ' ' + this.timezoneOffsetLabel)});\n\t\t\t}\n\n\t\t\tif (this.setDataConfig() || params.slotIndex || params.selectedValue)\n\t\t\t{\n\t\t\t\tDom.remove(this.DOM.controlWrap);\n\t\t\t\tthis.displayControl();\n\t\t\t}\n\t\t}\n\n\t\tthis.setCurrentValue(params.selectedValue || this.getValue());\n\t}\n\n\tsetSlotIndex(slotIndex)\n\t{\n\t\tif (Type.isPlainObject(slotIndex))\n\t\t{\n\t\t\tthis.availableSlotIndex = slotIndex;\n\t\t}\n\t}\n\n\tsetCurrentValue(timeValue)\n\t{\n\t\tif (timeValue && (this.previewMode || this.availableSlotIndex[timeValue]))\n\t\t{\n\t\t\tthis.setValue(timeValue);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.setValue(null);\n\t\t}\n\t}\n\n\tshowEmptyWarning()\n\t{\n\t\tif (this.DOM.labelWrap)\n\t\t{\n\t\t\tthis.DOM.labelWrap.style.display = 'none';\n\t\t}\n\n\t\tif (!this.DOM.warningWrap)\n\t\t{\n\t\t\tthis.DOM.warningTextNode = Tag.render`<span class=\"calendar-resbook-webform-block-notice-date\"/>`;\n\n\t\t\tthis.DOM.warningWrap = this.DOM.innerWrap.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: {className: 'calendar-resbook-webform-block-notice'},\n\t\t\t\tchildren: [\n\t\t\t\t\tTag.render`<span class=\"calendar-resbook-webform-block-notice-icon\"/>`,\n\t\t\t\t\tthis.DOM.warningTextNode,\n\t\t\t\t\tDom.create(\"span\", {\n\t\t\t\t\t\tprops: {className: 'calendar-resbook-webform-block-notice-detail'},\n\t\t\t\t\t\ttext: Loc.getMessage('WEBF_RES_BOOKING_BUSY_DAY_WARNING')\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t}));\n\t\t}\n\n\t\tif (this.DOM.warningWrap)\n\t\t{\n\t\t\tDom.adjust(this.DOM.warningTextNode, {text: BookingUtil.formatDate(Loc.getMessage('WEBF_RES_BUSY_DAY_DATE_FORMAT'), this.currentDate)});\n\t\t\tthis.DOM.warningWrap.style.display = '';\n\n\t\t\tthis.noSlotsAvailable = true;\n\t\t}\n\t}\n\n\thideEmptyWarning()\n\t{\n\t\tthis.noSlotsAvailable = false;\n\t\tif (this.DOM.labelWrap)\n\t\t{\n\t\t\tthis.DOM.labelWrap.style.display = '';\n\t\t}\n\t\tif (this.DOM.warningWrap)\n\t\t{\n\t\t\tthis.DOM.warningWrap.style.display = 'none';\n\t\t}\n\t}\n\n\tdisplayControl()\n\t{\n\t\tlet slotsInfo = this.getSlotsInfo();\n\t\tthis.slots = slotsInfo.slots;\n\n\t\tif (!slotsInfo.freeSlotsCount)\n\t\t{\n\t\t\tthis.showEmptyWarning();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideEmptyWarning();\n\t\t\tif (this.style === 'select')\n\t\t\t{\n\t\t\t\tthis.createSelectControl();\n\t\t\t}\n\t\t\telse if (this.style === 'slots')\n\t\t\t{\n\t\t\t\tthis.createSlotsControl();\n\t\t\t}\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tif (this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap.style.display = 'none';\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tif (this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap.style.display = '';\n\t\t}\n\t}\n\n\tcreateSlotsControl()\n\t{\n\t\tif (this.DOM.controlWrap)\n\t\t{\n\t\t\tDom.remove(this.DOM.controlWrap);\n\t\t}\n\n\t\tthis.DOM.controlWrap = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create(\"div\", {\n\t\t\t\tprops: {className: 'calendar-resbook-webform-block-time'},\n\t\t\t\tevents: {click: this.handleClick.bind(this)}\n\t\t\t}));\n\n\t\tif (!this.showFinishTime && !BookingUtil.isAmPmMode())\n\t\t{\n\t\t\tDom.addClass(this.DOM.controlWrap, 'calendar-resbook-webform-block-time-sm');\n\t\t}\n\t\telse if (!this.showFinishTime && BookingUtil.isAmPmMode())\n\t\t{\n\t\t\tDom.addClass(this.DOM.controlWrap, 'calendar-resbook-webform-block-time-md');\n\t\t}\n\t\telse if (BookingUtil.isAmPmMode())\n\t\t{\n\t\t\tDom.addClass(this.DOM.controlWrap, 'calendar-resbook-webform-block-time-lg');\n\t\t}\n\n\t\tthis.DOM.controlStaticWrap = this.DOM.controlWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-time-static-wrap\"></div>`);\n\t\tthis.DOM.controlInnerWrap = this.DOM.controlStaticWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-time-inner-wrap\"></div>`);\n\n\t\tlet\n\t\t\titemsInColumn,\n\t\t\tmaxColumnNumber = 3,\n\t\t\tparts = {},\n\t\t\titemNumber = 0,\n\t\t\tinnerWrap;\n\n\t\t// FilterSlots\n\t\tthis.slots.forEach(function(slot)\n\t\t{\n\t\t\tif (!parts[slot.partOfTheDay])\n\t\t\t{\n\t\t\t\tparts[slot.partOfTheDay] = {\n\t\t\t\t\titems: []\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tparts[slot.partOfTheDay].items.push(slot);\n\t\t});\n\n\t\tthis.slots.forEach(function(slot)\n\t\t{\n\t\t\tif (!parts[slot.partOfTheDay].wrap)\n\t\t\t{\n\t\t\t\titemNumber = 0;\n\t\t\t\titemsInColumn = 6;\n\t\t\t\tparts[slot.partOfTheDay].wrap = Dom.create(\"div\", {\n\t\t\t\t\tprops: {className: 'calendar-resbook-webform-block-col'},\n\t\t\t\t\thtml: '<span class=\"calendar-resbook-webform-block-col-title\">'\n\t\t\t\t\t\t+ Loc.getMessage('WEBF_RES_PART_OF_THE_DAY_' + slot.partOfTheDay.toUpperCase())\n\t\t\t\t\t\t+ '</span>'\n\t\t\t\t});\n\n\t\t\t\tparts[slot.partOfTheDay].itemsWrap = parts[slot.partOfTheDay].wrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-col-list\"></div>`);\n\n\t\t\t\tif (parts[slot.partOfTheDay].items.length > maxColumnNumber * itemsInColumn)\n\t\t\t\t{\n\t\t\t\t\titemsInColumn = Math.ceil(parts[slot.partOfTheDay].items.length / maxColumnNumber);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (itemNumber % itemsInColumn === 0)\n\t\t\t{\n\t\t\t\tinnerWrap = parts[slot.partOfTheDay].itemsWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-col-list-inner\"></div>`);\n\t\t\t}\n\n\t\t\tif (innerWrap && (!slot.booked || !this.showOnlyFree))\n\t\t\t{\n\t\t\t\tinnerWrap.appendChild(Dom.create(\"div\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\t'data-bx-resbook-time-meta': 'slot' + (slot.booked ? '-off' : ''),\n\t\t\t\t\t\t'data-bx-resbook-slot': slot.time.toString(),\n\t\t\t\t\t\tclassName: 'calendar-resbook-webform-block-col-item'\n\t\t\t\t\t\t\t+ (slot.selected ? ' calendar-resbook-webform-block-col-item-select' : '')\n\t\t\t\t\t\t\t+ (slot.booked ? ' calendar-resbook-webform-block-col-item-off' : '')\n\t\t\t\t\t},\n\t\t\t\t\thtml: '<div class=\"calendar-resbook-webform-block-col-item-inner\">' + '<span class=\"calendar-resbook-webform-block-col-time\">' + slot.fromTime + '</span>' + (this.showFinishTime ? '- <span class=\"calendar-resbook-webform-block-col-time calendar-resbook-webform-block-col-time-end\">' + slot.toTime + '</span>' : ''\n\t\t\t\t\t) + '</div>'\n\t\t\t\t}));\n\t\t\t\titemNumber++;\n\t\t\t}\n\n\t\t\tparts[slot.partOfTheDay].itemsAmount = itemNumber;\n\t\t}, this);\n\n\t\tlet k;\n\t\tfor (k in parts)\n\t\t{\n\t\t\tif (parts.hasOwnProperty(k) && parts[k].itemsAmount > 0)\n\t\t\t{\n\t\t\t\tthis.DOM.controlInnerWrap.appendChild(parts[k].wrap);\n\t\t\t}\n\t\t}\n\n\t\tthis.initCustomScrollForSlots();\n\t}\n\n\tcreateSelectControl()\n\t{\n\t\tif (this.DOM.controlWrap)\n\t\t{\n\t\t\tDom.remove(this.DOM.controlWrap);\n\t\t}\n\n\t\tthis.DOM.controlWrap = this.DOM.innerWrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-block-field'},\n\t\t\tevents: {click: this.handleClick.bind(this)}\n\t\t}));\n\n\t\tthis.DOM.timeSelectWrap = this.DOM.controlWrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-block-strip'}\n\t\t}));\n\t\tthis.DOM.valueInput = this.DOM.timeSelectWrap.appendChild(Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tvalue: ''\n\t\t\t}\n\t\t}));\n\n\t\tthis.DOM.previousArrow = this.DOM.timeSelectWrap.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'calendar-resbook-webform-block-strip-arrow calendar-resbook-webform-block-strip-arrow-prev',\n\t\t\t\t'data-bx-resbook-time-meta': 'previous'\n\t\t\t}\n\t\t}));\n\n\t\tthis.DOM.stateWrap = this.DOM.timeSelectWrap.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'calendar-resbook-webform-block-strip-text',\n\t\t\t\t'data-bx-resbook-time-meta': 'select'\n\t\t\t}\n\t\t}));\n\t\tthis.DOM.stateWrap = this.DOM.stateWrap.appendChild(Dom.create(\"span\", {props: {className: 'calendar-resbook-webform-block-strip-date'}}));\n\n\t\tthis.DOM.nextArrow = this.DOM.timeSelectWrap.appendChild(Dom.create(\"span\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'calendar-resbook-webform-block-strip-arrow calendar-resbook-webform-block-strip-arrow-next',\n\t\t\t\t'data-bx-resbook-time-meta': 'next'\n\t\t\t}\n\t\t}));\n\n\t\tthis.setValue(this.getValue());\n\t}\n\n\tsetValue(value)\n\t{\n\t\tlet slot = this.getSlotByTime(value);\n\t\tif (slot)\n\t\t{\n\t\t\tif (this.style === 'select' && Type.isDomNode(this.DOM.stateWrap))\n\t\t\t{\n\t\t\t\tDom.adjust(this.DOM.stateWrap, {text: this.getTimeTextBySlot(slot)});\n\t\t\t}\n\t\t\telse if (this.style === 'slots')\n\t\t\t{\n\t\t\t\tthis.setSelected(this.getSlotNode(slot.time));\n\t\t\t}\n\t\t\tthis.value = slot.time;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.value = null;\n\t\t}\n\n\t\tif (!this.previewMode && Type.isFunction(this.changeValueCallback))\n\t\t{\n\t\t\tthis.changeValueCallback(this.value);\n\t\t}\n\t}\n\n\tgetValue()\n\t{\n\t\tif (!this.value && (this.previewMode || this.style === 'select'))\n\t\t{\n\t\t\tthis.value = this.slots[0].time;\n\t\t}\n\t\treturn this.value;\n\t}\n\n\thasAvailableSlots()\n\t{\n\t\treturn !this.noSlotsAvailable;\n\t}\n\n\tgetTimeTextBySlot(slot)\n\t{\n\t\treturn slot.fromTime + (this.showFinishTime ? ' - ' + slot.toTime : '');\n\t}\n\n\tgetSlotByTime(time)\n\t{\n\t\treturn Type.isArray(this.slots) ? this.slots.find(function(slot){return parseInt(slot.time) === parseInt(time);}) : null;\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (target.hasAttribute('data-bx-resbook-time-meta') ||\n\t\t\t(target = target.closest('[data-bx-resbook-time-meta]')))\n\t\t{\n\t\t\tlet meta = target.getAttribute('data-bx-resbook-time-meta');\n\t\t\tif (this.style === 'select')\n\t\t\t{\n\t\t\t\tif (meta === 'previous')\n\t\t\t\t{\n\t\t\t\t\tthis.setValue(this.getValue() - this.scale);\n\t\t\t\t}\n\t\t\t\telse if (meta === 'next')\n\t\t\t\t{\n\t\t\t\t\tthis.setValue(this.getValue() + this.scale);\n\t\t\t\t}\n\t\t\t\telse if (meta === 'select')\n\t\t\t\t{\n\t\t\t\t\tthis.openSelectPopup();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (meta === 'slot')\n\t\t\t{\n\t\t\t\tthis.setValue(parseInt(target.getAttribute('data-bx-resbook-slot')));\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSlotsInfo()\n\t{\n\t\tlet\n\t\t\tslots = [], slot,\n\t\t\tfreeSlotsCount = 0,\n\t\t\tfinishTime, hourFrom, minFrom,\n\t\t\thourTo, minTo,\n\t\t\tpart = 'morning',\n\t\t\tnum = 0,\n\t\t\ttime = this.timeFrom * 60;\n\n\t\twhile (time < this.timeTo * 60)\n\t\t{\n\t\t\tif (time >= this.timeEvening * 60)\n\t\t\t{\n\t\t\t\tpart = 'evening';\n\t\t\t}\n\t\t\telse if (time >= this.timeMidday * 60)\n\t\t\t{\n\t\t\t\tpart = 'afternoon';\n\t\t\t}\n\n\t\t\thourFrom = Math.floor(time / 60);\n\t\t\tminFrom = (time) - hourFrom * 60;\n\t\t\tfinishTime = time + this.scale;\n\t\t\thourTo = Math.floor(finishTime / 60);\n\t\t\tminTo = (finishTime) - hourTo * 60;\n\n\t\t\tslot = {\n\t\t\t\ttime: time,\n\t\t\t\tfromTime: BookingUtil.formatTime(hourFrom, minFrom),\n\t\t\t\ttoTime: BookingUtil.formatTime(hourTo, minTo),\n\t\t\t\tpartOfTheDay: part\n\t\t\t};\n\n\t\t\tif (this.previewMode)\n\t\t\t{\n\t\t\t\tif (!num)\n\t\t\t\t{\n\t\t\t\t\tslot.selected = true;\n\t\t\t\t}\n\t\t\t\telse if (Math.round(Math.random() * 10) <= 3)\n\t\t\t\t{\n\t\t\t\t\tslot.booked = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(this.availableSlotIndex)\n\t\t\t{\n\t\t\t\tslot.booked = !this.availableSlotIndex[time];\n\t\t\t}\n\n\t\t\tif (!slot.booked)\n\t\t\t{\n\t\t\t\tfreeSlotsCount++;\n\t\t\t}\n\n\t\t\tslots.push(slot);\n\t\t\ttime += this.scale;\n\t\t\tnum++;\n\t\t}\n\n\t\treturn {\n\t\t\tslots: slots,\n\t\t\tfreeSlotsCount: freeSlotsCount\n\t\t};\n\t}\n\n\tinitCustomScrollForSlots()\n\t{\n\t\tlet arrowWrap = this.DOM.controlWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-arrow-container\" />`);\n\n\t\t\tthis.DOM.leftArrow = arrowWrap.appendChild(Dom.create(\"span\",\n\t\t\t{\n\t\t\t\tprops : {className : 'calendar-resbook-webform-block-arrow calendar-resbook-webform-block-arrow-prev'},\n\t\t\t\tevents: {click: this.handlePreletrowClick.bind(this)}\n\t\t\t}));\n\t\tthis.DOM.rightArrow = arrowWrap.appendChild(Dom.create(\"span\",\n\t\t\t{\n\t\t\t\tprops : { className : 'calendar-resbook-webform-block-arrow calendar-resbook-webform-block-arrow-next'},\n\t\t\t\tevents: {click: this.handleNextArrowClick.bind(this)}\n\t\t\t}));\n\n\t\tthis.outerWidth = parseInt(this.DOM.controlStaticWrap.offsetWidth);\n\t\tthis.innerWidth = parseInt(this.DOM.controlInnerWrap.offsetWidth);\n\n\t\tif ('onwheel' in document)\n\t\t\tEvent.bind(this.DOM.controlStaticWrap, \"wheel\", this.mousewheelScrollHandler.bind(this));\n\t\telse\n\t\t\tEvent.bind(this.DOM.controlStaticWrap, \"mousewheel\", this.mousewheelScrollHandler.bind(this));\n\n\t\tthis.checkSlotsScroll();\n\t}\n\n\thandleNextArrowClick()\n\t{\n\t\tthis.DOM.controlStaticWrap.scrollLeft = this.DOM.controlStaticWrap.scrollLeft + 100;\n\t\tthis.checkSlotsScroll();\n\t}\n\n\thandlePreletrowClick()\n\t{\n\t\tthis.DOM.controlStaticWrap.scrollLeft = Math.max(this.DOM.controlStaticWrap.scrollLeft - 100, 0);\n\t\tthis.checkSlotsScroll();\n\t}\n\n\tmousewheelScrollHandler(e)\n\t{\n\t\te = e || window.event;\n\t\tlet delta = e.deltaY || e.detail || e.wheelDelta;\n\t\tif (Math.abs(delta) > 0)\n\t\t{\n\t\t\tif (!Browser.isMac())\n\t\t\t{\n\t\t\t\tdelta = delta * 5;\n\t\t\t}\n\t\t\tthis.DOM.controlStaticWrap.scrollLeft = Math.max(this.DOM.controlStaticWrap.scrollLeft + delta, 0);\n\t\t\tthis.checkSlotsScroll();\n\t\t\tif(e.stopPropagation)\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tcheckSlotsScroll()\n\t{\n\t\tif (this.outerWidth <= this.innerWidth)\n\t\t{\n\t\t\tthis.DOM.leftArrow.style.display = this.DOM.controlStaticWrap.scrollLeft ? '' : 'none';\n\t\t\tif (this.innerWidth - this.outerWidth - 4 <= this.DOM.controlStaticWrap.scrollLeft)\n\t\t\t{\n\t\t\t\tthis.DOM.rightArrow.style.display = 'none';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.rightArrow.style.display = '';\n\t\t\t}\n\t\t}\n\t}\n\n\topenSelectPopup()\n\t{\n\t\tif (this.isSelectPopupShown())\n\t\t{\n\t\t\treturn this.closeSelectPopup();\n\t\t}\n\n\t\tthis.popup = MenuManager.create(\n\t\t\tthis.popupSelectId,\n\t\t\tthis.DOM.stateWrap,\n\t\t\tthis.getTimeSelectItems(),\n\t\t\t{\n\t\t\t\tclassName: \"calendar-resbook-time-select-popup\"\t,\n\t\t\t\tangle: true,\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : true,\n\t\t\t\toffsetTop: 5,\n\t\t\t\toffsetLeft: 10,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.show(true);\n\t}\n\n\tcloseSelectPopup()\n\t{\n\t\tif (this.isSelectPopupShown())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t\tEvent.unbind(document, 'click', this.handleClick.bind(this));\n\t\t}\n\t}\n\n\tisSelectPopupShown()\n\t{\n\t\treturn this.popup && this.popup.popupWindow &&\n\t\t\tthis.popup.popupWindow.isShown && this.popup.popupWindow.isShown();\n\t}\n\n\tgetTimeSelectItems()\n\t{\n\t\tlet menuItems = [];\n\t\tthis.slots.forEach(function(slot)\n\t\t{\n\t\t\tif (this.showOnlyFree && slot.booked)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet className = 'menu-popup-no-icon';\n\t\t\tif (slot.booked)\n\t\t\t{\n\t\t\t\tclassName += ' menu-item-booked';\n\t\t\t}\n\t\t\tif (slot.selected)\n\t\t\t{\n\t\t\t\tclassName += ' menu-item-selected';\n\t\t\t}\n\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\tclassName: className,\n\t\t\t\t\ttext: this.getTimeTextBySlot(slot),\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\tvalue: slot.time,\n\t\t\t\t\t\tbooked: !!slot.booked\n\t\t\t\t\t},\n\t\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t\t}\n\t\t\t);\n\t\t}, this);\n\t\treturn menuItems;\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tif (menuItem && menuItem.dataset && menuItem.dataset.value)\n\t\t{\n\t\t\tif (!menuItem.dataset.booked)\n\t\t\t{\n\t\t\t\tthis.setValue(menuItem.dataset.value);\n\t\t\t}\n\t\t}\n\t\tthis.closeSelectPopup();\n\t}\n\n\tgetSlotNode(time)\n\t{\n\t\tlet i, slotNodes = this.DOM.controlInnerWrap.querySelectorAll('.calendar-resbook-webform-block-col-item');\n\t\tfor (i = 0; i < slotNodes.length; i++)\n\t\t{\n\t\t\tif (parseInt(slotNodes[i].getAttribute('data-bx-resbook-slot')) === parseInt(time))\n\t\t\t{\n\t\t\t\treturn slotNodes[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tsetSelected(slotNode)\n\t{\n\t\tif (Type.isDomNode(slotNode))\n\t\t{\n\t\t\tif (this.currentSelected)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.currentSelected, 'calendar-resbook-webform-block-col-item-select');\n\t\t\t}\n\t\t\tthis.currentSelected = slotNode;\n\t\t\tDom.addClass(slotNode, 'calendar-resbook-webform-block-col-item-select');\n\t\t}\n\t}\n}\n\n","import {Loc, Dom, Tag, BookingUtil} from \"../resourcebooking\";\n\nexport class StatusInformer\n{\n\tconstructor(params)\n\t{\n\t\tthis.DOM = {\n\t\t\touterWrap: params.outerWrap\n\t\t};\n\t\tthis.timezone = params.timezone;\n\t\tthis.timezoneOffsetLabel = params.timezoneOffsetLabel;\n\t\tthis.shown = false;\n\t\tthis.built = false;\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.shown;\n\t}\n\n\tbuild()\n\t{\n\t\tthis.DOM.wrap = this.DOM.outerWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-result\" style=\"display: none\" \n></div>`);\n\t\tthis.DOM.innerWrap = this.DOM.wrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-result-inner\"></div>`);\n\t\tthis.DOM.labelWrap = this.DOM.innerWrap.appendChild(Dom.create(\"span\", {props : { className : 'calendar-resbook-webform-block-result-text'}, text: Loc.getMessage('WEBF_RES_BOOKING_STATUS_LABEL')}));\n\t\tthis.DOM.statusWrap = this.DOM.innerWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-block-result-value\"></div>`);\n\t\tthis.DOM.statusTimezone = this.DOM.innerWrap.appendChild(Dom.create(\"span\", {props: {className: 'calendar-resbook-webform-block-result-timezone'}, text: this.timezoneOffsetLabel || '', style: {display: 'none'}}));\n\t\tthis.built = true;\n\t}\n\n\trefresh(params)\n\t{\n\t\tif (!this.built)\n\t\t{\n\t\t\tthis.build();\n\t\t}\n\n\t\tif (!this.isShown())\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\n\t\tif (params.dateFrom)\n\t\t{\n\t\t\tthis.DOM.labelWrap.style.display = '';\n\t\t\tDom.removeClass(this.DOM.wrap, 'calendar-resbook-webform-block-result-error');\n\t\t\tif (this.timezone)\n\t\t\t{\n\t\t\t\tthis.DOM.statusTimezone.style.display = '';\n\t\t\t}\n\t\t\tDom.adjust(this.DOM.statusWrap, {text: this.getStatusText(params)});\n\t\t}\n\t\telse if (!params.dateFrom && params.fullDay)\n\t\t{\n\t\t\tthis.DOM.labelWrap.style.display = 'none';\n\t\t\tthis.DOM.statusTimezone.style.display = 'none';\n\t\t\tDom.addClass(this.DOM.wrap, 'calendar-resbook-webform-block-result-error');\n\t\t\tDom.adjust(this.DOM.statusWrap, {text: Loc.getMessage('WEBF_RES_BOOKING_STATUS_DATE_IS_NOT_AVAILABLE')});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.labelWrap.style.display = 'none';\n\t\t\tthis.DOM.statusTimezone.style.display = 'none';\n\t\t\tDom.removeClass(this.DOM.wrap, 'calendar-resbook-webform-block-result-error');\n\t\t\tDom.adjust(this.DOM.statusWrap, {text: Loc.getMessage('WEBF_RES_BOOKING_STATUS_NO_TIME_SELECTED')});\n\t\t}\n\t}\n\n\tgetStatusText(params)\n\t{\n\t\tlet\n\t\t\tdateFrom = params.dateFrom,\n\t\t\tdateTo = new Date(dateFrom.getTime() + params.duration * 60 * 1000 + (params.fullDay ? -1 : 0)),\n\t\t\ttext = '';\n\n\t\tif (params.fullDay)\n\t\t{\n\t\t\tif (BookingUtil.formatDate('Y-m-d', dateFrom.getTime() / 1000) === BookingUtil.formatDate('Y-m-d', dateTo.getTime() / 1000))\n\t\t\t{\n\t\t\t\ttext = BookingUtil.formatDate(Loc.getMessage('WEBF_RES_DATE_FORMAT_STATUS'), dateFrom);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttext = Loc.getMessage('WEBF_RES_DATE_FORMAT_FROM_TO')\n\t\t\t\t\t.replace('#DATE_FROM#', BookingUtil.formatDate(Loc.getMessage('WEBF_RES_DATE_FORMAT_STATUS_SHORT'), dateFrom))\n\t\t\t\t\t.replace('#DATE_TO#', BookingUtil.formatDate(Loc.getMessage('WEBF_RES_DATE_FORMAT_STATUS_SHORT'), dateTo));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (BookingUtil.formatDate('Y-m-d', dateFrom.getTime() / 1000) === BookingUtil.formatDate('Y-m-d', dateTo.getTime() / 1000))\n\t\t\t{\n\t\t\t\ttext = BookingUtil.formatDate(Loc.getMessage('WEBF_RES_DATE_FORMAT_STATUS'), dateFrom)\n\t\t\t\t\t+ ' '\n\t\t\t\t\t+ Loc.getMessage('WEBF_RES_TIME_FORMAT_FROM_TO')\n\t\t\t\t\t\t.replace('#TIME_FROM#', BookingUtil.formatTime(dateFrom.getHours(), dateFrom.getMinutes()))\n\t\t\t\t\t\t.replace('#TIME_TO#', BookingUtil.formatTime(dateTo.getHours(), dateTo.getMinutes()));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttext = Loc.getMessage('WEBF_RES_DATE_FORMAT_FROM_TO')\n\t\t\t\t\t.replace('#DATE_FROM#', BookingUtil.formatDate(Loc.getMessage('WEBF_RES_DATE_FORMAT_STATUS_SHORT'), dateFrom) + ' '+ BookingUtil.formatTime(dateFrom.getHours(), dateFrom.getMinutes()))\n\t\t\t\t\t.replace('#DATE_TO#', BookingUtil.formatDate(Loc.getMessage('WEBF_RES_DATE_FORMAT_STATUS_SHORT'), dateTo) + ' '+ BookingUtil.formatTime(dateTo.getHours(), dateTo.getMinutes()));\n\t\t\t}\n\t\t}\n\n\t\treturn text;\n\t}\n\n\thide()\n\t{\n\t\tif (this.built && this.shown)\n\t\t{\n\t\t\tthis.DOM.wrap.style.display = 'none';\n\t\t\tthis.shown = false;\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tif (this.built && !this.shown)\n\t\t{\n\t\t\tthis.DOM.wrap.style.display = '';\n\t\t\tthis.shown = true;\n\t\t}\n\t}\n\n\tsetError(message)\n\t{\n\t\tif (this.DOM.labelWrap)\n\t\t{\n\t\t\tthis.DOM.labelWrap.style.display = 'none';\n\t\t}\n\t\tDom.addClass(this.DOM.wrap, 'calendar-resbook-webform-block-result-error');\n\t\tDom.adjust(this.DOM.statusWrap, {text: message});\n\t}\n}","import {Type, Loc, Dom, Tag, Text, BookingUtil} from \"./resourcebooking\";\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {UserSelector} from \"./controls/userselector\";\nimport {ResourceSelector} from \"./controls/resourceselector\";\nimport {ServiceSelector} from \"./controls/serviceselector\";\nimport {DurationSelector} from \"./controls/durationselector\";\nimport {DateSelector} from \"./controls/dateselector\";\nimport {TimeSelector} from \"./controls/timeselector\";\nimport {StatusInformer} from \"./controls/statusinformer\";\n\nexport class LiveFieldController extends EventEmitter\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.setEventNamespace('BX.Calendar.LiveFieldController');\n\t\tthis.params = params;\n\t\tthis.actionAgent = params.actionAgent || BX.ajax.runAction;\n\t\tthis.timeFrom = params.timeFrom || 7;\n\t\tthis.timeTo = params.timeTo || 20;\n\t\tthis.inputName = params.field.name + '[]';\n\t\tthis.DATE_FORMAT = BookingUtil.getDateFormat();\n\t\tthis.DATETIME_FORMAT = BookingUtil.getDateTimeFormat();\n\t\tthis.userIndex = null;\n\t\tthis.timezoneOffset = null;\n\t\tthis.timezoneOffsetLabel = null;\n\t\tthis.userFieldParams = null;\n\t\tthis.loadedDates = [];\n\n\t\tthis.accessibility = {\n\t\t\tuser : {},\n\t\t\tresource: {}\n\t\t};\n\t\tthis.busySlotMatrix = {\n\t\t\tuser : {},\n\t\t\tresource: {}\n\t\t};\n\n\t\tthis.DOM = {\n\t\t\twrap: this.params.wrap,\n\t\t\tvalueInputs: []\n\t\t};\n\t}\n\n\tinit()\n\t{\n\t\tconst settingsData = this.getSettingsData();\n\t\tif (!settingsData.users || !settingsData.resources)\n\t\t{\n\t\t\tthrow new Error('Can\\'t init resourcebooking field, because \\'settings_data\\' parameter is not provided or has incorrect structure');\n\t\t\treturn;\n\t\t}\n\t\tthis.scale = parseInt(settingsData.time && settingsData.time.scale ? settingsData.time.scale : 60, 10);\n\n\t\tthis.DOM.outerWrap = this.DOM.wrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-wrapper\"></div>`);\n\n\t\tthis.showMainLoader();\n\t\tthis.requireFormData().then(()=>{\n\t\t\tthis.hideMainLoader();\n\t\t\tthis.buildFormControls();\n\t\t\tthis.onChangeValues();\n\t\t});\n\t}\n\n\tcheck()\n\t{\n\t\tlet result = true;\n\n\t\tif (this.usersDisplayed() && !this.getSelectedUser())\n\t\t{\n\t\t\tthis.userControl.showWarning();\n\t\t\tresult = false;\n\t\t}\n\n\t\tif (result && this.resourcesDisplayed() && !this.getSelectedResources())\n\t\t{\n\t\t\tthis.resourceControl.showWarning();\n\t\t\tresult = false;\n\t\t}\n\n\t\tif (result && !this.getCurrentDuration())\n\t\t{\n\t\t\tif (this.durationControl)\n\t\t\t{\n\t\t\t\tthis.durationControl.showWarning();\n\t\t\t}\n\t\t\telse if (this.serviceControl)\n\t\t\t{\n\t\t\t\tthis.serviceControl.showWarning();\n\t\t\t}\n\t\t\tresult = false;\n\t\t}\n\n\t\tif (result && !this.dateControl.getValue())\n\t\t{\n\t\t\tthis.dateControl.showWarning();\n\t\t\tresult = false;\n\t\t}\n\n\t\tif (result && this.timeSelectorDisplayed() && !this.timeControl.getValue())\n\t\t{\n\t\t\tthis.timeControl.showWarning();\n\t\t\tresult = false;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tbuildFormControls()\n\t{\n\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div class=\"calendar-resbook-webform-inner\"></div>`);\n\t\tthis.DOM.inputsWrap = this.DOM.innerWrap.appendChild(Tag.render`<div></div>`);\n\n\t\tif (!this.getFieldParams())\n\t\t{\n\t\t\tthis.statusControl = new StatusInformer({\n\t\t\t\touterWrap: this.DOM.innerWrap\n\t\t\t});\n\t\t\tthis.statusControl.refresh({});\n\t\t\tthis.statusControl.setError('[UF_NOT_FOUND] ' + Loc.getMessage('WEBF_RES_BOOKING_UF_WARNING'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.preparaAutoSelectValues();\n\t\t\tthis.displayUsersControl();\n\t\t\tthis.displayResourcesControl();\n\t\t\tthis.displayServicesControl();\n\t\t\tthis.displayDurationControl();\n\t\t\tthis.displayDateTimeControl();\n\n\t\t\tif (this.selectedUserId || this.selectedResourceId)\n\t\t\t{\n\t\t\t\tthis.refreshControlsState();\n\t\t\t}\n\t\t}\n\t}\n\n\trefreshControlsState()\n\t{\n\t\tif (this.selectorCanBeShown('resources')\n\t\t\t&& this.resourceControl\n\t\t\t&& !this.resourceControl.isShown())\n\t\t{\n\t\t\tthis.resourceControl.display();\n\t\t}\n\n\t\t// Show services\n\t\tif (this.selectorCanBeShown('services')\n\t\t\t&& this.serviceControl\n\t\t\t&& !this.serviceControl.isShown())\n\t\t{\n\t\t\tthis.serviceControl.display();\n\t\t}\n\n\t\t// Show duration\n\t\tif (this.selectorCanBeShown('duration')\n\t\t\t&& this.durationControl\n\t\t\t&& !this.durationControl.isShown())\n\t\t{\n\t\t\tthis.durationControl.display();\n\t\t}\n\n\t\tlet settingsData = this.getSettingsData();\n\t\t// Show date & time control\n\t\tif (this.selectorCanBeShown('date') && this.dateControl)\n\t\t{\n\t\t\tif (this.dateControl.isShown())\n\t\t\t{\n\t\t\t\tthis.dateControl.refresh(\n\t\t\t\t\tsettingsData.date,\n\t\t\t\t\t{\n\t\t\t\t\t\tavailableDateIndex: this.getAvailableDateIndex({\n\t\t\t\t\t\t\tresources: this.getSelectedResources(),\n\t\t\t\t\t\t\tuser: this.getSelectedUser(),\n\t\t\t\t\t\t\tduration: this.getCurrentDuration()\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tif (this.timeControl)\n\t\t\t\t{\n\t\t\t\t\tthis.timeControl.refresh(\n\t\t\t\t\t\tsettingsData.time,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tslotIndex: this.getSlotIndex({date: this.dateControl.getValue()}),\n\t\t\t\t\t\t\tcurrentDate: this.dateControl.getValue()\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet startValue;\n\t\t\t\tif (settingsData.date.start === 'free')\n\t\t\t\t{\n\t\t\t\t\tstartValue = this.getFreeDate({\n\t\t\t\t\t\tresources: this.getSelectedResources(),\n\t\t\t\t\t\tuser: this.getSelectedUser(),\n\t\t\t\t\t\tduration: this.getCurrentDuration()\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstartValue = new Date();\n\t\t\t\t}\n\n\t\t\t\tthis.dateControl.display({\n\t\t\t\t\tselectedValue: startValue,\n\t\t\t\t\tavailableDateIndex: this.getAvailableDateIndex({\n\t\t\t\t\t\tresources: this.getSelectedResources(),\n\t\t\t\t\t\tuser: this.getSelectedUser(),\n\t\t\t\t\t\tduration: this.getCurrentDuration()\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.updateStatusControl();\n\t\tthis.onChangeValues();\n\t\tBookingUtil.fireCustomEvent(window, 'crmWebFormFireResize');\n\t}\n\n\tonChangeValues()\n\t{\n\t\tlet\n\t\t\tallValuesValue = [],\n\t\t\tdateFromValue = '',\n\t\t\tdateFrom = this.getCurrentDate(),\n\t\t\tduration = this.getCurrentDuration() * 60,// Duration in minutes\n\t\t\tserviceName = this.getCurrentServiceName(),\n\t\t\tentries = [];\n\n\t\t// Clear inputs\n\t\tDom.clean(this.DOM.inputsWrap);\n\n\t\tthis.DOM.valueInputs = [];\n\n\t\tif (Type.isDate(dateFrom))\n\t\t{\n\t\t\tlet resources = this.getSelectedResources();\n\t\t\tif (Type.isArray(resources))\n\t\t\t{\n\t\t\t\tresources.forEach(function(resourceId)\n\t\t\t\t{\n\t\t\t\t\tentries = entries.concat({type: 'resource', id: resourceId});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet selectedUser = this.getSelectedUser();\n\t\t\tif (selectedUser)\n\t\t\t{\n\t\t\t\tentries = entries.concat({type: 'user', id: selectedUser});\n\t\t\t}\n\n\t\t\tdateFromValue = BookingUtil.formatDate(this.DATETIME_FORMAT, dateFrom.getTime() / 1000);\n\n\t\t\tentries.forEach(function(entry)\n\t\t\t{\n\t\t\t\tlet value = entry.type + '|' + entry.id + '|' + dateFromValue + '|' + duration + '|' + serviceName;\n\t\t\t\tallValuesValue.push(value);\n\n\t\t\t\tthis.DOM.valueInputs.push(this.DOM.inputsWrap.appendChild(\n\t\t\t\t\tTag.render`\n\t\t\t\t\t<input \n\t\t\t\t\t\tname=\"${Text.encode(this.inputName)}\"\n\t\t\t\t\t\tvalue=\"${Text.encode(value)}\" \n\t\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\t\t>\n\t\t\t\t\t`\n\t\t\t\t));\n\t\t\t}, this);\n\t\t}\n\n\t\tif (!entries.length)\n\t\t{\n\t\t\tthis.DOM.valueInputs.push(this.DOM.inputsWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<input \n\t\t\t\t\t\tname=\"${Text.encode(this.inputName)}\"\n\t\t\t\t\t\tvalue=\"empty\" \n\t\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\t\t>\n\t\t\t\t\t`\n\t\t\t));\n\t\t}\n\n\t\tthis.emit('change', allValuesValue);\n\t}\n\n\tshowMainLoader()\n\t{\n\t\tif (this.DOM.wrap)\n\t\t{\n\t\t\tthis.hideMainLoader();\n\t\t\tlet loaderWrap = Tag.render`<div class=\"calendar-resbook-webform-wrapper-loader-wrap\"></div>`;\n\t\t\tloaderWrap.appendChild(BookingUtil.getLoader(160));\n\t\t\tthis.DOM.mainLoader = this.DOM.outerWrap.appendChild(loaderWrap);\n\t\t}\n\t}\n\n\thideMainLoader()\n\t{\n\t\tDom.remove(this.DOM.mainLoader);\n\t}\n\n\tshowStatusLoader()\n\t{\n\t\tthis.showMainLoader();\n\t}\n\n\thideStatusLoader()\n\t{\n\t\tthis.hideMainLoader();\n\t}\n\n\trequestAccessibilityData(params)\n\t{\n\t\tif (!this.requestedFormData)\n\t\t{\n\t\t\tthis.showStatusLoader();\n\n\t\t\tthis.requestedFormData = true;\n\t\t\tlet formDataParams = {\n\t\t\t\tfrom: params.date\n\t\t\t};\n\n\t\t\tthis.requireFormData(formDataParams).then(() => {\n\t\t\t\tthis.hideStatusLoader();\n\t\t\t\tthis.refreshControlsState();\n\t\t\t\tthis.dateControl.refreshCurrentValue();\n\t\t\t\tthis.onChangeValues();\n\t\t\t\tthis.requestedFormData = false;\n\t\t\t});\n\t\t}\n\t}\n\n\trequireFormData(params)\n\t{\n\t\tparams = Type.isPlainObject(params) ? params : {};\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet\n\t\t\t\tdata = {\n\t\t\t\t\tsettingsData: this.getSettingsData() || null\n\t\t\t\t};\n\n\t\t\tif (!this.userFieldParams)\n\t\t\t{\n\t\t\t\tdata.fieldName = this.params.field.entity_field_name;\n\t\t\t}\n\n\t\t\tlet\n\t\t\t\tdateFrom = Type.isDate(params.from) ? params.from : new Date(),\n\t\t\t\tdateTo;\n\n\t\t\tif (Type.isDate(params.to))\n\t\t\t{\n\t\t\t\tdateTo = params.to;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdateTo = new Date(dateFrom.getTime());\n\t\t\t\tdateTo.setDate(dateFrom.getDate() + 60);\n\t\t\t}\n\n\t\t\tdata.from = BookingUtil.formatDate(this.DATE_FORMAT, dateFrom);\n\t\t\tdata.to = BookingUtil.formatDate(this.DATE_FORMAT, dateTo);\n\n\t\t\tthis.setLoadedDataLimits(dateFrom, dateTo);\n\n\t\t\tthis.actionAgent('calendar.api.resourcebookingajax.getfillformdata', {\n\t\t\t\tdata: data\n\t\t\t}).then((response) => {\n\t\t\t\t\tif (!Type.isPlainObject(response) || !response.data)\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Type.isNumber(response.data.timezoneOffset))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.timezoneOffset = response.data.timezoneOffset;\n\t\t\t\t\t\t\tthis.timezoneOffsetLabel = response.data.timezoneOffsetLabel;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (response.data.workTimeStart !== undefined && response.data.workTimeEnd !== undefined)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.timeFrom = parseInt(response.data.workTimeStart);\n\t\t\t\t\t\t\tthis.timeTo = parseInt(response.data.workTimeEnd);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (response.data.fieldSettings)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.userFieldParams = response.data.fieldSettings;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (response.data.userIndex)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.userIndex = response.data.userIndex;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.handleAccessibilityData(response.data.usersAccessibility, 'user');\n\t\t\t\t\t\tthis.handleAccessibilityData(response.data.resourcesAccessibility, 'resource');\n\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tresolve(response);\n\t\t\t\t});\n\t\t});\n\t}\n\n\tsetLoadedDataLimits(from, to)\n\t{\n\t\tthis.loadedDataFrom = Type.isDate(from) ? from : BookingUtil.parseDate(from);\n\t\tthis.loadedDataTo = Type.isDate(to) ? to : BookingUtil.parseDate(to);\n\n\t\tthis.loadedDates = this.loadedDates || [];\n\t\tthis.loadedDatesIndex = this.loadedDatesIndex || {};\n\n\t\tlet\n\t\t\tdateKey,\n\t\t\tdate = new Date(this.loadedDataFrom.getTime());\n\n\t\twhile (true)\n\t\t{\n\t\t\tdateKey = BookingUtil.formatDate(this.DATE_FORMAT, date);\n\t\t\tthis.loadedDatesIndex[dateKey] = this.loadedDates.length;\n\t\t\tthis.loadedDates.push({\n\t\t\t\tkey: BookingUtil.formatDate(this.DATE_FORMAT, date),\n\t\t\t\tslots: {},\n\t\t\t\tslotsCount: {}\n\t\t\t});\n\t\t\tdate.setDate(date.getDate() + 1);\n\n\t\t\tif (date.getTime() > this.loadedDataTo.getTime())\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tfillDataIndex(date, time, entityType, entityId)\n\t{\n\t\tlet dateIndex = this.loadedDatesIndex[date];\n\t\tif (this.loadedDates[dateIndex])\n\t\t{\n\t\t\tif (!this.loadedDates[dateIndex].slots[time])\n\t\t\t{\n\t\t\t\tthis.loadedDates[dateIndex].slots[time] = {};\n\t\t\t}\n\t\t\tif (this.loadedDates[dateIndex].slotsCount[entityType + entityId] === undefined)\n\t\t\t{\n\t\t\t\tthis.loadedDates[dateIndex].slotsCount[entityType + entityId] = 0;\n\t\t\t}\n\t\t\tthis.loadedDates[dateIndex].slots[time][entityType + entityId] = true;\n\t\t\tthis.loadedDates[dateIndex].slotsCount[entityType + entityId]++;\n\t\t}\n\t}\n\n\thandleAccessibilityData(data, entityType)\n\t{\n\t\tif (Type.isPlainObject(data) && (entityType === 'user' || entityType === 'resource'))\n\t\t{\n\t\t\t// For each entry which has accessibility entries\n\t\t\tfor (let entityId in data)\n\t\t\t{\n\t\t\t\tif (data.hasOwnProperty(entityId))\n\t\t\t\t{\n\t\t\t\t\tdata[entityId].forEach(function(entry)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!entry.from)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentry.from = BookingUtil.parseDate(entry.dateFrom);\n\t\t\t\t\t\t\tif (entry.from)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tentry.from.setSeconds(0,0);\n\t\t\t\t\t\t\t\tentry.fromTimestamp = entry.from.getTime();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!entry.to)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentry.to = BookingUtil.parseDate(entry.dateTo);\n\t\t\t\t\t\t\tif (entry.to)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (entry.fullDay)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tentry.to.setHours(23, 59, 0, 0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tentry.to.setSeconds(0, 0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tentry.toTimestamp = entry.to.getTime();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (entry.from && entry.to)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.fillBusySlotMatrix(entry, entityType, entityId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.accessibility[entityType] = BookingUtil.mergeEx(this.accessibility[entityType], data);\n\t\t}\n\t}\n\n\tfillBusySlotMatrix(entry, entityType, entityId)\n\t{\n\t\tif (!this.busySlotMatrix[entityType][entityId])\n\t\t{\n\t\t\tthis.busySlotMatrix[entityType][entityId] = {};\n\t\t}\n\n\t\tlet\n\t\t\tfromDate = new Date(entry.from.getTime()),\n\t\t\tdateKey = BookingUtil.formatDate(this.DATE_FORMAT, fromDate),\n\t\t\tdateToKey = BookingUtil.formatDate(this.DATE_FORMAT, entry.to),\n\t\t\ttimeValueFrom = fromDate.getHours() * 60 + fromDate.getMinutes(),\n\t\t\tduration = Math.round((entry.toTimestamp - entry.fromTimestamp) / 60000), // in minutes\n\t\t\ttimeValueTo = timeValueFrom + duration,\n\t\t\tslots = this.getTimeSlots(),\n\t\t\tcount = 0,\n\t\t\ti;\n\n\t\tif (duration > 0)\n\t\t{\n\t\t\twhile (true)\n\t\t\t{\n\t\t\t\tif (!this.busySlotMatrix[entityType][entityId][dateKey])\n\t\t\t\t{\n\t\t\t\t\tthis.busySlotMatrix[entityType][entityId][dateKey] = {};\n\t\t\t\t}\n\n\t\t\t\tfor (i = 0; i < slots.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (timeValueFrom < (slots[i].time + this.scale) && timeValueTo > slots[i].time)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.busySlotMatrix[entityType][entityId][dateKey][slots[i].time] = true;\n\t\t\t\t\t\tthis.fillDataIndex(dateKey, slots[i].time, entityType, entityId);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (dateKey === dateToKey)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfromDate.setDate(fromDate.getDate() + 1);\n\t\t\t\t\tdateKey = BookingUtil.formatDate(this.DATE_FORMAT, fromDate);\n\t\t\t\t\ttimeValueFrom = 0;\n\t\t\t\t\tif (dateKey === dateToKey)\n\t\t\t\t\t{\n\t\t\t\t\t\ttimeValueTo = entry.to.getHours() * 60 + entry.to.getMinutes();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttimeValueTo = 1440; // end of the day - 24 hours\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcount++;\n\t\t\t\tif (count > 10000) // emergency exit\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetCaption()\n\t{\n\t\treturn this.params.field.caption;\n\t}\n\n\tgetSettingsData()\n\t{\n\t\treturn this.params.field.settings_data || {};\n\t}\n\n\tgetUserIndex()\n\t{\n\t\treturn this.userIndex;\n\t}\n\n\tgetFieldParams()\n\t{\n\t\treturn this.userFieldParams;\n\t}\n\n\tgetSettings()\n\t{\n\t\treturn {\n\t\t\tcaption: this.getCaption(),\n\t\t\tdata: this.getSettingsData()\n\t\t};\n\t}\n\n\tisUserSelectorInAutoMode()\n\t{\n\t\treturn this.usersDisplayed() && this.getSettingsData().users.show === \"N\";\n\t}\n\n\tisResourceSelectorInAutoMode()\n\t{\n\t\treturn this.resourcesDisplayed() && this.getSettingsData().resources.show === \"N\";\n\t}\n\n\tautoAdjustUserSelector()\n\t{\n\t\tlet\n\t\t\tcurrentDate = this.dateControl.getValue(),\n\t\t\ttimeValue = this.timeControl.getValue();\n\n\t\tif (Type.isDate(currentDate) && timeValue)\n\t\t{\n\t\t\tlet i, loadedDate = this.loadedDates[this.loadedDatesIndex[BookingUtil.formatDate(this.DATE_FORMAT, currentDate)]];\n\t\t\tif (loadedDate.slots[timeValue])\n\t\t\t{\n\t\t\t\tfor (i = 0; i < this.userControl.values.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (!loadedDate.slots[timeValue]['user' + this.userControl.values[i]])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userControl.setSelectedUser(this.userControl.values[i]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tautoAdjustResourceSelector()\n\t{\n\t\tlet\n\t\t\tcurrentDate = this.dateControl.getValue(),\n\t\t\ttimeValue = this.timeControl.getValue();\n\n\t\tif (Type.isDate(currentDate) && timeValue)\n\t\t{\n\t\t\tlet\n\t\t\t\ti, id,\n\t\t\t\tloadedDate = this.loadedDates[this.loadedDatesIndex[BookingUtil.formatDate(this.DATE_FORMAT, currentDate)]];\n\n\t\t\tif (loadedDate.slots[timeValue])\n\t\t\t{\n\t\t\t\tfor (i = 0; i < this.resourceControl.resourceList.length; i++)\n\t\t\t\t{\n\t\t\t\t\tid = parseInt(this.resourceControl.resourceList[i].id);\n\t\t\t\t\tif (!loadedDate.slots[timeValue]['resource' + id])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.resourceControl.setSelectedResource(id);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpreparaAutoSelectValues ()\n\t{\n\t\tlet\n\t\t\tsettingsData = this.getSettingsData(),\n\t\t\tautoSelectUser = this.usersDisplayed() && (settingsData.users.defaultMode === 'auto' || settingsData.users.show === \"N\"),\n\t\t\tautoSelectResource = this.resourcesDisplayed() && (settingsData.resources.defaultMode === 'auto' || settingsData.resources.show === \"N\"),\n\t\t\tautoSelectDate = settingsData.date.start === 'free',\n\t\t\tmaxStepsAuto = 60,\n\t\t\tdate, i;\n\n\t\tthis.selectedUserId = false;\n\t\tthis.selectedResourceId = false;\n\n\t\tdate = new Date();\n\t\t// Walk through each date searching for free space\n\t\tfor (i = 0; i <= maxStepsAuto; i++)\n\t\t{\n\t\t\tthis.getFreeEntitiesForDate(date, {\n\t\t\t\tautoSelectUser: autoSelectUser,\n\t\t\t\tautoSelectResource: autoSelectResource,\n\t\t\t\tslotsAmount: this.getDefaultDurationSlotsAmount()\n\t\t\t});\n\n\t\t\tif ((this.selectedUserId || !autoSelectUser)\n\t\t\t\t&&\n\t\t\t\t(this.selectedResourceId || !autoSelectResource))\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (!autoSelectDate)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdate.setDate(date.getDate() + 1);\n\t\t}\n\t}\n\n\tgetFreeEntitiesForDate(date, params)\n\t{\n\t\tlet\n\t\t\tsettingsData = this.getSettingsData(),\n\t\t\tslotsAmount = params.slotsAmount || 1,\n\t\t\ti, userList, resList;\n\n\t\tif (params.autoSelectUser)\n\t\t{\n\t\t\tuserList = this.getUsersValue();\n\t\t\tfor (i = 0; i < userList.length; i++)\n\t\t\t{\n\t\t\t\tif (this.checkSlotsForDate(date, slotsAmount, {\n\t\t\t\t\tuser: parseInt(userList[i])\n\t\t\t\t}))\n\t\t\t\t{\n\t\t\t\t\tthis.selectedUserId = parseInt(userList[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (params.autoSelectResource)\n\t\t{\n\t\t\tresList = this.getResourceValue();\n\t\t\tfor (i = 0; i < resList.length; i++)\n\t\t\t{\n\t\t\t\tif (this.checkSlotsForDate(date, slotsAmount, {\n\t\t\t\t\tresources: [parseInt(resList[i])],\n\t\t\t\t\tuser: this.selectedUserId || null\n\t\t\t\t}))\n\t\t\t\t{\n\t\t\t\t\tthis.selectedResourceId = parseInt(resList[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdisplayUsersControl()\n\t{\n\t\tif (this.usersDisplayed())\n\t\t{\n\t\t\tthis.userControl = new UserSelector({\n\t\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\t\tdata: this.getSettingsData().users,\n\t\t\t\tuserIndex: this.getUserIndex(),\n\t\t\t\tpreviewMode: false,\n\t\t\t\tautoSelectDefaultValue: this.selectedUserId,\n\t\t\t\tchangeValueCallback: function(userId)\n\t\t\t\t{\n\t\t\t\t\tthis.emit('BX.Calendar.Resourcebooking.LiveFieldController:userChanged', new BaseEvent({data: {userId: userId}}));\n\t\t\t\t\tthis.refreshControlsState();\n\t\t\t\t}.bind(this)\n\t\t\t});\n\t\t\tthis.userControl.display();\n\t\t}\n\t}\n\n\tdisplayResourcesControl()\n\t{\n\t\tlet\n\t\t\tvalueIndex = {},\n\t\t\tdataValue = [],\n\t\t\tfieldParams = this.getFieldParams(),\n\t\t\tsettingsData = this.getSettingsData();\n\n\t\tif (this.resourcesDisplayed())\n\t\t{\n\t\t\tthis.getResourceValue().forEach(function(id)\n\t\t\t{\n\t\t\t\tid = parseInt(id);\n\t\t\t\tif (id > 0)\n\t\t\t\t{\n\t\t\t\t\tvalueIndex[id] = true;\n\t\t\t\t\tdataValue.push(id);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet resourceList = [];\n\t\t\tfieldParams.SELECTED_RESOURCES.forEach(function(res)\n\t\t\t{\n\t\t\t\tres.id = parseInt(res.id);\n\t\t\t\tif (valueIndex[res.id])\n\t\t\t\t{\n\t\t\t\t\tresourceList.push(res);\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tthis.resourceControl = new ResourceSelector({\n\t\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\t\tdata: {\n\t\t\t\t\tshow: settingsData.resources.show,\n\t\t\t\t\tdefaultMode: settingsData.resources.defaultMode,\n\t\t\t\t\tlabel: settingsData.resources.label,\n\t\t\t\t\tmultiple: settingsData.resources.multiple,\n\t\t\t\t\tvalue: settingsData.resources.value\n\t\t\t\t},\n\t\t\t\tresourceList: resourceList,\n\t\t\t\tautoSelectDefaultValue: this.selectedResourceId,\n\t\t\t\tchangeValueCallback: function()\n\t\t\t\t{\n\t\t\t\t\tthis.emit('BX.Calendar.Resourcebooking.LiveFieldController:resourceChanged');\n\t\t\t\t\tthis.refreshControlsState();\n\t\t\t\t}.bind(this)\n\t\t\t});\n\n\t\t\tif (this.selectorCanBeShown('resources'))\n\t\t\t{\n\t\t\t\tthis.resourceControl.display();\n\t\t\t}\n\t\t}\n\t}\n\n\tdisplayServicesControl()\n\t{\n\t\tlet\n\t\t\tfieldParams = this.getFieldParams(),\n\t\t\tsettingsData = this.getSettingsData();\n\n\t\tif (fieldParams.USE_SERVICES === 'Y' && settingsData.services.value)\n\t\t{\n\t\t\tlet dataValueRaw = this.getServicesValue();\n\n\t\t\tthis.serviceControl = new ServiceSelector({\n\t\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\t\tdata: settingsData.services,\n\t\t\t\tserviceList: fieldParams.SERVICE_LIST,\n\t\t\t\tselectedValue: dataValueRaw.length > 0 ? dataValueRaw[0] : null,\n\t\t\t\tchangeValueCallback: function()\n\t\t\t\t{\n\t\t\t\t\tthis.emit('BX.Calendar.Resourcebooking.LiveFieldController:serviceChanged');\n\t\t\t\t\tthis.refreshControlsState();\n\t\t\t\t}.bind(this)\n\t\t\t});\n\n\t\t\tif (this.selectorCanBeShown('services'))\n\t\t\t{\n\t\t\t\tthis.serviceControl.display();\n\t\t\t}\n\t\t}\n\t}\n\n\tdisplayDurationControl()\n\t{\n\t\tlet\n\t\t\tfieldParams = this.getFieldParams(),\n\t\t\tsettingsData = this.getSettingsData();\n\n\t\tif (!this.serviceControl)\n\t\t{\n\t\t\tthis.durationControl = new DurationSelector({\n\t\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\t\tdata: settingsData.duration,\n\t\t\t\tfullDay: fieldParams.FULL_DAY === 'Y',\n\t\t\t\tchangeValueCallback: function()\n\t\t\t\t{\n\t\t\t\t\tthis.emit('BX.Calendar.Resourcebooking.LiveFieldController:durationChanged');\n\t\t\t\t\tthis.refreshControlsState();\n\t\t\t\t}.bind(this)\n\t\t\t});\n\n\t\t\tif (this.selectorCanBeShown('duration'))\n\t\t\t{\n\t\t\t\tthis.durationControl.display();\n\t\t\t}\n\t\t}\n\t}\n\n\tdisplayDateTimeControl()\n\t{\n\t\tlet\n\t\t\ttimezone = false,\n\t\t\tstartValue = null,\n\t\t\tsettingsData = this.getSettingsData(),\n\t\t\tfieldParams = this.getFieldParams();\n\n\t\tthis.dateControl = new DateSelector({\n\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\tdata: settingsData.date,\n\t\t\tpreviewMode: false,\n\t\t\tallowOverbooking: fieldParams.ALLOW_OVERBOOKING === \"Y\",\n\t\t\tchangeValueCallback: this.handleDateChanging.bind(this),\n\t\t\trequestDataCallback: this.requestAccessibilityData.bind(this)\n\t\t});\n\n\t\tif (this.timeSelectorDisplayed())\n\t\t{\n\t\t\tif (fieldParams.USE_USER_TIMEZONE === 'N')\n\t\t\t{\n\t\t\t\tlet userTimezoneOffset = -(new Date).getTimezoneOffset()*60;\n\t\t\t\tif (userTimezoneOffset !== this.timezoneOffset)\n\t\t\t\t{\n\t\t\t\t\ttimezone = fieldParams.TIMEZONE;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.timeControl = new TimeSelector({\n\t\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\t\tdata: settingsData.time,\n\t\t\t\tpreviewMode: false,\n\t\t\t\tchangeValueCallback: this.handleSelectedDateTimeChanging.bind(this),\n\t\t\t\ttimeFrom: this.timeFrom,\n\t\t\t\ttimeTo: this.timeTo,\n\t\t\t\ttimezone: timezone,\n\t\t\t\ttimezoneOffset: this.timezoneOffset,\n\t\t\t\ttimezoneOffsetLabel: this.timezoneOffsetLabel\n\t\t\t});\n\t\t}\n\n\t\tthis.statusControl = new StatusInformer({\n\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\ttimezone: timezone,\n\t\t\ttimezoneOffsetLabel: this.timezoneOffsetLabel\n\t\t});\n\n\t\tif (this.selectorCanBeShown('date'))\n\t\t{\n\t\t\tthis.statusControl.show();\n\t\t\tif (settingsData.date.start === 'free')\n\t\t\t{\n\t\t\t\tstartValue = this.getFreeDate({\n\t\t\t\t\tresources: this.getSelectedResources(),\n\t\t\t\t\tuser: this.getSelectedUser(),\n\t\t\t\t\tduration: this.getCurrentDuration()\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.dateControl.display({\n\t\t\t\tselectedValue: startValue\n\t\t\t});\n\n\t\t\tif (this.timeControl && !this.timeControl.isShown())\n\t\t\t{\n\t\t\t\tthis.timeControl.display();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.statusControl.hide();\n\t\t}\n\t}\n\n\thandleDateChanging(date, realDate)\n\t{\n\t\tthis.emit('BX.Calendar.Resourcebooking.LiveFieldController:dateChanged');\n\n\t\tif (this.timeSelectorDisplayed())\n\t\t{\n\t\t\tif (realDate)\n\t\t\t{\n\t\t\t\tthis.timeControl.show();\n\t\t\t\tlet\n\t\t\t\t\ttimeValueFrom,\n\t\t\t\t\tcurrentDate = this.getCurrentDate();\n\n\t\t\t\tif (currentDate)\n\t\t\t\t{\n\t\t\t\t\ttimeValueFrom = currentDate.getHours() * 60 + currentDate.getMinutes();\n\t\t\t\t}\n\n\t\t\t\tthis.timeControl.refresh(\n\t\t\t\t\tthis.getSettingsData().time,\n\t\t\t\t\t{\n\t\t\t\t\t\tslotIndex: this.getSlotIndex({date: realDate}),\n\t\t\t\t\t\tcurrentDate: realDate,\n\t\t\t\t\t\tselectedValue: timeValueFrom\n\t\t\t\t\t});\n\n\t\t\t\t// this.timeControl.refresh(\n\t\t\t\t// \tthis.getSettingsData().time,\n\t\t\t\t// \t{\n\t\t\t\t// \t\tslotIndex: this.getAvailableSlotIndex({\n\t\t\t\t// \t\t\tdate: realDate,\n\t\t\t\t// \t\t\tresources: this.getSelectedResources(),\n\t\t\t\t// \t\t\tuser: this.getSelectedUser(),\n\t\t\t\t// \t\t\tduration: this.getCurrentDuration()\n\t\t\t\t// \t\t}),\n\t\t\t\t// \t\tcurrentDate: realDate,\n\t\t\t\t// \t\tselectedValue: timeValueFrom\n\t\t\t\t// \t});\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.handleSelectedDateTimeChanging(null, true);\n\t\t}\n\t\tthis.onChangeValues();\n\t}\n\n\thandleSelectedDateTimeChanging(value, useTimeout)\n\t{\n\t\tif (useTimeout !== false)\n\t\t{\n\t\t\tif (this.updateTimeStatusTimeout)\n\t\t\t{\n\t\t\t\tthis.updateTimeStatusTimeout = clearTimeout(this.updateTimeStatusTimeout);\n\t\t\t}\n\t\t\tthis.updateTimeStatusTimeout = setTimeout(function(){\n\t\t\t\tthis.handleSelectedDateTimeChanging(value, false);\n\t\t\t}.bind(this), 100);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.isUserSelectorInAutoMode())\n\t\t\t{\n\t\t\t\tthis.autoAdjustUserSelector();\n\t\t\t}\n\t\t\tif (this.isResourceSelectorInAutoMode())\n\t\t\t{\n\t\t\t\tthis.autoAdjustResourceSelector();\n\t\t\t}\n\n\t\t\tthis.updateStatusControl();\n\t\t\tBookingUtil.fireCustomEvent(window, 'crmWebFormFireResize');\n\t\t}\n\t\tthis.onChangeValues();\n\t}\n\n\tupdateStatusControl()\n\t{\n\t\tif (this.statusControl && this.selectorCanBeShown('date'))\n\t\t{\n\t\t\tlet currentDate = this.getCurrentDate();\n\t\t\tif (this.dateControl.isItPastDate(currentDate))\n\t\t\t{\n\t\t\t\tthis.statusControl.setError(Loc.getMessage('WEBF_RES_BOOKING_PAST_DATE_WARNING'));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.timeSelectorDisplayed())\n\t\t\t\t{\n\t\t\t\t\tif (this.timeControl.hasAvailableSlots())\n\t\t\t\t\t{\n\t\t\t\t\t\tlet timeValue = this.timeControl.getValue();\n\t\t\t\t\t\tthis.statusControl.refresh({\n\t\t\t\t\t\t\tdateFrom: timeValue ? currentDate : null,\n\t\t\t\t\t\t\tduration: timeValue ? this.getCurrentDuration() : null,\n\t\t\t\t\t\t\tfullDay: false\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.statusControl.hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.statusControl.refresh({\n\t\t\t\t\t\tdateFrom: this.dateControl.isDateAvailable(currentDate) ? currentDate : null,\n\t\t\t\t\t\tduration: this.getCurrentDuration(),\n\t\t\t\t\t\tfullDay: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFreeDate(params)\n\t{\n\t\tlet\n\t\t\tslotsAmount = Math.ceil(params.duration / this.scale),\n\t\t\tfreeDate = null,\n\t\t\tdate = this.loadedDataFrom;\n\n\t\t// Walk through each date searching for free space\n\t\twhile (true)\n\t\t{\n\t\t\tif (this.checkSlotsForDate(date, slotsAmount, {\n\t\t\t\tresources: params.resources,\n\t\t\t\tuser: params.user\n\t\t\t}))\n\t\t\t{\n\t\t\t\tfreeDate = date;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdate.setDate(date.getDate() + 1);\n\t\t\tif (date.getTime() >= this.loadedDataTo.getTime())\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn freeDate;\n\t}\n\n\tgetAvailableDateIndex(params)\n\t{\n\t\tlet\n\t\t\tuserIsFree, resourcesAreFree,\n\t\t\tdateIndex = {};\n\n\t\tif (this.timeSelectorDisplayed())\n\t\t{\n\t\t\tlet slotsAmount = Math.ceil(params.duration / this.scale);\n\n\t\t\tthis.loadedDates.forEach(function(date)\n\t\t\t{\n\t\t\t\tdateIndex[date.key] = this.checkSlotsForDate(date.key, slotsAmount, {\n\t\t\t\t\tresources: params.resources,\n\t\t\t\t\tuser: params.user\n\t\t\t\t});\n\t\t\t}, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet\n\t\t\t\ti, daysGap, date, j,\n\t\t\t\tuserKey = params.user ? 'user' + params.user : null,\n\t\t\t\tdaysAmount = Math.ceil(params.duration / 1440);\n\n\t\t\tdaysGap = 1;\n\t\t\tfor (i = this.loadedDates.length; i--; i >= 0)\n\t\t\t{\n\t\t\t\tuserIsFree = true;\n\t\t\t\tresourcesAreFree = true;\n\t\t\t\tdate = this.loadedDates[i];\n\n\t\t\t\tif (userKey)\n\t\t\t\t{\n\t\t\t\t\t// All day is free for user\n\t\t\t\t\tuserIsFree = !date.slotsCount[userKey];\n\t\t\t\t}\n\n\t\t\t\tif (userIsFree && params.resources && params.resources.length > 0)\n\t\t\t\t{\n\t\t\t\t\tfor (j = 0; j < params.resources.length; j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tresourcesAreFree = resourcesAreFree && !date.slotsCount['resource' + params.resources[j]];\n\t\t\t\t\t\tif (!resourcesAreFree)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (userIsFree && resourcesAreFree)\n\t\t\t\t{\n\t\t\t\t\tdaysGap++;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdaysGap = 0;\n\t\t\t\t}\n\n\t\t\t\tdateIndex[date.key] = userIsFree && resourcesAreFree && daysAmount <= daysGap;\n\t\t\t}\n\t\t}\n\n\t\treturn dateIndex;\n\t}\n\n\tgetSlotIndex(params)\n\t{\n\t\tif (params.date)\n\t\t{\n\t\t\tparams.date = this.dateControl.getValue();\n\t\t}\n\n\t\tlet slotIndex = {};\n\n\t\tif (Type.isDate(params.date))\n\t\t{\n\t\t\tif (this.getFieldParams().ALLOW_OVERBOOKING !== \"Y\"\n\t\t\t\t&& (this.isUserSelectorInAutoMode() || this.isResourceSelectorInAutoMode()))\n\t\t\t{\n\t\t\t\tlet\n\t\t\t\t\tfreeSlot,\n\t\t\t\t\ti, j, time,\n\t\t\t\t\tsettingsData = this.getSettingsData(),\n\t\t\t\t\tslotGap = 1,\n\t\t\t\t\ttodayNowTime = 0,\n\t\t\t\t\ttimeSlots = this.getTimeSlots(),\n\t\t\t\t\tdateKey = BookingUtil.formatDate(this.DATE_FORMAT, params.date),\n\t\t\t\t\tloadedDate = this.loadedDates[this.loadedDatesIndex[dateKey]],\n\t\t\t\t\tslotsAmount = Math.ceil(this.getCurrentDuration() / this.scale);\n\n\t\t\t\tif (this.checkIsTodayDate(dateKey))\n\t\t\t\t{\n\t\t\t\t\tlet today = new Date();\n\t\t\t\t\ttodayNowTime = today.getHours() * 60 + today.getMinutes();\n\t\t\t\t}\n\n\t\t\t\t// Prefill slotIndex\n\t\t\t\ttimeSlots.forEach(function(slot){slotIndex[slot.time] = true;}, this);\n\n\t\t\t\tif (this.isUserSelectorInAutoMode())\n\t\t\t\t{\n\t\t\t\t\tconst userList = this.getUsersValue();\n\n\t\t\t\t\tfor (i = timeSlots.length; i--; i >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ttime = timeSlots[i].time;\n\t\t\t\t\t\tfreeSlot = false;\n\n\t\t\t\t\t\tif (todayNowTime && time < todayNowTime)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tslotIndex[time] = false;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfor (j = 0; j < userList.length; j++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!loadedDate.slots[time]\n\t\t\t\t\t\t\t\t|| !loadedDate.slots[time]['user' + userList[j]])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfreeSlot = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tslotIndex[time] = slotIndex[time] && freeSlot && slotsAmount <= slotGap;\n\t\t\t\t\t\tslotGap = freeSlot ? slotGap + 1 : 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.isResourceSelectorInAutoMode())\n\t\t\t\t{\n\t\t\t\t\tconst resList = this.getResourceValue();\n\t\t\t\t\tfor (i = timeSlots.length; i--; i >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ttime = timeSlots[i].time;\n\t\t\t\t\t\tfreeSlot = false;\n\n\t\t\t\t\t\tif (todayNowTime && time < todayNowTime)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tslotIndex[time] = false;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfor (j = 0; j < resList.length; j++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!loadedDate.slots[time]\n\t\t\t\t\t\t\t\t|| !loadedDate.slots[time]['resource' + resList[j]])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfreeSlot = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tslotIndex[time] = slotIndex[time] && freeSlot && slotsAmount <= slotGap;\n\t\t\t\t\t\tslotGap = freeSlot ? slotGap + 1 : 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tslotIndex =  this.getAvailableSlotIndex({\n\t\t\t\t\tdate: params.date || this.dateControl.getValue(),\n\t\t\t\t\tresources: this.getSelectedResources(),\n\t\t\t\t\tuser: this.getSelectedUser(),\n\t\t\t\t\tduration: this.getCurrentDuration()\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\treturn slotIndex;\n\t}\n\n\tgetAvailableSlotIndex(params)\n\t{\n\t\tlet\n\t\t\tdateKey, loadedDate, i, j, time,\n\t\t\ttodayNowTime = 0,\n\t\t\tslotGap,\n\t\t\tuserKey = params.user ? 'user' + params.user : null,\n\t\t\tslotsAmount = Math.ceil(params.duration / this.scale),\n\t\t\tuserIsFree, resourcesAreFree,\n\t\t\ttimeSlots = this.getTimeSlots(),\n\t\t\tallowOverbooking = this.getFieldParams().ALLOW_OVERBOOKING === \"Y\",\n\t\t\tslotIndex = {};\n\n\t\t// Prefill slotIndex\n\t\ttimeSlots.forEach(function(slot){slotIndex[slot.time] = true;}, this);\n\n\t\tif (Type.isDate(params.date))\n\t\t{\n\t\t\tdateKey = BookingUtil.formatDate(this.DATE_FORMAT, params.date);\n\t\t\tloadedDate = this.loadedDates[this.loadedDatesIndex[dateKey]];\n\t\t\tslotGap = 1;\n\n\t\t\tif (this.checkIsTodayDate(dateKey))\n\t\t\t{\n\t\t\t\tlet today = new Date();\n\t\t\t\ttodayNowTime = today.getHours() * 60 + today.getMinutes();\n\t\t\t}\n\n\t\t\tfor (i = timeSlots.length; i--; i >= 0)\n\t\t\t{\n\t\t\t\ttime = timeSlots[i].time;\n\t\t\t\tif (todayNowTime && time < todayNowTime)\n\t\t\t\t{\n\t\t\t\t\tslotIndex[time] = false;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (allowOverbooking)\n\t\t\t\t{\n\t\t\t\t\tslotIndex[time] = slotsAmount <= slotGap;\n\t\t\t\t\tslotGap++;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuserIsFree = true;\n\t\t\t\t\tresourcesAreFree = true;\n\n\t\t\t\t\tif (userKey)\n\t\t\t\t\t{\n\t\t\t\t\t\t// Time is free for user\n\t\t\t\t\t\tuserIsFree = !loadedDate.slots[time] || !loadedDate.slots[time][userKey];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (params.resources && params.resources.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tfor (j = 0; j < params.resources.length; j++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresourcesAreFree = resourcesAreFree && (!loadedDate.slots[time] || !loadedDate.slots[time]['resource' + params.resources[j]]);\n\n\t\t\t\t\t\t\tif (!resourcesAreFree)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tslotIndex[time] = userIsFree && resourcesAreFree && slotsAmount <= slotGap;\n\n\t\t\t\t\tif (userIsFree && resourcesAreFree)\n\t\t\t\t\t{\n\t\t\t\t\t\tslotGap++;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tslotGap = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn slotIndex;\n\t}\n\n\tcheckSlotsForDate(date, slotsAmount, params)\n\t{\n\t\tlet\n\t\t\tuserIsFree = true,\n\t\t\tresourcesAreFree = true,\n\t\t\tdateKey = Type.isDate(date) ? BookingUtil.formatDate(this.DATE_FORMAT, date) : date;\n\n\t\tparams = params || {};\n\t\tif (this.usersDisplayed() && params.user)\n\t\t{\n\t\t\tif (this.busySlotMatrix.user[params.user]\n\t\t\t\t&& !this.entityHasSlotsForDate({\n\t\t\t\t\tentityType: 'user',\n\t\t\t\t\tentityId: params.user,\n\t\t\t\t\tdateKey: dateKey,\n\t\t\t\t\tslotsAmount: slotsAmount\n\t\t\t\t})\n\t\t\t)\n\t\t\t{\n\t\t\t\tuserIsFree = false;\n\t\t\t}\n\t\t}\n\n\t\tif (this.resourcesDisplayed() && userIsFree\n\t\t\t&& Type.isArray(params.resources) && params.resources.length  > 0)\n\t\t{\n\t\t\tparams.resources.forEach(function(resourceId)\n\t\t\t{\n\t\t\t\tif (resourcesAreFree\n\t\t\t\t\t&& this.busySlotMatrix.resource[resourceId]\n\t\t\t\t\t&& !this.entityHasSlotsForDate({\n\t\t\t\t\t\tentityType: 'resource',\n\t\t\t\t\t\tentityId: resourceId,\n\t\t\t\t\t\tdateKey: dateKey,\n\t\t\t\t\t\tslotsAmount: slotsAmount\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tresourcesAreFree = false;\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\treturn userIsFree && resourcesAreFree;\n\t}\n\n\tentityHasSlotsForDate(params)\n\t{\n\t\tlet\n\t\t\tbusySlotList,\n\t\t\tslots, i,\n\t\t\tfreeSlotCount = 0,\n\t\t\thasFreeSlots = false;\n\n\t\tif (this.busySlotMatrix[params.entityType][params.entityId] &&\n\t\t\tthis.busySlotMatrix[params.entityType][params.entityId][params.dateKey])\n\t\t{\n\t\t\tbusySlotList = this.busySlotMatrix[params.entityType][params.entityId][params.dateKey];\n\t\t\tslots = this.getTimeSlots();\n\t\t\tfor (i = 0; i < slots.length; i++)\n\t\t\t{\n\t\t\t\tif (!busySlotList[slots[i].time])\n\t\t\t\t{\n\t\t\t\t\tfreeSlotCount++;\n\t\t\t\t\tif (freeSlotCount >= params.slotsAmount)\n\t\t\t\t\t{\n\t\t\t\t\t\thasFreeSlots = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfreeSlotCount = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\thasFreeSlots = true;\n\t\t}\n\n\t\treturn hasFreeSlots;\n\t}\n\n\tgetSelectedResources()\n\t{\n\t\tlet result = null;\n\t\tif (this.resourceControl)\n\t\t{\n\t\t\tresult = this.resourceControl.getSelectedValues();\n\t\t\tif (Type.isArray(result) && !result.length)\n\t\t\t{\n\t\t\t\tresult = null;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\n\tgetSelectedUser()\n\t{\n\t\tlet result = null;\n\t\tif (this.userControl)\n\t\t{\n\t\t\tresult = this.userControl.getSelectedUser();\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetCurrentDuration()\n\t{\n\t\tlet result = null;\n\t\tif (this.durationControl)\n\t\t{\n\t\t\tresult = this.durationControl.getSelectedValue();\n\t\t}\n\t\telse if (this.serviceControl)\n\t\t{\n\t\t\tlet service = this.serviceControl.getSelectedService(true);\n\t\t\tif (service && service.duration)\n\t\t\t{\n\t\t\t\tresult = parseInt(service.duration);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetDefaultDurationSlotsAmount()\n\t{\n\t\tlet\n\t\t\tsettingsData = this.getSettingsData(),\n\t\t\tfieldParams = this.getFieldParams(),\n\t\t\tduration, i, slotsAmount;\n\n\t\tif (fieldParams.USE_SERVICES === 'Y' && settingsData.services.value)\n\t\t{\n\t\t\tconst services = this.getServicesValue();\n\t\t\tif (Type.isArray(fieldParams.SERVICE_LIST) && services.length > 0)\n\t\t\t{\n\t\t\t\tfor (i = 0; i < fieldParams.SERVICE_LIST.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (BookingUtil.translit(fieldParams.SERVICE_LIST[i].name) === services[0])\n\t\t\t\t\t{\n\t\t\t\t\t\tduration = parseInt(fieldParams.SERVICE_LIST[i].duration);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tduration = parseInt(settingsData.duration.defaultValue);\n\t\t}\n\n\t\tslotsAmount = Math.ceil(duration / this.scale);\n\t\treturn slotsAmount;\n\t}\n\n\tgetCurrentServiceName()\n\t{\n\t\tlet result = '';\n\t\tif (this.serviceControl)\n\t\t{\n\t\t\tlet service = this.serviceControl.getSelectedService(true);\n\t\t\tif (service && service.name)\n\t\t\t{\n\t\t\t\tresult = service.name;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetCurrentDate()\n\t{\n\t\tlet result = null;\n\t\tif (this.dateControl && this.dateControl.isShown())\n\t\t{\n\t\t\tresult = this.dateControl.getValue();\n\t\t\tif (this.timeSelectorDisplayed())\n\t\t\t{\n\t\t\t\tlet\n\t\t\t\t\thour, min,\n\t\t\t\t\ttimeValue = this.timeControl.getValue();\n\n\t\t\t\tif (timeValue)\n\t\t\t\t{\n\t\t\t\t\thour = Math.floor(timeValue / 60);\n\t\t\t\t\tmin = timeValue - hour * 60;\n\t\t\t\t\tresult.setHours(hour, min, 0, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.setHours(0, 0, 0, 0);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetTimeSlots()\n\t{\n\t\tif (!this.slots)\n\t\t{\n\t\t\tthis.slots = [];\n\t\t\tlet slot;\n\t\t\tlet finishTime, hourFrom,  hourTo;\n\t\t\tlet minTo, minFrom;\n\t\t\tlet num = 0;\n\t\t\tlet time = this.timeFrom * 60;\n\n\t\t\twhile (time < this.timeTo * 60)\n\t\t\t{\n\t\t\t\thourFrom = Math.floor(time / 60);\n\t\t\t\tminFrom = (time) - hourFrom * 60;\n\t\t\t\tfinishTime = time + this.scale;\n\t\t\t\thourTo = Math.floor(finishTime / 60);\n\t\t\t\tminTo = (finishTime) - hourTo * 60;\n\n\t\t\t\tslot = {\n\t\t\t\t\ttime: time\n\t\t\t\t};\n\n\t\t\t\tthis.slots.push(slot);\n\t\t\t\ttime += this.scale;\n\t\t\t\tnum++;\n\t\t\t}\n\t\t}\n\t\treturn this.slots;\n\t}\n\n\tusersDisplayed()\n\t{\n\t\tif (this.useUsers === undefined)\n\t\t{\n\t\t\tthis.useUsers = this.getFieldParams()['USE_USERS'] === 'Y';\n\t\t}\n\t\treturn this.useUsers;\n\t}\n\n\tresourcesDisplayed()\n\t{\n\t\tif (this.useResources === undefined)\n\t\t{\n\t\t\tlet fieldParams = this.getFieldParams();\n\t\t\tthis.useResources = !!(fieldParams.USE_RESOURCES === 'Y'\n\t\t\t\t&& fieldParams.SELECTED_RESOURCES);\n\t\t}\n\t\treturn this.useResources;\n\t}\n\n\ttimeSelectorDisplayed()\n\t{\n\t\tif (this.useTime === undefined)\n\t\t{\n\t\t\tthis.useTime = this.getFieldParams().FULL_DAY !== 'Y';\n\t\t}\n\t\treturn this.useTime;\n\t}\n\n\tselectorCanBeShown(type)\n\t{\n\t\tlet result = false;\n\t\tif (type === 'resources')\n\t\t{\n\t\t\tif (this.resourcesDisplayed() && !this.usersDisplayed())\n\t\t\t{\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t\telse if (this.usersDisplayed())\n\t\t\t{\n\t\t\t\tresult = this.getSelectedUser();\n\t\t\t}\n\t\t}\n\t\telse if (type === 'date' || type === 'services' || type === 'duration')\n\t\t{\n\t\t\tif (this.usersDisplayed() && this.resourcesDisplayed())\n\t\t\t{\n\t\t\t\tresult = this.getSelectedUser() && this.getSelectedResources();\n\t\t\t}\n\t\t\telse if (this.usersDisplayed())\n\t\t\t{\n\t\t\t\tresult = this.getSelectedUser();\n\t\t\t}\n\t\t\telse if (this.resourcesDisplayed())\n\t\t\t{\n\t\t\t\tresult = this.getSelectedResources();\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tcheckIsTodayDate(dateKey)\n\t{\n\t\tif (!this.todayDateKey)\n\t\t{\n\t\t\tlet today = new Date();\n\t\t\tthis.todayDateKey = BookingUtil.formatDate(this.DATE_FORMAT, today);\n\t\t}\n\t\treturn this.todayDateKey === dateKey;\n\t}\n\n\tgetResourceValue()\n\t{\n\t\tconst settingsData = this.getSettingsData();\n\t\tlet value = [];\n\t\tif (Type.isArray(settingsData.resources.value))\n\t\t{\n\t\t\tvalue = settingsData.resources.value;\n\t\t}\n\t\telse if (Type.isString(settingsData.resources.value))\n\t\t{\n\t\t\tvalue = settingsData.resources.value.split('|');\n\t\t}\n\t\treturn value;\n\t}\n\n\tgetUsersValue()\n\t{\n\t\tconst settingsData = this.getSettingsData();\n\t\tlet value = [];\n\t\tif (Type.isArray(settingsData.users.value))\n\t\t{\n\t\t\tvalue = settingsData.users.value;\n\t\t}\n\t\telse if (Type.isString(settingsData.users.value))\n\t\t{\n\t\t\tvalue = settingsData.users.value.split('|');\n\t\t}\n\t\treturn value;\n\t}\n\n\tgetServicesValue()\n\t{\n\t\tconst settingsData = this.getSettingsData();\n\t\tlet value = [];\n\t\tif (Type.isArray(settingsData.services.value))\n\t\t{\n\t\t\tvalue = settingsData.services.value;\n\t\t}\n\t\telse if (Type.isString(settingsData.services.value))\n\t\t{\n\t\t\tvalue = settingsData.services.value.split('|');\n\t\t}\n\t\treturn value;\n\t}\n}","import {Loc} from \"./resourcebooking\";\n\nexport class Translit\n{\n\tstatic replacementCharTable = null;\n\n\tstatic run (str)\n\t{\n\t\tlet\n\t\t\treplaceChar = '_',\n\t\t\tregexpEnChars = /[A-Z0-9]/i,\n\t\t\tregexpSpace = /\\s/,\n\t\t\tmaxLength = 100,\n\t\t\tlen = str.length,\n\t\t\tresult = '',\n\t\t\tlastNewChar = '',\n\t\t\ti;\n\n\t\tfor (i = 0; i < len; i++)\n\t\t{\n\t\t\tlet\n\t\t\t\tnewChar,\n\t\t\t\tchr = str.charAt(i);\n\n\t\t\tif (regexpEnChars.test(chr))\n\t\t\t{\n\t\t\t\tnewChar = chr;\n\t\t\t}\n\t\t\telse if (regexpSpace.test(chr))\n\t\t\t{\n\t\t\t\tif (i > 0 && lastNewChar !== replaceChar)\n\t\t\t\t{\n\t\t\t\t\tnewChar = replaceChar;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnewChar = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnewChar = Translit.getChar(chr);\n\n\t\t\t\tif (newChar === null)\n\t\t\t\t{\n\t\t\t\t\tif (i > 0 && i !== len - 1 && lastNewChar !== replaceChar)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewChar = replaceChar;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tnewChar = '';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (null != newChar && newChar.length > 0)\n\t\t\t{\n\t\t\t\tnewChar = newChar.toLowerCase();\n\t\t\t\tresult += newChar;\n\t\t\t\tlastNewChar = newChar;\n\t\t\t}\n\n\t\t\tif (result.length >= maxLength)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic generateReplacementCharTable()\n\t{\n\t\tlet\n\t\t\tseparator = ',',\n\t\t\tcharTableFrom = (Loc.getMessage('TRANSLIT_FROM') || '').split(separator),\n\t\t\tcharTableTo = (Loc.getMessage('TRANSLIT_TO') || '').split(separator),\n\t\t\ti, len;\n\n\t\tTranslit.replacementCharTable = [];\n\t\tfor (i = 0, len = charTableFrom.length; i < len; i++)\n\t\t{\n\t\t\tTranslit.replacementCharTable[i] = [charTableFrom[i], charTableTo[i]];\n\t\t}\n\t}\n\n\tstatic getChar(chr)\n\t{\n\t\tif (Translit.replacementCharTable === null)\n\t\t{\n\t\t\tTranslit.generateReplacementCharTable();\n\t\t}\n\n\t\tfor (let i = 0, len = Translit.replacementCharTable.length; i < len; i++)\n\t\t{\n\t\t\tif (chr === Translit.replacementCharTable[i][0])\n\t\t\t{\n\t\t\t\treturn Translit.replacementCharTable[i][1];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n}","import {Type, Loc, Tag, Runtime, CoreDate} from \"./resourcebooking\";\nimport {Translit} from \"./translit\";\n\nexport class BookingUtil {\n\tstatic simpleTimeList = null;\n\tstatic DAY_LENGTH = 86400000;\n\tstatic TIME_FORMAT = null;\n\tstatic TIME_FORMAT_SHORT = null;\n\tstatic DATE_FORMAT = null;\n\tstatic DATETIME_FORMAT = null;\n\n\tstatic getDateFormat()\n\t{\n\t\tif (Type.isNull(BookingUtil.DATE_FORMAT))\n\t\t{\n\t\t\tBookingUtil.DATE_FORMAT = CoreDate.convertBitrixFormat(Loc.getMessage(\"FORMAT_DATE\"));\n\t\t}\n\t\treturn BookingUtil.DATE_FORMAT;\n\t}\n\n\tstatic getDateTimeFormat()\n\t{\n\t\tif (Type.isNull(BookingUtil.DATETIME_FORMAT))\n\t\t{\n\t\t\tBookingUtil.DATETIME_FORMAT = CoreDate.convertBitrixFormat(Loc.getMessage(\"FORMAT_DATETIME\"));\n\t\t}\n\t\treturn BookingUtil.DATETIME_FORMAT;\n\t}\n\n\tstatic getTimeFormat()\n\t{\n\t\tif (Type.isNull(BookingUtil.TIME_FORMAT))\n\t\t{\n\t\t\tlet DATETIME_FORMAT = BookingUtil.getDateTimeFormat();\n\t\t\tlet DATE_FORMAT = BookingUtil.getDateFormat();\n\n\t\t\tif ((DATETIME_FORMAT.substr(0, DATE_FORMAT.length) === DATE_FORMAT))\n\t\t\t{\n\t\t\t\tBookingUtil.TIME_FORMAT = DATETIME_FORMAT.substr(DATE_FORMAT.length).trim();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBookingUtil.TIME_FORMAT = CoreDate.convertBitrixFormat(CoreDate.isAmPmMode() ? 'H:MI:SS T' : 'HH:MI:SS');\n\t\t\t}\n\n\t\t\tBookingUtil.TIME_FORMAT_SHORT = BookingUtil.TIME_FORMAT.replace(':s', '');\n\t\t}\n\n\t\treturn BookingUtil.TIME_FORMAT;\n\t}\n\n\tstatic getTimeFormatShort()\n\t{\n\t\tif (Type.isNull(BookingUtil.TIME_FORMAT_SHORT))\n\t\t{\n\t\t\tBookingUtil.TIME_FORMAT_SHORT = BookingUtil.getTimeFormat().replace(':s', '');\n\t\t}\n\t\treturn BookingUtil.TIME_FORMAT_SHORT;\n\t}\n\n\tstatic formatDate(format, timestamp, now, utc)\n\t{\n\t\tif (format === null)\n\t\t{\n\t\t\tformat = BookingUtil.getDateFormat();\n\t\t}\n\n\t\tif (Type.isDate(timestamp))\n\t\t{\n\t\t\ttimestamp = timestamp.getTime() / 1000;\n\t\t}\n\n\t\treturn CoreDate.format(format, timestamp, now, utc);\n\t}\n\n\tstatic parseDate(str, bUTC, formatDate, formatDatetime)\n\t{\n\t\treturn CoreDate.parse(str, bUTC, formatDate, formatDatetime);\n\t}\n\n\tstatic formatTime(h, m)\n\t{\n\t\tlet d = new Date();\n\t\td.setHours(h, m, 0);\n\t\treturn CoreDate.format(BookingUtil.getTimeFormatShort(), d.getTime() / 1000);\n\t};\n\n\tstatic translit(str)\n\t{\n\t\treturn Type.isString(str) ? Translit.run(str).replace(/[^a-z0-9_]/ig, \"_\") : str;\n\t}\n\n\tstatic getLoader(size, className)\n\t{\n\t\treturn Tag.render`\n\t\t<div class=\"${className || 'calendar-loader'}\">\n\t\t\t<svg class=\"calendar-loader-circular\"\n\t\t\t\tstyle=\"width:${parseInt(size)}px; height:${parseInt(size)}px;\"\n\t\t\t\tviewBox=\"25 25 50 50\">\n\t\t\t\t\t<circle class=\"calendar-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t\t<circle class=\"calendar-loader-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t</svg>\n\t\t</div>\n`;\n\t};\n\n\tstatic fireCustomEvent(eventObject, eventName, eventParams, secureParams)\n\t{\n\t\tif (window.BX && Type.isFunction(BX.onCustomEvent))\n\t\t{\n\t\t\treturn BX.onCustomEvent(eventObject, eventName, eventParams, secureParams);\n\t\t}\n\t}\n\n\tstatic bindCustomEvent(eventObject, eventName, eventHandler)\n\t{\n\t\tif (window.BX && Type.isFunction(BX.addCustomEvent))\n\t\t{\n\t\t\treturn BX.addCustomEvent(eventObject, eventName, eventHandler);\n\t\t}\n\t}\n\n\tstatic unbindCustomEvent(eventObject, eventName, eventHandler)\n\t{\n\t\tif (window.BX && Type.isFunction(BX.removeCustomEvent))\n\t\t{\n\t\t\treturn BX.removeCustomEvent(eventObject, eventName, eventHandler);\n\t\t}\n\t}\n\n\tstatic isAmPmMode()\n\t{\n\t\treturn CoreDate.isAmPmMode();\n\t}\n\n\tstatic mergeEx()\n\t{\n\t\tlet arg = Array.prototype.slice.call(arguments);\n\t\tif(arg.length < 2)\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tlet result = arg.shift();\n\t\tfor (let i = 0; i < arg.length; i++)\n\t\t{\n\t\t\tfor (let k in arg[i])\n\t\t\t{\n\t\t\t\tif (typeof arg[i] === \"undefined\" || arg[i] == null || !arg[i].hasOwnProperty(k))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isPlainObject(arg[i][k]) && Type.isPlainObject(result[k]))\n\t\t\t\t{\n\t\t\t\t\tBookingUtil.mergeEx(result[k], arg[i][k]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult[k] = Type.isPlainObject(arg[i][k]) ? Runtime.clone(arg[i][k]) : arg[i][k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tstatic getDurationList(fullDay)\n\t{\n\t\tlet\n\t\t\tvalues = [5, 10, 15, 20, 25, 30, 40, 45, 50, 60, 90,\n\t\t\t\t120, 180, 240, 300, 360,\n\t\t\t\t1440, 1440 * 2, 1440 * 3, 1440 * 4, 1440 * 5, 1440 * 6, 1440 * 7, 1440 * 10],\n\t\t\tval, i, res = [];\n\n\t\tfor (i = 0; i < values.length; i++)\n\t\t{\n\t\t\tval = values[i];\n\t\t\tif (fullDay && val % 1440 !== 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tres.push({\n\t\t\t\tvalue: val,\n\t\t\t\tlabel: BookingUtil.getDurationLabel(val)\n\t\t\t});\n\t\t}\n\t\treturn res;\n\t}\n\n\tstatic getDurationLabel(val)\n\t{\n\t\tlet label;\n\t\tif (val % 1440 === 0) // Days\n\t\t{\n\t\t\tlabel = Loc.getMessage('USER_TYPE_DURATION_X_DAY').replace('#NUM#', val / 1440);\n\t\t}\n\t\telse if (val % 60 === 0 && val !== 60) // Hours\n\t\t{\n\t\t\tlabel = Loc.getMessage('USER_TYPE_DURATION_X_HOUR').replace('#NUM#', val / 60);\n\t\t}\n\t\t// Minutes\n\t\telse\n\t\t{\n\t\t\tlabel = Loc.getMessage('USER_TYPE_DURATION_X_MIN').replace('#NUM#', val);\n\t\t}\n\t\treturn label\n\t}\n\n\tstatic parseDuration(value)\n\t{\n\t\tlet\n\t\t\tstringValue = value,\n\t\t\tnumValue = parseInt(value),\n\t\t\tparsed = false,\n\t\t\tdayRegexp = new RegExp('(\\\\d)\\\\s*(' + Loc.getMessage('USER_TYPE_DURATION_REGEXP_DAY') + ').*', 'ig'),\n\t\t\thourRegexp = new RegExp('(\\\\d)\\\\s*(' + Loc.getMessage('USER_TYPE_DURATION_REGEXP_HOUR') + ').*', 'ig');\n\n\t\tvalue = value.replace(dayRegexp, function(str, num){parsed = true;return num;});\n\t\t// It's days\n\t\tif (parsed)\n\t\t{\n\t\t\tvalue = numValue * 1440;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvalue = stringValue.replace(hourRegexp, function(str, num){parsed = true;return num;});\n\t\t\t// It's hours\n\t\t\tif (parsed)\n\t\t\t{\n\t\t\t\tvalue = numValue * 60;\n\t\t\t}\n\t\t\telse // Minutes\n\t\t\t{\n\t\t\t\tvalue = numValue;\n\t\t\t}\n\t\t}\n\n\t\treturn parseInt(value) || 0;\n\t}\n\n\tstatic getSimpleTimeList()\n\t{\n\t\tif (Type.isNull(BookingUtil.simpleTimeList))\n\t\t{\n\t\t\tlet i, res = [];\n\t\t\tfor (i = 0; i < 24; i++)\n\t\t\t{\n\t\t\t\tres.push({value: i * 60, label: this.formatTime(i, 0)});\n\t\t\t\tres.push({value: i * 60 + 30, label: this.formatTime(i, 30)});\n\t\t\t}\n\t\t\tBookingUtil.simpleTimeList = res;\n\t\t}\n\t\treturn BookingUtil.simpleTimeList;\n\t}\n\n\tstatic adaptTimeValue(timeValue)\n\t{\n\t\ttimeValue = parseInt(timeValue.h * 60) + parseInt(timeValue.m);\n\t\tlet\n\t\t\ttimeList = BookingUtil.getSimpleTimeList(),\n\t\t\tdiff = 24 * 60,\n\t\t\tind = false,\n\t\t\ti;\n\n\t\tfor (i = 0; i < timeList.length; i++)\n\t\t{\n\t\t\tif (Math.abs(timeList[i].value - timeValue) < diff)\n\t\t\t{\n\t\t\t\tdiff = Math.abs(timeList[i].value - timeValue);\n\t\t\t\tind = i;\n\t\t\t\tif (diff <= 15)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn timeList[ind || 0];\n\t}\n\n\tstatic getDayLength()\n\t{\n\t\treturn BookingUtil.DAY_LENGTH;\n\t}\n\n\tstatic showLimitationPopup()\n\t{\n\t\tif (top.BX.getClass(\"BX.UI.InfoHelper\"))\n\t\t{\n\t\t\ttop.BX.UI.InfoHelper.show('limit_crm_booking');\n\t\t}\n\t};\n}","import {Type, Loc, Dom, Event} from \"./resourcebooking\";\nimport {UserSelector} from \"./controls/userselector\";\nimport {ResourceSelector} from \"./controls/resourceselector\";\nimport {ServiceSelector} from \"./controls/serviceselector\";\nimport {DurationSelector} from \"./controls/durationselector\";\nimport {DateSelector} from \"./controls/dateselector\";\nimport {TimeSelector} from \"./controls/timeselector\";\n\nexport class FieldViewControllerAbstract extends Event.EventEmitter\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.settings = params.settings || {};\n\t\tthis.showTitle = params.displayTitle !== false;\n\t\tthis.title = params.title || '';\n\t\tthis.DOM = {\n\t\t\twrap: params.wrap // outer wrap of the form\n\t\t};\n\t}\n\n\tbuild()\n\t{\n\t\tthis.controls = {};\n\t\t// inner wrap\n\t\tthis.DOM.outerWrap = this.DOM.wrap.appendChild(Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-wrapper calendar-resbook-webform-wrapper-form'}}));\n\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-inner'}}));\n\n\t\tif (this.settings.userfieldSettings.useUsers || this.settings.userfieldSettings.useResources)\n\t\t{\n\t\t\tthis.displayTitle();\n\t\t\tthis.displayUsersControl();\n\t\t\tthis.displayResourcesControl();\n\t\t\tthis.displayServicesControl();\n\t\t\tthis.displayDurationControl();\n\t\t\tthis.displayDateControl();\n\t\t\tthis.displayTimeControl();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.displayWarning(Loc.getMessage('WEBF_RES_BOOKING_WARNING'));\n\t\t}\n\t}\n\n\tdestroy()\n\t{\n\t\tDom.remove(this.DOM.outerWrap);\n\t}\n\n\tdisplayTitle()\n\t{\n\t\tif (this.showTitle)\n\t\t{\n\t\t\tthis.DOM.titleWrap = this.DOM.innerWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props:{className:'calendar-resbook-webform-title'}}))\n\t\t\t\t.appendChild(Dom.create(\"div\", {props:{className:'calendar-resbook-webform-title-text'}}));\n\t\t\tthis.updateTitle(this.title);\n\t\t}\n\t}\n\n\tupdateTitle(title)\n\t{\n\t\tif (this.showTitle)\n\t\t{\n\t\t\tthis.title = title;\n\t\t\tDom.adjust(this.DOM.titleWrap, {text: this.title});\n\t\t}\n\t}\n\n\tdisplayWarning(message)\n\t{\n\t\tthis.DOM.warningWrap = this.DOM.innerWrap\n\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops:{className:'ui-alert ui-alert-warning ui-alert-text-center ui-alert-icon-warning'},\n\t\t\t\tstyle: {marginBottom: 0},\n\t\t\t\thtml: '<span class=\"ui-alert-message\">' + message + '</span>'\n\t\t\t}));\n\t}\n\n\tdisplayUsersControl()\n\t{\n\t\tif (this.settings.userfieldSettings.useUsers)\n\t\t{\n\t\t\tif (this.settings.data.users.value === null\n\t\t\t\t&& Type.isArray(this.settings.userfieldSettings.users))\n\t\t\t{\n\t\t\t\tthis.settings.data.users.value = this.settings.userfieldSettings.users;\n\t\t\t}\n\n\t\t\tthis.controls.users = new UserSelector({\n\t\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\t\tdata: this.settings.data.users,\n\t\t\t\tuserIndex: this.settings.userfieldSettings.userIndex\n\t\t\t});\n\t\t\tthis.controls.users.display();\n\t\t}\n\t}\n\n\tdisplayResourcesControl()\n\t{\n\t\tif (this.settings.userfieldSettings.useResources)\n\t\t{\n\t\t\tif (this.settings.data.resources.value === null\n\t\t\t\t&& Type.isArray(this.settings.userfieldSettings.resources))\n\t\t\t{\n\t\t\t\tthis.settings.data.resources.value = [];\n\t\t\t\tthis.settings.userfieldSettings.resources.forEach(function(res)\n\t\t\t\t{\n\t\t\t\t\tthis.settings.data.resources.value.push(parseInt(res.id));\n\t\t\t\t}, this);\n\t\t\t}\n\n\t\t\tthis.controls.resources = new ResourceSelector({\n\t\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\t\tdata: this.settings.data.resources,\n\t\t\t\tresourceList: this.settings.userfieldSettings.resources\n\t\t\t});\n\t\t\tthis.controls.resources.display();\n\t\t}\n\t}\n\n\tdisplayServicesControl()\n\t{\n\t\tif (this.settings.userfieldSettings.useServices)\n\t\t{\n\t\t\tif (this.settings.data.services.value === null\n\t\t\t\t&& Type.isArray(this.settings.userfieldSettings.services))\n\t\t\t{\n\t\t\t\tthis.settings.data.services.value = [];\n\t\t\t\tthis.settings.userfieldSettings.services.forEach(function(serv)\n\t\t\t\t{\n\t\t\t\t\tthis.settings.data.services.value.push(serv.name);\n\t\t\t\t}, this);\n\t\t\t}\n\n\t\t\tthis.controls.services = new ServiceSelector({\n\t\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\t\tdata: this.settings.data.services,\n\t\t\t\tserviceList: this.settings.userfieldSettings.services\n\t\t\t});\n\t\t\tthis.controls.services.display();\n\t\t}\n\t}\n\n\tdisplayDurationControl()\n\t{\n\t\tif (!this.settings.userfieldSettings.useServices)\n\t\t{\n\t\t\tthis.controls.duration = new DurationSelector({\n\t\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\t\tdata: this.settings.data.duration,\n\t\t\t\tfullDay: this.settings.userfieldSettings.fullDay\n\t\t\t});\n\t\t\tthis.controls.duration.display();\n\t\t}\n\t}\n\n\tdisplayDateControl()\n\t{\n\t\tthis.controls.date = new DateSelector({\n\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\tdata: this.settings.data.date\n\t\t});\n\t\tthis.controls.date.display();\n\t}\n\n\tdisplayTimeControl()\n\t{\n\t\tif (!this.settings.userfieldSettings.fullDay)\n\t\t{\n\t\t\tthis.controls.time = new TimeSelector({\n\t\t\t\touterWrap: this.DOM.innerWrap,\n\t\t\t\tdata: this.settings.data.time\n\t\t\t});\n\t\t\tthis.controls.time.display();\n\t\t}\n\t}\n\n\trefreshLayout(settingsData)\n\t{\n\t\tfor (let k in this.controls)\n\t\t{\n\t\t\tif (this.controls.hasOwnProperty(k) && Type.isFunction(this.controls[k].refresh))\n\t\t\t{\n\t\t\t\tthis.controls[k].refresh(settingsData[k] || this.settings.data[k]);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetInnerWrap()\n\t{\n\t\treturn this.DOM.innerWrap;\n\t}\n\n\tgetOuterWrap()\n\t{\n\t\treturn this.DOM.outerWrap;\n\t}\n}\n\n\n\n\n\n\n","import {FieldViewControllerAbstract} from \"./fieldviewcontrollerabstract\";\nexport class FieldViewControllerEdit extends FieldViewControllerAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t}\n}","import {FieldViewControllerAbstract} from \"./fieldviewcontrollerabstract\";\nexport class FieldViewControllerPreview extends FieldViewControllerAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.DOM.outerWrap.className = 'calendar-resbook-webform-wrapper calendar-resbook-webform-wrapper-preview calendar-resbook-webform-wrapper-dark';\n\t}\n}","import {Type, Dom, Event, BookingUtil, MenuManager} from \"../resourcebooking\";\n\nexport class SelectInput extends Event.EventEmitter\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.id = params.id || 'bx-select-input-' + Math.round(Math.random() * 1000000);\n\n\t\tif (Type.isFunction(params.getValues))\n\t\t{\n\t\t\tthis.getValues = params.getValues;\n\t\t\tthis.values = this.getValues();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.values = params.values || false;\n\t\t}\n\n\t\tthis.input = params.input;\n\t\tthis.defaultValue = params.defaultValue || '';\n\t\tthis.openTitle = params.openTitle || '';\n\t\tthis.className = params.className || '';\n\t\tthis.currentValue = params.value;\n\t\tthis.currentValueIndex = params.valueIndex;\n\t\tthis.onChangeCallback = Type.isFunction(params.onChangeCallback) ? params.onChangeCallback : null;\n\t\tthis.onAfterMenuOpen = params.onAfterMenuOpen || null;\n\t\tthis.zIndex = params.zIndex || 1200;\n\t\tthis.disabled = params.disabled;\n\t\tthis.editable = params.editable !== false;\n\t\tthis.setFirstIfNotFound = !!params.setFirstIfNotFound;\n\n\t\tif (this.onChangeCallback)\n\t\t{\n\t\t\tEvent.bind(this.input, 'change', this.onChangeCallback);\n\t\t\tEvent.bind(this.input, 'keyup', this.onChangeCallback);\n\t\t}\n\n\t\tthis.curInd = false;\n\n\t\tif (Type.isArray(this.values))\n\t\t{\n\t\t\tEvent.bind(this.input, 'click', this.onClick.bind(this));\n\n\t\t\tif (this.editable)\n\t\t\t{\n\t\t\t\tEvent.bind(this.input, 'focus', this.onFocus.bind(this));\n\t\t\t\tEvent.bind(this.input, 'blur', this.onBlur.bind(this));\n\t\t\t\tEvent.bind(this.input, 'keyup', this.onKeyup.bind(this));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEvent.bind(this.input, 'focus', function(){this.input.blur();}.bind(this));\n\t\t\t}\n\n\t\t\tif (this.currentValueIndex === undefined && this.currentValue !== undefined)\n\t\t\t{\n\t\t\t\tthis.currentValueIndex = -1;\n\t\t\t\tfor (let i = 0; i < this.values.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (parseInt(this.values[i].value) === parseInt(this.currentValue))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.currentValueIndex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.currentValueIndex === -1)\n\t\t\t\t{\n\t\t\t\t\tthis.currentValueIndex = this.setFirstIfNotFound ? 0 : undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.currentValueIndex !== undefined && this.values[this.currentValueIndex])\n\t\t{\n\t\t\tthis.input.value = this.values[this.currentValueIndex].label;\n\t\t}\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.getValues)\n\t\t{\n\t\t\tthis.values = this.getValues();\n\t\t}\n\n\t\tif (this.shown || this.disabled || !this.values.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet\n\t\t\tind = 0,\n\t\t\tj = 0,\n\t\t\tmenuItems = [],\n\t\t\ti,\n\t\t\t_this = this;\n\n\t\tfor (i = 0; i < this.values.length; i++)\n\t\t{\n\t\t\tif (this.values[i].delimiter)\n\t\t\t{\n\t\t\t\tmenuItems.push(this.values[i]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif ((this.currentValue && this.values[i] && this.values[i].value === this.currentValue.value)\n\t\t\t\t\t|| this.input.value === this.values[i].label)\n\t\t\t\t{\n\t\t\t\t\tind = j;\n\t\t\t\t}\n\n\t\t\t\tmenuItems.push({\n\t\t\t\t\tid: this.values[i].value + '_' + i,\n\t\t\t\t\ttext: this.values[i].label,\n\t\t\t\t\tonclick: this.values[i].callback || (function (value, label)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t_this.input.value = label;\n\t\t\t\t\t\t\t_this.popupMenu.close();\n\t\t\t\t\t\t\t_this.onChange(value, label);\n\t\t\t\t\t\t}\n\t\t\t\t\t})(this.values[i].value, this.values[i].labelRaw || this.values[i].label)\n\t\t\t\t});\n\t\t\t\tj++;\n\t\t\t}\n\t\t}\n\n\t\tthis.popupMenu = MenuManager.create(\n\t\t\tthis.id,\n\t\t\tthis.input,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : true,\n\t\t\t\tzIndex: this.zIndex,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\t\tthis.popupMenu.popupWindow.setWidth(this.input.offsetWidth - 2);\n\n\t\tlet menuContainer = this.popupMenu.layout.menuContainer;\n\t\tDom.addClass(this.popupMenu.layout.menuContainer, 'calendar-resourcebook-select-popup');\n\t\tthis.popupMenu.show();\n\n\t\tlet menuItem = this.popupMenu.menuItems[ind];\n\t\tif (menuItem && menuItem.layout)\n\t\t{\n\t\t\tmenuContainer.scrollTop = menuItem.layout.item.offsetTop - 2;\n\t\t}\n\n\t\tBookingUtil.bindCustomEvent(this.popupMenu.popupWindow, 'onPopupClose', function(){this.shown = false;}.bind(this));\n\n\t\tthis.input.select();\n\n\t\tif (Type.isFunction(this.onAfterMenuOpen))\n\t\t{\n\t\t\tthis.onAfterMenuOpen(ind, this.popupMenu);\n\t\t}\n\n\t\tthis.shown = true;\n\t}\n\n\tclosePopup()\n\t{\n\t\tMenuManager.destroy(this.id);\n\t\tthis.shown = false;\n\t}\n\n\tonFocus()\n\t{\n\t\tsetTimeout(function(){\n\t\t\tif (!this.shown)\n\t\t\t{\n\t\t\t\tthis.showPopup();\n\t\t\t}\n\t\t}.bind(this), 200);\n\t}\n\n\tonClick()\n\t{\n\t\tif (this.shown)\n\t\t{\n\t\t\tthis.closePopup();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showPopup();\n\t\t}\n\t}\n\n\tonBlur()\n\t{\n\t\tsetTimeout(this.closePopup.bind(this), 200);\n\t}\n\n\tonKeyup()\n\t{\n\t\tsetTimeout(this.closePopup.bind(this), 50);\n\t}\n\n\tonChange(value)\n\t{\n\t\tlet val = this.input.value;\n\t\tthis.emit('BX.Calendar.Resourcebooking.SelectInput:changed', new Event.BaseEvent({data: {selectinput: this, value: val, realValue: value}}));\n\t\tif (this.onChangeCallback)\n\t\t{\n\t\t\tthis.onChangeCallback({value: val, realValue: value});\n\t\t}\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.onChangeCallback)\n\t\t{\n\t\t\tEvent.unbind(this.input, 'change', this.onChangeCallback);\n\t\t\tEvent.unbind(this.input, 'keyup', this.onChangeCallback);\n\t\t}\n\n\t\tEvent.unbind(this.input, 'click', this.onClick.bind(this));\n\t\tEvent.unbind(this.input, 'focus', this.onFocus.bind(this));\n\t\tEvent.unbind(this.input, 'blur', this.onBlur.bind(this));\n\t\tEvent.unbind(this.input, 'keyup', this.onKeyup.bind(this));\n\n\t\tif (this.popupMenu)\n\t\t{\n\t\t\tthis.popupMenu.close();\n\t\t}\n\n\t\tMenuManager.destroy(this.id);\n\t\tthis.shown = false;\n\t}\n\n\tsetValue(value)\n\t{\n\t\tthis.input.value = value;\n\t\tif (Type.isArray(this.values))\n\t\t{\n\t\t\tlet currentValueIndex = -1;\n\t\t\tfor (let i = 0; i < this.values.length; i++)\n\t\t\t{\n\t\t\t\tif (this.values[i].value === value)\n\t\t\t\t{\n\t\t\t\t\tcurrentValueIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (currentValueIndex !== -1)\n\t\t\t{\n\t\t\t\tthis.input.value = this.values[currentValueIndex].label;\n\t\t\t\tthis.currentValueIndex = currentValueIndex;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetValue()\n\t{\n\t\treturn this.input.value;\n\t}\n}","// @flow\n'use strict';\n\nimport { Type, Loc, Dom, Event, Tag, Browser, Text, Runtime } from 'main.core';\nimport {LiveFieldController} from './livefieldcontroller.js';\nimport {BookingUtil} from \"./bookingutil\";\nimport {FieldViewControllerEdit} from \"./fieldviewcontrolleredit\";\nimport {FieldViewControllerPreview} from \"./fieldviewcontrollerpreview\";\nimport {SelectInput} from \"./controls/selectinput\";\nimport \"main.date\";\nimport './css/resourcebooking.css';\nimport {PopupManager, MenuManager} from 'main.popup';\n\nimport {BaseEvent, EventEmitter } from 'main.core.events';\n\n\nlet CoreDate = window.BX && BX.Main && BX.Main.Date ? BX.Main.Date : null;\nexport {CoreDate};\n\nexport {Type, Loc, Dom, Event, Tag, Browser, Text, Runtime, PopupManager, MenuManager};\nexport {BaseEvent, EventEmitter};\nexport {BookingUtil, FieldViewControllerEdit, FieldViewControllerPreview, SelectInput};\n\n\n\nexport class Resourcebooking\n{\n\tstatic getLiveField(params)\n\t{\n\t\tif (!params.wrap || !Type.isDomNode(params.wrap))\n\t\t{\n\t\t\tthrow new Error(\"The argument \\\"params.wrap\\\" must be a DOM node.\");\n\t\t}\n\t\tif (Type.isNull(CoreDate))\n\t\t{\n\t\t\tthrow new Error(\"The error occured during Date extention loading\");\n\t\t}\n\n\t\tlet liveFieldController = new LiveFieldController(params);\n\t\tliveFieldController.init();\n\t\treturn liveFieldController;\n\t}\n\n\tstatic getPreviewField(params)\n\t{\n\t}\n}"],"names":["ViewControlAbstract","params","TypeError","name","classNames","wrap","wrapClassName","innerWrap","title","field","DOM","outerWrap","dataWrap","labelWrap","data","shown","show","appendChild","Dom","create","props","className","Tag","render","isDisplayed","animation","refreshLabel","setDataConfig","hide","label","adjust","text","controlWrap","displayControl","remove","errorMessage","addClass","displayErrorText","Loc","getMessage","removeClass","errorTextWrap","ViewDropDownSelect","id","Math","round","random","maxHeight","selectAllMessage","setSettings","select","attrs","events","click","openPopup","bind","setSelectedValues","selected","handleChangesCallback","Type","isFunction","values","isArray","multiple","isPopupShown","closePopup","menuItems","forEach","item","includes","parseInt","push","Text","encode","onclick","menuItemClick","length","selectAllItemClick","popup","MenuManager","closeByEsc","autoHide","offsetTop","offsetLeft","cacheable","popupContainer","popupWindow","style","width","offsetWidth","menuItem","checked","selectAllChecked","find","value","itemId","layout","innerHTML","Event","unbind","document","handleClick","setTimeout","close","isShown","e","selectAllcheckbox","target","srcElement","foundValue","checkbox","querySelector","hasClass","selectItem","deselectItem","handleControlChanges","index","indexOf","slice","concat","i","checkboxes","querySelectorAll","contains","textValues","selectedValues","join","getSelectedValues","UserSelector","userList","userIndex","defaultMode","previewMode","undefined","autoSelectDefaultValue","changeValueCallback","handleSettingsData","selectedValue","getSelectedUser","dropdownSelect","handleChanges","build","isPlainObject","hasOwnProperty","dataValue","dataValueRaw","split","displayName","userId","ResourceSelector","allResourceList","resourceList","ServiceSelector","serviceList","allServiceList","setSelectedService","getSelectedService","serviceIndex","service","isString","trim","prepareServiceId","BookingUtil","getDurationLabel","duration","serviceName","selectedService","getMeta","str","translit","DurationSelector","durationList","getDurationList","fullDay","defaultValue","durationItems","durationInput","type","durationControl","SelectInput","input","editable","manualInput","setFirstIfNotFound","onChangeCallback","setValue","parseDuration","getValue","DateSelector","requestDataCallback","allowOverbooking","displayed","setDateIndex","availableDateIndex","setCurrentDate","lineDateControl","refreshDateAvailability","start","configWasChanged","popupSateControl","PopupDateSelector","isDateAvailable","onChange","LineDateSelector","date","isDate","currentDate","isItPastDate","formatDate","dateKey","nowDate","Date","checkDate","getTime","setHours","getDisplayedValue","realDate","datePicker","valueInput","previousArrow","stateWrap","stateWrapDate","stateWrapDay","nextArrow","dateValue","hasAttribute","closest","dateMeta","getAttribute","setDate","getDate","openCalendarPopup","isExternalDatePickerEnabled","openExternalDatePicker","openBxCalendar","BX","calendar","node","bTime","get","unbindCustomEvent","handleCalendarClose","bindCustomEvent","parseDate","isNull","UI","Vue","Components","DatePick","hasTime","change","toggle","externalDatePickerIsEnabled","window","DAYS_DISPLAY_SIZE","dayNodes","dayNodeIndex","monthTitle","controlStaticWrap","controlInnerWrap","fillDays","initCustomScroll","startDate","getStartLoadDate","addDateSlot","innerWidth","dateCode","html","dayNode","getDayNode","setSelected","currentSelected","startLoadDate","arrowWrap","leftArrow","handlePreletrowClick","rightArrow","handleNextArrowClick","outerWidth","mousewheelScrollHandler","checkScrollPosition","scrollLeft","max","event","delta","deltaY","detail","wheelDelta","abs","Browser","isMac","stopPropagation","preventDefault","display","updateMonthTitle","dayNodeOuterWidth","childNodes","monthFrom","monthTo","firstDayNodeIndex","floor","lastDayNodeIndex","TimeSelector","timeFrom","timeTo","SLOTS_ROW_AMOUNT","popupSelectId","timezone","timezoneOffset","timezoneOffsetLabel","timeMidday","timeEvening","showOnlyFree","showFinishTime","scale","timezoneLabelWrap","replace","setSlotIndex","slotIndex","setCurrentValue","availableSlotIndex","timeValue","warningWrap","warningTextNode","children","noSlotsAvailable","slotsInfo","getSlotsInfo","slots","freeSlotsCount","showEmptyWarning","hideEmptyWarning","createSelectControl","createSlotsControl","isAmPmMode","itemsInColumn","maxColumnNumber","parts","itemNumber","slot","partOfTheDay","items","toUpperCase","itemsWrap","ceil","booked","time","toString","fromTime","toTime","itemsAmount","k","initCustomScrollForSlots","timeSelectWrap","getSlotByTime","isDomNode","getTimeTextBySlot","getSlotNode","meta","openSelectPopup","finishTime","hourFrom","minFrom","hourTo","minTo","part","num","formatTime","checkSlotsScroll","isSelectPopupShown","closeSelectPopup","getTimeSelectItems","angle","dataset","slotNodes","slotNode","StatusInformer","built","statusWrap","statusTimezone","dateFrom","getStatusText","dateTo","getHours","getMinutes","message","LiveFieldController","setEventNamespace","actionAgent","ajax","runAction","inputName","DATE_FORMAT","getDateFormat","DATETIME_FORMAT","getDateTimeFormat","userFieldParams","loadedDates","accessibility","user","resource","busySlotMatrix","valueInputs","settingsData","getSettingsData","users","resources","Error","showMainLoader","requireFormData","then","hideMainLoader","buildFormControls","onChangeValues","result","usersDisplayed","userControl","showWarning","resourcesDisplayed","getSelectedResources","resourceControl","getCurrentDuration","serviceControl","dateControl","timeSelectorDisplayed","timeControl","inputsWrap","getFieldParams","statusControl","refresh","setError","preparaAutoSelectValues","displayUsersControl","displayResourcesControl","displayServicesControl","displayDurationControl","displayDateTimeControl","selectedUserId","selectedResourceId","refreshControlsState","selectorCanBeShown","getAvailableDateIndex","getSlotIndex","startValue","getFreeDate","updateStatusControl","fireCustomEvent","allValuesValue","dateFromValue","getCurrentDate","getCurrentServiceName","entries","clean","resourceId","selectedUser","entry","emit","loaderWrap","getLoader","mainLoader","requestedFormData","showStatusLoader","formDataParams","from","hideStatusLoader","refreshCurrentValue","Promise","resolve","reject","fieldName","entity_field_name","to","setLoadedDataLimits","response","isNumber","workTimeStart","workTimeEnd","fieldSettings","handleAccessibilityData","usersAccessibility","resourcesAccessibility","loadedDataFrom","loadedDataTo","loadedDatesIndex","key","slotsCount","entityType","entityId","dateIndex","setSeconds","fromTimestamp","toTimestamp","fillBusySlotMatrix","mergeEx","fromDate","dateToKey","timeValueFrom","timeValueTo","getTimeSlots","count","fillDataIndex","caption","settings_data","getCaption","loadedDate","setSelectedUser","setSelectedResource","autoSelectUser","autoSelectResource","autoSelectDate","maxStepsAuto","getFreeEntitiesForDate","slotsAmount","getDefaultDurationSlotsAmount","resList","getUsersValue","checkSlotsForDate","getResourceValue","getUserIndex","BaseEvent","valueIndex","fieldParams","SELECTED_RESOURCES","res","USE_SERVICES","services","getServicesValue","SERVICE_LIST","FULL_DAY","ALLOW_OVERBOOKING","handleDateChanging","requestAccessibilityData","USE_USER_TIMEZONE","userTimezoneOffset","getTimezoneOffset","TIMEZONE","handleSelectedDateTimeChanging","useTimeout","updateTimeStatusTimeout","clearTimeout","isUserSelectorInAutoMode","autoAdjustUserSelector","isResourceSelectorInAutoMode","autoAdjustResourceSelector","hasAvailableSlots","freeDate","userIsFree","resourcesAreFree","daysGap","j","userKey","daysAmount","freeSlot","slotGap","todayNowTime","timeSlots","checkIsTodayDate","today","getAvailableSlotIndex","entityHasSlotsForDate","busySlotList","freeSlotCount","hasFreeSlots","getSelectedValue","hour","min","useUsers","useResources","USE_RESOURCES","useTime","todayDateKey","EventEmitter","Translit","replaceChar","regexpEnChars","regexpSpace","maxLength","len","lastNewChar","newChar","chr","charAt","test","getChar","toLowerCase","separator","charTableFrom","charTableTo","replacementCharTable","generateReplacementCharTable","CoreDate","convertBitrixFormat","TIME_FORMAT","substr","TIME_FORMAT_SHORT","getTimeFormat","format","timestamp","now","utc","bUTC","formatDatetime","parse","h","m","d","getTimeFormatShort","run","size","eventObject","eventName","eventParams","secureParams","onCustomEvent","eventHandler","addCustomEvent","removeCustomEvent","arg","Array","prototype","call","arguments","shift","Runtime","clone","val","stringValue","numValue","parsed","dayRegexp","RegExp","hourRegexp","simpleTimeList","timeList","getSimpleTimeList","diff","ind","DAY_LENGTH","top","getClass","InfoHelper","FieldViewControllerAbstract","settings","showTitle","displayTitle","controls","userfieldSettings","displayDateControl","displayTimeControl","displayWarning","titleWrap","updateTitle","marginBottom","useServices","serv","FieldViewControllerEdit","FieldViewControllerPreview","getValues","openTitle","currentValue","currentValueIndex","onAfterMenuOpen","zIndex","disabled","curInd","onClick","onFocus","onBlur","onKeyup","blur","_this","delimiter","callback","popupMenu","labelRaw","setWidth","menuContainer","scrollTop","destroy","showPopup","selectinput","realValue","Main","Resourcebooking","liveFieldController","init"],"mappings":"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"}