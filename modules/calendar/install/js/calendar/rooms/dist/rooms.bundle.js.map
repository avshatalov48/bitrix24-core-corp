{"version":3,"file":"rooms.bundle.js","sources":["../src/reservebutton.js","../../sectioninterface/src/editform.js","../src/editformroom.js","../src/roomsinterface.js"],"sourcesContent":["import { Type, Dom, Loc } from 'main.core';\nimport { AddButton } from 'calendar.controls';\n\nexport class ReserveButton extends AddButton\n{\n\tconstructor(params = {})\n\t{\n\t\tsuper(params);\n\t\tthis.setEventNamespace('BX.Calendar.Rooms.ReserveButton');\n\t\tthis.zIndex = params.zIndex || 3200;\n\t\tthis.popupId = params.id || 'add-button-' + Math.round(Math.random() * 10000);\n\t\tthis.showTasks = params.showTasks;\n\n\t\tthis.addEntryHandler = Type.isFunction(params.addEntry) ? params.addEntry : null;\n\t\tthis.addTaskHandler = Type.isFunction(params.addTask) ? params.addTask : null;\n\t\tthis.create();\n\t}\n\n\tcreate()\n\t{\n\t\tthis.DOM.wrap = Dom.create('button', {\n\t\t\tprops: { className: 'ui-btn ui-btn-success', type: 'button' },\n\t\t\thtml: Loc.getMessage('EC_RESERVE'),\n\t\t\tevents: { click: this.addEntry.bind(this) }\n\t\t});\n\t}\n}","import { Runtime, Dom, Event, Loc, Text, Type, Tag } from 'main.core';\nimport { Util } from 'calendar.util';\nimport {EventEmitter} from 'main.core.events';\nimport {Dialog as EntitySelectorDialog} from 'ui.entity-selector';\n\n\nexport class EditForm extends EventEmitter\n{\n\tDOM = {};\n\tisCreated = false;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.SectionInterface.EditForm');\n\n\t\tthis.DOM.outerWrap = options.wrap;\n\t\tthis.sectionAccessTasks = options.sectionAccessTasks;\n\t\tthis.sectionManager = options.sectionManager;\n\t\tthis.closeCallback = options.closeCallback;\n\t\tthis.BX = Util.getBX();\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t}\n\n\tshow(params = {})\n\t{\n\t\tthis.section = params.section;\n\t\tthis.create();\n\t\tthis.showAccess = params.showAccess !== false;\n\t\tif (this.showAccess)\n\t\t{\n\t\t\tthis.DOM.accessLink.style.display = '';\n\t\t\tthis.DOM.accessWrap.style.display = '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.accessLink.style.display = 'none';\n\t\t\tthis.DOM.accessWrap.style.display = 'none';\n\t\t}\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\n\t\tif (params.section)\n\t\t{\n\t\t\tif (params.section.color)\n\t\t\t{\n\t\t\t\tthis.setColor(params.section.color);\n\t\t\t}\n\n\t\t\tthis.setAccess(params.section.access || params.section.data.ACCESS || {});\n\n\t\t\tif (params.section.name)\n\t\t\t{\n\t\t\t\tthis.DOM.sectionTitleInput.value = params.section.name;\n\t\t\t}\n\t\t}\n\n\t\tBX.focus(this.DOM.sectionTitleInput);\n\t\tif (this.DOM.sectionTitleInput.value !== '')\n\t\t{\n\t\t\tthis.DOM.sectionTitleInput.select();\n\t\t}\n\n\t\tthis.isOpenedState = true;\n\t}\n\n\tclose()\n\t{\n\t\tthis.isOpenedState = false;\n\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\t\tDom.removeClass(this.DOM.outerWrap, 'show');\n\n\t\tif (Type.isFunction(this.closeCallback))\n\t\t{\n\t\t\tthis.closeCallback();\n\t\t}\n\t}\n\n\tisOpened()\n\t{\n\t\treturn this.isOpenedState;\n\t}\n\n\tcreate()\n\t{\n\t\tthis.wrap = this.DOM.outerWrap.querySelector('.calendar-form-content');\n\n\t\tif (this.wrap)\n\t\t{\n\t\t\tDom.clean(this.wrap);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.wrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-form-content'}}));\n\t\t}\n\n\t\tthis.DOM.formFieldsWrap = this.wrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-list-slider-widget-content'}\n\t\t\t\t}\n\t\t\t)\n\t\t)\n\t\t\t.appendChild(\n\t\t\t\tDom.create(\n\t\t\t\t\t'DIV',\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: {className: 'calendar-list-slider-widget-content-block'}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t// Title\n\t\tthis.DOM.sectionTitleInput = this.DOM.formFieldsWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-field-container calendar-field-container-string'}\n\t\t\t\t}\n\t\t\t)\n\t\t)\n\t\t\t.appendChild(Dom.create('DIV', {props: {className: 'calendar-field-block'}}))\n\t\t\t.appendChild(Dom.create('INPUT', {\n\t\t\t\tattrs: {type: 'text', placeholder: Loc.getMessage('EC_SEC_SLIDER_SECTION_TITLE')},\n\t\t\t\tprops: {className: 'calendar-field calendar-field-string'}\n\t\t\t}));\n\n\t\tthis.DOM.optionsWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-list-slider-new-calendar-options-container'}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.initSectionColorSelector();\n\n\t\tthis.initAccessController();\n\n\t\t// Buttons\n\t\tthis.buttonsWrap = this.DOM.formFieldsWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-list-slider-btn-container'}}));\n\n\t\tthis.saveBtn = new BX.UI.Button({\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_SAVE'),\n\t\t\tclassName: 'ui-btn ui-btn-success',\n\t\t\tevents: {click: this.save.bind(this)}\n\t\t});\n\t\tthis.saveBtn.renderTo(this.buttonsWrap);\n\n\t\tnew BX.UI.Button({\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_CANCEL'),\n\t\t\tclassName: 'ui-btn ui-btn-link',\n\t\t\tevents: {click: this.checkClose.bind(this)}\n\t\t}).renderTo(this.buttonsWrap);\n\n\t\tthis.isCreated = true;\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif(e.keyCode === Util.getKeyCode('escape'))\n\t\t{\n\t\t\tthis.checkClose();\n\t\t}\n\t\telse if(e.keyCode === Util.getKeyCode('enter'))\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tcheckClose()\n\t{\n\t\tthis.close();\n\t}\n\n\tsave()\n\t{\n\t\tthis.saveBtn.setWaiting(true);\n\t\tthis.sectionManager.saveSection(\n\t\t\tthis.DOM.sectionTitleInput.value,\n\t\t\tthis.color,\n\t\t\tthis.access,\n\t\t\t{section: this.section}\n\t\t)\n\t\t\t.then(() => {\n\t\t\t\tthis.saveBtn.setWaiting(false);\n\t\t\t\tthis.close();\n\t\t\t});\n\t}\n\n\tinitSectionColorSelector()\n\t{\n\t\tthis.DOM.colorContWrap = this.DOM.optionsWrap.appendChild(Dom.create('DIV', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color' },\n\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_COLOR')\n\t\t}));\n\t\tthis.colorIcon = this.DOM.colorContWrap.appendChild(Dom.create('SPAN', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color-selected' }\n\t\t}));\n\t\tthis.colorChangeLink = this.DOM.colorContWrap.appendChild(Dom.create('SPAN', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color-change' },\n\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_CHANGE')\n\t\t}));\n\t\t\n\t\tEvent.bind(this.colorIcon, 'click', this.showSimplePicker.bind(this));\n\t\tEvent.bind(this.colorChangeLink, 'click', this.showSimplePicker.bind(this));\n\t}\n\n\tshowSimplePicker(value)\n\t{\n\t\tconst colors = Runtime.clone(Util.getDefaultColorList(), true);\n\t\tconst innerCont = Dom.create(\n\t\t\t'DIV',\n\t\t\t{\n\t\t\t\tprops: {className: 'calendar-simple-color-wrap calendar-field-container-colorpicker-square'}\n\t\t\t}\n\t\t);\n\t\tconst colorWrap = innerCont.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\t\tevents: {click: BX.delegate(this.simplePickerClick, this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tconst moreLinkWrap = innerCont.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-simple-color-more-link-wrap'}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tconst moreLink = moreLinkWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'SPAN',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-simple-color-more-link'},\n\t\t\t\t\thtml: Loc.getMessage('EC_COLOR'),\n\t\t\t\t\tevents: {click: BX.delegate(this.showFullPicker, this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.simplePickerColorWrap = colorWrap;\n\t\tthis.colors = [];\n\n\t\tif (!colors.includes(this.color))\n\t\t{\n\t\t\tcolors.push(this.color);\n\t\t}\n\n\t\tfor (let i = 0; i < colors.length; i++)\n\t\t{\n\t\t\tthis.colors.push({\n\t\t\t\tcolor: colors[i],\n\t\t\t\tnode: colorWrap.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-field-colorpicker-color-item'},\n\t\t\t\t\tstyle: {backgroundColor: colors[i]},\n\t\t\t\t\tattrs: {'data-bx-calendar-color': colors[i]},\n\t\t\t\t\thtml: '<span class=\"calendar-field-colorpicker-color\"></span>'\n\t\t\t\t}))\n\t\t\t});\n\t\t}\n\n\t\tthis.lastActiveNode = this.colors[BX.util.array_search(this.color, colors) || 0].node;\n\t\tDom.addClass(this.lastActiveNode, 'active');\n\n\t\tthis.simpleColorPopup = BX.PopupWindowManager.create(\n\t\t\t\"simple-color-popup-\" + Util.getRandomInt(),\n\t\t\tthis.colorIcon,\n\t\t\t{\n\t\t\t\t//zIndex: this.zIndex,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 9,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: innerCont,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.simpleColorPopup.setAngle({offset: 10});\n\t\tthis.simpleColorPopup.show(true);\n\t}\n\n\tsimplePickerClick(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (Type.isElementNode(target))\n\t\t{\n\t\t\tconst value = target.getAttribute('data-bx-calendar-color');\n\t\t\tif(value !== null)\n\t\t\t{\n\t\t\t\tif (this.lastActiveNode)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.lastActiveNode, 'active');\n\t\t\t\t}\n\n\t\t\t\tDom.addClass(target, 'active');\n\t\t\t\tthis.lastActiveNode = target;\n\t\t\t\tthis.setColor(value);\n\t\t\t}\n\t\t}\n\t}\n\n\tshowFullPicker()\n\t{\n\t\tif (this.simpleColorPopup)\n\t\t{\n\t\t\tthis.simpleColorPopup.close();\n\t\t}\n\n\t\tif (!this.fullColorPicker)\n\t\t{\n\t\t\tthis.fullColorPicker = new BX.ColorPicker({\n\t\t\t\tbindElement: this.colorIcon,\n\t\t\t\tonColorSelected: BX.delegate(function(color){\n\t\t\t\t\tthis.setColor(color);\n\t\t\t\t}, this),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tzIndex: this.zIndex,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupClose:BX.delegate(function(){\n\t\t\t\t\t\t}, this)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.fullColorPicker.open();\n\t}\n\n\tsetColor(value)\n\t{\n\t\tthis.colorIcon.style.backgroundColor = value;\n\t\tthis.color = value;\n\t}\n\n\tsetAccess(value)\n\t{\n\t\tlet rowsCount = 0;\n\t\tfor (let code in value)\n\t\t{\n\t\t\tif (value.hasOwnProperty(code))\n\t\t\t{\n\t\t\t\trowsCount++;\n\t\t\t}\n\t\t}\n\t\tthis.accessRowsCount = rowsCount;\n\t\tthis.access = value;\n\n\t\tfor (let code in value)\n\t\t{\n\t\t\tif (value.hasOwnProperty(code))\n\t\t\t{\n\t\t\t\tthis.insertAccessRow(Util.getAccessName(code), code, value[code]);\n\t\t\t}\n\t\t}\n\t\tthis.checkAccessTableHeight();\n\t}\n\n\tinitAccessController()\n\t{\n\t\tthis.buildAccessController();\n\t\tif (this.sectionManager && this.sectionManager.calendarType === 'group')\n\t\t{\n\t\t\tthis.initDialogGroup();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.initDialogStandard();\n\t\t}\n\t\tthis.initAccessSelectorPopup();\n\t}\n\n\tinitAccessSelectorPopup()\n\t{\n\t\tEvent.bind(this.DOM.accessWrap, 'click', (e) => {\n\t\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\t\tif (Type.isElementNode(target))\n\t\t\t{\n\t\t\t\tif (target.getAttribute('data-bx-calendar-access-selector') !== null)\n\t\t\t\t{\n\t\t\t\t\t// show selector\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-selector');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showAccessSelectorPopup({\n\t\t\t\t\t\t\t\tnode: this.accessControls[code].removeIcon,\n\t\t\t\t\t\t\t\tsetValueCallback: (value) => {\n\t\t\t\t\t\t\t\t\tif (this.accessTasks[value] && this.accessControls[code])\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.accessControls[code].valueNode.innerHTML =\n\t\t\t\t\t\t\t\t\t\t\tText.encode(this.accessTasks[value].title);\n\t\t\t\t\t\t\t\t\t\tthis.access[code] = value;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target.getAttribute('data-bx-calendar-access-remove') !== null)\n\t\t\t\t{\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-remove');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.remove(this.accessControls[code].rowNode);\n\t\t\t\t\t\tthis.accessControls[code] = null;\n\t\t\t\t\t\tdelete this.access[code];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tbuildAccessController()\n\t{\n\t\tthis.DOM.accessLink = this.DOM.optionsWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-new-calendar-option-more\">${Loc.getMessage('EC_SEC_SLIDER_ACCESS')}</div>`,\n\t\t);\n\n\t\tthis.DOM.accessWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-access-container\">\n\t\t\t\t\t<div class=\"calendar-list-slider-access-inner-wrap\">\n\t\t\t\t\t\t${this.DOM.accessTable = Tag.render`\n\t\t\t\t\t\t\t<table class=\"calendar-section-slider-access-table\"></table>\n\t\t\t\t\t\t`}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-list-slider-new-calendar-options-container\">\n\t\t\t\t\t\t${this.DOM.accessButton = Tag.render`\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-new-calendar-option-add\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_ACCESS_ADD')}\n\t\t\t\t\t\t\t</span>`\n\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</div>`,\n\t\t);\n\n\t\tthis.accessControls = {};\n\t\tthis.accessTasks = this.sectionAccessTasks;\n\n\t\tEvent.bind(this.DOM.accessLink, 'click', () => {\n\t\t\tif (Dom.hasClass(this.DOM.accessWrap, 'shown'))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.DOM.accessWrap, 'shown');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(this.DOM.accessWrap, 'shown');\n\t\t\t}\n\t\t\tthis.checkAccessTableHeight();\n\t\t});\n\t}\n\n\tinitDialogStandard()\n\t{\n\t\tEvent.bind(this.DOM.accessButton, 'click', () => {\n\t\t\tthis.entitySelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.accessButton,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: [],\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t});\n\t\t\tthis.entitySelectorDialog.show();\n\t\t});\n\t}\n\n\tinitDialogGroup()\n\t{\n\t\tEvent.bind(this.DOM.accessButton, 'click', () => {\n\t\t\tthis.entitySelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.accessButton,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: [],\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttabs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'groupAccess',\n\t\t\t\t\t\ttitle: this.sectionManager.ownerName,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'A',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_ADMIN'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'E',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_MODERATORS'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'K',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_MEMBERS'),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t\tthis.entitySelectorDialog.show();\n\t\t});\n\t}\n\n\thandleEntitySelectorChanges()\n\t{\n\t\tconst entityList = this.entitySelectorDialog.getSelectedItems();\n\t\tthis.entitySelectorDialog.hide();\n\t\tif (Type.isArray(entityList))\n\t\t{\n\t\t\tentityList.forEach((entity) => {\n\t\t\t\tlet title;\n\t\t\t\tif (entity.entityId === 'group')\n\t\t\t\t{\n\t\t\t\t\ttitle = this.sectionManager.ownerName + ': ' + entity.title.text;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = entity.title.text;\n\t\t\t\t}\n\t\t\t\tconst code = Util.convertEntityToAccessCode(entity);\n\t\t\t\tUtil.setAccessName(code, title);\n\t\t\t\tthis.insertAccessRow(title, code);\n\t\t\t});\n\t\t}\n\n\t\tRuntime.debounce(() => {\n\t\t\tthis.entitySelectorDialog.destroy();\n\t\t}, 400)();\n\t}\n\n\t// todo: refactor it\n\tinsertAccessRow(title, code, value)\n\t{\n\t\tif (!this.accessControls[code])\n\t\t{\n\t\t\tif (value === undefined)\n\t\t\t{\n\t\t\t\tfor(let taskId in this.sectionAccessTasks)\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.sectionAccessTasks.hasOwnProperty(taskId)\n\t\t\t\t\t\t&& this.sectionAccessTasks[taskId].name === 'calendar_view'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue = taskId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst\n\t\t\t\trowNode = Dom.adjust(this.DOM.accessTable.insertRow(-1), {props : {className: 'calendar-section-slider-access-table-row'}}),\n\t\t\t\ttitleNode = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\t\tprops : {className: 'calendar-section-slider-access-table-cell'},\n\t\t\t\t\thtml: '<span class=\"calendar-section-slider-access-title\">' + Text.encode(title) + ':</span>'}),\n\t\t\t\tvalueCell = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\t\tprops : {className: 'calendar-section-slider-access-table-cell'},\n\t\t\t\t\tattrs: {'data-bx-calendar-access-selector': code}\n\t\t\t\t}),\n\t\t\t\tselectNode = valueCell.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-container'}\n\t\t\t\t})),\n\t\t\t\tvalueNode = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\t\ttext: this.accessTasks[value] ? this.accessTasks[value].title : '',\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-value'}\n\t\t\t\t})),\n\t\t\t\tremoveIcon = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-remove'},\n\t\t\t\t\tattrs: {'data-bx-calendar-access-remove': code}\n\t\t\t\t}));\n\n\t\t\tthis.access[code] = value;\n\n\t\t\tthis.accessControls[code] = {\n\t\t\t\trowNode: rowNode,\n\t\t\t\ttitleNode: titleNode,\n\t\t\t\tvalueNode: valueNode,\n\t\t\t\tremoveIcon: removeIcon\n\t\t\t};\n\t\t}\n\t}\n\n\tcheckAccessTableHeight()\n\t{\n\t\tif (this.checkTableTimeout)\n\t\t{\n\t\t\tthis.checkTableTimeout = clearTimeout(this.checkTableTimeout);\n\t\t}\n\n\t\tthis.checkTableTimeout = setTimeout(() => {\n\t\t\tif (Dom.hasClass(this.DOM.accessWrap, 'shown'))\n\t\t\t{\n\t\t\t\tif (this.DOM.accessWrap.offsetHeight - this.DOM.accessTable.offsetHeight < 36)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.accessWrap.style.maxHeight = parseInt(this.DOM.accessTable.offsetHeight) + 100 + 'px';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.accessWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}, 300);\n\t}\n\n\tshowAccessSelectorPopup(params)\n\t{\n\t\tif (\n\t\t\tthis.accessPopupMenu\n\t\t\t&& this.accessPopupMenu.popupWindow\n\t\t\t&& this.accessPopupMenu.popupWindow.isShown()\n\t\t)\n\t\t{\n\t\t\treturn this.accessPopupMenu.close();\n\t\t}\n\n\t\tconst _this = this;\n\t\tconst menuItems = [];\n\n\t\tfor(let taskId in this.accessTasks)\n\t\t{\n\t\t\tif (this.accessTasks.hasOwnProperty(taskId))\n\t\t\t{\n\t\t\t\tmenuItems.push(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: this.accessTasks[taskId].title,\n\t\t\t\t\t\tonclick: (function (value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn function ()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tparams.setValueCallback(value);\n\t\t\t\t\t\t\t\t_this.accessPopupMenu.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})(taskId)\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.accessPopupMenu = this.BX.PopupMenu.create(\n\t\t\t'section-access-popup' + Util.randomInt(),\n\t\t\tparams.node,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : true,\n\t\t\t\toffsetTop: -5,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tangle: true,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.accessPopupMenu.show();\n\n\t}\n}\n\n\n\n\n\n\n\n\n","import { Tag, Dom, Loc, Event} from 'main.core';\nimport { EditForm } from '../../sectioninterface/src/editform';\nimport { Util } from 'calendar.util';\n\nexport class EditFormRoom extends EditForm\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Calendar.Rooms.EditFormRoom');\n\n\t\tthis.DOM.outerWrap = options.wrap;\n\t\tthis.roomsManager = options.roomsManager;\n\t\tthis.capacityNumbers = [3, 5, 7, 10, 25];\n\t\tthis.zIndex = options.zIndex || 3100;\n\t\tthis.closeCallback = options.closeCallback;\n\t\tthis.BX = Util.getBX();\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t}\n\n\tshow(params = {})\n\t{\n\t\tthis.actionType = params.actionType;\n\t\tthis.room = params.room;\n\t\tthis.create();\n\t\tthis.showAccess = params.showAccess !== false;\n\t\tif (this.showAccess)\n\t\t{\n\t\t\tDom.style(this.DOM.accessLink, 'display', null);\n\t\t\tDom.style(this.DOM.accessWrap, 'display', null);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.DOM.accessLink, 'display', 'none');\n\t\t\tDom.style(this.DOM.accessWrap, 'display', 'none');\n\t\t}\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\n\t\tif (params.room)\n\t\t{\n\t\t\tif (params.room.color)\n\t\t\t{\n\t\t\t\tthis.setColor(params.room.color);\n\t\t\t}\n\n\t\t\tthis.setAccess(params.room.access || params.room.data.ACCESS || {});\n\n\t\t\tif (params.room.name)\n\t\t\t{\n\t\t\t\tthis.DOM.roomsTitleInput.value = params.room.name;\n\t\t\t}\n\n\t\t\tif(params.room.capacity)\n\t\t\t{\n\t\t\t\tthis.DOM.roomsCapacityInput.value = params.room.capacity;\n\t\t\t}\n\t\t}\n\n\t\tBX.focus(this.DOM.roomsTitleInput);\n\t\tif (this.DOM.roomsTitleInput.value !== '')\n\t\t{\n\t\t\tthis.DOM.roomsTitleInput.select();\n\t\t}\n\n\t\tthis.isOpenedState = true;\n\t}\n\n\tcreate()\n\t{\n\t\tthis.wrap = this.DOM.outerWrap.querySelector('.calendar-form-content');\n\t\tif (this.wrap)\n\t\t{\n\t\t\tDom.clean(this.wrap);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.wrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-form-content\"></div>\n\t\t\t\t`);\n\t\t}\n\n\t\tthis.DOM.formFieldsWrap = this.wrap.appendChild(\n\t\t\tTag.render`\n\t\t\t<div class=\"calendar-list-slider-widget-content\"></div>\n\t\t\t`)\n\t\t\t.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-widget-content-block\"></div>`\n\t\t\t);\n\n\t\t// Title\n\t\tthis.DOM.roomsTitleInput = this.DOM.formFieldsWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t<div class=\"calendar-field-container calendar-field-container-string\"></div>`\n\t\t\t)\n\t\t\t.appendChild(\n\t\t\t\tTag.render`\n\t\t\t<div class=\"calendar-field-block\"></div>`\n\t\t\t)\n\t\t\t.appendChild(\n\t\t\t\tTag.render`\n\t\t\t<input type=\"text\" placeholder=\"${Loc.getMessage('EC_SEC_SLIDER_SECTION_TITLE')}\" \n\t\t\tclass=\"calendar-field calendar-field-string\"/>`);\n\n\t\t//Capacity\n\t\tthis.DOM.roomsCapacityInput = this.DOM.formFieldsWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t<div class=\"calendar-field-container calendar-field-container-string\"></div>`\n\t\t\t)\n\t\t\t.appendChild(\n\t\t\t\tTag.render`\n\t\t\t<div class=\"calendar-field-block\"></div>`\n\t\t\t)\n\t\t\t.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class =\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_SECTION_CAPACITY')}\n\t\t\t\t\t\t</span>\t\n\t\t\t\t\t</div>\t\t\t\t\t\t\n\t\t\t\t\t`\n\t\t\t)\n\t\t\t.appendChild(\n\t\t\t\tTag.render`\n\t\t\t<input type=\"number\" class=\"calendar-field calendar-field-number\" placeholder=\"0\"/>`);\n\n\t\tthis.DOM.optionsWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t<div class=\"calendar-list-slider-new-calendar-options-container\"></div>`\n\t\t);\n\n\t\tthis.initSectionColorSelector();\n\n\t\tthis.initAccessController();\n\n\t\t// Buttons\n\t\tthis.buttonsWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t<div class=\"calendar-list-slider-btn-container\"></div>`\n\t\t);\n\t\tif (this.actionType === 'createRoom')\n\t\t{\n\t\t\tthis.saveBtn = new BX.UI.Button({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_SAVE'),\n\t\t\t\tclassName: 'ui-btn ui-btn-success',\n\t\t\t\tevents: { click: this.createRoom.bind(this) }\n\t\t\t});\n\t\t\tthis.saveBtn.renderTo(this.buttonsWrap);\n\t\t}\n\t\telse if (this.actionType === 'updateRoom')\n\t\t{\n\t\t\tthis.saveBtn = new BX.UI.Button({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_SAVE'),\n\t\t\t\tclassName: 'ui-btn ui-btn-success',\n\t\t\t\tevents: { click: this.updateRoom.bind(this) }\n\t\t\t});\n\t\t\tthis.saveBtn.renderTo(this.buttonsWrap);\n\t\t}\n\t\tnew BX.UI.Button({\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_CANCEL'),\n\t\t\tclassName: 'ui-btn ui-btn-link',\n\t\t\tevents: { click: this.checkClose.bind(this) }\n\t\t}).renderTo(this.buttonsWrap);\n\n\t\tthis.isCreated = true;\n\t}\n\n\tcreateRoom()\n\t{\n\t\tthis.saveBtn.setWaiting(true);\n\t\tthis.roomsManager.createRoom({\n\t\t\t\tname: this.DOM.roomsTitleInput.value,\n\t\t\t\tcapacity: this.DOM.roomsCapacityInput.value,\n\t\t\t\tcolor: this.color,\n\t\t\t\taccess: this.access\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.saveBtn.setWaiting(false);\n\t\t\t\tthis.close();\n\t\t\t});\n\t}\n\n\tinitAccessController()\n\t{\n\t\tthis.buildAccessController();\n\t\tthis.initDialogStandard();\n\t\tthis.initAccessSelectorPopup();\n\t}\n\n\tupdateRoom()\n\t{\n\t\tthis.saveBtn.setWaiting(true);\n\t\tthis.roomsManager.updateRoom({\n\t\t\t\tid: this.room.id,\n\t\t\t\tlocation_id: this.room.location_id,\n\t\t\t\tname: this.DOM.roomsTitleInput.value,\n\t\t\t\tcapacity: this.DOM.roomsCapacityInput.value,\n\t\t\t\tcolor: this.color,\n\t\t\t\taccess: this.access\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.saveBtn.setWaiting(false);\n\t\t\t\tthis.close();\n\t\t\t});\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif(e.keyCode === Util.getKeyCode('escape'))\n\t\t{\n\t\t\tthis.checkClose();\n\t\t}\n\t\telse if(e.keyCode === Util.getKeyCode('enter') && this.actionType === 'createRoom')\n\t\t{\n\t\t\tthis.createRoom();\n\t\t}\n\t\telse if(e.keyCode === Util.getKeyCode('enter') && this.actionType === 'updateRoom')\n\t\t{\n\t\t\tthis.updateRoom();\n\t\t}\n\t}\n}","import { Type, Dom, Loc, Tag, Event } from 'main.core';\nimport { SectionInterface } from 'calendar.sectioninterface';\nimport { Util } from 'calendar.util';\nimport { EditFormRoom } from './editformroom';\n\nexport class RoomsInterface extends SectionInterface\n{\n\tSLIDER_WIDTH = 400;\n\tSLIDER_DURATION = 80;\n\tsliderId = \"calendar:rooms-slider\";\n\tconstructor({ calendarContext, readonly, roomsManager, isConfigureList = false })\n\t{\n\t\tsuper({ calendarContext, readonly, roomsManager });\n\t\tthis.setEventNamespace('BX.Calendar.RoomsInterface');\n\t\tthis.roomsManager = roomsManager;\n\t\tthis.isConfigureList = isConfigureList;\n\t\tthis.calendarContext = calendarContext;\n\t\tthis.readonly = readonly;\n\t\tthis.BX = Util.getBX();\n\t\tthis.sliderOnClose = this.hide.bind(this);\n\t\tthis.deleteRoomHandlerBinded = this.deleteRoomHandler.bind(this);\n\t\tthis.refreshRoomListBinded = this.refreshRoomList.bind(this);\n\t\tif (this.calendarContext !== null)\n\t\t{\n\t\t\tif (this.calendarContext.util.config.accessNames)\n\t\t\t{\n\t\t\t\tUtil.setAccessNames(this.calendarContext?.util?.config?.accessNames);\n\t\t\t}\n\t\t}\n\t}\n\n\taddEventEmitterSubscriptions()\n\t{\n\t\tUtil.getBX().Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Rooms:create',\n\t\t\tthis.refreshRoomListBinded\n\t\t);\n\n\t\tUtil.getBX().Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Rooms:update',\n\t\t\tthis.refreshRoomListBinded\n\t\t);\n\n\t\tUtil.getBX().Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Rooms:delete',\n\t\t\tthis.deleteRoomHandlerBinded\n\t\t);\n\n\t\tUtil.getBX().Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Rooms:pull-create',\n\t\t\tthis.refreshRoomListBinded\n\t\t);\n\t\tUtil.getBX().Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Rooms:pull-update',\n\t\t\tthis.refreshRoomListBinded\n\t\t);\n\t\tUtil.getBX().Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Rooms:pull-delete',\n\t\t\tthis.deleteRoomHandlerBinded\n\t\t);\n\t}\n\n\tdestroyEventEmitterSubscriptions()\n\t{\n\t\tUtil.getBX().Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Rooms:create',\n\t\t\tthis.refreshRoomListBinded\n\t\t);\n\n\t\tUtil.getBX().Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Rooms:update',\n\t\t\tthis.refreshRoomListBinded\n\t\t);\n\n\t\tUtil.getBX().Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Rooms:delete',\n\t\t\tthis.deleteRoomHandlerBinded\n\t\t);\n\n\t\tUtil.getBX().Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Rooms:pull-create',\n\t\t\tthis.refreshRoomListBinded\n\t\t);\n\t\tUtil.getBX().Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Rooms:pull-update',\n\t\t\tthis.refreshRoomListBinded\n\t\t);\n\t\tUtil.getBX().Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Rooms:pull-delete',\n\t\t\tthis.deleteRoomHandlerBinded\n\t\t);\n\t}\n\n\tcreateContent()\n\t{\n\t\tthis.DOM.outerWrap = Tag.render`\n\t\t\t<div class=\"calendar-list-slider-wrap\"></div>\n\t\t`;\n\t\tthis.DOM.titleWrap = this.DOM.outerWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-title-container\">\n\t\t\t\t\t<div class=\"calendar-list-slider-title\">${Loc.getMessage('EC_SECTION_ROOMS')}</div>\n\t\t\t\t</div>\n\t\t\t`\n\t\t);\n\t\tif (!this.readonly)\n\t\t{\n\t\t\t// #1. Controls\n\t\t\tthis.createAddButton();\n\n\t\t\t// #2. Forms\n\t\t\tthis.DOM.roomFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">${Loc.getMessage('EC_SEC_SLIDER_NEW_ROOM')}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t);\n\t\t}\n\t\tthis.createRoomList();\n\t\treturn this.DOM.outerWrap;\n\t}\n\n\tcreateAddButton()\n\t{\n\t\t//add button in slider list of meeting rooms\n\t\tthis.actionType = 'createRoom';\n\t\tconst addButtonOuter = this.DOM.titleWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<span class=\"ui-btn-light-border\" style=\"margin-right: 0\"></span>\n\t\t\t`\n\t\t);\n\t\tthis.DOM.addButton = addButtonOuter.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<span class=\"ui-btn\" onclick=\"${this.showEditRoomForm.bind(this)}\">${Loc.getMessage('EC_ADD')}</span>\n\t\t\t`\n\t\t);\n\t}\n\n\tcreateRoomList()\n\t{\n\t\tlet title;\n\t\tthis.sliderRoom = this.roomsManager.getRooms();\n\t\t// title = Loc.getMessage('EC_SEC_SLIDER_TYPE_ROOM_LIST');\n\t\tif (this.DOM.roomListWrap)\n\t\t{\n\t\t\tDom.clean(this.DOM.roomListWrap);\n\t\t\tDom.adjust(this.DOM.roomListWrap, {\n\t\t\t\tprops: { className: 'calendar-list-slider-card-widget' }\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.roomListWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget\">\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t);\n\t\t}\n\n\t\tthis.createRoomBlock({\n\t\t\twrap: this.DOM.roomListWrap,\n\t\t\troomList: this.sliderRoom.filter(function(room) {\n\t\t\t\treturn room.belongsToView() || room.isPseudo();\n\t\t\t})\n\t\t});\n\t}\n\n\tshowEditRoomForm(params = {})\n\t{\n\t\tif (typeof params.actionType === 'undefined')\n\t\t{\n\t\t\tparams.actionType = 'createRoom';\n\t\t}\n\t\tthis.closeForms();\n\t\tconst formTitleNode = this.DOM.roomFormWrap.querySelector('.calendar-list-slider-card-widget-title-text');\n\n\t\tthis.editSectionForm = new EditFormRoom({\n\t\t\twrap: this.DOM.roomFormWrap,\n\t\t\tsectionAccessTasks: this.roomsManager.getSectionAccessTasks(),\n\t\t\troomsManager: this.roomsManager,\n\t\t\tcloseCallback: () => {\n\t\t\t\tthis.allowSliderClose();\n\t\t\t}\n\t\t});\n\n\t\tlet showAccessControl = true;\n\t\tif (params.room && params.room.id)\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_EDIT_SECTION_ROOM');\n\t\t\tshowAccessControl = params.room.canDo('access');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_NEW_ROOM');\n\t\t}\n\n\t\tthis.editSectionForm.show({\n\t\t\tshowAccess: showAccessControl,\n\t\t\troom: params.room || {\n\t\t\t\tcolor: Util.getRandomColor(),\n\t\t\t\taccess: this.roomsManager.getDefaultSectionAccess()\n\t\t\t},\n\t\t\tactionType: params.actionType\n\t\t});\n\n\t\tthis.denySliderClose();\n\t}\n\n\tshowRoomMenu(room, menuItemNode)\n\t{\n\t\tconst menuItems = [];\n\t\tconst itemNode = menuItemNode.closest('[data-bx-calendar-section]')\n\t\t\t|| menuItemNode.closest('[ data-bx-calendar-section-without-action]');\n\t\tif (Type.isElementNode(itemNode))\n\t\t{\n\t\t\tDom.addClass(itemNode, 'active');\n\t\t}\n\n\t\tif (room.canDo('view_time') && !this.isConfigureList)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_LEAVE_ONE_ROOM'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.roomActionMenu.close();\n\t\t\t\t\tthis.showOnlyOneSection(room, this.roomsManager.rooms);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!this.readonly && room.canDo('edit_section'))\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_EDIT'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.roomActionMenu.close();\n\t\t\t\t\tthis.showEditRoomForm({ room: room, actionType: 'updateRoom' });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (room.canDo('edit_section') && room.belongsToView())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_DELETE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.roomActionMenu.close();\n\t\t\t\t\tthis.deleteRoom(room);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (menuItems && menuItems.length > 0)\n\t\t{\n\t\t\tthis.roomActionMenu = top.BX.PopupMenu.create(\n\t\t\t\t'section-menu-' + Util.getRandomInt(),\n\t\t\t\tmenuItemNode,\n\t\t\t\tmenuItems,\n\t\t\t\t{\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tzIndex: this.zIndex,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 9,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcacheable: false\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.roomActionMenu.show();\n\t\t\tthis.roomActionMenu.popupWindow.subscribe('onClose', () => {\n\t\t\t\tif (Type.isElementNode(itemNode))\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(itemNode, 'active');\n\t\t\t\t}\n\t\t\t\tthis.allowSliderClose();\n\t\t\t});\n\n\t\t\tthis.denySliderClose();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(itemNode, 'active');\n\t\t}\n\t}\n\n\trefreshRoomList()\n\t{\n\t\tthis.createRoomList();\n\t}\n\n\tcreateRoomBlock({ wrap, roomList })\n\t{\n\t\tif (Type.isArray(roomList))\n\t\t{\n\t\t\tconst listWrap = wrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-widget-content\"></div>\n\t\t\t\t`\n\t\t\t\t)\n\t\t\t\t.appendChild(\n\t\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-widget-content-block\"></div>\n\t\t\t\t\t`\n\t\t\t\t)\n\t\t\t\t.appendChild(\n\t\t\t\t\tTag.render`\n\t\t\t\t\t<ul class=\"calendar-list-slider-container\"></ul>\n\t\t\t\t\t`\n\t\t\t\t);\n\t\t\tEvent.bind(listWrap, 'click', this.roomClickHandler.bind(this));\n\n\t\t\troomList.forEach((room) => {\n\t\t\t\tif (!room.DOM)\n\t\t\t\t{\n\t\t\t\t\troom.DOM = {};\n\t\t\t\t}\n\t\t\t\tconst roomId = room.id;\n\n\t\t\t\tlet li;\n\t\t\t\tlet checkbox;\n\t\t\t\tif (this.isConfigureList)\n\t\t\t\t{\n\t\t\t\t\tli = listWrap.appendChild(\n\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t<li class=\"calendar-list-slider-item\"  data-bx-calendar-section-without-action=\"${roomId}\"></li>\n\t\t\t\t\t`\n\t\t\t\t\t);\n\t\t\t\t\tcheckbox = li.appendChild(Dom.create('DIV', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'calendar-field-select-icon'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstyle: { backgroundColor: room.color }\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tli = listWrap.appendChild(\n\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t<li class=\"calendar-list-slider-item\" data-bx-calendar-section=\"${roomId}\"></li>\n\t\t\t\t\t`\n\t\t\t\t\t);\n\t\t\t\t\tcheckbox = li.appendChild(Dom.create('DIV', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'calendar-list-slider-item-checkbox'\n\t\t\t\t\t\t\t\t+ (room.isShown() ? ' calendar-list-slider-item-checkbox-checked' : '')\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstyle: { backgroundColor: room.color }\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tconst title = li.appendChild(\n\t\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-item-name\" title=\"${BX.util.htmlspecialchars(room.name)}\">${BX.util.htmlspecialchars(room.name)}</div>\n\t\t\t\t\t`\n\t\t\t\t);\n\n\t\t\t\troom.DOM.item = li;\n\t\t\t\troom.DOM.checkbox = checkbox;\n\t\t\t\troom.DOM.title = title;\n\n\t\t\t\troom.DOM.actionCont = li.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-item-actions-container\" data-bx-calendar-section-menu=\"${roomId}\">\n\t\t\t\t\t\t<span class=\"calendar-list-slider-item-context-menu\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\n\troomClickHandler(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\n\t\tif (target && target.getAttribute)\n\t\t{\n\t\t\tif (target.getAttribute('data-bx-calendar-section-menu') !== null)\n\t\t\t{\n\t\t\t\tlet roomId = target.getAttribute('data-bx-calendar-section-menu');\n\t\t\t\tthis.showRoomMenu(this.roomsManager.getRoom(roomId), target);\n\t\t\t}\n\t\t\telse if (target.getAttribute('data-bx-calendar-section') !== null)\n\t\t\t{\n\t\t\t\tlet roomId = target.getAttribute('data-bx-calendar-section');\n\t\t\t\tthis.switchSection(this.roomsManager.getRoom(roomId));\n\t\t\t}\n\t\t}\n\t}\n\n\tfindCheckBoxNodes(id)\n\t{\n\t\treturn this.DOM.roomListWrap.querySelectorAll(\n\t\t\t'.calendar-list-slider-item[data-bx-calendar-section=\\''\n\t\t\t+ id\n\t\t\t+ '\\'] .calendar-list-slider-item-checkbox'\n\t\t);\n\t}\n\n\tdestroy(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\tthis.destroyEventEmitterSubscriptions();\n\t\t\tBX.removeCustomEvent('SidePanel.Slider:onCloseComplete', BX.proxy(this.destroy, this));\n\t\t\tBX.SidePanel.Instance.destroy(this.sliderId);\n\t\t\tdelete this.DOM.roomListWrap;\n\n\t\t\tif (this.roomActionMenu)\n\t\t\t{\n\t\t\t\tthis.roomActionMenu.close();\n\t\t\t}\n\t\t}\n\t}\n\n\tdeleteRoomHandler(event)\n\t{\n\t\tif (event && event instanceof Util.getBX().Event.BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tconst deleteID = parseInt(data.id);\n\n\t\t\tthis.sliderRoom.forEach((room, index) => {\n\t\t\t\tif (parseInt(room.id) === deleteID && room.DOM && room.DOM.item)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(room.DOM.item, 'calendar-list-slider-item-disappearing');\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tDom.clean(room.DOM.item, true);\n\t\t\t\t\t\tthis.sliderRoom.splice(index, 1);\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tthis.closeForms();\n\t\t}\n\t}\n\n\tdeleteRoom(room)\n\t{\n\t\tthis.roomsManager.deleteRoom(\n\t\t\troom.id,\n\t\t\troom.location_id\n\t\t);\n\t}\n}\n"],"names":["ReserveButton","params","setEventNamespace","zIndex","popupId","id","Math","round","random","showTasks","addEntryHandler","Type","isFunction","addEntry","addTaskHandler","addTask","create","DOM","wrap","Dom","props","className","type","html","Loc","getMessage","events","click","bind","AddButton","EditForm","options","outerWrap","sectionAccessTasks","sectionManager","closeCallback","BX","Util","getBX","keyHandlerBinded","keyHandler","section","showAccess","accessLink","style","display","accessWrap","Event","document","addClass","color","setColor","setAccess","access","data","ACCESS","name","sectionTitleInput","value","focus","select","isOpenedState","unbind","removeClass","querySelector","clean","appendChild","formFieldsWrap","attrs","placeholder","optionsWrap","initSectionColorSelector","initAccessController","buttonsWrap","saveBtn","UI","Button","text","save","renderTo","checkClose","isCreated","e","keyCode","getKeyCode","close","setWaiting","saveSection","then","colorContWrap","colorIcon","colorChangeLink","showSimplePicker","colors","Runtime","clone","getDefaultColorList","innerCont","colorWrap","delegate","simplePickerClick","moreLinkWrap","moreLink","showFullPicker","simplePickerColorWrap","includes","push","i","length","node","backgroundColor","lastActiveNode","util","array_search","simpleColorPopup","PopupWindowManager","getRandomInt","autoHide","closeByEsc","offsetTop","offsetLeft","lightShadow","content","cacheable","setAngle","offset","show","target","findTargetNode","srcElement","isElementNode","getAttribute","fullColorPicker","ColorPicker","bindElement","onColorSelected","popupOptions","onPopupClose","open","rowsCount","code","hasOwnProperty","accessRowsCount","insertAccessRow","getAccessName","checkAccessTableHeight","buildAccessController","calendarType","initDialogGroup","initDialogStandard","initAccessSelectorPopup","accessControls","showAccessSelectorPopup","removeIcon","setValueCallback","accessTasks","valueNode","innerHTML","Text","encode","title","remove","rowNode","Tag","render","accessTable","accessButton","hasClass","entitySelectorDialog","EntitySelectorDialog","targetNode","context","preselectedItems","enableSearch","handleEntitySelectorChanges","targetContainer","body","entities","selectMode","tabs","ownerName","items","ownerId","entityId","entityList","getSelectedItems","hide","isArray","forEach","entity","convertEntityToAccessCode","setAccessName","debounce","destroy","undefined","taskId","adjust","insertRow","titleNode","insertCell","valueCell","selectNode","checkTableTimeout","clearTimeout","setTimeout","offsetHeight","maxHeight","parseInt","accessPopupMenu","popupWindow","isShown","_this","menuItems","onclick","PopupMenu","randomInt","angle","EventEmitter","EditFormRoom","roomsManager","capacityNumbers","actionType","room","roomsTitleInput","capacity","roomsCapacityInput","createRoom","updateRoom","location_id","RoomsInterface","calendarContext","readonly","isConfigureList","sliderOnClose","deleteRoomHandlerBinded","deleteRoomHandler","refreshRoomListBinded","refreshRoomList","config","accessNames","setAccessNames","subscribe","unsubscribe","titleWrap","createAddButton","roomFormWrap","createRoomList","addButtonOuter","addButton","showEditRoomForm","sliderRoom","getRooms","roomListWrap","createRoomBlock","roomList","filter","belongsToView","isPseudo","closeForms","formTitleNode","editSectionForm","getSectionAccessTasks","allowSliderClose","showAccessControl","canDo","getRandomColor","getDefaultSectionAccess","denySliderClose","menuItemNode","itemNode","closest","roomActionMenu","showOnlyOneSection","rooms","deleteRoom","top","listWrap","roomClickHandler","roomId","li","checkbox","htmlspecialchars","item","actionCont","showRoomMenu","getRoom","switchSection","querySelectorAll","event","getSlider","getUrl","sliderId","destroyEventEmitterSubscriptions","removeCustomEvent","proxy","SidePanel","Instance","BaseEvent","getData","deleteID","index","splice","SectionInterface"],"mappings":"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"}