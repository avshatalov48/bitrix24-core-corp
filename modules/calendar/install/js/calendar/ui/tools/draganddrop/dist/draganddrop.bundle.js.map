{"version":3,"file":"draganddrop.bundle.js","sources":["../src/draganddropinterface.js","../src/eventdraganddrop.js","../src/resizedraganddrop.js"],"sourcesContent":["/**\n * @interface\n */\nexport default class DragAndDropInterface\n{\n\tonDragStart() {}\n\n\tgetDragBoundary() {}\n\n\tgetFinalFrom() {}\n\n\tgetFinalTo() {}\n}\n","import DragAndDropInterface from './draganddropinterface';\n\n/**\n * @implements DragAndDropInterface\n */\nexport class EventDragAndDrop implements DragAndDropInterface\n{\n\tmaxTryDuration = 50;\n\t// stickDistanceInMinutes = 30;\n\tstickDistanceInPercents = 34;\n\tmagnetizeDistanceInMinutes = 15;\n\n\tconstructor(getDateByPos, getPosByDate, getEvents)\n\t{\n\t\tthis.getDateByPos = getDateByPos;\n\t\tthis.getPosByDate = getPosByDate;\n\t\tthis.getEvents = getEvents;\n\t}\n\n\tgetFinalFrom()\n\t{\n\t\treturn this.finalFrom;\n\t}\n\n\tgetFinalTo()\n\t{\n\t\treturn this.finalTo;\n\t}\n\n\tonDragStart(duration, startPosition = 0)\n\t{\n\t\tthis.savedDuration = duration;\n\t\tthis.tryDuration = 0;\n\t\tconst startBoundary = this.getBoundaryFromPosition(startPosition);\n\t\tthis.finalFrom = startBoundary.from;\n\t\tthis.finalTo = startBoundary.to;\n\t}\n\n\tgetDragBoundary(position)\n\t{\n\t\tconst diff = this.previousPosition ? this.previousPosition - position : 0;\n\t\tthis.previousPosition = position;\n\t\tthis.calculateTryDuration(diff);\n\t\tthis.resetMagnetStamps(diff);\n\n\t\tlet boundary = this.getBoundaryFromPosition(position);\n\t\tif (this.doMagnetize())\n\t\t{\n\t\t\tboundary = this.getMagnetizedBoundary(boundary, diff);\n\t\t}\n\t\tboundary.size = this.getPosByDate(boundary.to) - this.getPosByDate(boundary.from);\n\n\t\tthis.finalFrom = boundary.from;\n\t\tthis.finalTo = boundary.to;\n\t\treturn boundary;\n\t}\n\n\tgetBoundaryFromPosition(position)\n\t{\n\t\tconst from = this.getDateByPos(position);\n\t\tconst to = from ? new Date(from.getTime() + this.savedDuration) : null;\n\t\treturn { from, to, position, wasMagnetized: false };\n\t}\n\n\tgetMagnetizedBoundary(boundary, diff)\n\t{\n\t\tlet position = boundary.position;\n\t\tlet duration = this.savedDuration;\n\n\t\tconst magnetizedTimeInterval = this.getMagnetizedTimeInterval(boundary.from, boundary.to);\n\t\tconst magnetizedFromPosition = this.getPosByDate(magnetizedTimeInterval.from);\n\t\tconst wasMagnetized = magnetizedTimeInterval.wasMagnetizedTo || magnetizedTimeInterval.wasMagnetizedFrom;\n\t\tif (wasMagnetized)\n\t\t{\n\t\t\tposition = magnetizedFromPosition;\n\t\t\tduration = magnetizedTimeInterval.to.getTime() - magnetizedTimeInterval.from.getTime();\n\t\t}\n\n\t\t// stabilize magnets\n\t\tif (!this.endMagnetStamp && boundary.to.getTime() < magnetizedTimeInterval.to.getTime() && diff < 0)\n\t\t{\n\t\t\tthis.endMagnetStamp = position;\n\t\t}\n\t\tif (this.endMagnetStamp)\n\t\t{\n\t\t\tif (this.endMagnetStamp + 5 < position)\n\t\t\t{\n\t\t\t\tthis.endMagnetStamp = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tposition = this.endMagnetStamp;\n\t\t\t}\n\t\t}\n\t\tif (!this.startMagnetStamp && boundary.from.getTime() > magnetizedTimeInterval.from.getTime() && diff > 0)\n\t\t{\n\t\t\tthis.startMagnetStamp = position;\n\t\t}\n\t\tif (this.startMagnetStamp)\n\t\t{\n\t\t\tif (magnetizedFromPosition < this.startMagnetStamp)\n\t\t\t{\n\t\t\t\tthis.startMagnetStamp = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tposition = this.startMagnetStamp;\n\t\t\t}\n\t\t}\n\n\t\tconst from = this.getDateByPos(position);\n\t\tconst to = new Date(from.getTime() + duration);\n\t\treturn { from, to, position, wasMagnetized };\n\t}\n\n\t/**\n\t * stick - behavior when dragged event intersects with another event\n\t * and we push dragged event to top or to bottom of another event\n\t *\n\t * magnetize - behavior when dragged event is close to another event\n\t * and we move it closer to another event\n\t */\n\tgetMagnetizedTimeInterval(fromDate, toDate)\n\t{\n\t\tlet wasMagnetizedFrom = false;\n\t\tlet wasMagnetizedTo = false;\n\t\tlet from = new Date(fromDate.getTime());\n\t\tlet to = new Date(toDate.getTime());\n\t\tconst duration = to.getTime() - from.getTime();\n\t\tconst magnetDistance = this.magnetizeDistanceInMinutes * 60 * 1000;\n\t\tconst stickDistance = (this.stickDistanceInPercents / 100) * this.savedDuration;\n\n\t\t// find lowest fromDate and highest toDate\n\t\tlet fromDateMax = new Date(from.getTime());\n\t\tfromDateMax.setHours(0, 0, 0, 0);\n\t\tlet toDateMin = new Date(to.getTime());\n\t\ttoDateMin.setHours(23, 59, 0, 0);\n\n\t\tconst events = this.getEvents();\n\t\tfor (const event of events)\n\t\t{\n\t\t\tconst eventFrom = event.from.getTime();\n\t\t\tconst eventTo = event.to.getTime();\n\n\t\t\tif (eventTo > fromDateMax.getTime() && eventTo <= to.getTime())\n\t\t\t{\n\t\t\t\tfromDateMax = new Date(eventTo);\n\t\t\t}\n\n\t\t\tif (eventFrom < toDateMin.getTime() && eventFrom >= from.getTime())\n\t\t\t{\n\t\t\t\ttoDateMin = new Date(eventFrom);\n\t\t\t}\n\t\t}\n\n\t\t// if too many events\n\t\tif (fromDateMax.getTime() >= toDateMin.getTime())\n\t\t{\n\t\t\treturn { from, to, wasMagnetizedFrom, wasMagnetizedTo };\n\t\t}\n\n\t\t// stick\n\t\tif (fromDateMax.getTime() > from.getTime() && (fromDateMax.getTime() - from.getTime() <= stickDistance))\n\t\t{\n\t\t\tfrom = new Date(fromDateMax.getTime());\n\t\t\tto = new Date(from.getTime() + duration);\n\t\t\twasMagnetizedFrom = true;\n\t\t}\n\t\tif (toDateMin.getTime() < to.getTime() && (to.getTime() - toDateMin.getTime() <= stickDistance))\n\t\t{\n\t\t\tto = new Date(toDateMin.getTime());\n\t\t\tfrom = new Date(to.getTime() - duration);\n\t\t\twasMagnetizedTo = true;\n\t\t}\n\t\tif (fromDateMax.getTime() > from.getTime() && (fromDateMax.getTime() - from.getTime() <= stickDistance))\n\t\t{\n\t\t\tfrom = new Date(fromDateMax.getTime());\n\t\t\tto = new Date(from.getTime() + duration);\n\t\t\twasMagnetizedFrom = true;\n\t\t}\n\t\tif (wasMagnetizedFrom && wasMagnetizedTo)\n\t\t{\n\t\t\tfrom = new Date(fromDateMax.getTime());\n\t\t\tto = new Date(toDateMin.getTime());\n\t\t}\n\n\t\t// magnetize\n\t\tif (!wasMagnetizedFrom && !wasMagnetizedTo)\n\t\t{\n\t\t\tif (from.getTime() > fromDateMax.getTime() && (from.getTime() - fromDateMax.getTime() <= magnetDistance))\n\t\t\t{\n\t\t\t\twasMagnetizedFrom = true;\n\t\t\t}\n\t\t\tif (toDateMin.getTime() > to.getTime() && (toDateMin.getTime() - to.getTime() <= magnetDistance))\n\t\t\t{\n\t\t\t\twasMagnetizedTo = true;\n\t\t\t}\n\t\t\tif (wasMagnetizedFrom && !wasMagnetizedTo)\n\t\t\t{\n\t\t\t\tfrom = new Date(fromDateMax.getTime());\n\t\t\t\tto = new Date(from.getTime() + duration);\n\t\t\t}\n\t\t\tif (wasMagnetizedTo && !wasMagnetizedFrom)\n\t\t\t{\n\t\t\t\tto = new Date(toDateMin.getTime());\n\t\t\t\tfrom = new Date(to.getTime() - duration);\n\t\t\t}\n\t\t}\n\n\t\treturn { from, to, wasMagnetizedFrom, wasMagnetizedTo };\n\t}\n\n\tresetMagnetStamps(diff)\n\t{\n\t\tif (diff > 0)\n\t\t{\n\t\t\tthis.endMagnetStamp = null;\n\t\t}\n\t\tif (diff < 0)\n\t\t{\n\t\t\tthis.startMagnetStamp = null;\n\t\t}\n\t}\n\n\tcalculateTryDuration(diff)\n\t{\n\t\tif (Math.abs(diff) < 1)\n\t\t{\n\t\t\tthis.tryDuration++;\n\t\t}\n\t\tif (Math.abs(diff) > 3)\n\t\t{\n\t\t\tthis.tryDuration = 0;\n\t\t}\n\t}\n\n\tdoMagnetize()\n\t{\n\t\treturn !this.isAnyModifierKeyPressed() && !this.isUserTryingToTurnOffMagnet();\n\t}\n\n\tisUserTryingToTurnOffMagnet()\n\t{\n\t\treturn this.tryDuration > this.maxTryDuration;\n\t}\n\n\tisAnyModifierKeyPressed()\n\t{\n\t\tif (window.event)\n\t\t{\n\t\t\treturn window.event.altKey || window.event.shiftKey || window.event.ctrlKey || window.event.metaKey;\n\t\t}\n\t\treturn true;\n\t}\n\n}\n","import DragAndDropInterface from './draganddropinterface';\n\n/**\n * @implements DragAndDropInterface\n */\nexport class ResizeDragAndDrop implements DragAndDropInterface\n{\n\n\tconstructor(getDateByPos, getPosByDate)\n\t{\n\t\tthis.getDateByPos = getDateByPos;\n\t\tthis.getPosByDate = getPosByDate;\n\t}\n\n\tgetFinalFrom()\n\t{\n\t\treturn this.from;\n\t}\n\n\tgetFinalTo()\n\t{\n\t\treturn this.to;\n\t}\n\n\tonDragStart(timeInterval, minSize = 0, isStartResizer = false)\n\t{\n\t\tthis.from = timeInterval.from;\n\t\tthis.to = timeInterval.to;\n\t\tthis.isStartResizer = isStartResizer;\n\t\tthis.direction = isStartResizer ? -1 : 1;\n\n\t\tthis.positionStart = this.getPosByDate(this.from);\n\t\tthis.positionEnd = this.getPosByDate(this.to);\n\t\tthis.size = this.positionEnd - this.positionStart;\n\t\tthis.minSize = minSize;\n\t}\n\n\tgetDragBoundary(dy)\n\t{\n\t\tconst size = Math.max(this.size + dy * this.direction, this.minSize);\n\n\t\tif (this.isStartResizer)\n\t\t{\n\t\t\tthis.positionStart = this.positionEnd - size;\n\t\t\tconst timeFrom = this.getDateByPos(this.positionStart);\n\t\t\tthis.from.setHours(timeFrom.getHours(), timeFrom.getMinutes(), 0, 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.positionEnd = this.positionStart + size;\n\t\t\tconst timeTo = this.getDateByPos(this.positionEnd);\n\t\t\tthis.to.setHours(timeTo.getHours(), timeTo.getMinutes(), 0, 0);\n\t\t}\n\n\t\treturn { from: this.from, to: this.to, position: this.positionStart, size };\n\t}\n\n}\n"],"names":["EventDragAndDrop","constructor","getDateByPos","getPosByDate","getEvents","maxTryDuration","stickDistanceInPercents","magnetizeDistanceInMinutes","getFinalFrom","finalFrom","getFinalTo","finalTo","onDragStart","duration","startPosition","savedDuration","tryDuration","startBoundary","getBoundaryFromPosition","from","to","getDragBoundary","position","diff","previousPosition","calculateTryDuration","resetMagnetStamps","boundary","doMagnetize","getMagnetizedBoundary","size","Date","getTime","wasMagnetized","magnetizedTimeInterval","getMagnetizedTimeInterval","magnetizedFromPosition","wasMagnetizedTo","wasMagnetizedFrom","endMagnetStamp","startMagnetStamp","fromDate","toDate","magnetDistance","stickDistance","fromDateMax","setHours","toDateMin","events","event","eventFrom","eventTo","Math","abs","isAnyModifierKeyPressed","isUserTryingToTurnOffMagnet","window","altKey","shiftKey","ctrlKey","metaKey","ResizeDragAndDrop","timeInterval","minSize","isStartResizer","direction","positionStart","positionEnd","dy","max","timeFrom","getHours","getMinutes","timeTo"],"mappings":"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"}