{"version":3,"file":"sectionmanager.bundle.js","sources":["../src/calendarsection.js","../src/calendartasksection.js","../src/sectionmanager.js"],"sourcesContent":["import {Util} from 'calendar.util';\nimport { Event, Type } from 'main.core';\n\nexport class CalendarSection\n{\n\tconstructor(data)\n\t{\n\t\tthis.updateData(data);\n\t\tthis.calendarContext = Util.getCalendarContext();\n\t\t// this.sectionManager = this.calendarContext.sectionManager;\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tthis.data = data || {};\n\t\tthis.type = data.CAL_TYPE || '';\n\t\tthis.ownerId = parseInt(data.OWNER_ID) || 0;\n\t\tthis.id = parseInt(data.ID);\n\t\tthis.color = this.data.COLOR;\n\t\tthis.name = this.data.NAME;\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.calendarContext.sectionManager.sectionIsShown(this.id);\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.isShown())\n\t\t{\n\t\t\tlet hiddenSections = this.calendarContext.sectionManager.getHiddenSections();\n\t\t\thiddenSections = hiddenSections.filter((sectionId) => {return sectionId !== this.id;}, this);\n\t\t\tthis.calendarContext.sectionManager.setHiddenSections(hiddenSections);\n\t\t\tthis.calendarContext.sectionManager.saveHiddenSections();\n\t\t}\n\t}\n\n\thide(): void\n\t{\n\t\tif (this.isShown())\n\t\t{\n\t\t\tconst hiddenSections = this.calendarContext.sectionManager.getHiddenSections();\n\t\t\thiddenSections.push(this.id);\n\t\t\tthis.calendarContext.sectionManager.setHiddenSections(hiddenSections);\n\t\t\tthis.calendarContext.sectionManager.saveHiddenSections();\n\t\t}\n\t}\n\n\tremove()\n\t{\n\t\tif (confirm(BX.message('EC_SEC_DELETE_CONFIRM')))\n\t\t{\n\t\t\tconst EventAlias = Util.getBX().Event;\n\t\t\tEventAlias.EventEmitter.emit(\n\t\t\t\t'BX.Calendar.Section:delete',\n\t\t\t\tnew EventAlias.BaseEvent({data: {sectionId: this.id}})\n\t\t\t);\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.deleteCalendarSection', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: this.id\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst sectionManager = Util.getCalendarContext().sectionManager;\n\t\t\t\t\t\tlet reload = true;\n\t\t\t\t\t\tlet section;\n\n\t\t\t\t\t\tfor (let i = 0; i < sectionManager.sections.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsection = sectionManager.sections[i];\n\t\t\t\t\t\t\tif (section.id !== this.id && section.belongsToView())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treload = false;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst calendar = Util.getCalendarContext();\n\t\t\t\t\t\tif (!calendar || reload)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn Util.getBX().reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcalendar.reload();\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\t// this.calendar.displayError(response.errors);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t}\n\t}\n\n\thideGoogle()\n\t{\n\t\tif (confirm(BX.message('EC_CAL_GOOGLE_HIDE_CONFIRM')))\n\t\t{\n\t\t\tthis.hide();\n\t\t\tBX.onCustomEvent(this.calendar, 'BXCalendar:onSectionDelete', [this.id]);\n\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t'BX.Calendar.Section:delete',\n\t\t\t\tnew Event.BaseEvent({data: {sectionId: this.id}})\n\t\t\t);\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.hideExternalCalendarSection', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: this.id\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tconst sectionManager = Util.getCalendarContext().sectionManager;\n\t\t\t\t\t\tlet reload = true;\n\t\t\t\t\t\tlet section;\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor (let i = 0; i < sectionManager.sections.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsection = sectionManager.sections[i];\n\t\t\t\t\t\t\tif (section.id !== this.id && section.belongsToView())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treload = false;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst calendar = Util.getCalendarContext();\n\t\t\t\t\t\tif (!calendar || reload)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn Util.getBX().reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcalendar.reload();\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\t// this.calendar.displayError(response.errors);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t}\n\t}\n\n\tgetLink()\n\t{\n\t\treturn this.data && this.data.LINK ? this.data.LINK : '';\n\t}\n\n\tcanBeConnectedToOutlook()\n\t{\n\t\treturn !this.isPseudo() && this.data.OUTLOOK_JS && !(this.data.CAL_DAV_CAL && this.data.CAL_DAV_CON) && !BX.browser.IsMac();\n\t}\n\n\tconnectToOutlook()\n\t{\n\t\tif (!window.jsOutlookUtils)\n\t\t{\n\t\t\tBX.loadScript('/bitrix/js/calendar/outlook.js', BX.delegate(function ()\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\teval(this.data.OUTLOOK_JS);\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t}, this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\teval(this.data.OUTLOOK_JS);\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t}\n\t\t}\n\t}\n\n\tcanDo(action)\n\t{\n\t\t//action: access|add|edit|edit_section|view_full|view_time|view_title\n\t\tif (this.isVirtual() && ['access','add','edit'].includes(action))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (action === 'view_event')\n\t\t{\n\t\t\taction = 'view_time';\n\t\t}\n\t\t\n\t\tif (!this.data.PERM[action])\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.data.PERM && this.data.PERM[action];\n\t}\n\n\tisSuperposed()\n\t{\n\t\treturn !this.isPseudo() && !!this.data.SUPERPOSED;\n\t}\n\n\tisPseudo()\n\t{\n\t\treturn false;\n\t}\n\n\tisVirtual()\n\t{\n\t\treturn (this.data.CAL_DAV_CAL && this.data.CAL_DAV_CAL.indexOf('@virtual/events/') !== -1)\n\t\t\t|| (this.data.GAPI_CALENDAR_ID && this.data.GAPI_CALENDAR_ID.indexOf('@group.v.calendar.google.com') !== -1)\n\t\t\t|| (this.data.EXTERNAL_TYPE === 'google_readonly')\n\t\t\t|| (this.data.EXTERNAL_TYPE === 'google_freebusy')\n\t}\n\n\tisGoogle()\n\t{\n\t\treturn !!this.data.GAPI_CALENDAR_ID;\n\t}\n\n\tisCalDav()\n\t{\n\t\treturn !this.isPseudo() && this.data.CAL_DAV_CAL && this.data.CAL_DAV_CON;\n\t}\n\n\tisCompanyCalendar()\n\t{\n\t\treturn !this.isPseudo() && this.type !== 'user' && this.type !== 'group' && !this.ownerId;\n\t}\n\n\tisLocationRoom()\n\t{\n\t\treturn this.type === 'location';\n\t}\n\n\tbelongsToView()\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\treturn this.type === calendarContext.getCalendarType()\n\t\t\t&& this.ownerId === calendarContext.getOwnerId();\n\t}\n\n\tbelongsToOwner()\n\t{\n\t\treturn this.belongsToUser(Util.getCalendarContext().getUserId());\n\t}\n\n\tbelongsToUser(userId)\n\t{\n\t\treturn this.type === 'user'\n\t\t\t&& this.ownerId === parseInt(userId)\n\t\t\t&& this.data.ACTIVE !== 'N';\n\t}\n\n\tisActive()\n\t{\n\t\treturn this.data.ACTIVE !== 'N';\n\t}\n\n\tgetType()\n\t{\n\t\treturn this.type;\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn this.ownerId;\n\t}\n}","import {Util} from 'calendar.util';\nimport { Event, Type, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { CalendarSection } from './calendarsection';\n\nexport class CalendarTaskSection extends CalendarSection\n{\n\tconstructor(data = {}, {type, userId, ownerId})\n\t{\n\t\tconst defaultColor = '#ff5b55';\n\t\tlet defaultName = Loc.getMessage('EC_SEC_MY_TASK_DEFAULT');\n\n\t\tif(type === 'user' && userId !== ownerId)\n\t\t{\n\t\t\tdefaultName = Loc.getMessage('EC_SEC_USER_TASK_DEFAULT');\n\t\t}\n\t\telse if(type === 'group')\n\t\t{\n\t\t\tdefaultName = Loc.getMessage('EC_SEC_GROUP_TASK_DEFAULT');\n\t\t}\n\n\t\tsuper({\n\t\t\tID: 'tasks',\n\t\t\tNAME: data.name || defaultName,\n\t\t\tCOLOR: data.color || defaultColor,\n\t\t\tPERM: {\n\t\t\t\tedit_section:true,\n\t\t\t\tview_full:true,\n\t\t\t\tview_time:true,\n\t\t\t\tview_title:true\n\t\t\t}\n\t\t});\n\t}\n\n\tisPseudo(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tsuper.updateData(data);\n\t\tthis.id = data.ID;\n\t}\n}","import { Util } from 'calendar.util';\nimport { Event, Loc, Type, Runtime } from 'main.core';\nimport { CalendarSection } from './calendarsection';\nimport { CalendarTaskSection } from './calendartasksection';\nimport { EventEmitter } from 'main.core.events';\nexport { CalendarSection };\n\nexport class SectionManager\n{\n\tstatic newEntrySectionId = null;\n\tstatic RELOAD_DELAY = 500;\n\n\tconstructor(data, config)\n\t{\n\t\tthis.setSections(data.sections);\n\t\tthis.setConfig(config);\n\t\tthis.addTaskSection();\n\t\tthis.sortSections();\n\t\tEventEmitter.subscribeOnce('BX.Calendar.Section:delete', this.deleteSectionHandler.bind(this));\n\n\t\tthis.reloadDataDebounce = Runtime.debounce(this.reloadData, SectionManager.RELOAD_DELAY, this);\n\t}\n\n\tsetSections(rawSections = [])\n\t{\n\t\tthis.sections = [];\n\t\tthis.sectionIndex = {};\n\n\t\trawSections.forEach((sectionData) => {\n\t\t\tconst section = new CalendarSection(sectionData);\n\t\t\tif (section.canDo('view_time'))\n\t\t\t{\n\t\t\t\tthis.sections.push(section);\n\t\t\t\tthis.sectionIndex[section.getId()] = this.sections.length - 1;\n\t\t\t}\n\t\t});\n\t}\n\n\tsortSections()\n\t{\n\t\tthis.sectionIndex = {};\n\t\tthis.sections = this.sections.sort((a, b) => {\n\t\t\tif (Type.isFunction(a.isPseudo) && a.isPseudo())\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse if (Type.isFunction(b.isPseudo) && b.isPseudo())\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn a.name.localeCompare(b.name);\n\t\t});\n\n\t\tthis.sections.forEach((section, index) => {\n\t\t\tthis.sectionIndex[section.getId()] = index;\n\t\t});\n\t}\n\n\tsetConfig(config)\n\t{\n\t\tthis.setHiddenSections(config.hiddenSections);\n\t\tthis.calendarType = config.type;\n\t\tthis.ownerId = config.ownerId;\n\t\tthis.ownerName = config.ownerName || '';\n\t\tthis.userId = config.userId;\n\t\tthis.defaultSectionAccess = config.new_section_access || {};\n\n\t\tthis.sectionAccessTasks = config.sectionAccessTasks;\n\t\tthis.showTasks = config.showTasks;\n\t\tthis.customizationData = config.sectionCustomization || {};\n\t}\n\n\taddTaskSection()\n\t{\n\t\tif (this.showTasks)\n\t\t{\n\t\t\tconst taskSection = new CalendarTaskSection(\n\t\t\t\tthis.customizationData['tasks' + this.ownerId],\n\t\t\t\t{\n\t\t\t\t\ttype: this.calendarType,\n\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\townerId: this.ownerId\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis.sections.push(taskSection);\n\t\t\tthis.sectionIndex[taskSection.id] = this.sections.length - 1;\n\t\t}\n\t}\n\n\tgetCalendarType()\n\t{\n\t\treturn this.calendarType;\n\t}\n\n\thandlePullChanges(params)\n\t{\n\t\tif (params.command === 'delete_section')\n\t\t{\n\t\t\tconst sectionId = parseInt(params.fields.ID, 10);\n\t\t\tif (this.sectionIndex[sectionId])\n\t\t\t{\n\t\t\t\tthis.deleteSectionHandler(sectionId);\n\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t'BX.Calendar.Section:pull-delete',\n\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: { sectionId: sectionId }\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.reloadDataDebounce();\n\t\t\t}\n\t\t}\n\t\telse if (params.command === 'edit_section')\n\t\t{\n\t\t\tthis.reloadData().then(() => {\n\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t'BX.Calendar.Section:pull-edit'\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar:doRefresh');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.reloadDataDebounce();\n\t\t}\n\t}\n\n\treloadData()\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.getSectionList', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t'type': this.calendarType,\n\t\t\t\t\t\t'ownerId': this.ownerId\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.setSections(response.data.sections || []);\n\t\t\t\t\t\tif (response.data.config)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setConfig(config);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.addTaskSection();\n\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t// Failure\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\t//this.calendar.displayError(response.errors);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t}\n\n\tgetSections()\n\t{\n\t\treturn this.sections;\n\t}\n\n\tgetSuperposedSectionList()\n\t{\n\t\tvar i, result = [];\n\t\tfor (i = 0; i < this.sections.length; i++)\n\t\t{\n\t\t\tif (this.sections[i].isSuperposed()\n\t\t\t\t&& this.sections[i].isActive())\n\t\t\t{\n\t\t\t\tresult.push(this.sections[i]);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetSectionListForEdit()\n\t{\n\t\tconst result = [];\n\t\tfor (let i = 0; i < this.sections.length; i++)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.sections[i].canDo('add')\n\t\t\t\t&& !this.sections[i].isPseudo()\n\t\t\t\t&& this.sections[i].isActive()\n\t\t\t\t&& !this.sections[i].isLocationRoom()\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.push(this.sections[i]);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetSection(id)\n\t{\n\t\treturn this.sections[this.sectionIndex[id]] || {};\n\t}\n\n\tgetDefaultSectionName()\n\t{\n\t\treturn Loc.getMessage('EC_DEFAULT_SECTION_NAME');\n\t}\n\n\tgetDefaultSectionAccess()\n\t{\n\t\treturn this.defaultSectionAccess;\n\t\t// return this.calendar.util.config.new_section_access || {};\n\t}\n\n\tsaveSection(name, color, access, params)\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tname = (Type.isString(name) && name.trim())\n\t\t\t\t? name.trim()\n\t\t\t\t: Loc.getMessage('EC_SEC_SLIDER_NEW_SECTION');\n\n\t\t\tif (params.section.id)\n\t\t\t{\n\t\t\t\t// BX.onCustomEvent(this.calendar, 'BXCalendar:onSectionChange', [\n\t\t\t\t// \tparams.section.id,\n\t\t\t\t// \t{\n\t\t\t\t// \t\tname: name,\n\t\t\t\t// \t\tcolor: color\n\t\t\t\t// \t}]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// BX.onCustomEvent(this.calendar, 'BXCalendar:onSectionAddBefore', [{\n\t\t\t\t// \tname: name,\n\t\t\t\t// \tcolor: color\n\t\t\t\t// }]);\n\t\t\t}\n\n\t\t\tconst isCustomization = params.section.id && params.section.isPseudo();\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.editCalendarSection', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\t\taction: params.section.id ? 'editSection' : 'newSection',\n\t\t\t\t\t\t\ttype: params.section.type || this.calendarType\n\t\t\t\t\t\t},\n\t\t\t\t\t\tid: params.section.id || 0,\n\t\t\t\t\t\tname: name,\n\t\t\t\t\t\ttype: params.section.type || this.calendarType,\n\t\t\t\t\t\townerId: params.section.ownerId || this.ownerId,\n\t\t\t\t\t\tcolor: color,\n\t\t\t\t\t\taccess: access || null,\n\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\tcustomization: isCustomization ? 'Y' : 'N'\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tif (isCustomization)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.reload();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst sectionList = response.data.sectionList || [];\n\t\t\t\t\t\tthis.setSections(sectionList);\n\t\t\t\t\t\tthis.sortSections();\n\n\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t'BX.Calendar.Section:edit',\n\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: { sectionList: sectionList }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tBX.Calendar.Util.displayError(response.errors);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t});\n\t}\n\n\tsectionIsShown(id)\n\t{\n\t\treturn !BX.util.in_array(id, this.hiddenSections);\n\t}\n\n\tgetHiddenSections()\n\t{\n\t\treturn this.hiddenSections;\n\t}\n\n\tsetHiddenSections(hiddenSections)\n\t{\n\t\tthis.hiddenSections = [];\n\t\tif (Type.isArray(hiddenSections))\n\t\t{\n\t\t\thiddenSections.forEach((id) => {\n\t\t\t\tthis.hiddenSections.push(id === 'tasks' ? id : parseInt(id));\n\t\t\t});\n\t\t}\n\t}\n\n\tsaveHiddenSections()\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tconst optionName = calendarContext.util.userIsOwner()\n\t\t\t? 'hidden_sections'\n\t\t\t: 'hidden_sections_' + calendarContext.util.type;\n\n\t\tBX.userOptions.save('calendar', optionName, optionName, this.hiddenSections);\n\t}\n\n\tgetSectionsInfo()\n\t{\n\t\tconst allActive = [];\n\t\tconst superposed = [];\n\t\tconst active = [];\n\t\tconst hidden = [];\n\n\t\tthis.sections.forEach((section) => {\n\t\t\tif(section.isShown() && this.calendarType === 'location' && section.type === 'location')\n\t\t\t{\n\t\t\t\tif (section.isSuperposed())\n\t\t\t\t{\n\t\t\t\t\tsuperposed.push(section.id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tactive.push(section.id);\n\t\t\t\t}\n\t\t\t\tallActive.push(section.id);\n\t\t\t}\n\t\t\telse if (section.isShown() && this.calendarType !== 'location')\n\t\t\t{\n\t\t\t\tif (section.isSuperposed())\n\t\t\t\t{\n\t\t\t\t\tsuperposed.push(section.id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tactive.push(section.id);\n\t\t\t\t}\n\t\t\t\tallActive.push(section.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thidden.push(section.id);\n\t\t\t}\n\t\t});\n\n\t\treturn { superposed, active, hidden, allActive };\n\t}\n\n\tdeleteSectionHandler(sectionId)\n\t{\n\t\tif (this.sectionIndex[sectionId] !== undefined)\n\t\t{\n\t\t\tthis.sections = BX.util.deleteFromArray(this.sections, this.sectionIndex[sectionId]);\n\t\t\tfor (var i = 0; i < this.sections.length; i++)\n\t\t\t{\n\t\t\t\tthis.sectionIndex[this.sections[i].id] = i;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getNewEntrySectionId(calendarType = null, ownerId = null)\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext && !calendarContext.isExternalMode())\n\t\t{\n\t\t\tcalendarType = calendarType || calendarContext.util.type;\n\t\t\tif (calendarType === 'location')\n\t\t\t{\n\t\t\t\tconst section = calendarContext.sectionManager.getDefaultSection(\n\t\t\t\t\t'user',\n\t\t\t\t\tcalendarContext.util.userId\n\t\t\t\t);\n\t\t\t\treturn parseInt(section.id, 10);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst section = calendarContext.sectionManager.getDefaultSection(calendarType, ownerId);\n\t\t\t\treturn parseInt(section.id, 10);\n\t\t\t}\n\n\t\t}\n\t\treturn SectionManager.newEntrySectionId;\n\t}\n\n\tstatic setNewEntrySectionId(sectionId)\n\t{\n\t\tSectionManager.newEntrySectionId = parseInt(sectionId);\n\t}\n\n\tstatic getSectionGroupList(options = {})\n\t{\n\t\tlet\n\t\t\ttype = options.type,\n\t\t\townerId = options.ownerId,\n\t\t\tuserId = options.userId,\n\t\t\tfollowedUserList = options.trackingUsersList || Util.getFollowedUserList(userId),\n\t\t\tsectionGroups = [],\n\t\t\ttitle;\n\n\t\t// 1. Main group - depends from current view\n\t\tif (type === 'user')\n\t\t{\n\t\t\tif (userId === ownerId)\n\t\t\t{\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_USER_CALENDARS_LIST');\n\t\t\t}\n\t\t}\n\t\telse if (type === 'group')\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_GROUP_CALENDARS_LIST');\n\t\t}\n\t\telse if (type === 'location')\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_LOCATION_LIST');\n\t\t}\n\t\telse if (type === 'resource')\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_RESOURCE_LIST');\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TITLE_COMP_CAL');\n\t\t}\n\n\t\tsectionGroups.push({\n\t\t\ttitle: title,\n\t\t\ttype: type,\n\t\t\tbelongsToView: true\n\t\t});\n\n\t\tif (type !== 'user' || userId !== ownerId)\n\t\t{\n\t\t\tsectionGroups.push({\n\t\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST'),\n\t\t\t\ttype: 'user',\n\t\t\t\townerId: userId\n\t\t\t});\n\t\t}\n\n\t\t// 2. Company calendar\n\t\tif (type !== 'company' && type !== 'company_calendar' && type !== 'calendar_company')\n\t\t{\n\t\t\tsectionGroups.push({\n\t\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_TITLE_COMP_CAL'),\n\t\t\t\ttype: 'company'\n\t\t\t});\n\t\t}\n\n\t\t// 3. Users calendars\n\t\tif (Type.isArray(followedUserList))\n\t\t{\n\t\t\tfollowedUserList.forEach((user) => {\n\t\t\t\tif (parseInt(user.ID) !== ownerId || type !== 'user')\n\t\t\t\t{\n\t\t\t\t\tsectionGroups.push({\n\t\t\t\t\t\ttitle: BX.util.htmlspecialchars(user.FORMATTED_NAME),\n\t\t\t\t\t\ttype: 'user',\n\t\t\t\t\t\townerId: parseInt(user.ID)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// 4. Groups calendars\n\t\tsectionGroups.push({\n\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP'),\n\t\t\ttype: 'group'\n\t\t});\n\n\t\t// 5. Resources calendars\n\t\tsectionGroups.push({\n\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_TITLE_RESOURCE_CAL'),\n\t\t\ttype: 'resource'\n\t\t});\n\n\t\t// 6. Location calendars\n\t\tsectionGroups.push({\n\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_TITLE_LOCATION_CAL'),\n\t\t\ttype: 'location'\n\t\t});\n\n\t\treturn sectionGroups;\n\t}\n\n\tgetSectionAccessTasks()\n\t{\n\t\treturn this.sectionAccessTasks;\n\t}\n\n\tgetDefaultSection(calendarType = null, ownerId = null)\n\t{\n\t\tcalendarType = Type.isString(calendarType) ? calendarType : this.calendarType;\n\t\townerId = Type.isNumber(ownerId) ? ownerId : this.ownerId;\n\n\t\tconst userSettings = Util.getUserSettings();\n\t\tconst key = calendarType + ownerId;\n\t\tconst defaultSectionId = userSettings.defaultSections[key] || userSettings.lastUsedSection;\n\t\tconst sections = this.getSectionListForEdit();\n\n\t\tlet section = sections.find((item) => {\n\t\t\treturn item.type === calendarType\n\t\t\t\t&& item.ownerId === ownerId\n\t\t\t\t&& item.id === defaultSectionId;\n\t\t});\n\n\t\tif (!section)\n\t\t{\n\t\t\tsection = sections.find((item) => {\n\t\t\t\treturn item.type === calendarType\n\t\t\t\t\t&& item.ownerId === ownerId\n\t\t\t});\n\t\t}\n\n\t\treturn section;\n\t}\n\n\tsetDefaultSection(sectionId)\n\t{\n\t\tconst section = this.getSection(parseInt(sectionId, 10));\n\n\t\tif (section\n\t\t\t&& section.type === this.calendarType\n\t\t\t&& section.ownerId === this.ownerId)\n\t\t{\n\t\t\tconst userSettings = Util.getUserSettings();\n\t\t\tconst key = this.calendarType + this.ownerId;\n\t\t\tif (userSettings.defaultSections[key] !== section.id)\n\t\t\t{\n\t\t\t\tuserSettings.defaultSections[key] = section.id;\n\t\t\t\tUtil.setUserSettings(userSettings);\n\n\t\t\t\tBX.ajax.runAction('calendar.api.calendarajax.updateDefaultSectionId', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t'key': key,\n\t\t\t\t\t\t'sectionId': sectionId\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic saveDefaultSectionId(sectionId, options = {})\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tcalendarContext.sectionManager.setDefaultSection(sectionId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (Type.isArray(options.sections) && options.calendarType && options.ownerId)\n\t\t\t{\n\t\t\t\tconst section = options.sections.find((item) => {\n\t\t\t\t\tconst id = parseInt(item.ID || item.id, 10);\n\t\t\t\t\tconst ownerId = parseInt(item.OWNER_ID || item.ownerId, 10);\n\t\t\t\t\tconst type = item.CAL_TYPE || item.type;\n\n\t\t\t\t\treturn id === parseInt(sectionId,10)\n\t\t\t\t\t\t&& ownerId === parseInt(options.ownerId, 10)\n\t\t\t\t\t\t&& type === options.calendarType;\n\t\t\t\t});\n\n\t\t\t\tif (section)\n\t\t\t\t{\n\t\t\t\t\tconst userSettings = Util.getUserSettings();\n\t\t\t\t\tconst key = options.calendarType + options.ownerId;\n\t\t\t\t\tif (userSettings && userSettings.defaultSections[key] !== sectionId)\n\t\t\t\t\t{\n\t\t\t\t\t\tuserSettings.defaultSections[key] = sectionId;\n\t\t\t\t\t\tUtil.setUserSettings(userSettings);\n\t\t\t\t\t\tSectionManager.newEntrySectionId = sectionId;\n\n\t\t\t\t\t\tBX.ajax.runAction('calendar.api.calendarajax.updateDefaultSectionId', {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t'key': key,\n\t\t\t\t\t\t\t\t'sectionId': sectionId\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}"],"names":["CalendarSection","data","updateData","calendarContext","Util","getCalendarContext","id","type","CAL_TYPE","ownerId","parseInt","OWNER_ID","ID","color","COLOR","name","NAME","sectionManager","sectionIsShown","isShown","hiddenSections","getHiddenSections","filter","sectionId","setHiddenSections","saveHiddenSections","push","confirm","BX","message","EventAlias","getBX","Event","EventEmitter","emit","BaseEvent","ajax","runAction","then","response","reload","section","i","sections","length","belongsToView","calendar","hide","onCustomEvent","LINK","isPseudo","OUTLOOK_JS","CAL_DAV_CAL","CAL_DAV_CON","browser","IsMac","window","jsOutlookUtils","loadScript","delegate","eval","e","action","isVirtual","includes","PERM","SUPERPOSED","indexOf","GAPI_CALENDAR_ID","EXTERNAL_TYPE","getCalendarType","getOwnerId","belongsToUser","getUserId","userId","ACTIVE","CalendarTaskSection","defaultColor","defaultName","Loc","getMessage","edit_section","view_full","view_time","view_title","SectionManager","config","setSections","setConfig","addTaskSection","sortSections","subscribeOnce","deleteSectionHandler","bind","reloadDataDebounce","Runtime","debounce","reloadData","RELOAD_DELAY","rawSections","sectionIndex","forEach","sectionData","canDo","getId","sort","a","b","Type","isFunction","localeCompare","index","calendarType","ownerName","defaultSectionAccess","new_section_access","sectionAccessTasks","showTasks","customizationData","sectionCustomization","taskSection","params","command","fields","Promise","resolve","result","isSuperposed","isActive","isLocationRoom","access","isString","trim","isCustomization","analyticsLabel","customization","sectionList","Calendar","displayError","errors","util","in_array","isArray","optionName","userIsOwner","userOptions","save","allActive","superposed","active","hidden","undefined","deleteFromArray","isNumber","userSettings","getUserSettings","key","defaultSectionId","defaultSections","lastUsedSection","getSectionListForEdit","find","item","getSection","setUserSettings","isExternalMode","getDefaultSection","newEntrySectionId","options","followedUserList","trackingUsersList","getFollowedUserList","sectionGroups","title","user","htmlspecialchars","FORMATTED_NAME","setDefaultSection"],"mappings":"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"}