{"version":3,"file":"sectionmanager.bundle.js","sources":["../src/calendarsection.js","../src/calendartasksection.js","../src/sectionmanager.js"],"sourcesContent":["import {Util} from 'calendar.util';\nimport { Event, Type } from 'main.core';\n\nexport class CalendarSection\n{\n\tconstructor(data)\n\t{\n\t\tthis.updateData(data);\n\t\tthis.calendarContext = Util.getCalendarContext();\n\t\tthis.sectionManager = this.calendarContext.sectionManager;\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tthis.data = data || {};\n\t\tthis.type = data.CAL_TYPE || '';\n\t\tthis.ownerId = parseInt(data.OWNER_ID) || 0;\n\t\tthis.id = parseInt(data.ID);\n\t\tthis.color = this.data.COLOR;\n\t\tthis.name = this.data.NAME;\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.calendarContext.sectionManager.sectionIsShown(this.id);\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.isShown())\n\t\t{\n\t\t\tlet hiddenSections = this.calendarContext.sectionManager.getHiddenSections();\n\t\t\thiddenSections = hiddenSections.filter((sectionId) => {return sectionId !== this.id;}, this);\n\t\t\tthis.calendarContext.sectionManager.setHiddenSections(hiddenSections);\n\t\t\tthis.calendarContext.sectionManager.saveHiddenSections();\n\t\t}\n\t}\n\n\thide(): void\n\t{\n\t\tif (this.isShown())\n\t\t{\n\t\t\tconst hiddenSections = this.calendarContext.sectionManager.getHiddenSections();\n\t\t\thiddenSections.push(this.id);\n\t\t\tthis.calendarContext.sectionManager.setHiddenSections(hiddenSections);\n\t\t\tthis.calendarContext.sectionManager.saveHiddenSections();\n\t\t}\n\t}\n\n\tremove()\n\t{\n\t\tif (confirm(BX.message('EC_SEC_DELETE_CONFIRM')))\n\t\t{\n\t\t\tconst EventAlias = Util.getBX().Event;\n\t\t\tEventAlias.EventEmitter.emit(\n\t\t\t\t'BX.Calendar.Section:delete',\n\t\t\t\tnew EventAlias.BaseEvent({data: {sectionId: this.id}})\n\t\t\t);\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.deleteCalendarSection', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: this.id\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst sectionManager = Util.getCalendarContext().sectionManager;\n\t\t\t\t\t\tlet reload = true;\n\t\t\t\t\t\tlet section;\n\n\t\t\t\t\t\tfor (let i = 0; i < sectionManager.sections.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsection = sectionManager.sections[i];\n\t\t\t\t\t\t\tif (section.id !== this.id && section.belongsToView())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treload = false;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst calendar = Util.getCalendarContext();\n\t\t\t\t\t\tif (!calendar || reload)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn Util.getBX().reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcalendar.reload();\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\t// this.calendar.displayError(response.errors);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t}\n\t}\n\n\thideGoogle()\n\t{\n\t\tif (confirm(BX.message('EC_CAL_GOOGLE_HIDE_CONFIRM')))\n\t\t{\n\t\t\tthis.hide();\n\t\t\tBX.onCustomEvent(this.calendar, 'BXCalendar:onSectionDelete', [this.id]);\n\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t'BX.Calendar.Section:delete',\n\t\t\t\tnew Event.BaseEvent({data: {sectionId: this.id}})\n\t\t\t);\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.hideExternalCalendarSection', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: this.id\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t// Success\n\t\t\t\t\tBX.delegate(function (response)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.calendar.reload();\n\t\t\t\t\t}, this),\n\t\t\t\t\t// Failure\n\t\t\t\t\tBX.delegate(function (response)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.calendar.displayError(response.errors);\n\t\t\t\t\t}, this)\n\t\t\t\t);\n\t\t}\n\t}\n\n\tgetLink()\n\t{\n\t\treturn this.data && this.data.LINK ? this.data.LINK : '';\n\t}\n\n\tcanBeConnectedToOutlook()\n\t{\n\t\treturn !this.isPseudo() && this.data.OUTLOOK_JS && !(this.data.CAL_DAV_CAL && this.data.CAL_DAV_CON) && !BX.browser.IsMac();\n\t}\n\n\tconnectToOutlook()\n\t{\n\t\tif (!window.jsOutlookUtils)\n\t\t{\n\t\t\tBX.loadScript('/bitrix/js/calendar/outlook.js', BX.delegate(function ()\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\teval(this.data.OUTLOOK_JS);\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t}, this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\teval(this.data.OUTLOOK_JS);\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t}\n\t\t}\n\t}\n\n\tcanDo(action)\n\t{\n\t\t//action: access|add|edit|edit_section|view_full|view_time|view_title\n\t\tif (this.isVirtual() && ['access','add','edit'].includes(action))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (action === 'view_event')\n\t\t{\n\t\t\taction = 'view_time';\n\t\t}\n\n\t\treturn this.data.PERM && this.data.PERM[action];\n\t}\n\n\tisSuperposed()\n\t{\n\t\treturn !this.isPseudo() && !!this.data.SUPERPOSED;\n\t}\n\n\tisPseudo()\n\t{\n\t\treturn false;\n\t}\n\n\tisVirtual()\n\t{\n\t\treturn (this.data.CAL_DAV_CAL && this.data.CAL_DAV_CAL.indexOf('@virtual/events/') !== -1)\n\t\t\t|| (this.data.GAPI_CALENDAR_ID && this.data.GAPI_CALENDAR_ID.indexOf('@group.v.calendar.google.com') !== -1)\n\t\t\t|| (this.data.EXTERNAL_TYPE === 'google_readonly')\n\t\t\t|| (this.data.EXTERNAL_TYPE === 'google_freebusy')\n\t}\n\n\tisGoogle()\n\t{\n\t\treturn this.data.GAPI_CALENDAR_ID;\n\t}\n\n\tisCalDav()\n\t{\n\t\treturn !this.isPseudo() && this.data.CAL_DAV_CAL && this.data.CAL_DAV_CON;\n\t}\n\n\tisCompanyCalendar()\n\t{\n\t\treturn !this.isPseudo() && this.type !== 'user' && this.type !== 'group' && !this.ownerId;\n\t}\n\n\tbelongsToView()\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\treturn this.type === calendarContext.getCalendarType()\n\t\t\t&& this.ownerId === calendarContext.getOwnerId();\n\t}\n\n\tbelongsToOwner()\n\t{\n\t\treturn this.belongsToUser(Util.getCalendarContext().getUserId());\n\t}\n\n\tbelongsToUser(userId)\n\t{\n\t\treturn this.type === 'user'\n\t\t\t&& this.ownerId === parseInt(userId)\n\t\t\t&& this.data.ACTIVE !== 'N';\n\t}\n\n\tisActive()\n\t{\n\t\treturn this.data.ACTIVE !== 'N';\n\t}\n\n\tgetType()\n\t{\n\t\treturn this.type;\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn this.ownerId;\n\t}\n}","import {Util} from 'calendar.util';\nimport { Event, Type, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { CalendarSection } from './calendarsection';\n\nexport class CalendarTaskSection extends CalendarSection\n{\n\tconstructor(data = {}, {type, userId, ownerId})\n\t{\n\t\tconst defaultColor = '#ff5b55';\n\t\tlet defaultName = Loc.getMessage('EC_SEC_MY_TASK_DEFAULT');\n\n\t\tif(type === 'user' && userId !== ownerId)\n\t\t{\n\t\t\tdefaultName = Loc.getMessage('EC_SEC_USER_TASK_DEFAULT');\n\t\t}\n\t\telse if(type === 'group')\n\t\t{\n\t\t\tdefaultName = Loc.getMessage('EC_SEC_GROUP_TASK_DEFAULT');\n\t\t}\n\n\t\tsuper({\n\t\t\tID: 'tasks',\n\t\t\tNAME: data.name || defaultName,\n\t\t\tCOLOR: data.color || defaultColor,\n\t\t\tPERM: {\n\t\t\t\tedit_section:true,\n\t\t\t\tview_full:true,\n\t\t\t\tview_time:true,\n\t\t\t\tview_title:true\n\t\t\t}\n\t\t});\n\t}\n\n\tisPseudo(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tsuper.updateData(data);\n\t\tthis.id = data.ID;\n\t}\n}","import {Entry} from \"calendar.entry\";\nimport {Util} from 'calendar.util';\nimport { Event, Loc, Type } from 'main.core';\nimport {CalendarSection} from './calendarsection';\nimport {CalendarTaskSection} from './calendartasksection';\nimport {EventEmitter} from 'main.core.events';\nexport {CalendarSection};\n\nexport class SectionManager\n{\n\tstatic newEntrySectionId = null;\n\n\tconstructor(data, config)\n\t{\n\t\tthis.setSectons(data.sections);\n\t\tthis.setConfig(config);\n\t\tthis.addTaskSection();\n\n\t\tEventEmitter.subscribeOnce('BX.Calendar.Section:delete', this.deleteSectionHandler.bind(this));\n\t\t//BX.addCustomEvent(\"BXCalendar:onSectionDelete\", BX.proxy(this.unsetSectionHandler, this));\n\t}\n\n\tsetSectons(rawSections = [])\n\t{\n\t\tthis.sections = [];\n\t\tthis.sectionIndex = {};\n\n\t\trawSections.forEach((sectionData) => {\n\t\t\tconst section = new CalendarSection(sectionData);\n\t\t\tif (section.canDo('view_time'))\n\t\t\t{\n\t\t\t\tthis.sections.push(section);\n\t\t\t\tthis.sectionIndex[section.getId()] = this.sections.length - 1;\n\t\t\t}\n\t\t});\n\t}\n\n\tsortSections()\n\t{\n\t\tthis.sectionIndex = {};\n\t\tthis.sections = this.sections.sort((a, b) => {\n\t\t\tif (Type.isFunction(a.isPseudo) && a.isPseudo())\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse if (Type.isFunction(b.isPseudo) && b.isPseudo())\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn a.name.localeCompare(b.name);\n\t\t});\n\n\t\tthis.sections.forEach((section, index) => {\n\t\t\tthis.sectionIndex[section.getId()] = index;\n\t\t});\n\t}\n\n\tsetConfig(config)\n\t{\n\t\tthis.setHiddenSections(config.hiddenSections);\n\t\tthis.calendarType = config.type;\n\t\tthis.ownerId = config.ownerId;\n\t\tthis.userId = config.userId;\n\t\tthis.defaultSectionAccess = config.new_section_access || {};\n\n\t\tthis.sectionAccessTasks = config.sectionAccessTasks;\n\t\tthis.showTasks = config.showTasks;\n\t\tthis.customizationData = config.sectionCustomization || {};\n\t}\n\n\taddTaskSection()\n\t{\n\t\tif (this.showTasks)\n\t\t{\n\t\t\tconst taskSection = new CalendarTaskSection(\n\t\t\t\tthis.customizationData['tasks' + this.ownerId],\n\t\t\t\t{\n\t\t\t\t\ttype: this.calendarType,\n\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\townerId: this.ownerId\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis.sections.push(taskSection);\n\t\t\tthis.sectionIndex[taskSection.id] = this.sections.length - 1;\n\t\t}\n\t}\n\n\tgetCalendarType()\n\t{\n\t\treturn this.calendarType;\n\t}\n\n\thandlePullChanges(params)\n\t{\n\t\tif (params?.fields?.CAL_TYPE === 'location')\n\t\t{\n\t\t\tthis.handleLocationPullChanges(params);\n\t\t}\n\t\telse if (params.command === 'delete_section')\n\t\t{\n\t\t\tconst sectionId = parseInt(params.fields.ID, 10);\n\t\t\tif (this.sectionIndex[sectionId])\n\t\t\t{\n\t\t\t\tthis.deleteSectionHandler(sectionId);\n\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t'BX.Calendar.Section:pull-delete',\n\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: { sectionId: sectionId }\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.reloadData();\n\t\t\t}\n\t\t}\n\t\telse if (params.command === 'edit_section')\n\t\t{\n\t\t\tthis.reloadData().then(() => {\n\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t'BX.Calendar.Section:pull-edit'\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar:doRefresh');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.reloadData();\n\t\t}\n\t}\n\n\thandleLocationPullChanges(params)\n\t{\n\n\t}\n\n\treloadData()\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.getSectionList', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t'type': this.calendarType,\n\t\t\t\t\t\t'ownerId': this.ownerId\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.setSectons(response.data.sections || []);\n\t\t\t\t\t\tif (response.data.config)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setConfig(config);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.addTaskSection();\n\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t// Failure\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\t//this.calendar.displayError(response.errors);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t}\n\n\tgetSections()\n\t{\n\t\treturn this.sections;\n\t}\n\n\tgetSuperposedSectionList()\n\t{\n\t\tvar i, result = [];\n\t\tfor (i = 0; i < this.sections.length; i++)\n\t\t{\n\t\t\tif (this.sections[i].isSuperposed()\n\t\t\t\t&& this.sections[i].isActive())\n\t\t\t{\n\t\t\t\tresult.push(this.sections[i]);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetSectionListForEdit()\n\t{\n\t\tvar i, result = [];\n\t\tfor (i = 0; i < this.sections.length; i++)\n\t\t{\n\t\t\tif (this.sections[i].canDo('add')\n\t\t\t\t&& !this.sections[i].isPseudo()\n\t\t\t\t&& this.sections[i].isActive())\n\t\t\t{\n\t\t\t\tresult.push(this.sections[i]);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetSection(id)\n\t{\n\t\treturn this.sections[this.sectionIndex[id]] || {};\n\t}\n\n\tgetDefaultSectionName()\n\t{\n\t\treturn Loc.getMessage('EC_DEFAULT_SECTION_NAME');\n\t}\n\n\tgetDefaultSectionAccess()\n\t{\n\t\treturn this.defaultSectionAccess;\n\t\t// return this.calendar.util.config.new_section_access || {};\n\t}\n\n\tsaveSection(name, color, access, params)\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tname = (Type.isString(name) && name.trim())\n\t\t\t\t? name.trim()\n\t\t\t\t: Loc.getMessage('EC_SEC_SLIDER_NEW_SECTION');\n\n\t\t\tif (params.section.id)\n\t\t\t{\n\t\t\t\t// BX.onCustomEvent(this.calendar, 'BXCalendar:onSectionChange', [\n\t\t\t\t// \tparams.section.id,\n\t\t\t\t// \t{\n\t\t\t\t// \t\tname: name,\n\t\t\t\t// \t\tcolor: color\n\t\t\t\t// \t}]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// BX.onCustomEvent(this.calendar, 'BXCalendar:onSectionAddBefore', [{\n\t\t\t\t// \tname: name,\n\t\t\t\t// \tcolor: color\n\t\t\t\t// }]);\n\t\t\t}\n\n\t\t\tconst isCustomization = params.section.id && params.section.isPseudo();\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.editCalendarSection', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\t\taction: params.section.id ? 'editSection' : 'newSection',\n\t\t\t\t\t\t\ttype: params.section.type || this.calendarType\n\t\t\t\t\t\t},\n\t\t\t\t\t\tid: params.section.id || 0,\n\t\t\t\t\t\tname: name,\n\t\t\t\t\t\ttype: params.section.type || this.calendarType,\n\t\t\t\t\t\townerId: params.section.ownerId || this.ownerId,\n\t\t\t\t\t\tcolor: color,\n\t\t\t\t\t\taccess: access || null,\n\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\tcustomization: isCustomization ? 'Y' : 'N'\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tif (isCustomization)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.reload();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst sectionList = response.data.sectionList || [];\n\t\t\t\t\t\tthis.setSectons(sectionList);\n\t\t\t\t\t\tthis.sortSections();\n\n\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t'BX.Calendar.Section:edit',\n\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: { sectionList: sectionList }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t});\n\t}\n\n\tsectionIsShown(id)\n\t{\n\t\treturn !BX.util.in_array(id, this.hiddenSections);\n\t}\n\n\tgetHiddenSections()\n\t{\n\t\treturn this.hiddenSections;\n\t}\n\n\tsetHiddenSections(hiddenSections): void\n\t{\n\t\tthis.hiddenSections = [];\n\t\tif (Type.isArray(hiddenSections))\n\t\t{\n\t\t\thiddenSections.forEach((id) => {\n\t\t\t\tthis.hiddenSections.push(id === 'tasks' ? id : parseInt(id));\n\t\t\t});\n\t\t}\n\t}\n\n\tsaveHiddenSections()\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tconst optionName = calendarContext.util.userIsOwner()\n\t\t\t? 'hidden_sections'\n\t\t\t: 'hidden_sections_' + calendarContext.util.type;\n\n\t\tBX.userOptions.save('calendar', optionName, optionName, this.hiddenSections);\n\t}\n\n\tgetSectionsInfo()\n\t{\n\t\tconst allActive = [];\n\t\tconst superposed = [];\n\t\tconst active = [];\n\t\tconst hidden = [];\n\n\t\tthis.sections.forEach((section) => {\n\t\t\tif (section.isShown())\n\t\t\t{\n\t\t\t\tif (section.isSuperposed())\n\t\t\t\t{\n\t\t\t\t\tsuperposed.push(section.id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tactive.push(section.id);\n\t\t\t\t}\n\t\t\t\tallActive.push(section.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thidden.push(section.id);\n\t\t\t}\n\t\t});\n\n\t\treturn { superposed, active, hidden, allActive };\n\t}\n\n\tdeleteSectionHandler(sectionId)\n\t{\n\t\tif (this.sectionIndex[sectionId] !== undefined)\n\t\t{\n\t\t\tthis.sections = BX.util.deleteFromArray(this.sections, this.sectionIndex[sectionId]);\n\t\t\tfor (var i = 0; i < this.sections.length; i++)\n\t\t\t{\n\t\t\t\tthis.sectionIndex[this.sections[i].id] = i;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getNewEntrySectionId(calendarType = null, ownerId = null)\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext && !calendarContext.isExternalMode())\n\t\t{\n\t\t\tconst section = calendarContext.sectionManager.getDefaultSection(calendarType, ownerId);\n\t\t\treturn parseInt(section.id, 10);\n\t\t}\n\t\treturn SectionManager.newEntrySectionId;\n\t}\n\n\tstatic setNewEntrySectionId(sectionId)\n\t{\n\t\tSectionManager.newEntrySectionId = parseInt(sectionId);\n\t}\n\n\tstatic getSectionGroupList(options = {})\n\t{\n\t\tlet\n\t\t\ttype = options.type,\n\t\t\townerId = options.ownerId,\n\t\t\tuserId = options.userId,\n\t\t\tfollowedUserList = options.trackingUsersList || Util.getFollowedUserList(userId),\n\t\t\tsectionGroups = [],\n\t\t\ttitle;\n\n\t\t// 1. Main group - depends from current view\n\t\tif (type === 'user')\n\t\t{\n\t\t\tif (userId === ownerId)\n\t\t\t{\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_USER_CALENDARS_LIST');\n\t\t\t}\n\t\t}\n\t\telse if (type === 'group')\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_GROUP_CALENDARS_LIST');\n\t\t}\n\t\telse if (type === 'location')\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_LOCATION_LIST');\n\t\t}\n\t\telse if (type === 'resource')\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_RESOURCE_LIST');\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TITLE_COMP_CAL');\n\t\t}\n\n\t\tsectionGroups.push({\n\t\t\ttitle: title,\n\t\t\ttype: type,\n\t\t\tbelongsToView: true\n\t\t});\n\n\t\tif (type !== 'user' || userId !== ownerId)\n\t\t{\n\t\t\tsectionGroups.push({\n\t\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST'),\n\t\t\t\ttype: 'user',\n\t\t\t\townerId: userId\n\t\t\t});\n\t\t}\n\n\t\t// 2. Company calendar\n\t\tif (type !== 'company' && type !== 'company_calendar')\n\t\t{\n\t\t\tsectionGroups.push({\n\t\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_TITLE_COMP_CAL'),\n\t\t\t\ttype: 'company'\n\t\t\t});\n\t\t}\n\n\t\t// 3. Users calendars\n\t\tif (Type.isArray(followedUserList))\n\t\t{\n\t\t\tfollowedUserList.forEach((user) => {\n\t\t\t\tif (parseInt(user.ID) !== ownerId || type !== 'user')\n\t\t\t\t{\n\t\t\t\t\tsectionGroups.push({\n\t\t\t\t\t\ttitle: BX.util.htmlspecialchars(user.FORMATTED_NAME),\n\t\t\t\t\t\ttype: 'user',\n\t\t\t\t\t\townerId: parseInt(user.ID)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// 4. Groups calendars\n\t\tsectionGroups.push({\n\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP'),\n\t\t\ttype: 'group'\n\t\t});\n\n\t\t// 5. Resources calendars\n\t\tsectionGroups.push({\n\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_TITLE_RESOURCE_CAL'),\n\t\t\ttype: 'resource'\n\t\t});\n\n\t\t// 6. Location calendars\n\t\tsectionGroups.push({\n\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_TITLE_LOCATION_CAL'),\n\t\t\ttype: 'location'\n\t\t});\n\n\t\treturn sectionGroups;\n\t}\n\n\tgetSectionAccessTasks()\n\t{\n\t\treturn this.sectionAccessTasks;\n\t}\n\n\tgetDefaultSection(calendarType = null, ownerId = null)\n\t{\n\t\tcalendarType = Type.isString(calendarType) ? calendarType : this.calendarType;\n\t\townerId = Type.isNumber(ownerId) ? ownerId : this.ownerId;\n\n\t\tconst userSettings = Util.getUserSettings();\n\t\tconst key = calendarType + ownerId;\n\t\tconst defaultSectionId = userSettings.defaultSections[key] || userSettings.lastUsedSection;\n\t\tconst sections = this.getSectionListForEdit();\n\n\t\tlet section = sections.find((item) => {\n\t\t\treturn item.type === calendarType\n\t\t\t\t&& item.ownerId === ownerId\n\t\t\t\t&& item.id === defaultSectionId;\n\t\t});\n\n\t\tif (!section)\n\t\t{\n\t\t\tsection = sections.find((item) => {\n\t\t\t\treturn item.type === calendarType\n\t\t\t\t\t&& item.ownerId === ownerId\n\t\t\t});\n\t\t}\n\n\t\treturn section;\n\t}\n\n\tsetDefaultSection(sectionId)\n\t{\n\t\tconst section = this.getSection(parseInt(sectionId, 10));\n\n\t\tif (section\n\t\t\t&& section.type === this.calendarType\n\t\t\t&& section.ownerId === this.ownerId)\n\t\t{\n\t\t\tconst userSettings = Util.getUserSettings();\n\t\t\tconst key = this.calendarType + this.ownerId;\n\t\t\tif (userSettings.defaultSections[key] !== section.id)\n\t\t\t{\n\t\t\t\tuserSettings.defaultSections[key] = section.id;\n\t\t\t\tUtil.setUserSettings(userSettings);\n\n\t\t\t\tBX.ajax.runAction('calendar.api.calendarajax.updateDefaultSectionId', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t'key': key,\n\t\t\t\t\t\t'sectionId': sectionId\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic saveDefaultSectionId(sectionId, options = {})\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tcalendarContext.sectionManager.setDefaultSection(sectionId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (Type.isArray(options.sections) && options.calendarType && options.ownerId)\n\t\t\t{\n\t\t\t\tconst section = options.sections.find((item) => {\n\t\t\t\t\tconst id = parseInt(item.ID || item.id, 10);\n\t\t\t\t\tconst ownerId = parseInt(item.OWNER_ID || item.ownerId, 10);\n\t\t\t\t\tconst type = item.CAL_TYPE || item.type;\n\n\t\t\t\t\treturn id === parseInt(sectionId,10)\n\t\t\t\t\t\t&& ownerId === parseInt(options.ownerId, 10)\n\t\t\t\t\t\t&& type === options.calendarType;\n\t\t\t\t});\n\n\t\t\t\tif (section)\n\t\t\t\t{\n\t\t\t\t\tconst userSettings = Util.getUserSettings();\n\t\t\t\t\tconst key = options.calendarType + options.ownerId;\n\t\t\t\t\tif (userSettings && userSettings.defaultSections[key] !== sectionId)\n\t\t\t\t\t{\n\t\t\t\t\t\tuserSettings.defaultSections[key] = sectionId;\n\t\t\t\t\t\tUtil.setUserSettings(userSettings);\n\t\t\t\t\t\tSectionManager.newEntrySectionId = sectionId;\n\n\t\t\t\t\t\tBX.ajax.runAction('calendar.api.calendarajax.updateDefaultSectionId', {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t'key': key,\n\t\t\t\t\t\t\t\t'sectionId': sectionId\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}"],"names":["CalendarSection","data","updateData","calendarContext","Util","getCalendarContext","sectionManager","id","type","CAL_TYPE","ownerId","parseInt","OWNER_ID","ID","color","COLOR","name","NAME","sectionIsShown","isShown","hiddenSections","getHiddenSections","filter","sectionId","setHiddenSections","saveHiddenSections","push","confirm","BX","message","EventAlias","getBX","Event","EventEmitter","emit","BaseEvent","ajax","runAction","then","response","reload","section","i","sections","length","belongsToView","calendar","hide","onCustomEvent","delegate","displayError","errors","LINK","isPseudo","OUTLOOK_JS","CAL_DAV_CAL","CAL_DAV_CON","browser","IsMac","window","jsOutlookUtils","loadScript","eval","e","action","isVirtual","includes","PERM","SUPERPOSED","indexOf","GAPI_CALENDAR_ID","EXTERNAL_TYPE","getCalendarType","getOwnerId","belongsToUser","getUserId","userId","ACTIVE","CalendarTaskSection","defaultColor","defaultName","Loc","getMessage","edit_section","view_full","view_time","view_title","SectionManager","config","setSectons","setConfig","addTaskSection","subscribeOnce","deleteSectionHandler","bind","rawSections","sectionIndex","forEach","sectionData","canDo","getId","sort","a","b","Type","isFunction","localeCompare","index","calendarType","defaultSectionAccess","new_section_access","sectionAccessTasks","showTasks","customizationData","sectionCustomization","taskSection","params","fields","handleLocationPullChanges","command","reloadData","Promise","resolve","result","isSuperposed","isActive","access","isString","trim","isCustomization","analyticsLabel","customization","sectionList","sortSections","util","in_array","isArray","optionName","userIsOwner","userOptions","save","allActive","superposed","active","hidden","undefined","deleteFromArray","isNumber","userSettings","getUserSettings","key","defaultSectionId","defaultSections","lastUsedSection","getSectionListForEdit","find","item","getSection","setUserSettings","isExternalMode","getDefaultSection","newEntrySectionId","options","followedUserList","trackingUsersList","getFollowedUserList","sectionGroups","title","user","htmlspecialchars","FORMATTED_NAME","setDefaultSection"],"mappings":"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"}