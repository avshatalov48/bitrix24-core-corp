{"version":3,"file":"sectionmanager.bundle.js","sources":["../src/calendarsection.js","../src/calendartasksection.js","../src/sectionmanager.js"],"sourcesContent":["import {Util} from 'calendar.util';\nimport { Event, Type } from 'main.core';\n\nexport class CalendarSection\n{\n\tconstructor(data)\n\t{\n\t\tthis.updateData(data);\n\t\tthis.calendarContext = Util.getCalendarContext();\n\t\tthis.sectionManager = this.calendarContext.sectionManager;\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tthis.data = data || {};\n\t\tthis.type = data.CAL_TYPE || '';\n\t\tthis.ownerId = parseInt(data.OWNER_ID) || 0;\n\t\tthis.id = parseInt(data.ID);\n\t\tthis.color = this.data.COLOR;\n\t\tthis.name = this.data.NAME;\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.calendarContext.sectionManager.sectionIsShown(this.id);\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.isShown())\n\t\t{\n\t\t\tlet hiddenSections = this.calendarContext.sectionManager.getHiddenSections();\n\t\t\thiddenSections = BX.util.deleteFromArray(hiddenSections, BX.util.array_search(this.id, hiddenSections));\n\t\t\tthis.calendarContext.sectionManager.setHiddenSections(hiddenSections);\n\n\t\t\tBX.userOptions.save('calendar', 'hidden_sections', 'hidden_sections', hiddenSections);\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tif (this.isShown())\n\t\t{\n\t\t\tvar hiddenSections = this.calendarContext.sectionManager.getHiddenSections();\n\t\t\thiddenSections.push(this.id);\n\t\t\tthis.calendarContext.sectionManager.setHiddenSections(hiddenSections);\n\t\t\tBX.userOptions.save('calendar', 'hidden_sections', 'hidden_sections', hiddenSections);\n\t\t}\n\t}\n\n\tremove()\n\t{\n\t\tif (confirm(BX.message('EC_SEC_DELETE_CONFIRM')))\n\t\t{\n\t\t\tconst EventAlias = Util.getBX().Event;\n\t\t\tEventAlias.EventEmitter.emit(\n\t\t\t\t'BX.Calendar.Section:delete',\n\t\t\t\tnew EventAlias.BaseEvent({data: {sectionId: this.id}})\n\t\t\t);\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.deleteCalendarSection', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: this.id\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst sectionManager = Util.getCalendarContext().sectionManager;\n\t\t\t\t\t\tlet reload = true;\n\t\t\t\t\t\tlet section;\n\n\t\t\t\t\t\tfor (let i = 0; i < sectionManager.sections.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsection = sectionManager.sections[i];\n\t\t\t\t\t\t\tif (section.id !== this.id && section.belongsToView())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treload = false;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst calendar = Util.getCalendarContext();\n\t\t\t\t\t\tif (!calendar || reload)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn Util.getBX().reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcalendar.reload();\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\t// this.calendar.displayError(response.errors);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t}\n\t}\n\n\thideGoogle()\n\t{\n\t\tif (confirm(BX.message('EC_CAL_GOOGLE_HIDE_CONFIRM')))\n\t\t{\n\t\t\tthis.hide();\n\t\t\tBX.onCustomEvent(this.calendar, 'BXCalendar:onSectionDelete', [this.id]);\n\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t'BX.Calendar.Section:delete',\n\t\t\t\tnew Event.BaseEvent({data: {sectionId: this.id}})\n\t\t\t);\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.hideExternalCalendarSection', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: this.id\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t// Success\n\t\t\t\t\tBX.delegate(function (response)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.calendar.reload();\n\t\t\t\t\t}, this),\n\t\t\t\t\t// Failure\n\t\t\t\t\tBX.delegate(function (response)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.calendar.displayError(response.errors);\n\t\t\t\t\t}, this)\n\t\t\t\t);\n\t\t}\n\t}\n\n\tgetLink()\n\t{\n\t\treturn this.data && this.data.LINK ? this.data.LINK : '';\n\t}\n\n\tcanBeConnectedToOutlook()\n\t{\n\t\treturn !this.isPseudo() && this.data.OUTLOOK_JS && !(this.data.CAL_DAV_CAL && this.data.CAL_DAV_CON) && !BX.browser.IsMac();\n\t}\n\n\tconnectToOutlook()\n\t{\n\t\tif (!window.jsOutlookUtils)\n\t\t{\n\t\t\tBX.loadScript('/bitrix/js/calendar/outlook.js', BX.delegate(function ()\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\teval(this.data.OUTLOOK_JS);\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t}, this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\teval(this.data.OUTLOOK_JS);\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t}\n\t\t}\n\t}\n\n\tcanDo(action)\n\t{\n\t\t//action: access|add|edit|edit_section|view_full|view_time|view_title\n\t\tif (this.isVirtual() && ['access','add','edit'].includes(action))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (action === 'view_event')\n\t\t{\n\t\t\taction = 'view_time';\n\t\t}\n\n\t\treturn this.data.PERM && this.data.PERM[action];\n\t}\n\n\tisSuperposed()\n\t{\n\t\treturn !this.isPseudo() && !!this.data.SUPERPOSED;\n\t}\n\n\tisPseudo()\n\t{\n\t\treturn false;\n\t}\n\n\tisVirtual()\n\t{\n\t\treturn (this.data.CAL_DAV_CAL && this.data.CAL_DAV_CAL.indexOf('@virtual/events/') !== -1)\n\t\t\t|| (this.data.GAPI_CALENDAR_ID && this.data.GAPI_CALENDAR_ID.indexOf('@group.v.calendar.google.com') !== -1)\n\t\t\t|| (this.data.EXTERNAL_TYPE === 'google_readonly')\n\t\t\t|| (this.data.EXTERNAL_TYPE === 'google_freebusy')\n\t}\n\n\tisGoogle()\n\t{\n\t\treturn this.data.GAPI_CALENDAR_ID;\n\t}\n\n\tisCalDav()\n\t{\n\t\treturn !this.isPseudo() && this.data.CAL_DAV_CAL && this.data.CAL_DAV_CON;\n\t}\n\n\tisCompanyCalendar()\n\t{\n\t\treturn !this.isPseudo() && this.type !== 'user' && this.type !== 'group' && !this.ownerId;\n\t}\n\n\tbelongsToView()\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\treturn this.type === calendarContext.getCalendarType()\n\t\t\t&& this.ownerId === calendarContext.getOwnerId();\n\t}\n\n\tbelongsToOwner()\n\t{\n\t\treturn this.belongsToUser(Util.getCalendarContext().getUserId());\n\t}\n\n\tbelongsToUser(userId)\n\t{\n\t\treturn this.type === 'user'\n\t\t\t&& this.ownerId === parseInt(userId)\n\t\t\t&& this.data.ACTIVE !== 'N';\n\t}\n\n\tisActive()\n\t{\n\t\treturn this.data.ACTIVE !== 'N';\n\t}\n\n\tgetType()\n\t{\n\t\treturn this.type;\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn this.ownerId;\n\t}\n}","import {Util} from 'calendar.util';\nimport { Event, Type, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { CalendarSection } from './calendarsection';\n\nexport class CalendarTaskSection extends CalendarSection\n{\n\tconstructor(data = {}, {type, userId, ownerId})\n\t{\n\t\tconst defaultColor = '#ff5b55';\n\t\tlet defaultName = Loc.getMessage('EC_SEC_MY_TASK_DEFAULT');\n\n\t\tif(type === 'user' && userId !== ownerId)\n\t\t{\n\t\t\tdefaultName = Loc.getMessage('EC_SEC_USER_TASK_DEFAULT');\n\t\t}\n\t\telse if(type === 'group')\n\t\t{\n\t\t\tdefaultName = Loc.getMessage('EC_SEC_GROUP_TASK_DEFAULT');\n\t\t}\n\n\t\tsuper({\n\t\t\tID: 'tasks',\n\t\t\tNAME: data.name || defaultName,\n\t\t\tCOLOR: data.color || defaultColor,\n\t\t\tPERM: {\n\t\t\t\tedit_section:true,\n\t\t\t\tview_full:true,\n\t\t\t\tview_time:true,\n\t\t\t\tview_title:true\n\t\t\t}\n\t\t});\n\t}\n\n\tisPseudo(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tupdateData(data)\n\t{\n\t\tsuper.updateData(data);\n\t\tthis.id = data.ID;\n\t}\n}","import {Entry} from \"calendar.entry\";\nimport {Util} from 'calendar.util';\nimport { Event, Loc, Type } from 'main.core';\nimport {CalendarSection} from './calendarsection';\nimport {CalendarTaskSection} from './calendartasksection';\nimport {EventEmitter} from 'main.core.events';\nexport {CalendarSection};\n\nexport class SectionManager\n{\n\tstatic newEntrySectionId = null;\n\n\tconstructor(data, config)\n\t{\n\t\tthis.setSectons(data.sections);\n\t\tthis.setConfig(config);\n\t\tthis.addTaskSection();\n\n\t\tEventEmitter.subscribeOnce('BX.Calendar.Section:delete', this.deleteSectionHandler.bind(this));\n\t\t//BX.addCustomEvent(\"BXCalendar:onSectionDelete\", BX.proxy(this.unsetSectionHandler, this));\n\t}\n\n\tsetSectons(rawSections = [])\n\t{\n\t\tthis.sections = [];\n\t\tthis.sectionIndex = {};\n\n\t\trawSections.forEach((sectionData) => {\n\t\t\tconst section = new CalendarSection(sectionData);\n\t\t\tif (section.canDo('view_time'))\n\t\t\t{\n\t\t\t\tthis.sections.push(section);\n\t\t\t\tthis.sectionIndex[section.getId()] = this.sections.length - 1;\n\t\t\t}\n\t\t});\n\t}\n\n\tsortSections()\n\t{\n\t\tthis.sectionIndex = {};\n\t\tthis.sections = this.sections.sort((a, b) => {\n\t\t\tif (Type.isFunction(a.isPseudo) && a.isPseudo())\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse if (Type.isFunction(b.isPseudo) && b.isPseudo())\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn a.name.localeCompare(b.name);\n\t\t});\n\n\t\tthis.sections.forEach((section, index) => {\n\t\t\tthis.sectionIndex[section.getId()] = index;\n\t\t});\n\t}\n\n\tsetConfig(config)\n\t{\n\t\tthis.hiddenSections = config.hiddenSections || [];\n\t\tthis.calendarType = config.type;\n\t\tthis.ownerId = config.ownerId;\n\t\tthis.userId = config.userId;\n\t\tthis.defaultSectionAccess = config.new_section_access || {};\n\n\t\tthis.sectionAccessTasks = config.sectionAccessTasks;\n\t\tthis.showTasks = config.showTasks;\n\t\tthis.customizationData = config.sectionCustomization || {};\n\t}\n\n\taddTaskSection()\n\t{\n\t\tif (this.showTasks)\n\t\t{\n\t\t\tconst taskSection = new CalendarTaskSection(\n\t\t\t\tthis.customizationData['tasks' + this.ownerId],\n\t\t\t\t{\n\t\t\t\t\ttype: this.calendarType,\n\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\townerId: this.ownerId\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis.sections.push(taskSection);\n\t\t\tthis.sectionIndex[taskSection.id] = this.sections.length - 1;\n\t\t}\n\t}\n\n\tgetCalendarType()\n\t{\n\t\treturn this.calendarType;\n\t}\n\n\thandlePullChanges(params)\n\t{\n\t\tif (params?.fields?.CAL_TYPE === 'location')\n\t\t{\n\t\t\tthis.handleLocationPullChanges(params);\n\t\t}\n\t\telse if (params.command === 'delete_section')\n\t\t{\n\t\t\tconst sectionId = parseInt(params.fields.ID, 10);\n\t\t\tif (this.sectionIndex[sectionId])\n\t\t\t{\n\t\t\t\tthis.deleteSectionHandler(sectionId);\n\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t'BX.Calendar.Section:pull-delete',\n\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: { sectionId: sectionId }\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.reloadData();\n\t\t\t}\n\t\t}\n\t\telse if (params.command === 'edit_section')\n\t\t{\n\t\t\tthis.reloadData().then(() => {\n\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t'BX.Calendar.Section:pull-edit'\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tUtil.getBX().Event.EventEmitter.emit('BX.Calendar:doRefresh');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.reloadData();\n\t\t}\n\t}\n\n\thandleLocationPullChanges(params)\n\t{\n\n\t}\n\n\treloadData()\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.getSectionList', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t'type': this.calendarType,\n\t\t\t\t\t\t'ownerId': this.ownerId\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.setSectons(response.data.sections || []);\n\t\t\t\t\t\tif (response.data.config)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.setConfig(config);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.addTaskSection();\n\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t// Failure\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\t//this.calendar.displayError(response.errors);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t}\n\n\tgetSections()\n\t{\n\t\treturn this.sections;\n\t}\n\n\tgetSuperposedSectionList()\n\t{\n\t\tvar i, result = [];\n\t\tfor (i = 0; i < this.sections.length; i++)\n\t\t{\n\t\t\tif (this.sections[i].isSuperposed()\n\t\t\t\t&& this.sections[i].isActive())\n\t\t\t{\n\t\t\t\tresult.push(this.sections[i]);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetSectionListForEdit()\n\t{\n\t\tvar i, result = [];\n\t\tfor (i = 0; i < this.sections.length; i++)\n\t\t{\n\t\t\tif (this.sections[i].canDo('add')\n\t\t\t\t&& !this.sections[i].isPseudo()\n\t\t\t\t&& this.sections[i].isActive())\n\t\t\t{\n\t\t\t\tresult.push(this.sections[i]);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetSection(id)\n\t{\n\t\treturn this.sections[this.sectionIndex[id]] || {};\n\t}\n\n\tgetDefaultSectionName()\n\t{\n\t\treturn Loc.getMessage('EC_DEFAULT_SECTION_NAME');\n\t}\n\n\tgetDefaultSectionAccess()\n\t{\n\t\treturn this.defaultSectionAccess;\n\t\t// return this.calendar.util.config.new_section_access || {};\n\t}\n\n\tsaveSection(name, color, access, params)\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tname = (Type.isString(name) && name.trim())\n\t\t\t\t? name.trim()\n\t\t\t\t: Loc.getMessage('EC_SEC_SLIDER_NEW_SECTION');\n\n\t\t\tif (params.section.id)\n\t\t\t{\n\t\t\t\t// BX.onCustomEvent(this.calendar, 'BXCalendar:onSectionChange', [\n\t\t\t\t// \tparams.section.id,\n\t\t\t\t// \t{\n\t\t\t\t// \t\tname: name,\n\t\t\t\t// \t\tcolor: color\n\t\t\t\t// \t}]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// BX.onCustomEvent(this.calendar, 'BXCalendar:onSectionAddBefore', [{\n\t\t\t\t// \tname: name,\n\t\t\t\t// \tcolor: color\n\t\t\t\t// }]);\n\t\t\t}\n\n\t\t\tconst isCustomization = params.section.id && params.section.isPseudo();\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.editCalendarSection', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\t\taction: params.section.id ? 'editSection' : 'newSection',\n\t\t\t\t\t\t\ttype: params.section.type || this.calendarType\n\t\t\t\t\t\t},\n\t\t\t\t\t\tid: params.section.id || 0,\n\t\t\t\t\t\tname: name,\n\t\t\t\t\t\ttype: params.section.type || this.calendarType,\n\t\t\t\t\t\townerId: params.section.ownerId || this.ownerId,\n\t\t\t\t\t\tcolor: color,\n\t\t\t\t\t\taccess: access || null,\n\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\tcustomization: isCustomization ? 'Y' : 'N'\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tif (isCustomization)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.reload();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst sectionList = response.data.sectionList || [];\n\t\t\t\t\t\tthis.setSectons(sectionList);\n\t\t\t\t\t\tthis.sortSections();\n\n\t\t\t\t\t\tUtil.getBX().Event.EventEmitter.emit(\n\t\t\t\t\t\t\t'BX.Calendar.Section:edit',\n\t\t\t\t\t\t\tnew Event.BaseEvent(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: { sectionList: sectionList }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t});\n\t}\n\n\tsectionIsShown(id)\n\t{\n\t\treturn !BX.util.in_array(id, this.hiddenSections);\n\t}\n\n\tgetHiddenSections()\n\t{\n\t\treturn this.hiddenSections || [];\n\t}\n\n\tsetHiddenSections(hiddenSections)\n\t{\n\t\tthis.hiddenSections = hiddenSections;\n\t}\n\n\tgetSectionsInfo()\n\t{\n\t\tconst allActive = [];\n\t\tconst superposed = [];\n\t\tconst active = [];\n\t\tconst hidden = [];\n\n\t\tthis.sections.forEach((section) => {\n\t\t\tif (section.isShown())\n\t\t\t{\n\t\t\t\tif (section.isSuperposed())\n\t\t\t\t{\n\t\t\t\t\tsuperposed.push(section.id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tactive.push(section.id);\n\t\t\t\t}\n\t\t\t\tallActive.push(section.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thidden.push(section.id);\n\t\t\t}\n\t\t});\n\n\t\treturn { superposed, active, hidden, allActive };\n\t}\n\n\tdeleteSectionHandler(sectionId)\n\t{\n\t\tif (this.sectionIndex[sectionId] !== undefined)\n\t\t{\n\t\t\tthis.sections = BX.util.deleteFromArray(this.sections, this.sectionIndex[sectionId]);\n\t\t\tfor (var i = 0; i < this.sections.length; i++)\n\t\t\t{\n\t\t\t\tthis.sectionIndex[this.sections[i].id] = i;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getNewEntrySectionId(calendarType = null, ownerId = null)\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext && !calendarContext.isExternalMode())\n\t\t{\n\t\t\tconst section = calendarContext.sectionManager.getDefaultSection(calendarType, ownerId);\n\t\t\treturn parseInt(section.id, 10);\n\t\t}\n\t\treturn SectionManager.newEntrySectionId;\n\t}\n\n\tstatic setNewEntrySectionId(sectionId)\n\t{\n\t\tSectionManager.newEntrySectionId = parseInt(sectionId);\n\t}\n\n\tstatic getSectionGroupList(options = {})\n\t{\n\t\tlet\n\t\t\ttype = options.type,\n\t\t\townerId = options.ownerId,\n\t\t\tuserId = options.userId,\n\t\t\tfollowedUserList = options.trackingUsersList || Util.getFollowedUserList(userId),\n\t\t\tsectionGroups = [],\n\t\t\ttitle;\n\n\t\t// 1. Main group - depends from current view\n\t\tif (type === 'user')\n\t\t{\n\t\t\tif (userId === ownerId)\n\t\t\t{\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_USER_CALENDARS_LIST');\n\t\t\t}\n\t\t}\n\t\telse if (type === 'group')\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_GROUP_CALENDARS_LIST');\n\t\t}\n\t\telse if (type === 'location')\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_LOCATION_LIST');\n\t\t}\n\t\telse if (type === 'resource')\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_RESOURCE_LIST');\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TITLE_COMP_CAL');\n\t\t}\n\n\t\tsectionGroups.push({\n\t\t\ttitle: title,\n\t\t\ttype: type,\n\t\t\tbelongsToView: true\n\t\t});\n\n\t\tif (type !== 'user' || userId !== ownerId)\n\t\t{\n\t\t\tsectionGroups.push({\n\t\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST'),\n\t\t\t\ttype: 'user',\n\t\t\t\townerId: userId\n\t\t\t});\n\t\t}\n\n\t\t// 2. Company calendar\n\t\tif (type !== 'company' && type !== 'company_calendar')\n\t\t{\n\t\t\tsectionGroups.push({\n\t\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_TITLE_COMP_CAL'),\n\t\t\t\ttype: 'company'\n\t\t\t});\n\t\t}\n\n\t\t// 3. Users calendars\n\t\tif (Type.isArray(followedUserList))\n\t\t{\n\t\t\tfollowedUserList.forEach((user) => {\n\t\t\t\tif (parseInt(user.ID) !== ownerId || type !== 'user')\n\t\t\t\t{\n\t\t\t\t\tsectionGroups.push({\n\t\t\t\t\t\ttitle: BX.util.htmlspecialchars(user.FORMATTED_NAME),\n\t\t\t\t\t\ttype: 'user',\n\t\t\t\t\t\townerId: parseInt(user.ID)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// 4. Groups calendars\n\t\tsectionGroups.push({\n\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP'),\n\t\t\ttype: 'group'\n\t\t});\n\n\t\t// 5. Resources calendars\n\t\tsectionGroups.push({\n\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_TITLE_RESOURCE_CAL'),\n\t\t\ttype: 'resource'\n\t\t});\n\n\t\t// 6. Location calendars\n\t\tsectionGroups.push({\n\t\t\ttitle: Loc.getMessage('EC_SEC_SLIDER_TITLE_LOCATION_CAL'),\n\t\t\ttype: 'location'\n\t\t});\n\n\t\treturn sectionGroups;\n\t}\n\n\tgetSectionAccessTasks()\n\t{\n\t\treturn this.sectionAccessTasks;\n\t}\n\n\tgetDefaultSection(calendarType = null, ownerId = null)\n\t{\n\t\tcalendarType = Type.isString(calendarType) ? calendarType : this.calendarType;\n\t\townerId = Type.isNumber(ownerId) ? ownerId : this.ownerId;\n\n\t\tconst userSettings = Util.getUserSettings();\n\t\tconst key = calendarType + ownerId;\n\t\tconst defaultSectionId = userSettings.defaultSections[key] || userSettings.lastUsedSection;\n\t\tconst sections = this.getSectionListForEdit();\n\n\t\tlet section = sections.find((item) => {\n\t\t\treturn item.type === calendarType\n\t\t\t\t&& item.ownerId === ownerId\n\t\t\t\t&& item.id === defaultSectionId;\n\t\t});\n\n\t\tif (!section)\n\t\t{\n\t\t\tsection = sections.find((item) => {\n\t\t\t\treturn item.type === calendarType\n\t\t\t\t\t&& item.ownerId === ownerId\n\t\t\t});\n\t\t}\n\n\t\treturn section;\n\t}\n\n\tsetDefaultSection(sectionId)\n\t{\n\t\tconst section = this.getSection(parseInt(sectionId, 10));\n\n\t\tif (section\n\t\t\t&& section.type === this.calendarType\n\t\t\t&& section.ownerId === this.ownerId)\n\t\t{\n\t\t\tconst userSettings = Util.getUserSettings();\n\t\t\tconst key = this.calendarType + this.ownerId;\n\t\t\tif (userSettings.defaultSections[key] !== section.id)\n\t\t\t{\n\t\t\t\tuserSettings.defaultSections[key] = section.id;\n\t\t\t\tUtil.setUserSettings(userSettings);\n\n\t\t\t\tBX.ajax.runAction('calendar.api.calendarajax.updateDefaultSectionId', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t'key': key,\n\t\t\t\t\t\t'sectionId': sectionId\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic saveDefaultSectionId(sectionId, options = {})\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tcalendarContext.sectionManager.setDefaultSection(sectionId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (Type.isArray(options.sections) && options.calendarType && options.ownerId)\n\t\t\t{\n\t\t\t\tconst section = options.sections.find((item) => {\n\t\t\t\t\tconst id = parseInt(item.ID || item.id, 10);\n\t\t\t\t\tconst ownerId = parseInt(item.OWNER_ID || item.ownerId, 10);\n\t\t\t\t\tconst type = item.CAL_TYPE || item.type;\n\n\t\t\t\t\treturn id === parseInt(sectionId,10)\n\t\t\t\t\t\t&& ownerId === parseInt(options.ownerId, 10)\n\t\t\t\t\t\t&& type === options.calendarType;\n\t\t\t\t});\n\n\t\t\t\tif (section)\n\t\t\t\t{\n\t\t\t\t\tconst userSettings = Util.getUserSettings();\n\t\t\t\t\tconst key = options.calendarType + options.ownerId;\n\t\t\t\t\tif (userSettings && userSettings.defaultSections[key] !== sectionId)\n\t\t\t\t\t{\n\t\t\t\t\t\tuserSettings.defaultSections[key] = sectionId;\n\t\t\t\t\t\tUtil.setUserSettings(userSettings);\n\t\t\t\t\t\tSectionManager.newEntrySectionId = sectionId;\n\n\t\t\t\t\t\tBX.ajax.runAction('calendar.api.calendarajax.updateDefaultSectionId', {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t'key': key,\n\t\t\t\t\t\t\t\t'sectionId': sectionId\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}"],"names":["CalendarSection","data","updateData","calendarContext","Util","getCalendarContext","sectionManager","id","type","CAL_TYPE","ownerId","parseInt","OWNER_ID","ID","color","COLOR","name","NAME","sectionIsShown","isShown","hiddenSections","getHiddenSections","BX","util","deleteFromArray","array_search","setHiddenSections","userOptions","save","push","confirm","message","EventAlias","getBX","Event","EventEmitter","emit","BaseEvent","sectionId","ajax","runAction","then","response","reload","section","i","sections","length","belongsToView","calendar","hide","onCustomEvent","delegate","displayError","errors","LINK","isPseudo","OUTLOOK_JS","CAL_DAV_CAL","CAL_DAV_CON","browser","IsMac","window","jsOutlookUtils","loadScript","eval","e","action","isVirtual","includes","PERM","SUPERPOSED","indexOf","GAPI_CALENDAR_ID","EXTERNAL_TYPE","getCalendarType","getOwnerId","belongsToUser","getUserId","userId","ACTIVE","CalendarTaskSection","defaultColor","defaultName","Loc","getMessage","edit_section","view_full","view_time","view_title","SectionManager","config","setSectons","setConfig","addTaskSection","subscribeOnce","deleteSectionHandler","bind","rawSections","sectionIndex","forEach","sectionData","canDo","getId","sort","a","b","Type","isFunction","localeCompare","index","calendarType","defaultSectionAccess","new_section_access","sectionAccessTasks","showTasks","customizationData","sectionCustomization","taskSection","params","fields","handleLocationPullChanges","command","reloadData","Promise","resolve","result","isSuperposed","isActive","access","isString","trim","isCustomization","analyticsLabel","customization","sectionList","sortSections","in_array","allActive","superposed","active","hidden","undefined","isNumber","userSettings","getUserSettings","key","defaultSectionId","defaultSections","lastUsedSection","getSectionListForEdit","find","item","getSection","setUserSettings","isExternalMode","getDefaultSection","newEntrySectionId","options","followedUserList","trackingUsersList","getFollowedUserList","sectionGroups","title","isArray","user","htmlspecialchars","FORMATTED_NAME","setDefaultSection"],"mappings":"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"}