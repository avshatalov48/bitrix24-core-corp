(function(t){var e={controls:{},onSelect:function(t,i,o,n,s,l){BX.SocNetLogDestination.obItemsSelected[s]={};BX.SocNetLogDestination.obItemsSelected[s][t.id]=i;var d=e.controls[s];if(d){d.setData(BX.util.htmlspecialcharsback(t.name),t.id);d.getLabelNode().value="";d.getLabelNode().blur();if(BX.SocNetLogDestination.popupWindow!=null){BX.SocNetLogDestination.popupWindow.close()}if(BX.SocNetLogDestination.popupSearchWindow!=null){BX.SocNetLogDestination.popupSearchWindow.close()}}}};var i=function(){this.id="";this.filterId="";this.settings={};this.fieldId="";this.control=null;this.inited=null};i.create=function(e,o){var n=new i(e,o);n.initialize(e,o);BX.onCustomEvent(t,"BX.SonetGroupList.Filter:create",[e]);return n};i.prototype.getSetting=function(t,e){return this.settings.hasOwnProperty(t)?this.settings[t]:e};i.prototype.getSearchInput=function(){return this.control?this.control.getLabelNode():null};i.prototype.initialize=function(e,i){this.id=e;this.settings=i?i:{};this.fieldId=this.getSetting("fieldId","");this.filterId=this.getSetting("filterId","");this.inited=false;this.opened=null;this.closed=null;var o=this.getSetting("initialValue",false);if(!!o){var n={};n[this.fieldId]=o.itemId;n[this.fieldId+"_label"]=o.itemName;BX.Main.filterManager.getById(this.filterId).getApi().setFields(n)}BX.addCustomEvent(t,"BX.Main.Filter:customEntityFocus",BX.delegate(this.onCustomEntitySelectorOpen,this));BX.addCustomEvent(t,"BX.Main.Filter:customEntityBlur",BX.delegate(this.onCustomEntitySelectorClose,this));BX.addCustomEvent(t,"BX.Main.Filter:onGetStopBlur",BX.delegate(this.onGetStopBlur,this));BX.addCustomEvent(t,"BX.Main.Selector:beforeInitDialog",BX.delegate(this.onBeforeInitDialog,this));BX.addCustomEvent(t,"BX.SocNetLogDestination:onBeforeSwitchTabFocus",BX.delegate(this.onBeforeSwitchTabFocus,this));BX.addCustomEvent(t,"BX.SocNetLogDestination:onBeforeSelectItemFocus",BX.delegate(this.onBeforeSelectItemFocus,this));BX.addCustomEvent(t,"BX.Main.Filter:customEntityRemove",BX.delegate(this.onCustomEntityRemove,this))};i.prototype.open=function(){var e=this.id;if(!this.inited){var i=this.getSearchInput();i.id=i.name;BX.addCustomEvent(t,"BX.Main.Selector:afterInitDialog",BX.delegate(function(t){if(typeof t.id!="undefined"||t.id!=this.id){return}this.opened=true;this.closed=false},this));BX.onCustomEvent(t,"BX.SonetGroupList.Filter:openInit",[{id:this.id,inputId:i.id,containerId:i.id}]);this.inited=true}else{BX.onCustomEvent(t,"BX.SonetGroupList.Filter:open",[{id:this.id,bindNode:this.control.getField()}]);this.opened=true;this.closed=false}};i.prototype.close=function(){BX.SocNetLogDestination.closeDialog();this.opened=false;this.closed=true};i.prototype.onCustomEntitySelectorOpen=function(t){var i=t.getId();if(this.fieldId!==i){this.control=null}else{this.control=t;if(this.control){var o=this.control.getCurrentValues();this.currentUser={entityId:o["value"]}}e.controls[this.id]=this.control;if(!this.opened){this.open()}else{this.close()}}};i.prototype.onCustomEntitySelectorClose=function(t){if(this.fieldId===t.getId()&&this.inited===true){this.control=null;this.close()}};i.prototype.onGetStopBlur=function(t,e){if(BX.findParent(t.target,{className:"bx-lm-box"})){e.stopBlur=true}};i.prototype.onCustomEntityRemove=function(t){if(this.fieldId===t.getId()){if(typeof t.hiddenInput!="undefined"&&typeof t.hiddenInput.value!="undefined"&&typeof BX.SocNetLogDestination.obItemsSelected[this.id]!="undefined"&&typeof BX.SocNetLogDestination.obItemsSelected[this.id][t.hiddenInput.value]!="undefined"){delete BX.SocNetLogDestination.obItemsSelected[this.id][t.hiddenInput.value]}}};i.prototype.onBeforeSwitchTabFocus=function(t){if(this.id===t.id){t.blockFocus=true}};i.prototype.onBeforeSelectItemFocus=function(t){if(this.id===t.id){t.blockFocus=true}};i.prototype.onBeforeInitDialog=function(t){if(typeof t.id=="undefined"||t.id!=this.id){return}if(this.closed){t.blockInit=true}};t.CalendarFilterUserSelectorManager=e;t.CalendarFilterUserSelector=i})(window);