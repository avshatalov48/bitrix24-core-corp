{"version":3,"file":"blank-selector.bundle.js","sources":["../src/list-item.js","../src/blank.js","../src/blank-field.js","../src/index.js"],"sourcesContent":["import { Tag, Dom } from 'main.core';\n\nexport class ListItem<T>\n{\n\t#layout: HTMLElement;\n\t#props: T;\n\t#titleNode: HTMLElement;\n\t#descriptionNode: HTMLElement;\n\n\tconstructor(props: T)\n\t{\n\t\tthis.#titleNode = Tag.render`\n\t\t\t<span class=\"sign-blank-selector__list_item-title\"></span>\n\t\t`;\n\t\tthis.#descriptionNode = Tag.render`\n\t\t\t<span class=\"sign-blank-selector__list_item-info\"></span>\n\t\t`;\n\t\tthis.setProps(props);\n\t\tthis.#layout = this.#createListItem();\n\t}\n\n\t#createListItem(): HTMLElement\n\t{\n\t\tconst { title, description, modifier } = this.getProps();\n\t\tthis.setTitle(title);\n\t\tthis.setDescription(description);\n\n\t\treturn Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: `sign-blank-selector__list_item --${modifier}`,\n\t\t\t},\n\t\t\tchildren: [this.#titleNode, this.#descriptionNode],\n\t\t});\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.#layout;\n\t}\n\n\tsetTitle(title: string = ''): void\n\t{\n\t\tthis.#titleNode.textContent = title;\n\t\tthis.#titleNode.title = title;\n\t\tthis.setProps({\n\t\t\t...this.getProps(),\n\t\t\ttitle,\n\t\t});\n\t}\n\n\tsetDescription(description: string = ''): void\n\t{\n\t\tthis.#descriptionNode.textContent = description;\n\t\tthis.#descriptionNode.title = description;\n\t\tthis.setProps({\n\t\t\t...this.getProps(),\n\t\t\tdescription,\n\t\t});\n\t}\n\n\tgetProps(): T\n\t{\n\t\treturn this.#props;\n\t}\n\n\tsetProps(props: T): void\n\t{\n\t\tthis.#props = props;\n\t}\n}\n","import { Tag, Dom } from 'main.core';\nimport { Loader } from 'main.loader';\nimport { ListItem } from './list-item';\nimport 'ui.icons';\n\nexport class Blank<T> extends ListItem<T>\n{\n\t#placeholder: HTMLElement;\n\t#preview: HTMLElement;\n\t#loader: Loader;\n\n\tconstructor(props: T)\n\t{\n\t\tsuper({ ...props, modifier: 'blank' });\n\t\tthis.#placeholder = Tag.render`<div class=\"sign-blank-selector__list_item-status\"></div>`;\n\t\tthis.#preview = Tag.render`\n\t\t\t<div class=\"sign-blank-selector__list_item-preview\" hidden>\n\t\t\t\t<img\n\t\t\t\t\tonload=\"${() => {\n\t\t\t\t\t\tthis.#preview.hidden = false;\n\t\t\t\t\t\tthis.#placeholder.hidden = true;\n\t\t\t\t\t}}\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t`;\n\t\tthis.#loader = new Loader({ size: 30, target: this.#placeholder });\n\t\tconst layout = this.getLayout();\n\t\tDom.prepend(this.#placeholder, layout);\n\t\tDom.prepend(this.#preview, layout);\n\t}\n\n\tsetAvatarWithDescription(description: string, userAvatarUrl: string | null): void\n\t{\n\t\tthis.setDescription(description);\n\t\tthis.setProps({\n\t\t\t...this.getProps(),\n\t\t\tuserAvatarUrl,\n\t\t});\n\t\tconst avatarIcon = userAvatarUrl\n\t\t\t? Tag.render`\n\t\t\t\t<img class=\"sign-blank-selector__list_item-info-avatar\" src=\"${userAvatarUrl}\" />\n\t\t\t`\n\t\t\t: Tag.render`\n\t\t\t\t<span class=\"sign-blank-selector__list_item-info-avatar ui-icon ui-icon-common-user\">\n\t\t\t\t\t<i></i>\n\t\t\t\t</span>\n\t\t\t`;\n\t\tconst { lastElementChild: descriptionNode } = this.getLayout();\n\t\tDom.prepend(avatarIcon, descriptionNode);\n\t}\n\n\tselect(): void\n\t{\n\t\tDom.addClass(this.getLayout(), '--active');\n\t}\n\n\tdeselect(): void\n\t{\n\t\tDom.removeClass(this.getLayout(), '--active');\n\t\tthis.getLayout().blur();\n\t}\n\n\tremove(): void\n\t{\n\t\tDom.remove(this.getLayout());\n\t}\n\n\tsetId(id: number): void\n\t{\n\t\tthis.getLayout().dataset.id = id;\n\t}\n\n\tsetReady(isReady: boolean): void\n\t{\n\t\tif (!isReady)\n\t\t{\n\t\t\tthis.#loader.show();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst layout = this.getLayout();\n\t\tlayout.tabIndex = '0';\n\t\tthis.#loader.hide();\n\t\tDom.addClass(layout, '--loaded');\n\t}\n\n\tsetPreview(previewUrl: string): void\n\t{\n\t\tif (previewUrl)\n\t\t{\n\t\t\tthis.#preview.firstElementChild.src = previewUrl;\n\t\t}\n\t}\n}\n","import { Cache, Tag, Dom, Type, Loc, Text } from 'main.core';\nimport { type BaseCache } from 'main.core.cache';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { Api } from 'sign.v2.api';\nimport { TagSelector } from 'ui.entity-selector';\nimport type { BlankSelectorConfig } from './index';\nimport { BlankSelector } from './index';\n\nexport type BlankFieldOptions = {\n\tselectorOptions?: BlankSelectorConfig,\n\tdata?: {\n\t\tblankId: number | string | null,\n\t},\n\tevents?: {\n\t\t[key: string]: (event: BaseEvent) => void,\n\t},\n};\n\n/**\n * @namespace BX.Sign.V2\n */\nexport class BlankField extends EventEmitter\n{\n\t#cache: BaseCache = new Cache.MemoryCache();\n\n\tconstructor(options: BlankFieldOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Sign.BlankSelector.BlankField');\n\t\tthis.subscribeFromOptions(options?.events);\n\t\tthis.#setOptions(options);\n\n\t\tconst blankId = options?.data?.blankId;\n\t\tif (Type.isStringFilled(blankId) || Type.isNumber(blankId))\n\t\t{\n\t\t\tthis.#getApi()\n\t\t\t\t.getBlankById(options.data.blankId)\n\t\t\t\t.then(({ id, title }) => {\n\t\t\t\t\tthis.#getTagSelector().addTag({\n\t\t\t\t\t\tid,\n\t\t\t\t\t\ttitle,\n\t\t\t\t\t\tentityId: 'blank',\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\t#setOptions(options: BlankFieldOptions)\n\t{\n\t\tthis.#cache.set('options', options);\n\t}\n\n\t#getOptions(): BlankFieldOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\t#getApi(): Api\n\t{\n\t\treturn this.#cache.remember('api', () => new Api());\n\t}\n\n\t#getBlankSelector(): BlankSelector\n\t{\n\t\treturn this.#cache.remember('blankSelector', () => {\n\t\t\treturn new BlankSelector({\n\t\t\t\t...(this.#getOptions().selectorOptions),\n\t\t\t\tevents: {\n\t\t\t\t\ttoggleSelection: (event: BaseEvent) => {\n\t\t\t\t\t\tconst { id, title, selected } = event.getData();\n\t\t\t\t\t\tconst tagSelector = this.#getTagSelector();\n\t\t\t\t\t\tif (selected)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttagSelector.addTag({\n\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\ttitle,\n\t\t\t\t\t\t\t\tentityId: 'blank',\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\ttagSelector.showAddButton();\n\t\t\t\t\t\t\tthis.emit('onSelect', event);\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (tagSelector.getTags().length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttagSelector.showAddButton();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.emit('onCancel');\n\t\t\t\t\t},\n\t\t\t\t\tonSliderClose: () => {\n\t\t\t\t\t\tconst tagSelector = this.#getTagSelector();\n\t\t\t\t\t\tif (tagSelector.getTags().length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttagSelector.showAddButton();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.#resetBlankSelector();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\t#getTagSelector(): TagSelector\n\t{\n\t\treturn this.#cache.remember('tagSelector', () => {\n\t\t\treturn new TagSelector({\n\t\t\t\tid: Text.getRandom(),\n\t\t\t\tmultiple: false,\n\t\t\t\tshowTextBox: false,\n\t\t\t\taddButtonCaption: Loc.getMessage('SIGN_BLANK_SELECTOR_FIELD_ADD_BUTTON_LABEL'),\n\t\t\t\ttagMaxWidth: 500,\n\t\t\t\tevents: {\n\t\t\t\t\tonAddButtonClick: () => {\n\t\t\t\t\t\tthis.#getBlankSelector().openInSlider();\n\t\t\t\t\t\tthis.#getTagSelector().hideTextBox();\n\t\t\t\t\t},\n\t\t\t\t\tonAfterTagRemove: () => {\n\t\t\t\t\t\tthis.#getTagSelector().hideTextBox();\n\t\t\t\t\t\tthis.#getTagSelector().showAddButton();\n\t\t\t\t\t\tthis.emit('onRemove');\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember('layout', () => {\n\t\t\tconst layout = Tag.render`\n\t\t\t\t<div class=\"sign-blank-selector-field\">\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.#getTagSelector().renderTo(layout);\n\n\t\t\treturn layout;\n\t\t});\n\t}\n\n\trenderTo(targetContainer: HTMLElement)\n\t{\n\t\tif (Type.isDomNode(targetContainer))\n\t\t{\n\t\t\tDom.append(this.getLayout(), targetContainer);\n\t\t}\n\t}\n\n\t#resetBlankSelector(): void\n\t{\n\t\tthis.#cache.delete('blankSelector');\n\t}\n}\n","import { Tag, Loc, Dom, Event, Type, Reflection, Cache } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { Loader } from 'main.loader';\nimport { Popup } from 'main.popup';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { isTemplateMode } from 'sign.v2.sign-settings';\nimport { Layout } from 'ui.sidepanel.layout';\nimport { TileWidget } from 'ui.uploader.tile-widget';\nimport { UploaderEvent, type UploaderFile } from 'ui.uploader.core';\nimport { Api } from 'sign.v2.api';\nimport { ListItem } from './list-item';\nimport { Blank } from './blank';\nimport { BlankField } from './blank-field';\nimport type { BlankSelectorConfig, BlankData, ListItemProps, BlankProps } from './types/type';\nimport './style.css';\n\ntype RemoveOptions = {\n\tremoveFromServer: boolean;\n};\n\nconst uploaderOptions = {\n\tcontroller: 'sign.upload.blankUploadController',\n\tacceptedFileTypes: [\n\t\t'.jpg', '.jpeg',\n\t\t'.png', '.pdf',\n\t\t'.doc', '.docx',\n\t\t'.rtf', '.odt',\n\t],\n\tmultiple: true,\n\tautoUpload: false,\n\tmaxFileSize: 50 * 1024 * 1024,\n\tmaxFileCount: 100,\n\timageMaxFileSize: 10 * 1024 * 1024,\n\tmaxTotalFileSize: 50 * 1024 * 1024,\n};\nconst errorPopupOptions = {\n\tid: 'qwerty',\n\tpadding: 20,\n\toffsetLeft: 40,\n\toffsetTop: -12,\n\tangle: true,\n\tdarkMode: true,\n\twidth: 300,\n\tautoHide: true,\n\tcacheable: false,\n\tbindOptions: {\n\t\tposition: 'bottom',\n\t},\n};\n\nexport { BlankField, ListItem };\nexport type { BlankSelectorConfig };\n\nexport class BlankSelector extends EventEmitter\n{\n\t#cache = new Cache.MemoryCache();\n\tselectedBlankId: number;\n\t#blanks: Map<string, ListItem>;\n\t#tileWidget: TileWidget;\n\t#tileWidgetContainer: HTMLElement;\n\t#uploadButtonsContainer: HTMLElement;\n\t#relatedTarget: ?HTMLElement;\n\t#blanksContainer: HTMLElement;\n\t#page: number;\n\t#loadMoreButton: HTMLElement;\n\t#api: Api;\n\t#config: BlankSelectorConfig;\n\n\tconstructor(config: BlankSelectorConfig)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Sign.V2.BlankSelector');\n\t\tthis.subscribeFromOptions(config?.events ?? {});\n\t\tthis.#config = config;\n\t\tthis.selectedBlankId = 0;\n\t\tthis.#blanks = new Map();\n\t\tthis.#page = 0;\n\t\tconst uploadButtons = this.#createUploadButtons();\n\t\tconst dragArea = Tag.render`\n\t\t\t<label class=\"sign-blank-selector__list_drag-area-label\">\n\t\t\t\t${Loc.getMessage('SIGN_BLANK_SELECTOR_DRAG_AREA')}\n\t\t\t</label>\n\t\t`;\n\t\tconst widgetOptions = {\n\t\t\tslots: {\n\t\t\t\tafterDropArea: {\n\t\t\t\t\tcomputed: {\n\t\t\t\t\t\ttitle: () => Loc.getMessage('SIGN_BLANK_SELECTOR_CLEAR_ALL'),\n\t\t\t\t\t},\n\t\t\t\t\tmethods: {\n\t\t\t\t\t\tclear: () => {\n\t\t\t\t\t\t\tthis.clearFiles({ removeFromServer: false });\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: `\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"sign-blank-selector__tile-widget_clear-btn\"\n\t\t\t\t\t\t\t:title=\"title\"\n\t\t\t\t\t\t\t@click=\"clear()\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t`,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tthis.#uploadButtonsContainer = Tag.render`\n\t\t\t<div class=\"sign-blank-selector__list --with-buttons\">\n\t\t\t\t${uploadButtons}\n\t\t\t\t${dragArea}\n\t\t\t</div>\n\t\t`;\n\t\tthis.#tileWidget = new TileWidget({\n\t\t\t...uploaderOptions,\n\t\t\t...config.uploaderOptions,\n\t\t\tdropElement: this.#uploadButtonsContainer,\n\t\t\tbrowseElement: [...uploadButtons, dragArea],\n\t\t\tevents: {\n\t\t\t\t[UploaderEvent.BEFORE_FILES_ADD]: (event) => this.#onFileBeforeAdd(event),\n\t\t\t\t[UploaderEvent.FILE_ADD]: (event) => this.#onFileAdd(event),\n\t\t\t\t[UploaderEvent.FILE_REMOVE]: (event) => this.#onFileRemove(event),\n\t\t\t\t[UploaderEvent.UPLOAD_START]: (event) => this.#onUploadStart(event),\n\t\t\t},\n\t\t}, widgetOptions);\n\t\tthis.#relatedTarget = null;\n\t\tEvent.bind(document, 'mousedown', (event) => {\n\t\t\tthis.#relatedTarget = event.target;\n\t\t});\n\t\tthis.#blanksContainer = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"sign-blank-selector__list\"\n\t\t\t\tonfocusin=\"${({ target }) => {\n\t\t\t\t\tthis.selectBlank(Number(target.dataset.id));\n\t\t\t\t}}\"\n\t\t\t\tonclick=\"${({ target, ctrlKey, metaKey }) => {\n\t\t\t\t\tif (ctrlKey || metaKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.resetSelectedBlank(Number(target.dataset.id), this.#relatedTarget);\n\t\t\t\t\t}\n\t\t\t\t}}\"\n\t\t\t></div>\n\t\t`;\n\t\tthis.#tileWidgetContainer = Tag.render`\n\t\t\t<div class=\"sign-blank-selector__tile-widget\"></div>\n\t\t`;\n\t\tthis.#loadMoreButton = Tag.render`\n\t\t\t<div class=\"sign-blank-selector__load-more --hidden\">\n\t\t\t\t<span onclick=\"${() => this.#loadBlanks(this.#page + 1)}\">\n\t\t\t\t\t${Loc.getMessage('SIGN_BLANK_SELECTOR_LOAD_MORE')}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\t\tthis.#api = new Api();\n\t}\n\n\t#checkForFilesValid(addedFiles: UploaderFile[]): boolean\n\t{\n\t\tconst isImage = (file) => file.getType().includes('image/');\n\t\tconst allAddedImages = addedFiles.every((file) => isImage(file));\n\t\tconst validExtension = addedFiles.every((file) => {\n\t\t\t// TODO merge with this.#config.uploaderOptions.acceptedFileTypes\n\t\t\treturn uploaderOptions.acceptedFileTypes.includes(\n\t\t\t\t`.${file.getExtension()}`,\n\t\t\t);\n\t\t});\n\t\tif (!validExtension || (addedFiles.length > 1 && !allAddedImages))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst uploader = this.#tileWidget.getUploader();\n\t\tconst files = uploader.getFiles();\n\t\tconst filesLength = files.length;\n\t\tconst imagesLimit = this.#getImagesLimit();\n\t\tif (filesLength === 0 && addedFiles.length === 1)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst allExistImages = files.every((file) => isImage(file));\n\n\t\treturn allAddedImages\n\t\t\t&& allExistImages\n\t\t\t&& imagesLimit - filesLength >= addedFiles.length;\n\t}\n\n\t#onFileBeforeAdd(event: BaseEvent)\n\t{\n\t\tconst { files: addedFiles } = event.getData();\n\t\tconst valid = this.#checkForFilesValid(addedFiles);\n\t\tif (valid)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet bindElement = this.#uploadButtonsContainer.firstElementChild;\n\t\tif (Dom.hasClass(this.#uploadButtonsContainer, '--hidden'))\n\t\t{\n\t\t\tconst {\n\t\t\t\t$refs: { container },\n\t\t\t} = this.#tileWidget.getRootComponent();\n\t\t\tbindElement = container.firstElementChild;\n\t\t}\n\n\t\tconst errorPopup = new Popup({\n\t\t\t...errorPopupOptions,\n\t\t\tbindElement,\n\t\t\tcontent: Loc.getMessage(\n\t\t\t\t'SIGN_BLANK_SELECTOR_UPLOAD_HINT',\n\t\t\t\t{ '%imageCountLimit%': this.#getImagesLimit() },\n\t\t\t),\n\t\t});\n\t\terrorPopup.show();\n\t\tevent.preventDefault();\n\t}\n\n\t#getImagesLimit(): number\n\t{\n\t\treturn Type.isInteger(parseInt(this.#config?.uploaderOptions?.maxFileCount, 10))\n\t\t\t? this.#config?.uploaderOptions?.maxFileCount\n\t\t\t: uploaderOptions.maxFileCount\n\t\t;\n\t}\n\n\t#onFileAdd(event: BaseEvent)\n\t{\n\t\tconst title = event.data.file.getName();\n\t\tthis.#toggleTileVisibility(true);\n\t\tthis.resetSelectedBlank();\n\t\tthis.emit('addFile', { title: this.#normalizeTitle(title) });\n\t}\n\n\t#onFileRemove(event: BaseEvent)\n\t{\n\t\tthis.emit('removeFile');\n\t\tconst uploader = this.#tileWidget.getUploader();\n\t\tconst files = uploader.getFiles();\n\t\tif (files.length === 0)\n\t\t{\n\t\t\tthis.#toggleTileVisibility(false);\n\t\t\tthis.emit('clearFiles');\n\t\t}\n\t}\n\n\t#onUploadStart()\n\t{\n\t\tconst uploader = this.#tileWidget.getUploader();\n\t\tconst [firstFile] = uploader.getFiles();\n\t\tconst title = firstFile.getName();\n\t\tconst fileId = firstFile.getId();\n\t\tconst uploadingBlank: Blank<BlankProps> = new Blank({ title });\n\t\tuploadingBlank.setReady(false);\n\t\tDom.prepend(uploadingBlank.getLayout(), this.#blanksContainer);\n\t\tfirstFile.setCustomData(fileId, uploadingBlank);\n\t}\n\n\t#toggleTileVisibility(shouldShow: boolean)\n\t{\n\t\tconst hiddenClass = '--hidden';\n\t\tif (shouldShow)\n\t\t{\n\t\t\tDom.removeClass(this.#tileWidgetContainer, hiddenClass);\n\t\t\tDom.addClass(this.#uploadButtonsContainer, hiddenClass);\n\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.#tileWidgetContainer, hiddenClass);\n\t\tDom.removeClass(this.#uploadButtonsContainer, hiddenClass);\n\t\tthis.clearFiles({ removeFromServer: false });\n\t}\n\n\t#createUploadButtons(): Array<HTMLElement>\n\t{\n\t\tconst buttons = {\n\t\t\timg: {\n\t\t\t\ttitle: Loc.getMessage('SIGN_BLANK_SELECTOR_CREATE_NEW_PIC'),\n\t\t\t\tdescription: 'jpeg, png',\n\t\t\t},\n\t\t\tpdf: {\n\t\t\t\ttitle: Loc.getMessage('SIGN_BLANK_SELECTOR_NEW_PDF'),\n\t\t\t\tdescription: 'Adobe Acrobat',\n\t\t\t},\n\t\t\tdoc: {\n\t\t\t\ttitle: Loc.getMessage('SIGN_BLANK_SELECTOR_NEW_DOC'),\n\t\t\t\tdescription: 'doc, docx',\n\t\t\t},\n\t\t};\n\t\tconst entries = Object.entries(buttons);\n\n\t\treturn entries.map(([key, { title, description }]) => {\n\t\t\tconst listItem: ListItem<ListItemProps> = new ListItem({\n\t\t\t\ttitle,\n\t\t\t\tdescription,\n\t\t\t\tmodifier: key,\n\t\t\t});\n\n\t\t\treturn listItem.getLayout();\n\t\t});\n\t}\n\n\tasync #resumeUploading()\n\t{\n\t\tconst uploader = this.#tileWidget.getUploader();\n\t\tconst pendingFiles = uploader.getFiles();\n\t\tuploader.setMaxParallelUploads(pendingFiles.length);\n\t\tconst uploadPromise = new Promise((resolve) => {\n\t\t\tuploader.subscribeOnce('onUploadComplete', resolve);\n\t\t});\n\t\tuploader.start();\n\t\tawait uploadPromise;\n\t}\n\n\tasync createBlankFromOuterUploaderFiles(files: Array<UploaderFile>): Promise<number>\n\t{\n\t\tif (files.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst firstFile = files.at(0);\n\t\tconst blank = new Blank({ title: firstFile.getName() });\n\t\tblank.setReady(false);\n\t\tDom.prepend(blank.getLayout(), this.#blanksContainer);\n\t\ttry\n\t\t{\n\t\t\tconst filesIds = files.map((file) => file.getServerFileId());\n\t\t\tconst blankData = await this.#api.createBlank(\n\t\t\t\tfilesIds,\n\t\t\t\tthis.#config.type ?? null,\n\t\t\t\tisTemplateMode(this.#config.documentMode),\n\t\t\t);\n\t\t\tthis.#setupBlank({\n\t\t\t\t...blankData,\n\t\t\t\tuserName: Loc.getMessage('SIGN_BLANK_SELECTOR_CREATED_MYSELF'),\n\t\t\t}, blank);\n\n\t\t\treturn blankData.id;\n\t\t}\n\t\tcatch (ex)\n\t\t{\n\t\t\tblank?.remove?.();\n\t\t\tconsole.log(ex);\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\tasync createBlank(): ?Promise<number>\n\t{\n\t\tconst uploader = this.#tileWidget.getUploader();\n\t\tconst files = uploader.getFiles();\n\t\tif (files.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst [firstFile] = files;\n\t\tawait this.#resumeUploading();\n\t\tconst blank = firstFile.getCustomData(firstFile.getId());\n\t\ttry\n\t\t{\n\t\t\tconst filesIds = files.map((file) => file.getServerFileId());\n\t\t\tconst blankData = await this.#api.createBlank(filesIds, this.#config.type ?? null, isTemplateMode(this.#config.documentMode));\n\t\t\tthis.#setupBlank({\n\t\t\t\t...blankData,\n\t\t\t\tuserName: Loc.getMessage('SIGN_BLANK_SELECTOR_CREATED_MYSELF'),\n\t\t\t}, blank);\n\n\t\t\treturn blankData.id;\n\t\t}\n\t\tcatch (ex)\n\t\t{\n\t\t\tblank.remove();\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\tasync #loadBlanks(page: number)\n\t{\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.#blanksContainer,\n\t\t\tsize: 80,\n\t\t\tmode: 'custom',\n\t\t});\n\t\tloader.show();\n\t\ttry\n\t\t{\n\t\t\tconst blanksOnPage = 3;\n\t\t\tconst data = await this.#api.loadBlanks(page, this.#config.type ?? null, blanksOnPage);\n\t\t\tif (data.length < blanksOnPage)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#loadMoreButton, '--hidden');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.#loadMoreButton, '--hidden');\n\t\t\t}\n\n\t\t\tif (data.length > 0)\n\t\t\t{\n\t\t\t\tdata.forEach((blankData: BlankData) => {\n\t\t\t\t\tif (this.hasBlank(blankData.id))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst { title } = blankData;\n\t\t\t\t\tconst blank: Blank<BlankProps> = new Blank({ title });\n\t\t\t\t\tthis.#addBlank(blankData, blank);\n\t\t\t\t});\n\t\t\t\tthis.#page = page;\n\t\t\t}\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tDom.removeClass(this.#loadMoreButton, '--hidden');\n\t\t}\n\n\t\tloader.destroy();\n\t}\n\n\t#setupBlank(blankData: BlankData, blank: Blank): void\n\t{\n\t\tconst {\n\t\t\tid: blankId,\n\t\t\tpreviewUrl,\n\t\t\tuserAvatarUrl,\n\t\t\tuserName,\n\t\t\tdateCreate,\n\t\t} = blankData;\n\t\tconst creationDate = dateCreate ? new Date(dateCreate) : new Date();\n\t\tconst descriptionText = `${userName}, ${DateTimeFormat.format('j M. Y', creationDate)}`;\n\t\tblank.setId(blankId);\n\t\tblank.setReady(true);\n\t\tblank.setPreview(previewUrl);\n\t\tblank.setAvatarWithDescription(descriptionText, userAvatarUrl);\n\t\tthis.#blanks.set(blankId, blank);\n\t}\n\n\t#normalizeTitle(title: string): string\n\t{\n\t\tconst acceptedType = uploaderOptions.acceptedFileTypes.find((fileType) => {\n\t\t\treturn title.endsWith(fileType);\n\t\t});\n\t\tif (!acceptedType)\n\t\t{\n\t\t\treturn title;\n\t\t}\n\n\t\tconst dotExtensionIndex = title.lastIndexOf(acceptedType);\n\n\t\treturn title.slice(0, dotExtensionIndex);\n\t}\n\n\t#addBlank(blankData: BlankData, blank: Blank): void\n\t{\n\t\tthis.#setupBlank(blankData, blank);\n\t\tDom.append(blank.getLayout(), this.#blanksContainer);\n\t}\n\n\tresetSelectedBlank()\n\t{\n\t\tconst blank = this.#blanks.get(this.selectedBlankId);\n\t\tblank?.deselect();\n\t\tthis.selectedBlankId = 0;\n\t\tif (blank)\n\t\t{\n\t\t\tthis.emit('toggleSelection', { selected: false });\n\t\t}\n\t\tthis.#enableSaveButtonIntoSlider();\n\t}\n\n\tasync modifyBlankTitle(blankId: number, blankTitle: string): void\n\t{\n\t\tlet blank = this.#blanks.get(blankId);\n\t\tif (!blank)\n\t\t{\n\t\t\tawait this.loadBlankById(blankId);\n\t\t\tblank = this.#blanks.get(blankId);\n\t\t}\n\t\tblank.setTitle(blankTitle);\n\t}\n\n\thasBlank(blankId: number): boolean\n\t{\n\t\treturn this.#blanks.has(blankId);\n\t}\n\n\tgetBlank(blankId: number): Blank\n\t{\n\t\treturn this.#blanks.get(blankId);\n\t}\n\n\tasync loadBlankById(blankId: number): Promise<void>\n\t{\n\t\tconst blankData = await this.#api.getBlankById(blankId);\n\t\tif (!this.hasBlank(blankId))\n\t\t{\n\t\t\tconst blank: Blank<BlankProps> = new Blank({ title: blankData.title });\n\t\t\tthis.#addBlank(blankData, blank);\n\t\t}\n\t}\n\n\tasync selectBlank(blankId: number)\n\t{\n\t\tif (blankId !== this.selectedBlankId)\n\t\t{\n\t\t\tthis.resetSelectedBlank();\n\t\t}\n\n\t\tthis.selectedBlankId = blankId;\n\t\tthis.#toggleTileVisibility(false);\n\t\tlet blank = this.#blanks.get(blankId);\n\n\t\tif (!blank)\n\t\t{\n\t\t\tawait this.loadBlankById(blankId);\n\t\t\tblank = this.#blanks.get(blankId);\n\t\t}\n\t\tconst { title } = blank.getProps();\n\t\tblank.select();\n\t\tthis.emit('toggleSelection', { id: blankId, selected: true, title: this.#normalizeTitle(title) });\n\t}\n\n\tdeleteBlank(blankId: number)\n\t{\n\t\tconst lastBlank = this.#blanks.get(blankId);\n\t\tif (lastBlank)\n\t\t{\n\t\t\tthis.#blanks.delete(blankId);\n\t\t\tlastBlank.remove();\n\t\t}\n\t}\n\n\tclearFiles(options: RemoveOptions)\n\t{\n\t\tconst uploader = this.#tileWidget.getUploader();\n\t\tuploader.removeFiles(options);\n\t}\n\n\tisFilesReadyForUpload(): boolean\n\t{\n\t\tif (this.#tileWidget.getUploader().getFiles().length === 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.#tileWidget.getUploader().getFiles()\n\t\t\t.every((file: UploaderFile) => file.getErrors().length <= 0)\n\t\t;\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\tthis.#tileWidget.renderTo(this.#tileWidgetContainer);\n\t\tthis.#toggleTileVisibility(false);\n\t\tconst canUploadNewBlank = this.#config.canUploadNewBlank ?? true;\n\t\tconst selectorContainer = Tag.render`\n\t\t\t<div class=\"sign-blank-selector\">\n\t\t\t\t${this.#tileWidgetContainer}\n\t\t\t\t${canUploadNewBlank ? this.#uploadButtonsContainer : ''}\n\t\t\t\t<p class=\"sign-blank-selector__templates_title\">\n\t\t\t\t\t${Loc.getMessage('SIGN_BLANK_SELECTOR_RECENT_TEMPLATES_TITLE')}\n\t\t\t\t</p>\n\t\t\t\t${this.#blanksContainer}\n\t\t\t\t${this.#loadMoreButton}\n\t\t\t</div>\n\t\t`;\n\t\tif (this.#page === 0)\n\t\t{\n\t\t\tthis.#loadBlanks(1);\n\t\t}\n\n\t\treturn selectorContainer;\n\t}\n\n\topenInSlider()\n\t{\n\t\tconst SidePanel: BX.SidePanel = Reflection.getClass('BX.SidePanel');\n\t\tif (!Type.isNil(SidePanel))\n\t\t{\n\t\t\tSidePanel.Instance.open('v2-blank-selector', {\n\t\t\t\twidth: 628,\n\t\t\t\tcacheable: false,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.emit('onSliderClose');\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\textensions: ['sign.v2.blank-selector'],\n\t\t\t\t\t\ttitle: Loc.getMessage('SIGN_BLANK_SELECTOR_SLIDER_TITLE'),\n\t\t\t\t\t\tcontent: () => this.getLayout(),\n\t\t\t\t\t\tbuttons: ({ cancelButton, SaveButton }) => {\n\t\t\t\t\t\t\tthis.#setSaveButtonIntoSlider(\n\t\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('SIGN_BLANK_SELECTOR_SLIDER_SELECT_BLANK_BUTTON_LABEL'),\n\t\t\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\t\t\tSidePanel.Instance.close();\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tthis.#disableSaveButtonIntoSlider();\n\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tthis.#getSaveButtonIntoSlider(),\n\t\t\t\t\t\t\t\tcancelButton,\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\n\t#setSaveButtonIntoSlider(button)\n\t{\n\t\tthis.#cache.set('saveButton', button);\n\t}\n\n\t#disableSaveButtonIntoSlider()\n\t{\n\t\tconst saveButton = this.#getSaveButtonIntoSlider();\n\t\tsaveButton?.setDisabled(true);\n\t}\n\n\t#enableSaveButtonIntoSlider()\n\t{\n\t\tconst saveButton = this.#getSaveButtonIntoSlider();\n\t\tsaveButton?.setDisabled(false);\n\t}\n\n\t#getSaveButtonIntoSlider(): any\n\t{\n\t\treturn this.#cache.get('saveButton');\n\t}\n\n\tdisableSelectedBlank(blankId: number): void\n\t{\n\t\tconst blank = this.#blanks.get(blankId);\n\n\t\tif (blank)\n\t\t{\n\t\t\tDom.addClass(blank.getLayout(), '--disabled');\n\t\t}\n\t}\n\n\tenableSelectedBlank(blankId: number): void\n\t{\n\t\tconst blank = this.#blanks.get(blankId);\n\n\t\tif (blank)\n\t\t{\n\t\t\tDom.removeClass(blank.getLayout(), '--disabled');\n\t\t}\n\t}\n}\n"],"names":["ListItem","constructor","props","Tag","render","setProps","getLayout","setTitle","title","textContent","getProps","setDescription","description","modifier","Dom","create","attrs","className","children","Blank","hidden","Loader","size","target","layout","prepend","setAvatarWithDescription","userAvatarUrl","avatarIcon","lastElementChild","descriptionNode","select","addClass","deselect","removeClass","blur","remove","setId","id","dataset","setReady","isReady","show","tabIndex","hide","setPreview","previewUrl","firstElementChild","src","BlankField","EventEmitter","options","Cache","MemoryCache","setEventNamespace","subscribeFromOptions","events","blankId","data","Type","isStringFilled","isNumber","getBlankById","then","addTag","entityId","remember","renderTo","targetContainer","isDomNode","append","set","get","Api","BlankSelector","selectorOptions","toggleSelection","event","selected","getData","tagSelector","showAddButton","emit","getTags","length","onSliderClose","TagSelector","Text","getRandom","multiple","showTextBox","addButtonCaption","Loc","getMessage","tagMaxWidth","onAddButtonClick","openInSlider","hideTextBox","onAfterTagRemove","delete","uploaderOptions","controller","acceptedFileTypes","autoUpload","maxFileSize","maxFileCount","imageMaxFileSize","maxTotalFileSize","errorPopupOptions","padding","offsetLeft","offsetTop","angle","darkMode","width","autoHide","cacheable","bindOptions","position","config","selectedBlankId","Map","uploadButtons","dragArea","widgetOptions","slots","afterDropArea","computed","methods","clear","clearFiles","removeFromServer","template","TileWidget","dropElement","browseElement","UploaderEvent","BEFORE_FILES_ADD","FILE_ADD","FILE_REMOVE","UPLOAD_START","Event","bind","document","selectBlank","Number","ctrlKey","metaKey","resetSelectedBlank","createBlankFromOuterUploaderFiles","files","firstFile","at","blank","getName","filesIds","map","file","getServerFileId","blankData","createBlank","type","isTemplateMode","documentMode","userName","ex","console","log","uploader","getUploader","getFiles","getCustomData","getId","modifyBlankTitle","blankTitle","loadBlankById","hasBlank","has","getBlank","deleteBlank","lastBlank","removeFiles","isFilesReadyForUpload","every","getErrors","canUploadNewBlank","selectorContainer","SidePanel","Reflection","getClass","isNil","Instance","open","onClose","contentCallback","Layout","createContent","extensions","content","buttons","cancelButton","SaveButton","text","onclick","close","disableSelectedBlank","enableSelectedBlank","addedFiles","isImage","getType","includes","allAddedImages","validExtension","getExtension","filesLength","imagesLimit","allExistImages","valid","bindElement","hasClass","$refs","container","getRootComponent","errorPopup","Popup","preventDefault","isInteger","parseInt","fileId","uploadingBlank","setCustomData","shouldShow","hiddenClass","img","pdf","doc","entries","Object","key","listItem","pendingFiles","setMaxParallelUploads","uploadPromise","Promise","resolve","subscribeOnce","start","page","loader","mode","blanksOnPage","loadBlanks","forEach","destroy","dateCreate","creationDate","Date","descriptionText","DateTimeFormat","format","acceptedType","find","fileType","endsWith","dotExtensionIndex","lastIndexOf","slice","button","saveButton","setDisabled"],"mappings":"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"}