this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};(function(t,e,s,i,n,a){"use strict";var o=babelHelpers.classPrivateFieldLooseKey("requisites");class r extends s.SignSettings{constructor(t,e){super(t,e);Object.defineProperty(this,o,{writable:true,value:void 0});const{config:s,chatId:r=0}=e;const{blankSelectorConfig:u,documentSendConfig:c}=s;u.chatId=r;this.documentSetup=new i.DocumentSetup(u);this.documentSend=new n.DocumentSend(c);babelHelpers.classPrivateFieldLooseBase(this,o)[o]=new a.Requisites;this.subscribeOnEvents()}async applyDocumentData(t){const e=Boolean(await this.setupDocument(t));if(!e){return false}const{setupData:s}=this.documentSetup;babelHelpers.classPrivateFieldLooseBase(this,o)[o].documentData=s;this.documentSend.documentData=s;this.editor.documentData=s;return true}getStepsMetadata(t){return{setup:{get content(){return t.documentSetup.layout},title:e.Loc.getMessage("SIGN_SETTINGS_B2B_LOAD_DOCUMENT"),beforeCompletion:async()=>{const t=await this.setupDocument();if(!t){return false}const{uid:e,entityId:s,initiator:i}=t;babelHelpers.classPrivateFieldLooseBase(this,o)[o].documentData={uid:e,entityId:s,initiator:i};return true}},requisites:{get content(){return babelHelpers.classPrivateFieldLooseBase(t,o)[o].getLayout()},title:e.Loc.getMessage("SIGN_SETTINGS_B2B_PREPARING_DOCUMENT"),beforeCompletion:async()=>{const{uid:t,isTemplate:e,title:s,initiator:i}=this.documentSetup.setupData;const n=babelHelpers.classPrivateFieldLooseBase(this,o)[o].checkInitiator(i);if(!n){return false}const a=await babelHelpers.classPrivateFieldLooseBase(this,o)[o].processMembers();if(!a){return false}const r=await this.documentSetup.loadBlocks(t);this.editor.documentData={isTemplate:e,uid:t,blocks:r};this.editor.entityData=a;this.documentSend.documentData={uid:t,title:s,blocks:r,initiator:i};this.documentSend.entityData=a;await this.editor.waitForPagesUrls();await this.editor.renderDocument();this.wizard.toggleBtnLoadingState("next",false);await this.editor.show();return true}},send:{get content(){return t.documentSend.getLayout()},title:e.Loc.getMessage("SIGN_SETTINGS_SEND_DOCUMENT"),beforeCompletion:()=>this.documentSend.sendForSign()}}}subscribeOnEvents(){super.subscribeOnEvents();babelHelpers.classPrivateFieldLooseBase(this,o)[o].subscribe("changeInitiator",(({data:t})=>{this.documentSetup.setupData={...this.documentSetup.setupData,initiator:t.initiator}}))}}t.B2BSignSettings=r})(this.BX.Sign.V2.B2b=this.BX.Sign.V2.B2b||{},BX,BX.Sign.V2,BX.Sign.V2,BX.Sign.V2,BX.Sign.V2);
//# sourceMappingURL=sign-settings.bundle.map.js