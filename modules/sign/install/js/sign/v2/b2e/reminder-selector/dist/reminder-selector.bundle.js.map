{"version":3,"file":"reminder-selector.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Loc, Tag, Type } from 'main.core';\nimport { Button } from 'ui.buttons';\nimport { Api } from 'sign.v2.api';\n\nimport './style.css';\nimport type { MenuItemOptions } from 'main.popup';\n\nexport const ReminderType: $ReadOnly<{ [key: ReminderTypeId]: ReminderTypeId }> = Object.freeze({\n\tnone: 'none',\n\toncePerDay: 'oncePerDay',\n\ttwicePerDay: 'twicePerDay',\n\tthreeTimesPerDay: 'threeTimesPerDay',\n});\n\nexport type ReminderTypeId = 'none' | 'oncePerDay' | 'twicePerDay' | 'threeTimesPerDay';\nexport type Options = { preSelectedType?: ReminderTypeId };\n\nexport class ReminderSelector\n{\n\t#api: Api;\n\t#button: Button;\n\t#options: Options;\n\t#chosenTypeId: ReminderTypeId = ReminderType.none;\n\n\tconstructor(options: Options = {})\n\t{\n\t\tthis.#options = options;\n\t\tthis.#button = this.#getButton();\n\t\tthis.#api = new Api();\n\t\tif (!Type.isUndefined(this.#options.preSelectedType))\n\t\t{\n\t\t\tthis.#chooseTypeById(this.#options.preSelectedType);\n\t\t}\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t\t<div class=\"sign-reminder-selector\">\n\t\t\t\t<span class=\"sign-reminder-selector__label\">\n\t\t\t\t\t${Loc.getMessage('SIGN_V2_REMINDER_SELECTOR_TITLE')}\n\t\t\t\t</span>\n\t\t\t\t${this.#button.getContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tsave(documentUid: string, memberRole: string): Promise<void>\n\t{\n\t\treturn this.#api.modifyReminderTypeForMemberRole(documentUid, memberRole, this.#chosenTypeId);\n\t}\n\n\t#getItems(): Array<{ text: string; onclick: Function }>\n\t{\n\t\treturn this.#getAvailableOptions().map((reminderType): MenuItemOptions => {\n\t\t\treturn {\n\t\t\t\ttext: reminderType.name,\n\t\t\t\tonclick: () => this.#chooseTypeById(reminderType.id),\n\t\t\t};\n\t\t});\n\t}\n\n\t#getButton(): Button\n\t{\n\t\treturn new Button({\n\t\t\ttext: this.#getOptionById(ReminderType.none).name,\n\t\t\tdropdown: true,\n\t\t\tcloseByEsc: true,\n\t\t\tautoHide: true,\n\t\t\tautoClose: true,\n\t\t\tcolor: BX.UI.Button.Color.LIGHT,\n\t\t\tsize: BX.UI.Button.Size.SMALL,\n\t\t\tmenu: {\n\t\t\t\titems: this.#getItems(),\n\t\t\t},\n\t\t\tclassName: 'sign-reminder-selector__button',\n\t\t});\n\t}\n\n\t#chooseTypeById(reminderTypeId: ReminderTypeId): void\n\t{\n\t\tthis.#button.menuWindow.close();\n\n\t\tconst option = this.#getOptionById(reminderTypeId);\n\t\tif (!option)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#button.setText(option.name);\n\t\tthis.#chosenTypeId = option.id;\n\t}\n\n\t#getOptionById(reminderTypeId: ReminderTypeId): { id: string, name: string } | null\n\t{\n\t\treturn this.#getAvailableOptions()\n\t\t\t.find((option) => option.id === reminderTypeId) ?? null\n\t\t;\n\t}\n\n\t#getAvailableOptions(): Array<{ id: ReminderTypeId, name: string }>\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: ReminderType.none,\n\t\t\t\tname: Loc.getMessage('SIGN_V2_REMINDER_SELECTOR_OPTION_NONE'),\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: ReminderType.oncePerDay,\n\t\t\t\tname: Loc.getMessage('SIGN_V2_REMINDER_SELECTOR_OPTION_ONCE_PER_DAY'),\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: ReminderType.twicePerDay,\n\t\t\t\tname: Loc.getMessage('SIGN_V2_REMINDER_SELECTOR_OPTION_TWICE_PER_DAY'),\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: ReminderType.threeTimesPerDay,\n\t\t\t\tname: Loc.getMessage('SIGN_V2_REMINDER_SELECTOR_OPTION_THREE_TIMES_PER_DAY'),\n\t\t\t},\n\t\t];\n\t}\n}\n"],"names":["ReminderType","Object","freeze","none","oncePerDay","twicePerDay","threeTimesPerDay","ReminderSelector","constructor","options","Api","Type","isUndefined","preSelectedType","getLayout","Tag","render","Loc","getMessage","getContainer","save","documentUid","memberRole","modifyReminderTypeForMemberRole","map","reminderType","text","name","onclick","id","Button","dropdown","closeByEsc","autoHide","autoClose","color","BX","UI","Color","LIGHT","size","Size","SMALL","menu","items","className","reminderTypeId","menuWindow","close","option","setText","find"],"mappings":"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"}