{"version":3,"file":"blank-importer.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Loc } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Api } from 'sign.v2.api';\nimport { Uploader, UploaderFile } from 'ui.uploader.core';\n\nexport class BlankImporter extends EventEmitter\n{\n\t#uploader: Uploader;\n\t#api: Api;\n\n\tconstructor(target: HTMLElement)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Sign.V2.B2e.BlankImporter');\n\t\tthis.#api = new Api();\n\t\tthis.#uploader = new Uploader({\n\t\t\tbrowseElement: target,\n\t\t\tautoUpload: false,\n\t\t\tmultiple: false,\n\t\t\tacceptedFileTypes: '.json',\n\t\t});\n\n\t\tthis.#subscribeOnEvents();\n\t}\n\n\t#subscribeOnEvents(): void\n\t{\n\t\tthis.#uploader.subscribe('File:onAdd', (e: BaseEvent) => {\n\t\t\tconst uploaderFile: UploaderFile = e.getData().file;\n\t\t\tconst reader: FileReader = new FileReader();\n\t\t\treader.onload = (event: ProgressEvent): void => this.#importBlank(event.target.result);\n\t\t\treader.readAsText(uploaderFile.getBinary());\n\t\t});\n\t}\n\n\tasync #importBlank(serializedJson: string): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tawait this.#api.template.importBlank(serializedJson);\n\n\t\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('SIGN_BLANK_IMPORTER_SUCCESS'),\n\t\t\t});\n\n\t\t\tthis.emit('onSuccessImport');\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\t\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('SIGN_BLANK_IMPORTER_FAILURE'),\n\t\t\t});\n\t\t}\n\t}\n}"],"names":["BlankImporter","EventEmitter","constructor","target","setEventNamespace","Api","Uploader","browseElement","autoUpload","multiple","acceptedFileTypes","subscribe","e","uploaderFile","getData","file","reader","FileReader","onload","event","result","readAsText","getBinary","serializedJson","template","importBlank","window","top","BX","UI","Notification","Center","notify","content","Loc","getMessage","emit","console","error"],"mappings":";;;;;;;CAG0D;CAAA;CAAA;CAAA;AAE1D,CAAO,MAAMA,aAAa,SAASC,6BAAY,CAC/C;GAICC,WAAW,CAACC,MAAmB,EAC/B;KACC,KAAK,EAAE;KAAC;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KACR,IAAI,CAACC,iBAAiB,CAAC,8BAA8B,CAAC;KACtD,4CAAI,gBAAQ,IAAIC,eAAG,EAAE;KACrB,4CAAI,0BAAa,IAAIC,yBAAQ,CAAC;OAC7BC,aAAa,EAAEJ,MAAM;OACrBK,UAAU,EAAE,KAAK;OACjBC,QAAQ,EAAE,KAAK;OACfC,iBAAiB,EAAE;MACnB,CAAC;KAEF,4CAAI;;CAiCN;CAAC,+BA7BA;GACC,4CAAI,wBAAWC,SAAS,CAAC,YAAY,EAAGC,CAAY,IAAK;KACxD,MAAMC,YAA0B,GAAGD,CAAC,CAACE,OAAO,EAAE,CAACC,IAAI;KACnD,MAAMC,MAAkB,GAAG,IAAIC,UAAU,EAAE;KAC3CD,MAAM,CAACE,MAAM,GAAIC,KAAoB,4CAAW,IAAI,8BAAcA,KAAK,CAAChB,MAAM,CAACiB,MAAM,CAAC;KACtFJ,MAAM,CAACK,UAAU,CAACR,YAAY,CAACS,SAAS,EAAE,CAAC;IAC3C,CAAC;CACH;CAAC,6BAEkBC,cAAsB,EACzC;GACC,IACA;KACC,MAAM,4CAAI,cAAMC,QAAQ,CAACC,WAAW,CAACF,cAAc,CAAC;KAEpDG,MAAM,CAACC,GAAG,CAACC,EAAE,CAACC,EAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;OAC3CC,OAAO,EAAEC,aAAG,CAACC,UAAU,CAAC,6BAA6B;MACrD,CAAC;KAEF,IAAI,CAACC,IAAI,CAAC,iBAAiB,CAAC;IAC5B,CACD,OAAOxB,CAAC,EACR;KACCyB,OAAO,CAACC,KAAK,CAAC1B,CAAC,CAAC;KAChBc,MAAM,CAACC,GAAG,CAACC,EAAE,CAACC,EAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;OAC3CC,OAAO,EAAEC,aAAG,CAACC,UAAU,CAAC,6BAA6B;MACrD,CAAC;;CAEJ;;;;;;;;"}