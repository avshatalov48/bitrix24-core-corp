this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};(function(e,s,t,a,i,l,r,o){"use strict";let n=e=>e,c,d;var b=babelHelpers.classPrivateFieldLooseKey("documentDateField");var p=babelHelpers.classPrivateFieldLooseKey("selectedDate");var u=babelHelpers.classPrivateFieldLooseKey("formatDate");var v=babelHelpers.classPrivateFieldLooseKey("getDateField");var h=babelHelpers.classPrivateFieldLooseKey("selectDate");class P{constructor(){Object.defineProperty(this,h,{value:m});Object.defineProperty(this,v,{value:T});Object.defineProperty(this,u,{value:L});Object.defineProperty(this,b,{writable:true,value:void 0});Object.defineProperty(this,p,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,b)[b]=babelHelpers.classPrivateFieldLooseBase(this,v)[v]();const e=new Date;babelHelpers.classPrivateFieldLooseBase(this,h)[h](e);this.setDateInCalendar(e)}setDateInCalendar(e){const s=babelHelpers.classPrivateFieldLooseBase(this,u)[u](e,"DAY_MONTH_FORMAT");const t=babelHelpers.classPrivateFieldLooseBase(this,b)[b].firstElementChild;t.textContent=s;t.title=s}getLayout(){return r.Tag.render(c||(c=n`
			<div class="sign-b2e-document-setup__date-selector">
				<span class="sign-b2e-document-setup__date-selector_label">
					${0}
				</span>
				${0}
			</div>
		`),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_DATE_LABEL"),babelHelpers.classPrivateFieldLooseBase(this,b)[b])}getSelectedDate(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p]}}function L(e,s){const t=o.DateTimeFormat.getFormat(s);return o.DateTimeFormat.format(t,e)}function T(){return r.Tag.render(d||(d=n`
			<div
				class="sign-b2e-document-setup__date-selector_field"
				onclick="${0}"
			>
				<span class="sign-b2e-document-setup__date-selector_field-text"></span>
			</div>
		`),(()=>{BX.calendar({node:babelHelpers.classPrivateFieldLooseBase(this,b)[b],field:babelHelpers.classPrivateFieldLooseBase(this,b)[b],bTime:false,callback_after:e=>{babelHelpers.classPrivateFieldLooseBase(this,h)[h](e);this.setDateInCalendar(e)}})}))}function m(e){const s=babelHelpers.classPrivateFieldLooseBase(this,u)[u](e,"SHORT_DATE_FORMAT");babelHelpers.classPrivateFieldLooseBase(this,p)[p]=s}let H=e=>e,y,F,g,_,B,f,D,E,S;const M=Object.freeze({HowToWorkWithTemplates:"23174934"});var O=babelHelpers.classPrivateFieldLooseKey("api");var I=babelHelpers.classPrivateFieldLooseKey("region");var N=babelHelpers.classPrivateFieldLooseKey("regionDocumentTypes");var U=babelHelpers.classPrivateFieldLooseKey("senderDocumentTypes");var j=babelHelpers.classPrivateFieldLooseKey("documentTypeDropdown");var K=babelHelpers.classPrivateFieldLooseKey("documentSenderTypeDropdown");var w=babelHelpers.classPrivateFieldLooseKey("documentNumberInput");var C=babelHelpers.classPrivateFieldLooseKey("documentTitleInput");var A=babelHelpers.classPrivateFieldLooseKey("dateSelector");var $=babelHelpers.classPrivateFieldLooseKey("documentMode");var x=babelHelpers.classPrivateFieldLooseKey("init");var k=babelHelpers.classPrivateFieldLooseKey("isDocumentTypeVisible");var G=babelHelpers.classPrivateFieldLooseKey("isRuRegion");var X=babelHelpers.classPrivateFieldLooseKey("initDocumentType");var R=babelHelpers.classPrivateFieldLooseKey("getDocumentTypeLayout");var V=babelHelpers.classPrivateFieldLooseKey("initDocumentSenderType");var Y=babelHelpers.classPrivateFieldLooseKey("getDocumentSenderTypeLayout");var W=babelHelpers.classPrivateFieldLooseKey("getHelpLink");var z=babelHelpers.classPrivateFieldLooseKey("getDocumentNumberLayout");var q=babelHelpers.classPrivateFieldLooseKey("getDocumentTitleLayout");var J=babelHelpers.classPrivateFieldLooseKey("getDocumentHintLayout");var Q=babelHelpers.classPrivateFieldLooseKey("getDocumentTitleFullClass");var Z=babelHelpers.classPrivateFieldLooseKey("sendDocumentType");var ee=babelHelpers.classPrivateFieldLooseKey("sendDocumentSenderType");var se=babelHelpers.classPrivateFieldLooseKey("sendDocumentNumber");var te=babelHelpers.classPrivateFieldLooseKey("sendDocumentDate");var ae=babelHelpers.classPrivateFieldLooseKey("setDocumentNumber");var ie=babelHelpers.classPrivateFieldLooseKey("validateInput");class le extends a.DocumentSetup{constructor(e){super(e);Object.defineProperty(this,ie,{value:ge});Object.defineProperty(this,ae,{value:Fe});Object.defineProperty(this,te,{value:ye});Object.defineProperty(this,se,{value:He});Object.defineProperty(this,ee,{value:me});Object.defineProperty(this,Z,{value:Te});Object.defineProperty(this,Q,{value:Le});Object.defineProperty(this,J,{value:Pe});Object.defineProperty(this,q,{value:he});Object.defineProperty(this,z,{value:ve});Object.defineProperty(this,W,{value:ue});Object.defineProperty(this,Y,{value:pe});Object.defineProperty(this,V,{value:be});Object.defineProperty(this,R,{value:de});Object.defineProperty(this,X,{value:ce});Object.defineProperty(this,G,{value:ne});Object.defineProperty(this,k,{value:oe});Object.defineProperty(this,x,{value:re});Object.defineProperty(this,O,{writable:true,value:void 0});Object.defineProperty(this,I,{writable:true,value:void 0});Object.defineProperty(this,N,{writable:true,value:void 0});Object.defineProperty(this,U,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:void 0});Object.defineProperty(this,K,{writable:true,value:void 0});Object.defineProperty(this,w,{writable:true,value:null});Object.defineProperty(this,C,{writable:true,value:void 0});Object.defineProperty(this,A,{writable:true,value:null});Object.defineProperty(this,$,{writable:true,value:void 0});const{region:t,regionDocumentTypes:i,documentMode:o}=e;babelHelpers.classPrivateFieldLooseBase(this,O)[O]=new s.Api;babelHelpers.classPrivateFieldLooseBase(this,I)[I]=t;babelHelpers.classPrivateFieldLooseBase(this,$)[$]=o;babelHelpers.classPrivateFieldLooseBase(this,N)[N]=i;babelHelpers.classPrivateFieldLooseBase(this,U)[U]=Object.values(a.DocumentInitiated);babelHelpers.classPrivateFieldLooseBase(this,C)[C]=r.Tag.render(y||(y=H`
			<input
				type="text"
				class="ui-ctl-element"
				maxlength="255"
				oninput="${0}"
			/>
		`),(({target:e})=>this.setDocumentTitle(e.value)));if(babelHelpers.classPrivateFieldLooseBase(this,G)[G]()&&!l.isTemplateMode(o)){babelHelpers.classPrivateFieldLooseBase(this,w)[w]=r.Tag.render(F||(F=H`<input type="text" class="ui-ctl-element" maxlength="255" />`));babelHelpers.classPrivateFieldLooseBase(this,A)[A]=new P}this.blankSelector.subscribe("toggleSelection",(({data:e})=>{this.setDocumentTitle(e.title)}));this.blankSelector.subscribe("addFile",(({data:e})=>{this.setDocumentTitle(e.title)}));babelHelpers.classPrivateFieldLooseBase(this,x)[x]()}setDocumentTitle(e=""){babelHelpers.classPrivateFieldLooseBase(this,C)[C].value=e;babelHelpers.classPrivateFieldLooseBase(this,C)[C].title=e}setDocumentType(e=""){if(!babelHelpers.classPrivateFieldLooseBase(this,k)[k]()){return}const s=babelHelpers.classPrivateFieldLooseBase(this,N)[N].some((s=>s.code===e));const t=s?e:babelHelpers.classPrivateFieldLooseBase(this,N)[N][0].code;babelHelpers.classPrivateFieldLooseBase(this,j)[j].selectItem(t)}setDocumentSenderType(e){if(!this.isTemplateMode()||!this.isSenderTypeAvailable()){return}const s=babelHelpers.classPrivateFieldLooseBase(this,U)[U].includes(e)?e:"employee";babelHelpers.classPrivateFieldLooseBase(this,K)[K].selectItem(s)}initLayout(){const e=this.isTemplateMode()?r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TEMPLATE_HEADER"):r.Loc.getMessage("SIGN_DOCUMENT_SETUP_HEADER");const s=this.isTemplateMode()?r.Loc.getMessage("SIGN_DOCUMENT_SETUP_ADD_TEMPLATE_TITLE"):r.Loc.getMessage("SIGN_DOCUMENT_SETUP_ADD_TITLE");this.layout=r.Tag.render(g||(g=H`
			<div class="sign-document-setup">
				<h1 class="sign-b2e-settings__header">${0}</h1>
				<div class="sign-b2e-settings__item">
					<p class="sign-b2e-settings__item_title">
						${0}
					</p>
					${0}
				</div>
			</div>
		`),e,s,this.blankSelector.getLayout())}async setup(e){try{var s;await super.setup(e,this.isTemplateMode());if(!this.setupData){return}if(e){const{title:e,externalId:s,externalDateCreate:t,initiatedByType:a,regionDocumentType:i}=this.setupData;this.setDocumentTitle(e);this.setDocumentSenderType(a);this.setDocumentType(i);if(babelHelpers.classPrivateFieldLooseBase(this,G)[G]()&&!this.isTemplateMode()){babelHelpers.classPrivateFieldLooseBase(this,ae)[ae](s);babelHelpers.classPrivateFieldLooseBase(this,A)[A].setDateInCalendar(new Date(t))}return}const{uid:t,templateUid:a}=this.setupData;const{value:i}=babelHelpers.classPrivateFieldLooseBase(this,C)[C];const l=(s=babelHelpers.classPrivateFieldLooseBase(this,w)[w])==null?void 0:s.value;this.ready=false;await Promise.all([babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](t),babelHelpers.classPrivateFieldLooseBase(this,ee)[ee](t),babelHelpers.classPrivateFieldLooseBase(this,se)[se](t),babelHelpers.classPrivateFieldLooseBase(this,te)[te](t)]);const r=await babelHelpers.classPrivateFieldLooseBase(this,O)[O].modifyTitle(t,i);const{blankTitle:o}=r;if(o){const{blankId:e}=this.setupData;this.blankSelector.modifyBlankTitle(e,o)}this.setupData={...this.setupData,title:i,externalId:l,templateUid:a}}catch{const{blankId:e}=this.setupData;this.handleError(e)}this.ready=true}validate(){const e=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie](babelHelpers.classPrivateFieldLooseBase(this,C)[C]);const s=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie](babelHelpers.classPrivateFieldLooseBase(this,w)[w]);return e&&s}isSenderTypeAvailable(){const e=r.Extension.getSettings("sign.v2.b2e.document-setup");return e.get("isSenderTypeAvailable")}}function re(){babelHelpers.classPrivateFieldLooseBase(this,X)[X]();babelHelpers.classPrivateFieldLooseBase(this,V)[V]();const e=babelHelpers.classPrivateFieldLooseBase(this,R)[R]();const s=this.isTemplateMode()?r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_TEMPLATE_HEAD_LABEL"):r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_HEAD_LABEL");const t=r.Tag.render(_||(_=H`
			<div class="sign-b2e-settings__item">
				<p class="sign-b2e-settings__item_title">
					${0}
				</p>
				${0}
			</div>
		`),s,babelHelpers.classPrivateFieldLooseBase(this,q)[q]());r.Dom.append(e,this.layout);r.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Y)[Y](),this.layout);r.Dom.append(t,this.layout);i.Hint.create(this.layout)}function oe(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,N)[N])==null?void 0:e.length}function ne(){return babelHelpers.classPrivateFieldLooseBase(this,I)[I]==="ru"}function ce(){if(!babelHelpers.classPrivateFieldLooseBase(this,k)[k]()){return}babelHelpers.classPrivateFieldLooseBase(this,j)[j]=new t.SignDropdown({tabs:[{id:"b2e-document-codes",title:" "}],entities:[{id:"b2e-document-code",searchFields:[{name:"caption",system:true}]}],className:"sign-b2e-document-setup__type-selector",withCaption:true,isEnableSearch:true});babelHelpers.classPrivateFieldLooseBase(this,N)[N].forEach((e=>{if(r.Type.isPlainObject(e)&&r.Type.isStringFilled(e.code)&&r.Type.isStringFilled(e.description)){const{code:s,description:t}=e;babelHelpers.classPrivateFieldLooseBase(this,j)[j].addItem({id:s,title:s,caption:`(${t})`,entityId:"b2e-document-code",tabs:"b2e-document-codes",deselectable:false})}}));babelHelpers.classPrivateFieldLooseBase(this,j)[j].selectItem(babelHelpers.classPrivateFieldLooseBase(this,N)[N][0].code)}function de(){if(!babelHelpers.classPrivateFieldLooseBase(this,k)[k]()){return null}return r.Tag.render(B||(B=H`
			<div class="sign-b2e-settings__item">
				<p class="sign-b2e-settings__item_title">
					<span>${0}</span>
					<span
						data-hint="${0}"
					></span>
				</p>
				${0}
			</div>
		`),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TYPE"),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TYPE_HINT"),babelHelpers.classPrivateFieldLooseBase(this,j)[j].getLayout())}function be(){if(!this.isTemplateMode()||!this.isSenderTypeAvailable()){return}babelHelpers.classPrivateFieldLooseBase(this,K)[K]=new t.SignDropdown({tabs:[{id:"b2e-document-sender-types",title:" "}],entities:[{id:"b2e-document-sender-type",searchFields:[{name:"caption",system:true}]}],className:"sign-b2e-document-setup__sender-type-selector",withCaption:true,isEnableSearch:false});babelHelpers.classPrivateFieldLooseBase(this,U)[U].forEach((e=>{if(r.Type.isStringFilled(e)){const s=`SIGN_DOCUMENT_SETUP_SENDER_TYPE_${e.toUpperCase()}`;babelHelpers.classPrivateFieldLooseBase(this,K)[K].addItem({id:e,title:r.Loc.getMessage(s),entityId:"b2e-document-sender-type",tabs:"b2e-document-sender-types",deselectable:false})}}));babelHelpers.classPrivateFieldLooseBase(this,K)[K].selectItem(babelHelpers.classPrivateFieldLooseBase(this,U)[U][0])}function pe(){if(!this.isTemplateMode()||!this.isSenderTypeAvailable()){return null}return r.Tag.render(f||(f=H`
			<div class="sign-b2e-settings__item">
				<p class="sign-b2e-settings__item_title">
					<span>${0}</span>
				</p>
				${0}
				${0}
			</div>
		`),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_SENDER_TYPE_TITLE"),babelHelpers.classPrivateFieldLooseBase(this,K)[K].getLayout(),babelHelpers.classPrivateFieldLooseBase(this,W)[W]())}function ue(){return i.Helpdesk.replaceLink(r.Loc.getMessage("SIGN_DOCUMENT_SETUP_SENDER_TYPE_HELP_LINK"),M.HowToWorkWithTemplates,"detail",["ui-link"])}function ve(){if(!babelHelpers.classPrivateFieldLooseBase(this,G)[G]()||this.isTemplateMode()){return null}return r.Tag.render(D||(D=H`
			<div class="sign-b2e-document-setup__title-item --num">
				<p class="sign-b2e-document-setup__title-text">
					<span>${0}</span>
					<span
						data-hint="${0}"
					></span>
				</p>
				<div class="ui-ctl ui-ctl-textbox">
					${0}
				</div>
			</div>
		`),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_NUM_LABEL"),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_NUM_LABEL_HINT"),babelHelpers.classPrivateFieldLooseBase(this,w)[w])}function he(){var e;return r.Tag.render(E||(E=H`
			<div>
				<div class="sign-b2e-document-setup__title-item ${0}">
					<p class="sign-b2e-document-setup__title-text">
						${0}
					</p>
					<div class="ui-ctl ui-ctl-textbox">
						${0}
					</div>
				</div>
				${0}
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Q)[Q](),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_LABEL"),babelHelpers.classPrivateFieldLooseBase(this,C)[C],babelHelpers.classPrivateFieldLooseBase(this,z)[z](),babelHelpers.classPrivateFieldLooseBase(this,J)[J](),(e=babelHelpers.classPrivateFieldLooseBase(this,A)[A])==null?void 0:e.getLayout())}function Pe(){if(this.isTemplateMode()){return null}return r.Tag.render(S||(S=H`
			<p class="sign-b2e-document-setup__title-text">
				${0}
			</p>
		`),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_HINT"))}function Le(){if(this.isTemplateMode()){return"--full"}return babelHelpers.classPrivateFieldLooseBase(this,G)[G]()?"":"--full"}function Te(e){if(!babelHelpers.classPrivateFieldLooseBase(this,k)[k]()){return Promise.resolve()}const s=babelHelpers.classPrivateFieldLooseBase(this,j)[j].getSelectedId();return babelHelpers.classPrivateFieldLooseBase(this,O)[O].changeRegionDocumentType(e,s)}function me(e){if(!this.isTemplateMode()||!this.isSenderTypeAvailable()){return Promise.resolve()}const s=babelHelpers.classPrivateFieldLooseBase(this,K)[K].getSelectedId();this.setupData.initiatedByType=s;return babelHelpers.classPrivateFieldLooseBase(this,O)[O].changeSenderDocumentType(e,s)}function He(e){if(!babelHelpers.classPrivateFieldLooseBase(this,G)[G]()||this.isTemplateMode()){return Promise.resolve()}return babelHelpers.classPrivateFieldLooseBase(this,O)[O].changeExternalId(e,babelHelpers.classPrivateFieldLooseBase(this,w)[w].value)}function ye(e){if(!babelHelpers.classPrivateFieldLooseBase(this,G)[G]()||this.isTemplateMode()){return Promise.resolve()}return babelHelpers.classPrivateFieldLooseBase(this,O)[O].changeExternalDate(e,babelHelpers.classPrivateFieldLooseBase(this,A)[A].getSelectedDate())}function Fe(e){babelHelpers.classPrivateFieldLooseBase(this,w)[w].value=e}function ge(e){if(!e){return true}const{parentNode:s,value:t}=e;if(t.trim()!==""){r.Dom.removeClass(s,"ui-ctl-warning");return true}r.Dom.addClass(s,"ui-ctl-warning");e.focus();return false}e.DocumentSetup=le})(this.BX.Sign.V2.B2e=this.BX.Sign.V2.B2e||{},BX.Sign.V2,BX.Sign.V2.B2e,BX.Sign.V2,BX.Sign.V2,BX.Sign.V2,BX,BX.Main);
//# sourceMappingURL=document-setup.bundle.map.js