this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};(function(e,s,t,a,l,i,r,o){"use strict";let n=e=>e,c,b;var d=babelHelpers.classPrivateFieldLooseKey("documentDateField");var p=babelHelpers.classPrivateFieldLooseKey("selectedDate");var u=babelHelpers.classPrivateFieldLooseKey("formatDate");var v=babelHelpers.classPrivateFieldLooseKey("getDateField");var h=babelHelpers.classPrivateFieldLooseKey("selectDate");class P{constructor(){Object.defineProperty(this,h,{value:H});Object.defineProperty(this,v,{value:F});Object.defineProperty(this,u,{value:L});Object.defineProperty(this,d,{writable:true,value:void 0});Object.defineProperty(this,p,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,d)[d]=babelHelpers.classPrivateFieldLooseBase(this,v)[v]();const e=new Date;babelHelpers.classPrivateFieldLooseBase(this,h)[h](e);this.setDateInCalendar(e)}setDateInCalendar(e){const s=babelHelpers.classPrivateFieldLooseBase(this,u)[u](e,"DAY_MONTH_FORMAT");const t=babelHelpers.classPrivateFieldLooseBase(this,d)[d].firstElementChild;t.textContent=s;t.title=s}getLayout(){return r.Tag.render(c||(c=n`
			<div class="sign-b2e-document-setup__date-selector">
				<span class="sign-b2e-document-setup__date-selector_label">
					${0}
				</span>
				${0}
			</div>
		`),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_DATE_LABEL"),babelHelpers.classPrivateFieldLooseBase(this,d)[d])}getSelectedDate(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p]}}function L(e,s){const t=o.DateTimeFormat.getFormat(s);return o.DateTimeFormat.format(t,e)}function F(){return r.Tag.render(b||(b=n`
			<div
				class="sign-b2e-document-setup__date-selector_field"
				onclick="${0}"
			>
				<span class="sign-b2e-document-setup__date-selector_field-text"></span>
			</div>
		`),(()=>{BX.calendar({node:babelHelpers.classPrivateFieldLooseBase(this,d)[d],field:babelHelpers.classPrivateFieldLooseBase(this,d)[d],bTime:false,callback_after:e=>{babelHelpers.classPrivateFieldLooseBase(this,h)[h](e);this.setDateInCalendar(e)}})}))}function H(e){const s=babelHelpers.classPrivateFieldLooseBase(this,u)[u](e,"SHORT_DATE_FORMAT");babelHelpers.classPrivateFieldLooseBase(this,p)[p]=s}let g=e=>e,B,y,_,m,T,f,D,E;var S=babelHelpers.classPrivateFieldLooseKey("api");var O=babelHelpers.classPrivateFieldLooseKey("region");var I=babelHelpers.classPrivateFieldLooseKey("regionDocumentTypes");var M=babelHelpers.classPrivateFieldLooseKey("documentTypeDropdown");var N=babelHelpers.classPrivateFieldLooseKey("documentNumberInput");var j=babelHelpers.classPrivateFieldLooseKey("documentTitleInput");var K=babelHelpers.classPrivateFieldLooseKey("dateSelector");var U=babelHelpers.classPrivateFieldLooseKey("documentMode");var w=babelHelpers.classPrivateFieldLooseKey("init");var $=babelHelpers.classPrivateFieldLooseKey("isDocumentTypeVisible");var C=babelHelpers.classPrivateFieldLooseKey("isRuRegion");var x=babelHelpers.classPrivateFieldLooseKey("initDocumentType");var A=babelHelpers.classPrivateFieldLooseKey("getDocumentTypeLayout");var X=babelHelpers.classPrivateFieldLooseKey("getDocumentNumberLayout");var G=babelHelpers.classPrivateFieldLooseKey("getDocumentTitleLayout");var k=babelHelpers.classPrivateFieldLooseKey("getDocumentHintLayout");var V=babelHelpers.classPrivateFieldLooseKey("getDocumentTitleFullClass");var R=babelHelpers.classPrivateFieldLooseKey("sendDocumentType");var Y=babelHelpers.classPrivateFieldLooseKey("sendDocumentNumber");var q=babelHelpers.classPrivateFieldLooseKey("sendDocumentDate");var z=babelHelpers.classPrivateFieldLooseKey("setDocumentNumber");var J=babelHelpers.classPrivateFieldLooseKey("validateInput");var Q=babelHelpers.classPrivateFieldLooseKey("isTemplateMode");class W extends a.DocumentSetup{constructor(e){super(e);Object.defineProperty(this,Q,{value:ue});Object.defineProperty(this,J,{value:pe});Object.defineProperty(this,z,{value:de});Object.defineProperty(this,q,{value:be});Object.defineProperty(this,Y,{value:ce});Object.defineProperty(this,R,{value:ne});Object.defineProperty(this,V,{value:oe});Object.defineProperty(this,k,{value:re});Object.defineProperty(this,G,{value:ie});Object.defineProperty(this,X,{value:le});Object.defineProperty(this,A,{value:ae});Object.defineProperty(this,x,{value:te});Object.defineProperty(this,C,{value:se});Object.defineProperty(this,$,{value:ee});Object.defineProperty(this,w,{value:Z});Object.defineProperty(this,S,{writable:true,value:void 0});Object.defineProperty(this,O,{writable:true,value:void 0});Object.defineProperty(this,I,{writable:true,value:void 0});Object.defineProperty(this,M,{writable:true,value:void 0});Object.defineProperty(this,N,{writable:true,value:null});Object.defineProperty(this,j,{writable:true,value:void 0});Object.defineProperty(this,K,{writable:true,value:null});Object.defineProperty(this,U,{writable:true,value:void 0});const{region:t,regionDocumentTypes:a,documentMode:l}=e;babelHelpers.classPrivateFieldLooseBase(this,S)[S]=new s.Api;babelHelpers.classPrivateFieldLooseBase(this,O)[O]=t;babelHelpers.classPrivateFieldLooseBase(this,U)[U]=l;babelHelpers.classPrivateFieldLooseBase(this,I)[I]=a;babelHelpers.classPrivateFieldLooseBase(this,j)[j]=r.Tag.render(B||(B=g`
			<input
				type="text"
				class="ui-ctl-element"
				maxlength="255"
				oninput="${0}"
			/>
		`),(({target:e})=>this.setDocumentTitle(e.value)));if(babelHelpers.classPrivateFieldLooseBase(this,C)[C]()&&!i.isTemplateMode(l)){babelHelpers.classPrivateFieldLooseBase(this,N)[N]=r.Tag.render(y||(y=g`<input type="text" class="ui-ctl-element" maxlength="255" />`));babelHelpers.classPrivateFieldLooseBase(this,K)[K]=new P}this.blankSelector.subscribe("toggleSelection",(({data:e})=>{this.setDocumentTitle(e.title)}));this.blankSelector.subscribe("addFile",(({data:e})=>{this.setDocumentTitle(e.title)}));babelHelpers.classPrivateFieldLooseBase(this,w)[w]()}setDocumentTitle(e=""){babelHelpers.classPrivateFieldLooseBase(this,j)[j].value=e;babelHelpers.classPrivateFieldLooseBase(this,j)[j].title=e}initLayout(){this.layout=r.Tag.render(_||(_=g`
			<div class="sign-document-setup">
				<h1 class="sign-b2e-settings__header">${0}</h1>
				<div class="sign-b2e-settings__item">
					<p class="sign-b2e-settings__item_title">
						${0}
					</p>
					${0}
				</div>
			</div>
		`),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_HEADER"),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_ADD_TITLE"),this.blankSelector.getLayout())}async setup(e){try{var s;await super.setup(e,babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]());if(!this.setupData){return}if(e){const{title:e,externalId:s,externalDateCreate:t}=this.setupData;this.setDocumentTitle(e);if(babelHelpers.classPrivateFieldLooseBase(this,C)[C]()&&!babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()){babelHelpers.classPrivateFieldLooseBase(this,z)[z](s);babelHelpers.classPrivateFieldLooseBase(this,K)[K].setDateInCalendar(new Date(t))}return}const{uid:t,templateUid:a}=this.setupData;const{value:l}=babelHelpers.classPrivateFieldLooseBase(this,j)[j];const i=(s=babelHelpers.classPrivateFieldLooseBase(this,N)[N])==null?void 0:s.value;this.ready=false;await Promise.all([babelHelpers.classPrivateFieldLooseBase(this,R)[R](t),babelHelpers.classPrivateFieldLooseBase(this,Y)[Y](t),babelHelpers.classPrivateFieldLooseBase(this,q)[q](t)]);const r=await babelHelpers.classPrivateFieldLooseBase(this,S)[S].modifyTitle(t,l);const{blankTitle:o}=r;if(o){const{blankId:e}=this.setupData;this.blankSelector.modifyBlankTitle(e,o)}this.setupData={...this.setupData,title:l,externalId:i,templateUid:a}}catch{const{blankId:e}=this.setupData;this.handleError(e)}this.ready=true}validate(){const e=babelHelpers.classPrivateFieldLooseBase(this,J)[J](babelHelpers.classPrivateFieldLooseBase(this,j)[j]);const s=babelHelpers.classPrivateFieldLooseBase(this,J)[J](babelHelpers.classPrivateFieldLooseBase(this,N)[N]);return e&&s}}function Z(){babelHelpers.classPrivateFieldLooseBase(this,x)[x]();const e=babelHelpers.classPrivateFieldLooseBase(this,A)[A]();const s=babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()?r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_TEMPLATE_HEAD_LABEL"):r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_HEAD_LABEL");const t=r.Tag.render(m||(m=g`
			<div class="sign-b2e-settings__item">
				<p class="sign-b2e-settings__item_title">
					${0}
				</p>
				${0}
			</div>
		`),s,babelHelpers.classPrivateFieldLooseBase(this,G)[G]());r.Dom.append(e,this.layout);r.Dom.append(t,this.layout);l.Hint.create(this.layout)}function ee(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,I)[I])==null?void 0:e.length}function se(){return babelHelpers.classPrivateFieldLooseBase(this,O)[O]==="ru"}function te(){if(!babelHelpers.classPrivateFieldLooseBase(this,$)[$]()){return}babelHelpers.classPrivateFieldLooseBase(this,M)[M]=new t.SignDropdown({tabs:[{id:"b2e-document-codes",title:" "}],entities:[{id:"b2e-document-code",searchFields:[{name:"caption",system:true}]}],className:"sign-b2e-document-setup__type-selector",withCaption:true});babelHelpers.classPrivateFieldLooseBase(this,I)[I].forEach((e=>{if(r.Type.isPlainObject(e)&&r.Type.isStringFilled(e.code)&&r.Type.isStringFilled(e.description)){const{code:s,description:t}=e;babelHelpers.classPrivateFieldLooseBase(this,M)[M].addItem({id:s,title:s,caption:`(${t})`,entityId:"b2e-document-code",tabs:"b2e-document-codes",deselectable:false})}}));babelHelpers.classPrivateFieldLooseBase(this,M)[M].selectItem(babelHelpers.classPrivateFieldLooseBase(this,I)[I][0].code)}function ae(){if(!babelHelpers.classPrivateFieldLooseBase(this,$)[$]()){return null}return r.Tag.render(T||(T=g`
			<div class="sign-b2e-settings__item">
				<p class="sign-b2e-settings__item_title">
					<span>${0}</span>
					<span
						data-hint="${0}"
					></span>
				</p>
				${0}
			</div>
		`),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TYPE"),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TYPE_HINT"),babelHelpers.classPrivateFieldLooseBase(this,M)[M].getLayout())}function le(){if(!babelHelpers.classPrivateFieldLooseBase(this,C)[C]()||babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()){return null}return r.Tag.render(f||(f=g`
			<div class="sign-b2e-document-setup__title-item --num">
				<p class="sign-b2e-document-setup__title-text">
					<span>${0}</span>
					<span
						data-hint="${0}"
					></span>
				</p>
				<div class="ui-ctl ui-ctl-textbox">
					${0}
				</div>
			</div>
		`),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_NUM_LABEL"),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_NUM_LABEL_HINT"),babelHelpers.classPrivateFieldLooseBase(this,N)[N])}function ie(){var e;return r.Tag.render(D||(D=g`
			<div>
				<div class="sign-b2e-document-setup__title-item ${0}">
					<p class="sign-b2e-document-setup__title-text">
						${0}
					</p>
					<div class="ui-ctl ui-ctl-textbox">
						${0}
					</div>
				</div>
				${0}
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,V)[V](),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_LABEL"),babelHelpers.classPrivateFieldLooseBase(this,j)[j],babelHelpers.classPrivateFieldLooseBase(this,X)[X](),babelHelpers.classPrivateFieldLooseBase(this,k)[k](),(e=babelHelpers.classPrivateFieldLooseBase(this,K)[K])==null?void 0:e.getLayout())}function re(){if(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()){return null}return r.Tag.render(E||(E=g`
			<p class="sign-b2e-document-setup__title-text">
				${0}
			</p>
		`),r.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_HINT"))}function oe(){if(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()){return"--full"}return babelHelpers.classPrivateFieldLooseBase(this,C)[C]()?"":"--full"}function ne(e){if(!babelHelpers.classPrivateFieldLooseBase(this,$)[$]()){return Promise.resolve()}const s=babelHelpers.classPrivateFieldLooseBase(this,M)[M].getSelectedId();return babelHelpers.classPrivateFieldLooseBase(this,S)[S].changeRegionDocumentType(e,s)}function ce(e){if(!babelHelpers.classPrivateFieldLooseBase(this,C)[C]()||babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()){return Promise.resolve()}return babelHelpers.classPrivateFieldLooseBase(this,S)[S].changeExternalId(e,babelHelpers.classPrivateFieldLooseBase(this,N)[N].value)}function be(e){if(!babelHelpers.classPrivateFieldLooseBase(this,C)[C]()||babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()){return Promise.resolve()}return babelHelpers.classPrivateFieldLooseBase(this,S)[S].changeExternalDate(e,babelHelpers.classPrivateFieldLooseBase(this,K)[K].getSelectedDate())}function de(e){babelHelpers.classPrivateFieldLooseBase(this,N)[N].value=e}function pe(e){if(!e){return true}const{parentNode:s,value:t}=e;if(t.trim()!==""){r.Dom.removeClass(s,"ui-ctl-warning");return true}r.Dom.addClass(s,"ui-ctl-warning");e.focus();return false}function ue(){return i.isTemplateMode(babelHelpers.classPrivateFieldLooseBase(this,U)[U])}e.DocumentSetup=W})(this.BX.Sign.V2.B2e=this.BX.Sign.V2.B2e||{},BX.Sign.V2,BX.Sign.V2.B2e,BX.Sign.V2,BX.Sign.V2,BX.Sign.V2,BX,BX.Main);
//# sourceMappingURL=document-setup.bundle.map.js