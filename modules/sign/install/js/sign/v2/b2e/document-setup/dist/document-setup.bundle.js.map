{"version":3,"file":"document-setup.bundle.js","sources":["../src/date-selector.js","../src/index.js"],"sourcesContent":["import { Tag, Loc } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\n\nexport class DateSelector\n{\n\t#documentDateField: HTMLElement;\n\t#selectedDate: string;\n\n\tconstructor()\n\t{\n\t\tthis.#documentDateField = this.#getDateField();\n\t\tconst date = new Date();\n\t\tthis.#selectDate(date);\n\t\tthis.setDateInCalendar(date);\n\t}\n\n\t#formatDate(date: Date, formatType: string): string\n\t{\n\t\tconst template = DateTimeFormat.getFormat(formatType);\n\n\t\treturn DateTimeFormat.format(template, date);\n\t}\n\n\t#getDateField(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"sign-b2e-document-setup__date-selector_field\"\n\t\t\t\tonclick=\"${() => {\n\t\t\t\t\tBX.calendar({\n\t\t\t\t\t\tnode: this.#documentDateField,\n\t\t\t\t\t\tfield: this.#documentDateField,\n\t\t\t\t\t\tbTime: false,\n\t\t\t\t\t\tcallback_after: (date) => {\n\t\t\t\t\t\t\tthis.#selectDate(date);\n\t\t\t\t\t\t\tthis.setDateInCalendar(date);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}}\"\n\t\t\t>\n\t\t\t\t<span class=\"sign-b2e-document-setup__date-selector_field-text\"></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#selectDate(date: Date): void\n\t{\n\t\tconst formattedDate = this.#formatDate(date, 'SHORT_DATE_FORMAT');\n\t\tthis.#selectedDate = formattedDate;\n\t}\n\n\tsetDateInCalendar(date: Date): void\n\t{\n\t\tconst formattedDate = this.#formatDate(date, 'DAY_MONTH_FORMAT');\n\t\tconst dateTextNode = this.#documentDateField.firstElementChild;\n\t\tdateTextNode.textContent = formattedDate;\n\t\tdateTextNode.title = formattedDate;\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-document-setup__date-selector\">\n\t\t\t\t<span class=\"sign-b2e-document-setup__date-selector_label\">\n\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_DATE_LABEL')}\n\t\t\t\t</span>\n\t\t\t\t${this.#documentDateField}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetSelectedDate(): string\n\t{\n\t\treturn this.#selectedDate;\n\t}\n}\n","import { Cache, Dom, Event, Loc, Tag, Type, Extension } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Api } from 'sign.v2.api';\nimport { SignDropdown } from 'sign.v2.b2e.sign-dropdown';\nimport { FeatureStorage } from 'sign.feature-storage';\nimport { DocumentCounters } from 'sign.v2.b2e.document-counters';\nimport { type BlankSelectorConfig } from 'sign.v2.blank-selector';\nimport { type DocumentInitiatedType, DocumentInitiated } from 'sign.type';\nimport { type DocumentDetails, DocumentSetup as BaseDocumentSetup } from 'sign.v2.document-setup';\nimport { Helpdesk, Hint } from 'sign.v2.helper';\nimport { isTemplateMode } from 'sign.v2.sign-settings';\nimport { DateSelector } from './date-selector';\nimport './style.css';\n\ntype RegionDocumentType = {\n\tcode: string,\n\tdescription: string,\n};\n\nconst HelpdeskCodes = Object.freeze({\n\tHowToWorkWithTemplates: '23174934',\n});\n\nexport class DocumentSetup extends BaseDocumentSetup\n{\n\t#cache = new Cache.MemoryCache();\n\t#api: Api;\n\t#region: string;\n\t#regionDocumentTypes: Array<RegionDocumentType>;\n\t#senderDocumentTypes: DocumentInitiatedType[];\n\t#documentTypeDropdown: HTMLElement;\n\t#documentSenderTypeDropdown: HTMLElement;\n\t#documentNumberInput: HTMLInputElement | null = null;\n\t#documentTitleInput: HTMLInputElement;\n\t#dateSelector: DateSelector | null = null;\n\theaderLayout: HTMLElement;\n\tdocumentCounters: DocumentCounters | null = null;\n\t#b2eDocumentLimitCount: number;\n\teditMode: boolean;\n\t#currentEditedId: number;\n\t#currentEditButton: HTMLElement;\n\t#currentEditBlock: HTMLElement;\n\tdocumentSectionLayout: HTMLElement;\n\tdocumentSectionInnerLayout: HTMLElement;\n\n\tconstructor(blankSelectorConfig: BlankSelectorConfig)\n\t{\n\t\tsuper(blankSelectorConfig);\n\t\tconst { region, regionDocumentTypes, documentMode, b2eDocumentLimitCount } = blankSelectorConfig;\n\t\tthis.#api = new Api();\n\t\tthis.#region = region;\n\t\tthis.#regionDocumentTypes = regionDocumentTypes;\n\t\tthis.#senderDocumentTypes = Object.values(DocumentInitiated);\n\t\tthis.#b2eDocumentLimitCount = b2eDocumentLimitCount;\n\t\tthis.editMode = false;\n\t\tthis.onClickShowHintPopup = this.showHintPopup.bind(this);\n\n\t\tthis.#documentTitleInput = Tag.render`\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\tmaxlength=\"255\"\n\t\t\t\toninput=\"${({ target }) => this.setDocumentTitle(target.value)}\"\n\t\t\t/>\n\t\t`;\n\t\tif (this.isRuRegion() && !isTemplateMode(documentMode))\n\t\t{\n\t\t\tthis.#documentNumberInput = Tag.render`<input type=\"text\" class=\"ui-ctl-element\" maxlength=\"255\" />`;\n\t\t\tthis.#dateSelector = new DateSelector();\n\t\t}\n\n\t\tthis.#disableDocumentInputs();\n\t\tthis.disableAddButton();\n\n\t\tthis.blankSelector.subscribe('toggleSelection', ({ data }) => {\n\t\t\tthis.setDocumentTitle(data.title);\n\t\t\tif (data.selected)\n\t\t\t{\n\t\t\t\tthis.#enableDocumentInputs();\n\t\t\t\tthis.enableAddButton();\n\t\t\t}\n\t\t});\n\t\tthis.blankSelector.subscribe('addFile', ({ data }) => {\n\t\t\tthis.isFileAdded = true;\n\t\t\tthis.setDocumentTitle(data.title);\n\t\t\tthis.#enableDocumentInputs();\n\t\t\tthis.enableAddButton();\n\t\t});\n\t\tthis.#init();\n\t}\n\n\t#init(): void\n\t{\n\t\tthis.#initDocumentType();\n\t\tthis.#initDocumentSenderType();\n\t\tconst documentTypeLayout = this.#getDocumentTypeLayout();\n\t\tconst title = this.isTemplateMode()\n\t\t\t? Loc.getMessage('SIGN_DOCUMENT_SETUP_TITLE_TEMPLATE_HEAD_LABEL')\n\t\t\t: Loc.getMessage('SIGN_DOCUMENT_SETUP_TITLE_HEAD_LABEL');\n\n\t\tconst titleLayout = Tag.render`\n\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t${title}\n\t\t\t\t</p>\n\t\t\t\t${this.#getDocumentTitleLayout()}\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(documentTypeLayout, this.layout);\n\t\tDom.append(this.#getDocumentSenderTypeLayout(), this.layout);\n\t\tDom.append(titleLayout, this.layout);\n\n\t\tif (!this.isTemplateMode() && FeatureStorage.isGroupSendingEnabled())\n\t\t{\n\t\t\tthis.documentCounters = new DocumentCounters({\n\t\t\t\tdocumentCountersLimit: this.#b2eDocumentLimitCount,\n\t\t\t});\n\t\t\tthis.documentCounters.subscribe('limitNotExceeded', () => {\n\t\t\t\tthis.enableAddButton();\n\t\t\t\tthis.#setAddDocumentNoticeText();\n\t\t\t\tthis.emit('documentsLimitNotExceeded');\n\t\t\t});\n\t\t\tthis.documentCounters.subscribe('limitExceeded', () => {\n\t\t\t\tthis.disableAddButton();\n\t\t\t\tthis.#setDocumentLimitNoticeText();\n\t\t\t\tthis.emit('documentsLimitExceeded');\n\t\t\t});\n\t\t\tDom.append(this.documentCounters.getLayout(), this.layout);\n\n\t\t\tconst addDocumentLayout = this.#getAddDocumentLayout();\n\t\t\tDom.append(addDocumentLayout, this.layout);\n\t\t}\n\t\tHint.create(this.layout);\n\t}\n\n\t#isDocumentTypeVisible(): boolean\n\t{\n\t\treturn this.#regionDocumentTypes?.length;\n\t}\n\n\tisRuRegion(): boolean\n\t{\n\t\treturn this.#region === 'ru';\n\t}\n\n\t#initDocumentType(): void\n\t{\n\t\tif (!this.#isDocumentTypeVisible())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#documentTypeDropdown = new SignDropdown({\n\t\t\ttabs: [{ id: 'b2e-document-codes', title: ' ' }],\n\t\t\tentities: [\n\t\t\t\t{ id: 'b2e-document-code', searchFields: [{ name: 'caption', system: true }] },\n\t\t\t],\n\t\t\tclassName: 'sign-b2e-document-setup__type-selector',\n\t\t\twithCaption: true,\n\t\t\tisEnableSearch: true,\n\t\t});\n\t\tthis.#regionDocumentTypes.forEach((item) => {\n\t\t\tif (Type.isPlainObject(item)\n\t\t\t\t&& Type.isStringFilled(item.code)\n\t\t\t\t&& Type.isStringFilled(item.description))\n\t\t\t{\n\t\t\t\tconst { code, description } = item;\n\t\t\t\tthis.#documentTypeDropdown.addItem({\n\t\t\t\t\tid: code,\n\t\t\t\t\ttitle: code,\n\t\t\t\t\tcaption: `(${description})`,\n\t\t\t\t\tentityId: 'b2e-document-code',\n\t\t\t\t\ttabs: 'b2e-document-codes',\n\t\t\t\t\tdeselectable: false,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.#documentTypeDropdown.selectItem(this.#regionDocumentTypes[0].code);\n\t}\n\n\t#getDocumentTypeLayout(): HTMLElement | null\n\t{\n\t\tif (!this.#isDocumentTypeVisible())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t<span>${Loc.getMessage('SIGN_DOCUMENT_SETUP_TYPE')}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('SIGN_DOCUMENT_SETUP_TYPE_HINT')}\"\n\t\t\t\t\t></span>\n\t\t\t\t</p>\n\t\t\t\t${this.#documentTypeDropdown.getLayout()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#initDocumentSenderType(): void\n\t{\n\t\tif (!this.isTemplateMode() || !this.isSenderTypeAvailable())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#documentSenderTypeDropdown = new SignDropdown({\n\t\t\ttabs: [{ id: 'b2e-document-sender-types', title: ' ' }],\n\t\t\tentities: [\n\t\t\t\t{ id: 'b2e-document-sender-type', searchFields: [{ name: 'caption', system: true }] },\n\t\t\t],\n\t\t\tclassName: 'sign-b2e-document-setup__sender-type-selector',\n\t\t\twithCaption: true,\n\t\t\tisEnableSearch: false,\n\t\t\theight: 110,\n\t\t\twidth: 350,\n\t\t});\n\t\tthis.#senderDocumentTypes.forEach((item) => {\n\t\t\tif (Type.isStringFilled(item))\n\t\t\t{\n\t\t\t\tconst langPhraseCode = `SIGN_DOCUMENT_SETUP_SENDER_TYPE_${item.toUpperCase()}`;\n\t\t\t\tthis.#documentSenderTypeDropdown.addItem({\n\t\t\t\t\tid: item,\n\t\t\t\t\ttitle: Loc.getMessage(langPhraseCode),\n\t\t\t\t\tentityId: 'b2e-document-sender-type',\n\t\t\t\t\ttabs: 'b2e-document-sender-types',\n\t\t\t\t\tdeselectable: false,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.#documentSenderTypeDropdown.selectItem(this.#senderDocumentTypes[0]);\n\t}\n\n\t#getDocumentSenderTypeLayout(): HTMLElement | null\n\t{\n\t\tif (!this.isTemplateMode() || !this.isSenderTypeAvailable())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t<span>${Loc.getMessage('SIGN_DOCUMENT_SETUP_SENDER_TYPE_TITLE')}</span>\n\t\t\t\t</p>\n\t\t\t\t${this.#documentSenderTypeDropdown.getLayout()}\n\t\t\t\t${this.#getHelpLink()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getHelpLink(): HTMLElement\n\t{\n\t\treturn Helpdesk.replaceLink(\n\t\t\tLoc.getMessage('SIGN_DOCUMENT_SETUP_SENDER_TYPE_HELP_LINK'),\n\t\t\tHelpdeskCodes.HowToWorkWithTemplates,\n\t\t\t'detail',\n\t\t\t['ui-link'],\n\t\t);\n\t}\n\n\t#getDocumentNumberLayout(): HTMLElement | null\n\t{\n\t\tif (!this.isRuRegion() || this.isTemplateMode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-document-setup__title-item --num\">\n\t\t\t\t<p class=\"sign-b2e-document-setup__title-text\">\n\t\t\t\t\t<span>${Loc.getMessage('SIGN_DOCUMENT_SETUP_NUM_LABEL')}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('SIGN_DOCUMENT_SETUP_NUM_LABEL_HINT')}\"\n\t\t\t\t\t></span>\n\t\t\t\t</p>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t\t${this.#documentNumberInput}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getDocumentTitleLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"sign-b2e-document-setup__title-item ${this.#getDocumentTitleFullClass()}\">\n\t\t\t\t\t<p class=\"sign-b2e-document-setup__title-text\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_TITLE_LABEL')}\n\t\t\t\t\t</p>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t\t\t${this.#documentTitleInput}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#getDocumentNumberLayout()}\n\t\t\t\t${this.#getDocumentHintLayout()}\n\t\t\t\t${this.#dateSelector?.getLayout()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getAddDocumentLayout(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('addDocumentLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"sign-b2e-settings__item --add\">\n\t\t\t\t\t<div class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t\t<span>${Loc.getMessage('SIGN_DOCUMENT_SETUP_ADD_DOCUMENT')}</span>\n\t\t\t\t\t\t${this.documentCounters.getLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.getAddDocumentButton()}\n\t\t\t\t\t${this.getAddDocumentNotice()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddDocumentButton(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('addDocumentButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button type=\"button\" class=\"sign-b2e-document-setup__add-button\" onclick=\"${this.#onClickAddDocument.bind(this)}\">\n\t\t\t\t\t${this.#getAddDocumentButtonText()}\n\t\t\t\t</button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddDocumentNotice(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('addDocumentNotice', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<p class=\"sign-b2e-document-setup__add-notice\">${Loc.getMessage('SIGN_DOCUMENT_SETUP_ADD_DOCUMENT_NOTICE')}</p>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getAddDocumentButtonText(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('addDocumentButtonText', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"sign-b2e-document-setup__add-button_text\">${Loc.getMessage('SIGN_DOCUMENT_SETUP_ADD_ANOTHER_DOCUMENT')}</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tswitchAddDocumentButtonLoadingState(loading: boolean): void\n\t{\n\t\tif (loading)\n\t\t{\n\t\t\tDom.addClass(this.getAddDocumentButton(), 'ui-btn-wait');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.getAddDocumentButton(), 'ui-btn-wait');\n\t\t}\n\t}\n\n\tdisableAddButton(): void\n\t{\n\t\tDom.addClass(this.getAddDocumentButton(), '--disabled');\n\t}\n\n\tenableAddButton(): void\n\t{\n\t\tDom.removeClass(this.getAddDocumentButton(), '--disabled');\n\t}\n\n\t#setDocumentLimitNoticeText(): void\n\t{\n\t\tDom.addClass(this.getAddDocumentNotice(), '--warning');\n\t\tthis.getAddDocumentNotice().textContent = Loc.getMessage('SIGN_DOCUMENT_SETUP_DOCUMENT_LIMIT_NOTICE');\n\t}\n\n\t#setAddDocumentNoticeText(): void\n\t{\n\t\tDom.removeClass(this.getAddDocumentNotice(), '--warning');\n\t\tthis.getAddDocumentNotice().textContent = Loc.getMessage('SIGN_DOCUMENT_SETUP_ADD_DOCUMENT_NOTICE');\n\t}\n\n\ttoggleDeleteBtnLoadingState(deleteButton: HTMLElement): void\n\t{\n\t\tDom.toggleClass(deleteButton, 'ui-btn-wait');\n\t}\n\n\t#onClickAddDocument(): void\n\t{\n\t\tthis.emit('addDocument');\n\t}\n\n\trenderDocumentBlock(documentData: Object): void\n\t{\n\t\tif (!documentData)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.append(this.#createDocumentBlock(documentData), this.headerLayout);\n\t}\n\n\t#createDocumentBlock(documentData: Object): HTMLElement\n\t{\n\t\tconst deleteButton = Tag.render`\n\t\t\t<button class=\"sign-b2e-document-setup__document-block_delete\" type=\"button\"></button>\n\t\t`;\n\t\tconst editButton = Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-round ui-btn-sm ui-btn-light-border\" type=\"button\">\n\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_DOCUMENT_EDIT_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\n\t\tEvent.bind(deleteButton, 'click', (event) => {\n\t\t\tthis.#onClickDeleteDocument(documentData, event);\n\t\t});\n\t\tEvent.bind(editButton, 'click', (event) => {\n\t\t\tthis.#onClickEditDocument(documentData, event);\n\t\t});\n\t\tconst documentTypeDropdownLayout = this.#isDocumentTypeVisible() ? this.#getDocumentTypeDropdownLayout() : '';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-document-setup__document-block\" data-id=\"document-id-${documentData.id}\">\n\t\t\t\t<div class=\"sign-b2e-document-setup__document-block_inner\">\n\t\t\t\t\t<div class=\"sign-b2e-document-setup__document-block_title\">${documentData.title}</div>\n\t\t\t\t\t${documentTypeDropdownLayout}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sign-b2e-document-setup__document-block_btn\">\n\t\t\t\t\t${editButton}\n\t\t\t\t\t${deleteButton}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sign-b2e-document-setup__document-block_hint\">\n\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_ADD_DOCUMENT_HINT')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getDocumentTypeDropdownLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-document-setup__document-block_info\">${this.#documentTypeDropdown.getSelectedCaption()}</div>\n\t\t`;\n\t}\n\n\tupdateDocumentBlock(id: number): void\n\t{\n\t\tconst editedBlock = this.layout.querySelector(`[data-id=\"document-id-${id}\"]`);\n\t\tconst titleNode = editedBlock.querySelector('.sign-b2e-document-setup__document-block_title');\n\t\ttitleNode.textContent = this.#documentTitleInput.title;\n\n\t\tif (this.#isDocumentTypeVisible())\n\t\t{\n\t\t\tconst infoNode = editedBlock.querySelector('.sign-b2e-document-setup__document-block_info');\n\t\t\tinfoNode.textContent = this.#documentTypeDropdown.getSelectedCaption();\n\t\t}\n\t}\n\n\treplaceDocumentBlock(oldDocument, newDocument): void\n\t{\n\t\tconst editedBlock = this.layout.querySelector(`[data-id=\"document-id-${oldDocument.id}\"]`);\n\t\tDom.replace(editedBlock, this.#createDocumentBlock(newDocument));\n\t}\n\n\t#getDocumentHintLayout(): HTMLElement | null\n\t{\n\t\tif (this.isTemplateMode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#cache.remember('documentHintLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<p class=\"sign-b2e-document-setup__title-text\">\n\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_TITLE_HINT')}\n\t\t\t\t</p>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#onClickDeleteDocument(documentData: DocumentDetails, event: PointerEvent): void\n\t{\n\t\tthis.setupData = null;\n\t\tconst { id, uid, blankId } = documentData;\n\t\tconst deleteButton = event.target;\n\t\tthis.toggleDeleteBtnLoadingState(deleteButton);\n\t\tthis.emit('deleteDocument', { id, uid, blankId, deleteButton });\n\t}\n\n\t#onClickEditDocument(documentData: DocumentDetails, event: PointerEvent): void\n\t{\n\t\tconst { id, uid } = documentData;\n\t\tthis.toggleEditMode(id, event.target);\n\t\tthis.emit('editDocument', { uid });\n\t}\n\n\ttoggleEditMode(id: number, editButton: HTMLElement): void\n\t{\n\t\tif (this.#currentEditedId !== id)\n\t\t{\n\t\t\tthis.resetEditMode();\n\t\t}\n\n\t\tconst documentBlock = editButton.closest(`[data-id=\"document-id-${id}\"]`);\n\t\tDom.toggleClass(documentBlock, '--edit');\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\teditButton.textContent = Loc.getMessage('SIGN_DOCUMENT_SETUP_DOCUMENT_EDIT_BUTTON');\n\t\t\tthis.#disableDocumentInputs();\n\t\t\tthis.disableAddButton();\n\t\t\tthis.editMode = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\teditButton.textContent = Loc.getMessage('SIGN_DOCUMENT_SETUP_DOCUMENT_CANCEL_BUTTON');\n\t\t\tthis.editMode = true;\n\t\t\tthis.#enableDocumentInputs();\n\t\t\tthis.enableAddButton();\n\t\t\tthis.#currentEditedId = id;\n\t\t\tthis.#currentEditButton = editButton;\n\t\t\tthis.#currentEditBlock = documentBlock;\n\t\t}\n\t}\n\n\tresetEditMode(): void\n\t{\n\t\tif (!this.#currentEditedId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#currentEditButton.textContent = Loc.getMessage('SIGN_DOCUMENT_SETUP_DOCUMENT_EDIT_BUTTON');\n\t\tDom.removeClass(this.#currentEditBlock, '--edit');\n\t\tthis.editMode = false;\n\n\t\tthis.#currentEditButton = null;\n\t\tthis.#currentEditBlock = null;\n\t\tthis.#currentEditedId = null;\n\t}\n\n\tgetHeaderLayout(): HTMLElement\n\t{\n\t\tconst headerText = this.isTemplateMode()\n\t\t\t? Loc.getMessage('SIGN_DOCUMENT_SETUP_TEMPLATE_HEADER')\n\t\t\t: Loc.getMessage('SIGN_DOCUMENT_SETUP_HEADER')\n\t\t;\n\n\t\tthis.headerLayout = Tag.render`\n\t\t\t<h1 class=\"sign-b2e-settings__header\">${headerText}</h1>\n\t\t`;\n\n\t\treturn this.headerLayout;\n\t}\n\n\t#getDocumentTitleFullClass(): string\n\t{\n\t\tif (this.isTemplateMode())\n\t\t{\n\t\t\treturn '--full';\n\t\t}\n\n\t\treturn this.isRuRegion() ? '' : '--full';\n\t}\n\n\t#sendDocumentType(uid: string): Promise<void>\n\t{\n\t\tif (!this.#isDocumentTypeVisible())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst type = this.#documentTypeDropdown.getSelectedId();\n\n\t\treturn this.#api.changeRegionDocumentType(uid, type);\n\t}\n\n\t#sendDocumentSenderType(uid: string): Promise<void>\n\t{\n\t\tif (!this.isTemplateMode() || !this.isSenderTypeAvailable())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst senderType = this.#documentSenderTypeDropdown.getSelectedId();\n\t\tthis.setupData.initiatedByType = senderType;\n\n\t\treturn this.#api.changeSenderDocumentType(uid, senderType);\n\t}\n\n\t#sendDocumentNumber(uid: string): Promise<void>\n\t{\n\t\tif (!this.isRuRegion() || this.isTemplateMode())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn this.#api.changeExternalId(uid, this.#documentNumberInput.value);\n\t}\n\n\t#sendDocumentDate(uid: string): Promise<void>\n\t{\n\t\tif (!this.isRuRegion() || this.isTemplateMode())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn this.#api.changeExternalDate(uid, this.#dateSelector.getSelectedDate());\n\t}\n\n\tsetDocumentNumber(number: string): void\n\t{\n\t\tthis.#documentNumberInput.value = number;\n\t}\n\n\tsetDocumentTitle(title: string = ''): void\n\t{\n\t\tthis.#documentTitleInput.value = title;\n\t\tthis.#documentTitleInput.title = title;\n\t}\n\n\tsetDocumentType(regionDocumentType: string = ''): void\n\t{\n\t\tif (!this.#isDocumentTypeVisible())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst isDocumentTypeExist = this.#regionDocumentTypes.some((item) => item.code === regionDocumentType);\n\t\tconst documentType = isDocumentTypeExist ? regionDocumentType : this.#regionDocumentTypes[0].code;\n\n\t\tthis.#documentTypeDropdown.selectItem(documentType);\n\t}\n\n\tsetDocumentSenderType(initiatedByType: string): void\n\t{\n\t\tif (!this.isTemplateMode() || !this.isSenderTypeAvailable())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst senderType = this.#senderDocumentTypes.includes(initiatedByType) ? initiatedByType : 'employee';\n\t\tthis.#documentSenderTypeDropdown.selectItem(senderType);\n\t}\n\n\tinitLayout(): void\n\t{\n\t\tthis.layout = Tag.render`\n\t\t\t<div class=\"sign-document-setup\">\n\t\t\t\t${this.getHeaderLayout()}\n\t\t\t\t${this.getDocumentSectionLayout()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetDocumentSectionLayout(): HTMLElement\n\t{\n\t\tif (!this.documentSectionLayout)\n\t\t{\n\t\t\tthis.documentSectionLayout = Tag.render`\n\t\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t\t${this.getDocumentSectionInnerLayout()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tthis.createHintPopup();\n\t\t}\n\n\t\treturn this.documentSectionLayout;\n\t}\n\n\tgetDocumentSectionInnerLayout(): HTMLElement\n\t{\n\t\tconst itemTitleText = this.isTemplateMode()\n\t\t\t? Loc.getMessage('SIGN_DOCUMENT_SETUP_ADD_TEMPLATE_TITLE')\n\t\t\t: Loc.getMessage('SIGN_DOCUMENT_SETUP_ADD_TITLE')\n\t\t;\n\n\t\tthis.documentSectionInnerLayout = Tag.render`\n\t\t\t<div class=\"sign-b2e-settings__item-inner\">\n\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t${itemTitleText}\n\t\t\t\t</p>\n\t\t\t\t${this.blankSelector.getLayout()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.documentSectionInnerLayout;\n\t}\n\n\tcreateHintPopup(): void\n\t{\n\t\tthis.hintPopup = new Popup({\n\t\t\tcontent: Loc.getMessage('SIGN_DOCUMENT_SETUP_DOCUMENT_LIMIT_POPUP'),\n\t\t\tautoHide: true,\n\t\t\tdarkMode: true,\n\t\t});\n\t}\n\n\tsetAvailabilityDocumentSection(isAvailable: boolean): void\n\t{\n\t\tif (isAvailable)\n\t\t{\n\t\t\tDom.removeClass(this.documentSectionInnerLayout, '--disabled');\n\t\t\tEvent.unbind(this.documentSectionLayout, 'click', this.onClickShowHintPopup);\n\t\t\tthis.hintPopup.close();\n\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.documentSectionInnerLayout, '--disabled');\n\t\tEvent.bind(this.documentSectionLayout, 'click', this.onClickShowHintPopup);\n\t}\n\n\tshowHintPopup(event): void\n\t{\n\t\tthis.hintPopup.setBindElement(event);\n\t\tthis.hintPopup.show();\n\t}\n\n\tasync setup(uid: ?string): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tawait super.setup(uid, this.isTemplateMode());\n\t\t\tif (!this.setupData || this.blankIsNotSelected)\n\t\t\t{\n\t\t\t\tthis.ready = true;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (uid)\n\t\t\t{\n\t\t\t\tconst { title, externalId, externalDateCreate, initiatedByType, regionDocumentType } = this.setupData;\n\t\t\t\tthis.setDocumentTitle(title);\n\t\t\t\tthis.setDocumentSenderType(initiatedByType);\n\t\t\t\tthis.setDocumentType(regionDocumentType);\n\n\t\t\t\tif (this.isRuRegion() && !this.isTemplateMode())\n\t\t\t\t{\n\t\t\t\t\tthis.setDocumentNumber(externalId);\n\t\t\t\t\tthis.#dateSelector.setDateInCalendar(new Date(externalDateCreate));\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.ready = false;\n\n\t\t\tthis.setupData = await this.updateDocumentData(this.setupData);\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tconst { blankId } = this.setupData;\n\t\t\tthis.handleError(blankId);\n\t\t}\n\n\t\tthis.ready = true;\n\t}\n\n\tasync updateDocumentData(documentData: DocumentDetails): Promise<DocumentDetails>\n\t{\n\t\tif (!documentData)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tawait Promise.all([\n\t\t\tthis.#sendDocumentType(documentData.uid),\n\t\t\tthis.#sendDocumentSenderType(documentData.uid),\n\t\t\tthis.#sendDocumentNumber(documentData.uid),\n\t\t\tthis.#sendDocumentDate(documentData.uid),\n\t\t]);\n\n\t\tconst { value: title } = this.#documentTitleInput;\n\t\tconst { templateUid } = this.setupData;\n\t\tconst externalId = this.#documentNumberInput?.value;\n\t\tlet regionDocumentType = null;\n\t\tif (this.#isDocumentTypeVisible())\n\t\t{\n\t\t\tregionDocumentType = this.#documentTypeDropdown.getSelectedId();\n\t\t}\n\t\tconst modifyDocumentTitleResponse = await this.#api.modifyTitle(documentData.uid, title);\n\t\tconst { blankTitle } = modifyDocumentTitleResponse;\n\t\tif (blankTitle)\n\t\t{\n\t\t\tconst { blankId } = documentData;\n\t\t\tthis.blankSelector.modifyBlankTitle(blankId, blankTitle);\n\t\t}\n\n\t\tdocumentData = { ...documentData, title, externalId, regionDocumentType, templateUid };\n\n\t\treturn documentData;\n\t}\n\n\t#validateInput(input: HTMLElement): boolean\n\t{\n\t\tif (!input)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst { parentNode, value } = input;\n\t\tif (value.trim() !== '')\n\t\t{\n\t\t\tDom.removeClass(parentNode, 'ui-ctl-warning');\n\n\t\t\treturn true;\n\t\t}\n\n\t\tDom.addClass(parentNode, 'ui-ctl-warning');\n\t\tinput.focus();\n\n\t\treturn false;\n\t}\n\n\tvalidate(): boolean\n\t{\n\t\tconst isValidTitle = this.#validateInput(this.#documentTitleInput);\n\t\tconst isValidNumber = this.#validateInput(this.#documentNumberInput);\n\n\t\treturn isValidTitle && isValidNumber;\n\t}\n\n\tisSenderTypeAvailable(): boolean\n\t{\n\t\tconst settings = Extension.getSettings('sign.v2.b2e.document-setup');\n\n\t\treturn settings.get('isSenderTypeAvailable');\n\t}\n\n\tresetDocument(): void\n\t{\n\t\tthis.blankSelector.resetSelectedBlank();\n\t\tthis.setDocumentTitle('');\n\n\t\tif (this.isRuRegion())\n\t\t{\n\t\t\tthis.setDocumentNumber('');\n\t\t}\n\n\t\tthis.isFileAdded = false;\n\t\tthis.#disableDocumentInputs();\n\t\tthis.disableAddButton();\n\t}\n\n\t#enableDocumentInputs(): void\n\t{\n\t\tthis.#documentTitleInput.disabled = false;\n\t\tif (this.#documentNumberInput)\n\t\t{\n\t\t\tthis.#documentNumberInput.disabled = false;\n\t\t}\n\t\tthis.blankIsNotSelected = false;\n\t}\n\n\t#disableDocumentInputs(): void\n\t{\n\t\tthis.#documentTitleInput.disabled = true;\n\t\tif (this.#documentNumberInput)\n\t\t{\n\t\t\tthis.#documentNumberInput.disabled = true;\n\t\t}\n\t\tthis.blankIsNotSelected = true;\n\t}\n}\n"],"names":["DateSelector","constructor","date","Date","setDateInCalendar","formattedDate","dateTextNode","firstElementChild","textContent","title","getLayout","Tag","render","Loc","getMessage","getSelectedDate","formatType","template","DateTimeFormat","getFormat","format","BX","calendar","node","field","bTime","callback_after","HelpdeskCodes","Object","freeze","HowToWorkWithTemplates","DocumentSetup","BaseDocumentSetup","blankSelectorConfig","Cache","MemoryCache","documentCounters","region","regionDocumentTypes","documentMode","b2eDocumentLimitCount","Api","values","DocumentInitiated","editMode","onClickShowHintPopup","showHintPopup","bind","target","setDocumentTitle","value","isRuRegion","isTemplateMode","disableAddButton","blankSelector","subscribe","data","selected","enableAddButton","isFileAdded","getAddDocumentButton","remember","getAddDocumentNotice","switchAddDocumentButtonLoadingState","loading","Dom","addClass","removeClass","toggleDeleteBtnLoadingState","deleteButton","toggleClass","renderDocumentBlock","documentData","append","headerLayout","updateDocumentBlock","id","editedBlock","layout","querySelector","titleNode","infoNode","getSelectedCaption","replaceDocumentBlock","oldDocument","newDocument","replace","toggleEditMode","editButton","resetEditMode","documentBlock","closest","getHeaderLayout","headerText","setDocumentNumber","number","setDocumentType","regionDocumentType","isDocumentTypeExist","some","item","code","documentType","selectItem","setDocumentSenderType","initiatedByType","isSenderTypeAvailable","senderType","includes","initLayout","getDocumentSectionLayout","documentSectionLayout","getDocumentSectionInnerLayout","createHintPopup","itemTitleText","documentSectionInnerLayout","hintPopup","Popup","content","autoHide","darkMode","setAvailabilityDocumentSection","isAvailable","Event","unbind","close","event","setBindElement","show","setup","uid","setupData","blankIsNotSelected","ready","externalId","externalDateCreate","updateDocumentData","blankId","handleError","Promise","all","templateUid","getSelectedId","modifyDocumentTitleResponse","modifyTitle","blankTitle","modifyBlankTitle","validate","isValidTitle","isValidNumber","settings","Extension","getSettings","get","resetDocument","resetSelectedBlank","documentTypeLayout","titleLayout","FeatureStorage","isGroupSendingEnabled","DocumentCounters","documentCountersLimit","emit","addDocumentLayout","Hint","create","length","SignDropdown","tabs","entities","searchFields","name","system","className","withCaption","isEnableSearch","forEach","Type","isPlainObject","isStringFilled","description","addItem","caption","entityId","deselectable","height","width","langPhraseCode","toUpperCase","Helpdesk","replaceLink","documentTypeDropdownLayout","resolve","type","changeRegionDocumentType","changeSenderDocumentType","changeExternalId","changeExternalDate","input","parentNode","trim","focus","disabled"],"mappings":"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"}