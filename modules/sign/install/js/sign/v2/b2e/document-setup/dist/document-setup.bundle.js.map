{"version":3,"file":"document-setup.bundle.js","sources":["../src/date-selector.js","../src/index.js"],"sourcesContent":["import { Tag, Loc } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\n\nexport class DateSelector\n{\n\t#documentDateField: HTMLElement;\n\t#selectedDate: string;\n\n\tconstructor()\n\t{\n\t\tthis.#documentDateField = this.#getDateField();\n\t\tconst date = new Date();\n\t\tthis.#selectDate(date);\n\t\tthis.setDateInCalendar(date);\n\t}\n\n\t#formatDate(date: Date, formatType: string): string\n\t{\n\t\tconst template = DateTimeFormat.getFormat(formatType);\n\n\t\treturn DateTimeFormat.format(template, date);\n\t}\n\n\t#getDateField(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"sign-b2e-document-setup__date-selector_field\"\n\t\t\t\tonclick=\"${() => {\n\t\t\t\t\tBX.calendar({\n\t\t\t\t\t\tnode: this.#documentDateField,\n\t\t\t\t\t\tfield: this.#documentDateField,\n\t\t\t\t\t\tbTime: false,\n\t\t\t\t\t\tcallback_after: (date) => {\n\t\t\t\t\t\t\tthis.#selectDate(date);\n\t\t\t\t\t\t\tthis.setDateInCalendar(date);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}}\"\n\t\t\t>\n\t\t\t\t<span class=\"sign-b2e-document-setup__date-selector_field-text\"></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#selectDate(date: Date): void\n\t{\n\t\tconst formattedDate = this.#formatDate(date, 'SHORT_DATE_FORMAT');\n\t\tthis.#selectedDate = formattedDate;\n\t}\n\n\tsetDateInCalendar(date: Date): void\n\t{\n\t\tconst formattedDate = this.#formatDate(date, 'DAY_MONTH_FORMAT');\n\t\tconst dateTextNode = this.#documentDateField.firstElementChild;\n\t\tdateTextNode.textContent = formattedDate;\n\t\tdateTextNode.title = formattedDate;\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-document-setup__date-selector\">\n\t\t\t\t<span class=\"sign-b2e-document-setup__date-selector_label\">\n\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_DATE_LABEL')}\n\t\t\t\t</span>\n\t\t\t\t${this.#documentDateField}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetSelectedDate(): string\n\t{\n\t\treturn this.#selectedDate;\n\t}\n}\n","import { Dom, Loc, Tag, Type } from 'main.core';\nimport { Api } from 'sign.v2.api';\nimport { SignDropdown } from 'sign.v2.b2e.sign-dropdown';\nimport { type BlankSelectorConfig } from 'sign.v2.blank-selector';\nimport { DocumentSetup as BaseDocumentSetup } from 'sign.v2.document-setup';\nimport { Hint } from 'sign.v2.helper';\nimport type { DocumentModeType } from 'sign.v2.sign-settings';\nimport { isTemplateMode } from 'sign.v2.sign-settings';\nimport { DateSelector } from './date-selector';\nimport './style.css';\n\ntype RegionDocumentType = {\n\tcode: string,\n\tdescription: string,\n};\n\nexport class DocumentSetup extends BaseDocumentSetup\n{\n\t#api: Api;\n\t#region: string;\n\t#regionDocumentTypes: Array<RegionDocumentType>;\n\t#documentTypeDropdown: HTMLElement;\n\t#documentNumberInput: HTMLInputElement | null = null;\n\t#documentTitleInput: HTMLInputElement;\n\t#dateSelector: DateSelector | null = null;\n\t#documentMode: DocumentModeType;\n\n\tconstructor(blankSelectorConfig: BlankSelectorConfig)\n\t{\n\t\tsuper(blankSelectorConfig);\n\t\tconst { region, regionDocumentTypes, documentMode } = blankSelectorConfig;\n\t\tthis.#api = new Api();\n\t\tthis.#region = region;\n\t\tthis.#documentMode = documentMode;\n\t\tthis.#regionDocumentTypes = regionDocumentTypes;\n\t\tthis.#documentTitleInput = Tag.render`\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\tmaxlength=\"255\"\n\t\t\t\toninput=\"${({ target }) => this.setDocumentTitle(target.value)}\"\n\t\t\t/>\n\t\t`;\n\t\tif (this.#isRuRegion() && !isTemplateMode(documentMode))\n\t\t{\n\t\t\tthis.#documentNumberInput = Tag.render`<input type=\"text\" class=\"ui-ctl-element\" maxlength=\"255\" />`;\n\t\t\tthis.#dateSelector = new DateSelector();\n\t\t}\n\n\t\tthis.blankSelector.subscribe('toggleSelection', ({ data }) => {\n\t\t\tthis.setDocumentTitle(data.title);\n\t\t});\n\t\tthis.blankSelector.subscribe('addFile', ({ data }) => {\n\t\t\tthis.setDocumentTitle(data.title);\n\t\t});\n\t\tthis.#init();\n\t}\n\n\t#init(): void\n\t{\n\t\tthis.#initDocumentType();\n\t\tconst documentTypeLayout = this.#getDocumentTypeLayout();\n\t\tconst title = this.#isTemplateMode()\n\t\t\t? Loc.getMessage('SIGN_DOCUMENT_SETUP_TITLE_TEMPLATE_HEAD_LABEL')\n\t\t\t: Loc.getMessage('SIGN_DOCUMENT_SETUP_TITLE_HEAD_LABEL');\n\n\t\tconst titleLayout = Tag.render`\n\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t${title}\n\t\t\t\t</p>\n\t\t\t\t${this.#getDocumentTitleLayout()}\n\t\t\t</div>\n\t\t`;\n\t\tDom.append(documentTypeLayout, this.layout);\n\t\tDom.append(titleLayout, this.layout);\n\t\tHint.create(this.layout);\n\t}\n\n\t#isDocumentTypeVisible(): boolean\n\t{\n\t\treturn this.#regionDocumentTypes?.length;\n\t}\n\n\t#isRuRegion(): boolean\n\t{\n\t\treturn this.#region === 'ru';\n\t}\n\n\t#initDocumentType(): void\n\t{\n\t\tif (!this.#isDocumentTypeVisible())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#documentTypeDropdown = new SignDropdown({\n\t\t\ttabs: [{ id: 'b2e-document-codes', title: ' ' }],\n\t\t\tentities: [\n\t\t\t\t{ id: 'b2e-document-code', searchFields: [{ name: 'caption', system: true }] },\n\t\t\t],\n\t\t\tclassName: 'sign-b2e-document-setup__type-selector',\n\t\t\twithCaption: true,\n\t\t});\n\t\tthis.#regionDocumentTypes.forEach((item) => {\n\t\t\tif (Type.isPlainObject(item)\n\t\t\t\t&& Type.isStringFilled(item.code)\n\t\t\t\t&& Type.isStringFilled(item.description))\n\t\t\t{\n\t\t\t\tconst { code, description } = item;\n\t\t\t\tthis.#documentTypeDropdown.addItem({\n\t\t\t\t\tid: code,\n\t\t\t\t\ttitle: code,\n\t\t\t\t\tcaption: `(${description})`,\n\t\t\t\t\tentityId: 'b2e-document-code',\n\t\t\t\t\ttabs: 'b2e-document-codes',\n\t\t\t\t\tdeselectable: false,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.#documentTypeDropdown.selectItem(this.#regionDocumentTypes[0].code);\n\t}\n\n\t#getDocumentTypeLayout(): HTMLElement | null\n\t{\n\t\tif (!this.#isDocumentTypeVisible())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t<span>${Loc.getMessage('SIGN_DOCUMENT_SETUP_TYPE')}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('SIGN_DOCUMENT_SETUP_TYPE_HINT')}\"\n\t\t\t\t\t></span>\n\t\t\t\t</p>\n\t\t\t\t${this.#documentTypeDropdown.getLayout()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getDocumentNumberLayout(): HTMLElement | null\n\t{\n\t\tif (!this.#isRuRegion() || this.#isTemplateMode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-document-setup__title-item --num\">\n\t\t\t\t<p class=\"sign-b2e-document-setup__title-text\">\n\t\t\t\t\t<span>${Loc.getMessage('SIGN_DOCUMENT_SETUP_NUM_LABEL')}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('SIGN_DOCUMENT_SETUP_NUM_LABEL_HINT')}\"\n\t\t\t\t\t></span>\n\t\t\t\t</p>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t\t${this.#documentNumberInput}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getDocumentTitleLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"sign-b2e-document-setup__title-item ${this.#getDocumentTitleFullClass()}\">\n\t\t\t\t\t<p class=\"sign-b2e-document-setup__title-text\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_TITLE_LABEL')}\n\t\t\t\t\t</p>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t\t\t${this.#documentTitleInput}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#getDocumentNumberLayout()}\n\t\t\t\t${this.#getDocumentHintLayout()}\n\t\t\t\t${this.#dateSelector?.getLayout()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getDocumentHintLayout(): HTMLElement | null\n\t{\n\t\tif (this.#isTemplateMode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<p class=\"sign-b2e-document-setup__title-text\">\n\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_TITLE_HINT')}\n\t\t\t</p>\n\t\t`;\n\t}\n\n\t#getDocumentTitleFullClass(): string\n\t{\n\t\tif (this.#isTemplateMode())\n\t\t{\n\t\t\treturn '--full';\n\t\t}\n\n\t\treturn this.#isRuRegion() ? '' : '--full';\n\t}\n\n\t#sendDocumentType(uid: string): Promise<void>\n\t{\n\t\tif (!this.#isDocumentTypeVisible())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst type = this.#documentTypeDropdown.getSelectedId();\n\n\t\treturn this.#api.changeRegionDocumentType(uid, type);\n\t}\n\n\t#sendDocumentNumber(uid: string): Promise<void>\n\t{\n\t\tif (!this.#isRuRegion() || this.#isTemplateMode())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn this.#api.changeExternalId(uid, this.#documentNumberInput.value);\n\t}\n\n\t#sendDocumentDate(uid: string): Promise<void>\n\t{\n\t\tif (!this.#isRuRegion() || this.#isTemplateMode())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn this.#api.changeExternalDate(uid, this.#dateSelector.getSelectedDate());\n\t}\n\n\t#setDocumentNumber(number: string): void\n\t{\n\t\tthis.#documentNumberInput.value = number;\n\t}\n\n\tsetDocumentTitle(title: string = ''): void\n\t{\n\t\tthis.#documentTitleInput.value = title;\n\t\tthis.#documentTitleInput.title = title;\n\t}\n\n\tinitLayout(): void\n\t{\n\t\tthis.layout = Tag.render`\n\t\t\t<div class=\"sign-document-setup\">\n\t\t\t\t<h1 class=\"sign-b2e-settings__header\">${Loc.getMessage('SIGN_DOCUMENT_SETUP_HEADER')}</h1>\n\t\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_ADD_TITLE')}\n\t\t\t\t\t</p>\n\t\t\t\t\t${this.blankSelector.getLayout()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tasync setup(uid: ?string): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tawait super.setup(uid, this.#isTemplateMode());\n\t\t\tif (!this.setupData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (uid)\n\t\t\t{\n\t\t\t\tconst { title, externalId, externalDateCreate } = this.setupData;\n\t\t\t\tthis.setDocumentTitle(title);\n\n\t\t\t\tif (this.#isRuRegion() && !this.#isTemplateMode())\n\t\t\t\t{\n\t\t\t\t\tthis.#setDocumentNumber(externalId);\n\t\t\t\t\tthis.#dateSelector.setDateInCalendar(new Date(externalDateCreate));\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { uid: documentUid, templateUid } = this.setupData;\n\t\t\tconst { value: title } = this.#documentTitleInput;\n\t\t\tconst externalId = this.#documentNumberInput?.value;\n\t\t\tthis.ready = false;\n\t\t\tawait Promise.all([\n\t\t\t\tthis.#sendDocumentType(documentUid),\n\t\t\t\tthis.#sendDocumentNumber(documentUid),\n\t\t\t\tthis.#sendDocumentDate(documentUid),\n\t\t\t]);\n\n\t\t\tconst modifyDocumentTitleResponse = await this.#api.modifyTitle(documentUid, title);\n\t\t\tconst { blankTitle } = modifyDocumentTitleResponse;\n\t\t\tif (blankTitle)\n\t\t\t{\n\t\t\t\tconst { blankId } = this.setupData;\n\t\t\t\tthis.blankSelector.modifyBlankTitle(blankId, blankTitle);\n\t\t\t}\n\n\t\t\tthis.setupData = { ...this.setupData, title, externalId, templateUid };\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tconst { blankId } = this.setupData;\n\t\t\tthis.handleError(blankId);\n\t\t}\n\n\t\tthis.ready = true;\n\t}\n\n\t#validateInput(input: HTMLElement): boolean\n\t{\n\t\tif (!input)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst { parentNode, value } = input;\n\t\tif (value.trim() !== '')\n\t\t{\n\t\t\tDom.removeClass(parentNode, 'ui-ctl-warning');\n\n\t\t\treturn true;\n\t\t}\n\n\t\tDom.addClass(parentNode, 'ui-ctl-warning');\n\t\tinput.focus();\n\n\t\treturn false;\n\t}\n\n\t#isTemplateMode(): boolean\n\t{\n\t\treturn isTemplateMode(this.#documentMode);\n\t}\n\n\tvalidate(): boolean\n\t{\n\t\tconst isValidTitle = this.#validateInput(this.#documentTitleInput);\n\t\tconst isValidNumber = this.#validateInput(this.#documentNumberInput);\n\n\t\treturn isValidTitle && isValidNumber;\n\t}\n}\n"],"names":["DateSelector","constructor","date","Date","setDateInCalendar","formattedDate","dateTextNode","firstElementChild","textContent","title","getLayout","Tag","render","Loc","getMessage","getSelectedDate","formatType","template","DateTimeFormat","getFormat","format","BX","calendar","node","field","bTime","callback_after","DocumentSetup","BaseDocumentSetup","blankSelectorConfig","region","regionDocumentTypes","documentMode","Api","target","setDocumentTitle","value","isTemplateMode","blankSelector","subscribe","data","initLayout","layout","setup","uid","setupData","externalId","externalDateCreate","documentUid","templateUid","ready","Promise","all","modifyDocumentTitleResponse","modifyTitle","blankTitle","blankId","modifyBlankTitle","handleError","validate","isValidTitle","isValidNumber","documentTypeLayout","titleLayout","Dom","append","Hint","create","length","SignDropdown","tabs","id","entities","searchFields","name","system","className","withCaption","forEach","item","Type","isPlainObject","isStringFilled","code","description","addItem","caption","entityId","deselectable","selectItem","resolve","type","getSelectedId","changeRegionDocumentType","changeExternalId","changeExternalDate","number","input","parentNode","trim","removeClass","addClass","focus"],"mappings":"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"}