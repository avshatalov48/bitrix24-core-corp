{"version":3,"file":"submit-document-info.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Dom, Loc, Tag, Type } from 'main.core';\nimport { MemoryCache } from 'main.core.cache';\nimport { EventEmitter } from 'main.core.events';\nimport { DateTimeFormat } from 'main.date';\nimport type { GeneralField, TemplateField } from 'sign.v2.api';\nimport { Api, MemberStatus } from 'sign.v2.api';\nimport './style.css';\nimport 'ui.forms';\nimport { SignLink } from 'sign.v2.b2e.sign-link';\n\nfunction sleep(ms: number): Promise<void>\n{\n\treturn new Promise((resolve) => {\n\t\tsetTimeout(resolve, ms);\n\t});\n}\n\ntype Company = {\n\tname: string;\n\ttaxId: string;\n};\n\ntype Options = {\n\ttemplate: {\n\t\tuid: string,\n\t},\n\tcompany: Company,\n\tfields: Array<TemplateField>,\n};\n\ntype MemberInvitedToSignEventData = {\n\tdocumentUid: string,\n\tmember: { id: number, uid: string },\n\tsigningLink: string\n};\n\nexport class SubmitDocumentInfo\n{\n\t#layoutCache: MemoryCache<HTMLElement> = new MemoryCache();\n\t#options: Options;\n\t#api: Api = new Api();\n\n\tconstructor(options: Options)\n\t{\n\t\tthis.#options = options;\n\t}\n\n\t#getCompanyLayout(): HTMLElement\n\t{\n\t\tconst { name, taxId } = this.#options.company;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-submit-document-info__company\">\n\t\t\t\t<div class=\"sign-b2e-submit-document-info__company_summary\">\n\t\t\t\t\t<p class=\"sign-b2e-submit-document-info__company_name\">\n\t\t\t\t\t\t${name}\n\t\t\t\t\t</p>\n\t\t\t\t\t<p class=\"sign-b2e-submit-document-info__company_tax\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_SUBMIT_DOCUMENT_COMPANY_TAX', {\n\t\t\t'#TAX_ID#': taxId,\n\t\t})}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getProgressLayout(): HTMLElement\n\t{\n\t\treturn this.#layoutCache.remember(\n\t\t\t'progressLayout',\n\t\t\t() => Tag.render`\n\t\t\t\t<div class=\"sign-b2e-submit-document-info__progress\">\n\t\t\t\t\t<div class=\"sign-b2e-submit-document-info__progress_icon\"></div>\n\t\t\t\t\t<h2 class=\"sign-b2e-submit-document-info__progress_head\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_SUBMIT_DOCUMENT_INFO_PROGRESS_HEAD')}\n\t\t\t\t\t</h2>\n\t\t\t\t\t<p class=\"sign-b2e-submit-document-info__progress_description\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_SUBMIT_DOCUMENT_INFO_PROGRESS_DESCRIPTION')}\n\t\t\t\t\t</p>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"ui-btn ui-btn-round ui-btn-light-border\"\n\t\t\t\t\t\tonclick=\"${() => this.#onProgressClosePageBtnClick()}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('SIGN_SUBMIT_DOCUMENT_INFO_PROGRESS_CLOSE')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t);\n\t}\n\n\t#showProgress(): void\n\t{\n\t\tDom.removeClass(this.#getProgressLayout(), '--hidden');\n\t}\n\n\t#hideProgress(): void\n\t{\n\t\tDom.addClass(this.#getProgressLayout(), '--hidden');\n\t}\n\n\t#onProgressClosePageBtnClick(): void\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.#layoutCache.remember(\n\t\t\t'layout',\n\t\t\t() => {\n\t\t\t\tthis.#hideProgress();\n\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"sign-b2e-submit-document-info\">\n\t\t\t\t\t\t<h1 class=\"sign-b2e-settings__header\">${Loc.getMessage('SIGN_START_PROCESS_HEAD')}</h1>\n\t\t\t\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('SIGN_SUBMIT_DOCUMENT_COMPANY')}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t${this.#getCompanyLayout()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('SIGN_SUBMIT_DOCUMENT_INFO_DESCRIPTION')}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t${this.#getFieldsLayout()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.#getProgressLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t},\n\t\t);\n\t}\n\n\tasync sendForSign(): Promise<boolean>\n\t{\n\t\tconst { employeeMember } = await this.#api.template.send(this.#options.template.uid);\n\t\tconst { uid: memberUid, id: memberId } = employeeMember;\n\t\tconst currentSidePanel: BX.SidePanel.Slider | null = BX.SidePanel.Instance.getTopSlider();\n\n\t\tthis.#showProgress();\n\t\tlet pending = true;\n\t\tlet openSigningSliderAfterPending = true;\n\t\tconst signLink = new SignLink({ memberId });\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseStart', () => {\n\t\t\tpending = false;\n\t\t\topenSigningSliderAfterPending = false;\n\t\t});\n\n\t\tBX.PULL?.subscribe({\n\t\t\tmoduleId: 'sign',\n\t\t\tcommand: 'memberInvitedToSign',\n\t\t\tcallback: async (params: MemberInvitedToSignEventData): Promise<void> => {\n\t\t\t\tif (params.member.id !== memberId && pending && openSigningSliderAfterPending)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tpending = false;\n\t\t\t\topenSigningSliderAfterPending = false;\n\t\t\t\tawait this.#openSigningSliderAndCloseCurrent(signLink, currentSidePanel);\n\t\t\t},\n\t\t});\n\n\t\tdo\n\t\t{\n\t\t\tawait sleep(5000);\n\t\t\tif (!openSigningSliderAfterPending)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tconst { status } = await this.#api.getMember(memberUid);\n\n\t\t\tif (status === MemberStatus.ready || status === MemberStatus.stoppableReady)\n\t\t\t{\n\t\t\t\tpending = false;\n\t\t\t}\n\t\t}\n\t\twhile (pending);\n\n\t\tif (openSigningSliderAfterPending)\n\t\t{\n\t\t\tawait this.#openSigningSliderAndCloseCurrent(signLink, currentSidePanel);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tasync #openSigningSliderAndCloseCurrent(\n\t\tsignLink: SignLink,\n\t\tcurrentSidePanel: BX.SidePanel.Slider | null,\n\t): Promise<void>\n\t{\n\t\t// load signing data before close current slider\n\t\tawait signLink.preloadData();\n\t\tif (Type.isNull(currentSidePanel))\n\t\t{\n\t\t\tsignLink.openSlider({ events: {} });\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcurrentSidePanel.close(false, () => signLink.openSlider({ events: {} }));\n\t\t}\n\t}\n\n\t#getFieldsLayout(): HTMLElement[]\n\t{\n\t\treturn this.#options.fields\n\t\t\t.map((field) => this.#getOrCreateFieldLayout(field))\n\t\t;\n\t}\n\n\t#getOrCreateFieldLayout(field: TemplateField): HTMLElement\n\t{\n\t\treturn this.#layoutCache.remember(`fieldLayout.${field.uid}`, () => {\n\t\t\tconst fieldsLayoutCallbackByType = this.#getFieldLayoutCallback(field);\n\n\t\t\tif (Type.isNull(fieldsLayoutCallbackByType))\n\t\t\t{\n\t\t\t\tthrow new TypeError(`Unknown field type: ${field.type}`);\n\t\t\t}\n\n\t\t\treturn fieldsLayoutCallbackByType(field);\n\t\t});\n\t}\n\n\t#getFieldLayoutCallback(field: TemplateField): () => HTMLElement\n\t{\n\t\tconst now = new Date();\n\t\tconst fieldName = Tag.render`\n\t\t\t<span class=\"sign-b2e-submit-document-info__label\">\n\t\t\t\t${field.name}\n\t\t\t</span>\n\t\t`;\n\n\t\tconst fieldsLayoutCallbackByType = {\n\t\t\tdate: () => Tag.render`\n\t\t\t\t<div class=\"sign-b2e-submit-document-info__field\">\n\t\t\t\t\t${fieldName}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-date\" onclick=\"${() => this.#onDateFieldClick(field)}\">\n\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-calendar\"></div>\n\t\t\t\t\t\t<div class=\"ui-ctl-element sign-b2e-submit-document-info__field-date__value\">${this.#formatDateToUserFormat(now)}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tstring: () => Tag.render`\n\t\t\t\t<div class=\"sign-b2e-submit-document-info__field\">\n\t\t\t\t\t${fieldName}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t\t\t<input type=\"text\" class=\"ui-ctl-element\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tlist: () => Tag.render`\n\t\t\t\t<div class=\"sign-b2e-submit-document-info__field\">\n\t\t\t\t\t${fieldName}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown\">\n\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t<select class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t${field.items.map((item) => Tag.render`\n\t\t\t\t\t\t\t\t<option value=\"${item.code}\">${item.label}</option>\n\t\t\t\t\t\t\t`)}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tnumber: () => Tag.render`\n\t\t\t\t<div class=\"sign-b2e-submit-document-info__field\">\n\t\t\t\t\t${fieldName}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t\t\t<input type=\"number\" class=\"ui-ctl-element\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t};\n\n\t\tconst defaultLayout = () => Tag.render`<div></div>`;\n\n\t\treturn fieldsLayoutCallbackByType[field.type] ?? defaultLayout;\n\t}\n\n\t#onDateFieldClick(field: GeneralField): void\n\t{\n\t\tBX.calendar({\n\t\t\tnode: this.#getOrCreateFieldLayout(field),\n\t\t\tfield: this.#getOrCreateFieldLayout(field),\n\t\t\tbTime: false,\n\t\t\tcallback_after: (date: Date) => {\n\t\t\t\tconst dateFieldValue = this.#getOrCreateFieldLayout(field)\n\t\t\t\t\t.querySelector('.sign-b2e-submit-document-info__field-date__value')\n\t\t\t\t;\n\t\t\t\tif (dateFieldValue)\n\t\t\t\t{\n\t\t\t\t\tdateFieldValue.textContent = this.#formatDateToUserFormat(date);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\t#formatDateToUserFormat(date: Date): string\n\t{\n\t\treturn DateTimeFormat.format(DateTimeFormat.getFormat('FORMAT_DATE'), date);\n\t}\n}\n"],"names":["sleep","ms","Promise","resolve","setTimeout","SubmitDocumentInfo","constructor","options","MemoryCache","Api","getLayout","remember","Tag","render","Loc","getMessage","sendForSign","employeeMember","template","send","uid","memberUid","id","memberId","currentSidePanel","BX","SidePanel","Instance","getTopSlider","pending","openSigningSliderAfterPending","signLink","SignLink","EventEmitter","subscribe","PULL","moduleId","command","callback","params","member","status","getMember","MemberStatus","ready","stoppableReady","name","taxId","company","Dom","removeClass","addClass","close","preloadData","Type","isNull","openSlider","events","fields","map","field","fieldsLayoutCallbackByType","TypeError","type","now","Date","fieldName","date","string","list","items","item","code","label","number","defaultLayout","calendar","node","bTime","callback_after","dateFieldValue","querySelector","textContent","DateTimeFormat","format","getFormat"],"mappings":"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"}