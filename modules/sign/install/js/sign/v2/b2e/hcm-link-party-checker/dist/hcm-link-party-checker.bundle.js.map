{"version":3,"file":"hcm-link-party-checker.bundle.js","sources":["../src/hcm-link-party-checker.js"],"sourcesContent":["import { Dom, Tag, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Loader } from 'main.loader';\nimport { HcmLinkMapping } from 'sign.v2.b2e.hcm-link-mapping';\nimport { HcmLinkEmployeeSelector } from 'sign.v2.b2e.hcm-link-employee-selector';\nimport type { Api } from 'sign.v2.api';\n\nimport \"./style.css\";\n\nexport class HcmLinkPartyChecker extends EventEmitter\n{\n\t#container: HTMLElement = null;\n\t#loaderContainer: HTMLElement = null;\n\n\t#documentGroupUids: Array<string> = [];\n\t#enabled: boolean = false;\n\n\t#hcmLinkMapping: HcmLinkMapping;\n\t#hcmLinkEmployeeSelector: HcmLinkEmployeeSelector;\n\n\t#loader: Loader | null;\n\n\t#api: Api;\n\n\tconstructor(options: Object)\n\t{\n\t\tsuper();\n\t\tthis.#api = options.api;\n\n\t\tthis.#hcmLinkMapping = new HcmLinkMapping({ api: this.#api });\n\t\tthis.#hcmLinkEmployeeSelector = new HcmLinkEmployeeSelector({ api: this.#api });\n\t\tthis.#container = this.#getContainer();\n\n\t\tthis.#subscribeToEvents();\n\n\t\tthis.setEventNamespace('BX.Sign.V2.B2e.HcmLinkPartyChecker');\n\t}\n\n\trender(): HTMLElement | null\n\t{\n\t\tif (!this.#enabled)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#getContainer();\n\t}\n\n\tsetDocumentGroupUids(uids: Array<string>): void\n\t{\n\t\tthis.#documentGroupUids = uids;\n\n\t\tconst lastUid = this.#documentGroupUids.at(-1);\n\t\tif (!Type.isStringFilled(lastUid))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#hcmLinkMapping.setDocumentUid(lastUid);\n\t\tthis.#hcmLinkEmployeeSelector.setDocumentGroupUids(this.#documentGroupUids);\n\t}\n\n\tsetEnabled(value: boolean): void\n\t{\n\t\tthis.#enabled = value;\n\n\t\tthis.#hcmLinkMapping.setEnabled(this.#enabled);\n\t\tthis.#hcmLinkEmployeeSelector.setEnabled(this.#enabled);\n\n\t\tthis.#getLoader().destroy();\n\t\tDom.hide(this.#getContainer());\n\t\tif (this.#enabled)\n\t\t{\n\t\t\tDom.show(this.#getContainer());\n\t\t}\n\t}\n\n\tasync check(): Promise<void>\n\t{\n\t\tif (!this.#enabled)\n\t\t{\n\t\t\tthis.emit('updateValidation', true);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('updateValidation', false);\n\n\t\tconst checkers = [\n\t\t\tthis.#hcmLinkMapping,\n\t\t\tthis.#hcmLinkEmployeeSelector,\n\t\t];\n\n\t\tfor (const checker of checkers)\n\t\t{\n\t\t\tchecker.hide();\n\t\t}\n\n\t\tthis.#showLoader();\n\n\t\tfor (const checker of checkers)\n\t\t{\n\t\t\tconst result = await checker.check();\n\t\t\tif (result)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.#getLoader().destroy();\n\t\t\tchecker.show();\n\t\t\tthis.emit('updateValidation', false);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#getLoader().destroy();\n\t\tthis.emit('updateValidation', true);\n\t}\n\n\t#subscribeToEvents(): void\n\t{\n\t\tthis.#hcmLinkMapping.subscribe('update', (): void => void this.check() );\n\t\tthis.#hcmLinkEmployeeSelector.subscribe('update', (): void => void this.check() );\n\t}\n\n\t#showLoader(): void\n\t{\n\t\tvoid this.#getLoader().show(this.#getLoaderContainer());\n\t}\n\n\t#getLoaderContainer(): HTMLElement\n\t{\n\t\tif (!this.#loaderContainer)\n\t\t{\n\t\t\tthis.#loaderContainer = Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"sign-b2e-hcmlink-party-check__loader\"\n\t\t\t\t></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#loaderContainer;\n\t}\n\n\t#getLoader(): Loader\n\t{\n\t\tif (!this.#loader)\n\t\t{\n\t\t\tthis.#loader = new Loader({\n\t\t\t\tsize: 30,\n\t\t\t\tmode: 'inline',\n\t\t\t});\n\t\t}\n\n\t\treturn this.#loader;\n\t}\n\n\t#getContainer(): HTMLElement\n\t{\n\t\tif (!this.#container)\n\t\t{\n\t\t\tthis.#container = Tag.render`\n\t\t\t\t<div class=\"sign-b2e-hcmlink-party-check\">\n\t\t\t\t\t${this.#hcmLinkMapping.render()}\n\t\t\t\t\t${this.#hcmLinkEmployeeSelector.render()}\n\t\t\t\t\t${this.#getLoaderContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#container;\n\t}\n}\n"],"names":["HcmLinkPartyChecker","EventEmitter","constructor","options","super","Object","value","writable","babelHelpers","api","HcmLinkMapping","this","HcmLinkEmployeeSelector","setEventNamespace","render","setDocumentGroupUids","uids","lastUid","at","Type","isStringFilled","setDocumentUid","setEnabled","destroy","Dom","hide","show","[object Object]","emit","checkers","checker","check","subscribe","Tag","Loader","size","mode"],"mappings":"wIAOqB,6uBAEd,MAAMA,UAA4BC,eAexCC,YAAYC,GAEXC,QAAQC,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAE,YAAAD,MAfiB,OAAID,8BAAAE,YAAAD,MACE,OAAID,8BAAAE,YAAAD,MAEA,KAAED,8BAAAE,YAAAD,OAClB,IAAKD,8BAAAE,YAAAD,eAAAD,8BAAAE,YAAAD,eAAAD,8BAAAE,YAAAD,eAAAD,8BAAAE,YAAAD,eAYxBE,mDAAYL,EAAQM,IAEpBD,mDAAuB,IAAIE,iBAAe,CAAED,4CAAKE,aACjDH,mDAAgC,IAAII,0BAAwB,CAAEH,4CAAKE,aACnEH,2FAAkBG,aAElBH,qDAEAG,KAAKE,kBAAkB,sCAGxBC,SAEC,+CAAKH,mDAKEA,aAHC,KAMTI,qBAAqBC,GAEpBR,mDAA0BQ,EAE1B,MAAMC,EAAUT,mDAAwBU,IAAI,GACvCC,OAAKC,eAAeH,KAKzBT,mDAAqBa,eAAeJ,GACpCT,mDAA8BO,6DAAqBJ,aAGpDW,WAAWhB,GAEVE,mDAAgBF,EAEhBE,mDAAqBc,mDAAWX,YAChCH,mDAA8Bc,mDAAWX,YAEzCH,qDAAkBe,UAClBC,MAAIC,6CAAKd,sDACLA,YAEHa,MAAIE,6CAAKf,cAIXgB,cAEC,4CAAKhB,WAGJ,YADAA,KAAKiB,KAAK,oBAAoB,GAI/BjB,KAAKiB,KAAK,oBAAoB,GAE9B,MAAMC,EAAW,yCAChBlB,mDACAA,YAGD,IAAK,MAAMmB,KAAWD,EAErBC,EAAQL,OAGTjB,qDAEA,IAAK,MAAMsB,KAAWD,EACtB,CAEC,UADqBC,EAAQC,QAU7B,OAJAvB,qDAAkBe,UAClBO,EAAQJ,YACRf,KAAKiB,KAAK,oBAAoB,GAK/BpB,qDAAkBe,UAClBZ,KAAKiB,KAAK,oBAAoB,IAwD/B,aAnDCpB,mDAAqBwB,UAAU,SAAU,KAAiBrB,KAAKoB,UAC/DvB,mDAA8BwB,UAAU,SAAU,KAAiBrB,KAAKoB,UACxE,aAIKvB,qDAAkBkB,6CAAKf,cAC5B,aAaA,+CATKA,aAEJH,mDAAwByB,MAAInB,cAAO;;;;gDAO7BH,WACP,aAYA,+CARKA,aAEJH,mDAAe,IAAI0B,SAAO,CACzBC,KAAM,GACNC,KAAM,oDAIDzB,WACP,aAeA,+CAXKA,aAEJH,mDAAkByB,MAAInB,cAAO;;OAE3B;OACA;OACA;;MAFEN,mDAAqBM,SACrBN,mDAA8BM,iDAC9BH,uDAKEA"}