{"version":3,"file":"sign-agreement.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Tag, Runtime } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Button } from 'ui.buttons';\nimport { Api } from 'sign.v2.api';\nimport './style.css';\n\ntype SignSesComAgreementConfig = {\n\tbody: string;\n\ttitle: string;\n\tbuttonText: string;\n}\n\nexport class SignSesComAgreement\n{\n\t#popup: Popup;\n\t#data: SignSesComAgreementConfig;\n\n\tconstructor(data: SignSesComAgreementConfig)\n\t{\n\t\tthis.#data = data;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#getPopup().show();\n\t}\n\n\t#getPopup(): Popup\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\treturn this.#popup;\n\t\t}\n\n\t\tconst content = Tag.render`${this.#data.body}`;\n\n\t\tthis.#popup = new Popup({\n\t\t\ttitleBar: this.#data.title,\n\t\t\tcontent,\n\t\t\tclassName: 'sign__agreement_popup',\n\t\t\tlightShadow: true,\n\t\t\tmaxWidth: 700,\n\t\t\toverlay: true,\n\t\t\twidth: 700,\n\t\t\theight: 600,\n\t\t\tautoHide: false,\n\t\t\tcloseByEsc: false,\n\t\t\tdraggable: false,\n\t\t\tcloseIcon: false,\n\t\t\tanimation: 'fading-slide',\n\t\t\tcacheable: true,\n\t\t\tbuttons: [\n\t\t\t\tthis.#getSuccessButton(),\n\t\t\t],\n\t\t});\n\n\t\tthis.#subscribeToEndOfScroll();\n\n\t\treturn this.#popup;\n\t}\n\n\t#subscribeToEndOfScroll(): void\n\t{\n\t\tconst container = this.#getPopup().getContentContainer();\n\n\t\tconst detectEndOfScroll = () => {\n\t\t\tconst gap = container.offsetHeight / 15;\n\t\t\tconst endOfScroll: boolean = container.scrollHeight - container.scrollTop - container.offsetHeight <= gap;\n\t\t\tif (endOfScroll)\n\t\t\t{\n\t\t\t\tthis.#getPopup().getButton('success')\n\t\t\t\t\t.setDisabled(false)\n\t\t\t\t\t.setActive(true)\n\t\t\t\t;\n\t\t\t}\n\t\t};\n\n\t\tcontainer.addEventListener('scroll', Runtime.throttle(detectEndOfScroll, 200));\n\t}\n\n\t#getSuccessButton(): Button\n\t{\n\t\treturn new Button({\n\t\t\tid: 'success',\n\t\t\tsize: Button.Size.MEDIUM,\n\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\ttext: this.#data.buttonText,\n\t\t\tround: true,\n\t\t\tevents: {\n\t\t\t\tclick: () => {\n\t\t\t\t\treturn new Api().setDecisionToSesB2eAgreement()\n\t\t\t\t\t\t.then(() => this.#getPopup().close())\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t},\n\t\t}).setDisabled(true);\n\t}\n}\n"],"names":["SignSesComAgreement","constructor","data","show","content","Tag","render","body","Popup","titleBar","title","className","lightShadow","maxWidth","overlay","width","height","autoHide","closeByEsc","draggable","closeIcon","animation","cacheable","buttons","container","getContentContainer","detectEndOfScroll","gap","offsetHeight","endOfScroll","scrollHeight","scrollTop","getButton","setDisabled","setActive","addEventListener","Runtime","throttle","Button","id","size","Size","MEDIUM","color","Color","SUCCESS","text","buttonText","round","events","click","Api","setDecisionToSesB2eAgreement","then","close"],"mappings":";;;;;;;;AAAA,CAIqB;CAAA;CAAA;CAAA;CAAA;AAQrB,CAAO,MAAMA,mBAAmB,CAChC;GAICC,WAAW,CAACC,IAA+B,EAC3C;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,4CAAI,kBAASA,IAAI;;GAGlBC,IAAI,GACJ;KACC,4CAAI,0BAAaA,IAAI,EAAE;;CAyEzB;CAAC,sBArEA;GACC,4CAAI,IAAI,mBACR;KACC,+CAAO,IAAI;;GAGZ,MAAMC,OAAO,GAAGC,aAAG,CAACC,MAAM,cAAC,IAAkB,KAAhB,4CAAI,gBAAOC,IAAI,CAAE;GAE9C,4CAAI,oBAAU,IAAIC,gBAAK,CAAC;KACvBC,QAAQ,EAAE,4CAAI,gBAAOC,KAAK;KAC1BN,OAAO;KACPO,SAAS,EAAE,uBAAuB;KAClCC,WAAW,EAAE,IAAI;KACjBC,QAAQ,EAAE,GAAG;KACbC,OAAO,EAAE,IAAI;KACbC,KAAK,EAAE,GAAG;KACVC,MAAM,EAAE,GAAG;KACXC,QAAQ,EAAE,KAAK;KACfC,UAAU,EAAE,KAAK;KACjBC,SAAS,EAAE,KAAK;KAChBC,SAAS,EAAE,KAAK;KAChBC,SAAS,EAAE,cAAc;KACzBC,SAAS,EAAE,IAAI;KACfC,OAAO,EAAE,yCACR,IAAI;IAEL,CAAC;GAEF,4CAAI;GAEJ,+CAAO,IAAI;CACZ;CAAC,oCAGD;GACC,MAAMC,SAAS,GAAG,4CAAI,0BAAaC,mBAAmB,EAAE;GAExD,MAAMC,iBAAiB,GAAG,MAAM;KAC/B,MAAMC,GAAG,GAAGH,SAAS,CAACI,YAAY,GAAG,EAAE;KACvC,MAAMC,WAAoB,GAAGL,SAAS,CAACM,YAAY,GAAGN,SAAS,CAACO,SAAS,GAAGP,SAAS,CAACI,YAAY,IAAID,GAAG;KACzG,IAAIE,WAAW,EACf;OACC,4CAAI,0BAAaG,SAAS,CAAC,SAAS,CAAC,CACnCC,WAAW,CAAC,KAAK,CAAC,CAClBC,SAAS,CAAC,IAAI,CAAC;;IAGlB;GAEDV,SAAS,CAACW,gBAAgB,CAAC,QAAQ,EAAEC,iBAAO,CAACC,QAAQ,CAACX,iBAAiB,EAAE,GAAG,CAAC,CAAC;CAC/E;CAAC,8BAGD;GACC,OAAO,IAAIY,iBAAM,CAAC;KACjBC,EAAE,EAAE,SAAS;KACbC,IAAI,EAAEF,iBAAM,CAACG,IAAI,CAACC,MAAM;KACxBC,KAAK,EAAEL,iBAAM,CAACM,KAAK,CAACC,OAAO;KAC3BC,IAAI,EAAE,4CAAI,gBAAOC,UAAU;KAC3BC,KAAK,EAAE,IAAI;KACXC,MAAM,EAAE;OACPC,KAAK,EAAE,MAAM;SACZ,OAAO,IAAIC,eAAG,EAAE,CAACC,4BAA4B,EAAE,CAC7CC,IAAI,CAAC,MAAM,4CAAI,0BAAaC,KAAK,EAAE,CAAC;;;IAIxC,CAAC,CAACrB,WAAW,CAAC,IAAI,CAAC;CACrB;;;;;;;;"}