{"version":3,"file":"representative-selector.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Loc, Tag, Type, Dom, Text as TextFormat } from 'main.core';\nimport { UserSelector, UserSelectorEvent } from 'sign.v2.b2e.user-selector';\nimport type { ItemOptions } from 'ui.entity-selector';\nimport { Helpdesk } from 'sign.v2.helper';\n\nimport './style.css';\n\nconst defaultAvatarLink = '/bitrix/js/socialnetwork/entity-selector/src/images/default-user.svg';\nconst HelpdeskCodes = Object.freeze({\n\tWhoCanBeRepresentative: '19740734',\n});\n\ntype UserInfo = {\n\tid: ?Number,\n\tname: ?String,\n\tposition: ?String,\n\tavatarLink: ?String,\n};\n\nexport type RepresentativeSelectorOptions = {\n\tuserId?: Number;\n\tdescription?: string;\n\tcontext?: string;\n}\n\nexport class RepresentativeSelector\n{\n\t#userSelector: UserSelector = null;\n\t#description: ?string;\n\n\t#ui = {\n\t\tcontainer: HTMLDivElement = null,\n\t\tinfo: {\n\t\t\tcontainer: HTMLDivElement = null,\n\t\t\tavatar: HTMLImageElement = null,\n\t\t\ttitle: {\n\t\t\t\tcontainer: HTMLDivElement = null,\n\t\t\t\tname: HTMLDivElement = null,\n\t\t\t\tposition: HTMLDivElement = null,\n\t\t\t},\n\t\t},\n\t\tchangeBtn: {\n\t\t\tcontainer: HTMLDivElement = null,\n\t\t\telement: HTMLSpanElement = null,\n\t\t},\n\t\tselect: {\n\t\t\tcontainer: HTMLDivElement = null,\n\t\t\ttext: HTMLSpanElement = null,\n\t\t\tbutton: HTMLButtonElement = null,\n\t\t},\n\t\tdescription: HTMLParagraphElement = null\n\t};\n\n\t#data: UserInfo = {\n\t\tid: null,\n\t\tname: null,\n\t\tposition: null,\n\t\tavatarLink: null,\n\t};\n\n\tconstructor(options: RepresentativeSelectorOptions = {})\n\t{\n\t\tthis.#data.id = Type.isInteger(options.userId) ? options.userId : null;\n\t\tthis.#description = options.description;\n\t\tthis.#userSelector = new UserSelector({\n\t\t\tmultiple: false,\n\t\t\tcontext: options.context ?? 'sign_b2e_representative_selector',\n\t\t});\n\t\tthis.#ui.container = this.getLayout();\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\tif (this.#ui.container)\n\t\t{\n\t\t\treturn this.#ui.container;\n\t\t}\n\n\t\tthis.#ui.info.title.name = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-info-user-name\"></div>\n\t\t`;\n\t\tthis.#ui.info.title.position = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-info-user-pos\"></div>\n\t\t`;\n\t\tthis.#ui.info.avatar = Tag.render`\n\t\t\t<img src=\"${defaultAvatarLink}\">\n\t\t`;\n\n\t\tthis.#ui.info.title.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-info-user-title\">\n\t\t\t\t${this.#ui.info.title.name}\n\t\t\t\t${this.#ui.info.title.position}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#ui.select.text = Tag.render`\n\t\t\t<span class=\"sign-document-b2e-representative-select-text\">${Loc.getMessage('SIGN_PARTIES_REPRESENTATIVE_SELECT_TEXT')}</span>\n\t\t`;\n\t\tthis.#ui.select.button = Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-success ui-btn-xs ui-btn-round\">\n\t\t\t\t${Loc.getMessage('SIGN_PARTIES_REPRESENTATIVE_SELECT_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\t\tthis.#ui.select.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-select\">\n\t\t\t\t${this.#ui.select.text}\n\t\t\t\t${this.#ui.select.button}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#ui.changeBtn.element = Tag.render`\n\t\t\t<span class=\"sign-document-b2e-representative-change-btn\"></span>\n\t\t`;\n\t\tthis.#ui.changeBtn.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-change\">\n\t\t\t\t${this.#ui.changeBtn.element}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#ui.info.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-info\">\n\t\t\t\t<div class=\"sign-document-b2e-representative-info-user-photo\">\n\t\t\t\t\t${this.#ui.info.avatar}\n\t\t\t\t</div>\n\t\t\t\t${this.#ui.info.title.container}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst description = this.#description\n\t\t\t? Tag.render`<p class=\"sign-document-b2e-representative__info_paragraph\">${this.#description}</p>`\n\t\t\t: Tag.render`\n\t\t\t\t<span>\n\t\t\t\t\t${Helpdesk.replaceLink(Loc.getMessage('SIGN_PARTIES_REPRESENTATIVE_INFO'), HelpdeskCodes.WhoCanBeRepresentative)}\n\t\t\t\t</span>\n\t\t\t`\n\t\t;\n\t\tthis.#ui.description = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative__info\">\n\t\t\t\t${description}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#ui.container = Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"sign-document-b2e-representative__selector\">\n\t\t\t\t\t${this.#ui.select.container}\n\t\t\t\t\t${this.#ui.info.container}\n\t\t\t\t\t${this.#ui.changeBtn.container}\n\t\t\t\t</div>\n\t\t\t\t${this.#ui.description}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#setEmptyState();\n\t\tthis.#bindEvents();\n\n\t\treturn this.#ui.container;\n\t}\n\n\tformatSelectButton(className: string)\n\t{\n\t\tthis.#ui.select.button.className = `ui-btn ${className}`;\n\t}\n\n\t#setInfoState()\n\t{\n\t\tthis.#ui.info.container.style.display = 'flex';\n\t\tBX.show(this.#ui.changeBtn.container);\n\t\tBX.show(this.#ui.description);\n\t\tBX.hide(this.#ui.select.container);\n\t}\n\n\t#setEmptyState()\n\t{\n\t\tBX.hide(this.#ui.info.container);\n\t\tBX.hide(this.#ui.changeBtn.container);\n\t\tBX.hide(this.#ui.description);\n\t\tBX.show(this.#ui.select.container);\n\t}\n\n\tformat(id: string, className: string)\n\t{\n\t\tthis.#ui[id].className = className;\n\t}\n\n\tvalidate(): boolean\n\t{\n\t\tconst isValid = Type.isInteger(this.getRepresentativeId()) && this.getRepresentativeId() > 0;\n\t\tif (isValid)\n\t\t{\n\t\t\tDom.removeClass(this.#ui.container.firstElementChild, '--invalid');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.#ui.container.firstElementChild, '--invalid');\n\t\t}\n\n\t\treturn isValid;\n\t}\n\n\tload(representativeId: number): void\n\t{\n\t\tconst dialog = this.#userSelector.getDialog();\n\t\tdialog.subscribeOnce('onLoad', () => {\n\t\t\tconst userItems = dialog.items.get('user');\n\t\t\tconst userItem = userItems.get(`${representativeId}`);\n\t\t\tuserItem.select();\n\t\t\tthis.#showItem(userItem);\n\t\t});\n\t\tdialog.load();\n\t}\n\n\tgetRepresentativeId(): ?number\n\t{\n\t\treturn this.#data.id;\n\t}\n\n\t#bindEvents()\n\t{\n\t\tBX.bind(this.#ui.changeBtn.element, 'click', () => this.#onChangeButtonClickHandler());\n\t\tBX.bind(this.#ui.select.button, 'click', () => this.#onChangeButtonClickHandler());\n\t\tthis.#userSelector.subscribe(UserSelectorEvent.onItemSelect, (event) => this.#onSelectorItemSelectedHandler(event))\n\t\tthis.#userSelector.subscribe(UserSelectorEvent.onItemDeselect, (event) => this.onSelectorItemDeselectedHandler(event))\n\t}\n\n\t#onChangeButtonClickHandler(): void\n\t{\n\t\tthis.#userSelector.getDialog().setTargetNode(this.#ui.container.firstElementChild);\n\t\tthis.#userSelector.toggle();\n\t}\n\n\t#showItem(item: ItemOptions): void\n\t{\n\t\tthis.#data.id = item.id;\n\t\tif (!Type.isInteger(this.#data.id) || this.#data.id <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst name = item.customData?.get('name') ?? '';\n\t\tconst lastName = item.customData?.get('lastName') ?? '';\n\t\tthis.#data.name = Type.isStringFilled(name) ? name : '';\n\t\tif (Type.isStringFilled(lastName))\n\t\t{\n\t\t\tif (Type.isStringFilled(name))\n\t\t\t{\n\t\t\t\tthis.#data.name += ' ';\n\t\t\t}\n\t\t\tthis.#data.name += lastName;\n\t\t}\n\n\t\tif (!Type.isStringFilled(this.#data.name))\n\t\t{\n\t\t\tthis.#data.name = item.customData?.get('login') ?? '';\n\t\t}\n\n\t\tthis.#data.position = item.customData?.get('position') || '';\n\t\tthis.#data.avatarLink = (item?.avatar || defaultAvatarLink);\n\t\tthis.#refreshView();\n\t}\n\n\t#onSelectorItemSelectedHandler(event): void\n\t{\n\t\tif (!event?.data?.items || event.data.items.length === 0)\n\t\t{\n\t\t\tthis.#data.id = null;\n\t\t\tthis.#setEmptyState();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = event.data.items[0];\n\t\tthis.#showItem(item);\n\t}\n\n\tonSelectorItemDeselectedHandler(event): void\n\t{\n\t\tthis.#data.id = null;\n\t\tthis.#onSelectorItemSelectedHandler(event);\n\t}\n\n\t#refreshView(): void\n\t{\n\t\tthis.#ui.info.title.name.innerText = TextFormat.encode(this.#data?.name);\n\t\tthis.#ui.info.title.position.innerText = TextFormat.encode(this.#data?.position);\n\t\tthis.#ui.info.avatar.src = this.#data?.avatarLink;\n\t\tthis.#setInfoState();\n\t}\n}\n"],"names":["defaultAvatarLink","HelpdeskCodes","Object","freeze","WhoCanBeRepresentative","RepresentativeSelector","constructor","options","container","HTMLDivElement","info","avatar","HTMLImageElement","title","name","position","changeBtn","element","HTMLSpanElement","select","text","button","HTMLButtonElement","description","HTMLParagraphElement","id","avatarLink","Type","isInteger","userId","UserSelector","multiple","context","getLayout","Tag","render","Loc","getMessage","Helpdesk","replaceLink","formatSelectButton","className","format","validate","isValid","getRepresentativeId","Dom","removeClass","firstElementChild","addClass","load","representativeId","dialog","getDialog","subscribeOnce","userItems","items","get","userItem","onSelectorItemDeselectedHandler","event","style","display","BX","show","hide","bind","subscribe","UserSelectorEvent","onItemSelect","onItemDeselect","setTargetNode","toggle","item","customData","lastName","isStringFilled","data","length","innerText","TextFormat","encode","src"],"mappings":"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"}