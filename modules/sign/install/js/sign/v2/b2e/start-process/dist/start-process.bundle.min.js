this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};(function(e,s,t,a,i,l,r,o){"use strict";let n=e=>e,c;const b="sign-b2e-start-process-type";const d="sign-b2e-start-process-types";var p=babelHelpers.classPrivateFieldLooseKey("resettableCache");var v=babelHelpers.classPrivateFieldLooseKey("api");var y=babelHelpers.classPrivateFieldLooseKey("templatesList");var P=babelHelpers.classPrivateFieldLooseKey("getProcessTypeLayoutLoader");var h=babelHelpers.classPrivateFieldLooseKey("getProcessTypeDropdown");var m=babelHelpers.classPrivateFieldLooseKey("getCompanySelector");var u=babelHelpers.classPrivateFieldLooseKey("createProcessTypeDropdownItemByTemplate");var L=babelHelpers.classPrivateFieldLooseKey("getCompanySelectorLoadCompanyPromise");var B=babelHelpers.classPrivateFieldLooseKey("getUniqueCompanies");var g=babelHelpers.classPrivateFieldLooseKey("onCompaniesSelectorCompaniesLoad");var F=babelHelpers.classPrivateFieldLooseKey("onCompanySelectorSelect");class S extends a.EventEmitter{constructor(){super();Object.defineProperty(this,F,{value:O});Object.defineProperty(this,g,{value:X});Object.defineProperty(this,B,{value:_});Object.defineProperty(this,L,{value:T});Object.defineProperty(this,u,{value:w});Object.defineProperty(this,m,{value:C});Object.defineProperty(this,h,{value:f});Object.defineProperty(this,P,{value:H});this.events={onProcessTypeSelect:"onProcessTypeSelect"};Object.defineProperty(this,p,{writable:true,value:new t.MemoryCache});Object.defineProperty(this,v,{writable:true,value:new l.Api});Object.defineProperty(this,y,{writable:true,value:babelHelpers.classPrivateFieldLooseBase(this,v)[v].template.getList()});this.setEventNamespace("BX.V2.B2e.StartProcess");void babelHelpers.classPrivateFieldLooseBase(this,P)[P]().show()}getLayout(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p].remember("layout",(()=>s.Tag.render(c||(c=n`
				<div>
					<h1 class="sign-b2e-settings__header">${0}</h1>
					<div class="sign-b2e-settings__item">
						<p class="sign-b2e-settings__item_title">
							${0}
						</p>
						${0}
					</div>
					<div class="sign-b2e-settings__item">
						<p class="sign-b2e-settings__item_title">
							${0}
						</p>
						${0}
					</div>
				</div>
			`),s.Loc.getMessage("SIGN_START_PROCESS_HEAD"),s.Loc.getMessage("SIGN_START_PROCESS_COMPANY"),babelHelpers.classPrivateFieldLooseBase(this,m)[m]().getLayout(),s.Loc.getMessage("SIGN_START_PROCESS_TYPE"),babelHelpers.classPrivateFieldLooseBase(this,h)[h]().getLayout())))}getSelectedTemplateUid(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h]().getSelectedId()}getTemplates(){return babelHelpers.classPrivateFieldLooseBase(this,y)[y]}getFields(e){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].template.getFields(e)}resetCache(){babelHelpers.classPrivateFieldLooseBase(this,p)[p]=new t.MemoryCache}}function H(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p].remember("processTypeLayoutLoader",(()=>new i.Loader({target:babelHelpers.classPrivateFieldLooseBase(this,h)[h]().getLayout()})))}function f(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p].remember("processTypeDropdown",(()=>{const e=new o.SignDropdown({tabs:[{id:d,title:" "}],entities:[{id:b}],items:[],isEnableSearch:true});e.subscribe(e.events.onSelect,(e=>this.emit(this.events.onProcessTypeSelect,e)));return e}))}function C(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p].remember("companySelector",(()=>{const e=new r.CompanySelector({loadCompanyPromise:babelHelpers.classPrivateFieldLooseBase(this,L)[L](),canCreateCompany:false,canEditCompany:false,isCompaniesDeselectable:false});e.subscribe(e.events.onCompaniesLoad,(()=>babelHelpers.classPrivateFieldLooseBase(this,g)[g]()));e.subscribe(e.events.onSelect,(e=>babelHelpers.classPrivateFieldLooseBase(this,F)[F](e)));return e}))}function w(e){return{id:e.uid,title:e.title,entityId:b,tabs:d,deselectable:false}}async function T(){const e=await babelHelpers.classPrivateFieldLooseBase(this,B)[B]();const s=e.map((({id:e,name:s,taxId:t})=>({id:e,title:s,rqInn:t})));return{companies:s,showTaxId:true}}async function _(){const e=await babelHelpers.classPrivateFieldLooseBase(this,y)[y];const s=e.map((e=>e.company));const t=new Set(s.map((({id:e})=>e)));return[...t].map((e=>s.find((s=>s.id===e))))}async function X(){var e;const t=babelHelpers.classPrivateFieldLooseBase(this,m)[m]();const a=await babelHelpers.classPrivateFieldLooseBase(this,y)[y];const i=a.find((({isLastUsed:e})=>e));let l=i==null?void 0:(e=i.company)==null?void 0:e.id;if(s.Type.isUndefined(l)){var r;const e=await babelHelpers.classPrivateFieldLooseBase(this,B)[B]();l=(r=e.at(0))==null?void 0:r.id}if(s.Type.isUndefined(l)){return}t.selectCompany(l)}async function O(e){void babelHelpers.classPrivateFieldLooseBase(this,P)[P]().show();const s=e.getData().companyId;const t=await babelHelpers.classPrivateFieldLooseBase(this,y)[y];const a=t.filter((({company:e})=>e.id===s)).map((e=>babelHelpers.classPrivateFieldLooseBase(this,u)[u](e)));const i=babelHelpers.classPrivateFieldLooseBase(this,h)[h]();i.removeItems();i.addItems(a);i.selectFirstItem();void babelHelpers.classPrivateFieldLooseBase(this,P)[P]().hide()}e.StartProcess=S})(this.BX.Sign.V2.B2e=this.BX.Sign.V2.B2e||{},BX,BX.Cache,BX.Event,BX,BX.Sign.V2,BX.Sign.V2.B2e,BX.Sign.V2.B2e);
//# sourceMappingURL=start-process.bundle.map.js