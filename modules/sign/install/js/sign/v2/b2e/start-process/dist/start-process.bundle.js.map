{"version":3,"file":"start-process.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Loc, Tag, Type } from 'main.core';\nimport { MemoryCache } from 'main.core.cache';\nimport { Loader } from 'main.loader';\nimport type { Template } from 'sign.v2.api';\nimport { Api } from 'sign.v2.api';\nimport { type ItemOptions, SignDropdown } from 'sign.v2.b2e.sign-dropdown';\n\nconst dropdownTemplateEntityId = 'sign-b2e-start-process-type';\nconst dropdownProcessTabId = 'sign-b2e-start-process-types';\n\nexport class StartProcess\n{\n\t#cache: MemoryCache<any> = new MemoryCache();\n\t#api: Api = new Api();\n\n\t#templatesList: Promise<Template[]> = this.#api.template.getList();\n\n\tconstructor()\n\t{\n\t\tvoid this.#getProcessTypeLayoutLoader().show();\n\t\tvoid this.#templatesList.then((data: Template[]) => this.#onProcessTypesLoaded(data));\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div>\n\t\t\t\t\t<h1 class=\"sign-b2e-settings__header\">${Loc.getMessage('SIGN_START_PROCESS_HEAD')}</h1>\n\t\t\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t\t\t${Loc.getMessage('SIGN_START_PROCESS_TYPE')}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t${this.#getProcessTypeDropdown().getLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSelectedTemplateUid(): string\n\t{\n\t\treturn this.#getProcessTypeDropdown().getSelectedId();\n\t}\n\n\tgetTemplates(): Promise<Template[]>\n\t{\n\t\treturn this.#templatesList;\n\t}\n\n\t#getProcessTypeLayoutLoader(): Loader\n\t{\n\t\treturn this.#cache.remember(\n\t\t\t'processTypeLayoutLoader',\n\t\t\t() => new Loader({ target: this.#getProcessTypeDropdown().getLayout() }),\n\t\t);\n\t}\n\n\t#getProcessTypeDropdown(): SignDropdown\n\t{\n\t\treturn this.#cache.remember(\n\t\t\t'processTypeDropdown',\n\t\t\t() => new SignDropdown({\n\t\t\t\ttabs: [{ id: dropdownProcessTabId, title: ' ' }],\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: dropdownTemplateEntityId,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: [],\n\t\t\t}),\n\t\t);\n\t}\n\n\t#onProcessTypesLoaded(templates: Template[]): void\n\t{\n\t\tconst dropdownItems = templates\n\t\t\t.map((template) => this.#createProcessTypeDropdownItemByTemplate(template))\n\t\t;\n\t\tconst processTypeDropdown = this.#getProcessTypeDropdown();\n\t\tdropdownItems.forEach((item) => processTypeDropdown.addItem(item));\n\n\t\tvoid this.#getProcessTypeLayoutLoader().hide();\n\n\t\tconst firstDropdownItemId = dropdownItems.at(0)?.id;\n\t\tif (!Type.isNil(firstDropdownItemId))\n\t\t{\n\t\t\tprocessTypeDropdown.selectItem(firstDropdownItemId);\n\t\t}\n\t}\n\n\t#createProcessTypeDropdownItemByTemplate(template: Template): ItemOptions\n\t{\n\t\treturn {\n\t\t\tid: template.uid,\n\t\t\ttitle: template.title,\n\t\t\tentityId: dropdownTemplateEntityId,\n\t\t\ttabs: dropdownProcessTabId,\n\t\t\tdeselectable: false,\n\t\t};\n\t}\n}\n"],"names":["dropdownTemplateEntityId","dropdownProcessTabId","StartProcess","constructor","MemoryCache","Api","template","getList","show","then","data","getLayout","remember","Tag","render","Loc","getMessage","getSelectedTemplateUid","getSelectedId","getTemplates","Loader","target","SignDropdown","tabs","id","title","entities","items","templates","dropdownItems","map","processTypeDropdown","forEach","item","addItem","hide","firstDropdownItemId","at","Type","isNil","selectItem","uid","entityId","deselectable"],"mappings":";;;;;;;;;AAAA,CAOA,MAAMA,wBAAwB,GAAG,6BAA6B;CAC9D,MAAMC,oBAAoB,GAAG,8BAA8B;CAAC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAE5D,CAAO,MAAMC,YAAY,CACzB;GAMCC,WAAW,GACX;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA,OAN2B,IAAIC,2BAAW;;KAAE;OAAA;OAAA,OAChC,IAAIC,eAAG;;KAAE;OAAA;OAAA,OAEiB,4CAAI,cAAMC,QAAQ,CAACC,OAAO;;KAI/D,KAAK,4CAAI,8DAA+BC,IAAI,EAAE;KAC9C,KAAK,4CAAI,kCAAgBC,IAAI,CAAEC,IAAgB,4CAAK,IAAI,gDAAuBA,IAAI,CAAC,CAAC;;GAGtFC,SAAS,GACT;KACC,OAAO,4CAAI,kBAAQC,QAAQ,CAAC,QAAQ,EAAE,MAAM;OAC3C,OAAOC,aAAG,CAACC,MAAM,cAAC;;6CAEsB,CAA4C;;;SAGhF,CAA4C;;QAE7C,CAA6C;;;IAGhD,GAR0CC,aAAG,CAACC,UAAU,CAAC,yBAAyB,CAAC,EAG7ED,aAAG,CAACC,UAAU,CAAC,yBAAyB,CAAC,EAE1C,4CAAI,sDAA2BL,SAAS,EAAE;MAI/C,CAAC;;GAGHM,sBAAsB,GACtB;KACC,OAAO,4CAAI,sDAA2BC,aAAa,EAAE;;GAGtDC,YAAY,GACZ;KACC,+CAAO,IAAI;;CAsDb;CAAC,wCAlDA;GACC,OAAO,4CAAI,kBAAQP,QAAQ,CAC1B,yBAAyB,EACzB,MAAM,IAAIQ,kBAAM,CAAC;KAAEC,MAAM,EAAE,4CAAI,sDAA2BV,SAAS;IAAI,CAAC,CACxE;CACF;CAAC,oCAGD;GACC,OAAO,4CAAI,kBAAQC,QAAQ,CAC1B,qBAAqB,EACrB,MAAM,IAAIU,qCAAY,CAAC;KACtBC,IAAI,EAAE,CAAC;OAAEC,EAAE,EAAEvB,oBAAoB;OAAEwB,KAAK,EAAE;MAAK,CAAC;KAChDC,QAAQ,EAAE,CACT;OACCF,EAAE,EAAExB;MACJ,CACD;KACD2B,KAAK,EAAE;IACP,CAAC,CACF;CACF;CAAC,gCAEqBC,SAAqB,EAC3C;GAAA;GACC,MAAMC,aAAa,GAAGD,SAAS,CAC7BE,GAAG,CAAExB,QAAQ,4CAAK,IAAI,sFAA0CA,QAAQ,CAAC,CAAC;GAE5E,MAAMyB,mBAAmB,2CAAG,IAAI,qDAA0B;GAC1DF,aAAa,CAACG,OAAO,CAAEC,IAAI,IAAKF,mBAAmB,CAACG,OAAO,CAACD,IAAI,CAAC,CAAC;GAElE,KAAK,4CAAI,8DAA+BE,IAAI,EAAE;GAE9C,MAAMC,mBAAmB,wBAAGP,aAAa,CAACQ,EAAE,CAAC,CAAC,CAAC,qBAAnB,kBAAqBb,EAAE;GACnD,IAAI,CAACc,cAAI,CAACC,KAAK,CAACH,mBAAmB,CAAC,EACpC;KACCL,mBAAmB,CAACS,UAAU,CAACJ,mBAAmB,CAAC;;CAErD;CAAC,mDAEwC9B,QAAkB,EAC3D;GACC,OAAO;KACNkB,EAAE,EAAElB,QAAQ,CAACmC,GAAG;KAChBhB,KAAK,EAAEnB,QAAQ,CAACmB,KAAK;KACrBiB,QAAQ,EAAE1C,wBAAwB;KAClCuB,IAAI,EAAEtB,oBAAoB;KAC1B0C,YAAY,EAAE;IACd;CACF;;;;;;;;"}