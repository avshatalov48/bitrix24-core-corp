this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};(function(e,s,a,i,t){"use strict";let l=e=>e,r,o,n,d;const b=Object.freeze({view:"view",edit:"edit"});const c="/bitrix/js/socialnetwork/entity-selector/src/images/default-user.svg";const v=Object.freeze({SignEdmWithEmployees:"19740792"});var p=babelHelpers.classPrivateFieldLooseKey("ui");var P=babelHelpers.classPrivateFieldLooseKey("items");var u=babelHelpers.classPrivateFieldLooseKey("preselectedUserIds");var h=babelHelpers.classPrivateFieldLooseKey("viewMode");var L=babelHelpers.classPrivateFieldLooseKey("tagSelector");var H=babelHelpers.classPrivateFieldLooseKey("loader");var B=babelHelpers.classPrivateFieldLooseKey("userPartyCounters");var F=babelHelpers.classPrivateFieldLooseKey("init");var g=babelHelpers.classPrivateFieldLooseKey("loadPreselectedUsersData");var m=babelHelpers.classPrivateFieldLooseKey("showLoader");var y=babelHelpers.classPrivateFieldLooseKey("hideLoader");var f=babelHelpers.classPrivateFieldLooseKey("getLoader");var _=babelHelpers.classPrivateFieldLooseKey("removeItem");var S=babelHelpers.classPrivateFieldLooseKey("addItem");var w=babelHelpers.classPrivateFieldLooseKey("createItemLayout");var O=babelHelpers.classPrivateFieldLooseKey("clean");class T{constructor(e){Object.defineProperty(this,O,{value:U});Object.defineProperty(this,w,{value:R});Object.defineProperty(this,S,{value:K});Object.defineProperty(this,_,{value:M});Object.defineProperty(this,f,{value:D});Object.defineProperty(this,y,{value:j});Object.defineProperty(this,m,{value:I});Object.defineProperty(this,g,{value:C});Object.defineProperty(this,F,{value:E});Object.defineProperty(this,p,{writable:true,value:{container:HTMLDivElement=null,itemContainer:HTMLDivElement=null,header:HTMLSpanElement=null,description:HTMLParagraphElement=null,userPartyCounterContainer:HTMLDivElement=null}});Object.defineProperty(this,P,{writable:true,value:new Map});Object.defineProperty(this,u,{writable:true,value:[]});Object.defineProperty(this,h,{writable:true,value:b.edit});Object.defineProperty(this,L,{writable:true,value:null});Object.defineProperty(this,H,{writable:true,value:null});Object.defineProperty(this,B,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,h)[h]=e.mode;babelHelpers.classPrivateFieldLooseBase(this,F)[F](e)}getLayout(e){if(babelHelpers.classPrivateFieldLooseBase(this,p)[p].container){return babelHelpers.classPrivateFieldLooseBase(this,p)[p].container}babelHelpers.classPrivateFieldLooseBase(this,p)[p].itemContainer=s.Tag.render(r||(r=l`
			<div class="sign-document-b2e-user-party__item-list"></div>
		`));if(babelHelpers.classPrivateFieldLooseBase(this,h)[h]!==b.edit){s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,p)[p].itemContainer,"--view");return babelHelpers.classPrivateFieldLooseBase(this,p)[p].itemContainer}const i=e==="ru"?a.Helpdesk.replaceLink(s.Loc.getMessage("SIGN_USER_PARTY_DESCRIPTION"),v.SignEdmWithEmployees):s.Loc.getMessage("SIGN_CMP_MASTER_TPL_TOUR_STEP_CHOOSE_MEMBER_USER_PARTY_DESCRIPTION");babelHelpers.classPrivateFieldLooseBase(this,p)[p].description=s.Tag.render(o||(o=l`
			<p class="sign-document-b2e-user-party__description">
				${0}
			</p>
		`),i);return s.Tag.render(n||(n=l`
			<div>
				<div class="sign-b2e-settings__header-wrapper">
					<h1 class="sign-b2e-settings__header">${0}</h1>
					${0}
				</div>
				<div class="sign-b2e-settings__item">
					<p class="sign-b2e-settings__item_title">
						${0}
					</p>
					${0}
					${0}
				</div>
			</div>
		`),s.Loc.getMessage("SIGN_USER_PARTY_HEADER"),babelHelpers.classPrivateFieldLooseBase(this,B)[B].getLayout(),s.Loc.getMessage("SIGN_USER_PARTY_ITEM_TITLE"),babelHelpers.classPrivateFieldLooseBase(this,p)[p].itemContainer,babelHelpers.classPrivateFieldLooseBase(this,p)[p].description)}async load(e){const{dialog:s}=babelHelpers.classPrivateFieldLooseBase(this,L)[L];s.preselectedItems=e.map((e=>["user",e]));const a=new Promise((e=>{s.subscribeOnce("onLoad",e)}));s.load();await a}setUsersIds(e){babelHelpers.classPrivateFieldLooseBase(this,O)[O]();babelHelpers.classPrivateFieldLooseBase(this,u)[u]=e;babelHelpers.classPrivateFieldLooseBase(this,g)[g]()}validate(){const e=babelHelpers.classPrivateFieldLooseBase(this,P)[P].size>0;const a=babelHelpers.classPrivateFieldLooseBase(this,L)[L].getOuterContainer();if(e){s.Dom.removeClass(a,"--invalid")}else{s.Dom.addClass(a,"--invalid")}return e}getUserIds(){return[...babelHelpers.classPrivateFieldLooseBase(this,P)[P].keys()]}}function E(e){if(babelHelpers.classPrivateFieldLooseBase(this,h)[h]===b.view){babelHelpers.classPrivateFieldLooseBase(this,p)[p].container=this.getLayout(e.region);return}const{b2eSignersLimitCount:s,region:a}=e;babelHelpers.classPrivateFieldLooseBase(this,B)[B]=new t.UserPartyCounters({userCountersLimit:s});babelHelpers.classPrivateFieldLooseBase(this,p)[p].container=this.getLayout(a);babelHelpers.classPrivateFieldLooseBase(this,L)[L]=new i.TagSelector({events:{onTagRemove:e=>{const{tag:s}=e.getData();babelHelpers.classPrivateFieldLooseBase(this,_)[_](s.id)},onTagAdd:e=>{const{tag:s}=e.getData();babelHelpers.classPrivateFieldLooseBase(this,S)[S](s)}},dialogOptions:{width:425,height:363,multiple:true,targetNode:babelHelpers.classPrivateFieldLooseBase(this,p)[p].itemContainer,entities:[{id:"user",options:{intranetUsersOnly:true}}],dropdownMode:true,hideOnDeselect:true}});babelHelpers.classPrivateFieldLooseBase(this,L)[L].renderTo(babelHelpers.classPrivateFieldLooseBase(this,p)[p].itemContainer)}async function C(){babelHelpers.classPrivateFieldLooseBase(this,m)[m]();await new Promise((e=>{const s=new i.Dialog({entities:[{id:"user"}],events:{onLoad:()=>{s.getSelectedItems().forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,S)[S](e)}));e()}},preselectedItems:babelHelpers.classPrivateFieldLooseBase(this,u)[u].map((e=>["user",e]))});s.load()}));babelHelpers.classPrivateFieldLooseBase(this,y)[y]()}function I(){babelHelpers.classPrivateFieldLooseBase(this,p)[p].itemContainer.style.display="none";babelHelpers.classPrivateFieldLooseBase(this,f)[f]().show()}function j(){babelHelpers.classPrivateFieldLooseBase(this,p)[p].itemContainer.style.display="flex";babelHelpers.classPrivateFieldLooseBase(this,f)[f]().hide()}function D(){if(babelHelpers.classPrivateFieldLooseBase(this,H)[H]){return babelHelpers.classPrivateFieldLooseBase(this,H)[H]}babelHelpers.classPrivateFieldLooseBase(this,H)[H]=new BX.Loader({target:babelHelpers.classPrivateFieldLooseBase(this,p)[p].container,mode:"inline",size:40});return babelHelpers.classPrivateFieldLooseBase(this,H)[H]}function M(e){var a;const i=babelHelpers.classPrivateFieldLooseBase(this,P)[P].get(e);if(i!=null&&i.container){s.Dom.remove(i.container)}babelHelpers.classPrivateFieldLooseBase(this,P)[P].delete(e);(a=babelHelpers.classPrivateFieldLooseBase(this,B)[B])==null?void 0:a.update(babelHelpers.classPrivateFieldLooseBase(this,P)[P].size)}function K(e){var a,i,t;const l={id:e.id,name:(a=e.customData)==null?void 0:a.get("name"),lastName:(i=e.customData)==null?void 0:i.get("lastName"),avatar:e==null?void 0:e.avatar};const r=babelHelpers.classPrivateFieldLooseBase(this,h)[h]===b.view?babelHelpers.classPrivateFieldLooseBase(this,w)[w](l):null;if(r){s.Dom.append(r,babelHelpers.classPrivateFieldLooseBase(this,p)[p].itemContainer)}l.container=r;babelHelpers.classPrivateFieldLooseBase(this,P)[P].set(l.id,l);(t=babelHelpers.classPrivateFieldLooseBase(this,B)[B])==null?void 0:t.update(babelHelpers.classPrivateFieldLooseBase(this,P)[P].size)}function R(e){var a,i;const t=(a=s.Text.encode(e.name))!=null?a:"";const r=(i=s.Text.encode(e.lastName))!=null?i:"";return s.Tag.render(d||(d=l`
			<img
				class="sign-document-b2e-user-party__item-list_item-avatar"
				title="${0} ${0}" src='${0}'
			/>
		`),t,r,e.avatar||c)}function U(){var e;[...babelHelpers.classPrivateFieldLooseBase(this,P)[P].values()].forEach((e=>s.Dom.remove(e.container)));babelHelpers.classPrivateFieldLooseBase(this,P)[P].clear();(e=babelHelpers.classPrivateFieldLooseBase(this,B)[B])==null?void 0:e.update(babelHelpers.classPrivateFieldLooseBase(this,P)[P].size)}e.UserParty=T})(this.BX.Sign.V2.B2e=this.BX.Sign.V2.B2e||{},BX,BX.Sign.V2,BX.UI.EntitySelector,BX.Sign.V2.B2e);
//# sourceMappingURL=user-party.bundle.map.js