{"version":3,"file":"sign-settings-employee.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Dom, Loc, Tag } from 'main.core';\nimport type { Template } from 'sign.v2.api';\nimport { StartProcess } from 'sign.v2.b2e.start-process';\nimport { SubmitDocumentInfo } from 'sign.v2.b2e.submit-document-info';\nimport { type Metadata, Wizard } from 'ui.wizard';\nimport { SignSettingsItemCounter } from 'sign.v2.helper';\n\nimport './style.css';\nimport './../../sign-settings/src/style.css';\nimport './../../../sign-settings/src/style.css';\n\ntype StepsContext = {\n\tselectedTemplateUid?: string;\n\ttemplatesList?: Template[];\n}\n\nexport class B2EEmployeeSignSettings\n{\n\t#containerId: string;\n\t#wizard: Wizard;\n\t#startProcess: StartProcess;\n\t#stepsContext: StepsContext = {};\n\n\tconstructor(containerId: string)\n\t{\n\t\tthis.#containerId = containerId;\n\t\tconst currentSlider = BX.SidePanel.Instance.getTopSlider();\n\t\tthis.#wizard = new Wizard(this.#getStepsMetadata(this), {\n\t\t\tback: { className: 'ui-btn-light-border' },\n\t\t\tnext: { className: 'ui-btn-success' },\n\t\t\tcomplete: {\n\t\t\t\tclassName: 'ui-btn-success',\n\t\t\t\ttitle: Loc.getMessage('SIGN_SETTINGS_EMPLOYEE_COMPLETE_TITLE'),\n\t\t\t\tonComplete: () => currentSlider?.close(),\n\t\t\t},\n\t\t\tswapButtons: true,\n\t\t});\n\t\tthis.#startProcess = new StartProcess();\n\t}\n\n\t#createHead(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-settings__head\">\n\t\t\t\t<div>\n\t\t\t\t\t<p class=\"sign-settings__head_title\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_SETTINGS_EMPLOYEE_TITLE')}\n\t\t\t\t\t</p>\n\t\t\t\t\t<p class=\"sign-settings__head_title --sub\">\n\t\t\t\t\t\t<span>${Loc.getMessage('SIGN_SETTINGS_EMPLOYEE_TITLE_SUB')}</span>\n\t\t\t\t\t\t<a class=\"sign-settings__head_title-help\">\n\t\t\t\t\t\t\t${Loc.getMessage('SIGN_SETTINGS_EMPLOYEE_TITLE_SUB_HELP')}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getStartProcessStep(signSettings: B2EEmployeeSignSettings): $Values<Metadata>\n\t{\n\t\treturn {\n\t\t\tget content(): HTMLElement\n\t\t\t{\n\t\t\t\tconst layout = signSettings.#startProcess.getLayout();\n\t\t\t\tSignSettingsItemCounter.numerate(layout);\n\n\t\t\t\treturn layout;\n\t\t\t},\n\t\t\ttitle: Loc.getMessage('SIGN_SETTINGS_EMPLOYEE_START_PROCESS'),\n\t\t\tbeforeCompletion: async () => {\n\t\t\t\tthis.#stepsContext.selectedTemplateUid = signSettings.#startProcess.getSelectedTemplateUid();\n\t\t\t\tthis.#stepsContext.templatesList = await signSettings.#startProcess.getTemplates();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getSubmitDocumentInfoStep(signSettings: B2EEmployeeSignSettings): $Values<Metadata>\n\t{\n\t\tlet submitDocumentInfo = null;\n\n\t\treturn {\n\t\t\tget content(): HTMLElement\n\t\t\t{\n\t\t\t\tconst currentTemplateSelected: Template = signSettings.#stepsContext.templatesList\n\t\t\t\t\t.find((template) => template.uid === signSettings.#stepsContext.selectedTemplateUid)\n\t\t\t\t;\n\n\t\t\t\tsubmitDocumentInfo = new SubmitDocumentInfo({\n\t\t\t\t\ttemplate: {\n\t\t\t\t\t\tuid: currentTemplateSelected.uid,\n\t\t\t\t\t},\n\t\t\t\t\tcompany: currentTemplateSelected.company,\n\t\t\t\t\tfields: currentTemplateSelected.fields,\n\t\t\t\t});\n\n\t\t\t\tconst layout = submitDocumentInfo.getLayout();\n\t\t\t\tSignSettingsItemCounter.numerate(layout);\n\n\t\t\t\treturn layout;\n\t\t\t},\n\t\t\ttitle: Loc.getMessage('SIGN_SETTINGS_EMPLOYEE_SUBMIT_INFO'),\n\t\t\tbeforeCompletion: () => {\n\t\t\t\treturn submitDocumentInfo.sendForSign();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getStepsMetadata(signSettings: B2EEmployeeSignSettings): Metadata\n\t{\n\t\treturn {\n\t\t\tstartProcess: this.#getStartProcessStep(signSettings),\n\t\t\tsubmitDocumentInfo: this.#getSubmitDocumentInfoStep(signSettings),\n\t\t};\n\t}\n\n\t#getLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-settings__scope sign-settings --b2e --employee\">\n\t\t\t\t<div class=\"sign-settings__sidebar\">\n\t\t\t\t\t${this.#createHead()}\n\t\t\t\t\t${this.#wizard.getLayout()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trender(): void\n\t{\n\t\tconst container = document.getElementById(this.#containerId);\n\t\tDom.append(this.#getLayout(), container);\n\t\tthis.#wizard.moveOnStep(0);\n\t}\n}\n"],"names":["B2EEmployeeSignSettings","constructor","containerId","currentSlider","BX","SidePanel","Instance","getTopSlider","Wizard","back","className","next","complete","title","Loc","getMessage","onComplete","close","swapButtons","StartProcess","render","container","document","getElementById","Dom","append","moveOnStep","Tag","signSettings","content","layout","getLayout","SignSettingsItemCounter","numerate","beforeCompletion","selectedTemplateUid","getSelectedTemplateUid","templatesList","getTemplates","submitDocumentInfo","currentTemplateSelected","find","template","uid","SubmitDocumentInfo","company","fields","sendForSign","startProcess"],"mappings":"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"}