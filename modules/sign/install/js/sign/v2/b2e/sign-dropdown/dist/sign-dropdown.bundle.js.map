{"version":3,"file":"sign-dropdown.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Tag, Dom, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Dialog, type ItemOptions } from 'ui.entity-selector';\nimport './style.css';\n\nexport type { ItemOptions };\n\nexport class SignDropdown extends EventEmitter\n{\n\tevents = {\n\t\tonSelect: 'onSelect',\n\t};\n\n\t#dom: HTMLElement;\n\t#selector: Dialog;\n\t#selectedItemId: string = '';\n\t#selectedItemCaption: string = '';\n\n\tconstructor(dialogOptions: {\n\t\tclassName?: string,\n\t\tentities: Array<{ id: string, searchFields: Array<{ id: string, system: boolean}> }>,\n\t\tisEnableSearch?: boolean,\n\t\twidth?: number,\n\t\theight?: number,\n\t\twithCaption?: boolean,\n\t\ttabs: Array<{ id: string, title: string }>})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.V2.B2e.SignDropdown');\n\n\t\tconst { className, withCaption, isEnableSearch, width, height } = dialogOptions;\n\t\tconst titleNode = withCaption\n\t\t\t? Tag.render`\n\t\t\t\t<div class=\"sign-b2e-dropdown__text\">\n\t\t\t\t\t<span class=\"sign-b2e-dropdown__text_title\"></span>\n\t\t\t\t\t<span class=\"sign-b2e-dropdown__text_caption\"></span>\n\t\t\t\t</div>\n\t\t\t`\n\t\t\t: Tag.render`<span class=\"sign-b2e-dropdown__text\"></span>`;\n\t\tthis.#dom = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"sign-b2e-dropdown\"\n\t\t\t\tonclick=\"${() => {\n\t\t\t\t\tthis.#selector.show();\n\t\t\t\t}}\"\n\t\t\t>\n\t\t\t\t${titleNode}\n\t\t\t\t<span class=\"sign-b2e-dropdown__btn\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tthis.#selector = new Dialog({\n\t\t\ttargetNode: this.#dom,\n\t\t\twidth: width ?? 500,\n\t\t\theight: height ?? 350,\n\t\t\tshowAvatars: false,\n\t\t\tdropdownMode: true,\n\t\t\tmultiple: false,\n\t\t\tenableSearch: isEnableSearch ?? true,\n\t\t\thideOnSelect: true,\n\t\t\tevents: {\n\t\t\t\t'Item:OnSelect': ({ data }) => this.#onSelect(data.item),\n\t\t\t},\n\t\t\t...dialogOptions,\n\t\t});\n\t\tif (className)\n\t\t{\n\t\t\tconst container = this.#selector.getContainer();\n\t\t\tDom.addClass(container, className);\n\t\t}\n\t}\n\n\taddItem(item: ItemOptions): void\n\t{\n\t\tthis.#selector.addItem(item);\n\t}\n\n\taddItems(items: ItemOptions[]): void\n\t{\n\t\titems.forEach((item) => this.#selector.addItem(item));\n\t}\n\n\tremoveItems(): void\n\t{\n\t\tthis.#selector.removeItems();\n\t}\n\n\tselectFirstItem(): void\n\t{\n\t\tconst [firstItem] = this.#selector.getItems();\n\t\tif (!Type.isUndefined(firstItem))\n\t\t{\n\t\t\tfirstItem.select();\n\t\t}\n\t}\n\n\tselectItem(id: string): void\n\t{\n\t\tconst items = this.#selector.getItems();\n\t\tconst foundItem = items.find((item) => item.id === id);\n\t\tif (!foundItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfoundItem.select();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.#dom;\n\t}\n\n\tgetSelectedId(): string\n\t{\n\t\treturn this.#selectedItemId;\n\t}\n\n\tgetSelectedCaption(): string\n\t{\n\t\treturn this.#selectedItemCaption;\n\t}\n\n\t#onSelect(item: ItemOptions): void\n\t{\n\t\tthis.#selectedItemId = item.id;\n\t\tconst { title, caption } = item;\n\t\tconst { firstElementChild: titleNode } = this.#dom;\n\t\tif (!caption)\n\t\t{\n\t\t\ttitleNode.textContent = title;\n\t\t\ttitleNode.title = title;\n\t\t\tthis.emit(this.events.onSelect, { item });\n\n\t\t\treturn;\n\t\t}\n\t\tthis.#selectedItemCaption = caption.text;\n\t\ttitleNode.title = `${title} ${caption}`;\n\t\ttitleNode.firstElementChild.textContent = title;\n\t\ttitleNode.lastElementChild.textContent = caption;\n\t\tthis.emit(this.events.onSelect, { item });\n\t}\n}\n"],"names":["SignDropdown","EventEmitter","constructor","dialogOptions","events","onSelect","setEventNamespace","className","withCaption","isEnableSearch","width","height","titleNode","Tag","render","show","Dialog","targetNode","showAvatars","dropdownMode","multiple","enableSearch","hideOnSelect","data","item","container","getContainer","Dom","addClass","addItem","addItems","items","forEach","removeItems","selectFirstItem","firstItem","getItems","Type","isUndefined","select","selectItem","id","foundItem","find","getLayout","getSelectedId","getSelectedCaption","title","caption","firstElementChild","textContent","emit","text","lastElementChild"],"mappings":"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"}