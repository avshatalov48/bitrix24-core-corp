{"version":3,"file":"user-party-popup.bundle.js","sources":["../src/user-party-popup.js"],"sourcesContent":["import { Tag, Text, Dom, Loc, Browser } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Api } from 'sign.v2.api';\nimport { Loader } from 'main.loader';\nimport 'main.polyfill.intersectionobserver';\nimport './user-party-popup.css';\n\nconst pageSize = 20;\n\ntype PopupOptions = {\n\tbindElement: HTMLElement,\n};\n\ntype Department = {\n\tid: number,\n\tname: string,\n};\n\ntype Member = {\n\tmemberId: number,\n\tuserId: number,\n\tname: string,\n\tavatar: string,\n\tprofileUrl: string,\n}\n\ntype ResponseDepartments = {\n\tdepartments: Array<Department>,\n};\n\ntype ResponseMembers = {\n\tmembers: Array<Member>,\n};\n\nexport class UserPartyPopup\n{\n\t#popup: Popup = null;\n\n\t#api: Api;\n\n\t#options: PopupOptions = {};\n\n\t#ui = {\n\t\tmembersContent: HTMLDivElement = null,\n\t\tdepartmentsContent: HTMLDivElement = null,\n\t\ttabs: HTMLElement = null,\n\t};\n\n\t#loader: Loader;\n\n\t#documentUid: string = null;\n\n\t#membersObserver: IntersectionObserver;\n\t#departmentsObserver: IntersectionObserver;\n\n\t#initialized: boolean = false;\n\t#membersLoaded: boolean = false;\n\t#departmentsLoaded: boolean = false;\n\n\t#membersLoadingLocked: boolean = false;\n\t#departmentsLoadingLocked: boolean = false;\n\n\tconstructor(options: PopupOptions)\n\t{\n\t\tthis.#options = options;\n\t\tthis.#api = new Api();\n\n\t\tconst observerOptions = {\n\t\t\t// rootMargin: (Browser.isMobile() ? '0%' : '-10% 0% -10% 0%'),\n\t\t\tthreshold: 0.1,\n\t\t};\n\n\t\tthis.#membersObserver = new IntersectionObserver((entries) => {\n\t\t\tentries.forEach((entry) => {\n\t\t\t\tif (!this.#membersLoaded && entry.isIntersecting)\n\t\t\t\t{\n\t\t\t\t\tthis.#membersObserver.unobserve(entry.target);\n\t\t\t\t\tthis.#loadNextMembersPage().then((members: Member[]) => {\n\t\t\t\t\t\tif (members.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#appendMembersToPopup(members);\n\t\t\t\t\t\t\tif (members.length >= pageSize)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.#membersObserver.observe(this.#ui.membersContent.lastChild);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}, observerOptions);\n\n\t\tthis.#departmentsObserver = new IntersectionObserver(((entries) => {\n\t\t\tentries.forEach((entry) => {\n\t\t\t\tif (!this.#departmentsLoaded && entry.isIntersecting)\n\t\t\t\t{\n\t\t\t\t\tthis.#departmentsObserver.unobserve(entry.target);\n\t\t\t\t\tthis.#loadNextDepartmentsPage().then((departments: Department[]) => {\n\t\t\t\t\t\tif (departments.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#appendDepartmentsToPopup(departments);\n\t\t\t\t\t\t\tif (departments.length >= pageSize)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.#departmentsObserver.observe(this.#ui.departmentsContent.lastChild);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}), observerOptions);\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#getPopup().show();\n\n\t\tif (this.#initialized === false)\n\t\t{\n\t\t\tthis.#loader.show();\n\t\t\tDom.clean(this.#ui.membersContent);\n\t\t\tDom.clean(this.#ui.departmentsContent);\n\n\t\t\tthis.#init().then(async () => {\n\t\t\t\tthis.#loader.hide();\n\t\t\t\tthis.#initialized = true;\n\t\t\t});\n\t\t}\n\t}\n\n\tasync #init(): Promise\n\t{\n\t\tconst [members, departments] = await Promise.all([\n\t\t\tthis.#loadMembersPage(1),\n\t\t\tthis.#loadDepartmentsPage(1),\n\t\t]);\n\n\t\tif (members.length > 0)\n\t\t{\n\t\t\tthis.#appendMembersToPopup(members);\n\t\t\tif (members.length >= pageSize)\n\t\t\t{\n\t\t\t\tthis.#membersObserver.observe(this.#ui.membersContent.lastChild);\n\t\t\t}\n\t\t}\n\n\t\tif (departments.length > 0)\n\t\t{\n\t\t\tthis.#appendDepartmentsToPopup(departments);\n\t\t\tif (departments.length >= pageSize)\n\t\t\t{\n\t\t\t\tthis.#departmentsObserver.observe(this.#ui.departmentsContent.lastChild);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetDocumentUid(documentUid: string): UserPartyPopup\n\t{\n\t\tthis.#documentUid = documentUid;\n\n\t\treturn this;\n\t}\n\n\tresetData(): UserPartyPopup\n\t{\n\t\tDom.clean(this.#ui.membersContent);\n\t\tDom.clean(this.#ui.departmentsContent);\n\n\t\tthis.#initialized = false;\n\t\tthis.#membersLoaded = false;\n\t\tthis.#departmentsLoaded = false;\n\n\t\treturn this;\n\t}\n\n\t#getPopup(): Popup\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\treturn this.#createPopup();\n\t\t}\n\n\t\treturn this.#popup;\n\t}\n\n\t#createPopup(): Popup\n\t{\n\t\tthis.#popup = new Popup({\n\t\t\tcontent: this.#renderContent(),\n\t\t\tbindElement: this.#options.bindElement,\n\t\t\t// height: 250,\n\t\t\twidth: 330,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t});\n\n\t\treturn this.#popup;\n\t}\n\n\t#renderContent(): HTMLElement\n\t{\n\t\tconst membersOnclick = (e) => {\n\t\t\tthis.#switchTab('members');\n\t\t\te.preventDefault();\n\t\t};\n\n\t\tconst departmentsOnclick = (e) => {\n\t\t\tthis.#switchTab('departments');\n\t\t\te.preventDefault();\n\t\t};\n\n\t\tthis.#ui.tabs = Tag.render`\n\t\t\t<span class=\"bx-user-party-popup-popup-head\">\n\t\t\t\t<span onclick=\"${membersOnclick}\" class=\"bx-user-party-popup-popup-head-item --member bx-user-party-popup-popup-head-item-current\">\n\t\t\t\t\t<span class=\"bx-user-party-popup-popup-head-icon\"></span>\n\t\t\t\t\t<span class=\"bx-user-party-popup-popup-head-text\">${Loc.getMessage('SIGN_USER_PARTY_POPUP_TAB_MEMBERS')}</span>\n\t\t\t\t</span>\n\t\t\t\t<span onclick=\"${departmentsOnclick}\" class=\"bx-user-party-popup-popup-head-item --department\">\n\t\t\t\t\t<span class=\"bx-user-party-popup-popup-head-icon\"></span>\n\t\t\t\t\t<span class=\"bx-user-party-popup-popup-head-text\">${Loc.getMessage('SIGN_USER_PARTY_POPUP_TAB_DEPARTMENTS')}</span>\n\t\t\t\t</span>\n\t\t\t</span>\n\t\t`;\n\n\t\tthis.#ui.membersContent = Tag.render`<div class=\"bx-user-party-popup-popup-content-container\"></div>`;\n\n\t\tthis.#ui.departmentsContent = Tag.render`\n\t\t\t<div class=\"bx-user-party-popup-popup-content-container bx-user-party-popup-popup-content-invisible\"></div>\n\t\t`;\n\n\t\tconst wrapper = Tag.render`\n\t\t\t<div class=\"bx-sign-user-party-popup\">\n\t\t\t\t${this.#ui.tabs}\n\t\t\t\t${this.#ui.membersContent}\n\t\t\t\t${this.#ui.departmentsContent}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#loader = new Loader({ size: 80, target: wrapper, offset: { top: '10px' } });\n\n\t\treturn wrapper;\n\t}\n\n\t#switchTab(tab: string): void\n\t{\n\t\tswitch (tab)\n\t\t{\n\t\t\tcase 'departments':\n\t\t\t\tDom.removeClass(this.#ui.departmentsContent, 'bx-user-party-popup-popup-content-invisible');\n\t\t\t\tDom.addClass(this.#ui.membersContent, 'bx-user-party-popup-popup-content-invisible');\n\n\t\t\t\tDom.removeClass(\n\t\t\t\t\tthis.#ui.tabs.querySelector('.bx-user-party-popup-popup-head-item.--member'),\n\t\t\t\t\t'bx-user-party-popup-popup-head-item-current',\n\t\t\t\t);\n\t\t\t\tDom.addClass(\n\t\t\t\t\tthis.#ui.tabs.querySelector('.bx-user-party-popup-popup-head-item.--department'),\n\t\t\t\t\t'bx-user-party-popup-popup-head-item-current',\n\t\t\t\t);\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'members':\n\t\t\tdefault:\n\t\t\t\tDom.removeClass(this.#ui.membersContent, 'bx-user-party-popup-popup-content-invisible');\n\t\t\t\tDom.addClass(this.#ui.departmentsContent, 'bx-user-party-popup-popup-content-invisible');\n\n\t\t\t\tDom.removeClass(\n\t\t\t\t\tthis.#ui.tabs.querySelector('.bx-user-party-popup-popup-head-item.--department'),\n\t\t\t\t\t'bx-user-party-popup-popup-head-item-current',\n\t\t\t\t);\n\t\t\t\tDom.addClass(\n\t\t\t\t\tthis.#ui.tabs.querySelector('.bx-user-party-popup-popup-head-item.--member'),\n\t\t\t\t\t'bx-user-party-popup-popup-head-item-current',\n\t\t\t\t);\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tasync #loadNextMembersPage(): Promise<Member[]>\n\t{\n\t\tif (this.#membersLoadingLocked === true)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tthis.#membersLoadingLocked = true;\n\t\tconst page = Math.ceil(this.#ui.membersContent.children.length / pageSize) + 1;\n\t\tconst newMembers = await this.#loadMembersPage(page);\n\n\t\tif (newMembers.length === 0)\n\t\t{\n\t\t\tthis.#membersLoaded = true;\n\t\t}\n\n\t\tthis.#membersLoadingLocked = false;\n\n\t\treturn newMembers;\n\t}\n\n\tasync #loadNextDepartmentsPage(): Promise<Department[]>\n\t{\n\t\tif (this.#departmentsLoadingLocked === true)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tthis.#departmentsLoadingLocked = true;\n\n\t\tconst page = Math.ceil(this.#ui.departmentsContent.children.length / pageSize) + 1;\n\t\tconst newDepartments = await this.#loadDepartmentsPage(page);\n\n\t\tif (newDepartments.length === 0)\n\t\t{\n\t\t\tthis.#departmentsLoaded = true;\n\t\t}\n\n\t\tthis.#departmentsLoadingLocked = false;\n\n\t\treturn newDepartments;\n\t}\n\n\tasync #loadMembersPage(page: number): Promise<Member[]>\n\t{\n\t\tconst response: ResponseMembers = await this.#api.getMembersForDocument(this.#documentUid, page, pageSize);\n\n\t\treturn response?.members || [];\n\t}\n\n\tasync #loadDepartmentsPage(page: number): Promise<Department[]>\n\t{\n\t\tconst response: ResponseDepartments = await this.#api.getDepartmentsForDocument(this.#documentUid, page, pageSize);\n\n\t\treturn response?.departments || [];\n\t}\n\n\t#appendDepartmentsToPopup(departments: Array): void\n\t{\n\t\tdepartments.forEach((department: Department) => {\n\t\t\tconst deptName = Text.encode(department.name);\n\t\t\tthis.#ui.departmentsContent.append(Tag.render`\n\t\t\t\t<div data-department-id=\"${Text.encode(department.id)}\" class=\"bx-user-party-popup-popup-user-item --department\">\n\t\t\t\t\t<span class=\"bx-user-party-popup-popup-user-icon --default\"></span>\n\t\t\t\t\t<span class=\"bx-user-party-popup-popup-user-name\" title=\"${deptName}\">${deptName}</span>\n\t\t\t\t</div>\n\t\t\t`);\n\t\t});\n\t}\n\n\t#appendMembersToPopup(members: Array): void\n\t{\n\t\tmembers.forEach((member: Member) => {\n\t\t\tconst memberName = Text.encode(member.name);\n\t\t\tconst avatar = Tag.render`<span class=\"bx-user-party-popup-popup-user-icon\"></span>`;\n\n\t\t\tthis.#ui.membersContent.append(Tag.render`\n\t\t\t\t<a href=\"${Text.encode(member.profileUrl)}\" data-member-id=\"${Text.encode(member.memberId)}\" class=\"bx-user-party-popup-popup-user-item --user\">\n\t\t\t\t\t${avatar}\n\t\t\t\t\t<span class=\"bx-user-party-popup-popup-user-name\" title=\"${memberName}\">${memberName}</span>\n\t\t\t\t</a>\n\t\t\t`);\n\n\t\t\tif (member.avatar)\n\t\t\t{\n\t\t\t\tconst avatarUrl = Text.encode(`data:image;base64,${member.avatar}`);\n\t\t\t\tDom.style(avatar, 'backgroundImage', `url('${avatarUrl}')`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(avatar, '--default');\n\t\t\t}\n\t\t});\n\t}\n}\n"],"names":["pageSize","UserPartyPopup","constructor","options","membersContent","HTMLDivElement","departmentsContent","tabs","HTMLElement","Api","observerOptions","threshold","IntersectionObserver","entries","forEach","entry","isIntersecting","unobserve","target","then","members","length","observe","lastChild","departments","show","Dom","clean","hide","setDocumentUid","documentUid","resetData","Promise","all","Popup","content","bindElement","width","autoHide","closeByEsc","membersOnclick","e","preventDefault","departmentsOnclick","Tag","render","Loc","getMessage","wrapper","Loader","size","offset","top","tab","removeClass","addClass","querySelector","page","Math","ceil","children","newMembers","newDepartments","response","getMembersForDocument","getDepartmentsForDocument","department","deptName","Text","encode","name","append","id","member","memberName","avatar","profileUrl","memberId","avatarUrl","style"],"mappings":";;;;;;;;;;;;;;;AAAA,CAOA,MAAMA,QAAQ,GAAG,EAAE;CAAC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AA2BpB,CAAO,MAAMC,cAAc,CAC3B;GA2BCC,WAAW,CAACC,OAAqB,EACjC;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA,OA3BgB;;KAAI;OAAA;OAAA;;KAAA;OAAA;OAAA,OAIK;;KAAE;OAAA;OAAA,OAErB;SACLC,cAAc,EAAEC,cAAc,GAAG,IAAI;SACrCC,kBAAkB,EAAED,cAAc,GAAG,IAAI;SACzCE,IAAI,EAAEC,WAAW,GAAG;;;KACpB;OAAA;OAAA;;KAAA;OAAA;OAAA,OAIsB;;KAAI;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA,OAKH;;KAAK;OAAA;OAAA,OACH;;KAAK;OAAA;OAAA,OACD;;KAAK;OAAA;OAAA,OAEF;;KAAK;OAAA;OAAA,OACD;;KAIpC,4CAAI,wBAAYL,OAAO;KACvB,4CAAI,gBAAQ,IAAIM,eAAG,EAAE;KAErB,MAAMC,eAAe,GAAG;;OAEvBC,SAAS,EAAE;MACX;KAED,4CAAI,wCAAoB,IAAIC,oBAAoB,CAAEC,OAAO,IAAK;OAC7DA,OAAO,CAACC,OAAO,CAAEC,KAAK,IAAK;SAC1B,IAAI,yCAAC,IAAI,iCAAe,IAAIA,KAAK,CAACC,cAAc,EAChD;WACC,4CAAI,sCAAkBC,SAAS,CAACF,KAAK,CAACG,MAAM,CAAC;WAC7C,4CAAI,gDAAwBC,IAAI,CAAEC,OAAiB,IAAK;aACvD,IAAIA,OAAO,CAACC,MAAM,GAAG,CAAC,EACtB;eACC,4CAAI,gDAAuBD,OAAO;eAClC,IAAIA,OAAO,CAACC,MAAM,IAAIrB,QAAQ,EAC9B;iBACC,4CAAI,sCAAkBsB,OAAO,CAAC,4CAAI,YAAKlB,cAAc,CAACmB,SAAS,CAAC;;;YAGlE,CAAC;;QAEH,CAAC;MACF,EAAEb,eAAe,CAAC;KAEnB,4CAAI,gDAAwB,IAAIE,oBAAoB,CAAGC,OAAO,IAAK;OAClEA,OAAO,CAACC,OAAO,CAAEC,KAAK,IAAK;SAC1B,IAAI,yCAAC,IAAI,yCAAmB,IAAIA,KAAK,CAACC,cAAc,EACpD;WACC,4CAAI,8CAAsBC,SAAS,CAACF,KAAK,CAACG,MAAM,CAAC;WACjD,4CAAI,wDAA4BC,IAAI,CAAEK,WAAyB,IAAK;aACnE,IAAIA,WAAW,CAACH,MAAM,GAAG,CAAC,EAC1B;eACC,4CAAI,wDAA2BG,WAAW;eAC1C,IAAIA,WAAW,CAACH,MAAM,IAAIrB,QAAQ,EAClC;iBACC,4CAAI,8CAAsBsB,OAAO,CAAC,4CAAI,YAAKhB,kBAAkB,CAACiB,SAAS,CAAC;;;YAG1E,CAAC;;QAEH,CAAC;MACF,EAAGb,eAAe,CAAC;;GAGrBe,IAAI,GACJ;KACC,4CAAI,0BAAaA,IAAI,EAAE;KAEvB,IAAI,4CAAI,kCAAkB,KAAK,EAC/B;OACC,4CAAI,oBAASA,IAAI,EAAE;OACnBC,aAAG,CAACC,KAAK,CAAC,4CAAI,YAAKvB,cAAc,CAAC;OAClCsB,aAAG,CAACC,KAAK,CAAC,4CAAI,YAAKrB,kBAAkB,CAAC;OAEtC,4CAAI,kBAASa,IAAI,CAAC,YAAY;SAC7B,4CAAI,oBAASS,IAAI,EAAE;SACnB,4CAAI,gCAAgB,IAAI;QACxB,CAAC;;;GA8BJC,cAAc,CAACC,WAAmB,EAClC;KACC,4CAAI,gCAAgBA,WAAW;KAE/B,OAAO,IAAI;;GAGZC,SAAS,GACT;KACCL,aAAG,CAACC,KAAK,CAAC,4CAAI,YAAKvB,cAAc,CAAC;KAClCsB,aAAG,CAACC,KAAK,CAAC,4CAAI,YAAKrB,kBAAkB,CAAC;KAEtC,4CAAI,gCAAgB,KAAK;KACzB,4CAAI,oCAAkB,KAAK;KAC3B,4CAAI,4CAAsB,KAAK;KAE/B,OAAO,IAAI;;CA0Mb;CAAC,wBAnPA;GACC,MAAM,CAACc,OAAO,EAAEI,WAAW,CAAC,GAAG,MAAMQ,OAAO,CAACC,GAAG,CAAC,yCAChD,IAAI,sCAAkB,CAAC,2CACvB,IAAI,8CAAsB,CAAC,EAC3B,CAAC;GAEF,IAAIb,OAAO,CAACC,MAAM,GAAG,CAAC,EACtB;KACC,4CAAI,gDAAuBD,OAAO;KAClC,IAAIA,OAAO,CAACC,MAAM,IAAIrB,QAAQ,EAC9B;OACC,4CAAI,sCAAkBsB,OAAO,CAAC,4CAAI,YAAKlB,cAAc,CAACmB,SAAS,CAAC;;;GAIlE,IAAIC,WAAW,CAACH,MAAM,GAAG,CAAC,EAC1B;KACC,4CAAI,wDAA2BG,WAAW;KAC1C,IAAIA,WAAW,CAACH,MAAM,IAAIrB,QAAQ,EAClC;OACC,4CAAI,8CAAsBsB,OAAO,CAAC,4CAAI,YAAKhB,kBAAkB,CAACiB,SAAS,CAAC;;;CAG3E;CAAC,sBAsBD;GACC,IAAI,yCAAC,IAAI,iBAAO,EAChB;KACC,+CAAO,IAAI;;GAGZ,+CAAO,IAAI;CACZ;CAAC,yBAGD;GACC,4CAAI,oBAAU,IAAIW,gBAAK,CAAC;KACvBC,OAAO,0CAAE,IAAI,mCAAiB;KAC9BC,WAAW,EAAE,4CAAI,sBAAUA,WAAW;;KAEtCC,KAAK,EAAE,GAAG;KACVC,QAAQ,EAAE,IAAI;KACdC,UAAU,EAAE;IACZ,CAAC;GAEF,+CAAO,IAAI;CACZ;CAAC,2BAGD;GACC,MAAMC,cAAc,GAAIC,CAAC,IAAK;KAC7B,4CAAI,0BAAY,SAAS;KACzBA,CAAC,CAACC,cAAc,EAAE;IAClB;GAED,MAAMC,kBAAkB,GAAIF,CAAC,IAAK;KACjC,4CAAI,0BAAY,aAAa;KAC7BA,CAAC,CAACC,cAAc,EAAE;IAClB;GAED,4CAAI,YAAKnC,IAAI,GAAGqC,aAAG,CAACC,MAAM,cAAC;;qBAEV,CAAiB;;yDAEmB,CAAsD;;qBAE1F,CAAqB;;yDAEe,CAA0D;;;GAG/G,GATmBL,cAAc,EAEsBM,aAAG,CAACC,UAAU,CAAC,mCAAmC,CAAC,EAEvFJ,kBAAkB,EAEkBG,aAAG,CAACC,UAAU,CAAC,uCAAuC,CAAC,CAG7G;GAED,4CAAI,YAAK3C,cAAc,GAAGwC,aAAG,CAACC,MAAM,gBAAC,iEAA+D,EAAC;GAErG,4CAAI,YAAKvC,kBAAkB,GAAGsC,aAAG,CAACC,MAAM,gBAAC;;GAEzC,EAAC;GAED,MAAMG,OAAO,GAAGJ,aAAG,CAACC,MAAM,gBAAC;;MAEzB,CAAgB;MAChB,CAA0B;MAC1B,CAA8B;;GAEhC,GAJI,4CAAI,YAAKtC,IAAI,EACb,4CAAI,YAAKH,cAAc,EACvB,4CAAI,YAAKE,kBAAkB,CAE9B;GAED,4CAAI,sBAAW,IAAI2C,kBAAM,CAAC;KAAEC,IAAI,EAAE,EAAE;KAAEhC,MAAM,EAAE8B,OAAO;KAAEG,MAAM,EAAE;OAAEC,GAAG,EAAE;;IAAU,CAAC;GAEjF,OAAOJ,OAAO;CACf;CAAC,qBAEUK,GAAW,EACtB;GACC,QAAQA,GAAG;KAEV,KAAK,aAAa;OACjB3B,aAAG,CAAC4B,WAAW,CAAC,4CAAI,YAAKhD,kBAAkB,EAAE,6CAA6C,CAAC;OAC3FoB,aAAG,CAAC6B,QAAQ,CAAC,4CAAI,YAAKnD,cAAc,EAAE,6CAA6C,CAAC;OAEpFsB,aAAG,CAAC4B,WAAW,CACd,4CAAI,YAAK/C,IAAI,CAACiD,aAAa,CAAC,+CAA+C,CAAC,EAC5E,6CAA6C,CAC7C;OACD9B,aAAG,CAAC6B,QAAQ,CACX,4CAAI,YAAKhD,IAAI,CAACiD,aAAa,CAAC,mDAAmD,CAAC,EAChF,6CAA6C,CAC7C;OAED;KAED,KAAK,SAAS;KACd;OACC9B,aAAG,CAAC4B,WAAW,CAAC,4CAAI,YAAKlD,cAAc,EAAE,6CAA6C,CAAC;OACvFsB,aAAG,CAAC6B,QAAQ,CAAC,4CAAI,YAAKjD,kBAAkB,EAAE,6CAA6C,CAAC;OAExFoB,aAAG,CAAC4B,WAAW,CACd,4CAAI,YAAK/C,IAAI,CAACiD,aAAa,CAAC,mDAAmD,CAAC,EAChF,6CAA6C,CAC7C;OACD9B,aAAG,CAAC6B,QAAQ,CACX,4CAAI,YAAKhD,IAAI,CAACiD,aAAa,CAAC,+CAA+C,CAAC,EAC5E,6CAA6C,CAC7C;OAED;;CAEH;CAAC,uCAGD;GACC,IAAI,4CAAI,oDAA2B,IAAI,EACvC;KACC,OAAO,EAAE;;GAGV,4CAAI,kDAAyB,IAAI;GACjC,MAAMC,IAAI,GAAGC,IAAI,CAACC,IAAI,CAAC,4CAAI,YAAKvD,cAAc,CAACwD,QAAQ,CAACvC,MAAM,GAAGrB,QAAQ,CAAC,GAAG,CAAC;GAC9E,MAAM6D,UAAU,GAAG,8CAAM,IAAI,sCAAkBJ,IAAI,CAAC;GAEpD,IAAII,UAAU,CAACxC,MAAM,KAAK,CAAC,EAC3B;KACC,4CAAI,oCAAkB,IAAI;;GAG3B,4CAAI,kDAAyB,KAAK;GAElC,OAAOwC,UAAU;CAClB;CAAC,2CAGD;GACC,IAAI,4CAAI,4DAA+B,IAAI,EAC3C;KACC,OAAO,EAAE;;GAGV,4CAAI,0DAA6B,IAAI;GAErC,MAAMJ,IAAI,GAAGC,IAAI,CAACC,IAAI,CAAC,4CAAI,YAAKrD,kBAAkB,CAACsD,QAAQ,CAACvC,MAAM,GAAGrB,QAAQ,CAAC,GAAG,CAAC;GAClF,MAAM8D,cAAc,GAAG,8CAAM,IAAI,8CAAsBL,IAAI,CAAC;GAE5D,IAAIK,cAAc,CAACzC,MAAM,KAAK,CAAC,EAC/B;KACC,4CAAI,4CAAsB,IAAI;;GAG/B,4CAAI,0DAA6B,KAAK;GAEtC,OAAOyC,cAAc;CACtB;CAAC,iCAEsBL,IAAY,EACnC;GACC,MAAMM,QAAyB,GAAG,MAAM,4CAAI,cAAMC,qBAAqB,yCAAC,IAAI,+BAAeP,IAAI,EAAEzD,QAAQ,CAAC;GAE1G,OAAO,CAAA+D,QAAQ,oBAARA,QAAQ,CAAE3C,OAAO,KAAI,EAAE;CAC/B;CAAC,qCAE0BqC,IAAY,EACvC;GACC,MAAMM,QAA6B,GAAG,MAAM,4CAAI,cAAME,yBAAyB,yCAAC,IAAI,+BAAeR,IAAI,EAAEzD,QAAQ,CAAC;GAElH,OAAO,CAAA+D,QAAQ,oBAARA,QAAQ,CAAEvC,WAAW,KAAI,EAAE;CACnC;CAAC,oCAEyBA,WAAkB,EAC5C;GACCA,WAAW,CAACV,OAAO,CAAEoD,UAAsB,IAAK;KAC/C,MAAMC,QAAQ,GAAGC,cAAI,CAACC,MAAM,CAACH,UAAU,CAACI,IAAI,CAAC;KAC7C,4CAAI,YAAKhE,kBAAkB,CAACiE,MAAM,CAAC3B,aAAG,CAACC,MAAM,gBAAC;+BACpB,CAA6B;;gEAEI,CAAW,KAAE,CAAW;;IAEnF,GAJ4BuB,cAAI,CAACC,MAAM,CAACH,UAAU,CAACM,EAAE,CAAC,EAEOL,QAAQ,EAAKA,QAAQ,EAEhF;IACF,CAAC;CACH;CAAC,gCAEqB/C,OAAc,EACpC;GACCA,OAAO,CAACN,OAAO,CAAE2D,MAAc,IAAK;KACnC,MAAMC,UAAU,GAAGN,cAAI,CAACC,MAAM,CAACI,MAAM,CAACH,IAAI,CAAC;KAC3C,MAAMK,MAAM,GAAG/B,aAAG,CAACC,MAAM,gBAAC,2DAAyD,EAAC;KAEpF,4CAAI,YAAKzC,cAAc,CAACmE,MAAM,CAAC3B,aAAG,CAACC,MAAM,gBAAC;eAChC,CAAiC,qBAAkB,CAA+B;OAC1F,CAAS;gEACgD,CAAa,KAAE,CAAa;;IAEvF,GAJYuB,cAAI,CAACC,MAAM,CAACI,MAAM,CAACG,UAAU,CAAC,EAAqBR,cAAI,CAACC,MAAM,CAACI,MAAM,CAACI,QAAQ,CAAC,EACvFF,MAAM,EACmDD,UAAU,EAAKA,UAAU,EAEpF;KAEF,IAAID,MAAM,CAACE,MAAM,EACjB;OACC,MAAMG,SAAS,GAAGV,cAAI,CAACC,MAAM,CAAE,qBAAoBI,MAAM,CAACE,MAAO,EAAC,CAAC;OACnEjD,aAAG,CAACqD,KAAK,CAACJ,MAAM,EAAE,iBAAiB,EAAG,QAAOG,SAAU,IAAG,CAAC;MAC3D,MAED;OACCpD,aAAG,CAAC6B,QAAQ,CAACoB,MAAM,EAAE,WAAW,CAAC;;IAElC,CAAC;CACH;;;;;;;;"}