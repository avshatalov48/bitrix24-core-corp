this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};(function(e,s,a,t,l){"use strict";let r=e=>e,i,o,p,b,n,d,c;const u=20;var v=babelHelpers.classPrivateFieldLooseKey("popup");var h=babelHelpers.classPrivateFieldLooseKey("api");var P=babelHelpers.classPrivateFieldLooseKey("options");var m=babelHelpers.classPrivateFieldLooseKey("ui");var L=babelHelpers.classPrivateFieldLooseKey("loader");var H=babelHelpers.classPrivateFieldLooseKey("documentUid");var F=babelHelpers.classPrivateFieldLooseKey("membersObserver");var B=babelHelpers.classPrivateFieldLooseKey("departmentsObserver");var y=babelHelpers.classPrivateFieldLooseKey("initialized");var f=babelHelpers.classPrivateFieldLooseKey("membersLoaded");var g=babelHelpers.classPrivateFieldLooseKey("departmentsLoaded");var x=babelHelpers.classPrivateFieldLooseKey("membersLoadingLocked");var C=babelHelpers.classPrivateFieldLooseKey("departmentsLoadingLocked");var O=babelHelpers.classPrivateFieldLooseKey("init");var w=babelHelpers.classPrivateFieldLooseKey("getPopup");var D=babelHelpers.classPrivateFieldLooseKey("createPopup");var T=babelHelpers.classPrivateFieldLooseKey("renderContent");var j=babelHelpers.classPrivateFieldLooseKey("switchTab");var K=babelHelpers.classPrivateFieldLooseKey("loadNextMembersPage");var S=babelHelpers.classPrivateFieldLooseKey("loadNextDepartmentsPage");var $=babelHelpers.classPrivateFieldLooseKey("loadMembersPage");var E=babelHelpers.classPrivateFieldLooseKey("loadDepartmentsPage");var M=babelHelpers.classPrivateFieldLooseKey("appendDepartmentsToPopup");var X=babelHelpers.classPrivateFieldLooseKey("appendMembersToPopup");class _{constructor(e){Object.defineProperty(this,X,{value:Y});Object.defineProperty(this,M,{value:G});Object.defineProperty(this,E,{value:z});Object.defineProperty(this,$,{value:q});Object.defineProperty(this,S,{value:V});Object.defineProperty(this,K,{value:N});Object.defineProperty(this,j,{value:R});Object.defineProperty(this,T,{value:A});Object.defineProperty(this,D,{value:k});Object.defineProperty(this,w,{value:U});Object.defineProperty(this,O,{value:I});Object.defineProperty(this,v,{writable:true,value:null});Object.defineProperty(this,h,{writable:true,value:void 0});Object.defineProperty(this,P,{writable:true,value:{}});Object.defineProperty(this,m,{writable:true,value:{membersContent:HTMLDivElement=null,departmentsContent:HTMLDivElement=null,tabs:HTMLElement=null}});Object.defineProperty(this,L,{writable:true,value:void 0});Object.defineProperty(this,H,{writable:true,value:null});Object.defineProperty(this,F,{writable:true,value:void 0});Object.defineProperty(this,B,{writable:true,value:void 0});Object.defineProperty(this,y,{writable:true,value:false});Object.defineProperty(this,f,{writable:true,value:false});Object.defineProperty(this,g,{writable:true,value:false});Object.defineProperty(this,x,{writable:true,value:false});Object.defineProperty(this,C,{writable:true,value:false});babelHelpers.classPrivateFieldLooseBase(this,P)[P]=e;babelHelpers.classPrivateFieldLooseBase(this,h)[h]=new t.Api;const s={threshold:.1};babelHelpers.classPrivateFieldLooseBase(this,F)[F]=new IntersectionObserver((e=>{e.forEach((e=>{if(!babelHelpers.classPrivateFieldLooseBase(this,f)[f]&&e.isIntersecting){babelHelpers.classPrivateFieldLooseBase(this,F)[F].unobserve(e.target);babelHelpers.classPrivateFieldLooseBase(this,K)[K]().then((e=>{if(e.length>0){babelHelpers.classPrivateFieldLooseBase(this,X)[X](e);if(e.length>=u){babelHelpers.classPrivateFieldLooseBase(this,F)[F].observe(babelHelpers.classPrivateFieldLooseBase(this,m)[m].membersContent.lastChild)}}}))}}))}),s);babelHelpers.classPrivateFieldLooseBase(this,B)[B]=new IntersectionObserver((e=>{e.forEach((e=>{if(!babelHelpers.classPrivateFieldLooseBase(this,g)[g]&&e.isIntersecting){babelHelpers.classPrivateFieldLooseBase(this,B)[B].unobserve(e.target);babelHelpers.classPrivateFieldLooseBase(this,S)[S]().then((e=>{if(e.length>0){babelHelpers.classPrivateFieldLooseBase(this,M)[M](e);if(e.length>=u){babelHelpers.classPrivateFieldLooseBase(this,B)[B].observe(babelHelpers.classPrivateFieldLooseBase(this,m)[m].departmentsContent.lastChild)}}}))}}))}),s)}show(){babelHelpers.classPrivateFieldLooseBase(this,w)[w]().show();if(babelHelpers.classPrivateFieldLooseBase(this,y)[y]===false){babelHelpers.classPrivateFieldLooseBase(this,L)[L].show();s.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,m)[m].membersContent);s.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,m)[m].departmentsContent);babelHelpers.classPrivateFieldLooseBase(this,O)[O]().then((async()=>{babelHelpers.classPrivateFieldLooseBase(this,L)[L].hide();babelHelpers.classPrivateFieldLooseBase(this,y)[y]=true}))}}setDocumentUid(e){babelHelpers.classPrivateFieldLooseBase(this,H)[H]=e;return this}resetData(){s.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,m)[m].membersContent);s.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,m)[m].departmentsContent);babelHelpers.classPrivateFieldLooseBase(this,y)[y]=false;babelHelpers.classPrivateFieldLooseBase(this,f)[f]=false;babelHelpers.classPrivateFieldLooseBase(this,g)[g]=false;return this}}async function I(){const[e,s]=await Promise.all([babelHelpers.classPrivateFieldLooseBase(this,$)[$](1),babelHelpers.classPrivateFieldLooseBase(this,E)[E](1)]);if(e.length>0){babelHelpers.classPrivateFieldLooseBase(this,X)[X](e);if(e.length>=u){babelHelpers.classPrivateFieldLooseBase(this,F)[F].observe(babelHelpers.classPrivateFieldLooseBase(this,m)[m].membersContent.lastChild)}}if(s.length>0){babelHelpers.classPrivateFieldLooseBase(this,M)[M](s);if(s.length>=u){babelHelpers.classPrivateFieldLooseBase(this,B)[B].observe(babelHelpers.classPrivateFieldLooseBase(this,m)[m].departmentsContent.lastChild)}}}function U(){if(!babelHelpers.classPrivateFieldLooseBase(this,v)[v]){return babelHelpers.classPrivateFieldLooseBase(this,D)[D]()}return babelHelpers.classPrivateFieldLooseBase(this,v)[v]}function k(){babelHelpers.classPrivateFieldLooseBase(this,v)[v]=new a.Popup({content:babelHelpers.classPrivateFieldLooseBase(this,T)[T](),bindElement:babelHelpers.classPrivateFieldLooseBase(this,P)[P].bindElement,width:330,autoHide:true,closeByEsc:true});return babelHelpers.classPrivateFieldLooseBase(this,v)[v]}function A(){const e=e=>{babelHelpers.classPrivateFieldLooseBase(this,j)[j]("members");e.preventDefault()};const a=e=>{babelHelpers.classPrivateFieldLooseBase(this,j)[j]("departments");e.preventDefault()};babelHelpers.classPrivateFieldLooseBase(this,m)[m].tabs=s.Tag.render(i||(i=r`
			<span class="bx-user-party-popup-popup-head">
				<span onclick="${0}" class="bx-user-party-popup-popup-head-item --member bx-user-party-popup-popup-head-item-current">
					<span class="bx-user-party-popup-popup-head-icon"></span>
					<span class="bx-user-party-popup-popup-head-text">${0}</span>
				</span>
				<span onclick="${0}" class="bx-user-party-popup-popup-head-item --department">
					<span class="bx-user-party-popup-popup-head-icon"></span>
					<span class="bx-user-party-popup-popup-head-text">${0}</span>
				</span>
			</span>
		`),e,s.Loc.getMessage("SIGN_USER_PARTY_POPUP_TAB_MEMBERS"),a,s.Loc.getMessage("SIGN_USER_PARTY_POPUP_TAB_DEPARTMENTS"));babelHelpers.classPrivateFieldLooseBase(this,m)[m].membersContent=s.Tag.render(o||(o=r`<div class="bx-user-party-popup-popup-content-container"></div>`));babelHelpers.classPrivateFieldLooseBase(this,m)[m].departmentsContent=s.Tag.render(p||(p=r`
			<div class="bx-user-party-popup-popup-content-container bx-user-party-popup-popup-content-invisible"></div>
		`));const t=s.Tag.render(b||(b=r`
			<div class="bx-sign-user-party-popup">
				${0}
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,m)[m].tabs,babelHelpers.classPrivateFieldLooseBase(this,m)[m].membersContent,babelHelpers.classPrivateFieldLooseBase(this,m)[m].departmentsContent);babelHelpers.classPrivateFieldLooseBase(this,L)[L]=new l.Loader({size:80,target:t,offset:{top:"10px"}});return t}function R(e){switch(e){case"departments":s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,m)[m].departmentsContent,"bx-user-party-popup-popup-content-invisible");s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,m)[m].membersContent,"bx-user-party-popup-popup-content-invisible");s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,m)[m].tabs.querySelector(".bx-user-party-popup-popup-head-item.--member"),"bx-user-party-popup-popup-head-item-current");s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,m)[m].tabs.querySelector(".bx-user-party-popup-popup-head-item.--department"),"bx-user-party-popup-popup-head-item-current");break;case"members":default:s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,m)[m].membersContent,"bx-user-party-popup-popup-content-invisible");s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,m)[m].departmentsContent,"bx-user-party-popup-popup-content-invisible");s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,m)[m].tabs.querySelector(".bx-user-party-popup-popup-head-item.--department"),"bx-user-party-popup-popup-head-item-current");s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,m)[m].tabs.querySelector(".bx-user-party-popup-popup-head-item.--member"),"bx-user-party-popup-popup-head-item-current");break}}async function N(){if(babelHelpers.classPrivateFieldLooseBase(this,x)[x]===true){return[]}babelHelpers.classPrivateFieldLooseBase(this,x)[x]=true;const e=Math.ceil(babelHelpers.classPrivateFieldLooseBase(this,m)[m].membersContent.children.length/u)+1;const s=await babelHelpers.classPrivateFieldLooseBase(this,$)[$](e);if(s.length===0){babelHelpers.classPrivateFieldLooseBase(this,f)[f]=true}babelHelpers.classPrivateFieldLooseBase(this,x)[x]=false;return s}async function V(){if(babelHelpers.classPrivateFieldLooseBase(this,C)[C]===true){return[]}babelHelpers.classPrivateFieldLooseBase(this,C)[C]=true;const e=Math.ceil(babelHelpers.classPrivateFieldLooseBase(this,m)[m].departmentsContent.children.length/u)+1;const s=await babelHelpers.classPrivateFieldLooseBase(this,E)[E](e);if(s.length===0){babelHelpers.classPrivateFieldLooseBase(this,g)[g]=true}babelHelpers.classPrivateFieldLooseBase(this,C)[C]=false;return s}async function q(e){const s=await babelHelpers.classPrivateFieldLooseBase(this,h)[h].getMembersForDocument(babelHelpers.classPrivateFieldLooseBase(this,H)[H],e,u);return(s==null?void 0:s.members)||[]}async function z(e){const s=await babelHelpers.classPrivateFieldLooseBase(this,h)[h].getDepartmentsForDocument(babelHelpers.classPrivateFieldLooseBase(this,H)[H],e,u);return(s==null?void 0:s.departments)||[]}function G(e){e.forEach((e=>{const a=s.Text.encode(e.name);babelHelpers.classPrivateFieldLooseBase(this,m)[m].departmentsContent.append(s.Tag.render(n||(n=r`
				<div data-department-id="${0}" class="bx-user-party-popup-popup-user-item --department">
					<span class="bx-user-party-popup-popup-user-icon --default"></span>
					<span class="bx-user-party-popup-popup-user-name" title="${0}">${0}</span>
				</div>
			`),s.Text.encode(e.id),a,a))}))}function Y(e){e.forEach((e=>{const a=s.Text.encode(e.name);const t=s.Tag.render(d||(d=r`<span class="bx-user-party-popup-popup-user-icon"></span>`));babelHelpers.classPrivateFieldLooseBase(this,m)[m].membersContent.append(s.Tag.render(c||(c=r`
				<a href="${0}" data-member-id="${0}" class="bx-user-party-popup-popup-user-item --user">
					${0}
					<span class="bx-user-party-popup-popup-user-name" title="${0}">${0}</span>
				</a>
			`),s.Text.encode(e.profileUrl),s.Text.encode(e.memberId),t,a,a));if(e.avatar){const a=s.Text.encode(`data:image;base64,${e.avatar}`);s.Dom.style(t,"backgroundImage",`url('${a}')`)}else{s.Dom.addClass(t,"--default")}}))}e.UserPartyPopup=_})(this.BX.Sign.V2.B2e=this.BX.Sign.V2.B2e||{},BX,BX.Main,BX.Sign.V2,BX);
//# sourceMappingURL=user-party-popup.bundle.map.js