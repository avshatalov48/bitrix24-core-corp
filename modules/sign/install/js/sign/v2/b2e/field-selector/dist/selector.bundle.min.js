this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};(function(e,s,t,l,i,a){"use strict";const r="sign.api_v1.b2e.fields.load";var o=babelHelpers.classPrivateFieldLooseKey("options");var n=babelHelpers.classPrivateFieldLooseKey("request");var c=babelHelpers.classPrivateFieldLooseKey("getUri");class b extends i.EventEmitter{constructor(e){super();Object.defineProperty(this,c,{value:p});Object.defineProperty(this,n,{value:d});Object.defineProperty(this,o,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,o)[o]=e;this.setEventNamespace("BX.Sign.B2E.FieldsSelector.Backend");this.subscribeFromOptions(babelHelpers.classPrivateFieldLooseBase(this,o)[o].events)}setCustomSettings(e){babelHelpers.classPrivateFieldLooseBase(this,o)[o]={...babelHelpers.classPrivateFieldLooseBase(this,o)[o],customSettings:e}}getData(e={}){var s,t;return babelHelpers.classPrivateFieldLooseBase(this,n)[n]({data:{...e,...(s=(t=babelHelpers.classPrivateFieldLooseBase(this,o)[o].customSettings)==null?void 0:t.requestOptions)!=null?s:{}}})}}function d(e){return new Promise(((s,t)=>{a.ajax.runAction(babelHelpers.classPrivateFieldLooseBase(this,c)[c](),{json:e.data}).then(s).catch(t)}))}function p(){var e;if(a.Type.isStringFilled((e=babelHelpers.classPrivateFieldLooseBase(this,o)[o].customSettings)==null?void 0:e.uri)){return babelHelpers.classPrivateFieldLooseBase(this,o)[o].customSettings.uri}return r}let v=e=>e,u,F,P;var h=babelHelpers.classPrivateFieldLooseKey("cache");var L=babelHelpers.classPrivateFieldLooseKey("setOptions");var y=babelHelpers.classPrivateFieldLooseKey("getOptions");var f=babelHelpers.classPrivateFieldLooseKey("onInput");var H=babelHelpers.classPrivateFieldLooseKey("getDebounceWrapper");var B=babelHelpers.classPrivateFieldLooseKey("getInput");var g=babelHelpers.classPrivateFieldLooseKey("onClearClick");var m=babelHelpers.classPrivateFieldLooseKey("getClearButton");class O extends i.EventEmitter{constructor(e={}){super();Object.defineProperty(this,m,{value:I});Object.defineProperty(this,g,{value:K});Object.defineProperty(this,B,{value:E});Object.defineProperty(this,H,{value:j});Object.defineProperty(this,f,{value:C});Object.defineProperty(this,y,{value:S});Object.defineProperty(this,L,{value:T});Object.defineProperty(this,h,{writable:true,value:new a.Cache.MemoryCache});this.setEventNamespace("BX.Sign.B2E.Fields.Selector.Search");this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,L)[L](e)}getValue(){return babelHelpers.classPrivateFieldLooseBase(this,B)[B]().value}setValue(e){babelHelpers.classPrivateFieldLooseBase(this,B)[B]().value=e;babelHelpers.classPrivateFieldLooseBase(this,f)[f]()}getLayout(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h].remember("layout",(()=>a.Tag.render(u||(u=v`
				<div class="sign-b2e-fields-selector-search">
					<div class="ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-before-icon ui-ctl-after-icon">
						<div class="ui-ctl-before ui-ctl-icon-search"></div>
						${0}
						${0}
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,m)[m](),babelHelpers.classPrivateFieldLooseBase(this,B)[B]())))}}function T(e){babelHelpers.classPrivateFieldLooseBase(this,h)[h].set("options",{...e})}function S(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h].get("options",{})}function C(){this.emit("onChange",{value:babelHelpers.classPrivateFieldLooseBase(this,B)[B]().value});babelHelpers.classPrivateFieldLooseBase(this,H)[H]()()}function j(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h].remember("debounceWrapper",(()=>a.Runtime.debounce((()=>{this.emit("onDebouncedChange",{value:babelHelpers.classPrivateFieldLooseBase(this,B)[B]().value})}),50)))}function E(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h].remember("input",(()=>{const e=(()=>{if(a.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,y)[y]().initialValue)){return babelHelpers.classPrivateFieldLooseBase(this,y)[y]().initialValue}return""})();return a.Tag.render(F||(F=v`
				<input 
					type="text" 
					class="ui-ctl-element" 
					oninput="${0}"
					value="${0}"
					placeholder="${0}"
				>
			`),babelHelpers.classPrivateFieldLooseBase(this,f)[f].bind(this),a.Text.encode(e),a.Loc.getMessage("SIGN_B2E_FIELDS_SELECTOR_SEARCH_PLACEHOLDER"))}))}function K(e){e.preventDefault();babelHelpers.classPrivateFieldLooseBase(this,B)[B]().value="";babelHelpers.classPrivateFieldLooseBase(this,f)[f]()}function I(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h].remember("clearButton",(()=>a.Tag.render(P||(P=v`
				<button 
					class="ui-ctl-after ui-ctl-icon-clear" 
					onclick="${0}"
				></button>
			`),babelHelpers.classPrivateFieldLooseBase(this,g)[g].bind(this))))}let A=e=>e,_,D;var w=babelHelpers.classPrivateFieldLooseKey("cache");var R=babelHelpers.classPrivateFieldLooseKey("setOptions");var N=babelHelpers.classPrivateFieldLooseKey("getOptions");var k=babelHelpers.classPrivateFieldLooseKey("onChange");var M=babelHelpers.classPrivateFieldLooseKey("getCheckbox");var X=babelHelpers.classPrivateFieldLooseKey("isDisabled");class x extends i.EventEmitter{constructor(e){super();Object.defineProperty(this,X,{value:Y});Object.defineProperty(this,M,{value:V});Object.defineProperty(this,k,{value:G});Object.defineProperty(this,N,{value:$});Object.defineProperty(this,R,{value:U});Object.defineProperty(this,w,{writable:true,value:new a.Cache.MemoryCache});this.setEventNamespace("BX.Sign.B2E.FieldSelector.ListItem");this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,R)[R](e);const{targetContainer:s}=e;if(a.Type.isDomNode(s)){this.renderTo(s)}}getField(){return babelHelpers.classPrivateFieldLooseBase(this,N)[N]().field}isSelected(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M]().checked}getLayout(){return babelHelpers.classPrivateFieldLooseBase(this,w)[w].remember(`layout`,(()=>{const e="sign-b2e-fields-selector-field--disabled";return a.Tag.render(_||(_=A`
				<div class="sign-b2e-fields-selector-field${0}">
					<label class="ui-ctl ui-ctl-checkbox sign-b2e-fields-selector-field-checkbox">
						${0}
						<div class="ui-ctl-label-text">${0}</div>
					</label>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,X)[X]()?" "+e:"",babelHelpers.classPrivateFieldLooseBase(this,M)[M](),a.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,N)[N]().field.caption))}))}renderTo(e){if(a.Type.isDomNode(e)){a.Dom.append(this.getLayout(),e)}}}function U(e){babelHelpers.classPrivateFieldLooseBase(this,w)[w].set("options",{type:x.Type.CHECKBOX,...e})}function $(){return babelHelpers.classPrivateFieldLooseBase(this,w)[w].get("options",{})}function G(){this.emit("onChange")}function V(){return babelHelpers.classPrivateFieldLooseBase(this,w)[w].remember("checkbox",(()=>a.Tag.render(D||(D=A`
				<input 
					type="${0}" 
					class="ui-ctl-element"
					onchange="${0}"
					name="SIGN_B2E_SELECTOR_ITEM"
					${0}
				>
			`),a.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,N)[N]().type),babelHelpers.classPrivateFieldLooseBase(this,k)[k].bind(this),babelHelpers.classPrivateFieldLooseBase(this,N)[N]().selected?"checked":"")))}function Y(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,N)[N]().disabled)!=null?e:false}x.Type={CHECKBOX:"checkbox",RADIO:"radio"};let W=e=>e,q,z,J;const Q="crm";var Z=babelHelpers.classPrivateFieldLooseKey("cache");var ee=babelHelpers.classPrivateFieldLooseKey("defaultFilter");var se=babelHelpers.classPrivateFieldLooseKey("defaultFieldsFactoryFilter");var te=babelHelpers.classPrivateFieldLooseKey("permissionAddByCategory");var le=babelHelpers.classPrivateFieldLooseKey("setOptions");var ie=babelHelpers.classPrivateFieldLooseKey("getOptions");var ae=babelHelpers.classPrivateFieldLooseKey("getBackend");var re=babelHelpers.classPrivateFieldLooseKey("setFieldsList");var oe=babelHelpers.classPrivateFieldLooseKey("applyCategoriesFilter");var ne=babelHelpers.classPrivateFieldLooseKey("applyFieldsFilter");var ce=babelHelpers.classPrivateFieldLooseKey("applySearchFilter");var be=babelHelpers.classPrivateFieldLooseKey("load");var de=babelHelpers.classPrivateFieldLooseKey("setIsLeadEnabled");var pe=babelHelpers.classPrivateFieldLooseKey("isLeadEnabled");var ve=babelHelpers.classPrivateFieldLooseKey("setIsAllowedCreateField");var ue=babelHelpers.classPrivateFieldLooseKey("isAllowedCreateField");var Fe=babelHelpers.classPrivateFieldLooseKey("getSidebarItems");var Pe=babelHelpers.classPrivateFieldLooseKey("getFilter");var he=babelHelpers.classPrivateFieldLooseKey("cleanFieldsList");var Le=babelHelpers.classPrivateFieldLooseKey("getSelectedFields");var ye=babelHelpers.classPrivateFieldLooseKey("addSelectedField");var fe=babelHelpers.classPrivateFieldLooseKey("removeSelectedField");var He=babelHelpers.classPrivateFieldLooseKey("setSelectedFields");var Be=babelHelpers.classPrivateFieldLooseKey("isMultiple");var ge=babelHelpers.classPrivateFieldLooseKey("renderCategoryFields");var me=babelHelpers.classPrivateFieldLooseKey("getDisabledFields");var Oe=babelHelpers.classPrivateFieldLooseKey("isFieldDisabled");var Te=babelHelpers.classPrivateFieldLooseKey("onListItemChange");var Se=babelHelpers.classPrivateFieldLooseKey("onSidebarItemClick");var Ce=babelHelpers.classPrivateFieldLooseKey("onBackendError");var je=babelHelpers.classPrivateFieldLooseKey("getLayout");var Ee=babelHelpers.classPrivateFieldLooseKey("onSearchChange");var Ke=babelHelpers.classPrivateFieldLooseKey("getSearch");var Ie=babelHelpers.classPrivateFieldLooseKey("getFieldsListLayout");var Ae=babelHelpers.classPrivateFieldLooseKey("getCreateFieldButton");var _e=babelHelpers.classPrivateFieldLooseKey("onCreateFieldClick");var De=babelHelpers.classPrivateFieldLooseKey("getPreparedCategoryId");var we=babelHelpers.classPrivateFieldLooseKey("getFieldsFactoryTypesFilter");var Re=babelHelpers.classPrivateFieldLooseKey("applyFieldsFactoryTypesFilter");var Ne=babelHelpers.classPrivateFieldLooseKey("getUserFieldFactory");var ke=babelHelpers.classPrivateFieldLooseKey("getTitle");var Me=babelHelpers.classPrivateFieldLooseKey("getSliderLayout");var Xe=babelHelpers.classPrivateFieldLooseKey("getRenderedSliderLayout");var xe=babelHelpers.classPrivateFieldLooseKey("onSaveClick");var Ue=babelHelpers.classPrivateFieldLooseKey("setPromiseResolver");var $e=babelHelpers.classPrivateFieldLooseKey("getPromiseResolver");var Ge=babelHelpers.classPrivateFieldLooseKey("selectFirstCategory");var Ve=babelHelpers.classPrivateFieldLooseKey("getSliderId");var Ye=babelHelpers.classPrivateFieldLooseKey("onSliderCloseComplete");var We=babelHelpers.classPrivateFieldLooseKey("setAddButtonEnabledByCategory");class qe extends i.EventEmitter{constructor(e={}){super();Object.defineProperty(this,We,{value:Xs});Object.defineProperty(this,Ye,{value:Ms});Object.defineProperty(this,Ve,{value:ks});Object.defineProperty(this,Ge,{value:Ns});Object.defineProperty(this,$e,{value:Rs});Object.defineProperty(this,Ue,{value:ws});Object.defineProperty(this,xe,{value:Ds});Object.defineProperty(this,Xe,{value:_s});Object.defineProperty(this,Me,{value:As});Object.defineProperty(this,ke,{value:Is});Object.defineProperty(this,Ne,{value:Ks});Object.defineProperty(this,Re,{value:Es});Object.defineProperty(this,we,{value:js});Object.defineProperty(this,De,{value:Cs});Object.defineProperty(this,_e,{value:Ss});Object.defineProperty(this,Ae,{value:Ts});Object.defineProperty(this,Ie,{value:Os});Object.defineProperty(this,Ke,{value:ms});Object.defineProperty(this,Ee,{value:gs});Object.defineProperty(this,je,{value:Bs});Object.defineProperty(this,Ce,{value:Hs});Object.defineProperty(this,Se,{value:fs});Object.defineProperty(this,Te,{value:ys});Object.defineProperty(this,Oe,{value:Ls});Object.defineProperty(this,me,{value:hs});Object.defineProperty(this,ge,{value:Ps});Object.defineProperty(this,Be,{value:Fs});Object.defineProperty(this,He,{value:us});Object.defineProperty(this,fe,{value:vs});Object.defineProperty(this,ye,{value:ps});Object.defineProperty(this,Le,{value:ds});Object.defineProperty(this,he,{value:bs});Object.defineProperty(this,Pe,{value:cs});Object.defineProperty(this,Fe,{value:ns});Object.defineProperty(this,ue,{value:os});Object.defineProperty(this,ve,{value:rs});Object.defineProperty(this,pe,{value:as});Object.defineProperty(this,de,{value:is});Object.defineProperty(this,be,{value:ls});Object.defineProperty(this,ce,{value:ts});Object.defineProperty(this,ne,{value:ss});Object.defineProperty(this,oe,{value:es});Object.defineProperty(this,re,{value:Ze});Object.defineProperty(this,ae,{value:Qe});Object.defineProperty(this,ie,{value:Je});Object.defineProperty(this,le,{value:ze});Object.defineProperty(this,Z,{writable:true,value:new a.Cache.MemoryCache});Object.defineProperty(this,te,{writable:true,value:{}});this.setEventNamespace("BX.Sign.B2e.FieldsSelector");this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,le)[le](e)}setCustomBackendSettings(e){babelHelpers.classPrivateFieldLooseBase(this,le)[le]({...babelHelpers.classPrivateFieldLooseBase(this,ie)[ie](),customBackendSettings:e});babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]().setCustomSettings(babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]().customBackendSettings)}getFieldsList(e=true){const s=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].get("fieldsList",{});const t=babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe]();if(a.Type.isPlainObject(t)){const l=e?babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]().getValue():"";return babelHelpers.classPrivateFieldLooseBase(this,ce)[ce](babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](s,t),t),l)}if(a.Type.isFunction(t)){const e=a.Runtime.clone(babelHelpers.classPrivateFieldLooseBase(qe,ee)[ee]);if(!babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]()){e["-categories"].push("LEAD")}const l=babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](s,e),t);return t(a.Runtime.clone(l))}return s}static loadFieldList(e,s=null){return new b({customSettings:s,events:{onError:()=>{}}}).getData({options:e}).then((({data:e})=>e==null?void 0:e.fields))}hide(){const e=a.Reflection.getClass("BX.SidePanel");if(e.Instance){e.Instance.close()}}show(){const e=a.Reflection.getClass("BX.SidePanel");if(e.Instance){const s=babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]();s.setDisabled(true);e.Instance.open(babelHelpers.classPrivateFieldLooseBase(this,Ve)[Ve](),{width:740,contentCallback:()=>babelHelpers.classPrivateFieldLooseBase(this,be)[be]().then((()=>{s.setDisabled(!babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]());babelHelpers.classPrivateFieldLooseBase(this,Ge)[Ge]();return babelHelpers.classPrivateFieldLooseBase(this,Xe)[Xe]()})).catch((({errors:e})=>a.Tag.render(q||(q=W`
									<div class="ui-alert ui-alert-danger">
										<span class="ui-alert-message">${0}</span>
									</div>
								`),e.map((e=>a.Text.encode(e.message))).join("\n")))),events:{onCloseComplete:()=>babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye]()}})}return new Promise((e=>{babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue](e)}))}}function ze(e){babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].set("options",{filter:{},multiple:true,...e})}function Je(){return a.Runtime.clone(babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].get("options",{filter:{}}))}function Qe(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].remember("backend",(()=>new b({customSettings:babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]().customBackendSettings,events:{onError:babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce].bind(this)}})))}function Ze(e){if(a.Type.isObject(e.SMART_B2E_DOC)){e.SMART_B2E_DOC.CAPTION=a.Loc.getMessage("SIGN_B2E_FIELDS_SELECTOR_SMART_B2E_DOC_CATEGORY_CAPTION")}babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].set("fieldsList",{...e})}function es(e,s){const t=Object.entries(e);return t.reduce(((e,[t,l])=>{if((!a.Type.isArrayFilled(s["+categories"])||s["+categories"].includes(t))&&(!a.Type.isArrayFilled(s["-categories"])||!s["-categories"].includes(t))){e[t]=l}return e}),{})}function ss(e,s){const t=Object.entries(e);return t.reduce(((e,[t,l])=>{const i=l.FIELDS.filter((e=>{const t=!a.Type.isArrayFilled(s["+fields"])||s["+fields"].some((s=>{if(a.Type.isStringFilled(s)){return e.type===s}if(a.Type.isFunction(s)){return s(e)}if(a.Type.isPlainObject(s)){return Object.entries(s).every((([s,t])=>e[s]===t))}return false}));const l=a.Type.isArrayFilled(s["-fields"])&&s["-fields"].some((s=>{if(a.Type.isStringFilled(s)){return e.type===s}if(a.Type.isFunction(s)){return s(e)}if(a.Type.isPlainObject(s)){return Object.entries(s).every((([s,t])=>e[s]===t))}return false}));return t&&!l}));if(s.allowEmptyFieldList?a.Type.isArray(i):a.Type.isArrayFilled(i)){e[t]={...l,FIELDS:i}}return e}),{})}function ts(e,s){const t=Object.entries(e);if(a.Type.isStringFilled(s)){const e=String(s).toLowerCase();return t.reduce(((s,[t,l])=>{const i=l.FIELDS.filter((s=>a.Type.isStringFilled(s.caption)&&String(s.caption).toLowerCase().includes(e)));if(a.Type.isArrayFilled(i)){s[t]={...l,FIELDS:i}}return s}),{})}return e}function ls(){const{controllerOptions:e={}}=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]();return babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]().getData({options:e}).then((({data:e})=>{var s,t,l,i,a,r,o,n,c,b;babelHelpers.classPrivateFieldLooseBase(this,re)[re](e.fields);babelHelpers.classPrivateFieldLooseBase(this,de)[de]((s=(t=e.options)==null?void 0:t.isLeadEnabled)!=null?s:false);babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]((l=(i=e.options)==null?void 0:(a=i.permissions)==null?void 0:(r=a.userField)==null?void 0:r.add)!=null?l:false);babelHelpers.classPrivateFieldLooseBase(this,te)[te]=(o=(n=e.options)==null?void 0:(c=n.permissions)==null?void 0:(b=c.userField)==null?void 0:b.addByCategory)!=null?o:{}}))}function is(e){babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].set("isLeadEnabled",e)}function as(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].get("isLeadEnabled")}function rs(e){babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].set("isAllowedCreateField",e)}function os(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].get("isAllowedCreateField",false)}function ns(){return Object.entries(this.getFieldsList()).map((([e,s])=>{var t;let l=s.CAPTION;Object.entries((t=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]())==null?void 0:t.categoryCaptions).forEach((([s,t])=>{if(s===e){l=t}}));return{label:l,id:e,moduleId:s==null?void 0:s.MODULE_ID,onclick:babelHelpers.classPrivateFieldLooseBase(this,Se)[Se].bind(this,e)}}))}function cs(){const e=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]().filter;if(a.Type.isPlainObject(e)){const s=babelHelpers.classPrivateFieldLooseBase(qe,ee)[ee];if(a.Type.isArray(e["-categories"])){e["-categories"]=[...e["-categories"],...s["-categories"]]}else{e["-categories"]=[...s["-categories"]]}if(!babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]()){e["-categories"].push("LEAD")}if(a.Type.isArray(e["-fields"])){e["-fields"]=[...e["-fields"],...s["-fields"]]}else{e["-fields"]=[...s["-fields"]]}}return e}function bs(){a.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]())}function ds(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].get("selectedFields",[])}function ps(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Le)[Le]();const t=s.some((s=>s.name===e.name));if(!t){s.push(e);babelHelpers.classPrivateFieldLooseBase(this,He)[He](s)}}function vs(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Le)[Le]().filter((s=>s.name!==e.name));babelHelpers.classPrivateFieldLooseBase(this,He)[He](s)}function us(e){babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].set("selectedFields",e)}function Fs(){return babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]().multiple}function Ps(e){babelHelpers.classPrivateFieldLooseBase(this,he)[he]();const s=this.getFieldsList()[e].FIELDS;if(a.Type.isArrayFilled(s)){s.forEach((e=>{void new x({field:e,targetContainer:babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie](),events:{onChange:babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].bind(this)},selected:babelHelpers.classPrivateFieldLooseBase(this,Le)[Le]().some((s=>s.name===e.name)),type:babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]()?x.Type.CHECKBOX:x.Type.RADIO,disabled:babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe](e)})}))}babelHelpers.classPrivateFieldLooseBase(this,We)[We](e)}function hs(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]().disabledFields)!=null?e:null}function Ls(e){const s=babelHelpers.classPrivateFieldLooseBase(this,me)[me]();if(a.Type.isNull(s)){return false}return s.some((s=>a.Type.isString(s)&&e.name===s||a.Type.isFunction(s)&&s(e)))}function ys(e){const s=e.getTarget();if(babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]()){if(s.isSelected()){babelHelpers.classPrivateFieldLooseBase(this,ye)[ye](s.getField())}else{babelHelpers.classPrivateFieldLooseBase(this,fe)[fe](s.getField())}}else{babelHelpers.classPrivateFieldLooseBase(this,He)[He]([s.getField()])}}function fs(e){babelHelpers.classPrivateFieldLooseBase(this,ge)[ge](e)}function Hs(e){console.error(e);this.emit("onError",{error:e})}function Bs(){return a.Tag.render(z||(z=W`
			<div class="sign-b2e-fields-selector">
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]())}async function gs(){const e=await babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]();const s=babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe]();e.getMenu().setItems(s);babelHelpers.classPrivateFieldLooseBase(this,he)[he]();const[t]=s;if(t){babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](t.id);e.getMenu().setActiveFirstItem();if(babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]()){babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]().setDisabled(false)}}else{if(babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]()){babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]().setDisabled(true)}}}function ms(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].remember("search",(()=>new O({events:{onChange:babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee].bind(this)}})))}function Os(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].remember("fieldsListLayout",(()=>a.Tag.render(J||(J=W`
				<div class="sign-b2e-fields-selector-fields-list"></div>
			`))))}function Ts(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].remember("createFieldButton",(()=>new l.Button({text:a.Loc.getMessage("SIGN_B2E_FIELDS_SELECTOR_CREATE_BUTTON_LABEL"),color:l.Button.Color.SUCCESS,onclick:babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].bind(this)})))}async function Ss(){const e=await babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]();const s=e.getMenu();if(s.hasActive()){const e=s.getActiveItem().getId();const t=s.getActiveItem().getModuleId()||Q;const l=babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e,t);const i=l.getMenu();i.open((s=>{const t=l.getConfigurator({userField:l.createUserField(s),canMultipleFields:false,canRequiredFields:false,onSave:s=>{a.Dom.addClass(t.saveButton,"ui-btn-wait");const l=new Set(Object.keys(babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]().languages));const i=a.Loc.getMessage("LANGUAGE_ID");const r=s.data.editFormLabel[i];l.forEach((e=>{s.data.editFormLabel[e]=r}));return s.save().then((()=>babelHelpers.classPrivateFieldLooseBase(this,be)[be]())).then((()=>{a.Dom.removeClass(t.saveButton,"ui-btn-wait");babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](e);babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]().setValue(s.getData().editFormLabel[i])}))},onCancel:()=>{babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](e)}});babelHelpers.classPrivateFieldLooseBase(this,he)[he]();a.Dom.append(t.render(),babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]())}))}}function Cs(e){if(e.startsWith("PROFILE")){return"USER_LEGAL"}if(e.startsWith("DYNAMIC_")){const s=this.getFieldsList();if(a.Type.isPlainObject(s[e])){return s[e].DYNAMIC_ID}}return`CRM_${e}`}function js(){var e,s;const t=a.Runtime.clone(babelHelpers.classPrivateFieldLooseBase(qe,se)[se]);const l=(e=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]())==null?void 0:(s=e.fieldsFactory)==null?void 0:s.filter;if(a.Type.isPlainObject(l)){if(a.Type.isArrayFilled(l["-types"])){l["-types"]=[...t["-types"],...l["-types"]]}else{l["-types"]=[...t["-types"]]}return l}if(a.Type.isFunction(l)){return l}return t}function Es(e,s){if(a.Type.isPlainObject(s)){return e.filter((e=>{const t=!a.Type.isArrayFilled(s["+types"])||s["+types"].some((s=>{if(a.Type.isStringFilled(s)){return e.name===s}if(a.Type.isFunction(s)){return s(e)}return false}));const l=a.Type.isArrayFilled(s["-types"])&&s["-types"].some((s=>{if(a.Type.isStringFilled(s)){return e.name===s}if(a.Type.isFunction(s)){return s(e)}return false}));return t&&!l}))}return e}function Ks(e,s){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].remember(`factory_${e}`,(()=>{const t=window.top;const l=(()=>{if(t.BX.UI.UserFieldFactory){return t.BX.UI.UserFieldFactory.Factory}return BX.UI.UserFieldFactory.Factory})();const i=new l(babelHelpers.classPrivateFieldLooseBase(this,De)[De](e),{moduleId:s||Q,bindElement:babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]().render()});const r=babelHelpers.classPrivateFieldLooseBase(this,we)[we]();if(a.Type.isFunction(r)){i.types=babelHelpers.classPrivateFieldLooseBase(this,Re)[Re](i.types,qe.defaultFieldsFactoryFilter);i.types=r(i.types)}if(a.Type.isPlainObject(r)){i.types=babelHelpers.classPrivateFieldLooseBase(this,Re)[Re](i.types,r)}return i}))}function Is(){const e=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]();if(!a.Type.isStringFilled(e.title)){return a.Loc.getMessage("SIGN_B2E_FIELDS_SELECTOR_SLIDER_FIRST_PARTY_TITLE")}return e.title}function As(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].remember("sliderLayout",(()=>new Promise((e=>{s.Layout.createLayout({extensions:["sign.b2e.field-selector"],title:babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](),content:()=>babelHelpers.classPrivateFieldLooseBase(this,je)[je](),menu:{items:babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe]()},toolbar:()=>{const e=[babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]().getLayout()];if(babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]().alwaysHideCreateFieldButton!==true){e.push(babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]())}return e},buttons:({SaveButton:e,closeButton:s})=>[new e({text:a.Loc.getMessage("SIGN_B2E_FIELDS_SELECTOR_APPLY_BUTTON_LABEL"),onclick:babelHelpers.classPrivateFieldLooseBase(this,xe)[xe].bind(this)}),s]}).then((s=>{e(s)}))}))))}function _s(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].remember("renderedSliderLayout",(()=>babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]().then((e=>e.render()))))}function Ds(){const e=babelHelpers.classPrivateFieldLooseBase(this,Le)[Le]();const s=(()=>{const{resultModifier:s}=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]();if(a.Type.isFunction(s)){return s(e)}return e.map((e=>e.name))})();babelHelpers.classPrivateFieldLooseBase(this,$e)[$e]()(s);this.hide()}function ws(e){babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].set("promiseResolver",e)}function Rs(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].get("promiseResolver",(()=>{}))}function Ns(){const[e]=babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe]();if(a.Type.isPlainObject(e)){babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](e.id)}}function ks(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].remember("sliderId",(()=>`sign.b2e.fields.selector-${a.Text.getRandom()}`))}function Ms(){this.emit("onSliderCloseComplete");babelHelpers.classPrivateFieldLooseBase(this,He)[He]([])}function Xs(e){if(Object.hasOwn(babelHelpers.classPrivateFieldLooseBase(this,te)[te],e)){const s=babelHelpers.classPrivateFieldLooseBase(this,te)[te][e];babelHelpers.classPrivateFieldLooseBase(this,ve)[ve](s);babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]().setDisabled(!s)}}Object.defineProperty(qe,ee,{writable:true,value:{"-categories":["CATALOG","ACTIVITY","INVOICE"],"-fields":[{name:"CONTACT_ORIGIN_VERSION"},{name:"CONTACT_LINK"}]}});Object.defineProperty(qe,se,{writable:true,value:{"-types":["employee","money","double","boolean","file","datetime"]}});e.FieldSelector=qe})(this.BX.Sign.B2e=this.BX.Sign.B2e||{},BX.UI.SidePanel,BX.UI.UserFieldFactory,BX.UI,BX.Event,BX);
//# sourceMappingURL=selector.bundle.map.js