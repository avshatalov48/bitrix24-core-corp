this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};(function(e,s,t,l,i,a){"use strict";var r=babelHelpers.classPrivateFieldLooseKey("request");class o extends i.EventEmitter{constructor(e){super();Object.defineProperty(this,r,{value:n});this.setEventNamespace("BX.Sign.B2E.FieldsSelector.Backend");this.subscribeFromOptions(e.events)}getData(e={}){return babelHelpers.classPrivateFieldLooseBase(this,r)[r]({action:"load",data:e})}}function n(e){return new Promise(((s,t)=>{a.ajax.runAction(`sign.api_v1.b2e.fields.${e.action}`,{json:e.data}).then(s).catch(t)}))}let c=e=>e,b,d,p;var v=babelHelpers.classPrivateFieldLooseKey("cache");var u=babelHelpers.classPrivateFieldLooseKey("setOptions");var F=babelHelpers.classPrivateFieldLooseKey("getOptions");var P=babelHelpers.classPrivateFieldLooseKey("onInput");var h=babelHelpers.classPrivateFieldLooseKey("getDebounceWrapper");var L=babelHelpers.classPrivateFieldLooseKey("getInput");var y=babelHelpers.classPrivateFieldLooseKey("onClearClick");var f=babelHelpers.classPrivateFieldLooseKey("getClearButton");class H extends i.EventEmitter{constructor(e={}){super();Object.defineProperty(this,f,{value:C});Object.defineProperty(this,y,{value:j});Object.defineProperty(this,L,{value:T});Object.defineProperty(this,h,{value:O});Object.defineProperty(this,P,{value:m});Object.defineProperty(this,F,{value:g});Object.defineProperty(this,u,{value:B});Object.defineProperty(this,v,{writable:true,value:new a.Cache.MemoryCache});this.setEventNamespace("BX.Sign.B2E.Fields.Selector.Search");this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,u)[u](e)}getValue(){return babelHelpers.classPrivateFieldLooseBase(this,L)[L]().value}setValue(e){babelHelpers.classPrivateFieldLooseBase(this,L)[L]().value=e;babelHelpers.classPrivateFieldLooseBase(this,P)[P]()}getLayout(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].remember("layout",(()=>a.Tag.render(b||(b=c`
				<div class="sign-b2e-fields-selector-search">
					<div class="ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-before-icon ui-ctl-after-icon">
						<div class="ui-ctl-before ui-ctl-icon-search"></div>
						${0}
						${0}
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,f)[f](),babelHelpers.classPrivateFieldLooseBase(this,L)[L]())))}}function B(e){babelHelpers.classPrivateFieldLooseBase(this,v)[v].set("options",{...e})}function g(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].get("options",{})}function m(){this.emit("onChange",{value:babelHelpers.classPrivateFieldLooseBase(this,L)[L]().value});babelHelpers.classPrivateFieldLooseBase(this,h)[h]()()}function O(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].remember("debounceWrapper",(()=>a.Runtime.debounce((()=>{this.emit("onDebouncedChange",{value:babelHelpers.classPrivateFieldLooseBase(this,L)[L]().value})}),50)))}function T(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].remember("input",(()=>{const e=(()=>{if(a.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,F)[F]().initialValue)){return babelHelpers.classPrivateFieldLooseBase(this,F)[F]().initialValue}return""})();return a.Tag.render(d||(d=c`
				<input 
					type="text" 
					class="ui-ctl-element" 
					oninput="${0}"
					value="${0}"
					placeholder="${0}"
				>
			`),babelHelpers.classPrivateFieldLooseBase(this,P)[P].bind(this),a.Text.encode(e),a.Loc.getMessage("SIGN_B2E_FIELDS_SELECTOR_SEARCH_PLACEHOLDER"))}))}function j(e){e.preventDefault();babelHelpers.classPrivateFieldLooseBase(this,L)[L]().value="";babelHelpers.classPrivateFieldLooseBase(this,P)[P]()}function C(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].remember("clearButton",(()=>a.Tag.render(p||(p=c`
				<button 
					class="ui-ctl-after ui-ctl-icon-clear" 
					onclick="${0}"
				></button>
			`),babelHelpers.classPrivateFieldLooseBase(this,y)[y].bind(this))))}let E=e=>e,S,I;var K=babelHelpers.classPrivateFieldLooseKey("cache");var _=babelHelpers.classPrivateFieldLooseKey("setOptions");var A=babelHelpers.classPrivateFieldLooseKey("getOptions");var D=babelHelpers.classPrivateFieldLooseKey("onChange");var R=babelHelpers.classPrivateFieldLooseKey("getCheckbox");var w=babelHelpers.classPrivateFieldLooseKey("isDisabled");class N extends i.EventEmitter{constructor(e){super();Object.defineProperty(this,w,{value:U});Object.defineProperty(this,R,{value:k});Object.defineProperty(this,D,{value:x});Object.defineProperty(this,A,{value:X});Object.defineProperty(this,_,{value:M});Object.defineProperty(this,K,{writable:true,value:new a.Cache.MemoryCache});this.setEventNamespace("BX.Sign.B2E.FieldSelector.ListItem");this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,_)[_](e);const{targetContainer:s}=e;if(a.Type.isDomNode(s)){this.renderTo(s)}}getField(){return babelHelpers.classPrivateFieldLooseBase(this,A)[A]().field}isSelected(){return babelHelpers.classPrivateFieldLooseBase(this,R)[R]().checked}getLayout(){return babelHelpers.classPrivateFieldLooseBase(this,K)[K].remember(`layout`,(()=>{const e="sign-b2e-fields-selector-field--disabled";return a.Tag.render(S||(S=E`
				<div class="sign-b2e-fields-selector-field${0}">
					<label class="ui-ctl ui-ctl-checkbox sign-b2e-fields-selector-field-checkbox">
						${0}
						<div class="ui-ctl-label-text">${0}</div>
					</label>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,w)[w]()?" "+e:"",babelHelpers.classPrivateFieldLooseBase(this,R)[R](),a.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,A)[A]().field.caption))}))}renderTo(e){if(a.Type.isDomNode(e)){a.Dom.append(this.getLayout(),e)}}}function M(e){babelHelpers.classPrivateFieldLooseBase(this,K)[K].set("options",{type:N.Type.CHECKBOX,...e})}function X(){return babelHelpers.classPrivateFieldLooseBase(this,K)[K].get("options",{})}function x(){this.emit("onChange")}function k(){return babelHelpers.classPrivateFieldLooseBase(this,K)[K].remember("checkbox",(()=>a.Tag.render(I||(I=E`
				<input 
					type="${0}" 
					class="ui-ctl-element"
					onchange="${0}"
					name="SIGN_B2E_SELECTOR_ITEM"
					${0}
				>
			`),a.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,A)[A]().type),babelHelpers.classPrivateFieldLooseBase(this,D)[D].bind(this),babelHelpers.classPrivateFieldLooseBase(this,A)[A]().selected?"checked":"")))}function U(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,A)[A]().disabled)!=null?e:false}N.Type={CHECKBOX:"checkbox",RADIO:"radio"};let $=e=>e,G,V,Y;const W="crm";var q=babelHelpers.classPrivateFieldLooseKey("cache");var z=babelHelpers.classPrivateFieldLooseKey("defaultFilter");var J=babelHelpers.classPrivateFieldLooseKey("defaultFieldsFactoryFilter");var Q=babelHelpers.classPrivateFieldLooseKey("setOptions");var Z=babelHelpers.classPrivateFieldLooseKey("getOptions");var ee=babelHelpers.classPrivateFieldLooseKey("getBackend");var se=babelHelpers.classPrivateFieldLooseKey("setFieldsList");var te=babelHelpers.classPrivateFieldLooseKey("applyCategoriesFilter");var le=babelHelpers.classPrivateFieldLooseKey("applyFieldsFilter");var ie=babelHelpers.classPrivateFieldLooseKey("applySearchFilter");var ae=babelHelpers.classPrivateFieldLooseKey("load");var re=babelHelpers.classPrivateFieldLooseKey("setIsLeadEnabled");var oe=babelHelpers.classPrivateFieldLooseKey("isLeadEnabled");var ne=babelHelpers.classPrivateFieldLooseKey("setIsAllowedCreateField");var ce=babelHelpers.classPrivateFieldLooseKey("isAllowedCreateField");var be=babelHelpers.classPrivateFieldLooseKey("getSidebarItems");var de=babelHelpers.classPrivateFieldLooseKey("getFilter");var pe=babelHelpers.classPrivateFieldLooseKey("cleanFieldsList");var ve=babelHelpers.classPrivateFieldLooseKey("getSelectedFields");var ue=babelHelpers.classPrivateFieldLooseKey("addSelectedField");var Fe=babelHelpers.classPrivateFieldLooseKey("removeSelectedField");var Pe=babelHelpers.classPrivateFieldLooseKey("setSelectedFields");var he=babelHelpers.classPrivateFieldLooseKey("isMultiple");var Le=babelHelpers.classPrivateFieldLooseKey("renderCategoryFields");var ye=babelHelpers.classPrivateFieldLooseKey("getDisabledFields");var fe=babelHelpers.classPrivateFieldLooseKey("isFieldDisabled");var He=babelHelpers.classPrivateFieldLooseKey("onListItemChange");var Be=babelHelpers.classPrivateFieldLooseKey("onSidebarItemClick");var ge=babelHelpers.classPrivateFieldLooseKey("onBackendError");var me=babelHelpers.classPrivateFieldLooseKey("getLayout");var Oe=babelHelpers.classPrivateFieldLooseKey("onSearchChange");var Te=babelHelpers.classPrivateFieldLooseKey("getSearch");var je=babelHelpers.classPrivateFieldLooseKey("getFieldsListLayout");var Ce=babelHelpers.classPrivateFieldLooseKey("getCreateFieldButton");var Ee=babelHelpers.classPrivateFieldLooseKey("onCreateFieldClick");var Se=babelHelpers.classPrivateFieldLooseKey("getPreparedCategoryId");var Ie=babelHelpers.classPrivateFieldLooseKey("getFieldsFactoryTypesFilter");var Ke=babelHelpers.classPrivateFieldLooseKey("applyFieldsFactoryTypesFilter");var _e=babelHelpers.classPrivateFieldLooseKey("getUserFieldFactory");var Ae=babelHelpers.classPrivateFieldLooseKey("getTitle");var De=babelHelpers.classPrivateFieldLooseKey("getSliderLayout");var Re=babelHelpers.classPrivateFieldLooseKey("getRenderedSliderLayout");var we=babelHelpers.classPrivateFieldLooseKey("onSaveClick");var Ne=babelHelpers.classPrivateFieldLooseKey("setPromiseResolver");var Me=babelHelpers.classPrivateFieldLooseKey("getPromiseResolver");var Xe=babelHelpers.classPrivateFieldLooseKey("selectFirstCategory");var xe=babelHelpers.classPrivateFieldLooseKey("getSliderId");var ke=babelHelpers.classPrivateFieldLooseKey("onSliderCloseComplete");class Ue extends i.EventEmitter{constructor(e={}){super();Object.defineProperty(this,ke,{value:As});Object.defineProperty(this,xe,{value:_s});Object.defineProperty(this,Xe,{value:Ks});Object.defineProperty(this,Me,{value:Is});Object.defineProperty(this,Ne,{value:Ss});Object.defineProperty(this,we,{value:Es});Object.defineProperty(this,Re,{value:Cs});Object.defineProperty(this,De,{value:js});Object.defineProperty(this,Ae,{value:Ts});Object.defineProperty(this,_e,{value:Os});Object.defineProperty(this,Ke,{value:ms});Object.defineProperty(this,Ie,{value:gs});Object.defineProperty(this,Se,{value:Bs});Object.defineProperty(this,Ee,{value:Hs});Object.defineProperty(this,Ce,{value:fs});Object.defineProperty(this,je,{value:ys});Object.defineProperty(this,Te,{value:Ls});Object.defineProperty(this,Oe,{value:hs});Object.defineProperty(this,me,{value:Ps});Object.defineProperty(this,ge,{value:Fs});Object.defineProperty(this,Be,{value:us});Object.defineProperty(this,He,{value:vs});Object.defineProperty(this,fe,{value:ps});Object.defineProperty(this,ye,{value:ds});Object.defineProperty(this,Le,{value:bs});Object.defineProperty(this,he,{value:cs});Object.defineProperty(this,Pe,{value:ns});Object.defineProperty(this,Fe,{value:os});Object.defineProperty(this,ue,{value:rs});Object.defineProperty(this,ve,{value:as});Object.defineProperty(this,pe,{value:is});Object.defineProperty(this,de,{value:ls});Object.defineProperty(this,be,{value:ts});Object.defineProperty(this,ce,{value:ss});Object.defineProperty(this,ne,{value:es});Object.defineProperty(this,oe,{value:Ze});Object.defineProperty(this,re,{value:Qe});Object.defineProperty(this,ae,{value:Je});Object.defineProperty(this,ie,{value:ze});Object.defineProperty(this,le,{value:qe});Object.defineProperty(this,te,{value:We});Object.defineProperty(this,se,{value:Ye});Object.defineProperty(this,ee,{value:Ve});Object.defineProperty(this,Z,{value:Ge});Object.defineProperty(this,Q,{value:$e});Object.defineProperty(this,q,{writable:true,value:new a.Cache.MemoryCache});this.setEventNamespace("BX.Sign.B2e.FieldsSelector");this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,Q)[Q](e)}getFieldsList(e=true){const s=babelHelpers.classPrivateFieldLooseBase(this,q)[q].get("fieldsList",{});const t=babelHelpers.classPrivateFieldLooseBase(this,de)[de]();if(a.Type.isPlainObject(t)){const l=e?babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]().getValue():"";return babelHelpers.classPrivateFieldLooseBase(this,ie)[ie](babelHelpers.classPrivateFieldLooseBase(this,le)[le](babelHelpers.classPrivateFieldLooseBase(this,te)[te](s,t),t),l)}if(a.Type.isFunction(t)){const e=a.Runtime.clone(babelHelpers.classPrivateFieldLooseBase(Ue,z)[z]);if(!babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]()){e["-categories"].push("LEAD")}const l=babelHelpers.classPrivateFieldLooseBase(this,le)[le](babelHelpers.classPrivateFieldLooseBase(this,te)[te](s,e),t);return t(a.Runtime.clone(l))}return s}static loadFieldList(e){return new o({events:{onError:()=>{}}}).getData({options:e}).then((({data:e})=>e==null?void 0:e.fields))}hide(){const e=a.Reflection.getClass("BX.SidePanel");if(e.Instance){e.Instance.close()}}show(){const e=a.Reflection.getClass("BX.SidePanel");if(e.Instance){const s=babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]();s.setDisabled(true);e.Instance.open(babelHelpers.classPrivateFieldLooseBase(this,xe)[xe](),{width:740,contentCallback:()=>babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]().then((()=>{s.setDisabled(!babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]());babelHelpers.classPrivateFieldLooseBase(this,Xe)[Xe]();return babelHelpers.classPrivateFieldLooseBase(this,Re)[Re]()})).catch((({errors:e})=>a.Tag.render(G||(G=$`
									<div class="ui-alert ui-alert-danger">
										<span class="ui-alert-message">${0}</span>
									</div>
								`),e.map((e=>a.Text.encode(e.message))).join("\n")))),events:{onCloseComplete:()=>babelHelpers.classPrivateFieldLooseBase(this,ke)[ke]()}})}return new Promise((e=>{babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e)}))}}function $e(e){babelHelpers.classPrivateFieldLooseBase(this,q)[q].set("options",{filter:{},multiple:true,...e})}function Ge(){return a.Runtime.clone(babelHelpers.classPrivateFieldLooseBase(this,q)[q].get("options",{filter:{}}))}function Ve(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].remember("backend",(()=>new o({events:{onError:babelHelpers.classPrivateFieldLooseBase(this,ge)[ge].bind(this)}})))}function Ye(e){if(a.Type.isObject(e.SMART_B2E_DOC)){e.SMART_B2E_DOC.CAPTION=a.Loc.getMessage("SIGN_B2E_FIELDS_SELECTOR_SMART_B2E_DOC_CATEGORY_CAPTION")}babelHelpers.classPrivateFieldLooseBase(this,q)[q].set("fieldsList",{...e})}function We(e,s){const t=Object.entries(e);return t.reduce(((e,[t,l])=>{if((!a.Type.isArrayFilled(s["+categories"])||s["+categories"].includes(t))&&(!a.Type.isArrayFilled(s["-categories"])||!s["-categories"].includes(t))){e[t]=l}return e}),{})}function qe(e,s){const t=Object.entries(e);return t.reduce(((e,[t,l])=>{const i=l.FIELDS.filter((e=>{const t=!a.Type.isArrayFilled(s["+fields"])||s["+fields"].some((s=>{if(a.Type.isStringFilled(s)){return e.type===s}if(a.Type.isFunction(s)){return s(e)}if(a.Type.isPlainObject(s)){return Object.entries(s).every((([s,t])=>e[s]===t))}return false}));const l=a.Type.isArrayFilled(s["-fields"])&&s["-fields"].some((s=>{if(a.Type.isStringFilled(s)){return e.type===s}if(a.Type.isFunction(s)){return s(e)}if(a.Type.isPlainObject(s)){return Object.entries(s).every((([s,t])=>e[s]===t))}return false}));return t&&!l}));if(a.Type.isArrayFilled(i)){e[t]={...l,FIELDS:i}}return e}),{})}function ze(e,s){const t=Object.entries(e);if(a.Type.isStringFilled(s)){const e=String(s).toLowerCase();return t.reduce(((s,[t,l])=>{const i=l.FIELDS.filter((s=>a.Type.isStringFilled(s.caption)&&String(s.caption).toLowerCase().includes(e)));if(a.Type.isArrayFilled(i)){s[t]={...l,FIELDS:i}}return s}),{})}return e}function Je(){const{controllerOptions:e={}}=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]();return babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]().getData({options:e}).then((({data:e})=>{babelHelpers.classPrivateFieldLooseBase(this,se)[se](e.fields);babelHelpers.classPrivateFieldLooseBase(this,re)[re](e.options.isLeadEnabled);babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](e.options.permissions.userField.add)}))}function Qe(e){babelHelpers.classPrivateFieldLooseBase(this,q)[q].set("isLeadEnabled",e)}function Ze(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].get("isLeadEnabled")}function es(e){babelHelpers.classPrivateFieldLooseBase(this,q)[q].set("isAllowedCreateField",e)}function ss(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].get("isAllowedCreateField",false)}function ts(){return Object.entries(this.getFieldsList()).map((([e,s])=>{var t;let l=s.CAPTION;Object.entries((t=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]())==null?void 0:t.categoryCaptions).forEach((([s,t])=>{if(s===e){l=t}}));return{label:l,id:e,moduleId:s==null?void 0:s.MODULE_ID,onclick:babelHelpers.classPrivateFieldLooseBase(this,Be)[Be].bind(this,e)}}))}function ls(){const e=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().filter;if(a.Type.isPlainObject(e)){const s=babelHelpers.classPrivateFieldLooseBase(Ue,z)[z];if(a.Type.isArray(e["-categories"])){e["-categories"]=[...e["-categories"],...s["-categories"]]}else{e["-categories"]=[...s["-categories"]]}if(!babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]()){e["-categories"].push("LEAD")}if(a.Type.isArray(e["-fields"])){e["-fields"]=[...e["-fields"],...s["-fields"]]}else{e["-fields"]=[...s["-fields"]]}}return e}function is(){a.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,je)[je]())}function as(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].get("selectedFields",[])}function rs(e){const s=babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]();const t=s.some((s=>s.name===e.name));if(!t){s.push(e);babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe](s)}}function os(e){const s=babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]().filter((s=>s.name!==e.name));babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe](s)}function ns(e){babelHelpers.classPrivateFieldLooseBase(this,q)[q].set("selectedFields",e)}function cs(){return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().multiple}function bs(e){babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]();const s=this.getFieldsList()[e].FIELDS;if(a.Type.isArrayFilled(s)){s.forEach((e=>{void new N({field:e,targetContainer:babelHelpers.classPrivateFieldLooseBase(this,je)[je](),events:{onChange:babelHelpers.classPrivateFieldLooseBase(this,He)[He].bind(this)},selected:babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]().some((s=>s.name===e.name)),type:babelHelpers.classPrivateFieldLooseBase(this,he)[he]()?N.Type.CHECKBOX:N.Type.RADIO,disabled:babelHelpers.classPrivateFieldLooseBase(this,fe)[fe](e)})}))}}function ds(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().disabledFields)!=null?e:null}function ps(e){const s=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]();if(a.Type.isNull(s)){return false}return s.some((s=>a.Type.isString(s)&&e.name===s||a.Type.isFunction(s)&&s(e)))}function vs(e){const s=e.getTarget();if(babelHelpers.classPrivateFieldLooseBase(this,he)[he]()){if(s.isSelected()){babelHelpers.classPrivateFieldLooseBase(this,ue)[ue](s.getField())}else{babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe](s.getField())}}else{babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe]([s.getField()])}}function us(e){babelHelpers.classPrivateFieldLooseBase(this,Le)[Le](e)}function Fs(e){console.error(e);this.emit("onError",{error:e})}function Ps(){return a.Tag.render(V||(V=$`
			<div class="sign-b2e-fields-selector">
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,je)[je]())}async function hs(){const e=await babelHelpers.classPrivateFieldLooseBase(this,De)[De]();const s=babelHelpers.classPrivateFieldLooseBase(this,be)[be]();e.getMenu().setItems(s);babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]();const[t]=s;if(t){babelHelpers.classPrivateFieldLooseBase(this,Be)[Be](t.id);e.getMenu().setActiveFirstItem();if(babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]()){babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]().setDisabled(false)}}else{if(babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]()){babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]().setDisabled(true)}}}function Ls(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].remember("search",(()=>new H({events:{onChange:babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].bind(this)}})))}function ys(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].remember("fieldsListLayout",(()=>a.Tag.render(Y||(Y=$`
				<div class="sign-b2e-fields-selector-fields-list"></div>
			`))))}function fs(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].remember("createFieldButton",(()=>new l.Button({text:a.Loc.getMessage("SIGN_B2E_FIELDS_SELECTOR_CREATE_BUTTON_LABEL"),color:l.Button.Color.SUCCESS,onclick:babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee].bind(this)})))}async function Hs(){const e=await babelHelpers.classPrivateFieldLooseBase(this,De)[De]();const s=e.getMenu();if(s.hasActive()){const e=s.getActiveItem().getId();const t=s.getActiveItem().getModuleId()||W;const l=babelHelpers.classPrivateFieldLooseBase(this,_e)[_e](e,t);const i=l.getMenu();i.open((s=>{const t=l.getConfigurator({userField:l.createUserField(s),canMultipleFields:false,canRequiredFields:false,onSave:s=>{a.Dom.addClass(t.saveButton,"ui-btn-wait");const l=new Set(Object.keys(babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().languages));const i=a.Loc.getMessage("LANGUAGE_ID");const r=s.data.editFormLabel[i];l.forEach((e=>{s.data.editFormLabel[e]=r}));return s.save().then((()=>babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]())).then((()=>{a.Dom.removeClass(t.saveButton,"ui-btn-wait");babelHelpers.classPrivateFieldLooseBase(this,Be)[Be](e);babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]().setValue(s.getData().editFormLabel[i])}))},onCancel:()=>{babelHelpers.classPrivateFieldLooseBase(this,Be)[Be](e)}});babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]();a.Dom.append(t.render(),babelHelpers.classPrivateFieldLooseBase(this,je)[je]())}))}}function Bs(e){if(e.startsWith("PROFILE")){return"USER_LEGAL"}if(e.startsWith("DYNAMIC_")){const s=this.getFieldsList();if(a.Type.isPlainObject(s[e])){return s[e].DYNAMIC_ID}}return`CRM_${e}`}function gs(){var e,s;const t=a.Runtime.clone(babelHelpers.classPrivateFieldLooseBase(Ue,J)[J]);const l=(e=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]())==null?void 0:(s=e.fieldsFactory)==null?void 0:s.filter;if(a.Type.isPlainObject(l)){if(a.Type.isArrayFilled(l["-types"])){l["-types"]=[...t["-types"],...l["-types"]]}else{l["-types"]=[...t["-types"]]}return l}if(a.Type.isFunction(l)){return l}return t}function ms(e,s){if(a.Type.isPlainObject(s)){return e.filter((e=>{const t=!a.Type.isArrayFilled(s["+types"])||s["+types"].some((s=>{if(a.Type.isStringFilled(s)){return e.name===s}if(a.Type.isFunction(s)){return s(e)}return false}));const l=a.Type.isArrayFilled(s["-types"])&&s["-types"].some((s=>{if(a.Type.isStringFilled(s)){return e.name===s}if(a.Type.isFunction(s)){return s(e)}return false}));return t&&!l}))}return e}function Os(e,s){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].remember(`factory_${e}`,(()=>{const t=window.top;const l=(()=>{if(t.BX.UI.UserFieldFactory){return t.BX.UI.UserFieldFactory.Factory}return BX.UI.UserFieldFactory.Factory})();const i=new l(babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](e),{moduleId:s||W,bindElement:babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]().render()});const r=babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]();if(a.Type.isFunction(r)){i.types=babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke](i.types,Ue.defaultFieldsFactoryFilter);i.types=r(i.types)}if(a.Type.isPlainObject(r)){i.types=babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke](i.types,r)}return i}))}function Ts(){const e=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]();if(!a.Type.isStringFilled(e.title)){return a.Loc.getMessage("SIGN_B2E_FIELDS_SELECTOR_SLIDER_FIRST_PARTY_TITLE")}return e.title}function js(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].remember("sliderLayout",(()=>new Promise((e=>{s.Layout.createLayout({extensions:["sign.b2e.field-selector"],title:babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae](),content:()=>babelHelpers.classPrivateFieldLooseBase(this,me)[me](),menu:{items:babelHelpers.classPrivateFieldLooseBase(this,be)[be]()},toolbar:()=>[babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]().getLayout(),babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]()],buttons:({SaveButton:e,closeButton:s})=>[new e({text:a.Loc.getMessage("SIGN_B2E_FIELDS_SELECTOR_APPLY_BUTTON_LABEL"),onclick:babelHelpers.classPrivateFieldLooseBase(this,we)[we].bind(this)}),s]}).then((s=>{e(s)}))}))))}function Cs(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].remember("renderedSliderLayout",(()=>babelHelpers.classPrivateFieldLooseBase(this,De)[De]().then((e=>e.render()))))}function Es(){const e=babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]();const s=(()=>{const{resultModifier:s}=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]();if(a.Type.isFunction(s)){return s(e)}return e.map((e=>e.name))})();babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]()(s);this.hide()}function Ss(e){babelHelpers.classPrivateFieldLooseBase(this,q)[q].set("promiseResolver",e)}function Is(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].get("promiseResolver",(()=>{}))}function Ks(){const[e]=babelHelpers.classPrivateFieldLooseBase(this,be)[be]();if(a.Type.isPlainObject(e)){babelHelpers.classPrivateFieldLooseBase(this,Be)[Be](e.id)}}function _s(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q].remember("sliderId",(()=>`sign.b2e.fields.selector-${a.Text.getRandom()}`))}function As(){this.emit("onSliderCloseComplete");babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe]([])}Object.defineProperty(Ue,z,{writable:true,value:{"-categories":["CATALOG","ACTIVITY","INVOICE"],"-fields":[{name:"CONTACT_ORIGIN_VERSION"},{name:"CONTACT_LINK"}]}});Object.defineProperty(Ue,J,{writable:true,value:{"-types":["employee","money","double","boolean","file","datetime","date"]}});e.FieldSelector=Ue})(this.BX.Sign.B2e=this.BX.Sign.B2e||{},BX.UI.SidePanel,BX.UI.UserFieldFactory,BX.UI,BX.Event,BX);
//# sourceMappingURL=selector.bundle.map.js