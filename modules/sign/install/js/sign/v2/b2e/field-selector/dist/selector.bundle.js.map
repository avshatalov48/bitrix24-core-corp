{"version":3,"file":"selector.bundle.js","sources":["../src/backend/backend.js","../src/search/search.js","../src/list-item/list-item.js","../src/selector.js"],"sourcesContent":["import { EventEmitter, BaseEvent } from 'main.core.events';\nimport { ajax, Type } from 'main.core';\n\ntype BackendOptions = {\n\tcustomSettings: CustomBackendSettings | null,\n\tevents: {\n\t\tonError: (event: BaseEvent) => void,\n\t},\n};\n\nexport type CustomBackendSettings = {\n\turi: string | null,\n\trequestOptions: { [key: string]: any } | null,\n};\n\nconst DefaultUri = 'sign.api_v1.b2e.fields.load';\n\nexport default class Backend extends EventEmitter\n{\n\t#options: BackendOptions;\n\n\tconstructor(options: BackendOptions)\n\t{\n\t\tsuper();\n\t\tthis.#options = options;\n\t\tthis.setEventNamespace('BX.Sign.B2E.FieldsSelector.Backend');\n\t\tthis.subscribeFromOptions(this.#options.events);\n\t}\n\n\t#request(requestOptions: { data: { [key: string]: any } }): Promise<any>\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax\n\t\t\t\t.runAction(\n\t\t\t\t\tthis.#getUri(),\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: requestOptions.data,\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t\t.then(resolve)\n\t\t\t\t.catch(reject);\n\t\t});\n\t}\n\n\t#getUri(): string\n\t{\n\t\tif (Type.isStringFilled(this.#options.customSettings?.uri))\n\t\t{\n\t\t\treturn this.#options.customSettings.uri;\n\t\t}\n\n\t\treturn DefaultUri;\n\t}\n\n\tsetCustomSettings(customSettings: CustomBackendSettings | null): void\n\t{\n\t\tthis.#options = {\n\t\t\t...this.#options,\n\t\t\tcustomSettings,\n\t\t};\n\t}\n\n\tgetData(requestOptions = {}): Promise<any>\n\t{\n\t\treturn this.#request({\n\t\t\tdata: {\n\t\t\t\t...requestOptions,\n\t\t\t\t...(this.#options.customSettings?.requestOptions ?? {}),\n\t\t\t},\n\t\t});\n\t}\n}","import {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Cache, Tag, Runtime, Text, Type, Loc} from 'main.core';\n\nimport './css/style.css';\n\ntype SearchOptions = {\n\tinitialValue?: string,\n\tevents?: {\n\t\tonChange?: (event: BaseEvent) => void,\n\t\tonDebouncedChange?: (event: BaseEvent) => void,\n\t},\n};\n\nexport default class Search extends EventEmitter\n{\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(options: SearchOptions = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Sign.B2E.Fields.Selector.Search');\n\t\tthis.subscribeFromOptions(options.events);\n\t\tthis.#setOptions(options);\n\t}\n\n\t#setOptions(options: SearchOptions)\n\t{\n\t\tthis.#cache.set('options', {...options});\n\t}\n\n\t#getOptions(): SearchOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\t#onInput()\n\t{\n\t\tthis.emit('onChange', {value: this.#getInput().value});\n\t\tthis.#getDebounceWrapper()();\n\t}\n\n\t#getDebounceWrapper(): () => void\n\t{\n\t\treturn this.#cache.remember('debounceWrapper', () => {\n\t\t\treturn Runtime.debounce(\n\t\t\t\t() => {\n\t\t\t\t\tthis.emit('onDebouncedChange', {value: this.#getInput().value});\n\t\t\t\t},\n\t\t\t\t50,\n\t\t\t)\n\t\t});\n\t}\n\n\t#getInput(): HTMLInputElement\n\t{\n\t\treturn this.#cache.remember('input', () => {\n\t\t\tconst initialValue = (() => {\n\t\t\t\tif (Type.isStringFilled(this.#getOptions().initialValue))\n\t\t\t\t{\n\t\t\t\t\treturn this.#getOptions().initialValue;\n\t\t\t\t}\n\n\t\t\t\treturn '';\n\t\t\t})();\n\n\t\t\treturn Tag.render`\n\t\t\t\t<input \n\t\t\t\t\ttype=\"text\" \n\t\t\t\t\tclass=\"ui-ctl-element\" \n\t\t\t\t\toninput=\"${this.#onInput.bind(this)}\"\n\t\t\t\t\tvalue=\"${Text.encode(initialValue)}\"\n\t\t\t\t\tplaceholder=\"${Loc.getMessage('SIGN_B2E_FIELDS_SELECTOR_SEARCH_PLACEHOLDER')}\"\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetValue(): string\n\t{\n\t\treturn this.#getInput().value;\n\t}\n\n\t#onClearClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tthis.#getInput().value = '';\n\t\tthis.#onInput();\n\t}\n\n\tsetValue(value: string)\n\t{\n\t\tthis.#getInput().value = value;\n\t\tthis.#onInput();\n\t}\n\n\t#getClearButton(): HTMLButtonElement\n\t{\n\t\treturn this.#cache.remember('clearButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button \n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-clear\" \n\t\t\t\t\tonclick=\"${this.#onClearClick.bind(this)}\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"sign-b2e-fields-selector-search\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-before-icon ui-ctl-after-icon\">\n\t\t\t\t\t\t<div class=\"ui-ctl-before ui-ctl-icon-search\"></div>\n\t\t\t\t\t\t${this.#getClearButton()}\n\t\t\t\t\t\t${this.#getInput()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Cache, Tag, Dom, Text, Type} from 'main.core';\n\nimport {type Field} from '../types/field';\n\nimport './css/style.css';\n\ntype ListItemOptions = {\n\tfield: Field,\n\tselected?: boolean,\n\ttargetContainer?: HTMLElement,\n\tevents?: {\n\t\tonChange?: (event: BaseEvent) => void,\n\t},\n\ttype: $Values<ListItem.Type>,\n\tdisabled?: boolean,\n};\n\nexport default class ListItem extends EventEmitter\n{\n\tstatic Type = {\n\t\tCHECKBOX: 'checkbox',\n\t\tRADIO: 'radio',\n\t};\n\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(options: ListItemOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Sign.B2E.FieldSelector.ListItem');\n\t\tthis.subscribeFromOptions(options.events);\n\t\tthis.#setOptions(options);\n\n\t\tconst {targetContainer} = options;\n\t\tif (Type.isDomNode(targetContainer))\n\t\t{\n\t\t\tthis.renderTo(targetContainer);\n\t\t}\n\t}\n\n\t#setOptions(options: ListItemOptions)\n\t{\n\t\tthis.#cache.set('options', {type: ListItem.Type.CHECKBOX, ...options});\n\t}\n\n\t#getOptions(): ListItemOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\tgetField(): Field\n\t{\n\t\treturn this.#getOptions().field;\n\t}\n\n\t#onChange()\n\t{\n\t\tthis.emit('onChange');\n\t}\n\n\t#getCheckbox(): HTMLInputElement\n\t{\n\t\treturn this.#cache.remember('checkbox', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input \n\t\t\t\t\ttype=\"${Text.encode(this.#getOptions().type)}\" \n\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\tonchange=\"${this.#onChange.bind(this)}\"\n\t\t\t\t\tname=\"SIGN_B2E_SELECTOR_ITEM\"\n\t\t\t\t\t${this.#getOptions().selected ? 'checked' : ''}\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\tisSelected(): boolean\n\t{\n\t\treturn this.#getCheckbox().checked;\n\t}\n\n\t#isDisabled(): boolean\n\t{\n\t\treturn this.#getOptions().disabled ?? false;\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember(`layout`, () => {\n\t\t\tconst fieldDisabledClassName = 'sign-b2e-fields-selector-field--disabled';\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"sign-b2e-fields-selector-field${this.#isDisabled() ? \" \" + fieldDisabledClassName : ''}\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox sign-b2e-fields-selector-field-checkbox\">\n\t\t\t\t\t\t${this.#getCheckbox()}\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Text.encode(this.#getOptions().field.caption)}</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\trenderTo(targetContainer: HTMLElement)\n\t{\n\t\tif (Type.isDomNode(targetContainer))\n\t\t{\n\t\t\tDom.append(this.getLayout(), targetContainer);\n\t\t}\n\t}\n}","import { EventEmitter, BaseEvent } from 'main.core.events';\nimport { Cache, Type, Dom, Reflection, Runtime, Tag, Loc, Text } from 'main.core';\nimport { Layout } from 'ui.sidepanel.layout';\nimport { Factory } from 'ui.userfieldfactory';\nimport { Button } from 'ui.buttons';\n\nimport Backend from './backend/backend';\nimport Search from './search/search';\nimport ListItem from './list-item/list-item';\n\nimport type { SelectorOptions, ControllerOptions, SelectorFilter, FieldsFactoryFilter } from './types/selector-options';\nimport type { FieldsList } from './types/fields-list';\nimport type { Field } from './types/field';\n\nimport './css/style.css';\nimport type { CustomBackendSettings } from './backend/backend';\n\nconst DEFAULT_FIELD_MODULE_ID = 'crm';\n\nexport class FieldSelector extends EventEmitter\n{\n\t#cache = new Cache.MemoryCache();\n\n\tstatic #defaultFilter = {\n\t\t'-categories': [\n\t\t\t'CATALOG',\n\t\t\t'ACTIVITY',\n\t\t\t'INVOICE',\n\t\t],\n\t\t'-fields': [\n\t\t\t{ name: 'CONTACT_ORIGIN_VERSION' },\n\t\t\t{ name: 'CONTACT_LINK' },\n\t\t],\n\t};\n\n\tstatic #defaultFieldsFactoryFilter = {\n\t\t'-types': ['employee', 'money', 'double', 'boolean', 'file', 'datetime'],\n\t};\n\n\t#permissionAddByCategory: Record<string, Boolean> = {};\n\n\tconstructor(options: SelectorOptions = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Sign.B2e.FieldsSelector');\n\t\tthis.subscribeFromOptions(options.events);\n\t\tthis.#setOptions(options);\n\t}\n\n\tsetCustomBackendSettings(customBackendSettings: CustomBackendSettings): void\n\t{\n\t\tthis.#setOptions({\n\t\t\t...this.#getOptions(),\n\t\t\tcustomBackendSettings,\n\t\t});\n\n\t\tthis.#getBackend().setCustomSettings(this.#getOptions().customBackendSettings);\n\t}\n\n\t#setOptions(options: SelectorOptions): void\n\t{\n\t\tthis.#cache.set(\n\t\t\t'options',\n\t\t\t{\n\t\t\t\tfilter: {},\n\t\t\t\tmultiple: true,\n\t\t\t\t...options,\n\t\t\t},\n\t\t);\n\t}\n\n\t#getOptions(): SelectorOptions\n\t{\n\t\treturn Runtime.clone(this.#cache.get('options', { filter: {} }));\n\t}\n\n\t#getBackend(): Backend\n\t{\n\t\treturn this.#cache.remember('backend', () => {\n\t\t\treturn new Backend({\n\t\t\t\tcustomSettings: this.#getOptions().customBackendSettings,\n\t\t\t\tevents: {\n\t\t\t\t\tonError: this.#onBackendError.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\t#setFieldsList(fieldsList: FieldsList): void\n\t{\n\t\tif (Type.isObject(fieldsList.SMART_B2E_DOC))\n\t\t{\n\t\t\tfieldsList.SMART_B2E_DOC.CAPTION = Loc.getMessage('SIGN_B2E_FIELDS_SELECTOR_SMART_B2E_DOC_CATEGORY_CAPTION');\n\t\t}\n\n\t\tthis.#cache.set('fieldsList', { ...fieldsList });\n\t}\n\n\t#applyCategoriesFilter(fieldsList: FieldsList, filter: SelectorFilter): FieldsList\n\t{\n\t\tconst fieldsEntries = Object.entries(fieldsList);\n\n\t\treturn fieldsEntries.reduce((acc, [categoryId, category]) => {\n\t\t\tif (\n\t\t\t\t(\n\t\t\t\t\t!Type.isArrayFilled(filter['+categories'])\n\t\t\t\t\t|| filter['+categories'].includes(categoryId)\n\t\t\t\t)\n\t\t\t\t&& (\n\t\t\t\t\t!Type.isArrayFilled(filter['-categories'])\n\t\t\t\t\t|| !filter['-categories'].includes(categoryId)\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tacc[categoryId] = category;\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, {});\n\t}\n\n\t#applyFieldsFilter(fieldsList: FieldsList, filter: SelectorFilter): FieldsList\n\t{\n\t\tconst fieldsEntries = Object.entries(fieldsList);\n\n\t\treturn fieldsEntries.reduce((acc, [categoryId, category]) => {\n\t\t\tconst filteredFields = category.FIELDS.filter((field) => {\n\t\t\t\tconst allowed = (\n\t\t\t\t\t!Type.isArrayFilled(filter['+fields'])\n\t\t\t\t\t|| filter['+fields'].some((condition) => {\n\t\t\t\t\t\tif (Type.isStringFilled(condition))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn field.type === condition;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isFunction(condition))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn condition(field);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isPlainObject(condition))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn Object.entries(condition).every(([key, value]) => {\n\t\t\t\t\t\t\t\treturn field[key] === value;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst disallowed = (\n\t\t\t\t\tType.isArrayFilled(filter['-fields'])\n\t\t\t\t\t&& filter['-fields'].some((condition) => {\n\t\t\t\t\t\tif (Type.isStringFilled(condition))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn field.type === condition;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isFunction(condition))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn condition(field);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isPlainObject(condition))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn Object.entries(condition).every(([key, value]) => {\n\t\t\t\t\t\t\t\treturn field[key] === value;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\treturn allowed && !disallowed;\n\t\t\t});\n\n\t\t\tif (filter.allowEmptyFieldList ? Type.isArray(filteredFields) : Type.isArrayFilled(filteredFields))\n\t\t\t{\n\t\t\t\tacc[categoryId] = {\n\t\t\t\t\t...category,\n\t\t\t\t\tFIELDS: filteredFields,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, {});\n\t}\n\n\t#applySearchFilter(fieldsList: FieldsList, query): FieldsList\n\t{\n\t\tconst fieldsEntries = Object.entries(fieldsList);\n\t\tif (Type.isStringFilled(query))\n\t\t{\n\t\t\tconst preparedQuery = String(query).toLowerCase();\n\n\t\t\treturn fieldsEntries.reduce((acc, [categoryId, category]) => {\n\t\t\t\tconst filteredFields = category.FIELDS.filter((field) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\tType.isStringFilled(field.caption)\n\t\t\t\t\t\t&& String(field.caption).toLowerCase().includes(preparedQuery)\n\t\t\t\t\t);\n\t\t\t\t});\n\n\t\t\t\tif (Type.isArrayFilled(filteredFields))\n\t\t\t\t{\n\t\t\t\t\tacc[categoryId] = {\n\t\t\t\t\t\t...category,\n\t\t\t\t\t\tFIELDS: filteredFields,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\t\t}\n\n\t\treturn fieldsList;\n\t}\n\n\tgetFieldsList(filtering: boolean = true): FieldsList\n\t{\n\t\tconst fieldsList = this.#cache.get('fieldsList', {});\n\n\t\tconst filter = this.#getFilter();\n\t\tif (Type.isPlainObject(filter))\n\t\t{\n\t\t\tconst query = filtering ? this.#getSearch().getValue() : '';\n\n\t\t\treturn this.#applySearchFilter(\n\t\t\t\tthis.#applyFieldsFilter(\n\t\t\t\t\tthis.#applyCategoriesFilter(fieldsList, filter),\n\t\t\t\t\tfilter,\n\t\t\t\t),\n\t\t\t\tquery,\n\t\t\t);\n\t\t}\n\n\t\tif (Type.isFunction(filter))\n\t\t{\n\t\t\tconst defaultFilter = Runtime.clone(FieldSelector.#defaultFilter);\n\t\t\tif (!this.#isLeadEnabled())\n\t\t\t{\n\t\t\t\tdefaultFilter['-categories'].push('LEAD');\n\t\t\t}\n\n\t\t\tconst prefilteredFieldsList = this.#applyFieldsFilter(\n\t\t\t\tthis.#applyCategoriesFilter(fieldsList, defaultFilter),\n\t\t\t\tfilter,\n\t\t\t);\n\n\t\t\treturn filter(Runtime.clone(prefilteredFieldsList));\n\t\t}\n\n\t\treturn fieldsList;\n\t}\n\n\t#load(): Promise<any>\n\t{\n\t\tconst { controllerOptions = {} } = this.#getOptions();\n\n\t\treturn this.#getBackend()\n\t\t\t.getData({ options: controllerOptions })\n\t\t\t.then(({ data }) => {\n\t\t\t\tthis.#setFieldsList(data.fields);\n\t\t\t\tthis.#setIsLeadEnabled(data.options?.isLeadEnabled ?? false);\n\t\t\t\tthis.#setIsAllowedCreateField(data.options?.permissions?.userField?.add ?? false);\n\t\t\t\tthis.#permissionAddByCategory = data.options?.permissions?.userField?.addByCategory ?? {};\n\t\t\t});\n\t}\n\n\tstatic loadFieldList(\n\t\toptions: ControllerOptions,\n\t\tcustomBackendSettings: CustomBackendSettings | null = null,\n\t): Promise<any>\n\t{\n\t\treturn new Backend({\n\t\t\tcustomSettings: customBackendSettings,\n\t\t\tevents: {\n\t\t\t\tonError: () => {},\n\t\t\t},\n\t\t}).getData({ options })\n\t\t\t.then(({ data }) => {\n\t\t\t\treturn data?.fields;\n\t\t\t})\n\t\t;\n\t}\n\n\t#setIsLeadEnabled(value: boolean)\n\t{\n\t\tthis.#cache.set('isLeadEnabled', value);\n\t}\n\n\t#isLeadEnabled(): boolean\n\t{\n\t\treturn this.#cache.get('isLeadEnabled');\n\t}\n\n\t#setIsAllowedCreateField(value: boolean)\n\t{\n\t\tthis.#cache.set('isAllowedCreateField', value);\n\t}\n\n\t#isAllowedCreateField(): boolean\n\t{\n\t\treturn this.#cache.get('isAllowedCreateField', false);\n\t}\n\n\t#getSidebarItems(): {[key: string]: any}\n\t{\n\t\treturn Object\n\t\t\t.entries(this.getFieldsList())\n\t\t\t.map(([categoryId, category]) => {\n\t\t\t\tlet label = category.CAPTION;\n\n\t\t\t\tObject.entries(this.#getOptions()?.categoryCaptions).forEach(([category, caption]) => {\n\t\t\t\t\tif (category === categoryId)\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel = caption;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn {\n\t\t\t\t\tlabel,\n\t\t\t\t\tid: categoryId,\n\t\t\t\t\tmoduleId: category?.MODULE_ID,\n\t\t\t\t\tonclick: this.#onSidebarItemClick.bind(this, categoryId),\n\t\t\t\t};\n\t\t\t});\n\t}\n\n\t#getFilter(): SelectorFilter\n\t{\n\t\tconst customFilter = this.#getOptions().filter;\n\t\tif (Type.isPlainObject(customFilter))\n\t\t{\n\t\t\tconst defaultFilter = FieldSelector.#defaultFilter;\n\n\t\t\tif (Type.isArray(customFilter['-categories']))\n\t\t\t{\n\t\t\t\tcustomFilter['-categories'] = [\n\t\t\t\t\t...customFilter['-categories'],\n\t\t\t\t\t...defaultFilter['-categories'],\n\t\t\t\t];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcustomFilter['-categories'] = [\n\t\t\t\t\t...defaultFilter['-categories'],\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tif (!this.#isLeadEnabled())\n\t\t\t{\n\t\t\t\tcustomFilter['-categories'].push('LEAD');\n\t\t\t}\n\n\t\t\tif (Type.isArray(customFilter['-fields']))\n\t\t\t{\n\t\t\t\tcustomFilter['-fields'] = [\n\t\t\t\t\t...customFilter['-fields'],\n\t\t\t\t\t...defaultFilter['-fields'],\n\t\t\t\t];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcustomFilter['-fields'] = [\n\t\t\t\t\t...defaultFilter['-fields'],\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\n\t\treturn customFilter;\n\t}\n\n\t#cleanFieldsList()\n\t{\n\t\tDom.clean(this.#getFieldsListLayout());\n\t}\n\n\t#getSelectedFields(): Array<Field>\n\t{\n\t\treturn this.#cache.get('selectedFields', []);\n\t}\n\n\t#addSelectedField(field: Field)\n\t{\n\t\tconst selectedFields = this.#getSelectedFields();\n\t\tconst hasField = selectedFields.some((currentField) => {\n\t\t\treturn currentField.name === field.name;\n\t\t});\n\n\t\tif (!hasField)\n\t\t{\n\t\t\tselectedFields.push(field);\n\t\t\tthis.#setSelectedFields(selectedFields);\n\t\t}\n\t}\n\n\t#removeSelectedField(field: Field)\n\t{\n\t\tconst selectedFields = this.#getSelectedFields().filter((currentField) => {\n\t\t\treturn currentField.name !== field.name;\n\t\t});\n\n\t\tthis.#setSelectedFields(selectedFields);\n\t}\n\n\t#setSelectedFields(fields: Array<Field>)\n\t{\n\t\tthis.#cache.set('selectedFields', fields);\n\t}\n\n\t#isMultiple(): boolean\n\t{\n\t\treturn this.#getOptions().multiple;\n\t}\n\n\t#renderCategoryFields(categoryId: string)\n\t{\n\t\tthis.#cleanFieldsList();\n\n\t\tconst fields = this.getFieldsList()[categoryId].FIELDS;\n\t\tif (Type.isArrayFilled(fields))\n\t\t{\n\t\t\tfields.forEach((field) => {\n\t\t\t\tvoid new ListItem({\n\t\t\t\t\tfield,\n\t\t\t\t\ttargetContainer: this.#getFieldsListLayout(),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonChange: this.#onListItemChange.bind(this),\n\t\t\t\t\t},\n\t\t\t\t\tselected: this.#getSelectedFields().some((selectedField) => {\n\t\t\t\t\t\treturn selectedField.name === field.name;\n\t\t\t\t\t}),\n\t\t\t\t\ttype: this.#isMultiple() ? ListItem.Type.CHECKBOX : ListItem.Type.RADIO,\n\t\t\t\t\tdisabled: this.#isFieldDisabled(field),\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.#setAddButtonEnabledByCategory(categoryId);\n\t}\n\n\t#getDisabledFields(): SelectorOptions['disabledFields'] | null\n\t{\n\t\treturn this.#getOptions().disabledFields ?? null;\n\t}\n\n\t#isFieldDisabled(field: Field): boolean\n\t{\n\t\tconst disabledFields = this.#getDisabledFields();\n\t\tif (Type.isNull(disabledFields))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn disabledFields.some((fieldRule) => (Type.isString(fieldRule) && field.name === fieldRule)\n\t\t\t|| (Type.isFunction(fieldRule) && fieldRule(field)));\n\t}\n\n\t#onListItemChange(event: BaseEvent)\n\t{\n\t\tconst listItem: ListItem = event.getTarget();\n\t\tif (this.#isMultiple())\n\t\t{\n\t\t\tif (listItem.isSelected())\n\t\t\t{\n\t\t\t\tthis.#addSelectedField(listItem.getField());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#removeSelectedField(listItem.getField());\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#setSelectedFields([listItem.getField()]);\n\t\t}\n\t}\n\n\t#onSidebarItemClick(categoryId: string)\n\t{\n\t\tthis.#renderCategoryFields(categoryId);\n\t}\n\n\t#onBackendError(error)\n\t{\n\t\tconsole.error(error);\n\t\tthis.emit('onError', { error });\n\t}\n\n\t#getLayout(): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-fields-selector\">\n\t\t\t\t${this.#getFieldsListLayout()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tasync #onSearchChange()\n\t{\n\t\tconst sliderLayout: Layout = await this.#getSliderLayout();\n\t\tconst sidebarItems = this.#getSidebarItems();\n\t\tsliderLayout.getMenu().setItems(sidebarItems);\n\n\t\tthis.#cleanFieldsList();\n\n\t\tconst [firstSidebarItem] = sidebarItems;\n\t\tif (firstSidebarItem)\n\t\t{\n\t\t\tthis.#onSidebarItemClick(firstSidebarItem.id);\n\t\t\tsliderLayout.getMenu().setActiveFirstItem();\n\t\t\tif (this.#isAllowedCreateField())\n\t\t\t{\n\t\t\t\tthis.#getCreateFieldButton().setDisabled(false);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.#isAllowedCreateField())\n\t\t\t{\n\t\t\t\tthis.#getCreateFieldButton().setDisabled(true);\n\t\t\t}\n\t\t}\n\t}\n\n\t#getSearch(): Search\n\t{\n\t\treturn this.#cache.remember('search', () => {\n\t\t\treturn new Search({\n\t\t\t\tevents: {\n\t\t\t\t\tonChange: this.#onSearchChange.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\t#getFieldsListLayout(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember('fieldsListLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"sign-b2e-fields-selector-fields-list\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getCreateFieldButton(): Button\n\t{\n\t\treturn this.#cache.remember('createFieldButton', () => {\n\t\t\treturn new Button({\n\t\t\t\ttext: Loc.getMessage('SIGN_B2E_FIELDS_SELECTOR_CREATE_BUTTON_LABEL'),\n\t\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\t\tonclick: this.#onCreateFieldClick.bind(this),\n\t\t\t});\n\t\t});\n\t}\n\n\tasync #onCreateFieldClick()\n\t{\n\t\tconst sliderLayout = await this.#getSliderLayout();\n\t\tconst sliderMenu = sliderLayout.getMenu();\n\t\tif (sliderMenu.hasActive())\n\t\t{\n\t\t\tconst currentCategoryId = sliderMenu.getActiveItem().getId();\n\t\t\tconst moduleId = sliderMenu.getActiveItem().getModuleId() || DEFAULT_FIELD_MODULE_ID;\n\t\t\tconst factory = this.#getUserFieldFactory(currentCategoryId, moduleId);\n\t\t\tconst menu = factory.getMenu();\n\n\t\t\tmenu.open((selectedType) => {\n\t\t\t\tconst configurator = factory.getConfigurator({\n\t\t\t\t\tuserField: factory.createUserField(selectedType),\n\t\t\t\t\tcanMultipleFields: false,\n\t\t\t\t\tcanRequiredFields: false,\n\t\t\t\t\tonSave: (userField) => {\n\t\t\t\t\t\tDom.addClass(configurator.saveButton, 'ui-btn-wait');\n\n\t\t\t\t\t\tconst languages = new Set(Object.keys(this.#getOptions().languages));\n\t\t\t\t\t\tconst currentLanguage = Loc.getMessage('LANGUAGE_ID');\n\t\t\t\t\t\tconst currentValue = userField.data.editFormLabel[currentLanguage];\n\t\t\t\t\t\tlanguages.forEach((lang) => {\n\t\t\t\t\t\t\tuserField.data.editFormLabel[lang] = currentValue;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn userField\n\t\t\t\t\t\t\t.save()\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\treturn this.#load();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tDom.removeClass(configurator.saveButton, 'ui-btn-wait');\n\t\t\t\t\t\t\t\tthis.#onSidebarItemClick(currentCategoryId);\n\t\t\t\t\t\t\t\tthis.#getSearch().setValue(\n\t\t\t\t\t\t\t\t\tuserField.getData().editFormLabel[currentLanguage],\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tonCancel: () => {\n\t\t\t\t\t\tthis.#onSidebarItemClick(currentCategoryId);\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tthis.#cleanFieldsList();\n\t\t\t\tDom.append(configurator.render(), this.#getFieldsListLayout());\n\t\t\t});\n\t\t}\n\t}\n\n\t#getPreparedCategoryId(categoryId: string): string | number\n\t{\n\t\tif (categoryId.startsWith('PROFILE'))\n\t\t{\n\t\t\treturn 'USER_LEGAL';\n\t\t}\n\n\t\tif (categoryId.startsWith('DYNAMIC_'))\n\t\t{\n\t\t\tconst fieldsList = this.getFieldsList();\n\t\t\tif (Type.isPlainObject(fieldsList[categoryId]))\n\t\t\t{\n\t\t\t\treturn fieldsList[categoryId].DYNAMIC_ID;\n\t\t\t}\n\t\t}\n\n\t\treturn `CRM_${categoryId}`;\n\t}\n\n\t#getFieldsFactoryTypesFilter(): FieldsFactoryFilter\n\t{\n\t\tconst defaultFilter = Runtime.clone(FieldSelector.#defaultFieldsFactoryFilter);\n\t\tconst customFilter = this.#getOptions()?.fieldsFactory?.filter;\n\n\t\tif (Type.isPlainObject(customFilter))\n\t\t{\n\t\t\tif (Type.isArrayFilled(customFilter['-types']))\n\t\t\t{\n\t\t\t\tcustomFilter['-types'] = [\n\t\t\t\t\t...defaultFilter['-types'],\n\t\t\t\t\t...customFilter['-types'],\n\t\t\t\t];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcustomFilter['-types'] = [\n\t\t\t\t\t...defaultFilter['-types'],\n\t\t\t\t];\n\t\t\t}\n\n\t\t\treturn customFilter;\n\t\t}\n\n\t\tif (Type.isFunction(customFilter))\n\t\t{\n\t\t\treturn customFilter;\n\t\t}\n\n\t\treturn defaultFilter;\n\t}\n\n\t#applyFieldsFactoryTypesFilter(types, filter): Array<any>\n\t{\n\t\tif (Type.isPlainObject(filter))\n\t\t{\n\t\t\treturn types.filter((type) => {\n\t\t\t\tconst allowed = (\n\t\t\t\t\t!Type.isArrayFilled(filter['+types'])\n\t\t\t\t\t|| filter['+types'].some((condition) => {\n\t\t\t\t\t\tif (Type.isStringFilled(condition))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn type.name === condition;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isFunction(condition))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn condition(type);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst disallowed = (\n\t\t\t\t\tType.isArrayFilled(filter['-types'])\n\t\t\t\t\t&& filter['-types'].some((condition) => {\n\t\t\t\t\t\tif (Type.isStringFilled(condition))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn type.name === condition;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isFunction(condition))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn condition(type);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\treturn allowed && !disallowed;\n\t\t\t});\n\t\t}\n\n\t\treturn types;\n\t}\n\n\t#getUserFieldFactory(categoryId: string | number, moduleId: string): Factory\n\t{\n\t\treturn this.#cache.remember(`factory_${categoryId}`, () => {\n\t\t\tconst rootWindow = window.top;\n\t\t\tconst Factory = (() => {\n\t\t\t\tif (rootWindow.BX.UI.UserFieldFactory)\n\t\t\t\t{\n\t\t\t\t\treturn rootWindow.BX.UI.UserFieldFactory.Factory;\n\t\t\t\t}\n\n\t\t\t\treturn BX.UI.UserFieldFactory.Factory;\n\t\t\t})();\n\n\t\t\tconst factory = new Factory(\n\t\t\t\tthis.#getPreparedCategoryId(categoryId),\n\t\t\t\t{\n\t\t\t\t\tmoduleId: moduleId || DEFAULT_FIELD_MODULE_ID,\n\t\t\t\t\tbindElement: this.#getCreateFieldButton().render(),\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tconst filter = this.#getFieldsFactoryTypesFilter();\n\t\t\tif (Type.isFunction(filter))\n\t\t\t{\n\t\t\t\tfactory.types = this.#applyFieldsFactoryTypesFilter(\n\t\t\t\t\tfactory.types,\n\t\t\t\t\tFieldSelector.defaultFieldsFactoryFilter,\n\t\t\t\t);\n\t\t\t\tfactory.types = filter(factory.types);\n\t\t\t}\n\n\t\t\tif (Type.isPlainObject(filter))\n\t\t\t{\n\t\t\t\tfactory.types = this.#applyFieldsFactoryTypesFilter(\n\t\t\t\t\tfactory.types,\n\t\t\t\t\tfilter,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn factory;\n\t\t});\n\t}\n\n\t#getTitle(): string\n\t{\n\t\tconst options = this.#getOptions();\n\n\t\tif (!Type.isStringFilled(options.title))\n\t\t{\n\t\t\treturn Loc.getMessage('SIGN_B2E_FIELDS_SELECTOR_SLIDER_FIRST_PARTY_TITLE');\n\t\t}\n\n\t\treturn options.title;\n\t}\n\n\t#getSliderLayout(): Promise<Layout>\n\t{\n\t\treturn this.#cache.remember('sliderLayout', () => {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tLayout\n\t\t\t\t\t.createLayout({\n\t\t\t\t\t\textensions: ['sign.b2e.field-selector'],\n\t\t\t\t\t\ttitle: this.#getTitle(),\n\t\t\t\t\t\tcontent: () => {\n\t\t\t\t\t\t\treturn this.#getLayout();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmenu: {\n\t\t\t\t\t\t\titems: this.#getSidebarItems(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttoolbar: () => {\n\t\t\t\t\t\t\tconst toolbarItems = [this.#getSearch().getLayout()];\n\t\t\t\t\t\t\tif (this.#getOptions().alwaysHideCreateFieldButton !== true)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttoolbarItems.push(this.#getCreateFieldButton());\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn toolbarItems;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({ SaveButton, closeButton }) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('SIGN_B2E_FIELDS_SELECTOR_APPLY_BUTTON_LABEL'),\n\t\t\t\t\t\t\t\t\tonclick: this.#onSaveClick.bind(this),\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcloseButton,\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\t#getRenderedSliderLayout(): Promise<any>\n\t{\n\t\treturn this.#cache.remember('renderedSliderLayout', () => {\n\t\t\treturn this.#getSliderLayout().then((layout) => {\n\t\t\t\treturn layout.render();\n\t\t\t});\n\t\t});\n\t}\n\n\t#onSaveClick()\n\t{\n\t\tconst selectedFields = this.#getSelectedFields();\n\t\tconst result = (() => {\n\t\t\tconst { resultModifier } = this.#getOptions();\n\t\t\tif (Type.isFunction(resultModifier))\n\t\t\t{\n\t\t\t\treturn resultModifier(selectedFields);\n\t\t\t}\n\n\t\t\treturn selectedFields.map((field) => {\n\t\t\t\treturn field.name;\n\t\t\t});\n\t\t})();\n\n\t\tthis.#getPromiseResolver()(result);\n\t\tthis.hide();\n\t}\n\n\t#setPromiseResolver(resolver: () => void)\n\t{\n\t\tthis.#cache.set('promiseResolver', resolver);\n\t}\n\n\t#getPromiseResolver(): () => void\n\t{\n\t\treturn this.#cache.get('promiseResolver', () => {});\n\t}\n\n\t#selectFirstCategory()\n\t{\n\t\tconst [firstSidebarItem] = this.#getSidebarItems();\n\t\tif (Type.isPlainObject(firstSidebarItem))\n\t\t{\n\t\t\tthis.#onSidebarItemClick(firstSidebarItem.id);\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tconst SidePanel: BX.SidePanel = Reflection.getClass('BX.SidePanel');\n\t\tif (SidePanel.Instance)\n\t\t{\n\t\t\tSidePanel.Instance.close();\n\t\t}\n\t}\n\n\t#getSliderId(): string\n\t{\n\t\treturn this.#cache.remember('sliderId', () => {\n\t\t\treturn `sign.b2e.fields.selector-${Text.getRandom()}`;\n\t\t});\n\t}\n\n\tshow(): Promise<Array<any>>\n\t{\n\t\tconst SidePanel: BX.SidePanel = Reflection.getClass('BX.SidePanel');\n\t\tif (SidePanel.Instance)\n\t\t{\n\t\t\tconst createFieldButton = this.#getCreateFieldButton();\n\t\t\tcreateFieldButton.setDisabled(true);\n\n\t\t\tSidePanel.Instance.open(\n\t\t\t\tthis.#getSliderId(),\n\t\t\t\t{\n\t\t\t\t\twidth: 740,\n\t\t\t\t\tcontentCallback: () => {\n\t\t\t\t\t\treturn this.#load()\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tcreateFieldButton.setDisabled(!this.#isAllowedCreateField());\n\t\t\t\t\t\t\t\tthis.#selectFirstCategory();\n\n\t\t\t\t\t\t\t\treturn this.#getRenderedSliderLayout();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(({ errors }) => {\n\t\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t\t<div class=\"ui-alert ui-alert-danger\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"ui-alert-message\">${errors.map((item) => Text.encode(item.message)).join('\\n')}</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonCloseComplete: () => this.#onSliderCloseComplete(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.#setPromiseResolver(resolve);\n\t\t});\n\t}\n\n\t#onSliderCloseComplete(): void\n\t{\n\t\tthis.emit('onSliderCloseComplete');\n\t\tthis.#setSelectedFields([]);\n\t}\n\n\t#setAddButtonEnabledByCategory(categoryId: string): void\n\t{\n\t\tif (Object.hasOwn(this.#permissionAddByCategory, categoryId))\n\t\t{\n\t\t\tconst isAllowed = this.#permissionAddByCategory[categoryId];\n\t\t\tthis.#setIsAllowedCreateField(isAllowed);\n\t\t\tthis.#getCreateFieldButton().setDisabled(!isAllowed);\n\t\t}\n\t}\n}\n"],"names":["DefaultUri","Backend","EventEmitter","constructor","options","setEventNamespace","subscribeFromOptions","events","setCustomSettings","customSettings","getData","requestOptions","data","Promise","resolve","reject","ajax","runAction","json","then","catch","Type","isStringFilled","uri","Search","Cache","MemoryCache","getValue","value","setValue","getLayout","remember","Tag","render","set","get","emit","Runtime","debounce","initialValue","bind","Text","encode","Loc","getMessage","event","preventDefault","ListItem","targetContainer","isDomNode","renderTo","getField","field","isSelected","checked","fieldDisabledClassName","caption","Dom","append","type","CHECKBOX","selected","disabled","RADIO","DEFAULT_FIELD_MODULE_ID","FieldSelector","setCustomBackendSettings","customBackendSettings","getFieldsList","filtering","fieldsList","filter","isPlainObject","query","isFunction","defaultFilter","clone","push","prefilteredFieldsList","loadFieldList","onError","fields","hide","SidePanel","Reflection","getClass","Instance","close","show","createFieldButton","setDisabled","open","width","contentCallback","errors","map","item","message","join","onCloseComplete","multiple","isObject","SMART_B2E_DOC","CAPTION","fieldsEntries","Object","entries","reduce","acc","categoryId","category","isArrayFilled","includes","filteredFields","FIELDS","allowed","some","condition","every","key","disallowed","allowEmptyFieldList","isArray","preparedQuery","String","toLowerCase","controllerOptions","isLeadEnabled","permissions","userField","add","addByCategory","label","categoryCaptions","forEach","id","moduleId","MODULE_ID","onclick","customFilter","clean","selectedFields","hasField","currentField","name","onChange","selectedField","disabledFields","isNull","fieldRule","isString","listItem","getTarget","error","console","sliderLayout","sidebarItems","getMenu","setItems","firstSidebarItem","setActiveFirstItem","Button","text","color","Color","SUCCESS","sliderMenu","hasActive","currentCategoryId","getActiveItem","getId","getModuleId","factory","menu","selectedType","configurator","getConfigurator","createUserField","canMultipleFields","canRequiredFields","onSave","addClass","saveButton","languages","Set","keys","currentLanguage","currentValue","editFormLabel","lang","save","removeClass","onCancel","startsWith","DYNAMIC_ID","fieldsFactory","types","rootWindow","window","top","Factory","BX","UI","UserFieldFactory","bindElement","defaultFieldsFactoryFilter","title","Layout","createLayout","extensions","content","items","toolbar","toolbarItems","alwaysHideCreateFieldButton","buttons","SaveButton","closeButton","result","layout","resultModifier","resolver","getRandom","hasOwn","isAllowed"],"mappings":"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"}