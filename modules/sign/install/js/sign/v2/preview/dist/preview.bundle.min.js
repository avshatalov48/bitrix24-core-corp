this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};(function(e,s,a){"use strict";let l=e=>e,i,t,r,o,b,c,n,d,v,p,h;const P=.25;var L=babelHelpers.classPrivateFieldLooseKey("placeholder");var H=babelHelpers.classPrivateFieldLooseKey("page");var F=babelHelpers.classPrivateFieldLooseKey("pageNumber");var B=babelHelpers.classPrivateFieldLooseKey("scale");var u=babelHelpers.classPrivateFieldLooseKey("controls");var g=babelHelpers.classPrivateFieldLooseKey("blocksContainer");var m=babelHelpers.classPrivateFieldLooseKey("blocks");var f=babelHelpers.classPrivateFieldLooseKey("urls");var y=babelHelpers.classPrivateFieldLooseKey("loader");var _=babelHelpers.classPrivateFieldLooseKey("content");var w=babelHelpers.classPrivateFieldLooseKey("createBlockStyles");var C=babelHelpers.classPrivateFieldLooseKey("createBlocks");var D=babelHelpers.classPrivateFieldLooseKey("getBlockContent");var O=babelHelpers.classPrivateFieldLooseKey("getImageLayout");var $=babelHelpers.classPrivateFieldLooseKey("getTextLayout");var j=babelHelpers.classPrivateFieldLooseKey("createControls");var k=babelHelpers.classPrivateFieldLooseKey("render");var K=babelHelpers.classPrivateFieldLooseKey("renderContent");var T=babelHelpers.classPrivateFieldLooseKey("renderBlocks");var E=babelHelpers.classPrivateFieldLooseKey("renderControls");var x=babelHelpers.classPrivateFieldLooseKey("renderPagination");var S=babelHelpers.classPrivateFieldLooseKey("renderZoom");class X{constructor(){Object.defineProperty(this,S,{value:J});Object.defineProperty(this,x,{value:q});Object.defineProperty(this,E,{value:Z});Object.defineProperty(this,T,{value:W});Object.defineProperty(this,K,{value:N});Object.defineProperty(this,k,{value:G});Object.defineProperty(this,j,{value:A});Object.defineProperty(this,$,{value:V});Object.defineProperty(this,O,{value:R});Object.defineProperty(this,D,{value:M});Object.defineProperty(this,C,{value:I});Object.defineProperty(this,w,{value:z});Object.defineProperty(this,L,{writable:true,value:void 0});Object.defineProperty(this,H,{writable:true,value:void 0});Object.defineProperty(this,F,{writable:true,value:void 0});Object.defineProperty(this,B,{writable:true,value:void 0});Object.defineProperty(this,u,{writable:true,value:void 0});Object.defineProperty(this,g,{writable:true,value:void 0});Object.defineProperty(this,m,{writable:true,value:void 0});Object.defineProperty(this,f,{writable:true,value:void 0});Object.defineProperty(this,y,{writable:true,value:void 0});Object.defineProperty(this,_,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,L)[L]=s.Tag.render(i||(i=l`
			<div class="sign-preview__placeholder">
				<p class="sign-preview__placeholder_text">
					${0}
				</p>
				<img
					src="/bitrix/js/sign/v2/preview/src/images/placeholder.png"
					class="sign-preview__placeholder__img"
				/>
			</div>`),s.Loc.getMessage("SIGN_PREVIEW_PLACEHOLDER_TEXT"));babelHelpers.classPrivateFieldLooseBase(this,H)[H]=s.Tag.render(t||(t=l`<img class="sign-preview__page" />`));babelHelpers.classPrivateFieldLooseBase(this,g)[g]=s.Tag.render(r||(r=l`<div class="sign-preview__blocks"></div>`));babelHelpers.classPrivateFieldLooseBase(this,_)[_]=s.Tag.render(o||(o=l`
			<div class="sign-preview__content">
				<div class="sign-preview__content_scalable">
					${0}
					${0}
					${0}
				</div>
			</div>`),babelHelpers.classPrivateFieldLooseBase(this,L)[L],babelHelpers.classPrivateFieldLooseBase(this,H)[H],babelHelpers.classPrivateFieldLooseBase(this,g)[g]);babelHelpers.classPrivateFieldLooseBase(this,m)[m]=new Map;babelHelpers.classPrivateFieldLooseBase(this,u)[u]=babelHelpers.classPrivateFieldLooseBase(this,j)[j]();babelHelpers.classPrivateFieldLooseBase(this,f)[f]=[];babelHelpers.classPrivateFieldLooseBase(this,F)[F]=0;babelHelpers.classPrivateFieldLooseBase(this,B)[B]=1;babelHelpers.classPrivateFieldLooseBase(this,y)[y]=new a.Loader({target:babelHelpers.classPrivateFieldLooseBase(this,_)[_],size:80})}getLayout(){const e=s.Tag.render(b||(b=l`
			<div class="sign-preview">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,_)[_],babelHelpers.classPrivateFieldLooseBase(this,u)[u]);babelHelpers.classPrivateFieldLooseBase(this,k)[k]();return e}set urls(e){babelHelpers.classPrivateFieldLooseBase(this,f)[f]=e.length?[...babelHelpers.classPrivateFieldLooseBase(this,f)[f],...e]:[];babelHelpers.classPrivateFieldLooseBase(this,K)[K]();babelHelpers.classPrivateFieldLooseBase(this,E)[E]()}set ready(e){if(e){babelHelpers.classPrivateFieldLooseBase(this,y)[y].hide();s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,_)[_],"--with-overlay");return}s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,_)[_],"--with-overlay");babelHelpers.classPrivateFieldLooseBase(this,y)[y].show()}async setBlocks(e=[]){s.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,g)[g]);if(!(e!=null&&e.length)){return}babelHelpers.classPrivateFieldLooseBase(this,m)[m]=await babelHelpers.classPrivateFieldLooseBase(this,C)[C](e);babelHelpers.classPrivateFieldLooseBase(this,T)[T]()}}function z(e){const{style:s,position:a,type:l}=e;const{width:i,height:t,widthPx:r,heightPx:o}=a;const b={...s,top:`${a.top}%`,left:`${a.left}%`,width:`${i}%`,height:`${t}%`};if(l==="image"){return b}const{width:c,height:n}=babelHelpers.classPrivateFieldLooseBase(this,H)[H].getBoundingClientRect();const d=r/(i/100*c);const v=o/(t/100*n);const p=(parseFloat(s["fontSize"])||14)/d;const h=`${5/v}px ${8/d}px`;Object.assign(b,{padding:h,fontSize:`${p}px`});return b}async function I(e){const a=babelHelpers.classPrivateFieldLooseBase(this,H)[H].complete&&babelHelpers.classPrivateFieldLooseBase(this,H)[H].naturalHeight!==0;if(!a){await new Promise((e=>s.Event.bindOnce(babelHelpers.classPrivateFieldLooseBase(this,H)[H],"load",e)))}const{blocksTemplate:i,blocks:t}=e.reduce(((e,a)=>{var i;const t=s.Tag.render(c||(c=l`
				<div class="sign-preview__block"></div>
			`));const r=babelHelpers.classPrivateFieldLooseBase(this,D)[D](a);if(r){s.Dom.append(r,t);s.Dom.addClass(t,"--filled")}const o=babelHelpers.classPrivateFieldLooseBase(this,w)[w](a);Object.keys(o).forEach((e=>{t.style[e]=o[e]}));const{blocks:b,blocksTemplate:n}=e;const{page:d}=a.position;b.set(d,[...(i=b.get(d))!=null?i:[],t]);s.Dom.append(t,n);return e}),{blocks:new Map,blocksTemplate:new DocumentFragment});s.Dom.append(i,babelHelpers.classPrivateFieldLooseBase(this,g)[g]);return t}function M(e){if(e.type==="image"){return babelHelpers.classPrivateFieldLooseBase(this,O)[O](e)}return babelHelpers.classPrivateFieldLooseBase(this,$)[$](e)}function R(e){var a;const i=(a=e.data.__view)==null?void 0:a.base64;if(!i){return null}return s.Tag.render(n||(n=l`<img src="data:image;base64,${0}" />`),i)}function V(e){let a=e.data.text;if(!a){return null}a=s.Text.encode(a);const i=s.Tag.render(d||(d=l`<span>${0}</span>`),a);i.innerHTML=a.replaceAll("[br]","<br />");return i}function A(){const e=s.Tag.render(v||(v=l`
			<div class="sign-preview__pagination">
				<span
					class="sign-preview__btn sign-preview__pagination_btn --prev"
					onclick="${0}"
				>
				</span>
				<span class="sign-preview__pagination_page-num"></span>
				<span
					class="sign-preview__btn sign-preview__pagination_btn --next"
					onclick="${0}"
				>
				</span>
			</div>
		`),(()=>{babelHelpers.classPrivateFieldLooseBase(this,F)[F]-=1;babelHelpers.classPrivateFieldLooseBase(this,k)[k]()}),(()=>{babelHelpers.classPrivateFieldLooseBase(this,F)[F]+=1;babelHelpers.classPrivateFieldLooseBase(this,k)[k]()}));const a=s.Tag.render(p||(p=l`
			<div class="sign-preview__zoom">
				<span
					class="sign-preview__btn sign-preview__zoom_btn --plus"
					onclick="${0}"
				>
				</span>
				<span class="sign-preview__zoom_value">100%</span>
				<span
					class="sign-preview__btn sign-preview__zoom_btn --minus"
					onclick="${0}"
				></span>
			</div>
		`),(()=>{babelHelpers.classPrivateFieldLooseBase(this,B)[B]-=P;babelHelpers.classPrivateFieldLooseBase(this,K)[K]();babelHelpers.classPrivateFieldLooseBase(this,S)[S]()}),(()=>{babelHelpers.classPrivateFieldLooseBase(this,B)[B]+=P;babelHelpers.classPrivateFieldLooseBase(this,K)[K]();babelHelpers.classPrivateFieldLooseBase(this,S)[S]()}));return s.Tag.render(h||(h=l`
			<div class="sign-preview__controls">
				${0}
				${0}
			</div>
		`),e,a)}function G(){babelHelpers.classPrivateFieldLooseBase(this,K)[K]();babelHelpers.classPrivateFieldLooseBase(this,T)[T]();babelHelpers.classPrivateFieldLooseBase(this,E)[E]()}function N(){s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,L)[L],"--hidden");s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,H)[H],"--hidden");const{parentElement:e}=babelHelpers.classPrivateFieldLooseBase(this,H)[H];if(babelHelpers.classPrivateFieldLooseBase(this,f)[f].length===0){s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,H)[H],"--hidden");babelHelpers.classPrivateFieldLooseBase(this,H)[H].src="";e.style.transform="";return}s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,L)[L],"--hidden");const a=babelHelpers.classPrivateFieldLooseBase(this,f)[f][babelHelpers.classPrivateFieldLooseBase(this,F)[F]];babelHelpers.classPrivateFieldLooseBase(this,H)[H].src=a;e.style.transform=`scale(${babelHelpers.classPrivateFieldLooseBase(this,B)[B]})`}function W(){var e;const a=(e=babelHelpers.classPrivateFieldLooseBase(this,m)[m].get(babelHelpers.classPrivateFieldLooseBase(this,F)[F]+1))!=null?e:[];const l=[...babelHelpers.classPrivateFieldLooseBase(this,m)[m].values()].flat();l.forEach((e=>{if(a.includes(e)){s.Dom.removeClass(e,"--hidden");return}s.Dom.addClass(e,"--hidden")}))}function Z(){if(babelHelpers.classPrivateFieldLooseBase(this,f)[f].length===0){s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,u)[u],"--locked");babelHelpers.classPrivateFieldLooseBase(this,F)[F]=0;babelHelpers.classPrivateFieldLooseBase(this,B)[B]=1;return}s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,u)[u],"--locked");babelHelpers.classPrivateFieldLooseBase(this,x)[x]();babelHelpers.classPrivateFieldLooseBase(this,S)[S]()}function q(){const[e]=babelHelpers.classPrivateFieldLooseBase(this,u)[u].children;const[a,l,i]=e.children;const t=s.Loc.getMessage("SIGN_PREVIEW_PAGE");const r=babelHelpers.classPrivateFieldLooseBase(this,f)[f].length;s.Dom.removeClass(a,"--disabled");s.Dom.removeClass(i,"--disabled");l.textContent=`${t} ${babelHelpers.classPrivateFieldLooseBase(this,F)[F]+1}/${r}`;if(babelHelpers.classPrivateFieldLooseBase(this,F)[F]===0){s.Dom.addClass(a,"--disabled")}if(babelHelpers.classPrivateFieldLooseBase(this,F)[F]===r-1){s.Dom.addClass(i,"--disabled")}}function J(){const[,e]=babelHelpers.classPrivateFieldLooseBase(this,u)[u].children;const[a,l,i]=e.children;l.textContent=`${babelHelpers.classPrivateFieldLooseBase(this,B)[B]*100}%`;const t=babelHelpers.classPrivateFieldLooseBase(this,H)[H].parentElement.parentElement;if(babelHelpers.classPrivateFieldLooseBase(this,B)[B]!==1){s.Dom.addClass(t,"--overflowed");s.Dom.removeClass(a,"--disabled");if(babelHelpers.classPrivateFieldLooseBase(this,B)[B]===2){s.Dom.addClass(i,"--disabled")}}else{s.Dom.addClass(a,"--disabled");s.Dom.removeClass(i,"--disabled");s.Dom.removeClass(t,"--overflowed")}}e.Preview=X})(this.BX.Sign.V2=this.BX.Sign.V2||{},BX,BX);
//# sourceMappingURL=preview.bundle.map.js