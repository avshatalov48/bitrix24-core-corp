{"version":3,"file":"sign-settings.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Tag, Loc, Dom, Reflection, Text } from 'main.core';\nimport { Wizard, type WizardOptions, type Metadata } from 'ui.wizard';\nimport { type DocumentData } from 'sign.v2.document-setup';\nimport { Preview } from 'sign.v2.preview';\nimport type { SignOptions, SignOptionsConfig } from './types';\nimport type { Editor } from 'sign.v2.editor';\nimport './style.css';\n\nexport type { SignOptions, SignOptionsConfig };\n\nexport type DocumentModeType = 'document' | 'template';\nexport const DocumentMode: Readonly<Record<string, DocumentModeType>> = Object.freeze({\n\tdocument: 'document',\n\ttemplate: 'template',\n});\nexport function isTemplateMode(mode: string): boolean\n{\n\treturn mode === DocumentMode.template;\n}\n\nexport class SignSettings\n{\n\t#containerId: string;\n\t#preview: Preview;\n\t#type: string;\n\t#wizardOptions: WizardOptions;\n\tdocumentSetup: DocumentSetup;\n\tdocumentSend: DocumentSend;\n\twizard: Wizard;\n\teditor: Editor;\n\t#previewLayout: ?HTMLElement = null;\n\t#container: HTMLElement | null = null;\n\t#overlayContainer: HTMLElement | null = null;\n\t#currentOverlay: HTMLElement | null = null;\n\tdocumentMode: DocumentModeType;\n\n\tconstructor(containerId: string, signOptions: SignOptions = {}, wizardOptions: WizardOptions = {})\n\t{\n\t\tthis.#containerId = containerId;\n\t\tthis.#preview = new Preview();\n\t\tthis.#wizardOptions = wizardOptions;\n\t\tconst { type = '', config = {}, documentMode } = signOptions;\n\t\tthis.documentMode = documentMode;\n\t\tthis.#type = type;\n\t\tconst { languages } = config.documentSendConfig ?? {};\n\t\tconst EditorConstructor = Reflection.getClass('top.BX.Sign.V2.Editor');\n\t\tthis.editor = new EditorConstructor(type, { languages });\n\t}\n\n\t#createHead(): HTMLElement\n\t{\n\t\tconst headerTitle = this.isTemplateMode()\n\t\t\t? Loc.getMessage('SIGN_SETTINGS_TITLE_TEMPLATE')\n\t\t\t: Loc.getMessage('SIGN_SETTINGS_TITLE');\n\n\t\tconst headerTitleSub = this.#type === 'b2b'\n\t\t\t? Loc.getMessage('SIGN_SETTINGS_B2B_TITLE_SUB')\n\t\t\t: Loc.getMessage('SIGN_SETTINGS_B2E_TITLE_SUB')\n\t\t;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-settings__head\">\n\t\t\t\t<div>\n\t\t\t\t\t<p class=\"sign-settings__head_title\">${headerTitle}</p>\n\t\t\t\t\t<p class=\"sign-settings__head_title --sub\">\n\t\t\t\t\t\t${headerTitleSub}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tisTemplateMode(): boolean\n\t{\n\t\treturn this.documentMode === DocumentMode.template;\n\t}\n\n\t#getLayout(): HTMLElement\n\t{\n\t\tconst className = this.#type === 'b2e' ? 'sign-settings --b2e' : 'sign-settings';\n\n\t\tthis.#previewLayout = this.#preview.getLayout();\n\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"sign-settings__scope ${className}\">\n\t\t\t\t<div class=\"sign-settings__sidebar\">\n\t\t\t\t\t${this.#createHead()}\n\t\t\t\t\t${this.wizard.getLayout()}\n\t\t\t\t</div>\n\t\t\t\t${this.#previewLayout}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#container;\n\t}\n\n\t#getOverlayContainer(): HTMLElement\n\t{\n\t\tif (!this.#overlayContainer)\n\t\t{\n\t\t\tthis.#overlayContainer = Tag.render`<div class=\"sign-settings__overlay\"></div>`;\n\t\t}\n\t\tDom.hide(this.#overlayContainer);\n\n\t\treturn this.#overlayContainer;\n\t}\n\n\t#showCompleteNotification(): void\n\t{\n\t\tconst Notification = Reflection.getClass('top.BX.UI.Notification');\n\t\tNotification.Center.notify({\n\t\t\tcontent: Text.encode(Loc.getMessage('SIGN_SETTINGS_COMPLETE_NOTIFICATION_TEXT')),\n\t\t\tautoHideDelay: 4000,\n\t\t});\n\t}\n\n\tonComplete(showNotification: boolean = true): void\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t\tif (showNotification)\n\t\t{\n\t\t\tthis.#showCompleteNotification();\n\t\t}\n\t\tconst queryString = window.location.search;\n\t\tconst urlParams = new URLSearchParams(queryString);\n\t\tif (!urlParams.has('noRedirect'))\n\t\t{\n\t\t\tconst { entityTypeId, entityId } = this.documentSetup.setupData;\n\t\t\tconst detailsUrl = `/crm/type/${entityTypeId}/details/${entityId}/`;\n\t\t\tBX.SidePanel.Instance.open(detailsUrl);\n\t\t}\n\t}\n\n\t#renderPages(blocks: DocumentData['blocks'], preparedPages: boolean = false): void\n\t{\n\t\tthis.#preview.ready = false;\n\t\tthis.#preview.setBlocks(blocks);\n\t\tthis.wizard.toggleBtnActiveState('back', true);\n\t\tconst handler = (urls, totalPages): void => {\n\t\t\tthis.#preview.ready = true;\n\t\t\tthis.#preview.urls = urls;\n\t\t\tthis.editor.setUrls(urls, totalPages);\n\t\t\tthis.wizard.toggleBtnActiveState('back', false);\n\t\t};\n\n\t\tthis.documentSetup.waitForPagesList(handler, preparedPages);\n\t}\n\n\t#subscribeOnEditorEvents(): void\n\t{\n\t\tthis.editor.subscribe('save', ({ data }) => {\n\t\t\tconst blocks = data.blocks;\n\t\t\tthis.#preview.setBlocks(blocks);\n\t\t\tthis.documentSetup.setupData = {\n\t\t\t\t...this.documentSetup.setupData,\n\t\t\t\tblocks,\n\t\t\t};\n\t\t\tthis.documentSend.documentData = { ...this.documentSend.documentData };\n\t\t});\n\t}\n\n\tsubscribeOnEvents(): void\n\t{\n\t\tconst settingsEvents = [\n\t\t\t{\n\t\t\t\ttype: 'toggleActivity',\n\t\t\t\tstage: 'setup',\n\t\t\t\tmethod: ({ data }) => {\n\t\t\t\t\tconst { selected } = data;\n\t\t\t\t\tthis.wizard.toggleBtnActiveState('next', !selected);\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'addFile',\n\t\t\t\tstage: 'setup',\n\t\t\t\tmethod: ({ data }) => {\n\t\t\t\t\tthis.wizard.toggleBtnActiveState('next', !data.ready);\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'removeFile',\n\t\t\t\tstage: 'setup',\n\t\t\t\tmethod: ({ data }) => {\n\t\t\t\t\tthis.wizard.toggleBtnActiveState('next', !data.ready);\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'clearFiles',\n\t\t\t\tstage: 'setup',\n\t\t\t\tmethod: () => this.wizard.toggleBtnActiveState('next', true),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'showEditor',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: () => this.editor.show(),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'changeTitle',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: ({ data }) => {\n\t\t\t\t\tthis.documentSetup.setupData = {\n\t\t\t\t\t\t...this.documentSetup.setupData,\n\t\t\t\t\t\ttitle: data.title,\n\t\t\t\t\t};\n\t\t\t\t\tconst { blankTitle } = data;\n\t\t\t\t\tif (blankTitle)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst { blankSelector, setupData } = this.documentSetup;\n\t\t\t\t\t\tblankSelector.modifyBlankTitle(setupData.blankId, blankTitle);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'close',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: () => this.onComplete(false),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'hidePreview',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: () => Dom.style(this.#previewLayout, 'display', 'none'),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'showPreview',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: () => Dom.style(this.#previewLayout, 'display', 'flex'),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'appendOverlay',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: (event) => this.#appendOverlay(event?.data?.overlay),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'showOverlay',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: () => this.#showOverlay(),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'hideOverlay',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: () => this.#hideOverlay(),\n\t\t\t},\n\t\t];\n\t\tsettingsEvents.forEach(({ type, method, stage }) => {\n\t\t\tconst step = stage === 'setup' ? this.documentSetup : this.documentSend;\n\t\t\tstep.subscribe(type, method);\n\t\t});\n\t\tthis.#subscribeOnEditorEvents();\n\t}\n\n\t#appendOverlay(overlay: ?HTMLElement): void\n\t{\n\t\tif (!overlay)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#currentOverlay)\n\t\t{\n\t\t\tDom.remove(this.#currentOverlay);\n\t\t}\n\n\t\tthis.#currentOverlay = overlay;\n\n\t\tDom.append(this.#currentOverlay, this.#overlayContainer);\n\t}\n\n\tasync setupDocument(uid?: string, preparedPages: boolean = false): Promise<DocumentData> | null\n\t{\n\t\tif (this.documentSetup.isSameBlankSelected())\n\t\t{\n\t\t\tvoid await this.documentSetup.setup(uid);\n\n\t\t\treturn this.documentSetup.setupData;\n\t\t}\n\n\t\tthis.#preview.urls = [];\n\t\tthis.editor.setUrls([], 0);\n\t\tthis.#preview.setBlocks();\n\t\tawait this.documentSetup.setup(uid);\n\t\tconst { setupData } = this.documentSetup;\n\t\tif (!setupData)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { blocks } = setupData;\n\t\tthis.#renderPages(blocks, preparedPages);\n\n\t\treturn setupData;\n\t}\n\n\tasync init(uid: ?string): void\n\t{\n\t\tconst metadata = this.getStepsMetadata(this);\n\t\tconst { complete, ...rest } = this.#wizardOptions;\n\n\t\tconst title = this.isTemplateMode()\n\t\t\t? Loc.getMessage('SIGN_SETTINGS_CREATE_TEMPLATE')\n\t\t\t: Loc.getMessage('SIGN_SETTINGS_SEND_FOR_SIGN');\n\t\tthis.wizard = new Wizard(metadata, {\n\t\t\tback: { className: 'ui-btn-light-border' },\n\t\t\tnext: { className: 'ui-btn-primary' },\n\t\t\tcomplete: {\n\t\t\t\tclassName: 'ui-btn-primary',\n\t\t\t\ttitle,\n\t\t\t\tonComplete: () => this.onComplete(),\n\t\t\t\t...complete,\n\t\t\t},\n\t\t\t...rest,\n\t\t});\n\t\tif (uid)\n\t\t{\n\t\t\tawait this.applyDocumentData(uid);\n\t\t}\n\n\t\tthis.#render();\n\t}\n\n\t#render(): void\n\t{\n\t\tconst container = document.getElementById(this.#containerId);\n\t\tDom.append(this.#getOverlayContainer(), container);\n\t\tDom.append(this.#getLayout(), container);\n\t\tconst step = this.documentSetup.setupData ? 1 : 0;\n\t\tthis.wizard.toggleBtnActiveState('next', true);\n\t\tthis.wizard.moveOnStep(step);\n\t}\n\n\tgetStepsMetadata(): Metadata\n\t{\n\t\treturn {};\n\t}\n\n\t#showOverlay(): void\n\t{\n\t\tDom.style(this.#container, 'display', 'none');\n\t\tDom.show(this.#overlayContainer);\n\t}\n\n\t#hideOverlay(): void\n\t{\n\t\tDom.style(this.#container, 'display', 'flex');\n\t\tDom.hide(this.#overlayContainer);\n\t}\n}\n"],"names":["DocumentMode","Object","freeze","document","template","isTemplateMode","mode","SignSettings","constructor","containerId","signOptions","wizardOptions","Preview","type","config","documentMode","languages","documentSendConfig","EditorConstructor","Reflection","getClass","editor","onComplete","showNotification","BX","SidePanel","Instance","close","queryString","window","location","search","urlParams","URLSearchParams","has","entityTypeId","entityId","documentSetup","setupData","detailsUrl","open","subscribeOnEvents","settingsEvents","stage","method","data","selected","wizard","toggleBtnActiveState","ready","show","title","blankTitle","blankSelector","modifyBlankTitle","blankId","Dom","style","event","overlay","forEach","step","documentSend","subscribe","setupDocument","uid","preparedPages","isSameBlankSelected","setup","urls","setUrls","setBlocks","blocks","init","metadata","getStepsMetadata","complete","rest","Loc","getMessage","Wizard","back","className","next","applyDocumentData","headerTitle","headerTitleSub","Tag","render","getLayout","hide","Notification","Center","notify","content","Text","encode","autoHideDelay","handler","totalPages","waitForPagesList","documentData","remove","append","container","getElementById","moveOnStep"],"mappings":"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"}