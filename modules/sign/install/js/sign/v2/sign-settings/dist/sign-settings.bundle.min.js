this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};(function(e,s,t,a){"use strict";let i=e=>e,l,o,r;const n=Object.freeze({document:"document",template:"template"});function d(e){return e===n.template}var c=babelHelpers.classPrivateFieldLooseKey("containerId");var b=babelHelpers.classPrivateFieldLooseKey("preview");var p=babelHelpers.classPrivateFieldLooseKey("type");var v=babelHelpers.classPrivateFieldLooseKey("wizardOptions");var h=babelHelpers.classPrivateFieldLooseKey("previewLayout");var u=babelHelpers.classPrivateFieldLooseKey("container");var y=babelHelpers.classPrivateFieldLooseKey("overlayContainer");var P=babelHelpers.classPrivateFieldLooseKey("currentOverlay");var g=babelHelpers.classPrivateFieldLooseKey("createHead");var L=babelHelpers.classPrivateFieldLooseKey("getLayout");var m=babelHelpers.classPrivateFieldLooseKey("getOverlayContainer");var B=babelHelpers.classPrivateFieldLooseKey("showCompleteNotification");var F=babelHelpers.classPrivateFieldLooseKey("renderPages");var S=babelHelpers.classPrivateFieldLooseKey("subscribeOnEditorEvents");var H=babelHelpers.classPrivateFieldLooseKey("appendOverlay");var f=babelHelpers.classPrivateFieldLooseKey("render");var T=babelHelpers.classPrivateFieldLooseKey("showOverlay");var w=babelHelpers.classPrivateFieldLooseKey("hideOverlay");class _{constructor(e,t={},i={}){var l;Object.defineProperty(this,w,{value:k});Object.defineProperty(this,T,{value:G});Object.defineProperty(this,f,{value:K});Object.defineProperty(this,H,{value:j});Object.defineProperty(this,S,{value:M});Object.defineProperty(this,F,{value:N});Object.defineProperty(this,B,{value:D});Object.defineProperty(this,m,{value:E});Object.defineProperty(this,L,{value:I});Object.defineProperty(this,g,{value:O});Object.defineProperty(this,c,{writable:true,value:void 0});Object.defineProperty(this,b,{writable:true,value:void 0});Object.defineProperty(this,p,{writable:true,value:void 0});Object.defineProperty(this,v,{writable:true,value:void 0});Object.defineProperty(this,h,{writable:true,value:null});Object.defineProperty(this,u,{writable:true,value:null});Object.defineProperty(this,y,{writable:true,value:null});Object.defineProperty(this,P,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,c)[c]=e;babelHelpers.classPrivateFieldLooseBase(this,b)[b]=new a.Preview;babelHelpers.classPrivateFieldLooseBase(this,v)[v]=i;const{type:o="",config:r={},documentMode:n}=t;this.documentMode=n;babelHelpers.classPrivateFieldLooseBase(this,p)[p]=o;const{languages:d}=(l=r.documentSendConfig)!=null?l:{};const _=s.Reflection.getClass("top.BX.Sign.V2.Editor");this.editor=new _(o,{languages:d})}isTemplateMode(){return this.documentMode===n.template}onComplete(e=true){BX.SidePanel.Instance.close();if(e){babelHelpers.classPrivateFieldLooseBase(this,B)[B]()}const s=window.location.search;const t=new URLSearchParams(s);if(!t.has("noRedirect")){const{entityTypeId:e,entityId:s}=this.documentSetup.setupData;const t=`/crm/type/${e}/details/${s}/`;BX.SidePanel.Instance.open(t)}}subscribeOnEvents(){const e=[{type:"toggleActivity",stage:"setup",method:({data:e})=>{const{selected:s}=e;this.wizard.toggleBtnActiveState("next",!s)}},{type:"addFile",stage:"setup",method:({data:e})=>{this.wizard.toggleBtnActiveState("next",!e.ready)}},{type:"removeFile",stage:"setup",method:({data:e})=>{this.wizard.toggleBtnActiveState("next",!e.ready)}},{type:"clearFiles",stage:"setup",method:()=>this.wizard.toggleBtnActiveState("next",true)},{type:"showEditor",stage:"send",method:()=>this.editor.show()},{type:"changeTitle",stage:"send",method:({data:e})=>{this.documentSetup.setupData={...this.documentSetup.setupData,title:e.title};const{blankTitle:s}=e;if(s){const{blankSelector:e,setupData:t}=this.documentSetup;e.modifyBlankTitle(t.blankId,s)}}},{type:"close",stage:"send",method:()=>this.onComplete(false)},{type:"hidePreview",stage:"send",method:()=>s.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,h)[h],"display","none")},{type:"showPreview",stage:"send",method:()=>s.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,h)[h],"display","flex")},{type:"appendOverlay",stage:"send",method:e=>{var s;return babelHelpers.classPrivateFieldLooseBase(this,H)[H](e==null?void 0:(s=e.data)==null?void 0:s.overlay)}},{type:"showOverlay",stage:"send",method:()=>babelHelpers.classPrivateFieldLooseBase(this,T)[T]()},{type:"hideOverlay",stage:"send",method:()=>babelHelpers.classPrivateFieldLooseBase(this,w)[w]()}];e.forEach((({type:e,method:s,stage:t})=>{const a=t==="setup"?this.documentSetup:this.documentSend;a.subscribe(e,s)}));babelHelpers.classPrivateFieldLooseBase(this,S)[S]()}async setupDocument(e,s=false){if(this.documentSetup.isSameBlankSelected()){void await this.documentSetup.setup(e);return this.documentSetup.setupData}babelHelpers.classPrivateFieldLooseBase(this,b)[b].urls=[];this.editor.setUrls([],0);babelHelpers.classPrivateFieldLooseBase(this,b)[b].setBlocks();await this.documentSetup.setup(e);const{setupData:t}=this.documentSetup;if(!t){return null}const{blocks:a}=t;babelHelpers.classPrivateFieldLooseBase(this,F)[F](a,s);return t}async init(e){const a=this.getStepsMetadata(this);const{complete:i,...l}=babelHelpers.classPrivateFieldLooseBase(this,v)[v];const o=this.isTemplateMode()?s.Loc.getMessage("SIGN_SETTINGS_CREATE_TEMPLATE"):s.Loc.getMessage("SIGN_SETTINGS_SEND_FOR_SIGN");this.wizard=new t.Wizard(a,{back:{className:"ui-btn-light-border"},next:{className:"ui-btn-primary"},complete:{className:"ui-btn-primary",title:o,onComplete:()=>this.onComplete(),...i},...l});if(e){await this.applyDocumentData(e)}babelHelpers.classPrivateFieldLooseBase(this,f)[f]()}getStepsMetadata(){return{}}}function O(){const e=this.isTemplateMode()?s.Loc.getMessage("SIGN_SETTINGS_TITLE_TEMPLATE"):s.Loc.getMessage("SIGN_SETTINGS_TITLE");const t=babelHelpers.classPrivateFieldLooseBase(this,p)[p]==="b2b"?s.Loc.getMessage("SIGN_SETTINGS_B2B_TITLE_SUB"):s.Loc.getMessage("SIGN_SETTINGS_B2E_TITLE_SUB");return s.Tag.render(l||(l=i`
			<div class="sign-settings__head">
				<div>
					<p class="sign-settings__head_title">${0}</p>
					<p class="sign-settings__head_title --sub">
						${0}
					</p>
				</div>
			</div>
		`),e,t)}function I(){const e=babelHelpers.classPrivateFieldLooseBase(this,p)[p]==="b2e"?"sign-settings --b2e":"sign-settings";babelHelpers.classPrivateFieldLooseBase(this,h)[h]=babelHelpers.classPrivateFieldLooseBase(this,b)[b].getLayout();babelHelpers.classPrivateFieldLooseBase(this,u)[u]=s.Tag.render(o||(o=i`
			<div class="sign-settings__scope ${0}">
				<div class="sign-settings__sidebar">
					${0}
					${0}
				</div>
				${0}
			</div>
		`),e,babelHelpers.classPrivateFieldLooseBase(this,g)[g](),this.wizard.getLayout(),babelHelpers.classPrivateFieldLooseBase(this,h)[h]);return babelHelpers.classPrivateFieldLooseBase(this,u)[u]}function E(){if(!babelHelpers.classPrivateFieldLooseBase(this,y)[y]){babelHelpers.classPrivateFieldLooseBase(this,y)[y]=s.Tag.render(r||(r=i`<div class="sign-settings__overlay"></div>`))}s.Dom.hide(babelHelpers.classPrivateFieldLooseBase(this,y)[y]);return babelHelpers.classPrivateFieldLooseBase(this,y)[y]}function D(){const e=s.Reflection.getClass("top.BX.UI.Notification");e.Center.notify({content:s.Text.encode(s.Loc.getMessage("SIGN_SETTINGS_COMPLETE_NOTIFICATION_TEXT")),autoHideDelay:4e3})}function N(e,s=false){babelHelpers.classPrivateFieldLooseBase(this,b)[b].ready=false;babelHelpers.classPrivateFieldLooseBase(this,b)[b].setBlocks(e);this.wizard.toggleBtnActiveState("back",true);const t=(e,s)=>{babelHelpers.classPrivateFieldLooseBase(this,b)[b].ready=true;babelHelpers.classPrivateFieldLooseBase(this,b)[b].urls=e;this.editor.setUrls(e,s);this.wizard.toggleBtnActiveState("back",false)};this.documentSetup.waitForPagesList(t,s)}function M(){this.editor.subscribe("save",(({data:e})=>{const s=e.blocks;babelHelpers.classPrivateFieldLooseBase(this,b)[b].setBlocks(s);this.documentSetup.setupData={...this.documentSetup.setupData,blocks:s};this.documentSend.documentData={...this.documentSend.documentData}}))}function j(e){if(!e){return}if(babelHelpers.classPrivateFieldLooseBase(this,P)[P]){s.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,P)[P])}babelHelpers.classPrivateFieldLooseBase(this,P)[P]=e;s.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,P)[P],babelHelpers.classPrivateFieldLooseBase(this,y)[y])}function K(){const e=document.getElementById(babelHelpers.classPrivateFieldLooseBase(this,c)[c]);s.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,m)[m](),e);s.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,L)[L](),e);const t=this.documentSetup.setupData?1:0;this.wizard.toggleBtnActiveState("next",true);this.wizard.moveOnStep(t)}function G(){s.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,u)[u],"display","none");s.Dom.show(babelHelpers.classPrivateFieldLooseBase(this,y)[y])}function k(){s.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,u)[u],"display","flex");s.Dom.hide(babelHelpers.classPrivateFieldLooseBase(this,y)[y])}e.DocumentMode=n;e.isTemplateMode=d;e.SignSettings=_})(this.BX.Sign.V2=this.BX.Sign.V2||{},BX,BX.Ui,BX.Sign.V2);
//# sourceMappingURL=sign-settings.bundle.map.js