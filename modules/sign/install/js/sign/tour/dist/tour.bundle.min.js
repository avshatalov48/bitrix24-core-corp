this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};(function(e,s,t,i){"use strict";class a{saveVisit(e){return t.ajax.runAction("sign.api.tour.saveVisit",{data:{tourId:e}}).then((({data:e})=>e))}getLastVisitDate(e){return t.ajax.runAction("sign.api.tour.getLastVisitDate",{data:{tourId:e}}).then((({data:e})=>{if(!t.Type.isNil(e==null?void 0:e.lastVisitDate)){e.lastVisitDate=new Date(e.lastVisitDate)}return e}))}isAllToursDisabled(){return t.ajax.runAction("sign.api.tour.isAllToursDisabled",{}).then((({data:e})=>e))}}var l=babelHelpers.classPrivateFieldLooseKey("isAllTourDisabled");var o=babelHelpers.classPrivateFieldLooseKey("isIdAutoGenerated");var r=babelHelpers.classPrivateFieldLooseKey("autogeneratedIdPrefix");var n=babelHelpers.classPrivateFieldLooseKey("backend");var d=babelHelpers.classPrivateFieldLooseKey("popupOptions");var u=babelHelpers.classPrivateFieldLooseKey("adjustPopupPosition");var p=babelHelpers.classPrivateFieldLooseKey("adjustPopupWithCenterAngle");class b extends s.Guide{constructor(e){const{popupOptions:s,...i}=e;super(i);Object.defineProperty(this,p,{value:c});Object.defineProperty(this,o,{writable:true,value:void 0});Object.defineProperty(this,r,{writable:true,value:"sign-tour-guide-"});Object.defineProperty(this,n,{writable:true,value:new a});Object.defineProperty(this,d,{writable:true,value:void 0});Object.defineProperty(this,u,{writable:true,value:void 0});if(t.Type.isStringFilled(e.id)){this.setId(e.id);babelHelpers.classPrivateFieldLooseBase(this,o)[o]=false}else{this.setId(babelHelpers.classPrivateFieldLooseBase(this,r)[r]+t.Text.getRandom(14));babelHelpers.classPrivateFieldLooseBase(this,o)[o]=true}if(t.Type.isFunction(e.adjustPopupPosition)){babelHelpers.classPrivateFieldLooseBase(this,u)[u]=e.adjustPopupPosition}if(t.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(b,l)[l])){babelHelpers.classPrivateFieldLooseBase(b,l)[l]=babelHelpers.classPrivateFieldLooseBase(this,n)[n].isAllToursDisabled()}if(s){this.setPopupOptions(s)}}setPopupOptions(e){const{autoHide:s,width:i,className:a}=e;const l=this.getPopup();if(i){l.setWidth(i)}if(s){l.setAutoHide(s)}if(a){t.Dom.addClass(l.getPopupContainer(),a)}babelHelpers.classPrivateFieldLooseBase(this,d)[d]=e}save(){babelHelpers.classPrivateFieldLooseBase(this,n)[n].saveVisit(this.getId())}async start(){var e;const s=await babelHelpers.classPrivateFieldLooseBase(b,l)[l];if(s){return}super.start();if(babelHelpers.classPrivateFieldLooseBase(this,u)[u]){babelHelpers.classPrivateFieldLooseBase(this,u)[u](this.getPopup())}else if((e=babelHelpers.classPrivateFieldLooseBase(this,d)[d])!=null&&e.centerAngle){babelHelpers.classPrivateFieldLooseBase(this,p)[p]()}}async startOnce(){if(babelHelpers.classPrivateFieldLooseBase(this,o)[o]){throw new Error("Cant start guide once if id autogenerated. Set id in constructor")}if(!this.getAutoSave()){throw new Error("Cant start guide once if guide is not auto saved")}const[{lastVisitDate:e},s]=await Promise.all([babelHelpers.classPrivateFieldLooseBase(this,n)[n].getLastVisitDate(this.getId()),babelHelpers.classPrivateFieldLooseBase(b,l)[l]]);if(!s&&t.Type.isNull(e)){this.start()}}}function c(){const e=this.getPopup();const{angleArrowElement:s}=e;const{offsetWidth:t}=e.getPopupContainer();const a=t/2-s.offsetWidth/2-s.offsetLeft;const l=i.Popup.getOption("angleLeftOffset")-a;e.setOffset({offsetLeft:l});e.adjustPosition();e.setAngle({offset:a})}Object.defineProperty(b,l,{writable:true,value:void 0});e.Guide=b})(this.BX.Sign.Tour=this.BX.Sign.Tour||{},BX.UI.Tour,BX,BX.Main);
//# sourceMappingURL=tour.bundle.map.js