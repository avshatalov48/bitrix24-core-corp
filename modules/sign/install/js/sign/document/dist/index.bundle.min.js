this.BX=this.BX||{};(function(e,t,a,i,l,s,r,n,o,c,b,d,u,p,v,h,f,g){"use strict";var y;var H=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"data",{});babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"events",{onChange:"onChange",onColorStyleChange:"onColorStyleChange"});a.setEventNamespace("BX.Sign.Blocks.Dummy");a.block=e;return a}babelHelpers.createClass(t,[{key:"isSingleton",value:function e(){return false}},{key:"isStyleAllowed",value:function e(){return true}},{key:"setData",value:function e(t){this.data=t?t:{}}},{key:"setText",value:function e(t){this.setData({text:t})}},{key:"getInitDimension",value:function e(){return{width:250,height:28}}},{key:"getData",value:function e(){if(this.data.base64){this.data.base64=null}return this.data}},{key:"getActionButton",value:function e(){return null}},{key:"getBlockCaption",value:function e(){return null}},{key:"getViewContent",value:function e(){return p.Tag.render(y||(y=babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div>\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),p.Text.encode(this.data.text||"").toString().replaceAll("[br]","<br>"))}},{key:"onStartChangePosition",value:function e(){}},{key:"onPlaced",value:function e(){}},{key:"onSave",value:function e(){}},{key:"onRemove",value:function e(){}},{key:"onClickOut",value:function e(){this.block.forceSave()}},{key:"onChange",value:function e(){this.emit(this.events.onChange)}},{key:"getStyles",value:function e(){return{}}},{key:"onStyleChange",value:function e(){this.emit(this.events.onColorStyleChange)}},{key:"onStyleRender",value:function e(t){}}]);return t}(h.EventEmitter);babelHelpers.defineProperty(H,"defaultTextBlockPaddingStyles",{padding:"5px 8px"});var P=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"updateColor",value:function e(t){}}]);return t}(H);var m;function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t){F(e,t);t.add(e)}function T(e,t,a){F(e,t);t.set(e,a)}function F(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function C(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var G=new WeakMap;var _=new WeakMap;var O=new WeakMap;var D=new WeakSet;var I=function(e){babelHelpers.inherits(t,e);function t(){var e;var a;babelHelpers.classCallCheck(this,t);for(var i=arguments.length,l=new Array(i),s=0;s<i;s++){l[s]=arguments[s]}a=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(l)));S(babelHelpers.assertThisInitialized(a),D);T(babelHelpers.assertThisInitialized(a),G,{writable:true,value:void 0});T(babelHelpers.assertThisInitialized(a),_,{writable:true,value:false});T(babelHelpers.assertThisInitialized(a),O,{writable:true,value:void 0});return a}babelHelpers.createClass(t,[{key:"getInitDimension",value:function e(){return{width:105,height:28}}},{key:"setData",value:function e(t){this.data=t?t:{};babelHelpers.classPrivateFieldSet(this,O,this.data.text)}},{key:"onActionClick",value:function e(){var t=this;babelHelpers.classPrivateFieldSet(this,G,BX.calendar({node:this.block.getLayout(),field:this.getViewContent(),value:babelHelpers.classPrivateFieldGet(this,O),bTime:false,callback_after:function e(a){t.setText(BX.date.format(BX.date.convertBitrixFormat(BX.message("FORMAT_DATE")),a,null));t.block.renderView()}}));babelHelpers.classPrivateFieldSet(this,_,true)}},{key:"getActionButton",value:function e(){return p.Tag.render(m||(m=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__block-style-btn --funnel">\n\t\t\t\t<button onclick="','" data-role="action">\n\t\t\t\t\t',"\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t"])),this.onActionClick.bind(this),p.Loc.getMessage("SIGN_JS_DOCUMENT_DATE_ACTION_BUTTON"))}},{key:"onStartChangePosition",value:function e(){C(this,D,E).call(this)}},{key:"onSave",value:function e(){C(this,D,E).call(this)}},{key:"onRemove",value:function e(){C(this,D,E).call(this)}},{key:"onClickOut",value:function e(){if(!babelHelpers.classPrivateFieldGet(this,_)){this.block.forceSave()}babelHelpers.classPrivateFieldSet(this,_,false)}},{key:"getStyles",value:function e(){return k(k({},babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getStyles",this).call(this)),t.defaultTextBlockPaddingStyles)}}]);return t}(H);function E(){if(babelHelpers.classPrivateFieldGet(this,G)){babelHelpers.classPrivateFieldGet(this,G).Close();babelHelpers.classPrivateFieldSet(this,_,false)}}var M;function z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):z(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function B(e,t){N(e,t);t.add(e)}function N(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function A(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var R=new WeakSet;var x=function(e){babelHelpers.inherits(t,e);function t(){var e;var a;babelHelpers.classCallCheck(this,t);for(var i=arguments.length,l=new Array(i),s=0;s<i;s++){l[s]=arguments[s]}a=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(l)));B(babelHelpers.assertThisInitialized(a),R);return a}babelHelpers.createClass(t,[{key:"isSingleton",value:function e(){return true}},{key:"getData",value:function e(){var t=this.data;if(t.text){t.text=null}return t}},{key:"getInitDimension",value:function e(){return{width:250,height:220}}},{key:"getActionButton",value:function e(){return p.Tag.render(M||(M=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__block-style-btn --funnel">\n\t\t\t\t<button onclick="','" data-role="action" data-id="action-','">\n\t\t\t\t\t',"\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t"])),A(this,R,j).bind(this),this.block.getCode(),p.Loc.getMessage("SIGN_JS_DOCUMENT_REQUISITES_ACTION_BUTTON"))}},{key:"getStyles",value:function e(){return L(L({},babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getStyles",this).call(this)),t.defaultTextBlockPaddingStyles)}}]);return t}(H);function j(e){var t=this;var a=this.block.getDocument();var i=a.getConfig();e.stopPropagation();new d.FieldsetViewer({entityTypeId:i.crmOwnerTypeCompany,entityId:a.getCompanyId(),events:{onClose:function e(){t.block.assign()}},fieldListEditorOptions:{fieldsPanelOptions:{filter:{"+categories":["COMPANY"],"+fields":["list","string","date","typed_string","text","datetime","enumeration","address","url","money","boolean","double"]},presetId:i.crmRequisiteCompanyPresetId,controllerOptions:{hideVirtual:1,hideRequisites:0,hideSmartDocument:1}}}}).show()}var W,U,X,V,q,J,Y,Q,Z;function K(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?K(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ee=p.Reflection.getClass("BX.ColorPicker");var te=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"setRect",value:function e(t,a){Object.keys(a).map((function(e){a[e]=parseInt(a[e])+"px"}));p.Dom.style(t,a)}},{key:"getBlockLayout",value:function e(t){return p.Tag.render(W||(W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__block-wrapper">\n\t\t\t\t<div class="sign-document__block-panel--wrapper" data-role="sign-block__actions">\n\t\t\t\t</div>\n\t\t\t\t<div class="sign-document__block-content">\n\t\t\t\t</div>\n\t\t\t\t<div class="sign-document__block-actions">\n\t\t\t\t\t<div class="sign-document__block-actions--wrapper">\n\t\t\t\t\t\t<button class="sign-document__block-actions-btn --remove sign-block-action-remove" data-role="removeAction" onclick="','"></button>\n\t\t\t\t\t\t<button class="sign-document__block-actions-btn --save sign-block-action-save" data-role="saveAction" onclick="','"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'])),t.onRemove,t.onSave)}},{key:"getMemberSelector",value:function e(t,a,i){var l={};var s=p.Loc.getMessage("SIGN_JS_DOCUMENT_MEMBER_NAME_NOT_SET");t.map((function(e){e.name=e.name||p.Loc.getMessage("SIGN_JS_DOCUMENT_MEMBER_NAME_NOT_SET");l[e.part]=e.name;if(e.part===a){s=e.name}}));var n=t.length>1?p.Tag.render(U||(U=babelHelpers.taggedTemplateLiteral(["<span>","</span>"])),p.Text.encode(s)):p.Tag.render(X||(X=babelHelpers.taggedTemplateLiteral(["<i>","</i>"])),p.Text.encode(s));if(t.length>1){r.UI.bindSimpleMenu({bindElement:n,items:l,actionHandler:function e(t){n.innerHTML=l[t];i(parseInt(t))}})}return p.Tag.render(V||(V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document-block-member-wrapper">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),n)}},{key:"getResizeArea",value:function e(){return p.Tag.render(q||(q=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__resize-area">\n\t\t\t\t<div class="sign-area-resizable-controls">\n\t\t\t\t\t<span class="sign-document__move-control"></span>\n\t\t\t\t\t<div class="sign-document__resize-control --middle-top"></div>\n\t\t\t\t\t<div class="sign-document__resize-control --right-top"></div>\n\t\t\t\t\t<div class="sign-document__resize-control --middle-right"></div>\n\t\t\t\t\t<div class="sign-document__resize-control --right-bottom"></div>\n\t\t\t\t\t<div class="sign-document__resize-control --middle-bottom"></div>\n\t\t\t\t\t<div class="sign-document__resize-control --left-bottom"></div>\n\t\t\t\t\t<div class="sign-document__resize-control --middle-left"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'])))}},{key:"getStylePanel",value:function t(a,i){var l;var s={'"Times New Roman", Times':"<span style=\"font-family: 'Times New Roman', Times\">Times New Roman</span>",'"Courier New"':"<span style=\"font-family: 'Courier New'\">Courier New</span>","Arial, Helvetica":'<span style="font-family: Arial, Helvetica">Arial / Helvetica</span>','"Arial Black", Gadget':"<span style=\"font-family: 'Arial Black', Gadget\">Arial Black</span>","Tahoma, Geneva":'<span style="font-family: Tahoma, Geneva">Tahoma / Geneva</span>',Verdana:'<span style="font-family: Verdana">Verdana</span>',"Georgia, serif":'<span style="font-family: Georgia, serif">Georgia</span>',monospace:'<span style="font-family: monospace">monospace</span>'};var n=p.Tag.render(J||(J=babelHelpers.taggedTemplateLiteral(['<div class="sign-document__block-style-btn --btn-font-family">',"</div>"])),s[i["font-family"]]||"Font");r.UI.bindSimpleMenu({bindElement:n,items:s,actionHandler:function e(t){n.innerHTML=s[t];a("family",t)}});var o=parseInt(i["font-size"]);var c=14;if(o){c=o}var b=p.Tag.render(Y||(Y=babelHelpers.taggedTemplateLiteral(['<div class="sign-document__block-style-btn --btn-fontsize">',"</div>"])),c+"px"||"<i></i>");r.UI.bindSimpleMenu({bindElement:b,items:["6px","7px","8px","9px","10px","11px","12px","13px","14px","15px","16px","18px","20px","22px","24px","26px","28px","36px","48px","72px"],actionHandler:function e(t){b.innerHTML=parseInt(t)+"px";a("size",t)},currentValue:c});var d=e.getColorSelectorBtn((l=i.color)!==null&&l!==void 0?l:"#000",(function(e){return a("color",e)})),u=d.layout;return p.Tag.render(Q||(Q=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__block-style--panel">\n\x3c!--\t\t\t\t<div class="sign-document__block-style&#45;&#45;move-control"></div>--\x3e\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t\t",'\n\t\t\t\t<div class="sign-document__block-style--separator"></div>\n\t\t\t\t<div class="sign-document__block-style-btn --btn-bold" data-action="bold"><i></i></div>\n\t\t\t\t<div class="sign-document__block-style-btn --btn-italic" data-action="italic"><i></i></div>\n\t\t\t\t<div class="sign-document__block-style-btn --btn-underline" data-action="underline"><i></i></div>\n\t\t\t\t<div class="sign-document__block-style-btn --btn-strike" data-action="through"><i></i></div>\n\t\t\t\t<div class="sign-document__block-style-btn --btn-align-left" data-action="left"><i></i></div>\n\t\t\t\t<div class="sign-document__block-style-btn --btn-align-center" data-action="center"><i></i></div>\n\t\t\t\t<div class="sign-document__block-style-btn --btn-align-right" data-action="right"><i></i></div>\n\t\t\t\t<div class="sign-document__block-style-btn --btn-align-justify" data-action="justify"><i></i></div>\n\t\t\t</div>\n\t\t'])),n,b,u)}},{key:"getColorSelectorBtn",value:function t(a,i){var l=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var s=p.Tag.render(Z||(Z=babelHelpers.taggedTemplateLiteral(['<div class="sign-document__block-style-btn --btn-color">\n\t\t\t\t<span class="sign-document__block-style-btn--color-block"></span> \n\t\t\t\t<span>',"</span>\n\t\t\t</div>"])),p.Loc.getMessage("SIGN_JS_DOCUMENT_STYLE_COLOR"));e.updateColorSelectorBtnColor(s,a);var r=$($({},l),{},{bindElement:s,onColorSelected:function t(a){i(a);e.updateColorSelectorBtnColor(s,a)}});var n=new ee(r);p.Event.bind(s,"click",(function(){n.open()}));return{layout:s,colorPicker:n}}},{key:"updateColorSelectorBtnColor",value:function e(t,a){var i=t.querySelector(".sign-document__block-style-btn--color-block");if(p.Type.isNil(i)){return}p.Dom.style(i,"background-color",a)}}]);return e}();var ae,ie,le;function se(e,t){ne(e,t);t.add(e)}function re(e,t,a){ne(e,t);t.set(e,a)}function ne(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function oe(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var ce=new WeakMap;var be=new WeakMap;var de=new WeakMap;var ue=new WeakMap;var pe=new WeakSet;var ve=new WeakSet;var he=new WeakSet;var fe=function(e){babelHelpers.inherits(t,e);function t(){var e;var a;babelHelpers.classCallCheck(this,t);for(var i=arguments.length,l=new Array(i),s=0;s<i;s++){l[s]=arguments[s]}a=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(l)));se(babelHelpers.assertThisInitialized(a),he);se(babelHelpers.assertThisInitialized(a),ve);se(babelHelpers.assertThisInitialized(a),pe);re(babelHelpers.assertThisInitialized(a),ce,{writable:true,value:new p.Cache.MemoryCache});re(babelHelpers.assertThisInitialized(a),be,{writable:true,value:"#0047ab"});re(babelHelpers.assertThisInitialized(a),de,{writable:true,value:["#000",babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),be),"#8b00ff"]});re(babelHelpers.assertThisInitialized(a),ue,{writable:true,value:null});return a}babelHelpers.createClass(t,[{key:"isSingleton",value:function e(){return true}},{key:"isStyleAllowed",value:function e(){return false}},{key:"getInitDimension",value:function e(){return{width:200,height:70}}},{key:"updateColor",value:function e(a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"updateColor",this).call(this,a);var i=oe(this,pe,ge).call(this),l=i.layout,s=i.colorPicker;babelHelpers.classPrivateFieldSet(this,ue,a);te.updateColorSelectorBtnColor(l,a);s.setSelectedColor(a)}},{key:"getBlockCaption",value:function e(){var t=oe(this,pe,ge).call(this),a=t.layout;return p.Tag.render(ae||(ae=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div style="display: flex; flex-direction: row;">\n\t\t\t','\n\t\t\t<div class="sign-document__block-style--separator"></div>\n\t\t\t<div class="sign-document-block-member-wrapper">\n\t\t\t\t<i>',"</i>\n\t\t\t</div>\n\t\t\t</div>\n\t\t"])),a,p.Loc.getMessage("SIGN_JS_DOCUMENT_SIGN_ACTION_BUTTON"))}},{key:"getViewContent",value:function e(){var t=this.block.getPosition(),a=t.width,i=t.height;var l=null;if(this.dataSrc){l=this.dataSrc}else if(this.data.base64){l="data:image;base64,"+this.data.base64}if(l){return p.Tag.render(ie||(ie=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<img src="','" alt="">\n\t\t\t'])),l)}else{return p.Tag.render(le||(le=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="sign-document__block-content_member-nodata">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),p.Text.encode(this.data.text||this.getPlaceholderLabel()))}}},{key:"getPlaceholderLabel",value:function e(){return p.Loc.getMessage("SIGN_JS_DOCUMENT_MEMBER_NO_DATA_MY_SIGN")}},{key:"getStyles",value:function e(){return{"background-position":"center !important",color:oe(this,ve,ye).call(this)}}},{key:"onSave",value:function e(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onSave",this).call(this);oe(this,he,He).call(this)}},{key:"onClickOut",value:function e(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onClickOut",this).call(this);oe(this,he,He).call(this)}},{key:"onStyleRender",value:function e(a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onStyleRender",this).call(this,a);if(!p.Type.isNil(a.color)){this.updateColor(a.color)}}}]);return t}(P);function ge(){var e=this;return babelHelpers.classPrivateFieldGet(this,ce).remember("colorSelectorBtn",(function(){var t,a;return te.getColorSelectorBtn((t=babelHelpers.classPrivateFieldGet(e,ue))!==null&&t!==void 0?t:babelHelpers.classPrivateFieldGet(e,be),(function(t){babelHelpers.classPrivateFieldSet(e,ue,t);e.onStyleChange()}),{colors:[babelHelpers.classPrivateFieldGet(e,de)],allowCustomColor:false,selectedColor:(a=babelHelpers.classPrivateFieldGet(e,ue))!==null&&a!==void 0?a:babelHelpers.classPrivateFieldGet(e,be),colorPreview:false})}))}function ye(){var e;return(e=babelHelpers.classPrivateFieldGet(this,ue))!==null&&e!==void 0?e:babelHelpers.classPrivateFieldGet(this,be)}function He(){var e=oe(this,pe,ge).call(this),t=e.colorPicker;t.close()}var Pe,me,we;function ke(e,t){Te(e,t);t.add(e)}function Se(e,t,a){Te(e,t);t.set(e,a)}function Te(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Fe(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var Ce=new WeakMap;var Ge=new WeakSet;var _e=new WeakSet;var Oe=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));ke(babelHelpers.assertThisInitialized(a),_e);ke(babelHelpers.assertThisInitialized(a),Ge);Se(babelHelpers.assertThisInitialized(a),Ce,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),Ce,new o.Uploader({controller:{upload:"sign.upload.stampUploadController"},contact:{id:0,label:p.Text.encode(a.block.getDocument().getInitiatorName())}}));babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),Ce).subscribe("onSaveAsync",(function(e){t.currentBlock["await"](true);return new Promise((function(i,l){var s;var r=e.getData();if(!(r!==null&&r!==void 0&&(s=r.file)!==null&&s!==void 0&&s.serverId)){l();return}a.dataSrc=r.file.serverPreviewUrl;Fe(babelHelpers.assertThisInitialized(a),_e,Ie).call(babelHelpers.assertThisInitialized(a),t.currentBlock,r.file.serverId).then((function(){i()}))["catch"]((function(e){l(e)}))}))}));return a}babelHelpers.createClass(t,[{key:"isSingleton",value:function e(){return true}},{key:"isStyleAllowed",value:function e(){return false}},{key:"getInitDimension",value:function e(){return{width:151,height:151}}},{key:"getActionButton",value:function e(){return p.Tag.render(Pe||(Pe=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__block-style-btn --funnel">\n\t\t\t\t<button onclick="','" data-role="action">\n\t\t\t\t\t',"\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t"])),Fe(this,Ge,De).bind(this),p.Loc.getMessage("SIGN_JS_DOCUMENT_STAMP_ACTION_BUTTON"))}},{key:"getViewContent",value:function e(){var t=null;if(this.dataSrc){t=this.dataSrc}else if(this.data.base64){t="data:image;base64,"+this.data.base64}if(t){return p.Tag.render(me||(me=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="sign-document__block-content_stamp" style="background-image: url(',')"></div>\n\t\t\t'])),t)}else{return p.Tag.render(we||(we=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="sign-document__block-content_member-nodata --stamp"></div>\n\t\t\t'])))}}}]);return t}(H);function De(e){Oe.currentBlock=this.block;babelHelpers.classPrivateFieldGet(this,Ce).show()}function Ie(e,t){return c.Backend.controller({command:"integration.crm.saveCompanyStamp",postData:{documentId:e.getDocument().getId(),companyId:e.getDocument().getCompanyId(),fileId:t}}).then((function(t){e.assign()}))["catch"]((function(){}))}var Ee,Me;function ze(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function Le(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ze(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Be(e,t){Ne(e,t);t.add(e)}function Ne(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Ae(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var Re=new WeakSet;var xe=function(e){babelHelpers.inherits(t,e);function t(){var e;var a;babelHelpers.classCallCheck(this,t);for(var i=arguments.length,l=new Array(i),s=0;s<i;s++){l[s]=arguments[s]}a=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(l)));Be(babelHelpers.assertThisInitialized(a),Re);return a}babelHelpers.createClass(t,[{key:"isSingleton",value:function e(){return true}},{key:"getInitDimension",value:function e(){return{width:100,height:28}}},{key:"getActionButton",value:function e(){return p.Tag.render(Ee||(Ee=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__block-style-btn --funnel">\n\t\t\t\t<button onclick="','" data-role="action">\n\t\t\t\t\t',"\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t"])),Ae(this,Re,je).bind(this),p.Loc.getMessage("SIGN_JS_DOCUMENT_NUMBER_ACTION_EDIT"))}},{key:"getViewContent",value:function e(){return p.Tag.render(Me||(Me=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__block-number">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),p.Text.encode(this.data.text||"").toString())}},{key:"getStyles",value:function e(){return Le(Le({},babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getStyles",this).call(this)),t.defaultTextBlockPaddingStyles)}}]);return t}(H);function je(e){var t=this;e.stopPropagation();var a=this.block.getDocument().getConfig()["crmNumeratorUrl"];if(!xe.sliderOnMessageBind){xe.sliderOnMessageBind=true;BX.addCustomEvent("SidePanel.Slider:onMessage",(function(e){if(e.getEventId()==="numerator-saved-event"){var a,i,l,s;var r=e.getData();var n=(a=e===null||e===void 0?void 0:(i=e.sender)===null||i===void 0?void 0:(l=i.options)===null||l===void 0?void 0:(s=l.data)===null||s===void 0?void 0:s.block)!==null&&a!==void 0?a:t.block;if(r.type==="CRM_SMART_DOCUMENT"){n["await"](true);c.Backend.controller({command:"integration.crm.refreshNumberInDocument",postData:{documentId:n.getDocument().getId()}}).then((function(e){n.assign()}))["catch"]((function(){}))}}}))}BX.SidePanel.Instance.open(a,{width:480,cacheable:false,data:{block:this.block}})}babelHelpers.defineProperty(xe,"sliderOnMessageBind",false);var We,Ue,Xe;function Ve(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function qe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ve(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Je(e,t){Qe(e,t);t.add(e)}function Ye(e,t,a){Qe(e,t);t.set(e,a)}function Qe(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Ze(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var Ke=new WeakMap;var $e=new WeakMap;var et=new WeakMap;var tt=new WeakSet;var at=new WeakSet;var it=new WeakSet;var lt=function(e){babelHelpers.inherits(t,e);function t(){var e;var a;babelHelpers.classCallCheck(this,t);for(var i=arguments.length,l=new Array(i),s=0;s<i;s++){l[s]=arguments[s]}a=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(l)));Je(babelHelpers.assertThisInitialized(a),it);Je(babelHelpers.assertThisInitialized(a),at);Je(babelHelpers.assertThisInitialized(a),tt);Ye(babelHelpers.assertThisInitialized(a),Ke,{writable:true,value:new p.Cache.MemoryCache});Ye(babelHelpers.assertThisInitialized(a),$e,{writable:true,value:void 0});Ye(babelHelpers.assertThisInitialized(a),et,{writable:true,value:void 0});return a}babelHelpers.createClass(t,[{key:"setData",value:function e(t){this.data=t?t:{};babelHelpers.classPrivateFieldSet(this,$e,this.data.field)}},{key:"getData",value:function e(){var t=this.data;if(t.text&&t.field){delete t.text}return t}},{key:"onPlaced",value:function e(){Ze(this,tt,st).call(this)}},{key:"getActionButton",value:function e(){if(p.Type.isUndefined(b.Selector)){return null}babelHelpers.classPrivateFieldSet(this,et,p.Tag.render(We||(We=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__block-style-btn --funnel">\n\t\t\t\t<button onclick="','" data-role="action">\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t'])),Ze(this,tt,st).bind(this)));Ze(this,at,rt).call(this);return babelHelpers.classPrivateFieldGet(this,et)}},{key:"getViewContent",value:function e(){Ze(this,at,rt).call(this);var t=this.block.getPosition(),a=t.width,i=t.height;if(this.data.src){return p.Tag.render(Ue||(Ue=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div style="width: ',"px; height: ","px; background: url(",') no-repeat top; background-size: cover;">\n\t\t\t\t</div>\n\t\t\t'])),a-14,i-14,this.data.src)}else{var l=!this.data.text?"sign-document__block-content_member-nodata":"";return p.Tag.render(Xe||(Xe=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="','">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),l,p.Text.encode(this.data.text||p.Loc.getMessage("SIGN_JS_DOCUMENT_MEMBER_NO_DATA")))}}},{key:"getStyles",value:function e(){return qe(qe({},babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getStyles",this).call(this)),t.defaultTextBlockPaddingStyles)}}]);return t}(H);function st(){var e=this;Ze(this,it,nt).call(this).show().then((function(t){if(t.length===0){return}babelHelpers.classPrivateFieldSet(e,$e,t[0]);e.setData({field:babelHelpers.classPrivateFieldGet(e,$e)});setTimeout((function(){e.block.assign()}),0)}))}function rt(){if(!babelHelpers.classPrivateFieldGet(this,et)){return}var e=this.block.getDocument().getConfig();var t=e.crmEntityFields[babelHelpers.classPrivateFieldGet(this,$e)]||null;if(!t){t=p.Loc.getMessage("SIGN_JS_DOCUMENT_REFERENCE_ACTION_BUTTON")}babelHelpers.classPrivateFieldGet(this,et).querySelector("button").innerText=t}function nt(){return babelHelpers.classPrivateFieldGet(this,Ke).remember("getFieldSelector",(function(){return new b.Selector({multiple:false,controllerOptions:{hideVirtual:1,hideRequisites:1,hideSmartDocument:1},filter:{"+categories":["CONTACT","SMART_DOCUMENT"],"+fields":["list","string","date","typed_string","text","datetime","enumeration","address","url","money","boolean","double"]}})}))}var ot,ct,bt;function dt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function ut(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):dt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function pt(e,t){ht(e,t);t.add(e)}function vt(e,t,a){ht(e,t);t.set(e,a)}function ht(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function ft(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var gt=new WeakMap;var yt=new WeakMap;var Ht=new WeakMap;var Pt=new WeakSet;var mt=new WeakSet;var wt=new WeakSet;var kt=new WeakSet;var St=new WeakSet;var Tt=function(e){babelHelpers.inherits(t,e);function t(){var e;var a;babelHelpers.classCallCheck(this,t);for(var i=arguments.length,l=new Array(i),s=0;s<i;s++){l[s]=arguments[s]}a=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(l)));pt(babelHelpers.assertThisInitialized(a),St);pt(babelHelpers.assertThisInitialized(a),kt);pt(babelHelpers.assertThisInitialized(a),wt);pt(babelHelpers.assertThisInitialized(a),mt);pt(babelHelpers.assertThisInitialized(a),Pt);vt(babelHelpers.assertThisInitialized(a),gt,{writable:true,value:void 0});vt(babelHelpers.assertThisInitialized(a),yt,{writable:true,value:void 0});vt(babelHelpers.assertThisInitialized(a),Ht,{writable:true,value:new p.Cache.MemoryCache});return a}babelHelpers.createClass(t,[{key:"setData",value:function e(t){this.data=t?t:{};babelHelpers.classPrivateFieldSet(this,gt,this.data.field)}},{key:"getData",value:function e(){var t=this.data;if(t.text&&t.field){delete t.text}return t}},{key:"onPlaced",value:function e(){ft(this,Pt,Ft).call(this)}},{key:"getActionButton",value:function e(){if(p.Type.isUndefined(b.Selector)){return null}babelHelpers.classPrivateFieldSet(this,yt,p.Tag.render(ot||(ot=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__block-style-btn --funnel">\n\t\t\t\t<button onclick="','" data-role="action">\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t'])),ft(this,Pt,Ft).bind(this)));ft(this,mt,Ct).call(this);return babelHelpers.classPrivateFieldGet(this,yt)}},{key:"getViewContent",value:function e(){ft(this,mt,Ct).call(this);var t=this.block.getPosition(),a=t.width,i=t.height;if(this.data.src){return p.Tag.render(ct||(ct=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div style="width: ',"px; height: ","px; background: url(",') no-repeat top; background-size: cover;">\n\t\t\t\t</div>\n\t\t\t'])),a-14,i-14,this.data.src)}else{var l=!this.data.text?"sign-document__block-content_member-nodata":"";return p.Tag.render(bt||(bt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="','">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),l,p.Text.encode(this.data.text||p.Loc.getMessage("SIGN_JS_DOCUMENT_MEMBER_NO_DATA_MY_BLOCKS")))}}},{key:"getStyles",value:function e(){return ut(ut({},babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getStyles",this).call(this)),t.defaultTextBlockPaddingStyles)}}]);return t}(H);function Ft(){var e=this;ft(this,wt,Gt).call(this).show().then((function(t){if(t.length===0){return}babelHelpers.classPrivateFieldSet(e,gt,t[0]);e.setData({field:babelHelpers.classPrivateFieldGet(e,gt)});setTimeout((function(){e.block.assign()}),0)}))}function Ct(){if(!babelHelpers.classPrivateFieldGet(this,yt)){return}var e=this.block.getDocument().getConfig();var t=e.crmEntityFields[babelHelpers.classPrivateFieldGet(this,gt)]||null;if(!t){t=p.Loc.getMessage("SIGN_JS_DOCUMENT_REFERENCE_ACTION_BUTTON")}babelHelpers.classPrivateFieldGet(this,yt).querySelector("button").innerText=t}function Gt(){var e=this;return babelHelpers.classPrivateFieldGet(this,Ht).remember("getFieldSelector",(function(){return new b.Selector({multiple:false,controllerOptions:{hideVirtual:1,hideRequisites:1,hideSmartDocument:1},filter:{"+categories":["COMPANY","SMART_DOCUMENT"],"+fields":["list","string","date","typed_string","text","datetime","enumeration","address","url","money","boolean","double"],"-fields":[ft(e,kt,_t).call(e)]}})}))}function _t(){var e=ft(this,St,Ot).call(this);return function(t){return e.some((function(e){return t.name===e}))}}function Ot(){return["COMPANY_LINK","COMPANY_REG_ADDRESS","COMPANY_ORIGIN_VERSION"]}var Dt,It;function Et(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function Mt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Et(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function zt(e,t){Lt(e,t);t.add(e)}function Lt(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Bt(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var Nt=new WeakSet;var At=function(e){babelHelpers.inherits(t,e);function t(){var e;var a;babelHelpers.classCallCheck(this,t);for(var i=arguments.length,l=new Array(i),s=0;s<i;s++){l[s]=arguments[s]}a=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(l)));zt(babelHelpers.assertThisInitialized(a),Nt);return a}babelHelpers.createClass(t,[{key:"isSingleton",value:function e(){return true}},{key:"getData",value:function e(){var t=this.data;if(t.text){t.text=null}return t}},{key:"getInitDimension",value:function e(){return{width:250,height:220}}},{key:"getActionButton",value:function e(){return p.Tag.render(Dt||(Dt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__block-style-btn --funnel">\n\t\t\t\t<button onclick="','" data-role="action" data-id="action-','">\n\t\t\t\t\t',"\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t"])),Bt(this,Nt,Rt).bind(this),this.block.getCode(),p.Loc.getMessage("SIGN_JS_DOCUMENT_REQUISITES_ACTION_BUTTON"))}},{key:"getViewContent",value:function e(){var t=this.data.text||p.Loc.getMessage("SIGN_JS_DOCUMENT_MEMBER_NO_DATA_REQUISITES");var a=this.data.text?"":' class="sign-document__block-content_member-nodata"';return p.Tag.render(It||(It=babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div",">\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),a,p.Text.encode(t).toString().replaceAll("[br]","<br>"))}},{key:"getStyles",value:function e(){return Mt(Mt({},babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getStyles",this).call(this)),t.defaultTextBlockPaddingStyles)}}]);return t}(H);function Rt(e){var t=this;var a=this.block.getDocument();var i=a.getConfig();var l=a.getMemberByPart(this.block.getMemberPart());e.stopPropagation();if(!l){return}new d.FieldsetViewer({entityTypeId:i.crmOwnerTypeContact,entityId:l.cid,events:{onClose:function e(){t.block.assign()}},fieldListEditorOptions:{fieldsPanelOptions:{filter:{"+categories":["CONTACT"],"+fields":["list","string","date","typed_string","text","datetime","enumeration","address","url","money","boolean","double"]},presetId:i.crmRequisiteContactPresetId,controllerOptions:{hideVirtual:1,hideRequisites:0,hideSmartDocument:1}}}}).show()}var xt,jt;function Wt(e,t){Xt(e,t);t.add(e)}function Ut(e,t,a){Xt(e,t);t.set(e,a)}function Xt(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Vt(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var qt=new WeakMap;var Jt=new WeakMap;var Yt=new WeakMap;var Qt=new WeakMap;var Zt=new WeakSet;var Kt=new WeakSet;var $t=new WeakSet;var ea=function(e){babelHelpers.inherits(t,e);function t(){var e;var a;babelHelpers.classCallCheck(this,t);for(var i=arguments.length,l=new Array(i),s=0;s<i;s++){l[s]=arguments[s]}a=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(l)));Wt(babelHelpers.assertThisInitialized(a),$t);Wt(babelHelpers.assertThisInitialized(a),Kt);Wt(babelHelpers.assertThisInitialized(a),Zt);Ut(babelHelpers.assertThisInitialized(a),qt,{writable:true,value:new p.Cache.MemoryCache});Ut(babelHelpers.assertThisInitialized(a),Jt,{writable:true,value:"#0047ab"});Ut(babelHelpers.assertThisInitialized(a),Yt,{writable:true,value:["#000",babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),Jt),"#8b00ff"]});Ut(babelHelpers.assertThisInitialized(a),Qt,{writable:true,value:null});return a}babelHelpers.createClass(t,[{key:"getPlaceholderLabel",value:function e(){return p.Loc.getMessage("SIGN_JS_DOCUMENT_MEMBER_NO_DATA_SIGN")}},{key:"isStyleAllowed",value:function e(){return false}},{key:"getInitDimension",value:function e(){return{width:200,height:70}}},{key:"getBlockCaption",value:function e(){var t=Vt(this,Zt,ta).call(this),a=t.layout;return p.Tag.render(xt||(xt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div style="display: flex; flex-direction: row;">\n\t\t\t','\n\t\t\t<div class="sign-document__block-style--separator"></div>\n\t\t\t</div>\n\t\t'])),a)}},{key:"getViewContent",value:function e(){return p.Tag.render(jt||(jt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document__block-content_member-nodata">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),p.Text.encode(this.getPlaceholderLabel()))}},{key:"updateColor",value:function e(a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"updateColor",this).call(this,a);var i=Vt(this,Zt,ta).call(this),l=i.layout,s=i.colorPicker;babelHelpers.classPrivateFieldSet(this,Qt,a);te.updateColorSelectorBtnColor(l,a);s.setSelectedColor(a)}},{key:"getStyles",value:function e(){return{"background-position":"center !important",color:Vt(this,Kt,aa).call(this)}}},{key:"onSave",value:function e(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onSave",this).call(this);Vt(this,$t,ia).call(this)}},{key:"onClickOut",value:function e(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onClickOut",this).call(this);Vt(this,$t,ia).call(this)}},{key:"onStyleRender",value:function e(a){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onStyleRender",this).call(this,a);if(!p.Type.isNil(a.color)){this.updateColor(a.color)}}}]);return t}(P);function ta(){var e=this;return babelHelpers.classPrivateFieldGet(this,qt).remember("colorSelectorBtn",(function(){var t,a;return te.getColorSelectorBtn((t=babelHelpers.classPrivateFieldGet(e,Qt))!==null&&t!==void 0?t:babelHelpers.classPrivateFieldGet(e,Jt),(function(t){babelHelpers.classPrivateFieldSet(e,Qt,t);e.onStyleChange()}),{colors:[babelHelpers.classPrivateFieldGet(e,Yt)],allowCustomColor:false,selectedColor:(a=babelHelpers.classPrivateFieldGet(e,Qt))!==null&&a!==void 0?a:babelHelpers.classPrivateFieldGet(e,Jt),colorPreview:false})}))}function aa(){var e;return(e=babelHelpers.classPrivateFieldGet(this,Qt))!==null&&e!==void 0?e:babelHelpers.classPrivateFieldGet(this,Jt)}function ia(){var e=Vt(this,Zt,ta).call(this),t=e.colorPicker;t.close()}var la,sa;var ra=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"isStyleAllowed",value:function e(){return false}},{key:"getInitDimension",value:function e(){return{width:151,height:151}}},{key:"getPlaceholderLabel",value:function e(){return p.Loc.getMessage("SIGN_JS_DOCUMENT_MEMBER_NO_DATA_STAMP")}},{key:"getViewContent",value:function e(){var t=this.block.getPosition(),a=t.width,i=t.height;if(this.data.base64){return p.Tag.render(la||(la=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="sign-document__block-content_stamp" style="background-image: url(',')"></div>\n\t\t\t'])),src)}else{return p.Tag.render(sa||(sa=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="sign-document__block-content_member-nodata">\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t'])))}}}]);return t}(H);var na;function oa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function ca(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oa(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ba(e,t){ua(e,t);t.add(e)}function da(e,t,a){ua(e,t);t.set(e,a)}function ua(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function pa(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var va=new WeakMap;var ha=new WeakSet;var fa=new WeakSet;var ga=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));ba(babelHelpers.assertThisInitialized(a),fa);ba(babelHelpers.assertThisInitialized(a),ha);da(babelHelpers.assertThisInitialized(a),va,{writable:true,value:void 0});a.setEventNamespace("BX.Sign.Blocks.Text");return a}babelHelpers.createClass(t,[{key:"onActionClick",value:function e(){babelHelpers.classPrivateFieldGet(this,va).contentEditable=true;babelHelpers.classPrivateFieldGet(this,va).focus()}},{key:"getText",value:function e(){return this.data.text}},{key:"getContainer",value:function e(){return babelHelpers.classPrivateFieldGet(this,va)}},{key:"getViewContent",value:function e(){var t=this;var a=this.data.text===p.Loc.getMessage("SIGN_JS_DOCUMENT_TEXT_PLACEHOLDER")?"":this.data.text;babelHelpers.classPrivateFieldSet(this,va,p.Tag.render(na||(na=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sign-document-block-text" placeholder="','">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),p.Loc.getMessage("SIGN_JS_DOCUMENT_TEXT_PLACEHOLDER"),p.Text.encode(a).replaceAll("[br]","<br>")));p.Event.bind(babelHelpers.classPrivateFieldGet(this,va),"keyup",pa(this,ha,ya).bind(this));p.Event.bind(babelHelpers.classPrivateFieldGet(this,va),"paste",(function(e){return setTimeout(pa(t,fa,Ha).bind(t,e))}));return babelHelpers.classPrivateFieldGet(this,va)}},{key:"getStyles",value:function e(){return ca(ca({},babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getStyles",this).call(this)),t.defaultTextBlockPaddingStyles)}}]);return t}(H);function ya(e){this.setText(babelHelpers.classPrivateFieldGet(this,va).innerText.replaceAll("\n","[br]"));this.onChange()}function Ha(e){babelHelpers.classPrivateFieldGet(this,va).innerHTML=babelHelpers.classPrivateFieldGet(this,va).innerText.replaceAll("\n","<br>");var t=document.createRange();t.selectNodeContents(babelHelpers.classPrivateFieldGet(this,va));t.collapse(false);var a=document.getSelection();a.removeAllRanges();a.addRange(t);this.setText(babelHelpers.classPrivateFieldGet(this,va).innerHTML.replaceAll("<br>","[br]"));this.onChange()}function Pa(e,t){wa(e,t);t.add(e)}function ma(e,t,a){wa(e,t);t.set(e,a)}function wa(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function ka(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var Sa=new WeakMap;var Ta=new WeakMap;var Fa=new WeakMap;var Ca=new WeakSet;var Ga=new WeakSet;var _a=function(){function e(t){babelHelpers.classCallCheck(this,e);Pa(this,Ga);Pa(this,Ca);ma(this,Sa,{writable:true,value:void 0});ma(this,Ta,{writable:true,value:{family:{property:"font-family",value:null},size:{property:"font-size",value:14},color:{property:"color",value:null},bold:{button:null,property:"font-weight",value:"bold",state:false},italic:{button:null,property:"font-style",value:"italic",state:false},underline:{button:null,property:"text-decoration",value:"underline",state:false},through:{button:null,property:"text-decoration",value:"line-through",state:false},left:{button:null,property:"text-align",value:"left",state:false,group:"align"},center:{button:null,property:"text-align",value:"center",state:false,group:"align"},right:{button:null,property:"text-align",value:"right",state:false,group:"align"},justify:{button:null,property:"text-align",value:"justify",state:false,group:"align"}}});ma(this,Fa,{writable:true,value:{buttonPressed:"sign-document__block-style--button-pressed"}});babelHelpers.classPrivateFieldSet(this,Sa,t.block);if(t.data){ka(this,Ga,Da).call(this,t.data)}}babelHelpers.createClass(e,[{key:"applyStyles",value:function e(t){t.removeAttribute("style");p.Dom.style(t,this.collectStyles())}},{key:"updateFontSize",value:function e(t){if(t){babelHelpers.classPrivateFieldGet(this,Ta).size["property"]="font-size";babelHelpers.classPrivateFieldGet(this,Ta).size["value"]=t}}},{key:"collectStyles",value:function e(){var t=this;var a={};babelHelpers.toConsumableArray(Object.keys(babelHelpers.classPrivateFieldGet(this,Ta))).map((function(e){if(babelHelpers.classPrivateFieldGet(t,Ta)[e]["state"]||typeof babelHelpers.classPrivateFieldGet(t,Ta)[e]["state"]==="undefined"){var i=babelHelpers.classPrivateFieldGet(t,Ta)[e]["property"];var l=babelHelpers.classPrivateFieldGet(t,Ta)[e]["value"];if(l===null){return}if(babelHelpers.classPrivateFieldGet(t,Ta)[e]["group"]){a[i]=l}else{a[i]=(a[i]?a[i]+" ":"")+l}}}));return a}},{key:"getLayout",value:function e(){var t=this;var a=te.getStylePanel((function(e,a){babelHelpers.classPrivateFieldGet(t,Ta)[e]["value"]=a;babelHelpers.classPrivateFieldGet(t,Sa).renderStyle()}),this.collectStyles());babelHelpers.toConsumableArray(a.querySelectorAll("[data-action]")).map((function(e){var a=e.getAttribute("data-action");if(babelHelpers.classPrivateFieldGet(t,Ta)[a]){p.Event.bind(e,"click",(function(){return ka(t,Ca,Oa).call(t,a)}));babelHelpers.classPrivateFieldGet(t,Ta)[a]["button"]=e;if(babelHelpers.classPrivateFieldGet(t,Ta)[a]["state"]){p.Dom.addClass(babelHelpers.classPrivateFieldGet(t,Ta)[a]["button"],babelHelpers.classPrivateFieldGet(t,Fa).buttonPressed)}}}));return a}},{key:"updateColor",value:function e(t){babelHelpers.classPrivateFieldGet(this,Ta).color.value=t}}]);return e}();function Oa(e){var t=this;babelHelpers.classPrivateFieldGet(this,Ta)[e]["state"]=!babelHelpers.classPrivateFieldGet(this,Ta)[e]["state"];if(babelHelpers.classPrivateFieldGet(this,Ta)[e]["state"]){p.Dom.addClass(babelHelpers.classPrivateFieldGet(this,Ta)[e]["button"],babelHelpers.classPrivateFieldGet(this,Fa).buttonPressed);if(babelHelpers.classPrivateFieldGet(this,Ta)[e]["group"]){var a=babelHelpers.classPrivateFieldGet(this,Ta)[e]["group"];babelHelpers.toConsumableArray(Object.keys(babelHelpers.classPrivateFieldGet(this,Ta))).map((function(i){if(i!==e&&babelHelpers.classPrivateFieldGet(t,Ta)[i]["group"]===a){babelHelpers.classPrivateFieldGet(t,Ta)[i]["state"]=false;p.Dom.removeClass(babelHelpers.classPrivateFieldGet(t,Ta)[i]["button"],babelHelpers.classPrivateFieldGet(t,Fa).buttonPressed)}}))}}else{p.Dom.removeClass(babelHelpers.classPrivateFieldGet(this,Ta)[e]["button"],babelHelpers.classPrivateFieldGet(this,Fa).buttonPressed)}babelHelpers.classPrivateFieldGet(this,Sa).renderStyle()}function Da(e){var t=this;babelHelpers.toConsumableArray(Object.keys(babelHelpers.classPrivateFieldGet(this,Ta))).map((function(a){var i=babelHelpers.classPrivateFieldGet(t,Ta)[a]["property"];if(typeof e[i]!=="undefined"){if(typeof babelHelpers.classPrivateFieldGet(t,Ta)[a]["state"]!=="undefined"){if(e[i].indexOf(babelHelpers.classPrivateFieldGet(t,Ta)[a]["value"])!==-1){babelHelpers.classPrivateFieldGet(t,Ta)[a]["state"]=true}}else{babelHelpers.classPrivateFieldGet(t,Ta)[a]["value"]=e[i]}}}))}function Ia(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function Ea(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ia(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ia(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ma(e,t){La(e,t);t.add(e)}function za(e,t,a){La(e,t);t.set(e,a)}function La(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Ba(e,t,a){Aa(e,t);Na(a,"get");return Ra(e,a)}function Na(e,t){if(e===undefined){throw new TypeError("attempted to "+t+" private static field before its declaration")}}function Aa(e,t){if(e!==t){throw new TypeError("Private static access of wrong provenance")}}function Ra(e,t){if(t.get){return t.get.call(e)}return t.value}function xa(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var ja=new WeakMap;var Wa=new WeakMap;var Ua=new WeakMap;var Xa=new WeakMap;var Va=new WeakMap;var qa=new WeakMap;var Ja=new WeakMap;var Ya=new WeakMap;var Qa=new WeakMap;var Za=new WeakMap;var Ka=new WeakMap;var $a=new WeakMap;var ei=new WeakMap;var ti=new WeakMap;var ai=new WeakMap;var ii=new WeakSet;var li=new WeakSet;var si=new WeakSet;var ri=new WeakSet;var ni=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));Ma(babelHelpers.assertThisInitialized(a),ri);Ma(babelHelpers.assertThisInitialized(a),si);Ma(babelHelpers.assertThisInitialized(a),li);Ma(babelHelpers.assertThisInitialized(a),ii);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"events",{onColorStyleChange:"onColorStyleChange"});za(babelHelpers.assertThisInitialized(a),ja,{writable:true,value:void 0});za(babelHelpers.assertThisInitialized(a),Wa,{writable:true,value:void 0});za(babelHelpers.assertThisInitialized(a),Ua,{writable:true,value:void 0});za(babelHelpers.assertThisInitialized(a),Xa,{writable:true,value:void 0});za(babelHelpers.assertThisInitialized(a),Va,{writable:true,value:null});za(babelHelpers.assertThisInitialized(a),qa,{writable:true,value:void 0});za(babelHelpers.assertThisInitialized(a),Ja,{writable:true,value:2});za(babelHelpers.assertThisInitialized(a),Ya,{writable:true,value:false});za(babelHelpers.assertThisInitialized(a),Qa,{writable:true,value:false});za(babelHelpers.assertThisInitialized(a),Za,{writable:true,value:void 0});za(babelHelpers.assertThisInitialized(a),Ka,{writable:true,value:void 0});za(babelHelpers.assertThisInitialized(a),$a,{writable:true,value:{date:I,myrequisites:x,mysign:fe,mystamp:Oe,number:xe,reference:lt,myreference:Tt,requisites:At,sign:ea,stamp:ra,text:ga}});za(babelHelpers.assertThisInitialized(a),ei,{writable:true,value:void 0});za(babelHelpers.assertThisInitialized(a),ti,{writable:true,value:{blockContent:".sign-document__block-content",blockPanel:".sign-document__block-panel--wrapper",blockLoading:"sign-document-block-loading",blockEditing:"sign-document__block-wrapper-editing",pageWithNotAllowed:"sign-editor__content-document--active-move"}});za(babelHelpers.assertThisInitialized(a),ai,{writable:true,value:void 0});a.setEventNamespace("BX.Sign.Document.Block");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),ja,e.id||null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),Wa,e.code);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),Ja,e.part);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),qa,e.document);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),Za,e.onClick);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),Ka,e.onRemove);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),ai,null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),Xa,new _a({block:babelHelpers.assertThisInitialized(a),data:e.style}));if(!babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),$a)[babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),Wa)]){throw new Error("Content provider for '".concat(babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),Wa),"' not found."))}babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),Va,new(babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),$a)[babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),Wa)])(babelHelpers.assertThisInitialized(a)));xa(babelHelpers.assertThisInitialized(a),li,ci).call(babelHelpers.assertThisInitialized(a));p.Event.bind(babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),Ua),"click",xa(babelHelpers.assertThisInitialized(a),ii,oi).bind(babelHelpers.assertThisInitialized(a)));if(e.part>1){babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),Qa,true)}a.renderStyle();a.setPosition(e.position?e.position:babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),Va).getInitDimension());if(e.data){setTimeout((function(){a.setData(e.data)}),0)}if(!p.Type.isUndefined(Ba(t,t,ui)[a.getCode()])&&babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),Va)instanceof P){babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),Va).updateColor(Ba(t,t,ui)[a.getCode()])}return a}babelHelpers.createClass(t,[{key:"getLayout",value:function e(){return babelHelpers.classPrivateFieldGet(this,Ua)}},{key:"getDocument",value:function e(){return babelHelpers.classPrivateFieldGet(this,qa)}},{key:"setData",value:function e(t){babelHelpers.classPrivateFieldGet(this,Va).setData(t);this.renderView()}},{key:"setPosition",value:function e(t){te.setRect(babelHelpers.classPrivateFieldGet(this,Ua),t)}},{key:"getData",value:function e(){return babelHelpers.classPrivateFieldGet(this,Va).getData()}},{key:"getPosition",value:function e(){var t=babelHelpers.classPrivateFieldGet(this,Ua).getBoundingClientRect(),a=t.top,i=t.left,l=t.width,s=t.height;a=Math.round(a);i=Math.round(i);l=Math.round(l);s=Math.round(s);var r=babelHelpers.classPrivateFieldGet(this,qa).getLayout().getBoundingClientRect();a-=Math.round(r.top);i-=Math.round(r.left);return{top:a,left:i,width:l,height:s}}},{key:"getStyle",value:function e(){return Ea(Ea({},babelHelpers.classPrivateFieldGet(this,Va).getStyles()),babelHelpers.classPrivateFieldGet(this,Xa).collectStyles())}},{key:"getId",value:function e(){return babelHelpers.classPrivateFieldGet(this,ja)|null}},{key:"getCode",value:function e(){return babelHelpers.classPrivateFieldGet(this,Wa)}},{key:"showNotAllowedArea",value:function e(){var t=this.getDocument().transferPositionToPage(this.getPosition()),a=t.page;var i=document.querySelector('.sign-editor__content-document--page[data-page="'.concat(a,'"]'));p.Dom.addClass(i,babelHelpers.classPrivateFieldGet(this,ti).pageWithNotAllowed)}},{key:"hideNotAllowedArea",value:function e(){var t=this.getDocument().transferPositionToPage(this.getPosition()),a=t.page;var i=document.querySelector('.sign-editor__content-document--page[data-page="'.concat(a,'"]'));p.Dom.removeClass(i,babelHelpers.classPrivateFieldGet(this,ti).pageWithNotAllowed)}},{key:"getMemberPart",value:function e(){return babelHelpers.classPrivateFieldGet(this,Ja)}},{key:"fireAction",value:function e(){if(babelHelpers.classPrivateFieldGet(this,Va)["onActionClick"]){if(babelHelpers.classPrivateFieldGet(this,Wa)==="text"){p.Dom.addClass(babelHelpers.classPrivateFieldGet(this,Ua),babelHelpers.classPrivateFieldGet(this,ti).blockEditing)}babelHelpers.classPrivateFieldGet(this,Va)["onActionClick"]()}}},{key:"onMemberSelect",value:function e(t){babelHelpers.classPrivateFieldSet(this,Ja,t);this.assign()}},{key:"await",value:function e(t){var a=this;var i=[];if(!babelHelpers.classPrivateFieldGet(this,Va).isSingleton()){i.push(this.getLayout())}else{var l=this.getCode();babelHelpers.classPrivateFieldGet(this,qa).getBlocks().map((function(e){if(e.getCode()===l){i.push(e.getLayout())}}))}i.map((function(e,l){if(t){if(i.length===l+1){p.Dom.addClass(e,babelHelpers.classPrivateFieldGet(a,ti).blockLoading)}}else{p.Dom.removeClass(e,babelHelpers.classPrivateFieldGet(a,ti).blockLoading)}}))}},{key:"assign",value:function e(){var t=this;var a=this.getLayout();var i=[];var l=[];this["await"](true);if(!babelHelpers.classPrivateFieldGet(this,Va).isSingleton()){i.push({code:babelHelpers.classPrivateFieldGet(this,Wa),part:babelHelpers.classPrivateFieldGet(this,Ja),data:this.getData()});l.push(this)}else{babelHelpers.classPrivateFieldGet(this,qa).getBlocks().map((function(e){if(e.getCode()===t.getCode()&&e.getMemberPart()===t.getMemberPart()){i.push({code:e.getCode(),part:e.getMemberPart(),data:e.getData()});l.push(e)}}))}c.Backend.controller({command:"blank.assignBlocks",postData:{documentId:babelHelpers.classPrivateFieldGet(this,qa).getId(),blocksData:i},getData:{code:babelHelpers.classPrivateFieldGet(this,Wa)}}).then((function(e){if(p.Type.isArray(e)){e.map((function(e,t){l[t].setData(e.data)}))}t["await"](false);babelHelpers.classPrivateFieldGet(t,qa).showResizeArea(t)}))["catch"]((function(e){p.Dom.remove(a)}))}},{key:"renderView",value:function e(){var t=this;var a=babelHelpers.classPrivateFieldGet(this,Ua).querySelector(babelHelpers.classPrivateFieldGet(this,ti).blockContent);p.Dom.clean(a);switch(babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()){case"stamp":case"mystamp":case"sign":case"mysign":p.Dom.addClass(a,"--image")}var i=babelHelpers.classPrivateFieldGet(this,Va).getViewContent();p.Dom.append(i,a);p.Dom.addClass(i,"--"+babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase());if(babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="requisites"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="myrequisites"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="date"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="number"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="stamp"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="mystamp"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="sign"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="mysign"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="reference"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="myreference"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="text"){i.style.setProperty("display","block");i.style.setProperty("overflow","hidden");if(!this.observerReady){if(this.getStyle()["font-size"]){this.maxTextSize=parseFloat(this.getStyle()["font-size"])}else{this.maxTextSize=14}this.isOverflownX=function(e){var t=e.clientHeight,a=e.scrollHeight;return a>t};h.EventEmitter.subscribe(i.parentNode.parentNode,"BX.Sign:setFontSize",(function(e){if(e.data.fontSize){t.maxTextSize=e.data.fontSize;t.resizeText({element:e.target.querySelector(".sign-document__block-content > div"),step:.5})}}));this.resizeText=function(e){var a=e.element,i=e.minSize,l=i===void 0?1:i,s=e.step,r=s===void 0?1:s,n=e.unit,o=n===void 0?"px":n;if(t.intervalTextResize){clearTimeout(t.intervalTextResize)}var c=l;var b=false;var d=a.parentNode;while(!b&&c<t.maxTextSize){a.style.fontSize="".concat(c).concat(o);b=t.isOverflownX(d);if(!b){c+=r}}babelHelpers.classPrivateFieldSet(t,ei,"".concat(c-r).concat(o));a.style.fontSize=babelHelpers.classPrivateFieldGet(t,ei);t.intervalTextResize=setTimeout((function(){a.parentNode.style.setProperty("font-size",a.style.fontSize);a.style.removeProperty("font-size",a.style.fontSize);babelHelpers.classPrivateFieldGet(t,Xa).updateFontSize(babelHelpers.classPrivateFieldGet(t,ei))}),1e3)};if(babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="requisites"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="myrequisites"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="reference"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="myreference"||babelHelpers.classPrivateFieldGet(this,Wa).toLowerCase()==="text"){this.resizeText({element:i,step:.5})}babelHelpers.classPrivateFieldGet(this,Va).subscribe(babelHelpers.classPrivateFieldGet(this,Va).events.onChange,xa(this,si,bi).bind(this));babelHelpers.classPrivateFieldGet(this,Va).subscribe(babelHelpers.classPrivateFieldGet(this,Va).events.onColorStyleChange,xa(this,ri,di).bind(this));this.observerReady=true}if(babelHelpers.classPrivateFieldGet(this,ai)){this.resizeText({element:i,step:.5})}}babelHelpers.classPrivateFieldSet(this,ai,true);if(babelHelpers.classPrivateFieldGet(this,Ya)){return}var l=babelHelpers.classPrivateFieldGet(this,Ua).querySelector(babelHelpers.classPrivateFieldGet(this,ti).blockPanel);p.Dom.clean(l);if(babelHelpers.classPrivateFieldGet(this,Va).isStyleAllowed()){p.Dom.append(babelHelpers.classPrivateFieldGet(this,Xa).getLayout(),l)}p.Dom.append(babelHelpers.classPrivateFieldGet(this,Va).getActionButton(),l);p.Dom.append(babelHelpers.classPrivateFieldGet(this,Va).getBlockCaption(),l);if(babelHelpers.classPrivateFieldGet(this,Qa)){p.Dom.append(te.getMemberSelector(babelHelpers.classPrivateFieldGet(this,qa).getMembers(),babelHelpers.classPrivateFieldGet(this,Ja),this.onMemberSelect.bind(this)),l)}babelHelpers.classPrivateFieldSet(this,Ya,true)}},{key:"getCurrentFontSize",value:function e(){return babelHelpers.classPrivateFieldGet(this,ei)}},{key:"onStartChangePosition",value:function e(){babelHelpers.classPrivateFieldGet(this,Va).onStartChangePosition()}},{key:"onPlaced",value:function e(){babelHelpers.classPrivateFieldGet(this,Va).onPlaced()}},{key:"onSave",value:function e(){babelHelpers.classPrivateFieldGet(this,Va).onSave()}},{key:"onRemove",value:function e(){babelHelpers.classPrivateFieldGet(this,Va).onRemove()}},{key:"onClickOut",value:function e(){babelHelpers.classPrivateFieldGet(this,Va).onClickOut()}},{key:"renderStyle",value:function e(){babelHelpers.classPrivateFieldGet(this,Xa).applyStyles(babelHelpers.classPrivateFieldGet(this,Ua).querySelector(babelHelpers.classPrivateFieldGet(this,ti).blockContent));babelHelpers.classPrivateFieldGet(this,Va).onStyleRender(babelHelpers.classPrivateFieldGet(this,Xa).collectStyles())}},{key:"adjustActionsPanel",value:function e(){var t=this.getLayout();var a=t.querySelector('[data-role="sign-block__actions"]');if(a){var i=a.getBoundingClientRect();var l=t.getBoundingClientRect();var s=i.width;var r=l.width;var n=(s-r)/2;if(n>l.left){a.style.marginLeft=n-50+"px"}else{a.style.marginLeft=0}}}},{key:"forceSave",value:function e(){babelHelpers.classPrivateFieldGet(this,Ua).querySelector('[data-role="saveAction"]').click()}},{key:"isRemoved",value:function e(){return babelHelpers.classPrivateFieldGet(this,Ua).hidden===true}}]);return t}(h.EventEmitter);function oi(){if(babelHelpers.classPrivateFieldGet(this,Za)){babelHelpers.classPrivateFieldGet(this,Za).call(this,this)}}function ci(){var e=this;babelHelpers.classPrivateFieldSet(this,Ua,te.getBlockLayout({onSave:function t(a){e.renderView();babelHelpers.classPrivateFieldGet(e,qa).unMuteResizeArea();babelHelpers.classPrivateFieldGet(e,qa).hideResizeArea();babelHelpers.classPrivateFieldGet(e,qa).setSavingMark(false);e.onSave();p.Dom.removeClass(babelHelpers.classPrivateFieldGet(e,Ua),babelHelpers.classPrivateFieldGet(e,ti).blockEditing);a.stopPropagation()},onRemove:function t(a){if(babelHelpers.classPrivateFieldGet(e,Ka)){babelHelpers.classPrivateFieldGet(e,Ka).call(e,e)}babelHelpers.classPrivateFieldGet(e,Ua).hidden=true;e.onRemove();a.stopPropagation()}}));var t=document.body.querySelector('[data-role="sign-editor__content"]');var a=babelHelpers.classPrivateFieldGet(this,qa).getLayout().getBoundingClientRect();var i=babelHelpers.classPrivateFieldGet(this,Va).getInitDimension();var l={top:Math.min(t.scrollTop+t.offsetHeight/2,a.height-i.height),left:a.width/2-100};if(this.getDocument().inDeadZone(l.top,l.top+i.height)){l.top+=i.height+this.getDocument().getPagesGap()}this.setPosition(l)}function bi(){var e=babelHelpers.classPrivateFieldGet(this,Va);if(!(e instanceof ga)){return}this.resizeText({element:e.getContainer(),step:.5})}function di(){var e,t=this;if(!(babelHelpers.classPrivateFieldGet(this,Va)instanceof ea||babelHelpers.classPrivateFieldGet(this,Va)instanceof fe)){return}var a=(e=babelHelpers.classPrivateFieldGet(this,Va).getStyles())===null||e===void 0?void 0:e.color;if(p.Type.isNil(a)){return}babelHelpers.classPrivateFieldGet(this,qa).getBlocks().filter((function(e){return(babelHelpers.classPrivateFieldGet(e,Va)instanceof ea||babelHelpers.classPrivateFieldGet(e,Va)instanceof fe)&&e.getCode()===t.getCode()})).forEach((function(e){if(babelHelpers.classPrivateFieldGet(e,Va)instanceof P){babelHelpers.classPrivateFieldGet(e,Va).updateColor(a);babelHelpers.classPrivateFieldGet(e,Xa).updateColor(a)}}));Ba(ni,ni,ui)[this.getCode()]=a}var ui={writable:true,value:{}};function pi(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function vi(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?pi(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pi(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function hi(e,t){gi(e,t);t.add(e)}function fi(e,t,a){gi(e,t);t.set(e,a)}function gi(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function yi(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var Hi=new WeakMap;var Pi=new WeakMap;var mi=new WeakMap;var wi=new WeakMap;var ki=new WeakMap;var Si=new WeakMap;var Ti=new WeakMap;var Fi=new WeakSet;var Ci=new WeakSet;var Gi=new WeakSet;var _i=new WeakSet;var Oi=function(){function e(t){babelHelpers.classCallCheck(this,e);hi(this,_i);hi(this,Gi);hi(this,Ci);hi(this,Fi);fi(this,Hi,{writable:true,value:void 0});fi(this,Pi,{writable:true,value:void 0});fi(this,mi,{writable:true,value:void 0});fi(this,wi,{writable:true,value:void 0});fi(this,ki,{writable:true,value:void 0});fi(this,Si,{writable:true,value:void 0});fi(this,Ti,{writable:true,value:{resizeContainer:".sign-area-resizable-controls > div",moveContainer:".sign-document__resize-area",blockEditing:"sign-document__block-wrapper-editing"}});if(!p.Type.isDomNode(t.wrapperLayout)){throw new Error("Option wrapperLayout is undefined or not valid DOM Element.")}babelHelpers.classPrivateFieldSet(this,mi,te.getResizeArea());babelHelpers.classPrivateFieldSet(this,Hi,t.wrapperLayout);babelHelpers.classPrivateFieldSet(this,Pi,babelHelpers.classPrivateFieldGet(this,Hi).getBoundingClientRect());babelHelpers.classPrivateFieldSet(this,wi,document.body.querySelector('[data-role="sign-editor__content"]'));p.Event.bind(babelHelpers.classPrivateFieldGet(this,mi),"click",yi(this,Ci,Di).bind(this));yi(this,Gi,Ii).call(this);yi(this,_i,Ei).call(this)}babelHelpers.createClass(e,[{key:"getLayout",value:function e(){return babelHelpers.classPrivateFieldGet(this,mi)}},{key:"show",value:function t(a){if(babelHelpers.classPrivateFieldGet(this,Si)===a){return}var i=a.getLayout().getBoundingClientRect();babelHelpers.classPrivateFieldGet(this,mi).style.display="block";if(babelHelpers.classPrivateFieldGet(this,ki)){babelHelpers.classPrivateFieldGet(this,ki).removeAttribute("data-active")}babelHelpers.classPrivateFieldSet(this,Si,a);babelHelpers.classPrivateFieldSet(this,ki,a.getLayout());babelHelpers.classPrivateFieldGet(this,ki).setAttribute("data-active",1);te.setRect(babelHelpers.classPrivateFieldGet(this,mi),{top:i.top-babelHelpers.classPrivateFieldGet(this,Pi).top+babelHelpers.classPrivateFieldGet(this,wi).scrollTop,left:i.left-babelHelpers.classPrivateFieldGet(this,Pi).left,width:i.width+e.borderDelta,height:i.height+e.borderDelta})}},{key:"hide",value:function e(){babelHelpers.classPrivateFieldSet(this,Si,null);babelHelpers.classPrivateFieldGet(this,mi).style.display="none";if(babelHelpers.classPrivateFieldGet(this,ki)){babelHelpers.classPrivateFieldGet(this,ki).removeAttribute("data-active")}}},{key:"getLinkedBlock",value:function e(){return babelHelpers.classPrivateFieldGet(this,Si)}}]);return e}();function Di(e){if(this.moving||this.resizing){return}if(babelHelpers.classPrivateFieldGet(this,Si)){babelHelpers.classPrivateFieldGet(this,Si).fireAction()}}function Ii(){var e=this;var t=null;var a=new v.Draggable({container:babelHelpers.classPrivateFieldGet(this,Hi),draggable:babelHelpers.classPrivateFieldGet(this,Ti).resizeContainer,type:BX.UI.DragAndDrop.Draggable.HEADLESS});this.textResize={wrapper:null,content:null};a.subscribe("start",(function(i){if(babelHelpers.classPrivateFieldGet(e,mi).getAttribute("data-disable")){return}if(!e.textResize.wrapper||!e.textResize.content){e.textResize={wrapper:babelHelpers.classPrivateFieldGet(e,Si).getLayout(),content:babelHelpers.classPrivateFieldGet(e,Si).getLayout().querySelector(".sign-document__block-content")}}h.EventEmitter.emit("BX.Sign:resizeStart",a);t=babelHelpers.classPrivateFieldGet(e,mi).getBoundingClientRect();babelHelpers.classPrivateFieldGet(e,Si).onStartChangePosition();e.positionLast=null;p.Dom.removeClass(babelHelpers.classPrivateFieldGet(e,Si).getLayout(),babelHelpers.classPrivateFieldGet(e,Ti).blockEditing)})).subscribe("end",(function(t){setTimeout((function(){e.resizing=false}),0)})).subscribe("move",(function(a){if(babelHelpers.classPrivateFieldGet(e,mi).getAttribute("data-disable")){return}e.resizing=true;var i=null;var l=null;var s=false;var r=t,n=r.width,o=r.height;var c=a.getData();var b=babelHelpers.classPrivateFieldGet(e,mi).getBoundingClientRect();var d=babelHelpers.classPrivateFieldGet(e,Hi).getBoundingClientRect();if(p.Dom.hasClass(c.draggable,"sign-document__resize-control --left-top")){i=Math.max(0,t.left+c.offsetX-babelHelpers.classPrivateFieldGet(e,Pi).left);l=Math.max(0,t.top+c.offsetY-babelHelpers.classPrivateFieldGet(e,Pi).top+babelHelpers.classPrivateFieldGet(e,wi).scrollTop);n=t.width-c.offsetX;o=t.height-c.offsetY}if(p.Dom.hasClass(c.draggable,"sign-document__resize-control --middle-top")){l=Math.max(0,t.top+c.offsetY-babelHelpers.classPrivateFieldGet(e,Pi).top+babelHelpers.classPrivateFieldGet(e,wi).scrollTop);o=t.height-c.offsetY}if(p.Dom.hasClass(c.draggable,"sign-document__resize-control --right-top")){l=Math.max(0,t.top+c.offsetY-babelHelpers.classPrivateFieldGet(e,Pi).top+babelHelpers.classPrivateFieldGet(e,wi).scrollTop);n=t.width+c.offsetX;o=t.height-c.offsetY}if(p.Dom.hasClass(c.draggable,"sign-document__resize-control --middle-right")){n=t.width+c.offsetX}if(p.Dom.hasClass(c.draggable,"sign-document__resize-control --right-bottom")){n=t.width+c.offsetX;o=t.height+c.offsetY;s=true}if(p.Dom.hasClass(c.draggable,"sign-document__resize-control --middle-bottom")){o=t.height+c.offsetY;s=true}if(p.Dom.hasClass(c.draggable,"sign-document__resize-control --left-bottom")){i=t.left+c.offsetX-babelHelpers.classPrivateFieldGet(e,Pi).left;n=t.width-c.offsetX;o=t.height+c.offsetY;s=true}if(p.Dom.hasClass(c.draggable,"sign-document__resize-control --middle-left")){i=t.left+c.offsetX-babelHelpers.classPrivateFieldGet(e,Pi).left;n=t.width-c.offsetX}if(n<60||o<20){return}var u={width:n,height:o};if(u["width"]+b.left-d.left>d.width){n=u["width"]=d.width+d.left-b.left}if(u["height"]+b.top-d.top>d.height){o=u["height"]=d.height+d.top-b.top}if(i){if(i<0){i=0}u["left"]=i}if(l){u["top"]=l}var v=t.top+babelHelpers.classPrivateFieldGet(e,wi).scrollTop;var h=true;if(u.top){v=u.top;h=false}if(babelHelpers.classPrivateFieldGet(e,Si).getDocument().inDeadZone(v,v+u.height,h)){if(!s){babelHelpers.classPrivateFieldGet(e,Si).showNotAllowedArea()}return}var f=Object.assign({},vi(vi({},u),{},{width:n-Oi.borderDelta,height:o-Oi.borderDelta}));te.setRect(babelHelpers.classPrivateFieldGet(e,mi),u);te.setRect(babelHelpers.classPrivateFieldGet(e,ki),f);babelHelpers.classPrivateFieldGet(e,Si).renderView();babelHelpers.classPrivateFieldGet(e,Si).getDocument().setSavingMark(false);babelHelpers.classPrivateFieldGet(e,Si).adjustActionsPanel()}))}function Ei(){var e=this;var t=babelHelpers.classPrivateFieldGet(this,Hi);var a;var i=new v.Draggable({container:t,draggable:babelHelpers.classPrivateFieldGet(this,Ti).moveContainer,type:v.Draggable.HEADLESS});i.subscribe("start",(function(t){if(babelHelpers.classPrivateFieldGet(e,mi).getAttribute("data-disable")){return}h.EventEmitter.emit("BX.Sign:moveStart",i);if(e.resizing){return}var a=t.getData(),l=a.source;e.position=p.Dom.getPosition(l);babelHelpers.classPrivateFieldGet(e,Si).onStartChangePosition();e.positionLast=null;p.Dom.removeClass(babelHelpers.classPrivateFieldGet(e,Si).getLayout(),babelHelpers.classPrivateFieldGet(e,Ti).blockEditing)})).subscribe("end",(function(t){setTimeout((function(){e.moving=false}),0);if(!babelHelpers.classPrivateFieldGet(e,Si)){return}if(e.resizing){return}a=null;var i=t.getData();var l=null;if(e.positionLast){l=babelHelpers.classPrivateFieldGet(e,Si).getDocument().inDeadZone(e.positionLast.top,e.positionLast.top+e.positionLast.height)}babelHelpers.classPrivateFieldGet(e,Si).hideNotAllowedArea();if(l){te.setRect(i.source,{top:e.positionLast.top+l});te.setRect(babelHelpers.classPrivateFieldGet(e,ki),{top:e.positionLast.top+l})}})).subscribe("move",(function(t){if(babelHelpers.classPrivateFieldGet(e,mi).getAttribute("data-disable")){return}if(e.resizing){return}e.moving=true;var i=t.getData();var l=i.source,s=i.offsetY,r=i.offsetX;var n=i.source.getBoundingClientRect();var o=babelHelpers.classPrivateFieldGet(e,Hi).getBoundingClientRect();if(e.position){var c={top:s-babelHelpers.classPrivateFieldGet(e,Pi).top+e.position.y+babelHelpers.classPrivateFieldGet(e,wi).scrollTop,left:r-babelHelpers.classPrivateFieldGet(e,Pi).left+e.position.x,width:a?a:e.position.width,height:e.position.height};if(c.left<0){c.left=0}if(c.top<0){c.top=0}if(c.top+n.height>o.height){c.top=o.height-n.height}if(c.left+n.width>o.width){babelHelpers.classPrivateFieldGet(e,Si).renderView();if(o.width-c.left>50){a=c.width=o.width-c.left}else{c.left=o.width-n.width}}e.positionLast=Object.assign({},c);var b=null;if(e.positionLast){b=babelHelpers.classPrivateFieldGet(e,Si).getDocument().inDeadZone(e.positionLast.top,e.positionLast.top+e.positionLast.height)}if(b>0){babelHelpers.classPrivateFieldGet(e,Si).showNotAllowedArea()}else{babelHelpers.classPrivateFieldGet(e,Si).hideNotAllowedArea()}var d=Object.assign({},vi(vi({},c),{},{width:c.width-Oi.borderDelta,height:c.height-Oi.borderDelta}));te.setRect(l,c);te.setRect(babelHelpers.classPrivateFieldGet(e,ki),d);babelHelpers.classPrivateFieldGet(e,Si).getDocument().setSavingMark(false);babelHelpers.classPrivateFieldGet(e,Si).adjustActionsPanel()}}))}babelHelpers.defineProperty(Oi,"borderDelta",2);var Mi,zi,Li;function Bi(e,t){Ai(e,t);t.add(e)}function Ni(e,t,a){Ai(e,t);t.set(e,a)}function Ai(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Ri(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var xi=new WeakMap;var ji=new WeakMap;var Wi=new WeakMap;var Ui=new WeakMap;var Xi=new WeakMap;var Vi=new WeakMap;var qi=new WeakMap;var Ji=new WeakMap;var Yi=new WeakMap;var Qi=new WeakMap;var Zi=new WeakMap;var Ki=new WeakMap;var $i=new WeakMap;var el=new WeakMap;var tl=new WeakMap;var al=new WeakMap;var il=new WeakMap;var ll=new WeakMap;var sl=new WeakSet;var rl=new WeakSet;var nl=new WeakSet;var ol=new WeakSet;var cl=new WeakSet;var bl=new WeakSet;var dl=new WeakSet;var ul=new WeakSet;var pl=new WeakSet;var vl=new WeakSet;var hl=function(){function e(t){var a=this;babelHelpers.classCallCheck(this,e);Bi(this,vl);Bi(this,pl);Bi(this,ul);Bi(this,dl);Bi(this,bl);Bi(this,cl);Bi(this,ol);Bi(this,nl);Bi(this,rl);Bi(this,sl);Ni(this,xi,{writable:true,value:void 0});Ni(this,ji,{writable:true,value:void 0});Ni(this,Wi,{writable:true,value:void 0});Ni(this,Ui,{writable:true,value:void 0});Ni(this,Xi,{writable:true,value:void 0});Ni(this,Vi,{writable:true,value:0});Ni(this,qi,{writable:true,value:void 0});Ni(this,Ji,{writable:true,value:false});Ni(this,Yi,{writable:true,value:void 0});Ni(this,Qi,{writable:true,value:void 0});Ni(this,Zi,{writable:true,value:void 0});Ni(this,Ki,{writable:true,value:void 0});Ni(this,$i,{writable:true,value:[]});Ni(this,el,{writable:true,value:[]});Ni(this,tl,{writable:true,value:[]});Ni(this,al,{writable:true,value:void 0});Ni(this,il,{writable:true,value:"sign-editor-help-btn"});Ni(this,ll,{writable:true,value:"16571388"});if(e.alreadyInit){return}if(!p.Type.isDomNode(t.documentLayout)){throw new Error("Option documentLayout is undefined or not valid DOM Element.")}e.alreadyInit=true;babelHelpers.classPrivateFieldSet(this,xi,t.documentId);babelHelpers.classPrivateFieldSet(this,ji,t.companyId);babelHelpers.classPrivateFieldSet(this,Wi,t.initiatorName);babelHelpers.classPrivateFieldSet(this,Ui,t.entityId);babelHelpers.classPrivateFieldSet(this,Xi,t.blankId);babelHelpers.classPrivateFieldSet(this,Qi,t.documentLayout);babelHelpers.classPrivateFieldSet(this,Zi,babelHelpers.classPrivateFieldGet(this,Qi).getBoundingClientRect());babelHelpers.classPrivateFieldSet(this,qi,t.disableEdit);babelHelpers.classPrivateFieldSet(this,al,t.config);babelHelpers.classPrivateFieldSet(this,Yi,t.members.filter((function(e){return e.cid!==0})));Ri(this,sl,fl).call(this);if(!babelHelpers.classPrivateFieldGet(this,qi)){babelHelpers.classPrivateFieldSet(this,Ki,new Oi({wrapperLayout:babelHelpers.classPrivateFieldGet(this,Qi)}));p.Dom.append(babelHelpers.classPrivateFieldGet(this,Ki).getLayout(),babelHelpers.classPrivateFieldGet(this,Qi))}if(t.repositoryItems&&!babelHelpers.classPrivateFieldGet(this,qi)){Ri(this,ul,kl).call(this,t.repositoryItems)}if(t.blocks){Ri(this,dl,wl).call(this,t.blocks)}if(t.saveButton){this.onSave(t)}this.onCloseSlider();p.Event.bind(document.body,"click",(function(e){if(e.target.getAttribute("data-role")){if(babelHelpers.classPrivateFieldGet(a,Ki)){var t=babelHelpers.classPrivateFieldGet(a,Ki).getLinkedBlock();if(t){t.onClickOut()}}}}));if(t.closeDemoContent){p.Event.bind(t.closeDemoContent,"click",(function(e){babelHelpers.classPrivateFieldSet(a,Ji,true)}))}p.Event.bind(document.getElementById(babelHelpers.classPrivateFieldGet(this,il)),"click",(function(e){top.BX.Helper.show("redirect=detail&code="+babelHelpers.classPrivateFieldGet(a,ll));e.preventDefault()}));if(babelHelpers.classPrivateFieldGet(this,qi)){Ri(this,pl,Sl).call(this)}else{Ri(this,vl,Tl).call(this)}}babelHelpers.createClass(e,[{key:"transferPositionToPage",value:function t(a){a.page=1;for(var i=0,l=babelHelpers.classPrivateFieldGet(this,el).length;i<l;i++){var s=babelHelpers.classPrivateFieldGet(this,el)[i].height;if(i!==0){a.top-=e.gapBetweenPages}a.top-=s;if(a.top<0){a.top+=s;break}else{a.page++}}return a}},{key:"getMinPageHeight",value:function t(){return babelHelpers.classPrivateFieldGet(this,Vi)-e.marginTop}},{key:"getId",value:function e(){return babelHelpers.classPrivateFieldGet(this,xi)}},{key:"getEntityId",value:function e(){return babelHelpers.classPrivateFieldGet(this,Ui)}},{key:"getLayout",value:function e(){return babelHelpers.classPrivateFieldGet(this,Qi)}},{key:"getSeams",value:function e(){return babelHelpers.classPrivateFieldGet(this,tl)}},{key:"getPagesGap",value:function t(){return e.gapBetweenPages+e.marginTop}},{key:"getMembers",value:function e(){return babelHelpers.classPrivateFieldGet(this,Yi)}},{key:"getMemberByPart",value:function e(t){var a=null;babelHelpers.classPrivateFieldGet(this,Yi).map((function(e){if(e.part===t){a=e}}));return a}},{key:"getCompanyId",value:function e(){return babelHelpers.classPrivateFieldGet(this,ji)}},{key:"getInitiatorName",value:function e(){return babelHelpers.classPrivateFieldGet(this,Wi)}},{key:"getConfig",value:function e(){return babelHelpers.classPrivateFieldGet(this,al)}},{key:"hideResizeArea",value:function e(){babelHelpers.classPrivateFieldGet(this,Ki).hide()}},{key:"showResizeArea",value:function e(t){babelHelpers.classPrivateFieldGet(this,Ki).show(t)}},{key:"muteResizeArea",value:function e(){babelHelpers.classPrivateFieldGet(this,Ki).getLayout().setAttribute("data-disable",1)}},{key:"unMuteResizeArea",value:function e(){babelHelpers.classPrivateFieldGet(this,Ki).getLayout().removeAttribute("data-disable")}},{key:"getBlocks",value:function e(){return babelHelpers.classPrivateFieldGet(this,$i)}},{key:"save",value:function e(){var t=this;var i=[];var l=document.querySelector('[data-type="document-layout"]').offsetWidth;babelHelpers.classPrivateFieldGet(this,$i).map((function(e){if(e.isRemoved()){return}var a=e.getPosition();a=t.transferPositionToPage(a);a=Ri(t,nl,yl).call(t,a);a.realDocumentWidthPx=l?l:null;i.push({id:e.getId(),code:e.getCode(),data:e.getData(),part:e.getMemberPart(),style:e.getStyle(),position:a})}));var s={};if(babelHelpers.classPrivateFieldGet(this,Ji)){s["closeDemoContent"]=true}return c.Backend.controller({command:"blank.save",postData:{documentId:babelHelpers.classPrivateFieldGet(this,xi),blocks:i.length>0?i:[],params:s}})["catch"]((function(e){var i,l;if(((i=e.errors[0])===null||i===void 0?void 0:(l=i.customData)===null||l===void 0?void 0:l.field)==="requisites"){var s;var r=new a.Popup({id:"sign_document_error_popup",titleBar:p.Loc.getMessage("SIGN_JS_DOCUMENT_REQUISITES_RESTORE_TITLE"),content:BX.util.htmlspecialchars((s=e.errors[0])===null||s===void 0?void 0:s.message),buttons:[new f.Button({text:p.Loc.getMessage("SIGN_JS_DOCUMENT_REQUISITES_RESTORE"),color:f.ButtonColor.SUCCESS,onclick:function a(){var i,l;c.Backend.controller({command:"document.restoreRequisiteFields",postData:{documentId:babelHelpers.classPrivateFieldGet(t,xi),presetId:(i=e.errors[0])===null||i===void 0?void 0:i.customData.presetId,code:(l=e.errors[0])===null||l===void 0?void 0:l.customData.code}}).then((function(){babelHelpers.classPrivateFieldGet(t,$i).map((function(t){var a;if(t.isRemoved()){return}if(t.getCode()===((a=e.errors[0])===null||a===void 0?void 0:a.customData.code)){t.assign()}}));r.destroy()}))["catch"]((function(){r.destroy()}))}}),new f.Button({text:p.Loc.getMessage("SIGN_JS_DOCUMENT_REQUISITES_RESTORE_BY_HANDS"),color:f.ButtonColor.INFO,onclick:function a(){babelHelpers.classPrivateFieldGet(t,$i).map((function(t){var a;if(t.isRemoved()){return}if(t.getCode()===((a=e.errors[0])===null||a===void 0?void 0:a.customData.code)){var i=document.querySelector('button[data-id="action-'+t.getCode()+'"]');if(i){i.click()}}}));r.destroy()}})]});r.show()}}))}},{key:"onSave",value:function e(t){var a=this;p.Event.bind(t.saveButton,"click",(function(e){if(babelHelpers.classPrivateFieldGet(a,qi)){if(t.afterSaveCallback){t.afterSaveCallback()}return}a.save().then((function(e){if(e===true){a.setSavingMark(true);if(t.afterSaveCallback){t.afterSaveCallback()}}if(e!==true){if(t.saveErrorCallback){t.saveErrorCallback()}}}))}))}},{key:"onCloseSlider",value:function e(){var a=this;BX.addCustomEvent("SidePanel.Slider:onClose",(function(e){if(e.slider.url.indexOf("/sign/edit/")===0){if(!a.everythingIsSaved()){e.denyAction();t.MessageBox.confirm(p.Loc.getMessage("SIGN_JS_DOCUMENT_SAVE_ALERT_MESSAGE"),p.Loc.getMessage("SIGN_JS_DOCUMENT_SAVE_ALERT_TITLE"),(function(t){a.setSavingMark(true);t.close();e.slider.close()}),p.Loc.getMessage("SIGN_JS_DOCUMENT_SAVE_ALERT_APPLY"),(function(e){e.close()}))}}}))}},{key:"setSavingMark",value:function e(t){this.setParam("bxSignEditorAllSaved",t)}},{key:"everythingIsSaved",value:function e(){return this.getParam("bxSignEditorAllSaved")===true}},{key:"setParam",value:function e(t,a){var i=BX.SidePanel.Instance.getSliderByWindow(window);if(i){i.getData().set(t,a)}}},{key:"getParam",value:function e(t){var a=BX.SidePanel.Instance.getSliderByWindow(window);if(a){return a.getData().get(t)}return undefined}},{key:"inDeadZone",value:function e(t,a,i){var l=this.getSeams();if(l.length>0&&i!==true){t+=babelHelpers.classPrivateFieldGet(this,Zi).top;a+=babelHelpers.classPrivateFieldGet(this,Zi).top}for(var s=0,r=l.length;s<r;s++){var n=l[s];if(t<=n[0]&&a>=n[0]&&a<=n[1]){return n[0]-a}if(t<=n[0]&&a>=n[1]){return n[0]-a}if(t>=n[0]&&a<=n[1]){return n[0]-a}if(t>=n[0]&&t<=n[1]&&a>=n[1]){return n[1]-t}}return 0}}]);return e}();function fl(){var e=this;var t=0;babelHelpers.toConsumableArray(babelHelpers.classPrivateFieldGet(this,Qi).querySelectorAll("[data-page] img")).map((function(a){var i=a.getBoundingClientRect();var l={};for(var s in i){if(p.Type.isNumber(i[s])){l[s]=Math.round(i[s])}else{l[s]=i[s]}}babelHelpers.classPrivateFieldGet(e,tl).push([t===0?0:l.top-hl.gapBetweenPages,l.top+hl.marginTop]);if(t===0){t=l.top}else{t+=hl.gapBetweenPages;l.top=t}babelHelpers.classPrivateFieldGet(e,el).push(l);if(!babelHelpers.classPrivateFieldGet(e,Vi)||i.height<babelHelpers.classPrivateFieldGet(e,Vi)){babelHelpers.classPrivateFieldSet(e,Vi,i.height)}}))}function gl(e,t){for(var a=0;a<t-1;a++){e+=babelHelpers.classPrivateFieldGet(this,el)[a].height}return e}function yl(e){if(!e.page||typeof babelHelpers.classPrivateFieldGet(this,el)[e.page-1]==="undefined"){return e}var t=babelHelpers.classPrivateFieldGet(this,el)[e.page-1];e.widthPx=e.width;e.heightPx=e.height;e.left=e.left/t.width*100;e.top=e.top/t.height*100;e.width=e.width/t.width*100;e.height=e.height/t.height*100;return e}function Hl(e){if(!e.page||typeof babelHelpers.classPrivateFieldGet(this,el)[e.page-1]==="undefined"){return e}var t=babelHelpers.classPrivateFieldGet(this,el)[e.page-1];if(e.left){e.left=e.left*t.width/100}if(e.top){e.top=e.top*t.height/100}if(e.width){e.width=e.width*t.width/100}if(e.height){e.height=e.height*t.height/100}return e}function Pl(e,t){var a=this;if(e.position){e.position=Ri(this,ol,Hl).call(this,e.position);if(!e.style["font-size"]){e.style["font-size"]="14px"}if(e!==null&&e!==void 0&&e.position["page"]&&e!==null&&e!==void 0&&e.position["top"]){e.position["top"]=Ri(this,rl,gl).call(this,parseFloat(e.position["top"]),parseFloat(e.position["page"]));if(t){e.position.top+=(e.position.page-1)*hl.gapBetweenPages}}}var i=new ni({id:e.id,code:e.code,part:e.part,document:this,data:e.data,position:e.position,style:e.style,onClick:function e(t){if(babelHelpers.classPrivateFieldGet(a,qi)){return}babelHelpers.classPrivateFieldGet(a,Ki).show(t);a.unMuteResizeArea();t.adjustActionsPanel()},onRemove:function e(t){babelHelpers.classPrivateFieldGet(a,Ki).hide()}});var l=i.getLayout();babelHelpers.classPrivateFieldGet(this,$i).push(i);p.Dom.append(l,babelHelpers.classPrivateFieldGet(this,Qi));return i}function ml(e,t){t=parseInt(t);this.setSavingMark(false);var a=Ri(this,cl,Pl).call(this,{code:e,part:t});a.assign();a.onPlaced()}function wl(e){var t=this;e.map((function(e){return Ri(t,cl,Pl).call(t,e,true)}))}function kl(e){var t=this;babelHelpers.toConsumableArray(e).map((function(e){var a=e.getAttribute("data-code");var i=e.getAttribute("data-part");p.Event.bind(e,"click",(function(e){Ri(t,bl,ml).call(t,a,i);e.preventDefault()}))}))}function Sl(){var e=new g.Guide({steps:[{target:document.getElementById("sign-editor-btn-edit"),title:p.Loc.getMessage("SIGN_JS_DOCUMENT_TOUR_BTN_EDIT_TITLE"),text:p.Loc.getMessage("SIGN_JS_DOCUMENT_TOUR_BTN_EDIT_TEXT")}],id:"sign-tour-guide-onboarding-master-document-edit-disabled",autoSave:true,simpleMode:true});e.startOnce()}function Tl(){var e=new BX.SpotLight({targetElement:document.getElementById(babelHelpers.classPrivateFieldGet(this,il)),targetVertex:"middle-center",autoSave:true,id:"sign-spotlight-onboarding-master-document-edit"});var t=new g.Guide({steps:[{target:document.getElementById("sign-editor-bar-content"),title:p.Loc.getMessage("SIGN_JS_DOCUMENT_TOUR_BTN_BLOCKS_TITLE"),text:p.Loc.getMessage("SIGN_JS_DOCUMENT_TOUR_BTN_BLOCKS_TEXT"),position:"left"},{target:document.getElementById(babelHelpers.classPrivateFieldGet(this,il)),title:p.Loc.getMessage("SIGN_JS_DOCUMENT_TOUR_BTN_HELP_TITLE"),text:p.Loc.getMessage("SIGN_JS_DOCUMENT_TOUR_BTN_HELP_TEXT"),rounded:true,article:babelHelpers.classPrivateFieldGet(this,ll),events:{onShow:function t(){return e.show()},onClose:function t(){return e.close()}}}],id:"sign-tour-guide-onboarding-master-document-edit",autoSave:true,simpleMode:true});t.startOnce()}babelHelpers.defineProperty(hl,"alreadyInit",false);babelHelpers.defineProperty(hl,"marginTop",0);babelHelpers.defineProperty(hl,"gapBetweenPages",20);var Fl=new WeakMap;var Cl=new WeakMap;var Gl=new WeakMap;var _l=new WeakMap;var Ol=new WeakSet;var Dl=new WeakSet;var Il=new WeakSet;var El=new WeakSet;var Ml=new WeakSet;var zl=function(){function e(t){var a=t.totalImages;babelHelpers.classCallCheck(this,e);Bi(this,Ml);Bi(this,El);Bi(this,Il);Bi(this,Dl);Bi(this,Ol);Ni(this,Fl,{writable:true,value:void 0});Ni(this,Cl,{writable:true,value:void 0});Ni(this,Gl,{writable:true,value:void 0});Ni(this,_l,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,Fl,a||null);babelHelpers.classPrivateFieldSet(this,Cl,null);babelHelpers.classPrivateFieldSet(this,Gl,{overlay:null,title:null,error:null,loader:null});babelHelpers.classPrivateFieldSet(this,_l,null)}babelHelpers.createClass(e,[{key:"updateLoadPage",value:function e(t){if(p.Type.isNumber(t)){Ri(this,Ol,Ll).call(this).update(t)}}},{key:"showError",value:function e(t){p.Dom.remove(Ri(this,El,Al).call(this));Ri(this,Dl,Bl).call(this).destroy();Ri(this,Ml,Rl).call(this).innerHTML=t||p.Loc.getMessage("SIGN_JS_DOCUMENT_LOAD_ERROR");var a=Ri(this,Ml,Rl).call(this).getElementsByTagName("span")[0];if(a){a.addEventListener("click",(function(){document.location.reload()}))}}},{key:"show",value:function e(){if(!babelHelpers.classPrivateFieldGet(this,Fl)){console.warn("BX.Sign.DocumentMasterLoader: totalImages is not defined");return}p.Dom.append(Ri(this,Il,Nl).call(this),document.body);if(babelHelpers.classPrivateFieldGet(this,Fl)>1){Ri(this,Ol,Ll).call(this).renderTo(Ri(this,El,Al).call(this))}else{Ri(this,Dl,Bl).call(this).show(Ri(this,El,Al).call(this))}}},{key:"close",value:function e(){var t=this;Ri(this,Il,Nl).call(this).addEventListener("animationend",(function(){p.Dom.remove(Ri(t,Il,Nl).call(t));Ri(t,Dl,Bl).call(t).destroy();babelHelpers.classPrivateFieldSet(t,Fl,null);babelHelpers.classPrivateFieldSet(t,Cl,null);babelHelpers.classPrivateFieldSet(t,Gl,{overlay:null,title:null,error:null,loader:null});babelHelpers.classPrivateFieldSet(t,_l,null)}));p.Dom.addClass(Ri(this,Il,Nl).call(this),"--hide")}}]);return e}();function Ll(){if(!babelHelpers.classPrivateFieldGet(this,Cl)){babelHelpers.classPrivateFieldSet(this,Cl,new i.ProgressRound({colorBar:"#1ec6fa",colorTrack:"#fff",statusType:i.ProgressRoundStatus?i.ProgressRoundStatus.INCIRCLECOUNTER:BX.UI.ProgressRound.Status.INCIRCLECOUNTER,maxValue:babelHelpers.classPrivateFieldGet(this,Fl)}))}return babelHelpers.classPrivateFieldGet(this,Cl)}function Bl(){if(!babelHelpers.classPrivateFieldGet(this,_l)){babelHelpers.classPrivateFieldSet(this,_l,new l.Loader({size:100,color:"#1ec6fa"}))}return babelHelpers.classPrivateFieldGet(this,_l)}function Nl(){if(!babelHelpers.classPrivateFieldGet(this,Gl).overlay){babelHelpers.classPrivateFieldGet(this,Gl).overlay=p.Tag.render(Mi||(Mi=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="sign-document__master-loader-overlay">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"])),Ri(this,Ml,Rl).call(this),Ri(this,El,Al).call(this))}return babelHelpers.classPrivateFieldGet(this,Gl).overlay}function Al(){if(!babelHelpers.classPrivateFieldGet(this,Gl).loader){babelHelpers.classPrivateFieldGet(this,Gl).loader=p.Tag.render(zi||(zi=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="sign-document__master-loader-container"></div>\n\t\t\t'])))}return babelHelpers.classPrivateFieldGet(this,Gl).loader}function Rl(){if(!babelHelpers.classPrivateFieldGet(this,Gl).title){babelHelpers.classPrivateFieldGet(this,Gl).title=p.Tag.render(Li||(Li=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="sign-document__master-loader-title">',"</div>\n\t\t\t"])),p.Loc.getMessage("SIGN_JS_DOCUMENT_LOADING_DOCUMENT_PAGES"))}return babelHelpers.classPrivateFieldGet(this,Gl).title}e.Document=hl;e.DocumentMasterLoader=zl})(this.BX.Sign=this.BX.Sign||{},BX.UI.Dialogs,BX.Main,BX.UI,BX,BX,BX.Sign,BX,BX.UI.Stamp,BX.Sign,BX.Crm.Form.Fields,BX.Crm.Requisite,BX.Sign,BX,BX.UI.DragAndDrop,BX.Event,BX.UI,BX.Sign.Tour);
//# sourceMappingURL=index.bundle.map.js