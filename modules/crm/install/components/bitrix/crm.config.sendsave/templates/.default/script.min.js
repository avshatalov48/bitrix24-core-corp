if(typeof BX.CrmSendSaveEditor==="undefined"){BX.CrmSendSaveEditor=function(){this._settings={};this._currentMailbox=null};BX.CrmSendSaveEditor.prototype={initialize:function(t){this._settings=t?t:{};var e=this.getForm();var i=BX.findChild(e,{tag:"select",attr:{name:"MAILBOX"}},true,false);if(i){BX.bind(i,"change",BX.delegate(this._handleMailboxChange,this))}var s=BX.findChild(e,{tag:"input",attr:{type:"checkbox",name:"SSL"}},true,false);if(s){BX.bind(s,"click",BX.delegate(this._handleSslClick,this))}var a=BX.findChild(e,{tag:"input",attr:{type:"checkbox",name:"CREATE_LEAD_FOR_NEW_ADDRESSER"}},true,false);if(a){this._adjustRowVisibility(BX.findChild(e,{tag:"input",attr:{type:"text",name:"LEAD_RESPONSIBLE_SEARCH"}},true,false),a.checked);BX.bind(a,"click",BX.delegate(this._handleCreateLeadClick,this))}this._layout()},getSetting:function(t,e){return typeof this._settings[t]!="undefined"?this._settings[t]:e},getForm:function(){return document.getElementById(this.getSetting("FORM_ID"))},_layout:function(){var t=BX.findChild(this.getForm(),{tag:"input",attr:{name:"MAILBOX_ID"}},true,false);if(!t){return}var e=t.value;if(e==="-1"){this._currentMailbox=BX.CrmSendSaveMailbox.create({},this);this._currentMailbox.layout()}else if(e==="0"){this._currentMailbox=BX.CrmSendSaveMailbox.create({SERVER_TYPE:"pop3"},this);this._currentMailbox.layout()}else{var i=this.getSetting("MAILBOXES");if(i){for(var s=0;s<i.length;s++){var a=i[s];if(a["ID"]===e){this._currentMailbox=BX.CrmSendSaveMailbox.create(a,this);this._currentMailbox.layout();break}}}}},_handleMailboxChange:function(){var t=BX.findChild(this.getForm(),{tag:"select",attr:{name:"MAILBOX"}},true,false);if(!t){return}var e=BX.findChild(this.getForm(),{tag:"input",attr:{name:"MAILBOX_ID"}},true,false);if(!e){return}e.value=t.selectedIndex>=0?t.options[t.selectedIndex].value:"-1";this._layout()},_handleSslClick:function(){var t=this.getForm();var e=BX.findChild(t,{tag:"input",attr:{type:"checkbox",name:"SSL"}},true,false);if(!e){return}var i=BX.findChild(t,{tag:"input",attr:{type:"text",name:"PORT"}},true,false);if(i){i.value=e.checked?"995":"110"}},_handleCreateLeadClick:function(){var t=this.getForm();var e=BX.findChild(t,{tag:"input",attr:{type:"checkbox",name:"CREATE_LEAD_FOR_NEW_ADDRESSER"}},true,false);if(e){this._adjustRowVisibility(BX.findChild(t,{tag:"input",attr:{type:"text",name:"LEAD_RESPONSIBLE_SEARCH"}},true,false),e.checked)}},_adjustRowVisibility:function(t,e){var i=BX.findParent(t,{tag:"tr"},true,false);if(i){i.style.display=!!e?"":"none"}}};BX.CrmSendSaveEditor._default=null;BX.CrmSendSaveEditor.createDefault=function(t){var e=new BX.CrmSendSaveEditor;e.initialize(t);return this._default=e};BX.CrmSendSaveEditor.getDefault=function(){if(!this._default){this.createDefault(null)}return this._default};BX.CrmSendSaveMailbox=function(){this._settings={};this._editor=null};BX.CrmSendSaveMailbox.prototype={initialize:function(t,e){this._settings=t?t:{};this._editor=e},getSetting:function(t,e){return typeof this._settings[t]!="undefined"?this._settings[t]:e},_display:function(t,e){var i=BX.findParent(t,{tag:"tr"});if(i){i.style.display=e?"":"none"}},_displayHeaders:function(t,e){var i=BX.findChildren(this._editor.getForm(),{tag:"td","class":"bx-heading"},true);if(i&&i.length>=e+1){for(var s=e;s<i.length;s++){i[s].style.display=t?"":"none"}}},_findText:function(t){return BX.findChild(this._editor.getForm(),{tag:"input",attr:{type:"text",name:t}},true,false)},_findCheckbox:function(t){return BX.findChild(this._editor.getForm(),{tag:"input",attr:{type:"checkbox",name:t}},true,false)},_findPassword:function(t){return BX.findChild(this._editor.getForm(),{tag:"input",attr:{type:"password",name:t}},true,false)},_findSelect:function(t){return BX.findChild(this._editor.getForm(),{tag:"select",attr:{name:t}},true,false)},_setupText:function(t,e,i){var s=this._findText(t);if(s){s.value=e;this._display(s,i)}},_setupCheckbox:function(t,e,i){var s=this._findCheckbox(t);if(s){if(e!==true&&e!==false){e=e.toString().toUpperCase()==="Y"}s.checked=e;this._display(s,i)}},_setupPassword:function(t,e,i){var s=this._findPassword(t);if(s){s.value=e;this._display(s,i)}},_setupSelect:function(t,e,i){var s=this._findSelect(t);if(s){this._display(s,i);while(s.options.length>0){s.options.remove(0)}for(var a=0;a<e.length;a++){var n=e[a];var r,u;if(typeof n==="object"){if(typeof n["VALUE"]=="undefined"){continue}r=typeof n["TEXT"]!="undefined"?n["TEXT"]:n["VALUE"];u=n["VALUE"]}else{if(!BX.type.isString(n)){n=n.toString()}r=u=n}var h=document.createElement("OPTION");h.text=r;h.value=u;s.options.add(h)}}},layout:function(){var t=this.getSetting("SERVER_TYPE","");if(t==="pop3"){this._setupCheckbox("ACTIVE",this.getSetting("ACTIVE",true),true);this._setupText("POP3_EMAIL",this.getSetting("POP3_EMAIL",""),true);this._setupText("SERVER",this.getSetting("SERVER",""),true);this._setupText("PORT",this.getSetting("PORT","995"),true);this._setupCheckbox("SSL",this.getSetting("SSL",true),true);this._setupCheckbox("SKIP_CERT",this.getSetting("SKIP_CERT",false),true);this._setupText("LOGIN",this.getSetting("LOGIN",""),true);this._setupPassword("PASSWORD",this.getSetting("PASSWORD",""),true);this._setupCheckbox("DELETE",this.getSetting("DELETE",false),true);this._setupText("PERIOD_CHECK",this.getSetting("PERIOD_CHECK","5"),true);this._setupText("SMTP_EMAIL","",false);this._setupSelect("SMTP_DOMAIN",[],false);this._displayHeaders(true,1);this._setupText("REGEXP_LEAD",this.getSetting("REGEXP_LEAD","\\[LID#([0-9]+)\\]"),true);this._setupText("REGEXP_CONTACT",this.getSetting("REGEXP_CONTACT","\\[CID#([0-9]+)\\]"),true);this._setupText("REGEXP_COMPANY",this.getSetting("REGEXP_COMPANY","\\[COID#([0-9]+)\\]"),true);this._setupText("REGEXP_DEAL",this.getSetting("REGEXP_DEAL","\\[DID#([0-9]+)\\]"),true)}else if(t==="smtp"){this._setupCheckbox("ACTIVE",true,false);this._setupText("POP3_EMAIL","",false);this._setupText("SERVER","",false);this._setupText("PORT","",false);this._setupCheckbox("SSL",true,false);this._setupText("LOGIN","",false);this._setupPassword("PASSWORD","",false);this._setupCheckbox("DELETE",false,false);this._setupText("PERIOD_CHECK","",false);this._setupText("SMTP_EMAIL",this.getSetting("SMTP_EMAIL",""),true);this._setupSelect("SMTP_DOMAIN",this.getSetting("SMTP_DOMAIN",[]),true);this._displayHeaders(true,1);this._setupText("REGEXP_LEAD",this.getSetting("REGEXP_LEAD","\\[LID#([0-9]+)\\]"),true);this._setupText("REGEXP_CONTACT",this.getSetting("REGEXP_CONTACT","\\[CID#([0-9]+)\\]"),true);this._setupText("REGEXP_COMPANY",this.getSetting("REGEXP_CONTACT","\\[COID#([0-9]+)\\]"),true);this._setupText("REGEXP_DEAL",this.getSetting("REGEXP_CONTACT","\\[DID#([0-9]+)\\]"),true)}else{this._setupCheckbox("ACTIVE",true,false);this._setupText("POP3_EMAIL","",false);this._setupText("SERVER","",false);this._setupText("PORT","",false);this._setupCheckbox("SSL",true,false);this._setupText("LOGIN","",false);this._setupPassword("PASSWORD","",false);this._setupCheckbox("DELETE",false,false);this._setupText("PERIOD_CHECK","",false);this._setupText("SMTP_EMAIL","",false);this._setupSelect("SMTP_DOMAIN",[],false);this._setupText("REGEXP_LEAD","",false);this._setupText("REGEXP_CONTACT","",false);this._setupText("REGEXP_COMPANY","",false);this._setupText("REGEXP_DEAL","",false);this._displayHeaders(false,1)}}};BX.CrmSendSaveMailbox.create=function(t,e){var i=new BX.CrmSendSaveMailbox;i.initialize(t,e);return i}}
//# sourceMappingURL=script.map.js