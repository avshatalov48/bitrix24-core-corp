(function(e,t,r,n){"use strict";function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){babelHelpers.defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s=t.Reflection.namespace("BX.Crm");var a=function(){function e(r){babelHelpers.classCallCheck(this,e);if(t.Type.isPlainObject(r)){if(t.Type.isString(r.gridId)){this.gridId=r.gridId}if(this.gridId&&BX.Main.grid&&BX.Main.gridManager){this.grid=BX.Main.gridManager.getInstanceById(this.gridId)}if(t.Type.isElementNode(r.errorTextContainer)){this.errorTextContainer=r.errorTextContainer}if(t.Type.isElementNode(r.welcomeMessageContainer)){this.welcomeMessageContainer=r.welcomeMessageContainer}this.isEmptyList=Boolean(r.isEmptyList)}}babelHelpers.createClass(e,[{key:"init",value:function e(){this.bindEvents()}},{key:"bindEvents",value:function e(){var n=this;r.EventEmitter.subscribe("BX.Crm.TypeListComponent:onClickDelete",this.handleTypeDelete.bind(this));r.EventEmitter.subscribe("BX.Crm.TypeListComponent:onFilterByCustomSection",this.handleFilterByCustomSection.bind(this));r.EventEmitter.subscribe("BX.Crm.TypeListComponent:onResetFilterByCustomSection",this.handleFilterByCustomSection.bind(this));var i=this.getToolbarComponent();if(i){i.subscribeTypeUpdatedEvent((function(e){var r=t.Type.isObject(e.getData())&&e.getData().isUrlChanged===true;if(r){window.location.reload();return}if(n.gridId&&t.Reflection.getClass("BX.Main.gridManager.reload")){t.Dom.removeClass(document.getElementById("crm-type-list-container"),"crm-type-list-grid-empty");BX.Main.gridManager.reload(n.gridId)}}))}}},{key:"showErrors",value:function e(r){var n="";r.forEach((function(e){n="".concat(n+e," ")}));if(t.Type.isElementNode(this.errorTextContainer)){this.errorTextContainer.innerText=n;t.Dom.style(this.errorTextContainer.parentElement,{display:"block"})}else{console.error(n)}}},{key:"hideErrors",value:function e(){if(t.Type.isElementNode(this.errorTextContainer)){this.errorTextContainer.innerText="";t.Dom.style(this.errorTextContainer.parentElement,{display:"none"})}}},{key:"showErrorsFromResponse",value:function e(t){var r=t.errors;var n=[];r.forEach((function(e){var t=e.message;return n.push(t)}));this.showErrors(n)}},{key:"handleTypeDelete",value:function e(r){var i=this;var o=t.Text.toInteger(r.data.id);if(!o){this.showErrors([t.Loc.getMessage("CRM_TYPE_TYPE_NOT_FOUND")]);return}n.MessageBox.show({title:t.Loc.getMessage("CRM_TYPE_TYPE_DELETE_CONFIRMATION_TITLE"),message:t.Loc.getMessage("CRM_TYPE_TYPE_DELETE_CONFIRMATION_MESSAGE"),modal:true,buttons:n.MessageBoxButtons.YES_CANCEL,onYes:function e(r){t.ajax.runAction("crm.controller.type.delete",{analyticsLabel:"crmTypeListDeleteType",data:{id:o}}).then((function(e){var r=t.Type.isObject(e.data)&&e.data.isUrlChanged===true;if(r){window.location.reload();return}i.grid.reloadTable()}))["catch"](i.showErrorsFromResponse.bind(i));r.close()}})}},{key:"getToolbarComponent",value:function e(){if(t.Reflection.getClass("BX.Crm.ToolbarComponent")){return BX.Crm.ToolbarComponent.Instance}return null}},{key:"handleFilterByCustomSection",value:function e(t){var r,n,i,s;var a=((r=BX.Main.filterManager)===null||r===void 0?void 0:(n=r.getList()[0])===null||n===void 0?void 0:n.getFilterFieldsValues())||[];var l=o(o({},a),{},{CUSTOM_SECTION:t.data||null});var c=(i=BX.Main.filterManager)===null||i===void 0?void 0:(s=i.getList()[0])===null||s===void 0?void 0:s.getApi();if(!c){return}c.setFields(l);c.apply()}}]);return e}();s.TypeListComponent=a})(this.window=this.window||{},BX,BX.Event,BX.UI.Dialogs);
//# sourceMappingURL=script.map.js