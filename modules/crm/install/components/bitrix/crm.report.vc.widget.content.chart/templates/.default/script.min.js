(function(){var t=BX.namespace("BX.Crm.Analytics.Report.ViewChart");{function e(t,e){var o=n(t,e);return o.length>0?o[0]:null}function n(t,e){if(!BX.type.isDomNode(e)){return[]}return BX.convert.nodeListToArray(e.querySelectorAll('[data-role="'+t+'"]'))}}function o(e){t.Manager.Instance=this;this.init(e)}o.Instance=null;o.prototype.init=function(n){this.context=BX(n.containerId);this.data=n.data;t.Helper.context=this.context;t.Stage.clear();t.Layer.clear();t.Column.clear();t.Popup.clear();t.Tooltip.clear();var o=e("graph",this.context);t.Popup.instance({content:e("popup",this.context)});BX.bind(o,"mouseleave",function(){t.Popup.instance().hide();t.Layer.showTopTooltips()});this.initStructure();BX.bind(window,"resize",this.draw.bind(this));BX.UI.Hint.initByClassName()};o.prototype.getLayers=function(){return t.Layer.getList()};o.prototype.getColumns=function(){return t.Column.getList()};o.prototype.draw=function(){this.getColumns().forEach(function(t){t.draw()},this);this.getLayers().forEach(function(t){t.draw()},this);t.Layer.showTopTooltips()};o.prototype.initStructure=function(){this.data.dict.stages.forEach(function(t){this.data.dict.sources.forEach(function(e){this.initItem(this.data.items[t][e])},this)},this);this.getLayers().forEach(this.initPolygons,this);this.draw()};o.prototype.initItem=function(n){var o=t.Stage.create({data:this.data.stages[n.stage]});var a=t.Source.create({data:this.data.sources[n.source]});var i=new t.Item({data:n,source:a,stage:o,node:e("items/"+n.source+"/"+n.stage,this.context)});t.Layer.create({source:a}).appendItem(i);t.Column.create({stage:o}).appendItem(i)};o.prototype.initPolygons=function(n){for(var o=0;o<n.items.length;o++){var a=n.items[o];var i=n.items[o+1];if(!a||!i){return}var r=new t.Polygon({node:e("polygons/"+a.data.source+"/"+a.data.stage,this.context),source:a.source,stage:a.stage,leftItem:a,rightItem:i});n.appendPolygon(r)}};t.Manager=o})();
//# sourceMappingURL=script.map.js