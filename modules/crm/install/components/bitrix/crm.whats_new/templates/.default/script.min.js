(function(e,t,r,n,i,a,s){"use strict";var l,o;function u(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */u=function t(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function e(t,r,n){return t[r]=n}}function c(e,t,r,i){var a=t&&t.prototype instanceof f?t:f,s=Object.create(a.prototype),l=new G(i||[]);return n(s,"_invoke",{value:H(e,r,l)}),s}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function f(){}function d(){}function v(){}var b={};o(b,a,(function(){return this}));var w=Object.getPrototypeOf,g=w&&w(w(x([])));g&&g!==t&&r.call(g,a)&&(b=g);var y=v.prototype=f.prototype=Object.create(b);function m(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function i(n,a,s,l){var o=h(e[n],e,a);if("throw"!==o.type){var u=o.arg,c=u.value;return c&&"object"==babelHelpers["typeof"](c)&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){i("next",e,s,l)}),(function(e){i("throw",e,s,l)})):t.resolve(c).then((function(e){u.value=e,s(u)}),(function(e){return i("throw",e,s,l)}))}l(o.arg)}var a;n(this,"_invoke",{value:function e(r,n){function s(){return new t((function(e,t){i(r,n,e,t)}))}return a=a?a.then(s,s):s()}})}function H(e,t,r){var n="suspendedStart";return function(i,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw a;return E()}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var l=F(s,r);if(l){if(l===p)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var o=h(e,t,r);if("normal"===o.type){if(n=r.done?"completed":"suspendedYield",o.arg===p)continue;return{value:o.arg,done:r.done}}"throw"===o.type&&(n="completed",r.method="throw",r.arg=o.arg)}}}function F(e,t){var r=t.method,n=e.iterator[r];if(undefined===n)return t.delegate=null,"throw"===r&&e.iterator["return"]&&(t.method="return",t.arg=undefined,F(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=h(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,p;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,p):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function G(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function x(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=undefined,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:undefined,done:!0}}return d.prototype=v,n(y,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:d,configurable:!0}),d.displayName=o(v,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,o(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},m(P.prototype),o(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,i,a){void 0===a&&(a=Promise);var s=new P(c(t,r,n,i),a);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},m(y),o(y,l,"Generator"),o(y,a,(function(){return this})),o(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=x,G.prototype={constructor:G,reset:function e(t){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=undefined)},stop:function e(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function e(t){if(this.done)throw t;var n=this;function i(e,r){return l.type="throw",l.arg=t,n.next=e,r&&(n.method="next",n.arg=undefined),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],l=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(o&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function e(t,n){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var s=a;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=n&&n<=s.finallyLoc&&(s=null);var l=s?s.completion:{};return l.type=t,l.arg=n,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(l)},complete:function e(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),p}},catch:function e(t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var a=i.arg;k(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function e(t,r,n){return this.delegate={iterator:x(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=undefined),p}},e}function c(e,t){p(e,t);t.add(e)}function h(e,t,r){p(e,t);t.set(e,r)}function p(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function f(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var d=r.Reflection.namespace("BX.Crm.WhatsNew");var v=new WeakMap;var b=new WeakMap;var w=new WeakMap;var g=new WeakMap;var y=new WeakMap;var m=new WeakMap;var P=new WeakMap;var H=new WeakMap;var F=new WeakSet;var S=new WeakSet;var k=new WeakSet;var G=new WeakSet;var x=new WeakSet;var E=new WeakSet;var L=new WeakSet;var N=new WeakSet;var O=new WeakSet;var C=new WeakSet;var T=new WeakSet;var W=new WeakSet;var I=new WeakSet;var j=new WeakSet;var B=new WeakSet;var D=function(){function e(t){var n=t.slides,i=t.steps,a=t.options,s=t.closeOptionCategory,l=t.closeOptionName;babelHelpers.classCallCheck(this,e);c(this,B);c(this,j);c(this,I);c(this,W);c(this,T);c(this,C);c(this,O);c(this,N);c(this,L);c(this,E);c(this,x);c(this,G);c(this,k);c(this,S);c(this,F);h(this,v,{writable:true,value:void 0});h(this,b,{writable:true,value:void 0});h(this,w,{writable:true,value:void 0});h(this,g,{writable:true,value:void 0});h(this,y,{writable:true,value:null});h(this,m,{writable:true,value:void 0});h(this,P,{writable:true,value:void 0});h(this,H,{writable:true,value:false});babelHelpers.classPrivateFieldSet(this,v,[]);babelHelpers.classPrivateFieldSet(this,b,[]);babelHelpers.classPrivateFieldSet(this,w,a);babelHelpers.classPrivateFieldSet(this,g,null);this.slideClassName="crm-whats-new-slides-wrapper";babelHelpers.classPrivateFieldSet(this,P,r.Type.isString(s)?s:"");babelHelpers.classPrivateFieldSet(this,m,r.Type.isString(l)?l:"");this.onClickClose=this.onClickCloseHandler.bind(this);this.whatNewPromise=null;this.tourPromise=null;f(this,F,M).call(this,n);f(this,x,R).call(this,i)}babelHelpers.createClass(e,[{key:"show",value:function e(){if(babelHelpers.classPrivateFieldGet(this,w).isNumberOfViewsExceeded){console.warn("Number of views exceeded");return}if(babelHelpers.classPrivateFieldGet(this,v).length>0){f(this,I,Z).call(this)}else if(babelHelpers.classPrivateFieldGet(this,b).length>0){f(this,j,$).call(this)}}},{key:"onClickCloseHandler",value:function e(){var t=babelHelpers.classPrivateFieldGet(this,g).getLastPosition();var r=babelHelpers.classPrivateFieldGet(this,g).getPositionBySlide(babelHelpers.classPrivateFieldGet(this,g).getCurrentSlide());if(r>=t){babelHelpers.classPrivateFieldGet(this,g).destroy()}else{babelHelpers.classPrivateFieldGet(this,g).selectNextSlide()}}},{key:"createGuideInstance",value:function e(t,r,n){var i=this;return new t({onEvents:n,steps:r,events:{onFinish:function e(){if(babelHelpers.classPrivateFieldGet(i,v).length===0){i.save()}}}})}},{key:"setStepPopupOptions",value:function e(t){var r;var n=babelHelpers.classPrivateFieldGet(this,w),i=n.steps,a=n.hideTourOnMissClick,s=a===void 0?false:a;t.setAutoHide(s);if(i!==null&&i!==void 0&&(r=i.popup)!==null&&r!==void 0&&r.width){t.setWidth(i.popup.width)}}},{key:"save",value:function e(){var t,n,i=this;r.ajax.runAction("crm.settings.tour.updateOption",{json:{category:babelHelpers.classPrivateFieldGet(this,P),name:babelHelpers.classPrivateFieldGet(this,m),options:{isMultipleViewsAllowed:!babelHelpers.classPrivateFieldGet(this,H)&&f(this,T,J).call(this),numberOfViewsLimit:(t=babelHelpers.classPrivateFieldGet(this,w).numberOfViewsLimit)!==null&&t!==void 0?t:1,additionalTourIdsForDisable:(n=babelHelpers.classPrivateFieldGet(this,w).additionalTourIdsForDisable)!==null&&n!==void 0?n:null}}}).then((function(e){var t=e.data;babelHelpers.classPrivateFieldGet(i,w).isNumberOfViewsExceeded=t.isNumberOfViewsExceeded;babelHelpers.classPrivateFieldSet(i,H,true)}))["catch"]((function(e){console.error("Could not save tour settings",e)}))}}]);return e}();function M(e){var t=this;if(e.length>0){this.whatNewPromise=r.Runtime.loadExtension("ui.dialogs.whats-new")}babelHelpers.classPrivateFieldSet(this,v,e.map((function(e){return{className:t.slideClassName,title:e.title,html:f(t,S,_).call(t,e)}})))}function _(e){var t=r.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-whats-new-slide">\n\t\t\t\t<img src="','" alt="">\n\t\t\t\t<div class="crm-whats-new-slide-inner-title"> '," </div>\n\t\t\t\t<p>","</p>\n\t\t\t</div>\n\t\t"])),e.innerImage,e.innerTitle,e.innerDescription);var n=f(this,G,V).call(this,e);if(n.length>0){var i=r.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['<div class="crm-whats-new-slide-buttons"></div>'])));r.Dom.append(i,t);n.forEach((function(e){r.Dom.append(e.getContainer(),i)}))}return t}function A(){return X.apply(this,arguments)}function X(){X=babelHelpers.asyncToGenerator(u().mark((function e(){var t,n;return u().wrap((function e(i){while(1)switch(i.prev=i.next){case 0:if(!babelHelpers.classPrivateFieldGet(this,y)){i.next=2;break}return i.abrupt("return",babelHelpers.classPrivateFieldGet(this,y));case 2:i.next=4;return r.Runtime.loadExtension("crm.integration.ui.banner-dispatcher");case 4:t=i.sent;n=t.BannerDispatcher;babelHelpers.classPrivateFieldSet(this,y,new n);return i.abrupt("return",babelHelpers.classPrivateFieldGet(this,y));case 8:case"end":return i.stop()}}),e,this)})));return X.apply(this,arguments)}function V(e){var t=this;var r=[];if(e.buttons){var n="ui-btn ui-btn-primary ui-btn-hover ui-btn-round ";r=e.buttons.map((function(e){var r;var i={className:n+((r=e.className)!==null&&r!==void 0?r:""),text:e.text};if(e.onClickClose){i.onclick=function(){return t.onClickClose()}}else if(e.helpDeskCode){i.onclick=function(){return f(t,W,K).call(t,e.helpDeskCode)}}return new a.Button(i)}))}return r}function R(e){var t=this;babelHelpers.classPrivateFieldSet(this,b,e.map((function(e){var i;var a={id:e.id,title:e.title,text:e.text,position:e.position,article:e.article,articleAnchor:(i=e.articleAnchor)!==null&&i!==void 0?i:null,infoHelperCode:e.infoHelperCode};if(e.useDynamicTarget){var s;var l=(s=e.eventName)!==null&&s!==void 0?s:f(t,C,z).call(t,a.id);n.EventEmitter.subscribeOnce(l,f(t,E,U).bind(t))}else{var o=document.querySelector(e.target);if(o&&r.Dom.style(o,"display")!=="none"){a.target=e.target}else if(r.Type.isArrayFilled(e.reserveTargets)){var u=e.reserveTargets.some((function(e){if(document.querySelector(e)){a.target=e;return true}return false}));if(!u&&e.ignoreIfTargetNotFound){return null}}else if(e.ignoreIfTargetNotFound){return null}else{a.target=e.target}}return a})));babelHelpers.classPrivateFieldSet(this,b,babelHelpers.classPrivateFieldGet(this,b).filter((function(e){return e!==null})));if(babelHelpers.classPrivateFieldGet(this,b).length>0){this.tourPromise=r.Runtime.loadExtension("ui.tour")}}function U(e){var t=this;var r=babelHelpers.classPrivateFieldGet(this,w),n=r.disableBannerDispatcher,i=n===void 0?false:n;void this.tourPromise.then((function(r){var n=e.data,a=n.stepId,s=n.target;var l=babelHelpers.classPrivateFieldGet(t,b).find((function(e){return e.id===a}));if(!l){console.error("step not found");return}l.target=s;var o=r.Guide;var u=t.createGuideInstance(o,[l],true);t.setStepPopupOptions(u.getPopup());if(i===false){f(t,L,q).call(t,u)}else{f(t,O,Y).call(t,u)}}))}function q(e){var t=this;void f(this,k,A).call(this).then((function(r){r.toQueue((function(r){f(t,O,Y).call(t,e,r)}))}))}function Q(e){var t=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;e.subscribe("UI.Tour.Guide:onFinish",(function(){t.save();if(r){r()}}))}function Y(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;f(this,N,Q).call(this,e,t);e.showNextStep()}function z(e){return"Crm.WhatsNew::onTargetSetted::".concat(e)}function J(){return babelHelpers.classPrivateFieldGet(this,w).numberOfViewsLimit>1}function K(e){if(top.BX.Helper){top.BX.Helper.show("redirect=detail&code=".concat(e));event.preventDefault()}}function Z(){var e=this;var t=babelHelpers.classPrivateFieldGet(this,w),r=t.disableBannerDispatcher,n=r===void 0?false:r;if(i.PopupManager&&i.PopupManager.isAnyPopupShown()){return}void this.whatNewPromise.then((function(t){var r=t.WhatsNew;babelHelpers.classPrivateFieldSet(e,g,new r({slides:babelHelpers.classPrivateFieldGet(e,v),popupOptions:{height:440},events:{onDestroy:function t(){e.save();f(e,j,$).call(e,false)}}}));if(n===false){void f(e,k,A).call(e).then((function(t){t.toQueue((function(t){babelHelpers.classPrivateFieldGet(e,g).subscribe("onDestroy",t);babelHelpers.classPrivateFieldGet(e,g).show()}))}))}else{babelHelpers.classPrivateFieldGet(e,g).show()}D.whatsNewInstances.push(babelHelpers.classPrivateFieldGet(e,g))}),this)}function $(){var e=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var n=babelHelpers.classPrivateFieldGet(this,w),a=n.disableBannerDispatcher,s=a===void 0?false:a;var l=r.clone(babelHelpers.classPrivateFieldGet(this,b));l=l.filter((function(e){return Boolean(e.target)}));if(l.length===0){return}void this.tourPromise.then((function(r){if(D.tourInstances.some((function(e){var t;return(t=e.getPopup())===null||t===void 0?void 0:t.isShown()}))){return}if(i.PopupManager&&i.PopupManager.isAnyPopupShown()){return}var n=r.Guide;var a=e.createGuideInstance(n,l,babelHelpers.classPrivateFieldGet(e,b).length<=1);D.tourInstances.push(a);e.setStepPopupOptions(a.getPopup());if(t){if(s===false){f(e,L,q).call(e,a)}else{f(e,O,Y).call(e,a)}return}f(e,B,ee).call(e,a)}))}function ee(e){if(e.steps.length>1||babelHelpers.classPrivateFieldGet(this,w).showOverlayFromFirstStep){e.start()}else{e.showNextStep()}}babelHelpers.defineProperty(D,"tourInstances",[]);babelHelpers.defineProperty(D,"whatsNewInstances",[]);d.ActionViewMode=D})(this.window=this.window||{},BX.Crm.Integration.UI,BX,BX.Event,BX.Main,BX.UI,BX.UI.Tour);
//# sourceMappingURL=script.map.js