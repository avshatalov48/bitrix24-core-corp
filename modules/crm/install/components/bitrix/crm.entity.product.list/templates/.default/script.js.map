{"version":3,"file":"script.js","sources":["src/js/hint.popup.js","src/js/product.list.row.js","src/js/page.events.manager.js","src/js/settings.button.js","src/js/product.list.editor.js"],"sourcesContent":["import {Popup} from 'main.popup';\nimport {Tag, Text} from 'main.core';\nimport {Editor} from './product.list.editor';\n\nexport default class HintPopup\n{\n\teditor: Editor;\n\thintPopup: ?Popup;\n\n\tconstructor(editor: Editor)\n\t{\n\t\tthis.editor = editor;\n\t}\n\n\tload(node: HTMLElement, text: String): Popup\n\t{\n\t\tif (!this.hintPopup)\n\t\t{\n\t\t\tthis.hintPopup = new Popup(\n\t\t\t\t'ui-hint-popup-' + this.editor.getId(),\n\t\t\t\tnull,\n\t\t\t\t{\n\t\t\t\t\tdarkMode: true,\n\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\tanimation: 'fading-slide'\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis.hintPopup.setBindElement(node);\n\t\tthis.hintPopup.adjustPosition();\n\t\tthis.hintPopup.setContent(Tag.render`\n\t\t\t<div class='ui-hint-content'>${Text.encode(text)}</div>\n\t\t`);\n\n\t\treturn this.hintPopup;\n\t}\n\n\tshow()\n\t{\n\t\tif (this.hintPopup)\n\t\t{\n\t\t\tthis.hintPopup.show();\n\t\t}\n\t}\n\n\tclose()\n\t{\n\t\tif (this.hintPopup)\n\t\t{\n\t\t\tthis.hintPopup.close();\n\t\t}\n\t}\n}","import {Cache, Dom, Event, Loc, Reflection, Runtime, Text, Type} from 'main.core';\nimport {Editor} from './product.list.editor';\nimport {DiscountType, DiscountTypes, FieldScheme, ProductCalculator} from 'catalog.product-calculator';\nimport {CurrencyCore} from 'currency.currency-core';\nimport 'ui.hint';\nimport HintPopup from './hint.popup';\n\ntype Action = {\n\ttype: string,\n\tfield?: string,\n\tvalue?: string,\n};\n\ntype Settings = {}\n\nconst MODE_EDIT = 'EDIT';\nconst MODE_SET = 'SET';\n\nexport class Row\n{\n\tid: ?string;\n\tsettings: Object;\n\teditor: ?Editor\n\tfields: Object = {};\n\texternalActions: Array<Action> = [];\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(id: string, fields: Object, settings: Settings, editor: Editor): void\n\t{\n\t\tthis.setId(id);\n\t\tthis.setFields(fields);\n\t\tthis.setSettings(settings);\n\t\tthis.setEditor(editor);\n\n\t\trequestAnimationFrame(this.initHandlers.bind(this));\n\t}\n\n\tgetNode(): ?HTMLElement\n\t{\n\t\treturn this.cache.remember('node', () => {\n\t\t\tconst rowId = this.getField('ID', 0);\n\n\t\t\treturn this.getEditorContainer().querySelector('[data-id=\"' + rowId + '\"]');\n\t\t});\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id: string): void\n\t{\n\t\tthis.id = id;\n\t}\n\n\tgetSettings()\n\t{\n\t\treturn this.settings;\n\t}\n\n\tsetSettings(settings: Settings): void\n\t{\n\t\tthis.settings = Type.isPlainObject(settings) ? settings : {};\n\t}\n\n\tgetSettingValue(name, defaultValue)\n\t{\n\t\treturn this.settings.hasOwnProperty(name) ? this.settings[name] : defaultValue;\n\t}\n\n\tsetSettingValue(name, value): void\n\t{\n\t\tthis.settings[name] = value;\n\t}\n\n\tsetEditor(editor: Editor): void\n\t{\n\t\tthis.editor = editor;\n\t}\n\n\tgetEditor(): Editor\n\t{\n\t\treturn this.editor;\n\t}\n\n\tgetEditorContainer(): HTMLElement\n\t{\n\t\treturn this.getEditor().getContainer();\n\t}\n\n\tgetHintPopup(): HintPopup\n\t{\n\t\treturn this.getEditor().getHintPopup();\n\t}\n\n\tinitHandlers()\n\t{\n\t\tconst editor = this.getEditor();\n\n\t\tthis.getNode().querySelectorAll('input').forEach((node) => {\n\t\t\tEvent.bind(node, 'input', editor.changeProductFieldHandler);\n\t\t\tEvent.bind(node, 'change', editor.changeProductFieldHandler);\n\t\t\t// disable drag-n-drop events for text fields\n\t\t\tEvent.bind(node, 'mousedown', (event) => event.stopPropagation());\n\t\t});\n\t\tthis.getNode().querySelectorAll('select').forEach((node) => {\n\t\t\tEvent.bind(node, 'change', editor.changeProductFieldHandler);\n\t\t\t// disable drag-n-drop events for select fields\n\t\t\tEvent.bind(node, 'mousedown', (event) => event.stopPropagation());\n\t\t});\n\t}\n\n\tinitHandlersForProductSelector()\n\t{\n\t\tconst editor = this.getEditor();\n\n\t\tthis.getNode().querySelectorAll('[data-name=\"MAIN_INFO\"] input[type=\"text\"]').forEach(node => {\n\t\t\tEvent.bind(node, 'input', editor.changeProductFieldHandler);\n\t\t\tEvent.bind(node, 'change', editor.changeProductFieldHandler);\n\t\t\t// disable drag-n-drop events for select fields\n\t\t\tEvent.bind(node, 'mousedown', (event) => event.stopPropagation());\n\t\t});\n\t}\n\n\tsetRowNumber(number)\n\t{\n\t\tthis.getNode().querySelectorAll('.main-grid-row-number').forEach(node => {\n\t\t\tnode.textContent = number + '.';\n\t\t});\n\t}\n\n\tgetFields(fields: Array = [])\n\t{\n\t\tlet result;\n\n\t\tif (!Type.isArrayFilled(fields))\n\t\t{\n\t\t\tresult = Runtime.clone(this.fields);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = {};\n\n\t\t\tfor (let fieldName of fields)\n\t\t\t{\n\t\t\t\tresult[fieldName] = this.getField(fieldName);\n\t\t\t}\n\t\t}\n\n\t\tif ('PRODUCT_NAME' in result)\n\t\t{\n\t\t\tlet fixedProductName = this.getField('FIXED_PRODUCT_NAME', '');\n\n\t\t\tif (Type.isStringFilled(fixedProductName))\n\t\t\t{\n\t\t\t\tresult['PRODUCT_NAME'] = fixedProductName;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetCatalogFields(): Object\n\t{\n\t\tconst fields = this.getFields(['CURRENCY', 'QUANTITY', 'MEASURE_CODE']);\n\n\t\tfields['PRICE'] = this.getBasePrice();\n\t\tfields['VAT_INCLUDED'] = this.getTaxIncluded();\n\t\tfields['VAT_ID'] = this.getTaxId();\n\n\t\treturn fields;\n\t}\n\n\tgetCalculateFields(): FieldScheme\n\t{\n\t\treturn {\n\t\t\t'PRICE': this.getPrice(),\n\t\t\t'PRICE_EXCLUSIVE': this.getPriceExclusive(),\n\t\t\t'PRICE_NETTO': this.getPriceNetto(),\n\t\t\t'PRICE_BRUTTO': this.getPriceBrutto(),\n\t\t\t'QUANTITY': this.getQuantity(),\n\t\t\t'DISCOUNT_TYPE_ID': this.getDiscountType(),\n\t\t\t'DISCOUNT_RATE': this.getDiscountRate(),\n\t\t\t'DISCOUNT_SUM': this.getDiscountSum(),\n\t\t\t'DISCOUNT_ROW': this.getDiscountRow(),\n\t\t\t'TAX_INCLUDED': this.getTaxIncluded(),\n\t\t\t'TAX_RATE': this.getTaxRate()\n\t\t};\n\t}\n\n\tsetFields(fields: Object): void\n\t{\n\t\tfor (let name in fields)\n\t\t{\n\t\t\tif (fields.hasOwnProperty(name))\n\t\t\t{\n\t\t\t\tthis.setField(name, fields[name]);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetField(name: string, defaultValue)\n\t{\n\t\treturn this.fields.hasOwnProperty(name) ? this.fields[name] : defaultValue;\n\t}\n\n\tsetField(name: string, value): void\n\t{\n\t\tthis.fields[name] = value;\n\t}\n\n\tgetUiFieldId(field): string\n\t{\n\t\treturn this.getId() + '_' + field;\n\t}\n\n\tgetBasePrice(): number\n\t{\n\t\treturn this.isPriceNetto() ? this.getPriceNetto() : this.getPriceBrutto();\n\t}\n\n\tisPriceNetto(): boolean\n\t{\n\t\treturn this.getEditor().isTaxAllowed() && !this.isTaxIncluded();\n\t}\n\n\tgetPrice(): number\n\t{\n\t\treturn this.getField('PRICE', 0);\n\t}\n\n\tgetPriceExclusive(): number\n\t{\n\t\treturn this.getField('PRICE_EXCLUSIVE', 0);\n\t}\n\n\tgetPriceNetto(): number\n\t{\n\t\treturn this.getField('PRICE_NETTO', 0);\n\t}\n\n\tgetPriceBrutto(): number\n\t{\n\t\treturn this.getField('PRICE_BRUTTO', 0);\n\t}\n\n\tgetQuantity(): number\n\t{\n\t\treturn this.getField('QUANTITY', 1);\n\t}\n\n\tgetDiscountType(): DiscountTypes\n\t{\n\t\treturn this.getField('DISCOUNT_TYPE_ID', DiscountType.UNDEFINED);\n\t}\n\n\tisDiscountUndefined(): boolean\n\t{\n\t\treturn this.getDiscountType() === DiscountType.UNDEFINED;\n\t}\n\n\tisDiscountPercentage(): boolean\n\t{\n\t\treturn this.getDiscountType() === DiscountType.PERCENTAGE;\n\t}\n\n\tisDiscountMonetary(): boolean\n\t{\n\t\treturn this.getDiscountType() === DiscountType.MONETARY;\n\t}\n\n\tisDiscountHandmade(): boolean\n\t{\n\t\treturn this.isDiscountPercentage() || this.isDiscountMonetary();\n\t}\n\n\tgetDiscountRate(): number\n\t{\n\t\treturn this.getField('DISCOUNT_RATE', 0);\n\t}\n\n\tgetDiscountSum(): number\n\t{\n\t\treturn this.getField('DISCOUNT_SUM', 0);\n\t}\n\n\tgetDiscountRow(): number\n\t{\n\t\treturn this.getField('DISCOUNT_ROW', 0);\n\t}\n\n\tisEmptyDiscount(): boolean\n\t{\n\t\tif (this.isDiscountPercentage())\n\t\t{\n\t\t\treturn this.getDiscountRate() === 0;\n\t\t}\n\t\telse if (this.isDiscountMonetary())\n\t\t{\n\t\t\treturn this.getDiscountSum() === 0;\n\t\t}\n\t\telse if (this.isDiscountUndefined())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetTaxIncluded(): 'Y' | 'N'\n\t{\n\t\treturn this.getField('TAX_INCLUDED', 'N');\n\t}\n\n\tisTaxIncluded(): boolean\n\t{\n\t\treturn this.getTaxIncluded() === 'Y';\n\t}\n\n\tgetTaxRate(): number\n\t{\n\t\treturn this.getField('TAX_RATE', 0);\n\t}\n\n\tgetTaxSum(): number\n\t{\n\t\treturn this.isTaxIncluded()\n\t\t\t? this.getPrice() * this.getQuantity() * (1 - 1 / (1 + this.getTaxRate() / 100))\n\t\t\t: this.getPriceExclusive() * this.getQuantity() * this.getTaxRate() / 100;\n\t}\n\n\tgetTaxNode(): ?HTMLSelectElement\n\t{\n\t\treturn this.getNode().querySelector('select[data-field-code=\"TAX_RATE\"]');\n\t}\n\n\tgetTaxId(): number\n\t{\n\t\tconst taxNode = this.getTaxNode();\n\n\t\tif (Type.isDomNode(taxNode) && taxNode.options[taxNode.selectedIndex])\n\t\t{\n\t\t\treturn Text.toNumber(taxNode.options[taxNode.selectedIndex].getAttribute('data-tax-id'));\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tupdateFieldByEvent(fieldCode: string, event: UIEvent): void\n\t{\n\t\tconst target = event.target;\n\t\tconst value = target.type === 'checkbox' ? target.checked : target.value;\n\t\tconst mode = event.type === 'input' ? MODE_EDIT : MODE_SET;\n\n\t\tthis.updateField(fieldCode, value, mode);\n\t}\n\n\tupdateField(fieldCode: string, value, mode = MODE_SET): void\n\t{\n\t\tthis.resetExternalActions();\n\t\tthis.updateFieldValue(fieldCode, value, mode);\n\t\tthis.executeExternalActions();\n\t}\n\n\tupdateFieldValue(code: string, value, mode = MODE_SET): void\n\t{\n\t\tswitch (code)\n\t\t{\n\t\t\tcase 'ID':\n\t\t\t\tthis.changeProductId(value);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PRICE':\n\t\t\t\tthis.changePrice(value, mode);\n\t\t\t\tbreak;\n\n\t\t\tcase 'QUANTITY':\n\t\t\t\tthis.changeQuantity(value, mode);\n\t\t\t\tbreak;\n\n\t\t\tcase 'MEASURE_CODE':\n\t\t\t\tthis.changeMeasureCode(value);\n\t\t\t\tbreak;\n\n\t\t\tcase 'DISCOUNT':\n\t\t\tcase 'DISCOUNT_PRICE':\n\t\t\t\tthis.changeDiscount(value, mode);\n\t\t\t\tbreak;\n\n\t\t\tcase 'DISCOUNT_TYPE_ID':\n\t\t\t\tthis.changeDiscountType(value);\n\t\t\t\tbreak;\n\n\t\t\tcase 'DISCOUNT_ROW':\n\t\t\t\tthis.changeRowDiscount(value, mode);\n\t\t\t\tbreak;\n\n\t\t\tcase 'VAT_ID':\n\t\t\tcase 'TAX_ID':\n\t\t\t\tthis.changeTaxId(value);\n\t\t\t\tbreak;\n\n\t\t\tcase 'TAX_RATE':\n\t\t\t\tthis.changeTaxRate(value);\n\t\t\t\tbreak;\n\n\t\t\tcase 'VAT_INCLUDED':\n\t\t\tcase 'TAX_INCLUDED':\n\t\t\t\tthis.changeTaxIncluded(value);\n\t\t\t\tbreak;\n\n\t\t\tcase 'SUM':\n\t\t\t\tthis.changeRowSum(value, mode);\n\t\t\t\tbreak;\n\n\t\t\tcase 'NAME':\n\t\t\tcase 'PRODUCT_NAME':\n\t\t\tcase 'MAIN_INFO':\n\t\t\t\tthis.changeProductName(value);\n\t\t\t\tbreak;\n\n\t\t\tcase 'SORT':\n\t\t\t\tthis.changeSort(value, mode);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tupdateFieldByName(field, value)\n\t{\n\t\tswitch (field)\n\t\t{\n\t\t\tcase 'TAX_INCLUDED':\n\t\t\t\tthis.setTaxIncluded(value);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tchangeProductId(value)\n\t{\n\t\tconst preparedValue = this.parseInt(value);\n\n\t\tthis.setProductId(preparedValue);\n\t}\n\n\tchangePrice(value, mode = MODE_SET)\n\t{\n\t\tconst preparedValue = this.parseFloat(value, this.getPricePrecision());\n\t\tthis.setPrice(preparedValue, mode);\n\t}\n\n\tchangeQuantity(value, mode = MODE_SET)\n\t{\n\t\tconst preparedValue = this.parseFloat(value, this.getQuantityPrecision());\n\t\tthis.setQuantity(preparedValue, mode);\n\t}\n\n\tchangeMeasureCode(value: string): void\n\t{\n\t\tthis\n\t\t\t.getEditor()\n\t\t\t.getMeasures()\n\t\t\t.filter((item) => item.CODE === value)\n\t\t\t.forEach((item) => this.setMeasure(item))\n\t\t;\n\t}\n\n\tchangeDiscount(value, mode = MODE_SET)\n\t{\n\t\tlet preparedValue;\n\n\t\tif (this.isDiscountPercentage())\n\t\t{\n\t\t\tpreparedValue = this.parseFloat(value, this.getCommonPrecision());\n\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpreparedValue = this\n\t\t\t\t.parseFloat(value, this.getPricePrecision())\n\t\t\t\t.toFixed(this.getPricePrecision())\n\t\t\t;\n\t\t}\n\n\t\tthis.setDiscount(preparedValue, mode);\n\t}\n\n\tchangeDiscountType(value)\n\t{\n\t\tconst preparedValue = this.parseInt(value, DiscountType.UNDEFINED);\n\n\t\tthis.setDiscountType(preparedValue);\n\t}\n\n\tchangeRowDiscount(value, mode = MODE_SET)\n\t{\n\t\tconst preparedValue = this.parseFloat(value, this.getPricePrecision());\n\n\t\tthis.setRowDiscount(preparedValue, mode);\n\t}\n\n\tchangeTaxId(value: number): void\n\t{\n\t\tconst taxList = this.getEditor().getTaxList();\n\t\tif (Type.isArrayFilled(taxList))\n\t\t{\n\t\t\tconst taxRate = taxList.find((item) => parseInt(item.ID) === parseInt(value));\n\t\t\tif (taxRate)\n\t\t\t{\n\t\t\t\tthis.changeTaxRate(this.parseFloat(taxRate.VALUE));\n\t\t\t}\n\t\t}\n\t}\n\n\tchangeTaxRate(value: number): void\n\t{\n\t\tconst preparedValue = this.parseFloat(value, this.getCommonPrecision());\n\n\t\tthis.setTaxRate(preparedValue);\n\t}\n\n\tchangeTaxIncluded(value)\n\t{\n\t\tif (Type.isBoolean(value))\n\t\t{\n\t\t\tvalue = value ? 'Y' : 'N';\n\t\t}\n\n\t\tthis.setTaxIncluded(value);\n\t}\n\n\tchangeRowSum(value, mode = MODE_SET)\n\t{\n\t\tconst preparedValue = this.parseFloat(value, this.getPricePrecision());\n\n\t\tthis.setRowSum(preparedValue, mode);\n\t}\n\n\tchangeProductName(value)\n\t{\n\t\tconst preparedValue = value.toString();\n\t\tconst isChangedValue = this.getField('PRODUCT_NAME') !== preparedValue;\n\n\t\tif (isChangedValue)\n\t\t{\n\t\t\tthis.setField('PRODUCT_NAME', preparedValue);\n\t\t\tthis.addActionProductChange();\n\t\t}\n\t}\n\n\tchangeSort(value, mode = MODE_SET)\n\t{\n\t\tconst preparedValue = this.parseInt(value);\n\n\t\tif (mode === MODE_SET)\n\t\t{\n\t\t\tthis.setField('SORT', preparedValue);\n\t\t}\n\n\t\tconst isChangedValue = this.getField('SORT') !== preparedValue;\n\n\t\tif (isChangedValue)\n\t\t{\n\t\t\tthis.addActionProductChange();\n\t\t}\n\t}\n\n\trefreshFieldsLayout(exceptFields: Array<string> = []): void\n\t{\n\t\tfor (let field in this.fields)\n\t\t{\n\t\t\tif (this.fields.hasOwnProperty(field) && !exceptFields.includes(field))\n\t\t\t{\n\t\t\t\tthis.updateUiField(field, this.fields[field]);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetCalculator(): ProductCalculator\n\t{\n\t\t/** @var {ProductCalculator} */\n\t\tconst calculator = this.cache.remember('calculator', () => new ProductCalculator());\n\n\t\treturn calculator\n\t\t\t.setFields(this.getCalculateFields())\n\t\t\t.setSettings(this.getEditor().getSettings())\n\t\t\t;\n\t}\n\n\tsetProductId(value)\n\t{\n\t\tconst isChangedValue = this.getField('PRODUCT_ID') !== value;\n\n\t\tif (isChangedValue)\n\t\t{\n\t\t\tthis.setField('PRODUCT_ID', value);\n\t\t\tthis.setField('OFFER_ID', value);\n\n\t\t\tthis.addActionProductChange();\n\t\t\tthis.addActionUpdateTotal();\n\t\t}\n\t}\n\n\tsetPrice(value, mode = MODE_SET)\n\t{\n\t\tconst originalPrice = value;\n\t\t// price can't be less than zero\n\t\tvalue = Math.max(value, 0);\n\n\t\tif (mode === MODE_SET)\n\t\t{\n\t\t\tthis.updateUiInputField('PRICE', value.toFixed(this.getPricePrecision()));\n\t\t}\n\n\t\tconst isChangedValue = this.getBasePrice() !== value;\n\t\tif (isChangedValue)\n\t\t{\n\t\t\tconst calculatedFields = this.getCalculator().calculatePrice(value);\n\t\t\tthis.setFields(calculatedFields);\n\t\t\tthis.refreshFieldsLayout(['PRICE_NETTO', 'PRICE_BRUTTO']);\n\n\t\t\tthis.addActionProductChange();\n\t\t\tthis.addActionUpdateTotal();\n\t\t}\n\n\t\tthis.#togglePriceHintPopup(originalPrice !== value);\n\t}\n\n\t#shouldShowSmallPriceHint(): boolean\n\t{\n\t\treturn (\n\t\t\tText.toNumber(this.getField('PRICE')) > 0\n\t\t\t&& Text.toNumber(this.getField('PRICE')) < 1\n\t\t\t&& this.isDiscountPercentage()\n\t\t\t&& (\n\t\t\t\tText.toNumber(this.getField('DISCOUNT_SUM')) > 0\n\t\t\t\t|| Text.toNumber(this.getField('DISCOUNT_RATE')) > 0\n\t\t\t\t|| Text.toNumber(this.getField('DISCOUNT_ROW')) > 0\n\t\t\t)\n\t\t);\n\t}\n\n\t#togglePriceHintPopup(showNegative: boolean = false): void\n\t{\n\t\tif (this.#shouldShowSmallPriceHint())\n\t\t{\n\t\t\tthis.getHintPopup()\n\t\t\t\t.load(\n\t\t\t\t\tthis.getInputByFieldName('PRICE'),\n\t\t\t\t\tLoc.getMessage('CRM_ENTITY_PL_SMALL_PRICE_NOTICE')\n\t\t\t\t)\n\t\t\t\t.show()\n\t\t\t;\n\t\t}\n\t\telse if (showNegative)\n\t\t{\n\t\t\tthis.getHintPopup()\n\t\t\t\t.load(\n\t\t\t\t\tthis.getInputByFieldName('PRICE'),\n\t\t\t\t\tLoc.getMessage('CRM_ENTITY_PL_NEGATIVE_PRICE_NOTICE')\n\t\t\t\t)\n\t\t\t\t.show()\n\t\t\t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getHintPopup().close();\n\t\t}\n\t}\n\n\tsetQuantity(value, mode = MODE_SET)\n\t{\n\t\tif (mode === MODE_SET)\n\t\t{\n\t\t\tthis.updateUiInputField('QUANTITY', value);\n\t\t}\n\n\t\tconst isChangedValue = this.getField('QUANTITY') !== value;\n\t\tif (isChangedValue)\n\t\t{\n\t\t\tconst calculatedFields = this.getCalculator().calculateQuantity(value);\n\t\t\tthis.setFields(calculatedFields);\n\t\t\tthis.refreshFieldsLayout(['QUANTITY']);\n\n\t\t\tthis.addActionProductChange();\n\t\t\tthis.addActionUpdateTotal();\n\t\t}\n\t}\n\n\tsetMeasure(measure)\n\t{\n\t\tthis.setField('MEASURE_CODE', measure.CODE);\n\t\tthis.setField('MEASURE_NAME', measure.SYMBOL);\n\n\t\tthis.updateUiMoneyField('MEASURE_CODE', measure.CODE, measure.SYMBOL);\n\t\tthis.addActionProductChange();\n\t}\n\n\tsetDiscount(value, mode = MODE_SET)\n\t{\n\t\tif (!this.isDiscountHandmade())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (mode === MODE_SET)\n\t\t{\n\t\t\tthis.updateUiInputField('DISCOUNT_PRICE', value);\n\t\t}\n\n\t\tconst fieldName = this.isDiscountPercentage() ? 'DISCOUNT_RATE' : 'DISCOUNT_SUM';\n\t\tconst isChangedValue = this.getField(fieldName) !== value;\n\t\tif (isChangedValue)\n\t\t{\n\t\t\tconst calculatedFields = this.getCalculator().calculateDiscount(value);\n\t\t\tthis.setFields(calculatedFields);\n\t\t\tthis.refreshFieldsLayout(['DISCOUNT_RATE', 'DISCOUNT_SUM', 'DISCOUNT']);\n\n\t\t\tthis.addActionProductChange();\n\t\t\tthis.addActionUpdateTotal();\n\t\t}\n\n\t\tthis.#togglePriceHintPopup();\n\t}\n\n\tsetDiscountType(value)\n\t{\n\t\tconst isChangedValue = value !== DiscountType.UNDEFINED\n\t\t\t&& this.getField('DISCOUNT_TYPE_ID') !== value;\n\n\t\tif (isChangedValue)\n\t\t{\n\t\t\tconst calculatedFields = this.getCalculator().calculateDiscountType(value);\n\t\t\tthis.setFields(calculatedFields);\n\t\t\tthis.refreshFieldsLayout();\n\n\t\t\tthis.addActionProductChange();\n\t\t\tthis.addActionUpdateTotal();\n\t\t}\n\t}\n\n\tsetRowDiscount(value, mode = MODE_SET)\n\t{\n\t\tif (mode === MODE_SET)\n\t\t{\n\t\t\tthis.updateUiInputField('DISCOUNT_ROW', value.toFixed(this.getPricePrecision()));\n\t\t}\n\n\t\tconst isChangedValue = this.getField('DISCOUNT_ROW') !== value;\n\t\tif (isChangedValue)\n\t\t{\n\t\t\tconst calculatedFields = this.getCalculator().calculateRowDiscount(value);\n\t\t\tthis.setFields(calculatedFields);\n\t\t\tthis.refreshFieldsLayout(['DISCOUNT_ROW']);\n\n\t\t\tthis.addActionProductChange();\n\t\t\tthis.addActionUpdateTotal();\n\t\t}\n\t}\n\n\tsetTaxRate(value)\n\t{\n\t\tif (!this.getEditor().isTaxAllowed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst isChangedValue = this.getTaxRate() !== value;\n\t\tif (isChangedValue)\n\t\t{\n\t\t\tconst calculatedFields = this.getCalculator().calculateTax(value);\n\t\t\tthis.setFields(calculatedFields);\n\t\t\tthis.refreshFieldsLayout();\n\n\t\t\tthis.addActionProductChange();\n\t\t\tthis.addActionUpdateTotal();\n\t\t}\n\t}\n\n\tsetTaxIncluded(value: 'Y' | 'N', mode = MODE_SET)\n\t{\n\t\tif (!this.getEditor().isTaxAllowed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (mode === MODE_SET)\n\t\t{\n\t\t\tthis.updateUiCheckboxField('TAX_INCLUDED', value);\n\t\t}\n\n\t\tconst isChangedValue = this.getTaxIncluded() !== value;\n\t\tif (isChangedValue)\n\t\t{\n\t\t\tconst calculatedFields = this.getCalculator().calculateTaxIncluded(value);\n\t\t\tthis.setFields(calculatedFields);\n\t\t\tthis.refreshFieldsLayout();\n\n\t\t\tthis.addActionUpdateFieldList('TAX_INCLUDED', value);\n\t\t\tthis.addActionProductChange();\n\t\t\tthis.addActionUpdateTotal();\n\t\t}\n\t}\n\n\tsetRowSum(value, mode = MODE_SET)\n\t{\n\t\tif (mode === MODE_SET)\n\t\t{\n\t\t\tthis.updateUiInputField('SUM', value.toFixed(this.getPricePrecision()));\n\t\t}\n\n\t\tconst isChangedValue = this.getField('SUM') !== value;\n\t\tif (isChangedValue)\n\t\t{\n\t\t\tconst calculatedFields = this.getCalculator().calculateRowSum(value);\n\t\t\tthis.setFields(calculatedFields);\n\t\t\tthis.refreshFieldsLayout(['SUM']);\n\n\t\t\tthis.addActionProductChange();\n\t\t\tthis.addActionUpdateTotal();\n\t\t}\n\t}\n\n\t// controls\n\tgetInputByFieldName(fieldName: string): ?HTMLElement\n\t{\n\t\tconst fieldId = this.getUiFieldId(fieldName);\n\t\tlet item = document.getElementById(fieldId);\n\n\t\tif (!Type.isElementNode(item))\n\t\t{\n\t\t\titem = this.getNode().querySelector('[name=\"' + fieldId + '\"]');\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tupdateUiInputField(name, value)\n\t{\n\t\tconst item = this.getInputByFieldName(name);\n\n\t\tif (Type.isElementNode(item))\n\t\t{\n\t\t\titem.value = value;\n\t\t}\n\t}\n\n\tupdateUiCheckboxField(name, value)\n\t{\n\t\tconst item = this.getInputByFieldName(name);\n\n\t\tif (Type.isElementNode(item))\n\t\t{\n\t\t\titem.checked = value === 'Y';\n\t\t}\n\t}\n\n\tupdateUiDiscountTypeField(name: string, value: number): void\n\t{\n\t\tlet text = value === DiscountType.MONETARY ? this.getEditor().getCurrencyText() : '%';\n\t\tthis.updateUiMoneyField(name, value, text);\n\t}\n\n\tgetMoneyFieldDropdownApi(name): ?BX.Main.dropdown\n\t{\n\t\tif (!Reflection.getClass('BX.Main.dropdownManager'))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn BX.Main.dropdownManager.getById(this.getId() + '_' + name + '_control');\n\t}\n\n\tupdateMoneyFieldUiWithDropdownApi(dropdown: BX.Main.dropdown, value: number | string)\n\t{\n\t\tif (dropdown.getValue() == value)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = dropdown.menu.itemsContainer.querySelector('[data-value=\"' + value + '\"]');\n\t\tconst menuItem = item && dropdown.getMenuItem(item);\n\t\tif (menuItem)\n\t\t{\n\t\t\tdropdown.refresh(menuItem);\n\t\t\tdropdown.selectItem(menuItem);\n\t\t}\n\t}\n\n\tupdateMoneyFieldUiManually(name: string, value: number | string, text: string): void\n\t{\n\t\tconst item = this.getInputByFieldName(name);\n\t\tif (!Type.isElementNode(item))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.dataset.value = value;\n\n\t\tconst span = item.querySelector('span.main-dropdown-inner');\n\t\tif (!Type.isElementNode(span))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tspan.innerHTML = text;\n\t}\n\n\tupdateUiMoneyField(name: string, value: number | string, text: string): void\n\t{\n\t\tconst dropdownApi = this.getMoneyFieldDropdownApi(name);\n\t\tif (dropdownApi)\n\t\t{\n\t\t\tthis.updateMoneyFieldUiWithDropdownApi(dropdownApi, value);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.updateMoneyFieldUiManually(name, value, text);\n\t\t}\n\t}\n\n\tupdateUiHtmlField(name, html)\n\t{\n\t\tconst item = this.getInputByFieldName(name);\n\n\t\tif (Type.isElementNode(item))\n\t\t{\n\t\t\titem.innerHTML = html;\n\t\t}\n\t}\n\n\tupdateUiCurrencyFields()\n\t{\n\t\tconst currencyText = this.getEditor().getCurrencyText();\n\t\tconst currencyId = '' + this.getEditor().getCurrencyId();\n\n\t\tconst currencyFieldNames = ['PRICE_CURRENCY', 'SUM_CURRENCY', 'DISCOUNT_TYPE_ID', 'DISCOUNT_ROW_CURRENCY'];\n\t\tcurrencyFieldNames.forEach((name) => {\n\t\t\tconst dropdownValues = [];\n\t\t\tif (name === 'DISCOUNT_TYPE_ID')\n\t\t\t{\n\t\t\t\tdropdownValues.push({\n\t\t\t\t\tNAME: '%',\n\t\t\t\t\tVALUE: '' + DiscountType.PERCENTAGE\n\t\t\t\t});\n\t\t\t\tdropdownValues.push({\n\t\t\t\t\tNAME: currencyText,\n\t\t\t\t\tVALUE: '' + DiscountType.MONETARY\n\t\t\t\t});\n\t\t\t\tif (this.getDiscountType() === DiscountType.MONETARY)\n\t\t\t\t{\n\t\t\t\t\tthis.updateMoneyFieldUiManually(name, DiscountType.MONETARY, currencyText);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdropdownValues.push({\n\t\t\t\t\tNAME: currencyText,\n\t\t\t\t\tVALUE: currencyId\n\t\t\t\t});\n\t\t\t\tthis.updateUiMoneyField(name, currencyId, currencyText);\n\t\t\t}\n\n\t\t\tDom.attr(this.getInputByFieldName(name), 'data-items', dropdownValues);\n\t\t});\n\n\t\tthis.updateUiField('TAX_SUM', this.getField('TAX_SUM'));\n\t}\n\n\tupdateUiField(field, value): void\n\t{\n\t\tconst uiName = this.getUiFieldName(field);\n\t\tif (!uiName)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst uiType = this.getUiFieldType(field);\n\t\tif (!uiType)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.allowUpdateUiField(field))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (uiType)\n\t\t{\n\t\t\tcase 'input':\n\t\t\t\tif (field === 'QUANTITY')\n\t\t\t\t{\n\t\t\t\t\tvalue = this.parseFloat(value, this.getQuantityPrecision());\n\t\t\t\t}\n\t\t\t\telse if (field === 'DISCOUNT_RATE' || field === 'TAX_RATE')\n\t\t\t\t{\n\t\t\t\t\tvalue = this.parseFloat(value, this.getCommonPrecision());\n\t\t\t\t}\n\t\t\t\telse if (Type.isNumber(value))\n\t\t\t\t{\n\t\t\t\t\tvalue = this\n\t\t\t\t\t\t.parseFloat(value, this.getPricePrecision())\n\t\t\t\t\t\t.toFixed(this.getPricePrecision())\n\t\t\t\t\t;\n\t\t\t\t}\n\n\t\t\t\tthis.updateUiInputField(uiName, value);\n\t\t\t\tbreak;\n\n\t\t\tcase 'checkbox':\n\t\t\t\tthis.updateUiCheckboxField(uiName, value);\n\t\t\t\tbreak;\n\n\t\t\tcase 'discount_type_field':\n\t\t\t\tthis.updateUiDiscountTypeField(uiName, value);\n\t\t\t\tbreak;\n\n\t\t\tcase 'html':\n\t\t\t\tthis.updateUiHtmlField(uiName, value);\n\t\t\t\tbreak;\n\n\t\t\tcase 'money_html':\n\t\t\t\tvalue = CurrencyCore.currencyFormat(value, this.getEditor().getCurrencyId(), true);\n\t\t\t\tthis.updateUiHtmlField(uiName, value);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tgetUiFieldName(field)\n\t{\n\t\tlet result = null;\n\n\t\tswitch (field)\n\t\t{\n\t\t\tcase 'QUANTITY':\n\t\t\tcase 'MEASURE_CODE':\n\t\t\tcase 'DISCOUNT_ROW':\n\t\t\tcase 'DISCOUNT_TYPE_ID':\n\t\t\tcase 'TAX_RATE':\n\t\t\tcase 'TAX_INCLUDED':\n\t\t\tcase 'TAX_SUM':\n\t\t\tcase 'SUM':\n\t\t\tcase 'PRODUCT_NAME':\n\t\t\tcase 'SORT':\n\t\t\t\tresult = field;\n\t\t\t\tbreak;\n\n\t\t\tcase 'PRICE_NETTO':\n\t\t\tcase 'PRICE_BRUTTO':\n\t\t\t\tresult = 'PRICE';\n\t\t\t\tbreak;\n\n\t\t\tcase 'DISCOUNT_RATE':\n\t\t\tcase 'DISCOUNT_SUM':\n\t\t\t\tresult = 'DISCOUNT_PRICE';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetUiFieldType(field)\n\t{\n\t\tlet result = null;\n\n\t\tswitch (field)\n\t\t{\n\t\t\tcase 'PRICE_NETTO':\n\t\t\tcase 'PRICE_BRUTTO':\n\t\t\tcase 'QUANTITY':\n\t\t\tcase 'TAX_RATE':\n\t\t\tcase 'DISCOUNT_RATE':\n\t\t\tcase 'DISCOUNT_SUM':\n\t\t\tcase 'DISCOUNT_ROW':\n\t\t\tcase 'SUM':\n\t\t\tcase 'PRODUCT_NAME':\n\t\t\tcase 'SORT':\n\t\t\t\tresult = 'input';\n\t\t\t\tbreak;\n\n\t\t\tcase 'DISCOUNT_TYPE_ID':\n\t\t\t\tresult = 'discount_type_field';\n\t\t\t\tbreak;\n\n\t\t\tcase 'TAX_INCLUDED':\n\t\t\t\tresult = 'checkbox';\n\t\t\t\tbreak;\n\n\t\t\tcase 'TAX_SUM':\n\t\t\t\tresult = 'money_html';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tallowUpdateUiField(field)\n\t{\n\t\tlet result = true;\n\n\t\tswitch (field)\n\t\t{\n\t\t\tcase 'PRICE_NETTO':\n\t\t\t\tresult = this.isPriceNetto();\n\t\t\t\tbreak;\n\n\t\t\tcase 'PRICE_BRUTTO':\n\t\t\t\tresult = !this.isPriceNetto();\n\t\t\t\tbreak;\n\n\t\t\tcase 'DISCOUNT_RATE':\n\t\t\t\tresult = this.isDiscountPercentage();\n\t\t\t\tbreak;\n\n\t\t\tcase 'DISCOUNT_SUM':\n\t\t\t\tresult = this.isDiscountMonetary();\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t// proxy\n\tparseInt(value: number | string, defaultValue: number = 0)\n\t{\n\t\treturn this.getEditor().parseInt(value, defaultValue);\n\t}\n\n\tparseFloat(value: number | string, precision: number, defaultValue = 0)\n\t{\n\t\treturn this.getEditor().parseFloat(value, precision, defaultValue);\n\t}\n\n\tgetPricePrecision()\n\t{\n\t\treturn this.getEditor().getPricePrecision();\n\t}\n\n\tgetQuantityPrecision()\n\t{\n\t\treturn this.getEditor().getQuantityPrecision();\n\t}\n\n\tgetCommonPrecision()\n\t{\n\t\treturn this.getEditor().getCommonPrecision();\n\t}\n\n\tresetExternalActions()\n\t{\n\t\tthis.externalActions.length = 0;\n\t}\n\n\taddExternalAction(action: Action)\n\t{\n\t\tthis.externalActions.push(action);\n\t}\n\n\taddActionProductChange()\n\t{\n\t\tthis.addExternalAction({\n\t\t\ttype: this.getEditor().actions.productChange,\n\t\t\tid: this.getId()\n\t\t});\n\t}\n\n\taddActionUpdateFieldList(field, value)\n\t{\n\t\tthis.addExternalAction({\n\t\t\ttype: this.getEditor().actions.updateListField,\n\t\t\tfield,\n\t\t\tvalue\n\t\t});\n\t}\n\n\taddActionStateChanged()\n\t{\n\t\tthis.addExternalAction({\n\t\t\ttype: this.getEditor().actions.stateChanged,\n\t\t\tvalue: true\n\t\t});\n\t}\n\n\taddActionStateReset()\n\t{\n\t\tthis.addExternalAction({\n\t\t\ttype: this.getEditor().actions.stateChanged,\n\t\t\tvalue: false\n\t\t});\n\t}\n\n\taddActionUpdateTotal()\n\t{\n\t\tthis.addExternalAction({\n\t\t\ttype: this.getEditor().actions.updateTotal\n\t\t});\n\t}\n\n\texecuteExternalActions()\n\t{\n\t\tif (this.externalActions.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getEditor().executeActions(this.externalActions);\n\t\tthis.resetExternalActions();\n\t}\n\n\tisEmpty()\n\t{\n\t\treturn (\n\t\t\t!Type.isStringFilled(this.getField('PRODUCT_NAME', '').trim())\n\t\t\t&& this.getField('PRODUCT_ID', 0) <= 0\n\t\t\t&& this.getPrice() <= 0\n\t\t)\n\t}\n}","export class PageEventsManager\n{\n\t_settings = {};\n\n\tconstructor(settings)\n\t{\n\t\tthis._settings = settings ? settings : {};\n\t\tthis.eventHandlers = {};\n\t}\n\n\tregisterEventHandler(eventName, eventHandler)\n\t{\n\t\tif (!this.eventHandlers[eventName])\n\t\t\tthis.eventHandlers[eventName] = [];\n\t\tthis.eventHandlers[eventName].push(eventHandler);\n\t\tBX.addCustomEvent(this, eventName, eventHandler);\n\t}\n\n\tfireEvent(eventName, eventParams)\n\t{\n\t\tBX.onCustomEvent(this, eventName, eventParams);\n\t}\n\n\tunregisterEventHandlers(eventName)\n\t{\n\t\tif (this.eventHandlers[eventName])\n\t\t{\n\t\t\tfor (var i = 0; i < this.eventHandlers[eventName].length; i++)\n\t\t\t{\n\t\t\t\tBX.removeCustomEvent(this, eventName, this.eventHandlers[eventName][i]);\n\t\t\t}\n\t\t\tdelete this.eventHandlers[eventName];\n\t\t}\n\t}\n}","import {Popup} from 'main.popup';\nimport {ajax, Cache, Event, Loc, Tag, Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {Editor} from './product.list.editor';\n\nexport default class SettingsPopup\n{\n\t#target: HTMLElement;\n\t#settings: [];\n\t#editor: Editor;\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(target: HTMLElement, settings = [], editor: Editor)\n\t{\n\t\tthis.#target = target;\n\t\tthis.#settings = settings;\n\t\tthis.#editor = editor;\n\t}\n\n\tshow()\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\tgetPopup()\n\t{\n\t\treturn this.#cache.remember('settings-popup', () => {\n\t\t\treturn new Popup(\n\t\t\t\tthis.#editor.getId() + '_' + Math.random() * 100,\n\t\t\t\tthis.#target,\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tdraggable: false,\n\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\tangle: {position: 'top', offset: 43},\n\t\t\t\t\tnoAllPaddings: true,\n\t\t\t\t\tbindOptions: {forceBindPosition: true},\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tcontent: this.#prepareSettingsContent()\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\t#getSetting(id: string)\n\t{\n\t\treturn this.#settings.filter(item => {\n\t\t\treturn item.id === id;\n\t\t})[0];\n\t}\n\n\t#prepareSettingsContent(): HTMLElement\n\t{\n\t\tconst content = Tag.render`\n\t\t\t<div class='ui-entity-editor-popup-create-field-list'></div>\n\t\t`;\n\n\t\tthis.#settings.forEach(item => {\n\t\t\tcontent.append(this.#getSettingItem(item));\n\t\t});\n\n\t\treturn content;\n\t}\n\n\t#getSettingItem(item): HTMLElement\n\t{\n\t\tconst input = Tag.render`\n\t\t\t<input type=\"checkbox\">\n\t\t`;\n\t\tinput.checked = item.checked;\n\t\tinput.dataset.settingId = item.id;\n\n\t\tconst descriptionNode = (\n\t\t\tType.isStringFilled(item.desc)\n\t\t\t\t? Tag.render`<span class=\"ui-entity-editor-popup-create-field-item-desc\">${item.desc}</span>`\n\t\t\t\t: ''\n\t\t);\n\n\t\tconst setting = Tag.render`\n\t\t\t<label class=\"ui-ctl-block ui-entity-editor-popup-create-field-item ui-ctl-w100\">\n\t\t\t\t<div class=\"ui-ctl-w10\" style=\"text-align: center\">${input}</div>\n\t\t\t\t<div class=\"ui-ctl-w75\">\n\t\t\t\t\t<span class=\"ui-entity-editor-popup-create-field-item-title\">${item.title}</span>\n\t\t\t\t\t${descriptionNode}\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t`;\n\n\t\tEvent.bind(setting, 'change', this.#setSetting.bind(this));\n\n\t\treturn setting;\n\t}\n\n\t#setSetting(event: BaseEvent): void\n\t{\n\t\tconst settingItem = this.#getSetting(event.target.dataset.settingId);\n\t\tif (!settingItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst settingEnabled = event.target.checked;\n\t\tthis.#requestGridSettings(settingItem, settingEnabled);\n\t}\n\n\t#requestGridSettings(setting, enabled)\n\t{\n\t\tconst headers = [];\n\t\tconst cells = this.#editor.getGrid().getRows().getHeadFirstChild().getCells();\n\n\t\tArray.from(cells).forEach((header) => {\n\t\t\tif ('name' in header.dataset)\n\t\t\t{\n\t\t\t\theaders.push(header.dataset.name);\n\t\t\t}\n\t\t});\n\n\t\tajax.runComponentAction(\n\t\t\tthis.#editor.getComponentName(),\n\t\t\t'setGridSetting',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tsignedParameters: this.#editor.getSignedParameters(),\n\t\t\t\t\tsettingId: setting.id,\n\t\t\t\t\tselected: enabled,\n\t\t\t\t\tcurrentHeaders: headers\n\t\t\t\t}\n\t\t\t}\n\t\t).then(() => {\n\t\t\tsetting.checked = enabled;\n\t\t\tif (setting.id === 'ADD_NEW_ROW_TOP')\n\t\t\t{\n\t\t\t\tconst panel = enabled ? 'top' : 'bottom';\n\t\t\t\tthis.#editor.setSettingValue('newRowPosition', panel);\n\t\t\t\tconst activePanel = this.#editor.changeActivePanelButtons(panel);\n\t\t\t\tconst settingButton = activePanel.querySelector('[data-role=\"product-list-settings-button\"]');\n\t\t\t\tthis.getPopup().setBindElement(settingButton);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#editor.reloadGrid();\n\t\t\t}\n\t\t\tthis.getPopup().close();\n\n\t\t\tconst message = enabled\n\t\t\t\t? Loc.getMessage('CRM_ENTITY_PL_SETTING_ENABLED')\n\t\t\t\t: Loc.getMessage('CRM_ENTITY_PL_SETTING_DISABLED');\n\n\t\t\tthis.#showNotification(message.replace('#NAME#', setting.title), {\n\t\t\t\tcategory: 'popup-settings'\n\t\t\t});\n\t\t});\n\t}\n\n\t#showNotification(content: string, options)\n\t{\n\t\toptions = options || {};\n\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: content,\n\t\t\tstack: options.stack || null,\n\t\t\tposition: 'top-right',\n\t\t\twidth: 'auto',\n\t\t\tcategory: options.category || null,\n\t\t\tautoHideDelay: options.autoHideDelay || 3000\n\t\t});\n\t}\n\n\tupdateCheckboxState(): void\n\t{\n\t\tconst popupContainer = this.getPopup().getContentContainer();\n\n\t\tthis.#settings\n\t\t\t.filter(item => item.action === 'grid' && Type.isArray(item.columns))\n\t\t\t.forEach(item => {\n\t\t\t\tlet allColumnsExist = true;\n\n\t\t\t\titem.columns.forEach(columnName => {\n\t\t\t\t\tif (!this.#editor.getGrid().getColumnHeaderCellByName(columnName))\n\t\t\t\t\t{\n\t\t\t\t\t\tallColumnsExist = false;\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tconst checkbox = popupContainer.querySelector('input[data-setting-id=\"' + item.id + '\"]');\n\t\t\t\tif (Type.isDomNode(checkbox))\n\t\t\t\t{\n\t\t\t\t\tcheckbox.checked = allColumnsExist;\n\t\t\t\t}\n\t\t\t});\n\t}\n}","import {ajax, Cache, Dom, Event, Loc, Reflection, Runtime, Tag, Text, Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Row} from './product.list.row';\nimport {PageEventsManager} from './page.events.manager';\nimport {DiscountType} from 'catalog.product-calculator';\nimport SettingsPopup from './settings.button';\nimport {CurrencyCore} from 'currency.currency-core';\nimport {ProductSelector} from 'catalog.product-selector';\nimport HintPopup from './hint.popup';\n\nconst GRID_TEMPLATE_ROW = 'template_0';\nconst DEFAULT_PRECISION: number = 2;\n\nexport class Editor\n{\n\tid: ?string;\n\tsettings: Object;\n\tcontroller: ?BX.Crm.EntityProductListController;\n\tcontainer: ?HTMLElement;\n\tform: ?HTMLElement\n\tproducts: Row[] = [];\n\tproductsWasInitiated = false;\n\tpageEventsManager: PageEventsManager;\n\tcache = new Cache.MemoryCache();\n\n\tactions = {\n\t\tproductChange: 'productChange',\n\t\tproductListChanged: 'productListChanged',\n\t\tupdateListField: 'listField',\n\t\tstateChanged: 'stateChange',\n\t\tupdateTotal: 'total'\n\t};\n\n\tstateChange = {\n\t\tchanged: false,\n\t\tsended: false\n\t};\n\n\tupdateFieldForList = null;\n\n\ttotalData = {\n\t\tinProgress: false\n\t};\n\n\tproductSelectionPopupHandler = this.handleProductSelectionPopup.bind(this);\n\tproductRowAddHandler = this.handleProductRowAdd.bind(this);\n\tshowSettingsPopupHandler = this.handleShowSettingsPopup.bind(this);\n\n\tonDialogSelectProductHandler = this.handleOnDialogSelectProduct.bind(this);\n\tonSaveHandler = this.handleOnSave.bind(this);\n\tonEditorSubmit = this.handleEditorSubmit.bind(this);\n\tonInnerCancelHandler = this.handleOnInnerCancel.bind(this);\n\tonBeforeGridRequestHandler = this.handleOnBeforeGridRequest.bind(this);\n\tonGridUpdatedHandler = this.handleOnGridUpdated.bind(this);\n\tonGridRowMovedHandler = this.handleOnGridRowMoved.bind(this);\n\tonBeforeProductChangeHandler = this.handleOnBeforeProductChange.bind(this);\n\tonProductChangeHandler = this.handleOnProductChange.bind(this);\n\tonProductClearHandler = this.handleOnProductClear.bind(this);\n\tdropdownChangeHandler = this.handleDropdownChange.bind(this);\n\n\tchangeProductFieldHandler = this.handleFieldChange.bind(this);\n\tupdateTotalDataDelayedHandler = Runtime.debounce(this.updateTotalDataDelayed, 1000, this);\n\n\tconstructor(id)\n\t{\n\t\tthis.setId(id);\n\t}\n\n\tinit(config = {})\n\t{\n\t\tthis.setSettings(config);\n\n\t\tif (this.canEdit())\n\t\t{\n\t\t\tthis.addFirstRowIfEmpty();\n\t\t\tthis.enableEdit();\n\t\t}\n\n\t\tthis.initForm();\n\t\tthis.initProducts();\n\t\tthis.initGridData();\n\n\t\tEventEmitter.emit(window, 'EntityProductListController', [this]);\n\n\t\tthis.subscribeDomEvents();\n\t\tthis.subscribeCustomEvents();\n\t}\n\n\tsubscribeDomEvents()\n\t{\n\t\tconst container = this.getContainer();\n\n\t\tif (Type.isElementNode(container))\n\t\t{\n\t\t\tcontainer.querySelectorAll('[data-role=\"product-list-select-button\"]').forEach((selectButton) => {\n\t\t\t\tEvent.bind(\n\t\t\t\t\tselectButton,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.productSelectionPopupHandler\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tcontainer.querySelectorAll('[data-role=\"product-list-add-button\"]').forEach((addButton) => {\n\t\t\t\tEvent.bind(\n\t\t\t\t\taddButton,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.productRowAddHandler\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tcontainer.querySelectorAll('[data-role=\"product-list-settings-button\"]').forEach((configButton) => {\n\t\t\t\tEvent.bind(\n\t\t\t\t\tconfigButton,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.showSettingsPopupHandler\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\n\tunsubscribeDomEvents()\n\t{\n\t\tconst container = this.getContainer();\n\n\t\tif (Type.isElementNode(container))\n\t\t{\n\t\t\tcontainer.querySelectorAll('[data-role=\"product-list-select-button\"]').forEach((selectButton) => {\n\t\t\t\tEvent.unbind(\n\t\t\t\t\tselectButton,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.productSelectionPopupHandler\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tcontainer.querySelectorAll('[data-role=\"product-list-add-button\"]').forEach((addButton) => {\n\t\t\t\tEvent.unbind(\n\t\t\t\t\taddButton,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.productRowAddHandler\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tcontainer.querySelectorAll('[data-role=\"product-list-settings-button\"]').forEach((configButton) => {\n\t\t\t\tEvent.unbind(\n\t\t\t\t\tconfigButton,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.showSettingsPopupHandler\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\n\tsubscribeCustomEvents()\n\t{\n\t\tEventEmitter.subscribe('CrmProductSearchDialog_SelectProduct', this.onDialogSelectProductHandler);\n\t\tEventEmitter.subscribe('BX.Crm.EntityEditor:onSave', this.onSaveHandler);\n\t\tEventEmitter.subscribe('BX.Crm.EntityEditorAjax:onSubmit', this.onEditorSubmit);\n\t\tEventEmitter.subscribe('EntityProductListController:onInnerCancel', this.onInnerCancelHandler);\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequestHandler);\n\t\tEventEmitter.subscribe('Grid::updated', this.onGridUpdatedHandler);\n\t\tEventEmitter.subscribe('Grid::rowMoved', this.onGridRowMovedHandler);\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onBeforeChange', this.onBeforeProductChangeHandler);\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onChange', this.onProductChangeHandler);\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onClear', this.onProductClearHandler);\n\t\tEventEmitter.subscribe('Dropdown::change', this.dropdownChangeHandler);\n\t}\n\n\tunsubscribeCustomEvents()\n\t{\n\t\tEventEmitter.unsubscribe('CrmProductSearchDialog_SelectProduct', this.onDialogSelectProductHandler);\n\t\tEventEmitter.unsubscribe('BX.Crm.EntityEditor:onSave', this.onSaveHandler);\n\t\tEventEmitter.unsubscribe('BX.Crm.EntityEditorAjax:onSubmit', this.onEditorSubmit);\n\t\tEventEmitter.unsubscribe('EntityProductListController:onInnerCancel', this.onInnerCancelHandler);\n\t\tEventEmitter.unsubscribe('Grid::beforeRequest', this.onBeforeGridRequestHandler);\n\t\tEventEmitter.unsubscribe('Grid::updated', this.onGridUpdatedHandler);\n\t\tEventEmitter.unsubscribe('Grid::rowMoved', this.onGridRowMovedHandler);\n\t\tEventEmitter.unsubscribe('BX.Catalog.ProductSelector:onBeforeChange', this.onBeforeProductChangeHandler);\n\t\tEventEmitter.unsubscribe('BX.Catalog.ProductSelector:onChange', this.onProductChangeHandler);\n\t\tEventEmitter.unsubscribe('BX.Catalog.ProductSelector:onClear', this.onProductClearHandler);\n\t\tEventEmitter.unsubscribe('Dropdown::change', this.dropdownChangeHandler);\n\t}\n\n\thandleOnDialogSelectProduct(event: BaseEvent)\n\t{\n\t\tconst [productId] = event.getCompatData();\n\t\tconst id = this.addProductRow();\n\t\tthis.selectProductInRow(id, productId)\n\t}\n\n\tselectProductInRow(id: string, productId: number): void\n\t{\n\t\tif (!Type.isStringFilled(id) || Text.toNumber(productId) <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\trequestAnimationFrame(() => {\n\t\t\tthis\n\t\t\t\t.getProductSelector(id)\n\t\t\t\t?.onProductSelect(productId)\n\t\t\t;\n\t\t});\n\t}\n\n\thandleOnSave(event: BaseEvent)\n\t{\n\t\tconst items = [];\n\n\t\tthis.products.forEach((product) => {\n\t\t\tconst item = {\n\t\t\t\tfields: {...product.fields},\n\t\t\t\trowId: product.fields.ROW_ID\n\t\t\t};\n\t\t\titems.push(item);\n\t\t});\n\n\t\tthis.setSettingValue('items', items);\n\t}\n\n\thandleEditorSubmit(event: BaseEvent)\n\t{\n\t\tif (!this.isLocationDependantTaxesEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst entityData = event.getData()[0];\n\t\tif (!entityData || !entityData.hasOwnProperty('LOCATION_ID'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (entityData['LOCATION_ID'] !== this.getLocationId())\n\t\t{\n\t\t\tthis.setLocationId(entityData['LOCATION_ID']);\n\t\t\tthis.reloadGrid(false);\n\t\t}\n\t}\n\n\thandleOnInnerCancel(event: BaseEvent)\n\t{\n\t\tif (this.controller)\n\t\t{\n\t\t\tthis.controller.rollback();\n\t\t}\n\n\t\tthis.reloadGrid(false);\n\t}\n\n\tchangeActivePanelButtons(panelCode: 'top' | 'bottom'): HTMLElement\n\t{\n\t\tconst container = this.getContainer();\n\t\tconst activePanel = container.querySelector('.crm-entity-product-list-add-block-' + panelCode);\n\t\tif (Type.isDomNode(activePanel))\n\t\t{\n\t\t\tDom.removeClass(activePanel, 'crm-entity-product-list-add-block-hidden');\n\t\t\tDom.addClass(activePanel, 'crm-entity-product-list-add-block-active');\n\t\t}\n\n\t\tconst hiddenPanelCode = (panelCode === 'top') ? 'bottom' : 'top';\n\t\tconst removePanel = container.querySelector('.crm-entity-product-list-add-block-' + hiddenPanelCode);\n\t\tif (Type.isDomNode(removePanel))\n\t\t{\n\t\t\tDom.addClass(removePanel, 'crm-entity-product-list-add-block-hidden');\n\t\t\tDom.removeClass(removePanel, 'crm-entity-product-list-add-block-active');\n\t\t}\n\n\t\treturn activePanel;\n\t}\n\n\treloadGrid(useProductsFromRequest: boolean = true, isInternalChanging: ?boolean = null): void\n\t{\n\t\tif (isInternalChanging === null)\n\t\t{\n\t\t\tisInternalChanging = !useProductsFromRequest;\n\t\t}\n\n\t\tthis.getGrid().reloadTable(\n\t\t\t'POST',\n\t\t\t{useProductsFromRequest},\n\t\t\t() => this.actionUpdateTotalData({isInternalChanging})\n\t\t);\n\t}\n\n\t/*\n\t\tkeep in mind different actions for this handler:\n\t\t- native reload by grid actions (columns settings, etc)\t\t- products from request\n\t\t- reload by tax/discount settings button\t\t\t\t\t- products from request\t\tthis.reloadGrid(true)\n\t\t- rollback\t\t\t\t\t\t\t\t\t\t\t\t\t- products from db\t\t\tthis.reloadGrid(false)\n\t\t- reload after SalesCenter order save\t\t\t\t\t\t- products from db\t\t\tthis.reloadGrid(false)\n\t\t- reload after save if location had been changed\n\t */\n\thandleOnBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [grid, eventArgs] = event.getCompatData();\n\n\t\tif (!grid || !grid.parent || grid.parent.getId() !== this.getGridId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// reload by native grid actions (columns settings, etc), otherwise by this.reloadGrid()\n\t\tconst isNativeAction = !('useProductsFromRequest' in eventArgs.data);\n\t\tconst useProductsFromRequest = isNativeAction ? true : eventArgs.data.useProductsFromRequest;\n\n\t\teventArgs.url = this.getReloadUrl();\n\t\teventArgs.method = 'POST';\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t\tsignedParameters: this.getSignedParameters(),\n\t\t\tproducts: useProductsFromRequest ? this.getProductsFields() : null,\n\t\t\tlocationId: this.getLocationId(),\n\t\t};\n\n\t\tthis.clearEditor();\n\n\t\tif (isNativeAction)\n\t\t{\n\t\t\tEventEmitter.subscribeOnce('Grid::updated', () => this.actionUpdateTotalData({isInternalChanging: false}));\n\t\t}\n\t}\n\n\thandleOnGridUpdated(event: BaseEvent)\n\t{\n\t\tconst [grid] = event.getCompatData();\n\n\t\tif (!grid || grid.getId() !== this.getGridId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getSettingsPopup().updateCheckboxState();\n\t}\n\n\thandleOnGridRowMoved(event: BaseEvent)\n\t{\n\t\tconst [ids, , grid] = event.getCompatData();\n\n\t\tif (!grid || grid.getId() !== this.getGridId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst changed = this.resortProductsByIds(ids);\n\t\tif (changed)\n\t\t{\n\t\t\tthis.refreshSortFields();\n\t\t\tthis.numerateRows();\n\t\t\tthis.executeActions([{type: this.actions.productListChanged}]);\n\t\t}\n\t}\n\n\tinitPageEventsManager(): void\n\t{\n\t\tconst componentId = this.getSettingValue('componentId');\n\t\tthis.pageEventsManager = new PageEventsManager({id: componentId});\n\t}\n\n\tgetPageEventsManager(): PageEventsManager\n\t{\n\t\tif (!this.pageEventsManager)\n\t\t{\n\t\t\tthis.initPageEventsManager();\n\t\t}\n\n\t\treturn this.pageEventsManager;\n\t}\n\n\tcanEdit(): boolean\n\t{\n\t\treturn this.getSettingValue('allowEdit', false) === true;\n\t}\n\n\tenableEdit()\n\t{\n\t\t// Cannot use editSelected because checkboxes have been removed\n\t\tconst rows = this.getGrid().getRows().getRows();\n\t\trows.forEach((current) => {\n\t\t\tif (!current.isHeadChild() && !current.isTemplate())\n\t\t\t{\n\t\t\t\tcurrent.edit();\n\t\t\t}\n\t\t});\n\t}\n\n\taddFirstRowIfEmpty(): void\n\t{\n\t\tif (this.getGrid().getRows().getCountDisplayed() === 0)\n\t\t{\n\t\t\trequestAnimationFrame(() => this.addProductRow());\n\t\t}\n\t}\n\n\tclearEditor()\n\t{\n\t\tthis.unsubscribeProductsEvents();\n\n\t\tthis.products = [];\n\t\tthis.productsWasInitiated = false;\n\n\t\tthis.destroySettingsPopup();\n\t\tthis.unsubscribeDomEvents();\n\t\tthis.unsubscribeCustomEvents();\n\n\t\tEvent.unbindAll(this.container);\n\t}\n\n\twasProductsInitiated()\n\t{\n\t\treturn this.productsWasInitiated;\n\t}\n\n\tunsubscribeProductsEvents()\n\t{\n\t\tthis.products.forEach((current) => {\n\t\t\tconst productSelector = this.getProductSelector(current.getField('ID'));\n\t\t\t// Used to avoid dependence on catalog 21.100.0\n\t\t\tif (productSelector && typeof productSelector.unsubscribeEvents !== 'undefined')\n\t\t\t{\n\t\t\t\tproductSelector.unsubscribeEvents();\n\t\t\t}\n\t\t});\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.setForm(null);\n\t\tthis.clearController();\n\t\tthis.clearEditor();\n\t}\n\n\tsetController(controller)\n\t{\n\t\tif (this.controller === controller)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.controller)\n\t\t{\n\t\t\tthis.controller.clearProductList();\n\t\t}\n\t\tthis.controller = controller;\n\t}\n\n\tclearController()\n\t{\n\t\tthis.controller = null;\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\t/* settings tools */\n\tgetSettings()\n\t{\n\t\treturn this.settings;\n\t}\n\n\tsetSettings(settings)\n\t{\n\t\tthis.settings = settings ? settings : {};\n\t}\n\n\tgetSettingValue(name: string, defaultValue)\n\t{\n\t\treturn this.settings.hasOwnProperty(name) ? this.settings[name] : defaultValue;\n\t}\n\n\tsetSettingValue(name, value)\n\t{\n\t\tthis.settings[name] = value;\n\t}\n\n\tgetComponentName()\n\t{\n\t\treturn this.getSettingValue('componentName', '');\n\t}\n\n\tgetReloadUrl()\n\t{\n\t\treturn this.getSettingValue('reloadUrl', '');\n\t}\n\n\tgetSignedParameters()\n\t{\n\t\treturn this.getSettingValue('signedParameters', '');\n\t}\n\n\tgetContainerId()\n\t{\n\t\treturn this.getSettingValue('containerId', '');\n\t}\n\n\tgetGridId(): string\n\t{\n\t\treturn this.getSettingValue('gridId', '');\n\t}\n\n\tgetLanguageId()\n\t{\n\t\treturn this.getSettingValue('languageId', '');\n\t}\n\n\tgetSiteId()\n\t{\n\t\treturn this.getSettingValue('siteId', '');\n\t}\n\n\tgetCatalogId()\n\t{\n\t\treturn this.getSettingValue('catalogId', 0);\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this.getSettingValue('readOnly', true);\n\t}\n\n\tsetReadOnly(readOnly)\n\t{\n\t\tthis.setSettingValue('readOnly', readOnly);\n\t}\n\n\tgetCurrencyId(): string\n\t{\n\t\treturn this.getSettingValue('currencyId', '');\n\t}\n\n\tsetCurrencyId(currencyId): void\n\t{\n\t\tthis.setSettingValue('currencyId', currencyId);\n\t}\n\n\tisLocationDependantTaxesEnabled(): bool\n\t{\n\t\treturn this.getSettingValue('isLocationDependantTaxesEnabled', false);\n\t}\n\n\tgetLocationId(): ?string\n\t{\n\t\treturn this.getSettingValue('locationId');\n\t}\n\n\tsetLocationId(locationId: string): void\n\t{\n\t\tthis.setSettingValue('locationId', locationId);\n\t}\n\n\tchangeCurrencyId(currencyId): void\n\t{\n\t\tthis.setCurrencyId(currencyId);\n\t\tconst products = [];\n\t\tthis.products.forEach((product) => {\n\t\t\tproducts.push({\n\t\t\t\tfields: product.getFields(),\n\t\t\t\tid: product.getId()\n\t\t\t});\n\t\t});\n\n\t\tif (products.length > 0)\n\t\t{\n\t\t\tthis.ajaxRequest('calculateProductPrices', {\n\t\t\t\tproducts,\n\t\t\t\tcurrencyId\n\t\t\t});\n\t\t}\n\n\t\tconst editData = this.getGridEditData();\n\t\tconst templateRow = editData[GRID_TEMPLATE_ROW];\n\t\ttemplateRow['CURRENCY'] = this.getCurrencyId();\n\t\tconst templateFieldNames = ['DISCOUNT_ROW', 'SUM', 'PRICE'];\n\n\t\ttemplateFieldNames.forEach((field) => {\n\t\t\ttemplateRow[field]['CURRENCY']['VALUE'] = this.getCurrencyId();\n\t\t});\n\t\tthis.setGridEditData(editData);\n\t}\n\n\tonCalculatePricesResponse(products: [])\n\t{\n\t\tthis.products.forEach((product) => {\n\t\t\tif (Type.isObject(products[product.getId()]))\n\t\t\t{\n\t\t\t\tconst newPrice = Text.toNumber(products[product.getId()]['PRICE']);\n\t\t\t\tproduct.updateUiCurrencyFields();\n\t\t\t\tproduct.updateField('PRICE', newPrice);\n\t\t\t\tproduct.setField('CURRENCY', products[product.getId()]['CURRENCY_ID']);\n\t\t\t}\n\t\t});\n\n\t\tthis.updateTotalUiCurrency();\n\t}\n\n\tupdateTotalUiCurrency()\n\t{\n\t\tconst totalBlock = BX(this.getSettingValue('totalBlockContainerId', null));\n\t\tif (Type.isElementNode(totalBlock))\n\t\t{\n\t\t\ttotalBlock.querySelectorAll('[data-role=\"currency-wrapper\"]').forEach((row) => {\n\t\t\t\trow.innerHTML = this.getCurrencyText();\n\t\t\t});\n\t\t}\n\t}\n\n\tgetCurrencyText(): string\n\t{\n\t\tconst currencyId = this.getCurrencyId();\n\t\tif (!Type.isStringFilled(currencyId))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst format = CurrencyCore.getCurrencyFormat(currencyId);\n\n\t\treturn format && format.FORMAT_STRING.replace(/(^|[^&])#/, '$1').trim() || '';\n\t}\n\n\tgetDataFieldName()\n\t{\n\t\treturn this.getSettingValue('dataFieldName', '');\n\t}\n\n\tgetDataSettingsFieldName()\n\t{\n\t\tconst field = this.getDataFieldName();\n\n\t\treturn Type.isStringFilled(field) ? field + '_SETTINGS' : '';\n\t}\n\n\tgetDiscountEnabled(): 'Y' | 'N'\n\t{\n\t\treturn this.getSettingValue('enableDiscount', 'N');\n\t}\n\n\tgetPricePrecision(): number\n\t{\n\t\treturn this.getSettingValue('pricePrecision', DEFAULT_PRECISION);\n\t}\n\n\tgetQuantityPrecision(): number\n\t{\n\t\treturn this.getSettingValue('quantityPrecision', DEFAULT_PRECISION);\n\t}\n\n\tgetCommonPrecision(): number\n\t{\n\t\treturn this.getSettingValue('commonPrecision', DEFAULT_PRECISION);\n\t}\n\n\tgetTaxList(): Array\n\t{\n\t\treturn this.getSettingValue('taxList', []);\n\t}\n\n\tgetTaxAllowed(): 'Y' | 'N'\n\t{\n\t\treturn this.getSettingValue('allowTax', 'N');\n\t}\n\n\tisTaxAllowed(): boolean\n\t{\n\t\treturn this.getTaxAllowed() === 'Y';\n\t}\n\n\tgetTaxEnabled(): 'Y' | 'N'\n\t{\n\t\treturn this.getSettingValue('enableTax', 'N');\n\t}\n\n\tisTaxEnabled(): boolean\n\t{\n\t\treturn this.getTaxEnabled() === 'Y';\n\t}\n\n\tisTaxUniform(): boolean\n\t{\n\t\treturn this.getSettingValue('taxUniform', true);\n\t}\n\n\tgetMeasures(): []\n\t{\n\t\treturn this.getSettingValue('measures', []);\n\t}\n\n\tgetDefaultMeasure()\n\t{\n\t\treturn this.getSettingValue('defaultMeasure', {});\n\t}\n\n\tgetRowIdPrefix()\n\t{\n\t\treturn this.getSettingValue('rowIdPrefix', 'crm_entity_product_list_');\n\t}\n\n\t/* settings tools finish */\n\n\t/* calculate tools */\n\tparseInt(value: number | string, defaultValue: number = 0)\n\t{\n\t\tlet result;\n\n\t\tconst isNumberValue = Type.isNumber(value);\n\t\tconst isStringValue = Type.isStringFilled(value);\n\n\t\tif (!isNumberValue && !isStringValue)\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\tif (isStringValue)\n\t\t{\n\t\t\tvalue = value.replace(/^\\s+|\\s+$/g, '');\n\t\t\tconst isNegative = value.indexOf('-') === 0;\n\t\t\tresult = parseInt(value.replace(/[^\\d]/g, ''), 10);\n\t\t\tif (isNaN(result))\n\t\t\t{\n\t\t\t\tresult = defaultValue;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (isNegative)\n\t\t\t\t{\n\t\t\t\t\tresult = -result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = parseInt(value, 10);\n\t\t\tif (isNaN(result))\n\t\t\t{\n\t\t\t\tresult = defaultValue;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tparseFloat(value: number | string, precision: number = DEFAULT_PRECISION, defaultValue: number = 0.0)\n\t{\n\t\tlet result;\n\n\t\tconst isNumberValue = Type.isNumber(value);\n\t\tconst isStringValue = Type.isStringFilled(value);\n\n\t\tif (!isNumberValue && !isStringValue)\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\tif (isStringValue)\n\t\t{\n\t\t\tvalue = value.replace(/^\\s+|\\s+$/g, '');\n\n\t\t\tconst dot = value.indexOf('.');\n\t\t\tconst comma = value.indexOf(',');\n\t\t\tconst isNegative = value.indexOf('-') === 0;\n\n\t\t\tif (dot < 0 && comma >= 0)\n\t\t\t{\n\t\t\t\tlet s1 = value.substr(0, comma);\n\t\t\t\tconst decimalLength = value.length - comma - 1;\n\n\t\t\t\tif (decimalLength > 0)\n\t\t\t\t{\n\t\t\t\t\ts1 += '.' + value.substr(comma + 1, decimalLength);\n\t\t\t\t}\n\n\t\t\t\tvalue = s1;\n\t\t\t}\n\n\t\t\tvalue = value.replace(/[^\\d.]+/g, '');\n\t\t\tresult = parseFloat(value);\n\n\t\t\tif (isNaN(result))\n\t\t\t{\n\t\t\t\tresult = defaultValue;\n\t\t\t}\n\t\t\tif (isNegative)\n\t\t\t{\n\t\t\t\tresult = -result;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = parseFloat(value);\n\t\t}\n\n\t\tif (precision >= 0)\n\t\t{\n\t\t\tresult = this.round(result, precision);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tround(value: number, precision: number = DEFAULT_PRECISION)\n\t{\n\t\tconst factor = Math.pow(10, precision);\n\n\t\treturn Math.round(value * factor) / factor;\n\t}\n\n\tcalculatePriceWithoutDiscount(price, discount, discountType)\n\t{\n\t\tlet result = 0.0;\n\n\t\tswitch (discountType)\n\t\t{\n\t\t\tcase DiscountType.PERCENTAGE:\n\t\t\t\tresult = (price - ((price * discount) / 100));\n\t\t\t\tbreak;\n\n\t\t\tcase DiscountType.MONETARY:\n\t\t\t\tresult = (price - discount);\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tcalculateDiscountRate(originalPrice, price)\n\t{\n\t\tif (originalPrice === 0.0)\n\t\t{\n\t\t\treturn 0.0;\n\t\t}\n\n\t\tif (price === 0.0)\n\t\t{\n\t\t\treturn originalPrice > 0 ? 100.0 : -100.0;\n\t\t}\n\n\t\treturn ((100 * (originalPrice - price)) / originalPrice);\n\t}\n\n\tcalculateDiscount(originalPrice, discountRate)\n\t{\n\t\treturn originalPrice * discountRate / 100;\n\t}\n\n\tcalculatePriceWithoutTax(price, taxRate)\n\t{\n\t\t// Tax is not included in price\n\t\treturn price / (1 + (taxRate / 100));\n\t}\n\n\tcalculatePriceWithTax(price, taxRate)\n\t{\n\t\t// Tax is included in price\n\t\treturn price * (1 + (taxRate / 100));\n\t}\n\n\t/* calculate tools finish */\n\n\tgetContainer()\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\treturn document.getElementById(this.getContainerId());\n\t\t});\n\t}\n\n\tinitForm()\n\t{\n\t\tconst formId = this.getSettingValue('formId', '');\n\t\tconst form = Type.isStringFilled(formId) ? BX('form_' + formId) : null;\n\n\t\tif (Type.isElementNode(form))\n\t\t{\n\t\t\tthis.setForm(form);\n\t\t}\n\t}\n\n\tisExistForm()\n\t{\n\t\treturn Type.isElementNode(this.getForm());\n\t}\n\n\tgetForm()\n\t{\n\t\treturn this.form;\n\t}\n\n\tsetForm(form)\n\t{\n\t\tthis.form = form;\n\t}\n\n\tinitFormFields()\n\t{\n\t\tconst container = this.getForm();\n\t\tif (Type.isElementNode(container))\n\t\t{\n\t\t\tconst field = this.getDataField();\n\t\t\tif (!Type.isElementNode(field))\n\t\t\t{\n\t\t\t\tthis.initDataField();\n\t\t\t}\n\n\t\t\tconst settingsField = this.getDataSettingsField();\n\t\t\tif (!Type.isElementNode(settingsField))\n\t\t\t{\n\t\t\t\tthis.initDataSettingsField();\n\t\t\t}\n\t\t}\n\t}\n\n\tinitFormField(fieldName)\n\t{\n\t\tconst container = this.getForm();\n\n\t\tif (Type.isElementNode(container) && Type.isStringFilled(fieldName))\n\t\t{\n\t\t\tcontainer.appendChild(Dom.create(\n\t\t\t\t'input',\n\t\t\t\t{attrs: {type: \"hidden\", name: fieldName}}\n\t\t\t));\n\t\t}\n\t}\n\n\tremoveFormFields()\n\t{\n\t\tconst field = this.getDataField();\n\t\tif (Type.isElementNode(field))\n\t\t{\n\t\t\tDom.remove(field);\n\t\t}\n\n\t\tconst settingsField = this.getDataSettingsField();\n\t\tif (Type.isElementNode(settingsField))\n\t\t{\n\t\t\tDom.remove(settingsField);\n\t\t}\n\t}\n\n\tinitDataField()\n\t{\n\t\tthis.initFormField(this.getDataFieldName());\n\t}\n\n\tinitDataSettingsField()\n\t{\n\t\tthis.initFormField(this.getDataSettingsFieldName());\n\t}\n\n\tgetFormField(fieldName)\n\t{\n\t\tconst container = this.getForm();\n\n\t\tif (Type.isElementNode(container) && Type.isStringFilled(fieldName))\n\t\t{\n\t\t\treturn container.querySelector('input[name=\"' + fieldName + '\"]');\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetDataField()\n\t{\n\t\treturn this.getFormField(this.getDataFieldName());\n\t}\n\n\tgetDataSettingsField()\n\t{\n\t\treturn this.getFormField(this.getDataSettingsFieldName());\n\t}\n\n\tgetProductCount()\n\t{\n\t\treturn this.products\n\t\t\t.filter(item => !item.isEmpty())\n\t\t\t.length\n\t\t\t;\n\t}\n\n\tinitProducts()\n\t{\n\t\tconst list = this.getSettingValue('items', []);\n\n\t\tfor (let item of list)\n\t\t{\n\t\t\tconst fields = {...item.fields};\n\t\t\tthis.products.push(new Row(item.rowId, fields, {}, this));\n\t\t\tconst row = this.getGrid().getRows().getById(fields.ID);\n\t\t\tif (row)\n\t\t\t{\n\t\t\t\tthis.setDeleteButton(row.getNode(), fields.ID);\n\t\t\t}\n\t\t}\n\n\t\tthis.numerateRows();\n\t\tthis.productsWasInitiated = true;\n\t}\n\n\tnumerateRows()\n\t{\n\t\tthis.products.forEach((product, index) => {\n\t\t\tproduct.setRowNumber(index + 1);\n\t\t})\n\t}\n\n\tgetGrid(): ?BX.Main.Grid\n\t{\n\t\treturn this.cache.remember('grid', () => {\n\t\t\tconst gridId = this.getGridId();\n\n\t\t\tif (!Reflection.getClass('BX.Main.gridManager.getInstanceById'))\n\t\t\t{\n\t\t\t\tthrow Error(`Cannot find grid with '${gridId}' id.`)\n\t\t\t}\n\n\t\t\treturn BX.Main.gridManager.getInstanceById(gridId);\n\t\t});\n\t}\n\n\tinitGridData()\n\t{\n\t\tconst gridEditData = this.getSettingValue('templateGridEditData', null);\n\t\tif (gridEditData)\n\t\t{\n\t\t\tthis.setGridEditData(gridEditData);\n\t\t}\n\t}\n\n\tgetGridEditData()\n\t{\n\t\treturn this.getGrid().arParams.EDITABLE_DATA;\n\t}\n\n\tsetGridEditData(data: {})\n\t{\n\t\tthis.getGrid().arParams.EDITABLE_DATA = data;\n\t}\n\n\tsetOriginalTemplateEditData(data)\n\t{\n\t\tthis.getGrid().arParams.EDITABLE_DATA[GRID_TEMPLATE_ROW] = data;\n\t}\n\n\thandleFieldChange(event)\n\t{\n\t\tconst row = event.target.closest('tr');\n\t\tif (row && row.hasAttribute('data-id'))\n\t\t{\n\t\t\tconst product = this.getProductById(row.getAttribute('data-id'));\n\t\t\tif (product)\n\t\t\t{\n\t\t\t\tconst cell = event.target.closest('td');\n\t\t\t\tconst fieldCode = this.getFieldCodeByGridCell(row, cell);\n\t\t\t\tif (fieldCode)\n\t\t\t\t{\n\t\t\t\t\tproduct.updateFieldByEvent(fieldCode, event);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thandleDropdownChange(event: BaseEvent)\n\t{\n\t\tconst [dropdownId, , , , value] = event.getData();\n\t\tconst regExp = new RegExp(this.getRowIdPrefix() + '([A-Za-z0-9]+)_(\\\\w+)_control', 'i');\n\t\tconst matches = dropdownId.match(regExp);\n\t\tif (matches)\n\t\t{\n\t\t\tconst [, rowId, fieldCode] = matches;\n\t\t\tconst product = this.getProductById(rowId);\n\t\t\tif (product)\n\t\t\t{\n\t\t\t\tproduct.updateField(fieldCode, value);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetProductById(id: string): ?Row\n\t{\n\t\tconst rowId = this.getRowIdPrefix() + id;\n\n\t\treturn this.getProductByRowId(rowId);\n\t}\n\n\tgetProductByRowId(rowId: string): ?Row\n\t{\n\t\treturn this.products.find((row: Row) => {\n\t\t\treturn row.getId() === rowId;\n\t\t});\n\t}\n\n\tgetFieldCodeByGridCell(row: HTMLTableRowElement, cell: HTMLTableCellElement): ?string\n\t{\n\t\tif (!Type.isDomNode(row) || !Type.isDomNode(cell))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst grid = this.getGrid();\n\t\tif (grid)\n\t\t{\n\t\t\tconst headRow = grid.getRows().getHeadFirstChild();\n\t\t\tconst index = [...row.cells].indexOf(cell);\n\n\t\t\treturn headRow.getCellNameByCellIndex(index);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\thandleProductSelectionPopup(event)\n\t{\n\t\tconst caller = 'crm_entity_product_list';\n\t\tconst jsEventsManagerId = this.getSettingValue('jsEventsManagerId', '');\n\n\t\tconst popup = new BX.CDialog({\n\t\t\tcontent_url: '/bitrix/components/bitrix/crm.product_row.list/product_choice_dialog.php?'\n\t\t\t\t+ 'caller=' + caller\n\t\t\t\t+ '&JS_EVENTS_MANAGER_ID=' + BX.util.urlencode(jsEventsManagerId)\n\t\t\t\t+ '&sessid=' + BX.bitrix_sessid(),\n\t\t\theight: Math.max(500, window.innerHeight - 400),\n\t\t\twidth: Math.max(800, window.innerWidth - 400),\n\t\t\tdraggable: true,\n\t\t\tresizable: true,\n\t\t\tmin_height: 500,\n\t\t\tmin_width: 800,\n\t\t\tzIndex: 800\n\t\t});\n\n\t\tEventEmitter.subscribe(popup, 'onWindowRegister', BX.defer(() => {\n\t\t\tpopup.Get().style.position = 'fixed';\n\t\t\tpopup.Get().style.top = (parseInt(popup.Get().style.top) - BX.GetWindowScrollPos().scrollTop) + 'px';\n\t\t\tpopup.OVERLAY.style.zIndex = 798;\n\t\t}));\n\n\t\tEventEmitter.subscribe(window, 'EntityProductListController:onInnerCancel', BX.defer(() => {\n\t\t\tpopup.Close();\n\t\t}));\n\n\t\tif (typeof BX.Crm.EntityEvent !== \"undefined\")\n\t\t{\n\t\t\tEventEmitter.subscribe(window, BX.Crm.EntityEvent.names.update, BX.defer(() => {\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tpopup.Close()\n\t\t\t\t}, 0);\n\t\t\t}));\n\t\t}\n\n\t\tpopup.Show();\n\t}\n\n\taddProductRow(): string\n\t{\n\t\tconst row = this.createGridProductRow();\n\t\tconst newId = row.getId();\n\t\tthis.initializeNewProductRow(newId);\n\n\t\treturn newId;\n\t}\n\n\thandleProductRowAdd(): void\n\t{\n\t\tconst id = this.addProductRow();\n\t\tthis.focusProductSelector(id);\n\t}\n\n\thandleShowSettingsPopup()\n\t{\n\t\tthis.getSettingsPopup().show();\n\t}\n\n\tdestroySettingsPopup()\n\t{\n\t\tif (this.cache.has('settings-popup'))\n\t\t{\n\t\t\tthis.cache.get('settings-popup').getPopup().destroy();\n\t\t\tthis.cache.delete('settings-popup');\n\t\t}\n\t}\n\n\tgetSettingsPopup()\n\t{\n\t\treturn this.cache.remember('settings-popup', () => {\n\t\t\treturn new SettingsPopup(\n\t\t\t\tthis.getContainer().querySelector('.crm-entity-product-list-add-block-active [data-role=\"product-list-settings-button\"]'),\n\t\t\t\tthis.getSettingValue('popupSettings', []),\n\t\t\t\tthis\n\t\t\t);\n\t\t});\n\t}\n\n\tgetHintPopup(): HintPopup\n\t{\n\t\treturn this.cache.remember('hint-popup', () => {\n\t\t\treturn new HintPopup(this);\n\t\t});\n\t}\n\n\tcreateGridProductRow(): BX.Grid.Row\n\t{\n\t\tconst newId = Text.getRandom();\n\t\tconst originalTemplate = this.redefineTemplateEditData(newId);\n\n\t\tconst grid = this.getGrid();\n\t\tlet newRow;\n\t\tif (this.getSettingValue('newRowPosition') === 'bottom')\n\t\t{\n\t\t\tnewRow = grid.appendRowEditor();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewRow = grid.prependRowEditor();\n\t\t}\n\n\t\tconst newNode = newRow.getNode();\n\n\t\tthis.setDeleteButton(newNode, newId);\n\n\t\tif (Type.isDomNode(newNode))\n\t\t{\n\t\t\tnewNode.setAttribute('data-id', newId);\n\t\t\tnewRow.makeCountable();\n\t\t}\n\n\t\tif (originalTemplate)\n\t\t{\n\t\t\tthis.setOriginalTemplateEditData(originalTemplate);\n\t\t}\n\n\t\tEventEmitter.emit('Grid::thereEditedRows', []);\n\n\t\tgrid.adjustRows();\n\t\tgrid.updateCounterDisplayed();\n\t\tgrid.updateCounterSelected();\n\n\t\treturn newRow;\n\t}\n\n\tsetDeleteButton(row, rowId)\n\t{\n\t\tif (this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst actionCellContentContainer = row.querySelector('.main-grid-cell-action .main-grid-cell-content');\n\t\tif (rowId)\n\t\t{\n\t\t\t// BX.Main.grid._onClickOnRow needs to be a link or input here\n\t\t\tconst deleteButton = Tag.render`\n\t\t\t\t<a \n\t\t\t\t\thref=\"#\"\n\t\t\t\t\tclass=\"main-grid-delete-button\" \n\t\t\t\t\tonclick=\"${this.handleDeleteRow.bind(this, rowId)}\"\n\t\t\t\t\ttitle=\"${Loc.getMessage('CRM_ENTITY_PL_DELETE')}\"\n\t\t\t\t></a>\n\t\t\t`;\n\t\t\tDom.append(deleteButton, actionCellContentContainer);\n\t\t}\n\t}\n\n\thandleDeleteRow(rowId, event: BaseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tthis.deleteRow(rowId);\n\t}\n\n\tredefineTemplateEditData(newId: string)\n\t{\n\t\tconst data = this.getGridEditData();\n\t\tconst originalTemplateData = data[GRID_TEMPLATE_ROW];\n\t\tconst customEditData = this.prepareCustomEditData(originalTemplateData, newId);\n\n\t\tthis.setOriginalTemplateEditData({...originalTemplateData, ...customEditData})\n\n\t\treturn originalTemplateData;\n\t}\n\n\tprepareCustomEditData(originalEditData, newId)\n\t{\n\t\tconst customEditData = {};\n\t\tconst templateIdMask = this.getSettingValue('templateIdMask', '');\n\n\t\tfor (let i in originalEditData)\n\t\t{\n\t\t\tif (originalEditData.hasOwnProperty(i))\n\t\t\t{\n\t\t\t\tif (Type.isStringFilled(originalEditData[i]) && originalEditData[i].indexOf(templateIdMask) >= 0)\n\t\t\t\t{\n\t\t\t\t\tcustomEditData[i] = originalEditData[i].replace(\n\t\t\t\t\t\tnew RegExp(templateIdMask, 'g'),\n\t\t\t\t\t\tnewId\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if (Type.isPlainObject(originalEditData[i]))\n\t\t\t\t{\n\t\t\t\t\tcustomEditData[i] = this.prepareCustomEditData(originalEditData[i], newId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcustomEditData[i] = originalEditData[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn customEditData;\n\t}\n\n\tinitializeNewProductRow(newId): Row\n\t{\n\t\tconst rowId = this.getRowIdPrefix() + newId;\n\t\tconst fields = {\n\t\t\t...this.getSettingValue('templateItemFields', {}),\n\t\t\t...{\n\t\t\t\tID: newId,\n\t\t\t\t// hack: specially reversed field to change it after (isChangedValue need to be true)\n\t\t\t\tTAX_INCLUDED: this.isTaxIncludedActive() ? 'N' : 'Y',\n\t\t\t\tCURRENCY: this.getCurrencyId()\n\t\t\t}\n\t\t};\n\n\t\tconst product = new Row(rowId, fields, {}, this);\n\t\tproduct.updateFieldValue('TAX_INCLUDED', this.isTaxIncludedActive());\n\n\t\tif (this.getSettingValue('newRowPosition') === 'bottom')\n\t\t{\n\t\t\tthis.products.push(product);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.products.unshift(product);\n\t\t}\n\n\t\tthis.refreshSortFields();\n\t\tthis.numerateRows();\n\n\t\tproduct.updateUiCurrencyFields();\n\t\tthis.updateTotalUiCurrency();\n\n\t\treturn product;\n\t}\n\n\tisTaxIncludedActive(): boolean\n\t{\n\t\treturn this.products\n\t\t\t.filter((product) => product.isTaxIncluded())\n\t\t\t.length > 0\n\t\t\t;\n\t}\n\n\tgetProductSelector(newId: string): ?ProductSelector\n\t{\n\t\treturn ProductSelector.getById('crm_grid_' + this.getRowIdPrefix() + newId);\n\t}\n\n\tfocusProductSelector(newId: string): void\n\t{\n\t\trequestAnimationFrame(() => {\n\t\t\tthis\n\t\t\t\t.getProductSelector(newId)\n\t\t\t\t?.searchInDialog()\n\t\t\t\t.focusName()\n\t\t\t;\n\t\t});\n\t}\n\n\thandleOnBeforeProductChange(event: BaseEvent)\n\t{\n\t\tconst data = event.getData();\n\t\tconst product = this.getProductByRowId(data.rowId);\n\t\tif (product)\n\t\t{\n\t\t\tthis.getGrid().tableFade();\n\t\t\tproduct.resetExternalActions();\n\t\t}\n\t}\n\n\thandleOnProductChange(event: BaseEvent)\n\t{\n\t\tconst data = event.getData();\n\n\t\tconst productRow = this.getProductByRowId(data.rowId);\n\t\tif (productRow && data.fields)\n\t\t{\n\t\t\tconst promise = new Promise((resolve, reject) => {\n\t\t\t\tconst fields = data.fields;\n\n\t\t\t\tif (this.getCurrencyId() !== fields['CURRENCY_ID'])\n\t\t\t\t{\n\t\t\t\t\tfields['CURRENCY'] = fields['CURRENCY_ID'];\n\n\t\t\t\t\tconst products = [{\n\t\t\t\t\t\tfields: data.fields,\n\t\t\t\t\t\tid: productRow.getId()\n\t\t\t\t\t}];\n\n\t\t\t\t\tajax.runComponentAction(\n\t\t\t\t\t\tthis.getComponentName(),\n\t\t\t\t\t\t'calculateProductPrices',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmode: 'class',\n\t\t\t\t\t\t\tsignedParameters: this.getSignedParameters(),\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tproducts,\n\t\t\t\t\t\t\t\tcurrencyId: this.getCurrencyId(),\n\t\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\t\tACTION: 'calculateProductPrices'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t).then(\n\t\t\t\t\t\t(response) => {\n\t\t\t\t\t\t\tconst changedFields = response.data.result[productRow.getId()];\n\t\t\t\t\t\t\tif (changedFields)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tchangedFields['CUSTOMIZED'] = 'Y';\n\t\t\t\t\t\t\t\tresolve(Object.assign(fields, changedFields));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresolve(fields);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresolve(fields);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tpromise.then((fields) => {\n\t\t\t\tObject.keys(fields).forEach((key) => {\n\t\t\t\t\tproductRow.updateFieldValue(key, fields[key]);\n\t\t\t\t});\n\n\t\t\t\tif (!Type.isStringFilled(fields['CUSTOMIZED']))\n\t\t\t\t{\n\t\t\t\t\tproductRow.setField('CUSTOMIZED', 'N');\n\t\t\t\t}\n\n\t\t\t\tproductRow.setField('IS_NEW', data.isNew ? 'Y' : 'N');\n\n\t\t\t\tproductRow.initHandlersForProductSelector();\n\t\t\t\tproductRow.executeExternalActions();\n\t\t\t\tthis.getGrid().tableUnfade();\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getGrid().tableUnfade();\n\t\t}\n\t}\n\n\thandleOnProductClear(event: BaseEvent)\n\t{\n\t\tconst {rowId} = event.getData();\n\n\t\tconst product = this.getProductByRowId(rowId);\n\t\tif (product)\n\t\t{\n\t\t\tproduct.initHandlersForProductSelector();\n\t\t\tproduct.changePrice(0);\n\t\t\tproduct.executeExternalActions();\n\t\t}\n\t}\n\n\tcompileProductData(): void\n\t{\n\t\tif (!this.isExistForm())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.initFormFields();\n\n\t\tconst field = this.getDataField();\n\t\tconst settingsField = this.getDataSettingsField();\n\n\t\tthis.cleanProductRows();\n\n\t\tif (Type.isElementNode(field) && Type.isElementNode(settingsField))\n\t\t{\n\t\t\tfield.value = this.prepareProductDataValue();\n\n\t\t\tsettingsField.value = JSON.stringify({\n\t\t\t\tENABLE_DISCOUNT: this.getDiscountEnabled(),\n\t\t\t\tENABLE_TAX: this.getTaxEnabled()\n\t\t\t});\n\t\t}\n\n\t\tthis.addFirstRowIfEmpty();\n\t}\n\n\tprepareProductDataValue(): string\n\t{\n\t\tlet productDataValue = '';\n\n\t\tif (this.getProductCount())\n\t\t{\n\t\t\tconst productData = [];\n\n\t\t\tthis.products.forEach((item) => {\n\t\t\t\tconst itemFields = item.getFields();\n\n\t\t\t\tif (!/^[0-9]+$/.test(itemFields['ID']))\n\t\t\t\t{\n\t\t\t\t\titemFields['ID'] = 0;\n\t\t\t\t}\n\n\t\t\t\titemFields['CUSTOMIZED'] = 'Y';\n\n\t\t\t\tproductData.push(itemFields);\n\t\t\t});\n\n\t\t\tproductDataValue = JSON.stringify(productData);\n\t\t}\n\n\t\treturn productDataValue;\n\t}\n\n\t/* actions */\n\texecuteActions(actions)\n\t{\n\t\tif (!Type.isArrayFilled(actions))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst disableSaveButton = actions\n\t\t\t.filter((action) => action.type === this.actions.updateTotal)\n\t\t\t.length > 0\n\t\t;\n\n\t\tfor (let item of actions)\n\t\t{\n\t\t\tif (\n\t\t\t\t!Type.isPlainObject(item)\n\t\t\t\t|| !Type.isStringFilled(item.type)\n\t\t\t)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tswitch (item.type)\n\t\t\t{\n\t\t\t\tcase this.actions.productChange:\n\t\t\t\t\tthis.actionSendProductChange(item, disableSaveButton);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase this.actions.productListChanged:\n\t\t\t\t\tthis.actionSendProductListChanged(disableSaveButton);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase this.actions.updateListField:\n\t\t\t\t\tthis.actionUpdateListField(item);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase this.actions.updateTotal:\n\t\t\t\t\tthis.actionUpdateTotalData();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase this.actions.stateChanged:\n\t\t\t\t\tthis.actionSendStatusChange(item);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tactionSendProductChange(item, disableSaveButton)\n\t{\n\t\tif (!Type.isStringFilled(item.id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst product = this.getProductByRowId(item.id);\n\t\tif (!product)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEventEmitter.emit(this, 'ProductList::onChangeFields', {\n\t\t\trowId: item.id,\n\t\t\tproductId: product.getField('PRODUCT_ID'),\n\t\t\tfields: this.getProductByRowId(item.id).getCatalogFields()\n\t\t});\n\n\t\tif (this.controller)\n\t\t{\n\t\t\tthis.controller.productChange(disableSaveButton);\n\t\t}\n\t}\n\n\tactionSendProductListChanged(disableSaveButton: boolean = false): void\n\t{\n\t\tif (this.controller)\n\t\t{\n\t\t\tthis.controller.productChange(disableSaveButton);\n\t\t}\n\t}\n\n\tactionUpdateListField(item)\n\t{\n\t\tif (!Type.isStringFilled(item.field) || !('value' in item))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.allowUpdateListField(item.field))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateFieldForList = item.field;\n\n\t\tfor (let row of this.products)\n\t\t{\n\t\t\trow.updateFieldByName(item.field, item.value);\n\t\t}\n\n\t\tthis.updateFieldForList = null;\n\t}\n\n\tactionUpdateTotalData(options = {})\n\t{\n\t\tif (this.totalData.inProgress)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateTotalDataDelayedHandler(options);\n\t}\n\n\tactionSendStatusChange(item)\n\t{\n\t\tif (!('value' in item))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.stateChange.changed === item.value)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.stateChange.changed = item.value;\n\t\tif (this.stateChange.sended)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.stateChange.sended = true;\n\t}\n\n\t/* actions finish */\n\n\t/* action tools */\n\tallowUpdateListField(field)\n\t{\n\t\tif (this.updateFieldForList !== null)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet result = true;\n\n\t\tswitch (field)\n\t\t{\n\t\t\tcase 'TAX_INCLUDED':\n\t\t\t\tresult = this.isTaxUniform() && this.isTaxAllowed();\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tupdateTotalDataDelayed(options = {})\n\t{\n\t\tif (this.totalData.inProgress)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.totalData.inProgress = true;\n\n\t\tconst products = this.getProductsFields(this.getProductFieldListForTotalData());\n\t\tproducts.forEach(item => item['CUSTOMIZED'] = 'Y');\n\n\t\tthis.ajaxRequest('calculateTotalData', {\n\t\t\toptions,\n\t\t\tproducts,\n\t\t\tcurrencyId: this.getCurrencyId()\n\t\t});\n\t}\n\n\tgetProductsFields(fields: Array = [])\n\t{\n\t\tconst productFields = [];\n\n\t\tfor (let item of this.products)\n\t\t{\n\t\t\tproductFields.push(item.getFields(fields));\n\t\t}\n\n\t\treturn productFields;\n\t}\n\n\tgetProductFieldListForTotalData()\n\t{\n\t\treturn [\n\t\t\t'PRODUCT_ID',\n\t\t\t'PRODUCT_NAME',\n\t\t\t'QUANTITY',\n\t\t\t'DISCOUNT_TYPE_ID',\n\t\t\t'DISCOUNT_RATE',\n\t\t\t'DISCOUNT_SUM',\n\t\t\t'TAX_RATE',\n\t\t\t'TAX_INCLUDED',\n\t\t\t'PRICE_EXCLUSIVE',\n\t\t\t'PRICE',\n\t\t\t'CUSTOMIZED'\n\t\t];\n\t}\n\n\tsetTotalData(data, options = {})\n\t{\n\t\tconst item = BX(this.getSettingValue('totalBlockContainerId', null));\n\t\tif (Type.isElementNode(item))\n\t\t{\n\t\t\tconst currencyId = this.getCurrencyId();\n\t\t\tconst list = ['totalCost', 'totalDelivery', 'totalTax', 'totalWithoutTax', 'totalDiscount', 'totalWithoutDiscount'];\n\n\t\t\tfor (const id of list)\n\t\t\t{\n\t\t\t\tconst row = item.querySelector('[data-total=\"' + id + '\"]');\n\n\t\t\t\tif (Type.isElementNode(row) && (id in data))\n\t\t\t\t{\n\t\t\t\t\trow.innerHTML = CurrencyCore.currencyFormat(data[id], currencyId, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sendTotalData(data, options);\n\t\tthis.totalData.inProgress = false;\n\t}\n\n\tsendTotalData(data, options)\n\t{\n\t\tif (this.controller)\n\t\t{\n\t\t\tlet needMarkAsChanged = true;\n\t\t\tif (\n\t\t\t\tType.isObject(options)\n\t\t\t\t&& (options.isInternalChanging === true || options.isInternalChanging === 'true')\n\t\t\t)\n\t\t\t{\n\t\t\t\tneedMarkAsChanged = false;\n\t\t\t}\n\n\t\t\tthis.controller.changeSumTotal(data, needMarkAsChanged);\n\t\t}\n\t}\n\n\t/* action tools finish */\n\n\t/* ajax tools */\n\tajaxRequest(action, data)\n\t{\n\t\tif (!Type.isPlainObject(data.options))\n\t\t{\n\t\t\tdata.options = {};\n\t\t}\n\t\tdata.options.ACTION = action;\n\t\tajax.runComponentAction(\n\t\t\tthis.getComponentName(),\n\t\t\taction,\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this.getSignedParameters(),\n\t\t\t\tdata: data\n\t\t\t}\n\t\t).then(\n\t\t\t(response) => this.ajaxResultSuccess(response, data.options),\n\t\t\t(response) => this.ajaxResultFailure(response)\n\t\t);\n\t}\n\n\tajaxResultSuccess(response, requestOptions)\n\t{\n\t\tif (!this.ajaxResultCommonCheck(response))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (response.data.action)\n\t\t{\n\t\t\tcase 'calculateTotalData':\n\t\t\t\tif (Type.isPlainObject(response.data.result))\n\t\t\t\t{\n\t\t\t\t\tthis.setTotalData(response.data.result, requestOptions);\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'calculateProductPrices':\n\t\t\t\tif (Type.isPlainObject(response.data.result))\n\t\t\t\t{\n\t\t\t\t\tthis.onCalculatePricesResponse(response.data.result);\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tajaxResultFailure(response)\n\t{\n\n\t}\n\n\tajaxResultCommonCheck(responce)\n\t{\n\t\tif (!Type.isPlainObject(responce))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!Type.isStringFilled(responce.status))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (responce.status !== 'success')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!Type.isPlainObject(responce.data))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!Type.isStringFilled(responce.data.action))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\t// noinspection RedundantIfStatementJS\n\t\tif (!('result' in responce.data))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tdeleteRow(rowId: string, skipActions: boolean = false): void\n\t{\n\t\tif (!Type.isStringFilled(rowId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst gridRow = this.getGrid().getRows().getById(rowId);\n\t\tif (gridRow)\n\t\t{\n\t\t\tDom.remove(gridRow.getNode());\n\t\t\tthis.getGrid().getRows().reset();\n\t\t}\n\n\t\tconst productRow = this.getProductById(rowId);\n\t\tif (productRow)\n\t\t{\n\t\t\tconst index = this.products.indexOf(productRow);\n\t\t\tif (index > -1)\n\t\t\t{\n\t\t\t\tthis.products.splice(index, 1);\n\t\t\t\tthis.refreshSortFields();\n\t\t\t\tthis.numerateRows();\n\t\t\t}\n\t\t}\n\n\t\tEventEmitter.emit('Grid::thereEditedRows', []);\n\n\t\tif (!skipActions)\n\t\t{\n\t\t\tthis.addFirstRowIfEmpty();\n\t\t\tthis.executeActions([\n\t\t\t\t{type: this.actions.productListChanged},\n\t\t\t\t{type: this.actions.updateTotal}\n\t\t\t]);\n\t\t}\n\t}\n\n\tcleanProductRows(): void\n\t{\n\t\tthis.products\n\t\t\t.filter(item => item.isEmpty())\n\t\t\t.forEach((row) => this.deleteRow(row.getField('ID'), true))\n\t\t;\n\t}\n\n\tresortProductsByIds(ids: Array): boolean\n\t{\n\t\tlet changed = false;\n\n\t\tif (Type.isArrayFilled(ids))\n\t\t{\n\t\t\tthis.products.sort((a, b) => {\n\t\t\t\tif (ids.indexOf(a.getField('ID')) > ids.indexOf(b.getField('ID')))\n\t\t\t\t{\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\n\t\t\t\tchanged = true;\n\n\t\t\t\treturn -1;\n\t\t\t});\n\t\t}\n\n\t\treturn changed;\n\t}\n\n\trefreshSortFields(): void\n\t{\n\t\tthis.products.forEach((item, index) => item.setField('SORT', (index + 1) * 10));\n\t}\n\n\thandleOnTabShow(): void\n\t{\n\t\tEventEmitter.emit('onDemandRecalculateWrapper');\n\t}\n}"],"names":["HintPopup","editor","node","text","hintPopup","Popup","getId","darkMode","closeIcon","animation","setBindElement","adjustPosition","setContent","Tag","render","Text","encode","show","close","MODE_EDIT","MODE_SET","Row","id","fields","settings","Cache","MemoryCache","setId","setFields","setSettings","setEditor","requestAnimationFrame","initHandlers","bind","cache","remember","rowId","getField","getEditorContainer","querySelector","Type","isPlainObject","name","defaultValue","hasOwnProperty","value","getEditor","getContainer","getHintPopup","getNode","querySelectorAll","forEach","Event","changeProductFieldHandler","event","stopPropagation","number","textContent","result","isArrayFilled","Runtime","clone","fieldName","fixedProductName","isStringFilled","getFields","getBasePrice","getTaxIncluded","getTaxId","getPrice","getPriceExclusive","getPriceNetto","getPriceBrutto","getQuantity","getDiscountType","getDiscountRate","getDiscountSum","getDiscountRow","getTaxRate","setField","field","isPriceNetto","isTaxAllowed","isTaxIncluded","DiscountType","UNDEFINED","PERCENTAGE","MONETARY","isDiscountPercentage","isDiscountMonetary","isDiscountUndefined","taxNode","getTaxNode","isDomNode","options","selectedIndex","toNumber","getAttribute","fieldCode","target","type","checked","mode","updateField","resetExternalActions","updateFieldValue","executeExternalActions","code","changeProductId","changePrice","changeQuantity","changeMeasureCode","changeDiscount","changeDiscountType","changeRowDiscount","changeTaxId","changeTaxRate","changeTaxIncluded","changeRowSum","changeProductName","changeSort","setTaxIncluded","preparedValue","parseInt","setProductId","parseFloat","getPricePrecision","setPrice","getQuantityPrecision","setQuantity","getMeasures","filter","item","CODE","setMeasure","getCommonPrecision","toFixed","setDiscount","setDiscountType","setRowDiscount","taxList","getTaxList","taxRate","find","ID","VALUE","setTaxRate","isBoolean","setRowSum","toString","isChangedValue","addActionProductChange","exceptFields","includes","updateUiField","calculator","ProductCalculator","getCalculateFields","getSettings","addActionUpdateTotal","originalPrice","Math","max","updateUiInputField","calculatedFields","getCalculator","calculatePrice","refreshFieldsLayout","calculateQuantity","measure","SYMBOL","updateUiMoneyField","isDiscountHandmade","calculateDiscount","calculateDiscountType","calculateRowDiscount","calculateTax","updateUiCheckboxField","calculateTaxIncluded","addActionUpdateFieldList","calculateRowSum","fieldId","getUiFieldId","document","getElementById","isElementNode","getInputByFieldName","getCurrencyText","Reflection","getClass","BX","Main","dropdownManager","getById","dropdown","getValue","menu","itemsContainer","menuItem","getMenuItem","refresh","selectItem","dataset","span","innerHTML","dropdownApi","getMoneyFieldDropdownApi","updateMoneyFieldUiWithDropdownApi","updateMoneyFieldUiManually","html","currencyText","currencyId","getCurrencyId","currencyFieldNames","dropdownValues","push","NAME","Dom","attr","uiName","getUiFieldName","uiType","getUiFieldType","allowUpdateUiField","isNumber","updateUiDiscountTypeField","updateUiHtmlField","CurrencyCore","currencyFormat","precision","externalActions","length","action","addExternalAction","actions","productChange","updateListField","stateChanged","updateTotal","executeActions","trim","showNegative","load","Loc","getMessage","PageEventsManager","_settings","eventHandlers","eventName","eventHandler","addCustomEvent","eventParams","onCustomEvent","i","removeCustomEvent","SettingsPopup","getPopup","random","autoHide","draggable","offsetLeft","offsetTop","angle","position","offset","noAllPaddings","bindOptions","forceBindPosition","closeByEsc","content","popupContainer","getContentContainer","isArray","columns","allColumnsExist","columnName","getGrid","getColumnHeaderCellByName","checkbox","append","input","settingId","descriptionNode","desc","setting","title","_classPrivateMethodGet","settingItem","settingEnabled","enabled","headers","cells","getRows","getHeadFirstChild","getCells","Array","from","header","ajax","runComponentAction","getComponentName","data","signedParameters","getSignedParameters","selected","currentHeaders","then","panel","setSettingValue","activePanel","changeActivePanelButtons","settingButton","reloadGrid","message","replace","category","UI","Notification","Center","notify","stack","width","autoHideDelay","GRID_TEMPLATE_ROW","DEFAULT_PRECISION","Editor","productListChanged","changed","sended","inProgress","handleProductSelectionPopup","handleProductRowAdd","handleShowSettingsPopup","handleOnDialogSelectProduct","handleOnSave","handleEditorSubmit","handleOnInnerCancel","handleOnBeforeGridRequest","handleOnGridUpdated","handleOnGridRowMoved","handleOnBeforeProductChange","handleOnProductChange","handleOnProductClear","handleDropdownChange","handleFieldChange","debounce","updateTotalDataDelayed","config","canEdit","addFirstRowIfEmpty","enableEdit","initForm","initProducts","initGridData","EventEmitter","emit","window","subscribeDomEvents","subscribeCustomEvents","container","selectButton","productSelectionPopupHandler","addButton","productRowAddHandler","configButton","showSettingsPopupHandler","unbind","subscribe","onDialogSelectProductHandler","onSaveHandler","onEditorSubmit","onInnerCancelHandler","onBeforeGridRequestHandler","onGridUpdatedHandler","onGridRowMovedHandler","onBeforeProductChangeHandler","onProductChangeHandler","onProductClearHandler","dropdownChangeHandler","unsubscribe","getCompatData","productId","addProductRow","selectProductInRow","getProductSelector","onProductSelect","items","products","product","ROW_ID","isLocationDependantTaxesEnabled","entityData","getData","getLocationId","setLocationId","controller","rollback","panelCode","removeClass","addClass","hiddenPanelCode","removePanel","useProductsFromRequest","isInternalChanging","reloadTable","actionUpdateTotalData","grid","eventArgs","parent","getGridId","isNativeAction","url","getReloadUrl","method","sessid","bitrix_sessid","getProductsFields","locationId","clearEditor","subscribeOnce","getSettingsPopup","updateCheckboxState","ids","resortProductsByIds","refreshSortFields","numerateRows","componentId","getSettingValue","pageEventsManager","initPageEventsManager","rows","current","isHeadChild","isTemplate","edit","getCountDisplayed","unsubscribeProductsEvents","productsWasInitiated","destroySettingsPopup","unsubscribeDomEvents","unsubscribeCustomEvents","unbindAll","productSelector","unsubscribeEvents","setForm","clearController","clearProductList","readOnly","setCurrencyId","ajaxRequest","editData","getGridEditData","templateRow","templateFieldNames","setGridEditData","isObject","newPrice","updateUiCurrencyFields","updateTotalUiCurrency","totalBlock","row","format","getCurrencyFormat","FORMAT_STRING","getDataFieldName","getTaxAllowed","getTaxEnabled","isNumberValue","isStringValue","isNegative","indexOf","isNaN","dot","comma","s1","substr","decimalLength","round","factor","pow","price","discount","discountType","discountRate","getContainerId","formId","form","getForm","getDataField","initDataField","settingsField","getDataSettingsField","initDataSettingsField","appendChild","create","attrs","remove","initFormField","getDataSettingsFieldName","getFormField","isEmpty","list","setDeleteButton","index","setRowNumber","gridId","Error","gridManager","getInstanceById","gridEditData","arParams","EDITABLE_DATA","closest","hasAttribute","getProductById","cell","getFieldCodeByGridCell","updateFieldByEvent","dropdownId","regExp","RegExp","getRowIdPrefix","matches","match","getProductByRowId","headRow","getCellNameByCellIndex","caller","jsEventsManagerId","popup","CDialog","content_url","util","urlencode","height","innerHeight","innerWidth","resizable","min_height","min_width","zIndex","defer","Get","style","top","GetWindowScrollPos","scrollTop","OVERLAY","Close","Crm","EntityEvent","names","update","Show","createGridProductRow","newId","initializeNewProductRow","focusProductSelector","has","get","destroy","delete","getRandom","originalTemplate","redefineTemplateEditData","newRow","appendRowEditor","prependRowEditor","newNode","setAttribute","makeCountable","setOriginalTemplateEditData","adjustRows","updateCounterDisplayed","updateCounterSelected","isReadOnly","actionCellContentContainer","deleteButton","handleDeleteRow","preventDefault","deleteRow","originalTemplateData","customEditData","prepareCustomEditData","originalEditData","templateIdMask","TAX_INCLUDED","isTaxIncludedActive","CURRENCY","unshift","ProductSelector","searchInDialog","focusName","tableFade","productRow","promise","Promise","resolve","reject","ACTION","response","changedFields","Object","assign","keys","key","isNew","initHandlersForProductSelector","tableUnfade","isExistForm","initFormFields","cleanProductRows","prepareProductDataValue","JSON","stringify","ENABLE_DISCOUNT","getDiscountEnabled","ENABLE_TAX","productDataValue","getProductCount","productData","itemFields","test","disableSaveButton","actionSendProductChange","actionSendProductListChanged","actionUpdateListField","actionSendStatusChange","getCatalogFields","allowUpdateListField","updateFieldForList","updateFieldByName","totalData","updateTotalDataDelayedHandler","stateChange","isTaxUniform","getProductFieldListForTotalData","productFields","sendTotalData","needMarkAsChanged","changeSumTotal","ajaxResultSuccess","ajaxResultFailure","requestOptions","ajaxResultCommonCheck","setTotalData","onCalculatePricesResponse","responce","status","skipActions","gridRow","reset","splice","sort","a","b"],"mappings":"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"}