{"version":3,"file":"script.js","sources":["src/js/deal.onboarding.manager.js","src/js/deal.manager.js"],"sourcesContent":["//@flow\nimport {userOptions, Loc, Dom, Event} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Guide} from 'ui.tour';\nimport 'spotlight';\nimport {PopupWindowManager} from \"main.popup\";\n\nexport type OnboardingData = {\n\tchain: number;\n\tchainStep: number;\n\tsuccessDealGuideIsOver: boolean;\n};\n\ntype Params = {\n\tonboardingData: OnboardingData;\n\tcontentContainer: HTMLElement;\n\tserviceUrl: string;\n\tdealDetailManager: BX.Crm.DealDetailManager;\n};\n\nexport class DealOnboardingManager\n{\n\t#onboardingData: OnboardingData;\n\t#contentContainer: HTMLElement;\n\t#serviceUrl: string;\n\t#dealDetailManager: BX.Crm.DealDetailManager;\n\n\t#activeDocumentGuide: Guide|null = null;\n\n\tstatic get productsTabId(): string\n\t{\n\t\treturn 'tab_products';\n\t}\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#onboardingData = params.onboardingData;\n\t\tthis.#contentContainer = params.contentContainer;\n\t\tthis.#serviceUrl = params.serviceUrl;\n\t\tthis.#dealDetailManager = params.dealDetailManager;\n\t}\n\n\t#getContentContainer(): HTMLElement\n\t{\n\t\treturn this.#contentContainer;\n\t}\n\n\t#getButtonsContainer(): HTMLElement\n\t{\n\t\treturn this.#getContentContainer().querySelector('.main-buttons');\n\t}\n\n\t#isHintCanBeShown(): boolean\n\t{\n\t\tif (PopupWindowManager && PopupWindowManager.isAnyPopupShown())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprocessOnboarding(): void\n\t{\n\t\tif (!this.#isHintCanBeShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst chain = this.#onboardingData.chain;\n\t\tconst step = this.#onboardingData.chainStep;\n\t\tconst successDealGuideIsOver = this.#onboardingData.successDealGuideIsOver;\n\n\t\tif (chain === 0)\n\t\t{\n\t\t\tif (step < 1)\n\t\t\t{\n\t\t\t\tthis.#processProductTabHint();\n\t\t\t}\n\t\t\tif (step < 2)\n\t\t\t{\n\t\t\t\tthis.#hintProductListField();\n\t\t\t}\n\t\t}\n\t\telse if (chain === 1 && step === 0)\n\t\t{\n\t\t\tthis.#hintAddDocumentLink();\n\t\t}\n\n\t\tif (!successDealGuideIsOver)\n\t\t{\n\t\t\tthis.#hintSuccessDealDocumentInTimeline();\n\t\t}\n\t}\n\n\t#processProductTabHint(): void\n\t{\n\t\tconst guideText = {\n\t\t\ttitle: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_AUTOMATIC_RESERVATION_GUIDE_TITLE'),\n\t\t\ttext: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_AUTOMATIC_RESERVATION_GUIDE_TEXT'),\n\t\t};\n\n\t\tif (this.#dealDetailManager.isTabButtonVisible(DealOnboardingManager.productsTabId))\n\t\t{\n\t\t\tthis.#hintToVisibleProductTab();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#hintToHiddenProductTab();\n\t\t}\n\t}\n\n\t#createHintToProductTab(target: HTMLElement, guideEvents: Object = {}): Guide\n\t{\n\t\tconst guideText = {\n\t\t\ttitle: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_AUTOMATIC_RESERVATION_GUIDE_TITLE'),\n\t\t\ttext: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_AUTOMATIC_RESERVATION_GUIDE_TEXT'),\n\t\t};\n\n\t\treturn new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: target,\n\t\t\t\t\ttitle: guideText.title,\n\t\t\t\t\ttext: guideText.text,\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\tevents: guideEvents\n\t\t\t\t}\n\t\t\t],\n\t\t\tonEvents: true\n\t\t});\n\t}\n\n\t#hintToVisibleProductTab(): void\n\t{\n\t\tconst productsTabButton = this.#dealDetailManager.getTabMenuItemContainer(DealOnboardingManager.productsTabId);\n\n\t\tconst productsTabGuide = this.#createHintToProductTab(\n\t\t\tproductsTabButton,\n\t\t\t{\n\t\t\t\tonClose: () => {\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'firstChainStage', 1);\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t\tproductsTabGuide.showNextStep();\n\t\tconst tabsContainer = this.#dealDetailManager.getTabManager().getTabMenuContainer();\n\n\t\tconst windowResizeHandler = () => {\n\t\t\tif (!this.#dealDetailManager.isTabButtonVisible(DealOnboardingManager.productsTabId))\n\t\t\t{\n\t\t\t\tproductsTabGuide.close();\n\t\t\t\tEvent.unbind(window, 'resize', windowResizeHandler);\n\t\t\t}\n\t\t};\n\n\t\tEvent.bind(window, 'resize', windowResizeHandler);\n\t\tEvent.bindOnce(tabsContainer, 'mousedown', () => {\n\t\t\tproductsTabGuide.close();\n\t\t\tEvent.unbind(window, 'resize', windowResizeHandler);\n\t\t});\n\t}\n\n\t#hintToHiddenProductTab(): void\n\t{\n\t\tconst moreButton = this.#dealDetailManager.getTabManager().getMoreButton();\n\t\tconst spotlight = new BX.SpotLight(\n\t\t\t{\n\t\t\t\tid: `${DealOnboardingManager.productsTabId}_spotlight`,\n\t\t\t\ttargetElement: moreButton,\n\t\t\t\tautoSave: true,\n\t\t\t\ttargetVertex: \"middle-center\",\n\t\t\t\tzIndex: 200,\n\t\t\t}\n\t\t);\n\t\tspotlight.show();\n\t\tspotlight.container.style.pointerEvents = \"none\";\n\n\t\tconst onOpenMoreMenuHandler = (event) => {\n\t\t\tconst eventMoreMenu = event.target.getMoreMenu();\n\t\t\tconst dealMoreMenu = this.#dealDetailManager.getTabManager().getMoreMenu();\n\n\t\t\tif (eventMoreMenu === dealMoreMenu)\n\t\t\t{\n\t\t\t\tspotlight.close();\n\t\t\t\tconst productsTabGuide = this.#createHintToProductTab(\n\t\t\t\t\tthis.#dealDetailManager.getTabFromMoreMenu(DealOnboardingManager.productsTabId)\n\t\t\t\t);\n\n\t\t\t\tconst moreMenuContainer = eventMoreMenu.getMenuContainer();\n\n\t\t\t\tconst tabHintTimeout = setTimeout(() => {\n\t\t\t\t\tproductsTabGuide.showNextStep();\n\n\t\t\t\t\tBX.bindOnce(moreMenuContainer, 'click', moreMenuClickHandler);\n\n\t\t\t\t\tconst productsTabPopup = productsTabGuide.getPopup();\n\t\t\t\t\tEventEmitter.subscribeOnce(productsTabPopup, 'onClose', onPopupCloseHandler);\n\n\t\t\t\t\tconst popupContainer = productsTabGuide.getPopup().getContentContainer().parentNode;\n\t\t\t\t\tBX.bind(popupContainer, 'mouseenter', () => {\n\t\t\t\t\t\tevent.target.showMoreMenu();\n\t\t\t\t\t});\n\t\t\t\t\tBX.bind(popupContainer, 'mouseleave', () => {\n\t\t\t\t\t\tconst outOfPopupTimeout = setTimeout(() => {\n\t\t\t\t\t\t\tevent.target.closeMoreMenu();\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t\tEvent.bindOnce(dealMoreMenu.getMenuContainer(), 'mouseenter', () => {\n\t\t\t\t\t\t\tclearTimeout(outOfPopupTimeout);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}, 50);\n\n\n\t\t\t\tconst onPopupCloseHandler = (event) => {\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'firstChainStage', 1);\n\n\t\t\t\t\tEvent.unbind(window, 'resize', windowResizeHandler);\n\t\t\t\t\tEvent.unbind(moreMenuContainer, 'click', moreMenuClickHandler);\n\t\t\t\t\tEventEmitter.unsubscribe('BX.Main.InterfaceButtons:onMoreMenuShow', onOpenMoreMenuHandler);\n\t\t\t\t};\n\n\n\t\t\t\tconst moreMenuClickHandler = () => {\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'firstChainStage', 1);\n\t\t\t\t\tproductsTabGuide.close();\n\t\t\t\t};\n\t\t\t\tEvent.bind(dealMoreMenu.getMenuContainer(), 'click', onPopupCloseHandler);\n\n\t\t\t\tEventEmitter.subscribeOnce('BX.Main.InterfaceButtons:onMoreMenuClose', (event) => {\n\t\t\t\t\tconst eventMoreMenu = event.target.getMoreMenu();\n\t\t\t\t\tconst dealMoreMenu = this.#dealDetailManager.getTabManager().getMoreMenu();\n\n\t\t\t\t\tif (eventMoreMenu === dealMoreMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tclearTimeout(tabHintTimeout);\n\t\t\t\t\t\tEvent.unbind(moreMenuContainer, 'click', moreMenuClickHandler);\n\t\t\t\t\t\tproductsTabGuide.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tEventEmitter.subscribe('BX.Main.InterfaceButtons:onMoreMenuShow', onOpenMoreMenuHandler);\n\n\t\tconst windowResizeHandler = () => {\n\t\t\tif (this.#dealDetailManager.isTabButtonVisible(DealOnboardingManager.productsTabId))\n\t\t\t{\n\t\t\t\tspotlight.close();\n\t\t\t\tthis.#hintToVisibleProductTab();\n\t\t\t\tEvent.unbind(window, 'resize', windowResizeHandler);\n\t\t\t\tEventEmitter.unsubscribe('BX.Main.InterfaceButtons:onMoreMenuShow', onOpenMoreMenuHandler);\n\t\t\t}\n\t\t}\n\t\tEvent.bind(window, 'resize', windowResizeHandler);\n\t}\n\n\t#hintProductListField(): void\n\t{\n\t\tconst buttonsContainer = this.#getContentContainer().querySelector('.main-buttons');\n\t\tconst productListTabListener = (event) => {\n\t\t\tconst [productListEditor] = event.data;\n\n\t\t\tconst buttonsPanelListener = () => {\n\t\t\t\tconst activeHint = productListEditor.getActiveHint();\n\t\t\t\tif (activeHint !== null)\n\t\t\t\t{\n\t\t\t\t\tactiveHint.close();\n\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', buttonsPanelListener);\n\t\t\t\t}\n\t\t\t}\n\t\t\tEvent.bind(buttonsContainer, 'click', buttonsPanelListener);\n\n\t\t\tconst productList = productListEditor.products;\n\t\t\tlet rowId = '';\n\t\t\tif (productList instanceof Array)\n\t\t\t{\n\t\t\t\tconst firstProductRow = productList.find((row) => !row.getModel().isService());\n\t\t\t\tif (firstProductRow)\n\t\t\t\t{\n\t\t\t\t\trowId = firstProductRow.getId();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!rowId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tproductListEditor.showFieldTourHint(\n\t\t\t\t'STORE_INFO',\n\t\t\t\t{\n\t\t\t\t\ttitle: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_PRODUCT_STORE_GUIDE_TITLE'),\n\t\t\t\t\ttext: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_PRODUCT_STORE_GUIDE_TEXT'),\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'firstChainStage', 2);\n\t\t\t\t\tBX.ajax.post(\n\t\t\t\t\t\tthis.#serviceUrl,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tACTION: 'FIX_FIRST_ONBOARD_CHAIN_VIEW',\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', buttonsPanelListener);\n\n\t\t\t\t\tEventEmitter.unsubscribe(\n\t\t\t\t\t\t'onDemandRecalculateWrapper',\n\t\t\t\t\t\tproductListTabListener\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t['RESERVE_INFO'],\n\t\t\t\trowId\n\t\t\t);\n\t\t}\n\n\t\tEventEmitter.subscribe(\n\t\t\t'onDemandRecalculateWrapper',\n\t\t\tproductListTabListener\n\t\t);\n\t}\n\n\t#hintAddDocumentLink()\n\t{\n\t\tconst documentsListTourListener = (event) => {\n\t\t\tif (this.#activeDocumentGuide !== null)\n\t\t\t{\n\t\t\t\tthis.#activeDocumentGuide.close();\n\t\t\t}\n\n\t\t\tconst buttonsContainer = this.#getButtonsContainer();\n\t\t\tconst sumControlContainer = document.querySelector('[data-cid=\"OPPORTUNITY_WITH_CURRENCY\"]');\n\t\t\tconst addDocumentButton = sumControlContainer && sumControlContainer.querySelector('.crm-entity-widget-payment-add-box');\n\t\t\tif (addDocumentButton !== null) {\n\t\t\t\tconst settingsButton = sumControlContainer.querySelector('.ui-entity-editor-block-context-menu');\n\t\t\t\tconst dragButton = sumControlContainer.querySelector('.ui-entity-editor-draggable-btn');\n\t\t\t\tconst guideText = {\n\t\t\t\t\ttitle: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_ADD_DOCUMENT_GUIDE_TITLE'),\n\t\t\t\t\ttext: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_ADD_DOCUMENT_GUIDE_TEXT'),\n\t\t\t\t};\n\n\t\t\t\tconst addDocumentGuide = new Guide({\n\t\t\t\t\tsteps: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttarget: addDocumentButton,\n\t\t\t\t\t\t\ttitle: guideText.title,\n\t\t\t\t\t\t\ttext: guideText.text,\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', userCloseHintHandler);\n\t\t\t\t\t\t\t\t\tEvent.unbind(settingsButton, 'click', userCloseHintHandler);\n\t\t\t\t\t\t\t\t\tEvent.unbind(dragButton, 'mousedown', userCloseHintHandler);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tonEvents: true\n\t\t\t\t});\n\t\t\t\tthis.#activeDocumentGuide = addDocumentGuide;\n\n\t\t\t\tconst userCloseHintHandler = () => {\n\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', userCloseHintHandler);\n\t\t\t\t\tEventEmitter.unsubscribe(\n\t\t\t\t\t\t'PaymentDocuments.EntityEditor:changeDocuments',\n\t\t\t\t\t\tdocumentsListTourListener\n\t\t\t\t\t);\n\n\t\t\t\t\taddDocumentGuide.close();\n\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'secondChainStage', 1);\n\n\t\t\t\t}\n\n\t\t\t\taddDocumentGuide.showNextStep();\n\t\t\t\tEvent.bind(addDocumentGuide.getPopup().closeIcon, 'click', userCloseHintHandler);\n\t\t\t\tEvent.bind(buttonsContainer, 'click', userCloseHintHandler);\n\t\t\t\tEvent.bind(addDocumentButton, 'click', userCloseHintHandler);\n\t\t\t\tEvent.bind(settingsButton, 'click', userCloseHintHandler);\n\t\t\t\tEvent.bind(dragButton, 'mousedown', userCloseHintHandler);\n\t\t\t}\n\t\t};\n\n\t\tEventEmitter.subscribe(\n\t\t\t'PaymentDocuments.EntityEditor:changeDocuments',\n\t\t\tdocumentsListTourListener\n\t\t);\n\t}\n\n\t#hintSuccessDealDocumentInTimeline(): void\n\t{\n\t\tconst timelineGuideListener = (event) => {\n\t\t\tif (event.data[1].currentStepId === 'WON' && event.data[1].currentSemantics === 'success')\n\t\t\t{\n\t\t\t\tEventEmitter.unsubscribe(\n\t\t\t\t\t'Crm.EntityProgress.Saved',\n\t\t\t\t\ttimelineGuideListener\n\t\t\t\t);\n\n\t\t\t\tconst onHistoryNodeAddedHandler = (event) => {\n\t\t\t\t\tEventEmitter.unsubscribe(\n\t\t\t\t\t\t'BX.Crm.Timeline.Items.FinalSummaryDocuments:onHistoryNodeAdded',\n\t\t\t\t\t\tonHistoryNodeAddedHandler\n\t\t\t\t\t);\n\n\t\t\t\t\tBX.onCustomEvent(window, 'OpenEntityDetailTab', ['main']);\n\t\t\t\t\tconst [timelineDocsNode] = event.data;\n\t\t\t\t\tconst previousNodePos = {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0,\n\t\t\t\t\t};\n\t\t\t\t\tconst documentLinkNodeWatcherId = setInterval(() => {\n\t\t\t\t\t\tconst documentLinkNode = timelineDocsNode.querySelector('.crm-entity-stream-content-document-description');\n\t\t\t\t\t\tif (documentLinkNode === null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst nodePos = Dom.getPosition(documentLinkNode);\n\t\t\t\t\t\tif (nodePos.x === 0 && nodePos.y === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tnodePos.x !== previousNodePos.x\n\t\t\t\t\t\t\t|| nodePos.y !== previousNodePos.y\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpreviousNodePos.x = nodePos.x;\n\t\t\t\t\t\t\tpreviousNodePos.y = nodePos.y;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tclearInterval(documentLinkNodeWatcherId);\n\n\t\t\t\t\t\tconst successDealGuide = this.#createHintToSuccessDocument(documentLinkNode, {\n\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\tuserOptions.save('crm', 'warehouse-onboarding', 'successDealGuideIsOver', true);\n\t\t\t\t\t\t\t\tunsubscribeFromHintClicks();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tconst dealContainer = this.#getContentContainer();\n\t\t\t\t\t\tconst buttonsContainer = this.#getButtonsContainer();\n\n\t\t\t\t\t\tconst unsubscribeFromHintClicks = () => {\n\t\t\t\t\t\t\tEvent.unbind(dealContainer, 'click', successDealGuide.close.bind(successDealGuide));\n\t\t\t\t\t\t\tEvent.unbind(buttonsContainer, 'click', successDealGuide.close.bind(successDealGuide));\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\twindow.scrollTo(0, nodePos.y - 250);\n\t\t\t\t\t\tsuccessDealGuide.showNextStep();\n\n\t\t\t\t\t\tEvent.bind(buttonsContainer, 'click', successDealGuide.close.bind(successDealGuide));\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tEvent.bind(dealContainer, 'click', successDealGuide.close.bind(successDealGuide));\n\t\t\t\t\t\t}, 3000);\n\t\t\t\t\t}, 100);\n\t\t\t\t}\n\n\t\t\t\tEventEmitter.subscribe(\n\t\t\t\t\t'BX.Crm.Timeline.Items.FinalSummaryDocuments:onHistoryNodeAdded',\n\t\t\t\t\tonHistoryNodeAddedHandler\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tEventEmitter.subscribe(\n\t\t\t'Crm.EntityProgress.Saved',\n\t\t\ttimelineGuideListener\n\t\t);\n\t}\n\n\t#createHintToSuccessDocument(target: HTMLElement, guideEvents: Object = {}): Guide\n\t{\n\t\tconst guideText = {\n\t\t\ttitle: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_SUCCESS_DEAL_GUIDE_TITLE'),\n\t\t\ttext: Loc.getMessage('CRM_DEAL_DETAIL_WAREHOUSE_SUCCESS_DEAL_GUIDE_TEXT'),\n\t\t};\n\n\t\treturn new Guide({\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: target,\n\t\t\t\t\ttitle: guideText.title,\n\t\t\t\t\ttext: guideText.text,\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\tevents: guideEvents,\n\t\t\t\t},\n\t\t\t],\n\t\t\tonEvents: true\n\t\t});\n\t}\n}","//@flow\nimport {Cache, Loc} from 'main.core';\nimport {DealOnboardingManager, OnboardingData} from \"./deal.onboarding.manager\";\n\n\ntype Params = {\n\tguid: string;\n};\n\n\n\nexport class DealManager\n{\n\t#dealGuid: string;\n\t#dealDetailManager: BX.Crm.DealDetailManager|null;\n\t#dealOnboardingManager: DealOnboardingManager|null = null;\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#dealGuid = params.guid;\n\t\tthis.#dealDetailManager = BX.Crm.EntityDetailManager.get(this.#dealGuid);\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('container', () => {\n\t\t\treturn document.getElementById(this.#dealGuid + '_container');\n\t\t});\n\t}\n\n\tgetDealDetailManager(): BX.Crm.DealDetailManager|null\n\t{\n\t\treturn this.#dealDetailManager;\n\t}\n\n\tenableOnboardingChain(onboardingData: OnboardingData, serviceUrl: string)\n\t{\n\t\tif (this.#dealOnboardingManager === null && this.getDealDetailManager() !== null)\n\t\t{\n\t\t\tthis.#dealOnboardingManager  = new DealOnboardingManager({\n\t\t\t\tonboardingData: onboardingData,\n\t\t\t\tcontentContainer: this.getContainer(),\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tdealDetailManager: this.getDealDetailManager()\n\t\t\t});\n\t\t\tthis.#dealOnboardingManager.processOnboarding();\n\t\t}\n\t}\n}"],"names":["DealOnboardingManager","params","onboardingData","contentContainer","serviceUrl","dealDetailManager","chain","step","chainStep","successDealGuideIsOver","querySelector","PopupWindowManager","isAnyPopupShown","guideText","title","Loc","getMessage","text","isTabButtonVisible","productsTabId","target","guideEvents","Guide","steps","position","events","onEvents","productsTabButton","getTabMenuItemContainer","productsTabGuide","onClose","userOptions","save","showNextStep","tabsContainer","getTabManager","getTabMenuContainer","windowResizeHandler","close","Event","unbind","window","bind","bindOnce","moreButton","getMoreButton","spotlight","BX","SpotLight","id","targetElement","autoSave","targetVertex","zIndex","show","container","style","pointerEvents","onOpenMoreMenuHandler","event","eventMoreMenu","getMoreMenu","dealMoreMenu","getTabFromMoreMenu","moreMenuContainer","getMenuContainer","tabHintTimeout","setTimeout","moreMenuClickHandler","productsTabPopup","getPopup","EventEmitter","subscribeOnce","onPopupCloseHandler","popupContainer","getContentContainer","parentNode","showMoreMenu","outOfPopupTimeout","closeMoreMenu","clearTimeout","unsubscribe","subscribe","buttonsContainer","productListTabListener","data","productListEditor","buttonsPanelListener","activeHint","getActiveHint","productList","products","rowId","Array","firstProductRow","find","row","getModel","isService","getId","showFieldTourHint","ajax","post","ACTION","documentsListTourListener","sumControlContainer","document","addDocumentButton","settingsButton","dragButton","addDocumentGuide","userCloseHintHandler","closeIcon","timelineGuideListener","currentStepId","currentSemantics","onHistoryNodeAddedHandler","onCustomEvent","timelineDocsNode","previousNodePos","x","y","documentLinkNodeWatcherId","setInterval","documentLinkNode","nodePos","Dom","getPosition","clearInterval","successDealGuide","unsubscribeFromHintClicks","dealContainer","scrollTo","DealManager","_classPrivateFieldInitSpec","Cache","MemoryCache","guid","Crm","EntityDetailManager","get","remember","getElementById","getDealDetailManager","getContainer","processOnboarding"],"mappings":"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"}