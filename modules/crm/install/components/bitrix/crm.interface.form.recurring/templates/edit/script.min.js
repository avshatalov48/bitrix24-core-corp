BX.namespace("Crm.Component");if(typeof BX.Crm.Component.FormRecurring==="undefined"){BX.Crm.Component.FormRecurring=function(){this.prevPeriod=null;this.selectorMail=null;this.context=null;this.templateUrl=null;this.typeId=null;this.existUserMail=null;this.ajaxUrl=null;this.lastExecution=null;this.constants={C_CRM_OWNER_TYPE_INVOICE:5,MANAGER_SINGLE_EXECUTION:1,MANAGER_MULTIPLY_EXECUTION:2,PERIOD_DAILY:1,PERIOD_WEEKLY:2,PERIOD_MONTHLY:3,PERIOD_YEARLY:4,REPEAT_TILL_ENDLESS:"N",REPEAT_TILL_TIMES:"T",REPEAT_TILL_DATE:"D",MONDAY:1,TUESDAY:2,THURSDAY:4,SUNDAY:7};this.construct=function(e){if(BX.type.isElementNode(BX("datepicker-display-start"))){BX.CrmDateLinkField.create(BX("datepicker-display-start"),null,{showTime:false,setFocusOnShow:false});BX("datepicker-display-start").setAttribute("readonly","readonly")}if(BX.type.isElementNode(BX("datepicker-display-end"))){BX.CrmDateLinkField.create(BX("datepicker-display-end"),null,{showTime:false,setFocusOnShow:false});BX("datepicker-display-end").setAttribute("readonly","readonly")}if(BX.type.isElementNode(BX("deal-datepicker-before"))){BX.CrmDateLinkField.create(BX("deal-datepicker-before"),null,{showTime:false,setFocusOnShow:false});BX("deal-datepicker-before").setAttribute("readonly","readonly")}this.ajaxUrl=e.AJAX_URL||"";this.existUserMail=e.ALLOW_SEND_BILL=="Y";this.context=e.CONTEXT||"";this.templateUrl=e.TEMPLATE_URL||"";this.entityTypeId=e.ENTITY_TYPE_ID||this.constants.C_CRM_OWNER_TYPE_INVOICE;this.entityTypeName=e.ENTITY_TYPE_NAME||"Invoice";this.lastExecution=e.LAST_EXECUTION||"";if(e.EMAILS[0]!==undefined){this.createEmailSelection(e.EMAILS)}this.prevPeriod=this.getValueString("period");this.onUpdateHint();this.bindEvents();this.onPeriodChange()};this.createEmailSelection=function(e){var t=BX("crm-recur-email-change");this.selectorMail=BX.CmrSelectorMenu.create("selector_recurring_email",{container:t,items:e});this.selectorMail.addOnSelectListener(BX.delegate(this.onTypeSelect,this));BX.bind(t,"click",BX.delegate(function(){this.selectorMail.open(t)},this))};this.toggleMailSender=function(){if(!this.existUserMail){BX("crm-recurring-email").checked="";BX("crm-recurring-email").disabled="disabled";BX("crm-recurring-email").classList.add("crm-recur-checkbox-blocked");BX("crm-recurring-empty-owner-email").classList.add("crm-recurring-empty-owner-email")}else{BX("crm-recurring-email").disabled="";BX("crm-recurring-email").classList.remove("crm-recur-checkbox-blocked");BX("crm-recurring-empty-owner-email").innerHTML="";BX("crm-recurring-empty-owner-email").classList.remove("crm-recurring-empty-owner-email")}};this.changeClientData=function(e,t){var i=[];var a=[];if(e.getId()==="UF_MYCOMPANY_ID"){a=t.primaryEntityInfo.getMultiFieldsByType("EMAIL");this.existUserMail=t.primaryEntityInfo&&a[0]!==undefined;this.toggleMailSender()}else if(e.getId()==="CLIENT"){if(t.primaryEntityInfo){var n=t.primaryEntityInfo.getMultiFieldsByType("EMAIL");if(n[0]!==undefined){a=a.concat(n)}}if(t.entityInfos instanceof Array){t.entityInfos.forEach(function(e){var t=e.getMultiFieldsByType("EMAIL");if(t[0]!==undefined){a=a.concat(t)}})}if(a.length>0){var s=[];for(var r in a){if(BX.type.isPlainObject(a[r])&&BX.type.isNotEmptyString(a[r].VALUE)&&s.indexOf(a[r].VALUE)<0){var l=a[r].ENTITY_ID?a[r].ENTITY_ID:a[r].ID;i.push({text:a[r].VALUE,value:l});s.push(a[r].VALUE)}}}if(i.length>0){this.createEmailSelection(i);if(i[0]!==undefined){BX.removeClass(BX("crm-recur-email-block"),"crm-recur-invisible");BX("crm-recur-client-email-value").innerHTML=i[0].text;BX("crm-recur-client-email-input").value=i[0].value}else{BX.addClass(BX("crm-recur-email-block"),"crm-recur-invisible");BX("crm-recurring-email").checked=""}}else{BX.addClass(BX("crm-recur-email-block"),"crm-recur-invisible");BX("crm-recurring-email").checked=""}}};this.onTypeSelect=function(e,t){BX("crm-recur-client-email-value").innerHTML=t.getText();BX("crm-recur-client-email-input").value=t.getValue()};this.bindInstantChange=function(e,t,i){if(!BX.type.isElementNode(e)){return BX.DoNothing}i=i||e;var a=e.value;var n=BX.debounce(function(n){if(e.value.toString()!=a.toString()){t.apply(i,arguments);a=e.value}},3,i);BX.bind(e,"input",n);BX.bind(e,"keyup",n);BX.bind(e,"change",n)};this.bindEvents=function(){var e=BX.delegate(this.onUpdateHint,this);var t=BX.delegate(this.onChangeNumDay,this);var i=BX.delegate(this.moreNullValue,this);if(this.entityTypeId==this.constants.C_CRM_OWNER_TYPE_INVOICE){this.bindInvoiceEvents()}else{this.bindDealEvents()}BX.bind(BX("crm-recurring-flag"),"click",BX.delegate(function(e){if(e.target.checked){BX.removeClass(BX("crm-recur-edit-recurring-panel"),"crm-recur-invisible")}else{BX.addClass(BX("crm-recur-edit-recurring-panel"),"crm-recur-invisible")}},this));BX.bindDelegate(BX("crm-recur-edit-replication-block"),"change",{tag:"select"},e);BX.bindDelegate(BX("crm-recur-edit-replication-block"),"change",{tag:"input",attr:{type:"checkbox"}},e);BX.bindDelegate(BX("crm-recur-edit-replication-block"),"change",{tag:"input",attr:{type:"radio"}},e);this.bindInstantChange(BX("daily-interval-day"),e);this.bindInstantChange(BX("daily-interval-month"),e);this.bindInstantChange(BX("weekly-interval-week"),e);BX.bind(BX("monthly-day-num"),"change",t);this.bindInstantChange(BX("monthly-day-num"),e);this.bindInstantChange(BX("monthly-month-num-1"),e);this.bindInstantChange(BX("monthly-month-num-2"),e);this.bindInstantChange(BX("yearly-day-num"),e);BX.bind(BX("yearly-interval-day"),"change",t);BX.bind(BX("yearly-month-1"),"change",t);this.bindInstantChange(BX("yearly-interval-day"),e);this.bindInstantChange(BX("deal-count-before"),e);this.bindInstantChange(BX("deal-datepicker-before"),e);BX.bind(BX("daily-interval-day"),"change",BX.delegate(i,this));BX.bind(BX("monthly-month-num-1"),"change",BX.delegate(i,this));BX.bind(BX("monthly-month-num-2"),"change",BX.delegate(i,this));BX.bind(BX("weekly-interval-week"),"change",BX.delegate(i,this));this.bindInstantChange(BX("end-times"),e);this.bindInstantChange(BX("datepicker-display-start"),e);this.bindInstantChange(BX("datepicker-display-end"),e)};this.bindInvoiceEvents=function(){BX.addCustomEvent("RecurringInvoiceClientDataList",BX.delegate(function(e,t){this.changeClientData(e,t)},this));BX.bind(BX("crm-recur-create-mail-template-link"),"click",BX.delegate(function(){this.onMailTemplateCreateClick()},this));BX.bind(BX("crm-recurring-email").parentNode,"click",BX.delegate(function(){if(!this.existUserMail){BX("crm-recurring-empty-owner-email").innerHTML=BX.message("CRM_RECURRING_EMPTY_OWNER_EMAIL1")}else if(BX("crm-recurring-empty-owner-email").innerHTML!=""){BX("crm-recurring-empty-owner-email").innerHTML=""}},this));BX.bindDelegate(BX("period-type-selector"),"click",{className:"period-type-option"},BX.proxy(function(e){this.onSetPeriodValue(e.target)},this));this.toggleMailSender()};this.bindDealEvents=function(){};this.onMailTemplateCreateClick=function(){var e=this.templateUrl;var t=(this.context+"_"+BX.util.getRandomString(6)).toLowerCase();if(e===""||t===""){return}t=(t+"_"+BX.util.getRandomString(6)).toLowerCase();var i={ENTITY_TYPE_ID:this.entityTypeId,external_context:t};e=BX.util.add_url_param(e,i);if(!this._externalRequestData){this._externalRequestData={}}this._externalRequestData[t]={context:t};BX.SidePanel.Instance.open(e,{cacheable:false,width:1080});if(!this._externalEventHandler){this._externalEventHandler=BX.delegate(this.onExternalEvent,this);BX.addCustomEvent(window,"onLocalStorageSet",this._externalEventHandler)}};this.onExternalEvent=function(e){if(this._readOnly){return}var t=BX.type.isNotEmptyString(e["key"])?e["key"]:"";var i=BX.type.isPlainObject(e["value"])?e["value"]:{};var a=BX.type.isNotEmptyString(i["context"])?i["context"]:"";if(t==="onCrmMailTemplateCreate"&&this._externalRequestData&&BX.type.isPlainObject(this._externalRequestData[a])){if(i.templateId>0&&(i.entityType>0?i.entityType==this.entityTypeId:true)){var n=BX.create("option",{props:{value:i.templateId,text:i.templateTitle}});BX("email_template").appendChild(n);BX("email_template").selectedIndex=BX("email_template").options.length-1;if(BX("email_template").disabled){BX("email_template").removeAttribute("disabled");BX("email_template").parentNode.classList.remove("disabled")}}delete this._externalRequestData[a]}};this.getCurrentPeriod=function(){return this.getValueString("period")};this.moreNullValue=function(e){e.target.value=e.target.value>0?parseInt(e.target.value):1};this.onSetPeriodValue=function(e){var t=BX.data(e,"type");if(BX.util.in_array(t,[this.constants.PERIOD_DAILY,this.constants.PERIOD_WEEKLY,this.constants.PERIOD_MONTHLY,this.constants.PERIOD_YEARLY])){var i=BX.findChildrenByClassName(e.parentNode,"active-recur");if(i[0]){BX.removeClass(i[0],"active-recur")}BX.addClass(e,"active-recur");BX("period").value=t;this.onPeriodChange()}};this.getDays=function(e){return e===2?28:30+(e>7?e+1:e)%2};this.onChangeNumDay=function(){var e=this.getCurrentPeriod();if(e==3){t=31;target=BX("monthly-day-num")}else if(e==4){month=this.getValueInt("yearly-month-1");var t=this.getDays(month);target=BX("yearly-interval-day")}var i=parseInt(target.value);if(i<=0||isNaN(i)){target.value=1}else if(i>t){target.value=t}else{target.value=i}};this.setConstraintPanelHeight=function(e){var t=BX("panel-"+e);if(t){var i=BX.pos(t).height;BX("panel").style.height=i+"px"}};this.onPeriodChange=function(){var e=this.getCurrentPeriod();if(this.prevPeriod!=e){var t=BX("panel-period-"+this.prevPeriod);var i=BX("panel-period-"+e);if(t&&i){this.setConstraintPanelHeight(this.prevPeriod);BX.addClass(t,"nodisplay");BX.removeClass(i,"nodisplay");this.setConstraintPanelHeight(e);this.prevPeriod=e}}this.onUpdateHint()};this.onUpdateHint=function(){if(this.entityTypeId==this.constants.C_CRM_OWNER_TYPE_INVOICE){var e={PERIOD:this.getValueString("period"),DAILY_INTERVAL_DAY:this.getValueInt("daily-interval-day"),DAILY_WORKDAY_ONLY:this.getSelectedControlValues("workday-only-select")[0],DAILY_MONTH_INTERVAL:this.getValueInt("daily-interval-month"),WEEKLY_INTERVAL_WEEK:this.getValueInt("weekly-interval-week"),WEEKLY_WEEK_DAYS:this.getWeekDays(),MONTHLY_INTERVAL_DAY:this.getValueInt("monthly-day-num"),MONTHLY_MONTH_NUM_1:this.getValueInt("monthly-month-num-1"),MONTHLY_WORKDAY_ONLY:this.getSelectedControlValues("monthly-only-select")[0],MONTHLY_TYPE:this.getSelectedControlValues("monthly-type")[0],MONTHLY_WEEKDAY_NUM:this.getValueInt("monthly-week-day-num"),MONTHLY_WEEK_DAY:this.getValueInt("monthly-week-day"),MONTHLY_MONTH_NUM_2:this.getValueInt("monthly-month-num-2"),YEARLY_TYPE:this.getSelectedControlValues("yearly-type")[0],YEARLY_INTERVAL_DAY:this.getValueInt("yearly-interval-day"),YEARLY_MONTH_NUM_1:this.getValueInt("yearly-month-1"),YEARLY_WEEK_DAY_NUM:this.getValueInt("yearly-week-day-num"),YEARLY_WORKDAY_ONLY:this.getSelectedControlValues("yearly-only-select")[0],YEARLY_WEEK_DAY:this.getValueInt("yearly-week-day"),YEARLY_MONTH_NUM_2:this.getValueInt("yearly-month-2"),START_DATE:this.getValueString("datepicker-display-start"),END_DATE:this.getValueString("datepicker-display-end"),TIMES:this.getValueInt("end-times"),REPEAT_TILL:this.getRepeatTill()}}else{var e={EXECUTION_TYPE:this.getSelectedControlValues("selected-deal-type")[0],PERIOD_DEAL:this.getSelectedControlValues("period-deal-select")[0],DEAL_COUNT_BEFORE:this.getValueInt("deal-count-before"),DEAL_DATEPICKER_BEFORE:this.getValueString("deal-datepicker-before"),DEAL_TYPE_BEFORE:this.getSelectedControlValues("deal-type-before-select")[0],START_DATE:this.getValueString("datepicker-display-start"),END_DATE:this.getValueString("datepicker-display-end"),TIMES:this.getValueInt("end-times"),REPEAT_TILL:this.getRepeatTill()}}var t=BX("hint");if(t){t.innerHTML=this.makeHintText(e)}this.updateExecutionHint(e)};this.updateExecutionHint=function(e){BX.ajax({url:this.ajaxUrl,method:"POST",dataType:"json",data:{START_DATE:this.getValueString("datepicker-display-start"),PARAMS:e,ENTITY_TYPE:this.entityTypeId,LAST_EXECUTION:this.lastExecution},onsuccess:BX.delegate(this.setExecutionHTML,this)})};this.setExecutionHTML=function(e){if(e.RESULT.NEXT_DATE!==undefined){BX("next-data-hint").innerHTML=BX.message("NEXT_EXECUTION_"+this.entityTypeName+"_HINT").replace("#DATE_EXECUTION#",e.RESULT.NEXT_DATE)}};this.makeInvoiceHintMessage=function(e){var t=null;var i="";var a=BX.message("LANGUAGE_ID");var n="";var s="";if(e.PERIOD==this.constants.PERIOD_DAILY){var r=e.DAILY_INTERVAL_DAY>1?e.DAILY_INTERVAL_DAY+" ":"";if(e.DAILY_WORKDAY_ONLY=="Y"){i=BX.message("CRM_RECURRING_HINT_ELEMENT_DAY_MASK_WORK").replace("#DAY_NUMBER#",r)}else{i=BX.message("CRM_RECURRING_HINT_ELEMENT_DAY_MASK").replace("#DAY_NUMBER#",r)}}else if(e.PERIOD==this.constants.PERIOD_WEEKLY){t=e.WEEKLY_INTERVAL_WEEK>1?e.WEEKLY_INTERVAL_WEEK+" ":"";if(e.WEEKLY_WEEK_DAYS.length==7){weekdays=BX.message("CRM_RECURRING_HINT_WEEKDAY_EVERY_DAY")}else{var l=[];for(var E=0;E<e.WEEKLY_WEEK_DAYS.length;E++){l.push(BX.message("CRM_RECURRING_HINT_WEEKDAY_WD_"+e.WEEKLY_WEEK_DAYS[E]))}weekdays=l.join(", ")}i=BX.message("CRM_RECURRING_HINT_ELEMENT_WEEKDAY_MASK").replace("#WEEK_NUMBER#",t).replace("#LIST_WEEKDAY_NAMES#",weekdays)}else if(e.PERIOD==this.constants.PERIOD_MONTHLY){var _=null;var c="";if(e.MONTHLY_TYPE==1){t=parseInt(e.MONTHLY_INTERVAL_DAY)>0?parseInt(e.MONTHLY_INTERVAL_DAY):1;_=e.MONTHLY_MONTH_NUM_1;if(e.MONTHLY_WORKDAY_ONLY=="Y")i=BX.message("CRM_RECURRING_HINT_ELEMENT_MONTH_MASK_1_WORK").replace("#DAY_NUMBER#",t).replace("#MONTH_NUMBER#",_>1?_+" ":"");else i=BX.message("CRM_RECURRING_HINT_ELEMENT_MONTH_MASK_1").replace("#DAY_NUMBER#",t).replace("#MONTH_NUMBER#",_>1?_+" ":"")}else{if(a=="ru"||a=="ua"){s=this.getWeekDayGender(e.MONTHLY_WEEK_DAY)}n=this.getWeekDayName(e.MONTHLY_WEEK_DAY);t=BX.message("CRM_RECURRING_HINT_WEEKDAY_NUMBER_"+e.MONTHLY_WEEKDAY_NUM+s);c=BX.message("CRM_RECURRING_HINT_EACH"+s);_=e.MONTHLY_MONTH_NUM_2;i=BX.message("CRM_RECURRING_HINT_MONTHLY_EXT_TYPE_2").replace("#EACH#",c).replace("#WEEKDAY_NUMBER#",t).replace("#WEEKDAY_NAME#",n).replace("#MONTH_NUMBER#",_>1?_+" ":"")}}else{var o="";if(e.YEARLY_TYPE==1){t=parseInt(e.YEARLY_INTERVAL_DAY)>0?parseInt(e.YEARLY_INTERVAL_DAY):1;o=BX.message("CRM_RECURRING_HINT_MONTH_"+e.YEARLY_MONTH_NUM_1);if(e.YEARLY_WORKDAY_ONLY=="Y")i=BX.message("CRM_RECURRING_HINT_YEARLY_EXT_TYPE_1_WORKDAY").replace("#DAY_NUMBER#",t).replace("#MONTH_NAME#",o);else i=BX.message("CRM_RECURRING_HINT_YEARLY_EXT_TYPE_1").replace("#DAY_NUMBER#",t).replace("#MONTH_NAME#",o)}else{if(a=="ru"||a=="ua"){s=this.getWeekDayGender(e.YEARLY_WEEK_DAY)}n=this.getWeekDayName(e.YEARLY_WEEK_DAY);t=BX.message("CRM_RECURRING_HINT_WEEKDAY_NUMBER_"+e.YEARLY_WEEK_DAY_NUM+s);c=BX.message("CRM_RECURRING_HINT_EACH"+s);o=BX.message("CRM_RECURRING_HINT_MONTH_"+e.YEARLY_MONTH_NUM_2);i=BX.message("CRM_RECURRING_HINT_YEARLY_EXT_TYPE_2").replace("#EACH#",c).replace("#WEEKDAY_NUMBER#",t).replace("#WEEKDAY_NAME#",n).replace("#MONTH_NAME#",o)}}return i};this.makeDealHintMessage=function(e){var t="";if(e.EXECUTION_TYPE==this.constants.MANAGER_SINGLE_EXECUTION){var i=parseInt(e.DEAL_COUNT_BEFORE);if(i===0){t=e.DEAL_DATEPICKER_BEFORE||BX.message("CRM_RECURRING_HINT_TODAY")}else if(e.DEAL_DATEPICKER_BEFORE==""){t=BX.message("CRM_RECURRING_HINT_TODAY")}else{var a=e.DEAL_TYPE_BEFORE;var n=this.getMessagePlural(i,"CRM_RECURRING_HINT_"+a);var s=e.DEAL_DATEPICKER_BEFORE||"";if(s.length>0){dateMessage=BX.message("CRM_RECURRING_HINT_BEFORE_DATE").replace("#DATE#",e.DEAL_DATEPICKER_BEFORE||"")}else{dateMessage=""}t=BX.message("CRM_RECURRING_HINT_A_FEW_DAYS_BEFORE_DATE").replace("#COUNT_ELEMENT#",i).replace("#TYPE_ELEMENT#",n).replace("#BEFORE_DATE#",dateMessage)}}else{t=BX.message("CRM_RECURRING_HINT_EVERY_DEAL_"+parseInt(e.PERIOD_DEAL))}return t};this.makeHintText=function(e){var t="";var i="";var a="";if(this.entityTypeId==this.constants.C_CRM_OWNER_TYPE_INVOICE){t=this.makeInvoiceHintMessage(e)}else{t=this.makeDealHintMessage(e)}var n=e.TIMES;if(e.EXECUTION_TYPE==this.constants.MANAGER_SINGLE_EXECUTION){a=""}else if(e.START_DATE!=""){var s=BX.date.format(BX.date.convertBitrixFormat(BX.message("FORMAT_DATE")),BX.parseDate(e.START_DATE,true),false,true);a=BX.message("CRM_RECURRING_HINT_START_DATE").replace("#DATETIME#",s)}else{a=BX.message("CRM_RECURRING_HINT_START_EMPTY")}var r=this.getRepeatTill();if(e.EXECUTION_TYPE==this.constants.MANAGER_SINGLE_EXECUTION){i=""}else if(e.END_DATE!=""&&r==this.constants.REPEAT_TILL_DATE){i=BX.message("CRM_RECURRING_HINT_END").replace("#DATETIME#",e.END_DATE)}else if(n>0&&r==this.constants.REPEAT_TILL_TIMES){i=BX.message("CRM_RECURRING_HINT_END_TIMES").replace("#TIMES#",n).replace("#TIMES_PLURAL#",this.getMessagePlural(n,"CRM_RECURRING_HINT_END_CONSTRAINT_TIMES"))}else{i=BX.message("CRM_RECURRING_HINT_END_NONE")}return BX.message("CRM_RECURRING_"+this.entityTypeName+"_HINT_BASE").replace("#ELEMENT#",t).replace("#START#",a).replace("#END#",i)};this.getWeekDayName=function(e){var t="";if(BX.message("LANGUAGE_ID")=="ru"||BX.message("LANGUAGE_ID")=="ua"){t=this.getWeekDayGender(e)}return BX.message("CRM_RECURRING_HINT_WEEKDAY_WD_"+e+(t=="_F"?"_ALT":""))};this.getValueString=function(e){var t=BX(e);if(BX.type.isElementNode(t)){return BX.util.htmlspecialchars(t.value.toString())}return""};this.getValueInt=function(e){var t=BX(e);if(BX.type.isElementNode(t)){var i=parseInt(t.value.toString());if(isNaN(i)){return 0}return i}return 0};this.getMessagePlural=function(e,t){var i,a;a=BX.message("LANGUAGE_ID");e=parseInt(e);if(e<0){e=-1*e}if(a){switch(a){case"de":case"en":i=e!==1?1:0;break;case"ru":case"ua":i=e%10===1&&e%100!==11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2;break;default:i=1;break}}else{i=1}if(BX.type.isArray(t)){return t[i]}return BX.message(t+"_PLURAL_"+i)};this.getSelectedControlValues=function(e){var t=[];var i=document.getElementsByClassName(e);for(var a in i){if(i[a].checked||i[a].selected){if(t.indexOf(i[a].value)===-1)t.push(i[a].value)}}return t};this.getRepeatTill=function(){var e=this.getSelectedControlValues("selected-end");if(typeof e[0]=="undefined"){return this.constants.REPEAT_TILL_ENDLESS}return e[0]};this.getWeekDays=function(){var e=this.getSelectedControlValues("weekly-week-days");if(e.length==0){e.push(this.constants.MONDAY);document.getElementsByClassName("weekly-week-days")[0].checked=true}else{for(var t=0;t<e.length;t++){e[t]=parseInt(e[t])}}return e};this.getWeekDayGender=function(e){if(e==this.constants.MONDAY||e==this.constants.TUESDAY||e==this.constants.THURSDAY){return"_M"}if(e==this.constants.SUNDAY){return""}return"_F"}}}