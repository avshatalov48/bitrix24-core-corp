(function(){"use strict";var e=BX.namespace("BX.Crm.Tracking");if(e.Grid){return}function t(){}t.prototype.init=function(e){this.gridId=e.gridId;this.actionUri=e.actionUri;this.pathToEdit=e.pathToEdit;this.pathToAdd=e.pathToAdd;this.mess=e.mess;this.sourceTileManagerId=e.sourceTileManagerId;this.channelTileManagerId=e.channelTileManagerId;this.sourceTileManager=BX.UI.TileList.Manager.getById(this.sourceTileManagerId);this.channelTileManager=BX.UI.TileList.Manager.getById(this.channelTileManagerId);BX.addCustomEvent(this.sourceTileManager,this.sourceTileManager.events.buttonAdd,function(){BX.SidePanel.Instance.open(this.pathToAdd,{width:735,cacheable:false});this.closeItemPopup()}.bind(this));BX.addCustomEvent(this.sourceTileManager,this.sourceTileManager.events.tileClick,function(e){if(e.data.items.list&&e.data.items.list.length>0){this.showItemPopup(e.node,e.data.items,"source-"+e.id)}else{BX.SidePanel.Instance.open(e.data.url,{width:735,cacheable:false});this.closeItemPopup()}}.bind(this));BX.addCustomEvent(this.channelTileManager,this.channelTileManager.events.tileClick,function(e){if(e.data.items.list&&e.data.items.list.length>0){this.showItemPopup(e.node,e.data.items,"channel-"+e.id)}else{BX.SidePanel.Instance.open(e.data.url,{width:735,cacheable:false});this.closeItemPopup()}}.bind(this))};t.prototype.closeItemPopup=function(){if(this.itemPopup){this.itemPopup.close()}};t.prototype.showItemPopup=function(e,t,i){if(this.itemPopup){this.itemPopup.close()}var a=[{text:t.addText,href:t.addUrl},{delimiter:true}].concat(t.list);a=a.map(function(e){var t="";if(BX.type.isBoolean(e.active)){t="crm-tracking-list-popup-item crm-tracking-list-popup-item-";t+=e.active?"green":"gray";e.html='<span class="crm-tracking-list-popup-item '+t+'"></span>'+BX.util.htmlspecialchars(e.text)}e.onclick=function(e,t){BX.SidePanel.Instance.open(t.href,{width:735,cacheable:false});t.getMenuWindow().close();e.preventDefault()};return e});this.itemPopup=BX.PopupMenu.create("crm-tracking-list-items-"+i,e,a,{maxHeight:250,minWidth:200,offsetLeft:40,offsetTop:-10,bindOptions:{position:"top"},angle:true,autoHide:true,closeByEsc:true});this.itemPopup.show()};e.Grid=new t})();
//# sourceMappingURL=script.map.js