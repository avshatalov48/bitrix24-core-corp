(function(e,t,n,i,r,a){"use strict";var o=t.Reflection.namespace("BX.Crm.Component");var s=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"grid",null);babelHelpers.defineProperty(this,"settingsSliderUrl","");this.gridId=t.gridId;if(BX.Main.gridManager){this.grid=BX.Main.gridManager.getInstanceById(this.gridId)}this.settingsSliderUrl=t.settingsSliderUrl;a.EventEmitter.subscribe("Grid::updated",this.onGridUpdatedHandler.bind(this))}babelHelpers.createClass(e,[{key:"deletePayment",value:function e(r){var a=this;var o=new n.Popup({id:"crm_terminal_payment_list_delete_popup",titleBar:t.Loc.getMessage("CRM_TERMINAL_PAYMENT_LIST_COMPONENT_TEMPLATE_TITLE_DELETE_TITLE"),content:t.Loc.getMessage("CRM_TERMINAL_PAYMENT_LIST_COMPONENT_TEMPLATE_TITLE_DELETE_CONTENT"),buttons:[new i.Button({text:t.Loc.getMessage("CRM_TERMINAL_PAYMENT_LIST_COMPONENT_TEMPLATE_BUTTON_CONTINUE"),color:i.ButtonColor.SUCCESS,onclick:function e(n,i){n.setDisabled();t.ajax.runAction("crm.order.terminalpayment.delete",{data:{id:r}}).then((function(e){o.destroy();a.grid.reload()}))["catch"]((function(e){if(e.errors){BX.UI.Notification.Center.notify({content:BX.util.htmlspecialchars(e.errors[0].message)})}o.destroy()}))}}),new i.Button({text:t.Loc.getMessage("CRM_TERMINAL_PAYMENT_LIST_COMPONENT_TEMPLATE_BUTTON_CANCEL"),color:i.ButtonColor.DANGER,onclick:function e(t,n){o.destroy()}})]});o.show()}},{key:"deletePayments",value:function e(){var n=this;var i=this.grid.getRows().getSelectedIds();t.ajax.runAction("crm.order.terminalpayment.deleteList",{data:{ids:i}}).then((function(e){n.grid.reload()}))["catch"]((function(e){if(e.errors){e.errors.forEach((function(e){if(e.message){BX.UI.Notification.Center.notify({content:BX.util.htmlspecialchars(e.message)})}}))}n.grid.reload()}))}},{key:"openSmsSettingsSlider",value:function e(){BX.SidePanel.Instance.open(this.settingsSliderUrl,{width:700,cacheable:false,allowChangeTitle:false,allowChangeHistory:false})}},{key:"openQrAuthPopup",value:function e(){(new r.QrAuth).show()}},{key:"openHelpdesk",value:function e(t){if(top.BX.Helper){top.BX.Helper.show("redirect=detail&code=17603024");t.preventDefault()}}},{key:"onGridUpdatedHandler",value:function e(n){var i=n.getCompatData(),r=babelHelpers.slicedToArray(i,1),a=r[0];if(a&&a.getId()===this.gridId&&a.getRows().getCountDisplayed()===0){t.ajax.runComponentAction("bitrix:crm.terminal.payment.list","isRowsExists",{mode:"class",data:{}}).then((function(e){if(e.data.IS_ROWS_EXIST===false){window.location.reload()}}),(function(){window.location.reload()}))}}}]);return e}();o.TerminalPaymentList=s})(this.window=this.window||{},BX,BX.Main,BX.UI,BX.Crm,BX.Event);
//# sourceMappingURL=script.map.js