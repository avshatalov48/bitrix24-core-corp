{"version":3,"file":"script.js","sources":["src/step.js","src/steptelephony.js","src/stepcrmform.js","src/stepimconnector.js","src/stepmessageservice.js","src/steppaysystem.js","src/iterator.js"],"sourcesContent":["import { Tag, Type } from \"main.core\";\nimport { EventEmitter } from 'main.core.events';\n\nexport default class Step {\n\n\tid: string;\n\n\tactual : boolean|null = null; // does not use yet\n\tcorrect : boolean|null = null;\n\tstarted : boolean = false;\n\tfinished : boolean = false;\n\n\tstatusAttributeName : String = \"data-bx-status\";\n\turl : String = \"\";\n\n\terrors : Map = new Map();\n\tnotes : Map = new Map();\n\n\tconstructor (options, iterator)\n\t{\n\t\tthis.id = String(options[\"ID\"]);\n\n\t\tthis.iterator = iterator;\n\t\tthis.nodeMain = document.querySelector(\"#\" + options[\"NODE_ID\"]);\n\t\tthis.node = this.nodeMain.querySelector(\"[data-bx-block=\\\"info-block\\\"]\");\n\n\t\tthis.actual = options[\"IS_ACTUAL\"];\n\t\tthis.correct = options[\"IS_CORRECT\"];\n\t\tthis.started = options[\"IS_STARTED\"];\n\t\tthis.finished = options[\"IS_FINISHED\"];\n\n\t\tEventEmitter.subscribe(this.iterator, \"Iterator:reset\", this.reset.bind(this));\n\t\tEventEmitter.subscribe(this.iterator, \"Iterator:response\", this.checkResponse.bind(this));\n\t\tEventEmitter.subscribe(this.iterator, \"Iterator:error\", this.setError.bind(this));\n\n\t\tthis.adjustNode();\n\t\tthis.adjustInfoBlock(options[\"ERRORS\"], options[\"NOTES\"]);\n\n\t\tconst button = this.nodeMain.querySelector(\"[data-bx-url]\");\n\t\tif (button)\n\t\t{\n\t\t\tthis.url = button.getAttribute(\"data-bx-url\");\n\t\t\tbutton.addEventListener(\"click\", this.onClickUrl.bind(this))\n\t\t}\n\t}\n\treset()\n\t{\n\t\tthis.started = true;\n\t\tthis.finished = false;\n\t\tthis.actual = null;\n\t\tthis.correct = null;\n\t\tthis.adjustNode();\n\t}\n\tcheckResponse({data:steps})\n\t{\n\t\tfor (const stepId in steps)\n\t\t{\n\t\t\tif (steps.hasOwnProperty(stepId) && this.id === stepId)\n\t\t\t{\n\t\t\t\tthis.actual = steps[stepId].actual;\n\t\t\t\tthis.correct = steps[stepId].correct;\n\t\t\t\tthis.started = steps[stepId].started;\n\t\t\t\tthis.finished = steps[stepId].finished;\n\t\t\t\tthis.adjustNode();\n\t\t\t\tthis.adjustInfoBlock(steps[stepId][\"errors\"], steps[stepId][\"notes\"]);\n\t\t\t}\n\t\t}\n\t}\n\tadjustNode()\n\t{\n\t\tlet status = \"ok\";\n\t\tif (!this.started)\n\t\t{\n\t\t\tstatus = \"not-checked\";\n\t\t}\n\t\telse if (!this.finished)\n\t\t{\n\t\t\tstatus = \"in-progress\";\n\t\t}\n\t\telse if (!this.actual)\n\t\t{\n\t\t\tstatus = \"not-actual\";\n\t\t}\n\t\telse if (!this.correct)\n\t\t{\n\t\t\tstatus = \"not-correct\";\n\t\t}\n\t\tthis.nodeMain.setAttribute(this.statusAttributeName, status);\n\t}\n\tsetError()\n\t{\n\t\tthis.node.innerHTML = \"Some error was occurred.\";\n\t}\n\tadjustInfoBlock(errors:Object, notes:Object)\n\t{\n\t\tlet child = this.node.lastChild;\n\t\twhile (child)\n\t\t{\n\t\t\tthis.node.removeChild(child);\n\t\t\tchild = this.node.lastChild;\n\t\t}\n\n\t\tthis.parseErrors(errors, notes);\n\n\t\tif (this.node.hasChildNodes())\n\t\t{\n\t\t\tTag.style(this.node.parentNode)`\n\t\t\t\theight: ${this.node.offsetHeight}px;\n\t\t\t\topacity: 1;\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tTag.style(this.node.parentNode)`\n\t\t\t\theight: 0;\n\t\t\t\topacity: 0;\n\t\t\t`;\n\t\t}\n\t}\n\n\tonClickUrl()\n\t{\n\t\tif (Type.isStringFilled(this.url))\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(this.url);\n\t\t}\n\t}\n\n\tparseErrors(errors:Object, notes:Object)\n\t{\n\t}\n}","import Step from './step';\nimport {Tag} from \"main.core\";\n\nexport default class StepTelephony extends Step {\n\n\tconstructor(options, iterator)\n\t{\n\t\tsuper(options, iterator);\n\t}\n\n\tparseErrors(errors:Object, notes:Object)\n\t{\n\t\tfor (let [key, error] of Object.entries(errors))\n\t\t{\n\t\t\tif (key !== \"VOXIMPLANT_IS_NOT_CONFIGURED\")\n\t\t\t{\n\t\t\t\tthis.node.append(\n\t\t\t\t\tTag.render`<span class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${error[\"message\"]}</span>`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}","import Step from './step';\nimport {Dom, Loc, Tag, Type} from \"main.core\";\nimport {EventEmitter} from \"main.core.events\";\n\nexport default class StepCrmForm extends Step {\n\n\tconstructor(options, iterator)\n\t{\n\t\tsuper(options, iterator);\n\t}\n\n\tonChange({target})\n\t{\n\t\tconst select = this.node.querySelector(\"#crm_numbers\");\n\t\tif (select.value !== null)\n\t\t{\n\t\t\tEventEmitter.emit(this, \"Step:action\", {action: \"setNumber\", data : {numberId : select.value}});\n\t\t}\n\t\tconst butt = this.node.querySelector(\"#crm_button\");\n\t\tif (butt)\n\t\t{\n\t\t\tDom.addClass(butt, \"ui-btn-wait\");\n\t\t\tsetTimeout(() => { Dom.removeClass(butt, \"ui-btn-wait\"); }, 2000);\n\t\t}\n\t}\n\n\tparseErrors(errors, notes)\n\t{\n\t\tfor (let [key, error] of Object.entries(errors))\n\t\t{\n\t\t\tthis.node.append(\n\t\t\t\tTag.render`<span class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${error[\"message\"]}</span>`\n\t\t\t);\n\t\t}\n\t\tif (notes && Type.isArray(notes[\"items\"]))\n\t\t{\n\t\t\tlet numberIsInUse = [];\n\t\t\tnotes[\"items\"].forEach((number) => {\n\t\t\t\tif (number['IS_IN_USE'] === true)\n\t\t\t\t{\n\t\t\t\t\tnumberIsInUse.push(number['LINE_NUMBER']);\n\t\t\t\t}\n\t\t\t});\n\t\t\tlet numbers = '';\n\t\t\tif (numberIsInUse.length > 1)\n\t\t\t{\n\t\t\t\tnumbers = `<option value=\"null\" selected>${Loc.getMessage(\"CRM_SEVERAL_NUMBERS_IS_IN_USE\")}</option>`\n\t\t\t}\n\t\t\telse if (numberIsInUse.length <= 0)\n\t\t\t{\n\t\t\t\tnumbers = `<option value=\"null\" selected>${Loc.getMessage(\"CRM_PICK_UP_THE_NUMBER_FOR_CRMFORM\")}</option>`;\n\t\t\t}\n\n\t\t\tnotes[\"items\"].forEach((number) => {\n\t\t\t\tnumbers += `\n\t\t\t\t\t<option value=\"${number['LINE_NUMBER']}\" ${numberIsInUse.length === 1 && number['IS_IN_USE'] ? \"selected\" : \"\"}>\n\t\t\t\t\t\t[${number['LINE_NUMBER']}] ${number['SHORT_NAME']}\n\t\t\t\t\t</option>\n\t\t\t`});\n\t\t\tDom.append(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"crm-wizard-settings-block-hidden-input\">\n\t\t\t\t\t\t<div class=\"crm-wizard-settings-block-hidden-input-inner\">\n\t\t\t\t\t\t\t<div class=\"crm-wizard-settings-block-hidden-input-label\">${Loc.getMessage(\"CRM_CHANGE_CRM_FORM_NUMBER\")}</div>\n\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-after-icon ui-ctl-dropdown\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t\t<select class=\"ui-ctl-element\" id=\"crm_numbers\">\n\t\t\t\t\t\t\t\t\t${numbers}\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border\" id=\"crm_button\" onclick=\"${this.onChange.bind(this)}\">${Loc.getMessage(\"CRM_BUTTON_APPLY\")}</button>\n\t\t\t\t\t</div>\n`,\n\t\t\t\tthis.node\n\t\t\t);\n\t\t}\n\t}\n}","import Step from './step';\nimport {Tag, Type} from \"main.core\";\n\nexport default class StepImconnector extends Step {\n\n\tconstructor(options, iterator)\n\t{\n\t\tsuper(options, iterator);\n\t}\n\n\tparseErrors(errors, notes)\n\t{\n\t\tlet node = null;\n\t\tfor (let [key, error] of Object.entries(errors))\n\t\t{\n\t\t\tif (error[\"code\"] === \"IMCONNECTOR_IS_NOT_CORRECT\" && Type.isArray(error[\"customData\"]))\n\t\t\t{\n\t\t\t\tnode = Tag.render`<ul class=\"crm-wizard-settings-block-list\"></ul>`;\n\t\t\t\terror[\"customData\"].forEach((item) => {\n\t\t\t\t\tnode.append(\n\t\t\t\t\t\tTag.render`\n\t<li class=\"${item[\"icon_class\"]}\">\n\t\t<a href=\"${item[\"link\"]}\" onclick=\"BX.SidePanel.Instance.open(this.href); return false;\">${item[\"name\"]}</a>\n\t</li>\n\t\t\t\t\t\t`);\n\t\t\t\t});\n\t\t\t\tnode = Tag.render`<div class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${error[\"message\"]}${node}</div>`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnode = Tag.render`<div class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${error[\"message\"]}</div>`;\n\t\t\t}\n\t\t\tthis.node.append(\n\t\t\t\tnode\n\t\t\t);\n\t\t}\n\t}\n}","import Step from './step';\nimport {Tag, Type} from \"main.core\";\n\nexport default class StepMessageService extends Step {\n\n\tconstructor(options, iterator)\n\t{\n\t\tsuper(options, iterator);\n\t}\n\n\tonClickUrl()\n\t{\n\t\tif (Type.isStringFilled(this.url))\n\t\t{\n\t\t\twindow.open(this.url);\n\t\t}\n\t}\n\n\tparseErrors(errors)\n\t{\n\t\tlet node = null, node2 = null;\n\t\tconst errorNode = Tag.render`<div class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\"></div>`;\n\n\t\tfor (let [key, error] of Object.entries(errors))\n\t\t{\n\t\t\tif (error[\"code\"] === \"NONEXISTENT_PROVIDER\")\n\t\t\t{\n\t\t\t\tif (node2 === null)\n\t\t\t\t{\n\t\t\t\t\tnode2 = Tag.render`<ul class=\"crm-wizard-settings-block-provider-list\"></ul>`;\n\t\t\t\t\terrorNode.append(\n\t\t\t\t\t\tTag.render`<div class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${node2}</div>`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tnode2.append(Tag.render`<li>${error[\"message\"]}</li>`);\n\t\t\t}\n\t\t\telse if (error[\"code\"] === \"NONWORKING_PROVIDER\")\n\t\t\t{\n\t\t\t\tif (node === null)\n\t\t\t\t{\n\t\t\t\t\tnode = Tag.render`<ul class=\"crm-wizard-settings-block-provider-list\"></ul>`;\n\t\t\t\t\terrorNode.append(\n\t\t\t\t\t\tTag.render`<div class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${node}</div>`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tnode.append(\n\t\t\t\t\tTag.render`\n\t<li>\n\t\t${error[\"message\"]}\n\t\t<a href=\"${error[\"customData\"][\"manageUrl\"]}\" onclick=\"BX.SidePanel.Instance.open(this.href); return false;\">${error[\"customData\"][\"shortName\"]}</a>\n\t</li>\n\t\t\t\t\t\t`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\terrorNode.append(\n\t\t\t\t\tTag.render`<div>${error[\"message\"]}</div>`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tif (errorNode.hasChildNodes())\n\t\t{\n\t\t\tthis.node.append(\n\t\t\t\terrorNode\n\t\t\t);\n\t\t}\n\t}\n}","import Step from './step';\nimport {Tag, Type} from \"main.core\";\n\nexport default class StepPaySystem extends Step {\n\n\tconstructor(options, iterator)\n\t{\n\t\tsuper(options, iterator);\n\t}\n\n\tonClickUrl()\n\t{\n\t\tif (Type.isStringFilled(this.url))\n\t\t{\n\t\t\twindow.open(this.url);\n\t\t}\n\t}\n\n\tparseErrors(errors:Object, notes:Object)\n\t{\n\t\tfor (let [key, error] of Object.entries(errors))\n\t\t{\n\t\t\tif (key !== \"PAY_SYSTEM_IS_NOT_CONFIGURED\")\n\t\t\t{\n\t\t\t\tthis.node.append(\n\t\t\t\t\tTag.render`<span class=\"crm-wizard-settings-block-hidden-notice crm-wizard-settings-block-hidden-notice-unselected\">${error[\"message\"]}</span>`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}","import {Event, Type, ajax} from 'main.core';\nimport {ButtonManager, Button} from 'ui.buttons';\nimport Step from './step';\nimport StepTelephony from './steptelephony';\nimport StepCrmForm from './stepcrmform';\nimport StepImconnector from './stepimconnector';\nimport StepMessageService from './stepmessageservice';\nimport StepPaySystem from './steppaysystem';\nimport {EventEmitter} from 'main.core.events';\n\nconst stepMappings = {\n\t'Step' : Step,\n\t'StepTelephony' : StepTelephony,\n\t'StepCrmForm' : StepCrmForm,\n\t'StepImconnector' : StepImconnector,\n\t'StepMessageService' : StepMessageService,\n\t'StepPaySystem' : StepPaySystem\n};\n\nexport default class Iterator {\n\tid: string;\n\n\tstarted: boolean = false;\n\tfinished: boolean = false;\n\n\tsteps: Map = new Map();\n\n\tresetButton: ?Button = null;\n\tcloseButton: ?Button = null;\n\n\tcomponentName: string;\n\tsignedParameters: Object;\n\n\tconstructor(id, data)\n\t{\n\t\tthis.id = id;\n\n\t\tthis.started = data.started;\n\t\tthis.finished = data.finished;\n\n\t\tthis.steps = new Map();\n\n\t\tdata.steps.map((stepOption) => {\n\t\t\tthis.addStep(stepOption);\n\t\t});\n\n\t\tif (data[\"buttons\"][\"start\"])\n\t\t{\n\t\t\tthis.resetButton = ButtonManager.createFromNode(data[\"buttons\"][\"start\"]);\n\t\t\tEvent.bind(\n\t\t\t\tthis.resetButton.getContainer(),\n\t\t\t\t\"click\",\n\t\t\t\t(event) => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.start();\n\t\t\t\t}\n\t\t\t);\n\t\t\tEventEmitter.subscribe(this, \"Iterator:reset\", () => { this.resetButton.setWaiting(true); });\n\t\t\tEventEmitter.subscribe(this, \"Iterator:finish\", () => { this.resetButton.setWaiting(false); })\n\t\t\tEventEmitter.subscribe(this, \"Iterator:error\", () => { this.resetButton.setWaiting(false); });\n\t\t}\n\n\t\tthis.componentName = data[\"componentName\"];\n\t\tthis.signedParameters = data[\"signedParameters\"];\n\t}\n\taddStep(stepOption)\n\t{\n\t\tconst id = String(stepOption[\"ID\"]);\n\t\tconst stepClassName = id.substring(id.lastIndexOf(\"\\\\\") + 1);\n\t\tlet step;\n\t\tif (stepMappings[stepClassName])\n\t\t{\n\t\t\tstep = new stepMappings[stepClassName](stepOption, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstep = new Step(stepOption, this);\n\t\t}\n\t\tEventEmitter.subscribe(step, \"Step:action\", ({target, data}) => {\n\t\t\tthis.execute(target.id, data.action, data.data);\n\t\t});\n\t\tthis.steps.set(id, step);\n\t}\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\tstart()\n\t{\n\t\tEventEmitter.emit(this, \"Iterator:reset\", []);\n\t\tthis.send(\"reset\");\n\t}\n\tcontinue()\n\t{\n\t\tEventEmitter.emit(this, \"Iterator:continue\", []);\n\t\tthis.send(\"continue\");\n\t}\n\tfinish()\n\t{\n\t\tEventEmitter.emit(this, \"Iterator:finish\", []);\n\t\tthis.resetButton.setDisabled(true);\n\t}\n\terror({errors})\n\t{\n\t\tEventEmitter.emit(this, \"Iterator:error\", data);\n\t}\n\texecute(stepId, stepAction, stepData)\n\t{\n\t\tthis.send(\"executeStep\", {\n\t\t\tstepId : stepId,\n\t\t\tstepAction: stepAction,\n\t\t\tstepData : stepData\n\t\t});\n\t}\n\tsend(action, data)\n\t{\n\t\tdata = Type.isPlainObject(data) ? data : {};\n\t\tajax\n\t\t\t.runComponentAction(\n\t\t\t\tthis.componentName,\n\t\t\t\taction,\n\t\t\t\t{\n\t\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\t\tmode: \"class\",\n\t\t\t\t\tdata: data\n\t\t\t\t},\n\t\t\t)\n\t\t\t.then(this.response.bind(this), this.error.bind(this));\n\t}\n\tresponse({data})\n\t{\n\t\tthis.started = data.started;\n\t\tthis.finished = data.finished;\n\n\t\tEventEmitter.emit(this, \"Iterator:response\", data[\"stepSteps\"]);\n\n\t\tif (this.finished !== true)\n\t\t{\n\t\t\tthis.continue();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.finish();\n\t\t}\n\t}\n}"],"names":["Step","options","iterator","Map","id","String","nodeMain","document","querySelector","node","actual","correct","started","finished","EventEmitter","subscribe","reset","bind","checkResponse","setError","adjustNode","adjustInfoBlock","button","url","getAttribute","addEventListener","onClickUrl","steps","data","stepId","hasOwnProperty","status","setAttribute","statusAttributeName","innerHTML","errors","notes","child","lastChild","removeChild","parseErrors","hasChildNodes","Tag","style","parentNode","offsetHeight","Type","isStringFilled","BX","SidePanel","Instance","open","StepTelephony","Object","entries","key","error","append","render","StepCrmForm","target","select","value","emit","action","numberId","butt","Dom","addClass","setTimeout","removeClass","isArray","numberIsInUse","forEach","number","push","numbers","length","Loc","getMessage","onChange","StepImconnector","item","StepMessageService","window","node2","errorNode","StepPaySystem","stepMappings","Iterator","map","stepOption","addStep","resetButton","ButtonManager","createFromNode","Event","getContainer","event","preventDefault","start","setWaiting","componentName","signedParameters","stepClassName","substring","lastIndexOf","step","execute","set","send","setDisabled","stepAction","stepData","isPlainObject","ajax","runComponentAction","mode","then","response","continue","finish"],"mappings":"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"}