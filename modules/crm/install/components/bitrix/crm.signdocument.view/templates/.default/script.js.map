{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Reflection} from \"main.core\";\nimport {BaseButton, ButtonManager} from \"ui.buttons\";\n\nconst namespace = Reflection.namespace('BX.Crm.Component');\nconst Viewer = Reflection.namespace('BX.UI.Viewer');\n\ndeclare type SignDocumentViewParameters = {\n\tpdfNode: ?Element,\n\tpdfSource: ?string,\n\tprintButtonId: ?string,\n\tdownloadButtonId: ?string,\n};\n\nlet defaultComponent = null;\n\n/**\n * @memberOf BX.Crm.Component\n */\nclass SignDocumentView\n{\n\tpdfNode: ?Element;\n\tpdfSource: ?string;\n\tprintButton: ?BaseButton;\n\tdownloadButton: ?BaseButton;\n\tviewer: ?Viewer.SingleDocumentController;\n\n\tconstructor(parameters: SignDocumentViewParameters)\n\t{\n\t\tthis.pdfNode = parameters.pdfNode;\n\t\tthis.pdfSource = parameters.pdfSource;\n\t\tthis.printButton = ButtonManager.createByUniqId('crm-document-print');\n\t\tthis.downloadButton = ButtonManager.createByUniqId('crm-document-download');\n\n\t\tthis.#initViewer();\n\t\tthis.#bindEvents();\n\n\t\tdefaultComponent = this;\n\t}\n\n\t#initViewer(): void\n\t{\n\t\tconst viewer = this.getViewer();\n\t\tif (!viewer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tviewer.setItems([Viewer.buildItemByNode(this.pdfNode)]);\n\t\tviewer.setPdfSource(this.pdfSource);\n\t\tviewer.setScale(1.2);\n\t\tviewer.open();\n\t}\n\n\tgetViewer(): ?Viewer.SingleDocumentController\n\t{\n\t\tif (!this.viewer && this.pdfNode)\n\t\t{\n\t\t\tthis.viewer = new Viewer.SingleDocumentController({baseContainer: this.pdfNode, stretch: true});\n\t\t}\n\n\t\treturn this.viewer ?? null;\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tif (this.printButton && this.getViewer())\n\t\t{\n\t\t\tthis.printButton.bindEvent('click', () => {\n\t\t\t\tthis.getViewer().print();\n\t\t\t})\n\t\t}\n\t\tif (this.downloadButton)\n\t\t{\n\t\t\tthis.downloadButton.bindEvent('click', () => {\n\t\t\t\twindow.open(this.pdfSource, '_blank');\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic getDefaultComponent(): ?SignDocumentView\n\t{\n\t\treturn defaultComponent;\n\t}\n}\n\nnamespace.SignDocumentView = SignDocumentView;\n"],"names":["namespace","Reflection","Viewer","defaultComponent","SignDocumentView","parameters","pdfNode","pdfSource","printButton","ButtonManager","createByUniqId","downloadButton","viewer","SingleDocumentController","baseContainer","stretch","getViewer","setItems","buildItemByNode","setPdfSource","setScale","open","bindEvent","print","window"],"mappings":";;;;;;;;CAGA,IAAMA,SAAS,GAAGC,oBAAU,CAACD,SAAX,CAAqB,kBAArB,CAAlB;CACA,IAAME,MAAM,GAAGD,oBAAU,CAACD,SAAX,CAAqB,cAArB,CAAf;CASA,IAAIG,gBAAgB,GAAG,IAAvB;CAEA;CACA;CACA;;;;;;KACMC;CAQL,4BAAYC,UAAZ,EACA;CAAA;;CAAA;;CAAA;;CACC,SAAKC,OAAL,GAAeD,UAAU,CAACC,OAA1B;CACA,SAAKC,SAAL,GAAiBF,UAAU,CAACE,SAA5B;CACA,SAAKC,WAAL,GAAmBC,wBAAa,CAACC,cAAd,CAA6B,oBAA7B,CAAnB;CACA,SAAKC,cAAL,GAAsBF,wBAAa,CAACC,cAAd,CAA6B,uBAA7B,CAAtB;;CAEA;;CACA;;CAEAP,IAAAA,gBAAgB,GAAG,IAAnB;CACA;;;;iCAgBD;CAAA;;CACC,UAAI,CAAC,KAAKS,MAAN,IAAgB,KAAKN,OAAzB,EACA;CACC,aAAKM,MAAL,GAAc,IAAIV,MAAM,CAACW,wBAAX,CAAoC;CAACC,UAAAA,aAAa,EAAE,KAAKR,OAArB;CAA8BS,UAAAA,OAAO,EAAE;CAAvC,SAApC,CAAd;CACA;;CAED,6BAAO,KAAKH,MAAZ,uDAAsB,IAAtB;CACA;;;2CAmBD;CACC,aAAOT,gBAAP;CACA;;;;;yBAzCD;CACC,MAAMS,MAAM,GAAG,KAAKI,SAAL,EAAf;;CACA,MAAI,CAACJ,MAAL,EACA;CACC;CACA;;CACDA,EAAAA,MAAM,CAACK,QAAP,CAAgB,CAACf,MAAM,CAACgB,eAAP,CAAuB,KAAKZ,OAA5B,CAAD,CAAhB;CACAM,EAAAA,MAAM,CAACO,YAAP,CAAoB,KAAKZ,SAAzB;CACAK,EAAAA,MAAM,CAACQ,QAAP,CAAgB,GAAhB;CACAR,EAAAA,MAAM,CAACS,IAAP;CACA;;yBAaD;CAAA;;CACC,MAAI,KAAKb,WAAL,IAAoB,KAAKQ,SAAL,EAAxB,EACA;CACC,SAAKR,WAAL,CAAiBc,SAAjB,CAA2B,OAA3B,EAAoC,YAAM;CACzC,MAAA,KAAI,CAACN,SAAL,GAAiBO,KAAjB;CACA,KAFD;CAGA;;CACD,MAAI,KAAKZ,cAAT,EACA;CACC,SAAKA,cAAL,CAAoBW,SAApB,CAA8B,OAA9B,EAAuC,YAAM;CAC5CE,MAAAA,MAAM,CAACH,IAAP,CAAY,KAAI,CAACd,SAAjB,EAA4B,QAA5B;CACA,KAFD;CAGA;CACD;;CAQFP,SAAS,CAACI,gBAAV,GAA6BA,gBAA7B;;;;"}