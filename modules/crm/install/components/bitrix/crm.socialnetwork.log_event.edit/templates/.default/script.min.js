if(typeof BX.CrmSonetEventEditor==="undefined"){BX.CrmSonetEventEditor=function(){this._settings={};this._id="";this._prefix="";this._editorName="";this._formId="";this._editorContainer=null;this._containerMicro=null;this._containerMicroInner=null;this._containerMicroHeight=null;this._animation=null;this._animationContainer=null;this._msgTitleWrapper=this._msgTitle=this._msgTitleCloseBtn=this._msgTitleToggleBtn=this._enableMsgTitle=null;this._isMsgTitleEnabled=false;this._isVisible=false;this._isFormSubmit=false};BX.CrmSonetEventEditor.prototype={initialize:function(t,i){this._id=t;this._settings=i?i:{};this._prefix=this.getSetting("prefix");this._formId=this.getSetting("formId");this._msgTitleWrapper=this._resolveElement("message_title_wrapper");this._msgTitle=this._resolveElement("message_title");this._enableMsgTitle=this._resolveElement("enable_message_title");this._isMsgTitleEnabled=BX.type.isDomNode(this._enableMsgTitle)&&this._enableMsgTitle.value==="Y";this._msgTitleCloseBtn=this._resolveElement("message_title_close_btn");if(BX.type.isDomNode(this._msgTitleCloseBtn)){BX.bind(this._msgTitleCloseBtn,"click",BX.delegate(this._onMessageTitleCloseButtonClick,this))}this._msgTitleToggleBtn=this._resolveElement("message_title_toggle_btn");if(BX.type.isDomNode(this._msgTitleToggleBtn)){BX.bind(this._msgTitleToggleBtn,"click",BX.delegate(this._onMessageTitleToggleButtonClick,this))}this._containerMicro=this._resolveElement("micro");this._containerMicroInner=this._resolveElement("micro_inner");this._containerMicroHeight=this._containerMicro.offsetHeight;if(BX.type.isDomNode(this._containerMicro)){BX.bind(this._containerMicro,"click",BX.delegate(this.showEditor,this))}this._editorName=this.getSetting("editorName");this._editorContainer=this._editorName!==""?BX("div"+this._editorName):null;if(BX.type.isDomNode(this._editorContainer)){BX.addCustomEvent(this._editorContainer,"OnAfterShowLHE",BX.delegate(this._onEditorShow,this));BX.addCustomEvent(this._editorContainer,"OnAfterHideLHE",BX.delegate(this._onEditorHide,this));if(this._editorContainer.style.display!=="none")this._onEditorShow();else this._onEditorHide()}this._animationContainer=BX("microblog-form");var e=this._resolveElement("button_cancel");if(BX.type.isDomNode(e)){BX.bind(e,"click",BX.delegate(this._onCancelButtonClick,this))}var s=this._resolveElement("button_save");if(BX.type.isDomNode(s)){BX.bind(s,"click",BX.delegate(this._onSaveButtonClick,this))}},getSetting:function(t,i){return this._settings.hasOwnProperty(t)?this._settings[t]:i},setSetting:function(t,i){this._settings[t]=i},enableMessageTitle:function(t){if(!this._msgTitleWrapper){return}t=!!t;if(this._isMsgTitleEnabled!==t){this._enableMsgTitle.value=t?"Y":"N";this._isMsgTitleEnabled=t;this._showMessageTitle(t)}},_showMessageTitle:function(t){t=!!t;if(BX.type.isDomNode(this._msgTitleWrapper)){this._msgTitleWrapper.style.display=t?"":"none"}if(t&&BX.type.isDomNode(this._msgTitle)){BX.focus(this._msgTitle)}},_onMessageTitleCloseButtonClick:function(t){this.enableMessageTitle(false)},_onMessageTitleToggleButtonClick:function(t){var i=!this._isMsgTitleEnabled;this.enableMessageTitle(i);if(i){BX.addClass(this._msgTitleToggleBtn,"feed-add-post-form-btn-active")}else{BX.removeClass(this._msgTitleToggleBtn,"feed-add-post-form-btn-active")}},_resolveElement:function(t){var i=t;if(this._prefix){i=this._prefix+i}return BX(i)},_onEditorShow:function(){this._processEditorVisibilityChange(true)},_onEditorHide:function(){this._processEditorVisibilityChange(false)},_processEditorVisibilityChange:function(t){t=!!t;this._isVisible=t;if(this._isMsgTitleEnabled){this._showMessageTitle(t)}if(t){this._resolveElement("button_block").classList.remove("crm-feed-post-form-block-hidden");var i=window.BXHtmlEditor.Get(this._editorName);if(i){i.Focus()}}else{this._resolveElement("button_block").classList.add("crm-feed-post-form-block-hidden");if(this._isMsgTitleEnabled){this._showMessageTitle(false)}}},showEditor:function(){if(this._isVisible){return}this._containerMicro.style.display="none";BX.onCustomEvent(this._editorContainer,"OnShowLHE",[true])},hideEditor:function(){if(!this._isVisible){return}this._containerMicro.style.display="block";this._startAnimation();BX.onCustomEvent(this._editorContainer,"OnShowLHE",[false]);this._endAnimation()},_startAnimation:function(){if(this._animation)this._animation.stop();var t=this._animationContainer;if(this._containerMicroHeight>0){this.animationStartHeight=this._containerMicroHeight;this._containerMicroHeight=0}else{this.animationStartHeight=t.parentNode.offsetHeight}t.parentNode.style.height=this.animationStartHeight+"px";t.parentNode.style.overflowY="hidden";t.parentNode.style.position="relative";t.style.opacity=0},_endAnimation:function(){var t=this._animationContainer;this._animation=new BX.easing({duration:500,start:{height:this.animationStartHeight,opacity:0},finish:{height:t.offsetHeight+t.offsetTop,opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function(i){t.parentNode.style.height=i.height+"px";t.style.opacity=i.opacity/100},complete:BX.proxy((function(){t.style.cssText="";t.parentNode.style.cssText="";this._animation=null}),this)});this._animation.animate()},_onCancelButtonClick:function(t){this.hideEditor();return BX.PreventDefault(t)},_onSaveButtonClick:function(t){this.submitForm();return BX.PreventDefault(t)},submitForm:function(){if(this._isFormSubmit){return}var t=BX(this._formId);BX.submit(t,"save");this._isFormSubmit=true},createSubmitHandler:function(){return BX.delegate(this.submitForm,this)}};BX.CrmSonetEventEditor.items={};BX.CrmSonetEventEditor.create=function(t,i){var e=new BX.CrmSonetEventEditor;e.initialize(t,i);this.items[t]=e;return e}}
//# sourceMappingURL=script.map.js