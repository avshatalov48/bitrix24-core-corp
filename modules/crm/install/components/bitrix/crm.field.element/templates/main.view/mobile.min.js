this.BX=this.BX||{};this.BX.Mobile=this.BX.Mobile||{};this.BX.Mobile.Field=this.BX.Mobile.Field||{};(function(e,t){"use strict";var i=window.BX,n=window.BXMobileApp;var a=function(){var e=function e(t,n,a,l){this.node=t;this.container=n;this.click=i.delegate(this.click,this);this.callback=i.delegate(this.callback,this);this.multiple=this.container.hasAttribute("multiple");this.useOnChangeEvent=a||false;this.availableTypes=l||[];i.bind(this.node,"click",this.click);this.urls=this.getUrls()};e.prototype={getUrls:function e(){var t=i.message("SITE_DIR")+"mobile/index.php?mobile_action=get_element_crm_list&"+this.encodeQueryData(this.availableTypes);return{list:t,profile:i.message("interface_form_user_url")}},encodeQueryData:function e(t){var i=[];for(var n in t){i.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]))}return i.join("&")},click:function e(t){this.show();return i.PreventDefault(t)},show:function e(){new n.UI.Table({url:this.urls.list,table_settings:{callback:this.callback,multiple:this.multiple,searchField:true,selected:this.getSelectedItems(),showtitle:true,markmode:true,skipSpecialChars:true,modal:true,alphabet_index:true,okname:i.message("interface_form_select"),cancelname:i.message("interface_form_cancel"),cache:false}},"users").show()},callback:function e(t){var n=this;this.container.length=0;var a=this.container.nextElementSibling;while(a.firstChild){a.removeChild(a.firstChild)}var l=[];for(var s in t){if(t.hasOwnProperty(s)){if(!(s in l)){l.push(s);var r=document.createElement("span");r.setAttribute("class","mobile-grid-data-span mobile-grid-crm-element-category-title");r.innerHTML=s;a.appendChild(r)}var o=t[s];o.forEach(function(e,t,i){var l=new Option(e.NAME,e.ID,true,true);n.container.add(l);var s=document.createElement("a");s.href=e.LINK;s.text=e.NAME;var r=document.createElement("span");r.setAttribute("class","mobile-grid-data-span");r.appendChild(s);a.appendChild(r)})}}if(this.useOnChangeEvent){i.onCustomEvent(this,"onChange",[this,this.node])}},getSelectedItems:function e(){var t=this.container.options;var i={};for(var n in t){if(t.hasOwnProperty(n)){if(i[t[n].getAttribute("data-category")]===undefined){i[t[n].getAttribute("data-category")]=[]}i[t[n].getAttribute("data-category")].push(t[n].value)}}return i}};return e}();window.app.exec("enableCaptureKeyboard",true);i.Mobile.Field.ElementCrm=function(e){this.availableTypes=e["availableTypes"]||[];this.useOnChangeEvent=e["useOnChangeEvent"]||false;this.init(e)};i.Mobile.Field.ElementCrm.prototype={__proto__:i.Mobile.Field.prototype,bindElement:function e(t){var n=null;if(i(t)){n=new a(t,i("".concat(t.id,"_select")),this.useOnChangeEvent,this.availableTypes)}return n}}})(this.BX.Mobile.Field.ElementCrm=this.BX.Mobile.Field.ElementCrm||{},BX);
//# sourceMappingURL=mobile.map.js