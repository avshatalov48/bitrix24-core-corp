(function(){BX.namespace("BX.Crm.Report");if(BX.Crm.Report.DealWidgetBoard){return}BX.Crm.Report.DealWidgetBoard={currentCategoryId:0,menu:null,onSelectCategoryButtonClick:function(t){if(!this.menu){var e=BX.CrmDealCategory.getListItems();var r=[];r.push({text:BX.message("CRM_REPORT_DEAL_ALL_DEALS"),dataset:{value:-1,text:BX.message("CRM_REPORT_DEAL_ALL_DEALS")},onclick:this.onMenuItemClick.bind(this)});e.forEach(function(t){r.push({text:t.text,dataset:t,onclick:this.onMenuItemClick.bind(this)})}.bind(this));this.menu=new BX.PopupMenuWindow("crm-select-category",t,r)}this.menu.toggle()},onMenuItemClick:function(t){var e=t.currentTarget.dataset.value;var r=t.currentTarget.dataset.text;this.menu.close();this.setCurrentCategory(e).then(function(){var t=document.getElementById("crm-report-deal-category");t.innerText=r;this.reload()}.bind(this)).catch(function(t){this.logResponseErrors(t)}.bind(this))},setCurrentCategory:function(t){return BX.ajax.runComponentAction("bitrix:crm.report.vc.content.widgetpanel","setDealCategoryId",{data:{categoryId:t}})},reload:function(){var t=BX.VisualConstructor.BoardRepository.getLast();if(t){t.reload()}},logResponseErrors:function(t){console.error(t.errors.map(function(t){return t.message}).join("\n"))}}})();
//# sourceMappingURL=script.map.js