BX.namespace("BX.Crm");if(typeof BX.Crm.OrderShipmentDocument==="undefined"){BX.Crm.OrderShipmentDocument=function(){this._id="";this._settings={}};BX.Crm.OrderShipmentDocument.prototype={initialize:function(e,t){this._id=BX.type.isNotEmptyString(e)?e:BX.util.getRandomString(4);this._settings=t?t:{};if(BX.Crm.EntityEditor!=="undefined"){this._editor=BX.Crm.EntityEditor.getDefault();this.setEditorSaveSuccess();this.setEditorInnerCancel()}},setEditorSaveSuccess:function(){var e=this._settings;this._editor.onSaveSuccess=function(t){this._isRequestRunning=false;this._toolPanel.setLocked(false);this._toolPanel.clearErrors();var i=BX.prop.getString(t,"ERROR","");if(i!==""){this._toolPanel.addError(i);this.releaseAjaxForm();this.initializeAjaxForm();return}if(BX.type.isPlainObject(t["ENTITY_DATA"])){var n=BX.prop.getInteger(t,"ENTITY_ID",0);if(n===0){n=BX.prop.getString(e,"entityId",0)}var r=BX.prop.getObject(t,"ENTITY_DATA",{});var o={entityTypeId:BX.CrmEntityType.enumeration.ordershipment,entityId:n,trackingNumber:BX.prop.getString(r,"TRACKING_NUMBER",0),deliveryDocNum:BX.prop.getString(r,"DELIVERY_DOC_NUM",0),deliveryDocDate:BX.prop.getString(r,"DELIVERY_DOC_DATE","")};window.top.BX.SidePanel.Instance.postMessage(window,"CrmOrderShipmentDocument::Update",o)}if(typeof top.BX.SidePanel!=="undefined"){this._enableCloseConfirmation=false;window.setTimeout(function(){var e=top.BX.SidePanel.Instance.getSliderByWindow(window);if(e&&e.isOpen()){e.close(false);setTimeout(function(){e.destroy()},500)}},250)}};this._editor._ajaxForm=BX.Crm.AjaxForm.create(this._editor._id,{elementNode:this._editor._formElement,config:{url:this._editor._serviceUrl,method:"POST",dataType:"json",processData:true,onsuccess:BX.delegate(this._editor.onSaveSuccess,this._editor),data:{ACTION:"SAVE",ACTION_ENTITY_ID:this._editor._entityId,ACTION_ENTITY_TYPE:BX.CrmEntityType.resolveAbbreviation(BX.CrmEntityType.resolveName(this._editor._entityTypeId))}}})},setEditorInnerCancel:function(){this._editor.innerCancel=function(){if(typeof top.BX.SidePanel!=="undefined"){this._enableCloseConfirmation=false;window.setTimeout(function(){var e=top.BX.SidePanel.Instance.getSliderByWindow(window);if(e&&e.isOpen()){e.close(false);setTimeout(function(){e.destroy()},500)}},250)}}}};BX.Crm.OrderShipmentDocument.create=function(e,t){var i=new BX.Crm.OrderShipmentDocument;i.initialize(e,t);return i}}
//# sourceMappingURL=script.map.js