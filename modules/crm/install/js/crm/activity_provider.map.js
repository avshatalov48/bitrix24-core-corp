{"version":3,"file":"activity_provider.min.js","sources":["activity_provider.js"],"names":["BX","namespace","CrmActivityProvider","this","_settings","_options","_ttlWrapper","_dlg","_dlgMode","CrmDialogMode","view","_dlgCfg","_onSaveHandlers","_onDlgCloseHandlers","_editor","_isChanged","_buttonId","CrmActivityDialogButton","undefined","_owner","_salt","_callCreationHandler","delegate","_handleCallCreation","_meetingCreationHandler","_handleMeetingCreation","_emailCreationHandler","_handleEmailCreation","_taskCreationHandler","_handleTaskCreation","_titleMenu","_contentNode","prototype","initialize","settings","editor","options","getOption","ownerType","getSetting","ownerID","Math","random","toString","substring","getMode","name","defaultval","setSetting","val","getMessage","messages","getType","CrmActivityType","provider","getId","parseInt","getMessageType","getOwnerType","getOwnerId","openDialog","mode","id","dlgId","edit","dialogs","params","sessid","bitrix_sessid","ajax_action","activity_id","self","ajax","method","dataType","url","message","data","onsuccess","HTML","wrapper","create","innerHTML","PopupWindow","autoHide","draggable","offsetLeft","offsetTop","bindOptions","forceBindPosition","closeByEsc","closeIcon","zIndex","contentNoPaddings","titleBar","content","_prepareViewDlgTitle","events","onPopupClose","CrmActivityEditor","hideUploader","hideLhe","destroy","onPopupDestroy","proxy","_wrapper","buttons","_prepareViewDlgButtons","_prepareDialogContent","show","_getNode","querySelector","me","additionalSwitcher","additionalFields","bind","toggleClass","comSliderLeft","_changeCommunicationSlide","comSliderRight","fieldCompleted","enableInstantEdit","setAttribute","setActivityCompleted","checked","result","removeAttribute","direction","navigator","slides","currentIndex","getAttribute","cnt","isNaN","style","marginLeft","closeDialog","removeCreateTaskListener","removeCreateCallListener","removeCreateMeetingListener","cleanLayout","_notifyDialogClose","close","addOnSave","handler","type","isFunction","i","length","push","removeOnSave","splice","addOnDialogClose","removeOnDialogClose","isChanged","getButtonId","text","CrmActivityMenu","enableTasks","isTasksEnabled","enableCalendarEvents","isCalendarEventsEnabled","enableEmails","isEmailsEnabled","createTask","createCall","createMeeting","createEmail","prepareDialogTitle","layout","ex","className","click","_handleCloseBtnClick","call","meeting","Crm","Activity","Planner","showEdit","ID","prepareDialogButtons","sender","TYPE_ID","OWNER_TYPE","OWNER_ID","FROM_ACTIVITY_ID","commData","comm","isArray","commEntityType","isNotEmptyString","commEntityId","defaultComm","getDefaultCommunication","CrmCommunicationType","email","getSettings","addEmail","addTask","e","cancel"],"mappings":"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"}